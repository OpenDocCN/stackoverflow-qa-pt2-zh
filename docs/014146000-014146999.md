# StackOverflow 问答 14146000-14146999

# objective-c - UIActivityViewController background color and nav bar color

> ID：14146000
> 
> 赞同：1
> 
> 时间：2013-01-03T19:43:14.827
> 
> 标签：objective-c, ios

In my iOS 6 iPad app I am using the new UIActivityViewController. I would like the popup containing the options (facebook,twitter,email,etc...) to be black instead of the blue color it is normally. I have seen it done so I know it is possible but I'm not sure how to get it.

My code is:

```
UIActivityViewController *activity = [[UIActivityViewController alloc] initWithActivityItems:@[string,url] applicationActivities:nil];

shareOptions = [[UIPopoverController alloc] initWithContentViewController:activity];  

[shareOptions presentPopoverFromBarButtonItem:actionBarButton permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES]; 
```

doing activity.view setBackgroundColor provides a weird looking popup... any ideas?

My second problem with UIActivityViewController is that when I chose to share via email the navigation bar for the email sharing controller is the default. I would like this to be black as well. I am trying to use the newish [UINavigationBar appearance] class. I can get it to be black using

```
[[UINavigationBar appearance] setTintColor:[UIColor blackColor]]; 
```

but this is not the UIBarStyleBlackOpaque that I am after.

```
[[UINavigationBar appearance] setBarStyle:UIBarStyleBlackOpaque]; 
```

does not work

Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T06:43:04.927

在打开事件的内部`UIActivityViewController`

```
- (IBAction)openShareDialog:(id)sender {
[[UINavigationBar appearance] setBackgroundImage:[YOUR UIImage] forBarMetrics:UIBarMetricsDefault];

//Init UIActivityViewController
} 
```

# ejb - wicket 序列化 JNDI

> ID：14146004
> 
> 赞同：0
> 
> 时间：2013-01-03T19:43:24.547
> 
> 标签：ejb, wicket, jndi

我正在使用带有 EJB 3 的 Wicket，当我调用我的页面时，日志显示错误

```
Error serializing object class com.mk.view.page.CountryList [object=[Page class = com.mk.view.page.CountryList, id = 91, render count = 1]]
org.apache.wicket.core.util.objects.checker.CheckingObjectOutputStream$ObjectCheckException: The object type is not Serializable!
A problem occurred while checking object with type: javax.naming.InitialContext
Field hierarchy is:
  91 [class=com.mk.view.page.CountryList, path=91]
    private javax.naming.Context com.mk.view.page.CountryList.ctx [class=javax.naming.InitialContext] <----- field that is causing the problem 
```

我的代码是

```
public class CountryList extends Layout {
    /**
     * 
     */
    private static final long serialVersionUID = 1L;
    /**
     * 
     */

    private javax.naming.Context ctx;
    private GenericCrudService sf;

    private CountryList(){      
        try {

                ctx = new javax.naming.InitialContext();
                sf = (GenericCrudService) ctx
                        .lookup("java:global/mkEar/mkEJB/CrudService!com.mk.business.common.GenericCrudService");

        } catch (NamingException e) {
            e.printStackTrace();
        }

        addModelModule();
        addSearchModule();
    } 
```

我的应用程序没有崩溃，我还没有找到解决方案，所以我想知道这些是否会比日志更糟糕？有谁知道解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T22:11:13.627

不要将引用保留`GenericCrudService`为字段（也不要作为`InitialContext`实例）。将查找代码重构为方法，并在每次需要服务时检索它。您可以重用它，但将其保留在本地（变量）或请求范围内。

AFAIK，不能保证从 JNDI 查找返回的 EJB 将是可序列化的，即使它们实现了接口并遵循序列化规则。容器可能会返回一个代理，而不是直接返回对象实例。

Since Wicket will serialize stateful pages after requests, they can't have non-serializable attributes. This is the cause of the error you're getting.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T09:22:17.607

You can also mark your `GenericCrudService` field transient and initialize instance in Component `onAttach/onConfigure` method. When using Spring there is a dedicated annotation @SpringBean in Wicket, which will make your non-serializable service field a proxy and handle instance setting for you.

# r - ggplot2的多变量回归

> ID：14146005
> 
> 赞同：6
> 
> 时间：2013-01-03T19:43:24.603
> 
> 标签：r, ggplot2

我需要使用 ggplot 创建一个多变量回归线。

我的数据：

```
dput(head(x2,15))
structure(list(Date = structure(c(15608, 15609, 15610, 15611, 
15612, 15613, 15614, 15615, 15616, 15617, 15618, 15619, 15620, 
15621, 15622), class = "Date"), Cpu = c(77.0763, 51.8909, 59.3229, 
89.5822, 87.7448, 80.4413, 57.5009, 99.8185, 99.9969, 91.5528, 
50.0793, 56.4049, 57.808, 51.0453, 56.0505), Memory = c(369.667979452055, 
341.572253381722, 345.013066490241, 334.520135424091, 374.107056613899, 
1592.38342810723, 470.204599904169, 393.802909594735, 540.817571059432, 
425.49563812601, 438.326775174387, 614.417456359102, 1255.63550519358, 
466.993243243243, 358.445879354291), Response = c(52.25, 48.36, 
49.23, 50.99, 48.63, 46.11, 43.03, 45.35, 50.03, 46.18, 47.39, 
43.28, 55.36, 50.59, 50.44)), .Names = c("Date", "Cpu", "Memory", 
"Response"), row.names = c(1L, 4L, 6L, 7L, 9L, 10L, 13L, 16L, 
19L, 25L, 29L, 32L, 35L, 39L, 42L), class = "data.frame") 
```

我可以在`Response`和之间做到这一点`Cpu`：

```
ggplot(x2, aes(Response)) + 
   geom_point(aes(y = Memory), size = 2, colour = "blue") +
   geom_point(aes(y = Cpu), size = 2, colour = "orange") + 
   geom_smooth(method = "lm", formula = "Response ~ CPU+Memory", 
               size = 1.5, colour = "red", se = T) 
```

我收到此错误：

```
Error: stat_smooth requires the following missing aesthetics: y 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-03T20:46:47.790

首先，[stat_smooth](http://docs.ggplot2.org/0.9.3/stat_smooth.html)取公式；我不认为[geom_smooth](http://docs.ggplot2.org/0.9.3/geom_smooth.html)需要一个。其次，我不认为你可以输入一个超过一个`predictor`in的公式`stat_smooth`。如果我错了，请纠正我。另一种解决方案是自己拟合模型并计算预测值，并以这种方式自己计算和绘制 SE：（取自[http://docs.ggplot2.org/0.9.3/geom_smooth.html](http://docs.ggplot2.org/0.9.3/geom_smooth.html)）

```
model <- lm(data = df, Response ~ Memory + Cpu)
df$model <- stats::predict(model, newdata=df)
err <- stats::predict(model, newdata=df, se = TRUE)
df$ucl <- err$fit + 1.96 * err$se.fit
df$lcl <- err$fit - 1.96 * err$se.fit

g <- ggplot(df)
g <- g + geom_point(aes(x=Response, y = model), size = 2, colour = "blue")
g <- g + geom_smooth(data=df, aes(x=Response, y=model, ymin=lcl, ymax=ucl), size = 1.5, 
            colour = "red", se = TRUE, stat = "smooth") 
```

这给出了如下所示的结果（不确定它是您期望的）： ![在此处输入图像描述](../Images/9ede3aa0960e7d708c3c2d6dfe5f2979.png)

# c# - 读取配方以控制数据处理步骤

> ID：14146006
> 
> 赞同：0
> 
> 时间：2013-01-03T19:43:26.977
> 
> 标签：c#

我有一个通用格式的文本文件：

```
ThreadID, MethodName, [Param1 | Param2 | ... ] 
```

我有一个实用程序类，如下所示：

```
public static class Util
{
    public static List<double> Foo(List<double> Source, double Scale)
    {
        List<double> l = new List<double>(Source);
        for (int i = 0; i < l.Count; i++)
        {
            l[i] = l[i] * Scale;
        }
        return l;
    }

    public static void Fud(List<double> Source, string Name)
    {
        //... Chart Series
    }
    public static bool Fee(CustomClass MyClass, double Limit1, int Limit2)
    {
        //... Test MyClass values against input limits
        return true; // false;
    }
} 
```

所以我使用了一个开关/案例，它给出了文本文件中的方法名称，然后解析并将参数传递给案例中的方法。sudo 代码的效果是：

```
 static void Main(string[] args)
    {
        List<string> TextFile;
        List<double>[] Register = new List<double>[3];   //lists containing data that is moved, mutated and converted to CustomClass
        CustomClass MyClass = new CustomClass();
        bool Passed = false;

        foreach (var line in TextFile)
        {
            string methodName = Util.ParseMethod(line);          //parsed from file
            string param1, param2, param3, param4 = Util.ParseParams(line);          //parsed from file
            switch (methodName)
            {
                case "Foo":
                    Register[param1] = Util.Foo(Register[param2], param3);
                    break;

                case "Fud":
                    Util.Fud(Register[param1], param3);
                    break;

                case "Fee":
                    Passed = Util.Foo(MyClass, param1, param2);
                    break;
            }
        }
    } 
```

我不喜欢拆分逻辑，每次开发新的实用程序方法时，我都必须手动添加另一个案例语句。case 语句变得难以维护，因为设计时错误（字符串/更新中的拼写错误）通常只在运行时被捕获。

我试图将这一切转换为工厂架构，但我似乎无法适应不同的方法定义。我希望取消 Utility 类并使用工厂接口在它自己的类中定义每个方法。

```
public interface IRecipe
{
    string GetFactoryKey();
    string SerializeArgs(object[] args);
    object[] DeserializeArgs(string args);
    ??? DoWork(???);
} 
```

问题是由于实用程序类中的每个方法有多么不同，我找不到在接口中正确定义它的方法。我想要的最终结果是我可以用通用代码替换 foreach 循环中的开关，并且在实现工厂接口而不是方法调用者的每个类中定义所有细节逻辑、解析、方法定义、错误检查和验证. 我已经用完了谷歌的东西，因为我什至不知道我想要做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T23:23:22.950

我想我想通了……这是我迄今为止的完整概念证明。还是有点丑，但我至少把丑封装在了每个工厂类里。这意味着 Main 中的调用者可以保持非常通用，以便在循环中轻松使用。当我做真正的实现时，我会更多地重构它。

```
using System;
using System.Collections.Generic;
using System.Collections.Specialized;
using System.Linq;
using System.Text;
using System.Reflection;
using System.Threading;

namespace ConsoleApplication3
{
    class Program
    {
        static void Main(string[] args)
        {
            List<double>[] Reg = new List<double>[2]; for (int i = 0; i < Reg.Length; i++) { Reg[i] = new List<double>(); }

            for (int i = 0; i < 100; i++)
            { Reg[1].Add(1.0); }            //Dummy data

            var obj = ClassFactory.CreateStep("AmplifySignal");
            object[] Args = obj.DeserializeProperties(" ");
            Args[0] = Reg;
            dynamic result = obj.Run(Args);

            if (result != null)
            { Thread.Sleep(0); }    //breakpoint

            Console.ReadKey();
        }
    }

    internal static class ClassFactory
    {
        private static readonly IDictionary<String, Type> _recipe_instructions;

        static ClassFactory() { _recipe_instructions = MapIFactory(); }

        private static IDictionary<string, Type> MapIFactory()
        {
            // Get the assembly that contains this code
            Assembly asm = Assembly.GetExecutingAssembly();

            // Get a list of all the types in the assembly
            Type[] allTypes = asm.GetTypes();

            var d = new Dictionary<string, Type>();
            foreach (var type in allTypes)
            {
                if (type.IsClass && !type.IsAbstract && type.GetInterface(typeof(IFactory).ToString()) != null)
                {
                    // Create a temporary instance of that class...
                    object inst = asm.CreateInstance(type.FullName, true, BindingFlags.CreateInstance, null, null, null, null);
                    if (inst != null)
                    {
                        // And generate the product classes key
                        IFactory mapKey = (IFactory)inst;
                        object key = mapKey.GetFactoryKey();
                        inst = null;

                        //Add the results to a Dictionary with the Name as a key and the Type as the value
                        d.Add((string)key, type);
                    }
                }
            }
            return d;
        }

        internal static IFactory CreateStep(String key)
        {
            Type type;
            if (_recipe_instructions.TryGetValue(key, out type))
            { return (IFactory)Activator.CreateInstance(type); }
            throw new ArgumentException(String.Format("Unable to locate key: {0}", key));
        }
    }

    public interface IFactory
    {
        string GetFactoryKey();
        string SerializeProperties();
        object[] DeserializeProperties(string args);
        dynamic Run(params object[] args);
    }

    public class AmplifySignal : IFactory
    {
        public string GetFactoryKey()
        { return MethodBase.GetCurrentMethod().DeclaringType.Name; }
        public object[] DeserializeProperties(string args)
        { return new object[] { null, (int)1, (double)2.1 }; }
        public string SerializeProperties()
        { return " 1 | 2.1 "; }

        public dynamic Run(params object[] args)
        {
            // Build Inputs
            List<double>[] registers = (List<double>[])args[0];
            List<double> waveform = (List<double>)registers[(int)args[1]];
            double factor = (double)args[2];

            // Do Work
            double[] Result = waveform.ToArray();      //Localize and Deep Copy
            for (int i = 0; i < Result.Length; i++)
            { Result[i] *= factor; }
            List<double> result = Result.ToList();    //breakpoint

            // Write Result
            return result;
        }
    }
} 
```

如果我在这里做了一些真正亵渎神明的事情，并且有更好的方法来完成同样的事情，那么我无论如何都愿意接受建议。我会等待一两天，然后才能接受这个答案，以便提供任何反馈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:49:14.260

如果 DoWork 方法采用单个字符串参数（逗号分隔的参数）并根据需要将其拆分怎么办？然后您仍然可以使用简单的界面并将详细信息留给每个配方。

另一种选择是将字符串数组作为参数，类似于将工作分拆到新线程中的方式（指定要调用的方法和包含其参数的数组。）

# autohotkey - 动态按钮

> ID：14146010
> 
> 赞同：0
> 
> 时间：2013-01-03T19:43:56.173
> 
> 标签：autohotkey

我正在研究在动态按钮列表中创建动态按钮名称的可能性，这将启动动态功能。从 Gui 的设置方式来看，我认为这是不可能的，但我在这里看到了一些令人惊奇的事情。

例子。文件中的每个项目都会出现一个按钮，按下该按钮将运行该特定项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:49:46.040

编写一个循环来检查文件中的项目并创建或删除运行该项目的热键。在我的示例中，ITEM 是您希望运行的程序的路径，您可以使用[http://www.autohotkey.com/docs/commands/Hotkey.htm](http://www.autohotkey.com/docs/commands/Hotkey.htm)动态创建热键。

# json - Sencha touch 2 实现 CRUD 操作

> ID：14146012
> 
> 赞同：0
> 
> 时间：2013-01-03T19:44:32.200
> 
> 标签：json, jsp, rest, db2, sencha-touch-2

我是煎茶触摸的新手。我现在有问题。我需要使用 REST 架构来实现 CRUD 操作。

但我不知道如何开始。任何人都可以引导我或提供一些教程吗？顺便说一句，我正在使用 JSP，我的数据库是 DB2。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:53:29.770

假设您在 Sencha Touch 2.1 入口点是[http://docs.sencha.com/touch/2-1/#!/api/Ext.data.proxy.Rest](http://docs.sencha.com/touch/2-1/#!/api/Ext.data.proxy.Rest)。

简而言之，您必须定义 Ext.data.Store 哪个代理是 Ext.data.proxy.Rest。如果您需要更多帮助，请告知...

干杯，奥列格

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T16:52:17.477

如果你被困在创建 Web 服务并且熟悉 java，你可以尝试一些关于 CXF 或 Jersey 的教程。这是一个给你的：

[http://java.dzone.com/articles/rest-web-service-using-cxf](http://java.dzone.com/articles/rest-web-service-using-cxf)

完成此操作后，您可以开始遵循 Oleg 提到的 sencha 的教程或观看

www.youtube.com/watch?v=G5DLMfxDl9U

# c# - 标识符不能为空字符串

> ID：14146017
> 
> 赞同：-1
> 
> 时间：2013-01-03T19:44:59.170
> 
> 标签：c#, .net, linq-to-sql

我正在使用 Linq To Sql 保存一个包含许多子实体的实体，只是想知道是否有人遇到过这个错误：`The identifier cannot be an empty string`

我只是想知道是否有人遇到过它，你做了什么来解决这个问题？也许我会很幸运，您的解决方案之一会奏效。

这可能无济于事，但这是代码失败的地方

```
public void SaveJob(object sender, CancelEventArgs e)
{

   Job = JobEditorUtilities.CreateNewJob(jobid, SettingsManager.OpsMgrSettings.Region.Trim(), _db);
    try
    {
        var canSaveJob = CanSaveJob();
        if (canSaveJob)
        {
            JobEditorUtilities.PrepareJobForSaving(Job);
            if (newjob)
                _db.JobNumbers.InsertOnSubmit(Job);

            var a = _db.GetChangeSet();
            _db.SubmitChanges();   // fails here
            RenameJobNumberIfNecessary();

        }
        else
        {
            e.Cancel = true;
        }
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message);
    }
}

    public static JobNumber CreateNewJob(int jobid, string region, DataAccessDataContext dc)
    {
        var job = new JobNumber();
        job.JobID = jobid;

        InitializeSubContractor(dc, job);
        job.GWDRunSummaryDatas = new GWDRunSummaryData();
        job.CorrectionsApplieds = new CorrectionsApplied();
        job.MonitorInfos = new MonitorInfo();
        InitializeGWDHeader(dc, job);
        job.Rpt_Details = new Rpt_Detail();
        job.RunningModes = new RunningMode();
        job.SafetyIssuesTotals = new SafetyIssuesTotals();
        job.SafetyIssueTotals = new SafetyIssueTotals();
        switch (region)
        {
            case "NA":
                InitializeNA_Header(dc, job);
                job.NA_WRdetails = new NA_WRdetail();
                InitializeNA_BillingCompany(dc, job);
                job.NA_RigDetails = new NA_RigDetail();
                job.NA_Holedetails = new NA_Holedetail();
                job.NA_Salesmans = new NA_Salesman();
                InitializeNA_WL_Company(dc, job);
                break;
            case "EU":
                InitializeEAC_Header(dc, job);
                break;
        }

        return job;
    }
   private static void InitializeNA_WL_Company(DataAccessDataContext dc, JobNumber job)
    {
        job.NA_WL_Companies = new NA_WL_Company();
        job.NA_WL_Companies.Resource =
            dc.Resources.FirstOrDefault(r => r.Refno == job.NA_WL_Companies.WL_companyid);
    }

    private static void InitializeGWDHeader(DataAccessDataContext dc, JobNumber job)
    {
        job.GWD_Header2s = new GWD_Header2();
        job.GWD_Header2s.GWDDirComp2 =
            dc.GWDDirComp2s.FirstOrDefault(g => g.ID == job.GWD_Header2s.MWD_Company);

    }

    private static void InitializeNA_BillingCompany(DataAccessDataContext dc, JobNumber job)
    {
        job.NA_BillingCompanies = new NA_BillingCompany();
        job.NA_BillingCompanies.Resource =
            dc.Resources.FirstOrDefault(r => r.Refno == job.NA_BillingCompanies.Billingcompanyid);
    }
    private static void InitializeSubContractor(DataAccessDataContext dc, JobNumber job)
    {
        job.Subcontractors = new Subcontractor();
        job.Subcontractors.Resource =
            dc.Resources.FirstOrDefault(r => r.Refno == job.Subcontractors.SubcontractorID);
    }

    private static void InitializeNA_Header(DataAccessDataContext dc, JobNumber job)
    {
        job.NA_Headers = new NA_Header();
        job.NA_Headers.RigType1 = dc.RigTypes.FirstOrDefault(r => r.ID == job.NA_Headers.RigType);
        job.NA_Headers.Well_Locn1 = dc.Well_Locns.FirstOrDefault(w => w.ID == job.NA_Headers.Well_Locn);
    }

    private static void InitializeEAC_Header(DataAccessDataContext dc, JobNumber job)
    {
        job.EAC_Headers = new EAC_Header();

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T14:43:39.830

我最终重新开始，只是根据需要初始化子实体，而不是一次全部初始化。这似乎解决了问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-04T17:38:27.397

此问题是由具有空白“源”属性的类字段映射之一引起的。如果您使用的是 LINQ to SQL 设计器，请单击每个类的每个字段，并确保“源”属性不为空。如果您手动创建类，请确保在“名称”字段中没有带有空白字符串的 ColumnAttributes。

# ios - 应用程序中的导入照片选项

> ID：14146021
> 
> 赞同：0
> 
> 时间：2013-01-03T19:45:08.167
> 
> 标签：ios, photos

> **可能重复：**
> [如何从我的 iphone 应用程序访问照片？](https://stackoverflow.com/questions/5846534/how-do-i-access-photos-from-my-iphone-app)

我正在构建一个应用程序，允许用户导入他们手机上当前的照片。我注意到其他几个应用程序都有这个选项（我想到了 WhatsApp、Facebook）。有没有一个例子是如何做到的？

我已经为此搜索了一个 API……但没有找到它。然而，我确实找到了这个： [https ://github.com/andreyvit/SoloComponents-iOS](https://github.com/andreyvit/SoloComponents-iOS)

它允许显示照片，但是我们如何获取当前在手机上的照片呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T20:05:51.080

你可以在这里找到完整的文档：http: [//developer.apple.com/library/ios/#documentation/uikit/reference/UIImagePickerController_Class/UIImagePickerController/UIImagePickerController.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImagePickerController_Class/UIImagePickerController/UIImagePickerController.html)作为奖励，你也可以用这个类拍照。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:10:37.347

您可以使用[UIImagePickerController](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImagePickerController_Class/UIImagePickerController/UIImagePickerController.html)来执行此操作。

这是一个简单的[教程](http://idevhub.com/picking-images-with-the-iphone-sdk-uiimagepickercontroller/)，可以帮助你。另请查看此[链接](http://blog.hanpo.tw/2012/01/uiimagepickercontroller-and-simple.html)以集成相机照片

# ruby-on-rails - 将 f.collection_check_boxes 的复选框与 Simple_Form 对齐

> ID：14146023
> 
> 赞同：11
> 
> 时间：2013-01-03T19:45:10.327
> 
> 标签：ruby-on-rails, checkbox, simple-form

我正在使用 RoR，并且我正在为我的表单使用 Simple_Form gem。我有一个对象关系，一个用户可以有多个角色，在创建过程中，管理员可以选择哪些角色应用于新用户。我希望角色的复选框位于左侧，右侧的名称以水平排列方式排列。

// “盒子” 管理员 //

而不是当前的

//

“盒子”

行政

//

我当前显示角色的代码是这样的。

```
 <div class="control-group">
    <%= f.label 'Roles' %>
    <div class="controls">
      <%= f.collection_check_boxes 
                 :role_ids, Role.all, :id, :name %>
    </div>
  </div> 
```

我最关心的部分是 f.collection_check_boxes 生成这样的代码。

```
<span>
  <input blah blah />
  <label class="collection_check_boxes" blah>blah</label>
</span> 
```

这让我很难在那里获得一个 css 类，因为有 3 个组件必须被触及。我尝试将诸如虚拟类之类的东西添加到 :html 哈希中，但虚拟类甚至没有出现在呈现的 html 中。

任何帮助是极大的赞赏

**编辑：解决方案**

感谢 Baldrick，我的工作 erb 看起来像这样。

```
<%= f.collection_check_boxes :role_ids, Role.all, :id, :name,
      {:item_wrapper_class => 'checkbox_container'} %> 
```

我的CSS如下

```
.checkbox_container {
  display: inline-block;
  vertical-align: -1px;
  margin: 5px;
 }
.checkbox_container input {
  display: inline;
 }
.checkbox_container .collection_check_boxes{
  display: inline;
  vertical-align: -5px;
 } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-03T20:07:37.573

根据[collection_check_boxes 的文档](http://rubydoc.info/github/plataformatec/simple_form/master/SimpleForm/ActionViewExtensions/Builder#collection_check_boxes-instance_method)，有一个选项`item_wrapper_class`可以为包含复选框的跨度提供一个 css 类。像这样使用它

```
<%= f.collection_check_boxes :role_ids, Role.all, :id, :name, :item_wrapper_class => 'checkbox_container' %> 
```

还有一个 CSS 样式，用于将复选框和标签保持在同一行：

```
.checkbox_container input {
  display: inline;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-24T10:30:52.497

在 SimpleForm 的最新 2.1.0 分支和 bootstrap-saas 的 2.3.1.0 中，安装了 bootstrap 选项，collection_check_boxes 方法导致应用内联项目包装类没有好的效果。

我能够使用标准输入、集合、:as => :check_boxes 方法使表单完美排列。然后内联样式完美地工作：

```
<%= f.input :roles, :collection => valid_roles, :label_method => :last, :value_method => :first, :as => :check_boxes, :item_wrapper_class => 'inline'  %> 
```

我的角色恰好是一个简单的数组数组，带有值、标签。希望这可以帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-04-14T07:04:05.453

这是使用“rails collection_check_boxes bootstrap”进行 DDG 搜索的第一个 SO 页面，但它与 Bootstrap 无关，但无论如何这里是 Bootstrap 4 的解决方案。

这适用于普通的 Rails 和 Bootstrap 4，不需要 gem。[`collection_check_boxes`](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-collection_check_boxes)是一个普通的 Rails 方法。

```
 .form-group
    =f.label :industry_interest
    %br
    =f.collection_check_boxes :industry_interest, Industry.all, :id, :name do |cb|
      =cb.check_box 
      =cb.label
      %br 
```

或者

```
 .form-group
    =f.label :industry_interest
    =f.collection_check_boxes :industry_interest, Industry.all, :id, :name do |cb|
      .form-check
        =cb.label class: 'form-check-label' do
          =cb.check_box class: 'form-check-input'
          =cb.text 
```

它们看起来一模一样。

[https://v4-alpha.getbootstrap.com/components/forms/#checkboxes-and-radios](https://v4-alpha.getbootstrap.com/components/forms/#checkboxes-and-radios)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-09T04:57:16.253

使用 Bootstrap，您可以：

```
<%= f.collection_check_boxes :role_ids, Role.all, :id, :name, :item_wrapper_class => 'inline' %> 
```

# javascript - 获取下拉值并显示它们

> ID：14146024
> 
> 赞同：-2
> 
> 时间：2013-01-03T19:45:11.540
> 
> 标签：javascript, jquery

我无法将下拉列表获得的值显示出来。我昨天刚开始学习 JS……干杯！[eta] 问题是我的代码有什么问题，因为它没有按我想要的那样工作。

```
<!doctype html>
<html><body>
<script src="jquery.js">

$(function checkDropdown() {
var selects= $("#id1 option:selected").val();
document.getElementById("filler").innerHTML= selects;
});
</script>

<form name="f1">
<select id="id1">
<OPTION Value="none">None</OPTION>
<OPTION Value="one">One</OPTION>
<OPTION Value="two">Two</OPTION>
</select></form>
<p id="filler">Replace this text</p>
</br></br>
<button onClick="checkDropdown()">  CLICK ME  </button>
</form>
</body></html> 
```

我最终想用实际数字替换选项值并将它们相乘。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:54:04.897

由于函数的声明方式，您的代码还有其他问题。查看此答案以获取有关如何在 jquery 中定义函数的更多信息。 [这就是你在 jQuery 中定义函数的方式吗？](https://stackoverflow.com/questions/907634/is-this-how-you-define-a-function-in-jquery)

只需一点点重新安排，它就可以在我身上发挥作用。

```
checkDropdown = function() {
  var selects= $("#id1 option:selected").val();
  document.getElementById("filler").innerHTML= selects;
};​ 
```

在这里查看：http: [//jsfiddle.net/kjmuE/](http://jsfiddle.net/kjmuE/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:48:39.727

你的代码全错了。

尝试这个：

```
<!doctype html>
<html><body>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript">    
function checkDropdown() {
  var selects= $("#id1").val();
  $("#filler").text(selects);
}
</script>

<form name="f1">
<select id="id1">
<OPTION Value="none">None</OPTION>
<OPTION Value="one">One</OPTION>
<OPTION Value="two">Two</OPTION>
</select></form>
<p id="filler">Replace this text</p>
</br></br>
<button onClick="checkDropdown()">  CLICK ME  </button>
</form>
</body></html> 
```

1.  您应该创建两个脚本标签。1 在其中加载 jquery，2 在其中定义自己的代码。
2.  您不需要使用 :selected 选择器，因为下拉值始终等于所选选项的值。
3.  不要将 document.getElementById() 与 jQuery 混合使用。坚持一种方法要好得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T19:48:41.337

当您将一个函数传递给 时`$`，它将*在 DOM 准备就绪时*执行。但这不是你想要的。您希望在单击按钮时调用该函数，因此不要将其传递给`$`：

```
<script>
    function checkDropdown() {
        // Simplified version of your code
        var selects = $('#id1').val();
        $('#filler').text(selects);
    }
</script> 
```

您可以通过使用 jQuery 而不是内联事件处理程序绑定事件处理程序来进一步改进您的代码。

[阅读有关`$`别名`jQuery`](http://api.jquery.com/jQuery/#jQuery3)的更多信息。我还建议阅读[jQuery 教程](http://docs.jquery.com/Tutorials%3aGetting_Started_with_jQuery)，它解释了开始使用事件处理程序（以及一般的 jQuery）所需了解的所有内容。

最后，如果您想了解事件的真正运作方式，请阅读[quirksmode.org 上的文章](http://www.quirksmode.org/js/introevents.html)。

* * *

首先没有注意到这一点：您必须在它自己的脚本标签中加载 jQuery。

```
<script src="jquery.js"></script> 
```

再一次，阅读教程，这些东西都在那里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T19:47:56.740

不确定你的 jQuery。尝试这个：

```
var selects= $("#id1").val(); 
```

# jquery - 在一个 DIV 元素中组合 jquery 验证错误

> ID：14146027
> 
> 赞同：1
> 
> 时间：2013-01-03T19:45:17.980
> 
> 标签：jquery, html, jquery-validate

我有一些带有 jquery 验证的表单，我想`div`在表单上方的同一元素中显示所有错误。

我尝试这样做，但不工作：

```
$("#contactForm").validate({
            rules: {
                assunto: { required: true },
                nome: { required: true, minlength: 2 }, 
                email: { required: true, email: true },
                telefone: { required: true },
                mensagem: { required: true }
            }, 
            errorPlacement: function(error, element) {
                if (element.attr("name") == "assunto" || element.attr("name") == "nome" || element.attr("name") == "email" || element.attr("name") == "telefone" || element.attr("name") == "mensagem" )
                //here i think i want to insert the location but i don't know how!
            else
                //here i think i want to insert the location but i don't know how!
            },

            messages: { 
                assunto: {required: 'É necessário escolher um assunto'},
                nome: { required: 'É necessário preencher o campo nome', minlength: 'No mínimo 2 letras' }, 
                email: { required: 'Informe seu email', email: 'Informe um Email válido' },             
                telefone: { required: 'Informe seu Telefone' },
                mensagem: { required: 'Escreva sua Mensagem' }
            },

            submitHandler: function(form){
                var dados = $( form ).serialize();  
                $.ajax({  
                    type: "POST",  
                    url: "enviafaleconosco.asp",
                    data: dados,  
                    success: function( data )  
                    {  
                        alert("Obrigado! Seu contato foi enviado com sucesso. Breve retornaremos!");
                        $("#contactForm")[0].reset();                   
                    }  
                });  
                return false;  
            }           
    }); 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:56:41.427

你在这里有一个语法错误：

```
errorPlacement: function(error, element) {
                if (element.attr("name") == "assunto" || element.attr("name") == "nome" || element.attr("name") == "email" || element.attr("name") == "telefone" || element.attr("name") == "mensagem" )
                //here i think i want to insert the location but i don't know how!
                else
                //here i think i want to insert the location but i don't know how!
            }, 
```

如果 if 和 else 里面没有任何内容，则必须添加大括号`{}`来关闭它们：

```
errorPlacement: function(error, element) {
                if (element.attr("name") == "assunto" || element.attr("name") == "nome" || element.attr("name") == "email" || element.attr("name") == "telefone" || element.attr("name") == "mensagem" ){
                //here i think i want to insert the location but i don't know how!
                } else {
                //here i think i want to insert the location but i don't know how!
                }
            }, 
```

始终将花括号添加到 if 块也是一个好习惯，即使它们是单行的

# google-tv - 用于 Google TV 应用开发的新 YouTube API？

> ID：14146028
> 
> 赞同：0
> 
> 时间：2013-01-03T19:45:18.163
> 
> 标签：google-tv

关于新的 Android 版 YouTube Player API 和 YouTube Data API v3 的新闻，我们可以使用这些 API 来开发原生 Google TV 应用吗？我知道这是因为 Player API 的最低版本是 2.2，而 Google TV 运行的是 3.0 及更高版本，但我只是想 100% 确定。

在连接到这些新 API 进行测试时，Google TV VideoPlayer 示例代码是否是一个明智的模板？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:11:19.883

我们在 Google I/O 上宣布支持 Google TV - 现在可以使用了。[https://developers.google.com/youtube/android/player/](https://developers.google.com/youtube/android/player/)

# javascript - 表单验证：如果多行表单中的数据包含“VP-”，则显示警报

> ID：14146032
> 
> 赞同：0
> 
> 时间：2013-01-03T19:45:41.453
> 
> 标签：javascript, forms, validation

表单验证：如果多行表单中的数据包含“VP-”，则显示警报。我正在尝试编写错误的表单验证表单是否包含“VP-”的代码。

在上一个帖子中，我发现了如何在 1 行提交中执行此操作，但是多行呢？

上一个帖子在这里： [表单验证：如果表单中的数据包含“VP-”，则错误输出](https://stackoverflow.com/questions/14145525/form-validation-if-data-in-form-contains-vp-error-out)

我的代码如下：

```
 <form method='post' name='QuickOrder' onSubmit='return validateQuickOrder(this)'     style="position: relative">
  <div id="DmiACwrap">
    <input type="hidden" name="formName" value="dmiformQuickOrder">
    <input type='Text' name="ProductNumber" id="ProductNumber" title="Enter Product #">
    <input type='Text' name="ProductNumber" id="ProductNumber" title="Enter Product #">
    <input type='Text' name="ProductNumber" id="ProductNumber" title="Enter Product #">
    <input type='Text' name="ProductNumber" id="ProductNumber" title="Enter Product #">
    <input type='Text' name="ProductNumber" id="ProductNumber" title="Enter Product #">
    <input type="submit" class="quick-order-add" value="Add">
  </div>
  </form>

// quick order form validation
function validateQuickOrder(form) {        
  if ((form.ProductNumber.value == "")|| (~form.ProductNumber.value.indexOf('VP') > -1)){
        alert("Please enter an item number.");
        form.ProductNumber.focus();
        return false;
 }
        return true; 
```

}

# shell - sh eval 代码中的错误，“$: not found”？

> ID：14146035
> 
> 赞同：1
> 
> 时间：2013-01-03T19:45:48.283
> 
> 标签：shell, quoting

我有一个为我们的 DD-WRT 路由器编写的 bash 脚本，它会定期重新启动 NAS 守护程序以修复 iPhone 连接到无线的随机问题。

这是我的第一个 bash 脚本之一，我在试图找出如何确定这个问题的根源时迷失了方向。

该脚本会运行，并且会按预期重新启动服务。但是，我收到错误消息：`eval: line 1: $: not found`脚本运行时在终端上。

```
 #!/bin/sh

##
# Restarts the nas daemon on the specified interval
##

# Restart interval, in seconds
#T=3600 # hourly
T=60 # for testing

# Log file
if [ $# -ne 0 ]; then
        log=$1
else
        log=/tmp/restart.log
fi

while [ true ]; do
        # Wait
        sleep $T

        # Find commands to relaunch all nas daemons
        nascmd=`ps ww | grep nas | awk '{if($5!="grep"){$1=$2=$3=$4=""; print $0";"}}'`
        echo [`date`] Existing pid: `ps | grep nas | awk '{ORS=",";if($5!="grep"){print $1}}'` >> $log

        # Restart nas with original arguments
        killall -HUP nas
        echo [`date`] Running command: $nascmd >> $log

        # Strip special characters prior to eval
        safecmd=`echo $nascmd | sed 's/\$/\\$/g'`
        eval $safecmd

        echo [`date`] Finished, new pid: `ps | grep nas | awk '{ORS=",";if($5!="grep"){print $1}}'` >> $log
done 
```

我认为错误源于`eval`它正好是 1 行长。我试图弄清楚`$`它是什么以及为什么找不到它。我会避开所有的美元符号，如果它们存在的话。不应该有，但是，我只是为了安全，以防有人将加密密码短语更改为带有美元符号的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T21:06:38.700

的定义有问题`safecmd`：

```
safecmd=`echo $nascmd | sed 's/\$/\\$/g'` 
```

当 shell 解析反引号字符串时，它会将反斜杠视为引用下一个字符。所以输出存储到的命令`safecmd`是

```
echo $nascmd | sed 's/$/\$/g' 
```

传递给 sed 的正则表达式是`$`，即在行尾匹配。替换文本是`\$`. 所以`safecmd`最终会像

```
/usr/bin/nas --whatever\$ 
```

如果没有正在运行的进程，`nascmd`则最终为空，因此`safecmd`为空`\$`，即执行名称为 的命令`$`。

关于在反引号内引用的规则很复杂，并且它们因 shell 而异（但 BusyBox 静默、破折号、bash、ksh93 和 pdksh 都以相同的方式处理这种特殊情况）。解决方法很简单：永远不要使用反引号，`$(…)`而是使用。除了旧的 Bourne shell 之外，所有 shell 都支持美元括号，除非您维护非常旧的 Unix 服务器，否则您不太可能遇到这种情况。`$(…)`具有直观的语法：只需编写命令，无需额外引用。

您分配的方式可能还有另一个问题`nascmd`，我没有考虑那么多。您的脚本不支持没有`nas`进程运行的情况。

* * *

您的脚本中有许多引用问题，因此如果参数 no`nas`包含任何特殊字符，您将不会执行相同的命令。你引用标志的失败尝试`$`是沧海一粟。首先，**[始终在变量替换和命令替换周围使用双引号](https://unix.stackexchange.com/questions/16303/what-is-the-significance-of-single-and-double-quotes-in-environment-variables/16305#16305)**: `"$foo"`, `"$(foo)"`. 然后，您调用`eval`的根本不是 shell 命令，而是命令名称及其参数，中间有空格字符。您无法可靠地恢复原始命令，因为无法分辨哪些空格是参数的一部分，哪些是参数分隔符。

您可以从 可靠地恢复命令行`/proc/$pid/cmdline`，因为参数由不能在命令内部出现的空字节分隔。但是在 shell 脚本中这样做很麻烦，因为 shell 不能处理空字节。如果您假设换行符不会出现在参数中，这并不难：

```
nas_pid=$(pidof nas)
# <insert a check that $nas_pid contains exactly one PID here>
set -f
IFS='
'
set -- $(</proc/$nas_pid/cmdline tr \\0 \\n)
set +f
# Kill the old NAS pid
kill $nas_pid
# Start a new instance
"$@" 
```

但这一切似乎毫无意义。在某个地方，您必须有一些`nas`在设备启动时启动的东西。当您想重新启动服务时，找到那个东西并再次运行它。

PS 这不是 bash 脚本，而是 sh 脚本。有几种 sh 实现；DD-WRT 与大多数嵌入式设备一样，使用[BusyBox](http://www.busybox.net/)的 sh 。Bash 是另一种 sh 实现；BusyBox sh 中并非所有 bash 功能都存在。

# java - java中的Yamaha DX7 Unit Generator Synth

> ID：14146036
> 
> 赞同：0
> 
> 时间：2013-01-03T19:45:48.637
> 
> 标签：java, class, audio, hierarchy, synthesis

我是今年学习Java的学生。我已经设置了一个任务来编写类层次结构以在 java 中实现 Yamaha DX7 Synthesizer 之类的东西。如果这是一个初学者问题，我很抱歉。但无论如何，我已经在网上梳理了一些教程或信息，但一无所获。

我想问是否有人可以推荐任何网站或教程，甚至可能是此类代码的示例？我在音频合成中发现了许多基于 C/supecolider 的工作，但在 Java 中却很少

它将基于单位生成器主体。（Ugens）。

很抱歉问了这么无聊的问题，我简直不知所措。

非常感谢您的参与。

磷

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T11:04:24.397

也可能感兴趣的是[Bristol Audio Synthesis](http://sourceforge.net/projects/bristol/)，它是各种合成器的开源软件实现，包括 DX 系列。

我怀疑解决这个问题的一半是推导出合成器的数学模型，以便您可以将其表示为单元生成器的网络。

Java 几乎从未用于现实世界的软件综合，因此 Java 中的示例将非常少见。您会遇到的最常见的架构是插件，例如 VST 或 AU——所有这些在概念上都非常相似，并且通常在 C++ 中实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T21:30:00.840

结帐 jfugue [http://www.jfugue.org/](http://www.jfugue.org/)

这是一个受欢迎的图书馆

“JFugue 是一个开源的 Java API，用于编程音乐，没有 MIDI 的复杂性。

JFugue 让编程音乐变得如此简单：

玩家 player = new Player(); player.play("CDEFGA B"); "

# drupal - 关于分类术语和用户角色的 Drupal 过滤器视图

> ID：14146041
> 
> 赞同：2
> 
> 时间：2013-01-03T19:46:11.723
> 
> 标签：drupal, drupal-7, drupal-views

我有一个相当基本的问题，但我不知道如何“很好”地解决它。我有一个包含日历信息的节点类型，我使用视图来使月视图呈现得很好，到目前为止一切都很好。接下来的事情是让日历视图也包含“group_xyz”类型的节点，但仅在用户登录时显示这些事件我设法通过使用几行 PHP 过滤来获取用户 ID 和节点类型，但已经在这里，它感觉不像是一个真正的 drupalish 解决方案......

对于我的问题，我们希望根据用户角色和节点中使用的分类术语来限制日历帖子的显示。

因此，该节点有一个分类术语引用“visibility_to”，可以说是（All、Internal、Administrators）集合之一。用户可以是访客、登录用户或管理员。

现在我想找到一个像这样过滤的好方法：如果节点类型为日历 AND ( (visibility_to == "All") OR ( (visibility_to == "Internal") AND (role=="administrator) 则显示项目" OR role == "logged_in") OR (visisbility_to == "Administrators" AND role =="administrator"))

我想你明白了......我想我可以设法在 PHP 中硬编码，但是当我们添加新角色、新分类术语的那一天，我宁愿使用管理界面配置所有这些......

任何帮助和/或建议表示赞赏。还张贴在 drupal 论坛上：[http ://drupal.org/node/1879238](http://drupal.org/node/1879238)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T20:31:51.287

好的，这就是我如何以“Drupalish”的方式进行操作：

1.  在您的“可见性”词汇表中，我会添加一个**作为角色参考的字段**（在 Drupal 7 中，术语可以有自己的字段——耶！）。您必须下载并启用[角色参考模块](http://drupal.org/project/rolereference)才能设置此类字段。在我的示例中，我将术语的角色引用字段称为“可见性角色”
2.  现在修改所有可见性术语并为每个术语填写新创建的角色字段，主要是设置哪个角色适用于哪个术语。我想您可以直接在节点上而不是在术语后面有角色引用，但这取决于您
3.  在您看来，添加关系“内容：可见性”或任何该术语的名称
4.  最后，添加一个上下文过滤器，将“可见性”术语中的角色与当前用户的角色进行比较。只有在您添加了上述关系后，“可见性角色”字段才会在可用上下文过滤器列表中弹出。选择它作为您的上下文过滤器。选择“提供默认值”和“PHP 代码”作为您的选项。 ***键入以下 php 代码，将与节点的术语关联的角色与当前用户的角色进行比较***：

    ```
    global $user;

    $current_roles = "";
    foreach ($user->roles as $key => $val) {
      $current_roles .= $key;
      if ($val != end($user->roles)){ // If not last item, add a '+' which treats these as an or
        $current_roles .= '+';
      }
    } 

    return($current_roles); 
    ```

***最后，确保展开上下文过滤器下的“更多”选项，并选择允许此过滤器使用多个值。

试试看，让我们知道这是否适合您！！我测试了它，它似乎对我有用。

# c# - 获取字典中包含值 x 的所有键

> ID：14146048
> 
> 赞同：18
> 
> 时间：2013-01-03T19:46:33.823
> 
> 标签：c#, .net, vb.net, dictionary

我有这个：

```
Dictionary<integer, string> dict = new Dictionary<integer, string>(); 
```

我想选择字典中包含 value 的所有项目`abc`。

是否有一个内置功能可以让我轻松做到这一点？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-01-03T19:47:59.243

那么使用 LINQ*相当*简单：

```
var matches = dict.Where(pair => pair.Value == "abc")
                  .Select(pair => pair.Key); 
```

请注意，这甚至不会有一点效率 - 这是一个`O(N)`操作，因为它需要检查每个条目。

如果您需要经常执行此操作，您可能需要考虑使用另一种数据结构——`Dictionary<,>`专为*按键*快速查找而设计。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:00:32.080

内置功能？不抱歉......但另一种（不是那么漂亮）的方法是迭代使用`foreach(KeyValuePair<integer, string> ...`

# python - Python：将 range() 与 " ".join() 一起使用

> ID：14146050
> 
> 赞同：2
> 
> 时间：2013-01-03T19:46:48.160
> 
> 标签：python, string, join, integer, range

```
x = WAIT100MS
subroutines = ["WAIT"+str(range(1,256))+"MS"]
if x in subroutines:
    print "success"
else:
    print "invalid" 
```

我正在尝试创建一段代码，其中 if`WAITXMS`介于`1`and之间`255`，它将被接受，否则不会。range() 函数只生成一个列表，所以我想我可以使用

`" ".join("WAIT"+str(range(1,256))+"MS")`,

最后得到一个字符串，如`x`. 但是，使用`join()`with 函数`range()`似乎不像我期望的那样工作，而是给了我一个正常的列表，如`"WAIT[1,2,3,4,...]MS"`. 我应该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T19:48:26.433

我想你想要这样的东西：

```
''.join("WAIT%dMS"%i for i in range(1,256)) 
```

这是我认为更好的方法：

```
def accept_string(s):
    try:
        i = int(s[4:-2])
    except ValueError:
        return False
    return s.startswith('WAIT') and s.endswith('MS') and (1 <= i < 256) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T19:50:57.760

我会做类似的事情：

```
x = "WAIT100MS"
m = re.match(r"WAIT(\d+)MS$", x)
accept = m is not None and 1 <= int(m.group(1)) <= 255 
```

我认为迭代所有可接受的数字（更不用说构建和存储所有`WAIT<n>MS`字符串）是不必要的浪费。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:00:36.197

当你可以切片时，为什么要重新？

```
x = 'WAIT100MS'
n = int(x[4:-2])
if 1 < n < 256:
    print 'success'
else:
    print 'invalid' 
```

# perl - 我将如何在 Perl 中模拟 xcopy 命令？

> ID：14146053
> 
> 赞同：1
> 
> 时间：2013-01-03T19:47:29.340
> 
> 标签：perl, batch-file, xcopy

Perl 对我来说是一门新语言。我一直在写批处理文件。我有一个作为批处理文件编写的脚本，我试图将其转换为 Perl。这是我的批处理文件：

```
 @echo off
    :LOOP
    echo File Copy Started 
    xcopy /s /Y  "Source" "Destination"
    echo File Copy Completed 
    TIMEOUT /T 80
    goto :LOOP 
```

所以我正在尝试弄清楚 Perl 中是否有类似于 xcopy 的命令，或者我是否需要找出其他方法来在 Pearl 中创建相同的函数。任何帮助都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:54:47.153

正如 ikegami 在评论中指出的那样，没有一个 Perl 命令可以执行此[`xcopy`](http://en.wikipedia.org/wiki/XCOPY)操作。虽然您*可以*编写一些代码来重新实现在 Perl 中的递归文件复制（例如，按照建议使用[File::Find](http://search.cpan.org/perldoc?File%3a%3aFind)或[File::Find::Rule](http://search.cpan.org/perldoc?File%3a%3aFind%3a%3aRule)和[File::Copy](http://search.cpan.org/perldoc?File%3a%3aCopy)），但更简单的解决方案可能是`xcopy`从 Perl调用[`system`](http://perldoc.perl.org/functions/system.html)：

```
system qw(xcopy /s /Y), $source, $destination; 
```

**编辑：**或者只使用CPAN 中的[File::Copy::Recursive](http://search.cpan.org/perldoc?File%3a%3aCopy%3a%3aRecursive)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T21:06:32.863

有这个，

*   [文件::复制](http://perldoc.perl.org/File/Copy.html)
*   [文件::查找::规则](http://search.cpan.org/perldoc?File%3a%3aFind%3a%3aRule)

您可以使用它们自己实现它，但是对于一种可能有用的语言来说是新手：

```
system qw(xcopy /s /Y), $source, $destination; 
```

但是，如果您正在编写性能优化代码，则不应使用它。

# wordpress - get_results 返回不迭代

> ID：14146054
> 
> 赞同：0
> 
> 时间：2013-01-03T19:47:37.693
> 
> 标签：wordpress

我正在创建 WP 插件，这是我的代码

```
$cmdb = new wpdb(DB_USER,DB_PASSWORD, DB_NAME, DB_HOST);  
    $retval = '';  

    echo '<table align="center">';
    echo '<th>Coupon ID</td>';
    echo '<th>Coupon Name</td>';
       echo '<th>Coupon Text</td>';
    echo '<th>Please Select Order</td>';

            $coupon_count = $cmdb->get_results("SELECT * FROM coupons");  
            var_dump($product_count);

        foreach($coupon_count as $cc)
{
echo '<tr>';
echo '<td>';
echo '<input type="label" value="'.$cc->id.'"';
echo '<input type="text" value="'.$cc->title.'"';
echo '<input type="text" value="'.$cc->subtitle.'"';
echo '<select></select>';

echo '</td>';
echo '</tr>';

}
echo '</table>'; 
```

但输出是！[在此处输入图像描述][1] 我不知道为什么它没有显示剩余的东西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:55:16.643

你用[`wpdb`](http://codex.wordpress.org/wpdb)错了。不要让你自己的 var 使用 WordPress 的。

```
global $wpdb;
$coupon_count = $wpdb->get_results("SELECT * FROM coupons"); 
```

WordPress中的表格也需要前缀。

# android - 检索自定义 Parcelable 时出现空指针异常

> ID：14146066
> 
> 赞同：1
> 
> 时间：2013-01-03T19:47:59.307
> 
> 标签：android, arraylist, nullpointerexception, custom-attributes, parcelable

所以我一直在看 StackOverFlow，似乎找不到完全解决我问题的话题。许多人在尝试使用自定义 Parcelable 时遇到空指针异常问题。我已经看到通过将静态添加到 parcelable 类中的 CREATOR 等简单的解决方案解决了问题。但是，我没有找到任何可以帮助我的事业或对我的处境有所启发的东西。

从名为 MyPointsList 的自定义类访问坐标的 ArrayList 时，出现空指针异常。在通过 MyPointsList 之前，我可以访问 MyPointsList 中的 ArrayList。检索实例后，我快速检查以确保实例不为空，它不是，然后继续访问我得到空指针异常的 ArrayList。

为什么我在访问 MyPointsList 中的 ArrayList 时在接收类中收到空指针异常？

以下是以下类的代码：

MyPoint.java

```
public class MyPoint implements Parcelable {
    private int x;
    private int y;

    public MyPoint(){
        this.x = 0;
        this.y = 0;
    }

    public MyPoint(Parcel in){
        this.x = 0;
        this.y = 0;
        readFromParcel(in);
    }

    public void setPoint(int px, int py){
        this.x = px;
        this.y = py;
    }

    public int getX(){return this.x;}

    public int getY(){return this.y;}

    public static final Parcelable.Creator <MyPoint> CREATOR = new Parcelable.Creator <MyPoint> (){
        public MyPoint createFromParcel(Parcel source) {
            // TODO Auto-generated method stub
            return new MyPoint(source);
        }

        public MyPoint[] newArray(int size) {
            // TODO Auto-generated method stub
            return new MyPoint[size];
        }       
    };

    public int describeContents() {
        // TODO Auto-generated method stub
        return 0;
    }

    public void writeToParcel(Parcel dest, int flags) {
        dest.writeInt(x);
        dest.writeInt(y);

    }

public void readFromParcel(Parcel in){
        int count = in.dataAvail();
        for(int i = 0; i < count; i++){
            x = in.readInt();
            i++;
            y = in.readInt();
        }
    }
} 
```

MyPointsList.java

```
public class MyPointsList implements Parcelable {

    private ArrayList<MyPoint> arrList = new ArrayList<MyPoint>();
    private int myInt = 0;
    private String myString = null;

    public String getString(){return myString;}

    public void setString(String str){this.myString = str;}

    public MyPoint getMyPoint(int index){return this.arrList.get(index);}

    public ArrayList<MyPoint> getArrayList(){return arrList;}

    public void setArrayList(ArrayList<MyPoint> arr){this.arrList = arr;}

    public int getMyInt(){return myInt;}

    public void setMyInt(int newInt){this.myInt = newInt;}

    MyPointsList(){this.arrList = new ArrayList<MyPoint>();}

    public MyPointsList(Parcel in){
        myInt = in.readInt();
        myString = in.readString();
        arrList = new ArrayList<MyPoint>();
        in.readTypedList(arrList, MyPoint.CREATOR);
    }

    public int describeContents() {
        // TODO Auto-generated method stub
        return 0;
    }

    public void writeToParcel(Parcel out, int flags) {
        // TODO Auto-generated method stub
        out.writeInt(myInt);
        out.writeString(myString);
        out.writeTypedList(arrList);
    }

    public static final Parcelable.Creator<MyPointsList> CREATOR = new Parcelable.Creator<MyPointsList>(){

        public MyPointsList createFromParcel(Parcel source) {
            // TODO Auto-generated method stub
            return new MyPointsList(source);
        }

        public MyPointsList[] newArray(int size) {
            // TODO Auto-generated method stub
            return new MyPointsList[size];
        }   
    };
} 
```

打包段：points 是 MyPoints 的 ArrayList

```
public void onClick(View v){
    MyPointsList object = new MyPointsList();
        object.setMyInt(100);
        object.setArrayList(points);
        Log.d("DEBUG", object.getMyPoint(5).getX() + " " + object.getMyPoint(5).getY() + " ");
        Intent goBack = new Intent(SignHereActivity.this, Menu.class);
        goBack.putExtra("parcel" , object);             
        SignHereActivity.this.startActivity(goBack);
    }
}); 
```

检索段

```
public void getIntentData(){
    Intent i = this.getIntent();
    if(i.hasExtra("parcel")){
        Bundle b = getIntent().getExtras();
        object = b.getParcelable("parcel");
        Log.d("Debug", object.getArrayList().get(5).getX() + " " + object.getArrayList().get(5).getY());
    }
} 
```

如前所述，我一直在浏览我能找到的与我的问题相关的任何信息。我非常感谢任何输入和响应。对于我的代码中任何烦人的语法或令人困惑的部分，我深表歉意。作为一个整体，我对 java 和 Android 还是很陌生。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T17:37:36.303

我觉得自己像个傻瓜，但是如果其他人偶然发现了这一点，这就是解决方案。

从 MyPoint 中删除：

```
public void readFromParcel(Parcel in){
    int count = in.dataAvail();
    for(int i = 0; i < count; i++){
        x = in.readInt();
        i++;
        y = in.readInt();
    }
} 
```

插入到 MyPoint：

```
public void readFromParcel(Parcel in){
    x = in.readInt();
    y = in.readInt();
} 
```

就是这样。

# jquery - 从链接中删除下划线和蓝色

> ID：14146072
> 
> 赞同：3
> 
> 时间：2013-01-03T19:48:13.670
> 
> 标签：jquery, asp.net, html

我正在尝试禁用两个锚标记，但无法删除下划线。我也想去掉蓝色。这就是我所拥有的，它没有删除下划线。我已经尝试将文本装饰设置为`none`和`none !important`

```
 $(document).ready(function ()
        {
            // See if doc upload View and Remove panel is displayed --> do they currently have a document uploaded 
            var isInline = $("#ctl00_contentMain_pnlAuthorizationForReleaseViewUploadDocument").css('display');

            // if so disable upload and electronic sig links
            if (isInline == "inline")
            {
                //Disable Upload Link after document is uploaded
                $("#ctl00_contentMain_btnUpload").attr('onclick', '').click(function (e) {
                    e.preventDefault();
                });
                $("#ctl00_contentMain_btnUpload").attr('href', '');
                $("#ctl00_contentMain_btnUpload").attr('text-decoration', 'none !important');

                //Disable Electronic Sign Link after document is uploaded
                $("#ctl00_contentMain_lnkESign").attr('onclick', '').click(function (e) {
                    e.preventDefault();
                });
                $("#ctl00_contentMain_lnkESign").attr('href', '');
                $("#ctl00_contentMain_lnkESign").attr('text-decoration', 'none !important');
            }

        }); 
```

这是`aspx`代码

```
<asp:LinkButton ID="lnkESign" 
                runat="server" 
                Text="sign"  
                TabIndex="1" 
                OnClick="lnkESign_Click">

<asp:LinkButton ID="lnkDownloadReleasefrm" runat="server" Text="Download"
                                        TabIndex="1"></asp:LinkButton>

Which renders this HTML

<a id="ctl00_contentMain_lnkESign" href="" tabindex="1" onclick="" text-decoration="none !important">sign</a>

<a href="" tabindex="2" id="ctl00_contentMain_btnUpload" onclick="" text-decoration="none !important">Upload </a> 
```

* * *

编辑

这是我最终使用的代码

```
 $("#ctl00_contentMain_btnUpload").attr('href', '').css('text-decoration', 'none').css('color', 'black').attr('onclick', '').click(function (e) {
        e.preventDefault();
    }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-03T19:50:53.637

`text-decoration`不是属性..这是css中的规则。你应该像下面这样尝试，

```
$("#ctl00_contentMain_lnkESign").css('text-decoration', 'none'); 
```

**注意：**不需要，`!important`因为这将是一个内联样式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T19:51:58.950

而不是`.attr(key, value)`使用`.css(key, value)`

您将无法更改 :hover 、 :visited 等颜色，因为这些伪样式仅适用于样式表。将一个类添加到您的 css 文件中可能是有意义的`.disabled`，然后将该 css 类添加到链接中`.addClass()`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:03:48.290

您可能还需要考虑在样式表中为禁用的锚定义一个类，该锚控制`color`和`text-decoration`使用 jquery 来切换该类，而不是使用内联样式。

**CSS**

```
/* Applied to all anchors for default enabled appearance */
.anchor
{
  ...
}

/* Applied to display a disabled anchor */
.anchor.disabled
{
  color: #ddd;
  text-decoration: none;
} 
```

**JavaScript**

```
$("#ctl00_contentMain_lnkESign").toggleClass('disabled'); 
```

# c# - 如何输入 4 个形状的值？

> ID：14146073
> 
> 赞同：0
> 
> 时间：2013-01-03T19:48:20.350
> 
> 标签：c#, object

如何将我的四个形状放入我创建的对象数组中？使用

```
shapeArray[0] = (1,2,3,4) 
```

这是我能想到的，这显然是不正确的......

```
struct Shapes
{
    private int width;
    private int height;
    private int xAxis;
    private int yAxis;
}

Shapes[] shapeArray = new Shapes[4]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:59:14.463

你应该为你的 Shape 添加一个新的构造函数：

```
struct Shape
{
    public Shape(int width, int height, int xAxis, int yAxis)
    {
        this.width = width;
        this.height = height;
        this.xAxis = xAxis;
        this.yAxis = yAxis;
    }

    private int width;
    private int height;
    private int xAxis;
    private int yAxis;

    public int Width { get { return width; } }
    public int Height { get { return height; } }
    public int XAxis { get { return xAxis; } }
    public int YAxis { get { return yAxis; } }
} 
```

然后你可以用它来创建它：

```
Shape[] shapes = new Shape[]{
    new Shape(1, 2, 3, 4),
    new Shape(2, 4, 6, 8),
    new Shape(1, 2, 3, 4),
    new Shape(4, 3, 2, 1)
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:57:59.290

由于您没有为您创建[构造函数](http://msdn.microsoft.com/en-us/library/aa288208.aspx)`Shapes`，因此您必须明确设置属性

```
shapeArray[0] = new Shapes;
shapeArray[0].width = 1; 
shapeArray[0].height = 2;
shapeArray[0].xAxis = 3;
shapeArray[0].yAxis = 4; 
```

然而，正确的方法（并避免使用可变结构）是将公共字段私有化并将构造函数添加到您的结构中：

```
public Shapes(int width, int height, int xAxis, int yAxis)
{ 
    this.width = width; 
    this.height = height;
    this.xAxis = xAxis;
    this.yAxis = yAxis;
} 
```

然后你就用

```
shapeArray[0] = new Shapes(1, 2, 3, 4); 
```

# c - 文件获取C中的内容

> ID：14146074
> 
> 赞同：2
> 
> 时间：2013-01-03T19:48:21.033
> 
> 标签：c, file-io, character-arrays

将文件内容放入单个字符数组的最佳方法是什么？

我读过这个问题：

[在 C 中获取文件内容的最简单方法](https://stackoverflow.com/questions/174531/easiest-way-to-get-files-contents-in-c)

但是从评论中，我发现该解决方案不适用于大文件。我确实可以访问 stat 功能。如果文件大小超过 4 GB，我应该只返回一个错误吗？

文件的内容是加密的，因为它是由用户提供的，所以它可以像任何人想要的一样大。如果文件太大，我希望它返回错误并且不会崩溃。用文件的内容填充字符数组的主要目的是将其与另一个字符数组进行比较，并且（如果需要并配置为这样做）将这两者记录到一个日志文件（或多个日志文件，如果需要）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:28:06.980

您可以使用`fstat(3)`from `sys/stat.h`。这是一个获取文件大小的小函数，如果文件小于 4GB，则分配内存，~~否则返回 (-1)。它将文件读取到传递给`char *buffer`~~char * 的 char 数组中，其中包含整个文件的内容。使用后应该是 free 的。

```
#include <stdio.h>
#include <sys/stat.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>
#include <fcntl.h>

char *loadlfile(const char *path)
{
    int file_descr;
    FILE *fp;
    struct stat buf;
    char *p, *buffer;

    fstat((file_descr = open(path, O_RDONLY)), &buf);

// This check is done at preprocessing and requires no check at runtime.
// It basically means "If this machine is not of a popular 64bit architecture,
// it's probably not 128bit and possibly has limits in maximum memory size.
// This check is done for the sake of omission of malloc(3)'s unnecessary
// invocation at runtime.

//    Amd 64               Arm64                      Intel 64       Intel 64 for Microsofts compiler.
#if !defined(__IA_64) || !defined(__aarch64__) || !defined(__ia64__) || !defined(_M_IA64)
#define FILE_MAX_BYTES (4000000000)
    // buf.st_size is of off_t, you may need to cast it.
    if(buf.st_size >= FILE_MAX_BYTES-1)
        return (-1);
#endif

    if(NULL == (buffer = malloc(buf.st_size + 1)))
        return NULL;

    fp = fdopen(file_descr, "rb");

    p = buffer;
    while((*p++ = fgetc(fp)) != EOF)
        ;
    *p = '\0';

    fclose(fp);
    close(file_descr);
    return buffer;
} 
```

可以在@ [http://sourceforge.net/p/predef/wiki/Home/](http://sourceforge.net/p/predef/wiki/Home/)找到一个非常广泛的用于各种事物的预定义宏列表。架构和文件大小检查的原因是，`malloc`有时可能会很昂贵，最好在不需要时省略/跳过它的使用。并查询最大的内存。整个 4gb 存储块的 4gb 只是浪费了那些宝贵的周期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:56:40.257

如果我正确理解了您的问题，请从那个人的代码中执行：

```
 char * buffer = 0;
    long length;
    FILE * f = fopen (filename, "rb");

    if (f)
    {
    fseek (f, 0, SEEK_END);
    length = ftell (f);
    if(length > MY_MAX_SIZE) {
          return -1;
    }

     fseek (f, 0, SEEK_SET);
     buffer = malloc (length);
    if (buffer)
    {
    fread (buffer, 1, length, f);
    }
    fclose (f);
    }

    if (buffer)
    {
      // start to process your data / extract strings here...
    } 
```

# r - Ubuntu 安装上的 R BayesVarSel

> ID：14146076
> 
> 赞同：1
> 
> 时间：2013-01-03T19:48:26.243
> 
> 标签：r, ubuntu, g++, gnu, gsl

我正在尝试将`BayesVarSel`软件包安装在`ubuntu`12 盒上`AWS EC2`。它在我的 Windows 7 机器（`R 2.15.1`）上运行良好。

我附上了错误消息的屏幕截图。这似乎是 GNU GSL 库的问题。我找不到安装 GSL 的快速方法（即 sudo apt-get GSL 等），所以我想看看其他人是否有类似的问题。我对其他具有类似功能的软件包持开放态度。![在此处输入图像描述](../Images/4dafe5f05ff9bd83f51dd4d9117736e4.png)

编辑：我尝试过的其他几件事没有运气： ![在此处输入图像描述](../Images/f8db5e2d9ad2f8a96be7069dc5bc1a2d.png)

![在此处输入图像描述](../Images/9c818ba892c020ccce9082b3c7e30f49.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:50:27.447

做

```
 apt-cache search libgsl 
```

一切都应该清楚一点。这些软件包的存在时间比 Ubuntu 或 Amazon EC2 都长，因此真的不应该花费超人的精力来找到它们。

如果`apt-cache search libgsl`太难，请尝试[packages.ubuntu.com](http://packages.ubuntu.com) ，您可以在其中搜索包含错误消息中的文件的包（例如`/usr/include/gsl/gsl_vector.h`）和“是的，Veronica”，您也可以搜索子字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T21:43:48.597

我能够使用在 VirtualBox 中运行的 Ubuntu 12.04.1 LTS（桌面）重新创建错误。正如@Dirk Eddelbuettel 建议的那样，`sudo apt-cache search libgsl`生成了一个有用的软件包列表。目前尚不清楚为什么这在您的机器上不起作用。

我安装了 libgsl：

```
sudo apt-get install libgsl0ldbl
sudo apt-get install libgsl0-dev 
```

现在`BayesVarSel`编译和加载没有错误。

# php - 从字符串中删除一些文本

> ID：14146096
> 
> 赞同：0
> 
> 时间：2013-01-03T19:49:19.823
> 
> 标签：php, string, variables, gravity

我有一个 PHP 变量，它在页面上输出一些文本，即这是它输出的文本

`http://URL.com/uploads/gravity_forms/3-464e6bdac9890814218993b7e45c1736/2013/01/hehehecsv10.csv`

我想从这个文本中删除所有内容，只显示 hehehecsv10.csv ，我将如何在 PHP 中执行此操作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:51:43.890

您正在寻找的功能称为[`basename()`^(*Docs*)](http://php.net/basename)：

```
$string = 'http://URL.com/uploads/gravity_forms/3-464e6bdac9890814218993b7e45c1736/2013/01/hehehecsv10.csv';
echo basename($string); # hehehecsv10.csv 
```

输出如评论所示，如果您需要使用它，请[尝试演示。](http://eval.in/5874)

另请参阅与 somehwat 相关的问题：

*   [PHP - 剥离 URL 以获取标签名称](https://stackoverflow.com/q/3373936/367456)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:51:40.610

```
$str = 'http://URL.com/uploads/gravity_forms/3-464e6bdac9890814218993b7e45c1736/2013/01/hehehecsv10.csv';

echo end(explode("/",$str));
echo basename($str); 
```

# java - 接收可序列化对象并显示内容

> ID：14146102
> 
> 赞同：0
> 
> 时间：2013-01-03T19:49:42.440
> 
> 标签：java, object, serialization

我正在用 java 编写一个应用程序，它将一个对象发送到一个套接字。在连接的另一端，我有另一个需要接收对象并显示内容的应用程序......

我让我的应用程序使用扫描仪接收文本。

```
in = new Scanner(socket.getInputStream());
while (in.hasNext()
{
   system.out.println(in.next)
} 
```

但是，当我尝试使用相同的方法发送对象时，代码是不可编译的。printNumber() 是我试图发送的对象中的一个杂项。

```
in = new Scanner(socket.getInputStream());
while (in.hasNext()
{
   system.out.println(in.printNumber())
} 
```

我曾尝试通过互联网查找教程或其他内容来解释我应该做什么，但我实际上并不知道我真正在寻找什么。谁能指出我正确的方向？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:53:52.413

你如何序列化数据？

如果您使用 ObjectOutputStream，则需要 ObjectInputStream 来读取它。

如果您使用 XMLEncoder，则需要 XMLDecoder 才能读取它。

对于每个序列化器，都有一个适当的反序列化器，您必须使用匹配的反序列化器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:57:39.413

首先，您不是在发送的对象上调用方法，而是在`Scanner`. 不`printNumber()`，存在于`Scanner`类中。

其次，不要对序列化对象使用扫描仪，`Scanner`它是专为文本输入而设计的。改用`ObjectInputStream`：

```
in = new ObjectInputStream(socket.getInputStream()); 
System.out.println(in.readObject()); 
```

# python - 为什么 Python 允许您从函数内部将局部变量实例化为全局变量？

> ID：14146106
> 
> 赞同：2
> 
> 时间：2013-01-03T19:50:00.693
> 
> 标签：python, scope, global-variables

为什么下面的代码在 Python 中工作，而不是先在全局范围内声明**a ？**

```
def setA():
   global a 
   a = 5

def printA():
    print a

setA()
printA() 
```

在我看来，这是正确的方法：

```
a = None

def setA():
   global a 
   a = 5

def printA():
    print a

setA()
printA() 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-03T19:52:14.970

基本上与创建新局部变量的原因相同`a = 5`：当您分配一个变量时，Python 不在乎它是否已经存在。该`global`声明仅表示“在此范围内使用以下名称的任何使用现在都被视为在全局范围内运行”。

无论是否存在，您都可以`a = 5`在模块顶层执行。`a`所以你可以`global a; a = 5`在一个函数里面做。 `global`使函数内部的赋值就像全局级别的赋值一样工作，包括名称是否已经存在并不重要这一事实。

# android - 当我们在 Android 上连接到 Wi-Fi 网络时，如何避免自动吐司？

> ID：14146112
> 
> 赞同：0
> 
> 时间：2013-01-03T19:50:12.613
> 
> 标签：android, android-wifi

在 Android 中，当我们连接到 Wi-Fi 时会显示自动吐司。即使我们以编程方式连接。是否可以以编程方式避免这种自动吐司？如果不是，请解释原因。如果是，我该怎么做？

像“不要那样做”或“你为什么要那样做”这样的答案是没有用的。就我而言，这很重要，否则我不会问。

# c# - C#：正则表达式不匹配一组单词

> ID：14146118
> 
> 赞同：3
> 
> 时间：2013-01-03T19:50:43.143
> 
> 标签：c#, regex, c#-4.0, regex-negation

我需要一个正则表达式来匹配不在一组单词中的单词。我用谷歌搜索和堆积问题，发现了一些建议。但它们都是关于匹配一组字符，而不是单词。所以我试着自己写一个正则表达式。但我找不到正确的正则表达式。这是我到目前为止尝试的最后一个：

```
(?:(?!office|blog).)+ 
```

我的话是`office`，和`article`。我想要输入不在此组中的单词。你能帮我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T19:57:22.647

我认为你的正则表达式应该是这样的：

```
Regex r = new Regex(@"\b(?!office|blog|article)\w+\b");
MatchCollection words = r.Matches("The office is closed, please visit our blog");

foreach(Match word in words)
{
   string legalWord = word.Groups[0].Value;
   ...
} 
```

这将返回“The”、“is”、“closed”、“please”、“visit”和“our”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:27:04.923

不太清楚你的问题。因为你尝试使用**办公室|博客**的正则表达式模式，但在下一行你说你的词是**办公室**和**文章**。好的，我在这里用这 3 个词（**办公室、博客、文章**）尝试。使用它根据您的需要，

```
Pattern pattern = Pattern.compile("(\\w+|\\W)");
Matcher m = pattern.matcher("Now the office is closed,so i spend time with blog and article writing");
while (m.find())
{
    Pattern pattern1 = Pattern.compile("office|blog|article"); //change it as your need
    Matcher m1 = pattern1.matcher(m.group());

    if(m1.find())
    {
        System.out.print(m.group().replace(m.group(),""));
    }
    else
        System.out.print(m.group());
} 
```

**输出：**

> 现在关门了，所以我花时间和写作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-28T14:34:52.080

试图自己解决这个问题。在这里找到我的答案：[http ://www.regextester.com/15](http://www.regextester.com/15)

正则表达式：^((?!badword).)*$

这是什么意思：

*   ^$：仅匹配整个搜索字符串（开始 (^) 和结束 ($)）。
*   ()*：匹配 0 个或多个包含的内容。
*   (?!badword)：向前看当前字符，并确保“badword”作为一个整体不匹配。
*   .: 匹配任何单个字符。

重要的是，这一次只匹配一个字符，并且在匹配每个字符后，检查以确保“badword”不会**立即**出现。

# c# - 无法分配——方法组？

> ID：14146119
> 
> 赞同：0
> 
> 时间：2013-01-03T19:50:44.750
> 
> 标签：c#

在以下 C# 代码片段中：

```
static XmlNodeList TSList()
    //  This function returns an XML list of all Documents in the library with a status that needs to be audited.
    //  It uses the URL and Library Name found in the project property settings 
{
    CPAS_ListSVC.Lists listService = new CPAS_ListSVC.Lists();
    listService.Credentials = System.Net.CredentialCache.DefaultCredentials;
    listService.Url = Properties.Settings.Default.CPAS_ListService_URL;                           //"http://moss.mava.micron.com/FACSEC/mtvfacilities/MTVCONSTRUCTION/CPAS/_vti_bin/lists.asmx";
    //System.Xml.XmlNode activeItemData = listService.GetListItems("CPAS_Vendor_Timesheets", "{BD56DAD6-8C4F-4BC8-9848-9293D83F4338}", null, null, "500", null, "");
    XmlNode activeItemData = listService.GetListItems(Properties.Settings.Default.Timesheet_Library_Name, Properties.Settings.Default.View_GUID, null, null, "500", null, "");
    // Set up the XML documents the listservice will retrieve.
    XmlDocument doc = new XmlDocument();
    string temp = activeItemData.InnerXml.Replace("\ref\ref", "");
    doc.LoadXml(temp);
    XmlNamespaceManager nsmgr = new XmlNamespaceManager(doc.NameTable);
    nsmgr.AddNamespace("z", "#RowsetSchema");
    nsmgr.AddNamespace("rs", "urn:schemas-microsoft-com:rowset");
    TSList = (XmlNodeList) doc.SelectNodes("/rs:data/z:row", nsmgr);
} 
```

我收到错误“无法分配给'TSList'，因为它是'方法组'......为什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-03T19:51:37.913

正如该方法明确指出的那样，您不能将某些内容分配给函数。

要返回一个值，请使用以下`return`语句：

```
return doc.SelectNodes("/rs:data/z:row", nsmgr); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T19:53:12.047

看起来您正在将一些 VB 语法与 c# 混合。将最后一行更改为以下内容：

```
return (XmlNodeList) doc.SelectNodes("/rs:data/z:row", nsmgr); 
```

# python - 解析重复的子元素python

> ID：14146121
> 
> 赞同：0
> 
> 时间：2013-01-03T19:50:56.917
> 
> 标签：python, xml, repeat

我正在尝试使用 Python 解析包含重复子元素的 XML 文档。当我尝试解析数据时，它会创建一个空文件。如果我注释掉重复的子元素代码（请参阅下面的 python 脚本中的粗体部分），则文档会正确生成。有人可以帮忙吗？

**XML:**

```
<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<FRPerformance xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <FRPerformanceShareClassCurrency>
    <FundCode>00190</FundCode>
    <CurrencyID>USD</CurrencyID>
    <FundShareClassCode>A</FundShareClassCode>
    <ReportPeriodFrequency>Quarterly</ReportPeriodFrequency>
    <ReportPeriodEndDate>06/30/2012</ReportPeriodEndDate>
    <Net>
      <Annualized>
        <Year1>-4.909000000</Year1>
        <Year3>10.140000000</Year3>
        <Year5>-22.250000000</Year5>
        <Year10>-7.570000000</Year10>
        <Year15>-4.730000000</Year15>
        <Year20>-0.900000000</Year20>
        <SI>1.900000000</SI>
      </Annualized>
    </Net>
    <Gross>
      <Annualized>
        <Month3>1.279000000</Month3>
        <YTD>7.294000000</YTD>
        <Year1>-0.167000000</Year1>
        <Year3>11.940000000</Year3>
        <Year5>-21.490000000</Year5>
        <Year10>-7.120000000</Year10>
        <Year15>-4.420000000</Year15>
        <Year20>-0.660000000</Year20>
        <SI>2.110000000</SI>
      </Annualized>
      <Cumulative>
        <Month1Back>2.288000000</Month1Back>
        <Month2Back>-1.587000000</Month2Back>
        <Month3Back>0.610000000</Month3Back>
        <CurrentYear>7.294000000</CurrentYear>
        <Year1Back>-2.409000000</Year1Back>
        <Year2Back>13.804000000</Year2Back>
        <Year3Back>20.287000000</Year3Back>
        <Year4Back>-78.528000000</Year4Back>
        <Year5Back>-0.101000000</Year5Back>
        <Year6Back>9.193000000</Year6Back>
        <Year7Back>2.659000000</Year7Back>
        <Year8Back>9.208000000</Year8Back>
        <Year9Back>25.916000000</Year9Back>
        <Year10Back>-3.612000000</Year10Back>
      </Cumulative>
      <HistoricReturns>
        <HistoricReturns_Item>
          <Date>Fri, 28 Feb 1997 00:00:00 -0600</Date>
          <Return>32058.090000000</Return>
        </HistoricReturns_Item>
        <HistoricReturns_Item>
          <Date>Fri, 28 Feb 2003 00:00:00 -0600</Date>
          <Return>36415.110000000</Return>
        </HistoricReturns_Item>
        <HistoricReturns_Item>
          <Date>Fri, 29 Feb 2008 00:00:00 -0600</Date>
          <Return>49529.290000000</Return>
        </HistoricReturns_Item>
        <HistoricReturns_Item>
          <Date>Fri, 30 Apr 1993 00:00:00 -0600</Date>
          <Return>21621.500000000</Return>
        </HistoricReturns_Item>
</<HistoricReturns> 
```

**Python 脚本**

```
## Create command line arguments for XML file and tageName
xmlFile = sys.argv[1]
tagName = sys.argv[2]

tree = ET.parse(xmlFile)
root = tree.getroot()

## Setup the file for output
saveout = sys.stdout
output_file =  open('parsedXML.csv', 'w')
sys.stdout = output_file

## Parse XML

for node in root.findall(tagName):
    fundCode = node.find('FundCode').text
    curr = node.find('CurrencyID').text
    shareClass = node.find('FundShareClassCode').text
    for node2 in node.findall('./Net/Annualized'):
        year1 = node2.findtext('Year1')
        year3 = node2.findtext('Year3')
        year5 = node2.findtext('Year5')
        year10 = node2.findtext('Year10')
        year15 = node2.findtext('Year15')
        year20 = node2.findtext('Year20')
        SI = node2.findtext('SI')
        for node3 in node.findall('./Gross'):
            for node4 in node3.findall('./Annualized'):
                month3 = node4.findtext('Month3')
                ytd = node4.findtext('YTD')
                year1g = node4.findtext('Year1')
                year3g = node4.findtext('Year3')
                year5g = node4.findtext('Year5')
                year10g = node4.findtext('Year10')
                year15g = node4.findtext('Year15')
                year20g = node4.findtext('Year2')
                SIg = node4.findtext('SI')
            for node5 in node3.findall('./Cumulative'):
                month1b = node5.findtext('Month1Back')
                month2b = node5.findtext('Month2Back')
                month3b = node5.findtext('Month3Back')
                curYear = node5.findtext('CurrentYear')
                year1b = node5.findtext('Year1Back')
                year2b = node5.findtext('Year2Back')
                year3b = node5.findtext('Year3Back')
                year4b = node5.findtext('Year4Back')
                year5b = node5.findtext('Year5Back')
                year6b = node5.findtext('Year6Back')
                year7b = node5.findtext('Year7Back')
                year8b = node5.findtext('Year8Back')
                year9b = node5.findtext('Year9Back')
                year10b = node5.findtext('Year10Back')
        **for node6 in node.findall('./HistoricReturns'):
            for node7 in node6.findall('./HistoricReturns_Item'):
                hDate = node7.findall('Date')
                hReturn = node7.findall('Return')**
                print(fundCode, curr, shareClass,year1, year3, year5, year10, year15, year15, year20, SI,month3, ytd, year1g, year3g, year5g, year10g, year15g, year20g, SIg, month1b, month2b, month3b, curYear, year1b, year2b, year3b, year4b, year5b, year6b, year7b, year8b,year9b,year10b, hDate, hReturn) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:52:00.673

示例 XML 和 python 代码在结构上不匹配。任何一个

*   您缺少`</Gross>`XML 中的结束标记（应该在该`<HistoricReturns>`部分开始之前） - 在这种情况下，代码是正确的或
*   代码应该是`for node6 in node3.findall('./HistoricReturns'):`ie`node3`而不是`node`

注意 XML 示例不完整（它不是格式良好的 XML），因为它缺少 的结束标记`Gross`，`FRPerformanceShareClassCurrency`因此`FRPerformance`无法明确回答问题。希望这会有所帮助。

# php - 有没有办法通过 PHP 更改 wait_timeout 和 max_allowed_pa cket？

> ID：14146131
> 
> 赞同：5
> 
> 时间：2013-01-03T19:51:48.730
> 
> 标签：php, mysql

> **可能重复：**
> [如何检查和设置 max_allowed_pa​​cket mysql 变量](https://stackoverflow.com/questions/5688403/how-to-check-and-set-max-allowed-packet-mysql-variable)

我有一些数据库问题，我想增加我的`max_allowed_packet`计时器并减少`wait_timeout`。有没有办法通过 PHP`ini_set ( 'memory_limit', '32M' );`或类似的东西来设置它？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-03T19:57:33.757

是的，您可以发出 SQL

```
SET GLOBAL max_allowed_packet=... 
```

要更改 的值`max_allowed_packet`，但由于它是一个[全局变量](http://dev.mysql.com/doc/refman/5.6/en/server-system-variables.html#sysvar_max_allowed_packet)，请注意您必须重新连接才能使更改生效，因为更改全局系统变量不会影响当前打开的连接。

`wait_timeout`是一个普通的[会话变量](http://dev.mysql.com/doc/refman/5.6/en/server-system-variables.html#sysvar_wait_timeout)，您可以使用它轻松更改当前连接

```
SET SESSION wait_timeout=... 
```

# database - 带有 Ruby 连接字符串的 ODBC

> ID：14146134
> 
> 赞同：0
> 
> 时间：2013-01-03T17:34:40.837
> 
> 标签：database, ruby

我正在尝试从 Ruby 访问 Access 数据库。

```
dbh = DBI.connect('DBI:ODBC:test','','') 
```

有效，但是

```
 dbh = DBI.connect("DBI:ODBC:driver=Microsoft Access Driver (*.mdb);dbq=H:/test.accdb") 
```

没有。

我不想在每台机器上设置访问驱动程序。

为什么第二行不起作用？

ODBC 驱动程序说我的程序无法识别数据库之类的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T12:59:55.110

还有另一个名称中带有 *.mdb**和***.accdb 的 Access-ODBC 驱动程序。你必须选择这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T17:45:59.577

我从未使用过新`accdb`格式，但我通过[Jet 引擎](http://en.wikipedia.org/wiki/Microsoft_Jet_Database_Engine)`mdb`和续集成功连接到-files ..

如果它适用于您的 accdb 文件，您可以测试我的代码示例：

```
require 'sequel'

Dir['*.mdb'].each{|mdb|
      print "Check #{mdb}"
      @db = Sequel.ado(:conn_string=>"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=#{mdb}")
      begin
        @db.test_connection 
        puts " ok"
      rescue Sequel::DatabaseConnectionError
        puts " error"
      end
} 
```

如果您更喜欢 winole-variant，您可以查看[如何查询 MS Access 数据库表，并使用 Ruby 和 win32ole 将信息导出到 Excel？](https://stackoverflow.com/questions/1573936/how-do-i-query-a-ms-access-database-table-and-export-the-information-to-excel-u)

[http://rubyonwindows.blogspot.de/2007/06/using-ruby-ado-to-work-with-ms-access.html](http://rubyonwindows.blogspot.de/2007/06/using-ruby-ado-to-work-with-ms-access.html)

# jquery - 使用 Jquery 添加表格页眉和页脚

> ID：14146139
> 
> 赞同：0
> 
> 时间：2013-01-03T19:52:08.787
> 
> 标签：jquery, html-table, footer

我有一个组合框

1.  生成数据
2.  作为表格绑定到组合框

我想为多列组合框添加页眉和页脚，并尝试冻结页眉和页脚。请建议

```
 $.each(ctrl.dropDown.$items, function (idx, item) {
            var header = '<thead><tr><td>Account Name</td><td>Account Number</td><td>Agreement Number</td></tr></thead>';

            var footer = '<tr><td colspan=3>'+idx+' items</td></tr>';
            $(item).empty();
            if (idx == 0) {
                $(item).prepend(header);
            }
            var tr = $('<tr/>');
            $.each(e.displayFields, function (dfdx, displayField) {
                var $td = $('<td/>').text(e.data[idx][displayField.fieldName]);
                //alert(e.data[idx][displayField.fieldName]);
                if (displayField.style != undefined) {
                    $td.attr('style', displayField.style);
                }
                $td.css('white-space', 'nowrap');
                tr.append($td);
            });
            var table = $('<table/>')   
                .attr({
                    'id':'tblComboList',
                    'cellpadding': '0px',
                    'cellspacing': '0px',
                    'width':'319px'
                });

            table.append(tr);
            if(idx ==0){
                table.prepend(header); //adding header but it is not freezed above table
            }
            $(item).append(table);
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T10:43:03.150

```
$('body').empty();

var tempDataMain = [];
tempDataMain.push($('<div />').append($('<table />').attr({ 'id': 'tblComboList', 'cellpadding': '0px', 'cellspacing': '0px', 'width': '319px' })).html());
tempDataMain.push('<thead><tr><td>Account Name</td><td>Account Number</td><td>Agreement Number</td></tr></thead>');
tempDataMain.push('<tbody>');

$.each(ctrl.dropDown.$items, function (i, item) {
    //tempDataMain.push('<tr><td colspan="3">' + i + ' items</td></tr>');

    var $tr = $('<tr/>');
    $.each(e.displayFields, function (j, displayField) {
        var $td = $('<td/>').text(e.data[i][displayField.fieldName]);

        if (displayField.style != undefined && displayField.style != null) {
            $td.attr('style', displayField.style);
        }
        $tr.append($td.css('white-space', 'nowrap'));
    });

    tempDataMain.push($('<div />').append($tr).html());
});

tempDataMain.push('</tbody>');
tempDataMain.push('</table>');

$('body').append(tempDataMain.join('')); 
```

# google-chrome - Chrome 扩展和 JS 注入问题 - 资源必须列在 web_accessible_resources 清单中

> ID：14146140
> 
> 赞同：1
> 
> 时间：2013-01-03T19:52:11.290
> 
> 标签：google-chrome, google-chrome-extension

当我检查页面时，脚本按预期注入。但在控制台中，我得到**Denying load of chrome-extension://lkklhmfekbnfjhmcapngedajgkfbmapm/lib/codemirror.js。资源必须列在 web_accessible_resources 清单键中，才能被扩展之外的页面加载。**

**清单.json**

```
{
"name":"test",
"description":"Test description",
"version":"1.0",

"manifest_version": 2   ,
  "browser_action": {
    "default_icon": "icon.png"
  },
"content_scripts": [
    {
        "matches": ["file:///*test*"],  
        "js": ["test.js"]
    }
  ],
"web_accessible_resources": ["lib/codemirror.js"]
} 
```

**测试.js**

```
var srcArray = ["lib/codemirror.js"];                   

function AddScript(value)
{
    var s = document.createElement("SCRIPT")
    s.src = chrome.extension.getURL(value);
    s.onload = function() {
        this.parentNode.removeChild(this);
    };
    (document.head||document.documentElement).appendChild(s);       
}
srcArray.forEach(AddScript); 
```

![在此处输入图像描述](../Images/c1ab5b57ea99f1108160b955e8b68ea4.png)

我无法弄清楚可能导致问题的原因。任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-21T01:17:30.827

我不确定，但如果你想在某个页面中插入一些脚本，你可以使用[chrome.tabs.executeScript](http://developer.chrome.com/extensions/tabs.html#method-executeScript) API。这是个好方法，而且你不关心 web_accessible_resources

# twitter-bootstrap - 留言板插件或代码

> ID：14146141
> 
> 赞同：0
> 
> 时间：2013-01-03T19:52:13.247
> 
> 标签：twitter-bootstrap

我已经有引导评论表了。我想要的只是一种在同一页面中显示人们评论的方法。但我想要一些非常漂亮的方式来显示评论。有没有我可以使用的插件？或者引导程序是否支持这样的事情？

感谢您的反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:55:54.217

Bootstrap 旨在成为一个 css 框架，只带来一些简单的 javascript。例如，您正在寻找基于 php 的脚本。也许你应该看看这个： http: [//www.inverudio.com/guestbook/](http://www.inverudio.com/guestbook/) 然后根据需要更改布局。

# android - 将 ImageView 转换为 Drawable

> ID：14146146
> 
> 赞同：0
> 
> 时间：2013-01-03T19:52:22.937
> 
> 标签：android

我在 ImageView 中有一个名为 TakePicture 的类中的位图。图像经过

```
public Bitmap getImage(){
        return image.getDrawingCache();
    } 
```

我想在其他类的 Drawable 中使用它

```
TakePicture picture=new TakePicture();
Drawable drawable = BitmapFactory.decodeResource(getResources(),  picture.getImage()); 
```

它给了我这个错误并且活动停止了

```
java.lang.RuntimeException: Unable to start activity 
ComponentInfo{me.myProject/me.myProject.GMap}: java.lang.NullPointerException
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
at android.app.ActivityThread.access$600(ActivityThread.java:130)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4745)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
at dalvik.system.NativeStart.main(Native Method)

Caused by: java.lang.NullPointerException
at me.myProject.TakePicture.getImage(TakePicture.java:58)
at me.myProject.GMap.onCreate(GMap.java:42)
at android.app.Activity.performCreate(Activity.java:5008)
at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023) 
```

# sql - 身份增量在 SQL Server 数据库中跳跃

> ID：14146148
> 
> 赞同：137
> 
> 时间：2013-01-03T19:52:31.970
> 
> 标签：sql, sql-server, sql-server-2012, identity-column

在 SQL Server 2012 数据库标识增量“ReceiptNo”列中的一个表`Fee`中，突然开始跳到 100 秒而不是 1 秒，具体取决于以下两件事。

1.  如果是 1205446 则跳转到 1206306，如果是 1206321，则跳转到 1207306，如果是 1207314，则跳转到 1208306。如下图所示。

2.  当我重新启动计算机时会出现此问题

![在此处输入图像描述](../Images/5dc76008131af0b23095fd5b36169fc5.png)

* * *

## 回答 #1

> 赞同：171
> 
> 时间：2013-01-03T19:57:08.587

由于自 SQL Server 2012 以来的性能改进，您遇到了此行为。

现在默认情况下，在`IDENTITY`为列分配值并重新启动服务时使用 1,000 的缓存大小可能会“丢失”未使用的值（ /`int`的缓存大小为 10,000 ）。`bigint``numeric`

[这在文档](https://docs.microsoft.com/en-us/sql/t-sql/statements/create-table-transact-sql-identity-property?view=sql-server-ver15#remarks)中提到

> SQL Server 可能出于性能原因缓存标识值，并且某些分配的值可能会在数据库故障或服务器重新启动期间丢失。这可能会导致插入时标识值出现间隙。如果间隙不可接受，则应用程序应使用自己的机制来生成键值。使用带有`NOCACHE`选项的序列生成器可以将间隙限制为从未提交的事务。

从您显示的数据来看，这似乎发生在 12 月 22 日的数据输入之后，然后在重新启动 SQL Server 时保留了这些值`1206306 - 1207305`。12 月 24 日至 25 日的数据输入完成后，再次重新启动，SQL Server 保留`1207306 - 1208305`了 28 日条目中可见的下一个范围。

除非您以不寻常的频率重新启动服务，否则任何“丢失”的值都不太可能在数据类型允许的值范围内造成任何重大影响，因此最好的策略是不要担心它。

如果由于某种原因这对您来说是一个真正的问题，一些可能的解决方法是......

1.  例如，您可以使用 a[`SEQUENCE`](https://msdn.microsoft.com/en-us/library/ff878091.aspx)而不是标识列并定义较小的缓存大小并`NEXT VALUE FOR`在列默认值中使用。
2.  或者应用跟踪标志 272，使`IDENTITY`分配记录为 2008 R2 之前的版本。这适用于全球所有数据库。
3.  或者，对于最新版本，执行`ALTER DATABASE SCOPED CONFIGURATION SET IDENTITY_CACHE = OFF`以禁用特定数据库的身份缓存。

**您应该知道，这些变通办法都不能保证没有间隙。这从来没有得到保证，`IDENTITY`因为它只能通过序列化插入到表中来实现。如果您需要无间隙色谱柱，您将需要使用不同的解决方案，`IDENTITY`或者`SEQUENCE`**

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2014-10-03T21:02:57.393

重新启动 SQL Server 后会出现此问题。

解决方案是：

*   运行**SQL Server 配置管理器**。

*   选择**SQL Server 服务**。

    ![SQL Server 配置管理器](../Images/4d401e14222041481a72c996bbd367f1.png)

*   右键单击*SQL Server*并选择**Properties**。

*   在**Startup Parameters**下的打开窗口中，键入`-T272`并单击**Add**，然后按**Apply**按钮并重新启动。

    ![SQL Server 启动参数](../Images/1c69a3d6927b72aa8fe57521720da5e4.png)

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2017-04-19T19:39:32.853

**`SQL Server 2017+`**您可以使用[ALTER DATABASE SCOPED](https://docs.microsoft.com/en-us/sql/t-sql/statements/alter-database-scoped-configuration-transact-sql) CONFIGURATION ：

> **IDENTITY_CACHE = { 开 | 离开 }**
> 
> 在数据库级别启用或禁用身份缓存。默认值为开。身份缓存用于提高具有身份列的表的 INSERT 性能。**为避免在服务器意外重新启动或故障转移到辅助服务器时出现标识列的值，请禁用 IDENTITY_CACHE 选项。** 此选项类似于现有的 SQL Server Trace Flag 272，不同之处在于它可以在数据库级别设置，而不仅仅是在服务器级别。
> 
> (...)
> 
> **G. 设置 IDENTITY_CACHE**
> 
> 此示例禁用身份缓存。
> 
> ```
> ALTER DATABASE SCOPED CONFIGURATION SET IDENTITY_CACHE=OFF ; 
> ```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2015-03-30T23:31:21.293

我知道我的回答可能迟到了。但我通过在 SQL Server 2012 中添加启动存储过程以另一种方式解决了问题。

在主数据库中创建以下存储过程。

```
USE [master]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[ResetTableNameIdentityAfterRestart]
AS
BEGIN

begin TRAN
    declare @id int = 0
    SELECT @id =  MAX(id) FROM [DatabaseName].dbo.[TableName]
    --print @id
    DBCC CHECKIDENT ('[DatabaseName].dbo.[TableName]', reseed, @id)
Commit

END 
```

然后使用以下语法将其添加到启动中。

```
EXEC sp_procoption 'ResetOrderIdentityAfterRestart', 'startup', 'on'; 
```

如果您的桌子很少，这是一个好主意。但是如果你必须为许多表做，这种方法仍然有效，但不是一个好主意。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2017-03-07T14:06:11.377

无论大小，这仍然是许多开发人员和应用程序中非常普遍的问题。

不幸的是，上述建议并不能解决所有情况，即共享主机，您不能依赖主机设置 -t272 启动参数。

此外，如果您有将这些标识列用作主键的现有表，那么删除这些列并重新创建新列以使用 BS 序列解决方法是一项巨大的工作。仅当您在 SQL 2012+ 中从头开始设计新表时，Sequence 解决方法才有效

底线是，如果您使用的是 Sql Server 2008R2，请继续使用它。说真的，坚持下去。直到微软承认他们引入了一个巨大的错误，即使在 Sql Server 2016 中仍然存在，那么我们不应该升级，直到他们拥有它并修复它。

微软直接引入了一项重大更改，即他们破坏了一个不再按设计工作的工作 API，因为他们的系统在重新启动时忘记了他们当前的身份。缓存或不缓存，这是不可接受的，以 Bryan 为名的微软开发人员需要拥有它，而不是告诉世界它是“设计使然”和“功能”。当然，缓存是一项功能，但不知道下一个身份应该是什么，这不是一项功能。真是个可恶的BUG！！！

我将分享我使用的解决方法，因为我的数据库位于共享主机服务器上，而且我不会删除和重新创建我的主键列，这将是一个巨大的 PITA。

相反，这是我可耻的 hack（但不像微软引入的这个 POS 错误那么可耻）。

### 破解/修复：

在您的插入命令之前，只需在每次插入之前重新设定您的身份。仅当您对 Sql Server 实例没有管理员控制权时，才建议使用此修复程序，否则我建议在重新启动服务器时重新设置种子。

```
declare @newId int -- where int is the datatype of your PKey or Id column
select @newId = max(YourBuggedIdColumn) from YOUR_TABLE_NAME
DBCC CheckIdent('YOUR_TABLE_NAME', RESEED, @newId) 
```

就在你插入之前的那 3 行，你应该很高兴。它实际上不会对性能产生太大影响，即不会引起注意。

祝你好运。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-01-03T19:59:50.377

跳跃身份值有很多可能的原因。它们的范围从回滚插入到复制的身份管理。如果不花一些时间在您的系统中，我无法判断是什么导致了这种情况。

但是，您应该知道，在任何情况下，您都不能假定标识列是连续的。有太多的事情会导致差距。

您可以在此处找到有关此的更多信息：http: [//sqlity.net/en/792/the-gap-in-the-identity-value-sequence/](http://sqlity.net/en/792/the-gap-in-the-identity-value-sequence/)

# c - 在 C 语言中，一个 100 个浮点变量的数组和一个 100 个字符指针的数组占用了多少字节的内存？

> ID：14146152
> 
> 赞同：-4
> 
> 时间：2013-01-03T19:52:43.297
> 
> 标签：c

bool：1 字节
char：1 字节
short：2 字节
int：4 字节
long：8 字节
float：4 字节
double：8 字节
long double：16 字节
unsigned int：8 字节
unsigned char：1 字节
long int：8 字节
short int ：2字节
有符号字符： 1字节

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T19:54:22.487

为什么不自己尝试一下

```
float a[100];
char* b[100];
printf("size of 100 floats = %zu\n", sizeof(a));
printf("size of 100 char pointers = %zu\n", sizeof(b)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:54:33.630

你只需要使用`sizeof()`运算符。

参见[维基百科](http://en.wikipedia.org/wiki/Sizeof)。

# wcf - 如何在 Win 表单应用程序 WCF 中托管 SVC 文件

> ID：14146161
> 
> 赞同：0
> 
> 时间：2013-01-03T19:53:30.613
> 
> 标签：wcf

我是 WCF 的新手。我知道如何以 Windows 形式托管 wcf 服务。现在我开发了一个具有 .svc 文件的小型 wcf 服务。我想以 win 形式托管这个 svc 文件。所以只想知道过程是相同的还是不同的？

这是我的 svc 文件标记

```
<%@ ServiceHost Language="C#" Debug="true" 
Service="Services.ChatService" CodeBehind="ChatService.svc.cs" %> 
```

这是 svc 文件中的小代码 文件后面的代码

```
namespace Services
{
    /// <summary>
    /// Implements the chat service interface.
    /// </summary>
    [ServiceBehavior(InstanceContextMode = InstanceContextMode.Single, 
        ConcurrencyMode = ConcurrencyMode.Multiple)]
    public class ChatService : IChatService
    {
        private readonly Dictionary<Guid, IChatServiceCallback> clients = 
            new Dictionary<Guid, IChatServiceCallback>();

        #region IChatService

        Guid IChatService.Subscribe()
        {
            IChatServiceCallback callback =
                OperationContext.Current.GetCallbackChannel<IChatServiceCallback>();

            Guid clientId = Guid.NewGuid();

            if (callback != null)
            {
                lock (clients)
                {
                    clients.Add(clientId, callback);
                }
            }

            return clientId;
        }

        void IChatService.Unsubscribe(Guid clientId)
        {
            lock (clients)
            {
                if (clients.ContainsKey(clientId))
                {
                    clients.Remove(clientId);
                }
            }
        }

        void IChatService.KeepConnection()
        {
            // Do nothing.
        }

        void IChatService.SendMessage(Guid clientId, string message)
        {
            BroadcastMessage(clientId, message);
        }

        #endregion

        /// <summary>
        /// Notifies the clients of messages.
        /// </summary>
        /// <param name="clientId">Identifies the client that sent the message.</param>
        /// <param name="message">The message to be sent to all connected clients.</param>
        private void BroadcastMessage(Guid clientId, string message)
        {
            // Call each client's callback method
            ThreadPool.QueueUserWorkItem
            (
                delegate
                {
                    lock (clients)
                    {
                        List<Guid> disconnectedClientGuids = new List<Guid>();

                        foreach (KeyValuePair<Guid, IChatServiceCallback> client in clients)
                        {
                            try
                            {
                                client.Value.HandleMessage(message);
                            }
                            catch (Exception)
                            {
                                // TODO: Better to catch specific exception types.                     

                                // If a timeout exception occurred, it means that the server
                                // can't connect to the client. It might be because of a network
                                // error, or the client was closed  prematurely due to an exception or
                                // and was unable to unregister from the server. In any case, we 
                                // must remove the client from the list of clients.

                                // Another type of exception that might occur is that the communication
                                // object is aborted, or is closed.

                                // Mark the key for deletion. We will delete the client after the 
                                // for-loop because using foreach construct makes the clients collection
                                // non-modifiable while in the loop.
                                disconnectedClientGuids.Add(client.Key);
                            }
                        }

                        foreach (Guid clientGuid in disconnectedClientGuids)
                        {
                            clients.Remove(clientGuid);
                        }
                    }
                }
            );
        }
    }
} 
```

这是绑定信息

```
<service behaviorConfiguration="Services.ChatServiceBehavior" name="Services.ChatService">
                <endpoint address="" binding="wsDualHttpBinding" bindingConfiguration="WSDualHttpBinding_IChatService" contract="Services.IChatService">
                    <identity>
                        <dns value="localhost"/>
                    </identity>
                </endpoint>
                <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
            </service> 
```

**这里有两个端点，一个用于 wsDualHttpBinding，另一个用于 mex** ，所以现在我的 mex 端点是

```
http://localhost:49722/ChatService.svc?wsdl 
```

现在我想添加另一个 tcp 端点并用两个端点公开这个服务。所以只要告诉我我需要为 tcp 端点写什么，当我添加 tcp 端点时，tcp 的 mex 端点会是什么，因为我希望该用户可以使用两个 url 中的任何一个创建代理，一个是 http url，另一个是 tcp url。所以我需要在这里为 tcp 添加 mex 吗？

请指导我。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:03:46.733

您必须手动启动主机

按照 msdn 链接[http://msdn.microsoft.com/en-us/library/system.servicemodel.servicehost.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicehost.aspx)

* * *

已编辑

```
ServiceHost _serviceHost;
public void Start(Type type)
{
    _serviceHost = new ServiceHost(type);
    _serviceHost.Open();
} 
```

# sql - 使用日历表查找两个事件在一段时间内发生的并发天数

> ID：14146164
> 
> 赞同：2
> 
> 时间：2013-01-03T19:53:31.893
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一个结构表

（处方）

```
clmID         int
patid         int
drugclass     char(3)
drugName      char(25)
fillDate      date
scriptEndDate date
strength      int 
```

和一个查询

```
;with PatientDrugList(patid, filldate,scriptEndDate,drugClass,strength)      
as      
(      
select rx.patid,rx.fillDate,rx.scriptEndDate,rx.drugClass,rx.strength      
 from rx      
)      
,      
DrugList(drugName)      
as      
(      
select x.drugClass      
from (values('h3a'),('h6h'))      
as x(drugClass)      
where x.drugClass is not null      
)      
SELECT PD.patid, C.calendarDate AS overlap_date      
 FROM PatientDrugList AS PD, Calendar AS C      
 WHERE drugClass IN ('h3a','h6h')      
  AND calendardate BETWEEN filldate AND scriptenddate      
 GROUP BY PD.patid, C.CalendarDate      
HAVING COUNT(DISTINCT drugClass) = 2     
order by pd.patid,c.calendarDate 
```

这`Calendar`是一个简单的日历表，其中包含整个研究期间所有可能的日期，没有其他列。

我的查询返回的数据看起来像

![在此处输入图像描述](../Images/33cccb1e3fb9ac01b2a79ff0f30f6ed0.png)

重叠日期表示每天在 PatientDrugList CTE 之后列出的两个类别中为一个人开具药物。

我想知道每个人连续服用两种药物的天数。我不能使用简单`max`和`min`汇总，因为这不会告诉我是否有人停止了这个方案然后重新开始。什么是找出这一点的有效方法？

编辑：DrugList CTE 中的行构造函数应该是存储过程的参数，并且为了本示例的目的进行了修改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:25:09.067

您正在寻找连续的日期序列。关键的观察是，如果你从日期中减去一个序列，你会得到一个恒定的日期。这定义了一组按顺序排列的日期，然后可以对其进行分组。

```
select patid
  ,MIN(overlap_date) as start_overlap
  ,MAX(overlap_date) as end_overlap
  from(select cte.*,(dateadd(day,row_number() over(partition by patid order by overlap_Date),overlap_date)) as groupDate
        from cte
      )t
  group by patid, groupDate 
```

此代码未经测试，因此可能有一些拼写错误。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-03T20:28:18.060

您需要以某件事为中心，并以最大和最小的方式解决该问题。你能说明是否有人在日期枢纽上同时服用两种药物吗？如果我正确理解您的问题，那么您将受到日期限制。

EG 示例 SQL：

```
 declare @Temp table ( person varchar(8), dt date, drug varchar(8));

insert into @Temp values ('Brett','1-1-2013', 'h3a'),('Brett', '1-1-2013', 'h6h'),('Brett','1-2-2013', 'h3a'),('Brett', '1-2-2013', 'h6h'),('Joe', '1-1-2013', 'H3a'),('Joe', '1-2-2013', 'h6h');

with a as 
    (
    select
        person
    ,   dt
    ,   max(case when drug = 'h3a' then 1 else 0 end) as h3a
    ,   max(case when drug = 'h6h' then 1 else 0 end) as h6h
    from @Temp
    group by person, dt
    )
, b as 
    (
    select *, case when h3a = 1 and h6h = 1 then 1 end as Logic
    from a
    )
select person, count(Logic) as DaysOnBothPresriptions
from b
group by person 
```

# algorithm - 在无向图上找到所有形成简单循环的路径

> ID：14146165
> 
> 赞同：6
> 
> 时间：2013-01-03T19:53:33.157
> 
> 标签：algorithm, graph, cycle, graph-algorithm

我在编写一个返回在无向图上形成简单循环的所有路径的算法时遇到了一些麻烦。

我首先考虑的是从顶点 A 开始的所有循环，对于下图

A,B,E,G,F
A,B,E,D,F
A,B,C,D,F
A,B,C,D,E,G,F

额外的周期将是

B,C,D,E
F,D,E,G

但是这些可以找到，例如，通过再次调用相同的算法，但分别从 B 和 D 开始。

图表如下所示——

![在此处输入图像描述](../Images/9f1595d62a07e74645ff052344612053.png)

我目前的方法是通过访问 A 的所有邻居，然后访问邻居的邻居等等来构建从 A 开始的所有可能路径，同时遵循以下规则：

*   每次存在多个邻居时，都会找到一个分叉，并创建和探索一条来自 A 的新路径。

*   如果任何创建的路径访问原始顶点，则该路径是一个循环。

*   如果任何创建的路径两次访问同一顶点（与 A 不同），则该路径将被丢弃。

*   继续，直到探索了所有可能的路径。

我目前在试图避免多次发现同一个循环时遇到问题，我试图通过查看新邻居是否已经是另一条现有路径的一部分来解决这个问题，以便两条路径组合（如果独立）建立一个循环。

**我的问题是：**我是否遵循正确/更好/更简单的逻辑来解决这个问题。？

我会很感激你的意见

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T15:44:11.203

根据@eminsenay 对[其他问题](https://stackoverflow.com/a/2794683/1943661)的回答，我使用了由 Frank Meyer 开发的[elementaryCycles](http://normalisiert.de/code/java/elementaryCycles.zip)库，来自 web_at_normalisiert_dot_de，它实现了[Johnson](http://dutta.csc.ncsu.edu/csc791_spring07/wrap/circuits_johnson.pdf)的算法。

但是，由于这个库是用于有向图的，所以我添加了一些例程：

*   从 JGraphT 无向图构建邻接矩阵（Meyer 的库需要）
*   过滤结果以避免长度为 2 的循环
*   删除重复的循环，因为 Meyer 的库是用于有向图的，并且每个无向循环是两个有向循环（每个方向一个）。

代码是

```
package test;

import java.util.*;

import org.jgraph.graph.DefaultEdge;
import org.jgrapht.UndirectedGraph;
import org.jgrapht.graph.SimpleGraph;

public class GraphHandling<V> {

private UndirectedGraph<V,DefaultEdge>     graph;
private List<V>                         vertexList;
private boolean                         adjMatrix[][];

public GraphHandling() {
    this.graph             = new SimpleGraph<V, DefaultEdge>(DefaultEdge.class);
    this.vertexList     = new ArrayList<V>();
}

public void addVertex(V vertex) {
    this.graph.addVertex(vertex);
    this.vertexList.add(vertex);
}

public void addEdge(V vertex1, V vertex2) {
    this.graph.addEdge(vertex1, vertex2);
}

public UndirectedGraph<V, DefaultEdge> getGraph() {
    return graph;
}

public List<List<V>>     getAllCycles() {
    this.buildAdjancyMatrix();

    @SuppressWarnings("unchecked")
    V[] vertexArray                 = (V[]) this.vertexList.toArray();
    ElementaryCyclesSearch     ecs     = new ElementaryCyclesSearch(this.adjMatrix, vertexArray);

    @SuppressWarnings("unchecked")
    List<List<V>>             cycles0    = ecs.getElementaryCycles();

    // remove cycles of size 2
    Iterator<List<V>>         listIt    = cycles0.iterator();
    while(listIt.hasNext()) {
        List<V> cycle = listIt.next();

        if(cycle.size() == 2) {
            listIt.remove();
        }
    }

    // remove repeated cycles (two cycles are repeated if they have the same vertex (no matter the order)
    List<List<V>> cycles1             = removeRepeatedLists(cycles0);

    for(List<V> cycle : cycles1) {
        System.out.println(cycle);    
    }

    return cycles1;
}

private void buildAdjancyMatrix() {
    Set<DefaultEdge>     edges        = this.graph.edgeSet();
    Integer             nVertex     = this.vertexList.size();
    this.adjMatrix                     = new boolean[nVertex][nVertex];

    for(DefaultEdge edge : edges) {
        V v1     = this.graph.getEdgeSource(edge);
        V v2     = this.graph.getEdgeTarget(edge);

        int     i = this.vertexList.indexOf(v1);
        int     j = this.vertexList.indexOf(v2);

        this.adjMatrix[i][j]     = true;
        this.adjMatrix[j][i]     = true;
    }
}
/* Here repeated lists are those with the same elements, no matter the order, 
 * and it is assumed that there are no repeated elements on any of the lists*/
private List<List<V>> removeRepeatedLists(List<List<V>> listOfLists) {
    List<List<V>> inputListOfLists         = new ArrayList<List<V>>(listOfLists);
    List<List<V>> outputListOfLists     = new ArrayList<List<V>>();

    while(!inputListOfLists.isEmpty()) {
        // get the first element
        List<V> thisList     = inputListOfLists.get(0);
        // remove it
        inputListOfLists.remove(0);
        outputListOfLists.add(thisList);
        // look for duplicates
        Integer             nEl     = thisList.size();
        Iterator<List<V>>     listIt    = inputListOfLists.iterator();
        while(listIt.hasNext()) {
            List<V>     remainingList     = listIt.next();

            if(remainingList.size() == nEl) {
                if(remainingList.containsAll(thisList)) {
                    listIt.remove();    
                }
            }
        }

    }

    return outputListOfLists;
}

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-04T15:02:40.517

我是根据您想找到*无弦*循环来回答这个问题的，但是可以对其进行修改以找到带有和弦的循环。

这个问题简化为找到两个顶点 s 和 t 之间的所有（包含）最小路径。

*   对于所有三元组，(v,s,t)：
    *   v,s,t 中的任何一个组成一个三角形，在这种情况下，输出它并继续下一个三元组。
    *   否则，删除除 s 和 t 之外的 v 及其邻居，并枚举所有 st-path。

查找所有 st-path 可以通过动态规划来完成。

# asp.net - 下载包含所有内容的html页面

> ID：14146171
> 
> 赞同：1
> 
> 时间：2013-01-03T19:53:48.007
> 
> 标签：asp.net, html, download

我可以下载一些包含所有内容（图像、脚本 .. 等）的 html 页面作为文件列表或单个 Web 存档吗？这只给我标记：

```
 using (WebClient client = new WebClient())
        {
            client.DownloadFile("http://www.youtube.com", @"D:\anyfile.html");
          //or
            string htmlCode = client.DownloadString("http://www.yotube.com");
          // save htmlcode ...
        } 
```

可能有任何API吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:54:57.563

是的，它只会为您提供标记，因为这就是您提供的 URL 返回的所有内容。

为了访问所有其他引用的资源，您需要对标记进行一些解析并获取这些资源的 URL。

# android - 如何使我的图像动画更流畅？

> ID：14146172
> 
> 赞同：2
> 
> 时间：2013-01-03T19:53:48.450
> 
> 标签：android, animation, android-asynctask, panoramas

我制作了一个全景应用程序，可以自动滚动图像，从左到右到左等等。它工作得很好，除了它不像我想要的那样平滑（意味着恒定速度）滚动。它有时会“跳跃”一点。它不应该在核心为 1.4 GHz 的设备中......

我只是通过翻译图像来实现这一点，然后稍等一下`Thread.sleep(panoanimspeed);`（其中 1/1000s <= panoanimspeed <= 1/50s），依此类推。可能不是最聪明的做法......？

你知道我怎样才能使它更顺畅吗？下面是相关AsyncTask的代码。

谢谢！

```
class AnimatePanorama extends AsyncTask<Void, Integer, Void> {
    private float scale = foto.getCropScale() * foto.getBaseScale();
    private Matrix m = foto.matrix;
    @Override
    protected void onProgressUpdate(Integer... values) {
        if (values[0] == 0) {
            m.setScale(scale, scale);
            m.postTranslate(values[1], 0);
            foto.setImageMatrix(m);
        }
    }
    @Override
    protected Void doInBackground(Void... arg) {
        dir = -dir;
        int l, ini = 0;
        float lim = foto.getImageWidth()*scale - foto.getViewWidth();
        float[] mm = new float[9];
        foto.matrix.getValues(mm);
        if (foto.getScale() == foto.getCropScale()) 
               ini =  (int) (dir*(lim*(dir+1)/2 + mm[2]));

        while (true) {
            if(isCancelled()) break;
            l = (int) (lim*(dir+1)/2);
            for (int i = ini; i < lim; i++) {
                if(isCancelled()) break;
                try {
                    Thread.sleep(panoanimspeed);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                publishProgress(0, dir * i - l);
            }
            ini = 0;
            dir = -dir;
        }
        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:03:41.713

[通过扩展 Animation 类（ http://developer.android.com/reference/android/view/animation/Animation.html](http://developer.android.com/reference/android/view/animation/Animation.html) ）创建动画并覆盖该`applyTransformation(float interpolatedTime, Transformation t)`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:03:59.290

将您的图像翻译基于“实时”的翻译，例如每秒 X 像素。

在第一个循环中，将系统时间保存为基本时间戳。

在未来的循环周期中，根据自基准时间戳以来的时间计算新位置。

这将避免 Thread.sleep “真实世界”时间的不可靠性。

# c - 在内存中创建位图并使用它

> ID：14146180
> 
> 赞同：0
> 
> 时间：2013-01-03T19:54:07.413
> 
> 标签：c, winapi, bitmap

我的目标是在内存中创建一个位图并将其句柄用作 BM_SETIMAGE 消息（设置按钮位图的消息）的参数。

以下是我的代码：

```
........

        HDC hdc = GetDC(hwnd);
        HDC memDC = CreateCompatibleDC(hdc);
        HBITMAP hMemBmp = CreateCompatibleBitmap(hdc, 100, 100);
        HBITMAP hOldBmp = (HBITMAP)SelectObject(memDC, hMemBmp);
        Rectangle(memDC, 0, 0, 100, 100);

        HBRUSH brush = CreateSolidBrush(RGB(0xff, 0xff, 0x00));

        RECT rc;
        rc.left   = 0; 
        rc.top    = 0;
        rc.right  = 100;
        rc.bottom = 100;
        FillRect(memDC, &rc, brush);

        SendMessage(GetDlgItem(hDlg, IDC_SET_START_PAGE_BG), BM_SETIMAGE, IMAGE_BITMAP, (LPARAM)hMemBmp);

........ 
```

但它不起作用，我的按钮上只是黑色。

问题：

1.  是否`FillRect(memDC, &rc, brush)`修改了 hMemBmp 的内容？如果不是，`SelectObject(memDC, hMemBmp)`这两个对象做了什么？

2.  我应该使用`CreateBitmap`而不是`CreateCompatibleBitmap`完成我的任务吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T21:39:30.333

在发送消息之前，您应该将旧位图选择回内存 DC。[根据 MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162957%28v=vs.85%29.aspx)，一次只能将位图选择到一个 DC 中。

# java - 如何在Java中创建一个只能设置一次但不是最终的变量

> ID：14146182
> 
> 赞同：48
> 
> 时间：2013-01-03T19:54:12.673
> 
> 标签：java, reference, final

我想要一个类，我可以用一个未设置的变量（the `id`）创建实例，然后稍后初始化这个变量，并**在初始化后让它不可变**。实际上，我想要一个`final`可以在构造函数之外初始化的变量。

目前，我正在使用一个抛出`Exception`如下的 setter 即兴创作：

```
public class Example {

    private long id = 0;

    // Constructors and other variables and methods deleted for clarity

    public long getId() {
        return id;
    }

    public void setId(long id) throws Exception {
        if ( this.id == 0 ) {
            this.id = id;
        } else {
            throw new Exception("Can't change id once set");
        }
    }
} 
```

这是我想做的事情的好方法吗？我觉得我应该能够在初始化后将某些东西设置为不可变，或者我可以使用一种模式来使它更优雅。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-01-03T23:14:49.230

让我建议你一个更优雅的决定。第一个变体（不抛出异常）：

```
public class Example {

    private Long id;

    // Constructors and other variables and methods deleted for clarity

    public long getId() {
        return id;
    }

    public void setId(long id) {
        this.id = this.id == null ? id : this.id;
    }

} 
```

第二种变体（抛出异常）：

```
 public void setId(long id)  {
         this.id = this.id == null ? id : throw_();
     }

     public int throw_() {
         throw new RuntimeException("id is already set");
     } 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-03T22:52:54.500

“只设置一次”的要求感觉有点武断。我相当确定您正在寻找的是一个从未初始化状态永久转换为已初始化状态的类。毕竟，多次设置对象的 id 可能很方便（通过代码重用或其他方式），只要在“构建”对象后不允许更改 id。

一种相当合理的模式是在单独的字段中跟踪这种“构建”状态：

```
public final class Example {

    private long id;
    private boolean isBuilt;

    public long getId() {
        return id;
    }

    public void setId(long id) {
        if (isBuilt) throw new IllegalArgumentException("already built");
        this.id = id;
    }

    public void build() {
        isBuilt = true;
    }
} 
```

用法：

```
Example e = new Example();

// do lots of stuff

e.setId(12345L);
e.build();

// at this point, e is immutable 
```

使用这种模式，您可以构造对象，设置它的值（方便的次数），然后调用`build()`“immutify”它。

与您的初始方法相比，此模式有几个优点：

1.  没有用于表示未初始化字段的魔法值。例如，与任何其他值`0`一样有效的 id 。`long`
2.  设置者具有一致的行为。在`build()`被调用之前，它们工作。调用后`build()`，无论您传递什么值，它们都会抛出。（为方便起见，请注意使用未经检查的异常）。
3.  该类被标记`final`，否则开发人员可以扩展您的类并覆盖设置器。

但是这种方法有一个相当大的缺点：使用此类的开发人员*在编译时*无法知道特定对象是否已初始化。当然，您可以添加一个`isBuilt()`方法，以便开发人员可以*在运行时*检查对象是否已初始化，但在编译时知道这些信息会方便得多。为此，您可以使用构建器模式：

```
public final class Example {

    private final long id;

    public Example(long id) {
        this.id = id;
    }

    public long getId() {
        return id;
    }

    public static class Builder {

        private long id;

        public long getId() {
            return id;
        }

        public void setId(long id) {
            this.id = id;
        }

        public Example build() {
            return new Example(id);
        }
    }
} 
```

用法：

```
Example.Builder builder = new Example.Builder();
builder.setId(12345L);
Example e = builder.build(); 
```

由于以下几个原因，这要好得多：

1.  我们正在使用`final`字段，因此编译器和开发人员都知道这些值不能更改。
2.  对象的初始化和未初始化形式之间的区别是通过 Java 的类型系统来描述的。一旦对象被构建，就没有设置器来调用它。
3.  已构建类的实例保证线程安全。

是的，维护起来有点复杂，但恕我直言，好处大于成本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-04-20T22:04:59.063

Google 的[Guava 库](https://github.com/google/guava)（我非常推荐）自带一个类，可以很好地解决这个问题：[`SettableFuture`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/util/concurrent/SettableFuture.html). 这提供了您询问的 set-once 语义，但还提供了更多：

1.  传达异常的能力（`setException`方法）；
2.  显式取消事件的能力；
3.  注册侦听器的能力，这些侦听器将在设置值时通知，通知异常或取消未来（[`ListenableFuture`接口](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/util/concurrent/ListenableFuture.html)）。
4.  `Future`通常用于多线程程序中线程之间同步的类型系列，因此可以`SettableFuture`很好地使用这些类型。

Java 8 也有自己的版本：[`CompletableFuture`](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html).

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-03T23:05:03.267

您可以简单地添加一个布尔标志，并在您的 setId() 中设置/检查布尔值。如果我正确理解了这个问题，我们在这里不需要任何复杂的结构/模式。这个怎么样：

```
public class Example {

private long id = 0;
private boolean touched = false;

// Constructors and other variables and methods deleted for clarity

public long getId() {
    return id;
}

public void setId(long id) throws Exception {
    if ( !touchted ) {
        this.id = id;
         touched = true;
    } else {
        throw new Exception("Can't change id once set");
    }
}

} 
```

这样，如果您`setId(0l);`认为ID也已设置。如果它不适合您的业务逻辑要求，您可以进行更改。

没有在 IDE 中编辑它，抱歉，错字/格式问题，如果有...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-04T11:42:16.120

这是我在混合上述一些答案和评论的基础上提出的解决方案，特别是来自@KatjaChristiansen 的关于使用断言的解决方案。

```
public class Example {

    private long id = 0L;
    private boolean idSet = false;

    public long getId() {
        return id;
    }

    public void setId(long id) {
        // setId should not be changed after being set for the first time.
        assert ( !idSet ) : "Can't change id from " + this.id + " to " + id;
        this.id = id;
        idSet = true;
    }

    public boolean isIdSet() {
        return idSet;
    }

} 
```

归根结底，我怀疑我对此的需求表明其他地方的设计决策不佳，我宁愿找到一种仅在知道 Id 并将 id 设置为 final 时创建对象的方法。这样，可以在编译时检测到更多错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-08-01T15:02:52.830

我有这个类，类似于[JDK 的`AtomicReference`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicReference.html)，我主要将它用于遗留代码：

```
import static com.google.common.base.Preconditions.checkNotNull;
import static com.google.common.base.Preconditions.checkState;

import javax.annotation.Nonnull;
import javax.annotation.concurrent.NotThreadSafe;

@NotThreadSafe
public class PermanentReference<T> {

    private T reference;

    public PermanentReference() {
    }

    public void set(final @Nonnull T reference) {
        checkState(this.reference == null, 
            "reference cannot be set more than once");
        this.reference = checkNotNull(reference);
    }

    public @Nonnull T get() {
        checkState(reference != null, "reference must be set before get");
        return reference;
    }
} 
```

我有[单一的责任](https://en.wikipedia.org/wiki/Single_responsibility_principle)并检查两者`get`并`set`调用，因此当客户端代码滥用它时它会提前失败。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-05-07T01:35:27.520

这里有两种方法；第一个与其他答案中提到的其他一些基本相同，但在这里与秒进行对比。所以第一种方法，Once 是通过在 setter 中强制设置一个只能设置一次的值。我的实现需要非空值，但如果您希望能够设置为空，那么您需要按照其他答案中的建议实现一个“isSet”布尔标志。

第二种方法，Lazy，是提供一个函数，在第一次调用 getter 时延迟提供值。

```
import javax.annotation.Nonnull;

public final class Once<T> 
{
    private T value;

    public set(final @Nonnull T value)
    {
        if(null != this.value) throw new IllegalStateException("Illegal attempt to set a Once value after it's value has already been set.");
        if(null == value) throw new IllegalArgumentException("Illegal attempt to pass null value to Once setter.");
        this.value = value;
    }

    public @Nonnull T get()
    {
        if(null == this.value) throw new IllegalStateException("Illegal attempt to access unitialized Once value.");
        return this.value;
    }
}

public final class Lazy<T>
{
    private Supplier<T> supplier;
    private T value;

    /**
     * Construct a value that will be lazily intialized the
     * first time the getter is called.
     *
     * @param the function that supplies the value or null if the value
     *        will always be null.  If it is not null, it will be called
     *        at most one time.  
     */
    public Lazy(final Supplier<T> supplier)
    {
        this.supplier = supplier;
    }

    /**
     * Get the value.  The first time this is called, if the 
     * supplier is not null, it will be called to supply the
     * value.  
     *
     * @returns the value (which may be null)
     */
    public T get()
    {
        if(null != this.supplier) 
        {
            this.value = this.supplier.get();
            this.supplier = null;   // clear the supplier so it is not called again
                                    // and can be garbage collected.
        }
        return this.value;
    }
} 
```

因此，您可以按如下方式使用它们；

```
//
// using Java 8 syntax, but this is not a hard requirement
//
final Once<Integer> i = Once<>();
i.set(100);
i.get();    // returns 100
// i.set(200) would throw an IllegalStateException

final Lazy<Integer> j = Lazy<>(() -> i);
j.get();    // returns 100 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-01T05:57:43.397

我最近在编写一些代码来构造一个边引用其节点的不可变循环图时遇到了这个问题。我还注意到，这个问题的现有答案都不是线程安全的（实际上允许多次设置该字段），所以我想我会贡献我的答案。基本上，我刚刚创建了一个名为的包装类[`FinalReference`](https://github.com/entpnerd/entpnerd-common/blob/master/src/main/java/com/entpnerd/common/FinalReference.java)，它包装`AtomicReference`并利用了`AtomicReference`'s`compareAndSet()`方法。通过调用`compareAndSet(null, newValue)`，可以确保多个并发修改线程最多设置一次新值。调用是原子的，只有在现有值为 null 时才会成功。请参阅下面的示例源代码`FinalReference`和 Github 链接以获取示例测试代码以证明正确性。

```
public final class FinalReference<T> {
  private final AtomicReference<T> reference = new AtomicReference<T>();

  public FinalReference() {
  }

  public void set(T value) {
    this.reference.compareAndSet(null, value);
  }

  public T get() {
    return this.reference.get();
  }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-02-05T13:28:09.633

尝试有一个像这样的 int 检查器

```
private long id = 0;
static int checker = 0;

public void methodThatWillSetValueOfId(stuff){
    checker = checker + 1

    if (checker==1){
        id = 123456;
    } 
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-05-08T15:07:13.010

//你可以试试这个：

```
class Star
{
    private int i;
    private int j;
    static  boolean  a=true;
    Star(){i=0;j=0;}
    public void setI(int i,int j) {
        this.i =i;
        this.j =j;
        something();
        a=false;
    }
    public void printVal()
    {
        System.out.println(i+" "+j);
    }
    public static void something(){
         if(!a)throw new ArithmeticException("can't assign value");
    }
}

public class aClass
{
    public static void main(String[] args) {
        System.out.println("");
        Star ob = new Star();
        ob.setI(5,6);
        ob.printVal();
        ob.setI(6,7);
        ob.printVal();
    }
}
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2013-01-03T19:56:07.107

将字段标记为私有而不公开 a`setter`就足够了：

```
public class Example{ 

private long id=0;  

   public Example(long id)  
   {  
       this.id=id;
   }    

public long getId()  
{  
     return this.id;
} 
```

如果这还不够，并且您希望某人能够对其进行 X 次修改，您可以这样做：

```
public class Example  
{  
    ...  
    private final int MAX_CHANGES = 1;  
    private int changes = 0;    

     public void setId(long id) throws Exception {
        validateExample(); 
        changes++; 
        if ( this.id == 0 ) {
            this.id = id;
        } else {
            throw new Exception("Can't change id once set");
        }
    }

    private validateExample  
    {  
        if(MAX_CHANGES==change)  
        {  
             throw new IllegalStateException("Can no longer update this id");   
        }  
    }  
} 
```

这种方法类似于契约式设计，在调用 mutator（改变对象状态的东西）之后验证对象的状态。

* * *

## 回答 #12

> 赞同：-6
> 
> 时间：2013-01-03T20:31:17.977

我认为单例模式可能是你应该研究的东西。谷歌一下，看看这个模式是否符合你的设计目标。

下面是一些关于如何使用枚举在 Java 中制作单例的 sudo 代码。我认为这是基于 Joshua Bloch 在 Effective Java 中概述的设计，不管怎样，如果你还没有这本书，这本书值得一读。

```
public enum JavaObject {
    INSTANCE;

    public void doSomething(){
        System.out.println("Hello World!");
    }
} 
```

用法：

```
JavaObject.INSTANCE.doSomething(); 
```

# c# - 在实体框架 5 中以编程方式重命名导航属性的部分类

> ID：14146184
> 
> 赞同：1
> 
> 时间：2013-01-03T19:54:18.207
> 
> 标签：c#, .net, entity-framework, entity-framework-5

我在 C# 中工作，使用 Entity Framework 5、.NET 4.5

据我了解，Entity 的最佳实践是在扩展或修改基本功能时使用部分类，这样在重建模型时就不会丢失更改。

我有一个带有两个 FK 的表到另一个表，如下所示：

```
ItemTable:
ID
Name

ParentChildTable:
ChildID (FK to ItemTable.ID)
ParentID (FK to ItemTable.ID) 
```

从数据库构建 EDMX 时，它会正确读取 FK 关系并创建适当的对象引用。不幸的是，导航属性命名不佳，例如。项目表和项目表 1。我想重命名导航属性，并且可以通过设计器这样做，但想知道是否有办法在部分类中做到这一点。

我的最终目标只是拥有名为 ChildItem 和 ParentItem 的导航属性，而不是自动生成的 ItemTable 和 ItemTable1。我完全了解如何创建部分类、装饰属性等。我只需要一个指向正确方向的指针，以了解如何处理此导航属性场景。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:08:24.700

我以前在递归关系中遇到过这个问题，但是为什么要在代码中更改它们呢？我认为您最好在设计器本身中执行此操作，它也可以更轻松地跟踪您所做的更改。

话虽如此，我认为您不能“重命名”代码中的属性。你可以做这样的事情

```
public partial class ItemTable
{
    public ItemTable ChildItem
    {
       get
       {
          return this.ItemTable;
       }
    }

    public ItemTable ParentItem
    {
       get
       {
          return this.ItemTable1;
       }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-26T18:16:51.220

您可以尝试@jere 的答案，但添加一个 [NotMapped] 数据注释，因此当 EF 与数据库一起使用时，EF 不会尝试映射这些新属性。

# c++ - 如何处理套接字中的网络端口滥用

> ID：14146187
> 
> 赞同：11
> 
> 时间：2013-01-03T19:54:25.633
> 
> 标签：c++, c, sockets, networking, tcp

我有一个使用标准网络套接字上的 TCP/IP 用 C++ 编写的 Web 应用程序，在 Linux 上运行。该服务对狂野和毛茸茸的互联网开放。

我会定期收到来自运行自动化脚本的垃圾邮件发送者的大量滥用请求。我可以检测到这些并关闭套接字。现在我只是礼貌地关闭套接字，就像我对任何已完成的有效请求所做的那样，使用这样的套接字库关闭：

```
close( mSocket ); 
```

但有时关闭套接字通常会通知垃圾邮件脚本套接字连接已终止，它们会立即发起另一个欺诈请求。

终止 TCP/IP 连接的最佳方法是什么，该连接清理了我系统上打开的套接字，但让远程方挂起。那就是我想以对我来说成本最低但对他们来说成本最高的方式关闭套接字。

@尼古拉斯·威尔逊：

使用 TCP_REPAIR 似乎是个好主意。在 TCP_REPAIR 模式下关闭套接字时，不会发送 FIN 或 RST 数据包。远程插座悬空。我会尝试并报告回来。这是我的（未经测试的）代码：

```
if ( abuse )
{
   int aux = 1;
   if ( setsockopt( mSocket, SOL_TCP, TCP_REPAIR, &aux, sizeof( aux )) < 0 )
      reportError( "Tried to do a rude socket close... but could not turn on repair mode.\n" );
}
close( mSocket ); 
```

如果这有效，我会报告。（@edit：下面的测试答案）

@“保持套接字打开”的想法：

这可行，但不是最佳的。攻击者有能力用打开的套接字使您的系统饱和。每个请求都会创建一个保持打开状态的新套接字。使用 DOS 攻击，您最终会耗尽套接字。

然后管理打开的套接字也存在问题：

1.  只是不要关闭它。开放式套接字永远存在。攻击者的成本：高 - 他们没有鳍。对我来说成本：更高。我所有的文件描述符最终都会被使用。
2.  为每个套接字生成一个线程以休眠 10 分钟，然后关闭套接字。攻击者的成本：高 - 他们没有鳍。对我来说成本：更高。虽然我最终确实关闭了套接字，但对于每个请求，我的套接字使用时间都比攻击者更长，并且我有一个线程的开销。
3.  产生一个线程来处理所有被滥用的套接字过期。攻击者的成本：高 - 他们没有鳍。对我来说成本：更高。像 2 一样，许多套接字保持打开状态。管理它的单个线程的开销。代码复杂，烦人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T21:10:04.293

好的，做了一些研究，我有一个基于 TCP_REPAIR 的适合我的答案。它比我最初想象的要复杂一些：

```
if ( abuse )
{
   // read some bytes from the spammer - to establish the connection
   u32 tries = 20;
   while ( tries )
   {
      sleep( 1000 );
      char tmpBuf[32];
      s32 readCount = recv( mSocket, &tmpBuf[0], 32, 0 );
      if ( readCount > -1 ) break;
      tries--;
   }
#ifdef TCP_REPAIR
   int aux = 1;
   if ( setsockopt( mSocket, SOL_TCP, TCP_REPAIR, &aux, sizeof( aux )) < 0 )
   {
     reportError( "could not turn on repair mode" );
   }
#else // !TCP_REPAIR
   // no TCP REPAIR - best we can do is an abort close
   struct linger so_linger;
   so_linger.l_onoff = 1;
   so_linger.l_linger = 0;
   if ( setsockopt( mSocket, SOL_SOCKET, SO_LINGER, &so_linger, sizeof so_linger ) < 0  )
   {
      reportError( "Cannot turn off SO_LINGER" );
   }
#endif // TCP_REPAIR
}
close( mSocket ); 
```

在内核级别，如果您关闭连接，TCP 堆栈将发送一个 FIN 或 RST 数据包，无论您如何操作（关闭或关闭）。无论哪种方式，都会通知攻击者您关闭了连接。

我们想默默地关闭连接，让他们等待意识到你没有回答......因为我们是报复性的。

TCP_REPAIR 是一种新的套接字 API，旨在允许您“冻结”套接字、保存其状态并在另一个进程甚至另一个系统上重新加载套接字状态。在正常使用情况下，客户端永远不会知道他们的连接被转移到其他地方。

但是我们可以滥用这个 API，我们将套接字置于修复模式，但不保存它的状态，也永远不恢复它。当我们在修复模式下关闭套接字时 - 它会被静默删除。

这适用于已经开始的滥用请求。那就是我们已经阅读了垃圾邮件发送者的请求并确定它是欺诈并且 TCP_REPAIR 将其杀死。

但是，如果您在连接后立即阻止 IP 请求，而无需先读取套接字，就会以某种方式通知远程方。他们得到 RST。或者可能连接中的某些内容从未完全完成，并且远程系统几乎立即中止了请求。

所以我们首先从黑客的套接字中读取几个字节。在我的情况下，套接字已经处于非阻塞模式。但如果不是，您想将套接字设置为非阻塞，否则您向黑客开放连接，但不发送数据包并让您的服务器挂起 - 就像您计划对他做的那样。如果几微秒后你没有收到一个数据包，你无论如何都要关闭他。

但是，如果您从他那里读取了几个字节，那么他的程序将等待您的响应，但永远不会出现。

TCP_REPAIR 仅适用于 Linux 内核 3.5 及更高版本。在此之下，我能做的最好的就是关闭“脏”套接字。在这里，您无需向他发送 FIN，而是向他发送 RST。在他看来，就像从未建立过有效的连接一样。为此，您关闭 SO_LINGER，实质上中断套接字连接关闭握手，然后调用 close。

像魅力一样工作，将您的浏览器指向这里：

[http://oroboro.com/fail](http://oroboro.com/fail)

Chrome 至少会挂在那里 5-10 秒。查看我每秒命中 10 次的日志——他每 10 秒左右只能击中我一次。从这里加载到我的系统上：0。

见傻子！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-04T14:32:33.703

当您检测到恶意客户端时，我建议您不仅要关闭连接，还要拒绝来自同一 IP 地址的任何新连接。

您至少可以将应用程序中的 IP 列入黑名单。保留一份禁止 IP 地址的列表，并立即关闭任何源自该列表中 IP 的已接受套接字。

但是为了保护更多的资源，最好在网络架构中进一步向外阻止连接。当您能够这样做时，通知网关路由器阻止它。如果这是不可能的，请尝试让负载均衡器阻止它。如果做不到这一点，至少在服务器的本地防火墙中添加一条规则。

但请记住，许多此类攻击源自消费级互联网连接（无论用户是否意识到）。这通常意味着他们的 IP 地址被分配并定期动态地重新分配。几天前被垃圾邮件发送者使用的 IP 现在可能被合法用户使用。所以基于IP的禁令不应该永远持续下去。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T14:34:50.860

用这个：

```
#include <sys/socket.h>

int shutdown(int socket, int how); 
```

它将`RST`立即发送并关闭（连接）。这会让人觉得该端口上没有服务，攻击者有望停止在该端口上发送垃圾邮件。呼叫`close()`释放手柄。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T18:10:54.210

当你检测到一个`abuse`

`abuse`每当您检测到您使用其中一个插槽将它们放入锅中时，都会为“垃圾邮件发送者”提供一个插槽池。如果没有可用的空闲套接字，则回收最旧的，然后关闭并关闭它。

如果连接符合条件，则`!abuse`让他们使用适当的套接字。

# java - 如何打印 Java 标记注释？

> ID：14146188
> 
> 赞同：0
> 
> 时间：2013-01-03T19:54:30.637
> 
> 标签：java, annotations

我刚刚开始阅读 Java 注释。我需要打印出 checkprime 方法上面写的所有三个注释，但它只打印第一个。这似乎是一个愚蠢的问题，但被卡住了，无法在任何地方找到答案。

```
import java.io.*;
import java.lang.annotation.Annotation;
import java.lang.annotation.Retention;   
import java.lang.annotation.RetentionPolicy;
import java.lang.reflect.Method;

@Retention(RetentionPolicy.RUNTIME)

@interface MyMarker
  {

  }

@interface MyMarker1
  { 
String author();
  }

@interface MyMarker2
  {
String author();
String module();
double version(); 
  }

public class Ch10Lu1Ex4
{
@MyMarker 
@MyMarker1(author = "Ravi") 
@MyMarker2(author = "Ravi", module = "checkPrime", version = 1.1)
public static void checkprime(int num)
     {
      int i;
      for (i=2; i < num ;i++ )
       {
          int n = num%i;
          if (n==0)
          {
           System.out.println("It is not a prime number");
           break;
          }
      }
          if(i == num)
          {

              System.out.println("It is a prime number");
          }
}

public static void main(String[] args) 
  {
    try
      {
       Ch10Lu1Ex4 obj = new Ch10Lu1Ex4();
       BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
       System.out.println("Enter a number:");
       int x = Integer.parseInt(br.readLine());
       obj.checkprime(x);
       Method method = obj.getClass().getMethod("checkprime", Integer.TYPE);
       Annotation[] annos = method.getAnnotations();
         for(int i=0;i<annos.length;i++)
          {
            System.out.println(annos[i]);
          }
       }
    catch(Exception e)
    {
        e.printStackTrace();
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:07:18.430

您需要添加`@Retention(RetentionPolicy.RUNTIME)`到其余注释中，如下所示：

```
@Retention(RetentionPolicy.RUNTIME)
@interface MyMarker
{
}

@Retention(RetentionPolicy.RUNTIME)
@interface MyMarker1
  { 
String author();
  }

@Retention(RetentionPolicy.RUNTIME)
@interface MyMarker2
  {
String author();
String module();
double version(); 
  } 
```

没有它，您的代码在运行时只知道第一个注释，其他注释将不可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:08:06.823

其中只有一个用 注释`@Retention(RetentionPolicy.RUNTIME)`。其他默认为 CLASS 策略，VM 不会在运行时保留该策略。

# java - 这种多线程迭代安全吗？

> ID：14146192
> 
> 赞同：2
> 
> 时间：2013-01-03T19:54:39.560
> 
> 标签：java, multithreading, iterator

我有一个集合，我想产生一些线程来对其元素做一些繁重的工作。集合的每个元素都必须被处理一次，并且只处理一次。我想尽可能减少同步，我想出了以下代码：

```
//getting the iterator is actually more complicated in my specific case
final Iterator it = myCollection.terator(); 
Thread[] threads = new Thread[numThreads];

for( int i = 0; i < numThreads; i++ ) {
    threads[i] = new Thread(new Runnable() {
        public void run() {
            Object obj = null;
            while(true) {
                synchronized (it) {
                    if(it.hasNext())
                        obj = it.next();
                    else
                        return;
                }
                //Do stuff with obj
            }
        }
    });
    threads[i].start();
}

for (Thread t : threads)
    try {
        t.join();
    } catch (InterruptedException e) {
        e.printStackTrace();
    } 
```

**注意：**没有线程会在“用 obj 做事”时通过添加或删除项目来修改集合

这段代码与我发现的示例完全不同，在这些示例中，人们倾向于在集合本身上同步，使用`Collection.synchronizedStuff..`，或者他们只是在整个迭代中同步。在我的研究中，我还发现了可能更好的替代方案，`ThreadPoolExecutor`但让我们暂时忘记它......

考虑到上面的注释1，上面的代码安全吗？如果不是，为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T19:58:09.660

我根本不会使用同步。

我会有一个将任务添加到 ExecutorService 的循环。

```
ExecutorService es = Executors.newFixedThreadPool(nThreads);

for(final MyType mt: myCollection)
    es.submit(new Runnable() {
       public void run() {
           doStuffWith(mt);
       }
    });
es.shutdown();
es.awaitTermination(1, TimeUnit.HOURS); 
```

如果您不再需要创建和关闭线程池，它会更短。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T01:00:36.497

我认为最好将 myCollection 设为 final 并将代码更改为

```
 public void run() {
       Object obj = null;
       for (Object e : myCollection) {
           obj = e;
       } 
```

for-each 在每个线程中创建一个新的迭代器，因此不需要同步。

# java - 在控制台上显示数据并将数据保存到文本文件。

> ID：14146193
> 
> 赞同：2
> 
> 时间：2013-01-03T19:54:38.330
> 
> 标签：java, io

所以这是我的代码，它似乎可以工作，但它只是打印出文件中的信息，而不是两者都做（在控制台上显示数据并将信息保存到文本文件中）。帮助表示赞赏。

```
 // imports
   import java.io.BufferedReader;
   import java.io.FileOutputStream;
   import java.io.FileReader;
   import java.io.IOException;
   import java.io.PrintStream;

   public class DTM {

       // The main method for our Digital Terrain Models
       /** @param args
        * @throws IOException
        */
       public static void main(String[] args) throws IOException {

           //Prints the console output on a text file (Output.txt)
           PrintStream out = new PrintStream(new FileOutputStream("output.txt"));
           System.setOut(out);

           //Declare some variables
           int aRows = 401;
           int bCols = 401;
           String DMTfile = "sk28.asc";
           //Declare some tables
           double data[][] = new double[aRows][bCols];

           BufferedReader file = new BufferedReader(new FileReader(DMTfile));
           //Write data into array
           for (int i = 0; i < aRows; i++) {
               String rowArray[] = file.readLine().split(" ");
               for (int j = 0; j < bCols; j++) {
                   data[i][j] = Double.parseDouble(rowArray[j]);
               }
           }

           //Closing the file
           file.close();

           //print out the array
           for (int i = 0; i < aRows; i++) {
               for (int j = 0; j < bCols; j++) {
                   System.out.println(data[i][j]);
               }
           }

           // this hold's the smallest number
           double high = Double.MIN_VALUE;
           // this hold's the biggest number
           double low = Double.MAX_VALUE;

           //initiate a "For" loop to act as a counter through an array
           for (int i = 0; i < data.length; i++) {
               for (int j = 0; j < data[i].length; j++)

               //determine the highest value
               if (data[i][j] > high) {
                   high = data[i][j];
               }
               //determine the lowest value
               else if (data[i][j] < low) {
                   low = data[i][j];

               }
           }

           // Code here to find the highest number
           System.out.println("Peak in this area = " + high);
           // Code here to find the lowest number
           System.out.println("Dip in this area = " + low);

       }
   } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:58:44.437

试试[Apache Commons TeeOutputStream](http://commons.apache.org/io/apidocs/org/apache/commons/io/output/TeeOutputStream.html)。

未经测试，但应该这样做：

```
outStream = System.out;   
// only the file output stream  
OutputStream os = new FileOutputStream("output.txt", true);   
// create a TeeOutputStream that duplicates data to outStream and os  
os = new TeeOutputStream(outStream, os); 
PrintStream printStream = new PrintStream(os);       
System.setOut(printStream); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:59:29.813

您只是将标准输出重定向到文件而不是控制台。据我所知，没有办法自动将输出克隆到两个流上，但手动操作很容易：

```
public static void multiPrint(String s, FileOutputStream out){
    System.out.print(s);
    out.write(s);
} 
```

每当你想打印你只需要调用这个函数：

```
FileOutputStream out=new FileOutputStream("out.txt");
multiPrint("hello world\n", out); 
```

# ios - UIActionSheet 未显示在弹出窗口中

> ID：14146197
> 
> 赞同：2
> 
> 时间：2013-01-03T19:55:11.147
> 
> 标签：ios, ipad, uiactionsheet

我有一个表格视图，当用户选择特定行时，我想显示一个简单的操作表来选择新条目是来自现有联系人还是创建新联系人。我这样显示操作表：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if ( indexPath.row != 0  )
    {
        //Select the entry
    }
    else
    {
        UITableViewCell *selectedRow = [tableView cellForRowAtIndexPath:indexPath];
        UIActionSheet *sheet = [[UIActionSheet alloc] initWithTitle:nil delegate:self cancelButtonTitle:nil destructiveButtonTitle:nil otherButtonTitles:@"New Contact", @"Existing Contact", nil];

        [sheet showFromRect:selectedRow.frame inView:tableView animated:YES];
        return;
    }

    //Do some other stuff... 
```

}

根据文档...

> 讨论
> 
> 在 iPad 上，此方法在弹出框中显示操作表，其箭头指向视图的指定矩形。弹出框不与指定的矩形重叠。

然而......操作表显示在我的视图底部，而不是侧面的弹出窗口。tableview 是 splitviewcontroller 中的主视图

关于为什么这不起作用的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-22T09:24:12.907

我遇到了同样的问题，这个答案对我有帮助：

[在 iPad 上使用 UIActionSheet](https://stackoverflow.com/questions/4078871/using-uiactionsheet-on-ipad?rq=1)

> *如果您从**已经在弹出**框内的 UIBarButtonItem 或 UIToolbar 显示它，那么它会以与 iPhone 上类似的方式显示*

对我来说，表格显示的是拆分视图，并且在横向显示时，该表格显示为弹出框（您可以通过滑动隐藏的横向面板），因此一旦我将设备转为横向 UIActionSheet 开始显示在弹出框。原因是我用粗体表示的：它不能从另一个弹出框内显示为弹出框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:06:39.743

Instead of popping from the tableView, try converting the cell bounds to the topmost view (the controller's and pop it from there...

```
CGRect frame = [self.view convertRect:cell.bounds fromView:cell];
[sheet showFromRect:frame inView:self.view animated:YES]; 
```

Might be the case that there's more hierarchy inside the tableView and it's breaking your stuff.

# awk - 解析一段数据，一次性获取 id 和 email

> ID：14146201
> 
> 赞同：0
> 
> 时间：2013-01-03T19:55:16.057
> 
> 标签：awk, grep

我需要一些关于是否可以完成的建议..我有以下数据（这只是一行，会有这样的行块）在运行命令后出现，有没有办法可以使用 grep 和 awk 并解析每一行都可以一次性获取号码和所有者电子邮件，如下所示

```
Output:-

12345 mbarry@int.qualcomm.com

Input:-
change I5e55796844350e543f8460c53ec6e755ebe663d4
  project: platform/vendor/company-proprietary/chip
  branch: master
  id: I5e55796844350e543f8460c53ec6e755ebe663d4
  number: 12345
  subject: chip: changes to tl logging structure
  owner:
    name: Gord barry
    email: mbarry@int.qualcomm.com
    username: mbarry
  url: https://review-android.quicinc.com/12345
  commitMessage: chip: changes to tl logging structure

                 The existing TL logging has been divided into three distinct modules:
                 TL_BA (14), TL_HO (13) and TL (existing module). Thus the log with
                 loglevel 5 in file chip_qct_tl_hostsupport.c can be viewed by issuing
                 the following command - iwpriv chip0 setchipdbg 13 5 1.

                 Change-Id: I5e55796844350e543f8460c53ec6e755ebe663d4
  createdOn: 2012-08-09 15:40:57 PDT
  lastUpdated: 2012-08-21 16:43:08 PDT
  sortKey: 001f390f00023ead
  open: true
  status: NEW
  currentPatchSet:
    number: 3
    revision: 922872178946a712ab9f04483bc93216573cec6e
    parents:
 [ae259408e6ab530be62e02fdeafef34834d68709]
    ref: refs/changes/17/12345/3
    uploader:
      name: Gord barry
      email: mbarry@int.qualcomm.com
      username: mbarry
    createdOn: 2012-08-21 16:43:08 PDT
    files:
      file: /COMMIT_MSG
      type: ADDED
    files:
      file: rich/CORE/TL/inc/tlDebug.h
      type: MODIFIED
    files:
      file: rich/CORE/TL/inc/chip_qct_tl.h
      type: MODIFIED
    files:
      file: rich/CORE/TL/src/chip_qct_tl.c
      type: MODIFIED
    files:
      file: rich/CORE/TL/src/chip_qct_tl_ba.c
      type: MODIFIED
    files:
      file: rich/CORE/TL/src/chip_qct_tl_hosupport.c
      type: MODIFIED
    files:
      file: rich/CORE/VOSS/inc/vos_types.h
      type: MODIFIED
    files:
      file: rich/CORE/VOSS/src/vos_trace.c
      type: MODIFIED
    files:
      file: rich/CORE/WDA/src/chip_qct_wda_ds.c
      type: MODIFIED
    files:
      file: rich/CORE/WDI/TRP/DTS/src/chip_qct_wdi_dts.c
      type: MODIFIED 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T21:09:22.980

`grep`一次性使用：

```
$ grep -Po '(?<=(email|umber): )\S+' file
12345 
mbarry@int.qualcomm.com
3 
mbarry@int.qualcomm.com 
```

用于`xargs -n2`将两者放在一条线上：

```
$ grep -Po '(?<=(email|umber): )\S+' file | xargs -n2
12345 mbarry@int.qualcomm.com
3 mbarry@int.qualcomm.com

$ grep -Po '(?<=(email|umber): )\S+' tfile | paste - -
12345   mbarry@int.qualcomm.com
3       mbarry@int.qualcomm.com 
```

解释：

这是匹配后跟的[正向回溯](http://www.regular-expressions.info/lookaround.html) 。在您的情况下，您希望匹配后面的字符串，或者后面的正面外观必须是固定长度，因此我们必须删除数字。匹配一个或多个非空白字符。`'(?<=a)b'``b``a``email:``number:``n``\S+`

```
(?<=   # Positive lookbehind 
(      # Group for alternation
email  # Literal string email
|      # Alternation (or)
umber  # Literal string umber
)      # Close 
:      # : Literal colon and single space 
)      # Close positive lookbehind 
\S+    # One or more non-whitespace character 
```

* * *

与`awk`：

```
$ awk -F: '/email|number/{print $2}' file | xargs -n2
12345 mbarry@int.qualcomm.com
3 mbarry@int.qualcomm.com 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:57:16.960

试试这些：

```
awk -F'[[:space:]:]+' '{a[$2]=$3} END{ print a["number"], a["email"] }' file
awk -F'[[:space:]:]+' '{a[$2]=$3} /email:/{ print a["number"], a["email"] }' file
awk -F'[[:space:]:]+' '{a[$2]=$3} /email:/{ print a["number"], a["email"]; exit }' file 
```

如果这些都不是您要查找的内容，请提供有关您要查找的内容的更多详细信息。

以下是上面最后一个脚本对我发布的示例输入的工作方式：

```
$ head -15 file
change I5e55796844350e543f8460c53ec6e755ebe663d4
  project: platform/vendor/company-proprietary/chip
  branch: master
  id: I5e55796844350e543f8460c53ec6e755ebe663d4
  number: 12345
  subject: chip: changes to tl logging structure
  owner:
    name: Gord barry
    email: mbarry@int.qualcomm.com
    username: mbarry
  url: https://review-android.quicinc.com/12345
  commitMessage: chip: changes to tl logging structure

                 The existing TL logging has been divided into three distinct modules:
                 TL_BA (14), TL_HO (13) and TL (existing module). Thus the log with

$ awk -F'[[:space:]:]+' '{a[$2]=$3} /email:/{ print a["number"], a["email"]; exit }' file
12345 mbarry@int.qualcomm.com 
```

# javascript - 用于 iframe 小部件的 OAuth2.0

> ID：14146203
> 
> 赞同：2
> 
> 时间：2013-01-03T19:55:24.757
> 
> 标签：javascript, api, oauth, oauth-2.0

我有一个带有公共 API 的网站：

```
mysite.com
api.mysite.com（受 OAuth2.0 保护）
```

我的网站将允许其他网站所有者在他们的页面上放置 iframe 小部件，类似于 Facebook 朋友小部件。当消费者登录到小部件时，我需要它与我的公共 API 进行通信。我目前有一个 3-legged auth 设置：

1.  使用 clientId 请求代码
2.  使用clientId、clientSecret和code请求accessToken
3.  像这样进行 API 调用：

    ```
    https://api.mysite.com/me?access_token=12345
    ```

我的 API 是无状态的（没有会话），并且依赖于访问令牌来验证每个请求。如何设置我的 javascript 小部件以与我的 OAuth2 API 通信？我的第一个想法是将访问令牌存储在 cookie 中，但我知道这不安全。

# eclipse - 在 OpenShift 上的 JBoss 服务器上找不到 hibernate.cfg.xml

> ID：14146204
> 
> 赞同：0
> 
> 时间：2013-01-03T19:55:27.447
> 
> 标签：eclipse, hibernate, jboss, openshift

朋友们正在尝试通过休眠 orm 在 openshift 中连接我的应用程序。但部署失败。您可以检查服务器日志中的错误消息：

```
    2013/01/03 14:02:59,296 错误 [com.wavetech_st.util.HibernateUtil]（MSC 服务线程 1-4）Falha na criação do objeto SessionFactory: org.hibernate.HibernateException: hibernate.cfg.xml not found
    2013/01/03 14:02:59,298 错误 [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/testehome]]（MSC 服务线程 1-4）异常启动过滤器conexaoFilter: java.lang.ExceptionInInitializerError
            在 com.wavetech_st.util.HibernateUtil.buildSessionFactory(HibernateUtil.java:26) [类：]
            在 com.wavetech_st.util.HibernateUtil.(HibernateUtil.java:12) [类：]
            在 com.wavetech_st.web.filter.ConexaoHibernateFilter.init(ConexaoHibernateFilter.java:31) [类：]
            在 org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:447) [jbossweb-7.0.10.Final.jar:]
            在 org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:3269) [jbossweb-7.0.10.Final.jar:]
            在 org.apache.catalina.core.StandardContext.start(StandardContext.java:3865) [jbossweb-7.0.10.Final.jar:]
            在 org.jboss.as.web.deployment.WebDeploymentService.start(WebDeploymentService.java:90) [jboss-as-web-7.1.0.Final.jar:7.1.0.Final]
            在 org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811)
            在 org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)
            在 java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) [rt.jar:1.7.0_09-icedtea]
            在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) [rt.jar:1.7.0_09-icedtea]
            在 java.lang.Thread.run(Thread.java:722) [rt.jar:1.7.0_09-icedtea]
    引起：org.hibernate.HibernateException：找不到资源/hibernate.cfg.xml
            在 org.hibernate.internal.util.ConfigHelper.getResourceAsStream(ConfigHelper.java:173) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]
            在 org.hibernate.cfg.Configuration.getConfigurationInputStream(Configuration.java:1943) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]
            在 org.hibernate.cfg.Configuration.configure(Configuration.java:1924) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]
            在 com.wavetech_st.util.HibernateUtil.buildSessionFactory(HibernateUtil.java:19) [类：]
            ... 11 更多

```

我正在 Eclipse 中创建这个应用程序。我已经在本地服务器 JBoss 7.1 上对其进行了测试，并且可以正常工作。但是，当我尝试远程时会出现错误。在部署到 OpenShift 之前，我将文件 hibernate.cfg 设置为数据源：

 `````
<property name="connection.datasource">java:jboss/datasources/MysqlDS</property> 
````  `这是我的目录结构：

![在此处输入图像描述](../Images/246ec57c105ed8cae2e02f673259d91c.png)

这是我的网络过滤器：

```
    包 com.wavetech_st.web.filter；
    导入 java.io.IOException；
    导入 javax.servlet.*；
    导入 org.hibernate.SessionFactory；
    导入 com.wavetech_st.util.HibernateUtil；

    公共类 ConexaoHibernateFilter 实现过滤器 {

        私人 SessionFactory sf;

        @覆盖
        public void init(FilterConfig config) throws ServletException {// executado quando o aplicativo web e colocado no ar

            this.sf = HibernateUtil.getSessionFactory();

        }

        @覆盖
        公共无效doFilter（ServletRequest servletRequest，ServletResponse servletResponse，FilterChain链）抛出IOException，ServletException {

            尝试 {

                this.sf.getCurrentSession().beginTransaction();
                chain.doFilter(servletRequest, servletResponse);
                this.sf.getCurrentSession().getTransaction().commit();
                this.sf.getCurrentSession().close();

            } 捕捉（可投掷的前）{

                尝试 {

                    if(this.sf.getCurrentSession().getTransaction().isActive())
                        this.sf.getCurrentSession().getTransaction().rollback();

                } 捕捉（可投掷的 t）{

                    t.printStackTrace();

                }

                抛出新的 ServletException(ex);

            }
        }

        @覆盖
        公共无效销毁（）{}
    }

```

```
This is my HibernateUtil:

<pre>

package com.wavetech_st.util;
import org.apache.log4j.Logger;
import org.hibernate.SessionFactory;
import org.hibernate.cfg.Configuration;
import org.hibernate.service.ServiceRegistry;
import org.hibernate.service.ServiceRegistryBuilder;

public class HibernateUtil {

    static final Logger logger = Logger.getLogger(HibernateUtil.class);
    private static final SessionFactory sessionFactory  = buildSessionFactory();
    private static ServiceRegistry      serviceRegistry;

    private static SessionFactory buildSessionFactory() {

        try {

            Configuration cfg = new Configuration().configure("hibernate.cfg.xml");
            serviceRegistry = new ServiceRegistryBuilder().applySettings(cfg.getProperties()).buildServiceRegistry();

            return cfg.buildSessionFactory(serviceRegistry);
        } catch (Throwable e) {

            logger.error("Falha na criação do objeto SessionFactory: " + e);
            throw new ExceptionInInitializerError(e);

        }
    }

    public static SessionFactory getSessionFactory() {

        return sessionFactory;
    }
} 
```

请帮忙 ：-/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T16:12:47.680

我按照这些人的提示解决了我的问题：

[stackoverflow.com/questions/4934330/org-hibernate-hibernateexception-hibernate-cfg-xml-not-found](https://stackoverflow.com/questions/4934330/org-hibernate-hibernateexception-hibernate-cfg-xml-not-found) [shaunabram.com/tag/hibernate/](http://www.shaunabram.com/tag/hibernate/)

我的问题是将 hibernate.cfg.xml 文件放在错误的位置。如何使用 Maven 我不应该放在根目录，而是放在 src 目录根资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:05:33.373

谢谢伙计，我在 jBoss-Openshift 和 Mybatis 中遇到了同样的问题，但是您的回答对我有帮助，我附上了一张图片，我在其中放置了与 hibernate 类似的文件的 Mybatis 配置文件

![Mybatis 配置文件和 Openshift](../Images/69028d8a3048a4db6a17c863ab75a901.png)``

# windows - 如何制作将运行 HTML 网页的 Windows 应用程序 (.EXE)

> ID：14146205
> 
> 赞同：0
> 
> 时间：2013-01-03T19:55:27.470
> 
> 标签：windows, web-applications, exe

我想为 Windows 创建一个桌面应用程序，它将在其中运行指定的网站 url。例如看这个蒙太奇——我想要一个像fluidapp.com（Mac支持）这样的软件。

蒙太奇链接- [http://dl.dropbox.com/u/65090365/2013/preview.jpg](http://dl.dropbox.com/u/65090365/2013/preview.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:59:26.627

有一个 Windows 窗体 WebBrowser 控件应该做你想做的事。

[http://msdn.microsoft.com/en-us/library/2te2y1x6.aspx](http://msdn.microsoft.com/en-us/library/2te2y1x6.aspx)

# ios - iOS 简单 XML 解析天气

> ID：14146209
> 
> 赞同：0
> 
> 时间：2013-01-03T19:55:42.307
> 
> 标签：ios, xml, xcode, rss, gdataxml

在使用 Ray Wenderlich 的一些指南之前，我已经完成了 xml 解析，但这些通常适用于涉及多个项目的情况。我正在让一个应用程序简单地显示给定时间的天气状况，并且提要的 XML 只是检查时间的条件。这是有问题的提要：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
        <rss version="2.0" xmlns:yweather="http://xml.weather.yahoo.com/ns/rss/1.0" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#">
            <channel>

<title>Yahoo! Weather - Montgomery, AL</title>
<link>http://us.rd.yahoo.com/dailynews/rss/weather/Montgomery__AL/*http://weather.yahoo.com/forecast/USAL0375_f.html</link>
<description>Yahoo! Weather for Montgomery, AL</description>
<language>en-us</language>
<lastBuildDate>Thu, 03 Jan 2013 11:55 am CST</lastBuildDate>
<ttl>60</ttl>
<yweather:location city="Montgomery" region="AL"   country="United States"/>
<yweather:units temperature="F" distance="mi" pressure="in" speed="mph"/>
<yweather:wind chill="43"   direction="0"   speed="5" />
<yweather:atmosphere humidity="66"  visibility="10"  pressure="30.26"  rising="2" />
<yweather:astronomy sunrise="6:46 am"   sunset="4:52 pm"/>
<image>
<title>Yahoo! Weather</title>
<width>142</width>
<height>18</height>
<link>http://weather.yahoo.com</link>
<url>http://l.yimg.com/a/i/brand/purplelogo//uh/us/news-wea.gif</url>
</image>
<item>
<title>Conditions for Montgomery, AL at 11:55 am CST</title>
<geo:lat>32.38</geo:lat>
<geo:long>-86.3</geo:long>
<link>http://us.rd.yahoo.com/dailynews/rss/weather/Montgomery__AL/*http://weather.yahoo.com/forecast/USAL0375_f.html</link>
<pubDate>Thu, 03 Jan 2013 11:55 am CST</pubDate>
<yweather:condition  text="Mostly Cloudy"  code="28"  temp="46"  date="Thu, 03 Jan 2013 11:55 am CST" />
<description><![CDATA[
<img src="http://l.yimg.com/a/i/us/we/52/28.gif"/><br />
<b>Current Conditions:</b><br />
Mostly Cloudy, 46 F<BR />
<BR /><b>Forecast:</b><BR />
Thu - Partly Cloudy. High: 50 Low: 31<br />
Fri - Sunny. High: 57 Low: 35<br />
<br />
<a href="http://us.rd.yahoo.com/dailynews/rss/weather/Montgomery__AL/*http://weather.yahoo.com/forecast/USAL0375_f.html">Full Forecast at Yahoo! Weather</a><BR/><BR/>
(provided by <a href="http://www.weather.com" >The Weather Channel</a>)<br/>
]]></description>
<yweather:forecast day="Thu" date="3 Jan 2013" low="31" high="50" text="Partly Cloudy" code="30" />
<yweather:forecast day="Fri" date="4 Jan 2013" low="35" high="57" text="Sunny" code="32" />
<guid isPermaLink="false">USAL0375_2013_01_04_7_00_CST</guid>
</item>
</channel>
</rss> 
```

基本上，我对应用程序只需要当前的温度和条件，它们在 item 标签下包含在 yweather:conditions 标签中。使用 GDataXML，获取此信息并设置 NSString 等于它的最简单方法是什么？

现在，我正在使用 Ray 的教程中的一些复杂的东西，包括 asihttprequest 和 blocks 用于排序并将其全部放入 NSMutableArray，但我相当肯定它现在不需要那么复杂。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T21:21:41.527

我喜欢直接解析的 TBXML：[http](http://www.tbxml.co.uk/TBXML/TBXML_Free.html) ://www.tbxml.co.uk/TBXML/TBXML_Free.html 。

# java - playframework 模块和路由

> ID：14146211
> 
> 赞同：3
> 
> 时间：2013-01-03T19:55:48.397
> 
> 标签：java, playframework

我用玩！框架 1.2.5

我有一个模块“商业模式”。在 conf/routes 中：

> GET / businessmodel.Admin.index

我有控制器：

```
package controllers.businessmodel;

import play.mvc.Controller;

public class Admin extends Controller { ... 
```

和一个观点：

> /view/businessmodel/Admin/index.html

在依赖于这个模块的主应用程序中，在 conf/routes 我有：

> GET /admin 模块：商业模式

当转到 myhost:9000/admin 我在页面上有错误：

> 未找到
> GET /admin

此外，在同一个错误页面上，我列出了已定义的路线：

```
GET       /                                                 Application.index
GET       /admin/                                           businessmodel.Admin.index
GET       /favicon.ico                                      404
GET       /public/                                          staticDir:public
*         /{controller}/{action}                            {controller}.{action}                      {controller}.{action} 
```

--

但是如果将模块的路由更改为这一行（添加“？”）：

```
GET     /?                      businessmodel.Admin.index 
```

那么我们有不同的错误：

> @6cpelo7bh 请求 GET /admin 的内部服务器错误 (500)
> 
> 找不到操作 找不到操作 businessmodel.Admin.index。引发的错误是 MODULE$

我错过了要定义的东西吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-03T20:09:36.673

我找到了解决方案..这个奇怪的错误仍然出现：

> 找不到操作 找不到操作 businessmodel.Admin.index。引发的错误是 MODULE$

这是问题：

[https://play.lighthouseapp.com/projects/57987/tickets/414-better-error-message-when-action-method-is-missing-parameter](https://play.lighthouseapp.com/projects/57987/tickets/414-better-error-message-when-action-method-is-missing-parameter)

（我已经在这个问题中添加了我的最终评论。）

如果一个人忘记了控制器方法中的*静态*。我花了一个小时在这上面..

# python - Python即时通讯程序无法连接errno 111

> ID：14146212
> 
> 赞同：0
> 
> 时间：2013-01-03T19:55:49.687
> 
> 标签：python, sockets, tcp, instant-messaging

我正在尝试使用 socket 模块在 Python 中实现一个简单的 TCP 即时消息程序。当我使用 in 返回的值`socket.gethostname()`时`connect()`，客户端在连接到在 localhost 上运行的 IM 服务器时工作得非常好。但是，当我使用返回的值时，客户端返回 errno 111（拒绝连接）`socket.gethostbyname("localhost")`。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:43:08.200

如果您在尝试时收到 111 `connect`，这通常意味着没有在该主机和端口上监听。

使用单线使用[`netcat`](http://en.wikipedia.org/wiki/Netcat)（您可能已在除 Windows 之外的任何平台上内置，如果您不这样做也可以轻松获得），或者`telnet`如果您必须：

```
abarnert$ nc -v localhost 111
nc: connect to localhost port 111 (tcp) failed: Connection refused
nc: connect to localhost port 111 (tcp) failed: Connection refused
nc: connect to localhost port 111 (tcp) failed: Connection refused 
```

由于 netcat 无法连接，问题不在于您的 Python 客户端，而实际上是没有可连接的内容。

这意味着您的服务器没有在 localhost:111 上侦听。

除了简要提及之外，如果不了解您的服务器的任何信息，就无法诊断，但我的第一个猜测是您正在`bind((gethostname(), 111))`执行`10.0.0.3:111`.

如果你想监听所有的主机和接口，有很多方法可以指定，但最简单的方法是：

```
serversocket.bind(('', 111)) 
```

# ajax - codeigniter ajax firebug 显示 200 但不显示结果

> ID：14146215
> 
> 赞同：2
> 
> 时间：2013-01-03T19:55:57.787
> 
> 标签：ajax, codeigniter, autocomplete

我需要快速帮助。请帮我找出问题所在。

我有一个客户的项目，即在 codeigniter 框架中。我的客户需要在他们的网站上自动完成。我尽力让它发挥作用。一切都好，我根据教程编写了 MVC。但我的脚本什么也没返回

我对自动完成的看法

```
 <link rel="stylesheet" href="<?php echo $this->config->item('view_path');?>autocomplete/ui.theme.css" type="text/   css" media="all" />
    <script src="<?php echo $this->config->item('view_path');?>autocomplete/1.4.3.jquery.min.js" type="text/javascript"></script>
    <script src="<?php echo $this->config->item('view_path');?>autocomplete/1.8.6.jquery-ui.min.js" type="text/javascript"></script>
    <script type="text/javascript">
    $(this).ready( function() {
        $("#postcode").autocomplete({
            minLength: 1,
            source: 
            function(req, add){
                $.ajax({
                    url: "<?php echo base_url(); ?>home/lookup",
                    dataType: 'json',
                    type: 'POST',
                    data: req,
                    success:    
                    function(data){
                        if(data.response =="true"){
                            add(data.message);
                        }
                    },
                });
            },
        select: 
            function(event, ui) {
                $("#result").append(
                    "<li>"+ ui.item.value + "</li>"
                );                  
            },      
        });
    });
    </script> 
```

我的自动完成控制器是

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Autocomplete extends CI_Controller {

function index()
{
    $this->load->view('autocomplete');
}

function lookup(){
    // process posted form data (the requested items like province)
    $keyword = $this->input->post('term');
    $data['response'] = 'false'; //Set default response
    $query = $this->MAutocomplete->lookup($keyword); //Search DB
    if( ! empty($query) )
    {
        $data['response'] = 'true'; //Set response
        $data['message'] = array(); //Create array
        foreach( $query as $row )
        {
            $data['message'][] = array( 
                                    'id'=>$row->PC_POST_CODE,
                                    'value' => $row->PC_TOWN.' '.$row->PC_POST_CODE,
                                    ''
                                 );  //Add a row to array
        }
    }
    if('IS_AJAX')
    {
        echo json_encode($data); //echo json string if ajax request

    }
    else
    {
        $this->load->view('autocomplete/index',$data); //Load html view of search results
    }
} 
```

}

/* 文件结尾 autocomplete.php *//*位置：./application/controllers/autocomplete.php */

并且模型在示例中也是相同的。

当我在 fire bug 的控制台中看到时，我看到了这条消息，但没有结果。

```
 http://yaashinii.com/maxsurge/tyrechangr/index.php/home/lookup  200 OK    3.28s 
```

网站链接是你可以访问的。

```
 http://yaashinii.com/maxsurge/tyrechangr/ 
```

我还检查了当我只使用 simpe ajax 调用时，结果是否相同。甚至当我更改控制器方法以仅显示结果时，假设我更改了

```
 function lookup(){
     echo 'waheed'; exit;
   } 
```

即使那样，结果也一样

```
 http://yaashinii.com/maxsurge/tyrechangr/index.php/home/lookup  200 OK 3.28s 
```

请帮助我这是一种新的问题，我不明白为什么会发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T06:26:43.393

我得到了解决方案。

我正在访问这个地址`http://www.yaashinii.com/maxsurge/tyrechangr/`，但我已经在 codeigniter 的配置文件中定义了基本 url，`http://yaashinii.com/maxsurge/tyrechangr/index.php/`因此它变成了一个跨域。而ajax不允许跨域访问。您可以看到我正在使用`www`和没有`www`.

# makefile - Makefile：来自相同源的两个目标使用不同的标志编译两次

> ID：14146216
> 
> 赞同：1
> 
> 时间：2013-01-03T19:56:01.337
> 
> 标签：makefile

我正在从相同的 C 源文件构建两个目标 - 一个可执行文件和一个共享库。共享库要求代码可重定位（使用 -fPIC 编译），但由于各种原因，我无法在可执行文件中使用可重定位代码。在 Makefile 中是否有处理这种情况的标准/通用方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:36:51.253

我建议你有两个目标文件目录，一个用于标准对象，一个用于可重定位对象。像这样的东西：

```
$(STANDARD_OBJS) = $(addprefix $(STANDARD_OBJS_DIR)/, $(OBJS))
$(RELOC_OBJS) = $(addprefix $(RELOC_OBJS_DIR)/, $(OBJS))

$(RELOC_OBJS_DIR)/%.o: CCFLAGS += -fPic
$(RELOC_OBJS_DIR)/%.o $(STANDARD_OBJS_DIR)/%.o: $(SRC)/%.cc
    g++ $< -o $@ 
```

（有更复杂的变化，但这会让你开始。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T22:24:26.120

注入一些规则，以便二进制构建的目标依赖并使用 static_lib。

shared_lib：随便什么.so ...

static_lib: 随便.a ...

二进制：static_lib

# ldap - “name”的 LDAP 查询有效，但“managedBy”返回零结果

> ID：14146220
> 
> 赞同：2
> 
> 时间：2013-01-03T19:56:20.880
> 
> 标签：ldap, ldap-query

我在 LDAP 系统中执行查询时遇到问题。因为我能够查询经理并接收直接下属列表，所以我知道连接是正确的。

我想从该字段中搜索`RootDSE`具有部分匹配的任何项目。`managedBy`用作`*`通配符，我想搜索`*XX9XXX9*`.

`name`当我在该字段上执行以下搜索时，我收到了正确的记录：`(&(objectCategory=*)(name=XX9XXX99X99X9))`

该`managedBy`字段包含以下属性：

```
CN=Lastname\, Firstname XX9XXX9
OU=Tiered Services
OU=Premium
OU=NCG
OU=Accounts
OU=BAND
DC=corp
DC=XXXXXXXXX
DC=com 
```

当我尝试与`name`字段相同的查询时，不会返回任何结果。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:29:33.123

您必须尝试另一种方法来获得您所追求的内容：[managedBy](http://msdn.microsoft.com/en-us/library/windows/desktop/ms676857%28v=vs.85%29.aspx)包含一个专有名称，并且[DN 不支持](http://msdn.microsoft.com/en-us/library/ms684431%28VS.85%29.aspx)查询中的通配符。

**编辑：**[使用 ManagedBy 属性](https://stackoverflow.com/questions/6983135/active-directory-c-sharp-using-managedby-attribute)的 Active Directory C# 可能重复

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T22:00:59.710

发现导致问题的问题...我 /was/ 使用的应用程序没有以正确的方式进行搜索 - 它正在尝试进行字符串搜索，但实际上，OU 条目不是字符串，它是一个数字（OU 的 ID）.... 应用程序试图为我思考。

它没有显示 ID，而是自行执行查找并显示查找结果，而不是字段中的实际值。

# android - 如何使用 adb shell 显示本地图像

> ID：14146223
> 
> 赞同：8
> 
> 时间：2013-01-03T19:56:33.953
> 
> 标签：android, adb

我想用来`adb shell`告诉我的设备在其 SD 卡上显示图像。我认为这个命令会起作用：

```
adb shell am start -a android.intent.action.MAIN -n com.android.browser/.BrowserActivity -d file:///storage/sdcard0/Android/data/<mypackage>/files/myfile.jpg 
```

不幸的是，我收到了这个错误：

> 开始： Intent { act=android.intent.action.MAIN cmp=com.android.browser/.BrowserActivity }
> 错误类型 3
> 错误：活动类 {com.android.browser/com.android.browser.BrowserActivity} 不存在。

我也尝试做一个`VIEW`动作，并尝试只使用`-n`or`-d`参数。

```
adb shell am start -a android.intent.action.VIEW -d file:///storage/sdcard0/Android/data/<mypackage>/files/myfile.jpg 
```

仅使用`-d`参数会导致此错误（我尝试在路径上使用和不使用“file://”前缀）：

> 开始：Intent { act=android.intent.action.VIEW dat=/storage/sdcard0/Android/data//files/myfile.jpg }
> 错误：Activity 未启动，无法解析 Intent { act=android.intent.action。查看 dat=/storage/sdcard0/Android/data//files/myfile.jpg flg=0x10000000 }

该文件的权限是：

```
-rw-rw-r-- root     sdcard_rw   198106 2013-01-02 21:29 gUD9w5.jpg 
```

我正在使用运行 4.1.1 的有根 Galaxy Nexus 进行测试。

**更新**：我尝试了 dtmilano 的建议，但裁剪工具给出了“无法加载图像”弹出窗口。logcat 的堆栈跟踪是：

```
ActivityManager: START {dat=file:///storage/sdcard0/Android/data/<mypackage>/Pictures/myfile.jpg typ=image/* 
    flg=0x13000000 cmp=com.google.android.gallery3d/com.android.gallery3d.app.CropImage u=0} from pid 301
UriImage: fail to open: file:///storage/sdcard0/Android/data/<mypackage>/Pictures/myfile.jpg
UriImage: java.io.FileNotFoundException: /storage/sdcard0/Android/data/<mypackage>/Pictures/myfile.jpg: 
    open failed: ENOENT (No such file or directory)
UriImage:   at libcore.io.IoBridge.open(IoBridge.java:416)
UriImage:   at java.io.FileInputStream.<init>(FileInputStream.java:78)
UriImage:   at java.io.FileInputStream.<init>(FileInputStream.java:105)
UriImage:   at android.content.ContentResolver.openInputStream(ContentResolver.java:445)
UriImage:   at com.android.gallery3d.data.UriImage.openOrDownloadInner(UriImage.java:98)
UriImage:   at com.android.gallery3d.data.UriImage.openFileOrDownloadTempFile(UriImage.java:78)
UriImage:   at com.android.gallery3d.data.UriImage.prepareInputFile(UriImage.java:164)
UriImage:   at com.android.gallery3d.data.UriImage.access$100(UriImage.java:40)
UriImage:   at com.android.gallery3d.data.UriImage$RegionDecoderJob.run(UriImage.java:170)
UriImage:   at com.android.gallery3d.data.UriImage$RegionDecoderJob.run(UriImage.java:168)
UriImage:   at com.android.gallery3d.app.CropImage$LoadDataTask.run(CropImage.java:921)
UriImage:   at com.android.gallery3d.app.CropImage$LoadDataTask.run(CropImage.java:913)
UriImage:   at com.android.gallery3d.util.ThreadPool$Worker.run(ThreadPool.java:124)
UriImage:   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
UriImage:   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
UriImage:   at java.lang.Thread.run(Thread.java:856)
UriImage:   at com.android.gallery3d.util.PriorityThreadFactory$1.run(PriorityThreadFactory.java:43)
UriImage: Caused by: libcore.io.ErrnoException: open failed: ENOENT (No such file or directory)
UriImage:   at libcore.io.Posix.open(Native Method)
UriImage:   at libcore.io.BlockGuardOs.open(BlockGuardOs.java:110)
UriImage:   at libcore.io.IoBridge.open(IoBridge.java:400)
UriImage:   ... 16 more 
```

我想知道这是否是内部 SD 卡，并且图像可能被视为应用程序数据，因此其他应用程序无法访问它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-03T21:30:17.873

这应该可以工作，但是它取决于您安装的应用程序：

```
$ adb shell am start -t image/* -d file:///mnt/sdcard/myfile.jpg 
```

有趣的是，如果您在**Complete action using...中选择****Gallery**则不起作用，但如果您选择**Crop picture**则有效。也适用于**Astro Image Viewer**。

 ******* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T20:34:15.780

我的要求最快的解决方法是从设备中提取文件并在我的本地机器上测试它：

```
adb pull /storage/sdcard0/Android/data/<mypackage>/files/myfile.jpg ~/Downloads 
```******

# php - mySQL 从 URL 查询中获取单个列的多个参数

> ID：14146225
> 
> 赞同：0
> 
> 时间：2013-01-03T19:56:38.727
> 
> 标签：php, mysql

我有一个向此输出数据的表单：

```
index.php?city=ADDIEVILLE&city=ALBERS&city=ALHAMBRA 
```

然后需要像这样进入一个mysql where语句：

```
WHERE CITY = ADDIEVILLE OR CITY = ALBERS OR CITY = ALHAMBRA 
```

我如何能够使用 PHP 将这些多个城市传递给 mySQL 查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T20:00:07.473

`index.php?city=ADDIEVILLE&city=ALBERS&city=ALHAMBRA`

将打印为：`$_GET['city']='ALHAMBRA';`

然而：

`index.php?city[]=ADDIEVILLE&city[]=ALBERS&city[]=ALHAMBRA`

将打印为数组。

然后可以将其转换为：

```
$cities = $_GET['city'];

$str = "CITY='".implode("' OR CITY='",$cities)."'";
echo $str; 
```

注意：`$cities`注射时应消毒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:01:13.170

正如[@MichaelBerkowski 所说](https://stackoverflow.com/questions/14146225/mysql-getting-multiple-arguments-for-single-column-from-url-query/14146300#comment19591285_14146225)，您应该使用`city[]`作为您的字段名称，然后您可以执行以下操作：

```
$dbh = new PDO("mysql:dbname=$dbname", $username, $password);
$dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, FALSE);

$qry = $dbh->prepare('
  SELECT *
  FROM   my_table
  WHERE  CITY IN ('.implode(',', array_fill(0, count($_GET['city']), '?')).')
');

$qry->execute($_GET['city']); 
```

# java - 使用 DatabaseMetaData 检索 mysql 表注释

> ID：14146230
> 
> 赞同：2
> 
> 时间：2013-01-03T19:56:46.107
> 
> 标签：java, mysql, jdbc, vaadin, database-metadata

因此，我将 Vaadin Java Web 框架用于需要能够编辑表格的项目。Vaadin 提供了一种从中获取`Connection`对象的方法`SimpleJDBCConnectionPool`（[这里是 API](https://vaadin.com/api/com/vaadin/data/util/sqlcontainer/connection/SimpleJDBCConnectionPool.html)）

从`Connection`我可以得到`DatabaseMetaData`对象。我有以下代码：

```
private List<String> getTableNames(DatabaseMetaData md) throws SQLException {
        ArrayList<String> tables = new ArrayList<String>();
        ResultSet rs = md.getTables(null, null, "", null);
        while (rs.next()) {
            tables.add(rs.getString("TABLE_NAME")); //Column 3 is for table name
            Logger.getLogger(CodeContainingClass.class.getName()).
                    info("Comment: " + rs.getString("REMARKS")); //Column 5 is for remarks
        }
        return tables;
} 
```

它正确检索表名称，但不幸的是 REMARKS 返回`null`。（[这里是 API](http://docs.oracle.com/javase/6/docs/api/java/sql/DatabaseMetaData.html#getTables%28java.lang.String,%20java.lang.String,%20java.lang.String,%20java.lang.String%5B%5D%29)）。我不确定我做错了什么。

我使用以下查询验证了该表是否有注释：

```
SHOW TABLE STATUS WHERE Name='tablename'; 
```

任何帮助将不胜感激。非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:34:47.320

请参阅此[MySQL Connector/J 错误](http://bugs.mysql.com/bug.php?id=65213)（特别是 2012 年 6 月 27 日 11:26 和 2012 年 6 月 28 日 11:18 的评论）。您需要指定连接属性`useInformationSchema=true`才能获得此功能。

另请参阅[连接器/J 连接属性](http://dev.mysql.com/doc/refman/5.5/en/connector-j-reference-configuration-properties.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-03T20:34:39.583

在 MySQL 中，与每个表关联的注释可从`information_schema`.

试试这个查询：

```
 SELECT TABLE_NAME, TABLE_COMMENT
   FROM INFORMATION_SCHEMA.TABLES
  WHERE TABLE_SCHEMA = 'YourDatabaseName' 
```

请务必替换您实际使用的数据库名称。

# java - Android 设备按钮和 PhoneGap/Cordova

> ID：14146231
> 
> 赞同：2
> 
> 时间：2013-01-03T19:56:49.343
> 
> 标签：java, android, cordova

我正在设置 Android 设备按钮以使用我的应用程序。根据 PG/Cordova 文档，我应该能够添加一个监听器，例如

```
document.addEventListener("backbutton", function() {
    console.log('Back Button Pressed.'); 
}, false); 
```

但是，当使用我的 Nexus 7 作为测试设备时，没有任何反应。

我还尝试将覆盖直接添加到 Java 中：

```
@Override
public void onBackPressed() {
    super.loadUrl("javascript:onBackKeyDown()");
    return;
} 
```

但再一次，似乎无能为力。其他人有这个问题或修复？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T09:30:39.613

首先，将你的函数写入控制台。

```
document.addEventListener("backbutton", function() {
    console.log('Back Button Pressed.'); 
}, false); 
```

您应该将您的设备设置为调试工具（您将在下面找到如何操作的快速提示，更多信息请[点击此处](http://developer.android.com/tools/device.html)）

*   将手机连接到电脑
*   在您的手机上：检查 USB 调试；设置 => 开发者选项 => USB 调试
*   在您的手机上：检查未知来源；设置>>应用程序>>未知来源=真
*   将您的设备添加到 ADT（在您的 SDK 中）
*   直接从电脑运行项目到手机：右键项目=>运行AS=>选择你的设备

现在在后退按钮上 单击“后退按钮被按下”。将打印在 Eclipse 的控制台中。

如果您的设备未连接到计算机或您的设备未设置为调试工具，则不会发生任何变化。

在一般情况下，如果您在设备上进行测试而不将其设置为调试工具，请使用“alert()”而不是“console.log()”。

此外，不要使用本机 java，使用[Cordova 的原始文档](http://docs.phonegap.com/en/2.2.0/cordova_events_events.md.html#backbutton)，只需将以下代码添加到您的 javascript 文件中：

```
function onLoad() {
    document.addEventListener("deviceready", onDeviceReady, false);
}

// Cordova is loaded and it is now safe to call Cordova methods
//
function onDeviceReady() {
    // Register the event listener
    document.addEventListener("backbutton", onBackKeyDown, false);
}

// Handle the back button
//
function onBackKeyDown() {
 // whatever you want to do
 alert('Back button Pressed');
} 
```

那么你应该将“onLoad（）”添加到body标签中：

```
<body onLoad="onLoad()"> 
```

# ms-access - Access 不保存列的数据类型

> ID：14146235
> 
> 赞同：1
> 
> 时间：2013-01-03T19:57:01.270
> 
> 标签：ms-access, ms-access-2007, vba

我在 MS Access 应用程序中有一个本地表和一个查询。查询用值填充表，并且表有一个返回类型值应该是双精度的列，我将字段大小设置为双精度，但是在运行应用程序时，它会自动将该列的字段大小更改为小数，最多 2 个小数地方。我不希望该列具有舍入值。

例如：值 12.44556 输出为 12.44。

如何强制 Access 使用 Double 作为字段大小？目前访问，覆盖我设置的字段大小。

任何想法，我有点迷路了？

我有一个非常直接的 SQL。

```
SELECT A,B,C,D 
INTO TABLE_TEST 
FROM TESTABC 
```

其中 TABLE_TEST 是本地表，TESTABC 是 SQL 数据库表。

此外，在此之后，我正在更新列，使用如下所示的某些乘法。

```
Update TABLE_TEST
SET B= A/C*D 
```

A、B、C 和 D 都应该将字段大小设置为 Double，即使我将其设置为 Double，在运行时，Access 也会将其更改回十进制。:\

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T20:24:24.740

SELECT INTO 创建一个新表。如果要将记录添加到现有表（具有预定义的数据类型），则应使用 APPEND 查询。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T20:11:05.967

属性应该是这样的：

![双数据类型](../Images/c73b55e5ad63a2ef372bbfba67355bab.png)

导致：

![双数据](../Images/72cd444a4459fc9a3cf833a4f5c5af9b.png)

要从查询中创建它，您可以使用以下内容：

```
SELECT Table1.AText, CDbl([ANumeric]/2) AS Expr1 INTO b
FROM Table1; 
```

`CDbl`将确保您获得双倍回报。

# php - 给定当年一月的第一天，获取一年中的所有 52 周和工作日

> ID：14146236
> 
> 赞同：0
> 
> 时间：2013-01-03T19:57:01.223
> 
> 标签：php, date, datetime

我需要某种循环来存储所有星期，并且我每周都需要工作日`Mon-Fri`。

> $year = date('Y');
> 
> $firstDayOfJan = date("Ymd", strtotime("一月的第一天 {$year}"));

我将如何设置一个从一月的第一天开始并给我整个星期的循环。我正在寻找的输出如下：

例如：2013 年 1 月的第一天是星期二。运行循环后，第一周应该是这样的：

> 第 1 周 --> 从：2013 年 1 月 1 日（星期二的第一天）到：2013 年 1 月 4 日（星期五）
> 
> 第 2 周 --> 从：01-07-2013（星期一）到：01-11-2013（星期五）
> 
> ......从周一到周五的所有星期

* * *

或者用另一种[Source/Delref](https://stackoverflow.com/questions/14146880/get-past-weeks-from-the-current-week-and-all-business-days-in-between-php)来表达它：

* * *

### 从当前周获取过去几周以及 PHP 之间的所有工作日

我想从本周检索所有过去的几周。

> $currYear = 日期（“Y”）；
> 
> $currDate = date("mdY", time()); //获取当前日期
> 
> for($i = $currDate; $i > 01-01-$currYear; $i--) (当年一月一日)) 打印所有星期

从本周开始，我想回溯并获取过去几周的所有内容。因此，如果我在 7 月中旬，我希望能够在 7 月之前的所有周内展示到 1 月 1 日。

周格式必须是这样的：

> 第 1 周（一月）： FROM：从日期到：至今

任何帮助都非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T21:31:28.137

如果我算对的话，2013 年你需要考虑 53 周：

1.  第 1 周 --> 从：2013 年 1 月 1 日（星期二）到：2013 年 1 月 4 日（星期五）
2.  第 2 周 --> 从：2013 年 1 月 7 日（星期一）到：2013 年 1 月 11 日（星期五）
3.  第 3 周 --> 从：2013 年 1 月 14 日（星期一）到：2013 年 1 月 18 日（星期五）
4.  第 4 周 --> 从：2013 年 1 月 21 日（星期一）到：2013 年 1 月 25 日（星期五）
5.  第 5 周 --> 从：2013-01-28（星期一）到：2013-02-01（星期五）
6.  第 6 周 --> 从：2013 年 2 月 4 日（星期一）到：2013 年 2 月 8 日（星期五）
7.  第 7 周 --> 从：2013 年 2 月 11 日（星期一）到：2013 年 2 月 15 日（星期五）
8.  第 8 周 --> 从：2013 年 2 月 18 日（星期一）到：2013 年 2 月 22 日（星期五）
9.  第 9 周 --> 从：2013 年 2 月 25 日（星期一）到：2013 年 3 月 1 日（星期五）
10.  第 10 周 --> 从：2013-03-04（星期一）到：2013-03-08（星期五）
11.  第 11 周 --> 从：2013-03-11（星期一）到：2013-03-15（星期五）
12.  第 12 周 --> 从：2013-03-18（星期一）到：2013-03-22（星期五）
13.  第 13 周 --> 从：2013 年 3 月 25 日（星期一）到：2013 年 3 月 29 日（星期五）
14.  第 14 周 --> 从：2013-04-01（星期一）到：2013-04-05（星期五）
15.  第 15 周 --> 从：2013-04-08（星期一）到：2013-04-12（星期五）
16.  第 16 周 --> 从：2013-04-15（星期一）到：2013-04-19（星期五）
17.  第 17 周 --> 从：2013-04-22（星期一）到：2013-04-26（星期五）
18.  第 18 周 --> 从：2013 年 4 月 29 日（星期一）到：2013 年 5 月 3 日（星期五）
19.  第 19 周 --> 从：2013-05-06（星期一）到：2013-05-10（星期五）
20.  第 20 周 --> 从：2013-05-13（星期一）到：2013-05-17（星期五）
21.  第 21 周 --> 从：2013 年 5 月 20 日（星期一）到：2013 年 5 月 24 日（星期五）
22.  第 22 周 --> 从：2013-05-27（星期一）到：2013-05-31（星期五）
23.  第 23 周 --> 从：2013-06-03（星期一）到：2013-06-07（星期五）
24.  第 24 周 --> 从：2013 年 6 月 10 日（星期一）到：2013 年 6 月 14 日（星期五）
25.  第 25 周 --> 从：2013-06-17（星期一）到：2013-06-21（星期五）
26.  第 26 周 --> 从：2013 年 6 月 24 日（星期一）到：2013 年 6 月 28 日（星期五）
27.  第 27 周 --> 从：2013-07-01（星期一）到：2013-07-05（星期五）
28.  第 28 周 --> 从：2013-07-08（星期一）到：2013-07-12（星期五）
29.  第 29 周 --> 从：2013-07-15（星期一）到：2013-07-19（星期五）
30.  第 30 周 --> 从：2013 年 7 月 22 日（星期一）到：2013 年 7 月 26 日（星期五）
31.  第 31 周 --> 从：2013 年 7 月 29 日（星期一）到：2013 年 8 月 2 日（星期五）
32.  第 32 周 --> 从：2013-08-05（星期一）到：2013-08-09（星期五）
33.  第 33 周 --> 从：2013-08-12（星期一）到：2013-08-16（星期五）
34.  第 34 周 --> 从：2013 年 8 月 19 日（星期一）到：2013 年 8 月 23 日（星期五）
35.  第 35 周 --> 从：2013 年 8 月 26 日（星期一）到：2013 年 8 月 30 日（星期五）
36.  第 36 周 --> 从：2013-09-02（星期一）到：2013-09-06（星期五）
37.  第 37 周 --> 从：2013 年 9 月 9 日（星期一）到：2013 年 9 月 13 日（星期五）
38.  第 38 周 --> 从：2013 年 9 月 16 日（星期一）到：2013 年 9 月 20 日（星期五）
39.  第 39 周 --> 从：2013 年 9 月 23 日（星期一）到：2013 年 9 月 27 日（星期五）
40.  第 40 周 --> 从：2013 年 9 月 30 日（星期一）到：2013 年 10 月 4 日（星期五）
41.  第 41 周 --> 从：2013 年 10 月 7 日（星期一）到：2013 年 10 月 11 日（星期五）
42.  第 42 周 --> 从：2013 年 10 月 14 日（星期一）到：2013 年 10 月 18 日（星期五）
43.  第 43 周 --> 从：2013 年 10 月 21 日（星期一）到：2013 年 10 月 25 日（星期五）
44.  第 44 周 --> 从：2013 年 10 月 28 日（星期一）到：2013 年 11 月 1 日（星期五）
45.  第 45 周 --> 从：2013 年 11 月 4 日（星期一）到：2013 年 11 月 8 日（星期五）
46.  第 46 周 --> 从：2013 年 11 月 11 日（星期一）到：2013 年 11 月 15 日（星期五）
47.  第 47 周 --> 从：2013-11-18（星期一）到：2013-11-22（星期五）
48.  第 48 周 --> 从：2013 年 11 月 25 日（星期一）到：2013 年 11 月 29 日（星期五）
49.  第 49 周 --> 从：2013 年 12 月 2 日（星期一）到：2013 年 12 月 6 日（星期五）
50.  第 50 周 --> 从：2013 年 12 月 9 日（星期一）到：2013 年 12 月 13 日（星期五）
51.  第 51 周 --> 从：2013 年 12 月 16 日（星期一）到：2013 年 12 月 20 日（星期五）
52.  第 52 周 --> 从：2013 年 12 月 23 日（星期一）到：2013 年 12 月 27 日（星期五）
53.  第 1 周 --> 从：2013 年 12 月 30 日（星期一）到：2013 年 12 月 31 日（星期二）

您可以通过使用[`DatePeriod`](http://php.net/DatePeriod)该类来获得这样的列表，它非常灵活。

我做了以下（伪代码）：

```
for each $monday [
    in the period starting from the first day of the first week of 2013 
    with an interval of one week
    until 2013-12-31 23:59:59
] do: {
    output "X. Week XX --> "
    for each $day [
        in the period starting from $monday
        with an interval of one day
        repeated four times
    ] | [
        filter all days not having the year 
    ] | [
        filter out the first and last
    ] {
        output 
            "FROM" if has next "TO" otherwise
            ": " format($date, "Y-m-d (l)")
    }
} 
```

正如这段代码所示，我已经使用迭代器解决了这个问题。`DatePeriod`已经是可遍历的，但我还需要一个`DatePeriodYearFilter`来过滤特定年份的日期（请参阅[`FilterIterator`](http://php.net/FilterIterator)所需的`FirstAndLastIterator`，这基本上是[`CachingIterator`](http://php.net/CachingIterator).

示例代码：

```
$year = 2013;

$weeksPeriod = new DatePeriod(
    new DateTime("$year-W01-1"),
    new DateInterval('P1W'),
    new DateTime("$year-12-31T23:59:59Z")
);

foreach ($weeksPeriod as $week => $monday) {

    $daysPeriod   = new DatePeriod($monday, new DateInterval('P1D'), 4);
    $daysFiltered = new DatePeriodYearFilter($daysPeriod, $year);
    $days         = new FirstAndLastIterator($daysFiltered);

    printf(" 1\. Week %s --> ", $monday->format('W'));

    foreach ($days as $day => $date) {
        $label = $days->hasNext() ? 'FROM' : 'TO';
        printf("%s: %s ", $label, $date->format('Y-m-d (l)'));
    }

    echo "\n";
} 
```

利用 PHP 5.5 的 upcomming 生成器功能，甚至可以很容易地过滤掉没有的周以及以迭代方式开始和结束日期，因此将所有这些包装到一个迭代器中，该迭代器每周只返回 FROM（如果可用）和 TO 日期。

在 PHP 5.4 中，这可以模拟为进行一些数组转换，这似乎也可以，因为这大约没有那么多条目。这里的示例代码：

```
$workdaysOfWeekForMonday = function(DateTime $monday) use ($year) {

    $daysPeriod   = new DatePeriod($monday, new DateInterval('P1D'), 4);
    $daysFiltered = new DatePeriodYearFilter($daysPeriod, $year);
    $days         = new FirstAndLastIterator($daysFiltered);

    return array_map(function(DateTime $date) {return $date->format('Y-m-d (l)');}, iterator_to_array($days, false));
};

$result = array_filter(array_map($workdaysOfWeekForMonday, iterator_to_array($weeksPeriod)));

print_r($result); 
```

结果（缩短，这里是 2017 年的典范，上周是真实的，没有工作日，现在经过适当过滤）：

```
Array
(
    [0] => Array
        (
            [0] => 2017-01-02 (Monday)
            [1] => 2017-01-06 (Friday)
        )

    [1] => Array
        (
            [0] => 2017-01-09 (Monday)
            [1] => 2017-01-13 (Friday)
        )

    [2] => Array
        (
            [0] => 2017-01-16 (Monday)
            [1] => 2017-01-20 (Friday)
        )

    ...

    [49] => Array
        (
            [0] => 2017-12-11 (Monday)
            [1] => 2017-12-15 (Friday)
        )

    [50] => Array
        (
            [0] => 2017-12-18 (Monday)
            [1] => 2017-12-22 (Friday)
        )

    [51] => Array
        (
            [0] => 2017-12-25 (Monday)
            [1] => 2017-12-29 (Friday)
        )

) 
```

这里是我为这些示例添加的迭代器代码：[Gist](https://gist.github.com/4447499)。

# drupal - 将自定义表单数据添加到 Drupal 模块而不使用 CCK 字段

> ID：14146240
> 
> 赞同：0
> 
> 时间：2013-01-03T19:57:32.063
> 
> 标签：drupal, drupal-7, drupal-modules, cck

我对 Drupal 7 很陌生，所以请多多包涵。我创建了一个带有 JQueryUI 选项卡的 jQueryUI 拖放界面。我的问题是我找不到正确的钩子来将此自定义界面添加到管理界面。像这样（样机）[http://onlinemedia.rmcad.edu/sandBox/screenshot/screen-shot.jpg](http://onlinemedia.rmcad.edu/sandBox/screenshot/screen-shot.jpg)

我找到的所有示例都使用 CCK 字段。CCK 字段很棒，但它们没有我想要的这种自定义功能，还是没有？

任何帮助将不胜感激。

Ĵ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T04:58:02.327

cck 是 drupal 6，而不是 7。要添加到节点创建表单，您可以使用 hook_form_alter 或 hook_form_ID_alter。检查表单 api 文档以了解如何在其中任何一个钩子中向表单对象添加内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T06:04:06.470

从您的模型中，我了解到您打算将此拖放界面添加到内容类型。

如果是这种情况，我建议您先添加适当的[字段](http://drupal.org/project/modules/?f%5B0%5D=im_vid_3:20224&f%5B1%5D=drupal_core:103&f%5B2%5D=bs_project_sandbox:0)。一旦节点被保存，这些将有助于以 Drupal 方式存储数据。

一旦您对收集所需数据的字段感到满意，创建一个模块并使用[`hook_form_FORM_ID_alter`](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_form_FORM_ID_alter/7)钩子通过更改这些字段来集成您的“界面”，即表示层。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T16:48:08.290

如果您不想添加**CCK/Field**组件来存储数据，那么如何创建自己的数据库表并将自定义数据存储在其中？

这种方法很长，但我已经在一个非常大而复杂的项目中使用它来产生巨大的影响。

您将需要一个带有安装脚本的自定义模块，其中包含自定义数据库表的详细信息。

请原谅我，但我不记得更改节点编辑表单的钩子，但这是您输入实现**拖放**元素的代码的地方。

然后，您可以在提交节点编辑表单时完全保存设置，但我认为实现一些**AJAX**以将设置保存到您的自定义数据库表中可能会更好。因此，当一个组件被放入它的最终休息位置时，您可以使用 AJAX 将该信息保存到数据库中。

当用户返回编辑该页面时，您只需加载自定义设置并将其应用于**拖放**功能，他们之前的配置将对他们可见。

我确实希望这是有道理的，它可以帮助你。

# java - 有没有办法在我的 Java 游戏主菜单中放置视频

> ID：14146247
> 
> 赞同：2
> 
> 时间：2013-01-03T19:57:53.467
> 
> 标签：java, video, slick2d

我做了一个简单的 Java 游戏，当我加载游戏时，会弹出一个带有简单播放按钮和关闭按钮的启动菜单，如果我按下开始按钮 Java 会更改为另一个将用户带到游戏的类，如果我按关闭游戏关闭。目前游戏菜单很无聊我想在启动菜单中添加一个视频，这可以使用Java代码吗？如果可以，是否复杂？

到目前为止，我的菜单代码如下所示，主要的两个方法是 render 和 update 方法，render 告诉 java 要添加到屏幕上的内容，而 update 方法告诉 java 在按下按钮时要做什么：

```
 package javagame;

import org.lwjgl.input.Mouse;
import org.newdawn.slick.*;
import org.newdawn.slick.state.*;

public class Menu extends BasicGameState{

    //public String mouse= "no input yet";//COORDS if needed

    Image bg;

    public Menu(int state){
    }

    public void init(GameContainer gc, StateBasedGame sbg) throws SlickException{
    bg = new Image("res/croftbg.png");
    }

    public void render(GameContainer gc, StateBasedGame sbg, Graphics g) throws SlickException{ 
    bg.draw(0,0);
    //g.drawString(mouse, 10, 50);//COORDS if needed
    }

    public void update(GameContainer gc, StateBasedGame sbg, int delta)throws SlickException{
    int posX = Mouse.getX();
    int posY = Mouse.getY();
    //mouse = "mouse pos:" +posX+"  " +posY;//Coords if needed
    //play now button
    if((posX>110 && posX<140) && (posY>5 && posY<25)){//checks if mouse is inside play now button
        if(Mouse.isButtonDown(0)){//checks if left mouse pressed
            sbg.enterState(1);//change to play state ie(1)
        }
    }
    //exit button
    if((posX>510 && posX<535) && (posY>5 && posY<25)){
        if(Mouse.isButtonDown(0)){
            System.exit(0);//closes the widow
        }
    }
}

    public int getID(){
        return 0;
    } 
```

另外，我不需要任何音频，我只需要视频。

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:03:07.430

当然可以，使用[Java Media Framework](http://www.oracle.com/technetwork/java/javase/download-142937.html)

```
// A JPanel the plays media from a URL
import java.awt.BorderLayout;
import java.awt.Component;
import java.io.IOException;
import java.net.URL;
import javax.media.CannotRealizeException;
import javax.media.Manager;
import javax.media.NoPlayerException;
import javax.media.Player;
import javax.swing.JPanel;

public class MediaPanel extends JPanel {

    public MediaPanel(URL mediaURL) {
        setLayout(new BorderLayout()); // use a BorderLayout

        // Use lightweight components for Swing compatibility
        Manager.setHint(Manager.LIGHTWEIGHT_RENDERER, true);

        try {
            // create a player to play the media specified in the URL
            Player mediaPlayer = Manager.createRealizedPlayer(mediaURL);

            // get the components for the video and the playback controls
            Component video = mediaPlayer.getVisualComponent();
            Component controls = mediaPlayer.getControlPanelComponent();

            if (video != null) {
                add(video, BorderLayout.CENTER); // add video component
            }
            if (controls != null) {
                add(controls, BorderLayout.SOUTH); // add controls
            }
            mediaPlayer.start(); // start playing the media clip
        } // end try
        catch (NoPlayerException noPlayerException) {
            System.err.println("No media player found");
        } // end catch
        catch (CannotRealizeException cannotRealizeException) {
            System.err.println("Could not realize media player");
        } // end catch
        catch (IOException iOException) {
            System.err.println("Error reading from the source");
        } // end catch
    } // end MediaPanel constructor
} // end class MediaPanel 
```

**参考**

*   [http://www.deitel.com/articles/java_tutorials/20060422/PlayingVideowithJMF/](http://www.deitel.com/articles/java_tutorials/20060422/PlayingVideowithJMF/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T20:04:51.690

我建议你看看[Xuggler](http://www.xuggle.com/xuggler)，因为我认为 JMF 不再被广泛使用。

我还会看看这个 Stack Overflow [Question/Answer](https://stackoverflow.com/questions/2041871/video-playback-in-java-jmf-fobs4jmf-xuggler-fmj)，因为它确实很好地回答了你的问题。

# c++ - 在 OpenGL 中绘制单个像素

> ID：14146249
> 
> 赞同：1
> 
> 时间：2013-01-03T19:58:06.597
> 
> 标签：c++, opengl

我正在尝试使用 OpenGL/C++ 突出显示（“颜色 #00FFFF”）图像中的特定单个像素（已经显示在背景中）。像素坐标和图像存在于精确的 2D 空间中，但到目前为止我在项目中看到的所有 OpenGL 代码 - `glTranslatef()`，`glScalef()`- 都是 3D 和基于浮点的，并且对象的定位似乎与它的时间分开发生画。

我习惯了 Java 的 Graphics2D 包，在那里我可以调用一些东西来达到以下效果

```
width = 1; height = 1;
buffer.drawRect(width, height, xPosition, yPosition); 
```

它会在指定位置填充一个像素。在 OpenGL 中是否有任何类似于该语法的东西——我可以在其中设置大小、设置位置并在一行中绘制所有内容？如果不是，我将如何将我的 2D+像素输入调整为 OpenGL 的浮点和 3D 结构？

我目前有这个：

```
glPushMatrix();
glTranslatef(0.0f, 0.0f, -5.0f);
glColor3f(0, 1, 1);
glPointSize(5.0f);
glBegin(GL_POINTS);
glVertex3f(1.0f, 1.0f, 1.0f);
glPopMatrix(); 
```

我从一些谷歌搜索和我的代码的其他部分拼凑而成，但我没有看到任何被绘制的东西。我不知道 translate、vertex 或 pointsize 命令的单位。如果我可以用上面的 Java 命令之类的东西来替换所有这些，那就太棒了。如果没有，有什么方法可以保证我在这里画的任何东西都“在”其他东西之上，但仍然不在相机后面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:19:48.090

> 在 OpenGL 中是否有任何类似于该语法的东西——我可以在其中设置大小、设置位置并在一行中绘制所有内容？

[`glRect()`](http://www.opengl.org/sdk/docs/man2/xhtml/glRect.xml)：

```
#include <GL/glut.h>

void display()
{
    glEnable( GL_CULL_FACE );
    glEnable( GL_BLEND );
    glBlendFunc( GL_SRC_ALPHA, GL_ONE );

    double w = glutGet( GLUT_WINDOW_WIDTH );
    double h = glutGet( GLUT_WINDOW_HEIGHT );

    glDepthMask( GL_TRUE );
    glClear( GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT );

    // draw teapot
    glEnable( GL_DEPTH_TEST );
    glDepthMask( GL_TRUE );

    glMatrixMode( GL_PROJECTION );
    glLoadIdentity();
    gluPerspective( 60, w / h, 1, 100 );

    glMatrixMode( GL_MODELVIEW );
    glLoadIdentity();
    glTranslatef( 0, 0, -5 );

    glColor4ub( 255, 0, 0, 255 );
    glPushMatrix(); 
    float angle = 60.0f * ( glutGet(GLUT_ELAPSED_TIME) / 1000.0f );
    glRotatef( angle, 0.1, 0.95, 0.05 );
    glutSolidTeapot( 1.0 );
    glPopMatrix();

    // draw rectangle
    glDisable( GL_DEPTH_TEST );
    glDepthMask( GL_FALSE );

    glMatrixMode( GL_PROJECTION );
    glLoadIdentity();
    glOrtho( 0, w, 0, h, -1, 1);

    glMatrixMode( GL_MODELVIEW );
    glLoadIdentity();

    glColor4ub( 0, 255, 0, 128 );
    glRecti( 0 + 50, 0 + 50, w - 50, h - 50 );

    glutSwapBuffers();
}

void timer( int extra )
{
    glutPostRedisplay();
    glutTimerFunc( 16, timer, 0 );
}

int main( int argc, char **argv )
{
    glutInit( &argc, argv );
    glutInitDisplayMode( GLUT_RGBA | GLUT_DEPTH | GLUT_DOUBLE );
    glutInitWindowSize( 640, 480 );
    glutCreateWindow( "Rect" );
    glutDisplayFunc( display );
    glutTimerFunc( 0, timer, 0 );
    glutMainLoop();
    return 0;
} 
```

# java - 在 Struts 2 中使用 ModelDriven 的 jQuery 插件 vs Dojo 插件

> ID：14146253
> 
> 赞同：2
> 
> 时间：2013-01-03T19:58:13.983
> 
> 标签：java, jsp, struts2, struts2-jquery, model-driven

我正在使用 Struts2`ModelDriven`来提交表单。

当我使用`datetimepicker`Dojo 的标签并从该标签中选择日期时，表单被正确提交，表单值填充在`ModelDriven`对象中。

但是，当`datepicker`jQuery 的标签被取入表单并选择日期时，其中的对象`ModelDriven`具有空值。

如果未选择日期并提交表单，则它可以正常工作。

我是否需要任何设置来解决问题？

[我已经为 JQuery 包含了以下 jar](http://code.google.com/p/struts2-jquery/downloads/)。

**查询：**

```
<sx:datepicker name="startDate" id="startDate" label="" cssStyle="width:275px; " 
minDate="0" displayFormat="dd/mm/y" changeMonth="true" changeYear="true" 
readonly="true" value="%{startDate}"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T21:04:59.670

删除`readonly="true"`，一切都会正常工作。

`readonly`属性 default to`false`告诉输入是否是只读的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T21:31:05.203

问题是 Dojo 将 JSP 上的日期值作为 Java 中的日期，而*JQuery*将其作为字符串。

因此，struts 正在寻找`setDate(String)`而不是`setDate(Date)`为*JQuery*寻找。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T20:31:39.517

我很确定

```
name="startDate" 
```

应该改为

```
name="yourmodel.startDate" 
```

显示更多代码以获得更好的帮助...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T21:03:53.357

Struts 期望将一个值作为独立于语言环境的值发送到服务器，符合[RFC3 339](https://www.rfc-editor.org/rfc/rfc3339#section-5.8) (yyyy-MM-dd'T'HH:mm:ss) 这是默认 dojo 标记（现已弃用）提供的：[http ://struts.apache.org/2.0.12/docs/datetimepicker.html](http://struts.apache.org/2.0.12/docs/datetimepicker.html)

您可以只发送：2013-01-03 其余是可选的。

我使用 mm/dd/yy 的 jQuery Datepicker。要将此格式更改为 struts2 期望的格式，要么更改用于演示的 defaultFormat，要么设置 altFormat 更改提交期间呈现的格式的输入（因此，如果您喜欢“mm/dd/yy”，您可以将 altFormat 设置为“yyyy- mm-dd”并获得所需的效果）。

[http://jqueryui.com/datepicker/#date-formats](http://jqueryui.com/datepicker/#date-formats)

[http://api.jqueryui.com/datepicker/](http://api.jqueryui.com/datepicker/)

正如您所看到的，jQuery 很容易为此提供了这一点，如何使用标签来做到这一点......我不知道。欢迎其他人获取此信息并将其扩展为另一个答案，如果可能，请使用特定于标签的技术。

# c++ - 为什么 malloc/new 捕获调用堆栈？

> ID：14146254
> 
> 赞同：3
> 
> 时间：2013-01-03T19:58:29.177
> 
> 标签：c++, windows, heap-memory, callstack, stack-unwinding

我有一个在 Server 2003 下作为服务运行的 64 位应用程序。

当我附加 VS Profiler 或 windbg 时，我看到很多调用堆栈，如下所示。我知道在调试器（或分析器）中生成的进程使用调试堆等......但情况并非如此，因为该服务是由操作系统启动的，我只是附加到它。

我不明白为什么它正在展开堆栈。分析器显示，在这方面花费了可衡量的时间。更多信息：

• 这些是使用 vc9 构建的版本位，在 Server 2003 上运行。

• 系统环境变量_NO_DEBUG_HEAP 设置为1。

• 我正在使用 Microsoft 符号服务器。

为什么要捕获堆栈跟踪？似乎它正在记录它..但我找不到在哪里。

我的目标是验证应用程序是否真的在展开堆栈，如果这是真的，尽量避免它。

有任何想法吗？

* * *

# 调用栈

```
ntdll!RtlVirtualUnwind
ntdll!RtlpWalkFrameChain
ntdll!RtlCaptureStackBackTrace
ntdll!RtlpCaptureStackTraceForLogging
ntdll!RtlLogStackBackTrace
ntdll!RtlDebugAllocateHeap
ntdll!RtlAllocateHeapSlowly
ntdll!RtlAllocateHeap
MSVCR90!malloc
MSVCR90!operator new 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-03T20:00:36.417

可能有人使用[gflags.exe](http://msdn.microsoft.com/en-us/library/windows/hardware/ff540107%28v=vs.85%29.aspx)来启用此进程或系统范围内的用户堆栈跟踪捕获，或其他需要跟踪 CRT 分配操作的标志。

您应该能够使用[此处](http://msdn.microsoft.com/en-us/library/windows/hardware/ff549577%28v=vs.85%29.aspx)的信息在注册表中检查这种可能性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-25T21:10:35.447

史蒂夫的回答很好，经过长时间的调查，最终为我们自己的服务器找到了解决方案。我们的情况略有不同，堆栈捕获的原因是由于脚本定期运行 UMDH 捕获。UMDH 将在第一次针对该进程执行时启用堆栈收集。它给出以下警告：

```
 UMDH has enabled allocation stack collection for the current running process. 
```

# events - 压倒一切的虚拟事件

> ID：14146255
> 
> 赞同：0
> 
> 时间：2013-01-03T19:58:35.713
> 
> 标签：events, inheritance, virtual

我有以下代码

```
public delegate void NotificacaoScanner(NotifScanner e);   

// interface
public interface IScanner
{
   event NotificacaoScanner onFinalLeitura;
}

// abstract class that implements the interface
public abstract class ScannerGCPerif : IScanner
{
   public virtual event NotificacaoScanner onFinalLeitura;
   {
     add { throw new NotImplementedException("Event not available for this service"); }
     remove { throw new NotImplementedException("Event not available for this service");          }
   } 
}

// concrete class that implements the abstract class
public class ScannerBurroughs : ScannerGCPerif
{
  public override event NotificacaoScanner onFinalLeitura;
} 
```

为什么我订阅`onFinalLeitura`一个`ScannerBurroughs`实例的事件时，它坚持执行基类（ScannerGCPerif）的事件声明，异常在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T20:54:53.163

我运行了您的代码，但没有出现异常。让我解释一下会发生什么：

您在具体类中覆盖事件，但不提供添加和删除事件处理程序的实现，因此编译器生成以下代码：

```
public class ScannerBurroughs : ScannerGCPerif
{
    private NotificacaoScanner _onFinalLeitura; // Declare a private delegate

    public override event NotificacaoScanner onFinalLeitura
    {
        add { _onFinalLeitura += value; }
        remove { _onFinalLeitura -= value; }
    }
} 
```

在幕后，它添加了一个私有委托并自动实现了添加/删除事件访问器。订阅时永远不会调用基本实现。尝试显式实现访问器，在代码中放置一些断点，看看会发生什么。

# scala - 如何安全地使用回复和！？在 Scala 演员上

> ID：14146259
> 
> 赞同：0
> 
> 时间：2013-01-03T19:58:48.477
> 
> 标签：scala, actor

依赖`reply`Scala Actor 对我来说似乎非常容易出错。这真的是在演员之间进行对话的惯用 Scala 方式吗？有没有替代方案，或更安全地使用`reply`我所缺少的？

（关于我：我熟悉 Java 中的同步，但我之前从未设计过基于 actor 的系统，也没有完全理解该范式。）

**示例错误**

作为一个简单的演示，让我们看看这个愚蠢的整数解析 Actor：

```
import actors._, Actor._

val a = actor {
  loop {
    react {
      case s: String => reply(s.toInt)
    }
  }
} 
```

我们可以打算将其用作

```
scala> a !? "42"
res0: Any = 42 
```

但是如果演员没有回复（在这种情况下，因为粗心的程序员没有想到要抓住`NumberFormatException`演员），我们将永远等待：

```
scala> a !? "f" 
```

我们在呼叫现场也犯了一个错误。下一个示例也无限期阻塞，因为参与者不回复`Int`消息：

```
scala> a !? 42 
```

**超时**

如果预期的回复有一些已知的合理时间限制，您可以使用`!? (msec: Long, msg: Any)`，但在我能想到的大多数情况下，情况并非如此。

**保证回复**

一种想法是设计该actor，使其必须回复每条消息：

```
import actors._, Actor._

val a = actor {
  loop {
    react {
      case m => reply { 
        try {
          m match {
            case s: String => reply(s.toInt)
            case _ => None
          }
        } catch {
          case e => e
        }
      }
    }
  }
} 
```

这样感觉好多了，虽然还是有点怕一不小心调用`!?`了一个演员不再演戏了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:17:50.630

我自己并不熟悉 Scala 标准库中的 Actor 系统，但我强烈建议您查看 Akka 工具包 ( [http://akka.io/](http://akka.io/) )，它已“替换”了 Scala Actors 并附带 Scala 发行版斯卡拉 2.10。

总体而言，在 Actor 系统设计方面，一些关键思想是异步（非阻塞）、隔离可变性和通过消息传递进行通信。每个 Actor 都封装了自己的状态，不允许其他任何人触摸它。您可以向 Actor 发送一条可能“要求”它更改状态的消息，但 Actor 实现可以随意忽略它。消息是异步发送的（你可以让它阻塞，不推荐）。如果您想要某种“响应”（以便您可以将消息与先前发送的消息关联），`Future`Scala 2.10 和`ask`Akka 中的 API 可以提供帮助。

关于您的错误格式异常和一般问题，请考虑查看 Scala 2.10 和 Akka 2.1 中的`ask`和`Future`API。它将处理异常并且是非阻塞的。

Scala 2.10 也有一个新`Try`的，旨在替代老式`try-catch`子句。`Try`有一个`apply`你会像任何一样使用的方法（`try`减去`catch`and `finally`）。`Try`有两个子类`Success`和`Failure`。的实例`Try[T]`将具有子类`Success[T]`和`Failure[Throwable]`. 通过示例更容易解释：

```
>>> val x: Try[Int] = Try { "5".toInt } // Success[Int] with encapsulated value 5
>>> val y: Try[Int] = Try { "foo".toInt } // Failure(java.lang.NumberFormatException: For input string: "foo") 
```

由于`Try`不会抛出实际异常并且子类是方便的案例类，因此您可以轻松地将结果用作给 Actor 的消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:19:19.990

我可以看到你的担忧，但我实际上认为这并不比你习惯的同步更糟糕。谁保证锁会再次被释放？

使用`!?`风险自负，所以没有我知道的“更安全”的用途。线程可以阻塞或死亡，我们绝对无能为力。除了提供可以减轻打击的安全阀。

基于事件的行为实际上为您提供了同步接收回复的替代方案。超时是其中之一，但另一件事，例如通过该方法的[Futures 。](http://www.scala-lang.org/api/current/index.html#scala.actors.Future)`!!`它们旨在处理诸如此类的死锁。该方法立即返回可以稍后处理的未来。

有关灵感和更深入的设计决策，请参阅：

演员： [http ://docs.scala-lang.org/overviews/core/actors.html](http://docs.scala-lang.org/overviews/core/actors.html)

期货（在 scala 2.10 中）： [http ://docs.scala-lang.org/sips/pending/futures-promises.html](http://docs.scala-lang.org/sips/pending/futures-promises.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:28:26.503

Don't bother with old local actors - learn `Akka`. Also it's good that you know about `synchronized`, but personally me - almost never use such a word, even in `Java` code. Imagine `synchronized` is deprecated, learn `Java` memory model, learn `CAS`.

# ruby - 使用 Proc 验证

> ID：14146260
> 
> 赞同：1
> 
> 时间：2013-01-03T19:58:57.850
> 
> 标签：ruby, ruby-on-rails-3

如果我删除 || 下面的声明将起作用。任何想法为什么？我希望它仅在“社交”和“新闻”以外的类别上进行验证

```
 validates :image, presence: true, if: Proc.new { |a| a.category != "social" || a.category != "news" } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:05:52.613

要验证不是“社交”和“新闻”的类别，您需要

`validates :image, presence: true, if: Proc.new { |a| a.category != "social" && a.category != "news" }`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T22:31:25.297

SeanLi 给了你一个正确的修改，但请允许我补充一些更深层次的逻辑理解。

[对德摩根定律](http://en.wikipedia.org/wiki/De_Morgan%27s_laws)的快速研究可能会消除这里的困惑。这些是在连词 (AND) 和析取 (OR) 上分配否定 (NOT) 的规则。使用 Ruby 语法：

“既不`p`也不`q`”可以等价地写为要么`!(p || q)`或`!p && !q`。

同时，“Not both `p`and `q`” / “Either `not-p`or `not-q`” 可以等价地写为 any `!(p && q)`or `!p || !q`。

然而，正如他们的英文翻译清楚地表明，第一对意味着不同的东西（在逻辑上与第二对不同）。

冒着对显而易见的事情进行描述的风险，这个事实可以通过识别 和 的等价性应用于您的`!(p == q)`案例`p != q`。

# bash - bash中退出代码为零时如何处理错误

> ID：14146262
> 
> 赞同：1
> 
> 时间：2013-01-03T19:59:08.610
> 
> 标签：bash, shell, colors, terminal, pygments

我有以下脚本`~/bin/cat`，`pygmentize`如果不只是常规的 old ，则尽可能显示语法高亮文件`cat`。

```
#!/bin/bash

for var; do 
    pygmentize "$var" 2> /dev/null

    if [ $? -ne 0 ]; then 
        /bin/cat "$var"
    fi
done 
```

这在我的工作机器上运行良好，但在我的家用机器上却不行。在家里，如果`pygmentize`无法识别文件，它会显示相同的错误消息，但退出状态为 0，而在工作时它返回 1，这会破坏脚本。唯一的区别是我在工作中运行 Fedora 和在家里运行 Ubuntu。

```
$ pygmentize testfile
Error: no lexer for filename 'testfile' found

$ echo $?
0

$ file testfile
file: ASCII text 
```

这很奇怪，因为两者都是相同的版本

```
$ pygmentize -V
Pygments version 1.4, (c) 2006-2008 by Georg Brandl. 
```

我可以进去，`grep`但是如何在不扔掉的情况下做到这一点，我应该如何处理？`Error``stderr``stdout`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:04:24.937

好吧，您最好的方法是修复`pygmentize`以正确返回错误代码。正如 Ignacio Vazquez-Abrams 所提到的，其中一个发行版有一个补丁可以导致或修复此问题。

但是，这里是如何解决它：

## 如果错误消息在 stderr

最简单的方法可能是将 stderr 重定向到一个临时文件，并且不理会 stdout：

```
pygmentize "$var" 2> "$tmpfile" 
```

然后你可以 grep `"$tmpfile"`。还有其他方法，但它们[更复杂](https://stackoverflow.com/questions/3618078/pipe-only-stderr-through-a-filter)。

## 如果错误消息在标准输出上

是的，那将是 pygmentize 中的另一个错误，它应该在 stderr 上。但是，临时文件将再次起作用。如果可以，只需`cat`将临时文件返回到标准输出。或者，您可以使用`tee`将标准输出复制到多个目的地。

# soa - 企业集成模式解决方案绘图工具

> ID：14146266
> 
> 赞同：6
> 
> 时间：2013-01-03T19:59:20.240
> 
> 标签：soa, apache-camel, esb, enterprise-integration

我想知道是否有任何绘图工具可用于根据 EIP 映射给定的用例解决方案。有一个可用于 MS Visio 的模板和一个用于 OpenOffice 的 SVG 替代品。模具中的形状很好，但似乎不是演示的最佳图形。绘制 EIP 的任何替代方案？提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-08-16T14:05:10.430

[diagrams.net](https://app.diagrams.net/?splash=0&libs=eip)内置了一组 EIP 模板。我不确定它是否解决了问题中的问题，但该工具是[免费](https://github.com/jgraph/drawio)的。（我是该项目的开发人员）。

[ ![在 draw.io 中设置的 EIP 模板](../Images/5650bd410c899b81d9675b766256c025.png)]

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-05T15:54:19.763

顺便说一句，你可以自动化。检查这个：

[http://camel.apache.org/visualisation.html](http://camel.apache.org/visualisation.html)

使用 camel:dot maven 目标

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-11T09:54:09.860

几年前，我为 Spring Integration in Action 一书创建了 OmniGraffle EIP 模板。我把它推到了 Graffletopia，但我无法很快找到它。如果您对 OmniGraffle 模板感兴趣，请告诉我，我会进行更多搜索。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-05T08:42:47.423

模具有什么问题？这些只是企业集成模式一书中介绍的形状。查看本书作者的演示文稿，我认为这些形状在演示文稿中看起来不错：[http](http://www.eaipatterns.com/docs/jaoo_hohpeg_enterpriseintegrationpatterns.pdf) ://www.eaipatterns.com/docs/jaoo_hohpeg_enterpriseintegrationpatterns.pdf 。

除了 Visio、Open Office Draw 或类似工具之外，我不知道有任何工具可以绘制 EIP 场景。有一些 IDE 可以创建路由（例如 Fuse IDE 和 Talend Open Studio），但这些实际上只是为了创建可运行的 EIP 实现，而不是用于演示。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-16T14:34:18.043

迟到了，但[Lucidchart](http://www.lucidchart.com/)（基于云的在线图表工具）也有一个企业集成模式模板。

# web-applications - 未引发 applicationCache 事件

> ID：14146267
> 
> 赞同：3
> 
> 时间：2013-01-03T19:59:22.047
> 
> 标签：web-applications, application-cache

在 Chrome 中，捕获 applicationCache 事件有效（见下文），但在 FireFox 17 中无效（尽管我从信息中看到，在允许 appCache 填充后，其中有 1.7MB）。所以它正在工作，但我没有得到这个事件。为什么？（此代码位于加载的第一个 .JS 文件中）。

```
function onUpdateReady() {
    window.applicationCache.swapCache();
    if (confirm('A new version of this site is available. Load it?')) {
        window.location.reload();
    }
}
window.applicationCache.addEventListener('updateready', onUpdateReady);
if (window.applicationCache.status === window.applicationCache.UPDATEREADY) {
    onUpdateReady();
} 
```

顺便说一句，我希望 FireBug 在我使用 Chrome 工具时拥有的 appCache、IndexDB 上的那些整洁的资源选项卡信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-28T21:39:17.340

据我所知，该事件确实被触发了，但是当您调用 swapCache 时会出现错误，这会阻止完成代码块。你可以通过使用 try-catch 来解决这个错误

```
 window.applicationCache.addEventListener('updateready', function() {
  try {window.applicationCache.swapCache();}
  catch(error) {
    console.log(error.code);
  }
  if (confirm('A new version of this site is available. Load it?')) {
    window.location.reload();
  }
}, false); 
```

那么一切都会按预期进行。

# linq - 将 Linq 查询结果返回到 List 对象（基于条件）

> ID：14146279
> 
> 赞同：0
> 
> 时间：2013-01-03T20:00:09.333
> 
> 标签：linq

我需要根据外键值将多个 Linq 查询结果返回到 List 对象中。这样做的语法是什么？我是使用 Linq 的新手，所以下面是我迄今为止最好的猜测。我在 .Where()“子句”中收到一个错误，指出“名称 'pt' 在当前上下文中不存在。任何帮助将不胜感激！

```
 List<AgentProductTraining> productTraining = new List<AgentProductTraining>();

        var prodCodes = productTraining.Select(pt => new[]
                                                         {
                                                             pt.ProductCode,
                                                             pt.NoteId,
                                                             pt.ControlId
                                                         })
                                                         .Where(pt.CourseCode == course.CourseCode); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:03:19.583

您需要切换 where 的位置并选择是否使用扩展方法：

```
var prodCodes = productTraining.Where(pt => pt.CourseCode == course.CourseCode)
                               .Select(pt => new SomeRandomType
                                                         {
                                                             ProductCode = pt.ProductCode,
                                                             NoteId = pt.NoteId,
                                                             ControlId = pt.ControlId
                                                         }); 
```

正如您在上面看到的，我还建议您为该 select 语句创建一个类型，以便您不依赖匿名类型。你应该放入一个你知道一切的对象类型。

此外，如果 CourseCode 是一个字符串，那应该是`pt.CourseCode.Equals(course.CourseCode)`.

# c - 重构遗留 C 代码 - 使用外部声明来帮助拆分模块（潜在的链接和运行时问题）

> ID：14146280
> 
> 赞同：4
> 
> 时间：2013-01-03T20:00:09.583
> 
> 标签：c, linker, refactoring, runtime

我正在重构一些用 C 编写的旧遗留代码。这些代码耦合非常紧密，我正在努力将其重构为清晰的逻辑、松散耦合的模块。

在我早期的迭代中，我设法确定了逻辑模块 - 但是紧密耦合给我带来了问题，因为许多功能都对系统的其他部分有深入的了解。

我打算解决这个问题的方法是使用 extern 声明。希望下面的伪代码解释了这种情况：

假设我有两个逻辑上独立的模块 Foo 和 FooBar。每个模块都将被构建到一个单独的库中（FooBar 模块依赖于 Foo 模块）。

```
/*######################################*/
/*             Foo Module               */
/*######################################*/
/*  Foo.h */
#ifndef FOO_MODULE_H
#define FOO_MODULE_H

void foo(int id);
int do_something();
...

#endif /* FOO_MODULE_H */

/* Foo.c */
#include "Foo.h"
extern int foobar();  /* defined in FooBar module (a separate library) */

void foo(int id){
    int var;

    switch (id){
        case 1:
            var = do_something();
            break;

        case 2:
            /* the module that gets here, has the required functions defined in it */
            var = foobar();
    }

    return var;
}

/*###############################*/
/*        FOOBar module          */
/*###############################*/

/* FooBar.h */

#ifndef FOOBAR_MODULE_H
#define FOOBAR_MODULE_H

#include "Foo.h"

int foobar();
void do_something_else();
...

#endif /* FOOBAR_MODULE_H */

/* source file */
int foobar(){
    return 42;
}

void do_something_else(){
   int ret = foo(2);
   printf("Function returned: %d", ret);
} 
```

这是将现有代码重构为逻辑上独立的模块同时允许链接到 libfoo.so 和 libfoobar.so 的可执行文件继续正常工作的有效方法吗？

我的基本假设是，仅链接到 libfoo.so 的模块将无法解析`foobar()`- 但这应该没问题，因为它们不需要该函数，因此它们永远不必调用它。另一方面，对于链接到 libfoobar.so 的模块，当它们调用时`foo()`，`foobar() 将被解析（函数定义在模块中）。

我上面描述的方案会按我的预期工作，还是有一些我遗漏的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T00:07:18.927

我尝试将您的文件编译成共享库，然后使用它们（我使用 cygwin）。

这是Foo：

```
cm@Gregor-PC ~/src
$ gcc -I. -c --shared -o libFoo.so Foo.c 
```

使用 bin util nm 您可以检查符号（grep for 'foo' 以限制输出）

```
cm@Gregor-PC ~/src
$ nm libFoo.so | grep foo
0000000a T _foo
         U _foobar 
```

它给出了一个偏移量并说“T”表示终止，告诉你符号是在库中定义的。

现在 FooBar 库必须与 Foo 链接才能获得 foo 符号

```
cm@Gregor-PC ~/src
$ gcc -I. -L. --shared -o libFooBar.so FooBar.c libFoo.so

cm@Gregor-PC ~/src
$ nm libFooBar.so | grep foo
61f0111e T _foo
61f010e0 T _foobar 
```

有了这个，我只能针对 FooBar 进行编译并将 foo 作为已知符号：

```
cm@Gregor-PC ~/src
$ gcc -I. -o tst1 tst1.c libFooBar.so
cm@Gregor-PC ~/src
$ ./tst1
Function returned: 42 
```

所以它似乎工作正常。

您可以通过使用仅包含公共数据类型、导出函数原型（声明为 extern）甚至公共全局变量或常量的头文件来改进模块化 C 代码的方法。这样的头文件声明了模块的接口，并且必须包含在使用模块的地方。

这在模块章节中的精彩书籍[“Functional C”](https://rads.stackoverflow.com/amzn/click/com/0201419505)（Hartel，Muller，1997，Addison Wesley，[链接](http://eprints.eemcs.utwente.nl/1077/02/book.pdf)）中有更详细的解释。

好处是您的依赖项更清晰可见（如源文件中包含的那样），并且您不必在 Foo 源代码中使用那种难看的 extern 声明。

对于您的示例：

```
/*  Foo.h */
extern int foo(int id); /* exported to FooBar */

/* FooBar.h */

extern int foobar(); /* export to Foo */
extern void do_something_else(); /* export to tst1 */

/* Foo.c */
#include <Foo.h>
#include <FooBar.h>

int do_something() {
  return 11;
}

int foo(int id){
    int var;

    switch (id){
        case 1:
            var = do_something();
            break;

        case 2:
            /* the module that gets here, has the required functions defined in it */
            var = foobar();
    }

    return var;
}

/* FooBar.c */

#include <stdio.h>
#include <Foo.h>
#include <FooBar.h>

int foobar(){
    return 42;
}

void do_something_else(){
   int ret = foo(2);
   printf("Function returned: %d", ret);
} 
```

# javascript - ExtJs，防止图像在 Ext.Img 中拉伸

> ID：14146289
> 
> 赞同：3
> 
> 时间：2013-01-03T20:00:43.903
> 
> 标签：javascript, html, image, extjs, extjs4

我不确定这是否可以做到，但是在 ExtJS 中，是否可以在`Ext.Img`组件中防止图像拉伸到组件的大小，而是让它保持其比例？为了不让它看起来很紧张？

让我尝试通过研究来澄清这一点，如果在 HTML 中我做这样的事情

```
<img src=# /> 
```

图像没有改变，只是我需要的大小，如果在 ExtJs 我做这样的事情

```
 xtype:'image',
    id: 'south_image',
    src: '#',
    region: 'south',
    width: 700,
    height: 200 
```

然后图像被拉伸了，有没有办法，假设它`Ext.Img`比图像大，我如何让图像保持它的自然大小，就像在 HTML 中一样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-04T19:13:18.873

所以我能够找到答案，我必须把 an 的`Ext.Img`内部`Ext.container.Container`，大小将在容器内指定，而 的大小`Ext.Img`将留空：

```
 xtype: 'container',
    region: 'south',
    width: 700,
    height: 200,
    autoScroll: true,
    items: [{
        xtype:'image',
        id: 'south_image',
        src: '#',
        region: 'south',
        autoScroll: true
    }] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T20:21:08.157

是的.. 设置`maxHeight`and`maxWidth`的`Ext.Img`

文档[在这里](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.AbstractComponent-cfg-maxHeight)

# android - resolveUri 在应用程序私有数据文件上失败

> ID：14146291
> 
> 赞同：2
> 
> 时间：2013-01-03T20:00:52.500
> 
> 标签：android, file-io, android-appwidget, remoteview

当我的应用程序首次运行时，我会生成一堆图像文件，然后稍后尝试使用 remoteViews.setImageViewUri() 将这些图像放入我的 ImageViews 中。但是，当我运行我看到的应用程序时

> 01-03 15:05:11.252：W/ImageView(137)：无法打开内容：file:///data/data/com.nickavv.cleanwidgets/files/batt_s_19.png 01-03 15:05:11.252： W/ImageView（137）：java.io.FileNotFoundException：/data/data/com.nickavv.cleanwidgets/files/batt_s_19.png（权限被拒绝）

由于文件是由这个应用程序创建的，我应该有权从这个应用程序中访问它，对吧？这是我用来检索它的代码：

```
 File file = new File(context.getFilesDir().getPath(), idName+".png");
   Uri newUri = Uri.fromFile(file);
   myViews.setImageViewUri(id, newUri); 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:57:00.627

而不是使用`Uri.parse`，使用`Uri.fromfile`。

```
Uri newUri = Uri.fromFile(file); 
```

# asp.net-mvc - MVC 3 Url Helper 提供不正确的 URL

> ID：14146295
> 
> 赞同：3
> 
> 时间：2013-01-03T20:01:02.343
> 
> 标签：asp.net-mvc, asp.net-mvc-3, urlhelper, tivoli-identity-manager

我正在为公司 Intranet 站点开发 MVC 3 应用程序，但我遇到了一些 URL 帮助程序问题，有时无法生成正确的 URL。该应用程序是通过由我们的 IT 部门控制的访问管理器应用程序访问的，该应用程序基本上提供了一个标准化的 URL，因此用户不需要知道有关服务器的任何信息。例如，要直接在服务器上访问应用程序，我会访问：

```
http://philsserver/App 
```

通过访问管理器，我将使用 IT 部门提供的 URL：

```
http://secureintranet/PHILSAPP/App/ 
```

我在我的应用程序的几个地方使用 MVC URL 帮助程序 - 问题是有时“PHILSAPP”部分被遗漏了 - 当我在“ `<a>`”链接中使用它时，它可以工作，但是当我在其他地方使用它时，它才不是。

例如，代码：

```
<a href="@Url.Action("Index", "FormsAndTemplates")"> 
```

正确创建链接为：

`<a href="/PHILSAPP/App/FormsAndTemplates">`.

以下代码：

```
@Html.TextBox("lastName", ViewBag.LastName as string, new { @class = "input-mini", @autocomplete = Url.Action("QuickSearch", "Employee") }) 
```

产生：

```
<input autocomplete="/App/Employee/QuickSearch" class="input-mini" id="lastName" name="lastName" type="text" value="" /> 
```

请注意，此 URL 不包含“PHILSAPP”部分。如果我在 javascript 中使用 URL 帮助程序，或者除了“ `<a>`”标签之外的任何地方，也会发生这种情况。有谁知道为什么会这样？据我所知，对 Url.Action 的两个调用几乎相同，因此我无法弄清楚为什么会发生这种情况。如果这个问题已经得到解答，我深表歉意，但我无法找到任何有关有类似问题的人的信息。提前感谢您的任何帮助。

更新：根据要求，我的路线如下：

```
routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

routes.MapRoute(
    "Default", // Route name
    "{controller}/{action}/{id}", // URL with parameters
    new { controller = "Home", action = "Index", id = UrlParameter.Optional }); 
```

更新 2：正在使用的访问管理器是 Tivoli Identity Manager，如果这给任何人任何线索的话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T20:44:10.433

正如 nemesv 上面指出的那样，答案是该`Url.Action`方法始终将 URL 生成为 /App/... 但访问管理器应用程序会识别某些标签（例如`<a href="/App/...">`、`<form action="/App/...">`等）并将 /PHILSAPP 添加到开头. 我正在探索的解决方案是编写一些扩展方法`UrlHelper`并`HtmlHelper`生成绝对 URL，而不是相对 URL，其中将在 web.config 文件中指定包含 /PHILSAPP 的主机名。如果有人仍然有任何其他建议来解决这个问题，我会很高兴听到他们的声音，但除此之外，我对使用它作为解决方法感到满意。

一些样板代码开始：

```
namespace MvcApplicationNameSpace
{
    /// <summary>
    /// Extension methods to the UrlHelper class for generating absolute URLs using
    /// Web.config settings
    /// </summary>
    public static class UrlHelperExtensions
    {
        private static string BaseUrl
        {
            get
            {
                return System.Configuration.ConfigurationManager.AppSettings["BaseUrl"];
            }
        }

        /// <summary>
        /// Generates a string for the absolute URL to an action method
        /// </summary>
        /// <param name="url"></param>
        /// <returns></returns>
        public static string AbsoluteAction(this UrlHelper url)
        {
            return BaseUrl + url.Action();
        }

        /// <summary>
        /// Generates a string for the absolute URL to an action method with the
        /// specified name
        /// </summary>
        /// <param name="url"></param>
        /// <param name="actionName"></param>
        /// <returns></returns>
        public static string AbsoluteAction(this UrlHelper url, string actionName)
        {
            return BaseUrl + url.Action(actionName);
        }

        /// <summary>
        /// Generates a string for the absolute URL to an action method with the
        /// specified name and route values
        /// </summary>
        /// <param name="url"></param>
        /// <param name="actionName"></param>
        /// <param name="routeValues"></param>
        /// <returns></returns>
        public static string AbsoluteAction(this UrlHelper url, string actionName, object routeValues)
        {
            return BaseUrl + url.Action(actionName, routeValues);
        }

        /// <summary>
        /// Generates a string for the absolute URL to an action method with the
        /// specified name and route values
        /// </summary>
        /// <param name="url"></param>
        /// <param name="actionName"></param>
        /// <param name="routeValues"></param>
        /// <returns></returns>
        public static string AbsoluteAction(this UrlHelper url, string actionName, RouteValueDictionary routeValues)
        {
            return BaseUrl + url.Action(actionName, routeValues);
        }

        /// <summary>
        /// Generates a string for the absolute URL to an action method and
        /// controller
        /// </summary>
        /// <param name="url"></param>
        /// <param name="actionName"></param>
        /// <param name="controllerName"></param>
        /// <returns></returns>
        public static string AbsoluteAction(this UrlHelper url, string actionName, string controllerName)
        {
            return BaseUrl + url.Action(actionName, controllerName);
        }

        /// <summary>
        /// Generates a string for the absolute URL to an action method and
        /// controller, including route values
        /// </summary>
        /// <param name="url"></param>
        /// <param name="actionName"></param>
        /// <param name="controllerName"></param>
        /// <param name="routeValues"></param>
        /// <returns></returns>
        public static string AbsoluteAction(this UrlHelper url, string actionName, string controllerName, object routeValues)
        {
            return BaseUrl + url.Action(actionName, controllerName, routeValues);
        }

        /// <summary>
        /// Generates a string for the absolute URL to an action method and
        /// controller, including route values
        /// </summary>
        /// <param name="url"></param>
        /// <param name="actionName"></param>
        /// <param name="controllerName"></param>
        /// <param name="routeValues"></param>
        /// <returns></returns>
        public static string AbsoluteAction(this UrlHelper url, string actionName, string controllerName, RouteValueDictionary routeValues)
        {
            return BaseUrl + url.Action(actionName, controllerName, routeValues);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-04T17:00:41.363

我们的安全入口服务器背后也有同样的问题。对于 REST 调用，我们希望在服务器端生成 url 以使其在 java 脚本中可用。但它们不包括安全入口服务器添加的子路径。

所以我们想出了一个这样的解决方法（在布局页面中呈现）：

```
<a id="urlBase" href="/" style="display: none;"></a>
<script type="text/javascript">
    baseUrl = document.getElementById('urlBase').getAttribute('href');
</script> 
```

`href="/"`已经被入口服务器替换为`href="/path/"`，我们可以在访问 REST 服务时轻松地`baseUrl`与我们的相对路径连接。

希望它对你的情况也有帮助。

# json - 如何从 Ruby 中的 JSON 中获取特定字段

> ID：14146297
> 
> 赞同：3
> 
> 时间：2013-01-03T20:01:06.140
> 
> 标签：json, ruby, jq

我需要在 Ruby 中实现一个简单的 shell 实用程序，它从文件中解析 JSON 并从中返回一个特定的字段。

要解析的 JSON 示例：

```
{"status": "fail", "messages": ["Out of capacity"]}

{"status": "success", "messages": [], "result": {"node": {"ip": "1.2.3.4", "description": "", "id": 974, "name": "VM#3"}}} 
```

想法是创建一个带有两个参数的 CLI 实用程序：要读取的 JSON 文件和要提取的 JSON 字段：

```
./get_json_field.rb ~/tmp.XXXXXX 'result.node.ip'
./get_json_field.rb ~/tmp.XXXXXX 'messages.0' 
```

我正在努力如何将第二个参数映射到 Ruby 中解析的 JSON 数据结构。我可以肯定地编写一个迭代器，使用点作为分隔符将字符串拆分为一个数组，然后逐项遍历它，但这看起来不像是优雅的解决方案。

对更优雅的方式有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:14:07.950

拆分字符串并遍历其中的一部分并没有错：

```
require 'json'

data1 = JSON.load('{"status": "fail", "messages": ["Out of capacity"]}')
data2 = JSON.load('{"status": "success", "messages": [], "result": {"node": {"ip": "1.2.3.4", "description": "", "id": 974, "name": "VM#3"}}}')

def get_from_json(data, query)
  query.split('.').inject(data) do |memo, key|
    key = key.to_i if memo.is_a? Array
    memo.fetch(key)
  end
end

get_from_json(data1, 'messages.0')        # => "Out of capacity"
get_from_json(data2, 'result.node.ip')    # => "1.2.3.4" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:27:24.370

看看`jq`它可能已经做了你正在寻找的东西。

```
jq .messages[0]
jq .node.message.ip 
```

见[http://stedolan.github.com/jq/](http://stedolan.github.com/jq/)

# c++ - 删除 my_object 时究竟会发生什么；被执行？所有其他内存是否由 sizeof(MyClass) 向左移动？

> ID：14146298
> 
> 赞同：5
> 
> 时间：2013-01-03T20:01:08.180
> 
> 标签：c++, c, memory, low-level

为了这个问题，我将把内存想象成一个简单的字节数组，我将谈论堆内存，因为它可以动态分配。

假设我正在实例化某个类，并在已经分配了一些内存的堆上创建一个对象。然后，在创建对象之后，我分配了更多内存（可能通过实例化另一个类）。当然，这意味着使用`new`and`delete`关键字。

内存现在看起来像这样：

`... byte byte my_object ... my_object byte byte ...`

执行时究竟会发生什么`delete my_object;`？所有其他内存都向左移动了`sizeof(MyClass)`吗？如果是这样，由谁？操作系统？那么当没有操作系统提供虚拟内存时会发生什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T20:03:01.467

不，没有任何变化。相反，内存变得[*碎片化*](https://stackoverflow.com/questions/3770457/what-is-memory-fragmentation)，这意味着您现在在已用内存中间有一个未使用的洞。随后的分配可能能够重新使用部分或全部该内存（前提是请求的字节数足够小以适合该孔）。

一些语言/环境支持压缩垃圾收集器。这样的收集器可以移动物体，因此如果他们愿意，可以消除孔洞。这种方法实现起来很复杂，因为收集器需要知道程序中每个指针的位置。因此，这种类型的收集器更适合高级语言。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T20:03:20.057

如果内存被转移，那将是一个非常糟糕的操作系统 IMO。通常，会通知操作系统该内存可用于重用。它甚至不需要被清除（大部分时间都不需要）。当无法分配更多内存时，您通常会收到异常（如果您正在使用`new`）或返回 NULL 指针（如果您正在使用`malloc`）。

如果碎片是一个问题（有时是），~~你必须编写自己的内存池~~您可以使用（现有的）内存池来处理这个问题，但即便如此，大部分责任仍然落在程序员身上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-03T20:05:01.070

内存不会向左移动。想象一下如果是的话会发生什么。所有那些“在右边”的指针都将变得无效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-03T20:04:04.860

~~在典型的实现中（例如，没有移动垃圾收集器）~~不会移动任何内容。

Bames53 说 Herb Sutter 说标准规定分配对象的自动移动是非法的。谢谢 Bames53。

# sublimetext2 - 如何在 sublime 文本中设置相同的 tabsize 宽度和 4 个空格？

> ID：14146299
> 
> 赞同：2
> 
> 时间：2013-01-03T20:01:10.957
> 
> 标签：sublimetext2

如何在 sublime 文本中设置相同的 tabsize 宽度和 4 个空格？
我喜欢 verdana 字体，然后我将字体设置为崇高的文本，但似乎 1 选项卡比 4 空间宽得多。为什么？怎么修？

![在此处输入图像描述](../Images/365223d7f316f9aee9695101af5d6c01.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-05T08:30:47.950

可能，这是一个与 Sublime 如何处理 tabsize 相关的问题。

它似乎使用 em-dash (-) 的大小，而不是空格的大小。当然，在等宽字体中，这些大小是相同的，但在比例字体中，例如 Verdana，它们是完全不同的：

" " (4 个空格)

“————”（4 个破折号）

所以，我认为解决问题的唯一方法是将制表符转换为空格`View/Indentation/Convert Indentation to Spaces`。并确保`"translate_tabs_to_spaces": true`在您的偏好和菜单中`Indent Using Spaces`设置：`Indentation`

![在此处输入图像描述](../Images/71e76d49a2461c98b62df85755c494a0.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T00:46:48.820

您作为屏幕截图包含的特定文件会强制自己使用制表符而不是空格，因此这可能就是它看起来太大的空间的原因。即使您`"translate_tabs_to_spaces": true,`在用户设置中进行了设置，这也不会应用于设置文件本身。

您可以通过打开首选项来确保您看到的实际上是空格/制表符`draw_white_space`。您可以通过编辑您的用户设置（首选项 -> 设置 -> 用户）并添加该行`"draw_white_space": "selection",`（如果这是您的设置的最后一行，请记住不要包含逗号）来执行此操作。

该值可以设置为“none”以关闭绘制空白，“selection”仅绘制选区中的空白，“all”绘制所有空白。

如果你这样做了，然后重新启动 Sublime Text 2，它可能会让你对正在发生的事情有一个很好的了解。

# c++ - 内联 ASM 的非常规调用

> ID：14146303
> 
> 赞同：6
> 
> 时间：2013-01-03T20:01:37.943
> 
> 标签：c++, c, embedded, clang, inline-assembly

我正在使用具有内置金属库（掩模 ROM）的专有 MCU。我使用的编译器是 clang，它使用类似 GCC 的内联 ASM。我遇到的问题是调用库，因为库没有一致的调用约定。虽然我找到了一个解决方案，但我发现在某些情况下，编译器会在调用之前立即对寄存器进行优化，我认为我做事的方式有问题。这是我正在使用的代码：

```
int EchoByte()
{
    register int asmHex __asm__ ("R1") = Hex;
    asm volatile("//Assert Input to R1 for MASKROM_EchoByte"
            :
            :"r"(asmHex)
            :"%R1");
    ((volatile void (*)(void))(MASKROM_EchoByte))(); //MASKROM_EchoByte is a 16-bit integer with the memory location of the function
} 
```

现在这有一个明显的问题，虽然变量“asmHex”被断言为寄存器 R1，但实际调用不使用它，因此编译器“不知道”R1 在调用时被保留。我使用以下代码来消除这种情况：

```
int EchoByte()
{
    register int asmHex __asm__ ("R1") = Hex;
    asm volatile("//Assert Input to R1 for MASKROM_EchoByte"
            :
            :"r"(asmHex)
            :"%R1");
    ((volatile void (*)(void))(MASKROM_EchoByte))();
    asm volatile("//Assert Input to R1 for MASKROM_EchoByte"
            :
            :"r"(asmHex)
            :"%R1");
} 
```

这对我来说似乎真的很难看，应该有更好的方法。另外我担心编译器可能会在两者之间做一些废话，因为调用本身没有表明它需要 asmHex 变量。不幸的是， ((volatile void (*)(int))(MASKROM_EchoByte))(asmHex) 不起作用，因为它将遵循 C 约定，将参数放入 R2+ （R1 保留用于刮擦）

请注意，不幸的是，更改 Mask ROM 库是不可能的，并且有太多常用例程无法在 C/C++ 中重新创建它们。

干杯，谢谢。

编辑：我应该注意，虽然我可以在 ASM 块中调用该函数，但编译器对无调用函数进行了优化，并且通过在汇编中调用它看起来好像没有调用。如果有某种方式表明内联 ASM 包含函数调用，我可以走这条路线，但否则返回地址可能会被破坏。在任何情况下，我都无法找到一种方法来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-19T00:10:48.970

根据上面的评论：

最传统的答案是您应该在程序集中（在`.s`文件中）实现一个存根函数，它只是为您执行古怪的调用。在 ARM 中，这看起来像

```
// void EchoByte(int hex);

_EchoByte:
    push {lr}
    mov  r1, r0       // move our first parameter into r1
    bl   _MASKROM_EchoByte
    pop  pc 
```

每个 mask-ROM 例程实现这些存根之一，就完成了。

那是什么？您有 500 个 mask-ROM 例程并且不想剪切和粘贴这么多代码？然后添加一个间接级别：

```
// typedef void MASKROM_Routine(int r1, ...);
// void GeneralPurposeStub(MASKROM_Routine *f, int arg, ...);

_GeneralPurposeStub:
    bx   r0 
```

使用语法调用此存根`GeneralPurposeStub(&MASKROM_EchoByte, hex)`。它适用于任何需要`r1`. 任何*真正*古怪的入口点仍然需要他们自己的手工编码的汇编存根。

但是如果你真的，真的，*真的*必须通过 C 函数中的内联汇编来做到这一点，那么（正如@JasonD 指出的那样）你需要做的就是将链接寄存器添加`lr`到 clobber 列表中。

```
void EchoByte(int hex)
{
    register int r1 asm("r1") = hex;
    asm volatile(
        "bl  _MASKROM_EchoByte"
        :
        : "r"(r1)
        : "r1", "lr"   // Compare the codegen with and without this "lr"!
    );
} 
```

# symfony - twig/Symfony2 中强制和非强制查找的区别

> ID：14146308
> 
> 赞同：1
> 
> 时间：2013-01-03T20:02:10.957
> 
> 标签：symfony, twig

在 Symfony2 的入门之旅中，我遇到了这个：

```
 {# array('user' => array('name' => 'Fabien')) #}
{{ user.name }}

{# force array lookup #}
{{ user['name'] }}

{# array('user' => new User('Fabien')) #}
{{ user.name }}
{{ user.getName }}

{# force method name lookup #}
{{ user.name() }}
{{ user.getName() }} 
```

有人可以解释我的区别吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:07:05.450

在 twig 中，当您刚刚使用 时`foo.bar`，`foo`可能是一个数组（在这种情况下，twig 需要一个 key `bar`）或一个对象，而它需要一个可访问的 property `bar`、一个 methods `getBar()`，我猜我忘记了一些东西。然而，关键是，twig 试图解决访问本身的类型，你可以随心所欲地投入（除此之外，它显然必须以结构化数据的形式）。如果您使用特定的访问方法，则可以从 twig 中猜测：当您调用`foo.bar()`它时，显然是一种方法。（必须说，我从未听说过“强制查找”：X）

# jquery-ui - 手风琴事件未触发

> ID：14146309
> 
> 赞同：4
> 
> 时间：2013-01-03T20:02:12.853
> 
> 标签：jquery-ui, accordion

我有应该在 'activate' 和 'beforeActivate' 事件上触发的警报。这些都不会发生。

Javascript

```
$(function () {
  $(".accordion").accordion({
    collapsible: false,
    active: true,
    activate: function (event, ui) { alert("activate"); },
    beforeActivate: function (event, ui) { alert("before activate"); }
  });
}); 
```

html

```
<div>
  <ul>
    <li>0</li>
    <div class="accordion">
        <li>
            <h3><a href="#">First</a></h3>
            <div>
                <ul>
                    <li>1</li>
                    <li>2</li>
                </ul>
            </div>
        </li>
        <li>
            <h3><a href="#">Second</a></h3>
            <div>
                <ul>
                    <li>3</li>
                    <li>4</li>
                </ul>
            </div>
        </li>
    </div>
  </ul>
</div> 
```

我知道我在 ul 一侧嵌套 div 中的 html 不正确。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-24T14:58:26.007

如果您使用的是 1.8，那么您希望使用`change`and`changestart`作为事件：

```
$( ".selector" ).accordion({
    change: function( event, ui ) {}
}); 
```

[http://api.jqueryui.com/1.8/accordion](http://api.jqueryui.com/1.8/accordion)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T20:08:34.513

您是否确保并包含对[**jQueryUI**](http://www.jqueryui.com)库的正确引用？

**内容分发网络**

```
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.js'></script> 
```

**普通文件参考**

```
<script type='text/javascript' src='.../yourDirectory/jquery-ui.js'></script> 
```

您可以在下面看到一个工作示例，该示例在包含 jQuery UI 参考后可以正常运行。

**[例子](http://jsfiddle.net/8SAkh/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-05T15:49:32.537

`activate`和`beforeActivate`事件在 jQuery UI 1.8 中不存在，这解释了为什么警报没有触发。

正如 Shaz 所提到的，在 jQuery UI 1.8 中，这些事件被命名为`change`和`changestart`.

> [https://api.jqueryui.com/1.8/accordion/](https://api.jqueryui.com/1.8/accordion/)

从 jQuery UI 1.9 开始，事件名称更改为`activate`和`beforeActivate`。

> [https://api.jqueryui.com/1.9/accordion/](https://api.jqueryui.com/1.9/accordion/)

更多详细信息：

> [http://jqueryui.com/changelog/1.9.0/#accordion](http://jqueryui.com/changelog/1.9.0/#accordion)
> `Deprecated: changestart event; renamed to beforeActivate. (#6840, 088ef05, e0fe788)` `Deprecated: change event; renamed to activate. (#6842, 088ef05, e0fe788)`

# mysql - 用 * 字符包围单列中的字符串值

> ID：14146310
> 
> 赞同：0
> 
> 时间：2013-01-03T20:02:13.203
> 
> 标签：mysql, string

我有一个 mysql 数据库列，其中包含用逗号分隔的字符串值（例如：）`apple, pear, orange, banana, grape`。我需要创建一个 SQL 语句，它将在每个字符串值的任一侧插入一个 * （例如：）`*apple*,*pear*,*orange*,*banana*,*grape*`。我知道如何获取这些值并解析它们，但不确定如何添加 * 字符。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:06:02.693

```
UPDATE the_table
SET the_column = CONCAT('*', REPLACE(the_column, ', ', '*,*'), '*') 
```

# javascript - 为什么 Safari 中的范围缩小会破坏现有代码？

> ID：14146316
> 
> 赞同：1
> 
> 时间：2013-01-03T20:02:52.330
> 
> 标签：javascript, safari

火狐没有问题

```
var logger = window.console.log,  // breaks Safari but not Firefox 
```

但是 Safari 在我尝试使用的第一个地方给出了类型错误`logger()`。请注意下面的片段。

我继续用 window.console.log() 替换了我所有的 logger() 以消除错误。

我不明白为什么 Safari 不喜欢它以及为什么它称它为类型错误。

**错误**

TypeError：类型错误

**片段**

```
/*log
**
**
**
*/
NS.log = function (arg) {
    if (window.console) {
        var logger = window.console.log,  // breaks Safari but not Firefox
            str1 = Object.prototype.toString.call(arg);
// ... snip 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T20:07:28.260

这应该有效：

```
var logger = window.console.log.bind(window.console) 
```

# c# - C# 单例定义

> ID：14146321
> 
> 赞同：4
> 
> 时间：2013-01-03T20:03:15.130
> 
> 标签：c#, singleton

我看到了这样的实现：

```
class MyClass
{
    private static readonly MyClass _instance = new MyClass();

    public static MyClass Instance{
        get{ return _instance; }
    }
} 
```

为什么不让它变得简单呢？

```
class MyClass
{
    public static readonly MyClass Instance = new MyClass();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T20:07:36.650

您*可以*像这样公开公共字段 - 但我不希望这样做。如果将其保留为属性，则可以稍后更改实现。例如，假设您稍后添加了一个静态方法，您希望能够在不初始化单例的情况下调用该方法 - 使用属性版本，您可以将代码更改为：

```
public sealed class MyClass
{
    public static MyClass Instance { get { return InstanceHolder.instance; } }

    private MyClass() {}

    private static class InstanceHolder
    {
        internal static readonly MyClass instance = new MyClass();
    }

    public static void Foo()
    {
        // Calling this won't initialize the singleton
    }
} 
```

（在原始版本中，单例*可能会*被初始化，也可能不会——这取决于 CLR。​​）

这只是您可能希望稍后更改实现的*一个示例。*使用属性，您可以做到这一点 - 使用字段，您不能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T20:07:31.863

你在那里得到的东西会很好用，但公共领域通常不赞成使用属性。您可以更改的实现，`get { ... }`而无需更改调用代码。这将使您能够（例如）切换到延迟初始化，其中仅在第一次使用实例时创建实例。

请注意，虽然调用代码不需要更改，但它会更改您的类的签名，因为只读属性与只读字段不同。

# java - 方法 java 的返回值

> ID：14146322
> 
> 赞同：0
> 
> 时间：2013-01-03T20:03:14.663
> 
> 标签：java, class, variables, return

我有一个java程序，我编写它来返回一个值表。后来随着该程序功能的增长，我发现我想访问方法中未返回的变量，但我不确定最好的方法。我知道您不能返回一个以上的值，但是如果不进行大修，我将如何访问该变量？这是我的代码的简化版本：

```
public class Reader {
    public String[][] fluidigmReader(String cllmp) throws IOException {
        //read in a file
        while ((inpt = br.readLine()) != null) {
            if (!inpt.equals("Calls")) {
                continue;
            }
            break;
        }
        br.readLine();
        inpt = br.readLine();
        //set up parse parse parameters and parse
        prse = inpt.split(dlmcma, -1);
        while ((inpt = br.readLine()) != null) {
            buffed.add(inpt);
        }
        int lncnt = 0;
        String tbl[][] = new String[buffed.size()][rssnps.size()];
        for (int s = 0; s < buffed.size(); s++) {
            prse = buffed.get(s).split(dlmcma);
            //turns out I want this smpls ArrayList elsewhere
            smpls.add(prse[1]);
//making the table to search through
            for (int m = 0; m < prse.length; m++) {
                tbl[lncnt][m] = prse[m];
            }
            lncnt++;
        }
        //but I return just the tbl here
        return tbl;
    } 
```

任何人都可以推荐一种在另一个类中使用 smpls 而不返回它的方法吗？这可能是当您使用获取/设置类型的设置时？抱歉，如果这似乎是一个显而易见的问题，我对模块化编程世界还是陌生的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T20:09:31.807

现在你有这个`tbl`变量。将其包装在一个类中并将列表添加到该类中。

```
class TableWrapper {
    // default accessing for illustrative purposes - 
    // setters and getters are a good idea
    String[][] table;
    List<String> samples;

    TableWrapper(String[][] table, List<String> samples) {
        this.table = table;
        this.samples = samples;
    }
} 
```

然后重构您的方法以返回包装器对象。

```
public TableWrapper fluidigmReader(String cllmp) throws IOException {
    // your code here
    String tbl[][] = new String[buffed.size()][rssnps.size()];
    TableWrapper tw = new TableWrapper(tbl,smpls);
    // more of your code
    return tw;
} 
```

然后在你的代码中你要去的地方

```
String[][] tbl = fluidigmReader(cllmp); 
```

你反而去

```
TableWrapper tw = fluidigmReader(cllmp);
String[][] tbl = tw.table;
List<String> smpls = tw.samples; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:10:37.233

如果您为返回值使用了专用类（例如`TableWrapper`在另一个答案中提到的），那么您可以在那里添加其他字段。

这就是类的好处——它们可以扩展。但是你不能`String[][]`在 Java 中扩展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T20:05:44.360

You can set a field, instead of a local variable, which you can retrieve later with a getter. You want to avoid it unless it is needed, but in this case it is.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T20:11:36.187

您可以为此使用 class(Inside Reader class) 变量。但请确保它的读/写是同步的

# android - 无法访问的代码android

> ID：14146325
> 
> 赞同：0
> 
> 时间：2013-01-03T20:03:24.157
> 
> 标签：android

我一整天都在编程，现在我在返回后无法访问；在

```
return;
Recipe093.path[1] = localCursor.getString(1); 
```

如果我删除返回，我会在继续后得到无法访问的代码；为什么我得到无法访问的代码？希望有人可以帮助我，谢谢。这是我的代码：

```
public void onCreate(Bundle paramBundle)
  {
    super.onCreate(paramBundle);
    setContentView(R.layout.musiclist);
    final Cursor localCursor = managedQuery(MediaStore.Audio.Media.EXTERNAL_CONTENT_URI, (String[])null, null, (String[])null, null);
    String[] arrayOfString1 = localCursor.getColumnNames();
    int i = arrayOfString1.length;
    for (int j = 0; ; j++)
    {
      if (j >= i)
      {
        String[] arrayOfString2 = { "title", "artist", "duration" };
        int[] arrayOfInt = { 2131099668, 2131099669, 2131099670 };
        SimpleCursorAdapter localSimpleCursorAdapter = new SimpleCursorAdapter(getApplicationContext(), 2130903044, localCursor, arrayOfString2, arrayOfInt);
        localSimpleCursorAdapter.setViewBinder(new AudioListViewBinder());
        ListView localListView = (ListView)findViewById(2131099667);
        localListView.setAdapter(localSimpleCursorAdapter);
        Log.d("test", "start list()");
        localListView.setOnItemClickListener(new AdapterView.OnItemClickListener()
        {
          public void onItemClick(AdapterView<?> paramAnonymousAdapterView, View paramAnonymousView, int paramAnonymousInt, long paramAnonymousLong)
          {
            switch (Recipe093.this.getIntent().getIntExtra("case1", 0))
            {
            default:
            case 1:
            case 2:
            case 3:
            case 4:
            case 5:
            case 6:
            case 7:
            case 8:
            case 9:
            case 10:
            case 11:
            case 12:
            case 13:
            case 14:
            case 15:
            case 16:
            }
            while (true)
            {
              Intent localIntent = new Intent(Recipe093.this.getApplicationContext(), MainActivity.class);
              Recipe093.this.startActivity(localIntent);
              return;
              Recipe093.path[1] = localCursor.getString(1);
              SharedPreferences.Editor localEditor10 = Recipe093.this.getSharedPreferences("FileName", 3).edit();
              localEditor10.putString("userChoice", Recipe093.path[1]);
              localEditor10.commit();
              continue;
              Recipe093.path[2] = localCursor.getString(1);
              SharedPreferences.Editor localEditor9 = Recipe093.this.getSharedPreferences("FileName", 3).edit();
              localEditor9.putString("userChoice1", Recipe093.path[2]);
              localEditor9.commit();
            } 
          }
        });
        return;
      }
      Log.d("Recipe093", arrayOfString1[j]);
    }
  }

  private class AudioListViewBinder
    implements SimpleCursorAdapter.ViewBinder
  {
    private AudioListViewBinder()
    {
    }

    public boolean setViewValue(View paramView, Cursor paramCursor, int paramInt) {
        // TODO Auto-generated method stub
          int i = paramCursor.getColumnIndex("title");
          int j = paramCursor.getColumnIndex("artist");
          int k = paramCursor.getColumnIndex("duration");
          if ((paramInt == i) || (paramInt == j))
            ((TextView)paramView).setText(paramCursor.getString(paramInt));
        return false;
    }

  }
  } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T20:04:35.763

基本上，`return;`意思是“现在退出这个方法”。因此，return 语句之后的任何内容都不会运行。

您可以使用范围获得多个回报：

```
if(x == 1) {
    return;
    // Nothing will be called here on down in this scope, i.e. before `}`
}
x = 1;
return; 
// Nothing will be called here on down 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:06:06.527

If you can `return;` the code stops and returns to the first method. It will not run any code after this line. The same story with `break;`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T22:11:01.430

正如山姆所说（你应该接受他的回答），`return`意味着现在退出。

但是，`return`对于返回 void 的方法是可选的，因为该方法的右大括号也将返回：

这些是等价的：

```
void someMethod(){
    doSomeStuff();
    return;
}

void someMethod(){
    doSomeStuff();
} 
```

`return`除非您想提前返回，否则在 void 方法中使用被认为是不好的做法，但是任何显式返回都必须是有条件的，即`switch`or`if`语句的一部分。如果它们不是有条件的，则编译器知道该方法将始终在该点退出，并且它之后的任何代码都无法执行，因此您会看到编译器错误。

对于大多数 Java 程序员来说，第一个示例看起来是错误的。

PS。 `while(true)`太可怕了，但是，如果您想尽早退出该循环，则应使用`break`which 将执行转移到 while 循环结束后的语句，而不是`return`.

# c# - 如何在数据库上使用 JOIN。

> ID：14146326
> 
> 赞同：0
> 
> 时间：2013-01-03T20:03:26.937
> 
> 标签：c#, sqlite, foreign-keys

（SQLite 和 C#）我有这个小问题。见那两张表。1.是父母，2.是孩子

![家长](../Images/f35604d48574632af238ba8e6625cf1d.png)

![孩子](../Images/11ba6cb12c41243faaebeee110db9474.png)

我应该从父表中获取“broj_goluba”以匹配子表中的“par_m”和“par_z”，然后将其显示在 datagridview 中。

外键应该有助于快速完成工作，但是当我编写代码时，与不使用外键相比，我有更多的代码行。

有人可以帮我写下*我的代码*（编辑：SQL 查询）在使用外键时的样子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:14:16.037

我知道你需要的是，但它不需要做任何与速度有关的事情。也许你的意思是`INDEX`而不是`FOREIGN KEY`。

```
SELECT BROJ_GOLUBA
FROM TABLE1
INNER JOIN TABLE2 ON (TABLE1.ID = TABLE2.PAR_M OR TABLE1.ID = TABLE2.PAR_J) 
```

或者，也许您需要两个值相等：

```
SELECT BROJ_GOLUBA
FROM TABLE1
INNER JOIN TABLE2 ON (TABLE1.ID = TABLE2.PAR_M AND TABLE1.ID = TABLE2.PAR_J) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:10:18.273

不存在“帮助快速完成工作”的外键。它们的存在是为了强制数据完整性。坦率地说，我看不出您编写的 T-SQL 代码的行数如何取决于外键是否存在。

以下查询存根应该可以帮助您开始查询：

```
Select Table1.broj_goluba, Table2.par_z ...
From Table1
Inner Join Table2 on Table1.ID = Table2.par_m 
```

# jquery - 在包含类似颜色选项的同一页面上使用带有多个选择的 jQuery

> ID：14146330
> 
> 赞同：0
> 
> 时间：2013-01-03T20:03:41.427
> 
> 标签：jquery, colors, multi-select

如果选择了某个条件，我希望 jQuery 将我的一些多选列表选项的颜色更改为红色。这是我的代码：

```
$.each(subjects, function(key, subject) 
        {
            if (select.find('option[value=\"' + encodeURIComponent(subject) + '\"]').length === 0 && subject!="") 
            {
                   $('<option>', {
                     value: subject,
                     text: subject
                     }).appendTo(select);

                 if (colored==true)
                     {
                         //Change color of options' text
                         $("option[value='"+subject+"']").css('color', 'red');
                     }
            }
        }); 
```

这段代码的问题在于，jQuery 不仅将当前正在运行的多选选项的选项设置为红色，而且它的名称在变量**select**中定义。但是 jQuery 也会在页面上的所有其他多选中为这些选项着色，如果它们包含它的话。

如何编辑此代码以使 jQuery 仅对当前多选中包含的选项进行着色，其名称再次在**select**变量中定义？

例如，更换

```
$("option[value='"+subject+"']").css('color', 'red'); 
```

和

```
(select.find("option[value='"+subject+"']").css('color', 'red'); 
```

不工作。什么是正确的代码？先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:13:23.393

你试过了吗？

```
$("#" + selectList + " option[value='"+ encodeURIComponent(subject)+"']").css('color', 'red'); 
```

LMM - 编辑以包含编码

# symfony - 安装“braincrafted/bootstrap-bundle”时找不到接口：“dev-master”

> ID：14146336
> 
> 赞同：1
> 
> 时间：2013-01-03T20:04:02.113
> 
> 标签：symfony, symfony-2.1

我希望有人能帮助我。我正在使用 symfony 2.1 并决定尝试使用来自[http://bootstrap.braincrafted.com/](http://bootstrap.braincrafted.com/)的引导程序包。

我已将 "braincrafted/bootstrap-bundle": "dev-master" 添加到我的作曲家文件的 require 部分并已运行`composer update`，但出现以下错误：

`Fatal error: Interface 'Knp\Menu\Matcher\Voter\VoterInterface' not found in /home/ian/Zend/workspaces/DefaultWorkspace7/newmdr/vendor/braincrafted/bootstrap-bundle/Braincrafted/BootstrapBundle/Voter/RequestVoter.php on line 20`

任何人都知道问题是什么？我将冒险猜测依赖问题。有没有人解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T07:29:34.817

您需要添加

```
"knplabs/knp-menu": "dev-master" 
```

到您`composer.json`的 symfony 项目文件夹中。它将安装它需要的菜单。

# ruby-on-rails - 文章、经销商和单位表

> ID：14146338
> 
> 赞同：1
> 
> 时间：2013-01-03T20:04:17.357
> 
> 标签：ruby-on-rails, database-design

我有 3 个模型：

```
Article (:title)
  has_many :units
Dealer (:name, :adress)
  has_many :units
Unit (:price, :dealer_id, :article_id)
  belongs_to :article
  belongs_to :dealer 
```

我不确定我的表是否完全正确，我不确定我应该使用 has_many :through 还是只是 has:many 和属于？究竟有什么区别？

rails 查询究竟会是什么样子？

```
Article.find(:name => "Cheese").units
Article.find(:name => "cheese").units.minimum('price').dealer 
```

这样复杂的 Rails 查询会在这种关系中起作用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:13:50.117

您可以像这样声明 has_many ：

```
Unit (:price, :dealer_id, :article_id)
  belongs_to :article
  belongs_to :dealer

Article (:title)
  has_many :units
  has_many :dealers, through: :units

Dealer (:name, :adress)
  has_many :units
  has_many :articles, through: :units 
```

使用`has_many :objects, through: :relation`允许您访问特定条目的对象：

```
@dealer.articles
# and
@article.dealers 
```

这`has_many through:`是一种不同的方法`has_and_belongs_to_many`：它允许在连接模型上附加属性和验证**（[Ruby 风格指南](https://github.com/bbatsov/rails-style-guide)）**

执行以下操作将对数据库生成 2 个查询：

```
Article.find(:name => "Cheese").units 
```

我们知道 Unit 模型有一个属性`article_id`。在这种情况下，最好的方法是（假设您知道文章的 id）：

```
Unit.where(article_id: article.id) 
```

这只会生成一个对数据库的查询。

# php - 使用 SQL 数据填充选择并已选择预先存在的条目

> ID：14146339
> 
> 赞同：0
> 
> 时间：2013-01-03T20:04:20.630
> 
> 标签：php, option

我已经看到了一个答案，但我不明白 - 问号在哪里（在第 6 行）？看了一会，想必有人舌尖上已经有了答案。- *（是的，我知道我在我的代码中混合了转义字符，但我正在尝试创建更清晰/更好的代码，我可能不应该混合 PHP 和 HTML）*

```
 <select name="teacher"> ';
        $empquery = "SELECT * FROM `employees` ORDER BY `lastname`";
        $empresults = $pdo->query($empquery);
        while ($emprow = $empresults->fetch()) {
            echo "<option value=".$emprow['id'];
            if (?????????? == $emprow['id']) 
                echo "selected = 'selected'";   
            echo "> {$emprow['lastname']} {$emprow['firstname']}</option> ";    
        } 
  echo ' </select> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:34:13.787

正如vodich建议的那样，应该有另一个变量保存当前值或选定值

例如

如果要为部门分配联系人，您可能希望将该部门的联系人（如果已经有）与选择列表选项值进行比较

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:40:47.843

Oh... I just got it - Apologies for lameness of question. For those who come after me:

In my case, the variable in the ???? should be the one that held a value when the user is sent to this web page in the FIRST place. I had a page where a classroom was selected, then this page loads the classroom info. The classroom info along with a teacher ID was sent to this form.

This form allows the user to select a different teacher for the classroom. The default (selected="selected") value is in that variable (array) I sent to this page.

Thanks for explaining guys.

# android-asynctask - 上下文和自定义适配器

> ID：14146340
> 
> 赞同：0
> 
> 时间：2013-01-03T20:04:22.693
> 
> 标签：android-asynctask, this, adapter, android-context

我需要一些帮助`Asynctask`和自定义适配器。我有一个`asynctask`通过解析获取数据的方法。然后我必须把它们放在一个`ListView`. 我创建了一个自定义适配器，但我对上下文有一些问题。我确信这有一个非常简单的解决方案，但我无法理解实际的**上下文**是什么！eclipse中说明了这个问题：

```
 protected void onPostExecute(final List<String> list) {
        ListView listView = (ListView)findViewById(R.id.listavvisi);

        CustomAdapter adapter = new CustomAdapter(**this**, R.layout.rowcustom, list);
        listView.setAdapter(adapter); 
```

我把我的名单传给`customadapter`

```
public class CustomAdapter extends ArrayAdapter<Avviso> {
private Context context;

  public CustomAdapter(**Context** **context**, int textViewResourceId, List<Avviso> Strings) {
        super(context, textViewResourceId, Strings);
} 
```

调用 a 时我需要什么**上下文**`New Customadapter...`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T12:28:50.703

我回答我自己的问题。所以，我不得不使用“javaclass.this”而不是“context”

# r - 使用 setAs() 获取警告以在 R 中指定 colClasses

> ID：14146341
> 
> 赞同：8
> 
> 时间：2013-01-03T20:04:23.867
> 
> 标签：r, class, datetime, warnings, user-defined-types

我尝试使用此[问题](https://stackoverflow.com/questions/13022299/specify-date-format-for-colclasses-argument-in-read-table-read-csv)中提供的答案@Greg Snow ，但无论我做什么，我都会收到警告。有人可以帮忙吗：？

```
> setAs("character","myDate",function(from) as.Date(from, format="%b %d, %Y %r"))
in method for ‘coerce’ with signature ‘"character","myDate"’: no definition for class “myDate” 
```

我想确保“方法”包已加载（看起来 setAs 取决于它），我得到了这个：

```
> getOption("defaultPackages")
[1] "datasets"  "utils"     "grDevices" "graphics"  "stats"     "methods" 
```

TIA

# mysql - 了解 xcode json 网络请求

> ID：14146344
> 
> 赞同：0
> 
> 时间：2013-01-03T20:04:33.083
> 
> 标签：mysql, ios, json, core-data

这是我第一次将应用程序连接到网络，我只是想确保我清楚它是如何工作的。我想从在线托管的 mysql 数据库下载数据，它似乎也附加了 php（hostgator）是主机。

所以步骤是： 1\. 在 php（在服务器模块上）中，使用附加的 PHP 模块设置一个将 mysql 信息转录为 JSON 的方法。返回一个数组（我认为json是一个多层字典数组对象）

1.  在 xcode 中，使用苹果的 json 框架创建一个 url 请求，并将数据下载到一个 json 对象（或数组或字典？

2.  浏览数据并创建对象并保存到 coredata。

如果我正确地遵循逻辑，请告诉我。

JSON 也返回 1 个对象或 mysql 数据库上的所有对象。因此，如果我需要在 coredata 上输入 10,000 个对象，我必须发出 10,000 个请求或一个请求并解析 10,000 个对象的信息价值？

这也是做我需要做的最好的方法吗？我听说过http请求，但它看起来很复杂，我不知道它是什么。

对不起，这样的菜鸟问题。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T21:05:07.247

有很多方法可以做到这一点，有些方法比其他方法“更正确”:-) 但你走对了。我解释了在类似情况下我会做什么：

1- 对于 PHP 引擎，您应该创建一个 API 来访问您的数据。哪些数据？最简单的，可能是您可以做的第一件事 TO TEST（仅用于测试目的！！！！）是创建一个页面，该页面通过 POST 从您的 ios APP 接收查询并使用编码的 JSON 字符串进行回答。使用 JSON，您可以传输对象的整个层次结构：变量、数组、字典……由您决定如何将对象链接在一起。如果您要编码的数据是一个表格，您可以执行类似的操作：

```
// first connect to the database and execute the query, then...

$data = array();
while(!$RS->EOF){
for ($i = 0; $i < $cols; $i++){
    $rowName = utf8_encode($RS->Fields[$i]->name);
    $rowValue = utf8_encode($RS->Fields[$i]->value);
    $rowData[$rowName] = $rowValue;
}

array_push($data, $rowData);
$RS->MoveNext();
}

$response['data'] = $data;
echo json_encode($response); 
```

结果是一个 JSON 对象，其中包含一个名为“data”的键的第一个字典。在“data”键里面有一个字典数组。每个字典都有键的列名和数据的列值：

```
data =     (
            {
        attivita = "this is the first row in the table";
        id = 2548;
        },
            {
        attivita = "this is the second row in the table";
        id = 2547;
        };
} 
```

您可以简单地使用 json_encode 来创建您的 json 字符串。

在 iPhone 端，我建议你下载并使用 AFNetworking。这是一个非常好的和完整的开源框架，有很多用于 http/https 请求、XML、JSON ecc 的内置对象和方法......使用 AFNetworking 你可以用类似的方式发出请求：

```
AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:@"http://url.for.the.php.page"];
NSMutableURLRequest *request = [httpClient requestWithMethod:@"POST" path:mainPath parameters:params];

AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {

    // your success code here

    // remember, the first object is a dictionary with a key called data
    NSArray *arrayOfData = [JSON objectForKey:@"data"];

    NSMutableArray *arrayOfActivities = [NSMutableArray array];

    for (NSDictionary *objectDictionary in arrayOfData) {
        // objectDictionary is your dictionary containing 
        // a key with the column name and a value with the column content
        // here you can init your custom objects

    }

} failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
    // your failure code here
}];

[operation start]; 
```

如您所见，JSONRequestOperationWithRequest: 方法有一个完成处理程序返回解码后的 JSON，因此您可以使用 objectForKey 或 objectAtIndex 直接访问您的字典/数组；-)

最后的建议：在生产和安全环境中，您应该避免通过发布请求发送查询。我在此处粘贴的代码用于私人应用程序（仅供我用于测试目的）。最好为每种请求使用不同的 API 和安全的身份验证方法（查看 oAuth）。我建议你看一下 Instagram 或 Twitter API（Instagram 更简单），尝试使用它。他们会给你一些关于如何创建自己的 API 的想法。

祝你好运

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T20:51:08.503

创建返回 JSON 化 MySQL 数据的方法的第一步是正确的。*然而，究竟*返回什么，完全取决于你！您会发现 JSON 是一种极其灵活的格式，它允许您在响应中放入几乎任何格式的数据。根据您想要做什么，在您的 PHP 模块中有几个返回不同内容的方法可能是有意义的。例如，如果您有一个书籍数据库，也许您想创建一个允许您指定作者的方法，并返回一个 JSON 响应，其中包含该作者编写的数据库中的所有书籍。

您可以使用 HttpRequest 来实际执行对您的模块的调用，但我发现 Obj-C`NSURLRequest`非常易于使用：

```
NSURLRequest *request = [NSURLRequest requestWithURL:
                        [NSURL URLWithString:@"http://yoururl/books/38917"]];
[[NSURLConnection alloc] initWithRequest:request delegate:self]; 
```

不要认为您必须手动将 JSON 响应解析为您自己的 Objective-C 对象；这是一项非常常见的任务，并且有许多很棒的库可以做到这一点。查看有关 SBJSON 框架的[本教程](http://blog.zachwaugh.com/post/309924609/how-to-use-json-in-cocoaobjective-c)以查看最流行的解决方案之一。

例如，以下是如何将 JSON 响应解析`NSDictionary`为便于遍历的方法：

```
// Create SBJSON object to parse JSON
SBJSON *parser = [[SBJSON alloc] init];

// parse the JSON string into an object - assuming json_string is a NSString of JSON data
NSDictionary *object = [parser objectWithString:json_string error:nil]; 
```

# workflow-foundation-4 - WF 4中执行异步Activity时如何控制线程数

> ID：14146348
> 
> 赞同：2
> 
> 时间：2013-01-03T20:04:56.353
> 
> 标签：workflow-foundation-4

我正在 WF 4 中创建一个工作流，其中我有一个`ParallelForeach`迭代项目集合的活动。对于集合中的每个项目，我执行自定义异步活动以并行处理多个项目。

上面的解决方案对我有用，但我担心使用的线程数，因为每个异步活动实例都是在自己的线程上执行的。有没有办法配置/控制在上述机制中执行 parallelForeach 活动时启动的线程数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:16:17.130

*因为每个异步活动实例都在自己的线程上执行*。谁说？ [当然不是文档。](http://msdn.microsoft.com/en-us/library/ee849842.aspx)

> ParallelForEach 枚举它的值并为它枚举的每个值调度 Body。它只安排身体。身体如何执行取决于身体是否闲置。如果 Body 没有空闲，它会以相反的顺序执行，**因为计划的活动作为堆栈处理，**最后一个计划的活动首先执行。
> 
> 例如，如果您在 ParallelForEach 中有一个 {1,2,3,4} 的集合，并使用 WriteLine 作为主体来写出值。您在控制台中打印了 4, 3, 2, 1。这是因为 WriteLine 不会空闲，因此在安排了 4 个 WriteLine 活动后，***它们使用堆栈行为（先进后出）执行***。

仅当 Activity 创建书签并处于空闲状态时，才会发生并行执行。即使这样，两个活动实际上并没有同时执行——一个或多个刚刚停止执行，允许其他活动按顺序运行。可以理解的混乱，给定的名字，但就是这样。

In any event, when you're relying on the framework to parallelize for you, don't worry about how many threads they're using. They probably have everything under control. Until you know they don't.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T22:19:35.843

Will 是正确的，ParallelForEach 不需要为每个分支创建一个新线程。如果您在应该发生在 AsyncCodeActivity 中的代码中执行阻塞 I/O，这样您就不会不必要地阻塞。如果您希望 CPU 密集型工作与其他活动并行运行，您需要将其包装在 AsyncCodeActivity 中或使用 InvokeMethod { RunAsynchronously = true} 在这种情况下，框架将负责在后台线程上运行工作。

SynchronizationContext 扩展点适用于需要 WF 集成的特定现有线程模型的情况。这方面的主要示例包括 ASP.NET 的线程环境和 Windows Presentation Foundation/WinForms（例如，如果您希望活动正常工作）。

# rest - REST API GET/POST 使用 jquery AJAX 来获取使用 Neo4j 图形数据库的节点

> ID：14146353
> 
> 赞同：3
> 
> 时间：2013-01-03T20:05:16.793
> 
> 标签：rest, jquery, post, neo4j

我是 REST API 的新手**（这真的是我的 REST 问题吗？）**

我想通过使用 Cypher 从 neo4js 获取所有节点

```
START n = node(*)
return n; 
```

**如果我使用 jquery ajax POST 或 GET 方法，我该如何使用**

在[文档](http://docs.neo4j.org/chunked/milestone/rest-api-cypher.html)中它推荐

```
POST http://localhost:7474/db/data/cypher
Accept: application/json
Content-Type: application/json 
```

在我的代码中我写

```
 $.ajax({
      type:"POST",
      url: "http://localhost:7474/db/data/cypher",
      accepts: "application/json",
      dataType:"json",
      contentType:"application/json",
      data:{
             "query" : "start n  = node(*) return n",
             "params" : {}
           },
      success: function(data, textStatus, jqXHR){
                      alert(textStatus);
                        },
      error:function(jqXHR, textStatus, errorThrown){
                       alert(textStatus);
                        }
             });//end of placelist ajax 
```

我的问题是什么？错误警报如下
![在此处输入图像描述](../Images/4e1a9e5f2a24983fe696d318421006e7.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-03T21:32:47.970

你没有说你得到什么样的错误，但是运行与你完全相同的代码，我得到以下错误：

```
XMLHttpRequest cannot load http://127.0.0.1:7474/db/data/cypher.
Origin http://127.0.0.1:3000 is not allowed by Access-Control-Allow-Origin. 
```

所以我假设这是您遇到的错误。

执行跨域 Ajax 调用时，有两种选择：

1.  [JSONP](http://en.wikipedia.org/wiki/JSONP)，Neo4J 不支持。

2.  跨域资源共享 (CORS)。[“CORS 背后的基本思想是使用自定义 HTTP 标头来允许浏览器和服务器充分了解彼此，以确定请求或响应是成功还是失败”](http://www.nczonline.net/blog/2010/05/25/cross-domain-ajax-with-cross-origin-resource-sharing/)。

在 POST 之前发送的 OPTIONS 请求（[预检请求](http://www.w3.org/TR/cors/#preflight-request)）从 Neo4J REST 服务器返回以下标头：

```
Access-Control-Allow-Origin:*
Allow:OPTIONS,POST
Server:Jetty(6.1.25) 
```

这里缺少一个关键的标题，即`Content-Type`标题。这意味着当此标头与 POST 请求一起发送时，POST 请求将失败，这正是您的 $.ajax() 调用中发生的情况。

如果您删除以下行，POST 将成功

```
contentType:"application/json", 
```

从你的`$.ajax()`电话。

这将阻止 jQuery 发送 Content-Type 标头。

# java - 尝试压缩图像（Gzip+Jpeg）然后解压缩它们

> ID：14146355
> 
> 赞同：3
> 
> 时间：2013-01-03T20:05:18.680
> 
> 标签：java, compression, gzip, jpeg

我正在尝试以 png 格式压缩一系列图像。似乎压缩进展顺利：

```
FileOutputStream fos = null;
GZIPOutputStream gzip = null;
fos = new FileOutputStream(PATH_SAVE_GZIP);
gzip = new GZIPOutputStream(fos);
for (int i = 0; i < NB_OF_IMAGES; i++) {
     BufferedImage im = images.get(i).getBufImg();
     ImageIO.write(im, "JPEG", gzip);  
}
gzip.finish();
gzip.close();
fos.close(); 
```

但是，当我尝试使用[此](http://pastie.org/private/xpxpe2i8zlxkcgmwtc0lq)代码解压缩它时，我得到了 Exception Nullpointer...。我在做什么错？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T02:21:16.593

我已经完成了我的项目，现在我知道了答案。这可以通过几种方式解决：

一种是使用 ObjectOutput/Input Stream 并像对象一样编写 BufferedImages。

另一种是使用 ByteArrayOutputStream 并像字节一样写入图像。在使用它之前，您应该知道要写入的大小。所以我在每张图片之前都解决了这个书写大小。不是有效的方式......但是有效。

```
 fileOutputStream fos = new FileOutputStream(path);
        GZIPOutputStream gzip = new GZIPOutputStream(fos);
        gzip.write(shortToBytes(numImatges));
        gzip.write(shortToBytes((short) 0));     
        for (int i = 0; i < dates.getNB_OF_IMAGES(); i++) {

            if (images != null) {
                im = images.get(i).getBufImg();
            }
            ByteArrayOutputStream byteOstream = new ByteArrayOutputStream();
            ImageIO.write(im, "jpeg", byteOstream);
            byteOstream.flush();
            byteOstream.close();
            gzip.write(shortToBytes((short) byteOstream.size()));
            gzip.write(byteOstream.toByteArray());

            }
//close streams 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T08:54:36.373

您的问题是您将所有图像写入单个`GZIP`流，并且在读取时，`ImageIO`不知道一个图像在哪里结束，下一个图像从哪里开始。

你有两个选择：

1.  使用`ZIP`代替`GZIP`
2.  `TAR`使用[jtar](http://code.google.com/p/jtar/)或[Java Tar Package](http://www.trustice.com/java/tar/)将文件打包到文件中，然后 GZIP tar，读取时您将首先 UnGZIP，然后从 tar 文件中提取图像

# javascript - 哪个元素导致水平滚动条？自动检测

> ID：14146356
> 
> 赞同：9
> 
> 时间：2013-01-03T20:05:23.660
> 
> 标签：javascript, html, css, scrollbar

网站和 HTML 应用程序上的水平滚动条通常不利于可用性并且不需要。发现它们意外出现是很常见的，我需要一种快速调试和删除它们的方法。

**在您的设计中找到有问题的 HTML 元素的快速简便的方法是什么？**

是的，您可以逐个删除/隐藏页面，直到找到嫌疑人，但这很耗时，尤其是在有*多个*违规元素的情况下。单击快捷方式或运行脚本并将所有可疑元素突出显示、概述或打印到控制台会很棒。

澄清一下：问题不在于如何*解决*它，而在于如何*检测*它。我想要一个通用的解决方案，只要出现这个问题就可以工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T20:12:53.267

在更窄的范围内，您可以使用 jQuery（获取宽度）并`node.scrollWidth`获取内容超出其边界的节点。

[http://jsfiddle.net/tomprogramming/v3Q6W/3/](http://jsfiddle.net/tomprogramming/v3Q6W/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:17:12.043

如果你让你的内容流动，你一开始就不会得到水平滚动条。不要设置太多的宽度限制。通常，您只设置包含所有内容的主列的（最小）宽度。您还可以限制某些垂直条的宽度（例如导航条）。否则，请谨慎使用 CSS 宽度属性（和其他此类机制）。

CSS white-space 属性也倾向于需要滚动条；明智地使用此属性。这实际上仅适用于格式化代码，在 HTML 源代码中保持换行符以用于对齐目的很重要。

# wpf - 如何制作每行可以是不同字体、大小、颜色的进度/消息窗口？

> ID：14146359
> 
> 赞同：-2
> 
> 时间：2013-01-03T20:05:27.557
> 
> 标签：wpf, text, mvvm, colors

我试图在我的视图中创建一个 TextBlock，它将显示我发送给它的任何消息。它只是在每次写入时不断附加一个新行。我希望能够以每行不同的字体、大小和颜色书写。

我找到了适用于 ListViews 和 RichTextBox 的示例。我不在乎它是什么控制。它只需要遵循 MVVM 格式，这就是我在使用这些示例时遇到问题的地方。

对于那些熟悉命令行窗口的人，如何制作批处理文件和“回显”行到显示器？这就是我想要做的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T14:01:55.273

在 Listbox 中找到[Alternate row color](http://www.c-sharpcorner.com/uploadfile/dpatra/alternate-row-color-in-listbox-in-wpf/)并使用[Textblock 的 Bind 前景](https://stackoverflow.com/questions/5601489/how-can-i-bind-foreground-to-a-property-in-my-viewmodel)。意识到我需要创建一个类来保存我的字符串和颜色。将该类放在 ObservableCollection 中，并绑定到 ObservableCollection。

我的新课：

```
public class DisplayData
{
    public string _string { get; set; }
    public System.Windows.Media.Brush _color { get; set; }
    public int _fontSize { get; set; }
} 
```

XAML：

```
<ListBox x:Name="Progress_Window" ItemsSource="{Binding pb._displayString}">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding _string}" Foreground="{Binding _color}" FontSize="{Binding _fontSize}" />
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

其中 pb 是我的 VM 中的本地类变量。

模型中的代码：

```
public ObservableCollection<DisplayData> _displayString { get; set; }
...
_displayString = new ObservableCollection<DisplayData>();
string _error = "Error Opening COM Port";
_displayString.Add(new DisplayData { _string = _error, _color = System.Windows.Media.Brushes.Red, _fontSize = 20 }); 
```

# r - 提取/之间的字符串

> ID：14146362
> 
> 赞同：18
> 
> 时间：2013-01-03T20:05:33.307
> 
> 标签：r, regex

如果我有这些字符串：

```
mystrings <- c("X2/D2/F4",
               "X10/D9/F4",
               "X3/D22/F4",
               "X9/D22/F9") 
```

我怎样才能提取`2,9,22,22`. 这些字符介于`/`和 中的第一个字符之后`/`。

我想以矢量化方式执行此操作，并在`transfrom`可能的情况下添加我熟悉的新列。

我认为这个正则表达式让我靠近所有字符`\`：

```
^.*\\'(.*)'\\.*$ 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-03T20:14:21.270

```
> gsub("(^.+/[A-Z]+)(\\d+)(/.+$)", "\\2", mystrings)
[1] "2"  "9"  "22" "22" 
```

您将“读取”（或“解析”）该正则表达式模式，将任何匹配的字符串分成三个部分：

1) 任何直到并包括第一个正斜杠后跟一系列大写字母的内容，

2) 下一个斜杠之前的序列中的任何数字(= "\d") 和 ,

3) 从下一个斜线到结尾。

然后只返回第二部分....

不匹配的字符串将原封不动地返回。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-01-03T20:11:15.927

`as.numeric(gsub("^.*D([0-9]+).*$", "\\1", mystrings))`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-03T20:13:43.827

`str_extract`从`stringr`包中使用：

```
as.numeric(str_extract(mystrings, perl('(?<=/[A-Z])[0-9]+(?=/)'))) 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-01-03T20:18:45.747

@Arun 抢了我的风头，所以我给出了我最初的冗长示例。

```
cut.to.pieces <- strsplit(mystrings, split = "/")
got.second <- lapply(cut.to.pieces, "[", 2)
get.numbers <- unlist(got.second)
as.numeric(gsub(pattern = "[[:alpha:]]", replacement = "", x = get.numbers, perl = TRUE))
[1]  2  9 22 22 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-01-03T20:21:29.867

这最终成为@RomanLuštrik 答案的压缩版本：

```
gsub("[^0-9]","",sapply(strsplit(mystrings,"/"),"[",2))
[1] "2"  "9"  "22" "22" 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-11-26T20:51:59.297

使用[rex](http://cran.r-project.org/web/packages/rex/index.html)可能会使这种类型的任务更简单一些。

```
matches <- re_matches(mystrings,
  rex(
    "/",
    any,
    capture(name = "numbers", digits)
    )
  )

as.numeric(matches$numbers)
#>[1]  2  9 22 22 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-11-06T12:20:28.860

使用包*脱胶*你可以做：

```
# install.packages("unglue")
library(unglue)

unglue_vec(mystrings, "{x}/{y}/{z}", var = "y")
#> [1] "D2"  "D9"  "D22" "D22" 
```

从您可以使用的数据框中，`unglue_unnest()`因此无需使用`transform()`

```
df <- data.frame(col = mystrings)
unglue_unnest(df, col, "{x}/{y}/{z}", remove = FALSE)
#>         col   x   y  z
#> 1  X2/D2/F4  X2  D2 F4
#> 2 X10/D9/F4 X10  D9 F4
#> 3 X3/D22/F4  X3 D22 F4
#> 4 X9/D22/F9  X9 D22 F9

# or used unnamed subpatterns to keep only the middle value
unglue_unnest(df, col, "{=.*?}/{y}/{=.*?}", remove = FALSE)
#>         col   y
#> 1  X2/D2/F4  D2
#> 2 X10/D9/F4  D9
#> 3 X3/D22/F4 D22
#> 4 X9/D22/F9 D22 
```

^(由[reprex 包](https://reprex.tidyverse.org)（v0.3.0）于 2019-11-06 创建)

更多信息：[https ://github.com/moodymudskipper/unglue/blob/master/README.md](https://github.com/moodymudskipper/unglue/blob/master/README.md)

# python-3.x - How to set a windows env variable from cygwin .bashrc?

> ID：14146363
> 
> 赞同：1
> 
> 时间：2013-01-03T20:05:39.617
> 
> 标签：python-3.x, cygwin, environment-variables, pythonpath

Background: I am trying to run a windows-installed version of python from within cygwin, rather than the cygwin version (some packages I am using prefer the non-cygwin version). The following post got me up and running: [Using Windows Python from Cygwin](https://stackoverflow.com/questions/3250749/using-windows-python-from-cygwin). However, I am now having an issue.

Problem: The PYTHONPATH variable does not seem to be working for me. I try "import module1" when I am using python in an arbitrary directory. module1 is located here: c:\cygwin\home\mcsefl\testFolder\module1.py. And my PYTHONPATH variable is set in my .bashrc file in the following way: "export PYTHONPATH=$PYTHONPATH:/home/mcsefl/testFolder". However I still get a "No module named..." error.

Alternate tries: Since I am running the Windows Python, I thought perhaps python did not care about the cygwin environment variables (not sure if this is true..?) So, I also tried to set the windows PYTHONPATH env variable in the control panel of windows with no luck as well.

Thanks in advance

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-19T20:50:01.143

我删除了 .bashrc 文件中试图设置 PYTHONPATH 变量并让它由 Windows 设置的行。这可以纠正问题。

旁注：这个问题的标题用词不当，因为我重新阅读了它。我的问题在没有解决整个问题的情况下得到了解决

# maven - 无法使用 FTP 协议从 FTP Maven 存储库下载依赖项工件

> ID：14146368
> 
> 赞同：0
> 
> 时间：2013-01-03T20:05:52.953
> 
> 标签：maven, ftp, wagon

我有以下问题：出于测试目的，我使用 FTP 服务器作为存储库。一切都可以很好地部署（上传）不同的工件。一旦我需要解决和下载之前上传到该仓库的工件依赖项，我就会收到以下警告：
[WARN] myrepo (ftp://ftp.myftpadress.fr/dev/M2Repo/,releases+snapshots) 被忽略（仅支持 S3、HTTP/S 和 FILE）。
我无法使用 HTTP 协议访问存储库。那么 wagon 是否支持 FTP 协议来下载所需的工件？

这是我的 POM“Wagon”部分：

```
...
    <extensions>
        <extension>
            <groupId>org.apache.maven.wagon</groupId>
            <artifactId>wagon-ftp</artifactId>
            <!-- I tried with older versions also-->
            <version>2.2</version>
        </extension>
    </extensions>
</build>
<repositories>
    <repository>
        <id>myrepo</id>
        <name>my Maven Repository</name>
        <url>ftp://ftp.myftpadress.fr/dev/M2Repo/</url>
        <layout>default</layout>
        <releases>
            <enabled>true</enabled>
        </releases>
        <snapshots>
            <enabled>true</enabled>
        </snapshots>
    </repository>
</repositories>
<distributionManagement>
    <repository>
        <id>myrepo</id>
        <name>my Maven Repository</name>
        <url>ftp://ftp.myftpadress.fr/dev/M2Repo/</url>
        <uniqueVersion>false</uniqueVersion>
    </repository>
    <snapshotRepository>
        <id>myrepo</id>
        <name>my Maven Repository</name>
        <url>ftp://ftp.myftpadress.fr/dev/M2Repo/</url>
        <uniqueVersion>false</uniqueVersion>
    </snapshotRepository>
</distributionManagement> 
```

我在 settings.xml 中也有所需的信息，这没关系，因为工件部署有效。

```
<servers>
    <server>
        <id>myrepo</id>
        <username>myuser</username>
        <password>mypassword</password>
    </server>
</servers> 
```

我使用以下 maven 和 Java 版本：
Apache Maven 3.0.4 (r1232337; 2012-01-17 03:44:56-0500)
Maven home: D:\maven\apache-maven-3.0.4\bin..
Java版本：1.7.0_09，供应商：Oracle Corporation
Java 主页：D:\Java\jdk1.7.0_09\jre
默认语言环境：fr_CA，平台编码：Cp1252
操作系统名称：“windows 7”，版本：“6.1”，arch：“ amd64"，家庭："windows"

非常感谢！新年快乐...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:22:58.550

我不认为你能做到这一点。Maven 通过 HTTP 解决它的依赖关系。您可以通过 FTP、SCP、HTTP 和 DAV 等不同的协议上传它们，但它通过 HTTP/HTTPS 解析它们。

# apache - Running Apache HTTP on SSL with

> ID：14146370
> 
> 赞同：0
> 
> 时间：2013-01-03T20:05:56.747
> 
> 标签：apache, https, jboss

I have successfully implemented the two different jboss 5 instaces with Apache HTTP Server and can access the application through the HTTP server (i.e. `http://localhost:8089`) where my http server is listening on port 8089 This was the smooth case. But when talking about HTTP Secured layer have enabled the Apache HTTP SSL by following the steps provided on [this page](https://stackoverflow.com/questions/4221874/how-do-i-create-https-for-localhost-apache) and on default secure port (i.e. 443) now i can access the HTTP Server from secure layer by url: `https://localhost/`. But when i hit my jboss application, I ended up with following error in browser:

Not Found

The requested URL /myApp was not found on this server.

can anyone let me know how to deal with this?

Thanks

# python - Porting a C library to Python via ctypes

> ID：14146373
> 
> 赞同：2
> 
> 时间：2013-01-03T20:06:08.027
> 
> 标签：python, c, ctypes, porting

I've read in a lot of places that C-libraries can be ported to or written in python using the ctypes module from the standard library.

I've gone through the help('ctypes') page and from what I could gather I can create some of the C structures in Python, but my question is how do I use these to access the underlying system calls? For eg. when trying to port something like 'sys/if.h' to Python?

Can someone point me to good resources/documentation regarding the same?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T20:34:43.123

如果您想访问系统调用，您可以执行以下操作：

```
>>> from ctypes import CDLL
>>> libc = CDLL('libc.so.6')
>>> print libc.strlen('abcde')
5 
```

参考：[http ://blog.bstpierre.org/using-pythons-ctypes-to-make-system-calls](http://blog.bstpierre.org/using-pythons-ctypes-to-make-system-calls)

**或者（这是棘手的部分）**

将此处概述的系统调用包装到您的 C 代码中：

[如何在 linux 中重新实现（或包装）系统调用函数？](https://stackoverflow.com/questions/3662856/how-to-reimplement-or-wrap-a-syscall-function-in-linux)

并且，然后编写一个将由 CTypes 使用的兼容源代码文件，如下所示：

[http://www.scipy.org/Cookbook/Ctypes](http://www.scipy.org/Cookbook/Ctypes)

我希望这有帮助。

# postgresql - Glassfish + Postgres 无法 ping 连接池

> ID：14146379
> 
> 赞同：11
> 
> 时间：2013-01-03T20:06:31.477
> 
> 标签：postgresql, netbeans, glassfish-3

我尝试使用 Glassfish 3.1 和 Postgres 为 Web 应用程序制作登录页面。我有本地数据库（本地主机：5432）。这是我的连接池：

```
Pool Name:pacjentauth
Resource Type:javax.sql.DataSource
Datasource Classname:org.postgresql.ds.PGSimpleDataSource
Driver Classname: [nothing here] 
```

portNumber、ServerName、用户和密码都可以。这是我得到的错误：

```
[#|2013-01-03T20:13:44.110+0100|WARNING|glassfish3.1.2|javax.enterprise.system.container.web.com.sun.web.security|_ThreadID=113;_ThreadName=Thread-2;|WEB9102: Web Login Failed: com.sun.enterprise.security.auth.login.common.LoginException: Login failed: Security Exception|#]

[#|2013-01-03T20:21:54.567+0100|WARNING|glassfish3.1.2|org.apache.catalina.connector.Request|_ThreadID=50;_ThreadName=Thread-2;|PWC4011: Unable to set request character encoding to UTF-8 from context , because request parameters have already been read, or ServletRequest.getReader() has already been called|#]

[#|2013-01-03T20:21:54.924+0100|WARNING|glassfish3.1.2|org.apache.catalina.connector.Request|_ThreadID=38;_ThreadName=Thread-2;|PWC4011: Unable to set request character encoding to UTF-8 from context , because request parameters have already been read, or ServletRequest.getReader() has already been called|#]

[#|2013-01-03T20:21:54.976+0100|WARNING|glassfish3.1.2|org.apache.catalina.connector.Request|_ThreadID=34;_ThreadName=Thread-2;|PWC4011: Unable to set request character encoding to UTF-8 from context , because request parameters have already been read, or ServletRequest.getReader() has already been called|#]

[#|2013-01-03T20:21:55.032+0100|WARNING|glassfish3.1.2|org.apache.catalina.connector.Request|_ThreadID=49;_ThreadName=Thread-2;|PWC4011: Unable to set request character encoding to UTF-8 from context , because request parameters have already been read, or ServletRequest.getReader() has already been called|#]

[#|2013-01-03T20:21:55.084+0100|WARNING|glassfish3.1.2|org.apache.catalina.connector.Request|_ThreadID=50;_ThreadName=Thread-2;|PWC4011: Unable to set request character encoding to UTF-8 from context , because request parameters have already been read, or ServletRequest.getReader() has already been called|#]

[#|2013-01-03T20:21:55.691+0100|INFO|glassfish3.1.2|org.glassfish.admingui|_ThreadID=38;_ThreadName=Thread-2;|Redirecting to /common/security/realms/realms.jsf|#]

[#|2013-01-03T20:21:55.751+0100|INFO|glassfish3.1.2|org.glassfish.admingui|_ThreadID=49;_ThreadName=Thread-2;|Admin Console: Initializing Session Attributes...|#]

[#|2013-01-03T20:22:06.541+0100|SEVERE|glassfish3.1.2|javax.enterprise.resource.resourceadapter.com.sun.gjc.util|_ThreadID=163;_ThreadName=Thread-2;|RAR5099 : Wrong class name or classpath for Datasource Object 
java.lang.ClassNotFoundException: org.postgresql.ds.PGSimpleDataSource
    at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:264)
    at com.sun.gjc.common.DataSourceObjectBuilder.getDataSourceObject(DataSourceObjectBuilder.java:285)
    at com.sun.gjc.common.DataSourceObjectBuilder.constructDataSourceObject(DataSourceObjectBuilder.java:114)
    at com.sun.gjc.spi.ManagedConnectionFactory.getDataSource(ManagedConnectionFactory.java:1307)
    at com.sun.gjc.spi.DSManagedConnectionFactory.getDataSource(DSManagedConnectionFactory.java:163)
    at com.sun.gjc.spi.DSManagedConnectionFactory.createManagedConnection(DSManagedConnectionFactory.java:102)
    at com.sun.enterprise.connectors.service.ConnectorConnectionPoolAdminServiceImpl.getUnpooledConnection(ConnectorConnectionPoolAdminServiceImpl.java:697)
    at com.sun.enterprise.connectors.service.ConnectorConnectionPoolAdminServiceImpl.testConnectionPool(ConnectorConnectionPoolAdminServiceImpl.java:426)
    at com.sun.enterprise.connectors.ConnectorRuntime.pingConnectionPool(ConnectorRuntime.java:1086)
    at org.glassfish.connectors.admin.cli.PingConnectionPool.execute(PingConnectionPool.java:130)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:348)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:363)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1085)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:95)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1291)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1259)
    at org.glassfish.admin.rest.ResourceUtil.runCommand(ResourceUtil.java:214)
    at org.glassfish.admin.rest.resources.TemplateExecCommand.executeCommand(TemplateExecCommand.java:127)
    at org.glassfish.admin.rest.resources.TemplateCommandGetResource.processGet(TemplateCommandGetResource.java:78)
    at sun.reflect.GeneratedMethodAccessor186.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.jersey.spi.container.JavaMethodInvokerFactory$1.invoke(JavaMethodInvokerFactory.java:60)
    at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$ResponseOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:205)
    at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)
    at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:288)
    at com.sun.jersey.server.impl.uri.rules.SubLocatorRule.accept(SubLocatorRule.java:134)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.SubLocatorRule.accept(SubLocatorRule.java:134)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1469)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1400)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1349)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1339)
    at com.sun.jersey.server.impl.container.grizzly.GrizzlyContainer._service(GrizzlyContainer.java:182)
    at com.sun.jersey.server.impl.container.grizzly.GrizzlyContainer.service(GrizzlyContainer.java:147)
    at org.glassfish.admin.rest.adapter.RestAdapter.service(RestAdapter.java:148)
    at com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:179)
    at com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$Hk2DispatcherCallable.call(ContainerMapper.java:354)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)
|#]

[#|2013-01-03T20:22:06.542+0100|WARNING|glassfish3.1.2|javax.enterprise.resource.resourceadapter.com.sun.enterprise.connectors.service|_ThreadID=163;_ThreadName=Thread-2;|RAR8054: Exception while creating an unpooled [test] connection for pool [ pacjentauth ], Class name is wrong or classpath is not set for : org.postgresql.ds.PGSimpleDataSource|#]

[#|2013-01-03T20:22:06.546+0100|SEVERE|glassfish3.1.2|org.glassfish.admingui|_ThreadID=161;_ThreadName=Thread-2;|RestResponse.getResponse() gives FAILURE.  endpoint = 'http://localhost:4848/management/domain/resources/ping-connection-pool.json'; attrs = '{id=pacjentauth}'|#] 
```

有什么想法可能是错的吗？如果没有足够的信息请告诉我你需要什么。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-04T13:48:53.690

好的，这都是关于 jar 的。我复制了这些文件：

```
postgresql-9.2-1002.jdbc4
postgresql-9.2-1002.jdbc3 
```

到`C:\Users\epcs\GlassFish_Server\glassfish\domains\epacjent\lib`它终于起作用了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T20:25:46.503

您是否尝试将 Postgres JDBC 驱动程序 jar 放入 GlassFish lib 目录？使用 MySQL，我们必须下载 MySQL JDBC 驱动程序并将 jar 文件复制到 `/opt/glassfishv3/glassfish/lib`.

# android - How to change ListView item before it is rendered

> ID：14146380
> 
> 赞同：0
> 
> 时间：2013-01-03T20:06:38.580
> 
> 标签：android

I have following code that works fine when my ListView is already rendered (eg. when fired by onClick events, etc.)

```
TextView tv = (TextView)list.getChildAt(position);  //list is my ListView
if (tv!=null) {
    tv.setPaintFlags(tv.getPaintFlags() | Paint.STRIKE_THRU_TEXT_FLAG);
} 
```

However, sometimes I need to apply this STRIKE_THRU_TEXT_FLAG flag to some items of ListView when activity is being restored (after rotation, restart...). If I try to run this code in **onCreate** or **onStart** methods then `list.getChild(position)` returns **null** because no ListView item is visible yet (in fact screen is black at this time and actual drawing seems to be done in some later function).

Is there any easy way how to get around this? Maybe **getChild** function is not the best for this case...Or would you override rendering function of the ListView to make it work (seems like overkill to me)? Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:18:36.823

不要那样修改视图本身；修改表示该列表项的实际数据对象（例如，如果您的 ListView 由 ArrayAdapter 支持，则这将是该列表位置的数组项）。您可以设置一个标志或属性来表示该项目应该以不同的方式显示，然后将一些条件代码添加到您的适配器的`getView()`方法中，以根据该列表项对象的属性以适当的样式显示文本。

然后，您可以让视图在下次显示时相应地呈现，或者通过调用`notifyDataSetChanged()`列表适配器自己触发重绘。

# visual-studio-2010 - mobile web application visual studio vs dreamweaver

> ID：14146387
> 
> 赞同：0
> 
> 时间：2013-01-03T20:07:02.997
> 
> 标签：visual-studio-2010, dreamweaver, mobile-website

Basically as the title says. I have visual studio 2010 and 2012 already and I was wondering if dreamweaver might be better to develop a mobile web application. I dont have dreamweaver but I will purchase it if it is better to use. I have developed mobile apps and web applications but this will be my first mobile web application so im stuck with what to use. Preferably get the mobile web app up and running as quickly as possible as I only have a couple of months

# apache - 301 Redirect using .htaccess

> ID：14146391
> 
> 赞同：1
> 
> 时间：2013-01-03T20:07:19.133
> 
> 标签：apache, .htaccess, redirect, url-rewriting, http-status-code-301

I had a system migration on my website and approximately 400 links got permanently changed. I'm using the following `Redirect` in `.htaccess` file for redirecting old links to new links.

`Redirect 301 /old-folder/old-product.html /new-folder/new-product.html`

I'm planning to do the similar thing to all 400 links.

**My problem:** Since I'm all having these Redirect statements in one .htaccess file, will there be any performance issues? Is it okay to add so many `Redirect` statements in one .htaccess file? Are there any side effects?

**Note:** there is no fixed pattern in the old and new links so I can't use `RewriteRule`.

# php - Is there a way to get the arguments supplied to a php function?

> ID：14146392
> 
> 赞同：0
> 
> 时间：2013-01-03T20:07:20.160
> 
> 标签：php

Is there a way to get the parameters passed to a php function?

fill in the blank if its possible:

```
function foo(){
    var_dump( SOME_MAGICAL_FUNCTION_THAT_GETS_ALL_PARAMETERS_INTO_AN_ARRAY );
}
foo('a', 'b', 'c', 1, 2, 3); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T20:08:39.567

是的，使用 PHP 的内置函数[func_get_args()](http://php.net/manual/en/function.func-get-args.php)

这是 PHP 文档中的一个示例：

```
function foo()
{
    $numargs = func_num_args();
    echo "Number of arguments: $numargs<br />\n";
    if ($numargs >= 2) {
        echo "Second argument is: " . func_get_arg(1) . "<br />\n";
    }
    $arg_list = func_get_args();
    for ($i = 0; $i < $numargs; $i++) {
        echo "Argument $i is: " . $arg_list[$i] . "<br />\n";
    }
}

foo(1, 2, 3); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T20:08:14.783

[func_get_args()](http://php.net/func_get_args)正是这样做的。

# c++ - boost's load_construct_data and serializing derived classes through pointer to base

> ID：14146393
> 
> 赞同：2
> 
> 时间：2013-01-03T20:07:21.483
> 
> 标签：c++, derived, boost-serialization

I have three classes:

```
class A
{
private:
    friend class boost::serialization::access;

    template<class Archive>
    void serialize(Archive & ar, const unsigned int version)
    {
        ar & this->id & this->somefield;
    }
protected:
    A() {} // just for boost, normally I create this class with non-default constructor
    int id;
    Sometype somefield;
public:
    A(unsigned int id);
    // blah blah, also some virtual methods
};

// _____________________ CLASS B

class B : public A
{
private:
    friend class boost::serialization::access;

    template<class Archive> inline friend void load_construct_data(Archive &ar, B *t, const unsigned int file_version);
    template<class Archive> inline friend void save_construct_data(Archive &ar, const B *t, const unsigned int file_version);

    B(unsigned int id, Sometype somefield, Sometype some_new_field1, Sometype some_new_field2);

    Sometype some_new_field1;
    Sometype some_new_field2;

    template<class Archive>
    void serialize(Archive & ar, const unsigned int version) {
        ar & boost::serialization::base_object<A>(*this);
    }

public:
    // blah blah, also virtual methods
};

template<class Archive>
inline void save_construct_data(
    Archive & ar, const B * t, const unsigned int file_version
){
    ar << t->id << t->somefield << t->some_new_field1 << t->some_new_field2;
}

template<class Archive>
inline void load_construct_data(
    Archive & ar, B * t, const unsigned int file_version
){
    unsigned int _id;
    Sometype _somefield;

    Sometype _some_new_field1;
    Sometype _some_new_field2;

    ar >> _id >> _somefield >> _some_new_field1 >> _some_new_field2;

    ::new(t)B(_id, _somefield, _some_new_field1, _some_new_field2);
}

// _____________________ CLASS C

class C : public A
{
private:
    friend class boost::serialization::access;

    template<class Archive> inline friend void load_construct_data(Archive &ar, C *t, const unsigned int file_version);
    template<class Archive> inline friend void save_construct_data(Archive &ar, const C *t, const unsigned int file_version);

    C(unsigned int id, Sometype somefield, Sometype some_new_field3, Sometype some_new_field4);

    Sometype some_new_field3;
    Sometype some_new_field4;

    template<class Archive>
    void serialize(Archive & ar, const unsigned int version) {
        ar & boost::serialization::base_object<A>(*this);
    }

public:
    // blah blah, also virtual methods
};

template<class Archive>
inline void save_construct_data(
    Archive & ar, const C * t, const unsigned int file_version
){
    ar << t->id << t->somefield << t->some_new_field3 << t->some_new_field4;
}

template<class Archive>
inline void load_construct_data(
    Archive & ar, C * t, const unsigned int file_version
){
    unsigned int _id;
    Sometype _somefield;

    Sometype _some_new_field3;
    Sometype _some_new_field4;

    ar >> _id >> _somefield >> _some_new_field3 >> _some_new_field4;

    ::new(t)C(_id, _somefield, _some_new_field3, _some_new_field4);
} 
```

I need to use non-default constructors, so I need load/save_construct_data overrides. Classes B and C are serialized and deserialized through vector, hence I use the macro BOOST_CLASS_EXPORT() (in another part of code, irrelevant, I suppose). My problem is, when I deserialize an archive made with above code, I get duplicate pointers in my vector (each pointing at the same area in memory) - it might be one for base and one for derived clas. I can't find anywhere, how to use load/save_construct data, when saving my objects through a pointer to base class without making duplicates. I spent weeks on this and my deadline is approaching very quickly, any help greatly appreciated :)

**EDIT:** I should mention one more thing: when I remove contents of "serialize" method from base class (only contents, not the method itself), after deserialization I get nothing, and when I remove parts with "base_object", archive throws an exception "unregistered void cast".

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-04T14:05:06.547

Boost 手册制作得不是很好，我在“模板序列化”部分找到了我的答案:)

我只需要将基类的序列化方法留空，并在派生类中放置序列化方法

```
boost::serialization::void_cast_register<derived, base>(); 
```

供将来参考 - 现在一切正常:)

# django - Django 会话在浏览器关闭或一段时间后过期

> ID：14146396
> 
> 赞同：9
> 
> 时间：2013-01-03T20:07:27.853
> 
> 标签：django, session, session-cookies

Django 文档指出：

> 您可以通过 SESSION_EXPIRE_AT_BROWSER_CLOSE 设置控制会话框架是使用浏览器长度会话还是使用持久会话。
> 
> 如果 SESSION_EXPIRE_AT_BROWSER_CLOSE 设置为 True，Django 将使用浏览器长度的 cookie——一旦用户关闭他或她的浏览器，cookie 就会过期。如果您希望人们每次打开浏览器时都必须登录，请使用此选项。
> 
> 此设置是全局默认设置，可以通过显式调用 request.session 的 set_expiry() 方法在每个会话级别覆盖，如上文在视图中使用会话中所述。

因此，当我在设置文件中将 SESSION_EXPIRE_AT_BROWSER_CLOSE 设置为 True 时，这确实是它的作用。这很好，因为我希望用户的会话在浏览器关闭时过期。但是，我还希望用户的会话在闲置 15 分钟后过期。如果我使用上面提到的 set_expiry() ，则 SESSION_EXPIRE_AT_BROWSER_CLOSE 将被覆盖，因此如果用户在到期前关闭浏览器然后重新打开浏览器，则会话仍然有效。不是我想要的。

此外， set_expiry() 的文档说会话在设置的***不活动***时间后过期。这实际上不是真的。不管我的用户是否在网站上点击，它都会过期。

总而言之，我想做的是：

1.  将我的会话配置为如果用户关闭浏览器，会话将自动过期。
2.  设置随活动更新的会话到期长度，即如果用户在站点上执行其他操作，则重置到期。

想法/建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T20:25:48.553

正如 Jiaaro 在[此答案](https://stackoverflow.com/questions/3024153/how-to-expire-session-due-to-inactivity-in-django)中建议的那样，您可以在每个请求中使用`SESSION_EXPIRE_AT_BROWSER_CLOSE`并设置会话时间戳，并添加一个自定义`Middleware`来处理不活动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-13T06:07:00.143

来自文档[https://docs.djangoproject.com/en/1.8/topics/http/sessions/#browser-length-sessions-vs-persistent-sessions](https://docs.djangoproject.com/en/1.8/topics/http/sessions/#browser-length-sessions-vs-persistent-sessions)

> 某些浏览器（例如 Chrome）提供允许用户在关闭并重新打开浏览器后继续浏览会话的设置。在某些情况下，这可能会干扰 SESSION_EXPIRE_AT_BROWSER_CLOSE 设置并防止会话在浏览器关闭时过期。请在测试启用了 SESSION_EXPIRE_AT_BROWSER_CLOSE 设置的 Django 应用程序时注意这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-03T10:54:14.240

当用户关闭浏览器时会话过期：

> 此要求通过将**SESSION_EXPIRE_AT_BROWSER_CLOSE**设置为**True**来实现。
> 
> [参考](https://stackoverflow.com/q/3024153/3702377)

会话在一段时间不活动后过期：

> **SESSION_COOKIE_AGE**是会话 cookie 的年龄，以秒为单位。
> 默认值：1209600（2 周，以秒为单位）
> 
> [参考](https://docs.djangoproject.com/en/1.11/ref/settings/#std:setting-SESSION_COOKIE_AGE)

你应该在你的`setting/__init__.py`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-09T18:59:58.587

Search engine cache make sure then the session will be closed when **TOGETHER** with `SESSION_EXPIRE_AT_BROWSER_CLOSE = TRUE`

```
SESSION_ENGINE = 'django.contrib.sessions.backends.cache' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-28T12:55:29.647

By default, **SESSION_EXPIRE_AT_BROWSER_CLOSE** is set to False, which means session cookies will be stored in users’ browsers for as long as **SESSION_COOKIE_AGE**. Use this if you don’t want people to have to log in every time they open a browser.

If **SESSION_EXPIRE_AT_BROWSER_CLOSE** is set to True, Django will use browser-length cookies – cookies that expire as soon as the user closes their browser. Use this if you want people to have to log in every time they open a browser.

# jsf-2 - Primefaces: Ajax status stops on redirection to new page

> ID：14146398
> 
> 赞同：1
> 
> 时间：2013-01-03T20:07:35.327
> 
> 标签：jsf-2, primefaces

I have **page1.jsf** and **page2.jsf**. Page1 has `<p:ajaxstatus/>` with custom spinner in it . When an action is performed on page 1 and the user is redirected to page 2, the spinner starts and stops immediately but page1 remains as it is and after few seconds page2 is loaded and is rendered.

How can I keep the spinner spinning until page2 is fully rendered.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:14:09.263

我假设您正在为 page1 使用`@ViewScoped`bean。

当您重定向到 page2 时，视图被创建到 page2，并且 page1 的视图范围 bean 被取消引用/销毁。因此忽略对该 bean 的 Ajax 请求。

我知道的唯一解决方案是将 bean 设置为`page1`as `@SessionScoped`，但这可能会影响您的应用程序的行为。

# java - How do I pass a constructor parameter to another object?

> ID：14146402
> 
> 赞同：2
> 
> 时间：2013-01-03T20:07:53.813
> 
> 标签：java, oop, constructor

I hope this illustration will make my question clear:

```
class someThread extends Thread{
        private int num;
        public Testing tobj = new Testing(num); //How can I pass the value from the constructor here? 

        public someThread(int num){ 
            this.num=num;
        }

        void someMethod(){
            someThread st = new someThread(num);
            st.tobj.print(); //so that I can do this
        }   
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T20:10:13.723

一方面，从 IMO 开始，拥有一个公共领域是一个坏主意。（你的名字也不理想……）

您需要做的就是*在构造函数*中初始化它而不是内联：

```
private int num;
private final Testing tobj;

public someThread(int num) {
    this.num = num;
    tobj = new Testing(num);
} 
```

（您不必将其设为最终版本 - 我只是更愿意在可能的情况下将变量设为最终版本......）

当然，如果你不需要`num`其他任何东西，你根本不需要它作为一个字段：

```
private final Testing tobj;

public someThread(int num) {
    tobj = new Testing(num);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:10:08.810

为什么不在构造函数中初始化你的对象？

```
 public Testing tobj ; //How can I pass the value from the constructor here? 

        public someThread(int num){ 
            this.num=num;
            tobj  = new Testing(this.num);
        } 
```

# windows-phone-8 - 带有 C++/CLI 代码接口的 ref 关键字

> ID：14146420
> 
> 赞同：1
> 
> 时间：2013-01-03T20:08:51.207
> 
> 标签：windows-phone-8, c++-cx

我正在为 Windows Phone 8 编写代码，并且正在尝试了解跨越 C#/C++ 代码障碍的来龙去脉。

假设我在 C# 端有两个数组，`float[]`我们将它们称为. 我想对它们进行逐个元素的添加。由于这是在实时系统中，（音频处理）我不想冒险在我的音频处理例程中进行分配和释放，所以我想要一些类似. 由于我明确地学习如何从 C# 调用 C++，所以我不会只用 C# 编写 for 循环，我会用 C++ 编写它，如下所示：`data1``data2``data1[i] += data2[i]`

```
void LibFilter::mixIn( Platform::Array<float>^ * data1, const Platform::Array<float>^ data2 ) {
    auto outArray = (*data1);

    // Don't do anything if we don't have matching lengths
    if( data2->Length != outArray->Length )
        return;

    // Sum data2 into outArray (which is just a dereferenced data1)
    for( unsigned int i=0; i<outArray->Length; ++i ) {
        outArray[i] += data2[i];
    }
} 
```

这似乎对我有用，但话又说回来，我是 C++ 程序员，而不是 C# 程序员，显然这应该与`out`C# 中的关键字一起使用，这意味着它`data1`是一个空指针，无论传递的值如何在。我相信我想改用`ref`关键字，但我不知道如何使用 Windows Phone 8 SDK 来做到这一点。

关于如何在`ref`此处使用关键字或如何最好地构建它的建议将不胜感激，因为我仍在学习 C# 的最佳实践。谢谢你们！

**编辑：错误信息**

如果我只是尝试`libfilter.mixIn( ref data1, data2 );`从我的 C# 代码中使用，我会得到以下信息：

```
error CS1502: The best overloaded method match for 'libfilter.LibFilter.mixIn(out float[], float[])' has some invalid arguments
error CS1620: Argument 1 must be passed with the 'out' keyword 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T01:06:55.250

根据您的编辑，C++/CX 编译器为该方法生成的元数据似乎使用**out**关键字，而不是**ref**关键字。

无论如何，我根本不明白为什么您需要通过引用传递。Platform::Array 是可变的，所以即使它是按值传递的，你也可以修改它。以下 MSDN 文章有一个与您的代码类似的示例（请参阅“填充数组”部分）：

[http://msdn.microsoft.com/en-us/library/windows/apps/hh700131.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh700131.aspx)

# jquery - jQuery：如何使用 .length 属性

> ID：14146421
> 
> 赞同：0
> 
> 时间：2013-01-03T20:09:09.020
> 
> 标签：jquery

我一直在寻找 SO 和一般的网络，我似乎找不到一个简单的页面，他们用简单的文字和简单的例子解释如何使用该`.length`方法。

我需要帮助的很简单。

我有一个下拉菜单，这个菜单可以容纳 1、2、3 个项目到 20 个或更多。

我需要的是一种方法来检测是否有例如 1 到 10 个元素添加类`.one-ten`，如果有 11 到 20 个，则添加类`.eleven-twenty`，如果 21 或更多等，则添加以下类等.

我绝不是 jQuery 专家，但我尝试过这样做：

```
$('li').length == 10 $(function()); 
```

当然这不起作用，但它让你知道我需要完成什么。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:12:03.680

你有没有像下面这样尝试过，

```
var $li = $('li');
if ($li.length <= 10) { $li.addClass('one-ten'); }
else if ($li.length <= 20) { $li.addClass('eleven-twenty'); } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:11:41.283

`.length`不是方法，而是属性。您可以使用以下代码确定一个选择包含多少个选项：

```
var numOptions = $('#YourSelectID option').length

if(numOptions < 10) {
    // Code goes here
}
... 
```

# java - 在 Intellij IDEA 中使用热键为方法自动生成类型和对返回对象的引用

> ID：14146422
> 
> 赞同：6
> 
> 时间：2013-01-03T20:09:08.607
> 
> 标签：java, intellij-idea, keyboard-shortcuts, hotkeys

如何在**Intellij IDEA**中使用热键自动获取返回对象的类型？

很多时候你需要修改这样的行：

```
myinstance.getMyMethod(); 
```

在下面的：

```
IMySomeObject mysomeobject = myinstance.getMySomeObject(); 
```

我希望 IDEA 自己为我节省时间。我不想探索方法的签名，找到它的返回类型并使用特定类型的返回对象手动创建这个引用。这不方便。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-03T20:14:47.287

使用 Introduce Variable 重构。

选择

```
myinstance.getMyMethod(); 
```

按下`<ctrl>+<alt> + V`，您将看到一系列名称，例如

```
IMySomeObject mySomeObject = myinstance.getMySomeObject(); 
```

然后我选择`<Enter>`第一个选项通常很好。

我建议您查看 Refactor Menu 中的所有重构工具并了解它们的作用。

* * *

你可以输入`m`

![在此处输入图像描述](../Images/3e9d7d3d28766279fcffe823f958186f.png)

然后输入`.`

![在此处输入图像描述](../Images/b97ddd9ee733a1c03ea429fac86f6645.png)

然后`<Enter>`

![在此处输入图像描述](../Images/7f77fcc73b35878e45d1af3c980b294a.png)

然后按`<ctrl> + <alt> + V`

![在此处输入图像描述](../Images/a01033bb56029274a8e85a2779a756e9.png)

最后按`<Enter>`接受默认名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-09-09T05:46:44.937

除此之外的另一种方法`Introduce Variable`是使用他们的[后缀完成](https://blog.jetbrains.com/idea/2014/03/postfix-completion/)功能。

关键是`.var`在表达式后键入，然后按 Tab 键。

例如

```
myinstance.getMyMethod().var 
```

将光标放在 之后`.var`，按`ctrl + space`，然后按`tab`选择建议。然后你会得到：

```
IMySomeObject mySomeObject = myinstance.getMySomeObject(); 
```

顺便说一句，还有更多后缀补全选项；我发现这是一个非常方便的功能。

# vb.net - VB.Net 高亮文本事件处理程序

> ID：14146425
> 
> 赞同：0
> 
> 时间：2013-01-03T20:09:25.877
> 
> 标签：vb.net, event-handling, highlighting, selectedtext

我正在使用富文本框并希望获取用户将用鼠标突出显示的文本。VB.net 中是否有执行此操作的事件处理程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:12:37.993

它是 RichTextBox.SelectionChanged 事件。

你可以这样使用它：

```
Private Sub r1_SelectionChanged(sender As System.Object, e As System.EventArgs) Handles r1.SelectionChanged
    Me.Text = r1.SelectedText
End Sub 
```

# wordpress - 如何在不同的 php 文件中引用 $this->

> ID：14146429
> 
> 赞同：0
> 
> 时间：2013-01-03T20:09:37.257
> 
> 标签：wordpress, file, function, reference, subscribe

具体来说，我真的不知道自己在做什么，但我试图从另一个文件中引用 $this 。

我正在使用 Wordpress（订阅 2 插件）并尝试从插件中订阅特定类别并将其放入我自己的注册表单中。

这样做的能力已经在插件的设置中，所以我想把它们放在我自己的形式中，但它们看起来像这样：

```
$this->get_usermeta_keyname('s2_subscribed') 
```

所以我的问题：如何在我自己的文件中引用“$this”？我整个早上都在谷歌上搜索它，但我所有的结果都将“$this”视为“this”，并没有告诉我我想要什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:25:50.557

$this 指的是当前的类上下文。因此，如果您有一个名为 MyClass 的类，则可以在该类中使用 $this 访问函数和元素。在该类之外， $this 没有上下文并且不起作用，但是如果您已经实例化了该类并且函数或变量是公共的，那么您可以通过对该类的引用来访问它们。

例子：

```
<?php
Class MyClass {
    $class_var = "Class Var Value";
    function class_func_1() {
        print $this->class_var;
        $this->class_func_2();
    }

    function class_func_2() {
        print "Class Func 2";
    }
}
?> 
```

所以上面的虚拟类使用 $this 来引用它自己的元素。但是在课堂之外，你不能用这个来引用它们。但是如果我们实例化一个类的实例，我们可以通过对类实例的引用来访问它们：

```
<?php
print $this->class_var;  // Fails miserably
$this->class_func_1();   // Also fails

$class_instance = new MyClass();
print $class_instance->class_var; // Var access works
$class_instance->class_func_1();  // Call method works
?> 
```

由于这是一个 wordpress 功能，我很好奇您是否正在尝试访问插件（可能使用类）中的某些内容，或者可能是购买的主题中的某些内容。无论哪种方式，文件中的某处都应该有对类实例的引用。一旦你有了这个变量，你就可以访问类的动作和内容。

有了更多的信息，我想我们可能可以提供更好的方向......

* * *

更新：

好的，看来您正在使用 subscribe2 插件。在插件文件 ( `subscribe2.php`) 的底部是这一行：

```
$mysubscribe2 = new subscribe2(); 
```

这样做是创建一个指向类实例的全局变量。因此，`$this->method_name()`您可以使用`$mysubscribe2->method_name()`.

但是，查看您发布的文件 - 看起来您几乎抓住了插件代码的一部分并将其放入模板中。我不确定您要完成什么，但从这里看来您正走在一条崎岖的道路上......

# android - 满足android屏幕宽度所需的图像宽度

> ID：14146432
> 
> 赞同：1
> 
> 时间：2013-01-03T20:09:44.900
> 
> 标签：android, android-layout

在 android xml 文件或图形布局上

我想创建一个包含图像的图像视图。

我的问题是满足 Android Mobile 宽度所需的图像宽度（以像素为单位）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:12:17.553

只需在 ImageView 标签下的 xml 中写入

```
android:layout_width="fill_parent" 
```

就是这样

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:13:18.200

由于不同的 Android 设备具有不同的屏幕尺寸，您将无法设置绝对宽度来填充屏幕。您可以将`android:layout_width="match_parent"`其用作 ImageView 的宽度，它会自行调整大小以适合添加到的父视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:34:37.060

每个 android 设备的设备宽度不同。如果您想在设备上完成图像，则可能会根据图像宽度在四个边上拉伸或截断它。将图像设置为中心是一个好主意，因此它可以在所有设备上显示，或者您可能需要同一图像的不同尺寸，具体取决于设备的宽度和高度

# c - 使用 scanf 读取无符号字符

> ID：14146434
> 
> 赞同：23
> 
> 时间：2013-01-03T20:09:53.823
> 
> 标签：c, scanf

我正在尝试使用此代码读取 0 到 255 ( `unsigned char`) 之间的值。

```
#include<stdio.h>
int main(void)
{
    unsigned char value;

    /* To read the numbers between 0 to 255 */
    printf("Please enter a number between 0 and 255 \n");
    scanf("%u",&value);
    printf("The value is %u \n",value);

    return 0;
} 
```

我确实按预期收到了以下编译器警告。

```
警告：格式“%u”需要类型“unsigned int *”，但参数 2 的类型为“unsigned char *”

```

这是我对这个程序的输出。

```
请输入 0 到 255 之间的数字
45
值为 45
分段故障

```

运行此代码时，我确实遇到了分段错误。

**使用读取`unsigned char`值的最佳方法是什么`scanf`？**

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-01-03T20:46:16.033

说明`%u`符需要一个整数，当将其读入`unsigned char`. 您将需要使用说明`unsigned char`符`%hhu`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-03-23T09:53:59.517

对于 C99 之前的版本，我会考虑单独为此编写一个额外的函数，以避免由于 scanf 的未定义行为而导致的分段错误。

方法：

```
#include<stdio.h>
int my_scanf_to_uchar(unsigned char *puchar)
{
  int retval;
  unsigned int uiTemp;
  retval = scanf("%u", &uiTemp);
  if (retval == 1)   
  {
    if (uiTemp < 256) {
      *puchar = uiTemp;
    }
    else {
      retval = 0; //maybe better something like EINVAL
    }
  }
  return retval; 
} 
```

然后替换`scanf("%u",`为`my_scanf_to_uchar(`

希望这不是题外话，因为我仍在使用`scanf`，而不是其他功能，例如`getchar`:)

另一种方法（没有额外的功能）

```
if (scanf("%u", &uiTemp) == 1 && uiTemp < 256) { value = uitemp; }
else {/* Do something for conversion error */} 
```

# c# - PropertyGrid - 获取所选位图的文件路径

> ID：14146439
> 
> 赞同：1
> 
> 时间：2013-01-03T20:10:10.400
> 
> 标签：c#, .net, winforms, bitmap, propertygrid

我将 a 设置为具有属性的`PropertyGrid`对象：`SelectedObject``Bitmap`

```
public class Obj
{   
    private Bitmap myimage;
    [Category("Main Category")]
    [Description("Your favorite image")]
    public Bitmap MyImage
    {
        get { return myimage; }
        set
        {
            myimage = value;
        }
    }
} 
```

这会自动显示`PropertyGrid`带有一个小按钮的属性，用户可以单击该按钮来选择图像。如何获取此图像的文件路径？

（另外，有什么办法可以覆盖弹出的对话框并放入我自己的对话框？我知道这是一个单独的问题，所以我可能会单独发布。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-10T22:40:28.620

> 如何获取此图像的文件路径？另外，有什么办法可以覆盖弹出的对话框并放入我自己的对话框？

要实现这两种方式，那就是创建一个新的`UITypeEditor`：

```
public class BitmapLocationEditor : UITypeEditor
{

} 
```

我覆盖了、`GetEditStyle`和`EditValue`方法。`GetPaintvalueSupported``PaintValue`

```
// Displays an ellipsis (...) button to start a modal dialog box
public override UITypeEditorEditStyle GetEditStyle(ITypeDescriptorContext context)
{
    return UITypeEditorEditStyle.Modal;
}

// Edits the value of the specified object using the editor style indicated by the GetEditStyle method.
public override object EditValue(ITypeDescriptorContext context,
                                 IServiceProvider provider,
                                 object value)
{
    // Show the dialog we use to open the file.
    // You could use a custom one at this point to provide the file path and the image.
    using (OpenFileDialog openFileDialog = new OpenFileDialog())
    {
        openFileDialog.Filter = "Image files (*.bmp | *.bmp;";

        if (openFileDialog.ShowDialog() == DialogResult.OK)
        {
            Bitmap bitmap = new Bitmap(openFileDialog.FileName);
            bitmap.SetPath(openFileDialog.FileName);

            return bitmap;
        }
    }

    return value;
}

// Indicates whether the specified context supports painting
// a representation of an object's value within the specified context.
public override bool GetPaintValueSupported(ITypeDescriptorContext context)
{
    return true;
}

// Paints a representation of the value of an object using the specified PaintValueEventArgs.
public override void PaintValue(PaintValueEventArgs e)
{
    if (e.Value != null)
    {
        // Get image
        Bitmap bmp = (Bitmap)e.Value;

        // This rectangle indicates the area of the Properties window to draw a representation of the value within.
        Rectangle destRect = e.Bounds;

        // Optional to set the default transparent color transparent for this image.
        bmp.MakeTransparent();

        // Draw image
        e.Graphics.DrawImage(bmp, destRect);
    }
} 
```

你的`Obj`类应该保持不变，除了添加一个属性来利用我们的新`BitmapLocationEditor`类：

```
public class Obj
{
    private Bitmap myImage;

    [Category("Main Category")]
    [Description("Your favorite image")]
    [Editor(typeof(BitmapLocationEditor), typeof(UITypeEditor))]
    public Bitmap MyImage
    {
        get { return myImage; }
        set
        {
            myImage = value;
        }
    }
} 
```

`SetPath`方法中使用的方法`EditValue`只是设置`Bitmap.Tag`属性的扩展方法。您可以稍后使用该`GetPath`方法来检索图像文件的实际路径。

```
public static class BitmapExtension
{
    public static void SetPath(this Bitmap bitmap, string path)
    {
        bitmap.Tag = path;
    }

    public static string GetPath(this Bitmap bitmap)
    {
        return bitmap.Tag as string;
    }
} 
```

[关于 PropertyGrid 的文章](http://www.codeproject.com/Articles/22717/Using-PropertyGrid)

# c - 使用 fseek() 查找用户输入的位置

> ID：14146440
> 
> 赞同：1
> 
> 时间：2013-01-03T20:10:12.200
> 
> 标签：c, fseek

我需要向用户询问一个ID Number，然后使用该功能`fseek()`找到用户输入的ID Number的位置，然后才能修改记录。我有这样的事情：

```
printf("Enter ID Card Number: \n");
scanf("%s", editCust.idNumber);
fseek(custFile, (editCust.idNumber -1)*sizeof(struct customer), SEEK_SET); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:17:52.647

不。

首先，替换：

> scanf("%s", editCust.idNumber);

为了

> scanf("%d", &editCust.idNumber);

%s 用于字符串值，%d 用于十进制值。

可以在[这里](http://en.cppreference.com/w/cpp/io/c/fscanf)找到很好的格式来源。

# c - C语言中错误的线程完成？

> ID：14146447
> 
> 赞同：0
> 
> 时间：2013-01-03T20:10:52.693
> 
> 标签：c, multithreading

我编译了这段代码，它创建的第 99 个线程不断创建多个编号为 99 的线程。相反，如果我插入 1-10 或较小的值，那么结果是非常正常的。

这是代码。

```
#include <stdio.h>
#include <pthread.h>
#include <unistd.h>

pthread_mutex_t m=PTHREAD_MUTEX_INITIALIZER;
pthread_attr_t attr;

void* test(void *a)
{
    int i=*((int *)a);
    printf("The thread %d has started.\n",i);
    pthread_mutex_lock(&m);
    usleep(10000);
    printf("The thread %d has finished.\n",i);
    pthread_mutex_unlock(&m);
    pthread_exit(NULL);

}

int main()
{
    int i=0,j=0;
    pthread_attr_setdetachstate(&attr,PTHREAD_CREATE_JOINABLE);
    pthread_t thread[100];

    for (i=0;i<100;i++)
    {
        j=i;
        pthread_create(&thread[i],&attr,test,&j);

    }

    for (i=0;i<100;i++)
        pthread_join(thread[i],NULL);
    return 0;
} 
```

我得到：

```
..../*Normal Results*/
The thread 99 has finished.
The thread 99 has finished.
The thread 99 has finished.
The thread 99 has finished.
The thread 99 has finished.
The thread 99 has finished. 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:13:15.113

每个线程都被传递给主线程中相同的堆栈位置 ( `j`)。如果没有进一步的同步，每个线程将被调度并`j`在打印其值之前运行和访问的时间是不确定的。

有很多方法可以从每个线程中打印出一个唯一的数字，包括

1.  malloc 一个在主线程中包含（或者是）这个数字的结构。将其传递给负责释放它的子线程
2.  （下面由 Brian Roche 建议）声明一个包含 100 个整数的数组，其值为 0、1、2 等。将不同数组项的地址传递给每个线程。
3.  让每个线程锁定一个互斥锁，然后复制/增加一个全局计数器。互斥锁可以传递到线程或另一个全局
4.  将信号量传递给每个线程，在访问该数字后发出信号。在主线程中等待这个信号量

请注意，选项 3 和 4 涉及线程的序列化启动。如果你做了很多这样的事情，那么运行多个线程就没有什么意义了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:17:17.650

您需要保留所有的 theadIds

```
int indexes[PTHREAD_COUNT];

for (i=0;i<100;i++) {
    indexes[i] = i;
    pthread_create(&thread[i], &attr, test, &indexes[i]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T20:19:21.697

`i`与您的主代码中的地址相同`j`，并且您在线程中休眠了 30 毫秒。所以所有线程都有时间运行，直到第一次互斥调用，然后它们都停止（稍微多一点）30ms，然后打印它们已经完成。当然，`i`在主循环中现在是 99，因为您已经完成了 pthread_join 循环。

您需要有一个“j”值数组[假设您希望所有线程独立运行]。或者做点别的。这一切都取决于你真正想要做什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T20:20:14.510

您正在传递与指向数据 a 的指针相同的内存位置 (&j)。

当线程启动时，它们打印出刚刚分配给 j 的值，看起来没问题

但随后只有一个得到锁并进入睡眠状态，所有其他人都因此被封锁。当噩梦结束时，内存位置“a”当然有一个 int 值 99。

# html - 如何为 KineticJS 形状添加标签？

> ID：14146450
> 
> 赞同：1
> 
> 时间：2013-01-03T20:11:07.793
> 
> 标签：html, canvas, kineticjs

我正在使用 KineticJs 创建带有一些文本标签的形状（可与形状一起拖动）。[教程](http://www.html5canvastutorials.com/kineticjs/html5-canvas-kineticjs-circle-tutorial/)上没有任何信息。我也没有发现[这](https://stackoverflow.com/questions/13324514/kineticjs-rect-filltext)是一种非常干净的方法。这样做的好方法是什么？下面的代码只创建形状。

HTML：

```
<html>
    <body>
        <div id="container"> </div>
        <button id="new_state">New State</button>
    </body>
</html> 
```

JS：

```
$(document).bind("ready", function () {
    stage = new Kinetic.Stage({
        container: 'container',
        width: 600,
        height: 500
    });

    layer = new Kinetic.Layer();

    $('#new_state').click(function() {
        newState();
    });

});

newState = function() {
    var circle = new Kinetic.Circle({
        x: stage.getWidth()/2,
        y: stage.getHeight()/2,
        radius: 20,
        fill: 'white',
        stroke: 'black',
        strokeWidth: 2,
        text: 'tet',
        draggable: true
    });
    circle.on('mouseover', function() {
        $('body').css('cursor', 'pointer');
    });

    circle.on('mouseout', function() {
        $('body').css('cursor', 'default');
    });

    layer.add(circle);
    stage.add(layer);
}; 
```

[JsFiddle在这里](http://jsfiddle.net/ajmartin/e8KwC/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T22:45:19.830

您只需将圆圈和文本都添加到组中，并使组可拖动。分组时，这些对象充当一个项目。

```
var group = new Kinetic.Group({
    draggable: true
});
group.add(circle);
group.add(text); 
```

然后将组添加到图层

```
 layer.add(group); 
```

[http://jsfiddle.net/e8KwC/1/](http://jsfiddle.net/e8KwC/1/)

# perl - 从 URL 列表中删除仅顶级目录的 URL？

> ID：14146451
> 
> 赞同：3
> 
> 时间：2013-01-03T20:11:12.117
> 
> 标签：perl, url

我有一个难以研究的问题，因为我不知道如何在搜索引擎上正确提问。

我有一个 URL 列表。我希望有一些自动化的方式（首选 Perl）来浏览列表并删除所有仅作为顶级目录的 URL。

例如，我可能有这个列表：

[http://www.example.com/hello.html](http://www.example.com/hello.html)
[http://www.foo.com/this/thingrighthere.html](http://www.foo.com/this/thingrighthere.html)

在这种情况下，我想从我的列表中删除 example.com，因为它要么只是顶级目录，要么它们引用顶级目录中的文件。

我试图弄清楚如何做到这一点。我的第一个想法是，计算正斜杠，如果有两个以上，从列表中删除 URL。但是你有尾随斜杠，所以这是行不通的。

任何想法或想法将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T20:23:20.207

像这样的东西：

```
use URI::Split qw( uri_split ); 
my $url = "http://www.foo.com/this/thingrighthere.html";
my ($scheme, $auth, $path, $query, $frag)  = uri_split( $url );
if (($path =~ tr/\///) > 1 ) {
    print "I care about this $url";
} 
```

[http://metacpan.org/pod/URI::Split](http://metacpan.org/pod/URI::Split)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-03T20:26:57.860

您*可以*使用正则表达式来做到这一点，但让[URI](https://metacpan.org/module/URI)库为您做这件事的工作要少得多。您不会被路径前后的有趣方案、转义和额外的东西（查询、锚点、授权......）所吸引。path_segments() 表示路径的方式有些棘手。有关详细信息，请参阅下面的评论和[URI 文档](https://metacpan.org/module/URI#COMMON-METHODS)。

我假设这`http://www.example.com/foo/`被认为是顶级目录。根据需要进行调整，但这是您必须考虑的事情。

```
#!/usr/bin/env perl

use URI;
use File::Spec;

use strict;
use warnings;

use Test::More 'no_plan';

sub is_top_level_uri {
    my $uri = shift;

    # turn it into a URI object if it isn't already
    $uri = URI->new($uri) unless eval { $uri->isa("URI") };

    # normalize it
    $uri = $uri->canonical;

    # split the path part into pieces
    my @path_segments = $uri->path_segments;

    # for an absolute path, which most are, the absoluteness will be
    # represented by an empty string.  Also /foo/ will come out as two elements.
    # Strip that all out, it gets in our way for this purpose.
    @path_segments = grep { $_ ne '' } @path_segments;

    return @path_segments <= 1;
}

my @filtered_uris = (
  "http://www.example.com/hello.html",
  "http://www.example.com/",
  "http://www.example.com",
  "https://www.example.com/",
  "https://www.example.com/foo/#extra",
  "ftp://www.example.com/foo",
  "ftp://www.example.com/foo/",
  "https://www.example.com/foo/#extra",
  "https://www.example.com/foo/?extra",
  "http://www.example.com/hello.html#extra",
  "http://www.example.com/hello.html?extra",
  "file:///foo",
  "file:///foo/",
  "file:///foo.txt",
);

my @unfiltered_uris = (
  "http://www.foo.com/this/thingrighthere.html",
  "https://www.example.com/foo/bar",
  "ftp://www.example.com/foo/bar/",
  "file:///foo/bar",
  "file:///foo/bar.txt",
);

for my $uri (@filtered_uris) {
    ok is_top_level_uri($uri), $uri;
}

for my $uri (@unfiltered_uris) {
    ok !is_top_level_uri($uri), $uri;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:25:22.783

使用 CPAN 中的 URI 模块。 [http://search.cpan.org/dist/URI](http://search.cpan.org/dist/URI)

这是一个已解决的问题。人们已经编写、测试和调试了处理这个问题的代码。每当您遇到其他人可能不得不处理的编程问题时，请寻找可以为您解决的现有代码。

# asp.net - 如何在asp.net中创建文件下载的超链接？

> ID：14146452
> 
> 赞同：0
> 
> 时间：2013-01-03T20:11:14.207
> 
> 标签：asp.net, hyperlink, download

我的机器上存储了一些文件。当用户想要生成链接时，页面应该生成超链接。任何其他用户都可以使用此超链接下载文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:27:03.503

有一个 LinkBut​​ton 并为 click 事件执行以下操作

您的 aspx 文件将具有以下内容

```
 <asp:LinkButton runat="server" OnClick="btnDownload_Click" Text="Download"/> 
```

您背后的代码将具有以下内容

```
 protected void btnDownload_Click(object sender, EventArgs e)
    {
        try
        {

            var fileInBytes = Encoding.UTF8.GetBytes("Your file text");
            using (var stream = new MemoryStream(fileInBytes))
            {
                long dataLengthToRead = stream.Length;
                Response.Clear();
                Response.ClearContent();
                Response.ClearHeaders();
                Response.BufferOutput = true;
                Response.ContentType = "text/xml"; /// if it is text or xml
                Response.AddHeader("Content-Disposition", "attachment; filename=" + "yourfilename");
                Response.AddHeader("Content-Length", dataLengthToRead.ToString());
                stream.WriteTo(Response.OutputStream);
                Response.Flush();
                Response.Close();
            }
            Response.End();
            }
        }
        catch (Exception)
        {

        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T10:40:13.573

如果您知道地址，则可以将超链接直接链接到文件，但这受到浏览器的限制。例如。如果客户端上安装了 pdf 阅读器，则不会下载 pdf，而是会显示它。一个好的解决方案是有一个单独的页面来下载文件。只需在查询字符串中传递文件名，在页面加载事件中只需在响应流中输出文件即可。这样您就可以使用 url 说 dwnld.aspx?filename.ext

现在您可以通过上述逻辑生成 url。

# android - Android XML 包含另一个 xml（非布局）

> ID：14146459
> 
> 赞同：1
> 
> 时间：2013-01-03T20:11:44.493
> 
> 标签：android, android-xml

我有一个 settings.xml 文件，用于在我的应用程序中设置各种全局变量。我希望能够创建包含在 settings.xml 文件中的子 xml 文件，因为根据客户端，我会更改此文件中的设置，因此我想让自己更轻松。

我知道有一种方法可以通过这种方式包含布局文件，但我找不到任何文档来说明如何在 Android 上使用纯 XML 执行此操作。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-03T20:31:22.167

我认为您所要做的就是制作一个包含您想要的设置的附加文件。

即，我在值中有 strings.xml

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="main_title">Hello there</string>
</resources> 
```

我可以在 values 文件夹中创建 additionalstrings.xml

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="additional">How are you?</string>
</resources> 
```

我可以参考 R.string.main_title 或 R.string.additional，而不必说它来自哪个文件。

# exception - 由于语法错误，未能在 SML 中捕获异常

> ID：14146465
> 
> 赞同：1
> 
> 时间：2013-01-03T20:12:37.897
> 
> 标签：exception, sml, smlnj

我试图在之前在代码中抛出异常后添加捕获异常的机制，但我无法编译它：

这是没有异常处理的代码 - 它编译并且工作得很好：

```
fun calc(input : string ) : int = 

    let 
        val outStr = ref "someString"
        val outInt = ref 0

    in 
        (
            outStr := replaceRomanDec(input);       (* replace roman number with decimal *)
            outInt := calcMyRomanExpression(!outStr)    

        );

        (!outInt)

    end; 
```

但是当我尝试把`handle`and放在`exception` 这里时：

```
fun calc(input : string ) : int = 

    exception CalculatorParser

    let 
        val outStr = ref "someString"
        val outInt = ref 0

    in 
        (
            outStr := replaceRomanDec(input);       (* replace roman number with decimal *)
            outInt := calcMyRomanExpression(!outStr);
            handle CalculatorParser =>  -1
        );

        (!outInt)

    end; 
```

我得到：

```
stdIn:1761.2-1761.28 Error: syntax error: deleting  EXCEPTION ID
-               );
=
=               (!outInt)
=
=
=
=       end;
stdIn:1576.1-1757.2 Error: syntax error: deleting  RPAREN SEMICOLON 
```

-

我尝试按照错误中的建议添加/删除分号，但没有任何效果。

知道有什么问题吗？

亲切的问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T22:56:21.850

您似乎误解了表达式的序列 (expr_1; expr_2; ...; expr_n) 是如何工作的。

首先，没有必要先将 outStr 和 outInt 按自己的顺序“分组”，只是为了在另一个序列中使用它。

其次，我们不需要在`in ... end`局部声明（let）部分的序列周围加上括号，因为有一个派生形式（语法糖）来处理它。

此外，无需在“取消引用”周围添加括号。

所以一个简化的版本看起来像这样。

```
fun calc (input : string ) : int =
    let
      val outStr = ref "someString"
      val outInt = ref 0
    in
      outStr := replaceRomanDec input;       (* replace roman number with decimal *)
      outInt := calcMyRomanExpression (!outStr);
      !outInt
    end 
```

句柄的语法是：

> *exp* ::= ... | *exp* **句柄** *匹配*| ...

因此，句柄的左侧必须是一个表达式。您已将其作为序列的最后一部分 (exp_1 ; expr_2; expr_3)：

```
expr_1   =>   outStr := replaceRomanDec(input);
expr_2   =>   outInt := calcMyRomanExpression(!outStr);
expr_3   =>   handle CalculatorParser => -1 
```

从图中我们看到，句柄左侧没有提供表达式。因此，您会收到语法错误。

由于您的异常处理的结果是-1，我假设它是引发 CalculatorParser 异常的 calcMyRomanExpression。因此，一个解决方案可能是：

```
fun calc(input : string ) : int =
    let
      val outStr = ref "someString"
      val outInt = ref 0
    in
      outStr := replaceRomanDec(input);       (* replace roman number with decimal *)
      outInt := (calcMyRomanExpression(!outStr) handle CalculatorParser => ~1);
      !outInt
    end 
```

还要记住，减一`~1`在 SML 中。

* * *

正如我在对您的问题的评论中指出的那样，您在进行函数式编程时确实应该停止使用引用。如果你需要使用它们，那么你几乎总是做错了。

如果您保持它的功能，那么代码可能很简单：

```
fun calc1 input = (calcMyRomanExpression o replaceRomanDec) input 
```

甚至更简单

```
val calc2 = calcMyRomanExpression o replaceRomanDec 
```

# jquery - jquery .offset().top - 一定数量的像素（FF 和 IE 的问题）

> ID：14146469
> 
> 赞同：2
> 
> 时间：2013-01-03T20:12:54.650
> 
> 标签：jquery, internet-explorer, firefox, offset

所以我正在使用 Cedric Dugas 的 Anchor Slider。发生的情况是有人单击链接并将页面向下滚动到与链接的 href 具有相同 ID 的元素......所有标准的东西。

但我想要发生的是让它在该 id 上方约 80 像素处停止......所以这就是我所拥有的。

```
$(document).ready(function() {
    $("a.anchorLink").anchorAnimate()
});

jQuery.fn.anchorAnimate = function(settings) {

    settings = jQuery.extend({
        speed : 500
    }, settings);   

    return this.each(function(){
        var caller = this
        $(caller).click(function (event) {  
            event.preventDefault()
            var locationHref = window.location.href
            var elementClick = $(caller).attr("href")

            var destination = $(elementClick).offset().top - 80;
            $("html:not(:animated),body:not(:animated)").animate({ scrollTop: destination}, settings.speed, function() {
                window.location.hash = elementClick
            });
            return false;
        })
    })
}; 
```

这是将其向上移动 80 像素的代码行

```
var destination = $(elementClick).offset().top - 80; 
```

问题是它在 webkit 浏览器中运行良好，但在 FF 和 IE 中，它会在 80 像素以上停止，然后突然向下移动到它通常停止的位置。

有人对为什么会发生这种情况有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:36:21.180

这是浏览器的自然行为。当您访问包含片段的 url 时，浏览器会尝试导航到与片段对应的元素。因此[https://stackoverflow.com/#h-recent-tags](https://stackoverflow.com/#h-recent-tags)将导致浏览器向下（或向上）滚动到 ID 为`h-recent-tags`.

您的代码在发出以下命令时指示浏览器导航到该元素：

```
window.location.hash = elementClick; 
```

这发生*在*您的动画完成后，这就是为什么您会看到浏览器立即从原来的位置跳起来的原因。

为了获得您正在寻找的效果，需要采取不同的方法。在较新的浏览器中，您最好使用`pushState`，而不是直接篡改片段：

```
history.pushState(null, null, elementClick); 
```

这将更新哈希，而不影响页面。但请注意，这只适用于*现代*浏览器。对于旧版本的 IE，您需要采取不同的方法。一种这样的方法是回退到使用该`location.hash`方法，但在滚动之前设置散列：

```
$(caller).on("click", function (event) {
    // Prevent default behavior of anchor
    event.preventDefault();

    // Get href value from anchor clicked
    var elementClick = $(caller).attr("href");

    // If the browser supports the History api, use it to update hash
    // Otherwise update hash before we animate the scrolling
    if (history && history.pushState) {
        history.pushState(null, null, elementClick);
    } else {
        window.location.hash = elementClick;
    }

    // Determine where 80px above target is
    var destination = $(elementClick).offset().top - 80;

    // Scroll to that new location
    $("html:not(:animated),body:not(:animated)").animate({
        scrollTop: destination
    }, settings.speed);
}); 
```

在较旧的浏览器中，这会导致立即转到目标位置，然后慢慢向上滚动以提供一些填充。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:25:25.590

缺少许多分号。因此，某些浏览器可能会误读代码。将脚本粘贴到[jshint](http://jshint.com/)以查看所有缺少的分号。

**编辑**

虽然上面是一个问题，但我正在改变我的答案。我敢打赌它实际上来自设置 window.location.hash 的行。这样做可能会导致某些浏览器跳转到文档中的该点，这将在动画完成后立即发生。

这可能是在不删除该行的情况下“修复”它的唯一方法：

```
var destination = $(elementClick).offset().top;
$("html:not(:animated),body:not(:animated)").animate({ scrollTop: destination}, settings.speed, function() {
    window.location.hash = elementClick;
    $("html:not(:animated),body:not(:animated)").animate({ scrollTop: destination - 80 }, settings.speed);
}); 
```

换句话说，一直向下滚动到锚点，然后设置哈希，然后向上滚动一点。您可以使用缓动使其看起来更平滑。

# mysql - Ruby Mysql 无法连接到 localhost (10061)

> ID：14146470
> 
> 赞同：3
> 
> 时间：2013-01-03T20:12:54.083
> 
> 标签：mysql, ruby, ruby-on-rails-3

我正在关注 Lynda 的 ruby​​ on rails 课程，我在使用 Windows 中的命令行连接到数据库时遇到问题。

我可以使用“mysql -u username -p”连接到数据库，然后输入密码。我可以毫无问题地创建数据库。

现在执行时：

```
rake db:schema:dump 
```

在我的应用程序文件夹“simple_cms”中，我得到以下信息：

```
rake aborted!
Can't connect to MySQL server on 'localhost' (10061)

Tasks: TOP => db:schema:dump
(See full trace by running task with --trace) 
```

运行跟踪给出：

```
C:\Users\ASUS\Desktop\simple_cms>rake db:schema:dump --trace
** Invoke db:schema:dump (first_time)
** Invoke environment (first_time)
** Execute environment
** Invoke db:load_config (first_time)
** Execute db:load_config
** Execute db:schema:dump
rake aborted!
Can't connect to MySQL server on 'localhost' (10061)
C:/Ruby192/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/client.
rb:44:in `connect'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/client.
rb:44:in `initialize'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/connec
tion_adapters/mysql2_adapter.rb:16:in `new'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/connec
tion_adapters/mysql2_adapter.rb:16:in `mysql2_connection'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/connec
tion_adapters/abstract/connection_pool.rb:315:in `new_connection'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/connec
tion_adapters/abstract/connection_pool.rb:325:in `checkout_new_connection'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/connec
tion_adapters/abstract/connection_pool.rb:247:in `block (2 levels) in checkout'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/connec
tion_adapters/abstract/connection_pool.rb:242:in `loop'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/connec
tion_adapters/abstract/connection_pool.rb:242:in `block in checkout'
C:/Ruby192/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/connec
tion_adapters/abstract/connection_pool.rb:239:in `checkout'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/connec
tion_adapters/abstract/connection_pool.rb:102:in `block in connection'
C:/Ruby192/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/connec
tion_adapters/abstract/connection_pool.rb:101:in `connection'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/connec
tion_adapters/abstract/connection_pool.rb:410:in `retrieve_connection'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/connec
tion_adapters/abstract/connection_specification.rb:171:in `retrieve_connection'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/connec
tion_adapters/abstract/connection_specification.rb:145:in `connection'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/railti
es/databases.rake:379:in `block (4 levels) in <top (required)>'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/railti
es/databases.rake:378:in `open'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.10/lib/active_record/railti
es/databases.rake:378:in `block (3 levels) in <top (required)>'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:228:in `call'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:228:in `block i
n execute'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:223:in `each'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:223:in `execute
'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:166:in `block i
n invoke_with_call_chain'
C:/Ruby192/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:159:in `invoke_
with_call_chain'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:152:in `invoke'

C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:143:in `
invoke_task'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:101:in `
block (2 levels) in top_level'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:101:in `
each'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:101:in `
block in top_level'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:110:in `
run_with_threads'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:95:in `t
op_level'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:73:in `b
lock in run'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:160:in `
standard_exception_handling'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:70:in `r
un'
C:/Ruby192/lib/ruby/gems/1.9.1/gems/rake-10.0.3/bin/rake:33:in `<top (required)>
'
C:/Ruby192/bin/rake:19:in `load'
C:/Ruby192/bin/rake:19:in `<main>'
Tasks: TOP => db:schema:dump

C:\Users\ASUS\Desktop\simple_cms> 
```

现在在我的 database.yml 文件中，我已经输入了用户名和密码，并记得将整数密码放入“”中，并在冒号和密码本身之间放置一个空格，例如：

```
# MySQL.  Versions 4.1 and 5.0 are recommended.
# 
# Install the MYSQL driver
#   gem install mysql2
#
# Ensure the MySQL gem is defined in your Gemfile
#   gem 'mysql2'
#
# And be sure to use new-style password hashing:
#   http://dev.mysql.com/doc/refman/5.0/en/old-client.html
development:
  adapter: mysql2
  encoding: utf8
  reconnect: false
  database: simple_cms_development
  pool: 5
  username: simplelogin
  password: "1234"
  host: localhost

# Warning: The database defined as "test" will be erased and
# re-generated from your development database when you run "rake".
# Do not set this db to the same as development or production.
test:
  adapter: mysql2
  encoding: utf8
  reconnect: false
  database: simple_cms_test
  pool: 5
  username: root
  password:
  host: localhost

production:
  adapter: mysql2
  encoding: utf8
  reconnect: false
  database: simple_cms_production
  pool: 5
  username: root
  password:
  host: localhost 
```

我什至尝试使用此处描述的 ip 切换“localhost”（同样的问题）：[Rails development - Can't connect to MySQL server on 'localhost' (10061)](https://stackoverflow.com/questions/10792862/rails-development-cant-connect-to-mysql-server-on-localhost-10061)

但是当我这样做时，我没有从命令行收到任何消息。

那么为什么我无法连接到数据库呢？将不胜感激任何帮助！谢谢！尝试学习 ruby​​ 和整个安装过程已经花费了很多时间......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T00:42:11.347

使用 mysql 命令和使用连接器的问题在于 mysql 可以根据其配置方式具有不同的默认参数，因此很难知道发生了什么。

您应该查找一个名为 my.cnf 的文件（如果您在 Windows 上，则为 my.ini）。它可以指定不同的端口或主机。您很幸运能够通过 mysql 连接到数据库，因为您可以看到实际连接的位置。

看看你的端口：

```
mysql> show variables like 'port';
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| port          | 3306  |
+---------------+-------+
1 row in set (0.00 sec)

mysql> show variables like 'socket';
+---------------+-----------------+
| Variable_name | Value           |
+---------------+-----------------+
| socket        | /tmp/mysql.sock |
+---------------+-----------------+
1 row in set (0.00 sec)

mysql> show variables like 'hostname';
+---------------+-------------+
| Variable_name | Value       |
+---------------+-------------+
| hostname      | myhostname  |
+---------------+-------------+
1 row in set (0.00 sec) 
```

查看这些值是否与 database.yml 文件匹配。

获得这些值后，您可以尝试在该端口上远程登录。如果该端口上没有任何东西在监听，您将得到如下信息：

```
$ telnet localhost 11111
Trying ::1...
telnet: connect to address ::1: Connection refused
Trying 127.0.0.1...
telnet: connect to address 127.0.0.1: Connection refused
Trying fe80::1...
telnet: connect to address fe80::1: Connection refused
telnet: Unable to connect to remote host 
```

但如果有连接，你会在某处看到一些带有“mysql”的垃圾：

```
$ telnet localhost 3306
Trying ::1...
telnet: connect to address ::1: Connection refused
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
J
5.5.28JzKEXl7?5e|bUcq/5\Q^mysql_native_passwordConnection closed by foreign host. 
```

我在 Unix 上工作，所以你的输出可能看起来不同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-24T22:12:07.590

我在同一个琳达课程。

```
development:
  adapter: mysql2
  encoding: utf8
  reconnect: false
  database: simple_cms_development
  pool: 5
  username: root
  password:
  host: 127.0.0.1
  port: 3306
  socket: C:/xampp/mysql/mysql.sock 
```

我在 Windows 8 上并使用带有 XAMPP 包的 mysql。

`localhost`我已经尝试了一切，真正解决它的是从`127.0.0.1`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-23T04:54:45.060

我在这个问题上工作了几天，尝试了互联网上几乎所有可用的解决方案。最后，我可以通过添加端口：3306 并使用“rails server”命令重新启动 WEBrick 服务器来解决该错误。

谢谢你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-19T09:03:26.293

我在 Ruby 和命令行中看到了这个可怕的东西！

```
Can't connect to MySQL server on 'localhost' (10061) 
```

如果上述解决方案不起作用，我怀疑这可能是与缺少 MySQL 服务运行有关的问题。Rails 不能访问 MySQL，除非你解决了 MySQL 的 bug。

诊断

在尝试以下解决方案之前，请转到命令行并尝试从 bin 文件夹再次访问 MySQL：mysql -u username -p

如果你得到这样的东西：

```
ERROR 2003 (HY000): Can't connect to MySQL server on 'localhost' (10061) 
```

然后试试这个：

1.  以管理员身份运行 cmd（如果不能，您必须咨询您的 IT 代表）
2.  转到 MySQL 中的 bin 文件夹并使用以下命令安装 MySQL 服务：

您可以收到以下两条消息中的任何一条：

或者

不要关闭cmd！

6.  搜索“服务”
7.  打开“服务”后，选择 MySQL 并单击“开始”。
8.  从命令行尝试以身份不明的用户、root 或 simple_cms 再次访问 mysql。mysql -u 简单登录 -p

# c# - 未知大小的 C# 数组

> ID：14146471
> 
> 赞同：0
> 
> 时间：2013-01-03T20:13:00.937
> 
> 标签：c#, .net-3.5

我需要里面有数组的类：

```
class FirstClass
{
     int x = 0;
     int y = 0;
}

class SecondClass
{
    FirstClass[] firstclass = ???????? // size of array is unknown
    OtherClass[][] otherclass = ???????? // i need also multidimensional array or array of arrays
} 
```

通常我使用`List<>`这样的目的，但今天我需要最快的解决方案（处理大量数据），我认为 Array 应该比 List 快（我在某处读过 List 比 Array 慢很多）。

问题是 - 将什么放入“？？？？？？？？？” 在我的代码中？

编辑：

我的课是一个神经网络对象。最大的数组将包含学习数据（100000+ 数据行，50+ 字段，浮点或双精度数据类型）。

如果 Array 比 List 快 1% - 我需要 Array。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:15:58.037

在知道数组的确切大小之前，您不能创建数组：与列表不同，数组不能增长^*；一旦你给他们一个尺寸，他们就会永远保持这个尺寸。如果您必须有一个数组进行处理，请先创建`List<T>`一个，填充它，然后使用方法转换为数组`ToArray()`：

```
var firstClassList = new List<FirstClass>();
firtstClassList.Add(new FirstClass(123));
firtstClassList.Add(new FirstClass(456));
FirstClass firstClass[] = firtstClassList.ToArray();

var otherClassList = new List<List<OtherClass>>();
otherClassList.Add(new List<OtherClass>());
otherClassList[0].Add(OtherClass(10));
otherClassList[0].Add(OtherClass(11));
otherClassList.Add(new List<OtherClass>());
otherClassList[1].Add(OtherClass(20));
otherClassList[1].Add(OtherClass(21));
otherClassList[1].Add(OtherClass(22));
OtherClass otherClass[][] = otherClassList.Select(r => r.ToArray()).ToArray(); 
```

但是请注意，这是过早的优化：列表与数组一样快，但它们提供了更多的灵活性。用数组替换列表没有意义，至少在你分析之前没有。

* * *

^*更改数组大小的调用[`Array.Resize`](http://msdn.microsoft.com/en-us/library/bb348051.aspx)不算作“增长”数组，因为您最终会得到一个不同的数组实例，而您试图“增长”的实例在被复制后立即被丢弃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:16:08.790

如果您不确定数组的大小，您可能需要考虑使用不同类型的集合，例如`List<FirstClass>`您提到的 a 或 ArrayList 等。

在性能方面，在您实际测试数据之前，使用 List 可能没问题，如果仍然有问题或瓶颈，请考虑使用 Array 或更有效的结构。*（除非您使用非常大的数据集，否则运行时间不应相差太大。）*

*（也总是可以选择将列表转换为数组。）*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:16:14.787

为什么 Array 会比 List 快？有关运行时间的比较，[请参阅此问题。](https://stackoverflow.com/questions/7770569/big-o-notation-arrays-vs-linked-list-insertions)

我能想到的唯一情况是，如果您需要搜索一个元素，并且数组已排序，因此您可以进行二进制搜索。但是，由于您可以使用 [] 来索引 C# 中的 List<T>s，因此这是一个有争议的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T20:21:21.523

```
var list = new List<FirstClass>();
list.Add(object);

FirstClass[] firstClass = list.ToArray();

var listOfLists = new List<List<SecondClass>>();
var item1 = new List<SecondClass>();
item1.Add(anotherObject);
listOfLists.Add(item1);

SecondClass[][] secondClass = listsOfLists.Select(i => i.ToArray()).ToArray(); 
```

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2013-01-03T20:22:48.967

您可以像这样实例化它们：

```
FirstClass[] firstclass = new FirstClass[];
OtherClass[][] otherclass = new OtherClass[][]; 
```

然后在需要添加元素时使用 Add 方法：

```
firstclass.Add(new FirstClass()); 
```

# soap - 更改 CXF SOAP 故障中的 HTTP 响应代码

> ID：14146476
> 
> 赞同：3
> 
> 时间：2013-01-03T20:13:15.173
> 
> 标签：soap, exception-handling, cxf

我有这个错误

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <soap:Fault>
      <faultcode>soap:Client</faultcode>
      <faultstring>Message part {http://soap.ws.server.wst.fit.cvut.cz/}createOrders was not recognized.  (Does it exist in service WSDL?)</faultstring>
    </soap:Fault>
  </soap:Body>
</soap:Envelope> 
```

这完全没问题。但问题是 CXF 正在返回内部服务器错误 (HTTP 500)。我希望它返回 400 Bad Request 因为错误的请求导致了这种情况。我该如何改变呢？

**细节**

产生上述错误的错误请求 - 应该有`<soap:createOrder/>`而不是`<soap:createOrders/>`.

```
POST http://localhost:8080/wst-server-1.0.0/services/soap/order

POST data:
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soap="http://soap.ws.server.wst.fit.cvut.cz/">
   <soapenv:Header/>
   <soapenv:Body>
      <soap:createOrders/>
   </soapenv:Body>
</soapenv:Envelope>

[no cookies]

Request Headers:
Content-Length: 238
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:38:44.650

I found this by Googling for "CXF response code 500". It might help.

[http://cxf.547215.n5.nabble.com/CXF-Fault-Response-Code-td566788.html](http://cxf.547215.n5.nabble.com/CXF-Fault-Response-Code-td566788.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-03-29T11:45:44.790

我知道答案可能为时已晚，但另一种处理 HTTP 状态代码的方法是使用 CXF 拦截器。

你可以在你的服务器 CXF 配置中添加一个拦截器

```
 public class ServiceConfigurer implements CxfConfigurer {

    @Override
    public void configureServer(Server server) {
         server.getEndpoint().getOutFaultInterceptors().add(new ChangingStatusCodeInterceptor();
    }
 } 
```

在你的拦截器中，你可以改变这个

```
public class SaveInfluxDataInterceptor extends WSS4JOutInterceptor {

    @Override
    public void handleMessage(SoapMessage soapMessage) {
        ((Fault)exchange.get(Exception.class)).setStatusCode(202); // this is because of soap12OutFaultInterceptor look to this fault
        // or you can use this
        // exchange.getOutFaultMessage().put(Message.RESPONSE_CODE, 202);
    }
} 
```

我将 Camel 与 CXF 一起使用。也许这个解决方案应该改变你的。

# c# - 如何将外部 dll 与我的 setup exe 项目链接？

> ID：14146482
> 
> 赞同：0
> 
> 时间：2013-01-03T20:13:49.770
> 
> 标签：c#, visual-studio-2010, wcf, dll, executable

我需要创建`stand alone EXE`一个解决方案。该解决方案包含`two`项目，即：

*   A-项目（设置为开始）
*   B 项目（A 网络服务）

    B 项目使用`DLL`驻留在同一`B-project`文件夹中的外部。上述解决方案在构建后完美运行。现在我想创建一个独立的`EXE`。这样我就可以将我的产品出售用于商业用途（在我的学校）。

为此，我执行了以下几点：

*   在具有名称的解决方案中添加一个新项目（`SETUP Project`） 。`test`
*   现在添加`project output`并`A-project`从`project`下拉列表中选择。
*   然后我对`B-project`即添加执行相同操作并从下拉列表中`project output`进行选择。`B-project``project`
*   检查`.net framework 4`依赖关系，这很好。
*   构建它。
*   安装它。

我去了我的`program files`目录并`test.exe`以管理员身份运行，并尝试打开网络服务`URL`。

我知道它`web services`运行完美，但是当我输入 url 时它会返回我`Request error`，当写入的方法`instance class`没有完美执行时会发生这种情况。在我的项目中，编写的方法`Instance class`称为 externall `dll`。

我应该如何将该 dll 与我的`EXE`. 让它运行得很好？我应该更改代码中的路径吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:42:49.677

如果要部署一个 .EXE：

*   将项目 B 依赖的 dll 添加为资源（右键单击添加现有项 -> 选择 dll -> 将构建操作更改为嵌入式资源）
*   对项目 A 和项目 B 执行相同操作（即将它们作为资源添加到您的 Setup.exe）
*   然后你需要实现[这里描述的解决方案](https://stackoverflow.com/questions/96732/embedding-one-dll-inside-another-as-an-embedded-resource-and-then-calling-it-fro)

# html - 如何使用 HTML / CSS 根据内容高度放置响应式背景？

> ID：14146489
> 
> 赞同：0
> 
> 时间：2013-01-03T20:14:19.260
> 
> 标签：html, css, background, height

我需要在我的网站主要内容中实现这个背景：

![在此处输入图像描述](../Images/ba4c2ce6be445f06c97717528dab1f7b.png)

如果内容变大，左右条纹应该是响应式的并且高度会增加。

问题是，我不知道主要内容会有多大，那么我如何将它剪切并根据高度放置？我需要多少件，如何用 css 放置它们？

谁可以给我解释一下这个 ？

亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T13:46:26.763

如果只需要高度支撑，把它切成3块：上、中、下。用repeat for y将背景设置为中间部分，将上下部分分别放在top:0和bottom:0，你就大功告成了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:21:58.590

我是这样解决的：

```
#content {
position:relative;
}
#left-stripe {
  background: url(" images/bg-top.png") no-repeat scroll 0 0 transparent;
  height: 85px;
  left: 112px;
  position: absolute;
  width: 90%;
}
#right-stripe {
  background: url(" images/bg-bottom.png") no-repeat scroll 0 0 transparent;
  height: 85px;
  left: 112px;
  position: absolute;
  width: 90%;
  bottom:0;
}

#middle-stripe {
  background: url(" images/bg-middle.png") repeat-y scroll 0 0 transparent;
  bottom: 85px;
  top:85px;
  left: 112px;
  position: absolute;
  width: 90%;
} 
```

但我仍然遇到问题，它没有响应（如果用户使用他的浏览器进行缩放，它应该随之移动。

因此，如果有人来到我的网站并且宽度超过 960 像素，它应该会出现，但不是全部，左右的其余背景应该被隐藏。

有人可以帮我让它响应吗？

# css - 无法水平对齐两个浮动 div

> ID：14146491
> 
> 赞同：0
> 
> 时间：2013-01-03T20:14:21.627
> 
> 标签：css, html

我对 XHTML 和 CSS 很陌生，我无法让花车工作。不知何故，我一直在 "wrapper" 的下方和右侧以 " **fondo_header** "**结尾**。

 **这是 HTML 代码：

```
<div id="header">
        <div id="wrapper">
            <div id="figure">
                    <img src="images/logo_2nd_225x1182_forWeb.jpg" alt="Logo" width="225" height="118">

            </div>
        </div>
            <div id="fondo_header">
                <div id="nav">
                    <ul>
                        <li><a href="#">Inicio</a></li>
                        <li><a href="#">Servicios</a></li>
                        <li><a href="#">Contacto</a></li>
                        </ul>
                </div>
            </div>

</div> 
```

和CSS：

```
#header{
    margin-top: 20px;
    width: 70%;
    margin-left: auto;
    margin-right: auto;
    overflow: hidden;
       }

#fondo_header{
       width: 74%;
       float: right;
       background: url(images/header.jpg);

       }

#wrapper{
    width: 250px;
    /*float:left;*/
    height:auto;
    background-color:#f2dfce;
        } 
```

我需要将**“wrapper”**和**“fondo_header”**放在一起。所有 div 的宽度都应该是正确的，我也尝试过像素、不同的宽度、添加边距、填充、不同的浮动样式和太多的东西，但没有任何效果。

我尝试过 IE9、Chrome 和 FF，结果相同。边距和填充已被重置。

我很确定在这一点上我忽略了一些非常明显的东西。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:20:58.160

`#fondo_header`您必须同时`#wrapper`向左浮动。当您浮动元素时，您必须`overflow: hidden`在父元素上进行设置，以便它适合其内容的高度。
看看这个，它会帮助你更好地理解浮点数：[All About Floats](http://css-tricks.com/all-about-floats/)。
**编辑：**`#wrapper`向左和`#fondo_header`向右浮动也可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:21:57.583

只要标题足够小以适合我，似乎对我来说工作正常。你确定你给每个元素足够的空间吗？对一个元素的宽度使用百分比，对另一个元素使用像素将根据您的屏幕宽度为您提供不同的结果。

```
#header{
    margin-top: 20px;
    width: 70%;
    margin-left: auto;
    margin-right: auto;
    overflow: hidden;
       }

#fondo_header{
       width: 30%;
       float: right;
       background: url(images/header.jpg);

       }

#wrapper{
    width: 250px;
    float:left;
    height:auto;
    background-color:#f2dfce;
        }​ 
```

[http://jsfiddle.net/ARvw3/](http://jsfiddle.net/ARvw3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T20:22:09.680

如果您使用浮动，浮动元素的宽度不应超过容器的宽度，否则将进入第二行

在你的情况下，Fondo_header 的 74% + 包装器的 240px 大于标题的宽度，你可以通过将包装器的宽度设置为 26% 来解决这个问题

或为两者设置静态值**

# vba - 关闭绑定表单而不保存更改

> ID：14146493
> 
> 赞同：5
> 
> 时间：2013-01-03T20:14:27.520
> 
> 标签：vba, ms-access

在这里快速提问，希望有一个简洁明智的解决方案。

我有一个纯粹用于数据输入的绑定表单（无法浏览记录，只能插入它们）。我会有很多用户搞砸了。为了避免脏数据，我希望他们在提交记录之前确认表格是正确的。

问题是，只要我在表单上输入任何内容，访问就会创建并保存记录。

我希望仅在用户单击“提交”时才保存和提交记录。如果他们单击关闭或退出应用程序，我不希望数据库中的部分完成记录。

不使用未绑定的表单并调用插入函数，有没有简单的解决方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T20:41:29.843

自动编号是唯一的，而不是顺序的。如果您需要序列号，请不要使用自动编号。永远不应向用户显示自动编号。它永远不能被认为是独一无二的，如果你搞得够多，那就更不用说了。

```
Private Sub Form_BeforeUpdate(Cancel As Integer)
If Me.AText = "Invalid" Then
    Me.Undo
    Cancel = True
End If
End Sub 
```

请注意，带有子表单的表单可能无法与撤消一起使用，因为记录是在从子表单更改为主表单时提交的，反之亦然，这一切都变得相当复杂。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T20:44:43.417

Remou 的方法绝对是最快的，这是基于我的评论的另一种方法；）

```
Option Explicit

Private blnGood As Boolean

Private Sub cmdSubmit_Click()
    blnGood = True
    Call DoCmd.RunCommand(acCmdSaveRecord)
    blnGood = False
End Sub

Private Sub Form_BeforeUpdate(Cancel As Integer)
    If Not blnGood Then
        Cancel = True
        Call MsgBox(Prompt:="click submit to save the record", Title:="Before Update")
    End If
End Sub 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-24T17:00:53.777

您可以使用以下代码创建一个清除按钮，以防用户出错并希望清除整个表单并重新开始。

```
Private Sub btnClear_Click() 
  If Me.Dirty = True Then
    DoCmd.RunCommand acCmdUndo
    Exit Sub
  End If
End Sub` 
```

我有时会发现 before_update 事件表现得很奇怪，所以我通常禁用属性中的关闭 (x) 按钮，并添加我自己的关闭按钮，提示用户是否要放弃屏幕上的数据。

```
Private Sub close_Click()
 Dim Answer As Integer
 If Me.Dirty = True Then
    Dim Response As Integer
    ' Displays a message box with the yes and no options.
    Response = MsgBox(Prompt:="Do you wish to discard data?", Buttons:=vbYesNo)
    ' If statement to check if the yes button was selected.
    If Response = vbYes Then
        DoCmd.RunCommand acCmdUndo
        DoCmd.Close
        Else
        Me.Clear.SetFocus
    End If
 Else
    ' The no button was selected.
    DoCmd.Close
  End If
End Sub 
```

# iphone - iOs 6 旋转以及如何集成 Cocos2D 和 UIKit？

> ID：14146499
> 
> 赞同：1
> 
> 时间：2013-01-03T20:14:53.200
> 
> 标签：iphone, cocos2d-iphone, ios6, uikit, object-code

使用了这里提到的 Ray Wenderlich 教程“如何集成 UIKit 和 Cocos2D”，它在 iOs6 发布之前效果很好，然后，我得到了“iOS 6 上的方向问题”......

帮助？如何应用旋转问题的修复？[http://www.cocos2d-x.org/news/73](http://www.cocos2d-x.org/news/73)

注意：我的问题是针对像 Ray 的教程那样结合了 UiKit 和 Cocos2D 的项目？

我在这里发布了我的代码摘录和结构：

[http://www.raywenderlich.com/forums/viewtopic.php?f=20&t=1081&p=34166#p34166](http://www.raywenderlich.com/forums/viewtopic.php?f=20&t=1081&p=34166#p34166)

对不起，我是初学者:(

我应该在哪里应用修复的两个部分？

在 MainMenuViewController.m 中？

或者，我是否需要下载最新的 Cocos2D 框架并为即将完成的应用重做大量开发..？

干杯，

安德烈亚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T03:33:25.640

我解决它的方法是遵循此实现的注释中的解决方案（类似于 RW 教程中的解决方案）：

[Tinytimegames - cocos2d 和故事板](http://www.tinytimgames.com/2012/02/07/cocos2d-and-storyboards/#comment-707108201)

“皮埃尔”发布的具体代码有：

```
And if you want your glView to resize:
CCGLView *glView = ...
glView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight; 
```

这会强制 glView 在设备方向更改时自动调整大小。

# php - PHP date() 未返回预期值

> ID：14146503
> 
> 赞同：2
> 
> 时间：2013-01-03T20:15:32.073
> 
> 标签：php

这很奇怪。要么我失去理智，要么这真的很简单，我只是忽略了一些明显的事情。

我有一个脚本每天（中央时间上午 9:00 左右）由我尝试设置为在 1 月 1 日“休假”的 cron 作业自动运行。似乎简单的解决方案是将以下行添加到我脚本的顶部：

```
if( date("n/j")=='1/1' ){ exit(); } 
```

然而不知何故，它并没有退出，而是无论如何都跑了。没什么大不了的……但我希望明年能解决它。我今天尝试使用以下示例脚本，它正确识别日期并退出而不运行其余代码......

```
if( date("n/j")=='1/3' ){ exit('January 3'); } 
```

......所以我很困惑。1 月 1 日不是表示为 1/1 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:21:56.437

它不应该工作没有合乎逻辑的理由。有用

```
<?php
if( date("n/j",strtotime("1/1/2013"))=='1/1') 
{
   echo "it does match";
   exit();
}
?> 
```

它是在 12/31 还是 1/2 运行的？可能由于时区差异而发生，就像其他人建议检查的那样

# silverlight - 如何在 Silverlight 中管理客户端和服务器之间的时区差异？

> ID：14146505
> 
> 赞同：1
> 
> 时间：2013-01-03T20:15:34.570
> 
> 标签：silverlight, timezone, wcf-ria-services, silverlight-5.0, entity-framework-5

我有一个带有日期字段的表单的 SL 5 应用程序。我在代码中设置了该字段的默认日期，例如：

```
MyDate = System.DateTime.Today; 
```

或者

```
MyDate = System.DateTime.Now.Date; 
```

然后使用 WCF Ria Service 提交数据以将数据保存到数据库中。

问题是：如果用户客户端计算机和 Web 服务器上的时区不同，则日期数据将以不同的值保存。

例如，今天是 Jan-03-2013，当我从表单中保存数据时，在数据库中，数据保存为 Jan-02-2013 23:00:00.，而不是 Jan-03-2013 00： 00:00。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T15:03:37.907

你可以尝试使用

```
MyDate = DateTime.UtcNow 
```

这会将 utc 时间返回到服务器，然后您可以将所有日期时间存储为 utc 或在保存到数据库之前对其进行操作（因此它将保存为服务器的本地时间）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T20:54:00.560

除了时区差异外，客户端和服务器之间还可能存在实际日期值差异。

出于这个原因，我认为您应该每次都从服务器获取日期，或者您应该在应用程序启动时从客户端和服务器获取时间并找到差异间隔。然后，您应该通过将差值添加到本地日期值来计算服务器日期时间。

对于时区差异，您也应该始终以 UTC 格式工作，当然您应该以本地时区格式向用户显示该值。

# c# - 使用表单和 datagridview 掌握详细信息

> ID：14146507
> 
> 赞同：1
> 
> 时间：2013-01-03T20:15:42.797
> 
> 标签：c#, winforms

我想做一个主/详细页面，其中父（客户信息）是窗口上半部分的表单，然后是屏幕下半部分的订单数据网格视图？

[我发现了一篇文章，该示例在此处使用 2 个 datagridviews](http://msdn.microsoft.com/en-us/library/y8c0cxey%28v=vs.100%29.aspx)并尝试从那里开始。

我从包含 ParentID 的单个文本框开始（我使用的是 Northwind 客户/订单）。这适用于现有记录。我如何处理想要同时添加新客户和订单的问题？

```
using System;
using System.Data;
using System.Data.SqlClient;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        DataSet data;
        private BindingSource masterBindingSource = new BindingSource();
        private BindingSource detailsBindingSource = new BindingSource();

        public Form1()
        {
            InitializeComponent();
        }

        private void GetData()
        {
            try
            {
                // Specify a connection string. Replace the given value with a 
                // valid connection string for a Northwind SQL Server sample
                // database accessible to your system.
                String connectionString = 
                    "Integrated Security=SSPI;Persist Security Info=False;" +
                    "Initial Catalog=Northwind;Data Source=.\\SQLEXPRESS";
                SqlConnection connection = new SqlConnection(connectionString);

                // Create a DataSet.
                data = new DataSet();
                data.Locale = System.Globalization.CultureInfo.InvariantCulture;

                // Add data from the Customers table to the DataSet.
                SqlDataAdapter masterDataAdapter = new
                    SqlDataAdapter("select * from Customers where CustomerID = @id", connection);                
                masterDataAdapter.SelectCommand.Parameters.AddWithValue("@id", lblParentId.Text);
                masterDataAdapter.Fill(data, "Customers");

                // Add data from the Orders table to the DataSet.
                SqlDataAdapter detailsDataAdapter = new
                    SqlDataAdapter("select * from Orders where CustomerID = @id", connection);
                detailsDataAdapter.SelectCommand.Parameters.AddWithValue("@id", lblParentId.Text);
                detailsDataAdapter.Fill(data, "Orders");

                // Establish a relationship between the two tables.
                DataRelation relation = new DataRelation("CustomersOrders",
                    data.Tables["Customers"].Columns["CustomerID"],
                    data.Tables["Orders"].Columns["CustomerID"]);
                data.Relations.Add(relation);

                // Bind the master data connector to the Customers table.
                masterBindingSource.DataSource = data;
                masterBindingSource.DataMember = "Customers";

                // Bind the details data connector to the master data connector,
                // using the DataRelation name to filter the information in the 
                // details table based on the current row in the master table. 
                detailsBindingSource.DataSource = masterBindingSource;
                detailsBindingSource.DataMember = "CustomersOrders";
            }
            catch (SqlException)
            {
                MessageBox.Show("To run this example, replace the value of the " +
                    "connectionString variable with a connection string that is " +
                    "valid for your system.");
            }
        }

        private void btnLoadDetail_Click(object sender, EventArgs e)
        {
            lblParentId.Text = textBox1.Text;
            GetData();
            //textBox1.DataBindings.Add("Text", data.Tables[0], "CustomerID");
            dataGridView1.DataSource = detailsBindingSource;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-30T09:02:50.637

这篇博文将对您有所帮助。 [http://blogs.msdn.com/b/bethmassi/archive/2009/09/15/inserting-master-detail-data-into-a-sql-server-compact-edition-database.aspx](http://blogs.msdn.com/b/bethmassi/archive/2009/09/15/inserting-master-detail-data-into-a-sql-server-compact-edition-database.aspx)

# javascript - Titanium 地理位置在 Android 模拟器中不起作用

> ID：14146510
> 
> 赞同：1
> 
> 时间：2013-01-03T20:16:02.627
> 
> 标签：javascript, titanium, titanium-mobile

我收到此错误：

> [错误][GeolocationModule(278)] (KrollRuntimeThread) [633,2564] 无法获取当前位置，位置为空

而且我没有任何运气就听从了其他人的建议。

有人能引导我走向正确的方向吗？我会很感激的。谢谢！

```
var win1 = Titanium.UI.createWindow({
    title : 'map_landing',
    backgroundColor : '#fff'
});

var win2 = Titanium.UI.createWindow({
    title : 'hails_window',
    backgroundColor : '#fff'
});

var win3 = Titanium.UI.createWindow({
    title : 'cabs_window',
    backgroundColor : '#fff'
});

User = {
    location : {}
};

var hail_button = Titanium.UI.createButton({
    title : 'Hail Cab',
    top : 10,
    width : 200,
    height : 50
});

var find_button = Titanium.UI.createButton({
    title : 'Find People',
    bottom : 10,
    width : 200,
    height : 50
});

var options = {
    accessKeyId : '',
    secretAccessKey : ''
}

Ti.Geolocation.purpose = "Receive user location";

Titanium.Geolocation.getCurrentPosition(function(e) {
    if (e.error) {
        alert('HFL cannot get your current location');
        return;
    }

    User.location.longitude = e.coords.longitude;
    User.location.latitude = e.coords.latitude;
    User.location.accuracy = e.coords.accuracy;
    User.location.speed = e.coords.speed;
    User.location.timestamp = e.coords.timestamp;

    var mapview = Titanium.Map.createView({
        mapType : Titanium.Map.STANDARD_TYPE,
        region : {
            latitude : User.location.latitude,
            longitude : User.location.longitude,
            latitudeDelta : 0.01,
            longitudeDelta : 0.01
        },
        animate : true,
        regionFit : true,
        userLocation : true
    });

    win1.add(mapview);
    win1.add(hail_button);
    win1.add(find_button);
    hail_button.addEventListener('click', function(e) {
        alert('hello');
        $.ajax('http://hail.pagodabox.com/add_hail', {
            type : 'POST',
            lat : User.location.latitude,
            lang : User.location.longitude,
            success : function(response) {
                alert(response)
            }
        })
    });

    find_button.addEventListener('click', function(e) {

    });
    win1.open();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-26T23:08:56.583

我花了一些时间来追踪这个问题，但我想我已经找到了“修复”Android 模拟器中缺少位置所需的步骤（来自[这个答案](http://developer.appcelerator.com/question/5291/tips-and-tricks-mobile---thread-to-share-some-experience-that-may-help-the-others#answer-105071)）：

> 首先，打开ddms（Dalvik Debug Monitor）。在 Windows 上，导航到 android-sdk\tools 目录并运行 ddms.bat。左上窗格中的第一行将显示类似“emulator-####”之类的内容，例如 emulator-5560。
> 
> 打开命令提示符窗口。输入 'telnet localhost ####' 替换您在上面找到的数字。这将为您的 android 模拟器打开一个 telnet 窗口。
> 
> 输入以下命令（如果您愿意，请按顺序替换您自己的经度和纬度）：
> 
> `geo fix -82.411629 28.054553`
> 
> （我很确定您可以将海拔添加为第三个数字。） GPS 图标将出现在模拟器的通知栏中。地理位置现在可用。此时，我可以在我的应用程序和其他应用程序（例如地图）中获取位置数据。

# c# - Selenium Web Driver C# InvalidCastException for JavascriptExecutor 之后的 WebElements 列表

> ID：14146513
> 
> 赞同：1
> 
> 时间：2013-01-03T20:16:11.887
> 
> 标签：c#, selenium, webdriver, selenium-webdriver

我在 C# 中将 Selenium Web 驱动程序与 Visual Studios 2010 一起使用。我正在使用 jQuery 过滤掉 div 列表并使用 Selenium 双击它们。但是，无论我做什么，我似乎都无法摆脱 InvalidCastException。

这是我写的代码：

```
IWebDriver m_driver = new ChromeDriver();
IJavaScriptExecutor js = m_driver as IJavaScriptExecutor;
string jsQuery = [insert some query here that returns list of divs];
object result = js.ExecuteScript(jsQuery);

System.Collections.ObjectModel.ReadOnlyCollection<IWebElement> list = (System.Collections.ObjectModel.ReadOnlyCollection<IWebElement>)result; 
```

结果确实返回了一个 webelements 列表，但由于某种原因，有时上面的代码运行良好并且强制转换，而其他时候它不在 ChromeDriver 上。当它不起作用时，提供的最后一行代码将失败，并显示以下内容：

```
"Unable to cast object of type 'System.Collections.ObjectModel.ReadOnlyCollection`1[System.Object]' to type 'System.Collections.ObjectModel.ReadOnlyCollection`1[OpenQA.Selenium.IWebElement]'." 
```

在 InternetExplorerDriver 上，它几乎总是失败，原因如下：

```
Unable to cast object of type 'OpenQA.Selenium.Remote.RemoteWebElement' to type 'System.Collections.ObjectModel.ReadOnlyCollection`1[OpenQA.Selenium.IWebElement]'. 
```

我已经尝试将它转换为 IE 的 RemoteWebElement，但这也不起作用，因为它看到的是 RemoteWebElement 而不是 RemoteWebElements 的列表，因此我以后无法枚举它们。

关于为什么的任何线索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T19:12:56.917

我通过执行以下操作使其工作：

```
IWebDriver m_driver = new ChromeDriver();
IJavaScriptExecutor js = m_driver as IJavaScriptExecutor;
string jsQuery = [insert some query here that returns list of divs];
var result = js.ExecuteScript(jsQuery);
foreach (IWebElement element in (IEnumerable) result){...} 
```

这有效，不再抛出异常！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T13:01:54.100

你为什么不直接使用`driver.findElements(By.xpath())`？
您必须通过 jQuery 有什么特别的原因吗？

要从 jQuery 列表中获取实际元素，您可能必须使用[`.toArray()`](http://api.jquery.com/toArray/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T16:01:10.600

确保从 JavaScript 返回的对象是**实际**的HTML 元素，而不是 jQuery 包装的对象。jQuery 可能将元素包装在它自己的对象中，这意味着从您的 JavaScript 执行返回的对象实际上不是`IWebElements`.

顺便说一句，使用 JavaScript 进行元素定位并不常见。关于为什么您不能简单地`FindElements()`用于您的目的，可能值得解释一下。

# c - 从已删除的文件中读取

> ID：14146518
> 
> 赞同：1
> 
> 时间：2013-01-03T20:16:31.873
> 
> 标签：c, linux, file, filesystems, libc

我用 C 语言编写了一个小程序，成功打开了一个文件，然后调用 sleep 20 秒。在那 20 秒内，我使用 shell 中的 rm 删除了打开的文件。睡眠后，程序成功读取数据并将其打印在屏幕上。

```
int bytes_read;
FILE *fp = fopen("/tmp/file", "r");
sleep(20);
bytes_read = fread(buf, 1, 5, fp);
buf[bytes_read] = '\0';
printf("%s", buf); 
```

我希望它读取 0 个字节，但它会打印文件中的实际数据。这种行为背后的解释是什么。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-03T20:19:48.113

在 linux 和其他 POSIX 系统中，您不会删除文件。您只需从目录中删除一个 inode。只要文件上打开了文件描述符，它就不会被删除。仅当指向 inode 的最后一个链接和最后一个打开的文件描述符消失时。

# php - 无法使用 usort 对日期进行排序

> ID：14146520
> 
> 赞同：2
> 
> 时间：2013-01-03T20:16:46.850
> 
> 标签：php, php4

我有用户定义的函数排序，它按日期排序。它在同一年工作正常，并且在年份变化时不起作用。这是按函数排序的日期示例：

```
 01/02/2013  
 01/03/2013 
 12/12/2012  

 function mysort($a,$b) {
   return $a['date']>$b['date'];
 }

 usort($arr,"mysort"); 
```

这是一个使用 php4 的旧应用程序。有没有办法直接比较日期？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-03T20:18:46.303

使用 strtotime。

```
function mysort($a,$b) {
    return strtotime($a['date'])>strtotime($b['date']);
} 
```

# sql-server - 如何在amazon RDS上找到sqlhande的sql查询

> ID：14146524
> 
> 赞同：1
> 
> 时间：2013-01-03T20:17:16.463
> 
> 标签：sql-server, amazon-web-services, amazon-rds

我使用亚马逊 RDS SQL Server 2012 中型实例。

我使用了一个在这里找到的查询： [如何找出是什么在影响我的 SQL Server？](https://stackoverflow.com/questions/945063/how-do-i-find-out-what-is-hammering-my-sql-server) 找到一个查询的 sql 句柄，该句柄占用的时间比其他任何事情都多。

我尝试将 sys.fn_get_sql 与上述查询重新调整的 sql 句柄一起使用，但我的亚马逊 RDS 用户拒绝了选择。

有没有办法在亚马逊 RDS 上找出查询内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:29:02.990

我不知道针对服务器运行该系统功能。作为替代方案，您可以使用 SQL Server Profiler 连接到您的实例并在查询结果中找到的 SPID 上设置过滤器。

有关如何连接 Profiler 的详细说明，请参阅 Amazon RDS 用户指南，特别是[Microsoft SQL Server 的常见 DBA 任务附录](http://docs.amazonwebservices.com/AmazonRDS/latest/UserGuide/Appendix.SQLServer.CommonDBATasks.html)。

# javascript - 根据条目数动态调整大小的 JSON 数据创建网格的最佳方法

> ID：14146526
> 
> 赞同：0
> 
> 时间：2013-01-03T20:17:20.417
> 
> 标签：javascript, jquery

我有一个像这样的简单 JSON：

> [{"NAME":"Bill","Score":25,"URL":"Bill.html"},{"NAME":"Jane","Score":16,"URL":"Jane.html "},{"NAME":"Xavier","Score":5,"URL":"Xavier.html"},{"NAME":"Hector","Score":32,"URL":"Hector .html"}]

实际的 JSON 有更多记录。我想在这样的页面上显示所有记录：

1) 在一个网格中（方框，没有标题行，每个方框中只出现 NAME 和 SCORE，点击方框时会转到 URL）。2) 随着人名被添加到 JSON 中，网格将自动调整每个框的大小以允许新名称的新框 - 网格始终使用父 div 的宽度和高度的 100%

因此，如果 JSON 中只有两个名称，则屏幕将被分成两半（水平或垂直）。如果 JSON 中有三个名称，则将有三个框（每个使用 1/3 的 div）。四个将有两行和两列，等等......实际的 JSON 将至少有 50 条记录，所以可能有 9 列和 6 行（空单元格位于右下角）但最终可能有 200 条记录（其中如果盒子会动态收缩以留出所需的空间）。

本质上，我希望有某种插件可以使用数据集创建这个网格，数据集的记录少至 10，但大至 500。

我不确定我是否非常清楚......我一直在阅读 JQuery 模板，我也遇到了这些：

*   [http://www.zachhunter.com/2010/04/json-objects-to-html-table](http://www.zachhunter.com/2010/04/json-objects-to-html-table)
*   [使用 JSON 数据创建表的 jQuery 函数](https://stackoverflow.com/questions/7803171/jquery-function-to-create-table-using-json-data)
*   [http://mvc.syncfusion.com/demos/ui/grid/Editing/JSONCRUD](http://mvc.syncfusion.com/demos/ui/grid/Editing/JSONCRUD)
*   [http://www.9lessons.info/2009/10/json-jquery-ajax-php.html](http://www.9lessons.info/2009/10/json-jquery-ajax-php.html)

我不确定哪个是最好的方法，或者是否有更简单的方法。我真的很感激你能给的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:22:57.370

您可以使用[同位素插件](http://isotope.metafizzy.co/)

配置太简单了

```
$('#container').isotope({
  // options
  itemSelector : '.item',
  layoutMode : 'fitRows'
}); 
```

# linux - 别名 - cd 后跟 ls

> ID：14146530
> 
> 赞同：4
> 
> 时间：2013-01-03T20:17:41.967
> 
> 标签：linux, alias, cd

如何定义别名，以便当我这样做`cd Abcd`时，“Abcd”是目录的名称，该目录更改为“Abcd”，然后`ls`显示目录的内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-10-06T07:12:41.850

我相信你不能使用别名来实现这一点，但你可以定义一个函数来做到这一点：

```
#print contents after moving to given directory
cl()
{
    cd $@
    ls
} 
```

您可以将其粘贴在您的`~/.bashrc`文件中。

如果您希望覆盖内置`cd`命令，那么您可以这样做：

```
#print contents after moving to given directory
cd()
{
    builtin cd $@
    ls
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-03T21:03:43.547

# UNIX

### 创建别名

您的 Linux 发行版很可能不会在您的家中创建 .bash_aliases 文件，或者您甚至可以手动创建它。要创建文件，请键入以下命令： `touch ~/.bash_alisaes`

现在，每次您启动新终端时，该文件都会自动执行。

您现在可以做的是创建一个别名列表并将它们添加到该文件以供以后使用。创建一个别名并更新 ~/.bash_aliases 文件以使其永久化。

### 通用方法：创建自定义脚本

在 /usr/bin 文件夹中创建一个 bash 脚本，它应该看起来像这样

```
#!/bin/bash
Whatever combination of commands you want to run when you type this thing. 
```

它真的那么容易。

只需将 bash 脚本命名为您想在终端中输入的内容，并使其可执行：chmod +x 文件名，您就可以开始了！

# 视窗

您可以使用**DOSKEY**命令：

来自维基百科：

> DOSKey 是一个用于 MS-DOS 和 Microsoft Windows 的实用程序，它向命令行解释器 COMMAND.COM 和 cmd.exe 添加了命令历史记录、宏功能和改进的编辑功能。它作为 TSR 程序包含在 MS-DOS 和 PC-DOS 版本 5 及更高版本以及 Microsoft 的 Windows 95/98/Me 中。

例如：要创建一个快速无条件格式化磁盘的宏，请输入：

> doskey qf=格式 $1 /q /u

要快速无条件地格式化驱动器 Z 中的磁盘，请键入：

> qf Z:

要定义具有多个命令的宏，请使用 $t 分隔命令，因此您的问题的解决方案如下：

> doskey cd=cd $1$tdir

现在，这仅适用于您当前打开的命令窗口。要使其永久化，只需创建一个批处理文件并将文件的绝对路径的值设置为*regedit*

> HKEY_LOCAL_MACHINE\Software\Microsoft\Command Processor\AutoRun

regedit 的来源：[superuser.com/a/238858](https://superuser.com/a/238858)

# linux - Linux命令按名称获取tomcat进程ID

> ID：14146536
> 
> 赞同：14
> 
> 时间：2013-01-03T20:17:53.923
> 
> 标签：linux, command-line

Linux命令行：

当我执行以下命令`ps -ef |grep tomcat`时，它会显示以下过程

```
abcapp   28119     1  0 12:53 ?        00:00:19 /usr/java/jdk1.6.0_10//bin/java -Xmx256m -Dabc.log.file=/home/app/apps/rum/logs/dev.log -Dabc.config=dev -Dlog4j.configuration=file:///home/abcapp/env/abc_env/abc_env-1.2/config/log4j-webapp.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.util.logging.config.file=/home/abcapp/env/tomcat/tomcat-5.5-26-rum/conf/logging.properties -Djava.endorsed.dirs=/home/abcapp/env/tomcat/tomcat-5.5-26-rum/common/endorsed -classpath :/home/abcapp/env/tomcat/tomcat-5.5-26-rum/bin/bootstrap.jar:/home/abcapp/env/tomcat/tomcat-5.5-26-rum/bin/commons-logging-api.jar -Dcatalina.base=/home/abcapp/env/tomcat/tomcat-5.5-26-rum -Dcatalina.home=/home/abcapp/env/tomcat/tomcat-5.5-26-rum -Djava.io.tmpdir=/home/abcapp/env/tomcat/tomcat-5.5-26-rum/temp org.apache.catalina.startup.Bootstrap start 
```

但是当我发出以下命令时，它什么也没显示

```
pgrep tomcat-5.5-26-rum OR pgrep "*-rum" 
```

有人可以帮助我如何通过名称正则表达式“*-rum”获取tomcat进程ID

提前致谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-03T20:27:17.657

pgrep 仅搜索没有完整路径（在您的情况下只有*java*）且没有参数的进程名称。

由于*tomcat-5.5-26-rum*是后者的一部分，我会搜索 pid

```
ps -ef | grep tomcat-5.5-26-rum | grep java | awk ' { print $2 } ' 
```

双 grep 对于丢弃 grep pid 本身很有用

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-21T23:41:54.370

`catalina.sh`只需在文件开头添加以下行

```
CATALINA_PID="$CATALINA_BASE"/logs/tomcat.pid 
```

或者

```
CATALINA_PID=/tmp/tomcat.pid 
```

并反弹tomcat。这将在给定路径中创建一个`tomcat.pid`文件，并将 Tomcat 进程 pid 放入其中。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-10-14T11:44:53.693

这对我有用：

This will give the process id of current running tomcat

echo `ps aux | grep org.apache.catalina.startup.Bootstrap | grep -v grep | awk '{ print $2 }'`

# coldfusion - CFSpreadsheet 在更新时会丢失 SpreadSheetAddFreezePane

> ID：14146539
> 
> 赞同：2
> 
> 时间：2013-01-03T20:18:01.383
> 
> 标签：coldfusion, coldfusion-9, coldfusion-10, cfspreadsheet

我正在尝试将电子表格添加到带有冻结窗格的工作簿中。如果操作是写入，则冻结窗格将起作用，但如果我使用更新添加另一个工作表，则冻结窗格将不起作用。

```
<cfscript> 
theSheet = SpreadsheetNew(SheetName); 
SpreadsheetAddRows(theSheet,TheQuery); 
format2=StructNew();
format2.font="Arial"; 
format2.fontsize="10"; 
format2.color="Black;"; 
format2.italic="False"; 
format2.bold="true"; 
format2.alignment="left"; 
format2.textwrap="true"; 
format2.fgcolor="tan"; 
format2.bottomborder="thick"; 
format2.bottombordercolor="Black"; 
format2.leftborder="thick"; 
format2.leftbordercolor="Black"; 
format2.rightborder="thick"; 
format2.rightbordercolor="Black";  
SpreadsheetFormatRows(theSheet,format2,"1-2");
SpreadsheetFormatColumns(theSheet,format2,"1-3");
SpreadSheetAddFreezePane(theSheet,3,1);
</cfscript> 
<cfspreadsheet filename="#theFile#" name="theSheet" sheet="#SheetCount#" action="update" sheetname="#SheetName#"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T00:22:23.683

听起来这可能是一个错误。除非有使用的特定原因，否则`action=update`我只会使用`action=write`。阅读工作簿。添加新工作表。让它活跃起来。然后将其写回磁盘。

```
<cfscript> 
    theSheet = SpreadSheetRead( theFile );
    SpreadsheetCreateSheet( theSheet, sheetName );
    SpreadSheetSetActiveSheet( theSheet, sheetName );
    // ... code to add data 
    SpreadSheetAddFreezePane( theSheet, 3, 1 );
    SpreadSheetWrite( theSheet, theFile, true );
</cfscript> 
```

正如 Adam 在评论中提到的，您可能需要[提交错误报告](https://bugbase.adobe.com/)（并在此处发布错误编号，以便其他人对其进行投票）。

# context-free-grammar - 为上下文无关语言抽取引理

> ID：14146542
> 
> 赞同：1
> 
> 时间：2013-01-03T20:18:08.177
> 
> 标签：context-free-grammar, formal-languages, pumping-lemma

我有一个关于上下文无关语言的特定泵引理问题的问题。

假设我们有以下语言：

```
L = {(a^i)(b^j)(c^k)(d^l) | 0 < i < k AND j > l > 0 } 
```

这是我试图证明该语言不是上下文无关的尝试：

假设 L 与上下文无关。从引理中取常数 n>0。

```
Let Z = (a^n)(b^n+1)(c^n+1)(d^n), Z ∈ L. 
```

比根据引理，Z 可以写成 Z = uvwxy，其中下列性质成立：

```
1\. |vx| >= 1
2\. |vwx| <= n
3\. for every i >= 0, u(v^i)w(x^i)y ∈ L. 
```

我们为 vwx 提供了 6 种不同的可能性

```
1\. vwx = a^i, i <= n
2\. vwx = (a^i)(b^j), i+j <= n
3\. vwx = b^i, i <= n
4\. vwx = (b^î)(c^j), i+j <= n
5\. vwx = (c^i), i <= n
6\. vwx = (c^i)(d^j)), i+j <= n 
```

到目前为止这是对的吗？我不确定的事情是，我的不同 vwx 案例是否正确。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:28:37.107

到目前为止，一切都很好，除了你错过了 vxy 完全由字符串末尾的 d 组成的情况。

# python - Wing Python 单元测试：我可以在 tearDownClass 中失败测试吗？

> ID：14146546
> 
> 赞同：2
> 
> 时间：2013-01-03T20:18:44.167
> 
> 标签：python, unit-testing, wing-ide

我有一堆方法需要测试。我想实施检查以确保我已经为每种方法编写了测试。如果我保持运行测试列表，我可以在我的 tearDownClass() 中检查这一点，但我无法从那里找到失败的方法。

如果我尝试这样做：

```
class TestSystem(unittest.TestCase):

    class TestAB(TestSystem):
        @classmethod
        def setUpClass(self):
            print "ABSetup"

        @classmethod
        def tearDownClass(self):
            if (testsNotImplemented()):
                self.fail() #I'd like to fail TestAB here
            print "ABTeardown" 
```

我得到一个类型错误：`unbound method fail() must be called with TestAB instance as first argument (got type instance instead)`

这样做的正确方法是什么？即使只是打印一条消息也可以（如果不理想的话），但据我所知，wing 不会通过设置和拆卸方法输出“打印”消息。

[这个](https://stackoverflow.com/q/11976914/1286571)问题很相似，但我不希望测试崩溃，只是失败。

# magento - Magento 1.7 SEO 友好的 URL 和多商店视图

> ID：14146560
> 
> 赞同：4
> 
> 时间：2013-01-03T20:19:38.343
> 
> 标签：magento, url, translation

Magento 具有用于创建自定义 SEO 友好 URL 键的产品和类别字段。但是当您有多个商店时，通常不能为不同的商店使用不同的 URL 键，因为 url_key 字段默认为“GLOBAL”。对于产品，您可以从属性管理将 url_key 属性的 is_default 字段更新为“商店视图”。但是对于类别的 url_key 字段，Magento 中没有该选项。但是数据库中确实存在该字段，属性代码相同，但 backend_model 不同，因此您需要直接进入数据库并将“is_global”字段 1 更改为 0。

参考： http: [//www.devraju.com/magento/differ-category-url-keys-for-different-store-views-in-magento/](http://www.devraju.com/magento/different-category-url-keys-for-different-store-views-in-magento/) 查看页面底部的评论。

同样的问题： [Magento 多语言 - 404 语言结果的双重变化（或如何在商店而不是视图中更改语言）](https://stackoverflow.com/questions/9096622/magento-multilanguage-double-change-in-language-resuts-in-404-or-how-to-chang)

这种策略似乎在旧版本中有效，但在 7.1 中我遇到了麻烦。当我转到目录 >> 属性 >> 管理属性时， url_key 属性已经设置为存储视图。见下图。

![在此处输入图像描述](../Images/73dd17f126214f24a76d9e7ec51e4a48.png)

此外，属性表看起来配置正确。请参阅下面的 SQL。

切换代码如下所示：

```
 <?php if(count($this->getStores())>1): ?>
    <div class="form-language">
        <label for="select-language"><?php echo $this->__('Your Language:') ?></label>
        <select id="select-language" title="<?php echo $this->__('Your Language') ?>" onchange="window.location.href=this.value">
        <?php foreach ($this->getStores() as $_lang): ?>
            <?php $_selected = ($_lang->getId() == $this->getCurrentStoreId()) ? ' selected="selected"' : '' ?>
            <option value="<?php echo $_lang->getCurrentUrl() ?>"<?php echo $_selected ?>><?php echo $this->htmlEscape($_lang->getName()) ?></option>
        <?php endforeach; ?>
        </select>
    </div>
    <?php endif; ?> 
```

SQL 语句

```
SELECT * FROM eav_attribute WHERE attribute_code LIKE '%url_key%';  

attribute_id Attribute Id   entity_type_id Entity Type Id   attribute_code Attribute 
    Edit    Delete  43  3   url_key  catalog/category_attribute_backend_urlkey  
    Edit    Delete  97  4   url_key  catalog/product_attribute_backend_urlkey  

SELECT attribute_id, is_global FROM catalog_eav_attribute WHERE attribute_id=43;
SELECT attribute_id, is_global FROM catalog_eav_attribute WHERE attribute_id=97;

Full Texts  attribute_id Attribute ID   is_global Is Global
    Edit    Delete  43  0

Full Texts  attribute_id Attribute ID   is_global Is Global
    Edit    Delete  97  0 
```

我也尝试使用重写规则来解决它，但是重写规则似乎没有涵盖语言切换。参考： http: [//www.magentocommerce.com/wiki/modules_reference/english/mage_adminhtml/urlrewrite/index](http://www.magentocommerce.com/wiki/modules_reference/english/mage_adminhtml/urlrewrite/index)

我正在寻找具有适当代码修改的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-11T03:42:59.867

这件事也花了我几天的时间。我在相关表中应用了更改 is_global 字段，但这只适用于我的本地服务器，无法使其在实时服务器上运行（不知道为什么）。

尝试了多种解决方案，我从管理面板中发现了一个简单的解决方案。

尝试

> 目录-> URl 重写管理-> 添加 url 重写-> 选择'for category' -> 选择类别-> 选择商店，添加 url，选择重定向'否'并保存。

注意：这可能不会影响您的菜单链接，您可以在菜单类别链接中添加自定义 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-31T12:29:14.060

这篇文章对你有帮助吗？

[https://mobweb.ch/2014-08-22-multi-language-magento-shop-translate-category-and-product-urls/](https://mobweb.ch/2014-08-22-multi-language-magento-shop-translate-category-and-product-urls/)

似乎可以解决您的问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T00:11:07.743

如果您复制当前类别根树并使用不同的 url 键，然后为每个商店分配自己的根类别树，该怎么办。（不是理想的解决方案，但无需任何修改或编程即可工作）

请参阅[创建和分配根类别](http://www.magentocommerce.com/wiki/3_-_store_setup_and_management/catalog/creating_and_assigning_root_categories)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-25T07:32:52.543

我遇到了同样的问题，在创建新产品时显示错误“具有“url_key”属性的产品已经存在”

我将 url_key 更改为可选字段，它对我有用。

# c# - .NET 服务向 HttpWebRequest POSTS 响应 500 内部错误和“缺少参数”，但测试表单工作正常

> ID：14146564
> 
> 赞同：0
> 
> 时间：2013-01-03T20:19:49.030
> 
> 标签：c#, .net, web-services, httpwebrequest, asmx

我正在使用一个简单的 .NET 服务 (asmx)，它在通过测试表单 (POST) 调用时可以正常工作。通过 HttpWebRequest 对象调用时，我收到 WebException “System.Net.WebException：远程服务器返回错误：（500）内部服务器错误。” 深入挖掘，阅读 WebException.Response.GetResponseStream() 我收到消息：“缺少参数：serviceType。” 但我已经清楚地包含了这个参数。

我在这里不知所措，更糟糕的是我无权调试服务本身。

这是用于发出请求的代码：

```
string postData = String.Format("serviceType={0}&SaleID={1}&Zip={2}", request.service, request.saleId, request.postalCode);
byte[] data = (new ASCIIEncoding()).GetBytes(postData);

HttpWebRequest httpWebRequest = (HttpWebRequest)WebRequest.Create(url);
httpWebRequest.Timeout = 60000;
httpWebRequest.Method = "POST";
httpWebRequest.ContentType = "application/x-www-form-urlencoded";
httpWebRequest.ContentLength =  data.Length;

using (Stream newStream = httpWebRequest.GetRequestStream())
{
    newStream.Write(data, 0, data.Length);
}

try
{
    using (response = (HttpWebResponse)httpWebRequest.GetResponse())
    {
        if (response.StatusCode != HttpStatusCode.OK)
            throw new Exception("There was an error with the shipping freight service.");

        string responseData;
        using (StreamReader responseStream = new      StreamReader(httpWebRequest.GetResponse().GetResponseStream(),    System.Text.Encoding.GetEncoding("iso-8859-1")))
        {
            responseData = responseStream.ReadToEnd();
            responseStream.Close();
        }

        if (string.IsNullOrEmpty(responseData))
            throw new Exception("There was an error with the shipping freight service.  Request went through but response is empty.");

        XmlDocument providerResponse = new XmlDocument();
        providerResponse.LoadXml(responseData);

        return providerResponse;
    }
}
catch (WebException webExp)
{
    string exMessage = webExp.Message;

    if (webExp.Response != null)
    {
        using (StreamReader responseReader = new StreamReader(webExp.Response.GetResponseStream()))
        {
            exMessage = responseReader.ReadToEnd();
        }
    }

    throw new Exception(exMessage);
} 
```

有人知道会发生什么吗？

谢谢。

更新

单步调试器，我看到参数是正确的。我还看到提琴手中的参数是正确的。

检查提琴手，每次执行此代码时我都会收到 2 个请求。第一个请求是发送参数的帖子。它会收到一个 301 响应代码，其中包含“文档已移动对象已移动，此文档可以在此处找到”消息。第二个请求是对没有正文的相同 URL 的 GET。它收到一个带有“缺少参数：serviceType”的 500 服务器错误。信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T22:40:19.727

当您查看 Fiddler 中的请求时，您似乎发现了问题。摘自[http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)：

> **10.3.2 301 永久移动**
> 
> 请求的资源已被分配一个新的永久 URI，并且任何将来对该资源的引用都应该使用返回的 URI 之一。如果可能，具有链接编辑功能的客户端应该自动将对 Request-URI 的引用重新链接到服务器返回的一个或多个新引用。
> 
> ......
> 
> *注意：当收到 301 状态码后自动重定向 POST 请求时，一些现有的 HTTP/1.0 用户代理会错误地将其更改为 GET 请求。*

您可以采取以下几个选项：

1.  硬编码您的程序以使用您在 Fiddler 的 301 响应中看到的新 Url
2.  调整您的代码以检索 301 响应，从响应中解析出新的 Url，并使用新的 Url 构建新的响应。

如果您正在处理 Url 上基于用户的输入（如 Web 浏览器），后一种选择将是理想的，因为您不知道用户希望您的程序去哪里。

# android - SQliteDatabase：SQLiteCantOpenDatabaseException 错误，请查看

> ID：14146565
> 
> 赞同：0
> 
> 时间：2013-01-03T20:19:55.240
> 
> 标签：android, sqliteopenhelper, sqlite

我正在使用 SQLiteDatabase，但出现以下错误`android.database.sqlite.SQLiteCantOpenDatabaseException`。我的活动看起来像这样：我试图在同一个活动中查询数据库两次。而且我每次都分别初始化数据库和游标。

```
try {
        DBHelper dbHelper = new DBHelper(this.getApplicationContext());
        MyData = dbHelper.getWritableDatabase();
        Cursor c = MyData.rawQuery("SELECT * FROM " + tableName
                + " where Category = '" + category + "'", null);

        results.clear();
        if (c != null) {
            if (c.moveToFirst()) {
                do {
                    String subcat = c.getString(c
                            .getColumnIndex("Subcategory"));

                    results.add(subcat);
                } while (c.moveToNext());
            }
            c.close();
        }
    } catch (SQLiteException se) {
        Log.e(getClass().getSimpleName(),
                "Could not create or Open the database");
    } finally {
        if (MyData != null)
            MyData.execSQL("DELETE FROM " + tableName);
        MyData.close();
    } 
```

我假设错误是由于没有正确关闭数据库。有人可以检查我的代码吗？下面是我的**助手类**。

```
 public SQLiteDatabase DB;
public String DBPath;
public static String DBName = "sampledatabase";
public static final int version = '1';
public static Context currentContext;
public static String tableName = "MyDatabaseapp";

private static DBHelper mInstance = null;

public DBHelper getInstance(Context activityContext) {

    // Get the application context from the activityContext to prevent leak
    if (mInstance == null) {

        mInstance = new DBHelper(activityContext.getApplicationContext());

    }
    return mInstance;
}

public DBHelper(Context applicationContext) {
    super(applicationContext, DBName, null, version);

    currentContext = applicationContext;
    DBPath = "/data/data/" + applicationContext.getPackageName()
            + "/databases";     
    createDatabase();   

}
@Override
public void onCreate(SQLiteDatabase db) {
    // TODO Auto-generated method stub
}
@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // TODO Auto-generated method stub

}

private void createDatabase() {
    boolean dbExists = checkDbExists();

    if (dbExists) {
        // do nothing

    } else {
        DB = currentContext.openOrCreateDatabase(DBName, 0, null);
        DB.execSQL("CREATE TABLE IF NOT EXISTS " + tableName
                + " (Category VARCHAR, Subcategory VARCHAR,"
                + " Imageurl VARCHAR, Position INT(3));");

        DB.execSQL("INSERT INTO "
                + tableName
                + " Values ('0','HOT TUB','http://www.massagetherapyreviews.com',1);");
        DB.execSQL("INSERT INTO "
                + tableName
                + " Values ('0','RADIANT','http://www.massagetherapyreviews.com',2);");

        DB.close();
    }

}

private boolean checkDbExists() {
    SQLiteDatabase checkDB = null;

    try {
        String myPath = DBPath + DBName;
        checkDB = SQLiteDatabase.openDatabase(myPath, null,
                SQLiteDatabase.OPEN_READONLY);

    } catch (SQLiteException e) {

        // database does't exist yet.
    }

    if (checkDB != null) {
        checkDB.close();
    }

    return checkDB != null ? true : false;
    } 
```

我的 logcat 看起来像这样：

```
 01-04 01:47:20.572: E/SQLiteDatabase(10274): close() was never explicitly called on database '/data/data/com.afsmedia.android/databases/sample' 
01-04 01:47:20.572: E/SQLiteDatabase(10274): android.database.sqlite.DatabaseObjectNotClosedException: Application did not close the cursor or database object that was opened here
01-04 01:47:20.572: E/SQLiteDatabase(10274):    at android.database.sqlite.SQLiteDatabase.<init>(SQLiteDatabase.java:2072)
01-04 01:47:20.572: E/SQLiteDatabase(10274):    at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:1126)
01-04 01:47:20.572: E/SQLiteDatabase(10274):    at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:1083)
01-04 01:47:20.572: E/SQLiteDatabase(10274):    at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:1059)
01-04 01:47:20.572: E/SQLiteDatabase(10274):    at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:1162) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T22:11:44.963

很久以前我也有类似的问题。尝试这个

```
@Override
protected void onDestroy() {
    super.onDestroy();
    if (c!= null)
        c.close();
    if (dbHelper != null) {
        dbHelper.close();
    }
} 
```

# java - Android ListView 不显示数据...在这方面很新，而且我肯定做错了什么

> ID：14146569
> 
> 赞同：0
> 
> 时间：2013-01-03T20:20:07.577
> 
> 标签：java, android

这是我的第二个应用，也是第一个使用 ListActivity。某处的播放效果不佳 - 活动 (ShowWidget) 显示 - 但列表为空。

这是我的 ListActivity 代码：

```
import android.app.ListActivity;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.Toast;

public class ShowWidget extends ListActivity  {
  DataProvider db = new DataProvider(ShowWidget.this);
  public static String sound;
  MediaPlayer mp = new MediaPlayer();
  @SuppressWarnings("unused")
  private ListView LV;

    @Override
    protected void onCreate(Bundle savedInstanceState){
      super.onCreate(savedInstanceState);
      Toast.makeText(getApplicationContext(), "Loading your settings.", Toast.LENGTH_SHORT).show();

      LV = (ListView)findViewById(android.R.id.list);
        setListAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, PENS));
        getListView().setTextFilterEnabled(true);

      // change to our configure view
      setContentView(R.layout.widget_show);

      /*db.open();
      Cursor cursor = db.getRecord(1);
      ShowWidget.sound  = cursor.getString(cursor.getColumnIndex("sound"));
      cursor.close();
      db.close();*/
    }

    static final String[] PENS = new String[]{
      "MONT Blanc", "Gucci", "Parker", "Sailor",
      "Porsche Design", "Rotring", "Sheaffer", "Waterman"
    };

    protected void onListItemClick(ListView l, View v, int position, long id) {
      super.onListItemClick(l, v, position, id);
      Object o = this.getListAdapter().getItem(position);
      String pen = o.toString();
      Toast.makeText(this, "You have chosen the pen: " + " " + pen, Toast.LENGTH_LONG).show();
    }

  public void play(){
    }
} 
```

和我的布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:id="@+id/widgetShow">

    <ListView
    android:layout_width="0dp"
    android:layout_height="0dp"
    android:id="@android:id/list"
    android:layout_weight="1">

  </ListView>

</LinearLayout> 
```

就像我说的，我在这里做错了 - 活动显示，但不是存储在 PENS 中的数据。任何朝着正确方向的想法或观点将不胜感激！如果问题不清楚，请发表评论，我会编辑问题以使其更清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:30:32.930

尝试像这样编辑布局文件：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:id="@+id/widgetShow">

    <ListView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:id="@android:id/list">

    </ListView>

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:32:35.597

这是您处理 UI 组件的顺序。`ListView`首先，您从**默认**布局（导入实现）膨胀，但之后，您基本上告诉`Activity`使用其他布局，称为`R.layout.widget_show`. 因此，您在屏幕上看到的并不是您将适配器设置为的。

您没有收到实际错误的原因是因为您正在扩展`ListActivity`，它定义了一个包含`ListView`. 在任何常规`Activity`中，您都会得到一个`NullPointerException`，因为尚未设置内容视图，因此`Activity`不知道从哪里扩展视图。

更改您的代码如下：

```
@Override protected void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    // tell activity to use your custom layout:
    setContentView(R.layout.widget_show);      
    // set adapter etc   
    setListAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, PENS));
    getListView().setTextFilterEnabled(true);
} 
```

由于您`ListView`在布局文件中使用 id声明了`@android:id/list`（这也是使用 的要求`ListActivity`），因此您可以免费获得一些方便的方法，其中您不必手动膨胀`ListView`. 因此，您可以`getListView()`在设置内容视图后使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T20:27:11.067

尝试改变：

```
setListAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, PENS)); 
```

到：

```
setListAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, android.R.id.text1, PENS); 
```

# java - 通过反射在 Java 中调用 getter：重复调用它的最快方法是什么（性能和可伸缩性方面）？

> ID：14146570
> 
> 赞同：17
> 
> 时间：2013-01-03T20:20:10.380
> 
> 标签：java, performance, reflection

给定一个类`Foo`和一个属性`bar`，*我在编译时都不知道*，我需要多次多次调用 getter `Foo.getBar()`。

假设我有：

```
Method barGetterMethod = ...; // Don't worry how I got this 
```

我需要做这样的事情：

```
for (Object foo : fooList) { // 1000000000 elements in fooList
    Object bar = barGetterMethod.invoke(foo);
    ...
} 
```

与在没有反射的情况下调用它相比，上面的实现仍然非常慢。有更快的方法吗？

在 Java 中使用反射调用 getter 的最快方法是什么？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-01-03T20:41:57.660

您可能会使用[MethodHandle](http://docs.oracle.com/javase/7/docs/api/java/lang/invoke/MethodHandle.html)。它的 Javadoc 写道：

> 使用 Lookup API 中的工厂方法，由 Core Reflection API 对象表示的任何类成员都可以转换为行为等效的方法句柄。例如，可以使用 Lookup.unreflect 将反射方法转换为方法句柄。生成的方法句柄通常提供对底层类成员的更直接和有效的访问。

虽然这将减少开销，但如果使用通常的（非反射性）字节码指令进行调用，方法句柄仍会阻止 JVM 可以采用的某些优化（例如方法内联）。这种优化是否有益取决于您如何使用该方法（如果该代码路径总是调用相同的方法，则内联会有所帮助，如果每次都是不同的方法，则可能不会）。

以下微基准测试可能会让您大致了解反射、方法句柄和直接调用的相对性能：

```
package tools.bench;

import java.lang.invoke.MethodHandle;
import java.lang.invoke.MethodHandles;
import java.lang.reflect.Method;
import java.math.BigDecimal;

public abstract class Bench {

    final String name;

    public Bench(String name) {
        this.name = name;
    }

    abstract int run(int iterations) throws Throwable;

    private BigDecimal time() {
        try {
            int nextI = 1;
            int i;
            long duration;
            do {
                i = nextI;
                long start = System.nanoTime();
                run(i);
                duration = System.nanoTime() - start;
                nextI = (i << 1) | 1; 
            } while (duration < 100000000 && nextI > 0);
            return new BigDecimal((duration) * 1000 / i).movePointLeft(3);
        } catch (Throwable e) {
            throw new RuntimeException(e);
        }
    }   

    @Override
    public String toString() {
        return name + "\t" + time() + " ns";
    }

    static class C {
        public Integer foo() {
            return 1;
        }
    }

    static final MethodHandle sfmh;

    static {
        try {
            Method m = C.class.getMethod("foo");
            sfmh = MethodHandles.lookup().unreflect(m);
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    public static void main(String[] args) throws Exception {
        final C invocationTarget = new C();
        final Method m = C.class.getMethod("foo");
        final Method am = C.class.getMethod("foo");
        am.setAccessible(true);
        final MethodHandle mh = sfmh;

        Bench[] marks = {
            new Bench("reflective invocation (without setAccessible)") {
                @Override int run(int iterations) throws Throwable {
                    int x = 0;
                    for (int i = 0; i < iterations; i++) {
                        x += (Integer) m.invoke(invocationTarget);
                    }
                    return x;
                }
            },
            new Bench("reflective invocation (with setAccessible)") {                   
                @Override int run(int iterations) throws Throwable {
                    int x = 0;
                    for (int i = 0; i < iterations; i++) {
                        x += (Integer) am.invoke(invocationTarget);
                    }
                    return x;
                }
            },
            new Bench("methodhandle invocation") {
                @Override int run(int iterations) throws Throwable {
                    int x = 0;
                    for (int i = 0; i < iterations; i++) {
                        x += (Integer) mh.invokeExact(invocationTarget);
                    }
                    return x;
                }
            },
            new Bench("static final methodhandle invocation") {
                @Override int run(int iterations) throws Throwable {
                    int x = 0;
                    for (int i = 0; i < iterations; i++) {
                        x += (Integer) sfmh.invokeExact(invocationTarget);
                    }
                    return x;
                }
            },
            new Bench("direct invocation") {
                @Override int run(int iterations) throws Throwable {
                    int x = 0;
                    for (int i = 0; i < iterations; i++) {
                        x += invocationTarget.foo();
                    }
                    return x;
                }
            },
        };
        for (Bench bm : marks) {
            System.out.println(bm);
        }
    }
} 
```

在我有点过时的笔记本上

```
java version "1.7.0_02"
Java(TM) SE Runtime Environment (build 1.7.0_02-b13)
Java HotSpot(TM) Client VM (build 22.0-b10, mixed mode, sharing) 
```

这打印：

```
reflective invocation (without setAccessible)   568.506 ns
reflective invocation (with setAccessible)  42.377 ns
methodhandle invocation 27.461 ns
static final methodhandle invocation    9.402 ns
direct invocation   9.363 ns 
```

更新：正如 Irreputable 指出的那样，服务器 VM 的性能特征有些不同，因此**在服务器 VM 中使用 MethodHandle 只会有帮助，前提是您可以将它放在静态 final 字段中**，在这种情况下，VM 可以内联调用：

```
reflective invocation (without setAccessible)   9.736 ns
reflective invocation (with setAccessible)  7.113 ns
methodhandle invocation 26.319 ns
static final methodhandle invocation    0.045 ns
direct invocation   0.044 ns 
```

我建议您衡量您的特定用例。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-03T20:25:27.260

呼叫`barReadMethod.setAccessible(true);`会关闭安全检查，这可以使其更快一些。即使它是可访问的，它也必须另外检查。

如果我运行使用带有和不带有可访问 true 的 getter 方法。

```
class Main {
    static class A {
        private final Integer i;

        A(Integer i) {
            this.i = i;
        }

        public Integer getI() {
            return i;
        }
    }

    public static void main(String... args) throws IllegalAccessException, NoSuchMethodException, InvocationTargetException {
        A[] as = new A[100000];
        for (int i = 0; i < as.length; i++)
            as[i] = new A(i);

        for (int i = 0; i < 5; i++) {
            long time1 = timeSetAccessible(as);
            long time2 = timeNotSetAccessible(as);
            System.out.printf("With setAccessible true %.1f ns, Without setAccessible %.1f ns%n",
                   (double) time1 / as.length, (double) time2 / as.length);
        }
    }

    static long dontOptimiseAvay = 0;

    private static long timeSetAccessible(A[] as) throws IllegalAccessException, NoSuchMethodException, InvocationTargetException {
        Method getter = A.class.getDeclaredMethod("getI");
        getter.setAccessible(true);
        dontOptimiseAvay = 0;
        long start = System.nanoTime();
        for (A a : as) {
            dontOptimiseAvay += (Integer) getter.invoke(a);
        }
        return System.nanoTime() - start;
    }

    private static long timeNotSetAccessible(A[] as) throws IllegalAccessException, NoSuchMethodException, InvocationTargetException {
        Method getter = A.class.getDeclaredMethod("getI");
//        getter.setAccessible(true);
        dontOptimiseAvay = 0;
        long start = System.nanoTime();
        for (A a : as) {
            dontOptimiseAvay += (Integer) getter.invoke(a);
        }
        return System.nanoTime() - start;
    }
} 
```

印刷

```
With setAccessible true 106.4 ns, Without setAccessible 126.9 ns
With setAccessible true 5.4 ns, Without setAccessible 29.4 ns
With setAccessible true 3.2 ns, Without setAccessible 9.9 ns
With setAccessible true 3.1 ns, Without setAccessible 9.0 ns
With setAccessible true 3.1 ns, Without setAccessible 8.9 ns 
```

对于简单的 getter，使用 setAccessible(true) 可以快三倍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-31T18:04:38.573

如果上面讨论的静态最终 MethodHandle 选项不实用/不可能，另一种选择是使用[bytebuddy](http://bytebuddy.net)动态生成一个类，该类有一个采用 foo 的方法，在 foo 上调用 bar 方法并返回结果。

这将为 bar 的单个调用提供与直接调用基本相同的性能（包装的调用最终可能是内联的）。

但是，这会产生 1 次为类和方法生成字节码的成本。根据 bytebuddy 网站，此成本约为 200ns。

# c++ - 访问冲突 - 为什么基类析构函数被调用两次？

> ID：14146572
> 
> 赞同：1
> 
> 时间：2013-01-03T20:20:15.427
> 
> 标签：c++, inheritance, decorator, access-violation, virtual-destructor

我有一个`Player`尝试实现该`Decorator`模式的类。`Player`包含其基类的成员，`Character`称为`m_player`. 从客户端调用析构函数时`Player`，我遇到了一些导致内存访问冲突的问题。开始于`main`：

```
Character* createBaseClass();

// more forward declarations

int main (int argc, char* const argv[]) 
{
    Player* mainCharacter = new Player(createBaseCharacter());

    delete mainCharacter;   // Crashes when calling delete

    return 0;
}

Character* createBaseCharacter()
{
    return Character::Builder()
        .name("Dylan")
        .description("Super bad-ass hero of the game")
        .build();
} 
```

`delete`在我调用操作员 on后不久发生错误，该操作员`mainCharacter`具有以下调用顺序：

```
Player::~Player()
{
    delete m_armor;
    delete m_weapon;
    delete m_player;  // calls Character's destructor
} 
```

然后是析构函数`Character`：

```
Character::~Character()
{
    // works fine
    //
    delete m_abilityAttributes;  
    m_abilityAttributes = NULL;
    delete m_primaryAttributes;
    m_primaryAttributes = NULL;
} 
```

**然而**，奇怪的是，这个析构函数似乎被调用了两次——一旦完成上述操作，调试器就会带我进入一个反汇编，逐步通过“标量删除析构函数”，它似乎`Character`再次调用析构函数，通过的接口`Player`，称为`CharacterDecorator`：

![在此处输入图像描述](../Images/eb0b50e38efdb97b166f306542ec5763.png)

崩溃点的调用堆栈：

![在此处输入图像描述](../Images/fe1d550312121495012dd34d388914d8.png)

调用`CharacterDecorator`' 的析构函数会导致随后调用`Character`' 的析构函数：

```
Character::~Character()
{
    // Crashes with Access Violation
    //
    delete m_abilityAttributes;  
    m_abilityAttributes = NULL;
    delete m_primaryAttributes;
    m_primaryAttributes = NULL;
} 
```

在这一点上，我完全糊涂了——我不知道为什么析构函数会通过抽象接口再次被调用，而析构函数会`CharacterDecorator`通过其具体实现被调用。此外，添加析构函数`CharacterDecorator`似乎并不能解决问题。

作为参考，我已经包含了 的实现`Player`和`Character`接口`CharacterDecorator`：

```
class CharacterDecorator : public Character
{
public:

    virtual Armor* getArmor() const = 0;
    virtual Weapon* getWeapon() const = 0;
}; 
```

`Player`：

```
Player::Player()
{}

Player::Player(Character* player)
    :m_player(player)
    ,m_weapon(0)
    ,m_armor(0)
{}

Player::Player(Character* player, Weapon* weapon, Armor* armor)
    :m_player(player) 
    ,m_weapon(weapon)
    ,m_armor(armor)
{}

Player::~Player()
{
    delete m_armor;
    delete m_weapon;
}

// getters
Armor* Player::getArmor() const
{
    return m_armor;
}

Weapon* Player::getWeapon() const
{
    return m_weapon;
}

// additional methods ... 
```

`Character`：

```
Character::Character()
{}

Character::Character(const Builder& builder)
    :m_name(builder._name)
    ,m_description(builder._description)
    ,m_abilityAttributes(builder._abilityAttributes)
    ,m_primaryAttributes(builder._primaryAttributes)
{}

Character::Character(const Character& rhs)
{
    m_name = rhs.m_name;
    m_description = rhs.m_description;
    m_abilityAttributes = new AbilityAttributes();
    m_primaryAttributes = new PrimaryAttributes();
    *m_abilityAttributes = *rhs.m_abilityAttributes;
    *m_primaryAttributes = *rhs.m_primaryAttributes;
}

Character::~Character()
{
    delete m_abilityAttributes;
    m_abilityAttributes = NULL;
    delete m_primaryAttributes;
    m_primaryAttributes = NULL;
}

// additional methods ...

// Builder pattern methods
//
Character::Builder::Builder()
    : _abilityAttributes(0), _primaryAttributes(0)
{}

Character* Character::Builder::build()
{
    return new Character(*this);
}

Character::Builder& Character::Builder::abilityAttributes(AbilityAttributes* value)
{
    _abilityAttributes = value;
    return *this;
}

Character::Builder& Character::Builder::primaryAttributes(PrimaryAttributes* value)
{
    _primaryAttributes = value;
    return *this;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T01:43:52.837

您的`Player`类继承自`CharacterDecorator`，继承自`Character`。因此，当您在`Player`对象上调用析构函数时，您将删除 m_player 对象（调用其`Character`析构函数），然后再次在对象的基础`Character`部分上`Player`。除了我不是你想要做的事情之外，你还有一个问题，当你创建时`Player`，默认`Character`构造函数被调用来创建基础`Character`对象，而这个没有初始化任何`Character`部分即像和你在析构函数中删除的`Player`字段。`m_abilityAttributes``m_primaryAttributes``Character`

现在，`Character`您的`Player`. 您可能希望您的`Player`构造函数采用`Character::Builder`引用而不是`Character`指针，该指针将用于初始化/构建`Character`您的“CharacterDecorator `(and you may have to have a`CharacterDecorator `constructor taking a`Character::Builder `object to initialize its`Character”基础的基础）。

（注意：有一个 m_player 成员指向 a`Character`对我来说是一个危险信号）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T01:27:57.863

虽然我提供了一个不带参数的构造函数，但我没有给它一个指针类型成员的初始化列表：

```
Character::Character() 
{} 
```

应该：

```
Character::Character() 
    : m_abilityAttributes(0), m_primaryAttributes(0)
{} 
```

我猜这是因为基类的构造函数`Character`在我实例化 的对象时被调用`Player`，但是基类的默认构造函数之前没有成员初始化列表，因此调用基析构函数时出现访问冲突错误 (? )

# asp.net-mvc-3 - MVC3：自定义 AuthorizeAttribute

> ID：14146573
> 
> 赞同：3
> 
> 时间：2013-01-03T20:20:18.383
> 
> 标签：asp.net-mvc-3

我正在实施一个`Custom Authorize Attribute`in `MVC3`。我将页面级别权限存储在数据库中，并希望将我的授权属性传递给页面 ID。类似的东西：

```
[CustomAuthorize(PageID = 1)]
public ActionResult About()
{
    return View();
} 
```

我如何实现`Authorize Attribute`, 作为`AuthorizeCore`覆盖中唯一的一个参数？

```
public class CustomAuthorizeAttribute : AuthorizeAttribute
{
    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T20:29:08.913

您将定义一个类级别的变量来保存 PageID，并且您的属性的构造函数会将其作为参数。或者要像在示例中那样使用它，您将创建一个名为 PageID 的公共属性。

```
public class CustomAuthorizeAttribute : AuthorizeAttribute
{
    public int PageID{get; set;}

    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
         //use PageID to do checks here.
    }
} 
```

然后在您的`AuthorizeCore`中，您将使用该属性/字段值进行检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-19T04:29:47.660

（自定义用户类型）只是一些调整

测试控制器

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;

namespace Authorise.Controllers
{
    public class TestController : Controller
    {
        // GET: /Default1/
        [CustomAuthorize(UserType = "Admin")]
        public ActionResult Index()
        {
            return View();
        }

    }

    public class CustomAuthorizeAttribute : AuthorizeAttribute
    {
        public string UserType { get; set; }

        protected override bool AuthorizeCore(HttpContextBase httpContext)
        {
            if (UserType == "Admin")
            {
                return true;
            }
            else
            {
                return false;
            }
        }
    }
} 
```

测试视图

```
@{
    ViewBag.Title = "Test";
}

<h2>Test</h2> 
```

帐户控制器

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;

namespace Authorise.Controllers
{
    public class AccountController : Controller
    {
        //
        // GET: /Account/

        public ActionResult Index()
        {
            return View();
        }
        public ActionResult LogOn()
        {
            return View();
        }

    }
} 
```

帐户登录视图

```
@{
   ViewBag.Title = "LogOn";
} 
```

## 登录

# box-api - 按名称查找文件夹或文件

> ID：14146576
> 
> 赞同：0
> 
> 时间：2013-01-03T20:20:39.710
> 
> 标签：box-api

我想知道 V2 api 中是否有办法按名称查找文件或文件夹。在搜索中，我们是否可以提及此类过滤器以查找项目类型和项目名称或使用通配符或正则表达式。

谢谢，阿伦

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T15:30:34.393

V2 API 中有一个搜索端点，您可以在该端点上执行 GET /search?query=。文档位于[http://developers.box.com/docs/#search-searching-a-users-account](http://developers.box.com/docs/#search-searching-a-users-account)

它不支持项目类型、通配符和正则表达式的过滤器。它使用起始搜索算法，因此可以使用该算法按名称查找文件或文件夹。我们将来可能会支持其中的一些想法。

# php - 在一个 php 代码中对多个链接使用 $_GET

> ID：14146577
> 
> 赞同：-1
> 
> 时间：2013-01-03T20:20:41.353
> 
> 标签：php, get, hyperlink

这里是 PHP 新手。我有一个注册表单，当您在注册时遇到错误时，它只是重定向回表单，而不是告诉错误是什么。所以我想做一个error.php，并让它，而不是重定向到注册页面，重定向到error.php?error=whatever..事情是，我不知道如何使用$_GET方法之类的。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:37:23.540

**重定向时**

最好的方法是 IMO 是[通过 AJAX 将表单数据发送](http://api.jquery.com/jQuery.ajax/)到您的 PHP 文件，然后让您的 PHP 文件以是/否响应数据是否有效。一旦 AJAX 返回表明您的数据有效，然后进入注册页面（或您要去的任何地方）。

这避免了用户为了找出他们做错了什么表单数据而来回走动的需要。

**在 $_GET**

请参阅[`$_GET`PHP 手册部分](http://php.net/manual/en/reserved.variables.get.php)。您可以`$_GET`作为数组访问，或从中获取特定值。

这个 PHP...

```
<?php
    echo $_GET['example'];
?> 
```

...将检索并回显以下文本框的值。

```
<form method="get" action="targetFile.php">
    <input name="example" type="text" />
</form> 
```

另外，请确保您在某种服务器上运行它，即使它是本地的。单独的 Web 浏览器无法处理 PHP，因此会给您“厄运的白页”。我使用[XAMPP](http://www.apachefriends.org/en/xampp.html)。

我知道有些人讨厌 W3schools，但如果你还在苦苦挣扎，请查看[本指南](http://www.w3schools.com/php/php_get.asp)。

# java - 使用特定格式将日历转换为 XMLGregorianCalendar

> ID：14146578
> 
> 赞同：7
> 
> 时间：2013-01-03T20:20:47.873
> 
> 标签：java

我在将日历对象转换为 .xml 格式的 XMLGregorian 日历时遇到了一些问题`YYYY-MM-DD HH:mm:ss`。

我目前的代码是：

```
Calendar createDate = tRow.getBasic().getDateCreated(0).getSearchValue();
Date cDate = createDate.getTime();
GregorianCalendar c = new GregorianCalendar();
c.setTime(cDate);
XMLGregorianCalendar date2 = DatatypeFactory.newInstance().newXMLGregorianCalendar(c); 
```

它返回一个日期`2013-01-03T11:50:00.000-05:00`。

我希望它阅读`2013-01-03 11:50:00`。

我检查了一堆帖子，它们使用 DateFormat 来解析日期的字符串表示，但是我的日期是作为日历对象提供给我的，而不是字符串。

我很感激朝着正确的方向轻推，以帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T20:34:45.487

XMLGregorianCalendar 具有您无法更改的特定 W3C 字符串表示形式。

但是，您可以`Date`使用`SimpleDateFormat`.

```
DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
String dateStr = dateFormat.format(cDate); 
```

您可以`Date`从`XMLGregorianCalendar`对象中获取对象，如下所示：

```
xmlCalendar.getGregorianCalendar().getDate() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:30:16.590

`DateFormat#format`接受一个`Object`参数。从内存中，它应该接受一个`Calendar`对象，如果不接受，它将接受一个`Date`对象，因此您可以将`Calendar#getTime`其用作更坏的情况

您可以使用[SimpleDateFormat](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)的实例来指定自定义格式。这将确保不同系统的结果始终相同

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T20:31:04.787

你看过这个教程它可能会有所帮助吗？

[http://www.vogella.com/articles/JavaDateTimeAPI/article.html](http://www.vogella.com/articles/JavaDateTimeAPI/article.html)

特别是这段代码是一个很好的例子：

```
// Format the output with leading zeros for days and month
SimpleDateFormat date_format = new SimpleDateFormat("yyyyMMdd");
System.out.println(date_format.format(cal1.getTime())); 
```

# java - 实现一个接口java新手

> ID：14146580
> 
> 赞同：2
> 
> 时间：2013-01-03T20:20:55.550
> 
> 标签：java

我是java新手，我正在尝试实现一个接口。

所以主类

```
public interface Matrix{
    //returns number of rows
    int numRows();
    //returns number of columns
    int numColumns();

    int addRows(...);
    ....
} 
```

现在基本上我要解决的是让我们说..我有两个矩阵`matrixa`和`matrixb`类型`Matrix`。

我想基本上扩展矩阵行。所以如果`matrixa`有 10 行并且`matrixb`有 2 行。然后我想回来`matrixa+=matrixb`

（当然假设列数相同。）

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T20:28:01.197

您可以在界面中添加另一种方法，例如：

```
 public interface Matrix{
             ....
           Matrix add( Matrix b );
    } 
```

并检查在实现中扩展行的必要性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:28:32.033

## 为什么你不能完全按照你的意愿去做？

Java 没有运算符重载。您不能`+=`与您的对象一起使用。在 Java 世界中，人们普遍认为运算符重载会降低可读性。

## 你可以做什么

但是，您可以使用诸如`addMatrix(Matrix m)`.

```
public interface Matrix{
    int getNumberOfRows();
    int getNumberOfColumns();

    Matrix addMatrix(Matrix m);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T20:26:12.330

简单的答案是：您通过阅读此[http://docs.oracle.com/javase/tutorial/java/IandI/usinginterface.html来实现一个接口](http://docs.oracle.com/javase/tutorial/java/IandI/usinginterface.html)

因为您是初学者，所以我将从 Java 教程开始。您不能实例化接口，接口（通常）仅包含方法头定义。使用接口的方式是通过创建一个普通的 java 类来实现它们，该类为接口中的每个方法实现代码。

顺便说一句，我强烈建议您阅读教程，而不是依赖 SO 来解决此类问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T20:30:41.113

我试图理解这个问题。我认为您要做的是定义：

`int addRows(Matrix b);`

在该方法实现中，您将：

1.  展开你的矩阵
2.  将 b 行复制到新扩展的矩阵中
3.  返回新的行数

所有这些实现都取决于您如何实现 Matrix 接口。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-03T20:36:41.020

要实现接口，您需要创建一个实现接口及其所有方法的类。

```
public class MatrixImpl implements Matrix{

    private List<List<Integer>> elements = new ArrayList<List<Integer>>();
    private int rowSize;

    ...

    /** appends rows from provided matrix to this matrix */
    public Matrix addRows(Matrix b){
        List<List<Integer>> rows;
        if (b == this){
            rows = new ArrayList(b.elements);
        }else {
            rows = b.elements;
        }
        for (List<Integer> row : rows){
           if(row.size() == rowSize){
              elements.add(new ArrayList(row));
           }else{
              // do some error handling
           }
        }
        return this;// you may want to return a clone instead
    }

    ...

} 
```

# asp.net-mvc - ASP.NET MVC 中的服务定位器替代方案

> ID：14146582
> 
> 赞同：2
> 
> 时间：2013-01-03T20:20:58.037
> 
> 标签：asp.net-mvc, design-patterns, dependency-injection, service-locator

阅读了[Mark Seemann 的博客文章](http://blog.ploeh.dk/2010/02/03/ServiceLocatorIsAnAntiPattern.aspx)以及引用它的[响应后，我理解了使用](https://stackoverflow.com/a/6051072/1068266)*服务定位器*模式而不是通过类构造函数进行依赖注入的缺点。我还阅读了这个[Dependency Injection with Ninject, MVC 3 和使用服务定位器模式](https://stackoverflow.com/questions/4607425/dependency-injection-with-ninject-mvc-3-and-using-the-service-locator-pattern)，它也讨论了这个问题。

但是，我的问题涉及这种特殊情况：

```
public class MyController
{
    public void GetData()
    {
        using (var repository = new Repository())
        {
            // Use the repository which disposes of an Entity Framework
            // data context at the end of its life.
        }
    }

    // Lots of other methods.
} 
```

在这里，我有一个控制器，其中包含一个调用存储库的方法，该存储库自动实例化内部实体框架数据上下文。使用这个单一数据上下文，因为该上下文被存储库中的每个方法调用，因此在存储库对象的整个生命周期共享单个上下文似乎是有意义的。

现在，由于控制器类很大，所以这个给定的存储库不会被使用的可能性更大。正如我假设（可能是错误的）这种实例化 DC 是一项昂贵的操作，我宁愿避免这样做。使用服务定位器模式允许我将实例化推迟到实际需要上下文时，但鉴于上述链接中反对它的有效参数，我宁愿避免它。

所以我想知道的是，在上述情况下是否有一种更有效的方式来使用依赖注入，这会阻止我不必要地实例化我的存储库和底层数据上下文。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:31:21.997

我认为答案取决于您的存储库如何管理连接。如果它在构建时打开了与数据库的连接，那么我认为问题出在您的存储库上，而不是依赖注入。您的存储库应仅在发出请求时打开连接，并在收到响应后立即关闭它。遵循这种模式，依赖注入仍然有意义。

* * *

根据您的更新，您最好还是使用 DI，因为 EF 在构造时不会打开与数据库的连接，只有在发出请求时才会打开。您的数据上下文足够小，值得为每个请求创建上下文所需的少量开销。

* * *

还有一条评论：您还应该考虑将您的数据上下文注入到您的存储库中，并让您的 DI 容器控制上下文的生命周期。这允许您在单个请求期间在一个或多个存储库中使用相同的上下文。[这是一个很好的资源，解释了如何在 ASP.NET MVC 中使用实体框架实现存储库和工作单元模式](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T20:35:10.300

> 由于控制器类很大，连接不会用于任何给定构造的可能性更大，因此实例化存储库并使用标准的基于构造函数的 DI 打开连接是没有意义的。

而是注入 a `Lazy`、 a`Func`或工厂：

```
public class MyController
{
    // Use constructor injection to populate this.
    private Func<MyRepository> _repository;

    public void GetData()
    {
        using (var repository = _repository())
        {
            // ...
        }
    }
} 
```

这样，您可以避免创建实际实例，直到您需要它们。

@sellmeadog 的回答也很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-03T20:37:56.380

您在问是否应该将数据库连接注入 Repository 构造函数？您可以尝试使用*抽象工厂*设计模式注入数据库连接**工厂**而不是实际的数据库连接。

```
public class MyController
{
    public void GetData()
    {
        using (var repository = new Repository(IDatabaseConnectionFactory dbConnFac))
        {
            // Use the repository which disposes of a database connection
            // at the end of its life.
        }
    }

    // Lots of other methods.
} 
```

通过这种方式，您可以获得依赖注入的好处，同时仍然允许存储库管理其数据库连接的生命周期。

# jquery - JQuery UI Autocomplete 的键盘事件

> ID：14146583
> 
> 赞同：4
> 
> 时间：2013-01-03T20:20:59.030
> 
> 标签：jquery, jquery-ui, jquery-ui-autocomplete

我已经覆盖了 AC 的 HTML 以使用表格，鼠标悬停效果和选择工作相同，但现在向上和向下键没有任何效果。如何使关键事件与 AC 表一起使用？

```
globalSearch._renderItem = function(table, item) {
    return $( '<tr class="result-row"></tr>' )
                .data( "item.autocomplete", item )
                .append('<td class="ac-search-col"></td>'+
                        '<td class="result-img-col"><img src="x" /></td>'+
                        '<td class="result-info">'+item.val'</td>')
                        .appendTo( table );
});

globalSearch._renderMenu = function(ul, items) {
        var self = this;
        ul.append('<table class="ac-search-table"></table>');
            $.each( items, function( index, item ) {
            self._renderItem( ul.find("table"), item );
        });
}; 
```

**编辑：**

这是小提琴：http: [//jsfiddle.net/CpTAh/24/](http://jsfiddle.net/CpTAh/24/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-13T17:22:46.483

我认为保留自动完成标记并仅修改呈现的输出以在`_renderItem`函数（[demo](http://jsfiddle.net/Mottie/NQ3K4/)）中包含您的额外数据可能会更好：

```
/* see http://jqueryui.com/autocomplete/#custom-data */
var availableTags = [
    {
        value: "Item1",
        label: "Item 1",
        desc : "Description for Item 1",
        icon : "http://mysite.com/images/item1.jpg"
    },
    {
        ...
    }
];

$("input").autocomplete({
    source: availableTags
})
.data('autocomplete')._renderItem = function(ul, item) {
    return $( '<li>' )
        .data( "item.autocomplete", item )
        .append('<a><span class="ac-search-col"></span><span class="result-img-col"><img src="' + item.icon + '" /></span><span class="result-info">' + item.label + '<p>' + item.desc + '</p></span>')
        .appendTo( ul );
}; 
```

另请查看以下链接：

*   [扩展自动完成小部件](https://stackoverflow.com/a/13763473/145346)。
*   [上述代码的来源](http://jqueryui.com/autocomplete/#custom-data)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T15:39:59.737

给你： http: [//jsfiddle.net/CpTAh/25/](http://jsfiddle.net/CpTAh/25/)
有两件事禁用了键盘事件：

1.  每个 item 元素必须直接在 ul 下，你只有一个：table。所以我删除了它，只是将 css 类添加到 ul 和`<tr>`直接在 ul 中的元素（这不是很干净但有效）。
2.  您必须`<a>`在每个项目中都有一个元素。

所做的编辑：

```
 globalSearch._renderMenu = function(ul, items) {
        var self = this;
        ul.addClass("ac-search-table");   // <= Here adding the class to the ul
            $.each( items, function( index, item ) {
            self._renderItem( ul, item );  // No table, directly the ul
        });
    }; 
```

和：

```
'<td class="result-info"><a>'+item.value+'<br>'+item.rating+'</a></td>' // added an <a> element 
```

但是，您的代码破坏了正常的选择 css，因此在使用键盘进行选择时，您无法看到所选元素的突出显示。我会让你自己纠正这个。

# asp.net - 空白 WebResource.axd

> ID：14146592
> 
> 赞同：5
> 
> 时间：2013-01-03T20:21:54.480
> 
> 标签：asp.net, .net-4.0, webresource.axd

有一个比较大的问题。大约两周前，我注意到基于警报的验证 (ValidationSummary) 在我的网站上停止工作。进一步审查后，WebResource.axd 将返回空白。它没有抛出错误，只是空白。

我试过通过 Fiddler 和 Firebug 跟踪请求，一开始的响应是 200。随后的缓存请求（同一页面）返回 304（如我所料）。

我检查了 IIS 配置、web.config、已安装的更新、Global.asax、httpHandlers 等...试图找出发生了什么或失败的原因。

两天来我一直在解决这个问题，但我已经没有选择了。有谁知道这可能是什么原因？任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-13T20:11:05.413

这似乎是一个棘手的问题，您能否检查并回答以下两个问题：

1.  任何机会都在您部署的站点上启用了调试。
2.  部署的网站是否在发布模式下正确构建？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-14T07:28:11.317

我发现了这个问题。在将 John Papa 的 Hot Towel MVC 项目安装到 Web 表单/MVC 混合体中时，路由配置不包含 AXD 路径的 IgnoreRoute 指令。

这意味着路由会在 HttpHandler 之前获取请求，并返回 200，即使给定的路由模式不存在控制器 - 因此 200 响应为空。

我会拉赏金，但我会赞成 Shashank 的回答。

# iphone - 如何以编程方式布局在不同“模式”之间切换的应用程序？

> ID：14146598
> 
> 赞同：1
> 
> 时间：2013-01-03T20:22:09.320
> 
> 标签：iphone, ios, ipad, uiviewcontroller

我想用一些共享代码为不同的“模式”制作一个具有不同视图的应用程序（有些元素我想要总是相同的，并且背景会在不同的视图之间发生变化）。我将根据时间管理这些视图之间的转换。布局视图的最佳方式是什么？

我看着做一个标签视图，但它似乎有点不自然，因为标签栏不容易隐藏。我也可以做一个自定义容器（我最初的想法），但如果可能的话，留在“标准”iOS 视图中似乎会很好。

进行自定义视图是否听起来不错/我错过了更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:57:54.070

我将有 2 个版本`-layoutSubviews`的父视图。就像是：

```
-(void)layoutSubviews
{
    if ( self.mode == 0 )
    {
        [ self layoutMode0 ] ;
    }
    else if ( self.mode == 1 )
    {
        [ self layoutMode1 ] ;
    }
} 
```

您的布局代码还可以显示/隐藏某些视图或设置背景图像等。在您切换模式的代码中，调用`-setNeedsLayout`...这样的东西：

```
-(void)setMode:(enum Modes)newMode
{
    _mode = newMode ;
    [ self setNeedsLayout ] ;
} 
```

如果您希望模式切换为动画，您可以执行以下操作：

```
-(void)setMode:(enum Mode)newMode animated:(BOOL)animated
{
    _mode = newMode ;
    if ( animated )
    {
        [ UIView animateWithDuration:0.25 animations:^{
            [ self layoutSubviews ] ;
        } ]
    }
    else
    {
        [ self setNeedsLayout ] ;
    }
} 
```

你的普通二传手`-setMode:`看起来像这样：

```
-(void)setMode:(enum Mode)newMode
{
    [ self setMode:newMode animated:NO ] ;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T21:02:41.123

如果您的模式是基于堆栈的，您也可以考虑使用 UINavigationController。导航栏可以很容易地隐藏（设置`hidesNavigationBar`为 YES）。当您推动或弹出与您可能想要设置`animated`为 NO 的模式相对应的控制器时，除非滑入/滑出动画适合您。

# api - API 以什么形式出现，以及如何编写它们？

> ID：14146600
> 
> 赞同：0
> 
> 时间：2013-01-03T20:22:16.633
> 
> 标签：api, rest

API 越来越受欢迎，开发人员使用 API 来简化将应用程序开发到多个平台的过程，并允许他们让其他开发人员能够将其应用程序的功能集成到他们自己的应用程序中。

我以前无数次使用过 API，但我现在正处于开发自己的应用程序的阶段。作为一个致力于创建多平台应用程序的开发人员——我需要使用 API。

我将使用最受推荐的 RESTful 方法。

在阅读并查找了一些背景资料后，我偶然发现了：[REST API 教程](http://www.restapitutorial.com)（这是一个非常好的网站！），我了解到 API 基本上接收 HTTP 请求，并以 JSON/XML 格式返回数据。

但是，有两个问题没有回答我：

1.  API 以什么形式出现？API实际上是文件吗？一组命令……？
2.  我如何实际**编写**API？我说的是服务器端的数据处理代码，而不是应用程序/语言特定的代码（用于发送 HTTP 请求等......）

如果有人可以帮助我并回答上述问题，那就太好了，因为我对 API 的经验为零。

任何帮助表示赞赏 - 非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:29:11.360

API 是对 http 请求的响应。这是一个纯文本响应，您可以按照您的描述使用通过 json 或 xml 编码的响应。

有很多框架可以帮助您开发和 API。

在 Ruby 中，你可以使用[grape](https://github.com/intridea/grape)或[rais-api](https://github.com/rails-api/rails-api)甚至是[rails](https://github.com/rails/rails)本身。

还有很多可用的，但这是我最常用的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:32:08.807

只是一个快速的直觉答案：他们是你想要的任何东西！

在我的脑海中，我将 API 定义为需要两个主要元素：

1.  一些文档可以清楚地说明如何使用您的系统提供的逻辑
2.  以某种方式调用这些系统。这可能就像一个接受 POST 消息并检查它们的某些变量和值以执行特定任务的网站一样简单。

简而言之，它应该完全取决于您。只要确保您提供简单、清晰和**准确的**文档即可。

更新，作为对以下评论的回答：

我就是这么解释的，而且维基百科似乎[或多或少同意我的看法](http://en.wikipedia.org/wiki/API#Web_APIs)。PHP 将是一个完美的例子：例如，您可以创建一个处理 POST 的 PHP 文件，而不是输出 html，而是输出带有所需结果数据的 XML。然后第三方应用程序可以 POST 到您的 PHP 应用程序，并接收和处理生成的 XML。

# c# - 允许相同密钥的通用集合

> ID：14146613
> 
> 赞同：6
> 
> 时间：2013-01-03T20:23:31.483
> 
> 标签：c#, .net, vb.net, collections

集合喜欢`HashTable`并且`Dictionary`不允许添加具有相同键的值，但我想将具有相同键的相同值存储在`Collection<int,string>`.

是否有一个内置的集合可以让我这样做？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-03T20:24:47.443

您可以使用`List<T>`包含自定义类的 a，甚至可以使用`List<Tuple<int,string>>`.

```
List<Tuple<int,string>> values = new List<Tuple<int,string>>();

values.Add(Tuple.Create(23, "Foo"));
values.Add(Tuple.Create(23, "Bar")); 
```

或者，您可以创建一个`Dictionary<int, List<string>>`（或其他一些字符串集合），并以这种方式填充值。

```
Dictionary<int, List<string>> dict = new Dictionary<int, List<string>>();
dict.Add(23, new List<string> { "Foo", "Bar" }); 
```

这样做的优点是仍然可以通过键快速查找，同时允许每个键有多个值。但是，稍后添加值有点棘手。如果使用它，我会将值的添加封装在一个方法中，即：

```
void Add(int key, string value)
{
    List<string> values;
    if (!dict.TryGetValue(key, out values))
    {
        values = new List<string>();
        dict[key] = values;
    }

    values.Add(value);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-03T20:24:40.287

将 a`List`与自定义`Class`.

```
public class MyClass
{
    public int MyInt { get; set; }
    public string MyString { get; set; }
}

List<MyClass> myList = new List<MyClass>();
myList.Add(new MyClass { MyInt = 1, MyString = "string" }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-03T20:37:49.877

**简而言之：**最简单的方法是`List<T>`跳过课程的通用集合`ArrayList`。因为，您需要考虑一些**性能注意事项。**

此外，您还可以使用`List<KeyValuePair<string,int>>`. 这将存储一个`KeyValuePair`可以重复的 's 列表。

在决定是否使用`List<T> or ArrayList`具有相似功能的类时，请记住`List<T>`该类在大多数情况下**性能更好并且是类型安全的。**如果引用类型用于类的类型 T，`List<T>`则两个类的行为是相同的。但是，如果将值类型用于类型 T，则需要考虑实现和装箱问题。

作为**参考：**您可以使用以下 MSDN 文章 - [List Class](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)。

# tfs - TF30172: 你没有权限

> ID：14146617
> 
> 赞同：13
> 
> 时间：2013-01-03T20:23:45.993
> 
> 标签：tfs

我安装了 tfs 服务器，它允许我连接，但是当尝试创建团队项目时，它会显示此消息。

```
TF30172: You do not have permission to create a new team project. 
```

我所有的许可目前都已设置，或者至少我认为是这样。

我还能检查什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-03T20:42:39.623

这是 Visual Studio 2010 和 Team Foundation Server 2012 的已知问题。

来自[Buck Hodges](http://social.msdn.microsoft.com/profile/buck%20hodges/)的博客：

> 您必须使用 Visual Studio Team Explorer 2012（包含在所有 Visual Studio 版本中或可以单独下载）在 TFS 2012 服务器上创建团队项目。如果你使用 VS 2010，你会得到一个没有权限的错误。该错误消息非常具有误导性，因为这不是您的权限问题。

您应该安装[此修复程序](http://support.microsoft.com/kb/2662296?wa=wsignin1.0)来解决此问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T10:52:04.127

您应该拥有 Team Project Collection 管理员的权限。您必须将自己添加到此组中。

之后可能还需要将自己添加到贡献者组中。

请检查您是否已在 Team Project Collection Setting 中授予权限。

不在团队项目设置中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-05T01:20:10.867

尝试了多种解决方案，包括许多重新安装、重新应用服务包、修补程序以及 Mak 和 DaveShaw 提供的两个答案。

我使用的解决方法是使用 Visual Studio 2013 创建新的团队项目。一旦我这样做了，我就能够将我的解决方案添加到源代码管理中。我想也可以使用 VS 2012。

# linux - 在两台机器上运行脚本

> ID：14146618
> 
> 赞同：2
> 
> 时间：2013-01-03T20:23:48.697
> 
> 标签：linux, shell

我有一个需要使用 cron 自动化的 shell 脚本。在我们的办公室，我必须登录一台特定的机器才能使用 cron。我的问题是，我编写的脚本与 git 交互，使用 git 命令拉取代码和切换分支。我能够安排 cron 作业并且正在运行脚本的机器上**没有**git。我有一台单独的机器，我在使用 git 时登录它。有没有一种简单的方法可以让我从 cron 系统运行我的脚本并从 git 系统运行 git 部分？

更新：如果可以做到这一点，我仍然很感兴趣，但是我的团队已经获得了一台新机器，我们将按照我们的选择进行设置，这意味着它将具有 cron 和 git。感谢您的任何想法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T14:08:20.663

正如上面一些人提到的，**ssh**是做到这一点的方法。这是我在工作中经常使用的 bash 行，用于从其他服务器收集数据：

```
ssh -T $server -l username "/export/home/path/to/script.sh $1  $2" 1>traf1.txt 2>/dev/null 
```

上面的代码示例将连接到 ip $server，作为用户用户*名*并运行脚本*script.sh*，将参数 $1 和 $2 传递给它。除了重定向之外，您还可以将命令输出分配给变量，就像您在脚本中使用任何其他命令一样。

PS：请注意，为了使上述工作正常，您需要在这些机器之间设置无[密码登录。](http://www.debian-administration.org/articles/152)否则，您的脚本将中断以请求密码输入，这很可能不是所需的行为。

# file - 如何使用请求正文中的输入定义 POST 参数？

> ID：14146619
> 
> 赞同：0
> 
> 时间：2013-01-03T20:23:54.203
> 
> 标签：file, rest, post, upload, action

我正在向 RESTFUL api 发出 POST 请求，我可以传递参数的唯一方法是将它们添加到表单“action”参数中使用的 URL 中。一旦我将这些参数放入表单的正文组件中，请求就不再有效。我的问题是如何使用表单中的输入来定义请求参数，而不是将参数嵌入到操作 URL 中？

我确实注意到，当我提交请求时，请求正文参数显示出来，但实际请求失败，说参数不存在。

这是HTML：

```
<form target="hiddenIframe" method="POST" action="/rest/bpm/wle/v1/process/5853?action=addDocument&name=test123&docType=file&parts=none&accept=application/json&override-content-type=text/plain" enctype="multipart/form-data">
  <input type="text" name="instanceId" value="5823" />
  <input type="text" name="name" value="myTestQ1" />
  <input type="text" name="docType" value="file" />
  <input id="myFileName" type="file" name="data" />
  <input type="submit"/>
</form>
<iframe name="hiddenIframe" id="hiddenIframe" style="display: none;" /> 
```

如您所见，表单标签中的操作很长并且不是动态的......我只想在那里有“/rest/bpm/wle/v1/process/”，但是当我上传失败时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-07T00:35:50.977

我会使用一些Javascript。向所有必填输入字段添加 onchange。您将调用的更改方法可以使用表单字段中的新数据更新您的操作 url。

就像是：

```
<input type="text" name="instanceId" value="5823" onchange="updateInstanceID()" id="instanceid" />
action="/rest/bpm/wle/v1/process/5853?action=addDocument&name=test123&docType=file&parts=none&accept=application/json&override-content-type=text/plain" 
```

现在，您的 Javascript 应该具有该方法。

```
function updateInstanceID() {
    var val = document.getElementById("instanceid").value;
    var form = document.forms[0]; // assuming only one form on the page.
    ....
} 
```

现在您可以访问您的 form.action 字段并相应地更新它。

# c++ - 使用 while 循环打印两个用户输入值范围内的数字

> ID：14146624
> 
> 赞同：0
> 
> 时间：2013-01-03T20:24:26.043
> 
> 标签：c++, math, while-loop, range, cout

我觉得我可能在这里遗漏了一些东西，但有些东西告诉我，我可能只是让这变得更加困难，但是从这本书“C++ Primer, 5th ed.”中我被困在了这个问题：

> 练习 1.11：编写一个提示用户输入两个整数的程序。打印这两个整数指定的范围内的每个数字。

直到本书的这个时候，唯一使用的循环是循环，并且没有引入`while`条件表达式，如。`if`如果不是因为用户可以按升序或降序将值放入所要求的整数中，那么问题将很简单，所以简单的减法会发现差异，但无需测试增加的方式。

我怎么能绝对打印数字之间的范围，保证在不测试这种数学结果和/或不比较两个数字的情况下不会仅仅增加到无穷大？这就是我所拥有的；它在第一个值：`v1`小于或等于第二个：时起作用`v2`，但在其他情况下不起作用：

```
#include <iostream>

int main()  
{  
    int v1 = 0, v2 = 0;  
    std::cout << "Enter two integers to find numbers in their range (inclusive): "  
              << endl;  
    std::cin >> v1 >> v2;  
    while (v1 <= v2)  
    {  
        std::cout << v1;  
        ++ v1;  
    }  
    return 0;  
} 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:28:00.313

您可以使用`(v2-v1)/abs(v2-v1)`或一些这样的增量。（前提是它们不相等）。对于循环条件，您可以检查当前数字是否仍在两者之间，例如`(v1<=v && v<=v2) || (v2<=v && v<=v1)`.

为了避免零的情况，我将它变成`do while`循环并`v1!=v2 && ...`用作条件。

总结一下：

```
int v = v1;
do {
   std::cout << v << std::endl;
}while( v1!=v2 && ( (v1<=(v+=(v2-v1)/std::abs(v2-v1)) && v<=v2) || (v2<=v && v<=v1) ) ); 
```

PS我相信您可以自行解决评论和其他答案中提到的输入问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:34:01.553

这是一个简单的重写，您可以在其中使用`min`并`max`确定要迭代的范围：

```
#include <iostream>

int main()  
{  
    int v1 = 0, v2 = 0;  
    std::cout << "Enter two integers to find numbers in their range (inclusive): " << std::endl;  
    std::cin >> v1 >> v2;  
    int current =  std::min(v1, v2);
    int max = std::max(v1, v2);
    while (current <= max)  
    {  
        std::cout << current << std::endl;  
        ++ current;  
    }  
    return 0;  
} 
```

这还允许您保持两个输入“完整”，因为您正在使用另一个变量来迭代这些值。

另请注意，`++current`如果将其替换为，则可以在打印的完全相同的行上完成`current++`。后者将返回的当前值`current`然后增加它。

**编辑**

这是迈克尔建议我相信的，在工作代码中：

```
#include <iostream>

int main()  
{  
    int v1 = 0, v2 = 0;  
    std::cout << "Enter two integers to find numbers in their range (inclusive): " << std::endl;  
    std::cin >> v1 >> v2;  
    int increment = (v2 - v1) / std::abs(v2 - v1);
    int current = v1;
    int max = v2 + increment;
    while (current != max)  
    {  
        std::cout << current << std::endl;  
        current += increment;  
    }  
    return 0;  
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-07T06:12:07.993

我尝试了我的业余方式并得到了结果。我希望它会有所帮助。

```
#include <iostream>

using namespace std;

int main()
{
int a;
int b;
int val;
cout << "Please enter small value "<< endl;
cin >> a;
cout << "Please enter bigger value than the last one " << endl;
cin >> b;

while (val>a)
{
    val = --b;
     cout << "The numbers between a & b are "<< val << endl;
}
return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-24T16:03:07.753

由于我仍然记得 C++ Primer 中的这个问题，我认为他们希望你解决它的方式是使用他们在那之前为你提供的编程基础知识。在我看来，如果这是本书中的这个确切问题，它应该这样解决：

```
 #include <iostream>
int main()
{
    int v1 = 0, v2 = 0;
    std::cout << "Enter 2 numbers" << std::endl;
    std::cin >> v1 >> v2;
    while (v1 < v2) {
        std::cout << v1 << std::endl;
        ++v1;
    }
} 
```

# ruby-on-rails - 使用 Ruby/Rails 从 Apache 索引页面获取文件列表

> ID：14146627
> 
> 赞同：0
> 
> 时间：2013-01-03T20:24:42.983
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在尝试使用来自国家气象局的数据创建雷达动画。对于静态图像，它们通过始终具有相同的文件名使其变得容易。但是，对于历史图像，它们是带有时间戳的，并且总是在变化。因此，要获取前 N 张图像，您必须事先知道文件名。但是，它们确实提供了一个目录，该目录提供了每个站点的列表。请参阅此处的示例： [http ://radar.weather.gov/ridge/RadarImg/N0R/FWS/](http://radar.weather.gov/ridge/RadarImg/N0R/FWS/)

我需要的是从我的 Rails 应用程序中提取该目录中的最后 N 个图像。那可能吗？我可以想象一个选择是下载然后抓取该页面，但我假设有更好的方法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:48:08.863

从上面开始，您可以尝试像我刚刚在控制台中尝试过的东西..

```
require 'open-uri'
require 'nokogiri'    
doc = Nokogiri::HTML(open('http://radar.weather.gov/ridge/RadarImg/N0R/FWS/'))
doc.xpath('//table/tr/td').each do |tabrow|
  puts tabrow.content
end 
```

这是在黑暗中的一个非常基本的刺伤，但应该让你深思熟虑，让你上路

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:32:19.857

您必须使用类似的库下载它们，使用[Nokogiri](http://nokogiri.org/)`curb`之类的内容解析页面，然后使用最适合您的任何工具组合图像。

Rails 旨在处理 Web 请求，而不是作为后台作业运行，但是有一些工具可以帮助您完成此任务，或者您可以随时制作脚本`rails runner`以在 Rails 环境中执行。

# jquery - 在backbone.js中同步整个模型集合

> ID：14146628
> 
> 赞同：7
> 
> 时间：2013-01-03T20:24:46.003
> 
> 标签：jquery, backbone.js

我正在尝试将整个模型集合同步到backbone.js 中的服务器。我想将一个 JSON 包发布到包含所有集合模型属性的服务器。这应该很简单，但我不确定我做错了什么：

```
 var RegisterCollection = Backbone.Collection.extend({ 
    initialize: function () {_(this).bindAll('syncCollection');},

    model: RegisterModel, 

    url: 'api/process.php',
    updateModel: function(registerModel) {
        var inputName = '#'+registerModel.get('inputName');
        var userInput = $(inputName).val();
        registerModel.set({value: userInput});
    },
    syncCollection: function(registerModel) {
        this.sync();
    }

});
var RegisterCollectionView = Backbone.View.extend({
    el: "#register",
    events: {
        "click #submit" : "validate"
    },

    validate: function(e) {
        e.preventDefault();
        $("#register").valid();
        if ($("#register").valid() === true) {
            this.updateModels();
            this.collection.syncCollection();
        }
    },
    updateModels: function (){
        this.collection.forEach(this.collection.updateModel, this);;    
    },
    initialize: function(){
        this.collection.on('reset', this.addAll, this);
    },  
    addOne: function(registerModel){
        var registerView = new RegisterView({model: registerModel});
        this.$el.append(registerView.render().el);  
    },
    addAll: function(){
        this.$el.empty();
        this.collection.forEach(this.addOne, this);
        this.$el.append('<button type="submit" class="btn-primary btn" id="submit" style="display: block;">Submit</button>');
    },
    render: function(){
        this.addAll();
        return this;
    }
});
var registerCollection = new RegisterCollection();
registerCollection.fetch();

var registerCollectionView = new RegisterCollectionView({collection: registerCollection});
registerCollectionView.render(); 
```

当我尝试调用 syncCollection() 时，它返回以下错误：`Uncaught TypeError: Object [object Object] has no method 'save'`我是 Backbone 的新手，所以很可能我在某处犯了一个相当基本的错误......

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-04T16:34:09.807

好的，一壶新鲜的咖啡，一天后，我拿到了。我们不正确地调用了sync()。这是我们应该做的：

```
syncCollection: function() {
        Backbone.sync('create', this);
    } 
```

感谢 machineghost 帮助我探索这个问题 - 我完全专注于错误的事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-03T20:35:23.823

您收到该错误的原因是`Backbone.Collection`没有保存方法（它的模型有）。我认为您正在寻找的是：

```
syncCollection: function() {
    _(this.models).each(function(model) {
        model.save();
    });
} 
```

或者更好的是，使用`Collection`'s `each`：

```
syncCollection: function() {
    this.each(function(model) {
        model.save();
    });
} 
```

或者更好的是，使用`Collection`'s `invoke`：

```
syncCollection: function() {
    this.invoke('save');
} 
```

但是，我不确定您是否需要任何这些，因为`Backbone.Collection`已经有一种方法可以（我认为）您想要的：`sync`.

从骨干文档：

> > collection.sync（方法，集合，[选项]）
> > 
> > 使用 Backbone.sync 将集合的状态持久化到服务器。可以覆盖自定义行为。

# apache-camel - 在日志记录中使用标头时返回 SOAP 请求

> ID：14146632
> 
> 赞同：0
> 
> 时间：2013-01-03T20:24:56.153
> 
> 标签：apache-camel, apache-servicemix, fuseesb

艾希什又来了。

我开发了一个路由来解析传入的 SOAP 请求并记录请求中的一些信息。我使用标头和 XPATH 从 SOAP 服务请求中获取信息。该路由成功解析并记录了适当的信息。

路线如下：

```
 <route streamCache="true">

        <from uri="<some URI>"/>  

        <setHeader headerName="SOAPAction">
            <constant>http://www.something.com/constant>
        </setHeader>

         <setHeader headerName="actionId">
            <xpath resultType="java.lang.String">//ws:actionId/text()</xpath>
          </setHeader>

    <choice>

            <when>
                <xpath>//ws:actionId = '1'</xpath>
                <to ref="callService" />                   
            </when>

            <otherwise>

                <log message="Wrong Action ID : ${in.headers.actionId}" 
                          loggingLevel="ERROR"/>                  

            </otherwise>   

        </choice>

    </route> 
```

根据逻辑，如果 actionId 为 1，路由必须重定向到 callService URI，否则它应该记录错误的 action Id 而没有任何响应。

如果 actionId 为 1，则该逻辑有效，它重定向到 callService 并向调用者发送适当的响应。如果 actionId 不是 1，它会使用操作 ID 写入有关错误操作 ID 的日志，但它会向调用者发送相同的请求作为响应。

我使用soapUI和Java Socket Programming对其进行了检查。但是输出是相同的，准确地记录了actionId，但是向调用者发送了相同的请求作为响应。

我不希望与响应相同的请求。响应必须为空白。

任何人都可以帮我找到解决方案。

问候，

阿什什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T08:29:47.677

在这种情况下，您还需要将响应设置为*空*或空对您意味着什么。并且响应需要符合 WSDL 合同的响应可以是什么。

所以在另外添加代码来设置空响应例如：

```
<otherwise>
    ...
    <transform>
      <constant>NO DATA</constant>
    </transform>
 </constant> 
```

虽然也介意如果你使用 camel-cxf 那么 dataFormat 选项会影响应该如何创建一个空响应。

# python - python代码是如何解释的，有多少静态分析？

> ID：14146633
> 
> 赞同：0
> 
> 时间：2013-01-03T20:25:01.073
> 
> 标签：python

我认为 python 是一种解释性语言，但根据下面的代码片段，它显然没有完全符合我的预期？我对此进行了一些搜索，结果发现如果函数中存在对它的赋值，python 会隐式地将名称“声明”为本地名称。所以它在解释代码时确实做了一些静态分析，但我的问题是多少？例如，如下面的代码所示，由于 x=1 不可达，它是否也会优化？我们是否有更多关于我们如何解释代码的细节？谢谢

```
x = 10
def f():
    if False: x = 1
    print x
UnboundLocalError: local variable 'x' referenced before assignment 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:27:43.257

在 CPython 中，代码首先被编译成*字节码*，然后字节码由解释器执行。因此，在执行任何代码之前会发现一些问题（语法错误等）。

如果您愿意，可以使用[`dis`](http://docs.python.org/2/library/dis.html)模块检查字节码：

```
>>> import dis
>>> dis.dis(f)
  3           0 LOAD_GLOBAL              0 (False)
              3 POP_JUMP_IF_FALSE       15
              6 LOAD_CONST               1 (1)
              9 STORE_FAST               0 (x)
             12 JUMP_FORWARD             0 (to 15)

  4     >>   15 LOAD_FAST                0 (x)
             18 PRINT_ITEM          
             19 PRINT_NEWLINE       
             20 LOAD_CONST               0 (None)
             23 RETURN_VALUE 
```

如您所见，这个特殊的 CPython 在将 Python 转换为字节码时并没有做很多优化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T20:29:24.293

这里没有“静态分析”，至少不像通常解释的那样。只有编译。

当你到达一个`def`块的末尾时，在主体上调用编译器将其转换为一个`code`对象，这与在 REPL 中输入的行上调用编译器的方式几乎相同。

它并不关心分配发生在`if`永远不会发生的语句中。它仍然编译该`if`块内的代码。因此，它正在编译对`x`. 编译`def`块的一部分是创建`locals`字典，当它编译该赋值时，它知道`x`是局部变量而不是全局变量，这就是它所需要的。

# c# - 如何在 C# 中计算与 SQL Server (hashbytes('SHA1',[ColumnName])) 等效的值？

> ID：14146636
> 
> 赞同：7
> 
> 时间：2013-01-03T20:25:18.337
> 
> 标签：c#, sql-server, tsql, sha

在我的数据库中，我有一个计算列，其中包含一个名为 URLString 的列的 SHA1 哈希，该列包含 URL（例如“http://xxxx.com/index.html”）。

我经常需要查询表以根据 URLString 列找到特定的 URL。该表包含 100K，这些查询需要几秒钟（使用 SQL Azure）。由于 URL 可能很长，我无法在此列上创建索引（超过 450 个字节）。

为了加快速度，我想从 C# 计算 SQL Server hashbytes('SHA1',[URLString]) 的等价物并基于此值进行查询。

我尝试了下面的代码，但我得到的值与数据库计算的值不同。

```
var urlString = Encoding.ASCII.GetBytes(url.URLString); //UTF8 also fails
var sha1 = new SHA1CryptoServiceProvider();
byte[] hash = sha1.ComputeHash(urlString); 
```

我在这里错过了一些微不足道的事情吗？
我对可以解决相同问题的其他想法持开放态度（只要 SQL Azure 支持它们）。

示例：在数据库中自动计算出 URL [http://www.whatismyip.org/](http://www.whatismyip.org/)的 SHA1 值为0xAE66CA69A157186A511ED462153D7CA65F0C1BF7。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-03T20:40:00.347

You're likely getting bitten by character encoding differences:

[http://weblogs.sqlteam.com/mladenp/archive/2009/04/28/Comparing-SQL-Server-HASHBYTES-function-and-.Net-hashing.aspx](http://weblogs.sqlteam.com/mladenp/archive/2009/04/28/Comparing-SQL-Server-HASHBYTES-function-and-.Net-hashing.aspx)

You could try getting the bytes via `Encoding.ASCII.GetBytes(url)` or `Encoding.Unicode.GetBytes(url)` and see which one your db is using.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-03T20:28:42.680

以下是对字符串和字节进行散列的两种方法。HashBytes 方法返回结果字节的 Base64，但如果您愿意，您可以只返回字节

```
public static string HashString(string cleartext)
{
    byte[] clearBytes = Encoding.UTF8.GetBytes(cleartext);
    return HashBytes(clearBytes);
}  

public static string HashBytes(byte[] clearBytes)
{
    SHA1 hasher = SHA1.Create();
    byte[] hashBytes =   hasher.ComputeHash(clearBytes);
    string hash = System.Convert.ToBase64String(hashBytes);
    hasher.Clear();
    return hash;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-09-14T01:57:58.853

下面的代码等价于 SQL Server 的 hashbytes('sha1')

```
using (SHA1Managed sha1 = new SHA1Managed()) {
    var hash = sha1.ComputeHash(Encoding.Unicode.GetBytes(input));
    var sb = new StringBuilder(hash.Length * 2);

    foreach (byte b in hash) {
        // can be "x2" if you want lowercase
        sb.Append(b.ToString("X2"));
    }

    string output = sb.ToString();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-15T18:52:19.627

***微软 SQL Server 2008 (RTM) - 10.0.1600.22 (X64)***

```
 DECLARE @inputString NVARCHAR(1000)
 set @inputString='Intel(R) Xeon(R) CPU           X5660  @ 2.80GHz  '
 DECLARE @outputHash VARBINARY(8000)
 SET @outputHash = HASHBYTES('SHA1', (@inputString))
 select  @outputhash 
```

**返回** 0xAE325D7C3D7720846B42CDD488EBEE5D711CB1AE

***C＃***

```
public string SQLServerSha1(string input) {
    SHA1Managed sha1 = new SHA1Managed()
    var hash = sha1.ComputeHash(Encoding.Unicode.GetBytes(input));
    var sb = new StringBuilder(hash.Length * 2);

    foreach (byte b in hash) {
        // can be "x2" if you want lowercase
        sb.Append(b.ToString("X2"));
    }

    string output = sb.ToString();
    return output;
    } 
```

**返回**AE325D7C3D7720846B42CDD488EBEE5D711CB1AE

# ios6 - 从字符串转换 NSDate

> ID：14146638
> 
> 赞同：0
> 
> 时间：2013-01-03T20:25:23.033
> 
> 标签：ios6

我将存储在核心数据中的 NSDate 显示到 UITextField 中，以便用户可以对其进行编辑。我正在使用 NSDateFormatter 将日期格式化为“dd-MM-yyyy”格式，效果很好。

当用户按下保存时，我想将此字符串转换回日期并更新核心数据记录，这很好，但我也想将其转换为不同的格式。

所以从 15-01-2004 到 2004-01-15

这就是我所拥有的

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"dd-MM-yyyy"];
[formatter setTimeZone:[NSTimeZone timeZoneWithName:@"GMT"]];

NSDateFormatter *formatter2 = [[NSDateFormatter alloc] init];
[formatter2 setDateFormat:@"yyyy-mm-dd"];
[formatter2 setTimeZone:[NSTimeZone timeZoneWithName:@"GMT"]];

[urlParams appendFormat:@"&DOB=%@", [formatter2 stringFromDate:date]]; 
```

我遇到的问题是我将日期恢复为 2004-00-15 而不是 2004-01-15

我显然误解了一些东西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:26:36.207

```
[formatter2 setDateFormat:@"yyyy-mm-dd"]; 
```

到

```
[formatter2 setDateFormat:@"yyyy-MM-dd"]; 
```

mm 是分钟

# scala - Scala Actors：返回非 Any 类型的 Future。

> ID：14146639
> 
> 赞同：2
> 
> 时间：2013-01-03T20:25:24.903
> 
> 标签：scala, types, actor, future

我正在阅读一本关于 Scala Actors 的书，但我遇到了一些语法问题。在实践中，我倾向于这样分配我的变量和函数定义：

```
val v: String = "blahblahblah"
def f(n: Int): Int = n+1 
```

包括项目名称后的（返回）类型。虽然我知道这不是必需的，但我已经习惯了这种约定，并发现它使我自己更容易理解代码。话虽如此，请注意以下示例：

```
class Server extends Actor {
  def act() = {
    while (true) {
      receive {
        case Message(string) => reply("Good,very good.")
      }
    }
  }
}
def sendMsg(m: Message, s: Server): Future[String] = {
  s !! m
} 
```

上面的代码在编译时产生一个错误，抱怨服务器返回了 Future[Any]，而不是 Future[String]。我知道可以通过从 sendMsg 中删除返回类型来规避这个问题：

```
def sendMsg(m: Message,s: Server) = s !! m 
```

但是，这不符合我的风格。有没有一种方法可以指定服务器生成的 Future 类型（而不是 Future[Any]）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T20:58:42.213

您的问题比样式更深：您得到 a 是`Future[Any]`因为编译器无法静态地更好地了解当前的 Akka actor 以及现在已弃用的 scala.actors。在没有编译时检查的情况下，您需要求助于运行时检查，正如 idonnie 已经评论的那样：

```
(actorRef ? m).mapTo[String] 
```

这会将另一个 Future 链接到原始的 Future，该 Future 填充一个`String`结果，`ClassCastException`如果演员顽皮，或者`TimeoutException`如果演员没有回复，请参阅[Akka 文档](http://doc.akka.io/docs/akka/2.1.0/scala/actors.html#Ask__Send-And-Receive-Future)。

可能很快就会有出路，我正在开发一个 Akka 扩展以包含静态类型的通道，但这将导致您必须以不同的方式编写代码，并使用更多类型注释。

# file-upload - 我可以从我的网页 ftp 上传文件吗？

> ID：14146642
> 
> 赞同：0
> 
> 时间：2013-01-03T20:25:32.403
> 
> 标签：file-upload, ftp

是否有客户端或插件允许我在我的网站上放置一个框架/上传字段，让我的用户在没有自己的 ftp 客户端软件的情况下将文件上传到我的 ftp 服务器？最好是我可以自动预配置 ftp 用户名/密码（根据我存储的有关登录用户的数据）？

在数字标牌解决方案中，我们让用户将视频文件上传到他们的帐户，目前有通过 ftp 上传的解决方案（文件随后被重命名和移动，用户不能使用此功能共享视频文件。此外，它仅与视频有关他们自己做的，没有许可证破损。就像免责声明一样=）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T07:07:28.977

试试像uploadify这样的第三方软件，或者像[http://www.net2ftp.com/](http://www.net2ftp.com/)这样的服务，它可以在某种程度上与php集成。

# javascript - 如何手动移动跨度（或 div）？

> ID：14146645
> 
> 赞同：2
> 
> 时间：2013-01-03T20:25:39.740
> 
> 标签：javascript, jquery, html, css

这是我正在使用的代码。我能够完成在链接下显示图像的任务，但我无法拖动它。该脚本完成了一次单击显示图像跨度并在第二次单击时将其关闭的任务。我想要的是一键显示它们并可以拖动。

```
<script type="text/javascript">
$(document).ready(function () {

    $(".slidingDiv").hide();
    $(".show_hide").show();

    $('.show_hide').click(function () {
        var el = $(this);
        var slidingDiv = el.find("span.slidingDiv");
        $(".slidingDiv" ).draggable();

        if (slidingDiv.length > 0) {
            slidingDiv.slideToggle(function () { el.after(slidingDiv); });
        }
        else {
            slidingDiv = el.next("span.slidingDiv");
            el.append(slidingDiv);
            slidingDiv.slideToggle();
        }
        return false;
    });
    $('.show_hide_close').click(function () {
        $(this).parent().parent("a.show_hide").click();
        return false;
    });
});

 $(function() {
        $( ".slidingDiv" ).draggable();
    });

</script> 
```

HTML：

```
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#" class="show_hide" style="position: relative;">Japan</a><span class="slidingDiv"><img src="02-1 ImageFiles/01 Japan.JPG" style="width:235px; height:245px;" /><a href="#" class="show_hide_close">Close</a></span> is made up of islands, 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T13:58:09.420

您可以使用以下示例，

简单来说： [Link1](http://jsfiddle.net/uPRaH/) 代码：

```
$(".selector").draggable({
    cancel: "button"
});​ 
```

更多信息：[Link2](http://jsfiddle.net/uPRaH/1/) [Link3](http://jsfiddle.net/joycse06/EPKfR/)

深度：[Link4](http://jsfiddle.net/rniemeyer/QWgRF/)

# git - git 将多个提交压缩成多个提交

> ID：14146647
> 
> 赞同：2
> 
> 时间：2013-01-03T20:25:42.383
> 
> 标签：git, version-control, commit

有鉴于此：

[在推送 Git 之前合并多个提交](https://stackoverflow.com/questions/6934752/git-combining-multiple-commits-before-pushing)

假设我有这个变基：

```
pick 16b5fcc msg1
pick c964dea msg3
pick 06cf8ee msg1
pick 396b4a3 msg2
pick 9be7fdb msg3
pick 7dba9cb msg2 
```

假设我想将所有具有相同消息的提交合并为一个......（即所有 msg1 提交到单个 msg1 提交，所有 msg2 提交到 1 个 msg2 提交等）

我应该如何去挤压这些？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-03T20:33:56.667

git-rebase 让你重新排序和压缩提交。像这样的东西应该可以工作：

```
pick 16b5fcc msg1
squash 06cf8ee msg1
pick 396b4a3 msg2
squash 7dba9cb msg2
pick 9be7fdb msg3
squash c964dea msg3 
```

如果您有很多提交，我建议您编写一个脚本将它们按上述方式分组。

# google-maps - 谷歌街景标记量表

> ID：14146651
> 
> 赞同：3
> 
> 时间：2013-01-03T20:25:53.763
> 
> 标签：google-maps, google-maps-api-3, google-maps-markers, google-street-view

当我在街景中单击并拖动自定义标记时，标记会缩放以考虑深度。这很好，但会导致我想要实现的目标出现问题。有没有办法禁用它？我到处搜索布尔选项或其他东西，但还没有找到。我目前正在尝试用我自己的代码覆盖缩放，并尝试将该标记设置为：

```
-webkit-transform: scale(1) !important; 
```

没有任何运气。任何帮助将不胜感激。谢谢你。

# python - pyplot.scatter：如何设置从低点到高点的颜色？

> ID：14146653
> 
> 赞同：1
> 
> 时间：2013-01-03T20:26:15.003
> 
> 标签：python, matplotlib

我刚刚发现了[pyplot.scatter](http://matplotlib.org/api/pyplot_api.html?highlight=scatter#matplotlib.pyplot.scatter)并且一直在玩它。由于着色，我无法解释我的结果。例如，给定我的 3 (a,b) 大小的数据数组**dataX**、**dataY**和**dataMag**：

```
import pyplot as plt
import numpy as np

plt.scatter(x=dataX.flat, y=dataY.flat, vmin=np.min(dataMag),
            vmax=np.max(dataMag), c=dataMag.flat, lw=1, s=1)
plt.show() 
```

如果有办法将**dataMag**中的低值（即 0）设置为白色，并让颜色逐渐增加到黑色、红色或任何我不关心的颜色的最大颜色，那将非常有帮助。有没有办法做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:32:21.873

我想你在找kwarg `cmap`。

```
 plt.scatter(...,cmap='hot') 
```

取自[scipy 食谱](http://www.scipy.org/Cookbook/Matplotlib/Show_colormaps)：

```
from pylab import *
from numpy import outer
rc('text', usetex=False)
a=outer(arange(0,1,0.01),ones(10))
figure(figsize=(10,5))
subplots_adjust(top=0.8,bottom=0.05,left=0.01,right=0.99)
maps=[m for m in cm.datad if not m.endswith("_r") ]
maps.sort()
l=len(maps)+1
for i, m in enumerate(maps):
    subplot(1,l,i+1)
    axis("off")
    imshow(a,aspect='auto',cmap=get_cmap(m),origin="lower")
    title(m,rotation=90,fontsize=10) 
```

很好地生成一个带有您安装可用的所有颜色图的图形。最后加上“_r”的名称将为您提供相同的地图，颜色方向相反。

也可以定义自己的自定义颜色图

# javascript - AngularJS：如何验证美国格式的日期？

> ID：14146655
> 
> 赞同：11
> 
> 时间：2013-01-03T20:26:22.143
> 
> 标签：javascript, validation, date, angularjs, angular-ui

我有以下表单代码，允许使用 AngularUI 输入日期（日期是必需的，并且应该与美国日期格式匹配，例如：MM/DD/YY）：

```
<form name="form" ng-submit="createShipment()">
    <!-- Shipment Date must be in MM/DD/YY format: -->  
    <input name="shipmentDate" 
          ng-pattern='/^[0,1]?\d{1}\/(([0-2]?\d{1})|([3][0,1]{1}))\/(([1]{1}[9]{1}[9]{1}\d{1})|([2-9]{1}\d{3}))$/'
          ui-date="{ dateFormat: 'mm/dd/y' }" required ng-model="shipment.ShipmentDate" type="text">
    <span ng-show="form.shipmentDate.$error.required">Date Required!</span>
    <span ng-show="form.shipmentDate.$error.pattern">Incorrect Format, should be MM/DD/YY!</span>

    <input class="btn-primary" ng-hide="!form.$valid" type="submit" value="Create">
</form> 
```

**必填**字段的验证工作正常，但日期格式未正确验证，并且始终显示**“格式不正确...”**消息。

我尝试了几种不同的正则表达式，它们在其他地方运行良好，但仍然无法正常工作。我也尝试了 AngularUI 验证，但它也不起作用。提前致谢！

**更新：**

我认为验证与我使用的 AngularUI datepicker 冲突，但是 datepicker 无论如何都会自动更正日期，所以如果不使用 datepicker，只要正则表达式有效，验证就有效，如果使用 datepicker，则不需要其他验证。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-04T03:51:25.613

您的 ng-pattern 在我创建[的小提琴](http://jsfiddle.net/mrajcok/YmmVp/)中工作，但它允许一些不正确的日期，例如 0/9/1993 和 19/2/1993。

这是一个更好的模式：（注意，它已更新以匹配@WillSadler 的答案）

```
^(0?[1-9]|1[012])\/(0?[1-9]|[12][0-9]|3[01])\/((19\d{2})|([2-9]\d{3}))$ 
```

[小提琴](http://jsfiddle.net/mrajcok/YmmVp/2/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-26T21:19:27.167

接受的答案对我不起作用。我改为：

```
^(0?[1-9]|1[012])\/(0?[1-9]|[12][0-9]|3[01])\/((19\d{2})|([2-9]\d{3}))$ 
```

否则只有 1990 年以后出生的人才需要申请！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-06-23T20:14:15.927

**检查闰年验证：**日期格式：`dd-mm-yyyy`

正则表达式模式：`^(0?[1-9]|1\d|2[0-8]|29(?=[-]\d?\d[-](?!1[01345789]00|2[1235679]00)\d\d(?:[02468][048]|[13579][26]))|30(?![-]0?2)|31(?=[-]0?[13578]|[-]1[02]))[-](0?[1-9]|1[0-2])[-]([12]\d{3})$`

**[演示](http://jsfiddle.net/YmmVp/479/)**

**[另一个演示](https://regex101.com/r/tR0yC5/1)**

# android - Android 从特定的 inputDevice 获取文本

> ID：14146661
> 
> 赞同：0
> 
> 时间：2013-01-03T20:26:36.000
> 
> 标签：android

使用以下代码，我可以列出连接到 Android 设备的 inputDevices。

```
public void onClick(View v) {
    if(v==mConnect){
        Toast.makeText(MainActivity.this, "TESTE", Toast.LENGTH_LONG).show();
        Log.d("INPUTDEVICES", "111111111111111111111");
        int[] teste;
        teste = new int[10];

        for(int i=0;i<5;i++){
        teste[i]=-1;
        }

        teste = InputDevice.getDeviceIds();
        for(int i=0;i<5;i++){
            Log.d("TESTE", Integer.toString(teste[i]));
            Log.d("TESTEE",InputDevice.getDevice(teste[i]).getName());
        }

    }
}

D/INPUTDEVICES( 6572): 111111111111111111111
D/TESTE   ( 6572): 1
D/TESTEE  ( 6572): Phone_key
D/TESTE   ( 6572): 3
D/TESTEE  ( 6572): ssd253x-ts
D/TESTE   ( 6572): 4
D/TESTEE  ( 6572): sun4i-keyboard
D/TESTE   ( 6572): 5
D/TESTEE  ( 6572): axp20-supplyer
D/TESTE   ( 6572): 8
D/TESTEE  ( 6572): Logitech USB Keyboard 
```

现在我想等待来自特定输入设备的文本，在本例中是输入设备 8 - Logitech USB 键盘。你能帮我解决这个问题吗？

谢谢 ：）

编辑

我想要这样的东西：

```
@Override
public boolean dispatchKeyEvent(KeyEvent e) {
if (e.getKeyCode() == KeyEvent.KEYCODE_ENTER) {
    Toast.makeText(UITestsActivity.this,
               "YOU CLICKED ENTER KEY",
                Toast.LENGTH_LONG).show();
        return true;
    }
    return super.dispatchKeyEvent(e);
}; 
```

但这适用于所有键盘键，如'a'，'b'，'c'，...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T08:21:19.993

您可以使用 KeyEvent 类中的方法 getDeviceId() 来筛选所需的键盘：

[http://developer.android.com/reference/android/view/KeyEvent.html#getDeviceId%28%29](http://developer.android.com/reference/android/view/KeyEvent.html#getDeviceId%28%29)

# windows-phone-7 - Window Phone 控件如何根据来自其他绑定的值绑定文本块的值

> ID：14146662
> 
> 赞同：1
> 
> 时间：2013-01-03T20:26:36.730
> 
> 标签：windows-phone-7

假设我有以下课程：

```
Class C {
    public string A {get; set;}
    public string B {get; set;}
} 
```

XAML 文件的一部分由 2 个文本块组成

```
<TextBlock Text="{Binding C.A, TargetNullValue=Not available}"/>
<TextBlock Text="{Binding C.B}"/> 
```

现在我遇到了属性 A 可以为空的问题，因此我使用 TargetNullValue 发送没有值的消息，但我也希望如果 A 为空 -> B 应该显示为空字符串，否则 B 只是 B。所有必须无需更改对象即可工作，因为当 B 的值不依赖于 A 时，B 将在其他地方使用。

简而言之：最好是第二个文本块可以是属性 A 的侦听器（在检查 TargetNullValue 时定位 A），但如果它要显示某些内容（使用 Path 属性），它会切换到 B。

我不确定在 XAML 中是否可行，或者我需要做一些绕行，有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T11:16:04.337

以下是您的限制条件的回顾：

*   你不能改变班级`C`
*   如果`C.A`为null，则在第二个中显示一个空字符串`TextBox`
*   如果`C.A`!= null，则在第二个中显示 CB`TextBox`
*   更改时`C.A`，第二个`TextBox`必须相应更新

这是我认为你应该做的：

*   将第二个绑定`TextBox`到`C.A`以便在该属性更改时收到通知
*   使用 a[`Converter`](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.converter%28v=vs.95%29.aspx)显示空字符串或`C.B`

# php - 我的功能不起作用。我正在调用查询并想要调用结果

> ID：14146668
> 
> 赞同：0
> 
> 时间：2013-01-03T20:26:59.807
> 
> 标签：php, mysql

```
<?php   

 function get_subject_by_id2() {
            global $connection;
            $query = "SELECT * ";
            $query .= "FROM subjects ";
            $query .= "WHERE id= 2 ";
            $query .= "LIMIT 1";
            $result_set = mysqli_query($connection, $query);
            confirm_query($result_set);
            // REMEMBER:
            // if no rows are returned, fetch_array will return false
            if ($subject = mysqli_fetch_array($result_set)) {
                return $subject2;
            } else {
                return NULL;
            }
        }

echo $subject2['content1'];
echo $subject2['content2'];

?> 
```

我不知道为什么这不起作用。请帮忙！

我相信它不会返回 NULL，而是返回 $subject2。由于某种原因，它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:31:32.173

您甚至在哪里调用该函数？该函数没有被调用，因此它不能返回任何东西

```
$subject2=get_subject_by_id2();   // forgot to make this call?
echo $subject2['content1'];
echo $subject2['content2']; 
```

也正如**yajakass**所建议的那样修复错字

# javascript - IndexedDB 中的多键查询（类似于 sql 中的 OR）

> ID：14146671
> 
> 赞同：3
> 
> 时间：2013-01-03T20:27:07.353
> 
> 标签：javascript, indexeddb

我在标签上存储了 multiEntry 索引。

```
{ tags: [ 'tag1', 'tag2', 'tag3' ] } 
```

我也有标签列表的查询。

```
[ 'tag2', 'tag1', 'tag4' ] 
```

我需要获取包含查询中标记之一的所有记录（类似于 SQL OR 语句）。

目前我找不到任何其他解决方案，除了在查询中迭代标签并按商店中的每个标签进行搜索。

有没有更好的解决方案？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T06:28:57.977

除了迭代之外，您不能用一个查询检索所有结果。您可以通过打开从最低值到最高值的索引来优化搜索结果：

```
IDBKeyRange.bound ('tag1', 'tag4'); 
```

您可以使用的其他 Indexed-Db 功能是打开多个查询并在查询完成时合并结果。这种方式会比迭代快得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T08:23:50.260

正如 Deni Mf 回答的那样，IndexedDB 只有范围查询。

OR 查询只是多个查询的联合。那可能没问题。

如果你想要高效的查询，你必须迭代游标并根据需要寻找游标位置。使用[我的图书馆](http://dev.yathit.com/ydn-db/getting-started.html)，它将是

```
tags = ['tag2', 'tag1', 'tag4'];
tags.sort();
iter = new ydn.db.KeyIterator('store name', 'tags', IDBKeyRange.bound(tags[0], tags[tags.length-1]);
keys = [];
i = 0; 
var req = db.open(iter, function(cursor) {
  if (tags.indexOf(cursor.indexKey()) >= 0) {
      // we got the result
     if (keys.indexOf(cursor.key()) == -1) { // remove duplicate
       keys.push(cursor.key());
     }
  } else {
     return tags[++i]; // jump to next index position.
  }
);

req.done(function() {
  db.list('store name', keys).done(function(results) {
     console.log(results);
   }
}); 
```

请注意，该算法没有误报检索。首先进行key only查询，这样我们就不会浪费在反序列化上。只有我们在删除重复项后获得所有主键才能检索结果。

# c# - 内存不足导致调试冻结？

> ID：14146674
> 
> 赞同：1
> 
> 时间：2013-01-03T20:27:16.790
> 
> 标签：c#, .net, visual-studio-2010, debugging, memory-management

在服务器（内存为 1GiB）上，我正在运行 SQL Server、IIS7 和我的应用程序（在 VS IDE 的调试中运行）。SQL Server 尚未配置为具有最大内存使用量，因此它一直在增长，直到内存争用开始出现。当内存紧张时，我的应用程序似乎（很少）只是**freeze**。它从未崩溃，没有错误，什么都没有，只是完全**冻结**。

每次我连接远程桌面并点击调试器中的**暂停**按钮（以检查堆栈跟踪）时，一切看起来都很好，并且在**unpausing**时，应用程序将恢复（和**unfreeze**），就好像什么都没发生过一样。

今天我**解冻**了服务器，在我的日志中发现它已经冻结了半个多小时（实际上什么也没做）：

> 1/3/2013 7:37:07 PM [LOG] 违反了实时约束；处理扇区 AI 需要 2197516 毫秒。

这种行为是否记录在任何地方？我喜欢调试器可以只冻结应用程序而不是抛出内存不足的异常，但我想知道这一点（比如什么情况下允许调试器这样做，因为内存不足的异常确实存在！）。

**编辑：**为了清楚起见，我的应用程序没有显示任何内存泄漏迹象；它已经运行了**56 天**，几乎没有使用**50MiB**的内存。当我解冻应用程序时，一切恢复正常运行，我已经将近两个月没有重新启动应用程序了。配置[SQL Server 最大内存](http://msdn.microsoft.com/en-us/library/ms178067.aspx)（SQL Server 不单独运行时的常见做法）可能会使这个问题消失，但正如最初所说，我想了解更多有关它的信息。

# java - 如何使用选择器语法 Jsoup 通过 ID 的子字符串查找元素？

> ID：14146676
> 
> 赞同：6
> 
> 时间：2013-01-03T20:27:19.250
> 
> 标签：java, android, regex, jsoup

我使用 Jsoup 从 URL 获取页面。我可以使用以下代码行提取某个 id 的链接：

```
Elements links = doc.select("a[href]#title0"); 
```

如果我只知道其 ID 的一部分，例如“标题”，我如何才能找到这些元素。我知道我可以找到所有带有**href的****a**链接，然后遍历“链接”并检查它的 id 是否包含“标题”子字符串，但是我想避免这种方法。有没有办法过滤选择器中的链接并检查它的 id 是否包含'title'子字符串？

 *** * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-03T20:36:00.487

你可以使用类似的东西：

```
Elements links = doc.select("a[id^=nav]"); 
```

这将返回所有 id 以字符串“nav”开头的链接

以下将返回所有 id 包含字符串“logo”的链接

```
Elements links = doc.select("a[id~=logo]"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-04T08:28:15.503

@alex-ackerman 的答案有一半是正确的，但另一半是错误的。

> [attr^=valPrefix] 元素的属性名为“attr”，值以“valPrefix”开头 [attr$=valSuffix] 元素的属性名为“attr”，值以“valSuffix”结尾 [attr*=valContaining]属性名为“attr”的元素，值包含“valContaining” [attr~=regex] 属性名为“attr”的元素，值与正则表达式匹配 以上可以按任意顺序组合

[http://jsoup.org/apidocs/org/jsoup/select/Selector.html](http://jsoup.org/apidocs/org/jsoup/select/Selector.html)**

# delphi - 实际参数过多（消息对话框）

> ID：14146679
> 
> 赞同：4
> 
> 时间：2013-01-03T20:27:24.533
> 
> 标签：delphi, kylix

我继承了一个有许多问题的程序。最新的一个是太多实际参数警告：

```
 if MessageDlgPos('IS THIS CORRECT? ' , mtConfirmation,
  **[mbyes, mbno], 0, 400, 450, mbno) = mrno then begin**
    edtPstvEmplyNmbr.SetFocus;
    xitFlg:= True; 
```

粗体部分是错误突出显示的地方。

注意：该程序有效，只是不在我的机器上。它是使用相同版本的 Delphi (7) 开发的，但在 clx (kylix) 环境中。我想我（可能）已经解决了 clx 和 vcl （我当前的环境）之间的所有不兼容问题，但可能是我缺少一个生成此错误的组件。我会尽力澄清任何问题，但请记住，我开发 Delphi 才几个月。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T21:34:58.197

Delphi 的 VCL 和 Kylix 的 CLX 不完全兼容。特别是，一些名称相似的函数采用不同数量的参数，正如您亲身学习的那样。

*现代*版本的 Delphi 支持[`MessageDlgPos`](http://docwiki.embarcadero.com/Libraries/XE3/en/Vcl.Dialogs.MessageDlgPos)您尝试调用的版本，但很明显 Delphi 7 不支持。*可能*发生的情况是，当VCL 版本只有六个参数时，CLX 引入了七参数重载，然后后来的 Delphi 版本将 CLX 版本移植回 VCL。请记住，Delphi 7 已有十多年的历史了。

要查看可以使用的函数版本，请查看*Dialogs.pas*。

如果您有六参数版本，您可能可以简单地删除最后一个参数，然后处理默认按钮可能不是您想要的事实。另一种选择是调用[`MessageBox`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645505.aspx)，它可以让您以指定窗口位置为代价来指定默认按钮。

# node.js - 亚马逊服务器上的新贵未知作业错误

> ID：14146681
> 
> 赞同：0
> 
> 时间：2013-01-03T20:27:40.607
> 
> 标签：node.js, amazon-ec2, upstart

我正在尝试部署我的第一个新贵工作以在服务器崩溃时重新加载服务器，但无论我在工作中投入什么，它都会给出未知工作的错误。即使我的工作什么也不做，只发表评论。这就是工作。只有几个林。我正在使用 emacs

```
 # comment
 description "golf"
 script
    export HOME="/root"

     exec sudo -u  
  ubuntu /usr/local/bin/node 
    /home/ubuntu/golf/node/lib/db-server1.js  2>&1
   >> /var/log/golf.log 
      end script 
```

路径是正确的，但我总是得到错误未知的工作高尔夫，即使我删除了所有内容。感谢您的任何建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T14:06:06.540

很可能，服务名称与您的预期不符。最值得注意的是，大写字母`G`非常不寻常。您确定 中存在服务定义`/etc/init.d/Golf.conf`，而不是`/etc/init.d/golf.conf`（注意小写的 g）？

# menu - 隐藏菜单系统

> ID：14146684
> 
> 赞同：0
> 
> 时间：2013-01-03T20:27:54.770
> 
> 标签：menu

我正在寻找一些关于如何创建隐藏菜单的代码。基本上我想在水平菜单中有四个链接。当您单击一个链接时，我希望它隐藏其他可能在上方或下方以提供文本框的链接。该框也将包含我们仅由设计者输入的信息。

我有一个链接可以预览以下示例的模板：http: [//www.graphicalwonders.com/archives/brian/Homepage.jpg](http://www.graphicalwonders.com/archives/brian/Homepage.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:33:45.127

[jQuery UI](http://jqueryui.com/accordion/) - [手风琴 API](http://api.jqueryui.com/accordion/) - [Viral Patel](http://viralpatel.net/blogs/create-accordion-menu-jquery/)

查看这些链接以获取手风琴菜单示例。我发现 Viral 更容易使用，但是 jQuery UI & API 更详细地解释了它是如何工作的。

# c# - C# 检测 WebBrowser 是否失去与网站的连接

> ID：14146690
> 
> 赞同：1
> 
> 时间：2013-01-03T20:28:16.470
> 
> 标签：c#, browser

我正在制作一个程序来检查网页中的警报。我使用以下指令连接：

```
Connect()
{
Browser.Navigate(url, "", enc.GetBytes(PostData), "Content-Type: application/x-www-form-urlencoded\r\n");
...
} 
```

然后我使用以下指令每隔一秒检查一次警报：

```
GetMessages()
{
HtmlDocument doc = Browser.Document;
if (int.TryParse(doc.GetElementById("messages_count").InnerText, out msgs))
...
} 
```

它运行良好，但如果我使用传统的网络浏览器检查该站点，则`GetMessages()`不再返回更新的值。所以我所做的是创建一个运行`Connect()`函数的 10 秒间隔的第二个计时器，因此当用户访问该页面时，程序不会过时超过 10 秒。

但是似乎没有必要一直保持登录。如果我能检测到何时需要`Connect()`再次运行而不是一直这样做以防万一，那会更好。有什么办法可以做到这一点吗？

# windows-8 - 在 Windows 8 上设置时出现 VS2012 错误 - 找不到 Visual C++ 2012 x86 最小运行时

> ID：14146692
> 
> 赞同：1
> 
> 时间：2013-01-03T20:28:23.687
> 
> 标签：windows-8, visual-studio-2012, installation

我在尝试下载新的 VS2012 时遇到一些错误。它是 Windows 8 的全新安装（Windows 是否更新）。我尝试不选择所有（没有 C++、lightswitch、blend、office 工具）我尝试了不同的 .ISO 安装工具，但没有运气。VS2010 还在工作。运行 x86。 [日志文件](http://dl.dropbox.com/u/75069700/logfile.txt)

错误：

严重：Microsoft Visual C++ 2012 x86 最小运行时 - 11.0.507 找不到请求的对象。

Microsoft Visual Studio 2012 Pre-Clean Tool 找不到请求的对象

Microsoft Visual C++ 2012 x86 Additional Runtime - 11.0.507 找不到请求的对象。

Microsoft Visual C++ 2012 Core Libraries、Team Foundation Server 2012、Microsoft Framework 4.5 Multi-Targeting pack....和其他一些找不到。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T18:08:37.927

下载了网络安装程序，这似乎工作。由于 MD5 不匹配，iso 似乎已损坏。

# ruby-on-rails - 如何更改 Rails 3 中的默认 Rails 服务器？

> ID：14146700
> 
> 赞同：14
> 
> 时间：2013-01-03T20:28:40.227
> 
> 标签：ruby-on-rails, ruby-on-rails-3, webserver

我是 Rails 的新手，我想知道是否有一个选项可以将默认的 Rails 服务器（即 webrick）更改为另一个，例如“puma”或“thin”。我知道可以使用“rails server”命令指定要运行的服务器，但是我想在不指定服务器名称的情况下使用此命令，以便它可以运行默认的 rails 服务器。有没有办法将默认的 Rails 服务器更改为配置文件或类似的东西？在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-16T15:39:38.733

根据`James Hebden`的回答：

添加`Puma`到宝石文件

```
# Gemfile
gem 'puma' 
```

捆绑安装

```
bundle 
```

将其设为默认值，将此代码粘贴到`script/rails`上面`require 'rails/commands'`：

```
require 'rack/handler'
Rack::Handler::WEBrick = Rack::Handler.get(:puma) 
```

所以`script/rails`(in `Rails` `3.2.12`) 看起来像：

```
#!/usr/bin/env ruby
# This command will automatically be run when you run "rails" with Rails 3 gems installed from the root of your application.

APP_PATH = File.expand_path('../../config/application',  __FILE__)
require File.expand_path('../../config/boot',  __FILE__)
require 'rack/handler'
Rack::Handler::WEBrick = Rack::Handler.get(:puma)
require 'rails/commands' 
```

运行服务器

```
rails s
=> Booting Puma 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-03T21:04:04.277

Rack（Rails 和 Web 服务器之间的接口）具有默认 WEBrick 和 Thin 的处理程序。如果您将以下内容放在您`Gemfile`的 rails 项目的根目录中

```
gem 'thin' 
```

rails server 会自动使用 Thin。从 3.2rc2 开始就是这种情况。

不幸的是，这只适用于 Thin，因为 Rack 没有对 Unicorn 等的内置支持。

对于具有 Rack 处理程序的服务器（同样遗憾的是，Unicorn 没有），您可以做一些 hack 来让 rails 服务器使用它们。在 rails 项目根目录下的 scripts/rails 文件中，您可以在 `require 'rails/commands' 上方添加以下内容

```
require 'rack/handler'
Rack::Handler::WEBrick = Rack::Handler::<name of handler class> 
```

这实际上将 WEBrick 的处理程序重置为指向您要使用的服务器的处理程序。

要了解支持的 Rack 处理程序，请查看源代码中的注释：[https ://github.com/rkh/rack/blob/master/lib/rack/handler.rb](https://github.com/rkh/rack/blob/master/lib/rack/handler.rb)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-03T20:43:01.657

我认为 Rails 只是将提供给机架的服务器选项传递给了机架。Rack 具有以下逻辑来确定要运行的服务器：

[https://github.com/rack/rack/blob/master/lib/rack/server.rb#L271-L273](https://github.com/rack/rack/blob/master/lib/rack/server.rb#L271-L273)

```
def server
  @_server ||= Rack::Handler.get(options[:server]) || Rack::Handler.default(options)
end 
```

第一种情况是`:server`选项被传递给`rails server`命令时。二是确定默认值。看起来像：

[https://github.com/rack/rack/blob/master/lib/rack/handler.rb#L46-L59](https://github.com/rack/rack/blob/master/lib/rack/handler.rb#L46-L59)

```
def self.default(options = {})
  # Guess.
  if ENV.include?("PHP_FCGI_CHILDREN")
    # We already speak FastCGI
    options.delete :File
    options.delete :Port

    Rack::Handler::FastCGI
  elsif ENV.include?("REQUEST_METHOD")
    Rack::Handler::CGI
  else
    pick ['thin', 'puma', 'webrick']
  end
end 
```

Thin 和 Puma 应该会自动拾取。后备是 Webrick。当然，其他 Web 服务器可以覆盖此行为，使它们成为链中的第一个。

如果您的 Web 服务器在默认情况下没有被拾取，您可以对该方法进行猴子修补，`default`使其按您想要的方式工作。当然，这可能会在未来版本的机架中中断。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-07-07T16:36:44.043

Rack 现在将查看`RACK_HANDLER`环境变量文件以查看您是否指定了默认机架处理程序。如果您使用 dotenv，您可以在 .env 文件中添加这样的行来设置默认值，或者从命令行指定分配。

```
`RACK_HANDLER=webrick` 
```

这应该在这个拉取请求中起作用：

[https://github.com/rack/rack/pull/590](https://github.com/rack/rack/pull/590)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-03T20:34:20.290

如果你想要独角兽/瘦/等，只需将 gem 添加到你的 gemfile

即`gem 'unicorn'`,`gem 'thin'`等然后`bundle install`在命令行运行。

据我所知，添加这些宝石中的任何一个都会通过以下方式运行相应的服务器`rails server`

**更新**

显然这仅适用于 Thin 或 Puma。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-03T20:41:50.223

我不会挂断专门使用该`rails server`命令。只需安装您想要的任何 gem 并将命令（例如`rails s Puma`）别名为简单的`rs`.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-03-18T09:09:42.637

如果您的 Gemfile 中有**薄**文件，则需要执行以下操作：

```
require 'rack/handler'
Rack::Handler::Thin = Rack::Handler.get(:puma) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-09-04T08:25:01.393

如果你使用 bash 运行：`export RACK_HANDLER=webrick`

# asp.net-mvc-4 - Simplemembership Provider ASP.NET MVC 4 密码格式

> ID：14146702
> 
> 赞同：2
> 
> 时间：2013-01-03T20:28:47.617
> 
> 标签：asp.net-mvc-4

我已经很好地迁移到 simplemembership。现在唯一困扰我的是如何配置密码设置，例如它是散列、清除还是加密等。我不相信它会再出现在 web.config 中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T00:49:09.777

Simplemembership 是围绕用户、角色和配置文件的特定视图而设计的

现有的提供者专注于传统的会员资格——用户有用户名和密码、网站上的一些特定角色（例如管理员、高级用户），并且可能有一些额外的“很高兴拥有”可选信息，可以通过应用程序中的 API。

这不适合一些现代使用模式：

在 OAuth 和 OpenID 中，用户没有密码 通常这些场景更好地映射到用户声明或权利，而不是单一的用户角色对于许多站点，配置文件或其他非传统信息非常重要，需要来自某个地方除了映射到数据库 blob 的 API 调用之外，在这里工作得更好的是一个系统，在该系统中，您可以根据需要定义用户、权限和其他属性，并且成员资格系统与您的模型一起使用 - 而不是其他方式。

您无法使用 SimpleMembership 检索密码，但您可以让用户重置密码。没有解决方法。

您必须使用其他一些成员资格提供程序，例如标准的 SqlMembershipProvider，它也可能不允许您以明文形式检索密码。

以明文形式检索密码的日子已经结束，因为如果最终落入坏人之手，这是一个重大的安全风险。

希望这可以清除您对希望实现的目标的一些想法。

一些阅读： [http ://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net-4-5-web-forms -and-asp-net-mvc-4-templates.aspx](http://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net-4-5-web-forms-and-asp-net-mvc-4-templates.aspx)

[在 MVC4 RTM 中从 ASP.NET 成员身份迁移到 SimpleMembership](https://stackoverflow.com/questions/12236533/migrating-from-asp-net-membership-to-simplemembership-in-mvc4-rtm)

[http://brockallen.com/2012/09/02/think-twice-about-using-membershipprovider-and-simplemembership/](http://brockallen.com/2012/09/02/think-twice-about-using-membershipprovider-and-simplemembership/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:30:01.473

SimpleMembership 不允许您选择密码格式。

# django - Django 和 South：使用 south 使 syncdb 将 myapp 显示为“未同步（使用迁移）”

> ID：14146703
> 
> 赞同：5
> 
> 时间：2013-01-03T20:28:47.663
> 
> 标签：django, django-south

当我运行 ./manage.py syncdb 时，它说未同步（使用迁移）。但是，当我跑步时

```
$ ./manage.py schemamigration myapp --auto
Nothing seems to have changed
$ ./manage.py migrate
blah blah, nothing to migrate 
```

根据[这个线程](https://stackoverflow.com/questions/4625712/whats-the-recommended-approach-to-resetting-migration-history-using-django-sout)，我尝试向南重置以解决问题。这是我所做的：

```
$ rm -r appname/migrations/ 
$ ./manage.py reset south
$ ./manage.py syncdb
    (at this point it shows all apps as synced)
$ ./manage.py convert_to_south myapp
blah blah, App 'blog' converted.
$ ./manage.py syncdb
    (at this point it shows myapp as not synced) 
```

运行 schemamigration > migrate 与之前的效果相同（没有，仍然没有注册为同步）。从好的方面来说，该应用程序似乎仍然可以正常工作，我只是担心这可能会导致问题。知道发生了什么以及如何解决它吗？这真的是个问题吗？如果有帮助，我正在使用 SQLite3 和 Django 1.4.2。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-03T20:33:53.740

毕竟，这可能不是问题。我刚刚在 South 文档中发现[了这一点](http://south.readthedocs.org/en/latest/commands.html#syncdb)，这似乎表明 South 接管了该功能。South “使 syncdb 仅适用于应用程序的一个子集——那些没有迁移的应用程序。” 即，syncdb 可以将 myapp 显示为未同步，因为 south 正在单独处理它。

我羞愧地垂下我的南方菜鸟头。

# python - 获取属性错误：类型对象“Level_2_Headings”没有属性“祖先”（GAE 数据存储）

> ID：14146705
> 
> 赞同：0
> 
> 时间：2013-01-03T20:28:48.873
> 
> 标签：python, google-app-engine, datastore, ancestor

我正在使用 GAE、Datastore、Python 2.7，并且第一次使用祖先在数据存储中创建/更新条目。在这里，我试图查看`Level_2_Headings`数据存储中是否有任何条目/行，如果没有，则创建一个新条目/行。如果确实存在，则更新描述。我收到此错误 - 数据存储为`Level_2_Headings`空，因此它应该恢复为空，以便我可以添加新条目，但相反，我在查询`q2`我使用祖先属性的对象时遇到错误 - 任何关于为什么会出现这种情况的想法，因为我期望只返回一个空对象，因为它不存在于数据存储中？？？像往常一样感谢帮助。

```
if q:
    q2 = Level_2_Headings.ancestor(q.key()).filter("name2 =",heading2).get()
    if q2:
        q2.description2 = description2
        q2.put()        
    else:           
        #new level 2 being added to ds
        new_2 = Level_2_Headings(parent=q2, name2=name2, description2=description2, heading_type=heading_type)
        new_2.put()

        message="Added NEW category entry to level 2" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:33:28.420

您`Level_2_Heading`直接引用模型，而不调用`all()`检索记录。`Level_2_Headings.all()`将返回一个具有该`ancestor`属性的对象，因此请尝试将您的第一个更改`q2`为：

```
q2 = Level_2_Headings.all().ancestor(q.key()).filter("name2 =",heading2).get() 
```

# testing - 如何设计我的测试自动化

> ID：14146706
> 
> 赞同：1
> 
> 时间：2013-01-03T20:28:50.663
> 
> 标签：testing, automation

这是我的测试场景。

当命令行执行时 - 许多值被写入数据库中的不同表。

db 中有多个命令行选项和许多值/表需要验证。我应该如何设计数据库中的值检查？

到目前为止我所做的 -

*   执行命令

*   连接到数据库

*   运行特定于命令的查询（这将非常特定于我需要查看哪些表的命令）

*   从数据集中返回检查`if dt[row][col]="value i expect"`。

这里的优点是我必须编写更少的代码作为框架的一部分。这样做的缺点是我必须在开发每个测试时编写更多代码，而不是简化，有时我可能会弄错列名。

所以我想看看我是否能更好地简化检查。类似于声明一个类（用于表），其中列作为公开属性。这样我至少不会弄错列名。

1.  这是最简单的方法吗（从长远来看？我想编写更多可重用的代码）。如果没有，有什么最好的方法？
2.  有没有一种简单的方法可以将表/列值从 db 导出到 ac# 项目文件（作为类/代码），这样我就不必再次将所有内容放入代码中。

如果有任何细节不清楚，或者我希望我详细说明细节，请告诉我。

感谢您的关注。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T21:12:46.160

我不知道这个问题的标准方法，但我会提供一些想法。

我通常会发现自己创建类来表示表以利用编译时检查，所以我认为这是一个很好的方法。您可能想研究 Linq-to-SQL——我认为它可以为您做很多事情。为此，我有时在 Ruby 中使用 ActiveRecord，即使在 C# 项目中也是如此，因为使用它进行开发非常快。

或者，您可能希望将测试放在文本文件中：

```
Command: 
command to execute

Expected Data:
SELECT column FROM table;
row name, column name, expected data
row name, column name, expected data
row name, column name, expected data

Expected Data:
SELECT column FROM table;
row name, column name, expected data
row name, column name, expected data 
```

然后编写一些代码来加载和解析文件，运行命令并比较结果。这只会排除每次测试会发生变化的事情，所以我不知道它是否会变得更好。

另一个想法是尝试将通用代码拉入基类，并将变化的代码保留在子类中。此设计遵循模板方法模式。

例子

```
class MyTest : CommandLineTest {
  public String Command() { return "Command to execute"; }
  public String DataRetrievalCommand() { return "SELECT column FROM table"; }

  public DataResult[] ExpectedData() {
    return [ new DataResult("column", "row", "value"), ...];
  }
} 
```

超类将使用这些方法来获取命令和值，但它会做所有实际工作。与文本文件类似的想法，但测试规范保存在代码中。

希望这会有所帮助，或者至少能让一些想法流动起来。

# maven - 防止 Flyway Maven 插件下载旧的 slf4j jar

> ID：14146709
> 
> 赞同：3
> 
> 时间：2013-01-03T20:28:55.260
> 
> 标签：maven, intellij-idea, flyway

当我运行 flyway maven 插件时，它最初会下载 1.5.6 版本的 slf4j jar：

```
[INFO] ------------------------------------------------------------------------
Downloading: http://repo1.maven.org/maven2/org/slf4j/slf4j-jdk14/1.5.6/slf4j-jdk14-1.5.6.pom
Downloaded: http://repo1.maven.org/maven2/org/slf4j/slf4j-jdk14/1.5.6/slf4j-jdk14-1.5.6.pom (2 KB at 21.3 KB/sec)
Downloading: http://repo1.maven.org/maven2/org/slf4j/slf4j-parent/1.5.6/slf4j-parent-1.5.6.pom
Downloaded: http://repo1.maven.org/maven2/org/slf4j/slf4j-parent/1.5.6/slf4j-parent-1.5.6.pom (8 KB at 154.7 KB/sec) 
```

这对我的 Spring Web 应用程序造成了严重破坏，因为我在那里使用 1.7.2 版的 slf4j，当我重新启动它时它会感到困惑。

我怎样才能防止这种情况？我尝试向我的 pom.xml 添加排除项：

```
<groupId>com.googlecode.flyway</groupId>
                <artifactId>flyway-maven-plugin</artifactId>
                <version>2.0.3</version>
                <exclusions>
                    <exclusion>
                        <groupId>org.slf4j</groupId>
                        <artifactId>slf4j-log4j12</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.slf4j</groupId>
                        <artifactId>slf4j-api</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.slf4j</groupId>
                        <artifactId>jcl-over-slf4j</artifactId>
                    </exclusion>
                </exclusions> 
```

但这仍然会发生。

更新：当我使用 Intellij 12 构建时，这导致以下错误：

```
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/Users/tom/Library/Caches/IntelliJIdea12/tomcat/Unnamed_incrowdnow/work/Catalina/localhost/_/WEB-INF/lib/slf4j-jdk14-1.5.6.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/Users/tom/Library/Caches/IntelliJIdea12/tomcat/Unnamed_incrowdnow/work/Catalina/localhost/_/WEB-INF/lib/slf4j-simple-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.JDK14LoggerFactory]
SLF4J: The requested version 1.5.6 by your slf4j binding is not compatible with [1.6, 1.7]
SLF4J: See http://www.slf4j.org/codes.html#version_mismatch for further details. 
```

更新： mvn 依赖的输出：tree -Dverbose -Dincludes=org.slf4j

```
[INFO] \- com.googlecode.flyway:flyway-maven-plugin:jar:2.0.3:compile
[INFO]    \- org.apache.maven:maven-core:jar:2.2.1:compile
[INFO]       +- org.apache.maven.wagon:wagon-webdav-jackrabbit:jar:1.0-beta-6:runtime
[INFO]       |  +- org.apache.jackrabbit:jackrabbit-webdav:jar:1.5.0:runtime
[INFO]       |  |  \- (org.slf4j:slf4j-api:jar:1.5.3:runtime - omitted for conflict with 1.7.2)
[INFO]       |  \- org.slf4j:slf4j-nop:jar:1.5.3:runtime
[INFO]       |     \- (org.slf4j:slf4j-api:jar:1.5.3:runtime - omitted for conflict with 1.7.2)
[INFO]       +- org.slf4j:slf4j-jdk14:jar:1.5.6:runtime
[INFO]       |  \- (org.slf4j:slf4j-api:jar:1.5.6:runtime - omitted for conflict with 1.7.2)
[INFO]       \- (org.slf4j:jcl-over-slf4j:jar:1.5.6:runtime - omitted for conflict with 1.7.2) 
```

TIA,

汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T15:04:21.337

Flyway Maven 插件 2.0.3 和 Flyway Core 2.0.3 都不依赖于 slf4j。检查您的依赖项。问题一定来自其他地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-17T08:57:27.160

我有类似的问题，并通过使用 flyway-core 依赖而不是 flyway-maven-plugin 依赖来解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-27T19:21:22.857

FLyway下载slf4j依赖，如果你的应用使用1.7.x或1.6.x版本，那么你会遇到这个问题，因为flyway下载的是1.5.3版本的slf4j-nop和1.5.6版本的slf4j-jdk14。在 Eclipse 中，您可以在 pom.xml 的依赖层次结构下看到这一点

为了摆脱这个，添加以下所有exclusiions，你就完成了

```
 <exclusions>
            <exclusion>
                <groupId>org.slf4j</groupId>
                <artifactId>slf4j-api</artifactId>
            </exclusion>
            <exclusion>
                <groupId>org.slf4j</groupId>
                <artifactId>log4j-over-slf4j</artifactId>
            </exclusion>
            <exclusion>
                <groupId>org.slf4j</groupId>
                <artifactId>jcl-over-slf4j</artifactId>
            </exclusion>
            <exclusion>
                <groupId>org.slf4j</groupId>
                <artifactId>slf4j-nop</artifactId>
            </exclusion>    
            <exclusion>
                <groupId>org.slf4j</groupId>
                <artifactId>slf4j-jdk14</artifactId>
            </exclusion>                
        </exclusions> 
```

# cocoa-touch - 加载过程中的进度条

> ID：14146710
> 
> 赞同：0
> 
> 时间：2013-01-03T20:28:55.157
> 
> 标签：cocoa-touch, uiwebview

我编写了一个具有不同视图的应用程序，主要的应用程序基本上是一个在网络上显示 PDF 的网络视图（带有特定的 url）。问题是这个pdf有点大（大约5-10 MB），加载它需要很多时间。在此加载期间，屏幕保持白色。我想根据文件加载添加一种自动出现和消失的进度条，但我不知道如何做到这一点......有人可以帮助我吗？

（如果你有更好的想法，你可以自由地告诉）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:33:53.697

如果您使用 web 视图加载 pdf，那么您可以使用 webview 委托方法来显示进度条

# javascript - 在 jQuery .load 事件上交换 CSS 类

> ID：14146723
> 
> 赞同：1
> 
> 时间：2013-01-03T20:29:33.017
> 
> 标签：javascript, jquery

我有一个使用 CSS 样式的列表 - 标准的东西。该功能中的项目 jQuery .load 将相关信息加载到另一个 div 中。这很好用，但是我还需要更改列表中的类以反映已加载的项目。下面是我现有的代码，这可能会更好地解释它......

```
<ul class="inner-nav" id="tdlists">
  <li class="active"><a onclick="$('##showlist').load('/lists/?List=#ListID#');">#ListName#</a></li>
  <li><a onclick="$('##showlist').load('/lists/?List=#ListID#');">#ListName#</a></li>
  <li><a onclick="$('##showlist').load('/lists/?List=#ListID#');">#ListName</a></li>
</ul> 
```

实际列表由数据库查询填充，但是我已将其删除，因为我认为它与问题无关，只会使问题复杂化！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T21:15:30.697

您可以利用`this`jQuery 为加载回调设置的上下文。例如：

```
$('#showlist').load('/lists/?List=#ListID#', function(){ 
    $(this).addClass('loaded') 
}); 
```

作为附加提示，最好使用事件委托而不是为每个 li 标签编写 onclick 属性：

```
$('#tdlists').on('click', 'li a', function () {
    $('#showlist').load('/lists/?List=#ListID#', function(){ 
           $(this).addClass('loaded') 
    }); 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:33:06.920

该`.load()`事件应该有一个事件处理程序，该事件处理程序将在触发事件时触发，因此您可以在其中设置您的类。

```
$('#showlist').load('/lists/?List=#ListID#',
    function(){
        //Add class or perform your logic here
        $('#showlist').addClass(x););
    }
); 
```

**[.Load() | jQuery API](http://api.jquery.com/load-event/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:34:37.440

jQuery.load 可以传递一个回调方法，该方法在完成时运行。然后这可以更新父类上的类。

```
$('#result').load('ajax/test.html', function() {
  alert('Load was performed.');
}); 
```

# php - 显示自定义字段选择 - Wordpress

> ID：14146724
> 
> 赞同：2
> 
> 时间：2013-01-03T20:29:35.093
> 
> 标签：php, wordpress, post, custom-fields

我在我的平台上添加了一个内容评级系统，作者可以在其中选择他们的帖子适合哪些受众。目前，这些选项可用：

*   未评级
*   G
*   PG
*   R

我用来在帖子编辑页面上显示评级选项的代码是：

```
// Article Content Rating
add_action( 'add_meta_boxes', 'rating_select_box' );
function rating_select_box() {
    add_meta_box(
        'rating_select_box', // id, used as the html id att
        __( 'Content Rating (optional)' ), // meta box title
        'rating_select_cb', // callback function, spits out the content
        'post', // post type or page. This adds to posts only
        'side', // context, where on the screen
        'low' // priority, where should this go in the context
    );

}

function rating_select_cb( $post ) {
    global $wpdb;
    $value = get_post_meta($post->ID, 'rating', true);
    echo '<div class="misc-pub-section misc-pub-section-last"><span id="timestamp"><label>Article Content Rating: </label>';

    $ratings = array(
        1 => ' G ',
        2 => ' PG ',
        3 => ' R ',
    );

    echo '<select name="rating">';
    echo '<option value=""' . ((($value == '') || !isset($ratings[$value])) ? ' selected="selected"' : '') . '> Unrated </option>';

    // output each rating as an option
    foreach ($ratings as $id => $text) {
        echo '<option value="' . $id . '"' . (($value == $id) ? ' selected="selected"' : '') . '">' . $text. '</option>';
    }
    echo '</select>';

    echo '</span></div>';
}

add_action( 'save_post', 'save_metadata');

function save_metadata($postid)
{   
    if ( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE ) return false;
    if ( !current_user_can( 'edit_page', $postid ) ) return false;
    if( empty($postid) ) return false;

    if ( is_null($_REQUEST["rating"]) ) {
        delete_post_meta($postid, 'rating');
    } else {
        update_post_meta($postid, 'rating', $_REQUEST['rating']);
    }

}
// END Article Content Rating 
```

现在，问题是，我要添加什么代码`single.php`来显示他们的选择？因此，例如，如果作者选择了 PG，那么我想要，`echo 'Content Rating: PG';`或者如果它是默认的（未评级），我想要`echo 'Content Rating: Unrated';`. 这怎么可能？理想情况下，由于我的平台流量很大，因此服务器上的解决方案很轻松。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:37:13.400

您已经使用`delete_post_meta()`和`update_post_meta()`函数来删除和修改自定义值。只需使用该[`get_post_meta()`](http://codex.wordpress.org/Function_Reference/get_post_meta)函数获取当前帖子的值，并在您认为合适的时候将其回显。

如果您在[The Loop](http://codex.wordpress.org/The_Loop)中，它将类似于：

```
$rating = get_post_meta(get_the_ID(), 'rating', TRUE); 
```

**编辑：**

您已经知道您的 ID 到评级的映射（我可能会将此映射设为全局数组，或一些定义，或类似的东西）。只需使用它来查找要输出的字符串：

```
$ratings = array(
    1 => 'G',
    2 => 'PG',
    3 => 'R'
);

if(array_key_exists($rating, $ratings)) {
    echo "Content Rating: $ratings[$rating]";
} else {
    echo "Content Rating: Unrated";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:41:41.840

看起来好像您将键保存到自定义字段而不是其值。我想如果你计划重新声明你的 $ratings 数组，或者（上帝保佑）在全球范围内使用它，这会没问题。但是，如果您保存实际评级而不是其 ID 号，可能会更好。

所以改变这一行：

```
foreach ($ratings as $id => $text) {
    echo '<option value="' . $id . '"' . (($value == $id) ? ' selected="selected"' : '') . '">' . $text. '</option>';
} 
```

对此：

```
echo '<option value="Unrated"' . ((!$value || $value == 'Unrated' ? ' selected="selected"' : '') . '">Unrated</option>';
foreach ($ratings as $id => $text) {
    echo '<option value="' .trim($text). '"' . (($value == trim($text)) ? ' selected="selected"' : '') . '">' . $text. '</option>';
} 
```

在帖子中设置好你的值后，你可以在 single.php 中添加：

```
if(have_posts()) : while(have_posts()) : the_post();
    echo 'Content Rating: '.get_post_meta($post->ID, 'rating', true);
endwhile;endif; 
```

**更新：**

正如我在评论中提到的，我个人尽量避免使用全局变量并重新声明。因此，如果您仍然希望通过 Key 引用您的评级，您可以通过添加一些简单的函数来绕过全局变量并重新声明您的评级数组：

*函数.php*

```
function gw_get_ratings_array()
{
    $ratings = array(
        1 => 'G',
        2 => 'PG',
        3 => 'R'
    );
    return $ratings;
}
function gw_get_rating($key=0)
{
    $i = (int)$key;
    $ratings = gw_get_ratings_array();
    return isset($ratings[$i]) && $ratings[$i] ? $ratings[$i] : 'Unrated';
} 
```

*单.php*

```
if(have_posts()) : while(have_posts()) : the_post();
    $rating_id = get_post_meta($post->ID, 'rating', true);
    echo 'Content Rating: '.gw_get_rating($rating_id);
endwhile;endif; 
```

这样，如果您需要添加更多评级类型，您只需更改 gw_get_ratings_array 函数，而不是搜索数组本身的每个声明。

# php - 来自 json_decode 的不完整数据

> ID：14146726
> 
> 赞同：1
> 
> 时间：2013-01-03T20:29:50.493
> 
> 标签：php, json

好吧，一些基本信息...

PHP 5.3.5
JSON 1.2.1

这一切都在本地 XAMPP 服务器上运行。基本上，我下面的代码返回一个不完整的关联数组。json_last_error() 返回 0。我已经搜索了网络，但在没有返回特定 json 错误的情况下找不到此类错误。

```
<?php
$ShippingObj = json_decode($_POST['formData'], true);
echo json_last_error();
echo $ShippingObj; 
```

我已经用 JSONLint 验证了这个字符串。这就是它的输出......

```
array (
      'name' => 'newShipment',
      'comments' => '',
      'count' => 1,
      'itemID' => 0,
      'itemWeight' => 7.548,
      'itemLength' => 0,
      'itemWidth' => 0,
      'itemHeight' => 0,
      'limits' => '',
      'collection' => 
      array (
        0 => 
        array (
          'name' => '8x6x4 Standard',
          'comments' => '',
          'count' => 5,
          'itemID' => '3',
          'itemWeight' => 7.5475,
          'itemLength' => '8',
          'itemWidth' => '6',
          'itemHeight' => '4',
          'limits' => 'MFR',
          'collection' => 
          array (
            0 => 
            array (
              'ID' => '1',
              'Name' => ' TA-200 Demarcation Enclosure',
              'Qty' => 1,
              'Weight' => '0.34',
            ),
            1 => 
            array (
              'ID' => '2',
              'Name' => ' CG-1000 Demarcation Enclosure',
              'Qty' => 4,
              'Weight' => '1',
            ),
            2 => 
            array (
              'ID' => '19',
              'Name' => ' FM-02 Stereo FM Transmitter',
              'Qty' => 1,
              'Weight' => '0.1625',
            ),
            3 => 
            array (
              'ID' => '20',
              'Name' => ' Renard 64 Rev XC Parts Kit w/PCB',
              'Qty' => 1,
              'Weight' => '1.125',
            ),
            4 => 
            array (
              'ID' => '21',
              'Name' => ' SSRez Parts Kit w/PCB - Set of 8',
              'Qty' => 2,
              'Weight' => '0.86',
            ),
          ),
        ),
      ),
    ) 
```

这是一个有效的 JSON 构造.....这是我复制到[http://www.functions-online.com/json_decode.html](http://www.functions-online.com/json_decode.html)以验证我的字符串的输入。

```
$returnValue = json_decode('{"name":"newShipment","comments":"","count":1,"itemID":0,"itemWeight":7.548,"itemLength":0,"itemWidth":0,"itemHeight":0,"limits":"","collection":{"0":{"name":"8x6x4 Standard","comments":"","count":5,"itemID":"3","itemWeight":7.5475,"itemLength":"8","itemWidth":"6","itemHeight":"4","limits":"MFR","collection":{"0":{"ID":"1","Name":" TA-200 Demarcation Enclosure","Qty":1,"Weight":"0.34"},"1":{"ID":"2","Name":" CG-1000 Demarcation Enclosure","Qty":4,"Weight":"1"},"2":{"ID":"19","Name":" FM-02 Stereo FM Transmitter","Qty":1,"Weight":"0.1625"},"3":{"ID":"20","Name":" Renard 64 Rev XC Parts Kit w/PCB","Qty":1,"Weight":"1.125"},"4":{"ID":"21","Name":" SSRez Parts Kit w/PCB - Set of 8","Qty":2,"Weight":"0.86"}}}}}', true); 
```

第一部分代码返回 $ShippingObj 的以下内容。注意没有展开的“[collection] => array(5)”......它是空的。我检查了以前 JS 中的字符串，没问题。

```
array(10) (
  [name] => (string) newShipment
  [comments] => (string)
  [count] => (int) 1
  [itemID] => (int) 0
  [itemWeight] => (float) 16.2955
  [itemLength] => (int) 0
  [itemWidth] => (int) 0
  [itemHeight] => (int) 0
  [limits] => (string)
  [collection] => array(1) (
    [0] => array(10) (
      [name] => (string) CG2000 OEM Box
      [comments] => (string)
      [count] => (int) 5
      [itemID] => (string) 2
      [itemWeight] => (float) 8.1475
      [itemLength] => (string) 21
      [itemWidth] => (string) 16.5
      [itemHeight] => (string) 12.5
      [limits] => (string) 2ND
      [collection] => array(5) (
      )
    )
  )
) 
```

# macos - 将运行时库搜索路径添加到预构建的二进制文件

> ID：14146727
> 
> 赞同：1
> 
> 时间：2013-01-03T20:30:00.647
> 
> 标签：macos, path, binary, package, dylib

我正在尝试将预构建的二进制文件打包到 Mac OS 应用程序包中，我需要更改可执行文件的 dylib 和框架搜索路径。不幸的是，此时我无法重建二进制文件，这意味着我必须找到一个工作区，而不是从一开始就使用正确的搜索路径。有人知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T23:08:07.700

我假设您希望永久更改可执行文件。您可以使用[dyld(1)](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/dyld.1.html#//apple_ref/doc/man/1/dyld)中描述的环境变量进行临时更改。但是对于永久更改，您可以使用[install_name_tool(1)](http://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/install_name_tool.1.html)修改可执行文件。请参阅[创建工作 dylibs](http://osiris.laya.com/coding/dylib_linking.html)以获得有关如何执行此操作的简短文章。请参阅 dyld(1) 页面了解您可以使用的可替换变量，例如`@executable_path`和`@loader_path`。

# php - PHP数组比较问题

> ID：14146730
> 
> 赞同：-1
> 
> 时间：2013-01-03T20:30:04.717
> 
> 标签：php

> **可能重复：**
> [有没有办法在 php 中获取两个数组之间的公共值？](https://stackoverflow.com/questions/5513121/is-there-any-way-to-get-common-values-between-two-arrays-in-php)

我正在尝试比较 2`arrays`并根据第二个元素保留元素`array`。

我有

```
array 1

array('3' => 'test1', '4' => 'test2', '1' =>'test3')

array 2

array('2' =>'test2', '3' =>'test3') 
```

在我的情况下，我想比较`array 1`并`array 2`保留测试 2 和测试 3 。`array 1`

所以最终结果将是

```
array('4' => 'test2', '1' =>'test3') 
```

我已经尝试过`array_diff`，但它并没有得到我想要的结果。我也谷歌了一段时间，但也找不到任何有用的东西。

反正有什么我需要的吗？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:32:40.120

你很接近，[array_intersect()](http://php.net/manual/en/function.array-intersect.php)是你需要的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:36:44.107

我怀疑你*真正*想要的功能是[`array_diff_key()`](http://php.net/array_diff_key)：

```
$diff = array_diff_key($array1, $array2); 
```

（[codepad.org 上的演示](http://codepad.org/aNQ1R7wQ)）

# java - 如何在 Java 中定义集合列表？

> ID：14146731
> 
> 赞同：-1
> 
> 时间：2013-01-03T20:30:11.877
> 
> 标签：java, list, collections

我想定义一个列表，其中每个节点将指向不同类型的集合。

我怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T20:31:01.530

> 我想定义一个列表，其中每个节点将指向不同类型的集合。

```
 List<Collection<TypeYouWanted>> list = new ArrayList<Collection<TypeYouWanted>>();
    list.add(new ArrayList<TypeYouWanted>());
    list.add(new HashSet<TypeYouWanted>()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:31:22.453

只需使用泛型：`List<Collection> list = new Arraylist<Collection>();`

它定义了一个集合列表......列表中的每个条目都必须是一个实现，`Collection`但不一定是相同的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T20:32:19.013

创建不同类型对象的列表通常不是一个好的编程习惯。这是因为，除非仔细编码，否则您不知道在列表中的特定位置会得到什么。也就是说，您可以拥有一个列表对象，例如

```
List<Collection> collList = new ArrayList<Collection>(); 
```

并将您需要的任何对象添加到此列表中。

# c++ - 通过UDP套接字发送结构memcopy c ++

> ID：14146737
> 
> 赞同：0
> 
> 时间：2013-01-03T20:30:43.597
> 
> 标签：c++, struct, udp, memcpy

我正在编写一个混合程序，当发生更改（添加新子弹、添加新敌人、删除敌人或子弹）时，它会从服务器向客户端发送一个包含精灵向量的结构。该程序经常在结构中的向量中添加几个敌人。

结构的发送和接收似乎工作正常，但是当我尝试将结构复制到客户端程序上的敲击中时，程序崩溃了。我不确定是否必须重新调整结构的大小或如何执行此操作，或者是否有其他解决方案。

这是我的结构：

```
struct map{ 
Player Player1;//DECLARE Player SPRITE  

vector<Bullet> Bullets;

vector<Enemy*> Enemies;

}Map;
char Buffer[100]; 
```

这是我在收到结构后使用的功能：

```
memcpy(&Map, Buffer, sizeof(Buffer));
MessageBox (NULL, "Memcopied",  "HelloMsg", MB_OK); 
```

我将非常感谢任何帮助，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:37:06.170

看起来`Player`和/或`vector`不仅在堆栈上，而且还有指向其他地方的指针，比如堆上来存储你的所有信息。因此，一旦您打开消息，这些指针就会悬空。您应该尝试设计自己的数据格式，其中所有信息都整齐地放置在内存中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T22:50:43.027

像 memcpy 和 memset 这样的旧 C 函数对 POD 结构很有用，但对于包含诸如 std 容器这样的“复杂”对象的结构/类来说，它们是非常危险的。Memcpy 只是逐字节复制对象。但是，std 容器在堆中包含指向内存的指针，当您使用 memcpy 复制它们时，您会得到两个指向同一内存的对象。当其中一个被销毁时，另一个仍然指向已删除的内存。它会导致崩溃。我认为您需要某种特定类型才能将数据从服务器传递到客户端。

# xml - 在 AS3 中嵌入带有关联 XSD 的 XML 文件时出现问题

> ID：14146743
> 
> 赞同：0
> 
> 时间：2013-01-03T20:31:12.590
> 
> 标签：xml, actionscript-3, xsd, flash-builder

EDITx2：下面的问题似乎是由与我的 XML 模式相关的属性引起的，我主要使用这些属性，因此我可以在 FB 4.7 中验证我的 XML，并且一旦 XML 嵌入到应用程序本身中就不需要了。

创建一个与我的 XML 文档相同但省略 xmlns、xmlns:xsi 和 xsi:schemalocation 属性的 XML 对象会在 AS 中生成一个可以正确导航的 XML 对象。包括它们不仅会导致以下问题，还会导致 xmlns 和 xmlns:xsi 属性沿树向下传递，使得原始 XML 对象的基于 XMLList 的子集同样难以剖析。下面的代码示例已更新以显示该现象。

现在的问题变成了：当我以某种方式嵌入 XML 时，是否可以剥离与模式相关的属性，或者以其他方式使它们对 AS 更友好？

编辑：我遇到的问题似乎与嵌入的 XML 文档特别相关；在 AS3 中直接创建的 XML 变量可以正常遍历。

我在 AS3 中遇到了一个看似荒谬的问题。让我们假设一个名为 example.xml 的 XML 文档如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<myParent xmlns="http://www.example.com/Schema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.example.com/Schema Schema.xsd">
  <myChild id="1">
    <myGrandchild cid="1" />
    <myGrandchild cid="2" />
  </myChild>
  <myChild id="2">
    <myGrandchild cid="3" />
  </myChild>
</myParent> 
```

然后我尝试通过嵌入将它分配给 AS3 中的静态常量（以便在其本机类之外访问），如下所示：

```
[Embed(source="example.xml", mimeType="application/octet-stream")]
private static const exampleXML:Class;
public static const myXML:XML = XML(new exampleXML); 
```

然后我想用 XMLList 从中提取元素/节点。这就是我遇到的问题。这里有两个可以按我预期工作的示例，然后是三个不可以的示例：

```
// #1
var myList:XMLList = myXML.*;
trace(myList);
/*
  <myChild id="1" xmlns="http://www.example.com/Schema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <myGrandchild cid="1" />
    <myGrandchild cid="2" />
  </myChild>
  <myChild id="2" xmlns="http://www.example.com/Schema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <myGrandchild cid="3" />
  </myChild>
*/

// #2
var myList:XMLList = myXML.*.(@id==1);
trace(myList);
/*
  <myChild id="1" xmlns="http://www.example.com/Schema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <myGrandchild cid="1" />
    <myGrandchild cid="2" />
  </myChild>
*/

// #3
var myList:XMLList = myXML.myChild;
trace(myList);
/*
  (Outputs nothing at all)
*/

// #4
var myList:XML = myXML.myChild[0];
trace(myList);
/*
  null
*/

// #5
var myList:XMLList = myXML.child("myChild");
trace(myList);
/*
  (Outputs nothing at all)
*/ 
```

理论上，#3 和#5 应该给出与#1 相同的输出，而#4 应该给出与#2 相同的输出。为什么 3-5 出现空白？将 myXML 声明为静态或常量有问题吗？我究竟做错了什么？

显然，我在这里使用了一个非常通用的示例。我正在使用的实际 XML 与 XSD 模式相关联。如果这可能对我的问题有任何影响，请告诉我，我会发布我的实际代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T15:17:43.777

```
 //Since a namespace was defined in The xml you need access it via the namespace Object 
  var myXML:XML = 
  <myParent xmlns="http://www.w3.org/2000/Schema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.example.com/Schema Schema.xsd">
    <myChild id="1">
      <myGrandchild cid="1" >fus</myGrandchild>
      <myGrandchild cid="2" >ro</myGrandchild>
    </myChild>
    <myChild id="2">
      <myGrandchild cid="3" >do</myGrandchild>
    </myChild>
  </myParent>

  // to access nodes that are in a non-default namespace you must first create a namespace object
  var myChildns:Namespace = new Namespace('http://www.w3.org/2000/Schema');
  trace(myXML..myChildns::myChild.(@id  == '1').myChildns::myGrandchild.(@cid  == '1').toString())// traces out fus 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T15:27:35.850

每个 XML 文档都属于某个隐式命名空间，该命名空间通常是 "" 或空字符串。通过使用 xmlns 属性，您正在更改文档中无前缀节点使用的隐式命名空间——这就是为什么当您在文档中子选择一个节点或一组节点时会看到命名空间属性“移动”的原因。

当`xmlns`属性存在时，然后在使用 e4x 查询它们时，您必须限定您的选择，否则它们将不匹配。例如：

```
<paystub:section></paystub:section> 
```

与以下内容不同：

```
<article:section></article:section> 
```

您可以使用以下方法显式查询命名空间中的节点（如 The_asMan 建议的那样，而我正在输入此内容）：

```
namespace schema = 'http://www.w3.org/2000/Schema'
var list:XMLList = myXml.schema::myChild;
var node:XML = myXml.schema::myChild[0]; 
```

或者您可以使用以下内容为范围设置“使用”模式，然后查询不合格：

```
namespace schema = 'http://www.w3.org/2000/Schema'

use namespace schema;

var list:XMLList = myXml.myChild;
var node:XML = myXml.myChild[0]; 
```

哪个应该返回相同的正确结果。请参阅[此处的示例](http://wonderfl.net/c/fhCf)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-04T14:52:50.603

好的，终于想通了这一点。我已经设法使用正则表达式清理所有 XMLNS 和 XSI 声明的 XML：

```
[Embed(source="example.xml", mimeType="application/octet-stream")]
private static const exampleXML:Class;
public static const myXML:XML = clean(new XML(new exampleXML));

private static function clean(xml:XML):XML {
  var myXmlStr:String = xml.toString();
  var xmlPattern:RegExp = new RegExp("(xmlns|xsi)[^\"]*\"[^\"]*\"", "gi");
  myXmlStr = myXmlStr.replace(xmlPattern, "");
  xml = new XML(myXmlStr);
  return xml;
} 
```

现在可以正常遍历生成的 XML 对象，它仍然是一个静态常量，因此我可以在不创建类实例的情况下访问它，并且我可以在编辑 XML 文档本身时保持架构不变。

# android - 如何使用 AddFooterView 和字符串中的文本添加页脚？

> ID：14146744
> 
> 赞同：2
> 
> 时间：2013-01-03T20:31:12.897
> 
> 标签：android, listview, header, footer

我已经使用`ListView`. 我正在尝试`ListView`使用`ListView`. `addFooterView`在此页脚中，我想添加`TextView`一些文本，这些文本在我`Activity`的 as a `String`called中定义`notification`。

我已经尝试了几件事，但它不起作用。

我的`ListActivity`，`RoosterWijzigingen.java`：

```
public class RoosterWijzigingen extends ListActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        this.requestWindowFeature(Window.FEATURE_NO_TITLE);
        super.onCreate(savedInstanceState); 

        ArrayList<HashMap<String, String>> roosterwijziginglist = new ArrayList<HashMap<String, String>>();         

        String hour = "4";
        String info = "Af 123";
        String notification = "Het is 40min-rooster!";

        // Creating new HashMap
        HashMap<String, String> map = new HashMap<String, String>();

        // Adding each child node to HashMap key => value
        map.put("hour", hour);
        map.put("info", info);

        // Adding HashList to ArrayList
        roosterwijziginglist.add(map);}

        ListAdapter adapter = new SimpleAdapter(this, roosterwijziginglist , R.layout.roosterwijzigingen, 
                            new String[] {"hour", "info"}, 
                            new int[] {R.id.hour, R.id.info});
        setListAdapter(adapter);

        setContentView(R.layout.listplaceholder);           
   }
} 
```

我从 JSON 文件中获取字符串*hour*、*info*和*notification*的信息，但我省略了这一点以缩短代码。

`listplaceholder.xml`：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >            

        <ListView
                         android:id="@+id/android:list"
                         android:layout_width="fill_parent"
                         android:layout_height="wrap_content"
                         android:drawSelectorOnTop="true" />

        <TextView
                         android:id="@id/android:empty"
                         android:layout_width="fill_parent"
                         android:layout_height="wrap_content"
                         android:text="No data" /> 
```

`roosterwijzigingen.xml`：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal" >                      

        <TextView  
                         android:id="@+id/hour"
                         android:layout_width="wrap_content" 
                         android:layout_height="fill_parent" />

        <TextView  
                         android:id="@+id/info"
                         android:layout_width="match_parent" 
                         android:layout_height="fill_parent" />
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:38:54.243

在将其添加到列表之前，您必须将其放入`String`a`TextView`中，它看起来像这样：

```
String footerText = "Footer text";
TextView textView = new TextView(this);
textView.setText(footerText);

getListView().addFooterView(textView); 
```

请记住，99% 的情况下，当您想在屏幕上显示某些内容时，它必须是[View](https://developer.android.com/reference/android/view/View.html)。

# mvvm - Kendo UI Mobile MVVM - 如何处理导航到单个详细视图的两个列表视图？

> ID：14146749
> 
> 赞同：0
> 
> 时间：2013-01-03T20:31:29.620
> 
> 标签：mvvm, kendo-ui

我有两个`ListViews`（在不同的视图中）。这些视图绑定到单独的视图模型，但`ListViews`包含相同的实体类型。这两个视图都允许用户选择一个项目并导航到它的详细信息/编辑视图。

我需要做什么才能在两个列表视图之间共享这个详细视图？

这是我尝试过的：

**将所选项目分配给详细视图的视图模型中的属性**

这最初似乎有效，但实际上破坏了 Kendo MVVM。由于该项目位于列表视图的视图模型中，因此将其分配给另一个视图模型中的属性会导致问题。

**在每个视图的显示事件中刷新数据**

虽然这几乎可行，但它有几个问题。1) 一直获取新数据可能很慢。2) 在详细视图中保存更改并导航回列表视图时，保存是异步的，因此无法保证这些更改在调用 ListView 数据之前已经持久化。这也否定了 MVVM 和 observables 的好处之一。

**跨视图共享视图模型**

我见过的具有列表和详细视图的示例，两个视图共享一个具有`selectedItem`属性的视图模型。这在我的特定情况下是不可能的，因为我有两个导航到同一个详细视图的列表视图 - 更不用说我更喜欢为每个视图有一个单独的视图模型，这样视图模型就不会变得很大混乱。我应该让所有视图共享一个视图模型吗？

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-31T01:51:37.150

[也许您可以使用toJSON()](http://docs.kendoui.com/api/framework/observableobject#methods-toJSON)方法将 observable 模型提取为普通对象模型，然后通过再次包装它来创建一个新的 observable 模型。这应该清除现有绑定并避免您在第一种方法中发现的冲突。

```
var model = kendo.observable( otherModel.toJSON() ); 
```

# c++ - C++ - 需要传递一个二维数组，但必须动态调整大小

> ID：14146756
> 
> 赞同：0
> 
> 时间：2013-01-03T20:31:50.950
> 
> 标签：c++, arrays, dynamic

我正在使用一个 C++ 库，它要求我将它传递给一个二维数组。他们的代码示例给出了一个静态大小的数组，如下所示：

```
double data[][2] = {
  { 10, 20, },
  { 13, 16, },
  { 7, 30, },
  { 15, 34, },
  { 25, 4, },
}; 
```

但我需要传递运行时大小的数据。所以我试图这样做：

```
 // unsigned numBins  is passed in to this function and set at run time

  double** binData = new double*[numBins];
  for(unsigned i=0; i < numBins; ++i) {
    binData[i] = new double[2];
  }
  //Set the data with something like
  //   binData[7][0] = 10;
  //   binData[7][1] = 100;

  //Later, diligently delete my data... 
```

但是，这在我正在使用的库中失败了。它以绘制一些垃圾数字的图形结束。

我知道数组不是指针。图书馆可能会在某处做“sizeof”感到困惑。

如果我无法更改此库（它是第 3 方），我该如何传递动态大小的数据？

谢谢，麦迪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:50:09.513

可能 API 需要一个指向第一个元素的指针，它假定是二维数组的扁平表示。

所以简单的方法如下：

```
template<typename T>
struct FlatVectorAs2D {
private:
  size_t width;
  size_t height;
  std::vector<T> flat_vec;
public:
  std::vector<T>& base() { return flat_vec; }
  std::vector<T> const& base() const { return flat_vec; }
  size_t w() const { return width; }
  size_t h() const { return height; }
  T* operator[]( size_t index1 ) {
    return &flat_vec[index1*height];
  }
  T const* operator[]( size_t index1 ) const {
    return &flat_vec[index1*height];
  }
  FlatVectorAs2D( size_t w = 1, size_t h = 1 ):width(w), height(h) {
    flat_vec.resize(w*h);
  }
  void resize( size_t w, size_t h ) {
    width = w;
    height = h;
    flat_vec.resize(w*h);
  }
  T* raw() { return flat_vec.data(); }
  T const* raw() const { return flat_vec.data(); }
}; 
```

采用：

```
void api_function(double* d);
int main() {
  size_t width = 50;
  size_t height = 100;
  FlatVectorAs2D<double> buffer( width, height );
  buffer[0][1] = 1.0;
  api_function( buffer.raw() );
} 
```

自然这将取决于 API 的工作原理。

但如果我的猜测是正确的，这将有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:36:34.703

试试这个：

```
typedef double two_doubles[2];

int main()
{
    two_doubles * p = new two_doubles[300];

    // ...

    delete[] p;
} 
```

现在`p`指向包含 200 个单位的两个双精度数组的第一个子数组。也就是说，`p[i]`是一个`double[2]`，和`p[i][0]`，`p[i][1]`是它的成员元素。

（更好地使用`std::unique_ptr<two_doubles[]> p(new two_doubles[300]);`并忘记内存管理。）

# ios - Libxml2 拒绝解析 XML 实体

> ID：14146757
> 
> 赞同：1
> 
> 时间：2013-01-03T20:31:57.007
> 
> 标签：ios, svg, libxml2

iOS 上的 libxml 断然拒绝解析这个看似有效的 XML 文件（SVG 规范的一部分！）：

```
http://www.w3.org/TR/SVG11/images/coords/PreserveAspectRatio.svg 
```

它抱怨：

```
Error Domain=1 Code=27 "Entity 'Smile' not defined
UserInfo=0x7655730
{
   lineNumber=26,
   NSLocalizedDescription=Entity 'Smile' not defined,
   bonusInfo1=Smile,
   columnNumber=25
} 
```

...并为每个实体返回一个警告级别错误。似乎没有办法强迫它做文档暗示的事情（默认解析实体）。这里有一个神秘的伪解释（http://www.xmlsoft.org/entities.html），它说这非常困难，没有人应该自己做......但 libxml 似乎也没有做到:( .

这是设置结构，以确认我没有为实体解析提供任何覆盖：

```
static xmlSAXHandler SAXHandler = {
    NULL,                       /* internalSubset */
    NULL,                       /* isStandalone   */
    NULL,                       /* hasInternalSubset */
    NULL,                       /* hasExternalSubset */
    NULL,                       /* resolveEntity */
    NULL,                       /* getEntity */
    NULL,                       /* entityDecl */
    NULL,                       /* notationDecl */
    NULL,                       /* attributeDecl */
    NULL,                       /* elementDecl */
    NULL,                       /* unparsedEntityDecl */
    NULL,                       /* setDocumentLocator */
    NULL,                       /* startDocument */
    NULL,                       /* endDocument */
    NULL,                       /* startElement*/
    NULL,                       /* endElement */
    NULL,                       /* reference */
    charactersFoundSAX,         /* characters */
    NULL,                       /* ignorableWhitespace */
    NULL,                       /* processingInstruction */
    NULL,                       /* comment */
    NULL,                       /* warning */
    errorEncounteredSAX,        /* error */
    NULL,                       /* fatalError //: unused error() get all the errors */
    NULL,                       /* getParameterEntity */
    cDataFoundSAX,              /* cdataBlock */
    NULL,                       /* externalSubset */
    XML_SAX2_MAGIC,
    NULL,
    startElementSAX,            /* startElementNs */
    endElementSAX,              /* endElementNs */
    structuredError,                       /* serror */
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T21:05:48.173

这是 libxml 中的一个巨大错误，它已经存在了 - 似乎 - 有一段时间了。

文档（http://www.xmlsoft.org/html/libxml-parser.html#xmlCreatePushParserCtxt）这样说：

```
xmlParserCtxtPtr    xmlCreatePushParserCtxt (xmlSAXHandlerPtr sax, 
                         void * user_data, 
                         const char * chunk, 
                         int size, 
                         const char * filename)
sax:    a SAX handler
user_data:  The user data returned on SAX callbacks 
```

但他们应该说的是：

```
sax:    a SAX handler
user_data:  YOU MUST NOT USE THIS BECAUSE LIBXML IS BADLY
 BROKEN INTERNALLY. NEVER PASS ANYTHING EXCEPT NULL TO
 THIS PARAMETER. ENTITIES WILL NEVER WORK IF YOU PASS
 ANYTHING EXCEPT NULL. 
```

即，您不能使用“userdata”指针，而必须编写自己的静态变量（某处）并使用它们来跟踪状态，因为 libxml 不允许您跟踪状态本身。

（我最终在一个邮件列表上找到了一个参考，有人问为什么这会被破坏并要求更新文档并发出警告）

顺便说一句，我认为这解释了我在其他使用 libxml 的 iOS 项目中看到的一些与实体相关的问题。许多天浪费在这个单一的错误/糟糕的文档上:(。叹息。

# jsf - Glassfish 登录后 PrimeFaces 重定向

> ID：14146758
> 
> 赞同：3
> 
> 时间：2013-01-03T20:32:00.673
> 
> 标签：jsf, primefaces, glassfish

我正在尝试将 PrimeFaces 添加到我的项目中。它使用`Glassfish 3`基于表单的身份验证运行。我下载了jar并放入`WEB-INF/lib`. 登录后，我看到了一个带有 URL 的 css 文件：

`localhost:8080/[webapp]/javax.faces.resource/theme.css.jsf?ln=primefaces-aristo`

如果我禁用安全检查，则不会发生这种情况。这是我的 web.xml 中的登录部分。

```
<login-config>
    <auth-method>FORM</auth-method>
    <form-login-config>
      <form-login-page>/login.jsf</form-login-page>
      <form-error-page>/login.jsf?failed=true</form-error-page>
    </form-login-config>
</login-config> 
```

谁能告诉我有什么问题？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T10:47:53.657

这是由浏览器缓存的受限页面引起的。

容器管理的安全性将重定向到触发身份验证检查的最后一个 HTTP 请求。在您的情况下，它显然是自动包含的 PrimeFaces 主题 CSS 文件。如果浏览器从浏览器缓存中完全加载了待认证页面，而浏览器从服务器端完全加载了 CSS 文件，或者通过条件 GET 请求测试了 CSS 文件的缓存有效性，则可能会发生这种情况. 然后，容器管理的安全性将准确地记住这个 URL 作为重定向成功后登录 URL。

您想从身份验证检查中排除 JSF 资源 (`<h:outputScript>`和`<h:outputStylesheet>`。`<h:graphicImage>`您可以通过排除常见的 URL 模式来做到这一点`/javax.faces.resource/*`。

```
<security-constraint>
    <web-resource-collection>
        <web-resource-name>Allowed resources</web-resource-name>
        <url-pattern>/javax.faces.resource/*</url-pattern>
    </web-resource-collection>
    <!-- No Auth Contraint! -->
</security-constraint> 
```

您**还**需要指示浏览器*不要*缓存受限页面，以防止浏览器从缓存中加载它（例如，在注销后按返回按钮）。将以下过滤器映射到与您的`<security-constraint>`.

```
@WebFilter("/secured/*") // Use the same URL pattern as <security-constraint>
public class NoCacheFilter implements Filter {

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        HttpServletRequest req = (HttpServletRequest) request;
        HttpServletResponse res = (HttpServletResponse) response;

        if (!req.getRequestURI().startsWith(req.getContextPath() + ResourceHandler.RESOURCE_IDENTIFIER)) { // Skip JSF resources (CSS/JS/Images/etc)
            res.setHeader("Cache-Control", "no-cache, no-store, must-revalidate"); // HTTP 1.1.
            res.setHeader("Pragma", "no-cache"); // HTTP 1.0.
            res.setDateHeader("Expires", 0); // Proxies.
        }

        chain.doFilter(request, response);
    }

    // ...
} 
```

请注意，这也解决了“后退按钮”问题。因此，在注销/注销后按下后退按钮时，最终用户也不会再看到受限页面，这在您当前的设置中会发生。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T08:18:03.533

您应该从验证中排除 Web 资源。例如`<url-pattern>*.css</url-pattern>`在您的`<security-constraint>`元素中添加。对所有不需要安全检查的 Web 资源（js、图像等）执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T08:10:17.167

似乎您的安全约束中有错误的 url 模式。

查看此示例以获取工作版本。

[http://blog.eisele.net/2011/01/jdbc-security-realm-and-form-b​​ased.html](http://blog.eisele.net/2011/01/jdbc-security-realm-and-form-based.html)

# jquery-plugins - Html5画布问题，图像尺寸错误

> ID：14146763
> 
> 赞同：2
> 
> 时间：2013-01-03T20:32:22.203
> 
> 标签：jquery-plugins, html5-canvas

我正在尝试创建一个 10x10 图像的网格。这些是从 javascript（对象）加载的，并使用 onload 方法将其添加到画布。添加作品，但画布图像似乎已调整大小。顺便说一下，currentSizes.cellSize 的结果是 80。然而，似乎添加的图像大于定义的 80，即使 drawImage 参数宽度和高度获取值 80..

我的目标是将画布游戏构建为 jQuery 插件。我想显示一个带有岛屿的 javascript 动态创建的网格（就像网络浏览器征服类型的游戏一样）。所以我想创建一个 100% 宽度（和高度）的画布，其中 javascript 动态测量每个单元格（10x10）必须有多大。

所以我有以下内容：

```
 for( var i = 0 ; i < totalTiles ; i++ ) {

                // go to first column in next row
                if( x >= 10 ) {
                    x   = x - 10;
                    y   = y + 1;
                }

                // build the world
                tiles[i]    = new Image();
                tiles[i].x  = x;
                tiles[i].y  = y;
                tiles[i].towidth    = currentSizes.cellSize;
                tiles[i].toheight   = currentSizes.cellSize;
                tiles[i].coordx = ( x * currentSizes.cellSize );
                tiles[i].coordy = ( y * currentSizes.cellSize );
                //tiles[i].onload   = function() { canvas2d.drawImage( tiles[i] , 0 , 0 ); }
                //tiles[i].onLoad   = dibaMethods.drawTile( tiles[i] , ( x * currentSizes.cellSize ) , ( y * currentSizes.cellSize ) , canvas2d );
                tiles[i].src    = "/images/world/tiles/card5.png";

                lastIndex   = i;

                console.log( "looping at: " + i + " with x/y: " + x + "/" + y + " and coordinates: " + tiles[i].coordx + "/" + tiles[i].coordy );

                x++;
            }
            console.log( "Canvas tiles entered, loaded on DOM load, tiles added: " + tiles.length );
            tiles[lastIndex].onload     = function() {
                for( var i = 0; i < totalTiles ; i++ ) {
                    canvas2d.drawImage( tiles[i] , tiles[i].coordx , tiles[i].coordy );
                    //canvas2d.drawImage( tiles[i] , tiles[i].coordx , tiles[i].coordy , tiles[i].towidth , tiles[i].toheight );
                }
            } 
```

画布的 HTML：

```
<canvas id="world">
</canvas> 
```

样式表：

```
 body { margin: 0; }
    canvas#world { clear: both; background: url("/images/world/clouds.jpg") no-repeat; width: 800px; height: 800px; } 
```

你可以看到我在网址上走了多远：[https ://battles.hyn.me/world](https://battles.hyn.me/world)

非常感谢任何建议！如果问题需要详细说明，请发表评论！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-04T09:46:29.817

问题源于没有宽度或高度属性的画布元素。

在编辑 html 以包含这些属性并删除样式表条目后，它终于起作用了。

**所以底线，总是给画布元素添加一个宽度和高度属性。**

# php - 漂亮和 SEO 友好的 url zend 框架 php

> ID：14146767
> 
> 赞同：0
> 
> 时间：2013-01-03T20:32:34.300
> 
> 标签：php, zend-framework, mod-rewrite

使用 Zend Framework 生成漂亮 URL 的最佳方法是什么？

如果没有 Zend Framework 和 MVC 模式，我将只使用 .htaccess：

```
RewriteEngine on
RewriteBase /
RewriteCond  %{REQUEST_FILENAME} !-f
RewriteCond  %{REQUEST_FILENAME} !-d
RewriteRule  ^(.*)$ index.php?request=$1 [QSA,L] 
```

然后在 PHP 中解析请求参数。

我现在正在使用 Zend 框架并在我的引导程序中尝试使用 zend_route，就像[这里](https://stackoverflow.com/questions/9797619/zend-framework-how-to-rewrite-url-to-seo-friendly-url)建议的那样，并记录在[Zend 网站上](http://framework.zend.com/manual/1.12/en/zend.controller.router.html)。

我的任务是将请求转换 `example.com/pets-new-york`为`example.com/index/search/?q=pets%20new%20york`（当前）

我不能让它工作，我如何管理不存在的文件 (-f) 和目录 (-d)，就像它在第一个 .htaccess 示例中一样工作？更一般地说，使用 Zend Framework 和不存在的目录创建漂亮 URL 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-10T14:23:02.123

请试试这个。以下代码将创建 SEO Friendly url

注意：您必须确保在您的服务器上启用重写 apache 模块

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

或者

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L]
</IfModule> 
```

如果您需要任何帮助，请告诉我。

# scala - scalaz源代码中的@>类型在哪里？

> ID：14146776
> 
> 赞同：3
> 
> 时间：2013-01-03T20:32:58.200
> 
> 标签：scala, scalaz, scalaz7

我一直在阅读 scalaz 镜头的源代码，您可以在[https://github.com/scalaz/scalaz/blob/scalaz-seven/core/src/main/scala/scalaz/Lens.scala找到](https://github.com/scalaz/scalaz/blob/scalaz-seven/core/src/main/scala/scalaz/Lens.scala)

从**第 303 行**开始，有些函数返回**@>[A,B]**类型的值。这种类型是**Lens**的别名吗？从上下文和符号的形状来看，这对我来说是有意义的，这可能代表一束光线进入圆形透镜。

但是为什么其他函数返回**Lens[A,B]**而不是时髦的别名呢？我在文件和 Lens.scala 导入的文件中搜索了这个符号，但无济于事。

我在哪里可以找到**@>**的定义？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T21:39:45.967

是的，它是一个类型别名，并且大多数这些方便的类型别名——包括`@>`，但也包括类似的东西`Reader`，，`State`甚至`Lens`它本身，它是一个类型别名——[存在](https://github.com/scalaz/scalaz/blob/scalaz-seven/core/src/main/scala/scalaz/package.scala#L202)`LensFamily[...]`于[包对象](https://github.com/scalaz/scalaz/blob/scalaz-seven/core/src/main/scala/scalaz/package.scala#L202)中。[`scalaz`](https://github.com/scalaz/scalaz/blob/scalaz-seven/core/src/main/scala/scalaz/package.scala#L202)`core/src/main/scala/scalaz/package.scala`

`A @> B`在某些地方和其他地方使用的事实`Lens[A, B]`几乎可以肯定只是历史偶然和特定作者偏好的结果。

# javascript - 代码下的Javascript弹出窗口？

> ID：14146778
> 
> 赞同：0
> 
> 时间：2013-01-03T20:33:11.327
> 
> 标签：javascript, popup

> **可能重复：**
> [在 chrome 下弹出一个窗口](https://stackoverflow.com/questions/4261784/making-a-window-pop-under-in-chrome)

我想弹出但在后台运行（弹出下）。打开弹出窗口后，焦点将变为父窗口。

我在 kat.ph 上看到它，但无法获取代码。

```
object.blur();
window.focus(); 
```

这些天不再工作了:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:36:04.940

在弹出窗口的 onload 中说：

```
window.blur();
window.opener.focus(); 
```

# sql-server - 从一行查询多行

> ID：14146779
> 
> 赞同：2
> 
> 时间：2013-01-03T20:33:11.633
> 
> 标签：sql-server, tsql, sql-server-2012

我正在尝试从我的数据库创建一个查询，该查询将根据计数列将每行扩展到多行。我需要的是拿我的桌子：

```
[DATE]     [COUNT]     [OTHER_COLUMN]
20120101   3           X
20120201   2           Y 
```

并创建这个：

```
[DATE]     [OTHER_COLUMN]
20120101   X
20120101   X
20120101   X
20120201   Y
20120201   Y 
```

我找到了很多相反的方法（将多行合并为一个），或者将具有多列的一行扩展为多行（基于每列），但我似乎找不到创建相同的方法行。我正在使用 SQL Server 2012。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T20:40:14.833

您可以使用递归 CTE：

```
;WITH CTE AS
(
    SELECT *, 1 RN
    FROM YourTable
    UNION ALL
    SELECT [DATE], [COUNT], [OTHER_COLUMN], RN+1
    FROM CTE
    WHERE RN+1 <= [COUNT]
)
SELECT [DATE], [OTHER_COLUMN]
FROM CTE
OPTION(MAXRECURSION 0) 
```

这[是一个 sql fiddle](http://sqlfiddle.com/#!6/6c2bc/1)供您尝试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T20:37:26.773

为此，您需要一个像这样的计数表：[http ://www.sqlmag.com/article/sql-server/virtual-auxiliary-table-of-numbers](http://www.sqlmag.com/article/sql-server/virtual-auxiliary-table-of-numbers)

然后你可以写：

```
SELECT [Date], Other_Column
FROM dbo.MyTable
CROSS APPLY dbo.GetNums([COUNT]); 
```

这是一个 SQL-Fiddle，用于显示实际的解决方案：[http ://sqlfiddle.com/#!6/2edda/2](http://sqlfiddle.com/#!6/2edda/2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T21:27:05.867

另一种方法。请注意，您应该有 [count] <=2048。否则，根据需要构建另一个数字表。

```
WITH num AS (
    SELECT number
    FROM master..spt_values WHERE type = 'P' 
)
SELECT 
    [DATE],[OTHER_COLUMN]
FROM your_table t
INNER JOIN num n
    ON n.number < t.COUNT 
```

# java - 如何读取 Java 类文件（Java 字节码）

> ID：14146782
> 
> 赞同：27
> 
> 时间：2013-01-03T20:33:23.520
> 
> 标签：java

如何查看 .class 文件（java 字节码）的内容？

如何在 Linux 中打开这些类型的文件？我正在使用 Centos 5.8。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-01-03T20:36:31.680

`javap -c X`将显示`X.class`.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-03T21:15:34.470

## 读取字节码

```
javap -v com.company.package.MainClass 
```

要理解字节码你可以使用[这个](http://en.wikipedia.org/wiki/Java_bytecode_instruction_listings)助记符列表

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-03T20:37:48.183

你可以[反编译](https://stackoverflow.com/questions/272535/how-do-i-decompile-java-class-files)。

要查看 Java 源代码，请检查一些反编译器。去搜索`jad`。

如果您想查看字节码，只需使用`javap`JDK 自带的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-03T20:35:53.717

使用 javap。它是标准 jdk 的一部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-03T20:34:48.163

少文件名.class

不确定它将如何帮助您，除非您可以读取字节码...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-03T20:36:02.740

任何二进制文件编辑器都可以 - [gHex](https://live.gnome.org/Ghex)或[xxd](http://linux.about.com/library/cmd/blcmdl1_xxd.htm)是两个建议。

请注意，除非您能理解 .class 文件提供给您的字节码，否则这不会真正帮助您...

# css - 在 DIV 中居中无序列表

> ID：14146783
> 
> 赞同：16
> 
> 时间：2013-01-03T20:33:23.197
> 
> 标签：css, html, html-lists, centering

首先，我知道这个问题已经被问过一百万次了……我已经专门研究了[这个](https://stackoverflow.com/questions/8734503/how-can-i-center-an-unordered-list-with-dynamic-content-within-div)问题以及这个站点和其他站点上的其他几个问题。我已经尝试了很多不同的变化，但仍然无法让它发挥作用。

我正在尝试将无序列表居中。它显示正确，只是没有居中。目前，它离中心很近……但是如果您更改 CSS 中 .nav-container 代码中的“宽度”参数，那么它会移动 div 的位置。

这是我的CSS：

```
 html *{
  font-family: Verdana, Geneva, sans-serif;
}
body {
  padding:0px;
  margin:0px;
}
.nav-container {
  width:460px;  
  margin: 0 auto;
}
.nav-container ul {
  padding: 0px;
  list-style:none;
  float:left;
}
.nav-container ul li {
  display: inline;
}
.nav-container ul a {
  text-decoration:none;
  padding:5px 0;
  width:150px;
  color: #ffffff;
  background: #317b31;
  float:left;
  border-left: 1px solid #fff;
  text-align:center;
}
.nav-container ul a:hover {
  background: #92e792;
  color: black;
}
#add-form .add-button, #tutor-list .tutor-button, #admin .admin-button {
  color: #ffffff;
  background: #12b812;
} 
```

这是我的 HTML：

```
<body id="admin">

<div id="header">
<center><h2>OMS Tutoring Database</h2></center>
</div>
<div class="nav-container">
<ul>
  <a class="tutor-button" href="tutoring.php"><li>Tutoring List</li></a>
  <a class="add-button" href="addform.php"><li>Add Students</li></a>
  <a class="admin-button" href="admin.php"><li>Admin</li></a>
</ul>
</div>

<div id="content"></div>

</body> 
```

我敢肯定这是一个非常简单的错误，但任何帮助将不胜感激。哦，我目前正在 Chrome 中查看它，因为我正在测试它。

[jsFiddle](http://jsfiddle.net/MmNZ8/)

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-01-03T20:45:33.793

您的 HTML 不正确。`<a>`标签应该在标签内`<li>`。要使列表项内联，请`float: left`在它们上设置，并`overflow: hidden`使其`<ul>`适合其子项。删除`float`on `.nav-container`，这是不必要的。看看这个[codepen](http://codepen.io/joe/pen/thEaD)。
当你改变它的宽度时，导航会移动，因为它使包装器居中，而不是导航本身。您可以删除`width`并`margin: 0 auto`尝试：

```
.nav-container {
    text-align: center;
}
.nav-container ul {
    display: inline-block;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T21:21:42.510

问题是您为 150px 的 li 分配了固定宽度。相反，您应该将宽度分配给 33%，并将 ul 的宽度分配给 100%，这样，无论 div 的大小是多少，三里将完美居中:)

[这是更新的 JSFIDDLE](http://jsfiddle.net/MmNZ8/8/)

```
.nav-container ul {
  padding: 0px;
  list-style:none;
  float:left;
  width: 100%
}
.nav-container ul li {
  display: inline;
}
.nav-container ul a {
  text-decoration:none;
  padding:5px 0;
  width:33%;
  color: #ffffff;
  background: #317b31;
  float:left;
  border-left: 1px solid #fff;
  text-align:center;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-29T05:39:57.173

以下解决方案有点精致：

```
 html * {
       font-family: Verdana, Geneva, sans-serif;
   }
   body {
       padding:0px;
       margin:0px;
   }
   .nav-container {
       width:460px;
       margin: 0 auto;
   }
   .nav-container ul {
       padding: 0px;
       list-style:none;
       float:left;
   }
   .nav-container ul li {
       display: inline;
   }
   .nav-container ul a {
       text-decoration:none;
       padding:5px 0;
       width:150px;
       color: #ffffff;
       background: #317b31;
       float:left;
       border-left: 1px solid #fff;
       text-align:center;
   }
   .nav-container ul a:hover {
       background: #92e792;
       color: black;
   }
   #add-form .add-button, #tutor-list .tutor-button, #admin .admin-button {
       color: #ffffff;
       background: #12b812;
   }

<div id="header">
    <center>
         <h2>OMS Tutoring Database</h2>
    </center>
</div>
<div class="nav-container">
    <ul>
         <li><a class="tutor-button" href="tutoring.php">Tutoring List</a></li>
         <li><a class="add-button" href="addform.php">Add Students</a>
         <li><a class="admin-button" href="admin.php">Admin</a></li>
    </ul>
</div> 
```

试试看：http: [//jsfiddle.net/hg9qvL70/2/](http://jsfiddle.net/hg9qvL70/2/)

# java - 保存 XSSFWorkbook 时仅更新一行

> ID：14146784
> 
> 赞同：0
> 
> 时间：2013-01-03T20:33:24.107
> 
> 标签：java, excel, apache-poi

我正在开发一个程序，该程序从 Excel 电子表格中读取每一行和单元格，然后从特定行的每个单元格中获取数据，并使用该数据进行 Web 服务调用。一旦我得到 Web 服务 XML 响应的返回，我就会将它解析为一个成功的布尔值，并在发生故障时解析一条消息。

我能够解析数据并且我正在获取每一行响应，但是当尝试编辑该行最后两个单元格时，它只更新第一行成功和结果消息单元格。

以下是我的一些代码片段：

```
private static XSSFRow[] retrieveRows(XSSFWorkbook wb)
{
    XSSFSheet xslSheet = wb.getSheetAt(0);
    XSSFRow[] sheetRows = new XSSFRow[xslSheet.getLastRowNum()];

    for (int i = 1; i < xslSheet.getLastRowNum()+1; i++)
    {
        sheetRows[i-1] = xslSheet.getRow(i);
    }

    return sheetRows;
}

public static String[] processRow(XSSFRow xslRow)
{
    String[] cellValues = new String[totalCells];

    for (int i = 0; i < totalCells; i++)
    {
        XSSFCell currentCell = xslRow.getCell(i);
        String cellVal;
        try
        {
            cellVal = currentCell.getStringCellValue();
        }
        catch (Exception e)
        {
            cellVal = "";
        }
        cellValues[i] = cellVal;
        System.out.println("Cell "+i+": "+cellVal);
    }

    return cellValues;
} 
```

以及所有魔法发生的最后部分......或类似的东西。

```
try
    {
        XSSFRow[] xslRows = retrieveRows(theWorkbook);
        ArrayList<String[]> rowCellVals = new ArrayList<String[]>();

        String sessionKey[] = WQSServices.sessionToken();

        for (int r = 0; r < xslRows.length; r++)
        {               
            System.out.println("R Value: "+r);
            rowCellVals.add(processRow(xslRows[r]));

            if(sessionKey[0].equals("true"))
            {
                String sessionData = sessionKey[1];
                String[] cellValCurrRow = rowCellVals.get(r);
                String attachmentData[] = WQSServices.uploadAttachment(sessionData, cellValCurrRow);

                XSSFCell cell = xslRows[r].getCell(7);

                if(cell == null)
                {
                    cell = xslRows[r].createCell(7);
                }

                XSSFCell cell2 = xslRows[r].getCell(8);

                if(cell2 == null)
                {
                    cell2 = xslRows[r].createCell(8);
                }

                cell.setCellType(Cell.CELL_TYPE_STRING);
                cell2.setCellType(Cell.CELL_TYPE_STRING);
                cell.setCellValue(attachmentData[0]);
                cell2.setCellValue(attachmentData[1]);

                System.out.println("New Cell Data: 1-"+cell.getStringCellValue()+" 2-"+cell2.getStringCellValue());

                FileOutputStream fos = new FileOutputStream(xslFile);
                theWorkbook.write(fos);
                fos.close();
            }
            else
            {                   

                XSSFCell cell = xslRows[r].getCell(7);

                if(cell == null)
                {
                    cell = xslRows[r].createCell(7);
                }

                System.out.println("The Cell: "+cell.getStringCellValue());

                cell.setCellType(Cell.CELL_TYPE_STRING);
                cell.setCellValue(sessionKey[0]);

                FileOutputStream fis = new FileOutputStream(xslFile);
                theWorkbook.write(fis);
                fis.close();

            }

            readFile();
        }

    }
    catch (IOException e)
    {
        e.printStackTrace();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T15:49:18.860

根据[Gagravarr](https://stackoverflow.com/users/685641/gagravarr/ "加格拉瓦")的观察，我的问题是基于我的文件输出流在 for 循环中。一旦我将它移出 for 循环，所有内容都按预期写入工作簿。

# sql-server - 如何查看带有参数的命令，由 Visual Studio 中的 ExecuteReader 执行

> ID：14146786
> 
> 赞同：4
> 
> 时间：2013-01-03T20:33:30.103
> 
> 标签：sql-server, vb.net, visual-studio-2010

我正在向我的 SqlCommand 添加参数。这是一个简单的示例（仅使用与我的问题有关的属性）：

```
Dim cmd As New System.Data.SqlClient.SqlCommand

cmd.CommandText = "af_get_data"
cmd.CommandType = System.Data.CommandType.StoredProcedure
cmd.Parameters.Add("@p1", "param1")
cmd.Parameters.Add("@p2", "param2") 
```

我想要做的就是能够在调试模式下的断点处看到命令以及发送到数据库的参数。例子：

```
exec af_get_data @p1='param1', @p2='param2' 
```

我尝试在调试模式下将鼠标悬停在**cmd**上，但参数属性没有列出参数，当我展开参数并查找我看到的项目时：

“Item = 为了评估索引属性，该属性必须是合格的，并且参数必须由用户显式提供。”

我不希望代码这样做，我知道应该有一种方法可以在其中一个调试窗口中以某种方式查看它。

帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:44:01.973

如果您想准确查看发送到 SQL Server 的内容，最好的办法是实际使用[SQL Server Profiler](http://msdn.microsoft.com/en-us/library/ms181091.aspx)。

但是，如果您想留在 Visual Studio 中，您可以右键单击`cmd`并选择`Quick Watch...`以深入了解对象的详细信息。但是，您可能找不到您正在寻找的确切内容，这就是我建议使用 SQL Server Profiler 的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-23T19:53:32.663

我意识到这是一个七年前的问题，但也许有人会发现我一直在使用的东西很有价值。

我有一个我写的通用查询助手类，它集中了很多废话。它看起来像这样。如果它的功能如下所示：

```
{
    using (SqlConnection connection = new SqlConnection(connectionString))
    {
        connection.Open();
        using (SqlCommand command = new SqlCommand(sql, connection))
        {
            AddParameters(command, parameters);
#if DEBUG
            string debug = CreateDebugSQL(sql, parameters);
#endif
            using (SqlDataReader results = command.ExecuteReader())
            {
                return method(results);
            }
        }
    }
} 
```

因为我不想打开探查器只是为了让字符串检查所有内容是否正确传递给它，所以我放置了一个函数来创建一个调试字符串。这是一个杂物，它用于调试，所以它不漂亮并且需要一些修整，但是：

```
static private string CreateDebugSQL(string sql, List<SqlParameter> parameters)
{
    string debugSQLString = sql.Substring(0, sql.IndexOf('@'));
    foreach (SqlParameter parameter in parameters)
    {
        string val = string.IsNullOrWhiteSpace(parameter.Value.ToString()) ? "" : parameter.Value.ToString();
        debugSQLString = debugSQLString + parameter.ParameterName + " = '" + val + "', ";
    }
    return debugSQLString; //just so we can breakpoint here to read it
} 
```

您肯定会希望使其适应您正在做的任何事情，但它在重建 SQL 字符串时相当可靠。

# python - 无法让 python 请求与代理一起工作

> ID：14146787
> 
> 赞同：1
> 
> 时间：2013-01-03T20:33:33.057
> 
> 标签：python, python-requests

我正在尝试通过代理服务器做一个简单的获取请求：

```
import requests
test=requests.get("http://google.com", proxies={"http": "112.5.254.30:80"})
print test.text 
```

代码中代理服务器的地址来自互联网上一些免费提供的代理列表。关键是当我从浏览器中使用它时，这个代理服务器可以工作，但在这个程序中它不起作用。我尝试了许多不同的代理服务器，但没有一个可以通过上面的代码工作。

这是我为这个代理服务器得到的：

> ## 所请求的网址无法检索
> 
> 尝试检索 URL 时：http:///
> 
> 遇到以下错误：
> 
> > 无法根据主机名确定 IP 地址
> 
> *dns 服务器返回：*
> 
> > *无效的主机名*
> 
> *这意味着： 缓存无法解析 URL 中显示的主机名。检查地址是否正确。*

 ** * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-04-28T13:01:51.270

我知道这是一个老问题，但应该是

```
import requests
test=requests.get("http://google.com", proxies={"http":"http://112.5.254.30:80","https": "http://112.5.254.30:80"})

print (test.text) 
```*

# methods - Python3 中内置方法和用户定义方法的区别

> ID：14146789
> 
> 赞同：0
> 
> 时间：2013-01-03T20:33:44.110
> 
> 标签：methods, python-3.x, member

我注意到内置类和用户定义类的成员函数具有不同的类型。这是否意味着两者在某些情况下可能表现不同？

```
class A:
  def a():
    pass

>>> type(A.a), type(list.append)
(<class 'function'>, <class 'method_descriptor'>) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:57:51.297

如果这就是您的意思，它们都正常执行其功能。它们都是可调用的。否则它们之间几乎没有区别。

一个区别是您可以在`function`对象上设置任意属性，但不能在 C 函数（例如`list.append)`.

另一个是 Python 函数有一个与之关联的代码对象，其中包含已编译的字节码和有关局部变量等的信息。C 函数自然缺少这些信息。

# php - 使用 JPEG 为 GD 编译 PHP 5.4.10

> ID：14146797
> 
> 赞同：0
> 
> 时间：2013-01-03T20:34:11.650
> 
> 标签：php, ubuntu, makefile

我正在努力做这几个小时。PHP 不会针对 libjpeg 进行编译。

这就是 .configure 所说的：

```
checking for the location of libvpx... no
checking for the location of libjpeg... /usr
checking for the location of libpng... yes
checking for the location of libXpm... no 
```

所以不，是，不是，不是。

jpeglib.h 位于 /usr/include/jpeglib.h libjpeg.so 位于 /usr/lib/libjpeg.so

我通读了 .configure 脚本，但找不到快速解决方案。我正在运行 Ubuntu 8.04

对此有任何提示吗？

编辑：freetype 库似乎也发生了同样的情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T08:42:01.567

添加`--with-gd` `--with-jpeg-dir=/usr/lib/` `--with-png-dir=/usr/lib/`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-31T13:58:57.033

在 CentOS 5 系统上（两者`jpeglib.h`和分别`libjpeg.so`位于`/usr/include/jpeglib.h`和中），我在运行脚本`/usr/lib/libjpeg.so`时必须包含以下选项：`configure`

`--with-gd --with-jpeg-dir=/usr --with-freetype-dir=/usr`

这为 JPEG 和 Freetype 提供了 GD 支持（我不需要为 GD 做任何特别的事情来支持 PNG 或 GIF）。

注意：如果您在注意到 GD 不包含对这些库的支持之前已经编译了 PHP，则必须`make clean`在重新运行`configure`脚本后运行。

# iphone - NSMutableArray 访问数据

> ID：14146799
> 
> 赞同：-3
> 
> 时间：2013-01-03T20:34:15.340
> 
> 标签：iphone, sdk, nsmutablearray

是否可以在数组中获取随机按钮的标签？

```
- (IBAction)actionButtonPressed:(id)sender
{
    NSUInteger randomIndex = arc4random()% [_allButtons count];
    NSLog(@"%d", randomIndex);
    NSLog(@"tag: %@",[_allButtons objectAtIndex:randomIndex]);
} 
```

从日志中我得到这个：

```
UIRoundedRectButton:.... frame = (110 98; 50 44); opaque = NO; **tag = 5**; layer = CALayer..... 
```

是否可以从随机按钮中获取标签？

编辑：抱歉 _allButtons 是一个 NSMutableArray

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:35:34.940

-

```
(IBAction) actionButtonPressed:(id)sender {

    NSUInteger randomIndex = arc4random()% [_allButtons count];

    NSLog(@"%d", randomIndex);

    NSLog(@"tag: %d", [[_allButtons objectAtIndex:randomIndex] tag]);

} 
```

# javascript - JS，选择一个div的孩子

> ID：14146802
> 
> 赞同：-2
> 
> 时间：2013-01-03T20:34:23.630
> 
> 标签：javascript

如果我有

```
function OnMouseIn (elem) {
            elem.style.display= "block";
        }

<div onmouseover="OnMouseIn (this.XXXXXXX)">
    <div class="classname" style="display:none"></div>
</div> 
```

我必须写什么来代替 XXXXXXX 来选择 div 的子“类名”？（注意：第一个 div 有很多，我只需要选择鼠标刚刚经过的那个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:45:52.697

您不需要 javascript 来执行此操作，只需使用 CSS：

```
<style type="text/css">
    .classname {
       display: none;
    }

    #parent:hover > div.classname {
       display: block;
    }
</style>

<div id="parent">
    <div class="classname"></div>
</div> 
```

但在javascript中它将是：

```
function OnMouseIn (elem) {
    elem.getElementsByTagName("DIV")[0].style.display = "block";
}
function OnMouseOut (elem) {
    elem.getElementsByTagName("DIV")[0].style.display = "none";
}

<div onmouseover="OnMouseIn (this);" onmouseout="OnMouseOut (this);">
    <div class="classname" style="display:none"></div>
</div> 
```

# mysql - MySQL 性能调优 - 独特的约束

> ID：14146810
> 
> 赞同：2
> 
> 时间：2013-01-03T20:34:47.373
> 
> 标签：mysql

我在 MySQL 5.5 中有一个数据库。我最终希望那里有数千万条记录。

如果我在两列上添加唯一约束，我知道插入会有一些性能损失；问题是，多少钱？我能做些什么来最小化它？

*如果我在单个*列上有唯一约束，惩罚会有所不同吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T20:37:13.383

第一个惩罚是空间。将在您的数据库中为它们创建索引表，并且有 1000 万行，这不是微不足道的，但对您来说可能不是一个大问题。然而，正如@zerkms 指出的那样，这些索引应该缓存在内存缓冲区中，以便它们快速运行，因此您可能会遇到问题。

与单个唯一索引相比，两个唯一索引不应显着减慢您的插入速度。唯一约束检查​​对于 Mysql 来说非常便宜。通过添加索引，您不会看到指数级的减速（除非您遇到一些内存问题），但是对于您添加的每个新索引，更多的是额外的线性时间增加。

# audio - 捕获音频以在网页中使用

> ID：14146812
> 
> 赞同：0
> 
> 时间：2013-01-03T20:34:49.153
> 
> 标签：audio, scripting, web, out

我想知道是否有可能使用 JavaScript、php 或任何其他方法来捕获一般的“音频输出”或线路输出，并将其发送到网页中使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T21:23:24.620

这是不可能的。对于自定义（非 Web）代码，这通常需要编写特殊的自定义驱动程序（取决于操作系统）。

# python - 用于 Python wsgi 应用程序的 HA 部署

> ID：14146814
> 
> 赞同：2
> 
> 时间：2013-01-03T20:34:59.980
> 
> 标签：python, nginx, wsgi, haproxy

我考虑部署高可用 Python Web 应用程序的场景：

1.  负载均衡器 -* wsgi 服务器
2.  负载均衡器 -* 生产 HTTP 服务器 - wsgi 服务器
3.  生产 HTTP 服务器（具有负载平衡功能，如 Nginx）-* wsgi 服务器

对于负载均衡器，我考虑**HAProxy**
对于生产 HTTP 服务器，我考虑**Nginx**
对于*wsgi 服务器*，我的意思是直接处理 wsgi 应用程序（gevent、waitress、uwsgi...）的服务器
-* 表示一对多连接
- 表示一对一连接

没有可提供的静态内容。所以我想知道是否需要生产 HTTP 服务器。

1.  每种解决方案的优缺点是什么？
2.  对于每个场景（1-3），代替*wsgi 服务器*使用 wsgi 容器服务器（uWSGI、gunicorn）而不是原始 wsgi 服务器（gevent、tornado ..）有什么优势吗？
3.  我还想知道哪种解决方案最适合 websockets 或长轮询请求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T23:06:57.850

**编辑：**在撰写本文时，这个答案反映了[uWSGI](http://uwsgi-docs.readthedocs.org/en/latest/WebSockets.html)和[nginx](https://www.nginx.com/blog/websocket-nginx/)中 WebSocket 支持的状态（他们没有），但从那时起，他们已经越来越支持它。出于历史的兴趣，我将保留完整的答案。

1：你几乎肯定想要一个像 nginx 这样的 HTTP 反向代理来处理“勺子喂”缓慢或愚蠢的客户端程序；您的一些用户的连接速度会很慢；反向代理通常可以在联系应用程序之前等待请求被完全接收，然后快速吞下应用程序的完整响应（以便它可以转移到其他请求），然后将其反馈给客户端，速度尽可能慢他们需要。如果您仍然使用反向代理，那么也没有太多理由考虑使用 tcp 级别的负载均衡器；因为反向代理已经可以解决这个问题。尤其如此，因为 tcp 负载平衡器不支持应用程序，并且不能跳过“可访问”但“生病”的上游主机，它们会很乐意代理返回的服务器“

2：哪个应用程序容器适合您，这取决于应用程序和工作负载的形状；要利用像龙卷风这样的异步容器，您的应用程序必须以特殊方式编写；并且不能使用通常可用于 wsgi 的所有漂亮/方便的框架；另一方面，您将*需要*它们来实现长轮询，尤其是 websocket 等一些功能，这些功能在 uwsgi 之类的东西中是不实用的（甚至是不可能的）。

*但是*，并非所有容器都是平等的；许多人只说 HTTP，这不是一个 CPU 友好的协议，像 uwsgi 这样的容器旨在优化 http 解析工作，因此*只有*反向代理必须这样做，从那里，易于解析的二进制协议从一个进程传递到下一个。

3：websocket还是很新的，python中的支持比较少。最成熟的选项似乎是tornado 和twisted 中可用的实现；两者都不能托管在 uwsgi 中，也不能在 nginx 后面进行代理。还有其他可以处理 websocket 的反向代理，例如 varnish。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T23:21:01.980

在这三个选项中，只有选项 1 有可能使用 websockets。Nginx 和大多数标准网络服务器不能很好地配合它们。

# ios - 在 iOS 的 MapView 中缩放和集中用户位置时遇到问题

> ID：14146816
> 
> 赞同：0
> 
> 时间：2013-01-03T20:35:12.833
> 
> 标签：ios, mkmapview, core-location, cllocationmanager

我试图显示一个简单地捕获用户纬度和经度坐标的地图，然后在地图上放大到用户。我能够捕获用户的坐标，但我无法显示放大到用户位置的地图，也无法将地图以用户为中心。不幸的是，我只能查看从远处显示用户的地图。我的相关代码如下：

我`userLoc`在 .h 文件中声明了 CLLocationCoordinate2D 类型。然后我的 .m 文件中有以下内容：

```
 - (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{

    NSLog(@"didUpdateToLocation: %@", newLocation);
    CLLocation *currentLocation = newLocation;
    userLoc = newLocation.coordinate;
    [locationManager stopUpdatingLocation];
    [self showCurrentLocation];

    if (currentLocation != nil) {
        userLongitude = [NSString stringWithFormat:@"%.8f", currentLocation.coordinate.longitude];
        userLatitude = [NSString stringWithFormat:@"%.8f", currentLocation.coordinate.latitude];
    }

    NSLog(@"User Latitude is %@", userLatitude);
    NSLog(@"User Longitude is %@", userLongitude);
} 
```

然后我有以下显示实际地图的方法：

```
-(void) showCurrentLocation {

    mapView = [[MKMapView alloc] initWithFrame:CGRectMake(0, 55, 320, 425)];
    MKCoordinateRegion region = mapView.region;
    MKCoordinateSpan span;

    region.center = userLoc;
    span.latitudeDelta = 0.02;
    span.longitudeDelta = 0.02;
    region.span=span;

    [mapView setMapType:MKMapTypeStandard];
    [mapView setZoomEnabled:YES];
    [mapView setScrollEnabled:YES];
    [mapView setShowsUserLocation:YES];

    [self.view addSubview:mapView];

} 
```

正如我所说，我可以查看显示用户位置的地图，但地图既不会放大，也不会以用户为中心。谁能明白为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:37:19.617

```
-(void) showCurrentLocation {

    mapView = [[MKMapView alloc] initWithFrame:CGRectMake(0, 55, 320, 425)];
    MKCoordinateRegion region = mapView.region;
    MKCoordinateSpan span;

    region.center = userLoc;
    span.latitudeDelta = 0.02;
    span.longitudeDelta = 0.02;
    region.span=span;

    [mapView setMapType:MKMapTypeStandard];
    [mapView setZoomEnabled:YES];
    [mapView setScrollEnabled:YES];
    [mapView setShowsUserLocation:YES];
    [mapView setRegion:region animated:YES];
    [self.view addSubview:mapView];

} 
```

# php - PHP - foreach 键总是返回零

> ID：14146818
> 
> 赞同：-1
> 
> 时间：2013-01-03T20:35:21.837
> 
> 标签：php

尝试从数据库中更新和删除记录，但我的 $key 总是返回零。这是我的代码。如果我需要澄清任何事情，请告诉我。谢谢你。

请注意，我没有包括下面“while”的选择语句。

```
 // Fetch rows:      
    while ($Row = mssql_fetch_assoc($result5)) {

        $id = $Row['id'];
        $notes = $Row['RejectedNotes'];
        $first = $Row['FIRST'];
        $last = $Row['LAST'];
        $ssn = $Row['SSN'];
        $psn = $Row['PSN'];
        $dob = $Row['DOB'];
        $distdocket = $Row['DistDocket'];
        $releasedate = $Row['ReleaseDate'];
        $releasetype = $Row['ReleaseType'];

        $columnData4 =  "<table class='footerTable'><tr><td class='footerFirst'>"
        . $first .              "</td><td class='footerLast'>"
        . $last .               "</td><td class='footerSSN'>"
        . $ssn .                "</td><td><input type='text' class='footerNMCD' name = 'psn[]' value = '"
        . $psn .                "'></td><td class='footerDOB'>"
        . $dob .                "</td><td class='footerCause'>"
        . $distdocket .         "</td><td><input type='text' class='footerRelease' name = 'releasedate[]' value = '"
        . $releasedate .        "'></td><td>"
        .                       "<select name='relOptions[]' id='releaseOptions' class='footerEvent'>"
        .                       "<option value='$releasetype'>$releasetype</option>"
        .                       "<option value='Discharge'>Discharge</option>"
        .                       "<option value='In-House Parole'>In-House Parole</option>"
        .                       "</select></td>"
        .                       "<td class='reason'>"
        .                       "<button class='reason' onclick='openNotesBox(\"$notes\");'>View</button></td><td>"
        .                       "<input type='checkbox' name='checkbox[]' value=\"$id\" />$id</td></tr>";
        print $columnData4; 
    }
    print "</form></table>";

                // I know this is strange code, but it's what I had to do for Chrome.
    if(isset($_REQUEST['resubmit']) || isset($_REQUEST['remove']))
    {                   
        $checkbox=$_POST['checkbox'];               
        $nmcd=$_POST['psn'];
        $release=$_POST['releasedate'];
        $relOptions=$_POST['relOptions'];                           
        //HERE IS MY ISSUE!!!  $key is always "0".  
        foreach ($checkbox as $key => $value)
        {
            $nmcd = $nmcd[$key];
            $release = $release[$key];
            $releasedate = substr($release, 0, 2) . "-" . substr($release, 2, 2) . "-" . substr($release, 4, 4);
            $relOptions = $relOptions[$key];

            if(isset($_REQUEST['remove']))
            {           
                $del = "DELETE FROM submitted WHERE id='$value'";
                $result = mssql_query($del);
            }
            else {  
                if(isset($_REQUEST['resubmit']))
                {
                    $resub = "UPDATE submitted 
                             SET PSN = '$nmcd', ReleaseDate='$releasedate', ReleaseType='$relOptions', Rejected='0'
                             where id='$value'";
                    $result = mssql_query($resub);
                }           
            }       
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T21:04:21.383

您应该使用`$value`复选框，而不是`$key`. 您的代码如下：

```
<input type='checkbox' name='checkbox[]' value=\"$id\" />$id</td> 
```

在其中您没有为数组指定*索引值*`checkbox[]`，因此所有值都将按照设置的顺序添加。正如@ilmari-karonen 在引用[PHP - Checkbox group](https://stackoverflow.com/questions/1889913/php-checkbox-group)的注释中指出的那样，如果您希望在表单数据中接收它，则必须在 HTML 中指定一个有意义的值。IE：

```
<input type='checkbox' name='checkbox[$some_index]' value=\"$id\" />$id</td> 
```

# python - 烧瓶和传输编码：分块

> ID：14146824
> 
> 赞同：13
> 
> 时间：2013-01-03T20:35:57.063
> 
> 标签：python, http, flask

我们正在尝试让 Flask Web 服务正常工作，并且我们在流式传输帖子方面遇到了一些问题 - 即当标题包含 Transfer-Encoding: 分块时。

似乎默认烧瓶不支持 HTTP 1.1。有解决办法吗？

我们正在运行这个命令：

```
$ curl -v -X PUT  --header "Transfer-Encoding: chunked" -d @pylucene-3.6.1-2-src.tar.gz "http://localhost:5000/async-test" 
```

针对此代码：

```
@app.route("/async-test", methods=['PUT'])
def result():
    print '------->'+str(request.headers)+'<------------'
    print '------->'+str(request.data)+'<------------'
    print '------->'+str(request.form)+'<------------'
    return 'OK' 
```

这是卷曲输出：

```
$ curl -v -X PUT  --header "Transfer-Encoding: chunked" -d @pylucene-3.6.1-2-src.tar.gz "http://localhost:5000/async-test"
* About to connect() to localhost port 5000 (#0)
*   Trying ::1... Connection refused
*   Trying 127.0.0.1... connected
* Connected to localhost (127.0.0.1) port 5000 (#0)
> PUT /async-test HTTP/1.1
> User-Agent: curl/7.21.4 (universal-apple-darwin11.0) libcurl/7.21.4 OpenSSL/0.9.8r zlib/1.2.5
> Host: localhost:5000
> Accept: */*
> Transfer-Encoding: chunked
> Content-Type: application/x-www-form-urlencoded
> Expect: 100-continue
>
* HTTP 1.0, assume close after body
< HTTP/1.0 200 OK
< Content-Type: text/html; charset=utf-8
< Content-Length: 2
< Server: Werkzeug/0.8.3 Python/2.7.1
< Date: Wed, 02 Jan 2013 21:43:24 GMT
< 
```

这是 Flask 服务器输出：

```
* Running on 0.0.0.0:5000/ 
------->Transfer-Encoding: chunked
 Content-Length:
 User-Agent: curl/7.21.4 (universal-apple-darwin11.0) libcurl/7.21.4 OpenSSL/0.9.8r zlib/1.2.5
 Host: localhost:5000
 Expect: 100-continue
 Accept: */*
 Content-Type: application/x-www-form-urlencoded

 <------------
 -------><------------
 ------->ImmutableMultiDict([])<------------ 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T12:25:20.430

它不是 Flask Python，而是 mod_wsgi。只有 mod_wsgi 3.0+ 版本开始支持分块 http 传输。Flask Python 在内部使用 Werkzeug 工具包作为 mod_wsgi 的接口。如果您从 apt 源安装它，它可能是旧版本。

尝试编译最新版本的 mod_wsgi 然后安装 Flask 框架，可能会解决问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-24T21:18:30.217

这对我有用，但它不是最优雅的填充分块解析的方式。我使用了将身体粘贴到响应环境中的方法。

[无论 Content-Type 标头如何，在 Python Flask 中获取原始 POST 正文](https://stackoverflow.com/questions/10999990/get-raw-post-body-in-python-flask-regardless-of-content-type-header)

但是添加了处理分块解析的代码

```
class WSGICopyBody(object):
    def __init__(self, application):
        self.application = application

    def __call__(self, environ, start_response):
        from cStringIO import StringIO
        input = environ.get('wsgi.input')
        length = environ.get('CONTENT_LENGTH', '0')
        length = 0 if length == '' else int(length)
        body = ''
        if length == 0:
            environ['body_copy'] = ''
            if input is None:
                return
            if environ.get('HTTP_TRANSFER_ENCODING','0') == 'chunked':
                size = int(input.readline(),16)
                while size > 0:
                    body += input.read(size+2)
                    size = int(input.readline(),16)
        else:
            body = environ['wsgi.input'].read(length)
        environ['body_copy'] = body
        environ['wsgi.input'] = StringIO(body)

        # Call the wrapped application
        app_iter = self.application(environ, 
                                    self._sr_callback(start_response))

        # Return modified response
        return app_iter

    def _sr_callback(self, start_response):
        def callback(status, headers, exc_info=None):

            # Call upstream start_response
            start_response(status, headers, exc_info)
        return callback

app.wsgi_app = WSGICopyBody(app.wsgi_app) 
```

用它来解决它

```
request.environ['body_copy'] 
```

# sql - SQL 数据库规范化和外键实践（可变/空白键？）

> ID：14146825
> 
> 赞同：3
> 
> 时间：2013-01-03T20:35:56.983
> 
> 标签：sql, join, foreign-keys, normalization, foreign-key-relationship

我正在为我的公司设计一个数据库来管理商业贷款。每笔贷款都可以有担保人，可以是个人或公司，以防借贷业务失败。

我有 3 个表：Loan、Person 和 Company，它们存储显而易见的信息。我的困境是如何定义贷款与个人或公司之间的关系，以了解每笔贷款的担保人。我可以看到三种方法来做到这一点：

* * *

**1\. 为所有个人或公司担保人创建一个表 Guarantor：**

```
Guarantor:
 pkGuarantorID (int, primarykey)
 fkLoanID (foreign key mapping to the primary key of a row in Loan)
 fkPersonID (foreign key mapping to the primary key of a row in Person)
 fkCompanyID (foreign key mapping to the primary key of a row in Company) 
```

这种方法的问题是其中一个外键总是空白的，因为担保人只能是个人或公司，不能同时是两者。

* * *

**2\. 创建两个新表 Loan_Person 和 Loan_Company，分别代表两种不同的担​​保人：**

```
Loan_Person:
 pkLoan_PersonID (primary key)
 fkLoanID (foreign key mapping to the primary key of a row in Loan)
 fkPersonID (foreign key mapping to the primary key of a row in Person)

Loan_Company:
 pkLoan_CompanyID (primary key)
 fkLoanID (foreign key mapping to the primary key of a row in Loan)
 fkCmpanyID (foreign key mapping to the primary key of a row in Company) 
```

虽然显然更规范化并且可能是更好的选择，但这需要更多的逻辑来选择并正确组合或显示结果。

* * *

**3\. 创建一个引用 Person 或 Company 的表：**

```
Guarantor:
 pkGuarantorID (primary key)
 GuarantorType (signifies either Individual or Company)
 fkGuarantorKey (foreign key mapping to a primary key in Person if GuarantorType is Individual, or mapping to a primary key in Company if GuarantorType is Company) 
```

这似乎也是一个不错的选择，但需要在执行任何 JOIN 之前检查 GuarantorType 的值的额外步骤。

* * *

有人对采用哪种方法有任何建议吗？我希望听到有类似情况的人的意见，这样我就知道将来可能会产生或避免哪些头痛。

非常感谢您花时间看这个！

编辑：任何有类似问题的人，除了来自@RBarryYoung 的链接，也可能会发现这些问题很有用：

*   [数据库设计 - 文章、博客文章、照片、故事](https://stackoverflow.com/questions/4969133/database-design-problem)

*   [SQL-Server DB 设计时场景（分布式或集中式）](https://stackoverflow.com/questions/1623690/sql-server-db-design-time-scenario-distributed-or-centralized)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:52:38.137

这就是所谓的“类别关系”或（今天更常见的）“多表继承”。根据约束条件，至少有三种不同的可行方法来实施一种方法。这篇文章在这里：[http](http://www.sqlteam.com/article/implementing-table-inheritance-in-sql-server) ://www.sqlteam.com/article/implementing-table-inheritance-in-sql-server 很好地解释了如何实现它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T20:48:42.937

在我看来，没有明显的最佳或最差答案，每个都有其优点和缺点。这里有几点需要考虑：

解决方案 1 - 可以使用`CHECK`约束来保证数据完整性，以强制填充一个 FK 值。

解决方案 2 - 正如您所说，非常适合存储数据，而不适合查询数据。其中哪一个对您的应用程序更重要？

解决方案 3 - 这可行，但您将无法在 上定义 FK 约束`fkGuarantorKey`，这将导致数据完整性问题。如果我*必须*选择一个“最差”的解决方案，就是这样。

解决方案 4 - 您还可以考虑将`Person`和`Company`表合并到一个`LegalEntity`表中，并为仅限个人和仅限公司的数据设置子表。然后，您的`Guarantor`表将简化为具有两个 FK 的简单多对多链接表。如果您的产品的许多部分必须以相同的方式与人或公司打交道，这是一个很好的解决方案。然而，如果你的产品总是以不同的方式对待人和公司，那么它就不那么实用了。

# facebook - 可以在没有 JS、PHP 或本机设备 API 的情况下登录 Facebook（全部通过 HTTP[S] 处理）？

> ID：14146827
> 
> 赞同：0
> 
> 时间：2013-01-03T20:35:59.820
> 
> 标签：facebook, facebook-graph-api

我正在开发一个不使用代码的应用程序......这是一个声明性工作流程。我不能使用他们在他们的网站上概述的三种方法中的任何一种（[https://developers.facebook.com/docs/concepts/login/login-architecture](https://developers.facebook.com/docs/concepts/login/login-architecture/)）......相反，我必须 100% 自定义（调用一个服务，解析 OAuth 令牌的响应，包括它在未来的 HTTP GET 和 POST 中......

实际上，我正在尝试编写一些将条目添加到公司 Facebook PAGE 对象而不需要登录对话框的东西......我希望它自动执行此操作，也许这意味着作为一个应用程序......

在他们的网站上找不到任何显示如何执行此操作的内容……这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T21:41:51.797

想通了...我需要作为此处概述的应用程序登录：[https ://developers.facebook.com/docs/howtos/login/login-as-app/](https://developers.facebook.com/docs/howtos/login/login-as-app/)

# android - 如何获得具有不同内容的同一类的2个片段？

> ID：14146831
> 
> 赞同：0
> 
> 时间：2013-01-03T20:36:05.243
> 
> 标签：android, android-fragments, android-listfragment

我有课：

```
 public class ConferenceListFragment extends SherlockListFragment {

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

        DBAdapter dbAdapter = new DBAdapter(new DBHelper(getSherlockActivity()));       
        //How to get veriable "FLAG_BOOLEAN" ?
        List list = dbAdapter.getListItemInfoArray(FLAG_BOOLEAN);

        dbAdapter.close();

        CustomListAdapter adapter = new CustomListAdapter(getActivity(), list);
        setListAdapter(adapter);        
    }
} 
```

根据变量 FLAG_BOOLEAN，我从 DB 获得不同的数据。那么我可以将这个 FLAG 从 Activity 发送到片段吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:38:25.517

您应该在活动中使用[setArguments](http://developer.android.com/reference/android/app/Fragment.html#setArguments%28android.os.Bundle%29)将它们传递给片段，并从片段中使用 getArguments 来检索它们[。](http://developer.android.com/reference/android/app/Fragment.html#getArguments%28%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T22:38:02.380

如果您以编程方式添加片段，则可以为 ConferenceListFragment 添加一个构造函数，该构造函数接受您的布尔标志并使用 FragmentTransaction 添加片段，如下所示：

```
ConferenceListFragment list1 = new ConferenceListFragment(true);
ConferenceListFragment list2 = new ConferenceListFragment(false);

FragmentTransaction ft = getFragmentManager().beginTransaction();
ft.add(parentView, list1);
ft.add(parentView, list2);
ft.commit(); 
```

使用构造函数在 ConferenceListFragment 中设置私有布尔成员变量：

```
public ConferenceListFragment(boolean flag){
    this.flag = flag;
} 
```

然后当你调用你的方法时，你可以这样做：

```
List list = dbAdapter.getListItemInfoArray(this.flag); 
```

# toggleclass - 如何在点击时切换多个 div

> ID：14146832
> 
> 赞同：1
> 
> 时间：2013-01-03T20:36:06.207
> 
> 标签：toggleclass, jquery

我之前曾问过一个类似的问题，其答案部分解决了我的问题。

但是现在我需要扩展代码。

当只有两个 div 时，此代码会切换 div 的可见性，但是当添加第三个时，当我想单独显示每组 div 时，它会同时显示第二组和第三组 div '

这个小提琴显示了当前发生的事情； [http://jsfiddle.net/richarde/vCjPL/](http://jsfiddle.net/richarde/vCjPL/)

jQuery

```
$('.media-thumb a').click(function(){
    $('div[class^="media"]').toggleClass('is-hidden');
    return false;
}); 
```

标记（点击事件绑定到这些 div 的锚点）

```
<div class="media-thumb ">
    <img src="thumb.jpg" />
    <p><a href="#">Link 1</a></p>
</div>
<div class="media-thumb is-hidden">
    <img src="thumb.jpg" />
    <p><a href="#">Link 2</a></p>
</div>
<div class="media-thumb is-hidden">
    <img src="thumb.jpg" />
    <p><a href="#">Link 3</a></p>
</div> 
```

现在我需要扩展上述内容，我不确定我目前的方法是最好的。在我的情况下，我能做些什么来完成这项工作？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T20:57:00.677

如果我理解正确，点击第一个链接，应该让第二个 div 出现，点击第二个链接，应该让第三个 div 出现，依此类推。

如果是这样，那么试试这个：

```
$('.media-thumb a').click(function(){
    var parentDiv=$(this).parents('div.media-thumb');
    $(parentDiv).toggleClass('is-hidden');
    if($(parentDiv).next('div.media-thumb').length){
       //there is next div.media-thumb; make it visible
       $(parentDiv).next('div.media-thumb').toggleClass('is-hidden'); 
    }else{
        //back to first div
        $('div.media-thumb:first').toggleClass('is-hidden');
    }
    return false;
});​ 
```

这是[jsfiddle](http://jsfiddle.net/5sX9M/1/)

现在取决于您是否希望 div 占用空间，使您的 css 类`.is-hidden{ visibility: hidden}`或`.is-hidden{display: none}`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:47:54.997

### 更新：我根据添加到问题中的新信息完全改变了答案。

听起来`<a>`元素应该像“下一步”按钮一样。

我将 HTML 更改为具有第三个元素：

```
<!-- thumbs -->
<div class="media-thumb ">
    <img src="thumb.jpg" />
    <p><a href="#">Link 1</a></p>
</div>
<div class="media-thumb is-hidden">
    <img src="thumb.jpg" />
    <p><a href="#">Link 2</a></p>
</div>
<div class="media-thumb is-hidden">
    <img src="thumb.jpg" />
    <p><a href="#">Link 3</a></p>
</div>

<!-- images -->
<div class="media pull-left">
    <img src="img.jpg" />
</div>
<div class="media pull-left is-hidden">
    <img src="img.jpg" />
</div>
<div class="media pull-left is-hidden">
    <img src="img.jpg" />
</div>

<!-- text -->
<div class="media-aside">
    <h4>heading 4</h4>
    <p>Text...</p>
    <p class="call-to-action"><a href="someurl">url</a></p>
</div>
<div class="media-aside is-hidden">
    <h4>heading 5</h4>
    <p>Paragraph...</p>
    <p class="call-to-action"><a href="someurl">url</a></p>
</div>
<div class="media-aside is-hidden">
    <h4>heading 6</h4>
    <p>Paragraph...</p>
    <p class="call-to-action"><a href="someurl">url</a></p>
</div>​ 
```

此 JavaScript 将循环遍历元素。如果单击“链接 1”，则“链接 2”、第二个`img.media.pull-left`图像和第二个`div.media-aside`将显示。如果单击“链接 2”，将显示拇指、图像和文本部分的第三个元素等。

```
var $divs = $('.media-thumb'),
    $imgs = $('.media'),
    $txts = $('.media-aside'),
    sets = [],
    max = $divs.length,
    cur = 0,
    i = 0,
    $temp;

// create jQuery objects that contains the .media-thumb, .media,
// and .media-aside HTML elements that should be showing at the
// same time. IE, a jQuery object with the 1st .media-thumb, the 1st
// .media, etc.

for (; i < max; i++) {
    sets[i] = $divs.eq(i)
        .add($imgs.eq(i))
        .add($txts.eq(i));
}

// when the <a> is clicked, turn off the current set
// and turn on the next set
$divs.on('click', 'a', function() {
    sets[cur].addClass('is-hidden');
    cur = ++cur % max;
    sets[cur].removeClass('is-hidden');
}); 
```

一个 jsFiddle 演示：http: [//jsfiddle.net/TvK53/](http://jsfiddle.net/TvK53/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T20:50:39.980

如果我正确理解你想要什么，这个例子是这样的 - [http://jsfiddle.net/UYLkh/](http://jsfiddle.net/UYLkh/)

```
$('.media-thumb a').each(function(key, el){
    $(el).click(function(){
        $(this).closest('div').toggleClass('is-hidden');
        return false;
    });
}); 
```

# java - 测试 ldap 连接

> ID：14146833
> 
> 赞同：9
> 
> 时间：2013-01-03T20:36:08.560
> 
> 标签：java, spring, spring-security, ldap

我想验证用户输入的 ldap 设置。在设置页面上，用户输入 ldap url、manager dn 和密码。我在此页面上有一个“测试设置”按钮，以便用户可以快速验证 ldap 连接。如何轻松快速地做到这一点？

我们的应用程序使用 spring security 并在向其添加 ldap 身份验证的过程中。我对 java 和 ldap 有点陌生，因此非常感谢您指出正确的方向。

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-03T22:16:38.807

根据所提供的信息，很难说出您知道什么以及您还不知道什么。因此，我建议您在 java.net LdapTemplate 上遵循这个有用的教程[：Java 中的 LDAP 编程变得简单](https://web.archive.org/web/20110303233605/http://today.java.net:80/pub/a/today/2006/04/18/ldaptemplate-java-ldap-made-simple.html)，并跳过与您无关的章节（从 2006 年开始，但仍然可以）。[文章中引用的Spring LDAP](http://www.springsource.org/ldap)目前版本为 1.3.1。

如果您现在想不使用 Spring LDAP，可以使用以下传统代码：

```
Map<String, String> env = new HashMap<String, String>();
env.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
env.put(Context.PROVIDER_URL, "ldap://localhost:389/dc=jayway,dc=se");
env.put(Context.SECURITY_AUTHENTICATION, "simple");
env.put(Context.SECURITY_PRINCIPAL, "uid="+ username +",ou=system"); // replace with user DN
env.put(Context.SECURITY_CREDENTIALS, password);

DirContext ctx;
try {
   ctx = new InitialDirContext(env);
} catch (NamingException e) {
   // handle
}
try {
   SearchControls controls = new SearchControls();
   controls.setSearchScope( SearchControls.SUBTREE_SCOPE);
   ctx.search( "", "(objectclass=person)", controls);
   // no need to process the results
} catch (NameNotFoundException e) {
   // The base context was not found.
   // Just clean up and exit.
} catch (NamingException e) {
   // exception handling
} finally {
   // close ctx or do Java 7 try-with-resources http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-11-14T09:11:45.677

**使用 Spring LDAP 身份验证测试 LDAP 连接：**

即使用***authenticate()***方法：

```
ldapTemplate.authenticate(query, password); 
```

甚至更好，使用***getContext()***方法：

```
ldapTemplate.getContextSource().getContext(userDn, userPassword)); 
```

捕获**org.springframework.ldap.CommunicationException**以检查连接是否成功。

**完整的代码片段应如下所示：**

```
// Create the spring LdapTemplates; i.e. connections to the source and target ldaps:
try {
    // Note: I'm using the direct LdapTemplate initialization rather than with bean creation (Spring ldap supports both) 
    log.info("Connecting to LDAP " + sourceHost + ":" + sourcePort + "...");    
    LdapContextSource sourceLdapCtx = new LdapContextSource();
    sourceLdapCtx.setUrl("ldap://" + sourceHost + ":" + sourcePort + "/");
    sourceLdapCtx.setUserDn(sourceBindAccount);
    sourceLdapCtx.setPassword(sourcePassword);
    sourceLdapCtx.setDirObjectFactory(DefaultDirObjectFactory.class);
    sourceLdapCtx.afterPropertiesSet();
    sourceLdapTemplate = new LdapTemplate(sourceLdapCtx);
    // Authenticate:
    sourceLdapTemplate.getContextSource().getContext(sourceBindAccount, sourcePassword);
} catch (Exception e) {
    throw new Exception("Failed to connect to LDAP - " + e.getMessage(), e);
} 
```

**注意：**我使用的是 spring LDAP 2.3.x 版本：

```
<dependency>
    <groupId>org.springframework.ldap</groupId>
    <artifactId>spring-ldap-core</artifactId>
</dependency> 
```

# jquery - jQuery .click() 不运行函数

> ID：14146834
> 
> 赞同：-1
> 
> 时间：2013-01-03T20:36:16.760
> 
> 标签：jquery

> **可能重复：**
> [在javascript中的return语句之后执行语句](https://stackoverflow.com/questions/14102912/execute-statement-after-return-statement-in-javascript)

我有一个元素，单击时会触发一个选项传输脚本，该脚本将选项从一个`<select multiple>`元素移动到另一个元素。然后它应该针对更改的内容运行一个函数。唯一的问题是该功能没有运行。

```
$('#cityadd').click(function() {
    return !$('#ucityone option:selected').remove().appendTo('#ucitytwo');
    runPagination();
}); 
```

单击元素时该函数`runPagination();`未运行`#cityadd`。我不知道这是语法错误还是什么。同样的设置与我现有的其他实例一起运行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T20:37:25.240

您`return`在第一行有一个语句，该语句将从该行返回，并且不会执行进一步的语句。

这`runPagination()`是一个无法访问的代码。将函数移到返回语句上方，如下所示。

```
$('#cityadd').click(function() {
    runPagination();
    return !$('#ucityone option:selected').remove().appendTo('#ucitytwo');
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T20:37:32.180

这是因为它是在`return`语句之​​后执行的，这将有效地忽略后面的任何内容，从而`runPagination()`无法访问。

```
function PerformX()
{
     return x;
     //Unreachable code here
} 
```

为了实际执行该操作，只需切换它们被调用的顺序：

```
$('#cityadd').click(function() {
    runPagination();
    return !$('#ucityone option:selected').remove().appendTo('#ucitytwo');
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:40:41.080

That is because you used [`return`](http://en.wikipedia.org/wiki/Return_statement) before calling `runPagination()`

change your code to :

```
$('#cityadd').click(function() {
    $('#ucityone option:selected').remove().appendTo('#ucitytwo');
    runPagination();
}); 
```

# php - JQUERY-AJAX 自动填充选择框

> ID：14146835
> 
> 赞同：0
> 
> 时间：2013-01-03T20:36:17.207
> 
> 标签：php, javascript, forms, jquery

我一直在钻研这个 AJAX 自动填充功能一段时间，但没有成功。我的实现有点复杂，所以我在网上搜索了一个教程来逐步完成，我什至无法让它工作。我想如果我能得到一些帮助，让这个简单的例子（如下）工作，我可以扩大规模并根据需要实施。下面的代码：

HTML

```
 <body>
    <p>Select Dropdown</p>
    <p>
        <select id="selection">
            <option value="">- Select Item Here -</option>
            <option value="food">List of Food</option>
            <option value="animals">List of Animals</option>
            <option value="flowers">List of Flowers</option>
        </select>
    </p>
    <p>DropDown Result</p>
    <p>
        <select id="selectionresult"></select>
    </p>
    <p id="result">&nbsp;</p>
    </body> 
```

查询

```
 <script type="text/javascript" src="js/jquery-1.8.3.js"></script>
    <script type="text/javascript">
    $(document).ready(function(){
        $("#selectionresult").hide();
        $("#selection").change( function() {
             $("#selectionresult").hide();
             $("#result").html('Retrieving …');
             $.ajax({
                     type: "POST",
               data: "data=" + $(this).val(),
               url: "demo/jquery-autopopulate-select-dropdown-box-response.php",
               success: function(msg){
                       if (msg != ""){
                         $("#selectionresult").html(msg).show();
                   $("#result").html("");
                 }
                 else{
                   $("#result").html('<em>No item result</em>');
                 }
               }
            });
         });
      });
      </script> 
```

最后，PHP

```
<?php

$expectedValues = array(“food”, “animals”, “flowers”);

$selectionArr['food'] = array(‘pizza’, ‘spaghetti’, ‘rice’);
$selectionArr['animals'] = array(‘cat’, ‘dog’, ‘girrafe’, ‘pig’, ‘chicken’);
$selectionArr['flowers'] = array(‘rose’, ‘sampaguita’);

if (isset($_POST['data']) and in_array($_POST['data'], $expectedValues)){
    $selectedArr = $selectionArr[$_POST['data']];

    foreach($selectedArr as $optionValue){
        echo '<option>' . $optionValue . '</option>';
    }
}

?> 
```

这段代码似乎一切正常，但在 selectionresult 选择器中仍然没有显示任何选项？

任何想法，先生们，并提前致谢。

我知道在你的帮助下我可以得到这个。

# ajax - 如何在微风.js 中附加到“metadataLoaded”事件（或等效事件）

> ID：14146841
> 
> 赞同：5
> 
> 时间：2013-01-03T20:36:37.607
> 
> 标签：ajax, breeze

我正在开发一个使用微风进行数据访问的 SPA。我想尽快创建一个元数据实例，我想这将是**在**完成初始化之后：

```
var manager = new entityModel.EntityManager(serviceName); 
```

但是，实体管理器需要向 web api 控制器执行 ajax 请求以加载元数据，如果我`manager.metadataStore.getEntityType("EntityName")`在它完成之前尝试，我会得到：

```
Uncaught Error: Unable to locate an 'Type' by the name 
```

我的问题**是加载元数据时是否会触发事件**？我浏览了文档，但似乎找不到它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T21:24:03.067

没有事件，但您可以自己调用 MetadataStore.fetchMetadata 方法并在 promise 的“then”部分执行您的逻辑。

MetadataStore.fetchMetadata 方法由针对每个服务器的第一个查询在内部自动调用（**如果尚未调用）。**.

因此，只需在第一次查询之前自己调用 MetadataStore.fetchMetadata。

希望这是有道理的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-14T20:05:27.797

从 Breeze 1.4.16 开始，*MetadataStore*现在有一个*metadataFetched*事件，如下所述：[http ://www.breezejs.com/sites/all/apidocs/classes/MetadataStore.html#event_metadataFetched](http://www.breezejs.com/sites/all/apidocs/classes/MetadataStore.html#event_metadataFetched)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-09T12:32:05.100

建议的解决方案的问题是 fetchMetadata 可能会失败......由于各种原因。如果失败是由于暂时的通信失败，那么下一个查询调用会获取元数据，并且应用程序将开始访问数据，而无需初始化 WRT 元数据所需的任何初始化（在我们的例子中是客户端验证）。在我们的例子中，除了没有验证之外，该应用程序似乎运行良好。

奇怪的是，这种情况经常发生。对 fetchMetadata 的调用失败，但后续查询成功。不会每次都发生，但会发生不止一点。

我们可以向系统添加一个状态，在 fetchMetadata 成功之前阻止其他数据访问，然后重试它直到成功。但是，这是很多工作。加载完成时触发的事件会好得多。

# java - 在试图找到最大公共子串的一般树遍历中卡住寻找最深的路径

> ID：14146843
> 
> 赞同：3
> 
> 时间：2013-01-03T20:36:42.253
> 
> 标签：java, algorithm, data-structures, tree, suffix-tree

我正在尝试解决 2 个字符串之间的最大公共子字符串的问题。我将把我的问题简化为以下内容：我创建了一个[通用后缀树](http://en.wikipedia.org/wiki/Generalized_suffix_tree)，根据我的理解，最大的公共子字符串是由属于两个字符串的节点组成的最深路径。

我的测试输入是：

```
String1 = xabc
String2 = abc 
```

![在此处输入图像描述](../Images/4e1d3ac0a03f3244da7682f266b46e8a.png)

看来我构建的树是正确的，但我的问题是以下方法（我最初通过树的根）：

```
private void getCommonSubstring(SuffixNode node) {  
   if(node == null)  
    return;  
   if(node.from == ComesFrom.Both){  
    current.add(node);          
   }  
   else{  
    if(max == null || current.size() > max.size()){  
        max = current;              
    }  
    current = new ArrayList<SuffixNode>();   
   }  
   for(SuffixNode n:node.children){  
    getCommonSubstring(n);  
   }  
} 
```

我的目标是，为了找到属于两个字符串的节点的最深路径，我将遍历树（预排序）并在列表（`current`）中添加属于两个字符串的节点。一旦我在一个不属于两者的节点中，我会更新`max`列表（如果`current`更大）。

但是代码是错误的。而且我对如何实现这一点感到困惑，因为我已经很久没有为一般（非二元）树编写代码了。

你能帮我解决这个问题吗？

**更新：**
根据@templatetypedef 修改。也无法完成这项工作。

```
private void getCommonSubstring(SuffixNode node, List<SuffixNode> nodes) {  
   if(node == null)  
    return;  
   if(node.from == ComesFrom.Both){  
    nodes.add(node);              
   }  
   else{  
       if(max == null || current.size() > max.size()){  
       max = nodes;               
    }  
    nodes = new ArrayList<SuffixNode>();  
   }  
   for(SuffixNode n:node.children){  
    List<SuffixNode> tmp = new ArrayList<SuffixNode>(nodes);  
    getCommonSubstring(n, tmp);  
   }  
}  

public class SuffixNode {
    Character character;  
    Collection<SuffixNode> children;  
    ComesFrom from;  
    Character endMarker;  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:45:36.903

我在这里看到的一个问题是后缀树中节点的*深度*与沿该路径的字符串的*长度不同。*后缀树中的每条边都用一系列字符进行注释，因此由一系列深度为 5 的节点编码的字符串可能比在深度 2 编码的字符串具有更短的长度。您可能需要调整您的算法来处理这个问题，方法是跟踪您到目前为止所构建的字符串的有效长度，而不是到目前为止您已经追踪的路径中的节点数。

我刚刚注意到的第二个问题是，您似乎只有一个`current`变量在递归的所有不同分支中共享。这可能会在递归调用中弄乱您的状态。例如，假设您在一个节点处并且有一条长度为 3 的路径，并且有两个子节点 - 第一个子节点仅以第一个字符串的后缀结尾，第二个子节点以两个字符串。在这种情况下，如果您对第一个字符串进行递归调用，您最终将执行该行

```
current = new ArrayList<SuffixNode>(); 
```

在递归调用中。然后这将清除您的所有历史记录，因此当您从此调用返回原始节点并下降到第二个子节点时，您将表现得好像到目前为止还没有建立节点列表，而不是继续从到目前为止您找到的三个节点。

为了解决这个问题，我建议`current`为函数创建一个参数，然后`ArrayList`在需要时创建一个新参数，而不是清除现有的`ArrayList`. 其他一些逻辑可能也必须更改以解决此问题。

鉴于此，我建议用这样的伪代码编写函数（因为我不知道你的后缀树实现的细节）：

*   如果当前节点为空，则返回 0。
*   如果当前节点不是来自两个字符串，则返回 0。
*   否则：
    *   设置 maxLen = 0。
    *   对于每个子节点：
        *   计算以该节点为根的最长公共子串的长度。
        *   将该长度添加到该子项沿边缘的字符数。
        *   如果超过旧值，则更新 maxLen。
    *   返回最大长度。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T21:59:57.097

虽然不是答案，但这就是我使用标准集合和 O(n log n) 查找来解决它的方法。

```
static String findLongestCommonSubstring(String s1, String s2) {
    if (s1.length() > s2.length()) return findLongestCommonSubstring(s2, s1);

    NavigableSet<String> substrings = new TreeSet<>();
    for (int i = 0; i < s1.length(); i++)
        substrings.add(s1.substring(i));
    String longest = "";
    for (int i = 0; i < s2.length(); i++) {
        String sub2 = s2.substring(i);
        String floor = match(substrings.floor(sub2), sub2);
        String ceiling = match(substrings.ceiling(sub2), sub2);
        if (floor.length() > longest.length())
            longest = floor;
        if (ceiling.length() > longest.length())
            longest = ceiling;
    }
    return longest;
}

private static String match(String s1, String s2) {
    if (s1 == null || s2 == null) return "";
    for (int i = 0; i < s1.length() && i < s2.length(); i++)
        if (s1.charAt(i) != s2.charAt(i))
            return s1.substring(0, i);
    return s1.substring(0, Math.min(s1.length(), s2.length()));
}

public static void main(String... args) {
    System.out.println(findLongestCommonSubstring("sdlkjfsdkljfkljsdlfkjaeakjf", "kjashdkasjdlkjasdlfkjaesdlk"));
} 
```

印刷

```
sdlfkjae 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-20T11:43:01.663

```
public String findCommonSubString(string str1, string str2) {
   string mainStr;
   string otherStr;
   string commonStr = "";
   string foundCommonStr = "";
   boolean strGrowing = false;

   If (str1.length() > str2.length()) {
      mainStr = str1;
      otherStr = str2;
   } else {
      mainStr = str2;
      otherStr = str1;
   }

   int strCount = 0;

   for(int x = 0; x < mainStr.length();x++) {
      strCount = 1;
      strGrowing = true;

      while(strGrowing) {
         if (otherStr.IndexOf(mainStr.substring(x, strCount) >= 0) {
            //Found a match now add a character to it.
            strCount++;

            foundCommonStr = mainStr.substring(x, strCount);

            if (foundCommonStr.length() > commonStr.length()) {
               commonStr = foundCommonStr;
            }
         } else {
            strGrowing = false;
         }
      }

   }

return commonStr;

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T21:02:23.147

你必须走后缀树的路线吗？如果没有，你为什么不能：

```
public String findCommonSubString(string str1, string str2) {
   string mainStr;
   string otherStr;
   string commonStr = "";
   string foundCommonStr = "";
   boolean strGrowing = false;

   If (str1.length() > str2.length()) {
      mainStr = str1;
      otherStr = str2;
   } else {
      mainStr = str2;
      otherStr = str1;
   }

   int strCount = 0;

   for(int x = 0; x < mainStr.length();x++) {
      strCount = 1;
      strGrowing = true;

      while(strGrowing) {
         if (otherStr.IndexOf(mainStr.substring(x, strCount) >= 0) {
            //Found a match now add a character to it.
            strCount++;

            foundCommonStr = mainStr.substring(x, strCount);

            if (foundCommonStr.length() > commonStr.length()) {
               commonStr = foundCommonStr;
            }
         } else {
            strGrowing = false;
         }
      }

   }

return commonStr;

} 
```

我没有运行这个......但我会的。基本上，这将从两个字符串中最小的字符串开始，并尝试使用 IndexOf 和子字符串在两个字符串之间找到一个公共字符串。然后如果确实如此，它将再次检查，但这次通过从较小的字符串中再添加一个字符来检查。如果找到的字符串 (foundCommonStr) 大于 commonStr，它只会将字符串存储在 commonStr 变量中。如果它没有找到匹配项，那么它已经存储了最大的 commonStr 以供返回。

我相信这个想法是合理的，但我没有在编译器中运行它。

# python - 共享目录的python脚本，通过update-rd.c添加到启动，挂起启动

> ID：14146844
> 
> 赞同：2
> 
> 时间：2013-01-03T20:36:41.430
> 
> 标签：python, simplehttpserver

好的，我搜索了高低，找到了我的难题，但没有解决方案。

我想通过 http 共享一个目录，而不必担心 apache 等。python 是最简单的答案。所以我把简单的脚本放在一起（称为 tftp-www.py）：

```
#!/usr/bin/env python
import SimpleHTTPServer
import SocketServer
import os
os.chdir("/var/lib/tftproot")
PORT = 8000
Handler = SimpleHTTPServer.SimpleHTTPRequestHandler
httpd = SocketServer.TCPServer(("", PORT), Handler)
print "Server running on port ", PORT
httpd.serve_forever() 
```

chmod 到 755，运行它，无论我从哪里运行它，它都能完美运行。现在我希望它在启动时运行，在任何人登录之前，所以这个目录将始终被共享。因此，我将文件复制到 /etc/init.d 并按照有关如何将脚本添加到启动的说明运行以下命令：

```
update-rc.d -f tftp-www.py start 99 2 3 4 5 . 
```

此时我重新启动进行测试，并且服务器（Ubuntu 10.10）在启动过程中挂起。一旦我进入恢复模式并删除了脚本

```
update-rc.d -f tftp-www.py remove 
```

服务器正常启动。

那么，我做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T18:12:14.943

Debian/ubuntu 风格的 update-rc.d 和启动脚本是为 shell 脚本设计的，需要元数据部分：

```
#! /bin/sh
### BEGIN INIT INFO
# Provides:          rc.local
# Required-Start:    $remote_fs
# Required-Stop:
# Default-Start:     2 3 4 5
# Default-Stop:
# Short-Description: Run /etc/rc.local if it exist
### END INIT INFO 
```

查看 /etc/init.d/skeleton （至少存在于 Debian 上，不确定 Ubuntu）。为您的程序创建 shell 启动脚本，然后在`do_start()`函数中运行它。

# magento - 必须从选定类别中购买任何物品才能购买特定物品

> ID：14146847
> 
> 赞同：1
> 
> 时间：2013-01-03T20:36:48.337
> 
> 标签：magento

我到处研究过，而且是 Magento 开发的新手，我很难思考如何完成这项任务。

我们的商店有一个会员资格，它被设置为它自己的简单产品。会员项目的价格为 5 美元。问题是这个会员资格只能添加到购物车中添加另一个项目（一顶帽子）。

因此，为了购买会员资格，您的购物车中必须有一顶 x、y 或 z 类别的帽子。

关于最好的编码方法有什么想法吗？是否可以通过简单的设置或者我需要深入研究一些核心代码？任何帮助都会非常有帮助——尤其是代码示例、我应该查看的特定文件名/路径。

如果有帮助，我正在使用 Magento Enterprise V. 1.12.0.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T21:01:11.650

您可以创建一个观察者`add_to_cart_before`，以查看用户在他们的购物车中有哪些产品

```
 <add_to_cart_before>
      <observers>
          <add_to_cart_before>
               <class>dispatcher/observer</class>
              <method>hookToAddToCartBefore</method>
          </add_to_cart_before>
      </observers>
 </add_to_cart_before> 
```

在您的观察者中（查看如何[创建观察者](https://stackoverflow.com/a/12696681/1191288)）

```
$cartHelper = Mage::helper('checkout/cart');
$items = $cartHelper->getCart()->getItems();
$category_in_cart_ids = array();
foreach ($items as $item) {
    array_push($category_in_cart_ids, $item->getProduct()->getCategoryIds());  // append category array to category_in_cart_ids
}

if(specific item id){
   if(in_array('your category ids', $category_in_cart_ids)){
     // product specific category in cart
   }
   else{
     //dont add this product to cart/ remove
   }
} 
```

请参阅[http://incho.net/ecommerce/magento/dispatching-before-and-after-events-to-magento-core-actions/](http://inchoo.net/ecommerce/magento/dispatching-before-and-after-events-to-magento-core-actions/)

# c - Arduino：printf/fprintf 打印问号而不是浮点数

> ID：14146850
> 
> 赞同：10
> 
> 时间：2013-01-03T20:36:53.353
> 
> 标签：c, arduino, stdio, printf

我有以下代码用于 Arduino 草图：

```
#include <LiquidCrystal.h>

LiquidCrystal lcd(12, 11, 5, 4, 3, 2);
static FILE lcdout = {0} ;

static int lcd_putchar(char ch, FILE* stream)
{
    lcd.write(ch) ;
    return (0) ;
}

void setup() {
  lcd.begin(16, 2);
  fdev_setup_stream (&lcdout, lcd_putchar, NULL, _FDEV_SETUP_WRITE);
}

void loop() 
{
  stdout = &lcdout;
  printf("%.2f Volts", 2.0);
} 
```

问题出现在代码的最后一行。这应该打印出“2.00 Volts”，而是打印出“? Volts”（一个问号，而不是实际的浮点值）。如果我尝试格式化整数，这很好用。

所以基本上，如果我用以下内容替换 printf 行，它将正常工作：

```
printf("%d Volts", 2); //prints correctly "2 Volts" 
```

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-03T20:43:34.653

AVR 的 GNU 工具链（包含在 Arduino IDE 中）默认使用 C 标准库的“缩小”版本，例如，浮点支持从格式化的 I/O 函数中减少/取消（只是为了`printf()`适应芯片的几 kBytes 长存储。）

`printf()`如果你想让它工作，你必须使用`-Wl,-u,vfprintf -lprintf_flt`链接器标志再次链接另一个包含正常版本的库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-03T20:40:36.913

从`avr-libc` [文档](http://www.nongnu.org/avr-libc/user-manual/group__avr__stdio.html)：

> 如果需要包括浮点转换在内的全部功能，则应使用以下选项：
> 
> `-Wl,-u,vfprintf -lprintf_flt -l`

请注意，如果您的 MCU 没有任何浮点支持，您应该尽量避免浮点操作。浮点运算将在软件中完成，效率非常低，需要大量闪存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-01T13:03:39.677

我做了这个：

```
unsigned char buffer[32];

void setup() {
  serial.begin();
}

void loop() {
  if(serial.available()) {
    int size = serial.read(buffer);
    if (size!=0) {
      //serial.write((const uint8_t*)buffer, size);
      int bright = atoi((char *) buffer);

      //int final = ((unsigned int)buffer[0]);

      //int final = bright -'0';
      serial.write(bright);
      serial.write('\n');
    }
  }
  serial.poll();
} 
```

现在，当我通过 USB 发送 0-255 的值时，我得到一个 ascii 字符。我应该找到一种将 ascii char 转换为 int 的方法。

例如，我输入 65 并打印 A

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-19T01:43:11.577

如果您想完全避免 printf 并且只需要在小数点前后使用给定的数字进行打印，我有一些旧代码可能会有所帮助。此代码在 C 中编译，并且在 Arduino IDE 中也可以正常工作。几乎可以肯定，它可以用更少的 C++ 行来完成。pow10 可以通过编程方式完成，但使用的 CI 版本不支持权力：

```
#include <stdio.h>

/*
Because lcd and serial don't support printf, and its very costly, and all we need
is simple formating with a certain number of digits and precision, this ftoa is enough.
If digits is negative, it will pad left.
*/
#define  BUF_LEN 20
char buf[BUF_LEN]; //need a buffer to hold formatted strings to send to LCD

int ftoa(char * str, float f, char digits, char precision) {
char i=0,k,l=0;
long a,c;
long pow10[10] = {1,10,100,1000,10000,100000,1000000,10000000,100000000,1000000000};
unsigned char b;
char decimal='.';

  if(digits>=10) {return 0;};
  // check for negative float
  if(f<0.0) {
    str[i++]='-';
    f*=-1;
    (0<digits?digits--:digits++);
    }
  a=(int)f; // extracting whole number
  f-=a; // extracting decimal part
  k = digits;
  // number of digits in whole number
  while(k>=0)   {
    c = pow10[k];
    c = a/c;
    if(c>0) { break; }
    k--;
    } // number of digits in whole number are k+1
  if (0<k && digits==k && c>10) { //overflow
    decimal = 'e';
    }
/*
extracting most significant digit i.e. right most digit , and concatenating    to string
obtained as quotient by dividing number by 10^k where k = (number of digit -1)
*/
  for(l=abs(k);l>=0;l--){
    c = pow10[l];
    b = a/c;
    str[i++]=(l&&!b?' ':b+48); //digit or pad
    a%=c;
    }
  if (precision) {str[i++] = decimal;};
/* extracting decimal digits till precision */
  if (0>precision) {k=0; precision=abs(precision);}
  for(l=0;l<precision;l++) {
    f*=10.0;
    b = (int)f; //math floor
    str[i++]=b+48; //48 is ASCII 0
    f-=(float)b;
    if (!k && 0==f) { break; } //nothing left, save chars.
    //won't work if there are any floating point errors.
    }
  str[i]='\0';
  return i;
  } 
```

你可以玩它，看看它在这里运行：http: [//ideone.com/AtYxPQ](http://ideone.com/AtYxPQ)

# .htaccess - 如何在服务器上部署zend项目的过程中编辑.htaccess？

> ID：14146853
> 
> 赞同：0
> 
> 时间：2013-01-03T20:37:10.237
> 
> 标签：.htaccess, zend-framework, deployment

我正在尝试部署在使用 zend 框架开发的服务器网站 (http://webdeveloper.md) 上。当我在服务器上的帐户上输入文件管理器时，会显示以下结构：

anon_ftp
cgi-bin
conf
error_docs
等
httpdocs
和其他目录。

我在 httpdocs 中部署了我的项目，因此在访问它时，会显示标准的 zend 结构（设置、应用程序、数据等）。据我了解，我的网站主目录的路径是[http://webdeveloper.md/httpdocs/public/index.php](http://webdeveloper.md/httpdocs/public/index.php)。我尝试将此路径插入到托管设置中的文档根目录中。现在，当我在浏览器中访问 webdeveloper.md 时，我收到错误 404（未找到）。

我相信问题出在我的 .htaccess 文件中。我没有任何改变，它包含标准代码：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

我试图修改它 - 又增加了一行：

```
RewriteBase /httpdocs/public 
```

那么这个：

```
RewriteBase http://webdeveloper.md/httpdocs/public 
```

然后这个，而不是最后一行：

```
RewriteRule http://webdeveloper.md/httpdocs/public 
```

没有任何作用！

我的 configuraion.ini 看起来像这样：

```
[production]
resources.cachemanager.database.frontend.name = Core
resources.cachemanager.database.frontend.options.lifetime = 7200
resources.cachemanager.database.frontend.options.automatic_serialization = true
resources.cachemanager.database.backend.name = File
resources.cachemanager.database.backend.options.cache_dir = APPLICATION_PATH "/../data/cache"
resources.cachemanager.database.frontendBackendAutoload = false
phpSettings.display_startup_errors = 0
phpSettings.display_errors = 0
includePaths.library = APPLICATION_PATH "/../library"
bootstrap.path = APPLICATION_PATH "/Bootstrap.php"
bootstrap.class = "Bootstrap"
appnamespace = "Application"
resources.frontController.controllerDirectory = APPLICATION_PATH "/controllers"
resources.frontController.params.displayExceptions = 0
resources.layout.layoutPath = APPLICATION_PATH "/layouts/scripts/"
resources.view[] =
resources.db.adapter = "PDO_MYSQL"
resources.db.isDefaultTableAdapter = true
resources.db.params.dbname = "database"
resources.db.params.charset = "utf8"
resources.db.params.host = "localhost"
resources.db.params.username = "root"
resources.db.params.password = "***********"
resources.session.save_path = APPLICATION_PATH "/../data/sessions"
resources.session.use_only_cookies = true

date.timezone = "Europe/Chisinau"

[staging : production]

[testing : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1

resources.db.adapter = "PDO_MYSQL"
resources.db.params.dbname = "database"
resources.db.params.charset = "utf8"
resources.db.params.host = "localhost"
resources.db.params.username = "root"
resources.db.params.password = "*********"
[development : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1
resources.frontController.params.displayExceptions = 1

resources.db.adapter = "PDO_MYSQL"
resources.db.params.dbname = "database"
resources.db.params.charset = "utf8"
resources.db.params.host = "localhost"
resources.db.params.username = "root"
resources.db.params.password = "*********" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:16:26.797

我已经解决了所有问题。实际上，我让 .htaccess 和 index.php 文件保持原样。正如我从其他用户的经验中了解到的那样，在服务器不允许修改 Document Root（最常见的情况 - 共享主机）的情况下，就会出现编辑 .htaccess 的必要性。这不是我的情况，所以我所要做的就是在服务器上编辑 PHP 设置。我对服务器上的 PHP 设置进行了以下修改： 1\. 我将 Document Root 更改为指向我的公用文件夹（在我的情况下是 /httpdocs/public/）；2\. 在服务器上的 PHP 设置中，最初 open_basedir 是 ROOT:/tmp （或其他），我已将此值更改为 DEFAULT；3\. 我在 PHP 设置 session.save_path 中进行了修改，并从我的 zend 项目中插入了会话目录的路径。最后我不得不删除所有文件并再次部署我的项目。为了解决所有问题，我已经查看了来自服务器的错误日志。祝你好运！

# c# - 在 WPF 中使用 BindingExpression 的最佳实践？

> ID：14146856
> 
> 赞同：1
> 
> 时间：2013-01-03T20:37:14.790
> 
> 标签：c#, wpf, data-binding, mvvm

我有一些 UI 元素在后面的代码中执行一些特定于 UI 的工作，然后更新数据上下文中的绑定。

WPF 元素：

```
 <TextBox Grid.Row="1"
             Text="{Binding PartNumber, UpdateSourceTrigger=Explicit}"
             Name="ui_partNumber"
             FontSize="35"
             VerticalContentAlignment="Center" />
    <Button Grid.Column="1"
            Grid.Row="1"
            Content="OK"
            Click="PartOKClick"
            FontSize="20"
            Width="150" /> 
```

后面的代码：

```
/// <summary>
/// Handle updating the view model with the part number
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
private void PartOKClick(object sender, RoutedEventArgs e) {

  //Get the textbox's binding expression
  BindingExpression be = ui_partNumber.GetBindingExpression(TextBox.TextProperty);

  if (Condition) {
    //Update part number binding
    be.UpdateSource();

    //Animate to next state
    InAnimate(ui_partGrid.Name);
    OutAnimate(ui_whichPartNumber.Name);
  }
  else {
    //Discard the text in the textbox 
    be.UpdateTarget();

    //Animate to notification state
    InAnimate(ui_invalidLocation.Name);
  }
} 
```

我的 ViewModel 中的属性如下所示：

```
public string PartNumber{
    get { return _partNumber; }
    set { _partNumber = value; OnPropertyChanged("PartNumber"); }
} 
```

我正在使用显式绑定，并且仅在检查结果时才更新源，否则我只是恢复到原始绑定。

问题是，这是明确使用绑定的最佳方式吗？如果我得到 100 个不同类型元素的 BindingExpression，我是否需要每次都手动完成？我能以更可重用的方式做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:55:29.807

如果我理解正确，您愿意检查输入的值`TextBox`并仅在绑定有效时才更新绑定，对吗？

幸运的是，WPF 有一个内置的错误处理过程，它比你在那里所做的要干净得多。你应该读一些关于`IDataErrorInfo`

[这篇文章很清楚如何使用它](http://tarundotnet.wordpress.com/2011/03/03/wpf-tutorial-how-to-use-idataerrorinfo-in-wpf/)

作为你的例子，你会有这样的事情：

WPF 元素：

```
<TextBox Grid.Row="1"
         Text="{Binding PartNumber, ValidatesOnDataErrors=True}"
         Name="ui_partNumber"
         FontSize="35"
         VerticalContentAlignment="Center" />
<Button Grid.Column="1"
        Grid.Row="1"
        Content="OK"
        Click="PartOKClick"
        FontSize="20"
        Width="150" /> 
```

在你的`ViewModel`，你应该有这个：

```
public string this[string columnName]
        {
            get
            {
                if (string.Equals(columnName, "PartNumber", StringComparison.OrdinalIgnoreCase) || columnName == string.Empty)
                {
                    // Here, IDataErrorInfo is checking the property "PartNumber" bound to your TextBox
                    if (this.IsPartNumberValid(ui_partNumber.Text))
                    {
                        // Not valid: return any error message (string.Empty = no error, otherwise it will be seen as not valid)
                        return "Not valid!";
                    }
                }
                return string.Empty;
            }
        } 
```

这应该为您解决问题：如果字符串“无效！” 返回时，`TextBox`将显示为红色边框，并且`Binding`不会更新

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T01:35:29.000

为什么你被迫使用显式绑定？为什么不在 ViewModel 中进行验证，然后仅在需要更新时触发 OnPropertyChanged("BindingParameter")？

像这样的东西（在VB中）：

```
Property prop as Object
  Get
   return _prop
  End Get 
  Set(ByVal value As Object)
    If your_validation_check(value) then
      _prop = value
      OnPropertyChanged("prop") 'INotifyPropertyChanged
    End If
  End Set 
End Property 
```

# java - 在 Java 中将字符串数组解析为 Arraylist

> ID：14146869
> 
> 赞同：0
> 
> 时间：2013-01-03T20:38:12.377
> 
> 标签：java, string, rest, arraylist

我正在从我的 Java 应用程序调用 RESTful Api，它为我提供以下格式的结果：

```
["Item1", "Item2" , "Item3"] 
```

如何将其解析为 ArrayList 对象？

代码：

```
 private String getResponseString(URI URL) {

    HttpClient client = new DefaultHttpClient();
    HttpContext context = new BasicHttpContext();
    HttpGet get = new HttpGet();
    get.setURI(URL);

    try {
        HttpResponse response = client.execute(get, context);
        return getASCIIContentFromEntity(response.getEntity());

    } catch (ClientProtocolException e) {
        Log.e(Static.DebugTag, e.getMessage());
        return null;
    } catch (IOException e) {
        Log.e(Static.DebugTag, e.getMessage());
        return null;
    }

}

private String getASCIIContentFromEntity(HttpEntity entity)
        throws IllegalStateException, IOException {
    InputStream in = entity.getContent();
    StringBuffer out = new StringBuffer();
    int n = 1;
    while (n > 0) {
        byte[] b = new byte[4096];
        n = in.read(b);
        if (n > 0)
            out.append(new String(b, 0, n));
    }
    return out.toString();
} 
```

现在我想创建另一个函数，它以字符串返回形式 getASCIIContentFromEntity() 作为参数并返回一个 Arraylist。

PS我在一个字符串对象中有响应。

PPS 标题可能会产生误导，因为我不知道该怎么称呼它。

期待中的感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:40:47.333

由于字符串似乎包含有效的[JSON](http://en.wikipedia.org/wiki/JSON)，因此您可以使用 JSON 解析器（例如[Gson](http://code.google.com/p/google-gson/)）来解析字符串。请参阅手册中的[数组示例](https://sites.google.com/site/gson/gson-user-guide#TOC-Array-Examples)和[集合示例](https://sites.google.com/site/gson/gson-user-guide#TOC-Collections-Examples)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:42:54.990

在 java.util.Arrays 中掠夺。

```
List<String> list = Arrays.asList(["Item1", "Item2", "Item3"]); 
```

# java - JSON encoding data for Android app

> ID：14146872
> 
> 赞同：4
> 
> 时间：2013-01-03T20:38:41.200
> 
> 标签：java, php, json

I'm trying to send JSON data from a php script to an Android app and the php script's output is different from what the Java app expects.

```
$data['sample']['txt']="hello world";
echo json_encode($data) // {"sample":{"txt":"hello world"}}
//above is incorrect, need {sample : [{txt:"hello world"}]} 
```

The incorrect format results in the following Java exception:

```
org.json.JSONException: Value {"txt":"hello world"} at sample of type org.json.JSONObject cannot be converted to JSONArray. 
```

Is there an argument of PHP's json_encode that I'm missing, or an alternative that would encode it properly?

Java code for async task:

```
public class RetrieveData extends AsyncTask<List<? extends NameValuePair>, Integer, List<String>> {

    protected List<String> doInBackground(List<? extends NameValuePair>... postData) {
        InputStream is = null;
        List<String> result = new ArrayList<String>();

        try {
            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost("http://192.168.72.2:10088/droid_test/test.php");
            httppost.setEntity(new UrlEncodedFormEntity(postData[0]));
            HttpResponse response = httpclient.execute(httppost);
            HttpEntity entity = response.getEntity();
            is = entity.getContent();

            BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
            StringBuilder sb = new StringBuilder();
            String line = null;
            while ((line = reader.readLine()) != null) {
                    sb.append(line + "\n");
            }
            reader.close();
            is.close();

            JSONObject JSONobj=new JSONObject(sb.toString());
            JSONArray JSONarr=JSONobj.getJSONArray("sample");

            for(int i = 0 ; i < JSONarr.length() ; i++){
                result.add(JSONarr.getJSONObject(i).getString("txt"));
            }

            }
        catch(Exception e) {
            result.add("ERROR "+e.toString());
        }

        return result;
    }

    protected void onPostExecute(List<String> result) {
            getHTTP(result);
    }

} 
```

getHTTP(result) just sets the value to a TextView, which is where the error is displaying. (or the response if I hard code the echo statement)

Solution:

```
JSONObject JSONobj=new JSONObject(sb.toString());
JSONObject JSONarr=JSONobj.getJSONObject("sample"); // made object per @digitaljoel's suggestion

for(int i=0; i<JSONarr.length(); i++) {
    result.add(JSONarr.getString("txt")); // getting a String, not another array/object *duh*
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T20:50:19.320

您展示的两个 JSON 示例都是有效的 JSON，这只是您的映射在每一端的问题。

您的 java 代码期望“样本”包含一个对象集合（列表或数组），其中每个对象都有一个 txt 字段。这就是为什么它在 JSON 中的对象值周围有 []。

您可以更改 java 端的映射以仅期望 sample 的单个值，或者您可以更改 php 代码，使 $data['sample'] 是一个具有单个元素的数组，该元素具有 'txt' = "hello world" .

如果您在 java 端包含映射，我可以提供帮助。如果您想在 php 端修复它，我相信一些 php 大师可以提供帮助。

编辑：

`JSONArray JSONarr=JSONobj.getJSONArray("sample");`要求一个数组。将其更改为 JSONObject，您应该一切顺利。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-03T20:42:06.680

解决问题的一种方法是执行以下操作...

```
<?php
    $json = preg_replace('/"([a-zA-Z]+[a-zA-Z0-9]*)":/', '$1:', json_encode($whatever));
?> 
```

虽然我怀疑问题出在你的 Java/Dalvik 代码上，因为你得到的 JSON 是完全合法的。查看[JSON-RPC 2.0 规范](http://www.jsonrpc.org/specification)中的示例。

[此页面](http://www.evanjbrunner.info/posts/json-requests-with-httpurlconnection-in-android/)上还有一个特定的 Android 示例也符合规范：

```
{"hash":{"attribute":"123"},"attribute":"value", …} 
```

# xml - 使用多个命名空间反序列化 xml

> ID：14146878
> 
> 赞同：1
> 
> 时间：2013-01-03T20:39:09.123
> 
> 标签：xml, vb.net, serialization, namespaces

如何反序列化具有多个命名空间的 xml？

我正在从 youtube 中提取 xml：[https ://gdata.youtube.com/feeds/api/users/OnlyChillstep?v=2](https://gdata.youtube.com/feeds/api/users/OnlyChillstep?v=2)

我可以得到 <title>、<summary>，但不能得到 <yt:location>

这是课程，我也尝试放置 ElementName:="yt:location" 没有成功

```
<Xml.Serialization.XmlRoot(elementname:="entry", namespace:="http://www.w3.org/2005/Atom")> _
Public Class YoutubeFeed

    <XmlElement(ElementName:="title")> _
    Public title As String

    <XmlElement(ElementName:="location")> _
    Public location As String

End Class

    Dim requestUri2 As String = "https://gdata.youtube.com/feeds/api/users/OnlyChillstep?v=2"
    Dim request2 As HttpWebRequest = DirectCast(WebRequest.Create(requestUri2), HttpWebRequest)
    Dim resultSet2 As YoutubeFeed

    Using response2 As WebResponse = request2.GetResponse()
        Using responseStream As Stream = response2.GetResponseStream()
            Dim serializer As New XmlSerializer(GetType(YoutubeFeed))
            resultSet2 = DirectCast(serializer.Deserialize(responseStream), YoutubeFeed)
        End Using
    End Using

    Console.WriteLine(resultSet2.title)
    Console.WriteLine(resultSet2.location) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T21:19:54.010

“yt:location”意味着您必须在元素定义中包含以“yt”为别名的命名空间。你有没有尝试过这样的事情？

```
<XmlElement(elementname="location" namespace="[yt's URI <- look in the xml for a xmlns:yt=blah]")> 
```

**更新** 从链接中，您可以应对这些命名空间：

```
xmlns='http://www.w3.org/2005/Atom' 
xmlns:media='http://search.yahoo.com/mrss/' 
xmlns:gd='http://schemas.google.com/g/2005' 
xmlns:yt='http://gdata.youtube.com/schemas/2007' 
```

# c++ - Why is it not possible to wait for a Qt process to finish in a static destructor?

> ID：14146879
> 
> 赞同：6
> 
> 时间：2013-01-03T20:39:11.063
> 
> 标签：c++, qt

The following piece of code starts a process that takes one second to finish, and subsequently waits for that process to finish before exiting. For some reason, the following code hangs in `p->waitForFinished()` even though the process did finish.

```
#include <QtCore/QProcess>    

class A
{
  public:
    A():
        p(0)
    {
    }

    ~A()
    {
        p->waitForFinished();
        delete p;
    }

    void start()
    {
        p = new QProcess(0);
        p->start("sleep 1");
    }

    QProcess *p;
};

int main(void)
{
  static A a;
  a.start();

  return 0;
} 
```

However, as soon as `a` is not declared statically, but as follows:

```
A a; 
```

the `waitForFinished()` call succeeds. Is this a Qt bug, or is this expected behavour? My suspicion is that some kind of logic required to detect whether an application successfully finished is already destroyed once the destructor of `A` is called.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-03T20:54:50.477

您已尝试清理由创建的线程`QProcess`两种不同方式创建的线程，所以这是您的程序中的一个错误。

您已经通过从返回来分离线程`main`（这会终止进程中的所有线程，如果它们是可连接的，则将它们分离）。

`QProcess`你已经通过加入它来清理线程`waitForFinished`.

你可以分离一个线程，也可以加入它，但你不能两者都做，即使是间接的。显然，分离获胜，连接挂起。

这很可能是因为`QProcess`使用了它自己的终止信号，而不是线程库中内置的终止信号。所以 return from`main`在它可以发送终止信号之前终止线程，留下`waitForFinished`函数等待永远不会发送的信号。

作为一般规则，线程不应在构造函数中创建，也不应在析构函数中清除。这主要是因为这些操作的时间安排需要比可能的更明确的控制。并且它们不应该在`main`开始之前创建，也不应该在返回之后清理`main`- 再次因为您需要控制这些事情发生的上下文。

# python - limit the maximum amount of memory sqlite3 uses

> ID：14146881
> 
> 赞同：0
> 
> 时间：2013-01-03T20:39:23.347
> 
> 标签：python, sqlite

I am using sqlite3 in python, the program runns in different threads. Sqlite3 resides only in one thread. After a while the sqlite3 thread takes ot much memory.

How can I limit the maximum amount of memory sqlite3 uses?

What are rules of tumb about the maximal memory size?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:56:44.117

您可以将 PRAGMA 语句传递给游标对象以更改当前会话的数据库行为。

> PRAGMA 语句使用与其他 SQLite 命令（例如 SELECT、INSERT）相同的接口发出

```
>>> import sqlite3
>>> conn = sqlite3.connect(FILENAME)
>>> cur = conn.cursor()
>>> cur.execute("PRAGMA cache_size = -512") # Negative value means use N * 1024 bytes of memory.
<sqlite3.Cursor object at 0x01F14260> 
```

来自 SQLite 文档：[http ://www.sqlite.org/pragma.html#pragma_cache_size](http://www.sqlite.org/pragma.html#pragma_cache_size)

# matlab - What is the fastest way to convert a set of onset/offset times into a sampled square wave?

> ID：14146882
> 
> 赞同：1
> 
> 时间：2013-01-03T20:39:24.597
> 
> 标签：matlab

I have a `Mx2` matrix, named `events` where each row contains the onset and offset times of non-overlapping events. I'd like to construct a continuously sample signal that is equal to 1 for all points that are contained without any of the event times. I know the timestamps at which I'd like to sample my signal.

For example given the two variables `eventTimes` and `ts`:

```
eventTimes = ...
[1 3;
 6 7;
 9 10];

ts = 1:10; 
```

The resulting binary signal would be

```
binarySignal = [1 1 1 0 0 1 1 0 1 1]; 
```

Current I solve this problem using anonymous function and closures, but its slow for very large data sets:

```
tmpFun = @(x) (x>=eventsTimes(:,1) & x<eventTimes(:,2));
binarySignal = cell2mat( arrayfun(tmpFun, ts, 'UniformOutput', 0) );
binarySignal = sum(binarySignal); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T20:42:39.083

在适当的偏移量处将第一列转换为 1，将第二列转换为 -1；然后cumsum。

```
%% something like 
ts(eventTimes(:,1))=1; ts(eventTimes(:,2)+1)=-1; ts=cumsum(ts); 
```

# java - How can i open a window popup in Servlet and then Redirect a Page

> ID：14146883
> 
> 赞同：3
> 
> 时间：2013-01-03T20:39:25.260
> 
> 标签：java, javascript, servlets, popup

I want to open a popup window on calling a servlet and then want to redirect servlet to some `.jsp` page.

This is what i've done:

```
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // TODO Auto-generated method stub
        PrintWriter out = response.getWriter();
        out.println("<html><body>");
        out.println("<script type=\"text/javascript\">");
        out.println("window.open(\"pageA.jsp\")");
        out.println("</script>");
        out.println("</body></html>");
        response.sendRedirect("pageB.jsp");
    } 
```

This code will only popup window when the `response.sendRedirect("error.jsp");` is not present or commented. Currently with this code, it is not popping a window and directly redirecting this page to `error.jsp`

How can i do both of the above things at the same time?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T21:14:53.943

您可以使用 JavaScript 来解决问题。例如：

```
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    PrintWriter out = response.getWriter();
    out.println("<html><body>");
    out.println("<script type=\"text/javascript\">");
    out.println("var popwin = window.open(\"pageA.jsp\")");
    out.println("setTimeout(function(){ popwin.close(); window.location.href='pageB.jsp';},5000)");
    out.println("</script>");
    out.println("</body></html>");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T05:05:49.203

而不是使用重定向页面`sendRedirect`，使用

`window.location.href = 'pageB.jsp'`

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-04T04:52:35.047

你可以调用一个jsp页面而不是servlet，并且可以使用一个jQuery插件thickbox

[http://thickbox.net/](http://thickbox.net/)

# windows - Window doesn't show up (x86 ASM, Windows)

> ID：14146884
> 
> 赞同：1
> 
> 时间：2013-01-03T20:39:26.837
> 
> 标签：windows, winapi, assembly, x86, fasm

I'm trying to open a window with a listbox in there. Nothing happens though, it stays open for about 5 seconds in Windows' task manager and then closes.

I'm using Flat Assembler ([http://flatassembler.net/](http://flatassembler.net/)) to assemble and link my program.

```
 format PE GUI 4.0
    entry Start
    jp Start
    include 'win32a.inc'

    library kernel, 'KERNEL32.DLL', \
            user,   'USER32.DLL',   \
            gdi,    'GDI32.DLL'

    import kernel,\
           GetModuleHandle,  'GetModuleHandleA',\
           ExitProcess,      'ExitProcess'

    import user,\
           RegisterClass,    'RegisterClassA',  \
           CreateWindowEx,   'CreateWindowExA', \
           DefWindowProc,    'DefWindowProcA',  \
           SetWindowLong,    'SetWindowLongA',  \
           RedrawWindow,     'RedrawWindow',    \
           GetMessage,       'GetMessageA',     \
           TranslateMessage, 'TranslateMessage',\
           DispatchMessage,  'DispatchMessageA',\
           SendMessage,      'SendMessageA',    \
           LoadCursor,       'LoadCursorA',     \
           LoadIcon,         'LoadIconA',       \
           LoadMenu,         'LoadMenuA',       \
           GetClientRect,    'GetClientRect',   \
           MoveWindow,       'MoveWindow',      \
           SetFocus,         'SetFocus',        \
           MessageBox,       'MessageBoxA',     \
           PostQuitMessage,  'PostQuitMessage', \
           ShowWindow,       'ShowWindow'

    import gdi,\
           DeleteObject,     'DeleteObject'

    MENU_FILE_OPEN  = 101
    MENU_FILE_EXIT  = 102
    MENU_HELP_ABOUT = 901

Start:
    invoke GetModuleHandle, $00
    mov    [wc.hInstance],  eax
    invoke LoadIcon,        eax, $11
    mov    [wc.hIcon],      eax
    invoke LoadCursor,      $00, IDC_ARROW
    mov    [wc.hCursor],    eax
    invoke RegisterClass,   wc
    test   eax,             eax
    jz     Error

    invoke LoadMenu, [wc.hInstance], $25
    invoke CreateWindowEx, $0, str_win_class, str_title,\
                           WS_VISIBLE + WS_OVERLAPPEDWINDOW, $20, $20\
                           $100, $da, $0, eax, [wc.hInstance], $0
    mov    [hWnd], eax
    test   eax, eax
    jz     Error

    invoke ShowWindow, hWnd, SW_SHOWNORMAL

MessageLoop:
    invoke GetMessage, message, NULL, $0, $0
    cmp    eax, $1
    jb     EndLoop
    jne    MessageLoop
    invoke TranslateMessage, message
    invoke DispatchMessage,  message
    jmp    MessageLoop

Error:
    invoke MessageBox, NULL, str_error_open, str_error_title,\
                       MB_ICONERROR + MB_OK

EndLoop:
    invoke ExitProcess, [message.wParam]

proc WindowProc hWnd, wMsg, wParam, lParam
    push   ebx esi edi
    cmp    [wMsg], WM_CREATE
    je     .wmcreate
    cmp    [wMsg], WM_SIZE
    je     .wmsize
    cmp    [wMsg], WM_SETFOCUS
    je     .wmsetfocus
    cmp    [wMsg], WM_COMMAND
    je     .wmcommand
    cmp    [wMsg], WM_DESTROY
    je     .wmdestroy

  .defwndproc:
    invoke DefWindowProc, [hWnd], [wMsg], [wParam], [lParam]
    jmp    .finish

  .wmcreate:
    invoke GetClientRect, [hWnd], client
    invoke CreateWindowEx, WS_EX_CLIENTEDGE, str_listbox, $0, WS_VISIBLE +    \
                           WS_CHILD + WS_VSCROLL + ES_AUTOVSCROLL,            \
                           [client.left], [client.top], [client.right],       \
                           [client.bottom], [hWnd], $0, [wc.hInstance], $0
    or     eax, eax ; To check if EAX equals zero
    jz     .failed
    mov    [listHWnd], eax
    xor    eax, eax
    jmp    .finish

  .failed:
    or     eax, -1
    jmp    .finish

  .wmsize:
    invoke GetClientRect, [hWnd], client
    invoke MoveWindow, [listHWnd], [client.left], [client.top], [client.right],\
                       [client.bottom], $1
    xor    eax, eax
    jmp    .finish

  .wmsetfocus:
    invoke SetFocus, [listHWnd]
    xor    eax, eax
    jmp    .finish

  .wmcommand:
    mov    eax, [wParam]
    and    eax, $ffff
    cmp    eax, MENU_FILE_OPEN
    je     .open
    cmp    eax, MENU_FILE_EXIT
    je     .wmdestroy
    cmp    eax, MENU_HELP_ABOUT
    je     .about
    jmp    .defwndproc

  .open:
    ; TODO Ask the user which file to open
    invoke MessageBox, [hWnd], str_info_todo, str_title_todo,                 \
                       MB_ICONINFORMATION + MB_OK
    xor    eax, eax
    jmp    .finish

  .about:
    invoke MessageBox, [hWnd], str_about_text, str_about_title, MB_OK
    xor    eax, eax
    jmp    .finish

  .wmdestroy:
    invoke PostQuitMessage, $0
    xor    eax, eax

  .finish:
    pop    edi esi ebx
    ret
endp

    str_title       db 'MegaChip8 Emulator', $00
    str_error_title db 'Error', $00
    str_error_open  db 'Couldn', $27, 't open window!', $00
    str_win_class   db 'MEGACHIP8', $00
    str_listbox     db 'LISTBOX', $00
    str_info_todo   db 'This function is still on the to-do list.', $00
    str_title_todo  db 'To-Do', $00
    str_about_title db 'About MegaChip8 Emulator', $00
    str_about_text  db 'This emulator is written by Sijmen "Vijfhoek" Schoon.',\
                       $0d, $0a, 'All rights reserved.', $00

    message MSG
    wc WNDCLASS 0, WindowProc, 0, 0, NULL, NULL, NULL, COLOR_BTNFACE + 1,\
                NULL, str_win_class
    client RECT

    hWnd dd ?
    listHWnd dd ? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T10:00:58.313

好吧，由于我也使用FASM，因此尝试自己找出问题所在会更简单。您显然忘记了声明部分。因此，您没有“导入”部分 => Windows 不会为您绑定 DLL。这是正确的代码：

```
format PE GUI 4.0
entry Start
include 'win32a.inc'

section '.idata' import data readable writeable

library kernel, 'KERNEL32.DLL', \
        user,   'USER32.DLL',   \
        gdi,    'GDI32.DLL'

import kernel,\
       GetModuleHandle,  'GetModuleHandleA',\
       ExitProcess,      'ExitProcess'

import user,\
       RegisterClass,    'RegisterClassA',  \
       CreateWindowEx,   'CreateWindowExA', \
       DefWindowProc,    'DefWindowProcA',  \
       SetWindowLong,    'SetWindowLongA',  \
       RedrawWindow,     'RedrawWindow',    \
       GetMessage,       'GetMessageA',     \
       TranslateMessage, 'TranslateMessage',\
       DispatchMessage,  'DispatchMessageA',\
       SendMessage,      'SendMessageA',    \
       LoadCursor,       'LoadCursorA',     \
       LoadIcon,         'LoadIconA',       \
       LoadMenu,         'LoadMenuA',       \
       GetClientRect,    'GetClientRect',   \
       MoveWindow,       'MoveWindow',      \
       SetFocus,         'SetFocus',        \
       MessageBox,       'MessageBoxA',     \
       PostQuitMessage,  'PostQuitMessage', \
       ShowWindow,       'ShowWindow'

import gdi,\
       DeleteObject,     'DeleteObject'

MENU_FILE_OPEN  = 101
MENU_FILE_EXIT  = 102
MENU_HELP_ABOUT = 901

section '.text' code readable executable

Start:
invoke GetModuleHandle, $00
mov    [wc.hInstance],  eax
invoke LoadIcon,        eax, $11
mov    [wc.hIcon],      eax
invoke LoadCursor,      $00, IDC_ARROW
.... 
```

当没有声明部分时，FASM 添加一个 - “.flat” 以使文件正常 PE。但它没有导入标志。这就是设置断点出现问题的原因。

# c# - plugin architecture .net maf or mef

> ID：14146886
> 
> 赞同：2
> 
> 时间：2013-01-03T20:39:28.173
> 
> 标签：c#, .net, plugins, mef, maf

I am currently working in a **game platform application**. I want to be able to easily add new games to it, but the games should be comply with a particular contract :

*   The games must have some *required methods*
*   They must receive some *events provided by the main program*
*   They must be able to *send some data back* to the program
*   It would be wonderful if it is easy for external developers to make games for the platform, just by having knowledge of the interface

I read some questions like **MEF vs MAF**, and at first I would think that *MAF is better* for me, but I am not sure of that. Plus, I think I could even make some kind of homemade system like, compiling games as DLLs and retrieve them at runtime.

MAF seems good because of the *isolation*, but since I am not really working with little add-in, and as I read, *MAF is heavy and lacks speed*, I have many doubts of what I should use.

Should I try MAF, even if it can be slow, and hard to develop, and does it really suits to what I am doing ?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T20:57:33.093

这可能不是您的完整答案，但我会加入我确实有经验的 MEF（我对 MAF 没有真正的经验）。MEF 有很多优点，我认为它们适合您的需求。

MEF 是轻量级的，而且非常易于使用。它提供了依赖注入。

发现的东西很容易使用。只需创建您的目录，您就可以开始运行了。

MEF 使插件体系结构变得非常简单。我完全同意了。

虽然 MAF 可以提供隔离，但您必须使东西可远程调用以跨应用程序域调用，这很麻烦。为了防止未处理的异常退出您的主应用程序，您必须在它们自己的进程中创建加载项，这有其自身的局限性。例如，如果您想在加载项之间共享 DLL，则它们需要与共享 DLL 位于同一目录中，或者共享 DLL 需要位于 GAC 中。

# ssis - Flat file with dynamic columns mapping to different tables in sql database

> ID：14146891
> 
> 赞同：0
> 
> 时间：2013-01-03T20:39:55.183
> 
> 标签：ssis

I am trying to work on a scenario where I have a flat file with uneven number of columns and the data from the flat file should be sent to multiple sql tables.

**Example flat file sample**

Header segment A , B , C

Start segment A, B

End segment A, C , D, E , F

Trailer segment T, B, S

**flat file -> Database tables**

**T1** gets columns from start segment (say B)

**T2** gets columns from end segment (say C, D, E, F) How to go around this using SSIS?

Thanks in advance.

# jquery - Using groups with jquery form validation. How?

> ID：14146893
> 
> 赞同：4
> 
> 时间：2013-01-03T20:40:02.830
> 
> 标签：jquery, jquery-validate

I've been reviewing the list of options available for the jquery form validation plugin ([http://docs.jquery.com/Plugins/Validation/validate#toptions](http://docs.jquery.com/Plugins/Validation/validate#toptions)). I'm tying to understand how the option **groups** work. The only code available in the official (?) website is:

```
// Use a table layout for the form, placing error messages in the next cell after the input.
$("#myform").validate({
  groups: {
    username: "fname lname"
  },
  errorPlacement: function(error, element) {
     if (element.attr("name") == "fname" 
                 || element.attr("name") == "lname" )
       error.insertAfter("#lastname");
     else
       error.insertAfter(element);
   },
   debug:true
 }) 
```

I understand that they are creating a group called "username" that groups two elements in a form: "fname" and "lname", but how is that groupd used? Actually, the first question I have is: what are the groups for? I thought it was to instruct the plugin to handle the elements in a group as a single unit and to also display a single error in case any of the elements trigger one (for example, if the two textboxes are marked as required, using the **rules** element, and if a value is missing in any of the two or the two of them then a single error label is displayed instead of two if the two elements have errors), but I've been trying with several examples and have not been able to get it work in this way. So, what are they for? how should I use them?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-03T21:01:03.637

该`groups`选项所做的总和是只为组内的所有事物报告一条错误消息。在给定的示例中，如果您没有对`fname`and`lname`和 both 进行分组，那么您将收到两条错误消息。与组，你只得到一个。该组的两个元素仍然是必需的。

听起来您正确理解了这一点，但是很难说出为什么您没有使该示例起作用。使用此 HTML：

```
<form id="myform">
  First Name: <input type="text" name="fname" id="fname"/><br>
  Last Name: <input type="text" name="lname" id="lname"/><br>

    <input type="submit"/>
</form>​ 
```

这个验证代码：

```
$("#myform").validate({
    rules: {
        fname: { required: true },
        lname: { required: true }
    },
  groups: {
    username: "fname lname"
  },
  errorPlacement: function(error, element) {
     if (element.attr("name") == "fname" 
                 || element.attr("name") == "lname" )
       error.insertAfter("#lname");
     else
       error.insertAfter(element);
   }
 })​ 
```

在我看来没问题：http: [//jsfiddle.net/ryleyb/cbJj6/](http://jsfiddle.net/ryleyb/cbJj6/)

我帮助某人的一个更复杂的例子是：[使用 jQuery 验证插件来检查是否选择了一个或多个复选框（具有不同的名称）](https://stackoverflow.com/questions/13692061/using-the-jquery-validate-plugin-to-check-if-one-or-more-checkboxes-with-differ)
最终，该问题的组部分要求一组复选框中的一个复选框是检查，如果不是，则只需要一条消息。

# wcf - 使用 ArrayOfint 参数使用 wcf Web 服务

> ID：14146897
> 
> 赞同：0
> 
> 时间：2013-01-03T20:40:11.360
> 
> 标签：wcf, coldfusion

我正在尝试使用 WCF 网络服务。

`<cfdump>`将函数显示为

```
getVwEmpByLocs(com.microsoft.schemas._2003._10.serialization.arrays.ArrayOfint) 
```

**更新：**

```
<cfset wsUser = createobject("webservice", "http://xxxxxxx/cardService.svc?wsdl")>
<cfdump var="#wsUser#">

<cfset locationID = []>
<cfset locationID[1] = 2092>
<cfset stResult = wsUser.GetVwEmpByLocs(javacast('int[]', locationID))> 
```

**错误：**

`Message argument type mismatch`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T21:08:41.350

首先看一下服务的WSDL对象是如何序列化的。创建 cf 组件，将其命名为 ArrayOfInt.cfc

```
component  displayname="ArrayOfint"
{
    property name="int" type="Array" notnull="True" getter="false" setter="false";
    this['int'] = ArrayNew(1);
    function init(){  return this; }
} 
```

像这样传递值

```
arrOfInt = createobject('component','ArrayOfInt').init();
arrOfInt.int[1] = 100;
arrOfInt.int[2] = 200;
getVwEmpByLocs(arrOfInt) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T17:15:04.087

在阅读了@Leigh 的评论和一点 Google'ing 之后，我发现了以下关于[Debugging ColdFusion Webservices](http://blog.daksatech.com/2011/04/debugging-coldfusion-webservices.html)的文章。对于这个问题（以及@Leigh 所指的内容）特别感兴趣的是编号 2 下的项目符号项（朝向页面底部）。如果引用的页面被删除，我将在此处包含该信息。

> 如果您有一段时间使用或作为参数类型`java.lang.IllegalArgumentException: argument type mismatch`调用 .Net Web 服务，那么很可能您没有正确定义数据类型。和会导致你相信.Net 期待一个数组。但请记住 ColdFusion 数组与 .Net 数组不同。如果您仔细查看 wsdl，您会注意到被定义为 complexType 名称。`ArrayOfInt``ArrayOfString``ArrayOfInt``ArrayOfString``ArrayOfInt`

```
<s:complexType name="ArrayOfInt">
<s:sequence>
<s:element minOccurs="0" maxOccurs="unbounded" name="int" type="s:int" />
</s:sequence>
</s:complexType> 
```

> CF 中的复杂类型映射到结构。此外，您会注意到这个复杂类型有一个 name="int" 的元素。现在，当 java 查看 wsdl 并创建存根类文件时，它会将这个元素重命名为“_int”。我的猜测是这样做是因为“int”是 Java 中的保留字，也是本机数据类型。那么这意味着要成功调用.Net webservice，你需要：

```
<cfset objGroupIds = StructNew()>
<cfset objGroupIds._int = ListToArray("627303")>
<cfset callResult = myObj.getUser(objGroupIds)> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T13:01:14.530

从参考的角度来看，有几件事可能会有所帮助......

[http://msdn.microsoft.com/en-us/library/kskex131%28v=vs.90%29.aspx](http://msdn.microsoft.com/en-us/library/kskex131%28v=vs.90%29.aspx) 数组数据类型实际上不是在 .Net 中的 Array 对象上预定义的，而是由数组元素的数据类型预定义的.

[http://msdn.microsoft.com/en-us/library/ff690589%28v=sql.105%29.aspx](http://msdn.microsoft.com/en-us/library/ff690589%28v=sql.105%29.aspx) 这是一个基本模式，它定义了数组参数可以包含的数据类型（例如 ArrayOfInt）。这似乎是由 wsdl 模式定义的。

在无法测试的情况下抓住稻草，如果您创建并传递一个隐式数组而不是尝试将值分配给特定索引会怎样。另一个问题可能是您正在尝试将数组转换为 java int 数据类型......不确定这是否可行。在将值分配给数组时可能想要进行强制转换。

```
<cfset stResult = wsUser.GetVwEmpByLocs([2092])>
or
<cfset locationID = [2092]>
<cfset stResult = wsUser.GetVwEmpByLocs(locationID)> 
```

# uml - OCL：如何为 max 操作编写前置条件和后置条件以从集合中找到最大值？

> ID：14146898
> 
> 赞同：1
> 
> 时间：2013-01-03T20:40:12.483
> 
> 标签：uml, preconditions, ocl, post-conditions

我正在尝试编写前置条件和后置条件来找到集合“col”的最大值。我不确定如何递归，所以我想知道是否有人可以提供帮助！

```
pre: true 
post: result = ... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T08:41:40.983

我会做什么：

```
pre:  not col.isEmpty()
post: col -> includes(result) and col -> forAll(a | a <= result) 
```

EDIT2：我与一些 OCL 专家讨论了这个问题。他们指出有必要`col -> includes(result)`在后置条件下。否则`result`可能是大于 的所有元素的任何值`col`，但不一定是 的元素`col`。

编辑：

后置条件意味着：对于 的每个元素`a`，操作在[OCL 规范 2.3.1](http://www.omg.org/spec/OCL/2.3.1/PDF/)的 第45 页上定义`col`是真的。它的语法是`a <= result``forAll`

```
collection->forAll( v | boolean-expression-with-v ) 
```

它的语义是：

*这个 forAll 表达式产生一个布尔值。如果布尔表达式对集合的所有元素都为真，则结果为真。如果 boolean-expression-with-v 对于集合中的一个或多个 v 为 false，则完整表达式的计算结果为 false。例如，在公司的背景下：*

例子：

```
 context Company
      inv: self.employee->forAll( age <= 65 )
      inv: self.employee->forAll( p | p.age <= 65 )
      inv: self.employee->forAll( p : Person | p.age <= 65 ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-04T10:27:09.200

帖子：结果= col -> any(a | col->forAll(a2 | a >=a2))

其中“any”返回满足条件的元素之一，即类似于选择但保证仅返回单个元素，如果集合中的多个元素满足条件则随机选择；

"any" 中的条件通过与所有其他元素进行比较来保证所选元素 "a" 是集合中的最大值

另请查看此[OCL 教程](http://modeling-languages.com/object-constraint-language-ocl-a-definitive-guide/)。事实上，OCL 在处理聚合和其他类型的统计函数方面的局限性是这种语言的开放问题之一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T18:37:02.807

OCL 定义`Collection::max()`为

```
post: result = self->iterate( elem; acc : T = self.first() | acc.max(elem) ) 
```

其中*“元素支持的最大操作必须采用 T 类型的一个参数，并且是关联的和可交换的”*。

我知道它应该是 post: result = self->iterate(elem; acc : T = self.asSequence()->first() | acc.max(elem) ) 因为`first()`没有为`Collection`.

该集合被转换为一个序列。累加器 ( `acc`) 用序列的第一个值初始化。迭代表达式将累加器更新为当前值`acc`和迭代器之间的最大值`elem`。如果集合为空，则结果为`self.first()`，即`invalid`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T20:49:09.230

如果我理解正确，那么这可能会有所帮助： http: [//math.hws.edu/eck/cs124/javanotes6/c4/s6.html#subroutines.6.1](http://math.hws.edu/eck/cs124/javanotes6/c4/s6.html#subroutines.6.1)

前提条件是在执行方法之前必须满足的条件。这主要是关于输入数据的一些断言，例如集合不为空。后置条件定义了方法完成后的真实情况。在您的情况下，这可以是例如：该方法返回的元素在给定集合中具有最大值。

# c# - Create column to calculate moving average

> ID：14146902
> 
> 赞同：0
> 
> 时间：2013-01-03T20:40:29.100
> 
> 标签：c#, sql-server, visual-studio-2012, moving-average

I created table using VS2012, C#. I want to add column that calculates moving averages for Cclose column.

Below is my code to create the table

```
 string cmdText = "CREATE TABLE [" + TblName + "]"
                 + "(Tticker char(6),"
                 + "Pper char(1),"
                 + "Ddate date,"
                 + "Ttime TIME,"
                 + "Oopen float(6),"
                 + "Hhigh float(6),"
                 + "Llow float(6),"
                 + "Cclose float(6),"
                 + "Vvol char(15))";
  SqlCommand cmd = new SqlCommand(cmdText, con);
  cmd.ExecuteNonQuery(); 
```

I want to add column to calculate MV for last three Cclose values. Appreciate your support..thanks.

# ruby-on-rails - phusion 乘客独立服务器不工作

> ID：14146904
> 
> 赞同：0
> 
> 时间：2013-01-03T20:40:40.143
> 
> 标签：ruby-on-rails, passenger

如果我使用以下命令运行 phusion：

```
rvmsudo passenger start -p 80 
```

[编辑] 输出是

```
>> rvmsudo passenger start -p 80
=============== Phusion Passenger Standalone web server started ===============
PID file: /home/user/site/rails-webpage/tmp/pids/passenger.80.pid
Log file: /home/user/site/rails-webpage/log/passenger.80.log
Environment: development
Accessible via: http://0.0.0.0/

You can stop Phusion Passenger Standalone by pressing Ctrl-C.
===============================================================================
/usr/local/rvm/gems/ruby-1.9.3-p362/gems/therubyracer-0.10.2/ext/v8/v8.so: [BUG]    Segmentation fault
ruby 1.8.7 (2011-06-30 patchlevel 352) [x86_64-linux] 
```

[\编辑]

在浏览器上，我得到一个乘客制作的页面，其中包含很多无用的错误。至少对我来说。

```
The application spawner server exited unexpectedly: Unexpected end-of-file detected.

Exception class:
PhusionPassenger::Rack::ApplicationSpawner::Error

Backtrace:
#   File    Line    Location
0   /var/lib/passenger-standalone/3.0.18-x86_64-ruby1.8.7-linux-gcc4.6.3-1002/support/lib/phusion_passenger/rack/application_spawner.rb 135 in `start'
1   /var/lib/passenger-standalone/3.0.18-x86_64-ruby1.8.7-linux-gcc4.6.3-1002/support/lib/phusion_passenger/spawn_manager.rb    253 in `spawn_rack_application'
2   /var/lib/passenger-standalone/3.0.18-x86_64-ruby1.8.7-linux-gcc4.6.3-1002/support/lib/phusion_passenger/abstract_server_collection.rb   132 in `lookup_or_add'
3   /var/lib/passenger-standalone/3.0.18-x86_64-ruby1.8.7-linux-gcc4.6.3-1002/support/lib/phusion_passenger/spawn_manager.rb    246 in `spawn_rack_application'
4   /var/lib/passenger-standalone/3.0.18-x86_64-ruby1.8.7-linux-gcc4.6.3-1002/support/lib/phusion_passenger/abstract_server_collection.rb   82  in `synchronize'
5   /var/lib/passenger-standalone/3.0.18-x86_64-ruby1.8.7-linux-gcc4.6.3-1002/support/lib/phusion_passenger/abstract_server_collection.rb   79  in `synchronize'
6   /var/lib/passenger-standalone/3.0.18-x86_64-ruby1.8.7-linux-gcc4.6.3-1002/support/lib/phusion_passenger/spawn_manager.rb    244 in `spawn_rack_application'
7   /var/lib/passenger-standalone/3.0.18-x86_64-ruby1.8.7-linux-gcc4.6.3-1002/support/lib/phusion_passenger/spawn_manager.rb    137 in `spawn_application'
8   /var/lib/passenger-standalone/3.0.18-x86_64-ruby1.8.7-linux-gcc4.6.3-1002/support/lib/phusion_passenger/spawn_manager.rb    275 in `handle_spawn_application'
9   /var/lib/passenger-standalone/3.0.18-x86_64-ruby1.8.7-linux-gcc4.6.3-1002/support/lib/phusion_passenger/abstract_server.rb  357 in `__send__'
10  /var/lib/passenger-standalone/3.0.18-x86_64-ruby1.8.7-linux-gcc4.6.3-1002/support/lib/phusion_passenger/abstract_server.rb  357 in `server_main_loop'
11  /var/lib/passenger-standalone/3.0.18-x86_64-ruby1.8.7-linux-gcc4.6.3-1002/support/lib/phusion_passenger/abstract_server.rb  206 in `start_synchronously'
12  /var/lib/passenger-standalone/3.0.18-x86_64-ruby1.8.7-linux-gcc4.6.3-1002/support/helper-scripts/passenger-spawn-server 99 
```

apache错误日志是：

```
[Thu Jan 03 20:14:47 2013] [notice] caught SIGTERM, shutting down
[Thu Jan 03 20:14:47 2013] [notice] Apache/2.2.22 (Ubuntu) Phusion_Passenger/3.0.18 configured -- resuming normal operations
[Thu Jan 03 20:14:53 2013] [error] [client 2.34.83.82] File does not exist: /var/www/favicon.ico
[Thu Jan 03 20:14:55 2013] [error] [client 2.34.83.82] File does not exist: /var/www/favicon.ico
[Thu Jan 03 20:23:46 2013] [error] [client 2.34.83.82] File does not exist: /var/www/favicon.ico
[Thu Jan 03 20:24:50 2013] [notice] caught SIGTERM, shutting down 
```

这让我发疯。我不知道从哪里开始。我在 ubuntu 12.04 上运行 rails 3.2，ruby 1.9.3-p362。

我想要的只是部署我的应用程序。

只是为了提供更多信息，即使它可能不相关，我尝试运行 apache-passenger-module。我所能做的就是显示标准的 apache 页面，就像没有 rails 一样。我添加了三行加上虚拟主机，但无济于事。厌倦了寻找原因并决定尝试独立服务器。但它也不起作用。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-03T23:21:13.823

我已经使用 rvm 安装了乘客。另外还有另一个版本的 ruby​​。我删除了另一个版本，卸载了乘客，然后使用重新安装了它

```
sudo gem install passenger 
```

它有效。

另外，安装后，我必须做

```
bundle install 
```

安装必须在 gemfile 上的乘客 gem。

# c - 带有 malloc 的二维数组

> ID：14146906
> 
> 赞同：1
> 
> 时间：2013-01-03T20:40:43.180
> 
> 标签：c

我正在尝试使用 calloc 和 malloc 来创建二维数组。到目前为止，我的逻辑是首先使用 calloc 创建一个整数指针数组，然后使用 malloc 来创建第二维。这是我的代码：

```
enter code here

    #include<stdio.h>
    #include<stdlib.h>

    int main()
    {
        int N,M,i=0,j=0;

        printf("Give the dimensions");
        scanf("%d%d",&N,&M);
        printf("You gave N: %d and M: %d\n",N,M);

        int **a=(int**)calloc(N,sizeof(int*));

        for(i=0; i<N; i++)
        {
            a[i]=(int*)malloc(M*sizeof(int));
        }

        printf("The array that was created resigns on addresses\n");
        for(i=0; i<N; i++)
        {
            for(j=0; j<M; j++)
            {
                printf("addr: %p\n",a[i,j]);
            }
        }
    } 
```

有了这个，我想确保我创建了我想要的数组。给出维度 N=2 和 M=2（只是一个例子），我取地址（例如）： (0,0): 0x00001, (0,1):0x00003, (1,0): 0x00001, (1 ,1): 0x00003。因此，我没有得到一个二维数组，而只是一个只有 2 个位置的简单数组。你能指出我的编码错误吗？没找到。。。:S

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T20:43:06.443

索引访问运算符的错误使用`[]`。您没有访问第 i 行和第 j 列，而是仅访问`j`元素，因为您使用了逗号运算符：

```
a[i,j] == a[j] 
```

相反，您必须访问给定的行，然后访问一个单元格：

```
a[i][j] 
```

请注意，这**不会**返回地址，而是`int`：

```
typeof a       == int **
typeof a[i]    == int *
typeof a[i][j] == int 
```

如果您仍想知道条目的地址，则必须使用`&a[i][j]`或`a[i]+j`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T20:43:14.493

```
printf("addr: %p\n",a[i,j]); 
```

那是

```
printf("addr: %p\n",a[j]); 
```

您在那里使用逗号运算符。

要访问 -th 数组的`j`-th 元素`i`，您可以使用

```
a[i][j] 
```

但这将是`int`此处，而不是指针，因此将在转换中`printf`调用未定义的行为。`%p`

# java - "Could not find class" in JUnit

> ID：14146907
> 
> 赞同：1
> 
> 时间：2013-01-03T20:40:44.197
> 
> 标签：java, linux, junit, junit4, aix

I am using AIX machine to run few JUnit tests. These tests work fine in eclipse using JUnit for Windows and Linux platforms. I am trying to run these tests using JUnit command line and I am getting following error

```
# java org.junit.runner.JUnitCore testName
JUnit version 4.8.1
Could not find class: testName

Time: 0.012

OK (0 tests) 
```

File is present at that location as testName.java. I have set my environment variables in /etc/profile file. These are my environment variables.

> export CLASSPATH=/usr/junit/junit-4.8.1.jar:/usr/junit/
> 
> export PATH=$PATH=$PATH:/usr/junit/junit-4.8.1.jar:/usr/junit/

On AIX machine when I try to test JUnit using following code, it gives me same failure.

```
# java org.junit.runner.JUnitCore org.junit.tests.AllTests
JUnit version 4.8.1
Could not find class: org.junit.tests.AllTests

Time: 0.012

OK (0 tests) 
```

AllTests class was not present in default location provided on JUnit website [http://junit.sourceforge.net/doc/faq/faq.htm#tests_1](http://junit.sourceforge.net/doc/faq/faq.htm#tests_1)

```
# find / -name "*AllTests*"
/usr/junit/org/junit/runners/AllTests.class 
```

What could be wrong?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:53:12.370

```
org.junit.tests.AllTests 
```

在错误的地方，它在这里

```
/usr/junit/org/junit/runners/AllTests.class 
```

它应该是

```
/usr/junit/org/junit/tests/AllTests.class 
```

# c# - SignalR 无法读取未定义的属性客户端

> ID：14146913
> 
> 赞同：54
> 
> 时间：2013-01-03T20:41:28.393
> 
> 标签：c#, signalr, signalr-hub, signalr.client

我正在尝试将 SignalR 添加到我的项目（ASPNET MVC 4）中。但我不能让它工作。

在下图中，您可以看到我收到的错误。 ![图片](../Images/200120df1741d4b521e30b8aa8081158.png) 我已经阅读了很多 stackoverflow 帖子，但没有一个可以解决我的问题。

这是我到目前为止所做的：

```
1) Ran Install-Package Microsoft.AspNet.SignalR -Pre
2) Added RouteTable.Routes.MapHubs(); in Global.asax.cs Application_Start()
3) If I go to http://localhost:9096/Gdp.IServer.Web/signalr/hubs I can see the file content
4) Added <modules runAllManagedModulesForAllRequests="true"/> to Web.Config
5) Created folder Hubs in the root of the MVC application
6) Moved jquery and signalR scripts to /Scripts/lib folder (I'm not using jquery 1.6.4, I'm using the latest) 
```

这是我的 Index.cshtml

```
<h2>List of Messages</h2>

<div class="container">
    <input type="text" id="message" />
    <input type="button" id="sendmessage" value="Send" />
    <input type="hidden" id="displayname" />
    <ul id="discussion">
    </ul>
</div>

@section pageScripts
{
    <!--Reference the SignalR library. -->
    <script src="@Url.Content("~/Scripts/jquery.signalR-1.0.0-rc1.min.js")" type="text/javascript"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script type="text/javascript" src="~/signalr/hubs"></script>
    <script src="@Url.Content("~/Scripts/map.js")" type="text/javascript"></script>
} 
```

这是我的 IServerHub.cs 文件（位于 Hubs 文件夹内）

```
namespace Gdp.IServer.Ui.Web.Hubs
{
    using Microsoft.AspNet.SignalR.Hubs;
    [HubName("iServerHub")]
    public class IServerHub : Hub
    {
        public void Send(string name, string message)
        {
            Clients.All.broadcastMessage(name, message);
        }
    }
} 
```

这是 map.js

```
$(function () {

    // Declare a proxy to reference the hub. 
    var clientServerHub = $.connection.iServerHub;

    // Create a function that the hub can call to broadcast messages.
    clientServerHub.client.broadcastMessage = function (name, message) {
        $('#discussion').append('<li><strong>' + name + '</strong>:&nbsp;&nbsp;' + message + '</li>');
    };

    // Get the user name and store it to prepend to messages.
    $('#displayname').val(prompt('Enter your name:', ''));

    // Set initial focus to message input box.  
    $('#message').focus();

    // Start the connection.
    $.connection.hub.start().done(function () {
        $('#sendmessage').click(function () {
            // Html encode display name and message. 
            var encodedName = $('<div />').text($('#displayname').val()).html();
            var encodedMsg = $('<div />').text($('#message').val()).html();

            // Call the Send method on the hub. 
            clientServerHub.server.send(encodedName, encodedMsg);

            // Clear text box and reset focus for next comment. 
            $('#message').val('').focus();
        });
    });
}); 
```

我看到的 SignalR 参考的 DLL 是：

1.  Microsoft.AspNet.SignalR.Core
2.  Microsoft.AspNet.SignalR.Owin
3.  Microsoft.AspNet.SignalR.SystemWeb

任何想法如何让它工作？由于脚本位于 /Script/lib 文件夹中，我应该进行任何更改吗？

**注意** 我正在按照[此处](http://blog.mirajavora.com/signalr-dependency-injection)找到的关于如何设置 Windsor Castle 以使其与 SignalR 一起使用的说明进行操作，而且似乎无法创建代理并且我遇到了同样的错误：

```
Cannot read property client of undefined 
```

表示未创建集线器的代理

这就是我在服务器中的方式

```
public class IncidentServerHub : Hub 
```

在客户端像这样

```
var clientServerHub = $.connection.incidentServerHub; 
```

同样，我可以在这里看到动态创建的文件：

```
/GdpSoftware.Server.Web/signalr/hubs 
```

那么，为什么没有创建代理呢？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2013-01-22T21:38:02.367

我通过将我的 js 代码从：更改为来解决了这个 `var myHub = $.connection.SentimentsHub;` 问题 `var myHub = $.connection.sentimentsHub;`

因此，如果您有一些类名为 TestHub 的集线器，则必须在 js 中使用 testHub（第一个字母为小写）名称

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2014-06-03T21:14:06.910

对于那些试图在包中添加生成的代理文件路径的人。

**不要在 BundleConfig.cs 中包含“~/signalr/hubs”**。

您可以在包中包含*JQuery.SignalR*：

```
bundles.Add(new ScriptBundle("~/bundles/signalr").Include(
                  "~/Scripts/jquery.signalR-{version}.js")); 
```

但是您需要在视图中添加*“/signalr/hubs”*：

```
@section Scripts {
    @Scripts.Render("~/bundles/signalr")
    @Scripts.Render("/signalr/hubs")
} 
```

我希望这有帮助。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-05-24T06:53:19.683

我有同样的错误消息，并通过修复我在集线器类的 [HubName] 属性中的错字解决了这个问题 - 它与客户端 javascript 中的属性不完全匹配。

C# 集线器类：

```
[HubName("gameHub")]
public class GameHub : Hub
{ 
```

客户端javascript：

```
var foo = $.connection.gameHub; 
```

“gameHub”必须相同。

hth

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-01-11T17:42:38.943

**对于 ASP.Net MVC 人员：**

检查您的`_Layout.cshtml`: 如果您在 之后调用 jquery 包`@RenderBody()`，您将收到此错误。

**解决方案：**只需将 移动`@Scripts.Render("~/bundles/jquery")`到头部部分**或**在脚本“部分”中编写所有信号器脚本

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-10-22T09:56:15.380

您的中心类必须定义为公共的。例如：

```
class ChatHub : Hub 
```

实际上应该是

```
public class ChatHub : Hub 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-01-03T21:58:43.780

好的，我找到了问题，我需要做的一件事是：

缺少这两个参考：

```
Microsoft.AspNet.SignalR.Hosting.AspNet
Microsoft.AspNet.SignalR.Hosting.Common 
```

现在，我包括他们获得 nuget 包：WebApiDoodle.SignalR 使用这两个。我的问题是为什么没有添加那些 Dll，我安装了 Nuget 包：Microsoft.AspNet.SignalR -Pre？

漏洞？

然后我在 global.asax.cs 中有这个

```
using SignalR; 
```

所以

```
RouteTable.Routes.MapHubs(); 
```

正在使用那个，我需要删除它并使用这个：

```
using Microsoft.AspNet.SignalR; 
```

所以 MapHubs 使用那个，并开始工作。

希望这对其他人有帮助。吉列尔莫。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-07-23T08:16:19.723

**您应该按正确的顺序**放置 SignalR 和 jQuery 脚本：

```
<script src="/Scripts/jquery-1.6.4.min.js" ></script>

<script src="/Scripts/jquery.signalR-1.1.4.js"></script>

<script src="/signalr/hubs"></script> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-04-19T14:39:22.393

确保添加

```
app.MapSignalR(); 
```

在 startup.cs 和 Configuration 方法中，像这样：

```
 public partial class Startup
    {
        public void Configuration(IAppBuilder app)
        {
            app.MapSignalR();
        }
    } 
```

> **对于 Asp.net 核心**

添加

```
services.AddSignalR(); 
```

在您的 startup.cs 中的 ConfigureServices 方法中

并添加

```
app.UseSignalR(routes =>
            {
                routes.MapHub<ChatHub>("/chatHub");
            }); 
```

在您的 startup.cs 中配置方法

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-12-14T13:48:38.253

让 Hub 类“公开”为我解决了这个问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-07-17T02:36:28.120

就我而言，我迷失`Microsoft.Owin.Host.SystemWeb.dll & Microsoft.Owin.Security.dll`了我的项目。添加对它们的引用后，该错误已解决。它现在正在工作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-12-30T03:36:50.883

很可能，可能是类中给出的错误名称，并且 JavaScript 中的引用是错误的。

```
var chat = $.connection.chatHub;   //did not work

var chat = $.connection.myHub; // this worked 
```

这是我的课

```
public class MyHub : Hub
{
    public void Send(string name, string message)
    {
        Clients.All.addNewMessageToPage(name, message);
    }
} 
```

# ruby - 抑制 Watir 中的自动关闭窗口

> ID：14146916
> 
> 赞同：1
> 
> 时间：2013-01-03T20:41:47.470
> 
> 标签：ruby, google-chrome, watir

我正在使用带有 Chromedriver 的 Watir 在某些网站上自动提交表单。我必须登录并提交多个表格。问题是，当我单击提交按钮时，页面会自动关闭，所以当我 goto('next_url') 时出现此错误：

/Users/jackz/.rvm/gems/ruby-1.9.3-p327/gems/selenium-webdriver-2.27.2/lib/selenium/webdriver/remote/response.rb:52:in `assert_ok': 'auto_id'不引用打开的选项卡（Selenium::WebDriver::Error::UnknownError）

Watir 实例仍然存在，但窗口已关闭。我每次都可以创建一个新实例，但是每次我都必须重新登录，这会花费更长的时间。

那么我该怎么做：

在同一个 Watir 实例中打开一个新窗口

或者

提交后禁止关闭窗口

```
require 'watir-webdriver'
@b = Watir::Browser.new :chrome
@b.goto(URL)
@b.buttons.first.click

#this is when the window closes
@b.goto(NEW_URL)
#then I get an error 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T17:23:44.167

我想出了我自己问题的答案。我可以使用 javascript 在 Watir 中打开一个新窗口：

```
b = Watir::Browser.new
b.execute_script("window.open()")
b.windows.last.use 
```

这将打开一个窗口，我可以在其中填写表格，然后当窗口自动关闭时，我仍然可以使用原始窗口。可能不是最好的解决方案，但它现在有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-15T08:34:44.403

如果您使用`chrome`. 否则，请根据您的浏览器进行相应修改。

这将使窗口保持打开状态，并且当前`watir`会话处于活动状态。

```
caps = Selenium::WebDriver::Remote::Capabilities.chrome("chromeOptions" => {'detach' => false})
browser = Watir::Browser.new :chrome 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-27T00:45:00.087

Mrityunjeyan 上面建议的方向是正确的，但是您需要更改一些内容才能使其正常工作。

```
caps = Selenium::WebDriver::Remote::Capabilities.chrome("chromeOptions" => {'detach' => true })
b = Watir::Browser.new('chrome', desired_capabilities: caps) 
```

在此处查看文档。 [https://sites.google.com/a/chromium.org/chromedriver/capabilities](https://sites.google.com/a/chromium.org/chromedriver/capabilities)

# c++ - Why the "ambigous symbol" error in VS2010 for the code below?

> ID：14146920
> 
> 赞同：2
> 
> 时间：2013-01-03T20:42:04.397
> 
> 标签：c++, stream, forward-declaration

This code compiles in VS2010, and I believe it does for any compiler.

```
#include <iosfwd>
using namespace std;
class ostream;
int main() {} 
```

The same happens with this code

```
#include <iosfwd>
using namespace std;
int main() { class ostream; } 
```

But this code generates error C2872: 'ostream' : ambiguous symbol

```
#include <iosfwd>
using namespace std;
class ostream;
int main() { class ostream; } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T20:44:51.357

在范围内命名了两个类`ostream`：`::std::ostream`和`::ostream`。如果要转发声明，则必须在正确的命名空间中进行：

```
#include <iosfwd>
using namespace std;
namespace std {
    class ostream;
}
int main() { class ostream; } 
```

无论如何，这在这种情况下不起作用，因为`ostream`它是 的 typedef `basic_ostream`，而不是单独的类。只需包含`iosfwd`标题，因为它向前声明了所有内容。

# javascript - window.close() 在离开主 html 后停止在 node-webkit 中工作

> ID：14146922
> 
> 赞同：2
> 
> 时间：2013-01-03T20:42:17.377
> 
> 标签：javascript, node-webkit

我在原型中有两个 html 文件。如果我打开其中任何一个，关闭按钮就可以完成这项工作。

```
<img  src="img/x-01.png" onclick="window.close()" /> 
```

在我导航到另一个 html 后，相同的代码示例停止工作。即使我通过浏览器的“返回”按钮返回上一页也不起作用。

怎么可能？我是js新手，所以有一些我不明白的概念吗？

由于代码分散在几个文件中，我上传[了一个精简的应用程序](https://dl.dropbox.com/u/834290/test/node-webkit-sample.7z)- 用于观察这种行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T19:46:12.143

`window.close()`只能由最​​初打开窗口的同一页面调用（否则第三方网页会随意关闭我们的窗口）。一旦你离开，你就会失去这种联系和能力。

# java - JLS 是否允许此指令重新排序？

> ID：14146923
> 
> 赞同：8
> 
> 时间：2013-01-03T20:42:24.260
> 
> 标签：java, jvm, memory-model, jls

根据 Java 语言规范（[示例 17.4-1](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4)），以下代码段（从 开始`A == B == 0`）...

```
Thread 1             Thread 2
--------             --------
r2 = A;              r1 = B;
B = 1;               A = 2; 
```

... 可能导致`r2 == 2`和`r1 == 1`。这是因为执行的结果`B = 1;`不取决于是否`r2 = A`已经执行，因此JVM可以自由地交换这两条指令的执行顺序。换句话说，规范允许以下交织：

```
Thread 1             Thread 2
--------             --------
B = 1;
                     r1 = B;
                     A = 2;
r2 = A; 
```

这显然导致`r2 == 1`和`r1 == 1`。

## 我的问题：

假设我们稍微调整一下这个例子：

```
Thread 1             Thread 2
--------             --------
r2 = A;              r1 = B;
monitorenter obj     monitorenter obj
monitorexit obj      monitorexit obj
B = 1;               A = 2; 
```

where`obj`是线程之间共享的引用。

**`r2 = A`重新排序是否`B = 1`仍然允许？**

* * *

JLS 说……

> *但是，允许编译器对任一线程中的指令重新排序，只要这不会影响该线程的单独执行。*

...这表明指令*仍可*能被交换。另一方面，以下声明

> *监视器上的解锁发生在该监视器上的每个后续锁定之前。*

表明在某些调度下，我们可能在两个线程中的语句之间存在发生前的关系，这可能不允许指令重新排序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T21:28:31.050

非正式地，这是不允许的。这被称为“蟑螂汽车旅馆模式”

[http://jeremymanson.blogspot.com/2007/05/roach-motels-and-java-memory-model.html](http://jeremymanson.blogspot.com/2007/05/roach-motels-and-java-memory-model.html)

特别是，不能跨同步块移动动作。

然而，在形式上，JMM 并没有谈到重新排序。在你的例子中，我们只能推断，

1.  在总同步顺序中，同步块 1 在同步块 2 之前，因此`r2=A`发生在之前`A=2`；必须为 0。但和`r2`之间没有约束；可以是 0 或 1。`B=1``r1=B``r1`

2.  或相反。`r1`必须为 0，`r2`可以是 0 或 2。

所以程序仍然包含数据竞争；尽管如此，我们可以推断`(r1,r2)`只能是（0,0），（1,0），（0,2）；不可能是 (1,2)

# php - 如何使用 PHP 对图像进行抗锯齿处理？

> ID：14146926
> 
> 赞同：0
> 
> 时间：2013-01-03T20:42:30.573
> 
> 标签：php, function, antialiasing

> **可能重复：**
> [从图像中删除白色背景并使其透明](https://stackoverflow.com/questions/8041703/remove-white-background-from-an-image-and-make-it-transparent)

我目前有一个从图像中删除白色背景的代码，它看起来像这样：

```
function transparent_background($filename, $color) 
{
    $img = imagecreatefrompng($_SERVER['DOCUMENT_ROOT'].'/'.$filename);
    $colors = explode(',', $color);
    $remove = imagecolorallocate($img, $colors[0], $colors[1], $colors[2]);
    imagecolortransparent($img, $remove);
    imagepng($img, $_SERVER['DOCUMENT_ROOT'].'/'.$filename);
}

transparent_background('test.png', '255,255,255'); 
```

但是，一旦出口，边缘就非常粗糙。这就是它的样子（请注意，这只是我的图像的一部分）：

[http://img211.imageshack.us/img211/97/2125c773e32c432b91e1127.png](http://img211.imageshack.us/img211/97/2125c773e32c432b91e1127.png)

我在该图像后面添加了黑色背景以更好地显示边缘。那么有没有办法可以在函数中添加一条线或编辑函数以使边缘更平滑/抗锯齿？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:53:29.770

没有简单的方法可以做到这一点。原始图像的边缘被抗锯齿到白色背景。当你去除纯白色时，你会在边缘附近留下很多接近白色的像素。当您在深色背景下看到这些像素时，它们会突出并看起来“粗糙”。如果源图像中没有透明背景，您将无法获得平滑的边缘。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:50:23.403

输出的最终结果取决于您正在导入的图像的初始图像质量。PHP 只能对在图像上绘制的元素进行抗锯齿处理。

一种解决方案，一种完全的大锤方法，将向上重新采样图像，然后再次向下采样。您的结果会因所讨论的图像而异，而且几乎总是不好。

针对您的特定问题的最佳解决方案是首先使用质量更好的导入图像。

# php - html提交按钮

> ID：14146927
> 
> 赞同：0
> 
> 时间：2013-01-03T20:42:34.053
> 
> 标签：php, html, button, submit, form-submit

我有这个代码

1.  文件搜索.php

```

`<html>
<head>
<script src="http://code.jquery.com/jquery-1.8.3.js"></script>
    <script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>

<script>

</script>
<?php
if(isset($_POST['bt_submit'])){
header('Location: accueil.php?region='); 
}

?>

<style>
body {
background-image: url(../images/paper_03.png);
}
form {
background-image: url(../images/paper_02.png);
}
</style>
</head>

<body>
<form name="search" method="post"   >
                          <form name="map" style="position: relative; top:10px; left:300px; width: 400px; height: 130px;">
jjjjjjjjjjjjjjjjj
                           </form>
                           <form name="advanced" style="position: relative; top:10px; left:300px; width: 400px; height: 130px;" action="blabla.php">
                                                     <form name="location" style="position: relative; top:10px; left:300px; width: 300px; height: 90px;">
                                                                          <div style="background-color:99FFFF"><font color="blue">Location</font></div>
                                                                          <table>
                                                                                   <tr>
                                                                                        <td>Region:   </td><td  ><select style="width:200px" name="region"> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                </select>  </td>
                                                                                   </tr>
                                                                                   <tr>
                                                                                        <td>City:   </td><td colspan="3"><input type="text" style="width:200px" name="city" />   </td>
                                                                                   </tr>
                                                                                   <tr>
                                                                                        <td>State/Province:   </td><td colspan="3"><select style="width:200px"> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                </select>  </td>
                                                                                   </tr>
                                                                                   <tr>
                                                                                         <td>Country:   </td><td colspan="3"><select style="width:200px" > 
                                                                                                                <option value="1">truc</option> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                </select>  </td>
                                                                                   </tr>

                                                                          </table>
                                                       </form>

                                                     <form name="keywords" style="position: relative; top:10px; left:300px; width: 400px; height: 50px;" >
                                                                           <div style="background-color:99FFFF"><font color="blue">Keywords</font></div>
                                                                            <table>
                                                                                   <tr>
                                                                                        <td colspan="2">Keywords:    </td><td ><input type="text" style="width:225px" name="keywords"  />   </td>
                                                                                   </tr>
                                                                            </table>       
                                                      </form>

                                                      <form name="company" style="position: relative; top:10px; left:300px; width: 400px; height: 50px;" >
                                                                            <div style="background-color:99FFFF"><font color="blue">Company</font></div>
                                                                            <table>
                                                                                    <tr>
                                                                                        <td>Company:   </td><td colspan="3"><select style="width:230px"> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                </select>  </td>
                                                                                   </tr>
                                                                            </table>
                                                       </form>

                                                       <form name="job_category"  style="position: relative; top:10px; left:300px; width: 400px; height: 50px;">
                                                                            <div style="background-color:99FFFF"><font color="blue">Job category</font></div>
                                                                            <table>
                                                                                    <tr>
                                                                                        <td>Job category:   </td><td colspan="3"><select style="width:210px"> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                </select>  </td>
                                                                                   </tr>
                                                                            </table>
                                                       </form>

                                                       <form name="dates"  style="position: relative; top:10px; left:300px; width: 400px; height: 50px;">
                                                                            <div style="background-color:99FFFF"><font color="blue">Dates</font></div>
                                                                            <table>
                                                                                    <tr>
                                                                                        <td>Date range:   </td><td colspan="3"><select style="width:225px"> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                <option value="1">truc</option> 
                                                                                                                </select>  </td>
                                                                                   </tr>
                                                                            </table>      
                                                        </form>

                           </form>
                            <input type="submit"  name="bt_submit"  value="Search Now" style="position: relative;  left:400px; width: 100px" />

</form>
</body>
</html>` 

此文件包含 php 和 html 代码。界面包含两个部分：第一个是表单，第二个是一组必须通过按钮提交的表单我的问题是当我单击提交按钮以验证表单重定向时没有工作，什么也没做。所以我需要知道

1.  为什么？
2.  我该如何解决这个错误？

            回答 #1

赞同：2

时间：2013-01-03T20:46:38.880

你只需要一个`<form>`。您可能希望使用`<fieldset>`元素将表单的各个部分组合在一起，但是通过使用多个表单，它们被完全分开处理。

            回答 #2

赞同：0

时间：2013-01-03T20:46:43.653

```
<?php
if(isset($_POST['bt_submit'])){
header('Location: accueil.php?region='); 
}
?> 
```

将此代码放在页面的顶部，甚至在一个 html 字母之前。已显示某些内容时，标题不起作用

            回答 #3

赞同：0

时间：2013-01-03T20:48:31.840

您不能有嵌套表单。另外，每个输入在您的代码中显然都是不同的形式。您必须对其进行更新以使其具有单一形式。

```

# php - 使用 void 元素作为分隔符处理 XML

> ID：14146933
> 
> 赞同：0
> 
> 时间：2013-01-03T20:42:48.937
> 
> 标签：php, xml, xpath

情况如下：我有一些表示长格式文档记录的 XML 文件，其中分页符用 void 元素表示：<pb />。

我想要做的是构建某种数据结构（数组很好），其中每个元素代表每个“页面”的有效 XML，由 pb void 元素（又名自关闭又名单例）分隔。

问题是， pb 元素可以（并且确实）出现在任何任意父节点内的任意嵌套级别。

我的想法是使用 XPath 来识别每个 pb 元素，然后以某种方式关闭所有元素的父标签 - 结束页面 - 并重新打开它们以开始下一页。我正在使用[PHP DOMXpath](http://php.net/manual/en/class.domxpath.php)。

下面是 XML 的示例：

```
<text id="foobar">
 <div type="zing" n="zee">
   <pb n=1 />
   <p>some text</p>
   <p>more text</p>
   <fw><pb n=2 />page 2</fw>
   <p>blah blah</p>
   <p>blah blah blah blah <fw><pb n=3 /></fw> blah</p>
 </div>
</text> 
```

这就是我想要将其转换为：

```
<text id="foobar">
 <div type="zing" n="zee">
   <p>some text</p>
   <p>more text</p>
   <fw></fw>
 </div>
</text>
<text id="foobar">
 <div type="zing" n="zee">
   <fw>page 2</fw>
   <p>blah blah</p>
   <p>blah blah blah blah <fw></fw>
  </div>
</text>
<text id="foobar">
 <div type="zing" n="zee">
   <fw></fw> blah</p>
 </div>
</text> 
```

任何人都想到了一种聪明或优雅的方式来做到这一点？

我现在拥有的是另一个循环内的递归循环，每次迭代都有多个 xpath 查询，而且它是 fuuuugly。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T22:14:06.270

到目前为止，这是我想出的。就像我说的，fuuuugly。

```
// Given an XML transcript, return an array of pages indexed by <pb> element definitions.
function transcript_to_pages($transcript) {
  $dom = new DOMDocument();

  // 1\. Compile the list of pagebreak DOM nodes we're looking for
  // 2\. Build a string of all their anscestors
  // 3\. chunk the transcript by pagebreaks
  // 4\. prepend the ancestor strings to each chunk.
  // 5\. build an array of the munged chunks
  $dom->loadHtml($transcript);
  $xpath = new DOMXPath($dom);
  $pbnodes = $xpath->query('//pb');

  $close_string = $open_string = '';
  $i = 0;
  $total = $pbnodes->length;
  foreach ($pbnodes as $pbnode) {
    $page = '';
    $string = $dom->saveXML($pbnode);
    list($page, $transcript) = split($string, $transcript, 2);
    // The first <pb> element should have appeared as the first element of the
    // transcript. This would produce a leading blank page, which we'll skip. 
    if ($i++ == 0) {
      continue;
    }
    if (!empty($open_string)) {
      $page = $open_string . $page;
    }
    $parent = $pbnode->parentNode;
    $close_string = $open_string = '';
    while (!empty($parent)) {
      $close_string .= "</$parent->tagName>";
      $open_tag = "<$parent->tagName";
      if (!empty($parent->attributes)) {
        foreach ($parent->attributes as $key => $value) {
          $val = str_replace('"', '&quot;', $value->value);
          $open_tag .= " $key=\"" . $val . '"';
        }
      }
      $open_tag .= '>';
      $open_string = $open_tag . $open_string;
      if ($parent->tagName == 'text' || empty($parent->parentNode)) {
        break;
      }
      $parent = $parent->parentNode;
    }
    $page .= $close_string;
    $pages[$string] = $page;
  }
  return $pages;
} 
```

# c# - JSON.NET 反序列化/序列化 JsonProperty JsonObject

> ID：14146937
> 
> 赞同：5
> 
> 时间：2013-01-03T20:43:06.667
> 
> 标签：c#, asp.net-mvc, json.net

我对使用 Newtonsoft JSON.NET 库进行反序列化/序列化有疑问：

我收到这个 json ：

```
 {
    "customerName" : "Lorem",
    "id": 492426
    "sequence": 1232132
    "type" : 3,
    "status" : 0,
    "streetNumber" : 9675,
    "streetName" : "Lorem",
    "suite" : null,
    "city" : "IPSUM",
    "provinceCode" : "QC",
    "postalCode" : "H1P1Z3",
    "routeNumber" : 0,
    "poBox" : 0,
    "streetType" : "CH",
    "userId" : 25,
    "streetDirection" : null,
    "countryCode" : "CA",
    "customerNickName" : "Lorem ipsum",
    "streetSuffix" : null,
    "contacts" : [ {
        "status" : 0,
        "telephone" : 4445555555,
        "extension" : 0,
        "email" : "webtest@test.com",
        "id" : 50,
        "fullName" : "name",
        "department" : "department"
    } ],
    "attribute" : {
      "nbrOfUse" : 1,
      "lastUse" : "2013-01-03T09:57:28-0500"
    }       
} 
```

我的问题是这部分：

```
 "attribute" : {
      "nbrOfUse" : 1,
      "lastUse" : "2013-01-03T09:57:28-0500"
    } 
```

在我的`address`课堂上，是否可以执行以下操作：

```
 [JsonProperty(PropertyName = "lastUse", ObjectName="attribute")]
    or [JsonProperty(PropertyName = "lastUse")][JsonObject(PropertyName = "attribute")]
    or something like this ...
    public DateTime? LastUse { get; set; } 
```

我不会使用`JObject.Parse(...)`，因为 json 非常大

我的课 ：

```
public class Address
{
    /// <summary>
    /// Gets or sets the id of the <see cref="Address" /> class.
    /// </summary>
    /// <value>
    /// id from index as400 for validating address with canada post
    /// Type Int64, The id.
    /// </value>
    [JsonProperty(PropertyName = "id")]
    public int Id { get; set; }

    /// <summary>
    /// Gets or sets the number of the <see cref="Company" /> class.
    /// </summary>
    /// <value>
    /// Type String, The number.
    /// </value>
    [JsonProperty(PropertyName = "streetNumber")]
    [Display(Name = "CompanyNumber", ResourceType = typeof(AccountModels))]
    //[MustBeEmptyIfAnotherIsNotEmpty("PoBox", ErrorMessageResourceType = typeof(GenericValidator), ErrorMessageResourceName = "MustBeEmptyIfAnotherIsNotEmpty")]
    public string Number { get; set; }

    /// <summary>
    /// Gets or sets the type of the street.
    /// </summary>
    /// <value>
    /// The type of the street.
    /// </value>
    [JsonProperty(PropertyName = "streetType")]
    [Display(Name = "StreetType", ResourceType = typeof(AccountModels))]
    //[MustBeEmptyIfAnotherIsNotEmpty("PoBox",false, ErrorMessageResourceType = typeof(GenericValidator), ErrorMessageResourceName = "MustBeEmptyIfAnotherIsNotEmpty")]
    public string StreetType { get; set; }

    /// <summary>
    /// Gets or sets the street of the <see cref="Company" /> class.
    /// </summary>
    /// <value>
    /// Type String, The street.
    /// </value>
    [JsonProperty(PropertyName = "streetName")]
    [Display(Name = "CompanyStreet", ResourceType = typeof(AccountModels))]
    [StringLength(50, ErrorMessageResourceType = typeof(GenericValidator), ErrorMessageResourceName = "Length", MinimumLength = 2)]
    //[MustBeEmptyIfAnotherIsNotEmpty("PoBox", ErrorMessageResourceType = typeof(GenericValidator), ErrorMessageResourceName = "MustBeEmptyIfAnotherIsNotEmpty")]
    public string Street { get; set; }

    [Display(Name = "StreetDirection", ResourceType = typeof(AccountModels))]
    [StringLength(2, ErrorMessageResourceType = typeof(GenericValidator), ErrorMessageResourceName = "Length", MinimumLength = 0)]
    public string StreetDirection { get; set; }

    [Display(Name = "StreetSuffix", ResourceType = typeof(AccountModels))]
    [StringLength(1, ErrorMessageResourceType = typeof(GenericValidator), ErrorMessageResourceName = "Length", MinimumLength = 0)]
    public string StreetSuffix { get; set; }

    /// <summary>
    /// Gets or sets the street suite of the <see cref="Company" /> class.
    /// </summary>
    /// <value>
    /// Type String, The street suite.
    /// </value>
    [JsonProperty(PropertyName = "suite")]
    [Display(Name = "CompanyStreetSuite", ResourceType = typeof(AccountModels))]
    [StringLength(50, ErrorMessageResourceType = typeof(GenericValidator), ErrorMessageResourceName = "Length", MinimumLength = 0)]
    //[MustBeEmptyIfAnotherIsNotEmpty("PoBox",false, ErrorMessageResourceType = typeof(GenericValidator), ErrorMessageResourceName = "MustBeEmptyIfAnotherIsNotEmpty")]
    public string StreetSuite { get; set; }

    /// <summary>
    /// Gets or sets the city of the <see cref="Company" /> class.
    /// </summary>
    /// <value>
    /// Type String, The city.
    /// </value>
    [Required]
    [JsonProperty(PropertyName = "city")]
    [Display(Name = "CompanyCity", ResourceType = typeof(AccountModels))]
    public string City { get; set; }

    /// <summary>
    /// Gets or sets the province of the <see cref="Company" /> class.
    /// </summary>
    /// <value>
    /// Type String, The province.
    /// </value>
    [Required]
    [Display(Name = "CompanyProvince", ResourceType = typeof(AccountModels))]
    [JsonProperty(PropertyName = "provinceCode")]
    public string Province { get; set; }

    /// <summary>
    /// Gets or sets the postal code of the <see cref="Company" /> class.
    /// </summary>
    /// <value>
    /// Type String, The postal code.
    /// </value>
    [JsonProperty(PropertyName = "postalCode")]
    [Display(Name = "CompanyPostalCode", ResourceType = typeof(AccountModels))]
    [PostalCode("Country", ErrorMessageResourceType = typeof(GenericValidator), ErrorMessageResourceName = "PostalCode")]
    public string PostalCode { get; set; }

    /// <summary>
    /// Gets or sets the country of the <see cref="Company" /> class.
    /// </summary>
    /// <value>
    /// Type String, The country.
    /// </value>
    [JsonProperty(PropertyName = "country")]
    [Display(Name = "Country", ResourceType = typeof(AccountModels))]
    public string Country { get; set; }

    // ....//

    /*record info*/
    [Display(Name = "modifyDate", ResourceType = typeof(Resources.Models.Address))]
    public DateTime ModifyDate { get; set; }

    [Display(Name = "endDate", ResourceType = typeof(Resources.Models.Address))]
    public DateTime? EndDate { get; set; } // when she deactivated

    [Display(Name = "lastUse", ResourceType = typeof(Resources.Models.Address))]
    public DateTime? LastUse { get; set; }

    [Display(Name = "nbrOfUse", ResourceType = typeof(Resources.Models.Address))]
    public int NbrOfUse { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:55:34.790

您需要为“属性”创建自定义类型，例如：

```
 public class Attribute {

        [JsonProperty(PropertyName = "nbrOfUse")]
        public int _nbrOfUse { get; set; }
        [JsonProperty(PropertyName = "streetType")]
        [Display(Name = "lastUse", ResourceType = typeof(AccountModels))]
        public string _lastUse { get; set; }

    } 
```

并在您的 Address 类中创建一个 Object of Attribute 类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-28T12:25:35.060

您可以使用的一种可能的解决方案（看起来有点笨拙）是在解析 JSON 字符串之前对其进行操作，例如使用正则表达式。

您将识别并替换

```
"attribute" : {
   "nbrOfUse" : 1,
   "lastUse" : "2013-01-03T09:57:28-0500"
 } 
```

和

```
"lastUse" : "2013-01-03T09:57:28-0500" 
```

然后，您的序列化程序将识别 DateTime？名为“lastUsed”的属性

# r - 在 R getGEO 上捕获异常

> ID：14146941
> 
> 赞同：0
> 
> 时间：2013-01-03T20:43:31.543
> 
> 标签：r, error-handling

我正在使用 R 和 GEOQuery 包来下载一组 GEO 配置文件。为此，我使用以下说明：

```
library(Biobase)
library(GEOquery)
gdsAcc<-getGEO('GDS1245',destdir=".") 
```

它将 GDS1245.soft.gz 下载到指定目录中。

问题是一些 GEO 配置文件已被删除，所以当我在循环中使用上述指令时，我得到了类似的东西：

```
gdsAcc<-getGEO('GDS450',destdir=".") 
```

在最后一种情况下，配置文件 GDS450 不存在，因此它会引发错误并且程序停止。我想知道如何捕获该错误，以便在配置文件不存在的情况下程序将继续寻找其他配置文件。

我的算法是这样的：

```
for (i in 1:length_GEO_profiles){
    disease<-GEOname
    gdsName<-paste("GDS",disease,sep="")
    gdsAcc<-getGEO(gdsName,destdir=".")
} 
```

有什么帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:56:41.653

你应该看看`try`和`tryCatch`。这是一个帮助您入门的示例：

```
for(i in 1:3) { 
  if(i == 1)
    gdsAcc <- try(getGEO('GDS450',destdir="."))
  cat(i, "\n")
} 
```

如果你想对错误做点什么，那么使用一个`if`语句：

```
if(class(gdsAcc) == "try-error") cat("HELP") 
```

**相关问题**

*   [R中的异常处理](https://stackoverflow.com/questions/2622777/exception-handling-in-r)
*   [相当于 R 中的“投掷”](https://stackoverflow.com/questions/1608130/equivalent-of-throw-in-r)
*   [捕获错误然后分支逻辑](https://stackoverflow.com/questions/2158780/r-catching-an-error-and-then-branching-logic)

# r - 重新排列数据框，以便将行剪切并粘贴为列

> ID：14146943
> 
> 赞同：2
> 
> 时间：2013-01-03T20:43:32.907
> 
> 标签：r, dataframe, reshape, data-manipulation

我不知道我是否通过标题解释了我的意图，但本质上我想**转换**

```
 mean    sd
v1  -32.72  0.565
v2  -50.47  1.543
v3  -30.17  0.9295
v4  -38.56  0.4541
g1  5.649   0.02509
g2  1.672   0.02992
g3  3.139   0.03507
g4  7.169   0.06703
y1  271.1   3.48
y2  123.7   1.81
y3  138.9   2.727
y4  405.5   4.396 
```

**至**

```
 v.mean v.sd    g.mean  g.sd    y.mean  y.sd
-32.72  0.565   5.649   0.02509 271.1   3.48
-50.47  1.543   1.672   0.02992 123.7   1.81
-30.17  0.9295  3.139   0.03507 138.9   2.727
-38.56  0.4541  7.169   0.06703 405.5   4.396 
```

我想这样做而不使用 for 循环。我觉得有一些`reshape`功能可以做到这一点。我有大量具有这种配置的数据集。所以，我想要一些**矢量化**解决方案......而且，长度可以是任何东西。这里，在示例数据中，序列长度为 4。另外，我对列名并不挑剔。我可以使用`names(dataframe)=c(...`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T22:26:05.933

确实有一个名为 的函数`reshape`。假设您的 data.frame 被命名为“数据”，请执行以下操作以获得您想要的结果：

```
data$group <- substr(rownames(data),1,1)
data$id <- substr(rownames(data),2,2)
result <- reshape(data, v.names=c("mean","sd"), idvar="id", timevar="group", direction="wide") 
```

有关详细信息，请参阅`?reshape`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T22:45:33.923

使用`reshap2`，我们应用`acast`在一个巧妙的融合数据中。

```
dat <- read.table(text ='v1  -32.72  0.565
v2  -50.47  1.543
v3  -30.17  0.9295
v4  -38.56  0.4541
g1  5.649   0.02509
g2  1.672   0.02992
g3  3.139   0.03507
g4  7.169   0.06703
y1  271.1   3.48
y2  123.7   1.81
y3  138.9   2.727
y4  405.5   4.396')
colnames(dat) <- c('var','mean','sd') 
```

首先我融化我的数据：

```
dat.m <- melt(dat)
Using var as id variables
   var variable     value
1   v1     mean -32.72000
2   v2     mean -50.47000
3   v3     mean -30.17000
4   v4     mean -38.56000
5   g1     mean   5.64900 
```

现在我想我需要拆分 var 列，以便在以后的列中只使用 var 的字母。通常我们使用 `ColSplit`但这里没有可见的模式，所以我手动创建列并应用`acast`

```
dat.m$vv <- substr(dat.m$var,1,1)
dat.m$key <- substr(dat.m$var,2,2)
acast(dat.m[,-1],id ~variable+vv)
  mean_g mean_v mean_y    sd_g   sd_v  sd_y
1  5.649 -32.72  271.1 0.02509 0.5650 3.480
2  1.672 -50.47  123.7 0.02992 1.5430 1.810
3  3.139 -30.17  138.9 0.03507 0.9295 2.727
4  7.169 -38.56  405.5 0.06703 0.4541 4.396 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T17:15:37.137

这是与@Theodore 的答案非常相似的方法。假设您的数据集称为“dat”：

```
reshape(cbind(dat, do.call(rbind, strsplit(rownames(dat), ""))), 
        idvar="2", timevar="1", direction = "wide")
#    2 mean.v   sd.v mean.g    sd.g mean.y  sd.y
# v1 1 -32.72 0.5650  5.649 0.02509  271.1 3.480
# v2 2 -50.47 1.5430  1.672 0.02992  123.7 1.810
# v3 3 -30.17 0.9295  3.139 0.03507  138.9 2.727
# v4 4 -38.56 0.4541  7.169 0.06703  405.5 4.396 
```

在上面：

*   `do.call(rbind, strsplit(rownames(dat), ""))`创建一个两列矩阵，其中第一列是字母“v”、“g”和“y”，第二列是数字 1 到 4。这一步可能过于简化了类似的问题，因为它只适用于双字符`rownames`；对于更复杂的场景，您可能不得不求助于一些正则表达式。
*   `cbind(...)`将此新矩阵与您的原始矩阵集成`data.frame`；新的列名只是“1”和“2”。
*   您的“时间”变量是包含字母“v”、“g”和“y”的新列（名为“2”的列）；您的“id”变量是包含数字 1 到 4 的新列（名为“1”的列）。将该信息用于`reshape()`您的数据。

`reshape()`将数据获取到该阶段后，使用该功能的另一种方法是使用`aggregate()`：

```
aggregate(cbind(mean, sd) ~ `2`, 
          data = cbind(dat, do.call(rbind, strsplit(rownames(dat), ""))), 
          FUN = I)
  2  mean.1  mean.2  mean.3    sd.1    sd.2    sd.3
1 1 -32.720   5.649 271.100 0.56500 0.02509 3.48000
2 2 -50.470   1.672 123.700 1.54300 0.02992 1.81000
3 3 -30.170   3.139 138.900 0.92950 0.03507 2.72700
4 4 -38.560   7.169 405.500 0.45410 0.06703 4.39600 
```

# ios - pushViewController：动画：正在崩溃，没有有用的输出

> ID：14146949
> 
> 赞同：0
> 
> 时间：2013-01-03T20:44:08.813
> 
> 标签：ios, pushviewcontroller

这对我来说太奇怪了。*昨天我想我曾经*在 iPhone4 ios6 设备上遇到过同样的崩溃。今天我尝试在模拟器中运行我的应用程序，当我调用 pushViewController 时它可靠地崩溃了。这是导致它崩溃的代码。

```
 PFObject *selectedGame = [self.myTurnList objectAtIndex: index];
    [self.myTurnList removeObjectAtIndex:index];
    UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard_iPhone" bundle:nil];
    GuessWordController *guessWord = [storyboard instantiateViewControllerWithIdentifier:@"GuessWordController"];
    guessWord.game = selectedGame;
    //[self performSegueWithIdentifier:@"toGuessWord" sender:self];
    [self.navigationController pushViewController:guessWord animated:NO];
    return; 
```

我在那里放了一堆 NSLog，从返回语句开始，一切看起来都很棒。但是，我抛出了“EXC_BAD_ACCESS”并且没有输出到调试器。我的 GuessWordController 的 viewDidLoad 中也有 NSLog，但它们都没有出现。

我尝试将 pushViewController 更改为使用情节提要设置的 segue，这似乎可行。但我想用 pushViewController 来做，因为我不想要动画。

我的设置方式是否有任何原因会导致应用程序崩溃，特别是 ios5.1？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:47:47.837

为什么不使用 segue 并创建一个没有动画的自定义 segue？

这比您尝试做的要容易得多。

从这里的文档...

[http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomSegues/CreatingCustomSegues.html#//apple_ref/doc/uid/TP40007457-CH16-SW1](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomSegues/CreatingCustomSegues.html#//apple_ref/doc/uid/TP40007457-CH16-SW1)

你可以使用这个功能...

```
- (void)perform
{
// Add your own animation code here.

    [[self sourceViewController] presentModalViewController:[self destinationViewController] animated:NO];
} 
```

然后删除所有你拥有的东西，然后`[self performSegueWithIdentifier:@"toGuessWord" sender:self];`改用。

然后在 prepareForSegue 你将需要...

```
GuessWordController *controller = segue.destinationViewController;

controller.game = selectedGame; 
```

这应该有效。

# grails - 如何更改导航栏中所选项目的类属性

> ID：14146950
> 
> 赞同：1
> 
> 时间：2013-01-03T20:44:08.730
> 
> 标签：grails, twitter-bootstrap

我正在使用带有 grails 的 twitter 引导程序，并在我的布局中包含以下内容：

```
 <div class="nav-collapse">
            <ul class="nav">
                <li><a href="${createLink(uri: '/request/new')}">My Link</a></li>
            </ul>
        </div> 
```

在我的页面上，我有以下内容：

```
<html>
    <head>
        <meta name="layout" content="bootstrap">
    </head>

    <body>
        sometext
    </body>
</html> 
```

**问题**

在我的布局中，如何检测`My Link`单击操作的时间？这样我就可以使用突出显示它`class="active"`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T23:38:28.443

使用 actionName 和 controllerName 来了解您在哪个操作中。

```
 <div class="nav-collapse">
        <ul class="nav">
            <li ${controllerName == 'request' && actionName == 'new' ? 'class="active"' : ''}><a href="${createLink(uri: '/request/new')}">My Link</a></li>
        </ul>
    </div> 
```

顺便说一句，我建议你在可能`g:link`的地方使用而不是`g:createLink`。这里 ：

```
 <div class="nav-collapse">
        <ul class="nav">
            <li ${controllerName == 'request' && actionName == 'new' ? 'class="active"' : ''}><g:link controller="request" action="new">My Link</g:link></li>
        </ul>
    </div> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T22:09:46.463

这是我倾向于这样做的方式。

首先，在您的布局中，您将执行以下操作：

```
<div class="nav-collapse">
    <ul class="nav">
        <li class="${ pageProperty(name:'meta.nav').equals( 'foo' ) ? 'active' : null }"><a href="${createLink(uri: '/request/new')}">My Link</a></li>
    </ul>
</div> 
```

在您的页面中：

```
<html>
    <head>
        <meta name="layout" content="bootstrap">
        <meta name="nav" content="foo"/>
    </head>

    <body>
        sometext
    </body>
</html> 
```

`foo`是应用`.active`类的触发器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T02:26:45.453

将您的布​​局 gsp 更改为：

```
<div class="nav-collapse">
    <ul class="nav">
        <li onclick="javascript: this.setAttribute("class","active");">
            <g:remoteLink controller='request' action='new' update='data'>My Link</g:remoteLink>
        </li>
    </ul>
</div>
<div id="data">
    <g:layoutBody />
</div> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-24T22:30:37.830

这应该有效（注意它与 Isammoc 的回答略有不同）

```
<li class="${controllerName == 'user' && actionName == 'profile' ? 'active' : ''}"> profile </li> 
```

# nhibernate - NHibernates ISession.Clear() 没有做它的工作？

> ID：14146952
> 
> 赞同：2
> 
> 时间：2013-01-03T20:44:19.940
> 
> 标签：nhibernate

我对 Session.Clear() 有疑问，据我了解，此语句应完全重置在 UOW、缓存等中所做的所有更改。问题是事实并非如此。下面的测试说明了我的情况。我添加到项目，它们之间存在依赖关系然后我尝试删除另一个项目所依赖的项目。这将导致一个正确的异常。然后我清除会话。最后我尝试向数据库添加一个新项目，当刷新 NHibernate 将再次尝试执行失败的删除语句。我是否误解了 Session.Clear() 的使用？还是我在这里错过了其他东西？

```
 [Fact]
    public void Verify_Cant_Clear_Delete()
    {
        var session = SessionFactory.OpenSession();

        var category = new ManufacturerCategory { Name = "category" };
        var man = new Manufacturer { Category = category, Name = "man" };

        session.Save(category);
        session.Save(man);
        session.Flush();

        try
        {
            // this will cause
            // NHibernate.Exceptions.GenericADOException: could not execute batch command.[SQL: SQL not available]
            // ---> System.Data.SqlClient.SqlException: The DELETE statement conflicted with the REFERENCE constraint "ManufacturerCategoryId". 
            // The conflict occurred in database "LabelMaker-Tests", table "dbo.Manufacturers", column 'Category_id'.

            session.Delete(category);
            session.Flush();

        }
        catch (Exception ex)
        {
            // This should clear the session
            session.Clear();    
        }

        try
        {
            var category2 = new ManufacturerCategory { Name = "category 2" };
            session.Save(category2);
            session.Flush();
        }
        catch(Exception ex)
        {
            // this will cause ONCE AGAIN cause
            // NHibernate.Exceptions.GenericADOException: could not execute batch command.[SQL: SQL not available]
            // ---> System.Data.SqlClient.SqlException: The DELETE statement conflicted with the REFERENCE constraint "ManufacturerCategoryId". 
            // The conflict occurred in database "LabelMaker-Tests", table "dbo.Manufacturers", column 'Category_id'.

            Assert.True(false);
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T21:04:17.287

您应该使用事务并在休眠异常上回滚事务，因为...

> ISession 的某些方法不会使会话保持一致状态。

[http://nhibernate.info/doc/nh/en/index.html#manipulatingdata-exceptions](http://nhibernate.info/doc/nh/en/index.html#manipulatingdata-exceptions)

或者让事务通过 dispose() 隐式回滚...

```
using (ISession sess = factory.OpenSession())
using (ITransaction tx = sess.BeginTransaction())
{
    // do some work
    ...
    tx.Commit();
} 
```

我猜想 Delete() 方法是上面引用中暗示的不一致状态方法之一......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T00:49:56.363

你的假设`ISession.Clear()`是不正确的。

特别是，一旦发生异常，您必须丢弃会话。`Clear()`不会修复状态（查看[9.8 异常处理](http://nhforge.org/doc/nh/en/index.html#manipulatingdata-exceptions)）

此外，正如 dotjoe 所提到的，您应该使用事务来完成工作。

# python - PyTables/HDF5 KERNEL32.dll 错误

> ID：14146954
> 
> 赞同：1
> 
> 时间：2013-01-03T20:44:25.633
> 
> 标签：python, hdf5, pytables

我最近使用 Python 2.7.2 在 Windows XP 上安装了 HDF5 1.8.9 和 PyTables 2.4.0，并从 PyPI（如果可用）或[http://www.lfd.uci.edu/~gohlke/pythonlibs的二进制文件中安装了以下内容/](http://www.lfd.uci.edu/~gohlke/pythonlibs/)（没有时）

*   Numpy 1.6.1 超级包
*   数字表达式 1.4.2
*   赛通 0.17.3
*   scipy 0.10.0rc1 超级包
*   matplotlib 1.1.1

当我导入表时，模块会导入，但会产生以下错误

`"The procedure Entry point InitOnceExecuteOnce could not be located in the dynamic link library KERNEL32.dll."`

MSDN.com 称此功能仅适用于 Windows Vista 及更高版本。我知道最新的 HDF5 二进制文件 (2.8.10) 是在 Windows 7 中构建的，根据 hdfgroup.org，让它们在 Windows XP 中工作需要从源代码构建它们，但 2.8.9 版本的二进制文件应该适用于经验值。此外，所有 PyTables 的依赖项都可以毫无问题地导入，因此问题似乎出在 HDF5 库上。如何在不从源代码构建 HDF5 库的情况下解决此问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T21:02:25.277

答案就在你的问题中。`InitOnceExecuteOnce`在 Windows XP 中不存在，因此说明它适用于您的 HDF5 版本的文档一定是错误的。您将需要使用旧版本的 HDF5，或者，正如您已经想到的，在 XP 上从源代码重建 HDF5。

# c# - 一名团队成员无法识别班级

> ID：14146957
> 
> 赞同：0
> 
> 时间：2013-01-03T20:44:45.767
> 
> 标签：c#, visual-studio, class, object, tfs

我正在和一个朋友一起做一个需要我们（我的意思是我们想要）使用 dll 的项目。我们可以毫无问题地指向和使用所有类，但是只有一个特定的类会在他这边引发构建错误（我可以正常运行代码）：

```
initMerge merge = new initMerge(); 
```

我们已经将它用于所有其他类并且它们工作正常，但是这个只是抛出一个错误：

> 找不到类型或命名空间名称“initMerge”（您是否缺少 using 指令或程序集引用？）。

我已经添加了适当的 using 语句和引用，并确保该类是公共的并且命名空间正确，并且我清理并重建了解决方案，但无济于事。

我们在 VS 2012 Express 中使用 TFS，到目前为止它运行良好

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T20:48:59.523

您可能忘记将**public**修饰符添加到您的类定义中。也不要使用括号来标记您的代码，因为它会造成混淆并且不是有效的 C# 代码。最后，我会将您的类命名为 InitMerge 而不是 initMerge 以遵循正确的 .NET 命名约定。

```
public class InitMerge 
```

唯一的另一种可能性是您没有引用其他项目。检查正在使用它的项目下的引用并确保它包含 DLL

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T20:49:31.027

using 语句不会使命名空间对您可用，它允许您直接使用它而无需限定它。您必须在项目中添加引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:47:23.867

您需要在项目中添加对外部 DLL 的引用。

如果您已有参考，请将鼠标悬停在 initMerge 语句上，然后单击 VS 为解决问题提供的建议下拉列表。

# java - 处理大小为 100000 及以上的输入时出现 StackOverFlow 错误

> ID：14146960
> 
> 赞同：2
> 
> 时间：2013-01-03T20:44:59.040
> 
> 标签：java, collections, stack-overflow

我在大小为 100000 的列表中使用 Collections.sort() 并收到 StackOverFlow 错误。我怎样才能扩大规模？这是代码：

这是一个大项目的一部分。Collections.sort() 在列表上被迭代调用，如下所示：列表大小在每一步都会减小，并且该过程迭代直到列表的大小变为 1。

```
public static Node buildTree(int d,  List<kdtrees.DataPoint> list) 
{
   if(list.isEmpty())
   {   
       return null;
   }

   else if(list.size() == 1) // S is singleton, return leaf
   {  
       System.out.println(list.get(list.size() - 1).text);
       Node t = new Node(0,0,null,null,list.get(list.size() - 1));

       return t;
   }

   else
   {           

      Collections.sort(list, compByX);
       double m = findMedian(d, list);

       List<kdtrees.DataPoint> left = new ArrayList<kdtrees.DataPoint>();
       List<kdtrees.DataPoint> right = new ArrayList<kdtrees.DataPoint>();

       for(DataPoint i: list)
       {
           if(i.Xvalue < m) 
           {
             left.add(i);
           }
           else
           {
             right.add(i);
           }

       }

        Node t = new Node(d, m, buildTree((d+1)%3,left)buildTree((d+1)%3,right), null);

        return t ; 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T21:16:51.213

看起来问题不在于`Collections.sort`，而是您错过了列表大小在每一步*都不会减小的场景。*（特别是：如果列表的所有元素都相等会发生什么？）

堆栈溢出是由您的代码引起的，而不是`Collections.sort`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:51:07.337

您只需使用 -Xss 选项更改 VM 参数中的堆栈大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:52:10.703

`Collections.sort()`根据 javadocs 用途`a modified mergesort`（这是一种递归算法）。在该算法的每次迭代中，都会进行递归调用，这会增加堆栈大小。

您必须使用`-Xss`选项增加堆栈大小或重新设计程序以使其工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T20:54:05.637

你应该增加堆栈大小

> java -Xss4m 程序

# php - 使用 php if 语句的问题

> ID：14146961
> 
> 赞同：0
> 
> 时间：2013-01-03T20:45:02.380
> 
> 标签：php, if-statement

我的代码中不断出现错误，说我有一个坏的'}'或'{'无论我改变什么都没有工作，我知道这非常容易......基本上它检查是否设置了一个变量，如果没有设置它会死，如果设置了脚本继续。任何人都有任何想法，我敢肯定我会因为这有多简单而受到打击。

php:

```
$i=0;
if(isset($inet))
{
    $i++;       
}
elseif(isset($tv))
{
    $i++;       
}
else(isset($voice))
{
    $i++;       
}

if(!$i>=1)
{
    die("you must choose a service")
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T20:47:24.137

```
$i=0;
if(isset($inet)){
$i++;       }
elseif(isset($tv)){
$i++;       }
else(isset($voice)){ // <- This should be elseif or the expression removed
$i++;       }
if(!$i>=1){
die("you must choose a service")} // <- Here should be a semicolon 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:46:17.093

```
$i = 0;
if(isset($inet)){
   $i++;       
}
if(isset($tv)){
   $i++;       
}
if(isset($voice)){
   $i++;       
}

if( $i < 1 ){
   die("you must choose a service");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T20:46:18.850

您忘记了`;`最后一行的 a 和一个`elseif`：

```
if(isset($inet)){
$i++;       }
elseif(isset($tv)){
$i++;       }
elseif(isset($voice)){
$i++;       }
if(!$i>=1){
die("you must choose a service");} 
```

我希望它现在有效...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T20:49:56.423

尝试格式化您的代码，这有助于查看它有什么问题。

```
$i=0;
if(isset($inet)) {
    $i++;
} elseif(isset($tv)) {
    $i++;
} elseif(isset($voice)) {
    $i++;
}

if($i<1) {
    die("you must choose a service");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-03T20:50:06.557

试试下面的，我想你错过了 elseif

```
if(isset($inet))
{
   $i++;       
}
elseif(isset($tv))
{
   $i++;       
}
else if(isset($voice))
{
   $i++;       
}
if(!$i>=1)
{
  die("you must choose a service");
} 
```

# c++ - C++ 编译器错误：“isLeaf() 尚未声明” - 但它是

> ID：14146965
> 
> 赞同：3
> 
> 时间：2013-01-03T20:45:17.030
> 
> 标签：c++, declaration

```
#include <cstdlib>
#include <iostream>
#include "Node.h"
#ifndef HW4_H
#define HW4_H
using namespace std;
/**
You are to implement the two functions in this class.
You can add any other method or members to it as well.
However, you cannot change their signature.  
**/
class HW4{

public:
    int count(Node* r) const
    {
        if(r->next==NULL&&r->bro==NULL) { return 0;}
        if(r.isLeaf())
        {
            return ((1+count(r->next)+count(r->bro)));
        }
        count(r->next);
    }

    /*
    This method will return true if the tree rooted at node sn can answer
    the demand induced by its leaves.
    */
    bool canDemandBeAnswered(Node* root)
    {
        if(count(root)>(root.getCapacity()))
        {
            return 0;
            exit(0);      
        }
        else 
        {
            return (canDemandBeAnswered(root->next)&&canDemandBeAnswered(root->bro));
        }
    }

    /*
    This method should return a linked list of nodes representing the 
    customers with the overall highest revenue.
    The resulting list should conform to the capacity limitations.
    */
    //     Node* getBestCustomers(Node* root);

};

#endif

#include <cstdlib>
#ifndef NODE_H
#define NODE_H

/**
The Node class. You must implement the two methods isLeaf() and addChild(Node*) below.
Otherwise, you can add any methods or members your heart's desire.
The only limitation is that they have to be in this file.
**/
class Node { 
private:
    int capacity;
    int price;

public:
    /**
    Hint: to be used for saving the Node's children and for returning the linked list           
    **/
    Node* next;
    Node* bro;

    Node(){
        capacity = 0;          
        price = 0;
    }
    Node(int capacity_){
        capacity = capacity_;  
        price = 0;
    }                

    //should return true if this node has no children, false otherwise.

    //this method adds a child to this node.

    int getCapacity(){
        return capacity;
    }   

    int getPrice(){
        return price;
    }

    void setPrice(int price_){
        price = price_;
    } 

    bool isLeaf()
    {
        if((this->next)->capacity==0)
            return 1;
        else return 0;
    }     

    void addChild(Node* child)
    {
        Node* temp;
        if(this->next!=NULL)
        {
            temp=this->next;
            child->bro=temp;
            this->next=child;
        }
        else
            this->next=child;
    }  
};

#endif 
```

我收到以下错误：“isLeaf() 尚未声明”。我不明白为什么-我都宣布了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-03T20:47:04.930

```
bool canDemandBeAnswered(Node* root)
{
    if(count(root)>(root.getCapacity())) 
```

这会尝试在`Node *`. 但是`Node *`没有一个名为 getCapacity 的函数——`Node`有。

您可以使用`(*root).getCapacity()`或 的简写，`root->getCapacity()`.

```
 if(r.isLeaf()) 
```

你在这里有同样的问题。`r`是一个`Node *`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T20:52:53.467

指针的成员访问是不同的。您必须使用间接运算符`->`。这些不是实际的对象，而只是指向它们的指针。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-03T20:46:40.440

你的意思是`r->isLeaf()`代替`r.isLeaf()`, since`r`是一个指针？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-03T20:48:33.907

您应该使用`->`而不是`.`访问这些函数，因为`r`它是一个指针。

# r - 在 R 中合并和粘贴重复的列

> ID：14146966
> 
> 赞同：3
> 
> 时间：2013-01-03T20:45:30.970
> 
> 标签：r

假设我有两个带有一些公共变量的数据框`x`：

```
df1 <- data.frame( 
  x=c(1, 2, 3, 4), 
  y=c("a", "b", "c", "d") 
)

df2 <- data.frame( 
  x=c(1, 1, 2, 2, 3, 4, 5), 
  z=c("A", "B", "C", "D", "E", "F", "G") 
) 
```

我们可以假设我们要合并的变量的每个条目在;`x`中只出现一次。`df1`但是，它可能会在 中出现任意次数`df2`。

我想合并`df2`'into' `df1`，同时保留`df1`. 是否有合并这两个数据帧的快速方法，以便合并后的输出为以下形式（例如）：

```
df_merged <- data.frame( 
  x=c(1, 2, 3, 4), 
  y=c("a", "b", "c", "d"), 
  z=c("A B", "C D", "E", "F")
) 
```

本质上，我想`df_merged`成为原始的组合`df1`，除了`df2`强制匹配格式的任何变量`df1`。的各种咒语`merge`会将新行附加到合并的输出中，我想避免这种情况。

我们可以假设我们要合并的变量的每个条目 ,`x`恰好出现一次。

速度也是一个优先事项，因为我将合并相当大的数据帧。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T21:09:30.780

另外的选择：

```
df2.z <- with(df2, tapply(z, x, paste, collapse=' '))
transform(df1, z=df2.z[match(x, names(df2.z))])

#   x y   z
# 1 1 a A B
# 2 2 b C D
# 3 3 c   E
# 4 4 d   F 
```

如果`df1$x`是有序的，则`df2.z[names(df2.z) %in% x]`在转换语句中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:54:04.810

```
merge( df1, 
       aggregate(df2$z , df2[1], FUN=paste, collapse=" ", sep=""), 
       by.x="x", by.y=1)
  x y   x
1 1 a A B
2 2 b C D
3 3 c   E
4 4 d   F
Warning message:
In merge.data.frame(df1, aggregate(df2$z, df2[1], FUN = paste, collapse = " ",  :
  column name ‘x’ is duplicated in the result
> M1 <- .Last.value
> names(M1)[3] <- "z"
> M1
  x y   z
1 1 a A B
2 2 b C D
3 3 c   E
4 4 d   F 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T20:45:30.970

我正在用我自己的潜在答案提交这个问题，但它相当慢，我很好奇还有哪些其他方法可用。

```
by <- "x"
df2_processed <- as.data.frame( 
    sapply( names(df2), function(x) {
      tapply( df2[[x]], df2[[by]], function(xx) {
        if( x == by ) {
          return(xx[1])
        } else {
          paste(xx, collapse=" ")
        }
      })
    }), optional=TRUE, stringsAsFactors=FALSE )

merge( df1, df2_processed, all.x=TRUE ) 
```

# iphone - （目标 C）从 NSMutableArray 中获取 CFstringRef

> ID：14146978
> 
> 赞同：0
> 
> 时间：2013-01-03T20:46:20.790
> 
> 标签：iphone, objective-c, xcode, ftp, automatic-ref-counting

我有一个通过 FTP 下载的 NSMutableArray。数组中的元素是类型为 CFStringRef 的[CFFTPStream 资源常量](https://developer.apple.com/library/mac/#documentation/CoreFoundation/Reference/CFFTPStreamRef/Reference/reference.html#//apple_ref/doc/uid/TP40003359-CH4-CFStreamHTTPandHTTPSProxyKeyConstants)。

我想从“kCFFTPResourceName”常量创建一个字符串。然而，作为 Objective C 和 iphone 开发的新手，我正在苦苦挣扎。

我所做的一切都导致 ARC 出现错误或错误，例如：

```
2013-01-03 15:31:44.874 Street Light Reporter[1382:11603] -[__NSCFDictionary objectAtIndex:]: unrecognized selector sent to instance 0x6e1e930
2013-01-03 15:31:44.875 Street Light Reporter[1382:11603] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFDictionary objectAtIndex:]: unrecognized selector sent to instance 0x6e1e930' 
```

我最近的尝试是：CFStringRef *c = [ar objectAtIndex:4]; 由于以下两个原因，这不起作用：

```
Incompatible pointer types initializing 'CFStringRef *' (aka 'const struct __CFString **') with an expression of type 'id' 
```

和

```
Implicit conversion of an Objective-C pointer to 'CFStringRef *' (aka 'const struct __CFString **') is disallowed with ARC 
```

我已经尝试过各种类型转换和弄乱 (__bridge) 之类的东西，但我没有运气。

有人可以帮我吗？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T20:50:23.290

CFStringRef 已经是一个指针，你不需要星号。此外，您可以将 CFStringRef 转换为 NSString ，它会正常工作并且更容易使用。这称为免费桥接。如果您仍然需要 CFStringRef：

弧：

```
CFStringRef c = (__bridge CFStringRef)([ar objectAtIndex:4]); 
```

非弧

```
CFStringRef c = (CFStringRef)([ar objectAtIndex:4]); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T21:06:37.107

您在这里有两个错误：第一个也是最严重的错误是您的`ar`对象`NSDictionary`不是 a `NSArray`。这就是为什么表演

```
CFStringRef *c = [ar objectAtIndex:4]; 
```

你得到一个`NSInvalidArgumentException`. `objectAtIndex:`是`NSArray`您发送到`NSdictionary`实例的方法。

第二个错误是演员表。正如费尔南多已经指出的那样，您需要使用`__bridge`如下关键字对其进行转换。

```
CFStringRef c = (__bridge CFStringRef)([ar objectAtIndex:4]); 
```

这样 ARC 就会知道您现在将该对象视为 C 指针。

另请注意，`CFStringRef`定义为

```
typedef const struct __CFString * CFStringRef; 
```

所以它已经是一个指针，你必须摆脱`*`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:58:58.920

似乎你得到了一个 CFDictionary 而不是一个数组。您链接到的常量是字典的键，您可以使用它们访问值。

# iphone - 将原始表情符号复制到 UIPasteBoard Objective-C

> ID：14146980
> 
> 赞同：1
> 
> 时间：2013-01-03T20:46:29.740
> 
> 标签：iphone, objective-c, ios, emoji, uipasteboard

当我复制原始字符时，例如：♥然后粘贴时看起来像![这个](../Images/5400313d797cdb7b90fe138d950df045.png)

粘贴时如何保留原始字符？

# emacs - 初始屏幕上的emacs奇怪字符

> ID：14146981
> 
> 赞同：0
> 
> 时间：2013-01-03T20:46:29.627
> 
> 标签：emacs, character, splash-screen

我最近下载了适用于 windows 的 emacs 24.2（我正在运行 vista 64 位）作为我对 emacs 的第一次尝试。当我启动它时，初始屏幕中的字符以及菜单项的工具提示都很奇怪。

我的猜测是字符（编码？）不知何故搞砸了。这[是我的启动画面的截图](https://www.dropbox.com/s/xstnuu68h07xbpf/emacs.png)

感谢您尝试帮助我，我很感激。

摘要：
- 我的初始屏幕显示奇怪的字符
- 我的按钮的工具提示也是如此- 我[从这里](http://ftp.gnu.org/gnu/emacs/windows/emacs-24.2-bin-i386.zip)
下载了适用于 windows 的 emacs 24.2 - 你能帮我让它显示英语吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T14:17:01.790

我将在此评论中回答所有人（不确定这是否是 stackoverflow 的正确礼仪）。我已经设法手动解决了这个问题。

Emacs 为我使用了这种字体：我将面部

`uniscribe:-outline-Helvetica-normal-normal-normal-mono-13-*-*-*-p-*-iso8859-1 (#x73)`的`face: variable-pitch`

字体系列从 Sans-serif 编辑为 Arial，从而解决了这个问题。
感谢 @wvxwv 和 @JSON 帮助我提供关键快捷方式和建议。感谢@Chris Barret 帮助我。感谢@itlodge 推荐 unicad

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T00:08:21.933

要查找问题字体，请将光标放在初始屏幕中的乱码字符之一上，然后按`C-u C-x =`。如果您无法读取出现的缓冲区，则使用 Cx Cw 保存它，并在其他编辑器中查看该文件。

对我来说，使用了以下字体，它显示 OK：

```
uniscribe:-outline-Arial-normal-normal-normal-sans-15-*-*-*-p-*-iso8859-1 (#x3A) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T07:19:25.213

我建议你使用[unicad](http://emacswiki.org/emacs/unicad.el)。它可以自动解决编码系统问题。

# sql-server - 是否可以在使用 sql 的更新语句中使用 MAX？

> ID：14146983
> 
> 赞同：6
> 
> 时间：2013-01-03T20:46:35.310
> 
> 标签：sql-server, tsql

我正在尝试在 sql 语句中使用 MAX 函数。这是我正在尝试做的事情：像这样：

```
UPDATE MainTable
        SET [Date] = GETDATE()

        where [ID] = Max 
```

我知道这是错误的，特别是在我放置 where 条件但无法弄清楚如何在同一语句中使用 max 和 update 的地方。谢谢

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-03T20:48:55.127

```
UPDATE MainTable
   SET [Date] = GETDATE()
 where [ID] = (SELECT MAX([ID]) FROM MainTable) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-03T20:48:58.923

单程

```
DECLARE @MaxID INT = (select MAX(id) FROM MainTable)

UPDATE MainTable
        SET [Date] = GETDATE()
        where [ID] = @MaxID 
```

那是SQL 2008的语法，在2005中你需要分两步做变量的声明和赋值

您还可以使用公用表表达式

```
;WITH cte
AS (
SELECT TOP 1 * FROM MainTable
ORDER BY ID DESC

)

UPDATE cte SET [Date] = GETDATE() 
```

您可以运行的示例

```
CREATE TABLE testNow(id int)
INSERT testNow VALUES(1)
INSERT testNow VALUES(2)

;WITH cte
AS (
SELECT TOP 1 * FROM testNow
ORDER BY ID DESC

)

-- id with 2 will become 5
UPDATE cte SET ID = 5

SELECT * FROM testNow 
```

输出

```
1
5 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-03T20:49:54.617

```
UPDATE MainTable
SET [Date] = GETDATE()
WHERE [ID] = (SELECT MAX(your column) FROM yourtable) 
```

# scala - Scala 库方法 Vector.sorted 使用什么算法？

> ID：14146990
> 
> 赞同：8
> 
> 时间：2013-01-03T20:46:52.937
> 
> 标签：scala, sorting, vector

我一直在查看[Scala 文档](http://www.scala-lang.org/archives/downloads/distrib/files/nightly/docs/library/index.html#scala.collection.immutable.Vector)，但到目前为止我还没有找到我的问题的答案，即该方法使用什么排序算法

```
scala.collection.immutable.Vector.sorted 
```

文档说这是一种稳定的排序，但不是实际使用的算法。是归并排序吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-03T20:55:24.940

该`sorted`方法在 中实现`SeqLike`，并且似乎`java.util.Arrays.sort`用于其排序。它从向量构建一个数组，然后调用`Arrays.sort`然后将其转换回来，看起来。根据[Java 6 文档](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#sort(byte[]))，它因此使用**快速排序**：

> 排序算法是一种调整过的快速排序，改编自 Jon L. Bentley 和 M. Douglas McIlroy 的“Engineering a Sort Function”，Software-Practice and Experience，Vol。23(11) P. 1249-1265（1993 年 11 月）。该算法在许多数据集上提供 n*log(n) 性能，导致其他快速排序降低到二次性能。

对于 Java 7，算法似乎发生了变化（再次引用[文档](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#sort(byte[]))）：

> 排序算法是 Vladimir Yaroslavskiy、Jon Bentley 和 Joshua Bloch 的 Dual-Pivot Quicksort。该算法在许多数据集上提供 O(n log(n)) 性能，导致其他快速排序降低到二次性能，并且通常比传统的（单轴）快速排序实现更快。

Scala 的`SeqLike#sorted`源代码[（取自 GitHub）](https://github.com/scala/scala/blob/master/src/library/scala/collection/SeqLike.scala#L592)：

```
/** Sorts this $coll according to an Ordering.
   *
   *  The sort is stable. That is, elements that are equal (as determined by
   *  `lt`) appear in the same order in the sorted sequence as in the original.
   *
   *  @see [[scala.math.Ordering]]
   *
   *  @param  ord the ordering to be used to compare elements.
   *  @return     a $coll consisting of the elements of this $coll
   *              sorted according to the ordering `ord`.
   */
  def sorted[B >: A](implicit ord: Ordering[B]): Repr = {
    val len = this.length
    val arr = new ArraySeq[A](len)
    var i = 0
    for (x <- this.seq) {
      arr(i) = x
      i += 1
    }
    java.util.Arrays.sort(arr.array, ord.asInstanceOf[Ordering[Object]])
    val b = newBuilder
    b.sizeHint(len)
    for (x <- arr) b += x
    b.result
  } 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-03T13:32:25.000

我广泛同意接受的答案。但是我想在[**Java 7 数组中添加一些要点**](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#sort(java.lang.Object[]))

答案会稍微改变自**JAVA 7**以来带来的变化，它使用 QuickSort 的变体对**java.util.Arrays 中的****原始**值`DualPivotQuickSort`进行排序

 ****JAVA 7 数组排序对于`Primitives`和是不同的`Objects`。

## 来自文档的注释 -

**对于原始值数组：**

*排序算法是Vladimir Yaroslavskiy、Jon Bentley 和 Joshua Bloch的**Dual-Pivot Quicksort 。**该算法在许多数据集上提供 O(n log(n)) 性能，导致其他快速排序降低到二次性能，并且通常比传统的（单轴）快速排序实现更快。*

**对于对象数组：**

*该实现改编自 Tim Peters 的 Python 列表排序 ( **TimSort** )。它使用了 Peter McIlroy 在 1993 年 1 月的第四届 ACM-SIAM 离散算法研讨会论文集上的“乐观排序和信息理论复杂性”中的技术。*

```
SeqLike.sorted uses 
java.util.Arrays.sort(arr.array, ord.asInstanceOf[Ordering[Object]]) 
where arr.array is instead of ArraySeq.

ArraySeq in Scala stores its data in a plain old Java array, 
but it does not store arrays of primitives; everything is an array of objects. 
This means that primitives get boxed on the way in. 
```

## 所以 Java Arrays.sort 应该使用**TimSort** !!!!!!

![在此处输入图像描述](../Images/effde574a499132d0222bc3b99abaf7a.png)

## 额外细节 -

您可以在这里找到 JAVA7 实现 - [http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/util/Arrays.java](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/util/Arrays.java)

进一步了解 JAVA 7 - [http://permalink.gmane.org/gmane.comp.java.openjdk.core-libs.devel/2628](http://permalink.gmane.org/gmane.comp.java.openjdk.core-libs.devel/2628)

这些变化对 scala 排序有影响，正如这里讨论的那样 - [http://grokbase.com/t/gg/scala-internals/12ab76zqnk/specializing-ordering-faster-sort](http://grokbase.com/t/gg/scala-internals/12ab76zqnk/specializing-ordering-faster-sort)****

# java - Weka：批量过滤命令显示错误：输入文件格式不同，使用 MAC OS X

> ID：14146991
> 
> 赞同：1
> 
> 时间：2013-01-03T20:46:53.553
> 
> 标签：java, weka, svm, libsvm

我一直在尝试运行一个简单的示例来检查 Weka GUI 界面，因为我计划在我的 Java 代码中使用 Weka API/WLSVM 开发支持向量机 (SVM)。我遵循三个步骤从文本数据集（培训和测试）制作 arff。你可以帮我用Java代码运行它。

1.  文本文件到 .arff 文件的转换器。
2.  应用 StringToWordVector 过滤器。
3.  在训练和测试数据集上应用批量过滤器。

* * *

## 1\. 文本文件到.arff 文件的转换器。

使用以下命令，此步骤在简单 CLI 上运行良好

> 错误：java weka.core.converters.TextDirectoryLoader -dir Testing_Text > Testing.arff

但是当我在 MAC bash 上运行它时会出现以下错误，我该如何解决这个问题？

> 无法找到或加载主类 weka.core.converters.TextDirectoryLoader

* * *

## 2\. 应用 StringToWordVector 过滤器

我使用 Weka GUI 界面分别应用了这个过滤器，首先是训练，然后是测试数据集。

* * *

## 3\. 在训练和测试数据集上应用 Batch Filter。

当我尝试应用批处理过滤器时，它会给出错误：使用以下命令在简单 CLI 上*输入文件格式不同。*

> java weka.filters.unsupervised.attribute.Standardize -b -i Training_STWV.arff -o train_std.arff -r TestingDiff_STWV.arff -s test_std.arff

输入文件格式不同。

请指导我，我坚持使用 Weka 运行支持向量机（SVM）分类器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T01:00:56.290

批量过滤命令 (-b) 现在正在使用以下命令。

```
java weka.filters.unsupervised.attribute.StringToWordVector -b -i Training.arff -o train_std.arff -r Testing.arff -s test_std.arff 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T07:45:19.067

Mac 上的标准程序是，切换到目录（例如`weka-3.6.8/`）并运行

```
java -Xmx1000M -jar weka.jar 
```

检查这是否有效。

如果是这样，请在您自己的示例中检查您是否正确设置了类路径 ( `-jar weka.jar`)。

# php - 使用带有 ffmpeg 的 PHP 到 JW Player 的 HTTP 伪流

> ID：14146995
> 
> 赞同：1
> 
> 时间：2013-01-03T20:47:05.863
> 
> 标签：php, flash, video-streaming, http-streaming

我们正在尝试从从 ffmpeg 输出结果的 PHP 源进行 HTTP 伪流处理。

下面是我们用来输出流的代码。如果我直接访问此 URL (../stream.php)，则会下载一个 flv 文件。如果我使用该 flv 文件作为 JW Player 中的源文件，它可以正常工作。但是，当我将 stream.php 作为源时，它不起作用，并且出现错误：“加载播放器时出错：找不到可播放的源”

我们在 stream.php 中使用的代码是：

```
 header("Accept-Ranges: bytes");
 header("Content-type: video/flv");
 header("X-Mod-H264-Streaming: version=2.2.7");

 $cmd = 'ffmpeg -re -i source.mp4 -map_chapters -1 -vcodec:0 copy -b:v:0 885918 -bf:0 2 -threads:0 0 -s:0 720x404 -partitions:0 +parti4x4+parti8x8+partp4x4+partp8x8+partb8x8 -acodec:1 copy -b:1 104684 -ac:1 2 -ar:1 44100 -f flv -';

  if ($handle = popen($cmd, 'r')) {

    sleep(3);

    echo fread($handle, 8024000);
    ob_flush();

    while (!feof($handle)){
        echo fread($handle, 8024000);
        ob_flush();
    }

    pclose($handle);

  } 
```

我们的 JW Player 代码是：

```
<script type="text/javascript">
    jwplayer("myElement").setup({
        file : "/stream.php?start=0",
        provider : 'http',
        'http.startparam' :'start',
        flashplayer : '/js/jwplayer.flash.swf',
              autostart : 'true',
              allowscriptaccess:'always',
              modes: [
            {type: 'html5'},
            {type: 'flash'},
            {type: 'download'}
        ],
        height: 270,
        width: 480
        });
</script> 
```

任何想法这可能有什么问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-11T12:12:29.250

jwplayer 在读取该格式的变量时遇到问题（对特殊字符进行 urlencoding，例如 ? & ）

最好的方法是在 htaccess 中为 stream.php 重写 url：

```
RewriteRule  ^stream-video/(.*)/(.*) stream.php?token=$1&file=$2 [QSA,L] 
```

这样，您可以通过以下方式传递文件 url：

```
http://example.com/stream-video/token-optional/filename-or-id.mp4 
```

希望这可以帮助..

顺便说一句，您是否对通过 php 和 X-Mod-H264-Streaming 进行的 flv 流式传输感到幸运？

# php - PHP & SoapClient：SOAP 请求中缺少参数

> ID：14146996
> 
> 赞同：1
> 
> 时间：2013-01-03T20:47:14.650
> 
> 标签：php, web-services, soap-client

我正在尝试解决 SoapClient 似乎没有将参数插入 SOAP 请求的问题。

简单的测试在与网站相同的服务器上运行的 Web 服务失败，即 Windows 8 Server 和 IIS 7.1 上的 PHP 5.3.13。这在两天前一直有效，但现在失败了。除了更新之外，我不知道服务器安装的任何更改。

```
 function simpleTest(){

    $client = new SoapClient("http://server-sql:78/PCIWCTest/Service1.svc?wsdl", array( "trace" => 1 ));

    $result = $client->__soapCall("GetData",
    array('GetData'=> array('parameters'=> 'Hello')),
    array('soapaction' => 'http://server-sql:78/PCIWCTest/GetData'));

    $requXML = $client->__getLastRequest();
    $respXML = $client->__getLastResponse();

    debug($requXML);
    debug($respXML);
} 
```

生成的请求 ($requXML) 是：

```
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://tempuri.org/"><SOAP-ENV:Body><ns1:GetData/></SOAP-ENV:Body></SOAP-ENV:Envelope> 
```

我假设应该有字符串 'Hello' 之间

```
<SOAP-ENV:Body><ns1:GetData/></SOAP-ENV:Body> 
```

标签，对吧？

在故障排除过程中，我一直在使用许多不同的方法，例如获得相同结果的肥皂 __call。服务器已重新启动。我已经尝试了所有我能想到的并找到尝试的方法。

有没有人见过这个或有一个想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T20:28:02.793

在这种情况下，我发现我发送的参数与 Web 服务代码中的参数命名不完全相同。通过更改上述内容：

```
array('GetData'=> array('parameters'=> 'Hello')), 
```

到：

```
array('GetData'=> array('value'=> 'Hello')), 
```

调用正常，参数不再为空！我不知道这种行为是否是这种情况所独有的，但根据我有限的经验，我还没有看到过在另一端命名参数是否重要的​​情况。

无论如何，问题都解决了。希望这对某人有帮助！