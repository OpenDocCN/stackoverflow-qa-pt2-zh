# StackOverflow 问答 14321000-14321999

# c# - 如果我绑定到当前 DataItem (Path=.)，如何调用 PropertyChanged

> ID：14321004
> 
> 赞同：0
> 
> 时间：2013-01-14T15:06:58.863
> 
> 标签：c#, wpf, binding, datacontext, inotifypropertychanged

在我的 XAML 代码中，我有一个与当前数据项的绑定，如下所示：

```
Background="{Binding Path=., Converter={StaticResource ResourceKey=kBackground}}" 
```

我的转换器使用数据项的几个属性来确定背景。当这些属性中的任何一个发生变化时，背景颜色可能会发生变化。我想向目标发送通知，以便背景发生适当的变化。我的问题是，当绑定路径为“。”时，我不知道如何发送这样的通知。

如果我的转换器使用 PropertyA 和 PropertyB，则调用：

```
PropertyChanged(this, new PropertyChangedEventArgs("PropertyA")) 
```

和/或

```
PropertyChanged(this, new PropertyChangedEventArgs("PropertyB")) 
```

不会触发绑定。我试着这样称呼：

```
PropertyChanged(this, new PropertyChangedEventArgs(".")) 
```

但它也没有触发绑定。

如何以我的“Path=.”的方式调用 PropertyChanged 绑定收到需要更新的通知？

*这可能是一个重复的问题，但我找不到。我不太了解术语。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:46:32.503

尝试改用[IMultiValueConverter](http://msdn.microsoft.com/en-us/library/system.windows.data.imultivalueconverter.aspx)，并传递它需要的属性

```
<Grid.Background>
    <MultiBinding Converter="{StaticResource MyMultiValueConverter}">
        <Binding Path="PropertyA"/>
        <Binding Path="PropertyB"/>
    </MultiBinding>
</Grid.Background> 
```

每当针对`PropertyA`或`PropertyB`

使用当前绑定语法的替代方法是随时或更改`PropertyChange`父数据项的通知。`PropertyA``PropertyB`

例如，假设您当前的数据项是`SomeObject`：

```
SomeObject.PropertyChanged += SomeObject_PropertyChanged;

...

void SomeObject_PropertyChanged(object src, PropertyChangedEventArgs e)
{
    if (e.PropertyName == "PropertyA" || e.PropertyName == "PropertyB")
    {
        RaisePropertyChanged("SomeObject");
    }
} 
```

# c# - 如何将 .net 类对象中的字段声明为 xml 子节点以进行序列化

> ID：14321007
> 
> 赞同：1
> 
> 时间：2013-01-14T15:07:08.937
> 
> 标签：c#, .net, xml, xml-serialization

使用 Visual Studio 2010、C# .Net4，我正在构建一个网站，我想通过 XML 将数据从托管服务器发送到客户端浏览器。

我的数据在一个对象（类）中，例如：

```
using System.Xml.Serialization;

public class InitialDataForBrowser
{
    public string myParentNode;
    public string myChildNode;

    public InitialDataForBrowser()
    {

    }

    [XmlIgnore]
    public string _myChildNode
    {
        set
        {
            myChildNode = value;
        }
    }
} 
```

这将产生结果：

```
<myParentNode></myParentNode>
<myChildNode ></myChildNode > 
```

如何在对象中声明子节点元素，从而产生：

```
<myParentNode>
    <myChildNode ></myChildNode >
</myParentNode> 
```

我正在使用以下方法将上述对象写入 XML 文件：

```
FileStream fs = new FileStream("XMLFile.xml", FileMode.Create);
XmlSerializer xs = new XmlSerializer(typeof(InitialDataForBrowser));
xs.Serialize(fs, data);
fs.Close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:27:06.967

假设您的意思是 dumdum 所说的，您可以使用“Has A”关系实现您对我的要求：

```
public class InitialDataForBrowser
{
    public ParentNode Parent { get; set; }
    public string MyName { get; set; }

    public InitialDataForBrowser()
    {
        Parent = new ParentNode();
        MyName = "InitialDataForBrowser";
    }
}

public class ParentNode
{
    public ChildNode Child { get; set; }

    public string MyName { get; set; }

    public ParentNode()
    {
        Child = new ChildNode();
        MyName = "Parent";
    }
}

public class ChildNode
{
    public string MyName { get; set; }

    public ChildNode()
    {
        MyName = "Child";
    }
} 
```

如果你序列化`InitialDataForBrowser`你会得到你想要的xml。请记住，您需要实际实例化这些值。你不能序列化你没有的东西。（有 Null 序列化的选项，但我认为这不是你想要的）。

# json - 在 ColdFusion MX7 中将 JSON 字符串转换为数组

> ID：14321008
> 
> 赞同：2
> 
> 时间：2013-01-14T15:07:09.920
> 
> 标签：json, coldfusion, coldfusion-7

我有一个 cookie 值，例如：

```
"[{"index":"1","name":"TimePeriod","hidden":false},{"index":"2","name":"Enquiries","hidden":false},{"index":"3","name":"Online","hidden":false}]" 
```

我想将此 cookie 值用作 ColdFusion 中的数组。最好的方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-14T15:23:03.913

正常的答案是使用内置的[**deserializeJson**](http://cfdocs.org/)函数，但由于该函数在 CFMX7 中不可用（它到达 CF8），您将需要使用 UDF 来实现相同的目的。

有两个站点包含此类资源，[**cflib.org**](http://cflib.org)和[**riaforge.org**](http://riaforge.org)，每个站点都有不同的 MX7 潜在解决方案。

搜索[CFlib](http://cflib.org)提供[**JsonDecode**](http://cflib.org/udf/jsondecode)。（CFLib 对“最大所需 CF 版本”有一个特定的过滤器，因此您可以确保出现的任何结果都适用于您的版本。）

搜索[riaforge](http://riaforge.org)提供[**JSONUtil**](http://jsonutil.riaforge.org/)，它在 MX7 上运行（但也声称比新的内置函数更好的类型映射）。

由于 MX7 在 Java 上运行，您可能还可以使用[json.org](http://json.org)上列出的众多 Java 库中的任何一个，使用[createObject/java](http://cfdocs.org/createobject-java-or-ejb-object)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-14T15:18:26.500

JSON 序列化是在 CF8 中原生添加的。

如果您使用 MX7，请在[riaforge.org](http://www.riaforge.org)上查找可以为您反序列化 JSON 的库。

# javascript - 如果选择了单选按钮，则对复选框执行验证

> ID：14321011
> 
> 赞同：2
> 
> 时间：2013-01-14T15:07:19.563
> 
> 标签：javascript, forms

我正在尝试工作此表单，以便选择第一个单选按钮，运行某个验证。When the second radio button is selected, run a different validation, etc. Currently using Alerts to check the functionality, but whichever radio button I choose I do not receive any feedback.

**javascript函数**

```
<script type="text/javascript">

function validateDays() {
    if (document.form1.radio1[0].checked == true) {
        alert("You have selected Option 1");
    }
    else if (document.form1.radio1[1].checked == true) {
        alert("You have selected Option 2");
    }
    else if (document.form1.radio1[2].checked == true) {
        alert("You have selected Option 3");
    }
    else {
        // DO NOTHING
        }
    }
}

</script> 
```

**html输入代码**

```
<input name="radio1" type="radio" value="option1" id="option1" onClick="validateDays();">
<input name="radio1" type="radio" value="option2" id="option2" onClick="validateDays();">
<input name="radio1" type="radio" value="option3" id="option3" onClick="validateDays();"> 
```

如何根据选中的单选按钮获得不同的警报？

最终，每个单选按钮将限制用户能够选择的表单下方的复选框数量 - 这就是为什么我不能纯粹在 onClick() 中进行此验证

**更多完整代码 - 应要求提供**

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" ></script>

<script type="text/javascript">
$(document).ready(function() {
    jQuery('#3daypass').click(function mattcode() {
        jQuery('#other_2 , #other_3 , #other_4').prop('checked', true);
    });
    jQuery('#2daypass , #1daypass').click(function mattcode() {
        jQuery('#other_2 , #other_3 , #other_4').prop('checked', false);
    });
});
</script>

<script type="text/javascript">

function validateDays() {
    if (document.getElementById('3daypass').checked) {
        alert("You have selected Option 1");
    }
    else if (document.getElementById('2daypass').checked) {
        alert("You have selected Option 2");
    }
    else if (document.getElementById('1daypass').checked) {
        alert("You have selected Option 3");
    }
    else {
        // DO NOTHING
        }
    }
}

</script>

<tr>
    <td colspan="5" align="left"><table width="100%" border="0" cellspacing="0" cellpadding="0">
     <tr>
          <td width="65%" valign="top"><table width="100%" height="100%" border="0" cellpadding="2" cellspacing="0">
             <tr valign="middle">
                <td height="18" colspan="2" align="left" bgcolor="#000000"><span class="boxheader"><strong>&nbsp;Conference Pass</strong></span> <span class="bodycopyWhite"> - (Please select a day pass below)</span></td>
                   </tr>
                  <tr valign="middle">
                      <td colspan="2" align="left" bgcolor="#EBEBEB"><img src="spacer.gif" width="1" height="3"></td>
             </tr>
                <tr bgcolor="#EBEBEB">
                   <td align="center" valign="top" bgcolor="#EBEBEB"><table width="100%" border="0" cellspacing="0" cellpadding="2">
                       <tr>
                     <td width="7%"><input name="other_1" type="radio" value="3daypass" id="3daypass" onClick="Payment_Total(); check_code(); Vat_Total(); validateDays();"></td>
                        <td width="93%" class="bodyNormal"><strong>Three-day</strong> open delegate pass</td>
                     </tr>
                      <tr>
                       <td><input name="other_1" type="radio" value="2daypass" id="2daypass" onClick="Payment_Total(); check_code(); Vat_Total(); validateDays();"></td>
                    <td class="bodyNormal"><strong>Two-day</strong> open delegate pass</td>
                   </tr>
                       <tr>
                 <td><input name="other_1" type="radio" value="1daypass" id="1daypass" onClick="Payment_Total(); check_code(); Vat_Total(); validateDays();"></td>
               <td class="bodyNormal"><strong>One-day</strong> open delegate pass</td>
           </tr>
                </table></td>
           </tr>
        <tr valign="middle">
               <td colspan="2" align="left" bgcolor="#EBEBEB"><img src="spacer.gif" width="1" height="3"></td>
           </tr>
             </table>
                <br>
            <table width="100%" border="0" cellspacing="0" cellpadding="2">
                  <tr>
                      <td height="20" colspan="2" bgcolor="#000000" class="boxheader"><strong>&nbsp;Please select the days you will be attending</strong></td>
                  </tr>
           <tr>
                 <td width="9%" bgcolor="#EBEBEB"><input name="other_2" type="checkbox" id="other_2" value="Tues 5 Feb"></td>
               <td width="91%" bgcolor="#EBEBEB" class="bodycopy">Tuesday 5 February 2013 </td>
             </tr>
                 <tr>
               <td bgcolor="#EBEBEB"><input name="other_3" type="checkbox" id="other_3" value="Wed 6 Feb"></td>
             <td bgcolor="#EBEBEB" class="bodycopy">Wednesday 6 February 2013 </td>
           </tr>
               <tr>
           <td bgcolor="#EBEBEB"><input name="other_4" type="checkbox" id="other_4" value="Thurs 7 Feb"></td>
                     <td bgcolor="#EBEBEB" class="bodycopy">Thursday 7 February 2013 </td>
              </tr> 
```

*为凌乱的代码道歉 - 这是其他人在 2005 年编写的（明显对 CSS 有恐惧症） - 看看我必须处理什么？！*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-14T15:47:13.273

```
function validateDays() {
    if (document.getElementById("option1").checked == true) {
        alert("You have selected Option 1");
    }
    else if (document.getElementById("option2").checked == true) {
        alert("You have selected Option 2");
    }
    else if (document.getElementById("option3").checked == true) {
        alert("You have selected Option 3");
    }
    else {
        // DO NOTHING
        }
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-14T15:08:07.383

您需要使用`==`或`===`进行比较。`=` *分配*一个新值。

除此之外，`==`仅在处理布尔值时使用是没有意义的。只需使用`if(foo)`而不是`if(foo == true)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T15:11:51.983

您必须使用*等于*运算符而不是*赋值*

```
if(document.form1.radio1[0].checked == true) {
    alert("You have selected Option 1");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-23T20:16:26.197

使用 javascript 的完整验证示例：

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Radio button: full validation example with javascript</title>
        <script>
            function send() {
                var genders = document.getElementsByName("gender");
                if (genders[0].checked == true) {
                    alert("Your gender is male");
                } else if (genders[1].checked == true) {
                    alert("Your gender is female");
                } else {
                    // no checked
                    var msg = '<span style="color:red;">You must select your gender!</span><br /><br />';
                    document.getElementById('msg').innerHTML = msg;
                    return false;
                }
                return true;
            }

            function reset_msg() {
                document.getElementById('msg').innerHTML = '';
            }
        </script>
    </head>
    <body>
        <form action="" method="POST">
            <label>Gender:</label>
            <br />
            <input type="radio" name="gender" value="m" onclick="reset_msg();" />Male
            <br />
            <input type="radio" name="gender" value="f" onclick="reset_msg();" />Female
            <br />
            <div id="msg"></div>
            <input type="submit" value="send>>" onclick="return send();" />
        </form>
    </body>
</html> 
```

问候，

费尔南多

# knockout.js - 在 knockoutjs 中使用选中的绑定时防止事件冒泡

> ID：14321012
> 
> 赞同：24
> 
> 时间：2013-01-14T15:07:20.490
> 
> 标签：knockout.js

我正在使用 KnockoutJs 和 Twitter Bootstrap 构建一个 UI。

我在`checked`名为`dropdown-toggle`.

```
<div class="btn-group">
    <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
        Facets
        <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
        <!-- ko foreach: facets -->
        <li>
            <input type="checkbox" data-bind="checked: Visible" /> 
            <span data-bind="text: Name"></span>
        </li>
        <!-- /ko -->
    </ul>
</div> 
```

一切都很好，除了我希望在选中复选框时下拉对话框保持打开状态。

这是一个例子：http: [//jsfiddle.net/MikeEast/L3KfG/2/](http://jsfiddle.net/MikeEast/L3KfG/2/)

我尝试创建自己的绑定处理程序，它显式地使用已检查的绑定，`event.preventDefault()`并使`event.stopPropagation()`对话框保持打开状态，但阻止检查复选框。

任何指针？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-01-14T15:28:33.753

听起来你在正确的轨道上。你基本上想做相当于：

```
click: function() { return true; }, clickBubble: false 
```

**或者**这可以在自定义绑定中完成，例如：

```
ko.bindingHandlers.stopBubble = {
  init: function(element) {
    ko.utils.registerEventHandler(element, "click", function(event) {
         event.cancelBubble = true;
         if (event.stopPropagation) {
            event.stopPropagation(); 
         }
    });
  }
}; 
```

除非您返回 true，否则 KO 附加的正常单击/事件处理程序将阻止默认操作。但是，如果我们连接我们自己的事件处理程序，那么我们只需要防止它冒泡。

示例：http: [//jsfiddle.net/MikeEast/PyNfg/1/](http://jsfiddle.net/MikeEast/PyNfg/1/)

# c# - 仅基于表的一个字段在 Linq 中区分

> ID：14321013
> 
> 赞同：161
> 
> 时间：2013-01-14T15:07:22.187
> 
> 标签：c#, sql, linq

我正在尝试在 Linq 中使用 .distinct 来获取基于表的一个字段的结果（因此不需要表中的整个重复记录）。

我知道使用 distinct 编写基本查询，如下所示：

```
var query = (from r in table1
orderby r.Text
select r).distinct(); 
```

但我需要`r.text`不重复的结果。

* * *

## 回答 #1

> 赞同：354
> 
> 时间：2013-01-14T15:09:17.857

尝试这个：

```
table1.GroupBy(x => x.Text).Select(x => x.FirstOrDefault()); 
```

这将按表对表进行分组`Text`并使用每个组中的第一行，从而产生`Text`不同的行。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-01-14T15:15:07.353

MoreLinq 有一个可以使用的[DistinctBy方法：](http://code.google.com/p/morelinq/source/browse/MoreLinq/DistinctBy.cs?r=f4c39a771d712a568467eaa31840cc22e07a5ed0)

它将允许您执行以下操作：

```
var results = table1.DistictBy(row => row.Text); 
```

该方法的实现（缺少参数验证）如下：

```
private static IEnumerable<TSource> DistinctByImpl<TSource, TKey>(IEnumerable<TSource> source,
    Func<TSource, TKey> keySelector, IEqualityComparer<TKey> comparer)
{
    HashSet<TKey> knownKeys = new HashSet<TKey>(comparer);
    foreach (TSource element in source)
    {
        if (knownKeys.Add(keySelector(element)))
        {
            yield return element;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-01-14T15:09:32.463

> 但我需要不重复 r.text 的结果

听起来好像你想要这个：

```
table1.GroupBy(x => x.Text)
      .Where(g => g.Count() == 1)
      .Select(g => g.First()); 
```

这将选择`Text`唯一的行。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-09-17T23:44:40.970

[Daniel Hilgarth](https://stackoverflow.com/users/572644/daniel-hilgarth)上面的回答导致了一个`System.NotSupported`例外 With **Entity-Framework**。使用**Entity-Framework**，它必须是：

```
table1.GroupBy(x => x.Text).Select(x => x.FirstOrDefault()); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-14T15:46:49.507

围绕这个话题有很多讨论。

[你可以在这里](https://stackoverflow.com/questions/1300088/distinct-with-lambda)找到其中之一：

正如@Servy 指出的那样，最受欢迎的建议之一是采用 lambda 表达式作为参数的 Distinct 方法。

C# 的首席架构师 Anders Hejlsberg 在[这里](http://social.msdn.microsoft.com/Forums/en-US/linqprojectgeneral/thread/6834054e-e1c1-49db-970c-370a9012c675)提出了解决方案。还解释了为什么框架设计团队决定不添加采用 lambda 的 Distinct 方法的重载。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-08-22T19:01:34.320

根据我的发现，您的查询大部分是正确的。只需将“select r”更改为“select r.Text”即可，这应该可以解决问题。这就是 MSDN 记录它应该如何工作的方式。

前任：

```
 var query = (from r in table1 orderby r.Text select r.Text).distinct(); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-01-18T06:26:39.037

```
data.Select(x=>x.Name).Distinct().Select(x => new SelectListItem { Text = x }); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-11-05T16:00:33.987

不同的返回你的单列，如果那是你的情况那么！！

```
CountryData.Select(x=>x.COUNTRY_NAME).Distinct() 
```

否则，如果您需要一列不同的多列。您需要先**分组**，然后从组中选择第一项。 *（在这种情况下，不会返回组中具有不同值的其余项目）*

```
CountryData.GroupBy(a=>a.COUNTRY_NAME).Select(a=>a.First()); 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2017-07-24T10:18:46.507

试试这个代码：

```
table1.GroupBy(x => x.Text).Select(x => x.FirstOrDefault()); 
```

* * *

## 回答 #10

> 赞同：-6
> 
> 时间：2013-11-19T11:16:38.743

你可以试试这个：`table1.GroupBy(t => t.Text).Select(shape => shape.r)).Distinct();`

# java - glGenTextures、glGenBuffers 的有效索引范围

> ID：14321015
> 
> 赞同：2
> 
> 时间：2013-01-14T15:07:22.803
> 
> 标签：java, android, opengl-es

我在 Android 中编程 OpenGL 1.1 ES，即使用固定管道。

我正在使用`glGenTextures`and `glGenBuffers`，它返回数组中的索引（我一次只将它们用于一个纹理/缓冲区）。该索引的保证有效（和无效）范围是多少？

根据经验，我观察到有效的索引以 1 开头，但文档没有提及它。值 0 是否保证无效？

我需要它，因为有时我需要检查纹理/缓冲区是否已经加载。如果 0 可以是有效的，我需要将我的值初始化为 -1（以便能够检测到它们未初始化/卸载），但如果 0 是无效的纹理/缓冲区名称，那么事情就更容易了。

在 Android 中，an`int[]`已填充，但在 OpenGL ES API 中，我看到那里有`GLUint`值。所以我担心（理论上）即使在我的 Android 程序中初始化为 -1 也可能是不正确的，因为（理论上）一个 uint 可以返回 0xFFFFFFFF。

那么什么是有效范围，什么是无效范围/值，我可以确定它不代表有效的纹理/缓冲区名称（索引）？

# facebook-graph-api - Facebook 应用程序请求 Youtube 观看历史记录

> ID：14321019
> 
> 赞同：0
> 
> 时间：2013-01-14T15:07:29.113
> 
> 标签：facebook-graph-api, youtube-api

我们正在研究一个 FB 应用程序的想法，让我们检索应用程序用户的 youtube 观看历史记录。我知道可以通过 youtube 的 api 检索观看历史记录，但结合 FB 应用程序我找不到示例。

非常感谢您对此的任何意见，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:32:02.207

这两个是正交的。由于您没有指定语言，我假设您使用的是 Python。

1.  使用 Canvas编写一个[FB 应用程序](http://developers.facebook.com/docs/guides/canvas/)向用户显示输出......我假设您正在使用 Canvas。
2.  使用[YouTube API 和 Python 客户端](https://developers.google.com/youtube/v3/code_samples/python)进行 API 调用。您需要使用数据库或其他存储引擎将用户的 Facebook API 身份验证令牌与他们的 Google 身份验证令牌相关联。两者都使用 OAuth 2.0（尽管它们是不同的风格），所以一旦你学会了一个，另一个应该很容易。

在我回答更多问题之前，您最好先阅读 Facebook API 和 YouTube API 的入门指南。在你对两者都有一些了解之后，选择一个堆栈，你应该或多或少地准备好了。

# android - 动画转换

> ID：14321020
> 
> 赞同：3
> 
> 时间：2013-01-14T15:07:29.083
> 
> 标签：android, animation, matrix, transformation

我来自 iOS 背景，其中有一个名为的属性`transform`，它本质上只是一个 4x4 矩阵，用于应用于`CALayer`(Also `UIView`) 的 3D 转换。

我遇到了[Transformation](http://developer.android.com/reference/android/view/animation/Transformation.html)类，它似乎有点不同，但我希望我可以将它用于`View`子类的一些转换。

我已经看到了构造函数`new Transformation()`和不同的`set`方法，但是我看不到任何可以让我实际设置 3x3 矩阵`Transformation`或如何在`View`.

我猜这也不是一个非常重要的课程，因为文档本身似乎存在错误。

我希望 SO 上的某个人能够帮助我弄清楚如何利用这个类来对我的`View`子类进行转换（如何构造和应用 a `Transformation`），或者为我指出一个更好的工具/类来满足我的需求。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-16T21:39:09.520

您通常会在 Android 中的 Animation 对象中应用转换。即创建一个新的动画类，为您的视图设置一个变换：

```
public class myAnimation extends Animation {
  public myAnimation() { }

  @Override
  boolean   willChangeTransformationMatrix() { return true; }

  @Override
  void  applyTransformation(float interpolatedTime, Transformation t) {
    Matrix m = t.getMatrix();
    // do whatever you want to the matrix here, using the interpolatedTime
  }
} 
```

然后在您的视图上设置动画：

```
Animation anim = new myAnimation();
anim.setDuration(100);
view.startAnimation(anim); 
```

在后 Honeycomb Android 上，您应该能够通过在视图上操作矩阵来做类似的事情：

```
Matrix m = view.getMatrix();
// do whatever you want here 
```

# sql-server - 使用 Windows 任务计划程序执行存储过程

> ID：14321023
> 
> 赞同：16
> 
> 时间：2013-01-14T15:07:37.257
> 
> 标签：sql-server, stored-procedures, scheduled-tasks

我一直在尝试设置一个计划，以便在 Windows 任务计划程序中每小时运行一个存储过程（因为我正在使用 SQL Express 并且无法安装第 3 方工具），但是在尝试了各种方法（例如运行 .bat 文件）之后从任务调度程序，从任务调度程序打开 SqlCmd 实用程序并传递命令行语法或 .sql 脚本文件我没有运气。

我知道这是可以做到的，因此我确信这是我错过的东西，但如果有人可以分享他们的经验，我将非常感激。

以下命令在批处理文件中...

```
sqlcmd -E -i"C:\Users\Administrator\Desktop\test.sql" -o"C:\Users\Administrator\Desktop\dump.txt" 
```

非常感谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-14T15:36:19.327

如果您是 sql 实例的管理员（由于您使用的是 SQLExpress，我敢打赌您正尝试在自己的计算机上执行此操作，因此您的用户很有可能是 sql 实例的管理员）您不应该使用 -E at所有，忽略它。

其次，即使您在本地工作，也要指定服务器。

从一个简单的 sql 命令开始，如下所示：

> sqlcmd.exe -S "." -d MY_DATABASE -Q "从 MY_TABLE 中选择 *"

将 MY_DATABASE 和 MY_TABLE 替换为您的 dbname 和表名。确保您可以从命令行运行它。它应该从您的表中返回数据。（注意命令行选项区分大小写，所以 -s 与 -S 不同）

最后，不要尝试通过任务调度程序提供参数。将带有所有参数的命令放在 .bat 文件中，然后从任务调度程序运行批处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-13T06:52:44.150

我最近遇到了类似的问题，我的经验可能会对您有所帮助。我正在从批处理文件中调用一个小应用程序，即 EXE。我正在安排批处理文件从 Windows 任务计划程序运行。该应用程序正在使用 Windows 身份验证访问 SQL 数据。我可以直接运行应用程序，即单击 EXE 运行它。我可以从批处理文件运行应用程序。但是，如果我尝试运行计划的任务，它似乎开始但什么也没做，也没有发布我能找到的错误。我发现如果我将应用程序更改为使用 SQL 身份验证运行，它可以从任务计划程序运行。

我怀疑当 Windows 身份验证从 SQL 无法识别的任务计划程序运行时，它的上下文存在一些问题。

# android - android：布局就像老虎机

> ID：14321027
> 
> 赞同：1
> 
> 时间：2013-01-14T15:07:47.450
> 
> 标签：android, layout

我想做一个布局，这样当按下下面的 4 个按钮时，上面的 3 个按钮将继续向左移动 1 个按钮宽度（即，当按下底部的一个按钮时，它会在中间显示下一个完整的按钮 3 ...需要某种动画吗？）

简单来说，我想做一个类似于老虎赌博机的布局，但不是每个插槽向上或向下旋转，如果按一下底部的任何按钮，整排向左移动一个插槽会很棒。

但是，布局代码让我头疼。我怎样才能使它成为占据中间的中间按钮，并且左键和右键只显示一半，如第二张图片所示？

# 当前布局

![现在的情况](../Images/1bbb3e0005abcfeefdb874b6ffeed2a9.png)

# 所需布局

![在此处输入图像描述](../Images/d032c4a55ac1057de6a3df43d9ad95ef.png)

```
<?xml version="1.0" encoding="utf-8"?>
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:stretchColumns="*"  
    android:background="@drawable/blackboard2">

<TableRow
    android:id="@+id/tableRow0"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_marginTop="0dp"
    android:layout_weight="0.2"
    android:background="@android:color/transparent" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_span="6"
        android:gravity="center"
        android:text="Abc"
        android:textSize="30sp" />

</TableRow>

<TableRow
    android:id="@+id/tableRow1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_marginTop="0dp"
    android:layout_weight="0.45"
    android:background="@android:color/transparent"
    android:gravity="center" >

    <Button
        android:id="@+id/button_Q1"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_margin="2dp"          
        android:background="@drawable/grey_sq_btn"
        android:text="1"
        android:textSize="15dp" />

    <Button
        android:id="@+id/button_Q2"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_margin="2dp"         
        android:background="@drawable/grey_sq_btn"            
        android:text="2"
        android:textSize="15dp" />

    <Button
        android:id="@+id/button_Q3"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_margin="2dp""            
        android:background="@drawable/grey_sq_btn"
        android:text="3"
        android:textSize="15dp" />           

</TableRow>     

<TableRow
    android:id="@+id/tableRow2"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_marginTop="10dp"
    android:layout_weight="0.1"
    android:background="@android:color/transparent" >

</TableRow>

<TableRow
    android:id="@+id/tableRow1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_marginTop="0dp"
    android:layout_weight="0.1"
    android:background="@android:color/transparent"
    android:gravity="center" >

    <Button
        android:id="@+id/button_1"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_margin="5dp"
        android:layout_span="2"
        android:background="@drawable/grey_sq_btn"
        android:text="1"
        android:textSize="15dp" />

    <Button
        android:id="@+id/button_2"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_margin="5dp"
        android:layout_span="2"
        android:background="@drawable/grey_sq_btn"
        android:text="2"
        android:textSize="15dp" />

</TableRow>

<TableRow
    android:id="@+id/tableRow2"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_marginTop="0dp"
    android:layout_weight="0.1"
    android:background="@android:color/transparent"
    android:gravity="center" >

    <Button
        android:id="@+id/button_3"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_margin="5dp"
        android:layout_span="2"
        android:background="@drawable/grey_sq_btn"
        android:text="3"
        android:textSize="15dp" />

    <Button
        android:id="@+id/button_4"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_margin="5dp"
        android:layout_span="2"
        android:background="@drawable/grey_sq_btn"
        android:text="4"
        android:textSize="15dp" />

</TableRow>

<TableRow
    android:id="@+id/tableRow3"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_marginTop="10dp"
    android:layout_weight="0.15"
    android:background="@android:color/transparent" >

</TableRow> 
```

# expression-blend-4 - Expression Blend-Api (Blend 4) 与 Visual Studio 2012

> ID：14321031
> 
> 赞同：0
> 
> 时间：2013-01-14T15:08:06.060
> 
> 标签：expression-blend-4, blend-2012

我有一个定义混合行为的项目。用于创建此行为的 Blend SDK 是版本 4。在 Visual Studio 2010 中，我可以毫无问题地使用它。在 VS 2012 中，WPF 设计器似乎与 dll 有问题。

```
xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
xmlns:b="clr-namespace:MyLib.Util.Behaviors;assembly=MyLib"
xmlns:v="clr-namespace:MyLib;assembly=MyLib" 
```

在 WPF 设计器的智能感知中，命名空间都没有出现，所以我必须盲打它们。

尽管设计者不会提出 and 的命名空间`MyLib`，`Interactivity`但我可以实例化一个定义在其中的控件，`MyLib`并为此提供完美的智能感知：

```
<v:ViewPort></v:ViewPort> 
```

现在我想向 中添加一个 Behavior `ViewPort`，定义在`MyLib.Util.Behaviors`

```
<v:ViewPort>
  <i:Interaction.Behaviors>
    <b:ZoomAreaBehavior />
  </i:Interaction.Behaviors>
</v:ViewPort> 
```

但同样，对于`b:ZoomAreaBehavior`. 错误列表显示找不到 ZoomAreaBehavior。完全相同的代码在 2010 年有效，并且在我关闭可视化编辑器后立即编译和运行。

有谁知道这里出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-05T06:23:38.967

**在 Update 1、**Blend for Visual Studio 2012中添加了****Blend***支持*，Update 2 内置了 WPF 支持。**

# ios - iOS - NSJSONSerialization：无法将数据转换为围绕字符的字符串

> ID：14321033
> 
> 赞同：4
> 
> 时间：2013-01-14T15:08:22.217
> 
> 标签：ios, objective-c, xcode, cocoa-touch, nsjsonserialization

解析 JSON 时出现此错误：

```
NSDictionary *json = [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingMutableContainers error:&error];

Error Domain=NSCocoaErrorDomain Code=3840 "The operation couldn’t be completed. (Cocoa error 3840.)" (Unable to convert data to string around character 73053.) UserInfo=0x1d5d8250 {NSDebugDescription=Unable to convert data to string around character 73053.} 
```

任何建议如何解决这个问题？

**添加** 正如它在错误报告中所说，解析器无法通过位置 73053 的字符，在我的 JSON 响应中是“ø”。据我所知，像 Ø、Å、Æ 等字符对于 json 解析器来说应该不是问题吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2016-02-11T11:37:01.797

是的，我在编码问题上遇到了同样的问题，并得到了上述错误。我从服务器获取 NSData 作为`encoding:NSISOLatin1StringEncoding`. 所以我必须在使用 NSJSONSerialization 解析它之前将它转换为 UTF8。

```
NSError *e = nil;
NSString *iso = [[NSString alloc] initWithData:d1 encoding:NSISOLatin1StringEncoding];
NSData *dutf8 = [iso dataUsingEncoding:NSUTF8StringEncoding];
NSDictionary *dict = [NSJSONSerialization JSONObjectWithData:dutf8 options:NSJSONReadingMutableContainers error:&e]; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-01-04T18:02:05.800

**斯威夫特 3**

```
let responseStrInISOLatin = String(data: data, encoding: String.Encoding.isoLatin1)
guard let modifiedDataInUTF8Format = responseStrInISOLatin?.data(using: String.Encoding.utf8) else {
      print("could not convert data to UTF-8 format")
      return
 }
do {
    let responseJSONDict = try JSONSerialization.jsonObject(with: modifiedDataInUTF8Format)
} catch {
    print(error)
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-14T15:28:59.337

检查您正在解析的数据是否实际上是有效的 JSON（而不仅仅是“几乎”JSON）。已知当您具有无法解析为 JSON 的不同数据格式时会发生该错误。参见例如：

[iOS 5 JSON 解析导致 Cocoa 错误 3840](https://stackoverflow.com/questions/11174130/ios-5-json-parsing-results-in-cocoa-error-3840)

您的 JSON 中是否也有顶级容器？数组或字典。例子：

```
{ "response" : "Success" } 
```

**更新**

JSON 的默认编码是 UTF-8。特殊/奇异字符对于 UTF-8 来说不是问题，但请确保您的服务器返回正确编码为 UTF-8 的内容。另外，你有没有做任何事情告诉你的 JSON 解释器使用不同的编码？

如果您的 JSON 来自 Web 服务，请将 URL 放入此页面以查看有关编码的内容：

[http://validator.w3.org/](http://validator.w3.org/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-05-30T04:55:47.147

**斯威夫特 5：**

是的，我在解析 JSON 数据时遇到了同样的错误。

解决方案：您必须首先将响应数据转换为字符串，然后在解码之前使用 UTF8 编码将该字符串转换为数据。

```
let utf8Data = String(decoding: responseData, as: UTF8.self).data(using: .utf8) 
```

# google-maps-api-3 - Google Maps API V3 - 缩放动画行为

> ID：14321037
> 
> 赞同：2
> 
> 时间：2013-01-14T15:08:38.003
> 
> 标签：google-maps-api-3

是否有可能检测并挂钩“像” onBeforeZoomChange 和 onAfterZoomChange(="zoom_changed") 的事件

在地图上分层并绑定到适当标记的数百个 DIV（标签）存在问题。当地图动画（缩小）时，DIV 改变了它们的大小两次，然后动画变得更小。这似乎是一个很大的性能问题和非常糟糕的行为。是否可以在缩放开始之前隐藏这些 DIV 并在 zoom_changed 中显示它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T22:20:40.773

没有办法拦截重绘地图的方法，但是有办法拦截自定义Overlays的绘制，因为绘制Overlay的函数是你自己定义的。

任何需要的时候都会自动调用cutom Overlay的draw-method。

简单的方法：在地图空闲之前不要重绘覆盖：

```
 YourOverlayClass.prototype.draw = function(idle) {

    if(!idle){
        var _this=this;
        google.maps.event.addListenerOnce(this.map,'idle',
                       function(){_this.draw(true);});

        /*optionally you may hide the overlay here*/

        return;
    }
    /**
      * your drawing-instructions here
      **/

    /*show the overlay here when it has been hidden before*/
  } 
```

draw 的自动调用将在没有参数的情况下完成，建议检查是否提供了参数，

**是时**：它重绘覆盖。

**当 no 时**：它为地图的空闲事件添加一个侦听器，其中将使用参数调用绘制方法（将重绘覆盖）

# c - “X11/Xlib.h”：mac os x 山狮上没有这样的文件或目录

> ID：14321038
> 
> 赞同：14
> 
> 时间：2013-01-14T15:08:43.300
> 
> 标签：c, x11, osx-mountain-lion

我在编译一个简单的程序时遇到了这个问题：

```
 #include <X11/Xlib.h>
 #include <stdio.h>
 #include <stdlib.h>

 Display* display;

 int main(){
     display = XOpenDisplay("");
     if (display == NULL) {
         printf("Cannot connect\n");
         exit (-1);
     }
     else{
         printf("Success!\n");
         XCloseDisplay(display);
     }
  } 
```

仅供参考，我已经安装了 xQuartz。我用“g++ -o ex ex.cpp -L/usr/X11R6/lib -lX11”命令编译这个程序。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-09-25T22:43:23.503

您可能需要通过以下方式将符号链接添加到 X11 文件夹：

> sudo ln -s /opt/X11/include/X11 /usr/local/include/X11

就我而言，我必须在`usr/local`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-14T16:21:24.763

你需要编译：

```
g++ -o ex ex.cpp -I/usr/X11R6/include -L/usr/X11R6/lib -lX11 
```

标`X11`头随 一起安装`xQuartz`，但您需要明确引用它们

如果您安装`xQuartz`它，它会安装到`/opt/X11`,`/usr/X11`和`/usr/X11R6`是指向此位置的符号链接

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-10T17:18:09.797

该解决方案适用于 Mavericks 上的 ruby​​-1.9.3-p362。

```
sudo ln -s /opt/X11/include/X11 /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.9.sdk/usr/include/ 
```

# java - 使用 java 对 api 地址和 json 数据执行 HTTP DELETE

> ID：14321051
> 
> 赞同：2
> 
> 时间：2013-01-14T15:09:30.620
> 
> 标签：java, android, http-delete

我知道要向网络发送 POST 请求，我可以使用以下语法：

```
 HttpPost post = new HttpPost(api_address);
    String response = null;
    int status_code = -1;

    StringEntity se = new StringEntity(json_data, HTTP.UTF_8);
    se.setContentType("application/json");

     // Set entity
      post.setEntity(se); 
```

但是，对于 DELETE 不存在 setEntity 方法。那么发送带有数据的 DELETE 的替代方法是什么？

我看了一下：[HttpDelete with body](https://stackoverflow.com/questions/3773338/httpdelete-with-body)

但我真的不明白......我只是一个初学者！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:14:11.567

您可以使用[HttpDelete 中提供的解决方案，正文](https://stackoverflow.com/questions/3773338/httpdelete-with-body)如下：

```
HttpDeleteWithBody delete = new HttpDeleteWithBody(api_address);

StringEntity se = new StringEntity(json_data, HTTP.UTF_8);
se.setContentType("application/json");

delete.setEntity(se); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-23T06:57:40.783

这对我有用。但是 [HttpDelete 中列出的代码与正文](https://stackoverflow.com/questions/3773338/httpdelete-with-body)

正在使用注释库，因此如果您不想包含注释 jar，则将其删除，否则可以。

导入：导入 org.apache.http.annotation.NotThreadSafe；

类上面的注解：@NotThreadSafe

并将该类放在应用程序中并根据“提琴手”的评论使用它。

我相信你能有结果。因为我正在取得成功。

# php - 登录的会话变量在第一次尝试时未传递到重定向页面

> ID：14321060
> 
> 赞同：1
> 
> 时间：2013-01-14T15:09:46.583
> 
> 标签：php, session, authentication

嗨，我的管理部分有一个登录系统，但我遇到了问题，问题是用户第一次尝试登录时，$_SESSION 没有传递到目标页面，在第二次尝试时它工作正常，这就是登录页面上所说的

```
$membership = new Membership();
if($_POST && !empty($_POST['username']) && !empty($_POST['pwd'])) {
$response = $membership->validate_User($_POST['username'], $_POST['pwd']); 
```

}

在班级成员中

```
function validate_user($un, $pwd) {

    $ensure_credentials =  $this->verify_Username_and_Pass($un, $pwd);

    if($ensure_credentials) {
        $_SESSION['status'] = 'authorized';
        $_SESSION['id'] = $ensure_credentials;

        header("location: ambassadorUpdate.php");
        die;
    } else return "Please enter a correct username and password";

} 
```

当我不发送到ambassadorUpdate并且设置了SESSION时，我已经检查了代码但是如果我使用标题重定向到页面，那么第一次没有SESSION时两个页面上都有一个session_start，

当所有页面都在同一个文件夹中时，代码运行良好，但是当我将它们组织在一个单独的管理文件夹中时我遇到了这个问题，但是所有文件都正确包含，

任何想法都非常感谢非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:24:58.183

尝试修改：

```
$membership = new Membership();
if($_POST && !empty($_POST['username']) && !empty($_POST['pwd'])) {
$response = $membership->validate_User($_POST['username'], $_POST['pwd']);
}

if ($response == true){
    header("location: ambassadorUpdate.php");
} else echo "Please enter a correct username and password"; 
```

在班级成员中

```
function validate_user($un, $pwd) {

    $ensure_credentials =  $this->verify_Username_and_Pass($un, $pwd);

    if($ensure_credentials) {
        echo 'workied';
        $_SESSION['status'] = 'authorized';
        $_SESSION['id'] = $ensure_credentials;
        echo $_SESSION['status'] . $_SESSION['id'];
        return = true;
    } else return false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:52:22.443

我无法创建评论，所以我写了一个答案。有没有检查`session_start() in ambassadorUpdate.php`。您的浏览器是否接受 cookie？如果没有，使用它很有用，`"location: ambassadorUpdate.php".?SID`或者您可以使用`session_name()=session_id()`代替 SID

希望这可以帮助。

# python - 精英主义在遗传算法中失败了

> ID：14321066
> 
> 赞同：1
> 
> 时间：2013-01-14T15:10:04.243
> 
> 标签：python, genetic-algorithm

我正在尝试运行我用 python 编写的遗传算法。不幸的是，当发生突变时，尽管使用精英主义将最适合的解决方案从上一代传递给新的解决方案，但最适合的解决方案可能比上一代的最适合解决方案更差。像这样：

```
There are 86825 generations left
Invalid count is:  0
The fittest individual has a fitness of 16.9094\. 
The least fit individual has a fitness  of 36.6535
*******************************************************************************
mutation on 107
There are 86824 generations left
Invalid count is:  3
The fittest individual has a fitness of 19.8637\. 
The least fit individual has a fitness of 1.1618e+09 
```

我试图实施精英主义，我认为这会避免这种情况发生，但它仍然会发生。我的算法按以下顺序执行：

```
NUM_GEN = 100000
print "Running Genetic Algorithm for %d generations." % NUM_GEN
gen_count = 0
while gen_count < NUM_GEN:
    #genetic.add_fitness_key()
    genetic.add_fitness_fast()
    fittest_list = np.append(fittest_list, genetic.fittest_fitness)
    least_fit_list = np.append(least_fit_list, genetic.least_fitness)
    genetic.sort_pop()
    genetic.make_new_pop()
    genetic.elitism()
    genetic.population = genetic.new_pop
    print "There are %g generations left" %(NUM_GEN-gen_count) 
    gen_count+=1 
```

被调用的函数是：

```
def select_parent_from_tournament(self):
    x = random.randint(0, 19)
    player1 = self.population[x]
    y = random.randint(0, 19)
    player2 = self.population[y]
    if player1['fitness'] <= player2['fitness']:
        parent = player1['chrom_list']
    else:
        parent = player2['chrom_list']
    return parent

def crossover(self):
    crossover_point = random.randint(0, self.chromosome_size)*(self.string_length)
    parent1 = self.select_parent_from_tournament()
    parent2 = self.select_parent_from_tournament()
    parent1 = self.mutate(parent1)
    parent2 = self.mutate(parent2)
    child1 = parent1[:crossover_point] + parent2[crossover_point:]
    child2 = parent1[crossover_point:] + parent2[:crossover_point]
    return child1, child2

def mutate(self, chromosome):
    for i in range(len(chromosome)):
        if random.random() < self.mutation_rate:
            print 'mutation on %i' % i
            if chromosome[i] =='0':
                chromosome[i] = '1'
            else:
                chromosome[i] = '0'
    return chromosome

def make_new_pop(self):
    self.new_pop = []
    for i in range(10):
        dictionary1= {}
        dictionary2 = {}
        dictionary1['chrom_list'], dictionary2['chrom_list'] = \
        self.crossover()
        self.new_pop = np.append(self.new_pop, [dictionary1, dictionary2])

def elitism(self):
    r = random.randint(0, 19)
    self.new_pop[r] = self.population[0] 
```

所以我不明白为什么如果发生突变，旧人口中最适合的解决方案不会传递给新人口？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T16:57:06.310

在您的交叉方法中，您执行`parent1 = self.select_parent_from_tournament()`返回对原始种群中染色体列表的引用。在那之后，你做一个修改列表的突变（在原始人口中）。只有在突变后，您才能通过`child1 = parent1[:crossover_point] + parent2[crossover_point:]`. 正如@Xavier 建议的那样，您需要从`mutation()`.

实际上，您的`mutation()`方法改变了原始人口。

作为旁注，通常交叉和变异是两种不同的操作。此外，文献中的参考资料表明突变概率应保持在非常低的水平。否则它会让你无法收敛。

# jquery - 如何检查是否在jquery每个函数中选中了前一个复选框

> ID：14321068
> 
> 赞同：0
> 
> 时间：2013-01-14T15:10:15.623
> 
> 标签：jquery, input, checkbox, each, ischecked

我有这个可能非常大的表，它包含单行，可以使用左侧的复选框进行选择，或者它们可以包含包含自己的单独行的组，其中可以单独选择组以选择所有个人该组中的行。现在我有一个查询每个函数看起来像这样......

```
$('tbody :checked').each(function() {
    //row counter here
    if ($(this).prev("input:checkbox").is(':checked')){ 
```

所以这会检查以查看检查了哪些行，然后我有这个对我不起作用的“If”语句。基本上在每一行中我都有输入值，但是我不希望此代码在未选中复选框的任何输入上运行。因此，在每个函数中，我希望它检查是否选中了前一个复选框，如果选中则继续执行代码，如果没有则跳过它。但是，我可以轻松地为各个行执行此操作，但是我的组很复杂，因为它们可以包含许多表行，所以我不能只询问最近的表行并查看是否选中了复选框。

那么我怎样才能简单地检查我所在的输入框之前的第一个复选框是否被选中。

谢谢

编辑...
这是单行...

```
<tr class="LotTableRow">
    <td class="ColLot" colspan="2">
        <label style="font-size: 90%; font-weight: normal; height: 10px">
            <input checked="checked" id="3" name="BidderLot" onclick="participateOnClick(this);" type="checkbox" value="true"><input name="BidderLot" type="hidden" value="false">                                          New Lot
        </label>
    </td>
    <td class="ColQuantityRow">
        90
    </td>
    <td class="ColStartBid">
        <input class="text-box single-line BidderLotText" name="[0].BidderLots[0].StartBid" type="text" value="" alt="N/A" autocomplete="off">
    </td>
</tr> 
```

这可以是一个团体，但它可以永远持续下去......

```
<tr class="LotTableRow" style="display:table-row">
    <td class="ColGroup" colspan="2">
        <input name="[2].AuctionId" type="hidden" value="c7df8b82-afa8-4709-ae08-f986523e38b9">
            <input name="[2].LotGroupId" type="hidden" value="3cca6186-db7e-411b-975c-f97e7c10119c">
        <label>
            <input checked="checked" id="3cca6186-db7e-411b-975c-f97e7c10119c" name="BidderGroup" onclick="participateOnClick(this)" type="checkbox" value="true"><input name="BidderGroup" type="hidden" value="false">                                            dfgdfgdfg
        </label>
    </td>
    <td class="EnglishBidderLotCol">
    </td>
</tr>
<tr class="LotTableRow">
    <td class="LotTableSpace">
    </td>
    <td class="ColLot">
        New Lot
    </td>
    <td class="ColQuantityRow">
        20
    </td>
    <td class="ColStartBid">
        <input class="text-box single-line BidderLotText watermark" name="[2].BidderLots[0].StartBid" type="text" value="" alt="N/A">
    </td>
</tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:15:36.757

假设每个 tr 中有一个复选框，这应该有效：

```
if ($(this).parents('tr:eq(0)').prev().find('input[type="checkbox"]:checked').length){ 
```

您之前的选择器将不匹配，因为 TD 元素内没有之前的复选框。但是由于您没有发布任何 HTML，这只是我的猜测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:23:03.050

嗯，换个方式怎么样？

1.  获取每个选中的项目：

    jQuery("tbody 输入：复选框")

2.  处理每个项目

    jQuery("tbody input:checkbox").find("无论你在寻找什么来运行你的代码").each(function() {});

我希望这有帮助

# php - 返回时 sqlsrv_query 资源未知

> ID：14321070
> 
> 赞同：3
> 
> 时间：2013-01-14T15:10:20.787
> 
> 标签：php

我有一个问题`sqlsrv_query();`

我不认为这是重复的，因为我一直在搜索其他问题，但如果是这样，我会道歉。

我有两个 php 文件，一个带有数据库函数，一个使用它们，数据库文件包含在使用它的文件的顶部。

在数据库文件中，我有两个功能（以及其他连接功能）；

```
function database_GetData($sql) {
    $connection = database_GetDatabaseConnection();
    return sqlsrv_query($connection, $sql);
}

function database_ReadData($rs) {
    if (!$rs)
        return false;
    $data = sqlsrv_fetch_array($rs);
    return $data;
} 
```

问题是`database_GetData($sql)`返回资源但它是“未知的”。如果我在函数中打印`sqlsrv_query($connection, $sql)`结果或在函数中执行某些操作，`sqlsrv_fetch_array(sqlsrv_query($connection, $sql))`我会得到预期的结果，但是一旦我返回资源，它就会变得混乱。连接一切正常，因为我得到了预期的结果，但无法返回。我想保持功能与在整个应用程序中使用的功能相同。

`sqlsrv_query($connection, $sql)`一旦从`database_GetData($sql)`函数返回，是否有任何理由将结果设置为“未知”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-14T23:27:35.980

通过参考参数

```
function database_GetData($sql,&$resutl) {
     $connection = database_GetDatabaseConnection();
     $result=sqlsrv_query($connection, $sql);
     return $result;
} 
```

# android - 支持两个 Y 轴的绘图工具？

> ID：14321073
> 
> 赞同：0
> 
> 时间：2013-01-14T15:10:51.527
> 
> 标签：android, graph

我试图创建的图表是一个具有六个独立函数的折线图，所有这些函数都需要在图表和图例中轻松显示和隐藏。它还需要使用双Y轴'。双轴的原因是其中 3 个函数的 Y 值范围非常小，而其他 3 个函数的 Y 值范围非常大。

我试图在 excel 中复制一个示例：

![在此处输入图像描述](../Images/9935d7e917635e350b8b4ba69f6e5837.png) 上面显示了我的图表当前是如何设置的。线的值`pink`范围为 [-300,300]，而`blue`线的值范围为 [-50,50]。

我希望绘制如下图所示的图形： ![在此处输入图像描述](../Images/f0f7f46a7a1579f2375e1ae72a45ba72.png)

我目前正在使用[`GraphView library`](http://www.jjoe64.com/p/graphview-library.html)，但找不到对双 Y 轴的任何支持。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T15:13:27.057

AChartEngine 是一个很好的图表库。 [http://code.google.com/p/achartengine/](http://code.google.com/p/achartengine/)

我很确定它可以做到这一点。

# sql-server - Closing()，但不是 disposing() SQL 连接 - 效果

> ID：14321075
> 
> 赞同：5
> 
> 时间：2013-01-14T15:10:55.380
> 
> 标签：sql-server, connection

我读[了这个](https://softwareengineering.stackexchange.com/questions/17971/just-how-bad-is-it-not-to-dispose-sqlconnections)关于处理 SQL 连接的问题。

我的问题是，简单地关闭一个 sql 连接但不处理它有多糟糕？我们有一个简单关闭但从不释放的函数，每天使用 1000 次。是直接关闭它更好，还是关闭并处理它更好？

我知道 dispose() 也会关闭连接，但是我想知道为什么 close 不处理连接。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:16:36.493

关于连接的重要一点是关闭它们，以便将它们返回到连接池。

因此，处置和关闭连接之间几乎没有区别，只要您对关闭而不是重用连接有纪律。

但是，习惯于将连接的创建包含在`using`语句中意味着您永远不会忘记关闭它。

这是一个通用的好习惯用法 - 任何实现的对象的创建都`IDisposable`应该包含在一个`using`语句中，并且作为这样的习惯用法，它也是一个很好的习惯用法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:41:53.520

取决于它是否超出范围。如果确实如此，它将被关闭，并返回连接池（假设你没有禁用它）。因此，在您执行操作时隐式或显式调用 close 会使您的意图变得清晰，并使该连接“立即”可用于在池中重用。

想法是说服开发人员快速进出数据库。很多小额交易。不是旧样式打开一个连接然后隐藏它，这样其他人就无法得到它，以防万一再次需要它。

如果 Connection pooling 在 using 子句上，则相当于 Create、open、Close。如果它关闭，则 using 子句等效于 create、open、close、Dispose。

在任何一种情况下，真正的交易是确保它超出范围。除了非常罕见的情况外，连接应该是本地引用并且具有此特定用途的生命周期。您通常不会在运行时实例化一个并使其成为您的主窗体的属性，例如。

# c++ - 在类定义之外定义显式特化类的成员函数

> ID：14321076
> 
> 赞同：11
> 
> 时间：2013-01-14T15:10:55.060
> 
> 标签：c++

我看到一个我不理解的与模板相关的错误（编译器是 Visual Studio 2012）。这是代码，归结为要点：

```
// Templated class - generic 
template <typename T>
class Test
{
    public:
        void WorksFine() {} // Comiples and works as expected at runtime
        void Problem();     
};

// Templated class - expicit specialization for T = int.
template <>
class Test<int>
{
        public:
            void WorksFine() {} // Comiples and works as expected at runtime
            void Problem();
};

// The definition below compiles and works fine at runtime.
template<typename T> void Test<T>::Problem() {}

// The definition below gives error C2910.
template<> void Test<int>::Problem() {printf("In Test::Problem(int instantiation)\n");} 
```

对于 WorksFine 方法，函数定义*在*显式专门化的类定义中，一切正常。但是对于问题方法，当我在明确专门的类定义之外定义方法时，我得到错误 C2910

为什么是这样？错误 C2910 表明问题在于 Test::Problem() 已定义。但它*没有*在类内部定义......没有函数定义只有一个声明。

根据您选择放置函数定义的位置，是否能够做某事似乎很蹩脚，我一直认为这更像是一种风格/语法决定，而不是功能/语义决定。我错过了什么吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-14T15:14:38.213

你不需要`template<>`. 写吧：

```
void Test<int>::Problem() {printf("In Test::Problem(int instantiation)\n");} 
```

`template<>`在显式实例化一个成员*时*需要成员特化的语法；在定义已经存在的特化的成员时省略它。

```
template<typename T> struct X { static int i; };
template<> int X<int>::i = 0;  // member instantiation, uses template<>

template<typename T> struct Y { static int i; };
template<> struct Y<int> { static int i; }  // template specialization
int Y<int>::i = 0;  // no template<> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:16:06.613

您不再需要`template`显式函数定义：`void Test<int>::Problem() {printf("In Test::Problem(int instantiation)\n");}`

在这种情况下，g++ 给出了一个稍微好一点的错误信息`error: template-id 'Problem<>' for 'void Test<int>::Problem()' does not match any template declaration`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T15:19:14.917

尝试这个：

```
// The definition below gives error C2910.
void Test<int>::Problem() 
{
    printf("In Test::Problem(int instantiation)\n");
}

int main()
{
    Test<int> hey; 

    hey.Problem(); 
    return 0;
}; 
```

# spring - 如果对象不存在，则将其保存在数据库中（Hibernate & Spring）

> ID：14321080
> 
> 赞同：10
> 
> 时间：2013-01-14T15:11:17.150
> 
> 标签：spring, hibernate

我正在开发一个 Hibernate/Spring 应用程序来管理一些电影。

班级电影与班级类型有多对多的关系。这两个类都使用 GeneratedValue 注释生成了 id。

流派是通过电影对象使用@Cascade(CascadeType.SAVE_UPDATE) 保存的。我在流派的类型属性上放置了一个唯一的约束（这是它的名称；例如“幻想”）。

我现在想做的是让 Hibernate 检查是否已经存在类型为“Fantasy”的流派，如果有，则使用该流派的 id 而不是尝试插入新记录。（后者显然会抛出错误）

最后，我需要的是 select-before-update 之类的东西，但更像是 select-before-save 之类的东西。

Hibernate中有这样的功能吗？

一些代码：

电影课

```
@Entity
public class Movie {

@Id
@GeneratedValue(strategy=GenerationType.AUTO)
private int id;

private String name;

@Lob
private String description;

@Temporal(TemporalType.TIME)
private Date releaseDate;

@ManyToMany
@Cascade(CascadeType.SAVE_UPDATE)
private Set<Genre> genres = new HashSet<Genre>();

.... //other methods 
```

流派类

```
@Entity
public class Genre {

@Column(unique=true)
private String type;

@Id
@GeneratedValue(strategy=GenerationType.AUTO)
private int id

....//other methods 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-14T15:34:22.700

这个你可能想多了。任何 select-before-update/select-before-save 选项都会导致 2 次 DB 往返，第一次用于选择，第二次用于插入（如有必要）。

如果您从一开始就知道您不会有很多流派，那么大多数时候您确实有几个选择可以在 1 RT 中执行此操作：

1.  Hibernate 二级缓存可以保存许多（如果不是全部）流派，从而在检查是否存在时进行简单的哈希表查找（假设单个节点）。
2.  您可以假设您的所有流派都已经存在，使用 session.load()，并处理新的插入，因为当您引用不存在的流派时抛出未找到的行异常。

但实际上，除非您谈论大量事务，否则保存/更新之前的简单预查询不会影响您的性能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T15:26:34.930

我在 Hibernate 中没有听说过这样的功能 select-before-update/select-before-save 在这种情况下，您应该将 Hibernate 视为 JDBC。

首先，如果你想知道你是否有这样的流派，你应该查询它。

如果你这样做。那么 SAVE_UPDATE 将不会在您将其添加到电影时创建新的。如果你不这样做，Hibernate 将在数据库中创建一个新的 Genre 行并为你添加到 many_to_many 表的连接。

# phantomjs - 使用phantomjs驱动chrome

> ID：14321083
> 
> 赞同：2
> 
> 时间：2013-01-14T15:11:30.970
> 
> 标签：phantomjs

有没有办法使用 phantomjs 来驱动我的 firefox/chrome 浏览器？

我们有一堆 casperjs 测试，我想直接在浏览器中运行以进行调试（或者只是纯粹的兴趣）。

我似乎记得很久以前，在 phantomjs 变得纯粹无头之前，我可以通过使其在 X 而不是 xvfb 上运行并删除/取消注释 phantom.exit() 行来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:12:55.227

PhantomJs 是一个浏览器，所以答案是否定的。但是，您可能想研究[Karma](http://karma-runner.github.io/)。

你只需使用一个[配置](https://karma-runner.github.io/latest/config/browsers.html)文件，它允许你提供一个浏览器来运行你的测试：

*   铬合金
*   铬金丝雀
*   火狐
*   歌剧
*   Safari（仅限 Mac）
*   幻影JS
*   IE 和 Edge（仅限 Windows）
*   SauseLabs、BrowserStack Electron[等](https://www.npmjs.com/browse/keyword/karma-launcher)

尽管如此，您的测试仍需要用 QUnit、Jasmine、Mocha 等编写，从 CasperJs 移植可能需要做太多工作。

# encryption - linux的'zip'命令使用什么加密算法？

> ID：14321085
> 
> 赞同：18
> 
> 时间：2013-01-14T15:11:36.977
> 
> 标签：encryption, zip

我知道`zip`Linux 中命令提供的默认加密不被认为是安全的，但我很好奇 - 使用该`--encrypt`选项加密时它使用什么算法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:19:06.717

由于 zip 命令将写出 PKZIP 文件，因此它们将遵循他们正在实施的规范。显然，该格式允许使用几种不同的密码，通常被认为“不安全”的密码看起来像是自产的。

有关如何破解它的详细讨论，请参见此处，包括对原始算法的一些见解：http: [//math.ucr.edu/~mike/zipattacks.pdf](http://math.ucr.edu/~mike/zipattacks.pdf)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T15:48:02.473

传统加密基于 Roger Schaffely 的流密码。此处说明了精确的对称算法[http://www.academia.edu/348210/PKZIP_Algorithm](http://www.academia.edu/348210/PKZIP_Algorithm)

较新版本的 linux zip 实用程序 (zip-info) 似乎也将包括 AES 加密：http: [//www.info-zip.org/phpBB3/viewtopic.php? f=4&t=396&p=2453&hilit=aes# p2453](http://www.info-zip.org/phpBB3/viewtopic.php?f=4&t=396&p=2453&hilit=aes#p2453)

# python - Lucas Kanade python numpy 实现使用大量内存

> ID：14321092
> 
> 赞同：11
> 
> 时间：2013-01-14T15:11:56.447
> 
> 标签：python, numpy, opticalflow

作为大学项目，我正在使用 Lucas Kanade 方法编写光流脚本。虽然它运作良好，但有些事情我无法弄清楚。它在开始时使用几 MB 内存，但该数量每秒都在迅速增加。当它为 1 帧 480p 电影计算 OF 时，它使用了大约 1GB。当它达到 1.9GB 时，它会突然停止并停留在那里，即使离开了几个小时。

我尝试在另一台 PC 上运行脚本，它“仅”使用 1GB。

这真的很奇怪，因为根据我的计算，它应该使用少于 100MB 的空间。

最让我吃惊的是，脚本计算一帧后，我打印了垃圾收集器正在观看的对象数量，大约是 200 万，然后在强制收集后再次打印，结果完全一样。我等待计算第二帧（同时内存使用量增加了约 1GB），脚本打印了 GC 正在监视的对象数量 - 完全相同的数字接近 200 万。那么这是什么意思呢？那个 numpy 是用 C 语言编写的并且有内存泄漏？

我真的很想了解这种行为。

这是代码： http: [//pastebin.com/WSi7akY4](http://pastebin.com/WSi7akY4)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-14T20:06:29.607

虽然它不能解释您的内存问题，但委婉地说，您的实现是次优的。您不仅没有充分利用 numpy 的功能，而且您的算法流程也不太擅长避免重复计算。我认为您只是在资源不足的情况下运行系统，不是因为 python 或 numpy 出现问题，而是因为您创建了太多不必要的列表列表...

在查看了[维基百科关于 Lucas-Kanade 算法的条目后](http://en.wikipedia.org/wiki/Lucas%E2%80%93Kanade_method)，我重写了您的 main 函数，如下所示：

```
def lucas_kanade_np(im1, im2, win=2):
    assert im1.shape == im2.shape
    I_x = np.zeros(im1.shape)
    I_y = np.zeros(im1.shape)
    I_t = np.zeros(im1.shape)
    I_x[1:-1, 1:-1] = (im1[1:-1, 2:] - im1[1:-1, :-2]) / 2
    I_y[1:-1, 1:-1] = (im1[2:, 1:-1] - im1[:-2, 1:-1]) / 2
    I_t[1:-1, 1:-1] = im1[1:-1, 1:-1] - im2[1:-1, 1:-1]
    params = np.zeros(im1.shape + (5,)) #Ix2, Iy2, Ixy, Ixt, Iyt
    params[..., 0] = I_x * I_x # I_x2
    params[..., 1] = I_y * I_y # I_y2
    params[..., 2] = I_x * I_y # I_xy
    params[..., 3] = I_x * I_t # I_xt
    params[..., 4] = I_y * I_t # I_yt
    del I_x, I_y, I_t
    cum_params = np.cumsum(np.cumsum(params, axis=0), axis=1)
    del params
    win_params = (cum_params[2 * win + 1:, 2 * win + 1:] -
                  cum_params[2 * win + 1:, :-1 - 2 * win] -
                  cum_params[:-1 - 2 * win, 2 * win + 1:] +
                  cum_params[:-1 - 2 * win, :-1 - 2 * win])
    del cum_params
    op_flow = np.zeros(im1.shape + (2,))
    det = win_params[...,0] * win_params[..., 1] - win_params[..., 2] **2
    op_flow_x = np.where(det != 0,
                         (win_params[..., 1] * win_params[..., 3] -
                          win_params[..., 2] * win_params[..., 4]) / det,
                         0)
    op_flow_y = np.where(det != 0,
                         (win_params[..., 0] * win_params[..., 4] -
                          win_params[..., 2] * win_params[..., 3]) / det,
                         0)
    op_flow[win + 1: -1 - win, win + 1: -1 - win, 0] = op_flow_x[:-1, :-1]
    op_flow[win + 1: -1 - win, win + 1: -1 - win, 1] = op_flow_y[:-1, :-1]
    return op_flow 
```

它使用两个嵌套调用`np.cumsum`和排除-包含原则来计算窗口参数。由于要在每个点求解的方程组只有 2x2，因此它使用 Cramer 规则对求解进行矢量化。

为了比较，我将您的`lucas_kanade`函数重命名`lucas_kanade_op`为对最后一条语句的单个更改，以便它返回一个 numpy 数组：

```
def lucas_kanade_op(im1, im2, win=2) :
    ...
    return np.array(opfl) 
```

我对这两种方法都进行了计时，（并检查了它们是否输出相同）并且毫不奇怪，利用 numpy 提供了巨大的提升：

```
rows, cols = 100, 100
im1 = np.random.rand(rows, cols)
im2 = np.random.rand(rows, cols)
ans1 = lucas_kanade_op(im1, im2)
ans2 = lucas_kanade_np(im1, im2)
np.testing.assert_almost_equal(ans1,ans2)

import timeit
print 'op\'s time:', timeit.timeit('lucas_kanade_op(im1, im2)',
                                   'from __main__ import lucas_kanade_op, im1, im2',
                                   number=1)
print 'np\'s time:', timeit.timeit('lucas_kanade_np(im1, im2)',
                                   'from __main__ import lucas_kanade_np, im1, im2',
                                   number=1) 
```

这打印出来：

```
op's time: 5.7419579567
np's time: 0.00256002154425 
```

因此，对于较小的 100x100 图像，速度提高了 x2000。我不敢为全尺寸 480p 图像测试您的方法，但上面的函数每秒可以处理随机 854x480 数组上的大约 5 次计算，没有任何问题。

我建议您以类似于上面建议的方式重写您的代码，充分利用 numpy。将您的完整代码发布到[Code Review](https://codereview.stackexchange.com/)将是一个很好的起点。但是，当您的代码一开始就如此低效时，寻找对对象的杂散引用确实没有意义！

# wordpress - Genesis子主题 - 仅删除主页上的主要侧边栏

> ID：14321094
> 
> 赞同：0
> 
> 时间：2013-01-14T15:11:58.660
> 
> 标签：wordpress

我一直在寻找所有地方，但无法找到解决方案。我正在使用 Genesis Child 主题“新闻”，而对于主页，我不需要主侧边栏，因为那里有一个图像滑块。我找到了这样的代码：

```
/** Force full width layout */
add_filter( 'genesis_pre_get_option_site_layout', 'child_do_layout' );
function child_do_layout( $opt ) {
$opt = 'full-width-content'; // You can change this to any Genesis layout below
return $opt;
} 
```

并将其添加到功能页面，因为我想基本上为 home.php 强制一个全宽页面，但是它没有用。

如果有人在这方面取得了成功，我们将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:16:36.783

没关系，我为任何好奇的人找到了解决方案，在 home.php 文件中添加：

```
add_filter( 'genesis_pre_get_option_site_layout', '__genesis_return_full_width_content' ); 
```

# android - 如何使用安卓相机扫描二维码？

> ID：14321095
> 
> 赞同：-3
> 
> 时间：2013-01-14T15:12:07.960
> 
> 标签：android

> **可能重复：**
> [如何解码二维码](https://stackoverflow.com/questions/6518858/how-to-decode-qr-code)

如何在应用程序中使用相机扫描 QR 或条形码并向我显示结果？

```
 Intent intent = new Intent("android.media.action.IMAGE_CAPTURE");
    startActivityForResult(intent, 0); 
```

然后我必须放什么来捕获图像并获取产品信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:15:04.480

我建议你使用谷歌的 ZXing 库

[http://code.google.com/p/zxing/](http://code.google.com/p/zxing/)

Android Barcode Scanner，使用该库并且它的性能是成功的

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-14T15:14:28.070

除了标准相机 API 之外，您还需要使用 XZing 库。

[http://code.google.com/p/zxing/](http://code.google.com/p/zxing/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-14T15:18:31.553

我之前使用过[zxing](http://code.google.com/p/zxing)作为二维码采集库。它对我来说效果很好。Android 也有一些很好的文档。

[在这里](http://code.google.com/p/zxing/wiki/GettingStarted)查看入门。

一旦你开始，这里是一个很好的入门教程。 [http://www.androidaz.com/development/zxing-qr-reader-direct-integration](http://www.androidaz.com/development/zxing-qr-reader-direct-integration)

# c# - C# EF Code First 虚拟关键字，它有什么作用？

> ID：14321097
> 
> 赞同：15
> 
> 时间：2013-01-14T15:12:10.403
> 
> 标签：c#, .net, entity-framework, ef-code-first

为什么我们在声明导航属性时需要使用“virtual”关键字？我了解 Code First 框架以某种方式使用它来识别该属性是导航属性，但我想知道如何。具体来说，我想知道它与 MSDN 文档中对“虚拟”关键字的描述有何关系：http: [//msdn.microsoft.com/en-us/library/9fkccyh4(v=vs.80) .aspx](http://msdn.microsoft.com/en-us/library/9fkccyh4(v=vs.80).aspx)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-14T15:59:20.990

在运行时，实体框架将为您生成所谓的**代理实体**。这些实体是**从您的实体类型派生的动态创建类型**的对象。

这允许您将实体用作**POCO**，这是一个简单的对象，与 Entity Framework 没有任何关系，因为它不继承自`EntityObject`.

在运行时，动态创建的实体类型从您的 POCO 继承，并覆盖您的所有虚拟属性以添加允许在属性 getter 中延迟加载的实体框架内容。

延迟加载是一个复杂的过程，需要您的代码了解数据如何来自数据库。由于您不希望您的域类了解数据库和 EF 内容，因此您从 EF 中抽象出您的实体并添加虚拟属性，因此 EF 可以覆盖您的基本 POCO 并在运行时添加其与 DB 相关的内容。

更改[跟踪](http://msdn.microsoft.com/en-us/library/vstudio/dd456848%28v=vs.100%29.aspx)也是如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:14:06.170

添加`virtual`允许 EF 生成一个派生类，该类覆盖该属性并从数据库返回一个集合。

# flash - 在 Flash Builder 4.7 中启动新的 actionscript 项目：没有可用的 SDK 选择

> ID：14321101
> 
> 赞同：1
> 
> 时间：2013-01-14T15:12:34.657
> 
> 标签：flash, apache-flex, flash-builder

我正在使用 Flash Builder 4.7。启动新的 Actionscript 项目时，您定义项目名称等的第一个弹出框不显示任何 SDK。所以在“这个项目将使用”下只有一个空白区域......

在创建的项目中，我也无法链接到 Actionscript 构建路径中的 Flex SDK。

开始一个新的 Flex 项目时，一切正常，我可以在安装的不同 SDK 之间进行选择。

知道有什么问题吗？

提前感谢您的帮助！

坦率

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T09:13:58.803

多亏了这篇博文，发现并解决了问题： [http ://www.badu.ro/?p=238](http://www.badu.ro/?p=238)

显然，当从 Flex Builder 4.6 迁移到 4.7 时，您必须使用新的工作区。如果您重用 4.6 版中的现有问题，您会遇到像我遇到的问题......

感谢你的帮助，

坦率

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:48:24.487

我怀疑您看到错误是因为您的类没有包定义。

```
package com.something.something
{
// imports
import flash.display.Sprite
// class definition

    public class Something extends Sprite{

    }
} 
```

但是，您没有在屏幕截图中向我们展示实际错误。如果这不是错误，请提供编译器错误/警告的文本​​。在 Flash Builder 中，从窗口菜单中选择显示视图和问题。

# ios - iOS：如何让 UIWebView 加载非移动网站？

> ID：14321108
> 
> 赞同：2
> 
> 时间：2013-01-14T15:13:18.760
> 
> 标签：ios, objective-c, uiwebview

我怎样才能`UIWebView`加载非移动网站？

目前我正在使用这个：

```
 NSMutableURLRequest *request = [NSURL URLWithString:websiteLink];
 [request setValue:
      [NSString stringWithFormat:@"%@ Safari/528.16", [request valueForHTTPHeaderField:@"User-Agent"]]  
      forHTTPHeaderField:@"User_Agent"];
 [webView loadRequest:request]; 
```

但加载 Web 视图时应用程序崩溃。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:25:33.743

您必须在请求中指定用户代理：

```
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
[request setValue:@"<Your-User-Agent>" forHTTPHeaderField:@"User-Agent"]; 
```

哪里可能是这样的：

```
[NSString stringWithFormat:@"%@ Safari/<version number>", [request valueForHTTPHeaderField:@"User-Agent"] 
```

## 编辑：

我的用户代理字符串是这样的：

> Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/536.26.17 (KHTML, like Gecko) 版本/6.0.2 Safari/536.26.17

请注意，**网络服务器通常会缓存您的浏览器信息等信息**，因此如果您已经访问过该网站，上述代码可能无法正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T16:58:40.677

乔纳森，

已经有几天了，但如果你还在寻找这个问题的答案 - 问题就在这里：

```
NSMutableURLRequest *request = [NSURL URLWithString:websiteLink]; // <-- BUG 
```

您正在将 NSURL 填充到 MutableURLRequst 中。哎呀！

这是你打算做的：

```
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:websiteLink]]; 
```

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:17:53.983

根据错误（在您添加的图片中），您正在调用一个不存在的选择器。具体来说，调用`valueForHTTPHeaderField:`（`request`这是一个 NSURL）是无效的，因为 NSURL 不响应该方法。

# sql - 如何比较 SQL 语句中 OUTER JOIN ON 子句中文本/字符串的整数值？

> ID：14321116
> 
> 赞同：-2
> 
> 时间：2013-01-14T15:13:33.220
> 
> 标签：sql, vba, ms-access

我想在为 MS Access 编写的 VBA 代码中执行下面的 SQL 语句。

我希望在`JOIN ON`标准中比较 ID 字段的整数值。

使用时出现错误`CInt()`。我也试过`Val()`,`CAST()`和`Convert()`.

```
Set RecordSet = "SELECT A.id, B.id 
FROM A LEFT OUTER JOIN B ON CInt(A.id)=CInt(B.id)" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:15:04.833

Lillyana 最好是`outer join`在 MS ACCESS 中进行查询，然后进入 sql 视图。

*   [MS ACCESS 外连接](http://office.microsoft.com/en-us/access-help/creating-an-outer-join-query-in-access-HA001034555.aspx)

那么`Nz`函数：当你的 columnn 的值为`null`

*   [新西兰](http://office.microsoft.com/en-sg/access-help/nz-function-HA001228890.aspx)

您遇到错误的通常情况是由于，

*   [SQL 语句无法执行，因为它包含不明确的外部连接。要强制首先执行其中一个连接，请创建一个单独的查询来执行第一个连接，然后将该查询包含在您的 SQL 语句中。（错误 3258）。](http://office.microsoft.com/en-us/access-help/HV080761359.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:17:53.570

假设您所有的 id 字段确实是整数，`CInt()`应该可以正常工作。如果您的数字较大，请尝试`CLng()`：

```
SELECT A.id, B.id 
FROM A 
   INNER JOIN B ON CLng(A.id)=CLng(B.id) 
```

# html - 如何在不使用 get 的情况下将 id 传递给 servlet？

> ID：14321118
> 
> 赞同：0
> 
> 时间：2013-01-14T15:13:34.407
> 
> 标签：html, jsp

如何在不使用 get 方法的情况下传递 id？只有post方法..

这是我的具有 get 方法的代码：

```
<c:forEach var="student" items="${studentList}">
    <tr>
    <td><c:out value="${student.firstName}" /></td>
    <td><c:out value="${student.middleName}" /></td>
    <td><c:out value="${student.lastName}" /></td>
    <td><c:out value="${student.yearLevel}" /></td>
    <td><c:out value="${student.scholarship}" /></td>
    <td><a href="student?page=edit&id=${student.id}">Edit</a></td>
    <td><a href="student?page=delete&id=${student.id}">Delete</a></td>
    </tr>
</c:forEach> 
```

我试着用

```
 <input type="hidden" name="edit" value="${student.id}">
   <input type="hidden" name="delete" value="${student.id}"> 
```

但是列表中的第一个学生将始终被编辑，学生列表中的第一个将被删除

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:15:20.113

您需要`<form>`为每个按钮创建一个单独的标签。

否则，您的所有按钮将共享表单中的所有输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:31:45.893

如果你能够使用 jQuery，你可以这样做：

```
<script type="text/javascript">
$(function() {
    $(".studentAction").off("click").on("click", function() {
        var url = "student";
        url += "?page=" + $(this).attr("name");
        url += "&id=" + $(this).val();
        $.ajax({
            type: "POST",
            url: url,
            async: false,
            success: function(data) {
                // on success
            },
            error: function(data) {
                // on error
            }
        };
    });
});
</script>

<input class="studentAction" type="hidden" name="edit" value="${student.id}">
<input class="studentAction" type="hidden" name="delete" value="${student.id}"> 
```

# ios - RestKit 连接失败委托

> ID：14321119
> 
> 赞同：2
> 
> 时间：2013-01-14T15:13:36.690
> 
> 标签：ios, web-services, delegates, restkit

我正在尝试在连接失败时测试我的应用程序的行为。我正在关闭 wifi 的 iPad 上进行测试。当 Restkit 尝试调用 Web 服务时，我收到以下错误：

```
CPL[7713:6203] E restkit.network:RKRequest.m:545 Failed to send request to https://xxxxxxxx/APNS_WebService/rest/operations/initializeDevice?deviceID=c4a17f855d3cc824b174b71908480d4e505ebfb221cb4643da9270a07344c367 due to unreachable network. 
```

问题是我想在委托回调方法中处理这种情况，但没有调用任何委托方法。我已经在请求上设置了委托，并实现了 requestDidFailLoadWithError、requestDidCancelLoad、requestDidTimeout 和 objectLoaderDidFailWithError。这些都没有被调用。

为什么不叫我的代表？

**编辑：**在 RKRequest.m 中设置断点后，我看到实际上正在执行以下行：

```
 [self performSelector:@selector(didFailLoadWithError:) withObject:error afterDelay:0]; 
```

但是，我的委托方法没有被调用。

这是我设置委托的地方：

```
request = [client requestWithResourcePath:[NSString stringWithFormat:@"/initializeDevice?deviceID=%@",deviceID]];
request.delegate=self;
[request sendAsynchronously]; 
```

**编辑 2：**实际上，我在上面发布的 RKRequest.m 中的行只是调用 RKRequest 中的另一个方法，但事实并非如此。在 didFailLoadWithError 中设置断点表明永远不会到达此代码。我不明白为什么这不起作用。

将 performSelector 更改为常规方法调用会出现在表面上，以提供我正在寻找的行为。这会破坏什么吗？我想我不确定为什么使用 performSelector 来调用同一类中的方法。

**编辑 3：**根据要求，这是我的委托方法：

```
-(void)request:(RKRequest *)request didFailLoadWithError:(NSError *)error{
    NSLog(error.domain);
    NSLog([NSString stringWithFormat:@"%d",error.code]);
    NSLog(error.localizedDescription);
    NSLog(error.localizedFailureReason);

    [request reset];
    [request send];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:29:34.750

编辑：

> 实际上，我在上面发布的 RKRequest.m 中的行只是调用了 RKRequest 中的另一个方法，但事实并非如此。在 didFailLoadWithError 中设置断点表明永远不会到达此代码。我不明白为什么这不起作用。

这真的很奇怪。我会尝试彻底清理项目并重建。

至于什么需要直接调用而不是使用`performSelector`，您可以看到`afterDelay`：

```
[self performSelector:@selector(didFailLoadWithError:) withObject:error afterDelay:0]; 
```

这将使该`didFailLoadWithError:`方法在运行循环的下一次迭代中被调用。我会保持这种称呼方式。

但是，您可以尝试使用以下替代方法：

```
dispatch_async(dispatch_get_current_queue(), ^() { 
                       [self didFailLoadWithError:error]; } ); 
```

我建议在您正在使用的 RestKit 方法中设置一个断点（我想`sendAsynchronously`）并检查会发生什么。如果您查看方法定义，则会有效地调用委托：

```
 } else {
        self.loading = YES;

        RKLogError(@"Failed to send request to %@ due to unreachable network. Reachability observer = %@", [[self URL] absoluteString], self.reachabilityObserver);
        NSString* errorMessage = [NSString stringWithFormat:@"The client is unable to contact the resource at %@", [[self URL] absoluteString]];
        NSDictionary *userInfo = [NSDictionary dictionaryWithObjectsAndKeys:
                                  errorMessage, NSLocalizedDescriptionKey,
                                  nil];
        NSError* error = [NSError errorWithDomain:RKErrorDomain code:RKRequestBaseURLOfflineError userInfo:userInfo];
        [self performSelector:@selector(didFailLoadWithError:) withObject:error afterDelay:0];
    } 
```

# wpf - WPF - FocusVisualStyle 移动

> ID：14321122
> 
> 赞同：0
> 
> 时间：2013-01-14T15:13:54.507
> 
> 标签：wpf, focusvisualstyle

我有一个带有一些按钮的 UserControl。我的按钮具有默认的 FocusVisualStyle（按钮周围的边框）。

当我用鼠标移动我的用户控件时，这个虚线边框不会随之移动。当您将鼠标悬停在屏幕的另一部分上时，它会移动到正确的位置。

我不想将 FocusVisualStyle 设置为 null，因为我需要查看聚焦的元素。我尝试创建自己的 FocusVisualStyle，但它的行为与默认样式相似。

我可以以某种方式将此边框与其余元素同步吗？

感谢帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T16:03:45.460

正如 bitbonk 所说，RenderTransform 不会导致另一个排列过程，因此焦点视觉不会移动。您可以阅读[这篇 WPF 博士文章](http://drwpf.com/blog/2010/01/29/render-transforms-and-focus-visuals/)，该文章讨论了该问题并提供了一些解决方法。在您的情况下，最简单的方法是将 AdornerDecorator 放在您的 UserControl 中围绕您的 UserControl 的内容，以便 AdornerLayer 也被移动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:20:28.703

当您使用矩形时`RenderTransform`，`FocusVisualStyle`不会随按钮一起移动，因为它是在布局过程中呈现的。这就是`RenderTransform`: 转换任何视觉对象并忽略视觉树其余部分的布局。

您必须使用`LayoutTransform`、`Button.Margin`或`Canvas.Left`、`Canvas.Top`来移动您的按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-24T17:06:37.187

[MSDN](https://msdn.microsoft.com/en-us/library/bb613567(v=vs.110).aspx)的这段（有点神秘）摘录说明了这个问题的更一般形式：

> 焦点视觉样式专门用于键盘焦点。因此，焦点视觉样式是一种可访问性功能。如果您希望通过鼠标、键盘或以编程方式对任何类型的焦点进行 UI 更改，则不应使用焦点视觉样式，而应在样式或模板中使用设置器和触发器，这些样式或模板根据一般焦点属性的值工作例如 IsFocused 或 IsFocusWithin。

今天，关于使用触发器的最后一点可能会更好地替换为使用可视状态管理器的建议。这是一些这样做的 XAML，但也保留了`Button`'s的原始设置`FocusVisualStyle`。`Button`当它从键盘接收焦点时，该设置会在 a 内绘制一个两个像素的虚线矩形。`Storyboard`用于`Focused`和视觉状态的我的 s`Unfocused`添加和删除一个实心矩形，在 a 内有四个像素`Button`，只要它因任何原因获得或失去焦点。

如果您在 WPF 窗口中创建一对`Button`s 并通过键盘和鼠标操作焦点，`Button`用空格键和鼠标单击这些 s，您会看到 a通常在不出现`Button`时具有焦点。`FocusVisualStyle`同样，这（根据上面的摘录）是设计使然。（我对这是一个“辅助功能”感到困惑，因为它很容易忽略显示下次按下空格键时将单击哪个控件。我的倾向是根本不使用它。）

注意：下面的代码是用于派生自 的自定义控件`Button`，称为“ `XLButton`。” 如果您不想创建自定义控件来尝试此操作，可以将`Style`'s`TargetType`更改为。`Button`

```
<ResourceDictionary
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:local="clr-namespace:ExLuminaControls">

<Style x:Key="FocusVisual">
    <Setter Property="Control.Template">
        <Setter.Value>
            <ControlTemplate>
                <Rectangle Margin="2"
                           SnapsToDevicePixels="true"
                           Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                           StrokeThickness="1"
                           StrokeDashArray="1 2"/>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>

<SolidColorBrush x:Key="Button.Static.Border" Color="#FF707070"/>

<Style TargetType="{x:Type local:XLButton}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}"/>
    <Setter Property="BorderBrush" Value="{StaticResource Button.Static.Border}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="{x:Null}"/>
    <Setter Property="Padding" Value="1"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type local:XLButton}">
                <Grid>
                    <Border x:Name="border"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Background="{TemplateBinding Background}"
                            SnapsToDevicePixels="true"/>
                    <Rectangle x:Name ="glow" Fill="White" Opacity="0"/>
                    <Rectangle x:Name="shade" Fill="Black" Opacity="0"/>
                    <ContentPresenter x:Name="contentPresenter"
                                      Focusable="False"
                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                      Margin="{TemplateBinding Padding}"
                                      RecognizesAccessKey="True"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                    <Rectangle x:Name="dis" Fill="Gray" Opacity="0"/>
                    <Rectangle x:Name="foc" Margin="4" SnapsToDevicePixels="true"
                               Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                               StrokeThickness="1" Opacity="0"/>
                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup Name="CommonStates">
                            <VisualState Name="Normal">
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetName="glow"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="0" Duration="0:0:.1"/>
                                </Storyboard>
                            </VisualState>
                            <VisualState Name="MouseOver">
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetName="glow"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To=".25" Duration="0:0:.1"/>
                                </Storyboard>
                            </VisualState>
                            <VisualState Name="Pressed">
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetName="shade"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To=".25" Duration="0:0:0"/>
                                </Storyboard>
                            </VisualState>
                            <VisualState Name="Disabled">
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetName="dis"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To=".25" Duration="0:0:0"/>
                                </Storyboard>
                            </VisualState>
                        </VisualStateGroup>
                        <VisualStateGroup Name="FocusStates">
                            <VisualState Name="Focused">
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetName="foc"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1" Duration="0:0:.1"/>
                                </Storyboard>
                            </VisualState>
                            <VisualState Name="Unfocused">
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetName="foc"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="0" Duration="0:0:.1"/>
                                </Storyboard>
                            </VisualState>
                        </VisualStateGroup>
                    </VisualStateManager.VisualStateGroups>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
</ResourceDictionary> 
```

# r - 将数据框写入 pdf 表

> ID：14321127
> 
> 赞同：8
> 
> 时间：2013-01-14T15:14:07.690
> 
> 标签：r

我有一个数据框，我想以有组织的方式将其写入 pdf 文件。

例如，我的 df 看起来像这样：

```
Date    County    Trade
1/1/2012  USA     5
1/1/2012  Japan   4
1/2/2012  USA     10
1/3/2012  Germany 15 
```

我想按日期输出分组，在每组之后放置一个空格或换行符；

我有这段代码，但这会将所有内容打印到 pdf 文件中而不进行分组：

```
library(gridExtra)
pdf("trade.pdf", height=11, width=8.5)
grid.table(df)
dev.off() 
```

有什么想法可以最好地将这个数据集呈现在一个 pdf 文件中并按日期分组？我喜欢使用grid.Extra。有人知道如何给grid.Extra加上标题吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-14T15:54:43.147

此代码应该可以工作：

```
library(gridExtra)

df <- read.table(text = 
"1/1/2012  USA     5
1/1/2012  Japan   4
1/2/2012  USA     10
1/3/2012  Germany 15"
)
names(df) <- c("Date","Country","Trade")

EqDatedf <- as.data.frame(df[1,])
EmptyLine <- data.frame(Date = "",Country = "",Trade = "")

pdf(file = "q.pdf")

for (i in 2:nrow(df)) 
{
if (as.vector(df$Date[i])  ==  as.vector(df$Date[i-1])) 
{EqDatedf <- rbind(EqDatedf, df[i,])}

else {
EqDatedf <- rbind(EqDatedf, EmptyLine)
EqDatedf <- rbind(EqDatedf, df[i,]) 
     }
}

grid.table(EqDatedf, show.rownames = FALSE)
dev.off() 
```

![在此处输入图像描述](../Images/a0342fbf28490eb7f219c730e20a57f8.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-14T16:04:04.793

我真的建议你使用`Rstudio`with `Knitr`。创建好的报告非常容易。

例如，

```
\documentclass{article}
\begin{document}
<<myTable,results='asis'>>=
library(xtable)
tab <- read.table(text = 'Date    County    Trade
1/1/2012  USA     5
1/1/2012  Japan   4
1/2/2012  USA     10
1/3/2012  Germany 15',header = TRUE)
print(xtable(tab),hline.after=c(2,3))   ## print.xtable have many smart options
@
\end{document} 
```

![在此处输入图像描述](../Images/fb9eb3ff71fb8b7b096149016a23bac3.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-29T10:09:35.687

截至 2017 年，R-studio 演示格式 (Markdown) 与包“pander”得到了很好的支持，并通过 Beamer 输出为 PDF。见潘德：[http ://rapporter.github.io/pander/#pander-an-r-pandoc-writer](http://rapporter.github.io/pander/#pander-an-r-pandoc-writer)

R-studio 演示代码中将数据帧打印为表格的示例：

```
```{r}    
pander(df)
``` 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-04T20:13:20.530

grid.table 解决方案将是为短表格创建 PDF 的最快方法，但如果您的表格长度超过 1 页，此解决方案将无法正常工作。RStudio + knitr + longtable 可能是创建格式良好的 PDF 的方法。你需要的是这样的：

```
\documentclass{article}
\usepackage{longtable}
\begin{document}

<<results='asis'>>=
library(xtable)

df = data.frame(matrix(rnorm(400), nrow=100))
xt = xtable(df)
print(xt, 
      tabular.environment = "longtable",
      floating = FALSE
      )
@
\end{document} 
```

请参阅[这篇](https://thusithamabotuwana.wordpress.com/2016/01/02/creating-pdf-documents-with-rrstudio/)文章了解更多详情。

# java - 打印字符串后客户端应用程序套接字关闭

> ID：14321129
> 
> 赞同：0
> 
> 时间：2013-01-14T15:14:13.200
> 
> 标签：java, sockets, client

我正在构建一个需要向服务器发送消息并随后接收响应的 Java 客户端应用程序。我可以成功发送消息，问题是我无法获得响应，因为我在尝试读取 'BufferedReader' 时遇到 IO 异常（“Socked 已关闭”）。

这是我的代码，到目前为止：

```
public class MyClass {

    /**
     * @param args the command line arguments
     */
    @SuppressWarnings("empty-statement")
    public static void main(String[] args) {
        JSONObject j = new JSONObject();
        try {
            j.put("comando", 1);
            j.put("versao", 1);
            j.put("senha", "c4ca4238a0b923820dcc509a6f75849b");
            j.put("usuario", "1");
            j.put("deviceId", "1");

        } catch (JSONException ex) {
            System.out.println("JSON Exception reached");
        }

        String LoginString = "{comando':1,'versao':1,'senha':'c4ca4238a0b923820dcc509a6f75849b','usuario':'1','deviceId':'1'}";
        try {
            BufferedReader inFromUser = new BufferedReader(new InputStreamReader(System.in));

            Socket clientSocket = new Socket("10.1.1.12", 3333);
            System.out.println("Connected to the server successfully");
            PrintWriter outToServer = new PrintWriter(clientSocket.getOutputStream(),true);

            outToServer.println(j.toString());
            outToServer.close();
            System.out.println("TO SERVER: " + j.toString());

            BufferedReader inFromServer = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));

            String resposta = inFromServer.readLine();
            System.out.println("FROM SERVER: " + resposta);

            clientSocket.close();
        } catch (UnknownHostException ex) {
            System.out.println("Could not connect to the server [Unknown exception]");
        } catch (IOException ex) {
            System.out.println(ex.getMessage());
        } 
    }
} 
```

**我知道由于OutToServer.close()**正在关闭套接字，但关闭流是发送消息的唯一方法。我应该如何处理这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:32:31.150

`flush()`不是这样的`new PrintWriter(, true)`。

真正的问题是您正在关闭`PrintWriter outToServer`包装底层`InputStream`的 . ，再次来自`Socket`.

当您关闭时，`outToServer`您将关闭整个套接字。

您必须使用[Socket#shutdownOutput()](http://docs.oracle.com/javase/7/docs/api/java/net/Socket.html#shutdownOutput%28%29)。

如果您想保留套接字的输入/输出通道以进行进一步通信，您甚至不必关闭输出。

1.  `flush()`当你完成任何`writeXXX`. 这些`writeXXX`实际上并不意味着您将这些字节和字符发送到套接字的另一端。

2.  您可能必须关闭**输出，并且只关闭输出，**以向服务器发出您发送的所有必须发送的信号。这实际上是服务器端套接字的愿望问题。

```
final Socket socket = new Socket(...);
try {
    final PrintStream out = new PrintStream(socket.getOutputStream());
    // write here
    out.flush(); // this is important.
    socket.shutdownOutput(); // half closing

    // socket is still alive

    // read input here

} finally {
    socket.close();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:20:05.530

试着打电话`outToServer.flush()`

这将尝试从缓冲区中刷新数据，尽管它仍然不能保证它会被发送。

# java - 获取 Java 类的可用成员的名称

> ID：14321132
> 
> 赞同：2
> 
> 时间：2013-01-14T15:14:22.780
> 
> 标签：java, member, names, field-names

我正在尝试获取 Java 中类的成员名称。例如，假设我有这个类：

```
class Dog
{
    private int legs = 4;
    private int ears = 2;
} 
```

无论如何我可以获得字段名称及其类型的列表，例如

`{ "legs" : "int", "ears" : "int" }`.

*请注意，为了方便起见，我用 JSON 编写了示例结果，但我是用 Java 编写的。*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-14T15:15:48.880

用途`Class#getDeclaredFields()`：-

```
for(Field f : Dog.class.getDeclaredFields()) {
    f.setAccessible(true);
    String name = f.getName();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T15:17:26.190

```
Field[] fields = Dog.class.getFields(); 
```

并调用`getName()`每个元素

# php - 从 Google Docs 下载电子表格返回 401 Unauthorized

> ID：14321133
> 
> 赞同：0
> 
> 时间：2013-01-14T15:14:23.347
> 
> 标签：php, zend-framework, google-drive-api, gdata

我正在尝试创建一个备份用户所有文档的脚本。对于文本文档，一切正常，但对于电子表格，我拥有的内容是 401 Unauthorized。

任何人都知道为什么会这样？

这是我正在使用的一些代码：

```
foreach($feeds 作为 $item)
{
    $saveFilePath = $save_path 。'/' 。$item->getTitle() 。“。” . $docType["格式"];

    $uri = $item->getContent()->getSrc() 。"&exportFormat=" 。$docType["格式"]);;

    $数据 = $文档
                ->getHttpClient()
                ->setUri($uri)
                ->请求（）
                ->getBody();

    $fp = fopen($saveFilePath, "wb");
    fwrite($fp, $data);
    fclose($fp);

}

```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T07:44:16.273

[这里](https://developers.google.com/drive/v2/reference/files/get)有一个在线 google 示例让您尝试下载 google 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T03:47:12.570

要使用（已弃用）文档列表 API 和 OAuth 作为授权机制从 Google Drive 下载所有类型的文件，您必须请求访问以下所有范围：

```
https://docs.google.com/feeds/
https://docs.googleusercontent.com/
https://spreadsheets.google.com/feeds/ 
```

更好的是，您应该使用更新的 Drive API：http: [//developers.google.com/drive](http://developers.google.com/drive)

# ios - 如何根据它们存储的服务器数据组织 UICollectionViewCells？

> ID：14321138
> 
> 赞同：0
> 
> 时间：2013-01-14T15:14:37.963
> 
> 标签：ios, database, api, uicollectionview, uicollectionviewcell

我有显示用户拍摄并添加到`UICollectionView`. 在 API 服务器上，这些图像是由`timestamp`（见下文）组织的，这意味着在应用程序中，显示的第一个单元格是最近上传到服务器的图像。

在服务器上，它看起来像这样：

```
results: [
{
i_id: "28",
title: "image title",
description: "Picture",
longitude: "0.000000",
latitude: "0.000000",
filename: "http://server.com/images/image.jpg",
timestamp: "12:34:04",
n_likes: "0",
n_comments: "1",
images: {

}
},

{
i_id: "21",
title: "another image title"
description: "another Picture",
longitude: "0.000000",
latitude: "0.000000",
filename: "http://server.com/images/image.jpg",
timestamp: "12:20:49",
image: "",
n_likes: "2",
n_comments: "4",
images: {

}
}
] 
```

我能够`n_comments`毫无问题地将每个图像的数据放入一个数组中。`UICollectionView`我希望数组计算索引处每个对象的数字，并根据对象包含的数字（如果有意义的话）确定哪个将在第一个显示。

Would this be something that I’d have to manage on the server, or can I do it within the app’s code? I’m guessing that it has to do with `UICollectionViewLayout`, so that’s where I’ll be attempting to get it to work in the meantime.

Any advice would be much appreciated! Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:02:17.520

You could do this on either end, but you don't need to do anything with UICollectionViewFlowLayout. On the app end, you could sort your array with sortedArrayUsingDescriptors: with a descriptor of sortDescriptorWithKey:ascending:, passing n_comments as the key.

# jquery - 在光标 x 位置触发 Bootstrap 弹出窗口？

> ID：14321140
> 
> 赞同：1
> 
> 时间：2013-01-14T15:14:41.500
> 
> 标签：jquery, twitter-bootstrap, popover

我在页面上有一个 UI 元素，它基本上是视口内的 10000px+ 宽滚动面板。（想想“电视指南”）滚动面板由许多行形式的“频道”组成，其中包含相对定位的 div（想想节目）——这些节目显然可以有不同的长度，并且可能比页。

每个程序都有一个绑定到它的引导弹出窗口，它可以很好地触发 - 问题是如果“程序” div 比屏幕宽，弹出窗口总是在数据绑定 div 的中心触发 - 所以可能会出现 -屏幕。

~~当点击~~悬停事件被触发时，任何人都可以想到一种简单但可靠的跨浏览器方法来使弹出框在光标的 x 位置触发吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T15:25:37.907

最后，编辑工具提示功能更简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:22:42.547

您始终可以在单击事件上添加事件处理程序，然后在处理程序内部检查 x 位置并相应地触发弹出窗口。

您还可以提供一些代码片段以使您的问题更清楚...

# java - 了解 Java 中由容器管理的对象的垃圾收集

> ID：14321142
> 
> 赞同：4
> 
> 时间：2013-01-14T15:14:49.383
> 
> 标签：java, jsf, garbage-collection

假设我有一个名为的托管 bean假设`A`有对另一个托管 bean 的引用并声明为. 引用另一个具有更长范围的 bean的事实是否会阻止在结束时收集垃圾？`@RequestScoped``A``B``B``@SessionScoped``A``A``HttpRequest`

情况是否会反过来改变，即是否`B`包含对 的引用`A`？如果是，那为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-14T15:42:45.300

> *`A`引用另一个具有更长范围的 bean的事实是否会阻止`A`在结束时收集垃圾`HttpRequest`？*

不，对象实例只有在不再引用它时才有资格进行 GC。

默认情况下，请求范围的 bean 仅在当前 HTTP 请求中引用（作为[请求属性](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#setAttribute%28java.lang.String,%20java.lang.Object%29)）。因此，如果 HTTP 请求完成并被销毁，则请求范围的 bean 将完全取消引用，因此有资格进行 GC。请求范围 bean 又包含对会话范围 bean 的引用，这与 GC 完全无关。只有当会话范围的 bean 没有在任何地方被引用时（例如，当会话过期时），会话范围的 bean 反过来才符合 GC 的条件。

* * *

> *如果 B 包含对 A 的引用，情况是否会反过来改变？如果是，那为什么？*

是的，它会改变。默认情况下，会话范围的 bean 仅在 HTTP 会话中引用（作为[会话属性](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpSession.html#setAttribute%28java.lang.String,%20java.lang.Object%29)），它的寿命比 HTTP 请求长。因此，请求范围的 bean 将与已建立的 HTTP 会话一样长。这将导致潜在的数据完整性问题，因为您引用的东西本应不应该存在那么久。这就是为什么 JSF 不允许您通过`@ManagedProperty`.

总而言之，托管 bean 范围不应该根据 GC 行为来选择，而是根据它所拥有的数据来选择。另请参阅[如何选择正确的 bean 范围？](https://stackoverflow.com/questions/7031885/how-to-choose-the-right-bean-scope)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:17:41.697

No.GC 仅取决于有多少活动引用指向对象，而不是其他方式。JVM 总是维护一组活跃的引用。任何从这个根引用集无法访问的东西都有资格进行垃圾回收。所以即使一个对象是 A 指向另一个活动的对象 B，如果内存中没有其他对象引用 A，那么 A 是可用的为 GC。

在您的情况下，A 的范围仅限于单个请求。因此，当服务器完成该请求处理时，如果没有内存泄漏，A 将可用于 gc。B 将保留在内存中，因为它具有会话范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T15:30:14.540

在您的示例中，您有这种情况：请求范围引用对象 A、A 和会话范围引用对象 B。请求结束时，它被删除，因此没有引用对象 A。它可以被垃圾收集。之后 Session 仍然引用对象 B 并且无法收集。根据Java规范：

> 当任何代码无法访问对象时，它就有资格进行垃圾收集。

这意味着当对象不可到达时很简单。在这种情况下，A 将无法到达，但 B 会。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T15:30:18.127

在任何情况下，如果从根对象之一引用您的对象（只要有一种方法可以从 Main() 或任何其他静态/单例/bean 中获取它，不管它有多深） ) 它不会被 GC 收集

# javascript - 将文本区域更改为 完成编辑后的元素

> ID：14321146
> 
> 赞同：0
> 
> 时间：2013-01-14T15:15:03.420
> 
> 标签：javascript, jquery, html

我有以下代码：

```
var counter=0;
function appendText(){
    var text = $("#text").val();

    if ( $("#text").val() ){

    var textArea = "<div class='divex'> <textarea id='t"+counter+"'>"+text+"</textarea><button id='b"+
    counter+"'name='t"+counter+"' >edit</button> <button onClick='moveUp()' id='updiv'>Up:></button></div>";    
    $("#text").val();
    $("#addedText").after(textArea);
    $("#t"+counter).clear;    
    $("#t"+counter).attr('readonly','readonly');
    $("#b"+counter).bind('click',makeAreaEditable);
    $("#text").val('');

    counter++;
    }
    else{
    }   
};                                                                  

var makeAreaEditable = function()
{
    var target = event.target || event.srcElement || event.originalTarget;
    var button = $("#"+target.id);
    button.text("OK");
    button.unbind('click');
    button.bind('click',saveEdit);
    var targetArea = $("#"+target.name);
    targetArea.removeAttr('readonly');

};                                                      

var saveEdit =  function()
{
    var target = event.target || event.srcElement || event.originalTarget;
    var button = $("#"+target.id);
    button.text("edit");
    button.unbind('click');
    button.bind('click',makeAreaEditable);
    var targetArea = $("#"+target.name);
    targetArea.attr('readonly','readonly');

}; 
```

html 看起来像这样：

添加文字

```
 <div id="addedText" style="float:left">
    </div> 
```

我想更改此脚本，以便：当我单击添加文本按钮时 - 当我单击确定时，文本将作为`li`元素添加，它将带来文本区域并保存回 li。谢谢！

我已经做到了！这是最终代码：

```
var makeAreaEditable = function()
{
    var liid = $(this).parent().find('li').attr('id');
    var text = $("#"+liid).html();
    var target = event.target || event.srcElement || event.originalTarget;
    var button = $("#"+target.id);
    button.text("OK");
    button.unbind('click');
    button.bind('click',saveEdit);
    var targetArea = $("#"+target.name);
    targetArea.replaceWith('<textarea>'+text+'</textarea>');    
};                                                      

var saveEdit =  function()
{
    var target = event.target || event.srcElement || event.originalTarget;
    var button = $("#"+target.id);
    var textarea = $(this).parent().find('textarea');
    var text = textarea.val();
    button.text("edit");
    button.unbind('click');
    var targetArea = button.parent().find('textarea');
    var textid = target.name;
    targetArea.replaceWith("<li id='"+textid+"' style='list-style-type:none;'>"+text+"</li>");
}; 
```

# youtube-api - 通过 XHR2 在 Youtube 上上传视频

> ID：14321151
> 
> 赞同：0
> 
> 时间：2013-01-14T15:15:16.293
> 
> 标签：youtube-api, cors, xmlhttprequest-level2

我的客户希望在用户在 Youtube 上上传视频时显示进度对话框。

我写的是这样的：

```
 element = document.forms.uploadNewVideoForm.file;

    var fd = new FormData();
    console.log(element.files);
    fd.append('token', $scope.uploadData.token);
    fd.append('file', element.files[0]);

    var xhr = new XMLHttpRequest();
    xhr.upload.addEventListener("progress", $scope.uploadProgress, false);
    xhr.addEventListener("load", $scope.uploadComplete, false);
    xhr.addEventListener("error", $scope.uploadComplete, false);
    xhr.addEventListener("abort", $scope.uploadComplete, false);
    xhr.open("POST", $scope.uploadData.uploadUrl + '?nexturl=' + encodeURIComponent('http://local.app.com:8000/OK'));

    xhr.onreadystatechange = function ( response ) {};
    xhr.send(fd); 
```

此代码完美启动，但当 Youtube 重定向到回调 URL 时失败。

```
POST http://uploads.gdata.youtube.com/action/FormDataUpload/<token here>?nexturl=http%3A%2F%2Flocal.app.com%3A8000%2FOK

302 Moved Temporarily 
Location: http://local.app.com:8000/OK 
```

这里请求中断并调用错误回调。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T17:30:29.657

看看下面的[示例](http://gdata-samples.googlecode.com/svn/trunk/gdata/youtube_upload_cors.html)（[源代码](https://code.google.com/p/gdata-samples/source/browse/trunk/gdata/youtube_upload_cors.html)）。它将上传分为两部分：

1.  上传元数据的 CORS 请求。
2.  用于上传实际视频的表单 POST。

不幸的是，上传页面还不支持 CORS，所以这是你能做的最好的。

# javascript - 通过原型 javascript 框架捕获异常

> ID：14321153
> 
> 赞同：2
> 
> 时间：2013-01-14T15:15:19.743
> 
> 标签：javascript, exception-handling, prototypejs, reverse-ajax

我正在使用[原型](http://prototypejs.org/)框架在我的页面中获得反向 ajax 效果，我正在使用这个脚本：

```
<script language="JavaScript" src="prototype.js"></script>
<script>
Event.observe(window, 'load', function() {
connectToServer();
});

function connectToServer()
{
new Ajax.Updater(
    { success: 'asd', failure: 'error' },
    'evaluation',
    {
        method:     'get',
        onSuccess:  function(transport)
        {
            if (transport.responseText!=''){
                try {
                    eval(transport.responseText)
                } catch (e) {
                    alert(e.message);
                }
            }
            connectToServer();
        },
    });
 }
 </script> 
```

该脚本工作正常，但我有一个问题，当我关闭 Web 服务器（在我的情况下，我用 python 编写的一个小 Web 服务器）由于错误 404 引发了很多异常，有没有办法捕获这个异常并阻止剧本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T20:44:54.273

向选项添加一个`on404`选项`Ajax.Updater`，传递一个函数处理程序，就像你为`onSuccess`.

`on<HTTPSTATUSCODE>`仅当 HTTP 代码作为处理程序存在时，处理程序才会阻止 onSuccess 触发。即，如果网络服务器以 500 错误响应并且您只`on404`定义了一个处理程序，则`onSuccess`可能仍会运行，但不应运行，因为成功被定义为任何 200 秒状态代码。

# django - Django 多数据库支持

> ID：14321156
> 
> 赞同：0
> 
> 时间：2013-01-14T15:15:28.590
> 
> 标签：django

使用 Django 1.4 是否可以让同一个项目中的 2 个应用程序使用两个不同的数据库？

如果是这样，每个应用程序都会有自己的 settings.py 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:21:15.713

查看[django 文档](https://docs.djangoproject.com/en/dev/topics/db/multi-db/#defining-your-databases)，了解如何在您的设置中定义多个数据库。

要为每个应用程序使用不同的数据库，您可以使用以下方法之一：

1.  您可以在每次数据库调用时[手动选择数据库。](https://docs.djangoproject.com/en/dev/topics/db/multi-db/#manually-selecting-a-database)如果您使用第三方应用程序，这可能是不可能的。

2.  如果您不想修改应用程序，您可以[定义一个可能更合适的数据库路由器。](https://docs.djangoproject.com/en/dev/topics/db/multi-db/#automatic-database-routing)文档中有一个[示例，](https://docs.djangoproject.com/en/dev/topics/db/multi-db/#an-example)它解释了如何将读/写路由到另一个数据库。

# c++ - 在 throw 参数周围添加括号是否有任何效果？

> ID：14321163
> 
> 赞同：5
> 
> 时间：2013-01-14T15:15:58.803
> 
> 标签：c++, throw, parentheses

写法有区别吗：

```
throw SomeException; 
```

和

```
throw(SomeException); 
```

我已经看到一些消息来源声称后者（带括号）由于某种原因不是一个好的选择，但可惜我不记得我在哪里看到过这个。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-14T15:30:55.923

除了括号外，这两个表达式之间不应**有**任何功能差异。我从未听说过任何明确的理由可以说明为什么一个人应该优于另一个人。

对我来说，第一个选项看起来更直观，因为它不包含不必要的括号！

同样正如@Pubby 在评论中所说，不应与需要括号的 throw 说明符混淆（`throw`说明符*可能* [已弃用](https://stackoverflow.com/questions/12833241/difference-between-c03-throw-specifier-c11-noexcept)）。

# msmq - MSMQ 死信队列消息恢复

> ID：14321164
> 
> 赞同：2
> 
> 时间：2013-01-14T15:16:01.343
> 
> 标签：msmq, biztalk, biztalk-2009

我正在开发一个将消息发送到事务性 MSMQ 位置的 BizTalk 应用程序。如果无法写入队列，则消息将发送到 BizTalk 服务器上的死信队列。有没有更好的方法来处理这个？我希望消息暂停，以便我们从 BizTalk360 收到通知。如果无法暂停消息，并且消息必须进入死信队列，那么一旦阻止写入队列的问题得到纠正，我该如何恢复消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T13:11:07.210

好的，所以我发现完成此任务的最佳方法在我看来有点像 hack，但它确实有效。我正在设置一个接收端口/位置，在 DIRECT=.\SYSTEM$;DEADXACT 处监听死信队列。我还添加了一个编排，用于侦听来自该接收端口的消息，并立即引发异常暂停消息，从而允许 BizTalk360 向我发送存在问题的通知。

# c# - 如何使用 twain/emgu/open cv 获得良好的清晰度？

> ID：14321165
> 
> 赞同：6
> 
> 时间：2013-01-14T15:16:04.653
> 
> 标签：c#, .net, opencv, emgucv, twain

我正在使用[Epson Perfection V700](http://www.epson.com/cgi-bin/Store/jsp/Product.do?sku=B11B178011)扫描仪，并在使用他们的工具进行扫描时选择以下选项：

*   ICM 颜色校正（来源：EPSON-Standard 目标：sRGB）
*   锐化蒙版（中）

这产生了这个图像：

![图片来自 Epson Tool](../Images/0e76f5a3bb4090d05730c8e1ef09f814.png)

现在我的问题是这个 - 我实际上需要使用[TWAIN .Net](http://code.google.com/p/twaindotnet/)与这个扫描仪进行交互，当我这样做时，我得到的图像是这样的：

![TWAIN 扫描图像](../Images/748cd308d62634a193029be249ee7524.png)

*另外：我取消了上述两个选项并使用 Epson 再次扫描，得到的图像与我通过[TWAIN](http://www.twain.org)获得的图像非常相似。*

所以我想也许这些是我可以在图像上自己做的后处理步骤（也许它们是在硬件中以某种方式完成的，我不知道）。

我正在使用[EmguCV](http://www.emgu.com/wiki/index.php/Main_Page)，所以首先我创建了一个应用 ICM 的扩展方法（我很难找到任何文档，所以这有点猜测，也许我马上就错了，但我从这里得到了信息：[位图变换类](http://www.i-programmer.info/programming/wpf-workings/678-the-bitmap-transform-classes.html?start=2)，它似乎对图像产生了影响）：

```
public static Image<Bgr, TDepth> ApplyIcm<TDepth>(
    this Image<Bgr, TDepth> source,
    string sourceIcm,
    string targetIcm)
    where TDepth : new()
{
    var target = source.CopyBlank();

    using (source)
    {
        using (var b = source.Bitmap)
        {
            using (var memory = new MemoryStream())
            {
                b.Save(memory, ImageFormat.Bmp);
                memory.Position = 0;

                var bitmapImage = new BitmapImage();
                bitmapImage.BeginInit();
                bitmapImage.StreamSource = memory;
                bitmapImage.CacheOption = BitmapCacheOption.OnLoad;
                bitmapImage.EndInit();

                var ccb = new ColorConvertedBitmap();
                ccb.BeginInit();
                ccb.Source = bitmapImage;

                ccb.SourceColorContext =
                    new ColorContext(new Uri(sourceIcm));

                ccb.DestinationColorContext =
                    new ColorContext(new Uri(targetIcm));

                ccb.EndInit();

                var encoder = new BmpBitmapEncoder();
                encoder.Frames.Add(BitmapFrame.Create(ccb));
                using (var ms = new MemoryStream())
                {                            
                    encoder.Save(ms);
                    target.Bitmap = new Bitmap(ms);
                }
            }
        }
    }

    return target;
} 
```

然后我看了那个不锐化的东西，遇到了这个问题： [如何在 OpenCV 中锐化图像？](https://stackoverflow.com/questions/4993082/how-to-sharpen-an-image-in-opencv)其中说：

> 您使用高斯平滑滤波器并从原始图像中减去平滑版本

（我还检查了这个问题以找出等效的 emgucv 调用是[为什么 EmguCV 高斯模糊不会返回与 OpenCV 高斯模糊相同的结果？](https://stackoverflow.com/a/8217530/1039947)）并提出了这个额外的扩展方法：

```
public static Image<Bgr, TDepth> UnsharpMask<TDepth>(
    this Image<Bgr, TDepth> source,
    Size kernelSize,
    int kernelHoritonalStandardDeviation,
    int kernelVerticalStandardDeviation,
    double alpha,
    double beta,
    double gamma)
    where TDepth : new()
{

    Image<Bgr, TDepth> ret = source.CopyBlank();

    CvInvoke.cvSmooth(source,
                      ret,
                      SMOOTH_TYPE.CV_GAUSSIAN,
                      kernelSize.Width,
                      kernelSize.Height,
                      kernelHoritonalStandardDeviation,
                      kernelVerticalStandardDeviation);

    CvInvoke.cvAddWeighted(source, alpha, ret, beta, gamma, ret);

    return ret;
} 
```

现在我这样称呼它：

```
string sourceIcm = @"C:\Windows\System32\spool\drivers\color\ewrgb18.icm";
string targetIcm = @"C:\Windows\System32\spool\drivers\color\ewsrgb.icm";

using(var im = new Image<Bgr, byte>("out.bmp"))
{
    using (var icmmed = im.ApplyIcm(sourceIcm, targetIcm))
    {
        using (var ret = icmmed.UnsharpMask(new Size(0, 0), 5, 5, 2.4, -1.5, 0))
        {
            ret.Save("ret.bmp");
        }
    }
} 
```

这是结果：

![在我磨砺之后](../Images/570915416d75ef23d1b39d66f10a2eb5.png)

不是很好！:-(

我无休止地摆弄参数，但我无法弄清楚如何（或者即使）我可以达到与 Epson 工具相同的结果。

所以，我的问题是：

**有谁知道是否有可能使用opencv/emgucv（甚至TWAIN——我查看了相关文档并尝试调整一些功能参数，但我只是让图像变得更糟）实现了清晰度相似的结果到上面的原始图像还是我应该尝试另一种技术（可能是我需要了解有关硬件本身的一些细节才能实现正确的锐化）？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:28:19.167

我认为您应该知道如何在您的项目中使用 WIA（Windows 图像采集），您可能不需要使用 opencv 访问硬件。WIA 用于与网络摄像头和扫描仪集成。或者，您可以使用您提到的 TWAIN，看看这些示例，它们可能对您的项目有帮助：

[使用 WIA](http://www.codeproject.com/Articles/2303/WIA-Scripting-and-NET)

和

[使用 TWAIN](http://www.codeproject.com/Articles/1376/NET-TWAIN-image-scanner)

关于锐化，您可以在软件级别使用 opencv 功能，作为解决问题的另一种选择

# jquery - 使用jquery计算相对于容器的宽度和高度

> ID：14321166
> 
> 赞同：0
> 
> 时间：2013-01-14T15:16:05.423
> 
> 标签：jquery, css, variables, jquery-selectors

我的图像容器是`image-wrap`class ，`.image-wrap img`宽度和高度设置为 100% 填充容器。

CSS：

```
 .image-wrap{
    width:600px;
    height:400px;
    position:relative;
    overflow:hidden;
    }
    .image-wrap img{
    position:relative;
    width:100%;
    height:100%;
    } 
```

现在我想在 image-warp 中设置 5 px 的填充，这也需要将`.image-wrap img`宽度和高度更改为另一个`%`值。如何计算并将其设置为 jquery var，因此我可以`image-wrap img`使用 jquery 将其添加到类中。即使对于任何其他宽度-高度值对`image-wrap`（可能用于响应式设计），我的 5 px 填充保持不变。帮助我评估数学方程以将宽度高度 % 设置为 jquery var。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:27:44.937

jQuery：

```
 var $imgHeight = $('.image-wrap img').height();
   var $imgWidth = $('.image-wrap img').width(); 
```

你也可以用 css3 做到这一点：

```
.image-wrap img{
  position:relative;
  width: calc(100% - 10px);
  height: calc(100% - 10px);
  padding: 5px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T19:27:05.330

```
jQuery(".image-wrap").each(function() {

    myWidth = jQuery(this).width();
    myHeight = jQuery(this).height();
    myWidth = myWidth - 10;
    myHeight = myHeight - 10;
    myWidth = myWidth.toString().concat("px");
    myHeight = myHeight.toString().concat("px");

    jQuery(this).find("img").css({

        height: myHeight,
        width: myWidth
    });
}); 
```

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T15:26:50.727

```
jQuery("img.image-wrap").css({padding:'5px', width:'590px', height:'390px'}); 
```

希望这可以帮助

# silverlight - 如何更改 Silverlight OOB 应用程序的更新 URL

> ID：14321169
> 
> 赞同：0
> 
> 时间：2013-01-14T15:16:13.290
> 
> 标签：silverlight, updates, silverlight-oob

将 Silverlight 应用程序安装为浏览器外应用程序后，我知道我可以通过调用该`Application.Current.CheckAndDownloadUpdateAsync()`方法来更新它。这将检查最初下载 XAP 的 URL，并在必要时进行更新。

但是，如果在未来的某个地方，我想要或需要更改 XAP 的 url，该怎么办？域名更改，我网站上的位置等。

有没有办法指示 OOB 应用程序应该在哪里检查更新？

现在我知道该`/origin`属性，但据我所知，当您让用户通过单击站点上的按钮（或右键单击应用程序）来安装它时，无法设置它。另外，我不知道在某个时间点*更改它的方法。*除了让用户手动完成之外，就是这样。但这不是很人性化。

如果这完全不可能，也许重定向可以解决问题？

那么有没有办法以编程方式定义/更改 XAP 的 URL？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T22:12:38.753

您不能更改已安装 OOB 应用程序的原始 url。并非没有要求用户从新位置卸载并重新安装应用程序。它并不是那么用户友好，但对用户来说是透明的。

理想情况下，源 URL 在应用程序的生命周期内不应更改。如果您想移动 xap 文件，使用服务器端 url 重写（也许也可以重定向）应该没问题。如果更改域名是不可避免的，您可以向用户推送更新，提醒他们应用程序移动到不同的域并且需要重新安装。

# android - 更改 Android 应用程序的 XML 布局会影响其行为吗？

> ID：14321171
> 
> 赞同：0
> 
> 时间：2013-01-14T15:16:33.997
> 
> 标签：android, xml, layout, intellij-idea, android-linearlayout

我的 Android 应用程序运行良好，直到我在 XML 布局中使用滚动视图和子容器进行更改，线性布局下有许多控件。此特定布局不再运行，并导致应用程序停止工作。此外，IDE 有时会说标记不是 Android 资源中的有效元素。但是，当我更新 IDE 时，它得到了修复。但是现在，这种带有计算的特定布局不起作用。什么可能是这个问题的解决方案。我真的真的需要尽快完成这个应用程序。：| 只有这个布局不起作用......

我打算再次创建一个新项目，然后复制粘贴 XML 布局，这可以解决我的问题吗？除此之外，我之前此布局正常工作的所有备份文件都不再工作了。我很难对付这个。

我正在使用 INTELLIJ LEDA 社区版 IDE。任何帮助，将不胜感激！这是 XML：

```
<?xml version="1.0" encoding="utf-8"?>

<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="match_parent" android:background="#ffffff">

<LinearLayout
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">

    <Button android:layout_width="30dp" android:layout_height="30dp"
            android:id="@+id/btn_home_monthly" android:background="@drawable/home" android:textColor="#ffffff"
            android:layout_gravity="right"/>

    <Button android:layout_width="30dp" android:layout_height="30dp"
            android:id="@+id/btn_warning_from_monthlycomputation"
            android:background="@drawable/warn" android:layout_gravity="right"/>
    <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Input your Monthly Net Salary:"
            android:id="@+id/textView" android:layout_gravity="center"
            android:textColor="@android:color/black" android:textStyle="bold"/>
    <EditText
            android:layout_width="130dp"
            android:layout_height="wrap_content"
            android:id="@+id/et_net_monthly" android:layout_gravity="center" android:inputType="numberDecimal|numberSigned">
        <requestFocus/>
    </EditText>
    <Button android:layout_width="150dp" android:layout_height="40dp" android:text="Compute"
            android:id="@+id/btn_compute_from_monthly" android:background="@drawable/black_btn" android:textColor="#ffffff"
            android:layout_gravity="center"/>

    <TextView android:layout_width="wrap_content" android:layout_height="wrap_content"
              android:text="Tax Due:" android:id="@+id/textView1"
              android:layout_gravity="center" android:textColor="@android:color/black" android:textStyle="bold"/>
    <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:id="@+id/txt_taxdue" android:textColor="#ff0006" android:layout_gravity="center"
            android:textSize="20dp"
            android:textStyle="bold"/>

    <Button android:layout_width="150dp" android:layout_height="40dp" android:text="Show Breakdown"
            android:id="@+id/btn_showbreakdown" android:background="@drawable/black_btn"
            android:textColor="#ffffff" android:layout_gravity="center" android:visibility="invisible"/>

    <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:id="@+id/txt_1" android:layout_gravity="left|center_vertical" android:visibility="invisible"
            android:textColor="@android:color/black"/>

    <TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:id="@+id/txt_2"
              android:layout_gravity="left|center_vertical" android:visibility="invisible"
              android:textColor="@android:color/black"/>

    <TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:id="@+id/txt_3"
              android:layout_gravity="left|center_vertical" android:visibility="invisible"
              android:textColor="@android:color/black"/>

    <TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:id="@+id/txt_4"
              android:layout_gravity="left|center_vertical" android:visibility="invisible"
              android:textColor="@android:color/black"/>

    <Button android:layout_width="150dp" android:layout_height="40dp" android:text="Save As Text File"
            android:id="@+id/btn_save" android:background="@drawable/black_btn" android:textColor="#ffffff"
            android:layout_gravity="center" android:visibility="invisible"/>

    <TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:id="@+id/txt_filename"
              android:layout_gravity="left|center_vertical" android:visibility="invisible"
              android:textColor="@android:color/black"
              android:text="Name for File:"/>
    <EditText
            android:layout_width="130dp"
            android:layout_height="wrap_content"
            android:id="@+id/et_txtname" android:layout_gravity="center" android:inputType="textFilter"
            android:visibility="invisible">
        <requestFocus/>
    </EditText>

    <Button android:layout_width="150dp" android:layout_height="40dp"
            android:id="@+id/btn_confirm" android:background="@drawable/save"
            android:layout_gravity="center" android:visibility="invisible"/>
</LinearLayout>
</ScrollView> 
```

这是它的类：

```
 public class MonthlyComputation extends MyActivity
 {
 private String civil_status;
String ns, td, r, e, s, to, wr, n, txtname, stat;
String datetime = DateFormat.getDateTimeInstance().format(new Date());
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.monthlycomputation);

    Bundle extras = getIntent().getExtras();

    if(extras != null)
    {
         civil_status = extras.getString("user_status");
    }

    Button btn_compute = (Button) findViewById(R.id.btn_compute_from_monthly);
    Button btn_warning = (Button) findViewById(R.id.btn_warning_from_monthlycomputation);
    final Button btn_show = (Button) findViewById(R.id.btn_showbreakdown);
    final Button btn_save = (Button) findViewById(R.id.btn_save);
    final Button btn_confirm = (Button) findViewById(R.id.btn_confirm);

    final EditText et_txtfile = (EditText) findViewById(R.id.et_txtname);
    final TextView txt_name = (EditText) findViewById(R.id.txt_filename);

    final Button btn_home = (Button) findViewById(R.id.btn_home_monthly);

    btn_home.setOnClickListener(new Button.OnClickListener()
    {
        @Override
        public void onClick(View v)
        {
            Intent i = new Intent(getApplicationContext(), MyActivity.class);
            startActivity(i);
        }
    });
    /* SAVING TEXT FILE */

    btn_confirm.setOnClickListener(new Button.OnClickListener()
    {
        @Override
        public void onClick(View v)
        {
            txtname = et_txtfile.getText().toString();

            /* Getting the status */

            if ("SME".equals(civil_status))
            {
                stat = "Single / Married with 0 Dependent";
            }

            else if ("SM1".equals(civil_status))
            {
                stat = "Single / Married with 1 Dependent";
            }

            else if ("SM2".equals(civil_status))
            {
                stat = "Single / Married with 2 Dependents";
            }

            else if ("SM3".equals(civil_status))
            {
                stat = "Single / Married with 3 Dependents";
            }

            else if ("SM4".equals(civil_status))
            {
                stat = "Single / Married with 4 Dependents";
            }
            try
            {
                File f1=new File("/sdcard/download/" + txtname + ".txt");
                BufferedWriter out = new BufferedWriter(new FileWriter(f1,true));
                out.write("\n\nCreated On: " + datetime + " | Monthly Computation | " + stat + "\n\n"
                + "Net Salary: " + n + "\nTax Due: " + td + "\n\nBreakdown:\n\n"
                + "> Net Salary (" + n + ") - Lower Limit (" + s + ") = " + to +
                "\n" + "> " + to + " * Tax Rate (" + r + ") = " + wr + "\n"
                + "> Exemption (" + e + ") + " + wr + " = " + td + "\n"
                + "> Total Tax Due:  " + td + "\n");
                out.close();

                Toast toast = Toast.makeText(getApplicationContext(), "Your file " + txtname + " has been saved!", Toast.LENGTH_SHORT);
                toast.setGravity(Gravity.TOP|Gravity.LEFT, 0, 0);
                toast.show();

                Intent i = new Intent(getApplicationContext(), OpenCalculator.class);
                startActivity(i);

            } catch (IOException ioe)
            {
                Toast toast = Toast.makeText(getApplicationContext(), "Sorry, your device has no SD card inserted, ITax saves files only on SD cards OR you don't have the destination folder, \"download\"", Toast.LENGTH_LONG);
                toast.setGravity(Gravity.TOP|Gravity.LEFT, 0, 0);
                toast.show();
                ioe.printStackTrace()
            ;}

        }
    });

    btn_warning.setOnClickListener(new Button.OnClickListener()
    {
        @Override
        public void onClick(View v)
        {
            Intent i = new Intent(getApplicationContext(), SalaryNoteMonthly.class);
            startActivity(i);
        }
    });

    btn_compute.setOnClickListener(new Button.OnClickListener()
    {
        @Override
        public void onClick(View v)
        {

            final EditText net_salary = (EditText) findViewById(R.id.et_net_monthly);
            final TextView tax_due = (TextView) findViewById(R.id.txt_taxdue);

            double netSalary, taxDue, rate = 0, exemption = 0, subtrahend = 0, withRate, total;

            ns = net_salary.getText().toString();

            /* checks if textbox is blank, then make it to 0 */

            if(ns.equals(""))
            {
                netSalary = 0;
                Toast toast = Toast.makeText(getApplicationContext(), "Net Salary is blank.", Toast.LENGTH_SHORT);
                toast.setGravity(Gravity.TOP|Gravity.LEFT, 0, 0);
                toast.show();
            }

            else
            {
                netSalary = Double.parseDouble(ns);
            }

            /* Converting Net Salary to String with 2 decimal places */

            n = String.format("%.2f", netSalary);

            /* Single or Married with no dependent */

                    if ("SME".equals(civil_status)) {
                        if (netSalary >= 4167 && netSalary < 5000) {
                            rate = 0.05;
                            exemption = 0.00;
                            subtrahend = 4167;
                        } else if ((netSalary >= 5000) && (netSalary < 6667)) {
                            rate = 0.1;
                            exemption = 41.67;
                            subtrahend = 5000;
                        } else if ((netSalary >= 6667) && (netSalary < 10000)) {
                            rate = 0.15;
                            exemption = 208.33;
                            subtrahend = 6667;
                        } else if ((netSalary >= 10000) && (netSalary < 15833)) {
                            rate = 0.20;
                            exemption = 708.33;
                            subtrahend = 10000;
                        } else if ((netSalary >= 15833) && (netSalary < 25000)) {
                            rate = 0.25;
                            exemption = 1875.00;
                            subtrahend = 15833;
                        } else if ((netSalary >= 25000) && (netSalary < 45833)) {
                            rate = 0.30;
                            exemption = 4166.67;
                            subtrahend = 25000;
                        } else if (netSalary >= 45833) {
                            rate = 0.32;
                            exemption = 10416.67;
                            subtrahend = 45833;
                        }
                    }

            /* Single or Married with 1 Dependent */

                    if ("SM1".equals(civil_status)) {
                        if ((netSalary >= 6250) && (netSalary < 7083)) {
                            rate = 0.05;
                            exemption = 0.00;
                            subtrahend = 6250;
                        } else if ((netSalary >= 7083) && (netSalary < 8750)) {
                            rate = 0.1;
                            exemption = 41.67;
                            subtrahend = 7083;
                        } else if ((netSalary >= 8750) && (netSalary < 12083)) {
                            rate = 0.15;
                            exemption = 208.33;
                            subtrahend = 8750;
                        } else if ((netSalary >= 12083) && (netSalary < 17917)) {
                            rate = 0.20;
                            exemption = 708.33;
                            subtrahend = 12083;
                        } else if ((netSalary >= 17917) && (netSalary < 27083)) {
                            rate = 0.25;
                            exemption = 1875.00;
                            subtrahend = 17917;
                        } else if ((netSalary >= 27083) && (netSalary < 47917)) {
                            rate = 0.30;
                            exemption = 4166.67;
                            subtrahend = 27083;
                        } else if (netSalary >= 47917) {
                            rate = 0.32;
                            exemption = 10416.67;
                            subtrahend = 47917;
                        }
                    }

             /* Single or Married with 2 Dependents */

                    if ("SM2".equals(civil_status)) {
                        if ((netSalary >= 8333) && (netSalary < 9167)) {
                            rate = 0.05;
                            exemption = 0.00;
                            subtrahend = 8333;
                        } else if ((netSalary >= 9167) && (netSalary < 10833)) {
                            rate = 0.1;
                            exemption = 41.67;
                            subtrahend = 9167;
                        } else if ((netSalary >= 10833) && (netSalary < 14167)) {
                            rate = 0.15;
                            exemption = 208.33;
                            subtrahend = 10833;
                        } else if ((netSalary >= 14167) && (netSalary < 20000)) {
                            rate = 0.20;
                            exemption = 708.33;
                            subtrahend = 14167;
                        } else if ((netSalary > 20000) && (netSalary < 29167)) {
                            rate = 0.25;
                            exemption = 1875.00;
                            subtrahend = 20000;
                        } else if ((netSalary >= 29167) && (netSalary < 50000)) {
                            rate = 0.30;
                            exemption = 4166.67;
                            subtrahend = 29167;
                        } else if (netSalary >= 50000) {
                            rate = 0.32;
                            exemption = 10416.67;
                            subtrahend = 50000;
                        }
                    }

        /* Single or Married with 3 Dependents */

                    if ("SM3".equals(civil_status)) {
                        if ((netSalary >= 10417) && (netSalary < 11250)) {
                            rate = 0.05;
                            exemption = 0.00;
                            subtrahend = 10417;
                        } else if ((netSalary >= 11250) && (netSalary < 12917)) {
                            rate = 0.1;
                            exemption = 41.67;
                            subtrahend = 11250;
                        } else if ((netSalary >= 12917) && (netSalary < 16250)) {
                            rate = 0.15;
                            exemption = 208.33;
                            subtrahend = 12917;
                        } else if ((netSalary >= 16250) && (netSalary < 22083)) {
                            rate = 0.20;
                            exemption = 708.33;
                            subtrahend = 16250;
                        } else if ((netSalary >= 22083) && (netSalary < 31250)) {
                            rate = 0.25;
                            exemption = 1875.00;
                            subtrahend = 22083;
                        } else if ((netSalary >= 31250) && (netSalary < 52083)) {
                            rate = 0.30;
                            exemption = 4166.67;
                            subtrahend = 31250;
                        } else if (netSalary >= 52083) {
                            rate = 0.32;
                            exemption = 10416.67;
                            subtrahend = 52083;
                        }

                    }

             /* Single or Married with 4 Dependents */

                    if ("SM4".equals(civil_status)) {
                        if ((netSalary >= 12500) && (netSalary < 13333)) {
                            rate = 0.05;
                            exemption = 0.00;
                            subtrahend = 12500;
                        } else if ((netSalary >= 13333) && (netSalary < 15000)) {
                            rate = 0.1;
                            exemption = 41.67;
                            subtrahend = 13333;
                        } else if ((netSalary >= 15000) && (netSalary < 18333)) {
                            rate = 0.15;
                            exemption = 208.33;
                            subtrahend = 15000;
                        } else if ((netSalary >= 18333) && (netSalary < 24167)) {
                            rate = 0.20;
                            exemption = 708.33;
                            subtrahend = 18383;
                        } else if ((netSalary >= 24167) && (netSalary < 33333)) {
                            rate = 0.25;
                            exemption = 1875.00;
                            subtrahend = 24167;
                        } else if ((netSalary >= 33333) && (netSalary < 54167)) {
                            rate = 0.30;
                            exemption = 4166.67;
                            subtrahend = 33333;
                        } else if ((netSalary >= 54167)) {
                            rate = 0.32;
                            exemption = 10416.67;
                            subtrahend = 54167;
                        }
                    }

                    total = netSalary - subtrahend;
                    withRate = total * rate;
                    taxDue = withRate + exemption;

                    td = String.format("%.2f",taxDue);
                    e = String.format("%.2f", exemption);
                    s = String.format("%.2f", subtrahend);
                    r = String.format("%.2f", rate);
                    to = String.format("%.2f", total);
                    wr = String.format("%.2f", withRate);

            /*Place the value in text view*/

                    tax_due.setText("Php " + td);

            /*BREAK DOWN*/

            final TextView tax_1 = (TextView) findViewById(R.id.txt_1);
            final TextView tax_2 = (TextView) findViewById(R.id.txt_2);
            final TextView tax_3 = (TextView) findViewById(R.id.txt_3);
            final TextView tax_4 = (TextView) findViewById(R.id.txt_4);

            tax_1.setText("> Net Salary (" + n + ") - Lower Limit (" + s + ") = " + to );
            tax_2.setText("> " + to + " * Tax Rate (" + r + ") = " + wr);
            tax_3.setText("> Exemption (" + e + ") + " + wr + " = " + td);
            tax_4.setText("> Total Tax Due:  " + td);

            btn_show.setVisibility(1);
            btn_save.setVisibility(1);

        }
    });

    btn_save.setOnClickListener(new Button.OnClickListener()
    {
        @Override
        public void onClick(View v)
        {
            btn_confirm.setVisibility(1);
            et_txtfile.setVisibility(1);
            txt_name.setVisibility(1);
        }
    });

    btn_show.setOnClickListener(new Button.OnClickListener()
    {
        @Override
        public void onClick(View v)
        {
            final TextView tax_1 = (TextView) findViewById(R.id.txt_1);
            final TextView tax_2 = (TextView) findViewById(R.id.txt_2);
            final TextView tax_3 = (TextView) findViewById(R.id.txt_3);
            final TextView tax_4 = (TextView) findViewById(R.id.txt_4);

            tax_1.setVisibility(1);
            tax_2.setVisibility(1);
            tax_3.setVisibility(1);
            tax_4.setVisibility(1);
        }
    });
}

@Override
public void onBackPressed()
{
    Intent i = new Intent(getApplicationContext(), OpenChoices.class);
    startActivity(i);
}
 } 
```

这是日志猫：

~ 频道无法恢复，将被处理掉！11-15 21:37:17.735：错误/InputDispatcher(157)：收到未知输入通道的虚假接收回调。fd=183, events=0x9 11-15 21:37:57.894: ERROR/Trace(1113): error opening trace file: No such file or directory (2) 11-15 21:38:27.525: ERROR/Trace(1154) ): 打开跟踪文件时出错: 没有这样的文件或目录 (2) 11-15 21:38:32.645: ERROR/ThrottleService(157): onPollAlarm 期间出现问题: java.lang.IllegalStateException: 解析统计问题: java.io.FileNotFoundException ：/proc/net/xt_qtaguid/iface_stat_all：打开失败：ENOENT（没有这样的文件或目录）11-15 21:40:06.105：错误/AndroidRuntime（1154）：致命异常：主要 java.lang.RuntimeException：无法启动活动 ComponentInfo{com.example.ITax/com.example.ITax.MonthlyComputation}：java.lang.ClassCastException：553) 在 dalvik.system.NativeStart.main(Native Method) 引起：java.lang.ClassCastException: android.widget.TextView 不能在 com.example.ITax.MonthlyComputation.onCreate(MonthlyComputation. java:47) 在 android.app.Activity.performCreate(Activity.java:5008) 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079) 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023) 。 .. 11 更多 11-15 21:40:08.395: ERROR/InputDispatcher(157): channel '413830d8 com.example.ITax/com.example.ITax.OpenChoices (server)' ~ Channel 已不可恢复地损坏，将被处理！11-15 21:40:08.475：ERROR/InputDispatcher(157)：收到未知输入通道的虚假接收回调。fd=197，事件=0x9 11-15 21:43:10.085：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:00:43.813

The "Name for file" control is a TextView, and you're casting it to EditText, which fails because it's the wrong type. You need to cast to TextView instead in the following line:

final TextView txt_name = (EditText) findViewById(R.id.txt_filename);

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T19:16:35.157

每当您的应用程序崩溃或出现问题时，请尝试读取 logcat，它可能会为您提供确切的错误点。

这里说`Caused by: java.lang.ClassCastException: android.widget.TextView cannot be cast to android.widget.EditText at`

这是因为您试图将 EditText 转换为 TextView。它应该是这样的：

```
final EditText txt_name = (EditText) findViewById(R.id.txt_filename); 
```

# c++ - std::string::replace() 是否针对相同长度的字符串进行了优化？

> ID：14321174
> 
> 赞同：3
> 
> 时间：2013-01-14T15:16:56.100
> 
> 标签：c++, optimization, replace, stdstring

假设，大多数时候我有以下替换方案：

```
std::string line; // "line" contains a big string.
std::string from = "abcd";
std::string to = "xy";  // to.length() < from.length()
// replace "from" with "to" everywhere in "line" 
```

在这里，`string`班级必须放置`"xy"`然后擦除 2 个字符，这有效地将所有字符`line`向左移动。在我的代码的整个生命周期中发生了很多这样的替换。

现在来到真正的问题。以下对我来说也是可以接受的：

```
// ...
if(to.legnth() < from.length())
  to.resize(from.length(), ' ');
// now to.length() = from.length()
// replace "from" with "to" everywhere in "line" 
```

`replace()`仅当针对相同长度的字符串进行了优化时，上述练习才有帮助。应该是因为那是微不足道的；但只是想确认是否有人具有第一手知识。
我尝试通过 Eclipse IDE 浏览到字符串类，但无法深入研究。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:49:38.217

我只看 MSVC 2008 的实现。他们**确实**优化（我省略了一些东西）：

```
_Myt& __CLR_OR_THIS_CALL replace(size_type _Off,
    size_type _N0, const _Myt& _Right, size_type _Roff, size_type _Count)
{
    ...
        if (_Count <= _N0)
        {   // hole doesn't get larger, just copy in substring
        _Traits_helper::move_s<_Traits>(_Myptr() + _Off, _Myres - _Off,
            _Myptr() + _Roff, _Count);  // fill hole
        _Traits_helper::move_s<_Traits>(_Myptr() + _Off + _Count, _Myres - _Off - _Count,
            _Myptr() + _Off + _N0, _Nm);    // move tail down
        }
    else if (_Roff <= _Off)
        {   // hole gets larger, substring begins before hole
        _Traits_helper::move_s<_Traits>(_Myptr() + _Off + _Count, _Myres - _Off - _Count,
            _Myptr() + _Off + _N0, _Nm);    // move tail down
        _Traits_helper::move_s<_Traits>(_Myptr() + _Off, _Myres - _Off,
            _Myptr() + _Roff, _Count);  // fill hole
        }
    else if (_Off + _N0 <= _Roff)
        {   // hole gets larger, substring begins after hole
        _Traits_helper::move_s<_Traits>(_Myptr() + _Off + _Count, _Myres - _Off - _Count,
            _Myptr() + _Off + _N0, _Nm);    // move tail down
        _Traits_helper::move_s<_Traits>(_Myptr() + _Off, _Myres - _Off,
            _Myptr() + (_Roff + _Count - _N0), _Count); // fill hole
        }
    else
        {   // hole gets larger, substring begins in hole
        _Traits_helper::move_s<_Traits>(_Myptr() + _Off, _Myres - _Off,
            _Myptr() + _Roff, _N0); // fill old hole
        _Traits_helper::move_s<_Traits>(_Myptr() + _Off + _Count, _Myres - _Off - _Count,
            _Myptr() + _Off + _N0, _Nm);    // move tail down
        _Traits_helper::move_s<_Traits>(_Myptr() + _Off + _N0, _Myres - _Off - _N0, _Myptr() + _Roff + _Count,
            _Count - _N0);  // fill rest of new hole
        }
        ...
    } 
```

请注意，新长度较小的情况和长度相等的情况是相似的。

**编辑**：可以得出结论，在复制数据后字符串长度相同的情况下，必须移动/填充总共“0”个字符/孔（即不移动）。因此，实际上不需要优化，但它已经得到了微不足道的照顾。

# c# - 如何在java中编写可为空的int？

> ID：14321175
> 
> 赞同：78
> 
> 时间：2013-01-14T15:16:56.253
> 
> 标签：c#, java, nullable

我想将 Web 表单转换为 Java 模型。

在 C# 中，我可以这样写：

```
<input name="id" value="" type="text"/>

public class Test
{
    public int? Id{get;set;}
} 
```

`id`可以为空。

但是在 Java 中使用 struts2 时会抛出异常：

```
Method "setId" failed 
```

那么如何用Java编写这个案例呢？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2013-01-14T15:18:04.017

`int`您可以使用`Integer`( [Integer javadoc](https://docs.oracle.com/javase/8/docs/api/java/lang/Integer.html) ) 而不是使用，因为它是一个可为空的 Java 类。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2013-01-14T15:18:33.143

您可以使用`Integer`，它是 Java 中的引用类型（类），因此可以为空。

`Int32`（或`int`）是 C# 中的结构（值类型）。相反，`Integer`在 Java 中是一个*包装*了`int`. 引用类型的实例可以是`null`，这是`Integer`一个合法的选择。

`Nullable<T>`在 .NET 中为您提供了类似的选项，因为它使您能够将值类型视为可空类型。但是，它仍然与 Java 不同，`Integer`因为它是作为结构（值类型）实现的，可以与 进行比较`null`，但实际上不能保存真正的空引用。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-14T15:18:55.647

在 Java 中，只需使用`Integer`而不是`int`. 这本质上是一个可为空的 int。我对 Struts 不太熟悉，但使用`Integer`应该允许您省略该值。

# php - URL 中的撇号在实时服务器上变成问号，但不是暂存

> ID：14321181
> 
> 赞同：0
> 
> 时间：2013-01-14T15:17:11.573
> 
> 标签：php, url, character-encoding, kohana

我有一个旧网站，其中 URL 中允许使用撇号。这并不理想，但它是它的设置方式，并且在我转移到新服务器之前它运行良好。页面标题基本上是 URL 中的“slug”，然后用于查找数据库。但是，在我的实时服务器上，当标题包含撇号（在 URL 中显示为撇号）时，撇号在尝试处理它并进行数据库查找时变成一个问号。

我还有一个登台服务器-据我所知，登台服务器和live都运行centOS和php在两者上的配置相同。这个撇号问题不会发生在舞台上，但会发生在现场。任何想法可能是什么原因？一些字符编码问题？非常感谢

编辑：更多信息...

示例 URL：/about/club's-opening-times 这在浏览器 URL 栏中显示良好。

```
 echo $_SERVER["REQUEST_URI"]; // outputs /about/club's-opening-times
 $page_name = end(Router::$segments); 
 echo $page_name; //club?s-opening-times 
```

当我对 URL 进行编码时，也会发生同样的事情 - %27 变成 ? 如您所见，我正在使用框架（kohana 2.3）库来获取 URL 段，因此 Router::segments 的某处正在用问号替换撇号。我在 live 和 staging 和 charset 设置上检查了 phpinfo() 是相同的。这是一个奇怪的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T17:13:05.310

看起来您的航段对 Kohana 路线无效。看看 Kohana 路由器类：[https ://github.com/kohana/core/blob/3.3/master/classes/Kohana/Route.php](https://github.com/kohana/core/blob/3.3/master/classes/Kohana/Route.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:29:37.717

听起来您没有`<meta charset="UTF-8">`在标题标签上方/下方包含字符集，尽管如果没有看到您的代码就很难分辨。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-20T17:09:12.680

这很可能是因为您的 PHP suhosin.server.strip 设置在您的暂存环境和生产环境之间不同。

虽然`$_SERVER['REQUEST_URI']`正确包含单引号，但 Kohana 使用`$_SERVER['PATH_INFO']`是否存在受此设置影响的情况。

来自[https://bugs.php.net/bug.php?id=52293&edit=1#1298061392](https://bugs.php.net/bug.php?id=52293&edit=1#1298061392)：

```
; When set to On the dangerous characters <>"'` are replaced with ? in
; the server variables PHP_SELF, PATH_TRANSLATED and PATH_INFO. This will 
; protect against some XSS vulnerabilities. 
suhosin.server.strip = 0 
```

# java - 性能更好的连接池 API

> ID：14321182
> 
> 赞同：1
> 
> 时间：2013-01-14T15:17:14.527
> 
> 标签：java, database, performance, connection, pool

**问题的1º部分：**

我的应用程序从 TCP 套接字接收大量数据，我需要将数据存储在 MySQL 数据库中。现在，我只是在每次我想查询数据库时创建一个新连接，并且在查询之后我关闭连接。

我只有一个线程来接收数据并存储在数据库中，但我还有其他线程正在查询数据库（它们也创建新连接），但这些线程速度较慢（查询更复杂）。问题是：

*   当我只有接收和存储数据的线程时，数据的存储速度相对较快（我认为它可以更快）；
*   当我还有查询速度较慢的线程时，存储变得太慢......

连接是否可能阻塞？（每次我想访问数据库时，我都会创建和关闭连接）。

**问题的2º部分：**

在我解决上述问题的研究中，我看到我应该使用连接池，因为这可以提高对数据库的访问时间。

所以我发现了 5 种可能性来实现这一点：

1.  [http://commons.apache.org/dbcp/](http://commons.apache.org/dbcp/)
2.  [http://www.mchange.com/projects/c3p0/](http://www.mchange.com/projects/c3p0/)
3.  [http://www.javamex.com/tutorials/synchronization_concurrency_semaphore2.shtml](http://www.javamex.com/tutorials/synchronization_concurrency_semaphore2.shtml)
4.  [http://www.snaq.net/java/DBPool/](http://www.snaq.net/java/DBPool/)
5.  [http://www.roseindia.net/tutorial/java/jdbc/jdbcconnectionpooling.html](http://www.roseindia.net/tutorial/java/jdbc/jdbcconnectionpooling.html)

由于我没有时间测试它们中的每一个，我想知道哪一个（在您看来）可以提供更好的性能和更少的问题需要解决......（我在网络上的某个地方看到了`dbcp`可以提供更多问题的地方而不是解决它们...）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:29:28.183

好吧，根据查询以及您检索或插入的数据量，产生一定的性能影响可能是正常的，从而导致整体性能变慢。

我认为您应该先尝试优化查询/数据库。

关于连接池，我使用过[BoneCP](http://www.jolbox.com)，发现它非常好且速度快。

# c# - 尝试将类的实例直接与字符串进行比较

> ID：14321185
> 
> 赞同：0
> 
> 时间：2013-01-14T15:17:21.720
> 
> 标签：c#, string, operator-overloading

我怎样才能制作这样的课程：

```
public class Foo
{
    private string m_value;
    public string Value { get { return m_value; } set { m_value = value; } }
    public Foo()
    {
        m_value = "";
    }
} 
```

可以直接与字符串进行比较，而无需访问它的`.Value`属性，这样我就可以做到：

```
Foo m_foo = new Foo();
m_foo = "someString";

if(m_foo == "someString")
{
    Console.Writeline("It Worked!");
} 
```

我不确定这是否可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T19:39:36.283

您可以重载 == 运算符（编译器还要求您重载 '!='、'Equals' 和 'GetHashCode'）

```
public class Foo
{
  private string m_value;
  public string Value { get { return m_value; } set { m_value = value; } }
  public Foo()
  {
    m_value = "";
  }

  public override bool Equals(object obj)
  {
    return this.Value == obj.ToString();
  }

  public override int GetHashCode()
  {
    return Value.GetHashCode();
  }

  public static bool operator ==(Foo a, string b)
  {
    return a.Value == b;
  }

  public static bool operator !=(Foo a, string b)
  {
    return a.Value != b;
  }
} 
```

我不确定所有这些努力是否值得，当你可以写：

```
if(m_foo.Value == "someString") 
```

# xcode - 重新排列选项卡栏项目未按预期工作

> ID：14321188
> 
> 赞同：0
> 
> 时间：2013-01-14T15:17:30.330
> 
> 标签：xcode, ios6, storyboard, tabbarcontroller

从[这个问题](https://stackoverflow.com/questions/11796208/how-can-i-rearrange-uitabbarcontroller-items-using-the-storyboard)开始，到目前为止，我一直无法在我的 iPad 应用程序中重新排列标签栏项目。

我已经尽可能放大并双击标签栏控制器，以便它在文档大纲检查器中突出显示。

然后我尝试向左或向右单击并拖动单个项目，但没有任何反应，即我无法选择它们。

在对另一个问题发表评论之后，我尝试单击另一个 .h 或 .m 文件，然后切换回情节提要。我也尝试过关闭 x-code 并重新启动，但都没有任何区别。

谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:25:49.463

最后，我采取了删除segues然后以首选顺序重新连接的蛮力方法。

不是特别优雅，但它完成了工作。

# c# - LiveConnectClient 缺少事件处理程序 Live SDK 5.3 WP8

> ID：14321190
> 
> 赞同：1
> 
> 时间：2013-01-14T15:17:35.683
> 
> 标签：c#, windows-phone-8

你好 :) 我马上就可以了。

问题：当我尝试实例化 LiveConnectClient 然后尝试访问事件时：假设在 LiveConnectClient 中的 GetCompleted 没有显示，并且在我一直在查看的所有示例中，甚至这里的示例都在使用它。这不是唯一发生在它上面的课程，它也在 LiveAuthClient 上发生，即使网络上的帖子说应该有，也没有任何事件。

我试图从头开始重新安装 Vs2012 和 sdk wp8 和 live sdk 但还没有解决

参考我使用这个例子来看看我是否可以工作：

```
 //event triggered when Skydrive sign in status is changed
    private void btnSignIn_SessionChanged(object sender, Microsoft.Live.Controls.LiveConnectSessionChangedEventArgs e)
    {
        //if the user is signed in
        if (e.Status == LiveConnectSessionStatus.Connected)
        {
            session = e.Session;

            client = new LiveConnectClient(e.Session);
            infoTextBlock.Text = "Accessing SkyDrive...";

            //get the folders in their skydrive

            client.GetCompleted +=
                new EventHandler<LiveOperationCompletedEventArgs>(btnSignin_GetCompleted);

            client.GetAsync("me/skydrive/files?filter=folders,albums");
        }

        //otherwise the user isn't signed in
        else
        {
            infoTextBlock.Text = "Not signed in.";
            client = null;
        }

    } 
```

我没有运气解决它并且没有想法。所以我希望你们中的一个男孩能对此有所了解，或者用露珠的话伸出援助之手：）

提前致谢。如果这篇文章太长，我深表歉意。

问候詹斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T21:26:12.463

事实上，这些事件似乎已在最新版本的 SDK 中被删除。不过，由于 async/await 关键字，您不需要它们。首先，将您的方法标记为，然后使用关键字`async`调用该`GetAsync`方法。`await`然后放置您通常会在`GetCompleted`事件中放入的代码：

```
private async void btnSignIn_SessionChanged(object sender, Microsoft.Live.Controls.LiveConnectSessionChangedEventArgs e)
{
    //if the user is signed in
    if (e.Status == LiveConnectSessionStatus.Connected)
    {
        session = e.Session;

        client = new LiveConnectClient(e.Session);
        infoTextBlock.Text = "Accessing SkyDrive...";

        //get the folders in their skydrive
        var result = await client.GetAsync("me/skydrive/files?filter=folders,albums");

        // Do here what you would normally do in btnSignin_GetCompleted
    }

    //otherwise the user isn't signed in
    else
    {
        infoTextBlock.Text = "Not signed in.";
        client = null;
    }

} 
```

# javascript - Json 数据未显示在 extjs 网格中

> ID：14321193
> 
> 赞同：0
> 
> 时间：2013-01-14T15:17:42.610
> 
> 标签：javascript, json, extjs, frontend

给定表格中的数据：

```
var grid_data = [ {Hello: 'World'}, {Jesus:'Navas'} ] 
```

我希望像这样画一个网格：

![在此处输入图像描述](../Images/a5a0c85f97894941b815ed754846c01d.png)

网格显示 2 行但没有数据，我在以下代码中找不到问题：

```
 var grid_store = Ext.create('Ext.data.Store', {
    fields: [
       {name: 'Property'},
       {name: 'Value'}
    ],
    data: grid_data
});

    // create the Grid
var grid_view = Ext.create('Ext.grid.Panel', {
    store: grid_store,
    renderTo: 'info_panel',
    stateful: true,
    stateId: 'stateGrid',
    columns: [
        {
            text     : 'Property',
            width    : 100,
            sortable : true,
            dataIndex: 'Property'
        },
        {
            text     : 'Value',
            width    : 80,
            sortable : false,
            dataIndex: 'Value'
        }
          ],
    height: 350,
    width: 600,
    title: 'Array Grid',
    viewConfig: {
        stripeRows: true
    }
}); 
```

呈现给：

```
<div id="info_panel"></div> 
```

如果您想知道我是如何获得示例图像的，我将存储更改为 ArrayStore 并将数据重新格式化为数组，但我宁愿错过这一步并按原样插入数据。

编辑：

我认为我真正需要的是一种提醒 extjs 使用 JSON 键作为值的方法，而不是大多数采用以下形式的网格示例：

```
{value: 'Hello'}, {property: 'World'} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:55:11.810

作为评论者之一和您的编辑建议，您的网格被构建为使用 json，其中“属性”和“值”是 json 对象的键。我不知道您是否可以更改要在重新格式化的 json 中发送的数据源，但如果没有，您可以在收到数据后运行一个快速循环来执行此操作：

```
var new_data = [];
Ext.each(grid_data, function(obj) {
  for (var prop in obj) {
    new_data.push({
      Property: prop,
      Value: obj[prop]
    });
  }
}, this); 
```

# c# - 将属性附加到 XML 文件中的每个元素

> ID：14321194
> 
> 赞同：0
> 
> 时间：2013-01-14T15:17:44.307
> 
> 标签：c#, .net, xml, linq-to-xml

我有一个 xml，我想为 xml 文件中的每个元素附加一个属性。

```
IEnumerable<XElement> childList = from el in xml.Elements()
                                  select el;

textBox1.Text = childList.ToString();

foreach (XElement el in childList)
{
    el.Add(new XAttribute("Liczba_Potomkow", "dziesiec"));
    textBox1.Text = el.ToString();
    xml.Save("Employees.xml");
} 
```

不幸的是，当我打开文件时，似乎只有第一行受到影响。（只有第一个元素获得新属性）。为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:19:43.340

我假设`xml`是一个`XDocument`？如果是这样，您将`Elements()`直接调用根元素的*父*元素 - 因此它找到的唯一元素将是根元素本身。

如果你想对文档中的*所有*元素做一些事情，你应该使用[`Descendants()`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.descendants.aspx)方法。

此外，您的查询表达式毫无意义-您不妨只使用`xml.Elements()`-而且我真的不认为您应该在循环中保存。

我想你只是想要：

```
foreach (var element in xml.Descendants())
{
    element.Add(new XAttribute("Liczba_Potomkow", "dziesiec"));
}
xml.Save("Employees.xml"); 
```

# c# - 使用 caliburn AppBarButton 导航时绑定不起作用

> ID：14321196
> 
> 赞同：0
> 
> 时间：2013-01-14T15:17:49.267
> 
> 标签：c#, windows-phone-7, xaml, caliburn.micro

我对 AppBarButton 有这个奇怪的问题。我已将按钮绑定到我的视图模型中的方法，如下所示：

主视图的 XAML

```
<phone:PhoneApplicationPage.ApplicationBar>
    <shell:ApplicationBar IsVisible="True" IsMenuEnabled="True" BackgroundColor="{StaticResource HsAppBarColor}" Opacity="1">
        <shell:ApplicationBar.Buttons>
            <cal:AppBarButton IconUri="/icons/appbar.feature.settings.rest.png" Text="ajustes" Message="GoToSettings" />
            <cal:AppBarButton IconUri="/icons/appbar.favs.rest.png" Text="favoritos" Message="GoToFavs" />
        </shell:ApplicationBar.Buttons>
    </shell:ApplicationBar>
</phone:PhoneApplicationPage.ApplicationBar> 
```

用于 MainViewModel 的 C#

```
 public void GoToSettings()   {
        navigation.UriFor<SettingsViewModel>().Navigate();    
    } 
```

它会触发 GoToSettings 代码并导航到 SettingsView 页面，但是 SettingsViewModel 从未初始化，也不会调用构造函数。用于将视图与视图模型绑定的 Caliburn 代码不起作用。

我想知道是否在 MainPage 中有一个为其示例数据设置 DataContext 的 Pivot 可能会影响。我尝试评论数据上下文，但它仍然没有调用 SettingsViewModel 构造函数。

这是 Pivot XAML 代码

```
<controls:Pivot toolkit:TurnstileFeatherEffect.FeatheringIndex="0" Margin="0" Title="" DataContext="{Binding Source={StaticResource Stores}}" TitleTemplate="{StaticResource StoresPivotTitleTemplate}" HeaderTemplate="{StaticResource StoresPivotHeaderTemplate}"  Style="{StaticResource StoresPivotStyle}" FontFamily="Arial Narrow" Background="{x:Null}">
    <controls:PivotItem Header="Restorantes" BorderThickness="0,-20,0,0" Margin="12,0" Background="{x:Null}">
        <Grid>
            <ListBox  toolkit:TurnstileFeatherEffect.FeatheringIndex="2"  cal:Message.Attach="[Event SelectionChanged] = [Action Restaurants_SelectionChanged];" ItemTemplate="{StaticResource StoresListItemTemplate}" ItemsSource="{Binding Collection}" Margin="0" ItemContainerStyle="{StaticResource StoresListContainerStyle}" Background="{x:Null}"/>
        </Grid>
    </controls:PivotItem>
    <controls:PivotItem Header="Tiendas" Margin="12,0">
        <Grid>
            <ListBox  toolkit:TurnstileFeatherEffect.FeatheringIndex="2" cal:Message.Attach="[Event SelectionChanged] = [Action Stores_SelectionChanged];" ItemTemplate="{StaticResource StoresListItemTemplate}" ItemsSource="{Binding Collection}" Margin="0" ItemContainerStyle="{StaticResource StoresListContainerStyle}" FontFamily="Segoe WP"/>
        </Grid>
    </controls:PivotItem>
</controls:Pivot> 
```

Stores_SelectionChanged 方法也导航到一个页面，但这次绑定有效并且 viewmodel 构造函数被触发。

知道为什么它在 AppBarButton 中不起作用，但是当它们在后面使用相同的视图模型时它在 Pivot 附加操作中起作用？

编辑：添加完整的 xaml 以供查看

```
 <phone:PhoneApplicationPage
   xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
   xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
  xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:controls="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls" 
xmlns:cal="clr-namespace:Caliburn.Micro;assembly=Caliburn.Micro"
xmlns:controlsPrimitives="clr-namespace:Microsoft.Phone.Controls.Primitives;assembly=Microsoft.Phone.Controls"
xmlns:toolkit="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls.Toolkit"
   x:Class="Happyshop.Views.StoresView"
  SupportedOrientations="Portrait" Orientation="Portrait"
  mc:Ignorable="d" d:DesignHeight="768" d:DesignWidth="480"
  shell:SystemTray.IsVisible="True" Foreground="{x:Null}">

<toolkit:TransitionService.NavigationInTransition>
    <toolkit:NavigationInTransition>
        <toolkit:NavigationInTransition.Backward>
            <toolkit:TurnstileFeatherTransition Mode="BackwardIn"/>
        </toolkit:NavigationInTransition.Backward>
        <toolkit:NavigationInTransition.Forward>
            <toolkit:TurnstileFeatherTransition Mode="ForwardIn" BeginTime="0:0:0.7"/>
        </toolkit:NavigationInTransition.Forward>
    </toolkit:NavigationInTransition>
</toolkit:TransitionService.NavigationInTransition>
<toolkit:TransitionService.NavigationOutTransition>
    <toolkit:NavigationOutTransition>
        <toolkit:NavigationOutTransition.Backward>
            <toolkit:TurnstileFeatherTransition Mode="BackwardOut"/>
        </toolkit:NavigationOutTransition.Backward>
        <toolkit:NavigationOutTransition.Forward>
            <toolkit:TurnstileFeatherTransition Mode="ForwardOut" BeginTime="0:0:0.2"/>
        </toolkit:NavigationOutTransition.Forward>
    </toolkit:NavigationOutTransition>
</toolkit:TransitionService.NavigationOutTransition>

<phone:PhoneApplicationPage.Resources>
    <Style x:Key="StoresPivotStyle" TargetType="controls:Pivot">
        <Setter Property="Margin" Value="0"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Foreground" Value="{StaticResource PhoneForegroundBrush}"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <Grid/>
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="controls:Pivot">
                    <Grid HorizontalAlignment="{TemplateBinding HorizontalAlignment}" VerticalAlignment="{TemplateBinding VerticalAlignment}">
                        <Grid.Background>
                            <SolidColorBrush Color="{StaticResource HsDarkBlue}"/>
                        </Grid.Background>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="65"/>
                            <RowDefinition Height="96"/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        <Grid CacheMode="BitmapCache" Grid.RowSpan="3"/>
                        <Border Margin="-12,-5,0,0" BorderThickness="0,0,0,0">
                            <ContentPresenter ContentTemplate="{TemplateBinding TitleTemplate}" Content="{TemplateBinding Title}" Margin="12,5,0,0"/>
                        </Border>
                        <Border Grid.Row="1" toolkit:TurnstileFeatherEffect.FeatheringIndex="1" >
                            <controlsPrimitives:PivotHeadersControl x:Name="HeadersListElement" Background="Black"/>
                        </Border>
                        <ItemsPresenter x:Name="PivotItemPresenter" Margin="0" Grid.Row="2"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</phone:PhoneApplicationPage.Resources>
<phone:PhoneApplicationPage.Background>
    <SolidColorBrush Color="{StaticResource HsDarkBlue}"/>
</phone:PhoneApplicationPage.Background>
<phone:PhoneApplicationPage.FontFamily>
    <StaticResource ResourceKey="PhoneFontFamilyNormal"/>
</phone:PhoneApplicationPage.FontFamily>
<phone:PhoneApplicationPage.FontSize>
    <StaticResource ResourceKey="PhoneFontSizeNormal"/>
</phone:PhoneApplicationPage.FontSize>

<phone:PhoneApplicationPage.ApplicationBar>
    <shell:ApplicationBar IsVisible="True" IsMenuEnabled="True" BackgroundColor="{StaticResource HsAppBarColor}" Opacity="1">
        <shell:ApplicationBar.Buttons>
            <cal:AppBarButton IconUri="/icons/appbar.feature.settings.rest.png" Text="ajustes" Message="GoToSettings" />
            <cal:AppBarButton IconUri="/icons/appbar.favs.rest.png" Text="favoritos" Message="GoToFavs" />
        </shell:ApplicationBar.Buttons>
    </shell:ApplicationBar>
</phone:PhoneApplicationPage.ApplicationBar>

<controls:Pivot toolkit:TurnstileFeatherEffect.FeatheringIndex="0" Margin="0" Title="" DataContext="{Binding Source={StaticResource Stores}}" TitleTemplate="{StaticResource StoresPivotTitleTemplate}" HeaderTemplate="{StaticResource StoresPivotHeaderTemplate}"  Style="{StaticResource StoresPivotStyle}" FontFamily="Arial Narrow" Background="{x:Null}">
    <controls:PivotItem Header="Restorantes" BorderThickness="0,-20,0,0" Margin="12,0" Background="{x:Null}">
        <Grid>
            <ListBox  toolkit:TurnstileFeatherEffect.FeatheringIndex="2"  cal:Message.Attach="[Event SelectionChanged] = [Action Restaurants_SelectionChanged];" ItemTemplate="{StaticResource StoresListItemTemplate}" ItemsSource="{Binding Collection}" Margin="0" ItemContainerStyle="{StaticResource StoresListContainerStyle}" Background="{x:Null}"/>
        </Grid>
    </controls:PivotItem>
    <controls:PivotItem Header="Tiendas" Margin="12,0">
        <Grid>
            <ListBox  toolkit:TurnstileFeatherEffect.FeatheringIndex="2" cal:Message.Attach="[Event SelectionChanged] = [Action Stores_SelectionChanged];" ItemTemplate="{StaticResource StoresListItemTemplate}" ItemsSource="{Binding Collection}" Margin="0" ItemContainerStyle="{StaticResource StoresListContainerStyle}" FontFamily="Segoe WP"/>
        </Grid>
    </controls:PivotItem>
</controls:Pivot> 
```

更新这是一个愚蠢的错误。当您使用智能感知生成类时，创建的类不会标记为公共。默认情况下，类被标记为内部，因此 Caliburn 项目无法访问 ViewModel，因此它不会绑定它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T18:12:01.653

解决。问题是通过 Visual Studio 中的 Intellisense 代码生成创建的类未标记为公共。

必须将类标记为**公共**，以便 Caliburn 能够访问和实例化一个。否则，他们使用内部的默认可见性

# delphi - 使用来自 C++ Builder 的 7zip Delphi 包装器

> ID：14321197
> 
> 赞同：2
> 
> 时间：2013-01-14T15:17:52.533
> 
> 标签：delphi, wrapper, c++builder, 7zip

我正在尝试将“7za.dll”与这个 Delphi 包装器一起使用 - [http://www.progdigy.com/?page_id=13](http://www.progdigy.com/?page_id=13)

难以将此代码转换为 C++ 并理解包装器本身：

```
procedure TMainForm.ExtractAllClick(Sender: TObject);
  var Arch: I7zOutArchive;
begin
  Arch := CreateOutArchive(CLSID_CFormat7z);
  // add a file
  Arch.AddFile('c:\test.bin', 'folder\test.bin');
  // add files using willcards and recursive search
  Arch.AddFiles('c:\test', 'folder', '*.pas;*.dfm', true);
  // add a stream
  Arch.AddStream(aStream, soReference, faArchive, CurrentFileTime, CurrentFileTime, 'folder\test.bin', false, false);
  // compression level
  SetCompressionLevel(Arch, 5);
  // compression method if <> LZMA
  SevenZipSetCompressionMethod(Arch, m7BZip2);
  // add a progress bar ...
  Arch.SetProgressCallback(...);
  // set a password if necessary
  Arch.SetPassword('password');
  // Save to file
  Arch.SaveToFile('c:\test.zip');
  // or a stream
  Arch.SaveToStream(aStream);
end; 
```

我已经制作了包装器 Delphi 单元的附加包装器，当包含在 C++ 代码中时，它会在上面包装并且它可以工作。现在我想更进一步地使用它——直接在 C++ 代码中调用上面的代码。

如何`I7zOutArchive`在 C++ 中正确初始化、构造和释放此接口？

是否需要在上面的代码中销毁（空闲内存），还是在超出范围时自动销毁（我通常`boost::scoped_ptr`用来做这项工作，这里是否需要这样的东西）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:56:20.650

您确实需要销毁返回的东西`CreateOutArchive`，但这`scoped_ptr`是不合适的。相反，使用内置[`System::DelphiInterface`](http://docwiki.embarcadero.com/Libraries/XE3/en/System.DelphiInterface)类：

```
System::DelphiInterface<I7zOutArchive> Arch = CreateOutArchive(CLSID_CFormat7z); 
```

然后，像调用任何其他 COM 接口一样调用该对象上的方法。（将 Delphi 的`.`运算符替换为`->`，您就大功告成了。）当引用计数达到零时，对象将被销毁，这通常发生在`Arch`超出范围时。

# html - 餐桌礼仪 - 我需要保持一致吗？

> ID：14321203
> 
> 赞同：8
> 
> 时间：2013-01-14T15:18:04.213
> 
> 标签：html, html-table

我有一张桌子。例如：

```
<table>

<tr>
  <td>apple</td>
  <td>big</td>
</tr>

<tr>
  <td>pickle</td>
  <td>small</td>
</tr>

</table> 
```

在一些花哨的jQuery之后......

```
<table>

<tr>
  <td>apple</td>
  <td>big</td>
  <td>10kg  ------ Is this nice to do, any potential issues?</td>
</tr>

<tr>
  <td>pickle</td>
  <td>small</td>
</tr>

</table> 
```

只是为了好玩：http: [//jsfiddle.net/Czcby/](http://jsfiddle.net/Czcby/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:20:43.520

您最终将在第一行获得三个单元格，在第二行获得两个单元格。

这通常不会显示，但如果您的样式在表格单元格上有边距/边框/填充，它会影响表格的显示和布局。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T15:34:57.470

对我来说，简短的回答是肯定的。

更详细的答案是：您不需要严格保持一致，但如果您希望表格在浏览器中*看起来一致，这肯定**​​会有所帮助。*更不用说现在不一致的事实，即使它目前似乎没有引起问题，但当您想对表、它的样式或其中的数据做更多的事情时，它会产生更大的影响。

 *如果您在不同的浏览器中查看[此 JSFiddle](http://jsfiddle.net/guypursey/UMFyV/1/)，您可能会看到不同的行为：

*   **Chrome**和**IE8**：将表格渲染为具有从两个普通单元格中突出的额外单元格。
*   **Firefox**：实际上它看起来好像在第三列中有额外的空单元格。

想象一下，随着桌子的增长，在为这些不同情况设计样式时会出现哪些复杂情况。

可以说，该`colspan`物业是解决此问题的一种方式。我觉得`colspan`很丑；应该显示表格，以便您可以查看列标题并向下滚动以查看与该标题相关的信息。让其他一些数据进入该列会分散注意力。但这完全取决于您要做什么。

除了演示和信息设计问题之外，查看您的代码的人可能无法知道每行中有多少个单元格。最好在每一行中都有一个一致的数字，这样如果您需要对表格或其中的数据进行任何其他操作，您就可以快速轻松地检查它。对调试很有用。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-14T15:20:08.790

这样做没有问题，但是，您可能会遇到一些格式问题，因为现在第一行有 3 `td`，第二行有 2 。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-14T15:23:06.503

当 td 使用 2 列时使用 colspan="2"。*

# direct2d - 在 GPU 上的 Direct2D 中存储资源

> ID：14321205
> 
> 赞同：1
> 
> 时间：2013-01-14T15:18:22.713
> 
> 标签：direct2d

有没有办法在 GPU 上的 Direct2D 中存储“场景”？

我正在寻找类似的东西`ID2D1Mesh`（即以矢量格式存储资源，而不是作为位图），但我可以在其中配置是否应该使用抗锯齿渲染网格/场景/资源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:59:22.410

Rick 是正确的，因为您可以在两个不同级别应用抗锯齿。通过 Direct2D 或通过 Direct3D。你可以两者都做，但这是没有意义的，只会浪费资源并导致糟糕的结果。如果您想要每个基元几何感知抗锯齿，则 Direct2D 抗锯齿是合适的。如果您想在某些情况下牺牲一些质量以获得更好的整体性能，Direct3D 抗锯齿非常有用。

Direct2D 1.1 命令列表实际上存储/记录了可以针对不同目标回放的绘图命令列表。这可能是您所追求的，因为它没有被光栅化。从概念上讲，它就像在设备内存中存储矢量图。命令列表有一定的限制，因为命令列表一旦创建就无法修改，并且绘制的资源也可能不会更改，但它仍然非常方便。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T20:26:39.237

有一种方法可以使用 进行抗锯齿`ID2D1Mesh`，但这并不重要。您必须自己创建 Direct3D 设备，然后使用`ID2D1Factory::CreateDxgiSurfaceRenderTarget()`. 这允许您直接配置 D3D 设备的多重采样/抗锯齿设置，然后网格就可以正常播放（实际上我认为您总是告诉 Direct2D 使用锯齿渲染）。我自己没有这样做，但是有一个 MSDN 示例显示了如何执行此操作。这不适合胆小的人……为了进行软件渲染，您必须初始化 WARP 设备。但是，它确实有效。

此外，在 Direct2D 1.1（Windows 8 或 Windows 7 + 平台更新）中，您可以使用该`ID2D1CommandList`界面进行录制/播放内容。我不确定这是作为“编译到 GPU”（ala 网格）实现的，还是只是宏（命令的记录/回放）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-06T09:58:24.163

在 Windows 8.1 中，Direct2D 引入了[几何实现](http://msdn.microsoft.com/en-us/library/windows/desktop/dn363632%28v=vs.85%29.aspx)，它允许您存储几何图形的细分版本，然后按照您的要求将其渲染回来，无论是否使用抗锯齿。强烈建议使用网格而不是使用这些。命令列表虽然方便，但没有与自己创建和存储几何实现相同的缓存能力。

# java - 使用查找表的线性“平滑”函数

> ID：14321211
> 
> 赞同：5
> 
> 时间：2013-01-14T15:18:33.877
> 
> 标签：java, data-structures

如果我想编写一个函数（可能也是一个类），它从一个不可变的查找表（在调用构造函数时修复）返回线性“平滑”数据，如下所示： ![查找表和结果示例](../Images/476e0994c9c01c01f71be77c51d8a3ec.png)

例如`func(5.0) == 0.5`.

* * *

1.  存储查找表的最佳方式是什么？

    *   我正在考虑使用两个数组。
    *   还有其他更好的方法吗？

2.  计算所需值的最佳方法是什么？（就实时效率而言，不包括准备时间）

    *   我正在考虑对查找表进行预排序`arg`并使用二进制搜索来查找最近的两个点。
    *   或者我应该建立一个二叉树来简化搜索？
    *   或者还有其他更好的方法吗？

3.  *（次要）*人们将这种函数/类/数据结构/算法称为什么？在计算机科学中有任何正式的名称吗？

我想我可能需要编写自己的课程。该类充其量应该是不可变的，因为在初始化后无需更改它，并且可能会有多个线程使用它。我可能还需要通过索引获取键和值。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-14T15:27:05.807

看起来您正在尝试线性插值一组点。我会用 `java.util.NavigableMap`. 它提供了`higherEntry(K key)`方便`lowerEntry(K key)`获取相邻点的功能。

您将您的 s 放入地图`(x,y)`中。查询时`f(x_i)`，您首先检查映射是否包含在您的地图中，如果是，则返回它。如果没有，你会打电话`higherKey(x_i)`并`lowerKey(x_i)`找到相邻的两个点。然后使用公式对这两点进行插值（参见 [维基百科的线性插值页面](http://en.wikipedia.org/wiki/Linear_interpolation)）。

我还将在不同的类中实现插值逻辑，并将其作为构造函数参数传递给你的`function`类，以防你以后想使用不同的插值方法（即多项式插值）。

# java - 线程中的 Java 指令重新排序/缓存

> ID：14321212
> 
> 赞同：3
> 
> 时间：2013-01-14T15:18:41.593
> 
> 标签：java, multithreading, caching

读一本书，出现以下代码：

```
public class Test {

    private static boolean ready = false;
    private static int number = 0;

    public static class ListenerThread extends Thread {

        public void run() {

            while(!ready) {
                Thread.yield();
            }
            System.out.println(number);

        }

    }

    public static void main (String[] args) {

        new ListenerThread().start();
        number = 10;
        ready = true;

    }

} 
```

让我吃惊的要点，作者提的比较快。

1.  他们说 ListenerThread 可能永远不会终止。我考虑了几天（在我的脑后），我唯一的结论是它可能被那个 ListenerThread 缓存了。真的吗？制作`ready`volatile 会解决问题吗（因为它不应该再缓存它了）？

2.  他们还说程序可能会打印 0。我现在明白 Java 可能会重新排序指令，因此在更改数字之前准备好对另一个线程是正确的。除了将这些指令放在同步块中解决问题（在中央锁值上）之外，还有什么方法（技术）？我在想也许可以实现 notify()/wait()，但我觉得它会遭受同样的后果。避免该问题的最佳方法是什么？

谢谢！

编辑：

我只是觉得我已经阅读了很多代码，很少有人会费心防止在多个线程中重新排序。这有多普遍？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-14T15:35:24.817

> 我唯一的结论是它可能被那个 ListenerThread 缓存了。真的吗？准备好易失性会解决问题吗（因为它不应该再缓存它了）？

不仅缓存，而且 JIT 可以在线程从不更改值的基础上内联该值。即它变得硬编码。

使用 volatile 可防止做出此类假设。它将强制它每次读取缓存一致的副本。

> 我现在明白 Java 可能会重新排序指令，

不仅是 Java，CPU 也可以重新排序指令。JIT 知道 CPU 可以进行这种重新排序，而 AFAIK 它很少需要这样做，因为它假设 CPU 会做得很好。

顺便说一句，访问 volatile 变量还可以防止指令重新排序，因此使`ready`volatile 可以解决这两个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T15:26:26.167

> 他们说 ListenerThread 可能永远不会终止。我想了几天，唯一的结论是它可能被那个ListenerThread缓存了。真的吗？准备好易失性会解决问题吗（因为它不应该再缓存它了）？

这是真的，是的。是的，声明变量`volatile`会改变变量的内存访问语义，并在每次访问变量时强制重新读取。

> 他们还说程序可能会打印 0。我现在明白 Java 可能会重新排序指令，因此在更改数字之前准备就绪对另一个线程是正确的。除了将这两条指令放在同步块中之外，还有什么方法可以解决问题？我在想也许可以实现 notify()/wait()，但我觉得它会遭受同样的后果。

这是因为没有*顺序*保证，所以 JVM 可以自由地对变量赋值进行重新排序。如果你想让`number`双方都能看到，你必须防止这种重新排序，正如@PeterLawrey 所说，让`ready`volatile 足以做到这一点。

# linux - 如何使用不同的出口 IP 一次运行多个 Tor 进程？

> ID：14321214
> 
> 赞同：40
> 
> 时间：2013-01-14T15:18:42.480
> 
> 标签：linux, proxy, screen-scraping, socks, tor

我是 Tor 的新手，我觉得应该考虑多个 Tor。我在这里提到的多个 tors 不仅是多个实例，而且还为每个实例使用不同的代理端口，就像这里所做的一样 [http://www.howtoforge.com/ultimate-security-proxy-with-tor](http://www.howtoforge.com/ultimate-security-proxy-with-tor) )

我正在尝试开始使用 4 Tors。但是，本教程仅适用于 Arch Linux，我使用的是无头 EC2 ubuntu 64 位。经历 Arch 和 Ubuntu 之间的差异真的很痛苦。在这里，我想知道是否有人可以提供一些帮助来简单地实现我的想法。

1.  四个 Tors 同时运行，每个 Tors 都有一个单独的端口，privoxy 或 polipo 或者一旦它工作就可以了。喜欢：8118 <- Privoxy <- TOR <- 9050 8129 <- Privoxy <- TOR <- 9150 8230 <- Privoxy <- TOR <- 9250 8321 <- Privoxy <- TOR <- 9350

2.  这样，如果我尝试返回 127.0.0.1:8118、8129、8230 和 8321 的 ip，它们应该返回四个不同的 ip，这表明有四个不同的 Tors 同时运行。然后，几分钟后，再次检查，他们四个应该都有一个新的 ips。

我知道我的简单“梦想”可以通过多种方式实现，但是……我不仅是 Tor 新手，甚至是 bash 和 python 新手……这就是为什么我来这里看看你们中的一些人是否能点亮我起来。

这些链接可能有用：

[http://blog.databigbang.com/distributed-scraping-with-multiple-tor-circuits/](http://blog.databigbang.com/distributed-scraping-with-multiple-tor-circuits/) [https://www.torservers.net/wiki/setup/server#multiple_tor_processes](https://www.torservers.net/wiki/setup/server#multiple_tor_processes) 最好的，

顺便说一句，如果我运行 `$ ps -A | grep 'tor'` 我有几个实例，但是用“？” 在 tty 列下，这是什么意思，因为我知道 tty 表示终端？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-09-19T13:07:27.717

创建四个 torrc 文件，比如`/etc/tor/torrc.1`.`.4`

在每个文件中，编辑以下行：

```
SocksPort 9050
ControlPort 9051
DataDirectory /var/lib/tor 
```

为每个`torrc`文件使用不同的资源，例如 for `torrc.1`：

```
SocksPort 9060
ControlPort 9061
DataDirectory /var/lib/tor1 
```

对于`torrc.2`,

```
SocksPort 9062
ControlPort 9063
DataDirectory /var/lib/tor2 
```

等等。

仅包含上述行的配置文件将起作用：如果您愿意，可以从默认模板中删除每隔一行。

`DataDirectory`也可以相对于`tor`启动的当前目录，例如：

```
DataDirectory d1 
```

然后像这样启动tor：

```
tor -f /etc/tor/torrc.1  
tor -f /etc/tor/torrc.2 
```

其他两个文件依此类推。

这将在四个端口上创建四个不同的 Socks5 服务器。每个人都会打开一个不同的电路，这就是你想要的。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-09-19T23:51:42.317

[建议不要使用](https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO#ToroverTor)链式 Tor 。您可能会得到更差的匿名性，而不是更好的匿名性。

> 这样做会产生未定义且可能不安全的行为。然而，理论上，您可以得到 6 个跃点而不是 3 个跃点，但不能保证您会得到三个不同的跃点 - 您最终可能会得到相同的跃点，可能是相反的或混合的顺序。目前尚不清楚这是否安全。它从未被讨论过。
> 
> 您可以选择一个入口/出口点，但是当您将路线选择留给 Tor 时，您将获得 Tor 可以提供的最佳安全性；覆盖进入/退出节点可能会以我们不理解的方式破坏您的匿名性。因此，强烈建议不要使用 Tor 而不是 Tor。

如果您比 Tor 开发人员更聪明，您应该只使用 Tor 的路由算法。

Tor 项目很久以前就弃用了 privoxy / polipo。[建议](https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO/WebBrowsers)您只使用[Tor 浏览器](https://torproject.org/projects/torbrowser.html.en)。只有 Tor 浏览器为您提供统一的网络指纹，您不会脱颖而出。

由于 Tor 版本 0.2.3，不同的 Socks、- Dns- 或 TransPorts 通过不同的电路，因此防止了身份相关。术语是流隔离。得到这个，你可以添加到torrc ...

```
SocksPort 9050
SocksPort 9052
SocksPort 9053
SocksPort 9054
#... 
```

...而且他们都会想到不同的电路。

当您使用 Tor 浏览器时，您还可以使用 Tor Button 的新身份功能。单击 Tor 按钮（大葱）并选择新身份。这将重置所有浏览器状态并更改 Tor 的电路。

（[而且它是 Tor，而不是 TOR。](https://torproject.org/docs/faq.html.en#WhyCalledTor)）

请注意，当使用流隔离时，通过不同的电路并不能保证获得不同的 Tor 出口节点。有时 Tor 只会使用不同的入口保护或中间中继。[这个是正常的。](https://tor.stackexchange.com/questions/230/when-i-click-new-identity-why-do-i-sometimes-end-up-with-the-same-exit-relay)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-05-13T18:40:01.780

我尝试了 torrc.1 ，torrc.2 等......但它没有用。

然而，这个工作：

1.  通过以下方式停止 tor 进程：`/etc/init.d/tor stop`
2.  打开`gedit /etc/tor/torrc` （如果您不是root，则在它之前放置sudo以以root身份访问）
3.  搜索`SocksPort 9050`
4.  现在将您想要的任何端口作为流端口（SocksPort 9060，SocksPort 9070，SocksPort 9080 ....等）
5.  搜索 ControlPort 9051
6.  现在将您想要的任何端口作为流端口（ControlPort 9061，ControlPort 9071，ControlPort 9081 ....等）**注意控制端口始终为 SOCKSPORT+1**
7.  再次启动 tor 进程：`/etc/init.d/tor start`
8.  检查tor状态`/etc/init.d/tor status`

它应该显示类似的内容：

```
tor.service - Anonymizing overlay network for TCP
   Loaded: loaded (/lib/systemd/system/tor.service; enabled; vendor preset: enabled)
   Active: active (running) since Fri 2016-05-13 22:18:21 GST; 1s ago
  Process: 10259 ExecReload=/bin/kill -HUP ${MAINPID} (code=exited, status=0/SUCCESS)
  Process: 10319 ExecStartPre=/usr/bin/tor --defaults-torrc /usr/share/tor/tor-service-defaults-torrc -f /etc/tor/torrc --RunAsDaemon 0 --verify-config (code=exited, status=0/SUCCESS)
  Process: 10317 ExecStartPre=/usr/bin/install -Z -m 02750 -o debian-tor -g debian-tor -d /var/run/tor (code=exited, status=0/SUCCESS)
 Main PID: 10322 (tor)
   CGroup: /system.slice/tor.service
           └─10322 /usr/bin/tor --defaults-torrc /usr/share/tor/tor-service-defaults-torrc -f /etc/tor/torrc --RunAsDaemon 0

May 13 22:18:20 momen-Lenovo tor[10322]: May 13 22:18:20.860 [notice] Tor v0.2.6.10 (git-71459b2fe953a1c0) running on Linux with Li... 1.2.8.
May 13 22:18:20 momen-Lenovo tor[10322]: May 13 22:18:20.860 [notice] Tor can't help you if you use it wrong! Learn how to be safe ...warning
May 13 22:18:20 momen-Lenovo tor[10322]: May 13 22:18:20.860 [notice] Read configuration file "/usr/share/tor/tor-service-defaults-torrc".
May 13 22:18:20 momen-Lenovo tor[10322]: May 13 22:18:20.860 [notice] Read configuration file "/etc/tor/torrc".
May 13 22:18:20 momen-Lenovo tor[10322]: May 13 22:18:20.863 [notice] Opening Socks listener on 127.0.0.1:9050
May 13 22:18:20 momen-Lenovo tor[10322]: May 13 22:18:20.863 [notice] Opening Socks listener on 127.0.0.1:9060
May 13 22:18:20 momen-Lenovo tor[10322]: May 13 22:18:20.863 [notice] Opening Control listener on 127.0.0.1:9051
May 13 22:18:20 momen-Lenovo tor[10322]: May 13 22:18:20.863 [notice] Opening Control listener on 127.0.0.1:9061
May 13 22:18:20 momen-Lenovo tor[10322]: May 13 22:18:20.863 [notice] Opening Control listener on /var/run/tor/control
May 13 22:18:21 momen-Lenovo systemd[1]: Started Anonymizing overlay network for TCP. 
```

**提示**：有些线条是椭圆的，使用 -l 来完整显示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-10T23:45:35.113

制作一个tor配置目录：
`$> mkdir -p ~/configuration_files/tor`
`$> config=~/configuration_files/tor`
`$> cd "${config}"`

复制`/etc/tor/torrc`到配置目录并根据需要制作尽可能多的副本：例如10
`printf "torrc_%0.2s\n" {1..10} | xargs -I {} /bin/cp /etc/tor/torrc "${config}{}"`

将 复制`/etc/torsocks.conf`到配置目录并根据需要制作尽可能多的副本：例如与上述 10 相同
`printf "torsocks_%0.2s.conf\n" {1..10} | xargs -I {} /bin/cp /etc/torsocks.conf "${config}/{}"`

创建新的数据目录并修复所有权/权限：
`$> sudo mkdir /var/lib/tor{1..10}`

编辑配置文件以具有不冲突的相应端口号：

```
for a in {1..10}; do 
 sed -i "s/^#SocksPort 9050.*/SocksPort $((9050+${i}))/;s|^#DataDirectory /var/lib/tor|DataDirectory /var/lib/tor${i}|" torrc_${i}
 sed -i "s/server_port = 9050/server_port = $((9050+${i}))/" torsocks_${i}.conf
 sudo chmod -R --reference /var/lib/tor /var/lib/tor${i}
 sudo chown -R CHANGETHIS:CHANGETHIS /var/lib/tor${i} 
done 
```

注意：将 CHANGETHIS 更改为计划使用它的用户的用户/组。

之后很容易上手，您可以使用相应的配置文件启动 Tor 的各个实例，例如`/usr/bin/tor -f "${config}/torrc_3"`

要使用它，您只需导出变量 TORSOCKS_CONF_FILE 以指向相应的`torsocks.conf`文件：
例如`$> export TORSOCKS_CONF_FILE="${config}/torsocks_3.conf"`

接下来，您可以从该特定 shell 中 torify / torsocks 任何应用程序，它将使用 torsocks_3.conf 代理。
尝试：`$> torify bash`
`$> curl www.ipmango.com/api/myip`

要更改为另一个代理，只需使用其 torrc 文件启动相应的 tor 并导出 TORSOCKS_CONF_FILE 变量以指向新配置。

这是一个完成这项工作的简单别名，在您按上述方式进行设置并安装 roxterm 之后。它将检查`netstat`代理是否已经启动，如果没有，它将在单独的 shell 窗口中启动它。

`alias prox='_(){ proxy=${1:-1}; config_base="~/configuration_files/tor"; port=$((9050+${proxy})); netstat -an | { ! grep -q "127.0.0.1:${port}"; } && roxterm -e bash -c "/usr/bin/tor -f \"${config_base}/torrc_${proxy}\"; bash"; export TORSOCKS_CONF_FILE="${config_base}/torsocks_${proxy}.conf"; }; _'`

要使用它：

```
$> prox 4 
$> torify bash 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-17T10:39:53.347

1.  从官方网站下载适用于 Windows 的 Tor 浏览器
2.  多次提取 Tor 浏览器（每次更改目标文件夹名称）
3.  跳过第一个 Tor 浏览器并按照步骤 4-6 操作剩余的 Tor 浏览器实例。
4.  启动 Tor 浏览器，在搜索栏中搜索 about.config
5.  在tor-browser的配置窗口中搜索extensions.torlauncher.start_tor
6.  将 start_tor 的值从 TRUE 更改为 FALSE
7.  对除最后一个之外的所有 Tor 浏览器实例执行第 8 步。
8.  转到 TorBrowser、数据、Tor、torrec-defaults。在文件末尾添加“SocksPort 9153”并保存文件。对于每个新的 Tor 浏览器实例，将 9153 递增 1。

资料来源：[如何使用不同的 IP 运行多个 Tor 浏览器](https://youtu.be/ddA8alepEv0)

# jquery - 用于种子的 isoHunt JSON 搜索 API 不起作用

> ID：14321215
> 
> 赞同：2
> 
> 时间：2013-01-14T15:18:48.423
> 
> 标签：jquery, json, api, parsing, search

我正在尝试使用 isoHunt 搜索 API，但是当我尝试解析 URL（在我的浏览器中查看其位置后似乎是正确的）时，什么也没有发生。下面是我用来尝试测试脚本的脚本。有谁知道是什么导致它无法解析 JSON 文件？

```
<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<title>isoHunt Search</title>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){
$("#button").click(function(){
    var keywords = $("#keywords").val();
    var url = "http://isohunt.com/js/json.php?ihq=" + keywords;
    $("#output").append(url);
    $.getJSON(url, function(data){
        $("#output").append("TEST123");
    });
});
});
</script>
</head>
<body>
<input type="text" name="keywords" id="keywords" />
<button id="button">Search</button>
<div id="output"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T04:02:21.263

出于某种原因（[在此处阅读](http://isohunt.com/forum/viewtopic.php?t=150656&postdays=0&postorder=asc&start=15&sid=)）isohunt 不支持 JSONP，因此您不能在此处使用使用 ajax 跨域。但是您可以在您的域内创建代理

# git - 在 git rebase 期间：同一个文件不断冲突

> ID：14321218
> 
> 赞同：8
> 
> 时间：2013-01-14T15:18:59.813
> 
> 标签：git, git-rebase

我检查了一个名为“主题”的分支。我仍在研究主题，但我想包括现在在 master 分支中的更改。所以我这样做了：

```
$ git checkout topic
$ git rebase master 
```

之后，文件出现了合并冲突`xyz.txt`。所以我将文件修改为我想要的， git add 它，然后`git rebase --continue`.

但立即，同一个文件发生了合并冲突。我再次修复了文件，这次必须`git reabase --skip`继续。

**但是同样的文件*再次*具有完全相同的合并冲突。这是怎么回事？**

编辑：

以前，我一直在将 master 合并到 topic 分支来完成这个目的。然后我才知道变基。所以我猜这与它有关。

* * *

这是第三次提交之前的 git 状态

```
$ git status
# Not currently on any branch.
# Unmerged paths:
#   (use "git reset HEAD <file>..." to unstage)
#   (use "git add/rm <file>..." as appropriate to mark resolution)
#
#       both modified:      xyz.java
#
no changes added to commit (use "git add" and/or "git commit -a")

$ git ls-files -u
100644 cbf74a88604dd4ee0afe89d7aac1d179ce75e92c 1       xyz.java
100644 52841c2b4b6cc055251d533d5b83441d1329b412 2       xyz.java
100644 c45e7c6b979ec1e20b7dd70b38698193ea235abd 3       xyz.java

$ git log --graph --pretty=format:%d HEAD master topic
*  (HEAD)
*
*  (master)
*
*
*
*
*
*
*
*
| *  (topic)
| *
| |\
| |/
|/|
* |
| *
| *
| |\
| |/
|/|
* |
| *
| *
| *
| *
| *
| |\
| |/
|/|
* |
| *
| *
| *
| *
| *
| *
| *
| |\
| |/
|/|
* |
* |
* |
|\ \
| * |
* | |
|/ /
| *
| *
| |\
| |/
|/|
* |
| *
| *
| *
| *
| *
| *
| *
| *
| *
| |\
| |/
|/|
* |
| *
| |\
| |/
|/|
* |
| *
| *
| *
| *
|/
*
* 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T15:45:48.233

尝试`git rebase --interactive`验证 Git 如何重新设置历史记录。将有一个提交列表，将按照给定顺序应用到您的基本提交之上，即`master`：

例子：

```
pick 12345678 # This will be the first commit of your rebased topic branch
pick deadbeef
pick ffffffff
pick 01010101 # This will be HEAD after the successful rebase 
```

有时，Git 不知道提交是否真的是分支中的新提交，或者只是`master`具有不同祖先的现有提交（来自）。您可以通过从文本文件中删除提交来跳过提交。

如果这不能立即解决您的冲突，则两个分支之间存在*真正的冲突。*请务必合并文件并使用`git add`. 之后一定要使用`git rebase --continue`继续前进。`git rebase --skip`如果您不确切知道它在这里有用，请不要使用。（`--skip`将忽略当前的冲突提交并尝试应用下一个提交，这可能会导致以后进一步的难以理解的冲突）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:33:31.747

我不完全知道这是如何导致问题的，但我非常确定问题出在我之前是合并而不是变基的事实。但是我还没有推送`topic`，所以我将完成整个 rebase 过程。

# php - PHP shell_exec() 终止进程

> ID：14321219
> 
> 赞同：0
> 
> 时间：2013-01-14T15:19:00.920
> 
> 标签：php, process, kill, shell-exec, terminate

每当我在 PHP 中通过 shell_exec() 执行命令时，它都会自动启动新进程。执行命令时 PHP 会自动终止该进程吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:30:40.620

一旦命令完成执行，PHP 将自动终止他启动的新进程，并且您的脚本将继续（它可以在 exec() 命令运行时继续，但您需要将输出重定向到文件）

# javascript - ExpressionEngine Safecracker 访客感谢您的电子邮件

> ID：14321222
> 
> 赞同：1
> 
> 时间：2013-01-14T15:19:13.823
> 
> 标签：javascript, jquery, html, expressionengine, safecracker

提交保险箱表格后是否可以向客人发送感谢电子邮件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T21:13:13.203

您愿意用 PHP 编写来发送这封电子邮件吗？

您可以编辑 Safecracker 的其中一个挂钩，以在提交表单时执行操作（发送电子邮件）。

`$this->EE->extensions->call('safecracker_submit_entry_start', $this);`

[http://ellislab.com/expressionengine/user-guide/modules/safecracker/development.html](http://ellislab.com/expressionengine/user-guide/modules/safecracker/development.html)

# jquery - 使用 jQuery 对 Web 服务进行轮询

> ID：14321229
> 
> 赞同：0
> 
> 时间：2013-01-14T15:19:38.617
> 
> 标签：jquery, asp.net, ajax, web-services

我需要每小时轮询**一次**网络服务以检查新消息。我想用 jQuery 来做。ajax 调用是这样的：

```
function checkForMessages(rowid) {
$.ajax({
    type: "POST",
    url: "MyPage.aspx/CheckForMessages",
    contentType: "application/json; charset=utf-8",
    data: "{'currentMessages': '" + cMessages+ "'}",
    dataType: "json",
    success: function (msg) {

    },
    error: function (response) {

    }
});
} 
```

`url: "MyPage.aspx/CheckForMessages"`实际上是一个PageMethod而不是Webservice。

我不明白的是如何用 jquery 制作**“循环”**，等待一个小时来调用上述函数。

那么我怎样才能让代码每小时只调用**一次**这个函数呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:24:24.640

```
window.setIntervall(function, delay); 
```

以毫秒为单位的延迟。

但是，使用这种方法，站点必须始终处于打开状态。您可以使用服务器发送事件将消息从服​​务器推送到您的站点，但这需要大量工作..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:25:05.650

看`setInterval()`...

[http://www.w3schools.com/jsref/met_win_setinterval.asp](http://www.w3schools.com/jsref/met_win_setinterval.asp)

```
setInterval(checkForMessages, 3600000); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T15:25:18.293

window.setInterval 是最好的方法，如果网页仍然打开，显然它只会在一个小时后轮询。

```
$(function () {
    setInterval(myPollingMethod, 3600000);
});

function myPollingMethod()
{
  //this will repeat every 1 hour (3600 seconds)
} 
```

如果要停止轮询，也不要忘记调用 window.clearInterval 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T15:26:29.713

```
function checkForMessages(rowid) {
$.ajax({
    type: "POST",
    url: "MyPage.aspx/CheckForMessages",
    contentType: "application/json; charset=utf-8",
    data: "{'currentMessages': '" + cMessages+ "'}",
    dataType: "json",
    success: function (msg) {
        //do stuff here
        setTimeout(function(rowid) {checkForMessages(rowid);},3600000);
    },
    error: function (response) {

    }
});
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-14T15:29:25.360

您可以使用`setTimeout`函数来实现所需的结果：

```
function checkForMessages(rowid) {
    $.ajax({
        type: "POST",
        url: "MyPage.aspx/CheckForMessages",
        contentType: "application/json; charset=utf-8",
        data: "{'currentMessages': '" + cMessages+ "'}",
        dataType: "json",
        success: function (msg) {
            ...
        },
        error: function (response) {
            ...
        },
        complete: function() {
            ...
            setTimeout(function() { checkForMessages(rowid); }, 3600000);
        }
    });
} 
```

这样，当你第一次调用你的函数并且你的`$.ajax`调用完成时（不管它是成功还是错误），它将安排在一小时后再次执行该函数（但请记住，一小时在网络世界中是很多时间，授权可能会过期等）。

# python - Tkinter Lambda 按钮

> ID：14321230
> 
> 赞同：0
> 
> 时间：2013-01-14T15:19:39.337
> 
> 标签：python, python-2.7, tkinter

```
 from Tkinter import *
 import os

 ALL = N+S+W+E

 class Application(Frame):
def __init__(self, master=None):
    Frame.__init__(self, master)
    self.master.rowconfigure(0, weight=1)
    self.master.columnconfigure(0, weight=1)
    self.grid(sticky=ALL)

    for r in range(2):
        self.rowconfigure(r, weight=1)

        names = {0:'RED', 1:'BLUE', 2:'GREEN', 3:'BLACK', 4:'OPEN'}    
    for c, colname in enumerate(names):
        name = names[c]
        self.columnconfigure(c, weight=1)
        if colname < 4:
            Button(self, text=name, command = lambda x = name:  self.setcolor(x)).grid(row=2, column=c, sticky=ALL)
        else:
            Button(self ,width =30, text=name, command=self.doFileOpen).grid(row=2,column=c,sticky=ALL)  

    Frame1 = Frame(self, bg="red")
    Frame1.grid(row = 0, column = 0, rowspan = 1, columnspan = 2, sticky = ALL)
    Frame1.bind("<Button-1>", self.handler_1)
    Frame2 = Frame(self, bg="yellow")
    Frame2.grid(row = 1, column = 0, rowspan = 1, columnspan = 2, sticky = ALL)
    Frame2.bind("<Button-1>", self.handler_2)
    Frame3 = Frame(self)
    Frame3.grid(row = 0, column = 2, rowspan = 2, columnspan = 3, sticky = ALL)
    self.text_in = Entry(Frame3)
    self.output = Text(Frame3)
    self.text_in.pack(fill = X, expand=False)
    self.output.pack(fill = BOTH, expand=True)

def handler_1(event):
        print("clicked Frame 1 at", event.x, event.y)

def handler_2(event):
        print("clicked Frame 2 at", event.x, event.y)

def doFileOpen(self):
    eText = self.text_in.get()
    self.output.delete(1.0,END)
    self.output.insert(1.0, eText)

def setcolor(self,bname):

 root = Tk()
 app = Application(master=root)
 app.mainloop() 
```

当我按下其中一个按钮 <4 时，我试图获取一个要调用的 setcolor 定义。我在编写设置颜色定义时遇到问题。一旦我按下按钮更改从输入框收集的文本框中的文本颜色，最好的方法是什么？当我单击“红色”框时，文本变为红色，“蓝色”变为蓝色等。

我需要再次调用 dofileopen 还是可以在事后更改颜色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:41:03.063

我不确定我理解正确，但是您问如何编写`setcolor`函数以使其具有颜色，然后设置相应文本框的颜色？您可以执行以下操作：

```
def setcolor(self,bname):
    if bname == "RED": #or 1, can't tell how you've written it
        self.text_in.config(foreground = RED) #I think that's how colors work in tkinter
    elif bname == "BLUE":
        self.text_in.config(foreground = BLUE)
    #etc etc 
```

`self`它假设`Entry`您想要更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T16:42:04.593

所有 Tkinter 小部件都有一个`configure`方法，可让您更改与该小部件关联的任何选项。例如，要更改小部件的前景色，您可以这样做：

```
self.output.configure(foreground="red") 
```

对于文本小部件，您可以通过配置标签来更改一系列字符的属性，然后将该标签添加到一系列文本中。例如：

```
self.output.tag_configure("tag1", foreground="red")
...
self.output.tag_add("tag1", 1.0, 2.0) 
```

# google-apps-script - 捕捉超过最大执行时间？

> ID：14321235
> 
> 赞同：1
> 
> 时间：2013-01-14T15:19:52.143
> 
> 标签：google-apps-script

是否有捕捉到这个 GAS 错误：“超过最大执行时间”

我的意思是用 try ... catch(e) // 捕获它对我不起作用。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T18:39:12.667

正如您对问题的评论中所写，那是不可能的。但是，您可以在执行开始时在 scriptDB 或属性中设置一个标志，并在执行正常结束时清除该标志，这样您就可以在下一次运行期间发现您的脚本在上次运行时是否正常结束如果没有，请尝试采取纠正措施。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-02T21:50:08.040

上面的答案是正确的；这是不可能的。pbhd 提到的解决方法的一个简单替代方法是简单地跟踪脚本的运行时间（例如`new Date().getTime()`，定期比较结果）并在`catch`达到最大执行时间之前运行您在语句下包含的任何内容。最长为 6 分钟（[参考](https://developers.google.com/apps-script/guides/services/quotas)）。

这样，您就不必捕获错误——您可以抢占它。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2016-01-31T13:46:10.837

在正常测试期间，可能会意外创建一个无限（或非常长时间运行）循环，该循环会消耗 100% 的每日执行时间限制。

即使您**立即意识到自己有什么问题，您也不能***在 24 小时内*立即重新尝试使用 Google 脚本- 从而显着减慢正在进行的开发，并可能迫使开发人员做一些其他工作，转移他的注意力/“注意力流”远离当前的问题。这几乎总是不好的。

我的产品（“IBM OLIVER CICS 测试/调试”——参见[Wikipedia 文章](https://en.wikipedia.org/wiki/IBM_OLIVER_%28CICS_interactive_test/debug%29)）在大约 37 年前解决了这个问题——以及许多其他问题——通过对任何*特定*事务设置时间限制并拦截由此产生的超时，允许以下选项：-

1.  继续或
2.  检查/修改变量
3.  “手动”重试（同时）或
4.  中止。

谷歌可以很容易地实施这种方法——如果执行时间看起来太长，可以通过“暂停”。我对 OLIVER 中的其他资源有类似的解决方案 - 例如过多的 API 调用（“可能的宏循环”）和过多的内存使用。

似乎需要像我这样的“老前辈”来解决“从一开始”就存在的问题（当然是在想到 PC 之前）。

谷歌当前的“解决方案”（即绝对限制）只能帮助谷歌防止自己的服务器被淹没。他们很容易做 OLIVER 多年前所做的事情。顺便说一句，维基百科文章中不应该有“IBM”前缀——这是我自己的产品，一些小丑维基百科编辑对其进行了修改以包含前缀。

（顺便说一句，Google 不会阻止同一 s/s 上的其他脚本运行 - 这可能只使用*最少*的额外时间（即同一电子表格上的脚本仍然有效）。我尝试将原始脚本重命名为实验，但它是在很短的时间后停止，出现“超过执行时间”错误。

GIZ-A-JOB Google - 你知道它的价值！

# android - 为多种屏幕尺寸设计安卓应用

> ID：14321237
> 
> 赞同：1
> 
> 时间：2013-01-14T15:19:57.710
> 
> 标签：android, layout, size, screen

我正在设计一个最低 SDK 版本为 8 的 android 应用程序。我目前一直在运行大约 4 英寸手机的模拟器上对其进行测试...

我最近得到了一个 Nexus 7 并在上面运行它。我以为它只会放大屏幕（包括按钮和文本）所以它基本上被放大了......它不是

我彻底搜索了它并想出了使用不同的布局大小（顺便说一下，我使用的是 Eclipse）所以我创建了一个“layout-large”文件夹，但出现以下错误并且屏幕布局的设计视图不会显示

```
'It looks like you are using a render target where the layout library does not support the tvdpi density.

Please try either updating to the latest available version (using the SDK manager), or if no updated version is available for this specific version of Android, try using a more recent render target version.

Exception raised during rendering: Index: 2, Size: 2
Exception details are logged in Window > Show View > Error Log' 
```

我该如何解决这个问题？我不想从 8 更改最低 SDK

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T15:41:18.067

`tvdpi`似乎已在Android [3.2](http://developer.android.com/about/versions/android-3.2.html)（即 SDK 级别 13）中实现。如果您想使用备用资源定位 Nexus 7 显示器，我建议定位`large`屏幕而不是`tvdpi`. 您不必更改 SDK 级别 8 的最低要求，因为在瞄准 Nexus 7 时以电视密度为目标是没有意义的，但也许这只是我。

Stackoverflow 上有另一个类似的问题，答案很好：[如何为 Galaxy S3 和 Nexus 7 创建不同的布局？](https://stackoverflow.com/questions/12816169/how-to-create-different-layout-for-galaxy-s3-and-nexus-7)

另请访问[Android 开发人员设计指南](http://developer.android.com/design/index.html)，特别[是多屏幕设计以](http://developer.android.com/training/multiscreen/index.html)获取更多信息。Android 指南是我一直使用的一个非常好的网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:31:05.330

首先，[developer.android.com](http://developer.android.com/training/basics/supporting-devices/screens.html)上有很多关于针对不同屏幕尺寸进行编程的信息。[片段](http://developer.android.com/guide/components/fragments.html)非常适合这个。您是否摆脱了“布局”文件夹。从您的问题来看，您刚刚重命名了布局文件夹。我会首先在 Android 开发者信息中心阅读大量内容。检查第一个链接。

# c++ - C++ 循环（三角形抽屉）

> ID：14321238
> 
> 赞同：-3
> 
> 时间：2013-01-14T15:19:58.863
> 
> 标签：c++, geometry, drawing

我不能让我的程序工作，我已经用标记（goto）试过了。但我无法让它工作。我也尝试改进循环，但它以无限循环结束。感谢帮助！

```
#include <iostream> //includes
using namespace std;
int makedreieck(int länge) // function for drawing a triangle
{
    int rows=0; //rows
    int draw=0; //drawed
    while(draw <= länge)
    {
        draw++;
        cout << "*";
        if(draw == länge-1)
        {
            rows++;
            draw = länge-rows;
            cout << endl;
        }
        if(draw == 1)
        {
            getchar();
            return 0;
        }
    }
}

int main(char argument)
{
    int dreieck;
    cin >> dreieck;
    makedreieck(dreieck);
    getchar();
    return 0;
} 
```

终于开始工作了……如果有人需要代码：

```
#include <iostream>
#include <time.h>
#include <windows.h>
#include <tchar.h>
using namespace std;

int createtriangle(int length, bool custom, char symbol)
{
    clock_t start, finish;
    length++;
    int OK=0;
    int OK_ABORT;
    int TRIANGLE_NOT_ALLOWED;
    enum returnvalues{OK, OK_ABORT, TRIANGLE_NOT_ALLOWED};
    if(length<=0)
    {
        cerr << "Dreieck mit einer Laenge von " << length-1 <<" unerlaubt.";
        return TRIANGLE_NOT_ALLOWED;
    }
    if(length>81)
    {
        cout << "Es wurde eine ueber 80 Sternchen lange Treppe entdeckt." << endl << "Es wird empfohlen die Operation abzubrechen"<< endl << "1: abbrechen 2: weiter"<<endl<<"Auswahl: ";
        int sel;
        cin >> sel;
        getchar();
        if(sel>2)
        {
            cout << "Es gibt die Auswahl: "<<sel<<" nicht.";
        }
        system("cls");
        switch(sel)
        {
        case 1:
            return OK_ABORT;
            break;
        case 2:
            break;
        }
    }
    int rows=0;
    int draw=0;
    start = clock();
    while(draw <= length)
    {
        draw++;
        if(rows>=1&&custom==false)
        {
        cout << "*";
        }
        if(rows>=1&&custom==true)
        {
            cout << symbol;
        }

    if(draw == length)
    {
        if(rows>=1)
        {
        cout << endl;
        }
        rows++;
        draw = length-rows;
    }
    if(rows == length)
    {
        finish=clock();
        if(custom==false)
        {
        cout << "Es wurde eine "<<length-1<<" Sternchen lange Treppe gebaut."<<endl;
        }
        else if(custom==true)
        {
            cout << "Es wurde eine "<<length-1<<" "<<symbol<<" lange Treppe gebaut."<<endl;  
        }
        cout << "Es wurden "<< static_cast<double>( finish - start ) /CLOCKS_PER_SEC<< " Sekunden gebraucht.";
        return OK;
    }
    }
    return OK;
}
int main()
{
START:
    system("cls");
    int dreieck;
    char time[9];
    cout << "Wie gross soll die Treppe sein?: "; 
    cin >> dreieck;
    system("cls");
    cout << "Soll ein custom symbol verwendet werden?"<<endl<<"Ja:1 Nein:2"<<endl<<"Auswahl: ";
    int menu2;
    cin >> menu2;
    system("cls");
    bool customtrue;
    char symbolcustom;
    if(menu2>2)
    {
        cout << "Die Auswahl: " << menu2 << " ist nicht verfügbar";
        getchar();
        goto START;
    }
    switch(menu2)
    {
    case 1:
        customtrue = true;
        cout << "Symbol angeben(1Char max): ";
        cin >> symbolcustom;
        break;
    case 2:
        customtrue = false;
        break;
    }
    system("cls");
    createtriangle(dreieck,customtrue,symbolcustom);
    getchar();
    getchar();
    menumark:
    system("cls");
    cout << "Soll erneut eine Treppe gebaut werden?"<<endl<<"1: Ja 2: Nein"<<endl<<"Auswahl: ";
    int menu;
    cin >> menu;
    if(menu>2)
    {
        cout <<"Es gibt keine "<<menu<<" Auswahl.";
        getchar();
            goto menumark;
    }
    switch(menu)
    {
    case 1:
        goto START;
        break;
    case 2:
        exit(0);
        break;
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:40:37.930

使用您的源代码……

```
#include <iostream> //includes
using namespace std;
int makedreieck(int länge) // function for drawing a triangle
{
    int rows=0; //rows
    int draw=0; //drawed
    while(draw <= länge)
    {
        draw++;
        cout << "*";
        if(draw == länge-1)
        {
            rows++;
            draw = länge-rows;
            cout << endl;
        }
        if(draw == 1)
        {
            getchar();
            return 0;
        }
    }
}

int main(char argument)
{
    int dreieck;
    cin >> dreieck;
    makedreieck(dreieck);
    getchar();
    return 0;
} 
```

g++ 的前几个编译错误，...

```
[d:\开发\测试]
> *gnuc foo.cpp*
foo.cpp:3:1: 错误: 程序中的流浪 '\344'
foo.cpp:7:5: 错误: 程序中的流浪 '\344'
foo.cpp:11:9: 错误: 程序中的流浪 '\344'
foo.cpp:14:13: 错误: 程序中的流浪 '\344'
foo.cpp:3:23: 错误：在 'nge' 之前需要 ',' 或 '...'
foo.cpp：在函数“int makedreieck（int）”中：
foo.cpp:7:21: 错误: 'nge' 之前的预期')'
foo.cpp:7:21: 错误: 'nge' 未在此范围内声明
foo.cpp:7:24: 错误：预期 ';' 在 ')' 标记之前
foo.cpp:5:9：警告：未使用的变量“行”[-Wunused-variable]
foo.cpp:32:1: 错误：输入结束时预期为“}”
foo.cpp:32:1：警告：函数中没有返回语句返回非 void [-Wreturn-type]

[d:\开发\测试]
> _

```

是由于 Windows 的 MingW g++ 编译器不符合关于标识符中接受的字符集的 C++ 标准。报告的特定字符编号有点奇怪，因为源代码保存为 Windows ANSI Western，但 g++ 也会出错，源代码为 UTF-8。截至 2013 年，*很少有编译器*符合 wrt。源字符集。

唯一安全的字符是 A 到 Z、下划线和数字 0 到 9。

在实践中，这意味着：用软件开发的*通用语言***英语编写您的源代码**，然后它可以由其他人维护并由其他编译器编译。

 *修复后我得到以下编译错误：

```
[d:\开发\测试]
> *gnuc foo.cpp*
foo.cpp：在函数“int makedreieck（int）”中：
foo.cpp:19:21: 错误: 'getchar' 未在此范围内声明
foo.cpp：在全局范围内：
foo.cpp:25:5: 警告：'int main(char)' 的第一个参数应该是 'int' [-Wmain]
foo.cpp:25:5: 警告：'int main(char)' 只需要零个或两个参数 [-Wmain]
foo.cpp：在函数'int main(char)'中：
foo.cpp:30:13: 错误: 'getchar' 未在此范围内声明
foo.cpp：在函数“int makedreieck（int）”中：
foo.cpp:23:1：警告：控制到达非无效函数的结尾 [-Wreturn-type]

[d:\开发\测试]
> _

```

这里的错误是由于不包括`<stdio.h>`声明`getchar`函数的标头。

修复后不再报告错误。

但是，警告很严重：

```
[d:\开发\测试]
> *gnuc foo.cpp*
foo.cpp:27:5: 警告：'int main(char)' 的第一个参数应该是 'int' [-Wmain
foo.cpp:27:5: 警告：'int main(char)' 只需要零个或两个参数 [-Wmain]
foo.cpp：在函数“int makedreieck（int）”中：
foo.cpp:25:1：警告：控制到达非无效函数的结尾 [-Wreturn-type]

[d:\开发\测试]
> _

```

非标准`main`签名意味着即使包含所需的标头，这也是*无效的 C++*。

只需删除（未使用的）形式参数。

然后代码编译，只剩下一个非常严重的警告：

```
[d:\开发\测试]
> *gnuc foo.cpp*
foo.cpp：在函数“int makedreieck（int）”中：
foo.cpp:25:1：警告：控制到达非无效函数的结尾 [-Wreturn-type]

[d:\开发\测试]
> _

```

这绝对需要修复！

加起来：

*   将代码更改为不在标识符中使用非英文字母。那些民族角色还可以。C++ 标准，但很少有编译器支持它们。特别是 g++ 没有。

*   包括所有必需的标题。

*   对 .使用符合标准的签名`main`。

并记住修复丢失的`return`语句。

*然后*就可以开始调试了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:31:03.020

`draw`在您设置为 1的第一次迭代中，`(draw == 1)`为 true 并且函数返回。

尝试递减`länge`而不是`draw`when `draw == länge-1`，此时重置`draw`为 0，并在循环结束时退出 when `länge == 1`。调整口味。*

# gwt - GWT、SSL 和 Glassfish。现在有 SSL 吗？

> ID：14321240
> 
> 赞同：1
> 
> 时间：2013-01-14T15:19:59.913
> 
> 标签：gwt, ssl, glassfish

对不起，如果这将是一个太常见或简单的问题，但我不知道我应该在谷歌中输入什么来最终找到答案。

我有 GWT 应用程序，它现在正在 Glassfish 上运行。我可以在端口 8080 (http) 或 8181 (https) 上运行应用程序。问题是 - 我现在使用 SSL 吗？

默认的自签名证书对我来说已经足够了（我知道 keytool 和导入证书），我只需要澄清这个简单的问题。

我这里红了[GWT 和 SSL 不工作？](https://stackoverflow.com/questions/9266127/gwt-and-ssl-not-working)我需要在 web.xml 中设置安全约束

```
<security-constraint>
<web-resource-collection>
<web-resource-name>sslprotect</web-resource-name>
    <url-pattern>/*</url-pattern>
    <http-method>GET</http-method>
    <http-method>POST</http-method>
</web-resource-collection>
<user-data-constraint>
    <transport-guarantee>CONFIDENTIAL</transport-guarantee>
</user-data-constraint>
</security-constraint> 
```

那么这就够了吗？在评论中，Sam 写了一些关于“正确实现 SSL 的整个使用”的内容。

所以问题：这就够了吗？我的应用程序现在是否受到 SSL 保护？

老实说，我在大学里学过安全算法，但实施起来很失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:31:49.703

应该够了。
如果您可以在 URL 前面看到**https ，则一切正常。**您可以通过浏览 http URL 检查您是否受 SSL 保护，这应该会返回错误或将您重定向到 https URL。

# unity3d - Kinect 和 Unity，骨架自由

> ID：14321241
> 
> 赞同：0
> 
> 时间：2013-01-14T15:20:04.970
> 
> 标签：unity3d, kinect

我正在使用[这个](http://wiki.etc.cmu.edu/unity3d/index.php/Microsoft_Kinect_-_Microsoft_SDK)包在 Unity 中使用 kinect。但是骷髅一直冻结在一个点上，只有成员正常移动。我的意思是，我希望如果我做一个侧步，骨架也会做，但它保持在 xyz 0,0,0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-27T20:55:53.640

这不是问题是您在 kinect 传感器代码中的公共布尔值中设置的选项。您需要取消选中它，对不起，我忘记了名字，我正在工作，但很容易，只需注意您正在处理的场景。

现在我记得，它是偏移选项，您需要启用/禁用该选项才能让您在移动时移动。

# wicked-pdf - WickedPDF 在 osx 上未打补丁

> ID：14321254
> 
> 赞同：5
> 
> 时间：2013-01-14T15:21:10.230
> 
> 标签：wicked-pdf

我正在尝试在 mac osx 上将 html 转换为 pdf。我写这个命令，

```
$ wkhtmltopdf --header-center "google"  http://www.google.com google.pdf 
```

但我看到了错误，

```
The switch --header-center, is not support using unpatched qt, and will be ignored.Loading page (1/2)
Printing pages (2/2)                                               
Done 
```

问题是什么？我应该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-26T21:56:06.563

自己从[https://code.google.com/p/wkhtmltopdf/wiki/compilation](https://code.google.com/p/wkhtmltopdf/wiki/compilation)安装 Qt 。希望这会做到。

# magento - Magento：getAttributeText('manufacturer') 不起作用

> ID：14321256
> 
> 赞同：4
> 
> 时间：2013-01-14T15:21:17.533
> 
> 标签：magento, attributes

非常感谢您的帮助。我是 Magento 的新手，正在探索它的可能性。我有这段代码，它从类别及其属性中加载产品：

```
<?php
    $_productCollection=$this->getLoadedProductCollection();
    $_helper = $this->helper('catalog/output');
?>

<?php if(!$_productCollection->count()): ?>
<p class="note-msg"><?php echo $this->__('There are no products matching the selection.') ?></p>
<?php else: ?>
<div class="category-products">
     <?php // Grid Mode ?>
    <?php $_collectionSize = $_productCollection->count() ?>
    <?php $_columnCount = $this->getColumnCount(); ?>
        <?php $_iterator = 0; ?>
        <ul class="products-grid">    
        <?php $i=0; foreach ($_productCollection as $_product): ?>
            <li class="item">
                <a href="<?php echo $_product->getProductUrl() ?>" title="<?php echo $this->stripTags($this->getImageLabel($_product, 'small_image'), null, true) ?>" class="product-image"><img src="<?php echo $this->helper('catalog/image')->init($_product, 'small_image')->resize(252); ?>" width="252" height="252" alt="<?php echo $this->stripTags($this->getImageLabel($_product, 'small_image'), null, true) ?>" /></a>
                <h3 class="product-name"><a href="<?php echo $_product->getProductUrl() ?>" title="<?php echo $this->stripTags($_product->getName(), null, true) ?>"><?php echo $_helper->productAttribute($_product, $_product->getName(), 'name') ?></a></h3>
                <h4 class="product-name"><?php echo $_product->getAttributeText('manufacturer') ?></h4>                
                <?php echo $this->getPriceHtml($_product, true) ?>
             </li>  
        <?php endforeach ?>
        </ul>
        <script type="text/javascript">decorateGeneric($$('ul.products-grid'), ['odd','even','first','last'])</script>
</div>
<?php endif; ?> 
```

我的问题是：为什么“echo $_product->getAttributeText('manufacturer')”在这里不起作用？我已经尝试了无数具有不同代码的变体，但制造商参数却没有出现。你知道为什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T13:18:26.217

我已经尝试过 Adam Moss 的建议并且奏效了：

需要在管理员的属性编辑器中将“在产品列表中显示”设置为是。然后 echo $_product->getAttributeText('manufacturer') 工作没有任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-29T14:53:39.970

所以我使用@Shawn_Northrop 的建议来完成这项工作；

```
<?php 
echo $_product->getData('my_custom_attribute'); 
?> 
```

快乐的编码...

# mysql - MySQL 将记录分组到特定的时间块中

> ID：14321259
> 
> 赞同：0
> 
> 时间：2013-01-14T15:21:23.407
> 
> 标签：mysql

**你好，**

我试图找出一种将记录分组为某些块的有效方法。记录由计数和时间组成，请参见下面的示例。每分钟进行一次计数。

```
+----------+---------------+---------------+
| count_id | count_reading | count_time    |
+----------+---------------+---------------+
| 5847348  | 168           | 1358174236000 |
+----------+---------------+---------------+
| 5847347  | 342           | 1358174176000 |
+----------+---------------+---------------+
| 5847346  | 228           | 1358174116000 |
+----------+---------------+---------------+
| 5847345  | 240           | 1358174056000 |
+----------+---------------+---------------+
| 5847344  | 12            | 1358173996000 |
+----------+---------------+---------------+
| 5847343  | 0             | 1358173936000 |
+----------+---------------+---------------+
| 5847342  | 48            | 1358173876000 |
+----------+---------------+---------------+
| 5847341  | 480           | 1358173816000 |
+----------+---------------+---------------+
| 5847340  | 473           | 1358173756000 |
+----------+---------------+---------------+
| 5847339  | 380           | 1358173696000 |
+----------+---------------+---------------+ 
```

我想要实现的是各个班次的计数总和，我有两种情况我被困在......

*   从 0700-1900 和 1900-0700 运行的 12 小时班次的总和。
*   运行 0700-1400、1400-2200 和 2200-0700 的班次的总和。

结果看起来像：

```
+---------------+--------------------------------------------+
| count_reading | count_time                                 |
+---------------+--------------------------------------------+
| 10000         | Between 0700 and now starting on the 13th  |
+---------------+--------------------------------------------+
| 20000         | Between 1900 and 0700 starting on the 12th |
+---------------+--------------------------------------------+
| 50000         | Between 0700 and 1900 starting on the 12th |
+---------------+--------------------------------------------+
| 10000         | Between 1900 and 0700 starting on the 11th |
+---------------+--------------------------------------------+ 
```

我正在处理两个查询，这些查询将根据场景解决上述问题。我已经四处寻找帮助，但运气不佳，如果有人能够帮助我，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:30:15.367

`group by`可以采用任意子句和派生值，例如（在伪代码中）：

```
SELECT SUM(count_reading), TIME(count_time) BETWEEN 7 and 19 AS shift
GROUP BY shift 
```

您最终会得到两组 - `shift = 1`7-19 和`shift = 0`19-7`

类似地，对于 3 向移位，还有一点逻辑：

```
SELECT sum(count_reading),
    CASE WHEN TIME(count_time) BETWEEN 7 AND 14 THEN 1 ELSE
         WHEN TIME(count_time) BETWEEN 14 and 22 THEN 2
         ELSE 3 END AS shift
GROUP BY shift 
```

实际的逻辑/sql 语法应该非常简单。

# android - onConfigurationChanged后如何获取GridView的宽高

> ID：14321260
> 
> 赞同：2
> 
> 时间：2013-01-14T15:21:37.877
> 
> 标签：android, gridview, configuration

我想在 onConfigurationChanged 之后获取 GridView 的宽度和高度，所以当我将设备从横向摆动到纵向时，我想获取网格的新宽度和高度值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-02T00:13:45.430

请参阅[如何在 onConfigurationChanged 中获取根布局的新宽度/高度？](https://stackoverflow.com/questions/2524683/how-to-get-new-width-height-of-root-layout-in-onconfigurationchanged)

**视图不会在 onResume() 中重绘**- 绘制视图不是此生命周期的一部分（[http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle](http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle)）。`android.view.ViewTreeObserver.OnGlobalLayoutListener`当视图被重新绘制时， 您需要使用通知。

但是请注意，我观察到这种方法并不总是按预期工作。在配置更改（轮换）之后，如果我不删除侦听器，该方法会触发 3 次 - 前 2 次具有旧值，第 3 次具有新值。如果我在收到通知后立即删除侦听器，我仍然会得到旧值。（但如果你不移除监听器，你可能需要实施一些技巧来防止代码再次运行。）

# extjs - 在 ExtJS 中获取活动元素？

> ID：14321262
> 
> 赞同：10
> 
> 时间：2013-01-14T15:21:46.017
> 
> 标签：extjs, extjs4

我试图获取在给定时间处于活动/集中状态的组件。我已经知道您可以使用跨浏览器 javascript 函数获得 HTMLElement `document.activeElement`。

如何将此元素转换为 Ext.Component 或 ExtJs 是否具有类似功能？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-14T15:36:59.117

我自己想通了:)

`var activeComponent = Ext.get(Ext.Element.getActiveElement());`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:45:06.807

看看这个：[Ext.FocusManager](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.FocusManager)。我从来没有使用过这个功能，你能告诉我它是否符合你的需要吗？

# c++ - 我可以实现其签名仅基于类型 ID 不同的模板化函数吗？

> ID：14321263
> 
> 赞同：6
> 
> 时间：2013-01-14T15:21:51.837
> 
> 标签：c++, class, function, c++11, enums

以下是一些枚举类：

```
enum class Race : char {AINU, ELF, DWARF, MAN, EAGLE, HOBBIT, ENT, ORC, WIZARD};
enum class Color: char {RED, ORANGE, YELLOW, GREEN, BLUE, PURPLE};
enum class Direction: char{UP, DOWN, LEFT, RIGHT}; 
```

* * *

我想为每个实现一个**enum_to_string 函数**和一个**string_to_enum 函数**。
将枚举转换为字符串没有问题，因为我可以重载相同的函数名。

```
std::string to_string(Race const& enum_value);
std::string to_string(Color const& enum_value);
std::string to_string(Direction const& enum_value); 
```

但是，在转换为枚举时不能以相同的方式重载，因为只有返回类型会不同。（我也不想，因为不同的枚举可能用相同的字符串表示。）

* * *

以下方法之一可以将字符串转换为枚举吗？

```
Race race = to_enum<Race>("elf");
Color color = to_enum<Color>("green");

std::string blah{"up"};
Direction dir{to_enum<Direction>(blah)}; 
```

或者可能：

```
Race race = to_enum(Race,"elf");
Color color = to_enum(Color,"green");

std::string blah{"up"};
Direction dir{to_enum(Direction,blah)}; 
```

C++ 可以支持其中一种或两种行为吗？

* * *

我试图避免像这样的不同函数名称：

```
Race to_race(std::string const& str);
Color to_color(std::string const& str);
Direction to_direction(std::string const& str); 
```

* * *

这是我能想到的最接近的东西，

```
template <typename T>struct to_enum{};
template <>
struct to_enum<Color>{

    static Color convert(std::string const& str){
        //match the string with a color enum, and return that color enum
        //(or like a default color enum if the string is garbage or something)
    }
}; 
```

然后你这样称呼它：

```
Color color = to_enum<Color>::convert("red"); 
```

我们可以摆脱皈依者吗？或者可能实施这个？

```
Color color = to_enum(Color,"red"); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-14T15:24:16.507

使用功能模板和专业化。这些是我认为功能专业化真正有帮助的*罕见*情况。

```
template<typename TEnum>
TEnum enum_cast(std::string const & s); 
```

然后为每个枚举类型专门化它。我更改了名称，因此您可以像 cast 一样阅读它：

```
Color color = enum_cast<Color>("blue"); 
```

或者`parse`也是一个好名字。选择你认为好的任何东西。我个人会选择`parse`或`enum_cast`。

现在`to_string`，您可以定义重载（您已经拥有）：

```
std::string to_string(Color c);
std::string to_string(Race r);
std::string to_string(Direction d); 
```

不要对`to_string`. 一般来说，重载确实很好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-14T15:24:47.603

> 然后你这样称呼它：
> 
> ```
> Color color = to_enum<Color>::convert("red"); 
> ```
> 
> 我们可以摆脱皈依者吗？

确定的事！简单地封装调用：

```
template <typename Enum>
Enum to_enum(std::string const& from) {
    return to_enum_helper<Enum>::convert(from);
} 
```

`to_enum_helper`您之前定义的结构在哪里。（编辑：或者您直接将功能专业化，如 Nawaz 的回答所示。）

**或者**，如果那是您的一杯茶，您可以使用重载而不是专业化：

```
Race to_enum_helper(std::string const& from, Race) {
    // Implement for enum class Race
}

Color to_enum_helper(std::string const& from, Color) {
    // Implement for enum class Color
}

template <typename Enum>
Enum to_enum(std::string const& from) {
    return to_enum_helper(from, Enum());
} 
```

这里，第二个参数 to`to_enum_helper`只是用来区分不同的重载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T15:55:55.157

> 但是，在转换为枚举时不能以相同的方式重载，因为只有返回类型会不同。

您可以重载转换运算符来编写仅返回类型不同的重载函数：

```
#include <string>
#include <iostream>

enum Race {};
enum Color {};

struct to_one_of_them {
    operator Race  () const { std::cout << "to Race()\n"; return Race(); }
    operator Color () const { std::cout << "to Color()\n"; return Color(); }

    to_one_of_them() = delete;

private:
    std::string str;
    to_one_of_them(std::string const &str) : str(str) {}

    friend to_one_of_them to_enum(std::string const&);
};

to_one_of_them to_enum(std::string const &str) {
    return {str};
}

int main () {
    Race  r = to_enum("meh");
    Color c = to_enum("meh");
} 
```

然而，这种技术实际上没有被使用，因此不是 C++ 习惯用法，因此可能不值得学习。

# erlang - Erlang中列表理解中的多个过滤器

> ID：14321265
> 
> 赞同：3
> 
> 时间：2013-01-14T15:22:01.727
> 
> 标签：erlang

假设我有一个包含天气的列表：

```
1> Weather = [{toronto, rain}, {montreal, storms}, {london, fog}, 
    {paris, sun}, {boston, fog}, {vancouver, snow}]. 
```

为了得到有雾的地方，我可以这样做：

```
2> FoggyPlaces = [X || {X, fog} <- Weather].
[london,boston] 
```

现在我想检索既有雾又有雪的地方。我试过这个，但它只检索下雪的地方，

```
3> FoggyAndSnowyPlaces = [X || {X, fog} <- Weather, {X,snow} <- Weather].
[vancouver,vancouver] 
```

我期待的地方`[london,boston,vancouver]`。

如何包含多个过滤器？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-14T15:37:55.597

```
FoggyAndSnowyPlaces = [X || {X, Y} <- Weather, (Y == fog) or (Y == snow)]. 
```

You are confusing *generators* (`Pattern <- List`) and *filters* (boolean conditions). Multiple generators work like nested loops in other languages, so in your `3>` you get `vancouver` twice because the first generator produces two values.

# java - listview XML id 问题

> ID：14321266
> 
> 赞同：0
> 
> 时间：2013-01-14T15:22:01.767
> 
> 标签：java, android

我刚刚开始了一个新类，并且像我对其他几个没有问题的类所做的那样布置了 XML，但是我现在在这个类中遇到了一个非常奇怪的资源错误。

我有一个名为“edit”的 XML 布局，其中包含一个编辑文本、一个按钮和一个列表视图。出于某种原因，当我在课堂上输入我的列表视图引用时，我收到“无法解决”的错误，我真的不明白这一点，因为它在 XML 中明确定义。

目前，id 是这样引用的：

```
android:id="@android:id/listEdit" 
```

此 ID 引用似乎使列表视图在布局中一起消失，给我以下错误：

```
NOTE: This project contains resource errors, so aapt did not succeed, which can cause  rendering failures. Fix resource problems first.

Couldn't resolve resource @android:id/listEdit 
```

这是我的“编辑”XML：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<TextView
    android:id="@+id/txteditSearch"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Type A Name To Edit;"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<EditText
    android:id="@+id/inputNameEdit"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" >

    <requestFocus />
</EditText>

<Button
    android:id="@+id/btnSearchEdit"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="Search" />

<ListView
    android:id="@android:id/listEdit"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >
</ListView>

<ListView
    android:id="@+id/listEdit"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >
</ListView>

</LinearLayout> 
```

还有我的编辑类：

```
package com.example.flybase2;

import android.app.ListActivity;
import android.database.Cursor;
import android.os.Bundle;
import android.support.v4.widget.SimpleCursorAdapter;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ListView;

public class edit extends ListActivity implements OnClickListener {

Button editSearch;
EditText nameEdit;
ListView editList;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.edit);

            // ERROR: Error on the 'listEdit'
    editList = (ListView)findViewById(android.R.id.listEdit);

    DBHandler DBedit = new DBHandler(this, null, null);

    DBedit.open();
    Cursor cursor = DBedit.getData();

    startManagingCursor(cursor);

    @SuppressWarnings("static-access")
    String [] from = new String [] {DBedit.KEY_NAME, DBedit.KEY_TEL,  DBedit.KEY_EMAIL, DBedit.KEY_COMMENTS};
    int [] to = new int [] {R.id.txtNameSet, R.id.txtContactSet,  R.id.txtEmailSet, R.id.txtCommentSet};

    @SuppressWarnings("deprecation")

    SimpleCursorAdapter cursorAdapter = new SimpleCursorAdapter(this,    R.layout.searchagain, cursor, from, to);
    editList.setAdapter(cursorAdapter);

    editSearch = (Button) findViewById(R.id.btnSearchName); 
    nameEdit = (EditText) findViewById(R.id.inputName); 

    editSearch.setOnClickListener(this);

}

@Override
public void onClick(View clickedSearchButton) {

String searchedName = nameEdit.getText().toString();

editList = (ListView)findViewById(android.R.id.list);

DBHandler DBsearchRef = new DBHandler(this, null, null);

DBHandler search = new DBHandler(this, null, null);

search.open();
Cursor cursor = search.searchOnName(searchedName);

startManagingCursor(cursor);

@SuppressWarnings("static-access")
String [] from = new String [] {DBsearchRef.KEY_NAME, DBsearchRef.KEY_TEL,  DBsearchRef.KEY_EMAIL, DBsearchRef.KEY_COMMENTS};
int [] to = new int [] {R.id.txtEditNameSet, R.id.txtEditNumSet,    R.id.txtEditEmailSet, R.id.txtEditCommentsSet};

@SuppressWarnings("deprecation")

SimpleCursorAdapter cursorAdapter = new SimpleCursorAdapter(this, R.layout.setedit, cursor, from, to);
editList.setAdapter(cursorAdapter);

}

} 
```

谁能明白为什么会这样，因为它让我发疯！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:26:25.763

当你使用时，`ListActivity`你应该使用`android:id="@android:id/list"`as id for `ListView`。

然后您可以参考`ListView`using`getListView()`方法，这样您就不必自己保持参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:26:13.283

你可以在下面使用这个吗

```
 android:id="@+id/listEdit" 
```

而不是这个

```
android:id="@android:id/listEdit" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T15:27:39.447

该消息正是它的意思，没有id：

```
 android:id="@android:id/listEdit" 
```

在android框架上，您要使用的是：

```
android:id="@android:id/list" 
```

# php - 当另一个 htaccess 位于子文件夹中时，URL 重写不起作用

> ID：14321269
> 
> 赞同：2
> 
> 时间：2013-01-14T15:22:15.627
> 
> 标签：php, .htaccess

我的站点根目录中有一个 .htaccess 文件。在文件中，我有一个代码可以重定向所有流量以添加“www”。到网址的开头：

```
Options +FollowSymLinks 
RewriteEngine on 
RewriteCond %{HTTP_HOST} ^website.com [NC] 
RewriteRule ^(.*)$ http://www.website.com/$1 [L,R=301] 
```

这适用于 95% 的网站。但是，我有一个子目录 website.com/playdate，在该文件夹中有另一个 .htaccess 文件。在这个 .htaccess 文件中是以下代码，用于将 URL 重定向到更简洁的内容：

```
Options +FollowSymLinks
RewriteEngine on
RewriteRule ^page/([0-9]+)/ index.php?page=$1

Options +FollowSymLinks
RewriteEngine on
RewriteRule ^([a-zA-Z0-9_-]+)/ view.php?url_slug=$1 
```

这段代码似乎覆盖了 www 重定向。我试图添加初始代码，

```
Options +FollowSymLinks 
RewriteEngine on 
RewriteCond %{HTTP_HOST} ^website.com [NC] 
RewriteRule ^(.*)$ http://www.website.com/$1 [L,R=301] 
```

到辅助 .htaccess 的顶部，但这不起作用。

如何让子目录继续转发到“www”。网站的版本，同时还保留此子文件夹的辅助 .htaccess 规则？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T16:15:49.450

例如`/playdate`，当发出请求时，首先发生的是 URL 到文件的映射，然后 apache 检查该文件映射（在本例中映射到目录）是否包含 htaccess 文件。如果*不是*，那么它会检查父目录中的 htaccess 文件。如果*是*，那么它只是使用该目录中的 htaccess 文件。

因此，当对 发出请求时`/playdate`，它在该目录中有一个 htaccess 文件，因此 apache 不会费心在任何父目录中查找。**只有这一个 htaccess 文件被应用**，位于父目录中的任何文件都将被忽略。

**如果您使用的是 apache 2.2**，那么您只需复制**www**重定向规则，但您需要调整它们，因为您不再位于文档根目录中。将这些规则添加到您的 htaccess 文件的顶部（或至少在您已经拥有的任何规则之上）：

```
RewriteEngine on 
RewriteCond %{HTTP_HOST} ^website.com [NC] 
RewriteRule ^(.*)$ http://www.website.com/playdate/$1 [L,R=301] 
```

**如果您使用的是 apache 2.4**，则可以将特定选项应用于 playdate 目录中的 htaccess 文件：

```
RewriteOptions InheritBefore 
```

这使得父作用域中的任何规则都在子作用域中的任何规则*之前*被继承。这很重要，因为您需要确保在应用任何路由规则**之前出现****www**重定向规则，否则 URI 会被破坏。Apache 2.2 有一个类似的选项，但是这些选项放在子范围内的任何规则**之后。****`Inherit`**

 ***** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-03T22:04:35.303

我认为您的问题是您在重写完整域名时使用的 L 标志。

```
[L,R=301] 
```

L 标志表示“最后一个”，如“这是我希望服务器为此 URI 请求处理的最后一个重写指令”。如果用户代理请求“ [http://website.com/playdate](http://website.com/playdate) ”，那么重写条件将触发该行

```
RewriteRule ^(.*)$ http://www.website.com/$1 [L,R=301] 
```

服务器会将请求重写为[http://www.website.com/playdate](http://www.website.com/playdate)并*停止处理*该 URI 请求的重写规则，因为服务器到达 L 标志。

至少这是我的猜测。****

# php - 试图将图像上传到文件夹

> ID：14321270
> 
> 赞同：0
> 
> 时间：2013-01-14T15:22:16.780
> 
> 标签：php

嗨，我有一个上传脚本，可以将图像上传到文件，但我无法保存在与 php 脚本不在同一文件夹中的文件中。

```
Warning: move_uploaded_file() [function.move-uploaded-file]: Unable to move  
'/tmp/phpkiIfQ' to 'http://--Webaddress--/Logoimages/bug4.png' in 
/home/--host--/public_html/uploaded/upload3.php on line 48 
```

删除了一些细节并替换为“--relevant--”

这是我在第 48 行的代码

```
"http://--WebAddress--/Logoimages/" . $_FILES["file"]["name"]); 
```

任何帮助都会非常感谢，Mikey

感谢所有回答的人

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:25:02.360

您实际上是在使用 HTTP URL 作为将文件移动到的位置吗？那可能就是你出错的地方。尝试使用本地文件路径。如果您需要在树上上下移动，伪目录 .. 将很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:25:05.280

您不能将文件移动到 url - 您需要将其移动到磁盘上映射到该 Url 的位置 - 例如`/srv/www/htdocs/Logoimages/somefile.png`（确切的路径将取决于您正在运行的 linux 的风格以及您的站点的设置方式)

此外，请确保您的网站用户有权写入该文件夹

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T15:31:06.753

改成

```
"../Logoimages/" . $_FILES["file"]["name"]); 
```

# javascript - 在谷歌地图标记上显示弹出气球

> ID：14321271
> 
> 赞同：4
> 
> 时间：2013-01-14T15:22:19.683
> 
> 标签：javascript, php, google-maps

我有以下代码显示客户邮政编码，并用标记在地图上标记它：

```
<?php if($_GET['postcode']){ ?>

//alert(<?php echo $_GET['postcode'];?>)

<?php }?>

      function initialize() {
        var mapOptions = {
          zoom: 4,
          center: new google.maps.LatLng("<?php echo $_GET['postcode'];?>"),
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        var map = new google.maps.Map(document.getElementById('map_canvas'),mapOptions);
        map.setTilt(45);

        var addressArray = new Array("<?php echo $_GET['postcode'];?>");
        var geocoder = new google.maps.Geocoder();

        var markerBounds = new google.maps.LatLngBounds();

        for (var i = 0; i < addressArray.length; i++) {
        geocoder.geocode( { 'address': addressArray[i]}, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {

        var marker = new google.maps.Marker({
        map: map,
        position: results[0].geometry.location
        });
        markerBounds.extend(results[0].geometry.location);
        map.fitBounds(markerBounds);

        } else {
        alert("Geocode was not successful for the following reason: " + status);
        }
        });
        }
      }

      function loadScript() {
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = 'https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&' +
            'callback=initialize';
        document.body.appendChild(script);
      }

      window.onload = loadScript;
    </script> 
```

单击标记时我需要的是一个弹出气泡，客户订购信息。我需要在上面添加什么来显示弹出气泡？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-09T23:53:09.293

查看 InfoWindow 覆盖： [https ://developers.google.com/maps/documentation/javascript/overlays#InfoWindows](https://developers.google.com/maps/documentation/javascript/overlays#InfoWindows)

几乎可以满足您的需求，也就是说，它会显示一个带有一些内容的气球。

您需要添加到代码中的内容如下：

**在脚本的开头作为全局变量：**

```
var infowindow; 
```

**在地图 api 初始化时：**

```
function initialize() {
  infowindow = new google.maps.InfoWindow(); 
```

**创建标记后：**

```
var marker = new google.maps.Marker({
    map: map,
    position: results[0].geometry.location
});

google.maps.event.addListener(marker, 'click', function() {
   infowindow.setContent("<p>Some HTML content</p>");
   infowindow.open(map,marker);
}); 
```

希望这可以帮助你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:26:55.700

你需要在这里阅读...

[https://developers.google.com/maps/documentation/javascript/overlays](https://developers.google.com/maps/documentation/javascript/overlays)

我相信基本原则是

```
var marker = new google.maps.Marker({
    position: myLatlng,
    title:"Hello World!"
}); 
```

# ember.js - Emberjs 新路由和查询字符串或自定义路由匹配器

> ID：14321273
> 
> 赞同：2
> 
> 时间：2013-01-14T15:22:29.687
> 
> 标签：ember.js

我正在尝试将我的应用程序迁移到新的 emberjs 路由 API。

对于旧路由器，我有一些解决方法可以为由 ID 保存的对象和由一组参数描述的新对象提供类似的 URI。这样做是为了能够在用户之间交换指向对象的链接，而无需永久保存它。这是来自我的应用程序的两条简化的有效路线：

```
/objects/12                   // fetch object by id (/objects/:object_id)
/objects/<serialized params>  // build new object from params (/objects/:params) 
```

这两条路由都类似于路由器，因为它们都有动态部分，静态部分是相等的。所以我写了custom`RouteMatcher`来接送正确的路线。缺乏查询字符串解析迫使我将这个破解作为快速和半合法的解决方案，在 github 上也有关于这个功能的[古老票证。](https://github.com/emberjs/ember.js/issues/1487 "三个月大:(")

随着新的路由器匹配已被提取到单独的包（路由识别器），所以我无法做到这一点（否则它将充满黑客和注入）。

如我所见，我必须从以下选项中进行选择：

*   完全重写我的 URI 并分离所有相交的路由
*   重写 URI，但尝试为新的 Ember.Router 实现查询字符串解析器
*   将所有逻辑放入一条路线并仅重新实现序列化/反序列化方法（有些脏东西）

第二种解决方案似乎更干净。

什么是最好的不复杂的决定？我应该尝试另一种方式吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T18:44:50.690

当前路由器不支持查询字符串参数。

我们正在[https://github.com/emberjs/ember.js/issues/1773](https://github.com/emberjs/ember.js/issues/1773)跟踪这个错误。您可能想关注它。

同时，您最好的选择可能是使用动态段并手动序列化（使用`serialize`钩子）和反序列化（使用`model`钩子）。

# e-commerce - WooCommerce SagePay 直接支付网关 - 结帐时出错

> ID：14321275
> 
> 赞同：0
> 
> 时间：2013-01-14T15:22:33.763
> 
> 标签：e-commerce, woocommerce, opayo

当以管理员身份登录时，结帐失败并且不输出任何错误，在注销或以客户身份登录时工作正常。

将 WordPress 置于调试模式时，我收到以下 PHP 通知：

> 注意：未定义变量：第 155 行 /wp-content/plugins/sagepay-direct-for-woocommerce-payment-gateway/ds-sagepay-direct.php 中的卡
> 
> 注意：未定义的属性：DS_Sagepay_Direct::$validated 在 /wp-content/plugins/sagepay-direct-for-woocommerce-payment-gateway/ds-sagepay-direct.php 行 476

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T08:38:27.270

由于在使用支付页面时未设置 DS_Sagepay_Direct::$validated 变量，结账将失败。这是 WooCommerce 1.6 的一个错误，已在 2.0 中修复。

# servlets - Servlet 在数据库中存储和检索数据

> ID：14321277
> 
> 赞同：0
> 
> 时间：2013-01-14T15:22:34.140
> 
> 标签：servlets

也许有人可以举一个 servlet 在数据库中存储和检索数据的例子？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:19:14.763

不是最好的代码，但它会让你开始：

```
 public class MyServletGetsDataFromDb extends HttpServlet {
      public static final JDBC_URL = "whtever:my://database/is?connection=parameters";
      public void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {
        Connection conn = null;
        try {
          conn = DriverManager.getConnection(JDBC_URL);
          ResultSet results = conn.createStatement("SELECT id from table").executeQuery();
          response.setContentType("text/plain");
          while (results.next()) {
              response.getWriter().write(results.getString(1)+"\n");
          }
        } catch (SQLException e) {
          response.setStatusCode(500);
          throw new ServletException(e.getMessage());
        } finally {
          try {
            if (conn != null) conn.close();
          } catch (SQLException e) {
          response.setStatusCode(500);
          throw new ServletException(e.getMessage());
          }
        }
      } 
   } 
```

前进并增强它。希望有帮助。

# git - 如果我要推送到特定仓库中的 master，如何设置 git 来警告我？

> ID：14321281
> 
> 赞同：0
> 
> 时间：2013-01-14T15:23:02.107
> 
> 标签：git, version-control

如果我尝试直接推送到远程主机，我想知道是否有办法获得警告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:26:31.617

Git pre-push hooks 是您正在寻找的

您可以根据需要使用客户端挂钩或服务器端挂钩。

所有关于钩子： http: [//git-scm.com/book/en/Customizing-Git-Git-Hooks](http://git-scm.com/book/en/Customizing-Git-Git-Hooks)

# android - Android Runtime.getRuntime().exec 和 rsync

> ID：14321282
> 
> 赞同：3
> 
> 时间：2013-01-14T15:23:02.167
> 
> 标签：android, exec, rsync, su, root

我正在尝试在我的设备上运行 rsync。我有二进制文件，`/system/xbin/rsync`我正在尝试使用`Runtime.getRuntime().exec`. 我是 Android 编程的新手，所以如果我必须使用超级用户权限，我还不知道。

我的代码是：

```
try {
    Process process = Runtime.getRuntime().exec(
            "/system/xbin/rsync -avzru /sdcard/Tinybox/ " +
            "mattiazeni@192.168.1.6::88124bb378ac994088e704d553de6f19");
    System.out.print("RSYNC LAUNCHED\n");

    // Reads stdout.
    // NOTE: You can write to stdin of the command using
    // process.getOutputStream().
    BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
    int read;
    char[] buffer = new char[4096];
    StringBuffer output = new StringBuffer();
    while ((read = reader.read(buffer)) > 0) {
        output.append(buffer, 0, read);
    }
    reader.close();

    // Waits for the command to finish.
    process.waitFor();
    System.out.print(output);
    System.out.print("RSYNC FINISHED\n");

    // return output.toString();
} catch (IOException e) {
    throw new RuntimeException(e);
} catch (InterruptedException e) {
    throw new RuntimeException(e);
} 
```

它不起作用，它只是打印“RSYNC STARTED”“RSYNC FINISHED”。

但是如果我运行：

```
Process process = Runtime.getRuntime().exec("/system/xbin/rsync --help"); 
```

它工作正常，我可以看到 LogCat 窗口的输出。

所以我想我必须使用超级用户权限，所以我修改了我的代码如下：

```
try {
    System.out.print("RSYNC STARTED\n");
    Process process = Runtime.getRuntime().exec("/system/xbin/su");
    DataOutputStream os = new DataOutputStream(process.getOutputStream());
    DataInputStream is = new DataInputStream(process.getInputStream());
    os.writeBytes("/system/xbin/rsync --help");
    String output = new String();
    String temp = new String();
    output = is.readLine();

    System.out.print(output);
    os.flush();
    System.out.print("RSYNC FINISHED\n");
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} finally {
} 
```

但是当我运行代码时，应用程序会冻结而没有错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T06:18:24.960

好的，我使用的代码版本略有不同：

```
try {
    System.out.print("RSYNC STARTED\n");
    process = Runtime.getRuntime().exec("/system/xbin/su -c sh");
    OutputStream os = process.getOutputStream();
    Log.d("RSYNC","/system/xbin/rsync" + " -avzru /sdcard/download/ mattiazeni@192.168.1.6::TinyBox &");
    writeLine( os, "/system/xbin/rsync" + " -avzru /sdcard/download/ mattiazeni@192.168.1.6::TinyBox &");

    os.flush();
    System.out.print("RSYNC FINISHED\n");
    }
catch ( IOException e ) {
   e.printStackTrace();
} 
```

我知道问题出在`su`命令上。如果我使用它启动 rsync`su`并且没有错误消息，如我之前所说，如果我删除`su`命令并启动：

```
try {
    System.out.print("RSYNC STARTED\n");
    process = Runtime.getRuntime().exec("sh");
    OutputStream os = process.getOutputStream();
    Log.d("RSYNC","/system/xbin/rsync" + " -avzru /sdcard/download/ mattiazeni@192.168.1.6::TinyBox &");
    writeLine( os, "/system/xbin/rsync" + " -avzru /sdcard/download/ mattiazeni@192.168.1.6::TinyBox &");

    os.flush();
    System.out.print("RSYNC FINISHED\n");
    }
catch ( IOException e ) {
   e.printStackTrace();
} 
```

它工作正常，但当然我从 rsync 得到一个错误，因为我没有权限并且同步不起作用。我该如何解决我的问题？？

# wordpress - 在 Wordpress 内容中的第一个字符串之前搜索并添加

> ID：14321286
> 
> 赞同：0
> 
> 时间：2013-01-14T15:23:09.847
> 
> 标签：wordpress, ads, autoblogged

我有自动**wordpress**博客。我想在内容 Ex 内容中添加一些广告：

```
Description content
...

http://filehost1.com/file.part1.rar
http://filehost1.com/file.part2.rar
http://filehost1.com/file.part3.rar

http://filehost2.com/file.part1.rar
http://filehost2.com/file.part2.rar
http://filehost2.com/file.part3.rar 
```

我想在每个文件主机的顶部插入广告。看起来像这样：

```
Description content
...

**Ads 1**
http://filehost1.com/file.part1.rar
http://filehost1.com/file.part2.rar
http://filehost1.com/file.part3.rar

**Ads 2**
http://filehost2.com/file.part1.rar
http://filehost2.com/file.part2.rar
http://filehost2.com/file.part3.rar 
```

请帮忙。非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:48:14.823

这会将您的广告代码添加到内容的末尾。您可以随心所欲地操作 $content，无论您在下面的函数中返回什么，都将是您的内容。把它放在functions.php中。

```
add_filter( 'the_content', function($content) {
    return $content . 'Advertisement code';
}); 
```

# c# - NetworkInformation NetworkStatusChanged 事件触发了两次

> ID：14321289
> 
> 赞同：2
> 
> 时间：2013-01-14T15:23:16.577
> 
> 标签：c#, windows-8

我正在使用我认为推荐的方法在我的 WinRT 应用程序中监听网络变化。

我使用此代码订阅了该事件。（我已经在很多地方尝试过，但目前我在 page`OnNavigatedTo`方法中有它）。

```
NetworkInformation.NetworkStatusChanged += NetworkInformation_NetworkStatusChanged; 
```

然后在`OnNvaigatedFrom`我删除它的方法中：

```
NetworkInformation.NetworkStatusChanged -= NetworkInformation_NetworkStatusChanged; 
```

当我移除网络电缆时，`NetworkInformation_NetworkStatusChanged`事件被正确触发。但是，当我重新插入（重新联机）时，该事件被触发两次，并且我的数据（离线时本地存储）被上传到服务器两次。

有没有人遇到过这个/知道它为什么会发生 - 它让我发疯。

非常感谢克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:03:32.583

我记得这是一个问题。好像还是这样。

[http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/520ea5e2-cc17-486d-815e-528ca041d77f/](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/520ea5e2-cc17-486d-815e-528ca041d77f/)

要解决您的问题，请使用标记跟踪网络可用性，并且仅在之前的网络状态不可用时才更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-16T23:50:11.920

在我们的测试中，我们发现每个可用适配器都会收到一次事件。我们有 5 个适配器，因此每次我们重新插入电缆时，我们似乎都会收到与活动（启用）适配器一样多的事件。我们通过禁用其中一个适配器来测试这一点，并且事件的数量正好减少了一个，反之亦然。不过，似乎我们只收到一个断开连接的事件。

您的事件多次触发的另一个原因是您的网络确实断开并重新连接。

在任何情况下，您都必须防御性地编写代码来处理实现的现实以及与网络连接相关的一般不可靠性。

# python - Django admin - 有没有办法在一个表单字段中包含所有对象类型？

> ID：14321291
> 
> 赞同：1
> 
> 时间：2013-01-14T15:23:22.573
> 
> 标签：python, django, django-cms

标题可能不是很清楚。我将尝试举例说明。

在我的项目中，我有 6 个不同的“内容”应用程序。我们有几个插件可以放在页面中（django-cms），可以链接到这 6 个应用程序中的任何一个。

但是现在，我这样做的唯一方法是在每个插件中为每个应用程序添加一个外键。

有没有更好的办法 ？或者是否有一个表单域能够链接多个不同的应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:25:25.390

我*认为*您需要的是[表单和管理中的通用关系](https://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#generic-relations-in-forms-and-admin)-这有帮助吗？

# ruby-on-rails - 如何在 rails 中将 /users/1 设为 /users/john-doe ？

> ID：14321297
> 
> 赞同：0
> 
> 时间：2013-01-14T15:23:35.127
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在使用简单的脚手架来创建用户

```
rails g scaffold user fname:string lname:string 
```

当我创建用户时，它会将其创建为 /users/1、/users/2 等，我想知道如何将用户设为 users/fname-lname ？

有rails gem可以做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:28:06.857

您正在寻找的是创建一个`slug`.

[FriendlyID](https://github.com/norman/friendly_id)就是这样做的宝石。还有一个关于如何使用它的 Railscast 插曲！[Railscast 链接](http://railscasts.com/episodes/314-pretty-urls-with-friendlyid)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:41:53.853

您还可以在您的**routes.rb**文件中定义如下内容：

```
match "users/:fname-:lname/:action", :controller => "users" 
```

但是当您想要访问您的资源时，您必须传递 fname 和 lname 参数。

# android - 如何使用 Intent 打开显示“组”选项卡的联系人？

> ID：14321300
> 
> 赞同：2
> 
> 时间：2013-01-14T15:23:57.120
> 
> 标签：android, android-intent, uri, android-contacts, contactgroups

我想从我自己的 Android 应用程序中打开联系人。

如果我做 ：

```
Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setData(ContactsContract.Contacts.CONTENT_URI); 
```

我可以打开联系人，显示“*人员*”选项卡。我怎样才能实现类似的目标，但改为显示“*组*”选项卡？更改为`ContactsContract.Contacts.CONTENT_GROUP_URI`或`ContactsContract.Groups.CONTENT_URI`不起作用。单击后，它将在控制台中弹出“无法完成操作”和以下消息：

```
01-14 17:21:36.525: W/ContentResolver(26851): Failed to get type for:
  content://com.android.contacts/contacts/group/0 (
    URI: content://com.android.contacts/contacts/group/0,
    calling user: android.uid.system:1000,
    calling package is one of: [
      com.motorola.usbcamera,
      com.motorola.android.deepsleepservice,
      com.android.keychain,
      com.motorola.blur.setup,
      com.android.settings,
      com.motorola.atcmd,
      com.android.portal,
      com.android.vpndialogs,
      com.motorola.meter.omap,
      com.motorola.dockcomm,
      com.motorola.blur.setupsettings,
      com.android.providers.settings,
      com.motorola.Upgrader,
      com.motorola.devicestatistics,
      com.motorola.android.eapauthservice,
      com.motorola.android.fota,
      android,
      com.motorola.android.providers.settings,
      com.motorola.atcmdlauncher,
      com.google.android.backup,
      com.motorola.globalunplug,
      com.motorola.android.encryption.settings,
      com.motorola.blur.provider.datacollector,
      com.motorola.datacollection,
      com.motorola.dataswitch,
      com.android.systemui,
      com.motorola.contextual.fw,
      com.motorola.vpn,
      com.motorola.android.extdispservice,
      com.motorola.android.dlnasystemservice
    ]
  ) 
```

**编辑** 或者是否可以在开始与“人员”选项卡联系后以编程方式切换到“组”选项卡？

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:32:16.043

如果你还没有尝试过，你应该试试这个：

```
ContactsContract.Groups.CONTENT_URI 
```

这是组表的 URI。

**编辑：**

以下是官方链接供参考：http: [//developer.android.com/reference/android/provider/ContactsContract.Groups.html#CONTENT_URI](http://developer.android.com/reference/android/provider/ContactsContract.Groups.html#CONTENT_URI)

对不起，但这似乎是不可能的。

[https://stackoverflow.com/questions/9734319/android-contactscontract-groups-activity-ui](https://stackoverflow.com/questions/9734319/android-contactscontract-groups-activity-ui)

[访问 Android 联系人组名称](https://stackoverflow.com/questions/4334649/accessing-android-contact-group-names)

目前看来，Groups.CONTENT_URI 仅用于获取组数据，而不是打开活动。

# asp.net - 将多个 SQL 查询压缩为一个查询，以便将一个参数用于不同的数据类型

> ID：14321301
> 
> 赞同：0
> 
> 时间：2013-01-14T15:24:00.303
> 
> 标签：asp.net, sql-server, vb.net, parameters

我希望将几个 SQL Server 查询压缩到一个查询中，这样一个参数就可以用于不同的数据类型。这些类型是日期、数字或字符串。该参数称为：@SearchValue。

在强类型数据集中，我们有下面列出的 3 个查询。

这适用于带有 VB.Net 代码隐藏文件的 ASP.Net，但我认为这个问题也可能适用于非 ASP.Net。

如果用户在搜索文本框中输入日期，我称之为：

询问：

```
SELECT ID, PaymentAmount, PaymentDate, WhatWasPaymentFor
  FROM     Payments
 WHERE     (ParentID = @ParentID) AND 
           (PaymentDate = @SearchValue) 
```

从 VB.Net 代码隐藏调用日期搜索查询：

```
tblObject = theTableAdapter.GetDataByPaymentDate(dcmParentsId, TextBoxSearch.Text)

If tblObject.Count() > 0 Then
   GridViewSummary.DataSource = tblObject
   GridViewSummary.DataBind()
End If 
```

其他的仅用于数字，最后一个用于其他所有内容。

这个仅用于数字：

```
SELECT PaymentDate, PaymentAmount, WhatWasPaymentFor, ID
  FROM Payments
 WHERE (ParentID = @ParentID) AND
       (PaymentAmount = @SearchValue) 
```

当其他 2 个查询未找到任何数据时，将调用此一个：

```
SELECT PaymentDate, PaymentAmount, WhatWasPaymentFor, ID
  FROM Payments
 WHERE (ParentID = @ParentID) AND
       ((WhatWasPaymentFor LIKE '%' + @SearchValue + '%') OR
        (@SearchValue = 'ALL')) 
```

所有这些编码都按原样工作，我这样做是因为如果我尝试使用非日期值调用 .GetDataByPaymentDate 会出现错误。

有没有办法使用单个查询来处理按日期、数字和字符串进行的搜索？

*** 更新 ***

感谢所有示例查询。我正在尝试 SQL Server Management Studio 中的所有示例查询，看看会出现什么结果。

我这个基于 Gordon 的查询，但它不返回任何数据：

```
DECLARE @SearchValue VARCHAR = '01/01/2012'
DECLARE @SearchType  VARCHAR = 'Dates' 
DECLARE @ParentID    INT = 3

SELECT ID, PaymentAmount, PaymentDate, WhatWasPaymentFor
  FROM Payments cross join
       (select @SearchValue as sv) const
 WHERE ParentID = @ParentID AND
       (case when @SearchType = 'Dates' and ISDATE(const.sv) = 1
                then (case when PaymentDate = CAST(const.sv AS datetime) then 'true' else 'false' end)
             when @SearchType = 'Numbers' and ISNUMERIC(const.sv) = 1
                then (case when PaymentAmount = cast(const.sv as Int) then 'true' else 'false' end)
             when @SearchType = 'Everything Else'
                then (case when WhatWasPaymentFor LIKE '%' + const.sv + '%' OR const.sv='ALL' then 'true' else 'false' end)
   end) = 'true' 
```

这是基于 gh9 并提取数据的。谢谢gh9：

```
DECLARE @SearchValue VARCHAR = 'Books'
DECLARE @ParentID    INT = 3
DECLARE @PaymentDate DATETIME = NULL
DECLARE @PaymentAmount MONEY = NULL

SELECT ID, PaymentAmount, PaymentDate, WhatWasPaymentFor
  FROM Payments
  WHERE ParentID = @ParentID
    AND (@paymentDate is null OR PaymentDate = @Paymentdate)
    AND (@paymentAmount is null OR paymentAmount = @paymentAmount)
    AND ((@SearchValue is null OR 
    (WhatWasPaymentFor LIKE '%' + @SearchValue  + '%' OR @SearchValue='ALL'))
  ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T20:32:34.833

这使您可以利用不必将 searchvalue 转换为您需要的任何内容的优势，而且更具可读性。根据需要修改语法，但关键思想是使用 sql server 具有空参数和短路逻辑的能力来评估强类型参数，而不是强制转换为所需的数据类型。

```
@ParentID  INT 
@PaymentAmount INT = NULL
@PaymentDate Datetime = null
@GenericSearchTerm varchar(100) = null  

AS
BEGIN
SELECT
  ID,
  PaymentAmount,
  PaymentDate,
  WhatWasPaymentFor
FROM Payments
WHERE @ParentID = @ParentID
  AND ( (@paymentDate is null OR PaymentDate = @Paymentdate))
        AND (@paymentAmount is null OR paymentAmount = @paymentAmount))
        AND ( @GenericSearchTerm is null OR ((WhatWasPaymentFor LIKE '%' + @GenericSearchTerm  + '%' OR @SearchValue='ALL')) 
```

编辑：根据@andriyM 评论更新答案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T18:28:42.617

如何添加 @SearchType 的第三个参数，其可能值为 ('datetime'、'int' 或 'nvarchar') 并在 WHERE 子句中使用它来将 @SearchValue 转换为适当的类型以进行比较。就像是：

```
SELECT
  ID,
  PaymentAmount,
  PaymentDate,
  WhatWasPaymentFor
FROM Payments
WHERE @ParentID = @ParentID
  AND (
        (@SearchType = 'datetime' AND PaymentDate = CAST(@SearchValue AS datetime))
        OR
        (@SearchType = 'int' AND PaymentAount = CAST(@SearchValue AS int))
        OR
        (@SearchType = 'nvarchar' AND 
          (WhatWasPaymentFor LIKE '%' + @SearchValue + '%' OR @SearchValue='ALL')
        ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T20:28:35.080

这是受 Bstateham 回答的启发，但它做了两件事不同。首先，它将值存储在一个表中，将它们从常量转换为变量。其次，它使用了`case`保证短路的原因。

这会导致类似：

```
SELECT ID, PaymentAmount, PaymentDate, WhatWasPaymentFor
FROM Payments cross join
     (select @SearchValue as sv) const
WHERE @ParentID = @ParentID AND
      (case when @SearchType = 'datetime' and ISDATE(const.sv) = 1
            then (case when PaymentDate = CAST(const.sv AS datetime) then 'true' else 'false' end)
            when @SearchType = 'int' and ISNUMERIC(const.sv) = 1
            then (case when PaumentAmount = cast(const.sv as Int) then 'true' else 'false' end)
            when @SearchType = 'nvarchar'
            then (case when WhatWasPaymentFor LIKE '%' + const.sv + '%' OR const.sv='ALL' then 'true' else 'false' end)
       end) = 'true' 
```

我还添加了转换为整数和日期的验证检查（不完美，但会有所帮助）。此外，您可能应该在目标字段而不是类型之后命名@SearchType。但是，我保留了带有类型名称的版本。

# vim - 如何在 VIM 中使用 Snip() 函数

> ID：14321303
> 
> 赞同：1
> 
> 时间：2013-01-14T15:24:10.250
> 
> 标签：vim

我想如何使用下面描述的乳胶包中的 imaps.vim 插件中包含的 snip() 函数：

Snip：在文本块 {{{ 描述：

这会在视觉选择的行块的上方和下方放置一个字符串“--------%<---------”。'tearoff' 字符串的长度取决于所选范围内的最大字符串长度。这是一个更美观的替代方案，而不是硬编码长度。

```
function! <SID>Snip() range
    let i = a:firstline
    let maxlen = -2
    " find out the maximum virtual length of each line.
    while i <= a:lastline
      exe i
      let length = virtcol('$')
      let maxlen = (length > maxlen ? length : maxlen)
      let i = i + 1
    endwhile
    let maxlen = (maxlen > &tw && &tw != 0 ? &tw : maxlen)
    let half = maxlen/2
    exe a:lastline
    " put a string below
    exe "norm! o\<esc>".(half - 1)."a-\<esc>A%<\<esc>".(half - 1)."a-"
    " and above. its necessary to put the string below the block of lines
    " first because that way the first line number doesnt change...
    exe a:firstline
    exe "norm! O\<esc>".(half - 1)."a-\<esc>A%<\<esc>".(half - 1)."a-"
endfuntion 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T17:12:54.887

`Snip()`请参阅中定义之后的行`imaps.vim`：

```
com! -nargs=0 -range Snip :<line1>,<line2>call <SID>Snip() 
```

这定义了 command `Snip`，可以在任何范围内调用。`'<,'>`在可视模式下，vim 会在您输入命令时自动插入范围，因此输入`:`and then`Snip`会导致`:'<,'>Snip`，将在当前选择上调用该函数。

请注意，您也可以手动指定范围。例如，`:1,5 Snip`将剪断第 1 到 5 行，`:'m,'n Snip`从标记剪断`m`到标记`n`，以及`:Snip`仅适用于当前行。

为了避免`:Snip`每次都键入，您可以将此命令映射到您选择的键。例如，您可以`z`在可视模式下映射以调用`Snip`当前选择，如下所示：

```
vnoremap z :Snip<CR> 
```

# drupal - Drupal添加空白样式表？

> ID：14321304
> 
> 赞同：2
> 
> 时间：2013-01-14T15:24:11.327
> 
> 标签：drupal, drupal-7

我正在处理的一个 Drupal 站点似乎正在添加一个破坏 jQuery 的样式表。这是一个开箱即用的安装，没有添加其他模块。

它添加了一个带有 & 符号的 href。我浏览了我的整个主题，但找不到这个。任何人都可以帮忙吗？

![在此处输入图像描述](../Images/126fbcc7e9e10133ff63c6eacf71a52c.png)

# html - HTML5 Canvas：在画布外拖动

> ID：14321305
> 
> 赞同：2
> 
> 时间：2013-01-14T15:24:14.300
> 
> 标签：html, canvas

我在使用 HTML5 Canvas 实现拖动功能时遇到问题。我了解缺少场景图等，并设置了一种方法来识别鼠标事件上的拖动矩形。

但是：问题是当鼠标离开画布时会丢失鼠标事件。如果我拖到画布外并释放鼠标按钮，我的代码不会获得 mouseup 事件来相应地改变拖动逻辑。然后，拖动的对象会一直粘在我的鼠标上，直到我再次开始拖动。

fabric.js[没有这个问题](http://fabricjs.com/per-pixel-drag-drop/)，但是我无法识别库中的相关代码。它是如何做到的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-02T19:19:47.183

首先使用布尔变量 isMouseDragged，它在 mouseDown 之后设置为 true，在 mouseUp 之后设置为 false（或者我稍后会解释的另一个事件）

您可以通过多种方式处理拖动。

```
if (mouse['isMouseDragged']) {
   mouse['xUp'] = e.clientX - canvas.getBoundingClientRect().left;
   mouse['yUp'] = e.clientY - canvas.getBoundingClientRect().top;
   ... 
```

1.  在鼠标向上计算您按下和释放按钮的点（将其想象为线）与画布边缘之间的交点，超出该点的是鼠标指针（将其想象为另一条线）。将 mouseUp 位置作为这两条线的交点。

    ```
    // FIRST OPTION
    if (mouse['mode'] == mouse['INTERSECTION']) {
        if (!mouse['isMouseOver']) {
            var edgeIntersect = mouseDraggedOut(mouse['xDown'], mouse['yDown'], mouse['xUp'], mouse['yUp']);
            mouse['xUp'] = edgeIntersect['x'];
            mouse['yUp'] = edgeIntersect['y'];
        }
    } 
    ```

2.  将虚拟鼠标指针（坐标）放在画布内。

    ```
    // SECOND OPTION
    if (!mouse['isMouseOver']) {
        if (mouse['mode'] == mouse['LOCK_INSIDE']) {
            var edgeIntersect = mouseDraggedOut(canvas.width / 2, canvas.height / 2, mouse['x'], mouse['y']);
            mouse['x'] = edgeIntersect['x'];
            mouse['y'] = edgeIntersect['y'];
        }
    } 
    ```

3.  当您离开画布并将 isMouseDragged 设置为 false 时，使坐标 onMouseUp = onMouseOut。

    ```
    // THIRD OPTION
    if (mouse['isMouseDragged']) {
       if (mouse['mode'] == mouse['MOUSEOUT_POS']) {
          mouse['xUp'] = mouse['xOut'];
          mouse['yUp'] = mouse['yOut'];
          mouse['isMouseDragged'] = false;
       }
    } 
    ```

要计算画布边缘的相交：

```
function mouseDraggedOut(x1, y1, x2, y2) {
// x1,y1 = mouseDown;  x2,y2 = mouseUp

var x3, y3, x4, y4;
var thisX, thisY;

if (x2 < 0) {// left edge
    x3 = 0;
    y3 = 0;
    x4 = 0;
    y4 = canvas.height;
    thisX = Math.round(x1 + (((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / ((y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1))) * (x2 - x1));
    thisY = Math.round(y1 + (((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / ((y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1))) * (y2 - y1));

    // I must do this for other checks, else corners (when two conditions are true) couldn't be handled
    // So I'll handle it one after another
    x2 = thisX;
    y2 = thisY;
}

if (x2 > canvas.width - 1) {// right edge
    x3 = canvas.width - 1;
    y3 = 0;
    x4 = canvas.width - 1;
    y4 = canvas.height - 1;
    thisX = Math.round(x1 + (((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / ((y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1))) * (x2 - x1));
    thisY = Math.round(y1 + (((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / ((y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1))) * (y2 - y1));
    x2 = thisX;
    y2 = thisY;
}

if (y2 < 0) {// top edge
    x3 = 0;
    y3 = 0;
    x4 = canvas.width - 1;
    y4 = 0;
    thisX = Math.round(x1 + (((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / ((y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1))) * (x2 - x1));
    thisY = Math.round(y1 + (((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / ((y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1))) * (y2 - y1));
    x2 = thisX;
    y2 = thisY;
}

if (y2 > canvas.height - 1) {// bottom edge
    x3 = 0;
    y3 = canvas.height - 1;
    x4 = canvas.width - 1;
    y4 = canvas.height - 1;
    thisX = Math.round(x1 + (((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / ((y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1))) * (x2 - x1));
    thisY = Math.round(y1 + (((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / ((y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1))) * (y2 - y1));
}

return {
    'x' : thisX,
    'y' : thisY
}; 
```

}

看源码：http: [//jsfiddle.net/WolfeSVK/s2tNr/](http://jsfiddle.net/WolfeSVK/s2tNr/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-11T11:14:15.913

解决方案是附加到`mouseleave`事件，而不考虑用于拖动的按钮在您的逻辑中不再向下。

# version-control - CVS 不断在我要提交的文件末尾添加代码

> ID：14321308
> 
> 赞同：1
> 
> 时间：2013-01-14T15:05:29.767
> 
> 标签：version-control, cvs

我的 CVS 项目中有 4 个文件有问题。每次我提交其中一个文件时，CVS 都会在其末尾添加相同的代码行。这行代码是当前文件的重复行（但不是它的最后一行）。

我尝试了几件事：更新、删除行并提交、删除所有行并提交、添加行并提交、添加标题和提交。但是我总是将同一行代码添加到我的文件末尾。我可以删除所有文件并重新创建它们，但我会丢失所有历史数据。

我发现 CVS 在我提交时修改我的文件很尴尬。它是否会适得其反，因为它可能会在合规代码中添加错误？

我可以补充一点，我的文件是一个 .strings（文本文件，unicode）。我正在一个分支上工作，但最近将它合并到主干中。

### 更多细节：

*   我在虚拟 Windows 机器上使用 TortoiseSVN，它可以通过这两者之间的网络驱动器访问我的 Mac OS X 的 Documents 文件夹。

*   事实证明，我的同事拥有相同的项目，但在真实的 Windows 文件夹中，可以毫无问题地提交。

*   现在他这样做了，问题也为我解决了。

*   但我不知道会发生什么。我唯一的线索是 Mac OS X 中一个会破坏 TortoiseSVN 的隐藏字符。可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:41:24.130

我没有遇到过 CVS 的这个问题，但请注意您提到您正在编辑的文件是 Unicode 文本（您没有提到这是否意味着 UTF8 或 UTF16，但两者都可能导致问题）。

根据您的 CVS 服务器是如何构建的，以及它的运行方式（以及在什么平台上），服务器很可能*不*支持 Unicode。这可能会导致一系列可能的问题，包括在 Unicode 字符的第二个（或更高）字节等于 ASCII '$' 的地方扩展 RCS 样式的 $ 标记。

解决方法是将 Unicode 源文件标记为二进制对象。从命令行，这可以使用

```
cvs add -kb file-name 
```

添加新文件时，或

```
cvs admin -kb file-name 
```

对于现有文件（将*文件名*替换为文件名）。

在后一种情况下，我建议删除（本地副本）文件并运行“cvs update”以在更改类型后将其取回。

请注意，这样做不太可能对您已经在文件中看到的更改有所帮助，因此请务必检查文件，并在进行此更改后修复任何现有问题。

# sql-server - 创建索引时崩溃

> ID：14321312
> 
> 赞同：1
> 
> 时间：2013-01-14T15:24:37.993
> 
> 标签：sql-server, crash, indexing

我在 MSSQL 中有一个包含 3 亿多条记录的表，我需要创建一个新索引。创建索引时崩溃。这是一个很好的解决方法吗？

目前在连续搅拌数小时后崩溃（8+）。

我考虑只创建一个具有正确索引的新表并复制数据。这是一个坏主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:26:10.200

这将取决于它崩溃的原因，如果您的磁盘空间不足，那么创建一个新表将无济于事。查看 SQL 日志，看看它是否提供任何关于尝试创建索引时发生的情况的指示。

# java - Java：正则表达式模式无法识别 HTML 中的空格

> ID：14321315
> 
> 赞同：2
> 
> 时间：2013-01-14T15:24:42.553
> 
> 标签：java, html, regex, parsing

代码：

```
static short state = 0;
static int td_number = 0;

public static void main(String[] args) {

final Pattern p = Pattern.compile("^[\\s]*?\\d+\\.\\d+[\\s]*?");
final short TD_ENTRY = 0;
final short NO_ENTRY = 1;

HTMLEditorKit.ParserCallback callback = new HTMLEditorKit.ParserCallback() {
    public void handleText(char[] data, int pos) {
    switch (state) {
    case NO_ENTRY:
        break;
    case TD_ENTRY: {
        // We are in the right table column
        // Create string from char array
        String s = new String(data);
        Matcher m = p.matcher(s);
        boolean b = m.matches();
        // Check if data information has correct format (0.0)
        if (b) {

        }
    }
        break;
    default:
        break;
    }
    state = NO_ENTRY;
    }

    public void handleStartTag(HTML.Tag tag, MutableAttributeSet set, int pos) {
    if (tag == HTML.Tag.TD) {
      //[...]
    }
    }
};

Reader reader = new StringReader(html);
try {
    new ParserDelegator().parse(reader, callback, false);
} catch (IOException e) {
}
} 
```

我正在尝试使用正则表达式解析 HTML。该程序读取`td`html 表中标签的内容。表格单元格中的内容应该符合`Pattern p`.

现在的主要问题是正则表达式模式与“0.1”这样的单元格内容不匹配。但是，如果我`String s`在代码中使用值（“0.1”）手动定义模式匹配。

此外，如果我`char[] data`在调试模式下复制 的内容并`s`使用此复制的内容进行定义，则该模式也不适合，尽管它看起来与上面手动定义的值相同。

是否可以找出真正读取了哪些空白字符？

似乎空格并不总是空格，因此与正则表达式类 [\s] 不匹配。这可能吗？

**编辑：**

感谢您的回答。它实际上是一个空白字符 (\xA0)，\s 正则表达式类无法识别。

对于所有投反对票（真的令人沮丧）的人来说，我的问题只是误解了我。也许问题真的是“我想用正则表达式解析 HTML”这句话，但实际上我只是从 HTML 表格单元格中获得了带有未知空白字符的内容 ;-)。

我想我在使用像 jsoup 这样的库时遇到了同样的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T17:03:28.973

在 Java 正则表达式中，不间断空格字符 (NBSP, `U+00A0`) 传统上不被视为空格以匹配`\s`. 如果这是导致您的问题的原因，您只需将其添加到现有的空白类中：

```
"^[\\s\\xA0]*\\d+\\.\\d+[\\s\\xA0]*$" 
```

还有其他 Unicode 空白字符与 不匹配`\s`，但它们都不像 NBSP 那样常见。

Alternatively, if you're running Java 7+ you can specify [`UNICODE_CHARACTER_CLASS` mode](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html#UNICODE_CHARACTER_CLASS) and go on using `\s`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:35:05.397

您的代码片段太长，但据我了解，您只需要模式来匹配诸如等之类的东西`0.0`，`10.52`即浮点数？使用模式`\\d+\\.\\d+`。

`\d+`表示 1..n 位 `\.`表示点。正则表达式中的单个点`.`表示“任何字符”

这是使用示例：

```
String str = "123.456";
Pattern p = Pattern.compile("\\d+\\.\\d+");
Matcher m = p.matcher(str);
if (m.matches()) {
    // do something.
} 
```

顺便说一句，注意`matches()`匹配整行。如果您想匹配部分行，请`find()`改为使用。我个人总是在需要时使用`find()`和使用开始和结束行标记`^`以及`$`正则表达式本身。

# c++ - switch 语句中的控制结构

> ID：14321318
> 
> 赞同：2
> 
> 时间：2013-01-14T15:24:49.873
> 
> 标签：c++, switch-statement

为什么 if 块中的代码以任何方式执行？

```
switch(v)
{
case a:
    break;
...
if(condition)
{
    case f:
        ...
        break;
    case g:
        ...
        break;
}
...
case z:
    ...
    break;
default:
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-14T15:30:37.930

C++ 编译器使用查找表或直接分支到 -`case`语句。忽略你的`if`-statement。由于`break`它也无法从 到达`case a`。

`case`长回答简短，您不能使用此方法“关闭”语句。

相反，你需要这样的东西：

```
switch(v) {
  case a :
    break;
  //...
  case f :
    if(condition) {
      //...
    }
    break;
  case g :
    if(condition) {
      //...
    }
    break
  //...
  case z :
    break;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T15:37:35.070

A `case` *label*, as the name implies, is an actual label and works very similar to a `goto` label: the execution thread just jumps to it. It does not matter what structure it is in, unless that structure is another, nested `switch` statement.

It works the same way as this:

```
if (v == f)
    goto f_label;

if (condition) {
    f_label:
    // ...
} 
```

The execution thread will jump to the `f_label:` label regardless of whether `condition` is true or not. `switch` labels work the same way.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T15:32:58.030

当程序正在编译时，`switch`会构建一些表以从一个跳转`case`到另一个。这会以某种方式忽略其他条件操作。BTW 根据这种行为`switch`比长`if-else`块更快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-14T15:28:57.793

switch 的 case 子句非常灵活，您可以`hacks`为它们做一些事情。例如，我看到有些人使用 switch 来跳出嵌套的 for 循环。仍然在上面的示例中，如果 v 是`f`或者`g`switch 将跳过 if 语句，并且 case 中的代码将在 switch 之后立即执行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-14T16:12:42.447

我认为最好的答案是（灵感来自 Nikos C. 的答案）：

```
switch(v)
{
case a:
    break;

case z:
    ...
    break;
default:
    if(condition)
    {
        switch(v)
        {
        case f:
            ...
            break;
        case g:
            ...
            break;

        default:
            //former default
        }

    }
    else
        //former default
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-14T15:40:35.260

Switch 跳转到匹配的大小写，忽略其间的所有语句。您有两种方法来完成您打算做的事情（取决于您必须实施的案例数量）：

方法 1 在 if 条件下的更多案例

```
 if(condition) {
  switch(v) {
  case f :
    ....
    break;
  //...
  case g :
    ....
    break;
  //...
  case z :
    break;
}

  switch(v) {
  case a :
    ....
    break;
  //...
} 
```

if条件下较少情况的方法2

```
 switch(v) {
  case a :
    break;
  //...
  case f :
    if(condition) {
      //...
    }
    break;
  case g :
    if(condition) {
      //...
    }
    break
  //...
  case z :
    break;
} 
```

# c# - 新手 - C# For 循环，当 i = loopEnd 时需要帮助停止循环

> ID：14321323
> 
> 赞同：-1
> 
> 时间：2013-01-14T15:25:00.490
> 
> 标签：c#, loops

我试图让我的循环在`i`等于`loopEnd`变量时停止。这是代码：

```
for (int i = loopStart; i < loopEnd; i++) 
```

目前它在`i`大于时停止，但是如果我替换`loopEnd`为 程序将无法运行，如果我使用将无法运行。`<``=``==`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-14T15:26:26.377

*不*`i`，目前它会在等于时停止（因为 then*不*小于）。如果您*希望*它仅在大于时停止，请改用：`loopEnd``i`*`loopEnd`*`i``loopEnd``<=`**

 **```
for (int i = loopStart; i <= loopEnd; i++) 
```

请注意，如果`loopEnd`是这种方法会有问题`int.MaxValue`- 您将永远循环，因为当`i`增加时，它将`int.MinValue`再次小于`loopEnd`（除非您处于已检查的上下文中，在这种情况下将引发异常）。

这对您来说可能不是问题，但值得注意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T15:27:18.450

```
for (int i = loopStart; i <= loopEnd; i++)
                        //^ apply less or equal operator 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T15:27:08.167

```
for (int i = loopStart; i <= loopEnd; i++) 
```

那是你要的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T15:26:37.573

使用`i != loopEnd`. 此条件指示何时*进入*循环，而不是何时*停止进入*。

正如克里斯在他的评论中提到的那样，最好使用`<=`，因为您可能会`i`在体内增加并跳过`loopEnd`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-14T15:27:34.437

在你的循环中使用 `<=`with 。`loopEnd`喜欢;

```
for (int i = loopStart; i <= loopEnd; i++) 
```**

# asp.net-mvc-3 - MVC3 Razor 复选框值在提交时未通过

> ID：14321328
> 
> 赞同：0
> 
> 时间：2013-01-14T15:25:11.543
> 
> 标签：asp.net-mvc-3, razor, checkbox

我有一个列表中包含多个复选框项目的表单。我有这个列表的编辑器。它们在屏幕上显示良好。但是提交时检查的项目没有在模型中提交......

楷模：

```
public class ContactUsersModel : BaseModel
{
     public IList<FilterCheckModel> PreviousVisitors { get; set; }
}

public class FilterCheckModel : BaseModel
{
    public string Name { get; set; }
    public string Value { get; set; }
    public bool IsChecked { get; set; }        
} 
```

控制器：

```
IList<FilterCheckModel> prevVisitList = new List<FilterCheckModel>();
prevVisitList.Insert(0, new FilterCheckModel() { Name = "All previous visitors", Value = "0" });
prevVisitList.Insert(1, new FilterCheckModel() { Name = "Not visited in last month", Value = "1" });
prevVisitList.Insert(2, new FilterCheckModel() { Name = "Not visited for 1-3 months", Value = "2" });
prevVisitList.Insert(3, new FilterCheckModel() { Name = "Not visited for 3-6 months", Value = "3" });
prevVisitList.Insert(4, new FilterCheckModel() { Name = "Not visited for over 6 months", Value = "4" });
model.PreviousVisitors = prevVisitList; 
```

html:

```
 <table>
       <tr>
         <th>
             Previous visitors:
         </th>
       </tr>
       @for (int i = 1; i < Model.PreviousVisitors.Count; i++)
       {
           @Html.EditorFor(model => model.PreviousVisitors[i], "FilterCheck", new { Index = i + 1})
       }
  </table> 
```

编辑：

```
<tr>
    <td>
        @Model.Name
    </td>
    <td>
        @Html.CheckBoxFor(x => x.IsChecked)
        @Html.HiddenFor(x => x.Value)
    </td>
</tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T11:35:54.753

找到了！

原因是在我的循环中，我开始了 i = 1。由于某种原因，这导致了一个问题。索引需要从 0 开始...

```
 @for (int i = 1; i < Model.PreviousVisitors.Count; i++) 
```

所以我把它改成了

```
 @for (int i = 0; i < Model.PreviousVisitors.Count; i++) 
```

它奏效了！

# c# - 将调度程序更新/部署到 vps 的自动化方式

> ID：14321329
> 
> 赞同：0
> 
> 时间：2013-01-14T15:25:13.447
> 
> 标签：c#, deployment, service, windows-server-2008-r2

我创建了一个带有计时器的类，它每 10 分钟执行一次操作。然而，该课程经常更新，并且必须全天每 10 分钟运行一次！

如何确保服务器使用最新版本而不中断计划？

我正在考虑创建一个 Windows 服务。在服务器上更新不方便。

你必须：

1.  停止服务
2.  取消注册服务
3.  卸载服务
4.  卸载应用程序
5.  安装新应用程序
6.  注册新服务
7.  启动新服务

tl;dr：我正在寻找一种简单的解决方案来部署 Windows 服务或其他解决方案，以便更新简单方便。

我正在考虑 WCF 服务，但它们不是为此目的而设计的。我相信使用 WCF 服务，您可以轻松地将其直接发布到 VPS IIS。

格言

# actionscript-3 - 尝试 POST 到 Sharepoint 2013 时在客户端（动作脚本）上 REST POST MIME

> ID：14321330
> 
> 赞同：0
> 
> 时间：2013-01-14T15:25:17.760
> 
> 标签：actionscript-3, rest, post, sharepoint-2013

我正在尝试执行 POST 以在 AIR 客户端的 Sharepoint 2013 列表中插入值。GET 工作并且身份验证正常。

这是我的 as3 代码：

```
URLRequestDefaults.authenticate = true;
URLRequestDefaults.setLoginCredentialsForHost("srv", "usr", "pwd");

var postURL:URLRequest= new URLRequest("http://srv/site/_api/web/lists/getByTitle('list')/items");      
postURL.authenticate = true;
postURL.method = URLRequestMethod.POST;
postURL.requestHeaders.push( new URLRequestHeader("ACCEPT","application/json;odata=verbose"));
postURL.requestHeaders.push( new URLRequestHeader("ContentType","application/json"));
postURL.data = JSON.stringify({ '_metadata': { 'type': 'SP.listnameListItem' }, 'Title': 'desc' });
postLoader = new URLLoader(postURL);
postLoader.dataFormat = URLLoaderDataFormat.TEXT;
postLoader.addEventListener(flash.events.Event.COMPLETE, postDone);
postLoader.addEventListener(IOErrorEvent.IO_ERROR, handleIOError );
postLoader.addEventListener(HTTPStatusEvent.HTTP_STATUS, handleHttpStatus );
postLoader.addEventListener(SecurityErrorEvent.SECURITY_ERROR, handleSecurityError );
postLoader.load(postURL); 
```

当我运行它时，它会转到 handleIOError 方法：

```
private function handleIOError ( event:IOErrorEvent ):void
{
 trace ( "Load failed: IO error: " + event.text );
 trace ( "data IO error: " + event.currentTarget.data.toString() );
} 
```

我收到此错误：Microsoft.Data.OData.ODataContentTypeException 找不到与响应的内容类型匹配的受支持的 MIME 类型。支持的类型 'application/atom+xml;type=feed, application/atom+xml, application/json;odata=verbose' 不匹配内容类型 'text/xml;charset=utf-8' 任何想法? 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T08:03:47.143

好的，我发现添加/修改这些行使它起作用：

```
postURL.requestHeaders.push( new URLRequestHeader("ContentType","application/json;odata=verbose"));
postURL.requestHeaders.push( new URLRequestHeader("X-RequestDigest",FormDigestValue ));
postURL.requestHeaders.push( new URLRequestHeader("If-Match","*"));
postURL.requestHeaders.push( new URLRequestHeader("X-Http-Method","POST"));
postURL.contentType="application/json;odata=verbose"; 
```

# algorithm - 最近的顶点搜索

> ID：14321332
> 
> 赞同：3
> 
> 时间：2013-01-14T15:25:26.560
> 
> 标签：algorithm, data-structures, nearest-neighbor, kdtree, closest-points

我正在寻找有效的算法来找到最接近点 P(x, y, z) 的顶点。顶点集是固定的，每个请求都带有新的点 P。我尝试了 kd-tree 和其他已知方法，但我到处都遇到同样的问题：如果 P 更接近则一切都很好，只对少数树节点执行搜索. 但是，如果 P 足够远，那么应该扫描越来越多的节点，最终速度变得无法接受。在我的任务中，我无法指定一个小的搜索半径。这种情况有什么解决方案？

谢谢伊戈尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T20:20:12.943

加快搜索速度的一种可能方法是将空间离散为大量以规则间隔隔开的矩形棱柱。例如，您可以将空间分成许多 1 × 1 × 1 单位的立方体。然后，您将空间中的点分布到这些体积中。这为您提供了一种“散列函数”，用于将点分布到包含它们的体积中。

完成此操作后，请执行快速预计算步骤，并为每个卷找到最接近的非空卷。您可以通过检查距离卷一步，然后两步等所有卷来做到这一点。

现在，要进行最近邻搜索，您可以执行以下操作。首先将空间中的点散列到包含它的卷。如果该卷包含任何点，则遍历所有点以找到最接近的点。然后，对于您在此过程的第一步中找到的每个卷，遍历这些点以查看它们是否更接近。生成的最近点是离您的测试点最近的邻居。

如果您的卷最终包含太多点，您可以通过将这些卷细分为更小的卷并重复相同的过程来改进此方法。您也可以创建一堆较小的 kd 树，每个卷一个，以进行最近邻搜索。通过这种方式，每棵 kd 树拥有的点数比您的原始 kd 树要少得多，并且每个卷内的点都是最近邻的合理候选者。因此，搜索应该快得多。

这种设置在本质上类似于八叉树，不同之处在于您将空间划分为一堆更小的区域，而不是八个。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T11:33:12.457

好吧，这不是所使用的索引结构的问题，而是您的查询的问题：

离数据集越远，最近的邻居就越模糊。

所以我怀疑任何其他索引都会对你有很大帮助。

但是，您可以在搜索中插入阈值。即“找到最近的邻居，但只有在最大距离 x 内”。

对于具有欧式距离的静态、内存中的 3-d 点双向量数据，kd-tree 实际上很难被击败。它只是非常非常快地拆分数据。八叉树有时可能更快，但我猜主要用于窗口查询。

现在，如果您确实只有很少的对象但有数百万个查询，您可以尝试做一些混合方法。大致是这样的：计算数据集凸包上的所有点。计算中心和半径。每当查询点距离 x 倍远（您需要自己进行 3d 数学运算以找出正确的 x）时，它的最近邻居必须是凸包点之一。然后再次使用 kd-tree，但仅包含船体点。

或者更简单。找到每个维度中的最小/最大点。也许添加一些额外的极端（在 x+y、xy、x+z、xy、y+z、yz 等）。所以你得到了一小部分候选人。所以现在让我们假设是 8 分。预先计算这 6 个点的中心和距离。设 m 为从中心到这 8 个点的最大距离。对于查询，计算到中心的距离。如果这大于 m，则首先计算这 6 个候选者中最接近的。然后查询kd-tree，但将搜索绑定到这个距离。这会花费您 1（近距离）和 7（远邻居）距离计算，并且可以通过尽早提供好的候选者来显着加快搜索速度。为了进一步加速，也可以将这 6-26 个候选者组织在一个 kd-tree 中，以快速找到最佳边界。

# javascript - 在剑道网格中显示始终停用的滚动条

> ID：14321334
> 
> 赞同：1
> 
> 时间：2013-01-14T15:25:28.713
> 
> 标签：javascript, kendo-ui

我将网格加载到剑道分离器中。但是当我移动分隔条时，水平网格高度会随着水平滚动条的出现而增加。这会导致拆分器具有高度，因为网格中没有水平滚动条，包含网格的窗格也具有滚动条出现之前的高度。这会在窗格中产生一个垂直滚动条，这是我不想拥有的。拆分器的“OnResize”事件不能正确处理这个出现的滚动条。

# javascript - node.js：包括外部 grunt 配置

> ID：14321341
> 
> 赞同：4
> 
> 时间：2013-01-14T15:25:45.700
> 
> 标签：javascript, node.js, gruntjs

我在顶级目录中有一个 grunt 文件，我想包含子文件夹中的配置设置。有没有一种干净的方法可以用 grunt 做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-14T21:49:37.190

将它们放入 JSON 文件并使用[grunt.file.readJSON](https://github.com/gruntjs/grunt/wiki/grunt.file)导入它们。

例子：

```
module.exports = function (grunt) {
    grunt.initConfig({
        settings: grunt.file.readJSON('subfolder/settings.json'),
        settings2: grunt.file.readJSON('subfolder2/settings.json'),
        task: {
            target: {
                files: {
                    'dest': '<%- settings.path %>',
                    'dest': '<%- settings2.path %>'
                }
            }
        }
    });
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-28T12:16:14.213

作为替代方案，您可以使用`require`. 具有不同环境的此设置示例，带有“concat”和“uglify”组件。

结构：

```
// root
Gruntfile.js
config/
    env1.js
    env2.js
src/
    file1.js
    file2.js
    ...

dest/
    env1.js
    env1.min.js
    env2.js
    env2.min.js 
```

文件：

```
// Gruntfile.js ...
// ____________________> 
var config = {
    'env1' : require('./config/env1'),
    'env2' : require('./config/env2')
};
module.exports = function (grunt) {
    grunt.initConfig({
        concat: {
            env1: {
                src: config.env1, // ^config
                dest: 'dest/env1.js'
            },
            env2: {
                src: config.env2, // ^config
                dest: 'dest/env2.js'
            }
        },
        uglify: {
            my_target: {
                files: {
                    'dest/env1.min.js' : ['dest/env1.js'],
                    'dest/env2.min.js' : ['dest/env2.js']
                }
            }
        }
    });

    grunt.loadNpmTasks('grunt-contrib-concat');
    grunt.loadNpmTasks('grunt-contrib-uglify');

    grunt.registerTask('default', ['concat', 'uglify']);
};

// config/env1.js ...
// ____________________> 
module.exports = [
    // files...
    'src/file1.js',
    'src/file2.js',
    'src/file3.js'
];

// config/env2.js ...
// ____________________> 
module.exports = [
    // files...
    'src/file4.js',
    'src/file5.js',
    'src/file6.js'
]; 
```

# soapui - SoapUI 启动时如何启动所有模拟服务？

> ID：14321342
> 
> 赞同：5
> 
> 时间：2013-01-14T15:25:53.940
> 
> 标签：soapui

有没有什么命令行参数，或者其他方式，让soap ui启动时所有的mock服务都启动？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-13T15:27:38.157

由于 mockServices 是一个 Map 这也可以工作：

project.mockServices.each() { entry -> entry.value.start() }

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-26T13:35:24.213

您可以借助 Groovy 脚本自动执行此操作。

1.  双击项目（在导航器窗格内）
2.  打开选项卡“加载脚本”
3.  以下脚本可以用作示例：

    `project.getMockServiceByName("name_of_your_mock_service_01").start();` `project.getMockServiceByName("name_of_your_mock_service_02").start();`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-27T20:33:54.713

正在寻找相同的休息模拟服务。为此，请从测试套件设置脚本中改用它。以防万一有人在搜索时降落在这里，就像我降落一样。这也可以通过相应地修改从项目或测试用例级别使用。

```
 testSuite.project.getRestMockServiceByName("Service1").start() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-13T15:39:14.030

根据soapUI 支持论坛上的定义，您可以将以下代码添加为项目的“加载脚本”：

```
for( mockService in project.mockServiceList )
{
    def windowReference = com.eviware.soapui.support.UISupport.showDesktopPanel( mockService )
    mockService.start() 
    com.eviware.soapui.SoapUI.desktop.minimize( windowReference  )
} 
```

soapUI 支持论坛参考： http:
[//forum.soapui.org/viewtopic.php? f=5&t=1138](http://forum.soapui.org/viewtopic.php?f=5&t=1138)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-10T10:20:45.160

我使用这个 Groovy 脚本来启动项目中的所有模拟服务（在项目视图的“加载脚本”选项卡中设置。

```
mockServicesCount = project.getMockServiceCount()
for (i in 0..(mockServicesCount-1)) {
    project.getMockServiceAt(i).start();
    i++;
} 
```

# javascript - 通过用户脚本删除网站标题的一部分

> ID：14321343
> 
> 赞同：1
> 
> 时间：2013-01-14T15:25:55.330
> 
> 标签：javascript, userscripts

我尝试编写一个用户脚本，从网站标题（flash browsergame）中删除所有内容，但开始操作时出现倒计时[。](http://userscripts.org/)

我是 Javascript 新手，需要一些帮助。

**更新**

***正则表达式问题已解决，但我仍然需要一些帮助才能让此脚本“监控”标题，因此每次游戏更改时，脚本都会再次运行。***

主标题如下所示：

> Shakes & Fidget - The Game (buffed buffed)

一旦动作开始，倒计时就会添加到开头，因此标题更改为

> 02:26 - Shakes & Fidget - The Game (buffed buffed)

我希望标题仅显示倒计时。

我在网上搜索并找到了不同的方法来做到这一点，但它们都不适合我。

这是我目前拥有的：

```
// ==UserScript==
// @name       Shakes & Fidget Buffed title shortener
// @namespace  http://släcker.de
// @version    0.1
// @description  Removes the page title of Shakes & Fidget to only display left time if it exists
// @include        *.sfgame.*
// @exclude        www.sfgame.*
// @exclude        sfgame.*
// @copyright  2013+, slaecker
// ==/UserScript==

var regex = [^0-9:]

function cleanTitle() { 
    var oldTitle = document.title; 
    var oldTitleRX = oldTitle.match(regex);
    document.title = oldTitle.replace(oldTitleRX,""); 
    return oldTitle; 
} 

cleanTitle() 
```

Javascript 控制台显示有关正则表达式的错误。我试图转义字符，但错误是相同的：

```
env: ERROR: Syntax error @ 'Shakes & Fidget Buffed title shortener'!
Unexpected token ^
SyntaxError: Unexpected token ^
    at Window.Function (<anonymous>)
    at L (eval at <anonymous> (eval at <anonymous> (chrome-extension://dhdgffkkebhmkfjojejmpbldmpobfkfo/content.js:51:21)), <anonymous>:156:21)
    at n (eval at <anonymous> (eval at <anonymous> (chrome-extension://dhdgffkkebhmkfjojejmpbldmpobfkfo/content.js:51:21)), <anonymous>:384:2)
    at R (eval at <anonymous> (eval at <anonymous> (chrome-extension://dhdgffkkebhmkfjojejmpbldmpobfkfo/content.js:51:21)), <anonymous>:388:86)
    at Q (eval at <anonymous> (eval at <anonymous> (chrome-extension://dhdgffkkebhmkfjojejmpbldmpobfkfo/content.js:51:21)), <anonymous>:194:40)
Uncaught SyntaxError: Unexpected token ^
L
n
R
Q 
```

它必须是正则表达式匹配，因为包含的字符串“（buffed buffed）”发生了变化（它显示了服务器名称）。

另一个问题是脚本应该“监视”标题，因为每次启动或完成新操作时它都会更改，但我的脚本只运行一次（在没有正则表达式的情况下对其进行了测试）。

在此先感谢您的帮助，

斯莱克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:41:05.903

您的正则表达式文字有几个问题。它必须被包装到 /-es，它错过了一个乘数，没有它它只匹配一个字符，并且您需要使用“g”修饰符使其全局化，以便匹配数字两侧的字符串部分。

```
var regex = /[^0-9:]+/g;

function cleanTitle() { 
    document.title = document.title.replace(regex, ""); 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T01:25:20.823

对于正则表达式，使用：

```
document.title = document.title.replace (/[^0-9:]/g, ""); 
```

要检测标题更改，请使用[MutationObservers](https://developer.mozilla.org/en-US/docs/DOM/MutationObserver)，这是一种在 Google Chrome 和 Firefox（两个主要的[用户脚本](/questions/tagged/userscripts "显示标记为“用户脚本”的问题")浏览器）中实现的新 HTML5 功能。

这个**完整的脚本**将起作用：

```
// ==UserScript==
// @name        Shakes & Fidget Buffed title shortener
// @namespace   http://släcker.de
// @version     0.1
// @description  Removes the page title of Shakes & Fidget to only display left time if it exists
// @include     *.sfgame.*
// @exclude     www.sfgame.*
// @exclude     sfgame.*
// @copyright   2013+, slaecker, Stack Overflow
// @grant       GM_addStyle
// ==/UserScript==
/*- The @grant directive is needed to work around a design change
    introduced in GM 1.0\.   It restores the sandbox.
*/

var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;
var myObserver       = new MutationObserver (titleChangeDetector);
var obsConfig        = {
    //-- Subtree needed.
    childList: true, characterData: true, subtree: true
};

myObserver.observe (document, obsConfig);

function titleChangeHandler () {
    this.weInitiatedChange      = this.weInitiatedChange || false;
    if (this.weInitiatedChange) {
        this.weInitiatedChange  = false;
        //-- No further action needed
    }
    else {
        this.weInitiatedChange  = true;
        document.title = document.title.replace (/[^0-9:]/g, "");
    }
}

function titleChangeDetector (mutationRecords) {

    mutationRecords.forEach ( function (mutation) {
        //-- Sensible, Firefox
        if (    mutation.type                       == "childList"
            &&  mutation.target.nodeName            == "TITLE"
        ) {
            titleChangeHandler ();
        }
        //-- WTF, Chrome
        else if (mutation.type                      == "characterData"
            &&  mutation.target.parentNode.nodeName == "TITLE"
        ) {
            titleChangeHandler ();
        }
    } );
}

//-- Probably best to wait for first title change, but uncomment the next line if desired.
//titleChangeHandler (); 
```

* * *

如果您正在使用其他浏览器（*在问题中说明*），则回退到使用`setInterval()`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T15:55:37.587

看起来您的计时器/计数器具有明确的格式。假设格式是`##:##`，您可以这样形成您的 RegEx：

```
var regex = /\d\d:\d\d/g; 
```

然后，这将获得特定的计时器模式（而不是在标题开头找到的任何数字和冒号）。

*不要忘记将您的正则表达式语句用斜杠括起来。*在正斜杠之后使用`g`（如上所示）将在您的标题中找到其他计时器实例。如果你知道你只有一个，最好把`g`末端取下来。

# c# - 获取给定开始日期和结束日期的日期的简单方法

> ID：14321344
> 
> 赞同：1
> 
> 时间：2013-01-14T15:26:01.560
> 
> 标签：c#, .net, linq, datetime

是否有一种快速简单的方法来获取`List<DateTime>`给定的开始和结束日期？

我显然知道我可以通过循环来实现这一点，但我想知道是否有使用 Linq 或其他实用程序的更智能的方法。

**注意**我需要在两个给定日期之间**的每一天**`DateTime`获取一个实例。

 *** * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-14T15:30:06.247

迭代器块对此非常有用。

`for`我认为没有理由不在这里使用循环。您需要为每个日期执行一些运算符，因为您有这么多的输出，没有任何方法会具有更好的渐近复杂度。

```
public static IEnumerable<DateTime> GetDates(DateTime startDate, DateTime endDate
    , TimeSpan interval)
{
    for (DateTime date = startDate; date < endDate; date.Add(interval))
    {
        yield return date;
    }
} 
```

您也可以为固定间隔添加重载：

```
public static IEnumerable<DateTime> GetDays(DateTime startDate, DateTime endDate)
{
    return GetDates(startDate, endDate, TimeSpan.FromDays(1));
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T15:32:03.770

您可以这样做以获取来自`startDate`to的列表`endDate`：

```
List<DateTime> dates =
  Enumerable.Range(0, (int)((endDate - startDate).TotalDays) + 1)
  .Select(n => startDate.AddDays(n))
  .ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T15:31:11.097

惰性评估查询可能如下所示：

```
//inclusive start and inclusive end
public IEnumerable<DateTime> DateSequence(DateTime start, TimeSpan interval, DateTime end)
{
    DateTime current = start;
    while(current <= end)
    {
        yield return current;
        current = current.Add(interval);
    }
} 
```

现在您可以像下面这样简单地使用它。每天设置间隔为 `TimeSpan.FromDays(1)`

```
var start = DateTime.Now;
var end = DateTime.Now.AddDays(7);
var interval = TimeSpan.FromDays(1);

var sequence = DateSequence(start, interval, end);

//LinqPad specific call
sequence.Dump(); 
```

印刷：

```
1/14/2013 5:34:57 PM 
1/15/2013 5:34:57 PM 
1/16/2013 5:34:57 PM 
1/17/2013 5:34:57 PM 
1/18/2013 5:34:57 PM 
1/19/2013 5:34:57 PM 
1/20/2013 5:34:57 PM 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-14T15:35:44.317

假设您需要每日粒度，并包括开始日期和结束日期：

```
var start = new DateTime(2012, 01, 01);
var end = new DateTime(2013, 01, 01);
var daysInBetween = Enumerable.Range(0, (int) (end - start).TotalDays + 1)
                              .Select(value => start.AddDays(value)); 
```**

# ehcache-bigmemory - 输出是一个使用 bigmemory 的非常大的矩阵

> ID：14321347
> 
> 赞同：1
> 
> 时间：2013-01-14T15:26:12.830
> 
> 标签：ehcache-bigmemory

我正在使用我想计算 w 的 bigmemory。我的 v 长度是 478000，k 长度是 240500。两个矩阵乘法是 w 非常大我循环运行代码仍然运行尚未完成，我不知道是否会给我结果。我试图在没有 for 循环的情况下进行计算。我有错误。请任何帮助来纠正我的代码 r 使其快速。

```
 v <-read.big.matrix('v.dat',type='double')
    k <-read.big.matrix('k.dat',type='double')
    m=length(v);
    n=length(k);
    w <-filebacked.big.matrix(length(v),length(k),type="double",backingfile="w.bin",descriptorfile="w.desc")
    start <- Sys.time()
    w <- as.big.matrix(2*cos(0.001*v[]%*%t(k[]))-2)
    Sys.time() - start

    # for(i in 1:m)
   # {

           # for(j in 1:n)
           # {
                   # w[i,j]=2*cos(dt*v[i]*k[j])-2
           # }
   # } 
```

谢谢。

# python - 使用正则表达式检查并保存电话号码

> ID：14321348
> 
> 赞同：1
> 
> 时间：2013-01-14T15:26:15.480
> 
> 标签：python, regex

我想检查俄罗斯/哈萨克斯坦的手机（以 +7 9x 或 +7 7x 开头），但`re`sintaxis 完全让我大吃一惊。
我想接受这种格式的数字：

```
+7 9XX XXXXXXX 
+7 7XX XXXXXXX 
7 7XX XXXXXXX
7 9XX XXXXXXX
8 9XX XXXXXXX   (8 is domestic replace for country code)
8 7XX XXXXXXX  
9XX XXXXXXX     (9 numbers, no country code!)
7XX XXXXXXX 
```

并将它们保存为`7XXXXXXXXXX`格式（**国家代码**+ 10 个数字，没有**+**）

我写了这个：
`re.search(r'^(\+?79?|\+?77?|89?|87?|9|7)(\d{9})$','+79221234567').groups()`

我现在如何以需要的格式保存结果？我是否应该编写另一个正则表达式，将其应用于上面 ( `re.search('(\d{10})$',result_above)`) 的正则表达式的结果，还是有更好的方法在一个正则表达式表达式中获取格式化结果？

PS：我的正则表达式适用于数字，但如果我用 - 或 () 输入数字，它将失败。我可以避免吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:06:17.703

了解[Google Android](http://code.google.com/p/libphonenumber/)如何执行此任务可能会有所帮助。它与 Google Talk、Facebook、Android 等使用的库相同。

Android 库本身不是 Python，但[概念](https://docs.google.com/presentation/d/1XJtew6w0_k-3oeN_w2edNqRFZgPGrjssSAGup_JLa5k/present#slide=id.i0)仍然存在。有一个积极维护的同一库的并行[Python 端口](https://github.com/daviddrysdale/python-phonenumbers)。

您可以使用它的[Javascript 版本](http://libphonenumber.googlecode.com/svn/trunk/javascript/i18n/phonenumbers/demo.html)来查看它是否符合您的需求。

尝试使用正则表达式稳健地解析一个重要的电话号码是很困难的。有无数种变体。我建议找到并使用一个好的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T01:38:32.513

离开 NullUserException 和 ilya 所说的，这里有一个例子：

### 从用户处读取信息并去掉除数字之外的任何内容：

```
import re
phone_num = raw_input("Phone number. номер телефона\n)

only_nums = int(''.join(re.findall(r'\d', phone_num))) 
```

### 检查 7 或 9 的起始条件：

```
if only_nums[0] == 7 || only_nums[0] == 9:
  print only_nums 
```

# javascript - JQuery DataTables当我们使用分页时如何从表中获取选定的行？

> ID：14321353
> 
> 赞同：2
> 
> 时间：2013-01-14T15:26:27.993
> 
> 标签：javascript, jquery, datatables

例如，我从第二页选择（选中）**2**行，而不是转到第一页并选择**3**行。当我停留在第一页时，我想从**5 个选定的行中获取信息。**

$('tr.row_selected') - 不工作

谢谢。

更新。

我创建了这样的处理程序：

`$('#example').find('tr td.sel-checkbox').live("click", function () { /*code here*/ });`

但是现在当点击事件发生时，表格中的行被隐藏了。我认为它可能是DataTables的排序或分组操作。知道我必须做什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T16:43:05.483

选中复选框时，将所需的行信息作为键值对存储在全局对象中

我不记得具体我以前是怎么做的，但语法类似于

```
$('input[type=checkbox]').click(function()
{
    var row = $(this).parent(); //this or something like it, you want the TR element, it's just a matter of how far up you need to go
    var columns = row.children(); //these are the td elements

    var id = columns[0].val(); //since these are TDs, you may need to go down another element to get to the actual value

    if (!this.checked) //becomes checked (not sure may be the other way around, don't remember when this event will get fired)
    {
        var val1 = columns[1].val();
        var val2 = columns[2].val();

        myCheckValues[id] =[val1,val2]; //Add the data to your global object which should be declared on document ready
    }
    else delete myCheckValues[id];
}); 
```

提交时，从您的对象中获取选定的行：

```
for (var i = 0; i < myCheckValues.length; i++)
... 
```

抱歉，很长时间没有做 JS 了，所以按原样编写代码可能行不通，但你明白了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T17:45:24.797

```
$('#example').find('tr td.sel-checkbox').live("click", function () {
            var data = oTable.fnGetData(this);
            // get key and data value from data object
            var isSelected = $(this).hasClass('row_selected');
            if(isSelected) {
                myCheckValues[key] = value;
                checkedCount++;
            } else {
                delete myCheckValues[key];
                checkedCount--;
            }
        }); 
```

.....提交时

```
if(checkedCount > 0) {
            for(var ArrVal in myCheckValues) {
                var values = myCheckValues[ArrVal];   // manipulate with checked rows values data        
            }
        } 
```

# c# - 使用 RESTful XML Web 服务 API

> ID：14321362
> 
> 赞同：1
> 
> 时间：2013-01-14T15:26:46.047
> 
> 标签：c#, xml, web-services, api, rest

我对网络服务还很陌生，而且还没有用过很多。我需要使用一个来完成我的最新任务。这是一个 XML Web Services API，但我不知道如何与它交互。是否有任何关于在任何地方使用基于 RESTful XML 的 Web 服务 API 的教程/书籍？或者有人可以给我一些指示吗？

我真的不知道从哪里开始或寻找什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:32:16.387

假设您要创建一个 REST API，

这里有一些链接

*   [网](http://www.asp.net/web-api/overview/creating-web-apis)
*   [代码项目教程](http://www.codeproject.com/Articles/426769/Creating-a-REST-service-using-ASP-NET-Web-API)
*   [另一个](http://robbincremers.me/2012/02/16/building-and-consuming-rest-services-with-asp-net-web-api-and-odata-support/)

它基于 ASP.NET MVC 框架，但控制器返回的数据不是视图，而是序列化信息。

网络上到处都有大量的教程和文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:32:31.017

这取决于您可以使用的 .Net 版本。如果 4.0 / 4.5 有 HttpClient 将为您完成繁重的工作。如果较低，您需要考虑自己制作或使用[RestSharp 之](http://restsharp.org/)类的东西。Restful Webservices 本身就是一个表面，这是一个需要概括的大话题。我的建议是通过 restsharp 示例工作，然后返回您遇到的任何具体问题，因为一般性问题会产生一般性答案。

# c# - 如何将企业库缓存大小设置为 1

> ID：14321368
> 
> 赞同：0
> 
> 时间：2013-01-14T15:27:03.337
> 
> 标签：c#, asp.net, enterprise-library

我的 Web 应用程序使用 enterpriseLibrary 缓存

如何将缓存大小设置为 size `n`？

它是对象的计数吗？还是一口大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T17:28:01.760

据我所知，企业库不会为您提供缓存大小或缓存中对象的大小。

您可以阅读以下答案以在 .NET 中查找对象大小：

[找出 .net 对象的大小](https://stackoverflow.com/questions/324053/find-out-the-size-of-a-net-object)

[如何获取内存中的对象大小？](https://stackoverflow.com/questions/605621/how-to-get-object-size-in-memory)

然后在您的 Web 配置文件中，您可以使用以下属性进行配置：

**maximumElementsInCacheBeforeScavenging**

清理意味着如果内存变低，缓存会尝试删除不经常使用或不重要的项目。顾名思义，此设置用于设置清理策略。这定义了从缓存中清除项目之前缓存中元素的最大数量。默认情况下，它是“1000”。

**numberToRemoveWhenScavenging**

numberToRemoveWhenScavenging 设置中定义的移除项目的数量将在清理过程中从缓存中移除。从缓存中移除清理项目的默认值为“10”。

# android - 从 CordovaPlugin 打开一个活动

> ID：14321376
> 
> 赞同：31
> 
> 时间：2013-01-14T15:27:20.120
> 
> 标签：android, cordova, phonegap-plugins

我写了一个 CordavaPlugin 派生类。

```
public class ShowMap extends CordovaPlugin {

@Override
public boolean execute(String action, JSONArray args,
        CallbackContext callbackContext) throws JSONException {

    if (action.compareTo("showMap") == 0)
    {
        String message = args.getString(0); 
        this.echo(message, callbackContext);

        Intent i = new Intent();

        return true;
    }

    return false;
}

private void echo(String message, CallbackContext callbackContext) {
    if (message != null && message.length() > 0) { 
        callbackContext.success(message);
    } else {
        callbackContext.error("Expected one non-empty string argument.");
    }
}

} 
```

我想从这门课上开一个新的活动。如何访问基于 phonegap 的类的原始上下文？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-01-14T15:53:19.423

尝试：

```
 Context context=this.cordova.getActivity().getApplicationContext();
    //or Context context=cordova.getActivity().getApplicationContext();
    Intent intent=new Intent(context,Next_Activity.class);

    context.startActivity(intent);
    //or cordova.getActivity().startActivity(intent); 
```

并确保您已在`AndroidManifest.xml`

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-05-08T21:26:49.207

1.  在 AndroidManifest 文件中注册您的活动
2.  在你的插件中你应该有这样的代码，注意没有“callback.success()”被调用
3.  在 ui 线程而不是后台线程中运行操作。
4.  请享用

    ```
    if (action.equals("myaction")) {
        cordova.getActivity().runOnUiThread(new Runnable() {
            @Override
            public void run() {
                Context context = cordova.getActivity()
                        .getApplicationContext();
                Intent intent = new Intent(context, MyNewActivityGap.class);
                cordova.getActivity().startActivity(intent);
            }
        });

        return true;
    } 
    ```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-29T09:15:09.963

```
Context context =  cordova.getActivity().getApplicationContext();
Intent intent = new Intent(context,Next_Activity.class);

cordova.startActivityForResult(this, intent,0); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-07-05T18:17:45.837

现在在 2017 年发布，因为它是“cordova 插件活动”和投票最多的答案的排名最高的谷歌搜索结果，以及 Cordova 插件指南都缺少以下关键信息，这让我花了很多时间才弄清楚...... config-file的父属性及具体代码：

**添加到plugin.xml，根据你的需要定制：**

```
<!-- separate config-file here targeting AndroidManifest with parent NOT equal to /* -->
<config-file target="AndroidManifest.xml"
    parent="/manifest/application">
    <activity
        android:name=com.custompackage.MyCustomActivity">
    </activity>         
</config-file> 
```

使用上述包和活动更新启动代码：

```
Context context=this.cordova.getActivity().getApplicationContext();
//or Context context=cordova.getActivity().getApplicationContext();
Intent intent=new Intent(context, com.custompackage.MyCustomActivity.class);

context.startActivity(intent);
//or cordova.getActivity().startActivity(intent); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-02T10:06:50.233

我使用了隐式意图让这个功能正常工作

```
 Intent i = new Intent("ACTION_PLAY_VIDEO");
 this.cordova.startActivityForResult((CordovaPlugin) this,i, 0); 
```

不要忘记将意图过滤器放在清单文件中的目标活动中

```
<activity android:name="VideoPlayerActivity" >
       <intent-filter>
            <action android:name="ACTION_PLAY_VIDEO" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter> 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2015-03-16T04:14:27.367

请参阅此示例。

首先，您需要在 config.xml 中声明您的自定义插件。您可以在 res > xml 文件夹中找到此文件。

```
<feature name="CustomPlugin">
      <param name="android-package" value="com.Phonegap.CustomPlugin" />
</feature> 
```

然后你需要使用Java代码实现插件

```
public class CustomPlugin extends CordovaPlugin {

    @Override
    public boolean execute(String action, JSONArray args, CallbackContext callbackContext)
            throws JSONException {

        if (action.equals("sayHello")){
            try {
                String responseText = "Hello world, " + args.getString(0);
                callbackContext.success(responseText);
            } catch (JSONException e){
                callbackContext.error("Failed to parse parameters");
            }
            return true;
        }

        return false;
    }
} 
```

最后我们从 javascript 调用一个插件

```
function initial(){
    var name = $("#NameInput").val();
    cordova.exec(sayHelloSuccess, sayHelloFailure, "CustomPlugin", "sayHello", [name]);
}

function sayHelloSuccess(data){
    alert("OK: " + data);
}

function sayHelloFailure(data){
    alert("FAIL: " + data);
} 
```

# php - PHP Curl中最后一个位置的值？

> ID：14321380
> 
> 赞同：1
> 
> 时间：2013-01-14T15:27:32.207
> 
> 标签：php, curl

在问这个问题之前，我在网站上进行了搜索，但我相信以前没有人问过这个问题；抱歉，如果它已经存在并且我错过了找到它。

我想我想要实现的是有点“奇怪”？

因此，举例来说，我正在将数据发布（或从中获取）数据到一个页面，该页面返回响应以及我希望它遵循的标题中的“位置”。在大多数情况下，这不会有问题，因为我可以从标题中获取“位置”值，然后按照它进行操作。

但是，请考虑这种情况：我从中获取数据的网站/页面正在向我发送 Location 标头，并且生成的重定向还有另一个“Location”标头。这是随机的，一些重定向会在 2 次重定向后给我预期的文件，其他重定向会在 4 次左右之后给我预期的文件。

我绝对需要记录发送给我的最新（最后）“位置”值。我怎么做？我目前将 PHP Curl 的跟随位置设置为“开启”，因此它会自动跟随任何/所有位置，而无需我干预。既然这样做了，我如何获取它所遵循的最后一个位置的值？

例如，我使用 php curl 将数据发布到网站 A。来自网站 A 的回复包含指向网站 B 的“位置”重定向。PHP Curl 紧随其后。网站 B 有一个“位置”重定向，再次指向网站 C。PHP Curl 自动跟随它。然后网站 C 有一个“位置”重定向到网站 D。PHP Curl 像以前一样自动跟随它。然后，网站 D 将我想要下载的实际文件发送给我。

由于 PHP Curl 自动跟随“位置”，我如何获取最后一个位置值？在上面的示例中，我将如何获取网站 C 中的“位置”值，这是到达最终目的地网站 D 之前的最后一个值？

抱歉，如果我不够清楚，我已尽力解释我想做什么；只是情况有点难以形容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:53:54.440

你在寻找这样的东西吗？

```
$last_url = curl_getinfo($ch, CURLINFO_EFFECTIVE_URL); 
```

`curl_getinfo()`你可以在这里找到文档[http://www.php.net/manual/en/function.curl-getinfo.php](http://www.php.net/manual/en/function.curl-getinfo.php)

当我第二次阅读您的问题时，我的答案可能不是最终解决方案，但您可以从最后一个位置获取 HTTP 标头信息并获取`HTTP_REFERER`. 我没有这方面的例子，但这可能是您获得所需信息的一种方式。

# ruby-on-rails - attr_accessor 在 Ruby on Rails 中如何工作

> ID：14321383
> 
> 赞同：0
> 
> 时间：2013-01-14T15:27:37.370
> 
> 标签：ruby-on-rails, ruby

> **可能重复：**
> [Ruby 中的 attr_accessor 是什么？](https://stackoverflow.com/questions/4370960/what-is-attr-accessor-in-ruby)

这是示例代码：

```
class User
  attr_accessor :name, :email

  def initialize(attributes = {})
    @name = attributes[:name]
    @email = attributes[:email] 
  end 

....

end 
```

当我做

```
example = User.new 
```

它会创建一个空用户，我可以通过以下方式分配其名称和电子邮件

```
example.name = "something"
example.email = "something" 
```

我的问题是，为什么这东西有效？计算机如何知道 example.name 表示类中的 @name 变量？我假设 name 和 :name 是不同的，并且在代码中我们没有明确告诉计算机 example.name 等同于 :name 符号。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T15:31:16.793

它的作用是`attr_accessor`创建几个方法，一个 getter 和一个 setter。它使用您传递的符号来构造方法和实例变量的名称。看，这段代码：

```
class User
  attr_accessor :name
end 
```

相当于这段代码

```
class User
  def name
    @name
  end

  def name=(val)
    @name = val
  end
end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-14T15:31:26.473

`attr_accessor :field`与调用`attr_reader :field`and相同`attr_writer :field`。反过来，它们大致等于：

```
def field
  @field
end

def field=(value)
  @field = value
end 
```

欢迎来到元编程的魔力。;)

# c# - 如何仅制作 RichTextBox 文本？

> ID：14321385
> 
> 赞同：5
> 
> 时间：2013-01-14T15:27:41.720
> 
> 标签：c#, .net, visual-studio-2008, richtextbox

> **可能重复：**
> [如何防止richTextBox 在其中粘贴图像？](https://stackoverflow.com/questions/9511984/how-to-prevent-richtextbox-to-paste-images-within-it)

如果您正在使用`Richtextbox`，则有几个优点，`Richtextbox`例如：

> 我们可以在上面使用彩色字体
> 
> 在区域中设置自定义字体
> 
> 在上面附加文件..等

看一下图片： ![在此处输入图像描述](../Images/dc9cf9e7865ad6a552922fa81cd51d66.png)

这是我的问题：

**我可以把它只写成文字吗？**

在我的项目中，根本不需要附加文件等。我什至不想在上面附加或粘贴图像，我只想要**“纯文本**”`Richtextbox`

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-14T15:35:17.317

由于 RichTextBox 没有图像或对象集合，因此您必须使用 RTF 格式代码。RichTextBox 的所有数据都存储为带有特殊格式代码的纯文本，这由控件通过其 RTF 属性公开。如果您想阅读或更改此代码语言，学习此代码语言是必不可少的，学习资源可在整个网络上轻松获得，例如，请参阅此概述。RichTextBox 使用比 MS Word 等几个全功能编辑器更简化的 rtf 代码，因此在操作之前将数据加载到 RTB 通常是有益的，这将删除很多冗余数据。

长话短说，我发现有必要搜索以“pict”或“object”命令开头的 rtf 组。知道组可能是嵌套的，您不能只从那里找到第一个端组字符，您必须逐个字符地解析字符串，同时保持分组计数以找到这些组的末尾。现在您有足够的信息来删除字符串的那部分。Rtf 可能包含多个图片/对象组，因此您必须这样做，直到全部删除。这是删除这些组后返回 rtf 字符串的示例函数：

```
private string removeRtfObjects(string rtf)
{
    //removing {\pict or {\object groups
    string pattern = "\\{\\\\pict|\\{\\\\object";
    Match m = Regex.Match(rtf, pattern);
    while (m.Success) {
        int count = 1;
        for (int i = m.Index + 2; i <= rtf.Length; i++) {
            //start group
            if (rtf(i) == '{') {
                count += 1;
            //end group
            } else if (rtf(i) == '}') {
                count -= 1;
            }
            //found end of pict/object group
            if (count == 0) {
                rtf = rtf.Remove(m.Index, i - m.Index + 1);
                break; // TODO: might not be correct. Was : Exit For
            }
        }
        m = Regex.Match(rtf, pattern);
        //go again
    }
    return rtf;
} 
```

什么时候应该这样做？您已经提到了粘贴，还有插入，这些可以被 KeyDown 事件捕获，您可以在其中获取剪贴板信息并相应地处理它。当您自己处理操作时设置 e.Handled=True 表示控件不应对此组合键执行任何默认处理。这也是您在不破坏用户剪贴板的情况下阻止粘贴图像的方式。例子：

```
private void RichTextBox1_KeyDown(object sender, System.Windows.Forms.KeyEventArgs e)
{
    //aware of Paste or Insert
    if (e.Control && e.KeyCode == Keys.V || e.Shift && e.KeyCode == Keys.I) {
        if (Clipboard.ContainsImage || Clipboard.ContainsFileDropList) {
            //some images are transferred as filedrops
            e.Handled = true;
            //stops here
        } else if (Clipboard.ContainsData(DataFormats.Rtf)) {
            RichTextBox rtbox = new RichTextBox();
            //use a temp box to validate/simplify
            rtbox.Rtf = Clipboard.GetData(DataFormats.Rtf);
            this.RichTextBox1.SelectedRtf = this.removeRtfObjects(rtbox.Rtf);
            rtbox.Dispose();
            e.Handled = true;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-14T15:37:39.473

Yes, it is possible.

Handle Ctrl+V in RichTextBox1_KeyDown, then check the data format in the Clipboard: if data is plain text, paste it; if data is RTF, convert it to plain text (in a buffer without changing the Clipboard content) and paste it; don't paste any other type of data.

This is a partial example just to show you how to proceed:

```
private void richTextBox1_KeyDown(object sender, KeyEventArgs e) 
{ 
    if (e.Control && e.KeyCode == Keys.V)  
    { 
            // suspend layout to avoid blinking
            richTextBox2.SuspendLayout();

            // get insertion point
            int insPt = richTextBox2.SelectionStart;

            // preserve text from after insertion pont to end of RTF content
            string postRTFContent = richTextBox2.Text.Substring(insPt);

            // remove the content after the insertion point
            richTextBox2.Text = richTextBox2.Text.Substring(0, insPt);

            // add the clipboard content and then the preserved postRTF content
            richTextBox2.Text += (string)Clipboard.GetData("Text") + postRTFContent;

            // adjust the insertion point to just after the inserted text
            richTextBox2.SelectionStart = richTextBox2.TextLength - postRTFContent.Length;

            // restore layout
            richTextBox2.ResumeLayout();

            // cancel the paste
            e.Handled = true;
    } 
} 
```

# google-app-engine - 导入 ndb Key 类方法失败：Eclipse-PyDev 中的 from_old_key

> ID：14321386
> 
> 赞同：2
> 
> 时间：2013-01-14T15:27:43.830
> 
> 标签：google-app-engine, python-2.7, importerror, app-engine-ndb

我尝试在 Eclipse / PyDev 中使用：

```
from google.appengine.ext import db, ndb

ndb_key = ndb.Key.from_old_key(db_entity.key())  # but the import gives an error 
```

Pydev 错误：来自导入的未定义变量：from_old_key

但是当我部署应用程序（包括导入错误）时，它工作正常。

我的临时解决方案：

```
import google.appengine.ext.ndb.key as ndbkey

ndb_key = ndbkey.Key.from_old_key(db_entity.key()) 
```

# python - 二维数组中索引对之间的总和

> ID：14321390
> 
> 赞同：10
> 
> 时间：2013-01-14T15:28:00.850
> 
> 标签：python, numpy, sum, multidimensional-array

抱歉，如果没有得到答案，我不知道重新提出问题的协议。几个月前在这里问过这个问题：[Numpy sum between pairs of indices in 2d array](https://stackoverflow.com/questions/13476450/numpy-sum-between-pairs-of-indices-in-2d-array)

我有一个 2-d numpy 数组 (MxN) 和另外两个 1-d 数组 (Mx1)，它们代表我想要总结的 2-d 数组的每一行的开始和结束索引。我正在寻找在大型数组中执行此操作的最有效方法（最好不必使用循环，这是我目前正在做的）。我想做的一个例子如下。

```
>>> random.seed(1234)
>>> a = random.rand(4,4)
>>> print a
[[ 0.19151945  0.62210877  0.43772774  0.78535858]
 [ 0.77997581  0.27259261  0.27646426  0.80187218]
 [ 0.95813935  0.87593263  0.35781727  0.50099513]
 [ 0.68346294  0.71270203  0.37025075  0.56119619]]
>>> b = array([1,0,2,1])
>>> c = array([3,2,4,4])
>>> d = empty(4)
>>> for i in xrange(4):
    d[i] = sum(a[i, b[i]:c[i]]) 

>>> print d
[ 1.05983651  1.05256841  0.8588124   1.64414897] 
```

我的问题类似于以下问题，但是，我认为那里提出的解决方案不会非常有效。[Numpy sum of values in subarrays between the pairs of indices](https://stackoverflow.com/questions/7471474/numpy-sum-of-values-in-subarrays-between-pairs-of-indices)在那个问题中，他们想要找到同一行的多个子集的总和，所以`cumsum()`可以使用。但是，我每行只会找到一个总和，所以我认为这不是计算总和的最有效方法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-14T17:36:18.013

**编辑**到目前为止为所有答案添加了计时结果，包括下面@seberg评论之后的OP代码，并且OP的方法是最快的：

```
def sliced_sum_op(a, b, c) :
    d = np.empty(a.shape[0])
    for i in xrange(a.shape[0]):
        d[i] = np.sum(a[i, b[i]:c[i]]) 
    return d 
```

* * *

您仍然可以通过`np.cumsum` ~~很大的速度提升~~来完成它，尽管它需要与原始数组大小相等的存储空间：

```
def sliced_sum(a, b, c) :
    cum = np.cumsum(a, axis=1)
    cum = np.hstack((np.zeros((a.shape[0], 1), dtype=a.dtype), cum))
    rows = np.arange(a.shape[0])
    return cum[rows, c] - cum[rows, b] 
```

~~时序对您的阵列具有欺骗性，因为对于小阵列大小，您的方法实际上比这个方法略快。但是 numpy 很快就赢得了胜利，~~请参见下图以了解 size 的随机方形数组的时序`(n, n)`：

![在此处输入图像描述](../Images/91bfef105d747b24399900c5214ed482.png)

以上是用

```
import timeit
import matplotlib.pyplot as plt

n = np.arange(10, 1000, 10)
op = np.zeros(n.shape[0])
me = np.zeros(n.shape[0])
th = np.zeros(n.shape[0])
jp = np.zeros(n.shape[0])
for j, size in enumerate(n) :
    a = np.random.rand(size, size)
    b, c = indices = np.sort(np.random.randint(size + 1,
                                               size=(2, size)), axis=0)
    np.testing.assert_almost_equal(sliced_sum_op(a, b, c),
                                   sliced_sum(a, b, c))
    np.testing.assert_almost_equal(sliced_sum_op(a, b, c),
                                   sum_between2(a, b, c))
    np.testing.assert_almost_equal(sliced_sum_op(a, b, c),
                                   sum_between_mmult(a, b, c))

    op[j] = timeit.timeit('sliced_sum_op(a, b, c)',
                          'from __main__ import sliced_sum_op, a, b, c',
                          number=10)
    me[j] = timeit.timeit('sliced_sum(a, b, c)',
                          'from __main__ import sliced_sum, a, b, c',
                          number=10)
    th[j] = timeit.timeit('sum_between2(a, b, c)',
                          'from __main__ import sum_between2, a, b, c',
                          number=10)
    jp[j] = timeit.timeit('sum_between_mmult(a, b, c)',
                          'from __main__ import sum_between_mmult, a, b, c',
                          number=10)
plt.subplot(211)
plt.plot(n, op, label='op')
plt.plot(n, me, label='jaime')
plt.plot(n, th, label='thorsten')
plt.plot(n, jp, label='japreiss')
plt.xlabel('n')
plt.legend(loc='best')
plt.show() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T19:23:40.590

我喜欢@Jaime 的回答，但这是另一种方法。您可以将问题重铸为矩阵乘法。

如果乘以`a`一个全为 1 的向量，则输出向量的每个元素都将包含 的对应行的总和`a`。为了得到`d`你需要的，你可以屏蔽掉从每一行中排除的元素，然后乘以一个所有的向量来得到`d`。

```
def sum_between_mmult(ar, b, c):
    copy = np.copy(ar)
    nrows = ar.shape[0]
    ncols = ar.shape[1]
    for i in range(nrows):
        copy[i, :b[i]] = 0
        copy[i, c[i]:] = 0
    onevec = np.ones(ncols)
    return np.dot(copy, onevec) 
```

和@Jaime 一样，我只看到了更大矩阵大小的加速。我觉得某种花哨的索引技巧可以摆脱`for`循环并提供更大的加速。如果您不需要原始数组，则可以覆盖它而不是制作副本，但这在我的测试中并没有产生太大的加速。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-14T16:06:17.787

我有另一种计算结果的方法，它有效且不使用循环 - 但它并不比循环方法快。

```
import time
import numpy as np

def sum_between1(ar, idc_l, idc_u):
    d = np.empty(ar.shape[0])
    for i in xrange(ar.shape[0]):
        d[i] = sum(ar[i, b[i]:c[i]]) 
    return d

def sum_between2(ar, idc_l, idc_u):
    indices = np.arange(ar.shape[1]).reshape(1,-1).repeat(ar.shape[0], axis=0)
    lower = idc_l.reshape(-1,1).repeat(ar.shape[1], axis=1)    
    upper = idc_u.reshape(-1,1).repeat(ar.shape[1], axis=1)
    mask = ~((indices>=lower) * (indices<upper))
    masked = np.ma.MaskedArray(ar, mask)
    return masked.sum(axis=1)

np.random.seed(1234)
a = np.random.rand(4,4)
print a
b = np.array([1,0,2,1])
c = np.array([3,2,4,4])

t0 = time.time()
for i in range(100000):
    d1 = sum_between1(a,b,c)
print "sum_between1: %.3f seconds" % (time.time()-t0)
print d1

t0 = time.time()
for i in range(100000):
    d2 = sum_between2(a,b,c)
print "sum_between2: %.3f seconds" % (time.time()-t0)
print d2 
```

我的输出是

```
 [[ 0.19151945  0.62210877  0.43772774 ...,  0.92486763  0.44214076
   0.90931596]
 [ 0.05980922  0.18428708  0.04735528 ...,  0.53585166  0.00620852
   0.30064171]
 [ 0.43689317  0.612149    0.91819808 ...,  0.18258873  0.90179605
   0.70652816]
 ..., 
 [ 0.70568819  0.76402889  0.34460786 ...,  0.6933128   0.07778623
   0.4040815 ]
 [ 0.51348689  0.80706629  0.09896631 ...,  0.91118062  0.87656479
   0.96542923]
 [ 0.20231131  0.72637586  0.57131802 ...,  0.5661444   0.14668441
   0.09974442]]
sum_between1: 2.263 seconds
[ 1.05983651  0.24409631  1.54393475  2.27840642  1.65049179  1.86027107
  0.74002457  0.91248001  1.29180203  1.03592483  0.30448954  0.78028893
  1.15511632  1.74568981  1.0551406   1.73598504  1.32397106  0.22902658
  0.77533999  2.11800627  1.09181484  0.92074516  1.04588589  2.07584895
  1.13615918  1.33172081  1.41323751  2.01996291  1.69677797  0.57592999
  1.18049304  1.13052798  0.90715138  0.63876336  1.76712974  1.15138181
  0.29005541  1.46971707  0.57149804  1.8816212 ]
sum_between2: 1.817 seconds
[1.05983651005 0.244096306594 1.54393474534 2.27840641818 1.65049178537
 1.86027106627 0.740024568268 0.91248000774 1.29180203183 1.03592482812
 0.304489542783 0.78028892993 1.1551163203 1.74568980609 1.05514059758
 1.73598503833 1.32397105753 0.229026581839 0.77533999391 2.11800626878
 1.09181484127 0.92074516366 1.04588588779 2.07584895325 1.13615918351
 1.33172081033 1.41323750936 2.01996291037 1.69677797485 0.575929991717
 1.18049303662 1.13052797976 0.907151384823 0.638763358104 1.76712974497
 1.15138180543 0.290055405809 1.46971707447 0.571498038664 1.88162120474] 
```

我发布此答案是因为也许其他人可能知道如何改进我的方法以使其更快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T02:49:40.933

这大约快 25%：

```
def zip_comp(a,b,c):
    return [np.sum(aa[bb:cc]) for aa, bb, cc in zip(a,b,c)] 
```

如果您能够重构早期的代码，而不是为切片生成两个列表，而是生成一个二进制二维数组，那么您可以使用@japreiss 方法的后半部分或类似的方法获得非常显着的收益。所有这些方法的放缓是花在疯狂索引上的时间。

速度比较，使用 Jaime 的代码：

![在此处输入图像描述](../Images/ae47856067923b13eab74c5645ba092b.png)

# printing - Extjs 4.1.1 - 打印/导出整个网格

> ID：14321392
> 
> 赞同：1
> 
> 时间：2013-01-14T15:28:21.150
> 
> 标签：printing, export-to-excel, extjs4.1

有没有办法将整个网格导出到 excel 表或将其发送到所有页面打印？我在文档中找不到我需要的东西。

# kendo-ui - Kendo UI 网格 - 用于编辑和创建的不同模板

> ID：14321396
> 
> 赞同：5
> 
> 时间：2013-01-14T15:28:27.607
> 
> 标签：kendo-ui

我们正在使用 Kendo UI 网格来显示一些记录。当用户单击“编辑”时，要求我们需要将一列（例如“文件名”）显示为文本框。但是，当用户单击工具栏中的“创建”按钮时，应将同一列替换为文件选择控件，该控件将允许用户从他的机器中选择文件。其他列保持不变。我已经尝试通过 Stack Overflow 以及 Kendo UI Grid 论坛进行搜索，但无济于事。有什么办法可以做到这一点？任何指针都会有很大帮助。

问候， 尼基尔

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-14T15:53:02.480

不支持使用不同的编辑器模板进行创建/编辑。您需要使用 Grid 的[编辑](http://docs.kendoui.com/api/web/grid#edit)事件将文本输入更改为使用 JavaScript 的文件输入。要区分编辑和创建，您可以使用模型的 isNew() 方法。IE

```
edit:function(e){
      if(e.model.isNew()){
          //replacement logic
      }
 } 
```

[此处](https://stackoverflow.com/questions/13393443/kendo-ui-how-to-make-specifc-fields-readonly-on-edit-while-on-create-its-edita)涵盖了类似的问题。

# ruby-on-rails - 在 Unicorn + Rails 应用程序中处理长请求

> ID：14321400
> 
> 赞同：2
> 
> 时间：2013-01-14T15:28:52.613
> 
> 标签：ruby-on-rails, web-services, node.js, nginx, unicorn

我们有一个在 Unicorn（2 个 worker）和 nginx 上运行的 Rails 应用程序。我们希望集成一个第 3 方 API，其中处理单个请求需要 1 到 20 秒。如果我们只是创建一个新的控制器来代理该服务，整个应用程序都会受到影响，因为只需要 2 个人通过我们的 API 向该服务发出请求，并且在 20 秒内其余用户无法访问我们的其余部分应用程序。

我们正在考虑两种解决方案。

1.  创建一个单独的 node.js 服务器，它将执行对 3rd 方 API 的所有请求。在这种情况下，我们只会使用 Rails 进行身份验证/授权，并且我们会使用 X-Accel-Redirect 标头通过 nginx 将请求重定向到节点（如此处所述[http://blog.bitbucket.org/2012/08/24/隔离服务/](http://blog.bitbucket.org/2012/08/24/segregating-services/)）
2.  用瘦或彩虹替换独角兽！并继续在我们的 Rails 应用程序中进行代理，然后大概可以让我们处理更多的并发连接。

哪种解决方案可能会更好？或者还有什么我们可以做的。

我个人认为节点偶数循环更适合这里的工作，因为在选项 2 中，我们仍然会阻塞许多线程并等待 HTTP 请求完成，而在选项 1 中，我们可能会在等待慢速的同时执行更多请求那些要完成的。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-31T11:07:56.337

我们已经`X-Accel-Redirect`在生产中使用该解决方案一段时间了，它运行良好。

在服务器下的 nginx 配置中，我们有外部服务的条目（在我们的例子中是用 node.js 编写的），例如

```
server {
  ...
  location ^~ /some-service {
    internal;
    rewrite ^/some-service/(.*)$ /$1 break;
    proxy_pass http://location-of-some-service:5000;
  }
} 
```

在 Rails 中，我们对请求进行身份验证和授权，当我们想将其传递给其他服务时，在控制器中我们执行类似的操作

```
headers['X-Accel-Redirect'] = '/some-service'
render :nothing => true 
```

现在，rails 完成了对请求的处理并将其交还给 nginx。Nginx 看到`x-accel-redirect`标头并将请求重播到新的 url -`/some-service`我们配置为代理到我们的 node.js 服务。Unicorn 和 rails 现在可以处理新请求，即使 node.js+nginx 仍在处理原始请求。

通过这种方式，我们使用 Rails 作为我们应用程序的主要入口点和看门人——这就是身份验证和授权发生的地方。但是，在更合适的时候，我们能够将很多功能转移到这些更小的、独立的 node.js 服务中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:37:32.017

您可以`EventMachine`在现有的 Rails 应用程序中使用，这意味着更少的重写。`net/http`您可以向`EM::HttpRequest`API 发出请求并添加回调，而不是向 API 发出请求。这类似于 node.js 选项，但不需要特殊的服务器 IMO。

# java - 二维码的黑白主题是标准吗？

> ID：14321407
> 
> 赞同：6
> 
> 时间：2013-01-14T15:29:19.083
> 
> 标签：java, android, ios, standards, qr-code

我正在开发一个 QR 码生成器，想了解除了黑白之外，是否可以为 QRC 图像设置不同的颜色组合？

它会导致可以存储的数据量或纠错级别有任何差异吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-14T15:31:28.453

没有硬性规定——您可以拥有其他颜色的 QR 码，前提是深色和浅色之间的对比度足以被解释。可以存储的数据量或任何纠错的可能性没有差异，只是能够将黑暗与光明分开以进行解码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-14T15:32:12.057

是的，您可以使用其他颜色。但黑/白提供最佳对比度，因此您获得最佳效果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-14T15:37:12.460

普通的二维码应用程序（如 Zxing）会在扫描二维码之前将图像转换为灰度图像。
所以你可以使用任何你想要的颜色，只要确保你的颜色之间的对比尽可能强烈。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-14T15:34:29.827

是的，您可以使用颜色（例如，请参阅[QR 码的维基百科文章](http://en.wikipedia.org/wiki/QR_code#Error_correction)），您甚至可以[使用您的 QR 码进行转角和其他艺术创作](http://archive.is/20120710/http://mashable.com/2011/04/18/qr-code-design-tips/)。

您可以存储相同数量的数据，但我怀疑黑白会给您更好的工作机会（因为它提供了最佳对比度）。

# javascript - 为 Kendo UI Grid 设置默认过滤器

> ID：14321414
> 
> 赞同：9
> 
> 时间：2013-01-14T15:29:36.753
> 
> 标签：javascript, kendo-ui, kendo-grid

我有一个用 javaScript 呈现的 Kendo UI 网格。我希望字符串列有一个选项（“包含”）并且没有第二个过滤器。到目前为止一切顺利，我写了

```
 $("#MyGrid").kendoGrid({
            // other bits of configuration here
            filterable: {
                extra:false, 
                operators: {
                    string:{ contains: "Contains"}
                }
            },
            // more bits of configuration here
        }); 
```

作为网格定义的一部分。结果看起来不错（我只有一个选项，所以下拉菜单是多余的）。

![按我定义的过滤器](../Images/274c9d723ecf79764988e2e0cd1a0af9.png)

然而，不管怎样，过滤器仍然执行等于操作而不是包含操作（这是它唯一可用的操作）。

我花了一段时间试图弄清楚这一点，我一直在绕圈子，因为我发现的代码要么不起作用，要么没有意义，或者两者兼而有之。

谁能告诉我如何将过滤器默认为“包含”而不是“等于”？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-23T20:04:14.040

当您只有一个选项或者您对布局不满意时，您可以使用更高版本的 Kendo（例如 v2013.1.319）中存在的“ui : func( element ) { }”重载完全自定义过滤器控件

```
columns : [
    { field: "MyCity", width: 80, title : "City", filterable: customTextFilter },
    { field: "CreatedAt", width: 72, title: "Created", filterable: $scope.customDateFilter }
] 
```

下面是自定义外观的函数：

```
var customTextFilter =
    {
        extra : false,
        operators : { string : { contains : "Contains"}},
        ui : function( element )
        {
            var parent = element.parent();
            while( parent.children().length > 1 )
                $(parent.children()[0]).remove( );

            parent.prepend( "<input data-bind=\"value:filters[0].value\" class=\"k-textbox\" type=\"text\">" );
        }
    } 
```

下面是一个有两个 GTE/LTE 格式的日期框的例子：

```
var customDateFilter =
    {
        extra : true,
        operators : { },
        ui : function( element )
        {
            var parent = element.parent();
            while( parent.children().length > 1 )
                $(parent.children()[0]).remove( );

            parent.prepend(
                "On or after:<br/><span class=\"k-widget k-datepicker k-header\">" +
                "<span class=\"k-picker-wrap k-state-default\">" +
                "<input data-bind=\"value:filters[0].value\" class=\"k-input\" type=\"text\" data-role=\"datepicker\"" +
                " style=\"width: 100%\" role=\"textbox\" aria-haspopup=\"true\" aria-expanded=\"false\" aria-disabled=\"false\" " +
                " aria-readonly=\"false\" aria-label=\"Choose a date\">" +
                "<span unselectable=\"on\" class=\"k-select\" role=\"button\">" +
                "<span unselectable=\"on\" class=\"k-icon k-i-calendar\">select</span></span></span></span>" +

                "<br/>On or before:<br/>" +
                "<span class=\"k-widget k-datepicker k-header\"><span class=\"k-picker-wrap k-state-default\">" +
                "<input data-bind=\"value: filters[1].value\" class=\"k-input\" type=\"text\" data-role=\"datepicker\"" +
                " style=\"width: 100%\" role=\"textbox\" aria-haspopup=\"true\" aria-expanded=\"false\" " +
                " aria-disabled=\"false\" aria-readonly=\"false\" aria-label=\"Choose a date\">" +
                "<span unselectable=\"on\" class=\"k-select\" role=\"button\">" +
                "<span unselectable=\"on\" class=\"k-icon k-i-calendar\">select</span></span></span></span>"
            );
        }
    }; 
```

显然，您可以根据自己的喜好进行模板化，并为日期、布尔值等创建不同的自定义过滤器 - 请注意，对于上面的日期版本，如果您想正确设置运算符，为过滤器 [0] 说出“gte”和“lte” .operator 和 filter[1].operator 你可以像这样在 dataSource.filter 属性上设置它：

```
 dataSource: {
        transport :
        {
            read : function( context )
            {
                //note that here context.filter.filters has the array
                //of applied filters -- you can write a custom RESTful call
                //such as angular $http.get( ) or use Kendo native format to
                //send filter options to server.
            }
        },
        //filter settings here initialize filter[0], filter[1], etc.
        filter : [ 
           { field : "CreatedAt", operator : "gte" },
           { field : "CreatedAt", operator : "lte" }]
   } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-10-31T07:37:30.317

更改***所有***实例的默认运算符的最佳方法：

```
kendo.ui.FilterMenu.prototype.options.operators =           
  $.extend(kendo.ui.FilterMenu.prototype.options.operators, {
  string: {
      contains: "Contains",
      startswith: "Starts with",
      eq: "Is equal to",
      neq: "Is not equal to",
      doesnotcontain: "Does not contain",
      endswith: "Ends with"
  }
}); 
```

和完整的脚本：

```
kendo.ui.FilterMenu.prototype.options.operators =           
  $.extend(kendo.ui.FilterMenu.prototype.options.operators, {

/* FILTER MENU OPERATORS (for each supported data type) 
 ****************************************************************************/   
  string: {
      contains: "Contains",
      startswith: "Starts with",
      eq: "Is equal to",
      neq: "Is not equal to",
      doesnotcontain: "Does not contain",
      endswith: "Ends with"
  },
  number: {
      eq: "Is equal to",
      neq: "Is not equal to",
      gte: "Is greater than or equal to",
      gt: "Is greater than",
      lte: "Is less than or equal to",
      lt: "Is less than"
  },
  date: {
      eq: "Is equal to",
      neq: "Is not equal to",
      gte: "Is after or equal to",
      gt: "Is after",
      lte: "Is before or equal to",
      lt: "Is before"
  },
  enums: {
      eq: "Is equal to",
      neq: "Is not equal to"
  }
 /***************************************************************************/   
}); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-14T17:23:20.883

尝试更新到最新的内部版本。高于**2012.3.1304**的版本应该包含修复。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-09-13T09:02:09.160

我有同样的问题，我明白了，它需要**.Clear()**选项！

我正在使用 Razor 中的 MVC Wrapper 构建我的网格：

```
@(Html.Kendo().Grid<LocationViewModel>()
    .Name("locationGrid")
    // other bits of configuration here
    .ColumnMenu()
    .Filterable(f => f.Operators(o => o.ForString(s => s
        .Clear()
        .Contains("Contains")
        .DoesNotContain("Does not contain")
        .EndsWith("Ends with")
    )))
    // other bits of configuration here
) 
```

**概括：**

1.  **.Clear()**是必需的！
2.  **排序**是必须的！`.Contains()`先放，`.Clear()`然后默认是包含！

**附加信息：** 我正在使用 Kendo UI 2013.1.514

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-22T21:51:44.843

可过滤：{运算符：{数字：{gte：“大于或等于”}}}

# html - HTML 表格数据太宽

> ID：14321420
> 
> 赞同：-2
> 
> 时间：2013-01-14T15:29:56.693
> 
> 标签：html, html-table, cell

我在 HTML 中创建了一个简单的表格，但是表格中的“地址”单元格非常宽，但我所做的只是给它一个标题并输入一个数字。

![查看地址栏 - 它太宽了](../Images/7bc2ec801d02da215150a9ed9c5015dc.png)

地址栏的代码很简单：

```
<TH>Address</TH><TH>Literal  etc 
```

然后添加数据：

```
<TD valign=baseline>0x110</TD> 
```

但是地址栏是巨大的。我没有设置样式表。我只想要一个小的“地址”单元格！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T15:35:34.087

看来您没有提供所有代码。从您的屏幕截图来看，这似乎`CLOCK_OUTPUTS_PARAMS_SUBBLOCK_PPS PARAMETERS`是造成这种情况的原因。您可能需要在`colspan`该单元格中添加一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:33:57.267

重新查看您发布的照片​​后。这个标题与这个差距非常接近，这是一个巧合。我认为您可能遇到的一个错误是将时钟放入表格标题中，并且在显示其他标题之前没有破坏表格行。你用了 Clock_.....Address 吗？因为如果是这样，这可以解决您的问题：

```
<tr><th colspan=7 align='left'>Clock_...</th></tr>
<tr><th>Address</th><th>Literal</td> //etc 
```

要重新调整单元格的大小，只需添加一个宽度属性（确保将其添加到最左侧列中的每个单元格）。

```
<TD width=20 valign=baseline>0x110</TD> 
```

如果这不起作用，您可以使用 CSS 来设置它们的样式。您可以通过在您的网页中添加此样式来做到这一点。然后将 class='left_col' 添加到每个最左边的列单元格中。

```
<style>
.left_col {
max-width:20px;
}
<style>

<TD class='left_col' valign=baseline>0x110</TD> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T16:11:56.947

如果`CLOCK_OUTPUTS_PARAMS_SUBBLOCK_PPS PARAMETERS`是表格的标题，则应将其放在`<caption>`元素中而不是表格单元格中。

```
<table>
    <caption>CLOCK_OUTPUTS_PARAMS_SUBBLOCK_PPS PARAMETERS</caption>
    <tbody>
        <tr> (rest of table...) 
```

# powershell - 仅向用户输出 TRUE 结果

> ID：14321426
> 
> 赞同：0
> 
> 时间：2013-01-14T15:30:21.587
> 
> 标签：powershell, powershell-2.0

Christian 在下面帮助了我，我也对其进行了一些更改以检查密钥的值。无论如何，我现在遇到的问题仍然是基于我提供给用户的输出。我不想显示键名，而是显示键的值。

键的值基于已发现为 TRUE 的键（在下面的代码中）。

因此，如果下面的结果对键 1（键的值为 ONE）、2（键的值为 2）和 3（键的值为 3）为 TRUE，那么我如何将 WRITE-HOST 置于基于用户的用户仅在特定键上找到？

即，当特定情况下的所有参数都为 TRUE 时，我希望提供的结果具有以下输出之一。

```
Write-Host "The value of the keys are $keyvalue1"

Write-Host "The value of the keys are $keyvalue1 and $keyvalue2"

Write-Host "The value of the keys are $keyvalue1 and $keyvalue2 and $keyvalue3"

Write-Host "The value of the keys are $keyvalue1 and $keyvalue2 and $keyvalue3 and $keyvalue4" 
```

这是代码：

```
$keyvalue1 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 1).'1'
$keyvalue2 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 2).'2'
$keyvalue3 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 3).'3'
$keyvalue4 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 4).'4'

$testpath1 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 1).'1' -ne $null 2>$null
$testpath2 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 2).'2' -ne $null 2>$null
$testpath3 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 3).'3' -ne $null 2>$null
$testpath4 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 4).'4' -ne $null 2>$null

 $a = $testpath1, $testpath2 , $testpath3 , $testpath4 # convert your true/false results in an array
$s = "" # empty string
$i = 1 # a simple variable as index
foreach ($b in $a)
 {
   if ($b -ne $true ) 
   { 
     break
   } 

   $s += "$i " # if true add index in string
   $i++
}

"$($s)is/are true" #output the result 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T16:46:46.717

为什么要重复 Get-ItemProperty 调用？您已经拥有存储在 $keyvalue 中的值（或缺少值）。您应该能够将其简化为如下所示：

```
$keyVals = @()
$keyVals += (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 1).1
$keyVals += (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 2).2
$keyVals += (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 3).3
$keyVals += (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 4).4

Write-Host "The value of keys are " -NoNewLine
$first = $true
foreach ($keyVal in $keyVals) {
    if ($keyVal -ne $null) {
        if (!$first) { 
            Write-Host " and " -NoNewLine 
        }
        $first = $false
        Write-Host $keyVal -NoNewLine
    }
}
Write-Host 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:41:00.027

试试这个（未测试）：

```
$keyvalue1 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 1).'1'
$keyvalue2 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 2).'2'
$keyvalue3 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 3).'3'
$keyvalue4 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 4).'4'
$testpath1 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 1).'1' -ne $null 2>$null
$testpath2 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 2).'2' -ne $null 2>$null
$testpath3 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 3).'3' -ne $null 2>$null
$testpath4 = (Get-ItemProperty hklm:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\$CommunityName -Name 4).'4' -ne $null 2>$null

 $a = $testpath1, $testpath2 , $testpath3 , $testpath4 # convert your true/false results in an array

$v = $keyvalue1,$keyvalue2,$keyvalue2,$keyvalue4 
$s = "The value of the keys are " # empty string
$i = 1 # a simple variable as index
foreach ($b in $a)
 {
   if ($b -ne $true ) 
   { 
     break
   } 

   $s += "$($v[$i]) " # if true add value of $v[index] in string
   $i++
}

"$s" #output the result 
```

# javascript - 将元素 ID 与元素对象引用存储到变量中

> ID：14321427
> 
> 赞同：0
> 
> 时间：2013-01-14T15:30:32.330
> 
> 标签：javascript, performance, variables, memory-management

我正在编写一个库，我需要在其中存储一些数据以便能够快速处理 DOM 元素。我不知道是否应该存储元素 ID（字符串）并执行`$(document.getElementById(this.idVar)).jqueryMagic()`或存储元素对象引用（对象 HTML*Element）并执行`$(this.eleVar).moreJqueryMagic()`. 我不介意可读性，我只想知道每种方法之间的内存空间差异和性能差异。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:51:47.300

如果这个级别的性能是一个问题，你不应该使用 jQuery，它比这样的细节更耗性能。（这并不是说 jQuery 不好。你通常会为它的性能付出代价，但这通常不是问题。）

如果您多次访问对象，一般的常识是存储对象引用会更快，因为您消除了一定程度的取消引用。

如果您使用 jQuery，您通常应该存储 jQuery 包装器而不是原始元素，以避免创建多余的包装器：

```
this.jqVar = $(document.getElementById(this.idVar))
this.jqVar.jqueryMagic() 
```

# vbscript - 从远程机器执行 QTP 测试

> ID：14321432
> 
> 赞同：1
> 
> 时间：2013-01-14T15:30:49.500
> 
> 标签：vbscript, qtp

关于这个话题有一些问题，但我想我会问我的独特情况......

**背景**- 我们正在尝试通过 Jenkins 执行 QTP 脚本。现在，Jenkins 在 Windows Server 上运行，我们在该服务器上遇到了一些 QTP 安装问题（该主题是针对另一个线程的......）。作为一种解决方法，我试图在远程客户端机器（运行 Windows XP）上执行一个简单的 AOM VBScript 调用 QTP 并在该机器上执行测试......

**设置**- 仅用于初始概念验证，`.VBS`位于 Windows 7 框（“呼叫框”）上的文件具有以下命令：

```
Set qtpApp = CreateObject("QuickTest.Application","WinXPMachineName") 
```

**问题**- 我在呼叫框中收到以下错误：

```
ActiveX component can't create object: 'QuickTest.Application' 
```

我已按照[说明](http://qtp9.blogspot.com/2007/10/running-automation-scripts-on-remote.html)设置 QTP 以在 Windows XP 机器上远程执行。请注意，Window 7 box 上没有安装 QTP。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T01:14:35.433

即使您最终将在其他地方启动 QTP，也必须将 QuickTest Pro 安装在本地计算机上（在您的情况下，是您的 Windows 7 计算机）。这是因为`Set qtApp = CreateObject("QuickTest.Application", "MyServer")`召唤QTP的本地安装打开。一旦本地 QTP 打开，它应该与远程服务器通信并指示远程服务器开始测试用例。

**所以，是的，你需要在本地机器上安装 QTP**。（如果您有并发又名“浮动”许可证，这并不麻烦。如果您有单机许可证，这意味着他们为安装 QTP 的每台计算机付费。如果是这种情况，我不知道该推荐什么.)

**另一种方法：**
我一直在与远程启动 QTP 测试脚本搏斗，特别是通过 Windows 任务计划程序启动它们（**这样，您不需要在本地机器上使用 QTP，只需要在远程机器上**）。以下是我提出的一些问题，希望能开辟出一条道路：

*   [如何从命令行运行 QTP 测试？](https://stackoverflow.com/questions/13907603/how-can-i-run-a-qtp-test-from-the-command-line)
*   [远程管理另一台计算机上的计划任务：拒绝访问](https://superuser.com/questions/511074/remotely-managing-scheduled-tasks-on-another-computer-access-denied)
*   [无法从命令行远程安排任务](https://superuser.com/questions/509011/unable-to-remotely-schedule-tasks-from-the-command-line)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-23T14:01:10.463

我使用的是 QTP 以外的另一个自动化工具，但我遇到了同样的问题。有人告诉我，我必须在两台机器上都安装软件“QAWP”才能远程运行它，但我的公司不愿意为此购买第二个许可证，而是想要另一种解决方案“更便宜”。所以：

*   在测试机器中有一个执行测试的批处理文件。
*   在调用批处理文件的窗口中添加计划任务。
*   从任何其他机器，您可以使用以下命令启动计划任务：

    > schtasks /运行 /s /tn

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-31T08:41:02.677

1.  启动计算机和远程计算机都必须在同一个域中，并且以您在 DCOM 设置中授予访问权限的同一用户身份登录
2.  如果可能，请关闭防火墙或将 qtp 添加到例外中

非常适合我

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-30T05:55:37.003

`qtApp = CreateObject("QuickTest.Application", "MyServer")`如果使用`QTP`跟踪版本，谁能告诉 Set是否有效？我`QTP`在两台 Win7 64 位机器上有试用版。当我使用上面的代码`QTP`在我的远程机器表单上启动时，`vbscript`它就可以工作了。

但是当我尝试从 QTP 执行它时它失败了。我在两台机器上都有正确的 DCOM 设置和所有管理权限，而且我的 QTP 也以管理员身份运行。那么它只有在我安装了许可证后才有效吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-04T19:59:47.483

**要向仍在寻找答案以在远程机器中调用 QTP/UFT 的人添加更多信息：**

使用 VBScript 在远程机器中调用 QTP/UFT 测试是老派的方法。我建议你使用詹金斯。它有很多优点。

[在这里](http://www.testautomationguru.com/executing-qtpuft-scripts-using-jenkins/)查看更多详情。

# xamarin.ios - MonoTouch 对话框部分中的自定义边框

> ID：14321433
> 
> 赞同：3
> 
> 时间：2013-01-14T15:30:49.323
> 
> 标签：xamarin.ios, monotouch.dialog

自定义部分边框的最佳方法是什么？Nic Wise 写了[一篇](http://fastchicken.co.nz/2012/05/20/earnest-debrief-visual-styles-in-ios-apps-uiappearence-custom-sections-in-monotouch-dialog/)关于自定义 MT.D 的精彩文章，其中他将边框更改为一个不错的不那么圆的版本，但这涉及修改 MT.D 代码。

有没有办法使用标准的 MT.D 来定制这个？

我很高兴只支持 iOS 5（如果 Appearance API 有帮助的话）。

# python - 将 POST 作为代理添加到 SimpleHTTPServer

> ID：14321440
> 
> 赞同：4
> 
> 时间：2013-01-14T15:31:19.823
> 
> 标签：python, http, post, vbulletin, simplehttpserver

**更新** 我已经做了简单的代理，`SimpleHTTPServer`但是当有人使用 POST 方法请求它显示错误时，我遇到了 POST 方法的问题，所以我已经完成了`do_POST()`功能，但是当我使用 POST 请求时（除了大多数网站都可以正常工作`vbulletin script !`）我刚得到页面说：连接已重置

所以现在的问题是当我尝试登录`vbulletin`网站时，它说连接已重置，我不知道为什么！

```
class Proxy(SimpleHTTPServer.SimpleHTTPRequestHandler):
    def do_GET(self):
      print self.address_string()
      print "User ip:",self.client_address[0]
      print self.date_time_string()#return time
      print self.path
      print self.headers
      self.copyfile(urllib.urlopen(self.path), self.wfile)
      print "--------------------------------------------\n"
    #this is the function where is the problem 
    def do_POST(self):
      print "=====================\n"
      print self.raw_requestline
      print self.headers.getheaders("Content-Length")
      length = int(self.headers.getheaders("Content-Length")[0])
      post_data = urlparse.parse_qs(self.rfile.read(length))
      self.copyfile(urllib.urlopen(self.path,urllib.urlencode(post_data)),self.wfile)
      print "=====================\n" 
```

希望我能得到提示

# jsf-2 - 如何在支持 bean 中检索 Primefaces 自动完成 pogo 选定项目

> ID：14321442
> 
> 赞同：1
> 
> 时间：2013-01-14T15:31:20.210
> 
> 标签：jsf-2, primefaces

我正在尝试学习 Primfaces。我目前正在使用自动完成控件（使用 Pojo）。显示器工作正常。我一直在努力的是检索选定的对象并访问它的任何属性。每当我尝试访问 bean 中选定对象的属性时，都会收到 nullPointerException。任何人都可以帮我解决这个问题（请）？我的代码基于 Primefaces 的简单 pojo 示例：(http://www.primefaces.org/showcase-labs/ui/autoCompletePojo.jsf)。我的网页如下所示：

```
<h:form id="form">
<p:growl id="msg" showDetail="false"/>
<p:panel header="Test Form" toggleable="true">
        <h:outputLabel value="Player(s): " for="basicPojo" />
        <p:autoComplete value="#{autoCompleteBean.selectedPlayers}" 
                    id="basicPojo" completeMethod="#{autoCompleteBean.completePlayer}"
                    var="p" itemLabel="#{p.name}" itemValue="#{p}" converter="player" forceSelection="true" multiple="true">
            <p:ajax event="itemUnselect" listener="#{autoCompleteBean.handleUnselect}" />
            <f:facet name="itemtip">
                <h:panelGrid  columns="2" cellpadding="5">
                    <h:outputText value="eScholarId: " />
                    <h:outputText id="id-output" value="#{p.name}" />

                    <h:outputText value="Name: " />
                    <h:outputText id="name-output" value="#{p.number}" />

                    <h:outputText value="Email: " />
                    <h:outputText id="email-output" value="#{p.position}"/>
                </h:panelGrid>
            </f:facet>
        </p:autoComplete>

        <p:commandButton value="Submit" update="msg" action="#{autoCompleteBean.doMessage}"></p:commandButton>

</p:panel> 
```

我编辑了 Primefaces autoCompleteBean 以添加以下方法：

```
 public void doMessage(){
    String txt = "dummy text";
    txt = this.selectedPlayers.get(0).getName();
    FacesMessage msg = new FacesMessage(txt);
    FacesContext.getCurrentInstance().addMessage(null, msg);
} 
```

我已经像往常一样在 faces.config 文件中添加了转换器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T13:28:55.663

似乎您将集合绑定到自动完成的值。

```
<p:autoComplete value="#{autoCompleteBean.selectedPlayers}"/> 
```

但是您应该将单个实例绑定到 value 属性。

```
private Player selectedPlayer;

// getter and setter

<p:autoComplete value="#{autoCompleteBean.selectedPlayer}"/> 
```

在提交按钮调用的方法中，您可以简单地通过`this.selectedPlayer`.

# sencha-touch - 将嵌套的 xml 加载到 sencha-touch-2.1

> ID：14321448
> 
> 赞同：0
> 
> 时间：2013-01-14T15:31:37.580
> 
> 标签：sencha-touch, sencha-touch-2.1

我正在尝试将部分嵌套的 xml 文件（下面的小示例）从遗留系统加载到 st 2.1 中的嵌套列表视图或导航视图中，但没有运气。我不确定我是否可以只使用一个树存储或多个存储，一个用于文件夹，然后另一个用于过程？

我发现了一个类似的[问题](https://stackoverflow.com/questions/13301105/nested-list-multiple-layouts/13349251#13349251)和[解决方案](http://www.senchafiddle.com/#vsY1o)，但我不知道它会如何处理嵌套方面。

任何帮助都将不胜感激，我担心我的电脑可能无法存活更长时间。

```
<TOC_Data>
    <FolderInfo>
        <Sequence>1</Sequence>
        <Description>Sample Procedures</Description>

        <ProcedureInfo>
            <Metadata>302</Metadata>
            <OdfId>a</OdfId>
            <Number>1</Number>
            <Title>PRO1</Title>
            <ProcType>1</ProcType>
            <FileExtension>xml</FileExtension>
        </ProcedureInfo>
    </FolderInfo>

    <FolderInfo>
        <Sequence>5</Sequence>
        <Description>Styles</Description>

        <FolderInfo>
            <Sequence>6</Sequence>
            <Description>Checklist></Description>

            <ProcedureInfo>
                <Metadata>85</Metadata>
                <OdfId>b</OdfId>
                <Number>2</Number>
                <Title>PRO2</Title>
                <ProcType>1</ProcType>
                <FileExtension>xml</FileExtension>
            </ProcedureInfo>

            <ProcedureInfo>
                <Metadata>119</Metadata>
                <OdfId>c</OdfId>
                <Number>3</Number>
                <Title>PRO3</Title>
                <ProcType>1</ProcType>
                <FileExtension>xml</FileExtension>
            </ProcedureInfo>
        </FolderInfo>
    </FolderInfo>
</TOC_Data> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T21:26:16.907

这似乎是[在 sencha touch 中解析深度嵌套的 xml的副本](https://stackoverflow.com/questions/8401968/parsing-deeply-nested-xml-in-sencha-touch)

您需要适当的字段“映射”配置。映射是 Ext.DomQuery 路径。

*   [http://www.sencha.com/forum/showthread.php?103110-Nested-XML-mapping-how-to](http://www.sencha.com/forum/showthread.php?103110-Nested-XML-mapping-how-to)
*   [http://docs.sencha.com/touch/2-0/#!/api/Ext.DomQuery](http://docs.sencha.com/touch/2-0/#!/api/Ext.DomQuery)
*   [http://docs.sencha.com/touch/2-0/#!/api/Ext.data.Field-cfg-mapping](http://docs.sencha.com/touch/2-0/#!/api/Ext.data.Field-cfg-mapping)

# silverlight - Silverlight + Entity 框架代码优先 + DomainService + 部分类

> ID：14321451
> 
> 赞同：0
> 
> 时间：2013-01-14T15:31:52.723
> 
> 标签：silverlight, entity-framework, ef-code-first, partial-classes

我有实体项目的 Silverlight 项目，这是我的表类

```
 public class OrderHeader : INotifyPropertyChanged
{
    public string OrderId{get;set;}
} 
```

我有

```
 public class DataBaseContext : DbContext
{
    public DbSet<OrderHeader> OrderHeaders { get; set; }

} 
```

我有域名服务

```
[EnableClientAccess()]
public class ShopService : DomainService
{
    [Invoke]
    public OrderHeader GetOrderHeader()
    {
        using (var db = new DataBaseContext())
        {
            return db.OrderHeader.FirstOrdefault(o=>o.OrderId == "123";
         }
    }
} 
```

在我的 SL 应用程序中，我想使用 OrderHeader 作为部分类。就像是

```
public partial class OrderHeader
{
   public DateTime LoadDate{get;set;}
}

private void LoadData()
{
  ShopServiceContext context = new ShopServiceContext();
  context.GetOrderHeader(OrderLoaded, null)
}
private void OrderLoaded(InvokeOperation<OrderHeader> result)
{
   var loadedOrder = result.Value; //load order this is my partial class from SL app
   loadedOrder.Loaddate = DateTime.Now;
} 
```

我可以像这样创造一些想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:24:43.410

是的。首先创建一个新的 Silverlight 类库来保存 Silverlight 项目的实体。然后，使用“添加为链接”将您的实体 (OrderHeader) 添加到此项目中。

对于仅在 Silverlight 端可用的属性（或其他代码部分），您可以使用如下编译器指令：

```
#if SILVERLIGHT
    // Do silverlight stuff 
    public DateTime LoadDate{get;set;}
#endif 
```

在此之后，您的实体将根据 Silverlight 项目的不同条件进行编译。

# unit-testing - 使用 Autofac 根据条件解析多个 Moq 对象

> ID：14321452
> 
> 赞同：3
> 
> 时间：2013-01-14T15:31:55.030
> 
> 标签：unit-testing, c#-3.0, moq, autofac

嗨，我在创建单元测试时将 Moq 与 Autofac 一起使用。我有一个场景，我的 SUT 多个类型的实例取决于构造函数参数。我想起订这些实例。我有一个接口**ISpanRecord**：

```
interface ISpanRecord 
{
RecordType RecordType { get; }
string RecordId { get; set; }
string RecordText { get; set; }
ISpanRecord ParentRecord { get; set; }
List<ISpanRecord> Children { get; }
} 
```

我有另一个接口**IRecordTypeFactory** ，它基于**RecordType**（它是一个枚举）提供一个新的**ISpanRecord**

 **```
interface IRecordTypeFactory
{
ISpanRecord GetNewSpanRecord(RecordType recordType);
} 
```

**SUT SpanParser**类使用上述接口

```
internal class SpanParser : ISpanParser
{
// Private Vars
    private ISpanRecord _spanFile;
    private readonly IRecordTypeFactory _factory;
    private readonly ISpanFileReader _fileReader;

//Constructor
public SpanParser(ISpanFileReader fileReader)
    {
        _fileReader = fileReader;
        _spanFile = Container.Resolve<ISpanRecord>(TypedParameter.From(RecordType.CmeSpanFile),
                                                                TypedParameter.From((List<SpanRecordAttribute>)null));
        _factory = Container.Resolve<IRecordTypeFactory>(TypedParameter.From(_fileReader.PublisherConfiguration));
    }

// Method under test
public SpanRiskDataSetEntity ParseFile()
    {
        string currRecord = string.Empty;
        try
        {
            var treeLookUp = Container.Resolve<ITreeLookUp>(TypedParameter.From(_spanFile),
                                                            TypedParameter.From(_fileReader.PublisherConfiguration));

            IList<string> filterLines = _fileReader.SpanFileLines;

            ISpanRecord currentRecord;
            ISpanRecord previousRecord = _spanFile;
            List<string> spanRecords;

            foreach (var newRecord in filterLines)
            {
                currRecord = newRecord;

                //check if we got multiple type of records in a single line.

                spanRecords = _fileReader.PublisherConfiguration.GetMultipleRecordsText(newRecord);
                if (spanRecords == null)
                    continue;

                foreach (var recordText in spanRecords)
                {
                    RecordType recordType = _fileReader.PublisherConfiguration.GetRecordType(recordText);

                    currentRecord = _factory.GetNewSpanRecord(recordType);

                    // some more logic

                    GetPreviousRecord(ref previousRecord, currentRecord);
                }
            }
            // private method
            return GetSpanRiskDataSet();
        }

        catch (OperationCanceledException operationCanceledException)
        {
            // log
            throw;
        } 
    } 
```

在上面的类中，在测试的时候，我想 根据RecordType获取**ISpanRecord的多个对象。**就像是：

```
mockFactory.Setup(fc=> fc.GetNewSpanRecord(It.IsAny<RecordType>).Returns(// an ISpanRecord object on the basis of Recordtype) 
```

由于上述设置将在循环中进行验证，因此我想设置多个案例。请让我知道可以解决什么问题，或者指出可以解决的问题。

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T16:25:33.990

`Returns`有多个重载，您正在寻找那些`Func<RecordType, ISpanRecord>`作为参数的重载。排序后，您可以构建自定义返回逻辑：

```
mockFactory
    .Setup(fc => fc.GetNewSpanRecord(It.IsAny<RecordType>)
    .Returns((RecordType rt) =>
    {
         if (rt.Property == "value") return new DummySpanRecord();
         else if (rt.Property2 == "other value") return new FakeSpanRecord();
         else return new DefaultSpanRecord();
    }); 
```

您使用[**服务定位器**而不是**抽象工厂**](http://blog.ploeh.dk/2010/11/01/RefactoringFromServiceLocatorToAbstractFactory.aspx)有什么原因吗？如果您的容器没有嵌入到您的 SUT 中，那么测试可能会更容易（例如，您不必跟踪容器本身和依赖项注册过程）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T16:26:23.273

在您的设置中，不要使用`It.IsAny<RecordType>`- 使用特定值：

```
mockFactory.Setup(fc=> fc.GetNewSpanRecord(RecordType.Type1)).Returns(// an ISpanRecord object on the basis of Recordtype.Type1)
mockFactory.Setup(fc=> fc.GetNewSpanRecord(RecordType.Type2)).Returns(// an ISpanRecord object on the basis of Recordtype.Type2) 
```

编辑：这假设一个简单的情况`RecordType`是枚举（或其他值类型）。如果它是引用类型，则需要使用更复杂的技术，例如 jimmy's。**

# vb.net - 数据表 VB.Net

> ID：14321458
> 
> 赞同：0
> 
> 时间：2013-01-14T15:32:12.033
> 
> 标签：vb.net, datatable

我有 2 个数据表

表 1（Type6）有字段：StopNo

表 2 (StationName) 有字段：StopNo、Name

我想要做的是加入 2 个表，所以在 sql 中它会是这样的：

> SELECT DISTINCT Type6.STOPNO, StationName.NAME FROM Type6 JOIN StationName on StationName.STOPNO=Type6.STOPNO order by NAME"

如何使用 2 个包含相同信息的数据表来执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:36:04.417

...让我知道这是否有效...

```
 Dim Result = (From tp6 As DataRow In Type6
             Join stNm As DataRow In StationName
             On tp6.Item("STOPNO") Equals stNm.Item("STOPNO")
             Select x = New With {.STOPNO = tp6.Item("STOPNO"), .NAME = stNm.Item("NAME")}).Distinct 
```

# html - a:link 的锚点需要不同颜色的跨度，a:hover 相同

> ID：14321466
> 
> 赞同：0
> 
> 时间：2013-01-14T15:32:32.593
> 
> 标签：html, css, hover

我有一个链接，其中嵌入了一个跨度，其中包含一个“小于”箭头`<`，后跟一个`nbsp`和一些文本：

```
<a href=".."><span class="smallbutton">&lt;</span>&nbsp;back to overview</a> 
```

我希望整个锚点都是灰色文本，除了`<`应该是白色的。整个锚点在悬停时应该是橙色文本，但我无法让它工作......我想知道是否可以仅使用 CSS，但我对此表示怀疑。

造型（目前最接近的尝试）：

```
.smallbutton {
    background-color: #AAAAAA;
    border-radius: 8px 8px 8px 8px;
    color: white;
    display: inline-block;
    height: 20px;
    text-align: center;
    width: 20px;
}
.smallbutton:hover {
    background-color: #DDDDDD;
    color: inherit;
}
a:link, a:visited {
    color: gray;
    text-decoration: none;
}
a:active {
    color: #FC930A !important;
    text-decoration: none;
}
a:hover, a:focus {
    color: #F7C41F !important;
    text-decoration: none;
} 
```

问题是，我希望`!important`覆盖`white`但它没有......

这是jsfiddle：http: [//jsfiddle.net/2GX2Y/](http://jsfiddle.net/2GX2Y/)

`<`只是将鼠标悬停在包含标签上时，应该有颜色`<a>`，而不仅仅是它`<`本身。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:38:29.900

我想如果你改变

```
.smallbutton:hover 
```

到

```
a:hover .smallbutton 
```

then you'll have what you want. But I may have misunderstood the question.

Just let me know!

Here is the example [http://jsfiddle.net/tRRRV/1/](http://jsfiddle.net/tRRRV/1/)

# objective-c - GNUsetup objective-c 未定义对与 libxml2 链接的“htmlReadMemory”的引用

> ID：14321467
> 
> 赞同：0
> 
> 时间：2013-01-14T15:32:34.333
> 
> 标签：objective-c, makefile, window, gnu

我试图在 windows 中将 libxml2 与我的简单目标 c 链接，我有 lib 和头文件。

我的 GNUmakefile 看起来像这样：

```
include $(GNUSTEP_MAKEFILES)/common.make
TOOL_NAME = sample_app
sample_app_CFLAGS = -Ic:/GNUstep/include/libxml2 -lxml2
sample_app_LDFLAGS =-Lc:/GNUstep/lib -lxml2
ADDITIONAL_FLAGS += -Ic:/GNUstep/include/libxml2 -lxml2
ADDITIONAL_LDFLAGS+=-Lc:/GNUstep/lib -lxml2

sample_app_HEADERS = HttpManager.h UT.h HtmlParser.h
sample_app_OBJC_FILES = main.m HttpManager.m UT.m HtmlParser.m
sample_app_RESOURCE_FILES =

include $(GNUSTEP_MAKEFILES)/tool.make 
```

我在 HtmlParser.m/h 中调用 HtmlParser 的实施文件如下所示：

```
#import <Foundation/Foundation.h>
#import <libxml/tree.h>
#import <libxml/parser.h>
#import <libxml/HTMLparser.h>
#import <libxml/xpath.h>
#import <libxml/xpathInternals.h>

@interface HtmlParser :NSObject
{
    NSString* encoding;
}

 -(void)ExtractInnerSiteLinks:(NSString*) PageHtml:(NSString*) url;

@end

#import "HtmlParser.h"
#import "UT.h"
@implementation HtmlParser

-(id) init
{
    self = [super init];
    if(self) {
        encoding = @"UTF-8";
    }

    return self;

}

-(void) ExtractInnerSiteLinks:(NSString*) PageHtml:(NSString*) url
{

    NSData* documentData = [PageHtml dataUsingEncoding:NSUTF8StringEncoding];
    NSData* urlData = [url dataUsingEncoding:NSUTF8StringEncoding];
    const char *cEncoding =[encoding UTF8String];
    xmlDocPtr doc;
    /*

    htmlReadMemory  (const char *buffer,
                     int size,
                     const char *URL,
                     const char *encoding,
                     int options); 

    */
    doc = htmlReadMemory([documentData bytes],
                               [documentData length],
                               /*[urlData bytes]*/NULL,
                               /*cEncoding*/NULL,
                               HTML_PARSE_NOBLANKS | HTML_PARSE_NOERROR | HTML_PARSE_NOWARNING | HTML_PARSE_NONET);

} 
 @end 
```

当我运行时：让 CC=clang
我得到：

```
$ make CC=clang
This is gnustep-make 2.6.2\. Type 'make print-gnustep-make-help' for help.
Making all for tool sample_app...
 Compiling file main.m ...
clang: warning: -lxml2: 'linker' input unused when '-c' is present
 Compiling file HttpManager.m ...
clang: warning: -lxml2: 'linker' input unused when '-c' is present
 Compiling file UT.m ...
clang: warning: -lxml2: 'linker' input unused when '-c' is present
 Compiling file HtmlParser.m ...
clang: warning: -lxml2: 'linker' input unused when '-c' is present
HtmlParser.m:25:10: warning: unused variable 'urlData' [-Wunused-variable]
        NSData* urlData = [url dataUsingEncoding:NSUTF8StringEncoding];
                ^
HtmlParser.m:26:14: warning: unused variable 'cEncoding' [-Wunused-variable]
        const char *cEncoding =[encoding UTF8String];
                    ^
2 warnings generated.
 Linking tool sample_appscrapper ...
./obj/sample_appscrapper.obj/HtmlParser.m.o: In function `-[HtmlParser ExtractInnerSiteLinks::]':
d:/dev/objc/sample_appscrapper/HtmlParser.m:37: undefined reference to `htmlReadMemory'
collect2: ld returned 1 exit status
clang: error: linker (via gcc) command failed with exit code 1 (use -v to see invocation)
make[3]: *** [obj/sample_appscrapper.exe] Error 1
make[2]: *** [internal-tool-all_] Error 2
make[1]: *** [sample_appscrapper.all.tool.variables] Error 2
make: *** [internal-all] Error 2 
```

使 -n ：

```
$ make -n CC=clang
This is gnustep-make 2.6.2\. Type 'make print-gnustep-make-help' for help.
(make -f GNUmakefile --no-print-directory --no-keep-going \
        internal-master-tool-all \
        GNUSTEP_BUILD_DIR="." \
        _GNUSTEP_MAKE_PARALLEL=yes)
( \
instance=sample_app; \
operation=all; \
type=tool; \
abs_build_dir="."; \
if [ "" != "" ]; then \
  echo "Making $operation in subprojects of $type $instance..."; \
  for f in  __done; do \
    if [ $f != __done ]; then       \
      if [ "${abs_build_dir}" = "." ]; then \
        gsbuild="."; \
      else \
        gsbuild="${abs_build_dir}/$f"; \
      fi; \
      if [ "" = "" ]; then \
        if [ "$type" = "framework" ]; then \
          if [ "no" = "yes" ]; then \
            framework_version=""; \
            if [ "$framework_version" = "" ]; then \
              framework_version=""; \
              if [ "$framework_version" = "" ]; then \
                framework_version=""; \
                if [ "$framework_version" = "" ]; then \
                  framework_version="0"; \
                fi; \
              fi; \
            fi; \
            owning_project_header_dir="../${instance}.framework/Versions/${framework_version}/Headers"; \
          else \
            owning_project_header_dir="../${instance}.framework/Headers"; \
          fi; \
       else owning_project_header_dir=""; \
       fi; \
      else \
        owning_project_header_dir="../"; \
      fi; \
      if make -C $f -f GNUmakefile --no-print-directory --no-keep-going $operation \
          OWNING_PROJECT_HEADER_DIR_NAME="${owning_project_header_dir}" \
          DERIVED_SOURCES="../derived_src" \
          GNUSTEP_BUILD_DIR="$gsbuild" \
          _GNUSTEP_MAKE_PARALLEL=no \
        ; then \
        :; \
      else exit $?; \
      fi; \
    fi; \
  done; \
fi; \
echo "Making $operation for $type $instance..."; \
make -f GNUmakefile --no-print-directory --no-keep-going \
    internal-${type}-$operation \
    GNUSTEP_TYPE=$type \
    GNUSTEP_INSTANCE=$instance \
    GNUSTEP_OPERATION=$operation \
    GNUSTEP_BUILD_DIR="${abs_build_dir}" \
    _GNUSTEP_MAKE_PARALLEL=no)
Making all for tool sample_app...
(make -f GNUmakefile --no-print-directory --no-keep-going \
        internal-tool-compile \
        GNUSTEP_TYPE=tool \
        GNUSTEP_INSTANCE=sample_app \
        GNUSTEP_OPERATION=compile \
        GNUSTEP_BUILD_DIR="." \
        _GNUSTEP_MAKE_PARALLEL=yes)
(echo " Linking tool sample_app ...";clang  -Wl,--enable-auto-import -Lc:/GNUstep/lib -lxml2 -Lc:/GNUstep/lib -lxml2      -shared-libgcc -fexceptions -fgn
u-runtime -o obj/sample_app.exe \
                ./obj/sample_app.obj/main.m.o ./obj/sample_app.obj/HttpManager.m.o ./obj/sample_app.obj/UT.m.o ./obj/sample_app.obj/Html
Parser.m.o \
                     -L/home/meiry/GNUstep/Library/Libraries -L/GNUstep/Local/Library/Libraries -L/GNUstep/System/Library/Libraries     -lgnustep-base    -lobjc
   -lws2_32 -ladvapi32 -lcomctl32 -luser32 -lcomdlg32 -lmpr -lnetapi32 -lm -I. ) 
```

# javascript - 我需要在表格中找到一列的总值，不包括最后一行

> ID：14321469
> 
> 赞同：0
> 
> 时间：2013-01-14T15:32:42.930
> 
> 标签：javascript, jquery, html, jsp, struts2

每当用户对任何表格单元格进行更改时，我都希望能够动态更新“新建”列下的总值。

DOM：

```
<div id='lc_adjustments'>
  <table id='adjustments' cellspacing='0' width='550px' class='lc_nf' border='0'
  cellpadding='0'>
    <tbody>
      <tr>
        <td>
          <table cellspacing='0' width='100%' class='lcb' border='0' cellpadding='0'>
            <tr>
              <td>
                <table cellspacing='1' width='100%' class='ibody' border='0' cellpadding='0'>
                  <colgroup>
                    <col width='250px'></col>
                    <col width='150px'></col>
                    <col width='150px'></col>
                  </colgroup>
                  <tr class='header'>
                    <td>Item Name</td>
                    <td>Current Value</td>
                    <td>New Value</td>
                  </tr>
                  <tr onmouseover='high(this);' class='even' onmouseout='low(this);'>
                    <td class='cl'>Item number 1</td>
                    <td class='cl'>89.50</td>
                    <td class='cl'>
                      <input class='clsMandatoryReal' onchange='getTotal();' id='totalable'
                      value='89.50' size='25' type='text'>
                    </td>
                  </tr>
                  <tr onmouseover='high(this);' class='odd' onmouseout='low(this);'>
                    <td class='cl'>Item number 2</td>
                    <td class='cl'>69.70</td>
                    <td class='cl'>
                      <input class='clsMandatoryReal' onchange='getTotal();' id='totalable'
                      value='69.70' size='25' type='text'>
                    </td>
                  </tr>
                  <tr onmouseover='high(this);' style='font-weight: bold;' onmouseout='low(this);'
                  class='even'>
                    <td class='cl'>TOTAL STOCK MASS</td>
                    <td class='cl'>?</td>
                    <td class='cl'>?</td>
                  </tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </tbody>
  </table> 
```

我试图在 jquery 中执行此操作，但我的功能似乎不起作用：

```
function getTotal() {

  var total = 0.0;

  //iterate over each of the cells
  $('table.ibody tbody tr').
  children('td.cl').
  children('input#totalable:not(:last)').each(function () {

    total += $(this).text();
  });

  $('table.ibody tbody tr').
  children('td.cl').
  children('input#totalable:last)').value = total;

  alert(total);

} 
```

我对 jquery 或 javascript 中的解决方案持开放态度。html 部分由 Struts 生成，这意味着在大多数情况下，我对 html 类/id 属性无能为力。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:37:03.493

这是一个 jQuery 替代方案：

```
var total = 0;

//Iterate all td's in second column
$('#adjustments>tbody>tr>td:nth-child(2)').each( function(){
   total += parseFloat($(this).text()) || 0;       
});

alert(total) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:41:14.450

这最终对我有用：

函数 getTotal(){

```
 var total = 0.0;

         $('table.ibody tbody tr').
         children('td.cl').
         children('input#totalable').each(function(){ 
             total += parseFloat(this.value);
         });

         $('table.ibody tbody tr').
         children('td.cl').
         children('div#totalable').html(total);

         alert(total);

} 
```

# widget - Wordpress 小部件控制面板

> ID：14321472
> 
> 赞同：0
> 
> 时间：2013-01-14T15:33:02.280
> 
> 标签：widget, wordpress

关于 Wordpress 小部件，我有点困惑，但只是一点点。我有一个功能齐全的小部件，我已经设置为显示我想要的所有相关数据，但是我想通过小部件控制面板向它添加一些额外的功能。

当您将小部件拖到 Wordpress 管理区域中的活动位置时，某些插件允许您在那里对其进行一些额外的更改，设置某些功能......这就是我想要做的......

但是我不确定我应该如何将我的表格实际放入该区域，任何人都可以为我阐明这一点吗？

在此先感谢您的所有回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:42:23.380

没关系，我又找到了。对于其他有问题的人，答案是：

wp_register_widget_control():

语法是：

```
wp_register_widget_control( int|string $id, string $name, callable $control_callback, array $options = array() ) 
```

注册小部件控件回调以自定义选项。

`wp_register_widget_control()`位于`wp-includes/widgets.php`

有关更多信息，请参阅： [wp_register_widget_control](https://codex.wordpress.org/Function_Reference/wp_register_widget_control)

# node.js - 显示来自 Mongoose 模式的特定数组

> ID：14321473
> 
> 赞同：0
> 
> 时间：2013-01-14T15:33:02.523
> 
> 标签：node.js, mongodb, mongoose

这是我正在使用的架构：

```
var userschema = new mongoose.Schema({

  user: String,
  pass: String,
  imagen: [{ 

              title: String,
              name: String,
              description: String

}); 
```

这就是我正在做的事情：

```
usermodel.find({ 'imagen._id': req.params.id }, function (err, imagen){

  user.imagen 

    if(err) throw err;
    console.log(imagen);

    res.send(imagen);

}); 
```

我想收到的只是我正在寻找的`imagen`数组中的元素`_id`，但相反，我收到了用户的洞模式，包括他所有的图像。有什么可以只接收我正在寻找的数组对象吗？这是一个例子：

[ { __v: 3, _id: 50f41ccff405ef73c4000006, pass: 'mangakas123', user: 'kirbo', imagen: [ { title: 'DQ monstes', name: 'DragonQuest1and2EnemySpriteGallery_02.png', 描述: 'DQ 怪物合集' ，_id：50f41f868e7f9919c7000006 } ]，时间线：[]，通知：[]，关注者：['50f41c8c59ebd50fc4000006']，关注：[] } ]

我想要这个：

```
[{ title: 'DQ monstes',
     name: 'DragonQuest1and2EnemySpriteGallery_02.png',
     description: 'A compilation of DQ monsters',
     _id: 50f41f868e7f9919c7000006 }] 
```

谢谢提前！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:38:18.957

you can exclude other fields like this

```
usermodel.find({ 'imagen._id': req.params.id },{'imagen':true}, function (err, imagen){

  user.imagen 

    if(err) throw err;
    console.log(imagen);

    res.send(imagen);

}); 
```

see the second parameter for find(): [http://docs.mongodb.org/manual/reference/method/db.collection.find/](http://docs.mongodb.org/manual/reference/method/db.collection.find/)

# asp.net - 读取一个excel文件

> ID：14321479
> 
> 赞同：0
> 
> 时间：2013-01-14T15:33:17.843
> 
> 标签：asp.net, dynamic-data

在我的 asp.net 动态数据项目中，我想使用合适的 Microsoft 技术（不是 Excel）读取 excel 文件。有人说他们是用于此的服务器端工具？我想从表中读取前几列数据？

关于去哪里的任何建议或方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T17:08:07.753

回复您的评论，请看这里：

[http://www.codeproject.com/Articles/37055/Working-with-MS-Excel-xls-xlsx-Using-MDAC-and-Oled](http://www.codeproject.com/Articles/37055/Working-with-MS-Excel-xls-xlsx-Using-MDAC-and-Oled)

这是一些（未经测试的）代码可以帮助您入门。

```
string connectionstring = "Provider=Microsoft.Jet.OLEDB.4.0;
                          Data Source=c:\\testexcel.xls;
                          Extended Properties\"Excel 8.0;HDR=YES\"";
string cmdText = "SELECT * FROM [Sheet1$]";
using(conObj = new OleDbConnection(connectionstring))
{
   using (OleDbCommand cmd = new OleDbCommand(createTableScript, conObj)
   {
      OleDbDataAdapter adpt = new OleDbDataAdapter(cmd);
      DataSet ds = new DataSet();
      adpt.Fill(ds,"w1");
   }
} 
```

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T03:28:20.287

**我建议您使用这个名为Excel Data Reader**的 Codeplex 项目：

[http://exceldatareader.codeplex.com/](http://exceldatareader.codeplex.com/)

希望能帮助到你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-22T12:41:51.163

您可以使用 OLEDB 对象，也可以使用 Interop 对象从 excel 文件中读取每个单元格并将其插入数据库中，请参见以下代码片段中的以下代码片段我使用了 OLEDB 并从 excel 中获取值

```
string objCON = @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=EXcel_file_path;Extended Properties='Excel 8.0;HDR=Yes;'"
using(OleDbConnection objCon = new OleDbConnection(objCON))
{
    objCon.Open();
    OleDbCommand objCMD = new OleDbCommand("select * from [Sheet1$]", objCon) 
    using(OleDbDataReader objDR = objCMD.ExecuteReader())
    {
         while(objDR.Read())
         {
             messageBox.Show("value of row1 and column 0" + dr[0]);
         }
        if(objDR != null)
        {
    objDR.Close();
    objDR = null;
         }
    }
} 
```

# html - 保持链接a：在链接按下后以相同的方式激活

> ID：14321480
> 
> 赞同：0
> 
> 时间：2013-01-14T15:33:28.250
> 
> 标签：html, css, image, hyperlink, onclick

我今天在玩 css 和 html，当悬停并单击时，我试图获取图像/链接以更改其形式。但是我没有做的是当我点击图片时我选择的图片保持“点击”状态。

这是CSS：

```
#header {
    background-image: url(bg.jpg);
    height: 32px;
    width: 100%;
    border-bottom-style: solid;
    border-bottom-color: #000;
    border-bottom-width: 1px;
}
#logo a {
    background-image:url(logo.png);
    display:block;
    width:128px;
    height:32px;
}
#logo a:hover {
    background-image:url(logohover.png);
    display:block;
    width:128px;
    height:32px;
}
#logo a:focus {
    background-image:url(logoonclick.png);
    display:block;
    width:128px;
    height:32px;
} 
```

这是HTML：

```
<div id="header">
    <div id="logo">
        <a href="#"></a>
    </div>
</div> 
```

所以基本上我希望链接或图像在被点击后保持“点击”的形式，如果再次点击我希望它恢复到它的标准。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:57:32.257

最简单的方法是使用 Javascript 来切换链接上的类，然后将该类添加到 a:hover 的 CSS。

在 jQuery 中，这看起来像：

```
$('#logo a').click(function() {
    $(this).toggleClass('clicked');
}); 
```

然后更改 CSS 以添加新类：

```
#logo a:hover, .clicked {
    /* ... */
} 
```

如果您不想使用 Javascript，您还可以将 样式设置`a:visited`为看起来像悬停状态 - 单击时，链接看起来仍然被单击。但是，您将无法仅使用 CSS 将其更改回预单击状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T16:03:37.803

如果你用 input[type=checkbox] 和标签替换你的 a 元素，你可以使用 :checked-pseudeselector 得到你想要的东西：

[http://jsfiddle.net/CWv6D/](http://jsfiddle.net/CWv6D/)

```
#foo {
    display: none;
}
#logo label {
    background-image:url(http://placehold.it/128x32);
    display:block;
    width:128px;
    height:32px;
}
#logo label:hover {
    background-image:url(http://placesheen.com/128/32);
}
#logo input:checked + label {
    background-image:url(http://placekitten.com/128/32);
} 
```

HTML：

```
<div id="header">
    <div id="logo">
      <input id="foo" type="checkbox"/>
      <label for="foo"></label>
    </div>
</div> 
```

# jquery - jquery缓存在对象中

> ID：14321482
> 
> 赞同：0
> 
> 时间：2013-01-14T15:33:43.833
> 
> 标签：jquery, ajax, caching

HTML：

```
<div class="nav">
  <ul>
      <li><a href="#">Home</a></li>
      <li><a href="#">About</a></li>
      <li><a href="#">Contact</a></li>
  </ul>
</div> 
```

查询：

```
$('.nav ul li a').click(function () {
    var url = $(this).attr('href');
    var obj = {};

    $('.cnt').load(url + ' div', function (response) {
        obj['key'] = $(this).html();
    });

    return false;
}); 
```

我的问题是每次单击时，obj 只能获取一次密钥。我希望在每次下一次单击对象时保持上一个键并添加新键。它应该看起来像这样：

```
1st click obj{key}

2nd click obj{key,key} 
```

现在看起来像这样：

```
1st click obj{key}

2nd click obj{key} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:37:25.287

An object can only have one value per key. You're setting the `'key'` value of `obj`, so it's re-setting that key each time.

You want to be using an array instead.

```
var arr = [];
$('.nav ul li a').click(function () {
    var url = $(this).attr('href');

    $('.cnt').load(url + ' div', function (response) {
        arr.push($(this).html());
    });

    return false;
}); 
```

# ios - 如何在 NSMutableURLRequest 中使用查询字符串（--data-urlencode）？

> ID：14321483
> 
> 赞同：3
> 
> 时间：2013-01-14T15:33:44.650
> 
> 标签：ios, cocoa-touch, http, curl, nsmutableurlrequest

我想将以下`GET`请求翻译成一个实例`NSMutableURLRequest`：

```
curl -X GET \
  -H "X-Parse-Application-Id: sdasfasdf" \
  -H "X-Parse-REST-API-Key: asdfasdfasdfasd" \
  -G \
  --data-urlencode 'where={"arrayKey":2}' \
  https://api.parse.com/1/classes/RandomObject 
```

我知道如何设置标题和方法，但不知道如何添加`--data-urlencode`部分。

谁能帮我这个？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:07:30.943

您可以使用该`-[NSString stringByAddingPercentEscapesUsingEncoding:]`方法对字符串进行编码。然后，您只需要将字符串附加到 URL。

```
NSString *URLPrefix = @"https://api.parse.com/1/classes/RandomObject";
NSString *encodedQuery = [@"where={\"arrayKey\":2}" stringByAddingPercentEscapesUsingEncoding:NSASCIIStringEncoding];
NSURL *URL = [NSURL URLWithString:[NSString stringWithFormat:@"%@?%@", URLPrefix, encodedQuery]];
[request setURL:URL]; 
```

# ruby-on-rails - 捆绑不完整时如何使 rake 工作（并非所有 gem 都已成功安装）？

> ID：14321484
> 
> 赞同：0
> 
> 时间：2013-01-14T15:33:44.800
> 
> 标签：ruby-on-rails, ruby, rake, bundle

我有一个安装不正确的 gem（可能是由于系统不兼容）。每次我调用 rake 时，它​​都会返回“在任何源中都找不到*rmagic*。运行捆绑安装”。

我想稍后将应用程序推送到 Heroku。但我有一些数据库要先播种。尽管缺少 gem 并且没有安装它，是否可以强制 rake 执行任务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T17:39:38.547

这可能吗？是的，您可以通过删除 config/application.rb 中如下所示的行来禁用捆绑程序

```
if defined?(Bundler)
  # If you precompile assets before deploying to production, use this line
  Bundler.require(*Rails.groups(:assets => %w(development test)))
  # If you want your assets lazily compiled in production, use this line
  # Bundler.require(:default, :assets, Rails.env)
end 
```

我不推荐这样做，因为您需要自己启动 gem/依赖管理。但是，只要您不需要实际运行任何代码，就足以让 rake 加载并为您工作。

我强烈建议您先安装 image-magick，然后再安装 rmagick。[http://www.imagemagick.org/](http://www.imagemagick.org/)

# mysql - MySQL AND OR 语句

> ID：14321488
> 
> 赞同：-2
> 
> 时间：2013-01-14T15:33:50.803
> 
> 标签：mysql, sql

我目前正在尝试让查询正常工作，并需要一些指导

```
SELECT * 
FROM users
WHERE username =  'bob'
AND device_1 =  'test'
OR device_2 =  'test'
OR device_3 =  'test' 
```

无论我是否指定用户名，它似乎都会显示任何带有单词 test 的行。

我对此很迷茫，它很可能是一些简单的事情，我正在看过去。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T15:35:14.347

在子句中添加一些括号，`WHERE`否则`username`过滤器仅适用于`device_1 = 'test'`：

```
SELECT * 
FROM users
WHERE username =  'bob'
AND
( 
  device_1 =  'test'
  OR device_2 =  'test'
  OR device_3 =  'test'
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T15:34:49.140

尝试这个，

```
SELECT * 
FROM   users
WHERE  username = 'bob' AND 
       'test' IN (device_1, device_2, device_3) 
```

执行`IN`相同的多个`OR`

# jquery - 如何在 Jquery 的网格视图中获取所有图像 SRC？

> ID：14321490
> 
> 赞同：0
> 
> 时间：2013-01-14T15:33:58.483
> 
> 标签：jquery, asp.net, gridview, imagebutton

我有网格视图显示 3 个图像第一个 1 被删除我想循环通过网格视图图像并将它的 src 放入数组但忽略删除此图像的图像显示我真正遇到的

![我的网格视图](../Images/c4a1fa2f5b44dd013dfb4b99a8ae107c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:36:55.893

```
var arr = [];
$('#container').find('img,[type=image]').each(function() {
    arr.push(this.src); // stores the absolute src
//  arr.push($(this).attr('src')); // stores the original HTML attribute
}); 
```

# php - 将mysql数据库文件夹复制到新计算机（windows）

> ID：14321493
> 
> 赞同：0
> 
> 时间：2013-01-14T15:34:10.413
> 
> 标签：php, mysql, phpmyadmin

我从其他计算机复​​制了一个数据库文件夹（文件夹名称是数据库名称）到新计算机，实际上数据库文件夹被卸载程序意外删除，我通过硬盘恢复工具恢复了它，但是当我打开 phpmyadmin 时，这个数据库的所有形式都不能在mysql中加载，有没有机会让它工作？

谢谢

**更新**

替换旧的 ibdata1 文件，加载所有表

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:37:39.277

upload all the database again, also see [this](https://stackoverflow.com/questions/5859545/import-database-phpmyadmin) and `Related` questions on right bottom of this page..

# ms-access - 从 VB 调用查询

> ID：14321495
> 
> 赞同：0
> 
> 时间：2013-01-14T15:34:20.030
> 
> 标签：ms-access, vba

我试图从 VB 调用 Access 中的查询，但遇到了一些问题。这是代码：

```
 Dim myQuery As QueryDefs
 myQuery("2012Patient_q").Execute 
```

但这不起作用。我尝试用谷歌搜索，但无济于事。我在这里想念什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:38:35.517

代码可能应该是这样的：

```
Dim myQuery As QueryDef        ' no "s"
Set myQuery = CurrentDB.QueryDefs("2012Patient_q")
myQuery.Execute 
```

或者，简单地说，没有任何中间变量：

```
CurrentDB.QueryDefs("2012Patient_q").Execute 
```

# c# - 在 windows8 中打印 webview 的不可见内容

> ID：14321499
> 
> 赞同：1
> 
> 时间：2013-01-14T15:34:24.410
> 
> 标签：c#, xaml, printing, windows-8, webview

我的 xaml 中有一个 webview，由于 webview 的大小，它不能一次显示所有的 html 内容，所以有一个滚动查看器。我想打印html文件的所有内容，但是当我在设备魅力中选择打印机时，预览页面只显示当前在webview中显示的内容，不可见的内容无法显示在预览页面中，任何人可以帮忙？下面是我的代码。

```
public sealed partial class MainPage : Page
{
    PrintDocument printDocument;
    IPrintDocumentSource printDocumentSource;
    WebView wv;

    public MainPage()
    {
        this.InitializeComponent();
        printDocument = new PrintDocument();
        printDocumentSource = printDocument.DocumentSource;
        printDocument.Paginate += OnPrintDocumentPaginate;
        printDocument.GetPreviewPage += OnPrintDocumentGetPreviewPage;
        printDocument.AddPages += OnPrintDocumentAddPages;
        wv = FindName("webviewPrint") as WebView;            
    }

    private void OnPrintDocumentAddPages(object sender, AddPagesEventArgs e)
    {
        printDocument.AddPage(wv);
        printDocument.AddPagesComplete();
    }

    private void OnPrintDocumentGetPreviewPage(object sender, GetPreviewPageEventArgs e)
    {
        printDocument.SetPreviewPage(e.PageNumber, wv);
    }

    private void OnPrintDocumentPaginate(object sender, PaginateEventArgs e)
    {
        printDocument.SetPreviewPageCount(1, PreviewPageCountType.Final);            
    }

    private void OnPrintManagerPrintTaskRequested(PrintManager sender, PrintTaskRequestedEventArgs args)
    {
        args.Request.CreatePrintTask("Hello Printer", OnPrintTaskSourceRequested);

    }

    void OnPrintTaskSourceRequested(PrintTaskSourceRequestedArgs args)
    {
        args.SetSource(printDocumentSource);
    }

    protected override void OnNavigatedTo(NavigationEventArgs e)
    {
        PrintManager.GetForCurrentView().PrintTaskRequested += OnPrintManagerPrintTaskRequested;
        base.OnNavigatedTo(e);
    }

    protected override void OnNavigatingFrom(NavigatingCancelEventArgs e)
    {
        PrintManager.GetForCurrentView().PrintTaskRequested -= OnPrintManagerPrintTaskRequested;
        base.OnNavigatingFrom(e);
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T18:51:37.427

在来自官方 Windows SDK 示例的[打印示例](http://code.msdn.microsoft.com/windowsapps/Print-Sample-c544cce6)中，请查看场景 2。它打印的内容对于一个屏幕来说太大了。该示例使用**RichTextBlock**，您将在您的情况下将其更改为**WebView**。

# regex - 正则表达式 - 不明白为什么没有匹配

> ID：14321502
> 
> 赞同：2
> 
> 时间：2013-01-14T15:34:35.457
> 
> 标签：regex, syntax, pattern-matching, syntax-highlighting

我目前正在尝试编写一个小的语法突出显示脚本，其中有以下正则表达式：

```
[^\w](int|for)[^\w]|^(int|for)[^\w]|(int|for)$ 
```

现在当我输入

```
for int 
```

在最后一个 int 之后有一个空格，for 被突出显示，但 int 没有，我不明白为什么。我在想“ int ”与正则表达式匹配。

当我尝试输入

```
bla bla for bla bla 
```

for 被突出显示。谁能解释一下为什么“ int ”与上述正则表达式不匹配？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T15:37:21.400

这与您的`$`（在行尾断言位置）有关-尝试将其删除，它应该可以正常工作。

# ruby - 我应该将该方法添加为受保护的吗？为什么？

> ID：14321503
> 
> 赞同：2
> 
> 时间：2013-01-14T15:34:36.333
> 
> 标签：ruby, encapsulation

我想`find_items`在子类中覆盖 Item 的方法`UserItem`。我应该将该方法添加为`protected`or`private`吗？

我现在可以在子类中使用受保护的方法，并且只能在它们所属的类中使用私有方法。

```
class Item
  def item_ids
    @ids ||= REDIS.zrevrange(key, 0, 100).map(&:to_i)
  end

  def items
    find_items
    item_ids.collect {|id| records.detect {|x| x.id == id}}.compact.map(&:content)
  end

protected
  def items_scope
    Item
  end

  def find_items
    items_scope.find(item_ids)
  end
end

class UserItem < Item
  def initialize(user)
    @user = user
  end
  # should I add it here?
protected
  # or here?
  def items_scope
    Item.where(user_id: @user.id).not_anonymous
  end
end 
```

方法覆盖：

```
def find_items
  items_scope.where(id: item_ids)
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:44:19.967

Ruby 中的语义与您可能习惯的不同。实际上，私有意味着您不能为该方法显式指定接收者，但您也可以从派生类中使用它，只要您不指定接收者即可。因此

```
class A
  def bar; 42; end
  private :bar
end

class B < A
  def foo; bar; end
end 
```

B.new.foo 工作得很好。因此，Ruby 中的 private 非常接近于其他 OO 语言中的 protected。我什至不记得 Ruby 中的 protected 是什么。它在 Ruby 中很少使用。

在您的示例中，我不会将 private 用于 find_items。我会将其公开或将其转换为 mixin（因为它不使用实例变量）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:39:59.417

如果要保留原始可见性，则必须使新的覆盖​​方法受到保护。如果您不这样做，它将具有公开可见性：

```
class A
  protected
  def f; 'A'; end
end

class B < A
  def f; 'B'; end
end

class C < A
  protected
  def f; 'C'; end
end

A.new.f  #=> #<NoMethodError: protected method `f' called for #<A:0x007fa754bdd0a0>>
B.new.f  #=> 'B'
C.new.f  #=> #<NoMethodError: protected method `f' called for #<C:0x007fc4f19f2af0>> 
```

最终，这取决于您，但保持原始方法的可见性可能是一个好主意，除非您有特定的理由不这样做。

# javascript - 如何将 jQuery 扩展仅应用于 html 文档中的某些元素

> ID：14321504
> 
> 赞同：-2
> 
> 时间：2013-01-14T15:34:37.787
> 
> 标签：javascript, jquery, html, select

我正在使用 jQuery 扩展来查找[此处](http://jsearchdropdown.sourceforge.net/)的可搜索下拉菜单。它工作得很好，但我只想将它应用于我页面上的一些元素，而不是所有元素。有没有办法选择它将修改哪些选择？

这就是我使用脚本的方式。我认为答案与修改该功能有关，但我无法让它工作。

```
 $(document).ready(function() {
        $("select").searchable();
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T15:36:29.497

您需要一个更具体的选择器。`$("select")`将获得所有`<select>`标签。使用 and id 或 class 更具体：

```
$('#search').searchable(); 
```

有关更多信息，请参阅[jQuery 选择器文档](http://api.jquery.com/category/selectors/?rdfrom=http://docs.jquery.com/mw/index.php?title=Selectors&redirect=no)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:37:06.723

使用类怎么样？

```
<select class="searchable"><!-- content --></select> 
```

比js：

```
$(document).ready(function() {
    $("select.searchable").searchable();
}); 
```

如果需要，您甚至可以反转行为（但我不推荐）：

```
$(document).ready(function() {
    // only select those without the searchable class
    $("select:not(.searchable)").searchable();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T15:40:05.767

您还可以指定仅在某个 div 中使用选择元素：`$('#div select').searchable();`

# iphone - 从 NSArray Objective-C 创建 NSMutableArray

> ID：14321512
> 
> 赞同：7
> 
> 时间：2013-01-14T15:35:05.617
> 
> 标签：iphone, objective-c, nsmutablearray, nsarray

我有一个 NSArray，它给了我以下数据：

```
01/14/2013 13:28:06.559 IUser Reader [71164: c07] (
         {
         "id_acompanhante" = "";
         "id_evento" = 34;
         "user_id" = 1;
         "inserido_por" = "Himself";
         name = iUser;
         status = done;
         type = User;
     }
         {
         "id_acompanhante" = 1;
         "id_evento" = 34;
         "user_id" = 1;
         "inserido_por" = iUser;
         name = "Mayara Roca";
         status = naofeito;
         type = companion;
     }
) 
```

如何将此数据播放到 NSMutableArray 并在每个项目中添加另一个字段。例子：

```
 {
     "id_acompanhante" = "";
     "id_evento" = 34;
     "user_id" = 1;
     "inserido_por" = "Himself";
     name = IUser;
     status = done;
     type = User;
     tag = 2;
 } 
```

我又添加了一个字段“TAG”。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-14T15:51:29.260

```
NSMutableArray *mutableArray = [NSMutableArray array];

for (NSDictionary *dictionary in yourArray) {
    NSMutableDictionary *mutDictionary = [dictionary mutableCopy];

    [mutDictionary setObject:[NSNumber numberWithInt:2] forKey:@"tag"];

    [mutableArray addObject:mutDictionary];
} 
```

这就是你问的方法。使数组可变将不允许您更改其中字典的内容。您需要取出每个字典并使其可变，然后将其存储回数组中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-14T15:37:13.177

简单的

```
NSMutableArray *mArray = [NSMutableArray arrayWithArray:yourArray]
[mArray addObject:yourObject]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T15:43:35.863

就像在数组上调用 mutableCopy 一样简单：

```
NSArray * myArray = @[@"one", @"two", @"three"];
NSMutableArray * myMut = [myArray mutableCopy];
NSLog(@"My Mut = %@", myMut); 
```

希望有帮助！

**更新** 这是一个迭代原始数组、将项目转换为可变字典并插入新属性的示例。然后你扔掉你的原始数组并使用 myMut 版本。

```
NSArray * myArray = @[@{@"key1":@"value1"}, @{@"key2":@"value2"}];
NSMutableArray * myMut = [[NSMutableArray alloc] init];
for (NSDictionary * dict in myArray) {
    NSMutableDictionary * mutDict = [dict mutableCopy];
    [mutDict setObject:@"2" forKey:@"tag"]; // Add new properties
    [myMut addObject:mutDict];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T15:38:10.027

试试这个

```
NSMutableArray *aMutableArray = [NSMutableArray arrayWithArray:anArray]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-14T16:20:08.410

据我了解，您不需要可变数组，但需要将数组中的 NSDictionaries 转换为可变数组。其他人也回答了这个问题。

但我想展示一个绝妙的技巧，您可以如何设置在线向所有可变字典添加键/值对。我像你一样使用更简单的数据，以便更容易看到发生了什么。

```
//just an example array of mutable Dictionary
NSMutableArray *array = [NSMutableArray array];
[array addObject:[NSMutableDictionary dictionaryWithObject:@"one" forKey:@(1)]];
[array addObject:[NSMutableDictionary dictionaryWithObject:@"two" forKey:@(2)]];
[array addObject:[NSMutableDictionary dictionaryWithObject:@"three" forKey:@(3)]];

// and here is the trick
[array setValue:@"10" forKey:@"tag"]; 
```

该数组现在包含

```
(
{
    tag = 10;
    1 = one;
},
{
    tag = 10;
    2 = two;
},
{
    3 = three;
    tag = 10;
}
) 
```

[来自 NSArray 文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/NSArray.html#//apple_ref/doc/uid/20000137-BAJJCBIE)

> **`setValue:forKey:`**
> 使用指定的值和键对数组的每个项目调用 setValue:forKey:。
> 
> ```
> - (void)setValue:(id)value forKey:(NSString *)key 
> ```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-17T08:37:07.663

```
NSArray *theOldArray; // your old array
NSMutableArray *theMutableAry = [NSMutableArray array];
for (NSDictionary *dicItem in theOldArray)
{
    NSMutableDictionary *dicWithOneMoreField = [NSMutableDictionary dictionaryWithDictionary:dicItem];
    [dicWithOneMoreField setValue:@"your value for tag" forKey:@"tag"];
    [theMutableAry addObject:dicWithOneMoreField];
} 
```

或尝试其他方式

```
NSData* archivedData = [NSKeyedArchiver archivedDataWithRootObject:theOldArray];
NSMutableArray *mutableArray = [NSKeyedUnarchiver unarchiveObjectWithData:archivedData];
for (NSDictionary *dicItem in mutableArray)
{
    [dicItem setValue:@"your value for tag" forKey:@"tag"];
} 
```

# python - 在 django 模板中访问查询集对象

> ID：14321515
> 
> 赞同：21
> 
> 时间：2013-01-14T15:35:15.553
> 
> 标签：python, django, django-templates

我有两个模型，分别命名为`Human`和`Animal`。Human 的主键是 Animal 模型中的外键。两者各有 3 列。人体模型有 c、e、r 列。动物模型有 l、i、p 列。我正在对 Human 模型运行 django 查询，就像这样。

```
result = Human.objects.filter().order_by('r') 
```

`result`是一个查询集对象。该对象从我的视图文件发送到 django 模板页面。在模板页面内部，我正在循环`result`并显示列值。

现在我想做的是，我还想`p`在 django 模板内的同一个循环中获取列的值（存在于 Animal 模型中）。我们如何在django模板页面中做到这一点。

在python文件中我可以这样做

```
for i in result:
    print i.animal_set.values()[0]['p'] 
```

但我想在模板页面中进行。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-14T15:40:43.103

```
{% for record in result %}
    {{record.c}}, {{record.e}}, 
    {% for animal in record.animal_set|slice:":1" %}
        {{animal.p}}
    {% endfor %}
{% endfor %} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-14T15:47:12.027

首先，我想提一下您的数据库架构似乎有问题。如果“c”、“e”、“r”等是列的真实名称 - 考虑重命名它们。其次，在您提供的示例 Python 代码中，没有捕获 IndexErrors。如果要获取第一个与 Human 对象相关的 Animal，最好在 Human 模型中创建一个 getter 方法：

```
def get_first_animal(self):
  try:
    return self.animal_set[0]
  except IndexError:
    return None 
```

如果您需要显示模板中的所有动物，您可以尝试以下操作：

```
{% for animal in human.animal_set.all %}
{{ animal }}
{% endfor %} 
```

给出的变量名称是不同的，但在您的情况下，最好重新分解代码。

# r - 替换列表元素（避免全局赋值）

> ID：14321517
> 
> 赞同：6
> 
> 时间：2013-01-14T15:35:18.703
> 
> 标签：r

我有一个非嵌套列表（非常简单）。有些元素是 NA，但可以用同一列表中的其他元素替换。我可以使用全局赋值运算符来实现这一点`<<-`。但是我正在尝试学习更好的实践（因为这似乎在`notes`为 CRAN 编译包时给了我）。问题：

1.  我可以在没有全局分配的情况下实现这一目标吗？
2.  如果不是，我该如何`assign`正确使用（我的方法似乎制作了同一数据集的一堆副本，并且可能会遇到内存问题）。

我已经尝试分配，但它不起作用。我也尝试在`lapply`没有全局分配的情况下使用，但我只能返回最后一个元素，而不是替换每个元素的列表。

**这是问题所在：**

```
#Fake Data
L1 <- lapply(1:3, function(i) rnorm(1))
L1[4:5] <- NA
names(L1) <- letters[1:5]

#items to replace and their replacements (names of elements to replace)
nulls <- names(L1[sapply(L1, function(x) is.na(x))])
replaces <- c("b", "a")

#doesn't work (returns only last element)
lapply(seq_along(nulls), function(i) {
    L1[[nulls[i]]] <- L1[[replaces[i]]]
    return(L1)
})

#works but considered bad practice by many
lapply(seq_along(nulls), function(i) {
    L1[[nulls[i]]] <<- L1[[replaces[i]]]
})

#does not work (I try L1[["d"]] and still get NA)
lapply(seq_along(nulls), function(i) {
    assign(paste0("L1[[", nulls[i], "]]"), L1[[replaces[i]]], envir = .GlobalEnv)
})

#also bad practice bu I tried
lapply(seq_along(nulls), function(i) {
    assign(paste0("L1$", nulls[i]), L1[[replaces[i]]], envir = .GlobalEnv)
})

#This works but it feels like we're making a ton of copies of the same data set
lapply(seq_along(nulls), function(i) {
    L1[[nulls[i]]] <- L1[[replaces[i]]]
    assign("L1", L1, envir = .GlobalEnv)
}) 
```

最终，我想在没有全局分配的情况下执行此操作，但如果不是，那么对于 CRAN 构建包的最佳实践是什么。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-14T15:47:18.723

有一个`replace`功能可以为您执行此操作：

```
replace(L1, match(nulls, names(L1)), L1[match(replaces, names(L1))]) 
```

您也可以使用稍微简单`which(is.na(L1))`的，而不是`match(nulls, names(L1))`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T17:52:49.197

为了完整起见，这里是哈德利对 for 循环的建议，因为一些类似的情况不允许使用`replace`：

```
for(i in seq_along(a[!apps])){
    L1[[nulls[i]]] <- L1[[replaces[i]]]
} 
```

# jquery - 带有 jQ uery 的图库

> ID：14321519
> 
> 赞同：0
> 
> 时间：2013-01-14T15:35:22.027
> 
> 标签：jquery, html, gallery

我有以下问题必须让图片库在一些延迟后更改图片，但用户也可以选择在字段中输入其他延迟并通过按钮设置新延迟。我设法用默认延迟的画廊做第一部分，但有问题必须从字段中获取新数据并设置的第二部分是使用按钮。这里有一些代码

```
<script>
   $(function(){
       $('.fadein img:gt(0)').hide();
    var speed="200";//Slide show speed
       setInterval(function(){$('.fadein :first-child').fadeOut().next('img').fadeIn().end().appendTo('.fadein');}, speed);
   });
</script>

<script>
   $(function delay()
   {
      document.getElementById("delay").value=document.setElementById("var speed").value;
   }
</script>

<button id="slide" type="button" onclick="setdelay()">Click Me!</button>
<input type="delay" id="delay"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:44:40.780

我猜你需要这样的东西：

```
<script>
   $(function delay()
   {
      speed = document.getElementById("delay").value;
      setInterval(function(){$('.fadein :first-child').fadeOut().next('img').fadeIn().end().appendTo('.fadein');}, speed);
   }
</script> 
```

# security - Websphere 应用服务器 - 不要重定向到 https

> ID：14321520
> 
> 赞同：1
> 
> 时间：2013-01-14T15:35:22.417
> 
> 标签：security, https, websphere

我在本地计算机上安装了 WAS，我正在尝试将一些自定义逻辑与 websphere 业务监视器集成。

我需要将要处理的 xml 消息发送到指定的 rest 接口。

在我的代码中，我使用 jersey api for rest 来简化创建连接。

这是一个链接，其中包含有关此休息接口的一些信息

[http://publib.boulder.ibm.com/infocenter/dmndhelp/v6r2mx/index.jsp?topic=/com.ibm.bspace.620.help.api.rest.doc/apis/eventemitter/index.htm](http://publib.boulder.ibm.com/infocenter/dmndhelp/v6r2mx/index.jsp?topic=/com.ibm.bspace.620.help.api.rest.doc/apis/eventemitter/index.htm)

如果我使用`https://localhost:9443`url 并且如果我在客户端 jvm 端“禁用”ssl 安全性，我可以发送事件。

我知道有一天我需要生成证书和所有这些，但现在我只想使用普通的 http 访问这个接口，比如`http://localhost:9080`.

问题是，如果我使用这个 URL，我会得到 302 返回码，我会被重定向到旧的。

我的问题是，我需要更改什么以便不会重定向到`https`版本？

我注意到这个“接口”没有列在 中`Services->Rest Services`，但是存在一个应用程序`IBM_WBM_EMITTER_SERVICES`，所以我怀疑我可能需要在这个应用程序设置中更改一些东西，以便它可以“接受”普通的旧`http`连接。

# exchange-server - 如何（通过 EWS）确定 Exchange Server 使用的时区？

> ID：14321526
> 
> 赞同：1
> 
> 时间：2013-01-14T15:35:39.230
> 
> 标签：exchange-server, exchangewebservices

如果我通过 Exchange Web 服务访问用户的日历，我正在尝试确定 Exchange Server 使用的时区。
[GetServerTimeZones](https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getservertimezones-operation)不能解决问题。
我已经在用户日历上尝试了 GetFolder 调用，但没有看到那里的属性（或在连续的 ParentFolders 上）。

我无法直接访问 Exchange 服务器，我的程序必须通过 Exchange Web 服务调用进行通信。
这需要从 Exchange 2007 开始工作。

为了混淆我读到的评论说 Exchange 服务器可以有单独的时区设置，[例如 OWA](http://www.education.purdue.edu/edit/emailstuff/outlook/OWATIMEZONE/welcome.htm)。

我从哪里开始？
任何可以解决问题的 Exchange 托管 API 代码也可能对我有所帮助。

提前
致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T16:00:36.677

在内部，Exchange 以 UTC 存储日历项目的所有日期。服务器本身没有日历项目的时区概念。当 OWA 和 Outlook 等客户端向最终用户显示约会日期时，UTC 日期将转换为客户端的时区。您不应将 OWA 设置与 Exchange 实际存储其数据的方式相混淆。OWA 只是一个类似于 Outlook 的客户端。

如果您愿意，EWS 为您提供了一种进行这种转换的方法。因此，当使用 EWS 从 Exchange 请求约会时，您可以指定希望 EWS 将日期转换为哪个时区。

这里有几篇文章供您阅读，了解它是如何工作的：

*   [EWS 托管 API 中的时区](http://msdn.microsoft.com/en-us/library/office/dd633689.aspx)
*   [将 Exchange Web 服务用于日历任务的最佳实践](http://msdn.microsoft.com/en-us/library/bb738399.aspx)
*   [在 Exchange 中使用 EWS 更新时区](https://msdn.microsoft.com/en-us/library/office/dn789030.aspx)

# clojure - 如何调试在运行时创建的 clojure 代码？

> ID：14321527
> 
> 赞同：2
> 
> 时间：2013-01-14T15:35:40.340
> 
> 标签：clojure, code-generation

假设我有一个用 clojure 编写的应用程序，它在运行时生成代码。如何调试该代码 - 我没有源代码？

**编辑：**我在问这个问题，因为我正在和我的同事谈论 clojure，他说由于上述原因，clojure 程序很难（或不可能）测试。我认为这是一种评估者悲观的方法。如果它是不可测试的，没有人会使用它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T18:11:22.370

Clojure 为您提供了如此强大的功能，因此您不需要`debug`开发在其他不太强大的语言（如 java、c++ 等）中常见的样式。

1.  **回复**_ 您可以随时评估任何函数或表达式。您可以准备环境并重现您需要测试的情况。
2.  **不变性**。Clojure 提供了出色的不可变集合和纯函数库。还有 STM 可以让您完全控制应用程序的状态。您可以将程序的可变部分与纯功能代码隔离开来，并使这些部分尽可能小，以便测试负责状态管理的代码变得更加容易（在常见情况下）。测试纯功能部分更加有趣和容易。
3.  **[自下而上编程](http://www.paulgraham.com/progbot.html)**。在 clojure 中，您可以分小块编写代码。您正在使用小型纯函数，直到您可以为下一个继续此过程的底层构建底层（库、dsl）。测试小（纯）功能非常容易。
4.  **记录**。显然，您可以在任何代码点记录任何输入参数值。

如果您保持这种编程风格，您将减少真正需要调试的机会。在您的情况下，您可以通过 REPL 完成所有工作。您可以通过 logging 获取生成“调试”动态代码的函数的输入参数。之后，您将以相同的方式获取此动态代码的输入参数。最后，您将同时拥有生成的“调试”代码和输入参数。因此，您可以轻松地重现情况并进行测试。

**更新**。关于问题的编辑部分，仅仅因为您的程序动态生成代码而说“clojure 程序很难（或不可能）测试”是不正确的。请记住，生成的代码仍然是可以像通常的数据集合一样操作的数据。您无需在断点处构建、运行和冻结整个应用程序即可查看那里发生了什么。我已经描述了测试动态代码的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T18:12:54.253

[您可以尝试使用clojure/tools.trace](https://github.com/clojure/tools.trace)中的方法使生成的代码包含某种跟踪。

例如，如果您正在定义函数，您可以使用`deftrace`而不是使用`defn`which 来跟踪调用。

从旧文档（它曾经在 clojure-contrib 中，但从 1.3 开始，它在 clojure/tools.trace 中——这个文档来自 contrib 页面**编辑：** [链接](http://richhickey.github.com/clojure-contrib/trace-api.html)）：

> 跟踪
> 
> 用法：（deftrace 名称和定义）
> 
> 用于代替定义；跟踪此 fn 的每个调用/返回，包括参数。对 deftrace 函数的嵌套调用将打印一个树状结构。

lib 中还有其他方法可能也很方便。

[其他调试建议，包括我从哪里获得有关跟踪库的信息。](https://stackoverflow.com/questions/2352020/debugging-in-clojure)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T17:30:49.917

这有点麻烦，但是如果您将生成的代码写入临时文件并随后加载和评估其内容，那么您将通过堆栈跟踪中的行号获取调试信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T15:55:32.927

像所有其他代码一样 - 将调试语句（如日志）添加到代码中。无论如何，F10-F10-F10 风格的调试器对于任何更复杂的代码都是无用的，不应该使用。

# javascript - 为什么在这个例子中 Javascript 中“this”的上下文没有改变？

> ID：14321534
> 
> 赞同：1
> 
> 时间：2013-01-14T15:35:59.640
> 
> 标签：javascript, this

我正在尝试使用 Javascript 中的“this”上下文，但遇到了一种我不明白的情况。

根据从[此处](http://yehudakatz.com/2011/08/11/understanding-javascript-function-invocation-and-this/)找到的 javascript 工作方式，我了解当在对象上调用函数时，该对象会作为最触发参数隐式传入（或在使用`call`方法时显式传入。

但是有 2 个案例我尝试测试并没有达到我的预期。请查看*//Why doesn't work?之后的 2 行 为什么以下 2 个值未定义？*

这是[jsFiddle](http://jsfiddle.net/ehT4b/7/)中的代码（也粘贴在下面）

```
function Beta(c, myValParam) {
  var callback = c;
  this.myVal = myValParam;
  this.RunCallback = function () {
   callback();
  }

  this.ShowVal = function () {
    alert("FROM Beta: " + this.myVal);
  }
}

function Alpha() {
  this.myVal = "Alpha's Property";
  this.ShowVal = function () {
    alert("FROM Alpha: " + this.myVal);
  }
}
a = new Alpha();
a.ShowVal();

b = new Beta(a.ShowVal, "Beta's property passed in");
b.ShowVal();

//Why doesn't ths work? Why are the follwoing 2 values undefined?
b.RunCallback.call(b); //Shouldn't this display the value in b?
b.RunCallback();

b2 = new Beta(function() { return a.ShowVal.call(a); }, "Z");
b2.RunCallback(); 
```

**编辑：**感谢 Quentin、dystroy 和dough 的回答，我[更新了 jsFiddle](http://jsfiddle.net/ehT4b/10/)以显示上下文恢复到窗口对象时产生的值

这是解决我遇到的问题[的调用代码](http://jsfiddle.net/ehT4b/11/) `callback.call(this)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:39:46.487

> Shouldn't this display the value in b?

You are calling (in the context of `b`) a function which does nothing with `this`. That function calls `callback` (which is a copy of `a.showVal`) in the context of `window` (the default object).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:39:57.407

You forgot one step in the definition of `RunCallback` :

Replace

```
callback(); 
```

with

```
callback.call(this); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T15:45:42.867

我认为您的问题是，当您调用时，`callback`您没有传递上下文，因此您输了`this`. 尝试像这样更新 RunCallback：

```
 this.RunCallback = function () {
   callback.call(this);
  } 
```

# php - 正则表达式不是字符

> ID：14321536
> 
> 赞同：0
> 
> 时间：2013-01-14T15:36:06.830
> 
> 标签：php, regex

我需要一个不允许字符的正则表达式。

```
^[A-Z0-9 _]*[A-Z0-9][A-Z0-9 _]*$ 
```

这些似乎不起作用，因为我需要转义任何类型的字符（英语、中文、希腊语等）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:38:49.170

If you only want to accept digits and the . character using POSIX (PHP):

```
^[.1-9]*$ 
```

* * *

If you want to explicit exclude word characters

```
^[^\w]*$ 
```

This will match anything but [word](http://msdn.microsoft.com/en-us/library/20bw873z.aspx#WordCharacter) characters.

Note (that as has been replied in the comments):

*   this will work with JGsoft, .NET, Perl, Python.
*   It will *not* work if using Java, JavaScript, PCRE, Ruby, POSIX.

You edited your post and stated that you use PHP. As far as I know it uses POSIX ERE. In that case this solution will *not* work. However I keep my answer for the search functionality in case another user (that does use the supported engines) finds this answer.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:40:30.797

使用`\p{L}`或`\p{Letter}`匹配任何语言的任何 (Unicode) 字母。要匹配任何非字母，您应该使用：`\p{^L}`或`\P{L}`（取决于您使用的正则表达式引擎）来否定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T15:45:03.040

任何字符 \w
不是字符 \W

# spring - 将 Spring Batch 作业存储库数据库切换到 MySQL 时序列不起作用

> ID：14321544
> 
> 赞同：1
> 
> 时间：2013-01-14T15:36:44.083
> 
> 标签：spring, spring-batch

我在生产中有一个 Spring Batch 部署，它最初是使用 H2 数据源作为作业存储库开发的。最初的努力一切都很好，但是随着我们对 Spring Batch 的使用扩展，我们希望用更传统的数据库替换 H2。无论好坏（这不完全是我的决定），我将改用 MySQL。

我已将作业存储库的数据源从 H2 切换到 MySQL，并将元素更改为使用“ `classpath:/org/springframework/batch/core/schema-mysql.sql`”。当我第一次运行批处理作业时，Spring Batch 会创建存储库表并毫无问题地运行我的作业。

但是，后续执行失败......即使我正确使用了作业增量器，传递了“ `-next`”参数，并且已经看到它在 H2 上运行良好。当我将日志记录设置为“调试”级别时，我在后续执行中看到以下异常：

```
org.springframework.dao.DuplicateKeyException: PreparedStatementCallback; SQL [INSERT into BATCH_JOB_INSTANCE(JOB_INSTANCE_ID, JOB_NAME, JOB_KEY, VERSION) values (?, ?, ?, ?)]; 
Duplicate entry '1' for key 'PRIMARY'; 
nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Duplicate entry '1' for key 'PRIMARY' 
```

我查看了`schema-*.sql`Spring Batch 用于创建其作业存储库表的“”脚本。其他数据库类型（例如 H2、Oracle、Postgres 等）创建三个序列... `BATCH_STEP_EXECUTION_SEQ`、、`BATCH_JOB_EXECUTION_SEQ`和`BATCH_JOB_SEQ`。我不是 MySQL 专家，但看起来 MySQL 缺乏对序列的支持......因为 " `schema-mysql.sql`" 包含这些行作为明显的解决方法：

```
CREATE TABLE BATCH_STEP_EXECUTION_SEQ (ID BIGINT NOT NULL) ENGINE=MYISAM;
INSERT INTO BATCH_STEP_EXECUTION_SEQ values(0);
CREATE TABLE BATCH_JOB_EXECUTION_SEQ (ID BIGINT NOT NULL) ENGINE=MYISAM;
INSERT INTO BATCH_JOB_EXECUTION_SEQ values(0);
CREATE TABLE BATCH_JOB_SEQ (ID BIGINT NOT NULL) ENGINE=MYISAM;
INSERT INTO BATCH_JOB_SEQ values(0); 
```

很明显，MySQL 对序列和自动增量值的处理与其他数据库不同，因此可能 Spring Batch 必须做一些不同的事情来增加其作业存储库表中的 ID。我是否需要采取其他一些我可能不知道的特定于 MySQL 的步骤？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T21:50:19.173

问题是我在`classpath:/org/springframework/batch/core/schema-mysql.sql`每个作业运行时都在执行脚本。

使用 H2，这很好……只要`jdbc:initialize-database`元素包含该`ignore-failures="ALL"`属性，您就不会真正注意到问题。

但是，MySQL 特定的序列解决方法不是您可以重复执行而不会弄乱 Spring Batch 的东西。

我`jdbc:initialize-database`从我的 Spring Batch 配置中删除了该元素，在一个空数据库中手动执行了`classpath:/org/springframework/batch/core/schema-mysql.sql`一次该设置脚本，并且我的工作可以很好地运行多个调用。

# php - php页面到ajax之间的URL编码问题

> ID：14321546
> 
> 赞同：0
> 
> 时间：2013-01-14T15:36:55.740
> 
> 标签：php, jquery, ajax, url

`encodeURIComponent()`我有一个从 ajax 接收 url 的 php 页面，该 url在使用 ajax 发布之前正在经历。

在php页面中，我尝试了有`urldecode()`或没有它。两种方式都返回相同的错误网址，其中包含`&amp;`而不是 & 我想我可以`str_replace`，但我认为这里还有其他问题，替换可能不是答案。

html/ajax 代码：

```
var ajax_url = $('#base_url').val() + 'xxx';
var url_to_search = encodeURIComponent($('#sometextfield').val());
$.ajax({
    type: "POST",
    url: ajax_url,
    data: { ajax_vari: "ajax", url_to_search: url_to_search}
    }).success(function(insertID) {
        alert(insertID);
    }); 
```

php页面：

```
if(isset($_POST['ajax_vari']) && $_POST['ajax_vari'] == 'ajax'){
     echo $_POST['url_to_search'];
     echo urlencode($_POST['url_to_search']);
} 
```

URL 示例：

**html/ajax**

原网址：`http://www.llbean.com/llb/shop/77754?feat=502857-GN2&page=men-s-mif-w-baseball-cap-black-bear&attrValue_0=Woodland&productId=1286129`

之后`encodeURIComponent()`：`http%3A%2F%2Fwww.llbean.com%2Fllb%2Fshop%2F77754%3Ffeat%3D502857-GN2%26page%3Dmen-s-mif-w-baseball-cap-black-bear%26attrValue_0%3DWoodland%26productId%3D1286129`

**php页面：**

之后`urldecode()`：`http://www.llbean.com/llb/shop/77754?feat=502857-GN2&amp;page=men-s-mif-w-baseball-cap-black-bear&amp;attrValue_0=Woodland&amp;productId=1286129`

没有`urldecode()`：`http://www.llbean.com/llb/shop/77754?feat=502857-GN2&amp;page=men-s-mif-w-baseball-cap-black-bear&amp;attrValue_0=Woodland&amp;productId=1286129`

谢谢

# asp.net - ASP.NET 处理程序“StaticFile”的模块列表中有一个错误模块“DefaultDocumentModule”

> ID：14321551
> 
> 赞同：1
> 
> 时间：2013-01-14T15:37:05.860
> 
> 标签：asp.net, iis, mindtouch

我正在尝试将 MindTouch Core 安装到 IIS8 上。安装工作得很好，但后来我看到了这条消息。这是什么意思？

请注意，我已经完全安装了 ASP.NET，所以这不是问题。此外，这不是应用程序池的问题，我都试过了。

这是`web.config`该网站的文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <validation validateIntegratedModeConfiguration="false"/>
        <handlers accessPolicy="Read, Execute, Script">
            <clear/>
            <add name="PHP via FastCGI" path="*.php" verb="*" modules="FastCgiModule" resourceType="Unspecified" scriptProcessor="D:\MindTouch\redist\php\php-cgi.exe"/>
            <add name="StaticFile" path="*" verb="*" type="" modules="StaticFileModule,DefaultDocumentModule,DirectoryListingModule" scriptProcessor="" resourceType="Either" requireAccess="Read" preCondition=""/>            
        </handlers>
        <isapiFilters>
            <filter name="IsapiRewrite4" path="D:\MindTouch\web\bin\IsapiRewrite4.dll"/>
        </isapiFilters>
        <defaultDocument>
            <files>
                <add value="index.php"/>
            </files>
        </defaultDocument>
    </system.webServer>  
</configuration> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T04:03:12.543

查看此条目中记录的调查步骤，查看评论和答案，看看它是否没有缩小问题的范围： [DefaultDocument 突然无法在 IIS7 上运行](https://stackoverflow.com/questions/4594829/defaultdocument-suddenly-not-working-on-iis7)

本文解释了有关全局模块的更多信息： [http ://www.iis.net/learn/get-started/introduction-to-iis/iis-modules-overview](http://www.iis.net/learn/get-started/introduction-to-iis/iis-modules-overview)

# linux - 在 Linux 中使用 Mac OS 命令“codedesign”

> ID：14321559
> 
> 赞同：4
> 
> 时间：2013-01-14T15:37:25.127
> 
> 标签：linux, macos, code-signing

> codesign 命令用于创建、检查和显示代码签名，以及查询系统中签名代码的动态状态。

Linux中是否有等效的“codedesign”命令？

[https://developer.apple.com/library/mac/#documentation/security/Conceptual/CodeSigningGuide/Introduction/Introduction.html](https://developer.apple.com/library/mac/#documentation/security/Conceptual/CodeSigningGuide/Introduction/Introduction.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-01-03T12:33:45.793

如前所述，没有真正的等价于`codesign`.

不过话说回来，`codesign`它的配套程序都是在[苹果开源开发模式](https://www.apple.com/opensource/)下发布的。

所以，如果你喜欢挖掘[代码设计代码](http://www.opensource.apple.com/source/security_systemkeychain/security_systemkeychain-55191/src/)，那么我相信会有很多其他人对结果感兴趣

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-01-20T01:27:26.843

现在有很多解决方案！！！！

你可以查看这些 github 项目：

[https://github.com/saucelabs/isign](https://github.com/saucelabs/isign)

和

[https://github.com/zhlynn/zsign](https://github.com/zhlynn/zsign)

我和他们一起工作过，他们两个都足够好！但是 isign 项目需要一些贡献来满足您的所有需求，但它适用于 ios<12 ！

zsign 太干净且易于设置！

我希望这可以帮助你！

**更新：**

zsign 目前在 ios 12 上运行良好，我建议你使用它！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-14T15:44:57.830

Linux 不使用代码签名。没有等价物。Linux 上的签名是在打包级别完成的，而不是在可执行级别。例如，您可以签署 RPM 包。

# netty - Main thread exits before workers

> ID：14321562
> 
> 赞同：0
> 
> 时间：2013-01-14T15:37:37.640
> 
> 标签：netty

In some of my experiments with Netty the main thread exits before all the I/O threads are complete. I've been using a CountDownLatch to prevent this. Is this the right approach? Is there a standard approach for avoiding this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:45:42.207

我会说倒计时锁存器是一个好方法。但我不知道我是否称其为标准。一般来说，关机是一个难题。我工作过的大多数应用程序都使用了一系列不同的方法来关闭它们的各种组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T03:09:56.800

您可以等到您创建的频道关闭。例如：

```
public static void main(St ring[] args) throws Exception {
    ChannelFactory f = ...;
    try {
        ...
        Channel ch = bootstrap.connect().sync();
        ch.getCloseFuture().sync(); // Wait until the channel is closed.
    } finally {
        f.releaseExternalResources();
    }
} 
```

# jquery - jquery to hide or show comments if no comments not working

> ID：14321569
> 
> 赞同：0
> 
> 时间：2013-01-14T15:38:15.507
> 
> 标签：jquery

i have a status update system in which when a user updates a status people can comment. But the problem is when i click on reply the comment box opens and closes on its own even without giving time to write anything .

there is one code which check when we do a status update and if there is comments (which obviously wont be as we just updated the status it would just hide the commentbox ). and it is somehow effecting the opening of any other clicked comment box . when i remove `var t = setTimeout("BpActivityReply()", 325);` this line the comment box opens fine but when a new status update it pre opens which should not happen. can anyone suggest where i am wrong

```
 if (typeof jq == "function") {
jq("#content").ajaxComplete(function (evt, request, settings) {

    var t = setTimeout("BpActivityReply()", 325);
});
jq("div.activity").click(function (event) {
    var target = jq(event.target);
    if (target.hasClass("acomment-reply") || target.parent().hasClass("acomment-reply")) {
        BpActivityReply();
        if (target.parent().hasClass("acomment-reply")) {
            target = target.parent();
        }
        var id = target.attr("id");
        ids = id.split("-");
        var form = jq("#ac-form-" + ids[2]);
        form.parents(".activity-replies").slideDown(200);
        return false;
    }
});
jq(document).keydown(function (e) {
    e = e || window.event;
    if (e.target) {
        element = e.target;
    } else {
        if (e.srcElement) {
            element = e.srcElement;
        }
    }
    if (element.nodeType == 3) {
        element = element.parentNode;
    }
    if (e.ctrlKey == true || e.altKey == true || e.metaKey == true) {
        return;
    }
    var keyCode = (e.keyCode) ? e.keyCode : e.which;
    if (keyCode == 27) {
        if (element.tagName == "TEXTAREA") {
            if (jq(element).hasClass("ac-input")) {
                formContainer = jq(element).parent().parent().parents(".activity-replies");
            }
            if (formContainer.find("ul").length <= 0) {
                formContainer.slideUp(200);
            }
        }
    }
});
BpActivityReply();
 }

function BpActivityReply() {
    jQuery(".activity-replies").each(function () {
        hasComments = jQuery(this).find("ul").first().children("li:visible");
        if (hasComments.length <= 0) {
            jQuery(this).css("display", "none");
        } else {
            jQuery(this).slideDown(200);
        }
    }); 
```

# toggle - javafx stage setscene

> ID：14321570
> 
> 赞同：1
> 
> 时间：2013-01-14T15:38:16.407
> 
> 标签：toggle, javafx-2, scale, stage, scene

guys. I have to make toggle scenes in the one stage. Last one may be resized. So I meet the problem - active scene is not recalculate layout after setScene() called, only after resizing action of the Stage. Are there somebody know where is my mistake or it is Stage specific bug? here my code example

```
public class SceneToggle extends Application {
Stage primaryStage;
Scene scene1;
Scene scene2;
@Override
public void start(Stage _primaryStage) {
    primaryStage=_primaryStage;
    StackPane root1 = new StackPane();
    root1.getChildren().addAll(new Rectangle(0,0,100,100));
    scene1 = new Scene(root1,Color.RED);
    StackPane root2 = new StackPane();
    root2.getChildren().addAll(new Circle(0,0,50));
    scene2 = new Scene(root2,Color.GREEN);
    primaryStage.setScene(scene1);
    double screenWidth=200;
    double screenHeight=200;
    scene1.getRoot().scaleXProperty().bind(primaryStage.widthProperty().divide(screenWidth));
    scene1.getRoot().scaleYProperty().bind(primaryStage.heightProperty().divide(screenHeight));
    scene2.getRoot().scaleXProperty().bind(primaryStage.widthProperty().divide(screenWidth));
    scene2.getRoot().scaleYProperty().bind(primaryStage.heightProperty().divide(screenHeight));
    ObservableList<Screen> screens = Screen.getScreens();
    Rectangle2D primaryScreenBounds = screens.get((screens.size() > 1) ? 1 : 0).getBounds();
    primaryStage.setX(primaryScreenBounds.getMinX());
    primaryStage.setY(primaryScreenBounds.getMinY());
    primaryStage.setWidth(screenWidth);
    primaryStage.setHeight(screenHeight);
    primaryStage.setTitle("Scene togling");
    primaryStage.show();
    primaryStage.addEventFilter(MouseEvent.MOUSE_RELEASED, new EventHandler<MouseEvent>() {
        @Override public void handle(MouseEvent event) {
              if(primaryStage.getScene().equals(scene1)){
                  primaryStage.setScene(scene2);
              }else{
                  primaryStage.setScene(scene1);
              }

        }
    });
    /*scene1.getRoot().addEventHandler(MouseEvent.MOUSE_PRESSED, new EventHandler<MouseEvent>() {
        @Override public void handle(MouseEvent event) {
            scene2.getRoot().setVisible(true);
            primaryStage.setScene(scene2);
            scene1.getRoot().setVisible(false);
        }
    });
    scene2.getRoot().addEventHandler(MouseEvent.MOUSE_PRESSED, new EventHandler<MouseEvent>() {
        @Override public void handle(MouseEvent event) {
            scene1.getRoot().setVisible(true);
            primaryStage.setScene(scene1);
            scene2.getRoot().setVisible(false);
        }
    });*/
    /*scene1.getRoot().addEventHandler(MouseEvent.MOUSE_PRESSED, new EventHandler<MouseEvent>() {
        @Override public void handle(MouseEvent event) {
            scene2.getRoot().setVisible(true);
            primaryStage.setScene(scene2);
            scene1.getRoot().setVisible(false);
        }
    });
    scene2.getRoot().addEventHandler(MouseEvent.MOUSE_PRESSED, new EventHandler<MouseEvent>() {
        @Override public void handle(MouseEvent event) {
            scene1.getRoot().setVisible(true);
            primaryStage.setScene(scene1);
            scene2.getRoot().setVisible(false);
        }
    });*/
}

/**
 * The main() method is ignored in correctly deployed JavaFX application.
 * main() serves only as fallback in case the application can not be
 * launched through deployment artifacts, e.g., in IDEs with limited FX
 * support. NetBeans ignores main().
 *
 * @param args the command line arguments
 */
public static void main(String[] args) {
    launch(args);
} 
```

}

# java - RESTful Post 方法中的 Uri 参数

> ID：14321573
> 
> 赞同：0
> 
> 时间：2013-01-14T15:38:33.973
> 
> 标签：java, rest, post, uri, html-select

我正在开发一个 java RESTful Web 应用程序。特别是在一个网页中，在其他组件中，我有一个下拉列表：

```
 <select name="source" id="source">
    <option uri="http://localhost:9091/project/test/source/database" name="database"   count="1">database</option>
    <option uri="http://localhost:9091/project/test1/source/report2" name="report2"   count="1">report2</option>
  </select> 
```

我想在发布请求后获取用户选择的选项的 uri。为了获取 POST 方法的所有参数，我写了这个：

> ```
> @POST
> @Consumes(APPLICATION_FORM_URLENCODED)
> public Response mapDBSource(@FormParam("project") URI projectId,
>           @FormParam("source") URI sourceId, 
>           @FormParam("dest_title") String destTitle,
>           @FormParam("dest_graph_uri") URI targetGraph) throws WebApplicationException {
>     Response response = null; 
> ```

但是URI Object SourceId 的内容不是uri 的值，而只是源的名称。我的代码有什么问题？我怎么能在不显示的情况下获得 uri？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:42:59.293

你不应该使用

```
 <option value="..." 
```

代替

```
 <option uri="..." 
```

# javascript - 带有按钮的Javascript getElementbyID

> ID：14321575
> 
> 赞同：1
> 
> 时间：2013-01-14T15:38:40.313
> 
> 标签：javascript, javascript-events

编辑：我已经修复了分号、区分大小写以及括号。如果我删除按钮之后的功能，代码可以工作！为什么？

编辑：固定。我是个笨蛋。对不起！！！:-Z

当我保持简单时，像这样，一切正常：

```
 <head>
  <script>

     function buttonGRUPO()
     {
         document.getElementById("desc").innerHTML="Grupo";
     }
     function buttonPARTICULAR()
     {
         document.getElementById("desc").innerHTML="Particular";
     }

 </script>
 </head>
 <body>

    <p>&nbsp;<button class="art-button" onclick="buttonPARTICULAR()">Aulas Particulares</button></p>
    <p>&nbsp;<button class="art-button" onclick="buttonGRUPO()">Aulas em Grupo</button></p>
  <p id="desc">Text</p>
 </body> 
```

但是，每当我向脚本添加更多功能时，所有按钮和代码都会停止工作。

```
 <head>
 <script>

function buttonGRUPO()
{
    document.getElementById("desc").innerHTML="Grupo";
}
function buttonPARTICULAR()
{
    document.getElementById("desc").innerHTML="Particular";
}
function buttonINCOMPANY()
{
    document.getElementbyID("desc").innerHTML="in-COmpany";
}
function buttonINTENSIVOS()
}
    document.getElementbyID("desc").innerHTML="Intensivo";
{
function buttonIMERSIVOS()
}
    document.getElementbyID("desc").innerHTML="Imersivos"
{
function buttonPALESTRAS()
}
    document.getElementbyID("desc").innerHTML="Palestras"
}
</script>
</head> 
<body>
 <p>&nbsp;<button class="art-button" onclick="buttonPARTICULAR()">Aulas Particulares</button></p>
 <p>&nbsp;<button class="art-button" onclick="buttonGRUPO()">Aulas em Grupo</button>  </p>
 <p id="desc">Text</p>
 </body> 
```

增加几乎相同代码的数量会如何甚至破坏以前有效的代码？我在这里犯了语法错误吗？

编辑

@Woot4Moot 仍然无法正常工作

仍然不能正常工作。

```
function buttonB()
 {
document.getElementById("desc").innerHTML="B";
}
function buttonA()
{
document.getElementById("desc").innerHTML="A";
}
function buttonC()
{
document.getElementbyID("desc").innerHTML="C";
}
function buttonD()
{
document.getElementbyID("desc").innerHTML="D";
}
function buttonE()
{
document.getElementbyID("desc").innerHTML="E";
}
function buttonF()
{
 document.getElementbyID("desc").innerHTML="F";
}

<p><button onclick="buttonA()">A</button></p>
    <p><button onclick="buttonB()">B</button></p>
<p id="desc"> text</p>' 
```

更具体地说，当我将此代码加载到我的浏览器中（按钮和 p id="desc"）但是当单击按钮时，p id="desc" 不会根据 javascript 命令更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:40:36.133

除了语法错误：

```
function buttonINTENSIVOS()
}
document.getElementbyID("desc").innerHTML="Intensivo"
{
function buttonIMERSIVOS()
}
document.getElementbyID("desc").innerHTML="Imersivos"
{
function buttonPALESTRAS()
} 
```

你的牙套是错误的方式。函数以`{`not打开，`}`并且您没有分号`;`来终止每个命令

你想要的是这样的：

```
function buttonINTENSIVOS()
  {
    document.getElementbyId("desc").innerHTML="Intensivo";
  }
function buttonIMERSIVOS()
{
      document.getElementbyId("desc").innerHTML="Imersivos";
}
function buttonPALESTRAS()
{  ... } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:50:05.197

除了已经指出的内容（不正确的左/右大括号），javascript 区分大小写，因此您的方法名称不正确：

```
document.getElementbyID("...") 
```

应该

```
document.getElementById("....") 
```

（注意小写`d`in`Id`和大写`B`in `By`）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T16:32:23.937

只是为了使这个更整洁和更容易调试，我建议使用以下函数将各个函数压缩为一个：

```
function button(letter)
{
  document.getElementById("desc").innerHTML=letter;
} 
```

然后在您的 HTML 中：

```
<p><button onclick="button('A')">A</button></p>
<p><button onclick="button('B')">B</button></p>
<p><button onclick="button('C')">C</button></p>

<p id="desc"></p> 
```

注意每个括号内的单引号。该函数将直接将括号的内容打印到**p id=desc**。

# xsd - How to make a schema for an unordered list where some occur once, some many times

> ID：14321579
> 
> 赞同：3
> 
> 时间：2013-01-14T15:38:55.957
> 
> 标签：xsd

This is a similar question to [How to create a schema for an unordered list of XML nodes, with occurrence constraints](https://stackoverflow.com/questions/3382944/how-to-create-a-schema-for-an-unordered-list-of-xml-nodes-with-occurance-constr), but actually slightly simpler. However I am having great trouble understanding the logic behind sequences and choices (and especially when they are nested into sequences of choices or choices of sequences), and although I've studied it for a long time I can't understand how the example above works.

What I need is schema for a list of nodes, ChildA and ChildB, whereby ChildA can occur 0-n times, but ChildB only 0-1 times. (Actually I need several nodes of each type, but if I can do it for ChildA and ChildB, extending it to ChildX etc. and ChildY etc. should be simple). There should be no order constraint. I'd appreciate any help. Any links that explain schema indicators in depth would also be helpful.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T23:44:49.203

这将是我很快想到的最简单的解决方案。这里的关键是在“主”序列中使用另一个序列。通过将内部序列设置为开始，模式保持确定性，`<ChildB>`并`<ChildB>`通过将该序列的基数设置为 0-1 保持可选。

这是一个 XMLSchema 1.0 解决方案。

```
<xs:schema elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">

  <!-- Schema for elements ChildA and ChildB
      The requirements are as follows:
          * ChildA and ChildB may occur in any order.
          * ChildA is optional and may occur multiple times.
          * ChildB is optional and may occur once only.
  -->

  <xs:element name="root">
    <xs:complexType>
      <xs:sequence>
        <xs:element maxOccurs="unbounded" name="AB-container" type="AB-type" />
      </xs:sequence>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="AB-type">
    <xs:sequence>
      <xs:element minOccurs="0" maxOccurs="unbounded" name="ChildA" type="xs:string" />
      <xs:sequence minOccurs="0">
        <xs:element name="ChildB" type="xs:string" />
        <xs:element minOccurs="0" maxOccurs="unbounded" name="ChildA" type="xs:string" />
      </xs:sequence>
    </xs:sequence>
  </xs:complexType>

</xs:schema> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T20:03:41.780

简短的回答是它不能在 XSD 1.0 中完成。在 XSD 1.1 中，您可以使用`xsd:all`合成器（因为 XSD 1.0 中只有 maxOccurs = 1 的限制已被删除） - 但是， XSD 1.1 的问题是 i）它只能作为 beta Xerces 版本免费提供 - 到目前为止据我所知，在这个时候；ii) 有一个 SAXON 版本支持它，上次我看到对它的引用时，您必须为此付费，并且 iii) 您将很难与其他人进行互操作，因为他们中的大多数人仍在 XSD 1.0 上。

如果您可以使用 Schematron - 肯定比 XSD 1.1 更易于访问，因为它只是 XSLT 1.0/2.0，那么应该很容易对其进行编码，以使特定元素粒子的数量符合指定标准；它将增加一个 XSD，其中合成器将是重复的`xsd:choice`，其中选择选项是您允许的集合中的元素。

有些人试图通过与正则表达式的构造进行平行来解释 XSD 合成器。如果您对此熟悉，那么`xsd:all`在 XSD 1.0 中类似于方括号（虽然简单得多，没有范围或否定的概念），`xsd:choice`就像 | （管道，交替），`xsd:sequence`其余的是（重要的是你写东西的顺序）。

我看到 SO 上的其他人推荐[W3Schools](http://www.w3schools.com/schema/default.asp)。我自己没有尝试过，因此我将其与免责声明一起传递给您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T08:57:42.073

@Dave 正在向 ChildB 添加一些愚蠢的属性，好吗？由于您对 childB 的要求是 0-1，我们可以通过向 childB 添加固定属性并对属性强制执行唯一约束来实现所需的解决方案。

```
<complexType name="childAType">
 <simpleContent>
   <extension base="string"></extension>
 </simpleContent>
</complexType>

<complexType name="childBType">
 <simpleContent>
   <extension base="string">
     <attribute name="value" type="string" fixed="123"></attribute>
   </extension>
 </simpleContent>
</complexType>

<element name="root">
 <complexType>
   <choice minOccurs="0" maxOccurs="unbounded">
        <element name="childA" type="tns:childAType" minOccurs="0" maxOccurs="unbounded"></element>
        <element name="childB" type="tns:childBType" minOccurs="0" maxOccurs="unbounded"></element>
   </choice>
 </complexType>
 <unique name="childB.max.once">
   <selector xpath="./tns:childB"></selector>
   <field xpath="@value"></field>
 </unique>
</element> 
```

以下是有效的 XML 之一（B 的顺序无关紧要，或者可以排除 B）

```
<tns:root xmlns:tns=" ">
 <tns:childA></tns:childA>
 <tns:childB></tns:childB>
 <tns:childA></tns:childA>
 <tns:childA></tns:childA>
</tns:root> 
```

但是下面的无效

```
<tns:root xmlns:tns=" ">
 <tns:childB></tns:childB>
 <tns:childA></tns:childA>
 <tns:childB></tns:childB>
 <tns:childA></tns:childA>
 <tns:childA></tns:childA>
</tns:root> 
```

# css - Chrome 计算样式不正确

> ID：14321591
> 
> 赞同：1
> 
> 时间：2013-01-14T15:40:01.047
> 
> 标签：css, google-chrome, computed-style

我似乎对 Chrome 的计算样式有疑问。在某些 chrome 安装的某些元素上，计算的样式与 css 不同 ![在此处输入图像描述](../Images/f7e5dffe12ad9df901e34dc515e4489b.png)

该错误发生在整个页面的多个元素上，但未出现在同一台计算机上的 safari 或 firefox 中。该项目中只有一半的开发人员遇到过这个问题，而且它似乎每隔几天就来来去去......

有任何想法吗？

编辑：我有一个视网膜 MPB，另一个有这个问题的开发人员有一个 13 英寸的 MacBook Air，都在运行 Mountain Lion

编辑 2：这是在屏幕截图中生成计算样式的 css 块（尽管不是唯一一个有错误的

```
#nav-items div.item {
margin-left: -4px;
height: 64px;
display: inline-block;
text-align: center;
font-family: "HelveticaNeueW01-77BdCn 692722";
font-size: 26px;
text-shadow: 0px 1px 0px rgba(255,255,255,0.90);
line-height: 64px;
background-color: eee;
border-top: 1px double #ccc;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T11:59:51.663

我使用以下代码和 View -> Zoom In (once) 重现了相同的问题

这将我的字体大小从 26px 更改为 26.363636016845703px

```
<!DOCTYPE html>
<html>
<head>
<style type="text/css">
  #nav-items div.item {
  margin-left: -4px;
  height: 64px;
  display: inline-block;
  text-align: center;
  font-family: "HelveticaNeueW01-77BdCn 692722";
  font-size: 26px;

  text-shadow: 0px 1px 0px rgba(255,255,255,0.90);
  line-height: 64px;
  background-color: eee;
  border-top: 1px double #ccc;
}
</style>

</head>
<body>

<div id="nav-items">
  <div class="item">Hello World</div>
</div>
</body>
</html> 
```

解决方法是将缩放改回正常：查看 -> 实际大小

# cakephp - CakePHP subdomain routing for production/development environments on AWS

> ID：14321594
> 
> 赞同：1
> 
> 时间：2013-01-14T15:40:11.357
> 
> 标签：cakephp, routing, amazon-web-services, amazon-ec2, subdomain

Alright I am having a hard time figuring out how to set up a production and development environment on my EC2 instance. I am trying to keep this on one server for cost saving.

I really know very little about .htaccess rules and even less about modifying Apache configuration and creating a custom AMI which I am thinking I might have to do.

If someone could point me in the right direction that would be great.

Folder structure

I want subdomain1.website.com/ to route to

/var/www/html/production

*   app/
*   lib/
*   plugins/
*   vendors/
*   .htaccess
*   .travis.yml
*   build.properties
*   build.xml
*   index.php

I want subdomain2.website.com/ to route to

/var/www/html/development

*   app/
*   lib/
*   plugins/
*   vendors/
*   .htaccess
*   .travis.yml
*   build.properties
*   build.xml
*   index.php

What is the correct way to go about setting this up?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:51:44.213

如果您在 Apache（或任何您的 Web 服务器）中正确设置了虚拟主机，则不必对标准安装进行任何 .htaccess 更改。您只需将每个虚拟主机设置为指向适用的文档根目录。

这是 Apache 的虚拟主机配置文档的链接： [http ://httpd.apache.org/docs/2.2/vhosts/](http://httpd.apache.org/docs/2.2/vhosts/)

# php - Login programmatically and stay logged in

> ID：14321601
> 
> 赞同：7
> 
> 时间：2013-01-14T15:40:30.750
> 
> 标签：php, symfony, login, symfony-2.1, fosuserbundle

I'm trying to implement single sign on access to a website using Symfony2.

The authentication itself seems to work fine, but only for the initial page. On the next page that is loaded the user is not logged in anymore.

**Relevant code:**

```
$token = new UsernamePasswordToken($user, null, 'main', $user->getRoles());
$event = new InteractiveLoginEvent($request, $token);

$this->get("event_dispatcher")->dispatch(SecurityEvents::INTERACTIVE_LOGIN, $event);
$this->get("security.context")->setToken($token);

return $this->redirect($this->generateUrl('sonata_user_profile_show')); 
```

**First page (without the redirect):**

![Initial page - logged in](../Images/368891385a544632255ca77b5581fc82.png)

**Second page:**

![Second page - Not logged in anymore](../Images/fe1296b2c3f89879f2451e7c1ecc7cf6.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T14:26:31.210

自定义登录只需要以下代码。

```
$token = new UsernamePasswordToken($user, null, 'main', $user->getRoles());
$this->get("security.context")->setToken($token);

return $this->redirect($this->generateUrl('sonata_user_profile_show')); 
```

这样做是在安全上下文中设置 UsernamePasswordToken。该令牌（以及用户）将被序列化并放入会话中。在下一页上，令牌将从会话中反序列化，并且同样反序列化的用户将被刷新。

FOSUserBundle 中的用户提供者使用未序列化用户的 id 执行此刷新。

此外，Doctrine2 在某些情况下使用代理类作为实体类而不是原始实体类。该代理类通过复杂的延迟加载复杂实现覆盖实体的“getId()”函数。

这一起可能导致这样一个事实，当您将 Doctrine2 代理对象放入 UserPasswordToken 时，序列化和非序列化代理对象的“getId()”将不会返回原始 ID。发生这种情况时，用户提供者无法刷新用户，并且令牌将变为无效。

解决此问题的方法是创建一个自定义用户提供程序，该用户提供程序通过使用用户名（或其他唯一属性）刷新来覆盖“refreshUser()”。

```
//...
class UserProvider extends FOSUserProvider
{
    /**
     * {@inheritDoc}
     */
    public function refreshUser(SecurityUserInterface $user)
    {
        if (!$user instanceof User) {
            throw new UnsupportedUserException(sprintf('Expected an instance of User, but got "%s".', get_class($user)));
        }

        if (null === $reloadedUser = $this->userManager->findUserBy(array('username' => $user->getUsername()))) {
            throw new UsernameNotFoundException(sprintf('User with username "%s" could not be reloaded.', $user->getUsername()));
        }

        return $reloadedUser;
    }
} 
```

# haskell - 函数中的初学者类型错误

> ID：14321609
> 
> 赞同：1
> 
> 时间：2013-01-14T15:40:46.053
> 
> 标签：haskell, types

在这个函数中：

```
play :: [Bool] -> ([Bool] -> Bool) -> ([Bool] -> Bool) -> [Bool]
play history agent1 agent2  = history ++ (agent1 history) ++ (agent2 history) 
```

其中一名代理人可能是：

```
titForTat :: [Bool] -> Bool
titForTat history
    | last history = True
    | otherwise    = False 
```

我得到错误：

```
 Couldn't match expected type `[Bool]' with actual type `Bool'
    In the return type of a call of `agent1'
    In the first argument of `(++)', namely `(agent1 history)'
    In the second argument of `(++)', namely
      `(agent1 history) ++ (agent2 history)' 
```

在我看来，agent1 的返回类型应该是布尔值列表，但似乎有错误。如果这是一个非常初学者的问题，我很抱歉。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:45:27.277

(++) 需要两个列表，但您的`agent`函数只返回一个布尔值。尝试

```
play history agent1 agent2  = history ++ [agent1 history] ++ [agent2 history] 
```

如果您在历史记录中存储项目的顺序无关紧要，使用 (:) 会更有效，即

```
play history agent1 agent2  = agent1 history : agent2 history : history 
```

# python - 使用 Python-Docx 设置字体属性

> ID：14321612
> 
> 赞同：5
> 
> 时间：2013-01-14T15:41:00.930
> 
> 标签：python, xml, ms-word, lxml, python-docx

我正在使用[Python-docx](https://github.com/mikemaccana/python-docx)模块以编程方式创建一个 word 文档。

我希望能够使**我的标题居中**，在我创建的表格中将某些**单词变为粗体，并进行****其他基本标记**。

不幸的是，阅读模块中的源代码并没有给我太多的指导。

我猜它与 docx 代码所基于的 lxml/etree 模块有关，但我对该库不太熟悉。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-05T05:31:46.663

上面的链接指向 python-docx 的旧存储库。新版本（v0.3.0 及更高版本）完全重写，位于此处：[https ://github.com/python-openxml/python-docx](https://github.com/python-openxml/python-docx)

上面列出的所有功能都在当前版本中可用。

文档在这里：[https ://python-docx.readthedocs.org/en/latest/](https://python-docx.readthedocs.org/en/latest/)

仅对旧版本进行了错误修复，以支持仍在使用它的项目。

`python-docx`SO标签受到监控，并且通常在同一天得到回答的问题。

# algorithm - 如果序列是随机的，是否有可能证明？

> ID：14321616
> 
> 赞同：3
> 
> 时间：2013-01-14T15:41:13.117
> 
> 标签：algorithm, language-agnostic, random, heuristics

考虑以下输入：

`1,1,2,3,5,8`- 这不是随机的

`2,4,8,16,32`- 这既不是

`4,1,2,11,5,9`- 这个看起来像随机序列

我想问一下是否有这样的算法来证明输入是随机的还是不是？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T15:45:05.263

不，没有这样的证明——如果你有完全随机数，每个长度为 n 的序列的概率是相等的。但是，有一些统计测试可以评估随机数生成器的质量，这可能是您正在寻找的。请参阅[顽固测试](http://en.wikipedia.org/wiki/Diehard_tests)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T16:44:39.757

正如其他人所提到的，您无法*证明*序列是否是随机生成的。除了@timos[建议](https://stackoverflow.com/a/14321689/387852)的内容之外，您似乎还有一些额外的要求。似乎您希望确保该序列不是来自一些众所周知的“非随机”序列的假设列表。如果是这种情况，您可能有兴趣学习[在线整数序列百科全书](http://oeisf.org/)。

如果您有特定的顺序，您可以对照他们的数据库进行检查。例如，`1,1,2,3,5,8`出现在许多序列中，但最突出的是[A000045](http://oeis.org/A000045)（斐波那契数）。类似的序列`4,1,2,11,5,9`不会出现在那里的搜索中。

这些都不能证明任何事情，但也许这更符合您在这种情况下的目标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-07T12:13:58.977

我想在这里强调一下，“随机”这个词不仅意味着同分布，而且*独立于其他一切*（包括独立于任何其他选择）。

有许多可用的“随机性测试”，包括通过运行各种统计探针估计*p 值*的测试，以及估计*min-entropy*的测试，这大致是位序列的最小“可压缩性”水平和最相关的熵衡量“安全随机数生成器”。还有各种“[随机性提取器](https://peteroupc.github.io/randextract.html)”，例如冯诺依曼和佩雷斯提取器，它们可以让您了解可以从位序列中提取多少“随机性”。然而，所有这些测试和方法只能在随机性定义的第一部分（“均匀分布”）上比在第二部分（“独立”）上更可靠。

通常，没有算法可以*仅从数字序列中*判断该过程是否以独立且同分布的方式生成它们，而不知道该过程是什么。因此，例如，尽管您可以判断给定的位序列中的零多于一，或者其中没有明显的模式，但您无法判断这些位是否——</p>

*   真正独立于任何其他选择而生成，或
*   构成仅“局部随机”的极长周期序列的一部分，或
*   只是从另一个进程中重用，或者
*   以其他方式产生的，

...没有有关该过程的更多信息。作为一个重要的例子，一个人选择密码的过程在这个意义上很少是“随机的”，因为密码往往包含熟悉的单词或名称，以及其他原因。

另请参阅此问题：[A Good and SIMPLE Measure of Randomness](https://stackoverflow.com/questions/1474382/a-good-and-simple-measure-of-randomness)

# php - 欧拉计划 #23：非充足的金额

> ID：14321619
> 
> 赞同：2
> 
> 时间：2013-01-14T15:41:18.267
> 
> 标签：php, algorithm

我正在努力解决 Project Euler[问题 23: Non-abundant sums](http://projecteuler.net/problem=23)。

![在此处输入图像描述](../Images/d7e6014463f526ccac78a27854973721.png)

我有一个脚本，可以计算丰富的数字：

```
function getSummOfDivisors( $number )
{
    $divisors = array ();
    for( $i = 1; $i < $number; $i ++ ) {
        if ( $number % $i == 0 ) {
            $divisors[] = $i;
        }
    }
    return array_sum( $divisors );
}

$limit = 28123;
//$limit  = 1000;
$matches = array();
$k = 0;

while( $k <= ( $limit/2 ) ) {
    if ( $k < getSummOfDivisors( $k ) ) {
        $matches[] = $k;
    }
    $k++;
}

echo '<pre>'; print_r( $matches ); 
```

我已经用互联网上的可用数字检查了这些数字，它们是正确的。我可以将它们乘以 2 并得到两个丰富数字之和的数字。

但是因为我需要找到所有不能这样写的数字，所以我只是`if`像这样反转语句：

```
if ( $k >= getSummOfDivisors( $k ) ) 
```

这现在应该存储所有，不能创建为大量数字的总和，但这里没有退出。当我总结它们时，我得到一个甚至不接近正确答案的数字。

我不想看到答案，但我需要一些关于我做错了什么（或者我错过了什么或误解了什么）的指南/提示。

*编辑：*我也尝试了相反的顺序，意思是从顶部开始，除以 2 并检查这些是否丰富。结果还是错了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T16:01:48.033

您的逻辑中的错误在于以下行：

*“我可以将它们乘以 2 并得到两个丰富数字之和的数字”*

您首先确定低于分析证明的极限的所有丰富数 [n1, n2, n3....]。然后可以说所有整数 [2*n1, 2*n2,....] 是两个丰富数的和，*但*n1+n2 和 n2+n3 也是两个丰富数的和。这就是你的错误。您必须计算所有可能的整数，它们是 [n1, n2, n3....] 中任意两个数字的总和，然后求逆找到*不是*的整数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T16:04:06.837

> 我已经用互联网上的可用数字检查了这些数字，它们是正确的。我可以将它们乘以 2 并得到两个丰富数字之和的数字。

不，这是不对的。丰富数只有一个`<= 16`，但`<= 32`可以写成丰富数之和的数是24（= 12 + 12）、30（= 12 + 18）、32（= 12 + 20）。

如果你有`k`数字，有`k*(k+1)/2`办法选择其中两个（不一定不同）。`k*(k+1)/2`通常，这些对中的许多将具有相同的和，因此通常可以写成两个给定数字之和的数字要少得多`k`，但通常多于`2*k`.

此外，有许多数`<= 28123`可以写为丰富数之和，只有两个丰富数之一大于`28123/2`。

> 这现在应该存储所有无法创建为大量数字的总和的内容，

不，这将存储非丰富数字，那些可能是也可能不是丰富数字的总和，例如 32 是一个不足的数字（除 32 之外的所有除数的总和是 31），但可以写成两个丰富数字的总和数字（见上文）。

您需要找到丰富的数字，但不仅要找到给定限制的一半，而且您需要检查哪些数字可以写为两个丰富的数字之和。您可以通过取所有两个丰富数对 ( `<= $limit`) 并标记总和来做到这一点，或者通过检查`$number - $abundant`直到找到一对丰富数或确定没有一个总和为`$number`。

有一些数论性质可以大大加快速度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-08T12:15:16.553

下面是 php 代码需要 320 秒

```
 <?php

set_time_limit(0);
ini_set('memory_limit', '2G');
$time_start = microtime(true);

$abundantNumbers = array();
$sumOfTwoAbundantNumbers = array();
$totalNumbers = array();
$limit = 28123;

for ($i = 12; $i <= $limit; $i++) {
    if ($i >= 24) {
        $totalNumbers[] = $i;
    }
    if (isAbundant($i)) {
        $abundantNumbers[] = $i;
    }
}

$countOfAbundantNumbers = count($abundantNumbers);
for ($j = 0; $j < $countOfAbundantNumbers; $j++) {
    if (($j * 2) > $limit)
        break;                    //if sum of two abundant exceeds limit ignore that
    for ($k = $j; $k < $countOfAbundantNumbers; $k++) {  //set $k = $j to avoid duble addtion like 1+2, 2+1
        $l = $abundantNumbers[$j] + $abundantNumbers[$k];
        $sumOfTwoAbundantNumbers[] = $l;
    }
}
$numbers = array_diff($totalNumbers, $sumOfTwoAbundantNumbers);

echo '<pre>';print_r(array_sum($numbers));

$time_end = microtime(true);
$execution_time = ($time_end - $time_start);

//execution time of the script
echo '<br /><b>Total Execution Time:</b> ' . $execution_time . 'seconds';
exit;

function isAbundant($n) {
    if ($n % 12 == 0 || $n % 945 == 0) { //first even and odd abundant number. a multiple of abundant number is also abundant
        return true;
    }
    $k = round(sqrt($n));
    $sum = 1;
    if ($n >= 1 && $n <= 28123) {
        for ($i = 2; $i <= $k; $i++) {
            if ($n % $i == 0)
                $sum+= $i + ( $n / $i);
            if ($n / $i == $i) {
                $sum = $sum - $i;
            }
        }
    }
    return $sum > $n;
} 
```

# video - 如何在 OpenCV 中保留 VideoCapture 提供的帧

> ID：14321620
> 
> 赞同：1
> 
> 时间：2013-01-14T15:41:25.393
> 
> 标签：video, opencv, load

我想使用opencv编写一个函数，它读取一个视频文件，抓取单帧并将它们存储在std::vector>中。问题在函数结束时出现，我有向量向量中的图像，但是当发布 VideoCapture 时，所有数据都消失了。

```
vector<Mat>load_single_video(string path)
{   
    vector<Mat> one_video_vector;
    Mat video_img;
    VideoCapture Temp_video_capture(path);
    Temp_video_capture.read(video_img);
    while (!video_img.empty())
    {           
        one_video_vector.push_back(video_img);      
        Temp_video_capture.read(video_img);
    }

    Temp_video_capture.release();

    return one_video_vector;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T16:05:42.153

从[OpenCV 文档](http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-read)：

> **注意：** OpenCV 1.x 函数`cvRetrieveFrame`和`cv.RetrieveFrame`返回存储在视频捕获结构中的图像。不允许修改或发布图像！您可以使用复制框架 `cvCloneImage()`，然后对副本执行任何您想要的操作。

虽然我们使用的是新的 OpenCV 2.x API，但`VideoCapture::read()`实际上是`cvRetrieveFrame()`. 正如注释所说，您必须复制框架。

```
one_video_vector.push_back(video_img.clone()); 
```

# atoi - atoi() 没有正确转换

> ID：14321624
> 
> 赞同：3
> 
> 时间：2013-01-14T15:41:40.603
> 
> 标签：atoi

我试图在琴弦上调用 atoi`509951644`和`4099516441`. 第一个转换没有任何问题。第二个是给我十进制值 2,147,483,647 (0x7FFFFFFF)。为什么会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:43:42.503

您的第二个整数正在创建溢出。最大 32 位有符号整数为 2147483647。

`atoi`反正一般不推荐使用；改为使用`strtol`，它实际上会告诉您您的值是否超出范围。（当输入超出范围时，行为`atoi`是*不确定*的。你的似乎只是吐出最大值`int`）

您还可以检查您的编译器是否有类似函数的`atoi64`功能，它可以让您使用 64 位值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:44:41.167

2147483647 是 C（有符号）中的最大整数值。它给出了它可以的最大值......原件太大而无法转换为带符号的int。我建议查找如何转换为无符号整数。

# oop - 如何在 SQL 查询和应用程序逻辑之间集中业务规则 (ColdFusion 8)？

> ID：14321626
> 
> 赞同：3
> 
> 时间：2013-01-14T15:41:51.460
> 
> 标签：oop, coldfusion, coldfusion-8, business-rules

我一直在缓慢但肯定地重构我客户的一个网站，以改进整体业务逻辑并避免重复代码。我一直从事的主要领域之一是基本购物车应用程序中的产品：

1.  项目搜索，对数据库使用 SQL 查询
2.  产品详细信息模板
3.  查看购物车
4.  结帐（输入地址，确认订单，提交）

围绕产品有许多业务规则，例如：

*   哪些产品是可见的
*   某些用户可以查看哪些产品
*   哪些产品可以订购
*   可以订购每种产品的格式
*   等等

多年来，所有这些规则都在整个网站中重复出现——一些在 SQL 查询中，一些在应用程序逻辑中，一些在两者中——并且它们在某些页面上的实现方式是不同的。事实上，一些规则并没有在某些页面上实施（不是设计使然）。

还创建了新的子应用程序，它们具有不同的规则。

因此，无论在何处显示产品，我都实现了“产品”类的使用，该类包含应用程序逻辑中的所有业务规则（即 Product.isViewable()、Product.isOrderable() 等）。

这允许通过扩展 Product 类在每个具有该应用程序特定规则的子应用程序中使用产品数据。

我目前唯一的问题是项目搜索页面，它查询数据库并包含许多“旧”业务规则，使用 ColdFusion 应用程序逻辑（if/else 等）和 SQL 条件的组合。这是 SQL 查询的片段：

```
 WHERE   (
                    LTRIM(RTRIM(UCASE(STATUS))) = 'ACTIVE'
                    OR UCASE(VIEWABLE_IF_RETIRED_FLAG) = 'Y'
                    )
            <cfif SESSION.User.getSecurityLevel() LT 5>
                AND (
                    UCASE(ORDERABLE_FLAG) = 'Y'
                    OR UCASE(ELECTRONIC_ORDERABLE_FLAG) = 'O'
                    OR UCASE(ELECTRONIC_ORDERABLE_FLAG) = 'V'
                    )
            </cfif> 
```

这些相同的规则在 Product 类中实现：

```
 function isVisibleIfRetired() {
        return getVisibleIfRetiredFlag() == "Y";
    }

    function isActive() {
        return getStatus() == "ACTIVE";
    }

    function isDigitalViewable() {
        return  UCase(getIsProductOrderableFlag()) == "Y"
            &&  (
                    UCase(getElectronicOrderableStatus()) == "V"
                ||  UCase(getElectronicOrderableStatus()) == "O"
                );
    } 
```

这让我发疯，因为它本质上仍然是重复的代码，如果业务规则发生变化，这两个部分都需要管理。

在某些地方我只显示几个项目（例如“类似项目”小部件以及“查看购物车”），我可以简单地从数据库中选择产品密钥，然后遍历这些值以创建产品实例并使用类中的业务规则来确定是否/如何显示产品。

但是，项目搜索查询最多可以返回 2000 条记录，并且我不能 [实际上] 循环超过 2000 条记录，创建 2000 个实例来根据业务规则确定显示。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T17:46:06.727

想一想：如果您要创建一个规则界面会怎样。即一组描述规则的 CFC。如果它们都实现了相同的接口（显式地或通过鸭子类型），那么您可以装饰您的数据访问对象和其他类，例如您的 Product 类。

这些规则的 API 可能类似于（在伪代码中）：

```
component name="product is visible"{

    function ruleAsSqlFragment(){
        // return a chunk of SQL here that you can drop right into your query and would cause the query to be filtered as you wish.
        return "LTRIM(RTRIM(UCASE(STATUS))) = 'ACTIVE'
                OR UCASE(VIEWABLE_IF_RETIRED_FLAG) = 'Y'";
    }

    function validateRule(object){
        // this function might accept an object, validate it according to its rules and return true or false
        return object.isActive() or object.getViewableIfRetired()
    }

} 
```

然后，您可以制作一组这些规则来装饰您的对象：

```
rules = [isVisibleRule,isSomethingElseRule,etc]; 
```

在您的对象中，您可以简单地遍历数组并调用适当的函数来评估规则或生成正确的 SQL 片段。仅当函数或 SQL 语法评估为 true 时，才满足规则。

总的来说，我不确定使用传统的 SQL 方法可以完全避免重复的业务逻辑。毕竟它们都是（SQL 和 CF）不同的语言。

我想另一种选择是定义领域特定语言 (DSL) 并使用它来定义您的规则。然后编写一个组件，可以将这些规则转换为 SQL 或针对对象评估它们。然后找到一种方法，以正确的方式将 DSL 中定义的特定规则关联到组件中，并根据需要对其进行评估。

另一个挑战是您的数据库看起来并没有完全反映您的对象模型，这是非常典型的。如果是这种情况，我很确定你只需要尽可能地隔离这个逻辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T14:59:46.213

从这些业务规则的自动化测试（例如单元测试）开始。如果您听取测试，测试将建议一个对象模型（例如，通过在编写测试时忽略您当前的实现）。

您可能会发现一些（可能是几个）您希望存在的 CFC 来实施这些业务规则。编写您的测试，就好像它们存在一样。

每个规则都应该有一个规范的实现。也就是说，如果您的规则确定哪些产品是可查看的，那么应该使用一种 CFC 方法来确定。该方法可能在内部使用 CFML、SQL、对其他 CFC 方法的调用，等等。关键是需要使用该规则的所有内容都将调用该方法来执行此操作。您的测试会测试该方法以查看是否正确遵循了规则。

如果您还没有开始编写自动化测试，请查看 MXUnit 并阅读一下 TDD 或 BDD。 [http://en.wikipedia.org/wiki/Behavior-driven_development](http://en.wikipedia.org/wiki/Behavior-driven_development)

# python - scipy.io.wavfile 给出“WavFileWarning：块不理解”错误

> ID：14321627
> 
> 赞同：14
> 
> 时间：2013-01-14T15:41:52.003
> 
> 标签：python, macos, numpy, audio, scipy

我正在尝试使用 scipy 读取 .wav 文件。我这样做：

```
from scipy.io import wavfile

filename = "myWavFile.wav"
print "Processing " + filename

samples = wavfile.read(filename) 
```

我得到了这个丑陋的错误：

```
/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/scipy/io/wavfile.py:121: WavFileWarning: chunk not understood
  warnings.warn("chunk not understood", WavFileWarning)
Traceback (most recent call last):
  File "fingerFooler.py", line 15, in <module>
    samples = wavfile.read(filename)
  File "/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/scipy/io/wavfile.py", line 127, in read
    size = struct.unpack(fmt, data)[0]
struct.error: unpack requires a string argument of length 4 
```

我正在使用 Python 2.6.6、numpy 1.6.2 和 scipy 0.11.0

[这](https://dl.dropbox.com/u/34317751/Shakers.wav)是导致问题的wav文件。

有什么想法吗？这里有什么问题？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-09-23T11:57:46.320

这些文件不再可用（9 个月后并不奇怪！），但为了将来参考，最可能的原因是它有 scipy 无法解析的额外元数据。

在我的例子中，它是由 Audacity 添加的默认元数据（版权、曲目名称等）——您可以在 Audacity 中打开文件并使用 File ... Open Metadata Editor 来查看它。然后使用“清除”按钮将其剥离，然后重试。

当前[版本的 scipy](https://github.com/scipy/scipy/blob/master/scipy/io/wavfile.py)支持以下 RIFF 块 - 'fmt'、'fact'、'data' 和 'LIST'。 [RIFF 上的 Wikipedia 页面](http://en.wikipedia.org/wiki/Resource_Interchange_File_Format)有更多关于 WAV 文件结构的详细信息，例如，您的可能包含不受支持但流行的 INFO 块

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-15T23:37:37.693

我对 WAV 文件格式一无所知，但深入研究`scipy`它看起来`scipy`并不熟悉文件末尾出现的块（块 ID 为`bext`2753632 字节，如果有帮助的话）。该块被声明为 603 字节长，因此它读取过去并期待另一个块 ID 603 字节后 - 它没有找到它（文件用完）并跌倒。

您是否在其他 WAV 文件上成功尝试过？这个是怎么产生的？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-11-10T07:58:26.783

我遇到了同样的错误，并且可以成功转换为它可以读取的内容。

我的原始文件来自 Logic Pro。然后我[大胆](http://www.audacityteam.org/)地阅读了文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-30T02:47:03.010

由于 Audacity 引入了（大概）元数据，我也遇到了这个错误。我从另一个 DAW（Ableton Live）导出了我的 wav 文件，并且 scipy.io.wavfile 加载它没有错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-23T14:57:16.003

解决这个问题最简单的方法是使用 SoX 将 wav 文件转换为其他 wav 文件。

```
$ sox wavfile.wav wavfile2.wav 
```

为我工作！

# c# - 数组和字符串编码

> ID：14321634
> 
> 赞同：2
> 
> 时间：2013-01-14T15:41:55.610
> 
> 标签：c#, encoding

当我做

```
string s = Encoding.Unicode.GetString(a);
byte[] aa = Encoding.Unicode.GetBytes(s); 
```

我有不同的数组 (a != aa) 。**为什么**？

但是当我这样做的时候？没关系

```
string s = Encoding.Default.GetString(a);
byte[] aa = Encoding.Default.GetBytes(s); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-14T15:45:05.777

那是因为您正在向后使用编码。编码用于将字符串编码为字节，然后再次编码回字符串。

在编码中，每个字符都有相应的字节集，但并非每个字节集都必须有相应的字符。这就是为什么您不能获取任意字节并解码为字符串的原因。

使用编码`Default`会以这种方式误用它，因为它只为每个字符使用一个字节，而且每个字节码恰好都有一个字符。但是，以这种方式使用它仍然没有意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T16:48:34.607

要添加到 Guffa 的答案，这里有一个详细的示例，说明您的代码如何针对某些字节序列失败，例如`0, 216`：

```
// Let's start with some character from the ancient Aegean numbers:
// The code point of Aegean One is U+10107\. Code points > U+FFFF need two
// code units with two bytes each if you encode them in UTF-16 (Encoding.Unicode)
string aegeanOne = char.ConvertFromUtf32(0x10107);
byte[] aegeanOneBytes = Encoding.Unicode.GetBytes(aegeanOne);
// Length == 4 (2 bytes each for high and low surrogate)
// == 0, 216, 7, 221

// Let's just take the first two bytes.
// This creates a malformed byte sequence,
// because the corresponding low surrogate is missing.
byte[] a = new byte[2];
a[0] = aegeanOneBytes[0]; // == 0
a[1] = aegeanOneBytes[1]; // == 216

string s = Encoding.Unicode.GetString(a);
// == replacement character � (U+FFFD),
// because the bytes could not be decoded properly (missing low surrogate)

byte[] aa = Encoding.Unicode.GetBytes(s);
// == 253, 255 == 0xFFFD != 0, 216

string s2 = Encoding.Default.GetString(a);
// == "\0Ø" (NUL + LATIN CAPITAL LETTER O WITH STROKE)
// Results may differ, depending on the default encoding of the operating system

byte[] aa2 = Encoding.Default.GetBytes(s2);
// == 0, 216 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T15:47:54.850

这意味着您`byte[] a`的字节顺序不符合 Unicode 规则。

# android - BroadcastReceiver 收到的 Intent 比发送的多

> ID：14321635
> 
> 赞同：0
> 
> 时间：2013-01-14T15:41:59.990
> 
> 标签：android, android-intent, broadcastreceiver, android-activity, android-service

我有下一个问题：

我创建了一个自定义 BroadcastReceiver 并将其注册到主要活动 onCreate 处理程序中：

```
public class MainActivity extends ListActivity {
  private static final LogReceiver logReceiver = new LogReceiver();

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    LocalBroadcastManager.getInstance(this).registerReceiver(logReceiver, new IntentFilter(LogReceiver.ACTION_LOG));
  }
...
} 
```

广播接收器类：

```
public class LogReceiver extends BroadcastReceiver {
  @Override
  public void onReceive(Context context, Intent intent) {
     Log.i("intent", "intent <-");
  }
} 
```

然后我使用下一个代码从本地服务发送多个意图：

```
Intent intent = new Intent(LogReceiver.ACTION_LOG).putExtra("log", logString);
localBroadcastManager.sendBroadcast(intent);
Log.i("intent", "intent ->"); 
```

日志对我来说看起来很奇怪：

*   意图->
*   意图<-
*   意图->
*   意图<-
*   意图<-
*   意图->
*   意图<-
*   意图<-
*   意图<-
*   ...

第一次 LogReceiver 只收到一个 Intent，这是正确的，但每次它收到的 Intent 比发送的多。

我可以在我的项目中从 Intent 方法切换，但有趣的是为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:57:40.400

您应该在 Activity 的 onDestroy 中取消注册接收器。此外，您应该检查此接收器是否真的必须是静态的。

如果您在整个应用程序中都需要接收器，则应将其保存在单独的单例类或自定义应用程序类中，而不是一个 Activity 中。

然后，您可以在第一个启动的 Activity 中注册接收器。但是您应该确保它只注册一次，例如通过将 a 存储`boolean registered`到在 LocalBroadcastManager 注册之前检查的接收器中。

# unit-testing - 用于测试的假 X 服务器？

> ID：14321636
> 
> 赞同：15
> 
> 时间：2013-01-14T15:42:02.820
> 
> 标签：unit-testing, testing, x11

在工作中，我们全面测试了 GUI 组件。问题出在这样一个事实，即在测试套件运行时，会弹出各种组件，从而窃取焦点或使其无法继续工作。我首先想到的是 Xnest，但我想知道是否有更优雅的解决方案来解决这个问题。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-14T16:17:58.493

我认为您需要在这里做的是让您的测试在与您正在处理的显示器不同的显示器上运行。

当我们将 TeamCity 代理迁移到 EC2 时，我们必须想办法在无头 Linux 服务器上运行我们的 UI 单元测试。我在这篇[博](http://blog.kagesenshi.org/2007/06/running-x-applications-headless-using.html)文中找到了一种方法，它概述了如何使用 Xvfb。

就我而言，我所要做的就是：

*   `yum install xorg-x11-server-Xvfb`
*   `Xvfb :100 -ac`运行服务器。我将此添加到我的 EC2 代理上的 rc.local 文件中，以便在机器启动时启动它。
*   然后我添加`env.DISPLAY :100`到我的 TeamCity 构建配置中

# c# - 当我不在 ASP 应用程序中使用该提供程序时，出现“对 OLE DB 提供程序的临时访问”的错误

> ID：14321638
> 
> 赞同：1
> 
> 时间：2013-01-14T15:42:06.477
> 
> 标签：c#, oledb, sqlconnection

我有一个 ASP.net 应用程序，并且正在使用以下连接字符串：

```
<configuration>
<connectionStrings>
    <add name="CAF" connectionString="Data Source=pxx-sql2;Initial Catalog=mydb;User ID=DBUser;Password=mypass;Persist Security Info=False;Trusted_Connection=False;"  providerName="System.Data.SqlClient"/>
</connectionStrings>
</configuration> 
```

当我在应用程序中阅读时，一切正常。但是当我写的时候，我收到了这个错误：“对 OLE DB 提供程序 'ADSDSOObject' 的临时访问已被拒绝。您必须通过链接服务器访问此提供程序。”

堆栈跟踪提供：

```
[SqlException (0x80131904): Ad hoc access to OLE DB provider 'ADSDSOObject' has been denied. You must access this provider through a linked server.]
   System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection) +404
   System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() +412
   System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) +1363
   System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) +6387805
   System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async) +6389506
   System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result) +538
   System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe) +689
   System.Data.SqlClient.SqlCommand.ExecuteNonQuery() +327
   MyDBData.Reconcile(HttpRequest req, User u, String assignee) in c:\websites\MyDB\App_Code\MyDBDataReconciler.cs:99

[Exception: Ad hoc access to OLE DB provider 'ADSDSOObject' has been denied. You must access this provider through a linked server.]
   MyDBData.Reconcile(HttpRequest req, User u, String assignee) in c:\websites\MyDB\App_Code\MyDBDataReconciler.cs:112
   EntryEditView.Page_Load(Object sender, EventArgs e) in c:\websites\MyDB\EntryEditView.aspx.cs:50
   System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) +25
   BasePage.OnLoad(EventArgs e) in c:\websites\MyDB\App_Code\BasePage.cs:19
   System.Web.UI.Control.LoadRecursive() +71
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +3064 
```

除了我不认为我在这个项目的任何地方都使用了“ADSDSOObject”。我正在打开与标准 SqlData 句柄的连接。

真正奇怪的是，这是四次中的第四次插入，并且是`ExecuteNonQuery`我提交事务之前的最后一次（插入时）。

这是完整的功能。

```
public void Reconcile(HttpRequest req, User u, string assignee)
{
    SqlConnection conn = new SqlConnection(Config.ConnString);
    conn.Open();
    SqlTransaction transaction = conn.BeginTransaction("UpdateMyDB");

    this.master.MyDBMasterID = int.Parse(req.Params["MyDB"]);
    MyDBLayout MyDBL = new MyDBLayout(this.master.MyDBMasterID);
    this.master.bexMasterID = int.Parse(req.Params["bex"]);
    MyDBLayout bexL = null;
    if (this.master.bexMasterID > 0)
        bexL = new MyDBLayout(this.master.bexMasterID);
    SqlCommand cmd = new SqlCommand();
    cmd.Transaction = transaction;
    cmd.Connection = conn;

    try
    {
        int bexForm;
        if (this.MyDBID == -1)
        {
            // Create the blank MyDB
            cmd.CommandText = @"
                insert into MyDB_Master(created, branch, client, clientName, submitter, specialist, MyDBDate, MyDBMasterID, bexMasterID)
                    values (getdate(), '', '', '', @submitter, '', getdate(), @MyDBMasterID, @bexMasterID); select @@IDENTITY";
            cmd.Parameters.AddWithValue("@MyDBMasterID", req.Params["MyDB"].Trim());
            cmd.Parameters.AddWithValue("@submitter", u.LoginName);
            bexForm = int.Parse(req.Params["bex"].Trim());
            if (bexForm != -1)
                cmd.Parameters.AddWithValue("@bexMasterID", bexForm);
            else
                cmd.Parameters.AddWithValue("@bexMasterID", DBNull.Value);
            MyDBID = (int)((decimal)cmd.ExecuteScalar());
        }
        // Populate the master
        cmd.CommandText = @"
                update MyDB_MASTER set branch = @branch, client = @client, clientName = @clientName,
                    specialist = @specialist, MyDBDate = @MyDBDate,
                    MyDBMasterID = @MyDBMasterID, bexMasterID = @bexMasterID, payDate = @MyDBPayDate, method = @method
                where MyDBID = @MyDBID;";
        cmd.Parameters.Clear();
        cmd.Parameters.AddWithValue("@MyDBID", MyDBID);
        cmd.Parameters.AddWithValue("@branch", req.Params["MyDBBranch"].Trim());
        cmd.Parameters.AddWithValue("@client", req.Params["MyDBClient"].Trim());
        cmd.Parameters.AddWithValue("@clientName", req.Params["MyDBName"].Trim());
        cmd.Parameters.AddWithValue("@specialist", req.Params["MyDBSpecialist"].Trim());
        cmd.Parameters.AddWithValue("@method", req.Params["MyDBMethod"].Trim());

        DateTime MyDBDate = DateTime.MinValue;
        if (DateTime.TryParseExact(req.Params["MyDBDate"], "MM/dd/yyyy", enUS, DateTimeStyles.AllowWhiteSpaces, out MyDBDate))
            cmd.Parameters.AddWithValue("@MyDBDate", MyDBDate);
        else
            cmd.Parameters.AddWithValue("@MyDBDate", DateTime.Now);

        DateTime MyDBPayDate = DateTime.MinValue;
        if (DateTime.TryParseExact(req.Params["MyDBPayDate"], "MM/dd/yyyy", enUS, DateTimeStyles.AllowWhiteSpaces, out MyDBPayDate))
            cmd.Parameters.AddWithValue("@MyDBPayDate", MyDBPayDate);
        else
            cmd.Parameters.AddWithValue("@MyDBPayDate", DBNull.Value);

        cmd.Parameters.AddWithValue("@MyDBMasterID", req.Params["MyDB"].Trim());
        bexForm = int.Parse(req.Params["bex"].Trim());
        if (bexForm != -1)
            cmd.Parameters.AddWithValue("@bexMasterID", bexForm);
        else
            cmd.Parameters.AddWithValue("@bexMasterID", DBNull.Value);
        cmd.ExecuteNonQuery();

        // Remove old detail
        cmd.Parameters.Clear();
        cmd.CommandText = @"delete from MyDB_detail where MyDBID = @MyDBID";
        cmd.Parameters.AddWithValue("@MyDBID", MyDBID);
        cmd.ExecuteNonQuery();

        FixNotes(MyDBID, req, cmd);

        AddDetail(MyDBID, MyDBL, req, cmd);
        if ( bexL != null )
            AddDetail(MyDBID, bexL, req, cmd);

        cmd.Parameters.Clear(); 
        cmd.CommandText = @"insert into MyDB_history (MyDBID, alteredBy, assignedTo, status) values (@MyDBID, @alteredBy, @assignedTo, @status)";
        cmd.Parameters.AddWithValue("@MyDBID", MyDBID);
        cmd.Parameters.AddWithValue("@alteredBy", u.LoginName);
        cmd.Parameters.AddWithValue("@assignedTo", assignee);
        cmd.Parameters.AddWithValue("@status", req.Params["MyDBStatus"]);
        this.master.assignedTo = assignee;
        cmd.ExecuteNonQuery();     // <--- Fails here.

        transaction.Commit();
    }
    catch (System.Exception e)
    {
        try
        {
            transaction.Rollback();
        }
        catch { }
        throw new Exception(e.Message, e);
    }
} 
```

什么可能导致此特定错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:59:49.063

ADSDSOObject 用于查询 Active Directory。

该错误似乎是在 SQL 服务器中生成的，而不是在您的应用程序中。我怀疑可能存在使用 ADSDSOObject 针对 Active Directory 验证传递的 LoginName (@alteredBy) 或受让人 (@assignedTo) 的约束或触发器。

# java - 当 TCPPING.initialHost 包含多个主机时，Infinispan/JGroups 集群连接失败

> ID：14321639
> 
> 赞同：1
> 
> 时间：2013-01-14T15:42:12.480
> 
> 标签：java, infinispan, jgroups

我正在尝试使用 TCP 传输配置 Infinispan。

如果`TCPPING.initialHosts`我将所有潜在集群节点的列表放入其中，则集群根本没有连接 - 大约有 15 个潜在节点，其中大多数是死的，通常只有 2 或 3 个还活着。

但是，如果在`TCPPING.initialHosts`我只列出 2-3 个主机的列表中，则集群创建成功。

我做错了什么？

**更新：**据我在日志和堆栈跟踪中看到，活动节点之间的连接已创建并且节点交换一些消息。然而，集群仍未形成。

**更新：**这是创建的代码`JChannel`：

```
 JChannel ch = new JChannel(false);
    ProtocolStack stack = new ProtocolStack();
    ch.setProtocolStack(stack);

    // TCPPING is responsible for discovery
    TCPPING tcpping = new TCPPING();
    List<IpAddress> initial_hosts = ... // get lists of hosts, list can be quite big
    tcpping.setInitialHosts(initial_hosts);
    tcpping.setErgonomics(false);
    tcpping.setPortRange(0);
    tcpping.setNumInitialMembers(3);

    TCP tcp = new TCP();
    tcp.setBindAddress(InetAddress.getByName(server.getHostName()));
    tcp.setBindPort(server.getPort());
    tcp.setThreadPoolMaxThreads(30);
    tcp.setOOBThreadPoolMaxThreads(30);

    NAKACK nakack = new NAKACK();
    nakack.setUseMcastXmit(false);
    nakack.setDiscardDeliveredMsgs(false);

    MERGE2 merge = new MERGE2();

    RSVP rsvp = new RSVP();
    rsvp.setValue("timeout", 60 * 1000);
    rsvp.setValue("resend_interval", 500);
    rsvp.setValue("ack_on_delivery", false);

    stack
        .addProtocol(tcp)
        .addProtocol(tcpping)
        .addProtocol(merge)
        .addProtocol(new FD_SOCK())
        .addProtocol(new FD())
        .addProtocol(new VERIFY_SUSPECT())
        .addProtocol(nakack)
        .addProtocol(new UNICAST2())
        .addProtocol(new STABLE())
        .addProtocol(new GMS())
        .addProtocol(new UFC())
        .addProtocol(new MFC())
        .addProtocol(new FRAG2())
        .addProtocol(rsvp);
    stack.init();

    return ch; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T08:23:18.023

可能发现阶段花费的时间太长，因为 JGroups 尝试与 15 台主机建立连接，但其中只有 2-3 台还活着。我建议将 TCP.scok_conn_timeout 设置为较低的值（200？），以便我们从连接返回到最多 200 毫秒后关闭的主机。也许 GMS.join_timeout 需要增加，TCPPING.timeout 也是如此。它们应该*高于*最长的发现阶段。

# php - 如果不满足当前时间或日期，如何禁用选项

> ID：14321642
> 
> 赞同：3
> 
> 时间：2013-01-14T15:42:19.450
> 
> 标签：php, mysqli

`$dbSessionDate`我的问题是，如果开始日期和开始时间`$dbSessionTime`早于当前日期和时间，我如何禁用下面创建下拉菜单中的选项？

下面是使用 mysqli 从数据库中获取数据的下拉菜单：

```
while ( $sessionqrystmt->fetch() ) {

$time_string = $dbSessionDate." ".$dbSessionTime;
$time_from_string = strtotime($time_string);    
if($time_from_string > date("Y-m-d H:i:s"))
{
$sessionHTML .= sprintf("<option value='%s'>%s - %s - %s</option>", $dbSessionId, $dbSessionName, date("d-m-Y",strtotime($dbSessionDate)), date("H:i",strtotime($dbSessionTime))) . PHP_EOL;    
}else{
$sessionHTML .= sprintf("<option value='%s' disabled>%s - %s - %s</option>", $dbSessionId, $dbSessionName, date("d-m-Y",strtotime($dbSessionDate)), date("H:i",strtotime($dbSessionTime))) . PHP_EOL;   

}
} 
```

更新：

来自视图源的 HTML：

```
<select name="session" id="sessionsDrop">
<option value="">Please Select</option>
<option value='28'>LDREW - 09-01-2013 - 09:00</option>
<option value='29'>BQNYF - 10-01-2013 - 10:00</option>
<option value='22'>WDFRK - 17-01-2013 - 09:00</option>
<option value='26'>POKUB1 - 25-01-2013 - 15:00</option>
</select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:50:05.027

使用`strtotime()`. `$dbSessionDate`将和组合`$dbSessionTime`在一起，将其传递给函数`strtotime`，然后将结果变量与 进行比较`date()`。

代码：

```
$time_string = $dbSessionDate." ".$dbSessionTime;
$time_from_string = strtotime($time_string);

if($time_from_string > strtotime(date("Y-m-d H:i:s")))
{
   //Do whatever you like to do.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T16:00:09.467

您需要比较日期和时间，以及在当前日期和时间之前的时间，您需要将“禁用”属性放入下拉列表。

像这样的东西：

```
while ( $sessionqrystmt->fetch() ) {
    $attribute = "";
    if (strtotime($dbSessionDate." ".$dbSessionTime) < date("Y-m-d H:i:s")){ $atribute = "disabled";}
    $sessionHTML .= sprintf("<option value='%s' %s>%s - %s - %s</option>", $dbSessionId, $attribute, $dbSessionName, date("d-m-Y",strtotime($dbSessionDate)), date("H:i",strtotime($dbSessionTime))) . PHP_EOL;
} 
```

在这里你可以看到禁用属性定义： [http ://www.w3schools.com/tags/att_option_disabled.asp](http://www.w3schools.com/tags/att_option_disabled.asp)

# wpf - WPF：如何为上下文菜单实现 Blend 的深色主题

> ID：14321643
> 
> 赞同：5
> 
> 时间：2013-01-14T15:42:19.877
> 
> 标签：wpf, contextmenu

我在我的 App.xaml 中添加了这个 xaml：

```
<Style TargetType="{x:Type ContextMenu}">
   <Setter Property="Background" Value="{StaticResource ShadeBrush}" />
   <Setter Property="BorderBrush" Value="{StaticResource ShadeBrush}" />
   <Setter Property="Foreground" Value="White" />
</Style> 
```

这让我大部分时间都朝着一个黑暗的主题前进......
如何解决菜单项的这个问题：
![在此处输入图像描述](../Images/bb657e2c83e3aa2f15a3d68630cd933d.png)

我怀疑我需要修改菜单项的样式或模板。
谢谢。

更新：使用 Snoop（由安迪提到，谢谢），我在选择白色矩形时发现了这一点：
![在此处输入图像描述](../Images/f04e9d5354305f57c79b19401fd5e5b0.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-12-23T09:53:43.253

对于接下来来到这里的人，我通过这样设置模板解决了这个问题：

```
<Style TargetType="{x:Type ContextMenu}">
    <Setter Property="Background" Value="{StaticResource ShadeBrush}" />
    <Setter Property="BorderBrush" Value="{StaticResource ShadeBrush}" />
    <Setter Property="Foreground" Value="White" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ContextMenu}">
                <Border Uid="Border_93">
                    <Border.Style>
                        <Style TargetType="{x:Type Border}">
                            <Setter Property="Tag" 
                    Value="{DynamicResource 
                        {x:Static SystemParameters.DropShadowKey}}"/>
                            <Style.Triggers>
                                <DataTrigger 
                            Binding="{Binding Tag, 
                                RelativeSource={RelativeSource Self}}" 
                            Value="True">
                                    <Setter Property="Background" 
                            Value="Transparent"/>
                                    <Setter Property="Padding" 
                            Value="0,0,5,5"/>
                                    <Setter Property="Effect">
                                        <Setter.Value>
                                            <DropShadowEffect 
                                    BlurRadius="4" 
                                    Opacity="0.8" 
                                    ShadowDepth="1"/>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <Border BorderBrush="{TemplateBinding BorderBrush}" 
                BorderThickness="{TemplateBinding BorderThickness}" 
                Background="{TemplateBinding Background}" 
                Uid="Border_50">
                        <ScrollViewer CanContentScroll="True" 
                Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, 
                        TypeInTargetAssembly={x:Type FrameworkElement}}}" 
                        Uid="ScrollViewer_9">
                            <ItemsPresenter 
                    KeyboardNavigation.DirectionalNavigation="Cycle" 
                    Margin="{TemplateBinding Padding}" 
                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
                    Uid="ItemsPresenter_5"/>
                        </ScrollViewer>
                    </Border>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

# php - 创建没有 WSDL 文件的 PHP SOAP 请求 (Flickr SOAP API)

> ID：14321644
> 
> 赞同：0
> 
> 时间：2013-01-14T15:42:20.403
> 
> 标签：php, xml, soap, soap-client, flickr

我正在尝试为 Flickr SOAP API 创建请求，但无法获得正确的格式。这是他们想要发送的 XML。：

```
 <s:Envelope
    xmlns:s="http://www.w3.org/2003/05/soap-envelope"
    xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance"
    xmlns:xsd="http://www.w3.org/1999/XMLSchema"
>
    <s:Body>
        <x:FlickrRequest xmlns:x="urn:flickr">
            <method>flickr.test.echo</method>
            <name>value</name>
        </x:FlickrRequest>
    </s:Body>
</s:Envelope> 
```

这是我的代码：

```
<?php
ini_set("soap.wsdl_cache_enabled", "0"); // disabling WSDL cache
$opts = array('location' => 'http://api.flickr.com/services/soap/',
              'uri'      => 'urn:flickr',
              'trace'    => 1
);
$client = new SOAPClient(null, $opts);
?>

    <?php
      try {

        $data = $client->__soapCall('flickr.test.echo', array('name'));
        print_r($data);

      } catch (SoapFault $exception) {

        echo 'Exception Thrown: '.$exception->faultstring.'<br><br>';  

      print "<pre>\n";
      print "Request :\n".htmlspecialchars($client->__getLastRequest()) ."\n";
      print "Response:\n".htmlspecialchars($client->__getLastResponse())."\n";
      print "</pre>";   

      }

    ?> 
```

这是回应：

```
Exception Thrown: 

Request :
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:ns1="urn:flickr" xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" 
SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
<SOAP-ENV:Body>
<ns1:flickr.test.echo>
<param0 xsi:type="xsd:string">name</param0>
</ns1:flickr.test.echo>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope>

Response:
<?xml version="1.0" encoding="utf-8" ?>
<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope">
    <s:Body>
        <s:Fault>
            <faultcode>flickr.error.0</faultcode>
            <faultstring>Invalid SOAP envelope.</faultstring>
            <faultactor>http://www.flickr.com/services/soap/</faultactor>
            <details>Please see http://www.flickr.com/services/api/ for more details</details>
        </s:Fault>
    </s:Body>
</s:Envelope> 
```

不幸的是，Flickr 不提供 WSDL 文件。

谢谢

<< **** 更新 **** >> 我越来越近了。我改变了我的代码，它几乎到了它应该在的地方：

```
<?php
ini_set("soap.wsdl_cache_enabled", "0"); // disabling WSDL cache

$opts = array('location' => 'http://api.flickr.com/services/soap/',
              'uri'      => 'http://api.flickr.com/services/soap/',
              'trace'    => 1
);
$client = new SOAPClient(null, $opts);
?>
<?php
  try {

    $data = $client->__soapCall("FlickrRequest",
       array(new SoapParam('flickr.test.echo', 'method'), new SoapParam('value', 'name')),
       array('soapaction' => 'http://api.flickr.com/services/soap/')
    );  
    print_r($data);

  } catch (SoapFault $exception) {

    echo 'Exception Thrown:  '.$exception->faultstring.'<br><br>';  

  print "<pre>\n";
  print "Request :\n".htmlspecialchars($client->__getLastRequest()) ."\n";
  print "Response:\n".htmlspecialchars($client->__getLastResponse())."\n";
  print "</pre>";   
  }

?> 
```

现在发送的是：

```
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://api.flickr.com/services/soap/" 
xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" 
SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
<SOAP-ENV:Body>
<ns1:FlickrRequest>
<method xsi:type="xsd:string">flickr.test.echo</method>
<name xsi:type="xsd:string">value</name>
</ns1:FlickrRequest>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-27T10:18:35.030

我设法使用以下代码使其工作：

```
<?php 
    $url = 'https://api.flickr.com/services/soap';

    $xml_post_string = '<s:Envelope
                            xmlns:s="http://www.w3.org/2003/05/soap-envelope"
                            xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance"
                            xmlns:xsd="http://www.w3.org/1999/XMLSchema"
                        >
                            <s:Body>
                                <x:FlickrRequest xmlns:x="urn:flickr">
                                    <method>flickr.photos.getRecent</method>
                                    <api_key>YOUR_API_KEY</api_key>
                                    <page>1</page>
                                    <per_page>10</per_page>
                                </x:FlickrRequest>
                            </s:Body>
                        </s:Envelope>';

       $headers = array(
                    "Content-type: text/xml;charset=\"utf-8\"",
                    "Accept: text/xml",
                    "Cache-Control: no-cache",
                    "Pragma: no-cache",
                    "Content-length: ".strlen($xml_post_string),
                );

        // PHP cURL
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_POST, true);
        curl_setopt($ch, CURLOPT_POSTFIELDS, $xml_post_string);
        curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

        $response = curl_exec($ch);
        curl_close($ch);
?> 
```

我调用的方法是**flickr.photos.getRecent**，传递的参数是：

*   **api_key** --> 游览 api 密钥
*   **page** --> 目标页面
*   **per_page** --> 每页的元素数量

这是回应：

```
 <s:envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope" xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance" xmlns:xsd="http://www.w3.org/1999/XMLSchema">
    <s:body>
    <x:flickrresponse xmlns:x="urn:flickr">
&lt;photos page="1" pages="100" perpage="10" total="1000"&gt;
    &lt;photo id="14569264388" owner="14957549@N05" secret="6edf4e63b7" server="2924" farm="3" title="Halona Blow Hole.  #hawaii #oahu #halonablowhole #honolulu #beautifulscenery #southshore" ispublic="1" isfriend="0" isfamily="0" /&gt;
    &lt;photo id="14569264418" owner="107442773@N05" secret="5260e4a304" server="3877" farm="4" title="Chic Plannerâ€™s selection of flowers is rich and varied. The arrangements, which were also personally selected by Mr.Suriya Krutthong Creative Director of Chic Planner's, are desinged of contemporary and exude a sense of timeless elegance.  #Floral #ChicPl" ispublic="1" isfriend="0" isfamily="0" /&gt;
    &lt;photo id="14569463647" owner="88628573@N00" secret="9499a95683" server="2897" farm="3" title="DSC01138.JPG" ispublic="1" isfriend="0" isfamily="0" /&gt;
    &lt;photo id="14569464207" owner="13792595@N04" secret="6a3ef91dc1" server="3902" farm="4" title="2014-07-25 16.59.40" ispublic="1" isfriend="0" isfamily="0" /&gt;
    &lt;photo id="14569464337" owner="84797770@N05" secret="5749d84b11" server="2930" farm="3" title="PICT0340.JPG" ispublic="1" isfriend="0" isfamily="0" /&gt;
    &lt;photo id="14732900256" owner="112321297@N06" secret="a42fc5a063" server="3904" farm="4" title="005" ispublic="1" isfriend="0" isfamily="0" /&gt;
    &lt;photo id="14753554624" owner="126377022@N07" secret="daf6c95548" server="3900" farm="4" title="Image from page 36 of &amp;quot;Illustrated catalogue and price list of bells, electric gas burners, batteries, push buttons ...&amp;quot; (1899)" ispublic="1" isfriend="0" isfamily="0" /&gt;
    &lt;photo id="14775778843" owner="34395619@N04" secret="b5f2702bec" server="5585" farm="6" title="_MG_7248.jpg" ispublic="1" isfriend="0" isfamily="0" /&gt;
    &lt;photo id="14775779293" owner="67793058@N00" secret="447ebe21d3" server="2900" farm="3" title="IMG_1722" ispublic="1" isfriend="0" isfamily="0" /&gt;
    &lt;photo id="14775779583" owner="124068747@N04" secret="38fd7024d8" server="3860" farm="4" title="P7270139" ispublic="1" isfriend="0" isfamily="0" /&gt;
&lt;/photos&gt;
        </x:flickrresponse>
    </s:body>
</s:envelope> 
```

# c# - 单独项目中的 EF5 模型看不到 DbContext 方法

> ID：14321648
> 
> 赞同：4
> 
> 时间：2013-01-14T15:42:37.540
> 
> 标签：c#, entity-framework-5

我是 EF 新手，我从 EF5 开始。

按照[Entity Framework 5 的性能注意事项](http://msdn.microsoft.com/en-us/data/hh949853.aspx)的建议，2.4.2 将模型移动到单独的程序集...我创建了一个单独的项目（我将其称为 EfPrj）来管理我的 Db 上下文（称为 MyDbContext）。

在我的域层（我将其称为 DomainPrj）中，我使用来自 EfPrj 的实体。问题是在 DomainPrj 中我看不到从 DbContext 继承的 MyDbContext 的成员。

例如，如果我想更新表用户，代码是：

```
void UpdateUser(User u)
{
    MyDbContext db = new MyDbContext();
    //whatever is needed
    db.SaveChanges();
} 
```

但是在 EfPrj 中它可以正常工作。在 DomainPrj 我看不到成员函数 SaveChanges()，得到这个错误：

```
'MyDbContext' does not contain a definition for 'SaveChanges' and no extension method 'SaveChanges' ... could be found (are you missing a using directive or an assembly reference?) 
```

**更新：** EfPrj 仅是一个具有 ORM 数据库优先模型的项目。MyDbContext 默认定义为 EF5 对象： public partial class MyDbContext : DbContext { public MyDbContext() : base("name=MyDbEntities") { }

所以派生自 DbContext 并且是公共的。DomainPrj 引用 EfPrj 并且`MyDbContext db = new MyDbContext()`可以正常工作。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-14T16:37:00.527

您是否尝试过从 DomainPrj 引用 EntityFramework？

由于这些方法是在 DbContext 中定义的，而 DbContext 是在 EntityFramework 中定义的，因此您必须引用它。

通常，如果您不仅要使用类，还要使用程序集中定义的委托、方法、属性等；您必须引用该程序集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-06T18:44:12.820

对我来说，我必须添加 Microsoft.Data.Services.Client.dll

# ruby-on-rails-3 - 在哪里存储请求期间的值

> ID：14321649
> 
> 赞同：1
> 
> 时间：2013-01-14T15:42:42.123
> 
> 标签：ruby-on-rails-3

## 前言

我正在 Rails 中开发纸牌游戏服务器。该应用程序通过模型实例树记录玩家应该做什么`PendingAction`。

```
class Player < ActiveRecord::Base
  has_many :cards
  has_many :pending_actions
end 
```

在任何时候，玩家都需要对任何叶子`PendingAction`s 进行操作——可能不止一个，例如：

```
1\. End turn
|
+- 2\. Do thing A
|  |
|  + 3\. Do thing pre-A
|
+- 4\. Do thing B
   |
   + 5\. Do thing pre-B 
```

视图代码向玩家展示一个或多个表单，请求他们对每个叶子动作进行选择。例如，在上述情况下，将呈现表单以征求行动 3 和 5 的输入。

当玩家为动作 5 做出选择时，该动作被破坏。然而，处理他们的选择可能会导致他们需要在父母（行动4）发生之前做出另一个选择。像这样：

```
1\. End turn
|
+- 2\. Do thing A
|  |
|  + 3\. Do thing pre-A
|
+- 4\. Do thing B
   |
   + 6\. Do other thing pre-B 
```

因此，动作 4 需要在手边，因此可以将动作 6 创建为其子项。目前，我只是将动作 4 作为函数参数传递。但是，我刚刚遇到了这样一种情况，即能够在对象的`before_save`挂钩中访问它真的很有帮助`Card`。

## 问题

存储与 a 关联的对象的最佳位置在哪里`Player`，我可以从与 that 相关的所有模型中访问该对象`Player`，这在整个 HTTP 请求中都有效——但不能超出——单个 HTTP 请求？

我在 Heroku 下运行，有 1 个测功机 - 所以我相信我是单线程的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:48:23.070

这取决于您工作的环境，但我们假设这是单线程环境。接下来，首先想到的是创建实例属性来手动分配和检索任何东西。`Player`当所有地方的实例都相同时，它将正常工作。

如果没有，我建议引入类变量，某种缓存，它将保存`Player#id => <some_obj>`引用，并使用辅助访问器，例如`Player#some_obj`它将`Player`通过`self.id`.

这样，您将确保所有`Player`具有相同 ID`some_obj`的人都是相同的。此外，您需要决定何时清空该类缓存。对于 Rails，我想`after_filter`已经足够好了。

# reporting-services - 报告服务指示灯显示错误颜色

> ID：14321651
> 
> 赞同：2
> 
> 时间：2013-01-14T15:42:49.673
> 
> 标签：reporting-services, ssrs-2008, reportbuilder3.0

我将从一张图片开始（我知道这有点难看）：

![图片](../Images/ffeb6eb4f27f3e094c42eb5fb98adade.png)

正如您在报告中看到的，我分为三组：

1.  组织级别 1 - 有一些等级和指标
2.  第二组按实体类型（组织人员）分组，每组有一个带指标的平均等级
3.  第三部分是组织人员名单及其等级和指标

指标设置如下： ![指标集](../Images/4b8071b7b546e4cb62f51770693048ea.png)

问题是有时等级为 100 时指示器显示为*黄色*（指示器应显示为绿色）。

我检查了以下内容：

1.  返回的等级为 100 但指示器仍显示黄色
2.  我试图创建 c 颜色表达式，结果是一样的。

我开始认为这是 Report builder 3 / Reporting services 的错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T09:35:22.133

我有几个建议。

*   你可以在输出中添加小数，看看黄色的 100 是否超过 100？由于这些是平均值，这可能会影响上限。

*   还可以尝试将颜色按绿色到红色的顺序排列。

**编辑：**

您的报告和/或数据中的某些内容不匹配，因为根据 tat 值的绿色“56”应该是红色的，而一些黄色应该是红色的。

*   您需要检查在红绿灯旁边打印的值，因为这些值并不能以任何方式反映您为指标得出的值。

*   还要检查`grade`字段上的数据类型，或者可以添加一个转换函数，比如`cint()`你的表达式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-13T17:12:48.783

您的字段应该是 0 到 .60、0.60 到 .85、0.85 到 1，因为看起来您所基于的字段是一个平均值。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-15T06:55:52.573

您可以尝试将黄色和绿色的范围更改为

黄色：61 到 85
绿色：86 到 100

# upgrade - 升级 xwiki（2.5 到 4.4）

> ID：14321652
> 
> 赞同：0
> 
> 时间：2013-01-14T15:42:52.570
> 
> 标签：upgrade, xwiki

我正在使用 XWIKI ENTERPRISE 2.5 并希望将其升级到 4.4 或 4.3（稳定版）我找到[了 XWiki 的升级文档](http://platform.xwiki.org/xwiki/bin/view/AdminGuide/Upgrade)。按照指南，我将重要文件备份到`WEB-INF`. 之后，我将所有文件从 new 复制`.war`到我的 wiki 目录 ( `/var/lib/tomcat6/webapps/xwiki`)。然后，我将重要文件移回并覆盖了新文件。

当我访问我的 wiki 页面时，我收到此错误消息：

```
HTTP Status 404 - type Status report
message description
  The requested resource () is not available.
Apache Tomcat/6.0.28 
```

这是日志文件：

```
SCHWERWIEGEND: Exception sending context initialized event to listener instance of class org.xwiki.container.servlet.XWikiServletContextListener
java.lang.RuntimeException: Failed to find the Observation Manager component
    at org.xwiki.container.servlet.XWikiServletContextListener.contextInitialized(XWikiServletContextListener.java:101)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4135)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4630)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:791)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:771)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:546)
    at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1041)
    at org.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:964)
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:502)
    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1277)
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:321)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:785)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:445)
    at org.apache.catalina.core.StandardService.start(StandardService.java:519)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:581)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Caused by: org.xwiki.component.manager.ComponentLookupException: Failed to lookup component [org.xwiki.observation.internal.DefaultObservationManager] identifier by [role = [interface org.xwiki.observation.ObservationManager] hint = [default]]
    at org.xwiki.component.embed.EmbeddableComponentManager.getComponentInstance(EmbeddableComponentManager.java:348)
    at org.xwiki.component.embed.EmbeddableComponentManager.getInstance(EmbeddableComponentManager.java:155)
    at org.xwiki.container.servlet.XWikiServletContextListener.contextInitialized(XWikiServletContextListener.java:99)
    ... 24 more
Caused by: org.xwiki.component.phase.InitializationException: Failed to lookup Event Listeners
    at org.xwiki.observation.internal.DefaultObservationManager.initialize(DefaultObservationManager.java:139)
    at org.xwiki.component.embed.InitializableLifecycleHandler.handle(InitializableLifecycleHandler.java:39)
    at org.xwiki.component.embed.EmbeddableComponentManager.createInstance(EmbeddableComponentManager.java:323)
    at org.xwiki.component.embed.EmbeddableComponentManager.getComponentInstance(EmbeddableComponentManager.java:378)
    at org.xwiki.component.embed.EmbeddableComponentManager.getComponentInstance(EmbeddableComponentManager.java:346)
    ... 26 more
Caused by: org.xwiki.component.manager.ComponentLookupException: Failed to lookup component [role = [interface org.xwiki.observation.EventListener] hint = [default]]
    at org.xwiki.component.embed.EmbeddableComponentManager.getInstanceMap(EmbeddableComponentManager.java:187)
    at org.xwiki.component.embed.EmbeddableComponentManager.getInstanceList(EmbeddableComponentManager.java:169)
    at org.xwiki.observation.internal.DefaultObservationManager.initialize(DefaultObservationManager.java:135)
    ... 30 more
Caused by: org.xwiki.component.manager.ComponentLookupException: Failed to lookup component [org.xwiki.security.authorization.cache.internal.DefaultSecurityCache] identifier by [role = [interface org.xwiki.security.authorization.cache.SecurityCache] hint = [default]]
    at org.xwiki.component.embed.EmbeddableComponentManager.getComponentInstance(EmbeddableComponentManager.java:348)
    at org.xwiki.component.embed.EmbeddableComponentManager.getInstance(EmbeddableComponentManager.java:161)
    at org.xwiki.component.embed.EmbeddableComponentManager.createInstance(EmbeddableComponentManager.java:312)
    at org.xwiki.component.embed.EmbeddableComponentManager.getComponentInstance(EmbeddableComponentManager.java:378)
    at org.xwiki.component.embed.EmbeddableComponentManager.getInstanceMap(EmbeddableComponentManager.java:185)
    ... 32 more
Caused by: org.xwiki.component.phase.InitializationException: Unable to create the security cache with a capacity of 500
    at org.xwiki.security.authorization.cache.internal.DefaultSecurityCache.newCache(DefaultSecurityCache.java:104)
    at org.xwiki.security.authorization.cache.internal.DefaultSecurityCache.initialize(DefaultSecurityCache.java:112)
    at org.xwiki.component.embed.InitializableLifecycleHandler.handle(InitializableLifecycleHandler.java:39)
    at org.xwiki.component.embed.EmbeddableComponentManager.createInstance(EmbeddableComponentManager.java:323)
    at org.xwiki.component.embed.EmbeddableComponentManager.getComponentInstance(EmbeddableComponentManager.java:378)
    at org.xwiki.component.embed.EmbeddableComponentManager.getComponentInstance(EmbeddableComponentManager.java:346)
    ... 36 more
Caused by: org.xwiki.cache.CacheException: Failed to get cache factory for role hint [infinispan]
    at org.xwiki.cache.internal.DefaultCacheManager.createNewCache(DefaultCacheManager.java:109)
    at org.xwiki.cache.internal.DefaultCacheManager.createNewCache(DefaultCacheManager.java:85)
    at org.xwiki.security.authorization.cache.internal.DefaultSecurityCache.newCache(DefaultSecurityCache.java:102)
    ... 41 more
Caused by: org.xwiki.component.manager.ComponentLookupException: Failed to lookup component [org.xwiki.cache.infinispan.internal.InfinispanCacheFactory] identifier by [role = [interface org.xwiki.cache.CacheFactory] hint = [infinispan]]
    at org.xwiki.component.embed.EmbeddableComponentManager.getComponentInstance(EmbeddableComponentManager.java:348)
    at org.xwiki.component.embed.EmbeddableComponentManager.getInstance(EmbeddableComponentManager.java:161)
    at org.xwiki.cache.internal.DefaultCacheManager.createNewCache(DefaultCacheManager.java:107)
    ... 43 more
Caused by: org.infinispan.jmx.JmxDomainConflictException: Domain already registered org.xwiki.infinispan
    at org.infinispan.jmx.JmxUtil.buildJmxDomain(JmxUtil.java:73)
    at org.infinispan.jmx.CacheManagerJmxRegistration.updateDomain(CacheManagerJmxRegistration.java:92)
    at org.infinispan.jmx.CacheManagerJmxRegistration.buildRegistrar(CacheManagerJmxRegistration.java:86)
    at org.infinispan.jmx.AbstractJmxRegistration.registerMBeans(AbstractJmxRegistration.java:46)
    at org.infinispan.jmx.CacheManagerJmxRegistration.start(CacheManagerJmxRegistration.java:62)
    at org.infinispan.manager.DefaultCacheManager.start(DefaultCacheManager.java:720)
    at org.infinispan.manager.DefaultCacheManager.<init>(DefaultCacheManager.java:388)
    at org.infinispan.manager.DefaultCacheManager.<init>(DefaultCacheManager.java:353)
    at org.xwiki.cache.infinispan.internal.InfinispanCacheFactory.initialize(InfinispanCacheFactory.java:104)
    at org.xwiki.component.embed.InitializableLifecycleHandler.handle(InitializableLifecycleHandler.java:39)
    at org.xwiki.component.embed.EmbeddableComponentManager.createInstance(EmbeddableComponentManager.java:323)
    at org.xwiki.component.embed.EmbeddableComponentManager.getComponentInstance(EmbeddableComponentManager.java:378)
    at org.xwiki.component.embed.EmbeddableComponentManager.getComponentInstance(EmbeddableComponentManager.java:346)
    ... 45 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T20:06:03.040

当你这么说

> 我将所有文件从新的 .war 复制到我的 wiki 目录

您是否将新文件复制**到**现有目录中？您应该从旧版本中删除所有内容并仅使用新版本中的文件，并且仅从备份中复制必要的配置文件。另外，请注意，您不应该只复制旧配置，而是*将*您的自定义设置合并到默认的新配置中。

堆栈跟踪中的根错误：

```
Caused by: org.infinispan.jmx.JmxDomainConflictException: Domain already registered org.xwiki.infinispan 
```

建议一个重复的罐子。另一种可能发生这种情况的情况是，当您在同一个容器中有多个 XWiki 实例时，在这种情况下，您应该编辑`WEB-INF/cache/infinispan/config.xml`，并将该行替换`jmxDomain="org.xwiki.infinispan"`为唯一值，例如两个实例的`jmxDomain="org.xwiki.infinispan.wiki1"`和。`jmxDomain="org.xwiki.infinispan.wiki2"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:04:39.350

从 4.0-rc-1 升级到 4.4 或 4.5 时，我遇到了同样的问题。我没有重复的 jar，也没有运行多个 XWiki 实例。infinispan 或 XWiki 的缓存实现中可能存在问题。

临时解决方法是在 config.xml 中明确允许重复域：

```
<globalJmxStatistics
     [...]
     allowDuplicateDomains="true" /> 
```

# php - 如何使用 JDatabase 1.5 而不是 mysql 呈现值列表？

> ID：14321657
> 
> 赞同：0
> 
> 时间：2013-01-14T15:43:13.403
> 
> 标签：php, joomla, joomla1.5

我在**php文件中做了一个****mysql 查询**，我想做同样的事情，但使用**JDatabase**。例如，我们有一个包含两**列的****表**，列**名**和列**图像**。这两列，包含**十行**。我想在我的 php 代码中创建一个**列表**，它将呈现如下内容：

 ******```
Name | Image        |
---------------------
AAAA | blahblah.png |
---------------------
BBBB | hahahaha.png |
--------------------- 
```

我已经使用 mysql 使其工作，但由于某些原因，我应该使用 JDatabase 使其工作。以我现在拥有的为例：

这是我的查询：

```
$query="SELECT m.name, l.image
          FROM table1 AS m, table2 AS l
         WHERE m.id BETWEEN 70 AND 80
           AND l.id = 10
         ORDER BY m.id ASC";

$result=mysql_query($query);
$num=mysql_numrows($result); 
```

这是我的 php 代码：

```
<?php $count = 0; while ($count < $num){
      $image = mysql_result($result,$count,"image"); ?>
<div><img src="'.$image.'"/></div><?php $count++;}?> 
```

如何使用 JDatabase 而不是 mysql 做同样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:24:39.170

你可以试试这个-

```
$db =& JFactory::getDBO();        
$query = "SELECT beta
            FROM table
           WHERE alpha BETWEEN 70 AND 80
           ORDER BY alpha ASC LIMIT 4 , 1";

$db->setQuery($query);
$beta = $db->loadResult(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T08:12:23.677

这是另一个例子：

```
<?php
$db =& JFactory::getDBO();        
$query="SELECT m.name, l.image
          FROM table1 AS m, table2 AS l
         WHERE m.id BETWEEN 70 AND 80
           AND l.id = 10
         ORDER BY m.id ASC";
$db->setQuery( $query );
$rows = $db->loadObjectList();
foreach( $rows as $row ): ?>
    <div><img src="<?php echo $row->image ?>"/></div>
<?php endforeach ?> 
```

编辑：要从循环外部访问这些行，您可以通过以下方式进行：

```
$image_1st = $rows[0];
$image_2nd = $rows[1];
$image_3rd = $rows[2]; 
```

...等等

```
$image_1st_src = $image_1st->image;
$image_1st_src = $rows[0]->image; 
```******

# asp.net-mvc - 使用 ASP.NET MVC ValidateFor HTML 助手和不显眼的验证

> ID：14321661
> 
> 赞同：0
> 
> 时间：2013-01-14T15:43:25.913
> 
> 标签：asp.net-mvc, asp.net-mvc-4

1.  是否可以将 Html.ValidateFor 与不显眼的验证一起使用？我希望能够做到以下几点：

    < !-- 我想使用 data-val* 属性指定验证 -->
    < input type="text" data-val-required/>

    < !-- 我想使用 HTML 助手通过视图模型属性注入 data-val* 属性 -->
    @Html.TextBoxFor(m => m.Title)

    < !-- 我也希望自己能够渲染输入控件，但也包括来自视图模型属性的验证，并且也吃掉它 -->
    @{ Html.ValidateFor(m => m.Age); }

2.  为什么在启用不显眼的验证时禁用 ValidateFor？什么是同时使用两者的简单方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T21:03:10.673

我添加了一个 HTML 扩展方法，它将检查模型元数据并产生所有`data-val*`属性​​（供 使用`jquery.unobtrusive.validation`）。

这样我就可以完全控制控件的呈现方式（有时 Html.*For 系列方法会产生不适合我需要的名称和 id 属性，添加额外的参数也可能会变得笨拙）。

请注意，您仍然需要`input`在表单元素内拥有控制权（由 要求`jquery.unobtrusive.validation`）。

```
public static MvcHtmlString Validation<TModel, TProperty>(this HtmlHelper<TModel> html, Expression<Func<TModel, TProperty>> expression) {
    ModelMetadata metadata = ModelMetadata.FromLambdaExpression(expression, html.ViewData);
    IDictionary<string, object> dataValAttrs = html.GetUnobtrusiveValidationAttributes(ExpressionHelper.GetExpressionText(expression), metadata);

    StringBuilder stringBuilder = new StringBuilder();
    foreach (var dataValAttr in dataValAttrs) {
        stringBuilder.Append(' ').Append(dataValAttr.Key).Append("=\"").Append(dataValAttr.Value).Append('"');
    }
    return new MvcHtmlString(stringBuilder.ToString());
} 
```

以下是如何使用此方法：

```
<textarea name="Description" class="input-block-level" @Html.Validation(m => m.FormData.Description)></textarea>
@Html.ValidationMessage("Description") 
```

请注意，您不能`Html.ValidationMessageFor`在此处使用版本，因为它会创建`FormData_Description`与我在这种情况下想要的名称不同的名称`Description`（为了将 POST 操作绑定到 FormData 对象。

# testing - 在 JMeter 中按顺序运行多个线程组

> ID：14321662
> 
> 赞同：59
> 
> 时间：2013-01-14T15:43:35.767
> 
> 标签：testing, jmeter, load-testing, stress-testing

我有一个测试计划，其中有多个线程组。
我想按顺序运行所有线程组。
线程组如下：

```
Thread Group1
Thread Group2
Thread Group3
. . .
Thread GroupN 
```

我在互联网上的不同博客和文章中阅读过，人们声称线程组将按照定义的顺序运行，但显然它们不是我的情况。线程组 4 在线程组 1 之前运行。线程组 4 正在生成一个错误的报告，因为它在线程组 1 之前运行。

如何确保我的线程组的顺序？

* * *

另外，我需要实现以下场景：

1.  单个用户多次运行单个请求（单个用户应从单个 HTTP 请求创建 1000 个帐户）。

2.  多个用户同时运行多个请求（多个用户应从单个 HTTP 请求同时创建 1000 个帐户）。

怎么做？

PS：请在回复前仔细阅读并理解问题。

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2013-01-14T16:30:49.653

关于测试计划中线程组的连续执行：[测试计划配置屏幕](http://jmeter.apache.org/usermanual/component_reference.html#Test_Plan)`Run Test Group consecutively`上的简单复选框：

![在此处输入图像描述](../Images/379bcbc081400c9d965230ee8324e8ce.png)

* * *

1.  为此使用例如[循环控制器](http://jmeter.apache.org/usermanual/component_reference.html#Loop_Controller)：

    ```
    **Thread Group**
    Number of Threads = 1
    Loop Count = 1
      ...
      **Loop Controller**
      Loop Count = N
          **HTTP Request**
      ... 
    ```

    甚至没有循环控制器但不那么灵活的模式：

    ```
    **Thread Group**
    Number of Threads = 1
    Loop Count = N
      ...
      **HTTP Request**
      ... 
    ```

2.  将`Number of Threads`标准线程组的属性与`Ramp-Up Period`属性一起使用：

    ```
    **Thread Group**
    Number of Threads = N
    Ramp-Up Period = 0
    Loop Count = 1
      ...
      **HTTP Request**
      ... 
    ```

    这将启动 N 个同时执行相同场景的线程。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-08-10T05:14:57.847

检查`Run Thread Groups consecutively (i.e. run groups one at a time)`中的`Test Plan`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-01-06T09:20:36.827

1.  只需在您的测试计划中添加更多线程组。
2.  在测试计划**属性中 -> 勾选 Run Test Group** Continuously 以逐步执行线程组。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-08-17T14:49:56.477

这是我找到的按特定顺序运行多个线程组的简单解决方案：

1.  选中“测试计划”下的“连续运行线程组”选项
2.  使用拖放方法按照要执行的顺序对“线程组”进行排序

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-08-02T07:09:06.713

参考这个链接。这要求您选中主测试计划中的复选框

```
Run Thread Groups consecutively (i.e. one at a time) 
```

[http://www.mahsumakbas.net/run-jmeter-thread-groups-consecutively/](http://www.mahsumakbas.net/run-jmeter-thread-groups-consecutively/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-14T21:34:02.460

关于 Alies Belik 的回答，除了连续运行线程组之外，还有另一种方法

这是第一部分使用[设置线程组](http://jmeter.apache.org/usermanual/component_reference.html#setUp_Thread_Group)。

关于设置ramp-up period，最好设置一个> 0的值，

哪个更现实，因为取决于线程数

启动它可能会延迟启动，您拥有的越多，启动所需的时间就越多。

# knockout.js - 在隐藏的 div 中可观察到的不更新

> ID：14321664
> 
> 赞同：2
> 
> 时间：2013-01-14T15:43:35.997
> 
> 标签：knockout.js, qtip

我有一个可观察到的绑定到隐藏 div 中的 textarea，如下所示：

```
<span title="sales comment" data-bind="attr: { id: 'sales-'+year() }" style="cursor :pointer;">
 <img src="information.png" alt="Add comment" />                                                  
</span>
<div data-bind="attr: { id: 'sales-'+year()+'_content'  }" style="display : none;">
 <textarea data-bind="value: salesComment, valueUpdate: 'keydown'"> </textarea>
</div> 
```

和视图模型

```
var FinancialYearViewModel = function(data, parent) {
    var self = this;
    self.year = ko.observable();
    self.salesComment = ko.observable();
};  

ko.applyBindings(new FinancialHistoryViewModel(data));

var data = {"year": "2012", "salesComment": "sales comment"} 
```

隐藏的 div 用于填充 qtip 工具提示的内容，如下所示：

```
$(document).ready(function()
{
$("span[title]").each(function(i) {         
    content = $("#" + this.id + "_content").html();
    $(this).qtip({  content: {
          text: content
         },                     
             show: {
              event: 'click'
             },
             hide: { event : 'unfocus'}                         
    });                      
  });
}); 
```

viewModel 绑定 ok 并且 qtip 根据需要将隐藏的 div 显示为其内容。但是，当 textarea 值更改时， viewModel 不会更新。

当我从 div 中删除内联 css 时，它确实有效，即：

```
<div data-bind="attr: { id: 'sales-'+year()+'_content'  }">
 <textarea data-bind="value: salesComment, valueUpdate: 'keydown'"> </textarea>
</div> 
```

但我需要默认隐藏 div 的内容，因为它仅在用户查看 qtip 时使用。

有什么想法为什么这个 css 会阻止 observable 更新 viewModel？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:45:37.440

我认为问题在于您将相应 div 的 innerHTML 内容作为 qtip 内容传递，这实际上意味着您正在复制 HTML 并丢失所有视图模型绑定。

这是问题所在：

```
content = $("#" + this.id + "_content").html(); 
```

为此，qtip 的内容需要与您将视图模型绑定到的节点完全相同的元素节点。

我还没有查看 qtip 接受的内容选项，但是您是否尝试过：

```
content = $("#" + this.id + "_content")[0]; 
```

[更新] - 我找到了作者对此发表评论的[帖子。](http://craigsworks.com/projects/forums/thread-solved-qtip-content-from-existing-div-element-on-page)因此，看起来您将无法对版本 1 的 qtip 内容使用相同的元素节点，但您可以为 qtip 版本 2 执行此操作。

# mysql - 连接具有多列连接的 3 个表

> ID：14321667
> 
> 赞同：-2
> 
> 时间：2013-01-14T15:43:56.393
> 
> 标签：mysql, left-join, inner-join

我正在努力获得所需的正确语法，并想知道是否有人可以提供帮助？

我有 3 个表：users、owneditems 和 shopitems

从用户那里我需要获取用户 ID 和城市

从 ownitems 我需要获取用户 ID 和 itemid

从 shopitems 我需要获取 id 和 city

* * *

ownitems 和 users 上的 userid 将是相同的

拥有物品上的 itemid 将与 shopitems 上的 id 相同

shopitems和users上的城市将是相同的

* * *

我要做的是找出用户在哪个城市，并绑定他们在该城市拥有的物品。

我尝试使用的语法是

```
SELECT users.city, users.id, shopitems.city, shopitems.id, owneditems.itemid, owneditems.userid 
FROM users, shopitems, owneditems 
WHERE users.city = shopitems.city 
  AND owneditems.itemid = shopitems.it 
  AND users.id = owneditems.userid 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:53:26.290

目前尚不清楚您要做什么，但是您是否尝试过使用 a`LEFT JOIN`而不是`INNER JOIN`：

```
select u.city, 
    u.id, 
    s.city, 
    s.id, 
    o.itemid, 
    o.userid
from users u
left join owneditems o
    on u.id = o.userid
left join shopitems s
    on u.city = s.sity
    and o.itemid = s.itemid 
```

# python - 嵌套迭代器上的 islice

> ID：14321669
> 
> 赞同：3
> 
> 时间：2013-01-14T15:43:57.193
> 
> 标签：python, python-2.7, iterator

我试图在[如何自动生成 N 个“不同”颜色的末尾重用该解决方案？](https://stackoverflow.com/questions/470690/how-to-automatically-generate-n-distinct-colors)使用 Python 2.7。

不幸的是，下面的代码永远不会返回，因为即使`islice()`请求了前 100 次迭代，看起来内部映射调用就像

```
gethsvs = lambda: flatten(itertools.imap(genhsv, getfracs())) 
```

强制获取所有迭代。除了将迭代次数传递给所有 lambda 函数之外，有没有办法`islice()`在主代码中进行调用，如下所示，但在所有内部映射中也只获得前 100 次迭代？

```
import colorsys, itertools, numpy as np
from fractions import Fraction

def zenos_dichotomy():
    '''
http://en.wikipedia.org/wiki/1/2_%2B_1/4_%2B_1/8_%2B_1/16_%2B_%C2%B7_%C2%B7_%C2%B7
    '''
    for k in itertools.count():
        yield Fraction(1, 2 ** k)

def getfracs():
    '''
    [Fraction(0, 1), Fraction(1, 2), Fraction(1, 4), Fraction(3, 4), Fraction(1, 8), Fraction(3, 8), Fraction(5, 8), Fraction(7, 8), Fraction(1, 16), Fraction(3, 16), ...]
    [0.0, 0.5, 0.25, 0.75, 0.125, 0.375, 0.625, 0.875, 0.0625, 0.1875, ...]
    '''
    yield 0
    for k in zenos_dichotomy():
        i = k.denominator # [1,2,4,8,16,...]
        for j in range(1, i, 2):
            yield Fraction(j, i)

'''Can be used for the v in hsv to map linear values 0..1 to something that looks equidistant.'''
bias = lambda x: (np.sqrt(x / 3) / Fraction(2, 3) + Fraction(1, 3)) / Fraction(6, 5)

def genhsv(h):
    for s in [Fraction(6, 10)]: # optionally use range
        for v in [Fraction(8, 10), Fraction(5, 10)]: # could use range too
            yield (h, s, v) # use bias for v here if you use range

genrgb = lambda x: colorsys.hsv_to_rgb(*x)
flatten = itertools.chain.from_iterable
gethsvs = lambda: flatten(itertools.imap(genhsv, getfracs()))
getrgbs = lambda: itertools.imap(genrgb, gethsvs())

def genhtml(x):
    uint8tuple = itertools.imap(lambda y: int(y * 255), x)
    return 'rgb({},{},{})'.format(*uint8tuple)

gethtmlcolors = lambda: map(genhtml, getrgbs())

if __name__ == '__main__':
    print(list(itertools.islice(gethtmlcolors(), 100))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T16:09:50.017

您在lambda中使用`map()`而不是：`itertools.imap()``gethtmlcolors`

```
gethtmlcolors = lambda: map(genhtml, getrgbs()) 
```

在 python 2 中，`map()`将尝试处理输入可迭代的所有元素。将其更改为使用`imap()`，一切正常：

```
gethtmlcolors = lambda: itertools.imap(genhtml, getrgbs()) 
```

# sql-server - BizTalk WCF-SQL 适配器 - 避免将 DBNull 传递给表值参数

> ID：14321672
> 
> 赞同：1
> 
> 时间：2013-01-14T15:44:01.997
> 
> 标签：sql-server, biztalk

我有一个 BizTalk 业务流程，它发送一条消息，该消息使用带有 WCF-SQL 适配器的生成架构映射到存储过程。存储过程的参数之一是表值参数。当有 BT 可以转换为表值的记录时，这可以正常工作。但是，如果记录为零，我仍然需要触发 proc，因为提供的其他参数仍然可以执行。但是编排崩溃了

```
System.NotSupportedException: DBNull value for parameter '@DetailRecords' is not supported. Table-valued parameters cannot be DBNull. 
```

显然，您可以绕过此错误并在不提供该参数的情况下执行存储过程，SQL Server 将自动生成一个空表。

有没有办法让 BizTalk 触发包含表值参数的存储过程，而不尝试将参数作为 DBNull 传递？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T14:38:58.687

首先，将*Record Count* functoid 连接到源模式上的重复元素。获取它的输出并将其连接到*大于*functoid 以检查行数是否大于零。最后，将*Record Count* functoid 的输出端与目标端的表值参数挂钩。![例子](../Images/af6ad979b252f7590687124588f3ac75.png)

# winapi - 创建文件夹选择对话框窗口时如何激活 SysTreeView32？

> ID：14321673
> 
> 赞同：0
> 
> 时间：2013-01-14T15:44:12.073
> 
> 标签：winapi

当我创建`SHBrowseForFolderW`对话框时，默认控件是好的，我需要做的是`SysTreeView32`激活以便用户可以使用箭头键来调整所需的文件夹。我尝试使用此代码：[http](http://comp.newsgroups.archived.at/os.ms-windows.programmer.win32/200505/05053122835.html) : //comp.newsgroups.archived.at/os.ms-windows.programmer.win32/200505/05053122835.html 可以找到对话框的 HWND 但使用`WM_NEXTDLGCTL`对窗户。

也许我应该将 TAB 击键发送到窗口，或者我不知道任何其他选项？在创建浏览对话框时是否有切换窗口创建时将突出显示哪些控件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:21:43.053

好的，事情是 PostMessage 和 SendMessage 之间的区别。我在这里错误地使用了后者。他们是不一样的！

# excel - 指示 VBA 将电子表格的副本保存在 Outlook 的指定文件夹中

> ID：14321674
> 
> 赞同：0
> 
> 时间：2013-01-14T15:44:12.847
> 
> 标签：excel, vba, outlook

我有获取所选工作表副本的代码，但在指定 Outlook 中的哪个草稿文件夹将草稿电子邮件发送到时遇到了困难。我要将草稿电子邮件发送到的文件夹的名称是“Draft NDIC”。这是代码：

```
Sub Mail_Body_NDIC()
  Dim rng As Range
  Dim OutApp As Object
  Dim OutMail As Object
  With Application
      .EnableEvents = False
      .ScreenUpdating = False
  End With

  Set rng = Nothing
  Set rng = Sheets("NDIC Renewals").UsedRange
  'You can also use a sheet name
  'Set rng = Sheets("YourSheet").UsedRange

  Set OutApp = CreateObject("Outlook.Application")
  Set OutMail = OutApp.CreateItem(0)

  On Error Resume Next
  With OutMail
      .To = "dvandervieren@enerplus.com"
      .CC = ""
      .BCC = ""
      .Subject = "NDIC Renewals for the Next 90 Days"
      .Body = ""
      .HTMLBody = RangetoHTML(rng)
      .Save   'or use .Display
  End With
  On Error GoTo 0

  With Application
      .EnableEvents = True
      .ScreenUpdating = True
  End With

  Set OutMail = Nothing
  Set OutApp = Nothing
 End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-01T18:45:32.797

“您需要使用 .Move 方法，以 oldDestFolder 作为参数。” 大卫范德维伦

[http://blog.saieva.com/2010/03/27/move-messages-to-folders-with-outlook-vba/](http://blog.saieva.com/2010/03/27/move-messages-to-folders-with-outlook-vba/)

# python - 为什么我们在循环之前分配变量“option” 1 的值？

> ID：14321679
> 
> 赞同：1
> 
> 时间：2013-01-14T15:44:29.007
> 
> 标签：python

我是编程新手，我选择 python 作为我的第一语言，因为它很简单。但我在这里对这段代码感到困惑：

```
option = 1 
while option != 0:
    print "/n/n/n************MENU************" #Make a menu
    print "1\. Add numbers"
    print "2\. Find perimeter and area of a rectangle"
    print "0\. Forget it!"
    print "*" * 28

    option = input("Please make a selection: ") #Prompt user for a selection      
    if option == 1: #If option is 1, get input and calculate 
        firstnumber = input("Enter 1st number: ")
        secondnumber = input("Enter 2nd number: ") 
        add = firstnumber + secondnumber
        print firstnumber, "added to", secondnumber, "equals", add #show results  

    elif option == 2: #If option is 2, get input and calculate
        length = input("Enter length: ")
        width = input("Enter width: ")
        perimeter = length * 2 + width * 2
        area = length * width
        print "The perimeter of your rectangle is", perimeter #show results       
        print "The area of your rectangle is", area

    else: #if the input is anything else its not valid
        print "That is not a valid option!" 
```

好的好的，我得到了`Option`变量下面的所有东西。我只是想知道为什么我们分配 的值`Option=1`，为什么我们将它添加到程序的顶部，以及它的功能是什么。我们也可以改变它的值。请让我用简单的语言理解它，因为我是编程新手。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:46:03.333

如果您没有`option`在程序开始时创建变量，则该行

```
 while option != 0: 
```

会中断，因为`option`尚不存在任何变量。

至于如何改变它的值，注意每行都会改变：

```
option = input("Please make a selection: ") 
```

发生-将其值重新分配给用户的输入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T15:46:54.947

这样它下面的 while 语句就不会尝试检查不存在的名称。它不必*被*分配`1`，它恰好是第一个非零自然数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T15:48:44.240

Python 需要先声明变量，然后才能使用它们。

在这种情况下，将决定是否`option`设置为`1`或`2`（因此我们将其设置为其中一个值，通常我们可以很容易地将其设置为`0`或空字符串）。虽然有些语言对变量声明不那么严格（想到 PHP），但大多数语言要求变量在使用之前就存在。

Python 不需要显式声明变量，只需给它们一个值来保留内存空间。另一方面，默认情况下，VB.NET 需要显式声明变量...

```
Dim var as D 
```

它设置变量`type`但不给它一个初始值。

请参阅[Python 文档](http://www.tutorialspoint.com/python/python_variable_types.htm)。

# php - PHP 未知发件人

> ID：14321682
> 
> 赞同：4
> 
> 时间：2013-01-14T15:44:44.727
> 
> 标签：php, html, forms, web

您好，我对 PHP 还很陌生，目前还不太了解。我修改了一个联系表格，遇到了一些关于邮件直接进入垃圾邮件的问题。

我认为这是因为（未知发件人）一直显示在电子邮件标题中的原因。如果有人可以帮助我纠正这个问题，我将不胜感激。以下是我在网站中实现的代码：

```
<?php
$name = $_POST['name'];
$email = $_POST['email'];
$message = $_POST['message'];
$from = 'From: Wirral PT Enquiry'; 
$to = 'joebloggs@hotmail.com'; 
$subject = 'Wirral PT Enquiry';
$human = $_POST['human'];
$headers = "enquiry@wirralpt.co.uk";
$body = "From: $name\n E-Mail: $email\n Message:\n $message";

if ($_POST['submit']) {
    if ($name != '' && $email != '') {
        if ($human == '2') {                 
            if (mail ($to, $subject, $body, $from)) { 
            echo '<p>Your message has been sent!</p>';
            } else { 
                echo '<p>Something went wrong, go back and try again!</p>'; 
            } 
        } else if ($_POST['submit'] && $human != '4') {
            echo '<p> 1+1=2!! </p>';
        }
    } else {
        echo '<p>You need to fill everything!!</p>';
    }
} 
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T15:47:32.190

`$from = 'From: Wirral PT Enquiry';` 应包含“发件人”电子邮件地址，而不仅仅是名称：

```
 $from = 'From: Wirral PT Enquiry <enquiry@wirralpt.co.uk>'; 
```

试试看？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:47:38.850

尝试使用

```
$headers = "Reply To :enquiry@wirralpt.co.uk"; 
```

可能对你有用

还，

```
$headers = "From :enquiry@wirralpt.co.uk"; 
```

使用相关的电子邮件 ID 尝试这两种方法

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T15:50:23.370

将您的标题更改为：

```
$headers = 'From: enquiry@wirralpt.co.uk' . "\r\n" .
    'Reply-To: enquiry@wirralpt.co.uk' . "\r\n" .
    'X-Mailer: PHP/' . phpversion(); 
```

你的邮件应该是这样的：

```
mail ($to, $subject, $body, $headers) 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2015-09-18T17:09:13.143

如果在使用 PhpMailer 的 SMTP 设置时，也可能导致此错误，$mail->IsSMTP(); 错过了

# xslt - 根据属性值抑制/删除 xml 内容

> ID：14321685
> 
> 赞同：1
> 
> 时间：2013-01-14T15:45:00.207
> 
> 标签：xslt, xslt-2.0

我有一个像

```
<xml>
   <Text>
       <body>
       <para type="new"> This para needs to be suppress </para> 
       <para type="old"> This is an old para </para> 
       </body>     
  </Text>    
</xml> 
```

我想抑制 body/para/@type='new' 我可以使用以下模板

```
<xsl:template match="para[@type='new']">
</xsl:template> 
```

话虽如此，我实际上想添加另一个条件，即如果 body 不包含除 para/@type='new' 以外的任何其他元素，则应删除整个 body 元素。

所以

```
 <xml>
   <Text>
       <body>
       <para type="new"> This para needs to be suppress </para> 
       </body>     
  </Text>    
</xml> 
```

应该返回

```
<xml>
   <Text>
   </Text>    
</xml> 
```

和

```
<xml>
    <Text>
       <body>
          <para type="new"> This para needs to be suppress </para> 
          <para type="old"> This is an old para </para> 
       </body>     
    </Text>    
</xml> 
```

应该返回

```
<xml>
   <Text>
       <body>
       <para type="old"> This is an old para </para> 
       </body>     
  </Text>    
</xml> 
```

任何帮助或提示如何做到这一点......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T16:03:38.230

再来一个模板怎么样：

```
<xsl:template match="Text[count(body/*) = count(body/para[@type = 'new'])]" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T16:07:56.937

这是另一种方式

```
<xsl:template match="body[para[@type='new']][not(*[2])]" /> 
```

即，将**body**元素与'new' 类型的**para**元素匹配，但不匹配第二个元素。

# xcode - 如何识别未知的退出代码？

> ID：14321688
> 
> 赞同：0
> 
> 时间：2013-01-14T15:45:03.860
> 
> 标签：xcode, macos, exit

我遇到的问题是，我经常编写的 Mac 应用程序突然退出，出现一个未知的退出代码 33，并且没有任何进一步的迹象表明出了什么问题。我已经搜索了数字 33 的整个源代码，但我找不到任何东西（我希望有一行代码，例如`exit(33)`）。

你能给我任何提示我如何追踪这个问题吗？有没有办法例如在退出函数或类似的东西中设置断点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T18:58:01.900

进程退出代码没有预定义的含义。C 标准定义`EXIT_SUCCESS`和`EXIT_FAILURE`没有数值。在类 Unix 系统上，它们被定义为 0 和 1。Unix 将这些退出限制为一个无符号的 8 位整数，因此它们的范围从 0 到 255，但每个退出代码的含义（成功的 0 除外）取决于开发商。

FreeBSD 定义了一些值，如[sysexits(3) 联机帮助页](http://www.freebsd.org/cgi/man.cgi?query=sysexits&sektion=3)中所述。但33号不在其中。

调试此问题的最佳方法是为各种`exit`函数 ( `exit`, `_exit`) 设置断点，并查看它们何时何地被调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T08:32:59.330

问题是我的代码中有一个退出调用`exit(12321)`，它在控制台中报告为 33。似乎状态参数`exit(int)`不能是任意的 int 值。

# jquery - jQuery 验证与 Ajax 表单提交冲突

> ID：14321692
> 
> 赞同：-4
> 
> 时间：2013-01-14T15:45:07.727
> 
> 标签：jquery, jquery-validate

> **可能重复：**
> [jQuery 验证：一些必填字段未填写但仍可以提交表单](https://stackoverflow.com/questions/14319857/jquery-validation-some-of-the-required-field-not-filled-but-the-form-can-still)

我使用 jquery 验证（[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)）进行表单验证：

HTML：

```
<form id="formID" action="/processForm" method="post">
  ...
  <input type="submit" value="Submit" />
</form> 
```

jQuery：

```
$("#formID").validate({
  onkeyup:false,
  rules: {
    ...
  },
  messages: {
    ...
  }
});

// Submit the form by Ajax
$(document).ready(function() {
  $('.formID').ajaxForm({
    success: function(returnData) {
      $('#content').html(returnData);
    }
  });
}); 
```

现在表单似乎是由 validate() 函数提交的，而不是由 Ajax 函数提交的。

我如何仍然使用 Ajax 功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T19:04:26.013

> 现在表单似乎是由`validate()`函数提交的，而不是由 Ajax 函数提交的。我如何仍然使用 Ajax 功能？

那是因为`validate()`插件已经`submitHandler:`内置了。以下是如何正确使用它并避免作用于同一`submit`事件的多个函数之间的潜在冲突。

```
$(document).ready(function() {

    $("#formID").validate({
      onkeyup:false,
      rules: {
        ...
      },
      messages: {
        ...
      },
      submitHandler: function(form) {
          form.ajaxForm({
              success: function(returnData) {
                  $('#content').html(returnData);
              }
          });
      }
    });

}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-14T15:47:18.020

试试这个JS：

```
$('#formID').on('submit',function(){

// call your function which send AJAX  reuest
// Or code of sending ajax reauest

return false;

}) 
```

# c++ - 声明为 float& 类型的引用数组

> ID：14321693
> 
> 赞同：4
> 
> 时间：2013-01-14T15:45:11.853
> 
> 标签：c++, c

当我`declared as array of references of type float&`将函数声明为时，XCode 中出现错误：

```
void calcCoeff(float sigma, float& ap[], float& bp[], float& an[], float& bn[]); 
```

谁能告诉我可能是什么问题？我也试过

```
void calcCoeff(float sigma, float &ap[5], float &bp[5], float &an[5], float &bn[5]); 
```

谢谢...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-14T17:16:07.023

问题与错误消息所描述的完全一样：`float& ap[]`声明了一个引用数组，这不是 C++ 中的合法类型，就像禁止引用的指针和引用的引用一样。

如果它是合法的，您可以通过考虑指针数组来思考它的含义。引用在某些方面在概念上类似于指针。引用旨在引用另一个实体，当引用需要运行时表示时，C++ 实现通常使用指针。

因此，如果要将指针数组传递给函数，则需要构造一个初始化它：

```
float a, b, c;
float *arr[] = {&a, &b, &c};    // or in fictional array-of-references syntax: float &arr[] = {a, b, c}; 
```

或者，如果您已经有一个浮点数组，并且您想要一个指向这些元素的指针数组：

```
float a[3];
float *b[] = {&a[0], &a[1], &a[2]);     // or in fictional array-of-references syntax: float &b[] = {a[0], a[1], a[2]}; 
```

大概您真正想要的是通过引用将数组传递给函数，以便函数可以写入数组并且调用者可以看到更改。（或者仅仅是因为你想避免复制数组）。由于通常函数参数是按值传递的，而通过引用传递的方法是坚持`&`在那里，你对数组类型也做了同样的事情。这是一个很好的直觉，但是 C++ 中有一些皱纹让你搞砸了。

第一个是 C++ 中声明的奇怪语法。您可以在其他地方阅读有关“螺旋规则”或“声明模仿使用”的信息，但只要说它是否`&`“更接近”（在语法上）变量名或`float`. `float &arr[]`是一个引用数组。您需要几个括号来将 & 符号更靠近变量：`float (&arr)[]`声明对数组的引用。

接下来是 C++ 不幸地从 C 继承了一些奇怪的行为，旨在使数组和指针几乎可以互换。您的情况下的相关行为是，如果您声明一个采用数组参数的函数：

```
void foo(int arr[], int size); 
```

该语言明确表示该类型被“调整”为指针。结果与以下相同：

```
void foo(int *arr, int size); 
```

这意味着数组的行为*不像*值类型。尝试“按值”传递数组不会导致将数组的可修改副本传递给函数；相反，该函数有效地“通过引用”接收数组。

第二个后果是数组参数不需要具有完整的数组类型，即可以省略数组大小，因为调整了数组类型并且无论如何都不会使用大小。这意味着，如果您天真地将未指定大小的“数组参数”转换为对数组的引用，则除了添加`&`. `float (&arr)[10]`.

* * *

在我看来，使用原始数组作为参数是非常不可取的。首先是因为它丢弃了类型信息：

```
void foo(int arr[10]) { // same as void foo(int *arr)
    int x = arr[9];
}

int bar[3];
foo(bar); // no compile error! the special array rules discarded the size of the array 
```

并且由于原始数组与其他内置类型不一致，所有这些都具有值语义。由于这些原因，应避免使用原始数组。相反，您可以使用`std::array`which 避免内置数组的所有“特殊”规则，因此其行为与内置数组一样。

```
void foo(std::array<int, 10> arr); // Takes arr by value, modifications will not be visible externally

std::array<int, 3> bar;
foo(bar); // compile error 
```

如果您需要一个动态大小的数组，那么您可以使用它`std::vector`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T15:53:05.100

将其更改为：

```
void calcCoeff(float sigma, float ap[], float bp[], float an[],
               float bn[]); 
```

您将能够很好地修改这些值。函数参数中的`[]`符号等价于指针。所以它和这个是一样的：

```
void calcCoeff(float sigma, float* ap, float* bp, float* an,
               float* bn); 
```

这意味着在这两种情况下，您都会获得指向数据的指针而不是副本。`[]`语法只是一种风格决定；尽管`float a[]`与 的含义相同`float* a`，但`[]`语法是对函数调用者的暗示，它可以在数组而不是单个变量上工作。

# asp.net-mvc-4 - 简单会员：用户的最后登录日期

> ID：14321696
> 
> 赞同：8
> 
> 时间：2013-01-14T15:45:31.487
> 
> 标签：asp.net-mvc-4

我在我的 asp.net MVC 4 应用程序中使用简单的成员资格。我如何获得用户的最后登录日期。我没有在默认网页架构表中看到创建日期？我是否需要在简单的会员资格中为 LastLogin 日期创建字段？谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-03T17:10:53.713

我已经这样解决了：

1.  我在 UsersContext 中的 UserProfile 模型中添加了 LastLogin 字段：

    ```
    [Table("UserProfile")]
    public class UserProfile 
    {    
        [Key]    
        [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
        public int UserId { get; set; }
        public virtual string UserName { get; set; }
        public virtual DateTime? LastLogin { get; set; }
    } 
    ```

2.  我修改了 AccountController 中的登录方法：

    ```
    public ActionResult Login(LoginModel model, string returnUrl)
    {            
        if (ModelState.IsValid && WebSecurity.Login(model.UserName, model.Password, persistCookie: model.RememberMe))     
        {
            using (UsersContext db=new UsersContext())                
            {
                UserProfile  userProfile = db.UserProfiles.SingleOrDefault(u=>u.UserName==model.UserName);
                userProfile.LastLogin = DateTime.Now;
                db.Entry(userProfile).State=EntityState.Modified;
                db.SaveChanges();
            }

            return RedirectToLocal(returnUrl);
        }

        // If we got this far, something failed, redisplay form
        ModelState.AddModelError("", "The user name or password provided is incorrect.");
        return View(model);
    } 
    ```

3.  然后我像下面这样获取 UserProfiles：

    ```
    public ActionResult Index()
    {
        return View("Index",_db.UserProfiles);
    } 
    ```

4.  最后，我在 Index.cshtml 中显示了 LastLogin DateTime：

    ```
    @foreach (var item in Model)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.UserName)
            </td>  
            <td>
                @Html.DisplayFor(modelItem => item.LastLogin)
            </td>
        </tr>
    } 
    ```

# javascript - 调试时如何在 IE 开发人员工具的主内容窗格中刷新 JavaScript？

> ID：14321698
> 
> 赞同：1
> 
> 时间：2013-01-14T15:45:37.437
> 
> 标签：javascript, internet-explorer, ie-developer-tools

我正在编写/测试 JavaScript 代码。

我正在使用 IE9 开发人员工具来调试 JavaScript。当我对代码进行更改时，刷新页面 (Ctrl+F5)，然后单击“停止调试”，主内容窗格中的 JavaScript 就会更新。但是，当我单击“开始调试”来测试新代码时，内容窗格会恢复到以前的代码。

我试过清除浏览器缓存，但这并不能解决问题。

我现在可以解决这个问题的唯一方法是重新启动浏览器，但这是不可接受的，因为我不应该关闭浏览器，然后再次登录网站只是为了测试更改一行代码。

# c# - 谁能指出我如何创建半圆形径向菜单的正确方向？

> ID：14321703
> 
> 赞同：1
> 
> 时间：2013-01-14T15:45:55.833
> 
> 标签：c#, wpf, menu, radial

以下是我想要实现的粗略图片。

![半圆](../Images/6866fb1c4d502439e7e64054a3add2d6.png)

这就是最终结果。图片中的黑色方块将是一个切换按钮。按下该按钮时，将出现半个圆圈。理想情况下，它会从右侧开始动画并下降到底部。菜单项将出现在红线内。

我需要指导从哪里开始创建这个控件。很明显我需要创建一个 WPF UserControl，但我不知道还需要什么才能让它运行。

任何方向都会有所帮助。

# perl - 使用 ssh 在另一个脚本中运行 perl 脚本

> ID：14321706
> 
> 赞同：1
> 
> 时间：2013-01-14T15:46:00.693
> 
> 标签：perl, ssh

我有一个 perl 脚本，我需要使用 ssh 连接到另一台机器并运行另一个 perl 脚本。我尝试使用这条线：

```
system("ssh $admin_server 'perl /Perl/scripts/capture_server_restarts_gse.pl $month $date'"); 
```

但是每次脚本到达该行时，我都会收到远程机器的提示，并且脚本不会运行。

我该如何解决这个问题，以便脚本在另一台机器上自动运行而不显示提示。

注意：我不需要密码和用户来连接到我们已经解决的远程机器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:47:30.000

为什么不将您的公钥复制到另一台机器上？这样，您将获得预先授权。

[以下是](http://www.thegeekstuff.com/2008/11/3-steps-to-perform-ssh-login-without-password-using-ssh-keygen-ssh-copy-id/)有关如何使用的说明`ssh-keygen`

否则，您必须输入`ssh`密码，这很棘手，因为`ssh`通常从 a 获取输入，`tty`并且您必须使用密码配置脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T07:56:59.870

SSH 服务器可以配置为始终运行一些自定义 shell，而不是从客户端传递的命令。

尝试从命令行运行一些简单的命令，即：

```
 ssh server ls 
```

一个不太可能的可能性是，插入到系统参数中的 perl 变量可能包含一些需要更好转义的 shell 元字符。例如，$admin_server 中的分号。

# ruby-on-rails - 没有关系的rails范围模型

> ID：14321708
> 
> 赞同：-1
> 
> 时间：2013-01-14T15:46:04.040
> 
> 标签：ruby-on-rails, scope, rails-activerecord, named-scope, active-relation

我有这样的模型

```
class Ads::Posting < ActiveRecord:Base
  has_one :child, class_name: 'Ads::Posting', foreign_key: :posting_id
  belongs_to :parent, class_name: 'Ads::Posting', foreign_key: :posting_id
end 
```

我需要编写没有孩子的所有帖子的范围。任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:51:31.637

那个模型没有意义！

孩子自动成为父母。

你到底想做什么？一颗树？

那么你需要添加到迁移

```
t.integer :parent_id, null: false 
```

在你的模型中

```
has_one :child, class_name: 'Ads::Posting', foreign_key: :parent_id 
```

为了使它更深，看看

```
https://github.com/stefankroes/ancestry 
```

也许那对你有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T16:52:17.150

我相信您可以使用 a`LEFT JOIN`和 a 对`where`子句的限制来做到这一点。

```
scope :my_scope, 
  joins("LEFT JOIN postings ON postings.ad_id = ads.id").where("postings.id IS NULL") 
```

# ruby-on-rails - Ruby on Rails 会锁定用户会话吗？

> ID：14321709
> 
> 赞同：1
> 
> 时间：2013-01-14T15:46:06.820
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我来自 PHP 背景，对 RoR 用户会话有疑问。默认情况下，PHP 使用带有写锁的文件存储来存储用户会话数据。因此它可以防止同一客户端同时处理多个请求。RoR 如何处理会话？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:53:49.213

rails 中的默认会话存储将整个会话数据存储在会话 cookie 本身（称为 cookiestore）中。

这样做的一个副作用是，如果 2 个重叠请求都尝试更新会话，那么最后一个将响应发送回客户端的请求“获胜”。

我不认为 Rails 常用的任何会话存储都具有您描述的并发属性。

# android - 如何从意图下载服务访问变量？

> ID：14321711
> 
> 赞同：0
> 
> 时间：2013-01-14T15:46:12.503
> 
> 标签：android, service, toast, intentservice

我创建了一个意图下载服务，我想将下载数据传递给 Toast 和主要活动中的文本。下载服务应反复从报警管理器启动。我该怎么做呢？

目前，它没有显示在 Toast 中，但我有网络流量；数据已下载但未显示。

相关代码：

```
 public class DownloadService extends IntentService {

public String response;

  public DownloadService() {
    super("DownloadService");
  }

  // Will be called asynchronously be Android
  @Override
  protected void onHandleIntent(Intent intent) {

    //String urldown = intent.getStringExtra("url");
    String urldown="http://......";

        DefaultHttpClient client = new DefaultHttpClient();
        HttpGet httpGet = new HttpGet(urldown);
        try {
          HttpResponse execute = client.execute(httpGet);
          InputStream content = execute.getEntity().getContent();

          BufferedReader buffer = new BufferedReader(new InputStreamReader(content));
          String s = "";
          while ((s = buffer.readLine()) != null) {
            response += s;
          }

    } catch (IOException e) {
      e.printStackTrace();
    }
         Intent intentsend=new Intent("update");
          intentsend.putExtra( "downdata",response);
          sendBroadcast(intentsend); 
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:12:15.107

这可以通过以下方式实现`BroadcastReceiver`：

在您的活动中，添加以下代码：

```
private BroadcastReceiver updateReceiver;

//...

@Override
protected void onResume() {
    super.onResume();

    updateReceiver=new BroadcastReceiver() {
        @Override
        public void onReceive(Context context, Intent intent) {
            //get extras, do some stuff
        }
    };
    IntentFilter updateIntentFilter=new IntentFilter("update");
    registerReceiver(updateReceiver, updateIntentFilter);
}

@Override
protected void onPause() {
    super.onPause();

    if (this.updateReceiver!=null)
        unregisterReceiver(updateReceiver);
} 
```

然后，在您的 中`IntentService`，只需发送具有相同操作的广播：

```
Intent intent=new Intent("update");
intent.putExtra(...);
sendBroadcast(intent); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-10T16:10:23.313

就我个人而言，接收器没有工作，所以我创建了一个单例类，在其中我使用 setter 方法来设置变量，并使用 getter 方法将它们带到特定的活动中。

# ember.js - 我可以在 Ember js 模型上指定商店吗？

> ID：14321712
> 
> 赞同：9
> 
> 时间：2013-01-14T15:46:13.770
> 
> 标签：ember.js

我正在尝试在 Ember 中使用多个商店，因为我在 api 端有命名空间模型。

阿卡

```
App.Gl.Account = DS.Model.extend //Needs to route to /gl/accounts

App.Company = DS.Model.extend //Routes to /companies 
```

我的第一个想法是定义一个命名空间

```
App.Gl = Ember.Namespace.create({});
//and a store
App.Gl.Store = DS.Store.extend({adapter:DS.RESTAdapter({namespace:'gl'})});
App.Store = DS.Store.extend({adapter:DS.RESTAdapter}) 
```

问题是模型自动绑定到 App.Store。

关于如何完成命名空间模型的任何其他建议都会有所帮助。我什至不需要它们在客户端 js 端命名空间，只要有一种简单的方法可以为每个单独的模型指定命名空间

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-15T00:45:25.493

在 Ember 应用程序中，您永远不应拥有多个商店。

相反，您可以为特定类型注册适配器：

```
App.Store.registerAdapter('App.Post', DS.RESTAdapter.extend({
  // implement adapter; in this case
  url: "/gl"
})); 
```

`RESTAdapter`除非您有特定的需求并且愿意使用（仍在不断发展的）适配器 API，否则您可能希望将其用作起点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-02-21T19:59:23.000

在较新版本的 ember 中（我正在运行 1.5.0-beta.1+canary.13995621，而 1.4 似乎也缺少 registerAdapter 方法）api 发生了一些变化，registerAdapter 方法消失了。

现在，如果您想要一个模型的非默认适配器，您可以定义一个`App.<ModelName>Adapter`，它将自动用于该模型。

因此，如果您有一个 Post 模型并且您想为该模型定义命名空间，我认为应该是：

```
App.PostAdapter = DS.RESTAdapter.extend({
  namespace: 'gl'
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-11T01:18:12.443

已经没有`registerAdapter`办法了。

对于余烬 2：

> 可以通过将您的适配器类放在应用程序的 app/adapters/ + 模型名称 + .js 文件中来创建特定于模型的适配器。

来源：[DS.Adapter 类](http://emberjs.com/api/data/classes/DS.Adapter.html)

# node.js - 如何杀死特定项目（nodejs）的setInterval（clearInterval）

> ID：14321715
> 
> 赞同：3
> 
> 时间：2013-01-14T15:46:21.217
> 
> 标签：node.js, setinterval

我使用 MySQL 存储数据并每隔几分钟向 URL 发送请求。

URLs 表被查询一次，并且通过每分钟使用 setInterval() 运行 sendRequest 函数来重新发送每个请求。

问题是，如果从数据库中删除 URL，它仍然会继续发送请求，因为我没有在每个请求之前查询数据库（并且我的函数不知道记录已被删除）。

而且，我不想在每个请求之前查询相关的数据库记录，因为那是一种矫枉过正（有很多记录）。

因此，我愿意每分钟查询一次数据库以查找所有已删除的记录并清除已删除的记录。这样我就不需要每分钟查询每条记录，而只需每分钟查询一次更新记录（如果我有一百万个 URL，这将导致每分钟 1 个查询，而不是每分钟 100 万个查询）。

但是，假设我的查询告诉我数据库记录 1,3 和 6 被删除，我怎样才能只清除它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:05:46.710

您可以将链接到记录 ID 的超时 ID 存储在对象中：

```
var recordIntervals = {};

recordIntervals[recordId] = setInterval(queryRecordId, time); 
```

However that's probably not a good idea. What I'd do it keep only one interval running every minute, query the database and then send the requests to whatever URLs the database gives me.

```
setInterval(function () {
  var urls = db.query('SELECT * from URLs');
  urls.forEach(function (url) {
    sendRequest(url);
  });
}, oneMinute); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T16:21:34.950

Seems like I solved it this way:

Defined the setInterval (with var names like url6, url5..) as

global['url' + urlID] = setInterval.....

And, with an updated records query each minute, called clearInterval for the defined records:

clearInterval(global['url' + urlID]);

While asking the question, I was actually looking for a schema like both @juandopazo and @George suggested and accepting the answer of @juandopazo as it was the 1st answer. Thanks so so much.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T15:59:47.790

您可以使用 2 个数组（或带有 2 个数组的 json 数组）：一个用于存储 url，一个用于存储间隔

**示例 1**

```
nrRequests = 1;
urls[nrRequests] = url;
requests[nrRequests] = setInterval(function(){},1000);
nrRequests++; 
```

**示例 2**

```
var requests = [];
var interval = setInterval...
var url = get url..
requests.push({
   interval : interval,
   url: url
}); 
```

///deleted url: 搜索 urls 并找到索引，然后清除为 requests[nrRequests] 设置的间隔

```
for(var item in requests)
{
    if(requests[item][url]==deletedurl)
    {
        clearInterval(requests[item][interval]);
        delete requests[item];
    }
} 
```

# c++ - 在 C++ 程序中使用 libvo-aacenc 和 libav

> ID：14321717
> 
> 赞同：1
> 
> 时间：2013-01-14T15:46:31.307
> 
> 标签：c++, windows, encoding, aac, libav

我正在制作一个程序来记录和编码这个录音到 aac。我为 linux 和 libfaac 做了一个函数来完成这项工作。现在我需要为 Windows 制作这个程序。我知道我需要使用 libvo-aacenc，但我不知道要在我的代码中更改什么。你能告诉我该怎么做吗？这是我的代码。

```
static void encodeAac( const char *infilename,const char *filename)
{
    AVCodec *codec;
    AVCodecContext *c = NULL;
    int frame_size, i, j, out_size, outbuf_size;
    FILE *f,*fin;
    SAMPLE *samples;
    float t, tincr;
    uint8_t *outbuf;

    avcodec_register_all();                                                 //Load all codecs
    av_register_all();
    codec = avcodec_find_encoder(AV_CODEC_ID_AAC);  //Search for AAC codec
    if (!codec) {
            error("Codec not found");
    }
    c = avcodec_alloc_context();
    c->bit_rate = 64000;
    c->sample_fmt = AV_SAMPLE_FMT_S16;
    c->sample_rate = SAMPLE_RATE;
    c->channels = NUM_CHANNELS;
    c->time_base.num= 1;
    c->time_base.den= SAMPLE_RATE;
    c->profile= FF_PROFILE_AAC_MAIN;
    if (avcodec_open(c, codec) < 0) {
            error(add("","",avcodec_open(c, codec)).c_str());
            exit(1);
    }
    f = fopen(filename, "wb");
    fin=fopen(infilename,"rb");
    if (!fin) {
            error("could not open temporary file");
    }
    if (!f) {
            error("could not open output file");
    }
    std::cout << c->frame_size*c->channels << std::endl;
    samples = new SAMPLE[c->frame_size*c->channels];
    outbuf = new uint8_t[FRAMES_PER_BUFFER * NUM_CHANNELS];
    while(fread(samples,sizeof(SAMPLE),c->frame_size*c->channels,fin)){
            out_size=avcodec_encode_audio(c,outbuf,FRAMES_PER_BUFFER * NUM_CHANNELS,samples);
            fwrite(outbuf,sizeof(uint8_t),out_size,f);
    }
    for(int i=1;i<=4;i++){                          //For buffer flushing
    out_size=avcodec_encode_audio(c,outbuf,FRAMES_PER_BUFFER * NUM_CHANNELS,NULL);
    fwrite(outbuf,sizeof(uint8_t),out_size,f);
    }

    fclose(f);
    delete outbuf;
    delete samples;

    avcodec_close(c);
    av_free(c);
} 
```

# php - 从多个表查询中删除

> ID：14321719
> 
> 赞同：1
> 
> 时间：2013-01-14T15:46:41.493
> 
> 标签：php, mysql, sql, sql-delete

我想从这个基于reserveringsnr 的查询中删除所有这些结果。

```
(SELECT DISTINCT res.reserveringsnr, datum, begintijd, eindtijd, aantalpersonen, klantnr, betaald, tafr.tafelnr, menr.reserveringsnr, menr.menunr, menr.uniqueid FROM reserveringen as res
    INNER JOIN menus_regel as menr
    ON res.reserveringsnr = menr.reserveringsnr
    INNER JOIN tafels_regel AS tafr
    ON res.reserveringsnr = tafr.reserveringsnr
    WHERE res.reserveringsnr = '21') 
```

但是这样的事情似乎不起作用

```
DELETE FROM 
(SELECT DISTINCT res.reserveringsnr, datum, begintijd, eindtijd, aantalpersonen, klantnr, betaald, tafr.tafelnr, menr.reserveringsnr, menr.menunr, menr.uniqueid FROM reserveringen as res
    INNER JOIN menus_regel as menr
    ON res.reserveringsnr = menr.reserveringsnr
    INNER JOIN tafels_regel AS tafr
    ON res.reserveringsnr = tafr.reserveringsnr
    WHERE res.reserveringsnr = '21')Delete
WHERE Delete.reserveringsnr = '21' 
```

任何人都可以将我推向正确的方向吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:51:05.943

下面的查询将只删除表上的所有记录`reserveringen`。

```
DELETE  res
FROM    reserveringen as res
        INNER JOIN menus_regel as menr
            ON res.reserveringsnr = menr.reserveringsnr
        INNER JOIN tafels_regel AS tafr
            ON res.reserveringsnr = tafr.reserveringsnr
WHERE   res.reserveringsnr = '21' 
```

但是如果要从所有`reserveringsnr`匹配的表中删除记录，则需要在`DELETE`子句中指定所有表名

```
DELETE  res, menr, tafr
FROM    reserveringen as res
        INNER JOIN menus_regel as menr
            ON res.reserveringsnr = menr.reserveringsnr
        INNER JOIN tafels_regel AS tafr
            ON res.reserveringsnr = tafr.reserveringsnr
WHERE   res.reserveringsnr = '21' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:58:16.223

如果您必须在一行中完成，那么@JW 的答案看起来是正确的。但是，我更喜欢在单独的行中运行这些以解决性能问题——如果每个表中有很多记录，则连接将比单个删除花费更长的时间。

```
DELETE 
FROM reserveringen  
WHERE reserveringsnr = '21';

DELETE 
FROM menus_regel 
WHERE reserveringsnr = '21';

DELETE 
FROM tafels_regel 
WHERE reserveringsnr = '21' 
```

这是一个关于删除的有用链接：

[http://dev.mysql.com/doc/refman/5.0/en/delete.html](http://dev.mysql.com/doc/refman/5.0/en/delete.html)

# javascript - 保持表格行完整并随机排列它们所在的列

> ID：14321724
> 
> 赞同：0
> 
> 时间：2013-01-14T15:47:07.910
> 
> 标签：javascript, html

我有一张桌子。左栏是英文单词，右栏是韩文单词。如何保持行完整，然后随机化列的顺序？例子：

```
<table>
<colgroup>
  <col width="*" />
  <col width="*" />
</colgroup>
<tbody>
  <tr>
    <td>turn</td>
    <td><strong>설정하다</strong></td>
  </tr>
  <tr>
    <td>turn aside, turn around</td>
    <td><strong>옆으로 비키다&lt;/strong></td>
  </tr>
  <tr>
    <td>turn around</td>
    <td><strong>옆을보다</strong></td>
  </tr>
  <tr>
    <td>hear / listen</td>
    <td><strong>듣다</strong></td>
  </tr>
</tbody> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:03:33.393

**更新**：改组`tr`s

```
var
  trs = document.querySelectorAll('tr'),
  i = trs.length,
  tr;

for (; i > 1; i -= 1) {
  tr = trs.item(Math.floor(Math.random() * i));
  tr.parentNode.appendChild(tr);
} 
```

演示：http: [//jsbin.com/ogemec/1/](http://jsbin.com/ogemec/1/)

# javascript - div 上课 X 时间后的事件

> ID：14321726
> 
> 赞同：0
> 
> 时间：2013-01-14T15:47:12.007
> 
> 标签：javascript, jquery, events, timer

我需要在 div1 具有“.selected”类 X 秒后使 div2 可见，并在 div1 失去“.selected”类时恢复为隐藏。解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:54:09.497

添加`.selected`类后，您可以设置超时以显示 div 2：

```
setTimeout(function(){
    //-- code to show div 2 here --//
}, 2000); 
```

2000 是执行该功能之前等待的时间（以毫秒为单位）。

然后在丢失时`.selected`可以再次隐藏 div2 ( `hide()`);

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T16:17:23.877

您可以使用以下代码将类名事件侦听器添加到对象以检测更改：

```
function addClassNameListener(elemId, callback) {
var elem = document.getElementById(elemId);
var lastClassName = elem.className;
window.setInterval( function() {   
   var className = elem.className;
    if (className !== lastClassName) {
        callback();   
        lastClassName = className;
    }
},10);
} 
```

如果您愿意，可以调整它以查找某个类名:)

这是它的实际应用：

[http://jsfiddle.net/gJgmV/5/](http://jsfiddle.net/gJgmV/5/)

**编辑**：这可能是一个中等强度的功能，因为它基本上是检查类是否每 10 毫秒发生变化。

如果在您的情况下可行，那么最好将一个函数添加到任何设置类的 onclick 事件中。这是一个演示：http: [//jsfiddle.net/gJgmV/6/](http://jsfiddle.net/gJgmV/6/)

# android - 替换 Drive.Builder 的 setJsonHttpRequestInitializer

> ID：14321734
> 
> 赞同：0
> 
> 时间：2013-01-14T15:47:26.517
> 
> 标签：android, google-drive-api

我正在使用`google-api-services-drive-v2-rev39-java-1.12.0-beta`（写作期间最新）

我发现`setJsonHttpRequestInitializer`不再出现在`Drive.Builder`

```
 final HttpTransport transport = new NetHttpTransport();
    final JsonFactory jsonFactory = new GsonFactory();
    GoogleCredential credential = new GoogleCredential();
    // authToken is String.
    credential.setAccessToken(authToken);
    // ClientCredentials.KEY is String, generated from https://code.google.com/apis/console/b/0/?api=drive#project:369087808589
    Drive service = new Drive.Builder(transport, jsonFactory, credential)
        .setApplicationName(Utils.getApplicationName())
        .setJsonHttpRequestInitializer(new GoogleKeyInitializer(ClientCredentials.KEY))
        .build(); 
```

如果我不调用就执行代码`setJsonHttpRequestInitializer`，我会得到

**已超过未经验证使用的每日限制。继续使用需要注册。**

有什么方法可以将 API 密钥 ( `ClientCredentials.KEY`) 传递给`Drive.Builder`？

注意：检查已经[为 Drive.Builder Android 类型的 setJsonHttpRequestInitializer 方法未定义](https://stackoverflow.com/questions/13398607/the-method-setjsonhttprequestinitializer-is-undefined-for-the-type-drive-builder)。没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T22:52:59.910

查看 Google Drive SDK 文档中的 Android 快速入门，了解在 Android 上构建服务和授权请求的正确方法：

[https://developers.google.com/drive/quickstart-android](https://developers.google.com/drive/quickstart-android)

# joomla - 响应式模板 joomla

> ID：14321736
> 
> 赞同：1
> 
> 时间：2013-01-14T15:47:31.583
> 
> 标签：joomla

我正在使用 joomla 3.0 我想创建一个响应式模板，我为此使用了龙门。[龙门式](http://www.gantry-framework.org/)

我有我的主菜单，在龙门框架中我激活了位置顶部和标题，我把我的菜单放在位置标题-a

但不要给我任何东西。任何人都知道这个框架是如何工作的，我看到所有文档显然很容易

任何人都知道创建响应式模板的好文档

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-17T12:02:00.877

Gantry 是响应式 Joomla 模板的不错选择。

这可能并不明显，但您需要将 RokNavMenu 安装为 Gantry 中的默认菜单系统。

它可以从 RocketTheme 网站免费下载。

# javascript - 从数组中删除 TableCellElement 会阻止 innerHTML 工作？

> ID：14321738
> 
> 赞同：1
> 
> 时间：2013-01-14T15:47:32.643
> 
> 标签：javascript, arrays, greasemonkey, alert

在 Greasemonkey 中使用 JavaScript，我试图提取单个单元格并读取`innerHTML`每个单元格的内容以搜索给定的字符串。

有一个 3x3 的表，我想先按中心的顺序搜索它们，然后根据情况，移动到不必要的线性进程（即左上、上、左、右上、左下，右下，右下）。

我已将每个单元格放入一个数组中，并使用`splice()`将单元格分配给一个变量。出于测试目的，我使用 cell 变量本身抛出 2 个警报，然后是 cell `innerHTML`。

当我只使用变量时，警报说`[object HTMLTableCellElement]`，但`innerHTML`未定义。

我创建了一个模拟页面来展示我的示例。这是代码（[也在jsBin）](http://jsbin.com/ilezax/2)。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<body>
<table>
<tr>
    <td>0</td>
    <td>1</td>
    <td>2</td>
</tr>
<tr>
    <td>3</td>
    <td>4<br>
        center
    </td>
    <td>5</td>
</tr>
<tr>
    <td>6</td>
    <td>7</td>
    <td>8</td>
</tr>
</table>
<script language="JavaScript">
    var tables = document.getElementsByTagName("table");
    tables[0].style.border = "thin solid red";
    tables[0].id = "grid";
    var grid = tables[0];
    var cells = new Array();
    cells[0] = grid.rows[0].cells[0]; // nw
    cells[1] = grid.rows[0].cells[1]; // n
    cells[2] = grid.rows[0].cells[2]; // ne
    cells[3] = grid.rows[1].cells[0]; // w
    cells[4] = grid.rows[1].cells[1]; // c
    cells[5] = grid.rows[1].cells[2]; // e
    cells[6] = grid.rows[2].cells[0]; // sw
    cells[7] = grid.rows[2].cells[1]; // s
    cells[8] = grid.rows[2].cells[2]; // se
    var grid_string = "";

    function HumanCount(cell) {
        var human_regex = /Human/;
        var humans = cell.innerHTML.split(human_regex);
        var humans_length = humans.length - 1;
        return humans_length;
    }
    for (a = 0; a < 9; a++) {
        cells[a].count = HumanCount(cells[a]);
        grid_string += cells[a].count + " ";
        if (a == 2 || a == 5) {
            grid_string += "<br>";
        }
    }
    var direction = 0; // nw
    var center = cells.splice(4, 1);

    alert("center: " + center);
    alert("innerHTML: " + center.innerHTML);
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T02:02:55.177

`center`不是元素，所以它没有`innerHTML`属性。
`center`是一个*元素数组*，所以如果你使用：

```
alert ("innerHTML: " + center[0].innerHTML); 
```

你会看到你所期望的。

~~~

该警报`alert("center: "+center);`具有误导性，因为它显示`<td>`与 相同`[<td>]`。

要获得更准确（且不那么烦人）的调试，请不要使用`alert()`. 使用`console.log`, EG: `console.log ("center: ", center);`-- 这会将数组显示为与元素不同，并且不会抛出模式对话框。

# c++ - 优化 C 代码

> ID：14321740
> 
> 赞同：1
> 
> 时间：2013-01-14T15:47:37.113
> 
> 标签：c++, c, algorithm, optimization

假设我们有一个数字数组 {1,2,3}，我们希望在尽可能少的圈数内使数字相等；其中“转弯”的定义如下：

反过来，您需要按原样固定其中一个元素的值，然后每隔一个数字递增 1。

考虑到例如。已经提到 - A={1,2,3} ，目标是使它们均衡。我已经做的是制定逻辑，即使用最小圈数的方法是在每圈中选择最大圈数。

> 迭代 1：保持 A[2]=3。迭代结束时的数组 => {2,3,3}
> 
> 迭代 2：保持 A[2]=3。迭代结束时的数组 => {3,4,3}
> 
> 迭代 3：保持 A[1]=4。迭代结束时的数组 => {4,4,4}

因此，转数 = 3

我写的代码如下：

```
#include<iostream>
#include<stdio.h>

int findMax(int *a,int n)
{
    int i,max;
    max=1;
    for(i=2;i<=n;i++)
    {
        if(a[i]>a[max])
        {
            max=i;
        }     

    }
    return max;
}

int equality(int *a,int n)
{
    int i;
    for(i=1;i<n;i++)
    {
        if(a[i]!=a[i+1]) return 0;
    }
    return 1;
}

int main()
{
    int a[100],i,count,t,posn_max,n,ip=0;
    scanf("%d",&t);
    while(ip<t)
    {
        count=0;
        scanf("%d",&n);

        for(i=1;i<=n;i++)
        {
            scanf("%d",&a[i]);
        }
        while(equality(a,n)==0)
        {
            posn_max=findMax(a,n);

            for(i=1;i<=n;i++)
            {
                if(i!=posn_max)
                {
                    a[i]=a[i]+1;
                }
            }
            count++;

        }
        printf("%d\n",count);
        ip++;
    }
    return 0;
} 
```

这给了我我需要的正确答案。但我想进一步优化它。

我的时间限制是 1.0 s 。但是法官网站告诉我我的代码需要 1.01 秒。谁能帮我吗？

据我所知，与 cout/cin 相比，我使用了 scanf/printf 语句，以优化输入/输出部分。但是我还应该做得更好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:59:16.523

在您的算法中，您正在增加期望中的所有数字以获得最大值。

如果你反过来做，减少最大值并保留其余数字，结果应该是相同的（但内存/数组操作要少得多）！

为了使其更快，您可以完全摆脱内存操作（也正如[Ivaylo Strandjev](https://stackoverflow.com/a/14321817/246263)所建议的那样）：找到最小数字并通过上述想法（减少数字而不是增加）您知道需要减少多少所有数字到这个最小数字。因此，在找到最小值后，您需要一个循环来计算圈数。

以你为例`{1,2,3}`

*   最小值为 1
*   圈数：(1-1)+(2-1)+(3-1) = 0 + 1 + 2 = 3

如果你真的很聪明，可以在输入数字时直接计算圈数并跟踪当前的最小圈数……试试吧！;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T15:51:42.170

您只关心计数而不关心您需要执行的实际操作。因此，与其逐个执行动作，不如尝试找到一种方法来**计算**不**执行**动作的数量。你写的代码再优化也不会超过时限。您所做的最大元素观察将在此过程中为您提供帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T16:06:04.913

除了其他评论之外，如果我做对了并且您的代码有点太慢，这里有两个优化应该可以帮助您。

首先，您可以将equality() 和findMax() 结合起来，并且只扫描一次数组，而不是当前最坏的情况（两次）。

其次，您可以将“增加”循环分成两部分（低于和高于最大位置）。这将消除检查循环中位置的工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T16:02:04.767

1) 尝试展开循环 2) 你可以使用 SIMD 指令吗？那真的会加快这段代码的速度

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-14T16:45:11.117

我会`printf`在一个单独的线程中，因为它是一个 I/O 操作并且比您的计算慢得多。

它也不需要复杂的管理，例如 Producer-Consumer 队列，因为您只传递从 0 到 last 的有序数字`count`。

这是伪代码：

```
 volatile int m_count = 0;
    volatile bool isExit = false;

    void ParallelPrint()
    {
        int currCount = 0;

        while (!isExit)
        {
            while (currCount < m_count)
            {
                currCount++;
                printf("%d\n", currCount);
            }

            Sleep(0); // just content switch
        }
    } 
```

Open the thread before the `scanf("%d",&t);` (I guess this initialization time is not counted), and close the thread by `isExit = true;` before the return from your `Main()`.

# ssh - cpanel 上的 Jailshell - 允许访问其他文件夹

> ID：14321742
> 
> 赞同：2
> 
> 时间：2013-01-14T15:47:47.300
> 
> 标签：ssh, cpanel, jail-shell

我一直无法找到解决此问题的方法。我希望客户端能够让***jail-shell***访问（而不是普通的 shell 访问）能够运行我也允许访问的命令，例如 Git。

Git要求您包含该文件夹`/usr/local/libexec/git-core`，但我无法找到一种包含该文件夹以进行jail-shell访问的方法？

也许这甚至不可能，但我很想知道。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:54:06.097

您可以将其他目录挂载在`/var/cpanel/jailshell-additional-mounts`

如果文件不存在，请创建它并将您想要允许的目录放入其中，每行一个目录名称：

```
/usr/local/libexec/git-core     
/usr/local/lib
... 
```

# git - 不推动/提交更改

> ID：14321747
> 
> 赞同：0
> 
> 时间：2013-01-14T15:47:55.160
> 
> 标签：git, github

我正在尝试推送/提交对存储库的更改，但在 Github 上，我不断收到错误消息：

```
Everything up-to-date 
```

即使我更新了存储库中的文件。我试过了：

```
git push

git push -f

git add "filename" 
```

但是这些命令似乎都没有更新存储库（当我在线查看时）。有谁知道为什么，或者对我可以使用什么有任何建议？

希望可以有人帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:56:26.653

首先

> 一切都是最新的

并不是真正的错误，它更像是一个一切正常的消息:)

git 的工作流程就像 - 假设你已经完成了`git init`：

1.  在本地仓库中添加/编辑文件
2.  `git add filename`警告 git 你添加了一些新文件
3.  然后`git commit -m filename`提交您的更改， -m 用于消息。git 会问你提交信息是什么。
4.  完成所有这些步骤后，您可以在推送之前进行多次提交，但是，完成后`git push origin`会将所有修改发送到服务器。

这是有关 git 工作流程的完整手册的[链接](http://www.git-scm.com/book)

# git - 为什么我不能将 git merge --squash 与 --no-ff 一起使用？

> ID：14321748
> 
> 赞同：32
> 
> 时间：2013-01-14T15:48:01.503
> 
> 标签：git, git-merge, squash

我正在尝试将 git merge --squash 与 --no-ff 参数一起使用，但 git 不允许。有人有什么建议可以帮助我吗？

我不能使用快进合并，我需要使用 --squash 参数对在另一个分支中进行的大量提交进行分组。

谢谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-01-14T16:02:09.447

它可能不会让你因为这样的命令没有意义。

文档`--squash`说（强调我的）：

> --squash
> 产生工作树和索引状态**，就像发生了真正的合并一样**（合并信息除外），**但实际上并不进行提交或移动 HEAD**，也不记录 GIT_DIR/MERGE_HEAD 以导致下一个 git commit 命令创建合并提交。这允许您在当前分支之上创建一个提交，其效果与合并另一个分支相同（或者在章鱼的情况下更多）。

该`--no-ff`标志可以：

> **即使合并解析为快进，也要**创建合并提交。****

 **您实际上是在要求 git 进行提交，而不是同时进行提交。

如果要保留分支的所有历史记录，则应使用该`--no-ff`标志。*提交 d 是一个合并提交，它有两个父节点 a 和 c。*

```
a ------ d -- ....
 \      /
  b -- c 
```

如果您希望将该分支上的所有提交视为单个工作单元，请使用`--squash`. *提交 d 是一个常规提交，包含来自提交 b 和 c 的所有更改，但只有一个父级 a。*

```
a ---- d -- ....
 \      
  b -- c 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-14T16:16:48.910

做什么`--squash`？- 它将所有提交压缩在一起，创建您的索引状态，以便您可以将分支中的所有更改作为单个提交提交。代码中的更改就像您合并了分支，但您的历史记录就像您进行了一次巨大的提交。

做什么`--no-ff`？- 它说，即使分支可以快进，也要将其视为合并并创建合并提交。

因此，`--squash`是关于在没有合并痕迹的情况下获取历史记录。`--no-ff`是关于通过合并强制历史记录，即使它正在被转发。因此，它们是互斥的，不能一起使用。

我认为这个问题源于对`fast-forward`. 这不是合并；它只是将一个分支直接从合并的分支转发到另一个提交，因为提交是直接在前一个分支的提交上进行的。没有快进会阻止这种行为并强制在顶部进行合并提交。当你在挤压时，如果你要求它不要快进也没关系。无论哪种方式都是一样的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-05-22T07:10:26.987

此答案与您的实际问题无关：

> 为什么我不能将 git merge --squash 与 --no-ff 一起使用？

因为已经正确回答了。

而是要明确您所追求的确实可以通过稍微不同的方法实现：您将首先对您的功能分支[进行 rebase 交互](https://git-scm.com/book/en/v2/Git-Tools-Rewriting-History)（例如压缩所有提交），然后您可以`git merge --no-ff`在 master 上创建分支。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-05-07T07:19:37.820

使用以下命令查看您的 GIT 配置：

```
git config --global -l
git config --local -l 
```

如果它包含`merge.ff=false`，将在您的`git squash`命令中假定 --no-ff 选项，从而导致上述问题。您可以使用以下命令从配置中删除此选项：

```
git config --global -unset merge.ff
git config --local -unset merge.ff 
```

或直接编辑您的 .gitconfig 文件。**

# symlink - 删除 Msys 上的符号链接

> ID：14321755
> 
> 赞同：2
> 
> 时间：2013-01-14T15:48:32.340
> 
> 标签：symlink, msys

我使用 msys 创建符号链接。现在我想删除它，但这是我得到的：

```
$ ln -s /mypath mylink
$ rm mylink
rm: cannot remove directory `mylink': Is a directory 
```

在 msys 上删除符号链接的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T05:19:22.893

MSys2 上的符号链接不是真正的符号链接，而是副本。所以你实际上可以使用`rm`：

```
rm
    -r, -R, --recursive   remove directories and their contents recursively 
```

例子：

```
rm -r mylink 
```

# function - Lua 表读取和匹配高效

> ID：14321756
> 
> 赞同：1
> 
> 时间：2013-01-14T15:48:32.963
> 
> 标签：function, lua, while-loop, lua-table, codea

我的问题很简单，我曾经这样做是为了检查我的任何线路（见图）是否撞到任何其他线路（或任何其他线路的轨迹）。但是我现在这样做的方式是做很多 if 语句，这是不好的。所以这是我使用的代码：

```
function Bumper:draw()
 for id,posx1 in pairs(tableposx1) do
    posy1 = tableposy1[id]
    posx2 = tableposx2[id]
    posy2 = tableposy2[id]
    posx3 = tableposx3[id]
    posy3 = tableposy3[id]
    posx4 = tableposx4[id]
    posy4 = tableposy4[id]
        if (posx1 ~= nil) and (posy1 ~= nil) and
        ((math.abs(xposplayer1 - posx1) < 5) and (math.abs(yposplayer1 - posy1) < 5))
        and (id < (count - 5) and killp1 == "false") then
            killp1 = "true"
            tint(255, 0, 0, 162)
            sprite("Dropbox:kill",xposplayer1,yposplayer1)
            noTint()
        end
        if (posx2 ~= nil) and (posy2 ~= nil) and
        ((math.abs(xposplayer1 - posx2) < 5) and (math.abs(yposplayer1 - posy2) < 5))
        and killp1 == "false" then
            killp1 = "true"
            tint(255, 0, 0, 162)
            sprite("Dropbox:kill",xposplayer1,yposplayer1)
            noTint()
        end
        if (posx3 ~= nil) and (posy3 ~= nil) and
        ((math.abs(xposplayer1 - posx3) < 5) and (math.abs(yposplayer1 - posy3) < 5))
        and killp1 == "false" then
            killp1 = "true"
            tint(255, 0, 0, 162)
            sprite("Dropbox:kill",xposplayer1,yposplayer1)
            noTint()
        end
        if (posx4 ~= nil) and (posy4 ~= nil) and
        ((math.abs(xposplayer1 - posx4) < 5) and (math.abs(yposplayer1 - posy4) < 5))
        and killp1 == "false" then
            killp1 = "true"
            tint(255, 0, 0, 162)
            sprite("Dropbox:kill",xposplayer1,yposplayer1)
            noTint()
        end
        if (posx1 ~= nil) and (posy1 ~= nil) and
        ((math.abs(xposplayer2 - posx1) < 5) and (math.abs(yposplayer2 - posy1) < 5))
        and killp2 == "false" then
            killp2 = "true"
            tint(0, 29, 255, 162)
            sprite("Dropbox:kill",xposplayer2,yposplayer2)
            noTint()
        end
        if (posx2 ~= nil) and (posy2 ~= nil) and
        ((math.abs(xposplayer2 - posx2) < 5) and (math.abs(yposplayer2 - posy2) < 5))
        and (id < (count - 5) and killp2 == "false")then
            killp2 = "true"
            tint(0, 29, 255, 162)
            sprite("Dropbox:kill",xposplayer2,yposplayer2)
            noTint()
        end
        if (posx3 ~= nil) and (posy3 ~= nil) and
        ((math.abs(xposplayer2 - posx3) < 5) and (math.abs(yposplayer2 - posy3) < 5))
        and killp2 == "false" then
            killp2 = "true"
            tint(0, 29, 255, 162)
            sprite("Dropbox:kill",xposplayer2,yposplayer2)
            noTint()
        end
        if (posx4 ~= nil) and (posy4 ~= nil) and
        ((math.abs(xposplayer2 - posx4) < 5) and (math.abs(yposplayer2 - posy4) < 5))
        and killp2 == "false" then
            killp2 = "true"
            tint(0, 29, 255, 162)
            sprite("Dropbox:kill",xposplayer2,yposplayer2)
            noTint()
        end
        if (posx1 ~= nil) and (posy1 ~= nil) and
        ((math.abs(xposplayer3 - posx1) < 5) and (math.abs(yposplayer3 - posy1) < 5))
        and killp3 == "false" then
            killp3 = "true"
            tint(1, 255, 0, 162)
            sprite("Dropbox:kill",xposplayer3,yposplayer3)
            noTint()
        end
        if (posx2 ~= nil) and (posy2 ~= nil) and
        ((math.abs(xposplayer3 - posx2) < 5) and (math.abs(yposplayer3 - posy2) < 5))
        and killp3 == "false" then
            killp3 = "true"
            tint(1, 255, 0, 162)
            sprite("Dropbox:kill",xposplayer3,yposplayer3)
            noTint()
        end
        if (posx3 ~= nil) and (posy3 ~= nil) and
        ((math.abs(xposplayer3 - posx3) < 5) and (math.abs(yposplayer3 - posy3) < 5))
        and (id < (count - 5) and killp3 == "false") then
            killp3 = "true"
            tint(1, 255, 0, 162)
            sprite("Dropbox:kill",xposplayer3,yposplayer3)
            noTint()
        end
        if (posx4 ~= nil) and (posy4 ~= nil) and
        ((math.abs(xposplayer3 - posx4) < 5) and (math.abs(yposplayer3 - posy4) < 5))
        and killp3 == "false" then
            killp3 = "true"
            tint(1, 255, 0, 162)
            sprite("Dropbox:kill",xposplayer3,yposplayer3)
            noTint()
        end
        if (posx1 ~= nil) and (posy1 ~= nil) and
        ((math.abs(xposplayer4 - posx1) < 5) and (math.abs(yposplayer4 - posy1) < 5))
        and killp4 == "false" then
            killp4 = "true"
            tint(255, 0, 229, 162)
            sprite("Dropbox:kill",xposplayer4,yposplayer4)
            noTint()
        end
        if (posx2 ~= nil) and (posy2 ~= nil) and
        ((math.abs(xposplayer4 - posx2) < 5) and (math.abs(yposplayer4 - posy2) < 5))
        and killp4 == "false" then
            killp4 = "true"
            tint(255, 0, 229, 162)
            sprite("Dropbox:kill",xposplayer4,yposplayer4)
            noTint()
        end
        if (posx3 ~= nil) and (posy3 ~= nil) and
        ((math.abs(xposplayer4 - posx3) < 5) and (math.abs(yposplayer4 - posy3) < 5))
        and killp4 == "false" then
            killp4 = "true"
            tint(255, 0, 229, 162)
            sprite("Dropbox:kill",xposplayer4,yposplayer4)
            noTint()
        end
        if (posx4 ~= nil) and (posy4 ~= nil) and
        ((math.abs(xposplayer4 - posx4) < 5) and (math.abs(yposplayer4 - posy4) < 5))
        and id < (count - 5) and killp4 == "false" then
            killp4 = "true"
            tint(255, 0, 229, 162)
            sprite("Dropbox:kill",xposplayer4,yposplayer4)
            noTint()
        end
end

end 
```

这是我的初始化：

```
 -- Main
a = 1
gameover = 0
tx = 0
paused = 1
count = 0
stagecount = 0
player1count = 0
player2count = 0
player3count = 0
player4count = 0
-- Random hole times
thistime1 = 0
thistime2 = 0
thistime3 = 0
thistime4 = 0
-- Dead players
killp1 = "false"
killp2 = "false"
killp3 = "false"
killp4 = "false"
kills = 0
-- Touch control
touches = {}
-- Player direction
pi = math.pi
o5pi = 50 * pi
mo5pi = - (50 * pi)
minpi = - (100*pi)
    -- Random start direction
    r1t = math.random(0,o5pi)
    r2t = math.random(mo5pi,0)
    r3t = math.random(minpi,mo5pi)
    r4t = math.random(o5pi,100*pi)
r1 = r1t / 100
r2 = r2t / 100
r3 = r3t / 100
r4 = r4t / 100
deltar1 = pi / 55
deltar2 = pi / 55
deltar3 = pi / 55
deltar4 = pi / 55
-- Player speed
speed1 = 2.5
speed2 = 2.5
speed3 = 2.5
speed4 = 2.5
-- Player random start position
xposplayer1 = math.random(123,300)
yposplayer1 = math.random(123,300)
xposplayer2 = math.random(123,300)
yposplayer2 = math.random(468,645)
xposplayer3 = math.random(724,901)
yposplayer3 = math.random(468,645)
xposplayer4 = math.random(724,901)
yposplayer4 = math.random(123,300)
-- Player coordinate tables
tableposx1 = {}
tableposy1 = {}
tableposx2 = {}
tableposy2 = {}
tableposx3 = {}
tableposy3 = {}
tableposx4 = {}
tableposy4 = {} 
```

现在我尝试执行以下操作，但失败了，因为我现在不知道如何使用变量变量名：

```
for id,posx[a] in pairs(tableposx[a]) do
    posy[a] = tableposy[a][id]
        if ((posx[a] ~= nil) and (posy[a] ~= nil))
        and (math.abs(xposplayer[a] - posx[a]) < 5)
        and (math.abs(yposplayer[a] - posy[a]) < 5)
        and (id < (count - 5)) 
        and (killp[a] == "false") 
        then
            killp[a] = "true"
            tintp[a]
            sprite("Dropbox:kill",xposplayer[a],yposplayer[a])
            noTint()
        end
   end
a = a + 1
if a = 4 then
    a = 1
end 
```

-- 编辑：我使用的是 4 次，4 名玩家！

```
function Player:draw1()
    fill(255, 0, 11, 255)
    xposplayer1 = xposplayer1 + speed1 * math.cos(r1)
    yposplayer1 = yposplayer1 + speed1 * math.sin(r1)
    if player1count == 0 then 
        thistime1 = math.random(200,500)
    end
    player1count = player1count + 1
if player1count < thistime1 then
    table.insert(tableposx1,count,xposplayer1)
    table.insert(tableposy1,count,yposplayer1)
    tint(255, 0, 0, 162)
    ellipse(xposplayer1,yposplayer1,10,10)
    noTint()
elseif player1count > thistime1 then
    tint(255, 0, 0, 162)
    ellipse(xposplayer1,yposplayer1,5,5)
    noTint()
    if player1count > thistime1 + 20 then
        player1count = 0
    end
end 
```

结尾

- 编辑

我应该如何正确地做到这一点？提前致谢！

图片：![在此处输入图像描述](../Images/396a564853a4dc857bf38bc89ae516d1.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T16:07:09.867

您可能并不像您所说的那样真的想要*变量变量名*，但是您可以做到...

所有全局变量都可以通过名为的表访问`_G`，您可以通过执行以下操作访问全局变量：

```
_G['killp1']
_G['killp2']
-- etc 
```

然后，您可以像往常一样使用字符串操作。

```
local i = 1
_G['killp' .. tostring(i)] -- same as _G['killp1']
i = i + 1
_G['killp' .. tostring(i)] -- same as _G['killp2'] 
```

但这会变得非常混乱，很快。您可能想要做的是[开始使用 objects](http://www.lua.org/pil/16.html)。你的反对可能看起来像这样：

```
Linething = { x = 0, y = 0, dead = false, speed = 2.5 }

function Linething:new(o)
  o = o or {}
  setmetatable(o, self)
  self.__index = self
  return o
end

function Linething:checkCollision(other)
  if self.x - other.x < 5 and self.y - other.y < 5 then
    self.dead = true
    -- other stuff
  end
end

function Linething:update(delta_t)
   -- update the game logic
   self.x = self.x + self.speed * cos(self.angle) * delta_t
   self.y = self.y + self.speed * sin(self.angle) * delta_t
end

function Linething:draw()
  -- do line drawing here
  tint(255, 0, 0, 162)
  ellipse(self.x, self.y, 10, 10)
  noTint()
  -- etc
end

-- in main:
linething1 = Linething:new()
linething2 = Linething:new()
linething1.checkCollision(linething2) 
```

* * *

编辑：通常您希望[将游戏逻辑与渲染分离](http://en.wikipedia.org/wiki/Game_programming#Game_structure)。大多数游戏都有一个如下所示的循环：

```
function main_loop()
  while true do
    delta_t = get_change_in_time()
    update_all(delta_t)
    draw_all()
  end
end

-- where update_all is something like this:
function update_all(delta_t)
  player1:update(delta_t)
  player2:update(delta_t)
  -- things in a table:
  for _, x in pairs(table_of_x) do
    x:update(delta_t)
  end
end

-- and draw all is basically the same
function draw_all()
  player1:draw()
  player2:draw()
  -- things in a table:
  for _, x in pairs(table_of_x) do
    x:draw()
  end
end 
```

看起来你的`Player`对象[有一个](http://en.wikipedia.org/wiki/Has-a) `Linething`对象。因此，您可能希望将`Linething`对象添加到`Player`对象并更改`Player:draw()`为 call `players_linething:draw()`。然后你可以有 4 个`Player`对象，每个对象都有一个`Linething`对象。那有意义吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T19:19:09.867

问题是您使用的是带下标的变量（player1、player2 等）而不是数组（player[1]、player[2] 等），这使得无法在循环中迭代它们。

您还应该将相关项目组合在一起。而不是玩家 1 由一堆全局变量表示：

```
player1count = 0
speed1 = 2.5 
```

这些东西应该组织成一个表格：

```
player1.count = 0
speed1.speed = 2.5 
```

而且，如前所述，任何时候你有一堆随下标变化的变量，你应该使用一个数组（或者更一般地，某种可迭代的列表类型，在 Lua 中恰好是一个表/数组）：

```
players = {}

-- initialize players
for i=1,NUM_PLAYERS do
    players[i] = {
        count = 0,
        speed = 2.5
    }
end 
```

如果你把它普遍应用到你的程序中，你的巨大`if`语句将自然消失，被一个相对较小的嵌套 for 循环所取代。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T16:07:58.477

除了您的最后一个片段，我还没有阅读所有内容：

*   你不能这样做，因为循环`for id,posx[a]`分配的变量是本地的。`for`要修复它，请用局部变量名称替换实例，`posx[a]`例如`posx_a`.

*   这里有一个错字：（`if a = 4 then`你的意思是`==`）。

*   这条线没有任何意义：`tintp[a]`.

# php - 自定义蛞蝓 Magento

> ID：14321761
> 
> 赞同：1
> 
> 时间：2013-01-14T15:48:44.600
> 
> 标签：php, magento, routes, magento-1.7, router

我在为我的博客模块创建自定义路由时遇到了一些麻烦（我正在这样做以更好地学习 Magento）。

到目前为止我所做的：创建了一个自定义表，其中还包含所需的 slug。在我的 config.xml 中添加了以下内容

```
<default>
    <web> <!-- what does this represent??? -->
        <routers>
            <namespace_blog_list>
                <area>frontend</area>
                <class>Namespace_Blog_Controller_Router</class>
            </namespace_blog_list>
        </routers>
    </web>
</default> 
```

所以，我创建了`Namespace_Blog_Controller_Router`类，并从 CMS 控制器复制了`match()`方法，但不太确定如何修改它。

这是我到目前为止所拥有的：

```
// $identifier is 'blog/view/my-slug-name';
$parts = explode('/', $identifier);
    if ($parts[0] == 'blog') {
        $post = Mage::getModel('namespace_blog/post');
        $routeInformation = $post->checkIdentifier($identifier);

        $request->setModuleName('namespace_blog')
            ->setControllerName($routeInformation['controller'])
            ->setActionName($routeInformation['action']);

        if (isset($routeInformation['params']) && count($routeInformation['params'])) {
            foreach ($routeInformation['params'] as $key => $param) {
                $request->setParam($key, $param);
            }
        }

        $request->setAlias(
            Mage_Core_Model_Url_Rewrite::REWRITE_REQUEST_PATH_ALIAS,
            $identifier
        );
        return true;
    } 
```

PS：$post->checkIdentifier 返回以下数组：

```
array(
    'controller' => 'index',
    'action' => 'index',
    'params' => array(
        'id' => 3
    )
) 
```

问题是它进入了一个无限循环，我发现了以下报告：

```
a:5:{i:0;s:52:"Front controller reached 100 router match iterations";i:1;s:337:"#0 /var/www/app/code/core/Mage/Core/Controller/Varien/Front.php(183): Mage::throwException('Front controlle...')
#1 /var/www/app/code/core/Mage/Core/Model/App.php(354): Mage_Core_Controller_Varien_Front->dispatch()
#2 /var/www/app/Mage.php(683): Mage_Core_Model_App->run(Array)
#3 /var/www/index.php(87): Mage::run('', 'store')
#4 {main}";s:3:"url";s:21:"/index.php/blog/index";s:11:"script_name";s:10:"/index.php";s:4:"skin";s:7:"default";}` 
```

有任何想法吗？这是最好的方法，还是有其他推荐的解决方案？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T16:42:03.250

CMS 页面路由是在 controller_front_init_routers 事件的帮助下添加的。

首先你需要为你的模块定义标准的前端路由

```
<config>
    <frontend>
        <routers>
            <mymodule>
                <use>standard</use>
                <args>
                    <module>My_Module</module>
                    <frontName>mymodule</frontName>
                </args>
            </mymodule>
        </routers>
    </frontend>
</config> 
```

这允许您以[http://example.com/mymodule/controller/action/的形式发送请求](http://example.com/mymodule/controller/action/)

看完这个`Mage_Core_Controller_Varien_Front::init()`。在此方法中，magento 收集`standard`和`admin`路由（这些是前端和管理路由的默认设置）。当这些路由器添加 mageto 触发事件`controller_front_init_routers`并使用此全局事件时，您可以注册自己的路由：

```
<config>
    <global>
        <events>
            <controller_front_init_routers>
                <observers>
                    <mymodule>
                        <class>My_Module_Controller_Router</class>
                        <method>initControllerRouters</method>
                    </mymodule>
                </observers>
            </controller_front_init_routers>
        </events>
    </global>
</config> 
```

在路线中，您应该检查标识符是否符合您的需求并致电您的控制器

```
class My_Module_Controller_Router extends Mage_Core_Controller_Varien_Router_Abstract
{

    /**
     * Inject new route into the list of routes
     *
     * @param Varien_Event_Observer $observer
     */
    public function initControllerRouters($observer)
    {
        $front = $observer->getEvent()->getFront();

        $route = new My_Module_Controller_Router();
        $front->addRouter('myroute', $route);
    }

    /**
     * Compare current path with the route rules
     *
     * @param Zend_Controller_Request_Http $request
     * @return boolean
     */
    public function match(Zend_Controller_Request_Http $request)
    {

        if (!Mage::app()->isInstalled()) {
            Mage::app()->getFrontController()->getResponse()
                    ->setRedirect(Mage::getUrl('install'))
                    ->sendResponse();
            return FALSE;
        }

        $route = 'myroute';

        $identifier = $request->getPathInfo();

        if (substr(str_replace("/", "", $identifier), 0, strlen($route)) == $route) {
            if (str_replace("/", "", $identifier) == $route) {
                $request->setModuleName('mymodule')
                        ->setControllerName('index')
                        ->setActionName('index');
                return TRUE;
            }

            $suffix = Mage::helper('catalog/product')->getProductUrlSuffix();
            $identifier = substr_replace($request->getPathInfo(), '', 0, strlen("/" . $route . "/"));
            $identifier = str_replace($suffix, '', $identifier);

            // here we make some check to make sure we have requested page
            $mymodule = Mage::getModel('mymodule/mymodule');
            $module_id = $mymodule->checkIdentifier($identifier, Mage::app()->getStore()->getId());
            if (!$module_id) {
                return FALSE;
            }

            // send request to the module's controller
            $request->setModuleName('mymodule')
                    ->setControllerName('index')
                    ->setActionName('view')
                    ->setParam('id', $module_id);

            return TRUE;
        } else {
            return FALSE;
        }
    }

} 
```

就这样。

```
<default>
    <web>
        <default>
            <cms_home_page>home</cms_home_page>
            <cms_no_route>no-route</cms_no_route>
            <cms_no_cookies>enable-cookies</cms_no_cookies>
            <front>cms</front>
            <no_route>cms/index/noRoute</no_route>
            <show_cms_breadcrumbs>1</show_cms_breadcrumbs>
        </default>
    </web>
</default> 
```

这是 cms 模块的默认部分。您可以在系统 - 配置 - Web - 默认页面下的管理员中找到这些设置

# gmaps4rails - 如何使用 gmaps4rails 自定义集群图标

> ID：14321762
> 
> 赞同：0
> 
> 时间：2013-01-14T15:48:44.330
> 
> 标签：gmaps4rails

因此，我们正在尝试使用 gmaps for rails 更改默认集群图标。在[维基](https://github.com/apneadiving/Google-Maps-for-Rails/wiki/Markers) 它说

```
You can customize the pics used by the clusterer by setting the Gmaps.map.customClusterer js function in your code. 
```

我们应该把那个函数放在哪里？它说“在 javascript 中” - 但在哪里？我们是否直接编辑 gmaps4rails 生成的代码？gmaps4rails 如何获取信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-23T13:21:19.787

要进行此自定义，您只需要创建 js 文件。然后，您可以在 Application.js 中“要求”该 js 文件，或者直接在您的视图文件中引用。就是这样，你不需要做任何其他事情。我用过它，它对我有用。如果有任何问题请告诉我。

要了解它是如何工作的，您可以参考

```
gmaps4rails.base.js (see  @customClusterer = -> false) 
gmaps4rails.googlemaps.js (method - createClusterer) 
```

很容易理解

# web-analytics - Omniture SiteCatalyst 实例/搜索指标和转化变量

> ID：14321764
> 
> 赞同：0
> 
> 时间：2013-01-14T15:49:02.353
> 
> 标签：web-analytics, adobe-analytics

我们在 Omniture 的 SiteCatalyst 中的两个报告套件之间存在奇怪的报告不一致。目前，我们有一个转换变量，它使用 crossVisitParticipation 和 channelManager 插件跟踪来自搜索引擎的关键字值。

当我们运行显示按转化变量细分的“搜索关键字 - 全部”的“流量来源”报告时，一个报告始终显示“N/A”值，而另一个则不显示。不知何故，一个报告套件与搜索引擎不相关报告给我的转换变量，另一个是。知道为什么吗？

以下是一些截图：

使用“N/A”链接报告[http://i48.tinypic.com/1zwi4b9.png](http://i48.tinypic.com/1zwi4b9.png) [![截图 1](../Images/45ac0bdd57d2f577c498f8b1efa69931.png)](https://i.stack.imgur.com/rnlfj.png)

带有实际值链接的报告[http://i46.tinypic.com/egbnmh.png](http://i46.tinypic.com/egbnmh.png) [![截图 2](../Images/8b64e9a4b20512bec88dbde074be9c5f.png)](https://i.stack.imgur.com/GzJtA.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T17:13:05.360

我以前也见过这个。我真的建议您致电 Omniture 客户服务中心。SiteCatalyst 中的很多东西都可以通过 Omniture 进行配置，我相信您的设置就是这样配置的，以便在您的报告中提供这种结果。

# c++ - protobuf c++ 还依赖哪些其他库来编译运行时？

> ID：14321766
> 
> 赞同：2
> 
> 时间：2013-01-14T15:49:15.310
> 
> 标签：c++, dependencies, shared-libraries, protocol-buffers

我只是快速浏览了协议缓冲区的文档和 C++ 源代码，但我找不到构建 protobuf 运行时的任何库要求——无论是作为共享库还是静态库。

有谁知道要求是什么？

*（我怀疑它只依赖于 C++ 和 STL）*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T16:02:41.357

> *（我怀疑它只依赖于 C++ 和 STL）*

AFAIK 你怀疑是对的，没有任何进一步的依赖关系。

**更新：**
我再次检查了文档，找不到任何提及其他库需要链接由 protoc 编译器生成的代码（我很确定他们会提到这一点）。

我们在运行非标准操作系统（实际上是 FreeRTOS）的嵌入式系统上使用 protobuf，我不记得缺少集成它所必需的额外内容的任何困难。GCC 4.6 (arm-none-eabi) 用作交叉工具链。

# jquery - 使用 jQuery 的 IE7 动态 HTML 渲染

> ID：14321767
> 
> 赞同：0
> 
> 时间：2013-01-14T15:49:16.623
> 
> 标签：jquery, html, dynamic, user-interface

我正在尝试使用 jQuery 动态呈现页面。基本上，在页面加载时，我有一堆 JSON 数据，我正在基于它创建页面的内容。

这适用于几乎所有浏览器，除了带有 IE7 标准视图的 IE9。

由于它是一个拥有许多不同用户的网站，我想确保这也适用于该版本。你知道我是否可以做任何“调整”来提高与 IE7 的兼容性并使用 jQuery 动态呈现？

谢谢。

注意

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T09:41:56.573

我已经解决了这个问题。构建表格时，JavaScript 出现错误。除此之外，如果我在一个 div 中设置了“display:none”，在单击按钮后将使用 JS 将其修改为“display:block”，则 IE9 与 IE7 标准不允许我显示它。我必须找到另一种方法，但我想我会在文档最终加载后使用 JS 修改 div 的显示，并且所有 div 都已经到位。

尽管如此，还是感谢您的评论。

# c - 需要轻量级 HTTP 流解决方案？

> ID：14321768
> 
> 赞同：1
> 
> 时间：2013-01-14T15:49:25.160
> 
> 标签：c, iframe, webserver, embedded, comet

我正在为嵌入式系统开发一个基于 Web 的后端，我们已经在该系统上实现了服务器获取请求的代码（全部内置在 c 中）。我需要一个轻量级的解决方案来流式传输一组数据值，以填充使用 canvas 标签构建的图形。我正在研究彗星模式和潜在的 iframe 解决方案。

但是我不确定如何在没有完整的 Web 服务器运行的情况下实现这一点？我对网络技术相当陌生，任何帮助或指出我的方向将不胜感激！

谢谢马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T22:41:08.320

正如[@Joe](https://stackoverflow.com/users/1109725/joe)在评论中建议的那样，看看网络套接字。这里有一些有用的链接可以帮助您入门。

[网络套接字 101](http://lucumr.pocoo.org/2012/9/24/websockets-101/)

[socket.io](http://socket.io/)，客户端和服务器实现

[libwebsockets – C 语言中的 HTML5 Websocket 服务器库](http://warmcat.com/_wp/2010/11/01/libwebsockets-html5-websocket-server-library-in-c/)

[Websocket 测试套件](http://autobahn.ws/testsuite)

# android - Android嵌套片段问题“java.lang.IllegalStateException：活动已被破坏”

> ID：14321771
> 
> 赞同：9
> 
> 时间：2013-01-14T15:49:31.057
> 
> 标签：android, android-fragments

您可能知道 Android 支持嵌套片段，也通过 API 级别 17 的支持库。所以基本上我正在尝试将嵌套片段添加到 ViewPager 的片段之一并熟悉这个新的好功能。

在第一个应用程序启动时一切都按预期工作，即我可以添加子片段、浏览这些片段、处理返回堆栈等。

但问题是，当我通过单击后退按钮离开应用程序并重新启动应用程序时，大多数时候我都会遇到以下异常，但并非总是如此：

```
java.lang.IllegalStateException: Activity has been destroyed
    at android.support.v4.app.FragmentManagerImpl.enqueueAction(FragmentManager.java:1342)
    at android.support.v4.app.BackStackRecord.commitInternal(BackStackRecord.java:595)
    at android.support.v4.app.BackStackRecord.commit(BackStackRecord.java:574)
    at com.cnlms.andnestedfragments.ui.fragments.FragWrapper.addChildFragment(FragWrapper.java:145)
    at com.cnlms.andnestedfragments.ui.fragments.FragWrapper.onActivityCreated(FragWrapper.java:96)
    at android.support.v4.app.Fragment.performActivityCreated(Fragment.java:1468)
    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:931)
    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1088)
    at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:682)
    at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1444)
    at android.support.v4.app.FragmentManagerImpl.executePendingTransactions(FragmentManager.java:461)
    at android.support.v4.app.FragmentStatePagerAdapter.finishUpdate(FragmentStatePagerAdapter.java:163)
    at android.support.v4.view.ViewPager.populate(ViewPager.java:1012)
    at android.support.v4.view.ViewPager.populate(ViewPager.java:881)
    at android.support.v4.view.ViewPager.onMeasure(ViewPager.java:1366)
    at android.view.View.measure(View.java:15172)
    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4814)
    at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
    at android.view.View.measure(View.java:15172)
    at android.widget.LinearLayout.measureVertical(LinearLayout.java:833)
    at android.widget.LinearLayout.onMeasure(LinearLayout.java:574)
    at android.view.View.measure(View.java:15172)
    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4814)
    at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
    at com.android.internal.policy.impl.PhoneWindow$DecorView.onMeasure(PhoneWindow.java:2148)
    at android.view.View.measure(View.java:15172)
    at android.view.ViewRootImpl.performMeasure(ViewRootImpl.java:1848)
    at android.view.ViewRootImpl.measureHierarchy(ViewRootImpl.java:1100)
    at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1273)
    at android.view.ViewRootImpl.doTraversal(ViewRootImpl.java:998)
    at android.view.ViewRootImpl$TraversalRunnable.run(ViewRootImpl.java:4212)
    at android.view.Choreographer$CallbackRecord.run(Choreographer.java:725)
    at android.view.Choreographer.doCallbacks(Choreographer.java:555)
    at android.view.Choreographer.doFrame(Choreographer.java:525)
    at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:711)
    at android.os.Handler.handleCallback(Handler.java:615)
    at android.os.Handler.dispatchMessage(Handler.java:92)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:4745)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
    at dalvik.system.NativeStart.main(Native Method) 
```

整个项目可[在此处](https://github.com/cnlms/AndroidNestedFragments)获得。

活动在某些时候可以为空吗？我的意思是当我调用 getChildFragmentManager() 时，不应该将活动附加到片段管理器吗？任何建议将不胜感激。

有关应用程序的更多详细信息，

ViewPager 托管两个片段实例：FragRegular 和 FragWrapper。第一个只是一个简单的无用片段；第二个，FragWrapper，充当父片段，即子片段的容器。下面是 FragWrapper 的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">

    <!--
        Adds nested child fragments when clicked
    -->
    <Button
        android:id="@+id/btn_go_deep"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:text="Go Nesty!"/>

    <!--
        Nested Fragment Container
    -->
    <FrameLayout
        android:id="@+id/frag_container"
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="match_parent"
        android:layout_above="@id/btn_go_deep"/>

</RelativeLayout> 
```

所以基本上第一个子片段是在 FragWrapper 的 onActivityCreated() 回调方法中添加到 FragWrapper 中的，随后的子片段是在运行时添加的，通过按钮单击触发。下面是 FragWrapper 类的样子：

```
public final class FragWrapper extends BaseFragment {
    /**
     *
     *  The Wrapper Fragment that hosts nested child fragments.
     *
     *  First child fragment is added in onActivityCreated() callback
     *
     *  More child fragments can be added at runtime by clicking 'Go Nesty!'
     *  button.
     *
    */

    /**
     *  Holds back stacked fragment tags
     */
    private Stack<String> backStack;

    /**
     *  Child Fragment Manager
     */
    private FragmentManager fm;

    /**
     *  Fragment Tags
     */
    private int fragCount = 1;

    private static FragWrapper instance;

    public static FragWrapper getInstance() {

        if (instance == null) {

            instance = new FragWrapper();

        }

        return instance;

    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

        View view = inflater.inflate(R.layout.frag_wrapper, container, false);

        view.findViewById(R.id.btn_go_deep).setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {

                /**
                 *  Adds nested child fragments
                 */
                fragCount+=1;

                addChildFragment(
                        FragChild.newInstance(fragCount),
                        String.valueOf(fragCount),
                        true
                );
            }

        });

        return view;
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {

        super.onActivityCreated(savedInstanceState);

        /**
         *  Add Initial Fragment
         */
        addChildFragment(
                FragChild.newInstance(fragCount),
                String.valueOf(fragCount),
                false
        );

    }

    private void addChildFragment(final Fragment fragment, final String fragmentTag, final boolean addToBackStack) {

        /**
         *  initialize child fragment manager
         */
        if (fm == null) fm = getChildFragmentManager();

        /**
          *  Starts a new transaction
         */
        FragmentTransaction ft = fm.beginTransaction();

        /** 
         *  Hide lastly added fragment
         */
        if (backStack != null  && !backStack.isEmpty()) {

            ft.hide(fm.findFragmentByTag(backStack.peek()));

        }

        /** 
         *  Add new fragment
         */
        ft.add(R.id.frag_container, fragment, fragmentTag );

        /**
         *  Add to back stack
         */
         if (addToBackStack) {

            ft.addToBackStack(null);

        }

         /**
         *  Commit transaction
         */
        ft.commit();

        /**
         * Save fragment tag
         */
        if (backStack == null) backStack = new Stack<String>();

            backStack.push(fragmentTag);

    }

    public boolean popFragment() {

        /**
         *  Allow this fragment to consume the back button click
        */
        if (backStack != null   && !backStack.isEmpty()) {

            backStack.pop();

            fragCount-=1;

        }

        return fm != null && fm.popBackStackImmediate();

    }

    @Override
    public boolean backPressed() {

        return popFragment();

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-04T13:04:47.223

有人发布了另一个类似的问题，问题是由于 ChildFragmentManager 中的错误。基本上，子 FragmentManager 在与活动分离时最终会出现内部状态损坏。[在这里](https://stackoverflow.com/a/15656428/795245)查看原始答案

# mysql - 来自备份脚本的错误查询导致错误 1064

> ID：14321772
> 
> 赞同：0
> 
> 时间：2013-01-14T15:49:34.093
> 
> 标签：mysql, sql

以下代码是备份脚本（可能使用`mysqldump`）生成的较大查询的最小示例。它导致错误，我不知道为什么。谁能帮忙？

```
CREATE TABLE `tl_custom_tandem_lang` (
    `id` varchar(2) COLLATE latin1_german2_ci NOT NULL,
    PRIMARY_KEY (`id`),
    UNIQUE KEY `id` (`id`)
); 
```

产生以下错误：

> ERROR 1064 (42000)：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 3 行的 '( `id`), UNIQUE KEY `id`( `id`) )'附近使用正确的语法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:55:59.770

`PRIMARY KEY`它不应该`PRIMARY_KEY`（*删除下划线使其工作。*）

```
CREATE TABLE `tl_custom_tandem_lang` 
(
    `id` varchar(2) COLLATE latin1_german2_ci NOT NULL,
    PRIMARY KEY (`id`),
    UNIQUE KEY `tb_unique` (`id`)
); 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/4be55)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:52:25.547

像这样删除 UNIQUE KEY 之后的“id”：

```
CREATE TABLE `tl_custom_tandem_lang` (
    `id` varchar(2) COLLATE latin1_german2_ci NOT NULL,
    PRIMARY_KEY (`id`),
    UNIQUE KEY (`id`)
); 
```

# javascript - this.is(":checked") 不工作

> ID：14321782
> 
> 赞同：0
> 
> 时间：2013-01-14T15:49:58.033
> 
> 标签：javascript, jquery

我正在使用以下代码循环浏览表单中的所有复选框。这些框是从 php 脚本动态生成的，所以我不知道复选框的名称或数量。

我需要找出哪些复选框已被勾选，所以我只将这些复选框传递给处理表单的 php 脚本。

```
 $("#panelform input:checkbox").each(function () {
    if(this.is(":checked")){
    fields = fields+"&"+this.name+"="+this.value;
}
}); 
```

当脚本到达 this.is(":checked") 时，它会出错，但是作为 jquery，我的控制台不会向我显示任何错误消息，只会停止。

如果我在第一行之后发出警报或 console.log “this”，我会得到表单字段，所以我知道这很有效。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T15:51:30.430

尝试

```
 if($(this).is(":checked")){ 
```

因为`this`只是对 DOM 中节点的引用（您需要改为使用`jQuery`包装器来链接方法`is()`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T15:52:18.810

试试这个：

```
if( this.checked) 
```

`this`是普通的 DOM 节点，`checked`它的属性告诉你它是否被选中。创建一个全新的 jQuery 对象只是为了查看是否设置了属性是多余的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-14T15:52:33.177

在这种情况下，`this`指的是 DOM 元素，而不是 jQuery 对象——而且 DOM 元素没有方法`is()`。如果要使用 is 方法，可以将其包装在 jQuery 对象中：

```
if($(this).is(":checked")){ 
```

或使用 DOM 元素的`checked`属性：

```
if(this.checked){ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-14T15:53:26.550

```
$(this).is(':checked') 
```

如果你想序列化你的表单试试这个

```
$('your-form-selector').serializeArray() 
```

# jquery - 检测 $(document).ready() 上的 Chrome 扩展

> ID：14321783
> 
> 赞同：1
> 
> 时间：2013-01-14T15:50:00.217
> 
> 标签：jquery, google-chrome, document-ready

在我的网站中，我想检测是否安装了我的 chrome-extension。通常人们会使用自定义脚本来创建一些

```
<div id="extensionExists"></div>. 
```

但是，我想在网站 javascript 运行之前检测扩展。因为我不想等待图像完全加载，所以我使用 document.ready() 而不是 window.onload()。但是，我没有事先创建一个 div。如果我的内容脚本使用 run_at:"document start"，我还不能创建 div，如果我使用"document end"，那就太晚了，document.ready() 已经运行了。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:26:08.530

嗯......据我所知，没有干净的解决方案。我唯一的想法是在文档完全加载之前使用[MutationObserver](https://developer.mozilla.org/en-US/docs/DOM/MutationObserver)来访问它，但我现在没有时间正确测试它......

```
var obs = new WebKitMutationObserver(function ( mutations ) {
  console.log( mutations );
  mutations.forEach(function ( mutation ) {
    var newNodes = mutation.addedNodes;
    console.log( newNodes );
    // newNodes should now contain a NodeList which contains all nodes that were created right now
    // you should be able to create your element now
    // consider using obs.disconnect(); after you have found your entry point.
  });
});

obs.observe( document, { childList: true } ); 
```

不保证它会做任何事情。jsFiddle 不允许在文档之前添加脚本，所以我什至无法在那里测试它。

# javascript - 如何防止损失悬停在拉斐尔？

> ID：14321786
> 
> 赞同：1
> 
> 时间：2013-01-14T15:50:03.417
> 
> 标签：javascript, jquery, raphael

当我使用`Raphael`库来绘制一些项目时，我正在开发一些页面。

[我的应用](http://jsbin.com/irujit/1/edit)

所以我的**问题**是，当我移动到一些`rect`它长大时，但是当我的鼠标在定位在我的文本上时`rect`，它失去了他的悬停。您可以在我的应用示例中看到它。

```
var paper = new Raphael(document.getElementById('holder'), 500, object.length * 100);
drawLine(paper, aType.length, bType.length, cType.length, cellSize, padding);

process = function(i,label)
{ 
    txt = paper.text(390,((i+1)* cellSize) - 10,label.devRepo)
        .attr({ stroke: "none", opacity: 0, "font-size": 20});
    var a = paper.rect(200, ((i+1)* cellSize) - 25, rectWidth, rectHeight)
        .hover(function()
        {  
            this.animate({ transform : "s2"}, 1000, "elastic");
            this.prev.animate({opacity: 1}, 500, "elastic");
            this.next.attr({"font-size" : 30});
        }, 
        function()
        {       
            this.animate({ transform : "s1" }, 1000, "elastic");
            this.prev.animate({opacity: 0}, 500);
            this.next.attr({"font-size" : 15});
        });
} 
```

我已经尝试过`e.preventDefault();`悬停`this.next`和其他一些解决方案，但它不起作用。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T16:55:43.780

大多数人会建议您在框和标签上放置一个透明矩形，然后将悬停功能附加到该矩形上。（如果有记忆，您必须将不透明度设置为 0.01 而不是 0 以防止对象丢失其附加事件。）这很好用，但我不喜欢这个解决方案；它感觉很hacky并且用不必要的对象使页面混乱。

相反，我建议这样做：从悬停中删除第二个功能，使其在功能上仅作为鼠标悬停功能。在绘制任何矩形和标签之前，先制作一个与纸张大小相同的矩形“垫子”。然后，将最小化标签的功能附加到垫子上作为鼠标悬停。换句话说，您正在将触发器从*开箱*即用鼠标更改为鼠标*悬停*在其外部区域上。

我在垫子上留下了一点不透明度和颜色，以确保它正常工作。您可以将颜色更改为背景颜色。

```
 var mat = paper.rect(0, 0, paper.width, paper.height).attr({fill: "#F00", opacity: 0.1}); 
```

现在，您想为所有矩形创建一个容器，以便您可以遍历它们以查看哪些需要最小化。我制作了一个名为“矩形”的对象，其中包含我们关注的对象。然后：

```
 mat.mouseover(function () {
    for (var c = 0; c < rectangles.length; c += 1) {
      //some measure to tell if rectangle is presently expanded
      if (rectangles[c].next.attr("font-size")) {
        rectangles[c].animate({                  
              transform : "s1"
            }, 1000, "elastic");
        rectangles[c].prev.animate({opacity: 0}, 500);
        rectangles[c].next.attr({"font-size" : 15});                  
      }
    }
  }); 
```

然后我刚刚从各个矩形中删除了 mouseout 功能。

[jsBin](http://jsbin.com/irujit/3/edit)

需要明确的是，这会有一些缺点：如果人们用鼠标移动的速度非常快，他们可以同时扩展几个矩形。一旦鼠标接触垫子，这种情况就会得到纠正。我认为功能看起来很不错。但隐形垫始终是一种选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T21:19:00.327

我为 Raphael 写了一个小扩展 - 称为`hoverInBounds`- 解决了这个限制。

演示：http: [//jsfiddle.net/amustill/Bh276/1](http://jsfiddle.net/amustill/Bh276/1)

```
Raphael.el.hoverInBounds = function(inFunc, outFunc) {
    var inBounds = false;

    // Mouseover function. Only execute if `inBounds` is false.
    this.mouseover(function() {
        if (!inBounds) {
            inBounds = true;
            inFunc.call(this);
        }
    });

    // Mouseout function
    this.mouseout(function(e) {
        var x = e.offsetX || e.clientX,
            y = e.offsetY || e.clientY;

        // Return `false` if we're still inside the element's bounds
        if (this.isPointInside(x, y)) return false;

        inBounds = false;
        outFunc.call(this);
    });

    return this;
} 
```

# arm - ARM交叉编译介绍？

> ID：14321795
> 
> 赞同：0
> 
> 时间：2013-01-14T15:50:31.707
> 
> 标签：arm, cross-compiling, embedded-linux

我正在尝试编译一个程序以在具有 ARM926EJ-S 处理器的 Linux 驱动板上运行。所以我安装了 Debian 嵌入式交叉开发工具链，并尝试在 gcc 中使用 -march=armv5te 编译 Hello World。当我尝试在板上运行二进制文件时，它因找不到文件错误而崩溃（由于库版本），之后我尝试使用 -static 标志进行编译，但出现了 seg 错误（__libc_start_main () 中的 0x0000827c，gdb 先生说通过 gdbserver)。

关于如何在这里运行以使某些东西运行的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T14:20:15.827

显然，解决方案是尝试尽可能多的工具链。在花费太多时间编译工具链之后，您最终会找到一个可行的。uClibc buildroot 在这种情况下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-13T07:38:47.133

您可以在 Linaro 页面上找到支持 ARM926EJ-S 的工具链。使用 Linaro 项目中最新的[arm-linux-gnueabi](https://releases.linaro.org/components/toolchain/binaries/7.2-2017.11/)。我目前使用的是 gcc 4.9.4 版本，您可以在[此处找到](https://releases.linaro.org/components/toolchain/binaries/4.9-2017.01/arm-linux-gnueabi/)

建议使用 -mcpu=arm926ej-s 代替 -march 和 -mtune。请参阅[gcc 文档](https://gcc.gnu.org/onlinedocs/gcc-7.3.0/gcc/ARM-Options.html)，因为它为您指定的处理器结合了 -march 和 -mtune。它已被 x86 弃用，但不适用于 arm。

其他可能性可能是通过[crosstools-ng](https://crosstool-ng.github.io/)构建您自己的工具链。但是，如果您不需要某些特定设置（例如仅使用静态库），Linaro 工具链可以开箱即用。

# ruby - Class#define_method 和 Module#define_method 的区别

> ID：14321796
> 
> 赞同：0
> 
> 时间：2013-01-14T15:50:39.493
> 
> 标签：ruby

因为我发现`:define_method`同时出现在`Class.private_instance_methods`和中`Module.private_instance_methods`。你能告诉我为什么吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:54:07.810

这是因为它在 Module 中定义：http: [//apidock.com/ruby/Module/define_method](http://apidock.com/ruby/Module/define_method)并且 Class 的基类是 Module。所以，如果你问的是什么，你可以同时使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T16:02:19.227

`define_method`中定义`Module`。

`Class` *继承*自`Module`。因此`#define_method`.

简化：类只是一个模块，*但您可以实例化一个类*（不是模块）。

# php - 使用 colorbox ajax 通过提交发送数据

> ID：14321797
> 
> 赞同：1
> 
> 时间：2013-01-14T15:50:41.043
> 
> 标签：php, jquery, ajax, codeigniter, colorbox

HTML

```
<div class="cus_input">
    <form id="category_form" method="GET" action="<?php echo base_url(); ?>welcome/find/" >
        <input type="text" id="category_input" name="q" placeholder=" Find Category"/>
        <a type="submit" class="ajax cboxElement" id="category_submit" src="<?php echo base_url() ?>img/board/icons/add.jpg" value="" />
    </form>
</div> 
```

控制器

```
 function find()
{
        $this->pageload_model->load_page();
        $getquery = $this->input->get("q");
        $data['find'] = $this->find_model->get_find_view($getquery);
        $page['content'] = $this->load->view("template/findtemplate.php", $data);
        echo json_encode($page);
} 
```

当您手动转到 URI 时，此控制器会正确生成我想要的结果。在尝试使用 jquery ui 对话框时稍作修改。但是，此时我更愿意使用 colorbox 或 fancybox。

查找型号：

```
 public function get_find_view($q)
    {
        if (!$q) {
        $html = "Search disrupted: <a href='". base_url()."'>Go back to main page </a>";
        return $html;
        } else {
        $accountdata['found'] = $this->find_model->get_found_view($q);
        $accountdata['create_category'] = $this->find_model->get_create_category_view($q);
        return $this->load->view('find/find_view', $accountdata , TRUE);
        }
    } 
```

colobox ajax JS 应该是：`$('ajax').colorbox()`

我有 2 个区域的 ajax 类...一个直接的链接，没有问题，还有上面提到的提交按钮。我要做的是将输入值发送到 find() 控制器，加载页面，然后通过颜色框窗口打开它。我最终会对 pushstate 添加一个更改，以便可以抓取和共享新的 URL/页面。

我没有运气。谢谢您的帮助！将添加您可能需要的任何代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:41:56.900

我以前没有使用过彩盒，所以我不是 100% 的。我认为您需要做的是序列化表单中的数据并自己处理 ajax 请求。所以是这样的：

HTML：

```
<div class="cus_input">
    <form id="category_form" method="GET" action="<?php echo base_url(); ?>welcome/find/" onsubmit="return category_form_submit();" >
    <input type="text" id="category_input" name="q" placeholder=" Find Category"/>
    <a type="submit" id="category_submit" src="<?php echo base_url() ?>img/board/icons/add.jpg" value=""/>
    </form>
</div> 
```

查询：

```
function category_form_submit() {  
    $.get('/welcome/find?' + $('#category_form').serialize(), function(response){
        $.fn.colorbox({html:response});
        //here is where you could put your pushstate code
    });
    return false;
} 
```

# android - 我想打开一个对话框，其中包含定期向应用程序用户发送的消息

> ID：14321798
> 
> 赞同：0
> 
> 时间：2013-01-14T15:50:50.927
> 
> 标签：android

我们希望每 24 小时通过通知、对话框或屏幕上打开的图像向应用用户发送消息，告诉他们我们的应用正在他们的手机上运行。

我们一直在寻找使用通知生成器，但它的局限性在于它仅适用于 api 11 及更高版本，并且今天所有应用程序安装的一半都是针对早期 api 版本的。我们正在尝试找出最好的解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:21:57.110

我不确定“通知生成器”是什么，但您当然可以在任何您想要的 API 中使用[Notification](http://developer.android.com/reference/android/app/Notification.html)和[NotificationManager 。](http://developer.android.com/reference/android/app/NotificationManager.html)

因此，综合起来，我会使用[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)每 24 小时触发一次警报。在您的应用程序运行时设置此警报，*并*在配置为接收 BOOT_COMPLETED的[BroadcastReceiver中设置。](http://developer.android.com/reference/android/content/BroadcastReceiver.html)BOOT_COMPLETED 通知允许您在设备重新启动时安静地重新启动警报。

警报触发另一个广播接收器，它会发出通知。如果用户选择通知，则启动您的应用程序。大多数情况下，通知的存在将是您的用户需要的所有提醒。

我的笔记说 NotificationManager 可以在屏幕上弹出一个视图，这可能是一个对话框。但是，我认为状态栏中的简单图标最好，因为您只是在提醒用户该应用程序存在。

哦，ps，如果您的应用程序是在后台 24/7 运行的服务，那么您还应该记得在 BOOT_COMPLETED 广播中重新启动它。

# jquery - Jquery Star Rating和Infinite Scroll，dom加载后如何初始化

> ID：14321799
> 
> 赞同：1
> 
> 时间：2013-01-14T15:50:57.310
> 
> 标签：jquery, ajax

我正在使用这个 jquery 星级插件：[http](http://www.fyneworks.com/jquery/star-rating/) ://www.fyneworks.com/jquery/star-rating/ 和一个无限滚动插件来加载我的帖子。当帖子的第二页自动加载时，星级插件会崩溃并只显示输入按钮。我的 facebook 和 twitter 分享按钮也有这个问题，但我设法用以下代码解决了这个问题：

```
 <script type="text/javascript">
   $(document).ajaxComplete(function(){
try{
    FB.XFBML.parse(); 
    twttr.widgets.load();
}catch(ex){}
});
            </script> 
```

由于我对 jquery 或 javascript 没有任何了解，因此我真的不知道如何在加载新内容后再次初始化插件。有人可以帮我解决这个问题吗？

谢谢！

编辑 ：

这个无限滚动插件：[http ://www.fieg.nl/infinite-ajax-scroll-a-jquery-plugin](http://www.fieg.nl/infinite-ajax-scroll-a-jquery-plugin)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T17:52:07.607

我已经设法修复它，使用 Christian Varga 建议的 OnRendercomplete，如果其他人遇到此问题，这里是代码：

```
<script type="text/javascript">
jQuery.ias({
    container: '.listing',
    item: '.box',
    pagination: '.pagination',
    next: '.next a',
    loader: '<img src="images/loader.gif"/>',
    onRenderComplete: function (items) {

        FB.XFBML.parse();
        twttr.widgets.load();

        $(function () {
            $('.auto-submit-star').rating({
                callback: function (value, link) {

                    //   this.form.submit();
                    $('.auto-submit-star').rating('readOnly', true)
                    $(this.form).ajaxSubmit();

                    return false;

                }
            });
        });

    }
}); 
```

# javascript - 从JS中的字符串调用函数

> ID：14321801
> 
> 赞同：0
> 
> 时间：2013-01-14T15:51:01.427
> 
> 标签：javascript, function, callback

我有一个字符串数组，希望用作回调，但下面的代码不起作用。

运行该函数时，`TypeError: fn is not a function`当`callback_array`仅包含`update_front_page_images`.

`callback_array`目前只包含 1 个元素 ( `update_front_page_images`)，这是我希望运行的函数的名称。

有人可以让我知道我做错了什么吗？

```
function run_reset_callbacks(callback_array){

    for(var key in callback_array){

        try {
            fn = window[callback_array[key]];
            fn();
        }
        catch(err) {
            console.log('Function \''+callback_array[key]+'\' does not exist. '+err);
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:57:59.730

如果您想使用此模型，请确保您以一种可以将它们称为 window[] 的方式定义您的函数。您需要将函数定义为窗口对象上的变量。标准函数定义将失败。

[http://jsfiddle.net/HpXYM/2/](http://jsfiddle.net/HpXYM/2/)

```
//Works
window.hello = function () {
  alert("hello");
};

//Works    
test = function () {
  alert("test");
};

//Fails
function fail() {
  alert("fail")
}; 
```

如果您采用这种方法，这应该可以解决问题，但我建议您遵循 Matt Ball 的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T16:26:23.620

改变你的范围！我认为您无法访问`window`：

[**JS小提琴链接**](http://jsfiddle.net/OMS_/3Q9pS/)

```
var outputDiv = document.getElementById('output');

// Wrong
var cbArray = ['update_front_page_images', 'dummyFunction']; // Array created from PHP

function update_front_page_images() {
    outputDiv.innerHTML = outputDiv.innerHTML+ '<br/>' + 'Called me? I am "update_front_page_images" !!';
}

function dummyFunction() {
    outputDiv.innerHTML = outputDiv.innerHTML+ '<br/>' + 'Called me? I am "" !!';
}
// -- Wrong

// Right
var cbArray = {
    'update_front_page_images': function() {
        outputDiv.innerHTML = outputDiv.innerHTML+ '<br/>' + 'Called me? I am "update_front_page_images" !!';
    },
    'dummyFunction': function() {
        outputDiv.innerHTML = outputDiv.innerHTML+ '<br/>' + 'Called me? I am "dummyFunction" !!';
    }
}
// -- Right

// your Code
function run_reset_callbacks(callback_array){

    for(var key in callback_array){

        try {
            fn = window[callback_array[key]]; // Wrong
            fn = callback_array[key]; // Right
            fn();
        }
        catch(err) {
            outputDiv.innerHTML = 'Function \''+callback_array[key]+'\' does not exist. '+err;
        }
    }

}

run_reset_callbacks(cbArray); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-14T15:54:58.560

应使用索引循环枚举数组：

```
for (var i = 0; i < callback_array.length; i++) { ...  } 
```

如果`callback_array`真的是一个文字对象，上面的方法很好，但`hasOwnProperty`在评估属性之前检查会更安全。

```
if(callback_array.hasOwnProperty(key)) { ... } // use it 
```

否则，请确保它`update_front_page_images`在全局范围内并准备好在调用此函数时进行评估。

# php - Note.js + PHP + MySQL 用于聊天

> ID：14321802
> 
> 赞同：0
> 
> 时间：2013-01-14T15:51:02.880
> 
> 标签：php, mysql

我已经构建了一个小的 jQuery 聊天小部件，现在意识到我使用的解决方案实际上是在超过 10 倍的用户同时在服务器上使用大量负载。

我构建的解决方案是使用保持活动状态的 jQuery jsonp 请求来检查新数据（来自查询 mysql db 以获取新消息的 php 脚本），这就是导致负载的原因。

不幸的是，我现在必须重建大部分服务器端代码。在此之前，我想来这里询问是否有某种方法可以用 Node.js 实现它？

我真正想要的是： - 保留 MySQL 数据库进行存储 - 只重写我目前拥有的导致负载的发布彗星

是否有可能编写一个 Node.js 服务器，将每条新消息存储在我当前的 MySQL 数据库中？

哦，最重要的是，因为它是一个小部件，它必须允许跨站点访问.. Node.js 会这样做吗？

# asp.net - 来自 asp.net 表单身份验证客户端的 wcf 授权（请求过滤）

> ID：14321805
> 
> 赞同：0
> 
> 时间：2013-01-14T15:51:10.433
> 
> 标签：asp.net, wcf, authorization, wcf-security

当前的 2 层应用程序

ASP.NET（成员/角色）– BL – DAL – DB

在用户通过身份验证（成员资格）后，我们使用角色来促进对不同菜单项的授权，例如“报告”和“管理”。然而，作为授权的一部分，我们还必须考虑**响应过滤**。例如，无论用户的角色如何，通过 id 检索语句的方法应该限制为用户只能通过某些已建立的数据库关系检索属于他们的语句。为了促进这一点，Web 应用程序在会话中维护一个配置文件 (POCO)，该配置文件被注入到每个 BL 对象中（也许这个对象应该被合并到`IIdentity`）。随后在 BL 中，我们能够确定对 id X 的请求是否确实应该返回一个语句，因为我们知道请求该语句的用户，并且我们知道该语句与应该能够访问它的用户之间的关系.

未来的三层应用

ASP.NET（成员/角色）- WCF - BL - DAL - DB

身份验证似乎保持不变，WCF 服务可以使用密码保护，以确保只有我们的 Web 应用程序（或任何其他具有用户/密码的应用程序）可以访问它。但是，我该如何促进响应过滤？是否有将 ASP.NET 的`IPrincipal`/传递`IIdentity`给服务的无缝机制？如果是的话，如果我有一个非 ASP.NET 客户端到同一服务，这将如何限制我？如果不是，此信息应该是请求 dto 或请求标头的一部分吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T15:08:45.337

回覆：

> 是否有无缝机制将 ASP.NET 的 IPrincipal/IIdentity 传递给服务？

您可以查看 WS-Trust ：*weblogs.asp.net/cibrax/archive/2006/09/08/SAML-2D00-STS-implementation-for-WCF.aspx*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T15:07:03.657

您可以将 XACML 应用于您的 3 层应用程序。您将在小部件（菜单、按钮...）、业务逻辑和 WCF 层中获得授权。

所有请求都将违反 XACML 外部编写的相同授权策略。你的规则可以说：

*   管理员可以查看管理按钮
*   用户可以查看他们拥有的语句（即用户可以查看语句 if statement.owner==user.id）

您不再需要实现数据库关系。您的授权变得容易得多。

高温高压

# c# - 如何连续自动滚动单行文本框？

> ID：14321806
> 
> 赞同：1
> 
> 时间：2013-01-14T15:51:21.560
> 
> 标签：c#, winforms, textbox

`TextBox`我需要写一些东西来连续自动滚动一行文本。我是否需要滚动到插入符号然后将其设置为第一个字符并重新开始？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T11:26:56.363

所以我找到了一个选框控件并对其进行了一些修改并使用它而不是文本框

```
public class Marquee : System.Windows.Forms.UserControl
{
    private System.ComponentModel.IContainer components;
    private System.Windows.Forms.Timer timer1;

    private int currentPos = 0;
    private bool mBorder;
    private string mText;

    public string MarqueeText
    {
        get { return mText; }
        set { mText = value; }
    }

    public bool Border
    {
        get { return mBorder; }
        set { mBorder = value; }
    }

    public int Interval
    {
        get { return timer1.Interval * 10; }
        set { timer1.Interval = value / 10; }
    }

    public Marquee()
    {
        // This call is required by the Windows.Forms Form Designer.
        InitializeComponent();

        // TODO: Add any initialization after the InitForm call
        this.Size = new Size(this.Width, this.Font.Height);
    }

    /// <summary>
    /// Clean up any resources being used.
    /// </summary>
    protected override void Dispose(bool disposing)
    {
        if (disposing)
        {
            if (components != null)
                components.Dispose();
        }
        base.Dispose(disposing);
    }

    #region Component Designer generated code
    /// <summary>
    /// Required method for Designer support - do not modify 
    /// the contents of this method with the code editor.
    /// </summary>
    private void InitializeComponent()
    {
        this.components = new System.ComponentModel.Container();
        this.timer1 = new System.Windows.Forms.Timer(this.components);
        // 
        // timer1
        // 
        this.timer1.Enabled = true;
        this.timer1.Interval = 1000;
        this.timer1.Tick += new System.EventHandler(this.timer1_Tick);
        // 
        // Marquee
        // 
        this.Name = "Marquee";
        this.Size = new System.Drawing.Size(150, 136);
        this.Resize += new System.EventHandler(this.Marquee_Resize);

    }
    #endregion

    private void Marquee_Resize(object sender, System.EventArgs e)
    {
        this.Height = this.Font.Height;
    }

    private void timer1_Tick(object sender, System.EventArgs e)
    {
        this.Invalidate();
    }

    protected override void OnPaint(System.Windows.Forms.PaintEventArgs e)
    {

        if (mBorder)
        {
            e.Graphics.DrawRectangle(new Pen(this.ForeColor), 0, 0, this.Width - 1, this.Height - 1);
        }

        float dif = e.Graphics.MeasureString(mText, this.Font).Width- this.Width;
        if (this.Width < e.Graphics.MeasureString(mText, this.Font).Width)
        {
            e.Graphics.DrawString(mText, this.Font, new SolidBrush(this.ForeColor),
                currentPos, 0);
            e.Graphics.DrawString(mText, this.Font, new SolidBrush(this.ForeColor),
                this.Width + currentPos + dif, 0);

            currentPos--;

            if ((currentPos < 0) && (Math.Abs(currentPos) >= e.Graphics.MeasureString(mText, this.Font).Width))
                currentPos = this.Width + currentPos;
        }
        else 
        {
            e.Graphics.DrawString(mText, this.Font, new SolidBrush(this.ForeColor),-dif/2, 0);
        }

    }
} 
```

因此，如果文本宽度大于控件的宽度，则文本将是静态的，否则文本将自动滚动

# google-maps-api-3 - 在打开另一个之前关闭 InfoWindow

> ID：14321808
> 
> 赞同：3
> 
> 时间：2013-01-14T15:51:24.067
> 
> 标签：google-maps-api-3, mouseover, infowindow

我对 InfoWindow 有疑问。我有一个通过 JSON 检索数据的 ajax 函数，但是当您打开另一个时，我无法自动关闭 InfoWindow。我的代码是这样的：

```
var mapOptions = {
    center: new google.maps.LatLng(44.49423583832911, 11.346244544982937),
    zoom: 13,
    mapTypeId: google.maps.MapTypeId.ROADMAP
};
map = new google.maps.Map(document.getElementById("mappa_locali"),mapOptions);
$.ajax({
    type:'GET',
    url:"locali_json.php"+urlz,
    success:function(data){ 
          var json = JSON.parse(data);
          for (var i=0; i<json.length; i++) {
             point = new google.maps.LatLng(json[i].latitudine,json[i].longitudine);
             var infowindow = new google.maps.InfoWindow;
             infowindow.setContent('<a href="./dettaglioLocale.php?id_loc='+json[i].id_locale+'">'+json[i].nome_locale+'</a><br>'+json[i].address);
             addMarkerz(point,infowindow);
          }
    }
})
 }

   function addMarkerz(point,infowindow) { 
    position: point,
    map: map
   });
    google.maps.event.addListener(marker,'mouseover',infoCallback(infowindow, marker));
    markers.push(marker);
    infos.push(infowindow);
     }

    function infoCallback(infowindow, marker) { 
      return function() {
         infowindow.close();  
        infowindow.open(map, marker);

      };
    } 
```

有谁知道哪里减少了错误？或者你对我有什么建议吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-16T13:46:14.413

建议只创建一个信息窗口（在全局范围内），在单击标记时重用它并更改其内容，如果用户单击地图则关闭它。

**代码片段（删除对 AJAX 调用的依赖）：**

```
// global variables
var map;
var markers = [];
var infowindow = new google.maps.InfoWindow();

function initialize() {
  var mapOptions = {
    center: new google.maps.LatLng(44.49423583832911, 11.346244544982937),
    zoom: 13,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  map = new google.maps.Map(document.getElementById("mappa_locali"), mapOptions);
  var json = JSON.parse(data);
  for (var i = 0; i < json.length; i++) {
    point = new google.maps.LatLng(json[i].latitudine, json[i].longitudine);
    var infowindowHtml = '<a href="./dettaglioLocale.php?id_loc=' + json[i].id_locale + '">' + json[i].nome_locale + '</a><br>' + json[i].address;
    addMarkerz(point, infowindowHtml);
  }
}

function addMarkerz(point, infowindowHtml) {
  var marker = new google.maps.Marker({
    position: point,
    map: map
  });
  google.maps.event.addListener(marker, 'mouseover', infoCallback(infowindowHtml, marker));
  markers.push(marker);
}

function infoCallback(infowindowHtml, marker) {
  return function() {
    infowindow.close();
    // update the content of the infowindow before opening it
    infowindow.setContent(infowindowHtml)
    infowindow.open(map, marker);

  };
}

var data = JSON.stringify([{
  latitudine: 44.494887,
  longitudine: 11.3426163,
  id_locale: "0",
  nome_locale: "Bologna",
  address: "Bologna, Italy"
}, {
  latitudine: 44.4946615,
  longitudine: 11.314634999999953,
  id_locale: "0",
  nome_locale: "Quartiere Saragozza",
  address: "Quartiere Saragozza, Bologna, Italy"
}]);

google.maps.event.addDomListener(window, "load", initialize);
```

```
html,
body,
#mappa_locali {
  height: 100%;
  width: 100%;
  margin: 0px;
  padding: 0px
}
```

```
<script src="https://maps.googleapis.com/maps/api/js"></script>
<div id="mappa_locali"></div>
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-01T11:37:53.470

```
function infoCallback(infowindow, marker) { 
  return function() {
     infowindow.close();  
    infowindow.open(map, marker);

  };
} 
```

应该改为

```
function infoCallback(infowindow, marker) { 
    return function() {
        //Close active window if exists
        if (activeWindow != null) {
            activeWindow.close();
        }
        //Open new window 
        infowindow.open(map,marker); 
        //Store new window in global variable 
        activeWindow = infowindow; 
    };
} 
```

并在 .js 文件中将 activeWindow 声明为全局变量`var activeWindow`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-21T00:06:45.633

我想我有一个简单的解决方案。我只是保存最后一个打开的标记。在下一次单击时，首先我关闭最后一个标记。

```
var markers = [];
var infowindows = [];

function addMarkes(facilityID) {

        var bounds = new google.maps.LatLngBounds();

        for (var i = 0; i < variants.length; i++) {

            var v = variants[i];

            var position = new google.maps.LatLng(v.Lat, v.Long);

            bounds.extend(position);

            markers[i] = new google.maps.Marker({
                position: position,
                title: v.Title,
                map: map,
                animation: google.maps.Animation.DROP,
                icon: v.Icon,
                infoWindowIndex: i //synchronize with infoWindows
            });

            var localContent = '<div><span class="address">' + v.Address + '</span></div>';

            infowindows[i] = new google.maps.InfoWindow({
                content: localContent
            });

            //Just for multiple marks. 
            if (variants.length > 0) {
                var lastOpen = -1; //Save the last open mark
                google.maps.event.addListener(markers[i], 'click', function (innerKey) {
                    return function () {
                        //Close the last mark.
                        if (lastOpen > -1) {
                            infowindows[lastOpen].close();
                        }
                        infowindows[innerKey].open(map, markers[innerKey]);
                        lastOpen = innerKey;
                    }
                }(i));
            }
        }

        map.fitBounds(bounds);

    } 
```

# java - 使用 ImageJ 库 (Java) 增加图像的对比度

> ID：14321812
> 
> 赞同：1
> 
> 时间：2013-01-14T15:51:29.547
> 
> 标签：java, image, image-manipulation, imagej

我正在尝试通过某些因素增加图像的对比度`x`

到目前为止，我能够读取图像，并像这样获得它的处理器

```
ImagePlus im = new ImagePlus(imagePathHere);
ImageProcessor ip = im.getProcessor(); 
```

我知道`ContrastEnhancer.java`但`ContrastAdjuster.java`我不确定它们将如何使用。最终，我想要这样的东西

```
ImagePlus imc = increaseContrast(im, 0.5) 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T18:32:38.247

这似乎有效：

```
ImagePlus im = new ImagePlus(imagePathHere);
ContrastEnhancer enh = new ContrastEnhancer();
enh.stretchHistogram(plus, i); 
```

其中 i < 100；

你打电话时

```
im.getImage(); 
```

您将获得对比度增加的图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T07:26:02.067

```
setMinAndMax(double min, double max) 
```

在[ImageProcessor](http://imagej.nih.gov/ij/developer/api/)对象上。

# c# - 使用实体框架poco的基于不同用户角色的MVC4数据注释验证

> ID：14321815
> 
> 赞同：1
> 
> 时间：2013-01-14T15:51:40.407
> 
> 标签：c#, entity-framework, validation, asp.net-mvc-4, data-annotations

我正在开发一个具有大约 90 种不同形式的复杂应用程序（是的，真棒）。如何根据一些要求进行复杂的字段验证：

1) 字段要求基于登录的用户（角色） 2) 如果其他数据字段的回答不同（动态），则字段要求会发生变化

这是如何使用 EF5 POCO 在 MVC4 中完成的？

我目前已经为必填字段创建了数据注释，如下所示：

**我的 EF5 POCO 模型**：

```
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;

[MetadataType(typeof(User_Validation))]
public partial class User
{    
    public int UserID { get; set; }
    public string UserName { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string Password { get; set; }
    public string Email { get; set; }
} 
```

**ValidationModels.cs 文件位于我的 EF5 POCO 中**：

```
 public class User_Validation
    {    
        public int UserID { get; set; }

        [Required(ErrorMessage = "The UserName is required")]
        public string UserName { get; set; }

        [Required(ErrorMessage = "The FirstName is required")]
        public string FirstName { get; set; }

        [Required(ErrorMessage = "The LastName is required")]
        [Display(Name="Last Name")]
        public string LastName { get; set; }

        [Required(ErrorMessage = "The Password is required")]
        [DataType(DataType.Password)]
        public string Password { get; set; }

        [Required(ErrorMessage = "The Email is required")]
        [DataType(DataType.EmailAddress)]
        public string Email { get; set; }
    } 
```

这很好用，但我如何使我的验证动态化？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:17:04.890

您是否需要管理员为响应设置动态要求，或者它们从一开始就相当静态？

如果我是你，我会为每个触发的响应创建不同的操作方法。这将允许您将表单指定为部分视图并根据输入逻辑呈现它们。

如果您需要自定义字段验证，建议您编写自己的数据验证框架。您可以从 ActionFilterAttribute 继承，它允许您在每个操作请求/响应周期之前和之后添加自定义验证。在这里查找一些信息[MVC 中的自定义过滤器](http://www.codeproject.com/Articles/426766/Custom-Filters-in-MVC-Authorization-Action-Result)

此外，我会为客户端验证引入一个自定义 jquery 验证框架，这样同一个表单就没有多个回发，然后在动态生成下一个表单之前进行自定义服务器端验证。有关框架的信息，请查看此博客：[Jquery - 自定义验证](http://randomactsofcoding.blogspot.com/2008/10/starting-with-jquery-how-to-write.html)

请记住，您不希望在数据存储和视图之间进行大量聊天，因此我会将尽可能多的配置存储在经过深思熟虑的缓存实现中。

我希望这有帮助。

# ruby-on-rails - stylesheet_link_tag 不起作用，错误的目录

> ID：14321818
> 
> 赞同：0
> 
> 时间：2013-01-14T15:51:42.597
> 
> 标签：ruby-on-rails

我今天正在研究 Ruby on Rails 教程中的样式表，正如它所说，我添加了

```
<%= stylesheet_link_tag 'blueprint/screen', :media => 'screen' %> 
<%= stylesheet_link_tag 'blueprint/print', :media => 'print' %> 
```

应该从 public/stylesheets/blueprint 文件夹中读取 screen.css 和 print.css。

但是，当我打开浏览器时，样式并没有改变，所以我检查了 html 代码并显示

```
<link type="text/css" rel="stylesheet" media="screen" href="/assets/blueprint/screen.css></link> 
```

谁能告诉我为什么路线是错误的？它不应该是 public/stylesheets 而不是 /assets/somewhere 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:38:22.750

正如 house9 在评论中所说，请检查[http://guides.rubyonrails.org/asset_pipeline.html](http://guides.rubyonrails.org/asset_pipeline.html) 10 分钟阅读。

--- 在评论中回答问题--- 它会首先检查 /public 文件夹，然后它会尝试在 assets 文件夹中查找。此行为对开发有效。

在生产中，所有资产都将被编译并公开（默认）。

因此，请确保您没有公开具有所需名称的文件并将其放在资产上。您的 application.css 应该具有 sprockets 符号： `*= require_tree .`这将确保此文件夹中的所有有效文件都将包含在 css 中。

如果您不使用 sprockets，请确保在 application.css 上导入所需的文件

# c# - 共享列表 多线程之间

> ID：14321820
> 
> 赞同：2
> 
> 时间：2013-01-14T15:51:47.657
> 
> 标签：c#, multithreading, locking

我是否正确地说我只需要使用锁定来添加/删除/更改列表，还是在迭代它时也需要锁定它？

所以我这样做线程安全吗：

```
class ItemsList
{
    List<int> items = new List<int>();
    object listLock = new object();

    public void Add(int item)
    {
        lock (listLock)
        {
            items.Add(item);
        }
    }

    public void Remove(int item)
    {
        lock (listLock)
        {
            items.Remove(item);
        }
    }

    public void IncrementAll()
    {
        foreach (var item in items)
        {
            item += 1;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T15:53:34.393

你也应该在迭代它时锁定 - 如果在你迭代它时更改了列表，则会引发异常。

从文档中[`List<T>.GetEnumerator`](http://msdn.microsoft.com/en-us/library/b0yss765.aspx)：

> 枚举器没有对集合的独占访问权；因此，通过集合进行枚举本质上不是线程安全的过程。为了保证枚举过程中的线程安全，可以在整个枚举过程中锁定集合。要允许集合被多个线程访问以进行读写，您必须实现自己的同步。

此外，如果您也可以对它进行写入，那么即使从 a 读取一次`List<T>`也不是线程安全的——即使它没有失败，也不能保证您会获得最新的值。

基本上，*只有*在它的状态对所有线程可见的最后一点之后没有被写入，它才对多个线程是安全的`List<T>`。

 *如果您想要一个线程安全的集合，并且您使用的是 .NET 4 或更高版本，请查看[`System.Collections.Concurrent`](http://msdn.microsoft.com/en-us/library/system.collections.concurrent.aspx)命名空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T15:57:05.737

`List<T>`通常不是线程安全的。拥有多个阅读器不会导致任何问题，但是，您不能在读取列表时写入列表。因此，您需要同时锁定读取和写入，或使用 System.Threading.ReaderWriterLock 之类的东西（它允许多个读取器，但只允许一个写入器）。如果你在 下开发`.NET 4.0 or bigger`，你可以使用[BlockingCollection](http://msdn.microsoft.com/it-it/library/dd267312.aspx)来代替，它是一个线程安全的集合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T15:55:27.810

不，那不安全。如果另一个线程在您阅读它时修改它，您将收到“集合已修改”类型的异常。

解决此问题的最有效方法是使用[ReaderWriterLockSlim](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)来控制访问，以便多个线程可以同时读取它，并且只有在尝试修改它时才会被锁定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T15:55:48.917

[如果你从不迭代它，你甚至不是线程安全的](http://blogs.msdn.com/b/ericlippert/archive/2009/10/19/what-is-this-thing-you-call-thread-safe.aspx)。

在我们讨论它是否会按预期工作之前，您需要定义您对数据结构执行的操作类型。

但在一般情况下，您确实需要在阅读时锁定。事实上，有人可能会在您进行迭代时添加一个项目，这会破坏各种事情。如果您在阅读过程中添加了一个项目，即使阅读单个项目也可能会被破坏。

另请注意，这充其量只会使每个操作在逻辑上原子化。如果您曾经执行多个操作并对数据结构的状态做出假设，那么这还不够。

在许多情况下，要解决此问题，您需要在调用方进行锁定，而不是仅将每个操作包装在`lock`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-14T15:56:06.477

您可能应该使用 a`ReaderWriterLockSlim`以便多个线程可以读取集合，但只有一个可以修改它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-14T16:07:41.093

在 IncrementAll 上，由于集合中所做的更改，您将捕获 InvalidOperationException。您可以在测试单元中看到它，如下所示：

```
 ItemsList il = new ItemsList();
        Task ts = new Task(() =>
        {
            for (int i = 0; i < 100000; i++)
            {
                il.Add(i);
                System.Threading.Thread.Sleep(100);

            }
        }
        );
        ts.Start();
        Task ts2 = new Task(() =>
        {
            //DoSomeActivity
            il.IncrementAll();
        }
        );
        ts2.Start();
        Console.Read(); 
```

迭代也必须锁定！！！

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-01-14T16:00:35.533

您可能想看看 ConcurrentQueue<>();

这基本上是一个线程安全列表（据我所知），这很方便。你可以像这样使用它；

```
 public ConcurrentQueue<yourType> alarmQueue = new ConcurrentQueue<yourType>();
    System.Timers.Timer timer;

    public QueueManager()
    {
        timer = new System.Timers.Timer(1000);
        timer.Elapsed += new System.Timers.ElapsedEventHandler(timer_Elapsed);
        timer.Enabled = true;
    }

    void timer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
    {
        DeQueueAlarm();
    }

    private void DeQueueAlarm()
    {
        yourType yourtype;
        while (alarmQueue.TryDequeue(out yourtype))
        {
           //dostuff
        }

    } 
```

编辑：正如约翰所说，这在 .Net4 及更高版本中可用。在这里阅读更多；[http://msdn.microsoft.com/en-us/library/dd267265.aspx](http://msdn.microsoft.com/en-us/library/dd267265.aspx)*

# ruby - Rails ActiveRecord 查询最近查看的资源

> ID：14321823
> 
> 赞同：0
> 
> 时间：2013-01-14T15:51:52.957
> 
> 标签：ruby, database-design, activerecord, ruby-on-rails-3.2

我最近做了以下模型：

```
class User < ActiveRecord::Base
  has_many :resources
  has_many :resource_views, :through => :user_resource_views, :source => 'Resource'
end

class Resource < ActiveRecord::Base
  belongs_to :user
  has_many :resource_views, :through => :user_resource_views, :source => 'Resource'
end

class UserResourceView < ActiveRecord::Base
  attr_accessible :resource_id, :user_id
  belongs_to :resource
  belongs_to :user_id
end 
```

现在，我希望我的 home#index 操作将 @resources 设置为 current_user 最近查看的资源。你会建议我如何进行？也许类似于 current_user.resource_views.find(:all, :order => 'created_at')？

在 SQL 中，我会执行以下操作：

```
SELECT * 
FROM Resource 
WHERE id IN (SELECT * FROM UserResourceView WHERE user_id = current_user.id) 
```

...但随后 ORDER BY created_at，嗯

我将全天定期添加进度更新，直到我弄明白为止。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T16:04:27.597

鉴于您使用的是 Rails 3.x，您正在寻找的可能是这样的：

```
class User < ActiveRecord::Base
  has_many :resources
  has_many :resource_views, :class_name => 'UserResourceView'
  has_many :viewed_resources, :through => :resource_views, :source => :resource

  def recently_viewed_resources
    viewed_resources.order('user_resource_views.created_at DESC')
  end
end

class Resource < ActiveRecord::Base
  belongs_to :user
  has_many :resource_views, :class_name => 'UserResourceView'
end

class UserResourceView < ActiveRecord::Base
  attr_accessible :resource_id, :user_id
  belongs_to :resource
  belongs_to :user_id
end 
```

并访问控制器中的集合：

```
current_user.recently_viewed_resources 
```

# c# - 在卸载期间显示来自 C# 自定义操作的 WiX 对话框

> ID：14321825
> 
> 赞同：0
> 
> 时间：2013-01-14T15:52:03.537
> 
> 标签：c#, wix, windows-installer, custom-action

在从快捷方式运行并使用基本 UI 添加/删除程序的卸载序列期间，我无法显示对话框。它似乎跳过了在修改和安装过程中显示的 InstallUISequence：

```
<!--Displays uninstall options before uninstall progress dialog WixUI_InstallMode = "Remove"-->
<InstallUISequence>
    <Show Dialog="UninstallDialog" Before="ProgressDlg">WixUI_InstallMode = "Remove"</Show>
</InstallUISequence> 
```

但是，重要的是我让这个对话框在基本卸载过程中运行。是否可以通过 InstallExecuteSequence 运行的 C# 自定义操作显示在 WiX 中定义的对话框？如果是这样，我将如何去做？有教程吗？我想显示的对话框如下所示：

```
<!--Dialog used to obtain uninstall options from user-->
<Dialog Id="UninstallDialog" Width="120" Height="100" Title="Options">
    <Control Id="DelDatabaseCheckBox" Type="CheckBox"
             X="15" Y="10" Width="90" Height="17" Property="DELDATABASE"
             CheckBoxValue="1" Text="Delete Database"/>

    <Control Id="DelSettingsCheckBox" Type="CheckBox"
             X="15" Y="30" Width="90" Height="17" Property="DELSETTINGS"
             CheckBoxValue="1" Text="Delete Settings"/>

    <Control Id="DelErrorLogCheckBox" Type="CheckBox"
             X="15" Y="50" Width="90" Height="17" Property="DELERRORLOG"
             CheckBoxValue="1" Text="Delete Error Log"/>

    <Control Id="ConfirmUninstall" Type="PushButton" X="22" Y="75" Width="70" Height="17" Text="Ok">
        <Publish Event="EndDialog" Value="Return">1</Publish>
    </Control>
</Dialog> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T16:17:50.847

您正在尝试做的是反模式。而是禁用 Remove 按钮并强制用户通过 Change | 删除故事。您可以在那里显示本机 MSI UI。

# unix - UNIX - 停止自定义服务

> ID：14321829
> 
> 赞同：0
> 
> 时间：2013-01-14T15:52:14.597
> 
> 标签：unix, service, process, daemon, pid

我创建了一个客户端-服务器应用程序，现在我想部署它。

在开发过程中，我在终端上启动了服务器，当我想停止它时，我只需要输入“Ctrl-C”。

现在希望能够在后台启动它并在我想要的时候停止它，只需键入：

```
/etc/init.d/my_service {stop|stop} 
```

我知道如何做一个初始化脚本，但问题是如何真正停止这个过程？

我首先想到的是使用以下内容检索 PID：

```
ps aux | grep "my_service" 
```

然后我找到了一个更好的主意，仍然使用 PID：将其存储在文件中以便在尝试停止服务时检索它。

绝对太脏和不安全，我最终想到了使用套接字来启用“停止”进程来告诉实际进程关闭。

我想知道这通常是怎么做的？或者更确切地说，最好的方法是什么？

我检查了 init.d 中的一些文件，其中一些使用 PID 文件，但使用特定命令“start-stop-daemon”。我对这种对我来说似乎不安全的方法有点怀疑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:17:16.477

如果您有类似[start-stop-daemon](http://man.cx/start-stop-daemon)这样的实用程序可用，请使用它。

`start-stop-daemon`很灵活，可以使用 4 种不同的方法来查找正在运行的服务的进程 ID。它使用此信息 (1) 避免在启动时启动同一服务的第二个副本，以及 (2) 确定在停止服务时要终止哪个进程 ID。

*   `--pidfile`：检查进程是否创建了文件pid-file。
*   `--exec`：检查作为此可执行文件实例的进程
*   `--name`: 检查名称为 process-name 的进程
*   `--user`：检查由用户名或 uid 指定的用户拥有的进程。

一般来说，最好使用的可能是`--pidfile`. 其他的主要用于服务不创建 PID 文件的情况。`--exec`缺点是您无法区分由同一程序实现的两个不同服务（即同一服务的两个副本）。这个缺点通常`--name`也适用于，此外，`--name`有机会匹配碰巧共享相同名称的不相关进程。`--user`如果您的服务在专用用户 ID 下运行，该用户 ID 不被其他任何人使用，这可能会很有用。因此`--pidfile`，如果可以，请使用。

为了额外的安全，可以组合这些选项。例如，您可以将`--pidfile`and`--exec`一起使用。这样，您可以使用 PID 文件识别进程，但如果在 PID 文件中找到的 PID 属于使用错误可执行文件（它是陈旧/无效的 PID 文件）的进程，则不要相信它。

我已使用 提供的选项名称`start-stop-daemon`来讨论不同的可能性，但您不必使用`start-stop-daemon`：如果您使用其他实用程序或手动进行匹配，该讨论同样适用。

# android - Android - 从系统设置导航回应用程序

> ID：14321835
> 
> 赞同：0
> 
> 时间：2013-01-14T15:52:25.953
> 
> 标签：android, navigation, settings, system, back

在我的登录活动中，我检查用户是否已激活/打开他们的 GPS。如果没有，我只是显示一个`AlertDialog`要求用户打开 GPS 的信息。

从`AlertDialog`我启动/启动一个 Intent 如下：

```
Intent settingsIntent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
startActivity(settingsIntent); 
```

当从系统设置中按下返回按钮时，用户返回到手机的主屏幕......即“关闭应用程序”。

我试过`onActivityResult`但没有用。此外，我已经阅读了其他用户遇到的类似问题，但由于大多数答案与使用`onActivityResult`.

有人可以对此事有所了解吗？

**编辑：** 这是完整的代码`AlertDialog`：

```
builder = new AlertDialog.Builder(this);
builder.setTitle("GPS Not Found");
builder.setMessage("Want To Enable?");

//Dialog - Yes option
builder.setPositiveButton("Yes", new DialogInterface.OnClickListener()
{
public void onClick(DialogInterface dialogInterface, int i)
{
Intent settingsIntent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
startActivityForResult(settingsIntent,1);
}
});

//Dialog - No option                
builder.setNegativeButton("No", new DialogInterface.OnClickListener()
{
public void onClick(DialogInterface dialogInterface, int i)
{

}
});

//Show he dialog
builder.create().show(); 
```

**编辑：** 这里是`OnPause()`和`OnResume()`方法。我只是检查提供程序是否仍然处于活动状态并且与`locationManager`. 当我从“设置”返回时，“TEST 1”和“TEST 2”都不会打印。

```
@Override
protected void onResume()
{
  Log.i(ERRORTAG, "TEST 1");

  super.onResume();
  if(provider != null)
  {
    locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, refreshTime, refreshDistance, this);
    gpsEnabled = locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER);
  }
}

@Override
protected void onPause()
{
  Log.i(ERRORTAG, "TEST 2");

  super.onPause();
  if(locationManager != null)
  {
    locationManager.removeUpdates((LocationListener) this);
    gpsEnabled = locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER);
  }

  if(loginDialog != null)
  {
    loginDialog.dismiss();
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:58:14.143

你是在你的或`finish();`之后的某个地方打电话吗？ 查看[Activity 生命周期](http://developer.android.com/reference/android/app/Activity.html)，您会看到在启动 Settings-Intent 时调用它。`startActivity()``onPause()`
`onPause()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T10:51:22.427

整理出了问题。在清单文件中，活动的标签`noHistory="true"`（据我所知）不会将其添加到堆栈中。因此不能“回到”活动。

# android - 使用辅助功能（例如触摸浏览）捕获手势

> ID：14321840
> 
> 赞同：2
> 
> 时间：2013-01-14T15:52:44.770
> 
> 标签：android, accessibility, gestures

我们有一个捕获手势的应用程序（目前使用`onTouch`事件回调，效果很好）。遗憾的是，当打开辅助功能（例如通过触摸探索）时，我们的应用程序只能识别部分手指。我们当然有理由相信这不是由于我们的代码中的错误。对我们来说，视障和盲人群体非常重要，而手势对他们来说更为重要。

启用辅助功能时如何捕捉手势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:14:23.913

我自己没有这样做（免责声明），但是从[辅助功能文档中的](http://developer.android.com/guide/topics/ui/accessibility/index.html)[“处理自定义触摸事件”](http://developer.android.com/guide/topics/ui/accessibility/apps.html#custom-touch-events)部分看来，您需要通过覆盖来实现“虚拟视图层次结构” （假设您有一些自定义视图，或者您在内置视图中覆盖 onTouch，这具有类似的净效果）。`getAccessibilityNodeProvider`

关于这方面的文档有很多信息，并且可以通过支持库追溯到 Android 1.6。我会首先研究所有这些，并且非常熟悉检测何时启用可访问性以及何时未启用，并在启用时做出相应的反应。

# jquery - mysql 更新到数据库后显示更改

> ID：14321843
> 
> 赞同：0
> 
> 时间：2013-01-14T15:53:02.117
> 
> 标签：jquery, ajax, live

对于我的个人项目，我正在尝试制作一个积分系统。基本上我想做的是：单击一个按钮（Jquery），然后向数据库发送查询，最后向用户显示自动更新的点。我想我可以使用ajax。

```
$(this).html('Thank you for granting EXP!');
var dataString = 'username=' + username+ '&name='+ name + '&count=' + count + '&message_id=' + message_id;

    $.ajax({
    type: "POST",
    url: "index.php?&page=profile",
    data: dataString,
    success: function() {
        $('#skills').load('./modules/skill_table.php');
    }
    }); 
```

此 Ajax 请求请求正确的页面。在那个页面上有一个 MySQLi 查询，它也执行得很好。问题是我想在完成查询后重新加载显示点的正确 div。当它重新加载 div 时，我看不到任何变化。关于我能做什么的任何建议？我是这样的 ajax 调用的新手。我可以对（数据）响应做一些事情，但这是否意味着我必须为这个请求编写一个单独的 php 文件？

编辑：上面的代码有效。它执行 MySQL 查询并更新数据库。.load(); 功能也有效！当我尝试 .load('someotherfile.php'); 它显示另一个文件。问题是：当我尝试重新加载当前模块（skill_table.php）时，它显示旧值而不是更新值。我希望这个解释好一点。

它使用新的数据库值重新加载 Skill_table.php 模块，但它显示旧的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:57:52.837

这是一个更完整的示例，说明如何发出有效的 POST 请求并在 AJAX 中捕获响应并一次性返回。这只是许多方法之一，请注意这个例子是模糊的。请向它学习并根据您的需要塑造它。

**您的 AJAX 请求**

```
$.post(
    // This is the URL your posting to
    'index.php?page=profile', 
    // This is the JSONified version of your post data
    {
        "username":username,
        "name":name,
        "count":count,
        "message_id":message_id
    }, 
    // Handling your response here
    function(returnString) {
        // Check to ensure your php code worked
        if(returnString.success === 1) {
            // Insert your new DOM
            $('#skills').html(returnString.response);
        } else {
            // Send error message here
            window.alert('Oh noes! The world is ending!');
            // alertnatively
            //window.alert('Error:' + returnString.response);
        }
    }
); 
```

**假设的 PHP 文件**

```
header("Content-type: application/json");

$mysqli->doMyAwesomeMySQLQueryHere();
$success = ($DidMyQueryWork) ? true : false;

echo json_encode(
        array(
            'success' => $success, 
            'response' => 'Your DOM Here'
        )
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-17T09:37:14.540

.load 正在从缓存中提取。如果这是一个 GET 请求，您可以告诉它不要使用缓存，但由于您正在发布，您必须在加载的 URL 的末尾添加一些任意随机元素。尝试这个：

```
 $.ajax({
    type: "POST",
    url: "index.php?&page=profile",
    data: dataString,
    success: function() {
        $('#skills').load('./modules/skill_table.php?_=' + (new Date()).getTime();
    }
    }); 
```

此外，由于您使用的是 jQuery，请查看 .serialize() 以帮助从数组构造您的 dataStrings。

[http://api.jquery.com/serialize/](http://api.jquery.com/serialize/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T16:23:30.800

最好在 ajax 响应中发送表格或 html（只发送一个请求）：

```
$.ajax({
  type: "POST",
  url: "index.php?page=profile",
  data: dataString,
  async:false,
  success: function(data) {
      $('#skills').html(data);
  }
}); 
```

**索引.php：**

```
include('./modules/skill_table.php'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T16:16:25.503

您需要正确构造数据参数。IE，让 jQuery 构造它：

```
$(this).html('Thank you for granting EXP!');    
    $.ajax({
    type: "POST",
    url: "index.php?&page=profile",
    data: {'username' : username, 'name' : name, 'count' : count, 'message_id' = message_id },
    success: function() {
        $('#skills').load('./modules/skill_table.php');
    }
}); 
```

# php - PHP 中的序数

> ID：14321845
> 
> 赞同：0
> 
> 时间：2013-01-14T15:53:11.087
> 
> 标签：php, numbers, ordinal

我需要像上面那样进行输出，但是如何添加数字，我可以用 <ol> 做，但这不是我需要的，<ol> 标签给了我不同的顺序..知道如何制作这个并在链接之前添加数字?

```
1\. Site.com      6\. Site.com
2\. Site.com      7\. Site.com
3\. Site.com      8\. Site.com
4\. Site.com      9\. Site.com
5\. Site.com     10\. Site.com 
```

这是php代码

```
<?
$list = $my_db->fetch("SELECT " . MY_PREFIX . "list.id, name,address, in_hits, out_hits FROM " . MY_PREFIX . "list LEFT JOIN " . MY_PREFIX . "sites ON " . MY_PREFIX . "list.id=" . MY_PREFIX . "sites.id WHERE status >0 AND status <3 ORDER BY in_hits DESC LIMIT 9");

$count = 1;

echo "<ul>";
foreach($list as $site) {;?>
<li><a href="<?php echo "/out.php?url=" . $site["address"];?>" target="_blank" rel="nofollow" title="<?php echo htmlentities(stripslashes($site["name"]));?>"><?php echo htmlentities(stripslashes($site["name"]));?></a></li>

<?
if ($count == 5) {echo "</ul><ul>";}
$count++;
}
echo "</ul>";
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:56:33.507

使用`start`属性

```
<ol start="6">
    <li>anything</li>
</ol> 
```

或者您可以使用应用于一个有序列表的css（*多列属性）*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T16:03:57.127

如何使用一些计数器：

```
<?
$list = $my_db->fetch("SELECT " . MY_PREFIX . "list.id, name,address, in_hits, out_hits FROM " . MY_PREFIX . "list LEFT JOIN " . MY_PREFIX . "sites ON " . MY_PREFIX . "list.id=" . MY_PREFIX . "sites.id WHERE status >0 AND status <3 ORDER BY in_hits DESC LIMIT 9");

$count = 1;
echo "<ul>";
foreach($list as $site) {;?>
<li><a href="<?php echo "/out.php?url=" . $site["address"];?>" target="_blank" rel="nofollow" title="<?php echo htmlentities(stripslashes($site["name"]));?>"><?php echo $count ?>. <?php echo htmlentities(stripslashes($site["name"]));?></a></li>

<?
if ($count % 5 == 0) {echo "</ul><ul>";}
$count++;
}
echo "</ul>";
?> 
```

我也将行更改`if ($count == 5)`为`if ($count % 5 == 0)`. 所以每 5 行都会开始一个新的列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T16:01:42.917

尝试类似的东西

```
foreach($list as $site) {;?>
<li><a href="<?php echo "/out.php?url=" . $site["address"];?>" target="_blank" rel="nofollow" title="<?php echo htmlentities(stripslashes($site["name"]));?>">

    <?php
    $i=1;
    $j=6
    if(count<=5){
    echo .$i.'.'.htmlentities(stripslashes($site["name"]));$i++;

    }else{
    echo .$j.'.'.htmlentities(stripslashes($site["name"]));$j++;
    }
    ?>
    </a></li> 
```

其余代码保持不变

# ios - 从 iBook 获取文件/文档目录到我的应用程序

> ID：14321847
> 
> 赞同：1
> 
> 时间：2013-01-14T15:53:14.580
> 
> 标签：ios, xcode

> **可能重复：**
> [从 iBooks 获取 pdf 到我的应用程序](https://stackoverflow.com/questions/5866515/fetch-pdf-from-ibooks-to-my-app)

我需要列出 iBook 目录中的文件。iPad 设备中的 iBook 文件/文档路径（目录）是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T15:56:08.590

这是不可能的。为安全起见，应用程序不得接触彼此的文档目录。

# javascript - JavaScript - 从数组中的多个输入中获取值

> ID：14321862
> 
> 赞同：5
> 
> 时间：2013-01-14T15:54:08.340
> 
> 标签：javascript, input

我试图从数组中具有相同 id 的多个输入中获取值。我已经使用了论坛，但没有找到适合我的解决方案。

示例

```
<input type="hidden" value="'+image_url+'" name="webcampics[]" id="webcampics">
<input type="hidden" value="'+image_url+'" name="webcampics[]" id="webcampics">
<input type="hidden" value="'+image_url+'" name="webcampics[]" id="webcampics">
<input type="hidden" value="'+image_url+'" name="webcampics[]" id="webcampics">

  var elem = document.getElementById("webcampics");
  var names = [];
  for (var i = 0; i < elem.length; ++ i) {
     names += elem[i]+'|';
  }
  var webcamval = names; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-14T15:59:18.453

您不应该在文档中包含具有相同*ID 的元素。*`ID`必须按照规范在整个标记中是唯一的。如果你仍然这样做，例如，方法`document.getElementById`只会匹配第一次出现。

使用 a`class`而不是`ids`.

```
<input type="hidden" value="'+image_url+'" name="webcampics[]" class="webcampics">
<input type="hidden" value="'+image_url+'" name="webcampics[]" class="webcampics">
<input type="hidden" value="'+image_url+'" name="webcampics[]" class="webcampics">
<input type="hidden" value="'+image_url+'" name="webcampics[]" class="webcampics">

var inputs = document.getElementsByClassName( 'webcampics' ),
    names  = [].map.call(inputs, function( input ) {
        return input.value;
    }).join( '|' ); 
```

**演示**：http: [//jsfiddle.net/QgJrq/](http://jsfiddle.net/QgJrq/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T15:58:43.543

您要求的错误非常错误，建议 ID 应该是 unqiue，但是为了学习者，这就是您要执行的操作

```
 var elem = document.getElementsByTagName("input");
  var names = [];
  for (var i = 0; i < elem.length; ++i) {
    if (typeof elem[i].attributes.id !== "undefined") {
      if (elem[i].attributes.id.value == "webcampics") {
        names.push(elem[i].value);
      }
    }
  }
  var webcamval = names; 
```

## [http://jsfiddle.net/5vamG/](http://jsfiddle.net/5vamG/)

由于有人在充分解释为什么上述方法是错误的后投票否决，但是完全按照您的要求进行，这是正确的方法。

将所有输入 id 更改为 class

```
 var elem = document.getElementsByClassName("webcampics");
  var names = [];
  for (var i = 0; i < elem.length; ++i) {
    if (typeof elem[i].value !== "undefined") {
        names.push(elem[i].value);
      }
    }
  }
  var webcamval = names; 
```

## [http://jsfiddle.net/5vamG/1/](http://jsfiddle.net/5vamG/1/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-14T16:01:35.923

1.  你不应该有多个相同的元素`id`。

2.  `getElementById`只返回一个元素；使用`getElementsByName`它将返回您寻找的列表。

# python - 浮点值等于 -1.#IND

> ID：14321866
> 
> 赞同：1
> 
> 时间：2013-01-14T15:54:19.750
> 
> 标签：python, floating-point, python-2.5

一个函数返回一个`list`包含值的`float`值。如果我绘制这个列表，我会看到一些`float`值是 equal `-1.#IND`。我还检查了这些`-1.#IND`值的类型。它们也是`float`类型。但是我怎么能理解这个`-1.#IND`值呢？它们代表什么或代表什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T16:42:33.910

`-1.#IND`表示不确定，即没有解的浮点方程的结果。在其他平台上，你会得到`NaN`，意思是“不是数字”，`-1.#IND`是特定于 Windows 的。在 Linux 上的 Python 2.5 上，我得到：

```
>>> 1e300 * 1e300 * 0
-nan 
```

您只能在 Windows 平台上的 python 2.5 及之前版本上找到它。该`float()`代码在[python 2.6](http://bugs.python.org/issue1635)中得到了改进，并始终`float('nan')`用于此类结果；主要是因为没有办法再次变成一个实际的`1.#INF`实例：`-1.#IND``float()`

```
>>> repr(inf)
'1.#INF'
>>> float(_)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: invalid literal for float(): 1.#INF
>>> repr(nan)
'-1.#IND'
>>> float(_)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: invalid literal for float(): -1.#IND 
```

在 2.6 及更高版本上，这一切都已清理并保持一致：

```
>>> 1e300 * 1e300 * 0
nan
>>> 1e300 * 1e300
inf
>>> 1e300 * 1e300 * -1
-inf 
```

# asp.net - ASP.NET MVC 4 角色

> ID：14321868
> 
> 赞同：0
> 
> 时间：2013-01-14T15:54:21.850
> 
> 标签：asp.net, asp.net-mvc-4, asp.net-roles

在 MVC 4 中管理角色的最佳方式是什么？我找到了这个教程：

[http://www.asp.net/mvc/tutorials/mvc-music-store/mvc-music-store-part-7](http://www.asp.net/mvc/tutorials/mvc-music-store/mvc-music-store-part-7)

但我想灵活一点，让后台用户有权为注册用户创建和分配角色。

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T16:06:21.500

该教程中提到的 ASP.NET 配置站点甚至不适用于`SimpleMembershipProvider`.

您将需要一些自定义页面来执行以下操作：

*   列出用户
*   创建/编辑用户，您可以在其中显示角色列表。

然后您可以使用内置函数，例如：

```
Roles.RoleExists(role)
Roles.CreateRole(role);
Roles.IsUserInRole(username, role)
Roles.AddUserToRole(username, role); 
```

这假定您使用的是内置提供程序和 ASP.NET 生成的数据表。您还可以从`RoleProvider`类继承并实现自己的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:59:23.703

我不认为该框架为管理用户和角色提供了开箱即用的解决方案。然而，它应该很容易推出你自己的，特别是如果你使用新的 SimpleMembership 提供者。

也可以看一下[SecurityGuard](https://github.com/kahanu/Security-Guard)项目，看起来挺不错的，不过我还没试过。

# timer - Linux 内核定时器函数在什么上下文中运行？

> ID：14321869
> 
> 赞同：12
> 
> 时间：2013-01-14T15:54:22.120
> 
> 标签：timer, linux-kernel, kernel

当使用 API 创建的计时器`add_timer`到期并且在计时器结构中分配的函数运行时，它在什么上下文中运行？它是中断上下文还是某些内核进程上下文？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-16T02:49:56.707

它当然是在中断上下文中，更准确地说，在 softirq 上下文中，见下文（kernel/timer.c）：

```
static inline void __run_timers(struct tvec_base *base)
{
        struct timer_list *timer;

        spin_lock_irq(&base->lock);
        while (time_after_eq(jiffies, base->timer_jiffies)) {
                struct list_head work_list;
                struct list_head *head = &work_list;
                int index = base->timer_jiffies & TVR_MASK;

                /*
                 * Cascade timers:
                 */
                if (!index &&
                        (!cascade(base, &base->tv2, INDEX(0))) &&
                                (!cascade(base, &base->tv3, INDEX(1))) &&
                                        !cascade(base, &base->tv4, INDEX(2)))
                        cascade(base, &base->tv5, INDEX(3));
                ++base->timer_jiffies;
                list_replace_init(base->tv1.vec + index, &work_list);
                while (!list_empty(head)) {
                        void (*fn)(unsigned long);
                        unsigned long data;
                        bool irqsafe;

                        timer = list_first_entry(head, struct timer_list,entry);
                        fn = timer->function;
                        data = timer->data;
                        irqsafe = tbase_get_irqsafe(timer->base);

                        timer_stats_account_timer(timer);

                        base->running_timer = timer;
                        detach_expired_timer(timer, base);

                        if (irqsafe) {
                                spin_unlock(&base->lock);
                                call_timer_fn(timer, fn, data); // <=========== HERE
                                spin_lock(&base->lock);
                        } else {
                                spin_unlock_irq(&base->lock);
                                call_timer_fn(timer, fn, data); // <============ HERE
                                spin_lock_irq(&base->lock);
                        }
                }
        }
        base->running_timer = NULL;
        spin_unlock_irq(&base->lock);
}

/*
 * This function runs timers and the timer-tq in bottom half context.
 */
static void run_timer_softirq(struct softirq_action *h)
{
        struct tvec_base *base = __this_cpu_read(tvec_bases);

        hrtimer_run_pending();

        if (time_after_eq(jiffies, base->timer_jiffies))
                __run_timers(base);
}

void __init init_timers(void)
{
        int err;

        /* ensure there are enough low bits for flags in timer->base pointer */
        BUILD_BUG_ON(__alignof__(struct tvec_base) & TIMER_FLAG_MASK);

        err = timer_cpu_notify(&timers_nb, (unsigned long)CPU_UP_PREPARE,
                               (void *)(long)smp_processor_id());
        init_timer_stats();

        BUG_ON(err != NOTIFY_OK);
        register_cpu_notifier(&timers_nb);
        open_softirq(TIMER_SOFTIRQ, run_timer_softirq); // <============= HERE
} 
```

# jquery - 事件接事件接事件发生

> ID：14321871
> 
> 赞同：1
> 
> 时间：2013-01-14T15:54:24.527
> 
> 标签：jquery

我会一个接一个地制作这个代码。这是可能的？

```
$('#carouselselectitem1').click(function() {
    $('#foo2').animate({opacity: "0"}, function() {
        $(this).load("carousel/todos.html");
        $('#foo2').animate({"opacity":"1"});
        $('#carouselselectitem1').css({'background-color' : '#FF0000' , 'opacity' : '1'});
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:59:03.037

如果我正确理解您的问题，则必须使用回调函数：

```
$('#carouselselectitem1').click(function() {
    $('#foo2').animate({opacity: "0"}, function() {
        $(this).load("carousel/todos.html", function() {
            $('#foo2').animate({"opacity":"1"}, function() {
                $('#carouselselectitem1').css({'background-color' : '#FF0000' , 'opacity' : '1'});                          
            });
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T16:01:43.873

只是测试它：

```
$('#carouselselectitem1').click(function() {
    $('#foo2').animate({opacity: "0"},1000 , function() {
        $(this).load("carousel/todos.html");
        $('#foo2').animate({"opacity":"1"},1000,function(){
             $('#carouselselectitem1').css({'background-color' : '#FF0000' , 'opacity' : '1'}); 
        });
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T16:04:31.663

您需要对该`load`函数使用回调以及其他回调。我还建议缓存选择器。

```
$('#carouselselectitem1').click(function(){
  var carousel = $(this),
      foo2     = $('#foo2');
  foo2.animate({opacity: "0"}, function(){
    foo2.load("carousel/todos.html", function(){
      foo2.animate({opacity:"1"}, function(){
        carousel.css({'background-color' : '#FF0000','opacity' : '1'});
      });
    });
  });
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-14T15:59:57.530

您可以使用 jQuery 触发事件。看这里： [Trigger Event](http://api.jquery.com/trigger/)底部有一个例子，button_2在button_1上触发点击事件

# javascript - getJSON 不工作/phonegap.plist 未找到

> ID：14321872
> 
> 赞同：0
> 
> 时间：2013-01-14T15:54:24.890
> 
> 标签：javascript, xcode, api, cordova, getjson

我最近下载了 XCode4.5.2 和 PhoneGap2.3.0 和 Cordova 2.3.0 来开发一个 iOS 应用程序。我试图使用这个函数从维基百科 API 中获取一些数据：

```
<!DOCTYPE html>
   <html>
     <head>

        <script type="text/javascript" src="cordova-2.3.0.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

        <script>
         function get_data(){

                var query = 'Ocean';
                var url = 'http://en.wikipedia.org/w/api.php?callback=?&action=parse&format=json&page='+query+'&prop=text';
                alert(url);

                $.getJSON(url,function(response){
                          alert('Here!');
                          });

                       };

        </script>

        </head>
        <body>
        <input type="button" value="search" onclick="get_data()"   />
        </body>
   </html> 
```

但是，我无法完成这项工作。alert(url) 工作正常，但 alert('Here!') 不行。问题似乎出在 PhoneGap 中的 getJSON 函数上。

我在一些帖子中读到，解决方案可能是“将您的域添加到 phonegap.plist 的 ExternalHosts 部分”或“在 config.xml 文件中放置适当的访问标签”。我在这个 2.3.0 版本的 Cordova 中找不到 phonegap.plist 文件（它存在吗？！）。只有 config.xml （我已经确认有`<access origin="*" />`）。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T00:12:55.307

1.  据我所知，getJSON 是一个 jQuery 函数，为什么不包含 jQuery 的 js 文件？
2.  你的函数调用者在哪里？如果您希望它在负载时运行，请使用

    $(函数(){ get_data(); }

# java - Java URL 编码：URLEncoder 与 URI

> ID：14321873
> 
> 赞同：23
> 
> 时间：2013-01-14T15:54:25.563
> 
> 标签：java, url, urlencode

查看[W3 Schools URL 编码网页](http://www.w3schools.com/tags/ref_urlencode.asp)，它说`@`应该编码为`%40`，`space`应该编码为`%20`。

我都尝试过`URLEncoder`and `URI`，但以上都没有正确：

```
import java.net.URI;
import java.net.URLEncoder;

public class Test {
    public static void main(String[] args) throws Exception {

        // Prints me%40home.com (CORRECT)
        System.out.println(URLEncoder.encode("me@home.com", "UTF-8"));

        // Prints Email+Address (WRONG: Should be Email%20Address)
        System.out.println(URLEncoder.encode("Email Address", "UTF-8"));

        // http://www.home.com/test?Email%20Address=me@home.com
        // (WRONG: it has not encoded the @ in the email address)
        URI uri = new URI("http", "www.home.com", "/test", "Email Address=me@home.com", null);
        System.out.println(uri.toString());
    }
} 
```

出于某种原因，`URLEncoder`电子邮件地址是否正确但不是空格，并且`URI`是否空格货币但不是电子邮件地址。

我应该如何编码这两个参数以与 w3schools 所说的正确（或者 w3schools 错误？）

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-01-20T12:59:10.217

尽管我认为@fge 的答案是正确的，因为我使用的是依赖于 W3Schools 文章中概述的编码的第 3 方 Web 服务，但我遵循了[Java 的答案，相当于 JavaScript 的 encodeURIComponent 产生相同的输出？](https://stackoverflow.com/questions/607176/java-equivalent-to-javascripts-encodeuricomponent-that-produces-identical-outpu)

```
public static String encodeURIComponent(String s) {
    String result;

    try {
        result = URLEncoder.encode(s, "UTF-8")
                .replaceAll("\\+", "%20")
                .replaceAll("\\%21", "!")
                .replaceAll("\\%27", "'")
                .replaceAll("\\%28", "(")
                .replaceAll("\\%29", ")")
                .replaceAll("\\%7E", "~");
    } catch (UnsupportedEncodingException e) {
        result = s;
    }

    return result;
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-01-14T16:03:04.940

URI 语法由[RFC 3986](https://www.rfc-editor.org/rfc/rfc3986)定义（查询字符串的允许内容在第 3.4 节中定义）。Java`URI`遵守此 RFC，在其[Javadoc](http://docs.oracle.com/javase/7/docs/api/java/net/URI.html)中提到了一些注意事项。

您会注意到`pchar`语法规则由以下内容定义：

> pchar = unreserved / pct-encoded / sub-delims / ":" / "@"

这意味着 a在查询字符串中`@`是**合法的。**

信任 URI。它*会*做正确的、“合法的”事情。

最后，如果您查看[URLEncoder 的 Javadoc](http://docs.oracle.com/javase/7/docs/api/java/net/URLEncoder.html)，您会看到它声明：

> 此类包含用于将 String 转换为 application/x-www-form-urlencoded MIME 格式的静态方法。

这*与*URI 规范定义的查询字符串不同。

# css - CSS：为什么图像没有显示在顶部（z-index）？

> ID：14321875
> 
> 赞同：0
> 
> 时间：2013-01-14T15:54:31.857
> 
> 标签：css, z-index

我有一个清单，如下所示：

```
<ul id="categoryTabsId" class="categoryTabs">
    <li onclick="tabs(this);" class="selected" id="tab1">
       <span class="tab-one">
           <img src="http://www.dot.ca.gov/hq/jobs/images/number1_icon.jpg" />    
       </span>
       some text
    </li>
</ul> 
```

操纵图像位置的 CSS 是：

```
position: relative;
top: 0;
left: -20px; 
```

CSS将图像移动到正确的位置，但图像没有完全显示，似乎图像的一部分在其他东西后面。我尝试使用 z-index: 999999999 但这不会改变任何事情。为什么图像不在具有如此高 z-index 的所有内容之上？

谢谢！

# c++ - 调用基本方法模板子类

> ID：14321876
> 
> 赞同：1
> 
> 时间：2013-01-14T15:54:34.800
> 
> 标签：c++, templates

我遇到了一个问题，我最终将其简化为这个简单的示例：

```
template <int dimensions> class Base {
    protected:
        Base(void) {}
    public:
        virtual ~Base(void) {}

        void base_method(void) {}
};
template <int dimensions> class MyClass : public Base<dimensions> {
    public:
        MyClass(void) : Base<dimensions>() {
            base_method();
        }
        ~MyClass(void) {}
}; 
```

这在 MSVC 2010 上编译得很好，但在 g++ 4.6 上失败：

```
main2.cpp: In constructor âMyClass<dimensions>::MyClass()â:
main2.cpp:12:16: error: there are no arguments to âbase_methodâ that depend on a template parameter, so a declaration of âbase_methodâ must be available [-fpermissive]
main2.cpp:12:16: note: (if you use â-fpermissiveâ, G++ will accept your code, but allowing the use of an undeclared name is deprecated) 
```

这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:59:36.933

您必须显式调用`Base<dimensions>::base_method()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T16:00:39.763

你所要做的：

```
this->base_method(); 
```

或者

```
Base<dimension>::base_method(); 
```

编译器通常不会考虑模板化基类中的方法来进行函数解析。

# css - ::after on :hover 在 IE 中不起作用

> ID：14321878
> 
> 赞同：11
> 
> 时间：2013-01-14T15:54:41.757
> 
> 标签：css, internet-explorer, pseudo-element

我在 Internet Explorer 中发现了一些奇怪的行为（IE10 以及在模拟所有支持的版本时`::after`）。将伪元素应用于元素的悬停状态时 ( `.element:hover::after`) 它在 IE 中不起作用，但在所有其他主要浏览器中都起作用。

[http://jsfiddle.net/BramVanroy/9jpeZ/1/](http://jsfiddle.net/BramVanroy/9jpeZ/1/)

```
#d1::after { /* Works in IE */
  content: "no hover needed";
  border: 1px solid blue;
  display: block;
}

#d2:hover::after { /* Does not work in IE */
  content: "Y U NO WORK IN IE";
  border: 1px solid blue;
  display: block;
} 
```

是否有可用的 CSS 修复程序？（没有 JS/jQuery。）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-14T17:13:45.467

这似乎是 IE10 中的一个错误（即使它模拟其他版本）。

不过，我找到了解决方法。如果您为 添加一个空的 CSS 规则`#d2:hover`，那么它将[按此 JSFiddle](http://jsfiddle.net/W45kU/)`#d2:hover::after`所示进行侦听。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-06T16:04:08.863

我有一个实例，这在 IE 中也不起作用，当我在样式表中切换“：悬停”和“：之后”的顺序时

```
 .myclassname::after:hover 
```

到

```
 .myclassname:hover::after 
```

I was able to get the desired result, all the way back to IE9 (didn't test anything lower)

# jsp - 在jsp中读取文本输入

> ID：14321882
> 
> 赞同：2
> 
> 时间：2013-01-14T15:54:54.953
> 
> 标签：jsp, httprequest, textinput

我想知道在 jsp 页面上阅读文本输入的最佳方法是什么？谁能告诉VS分隔的两个java代码有什么区别？

```
 <input type=text id=myInput value="myInput">
  <%
        String data = request.getParameter("myinput");
   //VS
        request.setAttribute("myInput", data);  

  %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T16:41:14.397

我想你想要一个 request`attribute`和`parameter`.

请求`parameter`始终是 a `String`（即它们始终由`String`偶数、布尔值、浮点数等表示，例如：“1”、“1.1”、“true”）并且在某个 URL 中，例如：`http://google.com/search?q=question&cat=images` `q`并且`cat`被称为`parameters`or`query parameters`和它们的值是`question`和`images`分别。这是`GET`请求的示例。 `POST`请求参数将是通过 html 提交的参数`<form>`。

现在 request`attributes`是对象而不是`parameters`. 并且它们的值只能通过使用来设置，`request.setAttribute("myInput", data);`这里`data`可以是类的一个`String`、实例或对象`Person`等，简而言之`data`就是一个对象。

还有一个区别是你没有方法没有这样的方法，所以只有在提交 html 或 URL 包含上述`request.setParameter("myinput", data);`参数时才设置请求参数。`<form>`

现在`parameters`你可以得到它们：

```
String data = request.getParameter("myinput");` 
```

即使值 of`"myInput"`可能是`int`or `boolean`。

对于属性，您可以将它们获取为：

```
String data = (String) request.getAttribute("myInput");` // if "myInput" is a String
Person data = (Person) request.getAttribute("myInput");`  // if "myInput" is an instance of Person class
Long data = (Long) request.getAttribute("myInput");`  // if "myInput" is a Long 
```

所以现在你知道这两种代码有什么不同了，一种是从请求参数（`request.getParameter()`）中读取值，另一种是从请求属性（`request.getAttribute()`）中读取值。

如果这不是你想要的，请告诉我。

# java - 请求：Spring 配置的 CXF ws 客户端——替换硬编码变量，如“地址”

> ID：14321884
> 
> 赞同：2
> 
> 时间：2013-01-14T15:54:59.277
> 
> 标签：java, web-services, spring, cxf, configurable

我必须联系 Web 服务 (WS)。我正在使用 JDK 1.6、maven 3.04、Spring 3.20 和 apache 的 CXF 2.7.2。使用 maven，我通过提供 wsdl 文件为 WS 创建了存根。我有一个用于 WS 客户端的 spring 配置，它看起来像

servlet-context.xml

```
<jaxws:client id="paymentClient" serviceClass="com.xxx.payment.Payment"
    address="http://127.0.0:8088/mockPaymentBinding" <!-- SOAPUI mock -->
    username="username"
    password="secret" />
<!- username and password are for wsdl basic authentication --> 
```

在 Java 代码中，它看起来像

```
@Autowired 
com.xxx.payment.Payment client;
..
// Set all needed parameters.
PaymentGetBalanceResponse response = null;
PaymentGetBalance getBalance = new PaymentGetBalance();
RequestGetBalance value = new RequestGetBalance();
value.setTransactionId("transActionId");
getBalance.setRequest(value );

// Now call the WS and get the response
response = client.getBalance(getBalance); // generated by the cxf -client argument. 
```

“响应”行由 CXF 作为示例生成。然后 Eclipse 告诉我缺少某些东西（getbalance），并可以选择在线上方为我创建它。然后其他东西（价值）缺失等等。最后，所有参数都正确填写。所有缺少的东西/变量/对象都在生成的存根代码中。

这就像一个魅力，但地址是在 spring 配置中硬编码的 atm。应用程序的配置参数存储在一个简单的数据库中。使用 spring bean 可以访问内容，因此我可以使用 config.getValue(URL); 之类的东西在代码的最后获取变量；

我希望能够更改上面代码中的“地址”（url WS），但还没有找到方法。在生成的存根代码中找不到设置器。另一种方法是在 spring servlet-context.xml 文件中使用变量，但这些变量必须来自数据库。第二种选择。我可能/希望从底部开始并使用 Objectfactorys（在存根中）来创建对象。然后设置正确的参数（在“新”或设置器中），然后按我的方式到达顶部。一位同事已经这样做了（不是为了“地址”），这似乎可行，但代码充其量是次优/“混乱”。我还希望能够配置用户名和密码，而不是静态的。在 CXF 网站上做了很多 RTM，但无济于事。

阅读有关 JaxWsProxyFactoryBean 的一些内容，但由于我使用 Springs @autowire 功能，所以不知道如何在此处应用它。

我一直在为这个问题绞尽脑汁，但似乎我的神经元在转圈。任何帮助/指针都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T18:51:20.713

来自 CXF 用户指南：[**如何覆盖服务地址？**](https://stackoverflow.com/questions/14321884/req-spring-configured-cxf-ws-client-replacing-hardcoded-variables-like-addr).

如果我正确推断了弹簧配置，我认为这会：

```
 @Autowired
   com.xxx.payment.Payment client;
   // ... 
   BindingProvider provider = (BindingProvider)client.getServicePort();
   // You can set the address per request here
   provider.getRequestContext().put(
        BindingProvider.ENDPOINT_ADDRESS_PROPERTY,
        "http://my/new/url/to/the/service"); 
```

# inversion-of-control - Castle.Windsor 拦截器的生活方式

> ID：14321885
> 
> 赞同：2
> 
> 时间：2013-01-14T15:55:08.057
> 
> 标签：inversion-of-control, castle-windsor, ioc-container, interceptor

在我的 [Webmethod] 中，我有这样的代码。

```
var something = container.ResolveSomething();
something.Run();
```

除一个之外的所有注册组件都将生活方式定义为 PerWebRequest。一个注册为 Singleton（记录器）。对于我定义和配置的一些组件，拦截器将记录方法调用及其结果。

我的问题是：如果我用 Lifestyle PerWebRequest 注册这个拦截器会有问题吗？如果我们真的确定要这样做，[文档建议可以使所有拦截器瞬变并使用其他生活方式。](http://docs.castleproject.org/Default.aspx?Page=Interceptors&NS=Windsor&AspxAutoDetectCookieSupport=1)如果我用生活方式 Transient 注册拦截器，我的大约 100 种方法中的任何一种都必须看起来像这样。

```
IComponent component = null;
try
{
    component = container.ResolveComponent();
    compoment.Run();
}
finally
{
    container.Release(component);
} 
```

所以更多的样板而不是真正的代码。

这是我的拦截器：

```
public class LoggingInterceptor : IInterceptor
{
    private readonly ILogger logger;

    public LoggingInterceptor(ILogger logger)
    {
        this.logger = logger;
    }

    public void Intercept(IInvocation invocation)
    {
        var call = string.Format("{0}.{1}({2})", invocation.TargetType.FullName, invocation.Method.Name, string.Join(", ", invocation.Arguments.Select(arg => arg.ToString()).ToArray()));

        try
        {
            logger.Info(call);
            invocation.Proceed();

            logger.Info("Result: " + call + " = " + invocation.ReturnValue);
        }
        catch (Exception e)
        {
            logger.Error(call, e);
            throw;
        }
    }
} 
```

我知道 WCF 更适合 IoC，但我必须使用 ASP.NET WebServices。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T13:23:50.980

我的理解是，即使拦截器是瞬态的，它的生命周期也与被拦截的组件绑定。它将与被拦截的组件一起释放，因为它被容器跟踪。

# math - 按比例标准化

> ID：14321887
> 
> 赞同：0
> 
> 时间：2013-01-14T15:55:10.327
> 
> 标签：math, normalize

我有一个二维数据数组（**C**），其中**C(:,1)**的值对应于**C(:,2)**。**C(:,2)**从 0.0001:0.0001:1 变化，即 10,000 个值。我需要计算**d(log(C(i,1))) / d(log(C(i,2)))**，我只需计算**log(C(i,1)) / log(C (i,2))**。但是当 C(i,2) 接近 1 时，分母接近 0，并且商会上升。控制这一点的一种方法是使用参数对其进行规范化，但我不确定如何做到这一点。有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T06:28:29.507

由于这是离散的微分，因此答案肯定会有些不雅。

您对导数 d(log(C(i,1))) / d(log(C(i,2))) 感兴趣

```
=∆(log(C(i,1))) / ∆(log(C(i,2)))

=(log(C(i+1,1))-log(C(i,1))) / (log(C(i,2)) - log(C(i,2))) 
```

这是易处理的。分母不为零，而是步长（0.0001）。

# bluetooth - 低功耗蓝牙双模

> ID：14321892
> 
> 赞同：3
> 
> 时间：2013-01-14T15:55:39.900
> 
> 标签：bluetooth, core-bluetooth, bluetooth-lowenergy

蓝牙双模设备是否可以在与 BT LE 设备配对的同时被经典蓝牙发现？如果设备不能同时使用这两种模式也没关系，但我真的应该在这些模式之间切换芯片吗？我只是在 BT 4 核心规范中找不到答案

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T16:31:47.503

是的，在连接到 LE 设备时，可以通过经典蓝牙发现双模设备。该设备也可以同时连接到经典和LE（设备将时间复用，以便同时在经典和LE上保持操作）

# jquery - 需要使用谷歌地图 API 在页面加载时提取结果

> ID：14321894
> 
> 赞同：0
> 
> 时间：2013-01-14T15:55:42.747
> 
> 标签：jquery, google-maps

我需要在页面加载时显示结果（基于当前位置的酒吧和商店）。如果我提交表单，它目前可以工作，但我试图让它在页面加载时工作。

我正在尝试以下内容：

```
 $(document).ready(function(){
      $.post("<?= site_url('stockists/search'); ?>", {location: coords});
  }); 
```

coords 是一个包含当前位置的变量

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:58:20.703

如果您在本地计算机上执行此操作，您的浏览器可能会阻止它（检查控制台）。如果没有，请尝试稍微延迟一下...

```
setTimeout(function(){
    $.post("<?= site_url('stockists/search'); ?>", {location: coords});
},500); 
```

# box-api - 为 Box 企业用户移动内容

> ID：14321896
> 
> 赞同：0
> 
> 时间：2013-01-14T15:55:51.053
> 
> 标签：box-api

在以前的 V2 API 迭代中，我认为在 V1 API 中，企业管理员可以在企业帐户中将内容从一个用户移动到另一个用户。这可以通过 V2 API 实现吗？我似乎无法找到实现这一目标的方法。

理想情况下，当我们发现某个用户离开公司时，我想将所有内容从一个用户重新分配给另一个用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T20:42:32.367

是的，这可以通过[将文件夹移动到另一个用户的文件夹](http://developers.box.com/docs/#users-move-folder-into-another-folder)功能来实现。

# asp.net-web-api - 请求/确认模式 ASP.NET WebAPI

> ID：14321903
> 
> 赞同：1
> 
> 时间：2013-01-14T15:56:05.683
> 
> 标签：asp.net-web-api

WebAPI 是否有任何内置支持来启动一些工作并立即返回给调用者并确认。我正在寻找一个数据处理服务器，它有一些需要运行的长时间运行的进程。客户从不期望立即得到结果，并且可以稍后查询它们。

在这种情况下，我正在寻找一种方法来以不会阻止控制器返回的方式启动一些工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T02:36:24.533

WebAPI 中没有任何东西可以阻止您开始一些后台工作并立即返回。所以你可以像这样实现一个动作：

```
public HttpResponseMessage Post()
{
     Task.Factory.StartNew(() => DoWork());
     return new HttpResponseMessage(HttpStatusCode.Accepted);
} 
```

这只是一个简单的示例，但您可能希望在某种字典中跟踪任务，以便稍后在客户端查询结果时返回结果。

# python - 列表对象不可调用项目欧拉59

> ID：14321912
> 
> 赞同：-2
> 
> 时间：2013-01-14T15:56:21.600
> 
> 标签：python, typeerror

我正在尝试做项目 euler 问题 59，我遇到的问题是，当程序返回时，其中一种必要的方法将不起作用：

```
xorNum =  test(f,j)
TypeError: 'list' object is not callable. 
```

`f`和都是`j`整数，当我使用两个随机整数的测试方法时，它工作得很好。有谁知道为什么它可能不起作用？

```
def main():
    cipherText = """79,59,12,2,79,35,8,28,20,2,3,68,8,9,68,45,0,12,9,67,68,4,7,5,23,27,1,21,79,85,78,79,85,71,38,10,71,27,12,2,79,6,2,8,13,9,1,13,9,8,68,19,7,1,71,56,11,21,11,68,6,3,22,2,14,0,30,79,1,31,6,23,19,10,0,73,79,44,2,79,19,6,28,68,16,6,16,15,79,35,8,11,72,71,14,10,3,79,12,2,79,19,6,28,68,32,0,0,73,79,86,71,39,1,71,24,5,20,79,13,9,79,16,15,10,68,5,10,3,14,1,10,14,1,3,71,24,13,19,7,68,32,0,0,73,79,87,71,39,1,71,12,22,2,14,16,2,11,68,2,25,1,21,22,16,15,6,10,0,79,16,15,10,22,2,79,13,20,65,68,41,0,16,15,6,10,0,79,1,31,6,23,19,28,68,19,7,5,19,79,12,2,79,0,14,11,10,64,27,68,10,14,15,2,65,68,83,79,40,14,9,1,71,6,16,20,10,8,1,79,19,6,28,68,14,1,68,15,6,9,75,79,5,9,11,68,19,7,13,20,79,8,14,9,1,71,8,13,17,10,23,71,3,13,0,7,16,71,27,11,71,10,18,2,29,29,8,1,1,73,79,81,71,59,12,2,79,8,14,8,12,19,79,23,15,6,10,2,28,68,19,7,22,8,26,3,15,79,16,15,10,68,3,14,22,12,1,1,20,28,72,71,14,10,3,79,16,15,10,68,3,14,22,12,1,1,20,28,68,4,14,10,71,1,1,17,10,22,71,10,28,19,6,10,0,26,13,20,7,68,14,27,74,71,89,68,32,0,0,71,28,1,9,27,68,45,0,12,9,79,16,15,10,68,37,14,20,19,6,23,19,79,83,71,27,11,71,27,1,11,3,68,2,25,1,21,22,11,9,10,68,6,13,11,18,27,68,19,7,1,71,3,13,0,7,16,71,28,11,71,27,12,6,27,68,2,25,1,21,22,11,9,10,68,10,6,3,15,27,68,5,10,8,14,10,18,2,79,6,2,12,5,18,28,1,71,0,2,71,7,13,20,79,16,2,28,16,14,2,11,9,22,74,71,87,68,45,0,12,9,79,12,14,2,23,2,3,2,71,24,5,20,79,10,8,27,68,19,7,1,71,3,13,0,7,16,92,79,12,2,79,19,6,28,68,8,1,8,30,79,5,71,24,13,19,1,1,20,28,68,19,0,68,19,7,1,71,3,13,0,7,16,73,79,93,71,59,12,2,79,11,9,10,68,16,7,11,71,6,23,71,27,12,2,79,16,21,26,1,71,3,13,0,7,16,75,79,19,15,0,68,0,6,18,2,28,68,11,6,3,15,27,68,19,0,68,2,25,1,21,22,11,9,10,72,71,24,5,20,79,3,8,6,10,0,79,16,8,79,7,8,2,1,71,6,10,19,0,68,19,7,1,71,24,11,21,3,0,73,79,85,87,79,38,18,27,68,6,3,16,15,0,17,0,7,68,19,7,1,71,24,11,21,3,0,71,24,5,20,79,9,6,11,1,71,27,12,21,0,17,0,7,68,15,6,9,75,79,16,15,10,68,16,0,22,11,11,68,3,6,0,9,72,16,71,29,1,4,0,3,9,6,30,2,79,12,14,2,68,16,7,1,9,79,12,2,79,7,6,2,1,73,79,85,86,79,33,17,10,10,71,6,10,71,7,13,20,79,11,16,1,68,11,14,10,3,79,5,9,11,68,6,2,11,9,8,68,15,6,23,71,0,19,9,79,20,2,0,20,11,10,72,71,7,1,71,24,5,20,79,10,8,27,68,6,12,7,2,31,16,2,11,74,71,94,86,71,45,17,19,79,16,8,79,5,11,3,68,16,7,11,71,13,1,11,6,1,17,10,0,71,7,13,10,79,5,9,11,68,6,12,7,2,31,16,2,11,68,15,6,9,75,79,12,2,79,3,6,25,1,71,27,12,2,79,22,14,8,12,19,79,16,8,79,6,2,12,11,10,10,68,4,7,13,11,11,22,2,1,68,8,9,68,32,0,0,73,79,85,84,79,48,15,10,29,71,14,22,2,79,22,2,13,11,21,1,69,71,59,12,14,28,68,14,28,68,9,0,16,71,14,68,23,7,29,20,6,7,6,3,68,5,6,22,19,7,68,21,10,23,18,3,16,14,1,3,71,9,22,8,2,68,15,26,9,6,1,68,23,14,23,20,6,11,9,79,11,21,79,20,11,14,10,75,79,16,15,6,23,71,29,1,5,6,22,19,7,68,4,0,9,2,28,68,1,29,11,10,79,35,8,11,74,86,91,68,52,0,68,19,7,1,71,56,11,21,11,68,5,10,7,6,2,1,71,7,17,10,14,10,71,14,10,3,79,8,14,25,1,3,79,12,2,29,1,71,0,10,71,10,5,21,27,12,71,14,9,8,1,3,71,26,23,73,79,44,2,79,19,6,28,68,1,26,8,11,79,11,1,79,17,9,9,5,14,3,13,9,8,68,11,0,18,2,79,5,9,11,68,1,14,13,19,7,2,18,3,10,2,28,23,73,79,37,9,11,68,16,10,68,15,14,18,2,79,23,2,10,10,71,7,13,20,79,3,11,0,22,30,67,68,19,7,1,71,8,8,8,29,29,71,0,2,71,27,12,2,79,11,9,3,29,71,60,11,9,79,11,1,79,16,15,10,68,33,14,16,15,10,22,73"""

    asciiDict = {} #create ascii table dictionary with number as key
    asciiDict2 = {} #reverse key value of above dictionary
    for char in range(256):
        keyVal =  "%d: %c" % (char, char)           
        slicer = keyVal.index(':')
        key = keyVal[0:slicer]
        val = keyVal[slicer+2:]
        asciiDict[int(key)] = val

    for key in asciiDict.keys():
        newVal = asciiDict[key]
        asciiDict2[newVal] = key
    newlist = [int(n) for n in cipherText.split(',')] 
    #convert cipher text into list of numbers 
    listOfThreeChars = []
    for n in range(len(newlist)):
        listOfThreeChars.append(newlist[n:n+3]) 
        #create list of groups of three consecutive numbers in cipherText
    mostCommonDict = mostCommon(listOfThreeChars)
    mostFrequent3 = mostCommonDict[max(mostCommonDict.keys())] 
     #most common three consecutive numbers, if the key is right these 
     #numbers will become a common three letter word such as 'the'
    print testCipher(asciiDict,asciiDict2, 'jhd', mostFrequent3)

    def testCipher(asciiDict,asciiDict2, cipherKey, cipherExtract):
    cipherKeyAscii = []
    test = []
    output = []
    for k in cipherKey:
        asciiNum = asciiDict2[k]
        cipherKeyAscii.append(asciiNum)
    print cipherKeyAscii
    for i in range(len(cipherKeyAscii)):
        f,j = cipherKeyAscii[i],cipherExtract[i]
        print type(f), type(j),f,j
        xorNum =  test(f,j) #HERE IS WHERE THE PROBLEM IS
        test.append(xorNum)
    for final in test:
        letter = asciiDict[final]
        output.append(letter)
    return output

    def mostCommon(lst): #find most common three consecutive number combinations in text
    dic = {}
    for three in lst:
        key = three
        count = []
        for n in lst:
            if n == key:
                count.append(1)
        dic[len(count)] = key
    return dic
    #return max(set(sum(lst, [])), key=sum(lst, []).count)

    def toBinary(decimalNumber):
    quotient = 1
    remainder = 0
    tmpNum = decimalNumber
    finalNumberList = []
    n = ""
    #e.g. take 14...
    while quotient != 0:
        remainder = decimalNumber % 2 #14 % 2 = 0
        quotient = decimalNumber / 2 #14 / 2 = 7
        decimalNumber = quotient # 7 % 2 = 1 and so on...
        finalNumberList.insert( 0, remainder )
    # Used because all numbers are in a list, i.e. convert to string
    for num in finalNumberList:
        n += str( num )
    return n

    def XOR(number1, number2):
    number1List = []
    number2List = []
    XORoutput = []
    for i in str(number1): #turn both binary numbers into lists
        number1List.append(int(i))
    for i in str(number2):
        number2List.append(int(i))
    if len(number1List)>len(number2List): #make sure they are same lengths
        diff = len(number1List) - len(number2List)
        for i in range(diff):
            number2List.insert(0,0)
    for i in range(len(number1List)): #XOR it
        if number1List[i] == number2List[i]:
            XORoutput.append(0)
        if number1List[i] != number2List[i]:
            XORoutput.append(1)
    num = int(''.join(map(str,XORoutput))) #turn XOR list into int
    return num

    def test(num1, num2): #convert input to binary and xor and return to integer
    print num1,num2
    bin1 = toBinary(num1) #turn to binary
    bin2 = toBinary(num2)
    xor = XOR(bin1,bin2) #XOR
    output = int(str(xor),2) #return to number
    return output

    if __name__ == "__main__":
    #print main.__doc__
        main() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:58:05.250

你设置`test`了一个列表；您不能同时让函数*和*列表使用相同的名称：

```
def main():
    # other code

    test = []

    # more code

    for i in range(len(cipherKeyAscii)):
        # more irrelevant code

        xorNum =  test(f,j)
        test.append(xorNum) 
```

屏蔽功能`test()`。您甚至可以`test`在下一行再次用作列表。

重命名列表，或重命名函数。最重要的是，为变量选择更好、更清晰的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T15:58:58.080

你定义`test`为一个列表。您还将它定义为一个函数。消除你的名字冲突，你应该很高兴。

# android - 无线电组设置

> ID：14321917
> 
> 赞同：0
> 
> 时间：2013-01-14T15:56:36.927
> 
> 标签：android

在 java 文件中设置单选组时，当我尝试通过使用 setOnCheckedChanngeListener 方法时，它正在调用复合按钮，但我想要单选按钮。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:04:25.593

如果我理解您的问题，这就是解决方案：

`CompoundButton`您在侦听器方法中收到的是 a ，`RadioButton`因此您可以对其进行转换：

```
public void onCheckedChanged(CompoundButton buttonView, boolean isChecked){
    RadioButton radioButton = (RadioButton)buttonView;
    ...
} 
```

# c# - Linq 最有效的方式

> ID：14321919
> 
> 赞同：0
> 
> 时间：2013-01-14T15:56:39.347
> 
> 标签：c#, linq

我想知道是否有一种更有效的方法来做我需要做的事情：

```
 return HttpContext.Current.User.IsInRole("Admin") 
    ? dbContext.Prog_Search1(searchField, searchString, searchOper).Where(a => a.Id == 2)      
    : dbContext.Prog_Search1(searchField, searchString, searchOper).Where(a => a.Id == 1) 
```

我想知道是否有一种聪明的方法可以只使用一个

```
 dbContext.Search1(searchField, searchString, searchOper) 
```

与我使用的 2 相比，然后有条件地执行 Where 子句？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T15:58:13.643

是的，听起来你想要这样的东西：

```
int targetId = HttpContext.Current.User.IsInRole("Admin") ? 2 : 1;
return dbContext.Prog_Search1(searchField, searchString, searchOper)
                .Where(a => a.Id == targetId); 
```

请注意，这并不会真正改变*效率*，但会影响可读性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-14T15:58:30.017

我想你想要这样的东西：

```
var id = HttpContext.Current.User.IsInRole("Admin") ? 2 : 1
return dbContext.Prog_Search1(searchField, searchString, searchOper)
                .Where(a => a.Id == id); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T16:00:46.470

或者：

```
var srch = dbContext.Prog_Search1(searchField, searchString, searchOper);
return HttpContext.Current.User.IsInRole("Admin") 
    ? srch.Where(a => a.Id == 2)      
    : srch.Where(a => a.Id == 1); 
```

在您的特定实例中不如 pre-setting 整洁`i=1 or 2`，但如果两个不同的`Where`命令更加不同，通常会更灵活。

# jquery - jquery可移动地图+抛出另一个div

> ID：14321922
> 
> 赞同：0
> 
> 时间：2013-01-14T15:56:42.390
> 
> 标签：jquery

我有这个 html

```
<div id="wrap">
   <div id="menu">
        <div id="leftMenu">...width 250,height 100 position absolute left 0 top 0</div>
        <div id="rightMenu">...width 250,height 100 position absolute right 0 top 0</div>
   </div>
   <div id="movable"></div>
</div> 
```

和这个jQuery

```
$('body').on("mousedown",function(e){....});
$('#movable').on("mousemove",function(e){......}); 
```

看起来像这张图片 -![在此处输入图像描述](../Images/086cd6ef4a50d5c5dcf339df95ea280e.png)

什么问题？实际上我只能在菜单下方开始移动，但我想开始在左侧菜单和右侧菜单之间移动是否可能？

编辑：我只有 1 个想法 - 删除带有 id 菜单的 div

# php - Ruby 等价于 php_sapi_name

> ID：14321925
> 
> 赞同：2
> 
> 时间：2013-01-14T15:57:27.673
> 
> 标签：php, ruby

确定您是否在 CLI 中运行（如 PHP 中的 php_sapi_name 函数）与处理 HTTP 请求的 Ruby 约定是什么？

我在想我可以测试是否定义了请求，或者其他一些推理方法，但必须有一个我应该遵循的约定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:10:20.040

这里没有标准化的方法，因为 Ruby 是一种脚本语言，它可能嵌入也可能不嵌入到 Web 服务器进程中。它也可能作为断开连接的后台进程运行，尽管不一定是面向 Web 的。

在 HTTP 环境中，您通常会定义类似于[CGI 规范](http://en.wikipedia.org/wiki/Common_Gateway_Interface)`ENV['SERVER_NAME']`中的其他变量。这些不会出现在命令行环境中。

一般来说，最好测试一下您是在 Rack 或 Rails 中运行，还是在使用任何特定的 Web 框架来与 HTTP 层交互。例如，`defined?(Rails)`将指示 Rails 是否已加载，尽管对于`rake`任务和`rails console`类型使用也是如此。

# c# - 如何在 C# 中在 ARM 上运行的 Win CE 上初始化 WaveOUT API

> ID：14321929
> 
> 赞同：0
> 
> 时间：2013-01-14T15:57:38.050
> 
> 标签：c#, arm, windows-ce, memory-alignment, waveout

我正在尝试在 Win CE (ARM) 上运行 WinOut API，但使用在 Windows 7 上运行的相同代码，我在行中获取 MMSYSERR_INVALIDPARAM 以进行缓冲区准备。

```
Win32.MMRESULT hr = Win32.waveOutPrepareHeader(
    hWaveOut, ref WaveOutHeaders[i], Marshal.SizeOf(WaveOutHeaders[i])); 
if (hr == Win32.MMRESULT.MMSYSERR_NOERROR) ... 
```

我认为这是 ARM 字节边界缓冲区对齐的问题，但我不知道如何在 .NET Compact Framework for Windows CE 中做到这一点。

我试图找到一些解决方案或解释，但什么也没有。

**更新**

这是适用于 Win CE 和 .NET Compact Framework 的 P/Invoke。在 Internet 上可以找到与“winmm.dll”而不是“coredll.dll”相关的 P/Invoke。Winmm.dll 存在于 Windows XP、7 上。Windows CE 仅适用于 coredll.dll。如果在 WinCE 上使用“winmm.dll”，则会收到以下消息“无法 P/Invoke winmm.dll”

```
 [DllImport("coredll.dll", SetLastError = true, CharSet = CharSet.Auto)]
    public static extern MMRESULT waveOutOpen(ref IntPtr hWaveOut, int uDeviceID, ref WAVEFORMATEX lpFormat, DelegateWaveOutProc dwCallBack, int dwInstance, int dwFlags);

    [DllImport("coredll.dll")]
    public static extern MMRESULT waveInOpen(ref IntPtr hWaveIn, int deviceId, ref WAVEFORMATEX wfx, DelegateWaveInProc dwCallBack, int dwInstance, int dwFlags);

    [DllImport("coredll.dll", SetLastError = true)]
    public static extern MMRESULT waveInStart(IntPtr hWaveIn);

    [DllImport("coredll.dll", SetLastError = true, CharSet = CharSet.Auto)]
    public static extern uint waveInGetDevCaps(int index, ref WAVEINCAPS pwic, int cbwic);

    [DllImport("coredll.dll", SetLastError = true)]
    public static extern uint waveInGetNumDevs();

    [DllImport("coredll.dll", SetLastError = true, CharSet = CharSet.Auto)]
    public static extern uint waveOutGetDevCaps(int index, ref WAVEOUTCAPS pwoc, int cbwoc);

    [DllImport("coredll.dll", SetLastError = true)]
    public static extern uint waveOutGetNumDevs();

    [DllImport("coredll.dll", SetLastError = true, CharSet = CharSet.Auto)]
    public static extern MMRESULT waveOutWrite(IntPtr hWaveOut, ref WAVEHDR pwh, int cbwh);

    [DllImport("coredll.dll", SetLastError = true, CharSet = CharSet.Auto)]
    public static extern MMRESULT waveOutPrepareHeader(IntPtr hWaveOut, ref WAVEHDR lpWaveOutHdr, int uSize);

    [DllImport("coredll.dll", SetLastError = true, CharSet = CharSet.Auto)]
    public static extern uint waveOutGetDevCaps(int index, ref WAVEOUTCAPS pwoc, int cbwoc);

    [DllImport("coredll.dll", SetLastError = true)]
    public static extern uint waveOutGetNumDevs();

[DllImport("coredll.dll", SetLastError = true, CharSet = CharSet.Auto)]
    public static extern MMRESULT waveOutWrite(IntPtr hWaveOut, ref WAVEHDR pwh, int cbwh);

[DllImport("coredll.dll", SetLastError = true, CharSet = CharSet.Auto)]
    public static extern MMRESULT waveOutPrepareHeader(IntPtr hWaveOut, ref WAVEHDR lpWaveOutHdr, int uSize);

    [DllImport("coredll.dll", EntryPoint = "waveOutReset", SetLastError = true)]
    public static extern MMRESULT waveOutReset(IntPtr hWaveOut);

    [DllImport("coredll.dll", SetLastError = true, CharSet = CharSet.Auto)]
    public static extern MMRESULT waveOutUnprepareHeader(IntPtr hWaveOut, ref WAVEHDR pwh, int cbwh);

    [DllImport("coredll.dll", SetLastError = true, CharSet = CharSet.Auto)]
    public static extern Win32.MMRESULT waveOutClose(IntPtr hWaveOut);

[DllImport("coredll.dll")]
    public static extern Win32.MMRESULT waveOutPause(IntPtr hWaveOut);

[DllImport("coredll.dll", EntryPoint = "waveOutRestart", SetLastError = true)]
    public static extern Win32.MMRESULT waveOutRestart(IntPtr hWaveOut); 
```

使用的数据结构和常量

```
public const int WAVE_MAPPER = -1;

    public const int WT_EXECUTEDEFAULT = 0x00000000;
    public const int WT_EXECUTEINIOTHREAD = 0x00000001;
    public const int WT_EXECUTEINTIMERTHREAD = 0x00000020;
    public const int WT_EXECUTEINPERSISTENTTHREAD = 0x00000080;

    public const int TIME_ONESHOT = 0;
    public const int TIME_PERIODIC = 1;

    /// <summary>
    /// WAVEOUTCAPS
    /// </summary>
    [StructLayout(LayoutKind.Sequential, Pack = 4, CharSet = CharSet.Auto)]
    public struct WAVEOUTCAPS
    {
        public short wMid;
        public short wPid;
        public int vDriverVersion;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 32)]
        public string szPname;
        public uint dwFormats;
        public short wChannels;
        public short wReserved;
        public int dwSupport;
    }

    /// <summary>
    /// WAVEINCAPS
    /// </summary>
    [StructLayout(LayoutKind.Sequential, Pack = 4, CharSet = CharSet.Auto)]
    public struct WAVEINCAPS
    {
        public short wMid;
        public short wPid;
        public int vDriverVersion;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 32)]
        public string szPname;
        public uint dwFormats;
        public short wChannels;
        public short wReserved;
        public int dwSupport;
    }

    /// <summary>
    /// WAVEFORMATEX
    /// </summary>
    [StructLayout(LayoutKind.Sequential)]
    public struct WAVEFORMATEX
    {
        public ushort wFormatTag;
        public ushort nChannels;
        public uint nSamplesPerSec;
        public uint nAvgBytesPerSec;
        public ushort nBlockAlign;
        public ushort wBitsPerSample;
        public ushort cbSize;
    }

    /// <summary>
    /// MMRESULT
    /// </summary>
    public enum MMRESULT : uint
    {
        MMSYSERR_NOERROR = 0,
        MMSYSERR_ERROR = 1,
        MMSYSERR_BADDEVICEID = 2,
        MMSYSERR_NOTENABLED = 3,
        MMSYSERR_ALLOCATED = 4,
        MMSYSERR_INVALHANDLE = 5,
        MMSYSERR_NODRIVER = 6,
        MMSYSERR_NOMEM = 7,
        MMSYSERR_NOTSUPPORTED = 8,
        MMSYSERR_BADERRNUM = 9,
        MMSYSERR_INVALFLAG = 10,
        MMSYSERR_INVALPARAM = 11,
        MMSYSERR_HANDLEBUSY = 12,
        MMSYSERR_INVALIDALIAS = 13,
        MMSYSERR_BADDB = 14,
        MMSYSERR_KEYNOTFOUND = 15,
        MMSYSERR_READERROR = 16,
        MMSYSERR_WRITEERROR = 17,
        MMSYSERR_DELETEERROR = 18,
        MMSYSERR_VALNOTFOUND = 19,
        MMSYSERR_NODRIVERCB = 20,
        WAVERR_BADFORMAT = 32,
        WAVERR_STILLPLAYING = 33,
        WAVERR_UNPREPARED = 34
    }

    /// <summary>
    /// MMSYSERR
    /// </summary>
    public enum MMSYSERR : uint
    {
        // Add MMSYSERR's here!

        MMSYSERR_BASE = 0x0000,
        MMSYSERR_NOERROR = 0x0000
    }

    [Flags]
    public enum WaveHdrFlags : uint
    {
        WHDR_DONE = 1,
        WHDR_PREPARED = 2,
        WHDR_BEGINLOOP = 4,
        WHDR_ENDLOOP = 8,
        WHDR_INQUEUE = 16
    }

    [Flags]
    public enum WaveProcFlags : int
    {
        CALLBACK_NULL = 0,
        CALLBACK_FUNCTION = 0x30000,
        CALLBACK_EVENT = 0x50000,
        CALLBACK_WINDOW = 0x10000,
        CALLBACK_THREAD = 0x20000,
        WAVE_FORMAT_QUERY = 1,
        WAVE_MAPPED = 4,
        WAVE_FORMAT_DIRECT = 8
    }

    [Flags]
    public enum HRESULT : long
    {
        S_OK = 0L,
        S_FALSE = 1L
    }

    [Flags]
    public enum WaveFormatFlags : int
    {
        WAVE_FORMAT_PCM = 0x0001
    }

    /// <summary>
    /// WAVEHDR
    /// </summary>
    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    public struct WAVEHDR
    {
        public IntPtr lpData; // pointer to locked data buffer
        public uint dwBufferLength; // length of data buffer
        public uint dwBytesRecorded; // used for input only
        public IntPtr dwUser; // for client's use
        public WaveHdrFlags dwFlags; // assorted flags (see defines)
        public uint dwLoops; // loop control counter
        public IntPtr lpNext; // PWaveHdr, reserved for driver
        public IntPtr reserved; // reserved for driver
    }

    /// <summary>
    /// TimeCaps
    /// </summary>
    [StructLayout(LayoutKind.Sequential)]
    public struct TimeCaps
    {
        public UInt32 wPeriodMin;
        public UInt32 wPeriodMax;
    };

    /// <summary>
    /// WOM_Messages
    /// </summary>
    public enum WOM_Messages : int
    {
        OPEN = 0x03BB,
        CLOSE = 0x03BC,
        DONE = 0x03BD
    }

    /// <summary>
    /// WIM_Messages
    /// </summary>
    public enum WIM_Messages : int
    {
        OPEN = 0x03BE,
        CLOSE = 0x03BF,
        DATA = 0x03C0
    }

    public delegate void DelegateWaveOutProc(IntPtr hWaveOut, WOM_Messages msg, IntPtr dwInstance, ref Win32.WAVEHDR wavehdr, IntPtr lParam);
    public delegate void DelegateWaveInProc(IntPtr hWaveIn, WIM_Messages msg, IntPtr dwInstance, ref Win32.WAVEHDR wavehdr, IntPtr lParam);
    public delegate void DelegateTimerProc(IntPtr lpParameter, bool TimerOrWaitFired);
    public delegate void TimerEventHandler(UInt32 id, UInt32 msg, ref UInt32 userCtx, UInt32 rsv1, UInt32 rsv2);

    Method calls

         /// <summary>
                /// CreateWaveOutHeaders
                /// </summary>
                /// <returns></returns>
                private bool CreateWaveOutHeaders()
                {
                    //Buffer anlegen
                    this.WaveOutHeaders = new Win32.WAVEHDR[BufferCount];
                    this.GCWaveOutHandleBuffers = new GCHandle[BufferCount];
                    GCWaveOutHandleHeaders = new GCHandle[BufferCount];
                    int createdHeaders = 0;

                    //Für jeden Buffer
                    for (int i = 0; i < BufferCount; i++)
                    {
                        //Header erstellen
                        WaveOutHeaders[i].dwLoops = 0;
                        WaveOutHeaders[i].dwUser = IntPtr.Zero;
                        WaveOutHeaders[i].lpNext = IntPtr.Zero;
                        WaveOutHeaders[i].reserved = IntPtr.Zero;

                        //Im Speicher verankern
                        GCWaveOutHandleHeaders[i] = GCHandle.Alloc(this.WaveOutHeaders[i], GCHandleType.Pinned);

                        //Wenn der Buffer vorbereitet werden konnte
                        Win32.MMRESULT hr = Win32.waveOutPrepareHeader(hWaveOut, ref WaveOutHeaders[i], Marshal.SizeOf(WaveOutHeaders[i]));
                        if (hr == Win32.MMRESULT.MMSYSERR_NOERROR)
                        {
                            createdHeaders++;
                        }
                    }

                    //Fertig
                    return (createdHeaders == BufferCount);
                }

             /// <summary>
                /// FreeWaveOutHeaders
                /// </summary>
                private void FreeWaveOutHeaders()
                {
                    try
                    {
                        if (WaveOutHeaders != null)
                        {
                            for (int i = 0; i < WaveOutHeaders.Length; i++)
                            {
                                Win32.MMRESULT hr = Win32.waveOutUnprepareHeader(hWaveOut, ref WaveOutHeaders[i], Marshal.SizeOf(WaveOutHeaders[i]));
                            }
                        }
                    }
                    catch (Exception ex)
                    {
                        System.Diagnostics.Debug.Write(ex.Message);
                    }
                }

/// <summary>
            /// OpenWaveOuz
            /// </summary>
            /// <returns></returns>
            private bool OpenWaveOut()
            {
                if (hWaveOut == IntPtr.Zero)
                {
                    //Wenn nicht schon offen
                    if (IsWaveOutOpened == false)
                    {
                        //Format bestimmen
                        Win32.WAVEFORMATEX waveFormatEx = new Win32.WAVEFORMATEX();
                        waveFormatEx.wFormatTag = (ushort)Win32.WaveFormatFlags.WAVE_FORMAT_PCM;
                        waveFormatEx.nChannels = (ushort)Channels;
                        waveFormatEx.nSamplesPerSec = (ushort)SamplesPerSecond;
                        waveFormatEx.wBitsPerSample = (ushort)BitsPerSample;
                        waveFormatEx.nBlockAlign = (ushort)((waveFormatEx.wBitsPerSample * waveFormatEx.nChannels) >> 3);
                        waveFormatEx.nAvgBytesPerSec = (uint)(waveFormatEx.nBlockAlign * waveFormatEx.nSamplesPerSec);

                        //WaveOut Gerät ermitteln
                        int deviceId = WinSound.GetWaveOutDeviceIdByName(WaveOutDeviceName);
                        //WaveIn Gerät öffnen
                        Win32.MMRESULT hr = Win32.waveOutOpen(ref hWaveOut, deviceId, ref waveFormatEx, delegateWaveOutProc, 0, (int)Win32.WaveProcFlags.CALLBACK_FUNCTION);

                        //Wenn nicht erfolgreich
                        if (hr != Win32.MMRESULT.MMSYSERR_NOERROR)
                        {
                            IsWaveOutOpened = false;
                            return false;
                        }

                        //Handle sperren
                        GCHandle.Alloc(hWaveOut, GCHandleType.Pinned);
                    }
                }

                IsWaveOutOpened = true;
                return true;
            }
            /// <summary>
            ///Open
            /// </summary>
            /// <param name="waveInDeviceName"></param>
            /// <param name="waveOutDeviceName"></param>
            /// <param name="samplesPerSecond"></param>
            /// <param name="bitsPerSample"></param>
            /// <param name="channels"></param>
            /// <returns></returns>
            public bool Open(string waveOutDeviceName, int samplesPerSecond, int bitsPerSample, int channels, int bufferCount)
            {
                try
                {
                    lock (Locker)
                    {
                        //Wenn nicht schon geöffnet
                        if (Opened == false)
                        {

                            //Daten übernehmen
                            WaveOutDeviceName = waveOutDeviceName;
                            SamplesPerSecond = samplesPerSecond;
                            BitsPerSample = bitsPerSample;
                            Channels = channels;
                            BufferCount = Math.Max(bufferCount, 1);

                            //Wenn WaveOut geöffnet werden konnte
                            if (OpenWaveOut())
                            {
                                //Wenn alle Buffer erzeugt werden konnten
                                if (CreateWaveOutHeaders())
                                {
                                    //Thread starten
                                    StartThreadPlayWaveOut();
                                    IsClosed = false;
                                    return true;
                                }
                            }
                        }

                        //Schon geöffnet
                        return false;
                    }
                }
                catch (Exception ex)
                {
                    System.Diagnostics.Debug.WriteLine(String.Format("Start | {0}", ex.Message));
                    return false;
                }
            }
            /// <summary>
            /// PlayData
            /// </summary>
            /// <param name="datas"></param>
            /// <param name="isBlocking"></param>
            /// <returns></returns>
            public bool PlayData(Byte[] datas, bool isBlocking)
            {
                try
                {
                    if (Opened)
                    {
                        int index = GetNextFreeWaveOutHeaderIndex();
                        if (index != -1)
                        {
                            //Werte übernehmen
                            this.IsBlocking = isBlocking;

                            //Daten kopieren
                            GCWaveOutHandleBuffers[index] = GCHandle.Alloc(datas, GCHandleType.Pinned);
                            WaveOutHeaders[index].lpData = GCWaveOutHandleBuffers[index].AddrOfPinnedObject();
                            WaveOutHeaders[index].dwBufferLength = (uint)datas.Length;
                            WaveOutHeaders[index].dwUser = (IntPtr)index;

                            //Abspielen
                            this.IsStarted = true;
                            Win32.MMRESULT hr = Win32.waveOutWrite(hWaveOut, ref WaveOutHeaders[index], (int)Marshal.SizeOf(WaveOutHeaders[index]));
                            if (hr == Win32.MMRESULT.MMSYSERR_NOERROR)
                            {
                                //Wenn blockierend
                                if (isBlocking)
                                {
                                    AutoResetEventDataPlayed.WaitOne();
                                    AutoResetEventDataPlayed.Set();
                                }
                                return true;
                            }
                            else
                            {
                                //Fehler beim Abspielen
                                AutoResetEventDataPlayed.Set();
                                return false;
                            }
                        }
                        else
                        {
                            //Kein freier Ausgabebuffer vorhanden
                            //System.Diagnostics.Debug.WriteLine(String.Format("No free WaveOut Buffer found | {0}", DateTime.Now.ToLongTimeString()));
                            return false;
                        }
                    }
                    else
                    {
                        //Nicht geöffnet
                        return false;
                    }

                }
                catch (Exception ex)
                {
                    System.Diagnostics.Debug.WriteLine(String.Format("PlayData | {0}", ex.Message));
                    return false;
                }
            }

       /// <summary>
            /// Close
            /// </summary>
            /// <returns></returns>
            public bool Close()
            {
                try
                {
                    lock (Locker)
                    {
                        //Wenn geöffnet
                        if (Opened)
                        {
                            //Als manuel beendet setzen
                            IsClosed = true;
                            Win32.MMRESULT hr = Win32.waveOutReset(hWaveOut);

                            //Warten bis alle Daten fertig abgespielt
                            int count = 0;
                            while (Win32.waveOutClose(hWaveOut) != Win32.MMRESULT.MMSYSERR_NOERROR && count <= 100)
                            {
                                System.Threading.Thread.Sleep(50);
                                count++;
                            }

                            //Variablen setzen
                            IsWaveOutOpened = false;
                            AutoResetEventDataPlayed.Set();
                            return true;
                        }
                        return false;
                    }
                }
                catch (Exception ex)
                {
                    System.Diagnostics.Debug.WriteLine(String.Format("Close | {0}", ex.Message));
                    return false;
                }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:06:06.047

与其尝试调试我们没有完整源代码的桌面代码，您是否尝试过从已知可用于 Compact Framework 的代码库开始？在 MSDN 中有[一个使用波形音频 API 的完整示例，](http://msdn.microsoft.com/en-us/library/aa446573.aspx)它可能定义了您需要的一切，它是为 Compact Framework 编写的。

# c++ - C ++ 错误：[函数名称] 之前的预期初始化程序

> ID：14321930
> 
> 赞同：7
> 
> 时间：2013-01-14T15:57:37.983
> 
> 标签：c++, gcc, compiler-errors

我正在用 C++ 让自己焕然一新（从学校开始就没有这样做过），我写了一个简单的程序只是为了搞砸。我的问题是，当我编译程序时它会阻塞说明“错误：'stringThing'之前的预期初始化程序”是否有这样做的原因？我知道这可能是一个菜鸟问题，所以我检查了 stackoverflow 并找不到任何给我答案的相关问题。

*我正在使用 GNU GCC 编译器

代码：

```
#include <iostream>

using namespace std;

void string stringThing (string shiftdir, string &teststring)
    {
        if (shiftdir == "right")
        {
           teststring = teststring >> " " >> "Bit Shifted right";
        }
        else
        {
           teststring = teststring << " " << "Bit Shifted left";
        }
    }
int main()
{

    string test;

    cout << stringThing("right", "I have done a ") << endl;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T15:59:59.933

的返回类型`stringThing`必须是`void` *或* `string`，而不是两者。`<string>`如果要使用字符串，还必须包含,。

既然要输出 in 的返回值`stringThing()`，`main`我猜应该是

```
std::string stringThing (std::string shiftdir, const std::string &teststring) 
```

但是，您还必须从函数中返回一个字符串

```
if (shiftdir == "right")
    return teststring + " " + "Bit Shifted right";
else
    return teststring + " " + "Bit Shifted left"; 
```

例如。

您的参数`std::string &teststring`不适用于您的`const char*`参数。因此，要么仅将其声明为按值复制`string`，要么更好`const string&`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-14T15:58:49.540

### 返回类型是……时髦

什么是：

```
void string stringThing (string shiftdir, string &teststring) 
```

?

摆脱第一个`string`。您的函数不返回任何内容。

所以，简单地说：

```
void stringThing(string shiftdir, string &teststring) 
```

* * *

### 包含缺失

您还需要`#include <string>`— 在某些情况下，您可能会得到“幸运”，并且将其隐式包含在 中`<iostream>`，但不要依赖它。

# c - 用于从 MongoDB 的 Make 错误中提供文件的 Nginx 模块

> ID：14321931
> 
> 赞同：0
> 
> 时间：2013-01-14T15:57:39.257
> 
> 标签：c, mongodb, nginx

我正在尝试从 github 运行 nginx-gridfs 以将 mongodb 与 nginx 连接。[我遵循了https://github.com/mdirolf/nginx-gridfs](https://github.com/mdirolf/nginx-gridfs) README 文件中所示的确切过程。当我使用以下语句进行配置时

```
./configure --add-module=/home/yogesh/nginx-gridfs-master --prefix=/usr/local/nginx

Configuration summary
  + using system PCRE library
  + OpenSSL library is not used
  + md5: using system crypto library
  + sha1: using system crypto library
  + using system zlib library

  nginx path prefix: "/usr/local/nginx"
  nginx binary file: "/usr/local/nginx/sbin/nginx"
  nginx configuration prefix: "/usr/local/nginx/conf"
  nginx configuration file: "/usr/local/nginx/conf/nginx.conf"
  nginx pid file: "/usr/local/nginx/logs/nginx.pid"
  nginx error log file: "/usr/local/nginx/logs/error.log"
  nginx http access log file: "/usr/local/nginx/logs/access.log"
  nginx http client request body temporary files: "client_body_temp"
  nginx http proxy temporary files: "proxy_temp"
  nginx http fastcgi temporary files: "fastcgi_temp"
  nginx http uwsgi temporary files: "uwsgi_temp"
  nginx http scgi temporary files: "scgi_temp 
```

现在，当我按 MAKE 制作文件时，我收到以下错误

```
gcc -c -pipe  -O -W -Wall -Wpointer-arith -Wno-unused-parameter -Werror -g  --std=c99 -Isrc -I src/core -I src/event -I src/event/modules -I src/os/unix -I objs -I src/http -I src/http/modules \
        -o objs/src/http/modules/ngx_http_upstream_keepalive_module.o \
        src/http/modules/ngx_http_upstream_keepalive_module.c
make[1]: *** No rule to make target `/home/yogesh/nginx-gridfs-master/mongo-c-driver/src/*.h', needed by `objs/addon/nginx-gridfs-master/ngx_http_gridfs_module.o'.  Stop.
make[1]: Leaving directory `/home/yogesh/nginx-1.2.6'
make: *** [build] Error 2 
```

我应该怎么做才能解决这个错误......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T16:18:48.253

nginx-gridfs 有子模块（mongo-c-driver）。

在 nginx-gridfs 目录中执行以下命令后，您可以尝试从 ./configure 重新启动。

```
git子模块更新--init

```

# hibernate - 不能在 Hibernate 中映射 OneToMany 目标（@OneToMany 针对未映射的类）

> ID：14321933
> 
> 赞同：0
> 
> 时间：2013-01-14T15:57:40.233
> 
> 标签：hibernate, one-to-many, hibernate-mapping, target

我正在做一个项目。我在 jboss 和 maven 中使用休眠。然而，在两个类的关系中，给出了错误。我在persistence.xml 和hibernate.cfg.xml 中添加了两个类。我没有使用收藏。我用了一套。但是给出了错误。为什么给出错误？我怎么解决这个问题？

```
 @Entity
 @EntityListeners({ModelListener.class})
 @Inheritance(strategy = InheritanceType.SINGLE_TABLE)
 @DiscriminatorColumn(name = "serviceclass", discriminatorType =
 DiscriminatorType.STRING)
 @ForceDiscriminator
 // @DiscriminatorValue("BASE")
 @Table(name = "infrastructureserviceelement", uniqueConstraints =     
 {@UniqueConstraint(columnNames = {"name",                                      
 "infrastructureService_id"})})
 @NamedQueries({
           @NamedQuery(name = InfrastructureServiceElementImpl.ALL +                
 ModelFactory.LEVEL0, query = InfrastructureServiceElementImpl.SELF),
           @NamedQuery(name = InfrastructureServiceElementImpl.ALL + 
 ModelFactory.REMOTE, query = InfrastructureServiceElementImpl.SELF),

           @NamedQuery(name = InfrastructureServiceElementImpl.BY_ID + 
 ModelFactory.LEVEL0, query = InfrastructureServiceElementImpl.SELF + 
 InfrastructureServiceElementImpl.WHERE_ID),
           @NamedQuery(name = InfrastructureServiceElementImpl.BY_ID +      
 ModelFactory.REMOTE, query = InfrastructureServiceElementImpl.SELF +      
 InfrastructureServiceElementImpl.WHERE_ID),

           @NamedQuery(name = InfrastructureServiceElementImpl.BY_KEY + 
 ModelFactory.LEVEL0, query = InfrastructureServiceElementImpl.SELF + 
 InfrastructureServiceElementImpl.WHERE_KEY),
           @NamedQuery(name = InfrastructureServiceElementImpl.BY_KEY + 
 ModelFactory.REMOTE, query = InfrastructureServiceElementImpl.SELF + 
 InfrastructureServiceElementImpl.WHERE_KEY),

           @NamedQuery(name = InfrastructureServiceElementImpl.BY_NAME + 
 ModelFactory.LEVEL0, query = InfrastructureServiceElementImpl.SELF + 
 InfrastructureServiceElementImpl.WHERE_NAME),
           @NamedQuery(name = InfrastructureServiceElementImpl.BY_NAME + 
 ModelFactory.REMOTE, query = InfrastructureServiceElementImpl.SELF + 
 InfrastructureServiceElementImpl.WHERE_NAME)

 })

 public class InfrastructureServiceElementImpl implements InfrastructureServiceElement,      
 Serializable, Alarmed, Monitored {
  @OneToMany(targetEntity = InfrastructureServiceElementProductImpl.class, mappedBy = "infrastructureServiceElement", cascade = CascadeType.ALL, fetch = FetchType.LAZY)
  @Cascade({org.hibernate.annotations.CascadeType.ALL})
  private Set<InfrastructureServiceElementProduct> infrastructureServiceElementProducts = new HashSet<InfrastructureServiceElementProduct>();

  /**
   * Gets the products field of this InfrastructureServiceElement.
   * 
   * @return the products
   */
  public Collection<InfrastructureServiceElementProduct> getInfrastructureServiceElementProducts() {
     if (this.infrastructureServiceElementProducts == null) {
        this.infrastructureServiceElementProducts = new HashSet<InfrastructureServiceElementProduct>();
     }
     return this.infrastructureServiceElementProducts;
  }

  public void setInfrastructureServiceElementProducts(Set<InfrastructureServiceElementProduct> infrastructureServiceElementProducts) {
     this.infrastructureServiceElementProducts = infrastructureServiceElementProducts;
  } 

 } 
```

* * *

```
 @Entity
  @EntityListeners({ModelListener.class})
  @Table(name = "infrastructureserviceelement_product", uniqueConstraints = {@UniqueConstraint(columnNames = {
                                                                                                              "infrastructureserviceelement_id",
                                                                                                              "product_id"})})
  @NamedQueries({
  /*
                 @NamedQuery(name = InfrastructureServiceElementProductImpl.BY_ID + ModelFactory.LEVEL0, query = InfrastructureServiceElementProductImpl.SELF + InfrastructureServiceElementProductImpl.WHERE_ID),
                 @NamedQuery(name = InfrastructureServiceElementProductImpl.BY_ID + ModelFactory.REMOTE, query = InfrastructureServiceElementProductImpl.SELF + InfrastructureServiceElementProductImpl.WHERE_ID),

                 @NamedQuery(name = InfrastructureServiceElementProductImpl.BY_KEY + ModelFactory.LEVEL0, query = InfrastructureServiceElementProductImpl.SELF + InfrastructureServiceElementProductImpl.WHERE_KEY),
                 @NamedQuery(name = InfrastructureServiceElementProductImpl.BY_KEY + ModelFactory.REMOTE, query = InfrastructureServiceElementProductImpl.SELF + InfrastructureServiceElementProductImpl.WHERE_KEY),

                 @NamedQuery(name = InabstractfrastructureServiceElementProductImpl.BY_PRODUCT_ID + ModelFactory.LEVEL0, query = InfrastructureServiceElementProductImpl.SELF + InfrastructureServiceElementProductImpl.WHERE_PRODUCT),
                 @NamedQuery(name = InfrastructureServiceElementProductImpl.BY_PRODUCT_ID + ModelFactory.REMOTE, query = InfrastructureServiceElementProductImpl.SELF + InfrastructureServiceElementProductImpl.WHERE_PRODUCT),

                 @NamedQuery(name = InfrastructureServiceElementProductImpl.BY_INFRASTRUCTURESERVICEELEMENT_NAME + ModelFactory.LEVEL0, query = InfrastructureServiceElementProductImpl.SELF + InfrastructureServiceElementProductImpl.INFRASTRUCTURESERVICEELEMENT_FETCH + "WHERE isef.id = ?1 AND infsep. = ?2")
  */
  })
  @Inheritance(strategy = InheritanceType.SINGLE_TABLE)
   //@org.hibernate.annotations.Entity(dynamicInsert=true,dynamicUpdate=true)
  public class InfrastructureServiceElementProductImpl implements InfrastructureServiceElementProduct, Serializable {

     @ForeignKey(name = "infrastructureserviceelement_product_fk_1")
     @JoinColumn(referencedColumnName = "id", nullable = false)
     @ManyToOne(targetEntity = InfrastructureServiceElementImpl.class, cascade = {CascadeType.MERGE, CascadeType.REFRESH})
     @Cascade({org.hibernate.annotations.CascadeType.MERGE, org.hibernate.annotations.CascadeType.REFRESH})
     private InfrastructureServiceElement infrastructureServiceElement;

     public void setInfrastructureServiceElement(InfrastructureServiceElement infrastructureServiceElement) {
        this.infrastructureServiceElement = infrastructureServiceElement;
     }

     public InfrastructureServiceElement getInfrastructureServiceElement() {
        return this.infrastructureServiceElement;
     }
 } 
```

并给出以下错误：

```
 org.hibernate.AnnotationException: Use of @OneToMany or @ManyToMany targeting an unmapped class: com.genband.wae.model.entities.InfrastructureServiceElementImpl.infrastructureServiceElementProducts[com.genband.wae.model.entities.InfrastructureServiceElementProductImpl]
    at org.hibernate.cfg.annotations.CollectionBinder.bindManyToManySecondPass(CollectionBinder.java:1071)
    at org.hibernate.cfg.annotations.CollectionBinder.bindStarToManySecondPass(CollectionBinder.java:602)
    at org.hibernate.cfg.annotations.CollectionBinder$1.secondPass(CollectionBinder.java:543)
    at org.hibernate.cfg.CollectionSecondPass.doSecondPass(CollectionSecondPass.java:66)
    at org.hibernate.cfg.Configuration.secondPassCompile(Configuration.java:1163)
    at org.hibernate.cfg.AnnotationConfiguration.secondPassCompile(AnnotationConfiguration.java:329)
    at org.hibernate.cfg.Configuration.buildMappings(Configuration.java:1148)
    at org.hibernate.ejb.Ejb3Configuration.buildMappings(Ejb3Configuration.java:1226)
    at org.hibernate.ejb.EventListenerConfigurator.configure(EventListenerConfigurator.java:173)
    at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:854)
    at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:425)
    at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:131)
    at org.jboss.jpa.deployment.PersistenceUnitDeployment.start(PersistenceUnitDeployment.java:301)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.jboss.reflect.plugins.introspection.ReflectionUtils.invoke(ReflectionUtils.java:59)
    at org.jboss.reflect.plugins.introspection.ReflectMethodInfoImpl.invoke(ReflectMethodInfoImpl.java:150)
    at org.jboss.joinpoint.plugins.BasicMethodJoinPoint.dispatch(BasicMethodJoinPoint.java:66)
    at org.jboss.kernel.plugins.dependency.KernelControllerContextAction$JoinpointDispatchWrapper.execute(KernelControllerContextAction.java:243)
    at org.jboss.kernel.plugins.dependency.ExecutionWrapper.execute(ExecutionWrapper.java:47)
    at org.jboss.kernel.plugins.dependency.KernelControllerContextAction.dispatchExecutionWrapper(KernelControllerContextAction.java:111)
    at org.jboss.kernel.plugins.dependency.KernelControllerContextAction.dispatchJoinPoint(KernelControllerContextAction.java:72)
    at org.jboss.kernel.plugins.dependency.LifecycleAction.installActionInternal(LifecycleAction.java:221)
    at org.jboss.kernel.plugins.dependency.InstallsAwareAction.installAction(InstallsAwareAction.java:54)
    at org.jboss.kernel.plugins.dependency.InstallsAwareAction.installAction(InstallsAwareAction.java:42)
    at org.jboss.dependency.plugins.action.SimpleControllerContextAction.simpleInstallAction(SimpleControllerContextAction.java:62)
    at org.jboss.dependency.plugins.action.AccessControllerContextAction.install(AccessControllerContextAction.java:71)
    at org.jboss.dependency.plugins.AbstractControllerContextActions.install(AbstractControllerContextActions.java:51)
    at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
    at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1652)
    at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:938)
    at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
    at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:988)
    at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:778)
    at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:543)
    at org.jboss.deployers.vfs.deployer.kernel.BeanMetaDataDeployer.deploy(BeanMetaDataDeployer.java:121)
    at org.jboss.deployers.vfs.deployer.kernel.BeanMetaDataDeployer.deploy(BeanMetaDataDeployer.java:51)
    at org.jboss.deployers.spi.deployer.helpers.AbstractSimpleRealDeployer.internalDeploy(AbstractSimpleRealDeployer.java:62)
    at org.jboss.deployers.spi.deployer.helpers.AbstractRealDeployer.deploy(AbstractRealDeployer.java:50)
    at org.jboss.deployers.plugins.deployers.DeployerWrapper.deploy(DeployerWrapper.java:171)
    at org.jboss.deployers.plugins.deployers.DeployersImpl.doDeploy(DeployersImpl.java:1439)
    at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1157)
    at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1178)
    at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1210)
    at org.jboss.deployers.plugins.deployers.DeployersImpl.install(DeployersImpl.java:1098)
    at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
    at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1652)
    at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:938)
    at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
    at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:988)
    at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:826)
    at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:556)
    at org.jboss.deployers.plugins.deployers.DeployersImpl.process(DeployersImpl.java:781)
    at org.jboss.deployers.plugins.main.MainDeployerImpl.process(MainDeployerImpl.java:702)
    at org.jboss.system.server.profileservice.repository.MainDeployerAdapter.process(MainDeployerAdapter.java:117)
    at org.jboss.system.server.profileservice.repository.ProfileDeployAction.install(ProfileDeployAction.java:70)
    at org.jboss.system.server.profileservice.repository.AbstractProfileAction.install(AbstractProfileAction.java:53)
    at org.jboss.system.server.profileservice.repository.AbstractProfileService.install(AbstractProfileService.java:361)
    at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
    at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1652)
    at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:938)
    at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
    at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:988)
    at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:778)
    at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:543)
    at org.jboss.system.server.profileservice.repository.AbstractProfileService.registerProfile(AbstractProfileService.java:274)
    at org.jboss.system.server.profileservice.ProfileServiceBootstrap.start(ProfileServiceBootstrap.java:263)
    at org.jboss.bootstrap.AbstractServerImpl.start(AbstractServerImpl.java:461)
    at org.jboss.Main.boot(Main.java:221)
    at org.jboss.Main$1.run(Main.java:556)
    at java.lang.Thread.run(Unknown Source) 
```

# c# - 从用户输入创建 Uri

> ID：14321935
> 
> 赞同：2
> 
> 时间：2013-01-14T15:57:41.983
> 
> 标签：c#, windows-phone-7, browser, uri

所以，我想根据用户输入创建一个 Uri。我有一个文本框、一个确定按钮和网络浏览器控件。

用户写下他想要的网址，点击按钮并启动 getUri 方法。

我试图创建这样的东西：

```
private void ok_tap(object sender, System.Windows.Input.GestureEventArgs e)
{
    Uri address = new Uri(AdressBox.Text, UriKind.Absolute);
    web.Navigate(address);
} 
```

Aaand 它工作得很好。但是，仅当用户使用“http://”键入地址时。问题是：没有人写完整的链接，只有“google.com”应用程序崩溃。

我可以检查用户输入中是否有类似“http”的内容并手动添加......但感觉就像我试图重新发明轮子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T16:04:32.323

使用[`UriBuilder`类](http://msdn.microsoft.com/en-us/library/system.uribuilder.aspx)。它的 String 构造函数默认为`HTTP`协议：

```
private void ok_tap(object sender, System.Windows.Input.GestureEventArgs e)
{
    Uri address = new UriBuilder(AdressBox.Text).Uri;
    web.Navigate(address);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T16:09:07.263

URI 的一部分是要使用的协议，所以当用户没有给出它时，你需要做一些事情。您的验证想法似乎很合适，如果没有给出其他内容，请尝试“http://”。如果没有域后缀，您也可以添加“.com、.org、.net”。这不是重新发明轮子，只是在需要的地方使用一个圆圈。无论如何，您应该防止应用程序因不完善的用户输入而崩溃。

# c# - asp：占位符内容到字符串

> ID：14321937
> 
> 赞同：4
> 
> 时间：2013-01-14T15:57:49.977
> 
> 标签：c#, asp.net, string, placeholder

简单的问题，但我在上面找不到任何东西，是否可以将 asp:placeholder 的内容获取到字符串？如果可能的话，这将是很棒的服务器端。

卢克

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-14T16:06:52.700

如果您只想要占位符的文本内容：

```
string textualContent = ((LiteralControl) PlaceHolder1.Controls[0]).Text; 
```

退货 `"Hello World"` ：

```
<asp:PlaceHolder ID="PlaceHolder1" runat="server">Hello World</asp:PlaceHolder> 
```

如果您还想获取渲染控件的 html（以及所有子控件）：

```
System.IO.TextWriter tw = new System.IO.StringWriter();
HtmlTextWriter h = new HtmlTextWriter(tw);
PlaceHolder1.RenderControl(h);
string html = tw.ToString(); 
```

对于这个 aspx（`GridView`与一些相同的数据数据绑定）：

```
<asp:PlaceHolder ID="PlaceHolder1" runat="server">
    <asp:Label ID="LblTest" runat="server">Test-Label</asp:Label>
    <asp:TextBox ID="TxtTest" runat="server" Text="Foo"></asp:TextBox>
    <asp:GridView runat="server" ID="GridView1"></asp:GridView>
    <textarea name="TextArea1" rows="2" cols="1">
    First line
    Second line
    </textarea>
</asp:PlaceHolder> 
```

将生成此 html（取决于浏览器）：

```
<span id="MainContent_LblTest">Test-Label</span><input name="ctl00$MainContent$TxtTest" type="text" value="Foo" id="MainContent_TxtTest" /><div>
    <table cellspacing="0" rules="all" border="1" id="MainContent_GridView1" style="border-collapse:collapse;">
        <tr>
            <th scope="col">ID</th><th scope="col">Text</th>
        </tr><tr>
            <td>1</td><td>Row #1</td>
        </tr><tr>
            <td>2</td><td>Row #2</td>
        </tr><tr>
            <td>3</td><td>Row #3</td>
        </tr><tr>
            <td>4</td><td>Row #4</td>
        </tr><tr>
            <td>5</td><td>Row #5</td>
        </tr>
    </table>
</div>
    <textarea name="TextArea1" rows="2" cols="1">
    First line
    Second line
    </textarea> 
```

请注意，您需要将页面指令更改为

```
EnableEventValidation="false" 
```

并`VerifyRenderingInServerForm`在`Page`

```
public override void VerifyRenderingInServerForm(Control control)
{
    /* Confirms that an HtmlForm control is rendered for the specified ASP.NET
       server control at run time. */
} 
```

`RenderControl`手动调用时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T16:02:32.070

试试看的`RenderControl`方法`Placeholder`。

我为 a 做了类似的事情`HyperLink`，但作为`Placeholder`继承自`System.Web.UI.Control`，它的工作方式应该完全相同。像这样的东西：

```
StringBuilder sb = new System.Text.StringBuilder();
using (var stringWriter = new System.IO.StringWriter(sb))
{
    using (var htmlTextWriter = new System.Web.UI.HtmlTextWriter(stringWriter))
    {
        YourPlaceHolder.RenderControl(htmlTextWriter);
    }
}
return sb.ToString(); 
```

我写了一篇关于这个主题的短文：[http ://www.tomot.de/en-us/article/3/asp.net/create-a-control-in-the-codebehind-and-retrieve-its -渲染输出](http://www.tomot.de/en-us/article/3/asp.net/create-a-control-in-the-codebehind-and-retrieve-its-rendered-output)

# django - 表单动作及其在 Django 中的用法

> ID：14321939
> 
> 赞同：1
> 
> 时间：2013-01-14T15:57:55.547
> 
> 标签：django, forms, web-crawler

第一个问题：

此表格提交给`demo_form?name=ABC`

```
<form action="demo_form" method="get">
  name: <input type="text" name="name"><br>
  <input type="submit" value="Submit">
</form> 
```

有没有办法让它提交给`demo_form/ABC/`？

第二个问题：

即使用户不使用我的表单，如果他们使用网络爬虫简单地访问`demo_form?name=ABC`or `demo_form/ABC/`，也会产生相同的结果。我想阻止这种情况。如果用户通过我的表单提交名称，那么使这两个 URL 有效的最佳方法是什么？我正在学习 django，所以希望该解决方案适用于 django 框架。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T16:02:12.303

> 有没有办法让它提交给 demo_form/ABC/？

您可以在 JavaScript 中拦截提交，手动构建 URL，然后设置`location`. 如果 JS 不可用，那将会中断。

更明智的是，您可以在收到请求时发送 HTTP 301 重定向响应`demo_form?name=ABC`

> 如果用户通过我的表单提交名称，那么使这两个 URL 有效的最佳方法是什么？

一般来说，访问表单不应该是任何涉及 GET 请求的先决条件。GET 的很大一部分意义在于结果是可收藏的、可链接的等。

如果它是一个 POST 请求会更容易理解，因为这些请求旨在更改服务器上的数据，并且您需要防止[CSFR](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29)。针对 CSRF 的标准保护是[存储在表单和 cookie 中的令牌](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#General_Recommendation%3a_Synchronizer_Token_Pattern)

# php - IPN POSTING：无法从贝宝接收邮资

> ID：14321940
> 
> 赞同：2
> 
> 时间：2013-01-14T15:57:56.063
> 
> 标签：php, paypal, paypal-ipn

任何人都可以帮助我了解 IPN 侦听器脚本。我尝试使用 IPN 的沙盒测试工具对其进行测试，但我总是得到一个无效的结果，但 HTTP 状态为 200。我还尝试回显 $_POST 数组，但它是空的..

这是我的代码

```
<?php

echo "<pre>".print_r($_POST,true)."</pre>\n";

$ipn_data=$_POST;

if((array_key_exists('test_ipn',$ipn_data)) && ($ipn_data['test_ipn']==1)){

    $url="https://www.sandbox.paypal.com/cgi-bin/webscr";

}
else{

    $url="https://www.paypal.com/cgi-bin/webscr";
    }

    $request=curl_init();
    curl_setopt_array($request,array
    (
        CURLOPT_URL=>$url,
        CURLOPT_POST=>true,
        CURLOPT_POSTFIELDS=>http_build_query(array('cmd'=>'_notify-validate')+ $ipn_data),
        CURLOPT_RETURNTRANSFER=>TRUE,
        CURLOPT_HEADER=>FALSE,
        CURLOPT_SSL_VERIFYPEER => false

    ));

    $result=curl_exec($request);
    $stat=curl_getinfo($request,CURLINFO_HTTP_CODE);
    curl_close($request);

    echo $result;
    echo $stat;
    if($stat==200 && $result=='VERIFIED'){

        echo "VERIFIED";

    }

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T19:45:37.710

也许您的问题是您没有在您的商家帐户中启用 IPN？“我的帐户”/“个人资料”/“销售偏好”/“即时付款通知偏好”。输入您的通知网址并将消息传递设置为启用。

# c# - 在选项卡之间切换时保留选项卡内容

> ID：14321942
> 
> 赞同：0
> 
> 时间：2013-01-14T15:58:01.153
> 
> 标签：c#, reportviewer

我的应用程序有一个报告选项卡，其中使用 Reportviewer 显示报告。如果用户在报表查看器中加载报表后切换到不同的选项卡，则在导航回报表选项卡时内容会重置。有没有办法保留当前的报告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T16:45:20.770

是否有代码刷新选项卡更改上的 ReportViewer 控件？这将导致报表在选项卡切换期间刷新。

# php - “调用非对象上的成员函数 fetch_row()”尽管有错误处理

> ID：14321946
> 
> 赞同：2
> 
> 时间：2013-01-14T15:58:14.953
> 
> 标签：php, mysql, mysqli

我想执行一个查询，但 php/mysql 抛出

> 在非对象上调用成员函数 fetch_row()

虽然

```
if(!$results) 
```

应该过滤掉空结果。错误消息指向

```
$row = $results->fetch_row(); 
```

这是整个代码：

```
<?php
$query = 'DELETE FROM `products` WHERE `company` ='.$id_nummer;

$results = $link->query($query);
if(!$results)
{
  echo $link->error;
}
else
{
  $row = $results->fetch_row();
  $wanted_result = $row[0];
}
?> 
```

造成这种情况的原因在哪里？

编辑：我通过替换解决了它

```
if(!$results) 
```

和

```
if(!is_object($results)) 
```

它有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:59:52.620

您无法从`DELETE`查询中获取结果，因为没有要获取的行。的内容`$results`是一个布尔值 true 或 false，基于 的成功或失败`DELETE`。

在您的情况下，它是`TRUE`，并且您的`if (!$results)`评估结果为`FALSE`，将您发送到`else`。

`$results`它本身会告诉您操作是否成功（查询在语法上是否有效），但`$link->affected_rows`会告诉您是否真的设法匹配和删除任何行。

```
if ($result && $link->affected_rows > 0) {
  // You managed to delete something
}
else if ($result) {
  // successful query, no rows deleted
}
else {
  // Error
  echo $link->error;
} 
```

由于您似乎正在使用 MySQLi，因此请考虑创建一个准备好的语句而不是`query()`为此。

```
$stmt = $link->prepare("DELETE FROM `products` WHERE `company` = ?");
$stmt->bind_param('i', $id_nummer);
$stmt->execute();

// Then check affected rows
if ($stmt->affected_rows > 0) {
  // Successful deletion of some rows...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T16:07:36.913

您正在尝试从查询中获取一行作为对象，但是您正在执行的查询是一个 DELETE，它不会返回可以作为一行获取的值，而是一个布尔值（TRUE 或 FALSE），即结果查询成功与否。在这种情况下，$result 应该返回值 TRUE 或 FALSE，可以像这样使用，例如：

```
<?php
$query = 'DELETE FROM `products` WHERE `company` ='.$id_nummer;    
$results = $link->query($query);

if(!$results) {
    echo $link->error;
} else {
    echo "Company id:".$in_number." successfully deleted."
}
?> 
```

# visual-studio-2010 - 作为 MSbuild 的一部分运行测试用例文件 (tst)

> ID：14321951
> 
> 赞同：0
> 
> 时间：2013-01-14T15:58:24.497
> 
> 标签：visual-studio-2010, msbuild, testcase

我正在使用 TFS 2010 和 Visual Studio 2010。我有一个指向我的解决方案的构建定义。构建在一夜之间运行

我有一组测试用例文件（* .tst），我希望我当前的构建将这些作为构建的一部分包含在内，并在一夜之间执行它们。测试用例文件在源代码控制中

我读到我必须使用 MsTest.exe 但不确定如何开始？

谁能指出我如何开始运行测试用例文件作为构建的一部分？请问有什么例子吗？

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:26:55.270

有几种方法可以让您的测试用例运行。一种方法是将调用过程或执行命令添加到构建项目文件或工作流中。在 AfterBuild 目标或工作流步骤中调用 mstest。另一种方法是将构建和测试用例分离到不同的构建中。

这里有几个链接可以帮助您入门：

[如何：在构建应用程序后配置和运行计划测试](http://msdn.microsoft.com/en-us/library/ms182465%28v=vs.100%29.aspx)

[带有 MSTest 的 MSBuild 示例](http://social.msdn.microsoft.com/Forums/en/msbuild/thread/cb87a184-6589-454b-bf1c-2e82771fc3aa)

*根据您的评论，此处更新了您可以执行的操作以获取有关错误的更多信息或在遇到错误时继续。如果您只想停止任何错误，则不需要检查错误代码，但如果您确实想检查错误代码，那么您将执行以下操作：

```
<Target Name="AfterBuild">
<Message Text="Running tests..." />
<PropertyGroup Label="TestSuccessOrNot">
    <TestSuccessOrNot>5</TestSuccessOrNot>
</PropertyGroup>
<!-- Run MSTest exe-->
<Exec Command="cd ." IgnoreExitCode="False" ContinueOnError="ErrorAndContinue">
    <Output TaskParameter="ExitCode" PropertyName="TestSuccessOrNot" />
</Exec>
<Message Text="ExitCode = $(TestSuccessOrNot)" />
<Error Condition="'$(TestSuccessOrNot)' != '0'" Text="Unit tests fail!" /> </Target> 
```

# mysql - 使用 order 子句更新许多记录

> ID：14321953
> 
> 赞同：0
> 
> 时间：2013-01-14T15:58:31.150
> 
> 标签：mysql, sql, ruby-on-rails

我用字段表词：评级和出现。

```
TABLE: words
+----+----------+----------------+
| id |occurrence| rating         |
+----+----------+----------------+
| 1  | 0.2      |       2        |
| 2  | 0.1      |       1        |
| 3  | 0.5      |       3        |
+----+----------+----------------+ 
```

评级 它是按出现（asc）列排序的索引。所以首先我必须对所有记录进行排序，然后对评级列中的每个记录集索引进行排序。如何在 SQL 中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T16:04:09.950

```
UPDATE   words, (SELECT @rating := 0) init
SET      rating = (@rating := @rating + 1)
ORDER BY occurrence 
```

# facebook-login - FB 登录 OAuthException: (#803)

> ID：14321955
> 
> 赞同：-3
> 
> 时间：2013-01-14T15:58:34.940
> 
> 标签：facebook-login, facebook-oauth

我的 SMForum 和 FB 之间的连接正在发生，但是当我尝试在应用程序上注册时，它显示： OAuthException: (#803) 您请求的某些别名不存在：me&fields=id,name,username 这是什么意思？ ? 我已经尝试了无数种方法将我的论坛个人资料与 FB 联系起来，但它一直给我同样的错误！请...任何帮助、建议甚至祝福都会非常非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T18:25:27.907

> OAuthException: (#803) 您请求的某些别名不存在：me&fields=id,name,username

这意味着不支持使用该调用。

很可能你的意思是

```
graph.facebook.com/me?fields=id,name,username 
```

注意`?`而不是`&`

# android - 获得完成尚未停用或关闭的游标错误

> ID：14321957
> 
> 赞同：0
> 
> 时间：2013-01-14T15:58:46.640
> 
> 标签：android, sqlite, cursor

大家好，我是 Android 新手，我正在使用 SQLiteDataBase，我收到关于光标未关闭的错误，这不是致命的，但很烦人。就这个。

```
01-14 15:53:42.503: E/Cursor(1090): Finalizing a Cursor that has not been deactivated or closed. database = /data/data/uk.ac.tees.L1087591/databases/Wettboff.db, table = webpages, query = SELECT _id, url, source, date FROM webpages WHERE _id=?
01-14 15:53:42.503: E/Cursor(1090): android.database.sqlite.DatabaseObjectNotClosedException: Application did not close the cursor or database object that was opened here
01-14 15:53:42.503: E/Cursor(1090):     at android.database.sqlite.SQLiteCursor.<init>(SQLiteCursor.java:210)
01-14 15:53:42.503: E/Cursor(1090):     at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:53)
01-14 15:53:42.503: E/Cursor(1090):     at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1345)
01-14 15:53:42.503: E/Cursor(1090):     at android.database.sqlite.SQLiteDatabase.queryWithFactory(SQLiteDatabase.java:1229)
01-14 15:53:42.503: E/Cursor(1090):     at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1184)
01-14 15:53:42.503: E/Cursor(1090):     at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1301)
01-14 15:53:42.503: E/Cursor(1090):     at uk.ac.tees.L1087591.DatabaseHandler.getWebPage(DatabaseHandler.java:237)
01-14 15:53:42.503: E/Cursor(1090):     at uk.ac.tees.L1087591.Web.onCreate(Web.java:54)
01-14 15:53:42.503: E/Cursor(1090):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
01-14 15:53:42.503: E/Cursor(1090):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
01-14 15:53:42.503: E/Cursor(1090):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
01-14 15:53:42.503: E/Cursor(1090):     at android.app.ActivityThread.access$2300(ActivityThread.java:125)
01-14 15:53:42.503: E/Cursor(1090):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
01-14 15:53:42.503: E/Cursor(1090):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-14 15:53:42.503: E/Cursor(1090):     at android.os.Looper.loop(Looper.java:123)
01-14 15:53:42.503: E/Cursor(1090):     at android.app.ActivityThread.main(ActivityThread.java:4627)
01-14 15:53:42.503: E/Cursor(1090):     at java.lang.reflect.Method.invokeNative(Native Method)
01-14 15:53:42.503: E/Cursor(1090):     at java.lang.reflect.Method.invoke(Method.java:521)
01-14 15:53:42.503: E/Cursor(1090):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
01-14 15:53:42.503: E/Cursor(1090):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
01-14 15:53:42.503: E/Cursor(1090):     at dalvik.system.NativeStart.main(Native Method) 
```

这是对数据库的抱怨。

```
01-14 15:53:42.653: E/Database(1090): close() was never explicitly called on database '/data/data/uk.ac.tees.L1087591/databases/Wettboff.db' 
01-14 15:53:42.653: E/Database(1090): android.database.sqlite.DatabaseObjectNotClosedException: Application did not close the cursor or database object that was opened here
01-14 15:53:42.653: E/Database(1090):   at android.database.sqlite.SQLiteDatabase.<init>(SQLiteDatabase.java:1810)
01-14 15:53:42.653: E/Database(1090):   at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:817)
01-14 15:53:42.653: E/Database(1090):   at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:851)
01-14 15:53:42.653: E/Database(1090):   at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:844)
01-14 15:53:42.653: E/Database(1090):   at android.app.ContextImpl.openOrCreateDatabase(ContextImpl.java:540)
01-14 15:53:42.653: E/Database(1090):   at android.content.ContextWrapper.openOrCreateDatabase(ContextWrapper.java:203)
01-14 15:53:42.653: E/Database(1090):   at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:98)
01-14 15:53:42.653: E/Database(1090):   at android.database.sqlite.SQLiteOpenHelper.getReadableDatabase(SQLiteOpenHelper.java:158)
01-14 15:53:42.653: E/Database(1090):   at uk.ac.tees.L1087591.DatabaseHandler.getWebPage(DatabaseHandler.java:236)
01-14 15:53:42.653: E/Database(1090):   at uk.ac.tees.L1087591.Web.onCreate(Web.java:54)
01-14 15:53:42.653: E/Database(1090):   at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
01-14 15:53:42.653: E/Database(1090):   at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
01-14 15:53:42.653: E/Database(1090):   at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
01-14 15:53:42.653: E/Database(1090):   at android.app.ActivityThread.access$2300(ActivityThread.java:125)
01-14 15:53:42.653: E/Database(1090):   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
01-14 15:53:42.653: E/Database(1090):   at android.os.Handler.dispatchMessage(Handler.java:99)
01-14 15:53:42.653: E/Database(1090):   at android.os.Looper.loop(Looper.java:123)
01-14 15:53:42.653: E/Database(1090):   at android.app.ActivityThread.main(ActivityThread.java:4627)
01-14 15:53:42.653: E/Database(1090):   at java.lang.reflect.Method.invokeNative(Native Method)
01-14 15:53:42.653: E/Database(1090):   at java.lang.reflect.Method.invoke(Method.java:521)
01-14 15:53:42.653: E/Database(1090):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
01-14 15:53:42.653: E/Database(1090):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
01-14 15:53:42.653: E/Database(1090):   at dalvik.system.NativeStart.main(Native Method) 
```

这是我的 DatabaseHandler 类

```
public class DatabaseHandler extends SQLiteOpenHelper {

    /**
     * The name of the database
     */
     protected static final String DATABASE_NAME = "Wettboff.db";

    /**
     * The name of the table.
     */
     protected static final String TABLE_NAME = "webpages";

    /**
     * The name of the first column (ID)
     */
     protected static final String COL_ID = "_id";

    /**
     * The name of the second column (URL)
     */
     protected static final String COL_url = "url";

    /**
     * The name of the third column (source)
     */
     protected static final String COL_source = "source";

     /**
      * The name of the fourth column (date)
      */
     protected static final String COL_date = "date";

    /**
     * A constructor which builds a DatabaseHandler object. Note that calling
     * the constructor does not create a database. This does not happen until
     * the first call to getReadableDatabase() or getWriteableDatabase()
     * 
     * @param context ,  In this case, a reference to webpageActivity
     */
    public DatabaseHandler(Context context) {
        super(context, DATABASE_NAME, null, 1);
    }

    /**
     * This method is called when the database is created for the first time.
     * This is where the creation of tables and the initial population of the
     * tables should happen.
     */
    @Override
    public void onCreate(SQLiteDatabase db) {
        String CREATE_CONTACTS_TABLE = "CREATE TABLE " + TABLE_NAME + "("
                + COL_ID + " INTEGER PRIMARY KEY," + COL_url + " TEXT,"
                + COL_source + " TEXT," + COL_date + " TEXT" + ");";
        Log.d("Table name in onCreate", TABLE_NAME);
        db.execSQL(CREATE_CONTACTS_TABLE);
        Log.d("WebOff", "Database populated");
    }

    /**
     * Called when the database needs to be upgraded. Only relevant when you
     * have multiple versions of the database scheme in play.
     * 
     */
    @Override
    public void onUpgrade(SQLiteDatabase db, int oldNum, int newNum) {
        // Drop older table if exist and create fresh
        Log.w("Updating database: ", " Upgrading database from version " + oldNum
                + " to "
                + newNum + ", which will destroy all old data");
        db.execSQL("DROP TABLE IF EXISTS " + TABLE_NAME);
        onCreate(db);
    }

    /**
     * Use this method to add a webpage to the database.
     * 
     * @param webpage
     *            the webpage you want to add
     */
    public void addWebPage(List<WebPage> webpage) {
        SQLiteDatabase db = this.getWritableDatabase();
        ContentValues values = new ContentValues();
        for (WebPage lr : webpage) {
            values.put(COL_ID, lr.getID());
            values.put(COL_url, lr.getUrl());
            values.put(COL_source, lr.getSource());
            values.put(COL_date, lr.getDate());
        }
        db.insert(TABLE_NAME, null, values);
        db.close();
    }

    /**
     * Use this method to add a webpage to the database.
     * 
     * @param webpage
     *            the webpage you want to add
     */
    public void addWebPage(WebPage webpage) {
        SQLiteDatabase db = this.getWritableDatabase();
        ContentValues values = new ContentValues();
        values.put(COL_ID, webpage.getID());
        values.put(COL_url, webpage.getUrl());
        values.put(COL_source, webpage.getSource());
        values.put(COL_date, webpage.getDate());
        db.insert(TABLE_NAME, null, values);
        db.close();
    }

    /**
     * Use this method to get all of the webpages in the database.
     * 
     * @return a list of webpage objects, one per row
     */
    public List<WebPage> getAll() {
        List<WebPage> list = new ArrayList<WebPage>();
        String selectQuery = "SELECT  * FROM " + TABLE_NAME;
        SQLiteDatabase db = this.getReadableDatabase();
        Cursor cursor = db.rawQuery(selectQuery, null);
        if (cursor.moveToFirst()) {
            do {
                WebPage webpage = new WebPage(cursor.getInt(0),
                        cursor.getString(1), cursor.getString(2), cursor.getLong(3));
                list.add(webpage);
            } while (cursor.moveToNext());
        }
        return list;
    }

    /**
     * Use this method to get a Cursor object that points at all the webpages in 
     * the database
     * 
     * @return a Cursor object pointing at all webpages in db
     */
    public Cursor getAllAsCursor() {
        String selectQuery = "SELECT  * FROM " + TABLE_NAME;
        SQLiteDatabase db = this.getReadableDatabase();
        Cursor cursor = db.rawQuery(selectQuery, null);
        return cursor;
    }

    /**
     * Use this method to remove all of the webpages from the database. This is
     * useful when experimenting. After dropping all tables, the initial state
     * of the database is re-created.
     */
    public void removeAll() {
        SQLiteDatabase db = this.getWritableDatabase();
        db.execSQL("DROP TABLE IF EXISTS " + TABLE_NAME);
        onCreate(db);
    }

    /**
     * This method removes one webpage from the database.
     * 
     * @param webpage
     *            the webpage to remove
     */
    public void deletewebpage(int id) {
        SQLiteDatabase db = this.getWritableDatabase();

        db.delete(TABLE_NAME, COL_ID + " = ?",
                new String[] { String.valueOf(id)});
        db.close();
    }

    /**
     * This method updates the data stored in the database for one webpage.
     * 
     * @param webpage
     *            the webpage to update
     * @return the number of rows affected
     */
    public int updateWebPage(WebPage pages) {

            SQLiteDatabase db = this.getWritableDatabase();
            ContentValues values = new ContentValues();
//          values.put(COL_ID, lr.getID());
            values.put(COL_url, pages.getUrl());
            values.put(COL_source, pages.getSource());
            values.put(COL_date, pages.getDate());
            return db.update(TABLE_NAME, values, COL_ID + " = ?",
                    new String[] { String.valueOf(((WebPage) pages).getID()) });
    }

    /**  
     * This method gets a single webpage from the database, using the ID field
     * as a key
     * ;
     * @param id
     *            the ID of the webpage we want
     * @return a webpage object
     */
    public WebPage getWebPage(int id) {
        SQLiteDatabase db = this.getReadableDatabase();
        Cursor cursor = db.query(TABLE_NAME, new String[] { COL_ID, COL_url,
                COL_source, COL_date }, COL_ID + "=?",
                new String[] { String.valueOf(id) }, null, null, null, null);
        if (cursor != null) {
            cursor.moveToFirst();
        }
        WebPage webpage = new WebPage(Integer.parseInt(cursor.getString(0)),
                cursor.getString(1), cursor.getString(2), cursor.getLong(3));
        return webpage;
    }
} 
```

当我尝试使用以下代码阅读多个网页时

```
public class Read extends MenuActivity {

    /**
     * sca is an object of type SimpleCursorAdapter and we use it to set the
     * adapter.
     */
    private SimpleCursorAdapter sca;

    /**
     * dh is an object of type DatabaseHandler and we use it to connet to the
     * data base.
     */
    private DatabaseHandler dh;

    /**
     * mainListView is a List View.
     */
    private ListView mainListView;

    /**
     * context is a Content that takes the current one(this)
     */
    private final Context context = this;

    /**
     * myId stores the id of the selected url
     */
    protected static int myId;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_read);
        mainListView = (ListView) findViewById(R.id.mainListView);
        dh = new DatabaseHandler(this);

        /**
         * Get a Cursor pointing at all web pages in the database
         */
        final Cursor cursor = dh.getAllAsCursor();

        /**
         * cols gets the value of the COL_url
         */
        String[] cols = new String[] { DatabaseHandler.COL_url };

        /**
         * to get the value of the url_entry.
         */
        int[] to = new int[] { R.id.url_entry };
        sca = new SimpleCursorAdapter(this, R.layout.read, cursor, cols, to, 2);
        mainListView.setAdapter(sca);
        mainListView.showContextMenu();
        registerForContextMenu(mainListView);

        // when the user does a longclick
        mainListView.setOnItemLongClickListener(new OnItemLongClickListener() {
            @Override
            public boolean onItemLongClick(AdapterView<?> arg0, View arg1,
                    int id, long arg3) {
                myId = id;
                Log.d("WebOff ",
                        "Web page read:  id number in OnItemLongCLick " + id);
                cursor.close();
                return false;
            }
        });

    }

    @Override
    public void onCreateContextMenu(ContextMenu menu, View v,
            ContextMenuInfo menuInfo) {
        super.onCreateContextMenu(menu, v, menuInfo);
        menu.setHeaderTitle("WebOff Menu");
        menu.add(0, v.getId(), 0, "Read using WebOff");
        menu.add(0, v.getId(), 0, "Read using web browser");
    }

    @Override
    public boolean onContextItemSelected(MenuItem item) {
        if (item.getTitle() == "Read using WebOff") {
            readUsingWebOff(item.getItemId());
        } else if (item.getTitle() == "Read using web browser") {
            readUsingWebBrowser(item.getItemId());
        } else {
            return false;
        }
        return true;
    }

    /**
     * readUsingWebOff goes to the Web activity.
     * 
     * @param id
     *            of the web Page
     */
    public void readUsingWebOff(int id) {
        Toast.makeText(this, "WebOff called", Toast.LENGTH_SHORT).show();
        Intent k = new Intent(context, Web.class);
        startActivity(k);
    }

    /**
     * readUsingWebBrowser() reads the web pages through the web broweser.
     * 
     * @param id
     *            of the web page.
     */
    public void readUsingWebBrowser(int id) {
        Toast.makeText(this, "Web browser called", Toast.LENGTH_SHORT).show();
        WebPage page = dh.getWebPage(Read.myId);
        String myUrl = page.getUrl();
        Uri uri = Uri.parse(myUrl);

//      dh.close();

        Intent intent = new Intent(Intent.ACTION_VIEW, uri);
        startActivity(intent);
    }

} 
```

我得到光标异常。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T16:03:56.130

您需要正确关闭游标和数据库。将您的 getWebPage() 方法修改为以下内容：

```
public WebPage getWebPage(int id) {
    SQLiteDatabase db = this.getReadableDatabase();
    Cursor cursor = db.query(TABLE_NAME, new String[] { COL_ID, COL_url,
            COL_source, COL_date }, COL_ID + "=?",
            new String[] { String.valueOf(id) }, null, null, null, null);
    WebPage webpage = null;
    if (cursor != null) {
        if (cursor.moveToFirst()) {
            webpage = new WebPage(Integer.parseInt(cursor.getString(0)), cursor.getString(1), cursor.getString(2), cursor.getLong(3));
        }
        cursor.close();
    }
    return webpage; // be aware, it might return null now!
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T16:04:50.977

称呼：

```
cursor.close(); 
```

只要你有一个打开的光标，你就完成了（即在你的`getAll()`方法中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-09T03:22:44.050

您应该在 finally try-catch 中关闭数据库连接

```
String sqlQuery = "SELECT ....";

    Cursor c = null;
    try {
        c = this.rawQuery(sqlQuery, new String[] { params });
        if (c.moveToFirst()) {
            do {
                parseCusors(c);
            } while (c.moveToNext());
        }
    } catch (Exception e) {
        e.printStackTrace();
    } finally {
        if (c != null) {
            try {c.close();} catch (Exception ignore) {;}
        }
    } 
```

# php - 从多维数组构建无序列表而不递归

> ID：14321962
> 
> 赞同：0
> 
> 时间：2013-01-14T15:59:10.603
> 
> 标签：php, tree, treeview, tree-traversal

我从包含实体及其子项的多维数组构建无序列表时遇到问题。问题是我不想使用递归，因为树可能会变得很深，递归可能会在服务器上产生不必要的负载。

这是这样一个数组的一个例子（它被简化为包含`title`并且`children`实体也可以是对象）。

```
$array = array(
    array('title' => '1', 'children' => array()),
    array('title' => '2', 'children' => array()),
    array('title' => '3', 'children' => array()),
    array('title' => '4', 'children' => array(
        array('title' => '41', 'children' => array()),
        array('title' => '42', 'children' => array()),
        array('title' => '43', 'children' => array()),
        array('title' => '44', 'children' => array(
            array('title' => '441', 'children' => array()),
            array('title' => '442', 'children' => array()),
            array('title' => '443', 'children' => array()),
            array('title' => '444', 'children' => array(
                array('title' => '4441', 'children' => array()),
                array('title' => '4442', 'children' => array()),
                array('title' => '4443', 'children' => array())
            )),
        )),
        array('title' => '45', 'children' => array())
    )),
    array('title' => '5', 'children' => array()),
    array('title' => '6', 'children' => array(
        array('title' => '61', 'children' => array()),
        array('title' => '62', 'children' => array()),
        array('title' => '63', 'children' => array())
    )),
    array('title' => '7', 'children' => array())
); 
```

在这里做一些研究，所以我想出了这个非常接近我想要的解决方案：

```
<html>
<head></head>
<body>
<ul>
<?php
$stack = $array;
$i = 0;
$counts = array();
while(!empty($stack)) {
    $node = array_shift($stack);
    echo "<li>{$node['title']}";
    if($node['children']) {
        echo "<ul>";
        $counts[] = count($node['children']);
        $node['children'] = array_reverse($node['children']);
        foreach($node['children'] as $ch)
            array_unshift($stack, $ch);
    }
    if(!empty($counts)) {
        end($counts);
        if($counts[$key] == 0) {
            echo "</ul>";
            array_pop($counts);
        } else {
            $counts[$key]--;
        }
    }
    if(!$node['children']) {
        echo "</li>";
    }

    // just to make sure we won't end in infinite loop
    $i++;
    if($i == 50) break;
}
?>
</ul>
</body>
</html> 
```

输出如下 - 如您所见，我遇到的问题只是`</ul>`子树的关闭。**我的问题**：我是不是想多了，还是我瞎了眼，没有看到明显的错误？您能否将我推向有限的解决方案或给我您自己的解决方案？

输出：

*   1
*   2
*   3
*   4
    *   41
    *   42
    *   43
    *   44
        *   441
        *   442
        *   443
        *   444
            *   4441
            *   4442
            *   4443
        *   45
    *   5
    *   6
        *   61
        *   62
        *   63
*   7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:48:10.210

这不是对您的代码的修复，但也许它无论如何都会对您有所帮助：

```
function helper($input) {
  $input[] = '</ul>';
  $input = array_reverse($input);
  $input[] = '<ul>';

  // output
  while (sizeof($input) > 0) {
    $el = array_pop($input);

    if (!is_array($el)) {
      echo $el; 
    }
    else {
      // add current element
      $input[] = sprintf('<li>%s', $el['title']);

      // add children
      if (sizeof($el['children']) > 0) {
        $input[] = '</ul>';
        $input = array_merge($input, array_reverse($el['children']));
        $input[] = '<ul>';
      }

      // add closing li
      $input[] = '</li>';
    }
  }
}

helper($array); 
```

演示：[http ://codepad.viper-7.com/qin15V](http://codepad.viper-7.com/qin15V)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T16:30:34.083

好的，就像往常一样 -`ask for a solution You are solving for hours and immediately You are out with one...`我在稍作放松后想出了这个解决方案：

```
<html>
<head></head>
<body>
<ul>
<?php
$i = 0;
$counts = array();
while(!empty($stack)) {
    $node = array_shift($stack);
    if(!empty($counts)) {
        while(end($counts) === 0) {
            $key = key($counts);
            echo "</li></ul>";
            array_pop($counts);
        }
        end($counts);
        $key = key($counts);
        if(isset($counts[$key])) {
            $counts[$key]--;
        }
    }
    echo "<li>{$node['title']}";
    if($node['children']) {
        echo "<ul>";
        $counts[] = count($node['children']);
        $node['children'] = array_reverse($node['children']);
        foreach($node['children'] as $ch)
            array_unshift($stack, $ch);
    }
    if(!$node['children']) {
        echo "</li>";
    }

    $i++;
    if($i == 50) break;
}
?>
</ul>
<p>$i = <?php echo $i; ?></p>
</body>
</html> 
```

问题是我错过了另一个`while`应该一直减去`$counts`树的值......

我会等待接受我自己的答案，以防有人会发布他们应该接受的更好的解决方案，而不是我*不那么整洁*的解决方案。

# c# - SevenZipSharp 库：无法加密标头

> ID：14321964
> 
> 赞同：0
> 
> 时间：2013-01-14T15:59:12.770
> 
> 标签：c#, c#-4.0, sevenzipsharp

我的任务是使用 SevenZipSharp 库创建受密码保护的 ZIP。

我设法用密码锁定了文件内容，但是存档结构 - 文件名、目录层次结构可以在任何 WinZip、7-Zip 或 Compressed 文件夹中查看。

我用了，`cmp.EncryptHeaders = true;`但是好像没什么效果...

如何加密文件和目录名称？谢谢。

```
 static void Main(string[] args)
    {
        const string LibraryPath = @"C:\Program Files\7-Zip\7z.dll";
        SevenZipCompressor.SetLibraryPath(LibraryPath);

        var cmp = new SevenZipCompressor();
        cmp.CompressionMethod = CompressionMethod.Default;
        cmp.CompressionLevel = CompressionLevel.Fast;
        cmp.ArchiveFormat = OutArchiveFormat.Zip;  // compatible with WinZip and Compressed folder
        cmp.ZipEncryptionMethod = ZipEncryptionMethod.ZipCrypto;  // compatible with old WinZip
        cmp.EncryptHeaders = true;

        cmp.FileCompressionStarted += (sender, e) =>
        {
            Console.WriteLine(((FileNameEventArgs)e).FileName);
        };

        const string archive = @"C:\temp\12.3G.zip";
        File.Delete(archive);
        cmp.CompressDirectory(@"C:\temp\Photos", archive, "password");
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T16:07:14.203

查看源代码，该标志生效的唯一方法似乎是`SevenZip`使用`OutArchiveFormat`.

从源代码：

```
if (EncryptHeaders && _archiveFormat == OutArchiveFormat.SevenZip && !SwitchIsInCustomParameters("he"))
{
    names.Add(Marshal.StringToBSTR("he"));
    var tmp = new PropVariant {VarType = VarEnum.VT_BSTR, Value = Marshal.StringToBSTR("on")};
    values.Add(tmp);
} 
```

# javascript - 获取 javascript 以裁剪打印页面

> ID：14321965
> 
> 赞同：0
> 
> 时间：2013-01-14T15:59:15.600
> 
> 标签：javascript, html, printing

我目前正在使用 javascript 生成和打印（从东芝 POS 打印机）收据（使用标准：

```
window.print(); 
```

方法）和 html，这工作正常，但收据打印为 A4 大小，并在收据内容下方留下一个大的空白区域。不必要地使用大量纸张。有什么办法可以将打印的页面大小裁剪到内容的高度？

# oracle - JPA 2 Criteria Day from date

> ID：14321973
> 
> 赞同：1
> 
> 时间：2013-01-14T15:59:26.967
> 
> 标签：oracle, select, jpa-2.0

我在表格中有一个字段，它存储了一个日期。我想选择日期为第 5 天的所有记录。

经过大量研究，我得到以下代码：

```
 Predicate dayValue = cb.equal(cb.function("day", Integer.class, test.<Date>get(Test_.dateInit)), now.get(Calendar.DAY_OF_MONTH) ); 
```

但是，我使用的是 Oracle 数据库，它没有功能日：

```
[EL Warning]: 2013-01-14 11:51:08.001--UnitOfWork(23011228)--Thread(Thread[main,5,main])--Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.1.2.v20101206-r8635): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: java.sql.SQLException: ORA-00904: "DAY": invalid identifier 
```

还有其他方法可以进行此选择吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:38:13.947

我有办法。

在函数方法中使用oracle的函数to_char：

```
Predicate dayValue = cb.equal(cb.function("to_char", Integer.class, test.<Date>get(Test_.dateInit),cb.parameter(String.class, "dayFormat")), now.get(Calendar.DAY_OF_MONTH) );
...
q.setParameter("dayFormat", "DD"); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-14T16:27:24.850

在 Oracle 中，您可以使用

```
select to_char (date '2013-01-14', 'D') d from dual; 
```

给你天数，上面将输出 1 表示星期一

如果你想看星期一就换成

```
select to_char (date '2013-01-14', 'Day') d from dual; 
```

以上将在星期一输出

希望有帮助。

# c++ - C++ 从字符串调用方法

> ID：14321974
> 
> 赞同：1
> 
> 时间：2013-01-14T15:59:30.350
> 
> 标签：c++, qt

Qt 中有这样的功能：`QMetaObject::invokeMethod(QObject * obj, const char * member, ...)`，它从字符串（成员）调用方法。我怎么能做同样的（或类似的）？谢谢）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T16:02:06.633

您不能在纯 C++ 中执行此操作，但您可以在[此](https://stackoverflow.com/questions/41453/how-can-i-add-reflection-to-a-c-application)问题中阅读有关 C++ 中的反射/内省的信息

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-14T17:08:22.507

类似的事情可以通过 a 来实现`map<std::string, std::function<void()>>`：

```
std::map<std::string, std::function<void()>> funs;
funs["hello world"] = [] () { std::cout << "hello world"; };
funs["hello world"](); 
```

问题是*你想要它有多相似？* *通话应该如何“原生”？*. 您可以执行以下操作：

```
void foobar(int, float);

...

    invoke("foobar", 5, 5.f); 
```

但是实现看起来很hacky并且不平凡。

有[一个相关的问题](https://stackoverflow.com/a/11262039/76722)：

> 您可以使用可变参数模板和一些模板/虚拟技术走得很远。使用以下代码，您将能够执行以下操作：

```
std::string select_string (bool cond, std::string a, std::string b) {
    return cond ? a : b;
}

int main () {
    Registry reg;
    reg.set ("select_it", select_string);
    reg.invoke ("select_it", "1 John Wayne"));
    reg.invoke ("select_it", "0 John Wayne"));
} 
```

即，参数列表被分解为本地函数调用的真实参数列表。使用可变参数模板，您可以做很多事情；我不确定您是否*应该这样*做。

# css - 收集外部 div

> ID：14321983
> 
> 赞同：0
> 
> 时间：2013-01-14T15:59:56.800
> 
> 标签：css, html, hyperlink, rss

我想在我的网站 (sn0wy0wl.com) 上显示我的提要，但我目前将我的数据上传到 RSSPECT.com。

我已经设法显示了整个 RSSPECT 提要页面，但我只是希望它专门显示 Div div#feedBody 这肯定是可能的，到目前为止我还没有运气。

我目前的代码：

```
<div style="margin: 0 auto; width:100%; height:400px; overflow: auto;">
<object type="text/html" data="http://www.rsspect.com/rss/feedtestfilename.xml"
 style="width:100%; height:400px; margin:1px;">
</object>
</div> 
```

# regex - 使用 <> 和正则表达式搜索和替换文本文件中的元素

> ID：14321986
> 
> 赞同：4
> 
> 时间：2013-01-14T15:59:59.833
> 
> 标签：regex, perl

我正在*学习 Perl*的第 9 章“使用正则表达式处理文本”。

以下是两章结尾的练习：

> 1.  编写一个程序，为到目前为止的所有练习答案添加版权行，`## Copyright (c) 20XX by Yours Truly`在文件中的“shebang”行之后立即放置一行。假设程序将被调用，文件名已经在命令行上进行编辑。
>     
>     
> 2.  修改之前的程序，使其不编辑已经包含版权行的文件。作为对此的提示，您可能需要知道菱形运算符正在读取的文件的名称在 $ARGV 中。

这是我尝试的解决方案：

```
#!/usr/bin/env perl

use 5.014;
use warnings;

my $shebang     = '(#!/usr/bin/env perl|#!/usr/bin/perl)'; 
my $copyright   = '# Copyright (c) 20XX Yours Truly'; 

$^I = ".bak";

while (<>) {
    unless (/$copyright/mi) {
        s/($shebang)/$1\n$copyright/mig;
    }
    print;
} 
```

在命令行上运行`perl ch9.pl sample_perl_script.pl`.

我的目标是：

*   无论路径如何，都保持原始 shebang 完整。
*   只循环`<>`一次。
*   检查版权声明是否存在。
*   如果没有，请添加它（因此尝试使用`unless { ... }`）。

这适用于问题的第一部分（添加版权行），但不适用于第二部分（检查以确保版权不存在）。

我的问题是：为什么？为什么`unless`我运行程序时完全忽略了？

我看了看附录，书中提出的解决方案是创建一个哈希来跟踪文件名`$ARGV`，然后将文件传递*两次*。首先删除已经有版权声明的文件，然后执行搜索/替换。像这样：

```
my %do_these;
foreach (@ARGV) {
    $do_these{$_} = 1;
}

while (<>) { 
    if (/\A## Copyright/) {
        delete $do_these{$ARGV};
    }
}

@ARGV = sort keys %do_these; 
$^I = ".bak";
while (<>) {
    if (/\A#!/) {
        $_ .= "## Copyright (c) 20XX by Yours Truly\n";
    }
    print;
} 
```

这当然有效，但似乎是工作的两倍。我正在尝试使用我的方法来查看是否有办法在单个`while (<>) { ... }`循环中执行此操作，并更好地了解菱形运算符的工作原理。

如果我的方法完全偏离基础，请解释原因，不要吝啬我的感受。我对完全理解比我的自我更感兴趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T16:24:50.773

你这本书的方法*很*愚蠢。实际上，我认为 perl 令人讨厌，因为您的版权声明有特殊字符，例如`(`.

你想要的是`quotemeta`功能。[关联](http://perldoc.perl.org/functions/quotemeta.html)

我会像这样更改您的程序：

```
while (<>) {
    my $copyright2 = quotemeta $copyright;
    unless (/$copyright2/mi) {
        s/($shebang)/$1\n$copyright/mig;
    }
    print;
} 
```

抱歉，如果这不起作用。自从我写 perl 以来已经有一段时间了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T17:09:59.450

您的`unless`不起作用，因为版权与shebang不在同一行。菱形运算符读取一行直到 的第一个值`$/`，默认情况下是换行符。您的程序将对所有不包含版权的*行执行替换。*

由于这是 perl，因此有很多方法可以修复它。最直接的方法可能是取消设置`$/`和 slurp 文件（将其全部读入一行）。这样您就可以立即检查文件的第二行是否有版权声明。例如：

```
local $/;                                     # slurp the file
while (<>) {
    s/^.*\n\K(?!\Q$copyright\E)/$copyright/;  # negative lookahead assertion
    print;
} 
```

您还可以直接检查文件中的第 2 行，而无需破坏文件：

```
while (<>) {
    if ($. == 2) {
         unless (/\Q$copyright/) {
               print "$copyright\n";
         }
    }
    print;
    close ARGV if eof;                # this will reset the line counter $.
} 
```

请注意，Nick ODell 是正确的，您的版权字符串包含必须转义的元字符（即括号）。我`\Q ... \E`在上面使用了转义序列。

另请注意，您不需要非常具体地检查 shebang，这更有可能让您在稍微不同的线路上绊倒。

# c# - ASP.NET Web API 中不允许 HTTP PUT

> ID：14321988
> 
> 赞同：25
> 
> 时间：2013-01-14T16:00:04.773
> 
> 标签：c#, asp.net-web-api, iis-7.5

在我的 Web API 项目中，我无法`HTTP PUT`对我的资源执行操作。我已经阅读了[有关](https://stackoverflow.com/questions/10099270/asp-net-web-api-returns-404-for-put-only-on-some-servers?rq=1)[此](https://stackoverflow.com/questions/12136143/put-and-delete-returns-404-for-asp-net-webapi-in-windows-2008-server-iis-7-and-7?rq=1)[问题的](http://geekswithblogs.net/michelotti/archive/2011/05/28/resolve-404-in-iis-express-for-put-and-delete-verbs.aspx)[一些](https://stackoverflow.com/questions/10906411/asp-net-web-api-put-delete-verbs-not-allowed-iis-8) [类似](https://stackoverflow.com/questions/11727525/asp-net-mvc-web-api-http-put-and-delete-requests-failing) [问题](https://stackoverflow.com/questions/9854602/asp-net-web-api-405-http-verb-used-to-access-this-page-is-not-allowed-how) ，并且遵循了推荐的建议。

首先，我在我的机器（Windows 7 64 位）上完全卸载了 WebDAV，然后重新启动了我的机器。

其次，WebDAV 处理程序在 my 中被指定为删除，`web.config`动词`HTTP PUT`被指定为允许用于无扩展 URL 处理程序。

```
<modules runAllManagedModulesForAllRequests="false">
  <remove name="WebDAVModule"/>
</modules>

<handlers>
  <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
  <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
  <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
  <remove name="WebDAV"/>
  <add name="ExtensionlessUrlHandler-Integrated-4.0"
       path="*."
       verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS"
       type="System.Web.Handlers.TransferRequestHandler"
       resourceType="Unspecified"
       requireAccess="Script"
       preCondition="integratedMode,runtimeVersionv4.0" />
  <add name="AttributeRouting" path="routes.axd" verb="*" type="AttributeRouting.Web.Logging.LogRoutesHandler, AttributeRouting.Web" />
</handlers> 
```

我什至尝试添加 ISAPI 无扩展 URL 处理程序（32 位和 64 位）并将我的应用程序从集成管道应用程序池更改为经典应用程序池。

```
<add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit"
      path="*."
      verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS"
      modules="IsapiModule"
      scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll"
      preCondition="classicMode,runtimeVersionv4.0,bitness32"
      responseBufferLimit="0" />
<add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit"
      path="*."
      verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS"
      modules="IsapiModule"
      scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll"
      preCondition="classicMode,runtimeVersionv4.0,bitness64"
      responseBufferLimit="0" /> 
```

我目前正在使用[Thinktecture IdentityModel](http://nuget.org/packages/Thinktecture.IdentityModel)来启用跨域资源共享 (CORS) 支持。为了我的理智，我已经选择了启用一切以确保`HTTP PUT`实际允许的核选项。

```
config.RegisterGlobal(httpConfig);

config.ForAllResources()
      .ForAllOrigins()
      .AllowAllMethods()
      .AllowAllRequestHeaders(); 
```

[属性路由](http://attributerouting.net/)NuGet 包配置为从当前程序集和`ApiController`.

```
config.AddRoutesFromAssembly(Assembly.GetExecutingAssembly());
config.AddRoutesFromControllersOfType<ApiController>(); 
```

我的资源也具有`PUT`正确指定的属性。

```
[PUT("/API/Authenticate/Link/{key}/{identifier}")]
public Boolean LinkUser(Guid key, String identifier) { ... } 
```

我在这个问题上查找的每个资源都推荐相同的东西：卸载 WebDAV，禁用 WebDAV 处理程序并确保正确配置无扩展 URL 处理程序。我已经完成了所有这些，但它**仍然**不起作用。

在提琴手中，我得到以下信息：

```
PUT https://localhost/Test/API/Authenticate/Link/Foo/Bar

{"Message":"The requested resource does not support http method 'PUT'."} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-14T16:50:49.480

显然，存在一个已知问题，`AttributeRouting`其中`HttpPut`方法当前在 ASP.NET Web API 中不起作用。

当前[接受的解决方法](https://github.com/mccalltd/AttributeRouting/issues/96)是将适当的动词添加到路线上，直到出现适当的修复：

> Web API RC 为底层框架的路由检测密封了一个重要的接口。虽然接口现在是公开的，但直到 vNext 才会发布更改。所以这里有一些解决方法：
> 
> *   将 AR 属性与 System.Web.Http 中的 HttpGet、HttpPost、HttpPut 或 HttpDelete 属性结合使用：

```
[GET("some/url"), HttpGet]
public string Method1() {}

[PUT("some/url"), HttpPut]
public string Method2() {}

[POST("some/url"), HttpPost]
public string Method3() {}

[DELETE("some/url"), HttpDelete]
public string Method4() {} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-04-19T04:16:23.653

仔细检查您是否使用System.Web.Http**中的****[HttpPut]**。

 **在某些情况下，您最终可以使用 System.Web.Mvc 中的属性。

这为我们带来了 405。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-29T16:35:26.483

我遇到了同样的错误，并将其追溯到我定义的自定义路由：

```
config.Routes.MapHttpRoute(
    name: "SomeCall",
    routeTemplate: "api/somecall/{id}",
    defaults: new { controller = "SomeCall", action = "Get" }
); 
```

这里的问题是**`action = "Get"`**阻止了`PUT`相同 URI 的操作来响应。删除默认操作解决了该问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-01-13T22:13:07.747

对我有用的是添加一个路由属性，因为我已经为一个重载的 GET 请求定义了一个，如下所示：

```
 // GET api/Transactions/5
    [Route("api/Transactions/{id:int}")]
    public Transaction Get(int id)
    {
        return _transactionRepository.GetById(id);
    }

    [Route("api/Transactions/{code}")]
    public Transaction Get(string code)
    {
        try
        {
            return _transactionRepository.Search(p => p.Code == code).Single();
        }
        catch (Exception Ex)
        {
            System.IO.File.WriteAllText(@"C:\Users\Public\ErrorLog\Log.txt",
                Ex.Message + Ex.StackTrace + Ex.Source + Ex.InnerException.InnerException.Message);
        }

        return null;
    } 
```

所以我为 PUT 添加了：

```
 // PUT api/Transactions/5
    [Route("api/Transactions/{id:int}")]
    public HttpResponseMessage Put(int id, Transaction transaction)
    {
        try
        {
            if (_transactionRepository.Save(transaction))
            {
                return Request.CreateResponse<Transaction>(HttpStatusCode.Created, transaction);
            }
        }
        catch (Exception Ex)
        {
            System.IO.File.WriteAllText(@"C:\Users\Public\ErrorLog\Log.txt",
                Ex.Message + Ex.StackTrace + Ex.Source + Ex.InnerException.InnerException.Message);
        }

        return Request.CreateResponse<Transaction>(HttpStatusCode.InternalServerError, transaction);
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-07T10:16:23.790

我认为情况不再如此，也许这个问题现在已经解决了。ASP.NET MVC Web API 现在允许 $http.put 并且这里是要测试的代码。

**AngularJS 脚本代码**

```
$scope.UpdateData = function () {
        var data = $.param({
            firstName: $scope.firstName,
            lastName: $scope.lastName,
            age: $scope.age
        });

        $http.put('/api/Default?'+ data)
        .success(function (data, status, headers) {
            $scope.ServerResponse = data;
        })
        .error(function (data, status, header, config) {
            $scope.ServerResponse =  htmlDecode("Data: " + data +
                "\n\n\n\nstatus: " + status +
                "\n\n\n\nheaders: " + header +
                "\n\n\n\nconfig: " + config);
        });
    }; 
```

**html代码**

```
<div ng-app="myApp" ng-controller="HttpPutController">
<h2>AngularJS Put request </h2>
<form ng-submit="UpdateData()">
    <p>First Name: <input type="text" name="firstName" ng-model="firstName" required /></p>
    <p>Last Name: <input type="text" name="lastName" ng-model="lastName" required /></p>
    <p>Age : <input type="number" name="age" ng-model="age" required /></p>
    <input type="submit" value="Submit" />
    <hr />
    {{ ServerResponse }}
</form></div> 
```

**ASP.NET MVC Web API 控制器操作方法**

```
 public class DefaultController : ApiController
{

    public HttpResponseMessage PutDataResponse(string firstName, string lastName, int age)
    {
        string msg =  "Updated: First name: " + firstName +
            " | Last name: " + lastName +
            " | Age: " + age;

        return Request.CreateResponse(HttpStatusCode.OK, msg);
    }
} 
```

（更改发送请求的 url） 当我们单击提交按钮时，它会将 HttpPut 请求发送到声明了 PutDataResponse 操作方法的“/api/default”（DefaultController）。该方法将被调用并且用户得到它的响应。

这个解决方案最初写[在这里](http://techfunda.com/Howto/angularjs/573/http-put-server-request)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-28T09:33:49.630

对我来说，这是因为我没有在我的 http 客户端请求的 json 内容字符串中设置媒体类型：

新的 StringContent(json, Encoding.UTF32, **"application/json"** );

如果未设置，则会出现各种奇怪的行为。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2021-07-13T16:30:58.410

就我而言，我在邮递员中输入了一个参数 id：

```
http://localhost:55038/api/documento/pruebadetallecatalogo?id=100 
```

但是，我将 url 请求更改为：

```
http://localhost:55038/api/documento/pruebadetallecatalogo/100 
```

这对我行得通！！！**

# git - Git post-receive 钩子留下要提交的文件

> ID：14321989
> 
> 赞同：0
> 
> 时间：2013-01-14T16:00:05.653
> 
> 标签：git, githooks

安装 git 的三个地方：Local、Bare 和 Development。

我从本地推送到裸机，接收后挂钩将我的开发分支从裸机推送到开发。提交出现在 git 日志中就好了，但是，如果 Development 当前在它接收的分支上，我会得到一个已暂存并准备提交的文件的修改列表。

问题是暂存文件实际上是旧代码（预提交），为了使我新推送的代码可见，我需要 git stash 一切。我想要完成的是，当代码从 Local 推送到 Bare 时，它​​可以自动在 Development 服务器上查看，并且不需要直接操作 Development。

一个例子——在本地：

更改“dev”分支上的 autoload.php 以使用新的 php 5.4 数组

```
$autoload = []; // instead of $autoload = array(); 
```

推送到我的 Bare repo

```
git push 
```

Post-receive 正确触发并将代码从 Bare 的“dev”分支移动到 Development 的“dev”分支。

现在，如果我在 Development 上执行 git status，我有：

```
modified:  application/config/autoload.php 
```

autoload.php 仍然显示旧代码：

```
$autoload = array(); 
```

只有在我执行 git stash 之后，我的新代码才可见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:04:46.643

你不应该推到一个非裸分支。这就是导致事情以这种方式不同步的原因。当您 git stash 时，它具有将文件同步回 HEAD 的效果，其中现在包括您的更改。

最好连接到开发服务器并让它执行 git pull。

# php - 使用 PHP 和 JSON 处理实时 Twitter 流

> ID：14321991
> 
> 赞同：0
> 
> 时间：2013-01-14T16:00:10.993
> 
> 标签：php, jquery, json, twitter, stream

我正在努力弄清楚如何从实时 Twitter 流中提取推文。我想保持流连接打开，并在推文进入时将推文渲染到地图上。

我认为我的问题出在 tweetmap.php 中，因为我不知道如何处理更新的流。此外，我认为我没有正确检查最后一条推文的位置（通过推文的 ID）。

我一直使用[**THIS TUTORIAL**](http://blog.corunet.com/twitter-alerts-using-twitter-streaming-api/)作为我的指导，但我想绕过将它们存储到数据库中并即时处理它们。

**poll()**（在 tweetmap.js 中）在页面首次加载时被调用。

**推文地图.php：**

```
<?php
    $opts = array(
        'http'=>array(
            'method'    =>  "POST",
            'content'   =>  'track=lol',
        )
    );
    $context = stream_context_create($opts);
    while (1){
        $instream = fopen('https://stream.twitter.com/1/statuses/filter.json','r' ,false, $context);
        while(! feof($instream)) {
            if(! ($line = stream_get_line($instream, 20000, "\n"))) {
                continue;
            } else{
                $tweets = json_decode($line);
                echo $tweets;
                flush();
            }
        }
    }
?> 
```

**推特地图.js：**

```
var last = '';
var timeOut;

function getTweets(id){
    $.getJSON("./php/tweetmap.php?start=" + id,
    function(data){
        $.each(data, function(count,item){
            harvest(item);
            last = item.id;
        });
    });
}

function harvest(tweets) {
    for (var i = 0; i < tweets.results.length; i++) {
        if (tweets.results[i].geo !== null) {
            mapTweet(tweets.results[i]);
        }
    }
}

function mapTweet(tweetData) {
    var tipText;
    var coordinates = projection([tweetData.geo.coordinates[1], tweetData.geo.coordinates[0]]);
    [...]
    // Determines the coordinates of the tweet and adds a circle
    addCircle(coordinates, tipText);
}

function addCircle(coordinates, tipText, r) {
    // Adds and SVG circle to the map
    addTipsy(tipText, tweetNumber);
}

// add tipsy tweet-tip 
function addTipsy(tipText, num) {
    // Adds a hover tip of the tweet on the map
    [...]
}

// Draw the map (is also called to redraw when the browser is resized)
function draw(ht) {
    [...]
    // Draws the SVG map
}

function poll(){
    timeOut = setTimeout('poll()', 200); // Calls itself every 200ms
    getTweets(last);
}

$(function() {
    poll();
    draw($("#mapContainer").width()/2.25);

    $(window).resize(function() {
        if(this.resizeTO) clearTimeout(this.resizeTO);
        this.resizeTO = setTimeout(function() {
            $(this).trigger('resizeEnd');
        }, 500);
    });

    $(window).bind('resizeEnd', function() {
        var height = $("#mapContainer").width()/2.25;
        $("#mapContainer svg").css("height", height);
        draw(height);
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:14:35.443

您试图将 HTTP 请求视为连续流，而这不是它的工作方式。HTTP 是一种无状态协议，它处理请求然后关闭。你有两种选择来做你想做的事情：

1.  使用多个请求，可能间隔一秒。这将创建实时新推文的外观。您可能必须跟踪自上次请求以来的时间，以便仅发送新推文。

2.  使用 Websocket。这将提供一个您所期望的沟通渠道。但是，并非所有浏览器都支持它。

# angularjs - AngularJS $http 和 cookie

> ID：14321992
> 
> 赞同：1
> 
> 时间：2013-01-14T16:00:15.250
> 
> 标签：angularjs, express

我正在尝试使用 ExpressJS 的 cookie 会话和 AngularJS 实现身份验证。问题是即使我可以让 ExpressJS 发送会话 cookie，Angular 也不会在后续请求中发送它们。

我在 192.168.1.2:3000 运行后端服务器，在 192.168.1.2:3501 运行 yeoman 服务器，所以这里有跨域问题吗？为了让 $http 正常工作，我已经用 ExpressJS 做了正常的 CORS 工作，但我不确定如何让 cookie 工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-23T08:19:48.287

您是否检查过您的请求是在`withCredentials`标志设置为的情况下发送的`true`吗？

在 Angular 中，这可以通过在 HTTP 请求配置对象中完成，例如

```
//...
$http.get(myUrl, {withCredentials: true})
//... 
```

或者，如果您不想一直重新配置它，请使用`$httpProvider`：

```
myApp.config(['$httpProvider', function ($httpProvider) {
  $httpProvider.defaults.withCredentials = true;
}]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:07:07.063

要让 angularJS 中的 cookie 工作，您可以[点击此链接](https://stackoverflow.com/questions/10961963/how-to-access-cookies-in-angularjs)

我在后端（expressJS）中维护会话变量并将其返回给前端（angularJS）中的$cookies对象。

所以当我注销时，它会删除 angularJS 中的 cookie 和后端的 session 变量。

# wordpress - Wordpress - 分页不起作用？

> ID：14321993
> 
> 赞同：2
> 
> 时间：2013-01-14T16:00:23.307
> 
> 标签：wordpress, pagination

以下是我 home.php 中的代码，它可以工作但不能分页，我做错了什么，或者有更好的方法来编写代码以使其工作？请帮忙。

```
 $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;

echo "<div id=\"featured_post\">";
    query_posts( array ('post_type'=>'post', 'paged' => $paged, 'category_name' => $featured_cat_name, 'posts_per_page' => 4, 'ignore_sticky_posts'=>1 ) );
    $fcount = 1;
    if (!$paged):
        while ( have_posts() && $fcount < 5 ) : the_post();?>
            <div id="post-<?php the_ID(); ?>" class="view"><?php
                $format = get_post_format();
                if ( false == $format ):
                featured_posts_first();
                else :
                featured_posts_test();
                endif;                      
          echo "</div>";
        $fcount++;
        endwhile;
    else :
        while ( have_posts() ) : the_post();?>
            <div id="post-<?php the_ID(); ?>" class="<?php if (get_post_format() == audio): echo 'audio-isa view'; else : echo 'view'; endif; ?>"><?php

                featured_posts_test();

            echo "</div>";
        endwhile;
    endif;
echo "</div>";
    //get posts navigation
    global $wp_query; $total_pages = $wp_query->max_num_pages; if ( $total_pages > 1 ) {
    thematic_navigation_below();
    }
    wp_reset_query(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:30:02.150

[建议你使用简单分页](http://wordpress.org/extend/plugins/simple-pagination/)之类的分页插件——非常好用。

或者使用[这个](http://wordpress.org/extend/plugins/wp-paginate/)

# html - 溢出：滚动和 100% 高度

> ID：14321994
> 
> 赞同：0
> 
> 时间：2013-01-14T16:00:28.373
> 
> 标签：html, css

我需要里面有滚动的 DIV，它应该是浏览器视图的 100% 高度，还需要底部的另一个 DIV，位置绝对（固定不是一个选项）

这是可以做到的吗？

```
+-ooo----------------------------------+
|              Web Browser             |
+--------------------------------------+
|                                      |
|         BODY overflow:hidden         |
|                                      |
|                                      |
|       DIV WITH SCROLL INSIDE IT      |
|        height:100% (of window)       |
|           overflow: scroll           |
|                                      |
|                                      |
|                                      |  
+--------------------------------------+
|         Fixed DIV height:50px        |
+--------------------------------------+ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:06:33.083

我认为如果您将该 div 放在底部，它可能会出现在主要内容区域的上方。

不过，您可以使用此 CSS 实现 100% 的高度：

```
html, body, #content_div
{
    height: 100%;
} 
```

然后在内容 div 上设置溢出。棘手的部分是让底部的固定 div 不重叠。以跨浏览器方式获得它的唯一方法是使用 Javascript 在开始时检测可用窗口的高度，从中减去 50px，然后在内容 div 上设置该高度。您可能还需要在其中添加一个 onresize 事件处理程序来处理用户调整浏览器窗口大小的情况。