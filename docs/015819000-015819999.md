# StackOverflow 问答 15819000-15819999

# rest - 在 RESTful 架构中，客户端应该如何请求使用资源的格式？

> ID：15819003
> 
> 赞同：3
> 
> 时间：2013-04-04T18:34:50.517
> 
> 标签：rest

假设我有一个包含人员列表的网站。当通过浏览器访问“人”资源时，服务器会以 HTML 格式返回该资源的数据。但是，如果我还想通过计算机使该资源可消耗，那么允许客户端以 JSON 格式而不是 HTML 格式请求数据的首选方法是什么？

我现在可以想到三种方法可以实现这一点。

1.) 我见过许多网站通过子路径（例如，`/api/people/john-doe`）打开他们的 API，但这似乎是反休息的，因为它为同一资源创建了多个端点。

2.) 另一种方法是传入查询字符串参数（例如，`/people/john-doe?format=json`），但这是正确的地方吗？

3.) 可以在请求中使用自定义 HTTP 标头，例如：`X-Response-Format: json`. 这对我来说似乎是最干净的方式，但同样，不确定它是否适合它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T18:37:20.417

经过多一点谷歌搜索后，我很快发现正确的方法是`Accept`标题。

# java - 将 JButton 添加到 JTextPane

> ID：15819006
> 
> 赞同：4
> 
> 时间：2013-04-04T18:35:14.747
> 
> 标签：java, swing, jbutton, jtextpane

我在尝试使用字符串将 JButton 添加到 JTextPane 时遇到问题。所以我想做的是在for循环中添加每个字符串，然后在添加的字符串之后添加广告JButton。下面的代码是我想要完成的。

```
ArrayLst<String> data = new ArrayList();
data.add("Data here");
data.add("Data here 2");
data.add("Data here 3");
data.add("Data here 4");

Container cp = getContentPane();

JTextPane pane = new JTextPane();
SimpleAttributeSet set = new SimpleAttributeSet();
StyleConstants.setBold(set, true);
pane.setBackground(Color.BLUE);
pane.setEditable(false);

Document doc = pane.getStyledDocument();

for(int i=0; i<data.size(); i++)
{
    doc.insertString(doc.getLength(), data.get(i)+ "\n", set);
    pane.insertComponent(new JButton("View Info"));
} 
```

谁能告诉我如何将 JButton 添加到同一行的每个字符串？

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T19:04:45.593

你可以这样尝试：
![在此处输入图像描述](https://i.stack.imgur.com/2T8Rk.jpg)

```
import javax.swing.*;
import javax.swing.text.*;
import java.awt.event.*;
import java.awt.*;
import java.util.*;

class TextPaneDemo extends JFrame
{
    public void createAndShowGUI()throws Exception
    {
        JTextPane tp = new JTextPane();
        ArrayList<String> data = new ArrayList();
        data.add("Data here");
        data.add("Data here 2");
        data.add("Data here 3");
        data.add("Data here 4");
        getContentPane().add(tp);
        setSize(300,400);
        StyledDocument doc = tp.getStyledDocument();
        SimpleAttributeSet attr = new SimpleAttributeSet();
        for (String dat : data )
        {
            doc.insertString(doc.getLength(), dat, attr );
            tp.setCaretPosition(tp.getDocument().getLength());
            tp.insertComponent(new JButton("Click"));
            doc.insertString(doc.getLength(), "\n", attr );
        }

        setLocationRelativeTo(null);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setVisible(true);
    }
    public static void main(String[] args) 
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            @Override
            public void run()
            {
                TextPaneDemo tpd = new TextPaneDemo();
                try
                {
                    tpd.createAndShowGUI(); 
                }
                catch (Exception ex){}
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T19:08:02.130

> 谁能告诉我如何将 JButton 添加到同一行的每个字符串？

*   从`LineSeparator ("\n")`_`doc.insertString(doc.getLength(), data.get(i)+ "\n", set);`

伪代码可能是

```
for (int i = 0; i < data.size(); i++) {
    try {
        doc.insertString(doc.getLength(), data.get(i), set);
        textPane.insertComponent(new JButton("View Info"));
        doc.insertString(doc.getLength(), "\n", set);
    } catch (BadLocationException ex) {
    }    
} 
```

*   带输出

![nnn](https://i.stack.imgur.com/zF2JG.jpg)

# iphone - 在一个函数中跟踪多个 REST 调用完成的良好实践

> ID：15819007
> 
> 赞同：0
> 
> 时间：2013-04-04T18:35:17.543
> 
> 标签：iphone, ios, objective-c, ipad, objective-c-blocks

我正在使用 MKNetworkKit 库对服务器进行 REST 调用。当用户想要收藏或不收藏某张照片时，就会调用这个特定的片段集。如果我们只为单张照片设置最喜欢的标志，那么它是非常直接的 Objective-c 块代码。但是，我在 GUI 中实现了多选机制，以便用户可以选择多张照片并同时将它们全部收藏。

我为此编写的函数工作得很好，但对我来说感觉不是很干净。

我不喜欢的：

*   使用块计数器跟踪所有回调。我想知道是否有更优雅的方式来处理这个问题。

*   两个完成块中存在相同的代码。然而，这正是 MKNetworkKit 的使用方式（一个代表成功，一个代表错误）。我想如果我把它作为一个实例方法，我可以通过调用另一个 i-method 来处理它，但这似乎和所有设置一样混乱。我想把它作为一个方便的类方法实用程序。

建议？

```
+(BOOL)updateAssets:(NSArray*)assets
         isFavorite:(BOOL)isFavorite
         completion:(MyAssetCompletion)completion // (BOOL success)
{

    assert(assets);
    if (assets == nil || assets.count == 0) return NO;

    __block BOOL bError = NO;
    __block NSInteger counter = 0;  // Use a counter to track number of completed REST calls
    for(MyAsset *asset in assets){
        MyUpdateAssetForm *form = [[MyUpdateAssetForm alloc] init];
        form.isPrivate = isFavorite ? @(1) : @(0);
        [[MyRESTEngine sharedInstance] updateAssetWithUUID:asset.UUID
                                                     withForm:form
                                              completionBlock:^{
                                                  counter++;
                                                  if(counter == assets.count){
                                                      completion(bError == NO);
                                                  }
                                              } errorBlock:^(NSError *error, NSString *additionalInfo) {
                                                  bError = bError || YES;
                                                  counter++;
                                                  if(counter == assets.count){
                                                      completion(bError == NO);
                                                  }
                                              }];
    }
    return YES;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:23:41.740

你可以试试这个（未经测试）：（
顺便说一下，你当前的实现不是线程安全的，因为计数器可能以非原子方式从一个以上的线程递增）
@see [NSConditionLock](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSConditionLock_Class/Reference/Reference.html)

```
- (BOOL) updateAssets:(NSArray*)assets
           isFavorite:(BOOL)isFavorite
           completion:(bool_block_t)completion
{
    assert(assets && [assets count]);

    __block NSMutableArray* failed = [NSMutableArray new];
    __block NSConditionLock* lock = [[NSConditionLock alloc] initWithCondition:[assets count]];
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0),
                   ^{
                       [lock lockWhenCondition:0];
                       completion([failed count] == 0);
                   });
    NSNumber* val = (isFavorite ? @1 : @0);
    for (MyAsset* asset in assets) {
        MyUpdateAssetForm* form = [[MyUpdateAssetForm alloc] init];
        form.isPrivate = val;
        [self updateAssetWithUUID:asset.UUID
                         withForm:form
                  completionBlock:^{[lock unlockWithCondition:[lock condition] - 1];}
                       errorBlock:^(NSError *error, NSString *additionalInfo)
         {
             [lock lock];
             [failed addObject:asset];
             [lock unlockWithCondition:[lock condition] - 1];
         }];
    }
    return YES;
} 
```

# java - 使用 JgraphT/Jgraph 定义的 UndirectedGraph

> ID：15819016
> 
> 赞同：1
> 
> 时间：2013-04-04T18:35:46.747
> 
> 标签：java, jgrapht

我找不到无向图的构造函数，它是一个接口......我一直在浏览文档......但不知道如何启动`UndirectedGraph Interface`.

我尝试过使用 SimpleGraph，但它不起作用。将 simpleGraph 转换为 undirectedGraph 不起作用......

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:45:30.837

UndirectedGraph 是一个接口（正如您所指出的）。接口没有构造函数，但实现该接口的类有。如果您查看[UndirectedGraph JavaDoc](http://jgrapht.org/javadoc/org/jgrapht/UndirectedGraph.html)，您会发现所有实现类（至少是 JGraphT 包中的所有类）。有几种。

*   无向图
*   块切点图
*   可听无向图
*   ListenableUndirectedWeightedGraph
*   多图
*   伪图
*   简单图
*   简单加权图
*   无向图联合
*   无向掩码子图
*   无向子图
*   无向加权子图
*   不可修改无向图
*   加权多图
*   加权伪图

您应该找到最适合您情况的那个。请记住，其中一些可能是抽象类（我没有全部检查过），而另一些可能没有公共构造函数。但是，这些都不适用于您说您已经尝试过的[SimpleGraph 。](http://jgrapht.org/javadoc/org/jgrapht/graph/SimpleGraph.html)

将 SimpleGraph 转换为 UndirectedGraph 当然应该可以工作（假设它们具有相同的泛型类型）。如果您仍然遇到问题，我建议您发布 (a) 演示您的问题的最小示例代码和 (b) 您收到的特定错误消息/遇到的问题。

# visual-studio-2010 - 我必须打开什么 VS 扩展/设置才能获得此功能？

> ID：15819017
> 
> 赞同：0
> 
> 时间：2013-04-04T18:35:53.807
> 
> 标签：visual-studio-2010, visual-studio, visual-studio-extensions

什么 Visual Studio 2010 扩展或设置启用了下图所示的功能？它允许我跳转到匹配的大括号，对于条件语句，它可以让我看到右大括号的条件。

![允许跳转到匹配大括号的 VS 扩展](https://i.stack.imgur.com/ZfsYN.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:57:30.587

[Visual Studio 2010 的 VSCommands](http://visualstudiogallery.msdn.microsoft.com/d491911d-97f3-4cf6-87b0-6a2882120acf)具有称为[代码块结束标记器的功能](http://vscommands.squaredinfinity.com/Features2010)

# mysql - MySql：Concat IF'ed 值

> ID：15819018
> 
> 赞同：5
> 
> 时间：2013-04-04T18:35:54.543
> 
> 标签：mysql

试图找到一种方法将 CONCAT 与 IF 结合起来——或以其他方式在逗号分隔列表中显示设置标志的文本值。

*注意：这最终适用于具有 10 列以上的表。在这里使用两个来简化。*

假设我有一张带旗帜的桌子。如果标志是`1`我想显示一些文本值，否则什么都没有。

```
origin:
+--+-----+-----+
|# | CHS | ACC |
+--+-----+-----+
|1 | 0   | 1   |
|2 | 1   | 1   |
|3 | 1   | 0   |
|4 | 0   | 0   |
+--+-----+-----+ 
```

我想：

```
+--+----------+
|# |  origin  |
+--+----------+
|1 | ACC      |
|2 | CHS, ACC |
|3 | CHS      |
|4 |          |
+--+----------+ 
```

不是（这个或类似的）：

```
+--+-----------+
|# | origin    |
+--+-----------+
|1 | ACC,      |
|2 | CHS, ACC, |
|3 | CHS,      |
|4 | ,         |
+--+-----------+ 
```

朝着这个方向的东西：

```
SELECT
    CONCAT_WS(', ',
        IF(CHS = 0, '', 'CHS'),
        IF(ACC = 0, '', 'ACC')
    ) as origin
FROM
    origin; 
```

但空值之间没有逗号。

这最终适用于一个包含 10 列的表，我根据 id 与其他表连接。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T18:59:44.490

您可以将 CONCAT_WS 与 CASE 结合使用，它会跳过 NULL 值：

```
SELECT
  id,
  CONCAT_WS(', ',
    CASE WHEN CHS THEN 'CHS' END,
    CASE WHEN ACC THEN 'ACC' END
  ) as origin
FROM
  origin; 
```

当条件为 FALSE 时，由于我没有指定 ELSE 子句，因此 CASE 将返回 NULL 值，而 CONCAT_WS 将跳过它。您也可以在原始查询中使用 NULL 而不是 ''。

如果您有很多列，您还可以使用以下内容创建动态查询：

```
SELECT
  CONCAT(
    'SELECT ID, CONCAT_WS(\', \',',
    GROUP_CONCAT(
      CONCAT(
        'CASE WHEN ',
        `COLUMN_NAME`,
        ' THEN \'',
        `COLUMN_NAME`,
        '\' END') SEPARATOR ','),
    ') AS origin FROM origin;'
    )
FROM
  `INFORMATION_SCHEMA`.`COLUMNS` 
WHERE
  `TABLE_NAME`='origin'
  AND COLUMN_NAME!='id'
INTO @sql;

PREPARE stmt FROM @sql;
EXECUTE stmt; 
```

请[在此处](http://sqlfiddle.com/#!2/b53b8/1)查看带有两种解决方案的小提琴。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T18:39:01.893

可能有一个更好看的解决方案，但你可以使用

```
CONCAT(
    IF(CHS = 0, '', 'CHS'),
    IF(CHS != 0 AND ACC != 0, ', ', ''),
    IF(ACC = 0, '', 'ACC')
) 
```

您还可以使用`REPLACE`删除“空白：”

```
REPLACE(CONCAT_WS(', ',
    IF(CHS = 0, 'REMOVEIT', 'CHS'),
    IF(ACC = 0, 'REMOVEIT', 'ACC')
), 'REMOVEIT, ', '') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T19:10:57.887

试试这个。

```
SELECT
    TRIM(TRAILING ', ' FROM CONCAT_WS(', ',
        IF(CHS = 0, '', 'CHS'),
        IF(ACC = 0, '', 'ACC')
    )) as origin
FROM
    origin; 
```

这是mysql文档。

[http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_trim](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_trim)

# c++ - 用部分模板特化覆盖抽象成员函数

> ID：15819019
> 
> 赞同：1
> 
> 时间：2013-04-04T18:35:58.060
> 
> 标签：c++, templates, inheritance, abstract-class

我正在尝试在 C++ 中实现特定的模板设计，并遇到了一个我想要解决的问题。这是设置，并解释了要遵循的问题。

我声明了一个模板化的抽象基类，如下所示：

```
template <class TModel, class TVertex>
class AttributeEvaluator2f
{
public:
    virtual void evaluate( TModel& model, TVertex& v, float x, float y ) = 0;
}; 
```

然后我想实现专门化模板参数之一的子类，如下所示：

```
template <class TVertex>
class SurfacePositionFromSphere : public AttributeEvaluator2f<Sphere3f,TVertex>
{
public:
    virtual void evaluate( Sphere3f& sphere, TVertex& v, float theta, float phi )
    {
        sphere.SamplePosition( v.position, theta, phi );
    };
}; 
```

然后，我将基于这些类实例化一个对象，如下所示：

```
SurfacePositionFromSphere<BasicVertexDX11::Vertex> attribute(); 
```

编译错误表明我从未实现原始基类的抽象方法。这可能是因为在子类中，我直接使用第一个参数声明该方法已经专门化（`Sphere3f`在这种情况下）。

所以问题是，是否有可能以这种方式覆盖抽象基类方法参数的类型？如果没有，是否有类似的机制可用于提供类似的功能？

在此先感谢您的帮助！

编辑：由于模板展开，确切的错误消息是巨大的，但这里是它的主要部分供您参考：错误 C2259: 'Glyph3::AttributeEvaluator2f' : cannot instantiate abstract >class 1> with 1> [ 1> TModel =Glyph3::Sphere3f, 1> TVertex=Glyph3::BasicVertexDX11::Vertex 1> ] 1> 由于以下成员： 1> 'void Glyph3::AttributeEvaluator2f::evaluate(TModel &,TVertex &,float,float)' : 是抽象的 1> with 1> [ 1> TModel=Glyph3::Sphere3f, 1> TVertex=Glyph3::BasicVertexDX11::Vertex 1> ] 1> c:\users\zij1fh\documents\visual studio 2012\projects\hg3\trunk\hieroglyph3\source\rendering\attributeevaluator2f.h(26) ：参见 'Glyph3::AttributeEvaluator2f::evaluate' 1> 的声明 1> [ 1> TModel=Glyph3::Sphere3f, 1> TVertex=Glyph3::BasicVertexDX11::Vertex 1> ] 1> c:\program files (x86)\microsoft visual studio 11.0\vc\include\xmemory0(751) ：参见函数参考模板实例化 'void std::allocator<_Ty>::construct<_Objty,_Ty>(_Objty *,_V0_t &&)' 正在编译 1> 1> [ 1> _Ty=Glyph3::AttributeEvaluator2f, 1> _Objty=Glyph3: :AttributeEvaluator2f, 1> _V0_t=字形3::AttributeEvaluator2f 1>] 1> c:\program files (x86)\microsoft visual studio 11.0\vc\include\xmemory0(751) : 请参阅函数模板实例化 'void std::allocator<_Ty>::construct<_Objty,_Ty>( _Objty *,_V0_t &&)' 正在编译 1> 1> [ 1> _Ty=Glyph3::AttributeEvaluator2f, 1> _Objty=Glyph3::AttributeEvaluator2f, 1> _V0_t=Glyph3::AttributeEvaluator2f 1> ] 1> c:\program文件 (x86)\microsoft visual studio 11.0\vc\include\xmemory0(903) ：参见对函数模板实例化的参考 'void std::allocator_traits<_Alloc>::construct<_Ty,_Ty>(std::allocator<_Ty> &,_Objty *,_V0_t &&)' 正在编译\program files (x86)\microsoft visual studio 11.0\vc\include\xmemory0(751) ：参见对函数模板实例化的引用 'void std::allocator<_Ty>::construct<_Objty,_Ty>(_Objty *,_V0_t && )' 正在编译 1> 1> [ 1> _Ty=Glyph3::AttributeEvaluator2f, 1> _Objty=Glyph3::AttributeEvaluator2f, 1> _V0_t=Glyph3::AttributeEvaluator2f 1> ] 1> c:\program files (x86)\ microsoft visual studio 11.0\vc\include\xmemory0(903)：参见对函数模板实例化的引用 'void std::allocator_traits<_Alloc>::construct<_Ty,_Ty>(std::allocator<_Ty> &,_Objty *, _V0_t &&)' 正在编译\program files (x86)\microsoft visual studio 11.0\vc\include\xmemory0(751) ：参见对函数模板实例化的引用 'void std::allocator<_Ty>::construct<_Objty,_Ty>(_Objty *,_V0_t && )' 正在编译 1> 1> [ 1> _Ty=Glyph3::AttributeEvaluator2f, 1> _Objty=Glyph3::AttributeEvaluator2f, 1> _V0_t=Glyph3::AttributeEvaluator2f 1> ] 1> c:\program files (x86)\ microsoft visual studio 11.0\vc\include\xmemory0(903)：参见对函数模板实例化的引用 'void std::allocator_traits<_Alloc>::construct<_Ty,_Ty>(std::allocator<_Ty> &,_Objty *, _V0_t &&)' 正在编译请参阅对函数模板实例化 'void std::allocator<_Ty>::construct<_Objty,_Ty>(_Objty *,_V0_t &&)' 的引用 1> 编译 1> [ 1> _Ty=Glyph3::AttributeEvaluator2f, 1> _Objty=Glyph3::AttributeEvaluator2f, 1> _V0_t=Glyph3::AttributeEvaluator2f 1> ] 1> c:\program files (x86)\microsoft visual studio 11.0\vc\include\xmemory0(903) ：参见对函数模板实例化的参考void std::allocator_traits<_Alloc>::construct<_Ty,_Ty>(std::allocator<_Ty> &,_Objty *,_V0_t &&)' 正在编译请参阅对函数模板实例化 'void std::allocator<_Ty>::construct<_Objty,_Ty>(_Objty *,_V0_t &&)' 的引用 1> 编译 1> [ 1> _Ty=Glyph3::AttributeEvaluator2f, 1> _Objty=Glyph3::AttributeEvaluator2f, 1> _V0_t=Glyph3::AttributeEvaluator2f 1> ] 1> c:\program files (x86)\microsoft visual studio 11.0\vc\include\xmemory0(903) ：参见对函数模板实例化的参考void std::allocator_traits<_Alloc>::construct<_Ty,_Ty>(std::allocator<_Ty> &,_Objty *,_V0_t &&)' 正在编译1> [ 1> _Ty=Glyph3::AttributeEvaluator2f, 1> _Objty=Glyph3::AttributeEvaluator2f, 1> _V0_t=Glyph3::AttributeEvaluator2f 1> ] 1> c:\program files (x86)\microsoft visual studio 11.0\vc \include\xmemory0(903) : 请参阅正在编译的函数模板实例化 'void std::allocator_traits<_Alloc>::construct<_Ty,_Ty>(std::allocator<_Ty> &,_Objty *,_V0_t &&)' 的引用1> [ 1> _Ty=Glyph3::AttributeEvaluator2f, 1> _Objty=Glyph3::AttributeEvaluator2f, 1> _V0_t=Glyph3::AttributeEvaluator2f 1> ] 1> c:\program files (x86)\microsoft visual studio 11.0\vc \include\xmemory0(903) : 请参阅正在编译的函数模板实例化 'void std::allocator_traits<_Alloc>::construct<_Ty,_Ty>(std::allocator<_Ty> &,_Objty *,_V0_t &&)' 的引用请参阅正在编译的函数模板实例化 'void std::allocator_traits<_Alloc>::construct<_Ty,_Ty>(std::allocator<_Ty> &,_Objty *,_V0_t &&)' 的引用请参阅正在编译的函数模板实例化 'void std::allocator_traits<_Alloc>::construct<_Ty,_Ty>(std::allocator<_Ty> &,_Objty *,_V0_t &&)' 的引用

EDIT2：上面指出的用法不正确（正如安迪指出的那样）。这是我的确切用法：

```
VertexEvaluator2f< Sphere3f, BasicVertexDX11::Vertex > evaluator;
evaluator.Evaluators.push_back( SurfacePositionFromSphere<BasicVertexDX11::Vertex>() ); 
```

在 VertexEvaluator2f 类中，我遍历属性以生成一个顶点。为了完整起见，这也是该类的声明：

```
template <class TModel, class TVertex>
class VertexEvaluator2f
{
public:
    void SetModel( TModel& model ) {
        m_Model = model;
    };

    void evaluate( TVertex& v, float x, float y ) {
        for ( auto& evaluator : Evaluators ) {
            evaluator.evaluate( m_Model, v, x, y );
        }
    };

    std::vector< AttributeEvaluator2f< TModel, TVertex > > Evaluators;

protected:
    TModel m_Model;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T18:58:42.793

> 所以问题是，是否有可能以这种方式覆盖抽象基类方法参数的类型？

是的，有可能。你的类的定义看起来是正确的，你可以[在这里](http://liveworkspace.org/code/3SRz1U%2468)看到它们被正确编译（我使用了一些虚拟`Vertex`和`Sphere3f`类）。

问题最有可能（或至少也是）在于这一行：

```
SurfacePositionFromSphere<BasicVertexDX11::Vertex> attribute(); 
```

实际上是在声明一个名为的*函数*`attribute`，它不接受任何参数并返回一个类型的对象`SurfacePositionFromSphere<BasicVertexDX11::Vertex>`。

当您稍后尝试访问该对象的成员函数时，编译器会抱怨（毕竟，您正在尝试访问函数指针的某些成员函数，这对编译器来说是无意义的）。

为了创建一个对象而不是声明一个函数，删除对象名称后面的一对括号：

```
SurfacePositionFromSphere<BasicVertexDX11::Vertex> attribute;
//                                                          ^
//                                             No parentheses 
```

**更新：**

您正在以这种方式声明属性向量：

```
std::vector< AttributeEvaluator2f< TModel, TVertex > > Evaluators; 
```

`std::vector<>`与所有标准容器一样，具有*值语义*。这意味着它将包含类型的对象（而不是指向对象的指针！）`AttributeEvaluator2f< TModel, TVertex >`，并且该类确实是抽象的。

在这种情况下，您想要的是使用（智能）指针，例如：

```
#include <memory>

template <class TModel, class TVertex>
class VertexEvaluator2f
{
    // ...

    void evaluate( TVertex& v, float x, float y ) {
        for ( auto& evaluator : Evaluators ) {
            evaluator->evaluate( m_Model, v, x, y );
        //           ^^
        }
    };

    std::vector<
        std::shared_ptr<AttributeEvaluator2f<TModel, TVertex>>
    //  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        > Evaluators;

protected:
    TModel m_Model;
}; 
```

这就是您将元素添加到集合中的方式：

```
VertexEvaluator2f< Sphere3f, BasicVertexDX11::Vertex > evaluator;
evaluator.Evaluators.push_back( 
    std::make_shared<SurfacePositionFromSphere<BasicVertexDX11::Vertex>>()
    ); 
```

# bash - 使用 bash 别名删除令牌？

> ID：15819028
> 
> 赞同：1
> 
> 时间：2013-04-04T18:36:16.210
> 
> 标签：bash, alias

例如（`<magic>`作为删除键所在的位置）：

```
$ alias test="testrunner test/test_<magic>"
$ test module.py
.....
----------------------------------------------------------------------
Ran 5 tests in 0.001s

OK 
```

这些年来，我遇到过一些这样的情况会很方便。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T18:41:50.193

不是我的头顶 - 但如果我正确理解你的意图，bash函数可能比别名更好：

```
 $ mytest(){ testrunner test/test_${1} ; }
  $ mytest module.py 
```

# java - 登录网站 (Java)

> ID：15819030
> 
> 赞同：1
> 
> 时间：2013-04-04T18:36:18.800
> 
> 标签：java, login

我想登录一个网站，但如果我尝试使用以下代码：包 URL；

```
//Variables to hold the URL object and its connection to that URL.
import java.net.*;
import java.io.*;

public class URLLogin {
    private static URL URLObj;
private static URLConnection connect;

public static void main(String[] args) {
    try {
        // Establish a URL and open a connection to it. Set it to output mode.
        URLObj = new URL("http://login.szn.cz");
        connect = URLObj.openConnection();
        connect.setDoOutput(true);        
    }
    catch (MalformedURLException ex) {
        System.out.println("The URL specified was unable to be parsed or uses an invalid protocol. Please try again.");
        System.exit(1); 
    }
    catch (Exception ex) {
        System.out.println("An exception occurred. " + ex.getMessage());
        System.exit(1);
    }

    try {
        // Create a buffered writer to the URLConnection's output stream and write our forms parameters.
        BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(connect.getOutputStream(),"UTF-8"));
        writer.write("username=S&password=s&login=Přihlásit se");
        writer.close();

     // Now establish a buffered reader to read the URLConnection's input stream.
        BufferedReader reader = new BufferedReader(new InputStreamReader(connect.getInputStream()));

        String lineRead = "";

        Read all available lines of data from the URL and print them to screen.
        while ((lineRead = reader.readLine()) != null) {
            System.out.println(lineRead);
        }

        reader.close();  
    }
    catch (Exception ex) {
        System.out.println("There was an error reading or writing to the URL: " + ex.getMessage());
    }
}
} 
```

我收到此错误：

> 读取或写入 URL 时出错：服务器返回 HTTP 响应代码：405 对于 URL： http: [//login.szn.cz](http://login.szn.cz)

这是我可以登录该网站的一种方式吗？或者我可以在 Opera 浏览器中使用带有登录信息的 cookie？

感谢所有建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:08:08.743

您可以调用`URL`对象的`openConnection`方法来获取`URLConnection`对象。您可以使用此`URLConnection`对象设置连接之前可能需要的参数和一般请求属性。`URL`仅在调用该方法时才启动到由 表示的远程对象的连接`URLConnection.connect`。以下代码打开与站点*example.com*的连接：

```
try {
    URL myURL = new URL("http://login.szn.cz");
    URLConnection myURLConnection = myURL.openConnection();
    myURLConnection.connect();
} 
catch (MalformedURLException e) { 
    // new URL() failed
    // ...
} 
catch (IOException e) {   
    // openConnection() failed
    // ...
} 
```

`URLConnection`每次调用`openConnection`this 的协议处理程序的方法都会创建一个新对象`URL`。

另请参阅这些链接..

*   [http://www.coderanch.com/t/524061/open-source/Java-program-Login-website-url](http://www.coderanch.com/t/524061/open-source/Java-program-Login-website-url)
*   [用java登录网站](https://stackoverflow.com/questions/7622011/login-on-website-with-java)

# c++ - 使用 clang++/libc++ 删除 Boost libstdc++ 依赖项？

> ID：15819031
> 
> 赞同：7
> 
> 时间：2013-04-04T18:36:20.483
> 
> 标签：c++, boost, clang, libstdc++, libc++

这个问题的答案[How to compile/link Boost with clang++/libc++?](https://stackoverflow.com/questions/8486077/how-to-compile-link-boost-with-clang-libc) `Boost`使用`clang++`and构建的状态`libc++`，应该执行以下操作：

```
./b2 clean
./b2 toolset=clang cxxflags="-stdlib=libc++" linkflags="-stdlib=libc++" 
```

我在 Scientific Linux 6.4 x86_64 主机上测试了上述技巧，它“主要”可以构建完整的 Boost 1_53_0 发行版，使用`clang++ 3.3sv`和`libc++ 3.3svn`. 我说的主要是因为我真的很想消除所有`libstdc++`依赖。

尽管如此，以下内容：

*   `libboost_graph`
*   `libboost_locale`
*   `libboost_regex`

仍然显示`libstdc++`依赖关系（`ldd`输出非常明显）。我想知道删除此类的好方法，并希望有任何提示。

* * *

## 回答 #1

> 赞同：-4
> 
> 时间：2013-04-09T02:09:36.640

我发现了如何做到这一点。感谢@Howard Hinnant 提到`libc++abi`. 在 RTFM [http://libcxx.llvm.org/](http://libcxx.llvm.org/)之后，构建没有任何`libstdc++`依赖关系的整个 boost 库是微不足道的。是的，我所要做的就是 RTFM！

# iphone - iOS UIScrollView取消UIButton触摸滚动

> ID：15819036
> 
> 赞同：6
> 
> 时间：2013-04-04T18:36:40.000
> 
> 标签：iphone, ios, objective-c, uiscrollview, uibutton

我在 UIScrollView 中有一些 UIButton，但我不想延迟按钮的触摸。但是，一旦滚动视图检测到拖动/滚动，我想取消 UIButton 触摸并继续滚动 UIScrollView。

我已经包括以下...

```
_scrollView.delaysContentTouches = NO; 
```

...但是（显然）按钮触摸在拖动时不会取消。有人对我如何实现此功能有任何建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-08-28T04:21:33.780

您可以覆盖此方法`UIScrollView`。

```
-(BOOL)touchesShouldCancelInContentView:(UIView *)view
{   
    return YES;
} 
```

在您的 UIButton 中，您应该为不同的控件事件添加不同的方法。

1.  显示高亮效果`UIControlEventTouchDown`。
2.  触发按钮`UIControlEventTouchUpInside | UIControlEventTouchUpOutside`；
3.  清晰的高光效果为`UIControlEventTouchCancel`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:01:52.997

您可以使用 scrollViewWillBeginDragging 来触发通知并通过在按钮代码中监听它来处理按钮取消。我认为这是您正在尝试做的，但我不确定我是否正确理解了您的问题。

# mysql - MYSQL Union All 带别名

> ID：15819037
> 
> 赞同：4
> 
> 时间：2013-04-04T18:36:41.343
> 
> 标签：mysql, union, alias

我正在尝试查找应用程序表中存在的所有应用程序，这些应用程序尚未在审查表中进行审查。

```
SELECT * 
    FROM (
        SELECT app_id FROM apps
        UNION ALL 
        SELECT app_id FROM reviews
          )  
    GROUP BY app_id 
    HAVING COUNT(*) = 1 
```

在找到哪些应用程序没有审核后，我想从应用表中获取所有值，以便列出仍需要审核的应用程序。app_id 对应于apps 表中应用信息的key，当一个应用被review 时，app_id 连同评论和在他们尊重的字段中的排名一起被输入到app_id 下的reviews 表中。

我收到此错误，似乎无法弄清楚如何正确添加别名。

> 每个派生表都必须有自己的别名

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T18:37:57.723

错误很明显，为该表添加一个别名：

```
SELECT * 
FROM 
(
  SELECT app_id FROM apps
  UNION ALL 
  SELECT app_id FROM reviews
)   AS t -- < -------------- this
GROUP BY app_id 
HAVING COUNT(*) = 1; 
```

**注意：**不推荐使用`GROUP BY`with `SELECT *`，也不符合ANSI SQL。它可以在 mysql 中正常工作，但尽量不要将不在聚合函数中的列放在`SELECT`子句中。`GROUP BY`在您的情况下，MySQL 将为这些列获取任意值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T18:56:28.353

您的问题通常使用`left outer join`or来回答`not in`：

```
select a.*
from apps a left outer join
     reviews r
     on a.app_id = r.app_id
where r.app_id is null 
```

# java - 从 Java 中可能具有多种类型的超类继承

> ID：15819044
> 
> 赞同：-1
> 
> 时间：2013-04-04T18:37:12.720
> 
> 标签：java, inheritance, multiple-inheritance

我正在使用 libGDX 库编写游戏，我有两个边界框，用于碰撞检测，一个用于可旋转对象，一个用于不可旋转对象。可旋转的继承自不可旋转的。

我想制作一个游戏实体类，它具有渲染调试形状和动画等通用功能，并存储与游戏中所有实体相关的其他游戏信息。我只想从这个类上写，然后扩展它以产生所有的游戏元素，但我想不出一种方法，因为其中一些可以旋转，而另一些则不能。现在我曾想过简单地将边界框作为一个全局对象，但我想不出一种方法来构造一个全局变量，该变量可以是两种类型，具体取决于我如何实例化对象。

任何人都可以帮忙吗？还是我正在做的只是错误的做事方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:29:48.197

您可以使用组合而不是继承。因此，例如：

```
class Box {}
class RotatableBox extends Box {}
class GameElement {
  Box box; // could be RotatableBox
} 
```

然后，您可以从框中委派所需的任何方法，以便可以直接从游戏元素访问它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:20:06.680

出色地...

既然你指责我在你的评论中提供了虚假信息（并声称你理解多态性），这里有一个简单的例子来证明你肯定可以调用子类的方法，即使对象被声明为父类班级。

```
class ParentClass
{
    public void sayHey()
    {
        System.out.println("I am a parent");
    }
}

class ChildClass extends ParentClass
{
    public void sayHey()
    {
        System.out.println("I am a child");
    }
}

public void testIt()
{
    ParentClass p = new ChildClass();
    p.sayHey();  // prints "I am a child"
} 
```

同样的概念也适用于实现接口的类。

在您的游戏中，您可以使用接口或超类来表示可旋转或不可旋转的游戏实体。

您可以根据需要使用 GameEntityFactory 生成任一类型的对象。

# css - Bootstrap 的弹出框跳出屏幕

> ID：15819049
> 
> 赞同：2
> 
> 时间：2013-04-04T18:37:21.187
> 
> 标签：css, twitter-bootstrap, screen, popover

我在 Bootstrap 中遇到弹出窗口问题。我在导航栏中的下拉菜单中有一个表单，并且弹出框位于屏幕顶部。此外，popover真的很薄。这是这种情况：

![截屏](https://i.stack.imgur.com/vPOnY.png)

我想得到这样的东西：

![截屏](https://i.stack.imgur.com/vnXZi.png)

问题是，如果我更改该弹出框的值以使其正常工作，其他弹出框会出错，并且如果我更改里面的文本，它将不适合。我能做什么？顺便说一句，这是代码：

```
<li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
        <?php echo lang('register'); ?><b class="caret"></b>
    </a>
    <ul id="register" class="dropdown-menu form">
        <?php echo form_open('#'); ?>
            <input type="text" name="user" placeholder="<?php echo lang('login.username'); ?>">
            <input type="email" name="email" placeholder="<?php echo lang('reg.email'); ?>">
            <input type="password" name="pass" placeholder="<?php echo lang('login.password'); ?>">
            <input type="password" name="pass_conf" placeholder="<?php echo lang('reg.pass_conf'); ?>">
            <input class="btn btn-info" type="button" value="<?php echo lang('reg.submit'); ?>">
        </form>
    </ul>
</li> 
```

它有一些 PHP 代码，但我认为它显示的结构很好。该部分的 CoffeeScript 是这样的：

```
username    = $('#register input[name="user"]')
if ( ! /^([\w_-]{4,15})$/.test(username.val()))
    username.addClass('error')
    username.popover({
        'placement': 'right'
        'trigger': 'manual'
        'title': user_not_valid_title
        'content': user_not_valid
    })
    username.popover('show')
    pass = false 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T14:49:08.423

我终于找到了一个解决方案，而无需修改`container`弹出框的 ，将其设置为`body`，然后将其设置为高于`z-index`导航栏。

# python - Pandas DataFrame concat vs append

> ID：15819050
> 
> 赞同：90
> 
> 时间：2013-04-04T18:37:25.263
> 
> 标签：python, pandas

我有一个包含 4 个熊猫数据框的列表，其中包含我想合并到单个数据框中的一天的刻度数据。我无法理解 concat 在我的时间戳上的行为。请参阅下面的详细信息：

```
data

[<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 35228 entries, 2013-03-28 00:00:07.089000+02:00 to 2013-03-28 18:59:20.357000+02:00
Data columns:
Price       4040  non-null values
Volume      4040  non-null values
BidQty      35228  non-null values
BidPrice    35228  non-null values
AskPrice    35228  non-null values
AskQty      35228  non-null values
dtypes: float64(6),
<class 'pandas.core.frame.DataFrame'>

DatetimeIndex: 33088 entries, 2013-04-01 00:03:17.047000+02:00 to 2013-04-01 18:59:58.175000+02:00
Data columns:
Price       3969  non-null values
Volume      3969  non-null values
BidQty      33088  non-null values
BidPrice    33088  non-null values
AskPrice    33088  non-null values
AskQty      33088  non-null values
dtypes: float64(6),
<class 'pandas.core.frame.DataFrame'>

DatetimeIndex: 50740 entries, 2013-04-02 00:03:27.470000+02:00 to 2013-04-02 18:59:58.172000+02:00
Data columns:
Price       7326  non-null values
Volume      7326  non-null values
BidQty      50740  non-null values
BidPrice    50740  non-null values
AskPrice    50740  non-null values
AskQty      50740  non-null values
dtypes: float64(6),
<class 'pandas.core.frame.DataFrame'>

DatetimeIndex: 60799 entries, 2013-04-03 00:03:06.994000+02:00 to 2013-04-03 18:59:58.180000+02:00
Data columns:
Price       8258  non-null values
Volume      8258  non-null values
BidQty      60799  non-null values
BidPrice    60799  non-null values
AskPrice    60799  non-null values
AskQty      60799  non-null values
dtypes: float64(6)] 
```

使用`append`我得到：

```
pd.DataFrame().append(data)

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 179855 entries, 2013-03-28 00:00:07.089000+02:00 to 2013-04-03 18:59:58.180000+02:00
Data columns:
AskPrice    179855  non-null values
AskQty      179855  non-null values
BidPrice    179855  non-null values
BidQty      179855  non-null values
Price       23593  non-null values
Volume      23593  non-null values
dtypes: float64(6) 
```

使用`concat`我得到：

```
pd.concat(data)

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 179855 entries, 2013-03-27 22:00:07.089000+02:00 to 2013-04-03 16:59:58.180000+02:00
Data columns:
Price       23593  non-null values
Volume      23593  non-null values
BidQty      179855  non-null values
BidPrice    179855  non-null values
AskPrice    179855  non-null values
AskQty      179855  non-null values
dtypes: float64(6) 
```

注意使用`concat`. 为什么会发生这种情况，我将如何使用`concat`来重现使用获得的结果`append`？（因为`concat`看起来要快得多；每个循环 24.6 毫秒 vs 每个循环 3.02 秒）

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2018-07-20T06:13:49.370

# Pandas concat vs append vs join vs merge

*   **Concat**提供了基于轴（所有行或所有列）连接的灵活性

*   **Append**是 concat 的具体情况(axis=0, join='outer')

*   **连接**基于变量 =['left','right','inner','outer'] 的索引（由 set_index 设置）

*   **合并**基于两个数据帧中的每一个的任何特定列，这些列是变量，如“left_on”、“right_on”、“on”

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2013-04-04T22:25:29.713

所以你在做什么是 append 和 concat*几乎*是等价的。不同之处在于空的 DataFrame。出于某种原因，这会导致大幅放缓，不确定究竟是为什么，将不得不看看某个点。下面是对您所做的基本操作的再现。

我几乎总是使用 concat （尽管在这种情况下它们是等价的，除了空框架）；如果您不使用空框架，它们将具有相同的速度。

```
In [17]: df1 = pd.DataFrame(dict(A = range(10000)),index=pd.date_range('20130101',periods=10000,freq='s'))

In [18]: df1
Out[18]: 
<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 10000 entries, 2013-01-01 00:00:00 to 2013-01-01 02:46:39
Freq: S
Data columns (total 1 columns):
A    10000  non-null values
dtypes: int64(1)

In [19]: df4 = pd.DataFrame()

The concat

In [20]: %timeit pd.concat([df1,df2,df3])
1000 loops, best of 3: 270 us per loop

This is equavalent of your append

In [21]: %timeit pd.concat([df4,df1,df2,df3])
10 loops, best of 

 3: 56.8 ms per loop 
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2018-01-09T12:17:46.720

我已经实现了一个小基准（请[在 Gist 上找到代码](https://gist.github.com/michaeldorner/eb167287ef3a0d3c44ab70fee24867ad)）来评估 pandas[`concat`](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.concat.html)和[`append`](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.append.html). 我在评论后更新了代码片段和结果[`ssk08`](https://stackoverflow.com/users/5314569/ssk08)- 非常感谢！

该基准测试在 Mac OS X 10.13 系统上运行，使用 Python 3.6.2 和 pandas 0.20.3。

```
+--------+---------------------------------+------ ---------------+
| | 忽略索引=假 | 忽略索引=真 |
+--------+---------------------------------+------ ---------------+
| 尺寸 | 附加 | 连接 | 追加/连接 | 附加 | 连接 | 追加/连接 |
+--------+--------+--------+----------------+------ --+--------+---------------+
| 小| 0.4635 | 0.4891 | 94.77 % | 0.4056 | 0.3314 | 122.39 % |
+--------+--------+--------+----------------+------ --+--------+---------------+
| 中 | 0.5532 | 0.6617 | 83.60 % | 0.3605 | 0.3521 | 102.37 % |
+--------+--------+--------+----------------+------ --+--------+---------------+
| 大| 0.9558 | 0.9442 | 101.22 % | 0.6670 | 0.6749 | 98.84 % |
+--------+--------+--------+----------------+------ --+--------+---------------+

```

使用`ignore_index=False` `append`稍微快一点，with`ignore_index=True` `concat`稍微快一点。

**tl; dr**`concat`和 之间没有显着差异`append`。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2019-07-13T07:21:29.423

您必须记住的另一件事是 Pandas 中的 APPEND() 方法不会修改原始对象。相反，它使用组合数据创建一个新的。因为涉及到创建和数据缓冲，所以性能不好。进行多 APPEND 操作时最好使用 CONCAT() 函数。

# java - 自动连接数据库？

> ID：15819053
> 
> 赞同：0
> 
> 时间：2013-04-04T18:37:28.960
> 
> 标签：java, database

您好，我有一个程序可以在线连接到数据库并从表中访问数据等。告诉我的朋友先打开 netbeans 并在服务中连接到数据库时，一切正常。我需要做的是让所有这些都自动化，比如在 jar 中运行或代码将连接的东西。

我用于 Connection 的是 'Connection con = ' blah blah 并且这个连接但我必须已经连接到服务中的数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T18:39:45.017

您可以将 Connection 变量设为静态。这使得在类加载时而不是在请求处理时建立连接。

# php - 单页主题的默认 WordPress 导航

> ID：15819054
> 
> 赞同：0
> 
> 时间：2013-04-04T18:37:29.223
> 
> 标签：php, wordpress, navigation, permalinks

我在这里发现了一个类似的问题：[单页导航菜单动态生成](https://stackoverflow.com/questions/7856712/single-page-navigation-menu-dynamically-generated)，但我不太确定这将如何或什至是否适用于我正在做的事情。

我正在构建一个单页主题，每次用户创建一个新页面时，都会创建一个新页面`<section id="page-title"></section>`并填充提供的内容。我一切正常，但我正在尝试使用 WordPress 的默认导航。就像用户创建新页面一样，它会自动添加到导航菜单中。现在我当然可以工作，但是链接指向我不想要的页面永久链接。我需要页面指向一个像' **/#page-title** '这样的url

如何调整 wordpress`wp_nav_menu();`功能以显示#标签和导航的页面标题而不是永久链接？

# python - 当我尝试多次迭代时出错

> ID：15819058
> 
> 赞同：0
> 
> 时间：2013-04-04T18:37:40.050
> 
> 标签：python

我有这个为 IA 计算 k-means 的程序

```
#! /usr/bin/env python
# -*- coding: utf-8 -*-

from random import sample
from itertools import repeat
from math import sqrt

# Parametros
k = 6
maxit = 2

def leeValoracionesFiltradas (nomFichero = "valoracionesFiltradas.data"):
    lineas = [(l.strip()).split("\t") for l in (open(nomFichero).readlines())]
    diccio = {}
    for l in lineas:    
        diccio[int(l[0])] = {}
    for l in lineas:
        diccio[int(l[0])][int(l[1])] = (float(l[2]),float(l[3]))
    return diccio

def distEuclidea(dic1, dic2):
    # Se calcula la suma de cuadrados de los elementos comunes a los dos diccionarios
    sum2 = sum([pow(dic1[elem]-dic2[elem], 2)
                for elem in dic1 if elem in dic2])
    return sqrt(sum2)

def similitudEuclidea(dic1, dic2):
    return 1/(1+distEuclidea(dic1, dic2))

def coefPearson(dic1, dic2):
    # Se consiguen los elementos comunes en ambos diccionarios
    comunes = [x for x in dic1 if x in dic2]
    nComunes = float(len(comunes))

    # Si no hay comunes -> cero
    if nComunes==0:
        return 0

    # Calculo de las medias de cada diccionario
    media1 = sum([dic1[x][1] for x in comunes]) / nComunes
    media2 = sum([dic2[x][1] for x in comunes]) / nComunes

    # Numerador y denominador
    num = sum([(dic1[x][1] - media1) * (dic2[x][1] - media2) for x in comunes])
    den1 = sqrt(sum([pow(dic1[x][1] - media1, 2) for x in comunes]))
    den2 = sqrt(sum([pow(dic2[x][1] - media2, 2) for x in comunes]))
    den  = den1 * den2

    # Caculo del coeficiente
    if den==0:
        return 0

    return num/den

# Dado un diccionario {key1 : {key2 : valor}} calcula el agrupamiento k-means
# con k clusters (grupo), ejecutando maxit iteraciones, con la funcion de similitud especificada
# Retorna una tupla
# -{key1:numero de clusters} con las asignaciones de clusters (a que clusters pertenece cada elemento)
# -[{key2:valores}] una lista con los k centroides (media de los valores para cada clusters)
def kmeans (diccionario, k, maxit, similitud = coefPearson):

   # K puntos aleatorios son elegidos como centroides incialmente
   # Cada centroide es {key2 : valor}
   centroides = [diccionario[x] for x in sample(diccionario.keys(), k)]

   # Se asigna cada key1 a un numero de cluster
   previo  = None
   asignacion = {}

   # En cada iteracion se asignan puntos a los centroides y se calculan nuevos centroides
   for it in range(maxit):

       # Se asignan puntos a los centroides mas cercanos
       for key1 in diccionario:
           similitudes = map(similitud,repeat(diccionario[key1],k), centroides)
           asignacion[key1] = similitudes.index(max(similitudes))

       # Si no hay cambios en la asignacion, se termina
       if previo == asignacion: break
       previo = asignacion

       # Se recalculan los centroides (se anotan los valores de cada key a cada centroide)
       valores   = {x : {} for x in range(k)}
       contadores = {x : {} for x in range(k)}
       for key1 in diccionario:
           grupo = asignacion[key1]
           for key2 in diccionario[key1]:
               if not valores[grupo].has_key(key2):
                   valores   [grupo][key2] = 0
                   contadores [grupo][key2] = 0
               valores  [grupo][key2] += diccionario[key1][key2][1]
               contadores[grupo][key2] += 1

       # Se calculan las medias (nuevos centroides)
       centroides = []
       for grupo in valores:
           centro = {}
           for key2 in valores[grupo]:
               centro[key2] = round((valores[grupo][key2] / contadores[grupo][key2]),2)
           centroides.append(centro)

       if None in centroides: break

   return (asignacion, centroides)

# Se obtiene el diccionario de valoraciones (las valoraciones ya han sido filtradas)    
diccionario = leeValoracionesFiltradas()

# Se obtienen las asignaciones y los centroides con la correlacion de Pearson
tupla = kmeans (diccionario, k, maxit)
asignaciones = tupla[0]
centroids = tupla[1]
print asignaciones
print centroids 
```

例如，当我为 maxit = 2 执行此操作时，它会抛出：

```
 File "kmeans_dictio.py", line 46, in coefPearson
    media2 = sum([dic2[x][1] for x in comunes]) / nComunes
TypeError: 'float' object has no attribute '__getitem__' 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T18:41:20.827

看起来您有一个浮点字典 ( `dic2`) 和一个浮点字典 ( `dic1`)，您正在使用此行从中拉出一个项目：

```
comunes = [x for x in dic1 if x in dic2] 
```

然后你试图在这里迭代这个`float`：

```
media2 = sum([dic2[x][1] for x in comunes]) / nComunes 
```

要解决此问题，请查看它们`dic1`以及`dic2`它们是如何定义的。

# php - 用户配置文件中的 Drupal 7 实体参考

> ID：15819065
> 
> 赞同：0
> 
> 时间：2013-04-04T18:37:51.473
> 
> 标签：php, drupal, drupal-7, drupal-views

我有一个带有名为 Logo 的图像字段的客户端内容类型。

客户 - 图片：徽标

我还有一个带有实体参考字段名称特色客户的用户配置文件。

用户 - 实体参考

如何创建将显示用户配置文件中引用的客户端节点的客户端图像徽标的视图？

设想：

用户（示例）- 此“示例”用户的实体引用引用客户端节点 #1。

我希望该客户端节点 #1 的图像徽标显示在用户“示例”配置文件中。

希望这是有道理的。我一直在研究 Drupal 7 中的上下文过滤器和实体引用，但我还没有找到合适的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:49:02.977

我想到了。

创建视图时，在关系下，我选择了以下内容：

*   配置文件引用来自 field_some_featured_clients 的内容
*   要求检查此关系

在上下文过滤器下，我选择了以下内容：

*   用户身份
*   指定验证条件 >> 用户 >> 允许用户 ID 和字符串用户名
*   当过滤器不可用 >> 提供默认值 >> 来自 URL 的用户 ID

在字段下，我选择了以下内容：

*   内容：标志

# vba - 在数组中分配新值时 VBA 应用程序定义的错误

> ID：15819068
> 
> 赞同：0
> 
> 时间：2013-04-04T18:38:02.707
> 
> 标签：vba, excel

我正在尝试编写一个函数，该函数接受一个变体数组（二维），然后遍历它并将所有日期更改为 long。

```
Private Function mlDateHelper(a As Variant)
    Dim i, j As Integer
    For i = 1 To UBound(a.value, 1)
        For j = 1 To UBound(a.value, 2)
            If IsDate(a(i, j)) Then
                a(i, j) = CLng(a(i, j)) 'This line errors out
            End If
        Next j
    Next i
    mlDateHelper = a
End Function 
```

基本上，我只是在两个维度上遍历数组，每当有日期时，我都会尝试将该日期重置为 long。

当我调试它时，我可以告诉它正确地计算`CLng(a(i, j))`，但是当它试图将该值分配给 a(i, j) 时它会崩溃。

它给了我一个“应用程序定义或对象定义的错误”。想法？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:07:57.413

如果 a 始终是一个范围，您可能应该利用这个事实：

```
Private Function mlDateHelper(a As Range)
Dim c As Cell
For each c in a.Cells
    c.Value = CLng(c.Value)
Next
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T18:57:16.543

我使用 MS-Access 2007 VBA 通过从 UBound 语句中删除 .value 来测试它，因为它不会在 Access 中编译。我希望这对你有用（我对将定义为 Dim arr(1 To 5, 1 To 7) 的数组传递给以下函数的赋值没有问题：

```
Private Function mlDateHelper(a As Variant)
    Dim i, j As Integer
    For i = 1 To UBound(a, 1)
        For j = 1 To UBound(a, 2)
            If IsDate(a(i, j)) Then
                a(i, j) = CLng(a(i, j)) 'This line errors out
            End If
        Next j
    Next i
    mlDateHelper = a
End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:02:57.720

感谢任何正在调查我的问题的人。

我实际上发现我不需要这个函数，因为我可以简单地使用`a.Value2`Variant 的属性，它不会尝试将日期转换为日期。

根据我发现的文档：“*此属性和 Value 属性之间的唯一区别是 Value2 属性不使用 Currency 和 Date 数据类型。您可以使用这些数据类型将格式化为浮点数的值返回双数据类型。* ”

感谢您的帮助！

# java - 在 Java 中使用循环优化 if 语句

> ID：15819069
> 
> 赞同：0
> 
> 时间：2013-04-04T18:38:02.650
> 
> 标签：java, loops

我正在尝试优化此代码中存在的大量 if 语句：

```
public class MyClass{
    ArrayList<Stack<String>> positions = new ArrayList<Stack<String>>();

    Stack<String> pos1;
    Stack<String> pos2;
    Stack<String> pos3;
    Stack<String> pos4;
    Stack<String> pos5;
    Stack<String> pos6;
    Stack<String> pos7;
    Stack<String> pos8;
    Stack<String> pos9;
    Stack<String> pos10;
    Stack<String> pos11;
    Stack<String> pos12;
    Stack<String> pos13;
    Stack<String> pos14;
    Stack<String> pos15;
    Stack<String> pos16;
    Stack<String> pos17;
    Stack<String> pos18;
    Stack<String> pos19;
    Stack<String> pos20;
    Stack<String> pos21;
    Stack<String> pos22;
    Stack<String> pos23;
    Stack<String> pos24;
    Stack<String> pos25;
    Stack<String> pos26;
    Stack<String> pos27;

public ClassName{
        for (int i=0; i<28; i++) {
            positions.add(i,new Stack<String>());
        }

}

public void Updater (int position, boolean player){

        if(player){ // if player one is up
            // start position 1 actions
            if(position==1){
                int distance = pos1.size(); 
                if(distance==1){
                    String temp = pos1.peek();
                    if(temp=="x"){ // only make move if player one's chip is on top of the stack
                        pos1.pop();
                        pos2.push(temp);
                    }
                }
                if(distance==2){
                    String temp = pos1.peek();
                    if(temp=="x"){
                        pos1.pop();
                        pos3.push(temp);
                    }
                }
                if(distance==3){
                    String temp = pos1.peek();
                    if(temp=="x"){
                        pos1.pop();
                        pos7.push(temp);
                    }
                }
                if(distance==4){
                    String temp = pos1.peek();
                    if(temp=="x"){
                        pos1.pop();
                        pos8.push(temp);
                    }
                }
                if(distance==5){
                    String temp = pos1.peek();
                    if(temp=="x"){
                        pos1.pop();
                        pos9.push(temp);
                    }
                }
                if(distance==6){
                    String temp = pos1.peek();
                    if(temp=="x"){
                        pos1.pop();
                        pos10.push(temp);
                    }
                }
                if(distance==7){
                    String temp = pos1.peek();
                    if(temp=="x"){
                        pos1.pop();
                        pos11.push(temp);
                    }
                }
                if(distance==8){
                    String temp = pos1.peek();
                    if(temp=="x"){
                        pos1.pop();
                        pos12.push(temp);
                    }
                }
                if(distance==9){
                    String temp = pos1.peek();
                    if(temp=="x"){
                        pos1.pop();
                        pos13.push(temp);
                    }
                }
                if(distance==10){
                    String temp = pos1.peek();
                    if(temp=="x"){
                        pos1.pop();
                        pos14.push(temp);
                    }
                }
                if(distance==11){
                    String temp = pos1.peek();
                    if(temp=="x"){
                        pos1.pop();
                        pos15.push(temp);
                    }
                }
                if(distance==12){
                    String temp = pos1.peek();
                    if(temp=="x"){
                        pos1.pop();
                        pos16.push(temp);
                    }
                }
                if(distance==13){
                    String temp = pos1.peek();
                    if(temp=="x"){
                        pos1.pop();
                        pos16.push(temp);
                    }
                }
                if(distance>13){
                    String temp = pos1.peek();
                    pos1.pop();
                    if(temp=="x"){
                        pos26.push(temp); // push to player one's winners circle
                    }
                }

            }
            // end position 1 actions

            // start position 2 actions
            if(position==2){
                int distance = pos2.size(); 
                if(distance==1){
                    String temp = pos2.peek();
                    if(temp=="x"){
                        pos2.pop();
                        pos3.push(temp);
                    }
                }
                if(distance==2){
                    String temp = pos2.peek();
                    if(temp=="x"){
                        pos2.pop();
                        pos7.push(temp);
                    }
                }               
                if(distance==3){
                    String temp = pos2.peek();
                    if(temp=="x"){ 
                        pos2.pop();
                        pos8.push(temp);
                    }
                }               
                if(distance==4){
                    String temp = pos2.peek();
                    if(temp=="x"){
                        pos2.pop();
                        pos9.push(temp);
                    }
                }           
                if(distance==5){
                    String temp = pos2.peek();
                    if(temp=="x"){
                        pos2.pop();
                        pos10.push(temp);
                    }
                }               
                if(distance==6){
                    String temp = pos2.peek();
                    if(temp=="x"){
                        pos2.pop();
                        pos11.push(temp);
                    }
                }               
                if(distance==7){
                    String temp = pos2.peek();
                    if(temp=="x"){
                        pos2.pop();
                        pos12.push(temp);
                    }
                }           
                if(distance==8){
                    String temp = pos2.peek();
                    if(temp=="x"){ 
                        pos2.pop();
                        pos13.push(temp);
                    }
                }           
                if(distance==8){
                    String temp = pos2.peek();
                    if(temp=="x"){
                        pos2.pop();
                        pos14.push(temp);
                    }
                }
                if(distance==9){
                    String temp = pos2.peek();
                    if(temp=="x"){
                        pos2.pop();
                        pos15.push(temp);
                    }
                }
                if(distance==10){
                    String temp = pos2.peek();
                    if(temp=="x"){ 
                        pos2.pop();
                        pos16.push(temp);
                    }
                }
                if(distance==11){
                    String temp = pos2.peek();
                    if(temp=="x"){ 
                        pos2.pop();
                        pos17.push(temp);
                    }
                }
                if(distance>11){
                    String temp = pos2.peek();
                    pos2.pop();
                    if(temp=="x"){
                        pos26.push(temp); // push to player one's winners circle
                    }
                }

            }
            // end position 2 actions

            // start position 3 actions
            if(position==3){
                int distance = pos3.size(); 
                if(distance==1){
                    String temp = pos3.peek();
                    if(temp=="x"){
                        pos3.pop();
                        pos7.push(temp);
                    }
                }
                if(distance==2){
                    String temp = pos3.peek();
                    if(temp=="x"){
                        pos3.pop();
                        pos8.push(temp);
                    }
                }               
                if(distance==3){
                    String temp = pos3.peek();
                    if(temp=="x"){ 
                        pos3.pop();
                        pos9.push(temp);
                    }
                }               
                if(distance==4){
                    String temp = pos3.peek();
                    if(temp=="x"){
                        pos3.pop();
                        pos10.push(temp);
                    }
                }           
                if(distance==5){
                    String temp = pos3.peek();
                    if(temp=="x"){
                        pos3.pop();
                        pos11.push(temp);
                    }
                }               
                if(distance==6){
                    String temp = pos3.peek();
                    if(temp=="x"){
                        pos3.pop();
                        pos12.push(temp);
                    }
                }               
                if(distance==7){
                    String temp = pos3.peek();
                    if(temp=="x"){
                        pos3.pop();
                        pos13.push(temp);
                    }
                }           
                if(distance==8){
                    String temp = pos3.peek();
                    if(temp=="x"){ 
                        pos3.pop();
                        pos14.push(temp);
                    }
                }           
                if(distance==9){
                    String temp = pos3.peek();
                    if(temp=="x"){
                        pos3.pop();
                        pos15.push(temp);
                    }
                }
                if(distance==10){
                    String temp = pos3.peek();
                    if(temp=="x"){
                        pos3.pop();
                        pos16.push(temp);
                    }
                }
                if(distance==11){
                    String temp = pos3.peek();
                    if(temp=="x"){ 
                        pos3.pop();
                        pos17.push(temp);
                    }
                }
                if(distance>11){
                    String temp = pos3.peek();
                    pos3.pop();
                    if(temp=="x"){
                        pos26.push(temp); // push to player one's winners circle
                    }
                }

            }
            // end position 3 actions

            // start position 7 actions
            if(position==7){
                int distance = pos7.size(); 
                if(distance==1){
                    String temp = pos7.peek();
                    if(temp=="x"){
                        pos7.pop();
                        pos8.push(temp);
                    }
                }
                if(distance==2){
                    String temp = pos7.peek();
                    if(temp=="x"){
                        pos7.pop();
                        pos9.push(temp);
                    }
                }               
                if(distance==3){
                    String temp = pos7.peek();
                    if(temp=="x"){ 
                        pos7.pop();
                        pos10.push(temp);
                    }
                }               
                if(distance==4){
                    String temp = pos7.peek();
                    if(temp=="x"){
                        pos7.pop();
                        pos11.push(temp);
                    }
                }           
                if(distance==5){
                    String temp = pos7.peek();
                    if(temp=="x"){
                        pos7.pop();
                        pos12.push(temp);
                    }
                }               
                if(distance==6){
                    String temp = pos7.peek();
                    if(temp=="x"){
                        pos7.pop();
                        pos13.push(temp);
                    }
                }               
                if(distance==7){
                    String temp = pos7.peek();
                    if(temp=="x"){
                        pos7.pop();
                        pos14.push(temp);
                    }
                }           
                if(distance==8){
                    String temp = pos7.peek();
                    if(temp=="x"){ 
                        pos7.pop();
                        pos15.push(temp);
                    }
                }           
                if(distance==9){
                    String temp = pos7.peek();
                    if(temp=="x"){
                        pos7.pop();
                        pos16.push(temp);
                    }
                }
                if(distance==10){
                    String temp = pos7.peek();
                    if(temp=="x"){
                        pos7.pop();
                        pos17.push(temp);
                    }
                }
                if(distance>10){
                    String temp = pos7.peek();
                    pos7.pop();
                    if(temp=="x"){
                        pos26.push(temp); // push to player one's winners circle
                    }
                }

            }
            // end position 7 actions

            // start position 8 actions
            if(position==8){
                int distance = pos8.size(); 
                if(distance==1){
                    String temp = pos8.peek();
                    if(temp=="x"){
                        pos8.pop();
                        pos9.push(temp);
                    }
                }
                if(distance==2){
                    String temp = pos8.peek();
                    if(temp=="x"){
                        pos8.pop();
                        pos10.push(temp);
                    }
                }               
                if(distance==3){
                    String temp = pos8.peek();
                    if(temp=="x"){ 
                        pos8.pop();
                        pos11.push(temp);
                    }
                }               
                if(distance==4){
                    String temp = pos8.peek();
                    if(temp=="x"){
                        pos8.pop();
                        pos12.push(temp);
                    }
                }           
                if(distance==5){
                    String temp = pos8.peek();
                    if(temp=="x"){
                        pos8.pop();
                        pos13.push(temp);
                    }
                }               
                if(distance==6){
                    String temp = pos8.peek();
                    if(temp=="x"){
                        pos8.pop();
                        pos14.push(temp);
                    }
                }               
                if(distance==7){
                    String temp = pos8.peek();
                    if(temp=="x"){
                        pos8.pop();
                        pos15.push(temp);
                    }
                }           
                if(distance==8){
                    String temp = pos8.peek();
                    if(temp=="x"){ 
                        pos8.pop();
                        pos16.push(temp);
                    }
                }           
                if(distance==9){
                    String temp = pos8.peek();
                    if(temp=="x"){
                        pos8.pop();
                        pos17.push(temp);
                    }
                }
                if(distance>9){
                    String temp = pos8.peek();
                    pos8.pop();
                    if(temp=="x"){
                        pos26.push(temp); // push to player one's winners circle
                    }
                }

            }
            // end position 8 actions

            // start position 9 actions
            if(position==9){
                int distance = pos9.size(); 
                if(distance==1){
                    String temp = pos9.peek();
                    if(temp=="x"){
                        pos9.pop();
                        pos10.push(temp);
                    }
                }
                if(distance==2){
                    String temp = pos9.peek();
                    if(temp=="x"){
                        pos9.pop();
                        pos11.push(temp);
                    }
                }               
                if(distance==3){
                    String temp = pos9.peek();
                    if(temp=="x"){ 
                        pos9.pop();
                        pos12.push(temp);
                    }
                }               
                if(distance==4){
                    String temp = pos9.peek();
                    if(temp=="x"){
                        pos9.pop();
                        pos13.push(temp);
                    }
                }           
                if(distance==5){
                    String temp = pos9.peek();
                    if(temp=="x"){
                        pos9.pop();
                        pos14.push(temp);
                    }
                }               
                if(distance==6){
                    String temp = pos9.peek();
                    if(temp=="x"){
                        pos9.pop();
                        pos15.push(temp);
                    }
                }               
                if(distance==7){
                    String temp = pos9.peek();
                    if(temp=="x"){
                        pos9.pop();
                        pos16.push(temp);
                    }
                }           
                if(distance==8){
                    String temp = pos9.peek();
                    if(temp=="x"){ 
                        pos9.pop();
                        pos17.push(temp);
                    }
                }           
                if(distance>8){
                    String temp = pos9.peek();
                    pos9.pop();
                    if(temp=="x"){
                        pos26.push(temp); // push to player one's winners circle
                    }
                }

            }
            // end position 9 actions

            // start position 10 actions
            if(position==10){
                int distance = pos10.size();    
                if(distance==1){
                    String temp = pos10.peek();
                    if(temp=="x"){
                        pos10.pop();
                        pos11.push(temp);
                    }
                }
                if(distance==2){
                    String temp = pos10.peek();
                    if(temp=="x"){
                        pos10.pop();
                        pos12.push(temp);
                    }
                }               
                if(distance==3){
                    String temp = pos10.peek();
                    if(temp=="x"){ 
                        pos10.pop();
                        pos13.push(temp);
                    }
                }               
                if(distance==4){
                    String temp = pos10.peek();
                    if(temp=="x"){
                        pos10.pop();
                        pos14.push(temp);
                    }
                }           
                if(distance==5){
                    String temp = pos10.peek();
                    if(temp=="x"){
                        pos10.pop();
                        pos15.push(temp);
                    }
                }               
                if(distance==6){
                    String temp = pos10.peek();
                    if(temp=="x"){
                        pos10.pop();
                        pos16.push(temp);
                    }
                }               
                if(distance==7){
                    String temp = pos10.peek();
                    if(temp=="x"){
                        pos10.pop();
                        pos17.push(temp);
                    }
                }                   
                if(distance>7){
                    String temp = pos10.peek();
                    pos10.pop();
                    if(temp=="x"){
                        pos26.push(temp); // push to player one's winners circle
                    }
                }

            }
            // end position 10 actions

            // start position 11 actions
            if(position==11){
                int distance = pos11.size();    
                if(distance==1){
                    String temp = pos11.peek();
                    if(temp=="x"){
                        pos11.pop();
                        pos12.push(temp);
                    }
                }
                if(distance==2){
                    String temp = pos11.peek();
                    if(temp=="x"){
                        pos11.pop();
                        pos13.push(temp);
                    }
                }               
                if(distance==3){
                    String temp = pos11.peek();
                    if(temp=="x"){ 
                        pos11.pop();
                        pos14.push(temp);
                    }
                }               
                if(distance==4){
                    String temp = pos11.peek();
                    if(temp=="x"){
                        pos11.pop();
                        pos15.push(temp);
                    }
                }           
                if(distance==5){
                    String temp = pos11.peek();
                    if(temp=="x"){
                        pos11.pop();
                        pos16.push(temp);
                    }
                }               
                if(distance==6){
                    String temp = pos11.peek();
                    if(temp=="x"){
                        pos11.pop();
                        pos17.push(temp);
                    }
                }                   
                if(distance>6){
                    String temp = pos11.peek();
                    pos11.pop();
                    if(temp=="x"){
                        pos26.push(temp); // push to player one's winners circle
                    }
                }

            }
            // end position 11 actions

            // start position 12 actions
            if(position==12){
                int distance = pos12.size();    
                if(distance==1){
                    String temp = pos12.peek();
                    if(temp=="x"){
                        pos12.pop();
                        pos13.push(temp);
                    }
                }
                if(distance==2){
                    String temp = pos12.peek();
                    if(temp=="x"){
                        pos12.pop();
                        pos14.push(temp);
                    }
                }               
                if(distance==3){
                    String temp = pos12.peek();
                    if(temp=="x"){ 
                        pos12.pop();
                        pos15.push(temp);
                    }
                }               
                if(distance==4){
                    String temp = pos12.peek();
                    if(temp=="x"){
                        pos12.pop();
                        pos16.push(temp);
                    }
                }           
                if(distance==5){
                    String temp = pos12.peek();
                    if(temp=="x"){
                        pos12.pop();
                        pos17.push(temp);
                    }
                }                               
                if(distance>5){
                    String temp = pos12.peek();
                    pos12.pop();
                    if(temp=="x"){
                        pos26.push(temp); // push to player one's winners circle
                    }
                }

            }
            // end position 12 actions

            // start position 13 actions
            if(position==13){
                int distance = pos13.size();    
                if(distance==1){
                    String temp = pos13.peek();
                    if(temp=="x"){
                        pos13.pop();
                        pos14.push(temp);
                    }
                }
                if(distance==2){
                    String temp = pos13.peek();
                    if(temp=="x"){
                        pos13.pop();
                        pos15.push(temp);
                    }
                }               
                if(distance==3){
                    String temp = pos13.peek();
                    if(temp=="x"){ 
                        pos13.pop();
                        pos16.push(temp);
                    }
                }               
                if(distance==4){
                    String temp = pos13.peek();
                    if(temp=="x"){
                        pos13.pop();
                        pos17.push(temp);
                    }
                }                                       
                if(distance>4){
                    String temp = pos13.peek();
                    pos13.pop();
                    if(temp=="x"){
                        pos26.push(temp); // push to player one's winners circle
                    }
                }

            }
            // end position 13 actions

            // start position 14 actions
            if(position==14){
                int distance = pos14.size();    
                if(distance==1){
                    String temp = pos14.peek();
                    if(temp=="x"){
                        pos14.pop();
                        pos15.push(temp);
                    }
                }
                if(distance==2){
                    String temp = pos14.peek();
                    if(temp=="x"){
                        pos14.pop();
                        pos16.push(temp);
                    }
                }               
                if(distance==3){
                    String temp = pos14.peek();
                    if(temp=="x"){ 
                        pos14.pop();
                        pos17.push(temp);
                    }
                }                                                   
                if(distance>3){
                    String temp = pos14.peek();
                    pos14.pop();
                    if(temp=="x"){
                        pos26.push(temp); // push to player one's winners circle
                    }
                }

            }
            // end position 14 actions

            // start position 15 actions
            if(position==15){
                int distance = pos15.size();    
                if(distance==1){
                    String temp = pos15.peek();
                    if(temp=="x"){
                        pos15.pop();
                        pos16.push(temp);
                    }
                }
                if(distance==2){
                    String temp = pos15.peek();
                    if(temp=="x"){
                        pos15.pop();
                        pos17.push(temp);
                    }
                }                                           
                if(distance>2){
                    String temp = pos15.peek();
                    pos15.pop();
                    if(temp=="x"){
                        pos26.push(temp); // push to player one's winners circle
                    }
                }

            }
            // end position 15 actions

            // start position 16 actions
            if(position==15){
                int distance = pos16.size();    
                if(distance==1){
                    String temp = pos16.peek();
                    if(temp=="x"){
                        pos16.pop();
                        pos17.push(temp);
                    }
                }                                   
                if(distance>1){
                    String temp = pos16.peek();
                    pos16.pop();
                    if(temp=="x"){
                        pos26.push(temp); // push to player one's winners circle
                    }
                }

            }
            // end position 16 actions

            // start position 17 actions
            if(position==17){
                int distance = pos17.size();                                    
                if(distance>=1){
                    String temp = pos17.peek();
                    pos17.pop();
                    if(temp=="x"){
                        pos26.push(temp); // push to player one's winners circle
                    }
                }

            }
            // end position 17 actions

            player = false;
            frame.player.setText("Current Player's Turn: Player Two");
        }
} 
```

}

基本上，有 25 个堆栈，每个堆栈存储各种 x 和 o 字符串。updater 方法根据参数将 x 和 o 从一个堆栈移动到另一个堆栈。是否真的有必要像我在这里那样编写尽可能多的 if 语句来涵盖每种情况？有没有我可以使用的循环？

x 和 o 只能向前移动，不能向后移动。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T18:42:15.493

为什么不创建一个堆栈数组？然后你可以减少 if 语句：

```
Stack[] stacks = new Stack[27];
Arrays.fill(stacks, new Stack<String>);
if (temp.equals("x")) {
   Stack stack = stacks[distance];
   //all other stuff
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T18:42:20.477

声明：`if(distance==1){` 可以用这样的东西代替：

```
for(int i= 0 ;i< 13;i++) {
        if(distance==i) {
            // some code
            break; // break the loop once match is found
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T18:48:12.717

您需要做的事情很少：

如果你发现自己做了很多 if `if(distance==1){`... `pos1.pop();`then `if(distance==2){`... `pos2.pop();`etc.，使用`ArrayList<Stack<String>>`你已经声明的，然后得到你需要的。

```
if (/* distance is within bounds */)
{
    Stack<String> pos = positions.get(distance);
    ... 
```

您可以对`temp`返回的值执行类似的操作，以确定您需要推送到哪个值。这将消除所有那些重复的代码`if`块。

接下来，在每种情况下，您都将字符串值与`==`运算符进行比较。运算符比较引用以查看它们是否相同，这`==`可能不是您想要的。用于`String#equals`比较`String`值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T18:41:04.973

如果你想优化，你可以从使用`else if`90% 的重复 if 语句开始。这样一来，您只打到您需要的那个，而不是全部。这也将减少错误。

```
if(player){ // if player one is up
            // start position 1 actions
            if(position==1){
                int distance = pos1.size(); 
                if(distance==1){
                    String temp = pos1.peek();
                    if(temp.equals("x")){ // only make move if player one's chip is on top of the stack
                        pos1.pop();
                        pos2.push(temp);
                    }
                }
               else if(distance==2){
                    String temp = pos1.peek();
                    if(temp.equals("x")){
                        pos1.pop();
                        pos3.push(temp);
                    }
                }
               else if(distance==3){
                    String temp = pos1.peek();
                    if(temp.equals("x")){
                        pos1.pop();
                        pos7.push(temp);
                    }
                }
                else if(distance==4){
                    String temp = pos1.peek();
                    if(temp.equals("x")){
                        pos1.pop();
                        pos8.push(temp);
                    }
                }
                else if(distance==5){
                    String temp = pos1.peek();
                    if(temp.equals("x")){
                        pos1.pop();
                        pos9.push(temp);
                    }
                }
                else if(distance==6){
                    String temp = pos1.peek();
                    if(temp.equals("x")){
                        pos1.pop();
                        pos10.push(temp);
                    }
                }
                else if(distance==7){
                    String temp = pos1.peek();
                    if(temp.equals("x")){
                        pos1.pop();
                        pos11.push(temp);
                    }
                }
                else if(distance==8){
                    String temp = pos1.peek();
                    if(temp.equals("x")){
                        pos1.pop();
                        pos12.push(temp);
                    }
                }
                else if(distance==9){
                    String temp = pos1.peek();
                    if(temp.equals("x")){
                        pos1.pop();
                        pos13.push(temp);
                    }
                }
                else if(distance==10){
                    String temp = pos1.peek();
                    if(temp.equals("x")){
                        pos1.pop();
                        pos14.push(temp);
                    }
                }
                else if(distance==11){
                    String temp = pos1.peek();
                    if(temp.equals("x")){
                        pos1.pop();
                        pos15.push(temp);
                    }
                }
                else if(distance==12){
                    String temp = pos1.peek();
                    if(temp.equals("x")){
                        pos1.pop();
                        pos16.push(temp);
                    }
                }
                else if(distance==13){
                    String temp = pos1.peek();
                    if(temp.equals("x")){
                        pos1.pop();
                        pos16.push(temp);
                    }
                }
                else if(distance>13){
                    String temp = pos1.peek();
                    pos1.pop();
                    if(temp.equals("x")){
                        pos26.push(temp); // push to player one's winners circle
                    }
                }

            }
            // end position 1 actions 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-04T18:43:10.903

您可以使用嵌套`for`循环，然后`if`根据以下值进行测试`i`：

```
for(int i = 1;i<=15;i++)//position
{
for(int c = 1;c<=4;c++)//distance
{
if(position==i)//etc.
}
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-04T19:08:49.550

这里有一些提示。

动态创建堆栈：

```
int total = 27
List<Stack<String>> positions = new ArrayList<Stack<String>>();
for (i = 0; i < toal; i++){
   positions.add(new Stack<String>());
} 
```

您现在可以使用`positions.get(position);`

您可以大大简化代码：

```
Stack<String> positionStack = positions.get(position);
int distance = positionStack.size();
if (positionStack.peek().equals("x")){
   positions(nextMove(position).push(positionStack.pop());
} 
```

`nextMove(int position)`是一个从给定位置计算下一个位置的函数。我不知道那个功能是什么，但你可以想出它。

# android - 如何建立 HTTP 连接并检索网站 HTML 的移动版本？

> ID：15819078
> 
> 赞同：0
> 
> 时间：2013-04-04T18:38:23.057
> 
> 标签：android, user-agent, httpconnection

假设我需要检索`Httpget`在我的应用程序中制作的网站的 HTML。但是，如果网站有内容的移动版本，我想要这个版本，而不是通常的/桌面版本（例如，如果您在手机中访问[http://techcrunch.com/](http://techcrunch.com/)，您会得到一个不同的 html如果您在桌面上访问此网站，将获得）

我制作了以下代码：

```
HttpClient client = new DefaultHttpClient();
HttpGet request = new HttpGet(url);
request.setHeader("User-Agent", System.getProperty("http.agent"));
HttpResponse response = client.execute(request);

BufferedReader br = new BufferedReader(new InputStreamReader(response.getEntity().getContent()));
StringBuilder sb = new StringBuilder();
String line;
while ((line = br.readLine()) != null) {
    sb.append(line);
}
String html = sb.toString(); 
```

但在那之后，该`html`字符串包含网站的“桌面”版本，而不是移动版本的 HTML。我的直觉说我只需要为httpget配置“用户代理”，但似乎我需要配置其他任何东西。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:06:12.373

我已经解决了这个问题。

我的错误是在线

```
request.setHeader("User-Agent", System.getProperty("http.agent")); 
```

要获得正确的用户代理，我需要创建一个`Webview`并执行以下操作：

```
request.setHeader("User-Agent", webview.getSettings().getUserAgentString()); 
```

这样，`HTTPGet`将检索网站内容的移动版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T18:45:02.343

我认为你在正确的轨道上，因为大多数网站都会查看用户代理来确定请求的页面应该是完整版还是移动版。我认为您最好的选择是将用户代理字符串设置为硬编码值，也许只是为了测试？可能是这样的：

> Mozilla/5.0 (Linux; U; Android 4.0.3; ko-kr; LG-L160L Build/IML74K) AppleWebkit/534.30 (KHTML, like Gecko) 版本/4.0 Mobile Safari/534.30

# php - 无法获取使用 Java Script 生成的 php 中动态表单元素的值

> ID：15819081
> 
> 赞同：-1
> 
> 时间：2013-04-04T18:38:29.823
> 
> 标签：php, javascript, forms, dynamic

请不要介意我，我是javascript新手。我在一个 php 文件中创建了一个 html 表单，其中生成了单选按钮、复选框和跳转菜单等元素，并根据 javascript 中的单击功能给出了值。具有各自值的表单元素看起来很好，但我无法通过 php 检索动态表单元素的值。任何形式的帮助都将不胜感激，已经在这个问题上停留了很长一段时间，找不到问题的实际答案。代码如下：

```
 function addInput(divName) {

             var text=document.forms["newQuest"]["roptionName"].value;
             var newdiv = document.createElement('div');
             newdiv.innerHTML = text +  " <br><input type='radio' name='myInputs[]'>";
             document.getElementById(divName).appendChild(newdiv);

            var form_data = {
                action:"add_rad",
                val:text
            };
            $.ajax({
                    type: "GET",
                    url: "../scripts/addQuestion.php",
                    data: form_data,
                    success: function(result) 
                    {
                        alert(result);
                        //document.getElementById("subjects").innerHTML=result;

                    }
                });
     } 
```

在 addQuestion.php 中： $array=$_GET['form_data'];

我总是在上面的语句中得到关于未定义索引的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T18:47:49.953

要通过 ajax 发送表单数据，您必须对其进行序列化并将其添加到您的 ajax 请求中。像这样的东西：

```
formData = $('form').serialize(); 
```

如果要向其添加附加数据，则应该能够像这样附加它：

```
formdata.action = "add_rad";
... 
```

你的ajax调用的其余部分似乎没问题

在服务器端，您从请求中获取变量，如下所示：

```
$myInputs = $_REQUEST['myInputs']; 
```

但是，您应该确保数据存在于 array_key_exists 之类的东西中，这只是一个简单的例子......

# javascript - 闭包语法： (function a(){})() == (function a(){}())?

> ID：15819083
> 
> 赞同：1
> 
> 时间：2013-04-04T18:38:33.167
> 
> 标签：javascript, closures

我注意到[Google Closure Compiler](http://closure-compiler.appspot.com/)似乎可以互换使用两者。

1.

```
(function a() {
  window.requestAnimationFrame(function() {
    //
    a();
  });
})(); 
```

2.

```
(function a() {
  window.requestAnimationFrame(function() {
    //
    a();
  });
}()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:39:31.420

没有一种“闭包语法”：任何确保您构建函数表达式的语法，即编译器无法将函数表达式与函数定义的开头混淆的函数表达式，您称其为 OK。在这里，两者都有效。

例如，您可以使用

```
+function(){
  ...
}(); 
```

只需选择最易读且不那么令人惊讶的一个。我认为第一个，其中调用括号最明显，是最常用和预期的。

# fedora - 从更新源码到制作rpm包的流程

> ID：15819084
> 
> 赞同：1
> 
> 时间：2013-04-04T18:38:33.200
> 
> 标签：fedora, packaging, rpm

我是 RPM 包制作的新手，并且正在徘徊如何改进我用于创建包的工作流程。我用的一个我觉得很费力。（幸运的是我只做了一次;-)

1.  所以，我有一个应用程序目录，其中包含 python 源、配置文件、shell 脚本和一堆其他数据文件。foo_app/ /etc/stuff /bin/stuff /lib/python/foo/stuff /var/stuff
2.  我将 foo_app 目录复制到 foo_app-1.0.1

3.  我将其 tar 到 foo_app-1.0.0.tar.gz 并将其复制到 rpmbuild/SOURCES/

4.  然后我从 SPECS 目录开火： rpmbuild -ba foo_app.spec 就在那里。
5.  然后我在远程机器上安装并测试包，哎呀，有错误！
6.  我需要在本地机器上修复它，重新打包整个东西，然后在远程再次测试。

是否有一些工具可以自动化或更容易重复这些步骤？或者有没有办法避免执行第 2 步和第 3 步？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T07:04:40.207

我认为，我的主要建议是让应用程序能够在开发目录之外运行，这样您就不必为了尝试而在本地安装它。或者有一个“make install”目标，这样你就可以安装它（在 rpm 之外）进行测试。

但更具体地回答你的问题，这里有两个想法：

从源代码管理导出 .tar.gz 的脚本可能有助于 ( `git help archive`) 步骤 2-3。

如果 .tar.gz 中有 .spec 文件，则可以使用`rpmbuild -ta some.tar.gz`tar.gz 文件构建 rpm。

# c++ - 未解析的外部符号 - 如何修复？

> ID：15819095
> 
> 赞同：2
> 
> 时间：2013-04-04T18:39:06.180
> 
> 标签：c++, arrays

我对编程很陌生。我遇到了这个我无法弄清楚的错误。您应该能够输入分数，它将使用预先放入数组中的信息并告诉您有多少学生获得了该分数。

我得到的错误信息是：

```
1>------ Build started: Project: Ch11_27, Configuration: Debug Win32 ------
1>Build started 4/4/2013 1:17:26 PM.
1>InitializeBuildStatus:
1>  Touching "Debug\Ch11_27.unsuccessfulbuild".
1>ClCompile:
1>  main.cpp
1>main.obj : error LNK2019: unresolved external symbol "void __cdecl checkScore(int * const,int * const)" (?checkScore@@YAXQAH0@Z) referenced in function _main
1>F:\a School Stuff TJC Spring 2013\Intro Prog\C++ Projects\Ch11_27\Debug\Ch11_27.exe : fatal error LNK1120: 1 unresolved externals
1>
1>Build FAILED. 
```

这是我的代码：

```
//Advanced27.cpp - displays the number of students
//earning a specific score
//Created/revised by <your name> on <current date>

#include <iostream>
using namespace std;

//Function Prototypes
void checkScore( int scores[], int storage[]);

int main()
{
    //declare array
    int scores[20] = {90, 54, 23, 75, 67, 89, 99, 100, 34, 99, 
                      97, 76, 73, 72, 56, 73, 72, 20, 86, 99};
    int storage[4] = {0};
    char answer = ' ';

    cout << "Do you want to check a grade? (Y/N): ";
    cin >> answer;
    answer = toupper(answer);

    while (answer = 'Y')
    {
        checkScore(scores, storage);

    cout << "Do you want to check a grade? (Y/N): ";
    cin >> answer;
    answer = toupper(answer);

    }
    system("pause");
    return 0;
}   //end of main function

//*****Function Defenitions*****
void checkGrade(int scores[], int storage[])
{
    int temp = 0;
    int earnedScore = 0;

    cout << "Enter a grade you want to check: ";
    cin >> earnedScore;

    for (int sub = 0; sub <= 20; sub +=1)
    {
        if (scores[sub] = earnedScore)
        {
            storage[temp] += 1;

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T18:40:52.190

问题是您的函数定义与函数声明的名称不同：

```
void checkScore( int scores[], int storage[]);
void checkGrade(int scores[], int storage[]) 
```

你需要选择一个或另一个。编译器收到您的调用`checkScore`并看到它没有定义。更改要调用的定义`checkScore`将修复它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T18:41:31.003

您`checkGrade()`应该调用 main() 函数下方的函数`void checkScore( int scores[], int storage[])`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T18:42:38.340

这意味着您*声明*了要命名的函数，`checkScore`但您*定义*了要命名的函数`checkGrade`。然后当`main()`尝试调用`checkScore`编译器时说“好的，上面已经声明了。即使我找不到它，我也会允许它。它可能在不同的库或源文件中。”。然后链接器有责任找到它。由于链接器找到`checkGrade`但未找到`checkScore`，因此链接器会抛出错误，指出未定义的引用（`main()`引用`checkScore`而不是`checkGrade`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T18:41:30.663

看来您已经声明了您的功能

```
void checkScore( int scores[], int storage[]); 
```

但实际上并没有定义它（给它一个函数体）。定义你的功能

```
void checkScore( int scores[], int storage[]){

} 
```

使这个错误消失。

# html - 有没有办法让 iOS 播放器在 HTML 文档中播放，而不是全屏播放？

> ID：15819096
> 
> 赞同：0
> 
> 时间：2013-04-04T18:39:16.433
> 
> 标签：html, ios, video, mobile

我想在 iOS 设备的网站上制作一个播放器，但我不希望它全屏播放视频。我想要在网站内播放它的播放器，使其能够同时查看网站和视频。

女巫看起来像这样：

![这种播放器][1](https://i.stack.imgur.com/Wqjje.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:41:09.890

使用 html5`<video>`元素。

# html - 嵌入动态 swf 文件 - Html

> ID：15819097
> 
> 赞同：0
> 
> 时间：2013-04-04T18:39:17.750
> 
> 标签：html, flash, embed

我想通过 html 嵌入我的 swf 文件。这是我的代码的一部分。问题是文件在 100% 大小设置下显示得太小。我需要它适合浏览器的大小。我的错误在哪里？

```
<div align="center">
  <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" 
      codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0" width="100%" height="100%"
      align="center">

    <param name="allowScriptAccess" value="sameDomain" />
    <param name="movie" value="portfolio.swf" />
    <param name="quality" value="high" />
    <param name="bgcolor" value="#2D2D2D" />
    <param name="scale" value="showall">

    <embed src="portfolio.swf" width="100%" height="100%" align="center" 
       quality="high" scale="showall" bgcolor="#2D2D2D" 
       allowScriptAccess="sameDomain" type="application/x-shockwave-flash" 
       pluginspage="http://www.macromedia.com/go/getflashplayer" />
  </object>
  <!--<![endif]-->
</object>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:47:21.983

```
add to your <style> code
    html,body{margin:0px;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T18:42:15.057

安装：`width="100%"`

使用`style`标签：`style="width:100%;"`

# javascript - 为什么 Twitter 将字符串传递到它的脚本加载 JS 片段？

> ID：15819099
> 
> 赞同：4
> 
> 时间：2013-04-04T18:39:25.747
> 
> 标签：javascript, twitter

下面是用于将推文按钮添加到网页的 Twitter 脚本加载片段。

```
!function(d,s,id){
  var js, fjs = d.getElementsByTagName(s)[0];

  if (!d.getElementById(id)){ 
    js = d.createElement(s);
    js.id = id;
    js.src = "//platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);
  }
}(document,"script","twitter-wjs"); 
```

在最后一行，它们传递`"script"`给 IIFE 参数，而不是仅仅将其声明为变量。

这样做有什么好处？只是在代码长度上保存几个字符吗？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-04-04T18:46:11.993

如果他们在 IIFE 之外使用变量，它可能会干扰 10,000 人网页上 10,000 人的 javascript 中的变量。如果已经有一个同名的变量，它们包含在页面上可能会干扰它的工作方式，人们会说，“我试图使用 Twitter，但它破坏了我的网页。” 不管真假。

以他们的方式进行操作，尽可能减少对周围代码的影响。

**里面的变量**

如果他们将变量放在内部，那么记录必须添加到已经工作的网页的内容将更加困难。他们必须教一个新的 javascript 用户如何格式化字符串变量，并且新人必须在代码中的两个位置输入他们的信息。

这样，他们只需将除最后一行之外的所有行显示为“魔术”。他们说，“复制这些行”。

然后他们解释说你必须把两个东西的名字放在最后一行的引号中。它只是更容易解释。

诚然，这并不容易。但是更容易解释数以千计的人使用它可以增加他们的市场渗透率，可以这么说。

# javascript - 在 javascript 标签中使用 onclick 函数

> ID：15819100
> 
> 赞同：2
> 
> 时间：2013-04-04T18:39:28.477
> 
> 标签：javascript, html

我有一个函数 openWindow(word) 在单击按钮时被调用。此函数打开一个新窗口，打印单词并显示一个名为 do 的按钮。openWindow 函数一直工作，直到它的标签中的 onclick 应该找到 do 函数。我的问题是 onclick 似乎永远找不到我的 do 功能。我该怎么办？

我做的功能：

```
 function do() {
   alert("Life is what you make of it");
 } 
```

我的 openWindow 函数：

```
 function openWindow(word) {
      myWindow.document.write(word);
      myWindow.document.write('<body>'); 
      myWindow.document.write('<input type="button" value="Do" onclick="do()">');
      myWindow.document.write('</body>');
     }      
  } 
```

我打开窗口的html代码：

```
<body>
   <input type="button" value="Submit" onclick="openWindow()">
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:42:08.150

`do()`在新的弹出窗口中不存在。我建议使用这种方法：

```
myWindow.document.write('<body>'); 
myWindow.document.write('<input type="button" value="Do" onclick="do()">');
myWindow.document.write('</body>');

// Define "Do" in the context of the new window
// Note: I have changed "do" to "Do" because "do" is a reserved word in JS
myWindow.Do = Do; 
```

这是[一个工作小提琴](http://jsfiddle.net/cMF2f/1/)（确保没有阻止弹出窗口）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T18:41:38.507

该`do`函数不是您创建的新窗口的一部分，因此无法找到。

您需要通过链接的 JavaScript 文件或内联来包含它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T18:44:06.093

您的新窗口没有函数定义来知道调用“do()”时要做什么。

如果您只是想要一个带有按钮的警报：

```
myWindow.document.write('<input type="button" value="Do" onclick="alert('Life is what you make of it')"; 
```

否则，詹姆斯希尔还有路要走。

# ios - 如何更新 QLabelElement 的值？

> ID：15819102
> 
> 赞同：1
> 
> 时间：2013-04-04T18:39:30.963
> 
> 标签：ios, quickdialog

我已经初始化了一个 QLabelElement，然后想更新它的值。但是，在 QLabelElement 实例上显式设置 .value 属性不会更新其值。这是我正在尝试做的一个片段。onSelected 委托在按下 sayHello 按钮时执行，但标签元素没有更新：

```
@implementation 我的控制器
{
    QLabelElement *_theLabel;
}

- (id)初始化
{
    self = [超级初始化];
    QRootElement *root = [[QRootElement alloc] init];
    QSection *section = [[QSection alloc] init];
    _theLabel = [[QLabelElement alloc] initWithTitle:@"标签"值:@""];
    QSection *sectionButton = [[QSection alloc] init];
    QButtonElement *sayHello = [[QButtonElement alloc] initWithTitle:@"Say Hello"];

    [添加到根目录的部分和控件等]

    sayHello.onSelected = ^{
        _theLabel.value = @"你好已经说过"; //<-- 这不起作用
    };

    //设置 _theLabel.value = @"Hello has been said" 在这里有效，但在委托中无效

    self.root = 根；

    回归自我；
}

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T14:19:04.473

您需要在加载后重新加载该元素的单元格。另外，要小心保留循环，使用弱变量：

```
__weak QLabelElement *weakLabel = _theLabel;
sayHello.onSelected = ^{
    weakLabel.value = @"Hello has been said"; //<-- this isn't working
   [self.quickDialogTableView reloadCellForElements:weakLabel, nil];
}; 
```

QD 有一个分支可以自动解决这个问题，但它肯定还没有准备好使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T01:05:59.000

我不相信 onSelected 事件实现会重新加载屏幕上呈现的数据。有几种方法可以呈现更新：

1) 重新加载整个 UITableView

```
- (void)reloadData 
```

[Apple Doc - reloadData](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UITableView_Class/Reference/Reference.html#//apple_ref/occ/instm/UITableView/reloadData)

2）如果您知道索引路径，请重新加载数据

```
- (void)reloadRowsAtIndexPaths:(NSArray *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation 
```

[Apple Doc - reloadRowsAtIndexPaths！](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableView_Class/Reference/Reference.html)

# python - 使用 python 和 scikit-learn 的 DBSCAN：make_blobs 返回的整数标签到底是什么？

> ID：15819103
> 
> 赞同：9
> 
> 时间：2013-04-04T18:39:31.527
> 
> 标签：python, scikit-learn, dbscan

我正在尝试理解由 scikit ( [http://scikit-learn.org/0.13/auto_examples/cluster/plot_dbscan.html](http://scikit-learn.org/0.13/auto_examples/cluster/plot_dbscan.html) ) 实现的 DBSCAN 算法的示例。

我换了行

```
X, labels_true = make_blobs(n_samples=750, centers=centers, cluster_std=0.4) 
```

，`X = my_own_data`所以我可以将自己的数据用于 DBSCAN。

现在，`labels_true`作为第二个返回参数的变量`make_blobs`用于计算结果的一些值，如下所示：

```
print "Homogeneity: %0.3f" % metrics.homogeneity_score(labels_true, labels)
print "Completeness: %0.3f" % metrics.completeness_score(labels_true, labels)
print "V-measure: %0.3f" % metrics.v_measure_score(labels_true, labels)
print "Adjusted Rand Index: %0.3f" % \
    metrics.adjusted_rand_score(labels_true, labels)
print "Adjusted Mutual Information: %0.3f" % \
    metrics.adjusted_mutual_info_score(labels_true, labels)
print ("Silhouette Coefficient: %0.3f" %
       metrics.silhouette_score(D, labels, metric='precomputed')) 
```

如何`labels_true`从我的数据中计算`X`？在这种情况下，scikit 到底是什么意思`label`？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-04T18:45:01.517

`labels_true`是点到标签的“真实”分配：它们实际上应该属于哪个集群。这是可用的，因为[`make_blobs`](http://scikit-learn.org/dev/modules/generated/sklearn.datasets.make_blobs.html)知道它从哪个“blob”生成点。

你不能为你自己的任意数据得到它`X`，除非你有某种真正的点标签（在这种情况下你无论如何都不会进行聚类）。这只是显示了在您知道真实答案的假案例中聚类执行情况的一些衡量标准。

# python - 在 Python 2.x 中每隔一段时间编写新文件

> ID：15819105
> 
> 赞同：0
> 
> 时间：2013-04-04T18:39:32.060
> 
> 标签：python, list, python-2.7, rsync

我目前有一个用 Python 2.7 编码的脚本，用于整理变量列表。此脚本在 Linux 操作系统上一天 24 小时在机器上运行。

我要做的是将这些列表中的数据移动到远程服务器。此数据传输将通过 3G 互联网连接进行，因此，我热衷于在本地写入数据，然后在连接可用时传输数据（由于覆盖范围差等...）

我的意图是，在代码运行开始时，捕获 POSIX 中的实际时间并创建一个新的 .txt 文件。然后，我将在开始时间后 30 分钟计算并将该值也添加到变量中。我打算让我的脚本检查它的连续循环以检查时间。如果它与 30 分钟的 POSIX 值匹配，我会将列表中的所有信息写入 .txt 文件，然后再创建一个全新的文本文件并一遍又一遍地重复此过程。然后，我将使用 RSync 将 .txt 文件同步到中央服务器。

这是完成此过程的有效方法吗？如前所述，我将通过移动互联网 (3G) 将数据同步到远程服务器，因此覆盖范围可能很差。因此，我发现在同步文件之前在本地写入数据更简单。

我决定每 30 分钟创建一次文件，这样，如果脚本失败或断电，最多只会丢失 30 分钟的数据，而不是数小时的数据。

我想对我的思考过程有任何反馈。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:02:21.580

您的设计确实没有效率问题。

你有一个持续的循环，大概是在做一些重要的工作。与您正在执行的任何操作相比，每次通过循环添加获取当前时间并进行一次浮点比较的成本将非常便宜，因此没有任何区别。

如果您在循环中大部分时间*没有*做任何重要的工作，那么循环本身可能是您的主要性能成本，您最好少运行它。

但是，打开文件很奇怪，让它空着 30 分钟，然后一次写入/关闭/上传。更好的解决方案是在您编写它之前创建它。或者，更好的是，边写边写（而不是维护列表），可能每隔几秒刷新一次，然后每 30 分钟关闭/上传/替换。

同时，如果 Python 代码每 30 分钟尝试执行一次操作，而您的 cron 工作也是如此，那么它们显然会不同步。由于您预计由于 3G 问题，它可能会出现数小时不同步，因此这可能不是问题。

最后，您所做的非常接近 syslog 样式的日志记录和日志轮换。即使它在技术上不是通常意义上的日志文件，仍然值得看看 linux[`syslog`](http://linux.die.net/man/3/syslog)和[`logrotate`](http://linux.die.net/man/8/logrotate)/或 Python [`logging`](http://docs.python.org/2/library/logging.html)（特别是类似[`TimedRotatingFileHandler`](http://docs.python.org/2/library/logging.handlers.html#timedrotatingfilehandler)或其他处理程序之一）可以为您做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:11:51.613

这就是我会尝试做的。

我会不断地将数据写入输出文件，每 N 条记录刷新一次。如果您只能损失 1 秒的数据，为什么还要损失 30 分钟的数据呢？

一旦文件达到一定大小，或者超过 30 分钟，我会关闭文件并将其移动到`outbound/`目录中。然后我会创建一个新文件作为输出文件。

一个单独的脚本将控制上传。一个粗略的例子：

```
inotifywait -q -m -e create /path/to/outbound | while read fpath cmd fname; do 
  fullpath=$f{fpath}/${fname}
  rsync $f{fullpath} remotehost && rm ${fullpath}
done 
```

这将侦听出站目录中的创建事件，因此一旦您的脚本将文件移到那里，`rsync`就会启动。您也可以考虑`rsync --remove-source-files`从 cron 连续运行。

# java - 如何从 Object 类的数组中提取光标和整数值？

> ID：15819106
> 
> 赞同：3
> 
> 时间：2013-04-04T18:39:36.213
> 
> 标签：java, android, sqlite

我有一个返回对象数组的方法（Java 中所有类的父类）。如您所见`objArray[0] is a int;`，数组包含两种类型的数据`objArray[1] is a cursor;`

```
public Object[] search_record(String rollNo) {

    Object[] objArray = new Object[2];

    SQLiteDatabase db = this.getWritableDatabase();

    Cursor cur = db.rawQuery("SELECT * FROM " + TABLE_NAME
            + " where roll_no = ?", new String[] { rollNo });
    int count = cur.getCount();

    objArray[0] = count;
    objArray[1] = cur;

    Log.i("Records count", count + "");

    return objArray;

} 
```

现在我无法将这些值提取回原始值`i.e int and cursor`。我得到这样的数组。

```
Object[] objArray = dbHelper.search_record("08cs18");
int x = ((Integer) objArray[1]).intValue();
Cursor cursor = (Cursor) objArray[0]; 
```

但应用程序崩溃`classCastException`

我认为从技术上讲这是可能的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T18:42:18.417

对我来说看起来很简单。看你的说法：

> objArray[0] 是一个整数；并且 objArray[1] 是一个游标；

然后是代码：

```
Object[] objArray = dbHelper.search_record("08cs18");
int x = ((Integer) objArray[1]).intValue();
Cursor cursor = (Cursor) objArray[0]; 
```

您以错误的方式对待它们- as of`objArray[1]`是整数，并且`objArray[0]`是光标。只需切换索引。

**或者**，最好......创建自己的类来封装“游标和计数”：

```
public final class CursorAndCount {
    private final int count;
    private final Cursor cursor;

    public CursorAndCount(int count, Cursor cursor) {
        this.count = count;
        this.cursor = cursor;
    }

    public int getCount() {
        return count;
    }

    public int getCursor() {
        return cursor;
    }
} 
```

然后您可以更改`search_record`（应该调用`searchRecord`）以返回`CursorAndCount`- 并且调用代码将立即更具可读性。

请注意，既然您仍然从光标中获取计数，为什么不直接返回光标呢？调用者当然可以使用`Cursor.getCount()`自己，不是吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T18:42:08.193

您正在混合索引，光标​​在 position`1`并且 int 在 position `0`。试试这个：

```
int x = ((Integer) objArray[0]).intValue();
Cursor cursor = (Cursor) objArray[1]; 
```

你看，这*正是*使使用具有混合数据类型的对象数组成为一个坏主意的问题。您最好创建一个具有您想要返回的属性的新类（“传输对象”），并返回该类的一个实例。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-04T18:43:53.940

您正在以其他方式使用索引。0 表示 int，1 表示光标。

# javascript - 本机 Javascript 类 printf 函数

> ID：15819115
> 
> 赞同：7
> 
> 时间：2013-04-04T18:40:08.477
> 
> 标签：javascript, console, string-formatting

Chrome 和 Firefox 等浏览器提供了一个`console`API，可以发送格式化的日志消息，如下所示：

```
>>> console.log("%s has %d points", "Sam", "100");
Sam has 100 points 
```

现在，假设我想生成一个格式化的字符串，但不一定要将它记录到控制台中。浏览器是否公开了生成日志字符串的本机函数？它是 ECMA 标准吗？还是我们现在应该满足于第三方库，例如[JavaScript sprintf](http://www.diveintojavascript.com/projects/javascript-sprintf)？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T18:44:52.753

ES6 会以如下形式引入一些基本的字符串格式化：

```
`${name} has ${val} points`; 
```

但目前 ES5 中没有原生字符串格式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-08-17T19:45:59.033

```
Object.defineProperty(String.prototype, "printf",
        {
            value: function()
                {
                    var args = Array.from(arguments), i = 0;
                    function defaultNumber(iValue)
                    {
                        return ((iValue != undefined) && !isNaN(iValue) ? iValue: "0");
                    }
                    function defaultString(iValue)
                    {
                        return (iValue == undefined? "": "" + iValue);
                    }
                    return this.replace(/%%|%([+\-])?([^1-9])?(\d+)?(\.\d+)?([deEfhHioQqs])/g,
                        function (match, sign, filler, scale, precision, type)
                            {
                                var strOut, space, value;
                                var asNumber = false;
                                if (match == "%%")
                                    return "%";
                                if (i >= args.length)
                                    return match;
                                value = args[i];
                                while (Array.isArray(value))
                                {
                                    args.splice(i, 1);
                                    for (var j = i; value.length > 0; j++)
                                        args.splice(j, 0, value.shift());
                                    value = args[i];
                                }
                                i++;
                                if (filler == undefined)
                                    filler = " "; // default
                                if ((scale == undefined) && !isNaN(filler))
                                {
                                    scale = filler;
                                    filler = " ";
                                }
                                if (sign == undefined) sign = ("sqQ".indexOf(type) >= 0? "+": "-"); // default
                                if (scale == undefined) scale = 0; // default
                                if (precision == undefined) precision = ".0"; // default
                                scale = parseInt(scale);
                                precision = parseInt(precision.substr(1));
                                switch (type)
                                {
                                    case 'd':
                                    case 'i':
                                        // decimal integer
                                        asNumber = true;
                                        strOut = parseInt(defaultNumber(value));
                                        if (precision > 0)
                                            strOut += "." + "0".repeat(precision);
                                        break;
                                    case 'e':
                                    case 'E':
                                        // float in exponential notation
                                        asNumber = true;
                                        strOut = parseFloat(defaultNumber(value));
                                        if (precision == 0)
                                            strOut = strOut.toExponential();
                                        else
                                            strOut = strOut.toExponential(precision);
                                        if (type == 'E')
                                            strOut = strOut.replace('e', 'E');
                                        break;
                                    case 'f':
                                        // decimal float
                                        asNumber = true;
                                        strOut = parseFloat(defaultNumber(value));
                                        if (precision != 0)
                                            strOut = strOut.toFixed(precision);
                                        break;
                                    case 'o':
                                    case 'h':
                                    case 'H':
                                        // Octal or Hexagesimal integer notation
                                        strOut = '\\' + (type == 'o'? '0': type) +
                                            parseInt(defaultNumber(value)).toString((type == 'o'? 8: 16));
                                        break;
                                    case'q':
                                        // single quoted string
                                        strOut = "'" + defaultString(value) + "'";
                                        break;
                                    case'Q':
                                        // double quoted string
                                        strOut = '"' + defaultString(value) + '"';
                                        break;
                                    default:
                                        // string
                                        strOut = defaultString(value);
                                        break;
                                }
                                if (typeof strOut != "string")
                                    strOut = ("" + strOut);
                                if ((space = strOut.length) < scale)
                                {
                                    if (asNumber)
                                    {
                                        if (sign == "-")
                                        {
                                            if (strOut.indexOf('-') < 0)
                                                strOut = filler.repeat(scale - space) + strOut;
                                            else
                                                strOut = '-' + filler.repeat(scale - space) + strOut.replace("-","");
                                        }
                                        else
                                        {
                                            if (strOut.indexOf('-') < 0)
                                                strOut = '+' + filler.repeat(scale - space - 1) + strOut;
                                            else
                                                strOut = '-' + filler.repeat(scale - space) + strOut.replace("-","");
                                        }
                                    }
                                    else
                                    {
                                        if (sign == "-")
                                            strOut = filler.repeat(scale - space) + strOut;
                                        else
                                            strOut = strOut + filler.repeat(scale - space);
                                    }
                                }
                                else if (asNumber && (sign == '+') && (strOut.indexOf('-') < 0))
                                    strOut = '+' + strOut;
                                return strOut;
                            });
                }
        });

    Object.defineProperty(window, "printf",
        {
            value: function(str, ...rest)
            {
                if (typeof str == "string")
                    return String.prototype.printf.apply(str,rest);
                return "";
            }
        });
printf("Your Name is:%_30s your age is: %o\nyour wish is: %20q;", "Tom Johnson",48,"Lotto Numbers"); 
```

产量：

```
"Your Name is:Tom Johnson___________________ your age is: \\060
your wish is: 'Lotto Numbers'     ;" 
```

您也可以使用以下方式调用它：

```
"Your Name is:%_30s your age is: %o\nyour wish is: %20q;".printf("Tom Johnson",48,"Lotto Numbers"); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-04-04T18:48:31.890

我不认为你可以在本地做到这一点。您可以编写自己的 javascript toString 函数来处理不同的选项。

或者你可以做

```
var samuel = "sam";
var someNumber = 100;

var someString = samuel + " has " + someNumber + " points"; 
```

# android - Android - 在屏幕锁定时从通知启动活动会导致崩溃

> ID：15819116
> 
> 赞同：-1
> 
> 时间：2013-04-04T18:40:12.297
> 
> 标签：android, notifications, lockscreen

我的 LOGCAT 中没有错误

我的通知是从一个计时器启动的，然后会触发一个触发我的通知的广播接收器。这一切正常，当用户解锁屏幕然后按下通知时，它会正确启动活动。但是，当屏幕被锁定并且用户拉下通知栏并从那里启动活动时，它会导致应用程序崩溃而不是启动。

这是因为地图没有当前的后台堆栈或有效上下文吗？应该是因为当我首先解锁屏幕时它可以工作。

此外，我已经完成了一些基本测试并完全关闭了应用程序，然后关闭了屏幕并重新打开它，并在锁定时尝试了崩溃，然后我在屏幕解锁后也打开了应用程序，它运行完美。

那么....为什么在从锁屏启动通知意图时锁定屏幕会产生影响并导致应用程序崩溃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:15:48.070

这里没有太多内容，我会把它放在注释中（没有足够的点），但你需要启动调试器并在你“认为”代码失败的地方放置断点。你说没有 Logcat 消息，所以你应该确保你能捕捉到任何异常并打印堆栈跟踪。请记住，您不必仅在需要时使用 try/catch ......

还要确保您添加了健康剂量的自己的日志消息，以便您可以在应用程序运行时跟踪它的功能。

抱歉，我知道这不是答案，但是没有任何代码或堆栈跟踪，这很难:) 祝你好运！

# groovy - 时髦的。在使用 MarkupBuilder 和 XMLSlurper 时附加节点

> ID：15819119
> 
> 赞同：-1
> 
> 时间：2013-04-04T18:40:19.250
> 
> 标签：groovy, xmlslurper, markupbuilder

我的问题是 Groovy 并在使用 MarkupBuilder 和 XMLSlurper 时附加一个节点。

有人能告诉我为什么当我运行这段代码到第一个 println 时，我的输出将目标行显示为：

```
<target-line>0</target-line> 
```

但是当我将它运行到第二个 println 时，我的目标行输出现在是：

```
<target-line>
    <target-line>7</target-line>
</target-line>

// Complete code
import groovy.xml.*
public class AppendNodeExample {
    //Constructor
    public AppendNodeExample() {

    }

    def CreateNewMessage() {
def dataToProcess = '<response><applied-edits><line><id>0100</id>' +
                 '<flag><mnemonic>TRA</mnemonic><message>TRA Message ' +
                 'Info.</message></flag><flag><mnemonic>REB</mnemonic>' +
                 '<message>REB Message Info.</message><target-line>' +
                 '<target-line>7</target-line></target-line></flag><flag>'+
                 '<mnemonic>UNB</mnemonic><message>UNB Message Info.</message>'+
                 '</flag></line></applied-edits></response>'
def rootNode = new XmlSlurper().parseText(dataToProcess.replaceAll(':','-') )

def newXmlFile = new StringWriter()
def xmlCladNew = new groovy.xml.MarkupBuilder(newXmlFile)

xmlCladNew.response() 
{

    'applied-edits'()
    {

        rootNode.'applied-edits'.line.each
        { appliedEditsLine ->

            line 
            {
                id(appliedEditsLine.id)

                appliedEditsLine.flag.each
                { nodeLineFlag ->
                    flag 
                    {
                    mnemonic(nodeLineFlag.mnemonic)
                    message(nodeLineFlag.message)
                        'target-line'('0')
                    }
                }
            } 
        }
    }
}

def rootNodeNew = new XmlSlurper().parseText(newXmlFile.toString())
// First println
          println XmlUtil.serialize(rootNodeNew)

rootNodeNew.'applied-edits'.line.each 
{ line -> 

    line.flag.each
    { lineFlag ->
        if (lineFlag.mnemonic == 'REB') {

            lineFlag.appendNode({'target-line'('7')})
        } else {
            // Remove the target-line node
            lineFlag.'target-line'.replaceNode {}

        }
    }
}

XmlUtil.serialize(new StreamingMarkupBuilder().bind {mkp.yield rootNodeNew} )
          // Second println
println XmlUtil.serialize(rootNode)

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T08:31:40.733

重新格式化您的代码，使其易于阅读并遵循任何类型的准则，这样可以更轻松地查看问题所在：

```
import groovy.xml.*

public class AppendNodeExample {

    //Constructor
    public AppendNodeExample() {
    }

    def createNewMessage() {
        def dataToProcess = '''<response>
                              |  <applied-edits>
                              |    <line>
                              |      <id>0100</id>
                              |      <flag>
                              |        <mnemonic>TRA</mnemonic>
                              |        <message>TRA Message Info.</message>
                              |      </flag>
                              |      <flag>
                              |        <mnemonic>REB</mnemonic>
                              |        <message>REB Message Info.</message>
                              |        <target-line>
                              |          <target-line>7</target-line>
                              |        </target-line>
                              |      </flag>
                              |      <flag>
                              |        <mnemonic>UNB</mnemonic>
                              |        <message>UNB Message Info.</message>
                              |      </flag>
                              |    </line>
                              |  </applied-edits>
                              |</response>'''.stripMargin()

        def rootNode = new XmlSlurper().parseText( dataToProcess )

        def newXmlFile = new StringWriter()
        def xmlCladNew = new groovy.xml.MarkupBuilder( newXmlFile )

        xmlCladNew.response {
            'applied-edits' {
                rootNode.'applied-edits'.line.each { appliedEditsLine ->
                    line {
                        id( appliedEditsLine.id )
                        appliedEditsLine.flag.each { nodeLineFlag ->
                            flag {
                                mnemonic( nodeLineFlag.mnemonic )
                                message( nodeLineFlag.message )
                                'target-line'( '0' )
                            }
                        }
                    } 
                }
            }
        }

        def rootNodeNew = new XmlSlurper().parseText( newXmlFile.toString() )
        // First println
        println XmlUtil.serialize( rootNodeNew )

        rootNodeNew.'applied-edits'.line.each { line -> 
            line.flag.each { lineFlag ->
                if( lineFlag.mnemonic == 'REB' ) {
                    lineFlag.appendNode { 'target-line'( '7' ) } 
                } else {
                    // Remove the target-line node
                    lineFlag.'target-line'.replaceNode {}

                }
            }
        }

        XmlUtil.serialize(new StreamingMarkupBuilder().bind {mkp.yield rootNodeNew} )
        // Second println
        println XmlUtil.serialize( rootNode )
    }
}

new AppendNodeExample().createNewMessage() 
```

在第二个 println 中，您将打印出`rootNode`您没有做任何事情的原件，因此它只包含原始`<target-line>7</target-line>`节点。

# java - 保存清单选择

> ID：15819120
> 
> 赞同：2
> 
> 时间：2013-04-04T18:40:25.780
> 
> 标签：java, arraylist, save, jcheckbox

我无法弄清楚如何执行以下操作。我试图让用户使用我的清单检查他想要的书籍，但我无法弄清楚如何保存他的选择（检查的书籍）以确定他必须支付的价格。这是我的清单代码：

```
for(int k=0;k<catalogue.getCatalogue().size();k++)
    {
        frame.add(new JCheckBox(catalogue.cat.get(k).toString()));
    }

    frame.setLayout(new FlowLayout());
    frame.setSize(900,900);
    frame.setVisible(true);
    frame.addWindowListener(new WindowAdapter(){ public void windowClosing(WindowEvent e){System.exit(0);}}); 
```

它只显示书籍列表（目录是一个包含书籍的 Arraylist，我从文件中读取），旁边有一个复选框。我需要帮助来弄清楚如何“保存”他的选择，以便我可以将它存储在另一个书籍数组列表中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T18:46:06.993

```
JCheckBox[] checkboxArray = new JCheckBox[catalogue.getCatalogue().size()];

for(int k=0;k<catalogue.getCatalogue().size();k++)
    {
        checkboxArray[k] = new JCheckBox(catalogue.cat.get(k).toString());
        frame.add(checkboxArray[k]);
    } 
```

//

```
you can also add a ItemListener to your checkboxs

  private class CheckBoxListener implements ItemListener
        {
            public void itemStateChanged(ItemEvent e)
            {
                if(e.getSource() == check1)
                {
                    if(check1.isSelected())
                    {
                                  //do something
                                }   
                }
            }
        }
  JCheckBox[] checkboxArray = new JCheckBox[catalogue.getCatalogue().size()];
  CheckBoxListener listener = new CheckBoxListener();

    for(int k=0;k<catalogue.getCatalogue().size();k++)
        {
            checkboxArray[k] = new JCheckBox(catalogue.cat.get(k).toString());
            checkboxArray[k].addItemListener(listener);
            frame.add(checkboxArray[k]);
        } 
```

//现在当一个盒子被选中时，一个 ItemEvent 将触发

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T18:48:23.983

您应该使用 JCheckLists 的 Array/ArrayList。例如：

```
JCheckBox[] checkboxes = new JCheckBox[catalogue.getCatalogue().size()]; 
```

进而：

```
for(int k=0;k<catalogue.getCatalogue().size();k++)
{
    checkboxes[k] = new JCheckBox(catalogue.cat.get(k).toString()));
    frame.add(checkboxes[k]);
} 
```

现在您可以轻松检查每个复选框的状态，例如，您可以通过 checkboxes[0] 引用第一个复选框

# ember.js - 如何呈现引导警报

> ID：15819124
> 
> 赞同：2
> 
> 时间：2013-04-04T18:40:28.623
> 
> 标签：ember.js, handlebars.js

你将如何呈现 Twitter Bootstrap 警报？假设对于一个应用程序只有一个警报容器/闪存消息。

我希望它在出现错误时出现。现在我使用了一个非常肮脏的解决方案，为控制器添加了存在感。

```
Sks.KudoController = Ember.ObjectController.extend
  needs: ['currentUser']
  addKudo: (user) ->
    self = this
    token = $('meta[name="csrf-token"]').attr('content')
    ErrorMessageTmplt = """
      <div id="kudos-flash" class="alert" alert-error" style="display: none">
        <a class="close" data-dismiss="alert" href="#">&times;</a>
        <strong>oops! an error occured!</strong>
      </div>
    """
    $flashContainer = jQuery '#flash-container'

    jQuery.post("/kudos", user_id: user.get("id"), authenticity_token: token)
    .done((data, status) ->
      kudosLeft = self.get 'controllers.currentUser.kudosLeft'
      if kudosLeft > 0
        self.decrementProperty "controllers.currentUser.kudosLeft" 
      else 
        $flashContainer.empty()
        jQuery(ErrorMessageTmplt).appendTo($flashContainer).show()
    )
    .fail((data, status) ->
        $flashContainer.empty()
        jQuery(ErrorMessageTmplt).appendTo($flashContainer).show()
    ) 
```

我认为它应该在应用程序模板的某个地方呈现，但我不知道如何。也许警报应该是部分的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T04:03:28.357

您可以将警报 html 添加到应用程序模板中：

```
<div id="flash" class="alert alert-success">
    <button type="button" class="close" data-dismiss="alert">&times;</button>
    <span></span>
</div> 
```

[`text`](http://api.jquery.com/text/)然后对于每个动作，您可以调用 jQuery 并用 a或 an填充 span [`html`](http://api.jquery.com/html/)，如下所示：

```
App.ProductRemoveRoute = Em.Route.extend({
    setupController: function(controller, model) {
        var c = this.controllerFor('product');
        controller.set('content', c.get('content'));
    },
    events: {
        confirmRemove: function(record) {
            record.deleteRecord();

            // I know this looks no good, and definitely has 
            // room for improvement but gets the flash going
            $("#flash span").text("Product successfully removed.")
            .show().parent().fadeIn()
            .delay(2000).fadeOut('slow', function() { 
                $("#flash span").text('') 
            });

            this.transitionTo('products');
        }
    }
}); 
```

您可能希望将该 div 添加为隐藏元素，或者您可以使用 Ember 的 View[`didInsertElement`](http://emberjs.com/api/classes/Ember.View.html#event_didInsertElement)将其隐藏：

```
App.ApplicationView = Em.View.extend({
    didInsertElement: function() {
        this.$('#flash').hide();
    }
}); 
```

这是一个小提琴：

[http://jsfiddle.net/schawaska/aMGFC/](http://jsfiddle.net/schawaska/aMGFC/)（旧）

[http://jsfiddle.net/schawaska/FYvuD/](http://jsfiddle.net/schawaska/FYvuD/)（新）

在这个新示例中，我正在使用一个虚拟 mixin 来擦除通知文本，该文本现在位于一个属性中`ApplicationController`，并且通知 flash 是一个局部视图模板。

这显然不是唯一的方法，它更多的是一个实验/样本，可以做些什么来闪烁通知消息。同样，我确信这可以以更优雅和模块化的方式实现。希望能帮助到你。

# web-services - 为什么 Web 服务不能参与 Java EE 事务？

> ID：15819127
> 
> 赞同：1
> 
> 时间：2013-04-04T18:40:38.630
> 
> 标签：web-services, transactions, jta

我试图理解为什么 Web 服务不能像 db 操作那样成为 Java EE 事务的一部分。

即，如果我从 EJB 内部进行数据库更新和 Web 服务调用，则无法以原子方式将这两个步骤绑定在一起。

我阅读了这个链接：[http](http://www.ibm.com/developerworks/library/ws-transjta/) ://www.ibm.com/developerworks/library/ws-transjta/ ，我从这篇文章中得到的简化理解是：Web 服务是第三方产品，不一定是 Java EE。即，Web 服务不需要由 Java EE 服务器提供服务，因此 Java EE 事务不适用于它们。

那么这是否意味着如果 Web 服务由 Java EE 服务器提供服务，我们可以使用事务？

# coffeescript - 为什么 jasmine-node 在尝试使用咖啡 v1.6.2 要求规范文件时会抛出此错误？

> ID：15819129
> 
> 赞同：0
> 
> 时间：2013-04-04T18:40:42.067
> 
> 标签：coffeescript, jasmine, jasmine-node

这适用于咖啡 v1.4 和 v1.5，但最新版本现在让 jasmine 节点在我运行时抛出一个奇怪的错误：

茉莉花节点 --coffee --forceexit 规范/

```
/Users/aa/bitium/copernicus/node_modules/coffee-script/lib/coffee-script/helpers.js:211
    throw error;
          ^
SyntaxError: unexpected #
    at Object.exports.throwSyntaxError (/Users/aa/bitium/copernicus/node_modules/coffee-script/lib/coffee-script/helpers.js:209:13)
    at Object.parser.yy.parseError (/Users/aa/bitium/copernicus/node_modules/coffee-script/lib/coffee-script/coffee-script.js:245:20)
    at Object.parse (/Users/aa/bitium/copernicus/node_modules/coffee-script/lib/coffee-script/parser.js:535:22)
    at exports.compile.compile (/Users/aa/bitium/copernicus/node_modules/coffee-script/lib/coffee-script/coffee-script.js:36:25)
    at Object.loadFile (/Users/aa/bitium/copernicus/node_modules/coffee-script/lib/coffee-script/coffee-script.js:179:28)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.require (module.js:362:17)
    at require (module.js:378:17)
    at Object.jasmine.executeSpecsInFolder (/Users/aa/opensource/jasmine-node/lib/jasmine-node/index.js:136:7) 
```

然而，如果我只是跑

```
jasmine-node --coffee --forceexit spec/unit
or
jasmine-node --coffee --forceexit spec/integration 
```

它工作正常。它只是无法处理根级别的规范文件夹。Object.jasmine.executeSpecsInFolder 所做的只是 require(filename_of_a_spec) 不明白为什么这会是一个意外的 # 错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T15:50:16.750

问题是其中一个规范文件中的注释！

我在底部有一个###，并带有一些注释掉的测试，但是第一个 # 字符之前的空格存在空格问题。

# mysql - 使用 Hibernate 创建 MySQL 数据库

> ID：15819130
> 
> 赞同：0
> 
> 时间：2013-04-04T18:40:45.247
> 
> 标签：mysql, hibernate

我正在尝试以编程方式配置休眠并在 MySQL 中生成数据库模式和表。这是休眠配置

```
 configuration.setProperty(AvailableSettings.DIALECT, "org.hibernate.dialect.MySQL5Dialect")
            .setProperty(AvailableSettings.URL, "jdbc:mysql://localhost/ritm?autoReconnect=true&amp;characterEncoding=UTF-8&amp;useUnicode=true&amp;createDatabaseIfNotExist=true")
            .setProperty(AvailableSettings.USER, "root")
            .setProperty(AvailableSettings.PASS, "gjnjkjr")
            .setProperty(AvailableSettings.DRIVER, "com.mysql.jdbc.Driver")
            .setProperty(AvailableSettings.POOL_SIZE,"1"); 
```

当我用 maven 运行它时，我得到了以下警告

```
WARN: HHH000342: Could not obtain connection to query metadata : Could not create connection to database server. Attempted reconnect 3 times. Giving up. 
```

之后是例外

```
апр 04, 2013 10:31:53 PM org.hibernate.engine.jdbc.spi.SqlExceptionHelper logExceptions
WARN: SQL Error: 0, SQLState: 08001
апр 04, 2013 10:31:53 PM org.hibernate.engine.jdbc.spi.SqlExceptionHelper logExceptions
ERROR: Could not create connection to database server. Attempted reconnect 3 times. Giving up.
org.hibernate.exception.JDBCConnectionException: Could not open connection
    at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:67) 
```

任何人都可以描述这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T18:54:06.127

您是否尝试将端口号附加到 URL。我知道这似乎很愚蠢，但是，数据库通信依赖于端口号，而且我注意到您没有在 URL 中包含端口号。例如，如果您使用 MySQL，则端口号为 3306。因此 JDBC URL 如下所示：

```
AvailableSettings.URL, "jdbc:mysql://localhost:3306/ritm?autoReconnect=true&amp;characterEncoding=UTF-8&amp;useUnicode=true&amp;createDatabaseIfNotExist=true" 
```

# c++ - C ++：附加到向量字符串

> ID：15819136
> 
> 赞同：0
> 
> 时间：2013-04-04T18:41:02.283
> 
> 标签：c++, string, vector, append, strcpy

我正在写一个“猪拉丁”程序；读取用户的输入（名字和姓氏）使输入小写并根据名称中的内容更改名称。如果第一个字母（名字和姓氏）是元音，我们应该在它的末尾添加“方式”。

如果第一个字母是辅音，我们将取第一个字母，将它移到字符串的末尾并在其末尾添加“ay”。

尝试将文本添加到字符串末尾时，我的代码一直给我错误。它说它无法将字符串转换为字符，我不确定这意味着什么。它还说我不能将输出操作数 << 用于字符串，即使我以前使用过它。

错误发生在“strcpy”和我输出名称的最终代码中。

> 37：错误：无法转换`'std::vector<std::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::basic_string<char, std::char_traits<char>, std::allocator<char> > > >'`为`'char*'`参数`'1'``'char* strcpy(char*, const char*)'`
> 
> 47：错误：无法转换`'std::vector<std::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::basic_string<char, std::char_traits<char>, std::allocator<char> > > >'`为`'char*'`参数`'1'``'char* strcpy(char*, const char*)'`
> 
> `'operator<<'`54：错误： in不匹配`'std::cout << first'`

我只需要一些帮助来修复错误并查看我哪里出错了。包含完整的代码。

```
#include <iostream>
#include <vector>
#include <cstring>
#include <string>
using namespace std;
int main()
{
    int q, s;
    char shea[] = "way";
    char gavin_stop_looking_at_ponies[] = "ay";
    vector <string> first;
    vector <string> last;
    cout << "Please enter your first name." << endl;
    for (int i = 0; i < first.size(); i++)
    {
        getline (cin, first[i]);
        string nfirst = first[i];
        while (nfirst[q])
        {
            nfirst[q] = tolower(nfirst[q]);
        }
        first[i] = nfirst;
    }
    cout << "Please enter your last name." << endl;
    for (int j = 0; j < last.size(); j++)
    {
        getline (cin, last[j]);
        string nlast = last[j];
        while (nlast[s])
        {
            nlast[s] = tolower(nlast[s]);
        }
        last[j] = nlast;
        }
    if ( (first[0] == "a") ||( first [0] == "e") || (first [0] == "i") || (first [0] == "o")     || (first [0] == "u"))
    {
        strcpy (first, "way");
    }
    else
    {
        first[first.size()] = first[0] + "ay";
    }

    if ( (last[0] == "a") ||( last [0] == "e") || (last [0] == "i") || (last [0] == "o") || (last [0] == "u"))
    {
        strcpy (last, "way");
    }
    else
    {
        last[last.size()] = last[0] + "ay";
    }
    cout << first << last << endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T19:51:47.597

我已经用一些问题的解释和解决方案的建议来注释你的代码。如果有什么不明白的，请评论，我会尽力澄清。

```
#include <iostream>

// You don't need 'vector' for this.
~~#include <vector>~~

// You won’t often need the C string header in C++.
~~#include <cstring>~~

#include <string>
using namespace std;
int main()
{
    // These variables are unused.
 ~~int q, s;
    char shea[] = "way";
    char gavin_stop_looking_at_ponies[] = "ay";~~

    // 'first' and 'last' are both names, not collections
    // of names.
    **string first;**
    **string last;**
    ~~vector <string> first;~~
    ~~vector <string> last;~~

    // 'endl' is unnecessary here; it outputs a newline and
    // flushes the stream, but standard output is usually
    // line-buffered, meaning that newline flushes the
    // stream regardless.
    **cout << "Please enter your first name.\n"**
    ~~cout << "Please enter your first name." << endl;~~

    // If you just want to get one name, 'getline' is perfect.
    **getline(cin, first);**

    // This loop would run 0 times because 'first' is an
    // empty vector.
 ~~for (int i = 0; i < first.size(); i++)
    {
        getline (cin, first[i]);
        string nfirst = first[i];
        while (nfirst[q])
        {
            nfirst[q] = tolower(nfirst[q]);
        }
        first[i] = nfirst;
    }~~

    // To make a string lowercase, use 'tolower' on each character.
    // Here's one way to do it:
    **for (string::size_type i = 0; i < first.size(); ++i)
        first[i] = tolower(first[i]);**

    // Here's another, with C++11 enabled:
    **for (auto& c : first)
        c = tolower(c);**

    **cout << "Please enter your last name.\n";**
    ~~cout << "Please enter your last name." << endl;~~

    // Same thing.
    **getline(cin, last);**
 ~~for (int j = 0; j < last.size(); j++)
    {
        getline (cin, last[j]);
        string nlast = last[j];
        while (nlast[s])
        {
            nlast[s] = tolower(nlast[s]);
        }
        last[j] = nlast;
    }~~

    // Now 'first' is a string, and 'first[0]' is a 'char'.
    // "a" is a string literal; 'a' is a character literal.
    // You can compare each character individually:
 **if (first[0] == 'a' || first[0] == 'e' || first[0] == 'i' || first[0] == 'o' || first[0] == 'u')**

    // Or you can say "if the character was found in this
    // set of vowels".
 **if (string("aeiou").find(first[0]) != string::npos)**

 ~~if ( (first[0] == "a") ||( first [0] == "e") || (first [0] == "i") || (first [0] == "o")     || (first [0] == "u"))~~
    {
        // This would try to copy "way" into 'first':
        // formerly a vector of string objects, now just a
        // string object. 'strcpy' wants a character buffer,
        // and will *overwrite* characters in that buffer—
        // probably not what you want:
        //
        // "aaron" => "wayon"
        // 
        ~~strcpy (first, "way");~~

        // Instead, just append "way":
        **first += "way";**
    }
    else
    {
        // This says "take the first first character of the
        // string, add the value of that character to a
        // pointer to a buffer containing "ay", then try to
        // copy the resulting pointer past the end of the
        // string. Again, not quite what you intended!
        ~~first[first.size()] = first[0] + "ay";~~

        // Think of it instead like this: take everything
        // after the first character, add a string consisting
        // of the first character back onto the end, then add
        // "ay" after that.
        **first = first.substr(1) + string(1, first[0]) + "ay";**
    }

    // Duplicated code! You could move the above logic into
    // a function to avoid this duplication. Then you only
    // have to work on it in one place. :)
 ~~if ( (last[0] == "a") ||( last [0] == "e") || (last [0] == "i") || (last [0] == "o") || (last [0] == "u"))
    {
        strcpy (last, "way");
    }
    else
    {
        last[last.size()] = last[0] + "ay";
    }~~

    // I need a space between my first and last names!
    **cout << first << ' ' << last << '\n';**
    ~~cout << first << last << endl;~~
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:30:24.967

`first`是一个`vector<string>`，不是一个`string`。 `vector`不`<<`支持`cout`. 如果要输出`std::string`中的每个字符`std::vector`，请尝试遍历`std::vector`并一次输出一个字符。

同样，`first`is a`vector<string>`不能隐式转换为 a `char*`。 对远离 `strcpy`的原始`char`数据块进行操作。用于字符串缓冲区上的 C 级操作（即使这样，使用起来也很危险）。`first``strcpy`

`first[first.size()] = first[0] + "ay";`是未定义的行为，因为您正在访问 的最后一个元素`first`，这是无效的内存。如果你想把东西推到后面`first`，试试看`first.push_back( first[0] + "ay" );`。

`std::string`很可能您对, a`char`和 a之间的区别感到困惑`char*`。这些是完全不同的事情。 `std::string`是 的托管缓冲区`char`。 `char`是一个 8 位的值，通常用于存储诸如`'a'`（类型为`char`）之类的文字。 `char*`是指向单个 的指针`char`，通常用作指向`char`紧密打包的非托管缓冲区的开始的指针。

您`std::vector<std::string>`是托管缓冲区的托管`char`缓冲区。中的每个元素`vector`都是一个完整的缓冲区，其中包含一些未知数量的`char`s，而不是单个`char`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T15:07:45.710

我同意之前的一些响应者，但我不想进行详细的代码审查，因为它会很大并且可能会错过重点。我认为您遇到的问题是对正确使用 C++ 标准库的根本性误解的症状。大多数情况下，您将标准 C 库字符串实现与 C++“字符串”对象混合。在 C 中，有一个函数集合接受字符指针并将它们作为字符串进行操作，而在 C++ 中有一个字符串对象，它封装了一个字符串并提供了一个对其进行操作的集合。在某些情况下，可以在 C char * 通常存在的地方使用 C++ 字符串，但在大多数情况下不能。

即使在 C++ STL（标准模板库）中，你也会把事情搞混了。根据您的代码，您似乎想要检索用户的名字和姓氏，即 2 个单独的字符串。但是，您要声明 2个字符串*集合*（在本例中为向量），而不仅仅是两个单独的字符串本身。程序中的许多其他问题也随之而来。

我想你可能会喜欢这里的信息：http: [//en.cppreference.com/w/](http://en.cppreference.com/w/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-09T12:29:29.370

我快速尝试编写代码只是为了稍微玩一下。这是我想出的——我认为它非常简单、干净且易于理解：

```
#include <iostream>
#include <string>
#include <algorithm>
using namespace std;

/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
/* simple pig-latin program ... converts a given "first name" and "last name"*/
/* from the user to pig latin translations.  Obviously, the so-called names  */
/* are really just any 2 random words, but that's the theme anyway.          */
/*                                                                           */
/*                                                                           */
/*                                                                           */
/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */

string xlat_to_piglatin(const string source)
{
    string result;

    //
    // translation: if word begins with a vowel, simply append "way" to
    //  it.  Otherwise, move the initial consonant from the beginning to
    //  the end, and append "ay" to it.
    //
    if (source.find_first_of("aeiou") == 0) {
        result = source;
        result.append("way");
    } else {
        result = source.substr(1, source.size());
        result.append(source.substr(0, 1));
        result.append("ay");
    }
    return result;
}

int main()
{
    string  first;
    string  last;

    //
    // get the first and last names from the user on standard in ...
    //
    cout << "Please enter your first name:" << endl;
    cin >> first;
    cout << "Please enter your last name:" << endl;
    cin >> last;

    //
    // convert strings to lower case ...
    //
    transform(first.begin(), first.end(), first.begin(), ptr_fun<int, int>(tolower));
    transform(last.begin(), last.end(), last.begin(), ptr_fun<int, int>(tolower));

    cout << xlat_to_piglatin(first) << " " << xlat_to_piglatin(last) << endl;
    return 0;
} 
```

# jsf - 动态添加和删除面板 PrimeFaces

> ID：15819137
> 
> 赞同：1
> 
> 时间：2013-04-04T18:41:02.640
> 
> 标签：jsf, user-interface, primefaces

您将如何在 primefaces 中动态添加面板？

目标是有一个按钮来添加面板。使用以下代码中的 closeable 选项可以轻松删除面板：

```
<p:panel id="panel1" header="Panel 1" style="width : 150px;" toggleable="true" closable="true" toggleSpeed="500" closeSpeed="500"> Move and Resize ME!</p:panel> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-05T16:20:13.580

假设您有一个 panelgrid 来保存面板，一个简单的 jsf 片段将是

```
<p:panelGrid id="myPanelGrid" columns="1">
</p:panelGrid>

<h:form>
    <p:commandButton value="Add Panel" actionListener="#{bean.addPanel}" update=":myPanelGrid" />
</h:form> 
```

在您的支持 bean 中，动态添加面板所需的 addPanel 方法

```
public void addPanel(ActionEvent event) {
    UIComponent component = FacesContext.getCurrentInstance().getViewRoot().findComponent("myPanelGrid");
    if (component != null) {
        Panel p = new Panel();
        p.setClosable(true);
        p.setHeader("Test");
        p.setVisible(true);
        component.getChildren().add(p);
    }
} 
```

此方法将通过其 id 找到您的持有人 panelgrid 组件，添加一个新的 org.primefaces.component.panel.Panel 并设置一些字段并将其添加到父组件。

commandButton 的 update=":myPanelGrid" 属性将通知 panelGrid 使用新数据更新自身。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:07:02.393

简单地说，我会以这种方式将我的属性嵌套`<p:panel`在`<h:panelGroup`一个`rendered`属性中：

```
<h:panelGroup id="myPanelGroup">
    <p:panel rendered="#{myBean.renderPanel}">
        <span>Content</span>
    </p:panel>
</h:panelGroup>
<p:commandButton action="#{myBean.showPanel()}" update="myPanelGroup"
    value="Show Panel" />
<p:commandButton action="#{myBean.hidePanel()}" update="myPanelGroup"
    value="Hide Panel" /> 
```

豆子：

```
@ManagedBean
@ViewScoped
public class MyBean {

    private boolean renderPanel;

    public void showPanel() {
        this.renderPanel = true;
    }

    public void hidePanel() {
        this.renderPanel = false;
    }

    // Getter for renderPanel
} 
```

**注意**`@ViewScoped`：根据您的需要避免在此处使用会更好，您可以绑定`renderPanel`在表单中（例如复选框）

# web-services - Flex WebService POST 将 https 更改为 http

> ID：15819143
> 
> 赞同：0
> 
> 时间：2013-04-04T18:41:23.030
> 
> 标签：web-services, apache-flex, https, wsdl, crossdomain.xml

我有一个需要连接到 https 网络服务的 Flex 应用程序。Web 服务 WSDL URL 以 wsdl-url.company.com 的形式给出，其中使用了 SSL 卸载。

Flex 应用程序与 Web 服务位于同一台服务器上。

在 mxml 中定义的 Web 服务为

```
<s:WebService id="webService" wsdl="https://wsdl-url.company.com/service.asmx?wsdl"> 
```

服务器根目录下的 crossdomain.xml 文件是

```
<?xml version="1.0"?> 
<!DOCTYPE cross-domain-policy SYSTEM /xml/dtds/cross-domain-policy.dtd> 
<cross-domain-policy> 
<site-control permitted-cross-domain-policies="all"/> 
<allow-access-from domain="*" to-ports="*" /> 
<allow-http-request-headers-from domain="*" headers="*"/> 
</cross-domain-policy> 
```

如果 swf 是从 HTTPS 地址加载的，则当页面加载（Web 服务初始化）时，swf 不会请求 crossdomain.xml，但是当调用 Web 服务时，会尝试对 http 等效而不是 https。

即使用 Firebug，我看到 Flex 正在执行 POST，这应该是 HTTPS。为什么 Flex 在声明为 https 时将其更改为 http？

另一方面，如果在同一台服务器上从 HTTP 加载 swf，则会下载 crossdomain.xml，但 Flash 调试器会抛出“Channel.Security.Error”，并且在 Web 服务尝试初始化时应用程序崩溃。

非常感谢解决此问题的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T14:27:34.407

**找到解决方案**

对于任何有相同问题的人，问题出在项目的 .fml 中的 WSDL 端点。尽管我在 WebService 声明中将服务设置为 https://，但 Flash Builder 默认将 WSDL-endpoint 生成为 http。在加载应用程序时以编程方式将端点正确设置为 https 就可以了：

```
webService.endpointURI = "https://wsdl-url.company.com/service.asmx"; 
```

# html - CSS3 关键帧动画 - 类

> ID：15819144
> 
> 赞同：6
> 
> 时间：2013-04-04T18:41:23.117
> 
> 标签：html, css, keyframe

我正在尝试使用 CSS3 关键帧动画，将鼠标悬停在一个对象上时，会导致动画在另一个对象上触发。现在我只有一个简单的关键帧：

```
 @keyframes fill
  {
    from   {background: red; height: 0px; width: 0px;;}
    to {background: green; height: 150px; width: 150px;}
  }

  @-moz-keyframes fill /* Firefox */
  {
    from   {background: red; height: 0px; width: 0px;}
    to {background: green; height: 150px; width: 150px;}
  }

  @-webkit-keyframes fill /* Safari and Chrome */
  {
    from   {background: red; height:0px; width:0px;}
    to {background: green; height: 150px; width: 150px;}
  } 
```

html如下：

```
<div class="box1">
    <div class="box2"></div>
</div> 
```

如果我的样式表将动画属性应用于 .box1，它实际上可以为 .box2 设置动画吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:10:31.980

从您的问题来看，您似乎在问，如果有人将鼠标悬停在 box1 上，它可以为 box 2 设置动画吗？确定的事情：

```
.box1:hover .box2{
    -moz-animation:spin .5s infinite linear;
}

@-moz-keyframes spin {
   0% { -moz-transform:rotate(0deg); }
   100% { -moz-transform:rotate(360deg); }
} 
```

这里更详细：http: [//jsfiddle.net/bW53x/2/](http://jsfiddle.net/bW53x/2/)

注意 - jsfiddle 是为 Firefox 设置的。

# c# - 使用 MVC4 web api 创建一个全局用户认证系统

> ID：15819149
> 
> 赞同：0
> 
> 时间：2013-04-04T18:41:33.327
> 
> 标签：c#, asp.net-mvc, asp.net-web-api

我即将开始一个 ASP.NET 项目，该项目需要用户身份验证才能访问网站的某些部分。将有多个站点需要此身份验证系统，包括桌面应用程序。

我想知道，有没有办法使用 MVC4 Web API 创建一个全局身份验证系统？我的意思不是对用户进行身份验证以访问 API，而是允许用户检索身份验证令牌以通过 web-api 访问该站点。

抱歉，如果这看起来有点令人困惑，我仍在尝试找出最佳使用方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:07:38.243

看看 Thinktecture。他们创建了一个令牌提供者（带有一个客户端来展示如何使用它）。我想这就是你要找的。

[http://thinktecture.github.com/](http://thinktecture.github.com/)

# templates - 为什么这个函子的 operator() 需要尾随 const 修饰符？

> ID：15819151
> 
> 赞同：2
> 
> 时间：2013-04-04T18:41:36.757
> 
> 标签：templates, objective-c-blocks, objective-c++, functor, vmat

经过多年的缺席，我将回到 C++（或者从技术上讲，Objective-C++），所以请多多包涵。我正在尝试使用模板来实现一个解决方案，否则它需要大量的剪切和粘贴代码。下面的摘录显示了这项工作的基本要点：

```
namespace {

    using vMAT::DOUBLE;
    using vMAT::SINGLE;
    using vMAT::INT8;
    using vMAT::UINT8;
    using vMAT::INT16;
    using vMAT::UINT16;
    using vMAT::INT32;
    using vMAT::UINT32;
    using vMAT::INT64;
    using vMAT::UINT64;

    typedef void (* swapFn)(void * vector, vDSP_Length vectorLength);

    // Functor used for template arguments.
    template <typename TypeA>
    struct swapbytes {
        swapFn fn;

        swapbytes()
        {
            if      (sizeof(TypeA) == 8) fn = vMAT_byteswap64;
            else if (sizeof(TypeA) == 4) fn = vMAT_byteswap32;
            else if (sizeof(TypeA) == 2) fn = vMAT_byteswap16;
            else if (sizeof(TypeA) == 1) fn = NULL;
            else NSCAssert(NO, @"Oops!");
        }

        void operator()(void * vector, vDSP_Length vectorLength) const
        // ..................................................... ^^^^^ Why?
        {
            if (fn != NULL) fn(vector, vectorLength);
        }
    };

    template <typename TypeA, typename ClassB>
    void
    loadFromOperation(vMAT_MATv5NumericArray * self,
                      vMAT_MATv5ReadOperation * operation,
                      TypeA a,
                      ClassB b)
    {
        swapbytes<TypeA> SwapA;
        long lenC = self.size[0] * sizeof(TypeA);
        TypeA * C = (TypeA *)malloc(lenC);
        long lenD = vMAT_Size_prod(self.size) * sizeof(ClassB);
        self.arrayData = [NSMutableData dataWithCapacity:lenD];
        self.arrayData.length = lenD;
        ClassB * D = (ClassB *)[self.arrayData mutableBytes];
        __block long idxD = 0;
        vMAT_Size123Iterator(self.size, ^(int32_t n, int32_t o, int32_t p) {
            [operation readComplete:C
                             length:lenC];
            if (operation.swapBytes) { SwapA((void *)C, lenC / sizeof(TypeA)); }
            for (int m = 0;
                 m < self.size[0];
                 m++) {
                D[idxD] = C[m];
                ++idxD;
            }
        });
        free(C);
    }

}

- (void)_load_miUINT8_mxDOUBLE_fromOperation:(vMAT_MATv5ReadOperation *)operation;
{
    loadFromOperation(self, operation, UINT8, DOUBLE);
} 
```

我希望从以“为什么？”结尾的评论中可以看出我的问题是，为什么`const`这里需要声明？如果省略，编译器会抱怨`SwapA(...)`在`loadFromOperation`.

`SwapA`如果明确声明为，我会理解这一点`const`，但事实并非如此。显然它*可能*是，因为它的操作不依赖于改变任何状态，但这不是重点。

虽然我对这段代码有另一双有用的眼睛，但我欢迎更精通 C++ 实践者可能愿意提供的任何风格或其他评论……</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T22:18:03.737

由块捕获的非`__block`变量，在创建块时按值复制到块中，并且`const`位于块内。即在块内，`SwapA`具有类型`const swapbytes<TypeA>`.

# java - 在 JDBC 应用程序中前后移动 ResultSet 光标

> ID：15819153
> 
> 赞同：3
> 
> 时间：2013-04-04T18:41:42.797
> 
> 标签：java, jdbc

我正在开发一个库存库存系统软件，该软件使用 JDBC ODBC 连接连接到 Ms Sql 服务器。我想将结果集光标移动到下一行并向后移动。连接有效，程序可以从数据库中检索字段，因此没有问题。

我在这里的代码位于标有“下一步”的按钮上。*当您单击此按钮时，它应该移动到数据库中的下一行并从该行中检索数据。检索到的数据应显示在“文本字段”中。*问题是当我单击下一步时没有任何反应？

```
 private void NextBtnActionPerformed(java.awt.event.ActionEvent evt) {                                        
    try {
        Class.forName("sun.jdbc.odbc.JdbcOdbc");
        Connection con;
        con = DriverManager.getConnection("jdbc:odbc:StockInventory","sa","123");           

        Statement stmt = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_UPDATABLE);
        String query = "select * from Stocktbl";

        ResultSet rs; 
        rs = stmt.executeQuery(query); 

        if(!rs.isLast()) {
            rs.next();

            TxtStockid.setText(rs.getString("StockId"));
            TxtItem.setText(rs.getString("ItemName"));
            TxtQuantity.setText(rs.getString("Quantity"));
            TxtUnitprice.setText(rs.getString("UnitPrice"));
            TxtNetprice.setText(rs.getString("NetPrice"));
            TxtUnitweight.setText(rs.getString("UnitWeight"));
            TxtNetweight.setText(rs.getString("Netweight"));
            TxtDescription.setText(rs.getString("Description"));
        }

        rs.close();
        stmt.close();
        con.close();

    } 
    catch (SQLException ex) 
    {
        Logger.getLogger(StockScr.class.getName()).log(Level.SEVERE, null, ex);
    }
    catch (ClassNotFoundException ex) 
    {
        Logger.getLogger(StockScr.class.getName()).log(Level.SEVERE, null, ex);
    }       
} 
```

这是程序的其余代码，“下一步”按钮已添加到此面板。

```
public class StockScr extends javax.swing.JPanel {
ResultSet rs;
Connection con = null;

public StockScr() {
    initComponents();
    ShowTable();

}

void ShowTable(){
    try {
        Class.forName("sun.jdbc.odbc.JdbcOdbc");
        Connection con;
        con = DriverManager.getConnection("jdbc:odbc:StockInventory","sa","123");           

        Statement stmt = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
        String query = "select * from Stocktbl";           
        ResultSet rs; 
        rs = stmt.executeQuery(query);

        rs.first();
            TxtStockid.setText(rs.getString("StockId"));
            TxtItem.setText(rs.getString("ItemName"));
            TxtQuantity.setText(rs.getString("Quantity"));
            TxtUnitprice.setText(rs.getString("UnitPrice"));
            TxtNetprice.setText(rs.getString("NetPrice"));
            TxtUnitweight.setText(rs.getString("UnitWeight"));
            TxtNetweight.setText(rs.getString("Netweight"));
            TxtDescription.setText(rs.getString("Description"));

        rs.close();
        stmt.close();
        con.close();

    } 
    catch (SQLException ex) 
    {
        Logger.getLogger(StockScr.class.getName()).log(Level.SEVERE, null, ex);
    }
    catch (ClassNotFoundException ex) 
    {
        Logger.getLogger(StockScr.class.getName()).log(Level.SEVERE, null, ex);
    }        
}

public void fetchResultSet()
{

try {
    if(con==null || con.isClosed())
    {
      Class.forName("sun.jdbc.odbc.JdbcOdbc");
      con = DriverManager.getConnection("jdbc:odbc:StockInventory","sa","123");           
    }
    Statement stmt =     con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
    String query = "select * from Stocktbl";
    rs = stmt.executeQuery(query); 
  }catch(Exception ex){
     System.out.println(ex);
     Logger.getLogger(StockScr.class.getName()).log(Level.SEVERE, null, ex); 
  }

     try
     {
        if(con != null)
        {
          con.close();
        }
     }catch(Exception ex){

     }

}

private void NextBtnActionPerformed(java.awt.event.ActionEvent evt) {

try
{

 if (rs == null)
 {
    fetchResultSet();
 }

 if (rs!=null)
 {
    if (rs.next())
    {
        TxtStockid.setText(rs.getString("StockId"));
        TxtItem.setText(rs.getString("ItemName"));
        TxtQuantity.setText(rs.getString("Quantity"));
        TxtUnitprice.setText(rs.getString("UnitPrice"));
        TxtNetprice.setText(rs.getString("NetPrice"));
        TxtUnitweight.setText(rs.getString("UnitWeight"));
        TxtNetweight.setText(rs.getString("Netweight"));
        TxtDescription.setText(rs.getString("Description"));         
    }
   else
   {
      rs = null;
   }
 }
}catch(Exception ex){
  System.out.println(ex); 
  }        
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T18:50:25.867

`next`在单击按钮之前，您应该创建与数据库的连接并仅获取一次新记录。`rs.next`然后使用in`NextBtnActionPerformed`方法继续前进。

例如，您应该有一个如下调用 fetchResultSet 的方法，并且应该在`next`单击按钮之前调用该方法。

```
ResultSet rs;
Connection con = null;
public void fetchResultSet()
{

   try {
        if(con==null || con.isClosed())
        {
          Class.forName("sun.jdbc.odbc.JdbcOdbc");
          con = DriverManager.getConnection("jdbc:odbc:StockInventory","sa","123");           
        }
        Statement stmt = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
        String query = "select * from Stocktbl";
        rs = stmt.executeQuery(query); 
      }catch(Exception ex)
      {
         System.out.println(ex);
         Logger.getLogger(StockScr.class.getName()).log(Level.SEVERE, null, ex);

         try
         {
            if(con != null)
            {
              con.close();
            }
         }catch(Exception x){}
      }
} 
```

然后你`NextBtnActionPerformed`应该是这样的：

```
private void NextBtnActionPerformed(java.awt.event.ActionEvent evt)
{
  try
  {
     if (rs == null)
     {
        fetchResultSet();
     }
     if (rs!=null)
     {
        if (rs.next())
        {
            TxtStockid.setText(rs.getString("StockId"));
            TxtItem.setText(rs.getString("ItemName"));
            TxtQuantity.setText(rs.getString("Quantity"));
            TxtUnitprice.setText(rs.getString("UnitPrice"));
            TxtNetprice.setText(rs.getString("NetPrice"));
            TxtUnitweight.setText(rs.getString("UnitWeight"));
            TxtNetweight.setText(rs.getString("Netweight"));
            TxtDescription.setText(rs.getString("Description"));         
        }
       else
       {
          rs = null;
       }
     }
  }catch(Exception ex){System.out.println(ex);}
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T18:44:25.517

您需要先打电话`rs.next()` *，然后*才能打电话`rs.isLast()`。对功能的调用`rs.isLast()`并没有提供太多功能：

```
if (rs.next()) {
    TxtStockid.setText(rs.getString("StockId"));
    ... 
```

使用这种方法，您不会前进`ResultSet`光标，因此每次单击按钮时都会获得相同的数据。`WHERE`将需要一个子句来返回*不同*的行。如果记录的总量不大，缓存数据将是首选方法。

缓存适用于项目数量相对较少且不需要大规模扩展的情况。在这种情况下，您可以`ArrayList<MyStockItem>`在启动时将所有数据加载到一个并导航`List`而不是建立数据库连接。[EHCache](http://ehcache.org/)等产品可用于此目的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T18:45:27.913

**您在每次单击按钮时创建新的结果集**。因此，新结果集的光标位于第一个位置，这就是为什么您在单击它时总是得到相同的记录。要解决它，您需要创建结果集字段，然后用主类的构造函数中的记录填充它，然后对该结果集进行操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T18:48:41.803

你应该使用

```
while(rs.next())  instead of if(!rs.isLast())  and then rs.next() 
```

我不认为结果集提供了向后移动的 api。问题是你为什么需要它。

# javascript - 为什么我的精灵表被多次加载？

> ID：15819154
> 
> 赞同：3
> 
> 时间：2013-04-04T18:41:47.213
> 
> 标签：javascript, jquery, css, css-sprites

我有一个精灵表来驱动一组按钮的外观，这些按钮会随着各种鼠标操作而变化。但是，在精灵之间切换时我可以看到闪烁，并且在 chrome 或 firebug 中查看网络面板确认每次更改精灵时都会重新加载精灵表，这违背了使用精灵表的意义。

处理换出精灵的 jquery 代码是这样的：

```
$(".btn").mouseover(function () {
    var imgId = $(this).prop("id");
    if (imgList[imgId]) {
        if (!$(this).hasClass(imgList[imgId]["inactive"])) {
            $(this).removeClass(imgList[imgId]["all"]).addClass(imgList[imgId]["mouseOver"]);
        }
    }
});

$(".btn").mousedown(function () {
    var imgId = $(this).prop("id");
    if (imgList[imgId]) {
        if (!$(this).hasClass(imgList[imgId]["inactive"])) {
            $(this).removeClass(imgList[imgId]["all"]).addClass(imgList[imgId]["mouseDown"]);
        }
    }
});

$(".btn").mouseout(function () {
    var imgId = $(this).prop("id");
    if (imgList[imgId]) {
        if (!$(this).hasClass(imgList[imgId]["inactive"])) {
            $(this).removeClass(imgList[imgId]["all"]).addClass(imgList[imgId]["default"]);
        }
    }
}); 
```

其中 imgList 是用于应用精灵的类名列表，所有这些都是类的完整列表。这是一个示例：

```
imgList["navToggleNavigation"] = [];
imgList["navToggleNavigation"]["default"] = "NavShowHide-Button-normal";
imgList["navToggleNavigation"]["mouseOver"] = "NavShowHide-Button-mouseOver";
imgList["navToggleNavigation"]["mouseDown"] = "NavShowHide-Button-mouseDown";
imgList["navToggleNavigation"]["inactive"] = "NavShowHide-Button-inactive";
imgList["navToggleNavigation"]["select"] = "NavShowHide-Button-select";
imgList["navToggleNavigation"]["all"] = "NavShowHide-Button-normal NavShowHide-Button-mouseOver NavShowHide-Button-mouseDown NavShowHide-Button-inactive NavShowHide-Button-select"; 
```

这些类中的每一个的 CSS 代码都引用了工作表中的一个图像：

```
.NavShowHide-Button-inactive{background-image:url('../Images/navigation-spritesheet.png') ; background-position:-704px 0px ; height: 44px; width: 44px; display: inline-block;}
.NavShowHide-Button-mouseDown{background-image:url('../Images/navigation-spritesheet.png') ; background-position:-748px 0px ; height: 44px; width: 44px; display: inline-block;}
.NavShowHide-Button-mouseOver{background-image:url('../Images/navigation-spritesheet.png') ; background-position:-792px 0px ; height: 44px; width: 44px; display: inline-block;}
.NavShowHide-Button-normal{background-image:url('../Images/navigation-spritesheet.png') ; background-position:-836px 0px ; height: 44px; width: 44px; display: inline-block;}
.NavShowHide-normal{background-image:url('../Images/navigation-spritesheet.png') ; background-position:-880px 0px ; height: 44px; width: 44px; display: inline-block;} 
```

此代码中是否有任何内容会导致 spritesheet 在运行时重新加载？有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T18:44:54.550

不要在每个类上声明 a `background-image`，您应该有一个具有 的类名（如`.NavShowHide`），`background-image`然后使用更具体的类来定义`background-position`唯一的：

```
.NavShowHide {
    background-image:url('../Images/navigation-spritesheet.png'); 
    height: 44px; 
    width: 44px; 
    display: inline-block;
}
.NavShowHide-Button-inactive{background-position:-704px 0px;}
.NavShowHide-Button-mouseDown{background-position:-748px 0px;}
.NavShowHide-Button-mouseOver{background-position:-792px 0px;}
.NavShowHide-Button-normal{background-position:-836px 0px;}
.NavShowHide-normal{background-position:-880px 0px;} 
```

然后给元素两个类的组合，即：

```
<div class="NavShowHide NavShowHide-Button-normal">My Button</div> 
```

# android - 为什么我的服务没有启动？

> ID：15819155
> 
> 赞同：0
> 
> 时间：2013-04-04T18:41:47.147
> 
> 标签：android, android-service

我使用 AlarmManager 启动服务，但由于某种原因，我无法确定该服务没有启动。

我的 onResume() 中用于启动服务的代码是：

```
Intent appIntent = new Intent(cxt, NotificationService.class);

            AlarmManager alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);
            PendingIntent penIntent = PendingIntent.getService(this, 0,
                    appIntent, PendingIntent.FLAG_UPDATE_CURRENT);

            alarmManager.cancel(penIntent);

            penIntent = PendingIntent.getService(this, 0, appIntent, PendingIntent.FLAG_UPDATE_CURRENT);

            Calendar cal = Calendar.getInstance();
            cal.set(Calendar.HOUR_OF_DAY, 5);
            cal.set(Calendar.MINUTE, 00);
            cal.set(Calendar.SECOND, 00);

            alarmManager.setRepeating(AlarmManager.ELAPSED_REALTIME_WAKEUP, cal.getTimeInMillis(),
                    10 * 1000, penIntent); 
```

清单包含以下内容：

```
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
<uses-permission android:name="com.android.alarm.permission.SET_ALARM" />
<uses-permission android:name="android.permission.WAKE_LOCK" />

<application
     android:debuggable="true"
     android:icon="@drawable/icon"
     android:label="@string/app_name" >
      <service
          android:name="de.brillow.mensa.Speiseplan$NotificationService"
          android:enabled="true" /> 
```

最后服务本身看起来像这样：

```
public class NotificationService extends Service {

        private WakeLock mWakeLock;

        @Override
        public IBinder onBind(Intent intent) {
            return null;
        }

        private void handleIntent(Intent intent) {
            // obtain the wake lock
            PowerManager pm = (PowerManager) getSystemService(POWER_SERVICE);
            mWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,
                    "wakelocktag");
            mWakeLock.acquire();

            Log.i("PowerManager", "acquired");

            // do the actual work, in a separate thread
            new PollTask().execute();
        }

        private class PollTask extends AsyncTask<Void, Void, Void> {

            @Override
            protected Void doInBackground(Void... params) {
                // do stuff!
                Log.i("Background", "stuff");
                return null;
            }

            @Override
            protected void onPostExecute(Void result) {
                // handle your data
                int id = 001;
                Log.i("Noti", "fication");
                NotificationManager mNotifyMng = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);
                NotificationCompat.Builder mBuilder = new NotificationCompat.Builder(
                        Speiseplan.this).setSmallIcon(R.drawable.icon)
                        .setContentTitle("Test").setContentText("Test!");

                mNotifyMng.notify(id, mBuilder.build());
                Log.i("Notification", "sent");
                stopSelf();
                Log.i("Service", "stopped");
            }
        }

        @Override
        public void onStart(Intent intent, int startId) {
            handleIntent(intent);
        }

        @Override
        public int onStartCommand(Intent intent, int flags, int startId) {
            handleIntent(intent);
            return START_NOT_STICKY;
        }

        public void onDestroy() {
            super.onDestroy();
            mWakeLock.release();
        }
    } 
```

由于某种原因，通知和 Log.i 消息都没有出现。我希望你能帮忙。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:03:20.377

你不应该使用 a 的`AsyncTask`内部`Service`。`AsyncTask`应该只用于*将结果返回到当前活动*的任务，即它应该在`Activity`or中定义`Fragment`。这就是它的设计目的。

`doInBackground(...)`在您的情况下，您可以将所有内容`onPostExecute(...)`放入`onCreate(...)`您的服务中。如果需要，请使用线程。如果您需要在 an 中可视化您的服务结果`Activity`，请调用 an`Intent`并将任何细节传递给 extras，例如

服务中的调用...

```
Intent intent=new Intent(context,VisualizingActivity.class);
intent.putExtra("A", "Data A");
intent.putExtra("B", "Data B");
context.startActivity(intent); 
```

活动中的处理...

```
String A= intent.getStringExtra("A");
String B= intent.getStringExtra("B"); 
```

如果您只想创建`Notification`s，您可以直接从服务中执行此操作。不需要`AsyncTask`or `Activity`。

希望这会有所帮助……干杯！

# parsing - 在文档中查找日期和时间

> ID：15819157
> 
> 赞同：0
> 
> 时间：2013-04-04T18:41:47.803
> 
> 标签：parsing, time, web-crawler, information-retrieval

时间、日期和时间+日期可以用多种方式表示，例如。

*   今天 18:00
*   下周一下午 4 点
*   1月12日
*   2013 年 1 月 1 日
*   今天晚上5点
*   还有很多很多

我需要找到一种方法来查找和检索这些格式的时间和日期并收集它们。一种方法是列出关键字，找到它们并查看之前和之后的单词。

除此之外，匹配越多越好，所以我需要更多的模式来比较以确定序列是否是日期。这可能很耗时。

这是最好的方法吗？

# vb.net - 使用按钮更改一个图片框中的两个图像（VB.NET）

> ID：15819164
> 
> 赞同：0
> 
> 时间：2013-04-04T18:42:02.630
> 
> 标签：vb.net, if-statement, picturebox

我一直在尝试更改图片框中的图像。如果我想用一个图像更改它，它可以工作，但我不能让它更改为另一个图像。当我单击按钮时，它应该在两个图像之间交替。

这是我的代码：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)  Handles Button1.Click

    Dim num As Boolean

    If num = False Then

        PictureBox3.Image = My.Resources.Beep
        num = True

    Else

        PictureBox3.Image = My.Resources.Skateboard
        num = False

    End If

End Sub 
```

我一直在试图弄清楚为什么它长时间不起作用，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:45:09.677

您的变量`num`是该方法的本地变量，因此您可以随意更改它，但每次调用此代码时，`num`都会重新创建变量并赋予默认初始值 False。
仅从您将其设置到方法的退出点，它将为 True

要解决此问题，您需要将其声明为[Shared](http://msdn.microsoft.com/en-us/library/zc2b427x.aspx)或在类全局级别的过程之外声明它

**共享选项**

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)  Handles Button1.Click

    Dim Shared num As Boolean
    If num = False Then
        PictureBox3.Image = My.Resources.Beep
        num = True
    Else
        PictureBox3.Image = My.Resources.Skateboard
        num = False
    End If
End Sub 
```

**班级级别选项**

```
Dim num As Boolean

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)  Handles Button1.Click
.....
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T18:47:27.470

您的 num 变量在方法中，因此当您调用方法时，它会一次又一次地初始化，并且不记得您上次设置的内容（真或假）。试试这个。

```
Dim num As Boolean

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)  Handles Button1.Click

   If num = False Then
       PictureBox3.Image = My.Resources.Beep
       num = True
   Else
       PictureBox3.Image = My.Resources.Skateboard
       num = False
End If

End Sub 
```

# ruby - net::http 帮助 [ POST 与 curl 一起使用，但在表单上失败]

> ID：15819173
> 
> 赞同：0
> 
> 时间：2013-04-04T18:42:22.053
> 
> 标签：ruby, json, post, curl, net-http

我正在尝试使用 net::http 进行发布请求。

我使用 net:http 的请求失败并出现以下错误：

```
respnose_body,code: ["{\"message\":\"Validation Failed\",\"errors\":{\"direction\":[\"invalid\"]}}",
   "422"]] 
```

我的请求在终端上使用 curl 可以正常工作：

```
curl https://$$.com/$$ \
>     -u usr:Pssd! \
>     -X POST \
>     -H 'Accept: application/json' \
>     -H 'Content-Type: application/json' \
>     -d '{"body":"my body"}' 
```

但是同样的请求，我尝试使用 nett:http 作为

```
 http_headers => {"Accept" => "application/json", "Content-Type" => "application/json"}

 uri=URI.parse(url)
      http = Net::HTTP.new(uri.host, uri.port)
      http.use_ssl = true
      http.verify_mode = OpenSSL::SSL::VERIFY_NONE
      request = Net::HTTP::Post.new(uri.request_uri)
      http_headers.each{|key,value| request.add_field(key,value)}
      request.body = form_data  
      response=http.request(request)

The form_data is passed as a json using hash.to_json . 
```

现在，相同的 NET:HTTP 代码适用于执行完全相同的不同 post 请求（在不同的 uri 上）。

该服务期望以 json 格式发送和接收数据。

调试此的任何建议。

谢谢！

更新：添加了我设置标题的方式

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:14:51.677

尝试：

```
request = Net::HTTP::Post.new(uri.request_uri, {'Content-Type' =>'application/json'}) 
```

或者：

```
request = Net::HTTP::Post.new(uri.request_uri)
request["Content-Type"] = "application/json" 
```

# objective-c - 我应该如何创建一个输出到命令行的 Cocoa 应用程序？

> ID：15819174
> 
> 赞同：-2
> 
> 时间：2013-04-04T18:42:23.740
> 
> 标签：objective-c, cocoa

我正在尝试构建一个使用第三方可可 API 的可可应用程序（它还需要响应 URL 方案）。我希望我的应用程序尽可能简单，并充当其他应用程序的“助手”应用程序。

似乎对我来说最好的方法是让应用程序从[带有参数](https://stackoverflow.com/questions/5146849/accessing-command-line-arguments-in-objective-c)的命令行启动，然后在退出之前将一些输出直接写入 CLI 或一些中间文件（如 plist）。

我怎样才能最好地产生输出（假设我只是将它转储到命令行），和/或有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:59:37.797

仅提供一般建议，“最佳”是主观的！

如果您要生成多个“blob”（这是一个技术术语；-)）输出，请使用 C 的标准 I/O 函数，如果您只想输出一个 blob，则可以使用`write`. 基本方法是：

1.  产生你的输出`NSString`- 不管你喜欢
2.  使用（或转换为其他字符集编码）的方法产生一个C`UTF8String`字符串`NSString`
3.  将 C 字符串输出到`stdout`with等或使用`fputs`文件描述符`1``write`

如果您多次执行此操作，请将上述内容包装为一种方法，该方法根据需要采用格式字符串/参数等。

您会看到一些 CLI 应用程序以 plist 格式向终端输出输出，这对于将成为助手的应用程序很有用 - 调用应用程序可以通过管道读取输出并将 plist 转换为字典/数组，就像阅读一样.plist 文件。这是一种比将 plist 写入文件然后再读回更直接的方法。

但是助手不需要 CLI 或 GUI，您可以使用各种形式的 IPC 启动并与他们通信。如果您的应用程序将被沙盒化，则应考虑使用 XPC 助手。

高温高压

# java - 在 reducer 代码中以编程方式停止作业

> ID：15819175
> 
> 赞同：-1
> 
> 时间：2013-04-04T18:42:25.947
> 
> 标签：java, hadoop, mapreduce

假设我在减速器代码中的输入键/值中检测到某些内容，应该实际运行什么代码以使减速器不再继续，输出处发出的任何记录都将写入输出文件，并且作业停止，不再进一步减少发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:04:32.533

可能是多个 reducer 必须在您的 hadoop 集群上运行的情况。因此，即使您在输入中检测到错误并尝试停止它，您也不确定状态是否一致（即一旦收到错误的输入就不会处理任何记录），因为多个记录可能由多个减速器并行处理。

所以我认为停止工作不是一个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:08:03.177

停止工作可能不是一个好主意。但是，如果您需要它，一种方法是创建您自己的异常类，可能扩展其中一个`InterruptedException`or `IOException`，并在您想要退出的条件出现时抛出该异常。

您的异常类可能如下：

```
Class QuitReducerException extends InterruptedException {

      //Parameterless Constructor
      public QuitReducerException() {}

      //Constructor that accepts a message
      public QuitReducerException(String message)
      {
         super(message);
      }
} 
```

在您的 reduce 方法中，您可以按如下方式使用它：

```
@Override
 protected void reduce(Text key, Iterable values, Context context) throws IOException,InterruptedException {
      ...
      if(<condition to quit happen>){
          throw new QuitReducerException("Quitting reducer due to some specified reason");// You may add details of the reason you are quitting and this will be available in the job logs (in stderr)
      }
      ...
  } 
```

**PS：**这不能确保当前 reducer 发出的输出会被提交到输出文件。此外，任何其他未完成的减速器都不会提交文件。虽然已经完成的 reducer 已经提交了他们的输出。

# azure - Azure 删除导致 503 服务不可用异常

> ID：15819176
> 
> 赞同：-1
> 
> 时间：2013-04-04T18:42:26.603
> 
> 标签：azure, http-status-code-503

我编写了一个单元测试，它创建一个容器、添加一个文件、检查文件是否存在，然后尝试删除该文件。当我进入删除步骤时，我总是得到一个 503 Service Unavailable 虽然当我单步执行单元测试并查看容器时，该文件已被删除（我已验证它也已创建）。知道我做错了什么吗？我正在使用从 NuGet 获得的“Microsoft.WindowsAzure.Storage.dll”版本 2.0.5.1。

当我尝试删除容器时也会发生同样的事情。

这是我正在使用的代码。看起来很简单。

```
public void Save(string relativePath, Stream item)
{
    var cr = GetContainer(relativePath).GetBlockBlobReference(GetPath(relativePath));
    item.Seek(0, SeekOrigin.Begin);
    cr.UploadFromStream(item);
}

public void Delete(string relativePath)
{
    var cr = GetContainer(relativePath).GetBlockBlobReference(GetPath(relativePath));
    cr.DeleteIfExists();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-04T16:41:59.323

OP写道：

> 就我而言，这与我们 IT 部门的网络监控解决方案阻止 DELETE 语句有关，认为它们是 WebDav 请求。希望这对将来的某人有所帮助。

# c# - ToString() 默认 CultureInfo

> ID：15819177
> 
> 赞同：18
> 
> 时间：2013-04-04T18:42:28.870
> 
> 标签：c#, tostring, cultureinfo

我想我了解 CultureInfo 的用法。

如果我做简单：

```
const int a = 5;
string b = a.ToString(); 
```

是否等于：

```
const int a = 5;
string b = a.ToString(CultureInfo.InvariantCulture); 
```

换句话说， ToString() 默认使用**InvariantCulture**或**CurrentCulture**还是两者都不使用？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-04T18:43:13.453

`ToString`将使用`CurrentCulture`，而不是`InvariantCulture`如果您不指定文化。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-04T18:43:15.933

ToString() 在未指定时使用 CurrentCulture

请参阅：http: [//msdn.microsoft.com/en-us/library/6t7dwaa5 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/6t7dwaa5(v=vs.85).aspx)

> “返回值使用通用数字格式说明符 ("G") 和当前区域性的 NumberFormatInfo 进行格式化。”

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-04T18:46:46.280

`ToString`默认情况下，所有内置类和数字类型的实现都使用当前线程使用的文化文化[`CultureInfo.CurrentCulture`。](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.currentculture.aspx)

这意味着当前的文化（以及因此您的字符串格式化和解析函数）将因系统而异。在我看来，这是一个设计错误，过去曾被人咬过。它*应该*默认[`InvariantCulture`](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.invariantculture.aspx)并在整个系统中给出相同的结果，但不幸的是它没有。

# tortoisesvn - Inno 设置的 Tortoise SVN 文件版本属性

> ID：15819179
> 
> 赞同：0
> 
> 时间：2013-04-04T18:42:30.940
> 
> 标签：tortoisesvn, versioning, inno-setup

我正在努力在网上找到答案。

我正在使用 Inno Setup 为多个文件创建安装程序。我知道 InnoSetup 可以检查文件版本并且不会用旧版本覆盖，这很棒。

但是，我不知道如何让乌龟 SVN 将“版本”属性添加到其文件中。

我宁愿不在 Inno Setup 中对所有文件使用“touch”标志。

我对版本控制（版本 ID 的创建）相当陌生，任何“有用的链接”都将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T18:50:29.320

这不是 Inno Setup 检查的那种“版本”。

Inno Setup 检查可执行文件 ( `.DLL`/ `.EXE`) 版本信息（它是嵌入在文件中的 Windows 资源 -[`Version Info Resource`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381058%28v=vs.85%29.aspx)有关详细信息，请参阅 MSDN），就像您在 Windows 资源管理器中右键单击应用程序时看到的一样，查看`Properties->Details`并查看如下内容：

```
File Description     Some Application Description
Type                 Application
File Version         2.5.1.247
Product Name         Some Product Name
Product Version      2.0.0.0
Copyright            © 2013, Some Company Name 
```

# caching - Drupal 6 缓存和块

> ID：15819185
> 
> 赞同：0
> 
> 时间：2013-04-04T18:42:50.840
> 
> 标签：caching, drupal, drupal-6, drupal-blocks

我已经阅读了所有内容，并且试图弄清楚我是否理解 Drupal 6 中缓存的发生方式。我们有一个网站，其中包含实时股票行情。我们启用了 Drupal 缓存，因此股票价格最终会被缓存并冻结在特定位置。我想出了一种可以处理它的方法是将代码放在我在自定义模块中创建的块中并设置 BLOCK_NO_CACHE，但是如果我理解正确，如果您启用了站点缓存，那么整个页面都会被缓存，包括无论其各自的缓存设置如何，它上面的任何和所有块。它是否正确？那么，如果我有某些不应该缓存的点，我是否无法利用站点缓存？有谁知道我可以用来两全其美的另一种解决方案？为了能够进行站点缓存，但也有一个实时股票行情？顺便说一句，股票行情正在向 Yahoo Finance API 发出 JSON 请求以获取报价。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T22:42:12.963

您是对的，该指令`BLOCK_NO_CACHE`仅适用于块级别。但是，当启用页面缓存时，Drupal 将缓存整个页面（也包括块）。但这仅适用于匿名用户。Drupal 的理念是匿名用户的内容总是相同的，因此他们得到缓存页面。但这不适用于经过身份验证的用户。因为不同的用户可能对页面的某些部分有不同的访问权限（例如，对于管理员来说，链接块看起来与普通用户不同）。

您可能想看看这个讨论：[BLOCK_NO_CACHE not working for anonymous users](http://drupal.org/node/791142)

还有一个解决方案，你会偶然发现这个讨论。就是这个模块：[Ajax Blocks](http://drupal.org/project/ajaxblocks)。从模块描述中提取：

> 当匿名用户查看页面时，允许在加载整个缓存页面后通过额外的 AJAX 请求加载一些块。它适用于大部分是静态的网站，匿名用户的页面缓存是一个很大的好处，但有些信息必须是动态的。

# sqlite - Sqlite 创建唯一的列对

> ID：15819186
> 
> 赞同：15
> 
> 时间：2013-04-04T18:42:58.107
> 
> 标签：sqlite, unique

我想创建一个包含两列的表：`user_id`, `image_id`. 我不想`user_id`或者`image_id`是独一无二的，但我也想保护我的桌子免受重复的相同`user_id`and对`image_id`。我可以这样做吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-04T21:24:49.477

为两列添加单独的约束：

```
CREATE TABLE MyTable(
    user_id INTEGER,
    image_id INTEGER,
    [...],
    UNIQUE(user_id, image_id)
) 
```

# ruby-on-rails - rspec验证，除非

> ID：15819187
> 
> 赞同：0
> 
> 时间：2013-04-04T18:42:58.227
> 
> 标签：ruby-on-rails, shoulda, specifications

**简介.rb**

```
# encoding: utf-8
class Brief < ActiveRecord::Base
  belongs_to :project  
  validates_numericality_of :duration, :only_integer => true, :less_than_or_equal_to => 15, :greater_than_or_equal_to => 5, :unless => Proc.new{ |b| b.project.project_type.express_project }
end 
```

**简要规范.rb**

```
require 'spec_helper'

describe Brief do

  before(:all) do
    @project =Factory(:project)
    @brief=Factory.build(:brief,:project => @project)
  end

  context 'non-specific tests' do

    subject { @brief }

    it { should belong_to(:project) }

    it { should validate_presence_of(:project}

  end
end 
```

这些是我的简要模型和简要规范文件。但我不知道如何测试 validates_numericality_of**除非**部分。有人以前试过吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:16:34.697

使用上下文并测试不同的条件

例如

```
context "when duration is more than 5 but less than 15" do 
  before do 
    subject.duration = 10
  end
  it { should validate_presence_of(:project) }
end
context "when duration is more than 15" do 
  before do 
    subject.duration = 20
  end
  it { should_not validate_presence_of(:project) }
end 
```

# gps - 有人知道 SUPL 2.0 服务器吗？

> ID：15819191
> 
> 赞同：3
> 
> 时间：2013-04-04T18:43:11.483
> 
> 标签：gps, location, supl-2.0

我正在寻找2.0 版`FQDN`的。`SUPL server`我知道`supl.google.com`存在，但它适用于 1.0 版。

请张贴 a 的名称和端口号，`SUPL 2.0 server`如果需要，请告诉我`TLS`。

仅供参考 -`SUPL servers`用于提供`assistance information`请求`location`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-24T08:18:23.760

Google SUPL 服务器支持 SUPL 2.0 规范。但根据我最近的实验，它只支持 RRLP 协议。它不支持 LPP 协议。它仅支持基于集合的位置计算（基于 MS）。它不支持设置辅助位置计算（MS 辅助）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-05T15:34:46.223

Google 最近开始支持使用相同 FQDN 的 SUPL 2.0。确保设备驻留在 WCDMA 或 LTE 网络上。

# xml - 查看器中的 Loadrunner 重播和 xml

> ID：15819196
> 
> 赞同：0
> 
> 时间：2013-04-04T18:43:17.327
> 
> 标签：xml, cdata, loadrunner, ajax-request

在一些严重的相关工作之后，使用 Ajax 记录和重播 Web 应用程序似乎可以工作:-) 但是在打开查看器的情况下重播脚本我观察到，在重播的某些步骤中，显示的页面仅包含表单上的 XML`<ajax-respons> .... [CDATA ...(The data I have put in and parameterized)] ...... </ajax-response>`和不是图形用户界面。业务流程也可以正常工作，因为我可以观察到该流程按预期执行并具有预期结果。我的问题基本上是为什么 LoadRunner 在查看器中显示此 XML，如果这是某种错误的迹象？有其他人经历过吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T13:53:03.480

在脚本回放期间运行的 LoadRunner 查看器**不是完整的 Web 浏览器**。它仅显示在脚本步骤期间请求的特定非资源文件。由于该步骤仅在您的脚本中请求一个 XML 文件，这就是将在那里显示的全部内容。

该查看器只是一个健全性检查工具，可让您大致了解事情的运行情况。如果您想要更详细的外观，请通过扩展日志设置或将正确的错误处理函数写入脚本或在执行脚本后使用树视图来依赖输出日志，并且对于您查看的每个步骤切换到回放视图，比较播放/录制的视图。

# r - 我可以从 RStudio 中安装 R 吗？

> ID：15819197
> 
> 赞同：-1
> 
> 时间：2013-04-04T18:43:19.993
> 
> 标签：r, rstudio

R 版本 3 已在 R bloggers 上发布。我正在使用 RStudio，想知道是否可以从 RStudio 中安装新版本。可能安装的包、功能和数据有什么注意事项吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:03:27.403

RStudio 内置支持更新包，但不支持更新 R 本身。

如果您使用的是 Windows，则该`installr`软件包可用于更新 R（如[R-bloggers](http://www.r-bloggers.com/r-3-0-0-is-released-whats-new-and-how-to-upgrade/)中所述）。否则，您的更新将需要更多手动操作。

# asp.net-mvc - Kendo UI Editor ImageBrowser 路径问题

> ID：15819202
> 
> 赞同：0
> 
> 时间：2013-04-04T18:43:32.937
> 
> 标签：asp.net-mvc, kendo-ui

我在将一个字符串参数从视图传递到控制器时遇到问题。

看法：

```
@model ImageModel

@(Html.Kendo().Editor()
          .Name("EditorCustom")
          .ImageBrowser(imagEditorImageBrowserControllereBrowser => imageBrowser
            .Image(Model.fullpath)
            .Read("Read", "ImageBrowser")
            .Upload("Upload2", "ImageBrowser")
            .Thumbnail("Thumbnail", "ImageBrowser")
          )
          .HtmlAttributes(new { style = "width: 740px;height:440px" })
          .Tools(tools => tools
                    .ViewHtml()
                    .CustomButton(cb => cb.Name("new").ToolTip(Html.RawLocalized(GlobalMessageKeys.InsertTable).ToString()).Exec(@<text>
                function(e) {
                    $("#dialog-modal").dialog("open");
                }
                </text>))
               )
  ) 
```

视图模型：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace App.ViewModels
{
    public class ImageModel
    {
        public string name { get; set; }
        public string fullpath { get; set; }
    }
} 
```

控制器：

```
[HttpPost]
        public ActionResult Upload2(string path, HttpPostedFileBase file)
        {
            try
            {
                UploadResource uploadRes = new UploadResource();
                uploadRes.Path = path;
                uploadRes.StreamFile = file.InputStream;
                uploadRes.Name = file.FileName;

                ServiceLocator.MaintenanceService.UploadResource(uploadRes);
            }

            catch (Exception)
            { 

            }

            return Content("");
        } 
```

控制器类继承自作为 DLL 的 EditorImageBrowserController，但我想自己上传和读取图像而不使用 DLL，所以我在控制器中编写了一个名为“Upload2”的新方法，该方法接收正确传递的文件和路径字符串始终为空。我试图通过视图中的 mvc kendo 代码“.Image(Model.fullpath)”发送它，但什么也没有，我还没有找到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-12T22:49:07.537

抱歉迟到了，这更适合未来的谷歌人。

您可以创建自己的控制器，并用类似的东西覆盖默认值。

```
 public class YourOwnImageBrowserController : EditorImageBrowserController
{
    //
    // GET: /YourOwnImageBrowserController/
    private const string contentFolderRoot = "~/images/yourfolder";
    public override string ContentPath
    {
        get
        {
            return contentFolderRoot;
        }
    }

} 
```

然后在你的编辑器中使用它。

```
 .Read("Read", "YourOwnImageBrowserController")
   .Create("Create", "YourOwnImageBrowserController")
   .Destroy("Destroy", "YourOwnImageBrowserController")
   .Upload("Upload", "YourOwnImageBrowserController")
   .Thumbnail("Thumbnail", "YourOwnImageBrowserController")) 
```

Kendo 库处理所有附加的事件。

# android - json.getJSONArray() 抛出一个长度为一的异常

> ID：15819203
> 
> 赞同：0
> 
> 时间：2013-04-04T18:43:34.120
> 
> 标签：android, json, rest

我正在使用 android 将 JSON 字符串转换为其原始 java 对象。

我从 REST 服务器返回列表，并将列表转换为 JSON 格式，如下所示。

```
{"offerRideResult":[{"date":"06-APR-13 10.00.00.000000 AM","destination":"B","id":"57","PTripId":"87","req":"false","source":"A","srNo":"0","username":"Chinmay"},{"date":"06-APR-13 10.00.00.000000 AM","destination":"B","id":"1","PTripId":"88","req":"false","source":"A","srNo":"0","username":"chinmay91"}]} 
```

在 android 客户端上，我使用以下方法将其转换为 java 对象。

```
 try{
            JSONObject obj=new JSONObject(response);
            JSONArray arr=null;
            arr=obj.getJSONArray("offerRideResult");
            List<OfferRideResult> offerRideResult=new ArrayList<OfferRideResult>();
            for(int i=0;i<arr.length();i++)
            {
                OfferRideResult res=new OfferRideResult();
                res.setId(arr.getJSONObject(i).getInt("id"));
                res.setPTripId(arr.getJSONObject(i).getInt("PTripId"));
                res.setSrNo(arr.getJSONObject(i).getInt("srNo"));
                res.setDate(arr.getJSONObject(i).getString("date"));
                res.setSource(arr.getJSONObject(i).getString("source"));
                res.setDestination(arr.getJSONObject(i).getString("destination"));
                res.setReq(arr.getJSONObject(i).getBoolean("req"));
                res.setUsername(arr.getJSONObject(i).getString("username"));
                offerRideResult.add(res);
            }
    }catch(JSONException e)
            {
                System.out.println("Exception :- "+e);
            } 
```

当 JSON 格式有两个或两个以上的记录时，它可以正常工作，但是当输入是这样时，它会在记录中引发以下异常。

```
{"offerRideResult":{"date":"05-APR-13 10.00.00.000000 AM","destination":"B","id":"1","PTripId":"89","req":"false","source":"A","srNo":"0","username":"chinmay91"}}

Error!!!org.codehaus.jettison.json.JSONException: JSONObject["offerRideResult"] is not a JSONArray 
```

谁能指出我的错误或者我该如何处理长度为一的数组？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T18:57:48.427

> 但有记录它会引发以下异常

使用[JSONObject.optJSONObject](http://developer.android.com/reference/org/json/JSONObject.html#optJSONArray%28java.lang.String%29)或[JSONObject.optJSONArray](http://developer.android.com/reference/org/json/JSONObject.html#optJSONArray%28java.lang.String%29)从 main 中提取下一项。`JSONObject`尝试如下：

```
 JSONObject obj=new JSONObject(response);
 JSONArray arr=null;
 JSONObject jsonobj=null;

 // get offerRideResult JSONArray
 arr=obj.optJSONArray("offerRideResult");

 if(arr==null){
  // means item is JSONObject instead of JSONArray
 jsonobj=obj.optJSONObject("offerRideResult");
 }else{
  // means item is JSONArray instead of JSONObject
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:07:56.550

因为只有一个结果的 json 不是数组，所以 getJSONArray() 不会正确读取它

要么你可以让你的 json 字符串更像：

```
{"offerRideResult":[{"date":"05-APR-13 10.00.00.000000 AM","destination":"B","id":"1","PTripId":"89","req":"false","source":"A","srNo":"0","username":"chinmay91"}]} 
```

或者像@ρяσѕρєя K 提议的那样将其作为单个对象读入。

# javascript - HTML5 视频：修改 http 范围请求标头

> ID：15819215
> 
> 赞同：7
> 
> 时间：2013-04-04T18:43:56.170
> 
> 标签：javascript, html, video, http-headers

我有一个 html5 视频播放器（视频标签）。当页面加载时，它将向视频文件发送请求。

是否可以修改 http 请求标头 Range 字段？（见截图，两条红线之间）

Range: bytes=0- 将下载整个视频，例如我想将其限制为“Range: bytes=0-1000000”

![截屏](https://i.stack.imgur.com/Ean2W.jpg)

视频文件托管在 CDN 上，所以我不能在服务器端做任何事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-31T10:50:14.057

您可以使用 XMLHttpRequest 发送范围请求！如果服务器“接受范围：字节”，则在 window.URL.createObjectURL 上获取 blob 文件。video 标签为您提供了许多事件和属性，因此您始终知道缓冲的内容以及您所在的位置。即使用户点击了进度条、暂停或停止按钮。因为与字节范围相比，视频属性是基于时间的，所以您需要来自视频文件的一些额外信息，称为视频元数据。我玩过[Yamdi](http://yamdi.sourceforge.net/)以获得播放时间与文件搜索位置比率的 xml 文件，并在 .flv 的开头设置元数据。

在服务器端读取范围标头 (bytes=number1-number2...)，打开视频文件，寻找 number1，打印 (number2-number1+1) 字节并发送一些特定标头：Content-Type、Content-Disposition、 HTTP/1.1 206 部分内容，内容范围。

您应该遵循搜索位置。长度由你决定。

# arrays - 组装（MASMx86 PC）复制阵列

> ID：15819220
> 
> 赞同：0
> 
> 时间：2013-04-04T18:44:09.067
> 
> 标签：arrays, assembly, x86, masm

我正在做一个让我难过的加密项目。我需要将一系列加密密钥应用于字符串数组，以确定用于加密消息的密钥。我将代码设置为运行一个循环，该循环应用范围内的所有键，但现在我需要一种“刷新”原始字符串数组的方法。我的解决方案是将原始数组复制到一个新的相同大小的未填充数组中，用于循环的每次迭代。我编写了以下过程来完成此操作：

```
CopyBuffer PROC

; Copies the original buffer into a storage variable
; recieves: nothing
; returns:  nothing
    pushad
    mov ecx,67              ; loop counter
    mov esi,0
L3:
    mov dl,buffer[esi]
    mov bufferCopy[esi],dl      ; Store byte in array copy
    inc esi             ; point to the next byte
    loop    L3
    popad
    ret
CopyArray   ENDP 
```

上述代码中引用的数组声明如下：

```
buffer      BYTE    0e9h,0c8h,0d0h,087h,0ceh,0d4h,087h,0d3h,0cfh,0c2h,087h,0d3h,0ceh,0cah,0c2h,087h
            BYTE    0c1h,0c8h,0d5h,087h,0c6h,0cbh,0cbh,087h,0c0h,0c8h,0c8h,0c3h,087h,0cah,0c2h,0c9h
            BYTE    087h,0d3h,0c8h,087h,0c4h,0c8h,0cah,0c2h,087h,0d3h,0c8h,087h,0d3h,0cfh,0c2h,087h
            BYTE    0c6h,0ceh,0c3h,087h,0c8h,0c1h,087h,0d3h,0cfh,0c2h,0ceh,0d5h,087h,0d7h,0c6h,0d5h
            BYTE    0d3h,0deh
bufferCopy  db 67 dup(0) 
```

我的代码成功填充了重复数组。但是，副本的元素与原始数组的相应元素不同。

我真的很感谢一位更高级的汇编程序员在这方面的智慧！我对这门语言还很陌生，语法上还是有点模糊。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T18:54:12.620

好吧，您似乎没有使用您创建的循环计数器，并且您的循环只是永远运行，这反过来又覆盖了您的 copyBuffer 数组。试试线条

dec ecx jnz L3

instedof loop L3 应该有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T18:56:28.437

该代码似乎是正确的（无论其风格如何）。唯一的观察是提供的样本数组只有 66 个元素，而不是 67 个，因此第一个字节将被复制两次。

问题出在其他地方。尝试在调试器中运行程序，并在过程返回后立即检查数组，以证明其正确性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T13:15:06.120

好的，首先感谢大家的建议！我已经解决了这个问题（尽管可能不是以最简单的方式）。首先，我将 bufferCopy 的声明从

```
bufferCopy  db 67 dup(0)

to

bufferCopy  BYTE    SIZEOF buffer DUP(0),0 
```

我认为转换为空终止字符串解决了我的一些问题。除此之外，我还修改了我的 CopyBuffer PROC，使其运行如下：

```
 pushad                  
    mov  edx,OFFSET buffer              
    Call  StrLength                 
    mov  bufSize,eax                    

    mov ecx,bufSize             
    mov esi,0
L2:
    mov     al,buffer[esi]              
    mov     bufferCopy[esi],al      
    inc     esi                 
    loop    L2
    popad
    ret 
```

考虑到我知道开头字符串的长度，对 StrLength 的调用可能是多余的。作为免责声明，我想补充一点，我对组装还不是特别熟悉。这个解决方案（虽然是功能性的）绝不是最优的。此外，我的解释充其量只是粗略的。

# combobox - 组合框列

> ID：15819222
> 
> 赞同：0
> 
> 时间：2013-04-04T18:44:11.760
> 
> 标签：combobox, formatting

如何在列的组合框中显示数据？我正在使用带有 SQL SERVER 2008 的 VB.net 2010。或者以其他方式，是否可以通过像使用格式化函数一样格式化 sql 查询来实现这一点？

# mysql - 使用按月分组的 twitter 用户聚合文本创建临时表

> ID：15819226
> 
> 赞同：0
> 
> 时间：2013-04-04T18:44:23.357
> 
> 标签：mysql, twitter, group-by

我有很多针对存储在 MySQl 中的用户的推文。我正在尝试汇总每个用户（from_user）的所有推文文本（文本）并按月（created_at）对它们进行分组，如下所示：

```
from_user | month | fulltext
user1     | 1     | bla bla bla bla 
user1     | 2     | bleh bleh bleh
user2     | 1     | bla bla bla bla
user2     | 2     | blub blub blub 
```

我尝试编写如下 SQL 查询，但我无法弄清楚 MySQL 为何抱怨。我应该如何解决这个问题？

```
DROP TABLE IF EXISTS tempsumdate;
CREATE TABLE tempsumdate ENGINE=MyISAM CHARACTER SET utf8 COLLATE utf8_swedish_ci AS 
SELECT tw.from_user, MONTH(tw.created_at) AS month, GROUP_CONCAT(tw.text) AS fulltext  
FROM tweets AS tw
GROUP BY tw.from_user, month; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T18:50:01.793

fulltext 是 MySQL 关键字。以下网址详细说明：

[http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)

尝试将其替换`fulltext`为``fulltext``或仅将其重命名为其他内容。

我的 SQL 小提琴：

[http://sqlfiddle.com/#!2/2c71e/2](http://sqlfiddle.com/#!2/2c71e/2)

# javascript - 从 javascript 数据对象对象问题填充图表

> ID：15819228
> 
> 赞同：1
> 
> 时间：2013-04-04T18:44:25.940
> 
> 标签：javascript, jsp, arraylist, google-visualization

我目前正在尝试在我的 JSP 页面上使用 Google Charts。我正在尝试将 sql 语句的结果返回到 arraylist，我想从中获取来自 arrayList 的信息并使用它来填充谷歌图表。

```
<%@page import="java.sql.ResultSet"%>
<%@page import="java.sql.PreparedStatement"%>
<%@page import="java.sql.DriverManager"%>
<%@page import="java.sql.Connection"%>
<%@page import="java.sql.SQLException"%>
<%@page import="java.util.ArrayList"%>
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<%!public static String[] getLiveData() throws SQLException, ClassNotFoundException{
    ArrayList<String> a = new ArrayList<String>();

    Class.forName("com.mysql.jdbc.Driver");
    Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/project","root", "nbuser");
    PreparedStatement ps = con.prepareStatement("SELECT department, projectname, priority, cores, disk_space FROM project.booking GROUP BY department");
    ResultSet rs = ps.executeQuery();

    while(rs.next())
    {
        a.add(rs.getString(1));
        a.add(rs.getString(4));
    }

    return (String[]) a.toArray(new String[a.size()]);
}%>
<html>
  <head>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = google.visualization.arrayToDataTable([ISSUE TO RETURN HERE]);

        var options = {
          title: 'Company Performance'
        };

        var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>

  </head> 
```

继续在正文中调用图形等

老实说，我觉得我走错了路，但我不确定如何在我的 jsp 页面上获取数组中的数据并将其返回以创建图表。

我对java不是很好，所以如果这种方法完全关闭，我很抱歉，任何帮助都将不胜感激。

**编辑**

```
 <head>
        <script type="text/javascript">

            var theData = [ // Start of JavaScript data object
            <%
                Class.forName("com.mysql.jdbc.Driver");
                Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/project", "root", "nbuser");
                PreparedStatement ps = con.prepareStatement("SELECT department,SUM(cores) FROM project.booking GROUP BY department;");
                ResultSet rs = ps.executeQuery();

                while (rs.next()) {
            %>
                    [" <%= rs.getString(1)%>",<%= rs.getInt(2)%>],
            <%
                };
                // End of JavaScript object holding the data
            %>
                ];
        </script>

        <script type="text/javascript" src="https://www.google.com/jsapi"></script>
        <script type="text/javascript">
            google.load("visualization", "1", {packages:["corechart"]});
            google.setOnLoadCallback(drawChart);
           function drawChart() {
                var data = google.visualization.arrayToDataTable([['Department', 'Cores']].concat(theData), false);

                var options = {
                    title: 'Initial graph test'
                };
                var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
                chart.draw(data, options);
            }
        </script>

    </head>
    <body>
        <div id="chart_div" style="width: 900px; height: 500px;"></div>
        <a href="/ProjectAndBackend/System?action=livecharts">Live Charts</a>
    </body>
</html> 
```

用户查看的最终固定实现

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:04:51.477

是的，你的做法是错误的。您必须调用 Java 来获取数组的值并找到将其写入网页的方法，以便某些 javascript 可以读取它并传递给 Google Charts。

例如，HTML 可能需要如下所示：

```
<html>
<head>
<script type="text/javascript">

var theData = {
    {"name1",1}, // <-- write this line with JSP below
    {"name2",2}, // <-- write this line with JSP below
};
</script>
</head> 
```

网页的其余部分以此类推。

因此，您必须生成一些 JSP 代码来执行该操作，看起来像这样。我假设您的 Java 正确地执行了 JDBC 的工作。请注意，我们有 HTML，然后我们为逻辑添加脚本，然后返回到 HTML，但有 JSP 表达式在 HTML 部分中输出数据。（当我说 HTML 时，它确实是一个用词不当，因为它输出 JavaScript，但让我有些懈怠......）

```
 <html>
    <head>
    <script type="text/javascript">

    var theData = [ // Start of JavaScript data object
<% 
 Class.forName("com.mysql.jdbc.Driver");
    Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/project","root", "nbuser");
    PreparedStatement ps = con.prepareStatement("SELECT department, projectname, priority, cores, disk_space FROM project.booking GROUP BY department");
    ResultSet rs = ps.executeQuery();

    while(rs.next())
    {
      ['Department', 'Cores'],
%>
      [" <%= rs.getString(1) %>", "<%= rs.getString(4)) %>"],
<%
    ]; // End of JavaScript object holding the data
%>
    };
    </script>
    </head> 
```

这样做会得到一个保存数据的 javascript 对象。您将需要安排该对象的内容，但是您需要数据。这里有更多关于如何做到这一点的信息[https://developers.google.com/chart/interactive/docs/datatables_dataviews](https://developers.google.com/chart/interactive/docs/datatables_dataviews)

阅读底部的部分，其中有几个 JavaScript 对象的示例，这些示例已格式化以显示以及正确调用 Google 图表的 JavaScript 代码。

**编辑**

我在上面的代码中添加了标题，这样您就不必将它们连接到位。首先将它们放在 JavaScript 代码中以初始化数据对象。如果您查看此答案的历史记录，您可以看到我更改了哪一行。要使用它，请删除新代码`concat`中将标题放在前面的部分。

# javafx-2 - 如何使按钮看起来已被单击或选择？(JavaFX2)

> ID：15819242
> 
> 赞同：13
> 
> 时间：2013-04-04T18:45:03.037
> 
> 标签：javafx-2

当用户在我的 JavaFX2.2 UI 中按下按钮时，会出现一个深蓝色的光环，表明它已被点击。在事件过程中，我的程序可能想要“取消单击”它以显示它不再被选中。

我希望`button.setSelected(false);`我记得 Swing 曾经有这个，但在 JavaFx 中没有这样的调用。本文[讨论](http://docs.oracle.com/javafx/2/ui_controls/button.htm#CJHEEACB)了投影，但我想简单地使用单击按钮时使用的相同外观，这并不是真正的投影。`setEffect(new DropShadow())` 使用`setStyle()`没问题，但要使用什么值？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-04T21:31:51.103

我认为对于您的描述，您实际上想要一个[ToggleButton](http://docs.oracle.com/javafx/2/api/javafx/scene/control/ToggleButton.html)而不是标准[Button](http://docs.oracle.com/javafx/2/api/javafx/scene/control/Button.html)。

[ToggleButtons](http://docs.oracle.com/javafx/2/ui_controls/toggle-button.htm)上有一个很好的 Oracle 教程。

![在此处输入图像描述](https://i.stack.imgur.com/4V2XR.png)

* * *

*解决问题中的项目*

> 深蓝色光晕似乎表明它已被点击

蓝色光环实际上是一个聚焦环，表示控件具有焦点。要聚焦控件，您可以调用[requestFocus](http://docs.oracle.com/javafx/2/api/javafx/scene/Node.html#requestFocus%28%29)方法。

> 在事件过程中，我的程序可能想要“取消单击”它以显示它不再被选中。

要从控件中移除焦点，您可以在另一个控件上调用 requestFocus 以改为关注该控件。

> 我期待一个 button.setSelected(false);

要拥有一个可以在选定和未选定状态之间切换的按钮，请使用[ToggleButton](http://docs.oracle.com/javafx/2/api/javafx/scene/control/ToggleButton.html)。A`ToggleButton`有一个[setSelected](http://docs.oracle.com/javafx/2/api/javafx/scene/control/ToggleButton.html#setSelected%28boolean%29)方法。

> setEffect(new DropShadow()) 使用 setStyle() 是可以的，但是使用什么值

阴影效果的 css 样式值在[JavaFX CSS 参考指南](http://docs.oracle.com/javafx/2/api/javafx/scene/doc-files/cssref.html)中定义。

`setEffect`在代码中通过或通过 css 使用`setStyle`或应用样式表中的样式类来定义投影效果在视觉上是等效的。在这三种方法中，我绝不会推荐这种`setStyle`方法，而只推荐样式表中的 css 或`setEffect`代码方法。

* * *

*有关的*

请注意，还有一个额外的相关属性 - [armed](http://docs.oracle.com/javafx/2/api/javafx/scene/control/ButtonBase.html#armedProperty)：

> 指示按钮已“武装”，因此鼠标释放将导致调用按钮的操作。这与压制略有不同。Pressed 表示鼠标已经在某个 Node 上被按下并且还没有被释放。然而 arm 也会考虑鼠标是否真的在按钮上方并被按下。

处于待命状态的按钮与未处于待命状态的按钮外观略有不同。大多数程序从不需要与按钮的武装状态进行交互。

* * *

*样式选定状态的示例*

将选中的 ToggleButton 与未选中的 ToggleButton 区分开来的标准方法是将其变暗以赋予其深度样式效果并使其在被按下时显得更远。这是 JavaFX 2.2 的标准[切换按钮 css](http://hg.openjdk.java.net/openjfx/2.2/master/rt/raw-file/tip/javafx-ui-controls/src/com/sun/javafx/scene/control/skin/caspian/caspian.css)：

```
.toggle-button:selected {
    -fx-background-color:
        -fx-shadow-highlight-color,
        linear-gradient(to bottom, derive(-fx-color,-90%) 0%, derive(-fx-color,-60%) 100%),
        linear-gradient(to bottom, derive(-fx-color,-60%) 0%, derive(-fx-color,-35%) 50%, derive(-fx-color,-30%) 98%, derive(-fx-color,-50%) 100%),
        linear-gradient(to right, rgba(0,0,0,0.3) 0%, rgba(0,0,0,0) 10%, rgba(0,0,0,0) 90%, rgba(0,0,0,0.3) 100%);
    -fx-background-insets: 0 0 -1 0, 0, 1, 1;
    /* TODO: -fx-text-fill should be derived */
    -fx-text-fill: -fx-light-text-color;
} 
```

[您可以通过定义自己的样式表](http://docs.oracle.com/javafx/2/css_tutorial/jfxpub-css_tutorial.htm)来覆盖此默认行为，该样式表为所选状态提供替代定义。下面的示例将确保所选状态显示比标准更微妙，仅将所选状态颜色变暗一小部分而不是很多。

![普通切换](https://i.stack.imgur.com/lvzOp.png)未选中

![切换选择](https://i.stack.imgur.com/Hz8HC.png)已选中

相关的CSS：

```
/**
 * file: colored-toggle.css
 *   Place in same directory as ColoredToggle.java.
 *   Have your build system copy this file to your build output directory.
 **/

.root {
  -fx-background-color: cornsilk; 
  -fx-padding: 10;
}

.toggle-button {
  -fx-color: paleturquoise;
}

.toggle-button:selected {
    -fx-background-color:
        -fx-shadow-highlight-color,
        linear-gradient(to bottom, derive(-fx-color,-22%) 0%, derive(-fx-color,-15%) 100%),
        linear-gradient(to bottom, derive(-fx-color,-15%) 0%, derive(-fx-color,-10%) 50%, derive(-fx-color,-8%) 98%, derive(-fx-color,-12%) 100%);
}

.toggle-button:selected:focused {
    -fx-background-color:
        -fx-focus-color,
        linear-gradient(to bottom, derive(-fx-color,-22%) 0%, derive(-fx-color,-15%) 100%),
        linear-gradient(to bottom, derive(-fx-color,-15%) 0%, derive(-fx-color,-10%) 50%, derive(-fx-color,-8%) 98%, derive(-fx-color,-12%) 100%);
} 
```

源文件：

```
import javafx.application.Application;
import javafx.geometry.Pos;
import javafx.scene.Scene;
import javafx.scene.control.*;
import javafx.scene.layout.VBox;
import javafx.stage.Stage;

public class ColoredToggle extends Application {
  public static void main(String[] args) { Application.launch(ColoredToggle.class, args); }

  @Override public void start(Stage stage) {
    ToggleButton visibilityControl = new ToggleButton("Winterfell");

    VBox layout = new VBox(10);
    layout.setAlignment(Pos.CENTER);
    layout.getChildren().setAll(visibilityControl);

    layout.getStylesheets().add(getClass().getResource("colored-toggle.css").toExternalForm());

    stage.setScene(new Scene(layout));
    stage.show();
  }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-02-09T15:37:08.937

从 css 样式表中，此命令也有效。不需要切换按钮。按下其他按钮后，焦点将更改为新按钮。

```
.button:focused{
    -fx-background-color: gray; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-21T08:04:29.793

我正在使用 JavaFx13，我使用 css 来实现我的活动按钮状态。这是我的代码（只有一部分）。

**控制器：**

```
@FXML
private BorderPane bp;

@FXML
private Button mnu_list;

@FXML
private Button mnu_address;

private Button activeMenu;

// This is my Constructor
public DashboardController() {
    this.activeMenu = null;
}

public void initialize() {

    mnu_list.setOnMouseClicked(
            actionEvent -> this.setActiveMenu(mnu_list, ListController.class)
    );

    mnu_address.setOnMouseClicked(
            actionEvent -> this.setActiveMenu(mnu_address, AddressController.class)
    );
}

private void setActiveMenu(Button s, Class c) {
    if (c != null) {
        // I'm using FXWeaver. Here I'm setting a new fxml to borderpane.
        bp.setCenter(this.fxWeaver.loadView(c));
    }
    if (this.activeMenu != null) {
        this.activeMenu.getStyleClass().removeAll("active");
    }
    s.getStyleClass().add("active");
    this.activeMenu = s;
} 
```

**CSS：**

```
.btn_menu{
    -fx-background-radius: 0px;
    -fx-cursor: hand;
    -fx-alignment: center-left;
}
.btn_accent_color{
    -fx-background-color: #7c4dff;
    -fx-text-fill: #FFFFFF;
}
.btn_accent_color.active{
    -fx-background-color: #aa3bfe;
    -fx-text-fill: #FFFFFF;
} 
```

**注意：**在*.fxml*文件中 - 我已将所有菜单按钮类设置为*btn_menu*、*btn_accent_color*。

**信息：**在这里，我将 css 类切换（添加和删除）按钮。（与我们在使用 js 的网站中所做的一样）

# c# - 列表 .add() 的 C# 问题

> ID：15819245
> 
> 赞同：1
> 
> 时间：2013-04-04T18:45:15.547
> 
> 标签：c#, list

我有一堂课：

```
ProductData ProductData = new ProductData(); 
```

并创建了一个列表：

```
List<ProductData> ProductDataList = new List<ProductData>(); 
```

当我将项目添加到列表中时：

```
ProductDataList.Add(ProductData); 
```

列表中的最后一个元素正在覆盖所有以前的元素，我不确定为什么会这样，有人可以帮忙吗？

这是更多的结构：

```
ProductData ProductData = new ProductData();

List<ProductData> ProductDataList = new List<ProductData>();

while (myReader.Read())
                {
                    ProductData.value = “some values I am assigning go here”;

          ProductDataList.Add(ProductData);
       }; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-04T18:46:50.163

您不是在创建多个新`ProductData`实例，而是一遍又一遍地改变同一个实例。

你几乎肯定只想移动这条线：`ProductData ProductData = new ProductData();`从你的循环外面到里面。这将确保您创建 N 个实例，而不是一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T18:51:15.550

我敢打赌，您的完整代码一定是这样的：

```
ProductData ProductData = new ProductData(); 
ProductData.Something = "1st";

ProductDataList.Add(ProductData);

ProductData.Something = "1st";

ProductDataList.Add(ProductData);

ProductData.Something = "2nd";

ProductDataList.Add(ProductData);

ProductData.Something = "3rd";

ProductDataList.Add(ProductData); 
```

你说它是覆盖，因为它们都具有“3rd”的值。这不是列表的问题，而是您的**object instance**。

请注意，您只创建了一个实例，就是`new ProductData`那里。当您更改它时，您不会创建新实例，而只是更改您唯一的实例。

您应该为您拥有的每个对象创建新实例。

# c++ - 在 VC++ 中添加新库

> ID：15819246
> 
> 赞同：-1
> 
> 时间：2013-04-04T18:45:15.847
> 
> 标签：c++, visual-c++, include, include-path

我刚刚下载了一个库，我想在我的 C++ 程序中使用它（Visual Studio 2012）。

在搜索“如何将库添加到 VC++ 项目”中，我发现应该完成 3 个主要操作：“在解决方案资源管理器中右键单击项目名称/选择属性/在“项目属性页面”窗口中添加库地址在 3 个位置...

1.  C/C++ /General/ 附加包含目录
2.  链接器/常规/附加库目录
3.  链接器/输入/附加依赖项。”

问题1：当我做第一个我可以使用库时，是否必须在第二个和第三个添加路径？问题2：它们之间有什么区别？问题3：添加库还有其他事情要做吗？项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:08:32.123

通常，当您使用第三方库时，您需要做两件事：

1.  包含库函数声明的头文件（编译步骤）
2.  .lib 文件本身（链接器步骤）

*Additional Include Directories*条目仅解决问题 #1 。它不能解决链接步骤，该步骤由列表中的项目#2 和#3 解决。

# android - 在 Android 上以编程方式关闭应用程序的通知

> ID：15819249
> 
> 赞同：11
> 
> 时间：2013-04-04T18:45:20.957
> 
> 标签：android, android-notifications, android-package-managers

我正在开发一个包管理器应用程序，它显示复选框以关闭来自安装在 Android 设备上的不同应用程序的通知。

![从 Applications Manager 关闭应用程序的通知](https://i.stack.imgur.com/HiiiC.png)

从 Android 4.1 开始，用户可以从应用程序管理器中关闭应用程序的通知。我可以以编程方式打开/关闭应用程序的通知吗？有这样做的API吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T18:47:10.230

不，你不能从你的代码中做到这一点。也许在有根设备上你可以做一些魔术，但这对于更广泛的受众来说并不重要。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-10-14T23:36:11.870

如果您是应用程序开发人员，您应该在服务器端进行管理，拥有允许用户取消订阅通知的 web 服务 (REST API)。然后在您的应用程序中实现一个设置部分，用户可以在其中取消选中通知框并调用此服务。然后，您的服务器将不会向该用户发送通知。

# javascript - 为什么 removeeventlistener 在此对象上下文中不起作用？

> ID：15819251
> 
> 赞同：3
> 
> 时间：2013-04-04T18:45:31.987
> 
> 标签：javascript, dom-events

我正在开发一款游戏，我想抽象我的 UI，并根据各种游戏状态绑定取消绑定事件。但我不明白为什么这个事件没有被删除。处理程序中的范围似乎是正确的。

[小提琴](http://jsfiddle.net/DhDSf/7/)

相关（精简）js：

```
var controls = {
    game : {
        el : null,
        cb : null,

        bind : function(el, cb) {
            this.el = el;
            this.cb = cb;
            this.el.addEventListener('click', this.handler.bind(this), true);
        },

        unbind : function() {
            console.log('unbind');
            this.el.removeEventListener('click', this.handler, true);
        },

        handler : function() {
            this.cb();
            this.unbind();
        }
    }
};

var manager = {
    init : function() {
        var c = document.getElementById('c');
        controls.game.bind(c, this.action.bind(this));
    },

    action : function() {
        console.log('c clicked');
    }
};
manager.init(); 
```

然而，如果我以这种方式删除事件，它会起作用：

```
(...)

bind : function(el, cb) {
    this.el = el;
    this.cb = cb;
    var self = this;
    this.el.addEventListener('click', function() {
        self.cb();
        self.el.removeEventListener('click', arguments.callee, true);
    }, true);
}

(...) 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-04T18:47:56.200

`.bind`返回一个**新**函数。`this.handler.bind(this) !== this.handler`！您必须以某种方式存储对新函数的引用。

例如，将引用存储在变量中并使用闭包：

```
var handler = this.handler.bind(this);
this.el.addEventListener('click', handler, true);

this.unbind = function() {
    this.el.removeEventListener('click', handler, true);
} 
```

作为 的替代方法`arguments.callee`，您还可以为函数命名：

```
this.el.addEventListener('click', function handler() {
    self.cb();
    self.el.removeEventListener('click', handler, true);
}, true); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-04T19:03:42.950

我建议不要使用也需要更多内存的绑定，而是使用[以下内容](https://web.archive.org/web/20200203061532/http://ajaxian.com/archives/an-alternative-way-to-addeventlistener)：

```
var song = {
    handleEvent: function (event) {
      switch (event.type) {
        case: "click":
          console.log(this.name);
          break;
      }
    },
    name: "Yesterday"
};

songNode.addEventListener("click", song);
songNode.click(); // prints "Yesterday" into console 
```

您可以使用`obj`具有`handleEvent`属性的对象作为任何 DOM 对象上的处理程序来捕获其事件并将事件处理程序的上下文设置为该对象，`obj`而无需使用`Function.prototype.bind`.

这样你也可以删除处理程序，所以

```
songNode.removeEventListener("click", song); 
```

# c# - 计算 7 位二进制数的组合

> ID：15819252
> 
> 赞同：-4
> 
> 时间：2013-04-04T18:45:34.023
> 
> 标签：c#, for-loop, combinations

我正在尝试计算 7 位数字的所有组合。每个数字基本上可以占据两个值，这就是我称它为二进制数的原因。

数字由 FNMSDPL 表示。基本上我想要所有值的组合及其总和。

我写了下面的代码，但它不起作用。

```
 F[0] = 9.29;
        F[1] = -4.47;
        N[0] = 9.64;
        N[1] = -5.77;
        M[0]= -7.48;
        M[1] = -2.13;
        S[0] = 25.85;
        S[1]= -3.55;
        D[0]= 12.14;
        D[1] = -4.90;
        P[0] = 8.65;
        P[1]= -0.85;
        L[0] = 9.14;
        L[1]= -1.73;
        for (int i = 0; i < 2; i++)
        {
            for (int j = 0; j < 2; j++)
            {
                for (int k = 0; k < 2; k++)
                {
                    for (int l = 0; l < 2; k++)
                    {
                        for (int m = 0; m < 2; m++)
                        {
                            for (int n = 0; n < 2; n++)
                            {
                                for (int o = 0; 0 < 2; o++)
                                {
                                    double  count = F[i] + M[j] + L[k] + S[l] + D[m] + P[n] + L[o];
                                    System.Console.WriteLine(count);
                                }
                            }
                        }
                    }
                }
            }
        } 
```

错误信息：

指数数组的边界之外。

我在“double count =”行收到上述错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T18:49:54.590

Stack Overflow 上的字体选择可能已经解决了这个问题

```
for (int o = 0; 0 < 2; o++) 
```

条件应该是 using`o`而不是`0`. （提示：避免使用`o`or`O`作为变量名。）

编辑：这里的另一个问题（应该是递增`l`，而不是`k`）：

```
for (int l = 0; l < 2; k++) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T18:50:29.337

我想这不会按预期工作：

```
for (int l = 0; l < 2; k++) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T18:53:25.790

您可能应该使用比 7 个嵌套`for`循环更聪明的东西（因为正如其他答案所指出的那样，这非常容易出错，尤其是当您必须组成 14 个变量名时）。递归解决方案在这里会做得很好。

至于总和，您无需生成所有可能性即可知道所有 128 个可能数字的总和。观察每个二进制数字（0 或 1）在每个槽中恰好出现 64 次，因此总和仅为数组中 14 个浮点数之和的 64 倍。

# c++ - 浏览文件夹对话框窗口句柄 C++

> ID：15819255
> 
> 赞同：0
> 
> 时间：2013-04-04T18:45:38.007
> 
> 标签：c++, winapi

如何获取用户单击按钮时打开的对话框的句柄 HWND。我正在使用 Spy++ 来查找窗口类和标题，但它说没有找到这样的窗口。然后如何使用 Win API 在 C++ 中获取该对话框的句柄？

我希望我能够使用 FindWindow、GetParent、任何 WIN APi 函数等简单函数来做到这一点。我不喜欢注入东西或加载 DLL。谢谢

**更新：**

文件夹浏览器对话框被其他程序打开。我想从不同的程序，我的程序中获取它的句柄。谢谢。我现在最需要的是函数 WindowFromPoint

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:31:43.113

[可访问性](http://blogs.msdn.com/b/oldnewthing/archive/2013/03/25/10404940.aspx)将让您在没有 DLL 注入的情况下从其他进程捕获窗口创建事件。您可以修改示例以专门适应浏览窗口。这是我之前根据文章中的示例进行测试的示例。根据需要修改它：

```
#include <iostream>
#include <windows.h>

void CALLBACK proc(HWINEVENTHOOK hook, DWORD event, HWND hwnd, LONG obj, LONG child, DWORD thr, DWORD time) {
    if (hwnd && obj == OBJID_WINDOW && child == CHILDID_SELF) {
        switch (event) {
            case EVENT_OBJECT_CREATE: {
                std::cout << "Window created!\n";
                break;
            }

            case EVENT_OBJECT_DESTROY: {
                std::cout << "Window destroyed!\n";
                break;
            }
        }
    }
}

int main() {
    HWINEVENTHOOK hook = SetWinEventHook(EVENT_OBJECT_CREATE, EVENT_OBJECT_DESTROY, nullptr, proc, 0, 0, WINEVENT_OUTOFCONTEXT | WINEVENT_SKIPOWNPROCESS);

    MSG msg;
    while (GetMessage(&msg, nullptr, 0, 0)) {
        TranslateMessage(&msg);
        DispatchMessage(&msg);
    }

    if (hook) {
        UnhookWinEvent(hook);
    }
} 
```

# javascript - 更改第二列的颜色

> ID：15819260
> 
> 赞同：4
> 
> 时间：2013-04-04T18:45:48.913
> 
> 标签：javascript, jquery, html, css

我有一个 jQuery 响应表。
当您缩小浏览器窗口时，您可以看到不同的布局。

我想更改每个表的第二列值的颜色，但我不知道如何为第二列值提供 id 并更改其颜色。

在下面提供一个[**小提琴**](http://jsfiddle.net/bz2C4/37/)以及我的代码：

```
#page-wrap {
    margin: 50px;
}
/* 
        Generic Styling, for Desktops/Laptops 
        */
 table {
    width: 100%;
    border-collapse: collapse;
}
/* Zebra striping */
 tr:nth-of-type(odd) {
    background: #eee;
}
th {
    background: #1a4567;
    color: white;
    font-weight: bold;
}
td, th {
    padding: 6px;
    border: 1px solid #ccc;
    text-align: left;
}
/* 
        Max width before this PARTICULAR table gets nasty
        This query will take effect for any screen smaller than 760px
        and also iPads specifically.
        */
 @media only screen and (max-width: 760px), (min-device-width: 768px) and (max-device-width: 1024px) {
    /* Force table to not be like tables anymore */
    table, thead, tbody, th, td, tr {
        display: block;
    }
    /* Hide table headers (but not display: none;, for accessibility) */
    thead tr {
        position: absolute;
        top: -9999px;
        left: -9999px;
    }
    tr {
        border: 1px solid #ccc;
    }
    td {
        /* Behave  like a "row" */
        border: none;
        border-bottom: 1px solid #eee;
        position: relative;
        padding-left: 50%;
    }
    td:before {
        /* Now like a table header */
        position: static;
        /* Top/left values mimic padding */
        top: 6px;
        left: 6px;
        width: 45%;
        padding-right: 10px;
        white-space: nowrap;
    }
    /*
            Label the data
            */
    td:nth-of-type(1):before {
        content:"BOM Id";
    }
    td:nth-of-type(2):before {
        content:"Brand Name";
    }
    td:nth-of-type(3):before {
        content:"BOM Type";
    }
    td:nth-of-type(4):before {
        content:"BOM Description";
    }
    td:nth-of-type(5):before {
        content:"Edit";
    }
    td:nth-of-type(6):before {
        content:"Related";
    }
    td:nth-of-type(7):before {
        content:"Print";
    }
    td:nth-of-type(8):before {
        content:"ECO";
    }
    td:nth-of-type(9):before {
        content:"Dev";
    }
    td:nth-of-type(10):before {
        content:"Files";
    }
}
/* Smartphones (portrait and landscape) ----------- */
 @media only screen and (min-device-width : 320px) and (max-device-width : 480px) {
    body {
        padding: 0;
        margin: 0;
        width: 320px;
    }
}
/* iPads (portrait and landscape) ----------- */
 @media only screen and (min-device-width: 768px) and (max-device-width: 1024px) {
    body {
        width: 495px;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T18:55:58.780

如果您只想为第二列着色，您可以使用类似于：

```
td:nth-child(2) {
    background: #CCC
} 
```

* * *

[**演示**](http://jsfiddle.net/Tu25W/)- 更改第二列的颜色

* * *

如果您还想包含标题本身，您可以将其添加到 中`th`，类似于：

```
th:nth-child(2) {
    background: teal
} 
```

* * *

[**演示**](http://jsfiddle.net/aUJZB/)- 也更改第二列标题的颜色

* * *

如果你想每隔一列着色，而不仅仅是第二列，你可以使用奇数甚至类似于此：

```
th:nth-child(even) {
    background: teal;
}

td:nth-child(even) {
    background: #CCC;
} 
```

* * *

[**演示**](http://jsfiddle.net/LKa5V/)- 每隔一列应用颜色

* * *

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:02:53.870

对于每张桌子的第二列，您可以

```
td:nth-child(2),th:nth-child(2){} 
```

或者

```
td:first-child+td,th:first-child+th{} 
```

确保是否在早期 IE 中工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-08T17:55:54.773

这是适合您要求的[JSFiddle 。](http://jsfiddle.net/aQNE7/)我已经清理它并在**CSS**中添加了两行。

* * *

您提到您不知道如何将*ID*提供给较小分辨率设备的第二列。对于您的示例，第一列的*选择器*`td:before`是，第二列的选择器是`td`。更具体地说，以下 CSS 似乎可以完成您正在寻找的内容：

```
@media only screen and (max-width: 760px) {
   td {
      color:orange;
   }

   td:before {
      color:darkblue; 
   }
} 
```

从您的响应式转换来看，您的第一列实际上来自内容**CSS** *属性*，`td:before`而不是`th`标记。从语义的角度来看，这是错误的，但我猜你有强制这种行为的限制。

# php - Android中的错误“只有创建视图层次结构的原始线程才能触摸其视图”

> ID：15819267
> 
> 赞同：1
> 
> 时间：2013-04-04T18:46:08.200
> 
> 标签：php, android, mysql, error-handling

我正在创建一个使用 Android 和 PHP 登录的简单应用程序，但出现错误，谁能帮助我？我试图在作为客户端的 Android 和作为服务器端的 PHP/MySQL 之间建立关系，但仍然没有成功获得响应。

# AndroidLogin.java

```
package com.sencide;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;
import org.apache.http.protocol.HTTP;
import org.apache.http.util.EntityUtils;

import android.os.Bundle;
import android.os.StrictMode;
import android.app.Activity;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class AndroidLogin extends Activity implements OnClickListener {

     Button ok,back,exit;
     TextView result;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
        StrictMode.setThreadPolicy(policy);

     // Login button clicked
        ok = (Button)findViewById(R.id.btn_login);
        ok.setOnClickListener(this);

        result = (TextView)findViewById(R.id.lbl_result);

    }

    public void postLoginData() {
        // Create a new HttpClient and Post Header
        HttpClient httpclient = new DefaultHttpClient();
         Log.e("Responce-->","after httpclient");
        /* login.php returns true if username and password is equal to saranga */
        HttpPost httppost = new HttpPost("http://10.0.2.2/login.php");
        Log.e("Responce-->","after httppost");
        try {
            // Add user name and password
         EditText uname = (EditText)findViewById(R.id.txt_username);
         String username = uname.getText().toString();

         EditText pword = (EditText)findViewById(R.id.txt_password);
         String password = pword.getText().toString();

            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
            nameValuePairs.add(new BasicNameValuePair("username", username));
            nameValuePairs.add(new BasicNameValuePair("password", password));
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            Log.e("Responce-->","after using the list name pair");

            // Execute HTTP Post Request
            Log.w("SENCIDE", "Execute HTTP Post Request");
            HttpResponse response = httpclient.execute(httppost);
            Log.e("Responce-->","after execute the http response");
          //  String str = inputStreamToString(response.getEntity().getContent()).toString();
            String str = EntityUtils.toString(response.getEntity(), HTTP.UTF_8);
            //Log.w("SENCIDE", str);

            Log.e("Responce-->",""+str);

            if(str.toString().equalsIgnoreCase("true"))
            {
             Log.w("SENCIDE", "TRUE");
             result.setText("Login successful");  
            }else
            {
             Log.w("SENCIDE", "FALSE");
             result.setText(str);            
            }

        } catch (ClientProtocolException e) {
         e.printStackTrace();
        } catch (IOException e) {
         e.printStackTrace();
        }
    } 

    private StringBuilder inputStreamToString(InputStream is) {
        String line = "";
        StringBuilder total = new StringBuilder();
        // Wrap a BufferedReader around the InputStream
        BufferedReader rd = new BufferedReader(new InputStreamReader(is));
        // Read response until the end
        try {
         while ((line = rd.readLine()) != null) {
           total.append(line);
         }
        } catch (IOException e) {
         e.printStackTrace();
        }
        // Return full string
        return total;
       }

        /* login.php returns true if username and password is equal to test1 */

    @Override
    public void onClick(View view) {
        // TODO Auto-generated method stub
        final String resultText;
        if(str.toString().equalsIgnoreCase("true")) {
            resultText = "Login successful";
        }else {
            resultText = str;
        }

        if(view == ok){
             Thread t = new Thread(){

                    public void run(){
                        postLoginData();

                        result.post(new Runnable() {
                            public void run() {
                                result.setText(resultText);
                            }
                        });
                    }
                };
                t.start();

          }
    }

} 
```

# 原木猫

```
 04-04 19:04:20.504: E/Responce-->(457): after httpclient
04-04 19:04:20.517: E/Responce-->(457): after httppost
04-04 19:04:20.544: E/Responce-->(457): after using the list name pair
04-04 19:04:20.544: W/SENCIDE(457): Execute HTTP Post Request
04-04 19:04:20.824: E/Responce-->(457): after execute the http response
04-04 19:04:20.834: E/Responce-->(457): true
04-04 19:04:20.834: W/SENCIDE(457): TRUE
04-04 19:04:20.844: W/dalvikvm(457): threadid=9: thread exiting with uncaught exception (group=0x40015560)
04-04 19:04:20.912: E/AndroidRuntime(457): FATAL EXCEPTION: Thread-10
04-04 19:04:20.912: E/AndroidRuntime(457): android.view.ViewRoot$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views.
04-04 19:04:20.912: E/AndroidRuntime(457):  at android.view.ViewRoot.checkThread(ViewRoot.java:2932)
04-04 19:04:20.912: E/AndroidRuntime(457):  at android.view.ViewRoot.requestLayout(ViewRoot.java:629)
04-04 19:04:20.912: E/AndroidRuntime(457):  at android.view.View.requestLayout(View.java:8267)
04-04 19:04:20.912: E/AndroidRuntime(457):  at android.view.View.requestLayout(View.java:8267)
04-04 19:04:20.912: E/AndroidRuntime(457):  at android.view.View.requestLayout(View.java:8267)
04-04 19:04:20.912: E/AndroidRuntime(457):  at android.view.View.requestLayout(View.java:8267)
04-04 19:04:20.912: E/AndroidRuntime(457):  at android.view.View.requestLayout(View.java:8267)
04-04 19:04:20.912: E/AndroidRuntime(457):  at android.widget.TextView.checkForRelayout(TextView.java:5521)
04-04 19:04:20.912: E/AndroidRuntime(457):  at android.widget.TextView.setText(TextView.java:2724)
04-04 19:04:20.912: E/AndroidRuntime(457):  at android.widget.TextView.setText(TextView.java:2592)
04-04 19:04:20.912: E/AndroidRuntime(457):  at android.widget.TextView.setText(TextView.java:2567)
04-04 19:04:20.912: E/AndroidRuntime(457):  at com.sencide.AndroidLogin$1.run(AndroidLogin.java:136)
04-04 19:04:23.464: I/Process(457): Sending signal. PID: 457 SIG: 9 
```

# php代码

```
<?php
$host="localhost"; // Host name
$username="root"; // Mysql username
$password="root"; // Mysql password
$db_name="testlogin"; // Database name
$tbl_name="members"; // Table name

// Connect to server and select databse.
mysql_connect("$host", "$username", "$password")or die("cannot connect");
mysql_select_db("$db_name")or die("cannot select DB");

// username and password sent from form
$myusername=$_POST['username'];
$mypassword=$_POST['password'];

// To protect MySQL injection
$myusername = stripslashes($myusername);
$mypassword = stripslashes($mypassword);
$myusername = mysql_real_escape_string($myusername);
$mypassword = mysql_real_escape_string($mypassword);

$sql="SELECT * FROM $tbl_name WHERE username='$myusername' and password='$mypassword'";
$result=mysql_query($sql);

// Mysql_num_row is counting table row
$count=mysql_num_rows($result);

// If result matched $myusername and $mypassword, table row must be 1 row
if($count==1){
echo "true";
}
else {
echo "Login Failed";
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T18:55:32.580

解决方案在 logcat 的日志中：

```
04-04 18:38:47.596: E/AndroidRuntime(413): android.view.ViewRoot$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views. 
```

发布用户/密码正在工作。您可以得到“真实”响应，但随后您尝试在线程外部创建的视图中设置标签或类似内容。那是不行的。

```
result.setText("Login successful"); 
```

查看有关如何从其他线程更新视图的线程/进程的 Android SDK 文档：http: [//developer.android.com/guide/components/processes-and-threads.html](http://developer.android.com/guide/components/processes-and-threads.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:20:40.247

您不能在主 UI 线程之外对 android 视图进行更改。在您的示例中，您正在启动一个新线程并在其上运行 postLoginData() 。因为 postLoginData 还设置了 textview 的文本，所以您会收到此错误。

您应该：在新线程上执行 http 请求，然后在 UI 线程上更改文本。

有多种方法可以做到这一点。

*   [异步任务](http://developer.android.com/reference/android/os/AsyncTask.html)
*   [处理程序](http://developer.android.com/reference/android/os/Handler.html)

这种超级简单但可能不建议这样做的方法只是让你站起来。每当您在新线程中对 UI 进行更改时，您都希望这样做，因此在此示例中，当您设置结果文本时。

```
result.post(new Runnable() {
        public void run() {
            result.setText(str);
        }
    });
} 
```

它将在 UI 线程上运行。你真的应该看看我首先发布的两个选项，否则你会遇到更多麻烦。

** 编辑 ** 您只需替换此代码即可在主线程而不是新线程上发布。

```
if(str.toString().equalsIgnoreCase("true"))
{
 Log.w("SENCIDE", "TRUE");
 result.setText("Login successful");  
}else
{
 Log.w("SENCIDE", "FALSE");
 result.setText(str);            
} 
```

让它看起来像这样：

```
final String resultText;
if(str.toString().equalsIgnoreCase("true")) {
    resultText = "Login successful";
}else {
    resultText = str;
}
result.post(new Runnable() {
        public void run() {
            result.setText(resultText);
        }
    });
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T21:50:49.307

好的，我对您的代码进行了一些修改，它仍然很难看，需要大量重构，但请告诉我它是否引发任何异常。

编辑：将您的`username`和`password`传递给请求作为参数添加到您的`postLoginData(String password,String username)`方法。那应该这样做。

* * *

```
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;
import org.apache.http.protocol.HTTP;
import org.apache.http.util.EntityUtils;

import android.os.Bundle;
import android.os.StrictMode;
import android.app.Activity;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class AndroidLogin extends Activity implements OnClickListener {

    Button ok, back, exit;
    TextView result;
    EditText uname;
    EditText pword;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        StrictMode.ThreadPolicy policy = 
        new StrictMode.ThreadPolicy.Builder().permitAll().build();
        StrictMode.setThreadPolicy(policy);

        // Login button clicked
        ok = (Button) findViewById(R.id.btn_login);
        ok.setOnClickListener(this);
        uname = (EditText) findViewById(R.id.txt_username);
        pword = (EditText) findViewById(R.id.txt_password);
        result = (TextView) findViewById(R.id.lbl_result);

    }

    @Override
    public void onClick(View view) {
        // TODO Auto-generated method stub
        final String resultText;   

        final String username = uname.getText().toString();           
        final String password = pword.getText().toString();

        if (view == ok) {
            Thread t = new Thread() {

                public void run() {
                    postLoginData(username,password);
                }
            };
            t.start();

        }
    }

    private void postLoginData(String username,String password) {

        try {
            // Create a new HttpClient and Post Header
            HttpClient httpclient = new DefaultHttpClient();
            Log.e("Response-->", "after httpclient");
        /* login.php returns true if username and password is equal to saranga */
            HttpPost httppost = new HttpPost("http://10.0.2.2/login.php");
            Log.e("Response-->", "after httppost");

            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
            nameValuePairs.add(new BasicNameValuePair("username", username));
            nameValuePairs.add(new BasicNameValuePair("password", password));

            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            Log.e("Responce-->", "after using the list name pair");

            // Execute HTTP Post Request
            Log.w("SENCIDE", "Execute HTTP Post Request");
            HttpResponse response = httpclient.execute(httppost);
            Log.e("Responce-->", "after execute the http response");
            String str = EntityUtils.toString(response.getEntity(), HTTP.UTF_8);

            if (str.toString().equalsIgnoreCase("true")) {

                runOnUiThread(new Runnable() {
                    public void run() {
                        result.setText("Login Successful");

                    }
                });

            } else {
                runOnUiThread(new Runnable() {
                    public void run() {
                        result.setText("Duh");

                    }
                });
            }

        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

    }

} 
```

# c++ - 在外部 Unix 机器上执行程序时可能出现链接器错误

> ID：15819271
> 
> 赞同：1
> 
> 时间：2013-04-04T18:46:21.743
> 
> 标签：c++, linker-errors

我已经编写了一个程序，它可以在家里的 Ubuntu 12.10 发行版上按预期编译和运行（没有问题）。然后我将我的程序转移到我的大学服务器，在那里我第一次遇到错误（类似于[这个问题](https://stackoverflow.com/questions/7150409/libstdc-glibcxx-version-errors)）

`/usr/lib/libstdc++.so.6: version 'GLIBCXX_3.4.9' not found (required by ./main)`

正如线程中所建议的，我随后添加`-static-libstdc++`了链接器设置，以便我使用静态链接。现在我得到了错误

`undefined symbol: _ZNSt8time_getIwSt19istreambuf_iteratorIwSt11char_traitsIwEEE2idE`

我无法在网上找到任何有关此的信息，但我认为这可能是另一个链接器问题。如果有人有一些意见，我很乐意阅读它，因为我完全没有好主意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:54:37.843

您在构建时添加了 -static 吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:36:41.653

这是一个非常标准的示例，它针对一个版本的 C 运行时库进行编译并尝试针对另一个版本运行它。静态编译应该会有所帮助。

# javascript - 客户端浏览器上的日期格式

> ID：15819277
> 
> 赞同：0
> 
> 时间：2013-04-04T18:47:07.023
> 
> 标签：javascript, datetime

我从服务器获取日期作为 javascript 字符串 (GMT) 或 unix 时间戳 (GMT)。`var date = new Date(string)`我可以使用或将其转换为 javascript 日期对象 `var date = new Date(string)`

这为我提供了`date`具有适当系统时区时间的变量。

目前我正在展示这个-`date.toLocaleString()`

根据我的系统区域设置和时区，这给了我一个格式很好的日期/时间。如果客户端浏览器遵循它，我将使用它来自动适应 DST。

以前我只需要在 EST 中显示这个日期，但是当美国时间开始跟随 EDT 时，我被告知在 EST 中显示它。我认为这种方法可以简化根据用户的系统时间设置显示时间/日期。

这种方法是否有任何缺点或可能的错误？如果是，那么在浏览器中显示此日期的最佳方式是什么，以便根据用户（cient 浏览器）所在的时区（如果有的话，适应 DST）正确显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:54:03.407

正如评论中所指出的，输出可能会因用户设置而异。更可靠和更灵活的解决方案是[moment.js](http://momentjs.com/)，这是一个很棒的库。

```
moment("2013-04-04", "YYYY-MM-DD").format("MMM Do YY"); //"Apr 4th 13" 
```

# css - 下拉菜单中的顶级菜单项

> ID：15819284
> 
> 赞同：1
> 
> 时间：2013-04-04T18:47:23.590
> 
> 标签：css, drop-down-menu

我有一个完全用 CSS（没有 JS）制作的下拉菜单。当我将鼠标悬停在其下拉菜单上时，我希望顶级菜单项保持突出显示，但我不知道如何。

这是我正在谈论的示例：当您将光标放在下拉菜单上时，顶级项目会恢复为默认颜色...

有人可以帮忙吗？CSS中是否有可以解决这个问题的规则？

这是CSS：

```
nav {
    z-index: 10001;
    position: relative;
    display: block;
    width: 100%;
    height: 45px;
    text-transform: uppercase;
    border-bottom: 1px solid white;
    color: white;
    text-shadow: none;
    text-align: center
}
nav a {
    text-decoration: none
}
#topmenu {
    position: relative;
    text-align: left;
    left: 2%
}
nav ul {
    white-space: nowrap;
    list-style: none;
    position: relative;
    display: inline-block
}
nav ul ul {
    visibility: hidden;
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    transition: opacity .3s linear,visibility .3s linear;
    -webkit-transition: opacity .3s linear,visibility .3s linear;
    -moz-transition: opacity .3s linear,visibility .3s linear;
    -o-transition: opacity .3s linear,visibility .3s linear
}
nav ul ul li: last-child {
    -webkit-border-bottom-right-radius: 6px;
    -webkit-border-bottom-left-radius: 6px;
    -moz-border-radius-bottomright: 6px;
    -moz-border-radius-bottomleft: 6px;
    border-bottom-right-radius: 6px;
    border-bottom-left-radius: 6px;
    border-bottom: 1px solid #afafaf
}
nav ul li a: hover {
    padding: 13px 20px;
    color: green
}
nav ul ul {
    padding: 0;
    position: absolute
}
nav ul ul li {
    float: none;
    position: relative;
    border: 1px solid #afafaf;
    border-bottom: 1px solid #b7b7b7;
    border-top: 1px solid #fff;
    background: -webkit-linear-gradient(#eee 0,#d4d4d4 100%);
    background: linear-gradient(#eee 0,#d4d4d4 100%);
    background: -moz-linear-gradient(#eee 0,#d4d4d4 100%);
    background: -o-linear-gradient(#eee 0,#d4d4d4 100%);
    -moz-box-shadow: inset 2px 2px 5px #ccc;
    -webkit-box-shadow: inset 2px 2px 5px #ccc;
    box-shadow: inset 2px 2px 5px #ccc;
    filter: progid: DXImageTransform.Microsoft.Shadow(color=#ccc,Direction=134,Strength=5);
    filter: progid: DXImageTransform.Microsoft.gradient(startColorstr='#eeeeee',endColorstr='#d4d4d4')
}
nav ul ul li a {
    padding: 13px 20px;
    color: #063058
}
nav ul li: hover>ul {
    visibility: visible;
    opacity: 1;
    -moz-opacity: 1;
    -webkit-opacity: 1
}
nav ul li {
    float: left
}
#topmenu li a: hover {
    color: #fff
}
#topmenu li a: hover {
    color: green;
    background: -webkit-linear-gradient(#eee 0,#d4d4d4 100%);
    background: linear-gradient(#eee 0,#d4d4d4 100%);
    background: -moz-linear-gradient(#eee 0,#d4d4d4 100%);
    -moz-box-shadow: inset 2px 2px 5px #ccc;
    -webkit-box-shadow: inset 2px 2px 5px #ccc;
    box-shadow: inset 2px 2px 5px #ccc;
    filter: progid: DXImageTransform.Microsoft.Shadow(color=#ccc,Direction=134,Strength=5);
    filter: progid: DXImageTransform.Microsoft.gradient(startColorstr='#eeeeee',endColorstr='#d4d4d4')
}
nav ul li a {
    display: block;
    padding: 13px 20px;
    color: white
}
nav ul ul ul {
    position: absolute;
    left: 100%;
    top: 0
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:02:32.993

我无法让你的网站加载，所以我刚刚为你做了这个小提琴，有很多评论解释 CSS 我已经为你做了这个小提琴[http://jsfiddle.net/kevinPHPkevin/PknRT/](http://jsfiddle.net/kevinPHPkevin/PknRT/)

```
nav ul ul {
    display: none;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:20:07.310

这有效

```
#topmenu li: 悬停在 {
    背景：线性渐变（#EEEEEE 0px，#D4D4D4 100%）重复滚动 0 0 透明；
    box-shadow: 2px 2px 5px #CCCCCC inset;
    颜色：绿色；
}
```

我刚刚在那里复制了你的代码。

# html - 如何使用 XSLT 获取 XML 元素中的所有内容

> ID：15819288
> 
> 赞同：1
> 
> 时间：2013-04-04T18:47:37.063
> 
> 标签：html, xml, xslt, xpath

我试图让 XSLT 转换类似的东西

```
<foo>
    lorem ipsum
    <br />
    some more lorem ipsum
</foo> 
```

进入

```
<p>
    lorem ipsum
    <br />
    some more lorem ipsum
</p> 
```

我已经为 select 的属性尝试了无数的路径

```
<p><xsl:value-of select="/foo/*" /></p> 
```

但它们似乎都不起作用。甚至可以将元素的所有子元素作为纯文本获取吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:24:45.523

您可以使用`xsl:copy-of`：

```
<p><xsl:copy-of select="/foo/node()" /></p> 
```

但更可取的方法是将标识模板添加到您的 XSLT：

```
<xsl:template match="@* | node()">
  <xsl:copy>
    <xsl:apply-templates select="@* | node()" />
  </xsl:copy>
</xsl:template> 
```

然后利用它：

```
<p><xsl:apply-templates select="/foo/node()" /></p> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:48:48.697

让我知道以下内容是否适合您：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="/">  
  <xsl:for-each select="item/foo">
    <p>
      <xsl:value-of select="current()"/>
    </p>    
  </xsl:for-each> 
</xsl:template>
</xsl:stylesheet> 
```

用这个 XML 测试：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<item>
<foo>
    lorem ipsum
    <br />
    some more lorem ipsum
</foo>
<foo>
    lorem ipsum
    <br />
    some more lorem ipsum
</foo>
</item> 
```

# c++ - Visual Studio 2010 SP1 中的断言和未使用的变量

> ID：15819292
> 
> 赞同：2
> 
> 时间：2013-04-04T18:47:55.500
> 
> 标签：c++, visual-studio-2010, macros, assert

我在“发布”中使用下面的代码进行断言，已经有一段时间没有问题了。然后出现了 Visual Studio 2010 Pro SP1，事情向南[发展了，先生也发生了。克伦塔尔](https://stackoverflow.com/questions/4851075/universally-compiler-independant-way-of-implementing-an-unused-macro-in-c-c/4851173)。

问题是，当我有一段代码可以进行这样的健全性检查时：

```
#define ASSERT(condition, msg) do { (void)sizeof(condition); } while (0,0)
  // Note: (0,0) is to avoid warning C4127: conditional expression is constant

{
  int result = CallMeOnce();  // its side effects are the important stuff
  // perform additional sanity checks in debug
  ASSERT(result >= 0, "too low");
  ASSERT(result <= 100, "too high");
  ASSERT(!isPrime(result), "too prime");
} 
```

VS2010吐出一个`warning C4189: 'result' : local variable is initialized but not referenced`

我不知道如何解决这个问题：

*   类似的代码`(void)(condition)`将执行作为条件传递的任何表达式，这是一个否否
*   放入ASSERT`CallMeOnce()`表达式是不可能的
*   重构所有不同`CallMeOnce()`的 s 不是一种选择
*   我宁愿不必为了避免警告而在宏之外编写类似`(void)result`,`if (result == result) {}`或`UNREFERENCED_PARAMETER(result)`（或等效）的脚手架代码，因为它使代码更难阅读（污染），并且在 Debug 中编写代码时很容易忘记。另外：在很多地方！

我正在考虑为变量创建另一个宏（ASSERTU？），但感觉很……古怪！
有没有人找到更好的出路？

非常感谢！

编辑：澄清了对调用者级别的变量处理的偏好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T18:59:12.113

在你的断言宏中你有

```
(void)sizeof(condition); 
```

大概这段代码是别人写的，所以，解释一下：

演员表的作用`(void)`是告诉编译器你真的想让这个无所事事的表达式语句什么都不做。

现在为你做同样的事情`result`

这很容易，不是吗？有时解决方案只是盯着你的脸。;-)

* * *

顺便说一句，当这个结构被用来抑制关于未使用的形式参数的警告时，你可能想要添加一个重新定义的名字，比如

```
(void) unusedArg; struct unusedArg; 
```

这可以防止在以后维护代码时无意中使用该参数

但是，Visual C++ 产生的错误信息并不完全

* * *

可以添加无数复杂程度，但我认为即使重新定义名称也可能太过分了——成本大于优势，也许

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:03:37.623

您可以使用`UNREFERENCED_PARAMETER`宏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T17:23:13.557

看来我到了某个地方！

```
#define ASSERT(condition, msg) \
  do { \
    if (0,0) { \
      (void)(condition); \
    } \
  } while (0,0) 
```

**强制解释**：

`(void)(condition);`将抑制 C4189，但将执行传入的任何表达式或函数调用。

但是，`if (false) {...}`将确保无论（有效表达式）“...”是什么，它都不会被执行。代码优化阶段会将其视为死代码并将其丢弃（在我的测试中根本没有为块生成代码！）。

最后，猫头鹰技巧`(0,0)`将阻止 C4127，这首先似乎是一个非常无用的警告，但是嘿，编译输出中的混乱更少！

我能找到这个解决方案的唯一弱点是它`condition`需要是可编译的代码，所以如果你`#ifdef`- 删除了部分表达式，它会引发错误。可能它也在编译（虽然不是调用）被调用函数的代码；更多的研究将是有用的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T11:03:56.047

这要好得多。另外：表达式而不是语句

```
#define ASSERT(condition, msg) ( false ? (void)(condition) : (void)0 ) 
```

尽管您可能希望断言的调试版本和发布版本都具有相同的语义，但`do {...} while (0,0)`围绕它的 a 可能是合适的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-05T10:20:39.237

您可以使用成对的`__pragma(warning(push)) __pragma(warning(disable: 4127))`和`__pragma(warning(pop))`来使 C4127 静音`ASSERT`。

然后`(void)(true ? (void)0 : ((void)(expression)))`使 C4189 静音。

[这是我自己实现的断言宏](https://github.com/gpakosz/Assert)的摘录。

`PPK_ASSERT(expression)`宏最终将扩展为或`PPK_ASSERT_3(level, expression)`取决于`PPK_ASSERT_UNUSED(expression)`断言是启用还是禁用。

```
#define PPK_ASSERT_3(level, expression, ...)\
  __pragma(warning(push))\
  __pragma(warning(disable: 4127))\
  do\
  {\
    static bool _ignore = false;\
    if (PPK_ASSERT_LIKELY(expression) || _ignore || pempek::assert::implementation::ignoreAllAsserts());\
    else\
    {\
      if (pempek::assert::implementation::handleAssert(PPK_ASSERT_FILE, PPK_ASSERT_LINE, PPK_ASSERT_FUNCTION, #expression, level, _ignore, __VA_ARGS__) == pempek::assert::implementation::AssertAction::Break)\
        PPK_ASSERT_DEBUG_BREAK();\
    }\
  }\
  while (false)\
  __pragma(warning(pop)) 
```

和

```
#define PPK_ASSERT_UNUSED(expression) (void)(true ? (void)0 : ((void)(expression))) 
```

# maven - mvn jboss:deploy 失败并出现 NoClassDefFoundError

> ID：15819294
> 
> 赞同：0
> 
> 时间：2013-04-04T18:48:04.247
> 
> 标签：maven, deployment, jboss, maven-plugin, noclassdeffounderror

使用 JBoss Maven 插件将 EJB 项目部署到 JBoss 时，我在 JBoss 的控制台上收到关于此 EJB 项目的依赖项之一中的类的 NoClassDefFoundError。

这个依赖是用编译范围声明的。我应该使用另一个范围以便我的依赖项也部署到 JBoss 吗？或者我应该如何解决这个问题？

错误如下所示：

```
DEPLOYMENTS IN ERROR:
  Deployment "vfszip:/Users/hordine/projects/SoftBudget/soft-budget-ejb/target/soft-budget-ejb.jar/" is in error due to the following reason(s): java.lang.NoClassDefFoundError: br/com/pedra/j2eepatterns/facade/IEntityService 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T02:57:57.557

我了解到您已将 EJB 打包为 jar 文件。这意味着没有任何提供的依赖项与独立 jar 相同。

AFAIU，可能有以下3种可能的方式：-

1.  将它们打包为 an`ear`并将这些依赖项放入`ear/lib`. 请参阅[Maven EAR 插件](http://maven.apache.org/plugins/maven-ear-plugin/)了解更多信息。

2.  将它们打包为 an`war`并将这些依赖项放入`WEB-INF/lib`. 请参阅[Maven WAR 插件](http://maven.apache.org/plugins/maven-war-plugin/)了解更多信息。

3.  将它们打包为 an`jar`并将这些依赖项放在`classpath`or`application server lib`中。请参考您的应用服务器文档。

**已编辑：** 如果您使用的是`JavaEE 6`，则可以将其打包`EJB`为`war`文件。[Java EE 6 教程：在 WAR 模块中打包企业 Bean](http://docs.oracle.com/javaee/6/tutorial/doc/gipio.html)告诉我们：

> 企业 bean 通常提供 Web 应用程序的业务逻辑。在这些情况下，将***企业 bean*****打包到Web*应用程序的 WAR 模块*****中可以简化部署和应用程序组织。企业 bean 可以作为 Java 编程语言类文件打包在 WAR 模块中，也可以打包在捆绑在 WAR 模块中的 JAR 文件中。**
> 
>  **要`enterprise bean`在 a 中包含类文件`WAR module`，**类文件应该在`WEB-INF/classes`目录**中。
> 
> 要在 a`JAR file`中包含包含 `enterprise bean`s 的 a `WAR module`，**请将 添加`JAR`到`WEB-INF/lib`WAR 模块的目录中**。
> 
> *包含企业 bean 的 WAR 模块不需要`ejb-jar.xml`部署描述符。**如果应用程序使用`ejb-jar.xml`，它必须位于`WAR`模块的`WEB-INF`目录**中。***

 **我希望这可能会有所帮助。**

# json - 使用 php curl 为 multipart/form-data 发布 json 数据以通过 cakephp 2 上传文件

> ID：15819295
> 
> 赞同：0
> 
> 时间：2013-04-04T18:48:05.003
> 
> 标签：json, rest, cakephp, curl, multipartform-data

我想使用 php curl 为带有文件上传字段的 multipart/form-data 发布 json 数据。我在 cakephp 2 中尝试了这个操作：

```
public function json_post(){

    $this->autoRender = false;
    debug('json post test');

    $data = array('Post' => array(
        'subject' => 'test subject content',
        'body' => 'test body content'
        'fileName' => '/Users/mar/Pictures/cow_wall_90.jpg'
    ));                                                                    
    $data_string = json_encode($data);                                                                                   

    $ch = curl_init('http://www.mydomain.com/posts/phone_upload.json');                                                                      
    curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "POST");                                                                     
    curl_setopt($ch, CURLOPT_POSTFIELDS, $data_string);                                                                  
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);                                                                      
    curl_setopt($ch, CURLOPT_HTTPHEADER, array(                                                                          
            //'Content-Type: multipart/form-data', 
            'Content-Type: application/json',                                                                                
            'Content-Length: ' . strlen($data_string))                                                                       
    );                                                                                                                   

    $result = curl_exec($ch);

    debug($result); 

} 
```

fileName 相当于表单中的文件上传字段。主题和正文等同于表单中的文本字段。我错过了数据数组或 Content-Type 中的某些内容，但找不到问题。

感谢您的帮助，问候，马丁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T10:50:13.930

从[http://dtbaker.net/web-development/uploading-a-file-using-curl-in-php/](http://dtbaker.net/web-development/uploading-a-file-using-curl-in-php/)： **注意文件路径的@infront，这是神奇的部分。**

```
<?php
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_VERBOSE, 0);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/4.0 (compatible;)");
    curl_setopt($ch, CURLOPT_URL, _VIRUS_SCAN_URL);
    curl_setopt($ch, CURLOPT_POST, true);
    // same as <input type="file" name="file_box">
    $post = array(
        "file_box"=>"@/path/to/myfile.jpg",
    );
    curl_setopt($ch, CURLOPT_POSTFIELDS, $post); 
    $response = curl_exec($ch);
?> 
```

看来你错过了魔法部分。

您也可以从 cURL 切换到 CakePHP 的 HttpSocket，但这只是个人偏好。 [http://book.cakephp.org/2.0/en/core-utility-libraries/httpsocket.html](http://book.cakephp.org/2.0/en/core-utility-libraries/httpsocket.html)

# c - 编写 ARM 机器指令并从 C 中执行它们（在 Raspberry pi 上）

> ID：15819298
> 
> 赞同：6
> 
> 时间：2013-04-04T18:48:11.490
> 
> 标签：c, assembly, arm, jit, raspberry-pi

我正在尝试用 C 和 ARM 编写一些自我修改的代码。我之前问过一个关于 MIPS 的[类似问题](https://stackoverflow.com/questions/13162464/writing-mips-machine-instructions-and-executing-them-from-c)，现在正试图将项目移植到 ARM。
我的系统 := 树莓派、ARMv6、GCC 上的 Raspbian

有几件事我不确定：

*   ARM 是否需要 D 缓存回写/I 缓存无效（缓存刷新）？如果是这样，我们该怎么做？

我也尝试了一个例子

```
#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>

int inc(int x){ //increments x
    uint16_t *ret = malloc(2 * sizeof(uint16_t));

    *(ret + 0) = 0x3001; //add r0 1 := r0 += 1
    *(ret + 1) = 0x4770; //bx lr    := jump back to inc()

    int(*f)(int) = (int (*)(int)) ret;
    return (*f)(x);
}

int main(){
    printf("%d",inc(6)); //expect '7' to be printed
exit(0);} 
```

但我不断收到分段错误。我正在使用 aapcs 调用约定，我已经明白这是所有 ARM 的默认设置

如果有人指出我正确的方向，我将不胜感激

额外的问题（意思是，它实际上不需要回答，但知道会很酷） - 我“来自 MIPS 背景”，ARM 程序员在没有 0 寄存器的情况下怎么做？（例如，硬编码为值 0 的寄存器）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T07:13:17.043

阅读上的[缓存和自修改代码](http://blogs.arm.com/software-enablement/141-caches-and-self-modifying-code/)。`blogs.arm.com`文章还包括一个示例，它可以满足您的描述。

从文章中回答您的问题

> > ... ARM 架构通常被认为是修改后的哈佛架构。...
> > 
> > 纯哈佛架构的典型缺点是指令存储器不能从与数据存储器相同的地址空间直接访问，尽管此限制不适用于 ARM。**在 ARM 上，您可以将指令写入内存，但由于 D-cache 和 I-cache 不一致，新写入的指令可能会被 I-cache 的现有内容屏蔽，导致处理器执行旧的（或可能无效）说明。**

有关如何使缓存无效的信息，请参见[__clear_cache 。](http://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html)

如果您打算将指令推送到内存中，我希望您也了解 ARM/Thumb 指令集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-08T17:04:35.203

好的，所以这适用于我的树莓派。

```
#include <stdio.h>
#include <sys/mman.h>
#include <stdint.h>
#include <stdlib.h>

int inc(int x){ //increments x

    uint32_t *ret = mmap(NULL,
            2 * sizeof(uint32_t),  // Space for 16 instructions. (More than enough.)
            PROT_READ | PROT_WRITE | PROT_EXEC,
            MAP_PRIVATE | MAP_ANONYMOUS,
            -1,0);
    if (ret == MAP_FAILED) {
        printf("Could not mmap a memory buffer with the proper permissions.\n");
        return -1;
    }

    *(ret + 0) = 0xE2800001; //add r0 r0 #1 := r0 += 1
    *(ret + 1) = 0xE12FFF1E; //bx lr        := jump back to inc()

    __clear_cache((char*) ret, (char*) (ret+2));

    int(*f)(int) = (int (*)(int)) ret;
    return (*f)(x);
}

int main(){
    printf("%d\n",inc(6)); //expect '7' to be printed
exit(0);} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T21:29:11.770

有几个问题。

1.  您不会刷新 D-Cache 和 I-Cache，因此大多数时候 I-Cache 会从 L2 获取陈旧数据。在 linux 下有一个 libc/sys-call 可以为你做这件事。使用 __clear_cache(begin, end) 或 _ *builtin* _clear_cache(begin, end)。
2.  您输出 Thumb-Code，但您不关心如何调用您的代码。解决这个问题的最简单方法是使用一些 asm 代码来执行实际的 blx 调用并将地址与 1 进行或运算，因为该位设置处理器运行的模式。因为你的 malloc 地址将始终与单词边界，让你在 arm 模式下调用 thumb-code。

# wcf - 验证调用 WCF 服务的进程

> ID：15819300
> 
> 赞同：1
> 
> 时间：2013-04-04T18:48:15.093
> 
> 标签：wcf

我的团队正在清理一堆遗留代码并强行插入一个服务层。它是 .Net、VFP、ASP 和 ASP.Net 的组合。丑陋的 COM 对象和其他不良做法。

我们将逻辑从库和 UI 移动到 WCF 服务中，一次一个模块。我们必须对发出调用的用户进行身份验证，但我们还想对发出请求的进程进行身份验证。我们不希望任何可以访问服务的人能够编写脚本或应用程序来调用我们不知道的服务。

除了编写自定义 ISAPI 过滤器并在发送前破解请求之外，是否有一种“正常”方法来锁定服务以防止任何使用浏览器的人直接对 WCF 服务进行调用？

# bing-maps - Bing Maps REST api - 在哪里可以找到有关错误消息的更多详细信息？

> ID：15819301
> 
> 赞同：4
> 
> 时间：2013-04-04T18:48:16.553
> 
> 标签：bing-maps

我已经查看了[他们关于错误处理的页面，](http://msdn.microsoft.com/en-us/library/ff701703.aspx)但它只有对请求可能返回的状态代码的描述。如果我超过每天允许的请求数，必应是否提供信息一将返回什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:34:28.577

如果您已超过每天的请求数，则响应标头中可能包含一条信息。它必须符合使用条款中描述的限制。

请参阅您链接的页面底部，告诉我们您从这里得到了什么：

> 不返回结果的响应
> 
> 有时，处理服务请求的服务器可能会过载，并且您可能会收到一些不包含查询结果的响应，而这些查询通常会收到结果。要识别这种情况，请检查响应的 HTTP 标头。如果 HTTP 头 X-MS-BM-WS-INFO 设置为 1，最好等待几秒钟再试一次。

# jfreechart - 如何更改图例中元素的形状 - jFreeChart？

> ID：15819308
> 
> 赞同：2
> 
> 时间：2013-04-04T18:48:39.193
> 
> 标签：jfreechart, shape, legend

如何在不更改图表图形的情况下更改 jFreeChart 的图例元素的形状？

![在此处输入图像描述](https://i.stack.imgur.com/oVWEX.png)

我已经准备好了时间序列图。我需要将图例中的现有数据标记更新为具有定义颜色的简单线。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T08:24:29.370

首先*不要*`LegendTitle`在图表中添加 a 。这通常由您`ChartFactory`或您的`JFreeChart`构造函数的参数控制。两者`CategoryPlot`都有`XYPlot`一个`setFixedLegendItems()`方法，在[这里](https://stackoverflow.com/a/15001231/230513)提到，您可以使用它来添加任意图例项的集合。

# php - 使用 ajax 和 PHP 打开页面

> ID：15819309
> 
> 赞同：0
> 
> 时间：2013-04-04T18:48:39.273
> 
> 标签：php, ajax

我想用 ajax 打开一个页面，并用 ajax 在浏览器 url 中显示链接。当然，页面不会重新加载整个页面，只会重新加载内容。这是我的代码。但我一直有一个错误**“注意：未定义的索引：第 2 行 C:\xampp\htdocs\www\html5-history-api\menu1.php 中的 rel ”**

我希望这个错误消失...

**header.php：**

```
<br>Header Content from header.php</br></br>
<style>
#menu{font-size:20px;}
#content{font-size:30px;}
</style>
<script language="javascript" src="jquery-1.4.4.min.js"></script>
<script>
$(function(){
    $("a[rel='tab']").click(function(e){
        //e.preventDefault(); 
        /*  
        if uncomment the above line, html5 nonsupported browers won't change the url but will display the ajax content;
        if commented, html5 nonsupported browers will reload the page to the specified link. 
        */

        //get the link location that was clicked
        pageurl = $(this).attr('href');

        //to get the ajax content and display in div with id 'content'
        $.ajax({url:pageurl+'?rel=tab',success: function(data){
            $('#content').html(data);
        }});

        //to change the browser URL to 'pageurl'
        if(pageurl!=window.location){
            window.history.pushState({path:pageurl},'',pageurl);    
        }
        return false;  
    });
});

/* the below code is to override back button to get the ajax content without reload*/
$(window).bind('popstate', function() {
    $.ajax({url:location.pathname+'?rel=tab',success: function(data){
        $('#content').html(data);
    }});
});
</script>
<div id='menu'>
    <a rel='tab' href='http://localhost/www/html5-history-api/menu1.php'>menu1</a> | 
    <a rel='tab' href='http://localhost/www/html5-history-api/menu2.php'>menu2</a> | 
    <a rel='tab' href='http://localhost/www/html5-history-api/menu3.php'>menu3</a>
</div> 
```

和menu1.php（menu2和3同1）

```
<?php 
if($_GET['rel']!='tab'){
    include 'header.php';
    echo "<div id='content'>";
}
?>
menu1 content in menu1.php
<?php 
if($_GET['rel']!='tab'){
    echo "</div>";
    include 'footer.php';
}?> 
```

所以，是的，代码有效，但我不喜欢我的代码中有错误，我不知道该怎么做。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T18:54:54.783

正如警告所说，您没有定义数组索引。你的代码应该是

```
if (isset($_GET['rel']) && ($_GET['rel'] != 'tab')) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T18:55:54.917

尝试从以下位置更新它：

```
if($_GET['rel']!='tab'){ 
```

对此：

```
if(isset($_GET['rel']) ? $_GET['rel']!='tab')){ 
```

看看能不能解决。

# scala - Scala：为什么不强制存在类型声明的下限？

> ID：15819313
> 
> 赞同：3
> 
> 时间：2013-04-04T18:48:52.520
> 
> 标签：scala, types, covariance, existential-type, type-bounds

假设在 Scala repl 中做了以下声明：

```
class Animal
class Bird extends Animal
class Chicken extends Bird
type SubType = t forSome { type t <: Bird }
type SuperType = t forSome { type t >: Bird } 
```

正如我所料，`SubType`是一种符合`Bird`. 由于`Animal`是 的超类`Bird`，因此类型的变量`SubType`不能保存类型的值`Animal`：

```
scala> val foo: SubType = new Animal
<console>:10: error: type mismatch;
 found   : Animal
 required: SubType
       val foo: SubType = new Animal 
```

然而这个推论并不像我预期的那样：

```
scala> val foo: SuperType = new Chicken
foo: SuperType = Chicken@1fea8dbd 
```

分配成功，这些也是如此：

```
scala> val foo: SuperType = 2
foo: SuperType = 2

scala> val foo: SuperType = "wtf?"
foo: SuperType = wtf?

scala> 
```

同样，这里是`SuperType`：

```
type SuperType = t forSome { type t >: Bird } 
```

根据[SLS 4.3](http://www.scala-lang.org/docu/files/ScalaReference.pdf)，

> *类型声明* **type** *t [tps ] >: L <: U*将*t*声明为具有下限类型*L*和上限类型*U*的抽象类型。

所以我声明`t`是一个具有下界的抽象类型`Bird`。 `Chicken`不是 的超类`Bird`，既不是`String`也不是`Int`。

我想这可能是因为 a`Chicken`是一个`Any`并且 a`SuperType`可以存储一个`Any`. 但是，如果我将声明更改为`SuperType`：

```
type SuperType = t forSome { type t >: Bird <: Animal} 
```

设置什么都没有的上限`Animal`似乎没有改变。

# 问题

## 第一的

我如何分配类型值`Chicken` `Int`和存在子句允许`String`的变量和？`SuperType``{ type t >: Bird }``{ type t >: Bird <: Animal}`

## 第二

引用规范中“抽象”一词的含义是什么，“A*类型声明* **类型** *t [tps]>：L <：U*声明*t*是抽象类型......”如果没有“抽象”这个词吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:50:04.780

我认为混淆是在使用术语“约束”和“约束”之间。"<:" 和 ">:" 语法结构用于指定类型约束，而不是边界。当你说

```
{ type t >: Bird } 
```

您只是限制类型“t”，使得该类型的居民必须与 Bird 共享一个超类。由于 Chicken 和 Bird 都扩展了 Animal，因此满足了约束，并且 Scala 允许赋值。这也是您的“虚假”分配起作用的原因（String 和 Int 都与 Bird 共享超类 Any。您提出的后一个约束

```
{ type t >: Bird <: Animal } 
```

适当地限制了 String 和 Int 的示例，因为 String 或 Int 的类型层次结构中不存在满足作为 Bird 的超类型同时也是 Animal 的子类型的约束的类型。但是，这仍然允许您进行初始分配。

编辑：关于 SO 的其他答案说两者都称为边界。显示我知道多少。:)

# ruby-on-rails-3 - haml-rails 在生产中不起作用

> ID：15819316
> 
> 赞同：1
> 
> 时间：2013-04-04T18:49:14.690
> 
> 标签：ruby-on-rails-3, haml

过去两天我一直在工作（似乎还不够长）来`haml-rails`开始使用这个 RoR 应用程序。我得到的回溯是这样的：

```
ActionView::MissingTemplate (Missing template customcare360/login, application/login with {:locale=>[:en], :formats=>[:html], :handlers=>[:erb, :builder]}. Searched in:
  * "/var/www/clients/client1/web54/capistrano/releases/20130403223833/app/views"
):
  actionpack (3.2.11) lib/action_view/path_set.rb:58:in `find'
  actionpack (3.2.11) lib/action_view/lookup_context.rb:109:in `find'
  actionpack (3.2.11) lib/action_view/renderer/abstract_renderer.rb:3:in `find_template'
  actionpack (3.2.11) lib/action_view/renderer/template_renderer.rb:34:in `determine_template'
  actionpack (3.2.11) lib/action_view/renderer/template_renderer.rb:10:in `render'
  actionpack (3.2.11) lib/action_view/renderer/renderer.rb:36:in `render_template'
  actionpack (3.2.11) lib/action_view/renderer/renderer.rb:17:in `render'
  actionpack (3.2.11) lib/abstract_controller/rendering.rb:110:in `_render_template'
  actionpack (3.2.11) lib/action_controller/metal/streaming.rb:225:in `_render_template'
  actionpack (3.2.11) lib/abstract_controller/rendering.rb:103:in `render_to_body'
  actionpack (3.2.11) lib/action_controller/metal/renderers.rb:28:in `render_to_body'
  actionpack (3.2.11) lib/action_controller/metal/compatibility.rb:50:in `render_to_body'
  actionpack (3.2.11) lib/abstract_controller/rendering.rb:88:in `render'
  actionpack (3.2.11) lib/action_controller/metal/rendering.rb:16:in `render'
  actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:40:in `block (2 levels) in render'
  activesupport (3.2.11) lib/active_support/core_ext/benchmark.rb:5:in `block in ms'
  /usr/local/rvm/rubies/ruby-2.0.0-p0/lib/ruby/2.0.0/benchmark.rb:296:in `realtime'
  activesupport (3.2.11) lib/active_support/core_ext/benchmark.rb:5:in `ms'
  actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:40:in `block in render'
  actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:83:in `cleanup_view_runtime'
  activerecord (3.2.11) lib/active_record/railties/controller_runtime.rb:24:in `cleanup_view_runtime'
  actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:39:in `render'
  actionpack (3.2.11) lib/action_controller/metal/implicit_render.rb:10:in `default_render'
  actionpack (3.2.11) lib/action_controller/metal/implicit_render.rb:5:in `send_action'
  actionpack (3.2.11) lib/abstract_controller/base.rb:167:in `process_action'
  actionpack (3.2.11) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (3.2.11) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
  activesupport (3.2.11) lib/active_support/callbacks.rb:414:in `_run__3579697130236064177__process_action__869676858511540114__callbacks'
  activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
  activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
  activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
  actionpack (3.2.11) lib/abstract_controller/callbacks.rb:17:in `process_action'
  actionpack (3.2.11) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
  activesupport (3.2.11) lib/active_support/notifications.rb:123:in `block in instrument'
  activesupport (3.2.11) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (3.2.11) lib/active_support/notifications.rb:123:in `instrument'
  actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
  actionpack (3.2.11) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
  activerecord (3.2.11) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (3.2.11) lib/abstract_controller/base.rb:121:in `process'
  actionpack (3.2.11) lib/abstract_controller/rendering.rb:45:in `process'
  actionpack (3.2.11) lib/action_controller/metal.rb:203:in `dispatch'
  actionpack (3.2.11) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
  actionpack (3.2.11) lib/action_controller/metal.rb:246:in `block in action'
  actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `call'
  actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
  actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:36:in `call'
  journey (1.0.4) lib/journey/router.rb:68:in `block in call'
  journey (1.0.4) lib/journey/router.rb:56:in `each'
  journey (1.0.4) lib/journey/router.rb:56:in `call'
  actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:601:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
  rack (1.4.5) lib/rack/etag.rb:23:in `call'
  rack (1.4.5) lib/rack/conditionalget.rb:25:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/head.rb:14:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/flash.rb:242:in `call'
  rack (1.4.5) lib/rack/session/abstract/id.rb:210:in `context'
  rack (1.4.5) lib/rack/session/abstract/id.rb:205:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/cookies.rb:341:in `call'
  activerecord (3.2.11) lib/active_record/query_cache.rb:64:in `call'
  activerecord (3.2.11) lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
  activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `_run__3196186370685956669__call__1689534214956595528__callbacks'
  activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
  activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
  activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
  actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
  railties (3.2.11) lib/rails/rack/logger.rb:32:in `call_app'
  railties (3.2.11) lib/rails/rack/logger.rb:16:in `block in call'
  activesupport (3.2.11) lib/active_support/tagged_logging.rb:22:in `tagged'
  railties (3.2.11) lib/rails/rack/logger.rb:16:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/request_id.rb:22:in `call'
  rack (1.4.5) lib/rack/methodoverride.rb:21:in `call'
  rack (1.4.5) lib/rack/runtime.rb:17:in `call'
  activesupport (3.2.11) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
  rack (1.4.5) lib/rack/lock.rb:15:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/static.rb:62:in `call'
  rack-cache (1.2) lib/rack/cache/context.rb:136:in `forward'
  rack-cache (1.2) lib/rack/cache/context.rb:245:in `fetch'
  rack-cache (1.2) lib/rack/cache/context.rb:185:in `lookup'
  rack-cache (1.2) lib/rack/cache/context.rb:66:in `call!'
  rack-cache (1.2) lib/rack/cache/context.rb:51:in `call'
  railties (3.2.11) lib/rails/engine.rb:479:in `call'
  railties (3.2.11) lib/rails/application.rb:223:in `call'
  railties (3.2.11) lib/rails/railtie/configurable.rb:30:in `method_missing'
  unicorn (4.6.2) lib/unicorn/http_server.rb:552:in `process_client'
  unicorn (4.6.2) lib/unicorn/http_server.rb:632:in `worker_loop'
  unicorn (4.6.2) lib/unicorn/http_server.rb:500:in `spawn_missing_workers'
  unicorn (4.6.2) lib/unicorn/http_server.rb:142:in `start'
  unicorn (4.6.2) bin/unicorn:126:in `<top (required)>'
  /var/www/ageless360-patient.theblsgroup.net/capistrano/shared/bundle/ruby/2.0.0/bin/unicorn:23:in `load'
  /var/www/ageless360-patient.theblsgroup.net/capistrano/shared/bundle/ruby/2.0.0/bin/unicorn:23:in `<main>' 
```

我已经尝试手动将“haml-rails”加载到我的`config/application.rb`. 我的 Gemfile 看起来像这样：

```
source 'https://rubygems.org'

gem 'rails', '3.2.11'

# Environment-independent gems
gem 'mysql2'
gem 'json'

# Use unicorn as the app server
gem 'unicorn'

# HAML up the HTML.
gem 'haml'
gem 'haml-rails'

group :development do
  # Provides an intuitve means of debugging in the browser.
  gem 'better_errors'

  # Remove unnecessary assets from being logged at dev time.
  gem 'quiet_assets'

  # Deploy with Capistrano
  gem 'capistrano'
  gem 'capistrano-ext'
  gem 'capistrano-unicorn'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'
  gem 'jquery-rails'
end 
```

# php - 从 JSON 中获取属性值

> ID：15819317
> 
> 赞同：0
> 
> 时间：2013-04-04T18:49:26.090
> 
> 标签：php, json

```
object(stdClass)#43 (3) { ["@promo"]=> string(4) "true" ["@rate"]=> string(6) "308.69" ["@baseRate"]=> string(6) "342.99" } 
```

以上是 JSON 文件的部分输出。原始文件实际上是一个 XML 文件。

```
<NightlyRate promo="true" rate="227.09" baseRate="283.86"/> 
```

我使用 jsondecode 将 XML 转换为 json。但是，我不知道如何获取每个属性的值。

例如，我想使用 JSON 获得 227.09 和 283.86。

非常感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T19:07:54.477

我确实觉得整个过程有点奇怪，但是您可以`stdClass`使用以下语法访问无效的变量名属性：

```
$stdClassVar->{"@rate"}; 
```

# c# - 如何使用 Windows 窗体创建和连接自定义用户按钮/控件和线条

> ID：15819318
> 
> 赞同：20
> 
> 时间：2013-04-04T18:49:32.253
> 
> 标签：c#, winforms, custom-controls

我正在尝试创建一些自定义按钮或用户控件，如建议的 GUI 中所示。功能应该如下：

图形或配置以图形方式创建。

控件可以从工具栏中拖动或通过鼠标右键单击/下拉插入

通过从一个控件拖动到另一个控件，它们应该由线条连接

切换应该将视图从带有选项的控件切换到简单视图

GUI 视图 - 带有选项的控件： ![带有选项的 GUI 视图控件](https://i.stack.imgur.com/e6nUL.jpg)

GUI 视图 - 最小化： ![在此处输入图像描述](https://i.stack.imgur.com/XVKRB.jpg)

我可以使用 Windows 窗体中的哪些功能来创建连接线？

如果它们是通过使用绘制线条的功能创建的，我如何确保控件捕捉到线条？..

我正在使用 Visual Studio 2010 Express 在 C# 中编程。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-04-04T20:57:55.240

行。[这是我为类似需求](https://stackoverflow.com/questions/15579069/graph-nodes-coordinates-evaluation/15580293#)创建的示例的轻微修改

我的目的是表明对于任何需要认真 UI 的人来说，winforms 不再是一种选择。原始样品是在 3 个工时创建的。

您可能会惊讶地发现，包含所有这些项目（节点和连接器）的容器实际上是一个`ListBox`.

值得注意的事情：

*   “NodeXX”文本包含在一个`Thumb`控件中，可以单击和拖动。
*   也可以选择连接器并在它们被选中时显示漂亮的动画。
*   左侧面板允许编辑当前选定对象的值。
*   UI 的功能与包含它的数据完全分离。`int`因此，所有这些节点和连接器都是具有简单`double`属性的简单类，可以从数据库或任何其他数据源加载/保存。
*   如果您不喜欢点击序列的完成方式，请绘制节点和连接器，这可以完全满足您的需求。
*   WPF 规则。

**编辑：**

第二个版本，这次更类似于您的原始屏幕截图：

![在此处输入图像描述](https://i.stack.imgur.com/7h0Of.png)

![在此处输入图像描述](https://i.stack.imgur.com/syxdz.png)

*   `SnapSpot`我在等式中添加了的概念。这些是您在节点周围看到的红色小半圆，实际上是`Connector`s 所绑定的。
*   我还更改了`Connector`DataTemplate 以使用[`QuadraticBezierSegment`](http://msdn.microsoft.com/en-us/library/ms747393.aspx)基于

    ```
    Connector.Start.Location,
    Connector.MidPoint, and 
    Connector.End.Location 
    ```

这允许将曲线用作连接器，而不仅仅是直线。

*   `Thumb`当您选择（单击） a `Connector`（在屏幕截图中可见）时，会出现一个小红方块，这将允许您移动`MidPoint`曲线的 。
*   您还可以在将鼠标悬停`TextBoxes`在左侧面板中的“中点”下方时滚动鼠标滚轮来操纵该值。
*   “全部折叠”`CheckBox`允许在完整框和小框之间切换，如屏幕截图所示。
*   `SnapSpot`s 有一个介于 0 和 1 之间的`OffsetX` `OffsetY`值，对应于它们相对于 parent 的位置`Node`。这些不限于 4 个，实际上可以是每个`Node`.
*   `ComboBoxes`and`Buttons`没有任何功能，但这只是在类中创建相关属性和命令并将[它们](http://wpftutorial.net/DelegateCommand.html)`Node`绑定到的问题。

**编辑2：**

使用更好的版本更新了下载链接。

**编辑 10/16/2014**：由于很多人似乎对此感兴趣，我将源代码上传到[GitHub](https://github.com/High-Core/WPFSamples/tree/master/src/WPFSamples/Samples/HousePlan)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:24:51.820

我猜这是一个图形类型的问题。节点是房间，边是连接房间的线。您可以引入另一个类（例如 Connection 类）来描述节点如何连接到边。例如，您的大厅连接到卧室，不一定使用直线。Graphics.DrawBezier 允许您绘制曲线，但需要一个点数组。这就是 Connection 类的用武之地。一些代码可能会有所帮助......

```
 class Room
   {
     public Room(String name, Point location);
     public void Draw(Graphics g);
   }

   class Connection
   {
     public void Add(Point ptConnection);
     public void Add(Point[] ptConnection);

     // Draw will draw a straight line if only two points or will draw a bezier curve
     public void Draw(Graphics g);
   }

   class House // basically a graph
   {
     public void Add(Room room);
     public void AddRoomConnection(Room r1, Room r2, Connection connector);

     // draw, draw each room, then draw connections.
     public void Draw(Graphics g);
   }

   void Main()
   {
      House myHouse = new House();
      Room hall = new Room("Hall", new Point(120,10);
      Room bedroom1 = new Room("Bedroom1", Point(0, 80));
      Connection cnHallBedroom = new Connection();
      cn.Add(new Point());  // add two points to draw a line, 3 or more points to draw a curve.
      myHouse.AddRoomConnection(hall, bedroom1, cnHallBedroom);
   } 
```

这是基本方法，可能不是最好的，但可以作为起点。

# c++ - 比较两个图表

> ID：15819319
> 
> 赞同：8
> 
> 时间：2013-04-04T18:49:32.847
> 
> 标签：c++, algorithm, data-structures, graph

我需要比较许多图表（最多几百万个图表比较），我想知道最快的方法是什么。

图的顶点最多可以有 8 个邻居/边，顶点的值可以是 0 或 1。旋转图仍然是相同的图，每个图都有相同数量的顶点。

图表可能如下所示：

![图表示例](https://i.imgur.com/SlARAoM.png)

现在，我通过从第一个图中获取一个顶点并将其与第二个图中的每个顶点进行比较来比较图。如果我找到相同的顶点，那么我检查两个顶点的邻居是否相同，然后重复此操作，直到我知道图形是否相同。

这种方法太慢了。在不丢弃肯定不同的图的情况下，比较数千个图与大约一百个顶点需要 40 多秒。

我正在考虑为每个图表计算唯一值，然后只比较值。我试图这样做，但我只设法提出如果相等则图形可能相等的值，如果值不同则图形也不同。
如果我的程序比较这些值，那么它会在大约 2.5 秒内计算所有内容（这仍然太慢）。

将顶点添加到该图并更新边的最佳/最快方法是什么？现在我正在存储这个图，`std::map< COORD, Vertex >`因为我认为搜索顶点更容易/更快。
COORD 是游戏板上的顶点位置（顶点的位置与比较图形无关），顶点是：

```
struct Vertex
{
    Player player; // Player is enum, FIRST = 0, SECOND = 1
    Vertex* neighbours[8];
}; 
```

此图表示 Gomoku 的当前棋盘状态，在棋盘边缘环绕，棋盘大小为 n*n，其中 n 最大为 2^16。

我希望我在写这篇文章时没有犯太多错误。我希望有一个人可以帮助我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T19:30:40.987

首先，您需要将每个图转换为一致的表示，这样做的自然方法是创建图的有序表示。

第一级排序是通过根据邻居的数量进行分组来实现的。

然后，通过将其邻居值（0 和 1）映射到二进制数上，对具有相同数量邻居的每组节点进行排序，然后使用该二进制数在组节点之间强制执行顺序。

然后，您可以使用散列函数以有序形式迭代每个组的每个节点。然后可以使用散列值来提供加速查找

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T19:21:31.380

您要解决的问题称为[图同构](http://en.wikipedia.org/wiki/Graph_isomorphism_problem)。

问题出在 NP 中（尽管不知道它是否是 NP-Complete）并且没有找到它的多项式时间算法。

您描述的算法似乎需要指数时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T19:14:21.057

我很抱歉，因为我还没有能力发表评论。这并不完全是一个答案，而是一个可能的优化建议。

我建议尝试记忆（存储所有发现不同的顶点对），以便下次比较这两个顶点时，您只需进行简单的查找和回复。这可能会提高性能（或恶化性能），具体取决于您拥有的图表类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T20:08:55.123

您已经发现，检查同构可以通过检查一个边框的所有 n*n 移位乘以另一个边框的 8 次旋转来完成，因此具有`O(n^3)`复杂性。

这可以简化为`O(n^2)`。让我们只在一个方向上移动，比如移动`x`轴。然后我们只需要找到合适的`y`-offset。为此，我们将两个图的元素连接如下：

```
. . 1 .            0 . . 3
0 1 . .     =>     0 1 2 .     =>     0 3 0 1 2 0 2
. 0 . .            0 . 2 .
_______            
1 2 3 4            ^---- a 0 indicates start of a row 
```

我们得到两个大小的数组，`n`我们必须检查一个是否是另一个的循环置换。为此，我们将数组 a 与其自身连接并搜索另一个。

例如，如果两个数组是`a=0301202`并且我们使用 KMP 或类似方法进行`b=0203012`搜索`0203012`，它会及时运行（我们可以摆脱整个预处理，因为第一个数组总是相同的）。`03012020301202``O(n + 2n)=O(n)`

将此`O(n)`x-check 与`n`y-shifts 和`8`旋转相结合`O(n^2)`，通过使用`O(n)`额外的空间来提供整体复杂性。

# javascript - 如何添加仅 js 和 css 的智能手机？

> ID：15819320
> 
> 赞同：3
> 
> 时间：2013-04-04T18:49:32.853
> 
> 标签：javascript, html, css, responsive-design, media-queries

我想知道如何仅在通过智能手机访问网站时添加 css 和 javascript 代码。

目前我正在使用**媒体查询**，但它并没有解决问题，因为目前一些智能手机**的分辨率**甚至比一些平板电脑和台式机还要高。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T18:51:02.080

您可以通过使用特征检测。[Modernizr](http://modernizr.com/)检查触摸事件。

或者，您可以使用用户代理 - 查看[http://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)

然而，最好的选择是使用流体网格网站设计来设计您的网站，以便您的网站能够很好地适应移动设备、平板电脑和笔记本电脑/台式机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T18:51:54.507

如果您尝试检测高分辨率屏幕（这不仅仅意味着智能手机！），请使用`device-pixel-ratio`媒体查询：[http ://css-tricks.com/snippets/css/retina-display-media-query/](http://css-tricks.com/snippets/css/retina-display-media-query/)

您实际上要检测的智能手机呢？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-04T18:52:03.750

如果可能，请尝试检查服务器端的 User-Agent HTTP 标头，并动态包含必要的 css 和 js 文件。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-04T18:52:26.057

您可以检查浏览器的用户代理以查看用户是否从智能手机连接。

查看此[相关帖子](https://stackoverflow.com/questions/5122566/simple-smart-phone-detection)

# asp.net-mvc - 如何找出文件来自哪个文件上传输入？

> ID：15819322
> 
> 赞同：1
> 
> 时间：2013-04-04T18:49:37.120
> 
> 标签：asp.net-mvc, file-upload

在我的操作方法中，我目前将 3 个文件作为单独的 HttpPostedFileBase 对象传递。我想将它们作为 IEnumerable 容器传递，但我如何才能找出它们来自哪个上传控件？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:58:52.203

不确定我是否完全理解没有代码的意思，但是...

```
public ActionResult Upload(HttpPostedFileBase file1, HttpPostedFileBase file2, HttpPostedFileBase file3) { 
```

在您接收帖子的方法中，file1、2、3 等是客户端字段的名称，将为您提供该信息。

如果以上不是您需要的，请提供更多信息。

# javascript - Google 电子表格自定义函数：运行的脚本过多

> ID：15819330
> 
> 赞同：0
> 
> 时间：2013-04-04T18:49:57.677
> 
> 标签：javascript, google-apps-script, google-sheets, google-apps

我正在尝试在 Google 电子表格中创建自定义方法。我有以下方法来替换缺少的 WEEKNUM 方法。（我留给第二个参数以允许上传 excel 文件。）

```
function WEEKNUM(inDate, dummy){
  return Utilities.formatDate(inDate, "GMT", "w");
} 
```

我在一个电子表格中两次（800 次）在大约 400 行中调用方法。一些公式已完成，但对于其他公式，我收到此错误消息。

```
error: There are too many scripts running simultaneously for this Google user account. 
```

我能做些什么来解决这个问题吗？我对 800 次执行非常了解，但并不比预期的内置函数更多。我知道有其他方法可以计算周数（例如`=LEFT(TEXT(A2; "w d"); 2)`），但是我想知道是否甚至可以创建不受此无形上限影响的自定义公式函数。

预先感谢您的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-06T13:58:19.967

Have you custom function receive a range and output an array. No need to use an arrayformula, which also wont work on a custom function

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:13:41.110

您是否尝试过 ArrayFormula？在您的电子表格中，而不是 800 次调用：

`=WEEKNUM(-cell-, -dummy-)`

在单元格 A1 到 B400 中，尝试：

`=ARRAYFORMULA(WEEKNUM(A1:B400, -dummy-))`

在单元格 A1 中。

# javascript - 链接在你的 body ajax 调用上的方法

> ID：15819333
> 
> 赞同：0
> 
> 时间：2013-04-04T18:50:08.030
> 
> 标签：javascript, jquery, jquery-datatables, jquery-callback

我有这堂课：

```
function Clazz() {
this.id;
this.description;
}

Clazz.prototype._insert = function(_description, _success, _error) {

this.description = _description;

$.ajax({
    type : "PUT",
    url : "api/route",
    data : JSON.stringify(this),
    dataType : "json",
    contentType : "application/json;charset=UTF-8",
    success : function() {
        _success($("#message"), 'OK');
    },
    error : function() {
        _error($("#message"), 'FAIL');
    }
});
};

Clazz.prototype._findAll = function(_callback) {

$.ajax({
    type : "GET",
    url : "api/route",
    dataType : "json",
    success : function(data) {
        _callback(data);
    }
});
}; 
```

在按钮单击时，我有这个：

```
var clazz = new Clazz();
clazz._insert($("#description").val(), success, error);
clazz._findAll(loadCallback); 
```

在 loadCallback 方法下面：

```
function loadCallback(data){
    var oTable = $('#table').dataTable({
        "bRetrieve": true,
        "bDestroy" : true,
        "bFilter" : false,
        "bLengthChange" : false,
        "bInfo" : false,
        "sDom" : "<'row'<'span5'l><'span5'f>r>t<'row'<'span5'i><'span5'p>>",
        "sPaginationType" : "bootstrap",
        "oLanguage" : {
            "sProcessing" : "Loading ...",
            "sZeroRecords" : "No records",
            "oPaginate" : {
                "sNext" : "",
                "sPrevious" : ""
            }
        },
        "iDisplayLength" : 4,
        "aaData" : data,
        "aoColumnDefs" : [ 
                     { "aTargets" : [0], "mData" : "description", "sTitle" : "My Data" },

                     { "aTargets" : [1], 
                            "sWidth" : "20px",
                            "mData" : "id", 
                            "bSortable" : false,
                            "mRender" : function ( data ) {
                                    return '<a href="#" name="route-' + data + '" route="' + data + '"><img src="img/img01.png" style="height: 20px; width: 20px;"/></a>';
                            }
                         },
                         { "aTargets" : [2], 
                            "sWidth" : "20px",
                            "mData" : "id", 
                            "bSortable" : false,
                            "mRender" : function ( data ) {
                                    return '<a href="#" name="route-' + data + '" route="' + data + '"><img src="img/img02.png" style="height: 20px; width: 20px;"/></a>';
                            }
                         },
                     { "aTargets" : [3], 
                            "sWidth" : "20px",
                            "mData" : "id", 
                            "bSortable" : false,
                            "mRender" : function ( data ) {
                                    return '<a href="#" name="route-' + data + '" route="' + data + '"><img src="img/img03.png" style="height: 20px; width: 20px;"/></a>';
                            }
                         }
                     ],
        "fnHeaderCallback" : function( nHead ) {
            $(nHead.getElementsByTagName('th')[0]).attr("colspan","4");
            for(var i = 1; i <= 3; i++){
                $(nHead.getElementsByTagName('th')[1]).remove();
            }
        },
        "fnRowCallback" : function( nRow ) {
                $(nRow.getElementsByTagName('td')[1]).attr("width","20px");
                $(nRow.getElementsByTagName('td')[2]).attr("width","20px");
                $(nRow.getElementsByTagName('td')[3]).attr("width","20px");
        }

    });
    oTable.fnClearTable();
    oTable.fnAddData(data);
    oTable.fnDraw();
} 
```

我希望该方法`clazz._findAll(loadCallback);`仅在`clazz._insert`完成后执行。

我已经尝试过`$.when`，但没有奏效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T18:56:46.050

`$.when`如果`clazz._insert`返回`$.ajax`函数调用（它目前没有）应该可以工作。

如果您`$.ajax`回电，您应该能够执行以下操作：

`$.when(clazz._insert(...stuff...)).then(clazz._findAll(...stuff...));`

仔细检查有关延迟对象的[文档](http://api.jquery.com/jQuery.when/)可能是个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:01:19.690

我解决了这样做：

1.  放入`return $.ajax(...stuff...)`插入方法
2.  使用

    ```
    $.when(clazz._insert($("#description").val())).done(
        function(){
            clazz._findAll(loadCallback);
        }
    ); 
    ```

我不得不调用`_findAll`内部匿名函数。

# excel - 使用 ODBC 的 Oracle 连接

> ID：15819335
> 
> 赞同：0
> 
> 时间：2013-04-04T18:50:12.693
> 
> 标签：excel, oracle, odbc, excel-2007

我在 Oracle 数据库中有一个表说 TableA 有 200 万条记录和 52 列。

我正在尝试使用 ODBC 驱动程序将所有这些数据提取到 MS excel 2007，我必须对其进行 Pivot。

现在我有两个问题要问，如下..

问题 1）有时（并非总是）我在获取记录时遇到错误“选择更少的数据或关闭其他应用程序”

问题 2) 每次将数据插入到我的 TableA 中时，我都必须刷新我的 Pivot，因为这样做我必须再次将整个数据再次提取到 Excel 中。有没有什么方法可以只获取增量数据而不干扰 MS Excel Pivot 中的现有数据

我正在使用 Oracle 10g 和 MS excel 2007

# javascript - 防止 window.open 刷新父窗口

> ID：15819336
> 
> 赞同：3
> 
> 时间：2013-04-04T18:50:16.570
> 
> 标签：javascript, jquery

当我调用`window.open`父窗口时刷新。我还没有看到任何关于如何防止这种情况发生的信息。任何帮助，将不胜感激。

```
left = Number((screen.width/2)-(730/2)),
top = Number((screen.height/2)-(450/2));

var windowFeatures = 'location=0,menubar=0,resizable=0,scrollbars=0,status=0,width=700,height=500,top='+top+',left='+left;
    window.open('access-modal.html', '', windowFeatures);

win.moveTo(left, top); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:34:05.363

虽然编辑后我的帖子有问题。最终的解决方案是阻止默认操作。

```
$('.button').on('click', function(e) {

    e.preventDefault();

        left = Number((screen.width/2)-(730/2)),
        top = Number((screen.height/2)-(450/2));

        var windowFeatures = 'channelmode=0,directories=0,fullscreen=0,location=0,menubar=0,resizable=0,scrollbars=0,status=0,width=700,height=500,top='+top+',left='+left;
            win = window.open('access-modal.html?env=' + Data.currentOauth + '&url=' + Data.currentAddr, '', windowFeatures);

        win.moveTo(left, top);
        win.focus();

    }

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:10:16.377

我不确定这是否是您的编辑。我知道 win.moveTo(left, top) 上有错误。win 未定义..以下代码对我有用。

```
<script language="javascript" type="text/javascript">
            function windowOpen() {
                left = Number((screen.width / 2) - (730 / 2)),
                top = Number((screen.height / 2) - (450 / 2));

                var windowFeatures = 'location=0,menubar=0,resizable=0,scrollbars=0,status=0,width=700,height=500,top=' + top + ',left=' + left;
                var win = window.open('access-model.htm', '', windowFeatures);

                win.moveTo(left, top);
            }
        </script> 
```

# javascript - 捕捉快递 bodyParser 错误

> ID：15819337
> 
> 赞同：59
> 
> 时间：2013-04-04T18:50:17.583
> 
> 标签：javascript, node.js, express

我想在发送 json 对象时从 bodyParser() 中间件中捕获错误，但它无效，因为我想发送自定义响应而不是通用 400 错误。

这就是我所拥有的并且它有效：

```
app.use (express.bodyParser ());
app.use (function (error, req, res, next){
    //Catch bodyParser error
    if (error.message === "invalid json"){
        sendError (res, myCustomErrorMessage);
    }else{
        next ();
    }
}); 
```

但在我看来，这似乎是一种非常丑陋的方法，因为我正在比较可能在未来快速版本中更改的错误消息。还有其他方法可以捕获 bodyParser() 错误吗？

编辑：

这是请求正文具有无效 json 时的错误：

```
{
  stack: 'Error: invalid json\n    at Object.exports.error (<path>/node_modules/express/node_modules/connect/lib/utils.js:55:13)\n    at IncomingMessage.<anonymous> (<path>/node_modules/express/node_modules/connect/lib/middleware/json.js:74:71)\n    at IncomingMessage.EventEmitter.emit (events.js:92:17)\n    at _stream_readable.js:872:14\n    at process._tickDomainCallback (node.js:459:13)',
  arguments: undefined,
  type: undefined,
  message: 'invalid json',
  status: 400
} 
```

漂亮的印刷堆栈：

```
Error: invalid json
    at Object.exports.error (<path>/node_modules/express/node_modules/connect/lib/utils.js:55:13)
    at IncomingMessage.<anonymous> (<path>/node_modules/express/node_modules/connect/lib/middleware/json.js:74:71)
    at IncomingMessage.EventEmitter.emit (events.js:92:17)
    at _stream_readable.js:872:14
    at process._tickDomainCallback (node.js:459:13) 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-04-04T18:57:56.577

我认为你最好的选择是检查`SyntaxError`：

```
app.use(function (error, req, res, next) {
  if (error instanceof SyntaxError) {
    sendError(res, myCustomErrorMessage);
  } else {
    next();
  }
}); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2018-02-15T17:38:53.480

来自@alexander的回答，但有一个使用示例

```
app.use((req, res, next) => {
    bodyParser.json({
        verify: addRawBody,
    })(req, res, (err) => {
        if (err) {
            console.log(err);
            res.sendStatus(400);
            return;
        }
        next();
    });
});

function addRawBody(req, res, buf, encoding) {
    req.rawBody = buf.toString();
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-04T19:14:51.687

好的，找到了：

bodyParser() 是 json()、urlencoded() 和 multipart() 的便捷函数。我只需要调用 json()，捕获错误并调用 urlencoded() 和 multipart()。

[bodyParser 源码](http://www.senchalabs.org/connect/bodyParser.html)

```
app.use (express.json ());
app.use (function (error, req, res, next){
    //Catch json error
    sendError (res, myCustomErrorMessage);
});

app.use (express.urlencoded ());
app.use (express.multipart ()); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-05-13T21:02:21.453

我所做的只是：

```
app.use(bodyParser.json({ limit: '10mb' }))
// body parser error catcher
app.use((err, req, res, next) => {
  if (err) {
    res.status(400).send('error parsing data')
  } else {
    next()
  }
}) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-03-04T07:46:41.070

所有错误都包括从 1.18.0 版本开始的类型属性。对于解析失败，err.type === 'entity.parse.failed'。

```
app.use(function (error, req, res, next) {
if (error.type === 'entity.parse.failed') {
 sendError(res, myCustomErrorMessage);
} else {
 next();
}
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-01-10T11:38:59.290

我发现检查`SyntaxError`是不够的，因此我这样做：

```
if (err instanceof SyntaxError &&
  err.status >= 400 && err.status < 500 &&
  err.message.indexOf('JSON') !== -1) {
    // process filtered exception here
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-02-09T05:46:34.560

创建新模块“hook-body-parser.js”在这里用body parser钩住所有东西

```
const bodyParser = require("body-parser");

module.exports = () => {
  return [
    (req, res, next) => {
      bodyParser.json()(req, res, (error) => {
        if (error instanceof SyntaxError) {
          res.sendStatus(400);
        } else {
          next();
        }
      });
    },
    bodyParser.urlencoded({ extended: true }),
  ];
}; 
```

并像这样使用过度快递

... app.use(hookBodyParser()) ...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-25T07:21:42.467

如果您想捕获 body-parsr 抛出的所有错误，例如 **entity.too.large**或**encoding.unsupported**

只需在 body-parser 初始化之后放置这个中间件

```
$ npm i express-body-parser-error-handler 
```

[https://www.npmjs.com/package/express-body-parser-error-handler](https://www.npmjs.com/package/express-body-parser-error-handler)

例如：

```
const bodyParserErrorHandler = require('express-body-parser-error-handler')
const { urlencoded, json } = require('body-parser')
const express = require('express')
const app = express();
router.route('/').get(function (req, res) {
    return res.json({message:""});
});

// body parser initilization
app.use('/', json({limit: '250'}));

// body parser error handler
app.use(bodyParserErrorHandler());
app.use(router);
... 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2018-01-07T14:42:30.797

```
(bodyParser, req, res) => new Promise((resolve, reject) => {
    try {
        bodyParser(req, res, err => {
            if (err instanceof Error) {
                reject(err);
            } else {
                resolve();
            }
        });
    } catch (e) {
        reject(e);
    }
}) 
```

防弹。面向未来。WTFPL 许可。并且对 w/async/await 也很有用。

# python - 除了词干还有什么其他选择？

> ID：15819339
> 
> 赞同：2
> 
> 时间：2013-04-04T18:50:18.277
> 
> 标签：python, nltk, stemming, porter-stemmer

给定一个像这样的单词列表**['add', 'adds', 'adding', 'added', 'addition']**，我想把它们都归结为同一个单词**'add'**。这意味着将一个单词的所有不同动词和名词形式（但不是它的形容词和副词形式）合并为一个。

我找不到任何可以做到这一点的词干分析器。我找到的最接近的一个是 PorterStemmer，但它使上面的列表成为**['add', 'add', 'ad', 'ad', 'addit']**

我对词干技术不是很有经验。所以，我想问一下是否有任何可用的词干分析器可以完成我上面解释的操作？如果没有，您对如何实现这一目标有什么建议吗？

非常感谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-01-22T21:53:13.970

[词形还原](http://en.wikipedia.org/wiki/Lemmatisation)应该比词干（[来源](http://nlp.stanford.edu/IR-book/html/htmledition/stemming-and-lemmatization-1.html)）产生更好的结果：

> **词干提取**通常是指一种粗略的启发式过程，该过程会切断单词的结尾，以希望在大多数情况下正确地实现这一目标，并且通常包括删除派生词缀。
> 
> **词形还原**通常是指使用词汇和词法分析正确地做事，通常旨在仅删除屈折词尾并返回单词的基本或字典形式，这被称为引理。

作为[nltk.stem](http://www.nltk.org/api/nltk.stem.html)包的一部分，NTLK 支持词形还原：

```
import nltk

l = nltk.stem.WordNetLemmatizer()
l.lemmatize('dogs')     # -> 'dog'
l.lemmatize('addition') # -> 'addition'

s = nltk.stem.snowball.EnglishStemmer()
s.stem('dogs')          # -> 'dog'
s.stem('addition')      # -> 'addit' 
```

如果 lemmatizer 不能识别这个词，它不会改变它。一个陷阱是默认情况下所有单词都被视为名词。要覆盖该行为，您必须设置`pos`参数，默认情况下设置为`pos='n'`：

```
s.stem('better')               # -> 'better'
l.lemmatize('better')          # -> 'better'
l.lemmatize('better', pos='a') # -> 'good' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:00:09.410

词干提取的想法是将同一单词的不同形式简化为单个“基本”形式。这不是您所要求的，因此可能没有现有的词干分析器（至少不是有意地）满足您的需求。因此，对于您的问题，显而易见的解决方案是：如果您有自己的自定义规则，则必须实施它们。

您并没有过多地说明您的要求。根据您的需要，您必须从头开始。如果 porter stemmter 接近您的需求，但不是在某些特殊情况下，您可以手动编写一些覆盖代码并在其他情况下使用现有的词干分析器。

# facebook-graph-api - 新的 Facebook 评论 API 是针对新闻提要故事进行更改，还是仅针对页面帖子的评论？

> ID：15819347
> 
> 赞同：0
> 
> 时间：2013-04-04T18:50:44.890
> 
> 标签：facebook-graph-api, comments, facebook-comments

在这个 FB 开发人员博客条目：[评论回复的新 API 中](http://developers.facebook.com/blog/post/2013/04/03/new-apis-for-comment-replies/)，它说

> 上周，我们在 Facebook 页面和个人资料上发布了评论回复，拥有超过 10,000 名关注者。这使企业和名人能够更直接地与他们的粉丝互动。今天，我们正在更新 API，以便开发人员可以构建工具，让品牌更轻松地监控和回复评论回复。

当我查看新的[Comments API](http://developers.facebook.com/docs/graphapi/guides/comments/)文档时，它说：

> 一些对象能够接受线程评论：对象本身的顶级评论，以及对任何这些评论的第二级回复：

这里有一些歧义。新的评论 API 是否仅适用于拥有超过 10000 名关注者的页面和个人资料上的帖子，还是适用于标准新闻源帖子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:26:34.387

它仅适用于通常在 Facebook.com 上的 Graph API。这就是拥有超过 10,000 名关注者的页面上的帖子。

但是，您可以假设整个系统都具有兼容性。因此，我作为用户对帖子的所有评论都将`parent_id`具有`0`. `comment_id/comments`如果无法完成，尝试执行 POST将会失败。

# mysql - 通过mysql工作台将数据推送到cleardb Heroku抛出错误

> ID：15819348
> 
> 赞同：0
> 
> 时间：2013-04-04T18:50:51.830
> 
> 标签：mysql, heroku, mysql-workbench

第 1 行的错误 1044 (42000)：用户 'user_name_of_cleardb_at_heroku'@'%' 拒绝访问数据库 'i_am_uploading'

我通过 mysql 工作台将数据从本地主机转储到转储文件夹。我正在将相同的转储文件管理器数据上传到 heroku。我收到这个错误。我成功地制作了服务器实例？

究竟是什么问题？我该如何调试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2021-07-06T22:43:48.260

Heroku 不允许您创建新数据库。

创建表时不要忘记在表名前使用用户名，如下所示：

创建表 heroku_7036ce5029e34fc.usuarios( user_id INT NOT NULL AUTO_INCREMENT, user_first_name VARCHAR(100) NOT NULL, user_last_name VARCHAR(100) NOT NULL, user_email VARCHAR(100) NOT NULL, user_password VARCHAR(100) NOT NULL, user_phone VARCHAR(20) NOT NULL，主键（用户 ID））；

如果您使用的是脚本，请尝试在每个语句中包含用户名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T07:16:14.090

错误信息说得很清楚。用户 user_name_of_cleardb_at_heroku 无权对数据库“i_am_uploading”进行操作。因此，首先授予该用户权限，然后再试一次。或者使用具有适当权限的用户。有关 GRANT 的语法，请参见[http://dev.mysql.com/doc/refman/5.6/en/grant.html](http://dev.mysql.com/doc/refman/5.6/en/grant.html)。你可能需要类似的东西：

```
grant all on i_am_uploading.* to user_name_of_cleardb_at_heroku@%; 
```

您需要与有权授予权限的用户一起运行此程序。

# c# - 空消息和实际消息 MQ 客户端问题

> ID：15819350
> 
> 赞同：-1
> 
> 时间：2013-04-04T18:50:55.697
> 
> 标签：c#, .net, websphere, ibm-mq

我正在将消息从一个队列发送到另一个队列，例如，在我的输入队列中，如果有一条空消息，然后是一条实际消息，当代码开始排队时，它一旦看到它就不会向我发送实际消息第一条空消息。

```
Import queue:

     -> empty message
Test -> actual message 
```

这是正在接收和发送的消息。

```
if (mqMsg.MessageLength > 0 && mqMsg.DataLength > 0)
{
messageData = mqMsg.ReadString(mqMsg.MessageLength);
} 
```

推杆

```
mqQueue.Put(mqMsg, mqPutMsgOpts); 
```

这就是我的实施方式：

```
while(if any message is available)
{
  //go a read/get
  mqMsg = new MQMessage();
  mqGetMsgOpts = new MQGetMessageOptions();
  mqQueue.Get(mqMsg);
  if (mqMsg.MessageLength > 0 && mqMsg.DataLength > 0)
  {
   //posted to send method
  }    
} 
```

另一种方法（发送） - 发送它。

```
 mqPutMsgOpts = new MQPutMessageOptions();
 mqQueue.Put(mqMsg, mqPutMsgOpts); 
```

我该如何处理，即使有空消息，队列也会继续发送消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T12:46:43.823

只需检查 MessageLength 就足够了。

```
if(mqMsg.MessageLength > 0)
{
     // Send message to another queue.
} 
```

但重要的是要了解为什么会有没有正文的消息并解决该问题。为什么有人会发送没有正文的消息？

# windows-7 - Windows PHP-FPM 可以同时处理多个请求吗？

> ID：15819351
> 
> 赞同：4
> 
> 时间：2013-04-04T18:51:01.377
> 
> 标签：windows-7, nginx, php

我目前正在使用**nginx**和**PHP FastCGI**，但这种安排受到限制，即一次只能服务一个 HTTP 请求。（见[这里](https://stackoverflow.com/questions/2793996/php-running-as-a-fastcgi-application-php-cgi-how-to-issue-concurrent-request)。）我从 Windows 命令提示符启动 PHP：

```
c:\Program Files\PHP>php-cgi -b 127.0.0.1:9000 
```

然而，还有另一种运行 PHP 的方法，称为“Fast CGI Process Manager”（PHP-FPM）。

在 nginx 后面的 Windows 7 上运行时，PHP-FPM 可以同时处理多个 HTTP 请求吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-10-09T07:59:09.803

我最终得到了这个解决方案：您只需启动几个 php-cgi 进程并将它们绑定到不同的端口，并且您需要更新 nginx 配置：

```
http {

    upstream php_farm {
        server 127.0.0.1:9000 weight=1;
        server 127.0.0.1:9001 weight=1;
        server 127.0.0.1:9002 weight=1;
        server 127.0.0.1:9003 weight=1;
    }

    ...

    server {
      ...
      fastcgi_pass   php_farm;
    }

} 
```

* * *

为了方便起见，我创建了简单的批处理文件。

`start_sandbox.bat`：

```
@ECHO OFF
ECHO Starting sandbox...

RunHiddenConsole.exe php\php-cgi.exe -b 127.0.0.1:9000 -c php\php.ini
RunHiddenConsole.exe php\php-cgi.exe -b 127.0.0.1:9001 -c php\php.ini
RunHiddenConsole.exe php\php-cgi.exe -b 127.0.0.1:9002 -c php\php.ini
RunHiddenConsole.exe php\php-cgi.exe -b 127.0.0.1:9003 -c php\php.ini

RunHiddenConsole.exe mysql\bin\mysqld --defaults-file=mysql\bin\my.ini --standalone --console

cd nginx && START /B nginx.exe && cd .. 
```

和`stop_sandbox.bat`：

```
pstools\pskill php-cgi

pstools\pskill mysqld

pstools\pskill nginx 
```

如您所见，有 2 个依赖项：[pstools](https://technet.microsoft.com/en-us/sysinternals/bb896649.aspx)和[runhiddenconsole.exe](http://redmine.lighttpd.net/attachments/660/RunHiddenConsole.zip)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-05-16T07:54:35.123

还有一种替代方法，以更好的方式。

在 nginx 配置中使用简单的 Fast-CGI 设置

nginx.conf

```
server {
     ....
     location ~ \.php$ {
            try_files   $uri =404; 
            include     fastcgi.conf;
            fastcgi_pass    127.0.0.1:9001;
            fastcgi_read_timeout 60;
            allow       127.0.0.1;
            allow       ::1;        
            deny        all;        
       }
  } 
```

然后在你的 start.bat 文件中

```
set PATH=%cd%\bin\php;%PATH%
set PHP_FCGI_MAX_REQUESTS=0
set PHP_FCGI_CHILDREN=10
RunHiddenConsole.exe %cd%/php/php-cgi.exe -b 127.0.0.1:9001 -c %cd%/php/php.ini 
```

PHP_FCGI_CHILDREN 变量是魔法发生的地方。PHP_FCGI_MAX_REQUESTS 也很重要。

# c - 在 C 中实现队列

> ID：15819352
> 
> 赞同：-2
> 
> 时间：2013-04-04T18:51:01.520
> 
> 标签：c, data-structures, queue, implementation

```
struct client
{
char Fname[20];
char Lname[20];
char home_num[10];
char cell_num[10];
char email_add[20];
int client_id;
}; /* ending the client struct*/

char Main_Menu()
{
 char sel;

 int rear=-1;
 int front=-1;
 client clientQueue [size]; -->I keep having an error come up right here, not sure why.
 int isFull(int rear);
 int isEmpty(int rear); 
```

我得到错误的地方是我声明队列的那一行。不太清楚为什么我会收到这个错误，因为当我研究时，这就是我发现的。ps大小为20

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T18:53:17.083

如果这是 pure `C`，则必须使用`struct`-keyword

```
struct client clientQueue [size]; 
```

并且也`size`必须在某个地方定义。

或者`typedef`像这样使用

```
typedef struct client {
    char Fname[20];
    char Lname[20];
    char home_num[10];
    char cell_num[10];
    char email_add[20];
    int client_id;
} client; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T18:53:18.833

我认为声明错误，您需要这样声明：

```
struct client  clientQueue [size];
// ^ add struct key work before client 
```

second`size`必须是一个常量值，在编译时定义。

最好使用如下宏：

```
# define SIZE 100

struct client  clientQueue [SIZE]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T18:55:33.270

当您在 c 中编码时，您需要在声明 struct 类型的新变量时使用关键字 struct 或使用 typedef

```
struct client clientQueue [size]; 
```

# ruby-on-rails - 如何在 Sublime Text 2 中为 css 启用代码提示？

> ID：15819354
> 
> 赞同：1
> 
> 时间：2013-04-04T18:51:07.373
> 
> 标签：ruby-on-rails, sass, sublimetext2, code-hinting

我是 Rails 新手，我使用 Sublime Text 2 编写代码。它适用于`.erb`文件，但是在`scss`文件中编写 css 时，我不确定如何为 css 启用代码提示。就像我想写的时候一样，`font`它会显示所有字体名称属性，就像我们在`Dreamweaver`. 我怎么能这样做？

注意：我已经用谷歌搜索并发现一些包/插件可用，但我不确定要使用哪个以及如何使用，因为我是新手。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T19:04:27.040

我自己没有做过，`scss`但这是我的建议：

1.  安装 wbond 的[包控制](http://wbond.net/sublime_packages/package_control)
2.  重启 Sublime
3.  打`ctrl + shift + p`
4.  键入`install package`并点击`enter`
5.  键入`scss`并点击`enter`
6.  重启 Sublime

您现在应该获得更多的`.scss`文件功能。有关该软件包的更多文档，请参见[此处](https://github.com/danro/SCSS-sublime)。

PS。包控制是Sublime的**炸弹:)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-30T20:52:40.640

除了 Jondlm 提到的内容之外，请确保您还为 scss 选择了 CSS 语法。为此，请按 ctrl+shift+p 然后输入“CSS”并选择“设置语法：CSS”，这应该是第一个选项 :)

# javascript - 在 JQuery Mobile 中动态控制多个复选框

> ID：15819357
> 
> 赞同：1
> 
> 时间：2013-04-04T18:51:24.223
> 
> 标签：javascript, jquery-mobile

我在实现一个可以多次更新一组复选框状态（使用 JQueryMobile 框架定义）的控件时遇到问题。

非常简单的操场代码在这里：http: [//jsfiddle.net/XR44Q/3/](http://jsfiddle.net/XR44Q/3/)（使用JQuery 1.9.1和JQueryMobile 1.3.0，26行html+javascript代码）实际上，问题比解释简单。使用组控制复选框，查看在两次单击组控制后分组框如何停止响应。代码和想法非常简单，它应该可以工作:)

来自 jsfiddle 的代码在这里供将来参考：

HTML：

```
<form>
  <input id="group_control" name="g" type="checkbox" />
  <label for="group_control">Group</label>
  <fieldset data-role="controlgroup" data-type="vertical" class="sub_cat">
    <input id="c01" name="c01" type="checkbox" class="cXX" />
    <label for="c01">A</label>
    <input id="c02" name="c02" type="checkbox" class="cXX" />
    <label for="c02">B</label>
    <input id="c03" name="c03" type="checkbox" class="cXX" />
    <label for="c03">C</label>
  </fieldset>
</form> 
```

Javascript：

```
$(document).ready(function () {
  $("#group_control").click(function () {
    // the checkbox state can be correctly retrieved
    alert("Group checked? "+$('#group_control').is(':checked'));
    $("INPUT[class='cXX']").attr(
        'checked', $('#group_control').is(':checked')
    ).checkboxradio("refresh");
  });
}); 
```

复选框可以在前两个更改中正确更新。因此，从未选中状态开始，控件可以将所有框转换为选中状态，然后将它们转换回未选中状态。但是，此时，控件不能再选择任何框。

在此状态下，用户仍然可以通过单击单个复选框来控制它们。如果复选框被用户修改，如果它试图选择它们，运行复选框控件将不起作用，如果它试图取消选择它们，它将正确取消选择所有框。*因此，仅当控件在修改两次*后尝试*选择*复选框组时，才会出现问题。

 *如果您检查页面 dom 和属性，您可以看到JQueryMobile 生成的**输入**元素在控制事件之后正确更新，但是当它应该转换为**'checkbox-on'时，它的 'data-icon' 属性仍然保持****'checkbox-off** ' 。用户单击复选框会正确更新此属性，因此问题实际上是理解为什么 jquery mobile 无法正确管理“data-icon”属性。

 **感谢您的反馈！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T18:55:28.350

您应该使用[prop](http://api.jquery.com/prop/)而不是[attr](http://api.jquery.com/attr/)：

```
$("#group_control").click(function() {
    //alert("Group checked? "+$('#group_control').is(':checked'));
    $("INPUT[class='cXX']").prop('checked', this.checked).checkboxradio("refresh");
}); 
```

工作演示：http: [//jsfiddle.net/XR44Q/4/](http://jsfiddle.net/XR44Q/4/)

看看[这个线程](https://stackoverflow.com/questions/5874652/prop-vs-attr)关于属性和属性之间的差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T18:57:05.527

它以没有“已检查”属性开头。第一次被检查时，它会获得一个检查属性为真。第二次，它更改为 false 的已检查属性 - 但它仍然具有已检查属性，因此在该点之后它一直尝试将其更改为 false。您需要根据检查属性的存在以外的其他内容进行评估。***

# python - Python - def findLine(prog, target)

> ID：15819362
> 
> 赞同：-1
> 
> 时间：2013-04-04T18:51:52.453
> 
> 标签：python, python-3.x

我遇到了以下问题：

定义一个函数 findLine(prog, target) 来执行以下操作。假设 prog 是一个包含 BASIC 程序的字符串列表，例如 getBASIC() 生成的类型；假设 target 是一个包含行号的字符串，它是 GOTO 语句的目标。该函数应返回索引 i（一个介于 0 和 len(prog)-1 之间的数字），使得 prog[i] 是其标签等于 target 的行。

示例输入/输出：如果调用
findLine(['10 GOTO 20','20 END'], '10')
则输出应为 0，因为列表的第 0 项是标签为 10 的行。

这是我的代码：

```
 def findLine(prog, target):
   for l in range(0, len(prog)-1):
      progX = prog[l].split()
      for i in range(0, len(progX)):
         if progX[i] == target:
            ans = progX[i]
   return prog.index(ans) 
```

正如您从代码中可以看出的那样，我即将完成（至少我认为我是），但我已经变得相当坚持这一点。但是，我不知道如何识别 prog 中的哪个索引包含 progX 中的字符串。提前感谢您对此的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:57:04.013

我认为你只需要用这个替换内部 for 循环：

```
if progX[0] == target:
   return l 
```

这样您就可以检查该行是否以您要查找的行号开头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-31T20:39:27.823

只需尝试以下代码，它对我有用。

```
def findLine(prog, target):
   for l in range(0, len(prog)):
     progX = prog[l].split()
     for i in range(0, len(progX)):
          if progX[0] == target:
           return l 
```

# c# - SignalR - 连接/用户子组

> ID：15819367
> 
> 赞同：0
> 
> 时间：2013-04-04T18:52:05.320
> 
> 标签：c#, signalr

我第一次使用信号器同时向用户组广播通信。我有两个地区 - 美国和加拿大以及多个应用程序销售/营销/等。

我希望能够将消息发送到：

*   特定区域的所有用户
*   特定应用程序的所有用户，不分地区
*   特定区域中特定应用程序的所有用户

现在我可以向特定的组发送消息——基本上完成了上面的#1 和#2。是否可以有子用户组 - 或者仅在当前将用户分配到两个组时才发送消息？如果没有，是否有实现此功能的最佳实践？

谢谢太平绅士

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:07:01.590

不，您无法开箱即用。

但是，您可以尝试查询不符合您条件的用户，然后将它们包含在 group.send 请求的“排除连接 ID”参数中。

例如（sudo 代码）

```
var exclusionIds = myusers.Where(u => u.OnApplication("App1")).Where(x => !x.InRegion("xyz")).Select(z => z.ConnectionId).ToArray();

Clients.Group("App1", exclusionIds).foo(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T19:05:20.520

SignalR 仅提供帮助您维护简单组的功能。您必须在代码中处理子组逻辑。您可以为不同的组创建“集”，并根据需要向这些组/集的交集发送消息。您可以查看 SignalR 中的聊天示例，以了解有关如何在应用程序中管理组的更多信息。

# ruby - 如何在 Sinatra 和 Sequel 中实现类似于“查找”方法的 Active Record？

> ID：15819368
> 
> 赞同：0
> 
> 时间：2013-04-04T18:52:06.477
> 
> 标签：ruby, sinatra, sequel

我正在为培训目的构建一个简单的 Sinatra 应用程序。

我正在使用 Sequel gem，不想使用 Active Record。

我的文件是：

/models/idea.rb：

```
class Idea
  attr_reader :id, :title, :description

  def initialize(input)
    @id = input[:id]
    @title = input[:title]
    @description = input[:description]
  end

  def save
    Idea.data.insert(title: title, description: description)
  end

  def self.create_table
    database.create_table? :ideas do
      primary_key :id
      String :title, size: 25
      Text :description
    end
  end

  def self.data
    verify_table_exists
    database[:ideas]
  end

  def self.database
    @database ||= Sequel.sqlite('./db/idea_box.sqlite3')
  end

  def self.all
    data.order(Sequel.desc(:id)).collect do |row|
      Idea.new(row)
    end
  end

  def self.verify_table_exists
    @table_exists ||= (create_table || true)
  end

  def self.find(params)
    data.where(id: params)
  end
# I also tried this:
#
#  def self.find(params)
#    data.where(id: params).collect do |row|
#      Idea.new(row)
#    end
#  end

  end
end 
```

/views/edit.haml：

```
%h1 Edit idea
%form{action:"/#{@idea.id}", method: "post"}
  %input{type: "hidden", name: "_method", value: "put"}
  %input{type: "text", name: "idea_name", value: "#{@idea.title}"}
  %br
  %textarea{name: "idea_description", value: "#{@idea.description}"}
  %br
  %input{type: "submit", value: "Submit"} 
```

应用程序.rb：

```
require './models/idea'

Bundler.require

helpers do
  def title
    if @title
      "#{@tile} -- IdeaBox"
    else
        "IdeaBox"
    end
  end

  def delete_idea_button(idea_id)
    haml :_delete_idea_button, locals: {idea_id: idea_id}
  end
end

get '/' do
  @ideas = Idea.all
  haml :index
end

not_found do
  haml :error
end

post '/create' do

  idea = Idea.new(title: params['idea_name'], description: params['idea_description'])
  idea.save

  redirect to('/')
end

get '/edit/:id' do
  @idea = Idea.find(params[:id])
  @title = "Edit form"
  haml :edit
end

put ':id' do
  @idea = Idea.find(params[:id])
  @title = "Edit form"
  haml :edit
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T08:18:33.597

`find`当您使用以下内容时，该方法将起作用：

```
def self.find(params)
  record = data[id: params]
  if record.nil?
    nil
    # or raise an exception...
  else
    self.new(record)
  end
end 
```

但是您还必须重新实现 Active Record 已经具有的一些功能，例如某种`persisted?`方法来检查记录是否已经存在于数据库中并更新记录而不是创建新记录。

使用您当前的实现，`save`每次调用它时都会创建一条新记录。如果您不`id`自己设置，但让`auto_increment`您的数据库处理它，它也可能会更好。

# javascript - 将静默 true 传递给 Backbone.History 时绑定 Backbone 事件

> ID：15819371
> 
> 赞同：0
> 
> 时间：2013-04-04T18:52:17.560
> 
> 标签：javascript, backbone.js, handlebars.js

我的 Backbone 应用程序的第一个状态是从服务器呈现的。我不需要在页面加载时触发路由器，因为我正在引导我的模型：

我启动应用程序：

```
 window.App = {
        init:function(root){
            this.root = root;
            this.router = new AppRouter();
            Backbone.history.start({pushState:true, silent:true});
        }
    } 
```

路线[s]：

```
var AppRouter = Backbone.Router.extend({
        routes : {
            "" : "index",
            "profile/:id" : "profile",
        },
        profile: function(id){
            var user = new App.Models.User({id: id});
            var view = (new App.Views.Profile({model:user})).render().el

            App.root.empty().append(view)
        } 
```

看法：

```
 App.Views.Profile = Backbone.View.extend({
        events:{
            "click #toggle" : "toggleTab"
        },
        initialize:function(opts){
            this.model.on('sync', this.render, this);
            this.model.fetch();
        },
        template: Handlebars.templates['profile.hbs'],
        render: function(){
            this.$el.html(this.template());
            return this;
        },
        toggleTab:function(){...} 
```

我正在传递`silent: true`给 Backbone.history，因此不会触发初始路由，因此`click`不会绑定事件。这发生在不触发路由器的事件上。我真的不想在页面加载和重新渲染/获取时触发路由器。`navigate`在这种情况下，ing 不是一种选择。

在这种情况下，如何绑定此类事件？

* * *

## 更新/澄清

出于 SEO 的原因，服务器呈现 html 意味着我已经拥有 html 和那里的数据（我真的不需要`empty()`、重新呈现、触发或获取任何东西。我在服务器和客户端中都使用[把手](http://handlebarsjs.com/)。我知道这里的问题是“初始页面”不是“Backbone.View”，所以它没有得到事件绑定。我可以很容易地触发路由器和/或通过生成视图来替换内容，但是当我已经拥有了我不想那样做的一切。我应该只引导模型并重新渲染 html 吗？这有*最佳实践*吗？

# objective-c - 总是使用 isEqual: 在 Objective-C 中进行对象比较是一种好的形式吗？

> ID：15819375
> 
> 赞同：0
> 
> 时间：2013-04-04T18:52:44.950
> 
> 标签：objective-c, cocoa-touch, cocoa

我知道这`==`通常适用于对象比较，在您比较指向同一对象的变量的情况下。然而，即使在这些情况下，我认为`isEqual:`总是有效的。

当您认为您正在比较指针时尝试使用更好`==`，还是应该`isEqual:`在不比较原语时始终使用？

我倾向于认为，通过始终使用`isEqual:`，您可以更轻松地一眼看出代码是否存在错误。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-04T18:58:39.417

使用`==`, 正如你所说的将比较指针。使用它，您可以知道这两个对象是否是同一个实例。

**通过使用`isEqual:`您比较它们的值。**

两个不同的 NSString 可以包含相同的文本：`Hello World!`. 它们的地址将不同（*两个不同的对象*），但它们的值将相同。

在这种情况下`==`将返回`NO`并且`isEqual:`应该返回`YES`。

**例子：**

```
NSString* str1 = @"Hello World!";
NSString* str2 = [@"Hello " stringByAppendingString:@"World!"];

if (str1 == str2)
{
    NSLog(@"str1 == str2");
}

if ([str1 isEqualToString:str2])
{
    NSLog(@"str1 is equal to str2");
} 
```

**只会输出：**

> 2013-04-04 21:04:18.365 测试 [7310:303] str1 等于 str2

**笔记：**

我没有使用：

```
NSString* str1 = @"Hello World!";
NSString* str2 = @"Hello World!"; 
```

因为编译器为文字生成了一个对象。在这种情况下，两个等式 (`==`和`isEqual:`) 都会得到满足。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T19:00:36.143

我认为两者之间有一个重要的区别。

假设你测量房子左右墙的长度：左墙长=5米，右墙长=5米

isEqual 会告诉您两个测量值的距离相同（5m）

== 会告诉你，你不只是测量同一面墙两次。

我希望这是有道理的

# java - 在背景图像的顶部添加 JPanel/Containers/Images/JButtons/Etc？

> ID：15819376
> 
> 赞同：0
> 
> 时间：2013-04-04T18:52:48.443
> 
> 标签：java, image, swing, background

一直在寻找我如何在内容窗格/背景图像上添加对象但无济于事。本质上，我必须创建一个棋盘游戏，而我的任务是制作 GUI。我需要制作一个中心位置来放置我的棋子，然后才能将棋子移动到这些位置。到目前为止，我只有一个板的背景图像，并且想添加组件以使其具有交互性，但我似乎无法将交互组件覆盖在我的背景图像之上。

这是我的代码：

```
public class Lotus{

    private static JPanel _panel = new JPanel(); 
    private static JFrame _frame = new JFrame("Lotus"); 
    private static Container _pieces = new Container(); 

    public static void main(String[] args){
        /**

        JLabel A = new JLabel("");
        A.setOpaque(true);
        A.setBackground(Color.BLACK);
        _frame.add(_pieces); 
        _pieces.add(A); 
        _frame.setAlwaysOnTop(_pieces);
                */

        try{

            _frame.setContentPane(new JLabel(new ImageIcon(
                 ImageIO.read(new File("C:\\Users\\Martin\\Pictures\\pic625580.jpg")))));

        }catch(IOException e){

            System.out.println("Image is not Found.");
            e.printStackTrace();
        }

        Toolkit tk = Toolkit.getDefaultToolkit();  
        int xSize = ((int)tk.getScreenSize().getWidth());  
        int ySize = ((int)tk.getScreenSize().getHeight());  
        _frame.setSize(xSize,ySize); 
        Container contentPane = _frame.getContentPane();
        contentPane.setLayout(null); 
        _frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
        //_frame.pack();
        _frame.setVisible(true);

        /**
        JLayeredPane mainLayer = new JLayeredPane();
        _frame.add(mainLayer, BorderLayout.CENTER); 
        JLabel label = new JLabel("LABEL", JLabel.CENTER); 
        label.setBounds(100,100,200,100);
        label.setOpaque(false);
        _frame.getContentPane().setComponentZOrder(label, 0);
        //label.setVisible(true); 
        label.setBackground(Color.CYAN);
        mainLayer.add(label,1); 
        mainLayer.moveToFront(_frame);
        */    
    } 
```

编辑：

好的，所以我尝试了下面的方法，我的 JFrame 现在没有出现，并且由于某种原因正在查看 Java 控制台，它正在终止程序。代码：

```
public static void main(String[] args){

    class Board extends JPanel{

        JFrame _frame = new JFrame("Lotus");

        Image image = Toolkit.getDefaultToolkit().getImage("C:\\Users\\Martin\\Pictures\\pic625580.jpg");

        public void paintComponent(Graphics g) {

            JLabel A = new JLabel("");
            A.setOpaque(true);
            A.setBackground(Color.BLACK);

            Board b = new Board(); 
            _frame.setContentPane(b);
            _frame.setVisible(true);
            _frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

            super.paintComponent(g); 
            g.drawImage(image,0,0,A); 
            g.fillOval( 50,50,5,5 ); 

    }
        public Dimension getPreferredSize() {

            return new Dimension( 300,300); 

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T18:58:17.423

你必须继承子类`JPanel`来做`paintComponent`绘图的东西。例如：

```
public class Board extends JPanel {

    Image image = ... // load it here

    public void paintComponent(Graphics g) {
        super.paintComponent(g); // fatal

        g.drawImage(image,0,0,this); // omitted label

        g.fillOval( 50,50,5,5 ) // circle 5x5 at pixel 50x50

        // etc.
    }
} 
```

现在您还应该覆盖`getPreferredSize`，告诉布局管理器板应该有多大：

```
 public Dimension getPreferredSize() {
        return new Dimension(300,300) // your required size...
    } 
```

然后设置`Board`为内容窗格。

# ruby-on-rails - Rails 中的 NoMethodError 用于 Helpers/Controller/Model 中定义的方法

> ID：15819385
> 
> 赞同：1
> 
> 时间：2013-04-04T18:53:17.193
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, nomethoderror

（前言：我已经学习 Rails 10 个月了，所以这可能是一个非常新手的错误。）

我的应用程序与`Venues`它们`VenueCategories`相关联。在我看来，当用户分享到 Twitter`Venue`时，我想将一些哈希标签填充到分享内容中。`Venue`为此，我创建了一个`hash_tags`在 VenueCategory 上调用的方法（尽管可能不是一个理想的实现，稍后会考虑重构）。首先，我将它放在**VenueCategoriesHelper.rb**中，并在控制台中调用它进行测试时得到 NoMethodError。我将方法移至模型和控制器只是为了对其进行测试，但产生了相同的结果。

我尝试过定义方法，有无`venue_category`作为参数传递。

我究竟做错了什么？相关代码如下。

**VenueCategoriesHelper.rb**

```
def hash_tags(venue_category)
  hash_tags = []
  hash_tag_string = ""
  if venue_category.name == "Restaurant"
    hash_tags << "#restaurants"
  elsif venue_category.name == "Salons & Spas"
    hash_tags << ["#salons", "#spas"]
  elsif venue_category.name == "Hotels & Resorts"
    hash_tags << ["#hotels", "#resorts"]
  elsif venue_category.name == "Bars & Nightlife"
    hash_tags << ["#bars", "#nightlife"]
  end
  hash_tags.each do |h|
    hash_tag_string << "#{h} "
  end
end 
```

**show.html.slim（随机片段添加到视图以进行测试**

```
...
p = resource.venue_category.hash_tags(resource.venue_category)

#header-module
  #overall-score-container
    #overall-score-header
... 
```

**来自控制台和在浏览器中运行时出错**

```
NoMethodError: undefined method `hash_tags' for #<VenueCategory:0x007ff2134b69c0> 
```

提前感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:09:53.817

辅助模块包含在视图渲染器的范围内，而不是模型。将视图代码更改为：

```
p = hash_tags(resource.venue_category) 
```

# angularjs - 可以使用 $$prevSibling 访问“transcluded”指令中的范围数据吗？

> ID：15819389
> 
> 赞同：10
> 
> 时间：2013-04-04T18:53:26.303
> 
> 标签：angularjs, angularjs-directive, angularjs-scope

我的指令设置如下：

```
<div data-directive-a data-value="#33ff33" data-checked="true">
  <div data-directive-b></div>
</div> 
```

*   我正在使用嵌入来确保`directiveB`得到渲染。
*   `directiveA`有一个复选框，用于在选中时更改某些值。
*   此值需要在`directiveA`and`directiveB`的范围内可访问。

我已经设法做到这一点，但只能通过引用`$$prevSibling`- 有没有更好的方法？

这是代码： http: [//jsfiddle.net/janeklb/yugQf/](http://jsfiddle.net/janeklb/yugQf/)（在此示例中，单击复选框只是为了“清除”该值）

--

更深入一点：（`directiveA`被嵌入其中的内容）的“内容”并不总是`directiveB`. 其他类似`directiveB`的指令也将在那里结束。“`directiveB`类型”将始终在`directiveA`.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-04T21:50:34.800

为避免将您的组件过多地耦合在一起，我会避免使用`$$prevSibling`. 最好的解决方案`directiveB`是`directiveA`使用`require`.

```
.directive( 'directiveB', function () {
  return {
    require: '^directiveA',
    scope: true,
    link: function ( scope, element, attrs, directiveA ) {
      scope.obj = directiveA.getObj();
    }
  };
}) 
```

`^require`指示该指令的元素上的某处或 DOM 层次结构中它上方的任何元素上的某个位置是一个名为 的指令，`directiveA`我们想要调用其控制器上的方法。

```
.directive( 'directiveA', function () {
  return {
    // ...
    controller: function ( $scope ) {
      // ...
      this.getObj = function () {
        return $scope.obj;
      };
    }
  };
}) 
```

所以现在在`directiveB`你可以使用`ng-model="obj.attr"`.

这有很多变化，但考虑到问题的普遍性，我觉得这是最好的方法。这是一个更新的小提琴：http: [//jsfiddle.net/yugQf/7/](http://jsfiddle.net/yugQf/7/)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-05T04:23:44.970

@Josh 在他的回答中提到

> 最好的解决方案`directiveB`是`directiveA`使用`require`.

我一直在玩这个，我相信控制器`directiveA`是*唯一*的解决方案（所以+1 Josh）。这是使用 OP 的小提琴的作用域的样子： ![范围图片](https://i.stack.imgur.com/5FtXT.png)

（反转棕色箭头，您将获得 $$previousSibling 而不是 $$nextSibling。）

除了`$$previousSibling`，作用域 004 没有隔离作用域 003 的路径。请注意，作用域 004 是`directiveA`创建的嵌入作用域，由于`directiveB`不创建新作用域，因此该作用域也被 使用`directiveB`。

由于您希望与之共享的对象`directiveB`是在`directiveA`的控制器中创建的，因此我们也不能使用属性在指令之间共享数据。

* * *

在指令中创建模型，然后将该模型共享给外部世界是相当不典型的。通常，您需要在指令之外甚至在控制器之外定义模型（[听几分钟 Misko](http://www.youtube.com/watch?v=ZhfUv0spHCY&feature=youtu.be&t=30m)）。服务通常是存储模型/数据的好地方。控制器通常应该引用模型中需要投影到与它们关联的视图中的部分。

为简单起见，我将在控制器上定义模型，然后指令将以正常方式访问此模型。出于教学目的，`directiveA`仍将使用隔离范围，并将使用@Josh 的答案`directiveB`创建一个新的子范围。`scope: new`但是任何类型（隔离、新子、无新范围）和组合都可以工作，因为我们已经在父范围中定义了模型。

**控制**：

```
$scope.model = {value: '#33ff33', checkedState = true}; 
```

**HTML**：

```
<div ng-controller="NoTouchPrevSibling">
   <div data-directive-a data-value="model.value" data-checked="model.checkedState">
      <div data-directive-b></div>
   </div> 
```

出于其他教学原因，我选择将两个模型属性作为单独的属性传递指令 A，但也可以传递整个模型/对象。由于directiveB 将创建一个子范围，它不需要传递任何属性，因为它可以访问所有父/控制器范围属性。

**指令**：

```
app.directive('directiveA', function () {
    return {
        template: '<div>' 
            + 'inside parent directive: {{checkedState}}'
            + '<input type="checkbox" ng-model="checkedState" />'
            + '<div ng-transclude></div>'
            + '</div>',
        transclude: true,
        replace: true,
        scope: {
              value: '=',
              checkedState: '=checked'
            },
    };
});
app.directive('directiveB', function () {
    return {
        template: '<div>' 
            + '<span>inside transcluded directive: {{model.checkedState}}</span>'
            + '<input type="text" ng-model="model.value" />'
            + '</div>',
        replace: true,
        scope: true
    };
}); 
```

**范围**：

![范围](https://i.stack.imgur.com/D6U8w.png)

请注意，directiveB 的子作用域 (006) 继承自指令 A 的嵌入作用域 (005)。

单击复选框并更改文本框中的值后：

![交互后的作用域](https://i.stack.imgur.com/pA1tm.png)

请注意，Angular 会处理更新隔离范围属性。正常的[JavaScript 原型继承](https://stackoverflow.com/questions/14049480/what-are-the-nuances-of-scope-prototypal-prototypical-inheritance-in-angularjs/14049482#14049482)使指令 B 的子范围可以访问`model`控制器范围 (003) 中的 。

[小提琴](http://jsfiddle.net/mrajcok/bPpEb/)

# forms - XSS注入php表单firefox

> ID：15819395
> 
> 赞同：3
> 
> 时间：2013-04-04T18:53:52.113
> 
> 标签：forms, security, web, firefox-addon, xss

我在 Firefox 上运行 XSS 来测试我的一个脚本，但我收到以下消息：

`The character was found unencoded in the result page with ; / and \ symbols.`

该脚本通过了所有测试。这意味着什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T15:22:16.920

这说明它可以在页面上写一个 ;, / 或 \ 而不会被骚扰。这些字符可能会导致 xss，但可能不会。XSS 可能看起来像这样：

```
var "some_value\\""; alert(1)// 
```

通常你只关心尖括号：`<script>alert(1)</script>`

# c# - 如何从 wpf 中的 Web 浏览器控件获取文档的标题

> ID：15819397
> 
> 赞同：2
> 
> 时间：2013-04-04T18:53:55.180
> 
> 标签：c#, wpf, wpf-controls, webbrowser-control, tabcontrol

我在 TabControl 中创建了一个 Web 浏览器控件。我想将 TabItem 的 Header 设置为 Web 浏览器的文档标题。我在 WebBrowser 的导航事件中使用了以下代码

```
dynamic doc = tabBrowser.Document; //tabBrowser is the name of WebBrowser Control
tab.Header = doc.Title;            //tab is the name of the Tab Item 
```

但是这段代码不能正常工作。标题仅针对少数站点更改。如何将 tabItem 的标题设置为文档的标题值？

这是导航功能：

```
 public void tabBrowser_Navigated(object sender, System.Windows.Navigation.NavigationEventArgs e) 
    { 
       urlTextBox.Text = tabBrowser.Source.ToString(); 
       myHistory.addToHistory(tabBrowser.Source.ToString());
       BookMarks.addBookmark(tabBrowser.Source.ToString()); 
       dynamic doc = tabBrowser.Document; 
       tab.Header = doc.Title; 
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-17T17:14:33.203

在我的代码中，我使用了 WebBrowser 的 LoadCompleted 事件。可能在您的导航事件文档中仍未准备好并且文档标题不正确或为空。

```
private void MyWebBrowser_LoadCompleted_1(object sender, NavigationEventArgs e)
{
    try
    {
        MyTextBox.Text = MyWebBrowser.Source.ToString();
        Title_doc.Content = ((dynamic)MyWebBrowser.Document).Title;
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-08T21:25:53.260

这个会起作用

```
var docTitle = document.getElementsByTagName("title")
    .Cast<IHTMLElement>()
    .FirstOrDefault().innerText; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-10T20:29:06.683

至少当`(dynamic)Document`文档在操作期间发生更改时（操作无法完成，NotSupportedException，原因 8070000c），转换失败，如果用户单击链接太快，就会发生这种情况。

找到了另一个基于[Wpf webbrowser disable external links](https://stackoverflow.com/questions/34961152/wpf-webbrowser-disable-external-links) question UPDATE 2 link [https://social.technet.microsoft.com/wiki/contents/articles/22943.preventing-external-links-from-opening-in-new-的合理解决方案wpf-web-browser.aspx 中的窗口](https://social.technet.microsoft.com/wiki/contents/articles/22943.preventing-external-links-from-opening-in-new-window-in-wpf-web-browser.aspx)

[DWebBrowserEvents](https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768309(v%3Dvs.85))有 TitleChanged 事件，它似乎工作可靠，所以从那里调整代码，并将处理程序添加到这个事件。

```
wbEvents.TitleChange += new SHDocVw.DWebBrowserEvents_TitleChangeEventHandler(OnWebBrowserTitleChanged); 
```

处理程序只有一个参数，即字符串形式的新标题。

```
void OnWebBrowserTitleChanged(string title)
{
     // Set title where you want
} 
```

有点重，但我需要这两个才能工作......

*该链接代码还有其他问题，例如在 WebBrowser 的每个 LoadCompleted 事件上再次添加事件处理程序*

# linux - 安装软件时遇到问题 BLAT

> ID：15819399
> 
> 赞同：0
> 
> 时间：2013-04-04T18:54:05.563
> 
> 标签：linux, unix, installation, blat

在可执行文件上运行 make 命令时出现此错误。

```
gcc -O -g  -Wall -Wno-unused-variable  -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_GNU_SOURCE -DMACHTYPE_ -DUSE_SSL -DCOLOR32   -Wall -Wno-unused-variable  -I../inc -I../../inc -I../../../inc -I../../../../inc -I../../../../../inc   -o fixCr.o -c fixCr.c
gcc -O -g  -Wall -Wno-unused-variable  -o /Users/andregatorano/bin//fixCr fixCr.o  ../../lib//jkweb.a  -pthread -lssl -lcrypto -lpng
i686-apple-darwin11-llvm-gcc-4.2: ../../lib//jkweb.a: No such file or directory
make: *** [fixCr] Error 1 
```

有明显的错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:01:57.497

错误是明确的，您缺少`jkweb.a`文件：

```
jkweb.a: No such file or directory 
```

您必须搜索提供此文件的软件包或在某处下载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T22:26:53.277

我的机器类型为空，如此处所述[https://lists.soe.ucsc.edu/pipermail/genome/2009-November/020471.html](https://lists.soe.ucsc.edu/pipermail/genome/2009-November/020471.html)

# objective-c - 如何在可可中将基于单元格的表格转换为基于视图的表格？

> ID：15819400
> 
> 赞同：1
> 
> 时间：2013-04-04T18:54:05.847
> 
> 标签：objective-c, macos, cocoa, nstableview, nstablecellview

我很难理解如何在可可中实现基于视图的表。现在我正在实现老式的基于单元格的表格。正如我所知道的，只是将 NSTableCellView 拖到我的 NIB 文件中的列上不会使我的表格视图基于:)

我通读了这篇文章：http: [//developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/TableView/TableViewOverview/TableViewOverview.html](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/TableView/TableViewOverview/TableViewOverview.html)

但仍然一无所知...由于某种原因，我的 tableView:viewForTableColumn:row: 方法没有受到打击。

有人可以逐步解释如何将基于单元格的表格转换为基于视图的表格吗？

在我的基于单元格的表格中，我有：

```
// .h
#import "ObjectClass.h"
#import "ObjectTable.h"

@interface ObjViewController : NSObject <NSTableViewDataSource, NSTableViewDelegate>
{
    IBOutlet ObjectTable *objectTable;
    NSMutableArray *list;
    ObjViewController *current;
}  

//.m
#import "ObjViewController.h"

@implementation ObjViewController

-(id)init
{
   self = [super init];
   if (self)
   {
       current = self;
       list = [[NSMutableArray alloc] init];
   }

   return self;
}

- (NSInteger) numberOfRowsInTableView:(NSTableView *)tableView
{
    return [list count];
}

-(id) tableView:(NSTableView *)tableView objectValueForTableColumn:(NSTableColumn *)tableColumn
                                                               row:(NSInteger)row
{
    ObjectClass *obj = [list objectAtIndex:row];

    NSString *identifier = [tableColumn identifier];

    return [obj valueForKey: identifier];
}

// .h
@interface ObjectClass : NSObject
{
}
@property int categoryID;
@property int oID;
@property NSString *name;

@end 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:17:17.227

方法

```
tableView:viewForTableColumn:row: 
```

来自 NSTableViewDelegate 协议，一旦实现将使 NSTableView 成为基于视图的表。从上面的代码来看，视图控制器不符合 NSTableViewDelegate 协议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:11:36.700

确保您在 IB（属性检查器）中更改了表格的内容模式。您想要基于视图，而不是基于单元格。

# python - Django models.FileField - 只存储文件名而不是任何路径或文件夹引用

> ID：15819402
> 
> 赞同：6
> 
> 时间：2013-04-04T18:54:06.440
> 
> 标签：python, django, filefield

我正在使用 Django 的管理站点来管理一些数据——但没有构建 webapp。我需要文件上传字段来仅将文件名存储在数据库中。

现在我可以获得绝对路径，例如：/Users/me/uploads/file.png

或者使用upload_to 参数在数据库中获取类似这样的内容：uploads/file.png

我怎样才能让它变成这样：file.png

编辑：

我正在使用 sqlite 数据库并在另一个客户端中使用 - 因此在 db 条目中包含任何路径在我的情况下没有意义。

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-04T19:06:18.857

我会保留 FileField 并使用 python [os.path.basename](http://docs.python.org/3.2/library/os.path.html#os.path.basename)来提取文件名。

这可以用一个属性封装

```
class MyModel(models.Model):
   file = models.FileField(...)

   @property
   def filename(self):
       return os.path.basename(self.file.name) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-05T05:44:13.477

的`upload_to`arg`FileField`可以是可调用的。查看[文档](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.FileField.upload_to)

如果你真的只需要存储文件名，我认为你可以这样做。我没有尝试自己，但我认为它有效。

```
def only_filename(instance, filename):
    return filename

class MyModel(models.Model):
    file = models.FileField(upload_to=only_filename) 
```

# ruby-on-rails - Capybara + Rspec 嵌套路由

> ID：15819404
> 
> 赞同：1
> 
> 时间：2013-04-04T18:54:09.160
> 
> 标签：ruby-on-rails, rspec, capybara, nested-resources

在我有嵌套资源的地方，我的 Capybara RSPEC 测试遇到了一些困难。这是我收到的错误：

> 1) 照片页面访问照片路径 FactoryGirl创建记录后可以访问照片←[31mFailure/Error:←[0m ←[31mvisit mountain_photo_path(mountain, photo)←[0m
> 
> ```
>  ←[31mActiveRecord::RecordNotFound:←[0m
>    ←[31mCouldn't find Photo with id=1 [WHERE "photos"."mountain_id" = 1]←[0m 
> ```
> 
> ←[36m # C:in `find'←[0m ←[36m # ./app/controllers/photos_controller.rb:14:in`show'←[0m ←[36m # ./spec/requests/photo_pages_spec.rb:34:in `block (3 levels) in '←[0m

我的嵌套路线如下：

```
 resources :mountains do
    resources :photos
  end 
```

我正在我的 RSPEC 测试中测试以下内容：

```
require 'spec_helper'

describe "Photo pages" do
    let(:user) { FactoryGirl.create(:user)}
    let(:region) { FactoryGirl.create(:region)}
    let(:mountain) {FactoryGirl.create(:mountain)}
    let(:photo) {FactoryGirl.create(:photo)}

    before { sign_in user }

    describe "visit mountain path" do
        it "can be visited after FactoryGirl create" do
            visit mountain_path(mountain)
            page.should have_selector('h1', text: "Breck Test")
        end
    it "has the correct region associated to it" do
        visit mountain_path(mountain)
        page.should have_selector('h4', text: "Rockies")
    end
    end

    describe "visit photo path" do
        it "Photo can be visited after FactoryGirl create records" do
            visit mountain_photo_path(mountain, photo) 
            page.should have_selector('title', text: photo.name)
        end
    end

end 
```

我相信 FactoryGirl 正在成功创建所有记录。Photo 上的附件是通过 CarrierWave 完成的，调试后相信这也可以正确加载。

```
include ActionDispatch::TestProcess

FactoryGirl.define do
  factory :user do
    first_name 'Test'
    last_name 'User'
    email 'example@example.com'
    password 'password1'
    password_confirmation 'password1'
    # required if the Devise Confirmable module is used
    confirmed_at Time.now
  end
  factory :region do
    name 'Rockies'
  end
  factory :mountain do
    name 'Breck Test'
    region {|a| a.association(:region)}
    description 'This is my testing mountain only'
  end
  factory :photo do 
    name 'My Photo Test'
    description 'My lovely description'
    mountain {|a| a.association(:mountain)}
    image { fixture_file_upload(Rails.root + 'spec/fixtures/files/breck.jpg', "image/jpeg")}
  end
end 
```

我非常感谢这里小组的智慧，在此先感谢您的帮助。今天花了几个令人沮丧的时间来处理这个 rspec 代码，希望将来它会变得更容易。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:36:39.133

您的问题是您创建了 a `mountain`，然后创建了 a`photo`但它们不相关！

改为这样做：

```
require 'spec_helper'

describe "Photo pages" do
  let(:user) { FactoryGirl.create(:user)}
  let(:region) { FactoryGirl.create(:region)}
  let(:mountain) { FactoryGirl.create(:mountain)}
  let(:photo)    { FactoryGirl.create(:photo, mountain: mountain) }

  before { sign_in user }

  describe "visit photo path" do
    it "Photo can be visited after FactoryGirl create records" do
      visit mountain_photo_path(photo.mountain, photo) 
      page.should have_selector('title', text: photo.name)
    end
  end
end 
```

# android - 将 JSON 转换为内容值

> ID：15819406
> 
> 赞同：1
> 
> 时间：2013-04-04T18:54:11.363
> 
> 标签：android, sqlite, reflection, xamarin.android

有没有一种简单的方法可以从 web 服务获取 JSON 并将其放入我的 SQLite DB 中的 C# mono for android (xamarin)？有一些乏味的方法可以做到这一点，但我想要一些快速而优雅的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-16T22:48:02.090

这个问题很老，但这是Java中@gghuffer的等效代码：

```
public static ContentValues objectToContentValues(Object o) throws IllegalAccessException {
    ContentValues cv = new ContentValues();

    for (Field field : o.getClass().getFields()) {
        Object value = field.get(o);
        //check if compatible with contentvalues
        if (value instanceof Double || value instanceof Integer || value instanceof R.string || value instanceof Boolean
                || value instanceof Long || value instanceof Float || value instanceof Short) {
            cv.put(field.getName(), value.toString());
            Log.d("CVLOOP", field.getName() + ":" + value.toString());
        } else if (value instanceof Date) {
            cv.put(field.getName(), new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format((Date)value));
        }
    }

    return cv;
} 
```

为此，您需要使用库`Gson`并为所有（即 1 个对象 - 1 个 json）定义 java 类`json`，然后，对于每个类，您需要实现以下代码：

```
 public static YourClass fromJSON(String dpJSON) {
        Gson gson = new Gson();
        return gson.fromJson(dpJSON, YourClass.class);
 } 
```

最后，你有你的 json string `jsonStr`，所以：

```
ContentValues cv = Util.objectToContentValues(YourClass.fromJSON(jsonStr)); 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-26T18:59:29.283

我在使用`@SerializedName`注释时创建了以下类来处理这个问题，它还增加了对忽略某些字段的支持。希望它可以帮助某人。

```
import android.content.ContentValues;
import com.google.gson.annotations.SerializedName;

import java.lang.reflect.Field;
import java.util.Arrays;
import java.util.Date;
import java.util.List;

public class ContentValuesWriter {

    public static ContentValues objectToContentValues(Object o, Field... ignoredFields) {
        try {
            ContentValues values = new ContentValues();

            //Will ignore any of the fields you pass in here
            List<Field> fieldsToIgnore = Arrays.asList(ignoredFields);

            for(Field field : o.getClass().getDeclaredFields()) {
                field.setAccessible(true);

                if(fieldsToIgnore.contains(field))
                    continue;

                Object value = field.get(object);
                if(value != null) {
                    //This part just makes sure the content values can handle the field
                    if(value instanceof Double || value instanceof Integer || value instanceof String || value instanceof Boolean
                            || value instanceof Long || value instanceof Float || value instanceof Short) {
                        values.put(field.getAnnotation(SerializedName.class).value(), value.toString());
                    }
                    else if (value instanceof Date)
                        values.put(field.getName(), Constants.DATE_FORMAT_FULL.format((Date) value));
                    else
                        throw new IllegalArgumentException("value could not be handled by field: " + value.toString());
                }
                else
                    Print.log("value is null, so we don't include it");
            }

            return values;
        } catch(Exception e) {
            Print.exception(e);
            throw new NullPointerException("content values failed to build");
        }
    }

} 
```

您需要替换一些我的应用程序自定义的东西，只是日期格式和打印功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T18:54:11.363

我创建了一个静态类，它将使用反射将任何对象转换为内容值。我确信在 Java 中有一种等效的方法可以做到这一点。将您的 JSON 对象放入某种类中，这会将所有属性转换为内容值。

```
public static class Util
{
    //suck all of the data out of a class and put it into a ContentValues object for use in SQLite Database stuff
    public static ContentValues ReflectToContentValues(object o)
    {
        ContentValues cv = new ContentValues();

        foreach (var props in o.GetType().GetProperties())
        {
            object val = props.GetValue(o, null);
            //check if compatible with contentvalues (sbyte and byte[] are also compatible, but will you ever use them in an SQLite database?
            if (props.CanRead && props.CanWrite && (val is double || val is int || val is string || val is bool || val is long || val is float || val is short))
            {
                cv.Put(props.Name, val.ToString());
                Log.Info("CVLOOP", props.Name + ":" + val.ToString());
            }
            else if (val is DateTime)
                cv.Put(props.Name, ((DateTime)val).ToString("yyyy-MM-dd HH:mm:ss"));
        }

        return cv;
    }

} 
```

# javascript - Javascript：检查变量是否为假或根本不存在

> ID：15819409
> 
> 赞同：2
> 
> 时间：2013-04-04T18:54:17.197
> 
> 标签：javascript

我想编写一个使用参数值的函数。如果参数不存在，默认情况下将使用值 true。

```
var check = function(truthValue){
    var val = truthValue || true;
    console.log(val);
}; 
```

问题是，如果我将值*false*传递给它，因为它仍将使用默认值。那么如何检查变量是否存在并在 Javascript 中使用该值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T18:54:54.797

采用

```
if (typeof val === 'undefined') val = true; 
```

# c++ - 将文本文件中的单词加载到c ++中的地图

> ID：15819411
> 
> 赞同：-4
> 
> 时间：2013-04-04T18:54:25.387
> 
> 标签：c++, file-io, map

我正在尝试制作一个程序来计算特定单词在文本中出现的次数。单词列表将在一个文本文件中，而文本将在另一个文件中。列表中的单词和单词数量未知。我的计划是将单词列表制作成以`map<string,int>name`不同单词为键的样式的地图，然后在地图中将值增加一。

这是一个例子：

文件.txt：

```
This is the text the program will analyze with the other file. Fun stuff. 
```

列表.txt：

```
the
other
normal 
```

运行程序时的预期结果是：

```
name[the] = 3
name[other] = 1
name[normal] = 0 
```

**我需要帮助解决的主要问题是如何从文本文件中的单词制作地图。**我大概可以自己整理其他的东西。我显然无法向您展示我的任何代码，因为我需要在开始之前对其进行整理。

此外，这不是一项任务，因此我可以自由地以任何其他方式进行。请告诉您是否知道更有效的方法来做到这一点！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:04:22.647

1.  从*文本*文件中读取一个单词。

2.  增加该单词的映射条目

3.  （重复）

然后

1.  从*单词*文件中读取一个单词。

2.  输出该单词的地图条目

3.  （重复）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:38:37.703

这很大程度上取决于您希望在单词列表中占多少百分比的文本文件。如果您希望大多数单词都在列表中，那么@DrewDorman 的解决方案应该可以很好地工作。

如果您希望列表中只有一小部分单词，那么这可能会非常浪费。在这种情况下，您可能希望首先将列表中的单词插入到地图中（计数为 0），然后当您从文本文件中读取单词时，在地图中搜索每个单词并增加计数，如果且仅如果地图中已经存在该单词的条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:01:04.497

your_map.insert(std::pair(your_string, your_int));

如果字数不多，也可以考虑使用multimap，然后调用count：

[http://www.cplusplus.com/reference/map/multimap/count/](http://www.cplusplus.com/reference/map/multimap/count/)

# javascript - 为按钮重定向到 html 中的网站

> ID：15819415
> 
> 赞同：-3
> 
> 时间：2013-04-04T18:54:32.860
> 
> 标签：javascript, html, redirect

我正在创建一个带有同意和不同意按钮的 HTML 启动页面。当用户单击同意按钮时，我无法重定向到 URL。

**例子**

```
<head>
<meta http-equiv="Pragma" content="no-cache">
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<title> TITLE </title>
<script>

function submitAction(){
  var link = document.location.href;
  var searchString = "redirect=";
  var equalIndex = link.indexOf(searchString);
  var redirectUrl = "";

  if (document.forms[0].action == "") {
  var url = window.location.href;
  var args = new Object();
  var query = location.search.substring(1);
  var pairs = query.split("&");
      for(var i=0;i<pairs.length;i++){
          var pos = pairs[i].indexOf('=');
          if(pos == -1) continue;
          var argname = pairs[i].substring(0,pos);
          var value = pairs[i].substring(pos+1);
          args[argname] = unescape(value);
      }
      document.forms[0].action = args.switch_url;       
  }       
  if(equalIndex >= 0) {
        equalIndex += searchString.length;
        redirectUrl = "";
        redirectUrl += link.substring(equalIndex);
  }
  if(redirectUrl.length > 255)
  redirectUrl = redirectUrl.substring(0,255);
  document.forms[0].redirect_url.value = redirectUrl;
  document.forms[0].buttonClicked.value = 4;
  document.forms[0].submit();
}

function reject()
{
alert("You will not be able to access the system!");
}

function loadAction(){
  var url = window.location.href;
  var args = new Object();
  var query = location.search.substring(1);
  var pairs = query.split("&");
  for(var i=0;i<pairs.length;i++){
      var pos = pairs[i].indexOf('=');
      if(pos == -1) continue;
      var argname = pairs[i].substring(0,pos);
      var value = pairs[i].substring(pos+1);
      args[argname] = unescape(value);
  }
  document.forms[0].action = args.switch_url;

}

</script>
</head>    
<body style="background-color:#FFFFFF;" topmargin="50" marginheight="50" 
        onload="loadAction();"> <form method="post"> <input TYPE="hidden" 
NAME="buttonClicked"     SIZE="16" MAXLENGTH="15" value="0"> <input TYPE="hidden"  

NAME="redirect_url" SIZE="255"   MAXLENGTH="255" VALUE=""> <input TYPE="hidden" 

NAME="err_flag" SIZE="16" MAXLENGTH="15"   value="0">

<div style="text-align:center;">
<p><IMG SRC="./11.jpg"></p>
<p><img src="1223.jpg" alt="Wireless Print" title="Wireless Print" /></p>
</div>

<p align=center><iframe src="./aup.html" width="90%" height="500" scrolling="auto"> 

</iframe></p>

<div style="text-align:center;">
  <input style="font-weight:bold;height:75px;width:200px;font-size:24pt;" type="button"    

name="Reject" value="Reject" class="button" onclick="reject();">
<input style="font-weight:bold;height:75px;width:200px;font-size:24pt; margin-left:75px;"  

type="button" name="Submit" value="Accept" class="button" onclick="submitAction();">
</div>

<div style="text-align:center; margin:1em 1em; margin: 1em 0 auto 1em">
<div style="font-weight:bold; text-align:center; color:#FFFFFF; background-color:#634099;   

width:90%; margin: 0 auto; font-family:Verdana,Arial;">
 <br /> Example <br /><br />
</div>

</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:58:06.557

我将使用**Window.location**，请参阅此页面以查看示例：

[http ://www.w3schools.com/js/js_window_location.asp](http://www.w3schools.com/js/js_window_location.asp)

在 HTML 中，您可以使用：

onclick="**返回**submitAction();"

并在函数 submitAction() 的末尾写入**return true；**取消提交或**返回false；**允许提交。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T18:58:09.147

在 JavaScript 中，使用`window.location.assign(URL)`方法，例如

```
function redirect(url)
{
window.location.assign(url);
} 
```

# python - 执行 python if 语句时，方法返回值是否存储在任何地方？

> ID：15819422
> 
> 赞同：1
> 
> 时间：2013-04-04T18:54:49.160
> 
> 标签：python

`_`在python解释器中，当一个方法返回并且它没有被存储到一个变量时，它默认被放入变量中

```
In [10]: def foo(x):
   ....:     return x
   ....: 

In [11]: foo(1)
Out[11]: 1

In [12]: _
Out[12]: 1

In [13]: x = foo(2)

In [14]: _
Out[14]: 1

In [15]: x
Out[15]: 2 
```

我想知道在进行比较语句时它是否也存储到另一个变量？像这样的东西

```
In [16]: if foo(2):
   ....:     print <the returned value from foo>
   ....:     
2 
```

显然这不起作用，我必须做这样的事情

```
In [17]: returned_value_from_foo = foo(2)

In [18]: if returned_value_from_foo:
   ....:     print returned_value_from_foo
   ....:   
2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:07:19.627

快速回答是**否定**的。

在解释器中使用`_`只是为了方便进行交互工作。例如，当我将 Python 环境用作计算器时，我会使用它。它并不打算用作真正的变量，据我所知，这种行为甚至不存在于交互式解释器之外。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T19:07:39.300

这是强调语句和表达式之间区别的好时机。表达式总是返回一些值（可能是`None`），并且由算术表达式、函数调用、列表推导等组成。

另一方面，语句不一定返回值（大多数没有）。`if`和`while`、、、`for`和变量赋值之类的东西`import`是语句的例子，在 python 中不返回任何值。

每个表达式也可以作为一个语句单独存在，但反之则不成立。

的情况下`if`，也有条件*表达式*形式，但看起来有点不同：

```
>>> x = 10
>>> y = 20 if x == 10 else 5
>>> y
20
>>> x = 15
>>> y = 20 if x == 10 else 5
>>> y
5 
```

# php - 带有 Symfony 服务的 PHPUnit

> ID：15819424
> 
> 赞同：0
> 
> 时间：2013-04-04T18:54:53.517
> 
> 标签：php, unit-testing, symfony, phpunit

所以我对 PHPUnit 和单元测试相当陌生，但我想对我编写的服务进行单元测试。该服务基本上找到实体并更新实体内的属性。我正在使用 EntityManager 的 persist() 和 flush() 方法来更新与实体关联的数据库表。

笼统地说，我将如何在不访问数据库的情况下对服务进行单元测试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:00:11.193

您可以（除其他外）创建一个[模拟](http://www.phpunit.de/manual/3.0/en/mock-objects.html)数据库连接并将其放在实际连接的位置。在这个模拟中，您将检查发送到数据库的查询是否是它们应该是的。

# c++ - 访问冲突读取位置 0xCCCCCCCC

> ID：15819427
> 
> 赞同：0
> 
> 时间：2013-04-04T18:54:58.683
> 
> 标签：c++, pointers, access-violation

我的程序有问题我不知道该怎么办:(

```
double spocitaj(FILE *fr,double **polsum, int *cena){

int r=0, i=0,k=0;
double n=0;
char c;

while((c=getc(fr))!=EOF){
    if(c=='\n') r++;
    if(r==4){
        *cena=k++;
        r=5;
    }
    if(r==6) r=0;       
}

*polsum=(double *)calloc(k,sizeof(double));
r=1;
rewind(fr);

while((c=getc(fr))!=EOF){

    if(c=='\n') r++;
    if(r==4) {
                    ungetc(c,fr);
            fscanf(fr,"%lf", &n);
            *polsum[i]=n;
            i++;
    }
    if(r==6) r=1;       
}

for(i=0;i<*cena;i++)
                    printf("%.2lf\n", *polsum[i]);
return 0; 
```

}

你能帮我吗？`0x012947F8`这是一条消息： Projekt 1.exe 中未处理的异常`0xC0000005`：：

> 访问违规写入位置`0xCCCCCCCC`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T19:00:11.390

`*polsum[i]=n;`应该是`(*polsum)[i] = n;`。

`*polsum[i]`is `*(polsum[i])`，它被视为`polsum`一个数组，但您可能希望它是一个指针，一个指向存在`double *`.

将其更改为`(*polsum)[i])`“查找指向的`double *`位置`polsum`。`double *`指向有很多`double`对象的地方。获取`i`^第一个。”</p>

# python - 如何在 Python 中初始化嵌套字典

> ID：15819428
> 
> 赞同：10
> 
> 时间：2013-04-04T18:55:01.797
> 
> 标签：python, dictionary, python-2.7, initialization, nested

我正在使用 Python v2.7 字典，像这样嵌套在另一个字典中：

```
def example(format_str, year, value):
  format_to_year_to_value_dict = {}
  # In the actual code there are many format_str and year values,
  # not just the one inserted here.
  if not format_str in format_to_year_to_value_dict:
    format_to_year_to_value_dict[format_str] = {}
  format_to_year_to_value_dict[format_str][year] = value 
```

在插入二级字典之前用空字典初始化一级字典似乎有点笨拙。如果还没有一个字典，有没有办法在第一级创建字典的同时设置一个值？我想像这样避免条件初始化器：

```
def example(format_str, year, value):
  format_to_year_to_value_dict = {}
  add_dict_value(format_to_year_to_value_dict[format_str], year, value) 
```

另外，如果内部 dict 本身应该初始化为列表怎么办？

```
def example(format_str, year, value):
  format_to_year_to_value_dict = {}
  # In the actual code there are many format_str and year values,
  # not just the one inserted here.
  if not format_str in format_to_year_to_value_dict:
    format_to_year_to_value_dict[format_str] = {}
  if not year in format_to_year_to_value_dict[format_str]:
    format_to_year_to_value_dict[format_str][year] = []
  format_to_year_to_value_dict[format_str][year].append(value) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-04T18:56:53.093

使用[`setdefault`](http://docs.python.org/2/library/stdtypes.html#dict.setdefault)：

> 如果键在字典中，则返回其值。如果不是，则插入值为默认值的键并返回默认值。

```
format_to_year_to_value_dict.setdefault(format_str, {})[year] = value 
```

或者[`collections.defaultdict`](http://docs.python.org/2/library/collections.html#collections.defaultdict)：

```
format_to_year_to_value_dict = defaultdict(dict)
...
format_to_year_to_value_dict[format_str][year] = value 
```

* * *

使用内部字典中的列表：

```
def example(format_str, year, value):
  format_to_year_to_value_dict = {}

  format_to_year_to_value_dict.setdefault(format_str, {}).setdefault(year, []).append(value) 
```

或者

```
def example(format_str, year, value):
  format_to_year_to_value_dict = defaultdict(lambda: defaultdict(list))

  format_to_year_to_value_dict[format_str][year].append(value) 
```

* * *

对于未知深度的字典，你可以使用这个小技巧：

```
tree = lambda: defaultdict(tree)

my_tree = tree()
my_tree['a']['b']['c']['d']['e'] = 'whatever' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T18:57:14.283

```
from collections import defaultdict
format_to_year_to_value_dict = defaultdict(dict) 
```

这将创建一个字典，`dict()`当您访问不存在的键时调用该字典。

# javascript - SetInterval/Slider 不适用于 Chrome

> ID：15819429
> 
> 赞同：3
> 
> 时间：2013-04-04T18:55:04.413
> 
> 标签：javascript, jquery, html, css

我正在使用 codrops 的循环内容轮播，并进行了一些修改。

我正在尝试使用 setInterval 调用使滑块自动滚动。在 IE 和 Firefoxe 中它可以正常工作，但在 Chrome 中它只会滑动一次并且不会再滑动。谁能检查我的 setInterval 代码有什么问题？

这是我用于自动滚动的一段代码：

```
var autoscroll = setInterval(function() {
    aux.navigate( 1, $el, $wrapper, settings, cache );
},5000); 
```

我需要使用给定的变量调用 aux.navigate，这是使滑块永远滚动的一种方式。

这是经过我修改的 Slider 的完整代码（自动滚动代码接近尾声，在方法部分的末尾）：

```
(function($) {

var aux     = {

        // navigates left / right
        navigate    : function( dir, $el, $wrapper, opts, cache ) {

            var scroll      = opts.scroll,
                factor      = 1,
                idxClicked  = 0;

            if( cache.expanded ) {
                scroll      = 1; // scroll is always 1 in full mode
                factor      = 3; // the width of the expanded item will be 3 times bigger than 1 collapsed item 
                idxClicked  = cache.idxClicked; // the index of the clicked item
            }

            // clone the elements on the right / left and append / prepend them according to dir and scroll
            if( dir === 1 ) {
                $wrapper.find('div.ca-item:lt(' + scroll + ')').each(function(i) {
                    $(this).clone(true).css( 'left', ( cache.totalItems - idxClicked + i ) * cache.itemW * factor + 'px' ).appendTo( $wrapper );
                });
            }
            else {
                var $first  = $wrapper.children().eq(0);

                $wrapper.find('div.ca-item:gt(' + ( cache.totalItems  - 1 - scroll ) + ')').each(function(i) {
                    // insert before $first so they stay in the right order
                    $(this).clone(true).css( 'left', - ( scroll - i + idxClicked ) * cache.itemW * factor + 'px' ).insertBefore( $first );
                });
            }

            // animate the left of each item
            // the calculations are dependent on dir and on the cache.expanded value
            $wrapper.find('div.ca-item').each(function(i) {
                var $item   = $(this);
                $item.stop().animate({
                    left    :  ( dir === 1 ) ? '-=' + ( cache.itemW * factor * scroll ) + 'px' : '+=' + ( cache.itemW * factor * scroll ) + 'px'
                }, opts.sliderSpeed, opts.sliderEasing, function() {
                    if( ( dir === 1 && $item.position().left < - idxClicked * cache.itemW * factor ) || ( dir === -1 && $item.position().left > ( ( cache.totalItems - 1 - idxClicked ) * cache.itemW * factor ) ) ) {
                        // remove the item that was cloned
                        $item.remove();
                    }                       
                    cache.isAnimating   = false;
                });
            });

        },
        // opens an item (animation) -> opens all the others
        openItem    : function( $wrapper, $item, opts, cache ) {
            cache.idxClicked    = $item.index();
            // the item's position (1, 2, or 3) on the viewport (the visible items) 
            cache.winpos        = aux.getWinPos( $item.position().left, cache );

            $wrapper.find('div.ca-item').not( $item ).hide();

            $wrapper.find('div.ca-item-main').hide();

            //$item.find('div.ca-content-wrapper').stop().animate({ sera a solução para nao haver espaço branco ao fim do scroll em fullscreen??
            $item.find('div.ca-content-wrapper').css( 'left', cache.itemW + 'px' ).stop().animate({
                width   : cache.itemW * 3 + 'px',
                left    : '0px'
            }, opts.itemSpeed, opts.itemEasing)
            .end()
            .stop()
            .animate({
                left    : '0px'
            }, opts.itemSpeed, opts.itemEasing, function() {
                cache.isAnimating   = false;
                cache.expanded      = true;

                aux.openItems( $wrapper, $item, opts, cache );
            });

        },
        // opens all the items
        openItems   : function( $wrapper, $openedItem, opts, cache ) {
            var openedIdx   = $openedItem.index();

            $wrapper.find('div.ca-item').each(function(i) {
                var $item   = $(this),
                    idx     = $item.index();

                if( idx !== openedIdx ) {
                    $item.css( 'left', - ( openedIdx - idx ) * ( cache.itemW * 3 ) + 'px' ).show().find('div.ca-content-wrapper').css({
                        left    : '0px',
                        width   : cache.itemW * 3 + 'px'
                    });
                }
            });
        },
        // close all the items
        // the current one is animated
        closeItems  : function( $wrapper, $openedItem, opts, cache ) {
            var openedIdx   = $openedItem.index();

            $openedItem.find('div.ca-content-wrapper').stop().animate({
                width   : '0px'
            }, opts.itemSpeed, opts.itemEasing)
            .end()
            .stop()
            .animate({
                left    : cache.itemW * ( cache.winpos - 1 ) + 'px'
            }, opts.itemSpeed, opts.itemEasing, function() {
                cache.isAnimating   = false;
                cache.expanded      = false;
            });

            $wrapper.find('div.ca-item').each(function(i) {
                var $item   = $(this),
                    idx     = $item.index();

                $item.find('div.ca-item-main').show();

                if( idx !== openedIdx ) {
                    $item.find('div.ca-content-wrapper').css({
                        width   : '0px'
                    })
                    .end()
                    .css( 'left', ( ( cache.winpos - 1 ) - ( openedIdx - idx ) ) * cache.itemW + 'px' )
                    .show();
                }
            });
        },
        // gets the item's position (1, 2, or 3) on the viewport (the visible items)
        // val is the left of the item
        getWinPos   : function( val, cache ) {
            switch( val ) {
                case 0                  : return 1; break;
                case cache.itemW        : return 2; break;
                case cache.itemW * 2    : return 3; break;
            }
        }
    },
    methods = {
        init        : function( options ) {

            if( this.length ) {

                var settings = {
                    sliderSpeed     : 500,          // speed for the sliding animation
                    sliderEasing    : 'easeOutExpo',// easing for the sliding animation
                    itemSpeed       : 500,          // speed for the item animation (open / close)
                    itemEasing      : 'easeOutExpo',// easing for the item animation (open / close)
                    scroll          : 1             // number of items to scroll at a time
                };

                return this.each(function() {

                    // if options exist, lets merge them with our default settings
                    if ( options ) {
                        $.extend( settings, options );
                    }

                    var $el             = $(this),
                        $wrapper        = $el.find('div.ca-wrapper'),
                        $items          = $wrapper.children('div.ca-item'),
                        cache           = {};

                    // save the with of one item    
                    cache.itemW         = $items.width();
                    // save the number of total items
                    cache.totalItems    = $items.length;

                    // add navigation buttons
                    if( cache.totalItems > 3 )  
                        $el.prepend('<div class="ca-nav"><span class="ca-nav-prev">Previous</span><span class="ca-nav-next">Next</span></div>') 

                    // control the scroll value
                    if( settings.scroll < 1 )
                        settings.scroll = 1;
                    else if( settings.scroll > 3 )
                        settings.scroll = 3;    

                    var $navPrev        = $el.find('span.ca-nav-prev'),
                        $navNext        = $el.find('span.ca-nav-next');

                    // hide the items except the first 3
                    $wrapper.css( 'overflow', 'hidden' );

                    // the items will have position absolute 
                    // calculate the left of each item
                    $items.each(function(i) {
                        $(this).css({
                            position    : 'absolute',
                            left        : i * cache.itemW + 'px'
                        });
                    });

                    // click to open the item(s)
                    $el.find('a.ca-more').live('click.contentcarousel', function( event ) {
                        if( cache.isAnimating ) return false;
                        cache.isAnimating   = true;
                        var $item   = $(this).closest('div.ca-item');
                        aux.openItem( $wrapper, $item, settings, cache );
                        return false;
                    });

                    // click to close the item(s)
                    $el.find('a.ca-close').live('click.contentcarousel', function( event ) {
                        if( cache.isAnimating ) return false;
                        cache.isAnimating   = true;
                        var $item   = $(this).closest('div.ca-item');
                        aux.closeItems( $wrapper, $item, settings, cache );
                        return false;
                    });

                    // navigate left
                    $navPrev.bind('click.contentcarousel', function( event ) {
                        if( cache.isAnimating ) return false;
                        cache.isAnimating   = true;
                        aux.navigate( -1, $el, $wrapper, settings, cache );
                    });

                    // navigate right
                    $navNext.bind('click.contentcarousel', function( event ) {
                        if( cache.isAnimating ) return false;
                        cache.isAnimating   = true;
                        aux.navigate( 1, $el, $wrapper, settings, cache );
                    });

                    // adds events to the mouse
                    $el.bind('mousewheel.contentcarousel', function(e, delta) {
                        if(delta > 0) {
                            if( cache.isAnimating ) return false;
                            cache.isAnimating   = true;
                            aux.navigate( -1, $el, $wrapper, settings, cache );
                        }   
                        else {
                            if( cache.isAnimating ) return false;
                            cache.isAnimating   = true;
                            aux.navigate( 1, $el, $wrapper, settings, cache );
                        }   
                        return false;
                    });

                    var autoscroll = setInterval(function() {
                    aux.navigate( 1, $el, $wrapper, settings, cache );
                    },1000);

                });
            }
        }
    };

$.fn.contentcarousel = function(method) {
    if ( methods[method] ) {
        return methods[method].apply( this, Array.prototype.slice.call( arguments, 1 ));
    } else if ( typeof method === 'object' || ! method ) {
        return methods.init.apply( this, arguments );
    } else {
        $.error( 'Method ' +  method + ' does not exist on jQuery.contentcarousel' );
    }
};

})(jQuery); 
```

我尝试了很多代码组合，搜索了很多，但无法使其在 Chrome 上运行，在其他浏览器中运行良好。非常感谢您对此的任何教导和帮助。

**PS/编辑：**

**我将 Slider 添加到临时服务器，您可以在此处使用完整代码在线找到它：http: [//ceh.ilch.uminho.pt/test/](http://ceh.ilch.uminho.pt/test/)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:32:18.157

我看不出 Chrome 应该有问题的特定原因（除了它现在是一个常见的主题）但是你可以尝试触发点击“下一步”按钮，以自动照顾`cache.isAnimating`：

```
var autoscroll = setInterval(function() {
    $navNext.trigger('click.contentcarousel');
}, 5000); 
```

## 编辑

好的，在对代码进行了一些认真的整理并转换为使用 jQuery 1.9.1（以前的 jQuery 1.6.2）之后，我最终得到了这个：

```
(function($) {
    var pluginName = 'contentcarousel';

    //Define event namespace strings
    var evt_ns = {
        click: 'click.' + pluginName,
        mousewheel: 'mousewheel.' + pluginName
    };
    var aux = {
        // navigates left / right
        navigate: function( dir, $el, $wrapper, opts, cache ) {
            if( cache.isAnimating ) return;
            cache.isAnimating = true;
            var scroll = ( cache.expanded ) ? 1 : opts.scroll,
                factor = ( cache.expanded ) ? 3 : 1,// expanded width will be 3x that of one collapsed item
                idxClicked = ( cache.expanded ) ? cache.idxClicked : 0;
            // clone the elements on the right / left and append / prepend them according to dir and scroll
            if( dir === 1 ) {
                $wrapper.find('div.ca-item:lt(' + scroll + ')').each(function(i) {
                    $(this).clone(true).css( 'left', ( cache.totalItems - idxClicked + i ) * cache.itemW * factor + 'px' ).appendTo( $wrapper );
                });
            }
            else {
                var $first = $wrapper.children().eq(0);
                $wrapper.find('div.ca-item:gt(' + ( cache.totalItems  - 1 - scroll ) + ')').each(   function(i) {
                    // insert before $first so they stay in the right order
                    $(this).clone(true).css( 'left', - ( scroll - i + idxClicked ) * cache.itemW * factor + 'px' ).insertBefore( $first );
                });
            }
            // animate the left of each item
            // the calculations are dependent on dir and on the cache.expanded value
            $wrapper.find('div.ca-item').each(function(i) {
                var $item = $(this);
                $item.stop().animate({
                    left : ( dir === 1 ) ? '-=' + ( cache.itemW * factor * scroll ) + 'px' : '+=' + ( cache.itemW * factor * scroll ) + 'px'
                }, opts.sliderSpeed, opts.sliderEasing, function() {
                    if( ( dir === 1 && $item.position().left < - idxClicked * cache.itemW * factor ) || ( dir === -1 && $item.position().left > ( ( cache.totalItems - 1 - idxClicked ) * cache.itemW * factor ) ) ) {
                        // remove the item that was cloned
                        $item.remove();
                    }
                    cache.isAnimating = false;
                });
            });
        },
        // opens an item (animation) -> opens all the others
        openItem: function( $wrapper, $item, opts, cache ) {
            if( cache.isAnimating ) return;
            cache.isAnimating = true;
            cache.idxClicked = $item.index();
            // the item's position (1, 2, or 3) on the viewport (the visible items) 
            cache.winpos = aux.getWinPos( $item.position().left, cache );
            $wrapper.find('div.ca-item').not( $item ).hide();
            $wrapper.find('div.ca-item-main').hide();
            //$item.find('div.ca-content-wrapper').stop().animate({ sera a solução para nao haver espaço branco ao fim do scroll em fullscreen??
            $item.find('div.ca-content-wrapper').css( 'left', cache.itemW + 'px' ).stop().animate({
                left : '0px',
                width : cache.itemW * 3 + 'px'
            }, opts.itemSpeed, opts.itemEasing).end().stop().animate({
                left : '0px'
            }, opts.itemSpeed, opts.itemEasing, function() {
                cache.isAnimating = false;
                cache.expanded = true;
                aux.openItems( $wrapper, $item, opts, cache );
            });
        },
        // opens all the items
        openItems: function( $wrapper, $openedItem, opts, cache ) {
            var openedIdx = $openedItem.index();
            $wrapper.find('div.ca-item').each(function(i) {
                var $item = $(this),
                    idx = $item.index();
                if( idx !== openedIdx ) {
                    $item.css( 'left', - ( openedIdx - idx ) * ( cache.itemW * 3 ) + 'px' ).show().find('div.ca-content-wrapper').css({
                        left : '0px',
                        width : cache.itemW * 3 + 'px'
                    });
                }
            });
        },
        // close all the items
        // the current one is animated
        closeItems: function( $wrapper, $openedItem, opts, cache ) {
            if( cache.isAnimating ) return;
            cache.isAnimating = true;
            var openedIdx = $openedItem.index();
            $openedItem.find('div.ca-content-wrapper').stop().animate({
                width: '0px'
            }, opts.itemSpeed, opts.itemEasing).end().stop().animate({
                left: cache.itemW * ( cache.winpos - 1 ) + 'px'
            }, opts.itemSpeed, opts.itemEasing, function() {
                cache.isAnimating = false;
                cache.expanded = false;
            });
            $wrapper.find('div.ca-item').each(function(i) {
                var $item = $(this),
                    idx = $item.index();
                $item.find('div.ca-item-main').show();
                if( idx !== openedIdx ) {
                    $item.find('div.ca-content-wrapper').css({
                        width: '0px'
                    }).end().css( 'left', ( ( cache.winpos - 1 ) - ( openedIdx - idx ) ) * cache.itemW + 'px' ).show();
                }
            });
        },
        // gets the item's position (1, 2, or 3) on the viewport (the visible items)
        // val is the left of the item
        getWinPos: function( val, cache ) {
            switch( val ) {
                case 0: return 1; break;
                case cache.itemW: return 2; break;
                case cache.itemW * 2: return 3; break;
            }
        },
        startAuto: function( dir, $el, $wrapper, settings, cache ) {
        aux.stopAuto( cache );
            aux.navigate( dir, $el, $wrapper, settings, cache );
            cache.autoscroll = setInterval(function() {
                aux.navigate( dir, $el, $wrapper, settings, cache );
            }, 1000);
        },
        stopAuto: function( cache ) {
            if(cache.autoscroll) {
                clearInterval(cache.autoscroll);
                cache.autoscroll = null;
                return true;
            }
            return false;
        }
    },
    methods = {
        init : function( options ) {
            if( this.length ) {
                var settings = {
                    autoStart: false,
                    sliderSpeed: 500, // speed for the sliding animation
                    sliderEasing: 'easeOutExpo',// easing for the sliding animation
                    itemSpeed: 500, // speed for the item animation (open / close)
                    itemEasing: 'easeOutExpo',// easing for the item animation (open / close)
                    scroll: 1 // number of items to scroll at a time
                };
                return this.each(function() {
                    // if options exist, lets merge them with our default settings
                    if ( options ) {
                        $.extend( settings, options );
                    }
                    // control the scroll value
                    settings.scroll = Math.max(Math.min(settings.scroll, 3), 1);
                    var $el = $(this),
                        $wrapper = $el.find('div.ca-wrapper'),
                        $items = $wrapper.children('div.ca-item'),
                        cache = {
                            autoscroll: null,
                            itemW: $items.width(),// save the width of one item
                            totalItems: $items.length// save the number of total items
                        };
                    // add navigation buttons
                    if( cache.totalItems > 3 )
                        $el.prepend('<div class="ca-nav"><span class="ca-nav-prev">Previous</span><span class="ca-nav-next">Next</span></div>');
                    var controls = {
                        navPrev: $el.find('span.ca-nav-prev'),
                        navNext: $el.find('span.ca-nav-next'),
                        more: $el.find('a.ca-more'),
                        close: $el.find('a.ca-close'),
                        auto: $el.find('a.ca-auto')
                    };

                    // hide the items except the first 3
                    $wrapper.css( 'overflow', 'hidden' );

                    // the items will have position absolute 
                    // calculate the left of each item
                    $items.each(function(i) {
                        $(this).css({
                            position: 'absolute',
                            left: i * cache.itemW + 'px'
                        });
                    });
                    // click to open the item(s)
                    controls.more.on(evt_ns.click, function( event ) {
                        aux.stopAuto( cache );
                        var $item = $(this).closest('div.ca-item');
                        aux.openItem( $wrapper, $item, settings, cache );
                        return false;
                    });
                    // click to close the item(s)
                    controls.close.on(evt_ns.click, function( event ) {
                        aux.stopAuto( cache );
                        var $item = $(this).closest('div.ca-item');
                        aux.closeItems( $wrapper, $item, settings, cache );
                        return false;
                    });
                    // navigate left
                    controls.navPrev.on(evt_ns.click, function( event ) {
                        if ( !aux.stopAuto( cache ) ) {
                            if (event.ctrlKey) aux.startAuto( -1, $el, $wrapper, settings, cache );
                            else aux.navigate( -1, $el, $wrapper, settings, cache );
                        }
                        return false;
                    });
                    // navigate right
                    controls.navNext.on(evt_ns.click, function( event ) {
                        if ( !aux.stopAuto( cache ) ) {
                            if (event.ctrlKey) aux.startAuto( 1, $el, $wrapper, settings, cache );
                            else aux.navigate( 1, $el, $wrapper, settings, cache );
                        }
                        return false;
                    });
                    // add event handler to the mousewheel
                    $el.on(evt_ns.mousewheel, function( event, delta ) {
                        if (!aux.stopAuto( cache )) {
                            aux.navigate( (delta > 0) ? -1 : 1, $el, $wrapper, settings, cache);
                        }
                        return false;
                    });
                    // add event handler to an optional "auto" button
                    controls.auto.on(evt_ns.click, function( event ) {
                        aux.startAuto(1, $el, $wrapper, settings, cache);
                        return false;
                    });
                    // autoStart
                    if(settings.autoStart) {
                        $(window).on('load', function() {
                            setTimeout(function() {
                                aux.startAuto(1, $el, $wrapper, settings, cache);
                            }, 1000);
                        });
                    }
                });
            }
        }
    };
    $.fn[pluginName] = function(method) {
        if ( methods[method] ) {
            return methods[method].apply( this, Array.prototype.slice.call( arguments, 1 ));
        } else if ( typeof method === 'object' || ! method ) {
            return methods.init.apply( this, arguments );
        } else {
            $.error( 'Method ' +  method + ' does not exist on jQuery.' + pluginName );
        }
    };
})(jQuery); 
```

我不确定是什么修复了它，但可能是 jQuery 的更高版本。许多事情在 1.7 时有所改善，然后在 1.8 和 1.9 时逐渐改善。

除了修复 Chrome 问题外，还有一些好东西给你：

*   要在页面加载时启动 autoScroll，请使用选项初始化`autoStart: true`（默认为`false`）。

*   可选地包括一个“自动”按钮（如“更多”和“关闭”）来启动自动滚动。

*   单击“上一个”、“下一个”、“更多”或“关闭”控件以停止自动滚动。

*   控制单击“上一个”或“下一个”控件以启动 autoScroll。

仅控制单击“prev”向左自动滚动。所有其他自动滚动都正确。

示例初始化：

```
$(function() {
    $('#ca-container').contentcarousel({
        autoStart: true
    });
}); 
```

确保在部署之前测试所有内容。

# oracle - 在 JDBC 连接中使用 TNS 名称和服务名称的区别

> ID：15819433
> 
> 赞同：25
> 
> 时间：2013-04-04T18:55:22.457
> 
> 标签：oracle, tomcat, jdbc

我有一个基于 Java 的服务器 (Tomcat)，它使用 JDBC 连接连接到 Oracle 数据库。连接数据库有多种方式：SID、TNS 名称、服务名称。

我想了解这些连接中的每一个之间有什么区别，如果连接到集群数据库，推荐的连接（SID、TNS 或服务）是什么。这是我们为数据库设置的 TNS 名称：

```
MY_NICE_TNS_NAME.MY_COMPANY.COM =

(DESCRIPTION =

  (ADDRESS = (PROTOCOL = TCP)(HOST = myhostname)(PORT = 1521))

  (LOAD_BALANCE = YES)

  (CONNECT_DATA =

   (SERVER = DEDICATED)

   (SERVICE_NAME = MY_NICE_SERVICE_NAME.MY_COMPANY.COM)

   (FAILOVER_MODE =

   (TYPE = SELECT)(METHOD = BASIC)(RETRIES = 180)(DELAY = 5)

   )

  )

) 
```

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2015-12-12T11:30:03.427

`SERVICE_NAME`是数据库实例（或许多实例）的**别名。**这样做的主要目的是如果您正在运行集群。使用它，我们可以连接集群内的特定数据库。和其他方式，使用`SID`（**系统**ID**实体**）我们可以连接到一个数据库实例，这是一个 Oracle 数据库实例的**唯一**名称。

简而言之，SID = 您的数据库的唯一名称，SERVICE_NAME = 连接时使用的别名。

有几种方法可以提供数据库信息，例如直接指定、tnsnames.ora（即 TNS 名称）、LDAP 目录、网络信息服务。

TNS（**透明****网络**底层**）**名称是保存在文件中的条目的名称，该文件 包含系统用于连接到 oracle 数据库的信息。使用它，客户端可以透明地获取服务器相关信息。它包含以下信息 **`tnsnames.ora``$ORACLE_HOME/network/admin`** 

 **```
PROTOCOL
HOST IP ADDRESS
PORTNO
SID  or SERVICE_NAME 
```

例如

```
 mydb =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = 10.35.15.1)(PORT = 1521))
    (CONNECT_DATA = (SID = mydb)) 
```

JDBC 驱动程序使用 TNS 与连接字符串连接，如下所示

```
System.setProperty("oracle.net.tns_admin", PATH_TO_TNSNAMES.ORA);
Class.forName ("oracle.jdbc.OracleDriver");
dbUrl = "jdbc:oracle:thin:@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST="+IPHOST+")(PORT="+PORT+"))(CONNECT_DATA=(SERVER = DEDICATED)(SERVICE_NAME="+DBNAME+")))"

conn = DriverManager.getConnection(dbUrl, USERNAME, PASSWORD); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-04T18:59:34.193

Oracle SID 是唯一标识您的实例/数据库的唯一名称，其中服务名称是您在远程连接到数据库时提供的 TNS 别名，此服务名称记录在客户端上的 Tnsnames.ora 文件中，它可以是与 SID 相同，您也可以为其指定任何其他名称。

SERVICE_NAME 是从 oracle 8i 开始的新功能，其中数据库可以向侦听器注册自身。如果数据库以这种方式注册到侦听器，那么您可以在 tnsnames.ora 中使用 SERVICE_NAME 参数，否则 - 在 tnsnames.ora 中使用 SID。

此外，如果您有 OPS (RAC)，则每个实例都有不同的 SERVICE_NAME。

SERVICE_NAMES 为该实例连接的数据库服务指定一个或多个名称。您可以指定多个服务名称，以区分同一数据库的不同用途。例如：

SERVICE_NAMES = sales.acme.com、widgetsales.acme.com

您还可以使用服务名称来标识通过使用复制可从两个不同数据库获得的单个服务。

在 Oracle Parallel Server 环境中，您必须为每个实例设置此参数。

TNS 是 sql*net 配置文件，它定义数据库地址以建立与它们的连接。**

# httpwebrequest - 对 json API 的 Web 请求没有响应 - 异常超时

> ID：15819434
> 
> 赞同：0
> 
> 时间：2013-04-04T18:55:22.520
> 
> 标签：httpwebrequest, windows-phone

我处于一个非常奇怪的情况，我昨晚在 4 小时内一直在尝试调试。 [它看起来有点像这个未回答的问题。](https://stackoverflow.com/questions/14050739/not-found-error-calling-mongohq-rest-api-from-windows-phone)

我在 Windows Phone 8 上开发了一个片段，其中下载了 json 数据。

在我的代码段中，我使用以下方法从[http://api.mtgox.com/api/2/BTCUSD/money/ticker](http://api.mtgox.com/api/2/BTCUSD/money/ticker)下载数据：

*   网络客户端
*   HttpWebRequest
*   网络浏览器（不可见）
*   WebClient 扩展处理 cookie

在所有四种情况下，它都在我的模拟器上运行。没有延迟，没有超时，没有 403，没有 404。

当我的一个朋友在他的模拟器上运行此代码时，它似乎在 7-8 秒后超时并出现 TargetInvocationException，并且 InnerException 包含一条`NotFound`消息。但是在他的模拟器上，任何其他网站都可以。

这意味着发出请求：GET /api/2/BTCUSD/money/ticker 主机：data.mtgox.com 连接：keep-alive 等。

但是根据我对 Wireshark 所做的三重、四重、非常顽固的验证，在此获取之后没有任何反应。它是空白的。所以它超时。

请求失败的 PC 上没有防病毒或防火墙。该页面在桌面浏览器中加载良好。在模拟器上，来自其他网站的任何其他 json 请求都可以工作。

所以这个特定的地址在特定的模拟器上不起作用。

我在脑海中摸索 CCNA 知识，但找不到任何理由为什么网站会拒绝响应模拟器并接受响应另一个模拟器？

奇怪的是，非工作 PC 上的代码片段在添加用户代理后开始在 C# 桌面控制台应用程序中工作，但在他的 WP 模拟器中，这种解决方法在上述四种方法中的任何一种中都不起作用。疯狂的是发送的数据包是完全一样的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T11:34:36.270

我有类似的问题。解决方案是：

1.  将项目编译到您的设备。
2.  停止调试
3.  在手机上关闭您的应用程序（并更好地重启设备）
4.  所有作品都像魅力一样））

这对我有帮助（我使用了 RestClient 和 WebClient）

我希望它也能帮助你。

问候。

# ruby-on-rails - 在 Rails 3 中使用多态关联的 form_for 中的未定义方法

> ID：15819441
> 
> 赞同：1
> 
> 时间：2013-04-04T18:55:42.307
> 
> 标签：ruby-on-rails, ruby-on-rails-3, polymorphic-associations

让我解释一下我要做什么，然后问我的问题。我完全是 Ruby/Rails 的新手，但也是一位经验丰富的开发人员。

**我想要什么**：我想要开发人员、客户和管理员。我想要一个通用的身份验证机制。

**似乎最好**的方法：我认为最好的建模方式是让用户处理身份验证，然后进行某种继承或扩展每种用户类型的功能。

**我正在尝试什么**：我正在尝试一种称为多态关联（[http://guides.rubyonrails.org/association_basics.html#polymorphic-associations](http://guides.rubyonrails.org/association_basics.html#polymorphic-associations)）的东西，但我错过了一些东西。目前，如果我去`/developers/new`，我会得到以下信息

```
in developers/_fields.html.erb where line #4 raised:
undefined method `name' for #<Developer:0x00000002bafd18> 
```

**user.rb**片段

```
class User < ActiveRecord::Base
  attr_accessible :email, :name, :password, :password_confirmation, :profile_id, :profile_type
  has_secure_password
  belongs_to :profile, :polymorphic => true
  ...
end 
```

**developer.rb**片段

```
class Developer < ActiveRecord::Base
  attr_accessible :skype_name
  has_one :user, :as => :profile, :dependent => :destroy
  accepts_nested_attributes_for :user
end 
```

**routes.rb**片段

```
resources :developers 
```

**Developer#new**控制器片段

```
def new
  @developer = Developer.new
  @developer.user = User.new
end 
```

**面向开发人员的new.html.erb**片段

```
<div class="row">
  <div class="span6 offset3">
    <%= form_for (@developer) do |f| %>
      <%= render 'fields', f: f %>
      <%= f.submit "Create my account", class: "btn btn-large btn-primary" %>
    <% end %>
  </div>
</div> 
```

最后 **_fields.html.erb**片段

```
<%= render 'shared/error_messages' %>
<%= f.label :name %>
<%= f.text_field :name %>
... 
```

我发现的最接近的问题是[这个](https://stackoverflow.com/questions/11335924/nested-routes-and-form-for-and-models-using-has-one-and-belongs-to)，但我从他们的答案中尝试了一些东西，但没有帮助。

我可以创建一个新的用户和开发人员，通过 rails 控制台相互链接，但我无法弄清楚我在网络上做错了什么。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:15:45.857

您正在尝试访问父`user`级范围内的属性。`developer`用于`fields_for`修改范围：

```
<%= render 'shared/error_messages' %>
<%= f.fields_for :user do |u| %>
  <%= u.label :name %>
  <%= u.text_field :name %>
<% end %> 
```

您可能还想让 Developer 模型接受 User 的嵌套属性。查看[文档中的](http://apidock.com/rails/ActionView/Helpers/FormHelper/fields_for)一些示例。

# css - CSS 属性 padding-top 仅适用于列表的第一个元素。我如何应用到所有元素？

> ID：15819447
> 
> 赞同：1
> 
> 时间：2013-04-04T18:56:12.620
> 
> 标签：css, jsp, jstl, el

我正在尝试将填充应用于列表的所有元素，但由于某种原因，它仅适用于第一个元素。应该是这样吗？如果是这样，我如何将样式应用于列表中的所有元素？

这是我目前拥有的代码。10px 填充仅适用于第一个元素。我希望它适用于列表中的所有元素：

```
<c:forEach items="${list}" var="child" varStatus="status">
  <div id="${status.count}" style="padding-top: 10px;">

  </div>
</c:forEach> 
```

我尝试将上面的代码更改为

```
 <c:forEach items="${list}" var="child" varStatus="status">
      <div class = "itemWithPadding">

      </div>
    </c:forEach> 
```

在我的 css 文件中，我有以下内容：

```
 .itemWithPadding {
      padding-top: 10px;
    } 
```

呈现的 html 如下所示：

```
<div class="itemWithPadding"> -stuff inside- </div> 
<div class="itemWithPadding"> -stuff inside- </div> 
<div class="itemWithPadding"> -stuff inside- </div> 
```

我当然已经从 html 源代码中剥离了 div 标签内的内容。但是如果里面的内容`<div>`是诊断问题所必需的，我可以完全按照它的呈现方式发布它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:52:31.783

从 your和s 里面删除所有的`float: left`内联样式。看到这个[小提琴](http://jsfiddle.net/E7HHC/1/)。`.itemWithPadding``<div/>`

问题是，块元素忽略了浮动的子元素，所以`.itemWithPadding`只有`<font/>`元素的高度。里面的浮动 div 被忽略了。如果您删除了`padding`，它们就会重叠。

另一种方法是通过使用使外部 div 尊重浮动内容

```
.itemWithPadding:after {
    content: '.';
    display: block;
    visibility: hidden;
    height: 0;
    clear: both;
} 
```

这是一个[小提琴](http://jsfiddle.net/HXRJa/)。

顺便说一句：你不应该使用`<font/>`标签。你应该考虑从一个关于如何编写 HTML 和 CSS 代码的好教程开始。将来会为您节省很多时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T18:57:47.580

给它一个 CSS 类来应用你的`padding-top`.

```
<style type="text/css">
    .itemWithPadding {
      padding-top: 10px;
    }
</style>

<c:forEach items="${list}" var="child" varStatus="status">
  <div id="${status.count}" class="itemWithPadding">

  </div>
</c:forEach> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:12:34.527

您可以使用“类”而不是“id”来对所有元素应用填充。

在 HTML 中，您可以为所有 div 提供相同的“类”，例如

```
<div class="padding"> 
```

对于您想要具有相同填充的所有元素。

并在 css 中给出

```
.padding{padding-top:10px;} 
```

# image - 运行 WP7 silverlight 应用程序时的图像失真

> ID：15819449
> 
> 赞同：0
> 
> 时间：2013-04-04T18:56:17.230
> 
> 标签：image, silverlight, windows-phone-7, pixel

我有一个 6000 x 3044 的大图像，我需要将它添加到我的 silverlight 应用程序中。只有在运行时，图像才会如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/KthGB.png)

为什么它看起来不像左边的设计？请注意，我使用的图像控件与 6000 x 3044 的图像文件大小相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:29:25.693

结果称为莫尔图案：[http](http://en.wikipedia.org/wiki/Moire) ://en.wikipedia.org/wiki/Moire 。只要您缩放图像，除非a）缩放因子是整数或b）您从原始图案中删除阴影，否则这是不可避免的。

# django - django 模板从查询集更改了日期格式

> ID：15819455
> 
> 赞同：0
> 
> 时间：2013-04-04T18:56:48.430
> 
> 标签：django, django-templates, django-queryset

我创建了一个查询集：

```
my_data = My_User.objects.filter(Q(first_name = 'John') |
                                  Q(last_name = 'Doe')) 
```

现在，数据库中此日期字段的`my_data`日期（`type: datetime.datetime`）格式中的一个字段是 yyyy-mm-dd HH:MM:SS 例如：2013-04-01 12:50:58

但是当我通过 django 模板显示此信息时，默认情况下日期格式会更改！它显示：2013 年 4 月 1 日，下午 12:50

模板中的代码：

```
{% for each_user in my_data %}
<tr>
  <td>{{each_user.timestamp}}</td>
  <td>{{each_user.first_name}}</td>
  <td>{{each_user.last_name}}</td>
  <td>{{each_user.address}}</td>
</tr>
{% endfor %} 
```

我想要日期格式为：mm-dd-yyyy HH:MM:SS AM/PM。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:00:09.497

django 模板的默认日期格式是： `'N j, Y' (e.g. Feb. 4, 2003)` 因此您会从数据库中看到不同的日期格式。[您可以在此处](https://docs.djangoproject.com/en/dev/ref/settings/#date-format)阅读有关此内容的更多信息

您可以使用内置的日期过滤器格式化日期：

```
{{each_user.timestamp|date:"%d/%m/%y %H:%M"}} 
```

您可以将 替换为`"%d/%m/%y %H:%M"`您希望的任何格式。

`"%d/%m/%y %H:%M"`给你格式`"21/11/06 16:30"`

更多信息：[这里](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#std%3atemplatefilter-date)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-14T16:03:51.193

你应该只使用：

```
{{each_user.timestamp|date:"m-d-Y h:i:s A"}} 
```

这些在第一个答案的第二个链接中，“内置 Django 模板过滤器以格式化日期”。您需要的说明如下：

```
m   Month, 2 digits with leading zeros.                '01' to '12'
d   Day of the month, 2 digits with leading zeros.     '01' to '31'
Y   Year, 4 digits.                                    '1999'
h   Hour, 12-hour format.                              '01' to '12'
i   Minutes.                                           '00' to '59'
s   Seconds, 2 digits with leading zeros.              '00' to '59'
A   'AM' or 'PM'.                                      'AM' 
```

但请注意，传递给模板的数据必须是`datetime`. 由于序列化程序，我曾经遇到过这个问题；这些值作为字符串传递，而不是`datetime`，因此无法解析；我只看到空字符串，而不是格式化的字符串。

但是，接受的答案建议的第一部分用于`datetime.datetime.strf(p)time`; 字符串`%`用于解析或格式化日期。它们是 python 的一部分，而不是 Django 的一部分。如果您想在视图中格式化日期，它们很有用。

# java - Java中的奇怪转换错误

> ID：15819457
> 
> 赞同：1
> 
> 时间：2013-04-04T18:56:49.010
> 
> 标签：java, generics

我有这些课程：

```
public class A <T>{
}

public interface I {    
}

public class X implements I {
}

public class B extends A<X>{
} 
```

在我的代码中，如果我这样做，我会收到错误：

```
A<I> myobj = (A<I>) new B(); 
```

一定是：

```
A<X> myobj = (A<X>) new B(); 
```

但是，如果我这样做是可以的并且效果很好：

```
A<I> myobj = null;
myobj  = (A<I>) Class.forName("B").newInstance(); 
```

在最后一种情况下，我访问 B 的所有方法并且工作得很好。

我需要将 myobj 声明为 A，因为我只保证泛型 obj 的接口而不是具体的类。

任何人都知道为什么我的第一个案例不起作用？

我想实现第一个最优雅的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T19:42:21.263

这就是泛型在 Java 中的工作方式。String 类实现接口 CharSequence，但不能将 List<CharSequence> 强制转换为 List<String>（反之亦然）。但是您可以将 ArrayList<String> 转换为 List<String> （并将 List<String> 转换为 ArrayList<String> - 至少编译器不会抱怨，但如果您的 List 对象不是实例，您将获得运行时异常数组列表）。

如果有可能呢？这是一个例子：

```
1\. List<String> listOfStrings = new ArrayList<String>(); // piece of cake!
2\. List<Object> listOfObjects = (List<Object>) listOfString; // String is a subclass ofObject, so why not?
3\. listOfObjects.add(new Object()); // obviously correct
4\. String s = listOfString.get(0); // ouch! We've just put an Object into this list, but generic type promises there are only Strings! 
```

这就是为什么第 2 行出现编译错误的原因。当然，您可以欺骗编译器并尝试以下操作：

```
A<I> myobj = null;
A genericA = new B();
myobj = (A<I>) genericA; 
```

这将起作用，因为在运行时中删除了泛型类型。您也可以使用列表执行此操作：

```
List<String> listOfStrings = new ArrayList<String>();
List genericList = listOfStrings;
genericList.add(new Object());
String s = listOfStrings.get(0); 
```

此代码将编译（带有警告），但您将在运行时遇到异常：

```
Exception in thread "main" java.lang.ClassCastException: java.lang.Object cannot be cast to java.lang.String 
```

这段代码：

```
myobj  = (A<I>) Class.forName("B").newInstance(); 
```

有效，因为方法*newInstance()*返回 java.lang.Object 的一个实例。编译器不知道它将在运行时返回什么，因此它允许将其转换为所有内容。由于[Type Erasure](http://docs.oracle.com/javase/tutorial/java/generics/erasure.html)，在运行时 A<I> 只是 A，并且由于 B 是 A 的子类，您可以将 B 的实例强制转换为 A。

# javascript - 从数组中随机选择图像

> ID：15819461
> 
> 赞同：1
> 
> 时间：2013-04-04T18:57:00.213
> 
> 标签：javascript, jquery, math, random

我在目录中有图像，我正在尝试使用 jQuery 将它们随机分配给列表项。我有它的工作，但如果它们已经被使用，我不想重复图像。这是我的jQuery：

```
var images = ['1.jpg', '2.jpg', '3.jpg', '4.jpg', '5.jpg', '6.jpg', '7.jpg', '8.jpg', '9.jpg', '10.jpg'];

$("#collageWrap li").each(function() {
    $('<img src="images/mosaic/' + images[Math.floor(Math.random() * images.length)] + '">').appendTo($(this));
}); 
```

如果我有 10 个图像和 20 个列表项，那么我的想法是在前 10 个列表项上使用 10 个图像，然后将其余的留空。如何更改此代码以确保每个图像仅使用一次？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:00:38.660

一种解决方案是在随机拍摄图像时从源数组中删除：

```
$("#collageWrap li").each(function() {
    var index = Math.floor(Math.random()*images.length);
    var img = images.splice(index, 1)[0];
    $('<img src="images/mosaic/' + img + '">').appendTo($(this));
    return images.length>0;
}); 
```

# javascript - 实现图像扩展/收缩效果

> ID：15819466
> 
> 赞同：2
> 
> 时间：2013-04-04T18:57:09.980
> 
> 标签：javascript, css

我想与[http://www.userreport.com/](http://www.userreport.com/)的 twitter 栏在侧面产生相同的效果，我看到当 .hover 打开时它们会扩大图像的宽度，但是当我尝试

```
width:47px 
```

它缩小图像而不是切割它，（我正在缩小保存图像的 div），他们是使用 JS 还是只是操纵 CSS 来实现效果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:01:53.317

像这样的东西应该工作：

```
div.twitter { 
   width: 100px;
   left: 100%;
   margin-left: -50px;
   transition: margin-left 2s;
}

div.twitter:hover { 
   margin-left: -100px;
} 
```

不要忘记浏览器的前缀`transition`

# objective-c - 具有大量参数的库

> ID：15819474
> 
> 赞同：0
> 
> 时间：2013-04-04T18:57:41.967
> 
> 标签：objective-c, design-patterns, frameworks, model, shared-libraries

我正在开发一个供我自己和第三方使用的库。为了初始化这个库，我需要传递相当多的强制参数。我不知道总共有多少，但我已经9岁了。

我试图弄清楚传递这些参数的最佳方式是什么。

1) 一个一个地传递每个参数。这将变得笨拙且容易出错。

2）为每个参数提供一个常量，并使库需要一个哈希表，每个常量都是值的键。

3) 创建一个包含所有字段的模型对象，并将其提供给用户。

2 号和 3 号似乎是最好的，尽管我不确定我是否在其他任何地方看到过它们中的任何一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:07:26.110

**你的 3\. 看起来很有希望。**

传递一个包含所有 9 个或更多值的对象将是可读的。

此外，如果您需要发送类似类型的值，您可以发送数组或字典。

# python - Python Selenium，如何保存http响应内容？

> ID：15819476
> 
> 赞同：1
> 
> 时间：2013-04-04T18:57:47.240
> 
> 标签：python, http, selenium

我想在 selenium python 中自动化这样的过程。

在网页上，有一个下载按钮。点击按钮后，服务器会发回一个文本http响应，浏览器会弹出一个窗口让我保存。

在我的 python 代码中，我有：

```
downBtn = browser.find_element_by_id('id') 
```

然后我可以触发 downBtn.click()，浏览器将下载文本文件并保存到默认路径。我想获取文本文件的内容，用我的新文件名将其保存在我的 python 脚本中配置的某个文件夹中。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:12:04.137

您可以在创建 webdriver 实例时设置浏览器 (firefox) 首选项。

```
fp = webdriver.FirefoxProfile()

fp.set_preference("browser.download.folderList",2)
fp.set_preference("browser.download.manager.showWhenStarting",False)
fp.set_preference("browser.download.dir",getcwd())
fp.set_preference("browser.helperApps.neverAsk.saveToDisk","text/csv")

browser = webdriver.Firefox(firefox_profile=fp) 
```

基于[这里的信息](http://watirmelon.com/2011/09/07/determining-file-mime-types-to-autosave-using-firefox-watir-webdriver/)

# javascript - 只执行一次 JavaScript 函数并记住它

> ID：15819487
> 
> 赞同：-2
> 
> 时间：2013-04-04T18:58:12.310
> 
> 标签：javascript, html, cookies, local-storage

我有这个 JavaScript 函数，我只需要执行一次（当满足某些条件时），然后让 cookie 记住它，而不是在 24 小时内再次运行它。

我尝试了这个使用 jquery.cookie.js 插件的脚本，但它不起作用：

```
var eventsFired = ($.cookie('eventsFired') != null)
? $.cookie('eventsFired')
: 0;

function load() {

  if (eventsFired == 0){

    if (window.frames[0].document.getElementById('applications')) {
      var str=document.getElementById("tst").innerHTML;
      var n=str.replace("Login","Logout");
      document.getElementById("tst").innerHTML=n;
      document.getElementById('tst').title ='logout';
      document.getElementById('tst').href='logout';
      document.getElementById('prt').href='../profile/cont.html';
      eventsFired++;
      $.cookie('eventsFired', eventsFired);
    }
  }
} 
```

本地存储：

```
function load() {
var eventsFired = localStorage.getItem('fired');

if (eventsFired == '1'){
  if (window.frames[0].document.getElementById('applications'))
{
var str=document.getElementById("tst").innerHTML;
var n=str.replace("Login","Logout");
document.getElementById("tst").innerHTML=n;
document.getElementById('common').href='..css/common2.css';
document.getElementById('tst').title ='logout';
document.getElementById('tst').href='logout';
document.getElementById('prt').href='../profil/cont.html';
  localStorage.setItem('fired', '1');
}
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T19:09:15.597

不要使用 cookie：它将在每次请求时发送到服务器。您可以改用[本地存储](http://en.wikipedia.org/wiki/Web_storage#Local_and_session_storage)：

```
function load() {
  var eventsFired = localStorage.getItem('fired');

  if (eventsFired != '1'){
      doYourStuff();
      localStorage.setItem('fired', '1');
  }
} 
```

# plsql - 从数据库表创建 XML

> ID：15819489
> 
> 赞同：0
> 
> 时间：2013-04-04T18:58:19.100
> 
> 标签：plsql, oracle10g, xml-serialization, xsd, plsqldeveloper

我有一个 XML 文件示例。现在我想用我拥有的 SQL 表数据生成一个原始 XML。

示例 XML 如下所示：

```
<?xml version="1.0"?>
<EmployeeSet  xmlns=" http://www.example.com/Employee.xsd " xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> 
<DefaultDeptt xsi:nil="true"/> 
<Report>
    <Report  Title="Yearly" Number="S678"> 
        <Status>Current</Status> 
        <Deptt xsi:nil="true"/> 
        <Employee LastName="Name" FirstName="Simple" EMail="simple@organization.org" Login="simple"/> 
        <Location>Builiding 1</Location> 
        <SubmissionDate xsi:nil="true"/> 
        <ReportStartDate>2011-05-05</ReportStartDate> 
        <ReportFinishDate xsi:nil="true"/> 
        <ReportExpirationDate>2014-05-05</ReportExpirationDate> 
        <RenewalDate xsi:nil="true"/> 
        <Records> 
            <RecordsInfo Name="Paper"> 
            <UsageRecords AnnualUse="5o0" Purpose="printing"/> 
            </RecordInfo> 
        </Record> 
    <Staff/> 
</Report> 
```

我从中获取数据的表具有以下结构：

*   报告标题
*   数字
*   地位
*   姓
*   名
*   电子邮件
*   登录ID
*   地点
*   提交日期
*   开始日期
*   Finsih_date
*   更新日期
*   姓名
*   年度使用
*   目的

我试过了，我得到了关注：

```
<EmployeeSet xmlns="http://www.example.com/Employee.xsd" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

    <DefaultDeptt xsi:nil="true"></DefaultDeptt>        
    <report_title>TESTINGNEW</report_TITLE>      
    <NUMBER>AC10006</NUMBER>    
    <STATUS>Approved</STATUS>       
    <LAST_NAME>XYZ</LAST_NAME>       
    <FIRST_NAME>ABC</PI_FIRST_NAME>       
    <EMAIL>ABC.XYZ@gmail.com</EMAIL>       
    <LOGIN_ID>ABCXYZ</LOGIN_ID>       
    <LOCATION> </ LOCATION>       
                                                                                         <SUBMISSION_DATE>2013-03-25</SUBMISSION_DATE>                                                  <START_DATE>2013-03-25</START_DATE>           
    <FINISH_DATE>2013-03-25</FINISH_DATE>        
    <RENEWAL_DATE>2014-01-9</RENEWAL_DATE>        
    <NAME>PAPER</NAME>        
    <ANNUAL_USE>670</ANNUAL_USE>       
    <PURPOSE> PRINTING</PURPOSE>        
</EmployeeSet> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T11:33:16.600

我认为这样的事情会有所帮助，试试 google for xmldom built in package in oracle

```
declare
           xml_content CLOB:=null;  
           doc xmldom.domdocument;  
           main_node xmldom.DOMNode;                                                                           
           root_node xmldom.DOMNode;                                                                           
           root_elmt xmldom.DOMElement;                                                                         
           transmissionHeaderNode xmldom.DOMNode;                                                              
           transmissionHeaderElement xmldom.DOMElement;                                                               
           item_node xmldom.DOMNode;
           item_elmt xmldom.DOMElement;
           item_text xmldom.DOMText;
           redx_elmt xmldom.DOMElement;
begin
            --some cursor
            for c1 in (
                        select * from (yourtable)
                       )
            loop
-- here you loop all you're fetches from table
              doc := xmldom.newdomdocument;                                                                       
              main_node := xmldom.makenode(doc);                                                                  
              xmldom.setversion(doc,'1.0');            
              dbms_xmldom.setcharset(doc, 'UTF-8'); -- UTF-8
              root_elmt := xmldom.createelement(doc, 'Some header')
              root_node := xmldom.appendchild( main_node, xmldom.makenode(root_elmt));               
              transmissionheaderelement := xmldom.createelement(doc, 'XML_DOCUMENT');
              transmissionheadernode := xmldom.appendchild(root_node, xmldom.makenode(transmissionheaderelement));
        -- lets say in cursor you have location field
              item_elmt := xmldom.createelement(doc, 'Location'); 
              item_node := xmldom.appendchild(transmissionheadernode, xmldom.makenode(item_elmt));                
              item_text := xmldom.createTextNode(doc, c1.Location);                             
              item_node := xmldom.appendchild(item_node, xmldom.makenode(item_text));
            .
            .
            .
            -- before end of loop
               dbms_lob.createtemporary(xml_content, true, dbms_lob.call);
               xmldom.writetoclob(doc, xml_content);               
               xmldom.freedocument(doc);             

   end loop; 
```

# c# - 可以从数据库读取但不能插入

> ID：15819490
> 
> 赞同：0
> 
> 时间：2013-04-04T18:58:20.613
> 
> 标签：c#, database, visual-studio-2010

我在使用 Visual Studio 2010 时遇到问题。我正在使用基于服务的数据库 ( `.mdf`)。问题是我可以从数据库中获取信息，但我无法将信息插入数据库。

当我向数据库添加信息时，行会受到影响，但是当我在 Visual Studios Server Explorer 中打开表时，什么都没有改变。

我编写的代码没有任何问题，因为它可以在我学校的计算机上运行。

有什么我必须更改的设置吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T19:02:33.030

最有可能的是，您`AttachDbFileName=......` 在连接字符串中使用 - 对吗？

整个*User Instance 和 AttachDbFileName=*方法是有缺陷的 - 充其量！在 Visual Studio 中运行您的应用程序时，它将围绕`.mdf`文件进行复制（从您的`App_Data`目录到输出目录 - 通常`.\bin\debug`是您的应用程序运行的位置），并且**很可能**，您的`INSERT`工作正常 - 但您只是**看错了 . mdf文件**到底！

如果您想坚持使用这种方法，请尝试在`myConnection.Close()`调用上设置断点 - 然后`.mdf`使用 SQL Server Mgmt Studio Express 检查文件 - 我几乎可以肯定您的数据在那里。

**我认为真正的解决**方案是

1.  安装 SQL Server Express（反正你已经完成了）

2.  安装 SQL Server Management Studio Express

3.  **在SSMS Express**中创建您的数据库，给它一个逻辑名称（例如`YourDatabase`）

4.  使用它的逻辑**数据库名称**（在服务器上创建它时给出）连接到它——不要乱用物理数据库文件和用户实例。在这种情况下，您的连接字符串将类似于：

    ```
    Data Source=.\\SQLEXPRESS;Database=YourDatabase;Integrated Security=True 
    ```

    其他一切都和以前**完全**一样......

# mysql - mysql 在亚马逊 linux ami 上崩溃

> ID：15819491
> 
> 赞同：0
> 
> 时间：2013-04-04T18:58:25.413
> 
> 标签：mysql, amazon-ec2

我一直在启动 mysql，然后几分钟后它就崩溃了。任何人都可以破译此错误日志吗？

```
0328 17:09:13 [Note] Plugin 'FEDERATED' is disabled.
130328 17:09:13 InnoDB: The InnoDB memory heap is disabled
130328 17:09:13 InnoDB: Mutexes and rw_locks use GCC atomic builtins
130328 17:09:13 InnoDB: Compressed tables use zlib 1.2.5
130328 17:09:13 InnoDB: Using Linux native AIO
130328 17:09:13 InnoDB: Initializing buffer pool, size = 128.0M
130328 17:09:13 InnoDB: Completed initialization of buffer pool
InnoDB: The first specified data file ./ibdata1 did not exist:
InnoDB: a new database to be created!
130328 17:09:13  InnoDB: Setting file ./ibdata1 size to 10 MB
InnoDB: Database physically writes the file full: wait...
130328 17:09:13  InnoDB: Log file ./ib_logfile0 did not exist: new to be created
InnoDB: Setting log file ./ib_logfile0 size to 5 MB
InnoDB: Database physically writes the file full: wait...
130328 17:09:13  InnoDB: Log file ./ib_logfile1 did not exist: new to be created
InnoDB: Setting log file ./ib_logfile1 size to 5 MB
InnoDB: Database physically writes the file full: wait...
InnoDB: Doublewrite buffer not found: creating new
InnoDB: Doublewrite buffer created
InnoDB: 127 rollback segment(s) active.
InnoDB: Creating foreign key constraint system tables
InnoDB: Foreign key constraint system tables created
130328 17:09:14  InnoDB: Waiting for the background threads to start
130328 17:09:15 InnoDB: 5.5.30 started; log sequence number 0
130328 17:09:15 [Note] Server hostname (bind-address): '0.0.0.0'; port: 3306
130328 17:09:15 [Note]   - '0.0.0.0' resolves to '0.0.0.0';
130328 17:09:15 [Note] Server socket created on IP: '0.0.0.0'.
130328 17:09:15 [Note] Event Scheduler: Loaded 0 events
130328 17:09:15 [Note] /usr/libexec/mysqld: ready for connections.
Version: '5.5.30'  socket: '/var/lib/mysql/mysql.sock'  port: 3306  MySQL Community Server (GPL)
130401 17:03:23 mysqld_safe Number of processes running now: 0
130401 17:03:24 mysqld_safe mysqld restarted
130401 17:03:55 [Note] Plugin 'FEDERATED' is disabled.
130401 17:04:08 InnoDB: The InnoDB memory heap is disabled
130401 17:04:08 InnoDB: Mutexes and rw_locks use GCC atomic builtins
130401 17:04:08 InnoDB: Compressed tables use zlib 1.2.5
130401 17:04:08 InnoDB: Using Linux native AIO
130401 17:04:11 InnoDB: Initializing buffer pool, size = 128.0M
InnoDB: mmap(137363456 bytes) failed; errno 12
130401 17:04:11 InnoDB: Completed initialization of buffer pool 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-08T02:43:46.443

您的 ec2 实例对于 mysql 来说太小了，并且被限制为 613MB 的内存。

# c# - 带有引用参数的 C# Web 服务

> ID：15819492
> 
> 赞同：1
> 
> 时间：2013-04-04T18:58:26.647
> 
> 标签：c#, web-services, visual-studio, pass-by-reference

我必须创建一个 C# Web 服务。我有个问题。可以使用`ref`参数吗？比如我有这个方法

```
//my web service will fill the parameter by reference
int myWSMethod(int parameterA, ref string parameterB); 
```

这可以通过网络服务实现吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T19:13:17.527

如果您的问题只是想弄清楚如何从 Web 服务返回多个值，只需返回一个复杂类型即可。

```
[DataContract]
[Serializable]
public class myWSMethodResponse
{
    [DataMember]
    public int ErrorCode { get; set; }
    [DataMember]
    public string Report { get; set; }
}

public myWSMethodResponse myWSMethod(int parameterA)
{
  //code here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:13:35.590

我不确定您为什么要这样做，但基于[MSDN](http://msdn.microsoft.com/en-us/library/ms733070.aspx)，您可以这样做。

> **`Out`和`Ref`参数**。
> 
> 在大多数情况下，您可以使用 in 参数（`ByVal`在 Visual Basic 中）和`out`and`ref` 参数（`ByRef`在 Visual Basic 中）。因为`out`和`ref`参数都表示从操作返回数据，所以如下所示的操作签名指定即使操作签名返回，也需要请求/回复操作`void`。
> 
> **例子：**
> 
> ```
> [ServiceContractAttribute]
> public interface IMyContract
> {
>   [OperationContractAttribute]
>   public void PopulateData(ref CustomDataType data);
> } 
> ```

# php - PDO::FETCH_ASSOC 没有获取所有内容

> ID：15819497
> 
> 赞同：2
> 
> 时间：2013-04-04T18:58:47.617
> 
> 标签：php, mysql, function, pdo

我有这个功能：

```
function get_following($user_id) {
 global $conn;
 $stmt = $conn->prepare("SELECT * FROM following WHERE `follower_id`=:user");
 $stmt->bindParam(':user', $user_id, PDO::PARAM_INT);
 $stmt->execute();
 $following =$stmt->fetch(PDO::FETCH_ASSOC);
 return $following;
} 
```

该`following`表如下所示：

```
|user_id|follower_id|
|   2   |     5     |
|   3   |     5     |
|   4   |     5     | 
```

现在的问题是，当我实际调用该函数时，它只选择表中的一行，其中我的 follower_id = 5。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T19:00:25.113

$following 必须是一个行数组。您实际上只获取第一行。使用 获取它[`PDOStatement::fetchAll()`](http://www.php.net/manual/en/pdostatement.fetchall.php)，如下所示：

```
$following = $stmt->fetchAll(PDO::FETCH_ASSOC); 
```

# algorithm - Aho-Corasick FSA 的三叉树与三叉树与地图作为转换表

> ID：15819500
> 
> 赞同：1
> 
> 时间：2013-04-04T18:58:56.367
> 
> 标签：algorithm, trie, finite-automata, ternary-search-tree, aho-corasick

使用三叉树的 FSA 与将转换表实现为搜索树（例如 std::map）的 trie 有什么区别？看起来两者都具有读取一个符号的 O(log k) 复杂度和 O(S) 内存复杂度，其中 k 是字母大小，S 是所有接受的输入字符串的长度之和。

如果我们不需要自动机在运行时更改，那么最好的选择不是使用（符号，状态）转换对的排序向量以及二进制搜索吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:42:03.637

三元搜索树 (TST) 和在每个节点上使用二叉搜索树实现的 Trie 之间没有真正的区别。实际上，您可以将后者视为前者的（低效）实现；TST 的优点是易于优化，空间开销合理。

经典的 Trie 在决策节点上使用按符号索引的转换向量直接查找。这是`O(1)`时间，但空间需求很大。尽管如此，还是有一些优化存储的方法。此外，还存在混合解决方案，其中 Trie 结构仅用于树顶部的宽决策节点；一旦候选者的数量减少到很小的程度，就可以使用快速扫描或哈希表来找到合适的候选者。

以天真的方式使用（符号，状态）转换的排序向量需要`O(log T)`每个转换的时间，其中`T`是转换的总数；本质上是所有输入字符串的总大小。给定目标的总时间将是`|target|*log(T)`.

相比之下，TST`O(log S)`每次转换只需要时间，其中`S`是字母的大小；这是一个比 小得多的数字`T`。此外，整个目标字符串的查找总数受到输入字符串数量的限制，因此整个查找的总和小于`|target|*log(S)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:59:58.313

鉴于 Aho-Corasick 的说明方式，

![阿霍-科拉西克](https://i.stack.imgur.com/52b7L.png)

这是我的节点：

```
public class AhoCorasickNode
{

    // This part works as a Trie

    public char literal; // c

    public String stack; // abc

    public AhoCorasickNode previous; // { ab }

    public AhoCorasickNode[] next; // { abca }, { abcb }, { abcc }, ..

    //-----------------------------

    // This part is used when solving

    boolean inDictionary;

    public AhoCorasickNode suffix;

    public AhoCorasickNode dictionarySuffix;

} 
```

资源：

*   [维基百科：Aho-Corasick](https://en.wikipedia.org/wiki/Aho%E2%80%93Corasick_string_matching_algorithm)

# asp.net-mvc - 如何将@helper 函数转换为我调用的局部视图？

> ID：15819515
> 
> 赞同：0
> 
> 时间：2013-04-04T18:59:56.643
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我在 ~/App_Code 下的 Helpers.cshtml 文件中有这个 @helper 函数：

```
@helper TempCost(Decimal cost)
{
@: @String.Format("{0:C0}", cost)
} 
```

在我看来，我会这样使用：

```
@Helpers.TempCost(Model.PriceInformation.MyPrice) 
```

`PriceInfrormation`是我的模型，并且`MyPrice`是（十进制）内的属性。

我现在想把这个助手放在它自己的部分视图中。我可以调用局部视图并毫无问题地传递参数。但是，我不知道如何让部分视图中的代码工作。

我试过类似的东西：

```
@{
decimal cost;
}
@String.Format("{0:C0}", cost) 
```

但我收到以下错误：

> 错误 CS0165：使用未分配的局部变量“成本”

对不起，不是专业的程序员。感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:05:05.603

试试这个方法：

在用户控件中

```
@model decimal
@string.Format("{0:C0}", Model) 
```

并打电话

```
@Html.Partial("yourusercontrol", Model.PriceInformation.MyPrice) 
```

# php - 正常的 php DELETE 字符串出错

> ID：15819517
> 
> 赞同：0
> 
> 时间：2013-04-04T19:00:04.823
> 
> 标签：php, mysql

我正在使用查询来删除一行...引号似乎很好..但出现错误..我尝试了以下两种方法，但它不起作用..

```
 $sch=mysql_query("DELETE FROM schedule WHERE
    membername='$value' AND trainername='$_SESSION['username']'") or die(mysql_error());

           $sch= mysql_query("DELETE FROM schedule 
                       WHERE membername=$value 
                        AND trainername=$_SESSION['username']"); 
```

有什么建议吗？？谢谢你..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:02:06.627

您需要用花括号将数组变量包装在字符串中。

```
$test = "this is a test {$_SESSION['string']}"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:02:22.280

您不能在 PHP 双引号字符串中使用带引号的数组键。它应该是

```
 ... AND trainername=$_SESSION[username] ...
or
  ... AND trainername={$_SESSION['username']} ... 
```

您还忘记**引用**您要插入查询的那些假定字符串

```
... AND trainername='...'
                    ^---^-- 
```

# visual-studio - 旧 VS 代码未与新 VS 一起运行

> ID：15819518
> 
> 赞同：1
> 
> 时间：2013-04-04T19:00:07.637
> 
> 标签：visual-studio, visual-studio-2008, visual-c++

我有一个旧项目需要重新审视。它是在查看 .sln 文件的某些版本的 Visual C++（prolly 2005）中构建的。由于某些损坏（重复错误点 -1），sln 文件不会转换为 VS 2008 解决方案。我将VS中的文件夹作为新项目导入并尝试编译。

`"lang/Typedefs.h/Assertions.h"`它给出了不存在的编译错误。删除声明我对未声明的 Uint8/16/32/64 有错误。所以我添加了 typedefs 和其他宏`(TOOLS_UNUSED_PARAMETERS(x) / TOOLS_FORBID_COPY())`。

解决这个问题后，我得到了 Gui/FileDlg.h 和 Gui/FolderDlg.h 的错误（调试点 - 2）。

我没有从任何在线资源或我当前的 VS 安装中找到任何这些头文件，所以我假设代码丢失了，我将不得不重做它。

甚至这些也可能是早期程序员自定义实现的。当前 MFC 使用`CFileDialog`和代码使用 `Gui::FileDlg`.

我暂时注释掉了代码，看看我可以去哪里，因为 gui 不是应用程序的那么大的一部分。后来我看到与 RegKeyOpenEx 调用和输出流调用相对应的链接器错误（重复错误点 -3）。Winreg.h 不包括在内，但 windows.h 包括在内。

样本 ：

```
Error   2   error LNK2019: unresolved external symbol __imp__MessageBoxA@16 
referenced in function "public: class std::basic_ostream<char,struct 
std::char_traits<char> > * __thiscall FileManager::getOutputStream(class Interface   
*,class LogPoint *)" (?getOutputStream@FileManager@@QAEPAV?$basic_ostream@DU?
$char_traits@D@std@@@std@@PAVInterface@@PAVLogPoint@@@Z)    filemanager.obj 
PCAPGenerator 
```

我不是 .Net 程序员，所以你能建议这里的正确做法吗？我应该关注哪些调试点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:12:52.173

[RegKeyOpenEx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724897%28v=vs.85%29.aspx)是一个 Winapi 函数，定义在`Advapi32.dll`. 要将其链接到 Visual C++ 项目：

*   如果您的项目是静态库（右键单击 project-> `Properties->Configuration Properties->Configuration Type->Static Library (.lib)`，转到`Configuration Properties->Librarian->General->Additional Dependencies`并添加`Advapi32.lib`.
*   如果您的项目是 dll （相同的地方，`Dynamic Library (.dll)`而不是说），您将拥有该`Linker`部分而不是`Librarian`. 转到其`Input`子部分，然后添加`Advapi32.lib`到`Additional Dependencies`.

对于剩余的链接器错误，请以相同的方式继续：转到该函数的 MSDN 文档，检查它属于哪个 dll/lib，并让您的项目将其链接到如上所述。

# xcode - iPad 应用程序的 didSelectRowAtIndexPath 中的 NSRangeException

> ID：15819525
> 
> 赞同：0
> 
> 时间：2013-04-04T19:00:13.100
> 
> 标签：xcode, ipad, uitableview

使用基于单击另一个表格中的单元格来填充表格的应用程序。因此，我单击（名为）Recipe 的表，然后填充了第二个表（Ingredients）。我正在使用核心数据从 sqlite 数据库中提取数据。当我选择第一个食谱时，成分填充没有问题。选择任何其他配方会导致 NSRangeException 错误。
代码：

```
- (void)tableView:(UITableView*)aTableView didSelectRowAtIndexPath:(NSIndexPath*)indexPath 
```

{

```
UITableViewCell *cell = (UITableViewCell *)[(UITableView *)srcTableView cellForRowAtIndexPath:indexPath];
NSLog(@"didSelectRowAtIndexPath: row=%i",indexPath.row);

MealPlanItAppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];

NSManagedObjectContext *context = [appDelegate managedObjectContext];

NSEntityDescription *entityDesc = [NSEntityDescription entityForName:@"Ingredients" inManagedObjectContext:context];

NSFetchRequest *request = [[NSFetchRequest alloc] init];

[request setEntity:entityDesc];
NSLog(@"Cell: %@", cell.textLabel.text);
NSPredicate *pred = [NSPredicate predicateWithFormat:@"(RecipeID = %@)", cell.textLabel.text];

[request setPredicate:pred];
NSManagedObject *matches = nil;
NSError *error;

NSArray *objects = [context executeFetchRequest:request error:&error];
if ([objects count] == 0) 
{
    NSLog(@"No matches");
    dtlData = [[NSMutableArray alloc] initWithArray:nil];
    [dtlTableView reloadData];
} else {

    NSLog(@"Match found");
    dtlData = [[NSMutableArray alloc] initWithArray:nil];
    [dtlTableView reloadData];
    matches = [objects objectAtIndex:0];
    for(matches in objects)
    {
        [dtlData insertObject:[matches valueForKey:@"Ingredient"] atIndex:indexPath.row];
        [dtlTableView insertRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
        [dtlTableView reloadData];

    }

}
[request release]; 
```

}

它在接近末尾的行爆炸： [dtlData insertObject:[matches valueForKey:@"Ingredient"] atIndex:indexPath.row]; 出现错误：*** 由于未捕获的异常 'NSRangeException' 导致应用程序终止，原因：'*** -[__NSArrayM insertObject:atIndex:]: index 4 beyond bounds for empty array' 其中索引 4 是单击的第 4 个单元格......所以它始终与单元格行相对应。

使用 NSLog，数据由调用返回并返回到具有适当计数的“对象”中。而且，就像我说的那样，它在单击第一个单元格但没有其他单元格时有效。我可以在第一个单元格上单击多次，它会继续工作。所以，它与 0 索引有关（我怀疑）但不知道是什么。如果我更换线路

```
[dtlData insertObject:[matches valueForKey:@"Ingredient"] atIndex:indexPath.row]; 
```

和

```
[dtlData insertObject:[matches valueForKey:@"Ingredient"] atIndex:0]; 
```

我得到完全相同的行为。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-29T16:08:16.720

UITable 视图代码没有任何问题（因为我快速查看了一下，只是想知道为什么每次单击表格视图单元格时都分配数组？初始化数组一次，并适当地处理对象的添加或删除）。无论如何，来到你的问题：问题是由于使用 `[array insertobject:]` 原因是数组是由一个 NILL 对象初始化的，当你尝试在索引 n 处插入对象时，它抱怨数组是空的，因为**索引 < n**都是零。因此，我建议您不要使用 [array insertobject:atindex:]，而是简单地调用`[array addobject:]`它将在连续位置添加对象并解决崩溃问题。

# objective-c - 最有效的是跨 iOS 项目重用类

> ID：15819528
> 
> 赞同：1
> 
> 时间：2013-04-04T19:00:26.170
> 
> 标签：objective-c, xcode, class, static-libraries, code-reuse

我创建了许多跨 xcode 项目使用的可重用类，例如：Utility EmailController MarketingController FlashLightController 等

我一直只是简单地将这些类文件从中央存储库复制回来，但现在我有许多应用程序，从配置管理的角度来看，这一切都变得有些混乱。所以我一直在寻找替代方案。

我开始研究静态库，但它们似乎需要更多的努力来简单地重用代码（例如，设备与模拟器的不同库，仍然必须拥有 .h 文件的副本等）。

有谁知道快速轻松的代码重用的体面替代方案？

谢谢，查理

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:03:48.993

您可以将代码文件放入项目中，而无需实际将它们复制到项目中。换句话说，只需将类文件保存在一个完全独立的位置。将它们导入到许多项目中，但取消选中复制它们的选项。项目仍然会成功引用它们。现在，对类文件所做的更改将传播到使用它们的每个项目。

此外，请考虑工作空间是否会对您有所帮助。

在我看来，几乎任何事情都比制作库或框架更好！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:04:20.233

静态库可能是您最好的选择，因为我已经使用过它们并且发现它们非常易于使用。（我不必为设备或模拟器使用不同的库，我的都适用于它们）。拥有标头并不是那么烦人，除了复制文件以重用代码之外，静态库确实是唯一的方法（除了动态库，被苹果禁止）。

# knockout.js - 如何将我的微风实体包装在一个视图模型中，该视图模型具有一些公开为可观察的属性

> ID：15819529
> 
> 赞同：1
> 
> 时间：2013-04-04T19:00:26.480
> 
> 标签：knockout.js, viewmodel, breeze, observable, jqxgrid

我有一个来自 Breeze 的实体，它可能有 20 个左右的属性，但是我想将该实体包装在一个视图模型中，并且只将这几个属性公开为 ko.observable()。我如何管理所有进行属性更改通知？

在 c# 中，我会做这样的事情：

```
public double OtherSalesPercent
{
 get { return Model.OtherSalesPercent; }
 set 
 { 
  if (Model.OtherSalesPercent != value)
  {
   Model.OtherSalesPercent = value;
   OnPropertyChanged("OtherSalesPercent");
  }
 }
} 
```

**更新** 杰伊感谢您的回复。我知道 beze 可以做到这一点。但是，我不希望我的视图直接绑定到实体，而是视图模型。所以想想一个叫做苹果的观点。苹果正在显示苹果视图模型列表。每个苹果实体都有 30 个不同的属性，但我只想在苹果视图模型上公开这 30 个属性中的 3 个。所以，我想在苹果视图模型上创建 3 个 ko.observable 属性，这些属性将在苹果实体上显示这 3 个属性。到目前为止我所拥有的是“工作”，但我认为它不是最干净的。这是名称属性：

```
var appleViewModel = function(appleEntity) {
   var backingEntity = appleEntity;

   var name = ko.observable(locationEntity.name());
   name.subscribe(function(newValue) {
       backingEntity.name(newValue);
   });

   var vm = {
    name: name
   };

   return vm
}; 
```

另一个重要原因是我正在使用 jqxGrid，但它们在绑定到 Breeze 实体时遇到问题。所以我真正想要的是一个可以显示这些属性的 appleViewModel，但是，如果我更改实际的苹果实体（如在 cancelChanges 中），我希望 UI 从实体中获取该更改）。

**更新 2**

这似乎给了我我想要的一切并绑定到 jqxGrid

```
var createViewModel = function(appleEntity) {
    var entity = appleEntity;

    var name = ko.observable(entity.name());
        name.subscribe(function(newValue) {
            entity.name(newValue);
        });
        entity.name.subscribe(function(newValue) {
            name(entity.name());
        });

        var vm = {
            name: name
        };

        return vm;
}; 
```

但这对我来说似乎是错误的。我基本上想要双向绑定。因此，当我更改视图模型名称属性时，它会更改支持实体名称......如果我更改支持实体名称，它将更新视图模型名称属性。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:25:38.927

我认为这就是您要寻找的[**ko.computed**](http://knockoutjs.com/documentation/computedObservables.html)：

```
var data = {
    OtherSalesPercent: 0.99
};

function Model(data) {
    this.OtherSalesPercentValue = ko.observable(data.OtherSalesPercent);

    this.OtherSalesPercent = ko.computed({
        read: function () { 
            return Model.OtherSalesPercentValue(); 
        },
        write: function (value) {
            if (this.OtherSalesPercentValue() != value) {
                this.OtherSalesPercentValue(value);
            }
        },
        owner: this
    });
} 
```

[**例子**](http://jsfiddle.net/RHhxC/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T02:26:51.603

如果我理解你的问题，你有几个选择。

首先，默认情况下，根据您选择的“模型库”的约定，微风使**每个实体属性“可观察”。**因此，为了清楚起见，如果您检索到轻风识别为实体的数据，并且轻风的模型库是“ko”（如果您没有配置，则为默认值），那么每个实体属性都将自动成为可观察的淘汰赛。

仅当您的查询返回“实体”时才会发生这种情况。Breeze 通过查找客户端 MetadataStore 中定义的相应 entityType 来确定您的查询结果是否包含实体。

如果返回的数据不是实体或实体集合，那么微风只会将其原始返回。如果您仅对选定字段执行投影，则可能会发生这种情况。IE

```
var query = EntityQuery.from("Orders").select("customer, orderDate"); 
```

在这种情况下，promise 回调中返回的查询结果中的每个项目将只是一个具有两个简单属性的对象，一个“客户”和一个“订单日期”，这两个属性都是不可观察的。

不过，根据您的问题，我想知道您是否只想将每个服务器端实体的子集公开给客户端，但仍需要更改管理和可观察性。如果是这种情况，您可以让服务器端方法返回 DTO，然后通过指定有关每个 DTO 形状的元数据告诉微风客户端这些是“实体类型”。这可以在客户端上最轻松地完成，方法是对您计划返回的每个 DTO 形状使用 MetadataStore.addEntityType 方法。微风文档对此主题进行了更详细的介绍。

我不确定这是否是您要问的，但是...我希望它有所帮助。

# mysql - MySQL 查询的问题

> ID：15819530
> 
> 赞同：0
> 
> 时间：2013-04-04T19:00:30.873
> 
> 标签：mysql

我在制定查询时遇到了一些麻烦，想知道是否有人可以提供帮助。我在这里将表格信息简化到最低限度，以尝试让我更容易理解我正在尝试做的事情。我有两个表 A 和 B。A 有一个 BId 列和一个 Value 字段。B 有与问题无关的信息。我想要做的是基于任意布尔逻辑返回一组 B，该逻辑基于包含 BId 并匹配某个值的 A 的存在。另外，我想返回匹配的值。下面是我在查询中想要的一个几乎可行的示例：

```
SELECT * FROM B
    WHERE 
    (
         (
         EXISTS (
             SELECT a1.Value FROM A as a1 WHERE a1.BId = B.Id AND a1.Value = "X"
         ) 
         AND EXISTS (
             SELECT a2.Value FROM A as a2 WHERE a2.BId = B.Id AND a2.Value = "Y"
         )
         )
         OR EXISTS (
             SELECT a3.Value FROM A as a3 WHERE a3.BId = B.Id AND a3.Value = "Z"
         )
); 
```

就 B 返回而言，这正是我想要的，但是我需要能够返回匹配的值。因此，如果有一个 A 的值为 X，另一个 A 的值为 Y，我希望 a1 和 a2 的值 X 和 Y 包含在行中。如果没有值为 Z 的 A，则该行中将返回 NULL。我不确定这样做的语法或可能性。我尝试的另一种方法是使用 JOIN：

```
SELECT *, a1.Value, a2.Value FROM B 
    INNER JOIN A AS a1 ON a1.BId = B.Id
    INNER JOIN A AS a2 on a2.BId = B.Id
WHERE 
(
  (
     a1.Value = "X" AND a2.Value = "Y"
  )
  OR 
  (
     a1.Value = "Z"
  )
); 
```

这会正确返回值，但仅在 X 和 Y 匹配时才有效。如果 Z 匹配，因为有两个 JOIN 语句来完成第一部分，我得到重复的结果。出于这个原因，我对使用这种方法持怀疑态度。像这样使用 JOIN 似乎不太合适。如果有人能理解我正在尝试做的事情并指出我正确的方向，那将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:24:07.933

您可能已经知道这一点，但无论如何我会指出这一点：正如您所说，您的初始 SQL 查询有效，但您*需要能够返回匹配的值*。对于如何实现这一点没有通用的答案，因为这不是查询的工作方式。该`WHERE EXISTS (SELECT...)`语法不会匹配任何行，如果可以找到*一个或多个*匹配行，它将返回 TRUE。含义：您的数据库可能有也可能没有*多*行匹配。

如果我看一下数据库设计，您的表`A`似乎有一个`BId`指向 中的记录的外键`B`，并且您没有提及任何唯一键，因此很可能至少对于某些值，有多行与您的条件匹配。

如果您尝试使用 JOIN 实现相同的效果，您首先必须确保您只获得与`B`. （在我的示例中有 10 个结果）。通常这是通过使用`GROUP BY`子句来实现的。我还将语法更改为 LEFT JOIN，以便分组结果将在每条记录中准确返回一行`B`：

```
SELECT B.Id, MIN(a1.ID) AS MinA1, MIN(a2.ID) AS MinA2, MIN(a3.ID) as MinA3 FROM B
LEFT JOIN A AS a1 ON a1.BId = B.Id AND a1.value='X'
LEFT JOIN A AS a2 on a2.BId = B.Id AND a2.value='Y'
LEFT JOIN A AS a3 ON a3.BId = B.Id AND a3.value='Z'
GROUP BY B.Id 
```

现在最后一部分是添加一个条件，以消除那些与您的条件不匹配的结果，即：

```
HAVING (MinA1 IS NOT NULL AND MinA2 IS NOT NULL) OR (MinA3) IS NOT NULL 
```

以上假设您的表`A`有一个`Id`您想要检索的列，并且`Id`如果不止一行匹配，您想要最低的列。

# c# - 在 ASP.NET MVC 中的多个会话/应用程序实例之间共享一个对象实例

> ID：15819534
> 
> 赞同：0
> 
> 时间：2013-04-04T19:00:42.603
> 
> 标签：c#, .net, asp.net-mvc, signalr

我正在为日志监视器开发一个项目，并且正在使用带有[SignalR](http://signalr.net/)的 ASP.NET 应用程序。

该应用程序的主要目标是提供跨不同位置的多个客户端的错误日志监视器（LCD 监视器）。每当在数据库中创建日志错误时，应用程序都应通知所有客户端新的错误。

我想`Timer`在 Web 应用程序中创建一个静态变量，该变量将由该`Application_Start`方法启动。

但是，知道应用程序每个会话将有一个线程，我认为 Web 服务器将有很多计时器一起运行。

我需要知道如何使这个`Timer`实例对 Web 服务器中的**所有会话实例都是唯一的。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T22:40:52.353

您可以创建一个具有计时器的实例类。

例如：

```
public class MyTimerHolder
    {
        private static Lazy<MyTimerHolder> _instance = new Lazy<MyTimerHolder>(() => new MyTimerHolder());
        private readonly TimeSpan _checkPeriod = TimeSpan.FromSeconds(3);
        private IHubContext _hubProxy;
        // Threaded timer
        private Timer _timer;

        public MyTimerHolder()
        {
            _timer = new Timer(CheckDB, null, _checkPeriod, _checkPeriod);
        }

        public void BroadcastToHub(IHubContext context)
        {
            _hubProxy = context;
        }

        public void CheckDB(object state)
        {
            if (_hubProxy != null)
            {
                // Logic to check your database

                _hubProxy.Clients.All.foo("Whatever data you want to pass");
            }
        }

        public static MyTimerHolder Instance
        {
            get
            {
                return _instance.Value;
            }
        }
    } 
```

然后，您可以随时从任何方法更改 hubContext。因此，假设您想向连接到集线器“MyDBCheckHub”的客户端广播。在您的应用程序的任何时候，您所要做的就是：

```
MyTimerHolder.Instance.BroadcastToHub(GlobalHost.ConnectionManager.GetHubContext<MyDBCheckHub>()); 
```

你可以把它放在你的应用程序开始或任何你喜欢的地方，应用程序域中只有 1 个 MyTimerHolder 实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T22:29:47.057

Application_Start 不是由新会话触发，而是由[应用程序启动](http://aspalliance.com/1114_Understanding_the_Globalasax_file.all)触发。如果您在 Application_Start 中初始化计时器，则无需担心多个计时器实例。

# python-2.7 - 如何查看列表中有多少成员？

> ID：15819538
> 
> 赞同：1
> 
> 时间：2013-04-04T19:00:53.703
> 
> 标签：python-2.7

我其实有两个问题。

```
lines = file.readlines() 
```

1.) 变量行是一个列表吗？

2.) 如何查看列表中有多少元素？

非常感谢 :D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:05:37.077

```
with open('p7.erl', 'r') as f:
    lines = f.readlines()
    print type(lines)
    print len(lines) 
```

输出：

```
<type 'list'>
27 
```

`len`所以是的，lines 是一个列表，您可以找出 by函数中有多少元素。

如果您只对文件中的行数感兴趣，请参阅[此](https://stackoverflow.com/questions/845058/how-to-get-line-count-cheaply-in-python)

# php - 来自变量的 PHP 类名

> ID：15819539
> 
> 赞同：0
> 
> 时间：2013-04-04T19:00:57.923
> 
> 标签：php

我可以动态命名一个类吗？

我编写了一个过程，它调用了大约 6 个页面，通过 tcpdf 生成 pdf。他们都使用相同的标题页来创建一个类。

```
class myPDF extends TCPDF { 
```

问题是当我运行我的脚本时出现致命错误：在第一页完成后无法重新声明 myPDF 类。

我明白为什么，但不知如何处理。

只调用一次并不好，因为它拥有一个查看页面特定变量的函数。

我也不认为我可以取消声明它。

一种方法是更改​​每个包含的类名，但不确定如何使类名成为变量？

即类 $newname

有任何想法吗

小号

添加了这个

```
class myPDF extends TCPDF {
public function Header () {

global $title;
global $client;
global $host;

$oMulticell->multiCell(266,8, "<s1>$title&nbsp;     Client:</s1> <s2>$client</s2>     <s1>Host:</s1> <s2>$host</s2>     <s1>Currency:</s1> <s2>$currency</s2>     <s1>Reporting Period:</s1> <s2>$start_date_rep to $end_date_rep</s2>", 'TB');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:11:40.730

`include_once();`应该解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:11:04.650

你不能。类定义必须在编译时解析，而不是在运行时解析。您不能创建“动态”类名。

# c - 使用 select 而不是 fork

> ID：15819540
> 
> 赞同：-1
> 
> 时间：2013-04-04T19:00:57.963
> 
> 标签：c, sockets, tcp

在查看了 Beej 的网络编程指南之后，我尝试使用 select 而不是 fork 来重做我的 server.c。我不太确定出了什么问题；我的程序编译，但不接受连接。我知道包含 i<=fdmax 的循环运行不正常，但我不知道为什么。似乎 if 语句无法正常工作。

```
#include <sys/socket.h>
#include <netinet/in.h>
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <string.h>
#include <signal.h>
#include <sys/wait.h>
#include <errno.h>
#include <sys/select.h>

#define Connections 5

void SignalCatcher(int signum)
{
   wait3(NULL,WNOHANG, NULL);
   //wait(-1);
}

int main(int argc, char**argv)
{
   int listenfd,connfd,n, i;
   struct sockaddr_in servaddr,cliaddr;
   socklen_t clilen;
   pid_t     childpid;
   char mesg[1000];
   FILE *inputFile;
   inputFile = fopen("movie.txt", "r");
   char returnMsg[1000];
   int fdmax, newfd;
   fd_set readfd;
   fd_set mastersocket;
   FD_ZERO(&mastersocket);
   FD_ZERO(&readfd);

   //Creating socket number
   listenfd=socket(AF_INET,SOCK_STREAM,0);

   //Setting up the internet address
   bzero(&servaddr,sizeof(servaddr));
   servaddr.sin_family = AF_INET;
   servaddr.sin_addr.s_addr=htonl(INADDR_ANY);
   servaddr.sin_port=htons(32000);
   bind(listenfd,(struct sockaddr *)&servaddr,sizeof(servaddr));

   //Listening for clients
   listen(listenfd,1024);
   FD_SET(listenfd, &mastersocket);
   fdmax=listenfd;

   //signal(SIGCHLD, SIG_IGN);
   signal(SIGCHLD, SignalCatcher);

   //Infinite loop that waits for/accepts connections.
   for(;;)
   {
      readfd = mastersocket;
      clilen=sizeof(cliaddr);
      if(select(fdmax+1, &readfd, NULL, NULL, NULL) == -1) {
       perror("select");
       exit(4);}
      //connfd = accept(listenfd,(struct sockaddr *)&cliaddr,&clilen);

      for(i=0; i<=fdmax;i++)
      {
       if (FD_ISSET(i, &readfd)){
        if(i==listenfd){
            printf("-SUCCESS\n");
            clilen = sizeof cliaddr;
            connfd = accept(listenfd,(struct sockaddr *)&cliaddr,&clilen); }

      if (connfd!=-1)
      {

     // if ((childpid = fork()) == 0)
     // {
         close (listenfd);

         for(;;)
         {

            n = recvfrom(connfd,mesg,1000,0,(struct sockaddr *)&cliaddr,&clilen);

            if (n == -1 /*&& errno == EWOULDBLOCK*/) continue;
            else if(n==0) break;
            //sendto(connfd,mesg,n,0,(struct sockaddr *)&cliaddr,sizeof(cliaddr));
        //write(connfd , mesg , strlen(mesg)); //both work
            //write(connfd , "" , 1);
            printf("-------------------------------------------------------\n");
            printf("%d",listenfd);
            mesg[n] = 0;
            printf("Received the following:\n");
            printf("%s",mesg);
            printf("-------------------------------------------------------\n");

         }

     // } 
      close(connfd);

      } //if connfd!=-1
     } 
    } //for i<=fdmax
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:47:15.133

您可以通过检查函数的返回值自己回答这个问题。在网络编程中，通常的成语是这样的：

```
if (foo() < 0) {
        fprintf(stderr, "foo: %s\n", strerror(errno));
        /* recover from error or... */
        exit(EXIT_FAILURE);
} 
```

...哪里`foo()`是`bind()`, `listen()`, `accept()`,`send*/recv*()`等等之一。

继续尝试。`errno`会告诉你出了什么问题。

此外，目前还不清楚你为什么要使用`select()`。你所做的只是监听一个套接字，一旦有人连接你就关闭它。相反，您可以`accept(listenfd)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:45:33.873

首先，您不应该关闭正在听的 fd，它应该在退出程序时关闭。其次，我们需要接受在侦听套接字上排队的所有传入连接。然后如果侦听套接字不可读，则现有连接必须是可读的，因此请读取该连接的数据。我只读过一次，但你可以在循环中读取该连接，直到 recv 失败。

以下代码更改应该有效：

```
 //Infinite loop that waits for/accepts connections.
   for(;;)
   {
      readfd = mastersocket;
      clilen=sizeof(cliaddr);

      if(select(fdmax+1, &readfd, NULL, NULL, NULL) == -1) {
       perror("select");
       exit(4);}
      //connfd = accept(listenfd,(struct sockaddr *)&cliaddr,&clilen);

     for(i=0; i<=fdmax;i++)
     {
       if (FD_ISSET(i, &readfd)){
         if(i==listenfd){
            printf("-SUCCESS\n");
            clilen = sizeof cliaddr;
            connfd = accept(listenfd,(struct sockaddr *)&cliaddr,&clilen); 
              if (connfd!=-1)
              {
                    FD_SET(connfd, &mastersocket);
                    if (connfd > fdmax) {
                        fdmax = connfd;
                    }
              }
         }
         else
         {
            n = recvfrom(i,mesg,1000,0,(struct sockaddr *)&cliaddr,&clilen);
            if ((n == -1 /*&& errno == EWOULDBLOCK*/)  || (n==0)) {
                 close (i);
                 FD_CLR (i, &mastersocket);
                  if (i == fdmax)
                  {
                     while (FD_ISSET(fdmax, &mastersocket) == 0)
                        fdmax -= 1;
                  }
            }
            //sendto(i,mesg,n,0,(struct sockaddr *)&cliaddr,sizeof(cliaddr));
            //write(i , mesg , strlen(mesg)); //both work
            //write(i , "" , 1);
            printf("-------------------------------------------------------\n");
            printf("%d",listenfd);
            mesg[n] = 0;
            printf("Received the following:\n");
            printf("%s",mesg);
            printf("-------------------------------------------------------\n");
         }
     } 
    } //for i<=fdmax
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T05:08:25.430

我尝试了您的代码进行了更改，并且对我来说效果很好。此外，如果您一次只希望一个客户端与服务器通信，请启用 while 循环以读取客户端数据。

服务器.c

```
#include <sys/socket.h>
#include <netinet/in.h>
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <string.h>
#include <signal.h>
#include <sys/wait.h>
#include <errno.h>
#include <sys/select.h>

#define Connections 5

void SignalCatcher(int signum)
{
   wait3(NULL,WNOHANG, NULL);
   //wait(-1);
}

int main(int argc, char**argv)
{
   int listenfd,connfd,n, i;
   struct sockaddr_in servaddr,cliaddr;
   socklen_t clilen;
   pid_t     childpid;
   char mesg[1000];
   FILE *inputFile;
   inputFile = fopen("movie.txt", "r");
   char returnMsg[1000];
   int fdmax, newfd;
   fd_set readfd;
   fd_set mastersocket;
   FD_ZERO(&mastersocket);
   FD_ZERO(&readfd);

   //Creating socket number
   listenfd=socket(AF_INET,SOCK_STREAM,0);

   //Setting up the internet address
   bzero(&servaddr,sizeof(servaddr));
   servaddr.sin_family = AF_INET;
   servaddr.sin_addr.s_addr=htonl(INADDR_ANY);
   servaddr.sin_port=htons(32000);
   bind(listenfd,(struct sockaddr *)&servaddr,sizeof(servaddr));

   //Listening for clients
   listen(listenfd,1024);
   FD_SET(listenfd, &mastersocket);
   fdmax=listenfd;

   //signal(SIGCHLD, SIG_IGN);
   signal(SIGCHLD, SignalCatcher);

   //Infinite loop that waits for accepts connections.
   for(;;)
   {
      readfd = mastersocket;
      clilen=sizeof(cliaddr);

      if(select(fdmax+1, &readfd, NULL, NULL, NULL) == -1) {
       perror("select");
       exit(4);}
      //connfd = accept(listenfd,(struct sockaddr *)&cliaddr,&clilen);

     for(i=0; i<=fdmax;i++)
     {
       if (FD_ISSET(i, &readfd)){
         if(i==listenfd){
            printf("-SUCCESS\n");
            clilen = sizeof cliaddr;
            connfd = accept(listenfd,(struct sockaddr *)&cliaddr,&clilen); 
              if (connfd!=-1)
              {
                    FD_SET(connfd, &mastersocket);
                    if (connfd > fdmax) {
                        fdmax = connfd;
                    }
              }
         }
         else
         {
            //while(1) {
                n = recvfrom(i,mesg,1000,0,(struct sockaddr *)&cliaddr,&clilen);
                if ((n == -1 /*&& errno == EWOULDBLOCK*/)  || (n==0)) {
                     close (i);
                     FD_CLR (i, &mastersocket);
                      if (i == fdmax)
                      {
                         while (FD_ISSET(fdmax, &mastersocket) == 0)
                            fdmax -= 1;
                      }
                    // break;
                }
                //sendto(i,mesg,n,0,(struct sockaddr *)&cliaddr,sizeof(cliaddr));
                //write(i , mesg , strlen(mesg)); //both work
                //write(i , "" , 1);
                printf("-------------------------------------------------------\n");
                printf("%d",listenfd);
                mesg[n] = 0;
                printf("Received the following:\n");
                printf("%s",mesg);
                printf("-------------------------------------------------------\n");
             }
         //} /* end of while */
     } 
    } //for i<=fdmax
  }
} 
```

客户端.c

```
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <netdb.h>
#include <stdio.h>
#include <unistd.h> 
#include <stdlib.h>
#include <string.h>

#define SERVER_PORT 32000

int main (int argc, char *argv[]) {

  int sd, rc, i;
  struct sockaddr_in localAddr, servAddr;
  struct hostent *h;
  char message[1000] ;

  servAddr.sin_addr.s_addr = inet_addr("127.0.0.1");
  servAddr.sin_family = AF_INET;
  servAddr.sin_port = htons( SERVER_PORT );

  /* create socket */
  sd = socket(AF_INET, SOCK_STREAM, 0);
  if(sd<0) {
    perror("cannot open socket ");
    exit(1);
  }

  /* bind any port number */
  localAddr.sin_family = AF_INET;
  localAddr.sin_addr.s_addr = htonl(INADDR_ANY);
  localAddr.sin_port = htons(0);

  rc = bind(sd, (struct sockaddr *) &localAddr, sizeof(localAddr));
  if(rc<0) {
    printf("%s: cannot bind port TCP %u\n",argv[0],SERVER_PORT);
    perror("error ");
    exit(1);
  }

    /* connect to server */
    rc = connect(sd, (struct sockaddr *) &servAddr, sizeof(servAddr));
    if(rc<0) {
        perror("cannot connect ");
        exit(1);
    }

   while(1)
   {
        printf("Enter message : ");
        scanf("%s" , message);
        rc = send(sd, message, strlen(message) + 1, 0);

        if(rc<0) {
          perror("cannot send data ");
          close(sd);
          exit(1);
        }
        printf("To_server: data%u sent (%s)\n",strlen(message),message);
  }
  return 0; 
} 
```

# json - ASP.NET MVC 4 和 Ext JS 4 网格面板

> ID：15819543
> 
> 赞同：0
> 
> 时间：2013-04-04T19:01:04.683
> 
> 标签：json, extjs, asp.net-mvc-4, web

我正在使用 EF 开发 ASP.Net mvc 4 应用程序。这是 Client/index.cshtml（在添加 ExtJS 之前）

```
@model IEnumerable<Proj.Client>

@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
<table>
    <tr>

        <th>
            @Html.DisplayNameFor(model => model.Name_Clt)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.LName_Clt)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Birthday_Clt)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>

        <td>
            @Html.DisplayFor(modelItem => item.Name_Clt)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.LName_Clt)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Birthday_Clt)
        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new { id=item.ID_Client }) |
            @Html.ActionLink("Details", "Details", new { id=item.ID_Client }) |
            @Html.ActionLink("Delete", "Delete", new { id=item.ID_Client })
        </td>
    </tr>
}

</table> 
```

我正在关注这篇博文，但我无法在上面加载数据。 [http://cincolabs.com/2012/04/10/asp-net-mvc-4-ext-js-4-gridpanel/](http://cincolabs.com/2012/04/10/asp-net-mvc-4-ext-js-4-gridpanel/)

我创建了另一个 ClientController 。

```
 public JsonResult GetUsers()
        {
            var entities = new Entities();
            //What is important is to return the data as JSON.
            return Json(entities.Clients.ToList(), JsonRequestBehavior.AllowGet);
        } 
```

我应该替换此代码吗？

```
public ActionResult Index()
        {
            var db = new Entities();
            return View(db.Clients.ToList());

        } 
```

另一个问题 ：

```
// Set up a model to use in our Store
    Ext.define('Client', {
        extend: 'Ext.data.Model',
        fields: [
        { name: 'First_Name', type: 'string' },
        { name: 'Last_Name', type: 'string' },
        { name: 'Email', type: 'string' },
        { name: 'Date_Created', type: 'date', dateFormat: 'MS'}
    ]
    });

    var userStore = Ext.create('Ext.data.Store', {
        model: 'Client',
        proxy: {
            type: 'ajax',
            url: '/Examples/GetUsers',
            reader: {
                type: 'json',
                root: 'users'
            }
        },
        autoLoad: true
    }); 
```

这是什么意思“url：'/Examples/GetUsers'，”！我应该在我的情况下更换它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T16:58:39.990

你的第一个问题有点含糊。我从未使用过 Ext JS，但从您发布的代码来看，在我看来，它使用 GetUsers 函数创建了自己的表。您发布的第一个视图是一个索引视图，Visual Studio 可以自动创建它来显示您的数据。如果您的 Ext JS 正在创建表格，那么我建议您将 Index View 替换为适当的代码来调用表格数据。然后 GetUsers 方法应重命名为 Index。

您关于 /Examples/GetUsers 的问题应该是保存数据的控制器方法的 URL（类似于 /Client/Save）。

# c# - 在运行时更改应用程序设置

> ID：15819544
> 
> 赞同：15
> 
> 时间：2013-04-04T19:01:15.100
> 
> 标签：c#

所以我在[这里](https://stackoverflow.com/questions/5468342/how-to-modify-my-app-exe-config-keys-at-runtime)寻找解决方案来弄清楚如何做到这一点。而且，它适用于我多次运行我的项目。但是，据我了解，保存仅在项目关闭时发生。我想做的是在我的代码期间需要时保存它，以便在同一运行时，我可以访问以前保存的文件。有人知道如何解决这个问题吗？

这是我用来在运行时保存我的应用程序设置的内容：

```
Configuration config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
config.AppSettings.Settings["CurrentPromoId"].Value = promo_id.ToString();
config.AppSettings.Settings["Date"].Value = DateTime.Today.ToString("yyyyMMdd");
config.Save(ConfigurationSaveMode.Modified, true); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-04T19:07:26.613

那么[RefreshSection](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.refreshsection.aspx)呢？

```
ConfigurationManager.RefreshSection("appSettings"); 
```

# java - 我在 TreeMap 上做错了什么 ?

> ID：15819545
> 
> 赞同：0
> 
> 时间：2013-04-04T19:01:20.003
> 
> 标签：java, nodes, huffman-code, treeset

我正在尝试编写一个利用霍夫曼代码的程序。但是，当我使用树集时，它需要“Char，Integer”的参数。我希望它接受一个“字符串，整数”参数。我能做些什么来解决这个问题？

```
 private static void processFile(HashMap<String,Integer> freq)
  {
    TreeSet<Node> trees = new TreeSet<Node>();  

    for (Map.Entry<String, Integer> entry : freq.entrySet()) {
      String key = entry.getKey();
      Integer value = entry.getValue();

      if (value > 0)
      {
        Node n = new Node(key, value);
        trees.add(n);
      }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:04:31.070

改变：

```
Node n = new Node(key, value); 
```

到：

```
Node n = new Node(key.charAt(0), value); 
```

我假设发生这种情况是因为`Node`构造函数需要一个`char`非字符串。

# python - 包含带有列表列表的键的字典

> ID：15819547
> 
> 赞同：1
> 
> 时间：2013-04-04T19:01:28.957
> 
> 标签：python

我有一个结构如下的字典：

```
{ 'records':[['15','2013-04-02','Mexico','blah','bleh',1,2],['25','2013-04-02','Italy','meh','heh',3,4]], 'attributes':['id','date','location','descr1','descr2','total1','total2'] } 
```

它是使用 json.load 从 json 创建的。

如何遍历记录键以使 ['records'][0] 成为新字典中的键，而 ['records'] 中每个列表的其余部分成为该键的值。

我在想这样的事情，甚至可能不可能，我是 Python 新手：

```
{ '15':['2013-04-02','Mexico','blah','bleh',1,2], '25':['2013-04-02','Italy','meh','heh',3,4] } 
```

有人可以指出我正确的方向来迭代原始字典以创建新字典吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T19:03:55.290

如果`d`是你的字典：

```
In [5]: {rec[0]:rec[1:] for rec in d['records']}
Out[5]: 
{'15': ['2013-04-02', 'Mexico', 'blah', 'bleh', 1, 2],
 '25': ['2013-04-02', 'Italy', 'meh', 'heh', 3, 4]} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:04:31.947

```
rec_lsts = orgi_dict['records']
new_dict = {}
for l_list in rec_lsts:
    new_dict[l_lst[0]] = l_lst[1:] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:03:38.567

```
d = { 'records':[['15','2013-04-02','Mexico','blah','bleh',1,2], ['25','2013-04-02','Italy','meh','heh',3,4]], 'attributes':['id','date','location','descr1','descr2','total1','total2']}

new_d = {}

for a in d['records']:
    new_d[a[0]] = a[1:]

print new_d 
```

# php - 网页中的本周

> ID：15819549
> 
> 赞同：-3
> 
> 时间：2013-04-04T19:01:46.817
> 
> 标签：php, mysqli

这是我的代码，一切正常，除了 $w 应该是周数。

```
 $w="WEEKOFYEAR()"; 
```

当我硬编码周数时，我已经声明了所有内容并且我的代码有效

```
$w=13;

insert($actual,$target['value'],$country,$ini,$goal ,$comment,$an,$w,$con); 
```

我收到以下错误：而不是显示第 13 周；它从 0 开始

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:04:05.233

问题是这`WEEKOFYEAR()`不是默认的 PHP 函数。用于`date()`获取当前周数。

```
$w = date('W'); 
```

**请注意，“W”是大写的 W，它会有所不同。**

此外，请查看 PHP 文档`date()`： http: [//php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:05:25.323

如果你想得到本周，你可以试试这个

```
$weekNumber = date("W"); 
```

文档： http: [//php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)

# javascript - 在 UnderscoreJS 中，是否有用于匹配任何键值对的集合过滤器？

> ID：15819551
> 
> 赞同：1
> 
> 时间：2013-04-04T19:01:50.747
> 
> 标签：javascript, underscore.js

我有一个查询，我需要匹配任何多个值。_.where 方法非常接近：

这是 _where 文档：

> where_.where(list, properties) 查看列表中的每个值，返回包含属性中列出**的所有键值对**的所有值的数组。

```
 _.where(listOfPlays, {author: "Shakespeare", year: 1611});
 => [{title: "Cymbeline", author: "Shakespeare", year: 1611},
     {title: "The Tempest", author: "Shakespeare", year: 1611}] 
```

我需要一个 .whereAny 方法：

```
_.whereAny(listOfMovies, {director: "Tarantino", director: "Scorcese"});
=>[{title: "Pulp Fiction", director: "Tarantino", year:1996},{title:"Taxi", director: "Scorcese", year:1983}] 
```

它将返回与**任何**提供的键值对匹配的对象数组。我错过了这种方法，还是有一种简单的方法可以做到？

非常感谢！

*更详细的解释 - 我正在尝试使用三个复选框过滤大量对象。原始数据集中的每个项目都有一个对应于这三个值之一的属性。如果您选择复选框 1（值：红色），我将获得原始数据集的子集，其中仅包含键值 = 红色的项目。如果您还选择了复选框 2（值：橙色），那么我将需要查询这两个值，依此类推。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:50:07.493

您可以使用[http://underscorejs.org/#filter](http://underscorejs.org/#filter)这样：

```
_.filter(listOfMovies, function(movie) { return movie.director == 'Tarantino' || movie.director == 'Scorcese'; }); 
```

# sql-server - 实体框架和多个数据库版本

> ID：15819556
> 
> 赞同：0
> 
> 时间：2013-04-04T19:02:03.327
> 
> 标签：sql-server, entity-framework, linq-to-sql

我们使用实体框架从 Dynamics GP 数据库中获取数据以显示网站。随着时间的推移和数据库中字段的添加，我们遇到了一个问题，即 EF 需要使用表中的新字段进行更新。当然这有一个副作用，我们的网站将只支持我们的数据库的最新版本。由于我们的客户在现场拥有截然不同的数据库版本，因此很难管理 EF 以支持所有这些不同的版本。

在 LinqToSql 中，您可以省略我们在网站中不关心的添加字段或延迟加载它们。在 EF 中，尝试此操作时会出现错误。关于如何做到这一点而不必为不同版本的数据库构建不同版本的 edmx 的任何想法？

谢谢！

# wpf - 使用转换器的 WPF 绑定组合框

> ID：15819561
> 
> 赞同：1
> 
> 时间：2013-04-04T19:02:11.567
> 
> 标签：wpf, binding, combobox, converter

我有一个`ComboBox`绑定到一个`EnumerableRowCollection<T>`：

```
ComboFamilyStatus.ItemsSource = EnumerableRowCollection<TaxDataSet.SourcesOfValuesRow> coll; 
```

我的 xaml 看起来像这样：

```
<ComboBox Name="ComboFamilyStatus" DisplayMemberPath="Description" 
          Text="{Binding FamilyStatus, Converter={StaticResource FamilyStatusStringConverter}}"> 
```

我正在使用`DisplayMemberPath`来显示行的描述。SourcesOfValuesRow 有一个值和一个描述，在组合中我想查看描述文本。文本绑定到 FamilyStatus 保存为 int 值的数据库，这就是我添加转换器的原因。

我的问题是转换器是否可以使用组合框中的 itemsource 从 int 值转换为字符串？我没有看到转换器对组合一无所知。与此同时，我编写了转换器以再次`EnumerableRowCollection<TaxDataSet.SourcesOfValuesRow>`从数据库中获取并找到匹配的描述 - 这不是最简单的方法！有什么建议么？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:18:17.647

在这种情况下，您最好使用 a `DataTemplate`，而不是 a `Converter`。

您已经有一个数据类。只需使用将绑定`DataTemplate`插入到 int 值的 a ，然后在此处应用您的转换器。`Textblock`

```
<ComboBox>
   <ComboBox.ItemTemplate>
      <DataTemplate DataType="{x:Type local:TaxDataSet.SourcesOfValuesRow}">
         <TextBlock Text="{Binding FamilyStatus, Converter={StaticResource FamilyStatusStringConverter}}"/>
      </DataTemplate>
   </ComboBox.ItemTemplate>
<ComboBox> 
```

将您的 SourcesOfValuesRow FamilyStatusProperty 更改为枚举。从 int 派生可以直接转换它。

```
enum FamilyStatusValues : int
{
   [Description("Married")]
   Married,
   [Description("Divorced")]
   Divorced,
   [Description("Living Together")]
   LivingTogether
} 
```

然后在您的转换器中使用此代码

```
ConvertTo(object value, ...)
{
   FieldInfo field = value.GetType().GetField(value.ToString());
   object[] attribs = field.GetCustomAttributes(typeof(DescriptionAttribute), true));
   if(attribs.Length > 0)
   {
       return ((DescriptionAttribute)attribs[0]).Description;
   }
   return string.Empty;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T19:21:26.497

无需使用任何转换器。它对我有用：

```
<ComboBox Name="FamilyStatus" Grid.Row="7" Grid.Column="1" ItemsSource="{Binding Source={StaticResource comboProvider}}"
            SelectedValuePath="Value" DisplayMemberPath="Description" SelectedValue="{Binding FamilyStatus}"> 
```

`DisplayMemberPath`中的字符串在哪里，`TaxDataSet.SourcesOfValuesRow`并且`SelectedValuePath`是 int 值。这`SelectedValue`是联系人表中的值（而不是写在 combo 中`Text="{Binding FamilyStatus, Converter={StaticResource FamilyStatusStringConverter}}`）。

# javascript - 我怎样才能弄清楚 Javascript 在哪里改变了我的关注点

> ID：15819565
> 
> 赞同：2
> 
> 时间：2013-04-04T19:02:26.203
> 
> 标签：javascript, asp.net

我目前正在开发一个包含大量 js 文件的 ASP.Net 项目，其中大部分来自第三方来源。在许多页面上，焦点被设置为一个控件，而不是我在代码隐藏 (Control.Focus()) 中设置的那个控件。我怎样才能弄清楚焦点是如何、为什么以及在哪里改变的？

我已经为 FireBug 安装了[FireFocus](http://www.incaseofstairs.com/firefocus/)，所以我可以看到焦点正在改变，但我看不到原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T14:41:25.463

使用 Moby's Stunt Double 提供的链接，我将以下代码添加到页面底部，每次更改焦点时，调用堆栈都会转储到我的控制台，以便我可以追踪源。

```
<script type="text/javascript">
    $("#TabInformation").on("focus", function (event) {
        try { throw new Error("dummy"); } catch (e) { console.log(e.stack); }
    });
</script> 
```

# wordpress - WordPress 插件和使用

> ID：15819566
> 
> 赞同：-2
> 
> 时间：2013-04-04T19:02:28.893
> 
> 标签：wordpress

我为 wordpress 安装了一个插件并激活了它。

然后我在这个自定义帖子类型下发布了其中的一些。

但是，您如何查看它们的列表视图（我刚刚发布的那些）？

现在，我一次只能查看一个帖子。我还看到文件目录里面有一个名为archive-xxx.php的文件。我认为这用于显示所有这些自定义帖子类型的存档或列表。但是我该如何确定呢？

下载并尝试看看是否可以创建一些帖子并显示它们 [http://wp.tutsplus.com/tutorials/plugins/creating-client-testimonials-with-custom-post-types/](http://wp.tutsplus.com/tutorials/plugins/creating-client-testimonials-with-custom-post-types/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:11:23.957

帖子类型将有一个[页面模板](http://codex.wordpress.org/Pages#Page_Templates)来显示帖子。您需要使用该页面模板创建一个页面。该“自定义帖子类型”中的所有帖子都将出现在该页面中。

您可以参考[这篇](http://wp.smashingmagazine.com/2012/11/08/complete-guide-custom-post-types/)文章或[这篇](http://wp.tutsplus.com/tutorials/plugins/a-guide-to-wordpress-custom-post-types-creation-display-and-meta-boxes/)文章以获得关于自定义帖子类型的更好教程。

# vba - 将函数输出分配给变量 Excel VBA 时出错

> ID：15819570
> 
> 赞同：2
> 
> 时间：2013-04-04T19:02:40.100
> 
> 标签：vba, excel

我正在使用从 Microsoft 复制的函数，该函数采用列号并重新分配列字母。我需要这样做来创建一个公式。我已经研究了一整天，无法查明错误的原因（我也尝试将其作为子进程来完成）。该功能在其自己的模块中。我测试了它，它工作正常：

```
Function ConvertToLetter(ByRef iCol As Integer) As String
  Dim iAlpha As Integer
  Dim iRemainder As Integer
  iAlpha = Int(iCol / 27)
  iRemainder = iCol - (iAlpha * 26)
  If iAlpha > 0 Then
     ConvertToLetter = Chr(iAlpha + 64)
  End If
  If iRemainder > 0 Then
     ConvertToLetter = ConvertToLetter & Chr(iRemainder + 64)
  End If
End Function 
```

给我一个错误的代码是：

```
For groups = 1 To i ' level 1 grouping
    For iCol = 24 To 136
       rCol = ConvertToLetter(iCol)
       Cells(Start(groups) - 1, rCol).Formula = "=COUNTA(" & rCol & Start(groups) & ":" & rCol & Finish(groups) & ")"
    Next
Next 
```

我尝试将函数代入公式本身：

```
 Cells(Start(groups) - 1, ConvertToLetter(iCol)).Formula = "=COUNTA(" & ConvertToLetter(iCol) & Start(groups) & ":" & ConvertToLetter(iCol) & Finish(groups) & ")" 
```

调试器通过了第一个函数调用，但没有通过第二个和第三个函数调用。我收到的错误是“期望变量或过程，而不是模块”的类型。在第二种情况下，我得到了其他错误，我的脑袋很模糊，我想不起来了。

任何帮助是极大的赞赏。我已经没有想法了。非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:03:58.240

您几乎不需要将列转换为字母。首先考虑使用FormulaR1C1

```
For groups = 1 To i ' level 1 grouping
    For iCol = 24 To 136
        lLast = Finish(groups) - Start(groups) + 1
        Sheet1.Cells(Start(groups) - 1, iCol).FormulaR1C1 = _
            "=COUNTA(R[1]C:R[" & lLast & "]C)"
    Next iCol
Next groups 
```

如果不喜欢R1C1，可以直接用Address

```
For groups = 1 To i ' level 1 grouping
    For iCol = 24 To 136
        Set rStart = Sheet1.Cells(Start(groups), iCol)
        Set rEnd = Sheet1.Cells(Finish(groups), iCol)

        rStart.Offset(-1, 0).Formula = _
            "=COUNTA(" & rStart.Address & ":" & rEnd.Address & ")"

    Next iCol
Next groups 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:21:54.047

以下函数将列号转换为字母：它利用该`.Address`方法大大简化了生活。

```
Function convertToLetter(colnum)
mycell = [A1].Offset(0, colnum - 1).Address
convertToLetter = Mid(mycell, 2, Len(mycell) - 3)
End Function 
```

但是现在我查看了您的代码 - 当您使用该`Cells`功能时，您应该使用数字而不是字母来调用它。所以你有另一个问题！

尝试以下操作：

```
For groups = 1 To i ' level 1 grouping
    For iCol = 24 To 136
       rCol = ConvertToLetter(iCol)
       Cells(Start(groups) - 1, iCol).Formula = "=COUNTA(" & rCol & Start(groups) & ":" & rCol & Finish(groups) & ")"
    Next
Next 
```

注意我在语句的一部分中`iCol`没有使用。这可能不是唯一的错误......`rCol``Cells(Start(groups)-1, iCol) =`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T19:22:19.623

您使用的功能有问题。检查这个例子

```
Sub Sample()
    Dim iCol As Integer
    For iCol = 131 To 134
        Debug.Print iCol; ConvertToLetter(iCol)
    Next iCol
End Sub

Function ConvertToLetter(ByRef iCol As Integer) As String
    Dim iAlpha As Integer
    Dim iRemainder As Integer
    iAlpha = Int(iCol / 27)
    iRemainder = iCol - (iAlpha * 26)
    If iAlpha > 0 Then
       ConvertToLetter = Chr(iAlpha + 64)
    End If
    If iRemainder > 0 Then
       ConvertToLetter = ConvertToLetter & Chr(iRemainder + 64)
    End If
End Function 
```

**输出**

```
131 D[
132 D\
133 D]
134 D^ 
```

使用我从我提到的链接中获取的这段代码。

```
rcol = Split(Cells(, iCol).Address, "$")(1) 
```

代替

```
rCol = ConvertToLetter(iCol) 
```

# python - 如何在使用 Nosetests 进行单元测试期间分析代码？

> ID：15819571
> 
> 赞同：2
> 
> 时间：2013-04-04T19:02:43.160
> 
> 标签：python, nosetests

我已经查看`--with-timer`并`--with-profile`分析了我的测试，但这些选项要么提供的信息太少，要么提供的信息太多。

例如，如果我有以下测试：

```
def test_foo():
    do_something()
    do_something_else() 
```

我只想分析每个函数调用或测试中的每一行花费了多长时间。所以输出将是这样的：

```
 do_something() : .5 seconds
   do_something_else() : .5 seconds
   test_foo() : 1 seconds 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:26:57.437

受此[演讲](https://groups.google.com/forum/?fromgroups=#!topic/nose-users/rVFBXRS9oG4)的启发，您可以使用 Xunit 插件并对其 xml 进行后处理

使用 --with-xunit 和以下代码处理nosetests.xml

```
from xml.etree.cElementTree import parse 
from operator import itemgetter 

elems = parse(open("nosetests.xml")).getiterator("testcase") 
tests = sorted(((e.get("name"), int(e.get("time"))) for e in elems), 
               key=itemgetter(1), reverse=1) 

for test in (test for test in tests if test[1]): 
    print "%s: %s sec" % test 
```

# jboss - MQJMS2005：无法从 JBOSS 创建 MQQueueManager

> ID：15819572
> 
> 赞同：4
> 
> 时间：2013-04-04T19:02:44.283
> 
> 标签：jboss, ibm-mq

使用 JBOSS 4.3 和 Java 1.5.0_15 连接到 IBM WebSphere MQ 6.0.2.3

当 JBOSS 启动时，会出现这些错误。

**堆栈跟踪**

```
Caused by: javax.resource.spi.ResourceAdapterInternalException: javax.jms.JMSException: MQJMS2005: failed to create MQQueueManager for 'uatmq1sun:UATMQ1SUN'
        at com.ibm.mq.connector.ResourceAdapterConnectionPool.allocateConnection(ResourceAdapterConnectionPool.java:297)
        at com.ibm.mq.connector.ResourceAdapterImpl.endpointActivation(ResourceAdapterImpl.java:333)
        at org.jboss.resource.deployment.RARDeployment.endpointActivation(RARDeployment.java:271)
        at org.jboss.resource.deployment.RARDeployment.internalInvoke(RARDeployment.java:226)
        at org.jboss.system.ServiceDynamicMBeanSupport.invoke(ServiceDynamicMBeanSupport.java:156)
        at org.jboss.mx.server.RawDynamicInvoker.invoke(RawDynamicInvoker.java:164)
        at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
        at org.jboss.ejb3.JmxClientKernelAbstraction.invoke(JmxClientKernelAbstraction.java:46)
        at org.jboss.ejb3.mdb.inflow.JBossMessageEndpointFactory.activate(JBossMessageEndpointFactory.java:343)
        ... 147 more

Caused by: javax.jms.JMSException: MQJMS2005: failed to create MQQueueManager for 'uatmq1sun:UATMQ1SUN'
        at com.ibm.mq.jms.services.ConfigEnvironment.newException(ConfigEnvironment.java:614)
        at com.ibm.mq.jms.MQConnection.createQM(MQConnection.java:2549)
        at com.ibm.mq.jms.MQConnection.createQMNonXA(MQConnection.java:1899)
        at com.ibm.mq.jms.MQConnection.<init>(MQConnection.java:862)
        at com.ibm.mq.jms.MQConnectionFactory.createConnection(MQConnectionFactory.java:4821)
        at com.ibm.mq.connector.ResourceAdapterConnectionPool.initializeJMSConnection(ResourceAdapterConnectionPool.java:445)
        at com.ibm.mq.connector.ResourceAdapterConnectionPool.createNewConnection(ResourceAdapterConnectionPool.java:359)
        at com.ibm.mq.connector.ResourceAdapterConnectionPool.allocateConnection(ResourceAdapterConnectionPool.java:284)
        ... 155 more 
```

在 JBOSS server.log 文件的末尾。

```
--- MBEANS THAT ARE THE ROOT CAUSE OF THE PROBLEM ---
ObjectName: jboss.j2ee:ear=AmxBol.ear,jar=AmxBol.jar,name=BOLCFulfillmentMDB,service=EJB3
  State: FAILED
  Reason: org.jboss.deployment.DeploymentException: Endpoint activation failed ra=jboss.jca:service=RARDeployment,name='wmq.jmsra.rar' activationSpec=javax.jms.Queue:bolcustomizable@UATMQ1SUN@uatmq1sun; - nested throwable: (javax.resource.spi.ResourceAdapterInternalException: javax.jms.JMSException: MQJMS2005: failed to create MQQueueManager for 'uatmq1sun:UATMQ1SUN')

ObjectName: jboss.j2ee:ear=AmxBol.ear,jar=AmxBol.jar,name=BOLPaymentMDB,service=EJB3
  State: FAILED
  Reason: org.jboss.deployment.DeploymentException: Endpoint activation failed ra=jboss.jca:service=RARDeployment,name='wmq.jmsra.rar' activationSpec=javax.jms.Queue:bolpayment@UATMQ1SUN@uatmq1sun; - nested throwable: (javax.resource.spi.ResourceAdapterInternalException: javax.jms.JMSException: MQJMS2005: failed to create MQQueueManager for 'uatmq1sun:UATMQ1SUN')

ObjectName: jboss.j2ee:ear=AmxBol.ear,jar=AmxBol.jar,name=BOLPFulfillmentMDB,service=EJB3
  State: FAILED
  Reason: org.jboss.deployment.DeploymentException: Endpoint activation failed ra=jboss.jca:service=RARDeployment,name='wmq.jmsra.rar' activationSpec=javax.jms.Queue:bolpersonalized@UATMQ1SUN@uatmq1sun; - nested throwable: (javax.resource.spi.ResourceAdapterInternalException: javax.jms.JMSException: MQJMS2005: failed to create MQQueueManager for 'uatmq1sun:UATMQ1SUN') 
```

我不确定它是否相关，但最近对 JBOSS 应用了一个补丁。队列管理器 (UATMQ1SUN) 已启动并正在运行，但它似乎不想连接。关于什么可能是错的任何想法？MQ 和 JBOSS 生活在同一个盒子上。

```
hostname = uatmq1sun
QManagerName = UATMQ1SUN

[mqm@uatmq1sun ~]$ strmqm UATMQ1SUN
WebSphere MQ queue manager running.

[mqm@uatmq1sun ~]$ netstat -an | grep 1416
tcp        0      0 :::1416                     :::*                        LISTEN 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-06T13:46:19.750

JMS 抛出嵌套异常，其中高级异常包含通用 JMS 失败代码，链接异常包含提供程序特定的异常。因此，例如，在创建 QMgr 对象失败的所有可能原因中，有些是本地的，包括配置错误等内容，有些仅在尝试连接时发生。换句话说，您报告的错误的某些情况是代码，有些是 MQ。如果没有链接异常，则问题不在于 MQ。

在仅在尝试连接时发生的那些（那些是 MQ 问题）中，链接异常会明确告诉您它是否已连接但发现错误的 QMgr 名称，或者没有侦听器，或者通道协商失败等. 但是这些非常具体的解释只有在代码费心打印链接的异常时才可用。

在我工作或咨询过的许多商店中，如果发现 JMS 代码不打印链接异常，则将其视为 Sev-1 缺陷，并对此进行了测试。此类代码被阻止升级到生产环境，如果在生产环境中发现，它会被拉出并作为紧急更改进行修复。预期的是代码要么打印链接的异常，要么打印它检查但不存在链接的异常。没有这些，我们在这里能做的最好的事情（或者你的运营团队在实际中断时能做的）只是猜测。

[从关于JMS 异常](http://ibm.co/1hPYdHb)的 WebSphere MQ 信息中心页面：

```
catch (JMSException je) {
    System.err.println("Caught JMSException");

    // Check for linked exceptions in JMSException
    Throwable t = je;
    while (t != null) {
        // Write out the message that is applicable to all exceptions
        System.err.println("Exception Msg: " + t.getMessage());
        // Write out the exception stack trace
        t.printStackTrace(System.err);

        // Add on specific information depending on the type of exception
        if (t instanceof JMSException) {
            JMSException je1 = (JMSException) t;
            System.err.println("JMS Error code: " + je1.getErrorCode());

            if (t instanceof JmsExceptionDetail){
                JmsExceptionDetail jed = (JmsExceptionDetail)je1;
                System.err.println("JMS Explanation: " + jed.getExplanation());
                System.err.println("JMS Explanation: " + jed.getUserAction());
            }
        } else if (t instanceof MQException) {
            MQException mqe = (MQException) t;
            System.err.println("WMQ Completion code: " + mqe.getCompCode());
            System.err.println("WMQ Reason code: " + mqe.getReason());
        } else if (t instanceof JmqiException){
            JmqiException jmqie = (JmqiException)t;
            System.err.println("WMQ Log Message: " + jmqie.getWmqLogMessage());
            System.err.println("WMQ Explanation: " + jmqie.getWmqMsgExplanation());
            System.err.println("WMQ Msg Summary: " + jmqie.getWmqMsgSummary());
            System.err.println("WMQ Msg User Response: "
                               + jmqie.getWmqMsgUserResponse());
            System.err.println("WMQ Msg Severity: " + jmqie.getWmqMsgSeverity());
        }

        // Get the next cause
        t = t.getCause();
    }
} 
```

尝试使用*任何*传输提供程序调试*任何*JMS 异常时，请打印链接的异常。该规范定义了一个嵌套数据结构来传达异常诊断条件，并且没有理由不打印该信息。

# javascript - jquery next with clone 用于照片库

> ID：15819589
> 
> 赞同：0
> 
> 时间：2013-04-04T19:03:22.237
> 
> 标签：javascript, jquery, image, gallery, clone

我正在制作的图片库使用 jquery clone 复制单击的图像缩略图并将其附加到#big div，这有助于居中和固定定位。我遇到的问题是当我单击#right_arrow 或#left_arrow 时，我似乎无法弄清楚如何选择列表中的下一个或上一个项目并将其附加到正文中。

我知道 jquery 有 .next() 但我无法弄清楚它是如何工作的。

这是 jsFiddle：http: [//jsfiddle.net/reveries/UgQre/](http://jsfiddle.net/reveries/UgQre/)

```
 $(document).ready
            $('img, div.wrapper').each( function() {
                var $img = $(this);
                $img.addClass('thumbnail');
                $img.wrap('<li></li>');

                $img.click(function() {
                    $img.clone().appendTo('#big');
                    $('#big').fadeToggle('slow');
                    $('#right_arrow').fadeIn('slow');
                    $('#left_arrow').fadeIn('slow');
                });

            $('#big').click(function(){
                $img.addClass('thumbnail');
                $('#big').fadeOut('slow');
                $(this).html('');
                $('#right_arrow').fadeOut('slow');
                $('#left_arrow').fadeOut('slow');
            })
            $('#right_arrow').click(function(){
                $('#big').html('');
            })
            $('#left_arrow').click(function(){
                $('#big').html('');
            })

        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:48:28.927

这是您的小提琴的固定版本：http: [//jsfiddle.net/abeisgreat/fu3fX/](http://jsfiddle.net/abeisgreat/fu3fX/)

您的代码存在一些问题，使其无法正常工作。首先，您的 .click() 调用在您的 .each 中，这意味着 #big、#right_arrow、#left_arrow 都将具有同一函数的多个绑定，这不是您想要的。

其次，您正确地假设 .next() 和 .prev() 是您想要使用的，问题是 $img.next() 不存在，因为您将每个 img 包装在 li 标签中在你的 .each() 中。因为这个 $img 没有兄弟， .next() 和 .prev() 不会返回下一个 img 标签。所以你真的需要调用 $img.parent().next().children() 来获取下一张图片。

我所做的唯一重大更改是添加了一个名为 $selected_li 的全局变量，其中包含所选图像的 li。一旦我们有了它，我们就可以做到这一点。

```
$('#left_arrow').click(function(){
    $('#big').html('');
    $selected_li.prev('li').children('img').clone().appendTo('#big');
    $selected_li = $selected_li.prev('li')
}) 
```

向后前进或与 .next() 完全相同以前进。你非常接近，就像我说的那样，我认为最大的问题是用 li 包装它从你的 img 标签中删除了任何兄弟姐妹！

希望这有帮助，安倍

# java - 制作绘画程序的问题

> ID：15819597
> 
> 赞同：0
> 
> 时间：2013-04-04T19:03:50.900
> 
> 标签：java, swing, awt, paint, jslider

我对java有点陌生并且一直在尝试制作一个简单的绘画程序，除了画笔的颜色之外，我已经完成了所有工作。现在我将颜色设置为蓝色，但我想让画笔的颜色与颜色滑块选择的颜色相同。

这是我到目前为止得到的代码

```
import javax.swing.*;
import javax.swing.event.*;
import java.awt.*;
import java.awt.event.*;

public class Paint extends JFrame implements ChangeListener{
    PaintPanel color;
    PaintPanel2 paint;
    JSlider red;
    JSlider green;
    JSlider blue;

    public Paint(){
        super("Paint");
        setSize(300,290);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setVisible(true);

        color = new PaintPanel();
        paint = new PaintPanel2();
        red = new JSlider(0,255,255);
        green = new JSlider(0,255,0);
        blue = new JSlider(0,255,0);

        red.setMajorTickSpacing(50);
        red.setMinorTickSpacing(10);
        red.setPaintTicks(true);
        red.setPaintLabels(true);
        red.addChangeListener(this);

        green.setMajorTickSpacing(50);
        green.setMinorTickSpacing(10);
        green.setPaintTicks(true);
        green.setPaintLabels(true);
        green.addChangeListener(this);

        blue.setMajorTickSpacing(50);
        blue.setMinorTickSpacing(10);
        blue.setPaintTicks(true);
        blue.setPaintLabels(true);
        blue.addChangeListener(this);

        JLabel redLabel = new JLabel("Red: ");
        JLabel greenLabel = new JLabel("Green: ");
        JLabel blueLabel = new JLabel("Blue: ");
        GridLayout grid = new GridLayout(5,1);
        FlowLayout flow = new FlowLayout(FlowLayout.RIGHT);
        setLayout(grid);

        JPanel redPanel = new JPanel();
        redPanel.setLayout(flow);
        redPanel.add(redLabel);
        redPanel.add(red);
        add(redPanel);

        JPanel greenPanel = new JPanel();
        greenPanel.setLayout(flow);
        greenPanel.add(greenLabel);
        greenPanel.add(green);
        add(greenPanel);

        JPanel bluePanel = new JPanel();
        bluePanel.setLayout(flow);
        bluePanel.add(blueLabel);
        bluePanel.add(blue);
        add(bluePanel);       
        add(color);
        add(paint);

        setVisible(true);
    }

    public void stateChanged(ChangeEvent e){
        JSlider source = (JSlider) e.getSource();
        if(source.getValueIsAdjusting() != true){
            Color mainColor = new Color(red.getValue(),
                green.getValue(),
                blue.getValue());
            color.changeColor(mainColor);
            color.repaint();
        }
    }

    public static void main(String[] args){
        Paint p = new Paint();
    }
}

class PaintPanel extends JPanel{
    Color background;

    public PaintPanel(){
        background = Color.red;
    }

    public void paintComponent(Graphics comp){
        Graphics2D comp2D = (Graphics2D) comp;
        comp2D.setColor(background);
        comp2D.fillRect(0,0,getSize().width,getSize().height);
    }

    void changeColor(Color newBackground){
        background = newBackground;
    }
}

class PaintPanel2 extends JPanel{
    Image image;
    Graphics2D comp2D;
    int currentX, currentY, oldX, oldY;
    PaintPanel color;

    public PaintPanel2(){
        color = new PaintPanel();      

        addMouseListener(new MouseAdapter(){
            public void mousePressed(MouseEvent e){
                oldX = e.getX();
                oldY = e.getY();
            }
        });

        addMouseMotionListener(new MouseMotionAdapter(){
            public void mouseDragged(MouseEvent e){
                currentX = e.getX();
                currentY = e.getY();
                if(comp2D != null)
                comp2D.drawLine(oldX, oldY, currentX, currentY);
                repaint();
                oldX = currentX;
                oldY = currentY;
            }
        });
    }

    public void paintComponent(Graphics comp){
        if(image == null){
            image = createImage(getSize().width, getSize().height);
            comp2D = (Graphics2D)image.getGraphics();
            comp2D.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            comp2D.setPaint(Color.white);
            comp2D.fillRect(0, 0, getSize().width, getSize().height);
            comp2D.setPaint(Color.blue);
            repaint();
        }
        comp.drawImage(image, 0, 0, null);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T08:37:00.237

问题是您没有在 PaintPanel2 中设置所选颜色。我按如下方式更改了 stateChanged 方法和 PaintPanel2，现在它按我假设的那样工作：

```
public void stateChanged(ChangeEvent e) {
        JSlider source = (JSlider) e.getSource();
        if (source.getValueIsAdjusting() != true) {
            Color mainColor = new Color(red.getValue(),
                    green.getValue(),
                    blue.getValue());
            color.changeColor(mainColor);
            paint.setPaintColor(mainColor);
            color.repaint();
        }
    }

class PaintPanel2 extends JPanel {

    Image image;
    Graphics2D comp2D;
    int currentX, currentY, oldX, oldY;

    public PaintPanel2() {

        addMouseListener(new MouseAdapter() {
            public void mousePressed(MouseEvent e) {
                oldX = e.getX();
                oldY = e.getY();
            }
        });

        addMouseMotionListener(new MouseMotionAdapter() {
            public void mouseDragged(MouseEvent e) {
                currentX = e.getX();
                currentY = e.getY();
                if (comp2D != null) {
                    comp2D.drawLine(oldX, oldY, currentX, currentY);
                }
                repaint();
                oldX = currentX;
                oldY = currentY;
            }
        });
    }

    public void paintComponent(Graphics comp) {
        if (image == null) {
            image = createImage(getSize().width, getSize().height);
            comp2D = (Graphics2D) image.getGraphics();
            comp2D.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            comp2D.setPaint(Color.white);
            comp2D.fillRect(0, 0, getSize().width, getSize().height);
            comp2D.setPaint(Color.blue);
            repaint();
        }
        comp.drawImage(image, 0, 0, null);
    }

    public void setPaintColor(Color color) {
        comp2D.setColor(color);
    }
} 
```

# python-3.x - 拖放文件 url 的顺序

> ID：15819599
> 
> 赞同：1
> 
> 时间：2013-04-04T19:04:02.307
> 
> 标签：python-3.x, drag-and-drop, pyqt, qlistwidget

我有一个`QListWidget`允许拖放文件。这是一个非常标准的表格，已经被广泛覆盖。我在下面复制的代码有效。

我遇到的问题是列表小部件中文件条目的顺序。为了说明我的问题，假设用户（通过按住 shift、ctrl 或其他方式）选择了四个按 Windows 文件资源管理器中所述命名`1.txt, 2.txt, 3.txt`和排序的文件。`4.txt`当用户拖动这四个选定的文件时，我希望它们以相同的顺序附加到列表小部件中。

但是，实际上发生的情况是，列表中的第一个文件取决于在拖放操作开始时碰巧单击了所选组中的哪个文件。假设用户在开始拖动时单击`3.txt`：然后列表小部件将填充为`3.txt, 4.txt, 1.txt, 2.txt`. 我想通过忽略在拖动操作开始时作为所选组的一部分碰巧单击的任何文件来保留文件在 Windows 文件管理器中的顺序。我进行了广泛的搜索，但没有找到解决方案。

```
class FileList(QtGui.QListWidget):
    enableRun = QtCore.pyqtSignal(bool)
    defaultFilePath = QtCore.pyqtSignal(str)

    def __init__(self):
        super(FileList,self).__init__()

        self.setAcceptDrops(True)
        self.setDragEnabled(True)
        self.setDropIndicatorShown(True)
        self.setToolTip('Drag and drop files that you wish to combine')
        self.setDragDropMode(QtGui.QAbstractItemView.InternalMove)
        self.setAlternatingRowColors(True)
        self.setSelectionMode(QtGui.QAbstractItemView.ExtendedSelection)

        self.itemDoubleClicked.connect(self.remove)

    def dragEnterEvent(self, event):
        if event.mimeData().hasUrls():
          event.acceptProposedAction()
        else:
          super(FileList, self).dragEnterEvent(event)

    def dragMoveEvent(self, event):
        if event.mimeData().hasUrls():
            event.acceptProposedAction()
        else:
            super(FileList, self).dragMoveEvent(event)

    def dropEvent(self, event):
        if event.mimeData().hasUrls():
            event.setDropAction(QtCore.Qt.MoveAction)
            self.defaultFilePath.emit(str(event.mimeData().urls()[0].toLocalFile()))
            for url in event.mimeData().urls():
                self.addItem(str(url.toLocalFile()))
        else:
            super(FileList, self).dropEvent(event)

        self.checkCount()

    def dragLeaveEvent(self,event):
        for item in self.selectedItems():
            self.takeItem(self.row(item))
        self.checkCount()

    def remove(self,item):
        self.takeItem(self.row(item))
        self.checkCount()

    def checkCount(self):
        if self.count() >= 2:
            self.enableRun.emit(True)
        else:
            self.enableRun.emit(False)

    def clear(self):
        super(FileList,self).clear()
        self.checkCount() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-14T18:45:35.410

看起来当前的行为是最佳的。

在拖放过程中会保留选择的顺序，因为没有其他方法可以恢复该信息。潜在地，这可以让用户完全控制拖动的项目在列表中的显示方式。如果他们希望它们以某种特定顺序（包括当前在文件管理器中显示的顺序），他们可以根据需要简单地选择它们。

相比之下，文件管理器使用的排序顺序很容易复制，因此尝试保留它没有什么价值。甚至不清楚这样做是否有意义。如果文件管理器在拖放操作期间或之后立即更新怎么办？“正确”的顺序应该是什么？

理想情况下，应用程序应该在将 url 加载到列表中时尝试保留用户的选择顺序，然后提供一种对其进行排序/取消排序的方法。第二好的可能是按字母顺序对其进行排序，因为这是大多数用户无论如何都希望发生的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-14T10:33:04.743

尝试在 dropEvent 中指定 QListWidget 的排序顺序。此示例将按字母升序对文件进行排序，例如：1.txt、2.txt、3.txt ...

```
 self.sortItems(QtCore.Qt.AscendingOrder) 
```

# java - 升级 tomcat 嵌入式版本后，基本登录身份验证失败

> ID：15819608
> 
> 赞同：0
> 
> 时间：2013-04-04T19:04:30.273
> 
> 标签：java, web.xml, embedded-tomcat-7

我的应用程序使用 Tomcat Embedded 公开 Web 应用程序。
它使用用户名和密码身份验证进行保护。从我的 web.xml

```
<login-config>
    <auth-method>BASIC</auth-method>
    <realm-name>BMC Application Diagnostics Portal Console</realm-name>
</login-config> 
```

我正在实现自己的领域，并在我的 Tomcat 实例中对其进行配置：

```
_tomcat.setDefaultRealm(new MyRealm()); 
```

一切正常，直到我不得不升级 tomcat 的版本（最低到 7.0.30）。升级 tomcat-embed-core.jar 和 tomcat-embed-jasper.jar 后，我无法访问我的 Web 应用程序。
身份验证窗口弹出，我插入我的用户名和密码，但它无法登录（似乎用户名\密码不正确的行为）。
我没有改变我的代码！如果我将罐子换回 7.0.22 一切正常。

顺便说一句，不推荐使用[setDefaultRealm()](http://tomcat.apache.org/tomcat-7.0-doc/api/org/apache/catalina/startup/Tomcat.html#getDefaultRealm%28%29)，我不知道它是否有帮助。

如果有人以前遇到过这个问题，或者知道如何处理这个问题，那就太好了。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T20:06:31.730

[在这里](https://issues.apache.org/bugzilla/show_bug.cgi?id=52443)找到了答案。从7.0.24版本开始，Realm应该设置为Engine，如下：

```
_tomcat.getEngine().setRealm(new MyRealm()); 
```

# c# - 列出每个用户的所有网络打印机

> ID：15819614
> 
> 赞同：1
> 
> 时间：2013-04-04T19:04:38.320
> 
> 标签：c#, wmi, .net, printers

在我的工作中，我们为每个用户安装打印机。我正在尝试编写一个备份程序，该程序将列出所有给定用户名的联网打印机。那有可能吗？通过 WMI 或 System.IO 就可以了。这是列出所有机器联网打印机的代码，但不是每个用户的代码。

```
private void Button_Click(object sender, EventArgs e)
{
        ConnectionOptions objConnection = new ConnectionOptions();

        objConnection.Impersonation = ImpersonationLevel.Impersonate;

        objConnection.EnablePrivileges = true;

         string backupselectedcomputer = "Some Computer Name"

          ManagementScope objScope = new ManagementScope("\\\\" + backupselectedcomputer     +"\\root\\cimv2",objConnection); 
         objScope.Connect();

         SelectQuery selectQuery = new SelectQuery();
         selectQuery.QueryString = "Select * from win32_Printer Where Local = FALSE";
         ManagementObjectSearcher MOS = new ManagementObjectSearcher(objScope, selectQuery);
         ManagementObjectCollection MOC = MOS.Get();

        foreach (ManagementObject mo in MOC)

        {

       //lbBackupprinters is a list box
            lbBackupprinters.Items.Add(mo["Name"].ToString().ToUpper());
         }

 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T21:37:09.103

想出了一个办法。这是遇到此问题的任何人的代码。

```
 private void ddlBackupselectuser_SelectionChangeCommitted(object sender, EventArgs e)
    {

        lbBackupprinters.Items.Clear();

        string selecteduser = ddlBackupselectuser.Text;

        string computer = ddlBackupselectcomp.Text;

        string sid;

        lblBackuppwd.Visible = true;
        txtBackuppwd.Visible = true;
        cboBackuppwdshow.Visible = true;

        //BEGIN GRAB PRINTERS FROM REGISTRY

        try
        {
            NTAccount ntuser = new NTAccount(selecteduser);
            SecurityIdentifier sID = (SecurityIdentifier)ntuser.Translate(typeof(SecurityIdentifier));
            lblBackupStatus.Text = sID.ToString();
            sid = sID.ToString();
        }

        catch (IdentityNotMappedException)
            {
                lblBackupStatus.Text = "ERROR "+ ddlBackupselectuser.Text.ToString() + " contains no profile information";

                lbBackupprinters.Items.Add("No Printers Found");

            return;

            }

                 ConnectionOptions co = new ConnectionOptions();
                 co.EnablePrivileges = true;
                 co.Impersonation = ImpersonationLevel.Impersonate;

                 System.Net.IPHostEntry h = System.Net.Dns.GetHostEntry(System.Net.Dns.GetHostName());
                 string IPAddress = h.AddressList.GetValue(0).ToString();
                 string lm = System.Net.Dns.GetHostName().ToString();

                try
                 {

                     ManagementScope myScope = new ManagementScope("\\\\" + computer + "\\root\\default", co);
                     ManagementPath mypath = new ManagementPath("StdRegProv");
                     ManagementClass wmiRegistry = new ManagementClass(myScope, mypath, null);

                    const uint HKEY_LOCAL_MACHINE = unchecked((uint)0x80000002);
                     //ManagementClass wmiRegistry = new ManagementClass("root/default",
                     //"StdRegProv",null);

                     string keyPath = @"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Print\\Providers\\Client Side Rendering Print Provider\\" + sid + "\\Printers\\Connections";
                     object[] methodArgs = new object[] { HKEY_LOCAL_MACHINE, keyPath, null };
                     uint returnValue = (uint)wmiRegistry.InvokeMethod("EnumKey", methodArgs);

                     if (null != methodArgs[2])
                     {
                         string[] subKeys = methodArgs[2] as String[];

                         if (subKeys == null)
                         {
                             lbBackupprinters.Items.Add("No Printers Found");
                             return;
                         }

                         ManagementBaseObject inParam = wmiRegistry.GetMethodParameters("GetStringValue");
                         inParam["hDefKey"] = HKEY_LOCAL_MACHINE;

                         string keyName = "";

                         foreach (string subKey in subKeys)
                         {
                             //Display application name
                             keyPath = @"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Print\\Providers\\Client Side Rendering Print Provider\\" + sid + "\\Printers\\Connections" + subKey;
                             keyName = "DisplayName";
                             inParam["sSubKeyName"] = keyPath;
                             inParam["sValueName"] = keyName;
                             ManagementBaseObject outParam = wmiRegistry.InvokeMethod("GetStringValue", inParam, null);

                                 lbBackupprinters.Items.Add(subKey);

                         }
                     }

                     else
                     {

                         lbBackupprinters.Items.Add("No Printers Found");                             

                     }
                 }
                 catch (Exception ex)
                 {
                     MessageBox.Show("Error: " + ex.Message);
                } 
```

# c# - 计算条目数？

> ID：15819620
> 
> 赞同：1
> 
> 时间：2013-04-04T19:04:58.863
> 
> 标签：c#, xml, linq

我有一个 XML 文档：

![在此处输入图像描述](https://i.stack.imgur.com/WeCYA.png)

我在这里有 XML 文档：

```
 XElement entries =
                    doc.Element("response").Element("entries"); 
```

如何计算条目中的条目数？

这个例子是 2。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T19:06:54.157

试试这个：

```
entries.Elements("entry").Count(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:08:28.087

而不是`Element()`use `Elements()`，它提供了一个`IEnumerable<>`. 然后，您可以计算条目数。使用`Count()`- 方法`IEnumerable<>`。

有关 MSDN 的参考，请参见[此处](http://msdn.microsoft.com/en-us/library/bb348975.aspx)。

# iphone - Restkit：如何从网站获取这些 JSON 值

> ID：15819624
> 
> 赞同：0
> 
> 时间：2013-04-04T19:05:17.797
> 
> 标签：iphone, ios, objective-c, xcode, restkit

我是 Restkit 的新手，基本上需要从 nsurl 网站 moo/api.com（例如 nsurl）中检索这些值。什么是最好的方法。已经声明了属性并进行了对象映射。现在需要帮助返回 nslog 中的值。该类是视图控制器。任何帮助，将不胜感激。

。H

```
@property (nonatomic, copy) NSString* ID;
@property (nonatomic, copy) NSString* Text;
@property (nonatomic, copy) NSString* author; 
```

.m

```
- (void)viewDidLoad
{
    RKObjectMapping* articleMapping = [RKObjectMapping mappingForClass:[Terms class]];
    [articleMapping addAttributeMappingsFromDictionary:@{
        @"ID": @"ID",
        @"Text": @"Text",
        @"author": @"author"
     }];
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:13:46.323

有关 RestKit 的介绍，请按照[此链接访问官方 wiki](https://github.com/RestKit/RestKit/wiki)。有几篇文章涉及[对象映射](https://github.com/RestKit/RestKit/wiki/Object-Mapping)、发布/检索数据等。

以下示例取自上述 wiki：

```
RKResponseDescriptor *responseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:articleMapping pathPattern:nil keyPath:@"__YOUR_KEYPATH__" statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];

NSURL *URL = [NSURL URLWithString:@"__YOUR_URL__"];
NSURLRequest *request = [NSURLRequest requestWithURL:URL];
RKObjectRequestOperation *objectRequestOperation = [[RKObjectRequestOperation alloc] initWithRequest:request responseDescriptors:@[ responseDescriptor ]];
[objectRequestOperation setCompletionBlockWithSuccess:^(RKObjectRequestOperation *operation, RKMappingResult *mappingResult) {
    RKLogInfo(@"Load collection of Articles: %@", mappingResult.array);
} failure:^(RKObjectRequestOperation *operation, NSError *error) {
    RKLogError(@"Operation failed with error: %@", error);
}];

[objectRequestOperation start]; 
```

# postgresql - PostgreSQL：如何定义和使用“全局”常量

> ID：15819626
> 
> 赞同：0
> 
> 时间：2013-04-04T19:05:21.547
> 
> 标签：postgresql, user-defined-types

我正在编写一些处理一些批量上传数据的存储过程。每个输入行都可以标记为各种应用程序错误。我总共有近 100 种不同类型的错误，以及十几种不同的文件加载程序。

在 C/C++ 中，错误代码的习惯用法是一堆`#define`或`const`在项目范围的包含（类）文件中，然后在应用程序代码中使用符号名称。编译器检查任意拼写。Java/C# 也提供了类似的结构。如何在 中获得类似的效果`plpgsql`？我已经在 postgresql.conf 中设置了这些，但这是一种合理的方法吗？它显然在编译时不起作用。而且我不想将 conf 文件的写入权限授予应用程序开发人员。此外，每次应用程序更改都需要重新加载 conf，这可能是系统稳定性问题。我相信还有很多其他的缺点。

同样，我还需要简单的“用户定义”类型，其中我想修复某些应用程序数据类型的表示，例如“part_number”为 varchar(20)，“currency_code”为 char (3) 等等。同样，在 C/C++ 中，人们会使用`typedef`或`struct`视情况而定。所以我尝试在 PostgreSQL 中创建一个`TYPE`跨表、视图、函数头的一致使用。但是对于 UDT，我遇到了一系列新问题：指定主键，以及在 CSV 输入规范中现在必须在括号中给出值。在 PostgreSQL 中处理这些目标有不同的方法吗？

我是 PostgreSQL 新手。我们在 Linux 上使用 9.2。我很想使用预处理器，但它不会与我见过的任何设计工具兼容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:03:52.073

对于您的第一个问题，您可能会使用[ENUM](http://www.postgresql.org/docs/9.2/static/datatype-enum.html)类型。

```
CREATE TYPE flag AS ENUM ('ok', 'bad', 'superbad'); 
```

这至少可以对每个船旗国的拼写进行完整性检查。

对于您的第二个问题*（并且请在未来提出多个问题 - 因为它使事情保持在主题上）*您可能想要查看[DOMAINs](http://www.postgresql.org/docs/8.1/static/sql-createdomain.html)

# iphone - presentViewController 需要在保持下方视图的同时通过幻灯片关闭

> ID：15819632
> 
> 赞同：1
> 
> 时间：2013-04-04T19:05:31.187
> 
> 标签：iphone, ios, objective-c

我有一个网格视图。该网格中的每个单元格都是可点击的。如果单击单元格，则必须将另一个视图控制器呈现为模态视图控制器。呈现的视图控制器必须从右向左滑入。之后，可以通过幻灯片关闭 modalviewcontroller。我如何实现这一目标？我有一些图片来展示它：

![在此处输入图像描述](https://i.stack.imgur.com/VgllV.png)

两个视图都是独立的视图控制器。

**[解决方案]**

马修的回答为我指明了正确的方向。我需要的是一个 UIPanGestureRecognizer。因为 UISwipeGestureRecognizer 只注册一次滑动，我需要视图跟随用户的手指。我做了以下事情来完成它：

如果在我的 UICollectionView 中点击了我的单元格，则需要弹出额外的视图。所以我首先实现了以下代码：

```
/* The next piece of code represents the action called when a touch event occours on
 one of the UICollectionviewCells.
 */

-(void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath {

    NSString* release_id = releases[indexPath.row][0];

    // Next boolean makes sure that only one new view can be seen. In the past, a user can click multiple cells and it allocs multiple instances of ReleaseViewController.
    if(releaseViewDismissed) {
        // Alloc UIViewController and initWithReleaseID does a request to a server to initialize some data.
        ReleaseViewController *releaseViewController = [[ReleaseViewController alloc] initWithReleaseID: release_id];
        // Create a new UIView and assign the height and width of the grid
        UIView *releaseViewHolder = [[UIView alloc] initWithFrame:CGRectMake(gridSize.width, 0, gridSize.width, gridSize.height)];
        // Add the view of the releaseViewController as a subview of the newly created view.
        [releaseViewHolder addSubview:releaseViewController.view];
        // Then add the UIView with the view of the releaseViewController to the current UIViewController's view.       
        [self.view addSubview:releaseViewHolder];
        // Place the x coordinate of the new view to the same as width of the screen. Then after that get the x to 0 with an animation. 
        [UIView animateWithDuration:0.3 animations:^{
            releaseViewHolder.frame = CGRectMake(0, 0, releaseViewHolder.frame.size.width, releaseViewHolder.frame.size.height);

             // This is important. alloc an UIPanGestureRecognizer and set the method that handles those events to handleSwipes.
            _panGestureRecognizer = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(handleSwipes:)];
            // Add the UIPanGestureRecognizer to the created view.
            [releaseViewHolder addGestureRecognizer:_panGestureRecognizer];

            releaseViewDismissed = NO;

        }];

    }

} 
```

然后我的handleSwipes如下：

```
-(void)handleSwipes:(UIPanGestureRecognizer *)sender {

    CGPoint translatedPoint = [(UIPanGestureRecognizer*)sender translationInView:self.view];
    CGPoint translation = [sender translationInView:sender.view];
    CGRect newFrame = [sender view].frame;

    [sender setTranslation:CGPointZero inView:sender.view];

    if (sender.state == UIGestureRecognizerStateChanged)
    {

        newFrame.origin.x = newFrame.origin.x + translation.x;
        // Makes sure it can't go beyond the left of the screen.
        if(newFrame.origin.x > 0) {

            [sender view].frame = newFrame;

        }

    }

    if(sender.state == UIGestureRecognizerStateEnded){

        CGRect newFrame = [sender view].frame;

        CGFloat velocityX = (0.3*[(UIPanGestureRecognizer*)sender velocityInView:self.view].x);

        // If the user swipes less then half of the screen, it has to bounce back.
        if(newFrame.origin.x < ([sender view].bounds.size.width/2)) {
            newFrame.origin.x = 0;
        }

        // If a user swipes fast, the velocity is added to the new x of the frame.
        if(newFrame.origin.x + velocityX > ([sender view].bounds.size.width/2)) {
            newFrame.origin.x = [sender view].bounds.size.width + velocityX;
            releaseViewDismissed = YES;
        }

        // Do it all with a animation.
        [UIView animateWithDuration:0.25
                         animations:^{

                            [sender view].frame = newFrame;

                         }
                         completion:^(BOOL finished){

                             if(releaseViewDismissed) {
                                 // Finally remove the new view from the superView.
                                 [[sender view] removeFromSuperview];
                             }

                         }];

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:13:32.167

我相信您需要的是以下内容：

创建另一个控制器来处理这两者之间的导航（例如 ContentViewController）。这个控制器应该有一个启用分页的 ScrollView。

如果您还不知道如何操作，这里有一个简单的教程：点击[这里](http://www.iosdevnotes.com/2011/03/uiscrollview-paging/)

单击单元格后，您必须：

1.  创建要显示的新 ViewController。
2.  启用分页并将此 ViewController 添加到 ContentViewController
3.  强制分页到这个新创建的 ViewController

此外，您必须添加一些逻辑，以便当用户滑动以更改回第一页时，分页被禁用，直到单击新单元格以重复该过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T22:53:27.173

如果您希望呈现的视图控制器从右向左滑入，则它不能是模态视图。@Juan 建议了一种实现从右到左并向后滑动的方法，但这会导致网格视图被新视图推开。如果您希望新视图在滑入时覆盖网格视图，您将需要接受模态视图的垂直滑动或编写自己的代码以从右侧滑入视图 - 后者实际上不会一切都那么困难*。

至于滑动返回，从模态呈现的视图或您自己动画的视图中执行此操作的最简单方法是使用`UISwipeGestureRecognizer`. 您创建识别器，告诉它要查找的滑动方向，并告诉它在滑动发生时调用什么方法。

*此方法的要点是创建一个`UIView`，将其添加为网格视图的子视图，并为其赋予与网格视图相同的框架但 x 位置等于视图的宽度，然后使用以下代码使视图从右侧动画化。

```
 [UIView animateWithDuration:0.3 animations:^{
        slidingView.frame = CGRectMake(0, 0, slidingView.frame.size.width, slidingView.frame.size.height);
    }]; 
```

# mysql - 将一列的结果添加到另一列

> ID：15819635
> 
> 赞同：1
> 
> 时间：2013-04-04T19:05:40.513
> 
> 标签：mysql, sql, wordpress

我需要显示两个表的内容；我的查询是这样的：

```
SELECT ID, 
    post_author, 
    post_content, 
    post_title, 
    post_name, 
    guid, 
    post_type, 
    meta_id, 
    post_id, 
    meta_key, 
    meta_value 
FROM wp_posts, 
    wp_postmeta 
WHERE wp_posts.ID = wp_postmeta.post_id 
    AND post_author IN (2); 
```

meta_key 列存储我需要的内容类型，例如网站、纬度、经度、电话、电子邮件。有没有办法让这个列爆炸到另一个列？例如：

```
ID, 
post_author, 
..., 
meta_id, 
post_id, 
meta_key, 
meta_value, 
website(its a meta_key result), 
latitude(another meta_key result), 
longitude(anoter meta_key result)... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:09:03.403

目前尚不清楚您要做什么，但我认为您需要将元键和值显示为列的标题，元值作为每列的值。在这种情况下，您可以执行以下操作：

```
SELECT  
  ID, 
  post_author, 
  post_content,   
  post_title, 
  post_name, 
  guid, 
  post_type, 
  meta_id, 
  post_id, 
  MAX(CASE WHEN meta_key = 'website'   THEN meta_value END) AS website,
  MAX(CASE WHEN meta_key = 'latitude'  THEN meta_value END) AS latitude,
  MAX(CASE WHEN meta_key = 'longitude' THEN meta_value END) AS longitude,
  ...
FROM wp_posts
INNER JOIN wp_postmeta ON wp_posts.ID = wp_postmeta.post_id
WHERE post_author IN (2)
GROUP BY Id, post_author, ... 
```

**注意事项：**

*   尽量避免`JOIN`在查询中使用的旧语法；[*这是一个坏习惯*](https://sqlblog.org/2009/10/08/bad-habits-to-kick-using-old-style-joins)，使用 ANSI-SQL-92 语法使用`JOIN`关键字而不是像我所做的那样。

*   我使用`MAX`作为一种解决方法将行转为列，您需要在`GROUP BY`子句中列出不在聚合函数中的列。

# jsr223 - Fantom 是否支持 JSR-223？

> ID：15819636
> 
> 赞同：1
> 
> 时间：2013-04-04T19:05:46.497
> 
> 标签：jsr223, javax.script, fantom

Fantom 编程语言是否直接或通过第三方实现支持 JSR-223？也就是说，可以使用 Fantom 通过“javax.script”API 编写 Java 对象的脚本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:31:07.563

如果您愿意，您可以使用[Fantom FFI](http://fantom.org/doc/docLang/JavaFFI.html)直接使用`javax.script`- 有可能，但可能取决于您的需求？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-15T17:44:58.017

刚刚意识到这个问题仍然没有公认的答案。所以，我自己来回答...

否 - Fantom 不支持 JSR-223。（截至 2015 年 5 月 15 日。）

Fantom 博客上没有进一步的评论（re [http://fantom.org/forum/topic/2127](http://fantom.org/forum/topic/2127)或其他）。就 Fantom 的实现而言，互联网上似乎没有关于“Fantom”、“javax.script”和“JSR-223”的内容。

# java - 在线程停止之前无法制作新游戏

> ID：15819637
> 
> 赞同：0
> 
> 时间：2013-04-04T19:05:54.997
> 
> 标签：java, eclipse, multithreading, game-engine

我正在构建一个游戏，我正在尝试创建“新游戏”按钮。
在游戏中我有一个延迟计算机移动的线程，所以我可以通过使用 thread.sleep 一步一步地看到它。
我的问题是在这个线程结束之前我无法制作新游戏。
如果我手动停止它，我会得到 InterruptedException。
我该怎么做才能做到这一点？

我的游戏放在 JFrame 上的 JPanel 上。
我坚持认为，如果我处理 JFrame 并创建一个新的，它将破坏 JPanel 及其所有内容并重新创建一个新的。但它也不起作用。

有什么建议么？？
提前感谢，
罗恩。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:08:09.400

要停止线程，请参阅：[https ://stackoverflow.com/a/8581317/1178781](https://stackoverflow.com/a/8581317/1178781)

如果在线程处于休眠状态时停止线程，则会引发 InterruptedException。如果您不想处理此异常，只需将 sleep 调用包装在 try...catch 中（catch 什么都不做）。

请参阅 Java API：[http://docs.oracle.com/javase/6/docs/api/java/lang/Thread.html#sleep(long)](http://docs.oracle.com/javase/6/docs/api/java/lang/Thread.html#sleep(long))

另请参阅：[如何以编程方式关闭 JFrame](https://stackoverflow.com/questions/1234912/how-to-programmatically-close-a-jframe)

# html - 有没有办法使图像中的特定颜色（白色）对网页透明？

> ID：15819638
> 
> 赞同：-1
> 
> 时间：2013-04-04T19:05:58.353
> 
> 标签：html, css, image, transparency, transparent

我希望能够使用具有以下代码的厌恶签名王国：

```
<a href="http://www.kingdomofloathing.com"><img src="http://sigs.kingdomofloathing.com/player_2192849/mode_bigsig/l1_clan/l2_clantitle/s1_level/s2_class/playerfeed_2192849_bigsig.gif" border="0" /></a> 
```

我想取图像的白色背景并使其透明。我不能在图像编辑器中执行此操作的原因是因为这些签名会根据您在游戏中所做的事情每隔一段时间更新一次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:48:00.550

**简单的答案是你不能用 CSS 和 HTML 做到这一点**。

*像 Frank Tudor 所说（通过 opacity* ）使用 CSS 为元素添加透明度将影响整个图像。

所以实际上你有三个选择：

1.  使用 Photoshop 等设计软件编辑图像，删除白色 bg 并将其保存为 trans gif 或 png。
2.  利用 CSS 不透明度，但这会使整个对象透明。如果您对此感到满意，那么这可能是最简单的解决方案。
3.  使用脚本语言。正如其他人所说，您可以使用某些脚本语言（如 PHP）在*技术上*编辑图像。这将是执行此任务的最耗时/技术性的方式（取决于您的编码技能）。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:25:40.853

在一种情况下有高级操作函数 javascript 我记得 opacity 用于透明度，在大多数服务器端编程语言中，您可以找到图像函数。

您面临的问题（没有图像编辑器）是透明度是图像保存时的参数（并且在透明度方面，某些图像类型看起来比其他图像更好）。

你可以试试这个...

尝试将 ID 或 Class 添加到您的 IMG 标签和这段代码中。

```
#IDgifThing {
  opacity: 0.5;  /* 50% transparent */
} 
```

我没有测试过它，但我希望它可以帮助你，或者至少让你的想法朝着正确的方向发展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:16:45.450

如果图像正在更新，则取决于您用于动态创建这些图像的任何代码。在创建图像时，您当然应该能够使用透明度，无论它们是如何制作的。

我推荐 PNG 而不是 GIF，但两者都可以。

发布生成签名图像的代码，有人可以帮助您更新它以使用透明背景。

# c - Wire.read 返回有符号或无符号值

> ID：15819640
> 
> 赞同：1
> 
> 时间：2013-04-04T19:06:03.157
> 
> 标签：c, types, return, arduino, i2c

我正在为 Arduino 写作，我使用[I²C](http://en.wikipedia.org/wiki/I%C2%B2C)协议。当`Wire.read()`返回一个 int 时，这个 int 是什么？它是签名的还是未签名的？

在 Arduino 官方网站上，它说它返回一个字节。所以我认为它是无符号的，因为他们没有说 sbyte 或有符号的字节。如果我读取的寄存器有用[二进制补码](http://en.wikipedia.org/wiki/Two%27s_complement)`Wire.read()`方法保存的值（有符号），怎么能理解呢？`Wire.read()`

返回值是否总是有符号的？还是取决于？

此外，通过读取和打印值，我得到负数，这意味着`wire.read()`返回一个有符号整数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T14:31:40.593

> 退货总是签名吗？

从技术上讲，是的。Wire.read() 返回一个有符号整数。但是，实际值应该是 0-255（如无符号字节），或者正如 Grijesh 所说，如果读取失败，则返回 -1。

> 如果我用 Wire.read() 读取的寄存器有用二进制补码方法保存的值（有符号），那么 Wire.read() 怎么理解呢？

我的理解是 I²C 协议发送 8 位字节。它没有任何签名或未签名的概念。如果您正在与之通信的设备发送二进制补码符号值，则可能就像将读取结果转换为`char`类型一样简单。

例如，

```
int r;
char c;
r = Wire.read();
if (r != -1) {
    c = char(r);
} 
```

请注意，在转换为 char 之前，您需要检查返回值是否为 -1。否则，您无法判断是否存在错误或读取的字节实际上是否为 -1。

# jquery - “this”如何引用 JQuery 中的 DOM 元素

> ID：15819647
> 
> 赞同：4
> 
> 时间：2013-04-04T19:06:18.810
> 
> 标签：jquery, this

```
function() {
 return this === window // true
}() 
```

```
$("h1").click(function() {
 $(this).css({"color": "red"}) // "this" becomes DOM element(s) here.
}) 
```

对于这样的回调调用，如何`JQuery`实现`this`对 from `window`to的引用？`DOM element`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:14:48.593

它是使用[`.apply`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)方法完成的。

[https://github.com/jquery/jquery/blob/1.9-stable/src/event.js](https://github.com/jquery/jquery/blob/1.9-stable/src/event.js)

```
thecallback.apply(theelement,theeventobject) 
```

以下是代码的链接：

*   [https://github.com/jquery/jquery/blob/1.9-stable/src/event.js#L262](https://github.com/jquery/jquery/blob/1.9-stable/src/event.js#L262)
*   [https://github.com/jquery/jquery/blob/1.9-stable/src/event.js#L296](https://github.com/jquery/jquery/blob/1.9-stable/src/event.js#L296)
*   [https://github.com/jquery/jquery/blob/1.9-stable/src/event.js#L301](https://github.com/jquery/jquery/blob/1.9-stable/src/event.js#L301)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T19:18:45.200

一切都与范围有关！一般来说，`this`当前作用域内绑定的对象是由当前函数的调用方式决定的，不能在执行时通过赋值来设置，每次调用函数时都可以不同。

EcmaScript 5 引入了 bind 方法来修复函数，`this`无论它是如何调用的。

当`this`关键字出现在函数内部时，其值取决于函数的调用方式。

```
function() {
   return this === window // true, "this" would be the window
}

function f2(){
    "use strict"; 
    return this;  // "this" would return undefined in  strict mode
}

var o = {
  prop: 'test',
  f: function() {
    return this.prop; // here "this" would be the object o, and this.prop
                      // would equal o.prop
  }
};

var t = o.f(); // t is now 'test' 
```

jQuery 使用`call()`and`apply()`来改变`this`特定范围内的值，这样做是这样的：

```
function add(c, d){
  return this.a + this.b + c + d;
}

var o = {a:1, b:3};

// The first parameter is the object to use as 'this', 
//subsequent parameters are passed as 
// arguments in the function call
add.call(o, 5, 7); // 1 + 3 + 5 + 7 = 16

// The first parameter is the object to use as 'this', 
// the second is an array whose members are used 
//as the arguments in the function call
add.apply(o, [10, 20]); // 1 + 3 + 10 + 20 = 34 
```

[**您可以在MDN**](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)上阅读更多关于[**`this`**](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)、[**`call()`**](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)和[**`apply()`**](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)其他内容的信息！[](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)

# c# - 连接到excel时出错

> ID：15819650
> 
> 赞同：0
> 
> 时间：2013-04-04T19:06:27.653
> 
> 标签：c#, .net, database-connection, oledb, export-to-excel

我需要以编程方式从特定路径读取 Microsoft Excel 文件。以下代码导致我以前从未见过的错误消息

```
string sConnectionString = "Provider=Microsoft.ACE.OLEDB.12.0;" + "Data Source=" + Server.MapPath("Book1.xls") + ";" + "Extended Properties=Excel 12.0 Xml;HDR=Yes"; 
        OleDbConnection con = new OleDbConnection(sConnectionString);
        con.Open(); 
```

打开连接时，显示以下错误消息：

```
Could not find installable ISAM. 
```

有人有与此错误相关的解决方案吗？我会很感激你在这方面的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:18:45.537

根据[这个问题](https://stackoverflow.com/questions/644331/open-an-excel-2003-spreadsheet-with-c-could-not-find-installable-isam-excepti)，您必须将属性括在引号中，并确保路径不包含空格。

将您的代码更改为

```
string sConnectionString = "Provider=Microsoft.ACE.OLEDB.12.0;" + "Data Source=" + Server.MapPath("Book1.xls") + ";" + "Extended Properties='Excel 12.0 Xml;HDR=Yes'"; 
```

# javascript - $.when 通话的进度

> ID：15819651
> 
> 赞同：1
> 
> 时间：2013-04-04T19:06:30.897
> 
> 标签：javascript, jquery, ajax, asynchronous

我正在尝试使用`$.when`和`$.then`函数进行一些 AJAX 调用。我正在使用这些函数来填写 a`template`等，同时，我想填写表格，我将填写一些消息，例如

> “正在加载数据..请稍候”

我发现有一个`progress`函数，但它只适用于`notify`. 我搜索了社区，发现它与`promise`通话一起使用。我并没有真正`promise`理解延迟对象在我的脚本中是如何工作的以及它是如何工作的。

这是我的脚本：

```
 $.when(e.get_info('get_utente'))
            }).then(function(data){
                 $('#username').val(data.username);
                 $('#email').val(data.email);
         }) 
```

我想在这两个电话之间插入进度。抱歉，如果有一些误解，但是直到现在我一直在使用`ASYNC : false`，在我注意到这是一个非常糟糕的主意之后，我发现了延迟对象，但我根本不明白这是逻辑

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:11:24.687

进度回调此时并不真正适用于 ajax 请求。

相反，请在`$.when`.

另外，你根本不需要`$.when`，只要做

```
$("#loading").show();
e.get_info('get_utente').done(function(data){
    $("#loading").hide();
    $('#username').val(data.username);
    $('#email').val(data.email);
}); 
```

`$.when`仅当您需要在 2 个或更多 Promise 对象完成时运行某些东西时才需要。对于单个 Promise 对象，不需要它。

# python - 如何从 python http web 服务器发送一个 html 字符串？

> ID：15819652
> 
> 赞同：4
> 
> 时间：2013-04-04T19:06:37.907
> 
> 标签：python, simplehttpserver

[我从http://www.linuxjournal.com/content/tech-tip-really-simple-http-server-python](http://www.linuxjournal.com/content/tech-tip-really-simple-http-server-python)找到了一个 python http web 服务器

```
import sys
import BaseHTTPServer
from SimpleHTTPServer import SimpleHTTPRequestHandler

HandlerClass = SimpleHTTPRequestHandler
ServerClass  = BaseHTTPServer.HTTPServer
Protocol     = "HTTP/1.0"

if sys.argv[1:]:
    port = int(sys.argv[1])
else:
    port = 8000
server_address = ('127.0.0.1', port)

HandlerClass.protocol_version = Protocol
httpd = ServerClass(server_address, HandlerClass)

sa = httpd.socket.getsockname()
print "Serving HTTP on", sa[0], "port", sa[1], "..."
httpd.serve_forever() 
```

如果目录有一个名为 index.html 的文件，则该文件将作为初始文件。如果没有 index.html，那么会列出目录中的文件。

如何修改脚本以便将自定义 html 发送到浏览器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T19:28:39.727

正如名称和文档所暗示的那样，`SimpleHTTPServer`它非常简单，旨在用作示例代码，用于在标准库的框架之上构建您自己的服务器。

所以，如果你想用它做任何事情，你可能想复制和修改[源代码](http://hg.python.org/cpython/file/2.7/Lib/SimpleHTTPServer.py)，或者只是将它作为灵感。

如果你想做一些*严肃*的事情，你可能想使用一个框架来编写真正的 HTTP 服务器，比如[`tornado`](http://tornadoweb.org)or [`twisted`](http://twistedmatrix.com)，或者只是使用一个普通的 HTTP 服务器并通过[WSGI](http://wsgi.readthedocs.org/en/latest/)将动态页面委托给 Python 。

但如果你真的想这样做，你可以。没有什么能阻止你继承`SimpleHTTPServer.SimpleHTTPRequestHandler`和覆盖它的方法。例如：

```
class MyHandler(SimpleHTTPRequestHandler):
    def send_head(self):
        if self.translate_path(self.path).endswith('/foo'):
            body = gaping_security_hole(self.path)
            self.send_response(200)
            self.send_header("Content-type", "text/html; charset=utf-8")
            self.send_header("Content-Length", str(len(body)))
            self.end_headers()
            return StringIO(body)
        else:
            return super(MyHandler, self).send_head() 
```

显然，您可以在那里检查您想要的任何内容，而不是`endswith('/foo')`. 例如，从[源代码](http://hg.python.org/cpython/file/2.7/Lib/SimpleHTTPServer.py#l68)中可以看到，默认实现会检查`os.path.isdir`，如果为真，则检查是否`endswith('/')`存在 ，以及目录是否有任何名为`index.html`or的内容`index.htm`，然后再决定要做什么。

# c++ - 带有继承类的空指针

> ID：15819653
> 
> 赞同：1
> 
> 时间：2013-04-04T19:06:39.277
> 
> 标签：c++

我有一个类，`A`它需要静态事件处理程序。我需要静态事件处理程序，因为中断正在调用事件处理程序。

```
class A {
private:
    static void (*fn1)();

public:
    A();
    static void setFn1(void (*function)(void));
    static void onEvent();
};

A::A() { }

void A::setFn1(void (*function)(void)) {
    fn1 = function;
}

void A::onEvent() {
    A::fn1();
} 
```

我想`A`基于应用程序继承并在子级中创建事件处理程序逻辑，使用`fn2`here。

```
class B : public A{
public:
    B();
    void fn2();
};

B::B() {
    A::setFn1(&fn2);
}

void B::fn2() {...} 
```

当我打电话时：`A::setFn1(&fn2)`我收到以下编译器错误。

> #169 “void (B:: )()”类型的参数与“void ( )() *”类型的参数不兼容*

我的脑子里全是这些空指针，我不知道我是否还在使用正确的设计。该类`A`包含我所有的实用方法。该类`B`包含我的应用程序特定功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:14:24.380

非静态成员函数不是自由函数，类型不同。您不能像使用指向函数的指针一样使用非静态成员函数：

```
struct test {
   void foo();
   static void bar();
};

&test::foo --> void (test::*)()
&test::bar --> void (*)() 
```

我不会像建议将功能更改为那样多，`static`因为我认为当前的设计并不是特别有用。但是你可以接受这个并尝试重新思考一个更有意义的设计。（所有进程的单个*回调函数？为什么要继承？**用户定义的*构造函数与编译器生成的相同？在不应实例化的类中？...）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T19:12:33.143

> 当我调用： A::setFn1(&fn2) 时，我收到以下编译器错误。

`fn2`是 a 的*成员函数*，`B`因此您必须限定其名称：

```
A::setFn1(&B::fn2)
//         ^^^ 
```

此外，`fn2`应该是`static`，因为非`static`成员函数实际上在隐式`this`指针上工作，所以它们接受一个参数：

```
class B : public A{
public:
    B();
    static void fn2();
//  ^^^^^^
}; 
```

通过这两个更改，您的程序应该可以编译。

# java - Java 可以读取基于 Adob e Flash 的游戏中正在发生的事情吗？

> ID：15819659
> 
> 赞同：2
> 
> 时间：2013-04-04T19:06:53.610
> 
> 标签：java, flash, automation

正如标题所述，Java 是否可以读取基于 Web 浏览器的 Flash 游戏中正在发生的事情？

例如：我是否可以通过阅读当前正在发生的事情并根据一组预先确定的操作做出决策来制作一个可以为我玩 FarmVille 的 Java 程序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T20:17:01.690

FarmVille 不发布任何类型的 API，并且您将无法访问分配给 Flash 播放器的 RAM（据我所知），因此您唯一真正的做法是分析屏幕并自动输入。换句话说，没有预先编写好的`farmville.getUnplowedCells()`程序可以使用，但是您可以编写一个程序来截取屏幕截图，分析它们以找到未耕种的细胞，然后生成鼠标/键盘输入，让您的角色耕种他未耕种的细胞。[Robot](http://docs.oracle.com/javase/7/docs/api/java/awt/Robot.html)类可用于此类编程。

这将非常耗时，并且可能不值得付出努力。同样作为副作用，这实际上会“控制”您的鼠标和键盘，并阻止您正常使用计算机。然而，这个问题可以通过在虚拟机中运行程序来缓解。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T19:22:03.560

不，没有实现比 IPC 更直接的 Java-Flash 桥接器。最好的办法是对 swf 进行反编译（这可能需要去混淆）并通过常见的 IPC 机制进行交互。

您还可以使用不同的方法通过像素颜色识别屏幕上的元素来解决此问题，因为您可以使用 Java [Robot API](http://docs.oracle.com/javase/7/docs/api/java/awt/Robot.html)，它为您提供对键盘、鼠标和视频的访问。由于 FarmVille 是一款 2D 游戏，因此识别屏幕上的元素应该相当简单——执行图像比较或部分图像比较（只是图像的边框或代表部分）以提高速度。

除此之外，在线游戏中作弊并不是一件好事，而且如果你足够聪明，可以制作出可以运行的软件，你可能会找到更有效率的活动。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-05T07:38:41.757

如果你的目标是为 FarmVille 制作一个机器人，那么你就走错了路。请记住：这是在线游戏。因此，您不必读取 Flash 客户端的状态，它会更好，读取传入的数据包，您不必在 swf 中模拟鼠标/键盘事件 - 只需创建正确的数据包，在游戏中描述行动。所以我建议你这样做：

1）用Java编写一个嗅探器（这很容易，因为您必须编写一个简单的嗅探器，而不是像Wireshark这样的终极工具）。

2) 使用请求的分析（例如Firefox 的Firebug）从你的游戏中捕获一些数据包。阅读它们，您可以检索所有信息，您需要什么：数据包标头、游戏动作编码等。

3）Java程序中的代码逻辑：读取传入的游戏数据包并执行动作，发送请求。

4）设置你的连接对象的用户代理选项，类似于流行的浏览器（如果你拒绝这样做，游戏服务器可能会忽略你的请求）。

就这样。请记住：游戏机器人不是图像识别器，它只是另一个游戏客户端，具有另一个 GUI 和逻辑。

PS如果我误解了你，你的目标是创建一个带有flash和applet的网页，它们相互通信，你必须使用JavaScript作为它们之间的中介。Flash使用ExternalInterface.call调用JS，JS调用applet，反之亦然。

# oracle - 无法更改 sqlnet.ora 运行时？

> ID：15819661
> 
> 赞同：1
> 
> 时间：2013-04-04T19:06:58.233
> 
> 标签：oracle, kerberos, oracle-call-interface

我正在尝试为我的 Oracle 数据库设置 Kerberos 身份验证，并且我需要为每个 kerberos 用户连接维护不同版本的 sqlnet.ora。我的应用程序正在使用 OCI 驱动程序（单个 unix 进程对同一个 Oracle 数据库进行多个用户连接）。而且我无法以编程方式使用 setenv(TNS_ADMIN) 调用在用户连接之间切换 sqlnet.ora。我假设一旦 sqlnet.ora 的内容被加载到进程中，它在其余生中保持不变。

我的案例实用吗，有人遇到过吗？

谈到 kerberos，我不确定为什么 Oracle 客户端将 sqlnet.ora 限制为一个主要的 kerberos 用户。也许甲骨文没有对 kerberos 的干净支持，因为我没有看到 OCI API？

谢谢斯里瓦桑

# computational-geometry - 在向量上的点垂直于向量

> ID：15819662
> 
> 赞同：0
> 
> 时间：2013-04-04T19:06:58.843
> 
> 标签：computational-geometry, normals, geometry-shader

我正在使用一个模型，我必须在连接这些点的线上的点 p3 处计算从 p1 和 p2 (3d) 到矢量的垂线。

安排会是这样的 p1--------p3------------p2​​ 。有时这个 p3 可能与 p1 或 p2 重合。

我知道如何使用点积和决定比率来计算与向量 p1-p2 的垂直向量。但是如何让它通过这一点 p3 呢？

我将在几何着色器中计算..！

有任何想法吗 .. ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:08:37.850

有几个误区：

*   向量没有位置：垂直向量在空间中没有任何位置，它只是一个方向

*   要确定法线向量，通常的方法是使用叉积，而不是点积（尽管您仍然可以使用一些代数来避免点积，例如生成随机向量并移除其切向分量）

*   您可能想要创建一个源自 p3 并且垂直于 p2-p1 的线段：在这种情况下，因为您提到您已经能够生成一个法线向量（我们称之为 V）然后绘制这样一条线会包括在 p3 放置一个顶点，在 p3+a*V 放置另一个顶点，其中“a”是任何正值，它将决定你的段的长度

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T18:58:24.230

WhitAngl 是正确的。您的向量也不受限制。有一个平面 P 通过点 p3（垂直于 p1->p2），任何包含在 P 中的向量都会满足你的条件。如果特定向量无关紧要，我使用了以下技术：

*   从 x 轴向量 (1,0,0) 开始
*   投影到平面 P
*   如果投影长度为零，则选择 y 轴向量 (0,1,0) 并重试，或 z 轴并重试

P 的平面方程可以直接从 p1 和 p2 导出（||p2-p1|| 是平面的法线，然后使用 p3 作为 P 的定义点）。

# java - 在 GCM onMessage 事件期间检查应用程序是否打开？

> ID：15819663
> 
> 赞同：10
> 
> 时间：2013-04-04T19:06:58.997
> 
> 标签：java, android, google-cloud-messaging

我想知道在收到`onMessage()`来自 GCM 的消息时如何检查我的应用程序是否已打开并且当前对用户可见。起初，我只是使用自己`boolean isVisible`的`null`. 虽然这本身可以用来查看应用程序是否打开，但看起来有点混乱。Android 中有没有办法从系统级别以某种方式检查应用程序当前是否打开，以及用户是否正在查看应用程序？请记住，应用程序在技术上可能正在运行，但不可见，因为用户最近按下了“主页”按钮将其发送到后台。

```
@Override
protected void onMessage(Context arg0, Intent arg1) {
    String turn = intent.getExtras().getString("turn");
    if (turn.equals("yours"){
         if (/*app is open*/){ <------------------ what can go here?
             // dont generate a notification
             // display something in the game instead
         }
         else{
             // generate notification telling player its their turn
         }
    }
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-11T13:12:36.880

我会使用订单广播来做到这一点。

在你的`onMessage`方法中：

```
Intent responseIntent = new Intent("com.yourpackage.GOT_PUSH");
sendOrderedBroadcast(responseIntent, null); 
```

在您的活动中：

```
public class YourActivity extends Activity {

    final BroadcastReceiver mBroadcastReceiver = new BroadcastReceiver() {

        @Override
        public void onReceive(Context context, Intent intent) {
            //Right here do what you want in your activity
            abortBroadcast();
        }
    };

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        //.....
    }

    @Override
    protected void onPause() {
        unregisterReceiver(mBroadcastReceiver);
        super.onPause();
    }

    @Override
    protected void onResume() {
        IntentFilter filter = new IntentFilter("com.yourpackage.GOT_PUSH");
        filter.setPriority(2);
        registerReceiver(mBroadcastReceiver, filter);
        super.onResume();
    }
} 
```

另一个广播接收器

```
public class SecondReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        //In this receiver just send your notification
    }

} 
```

显现：

```
<activity
    android:name=".YourActivity"
    android:label="@string/app_name">
    <intent-filter>
        <action
            android:name="android.intent.action.MAIN" />
        <category
            android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
</activity>

<receiver
    android:name=".SecondReceiver">
    <intent-filter
        android:priority="1">
        <action
            android:name="com.yourpackage.GOT_PUSH" />
    </intent-filter>
</receiver> 
```

基本上在`onMessage`你发送一个 Intent 的方法中，`YourActivity`如果它正在运行并且在前台，它首先由注册的 BroadcastReceiver 接收，否则它由`SecondReceiver`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T11:10:20.443

使用 SharedPreferences 保存布尔值 isVisible，当您从首选项中获取值时，您可以添加默认值。

```
SharedPreferences settings = context.getSharedPreferences("NAME_XXX", Activity.MODE_PRIVATE);
settings.getBoolean("visible", false); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T12:47:27.700

我总是做的是参考当前的活动。

我将每个 onResume 中的当前 Activity 设置为此，并在每个 onPause 中将其设置为 null。

如果当前 Activity 为 null，则应用未打开。如果它不为空，您可以查看正确的 Activity 是否已打开并将其传递给该 Activity。

GCMIntentService：

```
public static Activity currentActivity;
public static final Object CURRENTACTIVIYLOCK = new Object();

    @Override
protected void onHandleIntent(Intent intent) {
    synchronized(CURRENTACTIVIYLOCK) {
        if (currentActivity != null) {
            if (currentActivity.getClass() == CorrectActivity.class) {
                CorrectActivity act = (CorrectActivity)currentActivity;
                act.runOnUiThread(new Runnable() {
                    public void run() {
                        // Notifiy activity
                    }
                });
            } else {
               // show notification ?
            }
        } else {
            // show notification
        }
    }
} 
```

正确活动：

```
@Override
    protected void onResume() {
        synchronized (GCMIntentService.CURRENTACTIVITYLOCK) {
                GCMIntentService.currentActivity = this;
            }
        }
        super.onResume();
    }

@Override
    protected void onPause() {
        synchronized (GCMIntentService.CURRENTACTIVITYLOCK) {
            GCMIntentService.currentActivity = null;
        }
        super.onPause();
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-19T12:05:52.050

对我有用的东西：

创建一个最终的类常量，在其中创建静态变量：

```
public final class Constants{
public static AppCompatActivity mCurrentActivity;
} 
```

现在，在你的活动简历上说：

```
 @Override
    protected void onResume() {
        super.onResume();
        Constants.mCurrentActivity = this;
    } 
```

收到通知时，检查当前活动是否为空，如果为空，则应用程序未打开，如果活动不为空，您可以检查以下内容：

```
if(Constants.mCurrentActivity instanceof MainActivity){
   ((MainActivity) Constants.mCurrentActivity).yourPublicMethodOrStaticObject;
} 
```

# c# - 使用python通过TCP将图像发送到c#服务器

> ID：15819667
> 
> 赞同：3
> 
> 时间：2013-04-04T19:07:02.780
> 
> 标签：c#, python, image, encoding, tcp

我正在开发一个项目，该项目使用 python 脚本使用套接字将使用网络摄像头拍摄的图像发送到 ac# webserver。我目前正在使用以下代码从 python 客户端向服务器发送字符串：

```
info = bytearray("Text to send", "UTF-8")
socket.send(info) 
```

将数据发送到 c# 服务器，它非常适合文本和数字。尝试将从 .bmp 读取的数据编码为“UTF-8”时遇到问题，因为尝试此操作会返回无法将某些字符编码为 UTF-8 的错误。

我想知道是否有人对 c# 能够识别的编码方法有任何想法，或者，如果有更好的方法来尝试实现这个过程，我会全力以赴。

我想出的几个选项是 1 - 使用谷歌驱动器之类的东西将图像保存到，或 FTP 服务器，然后让 c# 服务器从那里检索它或 2 - 创建一个包含 RGB 值的数据包系统并从服务器上的这些像素值重新创建图像。

谢谢你的帮助。

**编辑：**我试过以这种方式发送文件

```
 data = bytearray("123456789","UTF-8")
 file = open("image.bmp", "rb")
 data += file.read()
 socket.send(data) 
```

并能够成功检索字符串“123456789”，但之后的数据是垃圾。我还实现了在发送数据之前发送文件的大小，并且可以很好地检索到该大小的数字，但是 img 数据保存为黑色 bmp。

**编辑 2：**

这是我用来尝试使用内存流重新创建图像的服务器和客户端代码。我的客户端代码正在使用 hcalve 提到的过程。

**客户**

```
if __name__ == "__main__":
sock = socket.socket()
sock.connect(("localhost", 50839))

with open("image.bmp", "rb") as fd:
    buf = fd.read(1024)
    while (buf):
        sock.send(buf)
        buf = fd.read(1024)
sock.close() 
```

**服务器**

```
Socket client = server.AcceptSocket();
NetworkStream stream = new NetworkStream(client);
byte[] imgData = new byte[1024];
MemoryStream memstream = new MemoryStream();
stream.Read(imgData,0, 1024);
int counter = 0;
while (stream.DataAvailable)
{
    memstream.Write(imgData, 0, 1024);
    stream.Read(imgData, 0, 1024);
    counter = counter + 1024;
}

memstream.Seek(0, SeekOrigin.Begin);

using (Stream file = File.OpenWrite("img.bmp"))
{
    byte[] buffer = new byte[8*1024];
    int len;
    while ((len = memstream.Read(buffer, 0, buffer.Length)) > 0)
    {
        file.Write(buffer,0,len);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:45:31.697

你不应该需要比这个食谱更多的东西：

```
import socket

if __name__ == "__main__":
    sock = socket.socket()
    sock.connect(("localhost", 50839))

    with open("data.bin", "rb") as fd:
        buf = fd.read(1024)
        while (buf):
            sock.send(buf)
            buf = fd.read(1024)
    sock.close() 
```

出于实际原因，您可以将`str`对象（ 的结果`fd.read`）视为原始数据，您不需要任何进一步的疯狂编码。只需迭代文件并通过套接字发送。通过运行此服务器进行测试，该服务器仅与标准输出相呼应`python server.py > data2.bin`：

```
import socket
import sys

if __name__ == "__main__":
    sock = socket.socket()
    sock.bind(("localhost", 50839))
    sock.listen(1)

    client, address = sock.accept()

    buf = client.recv(1024)
    while (buf):
        sys.stdout.write(buf)
        buf = client.recv(1024)

    client.close()
    sock.close() 
```

校验和显示二进制数据已正确发送：

```
% md5 data.bin data2.bin      
MD5 (data.bin) = 8b3280072275badf3e53a6f7aae0b8be
MD5 (data2.bin) = 8b3280072275badf3e53a6f7aae0b8be 
```

您的 C# 服务器应该能够按原样接受这些数据。如果它不起作用，那是因为您的服务器特别期待某些东西，而不仅仅是原始数据。

# c# - 在 MsAccess 数据库中的特定记录上应用运算符的有效方法

> ID：15819669
> 
> 赞同：2
> 
> 时间：2013-04-04T19:07:10.423
> 
> 标签：c#, ms-access-2007

```
 public void moveBooks(int quantityOfMovedBooks, int booksID)
    {
        int finalQuantityOfBooks = totalBooksInDB(booksID) - quantityOfMovedBooks;
        queryString = "update Books set bQuantity='" + finalQuantityOfBooks + "'where bID=" + booksID;
        myComm = new OleDbCommand(queryString, myConn);
        myConn.Open();
        myComm.ExecuteNonQuery();
        myConn.Close();
    }
    public int totalBooksInDB(int bID)
    {
        int booksQuantity;
        queryString = "select bQuantity from Books where bID=" + bID;
        myComm = new OleDbCommand(queryString, myConn);
        myConn.Open();
        booksQuantity = (int)myComm.ExecuteScalar();
        myConn.Close();
        return booksQuantity;
    } 
```

我是 MSAccess 数据库和 C# 的初学者，我在维护一个表，其中有 3 个字段，一个是 BookID，第二个是 BookName，第三个是 BookQuantity .. 范围是书籍移动到过道时的书籍应该从主要库存中减去。我正在使用这种方法..但我想知道有没有更好或更有效的方法来做到这一点..提前谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:19:04.227

几个变化。
**首先**，永远不要使用字符串连接来构建 sql 命令文本。这会导致[sql 注入](https://stackoverflow.com/questions/332365/how-does-this-sql-injection-work)攻击。一个非常严重的安全问题

**其次**，您获取书籍数量的代码可能会导致 ExecuteScalar 返回空值，因此您会收到错误消息

**第三**。连接应在需要时打开、使用，然后关闭和处置。如果由于某种原因出现异常，您的代码将无法关闭和处理连接。[using 语句](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)防止出现此问题，在出现异常时也要注意关闭和处理连接
。

**第四**，这更像是一个逻辑问题。我认为你不能移动比库存中存储的书籍更多的书，所以为了安全起见添加一张支票-

```
public void moveBooks(int quantityOfMovedBooks, int booksID)
{
    int quantity = totalBooksInDB(booksID);
    if(quantity > quantityOfMovedBooks)
    {
        int finalQuantityOfBooks = quantity - quantityOfMovedBooks;
        queryString = "update Books set bQuantity=? where bID=?";
        using ( OleDbConnection myConn = new OleDbConnection(GetConnectionString() )
        using ( OleDbCommand myComm = new OleDbCommand(queryString, myConn))
        {
            myComm.Parameters.AddWithValue("@p1", finalQuantityOfBooks);
            myComm.Parameters.AddWithValue("@p2", booksID);
            myConn.Open();
            myComm.ExecuteNonQuery();
        }
     }
     else
        MessageBox.Show("Invalid quantity to move");
}

public int totalBooksInDB(int bID)
{
    int booksQuantity = 0;
    queryString = "select bQuantity from Books where bID=?";
    using ( OleDbConnection myConn = new OleDbConnection(GetConnectionString() )
    using ( OleDbCommand myComm = new OleDbCommand(queryString, myConn))
    {
        myComm = new OleDbCommand(queryString, myConn);
        myComm.Parameters.AddWithValue("@p1", bID);
        myConn.Open();
        object result = myComm.ExecuteScalar();
        if(result != null)
            booksQuantity = Convert.ToInt32(result);
    }
    return booksQuantity;
} 
```

# jquery - 无法更改在 jquery 中具有元素的变量的值

> ID：15819670
> 
> 赞同：0
> 
> 时间：2013-04-04T19:07:10.907
> 
> 标签：jquery

我需要遍历 div 中的一些元素并使用 jQuery 更改值。这是我的代码，它似乎不起作用。请突出我的错误。

```
var f=$(".Midfeilders img:first"); // used to store 1st element in a variable ... 
```

稍后在代码中我想做的是

```
{
  f.attr("src",s);
  f=f.next() or f=f.nextSibling;
} 
```

这是错误，这似乎并没有改变 src 的值

当我做这样的事情时，

```
$(".Midfeilders img").attr("src",s); 
```

代码运行完美，但如果我使用上述方法，我无法转到下一个元素。我怀疑它似乎是问题的 f.attr("src",s) 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:10:32.773

`f.next()`不只是将 f 移动到下一个元素。它返回下一个元素。所以你需要做这样的事情：

```
f = f.next(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:15:53.290

我不完全确定您是否理解使用 jQuery 迭代元素的方式。

我将使用这个 HTML 示例 -

```
<img src="" />
<img src="" />
<p></p> 
```

还有一个[`$.each`命令](http://api.jquery.com/each/)来演示 -

```
$('img').each(function(index,elem){
  // The $(this) variable will be the relative element 
  // that the loop is currently iterating over
  $(this).attr('src',SOME_URL); 

  // on the first iteration, this variable will be the second img element.
  // on the second iteration, this variable will be the paragraph element
  var otherElement = $(this).next();
}); 
```

# java - 常见 nlp 任务的效率

> ID：15819673
> 
> 赞同：1
> 
> 时间：2013-04-04T19:07:18.363
> 
> 标签：java, python, nlp

我正在尝试制作一个大量使用 pos 标记的应用程序。但对我来说，nltk 的 pos 标记功能似乎不符合标准 - 例如：

```
import nltk
text = "Obama delivers his first speech."

sent  =  nltk.sent_tokenize(text)

loftags = []
for s in sent:
    d = nltk.word_tokenize(s)   

    print nltk.pos_tag(d) 
```

结果 ：

akshayy@ubuntu:~/summ$ python nn1.py [('Obama', 'NNP'), ('delivers', 'NNS'), ('his', 'PRP$'), ('first', ' JJ'), ('speech', 'NN'), ('.', '.')]

与斯坦福 NLP 相比，这并不好。现在，当我有足够的时间和精力投入到 Python 环境中时，转向 Java 对我来说似乎并不实际。此外，与 java 相比，我更倾向于 C，因此 Python 也更接近于未来的使用。因此第一个问题是：1) 你真的认为 Java 更适合具有大量可用工具的 nlp 任务吗？我做了很好的研究，发现 java 有更大的社区致力于 nlp 任务。

2）相反，有没有什么好的方法可以创建我自己的句子解析器，然后是 pos 标记器，以便灵活地修改将来使用的任何语言。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T08:54:34.173

您绝对应该使用基于 Java 的 POS 标记器之一。我使用的是[Stanford Core NLP](http://nlp.stanford.edu/software/corenlp.shtml)标注器，但还有其他的。NLTK 主要是一个教学工具包，不适合工业强度使用。基于 Java 的标记器也将更快。

但是，使用 Java 工具包并不妨碍您使用 Python 进行工作。在 Python 中编写一个简单地运行 Java 命令并解析结果供您在 Python 代码中使用的包装类是很简单的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-27T09:08:57.623

**Python**有非常棒的 XML/HTML 解析库，例如 Beautiful Soup[6] 和 Scrape.py[7]。您可以使用这些库快速抓取网络并生成大型数据集以提高模型的性能（因为让我们面对现实，大数据胜过复杂性）考虑您的其他选择：使用像**C++这样的编译语言没有意义/Java**用于此类工作，除非您需要提高性能（计算速度，而不是模型准确性）。据我所知，Ruby 对于任何机器学习、数据挖掘或自然语言处理任务都是完全没用的。也许你可以使用 Lisp，但在这一点上，Python 拥有更大的生态系统。在此处阅读更多信息 [http://www.quora.com/What-programming-languages-are-suitable-for-natural-language-processing](http://www.quora.com/What-programming-languages-are-suitable-for-natural-language-processing)

# javascript - 为什么使用全局变量而不是局部变量进行记忆时递归更快？

> ID：15819684
> 
> 赞同：2
> 
> 时间：2013-04-04T19:07:57.010
> 
> 标签：javascript, performance, recursion, memoization

在尝试加速递归函数时，我注意到了一些奇怪的事情。当我将用于记忆的对象作为要传递给函数的参数而不是全局变量时，代码执行变得相当慢。

所以代替这个：

```
var memoizationObj = {};
function factorial(n) {
  // factorial code
};

var a = factorial(10); 
```

我将代码更改为：

```
function factorial(n, memoizationObj) {
  // factorial code
};
var b = factorial(10, {}); 
```

代码执行速度变慢了 50 倍以上。

![jsperf](https://i.stack.imgur.com/cbR8M.png)

**为什么会这样？**这是带有完整代码的[**jsperf 。**](http://jsperf.com/recursion-with-global-obj-vs-arg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:29:46.480

原因是所有试验只调用一次 setUp，因此对于全球版本的第一次试验之后的每次试验，您都是从完整的备忘录开始的。基本上，您只计算一次该值，所有后续运行只返回一个缓存结果。

请参阅此版本以获得更好的比较，它会在每次运行全局测试时重置全局备忘录。

[http://jsperf.com/recursion-with-global-obj-vs-arg/2](http://jsperf.com/recursion-with-global-obj-vs-arg/2)

# excel-formula - 对 Excel 不同值求和

> ID：15819693
> 
> 赞同：3
> 
> 时间：2013-04-04T19:08:21.993
> 
> 标签：excel-formula, excel-2010

我知道如何使用 MySQL 来做到这一点，但我不知道如何（或者即使可能）在 MS Excel 中。我在 Windows 上运行 Excel 版本 14（Office Professional 2010 的一部分）。

我有一个包含两列的表......例如，一个包含电话号码，另一个包含整数（电话长度）。每个电话号码都有多个呼叫，因此这些号码可能会出现多次。我正在尝试对每个不同电话号码的总分钟数求和。如何在 Excel 中执行此操作？

```
-------------------------
|  number  |  duration  |
-------------------------
| 1234567  |  8         |
| 2345671  |  5         |
| 1234567  |  12        |
| 3456712  |  5         |
| 3456712  |  47        |
| 1234567  |  15        |
| 1234567  |  4         |
------------------------- 
```

所以最终的结果会是这样的：

```
-------------------------
|  number  |  duration  |
-------------------------
| 1234567  |  39        |
| 2345671  |  5         |
| 3456712  |  52        |
------------------------- 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T19:14:37.267

[以下](http://office.microsoft.com/en-us/excel-help/quick-start-create-a-pivottable-report-HA010359471.aspx)是如何使用数据透视表来实现这一点。

[我刚刚在这里](http://youtu.be/YOweH9bhr60)创建了一个 20 秒的截屏视频。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-10T15:46:33.583

在 C 列中使用 SUMIF() 函数，如下所示：

```
=SUMIF(A:A,$A2,B:B) 
```

这将给出每个电话号码的总数。我了解先前答案的好处，但是根据用户的需求，这可能是正在寻求的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:18:04.370

我会为此使用数据透视表。选择您的数据（带标题），然后单击插入功能区上的数据透视表按钮。对行标签框使用“数字”字段，对值使用“持续时间”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T19:20:32.443

我在“大纲”部分的“数据”选项卡下找到了一些名为“小计”的东西，它已经完成了。我刚刚突出显示了我的两列，然后单击“小计”，它自动创建了组小计。

# wordpress - Wordpress get_users 返回用户 ID 而不是名称

> ID：15819695
> 
> 赞同：1
> 
> 时间：2013-04-04T19:08:26.057
> 
> 标签：wordpress

我正在使用**'get_users'**生成一个数组或所有具有角色**'moderator' 的**WordPress 用户，我的代码如下所示..

```
<?php
    $args  = array(  
    'fields' => 'first_name',
    'role' => 'moderator'  
    );
    $temp = get_users($args);
?>
    <?php foreach ($temp as $i => $item): ?>
    <input type="checkbox" name="<?php $mb->the_name(); ?>" value="<?php echo $item; ?>"<?php $mb->the_checkbox_state($item); ?>/> <?php echo $item; ?><br/>
    <?php endforeach; ?> 
```

这有效，但不是返回用户的名字，而是返回用户的 ID。有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T06:50:30.920

```
<?php
    $args  = array(  
    'fields' => 'first_name',
    'role' => 'moderator'  
    );
    $temp = get_users($args);
    foreach($temp as $user) {
        echo '<li>' . $user->display_name . '</li>';
    }
?> 
```

我相信这就是你要找的。

这些是您可以使用的字段，而不是 display_name

```
[ID] => 1
[user_login] => admin
[user_pass] => $P$Bxudi6gJMk2GRt2ed3xvZ06c1BPZXi/
[user_nicename] => admin
[user_email] => admin@host.com
[user_url] => http://localhost/
[user_registered] => 2010-06-29 07:08:55
[user_activation_key] => 
[user_status] => 0
[display_name] => Richard Branson 
```

# java - 确定代码是否从单元测试运行的编程方式

> ID：15819698
> 
> 赞同：1
> 
> 时间：2013-04-04T19:08:31.577
> 
> 标签：java, unit-testing

我有生产代码和测试代码。我想知道生产代码是否从单元测试中运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:15:18.717

使用 Java 堆栈跟踪：

```
Thread.currentThread().getStackTrace() 
```

这将返回您可以检查的[StackTraceElements](http://docs.oracle.com/javase/6/docs/api/java/lang/StackTraceElement.html)数组。例如，对于您的生产代码，最后一个元素应该是具有 Java main 方法的类。而通过单元测试，您最终应该得到测试运行器的类。

例如在 Eclipse 中运行 JUnit 会导致最后一个`StackTraceElement`

```
org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:13:06.443

我假设您需要某种方式来从生产代码中判断它是否已从单元测试中调用。

我有两种可能的方法：

1.  假设代码在单个线程中运行，请使用[ThreadLocal](http://docs.oracle.com/javase/6/docs/api/java/lang/ThreadLocal.html)。

2.  使用[系统属性](http://docs.oracle.com/javase/6/docs/api/java/lang/System.html#setProperty%28java.lang.String,%20java.lang.String%29)（例如 System.setProperty("testMode", "ON")）。

无论如何，我同意 Jack Maney 的评论。在将污垢添加到您的生产代码之前，请重新考虑这一点。

# ruby - 创建并连接到套接字返回连接被拒绝 - 连接（2）

> ID：15819705
> 
> 赞同：0
> 
> 时间：2013-04-04T19:08:56.707
> 
> 标签：ruby, sockets

我有一个用 C 编写的正在运行的服务器，我需要为这个服务器创建一个 ruby​​ 客户端。服务器通过虚拟机在 ubuntu 上运行，我在 Mac OS 上工作（我不知道这是否真的重要）。

到目前为止，我在客户中拥有的是

```
myStreamSock = Socket::new( Socket::AF_INET, Socket::SOCK_STREAM, 0 )
myaddr = [Socket::AF_INET, 3333, 127, 0, 0, 1, 0, 0].pack("snCCCCNN")

myStreamSock.connect( myaddr ) 
```

这返回

```
`connect': Connection refused - connect(2) (Errno::ECONNREFUSED) 
```

这是因为服务器在 vm 上运行，还是我在这里遗漏了什么？

任何帮助真的很感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:45:55.607

我一直在使用 Ruby 进行端口扫描来执行此操作，我使用了一个非常简单的套接字连接：

```
begin
  a_sock = Socket.new(:INET,:STREAM)
  raw = Socket.sockaddr_in(port,@ip)
  port_status(port,"Open") if a_sock.connect(raw)
rescue (Errno::ECONNREFUSED) #check if the port is closed
  port_status(port,"Closed")
rescue (Errno::ETIMEDOUT)
  port_status(port,"Timed Out")
ensure
  a_sock.close if a_sock
end

def port_status(port,status)
  @ports.merge!("port_#{port}".to_sym => {status: status})
end 
```

显然，这与您尝试做的不同，但它应该给您一些想法。还有一些变量没有被明显地声明，因为这是从一个块中取出的。

这也可能对您浏览[https://thebc.ch/blog/217/ruby-of-wisdom/有用](https://thebc.ch/blog/217/ruby-of-wisdom/)

# c# - 果园：链接到内容项

> ID：15819706
> 
> 赞同：0
> 
> 时间：2013-04-04T19:08:59.247
> 
> 标签：c#, .net, content-management-system, orchardcms

我需要一些关于 Orchard 的问题的帮助。

我已经使用导航功能在页眉、侧边栏和页脚上完成了一些链接，但现在我需要将布局更改为仅在侧边栏上的 H1。

除了导航之外，还有什么方法可以做到这一点或使用一些模块/小部件来为文档（内容项）创建链接？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T22:10:16.370

[您可以使用投影仪模块](http://orchardproject.net/Tags/Projector)列出内容项（也可以作为小部件）。您也可以只添加指向 Html 小部件的链接并将其放置到任意区域和图层中。

# jquery - jquery将输入值存储到空数组元素中

> ID：15819713
> 
> 赞同：0
> 
> 时间：2013-04-04T19:09:28.167
> 
> 标签：jquery, html, arrays, forms, input

我有这个数组

```
 var foods = new Array();
    foods = [
        { id:  1, correct:'icecream', display: 'icecream',  response: ''},
        { id:  2, correct:'sundae', display: 'sundae',  response: ''},

    ]; 
```

和这个 html div

```
<div id="showfoods" class="foodlist">
    <div <input id="inputFoodChoice"class="foodinput" /></div>
        </div> 
```

这是项目的表单部分将发生的事情的 jquery 部分

```
function FoodDisplay()
    {
    var txtTrial = "";

    $("#showfoods").hide();

    txtTrial = trials[curTrial].display;

    $("#textPrompt").html(txtTrial);

    $("#showfoods").show();

    $("#inputFoodChoice").val('');
    $("#inputFoodChoice").focus();

} 
```

单词“icecream”将出现在其下方，用户将输入确切的单词icecream，然后按回车键（ltr==13）

我想要的是将人员键入的值存储到食物数组的空“响应”部分中，然后将其与食物数组中的“正确”值进行比较。取决于这个人是否正确，会弹出一条消息说你明白了！或不正确！

无论该消息出现多久，它都会以相同的方式显示“sundae”一词。

我无法存储输入值/将其与正确值进行比较。有人可以帮忙吗？

我想从某种意义上说，我希望它“编辑”foods 数组中的响应值，所以我可以获取该值并将其与输入值进行比较，或者这甚至是必要的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:50:55.157

它有助于存储用户的响应，以防您想要输出他们如何做以及他们为每个人键入的内容的摘要。

您需要一个函数来检查列表中的输入值：

```
var checkInputValue = function () {
    trials[curTrial].response = input.val();    // store user's input into response
    if (trials[curTrial].response === trials[curTrial].correct) {    // users input is equal to the correct text
        alert('Correct!');
    } else {
        alert('Incorrect!');
    }
    curTrial++;    // next trial
    showTrial();
}; 
```

我建议你隔离显示问题的逻辑，这样你就可以为每个问题调用相同的函数，我将你的代码移到了这里：

```
var curTrial = 0;
var input = $("#inputFoodChoice");
var container = $("#showfoods");
var prompt = $("#textPrompt");
var showTrial = function() {
    container.hide();
    if (curTrial < trials.length) {
        txtTrial = trials[curTrial].display;
    } else {
        alert("No more questions left.");
    }
    prompt.html(txtTrial);
    container.show();
    input.val('');
    input.focus();        
}; 
```

见小提琴：http: [//jsfiddle.net/amyamy86/jSyfy/](http://jsfiddle.net/amyamy86/jSyfy/)

我的示例使用一个按钮`click`来触发`checkInputValue()`，您可以根据需要更改它并为*enter*键附加`keydown`/`keypressed`事件。

# html - 使用 datalist 和 ajax 动态自动完成 HTML5 输入

> ID：15819715
> 
> 赞同：4
> 
> 时间：2013-04-04T19:09:36.607
> 
> 标签：html, rest, jquery

我尝试通过使用 jquery ajax 调用更新 datalist 本身来通过 datalist 更新 html 表单中的输入。在使用 ajax 的情况下，输入不会显示选项，**但是**当我再次单击输入字段时。没有 ajax 的静态测试版本确实按预期工作，在输入字段中输入时显示选项。

HTML 标记

```
<form id="formID" class="form-horizontal">
  <div class="control-group">
    <label class="control-label" for="input">Location</label>
    <div class="controls">
      <input type="text" list="LIST_CITIES" id="inputCity" 
      placeholder="Enter your location..">
    </div>
  </div>
  <!-- submit -->
  <button type="submit" class="btn">Submit</button>
</form>

<datalist id="LIST_CITIES"></datalist> 
```

没有ajax（确实有效）：

```
$('.controls').on("input click", "#inputCity", function(e) {
var val = $(this).val();

dataList.empty();

if(val === "" || val.length < 3) return;

if(testObj.results.length) {
  for(var i=0, len=testObj.results.length; i<len; i++) {
    var opt = $("<option></option>").attr("value", testObj.results[i]['city']);
    tempObj[testObj.results[i]['city']] = testObj.results[i]['id'];

    dataList.append(opt);
  }
}

  }); 
```

使用 ajax（键入时不起作用）：

```
$('.controls').on("input click", "#inputCity", function(e) {
var val = $(this).val();

dataList.empty();

if(val === "" || val.length < 3) return;

$.ajax({
  type: "GET",
  url: GET_cities,
  data: {startswith: val, maxRows: 5},
  success:function(data){
    if(data.results.length) {
      for(var i=0, len=data.results.length; i<len; i++) {
        var opt = $("<option></option>").attr("value", data.results[i]['city']);
        tempObj[data.results[i]['city']] = data.results[i]['id'];

        dataList.append(opt);
      }
    }
  }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:02:23.167

“打字时不起作用”——这是因为 ajax 是异步的。因此，当有人在输入框中输入数据时，它正在对您的服务器进行 ajax 调用，并且在响应返回之前它将无法显示输出。您仍然可以在 ajax 调用中尝试 async:false 。它会锁定浏览器，直到您的响应从服务器返回，但这不是一个好主意。

```
$.ajax({
      type: "GET",
      url: GET_cities,
      **async:false,**
      data: {startswith: val, maxRows: 5},
      success:function(data){
        if(data.results.length) {
          for(var i=0, len=data.results.length; i<len; i++) {
            var opt = $("<option></option>").attr("value", data.results[i]['city']);
            tempObj[data.results[i]['city']] = data.results[i]['id'];

            dataList.append(opt);
          }
        }
      }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-03T21:21:34.750

你需要这样做：

消除

```
var opt = $("<option></option>").attr("value", data.results[i]['city']); 
```

并替换：

```
dataList.append(opt); 
```

和：

```
dataList.append("<option value='" + data.results[i]['city'] + "'>"); 
```

并添加：

```
$.ajax({
    ...
    async:false,
    ...
}); 
```

对我来说它有效！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-28T23:22:37.220

您可能想尝试 setInterval 和 clearInterval。

例如：

```
var wait = false;
$('.controls').on("input click", "#inputCity", function() {
    var val = this.value; // All hail Vanilla JS
    dataList.empty();
    var tempObj = []; // This wasn't in your question, but I had to declare it to get rid of undefined variable errors

    if(val === "" || val.length < 3) return;
    if(wait) window.clearInterval(wait);
    wait = setInterval(function(){
        $.get(GET_cities,{startsWith:val,maxRows: 5},function(result){
            // If what you get is already an array, you can skip this line
            result = JSON.parse(result);
            if(result.results.length){
                for(var city in data.results){
                    if(data.results.hasOwnProperty(city){
                        var opt = $("<option></option>").attr("value",city['city']);
                        tempObj[city['city']] = city['id'];
                        dataList.append(opt);
                    }
                }
            }
        });
    },200); // Change 200 mili-seconds to a delay of your desire
} 
```

# jquery - 单击它所在的 div 后，如何缓慢更改 h1 的字母间距？

> ID：15819716
> 
> 赞同：2
> 
> 时间：2013-04-04T19:09:43.113
> 
> 标签：jquery, jquery-animate, boolean, overflow, letter-spacing

我有一个名为“.social”的类，一旦单击 div，我就会打开它。里面是一个 switch case 语句，因此一旦单击它，如果再次单击它，div 就会重新关闭。我只在其中显示一个字母，使用“溢出”和字母间距属性来隐藏其余字母。单击 div 后，我想展开 div，并一起减小字母间距，以便显示所有单词。

jQuery：

```
$(document).ready(function () {
var SocialClick = true;

$('.social').mousedown(function () {
    switch (SocialClick) {
        case true:
            $('.social h1').css({'letter-spacing': 'none'}, 1000);
            $(this).stop().animate({ width: '150px' }, 500);
            SocialClick = false;
            break;
        case false:
            $(this).stop().animate({ width: '50px' }, 500);
            SocialClick = true;
            break;
        }
    });
}); 
```

CSS：

```
.social {
    overflow: hidden;
    z-index: 50;
    display: block;
    float: right;
    margin-top: -52px;
    margin-right: 50px;
    width: 50px;
    height: 50px;
    background: #fff;
}

.social h1 {
    margin: 0;
    padding: 0;
    font-family: Calibri;
    font-size: 40px;
    color: #000;
    letter-spacing: 50px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:19:06.817

您需要将字母间距设置为有效值：

```
$('.social h1').css({'letter-spacing': 'normal'}, 1000); 
```

你还有什么问题吗？这是我可以从您的帖子中收集到的唯一问题。

编辑：

```
$('.social h1').animate({'letter-spacing': 'normal'}, 1000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T19:30:40.167

最简单的方法是将`letter-spacing`样式移动到`.social`div 并在那里设置动画，使用`animate`与`width`.

[JSFiddle 演示](http://jsfiddle.net/CU4cR/2/)

```
.social {
    letter-spacing: 50px;
    ...
}
...
$(this).stop().animate({ width: '150px', letterSpacing: '0px' }, 500);
...
$(this).stop().animate({ width: '50px', letterSpacing: '50px' }, 500); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:30:49.057

如果您尝试为字母间距设置动画，则适用于 jQuery 1.8.1+

```
$('.social h1').animate({'letter-spacing': '0px'}, 5000) 
```

# css - Windows Phone 8 上不显示 Font Awesome

> ID：15819717
> 
> 赞同：18
> 
> 时间：2013-04-04T19:09:43.563
> 
> 标签：css, windows-phone-8

我有一个测试站点，它使用 Font Awesome 字体来显示图标。

这些图标在我的 IE 和 Chrome 桌面以及 iPhone 和 Andriod 移动设备上都能正常显示。

但是，Nokia Lumia 920 Windows Phone 8 上没有显示字体图标。

我无法弄清楚是什么导致了问题。在诺基亚 Lumia 920 Windows Phone 上正确显示 Font Awesome 图标字体的其他网站。因此，必须有一些特定于我创建的设置的内容。

测试站点为： [http ://www-peachtreedata.azurewebsites.net/?page_id=6](http://www-peachtreedata.azurewebsites.net/?page_id=6)

任何有关如何使其在 Windows Phone 平台上工作的建议将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-09-17T15:35:29.623

在这种情况下，观察到的问题只是实际问题的症状。我自己的网站也有同样的问题。但事实证明这不是 Windows Phone 的问题，而是 IIS 7 - 8.1 为 Web 字体文件提供了错误的 MIME 类型。确保为您的字体文件提供正确的 MIME 类型，如下所示：[Proper MIME type for fonts](https://stackoverflow.com/questions/2871655/proper-mime-type-for-fonts)

此外，如果您为字体使用 Windows Azure 存储，则必须手动设置每个文件的 MIME 类型。对现有文件执行此操作的最简单方法是通过众多 Azure 存储前端编辑器之一。

高温高压

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-16T04:32:53.533

我能够使用 base64 让我的字体/图标集被 Windows Phone 8 识别。确保您使用 WOFF 和 TTF 字体，如下所示（其中***是长 base64 字符串）：

```
@font-face {
    font-family: 'icomoon-ac';
    src: url(data:application/x-font-woff;charset=utf-8;base64,***) format('woff'),
        url(data:application/x-font-ttf;charset=utf-8;base64,***) format('truetype');
    font-weight: normal;
    font-style: normal;
} 
```

**更新：**这个话题再次出现在 Hacker News 上，所以让我在这里详细说明我的原始帖子，以防它帮助其他人：1）我只尝试了 icomoon，2）我只使用了 1 种嵌入字体。

我使用 jqMobi（现在称为 Intel App Framework）来构建一个针对所有主要移动浏览器的移动网站。jqMobi 框架包含约 70 个来自 icomoon 的图标，嵌入到其 ui CSS 中。我还需要一些，所以我最初尝试通过制作另一个名为 icomoon-extra 的字体文件来扩展它，将其上传到[http://www.motobit.com/util/base64-decoder-encoder.asp](http://www.motobit.com/util/base64-decoder-encoder.asp)以生成 base64 字符串并在 jqMobi CSS 中添加另一个 @font-face。这对我不起作用，所以我只是创建了一个新的 icomoon-ac 文件，其中包括来自 jqMobi icomoon 选择的大部分原始图标，以及我需要的另外约 30 个左右的图标。现在，我只是在框架中使用我的 icomoon-ac 字体，它就可以工作了。同样，只有 1 种嵌入字体。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-05T21:07:49.380

## CSS`@font-face`在 Windows Phone IE 中不能可靠地工作。

Font Awesome 等图标字体依赖于从远程服务器加载适当的字体文件。`@font-face`显然，在 Windows Phone 上无法加载额外的字体。根据来源，这仅适用于 Windows Phone 7，甚至适用于版本 8：

*   微软[表示](http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff462082%28v=vs.105%29.aspx)网络字体在 7.1 上不起作用
*   [这个 SO 线程](https://stackoverflow.com/questions/8789295/is-it-possible-to-use-custom-fonts-using-font-face)和[另一个](https://stackoverflow.com/questions/11522480/font-face-not-working-in-internet-explorer-mobile)线程报告了 7.5 的问题，但可能暗示了可能的解决方案
*   在[这篇文章](http://blogs.msdn.com/b/thebeebs/archive/2011/12/14/font-face-isn-t-working-on-ie9-inside-of-windows-phone-7.aspx)的评论中，据说即使是 Base64 编码的字体也不能在模拟器中工作。如果我有时间，我将在真机（7.5）上进行测试。
*   即使是modernizr[也有一些问题](https://github.com/Modernizr/Modernizr/issues/538)

旁注：在我的 Windows Phone 上，microsoft.com 与 Tahoma 一起显示，这是堆栈中的第二个字体：

```
 font-family: wf_SegoeUI, Tahoma, Verdana, Arial, sans-serif; 
```

有趣的是，因为 Windows 手机[有可用的 Segoe UI 的本地副本](http://msdn.microsoft.com/en-us/library/ff806365%28v=VS.95%29.aspx)。我想知道为什么 MS 的网络人员不把第二个放在堆栈中......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-24T02:11:44.310

好的，这就是在 IIS7.5 上对我有用的方法。我不得不将 MIME 类型 .otf、.svg 和 .woff 添加到 IIS，因为它们还不存在。要添加新的 MIME 类型转到 IIS，单击`MIME types`模块，右键单击并选择`Add...`

```
 .eot -> application/vnd.ms-fontobject
    .otf -> application/font-sfnt
    .svg -> image/svg+xml
    .ttf -> application/font-sfnt
    .woff -> application/font-woff 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-24T04:49:16.997

这可能会在 8.1 更新中修复：

“从 Windows Phone 8.1 更新的 Internet Explorer 开始，Windows Phone 上的 Internet Explorer 允许跨域字体加载，而不管访问控制标头如何，以提高与现有站点的兼容性” [[1]](https://msdn.microsoft.com/en-us/library/ie/ms530757(v=vs.85).aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-04T23:35:09.363

与@flo 的答案类似，我可以确认 Windows Server 2008R2 上的 IIS7.5 中的以下 mime 类型，更正了问题：

```
 .eot -> application/octet-stream
    .otf -> application/font-sfnt
    .svg -> image/svg+xml
    .ttf -> application/octet-stream
    .woff -> application/font-woff 
```

# c# - 在运行时动态添加 C# 属性

> ID：15819720
> 
> 赞同：102
> 
> 时间：2013-04-04T19:09:48.647
> 
> 标签：c#, dynamic, reflection, properties

我知道有一些问题可以解决这个问题，但答案通常遵循推荐字典或参数集合的思路，这在我的情况下不起作用。

我正在使用一个通过反射工作的库，对具有属性的对象做很多聪明的事情。这适用于已定义的类以及动态类。我需要更进一步，并按照以下方式做一些事情：

```
public static object GetDynamicObject(Dictionary<string,object> properties) {
    var myObject = new object();
    foreach (var property in properties) {
        //This next line obviously doesn't work... 
        myObject.AddProperty(property.Key,property.Value);
    }
    return myObject;
}

public void Main() {
    var properties = new Dictionary<string,object>();
    properties.Add("Property1",aCustomClassInstance);
    properties.Add("Property2","TestString2");

    var myObject = GetDynamicObject(properties);

    //Then use them like this (or rather the plug in uses them through reflection)
    var customClass = myObject.Property1;
    var myString = myObject.Property2;

} 
```

该库适用于动态变量类型，并手动分配属性。但是我不知道会预先添加多少或哪些属性。

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2013-04-04T19:12:10.450

你看过 ExpandoObject 吗？

见：http: [//blogs.msdn.com/b/csharpfaq/archive/2009/10/01/dynamic-in-c-4-0-introducing-the-expandoobject.aspx](http://blogs.msdn.com/b/csharpfaq/archive/2009/10/01/dynamic-in-c-4-0-introducing-the-expandoobject.aspx)

来自 MSDN：

> ExpandoObject 类使您能够在运行时添加和删除其实例的成员，还可以设置和获取这些成员的值。此类支持动态绑定，这使您能够使用像 sampleObject.sampleMember 这样的标准语法，而不是像 sampleObject.GetAttribute("sampleMember") 这样的更复杂的语法。

允许您做一些很酷的事情，例如：

```
dynamic dynObject = new ExpandoObject();
dynObject.SomeDynamicProperty = "Hello!";
dynObject.SomeDynamicAction = (msg) =>
    {
        Console.WriteLine(msg);
    };

dynObject.SomeDynamicAction(dynObject.SomeDynamicProperty); 
```

* * *

根据您的实际代码，您可能对以下内容更感兴趣：

```
public static dynamic GetDynamicObject(Dictionary<string, object> properties)
{
    return new MyDynObject(properties);
}

public sealed class MyDynObject : DynamicObject
{
    private readonly Dictionary<string, object> _properties;

    public MyDynObject(Dictionary<string, object> properties)
    {
        _properties = properties;
    }

    public override IEnumerable<string> GetDynamicMemberNames()
    {
        return _properties.Keys;
    }

    public override bool TryGetMember(GetMemberBinder binder, out object result)
    {
        if (_properties.ContainsKey(binder.Name))
        {
            result = _properties[binder.Name];
            return true;
        }
        else
        {
            result = null;
            return false;
        }
    }

    public override bool TrySetMember(SetMemberBinder binder, object value)
    {
        if (_properties.ContainsKey(binder.Name))
        {
            _properties[binder.Name] = value;
            return true;
        }
        else
        {
            return false;
        }
    }
} 
```

这样你只需要：

```
var dyn = GetDynamicObject(new Dictionary<string, object>()
    {
        {"prop1", 12},
    });

Console.WriteLine(dyn.prop1);
dyn.prop1 = 150; 
```

从 DynamicObject 派生可以让您提出自己的策略来处理这些动态成员请求，**请注意这里有怪物：**编译器将**无法**验证您的大量动态调用并且您不会获得智能感知，所以只需保持记住这一点。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2013-04-05T13:24:23.993

感谢@Clint 的精彩回答：

只是想强调使用 Expando 对象解决这个问题是多么容易：

```
var dynamicObject = new ExpandoObject() as IDictionary<string, Object>;
foreach (var property in properties) {
    dynamicObject.Add(property.Key,property.Value);
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2019-10-23T19:59:55.523

您可以将您的 json 字符串反序列化为字典，然后添加新属性然后对其进行序列化。

```
var jsonString = @"{}";

var jsonDoc = JsonSerializer.Deserialize<Dictionary<string, object>>(jsonString);

jsonDoc.Add("Name", "Khurshid Ali");

Console.WriteLine(JsonSerializer.Serialize(jsonDoc)); 
```

# api - ColdFusion 10 REST API：如何让 cfthrow 返回带有 Camel Case 属性的 JSON

> ID：15819725
> 
> 赞同：1
> 
> 时间：2013-04-04T19:09:58.863
> 
> 标签：api, rest, exception, coldfusion, coldfusion-10

我正在使用 ColdFusion 10 的新 REST API。假设我抛出了这个异常：

```
<cfthrow errorcode="400" message="Validation error." type="ValidationException" /> 
```

ColdFusion 可以很好地处理异常并在响应正文中返回此 JSON：

```
{"Message":"Validation error.","Type":"ValidationException"} 
```

请注意，属性“Message”和“Type”以 Pascal Case（首字母大写）生成。为了使这与我的 API 中的其他所有内容保持一致，我需要将属性设为 Came Case（首字母小写），如下所示：

```
{"message":"Validation error.","type":"ValidationException"} 
```

知道我该怎么做吗？我正在寻找一种方法来调整 ColdFusion 生成 JSON 的方式，而无需手动执行 cfcatch 并自己生成 JSON。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T00:58:58.363

如果您将 IIS 与 ColdFusion 一起使用，这里有一种方法可以解决此问题，而无需`<cfcatch>`在每个 API 端点上使用和滚动您自己的响应（这真的很痛苦）。

我在 .NET 中编写了一个 HttpModule，它利用 IIS 的响应管道来修改 ColdFusion 返回的响应。它只会在响应 Content-Type 是`application/json`且状态码不以 a 开头`2`（即它不是成功响应）时干扰。所有代码都可以在这里找到：

[https://github.com/johnnyoshika/coldfusion-rest-post-process](https://github.com/johnnyoshika/coldfusion-rest-post-process)

以下是如何使用 HttpModule。

**1) 获取 DLL**

从此处获取`ColdFusion.RestPostProcess.dll`文件并将其放入 ColdFusion 应用程序的 bin 文件夹中：

[https://github.com/johnnyoshika/coldfusion-rest-post-process/tree/master/bin/Release](https://github.com/johnnyoshika/coldfusion-rest-post-process/tree/master/bin/Release)

例如，如果您的 ColdFusion 应用程序在这里：

```
C:/myapp 
```

然后你想把dll放在这里：

```
C:/myapp/bin/ColdFusion.RestPostProcess.dll 
```

如果您不想信任陌生人的 DLL，则需要查看源代码并自己在 Visual Studio 中编译项目以生成 DLL。

**2）修改web.config**

在应用程序的根目录中修改或创建 web.config 文件。内容应该是这样的：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.web>
        <httpModules>
            <!-- This is for IIS5, IIS6, and IIS7 Classic -->
            <add name="JsonCamelCasePropertyConverterModule" type="ColdFusion.RestPostProcess.JsonCamelCasePropertyConverterModule"/>
        </httpModules>
    </system.web>
    <system.webServer>
        <modules>
            <!-- This is for IIS7+ Integrated mode -->
            <add name="JsonCamelCasePropertyConverterModule" type="ColdFusion.RestPostProcess.JsonCamelCasePropertyConverterModule"/>
        </modules>
    </system.webServer>
</configuration> 
```

就是这样。您的错误响应现在将如下所示：

```
{"message":"Email is invalid.","type":"ValidationException"} 
```

如果你想知道我是如何创建这个 HttpModule 的，可以在这里找到源代码：

[https://github.com/johnnyoshika/coldfusion-rest-post-process/blob/master/JsonCamelCasePropertyConverterModule.cs](https://github.com/johnnyoshika/coldfusion-rest-post-process/blob/master/JsonCamelCasePropertyConverterModule.cs)

和这里：

[https://github.com/johnnyoshika/coldfusion-rest-post-process/blob/master/UTF8SanitizerStream.cs](https://github.com/johnnyoshika/coldfusion-rest-post-process/blob/master/UTF8SanitizerStream.cs)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:22:24.917

`<cfcatch>`它并返回您自己的自定义 JSON 字符串，该字符串由异常的消息和详细信息构造而成。

我不认为你可以调整它，除非你有来自 Adob​​e 的源代码。:)

# hadoop - SerDe 上的 Oozie Hive 操作失败

> ID：15819736
> 
> 赞同：1
> 
> 时间：2013-04-04T19:10:44.267
> 
> 标签：hadoop, hive, oozie

我从 oozie hive 操作工作流中得到一个错误：

```
Failing Oozie Launcher, Main class [org.apache.oozie.action.hadoop.HiveMain], 
      main() threw exception, org/apache/hadoop/hive/serde2/SerDe
      java.lang.NoClassDefFoundError: org/apache/hadoop/hive/serde2/SerDe 
```

我将 CDH4.2、HUE 2.2 和 JSON-SerDe ( [rcongiu-hive-json-serde](https://github.com/rcongiu/Hive-JSON-Serde) ) 用于我的配置单元表 SerDe。

Hive 查询脚本没问题，我在 hive 控制台中成功运行了它。我已经设置了 oozie 共享库。让我非常困惑的是，在使用默认表（不使用特殊的 SerDe）提交配置单元工作流时我没有收到任何错误，但是当我更改为我的 JSON-SerDe 表时它总是失败。ADD JAR /path-to/serde.jar 也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-10-05T07:01:39.333

我通过将我的 Serde JAR 文件放在应用程序的 lib 路径中解决了这个错误。

下面是我的 HDFS 目录结构：

```
/user/manoj/app/workflow.xml
/user/manoj/app/lib/json-serde-1.3-jar-with-dependencies.jar 
```

PS：您可能有任何版本的 serDe JAR，我`json-serde-1.3-jar-with-dependencies.jar`专门使用过，因为我在其他答案中发现该版本也支持反序列化，并且对我有用。我遇到了 hive-serde.jar 的“无法反序列化”错误。

# jquery - 如何将变量存储到存储到另一个数组中的数组中（jQuery）

> ID：15819738
> 
> 赞同：0
> 
> 时间：2013-04-04T19:11:02.623
> 
> 标签：jquery, arrays, variables

对于我正在处理的项目，有几个按钮可以打开不同的模式弹出窗口。每个窗口都有自己的复选框。

用户选中一些复选框然后关闭模态框后，复选框信息存储在一个数组中并显示在页面上。

我的问题是，当用户重新打开相同的模式弹出窗口时，我需要填写相同的复选框。我在[这里找到了一个 stackoverflow 问题。](https://stackoverflow.com/questions/5793538/use-javascript-comma-separated-variable-to-repopulate-a-forms-checkbox-values-wh)

但是我的问题是，我似乎必须创建一个唯一的变量/数组，然后将该数组放入主数组中，但我不知道该怎么做。

```
// id of the button so I can use the name to open unique popups
// and create unique variable names
var roleId = '';

// The main Array to store all my button/checkbox lists Arrays into
var storedArray = [];    

// The Array that stores the currently selected checkbox items.
var selectedArray = [];

// The function that is on all the buttons that bring up the checkbox modals
$('.role').click(function(){

    // Saves a unique ID to be used to open up the appropriate popup
    roleId = $(this).attr('tag');

    // Here I try to create a Variable for a unique Array
    storedArray.push('stored'+roleName);

    // Selects the appropriate Modal popup
    $('#modal-'+roleId).modal();
    return false;
});

// Later the function that saves the checkbox items that are selected:
    $('input:checked').each(function() {
        selectedArray.push($(this).val());
    });

// Where I try to store the checkbox data into the
// storedArray which is inside the slected Array
    storedArray.push(selectedArray);
    console.log('2 storedArray = '+storedArray); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:20:44.430

查看 SimpleModal 的文档，有一个`persist`选项。这是做你想做的吗？

```
$('#modal-'+roleId).modal({persist:true}); 
```

# .net - .NET 自动生成的 WSDL 客户端在使用 maxOccurs 属性时不处理抽象类型

> ID：15819740
> 
> 赞同：0
> 
> 时间：2013-04-04T19:11:15.830
> 
> 标签：.net, visual-studio-2010, xsd, wsdl, svcutil.exe

我有一个相当复杂的 WSDL，我将其添加为 Visual Studio 中的服务引用。我遇到的问题是自动生成的客户端代码没有正确处理抽象类型（并忽略了所有替代该抽象类型的类型）。我不想发布整个 WSDL，但这里有一个片段：

```
<complexType name="AddTextFields">
    <complexContent>
        <extension base="ti:TransformationInstructions">
            <sequence>
                <element name="textFieldList"
                    type="atf:TextFieldList" />
            </sequence>
        </extension>
    </complexContent>
</complexType>

<complexType name="TextFieldList">
    <sequence>
        <element ref="atf:TextFieldBase"
            maxOccurs="unbounded" />
    </sequence>
</complexType>

<element name="TextFieldBase" abstract="true"/>

<element name="textField" substitutionGroup="atf:TextFieldBase">
  <complexType>
    <sequence>
      ...
    </sequence>
  </complexType>
</element>

<element name="checkBox" substitutionGroup="atf:TextFieldBase">
  <complexType>
    <sequence>
      ...
    </sequence>
  </complexType>
</element> 
```

所以你可以在这里看到 TextFieldList 可以有无限的 TextFieldBase 类型的元素（可以是 textField、checkBox 和我省略的其他一些元素）。但是，在创建 WSDL 客户端时，.NET 似乎并不关心这一点，而是像这样生成 textFieldList：

```
[System.Xml.Serialization.XmlArrayAttribute(Order=0)]
    [System.Xml.Serialization.XmlArrayItemAttribute("TextFieldBase", IsNullable=false)]
    public object[] textFieldList {
        get {
            return this.textFieldListField;
        }
        set {
            this.textFieldListField = value;
            this.RaisePropertyChanged("textFieldList");
        }
    } 
```

我在 WSDL 中有一些其他抽象类型可以正常工作，并且在尝试比较它们时我发现如果我从**TextFieldList定义中删除****maxOccurs="unbounded"**属性，那么 .NET 将正确生成插入抽象类型的类型. 不幸的是，我们需要能够拥有 1 个或多个 textFieldList 元素，这样就行不通了。

 **这只是.NET 中的一个错误吗？或者是否有一些解决方法可以在不彻底改变 WSDL 的情况下工作？

我考虑的一种解决方法是将实现更改为一种选择，而不是使用抽象：

```
<complexType name="TextFieldList">
<choice maxOccurs="unbounded">
    <element ref="atf:textField" />
    <element ref="atf:checkBox" />
    <element ref="atf:radioButtonGroup" />
    <element ref="atf:listBox" />
    <element ref="atf:comboBox" /> 
</choice>
</complexType> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:18:09.067

移动 maxOccurs 属性“修复”这个问题。

```
<complexType name="TextFieldList">
    <sequence maxOccurs="unbounded">
        <element ref="atf:TextFieldBase" />
    </sequence>
</complexType> 
```**

# c - 服务器和客户端显示的不同端口号用于公共端口号

> ID：15819746
> 
> 赞同：3
> 
> 时间：2013-04-04T19:11:25.967
> 
> 标签：c, sockets

我有用 C 编写的服务器和客户端程序，它工作正常，但我无法找出下面解释的行为的原因：

**服务器.c**

```
server_address.sin_family = AF_INET;
server_address.sin_port = htons(9374);
server_address.sin_addr.s_addr = htonl(INADDR_ANY);  
server_len = sizeof(server_address);    
bind(server_sockfd, (struct sockaddr *)&server_address, server_len);

getsockname (server_sockfd, (struct sockaddr *)&server_address, &server_len);
printf("server port = %d\n", server_address.sin_port); 
printf("Server Waiting......\n");
listen(server_sockfd, 5); 
```

**客户端.c**

```
address.sin_family = AF_INET;
address.sin_port = htons(9374);

int length, result;
length = sizeof(address);

result = connect(sockfd, (struct sockaddr *)&address, length);

getsockname(sockfd, (struct sockaddr *)&address, &length);
printf("Connecting to Port = %d \n", address.sin_port); 
```

在服务器端输出：

```
[root@dhcppc1 Socket]# ./server
server port = 40484 
Server Waiting...... 
```

客户端输出：

```
[root@dhcppc1 Socket]# ./client
Connecting to Port = 18576 
```

我的问题是：

虽然`9374`在服务器和客户端代码中实现了相同的端口号（

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T19:18:40.050

getsockname() 返回连接的本地端口号。一个 TCP 连接有两个端口，一个用于连接的每一端。

由于您的客户端没有调用 bind() 来选择本地端口，因此系统为您随机选择了一个。

因此，您的服务器程序正在显示它正在侦听的自己的端口，而您的客户端显示它自己的发送端口。

另请注意，您正在以网络端格式打印端口号，要以主机端格式打印，请像这样使用 ntohs() （在客户端上类似）

```
printf("server port = %d\n", ntohs(server_address.sin_port)); 
```

这将使服务器打印出 9374

如果您想获取客户端上的服务器端口，请使用 getpeername() 而不是 getsockname() - 再说一次，您已经知道服务器端口，因为那是您连接的端口，9374。

# php - Codeigniter 分页 base_url 覆盖默认 base_url()

> ID：15819750
> 
> 赞同：0
> 
> 时间：2013-04-04T19:11:37.207
> 
> 标签：php, codeigniter

我正在使用 codeigniter 2.1 并在控制器中加载分页库。分页工作得很好，唯一的问题是，

我必须添加（用于加载它的控制器中的分页库）

```
$config['base_url'] = site_url('members/sites/'.$current_segment); 
```

这很好，但它似乎覆盖了默认的 base_url(); 到该控制器下所有页面中的此 URL。我不想要那个。

我已经包含了一个侧边栏导航，并且那里的所有链接都从类似的东西改变了

[http://www.mysite.com/about](http://www.mysite.com/about) 到 [http://www.mysite.com/members/sites/about](http://www.mysite.com/members/sites/about)

这很烦人。有什么我做错了吗？

我不想添加其他默认 URL，例如

```
$config['base_url']['one'] = "www.mysite.com"
$config['base_url']['two'] = "www.myothersite.com" 
```

我认为应该有更好的方法来做到这一点。非常感谢任何帮助:) 提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:52:35.453

好的，我明白了：）

我正在创建我的链接，例如“>所有站点

现在我想，为什么它会起作用？？？这就是为什么我无法弄清楚..它不应该起作用:)

我没有回显 base_url()，所以它相对于我在问题中提到的 url 发生了变化（这也很奇怪）

但是，我的问题通过键入解决了

" >所有网站

感谢大家看到这个问题希望对某人有所帮助...

# r - 绘制带有填充点符号和图例的函数

> ID：15819762
> 
> 赞同：29
> 
> 时间：2013-04-04T19:12:12.180
> 
> 标签：r, plot, legend

我想用**普通的 R**绘制两个具有不同颜色和点样式的函数以及相应的图例。

我有几个问题：

1.  我正在使用`pch=21`和`pch=22`。我的理解是它们是“充满”的符号。它们确实在图例中显示为填充，但在图表本身上显示为空心。怎么了？

2.  我可以在不手动指定网格的情况下在点之间获得更多空间吗？也许通过选择要打印的点数？

3.  随意添加您想要的任何建议。我对 R 很陌生。特别是，有没有更好的方法来绘制两个函数？例如通过定义函数向量？并且没有一种方法可以自动生成图例而无需在普通 R 中指定颜色和形状？

这是我的代码：

```
par(new=TRUE)
p1 <- plot(function(x){ x^(2)/2 }
       , 0, 100
       , xlab = "x"
       , ylab = "y"
       , ylim = c(0,5000)
       , las = 1
       , type = "p"
       , cex = 0.8
       , pch = 21
       , col = "red"
)
par(new=TRUE)
p2 <- plot(function(x){ (1-x^(2))/2 }
       , 0, 100
       , xlab = ""
       , ylab = ""
       , axes = FALSE
       , type = "p"
       , cex = 0.8
       , pch = 22
       , col = "blue"
)
par(new=TRUE)
l <- legend( "topleft"
         , inset = c(0,0.4) 
         , cex = 1.5
         , bty = "n"
         , legend = c("A", "B")
         , text.col = c("red", "blue")
         , pt.bg = c("red","blue")
         , pch = c(21,22)
) 
```

经过各种探索，我选择了使用`par(new=TRUE)`“技巧”来叠加这两个功能（而不是说，使用 matplot 或 plot 和 points 或 layout 的组合）。这是一个糟糕的举动吗？（编辑：是的，非常糟糕，见下文）+1 如果您不要求我阅读手册 ;-)

![在此处输入图像描述](https://i.stack.imgur.com/ZqVxt.png)

**编辑：解决方案摘要**

感谢 joran 和 Didzis Elferts，我找到了解决我的几个问题的方法。为了记录，我想在这里总结一下：

1.  要在图表上获得填充符号，您需要同时指定 col（颜色）和 bg（背景）。即使对于`pch=21`和也是如此`pch=22`，它不会自动被指定的颜色填充。要在图例中获得填充符号，您需要同时指定 col 和 pt.bg。在这里，仅 bg 是不够的。

2.  `par(new=TRUE)`正如我最初所做的那样，使用with是一个非常糟糕的主意`axes=FALSE`，因为重叠的图不一定使用相同的坐标系。第二个情节的预期功能是，`(100^2-x^2)/2`但我无意中写了`(1-x^2)/2`并没有意识到，因为我设置了axes = FALSE。

总而言之，这是我的首选解决方案：

```
curve( x^2/2
  , from = 0
  , to = 100
  , n = 30
  , type = "p"
  , pch = 21 # alternatively pch=15 is a solid symbol
  , col = "red" # colors the outline of hollow symbol pch=21
  , bg = "red" # fills hollow symbol pch=21 with color
  , xlab = "x"
  , ylab = "y"
)
curve( (100^2-x^2)/2
  , from = 0
  , to = 100
  , n = 30
  , type = "p"
  , pch = 22  # alternative pch=16
  , col = "blue"
  , bg = "blue"
  , add = TRUE
)
legend( "topleft"
  , inset = c(0,0.4), 
  , cex = 1.5, 
  , bty = "n", 
  , legend = c("A", "B"), 
  , text.col = c("red", "blue"),
  , col = c("red", "blue"), 
  , pt.bg = c("red","blue")
  , pch = c(21,22)
) 
```

这产生了一个类似于 joran 所示的情节。非常感谢你们俩的帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-04T19:34:26.497

我想也许你会更好地使用`curve`：

```
curve(x^(2) / 2,from = 0,to = 100,col = 'red',type = 'p',pch = 16,n = 20)
curve((1-x^(2))/2 + 5000,from = 0,to = 100,col = 'blue',type = 'p',pch = 15,add = TRUE,n = 20)
legend("topleft", 
        inset = c(0,0.4), 
        cex = 1.5, 
        bty = "n", 
        legend = c("A", "B"), 
        text.col = c("red", "blue"),
        col = c("red", "blue"), 
        pch = c(16,15)) 
```

![在此处输入图像描述](https://i.stack.imgur.com/lGFUm.png)

请注意，我必须稍微调整您的功能，以获得与您的图像匹配的输出。

为了避免单独指定颜色和填充（这通常是 R 中的处理方式），我使用了一些较旧的“遗留”符号。对于绘制函数或表达式，使用`curve`通常要简单得多。它还为您提供了一种更方便的方法来指定要评估的点网格。它还有一个`add`论点，可以让你跳过`par`你参与的尴尬黑客攻击。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-04T19:25:11.647

您应该添加参数`bg="red"`或`bg="blue"`内部`plot()`以获取具有特定颜色的填充符号。

# vba - 将 MailItem 移动到指定文件夹

> ID：15819769
> 
> 赞同：0
> 
> 时间：2013-04-04T19:12:35.090
> 
> 标签：vba, outlook

有人可以帮我解决我试图在 VBA 中实现的这个小脚本吗？

附加的是循环随机停止，我无法移动“存档”文件夹中的所有邮件。

```
Private Sub aggiorna_click()

    Dim x As Object
    Dim ns As Outlook.NameSpace
    Dim itm, sgsa, actionPlan, cartella, specCartella As Object
    Dim olDestFolder As Outlook.MAPIFolder

    Set ns = GetNamespace("MAPI")
    Set itm = ns.GetDefaultFolder(olFolderInbox)
    Set sgsa = itm.Folders("SGSA")
    Set actionPlan = sgsa.Folders("action plan")
    Set cartella = actionPlan.Folders(tipo.Text)
    Set specCartella = cartella.Folders(piano.Text)

Set olDestFolder = itm.Folders("archivio")
For Each x In specCartella.Items
    x.Move olDestFolder
Next x

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:25:16.820

根据问题下的评论，新循环可能看起来像这样**（未经测试）**

```
Dim i As Long
For i = specCartella.Items.Count to 1 Step -1
    specCartella.Items(i).Move olDestFolder
Next i 
```

（我刚刚用 i 改变了 x！）

# php - HTML/Javascript/PHP 国家和地区列表

> ID：15819772
> 
> 赞同：0
> 
> 时间：2013-04-04T19:12:51.133
> 
> 标签：php, javascript, html, state, country

我有一个脚本获取用户选择的国家/地区，然后将相应的状态放入状态框中。

这是我的 Javascript 代码：

```
<script type="text/javascript" src="jquery-1.9.1.min.js">
</script>

<script type="text/javascript">
$(document).ready(function () {
$("#theselect").change(function() {
var option = $(this).val();
        $.get("select.php", {select:option},function(data){
            $("#theresult").html(data).hide().fadeIn(1000);
        });
    });
});
</script> 
```

这是正文中的 HTML 代码：

```
<select name="theselect" id="theselect">
<option value="">Select</option>
<option value="submit_ind">Submit Individual Need</option>
<option value="submit_org">Submit Organization Need</option>
<option value="missionary">Submit Missionary Need</option> 
```

这是 select.php 脚本，它给出了选择每个选项时要显示的信息：

```
echo "<script type= 'text/javascript' src = 'http://www.1511project.com/countries.js'></script>
";

***The other options are usually here but due to character restraints I had to delete to rest of it.  So I do have an original If statement and 2 other elseif statement***    

elseif($_GET['select'] == 'missionary') {

echo "<script>print_country('country');</script>";

?>
<script>

function limitText(limitField, limitCount, limitNum) {
    if (limitField.value.length > limitNum) {
        limitField.value = limitField.value.substring(0, limitNum);
    } else {
        limitCount.value = limitNum - limitField.value.length;
    }
}

function validateForm()
{
var x=document.forms["myForm"]["firstname"].value;
if (x==null || x=="")
  {
  alert("First name must be filled out");
  return false;
  }

var r=document.forms["myForm"]["titleofneed"].value;
if (r==null || r=="")
  {
  alert("Title of need must be filled out");
  return false;
  }

var s=document.forms["myForm"]["country"].value;
if (s==null || s=="")
  {
  alert("Country must be filled out");
  return false;
  }

var u=document.forms["myForm"]["phone"].value;

var b=document.forms["myForm"]["email"].value;
if ((b==null || b=="") && (u==null || u==""))
  {
  alert("Email or Phone must be provided for contact information.");
  return false;
  }

var c=document.forms["myForm"]["city"].value;
if (c==null || c=="")
  {
  alert("City must be filled out");
  return false;
  }

var d=document.forms["myForm"]["state"].value;
if (d==null || d=="")
  {
  alert("State must be filled out");
  return false;
  }

var h=document.forms["myForm"]["recurring"].value;
if (h==null || h=="")
  {
  alert("Recurring need must be filled out");
  return false;
  }

var j=document.forms["myForm"]["typeofneed"].value;
if (j==null || j=="")
  {
  alert("Type of need must be filled out");
  return false;
  }

}
</script>

<p>Please enter the information below for the CONTACT PERSON of the need you are submitting.<br /><br /></p>
<form action="processneedmiss.php" name="myForm" method="post" onsubmit="return validateForm();">
<p>First Name: <input type="text" name="firstname" /></p>
<p>Phone #: <input type="text" name="phone" /> <img src='http://www.aotees.com/images/questionMarkIcon_SMALL.jpg' alt='Must provide phone number OR email.  Providing both is recommended.' title='Must provide phone number OR email.  Providing both is recommended.' height='15' width='15'></p>
<p>Email: <input type="text" name="email" /> <img src='http://www.aotees.com/images/questionMarkIcon_SMALL.jpg' alt='Must provide phone number OR email.  Providing both is recommended.' title='Must provide phone number OR email.  Providing both is recommended.' height='15' width='15'></p>

<p>Country: <select onchange="print_state('state',this.selectedIndex);" id="country" name = "country"></select></p>

<p>District/State: <select name ="state" id = "state"></select></p>

<p>City: <input type="text" name="city" /></p>
<p>Title of Need: <input type="text" name="titleofneed" /> <img src='http://www.aotees.com/images/questionMarkIcon_SMALL.jpg' alt='Type a short title to organize your needs.' title='Type a short title to organize your needs.' height='15' width='15'></p>
<p>Type of Need: <select name="typeofneed"> <option></option><option>Supplies</option><option>Lawn Care</option> <option>Heavy Lifting</option><option>Event Volunteering</option><option>Home Repair</option> <option>Clean Up</option> <option>Other</option></select></p>
<p>Recurring Need:
<select name='recurring' size='1'>
<option value=''></option>
<option>No</option>
<option>Yes</option>
</select> <img src='http://www.aotees.com/images/questionMarkIcon_SMALL.jpg' alt='If need happens on a regular basis, select Yes' title='If need happens on a regular basis, select Yes.' height='15' width='15'>
</p>
<p>
How many people are needed: <input type="number" name="howmanypeople" /> <img src='http://www.aotees.com/images/questionMarkIcon_SMALL.jpg' alt='If you want the need to be taken down after a certain number of people sign up for the need, enter that number here. If you only want 1 person leave this blank.' title='If you want the need to be taken down after a certain number of people sign up for the need, enter that number here. If you only want 1 person leave this blank.' height='15' width='15'> 
</p>
<p>Expiration Date: (If no expiration date leave blank.)
<br>
Month: 
        <select name='month' size='1'>
    <option value='0'></option>
    <option value='1'>1</option>
    <option value='2'>2</option>
    <option value='3'>3</option>
    <option value='4'>4</option>
    <option value='5'>5</option>
    <option value='6'>6</option>
    <option value='7'>7</option>
    <option value='8'>8</option>
    <option value='9'>9</option>
    <option value='10'>10</option>
<option value='11'>11</option>
<option value='12'>12</option>
</select>
  Day:
<select name='day' size='1'>
    <option value='0'></option>
    <option value='1'>1</option>
    <option value='2'>2</option>
    <option value='3'>3</option>
    <option value='4'>4</option>
    <option value='5'>5</option>
    <option value='6'>6</option>
    <option value='7'>7</option>
    <option value='8'>8</option>
    <option value='9'>9</option>
    <option value='10'>10</option>
<option value='11'>11</option>
<option value='12'>12</option>
<option value='13'>13</option>
<option value='14'>14</option>
<option value='15'>15</option>
<option value='16'>16</option>
<option value='17'>17</option>
<option value='18'>18</option>
<option value='19'>19</option>
<option value='20'>20</option>
<option value='21'>21</option>
<option value='22'>22</option>
<option value='23'>23</option>
<option value='24'>24</option>
<option value='25'>25</option>
<option value='26'>26</option>
<option value='27'>27</option>
<option value='28'>28</option>
<option value='29'>29</option>
<option value='30'>30</option>
<option value='31'>31</option>
</select>
  Year:
<select name='year' size='1'>
    <option value='0'></option>
    <option value='2012'>2012</option>
    <option value='2013'>2013</option>
    <option value='2014'>2014</option>
    <option value='2015'>2015</option>
    <option value='2016'>2016</option>
    <option value='2017'>2017</option>
    <option value='2018'>2018</option>
    <option value='2019'>2019</option>
    <option value='2020'>2020</option>
    <option value='2021'>2021</option>
    <option value='2022'>2022</option>
    <option value='2023'>2023</option>
    <option value='2024'>2024</option>
    <option value='2025'>2025</option>
    <option value='2026'>2026</option>
    <option value='2027'>2027</option>
    <option value='2028'>2028</option>
</select>
</p>
<p>Description of Need: <br>(Do not include sensitive information you don't want others seeing on the website.)<br /><textarea name="description" onKeyDown="limitText(this.form.description,this.form.countdown,850);" 
onKeyUp="limitText(this.form.description,this.form.countdown,850);" style="margin: 2px; width: 494px; height: 164px;"></textarea><br><font size="1">(Maximum characters: 850)<br>
You have <input readonly type="text" name="countdown" size="4" value="850"> characters left.</font></p>
<p><input type="submit" value="Submit" /></p>
</form>
<?php
}
?> 
```

我遇到的问题是，当人们第一次选择“传教士”选项时，它不会显示传教士表格。但是，如果我先选择另一种形式，然后选择传教士选项，它将显示并正常工作。或者，如果我先选择另一种形式，那么传教士的选择就会起作用。但是如果我先选择“传教士”就不行了。

我已经在“传教士”形式的这段代码中找到了问题的根源：

```
<script>print_country('country');</script> 
```

如果该代码在表单中的任何位置，则表单不会第一次弹出。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:25:53.813

`countries.js`当您返回非“传教士”案件时，您似乎只将图书馆包含在您的页面上。确保你在你里面包含那个文件`elseif`：

```
elseif($_GET['select'] == 'missionary') {

    echo "<script type= 'text/javascript' src = 'http://www.1511project.com/countries.js'></script>";
    echo "<script>print_country('country');</script>";

} 
```

编辑：为什么你甚至在你的 AJAX 返回中包含那个 js 文件，而不是总是在你的父页面中。这样它就可以在需要时随时使用。它不会在原始页面加载上提供太多开销，但作为 AJAX 返回的一部分会导致问题。

# nlog - 基于一天中的时间的 NLog 过滤器

> ID：15819775
> 
> 赞同：1
> 
> 时间：2013-04-04T19:13:00.493
> 
> 标签：nlog

我正在尝试使用 NLog[条件](http://nlog-project.org/wiki/Conditions)来过滤在特定时间未生成的消息

以下是我的样本

```
<logger name="*" minlevel="Info" writeTo="InfoMail" >
  <when condition="starts-with('${date:format=hh}', '01')" action="Ignore"/>
</logger> 
```

但是，Nlog 似乎无法接收“${date:format=hh}”，即使消息是在 1 点生成的，我仍然会收到电子邮件。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:33:53.093

`when`条件应放​​在`filters`元素内，如条件 - 示例中所示并[在](http://nlog-project.org/wiki/Conditions)NLog.xsd 中指定[（](http://nlog-project.org/schemas/NLog.xsd)[当过滤器](http://nlog-project.org/wiki/When_filter)页面上的语法错误）

所以正确的用法是：

```
<logger name="*" minlevel="Info" writeTo="Console" >
  <filters>
    <when condition="starts-with('${date:format=hh}', '01')" action="Ignore"/>
  </filters>
</logger> 
```

# ruby-on-rails - Articles#index 中的 NoMethodError 未定义方法 `is_admin' for nil:NilClass

> ID：15819780
> 
> 赞同：1
> 
> 时间：2013-04-04T19:13:11.177
> 
> 标签：ruby-on-rails, ruby, devise, admin

我正在尝试在诸如“编辑”和“删除”按钮之类的视图中实现某些条件，只有当当前用户是我的应用程序的管理员时才应该可见。当我在我的文章/index.html.erb 页面中尝试 <% if current_user.is_admin %> 时，我得到未定义的方法“is_admin”错误。

我不能在文章索引页面中使用 current_user 设计方法来获取用户吗？请建议我如何获取用户，然后检查用户是否是管理员。

我的代码文件如下：

文章/index.html.erb

```
<%- model_class = Article -%>
<div class="">
  <h1><%=t '.title', :default => model_class.model_name.human.pluralize %></h1>
</div>

<div style="border: 1px solid #1763A4;border-radius: 4px 4px 4px 4px;margin: 0 0 20px; padding: 20px 20px 10px;">

    <% @articles.each do |article| %>
    <div style="border: 1px solid #51702E;border-radius: 4px 4px 4px 4px;margin: 0 0 20px; padding: 20px 20px 10px;">
       <div style="color:#51702E"><h2><%= article.title %></h2></div>
       <div style="color:#666666"> <%= article.created_at %></div> 
       <% if current_user.is_admin %> 
       <div> <%= truncate(article.body, :length => 500, :separator => ' ') %></div>  
     <%= link_to "edit",edit_article_path(article), :class => 'btn btn-warning btn' %>
     <%= link_to "delete",article_path(article),:method => :delete,:confirm => 'Are you sure?',:class => 'btn  btn-danger' %>
     <% end %>
     <%= link_to "VIEW MORE...",article_path(article), :class => 'btn btn-primary' %> 
     </li>
     </div>
    <% end %>
<%= link_to "Create new Article", new_article_path, :class => 'btn btn-large btn-primary' %> 
```

文章控制器.rb

```
class ArticlesController < ApplicationController
    def index
        @articles = Article.all
    end

    def show
      @article = Article.find(params[:id])
    end

    def new
      @article = Article.new
    end

    def create
      @article = Article.new(params[:article])

      @article.save
      redirect_to article_path(@article)
    end

    def destroy
      @article = Article.find(params[:id])
      @article.destroy
      redirect_to action:  'index'  
    end

    def edit
      @article = Article.find(params[:id])
    end

    def update
      @article = Article.find(params[:id])
      @article.update_attributes(params[:article])
      flash.notice = "Article '#{@article.title}' Updated!"
      redirect_to article_path(@article)
     end
end 
```

型号：article.rb

```
class Article < ActiveRecord::Base
   attr_accessible :title, :body
   has_many :comments
   belongs_to :user
end 
```

用户.rb

```
class User < ActiveRecord::Base
    has_many :articles
    has_many :comments
  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :username, :email, :password, :password_confirmation, :remember_me
   attr_accessible :title, :body
end 
```

用户表

```
 create_table "users", :force => true do |t|
    t.string   "email",                  :default => "", :null => false
    t.string   "encrypted_password",     :default => "", :null => false
    t.string   "reset_password_token"
    t.datetime "reset_password_sent_at"
    t.datetime "remember_created_at"
    t.integer  "sign_in_count",          :default => 0
    t.datetime "current_sign_in_at"
    t.datetime "last_sign_in_at"
    t.string   "current_sign_in_ip"
    t.string   "last_sign_in_ip"
    t.boolean  "is_admin"
    t.boolean  "is_active"
    t.datetime "created_at",                             :null => false
    t.datetime "updated_at",                             :null => false
    t.string   "username"
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:28:07.740

来自[https://github.com/plataformatec/devise/wiki/How-To:-Add-an-Admin-role](https://github.com/plataformatec/devise/wiki/How-To:-Add-an-Admin-role)

> 如果页面可能没有设置 current_user 则：

```
if current_user.try(:admin?)
  # do something
end 
```

或者在你的情况下

```
if current_user.try(:is_admin)
  # do something
end 
```

当没有当前用户（即未登录）时，这应该可以工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:23:53.847

您的 User 模型是否具有 admin 属性？

如果不需要定义一个，例如

```
class AddAdminToUsers < ActiveRecord::Migration
  def self.up
    add_column :users, :admin, :boolean, :default => false
  end

 def self.down
   remove_column :users, :admin
 end
end 
```

然后运行 ​​rake db:migrate

然后，您应该能够通过调用来检查用户是否是管理员：

```
current_user.admin? 
```

在设计中还有其他选项可以执行此操作，请在此处查看

[https://github.com/plataformatec/devise/wiki/How-To:-Add-an-Admin-role](https://github.com/plataformatec/devise/wiki/How-To:-Add-an-Admin-role)

# asp.net-mvc - ASP MVC3 - 编辑器模板在回发时将空值返回给控制器

> ID：15819785
> 
> 赞同：0
> 
> 时间：2013-04-04T19:13:39.833
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2, mvc-editor-templates, icollection

几天来，我一直在为一个项目苦苦挣扎，在我当前的迭代中，我决定使用编辑器模板。

最初的问题源于通过 SQL 中的外键链接到辅助表的主表。在 ASP MVC 中，辅助表由以下字段表示：

```
 [UIHint("BankListAgentId")]
    public virtual ICollection<BankListAgentId> BankListAgentId { get; set; } 
```

因为这是一个集合对象，`GET`所以“编辑”页面上的“编辑”页面适用于每个特定项目，但是在`POSTBACK`所有集合项目上突然都为空。但是，所有其他字段都带有正确的数据。我正在尝试使用和编辑器模板，但是仍在返回集合项`null`。

这是我在视图中使用的代码

```
@model Monet.Models.BankListMaster
@using (Html.BeginForm())
{
    <fieldset>
        <legend>Stat(s) Fixed</legend>
        <table id="fixedRows">
            <tr>
                <th>State Code</th>
                <th>Agent ID</th>
                <th></th>
            </tr>

            @foreach (var item in Model.BankListAgentId)
            {                    

                if (!String.IsNullOrWhiteSpace(item.AgentId) && item.FixedOrVariable.Equals("Fixed"))
                {
                    @Html.EditorFor(model => item)                     

                }
            }
        </table>
        <br />
        @Html.ActionLink("Add another", "BlankFixedRow", null, null, new { id = "addFixed" })
    </fieldset>
} 
```

这是编辑器模板。它的名称位于Views 文件夹 `BankListAgentId`中的一个文件夹中`EditorTemplates`![在此处输入图像描述](https://i.stack.imgur.com/YhHtv.png)

```
@model Monet.Models.BankListAgentId

    <tr id="item-@Model.AgentId">
        <td>
            @Html.DropDownListFor(model => model.StateCode,
                (SelectList)ViewBag.StateCodeList, Model.StateCode)
        </td>
        <td>
            @Html.EditorFor(model => model.AgentId)
            @Html.ValidationMessageFor(model => model.AgentId)
        </td>
        <td>
            <a href="#" class="deleteRow">delete</a>
        </td>
        @*<td><a href="#" onclick="$('#item-@Model.AgentId').parent().remove();" style="float:right;">Delete</a></td>*@
    </tr> 
```

这是`BankListMaster`模型中的代码

```
public partial class BankListMaster
{
    public BankListMaster()
    {
        this.BankListStateCode = new HashSet<BankListStateCode>();
        this.BankListAgentId = new HashSet<BankListAgentId>();
        this.BankListAttachments = new HashSet<BankListAttachments>();
    }

    public int ID { get; set; }
    public string BankName { get; set; }

    public virtual ICollection<BankListStateCode> BankListStateCode { get; set; }
    public virtual ICollection<BankListAttachments> BankListAttachments { get; set; }

    [UIHint("BankListAgentId")]
    public virtual ICollection<BankListAgentId> BankListAgentId { get; set; }
} 
```

最后是`BankListAgentId`模型

```
public partial class BankListAgentId
{
    public string AgentId { get; set; }
    public int ID { get; set; }
    public string FixedOrVariable { get; set; }
    public string StateCode { get; set; }

    public virtual BankListMaster BankListMaster { get; set; }
} 
```

编辑

用户将需要能够动态更改列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:25:51.990

我认为您需要将此作为对集合的迭代而不是 foreach，以便正确绑定字段名称。

```
@for (int i = 0; i < Model.BankListAgentId.Count; i++)
            {                    
                if (!String.IsNullOrWhiteSpace(Model.BankListAgentId[i].AgentId) && Model.BankListAgentId[i].FixedOrVariable.Equals("Fixed"))
                {
                    @Html.EditorFor(model => Model.BankListAgentId[i])
                }
            } 
```

您也应该发布您收到的 ActionResult。

PS 但正如 DaveA 正确指出的那样，模型是 ICollection，这会导致问题。它不能是 IEnumerable 吗？

# asp.net - 在 VS2012 中将 MSBuild 版本添加到 ASP.NET Web 项目

> ID：15819790
> 
> 赞同：0
> 
> 时间：2013-04-04T19:13:53.797
> 
> 标签：asp.net, msbuild, webforms, versioning, cache-control

我正在 Visual Studio 2012 中的 ASP.NET Web 窗体（对我来说是双重耻辱）项目中开发网站解决方案（不是我感到羞耻的 Web 应用程序）。我想在每个版本上都有一个自动增量版本，这样我就可以在我的代码中检索它并用于静态文件版本控制（主要是 css 和 js）以避免它。

我想要获得的是像 /mydir/mystyle.css?v=buildversionhere 这样的链接

我找到了一个很好的代码来检索版本：

```
Dim web As Assembly = Assembly.GetExecutingAssembly()
Dim webName As AssemblyName = web.GetName()
Dim myVersion As String = webName.Version.ToString() 
```

它有效，问题是我总是得到 0.0.0.0。我需要知道的是如何在每个网站构建上设置自动增量，比如在哪里设置这样的东西：

```
[assembly:AssemblyFileVersion("1.0.*")] 
```

请记住，我是在一个网站项目上而不是在一个 Web 应用程序上。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T19:37:03.840

好的..经过一些深入的研究和一些令人头疼的事情，因为文档（官方）通常非常肤浅，我找到了一种方法。因此，如果您有一个 WEB SITE 项目并想为您的网站添加半自动版本控制（也许检索此版本以用于您想要的任何用途，例如取消附加的静态文件缓存？v=version）这里是如何做到的：

*   在您的项目中创建一个不在 App_Code 文件夹内的文件，并将其命名为 AssemblyInfo.vb（我在 VB 中编码。如果您需要 C#，请在 Google 中搜索“Telerik Code Converter”）。如果需要，您可以将文件放在 App_Data 文件夹中
*   在此文件中，您不需要创建任何类，只需为插入此代码的 .DLL 指定信息：

例子

```
Imports System.Reflection

<Assembly: AssemblyDescription("desc")> 
<Assembly: AssemblyCompany("company")> 
<Assembly: AssemblyCopyright("Copyright © 2013 your name")> 
<Assembly: AssemblyProduct("asdasd")> 
<Assembly: AssemblyVersion("2.0.*")> 
```

然后在您的 web.config 中（在“配置”标签之间）插入以下代码：

```
<system.codedom>
 <compilers>
  <compiler language="vb;vbs;visualbasic;vbscript" extension=".vb" type="Microsoft.VisualBasic.VBCodeProvider, System, Version=2.0.3600.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
    compilerOptions='"C:\Absolutepath\App_Data\AssemblyInfo.vb"' />
 </compilers>
</system.codedom> 
```

带有您的 AssemblyInfo.vb 文件的路径。注意：如果你不想像我一样浪费时间……这条路必须是绝对的，不能是相对的。因此，当您在另一台服务器上移动生产站点时，请记住更改它。

# delphi - 如果在 .chm 文件（html 帮助）中描述了 AKeyword，Delphi XE2 的应用程序将冻结两次

> ID：15819792
> 
> 赞同：1
> 
> 时间：2013-04-04T19:13:58.687
> 
> 标签：delphi, delphi-xe2, html-help

我们正在使用以下代码通过 Delphi XE2 应用程序上的 A-links 调用 html 帮助：

```
var
  aLink: THH_AKLink;
begin
  ZeroMemory(@aLink, SizeOf(aLink));
  aLink.cbStruct := SizeOf(aLink);
{$WARNINGS OFF}
  aLink.pszKeywords := PChar(AnsiString(AKeyword));
{$WARNINGS ON}
  aLink.fIndexOnFail := False;
  HtmlHelpW(Handle, Application.HelpFile, HH_ALINK_LOOKUP, DWORD_PTR(@aLink))
end; 
```

但是，如果`AKeyword`在 .chm 文件中描述了两次，则应用程序会冻结（挂起）。Delphi 或系统库似乎有问题。但是如何在应用程序上解决这个问题？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T23:32:27.233

您**将两次添加到已编译的 chm 文件**中，**第三方**应用程序**2 等于 ALink**。

那么当chm文件没有按预期工作时，你把责任归咎于Delphi XE2吗？

**1.) 您不能将 AKeyword 与**

```
HtmlHelpW(Handle, Application.HelpFile, HH_ALINK_LOOKUP, DWORD_PTR(@aLink)) 
```

您可以使用 KLink 关键字进行尝试：

```
HtmlHelpW(Handle, Application.HelpFile+'>main', HH_DISPLAY_TOPIC, DWORD_PTR(nil));
HtmlHelpW(Handle, Application.HelpFile, HH_KEYWORD_LOOKUP, DWORD_PTR(@link)); 
```

`ALink`是他出现在这里的一次跳跃，也是`KLink`相关话题中的一次展示或跳跃。

但是，找到的主题列表不是基于索引中的关键字，而是基于`ALink names`.htm 文件中涉及的关键字。

这只能与 ALink 一起使用。下面是一个ALink。

xy.htm 的一部分

```
<Object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
    <param name="ALink Name" value="UsingtheMenus">
</OBJECT> 
```

**2.）在您的代码中，我看不到以下内容：**

```
HtmlHelpW(Handle, Application.HelpFile, HH_DISPLAY_TOPIC, DWORD_PTR(nil)); 
```

*   在调用之前必须先调用 HH_DISPLAY_TOPIC 命令`HH_ALINK_LOOKUP`，以确保创建帮助窗口。

[HH_ALINK_LOOKUP 命令](http://msdn.microsoft.com/en-us/library/windows/desktop/ms670091%28v=vs.85%29.aspx)

*   帮助作者使用 HTML 帮助编译器信息功能将 ALink 名称插入目标主题文件。
*   ALink : name="ALink 名称" value="lookupAlink"
*   KLink：名称=“关键字”值=“查找关键字”

查找区分大小写。多个查找由分号分隔。

除了自动生成的关键字，在编译 .htm 源文件时。

![在此处输入图像描述](https://i.stack.imgur.com/jv3ds.jpg)

您可以使用显式的 KLink。

这是一个显式的“KLink”，该位置可能位于 .htm 文件中的任何位置，用于关键字

```
<Object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
    <param name="Keyword" value="lookupKeyword">
</OBJECT> 
```

如果您创建了错误消息，则会显示错误并且应用程序正常继续，这是有益的。来自答案的来源[如何添加对 HTML 帮助文件 (.chm) 的支持....](https://stackoverflow.com/a/15704866/1322642)

```
procedure TForm1.HHALINKLOOKUPClick(Sender: TObject);
var
link : HH_AKLINK;
szUrl,szKey,szMsgText,szMsgTitle,szWindow : AnsiString;
begin
   szKey      := Edit1.Text; // 'UsingtheMenus';
   szUrl      :='Overview.htm';
   szMsgText  :='Error: Can''t find "'+Edit1.Text+'"!';
   szMsgTitle :='Error: HH_ALINK_LOOKUP';
   szWindow   :='main';

   with link do begin
   cbStruct    := sizeof(HH_AKLINK) ;
   fReserved   := False;
   pszKeywords := PChar(szKey);
   pszUrl      := nil;
   pszMsgText  := PChar(szMsgText);
   pszMsgTitle := PChar(szMsgTitle);
   pszWindow   := PChar(szWindow);
   fIndexOnFail:= False;
   end;
   HtmlHelpW(Handle, Application.HelpFile+'>main', HH_DISPLAY_TOPIC, DWORD_PTR(nil));
   HtmlHelpW(Handle, Application.HelpFile, HH_ALINK_LOOKUP, DWORD_PTR(@link));
end; 
```

当你在没有最后一个字母“s”的情况下 ALink “UsingtheMenus” 调用时，你会得到什么。

![在此处输入图像描述](https://i.stack.imgur.com/cpzOU.jpg)

**测试您的：**使用 3rd 方应用程序更改的 chm 文件

您可以使用 HTML Help Workshop 测试任何 .chm 文件

![在此处输入图像描述](https://i.stack.imgur.com/BDvSX.jpg)

![在此处输入图像描述](https://i.stack.imgur.com/n9POy.jpg)

![在此处输入图像描述](https://i.stack.imgur.com/FHTZz.jpg)

![在此处输入图像描述](https://i.stack.imgur.com/TaxcT.jpg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-07T17:27:40.870

目前最好的答案是删除 CHM 文件上所有重复的 A 链接，并确保其上没有重复项。

# r - 如何在 r 中制定语句？

> ID：15819793
> 
> 赞同：-4
> 
> 时间：2013-04-04T19:14:01.157
> 
> 标签：r

所以这是我的问题：我得到了一个数据集，指令是：

> 增长模式是通过将 X 变量转换为一个新的分类变量来生成的，该变量可以命名为“增长”。第一类分配给 X 变量中介于 15 到 50 之间的岛屿。

所以这就是问题，但我主要头疼的是如何用 R 语言写“15 到 50 之间”。这就是我所拥有的

```
growth$mediumgrowth.islands <- growth$SasiaUrban.X[growth$SasiaUrban.X ???] 
```

但我不知道该放什么命令？？？部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:18:12.127

让我们得到一些可重现的东西：

```
set.seed(47)
df <- data.frame(x = sample(60, 100, replace = TRUE)) 
```

通过告诉 R“大于 15*且*小于 50”来回答您的确切问题，即如何写“介于 15 和 50 之间”：

```
## What's between 15 and 50?
df$x > 15 & df$x <= 50 
```

这给了你一个真/假的向量。当您的条件匹配（在 15 到 50 之间）时，它的长度相同`x`并且为 TRUE，否则为 FALSE。（注意：我使用大于 15 且小于或等于 50，您可能需要调整它。）填写您的“？？？” 将是`growth$SasiaUrban.X[growth$SasiaUrban.X > 15 & growth$SasiaUrban.X <= 50]`。

```
## We could assign this as a new column
df$between15and50 <- df$x > 15 & df$x <= 50 
```

如果您想要更多类别，一次完成所有类别是有意义的，并且`cut`这很容易：

```
## Or we could use cut
cut(df$x, breaks = c(0, 15, 50, 100))

df$category <- cut(df$x, breaks = c(0, 15, 50, 100))

## Adding labels instead
df$category2 <- cut(df$x, breaks = c(0, 15, 50, 100),
    labels = c("low", "medium", "high"))

head(df) 
```

# c - 何时在扩展的 GCC 内联汇编中使用 earlyclobber 约束？

> ID：15819794
> 
> 赞同：16
> 
> 时间：2013-04-04T19:14:03.450
> 
> 标签：c, gcc, assembly, inline-assembly

我了解何时使用 cobbler 列表（例如，列出在程序集中修改的寄存器，以便它不会被选择用作输入寄存器等），但我无法绕过 earlyclobber 约束`&`. 如果您列出您的输出，那是否已经意味着输入不能使用所选寄存器（除了匹配的数字约束）？

例如：

```
asm(
    "movl $1, %0;"
    "addl $3, %0;"
    "addl $4, %1;"   // separate bug: modifies input-only operand
    "addl %1, %0;"
    : "=g"(num_out)
    : "g"(num_in)
    :
); 
```

`&`甚至需要输出变量吗？编译器应该知道为输出选择的寄存器，因此知道不将它用于输入。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-04T19:23:33.900

默认情况下，编译器假定在写入任何输出寄存器之前将使用所有输入，因此允许对两者使用相同的寄存器。这会在可能的情况下产生更好的代码，但如果假设错误，事情将会灾难性地失败。“early clobber”标记是一种告诉编译器此输出将在所有输入被消耗之前写入的方法，因此它不能与任何输入共享寄存器。

GNU C 内联汇编语法旨在尽可能高效地包装*单个指令。*您可以在 asm 模板中放置多个指令，但默认值（假设在写入任何输出之前读取所有输入）是围绕包装单个指令设计的。

它与 GCC 在其机器描述文件中使用的约束语法相同，这些文件教编译器在 ISA 中可用的指令。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2019-02-24T15:53:53.053

**最小的教育例子**

在这里，我提供了一个最小的教育示例，试图使[https://stackoverflow.com/a/15819941/895245](https://stackoverflow.com/a/15819941/895245)提到的内容更清晰。

这个具体的代码在实践中当然没有用，单`lea 1(%q[in]), %out`条指令可以更高效地实现，只是一个简单的教育例子。

主程序

```
#include <assert.h>
#include <inttypes.h>

int main(void) {
    uint64_t in = 1;
    uint64_t out;
    __asm__ (
        "mov %[in], %[out];" /* out = in */
        "inc %[out];"        /* out++ */
        "mov %[in], %[out];" /* out = in */
        "inc %[out];"        /* out++ */
        : [out] "=&r" (out)
        : [in] "r" (in)
        :
    );
    assert(out == 2);
} 
```

编译并运行：

```
gcc -ggdb3 -std=c99 -O3 -Wall -Wextra -pedantic -o main.out main.c
./main.out 
```

这个程序是正确的并且断言通过了，因为强制编译器为和`&`选择不同的寄存器。`in``out`

这是因为`&`告诉编译器`in`可能在`out`写入后使用，这里实际上就是这种情况。

因此，唯一不会错误修改`in`的方法是将`in`和`out`放在不同的寄存器中。

拆解：

```
gdb -nh -batch -ex 'disassemble/rs main' main.out 
```

包含：

```
 0x0000000000001055 <+5>:     48 89 d0        mov    %rdx,%rax
   0x0000000000001058 <+8>:     48 ff c0        inc    %rax
   0x000000000000105b <+11>:    48 89 d0        mov    %rdx,%rax
   0x000000000000105e <+14>:    48 ff c0        inc    %rax 
```

这表明 GCC 选择了`rax`for`out`和`rdx`for `in`。

但是，如果我们删除它`&`，则行为是未指定的。

在我的测试系统中，断言实际上失败了，因为编译器试图最小化寄存器的使用，并编译为：

```
 0x0000000000001055 <+5>:     48 89 c0        mov    %rax,%rax
   0x0000000000001058 <+8>:     48 ff c0        inc    %rax
   0x000000000000105b <+11>:    48 89 c0        mov    %rax,%rax
   0x000000000000105e <+14>:    48 ff c0        inc    %rax 
```

因此`rax`同时用于`in`和`out`。

这样做的结果`out`是增加了两次，并且等于`3`而不是`2`最后。

在 Ubuntu 18.10 amd64、GCC 8.2.0 中测试。

**更实际的例子**

*   [乘法隐式输出寄存器](https://stackoverflow.com/questions/15819794/when-to-use-earlyclobber-constraint-in-extended-gcc-inline-assembly#comment22989396_15819941)
*   非硬编码暂存寄存器：[GCC：禁止使用某些寄存器](https://stackoverflow.com/questions/6682733/gcc-prohibit-use-of-some-registers/54963829#54963829)

# javascript - 在函数和对象之外设置变量

> ID：15819795
> 
> 赞同：0
> 
> 时间：2013-04-04T19:14:12.470
> 
> 标签：javascript, ajax, scope

我正在尝试设置变量`result`，但它仍未定义。

```
 if (window.XMLHttpRequest)
        {// code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp=new XMLHttpRequest();
        }
        else
        {// code for IE6, IE5
            xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange=function()
        {
            if(xmlhttp.readyState == 4 && xmlhttp.status == 200)
            {
                if(xmlhttp.responseText)
                {
                    result = true
                    alert(xmlhttp.responseText+" here1")
                }
                else
                {
                    document.getElementById("report").innerHTML = "wrong password/username"
                    alert(xmlhttp.responseText+" here2")
                    result = false
                }
            }
        }
        xmlhttp.open("POST", "process.php", true);
        xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xmlhttp.send("name="+encodeURIComponent(name.value));
        alert("final value: "+result)
        return result//always undefined 
```

如何让对象影响它所在函数之外的变量？这个问题比我说的要复杂一些。当用户尝试提交表单时调用此函数。如果返回 true，则应提交表单，如果返回 false，则不应提交表单。我现在有了代码（感谢甜淀粉酶）

```
 var result
   var checkResult = function(result) {
         alert("final value: " + result);
         return result
   };

    xmlhttp.onreadystatechange=function()
    {
        var result = null;
        if(xmlhttp.readyState == 4 && xmlhttp.status == 200)
        {
            if(xmlhttp.responseText)
            {
                result = true
                alert(xmlhttp.responseText+" here1")
            }
            else
            {
                document.getElementById("report").innerHTML = "wrong password/username"
                alert(xmlhttp.responseText+" here2")
                result = false
            }
            checkResult(result);     // pass result to another function
        }
    }
    xmlhttp.open("POST", "process.php", true);
    xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xmlhttp.send("name="+encodeURIComponent(name.value)); 
```

但是表单总是被提交，甚至在“最终值...”显示之前。如果我在代码末尾添加 return false 则永远不会提交表单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:22:40.977

AJAX 是*异步*的，所以你需要修改你的`onreadystatechange()`函数，你可以传递`result`给另一个函数来处理你的逻辑：

```
 var checkResult = function(result) {
         alert("final value: " + result);
         /* handle your result here */
   };
   ...

    xmlhttp.onreadystatechange=function()
    {
        var result = null;
        if(xmlhttp.readyState == 4 && xmlhttp.status == 200)
        {
            if(xmlhttp.responseText)
            {
                result = true
                alert(xmlhttp.responseText+" here1")
            }
            else
            {
                document.getElementById("report").innerHTML = "wrong password/username"
                alert(xmlhttp.responseText+" here2")
                result = false
            }
            checkResult(result);     // pass result to another function
        }
    }
    xmlhttp.open("POST", "process.php", true);
    xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xmlhttp.send("name="+encodeURIComponent(name.value)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:21:38.197

“onreadystatechange”函数是异步的，这就是为什么你设置一个回调函数在事件触发时执行。你正在做的是对javascript说：“当你改变你的就绪状态时，这样做。”。然后你的代码继续运行 e 返回结果的值（这是未定义的，因为就绪状态还没有改变）..

因此，如果您需要使用 result 的值，您应该在回调函数中执行此操作。

希望能帮助到你..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:20:37.167

利用`callback`

```
 function callServer(callback){
         if (window.XMLHttpRequest)
                ------------------- code ------------
            xmlhttp.open("POST", "process.php", true);
            xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xmlhttp.send("name="+encodeURIComponent(name.value));
             xmlhttp.onreadystatechange = function(){
                 if (xmlhttp.readyState==4 && xmlhttp.status==200)
                 {
                 callback(xmlhttp.responseText);
                 }
             }
         }   
  } 
```

# c# - 以编程方式更改 WPF 按钮背景图像

> ID：15819796
> 
> 赞同：3
> 
> 时间：2013-04-04T19:14:19.707
> 
> 标签：c#, wpf, xaml

我正在尝试`<Button/>`为背景和背景颜色创建一个带有 png 图像的图像。

**注意：** png*图片*的来源可能还不知道，所以不能直接放在模板里。

我有一个`Style`看起来像这样的：

```
<Style x:Key="MyButton" TargetType="Button">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Button">
                <Border CornerRadius="0">
                    <Image Margin="0" Source="/MyApp;component/Images/my-image.png" Stretch="None" />
                    <Border.Style>
                        <Style TargetType="{x:Type Border}">
                            <Setter Property="Background" Value="LimeGreen" />
                        </Style>
                    </Border.Style>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

这给了我一个按钮，在纯 LimeGreen 背景上带有 png 图像。

我的`MainWindow.xaml`看起来有点像这样：

```
<Button Style="{StaticResource MyButton}" Click="btnMine_Click" /* some other props */ /> 
```

它背后的代码是这样的：

```
private void btnMine_Click(object sender, RoutedEventArgs e)
{
    // TODO: change the image src on this button
    var myButton = sender as Button;

    // This won't work:
    // myButton.Border.Image.Source = getNewImageString();
} 
```

**如何将图像源更改`/MyApp2;component/Images/my-image.png`为其他内容？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T04:31:56.223

> 叹息，在 Windows 窗体中它实际上是一行。在 WPF 中，它看起来会是几百个。

那是因为它是唯一可以放在 winforms 按钮中的东西。WPF 是一个真正的 UI 框架，而不是一些随机的、半弃用的恐龙，它只允许做默认的东西（顺便说一下，这看起来很可怕）。

**选项 1：将图像作为按钮放置`Content`：**

如果您只想在按钮中放置一个图像，而不是别的，为什么不这样做呢？

```
 <Style TargetType="Button">
            <Setter Property="Background" Value="LimeGreen"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}">
                            <ContentPresenter ContentSource="Content"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style> 
```

然后：

```
 <Button>
        <!-- Background not set, defaults to what's set in the Style -->
        <Image Source="./ChessPieces/BlackKnight.png"/>
    </Button>
    <Button Background="Red">
        <Image Source="./ChessPieces/BlackBishop.png"/>
    </Button>
    <Button Background="Blue">
        <Image Source="./ChessPieces/BlackPawn.png"/>
    </Button>

    <!-- WPF's idea of "Dynamic" is not the same as win(hack)forms' -->
    <Button Background="White">
        <Image Source="{Binding SomeStringPropertyDefinedInAViewModel}"/>
    </Button> 
```

结果：

![在此处输入图像描述](https://i.stack.imgur.com/FktId.png)

**选项 2（不是很优雅）：使用`Tag`属性：**

如果除了 Image 之外，您还想在 Button 中添加其他内容，您可以采用一种有点 hacky 的方法，将 ImageSource 放入 Button 的`Tag`属性中。

```
 <Style TargetType="Button">
            <Setter Property="Background" Value="LimeGreen"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}">
                            <StackPanel Orientation="Horizontal">
                                <Image Source="{Binding Tag, RelativeSource={RelativeSource TemplatedParent}}"
                                       Height="50" Width="50"/>
                                <ContentPresenter ContentSource="Content"/>
                            </StackPanel>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style> 
```

然后：

```
 <Button Tag="./ChessPieces/BlackKnight.png"
            Background="Blue"
            Foreground="White"
            Content="Some Text"/>

    <Button Tag="./ChessPieces/BlackBishop.png"
            Background="LightGray">
        <CheckBox Content="A CheckBox!" VerticalAlignment="Center"/>
    </Button> 
```

结果：

![在此处输入图像描述](https://i.stack.imgur.com/WcETz.png)

**选项 3：使用[附加属性](http://msdn.microsoft.com/en-us/library/ms749011.aspx)**

与选项 2 相同，但使用在其他地方声明的属性，例如：

```
 <Button ButtonImage.Source="./ChessPieces/BlackBishop.png"
         <!-- etc --> 
```

**选项 4：创建自定义控件：**

创建一个从 Button 派生的类（没有 XAML 的 .cs 文件）并添加一个`DependencyProperty`来保存图像，然后将模板设置为该值并使用该值。

**选项 5：MVVM**

创建一个`ButtonViewModel`，或实际使用 ViewModel 中声明的[DelegateCommand](http://wpftutorial.net/DelegateCommand.html)来绑定 Button 的属性。

**不是一个选项：遍历可视化树并更改`Image.Source`in 代码。**

这不是你想做的事情。这根本不是一个好方法。

我可以永远继续下去，但我必须去睡觉。如果您希望我详细说明这些方法中的任何一种，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:19:42.757

我想到了几种方法：

1.  在运行时访问样式并遍历它以找到图像
2.  为图像命名并在运行时引用，只需更改源

我认为最好的解决方案是创建一个用户控件并将图像源作为依赖属性，请参见： http: [//www.codeproject.com/Articles/224230/Exploring-the-use-of-Dependency-Properties-in-User](http://www.codeproject.com/Articles/224230/Exploring-the-use-of-Dependency-Properties-in-User)

这样，您将拥有一个随时可用的“自定义”控件，该控件支持您所追求的内容，并允许您直接引用它并使用绑定，这样您就可以避免使用样式的混乱解决方案。

* * *

经过对需求的讨论和扩展，请参见：

[如何从 C# 代码访问 wpf 中的 ResourceDictionary？](https://stackoverflow.com/questions/618648/how-can-i-access-resourcedictionary-in-wpf-from-c-sharp-code)

# ruby-on-rails - -bash：红宝石：找不到命令

> ID：15819800
> 
> 赞同：10
> 
> 时间：2013-04-04T19:14:25.387
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2, rbenv

```
hyperrjas@serv1:~$ rbenv global
1.9.3-p392
hyperrjas@serv1:~$ rbenv local
1.9.3-p392
hyperrjas@serv1:~$ which ruby-build
/usr/local/bin/ruby-build
hyperrjas@serv1:~$ rbenv versions
* 1.9.3-p392 (set by /home/hyperrjas/.ruby-version)
hyperrjas@serv1:~$ rbenv version
1.9.3-p392 (set by /home/hyperrjas/.ruby-version)
hyperrjas@serv1:~$ rbenv rehash
hyperrjas@serv1:~$ ruby -v
-bash: ruby: command not found
hyperrjas@serv1:~$ env | grep PATH
PATH=/home/hyperrjas/.rbenv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games
NODE_PATH=/usr/lib/nodejs:/usr/lib/node_modules:/usr/share/javascript
hyperrjas@serv1:~$ export PATH="$HOME/.rbenv/bin:$PATH"
hyperrjas@serv1:~$ ruby -v
-bash: ruby: command not found 
```

**我正在使用 ubuntu 12.04。**

这是我的`~/.profile`文件：

```
# ~/.profile: executed by the command interpreter for login shells.
# This file is not read by bash(1), if ~/.bash_profile or ~/.bash_login
# exists.
# see /usr/share/doc/bash/examples/startup-files for examples.
# the files are located in the bash-doc package.

# the default umask is set in /etc/profile; for setting the umask
# for ssh logins, install and configure the libpam-umask package.
#umask 022

# if running bash
if [ -n "$BASH_VERSION" ]; then
    # include .bashrc if it exists
    if [ -f "$HOME/.bashrc" ]; then
        . "$HOME/.bashrc"
    fi
fi

# set PATH so it includes user's private bin if it exists
if [ -d "$HOME/bin" ] ; then
    PATH="$HOME/bin:$PATH"
fi
export PATH="$HOME/.rbenv/bin:$PATH"
eval "$(rbenv init -)"
eval "$(rbenv init -)"
eval "$(rbenv init -)" 
```

我已经用 rbenv 安装了 ruby​​ 最新版本，当我尝试时`ruby -v`我得到了`-bash: ruby: command not found`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-04T19:27:23.463

**rbenv 在~/.bash_profile**末尾需要这些：

```
export PATH="$HOME/.rbenv/bin:$PATH"
eval "$(rbenv init -)" 
```

`grep rbenv ~/.bash_profile`用来看看他们是否在那里。

如果没有，请运行：

```
echo 'export PATH="$HOME/.rbenv/bin:$PATH"' >> ~/.bash_profile
echo 'eval "$(rbenv init -)"' >> ~/.bash_profile
exec $SHELL -l 
```

你应该启动并运行。

[有关详细信息，请参阅文档](https://github.com/sstephenson/rbenv/)中的步骤 2 和 3 。

有关 .bashrc、.bash_profile 和 .profile 的其他信息可以在以下位置找到：

*   [.bashrc、.bash_profile 和 .environment 有什么区别？](https://stackoverflow.com/questions/415403/whats-the-difference-between-bashrc-bash-profile-and-environment)
*   [Snow Leopard 上 .profile 和 .bash_profile 的区别](https://stackoverflow.com/questions/6751252/difference-between-profile-and-bash-profile-on-snow-leopard)
*   [https://superuser.com/questions/183870/difference-between-bashrc-and-bash-profile](https://superuser.com/questions/183870/difference-between-bashrc-and-bash-profile)
*   [https://unix.stackexchange.com/questions/40708/what-is-the-difference-between-profile-bashrc-bash-profile-gnomer](https://unix.stackexchange.com/questions/40708/what-is-the-difference-between-profile-bashrc-bash-profile-gnomer)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T19:17:35.993

运行`env | grep PATH`并确保`$HOME/.rbenv/bin`您的 PATH 中有。

如果不是，请将其添加到 ~/.bash_profile。

```
export PATH="$HOME/.rbenv/bin:$PATH" 
```

# html - 与 html5 表单日期的天数差异

> ID：15819801
> 
> 赞同：0
> 
> 时间：2013-04-04T19:14:32.793
> 
> 标签：html, forms, datepicker, datediff, days

如何使用日期选择器从 html5 表单中获取两个日期的天数差异？

我试过这样的东西，但还没有用：它显示 NaN（不是数字）

```
<!DOCTYPE html>
<html>
    <body>
        <form oninput="c.value=b.value-a.value;">
            date a:<input type="date" id="a" value="">
            date b:<input type="date" id="b" value="">
            <br>
            c = b-a in days:<output name="c" for="a b"></output><br>
        </form>
    </body>
</html> 
```

# java - 如何在每个 ActionBar 选项卡中使用不同的布局 (Android)

> ID：15819805
> 
> 赞同：1
> 
> 时间：2013-04-04T19:14:45.207
> 
> 标签：java, android, tabs, android-fragments, android-actionbar

我有一个使用 Android ActionBar 并具有三个选项卡的应用程序。我正在使用片段容器来切换不同的 ListFragments，但对于其中一个选项卡，我还想要布局底部的按钮和几个保存列表中数据摘要的 TextView。我在应用程序的其他地方将其作为 FragmentActivity 和 ListFragment 实现。

我想知道是否有任何方法可以为一个选项卡定义布局？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:47:06.647

复制您正在膨胀 ListFragment 的布局 xml，然后将额外的视图放在列表元素旁边。您可以`onTabSelected(Tab tab, FragmentTransaction ft)`在 FragmentActivity 中使用来跟踪是否选择了您的特殊情况选项卡，然后将包内的标志推送到实例化您的片段类的内容，然后指示它需要在`onCreateView()`.

假设你可能有这个布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">
    <ListView
        android:id="@+id/@android:id/list"
        android:layout_width="match_parent"
        android:layout_height="wrap_content">
    </ListView>
</LinearLayout> 
```

在此处的 ListView 下方添加 TextViews 或 Button 是可行的（在这个确切的示例中，它们会被推离屏幕底部）。根据您如何进行包含 ListView 的布局，您可以在列表滚动时将新项目永久保存在屏幕底部（RelativeLayout 包含所有内容，线性布局包含文本/按钮，并`android:layout_above="@+id/idOfThatLinearLayout"`作为 ListView 的属性添加） . 或者，您可以使用 addFooterView() 执行与此类似的操作，以使这些新项目与列表一起滚动[，](https://stackoverflow.com/a/4265324/1305064)*就*好像它们是底部的最后一个项目一样。

# sql - 游标中的结果可以用于辅助游标查询吗？

> ID：15819810
> 
> 赞同：0
> 
> 时间：2013-04-04T19:14:56.580
> 
> 标签：sql, stored-procedures, db2

我无法确定在 cursor2 中使用来自 cursor1 的结果的正确方法。这可以做到吗？我读过它们可以存储在声明的 VARCHAR(8000) 中，但是会引发不正确的类型错误。我的第二个问题是，如果可以存储这些结果，它们可以容纳多列/多行吗？我对 DB2 不是很熟悉，因此我们将不胜感激您的专业人士提供的任何帮助。

这是它在代码中的样子：

```
 BEGIN
     DECLARE v_type VARCHAR(8000);
     DECLARE cursor1 CURSOR WITH RETURN FOR SELECT type FROM vehicles;
     DECLARE cursor2 CURSOR WITH RETURN FOR SELECT * FROM manufacturers WHERE type LIKE v_type;

     OPEN cursor1
     FETCH cursor1 INTO v_type;
     CLOSE cursor1;
     OPEN cursor2;
     END
     @ 
```

最后，有什么方法可以测试游标是否没有结果？理想情况下，通过“if”语句。请随时纠正我的语法中的任何其他问题。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T18:16:48.410

会`JOIN`不会工作？类似以下内容的情况如何：

```
DECLARE Manufactured_Vehicle CURSOR WITH RETURN FOR
SELECT <list columns in manufacturers>
FROM manufacturers
JOIN vehicles
  ON vehicles.type = manufacturers.v_type -- whatever the relationship is 
```

以这种方式存储结果没有任何意义。

另外，您一般要做什么？我的意思是，当结果集可能变得太大时，游标通常被认为是“黑客”——SQL 旨在以“基于集合”的方式工作，而不是逐行工作。

# javascript - 带有 Internet Explorer 9 的 PHP 和 Javascript location.hash

> ID：15819815
> 
> 赞同：1
> 
> 时间：2013-04-04T19:15:40.533
> 
> 标签：javascript, internet-explorer-9

我有一个 CSS 模式，当用户单击我页面上的按钮时会弹出。我使用回帖中的一些信息来生成模态。在生成模态的代码的末尾，我使用：

`echo '<script type="text/javascript">location.hash = "#confirm";</script>';`

使模态出现。

这在 Chrome、Safari、Firefox、Opera 和 IE10 中非常适合我。但是，在 IE9 中，当我单击按钮时，URL 确实会附加 #confirm 标记，但不会出现模式，并且页面似乎丢失了我的所有 CSS 样式。我不知道我是否遇到了 IE9 错误、我做错了什么，或者它是否与我处理此模式的方法不兼容。

感谢任何建议或见解！

更新一些问题：我使用生成代码的函数呈现模式：

```
//CONFIRM MODAL
function FUNCTION_confirm_modal($modal_header, $modal_content, $modal_button1, $modal_link1, $modal_button2, $modal_link2)
{
    //BUILD SUBMIT SUCCESS MODAL        
    $confirm_modal = '
    <div id="confirm" class="modal">
    <div>
    <h4 class="warn">'.$modal_header.'</h4>
    '.$modal_content.'
    <fieldset id="modalSubmitAreaRight">
    <a href="'.$modal_link1.'" class="shortButton">'.$modal_button1.'</a><a href="'.$modal_link2.'" class="longButton">'.$modal_button2.'</a>
    </fieldset>
    </div>
    </div>';    

    //RETURN DATA
    return $confirm_modal;
} 
```

然后，在我的内容页面上，我这样做：

```
print_r($confirm_modal);
echo '<script type="text/javascript">location.hash = "#confirm";</script>'; 
```

模态的实际外观/可见性/等由我的 CSS 控制。如果您也需要查看，请告诉我。谢谢！

这是打开/关闭模式的 CSS：

```
.modal {
position: fixed;
overflow: scroll;
top: 0;
left: 0;
right: 0;
bottom: 0;
background: rgba(0,0,0,0.5);
z-index: 1000;
-webkit-transition: opacity 500ms ease-in;
-moz-transition: opacity 500ms ease-in;
-o-transition: opacity 500ms ease-in;
transition: opacity 500ms ease-in;
visibility:hidden;
pointer-events: none;
}

/* SHOW MODAL */

.modal:target {
visibility: visible;
pointer-events: auto;
}

/* MODAL CONTENT */

.modal > div {
width: 500px;
background: #fff;
position: relative;
margin: 10% auto;
-webkit-animation: minimise 500ms linear;
-moz-animation: minimise 500ms linear;
-o-animation: minimise 500ms linear;
padding: 30px;
border-radius: 7px;
box-shadow: 0 3px 20px rgba(0,0,0,0.9);
background: #fff;
background: -moz-linear-gradient(#fff, #ccc);
background: -webkit-linear-gradient(#fff, #ccc);
background: -o-linear-gradient(#fff, #ccc);
text-shadow: 0 1px 0 #fff;
}

/* MODAL CALL ANIMATION */

.modal:target > div {
-webkit-animation-name: bounce;
-moz-animation-name: bounce;
-o-animation-name: bounce;
}

/* MODAL ANIMATION */

@-webkit-keyframes bounce {
  0% {
-webkit-transform: scale3d(0.1,0.1,1);
-o-transform: scale3d(0.1,0.1,1);
box-shadow: 0 3px 20px rgba(0,0,0,0.9);
  }
  55% {
-webkit-transform: scale3d(1.08,1.08,1);
-o-transform: scale3d(1.08,1.08,1);
box-shadow: 0 10px 20px rgba(0,0,0,0);
  }
  75% {
-webkit-transform: scale3d(0.95,0.95,1);
-o-transform: scale3d(0.95,0.95,1);
box-shadow: 0 0 20px rgba(0,0,0,0.9);
  }
  100% {
-webkit-transform: scale3d(1,1,1);
-o-transform: scale3d(1,1,1);
box-shadow: 0 3px 20px rgba(0,0,0,0.9);
  }
}

@-webkit-keyframes minimise {
  0% {
-webkit-transform: scale3d(1,1,1);
-o-transform: scale3d(1,1,1);
  }
  100% {
-webkit-transform: scale3d(0.1,0.1,1);
-o-transform: scale3d(0.1,0.1,1);
  }
}

@-moz-keyframes bounce {
  0% {
-moz-transform: scale3d(0.1,0.1,1);
-o-transform: scale3d(0.1,0.1,1);
box-shadow: 0 3px 20px rgba(0,0,0,0.9);
  }
  55% {
-moz-transform: scale3d(1.08,1.08,1);
-o-transform: scale3d(1.08,1.08,1);
box-shadow: 0 10px 20px rgba(0,0,0,0);
  }
  75% {
-moz-transform: scale3d(0.95,0.95,1);
-o-transform: scale3d(0.95,0.95,1);
box-shadow: 0 0 20px rgba(0,0,0,0.9);
  }
  100% {
-moz-transform: scale3d(1,1,1);
-o-transform: scale3d(1,1,1);
box-shadow: 0 3px 20px rgba(0,0,0,0.9);
  }
}

@-moz-keyframes minimise {
  0% {
-moz-transform: scale3d(1,1,1);
-o-transform: scale3d(1,1,1);
  }
  100% {
-moz-transform: scale3d(0.1,0.1,1);
-o-transform: scale3d(0.1,0.1,1);
  }
} 
```

# azure - Azure Cmdlet (Add-AzureCertificate) 失败并显示 HTTP 状态代码：NotFound

> ID：15819819
> 
> 赞同：1
> 
> 时间：2013-04-04T19:15:57.073
> 
> 标签：azure, azure-powershell

从powershell，我试图将证书添加到已经创建的服务中，我遇到了以下错误

> Add-AzureCertificate：HTTP 状态代码：NotFound - HTTP 错误消息： [https](https://management.core.windows.net/97d3cd24-78a1-44ba-aea4-0dd7c733cb56/services/hostedservices/XXXX) ://management.core.windows.net/97d3cd24-78a1-44ba-aea4-0dd7c733cb56/services/hostedservices/XXXX /certificates 不存在。
> 
> 操作 ID：dc1eabcef0c74861853fe53ed047f674 At + Add-AzureCertificate <<<< -ServiceName $servicename -CertToDeploy $CertificatePath -Password $Password + CategoryInfo : CloseError: (:) [Add-AzureCertificate], CommunicationException + FullyQualifiedErrorId : Microsoft.WindowsAzure.Management.ServiceManagement .Certificates.AddAzureCertificate

这在一个订阅（比如订阅 A）上运行良好，但在订阅中的每项服务（比如订阅 B）上都失败了

想知道这个错误实际上意味着什么？我确实在我尝试添加证书的服务下看到了一个名为“证书”的文件夹

我还导入了订阅 A 和 B 的适当发布设置，并且我没有对订阅 A 做任何不同的操作以使其正常工作！

你能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T22:12:44.003

如果我理解正确，可能是由于订阅上下文。在多个订阅的情况下，有必要在您尝试执行操作的 power-shell 中更改订阅的默认上下文。

## 示例：两个：subscriptionA 和subscriptionB

1.  执行：获取 AzureSubscription
2.  确保您看到所有（在本例中为 2 个）订阅
3.  使用 'Select-AzureSubscription 命令选择要在其中执行操作的订阅的上下文。
4.  使用 Set-AzureSubscription 设置正确的上下文 PS C:> Set-AzureSubscription -SubscriptionName SubscriptionA -CurrentStorageAccount < YourStorageaccountName>
5.  运行此程序以验证是否设置了正确的订阅：PS C:> Get-AzureSubscription -Current
6.  执行您的操作。
7.  现在使用 SubscrptionB 返回第 3 步并继续。

-----------------这可能有助于改变上下文 ---------

选择-AzureSubscription

```
PS C:\> Select-AzureSubscription -SubscriptionName SubscriptionA

PS C:\> 
```

设置 AzureSubscription

```
PS C:\> Set-AzureSubscription -SubscriptionName SubscriptionA -CurrentStorageAccount <YourStorageaccountName>

PS C:\> 
```

删除-AzureSubscription

```
PS C:\> Remove-AzureSubscription -SubscriptionName SubscriptionA -Force
    WARNING: The default subscription is being removed. Use Select-Subscription <subscriptionName> to select a new default subscription.
    WARNING: The current subscription is being removed. Use Select-Subscription <subscriptionName> to select a new current subscription. 
```

* * *

# gwt - GWT 单线程异步回调

> ID：15819821
> 
> 赞同：2
> 
> 时间：2013-04-04T19:16:00.237
> 
> 标签：gwt, asynchronous, gwt-rpc, single-threaded

```
rpc.call(mycallback);

{
//subsequent code block

} 
```

1.  单线程异步回调如何工作？
2.  回调何时被调用？
3.  后续代码块是否总是在回调被允许运行之前完成执行（即回调是否只会在所有代码完成后才运行？）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:35:09.470

使用 GWT-RPC，异步回调如下所示：

```
AsyncCallback<ResultBean> callback = new AsyncCallback<ResultBean>() {
    public void onSuccess(ResultBean result) {
        // Code to run once callback completes
    }

    public void onFailure(Throwable caught) {
        // Error handling code
    }
};

asyncService.call(callback);

// Subsequent code block 
```

`onSuccess()`一旦从服务器接收到结果，就会调用该方法。后续代码块将在回调完成之前执行，因为单线程必须先完成当前事件的执行，然后才能处理队列中的下一个事件。为了确保某些代码在回调完成后执行，应该从`onSuccess()`方法中调用它。

以下是有关其在单线程环境中如何工作的技术说明（[来自](https://groups.google.com/forum/#!msg/google-web-toolkit/OwjhYYnj8X0/yGccJfGZqIwJ)Thomas Broyer）：

> GWT-RPC 使用了基于 XMLHttpRequest 的 RequestBuilder。XMLHttpRequest (XHR) 使用事件与代码进行回通信，因此 XHR 上发生的任何事情都会导致事件被推送到事件队列中，并由事件循环出列。

另请参阅[GWT 文档](https://developers.google.com/web-toolkit/doc/latest/tutorial/RPC)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:40:03.060

目前没有区别

```
rpc.call(mycallback);
{
   //subsequent code block
} 
```

或者

```
{
   // code block before
}
rpc.call(mycallback); 
```

但是，我认为没有任何理由依赖这种行为。如果要确保代码块已被执行，请使用第二个版本

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T07:40:49.807

#1 javascript是单线程的，但是浏览器不是，所以js-thread发送xhr调用给浏览器去解析，浏览器马上把控制权返回给它。

#2 当浏览器从服务器获得响应时，它将回调排队到 js 线程中，因此它将在 js 完成它现在可以执行的任何事情时执行（在你的情况下是后续代码块）

#3 是的，它会的，因为这个块的单线程执行会阻止任何其他延迟代码（超时、回调）的执行，直到它完成。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-04-04T20:07:58.613

**由于调用是异步进行的，因此您不知道回调何时从服务器返回。**

所以，

当代码服务器调用开始时`//subsequent code block`开始执行，当调用结束时`onSuccess`代码块中的代码开始执行。

如果**onSuccess 代码块** 和 **后续代码块**是独立的，则在服务器命中*之前*或*之后*调用没有区别。

如果两者都依赖

```
rpc.call(new AsynchCallback { 
        onSucees(){
                   //subsequent code block
                  }
   }); 
```

# asp.net - 捆绑的 CSS 文件在 Web 窗体项目中为空白

> ID：15819826
> 
> 赞同：1
> 
> 时间：2013-04-04T19:16:19.543
> 
> 标签：asp.net, webforms, bundling-and-minification

概述：我正在尝试让 Bundling and Minification 与现有的 Asp.Net Forms 网站一起使用。我已经完成了所有设置，并且在调试中运行良好。生成了所有适当的链接，并且我的 css 效果很好；但是，每次我进行发布构建，或者只是简单地启用优化时，它都会以正确的格式生成一个好看的链接，但它只是一个空白页面，所以没有 css。

我在这里按照教程：[链接](http://igorzelmanovich.blogspot.com/2012/09/using-aspnet-bundling-and-minification.html)

这是我正在使用的代码：

全球.asax.cs

```
 private void Application_Start(object sender, EventArgs e)
            {
                //Private Website code removed for post

                Bundles.Register();
            } 
```

Bundles.cs（从 application_start 调用的文件）

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Web;
    using System.Web.Optimization;
    using System.Web.UI;

    namespace NopSolutions.NopCommerce.Web.Optimization
    {
        public class Bundles
        {
            /// <summary>
            /// Registers Bundles
            /// </summary>
            public static void Register()
            {
                var lessBundle = new Bundle("~/Bundles/fhm/product/Less").Include("~/Content/themes/fhm/product/*.css");
                BundleTable.Bundles.Add(lessBundle);
            }

            public static void RenderStyle(Page page, String bundle)
            {
                var code = System.Web.Optimization.Styles.Render(bundle);
                page.Header.Controls.Add(new LiteralControl(code.ToHtmlString()));
            }
        }
    } 
```

我调用渲染函数的产品页面代码

```
 protected void Page_Load(object sender, EventArgs e)
            {

                //render css style

                Bundles.RenderStyle(this, "~/Bundles/fhm/product/Less");

            } 
```

有人对可能发生的事情有任何想法吗？

# node.js - “划分服务”是什么意思？

> ID：15819827
> 
> 赞同：3
> 
> 时间：2013-04-04T19:16:21.903
> 
> 标签：node.js, mongodb, cloud, cloud-hosting, rackspace-cloud

我正在使用 Node/Express/Angular/Mongo 构建一个 Web 应用程序，这是我第一次处理云服务器。Rackspace 建议我划分我的服务。为了在客户面前听起来不像个新手，我求助于 StackOverflow 的朋友 :)

这到底是什么意思？关于如何组织 Mongo 和 Node 的代码和实例以“划分”的常见做法？

我对该主题的简短阅读使我相信这意味着保护措施，因此用户 A 不能妨碍性能或嗅探用户 B 的敏感信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:25:13.987

它本质上是确保您正在处理的信息仅显示给“需要查看它”的人 - 仅在必须设置对象时才在对象中设置属性。确保一切都在需要知道的基础上，并且您不会向缓存层、日志、用户会话等各个地方发送比您需要的更多的数据。

划分有意义的一个很好的例子是一个页面，它执行类似的操作`SELECT * FROM user WHERE id=123`并将其存储为`$_SESSION['USER'][123]`用户只想查看他上传的照片或其他内容的页面。在云计算中，信息泄露的风险更高，因此必须采取更多措施来保护敏感信息。

[Wiki](http://en.wikipedia.org/wiki/Compartmentalization_%28information_security%29)实际上有一个很好的例子：

> 在涉及信息安全的问题上，无论是公共部门还是私营部门，划分是限制为执行某些任务而需要了解信息的个人或其他实体访问信息。该概念起源于在军事和情报应用中处理机密信息。划分的基础是这样一种想法，即如果更少的人知道任务或任务的细节，那么这些信息可能被泄露或落入反对派手中的风险或可能性就会降低。因此，组织内部存在不同程度的许可。然而，即使某人拥有最高权限，某些“分隔”信息，由指代特定类型秘密信息的代码字识别，即使整体安全许可较低，也可能仍仅限于某些运营商。以这种方式标记的信息被称为是代码字分类的。一个著名的例子是 Ultra secret，其中文档被标记为“Top Secret Ultra”：“Top Secret”标记了它的安全级别，而“Ultra”关键字进一步将其读者群限制为仅允许阅读“Ultra”文档的人。[1](http://en.wikipedia.org/wiki/Compartmentalization_%28information_security%29)

服务的划分只是将这个概念带入应用程序的移动部分。如果太多零件在一个地方移动，那么如果这些零件中的任何一个发生故障，就会增加风险。您的服务器人员可能会建议您在一台服务器上使用电子邮件，在另一台服务器上使用数据库，在另一台服务器上使用缓存等。他们赚更多的钱，并且如果这些服务器中的任何一台出现故障，您的应用程序就会“更安全”。

# deployment - 基于构建的不同 SASS/Coffeescript 变量值

> ID：15819828
> 
> 赞同：3
> 
> 时间：2013-04-04T19:16:33.433
> 
> 标签：deployment, coffeescript, sass, gruntjs

我正在尝试为前端框架创建一个构建系统，该框架将根据我部署到的位置在 SASS（可能还有 Coffeescript）中创建不同的路径。因此，例如，我可能在我的 SASS 中本地引用了一个图像文件`../images/image.png`，这在我的本地环境中运行良好。但是，我的客户有一个非常封闭的环境，必须以不同的方式完成（从 CDN 获取他们的图像）。所以他们的图像路径可能看起来像`~Some_service_call/images/image.png`.

我希望做的是为两种环境准备好某种配置，所以当我在本地开发时，我可以通过终端运行命令，`build local package`或者`build deploy package`自动识别我正在部署的环境并使用基于路径的在那。理想情况下，我会有一个单独的配置 JSON 文件来控制每个 SASS / Coffeescript 变量使用哪些路径。

到目前为止，我已经开始为此研究 Grunt，但不确定它是否是正确的解决方案。有没有人尝试过做这种事情，什么对你有用/没用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:39:20.403

使用 Compass 编译您的项目。

在 Compass 中`config.rb`定义一个自定义函数：

```
# Assign a name to the project and pass it into SASS
$environment = "development"
module Sass::Script::Functions
  def environment
    Sass::Script::String.new($environment)
  end
end 
```

此功能将在 SASS 中可用：

```
$images-root: ".."
@if environment() == production
  $images-root: "/var/www/static/images"

html
  background-image: url( #{$images-root + "/sexy-lady.png"} ) 
```

你可以定制你的衬里！例如，您可以将路径传递给 SASS。或者，您可以使用一些高级逻辑（服务调用、读取 JSON）创建一个单独的 Ruby 文件，从`config.rb`SASS 函数中获取它并传递给它。

最后，您编写一个更新信息并运行的小脚本`compass compile`。

PS Compass 还允许添加用于开发的调试信息和用于生产的 CSS 缩小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-10T23:05:57.970

如果您不想创建 config.rb，只需使用gruntfile.js 中的选项**环境并将其设置为****生产**或**开发**：

```
compass: {          
            prod: {
                options: {                  
                    environment: 'production'
                }
            },
            dev: {
                options: {
                    environment: 'development'
                }
            }
        } 
```

并且环境值将在**file.scss**或**file.sass**文件中可用：

```
$font-path: "../fonts";

@if compass-env() == 'production'
{
    $font-path: "../assets/fonts"
} 
```

# java - 子复合材料未出现在布局中

> ID：15819832
> 
> 赞同：0
> 
> 时间：2013-04-04T19:16:46.963
> 
> 标签：java, swt

我正在尝试构建一个图形用户界面，其中多个复合材料垂直布局。我把我的方法放在一个最小的例子中：

```
public class LayoutTest {

    public static void main(String[] args) {
        Display display = new Display();
        Shell shell = new Shell(display);
        shell.setSize(400, 300);
        shell.setLayout(new FillLayout());

        Composite listPanel = new ScrolledComposite(shell, SWT.BORDER
                | SWT.V_SCROLL);
        listPanel.setLayout(new RowLayout(SWT.VERTICAL));
        listPanel.setBackground(Display.getCurrent().getSystemColor(
                SWT.COLOR_WHITE));

        for (int i = 1; i < 5; i++) {

            Composite listElement = new Composite(listPanel, SWT.BORDER);
            listElement.setLayout(new RowLayout());

            Label label = new Label(listElement, SWT.BORDER);
            label.setText(String.valueOf(i) + "     foo");
            label.setSize(label.computeSize(SWT.DEFAULT, SWT.DEFAULT));

            listElement.setSize(label.computeSize(shell.getSize().x,
                    label.getSize().y));
        }

        shell.layout(true, true);

        shell.open();
        while (!shell.isDisposed()) {
            if (!display.readAndDispatch())
                display.sleep();
        }
        display.dispose();
    }
} 
```

您可以看到一些合成是在循环中创建的。问题是只有第一个出现在 UI 中。我希望它们被布置在彼此下方，因为它的父级有一个垂直的`RowLayout`.

我还尝试了其他方法。一列是一列`GridLayout`，另一列是`FormLayout`我将每个孩子的顶部附件设置为前一个的地方。两者都显示出完全相同的结果。

有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:35:41.427

你去：

```
public static void main(String[] args)
{
    Display display = new Display();
    Shell shell = new Shell(display);
    shell.setLayout(new GridLayout(1, false));

    ScrolledComposite listPanel = new ScrolledComposite(shell, SWT.BORDER | SWT.V_SCROLL | SWT.H_SCROLL);
    listPanel.setLayout(new GridLayout(1, false));

    Composite child = new Composite(listPanel, SWT.NONE);
    child.setLayout(new GridLayout(2, false));

    for (int i = 1; i < 10; i++)
    {
        Button button = new Button(child, SWT.PUSH);
        button.setText("lalala");

        Label label = new Label(child, SWT.BORDER);
        label.setText(i + "     foo");
    }

    Point size = child.computeSize(SWT.DEFAULT, SWT.DEFAULT);

    listPanel.setContent(child);
    listPanel.setMinSize(size.x, size.y);
    listPanel.setExpandHorizontal(true);
    listPanel.setExpandVertical(true);

    shell.pack();
    shell.open();
    while (!shell.isDisposed())
    {
        if (!display.readAndDispatch())
            display.sleep();
    }
    display.dispose();
} 
```

缺少的重要部分是：

```
listPanel.setContent(child);
listPanel.setMinSize(size.x, size.y);
listPanel.setExpandHorizontal(true);
listPanel.setExpandVertical(true); 
```

# java - 如何在 ViewPager 后期调用 invalidate()

> ID：15819833
> 
> 赞同：4
> 
> 时间：2013-04-04T19:16:46.890
> 
> 标签：java, android, touchdb

我正在使用 TouchDB 复制一个 DB 并在 ViewPager 中的一系列 ListView 中显示其内容。我遇到的问题是，在第一次复制时，TouchDB 在完成复制之前调用它的 onSuccess()/onPostExecute() 方法，这意味着我无法在 ViewPager 上调用 invalidate() 来让它绘制 ListViews。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:51:34.100

您可以在运行队列的末尾添加一个会使无效的可运行文件。

```
myView.post(new Runnable() {
  @Override
  public void run() {
    myView.invalidate();
  }
}); 
```

这行得通吗？

# c++ - 为什么这是 NaN

> ID：15819836
> 
> 赞同：-3
> 
> 时间：2013-04-04T19:16:55.640
> 
> 标签：c++

我试图运行以下代码

```
 int salespersons=0,weeks=0,days=5;

  double weekly_sales[weeks][salespersons][days];
  double total_weekly_sales[weeks];

for(int w=0; w < weeks;w++)
  {
     for(int d =0; d < days; d++)
     {  

        for(int s=0; s < salespersons; s++)
        {

           {
              total_weekly_sales[w]+=weekly_sales[w][s][d];
              total_overall_weekly_sales[s]+= weekly_sales[w][s][d];

           }
        }  
     }

  } 
```

当我只跑..

```
cout << total_weekly_sales[0]; 
```

我得到 NaN 因此在处理其余部分时跳过了数组的第一部分。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T19:19:57.760

```
double weekly_sales[weeks][salespersons][days];
double total_weekly_sales[weeks]; 
```

***未初始化。***

编辑：这是你应该如何初始化它们：

```
double weekly_sales[weeks][salespersons][days] = { { { 0.0 } } }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T19:21:53.830

```
double total_weekly_sales[weeks];

total_weekly_sales[w]+=weekly_sales[w][s][d]; 
```

您正在添加一个未初始化的变量。

并打印一个未初始化的变量

```
cout << total_weekly_sales[0]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T19:22:29.443

您尝试使用代码并初始化所有变量

```
 int weeks=2,salepersons=3,days=1;

        double weekly_sales[weeks][salespersons][days];
          double total_weekly_sales[weeks];

    for(int w=0; w < weeks;w++)
      {
         for(int d =0; d < days; d++)
         {  
        for(int s=0; s < salespersons; s++)
        {

           {
              total_weekly_sales[w]=2;
              weekly_sales[w][s][d]=1;

           }
        }  
     }

  }

    for(int w=0; w < weeks;w++)
      {
         for(int d =0; d < days; d++)
         {  

            for(int s=0; s < salespersons; s++)
            {

               {
                  total_weekly_sales[w]+=weekly_sales[w][s][d];
                  total_overall_weekly_sales[s]+= weekly_sales[w][s][d];

               }
            }  
         }

      } 
```

并使用图书馆！！！

# android - 我如何设置方向屏幕“肖像”

> ID：15819842
> 
> 赞同：0
> 
> 时间：2013-04-04T19:17:12.883
> 
> 标签：android, titanium, titanium-mobile

我想很多 Titanium 开发者都会遇到这个问题：How to restrict applicationorientation to PORTRAIT

我试过了`app.xml`，创建文件`Manifest.xml`但没有成功你试过在属性窗口“肖像”没有工作。甚至尝试过这段代码

```
Ti.Gesture.addEventListener('orientationchange', function (e){
  Ti.Android.currentActivity.setRequestedOrientation(Ti.Android.SCREEN_ORIENTATION_PORTRAIT);
}) 
```

我正在使用 TabGroup 和与之关联的三个窗口。

有谁知道如何解决这个问题？

从现在开始，谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:38:53.930

你见过[这个](http://developer.appcelerator.com/question/40001/android-force-orientation)或[这个](http://developer.appcelerator.com/question/119538/how-to-lock-orientation)吗？

通常，您会`android:screenOrientation="portrait" android:configChanges="orientation|keyboardHidden"`在您的 android 清单中放入每个活动声明

# javascript - 为导航菜单创建“选定项目”javascript代码？

> ID：15819843
> 
> 赞同：2
> 
> 时间：2013-04-04T19:17:16.947
> 
> 标签：javascript, arrays, navigation

我有一个包含大约 10 个项目的导航菜单，我将这段代码放在一起来更新哪些链接被选中，哪些没有被选中。它手动更新类。正如您可能知道的那样，问题在于它效率低下并且更新起来很痛苦。有更好的方法吗？

```
$('#Button1').click(function(){
        $('#Button1').addClass("selectedItem");
        $('#Button2').removeClass("selectedItem");
        $('#Button3').removeClass("selectedItem");
        $('#Button4').removeClass("selectedItem");
        $('#Button5').removeClass("selectedItem");
        $('#Button6').removeClass("selectedItem");
        $('#Button7').removeClass("selectedItem");
        $('#Button8').removeClass("selectedItem");
        $('#Button9').removeClass("selectedItem");
        $('#Button10').removeClass("selectedItem");
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:21:32.423

你可以试试这样的 -

```
$("[id^='Button']").removeClass("selectedItem");
$('#Button1').addClass("selectedItem"); 
```

这将首先`selectedItem`从任何具有以“button”开头的 id 属性的元素中删除所有类。然后第二个命令将类添加到`Button1`

您也可以像这样简单地将所有元素与相同的处理程序绑定 -

```
var $buttons = $("[id^='Button']");

$buttons.on('click', function ()
{
  $buttons.removeClass("selectedItem");
  $(this).addClass("selectedItem");
}); 
```

对于每个元素，当单击时，类将被删除 - 单击的元素然后添加类。

检查[`Attribute Starts With Selector [name^="value"]`](http://api.jquery.com/attribute-starts-with-selector/)选择器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T19:32:38.010

我建议使用类，因为这正是它们的用途——表示元素组。虽然您可以使用 Lix 提出的方法轻松选择按钮（如果您无法修改 HTML，则应该使用此方法），但使用 class 更不显眼：

```
var $buttons = $('.button').on('click', function() {
    $buttons.removeClass('selectedItem');
    $(this).addClass('selectedItem');
}); 
```

元示例：http: [//jsfiddle.net/88JR2/](http://jsfiddle.net/88JR2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:21:03.760

您可以有一个类 .button 然后将其应用于所有按钮

```
$('#Button1').click(function(){
    $('.button').removeClass("selectedItem");
    $('#Button1').addClass("selectedItem");

}); 
```

# google-apps-script - 使用 google 脚本为 Gmail 邮件加注星标

> ID：15819847
> 
> 赞同：0
> 
> 时间：2013-04-04T19:17:23.757
> 
> 标签：google-apps-script, gmail, message

我对 Google Script 完全陌生，我正在尝试找出如何为我标记为“R/R(short)/R(ASAP)”的消息加注星标，并至少持有该标签一天。有什么建议么？这是我到目前为止所得到的：

```
function star2do() {
var delayDays = 1 // Enter # of days before messages are starred
var maxDate = new Date();
maxDate.setDate(maxDate.getDate()-delayDays);
var label = GmailApp.getUserLabelByName("R/R(short)/R(ASAP)");
var threads = label.getThreads();
for (var i = 0; i < threads.length; i++) {
if (threads[i].getLastMessageDate()<maxDate)
  {
    threads[i].markUnread();
    threads[i].addLabel(star) //this is where I'm having issues
  }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-20T20:38:06.657

```
threads[i].getMessages()[0].markUnread().star(); 
```

希望这可以帮助 ：）

# ios6 - ZBar SDK (iOS)：当我使用子视图时 Zbar 不扫描

> ID：15819853
> 
> 赞同：1
> 
> 时间：2013-04-04T19:17:52.920
> 
> 标签：ios6, sdk, subview, zbar-sdk

我已经在其他项目中成功使用过 ZBar，但是在将它实施到我的最新项目中时遇到了问题。它设置为选项卡式视图应用程序，其中第一个选项卡是扫描仪，第二个选项卡输出结果。为了解决 ZBar 使用全屏而不显示标签栏的问题，我创建了一个子视图（参见下面的代码）。但是，我也在我的其他 ZBar 项目上对此进行了测试，当您使用子视图时，ZBar 不会读取条形码然后存储编码数据。相反，动画扫描示踪剂只是弹跳。

有什么可以添加到我的代码中的东西，可以让我在子视图中使用 ZBar 吗？或者这是在选项卡式应用程序中使用 ZBar 的错误方式？

这是我的扫描方法：

```
- (void) presentReader
{
    ZBarReaderViewController *reader = [ZBarReaderViewController new];
    reader.readerDelegate = self;
    reader.supportedOrientationsMask =     ZBarOrientationMask(UIInterfaceOrientationPortrait);
    reader.showsHelpOnFail = YES;

    NSLog(@"reader presented");

    ZBarImageScanner *scanner = reader.scanner;
    // TODO: (optional) additional reader configuration here
    // EXAMPLE: disable rarely used I2/5 to improve performance
    [scanner setSymbology: 0
               config: ZBAR_CFG_ENABLE
                   to: 0];
    [scanner setSymbology: ZBAR_UPCA
               config: ZBAR_CFG_ENABLE
                   to: 0];
    [scanner setSymbology: ZBAR_DATABAR
               config: ZBAR_CFG_ENABLE
                   to: 1];
    [scanner setSymbology: ZBAR_DATABAR_EXP
               config: ZBAR_CFG_ENABLE
                   to: 1];

    reader.showsCameraControls = NO;  // for UIImagePickerController
    reader.showsZBarControls = NO;
    //reader.cameraFlashMode = UIImagePickerControllerCameraFlashModeAuto;
    reader.wantsFullScreenLayout = NO;

    reader.videoQuality = UIImagePickerControllerQualityTypeIFrame1280x720;

    //Subview
    [self.view addSubview:reader.view];

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T18:48:10.193

这在 UITabBarController 中对我有用 - （图片）[http://db.tt/cgVxDd0x](http://db.tt/cgVxDd0x)

我认为您的问题是您没有设置 reader.scanCrop。

```
-(void) viewDidAppear:(BOOL)animated {
    self.reader = [ZBarReaderViewController new];
    self.reader.readerDelegate = self;
    self.reader.enableCache = NO;
    self.reader.showsZBarControls = NO;
    self.reader.wantsFullScreenLayout = NO;
    self.reader.cameraFlashMode = UIImagePickerControllerCameraFlashModeOff;
    self.reader.supportedOrientationsMask = ZBarOrientationMask(UIInterfaceOrientationPortrait);

    ZBarImageScanner *scanner = self.reader.scanner;

    [scanner setSymbology: ZBAR_I25
                   config: ZBAR_CFG_ENABLE
                       to: 0];

    self.reader.scanCrop = CGRectMake(0, 0, 1, 1);
    [self.view addSubview:self.reader.view];

}

- (void) imagePickerController: (UIImagePickerController*) reader didFinishPickingMediaWithInfo: (NSDictionary*) info {
    id<NSFastEnumeration> results = [info objectForKey: ZBarReaderControllerResults];
    ZBarSymbol *symbol = nil;
    for(symbol in results)
        break;

    NSLog(@"%@",symbol.data);

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-16T10:06:22.893

我也面临这种问题。但是，一旦我将该阅读器对象变成全局对象而不是本地对象，那么这一切正常。

# batch-file - 批处理：获取文件夹所有者的名称

> ID：15819856
> 
> 赞同：1
> 
> 时间：2013-04-04T19:17:55.910
> 
> 标签：batch-file, dir, file-ownership

我知道在批处理脚本中获取文件夹所有者的唯一命令是：

```
dir %foldername% /q 
```

这有两个问题：

1.  它在列表中显示**所有**文件夹名称的内容，所以我必须只读取第一行（包含**< DIR >**和**"."**）或者你必须运行

    目录 %parent_of_foldername% /q | findstr "%文件夹名%"

2.  如果所有者有一个长名称（例如：TrustedInstaller），这将被修剪

这是我的 c:\

```
13/03/2013  18.33    <DIR>          NT SERVICE\TrustedInstaProgram Files

13/03/2013  18.33    <DIR>          NT SERVICE\TrustedInstaProgram Files (x86) 
```

那么如何在批处理脚本中获取文件夹的所有者名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:08:36.123

你可以试试这个：

```
@echo off &setlocal
set "foldername=c:\temp"
set "owner="

for /f "tokens=3*" %%i in ('dir /q %foldername%^|findstr "<DIR>"') do if not defined owner set "owner=%%j"
echo %owner% 
```

..和没有计算机名称的所有者：

```
@echo off &setlocal
set "foldername=c:\temp"
set "owner="

for /f "tokens=1*delims=\" %%i in ('dir /q %foldername%^|findstr "<DIR>"') do if not defined owner set "owner=%%j"
echo %owner% 
```

第三种方法（返回我机器上的全名）：

```
@echo off &setlocal
set "foldername=c:\temp"
set "owner="

for /f "tokens=2delims=\:" %%i in ('cacls "%foldername%" ^| find "%computername%"') do set "owner=%%i"
echo %owner% 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:23:28.220

```
@ECHO OFF
SETLOCAL
SET "owner="
FOR /f "tokens=2delims=\" %%i IN ('dir /q "%~1"' ) DO IF NOT DEFINED owner CALL :setown %%i
ECHO owner of "%~1" is %owner%

GOTO :eof

:setown
SET owner=%*
:setownl
SET $2=%2
IF defined $2 shift&GOTO setownl
IF NOT "%1"=="." SET "owner="&GOTO :eof
SET owner=%owner:~0,-2%
GOTO :eof 
```

是我的解决方案。为我工作...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T21:04:57.990

[http://msinfluentials.com/blogs/jesper/archive/2007/07/02/show-the-owner-of-a-file.aspx](http://msinfluentials.com/blogs/jesper/archive/2007/07/02/show-the-owner-of-a-file.aspx)的作者 Jesper Johansson感叹除此之外没有内置命令`dir /q`但列出了一些其他可以工作的命令行工具。

*   [SubInACL.exe](http://www.microsoft.com/en-us/download/details.aspx?id=23510)
*   FileACL.exe（我找不到这个可用的了）

# javascript - 该怎么办？Yslow 报告 Empty src 和 href

> ID：15819863
> 
> 赞同：0
> 
> 时间：2013-04-04T19:18:27.603
> 
> 标签：javascript, performance, joomla, href, src

所以我在 GTmetrix 上测试了我的网站，yslow 检测到 2 个 js 为空`src`或`href`. 它大部分时间都检测到，有几次没有检测到。

我的网站是 www.homelifepartners.com，它使用的是 joomla CMS。

我的问题是，我似乎无法在 javascript 中找到这 2 个实例。我在 chrome 检查元素中搜索了以下内容：

```
var img = new Image();
img.src = ""; 
```

但找到 0 个。该属性是否可能以不同的变体出现？如果是这样，请给我一些视觉示例，因为我不是真正的程序员也不是专家编码员。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T22:30:08.263

有 2 个`script`带有 empty 的标签`src`，在这种情况下它实际上不是空的，它指向根索引“/”，这也被认为是空的，因此被认为是性能损失。在 Chrome 上，访问 www.homelifepartners.com，查看源代码（在 Mac 上为 command+alt+u）然后搜索`src="/"`，您会找到它发生的 2 个实例。我不是 Joomla 专家，但尝试找出包含这些标签的插件（或某种插件）并尽快修复它。

# winforms - 带有复选框和可编辑字段的 ListView？

> ID：15819870
> 
> 赞同：0
> 
> 时间：2013-04-04T19:19:01.453
> 
> 标签：winforms, listview, .net-4.0, checkbox

我有一个看起来像这样的 ListView 表单：

![在此处输入图像描述](https://i.stack.imgur.com/091KP.png)

如何使每个单元格都像一个可编辑的文本框，以便用户可以通过单击单元格来编辑值？就像他们点击“计数”一样，文本编辑光标应该出现在原地，并且他们应该能够键入以更改字段的值（不在单独的对话框或文本字段中）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:55:45.787

*ListView*旨在灵活显示项目列表。类似于 Windows 资源管理器显示图标、缩略图、详细信息和基本列表的能力，所有这些都来自同一组对象。如果您真的想编辑数据对象中的所有元素，您可能应该阅读*DataGridView*和数据绑定。

# mysql - 撤销远程 IP 的访问

> ID：15819874
> 
> 赞同：4
> 
> 时间：2013-04-04T19:19:13.367
> 
> 标签：mysql

这个问题今天在工作中出现，我一直无法解决。MySQL 服务器 5.1.67

作为 mysql root 用户，我创建了一个数据库，用户并从远程 IP 授予了所有权限

mysql> 将`test`.* 上的所有权限授予由 'password' 标识的 'jane'@'56.44.3.24' ；

mysql> 刷新权限；

Jane 现在从另一个 IP 33.2.67.3 进来，所以我需要从她的旧 IP 中删除访问权限，并允许从她的新 IP 访问。在测试中，我尝试了以下方法，但简仍然可以从她的旧 IP 访问，在几个使用私有 IP 的 VM 上重新创建了场景。

mysql> 将`test`.* 上的所有权限撤消到由 'password' 标识的 'jane'@'56.44.3.24' ；

这是正确的语法吗？我错过了什么？

提前致谢

凯文

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T19:24:23.570

查看 REVOKE 的 MySQL 参考：http: [//dev.mysql.com/doc/refman/5.0/en/revoke.html](http://dev.mysql.com/doc/refman/5.0/en/revoke.html)。你想要一些类似的东西：

```
REVOKE ALL PRIVILEGES ON test.* FROM 'jane'@'56.44.3.24'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-11T08:37:42.873

根据[kevin-mcnally](https://stackoverflow.com/users/2246390/kevin-mcnally)的评论，我还必须做一个

```
mysql> DROP USER jane@'56.44.3.24'; 
```

为了将其从`mysql.user`列表中删除，并使其对我有用。

# mysql - 采购 MySQL 代码时出现错误 1215 和 1146

> ID：15819875
> 
> 赞同：3
> 
> 时间：2013-04-04T19:19:15.943
> 
> 标签：mysql, sql

我正在阅读 O'Reilly 出版的“Learning MySQL”一书，并尝试获取该书网站上发布的以下 SQL 代码：

```
DROP DATABASE IF EXISTS music;
CREATE DATABASE music;
USE music;

CREATE TABLE artist (
    artist_id SMALLINT(5) NOT NULL DEFAULT 0,
    artist_name CHAR(128) DEFAULT NULL,
    PRIMARY KEY  (artist_id)
);

CREATE TABLE album (
    artist_id SMALLINT(5) NOT NULL DEFAULT 0,
    album_id SMALLINT(4) NOT NULL DEFAULT 0,
    album_name CHAR(128) DEFAULT NULL,
    PRIMARY KEY  (artist_id,album_id),
    FOREIGN KEY (artist_id) REFERENCES artist(artist_id)
);

CREATE TABLE track (
    track_id SMALLINT(3) NOT NULL DEFAULT 0,
    track_name CHAR(128) DEFAULT NULL,
    artist_id SMALLINT(5) NOT NULL DEFAULT 0,
    album_id SMALLINT(4) NOT NULL DEFAULT 0,
    time DECIMAL(5,2) DEFAULT NULL,
    PRIMARY KEY  (artist_id,album_id,track_id),
    FOREIGN KEY (artist_id) REFERENCES artist(artist_id),
    FOREIGN KEY (album_id) REFERENCES album(album_id)
);

CREATE TABLE played (
    artist_id SMALLINT(5) NOT NULL DEFAULT 0,
    album_id SMALLINT(4) NOT NULL DEFAULT 0,
    track_id SMALLINT(3) NOT NULL DEFAULT 0,
    played TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP,
    PRIMARY KEY  (artist_id,album_id,track_id,played),
    FOREIGN KEY (artist_id) REFERENCES artist(artist_id),
    FOREIGN KEY (album_id) REFERENCES album(album_id),
    FOREIGN KEY (track_id) REFERENCES track(track_id)
);

-- And the whole bunch of data input into those tables. 
INSERT INTO played VALUES (1, 3, 0, "20060814102103");
INSERT INTO artist VALUES (1, "New Order");
INSERT INTO album VALUES (2, 1, "Let Love In");
INSERT INTO track VALUES (0,'Do You Love Me?',2,1,'5.95'); 
```

但是，当我尝试`SOURCE`MySQL 时，它给了我`ERROR 1215 (HY000): Cannot add foreign key constraint` 和`ERROR 1146 (42s02): Table 'music.track' doesn't exist`. 我一直在考虑这个问题。似乎有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:37:36.260

您的代码失败的原因是您在`album`and`track`表上有一个复合主键。为了允许成功创建外键，您必须为复合键的每一列为每个表添加另一个索引。

尝试修改每个表的代码以添加索引，如下所示。在`album`桌子上：

```
INDEX (album_id), 
```

在`track`桌子上：

```
INDEX (track_id), 
```

所以您的完整代码如下所示（不包括数据库创建和插入）：

```
CREATE TABLE artist (
    artist_id SMALLINT(5) NOT NULL DEFAULT 0,
    artist_name CHAR(128) DEFAULT NULL,
    PRIMARY KEY  (artist_id)
);

CREATE TABLE album (
    artist_id SMALLINT(5) NOT NULL DEFAULT 0,
    album_id SMALLINT(4) NOT NULL DEFAULT 0,
    album_name CHAR(128) DEFAULT NULL,
    PRIMARY KEY  (artist_id,album_id),
    INDEX (album_id),
    FOREIGN KEY (artist_id) REFERENCES artist(artist_id)
);

CREATE TABLE track (
    track_id SMALLINT(3) NOT NULL DEFAULT 0,
    track_name CHAR(128) DEFAULT NULL,
    artist_id SMALLINT(5) NOT NULL DEFAULT 0,
    album_id SMALLINT(4) NOT NULL DEFAULT 0,
    time DECIMAL(5,2) DEFAULT NULL,
    PRIMARY KEY  (artist_id,album_id,track_id),
    INDEX (track_id),
    FOREIGN KEY (artist_id) REFERENCES artist(artist_id),
    FOREIGN KEY (album_id) REFERENCES album(album_id)
);

CREATE TABLE played (
    artist_id SMALLINT(5) NOT NULL DEFAULT 0,
    album_id SMALLINT(4) NOT NULL DEFAULT 0,
    track_id SMALLINT(3) NOT NULL DEFAULT 0,
    played TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP,
    PRIMARY KEY  (artist_id,album_id,track_id,played),
    FOREIGN KEY (artist_id) REFERENCES artist(artist_id),
    FOREIGN KEY (album_id) REFERENCES album(album_id),
    FOREIGN KEY (track_id) REFERENCES track(track_id)
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:37:40.040

您的外键必须引用整个候选键。

```
CREATE TABLE track (
    track_id SMALLINT(3) NOT NULL DEFAULT 0,
    track_name CHAR(128) DEFAULT NULL,
    artist_id SMALLINT(5) NOT NULL DEFAULT 0,
    album_id SMALLINT(4) NOT NULL DEFAULT 0,
    time DECIMAL(5,2) DEFAULT NULL,
    PRIMARY KEY  (artist_id,album_id,track_id),
    FOREIGN KEY (artist_id) REFERENCES artist(artist_id),
    /* This won't work, not referencing an entire key: */
    /*FOREIGN KEY (album_id) REFERENCES album(album_id)*/
    /* This should work: */
    FOREIGN KEY (artist_id,album_id) REFERENCES album(artist_id,album_id)
); 
```

您必须在已播放的表中进行类似的更改。

[这是这些更改的 SqlFiddle](http://www.sqlfiddle.com/#!2/bdc53)，包括以正确的顺序插入数据，以及现有的键值。

还有一种想法是，如果`album_id`它是自己的候选键（它是唯一的），那么只需将其设为`album`. 那么，正如您所知道的那样，您不需要将`artist_id`列放在中。您也可以对其他子表 ( ) 执行此操作。`track``artist``track``album``played`

当然，如果您`track_id`在 an 上用作序数`album`（它不是唯一的，每个`album`可能都有 a `track_id`= 1），那么您应该坚持使用复合键，或者使用其他唯一约束来制作代理键。

考虑到它们仅适用于第一次插入，主键的默认值也令人费解。

# php - tinyMCE 不工作

> ID：15819876
> 
> 赞同：2
> 
> 时间：2013-04-04T19:19:20.990
> 
> 标签：php, html, tinymce, textarea

我正在用 PHP 和 MYSQL 构建一个站点。我已经将 tiny_mce 提取到 apache 的 htdocs 根文件夹中。现在目录就像`htdocs\jscripts\tiny_mce`.. 现在我已经包含了 tiny_mce.js 并编写了基本的 js 脚本。然后创建了一个包含`<textarea rows="12" cols="80" name="question" id="question">&nbsp;</textarea>`

但结果还是一样：我的浏览器显示带有提交按钮的普通文本区域。没有任何效果，并且没有实现文本缩进（即所见即所得）。

我在这个主题上搜索了很多，并在这个网站上找到了一篇文章：[tinymce implementation with php](https://stackoverflow.com/questions/15772441/tinymce-implementation-with-php)。

这篇文章的结论是我必须包含所有 js 文件。所以我做到了。但是有一个问题。tiny_mce 文件夹内还有另外四个文件夹（lang、themes、plugins、utils）和三个 js 脚本。所以我已经包含了所有这三个脚本，并且从这些文件夹中插件有 88 个文件夹，并且有大量的 js 脚本，所以不可能全部包含它们。

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html xmlns="http://www.w3.org/1999/xhtml">
 <head>
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
 <script type="text/javascript" src="../jscripts/tiny_mce/tiny_mce.js"></script>
 <script type="text/javascript" src="../jscripts/tiny_mce/tiny_mce_popup.js"></script>
 <script type="text/javascript" src="../jscripts/tiny_mce/tiny_mce_src.js"></script>
 <script type="text/javascript" src="../jscripts/tiny_mce/langs/en.js"></script>
 <script type="text/javascript" src="../jscripts/tiny_mce/utils/editable_selects.js"></script>
 <script type="text/javascript" src="../jscripts/tiny_mce/utils/form_utils.js"></script>
 <script type="text/javascript" src="../jscripts/tiny_mce/utils/form_utils.js"></script>
 <script type="text/javascript" src="../jscripts/tiny_mce/utils/mctabs.js"></script>
 <script type="text/javascript" src="../jscripts/tiny_mce/utils/validate.js"></script>
 <script type="text/javascript">
 tinyMCE.init({
 mode : "textareas"
 });
 </script>
 </head>
 <body>
 <form action="post.html.php" method="post">
    <input type="text" maxlength="200" name="title" value="" id="title" />
    <textarea rows="12" cols="80" name="question" id="question">&nbsp;</textarea>
    <input type="image" src="post.png" alt="post your que" name="post" value="post" />
    <input type="hidden" name="post" value="post" />
 </form>
 </body>
 <html> 
```

它仍然只显示一个普通的文本区域，并且没有实现文本缩进（即所见即所得）。我做错了什么？

**编辑 1：错误**

*   未捕获的类型错误：无法读取 null tiny_mce_popup.js:5 2 的属性“EditorManager”
*   未捕获的类型错误：无法读取未定义 form_utils.js:11 的属性“baseURI”
*   未捕获的类型错误：无法读取未定义 mctabs.js:13 的属性“windowManager”
*   对象{majorVersion：“3”，minorVersion：“5.8”，releaseDate：“2012-11-20”，_init：函数，is：函数...}

    wall.html.php:47

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:44:19.490

跳出来的第一件事是你的路径*可能*是错误的。尝试使用：

```
<script type="text/javascript" src="/jscripts/tiny_mce/tiny_mce.js"></script> 
```

或者输入绝对 URL。您只需要包含该文件，而不是所有其他文件。其他脚本通常是插件，您可以使用高级主题将其包括在内。其次，我现在要指定简单的主题：

```
tinyMCE.init({
    ...
    theme : "simple"
}); 
```

除此之外，使用 Firebug 尝试调试它。

# javascript - 为什么 JQuery-ui 对话框在更改动态内容时不保持布局？

> ID：15819882
> 
> 赞同：0
> 
> 时间：2013-04-04T19:19:44.350
> 
> 标签：javascript, jquery, jquery-ui, jquery-resizable

我正在尝试动态更改对话框的内容，但是当我更改为内容时，布局会更改。

基本上，我有一个......我从 jquery-ui 演示中获取并想要更改

使用 html();

这是我的 HTML

```
<div id="dialog" title="Basic dialog">
    <p>This is the default dialog which is useful for displaying information. The dialog window can be moved, resized and closed with the 'x' icon.</p>
    <br />

    <ul id="suggestions0">
        <li id="suggestion0-0" class="suggestion">BLO</li>
        <li id="suggestion0-1" class="suggestion">BLU</li>
        <li id="suggestion0-2" class="suggestion">BLL</li>
            <li id="suggestion0-3" class="suggestion">BOO</li>
    <li id="suggestion0-4" class="suggestion">CLA</li>
    </ul>
    <div id="footer">
        <span id="manual-0" class="manual">MANUAL</span><span id="next-0" class="next">Next</span>
    </div>
    <br />
</div> 
```

这就是我要展示的计划对话框。

我有2个按钮，如果我们点击OK，它只会显示当前对话框而不做修改，重要的是“li”元素在2行

像

BLO BLU BLL BOO CLA XXX ....

但是当我动态更改内容时，“li”元素在一行上对齐，而不是 2 更多。

我试图弄清楚我做错了什么。

这里是点击的 HTML

```
<body>

    <?prettify lang=java linenums=false?>
    <pre class='prettyprint' >
        <code>
            <span class="highlightOK" id="highlight-0">OK</span>***********************<span class="highlightNOTOK" id="highlight-1">NOT OK</span>

</body>

$('span.highlightOK').click(function() {
    setTimeout(function(){ $( "#dialog" ).dialog(); }, 100);;

});

$('span.highlightNOTOK').click(function() {

    $("#suggestions0").html("<li id='test0-1' class='suggestion'>BLO</li><li id='test0-2' class='suggestion'>BLO</li><li id='test0-3' class='suggestion'>BLO</li><li id='test0-4' class='suggestion'>BLO</li><li id='test0-5' class='suggestion'>BLO</li><li id='test0-6' class='suggestion'>BLO</li>");

    setTimeout(function(){ $( "#dialog" ).dialog(); }, 100);;

}); 
```

我在这里有一个现场演示 [http://jsfiddle.net/survivant/cyFxp/](http://jsfiddle.net/survivant/cyFxp/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T22:36:49.583

似乎在 li 元素之间添加换行符到动态 html 解决了这个问题

```
$("#suggestions0").html("<li id='test0-1' class='suggestion'>BLO</li>\n<li id='test0-2' class='suggestion'>BLO</li>\n<li id='test0-3' class='suggestion'>BLO</li>\n<li id='test0-4' class='suggestion'>BLO</li>\n<li id='test0-5' class='suggestion'>BLO</li>\n<li id='test0-6' class='suggestion'>BLO</li>"); 
```

[http://jsfiddle.net/Qjbb3/](http://jsfiddle.net/Qjbb3/)

# python - 创建一个时间戳，允许在由 pandas 中的列表组成的数据框中进行部分索引

> ID：15819885
> 
> 赞同：0
> 
> 时间：2013-04-04T19:20:02.900
> 
> 标签：python, list, timestamp, pandas, dataframe

我在 Pandas 中遇到时间戳选择问题。

对于我所看到的，这是其他人遇到的问题（[选择由 DatetimeIndex 索引的 Pandas DataFrame 的子集和 TimeStamps 列表](https://stackoverflow.com/questions/11991627/selecting-a-subset-of-a-pandas-dataframe-indexed-by-datetimeindex-with-a-list-of)），但不幸的是，Pandas 的开发人员拒绝接受它作为错误（[https://github. com/pydata/pandas/issues/2437](https://github.com/pydata/pandas/issues/2437)）。

在任何情况下，我都无法按照我上面引用的 SO 帖子提出的解决方法，因为我的数据不是以 CSV 文件的形式出现，而是在许多列表中（实际上我是从互联网通过 JSON 获取并转换那要列出）。

我得到的数据是这样的：

```
the_dataTransactions
[{u'date': u'1365100630', u'tid': 240264, u'price': u'132.58', u'amount': u'1.28309000'}, {u'date': u'1365100630', u'tid': 240263, u'price': u'132.58', u'amount': u'1.20294000'}, {u'date': u'1365100629', u'tid': 240262, u'price': u'132.58', u'amount': u'0.90893940'}] 
```

我将其转换为：

```
transactionsDate
[datetime.datetime(2013, 4, 4, 19, 37, 10), datetime.datetime(2013, 4, 4, 19, 37, 10), datetime.datetime(2013, 4, 4, 19, 37, 9)] 
```

我也试过这个，但是当我尝试选择一个数据范围时，结果中的错误是一样的：

```
transactionsDate
[<Timestamp: 2013-04-04 19:37:10>, <Timestamp: 2013-04-04 19:37:10>, <Timestamp: 2013-04-04 19:37:09>] 
```

tid、price 和 amount 也添加到数据框中，例如：

```
>>> transactionsDF.info()
<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 73 entries, 2013-04-04 19:37:10 to 2013-04-04 19:22:49
Data columns:
tid       73  non-null values
price     73  non-null values
amount    73  non-null values
dtypes: float64(2), int64(1)

>>> transactionsDF.head()
                        tid   price    amount
2013-04-04 19:37:10  240264  132.58  1.283090
2013-04-04 19:37:10  240264  132.58  1.283090
2013-04-04 19:37:10  240263  132.58  1.202940
2013-04-04 19:37:09  240262  132.58  0.908939
2013-04-04 19:37:09  240261  132.59  0.213051 
```

但是，当我尝试使用正常表示法选择数据范围时，我得到了与另一篇文章中报告的相同的错误：

```
>>> transactionsDF['2013-04-03 18:00:00':'2013-04-04 19:00:00']
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas/core/frame.py", line 1951, in __getitem__
    indexer = self.ix._convert_to_indexer(key, axis=0)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas/core/indexing.py", line 478, in _convert_to_indexer
    i, j = labels.slice_locs(start, stop)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas/tseries/index.py", line 1153, in slice_locs
    start_loc = self._get_string_slice(start).start
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas/tseries/index.py", line 1143, in _get_string_slice
    loc = self._partial_date_slice(reso, parsed)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas/tseries/index.py", line 1041, in _partial_date_slice
    raise TimeSeriesError('Partial indexing only valid for ordered '
pandas.tseries.index.TimeSeriesError: Partial indexing only valid for ordered time series. 
```

我的数据似乎是有序的时间序列。你能考虑在这种特殊情况下解决这个 Pandas 故障吗？

**更新（已解决？）：** 我找到了一种非常简单的方法，以至于我不完全确定它每次都会给出正确的答案，但至少对于一个小数据框来说它是有效的。代码只是：

```
transactionsDF = transactionsDF.sort_index() 
```

在这之后似乎工作正常，并允许我选择一个数据范围，就像我过去使用其他数据一样：transactionsDF['2013-04-04 19:30':'2013-04-04 19:35']

也许更有知识的人可能会验证或取消验证此解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:11:09.337

我认为没有真正优雅的解决方案。Pandas 不喜欢重复索引。（至少是我拥有的稍微旧的版本。）您可以创建具有重复索引的 DataFrame，但您无法轻松访问它们的内容。

因此，您应该将日期放在单独的列中。然后，您可以使用日期上的比较运算符和精美的索引来访问有趣的行：

```
In [1]: import pandas as pd

In [5]: import datetime

In [15]: f1 = pd.DataFrame([{u'date': u'1365100630', u'tid': 240264, u'price': u'132.58', u'amount': u'1.28309000'}, {u'date': u'1365100630', u'tid': 240263, u'price': u'132.58', u'amount': u'1.20294000'}, {u'date': u'1365100629', u'tid': 240262, u'price': u'132.58', u'amount': u'0.90893940'}])

In [16]: f1["dates"] = [datetime.datetime(2013, 4, 4, 19, 37, 10), datetime.datetime(2013, 4, 4, 19, 37, 10), datetime.datetime(2013, 4, 4, 19, 37, 9)]

In [17]: f1
Out[17]: 
       amount        date   price     tid                dates
0  1.28309000  1365100630  132.58  240264  2013-04-04 19:37:10
1  1.20294000  1365100630  132.58  240263  2013-04-04 19:37:10
2  0.90893940  1365100629  132.58  240262  2013-04-04 19:37:09

In [25]: matching = (f1["dates"] >= datetime.datetime(2013, 4, 4, 19, 37, 10)) & (f1["dates"] < datetime.datetime(2013, 4, 4, 20, 00, 00))

In [26]: f1.ix[matching]
Out[26]: 
       amount        date   price     tid                dates
0  1.28309000  1365100630  132.58  240264  2013-04-04 19:37:10
1  1.20294000  1365100630  132.58  240263  2013-04-04 19:37:10 
```

您也可以使用`f1[matching]`来访问有趣的行，但我觉得不太清楚，因为`f1["foo"]`用于访问列。

# mysql - 如何连接到其他主机上的 MySQL 守护程序？

> ID：15819888
> 
> 赞同：0
> 
> 时间：2013-04-04T19:20:08.323
> 
> 标签：mysql, remote-access, vps

我想通过 HeidiSQL 连接到 MySQL（deamon 在我的 VPS 上运行）。我创建了新用户，注释了绑定地址选项，当我尝试通过 HeidiSQL 连接它时，出现错误 2003: Can't connect to MySQL server on 'xxx.xxx.xxx.xxx' (10061 ）。我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:29:59.030

这可能是多种因素。

查看防火墙是否阻止了您到其他主机的流量

您可以简单地从客户端机器 ping 主机吗？

您还可以在端口 3306 上打开与主机的简单 telnet 会话吗？（如果 telnet 被接受，您可能会看到一些字符出现，并且您将在 telnet 会话中停留几秒钟，然后连接关闭。如果不接受，您将看到消息连接被拒绝。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:35:34.507

有一个简单的清单：

*   您的 MySQL 服务器是否仅绑定到“localhost”？它可能仅在 127.0.0.1 或 ::1 上侦听连接，而不是通常为 0.0.0.0 的任何连接。尝试使用您的网络 IP 地址`mysql --host=host_ip`在您的服务器上连接到您的服务器。`host_ip`我认为默认值是 localhost-only。
*   端口 3306 是否有防火墙？许多发行版默认只允许 SSH，因此您可能需要将其打开到您的客户端计算机。尽量不要在互联网上向所有人开放，因为开放 MySQL 端口是自找麻烦。如果可能，最好限制对一组特定 IP 的访问。
*   您可以改为通过 SSH 隧道连接吗？这更安全，因为这意味着您的 3306 端口已正确防火墙。创建 SSH 隧道的工具有很多，但基本原理是将您选择的本地端口转发到远程服务器的 3306 端口。

# javascript - 好的 javascript 语法荧光笔

> ID：15819889
> 
> 赞同：0
> 
> 时间：2013-04-04T19:20:15.920
> 
> 标签：javascript, html

我想知道那里是否有一个简单的 JS 语法荧光笔？

我不希望行号或任何所见即所得按钮只是简单地突出显示 MySQL。

我看了一些，它们都太复杂了。我需要一个可编辑的文本区域类型框。我还需要能够使用 PHP 获取其文本，就像表单中的输入框一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:33:15.743

你可以试试[王牌编辑器](http://ace.ajax.org/#nav=about)。Github、CodeAcademy、KhanAcademy、Cloud9 IDE……他们都在使用它，它是一个高性能的编辑器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T19:25:09.103

我以前用过一些，这里有一些很好的。

*   [http://softwaremaniacs.org/soft/highlight/en/](http://softwaremaniacs.org/soft/highlight/en/)
*   [http://google-code-prettify.googlecode.com/svn/trunk/README.html](http://google-code-prettify.googlecode.com/svn/trunk/README.html)

希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T19:24:13.263

你看过这个 - [http://thecodeplayer.com/walkthrough/mysql-syntax-highlighter-javascript-regex](http://thecodeplayer.com/walkthrough/mysql-syntax-highlighter-javascript-regex)吗？

就像在 SO 上回答一样，您可能需要有一个用户可以输入的原始输入文本区域，以及显示突出显示语法的第二个字段（否则，当您接受文本时，您将不得不去掉突出显示）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T19:32:36.360

您可以尝试其中一种

[1]： http: [//softwaremaniacs.org/soft/highlight/en/](http://softwaremaniacs.org/soft/highlight/en/)

[2]：[http ://www.textpad.com/](http://www.textpad.com/)

# objective-c - 让 Objective-C 方法返回任何东西

> ID：15819890
> 
> 赞同：0
> 
> 时间：2013-04-04T19:20:17.447
> 
> 标签：objective-c, nsdata, nserror

`statusCode`我在下面使用此方法从 URL 获取数据，但如果不等于 200 ，我想让它返回错误。

```
+ (NSData *)getData:(NSString *) url {
    NSURL *urlNS = [[NSURL alloc] initWithString:url];
    NSURLRequest * urlRequest = [NSURLRequest requestWithURL:urlNS];
    NSError * error = nil;
    NSHTTPURLResponse* urlResponse = nil;
    NSData * data = [NSURLConnection sendSynchronousRequest:urlRequest returningResponse:&urlResponse error:&error];
    int statusCode = [urlResponse statusCode];
    if(statusCode == 200) {
        return data;
    } else {
        //return the error object which is not NSData or which is converted to NSData
    }
} 
```

**我的问题**

我可以以某种方式在非 NSData 对象中返回我的错误**（它将是上面定义的错误变量）**，还是可以将我的错误转换为 NSData？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-04T19:26:25.883

通常的约定是如果出现错误则返回 nil。

如果你还想提供一个错误，通常的做法是通过间接（`NSError**`）提供一个额外的参数。

例子：

```
+ (id)stringWithContentsOfFile:(NSString *)path encoding:(NSStringEncoding)enc error:(NSError **)error 
```

> **返回值**
> 
> 通过使用编码 enc 从路径命名的文件中读取数据创建的字符串。如果文件无法打开或存在编码错误，则返回 nil。

Cocoa 大量使用了这种*模式*。

# java - 黑客使 ReflectionFactory 工作（重新打包）

> ID：15819897
> 
> 赞同：2
> 
> 时间：2013-04-04T19:20:45.297
> 
> 标签：java, google-app-engine

我知道 GAE 是一个非常严格的平台；它限制了对类的访问，例如`sun.reflect.ReflectionFactory`

但是，许多库依赖于这些包，但在 GAE 平台中是不允许的。现在我试图查看 sun.reflect 包，似乎大多数类都有依赖项`java.lang.reflect`，我认为大多数类都被列入白名单。

因此，如果我们可以包含这些`sun.reflect`包并可能将其重新打包为其他名称，我想这可能是一种解决方法？

*   重命名列入黑名单的软件包是否可以与 GAE 一起使用？
*   是否有任何 sun.reflect.ReflectionFactory 的实现经过调整以在 GAE 平台上运行？
*   使这项工作有哪些选择？

**更新：**

我发现与此相关的 appengine 问题跟踪中提交的问题：

[https://code.google.com/p/googleappengine/issues/detail?id=1877](https://code.google.com/p/googleappengine/issues/detail?id=1877)

然而，在我看来，这个请求从未被批准。

以下是与此相关的跟踪项目的其他问题：

[https://code.google.com/p/objenesis/issues/detail?id=12](https://code.google.com/p/objenesis/issues/detail?id=12)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-09T09:55:05.740

没有了。`ReflectionFactory`依赖于`native`通过加载本机库绑定的方法。即使您将类复制到另一个名称空间，您也必须加载相关库，这比访问`ReflectionFactory`.

# java - Maven cli 给出语法错误，但在 eclipse 中是可以的。java语法正确吗？真的很奇怪

> ID：15819898
> 
> 赞同：0
> 
> 时间：2013-04-04T19:20:57.527
> 
> 标签：java, eclipse, maven, compiler-errors

我的 java 应用程序中有一个非常奇怪的问题。我正在用 maven 构建它并在 Eclipse IDE 中开发它。这可能是一个有点冗长的解释，但请坚持到最后，因为问题真的很奇怪，我不知道可能是什么原因。

这是我正在编写的代码示例：

假设我们有一个“处理程序”接口。它可以处理特定的对象类型：

```
public interface Handler<T> {
    public void handle(T obj);
} 
```

现在假设我们想要处理程序链接。我们可以这样做：

```
public class HandlerChain<T> implements Handler<T> {

private Handler<? super T> h;

@Override
public void handle(T obj) {
            //h can handle T objects
    h.handle(obj);  
}

private HandlerChain(Handler<? super T> h) {
    super();
    this.h = h;
}

    //syntax sugar to start the chain
public static <T> HandlerChain<T> start(Handler<? super T> h){
    return new HandlerChain<T>(h);      
}

    //add another handler to the chain
public HandlerChain<T> next(final Handler<? super T> handler){
    return new HandlerChain<T>(new Handler<T>() {
        @Override
        public void handle(T obj) {
            h.handle(obj);
            handler.handle(obj);                
        }
    });     
}

} 
```

现在让我们为字符串处理程序创建一些处理程序工厂：

```
 public class Handlers {
public static Handler<String> h1(){
    return new Handler<String>(){

        @Override
        public void handle(String obj) {
            // do something

        }

    };
}

public static Handler<String> h2(){
    return new Handler<String>(){

        @Override
        public void handle(String obj) {
            // do something

        }

    };
}
} 
```

所以最后我们创建了一个类，使用链中的两个处理程序来处理一些字符串：

```
public class Test { 
public void doHandle(String obj){
    HandlerChain.start(Handlers.h1()).next(Handlers.h2()).handle(obj);
}
} 
```

所以，对我来说，这段代码似乎没有错。Eclipse IDE 也不介意。它甚至正确地运行它。但是，当我尝试使用 cli 中的 maven 编译此代码时，出现错误：

```
Test.java:[7,50] next(Handler<? super java.lang.Object>) in HandlerChain<java.lang.Object> cannot be applied to (Handler<java.lang.String>) 
```

有没有人偶然发现类似的问题？我真的很想知道这种语法在java中是否有效，或者这是由于设置错误或其他原因导致的一些奇怪的编译器错误？要重复 Eclipse 编译并正确运行此代码，但 maven cli 无法编译它。

最后，这是我在 pom.xml 中的 maven-compiler-plugin 设置。它可能与整个问题有关。

```
 <plugin>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>3.0</version>
        <executions>
          <execution>
            <id>default-testCompile</id>
            <phase>test-compile</phase>
            <goals>
              <goal>testCompile</goal>
            </goals>
            <configuration>
              <encoding>UTF-8</encoding>
              <source>1.6</source>
              <target>1.6</target>
            </configuration>
          </execution>
          <execution>
            <id>default-compile</id>
            <phase>compile</phase>
            <goals>
              <goal>compile</goal>
            </goals>
            <configuration>
              <encoding>UTF-8</encoding>
              <source>1.6</source>
              <target>1.6</target>
            </configuration>
          </execution>
        </executions>
        <configuration>
          <encoding>UTF-8</encoding>
          <source>1.6</source>
          <target>1.6</target>
        </configuration>
      </plugin> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T09:48:41.123

> 有没有人偶然发现类似的问题？

是的，并且在使用泛型类型进行奇怪和不寻常（可能不正确）的事情时也是如此。

问题是 Eclipse 编译器没有报告那些奇怪的结构的编译错误，而`javac`Sun JDK 的标准抱怨类型擦除。（它与 JDK 1.6 一起使用）。（如果我没记错的话：eclipse report a only a warning）

我的解决方案是设置 maven 以使用 eclipse 编译器。另一个（更好的）选项是修复代码，但由于这是一项非常复杂的任务，而且我在运行时没有任何问题，所以我选择了“快速而肮脏”的第一个选项。

以下是如何设置编译器：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <configuration>
            <source>${compiler.source}</source>
            <target>${compiler.target}</target>
            <encoding>${source.encoding}</encoding>
            <fork>false</fork>
            <compilerId>jdt</compilerId>
    </configuration>
    <dependencies>
            <dependency>
                    <groupId>org.eclipse.tycho</groupId>
                    <artifactId>tycho-compiler-jdt</artifactId>
                    <version>0.13.0</version>
            </dependency>
    </dependencies>
</plugin> 
```

# wordpress - 所见即所得的自动摘录

> ID：15819899
> 
> 赞同：1
> 
> 时间：2013-04-04T19:21:03.047
> 
> 标签：wordpress, wysiwyg

是否可以抓取所见即所得编辑器的内容并将前 100 个单词自动保存到摘录中？我知道`excerpt_save_pre`当您在编辑器中时哪个会保存摘录，但还没有看到任何可以从所见即所得编辑器中获取内容的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:53:21.880

我已经想通了。“秘密”`&$_POST`是保存/发布帖子的时间。这构建了一个数组，可以提取其中的内容，然后使用`excerpt_save_pre`.

我进一步允许控制字符数或单词数，使用`$length`，并且输出由`$output`您取消注释的部分控制。

下面的代码在我的原版网站上测试为有效。

```
function auto_insert_excerpt(){
$post_data = &$_POST;
$post_content = $post_data['content'];
$length = 15;

// This will return the first $length number of CHARACTERS
//$output = (strlen($post_content) > 13) ? substr($post_content,0,$length).'...' : $post_content;

// This will return the first $length number of WORDS
$post_content_array = explode(' ',$post_content);
if(count($post_content_array) > $length && $length > 0)
    $output = implode(' ',array_slice($post_content_array, 0, $length)).'...';

return $output;
}
add_filter('excerpt_save_pre', 'auto_insert_excerpt'); 
```

# javascript - 当浏览器模式为 IE9 时，如何从 JS 中检测 IE10？

> ID：15819904
> 
> 赞同：5
> 
> 时间：2013-04-04T19:21:19.380
> 
> 标签：javascript, internet-explorer, cross-browser, internet-explorer-10

尽管设置了浏览器模式，但当浏览器为 IE10 时，我只需要使用纯 JavaScript（无框架）进行检测。

一些评论： - 我确实需要检测浏览器，它不是仅检测功能的选项，因为目的是减轻浏览器错误。- 我尝试了常见的方法（如 UA 字符串或功能检测）但没有成功，当我将浏览器模式切换到 IE9 时，可能暗示在 IE10 中的所有方面都消失了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-04T19:52:37.580

如果您想检测您正在使用的浏览器，IE 有一个特殊功能，称为条件编译 - [http://www.javascriptkit.com/javatutors/conditionalcompile.shtml](http://www.javascriptkit.com/javatutors/conditionalcompile.shtml)

要获取版本，您可以使用`@_jscript_version`. 所以在Javascript中，我会使用：

```
<script type="text/javascript">
    var isIE10 = false;
    /*@cc_on
        if (/^10/.test(@_jscript_version)) {
            isIE10 = true;
        }
    @*/
    console.log(isIE10);
</script> 
```

我没有 IE10，但是用 IE9 测试时，它似乎可以工作。如果我将浏览器模式更改为 7 或 8，`@_jscript_version`则具有真正的浏览器 JScript 版本（与`9`我的情况一样）。

要查看 JScript 版本列表，您可以在此处查看它们 - [http://en.wikipedia.org/wiki/JScript#Versions](http://en.wikipedia.org/wiki/JScript#Versions)。它没有列出 IE10，但我假设它是 10。在 IE9 之前，他们使用的数字与浏览器版本不一致，但从 9 开始可能就在正确的轨道上。你必须看看`@_jscript_version`默认情况下 10 是什么，但我假设它以“10”开头并且可能有一个次要版本。

* * *

**更新：**

为避免缩小评论，您可以使用以下内容：

```
var IE = (function () {
    "use strict";

    var ret, isTheBrowser,
        actualVersion,
        jscriptMap, jscriptVersion;

    isTheBrowser = false;
    jscriptMap = {
        "5.5": "5.5",
        "5.6": "6",
        "5.7": "7",
        "5.8": "8",
        "9": "9",
        "10": "10"
    };
    jscriptVersion = new Function("/*@cc_on return @_jscript_version; @*/")();

    if (jscriptVersion !== undefined) {
        isTheBrowser = true;
        actualVersion = jscriptMap[jscriptVersion];
    }

    ret = {
        isTheBrowser: isTheBrowser,
        actualVersion: actualVersion
    };

    return ret;
}()); 
```

并访问`IE.isTheBrowser`和`IE.actualVersion`（从 JScript 版本的内部值转换而来）之类的属性。

# javascript - 在 javascript 中处理 JSON 服务器响应

> ID：15819910
> 
> 赞同：0
> 
> 时间：2013-04-04T19:21:39.707
> 
> 标签：javascript, ajax, json, jsp

我见过很多类似的问题，但他们没有为我的问题提供答案。我的服务器形成 JSON 字符串并将其放入响应中：

```
List<String> list = getSomeList();
JSONArray jsArray = new JSONArray(list);
System.out.println(jsArray);
response.setContentType("application/json");
response.getWriter().write(jsArray.toString()); 
```

但是在我的javascript句柄函数中，当我提醒响应时，它会提醒所有页面！

```
function handleResponse(){    
 if(http.readyState == 4 && http.status == 200){  
  var response = http.responseText;
   if(response){ 
     alert(response); //alert all page!
     var list = JSON.parse(response.toJSON()); //doesn't work! 
 }       
} 
```

**问题**：如何在 javascript 中仅分离 jsArray？

**PS**据我了解，我的 JSON.parse(response.toJSON()) 不起作用，因为响应包含整个页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:40:15.647

免责声明：我不知道java。

在服务器端，问题可能是您的响应在写入 JSON 数组后没有关闭，允许写入其他 (html) 文本。试试这个：

```
response.setContentType("application/json");
response.getWriter().write(jsArray.toString());
response.getWriter().close(); 
```

在客户端，responseText 是一个字符串，而字符串没有定义 toJSON() 函数。

```
var list = JSON.parse(http.responseText); 
```

应该足够了。

# c - C程序中的出队

> ID：15819912
> 
> 赞同：1
> 
> 时间：2013-04-04T19:21:44.143
> 
> 标签：c, queue, implementation

```
client removeClient (client cList,int pos)
{
int i,data;
data=cList[0];  **
pos=pos-1;
for (i=0;i<pos;i++)
{
    cList[i]=cList[i+1]; **
}
return data;

}/* end module*/ 
```

我的代码的这一部分有点麻烦。**-> 在这些行中，我收到错误消息...下标值既不是数组也不是指针也不是向量。这意味着什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:23:51.643

您正在传递一个标量值，传递一个指针会有所帮助

```
client removeClient (client* cList,int pos){ } 
```

这样，您可以将数组传递给您的函数。

使用调用函数

```
client result = removeClient(clientQueue, index); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:36:45.177

只需添加一些附加点到@bash.d 答案：

从您之前的问题中知道，您正在尝试从客户端数组中删除第一个元素（客户端）。

```
client removeClient (client* cList,int pos)
{
 int i;
 client data=cList[0];  // data is client type
 pos=pos-1;
 for (i=0;i<pos;i++)
 {
    cList[i]=cList[i+1]; 
 }
 return data;
} 
```

请记住，这 `data`不是 int 而是客户端类型（阅读评论）并且您应该在 main 中调用此函数：

```
client date;
data = removeClient ( clientQueue,pos); 
```

# java - 在不使用注释的情况下创建自定义 Java 编译器错误

> ID：15819918
> 
> 赞同：1
> 
> 时间：2013-04-04T19:22:10.750
> 
> 标签：java, compiler-errors, apt

有没有办法在不进行注释的情况下向编译器添加处理器？

基本上，如果用户没有正确实现接口（即未满足后置条件），我希望构建失败。在编译时，我想检查一个类是否实现了一个接口，如果是，运行一些代码来检查实现是否正确。

例如，我想确保实现 getErrorMoniker() 的类在 camelCase 中返回一个字符串。

```
public interface MyError {
  public String getErrorMoniker();
}

public class MyErrorImplemented1 {
  @Override
  public String getErrorMoniker() { return "goodErrorMoniker"; }
}

public class MyErrorImplemented2 {
  @Override
  public String getErrorMoniker() {
    return "BADERRORMONIKER"; // I would like a compile error here
  }
} 
```

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:31:03.313

理论上，带有注释的处理器`@SupportedAnnotationTypes("*")`应该能够处理所有源文件，因为它也适用于空的注释集。从[文档](http://docs.oracle.com/javase/6/docs/api/javax/annotation/processing/Processor.html)中：

> 如果不存在注释类型，注释处理仍会发生，但只有支持处理“*”的通用处理器才能声明（空）注释类型集。

尽管您的目标是检查返回值可能不起作用，因为这发生在编译时，而不是运行时。

# java - 我在哪里可以找到多种语言的正则表达式的单元测试？

> ID：15819919
> 
> 赞同：80
> 
> 时间：2013-04-04T19:22:11.787
> 
> 标签：java, php, javascript, .net, regex

我正在[http://www.debuggex.com](http://www.debuggex.com)构建一个正则表达式助手。我想展示的细节量需要我编写自己的解析器和匹配器。

为了确保我的解析器和匹配器正常工作，我为正则表达式的 Javascript 风格编写了自己的单元测试，但这些只涵盖了我所知道的边缘情况。我想使用一个标准的测试套件，最近有人指出我将使用[http://hg.ecmascript.org/tests/test262/summary 。](http://hg.ecmascript.org/tests/test262/summary)

我的问题是，我在哪里可以找到其他正则表达式风格的测试套件？我想在未来支持其他口味。我无法通过谷歌搜索找到任何东西（“测试”会污染正则表达式测试器的结果）。我正在寻找语言**python**、**php**、**perl**、**java**、**ruby**​​ 和**.net**的测试套件。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-04-04T23:30:08.063

这些语言中的大多数都是开源的。任何体面的项目都应该在所说的 repo 中有他们的测试用例，否则我会非常担心。

*   [Python](http://hg.python.org/cpython/file/178075fbff3a/Lib/test/re_tests.py)的正则表达式测试
*   [PHP](https://github.com/php/php-src/tree/master/ext/pcre/tests)的正则表达式测试
*   [Perl](http://perl5.git.perl.org/perl5.git/tree/HEAD:/t/re)的正则表达式测试看起来非常广泛
*   [打开 JDK](http://hg.openjdk.java.net/jdk7u/jdk7u6/jdk/file/8c2c5d63a17e/test/java/util/regex/)的单元测试（Java 的一种开源风格）
*   [Ruby](https://github.com/ruby/ruby/blob/master/test/ruby/test_regexp.rb)的正则表达式测试
*   [Mono](https://github.com/mono/mono/tree/0f2995e95e98e082c7c7039e17175cf2c6a00034/mcs/class/System/Test/System.Text.RegularExpressions)的正则表达式测试（.NET 的开源版本）
*   [.NET Core](https://github.com/dotnet/runtime/tree/master/src/libraries/System.Text.RegularExpressions/tests)的正则表达式测试
*   [RE2](https://github.com/google/re2/tree/master/re2/testing)的测试（Google 开发的 C++ 正则表达式引擎）
*   [C](https://github.com/att/ast/tree/2012-08-01-master/src/cmd/re)测试套件（由 AT&T Research 开发）
*   [PCRE](http://vcs.pcre.org/pcre2/code/trunk/testdata/)正则表达式测试（Perl 兼容正则表达式 C 库）
*   [JavaScript](https://github.com/tc39/test262/tree/master/test/built-ins/RegExp)正则表达式测试（Ecma Technical Committee 39 兼容性套件）

我还在[此页面](http://www.regular-expressions.info/refflavors.html)上找到了一个详尽的图表，可能对您有所帮助。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-04-05T18:13:28.130

为了在一页上有完整的列表，我发现了从接受的答案中省略的那些：

*   [Mono 的](https://github.com/mono/mono/tree/0f2995e95e98e082c7c7039e17175cf2c6a00034/mcs/class/System/Test/System.Text.RegularExpressions)正则表达式测试（它是 .net 的开源版本）
*   [PHP 的](https://github.com/php/php-src/tree/master/ext/pcre/tests)正则表达式测试

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-31T08:37:12.717

其他语言的其他正则表达式测试套件：

*   [D 的标准库正则表达式测试](https://github.com/dlang/phobos/tree/master/std/regex/internal)（查找`tests.*d`文件）
*   [Go 的正则表达式测试](https://golang.org/src/regexp/)（查找`.*test.*go`文件）
*   [GNU grep 的测试](http://git.savannah.gnu.org/cgit/grep.git/tree/tests)（命令行 C 正则表达式引擎）
*   [regex-posix-unittest](https://wiki.haskell.org/Regex_Posix#regex-posix-unittest)（用 Haskell 编写的 POSIX 正则表达式测试套件）
*   [ICU 的正则表达式测试](https://github.com/unicode-org/icu/tree/master/icu4c/source/test/testdata)（Unicode 的 C/C++ 和 Java 库，查找名为 的文件`re[_g].*txt`）
*   [Rust 的正则表达式测试](https://github.com/rust-lang/regex/tree/master/tests)
*   [TCL 的正则表达式测试](https://github.com/tcltk/tcl/tree/master/tests)（查找`reg.*test`文件）
*   [TRE 的正则表达式测试](https://github.com/laurikari/tre/tree/master/tests)（旨在严格遵守 POSIX 的 C 正则表达式引擎）
*   [V8 的正则表达式测试](https://chromium.googlesource.com/v8/v8/+/master/test/mjsunit/)（V8 是 Chrome 的 JavaScript 引擎，搜索名为 的文件`.*regexp.*js`）
*   [WebKit 的正则表达式测试](https://trac.webkit.org/browser/trunk/LayoutTests/fast/regex)（JavaScript 测试在 script-tests 文件夹中）
*   [Yarr 的正则表达式测试](https://trac.webkit.org/browser/trunk/JSTests/regexp/RegExpTest.data)（WebKit 的 JavaScriptCore 的 C++ 正则表达式引擎）

## 奖金

*   [Regfuzz](https://code.google.com/p/regfuzz/)（用于使用随机生成和无效的正则表达式测试正则表达式稳健性的 C 工具包）

# php - 在 PHP 中处理动态数量的表单字段的最佳方法？

> ID：15819920
> 
> 赞同：7
> 
> 时间：2013-04-04T19:22:15.867
> 
> 标签：php, html, forms, laravel, laravel-3

我有一个系统，我需要为一周中的每一天列出任意数量的员工，其中可以输入“工作时间”值。

所以我需要生成一个动态行数的表，每行将包含 7 个文本字段。我只是想知道在将 ID 分配给这些字段时使用的最佳约定是什么，以便在我在后端收到输入数据后轻松迭代？

每行都有一个与代表员工 ID 的行相关联的 ID 号。

能够做类似的事情会很棒：

```
foreach($rows as $row)
{
     $id = $row['id'];

     $employee = Employee::find($id);

     foreach($row['hoursWorked'] as $dailyHours)
     {
           $timecard = new Timecard();
           $timecard->hours = $dailyHours;
           $employee->timecards->insert($timecard);
     }
} 
```

在 HTML 端构建表单和 ID 输入以使其尽可能轻松的最佳方式是什么？

作为旁注，我正在 Laravel 3 框架内工作，以防打开任何其他解决方案。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-04T19:27:52.440

`<input type="text" name="hoursWorked[]" />`将在内部转换为`$_POST['hoursWorked']`. 这意味着您可以执行以下操作：

```
<input type="text" name="hoursWorked[12345][]" /> <!-- Sunday -->
<input type="text" name="hoursWorked[12345][]" /> <!-- Monday -->
<input type="text" name="hoursWorked[12345][]" /> <!-- Tuesday -->
<input type="text" name="hoursWorked[12345][]" /> <!-- Wednesday -->
<input type="text" name="hoursWorked[12345][]" /> <!-- Thursday -->
<input type="text" name="hoursWorked[12345][]" /> <!-- Friday -->
<input type="text" name="hoursWorked[12345][]" /> <!-- Saturday --> 
```

然后，在 PHP 中：

```
<?php
foreach ($_POST['hoursWorked'] as $employeeId=>$dayArray) {
    foreach ($dayArray as $dayOfWeek=>$hoursWorked) {
        // $employeeId will be 12345
        // $dayOfWeek will be 0, 1, 2, 3, 4, 5 ,6
        // $hoursWorked will be the value of the text field
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:29:07.047

我从未使用过 Laravel 框架，但通常我在 PHP 中执行此操作：

```
foreach ($employee as $key=>$e) {
   echo '<input type="text" name="hours[]" id="hours_'.$key.'" value="'.$e.'" />';
} 
```

这样，您将在 POST 中有一个小时值数组，如果需要，您可以通过 id 引用相应的字段。第一个字段将具有 id="hours_1" 等。或者，如果您不想使用查询中的 $key，您可以这样做：

```
$cntr = 1;
foreach ($employee as $e) {
   echo '<input type="text" name="hours[]" id="hours_'.$cntr.'" value="'.$e.'" />';
   $cntr++;
} 
```

当您捕获 POST 中的值时，您将在`$_POST['hours']`. 请记住，它是一个从零开始的数组，但您可以使用 foreach 循环遍历这些值。

# symfony - 生成学说 2 实体时出错

> ID：15819922
> 
> 赞同：2
> 
> 时间：2013-04-04T19:22:19.817
> 
> 标签：symfony, doctrine-orm, symfony-2.1

我已经在我的项目创建中创建了最初的实体，现在有一个我想为其自动映射单个实体的表。

我跑了：`php app/console doctrine:mapping:convert xml ./src/MyBundle/Resources/config --from-database --filter="clicks"`

并得到：

```
No Metadata Classes to process. 
```

我希望只生成一个表“点击”的实体

谁能向我解释为什么会发生这种情况以及如何使该命令起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:05:21.423

如果您之前已成功使用此命令生成实体，它应该可以正常工作。

当表实际上不存在于数据库中时，您会收到此错误。

仔细检查表“点击”是否在数据库中。

# java - Eclipse JDT 编译器 (ECJ) 在 Java 1.7 中抛出 NPE

> ID：15819926
> 
> 赞同：0
> 
> 时间：2013-04-04T19:22:32.073
> 
> 标签：java, compiler-construction, nullpointerexception, java-7, eclipse-jdt

在 JRE 1.7 中运行时，我从 ECJ（版本 4.2.1）编译器获得 NPE，相同的项目在 JRE 1.6 上正确编译。

监视器显示总共`CompilationProgress`有 2493 个任务，但随后我得到了 NPE。

有任何想法吗？

TIA

```
java.lang.NullPointerException
    at org.eclipse.jdt.internal.compiler.apt.util.EclipseFileManager.concatFiles(EclipseFileManager.java:202)
    at org.eclipse.jdt.internal.compiler.apt.util.EclipseFileManager.handleOption(EclipseFileManager.java:669)
    at org.eclipse.jdt.internal.compiler.apt.dispatch.BatchProcessingEnvImpl.(BatchProcessingEnvImpl.java:88)
    at org.eclipse.jdt.internal.compiler.apt.dispatch.BatchAnnotationProcessorManager.configure(BatchAnnotationProcessorManager.java:69)
    at org.eclipse.jdt.internal.compiler.batch.Main.initializeAnnotationProcessorManager(Main.java:3632)
    at org.eclipse.jdt.internal.compiler.batch.Main.performCompilation(Main.java:3737)
    at org.eclipse.jdt.internal.compiler.batch.Main.compile(Main.java:1679)
    at org.eclipse.jdt.internal.compiler.batch.Main.compile(Main.java:1372)
    at org.eclipse.jdt.core.compiler.batch.BatchCompiler.compile(BatchCompiler.java:80)
    at org.eclipse.jdt.core.compiler.batch.BatchCompiler.compile(BatchCompiler.java:52)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
...
    at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T18:31:42.750

看起来异常是在命令行参数处理内部引起的。具体在`-extdirs`选项上。该`locations`对象为空，唯一的方法是如果该`close()`方法已经在`EclipseFileManager`. 我不明白为什么，但我建议您获取源代码并在调试器中启动它。

我知道这并不是真正的答案，但希望这至少可以让您更接近解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T00:29:15.417

我随机猜测您遇到了我在使用 ECJ 时遇到的 Windows 问题，其中命令行变得太长，Windows 无法处理。

为我解决的问题是将类路径单独放在文本文件中并将其传递给 ECJ，但您应该能够将所有选项添加到文本文件并传递它，这样长期来看会更安全（请参阅“高级选项”@ [http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.jdt.doc.user%2Ftasks%2Ftask-using_batch_compiler.htm](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.jdt.doc.user%2Ftasks%2Ftask-using_batch_compiler.htm)），类似于：

*   ecj-options.txt

    `-g -1.6 -extdirs "F:/Workspace/git/igal-getrailo/railo-java/libs;C:\Apps\railo-builder\webapps\ra‌​ilo-builder\WEB-INF\railo\lib\compile" -sourcepath F:/Workspace/git/igal-getrailo/railo-java/railo-loader/src[-d none] -d F:/Workspace/railo-build/railo-4.0.5.001-patch-d/__railo-core-bin`

然后将@ecj-options.txt 添加到参数中，例如：

`java -jar ecj.jar @ecj-options.txt F:/Workspace/railo-build/railo-4.0.5.001-patch-d/__railo-core-src`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T16:13:11.910

原来是一个 Eclipse JDT 错误： [https ://bugs.eclipse.org/bugs/show_bug.cgi?id=405225](https://bugs.eclipse.org/bugs/show_bug.cgi?id=405225)

希望它会在下一个版本中得到修复。

# c# - 在 DataPager 中获取活动号码页

> ID：15819928
> 
> 赞同：3
> 
> 时间：2013-04-04T19:22:35.750
> 
> 标签：c#, asp.net, listview, webforms, datapager

我在 ListView 控件中有 LinkBut​​ton，我想通过单击 LinkBut​​ton 在 DataPager 中获取活动数字页面。

```
protected void addToCart_Click(object sender, CommandEventArgs e)
{
    //get active number page
} 
```

请帮我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T19:29:50.020

假设您正在执行此操作，您可以执行以下操作`asp.net`

```
protected void ListView1_PagePropertiesChanging(object sender,PagePropertiesChangingEventArgs e)    
{
    int currPage = (e.StartRowIndex / e.MaximumRows)+1;
    Response.Write(currPage.ToString());
} 
```

# android - 片段和活动之间的通信流

> ID：15819929
> 
> 赞同：1
> 
> 时间：2013-04-04T19:22:35.700
> 
> 标签：android, android-fragments

我正在尝试制作一个简单的提醒应用程序。创建新提醒时，我有以下设置：

1.  *MainEditActivity.java*：以下片段的 2 个占位符 FrameLayouts：
    *   *编辑名称片段.java*
        *   自定义操作栏（取消、确定按钮）
        *   提醒名称的 EditText
        *   CheckBox 切换以下片段之一
    *   *EditDateFragment.java* **或** *EditLocationFragment.java*（两者都有很多视图）

***MainEditActivity.java：***

```
 private LocationFragment mLocationFragment;
    private DateFragment mDateFragment;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);

          setContentView(R.layout.activity_new_remainer_main); // 2 frame layouts
          if (savedInstanceState == null) {
            Fragment newFragment = new NewReminderFragment();
            FragmentTransaction ft = getFragmentManager().beginTransaction();
            ft.add(R.id.reminder_title_fragment, newFragment).commit();

            mDateFragment = new DateFragment();
            ft = getFragmentManager().beginTransaction();
            ft.add(R.id.date_or_location_fragment, mDateFragment).commit();
         }
    }

    public void onCheckBoxClick(View view) 
    {
       FragmentManager fragmentManager = getFragmentManager();
       FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();   
       if(mLocationFragment == null)
         mLocationFragment = new LocationFragment();

       CheckBox checkBox = (CheckBox)findViewById(R.id.checkBoxID);
       if(checkBox != null)
       {
         if(checkBox.isChecked()) {
           fragmentTransaction.replace(R.id.date_or_location_fragment, mLocationFragment);
        } else {
            fragmentTransaction.replace(R.id.date_or_location_fragment, mDateFragment);
        }
        fragmentTransaction.commit();
    }

    @Override
    public void handleEvent(EventInfo event) {
          // here I get all the data (name, data, time, location, etc)
    } 
```

***编辑名称片段.java：***

```
 private EventHandler mEventHandler;

    @Override
    public void onAttach(Activity activity) {
         super.onAttach(activity);
         mEventHandler = (EventHandler)activity;
    }

    View doneButton = actionBarButtons.findViewById(R.id.doneBtnTextID);
    doneButton.setOnClickListener(new View.OnClickListener() {      
       @Override
       public void onClick(View v) {
            createNewReminder();            
       }
    });

    private void createNewReminder()
    {
        // Event info object to store all information (reminder name, data, time, etc)
        EventInfo eventInfo = new EventInfo();
        // access either Date or Location Fragment (depending on which is visible)  
        // FIXME: access the fragments and get the data
        // let the activity know to display the new reminder
        mEventHandler.handleEvent(eventInfo);
   } 
```

1.  问题：我开始只使用 1 个包含所有元素的 MainActivity 和一个 ViewFlipper。然后我读到片段更好，最终更好地适应平板电脑。这是布置这个的正确方法吗？

2.  问题：我知道如何从*EditNameFragment.java*获取数据。但是如何获取用户从*EditDataFragment*或*EditLocationFragment*输入的数据？我是否需要 MainActivity 中这两个片段的实例来访问它们的视图？还是我需要像使用 EventHandler 一样的另一个回调？如果是，规则是否为每个片段都有一个回调？

我想我在这些组件之间的通信流上有点挣扎。而且我知道片段到片段的通信不是一个好的设计

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:35:01.700

1.  片段是自包含的、模块化的组件，如果它们独立于另一个独立地呈现，它们就会很有意义。典型的例子是报纸文章列表和文章的显示......两者都可以独立或单独呈现，这很有意义。在您的情况下，我认为拥有多个片段可能是不必要的，因为它们独立于另一个片段没有意义（或者您最终会得到一个半定义的事件）。似乎您有一个片段来编辑日期和一个片段来编辑名称，但从概念上讲，这两个片段实际上编辑了一个“对象”，即事件。因此，这可能应该在一个带有 ViewFlipper 的片段中完成。

2.  你见过这个吗？

[http://developer.android.com/training/basics/fragments/communicating.html](http://developer.android.com/training/basics/fragments/communicating.html)

您需要主活动中所有三个片段的实例，并且您需要为每个片段定义接口并在主活动中实现它们。

# c++ - c++ 11 std::atomic_flag，我使用正确吗？

> ID：15819930
> 
> 赞同：8
> 
> 时间：2013-04-04T19:22:38.740
> 
> 标签：c++, multithreading, c++11, stdatomic

我有一个简单的布尔值，需要以线程安全的方式进行测试和设置。如果一个线程已经在工作，我希望第二个线程退出。如果我理解[`std::atomic_flag`](http://en.cppreference.com/w/cpp/atomic/atomic%5fflag)正确，这应该可以正常工作。但是，我不确定我理解`std::atomic_flag`正确:) 我似乎无法在网上找到很多简单的示例，除了这个自旋锁示例：

```
// myclass.cpp
#using <atomic>

namespace  // anonymous namespace
{
    std::atomic_flag _my_flag = ATOMIC_FLAG_INIT;
}  // ns

myclass::do_something()
{
    if ( !::_my_flag.test_and_set() ) )
    {
        // do my stuff here; handle errors and clear flag when done
        try
        {
            // do my stuff here
        }
        catch ( ... )
        {
            // handle exception
        }

        ::_my_flag.clear();  // clear my flag, we're done doing stuff
    }
    // else, we're already doing something in another thread, let's exit
}  // do_something 
```

更新：根据以下建议更新了代码，形成了正确使用`std::atomic_flag`. 谢谢大家！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-04T20:05:43.023

`atomic_flag`是一个非常低级的结构，并不打算广泛使用。就是说，我相信您的使用方式可以按您的意愿使用，但在特殊情况下可能会清除标志。如果发生匹配的异常以外的异常，`std::exception`则标志不会被清除。

通常 RAII 应该用于这类事情。“R”通常代表“资源”，但我喜欢 Jon Kalb 对“责任”的[使用](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CC4QtwIwAA&url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DUiZfODgB-Oc&ei=AtldUafzH8ruyQHdyYHIDg&usg=AFQjCNF0wicbTre2qcmX95eZAYQlL3KPdQ&bvm=bv.44770516,d.aWc)。设置标志后，您有责任在完成后清除标志，因此您应该使用 RAII 来确保履行职责。如果您在特殊情况下需要做的所有事情都可以通过这种方式完成，那么`try`/`catch`对就会消失。

```
if ( !std::atomic_flag_test_and_set( &::_my_flag ) )
{
    flag_clearer x(&::_my_flag);

    // do my stuff here
} 
```

但是您不需要`flag_clearer`自己编写类型。相反，您可以简单地使用更高级别的构造，例如互斥锁和 lock_guard：

```
namespace
{
    std::mutex my_flag;
}

myclass::do_something()
{
    if ( my_flag.try_lock() )
    {
        std::lock_guard<std::mutex> x(my_flag, std::adopt_lock);
        // do my stuff here
    }
    // else, we're already doing something in another thread, let's exit
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:59:30.047

`if`是的，如果其他线程已经设置了标志并且没有人清除它，那将跳过块内的代码。如果没有其他代码与标志混淆，则意味着某个线程当前正在执行该块。

不过，原子标志的级别相当低；考虑`atomic_bool`改用。此外，由于这是 C++，因此您可以将成员函数用于 set 和 clear。

编辑：

不，`atomic_bool`不会轻易做你想做的事。坚持`atomic_flag`...

# layout - 我的网站在分辨率高于 1024 时无法正常显示

> ID：15819932
> 
> 赞同：0
> 
> 时间：2013-04-04T19:22:48.577
> 
> 标签：layout, web, resize, liquid

我最近开发了一个网站，它在 1024 分辨率下看起来不错，但在更大的分辨率上就搞砸了。以下是您可能需要查看的文件的链接：[网站](http://inecnursing.org/inec.css)的[CSS 、菜单栏的 CSS](http://inecnursing.org/SpryMenuBarHorizontal.css)。这是一个 PHP 文件，但我已经链接到包含的 HTML 文件。

我有一个常规的 17' 屏幕，而客户端有一个宽屏。她在右侧看到了我没有看到的空白区域。我只是在使用 viewlike.us 网站测试不同分辨率时才看到它。我怎样才能使它调整比例？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:37:51.457

这是因为您将 body 设置为 1024 px

```
body {
width:1024px;
background-image:url(images/top_background.jpg);
background-repeat:no-repeat;
background-color:#FFF;
} 
```

你不想这样做，你通常做的是有一个页面包装器，你将大小设置为 1024px。

例如，您可以在 html 中使用它

```
<html>
   <head>...</head>
   <body>
      <div id="pageWrapper">
        <!-- all your content here -->
      </div>
   </body>
</html> 
```

然后在css中你可以有这样的东西：

```
#pageWrapper {
    width:1024px;
    margin: 0 auto;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T13:23:36.643

你通常有这样的结构：

```
<html>
   <head>...</head>
   <body>
      <div id="header-wrapper>
         <div id="header>
            <!-- header content here -->
         </div>
      </div>
      <div id="pageWrapper">
        <!-- all your content here -->
      </div>
   </body>
</html> 
```

然后，您可以为标题设置一个图像，为正文设置另一个图像，或者为标题设置一个图像，为正文设置一个背景颜色。这完全取决于你在做什么。

背景图像通常不是那么大。您通常拥有的是可以在 X 或 Y 或两者上重复的图像或图案。在 css 上你可以有类似的东西：

```
#headerWrapper {
    width:100%;
    height: 100px;
    background: url("/img/background.png") repeat-x;
} 
```

这样，图像将在标题上水平重复。然后你可以为 body 设置另一个背景，或者只是一个背景颜色。

同样，这在很大程度上取决于您要达到的目标。

祝你好运！！

# iphone - 在不同的线程中执行相同方法的冲突？

> ID：15819933
> 
> 赞同：0
> 
> 时间：2013-04-04T19:22:51.417
> 
> 标签：iphone, ios, objective-c, xcode, ipad

我有一个保存当前托管上下文的方法。

但是最近在这个方法中出现了一个错误。在我的程序中的某些位置（但不是所有时间），似乎此方法中的执行突然停止并且一切都停止执行......尽管没有崩溃。第一次执行有效。但是当我再次触发事件时，就会出现错误。

但是，如果我插入一个断点并一次执行一行方法，则一切正常。

基本上我从 JSON 连接获取数据，然后保存这些对象。在我保存对象的方法中，我调用了“saveManagedContext”方法，这就是发生错误的方法。

```
- (void)saveManagedObjectContext
{ 
  NSLog(@"saving context 1");
  NSManagedObjectContext *managedObjectContext;

  // get the context for the current thread
  NSThread *currentThread = [NSThread currentThread];

  if ([currentThread.name isEqual:THREAD_NAME]) {
   NSLog(@"saving context 2");
    managedObjectContext = _backgroundQueueManagedObjectContext;
  } else {NSLog(@"saving context 3");
    //managedObjectContext = _managedObjectContext;
    managedObjectContext = [self managedObjectContext];
  }
  NSLog(@"saving context 4");
  NSError *error = nil;
  if (managedObjectContext != nil) {
    NSLog(@"saving context 5");
    if ([managedObjectContext hasChanges] && ![managedObjectContext save:&error]) {
     NSLog(@"saving context 6");
        [self logError:error];
        //abort();
    }
  }
   NSLog(@"saving context 7");
} 
```

我几乎在每一行都插入了一个 NSLog 并且执行通常在之后停止`NSLog(@"saving context 5");`

这个方法在单独的线程中被调用，我有一个理论，它被访问的时间相对接近于同时导致冲突。这是我打印的一些 NSLog 输出。同样，这些日志中的大多数都出现在上面的代码中，在 If 等下。

此日志是事情一次正确执行 1 行。

```
 connection complete 10
 connection has results
 start saving json objects
 end saving json objects
 connection complete saving context
 saving json objects thread block 1
 saving context 1
 saving json objects thread block 3
 saving context 3
 saving context 4
 saving context 5
 saving json objects thread block 4
 saving json objects thread block 6
 saving context 1
 saving context 2
 saving context 4
 saving context 5
 saving context 7
 saving context 7
 saving json objects thread block 7
 inside block 1
 inside block 2 
```

这个日志是它挂起的时候。

```
connection complete 10
connection has results
start saving json objects
end saving json objects
connection complete saving context
saving context 1
saving context 3
saving context 4
saving context 5
saving json objects thread block 1
saving json objects thread block 3
saving json objects thread block 4
saving json objects thread block 6
saving context 1
saving context 2
saving context 4
saving context 5 
```

尽管如此，我已经看到执行停止并显示不同的日志，但通常是在保存上下文 5 左右。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:33:48.107

Core Data 不是线程安全的，请参阅有关 CoreData 并发的文档：

[http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/CoreData/Articles/cdConcurrency.html](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/CoreData/Articles/cdConcurrency.html)

最简单的解决方案可能是致电`tryLock`并`unlock`在您的`NSManagedObjectContext`

# xslt - 从 xml 中获取不同的值

> ID：15819935
> 
> 赞同：0
> 
> 时间：2013-04-04T19:22:55.257
> 
> 标签：xslt, xslt-1.0, xslt-grouping, muenchian-grouping

我的示例 xml 如下所示： 我需要从 xml 中获取不同的状态。我在 vs 2010 编辑器中使用 xslt 1.0。

```
<?xml version="1.0" encoding="utf-8" ?>
<states>
  <node>
    <value>2</value>
    <state>DE</state>
  </node>
  <node>
    <value>1</value>
    <state>DE</state>
  </node>
  <node>
    <value>1</value>
    <state>NJ</state>
  </node>
  <node>
    <value>1</value>
    <state>NY</state>
  </node>

  <node>
    <value>1</value>
    <state>NY</state>
  </node>
</states> 
```

我的 xslt 如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl"
   xmlns:user="urn:my-scripts">

  <xsl:output method="text" indent="yes"/>

  <xsl:key name="st" match="//states/node/state" use="." />

  <xsl:variable name="disst">
    <xsl:for-each select="//states/node[contains(value,1)]/state[generate-id()=generate-id(key('st',.)[1])]" >
      <xsl:choose>
        <xsl:when test="(position() != 1)">
          <xsl:value-of select="concat(', ',.)" disable-output-escaping="yes"/>
        </xsl:when>
        <xsl:otherwise>
          <xsl:value-of select="." disable-output-escaping="yes"/>
        </xsl:otherwise>
      </xsl:choose>

    </xsl:for-each>

  </xsl:variable>

    <xsl:template match="/" >
      <xsl:value-of disable-output-escaping="yes" select="$disst"/>

    </xsl:template>
</xsl:stylesheet> 
```

输出：DE、NJ、NY

我上面的 xml 看起来很适合上面的测试 xml。

如果我将 xml 更改如下：

```
<?xml version="1.0" encoding="utf-8" ?>
<states>
  <node>
    <value>2</value>
    <state>DE</state>
  </node>
  <node>
    <value>1</value>
    <state>DE</state>
  </node>
  <node>
    <value>1</value>
    <state>NJ</state>
  </node>
  <node>
    <value>1</value>
    <state>NY</state>
  </node>

  <node>
    <value>1</value>
    <state>NY</state>
  </node>
</states> 
```

它没有选择州DE。任何人都可以提出合适的解决方案。在此先感谢。我需要从 xml 中找出不同的状态。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:35:11.953

这里的问题是您在 Muenchian 分组 XPath 中使用了谓词：

```
[contains(value,1)] 
```

这通常会使 Muenchian 分组无法找到所有可用的不同值。相反，您应该将谓词添加到键中：

```
<xsl:key name="st" match="//states/node[contains(value, 1)]/state" use="." /> 
```

*或者，您可以在*分组语句中应用谓词：

```
<xsl:apply-templates 
   select="//states/node
               /state[generate-id() =
                      generate-id(key('st',.)[contains(../value, 1)][1])]" /> 
```

完整的 XSLT（有一些改进）：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:user="urn:my-scripts">
  <xsl:output method="text" indent="yes"/>

  <xsl:key name="st" match="//states/node/state" use="." />
  <xsl:variable name="a" select="1" />

  <xsl:variable name="disst">
    <xsl:apply-templates
       select="//states/node
                   /state[generate-id() =
                          generate-id(key('st',.)[contains(../value, $a)][1])]" />
  </xsl:variable>

  <xsl:template match="state">
    <xsl:if test="position() > 1">
      <xsl:text>,</xsl:text>
    </xsl:if>
    <xsl:value-of select ="." disable-output-escaping="yes" />
  </xsl:template>

  <xsl:template match="/" >
    <xsl:value-of disable-output-escaping="yes" select="$disst"/>

  </xsl:template>
</xsl:stylesheet> 
```

在示例 XML 上运行时的结果：

```
DE,NJ,NY 
```

# django - Django/Auth：request.user 可以被利用并指向其他用户吗？

> ID：15819937
> 
> 赞同：6
> 
> 时间：2013-04-04T19:22:59.843
> 
> 标签：django, security, django-authentication, authentication, http-post

假设我有一个表单在数据库中执行某些操作并需要通过 POST 发送的用户身份验证，是否有可能在内部*请求*邪恶的人更改*用户*以利用系统？

以下示例在数据库中创建一个项目，但需要登录用户。*有人可以在request.user*中发送其他用户的数据吗？

```
from django.shortcuts import render, redirect
from django.contrib.auth.decorators import login_required
from items_core.models import Item
from items.forms import CreateItemForm
from django.views.decorators.csrf import csrf_exempt

@csrf_exempt
@login_required
def create(request):
    errors = None
    if request.method == 'POST':
        form = CreateItemForm(request.POST)
        if form.is_valid():
            try:
                Item.objects.get(
                    name = form.cleaned_data['name'],
                    user = request.user
                    )
                errors = 'Item already exist. Please provide other name.'
            except Item.DoesNotExist:
                Item.objects.create(
                    name = form.cleaned_data['name'],
                    user = request.user
                    )

                return redirect('items:list')

        form = CreateItemForm()
    else:
        form = CreateItemForm()

    template = {
        'form':form, 
        'items':Item.objects.filter(user=request.user),
        'request':request,
        'errors':errors
        }

    return render(request, 'items/item_create.html', template) 
```

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T19:30:21.657

该`request.user`对象是由请求对象`SimpleLazyObject`添加的类型。`auth middleware`

`SimpleLazyObject(LazyObject):`用于延迟包装类的实例化在请求实际登录用户时，`get_user`方法被调用。

```
def get_user(request):
    if not hasattr(request, '_cached_user'):
        request._cached_user = auth.get_user(request)
    return request._cached_user 
```

在这里，`auth.get_user()`将反过来验证这种方式：

```
backend_path = request.session[BACKEND_SESSION_KEY]
backend = load_backend(backend_path)
user = backend.get_user(user_id) or AnonymousUser() 
```

因此，如果`request.user`对象被篡改，此验证将失败，因为会话数据验证将失败

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-14T18:19:20.640

`user``request`ie上的属性`request.user`由`AuthenticationMiddleware`. `process_request`对于此中间件，内部使用`get_user()`由`django.contrib.auth.__init__.py`.

这`get_user()`使用 django session 和 django session 内部使用 cookie。Django 会话使用带有`key`as的 cookie `sessionid`。

因此，假设恶意用户获取了合法用户的 cookie 并将此 cookie 发送到服务器，服务器将认为请求来自合法用户，并以合法用户身份登录。但由于请求是由恶意用户发送的，他现在可以访问合法用户的资源。

# css - GWT：具有固定列大小的 Flextable

> ID：15819939
> 
> 赞同：0
> 
> 时间：2013-04-04T19:23:10.773
> 
> 标签：css, gwt, flextable

我需要一个 GWT 中的 FlexTable，我可以在运行时添加项目。FlexTable 位于 ScrollPanel 内，因此当水平内容超出显示区域时，会出现滚动条。问题是当有 2-3 列时，它们的间距很宽，但随着列数的增加，单元格占用的最小面积为 100 像素。我需要确保 Cell 总是只占用 100px。我一直在关注但没有成功。

myflextable.getCellFormatter().setWidth(0, col, "100px");

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T14:16:27.557

问题可能是最初设置的 flextable 太宽。默认情况下它将填充滚动面板，然后列将拉伸到最大宽度。您应该在开始时明确设置 flextable 的宽度，并且在运行时添加更多列时它将自动正确调整大小。

这是一个示例，当您最初有一行和两个 100px 列时：

```
ft = new FlexTable();
ft.addStyleName("flextable");
ft.setWidth("200px");
for (int x = 0; x < 2; x++) {
    ft.setText(x, 0, "cell");
    ft.getCellFormatter().addStyleName(x, 0, "testcell");
}
scrollpanel.add(ft); 
```

你的CSS应该这样说：

```
.flextable {
    table-layout: fixed;
}
.testcell {
    width : 100px;
} 
```

请注意，flextable 最初设置为 200px 宽度，因为我们从两列开始。在 CSS 文件中，必须设置 table-layout 属性，否则当您添加更多列时，列将变得小于 100 像素（直到单元格达到其最小宽度，由其内容定义）。

此外，请记住将样式名称“testcell”添加到您在运行时添加的任何新单元格中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T11:02:15.243

请尝试使用 getFlexCellFormatter().setWidth() 方法。还请检查您是否将弹性表宽度设置为 100%。

# linked-list - 优先队列可以有空元素（如数组）吗？

> ID：15819940
> 
> 赞同：0
> 
> 时间：2013-04-04T19:23:28.337
> 
> 标签：linked-list, queue, element, priority-queue

嗨，我正在用算法设计语言编写一个用于模拟测试的算法，用于将元素添加到优先级队列中。

现在我计划通过使用将元素插入到后面的常规队列中的一般方法来做到这一点，然后通过将其（根据优先级值）与位于它之前的元素进行比较来将其排序到正确的位置 -队列。

这是我到目前为止的算法（仅用于将项目添加到优先级队列）：

*   *element* - 要添加到队列中的元素。
*   *queue[ ]* - 优先队列元素被添加到。
*   *n* - 优先队列的大小。
*   *tail* - 优先级队列中的最后一个元素。

**过程**AddQ（**IN**元素，**INOUT**队列[]，**IN** n，**INOUT**尾部）

```
if tail= n then
    print (“Queue is full”)
else {
    tail← tail+ 1
    queue (tail) ← element
} 
```

**结尾**

我不确定的是我是否应该有打印队列已满的部分。我是否认为优先级队列在尾部元素中有一个指向 null 的指针表示没有剩余元素？

如果是这样，这是否意味着优先级队列不能为新元素提供空白空间（例如标准数组），因为优先级队列中的尾部指向 null，表示队列中没有更多元素？还是我在这里采取了错误的方法？

我很困惑这是如何工作的，如果有人能澄清我将非常感激！谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-25T10:54:58.487

Java中的优先级队列是**动态**的，它们可以包含最少数量的元素，但是您放入其中的元素的最大数量由您决定。如果您想通过队列找出什么最后一个元素是或要找出最后一个元素在任何时候的位置，您需要一个**迭代器**对象来帮助您做到这一点。

# jquery - 引导轮播下一个和上一个功能不起作用

> ID：15819943
> 
> 赞同：7
> 
> 时间：2013-04-04T19:23:46.203
> 
> 标签：jquery, twitter-bootstrap, carousel

使用最新版本并拥有基本的轮播。我已经让它与所有默认设置一起工作，但是当尝试添加或停止某些功能时，事情会中断或根本不起作用。我希望能够手动循环浏览图像。不希望它自动循环。我只想使用下一个和上一个按钮来循环浏览。我在这里阅读了一些帖子，但解决方案不起作用帮助/工作。

```
<div id="myCarousel" class="carousel slide">

<!-- Carousel items -->
<div class="carousel-inner">
<div class="active item">
     <ul class="thumbnails">
         <li>Img</li>
         <li>Img</li>
         <li>Img</li>
     </ul>
</div>
<div class="item">
      <ul class="thumbnails">
         <li>Img</li>
         <li>Img</li>
         <li>Img</li>
     </ul>
</div>
</div>
<!-- Carousel nav -->
<a class="carousel-control left" href="#myCarousel" data-slide="prev">&lsaquo;</a>
<a class="carousel-control right" href="#myCarousel" data-slide="next">&rsaquo;</a>
</div>

$('#myCarousel').each(function() {
    $(this).carousel({
        interval: false
    });
}); 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-04-04T19:48:19.193

您可以自己连接事件：

```
$('.carousel-control.left').click(function() {
  $('#myCarousel').carousel('prev');
});

$('.carousel-control.right').click(function() {
  $('#myCarousel').carousel('next');
}); 
```

您当然也可以使用，`data-slide`这取决于您想要做什么。像这样的东西和上面一样。

```
$('a[data-slide="prev"]').click(function() {
  $('#myCarousel').carousel('prev');
});

$('a[data-slide="next"]').click(function() {
  $('#myCarousel').carousel('next');
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-05-02T15:26:17.223

我在评论中粘贴代码时遇到了一些困难（新手:)），但我接受了 Lucuma 的帖子并添加了一些代码来防止上一个和下一个链接作为内联页面锚点工作。使用下面的代码，您可以阻止这种情况的发生，但仍然可以像您想要的那样向后/向前滑动。

```
// Fixes the prev/next links of the sliders
$('.carousel-control.left').click(function(e) {
  e.stopPropagation();
  $('.js-carousel').carousel('prev');
  return false;
});

$('.carousel-control.right').click(function(e) {
  e.stopPropagation();
  $('.js-carousel').carousel('next');
  return false;
}); 
```

# asp.net - Datalist 控制 ASP.NET 中的访问

> ID：15819944
> 
> 赞同：0
> 
> 时间：2013-04-04T19:23:46.557
> 
> 标签：asp.net, vb.net

我正在使用一个`DataList`包含一些`TextBox`表格的表格。我试过代码是背后的代码

```
TextBox txtbox = dlCRR.FindControl("TextBox1") as TextBox; 
```

错误是

> 你调用的对象是空的。

当我调试时，我看到了一个`null`值。为什么是这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:42:23.670

您将无法直接从 datalist 控件中找到文本框。您必须从 DataList.Items 中找到它。

前任：

```
TextBox txt = myDataList.Items[indexOfWhatIamLookingFor].FindControl("TextBox1") as TextBox; 
```

或者如果你想迭代所有项目

```
foreach (DataListItem dli in myDataList.Items) 
{
    TextBox txt = dli.FindControl("TextBox1") as TextBox;
} 
```

# ruby - “Rake/rdoc 任务已过时”消息......这里的在线修复都没有工作

> ID：15819945
> 
> 赞同：0
> 
> 时间：2013-04-04T19:23:48.753
> 
> 标签：ruby, ruby-on-rails-3

我是一名 Rails 和 Ruby 菜鸟，正在阅读《使用 Rails 进行敏捷 Web 开发》一书。我做了一个例行的 rake 命令，得到了这个熟悉的信息：

错误：“rake/rdoctask”已过时，不再受支持。请改用“rdoc/task”（在 RDoc 2.4.2+ 中可用）。c:/rails_projects/depot/Rakefile:8:in `'

我彻底搜索了谷歌，尝试按照其他线程中的建议编辑我的 Gemfile 几次，更新了 rdoc gem，但我仍然收到此错误。我正在运行 Rails 3.0.5、Ruby 1.9.3p392、rdoc 4.0.2。这是我的捆绑安装：

使用 rake (10.0.4) 使用 abstract (1.0.0) 使用 activesupport (3.0.5) 使用 builder (2.1.2) 使用 i18n (0.6.4) 使用 activemodel (3.0.5)

使用 erubis (2.6.6)

使用机架 (1.2.8)

使用机架安装 (0.6.14)

使用机架测试（0.5.7）

使用 tzinfo (0.3.37)

使用动作包 (3.0.5)

使用 mime 类型 (1.22)

使用多语言 (0.3.3)

使用树顶 (1.4.12)

使用邮件 (2.2.19)

使用 actionmailer (3.0.5)

使用 arel (2.0.10)

使用活动记录 (3.0.5)

使用活动资源 (3.0.5)

使用 json (1.7.7)

使用捆绑器 (1.3.4)

使用雷神 (0.14.6)

使用铁轨 (3.0.5)

使用导轨 (3.0.5)

使用 rdoc (4.0.1)

使用 sqlite3 (1.3.7)

还有我的 Gemfile：

宝石'导轨'，'3.0.5'

宝石'sqlite3'

gem 'rdoc', ">= 4.0.1" 需要 'rdoc/task'

我根据我找到的一个论坛把那个 gem rdoc 东西放进去了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:42:13.313

糟糕的`require 'rake/rdoctask'`调用发生在 Rails 本身中。最简单的解决方案可能是更新 Rails。您应该能够使用 Rails 3.0.20 很好地完成这本书。

# ruby - 如何将 CI:Reporter 或 Minitest-CI 与 Minitest 自定义运行器一起使用？

> ID：15819946
> 
> 赞同：3
> 
> 时间：2013-04-04T19:23:49.917
> 
> 标签：ruby, continuous-integration, watir-webdriver, bamboo, minitest

我正在尝试在使用 MiniTest 用 Ruby 编写的 CI 服务器上运行一套自动化测试。我在下面的问题中编写了一个自定义的 minitest 跑步者。

[Ruby Minitest：套件级还是类级设置？](https://stackoverflow.com/questions/6756488/ruby-minitest-suite-or-class-level-setup)

这些测试正在运行基于 Web 的自动化 (Watir Webdriver)，我需要自定义运行器来设置浏览器和环境一次，而不是为每个单独的测试设置一次。

我正在努力让这些测试在持续集成服务器上运行。我想利用来自[https://github.com/bhenderson/minitest-ci](https://github.com/bhenderson/minitest-ci)或[https://github.com/nicksieger/ci_reporter](https://github.com/nicksieger/ci_reporter)的报告。

当我尝试包含这些宝石时，我没有收到任何报告。使用 ci-reporter，我收到错误消息，表明我的自定义运行程序中的 before_suite 代码没有被调用。

我如何配置这些 CI 报告器 gem 之一，以便让它与我的自定义 minitest 运行器一起运行？

这是我的跑步者：

```
MiniTest::Unit.autorun

class MyMiniTest
class Unit < MiniTest::Unit

def before_suites
  # code to run before the first test
end

def after_suites
  # code to run after the last test
end

def _run_suites(suites, type)
  begin
    before_suites
    super(suites, type)
  ensure
    after_suites
  end
end

def _run_suite(suite, type)
  begin
    suite.before_suite if suite.respond_to?(:before_suite)
    super(suite, type)
  ensure
    suite.after_suite if suite.respond_to?(:after_suite)
  end
end

MiniTest::Unit.runner = MyMiniTest::Unit.new 
```

感谢您的任何建议。

# cakephp - 在 CakePHP 的日期输入中是否有相当于“minYear”/“maxYear”的月份？

> ID：15819950
> 
> 赞同：1
> 
> 时间：2013-04-04T19:23:56.887
> 
> 标签：cakephp

我想限制本月和下个月的可用日期。

到目前为止，我知道我可以指定最小和最大年份，这是我需要的一部分。

```
$this_month = new DateTime('now');
$next_month = new DateTime('next month');

echo $this->Form->input('date', 
    array(
        'minYear'  => $this_month->format('Y'),
        'maxYear'  => $next_month->format('Y'),
    )
); 
```

有没有类似的方法可以指定我需要的月份？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T07:08:59.653

解决这个问题的两种方法都不像你想的那么简单：

第一的：

创建一个扩展 FormHelper 类的类，并创建您自己的月份函数来添加此功能。

第二：

您可以传入月份名称数组，因此您可以只生成您希望最终用户选择的月份列表并将其传递到您的月份函数中：

`<?php echo $this->Form->month('months', null, array('monthNames' => array(1 => 'Jan', 2 => 'Feb', 3 => 'March'))); ?>`

将生成一个月份选择器，下拉菜单中只有这三个月。

# chef-infra - apt-get update 在 postgresql 安装之前没有运行

> ID：15819953
> 
> 赞同：0
> 
> 时间：2013-04-04T19:24:09.713
> 
> 标签：chef-infra, vagrant

我正在使用 vagrant 创建在 Ubuntu 10.04 上运行的 postgresql 实例，使用 opscode 食谱，但由于某种原因`apt-get update`在 postgresql 运行之前没有被调用，因此`apt-get install postgresql`命令失败并出现 404 错误。任何人都可以帮助厨师新手吗？我已经浏览了其余的答案，但似乎没有任何效果。

```
STDOUT: Reading package lists...
Building dependency tree...
Reading state information...
The following extra packages will be installed:
  libpq5 postgresql-client postgresql-client-8.4 postgresql-client-common
Suggested packages:
  postgresql-8.4 postgresql-doc-8.4
The following NEW packages will be installed:
  libpq5 postgresql-client postgresql-client-8.4 postgresql-client-common
0 upgraded, 4 newly installed, 0 to remove and 52 not upgraded.
Need to get 941kB of archives.
After this operation, 5,300kB of additional disk space will be used.
Err http://us.archive.ubuntu.com/ubuntu/ lucid-updates/main libpq5 8.4.6-0ubuntu10.04
  404  Not Found [IP: 91.189.91.13 80]
Err http://us.archive.ubuntu.com/ubuntu/ lucid-updates/main postgresql-client-common 106ubuntu1
  404  Not Found [IP: 91.189.91.13 80]
Err http://us.archive.ubuntu.com/ubuntu/ lucid-updates/main postgresql-client-8.4 8.4.6-0ubuntu10.04
  404  Not Found [IP: 91.189.91.13 80]
Err http://us.archive.ubuntu.com/ubuntu/ lucid-updates/main postgresql-client 8.4.6-0ubuntu10.04
  404  Not Found [IP: 91.189.91.13 80]STDERR: Failed to fetch http://us.archive.ubuntu.com/ubuntu/pool/main/p/postgresql-8.4/libpq5_8.4.6-0ubuntu10.04_i386.deb  404  Not Found [IP: 91.189.91.13 80] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T00:11:25.740

Chef`apt-get update`永远不会默认运行。您必须明确告诉它这样做。

我建议你：

*   在安装之前利用 Opscode 的说明书`apt`和调用；或者`include_recipe "apt::default"``postgresql`

*   在您的 Chef 之前添加一个 shell 供应器`Vagrantfile`：

    `config.vm.provision :shell, :inline => 'apt-get update'`

第一个将在您应用说明书的任何地方工作，第二个将在每次配置 Vagrant VM 时运行更新，但如果您在其他地方使用说明书，则不会强制更新。

# javascript - 在 JavaScript、xPages 中使用 iText 库调整表格列宽

> ID：15819960
> 
> 赞同：0
> 
> 时间：2013-04-04T19:24:40.507
> 
> 标签：javascript, itext, xpages

在 xPages 中使用 iText 库，如何调整列宽？如果我使用 table.setWidths(30,10,30)，我得到以下错误：error: com.ibm.jscript.InterpretException: Script interpreter error, line=52, col=7: Java method 'setWidths(number, number , number)' 在 java 类 'com.itextpdf.text.pdf.PdfPTable' 上找不到

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T10:14:28.420

将您的代码包装到一个 Java 类中，该类只需要调用一个函数，并将流和文档作为参数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:39:41.540

看起来 setWidths 需要浮动。这行得通吗？

> table.setWidths(parseFloat(30),parseFloat(10),parseFloat(30))

# jquery - jquery onclick 打破文本框

> ID：15819961
> 
> 赞同：0
> 
> 时间：2013-04-04T19:24:45.207
> 
> 标签：jquery, html, textbox, onclick, anchor

我已经设置了一些 jQuery，它会在单击锚标记时触发。这个想法是，当单击锚标记时，会出现一个文本框。我目前有这个工作。

我的问题是什么会导致我的文本框变得无响应？当我单击文本框时，焦点会被移除。单击功能是否有问题会禁用我的文本框的焦点？

这是我在 JS Fiddle 中提出的代码：http: [//jsfiddle.net/4ZtMH/3/](http://jsfiddle.net/4ZtMH/3/)

的HTML：

```
<div class="main" id="143"><a href="#" class="thelink">Test Text Here</a></div>
<br />
<div class="main" id="145"><a href="#" class="thelink">Test Text Here</a></div> 
```

jQuery：

```
$('.thelink') + $('#143').click(function() {
$('.main') + $('#143').html('<input type="text" id="pername143" /> <input type="button" value="Set Gift" id="submitgiftname" />');
});

$('.thelink') + $('#145').click(function() {
$('.main') + $('#145').html('<input type="text" id="pername145" /> <input type="button" value="Set Gift" id="submitgiftname" />');
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:27:46.887

当您单击输入框时，它实际上会传播到父级。在父级上单击它重新添加 html

取消绑定点击事件将解决您的问题。[JSFIDDLE](http://jsfiddle.net/4ZtMH/4/)

```
$('.thelink') + $('#143').click(function() {
   $('.main') + $('#143').html('<input type="text" id="pername143" /> <input type="button" value="Set Gift" id="submitgiftname" />');
    $(this).unbind('click');
});

$('.thelink') + $('#145').click(function() {
   $('.main') + $('#145').html('<input type="text" id="pername145" /> <input type="button" value="Set Gift" id="submitgiftname" />');
    $(this).unbind('click');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:30:37.917

只需在 之后将焦点添加到该字段`click`，然后取消绑定`click`事件。

```
$('.thelink') + $('#143').on('click',function () {
    $('.main') + $('#143').html('<input type="text" id="pername143" /> <input type="button" value="Set Gift" id="submitgiftname" />');
    $('#pername143').focus();
    $(this).unbind('click');
});

$('.thelink') + $('#145').on('click',function () {
    $('.main') + $('#145').html('<input type="text" id="pername145" /> <input type="button" value="Set Gift" id="submitgiftname" />');
    $('#pername145').focus();
    $(this).unbind('click');
}); 
```

[小提琴](http://jsfiddle.net/4ZtMH/13/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:33:07.287

#143、#145 等仍然有一个点击事件，所以当您点击输入时，您将再次对包含的“.main”元素执行 onclick。

也许试试这个：

```
$('.thelink').click(function() {
    var $container = $(this).closest('.main');
    var container_id = $container.attr('id');
    $container.html('<input type="text" id="pername'+container_id+'" /><input type="button" value="Set Gift" id="submitgiftname" />');
    $('#pername'+container_id).focus();
}); 
```

请注意，使用此方法，您将不需要为每个链接单独的 onclick 处理程序。

这是更新的小提琴[http://jsfiddle.net/4ZtMH/17/](http://jsfiddle.net/4ZtMH/17/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T23:01:50.353

HTML 语法是相同的，但分配类的链接是为 CLICK 事件确定的。[在此处](http://jsfiddle.net/moizest89/6Fqrr/)查看演示

```
$('a.thelink','#143').click(function() {
   $('.main') + $('#143').html('<input type="text" id="pername143" /> <input type="button" value="Set Gift" id="submitgiftname" />');
});

$('a.thelink','#145').click(function() {
   $('.main') + $('#145').html('<input type="text" id="pername145" /> <input type="button" value="Set Gift" id="submitgiftname" />');
}); 
```

# xml - 协助对 xml 文件进行 xsl 转换

> ID：15819967
> 
> 赞同：0
> 
> 时间：2013-04-04T19:24:59.760
> 
> 标签：xml, xslt

首先.. 我对此完全陌生，而不是专业编码员.. 通常我制作小型 php 网站。

我有一个水冷系统。Watercoolingsystem 有一个 xml 输出，它将所有收集的数据写入一个 xml 文件，该文件将每 x 秒刷新一次。

现在我还有一个由 LCDhost 软件驱动的 G19 LCD 键盘。这个软件可以读取 XML 文件并显示值。

不幸的是 LCDhost 可以解释 Watercooling xml .. 我必须重建文件。

我开始环顾四周，但我在 XML 编码方面的技能是 -100 :(

文件看起来是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<LogDataExport xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <name>Aquasite2012</name>
  <exportTime>2013-04-04T21:00:20.7286335+02:00</exportTime>
  <logdata>
    <LogDataSet>
      <t>2013-04-04T21:00:20.650</t>
      <value>24.72</value>
      <name>Sensor 1</name>
      <unit>°C</unit>
      <valueType>temperature</valueType>
      <device>aquaero 5</device>
    </LogDataSet>
    <LogDataSet>
      <t>2013-04-04T21:00:20.650</t>
      <value>46.63</value>
      <name>Sensor 2</name>
      <unit>°C</unit>
      <valueType>temperature</valueType>
      <device>aquaero 5</device>
    </LogDataSet>
    <LogDataSet>
      <t>2013-04-04T21:00:20.650</t>
      <value>29.68</value>
      <name>aquaero CPU</name>
      <unit>°C</unit>
      <valueType>temperature</valueType>
      <device>aquaero 5</device>
    </LogDataSet>
    <LogDataSet>
      <t>2013-04-04T21:00:20.650</t>
      <value>161</value>
      <name>Flow 1</name>
      <unit>l/h</unit>
      <valueType>flow</valueType>
      <device>aquaero 5</device>
    </LogDataSet>
    <LogDataSet>
      <t>2013-04-04T21:00:20.650</t>
      <value>149.7</value>
      <name>Flow 2</name>
      <unit>l/h</unit>
      <valueType>flow</valueType>
      <device>aquaero 5</device>
    </LogDataSet>
    <LogDataSet>
      <t>2013-04-04T21:00:20.650</t>
      <value>870</value>
      <name>Fan 2</name>
      <unit>rpm</unit>
      <valueType>rpm</valueType>
      <device>aquaero 5</device>
    </LogDataSet>
    <LogDataSet>
      <t>2013-04-04T21:00:20.650</t>
      <value>860</value>
      <name>Fan 3</name>
      <unit>rpm</unit>
      <valueType>rpm</valueType>
      <device>aquaero 5</device>
    </LogDataSet>
    <LogDataSet>
      <t>2013-04-04T21:00:20.650</t>
      <value>956</value>
      <name>Fan 4</name>
      <unit>rpm</unit>
      <valueType>rpm</valueType>
      <device>aquaero 5</device>
    </LogDataSet>
    <LogDataSet>
      <t>2013-04-04T21:00:20.363</t>
      <value>80</value>
      <name>Füllstand in %</name>
      <unit>%</unit>
      <valueType>percent</valueType>
      <device>tubemeter</device>
    </LogDataSet>
    <LogDataSet>
      <t>2013-04-04T21:00:20.164</t>
      <value>26.6</value>
      <name>Wassertemperatur</name>
      <unit>°C</unit>
      <valueType>temperature</valueType>
      <device>aquastream xt</device>
    </LogDataSet>
  </logdata>
</LogDataExport> 
```

我需要这样的输出：

```
<as2012>
  <LogData>
    <Date>03.04.2013</Date>
    <Time>17:03:39</Time>
    <Sensor1>19,90</Sensor1>
    <Sensor2>19,90</Sensor2>
    <Sensor3>---,--</Sensor3>
    <Sensor4>18,90</Sensor4>
    <Sensor5>21,90</Sensor5>
    <Sensor6>21,60</Sensor6>
    <Fan1Rpm>845</Fan1Rpm>
    <Fan2Rpm>939</Fan2Rpm>
    <Fan3Rpm>863</Fan3Rpm>
    <Fan4Rpm>16640</Fan4Rpm>
    <Fan1Power>100,00</Fan1Power>
    <Fan2Power>100,00</Fan2Power>
    <Fan3Power>100,00</Fan3Power>
    <Fan4Power>100,00</Fan4Power>
    <Led1Power>0,00</Led1Power>
    <Led2Power>0,00</Led2Power>
    <Flow1Hour>160,8300</Flow1Hour>
    <Flow1Minute>2,6805</Flow1Minute>
    <Flow2Hour>166,4000</Flow2Hour>
    <Flow2Minute>2,7733</Flow2Minute>
    <TubemeterLevel>255,00</TubemeterLevel>
    <TubemeterWave>255,00</TubemeterWave>
    <PowerSensor1>0,00</PowerSensor1>
    <PowerSensor2>0,00</PowerSensor2>
    <Aquastream1Voltage>0,0</Aquastream1Voltage>
    <Aquastream1Current>0</Aquastream1Current>
    <Aquastream1Power>0,0</Aquastream1Power>
    <Aquastream1Frequence>120</Aquastream1Frequence>
    <Aquastream2Voltage>0,0</Aquastream2Voltage>
    <Aquastream2Current>0</Aquastream2Current>
    <Aquastream2Power>0,0</Aquastream2Power>
    <Aquastream2Frequence>120</Aquastream2Frequence>
  </aquaero4LogData>
</aquaero4LogData> 
```

我正在寻找一种方法，但我的知识很低..目前我有这个：

```
<xsl:stylesheet

  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"

  version="1.0">

 <xsl:output method="xml" version="1.0" indent="no" omit-xml-declaration="yes"/>

<xsl:template match="t">
  <xsl:for-each select="t">
    <xsl:value-of select="local-name()"/>
    <xsl:value-of select="current()"/>
  </xsl:for-each>
</xsl:template>

<xsl:template match="unit">
  <xsl:for-each select="unit">
    <xsl:value-of select="local-name()"/>
    <xsl:value-of select="current()"/>
  </xsl:for-each>
</xsl:template>

<xsl:template match="valueType">
  <xsl:for-each select="valueType">
    <xsl:value-of select="local-name()"/>
    <xsl:value-of select="current()"/>
  </xsl:for-each>
</xsl:template>

<xsl:template match="device">
  <xsl:for-each select="device">
    <xsl:value-of select="local-name()"/>
    <xsl:value-of select="current()"/>
  </xsl:for-each>
</xsl:template>

  <xsl:template match="value">

    <xsl:element name="{local-name()}">

      <xsl:apply-templates select="@* | node()"/>

    </xsl:element>

  </xsl:template>

  <xsl:template match="@*">

    <xsl:attribute name="{local-name()}">

      <xsl:value-of select="."/>

    </xsl:attribute>

  </xsl:template>

  <xsl:template match="text() | comment() | processing-instruction()">

    <xsl:copy/>

  </xsl:template>

</xsl:stylesheet> 
```

所以我删除了我不需要的行..但我不知道如何重命名。有人可以帮我重新构建 xml .. 我需要从每个 LogDataSet 中删除名称和值以及删除的所有其他节点。

由此：

```
 <value>29.68</value>
  <name>aquaero CPU</name> 
```

对此：

```
<aquaero CPU>29.68</aquaero CPU> 
```

先感谢您

麦克风

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:06:07.407

这个模板可以让你开始：

有几点需要考虑：

*   XML 元素名称不能有空格，所以我们需要替换它们
*   XML 元素名称不能有像 % 这样的字符，所以我不得不用 translate 函数替换它

    ```
    <?xml version='1.0'?>
    <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" version="1.0" indent="no" omit-xml-declaration="yes"/>

    <xsl:template match="/">
        <xsl:apply-templates select="LogDataExport/logdata"/>
    </xsl:template>

    <!-- Build your output file, set date and time and then recurse the rest
    of input doc -->
    <xsl:template match="logdata">
        <xsl:copy>
            <xsl:element name="Date">
                    <!-- Grab the Date/Time from the first LogDataSet/t element -->
                <xsl:value-of select="substring-before(LogDataSet[1]/t,'T')"/>
            </xsl:element>
            <xsl:element name="Time">
                <xsl:value-of select="substring-after(LogDataSet[1]/t,'T')"/>
            </xsl:element>
            <xsl:apply-templates/>
        </xsl:copy>
    </xsl:template>

    <!-- For each name element in LogDataSet create an element with that value
    and set the value to the content of the value element -->
    <xsl:template match="LogDataSet">
        <!-- remove spaces and % symbol from name value -->
        <xsl:element name="{translate(translate(name,' ',''),'%','P')}">
            <xsl:value-of select="value"/>
        </xsl:element>
    </xsl:template>

    <!-- Identity template recurse input document elements and attributes -->
    <xsl:template match="@*|node()">
        <xsl:copy>
          <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
      </xsl:template>
    </xsl:stylesheet> 
    ```

# wordpress - 注册时的自定义用户字段

> ID：15819972
> 
> 赞同：2
> 
> 时间：2013-04-04T19:25:13.377
> 
> 标签：wordpress

我正在为客户开发一个自定义插件，我需要添加一些自定义用户字段。我已经通过 Codex 进行了搜索，但找不到答案。

我基本上需要在 MySQL 中的 users 表中添加一些新行，然后在注册期间添加一些额外的字段。我确定还有其他插件允许您添加自定义用户字段，但我想将它直接合并到我的插件中。

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:51:20.700

我在 WordPress Answers: [Checkboxes in registration form 中](https://wordpress.stackexchange.com/q/87261/12615)回答了一个类似的问题。

您需要操作挂钩`register_form`（注入您的输入字段）和`user_register`（处理它）。其余代码只是用于检查页面配置文件和用户编辑中的结果的示例代码。

```
// REGISTRATION
add_action( 'register_form', 'signup_fields_wpse_87261' );
add_action( 'user_register', 'handle_signup_wpse_87261', 10, 2 );

// PROFILE
add_action( 'show_user_profile', 'user_field_wpse_87261' );
add_action( 'personal_options_update', 'save_profile_fields_87261' );

// USER EDIT
add_action( 'edit_user_profile', 'user_field_wpse_87261' );
add_action( 'edit_user_profile_update', 'save_profile_fields_87261' );

function signup_fields_wpse_87261() {
?>
    <label>
        <input type="checkbox" name="custom_feature_a" id="custom_feature_a" /> 
        Enable feature A?
    </label>
    <br />
    <label>
        <input type="checkbox" name="custom_feature_b" id="custom_feature_b" /> 
        Enable feature B?
    </label>
    <hr />
<?php
}

function handle_signup_wpse_87261( $user_id, $data = null ) 
{
    $feat_a = isset( $_POST['custom_feature_a'] ) ? $_POST['custom_feature_a'] : false;
    $feat_b = isset( $_POST['custom_feature_b'] ) ? $_POST['custom_feature_b'] : false;
    if ( $feat_a ) 
    {
        add_user_meta( $user_id, 'custom_feature_a', $feat_a );
    }
    if ( $feat_b ) 
    {
        add_user_meta( $user_id, 'custom_feature_b', $feat_b );
    }
}

function user_field_wpse_87261( $user ) 
{
    $feat_a = get_user_meta( $user->ID, 'custom_feature_a', true );
    $feat_b = get_user_meta( $user->ID, 'custom_feature_b', true );
?>
    <h3><?php _e('Custom Fields'); ?></h3>
    <table class="form-table">
        <tr>
            <td>
                <label><?php 
                    printf(
                        '<input type="checkbox" name="custom_feature_a" id="custom_feature_a" %1$s />',
                        checked( $feat_a, 'on', false )
                    );
                    ?>
                    <span class="description"><?php _e('Custom Feature A?'); ?></span>
                    </label>
            </td>
        </tr>
        <tr>
            <td>
                <label><?php 
                    printf(
                        '<input type="checkbox" name="custom_feature_b" id="custom_feature_b" %1$s />',
                        checked( $feat_b, 'on', false )
                    );
                    ?>
                    <span class="description"><?php _e('Custom Feature B?'); ?></span>
                    </label>
            </td>
        </tr>
    </table>
<?php 
}

function save_profile_fields_87261( $user_id ) 
{
    $feat_a = isset( $_POST['custom_feature_a'] ) ? $_POST['custom_feature_a'] : false;
    $feat_b = isset( $_POST['custom_feature_b'] ) ? $_POST['custom_feature_b'] : false;
    update_usermeta( $user_id, 'custom_feature_a', $feat_a );
    update_usermeta( $user_id, 'custom_feature_b', $feat_b );
} 
```

# javascript - 平滑地将正方形转换为 svg/javascript 中的文本

> ID：15819973
> 
> 赞同：0
> 
> 时间：2013-04-04T19:25:13.130
> 
> 标签：javascript, svg

有没有办法让 svg 正方形和过渡动画转换成文本（我假设它是矢量的）？

如果是，是否有任何示例或库可供我在 javascript 中使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:58:56.810

一个好的库是[RaphaelJs](http://raphaeljs.com/)。甚至还有一个显示该功能的[示例。](http://raphaeljs.com/helvetica.html)

# python - 计算二维数组中跨维度的平均值

> ID：15819980
> 
> 赞同：95
> 
> 时间：2013-04-04T19:25:25.377
> 
> 标签：python, arrays, multidimensional-array, numpy, mean

我有一个这样的数组`a`：

```
a = [[40, 10], [50, 11]] 
```

我需要分别计算每个维度的平均值，结果应该是这样的：

```
[45, 10.5] 
```

`45`是 的平均值`a[*][0]`和`10.5`的平均值`a[*][1]`。

在不使用循环的情况下解决这个问题的最优雅的方法是什么？

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2013-04-04T19:26:57.727

`a.mean()`接受一个`axis`论点：

```
In [1]: import numpy as np

In [2]: a = np.array([[40, 10], [50, 11]])

In [3]: a.mean(axis=1)     # to take the mean of each row
Out[3]: array([ 25\. ,  30.5])

In [4]: a.mean(axis=0)     # to take the mean of each col
Out[4]: array([ 45\. ,  10.5]) 
```

或者，作为独立功能：

```
In [5]: np.mean(a, axis=1)
Out[5]: array([ 25\. ,  30.5]) 
```

您的切片不起作用的原因是因为这是切片的语法：

```
In [6]: a[:,0].mean() # first column
Out[6]: 45.0

In [7]: a[:,1].mean() # second column
Out[7]: 10.5 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-04-04T19:28:38.373

这是一个非numpy的解决方案：

```
>>> a = [[40, 10], [50, 11]]
>>> [float(sum(l))/len(l) for l in zip(*a)]
[45.0, 10.5] 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-04T19:28:25.437

如果你经常这样做，[NumPy](http://www.numpy.org/)就是你要走的路。

如果由于某种原因你不能使用 NumPy：

```
>>> map(lambda x:sum(x)/float(len(x)), zip(*a))
[45.0, 10.5] 
```

# scala - collection.mutable.HashMap 是否有有效的大小方法？

> ID：15819982
> 
> 赞同：1
> 
> 时间：2013-04-04T19:25:32.783
> 
> 标签：scala, collections, scala-collections

我正在使用`collection.mutable.Map`默认为`collection.mutable.HashMap`. 我需要跟踪该地图中的项目数量，所以我想知道这个类是否已经实现了快速`size`响应，这将使我不必自己跟踪它。

这与`useSizeMap`方法有关吗？不幸的是，这种方法的文档非常模糊，确定任何东西都是完全没有用的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T19:28:54.993

的大小`collection.mutable.HashMap`存储为`Int`根据添加/删除方法递增/递减的，因此调用该`size`方法应该是瞬时的（ O(1) ）。您可以在继承自的[源代码上`HashTable`](https://github.com/scala/scala/blob/master/src/library/scala/collection/mutable/HashTable.scala)自己看到它。`HashMap`

# jquery - 为了性能，我应该链接选择器调用还是让 jQuery 来完成工作？

> ID：15819983
> 
> 赞同：0
> 
> 时间：2013-04-04T19:25:35.330
> 
> 标签：jquery

在浏览器性能方面，我应该链接选择器调用吗？jQuery 是否会进行完整的文档搜索？

例如之间的区别`$('.my_thing') and $('#outer_div .my_thing')`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:32:08.923

我建议你阅读这篇关于 24ways 的文章：[Your jQuery: Now With 67% Less Suck。](http://24ways.org/2011/your-jquery-now-with-less-suck/)尤其是*Selector 优化*部分。

正如您将在现代浏览器中看到的那样，类选择器非常快，但在 < IE8 中则不然。

我建议不要使用`$('#outer_div .my_thing')`，好多了`$('#outer_div').find('.my_thing')`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:27:56.937

这完全取决于选择器。

在您的情况下，假设您没有`.my_thing`之外的元素`#outer_div`，两个选择器将非常快，因为它们将使用底层的`getElementsByTagName`.

您在这里比较了两个非常快速的选择器，因此差异并不重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:28:06.347

常识说第一个例子，因为第二个例子需要额外的步骤，找到第一个元素，然后遍历它的 DOM 分支，直到找到第二个元素。

假设您正在 DOM 中搜索第一个元素，您实际上可以*传递*第二个元素（您正在寻找），因为循环的终止条件是找到第一个元素。

与大多数性能调整一样，改进将取决于浏览器。

相关： [jquery 和 CSS 中最快的选择器方法 - ID 与否？](https://stackoverflow.com/questions/6035348/fastest-selector-method-in-jquery-and-css-id-or-not#)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T19:33:40.137

以下是有关该主题的一些有用文章：

[http://blog.bigbinary.com/2010/02/15/how-jquery-selects-elements-using-sizzle.html](http://blog.bigbinary.com/2010/02/15/how-jquery-selects-elements-using-sizzle.html) [http://dumitruglavan.com/jquery-performance-tips-cheat-sheet/](http://dumitruglavan.com/jquery-performance-tips-cheat-sheet/) [http:// /net.tutsplus.com/tutorials/javascript-ajax/quick-tip-think-right-to-left-with-jquery/](http://net.tutsplus.com/tutorials/javascript-ajax/quick-tip-think-right-to-left-with-jquery/)

总而言之，随着 Sizzle 的引入，上述查询应该给出大致相同的性能数字。如果您使用旧版本，第一种方法应该更快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-04T19:34:02.320

另一个：

**'#id'**选择器最快，**find**是浏览器原生方法

```
$('#outer_div').find('.my_thing'); 
// or shorthand 
$('.my_thing', '#outer_div'); 
```

# ios - 在 UITableView 中对核心数据多对关系进行排序

> ID：15819984
> 
> 赞同：1
> 
> 时间：2013-04-04T19:25:35.417
> 
> 标签：ios, uitableview, core-data, nsfetchedresultscontroller, nsorderedset

我在这里看到了很多关于这个问题的帖子，但似乎没有一个能解决我遇到的问题。

我有一个使用核心数据的应用程序。我正在尝试对连接到 NSFetchedResultsController 的 tableView 进行排序，使问题比这里的其他一些帖子更复杂的是我需要根据用户位置更新排序。

我的情况如下：

我有一个名为 Store 的实体。商店有很多分店，每个分店都有自己的纬度/经度。我有一个表格视图，显示所选商店的所有分支机构。我想要的是，当用户在 tableview 可见的情况下更新他们的位置时，单元格会更新他们的位置，以便 tableview 以最近的分支在顶部进行排序。

当用户靠近分支等时，我设法使所有这些都正常工作，单元格动画上下移动。但是，我的解决方案不仅效率低下，而且当 tableview 有更多单元格时，它还有一个重大错误可以适合屏幕。

我知道最有可能失败的路线是使用 NSOrderedSet 对我的 Store 实体上的多对多关系进行排序。但不确定如何实现这一点，因为我正在排序的值不存储在核心数据中，而是在有意义的情况下动态计算。lat 和 long 被存储，但距离是动态计算的，它的距离值决定了排序。

目前我使用 CLLocationManger 协议 locactionManager:didUpdateLocations 来调用**我**的排序方法 updateCellSortingOrder。位置管理器设置为：

```
self.manager.desiredAccuracy = kCLLocationAccuracyBestForNavigation; 
```

我的排序方法有效，但就像我说的那样并不理想。我希望能够利用尽可能多的核心数据工具，例如 NSFetchedViewController、谓词、聚合等，而不是创建数组、对它们进行排序然后将它们推回 FRC 等，这有点像我现在正在做的......太乱了。

这是我的代码，**注意**：**branchCell**是 UITableViewCell 的子类，它有一个包含分支的属性 init。**分支**是我的实体分支的一个实例

```
//Creating the branch cell
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"MyTableCellView";

BranchCell *cell  = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[BranchCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];

    Branch *currentBranch =  [[self.list.listsToDelivery allObjects] objectAtIndex:indexPath.row];

    cell.branch = currentBranch;
    cell.textLabel.text = currentBranch.title;
}

return cell; 
```

}

```
-(void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations
{
    //update the cells
    [self updateCellSortingOrder];
}

- (void) updateCellSortingOrder
{
    // get the number of cells
    static int numberOfCells;

    numberOfCells = [[self.currentStore.branches allObjects]  count];

//loop though all the cells
    for (int cellAIndex = 0; cellAIndex < numberOfCells; cellAIndex++)
{
    //set up the cells
    static BranchCell * cellA;
    static BranchCell * cellB;

    //branch instances
    static Branch *branchA;
    static Branch *branchB;

    //distances
    static CLLocationDistance distanceA;
    static CLLocationDistance distanceB;
    static CLLocation *locationA;
    static CLLocation *locationB;

    //second loop to get the next cell 
    for (int cellBIndex = cellAIndex+1; cellBIndex < numberOfCells; cellBIndex++)
    {
        //assign the cells
        cellA = (BranchCell *)[self.myTableView cellForRowAtIndexPath:[NSIndexPath indexPathForRow:cellAIndex inSection:0]];
        cellB = (BranchCell *)[self.myTableView cellForRowAtIndexPath:[NSIndexPath indexPathForRow:cellBIndex inSection:0]];

        //get the two branches which we need to compate
        branchA = cellA.branch;
        branchB = cellB.branch;

        //calculate the distance
        locationA = [[CLLocation alloc] initWithLatitude:branchA.address.region.center.latitude longitude:branchA.address.region.center.longitude];

        locationB = [[CLLocation alloc] initWithLatitude:branchB.address.region.center.latitude longitude:branchB.address.region.center.longitude];

        distanceA = [self.manager.location distanceFromLocation:locationA];
        distanceB = [self.manager.location distanceFromLocation:locationB];

        //move the cell a to cell b's location if a's distances is greater than b's
        if (distanceA > distanceB)
        {
            [self.myTableView moveRowAtIndexPath:[NSIndexPath indexPathForRow:cellAIndex inSection:0] toIndexPath:[NSIndexPath indexPathForRow:cellBIndex inSection:0]];

        } 
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-18T00:39:59.247

如果有人遇到与我相同的问题，这是我的解决方法。不久前修复了它，但从未更新过。它已在我的应用程序 Delivered 中使用，该应用程序现在在应用程序商店中 :)

在地图委托方法 mapView:didUpdateUserLocation 上调用 updateCellSortingOrder：

*   (无效) updateCellSortingOrder {

    [self.myTableView reloadData];

    [self.sortedCellArray sortUsingComparator: ^(Delivery *deliveryA, Delivery *deliveryB) {

    ```
     CLLocationDistance distanceA;
     CLLocationDistance distanceB;

     distanceA = [[self.mapView userLocation] distanceFromLocation: deliveryA.address];
     distanceB = [[self.mapView userLocation] distanceFromLocation: deliveryB.address];

     if ( distanceA > distanceB)
     {

         return (NSComparisonResult)NSOrderedDescending;
     }

     return (NSComparisonResult)NSOrderedSame; 
    ```

    }];

}

# ios - 如何确定用户在 GPS 路径上的当前位置？

> ID：15819987
> 
> 赞同：1
> 
> 时间：2013-04-04T19:25:43.650
> 
> 标签：ios, gps, location

我有一条要绘制到地图上的 GPS 坐标路径。我需要确定用户当前最接近路径的哪个点。我能够遍历路径上的附近点并确定哪个是最近的，但我遇到了问题。

有时路径涉及回程，因此路径的两个部分可能是平行的。

判断用户是离开还是返回的最佳方法是什么？他们可能会在路径中的任何时候启动我的应用程序，并且它需要能够知道他们在路径的哪一部分。

我能想到的唯一解决方案是使用他们移动的方向并猜测他们必须在路径的任何部分朝那个方向移动，但似乎必须有另一种方式。

澄清一下：在下图中，如果我不能假设我的应用程序在路径行驶期间一直具有位置感知能力，我如何确定用户是在路径的 A 点还是 B 点？

[图表](http://i.stack.imgur.com/Q5BvZ.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:55:46.887

解决方案是距离检查和方向检查的组合。
先获取半径100m内的所有位置，然后按距离排序。
取第一个不超过当前用户方向 x 度的偏差。

# servlets - 在 Struts2 Action Class 中设置 ContextPath 会给出错误的路径

> ID：15819992
> 
> 赞同：0
> 
> 时间：2013-04-04T19:26:32.147
> 
> 标签：servlets, struts2, contextpath

我目前正在尝试为我的 webapp 中的配置文件设置上下文路径，但似乎无论我尝试什么解决方案，它们都没有给出正确的路径。配置文件位于 WEB-INF/Config 中。

我已经尝试使用`ServletContextAware`以获取上下文路径，但它似乎给了我错误的路径。

> C:\Documents and Settings\Person\My Documents\geronimo-tomcat6-javaee5-2.2-bin\geronimo-tomcat6-javaee5-2.2\bin\org.apache.catalina.core.ApplicationContextFacade@5d869c\WEB-INF\config\配置文件

```
private ServletContext context;
public void setServletContext(ServletContext context) {
    this.context = context;
}
AdminFile = builder.parse(context + "/WEB-INF/config/config.xml"); 
```

我还尝试通过调用 ServletActionContext.getServletContext，通过 org.apache.struts2.ServletActionContext 创建上下文路径，但这给了我类似的错误。

> C:\Documents and Settings\Person\My Documents\geronimo-tomcat6-javaee5-2.2-bin\geronimo-tomcat6-javaee5-2.2\bin\org.apache.catalina.core.ApplicationContextFacade@156592a\WEB-INF\config\配置文件

```
ServletContext context = ServletActionContext.getServletContext();
AdminFile = builder.parse(context + "/WEB-INF/config/config.xml"); 
```

我终于尝试使用 ServletRequestAware，它给了我更好的结果，但仍然不是我需要的完整上下文路径。我还想避免将我的操作类耦合到 servlet api。

> \JSPPrototype\WEB-INF\config\config.xml

```
public HttpServletRequest request;
public void setServletRequest(HttpServletRequest request) 
{
this.request = request;  
}

String context = request.getContextPath();
AdminFile = builder.parse(context + "/WEB-INF/config/config.xml"); 
```

我到底做错了什么，我应该如何构建一个有效的 ContextPath？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:49:46.403

与您的`ServletContext`应用程序的上下文路径不同。`ServletContext`是您的 Web 应用程序可用于与 servlet 容器交互的对象。因此，您使用您的方法所做的是将该对象与 a 连接，该对象`String`调用它的`toString()`方法，该方法仅打印实现类名及其哈希码。这显然与您的路径不匹配。

相反，您需要做的是使用`ServletContext`来获取`URL`您的文件。为此，您实际上使用了`ServletContext`. 您可以`URL`使用[`getResource`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getResource%28java.lang.String%29). `ServletContext`像这样的东西：

```
builder.parse(context.getResource('/WEB-INF/config/config.xml')); 
```

这需要你的`parse`方法接受一个`URL`对象。`getResourceAsStream()`如果您的构建器接受类型参数，您也可以使用, `InputStream`。