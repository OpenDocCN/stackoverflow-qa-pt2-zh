# StackOverflow 问答 16041000-16041999

# php - 与 JQGrid 集成，不将数据加载到自定义编辑 JQForm 中

> ID：16041012
> 
> 赞同：0
> 
> 时间：2013-04-16T15:27:42.907
> 
> 标签：php, jqgrid

我正在尝试集成 jqgrid 和 jqform，但数据没有填充到我的 jqform 中。我进行了测试以确保 jqgrid 正在传递表单的搜索键值，并且有效。但由于某种原因，我的改革不会正确查询并填充表单对象。

```
 <?php 
        if(!isset($_SESSION))
                session_start();

            // Include class  
        include_once 'jqformconfig.php'; 
            if(!class_exists('jqGridUtils'))
            {   
            include_once $CODE_PATH.'jqUtils.php';
            }  
        include_once $CODE_PATH.'jqForm.php';  

            $today = getdate(time());
            $displayDate = $today['mon']."/".$today['mday']."/".$today['year'].'  '.$today['hours'].':'.$today['minutes'].':'.$today['seconds'];
            $machrecs = null;

        // Create instance  
        $newForm = new jqForm('MWOForm',array('action' => 'forms/mwoForm.php', 'method' => 'post', 'id' => 'MWOForm')); 

        // Demo Mode creating connection  
            if(!class_exists('jqGridDB'))
            {
                include_once $CODE_PATH.'/jqGridPdo.php';
            }  
        $conn = new PDO(DB_DSN, DB_USER, DB_PASSWORD); 
        $conn->query("SET NAMES utf8");
        $newForm->setConnection( $conn ); 

        // Set url 
        $newForm->setUrl($SERVER_HOST.$SELF_PATH.'forms/mwoForm.php'); 

        // Set parameters  
        $mwo_id = jqGridUtils::GetParam('mwo_id',0901270825);
        $mwo_id = is_numeric($mwo_id) ? (int)$mwo_id : 0; 
        $jqformparams = array($mwo_id); 

        // Set SQL Command, table, keys  
        $newForm->SelectCommand = 'SELECT mwo_id, asset_id, short_desc as machDesc 
                                                             FROM mfg_eng_mwo.mwo 
                                                                 WHERE mwo_id =?';

          $newForm->table = 'mfg_eng_mwo.mwo'; 
        $newForm->setPrimaryKeys('mwo_id'); 
        $newForm->serialKey = true; 

        // Set Form layout  
        $newForm->setColumnLayout('twocolumn'); 
        $newForm->setTableStyles('width:500px;','','');

            $statusSQL =   'SELECT distinct type FROM mfg_eng_mwo.wo_status';
            $prioritySQL = 'SELECT distinct type FROM mfg_eng_mwo.wo_priority';
            $deptSQL =     'SELECT dept_id FROM mfg_eng_mwo.department';

            $deptData = '-1:Select a Department';
        $machData = "";
        $assetData = "";
        $postData = "";

            if(isset($row))
            {
            $deptData = "$row[dept]:$row[dept]";
            $machData = "$row[asset_no]:$row[machDesc]";
            $assetData =$row['asset_no'];
            $postData = $row['post'];
            }

            $parts = '-:Order Parts?;1:YES;0:NO';
            $tools = '-:Order Tools?;1:YES;0:NO';

        // Add elements         
            $newForm->addElement('woStatus',   'select',   array('label' => '<b>Status</b>',            'datasql' => $statusSQL, 'id' => 'woStatus', 'required'=>true));
        $newForm->addElement('WOPriority', 'select',   array('label' => '<b>Priority</b>',          'datasql' => $prioritySQL, 'id' => 'woPriority'));
            $newForm->addElement('dept',       'select',   array('label' => '<b>Deptartment</b>',       'datalist' => $deptData,  'datasql' => $deptSQL, 'id' => 'dept', 'required'=>true));        
        $newForm->addElement('machDesc',   'select',   array('label' => '<b>Machine Desc</b>',      'datalist' => $machData, 'id' => 'machDesc','required'=>true));
            $newForm->addElement('asset_id',   'text',     array('label' => '<b>Asset ID#</b>',         'value' => $assetData, 'size' => '20', 'id' => 'MWOForm_asset_id', 'readonly'=>true, 'required'=>true));        
            $newForm->addElement('post',       'text',     array('label' => '<b>Post</b>',              'value' => $postData, 'maxlength' => '40', 'id' => 'post', 'readonly'=>true, 'required'=>true));
            $newForm->addElement('requester',  'text',     array('label' => '<b>Requester</b>',         'value' => $_SESSION['user'], 'maxlength' => '60',  'id' => 'requester', 'readonly'=>true, 'required'=>true));
        $newForm->addElement('enterTime',  'text',     array('label' => '<b>Created</b>',           'value' => $displayDate, 'maxlength' => '15', 'size' => '20', 'id' => 'enterTime', 'readonly'=>true,'required'=>true));
        //$newForm->addElement('short_desc', 'text',     array('label' => '<b>Short Description</b>', 'maxlength' => '15', 'size' => '20', 'id' => 'short_desc', 'required'=>true));
            //$newForm->addElement('parts',      'select',   array('label' => '<b>Parts Needed</b>',      'datalist' =>     $parts, 'id' => 'parts', 'required' => 'true', 'hidden' => 'true'));
            //$newForm->addElement('tools',      'select',   array('label' => '<b>Tools</b>',             'datalist' => $tools, 'id' => 'tools', 'hidden' => 'true'));
        $newForm->addElement('problem',    'textarea', array('label' => '<b>Problem</b>', 'rows' => "3", 'cols' => "50", 'id' => 'problem', 'required'=>true));
        $newForm->addElement('solution',   'textarea', array('label' => '<b>Solution</b>', 'rows' => "3", 'cols' => "50", 'id' => 'solution'));
            $elem_8[]=$newForm->createElement('newSubmit','submit', array('value' => 'Submit')); 
        $newForm->addGroup("newGroup",$elem_8, array('style' => 'text-align:right;', 'id' => 'newForm_newGroup'));

    // Add events
    $onchangeDept = <<< CHANGEDEPT
    function(event) 
    {
      $("#machDesc").show();    
        var deptval =  $("#dept").val();    
        jQuery.ajax(
        { 
          url: 'machine.php', 
          dataType: 'json', 
          data: {q:deptval}, 
          success : function(response) 
          {                                     
                 $('#machDesc').find('option').remove();    
                     $('#machDesc').append('<option value=-1>Select Equipment</option>');                                     
                 jQuery.each(response, function(i,mach) 
                 { 
                  $('#machDesc').append('<option value='+mach.asset_no+'>'+mach.asset_no+'::'+mach.short_desc+'</option>');                         
             });
                     $('#asset_no').val('');                          
             $('#post').val('');                     
          }             
       });      
    }
    CHANGEDEPT;
    $newForm->addEvent('dept','change',$onchangeDept);

    $onchangeMach = <<< CHANGEMACH
    function(event) 
    {       
      var assetval = $("#machDesc").val();  
        jQuery.ajax(
        { 
                url: 'post.php', 
          dataType: 'json', 
          data: {q:assetval},               
          success : function(response) 
          {                                                                           
                 jQuery.each(response, function(i,mach) 
                 {
                      $('#MWOForm_asset_id').val(mach.asset_no); 
                $('#post').val(mach.post);                          
           });

          } 
       });      
    }
    CHANGEMACH;
    $newForm->addEvent('machDesc','change',$onchangeMach);

    $beforeSubmit = <<< BS
    function(arr, form, options) 
    {  
        var toolval =  $("#tool").val();
        var partval =  $("#part").val();

      if(toolval == 0 || toolval == 1) 
      { 
        alert("Please select 'YES' or 'NO' for tools."); 
        return false; 
      } 
        if(partval != 1 || partval != 0) 
      { 
        alert("Please select YES or NO for tools."); 
        return false; 
      }
    } 
    BS;

    // Add events
    $onclicknewButton = <<< CLICKNEWBUTTON
    function(event) 
    {
      if($("#ajax-dialog") ) {
        $("#ajax-dialog").remove();
      }
    }
    CLICKNEWBUTTON;
    $newForm->addEvent('close_modal','click',$onclicknewButton);
    // Add ajax submit events
    $success = <<< SU
    function( response, status, xhr) {
    if(response=='success')
    {
      $("#grid").trigger("reloadGrid", [{current:true}]);
    }
    }
    SU;

    // Add ajax submit events 
    $newForm->setAjaxOptions( array('dataType'=>null, 
                                    'resetForm' =>false,
                                                                    'clearForm' =>false,
                                                                    'success' =>'js:'.$success,
                                                                    'beforeSubmit' =>'js:'.$beforeSubmit,
                                                                    'iframe' => false,
                                                                    'forceSync' =>false) ); 

    // Render the form  
    echo $newForm->renderForm($jqformparams);

    ?>
    </body> 
```

# php - 如何覆盖 Mage_Checkout_Block_Links

> ID：16041016
> 
> 赞同：1
> 
> 时间：2013-04-16T15:27:59.463
> 
> 标签：php, xml, magento

覆盖方法的正确方法是什么，例如 Mage_Checkout_Block_Links::addCartLink() 方法。

我的目标是在 Mage_Checkout_Block_Links::addCartLink() 方法之前添加一些 HTML。但是，我不知道从哪里开始或在我的自定义主题下复制和编辑哪个文件。

我正在考虑这样的事情：

```
public function addLink($beforeText='<i class="icon-shopping-cart"></i>') 
```

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:46:14.693

您可以通过以下方式执行此操作：首先您必须在 config.xml 中重写核心块功能的代码。代码将像

```
<checkout>
        <rewrite>
            <links>My_Module_Block_Checkout_Links</links>
        </rewrite>
    </checkout>. 
```

比在你的块中创建带有结帐的文件夹和文件机智link.php。并且在link.php中扩展你的类。`extends My_Module_Block_Checkout_Links`用新代码编写你的链接函数。我希望这会对你有所帮助。我没有检查这段代码，但是以前做过这样的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T19:52:57.850

您可以通过简单的覆盖或模块/块重写来完成（推荐但需要更多的努力和 Magento 知识）。

使用覆盖：在本地文件夹中创建一个 Mage 文件夹。复制文件类 Mage_Checkout_Block_Links 并将其放置在与核心文件夹中相同的路径中。修改函数 public function addCartLink()。

使用重写：创建名称空间文件夹而不是 mag 文件夹。还要确保您有一个重写节点，如上面帖子中所述

其他方式：另外，如果您只是修改“我的购物车”语言定义，就可以了。

# memory-management - 为什么要在 rebol 中分配一个变量？

> ID：16041017
> 
> 赞同：2
> 
> 时间：2013-04-16T15:28:00.797
> 
> 标签：memory-management, rebol

我在一些 Rebol 代码中发现了这样的一行：

```
dups: make block! 10000 
```

为什么要在 Rebol 中使用预分配？

只写有什么问题：

```
dups: copy [] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T15:42:53.060

第一件事：你不会在 Rebol 中“分配一个变量”，而是“预先分配一个系列缓冲区”（它恰好被代码示例中的一个单词引用，但它可能只是位于一个块中）。

快速回答：每次您将数据插入或追加到系列时，如果系列缓冲区已满，则内存管理器会将系列重新分配给更大的缓冲区。如果您多次扩展一个系列（例如在循环中将数据附加到系列），如果您不预先分配，您最终可能会为所有重新分配消耗大量额外内存，并且可能在某个时候，也触发垃圾收集器通道。这通常会导致程序执行速度大大减慢并消耗大量额外内存。将系列缓冲区预分配到足够大的大小以容纳所有最终数据，将避免所有这些内存和性能问题。

在 的情况下`dups: copy []`，您正在分配一个最小系列缓冲区（大小可能为 8 或 16 个插槽），因此如果您的所有数据都不适合此缓冲区，您的程序将支付重新分配的（沉重）成本（ s)。也是`[]`一个预先分配的最小大小的文字系列，您只是将其用作构建新系列的模板，因此最好避免浪费内存并改为编写：`dups: make block! 0`这将分配一个块！系列最小尺寸，不浪费额外的块！系列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-14T12:15:42.140

预分配缓冲区对于低级函数 read-io 是必不可少的

如果您需要例如在读取数据时访问确切的错误代码，您可以使用 read-io 而不是在打开的端口上复制。

read-io 与 c 语言中的 READ 相当。您为 read-io 提供了预先分配的固定缓冲区和缓冲区长度。如果您尝试使用超过预先分配的缓冲区长度的 read-io，您将自行承担风险

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T08:02:38.657

我刚测试

```
>> a: make block! 10000
>> b: copy []
>> delta-time [loop 10000 [append a 1]]
== 0:00:00.004315
>> delta-time [loop 10000 [append b 1]]
== 0:00:00.005795 
```

差别只是不到百分之一秒。

然后我重新启动 rebol 并测试：

```
>> a: make block! 10000
>> b: copy []
>> delta-time [loop 20000 [append a "test"]]
== 0:00:00.000238
>> delta-time [loop 20000 [append b "test"]]
== 0:00:00.000223 
```

**没有预分配比预分配更快！**

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-18T12:33:21.213

我同意 Ladislav 的观点，即**增量时间**可能不可靠。但是我不认为现代 PC 需要预先分配，一个简单的浏览器插件会浪费大量内存。我相信 Rebol 垃圾收集器对于普通使用来说已经足够了。（可能在Android设备速度和内存上还是有问题的）

# ios - Appirater 不要求审查

> ID：16041021
> 
> 赞同：0
> 
> 时间：2013-04-16T15:28:18.750
> 
> 标签：ios, ios5, ios6, appirater

我正在安装 Appirater 应用程序审查库，可以在这里找到： [https ://github.com/arashpayan/appirater](https://github.com/arashpayan/appirater)

我在 Appirater.m 中设置这些值只是为了测试它是否要求我查看：

```
static NSString *_appId;
static double _daysUntilPrompt = 30;
static NSInteger _usesUntilPrompt = 2;
static NSInteger _significantEventsUntilPrompt = -1;
static double _timeBeforeReminding = 1;
static BOOL _debug = NO;
static id<AppiraterDelegate> _delegate;
static BOOL _usesAnimation = TRUE;
static UIStatusBarStyle _statusBarStyle;
static BOOL _modalOpen = false; 
```

我像这样配置了我自己的 AppDelegate：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    ....   
    [Appirater appLaunched:YES];

    return YES;
}

- (void)applicationWillEnterForeground:(UIApplication *)application
{
    [Appirater appEnteredForeground:YES];
} 
```

但是当我打开应用程序两次时，它并没有要求我添加评论。有人知道是什么原因造成的吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T15:51:03.667

出于测试目的，您应该设置`static BOOL _debug = YES;`. 在将应用程序添加到之前，请`AppStore`确保您设置了`appID`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T15:46:25.063

更改`_daysUntilPrompt`为较低的值，例如`1`或`0`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T15:49:30.623

在 Appirator.h 中更改它以进行测试：

```
#define APPIRATER_DEBUG YES 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-16T15:53:00.837

Appirater 将执行以下检查以确定是否显示提示：

```
 if (secondsSinceLaunch > secondsUntilPrompt 
 && launchCount > LAUNCHES_UNTIL_PROMPT) 
```

这两个条件都必须满足。天数和启动次数。

如果您将您的设置`DAYS_UNTIL_PROMPT`为`0`，它将起作用。或者，如果您设置`APPIRATER_DEBUG`为 1，则将始终显示提示。

另请注意，我有一个 appirater 的分支，它通过改进的代码和新功能得到了相当大的增强，例如内存使用改进、多种语言的本地化以及何时显示评级请求对话框的附加选项。[在这里你](https://github.com/memmons/appirater)可以检查一下。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-21T14:20:15.127

只需设置`[Appirater setDebug:YES];`，您每次启动应用程序时都会询问。无需更改 Appirater.m 或 Appirater.h

在上传到 AppStore 之前不要忘记将其设置回 NO

# html - 将引导图像库添加到 Rails 应用程序

> ID：16041022
> 
> 赞同：0
> 
> 时间：2013-04-16T15:28:20.040
> 
> 标签：html, ruby-on-rails, twitter-bootstrap, paperclip, image-gallery

我找到了 gem [bootstrap-addons-rails](https://github.com/kristianmandrup/bootstrap-addons-rails)并想在我的 Rails 应用程序中将它用于图像库。

我已经建立了一个模型*库，并通过与模型**Image*的多对关系将它连接起来。为了存储我使用回形针的图像。现在我想构建视图（画廊控制器中的显示操作）并尝试遵循***Bootstrap Image Gallery***的文档，其中说：

```
<div id="gallery" data-toggle="modal-gallery" data-target="#modal-gallery">
    <a href="banana.jpg" title="Banana" data-gallery="gallery">Banana</a>
    <a href="apple.jpg" title="Apple" data-gallery="gallery">Apple</a>
    <a href="orange.jpg" title="Orange" data-gallery="gallery">Orange</a>
</div> 
```

我从以下观点开始：

```
<div id="gallery" data-toggle="modal-gallery" data-target="#modal-gallery">
  <% @gallery.images.each do |image| %>
    <%= image_tag(image.url.url(:original)) %>
  <% end %>
</div> 
```

但我不知道如何将 HTML-Snippet 转换为运行良好的 Rails-Code。特别是*href="apple.jpg"*是我的问题。我不知道我怎么能把这样的东西放在那里：

`image_tag(image.url.url(:original))`

我会很感激任何答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T15:47:56.763

如果要链接到图像，请使用以下代码：

```
<%= link_to image.url.url(:original), "Image", :data => {:gallery => 'gallery'}, :title => "Apple" %> 
```

如果您希望实际图像具有数据类型属性，请使用以下代码：

```
<%= image_tag(image.url.url(:original), :data => {:gallery => "gallery"}, :title => "Apple") %> 
```

希望能帮助到你！

# c++ - 读取二进制数据的麻烦

> ID：16041026
> 
> 赞同：0
> 
> 时间：2013-04-16T15:28:23.980
> 
> 标签：c++, fstream

读者和作家

```
#include<string>
#include<fstream>
#include<memory>

class BinarySearchFile{

     BinarySearchFile::BinarySearchFile(std::string file_name){

     // concatenate extension to fileName
     file_name += ".dat";

     // form complete table data filename
     data_file_name = file_name;

     // create or reopen table data file for reading and writing
     binary_search_file.open(data_file_name, std::ios::binary);  // create file

     if(!binary_search_file.is_open()){

          binary_search_file.clear();
          binary_search_file.open(data_file_name, std::ios::out | std::ios::binary);
          binary_search_file.close();
          binary_search_file.open(data_file_name), std::ios::out | std::ios::in | std::ios::binary | std::ios::ate;
     }

    std::fstream binary_search_file;

    void BinarySearchFile::writeT(std::string attribute){

        if(binary_search_file){
            binary_search_file.write(reinterpret_cast<char *>(&attribute), attribute.length() * 2);
        }
    }

    std::string BinarySearchFile::readT(long filePointerLocation, long sizeOfData) 
    {
        if(binary_search_file){
           std::string data;
           data.resize(sizeOfData);
           binary_search_file.seekp(filePointerLocation);
           binary_search_file.seekg(filePointerLocation);
           binary_search_file.read(&data[0], sizeOfData);
           return data; 
    }
}; 
```

读者来电

```
while (true){
    std::unique_ptr<BinarySearchFile> data_file(new BinarySearchFile("classroom.dat"));

    std::string attribute_value = data_file->read_data(0, 20);

} 
```

作家来电

```
 data_file->write_data("packard   "); 
```

writer 总共写入 50 个字节

```
"packard   101       500  " 
```

读者将阅读第一个`20 bytes`，结果是“X packard X”，其中`X`表示一些格式错误的数据字节。为什么以 x 字节数读回的数据损坏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T15:34:08.387

您不能通过将数据的地址转换为 a`char*`并希望得到任何有用的东西来简单地写出数据。您必须定义要使用的二进制格式并实现它。在 的情况下`std::string`，这可能意味着以某种格式输出长度，然后是实际数据。或者在需要固定长度字段的情况下，使用 强制字符串（或字符串的副本）到该长度`std::string::resize`，然后输出该长度，`std::string::data()`使用`char const*`.

当然，阅读也是类似的。您会将数据读入 a `std::vector<char>`（或对于固定长度字段， a `char[]`），然后解析它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:32:03.183

`binary_search_file.write(reinterpret_cast<char *>(&attribute), attribute.length() * 2);`
如果`std::string`需要，`char*`必须`char*`使用`attribute.c_str()`.
std::string 除了字符串指针还包含其他数据成员，例如分配器，您的代码会将所有这些数据写入文件。此外，我看不出有任何理由将字符串长度乘以 2。如果要输出终止零，+1 是有意义的。

# iphone - cocos2d 中的阻止触摸

> ID：16041028
> 
> 赞同：0
> 
> 时间：2013-04-16T15:28:38.567
> 
> 标签：iphone, xcode, cocos2d-iphone, touch, block

有没有办法完全阻止 cocos2d 中的触摸（假设文件或某些东西正在加载，我不希望用户能够按下任何东西）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T15:36:51.333

您需要手动删除菜单和图层的触摸。

//Cocos2d 2.0

```
menu.touchEnabled = NO;   
layer.touchEnabled = NO; 
```

//Cocos2d 1.0

```
menu.isTouchEnabled = NO; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T15:41:13.873

忽略所有交互：

```
 [[UIApplication sharedApplication] beginIgnoringInteractionEvents]; 
```

忽略使用：

```
[[UIApplication sharedApplication] endIgnoringInteractionEvents]; 
```

# jquery - jQuery Mobile - 与普通列表项混合的可折叠项

> ID：16041029
> 
> 赞同：4
> 
> 时间：2013-04-16T15:28:39.590
> 
> 标签：jquery, css, html, jquery-mobile, jquery-mobile-listview

很难让它发挥作用，这就是我想要的：

```
-Collapsible
---Item 1
---Item 2
---Item 3
-Normal list view item with link
-Collapsible
---Item 1
---Item 2
---Item 3 
```

所以基本上我想要一个普通的列表视图项，其中包含一个由可折叠元素包围的链接。

我尝试过使用手风琴和列表视图，但到目前为止我还没有接近。

```
<ul data-role="listview">
    <li>
        <div data-role="collapsible">
            <h3>Invite</h3>
            <ul data-role="listview" data-inset="false">
                <li><a href="#">Email Invite</a></li>
                <li><a href="#fb_invite">Facebook Invite</a></li>
                <li><a href="#twitter_invite">Twitter Invite</a></li>
                <li><a href="#address_book_invite">Address Book Invite</a></li>
            </ul>
        </div>
    </li>
    <li><a href="#">Normal item!</a></li>
</ul> 
```

这可以很好地创建功能，问题是可折叠列表具有按钮的视觉方面，我希望它看起来与普通的 li 项目完全一样。

欢迎任何解决此问题的方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T16:17:03.050

我很无聊，所以我为您提供了 2 个不同的解决方案。

# 解决方案1：

工作示例：http: [//jsfiddle.net/Gajotres/b3NR8/](http://jsfiddle.net/Gajotres/b3NR8/)

**HTML：**

```
<ul data-role="listview" id="custom-listview">
    <li class="custom-li">
        <div data-role="collapsible" class="custom-collapsible">
            <h3>Invite</h3>
            <ul data-role="listview" data-inset="false">
                <li><a href="#">Email Invite</a></li>
                <li><a href="#fb_invite">Facebook Invite</a></li>
                <li><a href="#twitter_invite">Twitter Invite</a></li>
                <li><a href="#address_book_invite">Address Book Invite</a></li>
            </ul>
        </div>
    </li>
    <li class="custom-li-last"><a href="#">Normal item!</a></li>
</ul> 
```

**CSS：**

```
.custom-collapsible {
    margin: 0 !important;   
}

.custom-collapsible h3 a {
    border-radius: 0 !important;
    border-width:0 !important; 
    border-bottom-width: 1px !important; 
}

.custom-li {
    padding: 0 !important;
}

.custom-li-last {
    border-top-width: 0 !important; 
} 
```

# 解决方案 2 - 插图版

工作示例：http: [//jsfiddle.net/Gajotres/xswkP/](http://jsfiddle.net/Gajotres/xswkP/)

**HTML：**

```
<ul data-role="listview" data-count-theme="c" data-inset="true">
    <li class="custom-li">
        <div data-role="collapsible" class="custom-collapsible">
            <h4>Heading</h4>
            <ul data-role="listview">
                <li><a href="#">List item 1</a></li>
                <li><a href="#">List item 2</a></li>
                <li><a href="#">List item 3</a></li>
            </ul>
        </div>
    </li>
    <li class="custom-bottom-li"><a href="#">Outbox <span class="ui-li-count">0</span></a></li>
    <li><a href="#">Drafts <span class="ui-li-count">4</span></a></li>
    <li><a href="#">Sent <span class="ui-li-count">328</span></a></li>
    <li><a href="#">Trash <span class="ui-li-count">62</span></a></li>
</ul> 
```

**CSS：**

```
.custom-li {
    padding: 0 !important;
    border-width:0 !important;
}

.custom-bottom-li {
    border-top-width: 0 !important;  
}

.custom-collapsible {
    margin: 0 !important;   
    border-bottom-right-radius: 0 !important;
    border-bottom-left-radius: 0 !important;
    border-width:0 !important;
} 
```

# mysql - MySQL UPDATE = 更新具有相同内容的字段是否有任何开销？

> ID：16041030
> 
> 赞同：0
> 
> 时间：2013-04-16T15:28:41.803
> 
> 标签：mysql

我有一个应用程序需要每隔 2 秒评估一次“消息”。

每次运行此评估时，系统都设计为选择当前行和列数据，对其进行处理，然后将其更新回表中。该脚本的设置方式是更新所有字段，而不管实际更改与否（为了更清晰的编码）..就像这样：

*   从 MESSAGES 表中选择所有行

*   全球化变量

*   从 MESSAGES_REMOTE 表中选择所有行

*   全球化变量 // 这有效地覆盖了第一个表中的现有变量

*   将所有变量更新到 MESSAGES 表中

现在，实际更新的列的范围可能从 1 variable 到 all variables ，具体取决于情况。

所以我想知道在尝试更新具有相同值的列时，MYSQL 是否会有相同的开销，或者它是否有某种内部引擎来检查是否需要执行实际的更新/写入

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:37:07.050

这回答了你的问题了吗？

```
 SELECT * FROM user;
 +---------+----------+
 | user_id | username |
 +---------+----------+
 |     101 | Adam     |
 |     102 | Ben      |
 |     103 | Charlie  |
 |     104 | Dave     |
 +---------+----------+
 4 rows in set (0.01 sec)

 UPDATE user SET username = 'Adam' WHERE user_id = 101;
 Query OK, 0 rows affected (0.18 sec)
 Rows matched: 1  Changed: 0  Warnings: 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-05T10:56:38.307

虽然[http://dev.mysql.com/doc/refman/5.6/en/update.html](http://dev.mysql.com/doc/refman/5.6/en/update.html)提到：

> 如果您将列设置为它当前具有的值，MySQL 会注意到这一点并且不会更新它。

这并不意味着没有开销。

通过打开一个连接，然后在单行上执行 1000 次更新，我在一个有 86 列的表上做了一些基准测试。

在方案 1 中，所有 86 列都设置为相同的值。这花了 557 毫秒。

在场景 2 中，只有 3 列设置为相同的值。这花了 290 毫秒。

所以，IO读取和CPU肯定有一些开销。

# html - 如何为带有文本块的图像设置样式？

> ID：16041037
> 
> 赞同：0
> 
> 时间：2013-04-16T15:28:57.863
> 
> 标签：html, css

我正在寻找一种可以重复使用的样式，它将创建以下布局。放置图像并将其向左浮动，然后将带有或不带有段落标签的文本放置在所述图像的右侧。文本将与左侧图像的顶部对齐。

除了文本不在顶部之外，我可以实现一切。这是我到目前为止所拥有的，文本居中而不是顶部对齐。

```
<div style="overflow:auto">
<div style="float:left">
    <a href="Images/img.jpg"><img src="Images/img.jpg" /></a>
</div>
<div>
    <p>this is some text that is getting centered along the img height</p>
    <p>Some more text... </p>
</div>
</div> 
```

这是做什么的例子。我需要与图像顶部对齐的 3 段和第 4 段。 [示例 http://www.spokanewastewater.org/Images/untitled.jpg](http://www.spokanewastewater.org/Images/untitled.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T15:31:47.350

我会为此做两件事。

在您的第一个段落标签上，添加以下样式。这将删除由第一个段落标签引起的间距。

```
<p style="margin-top:0;padding-top:0"></p> 
```

在图像上，下面的样式。有时，如果您不设置垂直对齐，图像会稍微偏离。但是我需要看一个 JSFiddle 才能看到你的渲染方式。

```
<img style="vertical-align:top"> 
```

另外，我应该补充一点，如果可能的话，这应该使用外部 CSS 表而不是内联来完成。

# java - 如何在循环中向变量添加值

> ID：16041039
> 
> 赞同：0
> 
> 时间：2013-04-16T15:29:02.273
> 
> 标签：java

我有一个简单的问题

我正在循环一段代码，这段代码的目的是收集所花费的时间。我可以在每次循环运行时执行此操作，但我想要做的是，例如，每次循环运行时收集持续时间，存储这些值，将它们加在一起，然后平均这些怎么能我实现了这个？

此外，当循环完成其时间时，它会继续前进并且需要重置总持续时间

这是我当前的代码：

```
 if (myrank == 0) {              
        for (int len = minlen; len <= maxlen; len *= 2) { //len=*2 doubles the ping size each time
            for (int i = 0; i < MAX_LOOPS;) {
            long startTime = System.nanoTime();                  

            long endTime = System.nanoTime();
            long duration = endTime - startTime;
            durationseconds = duration; // this is where i want to store all the durations               

            i++;
        } 
```

多谢你们 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T15:41:34.517

你可以有如下的东西：

```
 if (myrank == 0) {              
    for (int len = minlen; len <= maxlen; len *= 2) { 
   long durationseconds =0;
        for (int i = 0; i < MAX_LOOPS;) {
            ----
            durationseconds = durationseconds + duration;
              ---
        }

     float avgSecPerLoop = durationsseconds / MAX_LOOPS 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T15:36:20.270

尝试这个：

```
ArrayList<Long> durations = new ArrayList<Long>();
//start loop            
durations.add(duration);
// end loop 
```

每次迭代都有时间后，您可以计算平均值或总数或任何您想要的

或者更好（更快）但是如果您从一开始就知道您将进行多少次迭代，您可以使用原始数组来存储时间

```
long[] durations = new long[NB_ITERATIONS];
int counter=0;
//start loop            
durations[counter++] = duration;
//end loop 
```

# django - 为什么这个基于 Django 类的年份存档视图不起作用？

> ID：16041040
> 
> 赞同：1
> 
> 时间：2013-04-16T15:29:05.290
> 
> 标签：django, filtering, django-class-based-views

我正在尝试对 YearArchiveView 基于类的视图进行子类化，以显示一年中发表的文章列表，但过滤不起作用，example.com/2012 显示所有年份的文章。

请注意，我*不*希望 urls.py 中的视图代码。相反，我希望 LogbookYearArchive 包装器继续存在于 views.py 中。

## 模型.py：

```
class Entry(models.Model):

    KIND = (
        ('L', 'Link'),
        ('A', 'Article'),
    )

    title = models.CharField(max_length=200)
    slug = models.SlugField(unique_for_date='pub_date')
    kind = models.CharField(max_length=1, choices=KIND, default=1,
     help_text="Is this a link to other content or an original article?")
    url = models.URLField(blank=True, help_text="The link URL")
    body = models.TextField(blank=True)
    body_html = models.TextField()
    content_format = models.CharField(choices=CONTENT_FORMAT_CHOICES, 
                                            max_length=50, default=1)
    is_active = models.BooleanField(help_text=_("Tick to make this entry\
        live (see also the publication date). Note that administrators\
        (like yourself) are allowed to preview inactive entries whereas\
        the general public aren't."), default=True)
    pub_date = models.DateTimeField(verbose_name=_("Publication date"),
     help_text=_("For an entry to be published, it must be active and its\
      publication date must be in the past."))
    mod_date = models.DateTimeField(auto_now_add=True, editable=False)

    class Meta:
        db_table = 'blog_entries'
        verbose_name_plural = 'entries'
        ordering = ('-mod_date',)
        get_latest_by = 'pub_date'

    def __unicode__(self):
        return self.title

    @models.permalink
    def get_absolute_url(self):
        """Construct the absolute URL for an Entry of kind == Article."""
        return ('logbook-entry-detail', (), {
                            'year': self.pub_date.strftime("%Y"),
                            'month': self.pub_date.strftime("%m"),
                            'slug': self.slug}) 
```

## 网址.py：

```
from __future__ import absolute_import
from django.conf.urls import patterns, include, url

from .models import Entry
from .views import LogbookYearArchive

urlpatterns = patterns('',

    url(r'^(?P<year>\d+)/$',
        view=LogbookYearArchive.as_view(),
        name='archive-year'),

) 
```

## 视图.py：

```
from django.views.generic.list import MultipleObjectMixin
from django.views.generic import ArchiveIndexView, MonthArchiveView, YearArchiveView, DetailView
from django.core.urlresolvers import reverse

from .models import Entry

class LogbookYearArchive(YearArchiveView):
    """Yearly archives of articles"""
    model = Entry
    date_field = 'pub_date'
    year_format='%Y'
    make_object_list=True, 
    template_name = 'hth/archive_year.html'
    allow_future = False
    def get_context_data(self, **kwargs):
        context = super(LogbookYearArchive, self).get_context_data(**kwargs)
        # =todo: fix filtering by date which is not working
        context['object_list'] = Entry.objects.filter(
          is_active=True, kind='A').order_by('-pub_date', 'title')[:9999]
        return context 
```

## archive_year.html：

```
{% block content %}
    <h1 style="margin-bottom:1em;">Articles Published in {{ year|date:"Y" }}</h1>
    {% for object in object_list %}    
       {% ifchanged %}
           <h2 class="dateline datelinearchive">{{ object.pub_date|date:"F Y" }}</h2>
       {% endifchanged %}
           <p>
              <a href="{{ object.get_absolute_url }}">{{ object.title }}</a> 
           </p>
    {% endfor %}
{% endblock %} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:30:46.783

你可以试试这个：

```
class LogbookYearArchive(YearArchiveView):
    """Yearly archives of articles"""
    model = Entry
    date_field = 'pub_date'
    year_format='%Y'
    make_object_list=True, 
    template_name = 'hth/archive_year.html'
    allow_future = False
    queryset = Entry.objects.filter(
      is_active=True, kind='A').order_by('-pub_date', 'title') 
```

我添加了一个查询集属性并删除了 get_context_data()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-26T02:23:22.267

我有同样的问题。所有人`ArchiveViews`都在工作，除了`YearArchiveView`。`make_object_list`在属性中找到了解决方案。它应该是`True`

这是 django 代码的一部分

```
if not self.get_make_object_list():
    # We need this to be a queryset since parent classes introspect it
    # to find information about the model.
    qs = qs.none() 
```

# redis - 如何在 Redis 中相交并找到不同的键

> ID：16041042
> 
> 赞同：0
> 
> 时间：2013-04-16T15:29:08.557
> 
> 标签：redis, analytics, data-modeling, intersect

我希望尽可能高效地获取 redis 键列表。我们可以根据自己的喜好在 redis 服务器上对此进行建模，因此这与解决问题的正确方法一样重要。让我描述一下情况。

假设有大量“客户”作为字符串存储在 Redis 中。

```
customer__100000
customer__100001
customer__100002 
```

每个客户都有很多属性。其中将是他们居住的城市。每个城市也存储在 Redis 中。

```
city__New York
city__San Francisco
city__Washington DC 
```

通过不同的过程，我最终会得到一组客户密钥（预过滤器的相交集）。一旦我有了这些密钥，我需要找出哪些**不同的**我在这些客户中拥有我在这里的最终目标是获得城市的名称，但是如果我能获得可以提取城市名称的钥匙，那也很好。

为了给出我在这里谈论的规模的想法，假设我们正在处理具有大约 70 个属性（城市是其中之一）的 200-300k 客户，每个属性从 50 到 100,000。我想尽可能保持高效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T15:56:46.870

与其将客户存储为字符串，不如将它们存储为哈希值。Redis 的哈希 ziplist 编码非常节省空间。如果你存储超过 70 个元素，你应该考虑`hash-max-ziplist-entries`在你的 redis.conf 中提高限制

`SORT`当您使用 Redis 哈希时，您可以做一些有趣的事情。通过使用`SORT`with `GET`，`STORE`您可以从客户那里获取所有城市并将它们存储为列表（不区分）。然后，您可以通过调用`lpop`和`sadd`覆盖列表将列表转换为集合。

这是一个示例 Redis Lua 脚本：

```
-- a key which holds a set of customer keys
local set_of_customer_keys = KEYS[1]
-- a maybe-existing key which will hold the set of cities
local distinct_set = ARGV[1]
-- attribute to get (defaults to city)
local attribute = ARGV[2] or 'city'
-- remove current set of distinct_cities
redis.call("DEL", distinct_set)
-- use SORT to build a list out of customer hash values for `attribute` 
local cities = redis.call("SORT", set_of_customer_keys, "BY", "nosort", "GET", "*->"..attribute)
-- loop through all cities in the list and add them to the distinct cities set
for i, city in pairs(cities) do
  redis.call("SADD", distinct_set, city)
end
-- return the distinct cities
return redis.call("SMEMBERS", distinct_set) 
```

您还可以保留一`customer__100000__cities`组与客户的属性一起永久存储并用于`sinter *customer_cities_keys`获取一组不同的城市，但这会降低内存效率。

# jsp - 在会话范围 JSP 中实例化整数变量

> ID：16041043
> 
> 赞同：0
> 
> 时间：2013-04-16T15:29:10.927
> 
> 标签：jsp

我正在尝试使用下面的代码来实例化一个 Integer 变量，但我不断收到类似*java.lang.InstantiationException: Not defined beanName or class 的错误！*

```
<jsp:useBean id="selectedID" scope="session" type="java.lang.Integer" /> 
```

我不确定，但这段代码曾经在 JDK 1.4 中工作，但在 JDK 1.6 中却抛出异常。有没有其他方法可以在 JSP 中实例化 Integer 变量？

我尝试使用*class="java.lang.Integer* " 但它不起作用，因为 Integer 包装器没有无参数构造函数。我也尝试了下面的代码，但它在运行时重置了值。

```
<% java.lang.Integer selectedID; %> 
```

*在 Java 块中的 JSP 中使用 *selectedID ：* *switch (selectedID.intValue())**

 **selectedID*在会话中的 java 类中的某个位置设置。然后在 JSP 中使用设置的值来呈现特定的界面。我只需要在 JSP 中实例化（未初始化）变量。

任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-16T15:37:19.637

```
<% session.setAttribute("selectedID", new Integer(0)); %> 
```

?

如果你需要从请求中获取它，你可以使用request.getParameter()，并从会话中获取它，session.getAttribute()。*

# javascript - 为每个元素将列的高度设置为另一个

> ID：16041044
> 
> 赞同：0
> 
> 时间：2013-04-16T15:29:11.147
> 
> 标签：javascript, jquery

可悲的是，我需要使用 JS 将`col-1`（静态）设置为与文本容器（动态）相同的高度`col-2`。

我试过了：

```
$(function () {

    var article = $('section.inner-services article');

    $(article).each(function( index ) {

        var textColHeight = $('section.inner-services article .col-2').height();
        var figureCol  = $('section.inner-services article .col-1');
        $(figureCol).css('height', textColHeight);
        console.log(index);

    });

}); 
```

我的 HTML 标记是（简体）：

```
<section class="inner-services"> 
    <article> 
        <col-1> 
        <col-2> 
    </article> 
</section> 
```

这不会`article`按预期循环遍历每个并将`col-1`高度设置为`col-2`.

如果可能，请简要说明我哪里出错了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:31:35.320

你需要寻找`col-2`并`col-1`在每个`article`

```
$(function () {

    var article = $('section.inner-services article');

    $(article).each(function( index ) {

        var textColHeight = $(this).children('.col-2').height();
        var figureCol  = $(this).children('.col-1');
        $(figureCol).css('height', textColHeight);
        console.log(index);

    });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:33:50.843

一开始，一旦你创建了 jQuery 对象，就不需要再次创建它，所以不需要`$(article)`.

在第二个内部`each`，您可以将当前元素称为`this`.

正确的代码可能如下所示：

```
$(function () {

    $('section.inner-services article').each(function( index ) {

        var textColHeight = $(this).find('.col-2').height();
        var figureCol  = $(this).find('.col-1').height(textColHeight);

        console.log(index);

    });

}); 
```

# php - 遵循教程时无法连接到数据库

> ID：16041048
> 
> 赞同：1
> 
> 时间：2013-04-16T15:29:24.680
> 
> 标签：php, mysql

我是一个相当新手的编码器，有一个问题我希望有人可以帮助我。

我正在学习一系列教程，并且在能够遵循方面取得了一定的成功，更有趣的是，该站点连接到数据库并在请求的地方显示数据库的内容，但是当我尝试执行一个函数时，我'我正在工作，我使用密码 NO 消息拒绝访问。

这是我的函数的外观

```
function Member_Data($user_id) {
    $data = array();
    $user_id = (int)$user_id;

    $func_num_args = func_num_args();
    $func_get_args = func_get_args();

    if($func_num_args > 1) {
        unset($func_get_args[0]);

        $fields = '`' . implode('`, `', $func_get_args) . '`';
        $data = mysql_fetch_assoc(mysql_query("SELECT $fields FROM `members` WHERE `ID` = $user_id"));
        echo mysql_error();

        print_r($data);
        //die();
        //return $data;
    }
} 
```

在我拥有的标签之前的 head.php 中

```
if(loggedin() === true) {
    $Session_memberID = $_SESSION['memberID'];
    $MemberData = Member_Data($Session_memberID, 'ID', 'FName', 'LName', 'Email', 'Password');
    } 
```

但是当我尝试检索数据时（即：print_r($data);）我得到一个空白屏幕但是当我添加 echo mysql_error(); 我得到：用户'obscuredforsecurity'@'localhost'的访问被拒绝（使用密码：否）

但是所有其他页面都连接得很好，而且我在连接其他教程时没有问题，但由于某种原因（我不知道）我无法连接它，所以我可以按照本教程进行操作。

如果有人不介意与我分享我做错了什么，我将不胜感激，我再次感谢大家。

斯图尔特 K

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:05:26.187

正如 Adelphia 所说，这将有助于了解您如何连接到数据库，因为您指出的错误是与连接相关的错误。

另外，要小心这个函数之外的副作用，也许是在调用这个函数之前意外关闭数据库连接的副作用（别笑，它发生的次数比你想象的要多；我们开发人员偶尔会做那些愚蠢的错误！）

在进行查询之前，请回显 mysql_error() - 如果您在调用之前发现数据库连接不可用，我不会感到惊讶。如果是这种情况，请找出连接是如何关闭的。（提示：在整个代码库中搜索 mysql_close()）

旁注：不推荐使用 mysql_ 函数，开始迁移远离它们的建议是合理的。看看 mysqli_ 函数 - 它们在很多方面都接近 mysql_ 并且易于学习:)

# javascript - 使用数组中的值作为属性

> ID：16041049
> 
> 赞同：-3
> 
> 时间：2013-04-16T15:29:25.763
> 
> 标签：javascript

所以我有一个类似字典的对象和一个数组：

```
var colors = {"b":color(0, 0, 0)};
var ar=[["b","0","0"],["b","b","0"],["b","b","b"]]; 
```

现在，我想使用数组从字典中获取值，如下所示：

```
colors.ar[0][0] 
```

这应该给我黑色。但是，这给了我一个错误：

```
Cannot read property '0' of undefined 
```

我相信这是因为它试图访问 colors."b" 而不是 colors.b 。

那么如何使用数组中的值从字典中获取属性呢？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T15:30:12.243

我得到它。你想要的是这样的：

`colors[ar[0][0]]`

既然`ar[0][0]`解决了`"b"`，就`colors[ar[0][0]]`解决了`colors["b"]`。

如果您使用点表示法，它将尝试访问`colors.ar`未定义的内容。

# .net - ComboBox 上的 ClearAllBindings 导致源更新

> ID：16041055
> 
> 赞同：4
> 
> 时间：2013-04-16T15:29:33.217
> 
> 标签：.net, wpf, data-binding

我正在使用 WPF 数据绑定编写一个具有相当大表单的 WPF 应用程序。

我注意到当我“放开”表单元素时，它们的存活时间比我想要的要长得多，这意味着它们会继续从视图中获取更新，导致我的应用程序明显变慢。为了防止这种情况发生，我递归遍历文档并`BindingOperations.ClearAllBindings()`在 WPF 树的一部分被释放时调用每个元素。

现在我遇到了以下问题。如果我的视图包含一个数据绑定的组合框，如下所示：

```
 <ComboBox  ItemsSource="{Binding Path=SourceItems}" SelectedValue="{Binding SelectedItem}" /> 
```

在`ItemsSource`绑定之前绑定可能会被删除`SelectedValue`。结果，`SelectedItem`我的数据模型中的 设置为`null`. 这是没有预料到的！

我的问题是：有没有一种安全的方法来清除表单的所有数据绑定而没有这种副作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T11:43:51.463

在典型的 MVVM 应用程序中，将`DataContext`视图设置为`null`将实现您想要的，而无需通过可视化树进行昂贵且容易出错的递归。这是因为`DataContext`是继承的，并且所有绑定通常都会针对`DataContext`.

# optimization - 优化三地址码

> ID：16041056
> 
> 赞同：0
> 
> 时间：2013-04-16T15:29:35.997
> 
> 标签：optimization, assembly, compiler-construction, compiler-optimization, machine-code

我有以下三个地址代码，其中 n 是一些外部常数：

```
 x = 0
   i = 0
L: t1 = i * 4
   t2 = a[t1]
   t3 = i * 4
   t4 = b[t3]
   t5 = t2 * t4
   x = x + t5
   i = i + 1
   if i < n goto L 
```

我想尽可能地优化它。到目前为止，这是我想出的：

```
 x = 0
    i = 0
    t1 = -4
L:  t1 = t1+4
    t5 = a[t1] * b[t1]
    x = x + t5
    i = i + 1
    if i < n goto L 
```

任何人都可以提供更正/额外的优化吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:40:46.250

我可能会做这样的事情：

```
 x = 0
    t1 = (n-1)*4
L:  t5 = a[t1] * b[t1]
    x = x + t5
    t1 = t1 - 4
    if t1 >= 0 goto L 
```

我不知道目标机器是什么，但最后两条指令通常可以用`SUB`/之类的东西来完成`JNS`（这样可以节省比较）。

# iphone - 如何使用“var abcd =”标头解析 json 数据

> ID：16041058
> 
> 赞同：0
> 
> 时间：2013-04-16T15:29:42.360
> 
> 标签：iphone, objective-c, json, cocoa-touch, nsjsonserialization

我在 iOS 上解析 json 数据文件时遇到问题。这是 data.json 文件中的一个示例：

```
var devs = [
{
"ident":"1",
"firstname":"Jan", 
"lastname":"Kowalski", 
"img":"http://www.placekitten.com/125/125", 
"tech":"iOS, HTML5, CSS, RWD",
"github":"placeholder",
"opensource":"1",
"twitter":"placeholder"
},
{
"ident":"2",
"firstname":"WacĹaw", 
"lastname":"GÄsior", 
"img":"http://www.placekitten.com/124/125",
"tech":"Android, Java, Node.js",
"github":"GÄsiorBKR",
"twitter":"wacek5565"
}, 
```

等等。

对于我使用的“普通”json文件：

```
NSURLResponse *response;
NSError *myError;
NSURLRequest *urlRequest = [NSURLRequest requestWithURL:[NSURL      URLWithString:@"http://somerailsapplication/posts.json"]     cachePolicy:NSURLRequestReloadIgnoringCacheData timeoutInterval:30.0f];
NSData *data = [NSURLConnection sendSynchronousRequest:urlRequest returningResponse:&response error:&myError];
NSDictionary *res = [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingMutableLeaves error:&myError]; 
```

不幸的是，这个解决方案在这种情况下不起作用。是否有机会在不搜索下载数据中的特定字符串“var dev=[”和最后一个“]”的情况下使其正常工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T15:37:16.003

响应是 javascript，而不是 JSON，因此您将无法直接使用 JSON 解析器。如果您无法更改服务器输出，最简单的方法是按照您的建议剥离数据的开头和结尾。您还可以将响应嵌入到 HTML 模板中并在 web 视图中对其进行评估，但这似乎需要做很多工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:49:11.230

从您获得数据的那一点开始：

```
NSData *data = [NSURLConnection sendSynchronousRequest:urlRequest returningResponse:&response error:&myError];
NSMutableString *dataAsString = [[NSMutableString alloc] initWithData:data encoding:NSUTF8StringEncoding];
[dataAsString deleteCharactersInRange:NSMakeRange(0, 11)];
data = [dataAsString dataUsingEncoding:NSUTF8StringEncoding];
NSArray *res = [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingMutableLeaves error:&myError]; 
```

这会将数据转换为字符串，删除前 11 个字符，将其转换回数据，然后正常解析。（我已将其更改为 NSArray，因为您的数据在数组中）

# xsl-fo - 如何在表格 cell-xsl-fo 中换行

> ID：16041059
> 
> 赞同：1
> 
> 时间：2013-04-16T15:29:44.283
> 
> 标签：xsl-fo

我使用以下 xsl 来创建表。我使用 wrap-option 进行文本换行，但我无法换行文本。长文本进入下一列。

```
 <xsl:template
    match="ENTRY">
    <fo:table-cell
        wrap-option="wrap"
        padding="2px"
        border-bottom="03px"
        border-collapse="collapse">

        <xsl:choose>
            <xsl:when
                test="@MOREROWS">
                <xsl:attribute
                    name="number-rows-spanned">
            <xsl:value-of
                    select="@MOREROWS" />
            </xsl:attribute>
            </xsl:when>
        </xsl:choose>
        <xsl:choose>
            <xsl:when
                test="@COLSPAN">
                <xsl:attribute
                    name="number-columns-spanned">
            <xsl:value-of
                    select="@COLSPAN" />
            </xsl:attribute>
            </xsl:when>
        </xsl:choose>
        <fo:block>
            <xsl:apply-templates />
        </fo:block>
    </fo:table-cell>
</xsl:template> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T07:30:36.790

请尝试您的 'wrap-option' 属性

```
 <fo:block>
     <xsl:apply-templates />
    </fo:block> 
```

# matlab - Windows上matlab中的ffmpeg

> ID：16041061
> 
> 赞同：1
> 
> 时间：2013-04-16T15:29:45.590
> 
> 标签：matlab, ffmpeg

有没有办法在 windows 上的 matlab 中运行 ffmpeg 命令。

我知道在 Linux 上我们可以使用函数 system('...') 来运行任何命令，但我如何在 Windows 上做到这一点？

任何想法将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:05:45.367

[system](http://www.mathworks.com/help/matlab/ref/system.html)命令在Windows 机器上也应该可以正常工作。例如，我在 64 位 Windows 7 上运行以下没有问题：

```
 system('ffmpeg -i C:\Users\Sam\demo.wav C:\Users\Sam\demo2.mpg') 
```

# forms - 如何在 Symfony2 中传递带有表单的对象

> ID：16041062
> 
> 赞同：0
> 
> 时间：2013-04-16T15:29:48.247
> 
> 标签：forms, object, select, symfony, doctrine

我有个问题。一开始，这是我创建表单的操作：

```
public function wyswietlDostepneTerminyAction($kategoria) {
    $zlecenie = new Zlecenia();

    $form = $this->createForm(new ZleceniaAddType(), $zlecenie);

    return array ('form' => $form->createView(), 'kategoria'=>$kategoria);
} 
```

'Zlecenie' 对象具有 'Kategorie' 类型的 'Kategoria' 字段（其来自关系）。

持久化实体的方法：

```
public function noweZlecenieAction(Request $request) {
    $entity  = new Zlecenia();
    $form = $this->createForm(new ZleceniaAddType(), $entity);
    $form->bind($request);

    if ($form->isValid()) {
        $em = $this->getDoctrine()->getManager();
        $em->persist($entity);
        $em->flush();

        return $this->redirect($this->generateUrl('pokaz-zlecenie', array('id' => $entity->getId())));
    }

    return array(
        'entity' => $entity,
        'form'   => $form->createView(),
    );
} 
```

并形成类：

```
public function buildForm(FormBuilderInterface $builder, array $options)
{
    $builder
        ->add('opis')
        ->add('klient', new KlientType())
        //->add('kategoria')
    ;
} 
```

通常，我可以添加如下字段：

```
->add('kategoria','entity', array('class'=>'Acme\MyBundle\Entity\Zlecenia') 
```

并从列表中选择类别。

但问题是：我不想从选择列表或复选框列表中选择类别。我想使用预定义的 $kategoria 对象。当然（如果必须存在）“类别”字段必须隐藏。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:07:40.857

试试这个，调整你的目录结构：Formtype：

```
 public function buildForm( FormBuilderInterface $builder, array $options ) {
        if ( isset( $options['attr']['kategoria'] ) ) {
            $kategoria = $options['attr']['kategoria'];
        }
        else {$kategoria=null;}
        $builder
        ->add( 'opis' )
        ->add( 'klient', new KlientType() );
        if ( $kategoria ) {
            $transformer = new KategoriaTransformer( $em );
            $builder->add(
                $builder->create( 'kategoria'
                    ->add( 'kategoria', 'hidden', array()
                    )
                )
                ->addModelTransformer( $transformer );
            }  else {
                ->add( 'kategoria', 'entity'
                     , array( 'class'=>'Acme\MyBundle\Entity\Zlecenia' )
                }
                ;
            } 
```

还有变压器：

```
 namespace Acme\MyBundle\Entity\Zlecenia\Transformer;

    use Doctrine\Common\Persistence\ObjectManager;
    use Symfony\Component\Form\DataTransformerInterface;
    use Symfony\Component\Form\Exception\TransformationFailedException;

    class kategoriaTransformer implements DataTransformerInterface
    {
        /**
        * @var ObjectManager
        */
        private $em;

        /**
        * @param ObjectManager $em
        */
        public function __construct(ObjectManager $em)
        {
            $this->em = $em;
        }

        /**
        * Transforms an object (kategoria) to a string (id).
        *
        * @param  Issue|null $kategoria
        * @return string
        */
        public function transform($kategoria)
        {
            if (null === $kategoria) {return "";}
            if (is_object($kategoria) && 
                method_exists($kategoria, "toArray")){
                $kategoria=$kategoria->map(function ($ob){
                     return $ob->getId();});
                return implode(",",$kategoria->toArray());
            }
            return $kategoria->getId();
        }

        /**
        * Transforms a string (id) to an object (kategoria).
        *
        * @param  string $id
        * @return Issue|null
        * @throws TransformationFailedException 
        *         if object (kategoria) is not found.
        */
        public function reverseTransform($id)
        {
            if (!$id) {
                if($this->multi) {return array();}
                return null;
            }

            if (strpos($id,',') !== false) {
                $id=explode(',',$id);
            }
            $qb=$this->em->getRepository(
            'Acme\MyBundle\Entity\Zlecenia\Repository\kategoria'
            )
            ->createQueryBuilder('k');
            $qb->andWhere($qb->expr()->in('i.id', $id));
            if (is_array($id) || $this->multi){
                $kategoria=$qb->getQuery()
                ->getResult();
            } else {
                $kategoria=$qb->getQuery()
                ->getSingleResult();
            }
            if (null === $kategoria) {
                throw new TransformationFailedException(sprintf(
                    'A kategoria with id "%s" does not exist!',
                    $id
                    ));
            }

            return $kategoria;
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:24:03.110

您可以创建一个数据转换器，将用户在表单中输入的数据转换为其他内容。在您的情况下，您会将用户提交的类别 ID 转换为类别对象。此处对您来说最好的选择是定义表单中的“类别”属性将是隐藏表单类型。呈现表单时，您将隐藏一个输入，该输入将存储您的类别对象的 ID。提交表单后，转换器会将该 ID 反转为对应的类别对象。由于您要定义默认类别，在您的控制器中创建 Klient 对象后，您应该设置类别。

如果您遵循此来源[http://symfony.com/doc/master/cookbook/form/data_transformers.html](http://symfony.com/doc/master/cookbook/form/data_transformers.html)，一切都会好起来的。有什么问题就说

# html - HTML5 - 在图像上显示来自 Textarea 的键入文本

> ID：16041063
> 
> 赞同：0
> 
> 时间：2013-04-16T15:29:48.997
> 
> 标签：html, canvas

我想在图像上显示键入的文本（如果一个人`textarea`在一个图像中键入文本，则该文本应该在图像上立即可见）。我已经开发了以下代码，但它没有在图像上显示任何内容.. 对不起，我是 HTML5 的新手，请指教

```
<script type="text/javascript">
function test(){
     var canvas = document.getElementById("myCanvas");
     var context = canvas.getContext("2d");
     var imageObj = new Image();
     imageObj.onload = function(){
         context.drawImage(imageObj, 10, 10);
         context.font = "40pt Calibri";
         context.fillText("My TEXT!", 20, 20);
     };
     imageObj.src = "smallimage.jpg"; 
};
</script>

</head>

<body>
<textarea onchange="test();" id="txtContents"></textarea>
<img src="smallimage.jpg" id="myCanvas"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:00:49.063

首先，你的“img”标签应该是一个“canvas”标签。此外，按照您目前的方式，每次用户在文本区域中键入时都会重新加载图像。我建议将画布直接放在图像顶部，然后只清除画布并重新绘制文本 onchange()。尝试这样的事情：

```
<script type="text/javascript">

function changeText(textarea){
     var canvas = document.getElementById("myCanvas");
     var context = canvas.getContext("2d");
     var text = textarea.value;
     context.clearRect(0, 0, canvas.width, canvas.height);
     context.fillText(text, 20, 20);
}
</script>

</head>

<body>
<textarea onkeyup="changeText(this);" id="txtContents"></textarea>
<div class="outer">
<img src="smallimage.jpg" class="box" id="myImage" />
<canvas class="box" id="myCanvas" width="100" height="100"></canvas>
</div>
</body> 
```

CSS：

```
.outer{
    position: relative;
}
.box {
    width: 100px;
    height: 100px;
}

#myImage {

}

#myCanvas {
    position: absolute;
    top: 0px;
    left: 0px;
} 
```

查看：[如何在图像上最好地覆盖画布？](https://stackoverflow.com/questions/5330942/how-to-best-overlay-a-canvas-on-an-image)用于将画布直接放在图像顶部。接受的答案在评论中显示了如何做到这一点。

# php - 无法验证 PhotoBucket REST API

> ID：16041065
> 
> 赞同：1
> 
> 时间：2013-04-16T15:29:58.440
> 
> 标签：php, api, rest, photobucket

我正在尝试使用 PHP（不使用客户端 API）对 PhotoBucket REST API 进行第一步身份验证。由于他们正在升级服务，开发人员站点已关闭，但他们为我提供了一个 SCID 和一个私钥，我认为这是客户密钥和客户密码。我一直在寻找文档和其他帖子，但没有运气。 [https://stackoverflow.com/questions/7890518/register-user-by-php-in-photobucket](https://stackoverflow.com/questions/7890518/register-user-by-php-in-photobucket)

到目前为止，这是我想出的：

```
//default parameters
$url = "http://api.photobucket.com/login/request";
$parameters = array(
        'oauth_consumer_key' => rawurlencode('**key**'),
        'oauth_nonce' => rawurlencode(md5(time())),//no md5, "Authentication failed nonce invalid"
        'oauth_signature_method' => rawurlencode('HMAC-SHA1'),
        'oauth_timestamp' => rawurlencode(time()),
        'oauth_version' => rawurlencode('1.0'),
        'format' => 'json'
    );

//creation of base string and signature
$basestring = rawurlencode("POST") . '&' . rawurlencode($url) . '&' . rawurlencode(http_build_query($parameters));

$sign = base64_encode(hash_hmac("sha1", $basestring, "**secret**" . "&", true));

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url . "?" . http_build_query($parameters) . '&oauth_signature=' . rawurlencode($sign));
$result = curl_exec($ch); 
```

如果我将参数添加为 POSTFIELDS，我得到：401，异常身份验证失败时间戳无效 -1366125875 7 xml POST 1366125875

如果我添加示例中的参数 (url + ? + parameters + &signature=signature 我得到：401, Exception Authentication failed signature check failed 7 xml POST 1366125970

参考资料： http: [//pic.photobucket.com/dev_help/WebHelpPublic/Content/Getting%20Started/Consumer%20Authentication.htm](http://pic.photobucket.com/dev_help/WebHelpPublic/Content/Getting%20Started/Consumer%20Authentication.htm)

[http://feed7.com/ad-202021/Photobucket-Developer-Forum-Code-Examples-and-Libraries](http://feed7.com/ad-202021/Photobucket-Developer-Forum-Code-Examples-and-Libraries)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T23:30:46.763

我发布了这个问题作为最后的手段。然而，我想我终于想通了。

1) 将 md5() 添加到 time() 方法以克服“身份验证失败随机数无效”

2) 正确签署基本字符串（使用 $raw_output=true) $sign = base64_encode(hash_hmac("sha1", $basestring, secret . "&", true));

3) 使用 rawurlencode 而不是 urlencode（来自 feed7.com 用户的提示）

4) 发送帖子 url 中的所有内容（如某些文档页面所述，没有帖子数据（postfields））以克服“身份验证失败时间戳无效”

5）最后，这是这篇文章的主要原因：不要将格式参数添加到参数列表的末尾。删除它，或将其添加到参数列表的开头以克服“身份验证失败签名检查失败”

这是因为 Photobucket 强制执行他们所谓的“按名称按字典顺序排序参数”，这意味着参数需要严格按字母顺序排序

# c - 从直方图中寻找模式

> ID：16041070
> 
> 赞同：0
> 
> 时间：2013-04-16T15:30:16.830
> 
> 标签：c, structure, histogram, mode

我有这个函数来打印直方图，我想也可以使用这个函数计算模式，我知道要找到模式你需要比较每个分数的出现次数，但我不知道如何将它实现到代码。反正有没有实现这个功能来查找模式？

这是我的功能

```
int calMode(RECORD list[], int count){
int tempMode = 0;
int i, k;
int current = 0;

while (current < count)
{
    printf("%d:", list[current].score);
    for(k=0; (i=current + k) < count ; ++k)
   {
        if(list[current].score == list[i].score)
            printf("*");
        else
            break;
    }
      if(k > tempMode)
        tempMode = k;
    printf("\n");
    current = current + k;
}
printf("%d\n", tempMode);
   return tempMode;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:16:35.780

好吧，你需要一个不同的算法。您需要找到`.score`项目的最大成员，并存储相应的索引。这样的事情可能会做：

```
int max = list[0].score;
RECORD *max_item[count] = { &list[0] };
size_t index = 1;
while (count-- > 1) {
    // We're looking for any items that are greater than or equal to the
    // current max, so when we find items that are less, we jump back to
    // the condition evaluation using "continue".
    if (list[count].score < max) { continue; }

    // When we find a value that's greater than the current maximum, we
    // need to discard all previously stored "maximum" items and update
    // our current maximum.
    if (list[count].score > max) {
        index = 0;
        max = list[count].score;
    }

    // At this point, the current item can't be less than the current max.
    // This is because of the "continue;" earlier. Add this item to our
    // list of "maximum" items.
    max_item[index++] = &list[count];
} 
```

`max`现在将最高分数存储在直方图中，`index`存储包含该最高分数的项目数，并`max_item`存储指向`RECORD`包含该项目的 s 的指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:19:12.197

```
int calMode(RECORD list[], int count){
    int tempMode;
    int i, k;
    int current = 0;
    int max = -1;
    int update = 0;

    while (current < count){
        printf("%d:", list[current].score);
        for(k=0; (i=current + k) < count ; ++k){
            if(list[current].score == list[i].score)
                printf("*");
            else
                break;
        }
        printf("\n");

        if(k>max){
            max = k;
            tempMode = list[current].score;
            update  = 1;
        } else if(k == max){
            update = 0;
        }

        current = current + k;
    }
    if(update == 0)
        tempMode = -1;//indeterminable
    return tempMode;
} 
```

# c# - 数组内存 c#（复制到新引用或使用相同的引用？）

> ID：16041075
> 
> 赞同：0
> 
> 时间：2013-04-16T15:30:28.050
> 
> 标签：c#, arrays, memory

所以我似乎无法弄清楚这一点。在以下代码中：

```
int[] array1 = { 86, 66, 76, 92, 95, 88 };
int[] array2 = new int[6];
array2 = array1; 
```

当array2“复制”array1的值时，它是创建新的内存引用还是引用与array1中的值相同的内存索引？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T15:33:13.637

[`Arrays`](http://msdn.microsoft.com/en-us/library/vstudio/9b9dty7d.aspx)是引用类型，因此您分配的是相同的引用。

> 数组类型是从抽象基类型派生的引用类型 [`Array`](http://msdn.microsoft.com/en-us/library/vstudio/9b9dty7d.aspx)。

如果要创建深层副本，可以使用[`Array.Copy`](http://msdn.microsoft.com/en-us/library/k4yx47a1.aspx)：

```
int[] array1 = { 86, 66, 76, 92, 95, 88 };
int[] array2 = new int[array1.Length];
Array.Copy(array1, array2, array1.Length); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T15:34:15.393

数组是引用类型。您可以自己轻松检查

```
array2[1] = 2;
Console.WriteLine(array1[1]); // will print out 2 
```

当您更改一个时，您会更改另一个，因为两者都指向（引用）相同的内存位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T15:34:41.083

它引用同一个数组。因此，如果您更改 array1 中的值，它也会在 array2 中更改。

# c++ - atoi C++的使用

> ID：16041080
> 
> 赞同：0
> 
> 时间：2013-04-16T15:30:42.097
> 
> 标签：c++, atoi

我在 C++ 中有以下函数：

```
#include <iostream>
#include <cmath>
#include <stdlib.h>    
bool isPrime(char myArr[])
{
    int myInt=atoi(myArr);
    int maxX=sqrt(myInt)+1;
    for(int x=0; x<maxX; x++)
    {
        if(!myInt%x)
            return false;
    }
    return true;
} 
```

但是当我运行它时，Windows 会返回一个消息框，上面写着“Prime.c 已停止工作”我感觉它与使用有关，`atoi`尽管我不确定。应该`atoi`使用吗？我用错了吗？或者这是一个完全不同的问题？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T15:32:33.993

`atoi`尽管您没有检查它是否正常工作，但您没有具体问题。

真正的问题是您的程序在循环的第一次迭代中除以零。开始`x`于`2`：

```
for (int x = 2; x < maxX; x++) 
```

你也必须从 开始`2`。从 at `1`will 告诉你，你所有的数字都是素数，这不是真的，可能不是你想要的。您可能需要一种特殊情况来处理`0`和`1`输入 - 它们不是主要的，但会超出您当前的算法。

除开编辑：有很多更快的方法来检查一个数字是否是素数，如果这对你有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:36:08.040

您不想除以 0，从 2 开始：

```
for (int x = 2; x < maxX; x++) 
```

# ios - CoreData 多线程死锁

> ID：16041081
> 
> 赞同：4
> 
> 时间：2013-04-16T15:30:45.240
> 
> 标签：ios, multithreading, core-data, nsmanagedobjectcontext

我遇到了在多 NSManagedObjectContexts 和多线程场景中发生的相同死锁问题（这在 SO 上很常见）。在我的一些视图控制器中，我的应用程序使用后台线程从 Web 服务获取数据，并在同一个线程中保存它。在其他情况下，如果不保存就不会继续前进（例如，当他们点击“下一步”时从表单中保留值），保存是在主线程上完成的。AFAIK理论上应该没有错，但有时我可以在调用

```
if (![moc save:&error]) 
```

...当死锁发生时，这似乎总是在后台线程的保存中。并非每次通话都会发生这种情况。事实上恰恰相反，我必须使用我的应用程序几分钟，然后它就会发生。

我已经阅读了我能找到的所有帖子以及 Apple 文档等，我确信我正在遵循这些建议。具体来说，我对使用多个 MOC/线程的理解归结为：

*   每个线程必须有自己的 MOC。
*   必须在该线程上创建线程的 MOC（而不是从一个线程传递到另一个线程）。
*   一个 NSManagedObject 不能被传递，但是一个 NSManagedObjectID 可以，并且你使用这个 ID 来使用不同的 MOC 来膨胀一个 NSManagedObject。
*   如果它们都使用相同的 PersistentStoreCoordinator，则必须将来自一个 MOC 的更改合并到另一个 MOC。

[不久前，我在这个 SO 线程](https://stackoverflow.com/questions/3474960/generic-approach-to-nsmanagedobjectcontext-in-multi-threaded-application)上遇到了一些 MOC 帮助程序类的代码，发现它很容易理解并且使用起来非常方便，所以我现在所有的 MOC 交互都是通过它进行的。这是我的 ManagedObjectContextHelper 类的全部内容：

```
#import "ManagedObjectContextHelper.h"

@implementation ManagedObjectContextHelper

+(void)initialize {
    [[NSNotificationCenter defaultCenter] addObserver:[self class]
                                             selector:@selector(threadExit:)
                                                 name:NSThreadWillExitNotification
                                               object:nil];
}

+(void)threadExit:(NSNotification *)aNotification {
    TDAppDelegate *delegate = (TDAppDelegate *)[[UIApplication sharedApplication] delegate];
    NSString *threadKey = [NSString stringWithFormat:@"%p", [NSThread currentThread]];
    NSMutableDictionary *managedObjectContexts = delegate.managedObjectContexts;

    [managedObjectContexts removeObjectForKey:threadKey];
}

+(NSManagedObjectContext *)managedObjectContext {
    TDAppDelegate *delegate = (TDAppDelegate *)[[UIApplication sharedApplication] delegate];
    NSManagedObjectContext *moc = delegate.managedObjectContext;

    NSThread *thread = [NSThread currentThread];

    if ([thread isMainThread]) {
        [moc setMergePolicy:NSErrorMergePolicy];
        return moc;
    }

    // a key to cache the context for the given thread
    NSString *threadKey = [NSString stringWithFormat:@"%p", thread];

    // delegate.managedObjectContexts is a mutable dictionary in the app delegate
    NSMutableDictionary *managedObjectContexts = delegate.managedObjectContexts;

    if ( [managedObjectContexts objectForKey:threadKey] == nil ) {
        // create a context for this thread
        NSManagedObjectContext *threadContext = [[NSManagedObjectContext alloc] init];
        [threadContext setPersistentStoreCoordinator:[moc persistentStoreCoordinator]];
        [threadContext setMergePolicy:NSErrorMergePolicy];
        // cache the context for this thread
        NSLog(@"Adding a new thread:%@", threadKey);
        [managedObjectContexts setObject:threadContext forKey:threadKey];
    }

    return [managedObjectContexts objectForKey:threadKey];
}

+(void)commit {
    // get the moc for this thread
    NSManagedObjectContext *moc = [self managedObjectContext];

    NSThread *thread = [NSThread currentThread];

    if ([thread isMainThread] == NO) {
        // only observe notifications other than the main thread
        [[NSNotificationCenter defaultCenter] addObserver:[self class]                                                 selector:@selector(contextDidSave:)
                                                     name:NSManagedObjectContextDidSaveNotification
                                                   object:moc];
    }

    NSError *error;
    if (![moc save:&error]) {
        NSLog(@"Failure is happening on %@ thread",[thread isMainThread]?@"main":@"other");

        NSArray* detailedErrors = [[error userInfo] objectForKey:NSDetailedErrorsKey];
        if(detailedErrors != nil && [detailedErrors count] > 0) {
            for(NSError* detailedError in detailedErrors) {
                NSLog(@"  DetailedError: %@", [detailedError userInfo]);
            }
        }
        NSLog(@"  %@", [error userInfo]);

    }

    if ([thread isMainThread] == NO) {
        [[NSNotificationCenter defaultCenter] removeObserver:[self class]                                                        name:NSManagedObjectContextDidSaveNotification
                                                      object:moc];
    }
}

+(void)contextDidSave:(NSNotification*)saveNotification {
    TDAppDelegate *delegate = (TDAppDelegate *)[[UIApplication sharedApplication] delegate];
    NSManagedObjectContext *moc = delegate.managedObjectContext;

    [moc performSelectorOnMainThread:@selector(mergeChangesFromContextDidSaveNotification:)
                          withObject:saveNotification
                       waitUntilDone:NO];
}
@end 
```

这是似乎死锁的多线程位的片段：

```
NSManagedObjectID *parentObjectID = [parent objectID];

    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0ul);
    dispatch_async(queue, ^{
        // GET BACKGROUND MOC
        NSManagedObjectContext *backgroundContext = [ManagedObjectContextHelper managedObjectContext];

        Parent *backgroundParent = (Parent*)[backgroundContext objectWithID:parentObjectID];
        // HIT THE WEBSERVICE AND PUT THE RESULTS IN THE PARENT OBJECT AND ITS CHILDREN, THEN SAVE...
[ManagedObjectContextHelper commit];

        dispatch_sync(dispatch_get_main_queue(), ^{

            NSManagedObjectContext *mainManagedObjectContext = [ManagedObjectContextHelper managedObjectContext];

            parent = (Parent*)[mainManagedObjectContext objectWithID:parentObjectID];
});
    }); 
```

错误中的 conflictList 似乎表明它与父对象的 ObjectID 有关：

```
 conflictList =     (
            "NSMergeConflict (0x856b130) for NSManagedObject (0x93a60e0) with objectID '0xb07a6c0 <x-coredata://B7371EA1-2532-4D2B-8F3A-E09B56CC04F3/Child/p4>' 
with oldVersion = 21 and newVersion = 22 
and old object snapshot = {\n    parent = \"0xb192280 <x-coredata://B7371EA1-2532-4D2B-8F3A-E09B56CC04F3/Parent/p3>\";\n    name = \"New Child\";\n    returnedChildId = 337046373;\n    time = 38;\n} 
and new cached row = {\n    parent = \"0x856b000 <x-coredata://B7371EA1-2532-4D2B-8F3A-E09B56CC04F3/Parent/p3>\";\n    name = \"New Child\";\n    returnedChildId = 337046373;\n    time = 38;\n}"
        ); 
```

我已经尝试在获得 MOC 后立即调用 refreshObject，其理论是如果这是我们之前使用过的 MOC（例如，我们之前在主线程上使用过 MOC，很可能这与助手类将为我们提供的相同），那么也许在另一个线程中保存意味着我们需要显式刷新。但这没有任何区别，如果我继续点击足够长的时间，它仍然会死锁。

有没有人有任何想法？

编辑：如果我为所有异常设置了断点，那么调试器会自动暂停`if (![moc save:&error])`在线，因此播放/暂停按钮已经暂停并显示播放三角形。如果我禁用所有异常的断点，那么它实际上会记录冲突并继续 - 可能是因为合并策略当前设置为 NSErrorMergePolicy - 所以我认为它实际上并没有在线程上死锁。[这是](https://docs.google.com/file/d/0B-QHmo7MUgGaenR6bDc3UlpHZ2c/edit?usp=sharing)暂停时两个线程状态的屏幕截图。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-21T20:55:52.710

我根本不推荐你的方法。首先，除非你局限于 iOS4，否则你应该使用 MOC 并发类型，而不是旧方法。即使在 iOS 5 下（嵌套上下文已被破坏），该`performBlock`方法也更加合理。

另外，注意`dispatch_get_global_queue`提供了一个并发队列，不能用于同步。

详细信息可在此处找到：http: [//developer.apple.com/library/ios/#documentation/cocoa/conceptual/CoreData/Articles/cdConcurrency.html](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/CoreData/Articles/cdConcurrency.html)

**编辑**

您正在尝试手动管理 MOC 和线程。如果你愿意，你可以做到，但你的道路上有龙。这就是创建新方法的原因，以最大程度地减少跨多个线程使用 Core Data 时出错的机会。每当我看到使用 Core Data 进行手动线程管理时，我总是建议将更改作为第一种方法。这将立即消除大多数错误。

除了您手动映射 MOC 和线程之外，我不需要看到更多内容，就知道您是在自找麻烦。只需重新阅读该文档，并以正确的方式进行操作（使用`performBlock`）。

# mysql - 在一个查询中使用 ORDER BY FIELD 和另一个（第二个）ORDER 子句

> ID：16041085
> 
> 赞同：0
> 
> 时间：2013-04-16T15:30:50.060
> 
> 标签：mysql, sql-order-by

[这个问题](https://stackoverflow.com/questions/958627/mysql-order-by-values-within-in)询问有关在 MySQL 中指定排序顺序的问题。

我想做的是有两个级别的排序 - 第一个是我指定的顺序，然后其余的非指定值将以正常方式排序。

我尝试的是：

```
 SELECT
        version_id,
        version_name
    FROM
        software_versions
    ORDER BY 
        FIELD(version_id, 133, 41, 88), 
        version_name ASC 
```

但是会发生的是行按版本名称排序，然后是 FIELD（从查询的结构向后）。

有可能做我要求的吗？查找表相对较小（大约 100 行），所以我不太担心使用 ORDER BY FIELD 对性能的影响。

我是否需要将其作为 UNION 进行返工？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T15:36:51.193

尝试颠倒顺序，因此`0`将始终处于最后一个位置。

```
ORDER BY FIELD(version, 88, 41, 133) DESC,  version_name ASC 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/cb79cb/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T15:41:31.303

我发现这篇[文章](http://www.electrictoolbox.com/mysql-order-specific-field-values/)解释了它。基本上，因为您没有指定所有版本号，所以它不起作用。解决方法是按字段函数排序，然后是字段本身。

```
ORDER BY FIELD(version, 88, 41, 133) DESC, version, version_name; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-16T15:43:52.087

这是因为您没有在 FIELD() 函数中列出 version_id 的所有可能值。

这应该可以工作：

```
SELECT
    version_id,
    version_name
FROM
    software_versions
WHERE
    version_id IN (133, 41, 88)
ORDER BY 
    FIELD(version_id, 133, 41, 88), 
    version_name ASC 
```

# c# - 将程序集加载到 WindowsAzure WorkerRole 中的单独 AppDomain

> ID：16041087
> 
> 赞同：3
> 
> 时间：2013-04-16T15:30:52.690
> 
> 标签：c#, reflection, azure, azure-worker-roles

我正在开发一个 Azure Worker Role，它需要根据从 WCF 服务中提取的工作定期执行操作。由于 Azure 部署的性质，我们决定在 Azure 中实施一个插件框架，以允许快速更新我们的产品，同时通过消除对完整 Azure 部署的需求以及支持各种程序集的多个版本来最大限度地减少停机时间。

插件从云存储下载并加载到包含加载程序集所需的所有相关信息的类中。（请参阅下面的 PluginAssemblyInfo）

在其他开发工作中，我开发了以下 ReflectionHelper 类。这个类在其他应用程序中工作，我已经验证它在控制台应用程序中工作。

但是，在 Azure 模拟器中运行时，出现以下错误：（我在引发异常的行上添加了注释。）

```
Type is not resolved for member 'MyCompanyName.ReflectionHelper,MyCompanyAssembly, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null'. 
```

ReflectionHelper 类作为源文件添加到调用它的同一程序集中。（出于匿名原因，我确实编辑了程序集/命名空间的名称）

鉴于此类在其他情况下有效，我唯一的猜测是它可能是一个信任问题，但我没有在网上找到很多与此相关的信息。任何帮助将不胜感激。

这是 ReflectionHelper 类的代码。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using System.Runtime.Remoting;
using System.Runtime.Serialization;
using System.Web;

namespace MyCompanyName
{
    [Serializable]
    public class ReflectionHelper
    {

        public AppDomain appDomain { get; set; }
        public byte[] PluginBytes { get; set; }
        public string PluginClassName { get; set; }
        public string PluginAssemblyName { get; set; }
        public Dictionary<string, byte[]> AssemblyArchive { get; set; }

        public object GetInstance(AppDomain NewDomain, byte[] PluginBytes, string PluginClassName, string PluginAssemblyName, Dictionary<string, byte[]> AssemblyArchive)
        {
            try
            {
                this.appDomain = NewDomain;
                this.PluginBytes = PluginBytes;
                this.PluginClassName = PluginClassName;
                this.AssemblyArchive = AssemblyArchive;
                this.PluginAssemblyName = PluginAssemblyName;

                //this is the line that throws the serializationexception
                appDomain.AssemblyResolve += new ResolveEventHandler((sender, args) =>
                {
                    AssemblyName x = new AssemblyName(args.Name);
                    string Name = x.Name;
                    if (System.IO.Path.GetExtension(x.Name) != ".dll")
                        Name += ".dll";
                    Assembly Ret = appDomain.Load(this.AssemblyArchive[Name]);

                    return Ret;
                });
                appDomain.DoCallBack(LoaderCallBack);
                return appDomain.GetData("Plugin");
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        public void LoaderCallBack()
        {
            ObjectHandle PluginObject = appDomain.CreateInstance(string.Format(this.PluginAssemblyName), PluginClassName);
            appDomain.SetData("Plugin", PluginObject.Unwrap());
        }
    }

} 
```

这是调用它的代码片段

```
AppDomain currentDomain = AppDomain.CurrentDomain;
AppDomainSetup domainSetup = new AppDomainSetup() { };
AppDomain BrokerJobDomain = AppDomain.CreateDomain("WorkerPluginDomain" + Guid.NewGuid().ToString());//, null, new AppDomainSetup { ApplicationBase = AppDomain.CurrentDomain.SetupInformation.ApplicationBase });

ReflectionHelper helper = new ReflectionHelper();
object Instance = helper.GetInstance(BrokerJobDomain, pluginAssembly.PluginBytes, pluginAssembly.ClassName, pluginAssembly.AssemblyName, pluginAssembly.AssemblyArchive);
IWorkPlugin executor = (IWorkPlugin)Instance; 
```

这是从云存储下载插件时填充的程序集信息类

```
public class PluginAssemblyInfo
{
    public string ClassName { get; set; }
    public byte[] PluginBytes { get; set; }
    public Dictionary<string, byte[]> AssemblyArchive { get; set; }
    public string AssemblyName { get; set; }
    public DateTime LoadDate { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T14:15:28.303

该问题似乎与未在子域上设置的 RelativeSearchPath 有关。确保子域具有相同的设置凭据似乎可以解决此问题。

```
AppDomain currentDomain = AppDomain.CurrentDomain;
AppDomain BrokerJobDomain = AppDomain.CreateDomain("WorkerPluginDomain" + Guid.NewGuid().ToString(), null,  AppDomain.CurrentDomain.SetupInformation ); 
```

# http - HTTP 和 HTTPS iptables 规则被忽略

> ID：16041089
> 
> 赞同：-2
> 
> 时间：2013-04-16T15:30:55.723
> 
> 标签：http, https, iptables

我已经知道答案很简单，我搞砸了！但是知道这些规则出了什么问题吗？

`sudo iptables -I INPUT -p tcp -m state --state NEW,ESTABLISHED,RELATED -m multiport --dports http,https -j ACCEPT`

`sudo iptables -I OUTPUT -p tcp -m state --state NEW,ESTABLISHED,RELATED -m multiport --sports http,https -j ACCEPT`

我已经设置了 DNS，并且为此的每个数据包都到达了我的服务器，所以这不是问题。

在此先感谢，卢克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T18:16:42.220

考虑到远程 Web 服务器的 NAT 出站连接。NAT 和远程 Web 服务器之间的流中的第一个数据包将是*目标端口为 80 的**出站*数据包。您没有任何规则可以匹配该数据包。

# r - 无法使用 scales 包格式化 xaxis

> ID：16041090
> 
> 赞同：3
> 
> 时间：2013-04-16T15:31:03.117
> 
> 标签：r, ggplot2

我有这些数据并尝试使用 ggplot2 和比例来格式化 xaxis，有日期和时间。

```
dput(head(pp))
structure(list(DateTime = structure(c(1362405600, 1362409200, 
1362412800, 1362416400, 1363006800, 1363010400), class = c("POSIXct", 
"POSIXt"), tzone = ""), Day = structure(c(1L, 1L, 1L, 1L, 1L, 
1L), .Label = c("Fri", "Mon", "Sat", "Sun", "Thu", "Tue", "Wed"
), class = "factor"), Total_Logins = c(818832L, 801771L, 787508L, 
731672L, 748872L, 727140L), Unique_Logins = c(732152L, 713380L, 
701348L, 647321L, 672848L, 649453L), Date = structure(c(15768, 
15768, 15768, 15768, 15775, 15775), class = "Date")), .Names = c("DateTime", 
"Day", "Total_Logins", "Unique_Logins", "Date"), row.names = c(1498L, 
1499L, 1500L, 1501L, 1666L, 1667L), class = "data.frame")

library(ggplot2)
library(scales)

ggplot(subset(pp, Day=="Fri"), aes(DateTime, Total_Logins, group=1)) + 
    geom_line() + 
    geom_smooth(method="loess", se=T, size=1) + 
    scale_x_date(breaks = "1 day", labels=date_format("%b-%d-%Y %H")) 
```

我收到此错误：

> 错误：无效输入：date_trans 仅适用于 Date 类的对象

我的 DateTime 列已格式化为日期。任何想法，我在这里做错了什么？

![在此处输入图像描述](https://i.stack.imgur.com/EAZph.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T15:35:41.113

由于列`DateTime`包含日期和时间（POSIXct 类），并且您还希望显示 x 轴标签的小时数，您应该使用`scale_x_datetime()`而不是`scale_x_date()`.

```
+scale_x_datetime(breaks = "1 day", labels=date_format("%b-%d-%Y %H")) 
```

要更改显示 x 轴刻度的中断，您可以更改`breaks="1 day"`为，例如，更改为`breaks="6 hours"`。另一种可能性是仅在实际值可用时显示中断。如果轴文本项太多，则可以更改文本的方向。

```
+scale_x_datetime(breaks = unique(pp$DateTime), labels=date_format("%b-%d-%Y %H"))+
        theme(axis.text.x=element_text(angle=90,vjust=0.5)) 
```

# xmpp - Google Talk 是否接受 HTML 格式的聊天？

> ID：16041091
> 
> 赞同：0
> 
> 时间：2013-04-16T15:31:07.687
> 
> 标签：xmpp, google-talk

我已经按照以下问题描述的方式发送了 HTML 格式的 Google Talk 聊天：[How do you send HTML formatted messages over XMPP with Node.JS?](https://stackoverflow.com/questions/6509206/how-do-you-send-html-formatted-messages-over-xmpp-with-node-js)

但是，Gtalk 似乎只是将其解释为文本。Gtalk 是否接受 HTML 格式的消息？

回复以下评论：可能是客户端或 Google 运行的服务器对其进行了错误解释。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T18:39:37.160

是的，Google Talk 接受 HTML 格式的消息。但是，正如您所观察到的，它忽略了格式化文本，只显示纯文本。根据[XHTML-IM XEP](http://xmpp.org/extensions/xep-0071.html)，每条 HTML 消息都必须附有纯文本消息，以便与不支持 HTML 格式消息的客户端兼容。

当我将此[示例消息发送](http://xmpp.org/extensions/xep-0071.html#examples)到我的 Windows 机器上的 Google Talk 客户端时（使用 Psi 的 XML 输入控制台）...

```
<message to="test@gmail.com/Talk.v10445D0E8B1">
  <body>Wow, I&apos;m green with envy!</body>
  <html xmlns='http://jabber.org/protocol/xhtml-im'>
    <body xmlns='http://www.w3.org/1999/xhtml'>
      <p style='font-size:large'>
        <em>Wow</em>, I&apos;m <span style='color:green'>green</span>
        with <strong>envy</strong>!
      </p>
    </body>
  </html>
</message> 
```

...我只看到文字`Wow, I'm green with envy!`。

当我向登录到 Google Talk 的 Psi 客户端发送相同的消息时，我收到...

```
<message from="test@jabber.org/Ben-PC" to="test@gmail.com">
<body>Wow, I'm green with envy!</body>
<html xmlns="http://jabber.org/protocol/xhtml-im">
<body xmlns="http://www.w3.org/1999/xhtml">
          <p style="font-size:large">
            <em>Wow</em>, I'm <span style="color:green">green</span>
            with <strong>envy</strong>!
          </p>
        </body>
      </html>
</message> 
```

它没有像我预期的那样从 HTML 中剥离（服务器不应更改消息的内容）。它显示为![显示格式化文本的 Psi](https://i.stack.imgur.com/Ix6Uz.png)，因此看起来 Psi 确实支持格式化文本。

测试功能的方法是使用[服务发现](http://xmpp.org/extensions/xep-0030.html)。如果我发送...

```
<iq to='test@gmail.com/Talk.v10445D0E8B1' type='get'>
  <query xmlns='http://jabber.org/protocol/disco#info'/>
</iq> 
```

... 我收到...

```
<iq from="test@gmail.com/Talk.v10445D0E8B1" type="error" to="test@jabber.org/Ben-PC">
<query xmlns="http://jabber.org/protocol/disco#info"/>
<error type="cancel" code="501">
<feature-not-implemented xmlns="urn:ietf:params:xml:ns:xmpp-stanzas"/>
</error>
</iq> 
```

...这意味着 Google Talk 客户端不支持服务发现。我们必须依靠 Google Talk 客户端和服务器忽略 HTML 消息文本的观察结果。

# r - 将 POSIX 日期和时间 (posixct) 舍入为相对于时区的日期

> ID：16041093
> 
> 赞同：4
> 
> 时间：2013-04-16T15:31:16.050
> 
> 标签：r, date, rounding, posixct

我想相对于特定时区将 POSIXct 舍入到当天。

如果我尝试

```
round(as.POSIXct("2013-03-05 23:00:00 EST"), "day") 
```

它返回

```
2013-03-06 
```

这是有道理的，因为当 EST5EDT 的 2013 年 3 月 5 日美国东部标准时间 23:00:00 时，UTC 时间已经是 2013 年 3 月 6 日。从逻辑上讲，我想做的是：

```
round(as.POSIXct("2013-03-05 23:00:00 EST"), "day", tz="EST5EDT") 
```

也就是说，“将此日期和时间四舍五入到最近的一天，相对于 EST5EDT 时区”。不幸的是，*round*不采用时区参数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T15:44:22.257

`round`一旦过了中午，就会轮到第二天，这就是为什么我认为你会看到 2013-03-06。我还必须`tz`在调用中明确设置参数`as.POSIXct`

观察：

```
round( as.POSIXct("2013-03-05 11:00:00" , tz = "EST" ), "day" )
[1] "2013-03-05 EST" 
```

然后过了中午：

```
round( as.POSIXct("2013-03-05 12:00:00" , tz = "EST" ), "day" )
[1] "2013-03-06 EST" 
```

调用将`format`日期提取为不带 tz 参数的字符串。因此，您可以在没有时区的情况下获得原始结果

```
format( round( as.POSIXct("2013-03-05 12:00:00" , tz = "EST" ), "day" ) )
[1] "2013-03-06" 
```

如果您想将那天的任何时间*四舍五入*到那一天，也许您想要的是`trunc`？

```
format(trunc( as.POSIXct("2013-03-05 12:00:00" , tz = "EST" ), "day" ))
[1] "2013-03-05" 
```

# google-app-engine - 上传属性 Google App Engine - app.yaml

> ID：16041096
> 
> 赞同：3
> 
> 时间：2013-04-16T15:31:21.927
> 
> 标签：google-app-engine, app.yaml

我将所有内容重定向到我的 app.yaml 中的单个文件，就像这样

```
- url: /.*
  script: frontcontroller.application 
```

但我仍然必须使用 robots.txt，这会在我这样做时导致错误

```
- url: /robots.txt
  static_files: robots.txt

- url: /.*
  script: frontcontroller.application 
```

错误是“缺少 URL robots.txt 的“上传”属性，我知道它需要像这样的第三个选项

```
- url: robots.txt
  static_files: robots.txt
  upload: ?????? 
```

上传属性的正确值是多少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:34:06.637

您应该包含要上传的文件的实际路径，在您的情况下是`robots.txt`：

```
- url: robots.txt
  static_files: robots.txt
  upload: robots.txt 
```

有关更多信息，请阅读：[Python 应用程序配置](https://developers.google.com/appengine/docs/python/config/appconfig#Static_File_Pattern_Handlers)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-06T03:53:41.287

我是这样理解的：

static_file 字段让您指定用于服务静态文件请求的映射。

上传字段用于区分脚本文件和静态文件。

# c# - 启动 mstsc.exe 并在启用时配置 pekts00.rdp

> ID：16041099
> 
> 赞同：0
> 
> 时间：2013-04-16T15:31:30.320
> 
> 标签：c#, rdp

我正在为我的一个应用程序添加安全性。我希望在启用时启动配置了 .rdp（远程桌面）的 C:\Windows\System32\mstsc.exe c:\thinclient\pekts00.rdp。它将继续运行以检查 mstsc.exe 是否正在运行，如果没有，它将注销窗口或启动它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:52:57.930

尝试如下...它会帮助你...

```
System.Diagnostics.Process[] pname = System.Diagnostics.Process.GetProcessesByName("mstsc");
if (pname.Length == 0)
 System.Diagnostics.Process.Start(Environment.GetEnvironmentVariable("windir") + @"\system32\mstsc.exe"); 
```

# c# - 如何将 GTK# 安装程序集成到我自己的应用程序安装程序中

> ID：16041103
> 
> 赞同：1
> 
> 时间：2013-04-16T15:31:37.583
> 
> 标签：c#, windows, installation, nsis, gtk#

根据本指南将[GTK Sharp 应用程序部署到 Windows 而不安装 GTK#](https://stackoverflow.com/questions/5816895/deploy-gtk-sharp-applications-to-windows-without-installing-gtk)我决定将安装程序集成到我自己使用 NSIS 制作的安装程序中

我有使用 gtk# 编写的 ac# 应用程序。现在我需要将它安装到没有安装 gtk# 的计算机上。我下载了 gtk# 的安装程序，并使用以下命令执行它：

```
ExecWait 'msiexec.exe /quiet /package "$INSTDIR\gtk-sharp-2.12.20.msi"' 
```

这实际上会执行安装程序并执行某些操作，因为我可以在已安装程序列表（gtk 包）中看到它，但是，当我在安装后尝试启动应用程序时出现此错误：

```
Unable to load DLL 'libgtk-win32-2.0-0.dll': The specified procedure could not be found. (Exception from HRESULT: 0x8007007F) 
```

我需要安装任何其他软件包才能使其正常工作吗？或者什么是实施安装程序的正确方法？

# python - Python argparse store_true 并将可选选项存储在一个参数中

> ID：16041107
> 
> 赞同：1
> 
> 时间：2013-04-16T15:31:47.970
> 
> 标签：python, optional-parameters, argparse

我需要识别是单独给出参数还是带有可选字符串或两者都没有

```
parser.add_argument(???)
options = parser.parse_args() 
```

所以

```
./prog.py --arg 
```

应该存储`''`到 options.arg 中，

```
./prog.py --arg=lol 
```

存储`'lol'`到 options.arg 和

```
./prog.py 
```

将 options.arg 保留为`None`

我现在有：

```
parser.add_argument("--arg", nargs="?",type=str,dest="arg") 
```

但是当我运行 myprogram 作为`./prog.py --arg`options.arg 仍然存在`None`。识别 --arg 的唯一方法是运行它`./prog.py --arg=`，这对我来说是个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T15:38:08.047

使用[`const`](https://docs.python.org/3.4/library/argparse.html#const)关键字：

```
import argparse
parser = argparse.ArgumentParser()
parser.add_argument("--arg", nargs="?", type=str, dest="arg", const="")
print(parser.parse_args([]))
print(parser.parse_args(['--arg']))
print(parser.parse_args(['--arg=lol'])) 
```

结果是

```
Namespace(arg=None)
Namespace(arg='')
Namespace(arg='lol') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:37:30.170

您可以使用自定义操作来做到这一点：

```
import argparse
parser = argparse.ArgumentParser()
class ArgAction(argparse.Action):
    def __call__(self,parser,namespace,values,option_string=None):
        if values:
            setattr(namespace,self.dest,values)
        else:
            setattr(namespace,self.dest,'')

parser.add_argument("--arg",nargs='?',action=ArgAction,dest="arg")
print parser.parse_args("--arg".split())
print parser.parse_args("--arg=foo".split()) 
```

# asp-classic - 在 MS Word 2010 中将内容类型用作 ms-word 时显示缺少的 CSS 文件

> ID：16041109
> 
> 赞同：1
> 
> 时间：2013-04-16T15:31:54.993
> 
> 标签：asp-classic, ms-word, content-type

在经典 asp 中使用以下代码在 MS Word 中打印文档

```
 Response.ContentType ="application/msword"
Response.AddHeader "content-disposition", "attachment; filename=report.doc" 
```

它在 MS Word 2007 中运行良好，但在 MS Word 2010 中打开时出现以下错误 ![在此处输入图像描述](https://i.stack.imgur.com/WzRfB.png)

而且也没有得到 MS Word doc 中的格式。

# jquery - jquery 比率插件不适用于 Rails

> ID：16041115
> 
> 赞同：1
> 
> 时间：2013-04-16T15:32:06.067
> 
> 标签：jquery, ruby-on-rails, raty

我正在运行 rails 3.2，并尝试使用以下方法添加评级系统：[http](http://wbotelhos.com/raty/) ://wbotelhos.com/raty/ 。

出于某种原因，即使我添加了：

```
 $('#rating').raty(); 
```

到我的脚本，和

```
 <div id="rating"></div> 
```

到我在网站上显示的 html，我仍然看不到星星。

我已经添加：

```
 //= require jquery.raty 
```

到我的 application.js，并在我的 javascripts 文件夹中有 jquery.raty.js。

我似乎无法弄清楚我做错了什么。

我尝试过使用 gem：[https](https://github.com/bmc/jquery-raty-rails) ://github.com/bmc/jquery-raty-rails但这也不起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-12T09:32:04.663

你添加了星星的照片吗？确保资产/图像中有 star-on.png 和 star-off.png 另外，在 html.erb 文件中添加以下代码，

```
<script>
    $(document).ready(function() {
        $("#rating").raty({
            path: '/assets/'
        });
    })
</script> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-30T18:51:22.470

您需要包含 javascript 调用：

```
$('#star').raty(); 
```

为了得到

```
<div id="star"></div> 
```

以显示。

# iphone - MKMapView setRegion 动画不显示动画

> ID：16041119
> 
> 赞同：9
> 
> 时间：2013-04-16T15:32:11.460
> 
> 标签：iphone, ios, objective-c, mkmapview

我有一个`MKMapView`. `annotation pins`当视图被加载时，最近的 pin 被搜索并且地图将被缩放，因此它同时显示用户的位置和最近的 pin。我用`[map setRegion:region animated:YES];`. 到目前为止一切正常。同样的方法也可以通过点击一个按钮来调用，该按钮可以定位用户，然后完全按照我刚才描述的方式进行操作。

我还有一个搜索字段，用户可以使用它搜索地图点。当用户点击其中一个搜索结果时，地图会设置区域，因此搜索到的图钉位于中间。现在，这有点奇怪。我还设置了这个区域动画，至少我执行与上面相同的命令。但是，如果地图点离地图的当前可见部分太远，则在更改区域时不会显示动画。我错过了什么吗？我已经看过Apples docs，他们没有提到任何关于动画最大距离的内容。

我期待着任何帮助！

**更新 1：**
刚刚在模拟器中再次测试。一个有趣的事实是，当我第一次搜索**MapPoint**然后选择一个搜索结果时，它没有动画。如果我在第一个搜索之后执行另一个搜索并选择一个结果，它会生成动画。一旦我点击定位按钮，它会将用户带回他的位置和最近的点，它不会为此设置动画`setRegion:`以及之后的第一次搜索。但仅在模拟器中，在我的 4S 上，它完全符合我在上面原始问题中的描述。

**更新 2：**
在评论中，我被要求提供示例坐标。
所以这里是第一步的坐标（搜索自己的位置和最近的pin）：
**My Location:** 47.227131 / 8.264251
**Nearest pin:** 47.251347 / 8.357191
它们之间的距离大约是22公里。地图的中心是两个图钉之间的中心。从中心到屏幕边界的距离是两点之间距离的 1.5 倍，在这种情况下约为 33 公里。
这里是第二步的一组坐标（搜索一个地图点并选择它）：
**搜索到的 pin:** 46.790680 / 9.818824
到屏幕边界的距离在这里固定为 500 米。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-06-28T11:18:05.330

我已经在 iOS 6 和 iOS 7 beta 上使用一个简单的演示应用程序测试了这个问题。事实证明，地图视图实际上并不总是动画区域之间的过渡。这取决于区域之间的距离。例如，从巴黎到伦敦的过渡没有动画效果。但如果你先缩小一点，然后去伦敦，它就会变成动画。

文档说：

> *动画：*如果您希望地图视图以动画方式过渡到新区域，请指定 YES，如果您希望地图立即以指定区域为中心，请指定 NO。

但正如我们所见，我们不能依赖动画。我们只能告诉地图视图过渡**应该**是动画的。MapKit 决定动画是否合适。它告诉代理过渡是否将在`-(void)mapView:(MKMapView *)mapView regionWillChangeAnimated:(BOOL)animated`.

为了在所有情况下始终如一地为区域变化设置动画，您需要首先为中间区域设置动画。设 A 为当前地图区域，B 为目标区域。如果区域之间有交集，您可以直接过渡。（将 转换`MKCoordinateRegion`为 an`MKMapRect`并用于`MKMapRectIntersection`查找交点）。如果没有交集，则计算跨越两个区域的区域 C（使用`MKMapRectUnion`和`MKCoordinateRegionForMapRect`）。然后先去C区，`regionDidChangeAnimated`再去B区。

示例代码：

```
MKCoordinateRegion region = _destinationRegion;    
MKMapRect rect = MKMapRectForCoordinateRegion(_destinationRegion);
MKMapRect intersection = MKMapRectIntersection(rect, _mapView.visibleMapRect);
if (MKMapRectIsNull(intersection)) {
    rect = MKMapRectUnion(rect, _mapView.visibleMapRect);
    region = MKCoordinateRegionForMapRect(rect);
    _intermediateAnimation = YES;
}
[_mapView setRegion:region animated:YES]; 
```

* * *

```
-(void)mapView:(MKMapView *)mapView regionDidChangeAnimated:(BOOL)animated
{
    if (_intermediateAnimation) {
        _intermediateAnimation = NO;
        [_mapView setRegion:_destinationRegion animated:YES];
    }
} 
```

* * *

这个辅助方法取自[这里](https://stackoverflow.com/a/15683034/550177)

```
MKMapRect MKMapRectForCoordinateRegion(MKCoordinateRegion region)
{
    MKMapPoint a = MKMapPointForCoordinate(CLLocationCoordinate2DMake(
                                                                      region.center.latitude + region.span.latitudeDelta / 2,
                                                                      region.center.longitude - region.span.longitudeDelta / 2));
    MKMapPoint b = MKMapPointForCoordinate(CLLocationCoordinate2DMake(
                                                                      region.center.latitude - region.span.latitudeDelta / 2,
                                                                      region.center.longitude + region.span.longitudeDelta / 2));
    return MKMapRectMake(MIN(a.x,b.x), MIN(a.y,b.y), ABS(a.x-b.x), ABS(a.y-b.y));
} 
```

* * *

WWDC 2013 session 309 *Putting Map Kit in Perspective*解释了如何在 iOS 7 中进行如此复杂的转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-05-03T22:38:48.783

我也有这个问题，它并不总是动画，有时它只是跳跃和溶解。但是，我注意到，如果您为*camera*而不是*region*设置动画，它会始终保持动画。

但是使用相机，您必须设置眼睛距离/高度而不是纬度/经度跨度。对于下面的粗略计算，我有一个简单的计算，它基本上只是将高度（以米为单位）设置为与该地区的经度跨度相同的米数。如果您想要精确的精度，您必须计算出该地区纬度每度的米数，由于地球不是一个完美的球体，因此略有变化。当然，您可以乘以该值来扩大或缩小范围以品尝。

**斯威夫特 4.1**示例代码：

```
/* -------------------------------------------------------------------------- */
func animateToMapRegion(_ region: MKCoordinateRegion) {
    // Quick and dirty calculation of altitude necessary to show region.
    // 111 kilometers per degree longitude.
    let metersPerDegree: Double = 111 * 1_000
    let altitude = region.span.longitudeDelta * metersPerDegree

    let camera = MKMapCamera(lookingAtCenter: region.center, fromEyeCoordinate: region.center, eyeAltitude: altitude)

    self.mapView.setCamera(camera, animated: true)
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-27T13:47:45.287

您只需获取当前位置，然后调用此函数：

◙**`import MapKit`**

◙**`var appleMapView = MKMapView()`**

◙ **`var currentCoordinate: CLLocationCoordinate2D?`**

currentCoordinate 必须是您当前的位置坐标：

```
 ◙ if let currentLoc = self.currentCoordinate {
        let center = CLLocationCoordinate2D(latitude: currentLoc.latitude, longitude: currentLoc.longitude)
        let region = MKCoordinateRegion(center: center, span: MKCoordinateSpan(latitudeDelta: 0.01, longitudeDelta: 0.01))
        appleMapView.setRegion(region, animated: true)
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-12-09T16:46:11.697

以下是@Felix 重写为 Swift 4 的函数：

```
// MARK: - MapView help properties
var destinationRegion: MKCoordinateRegion?
var intermediateAnimation = false

func center() {
    // Center map
    var initialCoordinates = CLLocationCoordinate2D(latitude: 49.195061, longitude: 16.606836)
    var regionRadius: CLLocationDistance = 5000000

    destinationRegion = MKCoordinateRegionMakeWithDistance(initialCoordinates, regionRadius * 2.0, regionRadius * 2.0)
    centreMap(on: destinationRegion!)
}

private func mapRect(forCoordinateRegion region: MKCoordinateRegion) -> MKMapRect {
    let topLeft = CLLocationCoordinate2D(latitude: region.center.latitude + (region.span.latitudeDelta/2), longitude: region.center.longitude - (region.span.longitudeDelta/2))
    let bottomRight = CLLocationCoordinate2D(latitude: region.center.latitude - (region.span.latitudeDelta/2), longitude: region.center.longitude + (region.span.longitudeDelta/2))

    let a = MKMapPointForCoordinate(topLeft)
    let b = MKMapPointForCoordinate(bottomRight)

    return MKMapRect(origin: MKMapPoint(x:min(a.x,b.x), y:min(a.y,b.y)), size: MKMapSize(width: abs(a.x-b.x), height: abs(a.y-b.y)))
}

func centreMap(on region: MKCoordinateRegion) {
    var region = region
    var rect = mapRect(forCoordinateRegion: region)
    let intersection = MKMapRectIntersection(rect, mapView.visibleMapRect)

    if MKMapRectIsNull(intersection) {
        rect = MKMapRectUnion(rect, mapView.visibleMapRect)
        region = MKCoordinateRegionForMapRect(rect)
        intermediateAnimation = true
    }

    mapView.setRegion(region, animated: true)
}

// MARK: - MKMapViewDelegate
func mapView(_ mapView: MKMapView, regionDidChangeAnimated animated: Bool) {
    if intermediateAnimation, let region = destinationRegion {
        intermediateAnimation = false
        mapView.setRegion(region, animated: true)
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-15T22:57:35.167

对于任何有相同问题并使用 Swift 并使用 tableView 的人：

我在关闭 tableView 后调用了 setRegion，它没有显示动画。这是我编辑前的代码：

```
dismiss(animated: true, completion: nil)
a function that calls setRegion 
```

然后我将其更改为：

```
dismiss(animated: true, completion: {
        a function that calls setRegion
    }) 
```

这次它起作用了。

# django - NameError at / name 'blog' is not defined

> ID：16041120
> 
> 赞同：3
> 
> 时间：2013-04-16T15:32:19.307
> 
> 标签：django, django-templates, django-urls

我正在使用 Django 1.5.1。我试图找出这个名称错误，即使我已经包含来自 . 在我的主要 urls.py 中导入视图

代码在这里[http://dpaste.org/ooPOU/](http://dpaste.org/ooPOU/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T15:48:56.533

您忘记了“blog.urls”周围的引号

```
 url(r"^blog/", include("blog.urls", namespace="blog")) 
```

# maps - 单击按钮后如何阻止谷歌地图绘制第二个矩形

> ID：16041121
> 
> 赞同：0
> 
> 时间：2013-04-16T15:32:20.307
> 
> 标签：maps, rectangles

我正在使用以下代码在地图上将矩形绘制到随机纬度。＆ 长。单击查找按钮时基于城市名称。问题是如果您没有输入不同的城市名称并单击查找按钮，程序将在城市原始纬度上绘制第二个矩形。＆ 长。我要么需要清除地图并重新绘制矩形，要么不太确定，因此无法绘制第二个矩形。这是我正在使用的代码。

```
 function codeAddress() {
        var address = document.getElementById("gadres").value;

        if(address=='') {
            alert("Address can not be empty!");
            return;

        }

        geocoder.geocode( { 'address': address}, function(results, status) {
            if (status == google.maps.GeocoderStatus.OK) {

                map.setCenter(results[0].geometry.location);
                document.getElementById('lat').value=results[0].geometry.location.lat().toFixed(6);
                document.getElementById('lng').value=results[0].geometry.location.lng().toFixed(6);
                var latlong = "(" + results[0].geometry.location.lat().toFixed(6) + " , " +
                + results[0].geometry.location.lng().toFixed(6) + ")";

                map.setZoom(15);

                var mapcenter = map.getCenter();
                var maplat = mapcenter.lat();
                var maplng = mapcenter.lng();

                var bounds = new google.maps.LatLngBounds(
                    new google.maps.LatLng(maplat - 0.002, maplng - 0.002),
                    new google.maps.LatLng(maplat + 0.002, maplng + 0.002)
                );

                var rectangle = new google.maps.Rectangle({
                    bounds: bounds,
                    draggable:true,
                    editable: true,
                    strokeColor: '#FF0000',
                    strokeOpacity: 0.8,
                    strokeWeight: 4,
                    fillColor: '#FF0000',
                    fillOpacity: 0.30,
                });

                rectangle.setMap(map);

                google.maps.event.addListener(rectangle, 'bounds_changed', function() {
                    document.getElementById('coords').value = rectangle.getBounds();

                });

            } else {
                alert("Lat and long cannot be found.");
            }
        }); 

    } 
```

非常感谢所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:45:11.763

我还没有尝试过，但也许你可以将你的边界存储到一个数组中，然后使用该数组的循环语句来检查是否存在使用 equals() 方法的相等边界 [https://developers.google.com/maps /documentation/javascript/reference#LatLngBounds](https://developers.google.com/maps/documentation/javascript/reference#LatLngBounds)

# angularjs - AngularJS - ng-switch 中的指令不起作用

> ID：16041122
> 
> 赞同：0
> 
> 时间：2013-04-16T15:32:23.820
> 
> 标签：angularjs, angularjs-directive

我有一个指令`ng-switch`如下：

```
<div ng-switch on="myModel">
    <div ng-switch-when="foo">
        <zippy></zippy>
    </div>
    //Other ng-switch-when directives
</div> 
```

该指令定义为：

```
app.directive('zippy', function() {
    return {
        scope: false,
        template: "Hello FooBar"
    };
}); 
```

现在，当页面加载时，虽然`myModel`确实变为`foo`，但模板不会加载。以下是浏览器中元素的状态：

```
<div ng-switch-when="foo" class="ng-scope">
    <zippy></zippy>
</div> 
```

该类`ng-scope`被附加 - 就是这样。元素不会改变 - 指令不会被模板替换。我究竟做错了什么？我怎样才能让指令起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:38:47.350

您将需要添加`restrict`到您的指令：

演示： http: [//plnkr.co/edit/Jc77jrY4U0xGalN5QkZA](http://plnkr.co/edit/Jc77jrY4U0xGalN5QkZA)

```
app.directive('zippy', function() {
    return {
        scope: false,
        template: "Hello FooBar",
        restrict: 'E'
    };
}); 
```

文档： [http ://docs.angularjs.org/guide/directive](http://docs.angularjs.org/guide/directive)

restrict - 将指令限制为特定指令声明样式的 EACM 子集字符串。如果仅在属性上允许省略指令。

E - 元素名称：

A - 属性：

C - 等级：

M - 评论：

# javascript - 从url获取参数

> ID：16041124
> 
> 赞同：0
> 
> 时间：2013-04-16T15:32:26.190
> 
> 标签：javascript, jquery, url

我有这个网址`index.html#secondPage?name=the%20second%20page`

我想使用 javascript 和 jquery 获取名称（“第二页”）的值

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:36:01.317

您可以使用[此问题](https://stackoverflow.com/questions/901115/how-can-i-get-query-string-values?rq=1)答案中的代码。唯一的区别是您想要解析`location.hash`而不是`location.search`所以只需在您选择使用的任何答案中更改它。

您还需要用于`substr`删除前导`#`，例如：

```
var hash = window.location.hash.substr(1); 
```

这是我对链接到的问题的回答中的代码，并进行了修改：

```
function get_query(){
    var url = location.hash.substr(1);
    var qs = url.substring(url.indexOf('?') + 1).split('&');
    for(var i = 0, result = {}; i < qs.length; i++){
        qs[i] = qs[i].split('=');
        result[qs[i][0]] = decodeURIComponent(qs[i][1]);
    }
    return result;
} 
```

你可以像这样使用它：

```
var secondPage = get_query()['name']; // 'the second page' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:40:17.853

试试下面的方法，它会帮助你

**小提琴：http:** [//jsfiddle.net/RYh7U/144/](http://jsfiddle.net/RYh7U/144/)

**Javascript：**

```
function GetURLValue (sKey) {
  return unescape("index.html#secondPage?name=the%20second%20page".replace(new RegExp("^(?:.*[&\\?]" + escape(sKey).replace(/[\.\+\*]/g, "\\$&") + "(?:\\=([^&]*))?)?.*$", "i"), "$1"));
}

alert(GetURLValue("name")); 
```

# android - 具有单独设置活动的小部件

> ID：16041127
> 
> 赞同：0
> 
> 时间：2013-04-16T15:32:31.223
> 
> 标签：android, android-widget

我一直在关注[这个](http://wptrafficanalyzer.in/blog/android-app-widget-with-configuration-activity/)教程来创建一个带有配置活动的小部件。当您将小部件添加到主屏幕时，它会显示设置活动并相应地更改小部件外观。但在那之后你不能改变外观。
但是我希望设置活动是分开的，这意味着应用程序菜单中有一个图标，当您按下它时，设置会显示出来，您可以更改小部件的外观。我尝试将 Android Manifest 中的主启动器更改为设置活动，但它不起作用。如何创建？

AndroidManifest

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="in.wptrafficanalyzer.appwidgetclockconfiguration"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >

    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>

        </intent-filter>
    </activity>

    <activity android:name=".WidgetConfigurationActivity">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
            <action android:name="android.appwidget.action.APPWIDGET_CONFIGURE"/>
        </intent-filter>
    </activity>

    <receiver android:name="AnalogClockWidgetProvider" >
        <intent-filter>
            <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
        </intent-filter>
        <meta-data android:name="android.appwidget.provider"
            android:resource="@xml/widget_info" />
    </receiver>

</application> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:39:51.913

试试这个，它对我有用：

```
<activity
    android:name=".WidgetConfigurationActivity"
    android:launchMode="singleTop"
    android:excludeFromRecents="true">
    <intent-filter>
        <action android:name="android.appwidget.action.APPWIDGET_CONFIGURE" />
    </intent-filter>
</activity> 
```

# php - 将 Ajax 数据传递到 PHP 数组 Switch Case 以处理 SQL 数据

> ID：16041139
> 
> 赞同：0
> 
> 时间：2013-04-16T15:33:25.533
> 
> 标签：php, jquery, html

我有 5 个 HTML 输入字段，每个字段都必须相应地显示自己的车道权重。我不确定我需要如何在这里使用 Ajax，但我需要能够将每个通道名称发送到 PHP，并将这些值返回到它们各自在 HTML 中的输入字段。所有文件都是分开的。到目前为止，如果我对 PHP 变量“lane_name”进行硬编码，它就可以工作，但是我需要它根据需要它的输入字段来循环遍历通道名称。例如，

```
<input name="Lead-1" /> 
```

需要调用switch case“Lead-1”并显示数据库中的权重值等等......所以我需要多个带有Ajax的语句来显示正确的信息，因为我只有Lead-1 输入字段现在显示信息。

HTML

```
<body onload="getLaneWeight();">
<form id="Warehouse_Worksheet" name="Warehouse_Worksheet">
<table align="center">
    <tbody>
        <tr>
            <th>
                Lane Types
            </th>
            <th>
                Total Weight
            </th>
        </tr>
        <tr>
            <td>
                Lead 1
            </td>
            <td>
                <input type="text" name="Lead-1" readonly="readonly" />
            </td>
        </tr>
        <tr>
            <td>
                Lead 2
            </td>
            <td>
                <input type="text" name="Lead-2" readonly="readonly" />
            </td>
        </tr>
        <tr>
            <td>
                Poly 1
            </td>
            <td>
                <input type="text" name="Poly-1" readonly="readonly" />
            </td>
        </tr>
        <tr>
            <td>
                Poly 2
            </td>
            <td>
                <input type="text" name="Poly-2" readonly="readonly" />
            </td>
        </tr>
        <tr>
            <td>
                Poly 3
            </td>
            <td>
                <input type="text" name="Poly-3" readonly="readonly" />
            </td>
        </tr>
    </tbody>
    </table>
</form>
</body> 
```

JS

```
function getLaneWeight() {
$.ajax({
    type: 'GET',
    url: './php/getLaneWeight.php',
    data: 'Lead-1',
    success: function (mydata) {
        document.forms['Warehouse_Worksheet'].elements['Lead-1'].value = mydata;
    },
    error: function () {

    },
    complete: function () {

    }
});
}; 
```

PHP

```
$lane_name = array("Lead-1","Lead-2","Poly-1","Poly-2","Poly-3");

switch ($lane_name[0])
{
case "Lead-1":
  $sql="SELECT SUM(weight)
        FROM bundle_lanes
        WHERE lane_name = 'Lead-1'";
  break;
case "Lead-2":
  $sql="SELECT SUM(weight)
        FROM bundle_lanes
        WHERE lane_name = 'Lead-2'";
  break;
case "Poly-1":
  $sql="SELECT SUM(weight)
        FROM bundle_lanes
        WHERE lane_name = 'Poly-1'";
  break;
case "Poly-2":
  $sql="SELECT SUM(weight)
        FROM bundle_lanes
        WHERE lane_name = 'Poly-2'";
  break;
case "Poly-3":
  $sql="SELECT SUM(weight)
        FROM bundle_lanes
        WHERE lane_name = 'Poly-3'";
  break;
}

$result = mysql_query($sql) or die ('Error'.mysql_error());

while ($data = mysql_fetch_row($result)) {
    $weight = $data[0];
    echo $weight;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:57:09.037

实际上，我想我刚刚找到了另一种方法来解决这个问题并且它正在工作。我刚刚在 PHP 文件中返回了一个数组，然后从 AJax 调用每个数组值：

AJAX/JS

```
//Populate Lane Type Weight Table - JFLAY
function getLaneWeight() {
$.ajax({
    url: './php/getLaneWeight.php',
    dataType:'json',
    success: function (weight) {
        document.forms['Warehouse_Worksheet'].elements['Lead-1'].value = weight[0]['SUM(weight)'];
        document.forms['Warehouse_Worksheet'].elements['Lead-2'].value = weight[1]['SUM(weight)'];
        document.forms['Warehouse_Worksheet'].elements['Poly-1'].value = weight[2]['SUM(weight)'];
        document.forms['Warehouse_Worksheet'].elements['Poly-2'].value = weight[3]['SUM(weight)'];
        document.forms['Warehouse_Worksheet'].elements['Poly-3'].value = weight[4]['SUM(weight)'];
    },
    error: function () {

    }
});
}; 
```

PHP

```
$lane_name = array("Lead-1","Lead-2","Poly-1","Poly-2","Poly-3");

//Define JSON array
$array = array();

foreach ($lane_name as $value) {
    $sql="SELECT SUM(weight)
        FROM bundle_lanes
        WHERE lane_name = '$value'";

    $result = mysql_query($sql) or die ('Error'.mysql_error());

    while ($data = mysql_fetch_array($result)) {
        $array[] = $data;
    }
}

print json_encode($array); 
```

# php - 如何在 easyphp 12.1 上安装 pear 和 php 单元

> ID：16041142
> 
> 赞同：0
> 
> 时间：2013-04-16T15:33:33.477
> 
> 标签：php, phpunit, pear, easyphp

我试过这个：[教程](http://webadio.com/how-to-setup-easyphp-12-0-with-php-5-4-pear-and-phpunit/)，但它没有用。当我尝试使用此命令时：*php go-pear.phar*或简单的*php*，我收到警告：“程序无法启动，因为您的计算机中缺少 yaz4.dll。请尝试重新安装程序以解决此问题。” 我按确定和其他警告：“PHP 启动：无法加载动态库 'E:wEasy\php\php5415x130416164116\ext\php_yaz.dll' - 找不到指定的模块。” 再次按确定并在命令窗口中：

e:\wEasy\php\php5414x130416164146>php go-pear.phra PHP 警告：PHP 启动：无法加载动态库 'E:\wEasy\php\php5414x 130416164146\ext\php_yaz.dll' - 指定的模块不能成立。在第 0 行的未知中

警告：PHP 启动：无法加载动态库 'E:\wEasy\php\php5414x13041 6164146\ext\php_yaz.dll' - 找不到指定的模块。在第 0 行的未知中无法打开输入文件：go-pear.phra

e:\wEasy\php\php5414x130416164146>php PHP 警告：PHP 启动：无法加载动态库 'E:\wEasy\php\php5414x 130416164146\ext\php_yaz.dll' - 找不到指定的模块。在第 0 行的未知中

警告：PHP 启动：无法加载动态库 'E:\wEasy\php\php5414x13041 6164146\ext\php_yaz.dll' - 找不到指定的模块。在第 0 行的未知中

我发现[yaz4.dll 在此处输入描述，](http://php.net/manual/en/yaz.installation.php)但我不知道如何使用它：/

问候， Zserrbo

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-20T01:38:39.917

文件 yaz4.dll 位于目录中：

...easyphp_安装...\apache\bin

您必须聚合到 PATH 环境...

（对不起，我的英语，我是墨西哥人）

# java - 在 Java Swing 表单的顺序执行中需要帮助

> ID：16041143
> 
> 赞同：0
> 
> 时间：2013-04-16T15:33:34.390
> 
> 标签：java, swing

我在运行以下 Java 程序时需要帮助。我希望主程序在显示新`JFrame`窗体后暂停运行，并在新窗口关闭（或单击下一步按钮）后恢复运行。

所以这 10 个表格应该在我按下下一个按钮之后依次出现，而不是一次全部按下！

## 主类.java

```
public class MainClass {
void Run()
{
    for(int i=0;i<10;i++)
        new NewForm().setVisible(true);
}

public static void main (String[] args)
{
    new MainClass().Run();
}
} 
```

## 新窗体.java

```
public class NewForm extends javax.swing.JFrame {

    public NewForm() {
        initComponents();
    }

    @SuppressWarnings("unchecked")
    private void initComponents() {

        jButton1 = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);

        jButton1.setText("Next");

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(155, 155, 155)
                .addComponent(jButton1)
                .addContainerGap(190, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(131, 131, 131)
                .addComponent(jButton1)
                .addContainerGap(146, Short.MAX_VALUE))
        );

        pack();
    }
   public static void main(String args[]) {

        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new NewForm().setVisible(true);
            }
        });
    }
    private javax.swing.JButton jButton1;              
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:44:57.650

设置 jframe 可见不会等到 jframe 关闭，这就是为什么会弹出 10 个 jframe。您只需要显示一个，然后将 ActionLisetener 添加到您的按钮。在此操作中，您只需关闭面板并打开另一个面板。当然，您将需要一些全局计数器，请考虑将 i 设为静态以作为开始。

# php - Opencart 在自定义脚本中发送电子邮件

> ID：16041146
> 
> 赞同：10
> 
> 时间：2013-04-16T15:33:36.717
> 
> 标签：php, scripting, opencart

我的opencart中有一个脚本，由我自己制作，并想让它发送一封电子邮件，但我认为当我尝试获取电子邮件参数时，它们会返回`null`。

这是我的代码：

```
 $email_to = "somewhere@example.com";
    $config = new Config();
    $mail = new Mail();

    $mail->protocol = $config->get('config_mail_protocol');
    $mail->parameter = $config->get('config_mail_parameter');
    $mail->hostname = $config->get('config_smtp_host');
    $mail->username = $config->get('config_smtp_username');
    $mail->password = $config->get('config_smtp_password');
    $mail->port = $config->get('config_smtp_port');
    $mail->timeout = $config->get('config_smtp_timeout');            
    $mail->setTo($email_to);
    $mail->setFrom("nuno@[mydomain].com");
    $mail->setSender("nuno@[mydomain].com");
    $mail->setSubject("test send mail");
    $mail->setText("test message body text");
    $mail->send(); 
```

当我尝试调用时：`echo $config->get('config_mail_protocol');`它返回`null`.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-11-15T07:41:24.123

我在使用前面提到的代码发送邮件时遇到了问题。自 opencart 2 以来，Opencart 邮件变量已更改。

这是 opencart 2.3 的代码

```
$mail = new Mail();
$mail->protocol = $this->config->get('config_mail_protocol');
$mail->parameter = $this->config->get('config_mail_parameter');
$mail->smtp_hostname = $this->config->get('config_mail_smtp_hostname');
$mail->smtp_username = $this->config->get('config_mail_smtp_username');
$mail->smtp_password = html_entity_decode($this->config->get('config_mail_smtp_password'), ENT_QUOTES, 'UTF-8');
$mail->smtp_port = $this->config->get('config_mail_smtp_port');
$mail->smtp_timeout = $this->config->get('config_mail_smtp_timeout');

$mail->setTo($order_info['email']);
$mail->setFrom($this->config->get('config_email'));
$mail->setSender(html_entity_decode($order_info['store_name'], ENT_QUOTES, 'UTF-8'));
$mail->setSubject(html_entity_decode($subject, ENT_QUOTES, 'UTF-8'));
$mail->setHtml($this->load->view('mail/order', $data));
$mail->setText($text);
$mail->send(); 
```

直接复制的代码块`catalog/model/checkout/order.php`

我希望有人会发现这很有用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-16T15:38:57.770

不要创建新的实例，`Config`而只是简单地调用

```
$email_to = "somewhere@example.com";
$mail = new Mail();

$mail->protocol = $this->config->get('config_mail_protocol');
$mail->parameter = $this->config->get('config_mail_parameter');
$mail->hostname = $this->config->get('config_smtp_host');
$mail->username = $this->config->get('config_smtp_username');
$mail->password = $this->config->get('config_smtp_password');
$mail->port = $this->config->get('config_smtp_port');
$mail->timeout = $this->config->get('config_smtp_timeout');            
$mail->setTo($email_to);
$mail->setFrom("somewhere@example.com");
$mail->setSender("somewhere@example.com");
$mail->setSubject("test send mail");
$mail->setText("test message body text");

$mail->send(); 
```

# internet-explorer - Iframe Cookies Blocked IE - 替代方式

> ID：16041147
> 
> 赞同：0
> 
> 时间：2013-04-16T15:33:40.767
> 
> 标签：internet-explorer, iframe

示例 Iframe：http: [//goo.gl/25ecS](http://goo.gl/25ecS) index.php

```
<?php
   header('P3P:CP="IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT"');
 ?>
<!DOCTYPE html>
<html>
<head>
    <title>EXAMPLE</title>
</head>
<body>
<iframe id="foob"   width="100%" height="550" frameborder="0" marginheight="0" marginwidth="0" scrolling="yes" onLoad="window.parent.scroll(0,0);"   src="http://www.xxxxx.com/buildyourown/Results/Results_xsl.aspx?aff=&incdirect=1&boardType=&rooms=1&rating=2&r3c_ages=2%2C+2%2C+2%2C+2&r1a=2&r2c=0&r2i_ages=0%2C+0%2C+0%2C+0&r3i=0&airportto=LCA&r1i=0&r1c=0&r1i_ages=0%2C+0%2C+0%2C+0&_stage=search&locationset=&populardestinations=3100&r2a=2&r2c_ages=2%2C+2%2C+2%2C+2&r3c=0&locationto=3100&aclocationto=&flexibility=3&r1c_ages=2%2C+2%2C+2%2C+2&r3a=2&r3i_ages=0%2C+0%2C+0%2C+0&airportfrom=LON&airportfromfreetext=&r2i=0&spechotelname=&freetext=-+type+your+destination+-&numadults=2&numchildren=0&numinfants=0&_searchrandom=711211764-20399-68269&search_type=Flight_Hotel_Transfer&startdate_d=19&startdate_m=4&startdate_y=2013&enddate_d=26&enddate_m=4&enddate_y=2013&startdate=10+June+2013&enddate=17+June+2013&transport=transfer" /></iframe>
 </body>
</html> 
```

iframe 正在使用 ff 或 chrome，但 Internet expoleer 阻止了 cookie。我不知道如何解决这个问题。我将此代码（ header('P3P:CP="IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT"'); ）放在我的页面顶部，但仍然不起作用。当我点击购物篮时，没有任何购物篮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-17T18:28:52.230

以下是三个可能有帮助的建议（不一定是解决方案）：

*   **会话变量：**如果您尝试仅存储该会话的信息，请考虑使用会话变量。

*   **浏览器存储：**第二个建议是考虑将信息存储在浏览器 ( [jStorage](http://www.jstorage.info/) ) 中，该浏览器在一些更现代的浏览器（包括 Internet Explorer 6+）中适用于移动设备和桌面。我相信两者都应该与 iframe 一起使用。

*   **弹出窗口：**考虑使用弹出窗口、表单或其他机制来“突破”iframe。许多 3rd 方购物车被实施为弹出窗口，以绕过这些限制。

# html - CSS中的方括号

> ID：16041149
> 
> 赞同：9
> 
> 时间：2013-04-16T15:33:48.063
> 
> 标签：html, css, forms

CSS中方括号之间的内容是什么意思？例如

`input[type="radio"]`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-17T08:45:01.337

它是 CSS 中的属性选择器

> `E[foo="warning"]` 匹配任何“foo”属性值完全等于“警告”的 E 元素。

更多关于[http://www.w3.org/TR/CSS2/selector.html](http://www.w3.org/TR/CSS2/selector.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-17T08:44:17.380

方括号是[属性选择器](http://www.w3.org/TR/css3-selectors/#attribute-selectors)语法。

*您的（完整）示例的意思是“选择类型输入*的元素，其*类型*属性的值为*单选*”，例如`<input type="radio">`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T08:44:31.337

这是一个属性选择器。它选择具有指定属性的元素。你可以在这里找到更多关于它们的信息：[https ://developer.mozilla.org/en-US/docs/CSS/Attribute_selectors](https://developer.mozilla.org/en-US/docs/CSS/Attribute_selectors)

在您的示例中：`input[type="radio"]`

这将匹配一个看起来像这样的元素：

```
<input type='radio'> 
```

您在问题中给出的选择器意味着它需要所有三个单词：元素名称“输入”、属性“类型”和该属性的值是“收音机”。

浏览器兼容性：这是一个标准选择器，可在所有常用浏览器中使用。您可能需要担心的唯一不支持它的浏览器是 IE6。[有关此选择器和其他 CSS 选择器的兼容性图表，请参见此处](http://quirksmode.org/css/selectors/)。

希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T08:44:36.207

这是一个 CSS 属性选择器，它只会选择类型设置为单选的输入，也就是说，它将选择所有单选按钮。 [这是](http://css-tricks.com/attribute-selectors/)一篇文章，对其进行了更多解释。

# asp.net-mvc - cshtml / 没有操作方法的视图

> ID：16041152
> 
> 赞同：1
> 
> 时间：2013-04-16T15:33:58.797
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我可以在不编写操作方法的情况下将 cshtml 页面作为视图提供吗？

那么，如果我有一个名为 Help 的控制器和一个名为 Money.cshtml 的视图，我想以 localhost/help/money 的身份访问它而不编写操作方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:19:58.767

You could do something like the following. Define a route that maps to just one action e.g.:

```
routes.MapRoute(
    "Help_default", // Route name
    "help/{path}", // URL with parameters
    new { controller = "About", action = "Page" }
); 
```

Then your help controller could look like the following. It basically just grabs the path from the URL and passes that as the model to the view.

```
public class HelpController : Controller
{
    public ViewResult Page(string path)
    {
        return View("Page", path);
    }
} 
```

Your Page view could then look like:

```
@model string

@{
    string viewPath = string.Format("~/Views/Help/{0}.cshtml", Model);
    ViewEngineResult result = ViewEngines.Engines.FindView(this.ViewContext.Controller.ControllerContext, viewPath, null);
    if (result.View != null)
    {
        @Html.Partial(viewPath)
    } else {
        // Define a not found view in the shared folder?
        @Html.Partial("NotFound")
    }
} 
```

Which basically checks to see if a view exists with that path or not. It feels a bit dirty but I think it would work.

# c# - 跨线程操作无效：控件“Form1”从创建它的线程以外的线程访问

> ID：16041154
> 
> 赞同：-2
> 
> 时间：2013-04-16T15:34:02.317
> 
> 标签：c#, multithreading, winforms

我对 C# 很陌生，但我一直在玩它来学习。到目前为止，我有一个不错的应用程序，它可以执行诸如启动屏幕保护程序和控制 Windows 系统音量之类的操作。

但是我遇到了一些麻烦，我不确定出了什么问题。我已经在网站上经历了一堆类似的问题，但我认为其中任何一个都不适用于我的具体案例。

所以我想从网络控制应用程序。我的计划是让应用程序每隔几秒钟检查一次我网站上的网页是否有命令。根据网站返回的内容，应用程序将执行不同的操作（静音、音量增大等）并将网站上的命令重置为空白。网站命令部分全部用PHP完成，非常简单，那部分没有问题。

我创建了一个按钮，该按钮调用一个检查页面并执行操作的函数。它工作得很好。但是当我试图让它自动检查网站时，我遇到了错误。我很确定这是因为我将检查和执行操作移到了一个新线程。所以让我们继续看代码。这些不是完整的文件，但我认为您需要知道以提供帮助。如果您需要更多信息，请告诉我。

Form1.cs

```
public Form1(Boolean init = true)
    {
        if (init)
        {
            InitializeComponent(); //initialize UI
            startWebMonitor(); //starts web monitor thread for remote web commands
        }
    }

private void startWebMonitor()
    {
        Thread t = new Thread(WebMonitor.doWork);
        t.Start();
    }

public IntPtr getWindowHandle()
    {
        return this.Handle;
    } 
```

WebMonitor.cs

```
public static void doWork()
    {
        while(true)
        {
            checkForUpdate();
            Thread.Sleep(1000);
        }
    }

private static void checkForUpdate()
    {
        lastCommand = getLastCommand();

        if (lastCommand.Equals(""))
        {
            //No Update
        }
        else
        {
            processCommand(lastCommand);
        }
    }

public static void processCommand(String command)
    {
        if(command.Equals("mute"))
        {
            VolumeCtrl.mute(Program.form1.getWindowHandle());
        }

        HTTPGet req2 = new HTTPGet();
        req2.Request("http://mywebsite.com/commands.php?do=clearcommand");
    } 
```

VolumeCtrl.cs

```
private static IntPtr getWindowHandle()
    {
        Form1 form1 = new Form1(false); //false = do not initialize UI again
        return form1.getWindowHandle();
    }

    public static void mute(IntPtr handle)
    {
        SendMessageW(getWindowHandle(), WM_APPCOMMAND, getWindowHandle(), (IntPtr)APPCOMMAND_VOLUME_MUTE);
    } 
```

好吧，基本上静音功能需要窗口句柄才能工作。但是当我尝试从新线程获取窗口句柄时，它会抛出错误：

> 跨线程操作无效：控件“Form1”从创建它的线程以外的线程访问。

那么我该如何解决呢？我在这里阅读了其他答案，说您需要使用 Invoke 或 Delegate，但我不确定它们是如何工作的或在哪里使用它们。我试图遵循其中一个答案，但我遇到了更多错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:10:42.360

在这种情况下，在方法内部编写调用操作。然后您可以从控件的线程和其他线程访问。

```
delegate IntPtr GetWindowHandleDelegate();

private IntPtr GetWindowHandle() {

    if (this.InvokeRequired) {

        return (IntPtr)this.Invoke((GetWindowHandleDelegate)delegate() {

            return GetWindowHandle();

        });
    }

    return this.Handle;
} 
```

或者，如果您想避免委托地狱，您可以使用内置委托和 lambda 编写更多代码。

```
private IntPtr GetWindowHandle() {
    if (this.InvokeRequired)
        return (IntPtr)this.Invoke((Func<IntPtr>)(GetWindowHandle));

    return this.Handle;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-10T09:39:48.633

试试这个代码它肯定会帮助你

```
BackgroundWorker bw = new BackgroundWorker();
bw.DoWork += (s, e) => { };
bw.RunWorkerCompleted += (s, e) => 
 {
  //Call you windowsform method or anything which you want to do
 };
bw.RunWorkerAsync(); 
```

# java - Java webapp 中的网络摄像头实时流式传输

> ID：16041157
> 
> 赞同：0
> 
> 时间：2013-04-16T15:34:10.573
> 
> 标签：java, web-applications, webcam, http-live-streaming

好的，我知道这可能不是那么容易，但我有这个要求。基本上，webapp 将有一个带有实时流网络摄像头的简单 jsp。如何获取流并将其嵌入到应用程序中？

我已经阅读了有关 RTPS 和 Red5 之类的内容，但似乎不太容易找到有关如何执行此操作的简单明了的教程！

顺便说一句，我对其他一切都持开放态度（比如 http 流媒体？flash？）。越简单越好！

提前致谢！

# web-scraping - 如何删除 Scrapy Spider 数据中的空白

> ID：16041158
> 
> 赞同：5
> 
> 时间：2013-04-16T15:34:10.910
> 
> 标签：web-scraping, scrapy

我正在用 Scrapy 编写我的第一个蜘蛛并尝试遵循文档。我已经实现了 ItemLoaders。蜘蛛提取数据，但数据包含许多行返回。我尝试了很多方法来删除它们，但似乎没有任何效果。replace_escape_chars 实用程序应该可以工作，但我不知道如何将它与`ItemLoader`. 也有些人使用（unicode.strip），但同样，我似乎无法让它工作。有些人尝试在 items.py 中使用这些，而其他人则在蜘蛛中使用。如何清理这些线路返回的数据 (\r\n)？我的 items.py 文件仅包含项目名称和 field()。蜘蛛代码如下：

```
from scrapy.spider import BaseSpider
from scrapy.selector import HtmlXPathSelector
from scrapy.contrib.loader import XPathItemLoader
from scrapy.utils.markup import replace_escape_chars
from ccpstore.items import Greenhouse

class GreenhouseSpider(BaseSpider):
    name = "greenhouse"
    allowed_domains = ["domain.com"]
    start_urls = [
        "http://www.domain.com",
    ]

    def parse(self, response):
        items = []
        l = XPathItemLoader(item=Greenhouse(), response=response)
        l.add_xpath('name', '//div[@class="product_name"]')
        l.add_xpath('title', '//h1')
        l.add_xpath('usage', '//li[@id="ctl18_ctl00_rptProductAttributes_ctl00_liItem"]')
        l.add_xpath('repeat', '//li[@id="ctl18_ctl00_rptProductAttributes_ctl02_liItem"]')
        l.add_xpath('direction', '//li[@id="ctl18_ctl00_rptProductAttributes_ctl03_liItem"]')
        items.append(l.load_item())

        return items 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T16:01:32.643

您可以`default_output_processor`在加载程序上使用，也可以在各个字段上使用其他处理器，请参阅`title`：

```
from scrapy.spider import BaseSpider
from scrapy.contrib.loader import XPathItemLoader
from scrapy.contrib.loader.processor import Compose, MapCompose
from w3lib.html import replace_escape_chars, remove_tags
from ccpstore.items import Greenhouse

class GreenhouseSpider(BaseSpider):
    name = "greenhouse"
    allowed_domains = ["domain.com"]
    start_urls = ["http://www.domain.com"]

    def parse(self, response):
        l = XPathItemLoader(Greenhouse(), response=response)
        l.default_output_processor = MapCompose(lambda v: v.strip(), replace_escape_chars)
        l.add_xpath('name', '//div[@class="product_name"]')
        l.add_xpath('title', '//h1', Compose(remove_tags))
        l.add_xpath('usage', '//li[@id="ctl18_ctl00_rptProductAttributes_ctl00_liItem"]')
        l.add_xpath('repeat', '//li[@id="ctl18_ctl00_rptProductAttributes_ctl02_liItem"]')
        l.add_xpath('direction', '//li[@id="ctl18_ctl00_rptProductAttributes_ctl03_liItem"]')

        return l.load_item() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T18:54:41.010

事实证明，数据中也有很多空格，因此将 Steven 的答案与更多研究相结合，可以将数据中的所有标签、换行符和重复空格都删除。工作代码如下。请注意在加载程序行上添加了 text() ，它删除了标签以及拆分和连接处理器以删除空格和行返回。

```
def parse(self, response):
        items = []
        l = XPathItemLoader(item=Greenhouse(), response=response)
        l.default_input_processor = MapCompose(lambda v: v.split(), replace_escape_chars)
        l.default_output_processor = Join()
        l.add_xpath('title', '//h1/text()')
        l.add_xpath('usage', '//li[@id="ctl18_ctl00_rptProductAttributes_ctl00_liItem"]/text()')
        l.add_xpath('repeat', '//li[@id="ctl18_ctl00_rptProductAttributes_ctl02_liItem"]/text()')
        l.add_xpath('direction', '//li[@id="ctl18_ctl00_rptProductAttributes_ctl03_liItem"]/text()')
        items.append(l.load_item())
        return items 
```

# javascript - 相对 z 索引

> ID：16041164
> 
> 赞同：1
> 
> 时间：2013-04-16T15:34:29.370
> 
> 标签：javascript, jquery, html, z-index

我正在尝试使用以等距格式重叠的图像设计地图。现在，我有 2 种不同的设计，每一种都解决了彼此的问题。这是当前设置： http: [//mc1.empirebattles.com/map/maplayout.html](http://mc1.empirebattles.com/map/maplayout.html)

左边的显示有垂直重叠的问题，右边的显示有水平重叠的问题。

我知道原因是由于当 z-index 应用于父容器时，随后应用于子容器的 z-indexes 本地化在父容器内....但我仍然需要“行”效果跨越多个父 div。

我知道一种解决方案是不为父 div 分配 z-index，而只是为每一行分配升序/降序 z-index，但在最终产品中，父 div 将被动态创建，我正在尝试避免必须在每一行计算相对 z-index....

我想不出任何其他方法来做到这一点......还有其他人对*如何相对应用z-index有任何想法吗？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:37:53.010

避免*计算*的一种方法是提前为每一行保留范围。假设您在每行中最多可以有 100 个单位，那么每行中的元素将获得行号`100*n`在哪里的偏移量`n`。

这对你有用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:40:35.853

我从来没有找到一种方法来为不同的相对或绝对容器中的事物交织 z-index。

我认为它就像两本书。在现实生活中，您可以将两本书半打开并将它们楔在一起，这样一些页面就在彼此之间，就像这样：http: [//4.bp.blogspot.com/_e3GqvYXugb8/Se11YQaT-YI/AAAAAAAAAGQ /ljKewd_WMj0/s320/PhoneBook.jpg](http://4.bp.blogspot.com/_e3GqvYXugb8/Se11YQaT-YI/AAAAAAAAAGQ/ljKewd_WMj0/s320/PhoneBook.jpg)

在 CSS 中，这是不可能的。

我认为最直接的事情是决定一个绝对框架，如屏幕大小或整个地图，以及针对该单一父级的所有对象的位置和 z-index。然后，您可以将所有游戏对象视为......以及独立对象，而不必担心这些奇怪的行容器和其他布局特定元素。

# c# - 当我使用包含选项卡的 SetContentView (Resource.Layout.Main) 时出现 Android.Views.InflateException

> ID：16041169
> 
> 赞同：1
> 
> 时间：2013-04-16T15:34:40.847
> 
> 标签：c#, android, android-layout, xamarin.android, xamarin-studio

`Android.Views.InflateException`当我使用`setContentView (Resource.Layout.Main)`包含选项卡并且不明白为什么时，我得到了一个。

我一直在试图找到其他人遇到我的问题，但这似乎`Android.Views.InflateException`是一个非常普遍的错误信息，因为人们似乎在各种情况下都能得到它。我已经尝试了一些我看到提到的东西，但到目前为止它们并没有帮助我。

奇怪的是，完全相同的`Main.axml`代码可以在不同的试用应用程序中完美运行，但我无法让它在这个应用程序中运行。

我在编程应用程序方面相当新，我不知道它是否有任何区别，但我正在使用**Xamarin Studio**。我尝试了其他一些简单的应用程序来使用所有新事物，并且它们运行起来没有太多麻烦。

这是我的主启动器的代码：

```
using System;

using System.IO;
using Android.App;
using Android.Content;
using Android.OS;
using Android.Runtime;
using Android.Views;
using Android.Widget;
//using Mono.Data.Sqlite;

namespace MultiFuncTest1
{
    [Activity (MainLauncher=true, Label="@string/app_name", Theme="@android:style/Theme.NoTitleBar")]
    public class MultiFuncTest1 : TabActivity
    {

        protected override void OnCreate (Bundle bundle)
        {
            base.OnCreate (bundle);

            // Set the view from the "main" layout resource
            SetContentView (Resource.Layout.Main);

            // ----------------------------------------------------------------------------------------------------
            //                                                  TABS
            // ----------------------------------------------------------------------------------------------------

            // Declares TabSpec and Intent
            TabHost.TabSpec spec;
            Intent intent;

            // Creates and Intent To Start and Activity for the Image-tab.
            intent = new Intent (this, typeof (ImageActivity));
            intent.AddFlags (ActivityFlags.NewTask);

            // Starts a TabSpec for the Image-tab and adds it to the TabHost
            spec = TabHost.NewTabSpec ("image");
            spec.SetIndicator ("Image", Resources.GetDrawable (Resource.Drawable.Icon));
            spec.SetContent (Intent);
            TabHost.AddTab (spec);

            // Creates and Intent To Start and Activity for the Icon-tab.
            intent = new Intent (this, typeof (IconActivity));
            intent.AddFlags (ActivityFlags.NewTask);

            // Starts a TabSpec for the Icon-tab and adds it to the TabHost
            spec = TabHost.NewTabSpec ("icons");
            spec.SetIndicator ("Icons", Resources.GetDrawable (Resource.Drawable.Icon));
            spec.SetContent (Intent);
            TabHost.AddTab (spec);

            // Creates and Intent To Start and Activity for the Image-tab.
            intent = new Intent (this, typeof (ItemListActivity));
            intent.AddFlags (ActivityFlags.NewTask);

            // Starts a TabSpec for the Image-tab and adds it to the TabHost
            spec = TabHost.NewTabSpec ("itemList");
            spec.SetIndicator ("Item List", Resources.GetDrawable (Resource.Drawable.Icon));
            spec.SetContent (Intent);
            TabHost.AddTab (spec);

            // Creates and Intent To Start and Activity for the Image-tab.
            intent = new Intent (this, typeof (WebLinkActivity));
            intent.AddFlags (ActivityFlags.NewTask);

            // Starts a TabSpec for the Image-tab and adds it to the TabHost
            spec = TabHost.NewTabSpec ("webLink");
            spec.SetIndicator ("Web Links", Resources.GetDrawable (Resource.Drawable.Icon));
            spec.SetContent (Intent);
            TabHost.AddTab (spec);

            TabHost.CurrentTab = 1;
        }

    }

} 
```

这是我的 ImageActivity 的代码，它应该是选项卡之一。目前所有选项卡活动都有非常相似的代码，因为我只是想让大纲工作：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

using Android.App;
using Android.Content;
using Android.OS;
using Android.Runtime;
using Android.Views;
using Android.Widget;

namespace MultiFuncTest1
{
    [Activity (Label = "ImageActivity")]
    public class ImageActivity : Activity
    {
        protected override void OnCreate (Bundle savedInstanceState)
        {
            base.OnCreate (savedInstanceState);

            //SetContentView (Resource.Layout.ImagePage);

            TextView textview = new TextView (this);
            textview.Text = "This is the Artists tab";
            SetContentView (textview);
        }
    }
} 
```

这是我的`Main.axml`：

```
<?xml version="1.0" encoding="utf-8"?>
<TabHost xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/tabhost"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <LinearLayout
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:padding="5dp">
        <TabWidget
            android:id="@android:id/tabs"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"/>
        <FrameLayout
            android:id="@android:id/tabcontent"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:padding="5dp"/>
    </LinearLayout>
</TabHost> 
```

而`ImagePage.axml`which 将是选项卡之一。其他选项卡目前看起来非常相似：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:minWidth="25px"
    android:minHeight="25px">
    <ImageView
        android:src="@drawable/Icon"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:id="@+id/iPimageView1" />
</LinearLayout> 
```

这是我得到的堆栈跟踪的第一部分。在“托管异常堆栈跟踪结束”部分之后，跟踪会持续很长时间，并以“和 250 多行”之类的东西结束，或者类似的东西，所以我认为这些不那么重要吗？如果他们有帮助，请告诉我，我也会添加它们：

```
Android.Views.InflateException: Binary XML file line #24: Error inflating class <unknown>
at Android.Runtime.JNIEnv.CallNonvirtualVoidMethod (intptr,intptr,intptr,Android.Runtime.JValue[]) [0x00024] in /Users/builder/data/lanes/monodroid-lion-bs1/03814ac5/source/monodroid/src/Mono.Android/src/Runtime/JNIEnv.g.cs:616
at Android.App.Activity.SetContentView (int) [0x0006b] in /Users/builder/data/lanes/monodroid-lion-bs1/03814ac5/source/monodroid/src/Mono.Android/platforms/android-8/src/generated/Android.App.Activity.cs:3119
at MultiFuncTest1.MultiFuncTest1.OnCreate (Android.OS.Bundle) [0x00009] in d:\Mobile App Dev\Projects\MultiFuncTest1\MultiFuncTest1\MultiFuncTest1.cs:24
at Android.App.Activity.n_OnCreate_Landroid_os_Bundle_ (intptr,intptr,intptr) [0x00010] in /Users/builder/data/lanes/monodroid-lion-bs1/03814ac5/source/monodroid/src/Mono.Android/platforms/android-8/src/generated/Android.App.Activity.cs:1490
at at (wrapper dynamic-method) object.46f87726-02c8-486d-b95c-c7cce7c7d106 (intptr,intptr,intptr) <IL 0x00017, 0x00043>
at 
at --- End of managed exception stack trace --- 
```

我希望有人可以帮助我理解这里的问题，我真的很想了解我可能做错了什么......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:57:09.403

您的 ImagePage.axml 不需要 TabHost 和 TabWidget 标签；你应该只在你的 Main.axml 中有那些。您的选项卡的布局将包含在 Main.axml 中的 FrameLayout 中，因此每个选项卡布局文件只有一个

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T06:55:33.783

经过更多搜索后，我自己发现了问题，它在我的主启动器中。问题是我试图在“spec.SetContent (Intent);”中调用类“Intent”。在创建每个类时行，而我应该调用的是它的实例，“intent”（没有大写的“i”）。所以基本上这是一个拼写错误，但它没有显示为我的语法错误，因为有一个同名的类......

不管怎么说，还是要谢谢你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-08T19:19:18.483

这可能无关紧要，但无论谁仍然想知道这个错误可能来自哪里 - 可能会为您指明正确的方向。

我有同样的问题，原来我在 AXML 中引用的自定义控件指定了错误的路径，即找不到控件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-02T17:00:03.447

这个问题我遇到过很多次了

当您未在活动中定义主题时，将引发此特定异常。你应该有这样的东西

```
[Activity (Label = "ImageActivity", Theme="@style/yourtheme")] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-07T13:06:59.810

这个问题我遇到过很多次了

当您未在活动中定义主题时，将引发此特定异常。你应该有这样的东西

[活动（标签=“ImageActivity”，主题=“@styles/yourtheme”）]

**#### 在Visual Studio 中，样式的文件名是styles.xml 而不是style.xml**

# javascript - Backbone.js 不会发出跨主机请求？

> ID：16041172
> 
> 赞同：6
> 
> 时间：2013-04-16T15:34:52.457
> 
> 标签：javascript, google-chrome, backbone.js, cross-domain

我一直在我的 Chrome 控制台中使用 Backbone 并遇到了一个我无法弄清楚的跨域问题。

我连接的主机可能正确实现了 CORS，因为原始 XHR 请求返回预期的 JSON：

```
var http = new XMLHttpRequest();
http.open('GET', 'http://example.com:3000/entities/item/15.json', true);
http.onreadystatechange = function(evt) { console.log(evt); }
http.send(); 
```

（在控制台上记录 3 个 XHR 进度事件，并在响应中包含正确的数据）

但是当我使用 Backbone 执行以下操作时，浏览器不喜欢它：

```
var Item = Backbone.Model.extend({});
var ItemsCollection = Backbone.Collection.extend({
  model: Item,
  url: 'http://example.com:3000/entities/item/'
});
var items = new ItemsCollection();
items.fetch(); 
```

（返回`XMLHttpRequest cannot load http://example.com:3000/entities/item/. Origin http://localhost:8000 is not allowed by Access-Control-Allow-Origin.`）

我需要做些什么来告诉 Backbone 使用 CORS 吗？这个错误似乎在浏览器发出请求之前就已经出现了，所以我认为这不是服务器配置错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T17:31:31.623

我希望其中一个有帮助（我还没有尝试过）：
1.[覆盖 Backbone.js 同步以允许跨域](http://naleid.com/blog/2012/10/29/overriding-backbone-js-sync-to-allow-cross-origin-resource-sharing-cors/)

```
(function() {
  var proxiedSync = Backbone.sync;
  Backbone.sync = function(method, model, options) {
    options || (options = {});
    if (!options.crossDomain) {
      options.crossDomain = true;
    }
    if (!options.xhrFields) {
      options.xhrFields = {withCredentials:true};
    }
    return proxiedSync(method, model, options);
  };
})(); 
```

2.backbone.js[的跨域CORS支持](https://stackoverflow.com/questions/14185383/cross-domain-cors-support-for-backbone-js)

```
$.ajaxPrefilter(function(options, originalOptions, jqXHR) {
    options.crossDomain ={
        crossDomain: true
    };
    options.xhrFields = {
        withCredentials: true
    };
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-01-11T15:42:53.513

嘿，你可以使用类似的东西：

```
 var PostsCollection = Backbone.Collection.extend({
   initialize: function(models, options) {
     //this.id = options.id;
   },
   url: 'http://myapi/api/get_posts/?count=8',
 });

 posts = new PostsCollection();
 posts.fetch({
   dataType: 'jsonp',
   success : function (data) {
     console.log(data);
   }
 }); 
```

关键是我们需要使用'jsonp'

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T19:31:42.523

事实证明，我使用 Backbone 请求的 URL 与通过 XHR 请求的 URL 略有不同（它们缺少查询参数）。这导致服务器为 500，它没有 CORS 标头。Chrome 在调试面板的网络选项卡中根本没有显示 HTTP 请求，所以我非常困惑。

修复服务器上的 500 使这项工作再次发生。

# haskell - 在 Haskell 中评估 \_ -> undefined

> ID：16041177
> 
> 赞同：7
> 
> 时间：2013-04-16T15:35:08.253
> 
> 标签：haskell

我一直在阅读这个[http://www.haskell.org/haskellwiki/Hask](http://www.haskell.org/haskellwiki/Hask)。我在这部分苦苦挣扎..

```
undef1 = undefined :: a -> b
undef2 =  \_ -> undefined 
```

为什么他们会有这样的行为..

```
seq undef1 () = undefined
seq undef2 () = ()
undef2 () = undefined 
```

这是什么原因？我想了解这种行为，但我什至不知道从哪里开始。特别是，为什么 undef2 在严格评估下表现不同？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T16:00:51.200

特殊函数`seq`将其第一个参数评估为弱头范式，然后返回其第二个参数。可以在[此处](https://stackoverflow.com/questions/6872898/haskell-what-is-weak-head-normal-form)找到对 WHNF 的一个很好的解释，但出于此答案的目的，我将仅使用[Haskell wiki 定义](http://www.haskell.org/haskellwiki/Weak_head_normal_form)：

> 一个表达式是弱头范式 (WHNF)，如果它是：
> 
> *   一个构造函数（最终应用于参数），例如 True、Just (square 42) 或 (:) 1
> *   应用于太少参数（可能没有）的函数，如 (+) 2 或 sqrt。
> *   或 lambda 抽象 \x -> 表达式。

重要的一点是，当表达式是构造函数时，`seq`只查看构造函数的标记。因此，`seq (Just undefined) 1`评估为`1`。

另一个重要的一点是 Haskell 中的所有类型都被[*提升了*](http://hackage.haskell.org/trac/ghc/wiki/Commentary/Rts/Storage/HeapObjects)- 也就是说，评估类型的值可能导致执行无限循环或抛出异常（通常使用`error`or `undefined`）。在我们评估之后`seq a b`，我们可以确定评估`a`WHNF 不会导致无限循环或异常。

有了这些知识，让我们看一下您的示例：

```
undef1 = undefined :: a -> b
undef2 =  \_ -> undefined 
```

当`seq undef1 ()`被评估时，`seq`首先尝试找出上述三个类别中的哪一个`undef1`。但是`undef1`是`undefined`，因此整个表达式的计算结果为`undefined`。

但是，在 的情况下`seq undef2 () = ()`，第一个参数是 lambda 抽象。由于`seq`看不到 lambda，它返回第二个参数。

第三个示例`undef2 () = undefined`只是评估应用程序的直接结果`(\_ -> undefined) ()`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T15:48:34.057

他们不是一回事。undef1 是从 a 到 b 的函数，但未定义哪个函数。将 undef1 评估为头部正常形式会给您 undefined。

undef2 是从 a 到 b 的函数。具体来说，它是一个忽略其参数并返回未定义的函数。但是 undef2 本身并不是未定义的。只有当您尝试评估函数时（如在第三行中），您才会得到未定义。因此，当您将 undef2 评估为头范式时，您会得到一个正确的函数，而不是未定义的。

用更重要的术语来说（总是不准确的根源，但如果你更熟悉它，它很好地说明了这一点），将 undef1 视为永远不会返回的属性获取器。（在 Haskell 中，不返回和未定义在语义上是等价的。） undef2 是一个返回函数的属性 getter；如果您调用它，该函数将不会返回。在 C# 中：

```
Func<Object, Object> Undef1 {
  get {
    while (true) {}
    return null;
  }
}

Func<Object, Object> Undef2 {
  get {
    return _ -> {
      while (true) {}
      return null;
    }
  }
} 
```

现在你的测试变成：

```
var x = Undef1;
var y = Undef2;
var z = Undef2(null); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-16T15:53:28.577

为了这个问题，假设有三件事可以强制一个值被实际评估：

*   该值的模式匹配
*   将值应用于参数
*   使用它作为第一个参数`seq`

实际情况稍微复杂一些，但在这里并不重要。

此外，这种强制只发生在某些外部表达式的上下文中，因此与其以某种抽象的方式将这些视为“强制评估”，不如将它们视为使外部表达式的评估依赖于对外部表达式的评估。价值。这就是为什么，例如，在任何意义上`seq x x`都不会强制`x`，因为无论如何这都是表达式的最终值；它说当评估外部表达式（其值为`x`）时，它也应该评估`x`，这是多余的。

最后，任何依赖于强制未定义值的值本身就是未定义的。

* * *

遍历每个表达式：

```
seq undef1 () = undefined 
```

在这种情况下`undef1`是未定义的，并且`seq undef1 x`是一个表达式，其值是`x`并且取决于评估`undef1`。因此，无论第二个参数`seq`是什么，整个表达式都是未定义的。

```
seq undef2 () = () 
```

在这种情况下，`undef2`不是*未定义*的，而是应用它的结果。`seq undef2 x`是一个表达式，其值为`x`并取决于评估`undef2`。这不会导致任何问题，并且第一个参数 to`seq`被丢弃，所以表达式的值在`()`这里。

```
undef2 () = undefined 
```

在这种情况下，我们`undef2`直接申请。表达式`undef2 ()`取决于`undef2`(这很好) 的评估，并评估应用的结果`undef2`，在这种情况下是`undefined`.

将此与第四种情况进行对比：

```
undef1 () = undefined 
```

在这种情况下，我们正在应用`undef1`，因此表达式的值取决于评估`undef1`，这是未定义的，因此整个表达式也是如此。这与之前使用 的表达式具有相同的“值” `undef2`，但原因却截然不同！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-16T16:26:02.143

好吧，只是写一个比其他人更简短的答案：为了强制评估类似 的表达式`f x`，Haskell 首先需要弄清楚函数`f`是什么，然后应用它`x`。用更专业的术语来说，无论何时`f x`被*强制*，都`f`必须被强制。

现在让我们回到您的定义：

```
undef1 :: a -> b
undef1 = undefined

undef2 :: a -> b
undef2 =  \_ -> undefined 
```

强迫`undef1`并`undef2`产生不同的结果。强制`undef1`会`undefined`立即产生，而强制`undef2`会产生一个 thunk，当应用于某些参数时，会产生`undefined`.

我怀疑你误解了什么`seq`；我得到的印象是您认为`seq undef2 ()`应该适用`undef2`于`()`，但事实并非如此。所做的是`seq :: a -> b -> b`强制其第一个参数并返回第二个参数。`seq undef1 ()`和之间的区别`seq undef2 ()`很简单，只有第二个成功强制其第一个参数，然后它只是简单地返回`()`。

如果我对上面代码的意图是正确的，那么您正在寻找的是`($!) :: (a -> b) -> a -> b`，它将其第一个参数应用于第二个参数并强制结果。所以这两个都失败了`undefined`：

```
undef1 $! ()
undef2 $! () 
```

# java - jpcap 异常

> ID：16041179
> 
> 赞同：0
> 
> 时间：2013-04-16T15:35:09.140
> 
> 标签：java, jpcap

在运行我的代码时，我遇到了这个异常。我没有得到它是什么？

```
Exception in thread "AWT-EventQueue-0" java.lang.UnsatisfiedLinkError:  
    jpcap.JpcapCaptor.nativeOpenOffline(Ljava/lang/String;)Ljava/lang/String;
        at jpcap.JpcapCaptor.nativeOpenOffline(Native Method)
        at jpcap.JpcapCaptor.openFile(JpcapCaptor.java:90)
        at EWMAStableIP.getNumOfNewIPs(EWMAStableIP.java:106)
        at EWMAStableIP.initial(EWMAStableIP.java:343)
        at Frame.initialize(Frame.java:78)
        at Frame.<init>(Frame.java:52)
        at Frame$1.run(Frame.java:39)
        at java.awt.event.InvocationEvent.dispatch(Unknown Source)
        at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
        at java.awt.EventQueue.access$200(Unknown Source)
        at java.awt.EventQueue$3.run(Unknown Source)
        at java.awt.EventQueue$3.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:58:10.827

为了正常运行，jpcap 需要安装一个本机库 - 但是您的系统上缺少它。

请参阅 jpcap 随附的文档以正确安装它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-29T21:21:56.623

看来您的 jpcap 配置不正确。请查看[https://stackoverflow.com/questions/32591880/jpcap-jpcap-library-path](https://stackoverflow.com/questions/32591880/jpcap-jpcap-library-path)

还要查看 Java 中是否缺少本机 AWT 库。

# php - 如何在响应引发错误时停止提交按钮（php错误）

> ID：16041181
> 
> 赞同：0
> 
> 时间：2013-04-16T15:35:13.637
> 
> 标签：php, jquery, html, ajax

我的 AJAX 代码如下

```
$("#step_3 :submit").click(function(event) {
        event.preventDefault();

        var formData = $("#dbConfigID").serialize();

        $.ajax({

            url: "../pard_config/dbconfig.php",
            type: "POST",
            data: formData,
            beforeSend:function(){

            },

            success: function(responce) {
            $("#res").show().html(responce);

            }

        });

    }); 
```

PHP 代码（仅捕获）

```
 catch (Exception $e) {
        echo 'Warnning: ',  $e->getMessage(), "\n";
    } 
```

如果我的数据库凭据错误，它仍然会在 firebug 中显示 200 成功代码。并且我的提交按钮正在触发，而 php ajax 响应是如下错误

```
Warnning: SQLSTATE[HY000] [2005] Unknown MySQL server host 'localhosts' (1) 
```

如何在出现上述错误时停止按钮触发？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T15:38:59.360

Javascript 无法检测到服务器上发生的事情，因此它会关闭 HTTP 状态代码。如果您遇到服务器端故障，则需要向客户端返回某种故障消息。

我个人的偏好是不理会 HTTP 状态码，然后发回一个漂亮的小 json 结构：

```
if ($failure) {
   echo json_encode(array('status' => 'failed', 'code' => xxx, 'message' => 'Something blew up!'));
} 
```

然后有

```
...
success: function(data) {
   if (data.status == 'failed') {
     throw ServerSideError;
   }
   ...
}) 
```

在你的 JS 代码中。

有人会说您需要发送一个反映错误的 HTTP 状态代码，即

```
if ($failure) {
   header('HTTP/1.1 500 Database Error');
} 
```

Javascript 将拾取非 2xx 代码并触发`error`AJAX 处理程序中的代码路径。

# javascript - 谷歌地图中的组标记

> ID：16041185
> 
> 赞同：1
> 
> 时间：2013-04-16T15:35:19.520
> 
> 标签：javascript, google-maps, google-maps-api-3, google-api, google-maps-markers

我发现这个很棒的教程效果很好。 [http://lab.abhinayrathore.com/ipmapper/](http://lab.abhinayrathore.com/ipmapper/)

这是从 IP 地址返回 lat&lon 值的 javascript 代码：http: [//pastebin.com/1gE91nuh](http://pastebin.com/1gE91nuh)

所以在同一个地方有很多标记，我想制作这样的组：http: [//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.9/示例/simple_example.html](http://google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.9/examples/simple_example.html)

示例：http: [//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.9/docs/examples.html](http://google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.9/docs/examples.html)

但是有人可以帮助我如何在原始代码中进行分组？（原代码： http: [//pastebin.com/1gE91nuh](http://pastebin.com/1gE91nuh)）

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:58:01.547

这是创建标记集群的代码。创建标记时，它们被推入一个数组。该数组被传递到一个新的 MarkerCluster 对象中。

```
 function initialize() {
    var center = new google.maps.LatLng(37.4419, -122.1419);

    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 3,
      center: center,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    var markers = [];
    for (var i = 0; i < 100; i++) {
      var dataPhoto = data.photos[i];
      var latLng = new google.maps.LatLng(dataPhoto.latitude,
          dataPhoto.longitude);
      var marker = new google.maps.Marker({
        position: latLng
      });
      markers.push(marker);
    }
    var markerCluster = new MarkerClusterer(map, markers);
  }
  google.maps.event.addDomListener(window, 'load', initialize); 
```

# c - 使用函数填充C中的数组

> ID：16041191
> 
> 赞同：4
> 
> 时间：2013-04-16T15:35:43.300
> 
> 标签：c, arrays, function, pointers

好的，所以我这样调用函数 fill_arrays：

```
fill_arrays(&data1, &data2, &size1, &size2); 
```

fill_arrays 看起来像这样：

```
void fill_arrays(int **data1, int **data2, int *size1, int *size2){
   *size1 = get_size(*size1, 1);
   *size2 = get_size(*size2, 2);
   *data1 = malloc(*size1 * sizeof(int *));
   *data2 = malloc(*size2 * sizeof(int *));
   input_data(&data1, *size1, 1);
} 
```

在 input_data 函数中，我想为数组分配一些数字：

```
void input_data(int **data, int size, int index){
   *data[5] = 5;
} 
```

问题是，我完全迷失了指针......也许你可以告诉我应该如何调用函数 input_data 以便能够将一些数字分配给数据数组？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T15:39:19.677

假设`input_data`应该将所有数组值设置为已知值，您可以编写

```
void input_data(int *data, int size, int value){
    for (int i=0; i<size; i++) {
        data[i] = value;
    }
} 
```

像这样称呼

```
input_data(*data1, *size1, 5); // set all elements of data1 to 5 
```

这里的关键点是您可以`(*data1)[index]`用来访问特定的数组元素，并且可以将您的数组作为`int*`参数传递。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-08-28T20:22:10.130

我在做家庭作业时偶然发现了这个问题，答案并没有让我完全满意，所以我会努力改进它。

这是一个小程序，它将建立一个用户定义大小的数组，任意填充，然后打印出来。

```
#include <stdio.h>
#include <stdlib.h>

void fill_array(int *array, int n)
{
    int i;
    for (i = 0; i < n; i++)
    {
        // fill array like [1, 2, 3, 4...]
        array[i] = i+1;
    }
}

void print_array(int *array, int n)
{
    int i;
    printf("[");
    for (i = 0; i < n; i++)
    {
        if (i == (n-1))
            printf("%d]\n", array[i]);
        else
            printf("%d, ", array[i]);
    }
}

int main()
{
    int n;
    printf("Please enter a size for your array>");
    scanf("%d", &n);

    // dynamically allocate memory for integer array of size n
    array = (int*) malloc (n * (sizeof(int)));

    fill_array(array, n);
    print_array(array, n);

    return 0;
} 
```

我希望这可以帮助任何第一次学习 C 的人，或者像我这样在远离久经考验的真实语言多年后重新学习 C 的人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-12T14:30:32.587

看来您还应该添加`int *array = NULL`以使其正常工作。

# highcharts - 当使用 javascript 打印带有 highcharts 的页面时，@media print 中的 css 中的 this.print() 宽度值似乎被忽略了

> ID：16041194
> 
> 赞同：3
> 
> 时间：2013-04-16T15:35:56.860
> 
> 标签：highcharts

使用@media print highcharts 时似乎忽略了屏幕部分的宽度和高度，而是使用显示部分的值。

这阻止了我打印带有 highcharts 的整个网页，因为打印时图表的大小不合适。

请参阅[jsfiddle 示例](http://jsfiddle.net/mlawrence85704/6WxgG/10/embedded/result/)

```
@media screen
    {

      .cont
        {
            width: 50%;
            height: 100%;

        }
    }

 @media print
    {
        .no-Print{
            display: none;
        }

        .cont
        {
            width: 5%;
            height: 5%;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T12:37:10.583

它不会忽略样式。它只是为容器内的元素定义宽度（以像素为单位）。要看到这一点，您可以将设置容器的溢出添加到隐藏：

```
.cont {
    width: 5%;
    height: 5%;
    overflow: hidden;
    border: 1px solid red;
} 
```

（见：http: [//jsfiddle.net/6WxgG/15/embedded/result/](http://jsfiddle.net/6WxgG/15/embedded/result/)）

AFAIK 仅使用 CSS 无法合理调整图表的大小。

# javascript - jQuery插件中多次调用函数

> ID：16041196
> 
> 赞同：3
> 
> 时间：2013-04-16T15:35:58.627
> 
> 标签：javascript, jquery, jquery-plugins

原谅标题，不知道如何描述它，因为我不确定发生了什么：

**[http://jsfiddle.net/KpmyR/7/](http://jsfiddle.net/KpmyR/7/)**

如果您查看那个 JS fiddle，我正在尝试创建自己的轻推控件以了解插件的工作原理。我的插件由`$("#textbox1").DTJS()`

页面上有一个项目，我的插件似乎工作正常，当我将它的多个实例添加到页面时，代码似乎呈指数级触发。（我基本上在我的插件中等待 onClick 事件）。

就目前而言，我已经调用了我的`$("#textbox1").DTJS()`三次，如下所示：

```
$(document).ready(function () {
$("#textbox1").DTJS({
    'width': '75px',
    'max': '15',
    'min': '5'
});

$("#textbox2").DTJS({
    'width': '75px',
    'max': '15',
    'min': '5'
});

$("#textbox3").DTJS({
    'width': '75px',
    'max': '15',
    'min': '5'
});
}); 
```

如果我点击底部，它会增加/减少 1，如果我点击中间，它会增加 2，如果我点击顶部，它会增加 3。

有人可以概述为什么会这样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T15:38:48.840

您正在通过一个类应用您的事件，因此每次调用插件时，您都会将另一个事件绑定到`.valueUp`and的所有实例`.valueDown`。

在创建按钮并绑定存储副本中的事件时，请考虑保留一份副本。（如果您在同一范围内多次选择相同的元素，最好将其存储在内存中。）

例如，

```
var up = $('<button class="valueUp valueHoldDown btn-mini btn-primary' + settings.btnClass + '">-></button>');
this.after(up);
up.click(function(){ 
    // code 
}); 
```

另请注意，当 jQuery 从 调用函数时`jQuery.fn`，`this`指的是 jQuery 对象而不是原始元素，因此您不需要这样做`$(this)`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T15:40:38.193

只是改变这个：

```
$('.valueUp').click(...); 
```

对此：

```
$(this).siblings('.valueUp').click(...); 
```

对于`.valueDown`.

通过将事件绑定到 just `.valueUp`，您将其绑定到`.valueUp`页面上的任何内容，这解释了为什么事件在第一个上绑定 3 次，在第二个上绑定 2 次。

* * *

**其他几个提示：**

*   `this`已经是一个 jQuery 对象

    正如 Snuffleupagus 指出的，`this`它已经是一个 jQuery 对象，所以你不需要调用`$(this)`. 对于您添加到的任何函数都是如此`$.fn`。

*   返回`this`

    通过`this`在插件末尾返回，您可以保持可链接性。例如，如果您添加`return this`到插件的末尾，您可以执行以下操作：

    $("#textbox1").DTJS({'width':'75px', 'max':'15', 'min':'5'}).fadeIn();

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T15:46:32.433

我认为您遇到的问题与单击事件处理程序有关：

```
$(".valueUp").click( function() {...}) 
```

此行中使用的选择器选择所有具有 valueUp 类的元素。但是，当您向页面添加更多微调控件时，会为页面上的每个按钮运行事件处理程序 - 导致页面上的控件数量被微调。

有几个选项：

将选择器更改为基于唯一 id 的 id，或更改选择器以使其与输入控件本身相关。

这是 jsFiddle 中的一个工作示例：http: [//jsfiddle.net/Xfp8a/](http://jsfiddle.net/Xfp8a/)

# java - 配置 eclipse/java 以最大限度地提高性能

> ID：16041199
> 
> 赞同：0
> 
> 时间：2013-04-16T15:36:08.677
> 
> 标签：java, eclipse, out-of-memory, jvm-arguments

我有一台带有 64 位操作系统（Windows 7 Enterprise）和 8 GB RAM 的 Windows 电脑。我想在 eclipse 上运行一个繁重的 java 程序，我想将尽可能多的 PC 资源分配给 eclipse/JVM 以提高性能。

顺便说一句，在同一程序的两次不同运行中，一次耗时 33 分钟，另一次耗时 15 小时。这是一个非常大的差异，我不知道是什么配置更改（如果有的话）导致了这种性能恶化。

你能帮我正确配置吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T15:38:31.150

在 eclipse.ini 中（在 eclipse 的主文件夹中）有一堆参数可以帮助您配置内存量。在文件的末尾应该是这样的：

```
-vmargs
-Xms1024m 
-Xmx2048m (max heap)
-Xss1m    (stack) 
```

您可以根据需要添加任意数量的参数。他们都必须在线路之后

```
-vmargs 
```

[您可以在此处](http://javarevisited.blogspot.de/2011/11/hotspot-jvm-options-java-examples.html)找到更多 JVM 参数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:54:49.490

您也可以通过这种方式为 Java 分配内存：

*   在“**搜索控制面板**”框中键入 Java。
*   单击弹出的**Java图标。**
*   点击**查看**
*   如果您有 64 位操作系统，请确保获得 x64 版本。
*   更改**运行时参数**，以'-Xmx1024m'为例

根据你有多少内存来改变它，建议你使用 256/512/768/1024/1536/2048。对于 32 位操作系统，建议使用 768M。如果你是64位的，或者不行，继续试试下面的：1024m,1536m,2084m

希望有所帮助。

# c# - 按可以为空的子记录值排序

> ID：16041200
> 
> 赞同：1
> 
> 时间：2013-04-16T15:36:17.937
> 
> 标签：c#, linq, linq-to-sql

我尝试了一些组合，但我只是不明白如何执行以下操作：

假设我有表**Requests**和**RequestActivities**。我需要按**RequestActivity.TimeOfCreation**降序排序所有请求，但**RequestActivity**可能为空。

```
 List<DA.GeneralRequest> ongoingGeneralRequests = db.GeneralRequests
          .Where(t => t.GeneralRequestStatusID != 3 && (t.SupervisorID == currentUserId || t.CreatorID == currentUserId || t.AssignedUsers.Any(au => au.UserID == currentUserId)))
          .OrderByDescending(x => x.GeneralRequestActivities.OrderBy(ga => ga.GeneralRequestActivityDate).Last().GeneralRequestActivityDate) //gives exeption
          .ThenBy(a => a.Deadline).ToList(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T15:41:28.810

我对 LINQ-To-SQL 不是很熟悉，但在这种情况下不起作用`MAX`？

```
.OrderByDescending(x => x.GeneralRequestActivities
                         .Max(ga => ga.GeneralRequestActivityDate))
.ThenBy(a => a.Deadline)
.ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T15:43:38.400

您需要首先缓存排序值，如果它不为空，则按日期排序，否则按您想要的某个默认日期排序：

```
List<DA.GeneralRequest> ongoingGeneralRequests = db.GeneralRequests
      .Where(t => t.GeneralRequestStatusID != 3 && (t.SupervisorID == currentUserId || t.CreatorID == currentUserId || t.AssignedUsers.Any(au => au.UserID == currentUserId)))
      .Select(x => new {
                    Value = x, 
                    OrderByValue = x.GeneralRequestActivities
                             .OrderBy(ga => ga.GeneralRequestActivityDate)
                             .LastOrDefault()) // cache value
      .OrderByDescending(x => x.OrderByValue != null ? 
                                  OrderByValue.GeneralRequestActivityDate 
                                : some default value)
      .ThenBy(a => a.Value.Deadline)
      .Select(a => a.Value)
      .ToList(); 
```

请注意，您不能[`Last()`](http://msdn.microsoft.com/fr-fr/library/bb358775.aspx)对空的 IEnumerable 使用扩展方法。这就是你得到异常的原因：

> InvalidOperationException ：源序列为空。

在这一行：

```
x.GeneralRequestActivities.OrderBy(ga => ga.GeneralRequestActivityDate).Last() 
```

`x.GeneralRequestActivities`是空的，所以调用`Last()`它会导致异常。

相反，使用[`LastOrDefault()`](http://msdn.microsoft.com/fr-fr/library/bb301849.aspx)扩展方法，`null`如果 IEnumerable 为空则返回。

> 返回值 类型：如果源序列为空，则默认为 TSource (TSource)；否则，IEnumerable 中的最后一个元素。

# android - Android WebView - 清除缓存

> ID：16041205
> 
> 赞同：2
> 
> 时间：2013-04-16T15:36:24.143
> 
> 标签：android, webview, browser-cache

我有一个 WebView 控件，我想每次显示当前站点，但我认为 WebView 只显示站点的缓存版本。我尝试[了这里](https://stackoverflow.com/questions/14392414/android-webviews-clearcache-is-very-slow)找到的所有东西，但似乎没有任何效果。我还尝试从 context.getCacheDir() 中删除所有文件，但没有成功。我能做些什么？

这是我来自 onCreate 方法的代码：

```
 clearCache(this, 0);

    setContentView(R.layout.webview);

    deleteDatabase("webview.db");
    deleteDatabase("webviewCache.db");

    mWebView = (WebView)findViewById(R.id.webview);
    mWebView.setWebViewClient(new CenterWebViewClient(this));
    mWebView.setWebChromeClient(new CenterWebChromeClient(this));
    mWebView.getSettings().setJavaScriptEnabled(true);
    mWebView.getSettings().setAppCacheEnabled(false);
    mWebView.getSettings().setAppCacheMaxSize(1);
    mWebView.getSettings().setCacheMode(WebSettings.LOAD_NO_CACHE);

    String  url = "https://www.exacmple.com";

    if (url != null) {
        Map<String, String> noCacheHeaders = new HashMap<String, String>(2);
        noCacheHeaders.put("Pragma", "no-cache");
        noCacheHeaders.put("Cache-Control", "no-cache");
        mWebView.loadUrl(url, noCacheHeaders);
    } 
```

清除缓存功能：

```
static int clearCacheFolder(final File dir, final int numDays) {

    int deletedFiles = 0;
    if (dir!= null && dir.isDirectory()) {
        try {
            for (File child:dir.listFiles()) {

                //first delete subdirectories recursively
                if (child.isDirectory()) {
                    deletedFiles += clearCacheFolder(child, numDays);
                }

                //then delete the files and subdirectories in this dir
                //only empty directories can be deleted, so subdirs have been done first
                if (child.lastModified() < new Date().getTime() - numDays * DateUtils.DAY_IN_MILLIS) {
                    if (child.delete()) {
                        deletedFiles++;
                    }
                }
            }
        }
        catch(Exception e) {
            Log.e("WebView", String.format("Failed to clean the cache, error %s", e.getMessage()));
        }
    }
    return deletedFiles;
}

    public static void clearCache(final Context context, final int numDays) {
         Log.i("WebView", String.format("Starting cache prune, deleting files older than %d days", numDays));
         int numDeletedFiles = clearCacheFolder(context.getCacheDir(), numDays);
         Log.i("WebView", String.format("Cache pruning completed, %d files deleted", numDeletedFiles));
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T15:42:01.167

似乎您可以在显示 webview 时清除缓存

```
 @Override
public void onPageFinished(WebView view, String url) {
     super.onPageFinished(view, url);
     view.clearCache(true);
} 
```

通过 - [https://stackoverflow.com/a/10701961/2250339](https://stackoverflow.com/a/10701961/2250339)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T08:02:46.970

这不是缓存的问题，只有服务器端的会话，我不得不删除 cookie，现在它可以工作了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-22T05:48:59.230

要从您的 APP 中清除 cookie：

```
CookieSyncManager.createInstance(this);         
CookieManager cookieManager = CookieManager.getInstance();        
cookieManager.removeAllCookie(); 
```

# matlab - 在 MATLAB 中使用双积分 (dblquad) 查找重叠的正态分布。奇怪的行为

> ID：16041206
> 
> 赞同：2
> 
> 时间：2013-04-16T15:36:24.457
> 
> 标签：matlab, statistics, normal-distribution, integral

我正在使用以下函数计算两个正态双变量分布的重叠

```
function [ oa ] = bivariate_overlap_integral(mu_x1,mu_y1,mu_x2,mu_y2)
    %calculating pdf. Using x as vector because of MATLAB requirements for integration
    bpdf_vec1=@(x,y,mu_x,mu_y)(exp(-((x-mu_x).^2)./2.-((y-mu_y)^2)/2)./(2*pi));

    %calcualting overlap of two distributions at the point x,y
    overlap_point = @(x,y) min(bpdf_vec1(x,y,mu_x1,mu_y1),bpdf_vec1(x,y,mu_x2,mu_y2));

    %calculating overall overlap area
    oa=dblquad(overlap_point,-100,100,-100,100); 
```

您可以看到这涉及从函数 overlay_point 中取一个双积分（x：-100 到 100，y：-100 到 100，理想情况下是 -inf 到 inf 但现在就足够了），该函数的最小值为 2 pdf-s，由下式给出x,y 点的两个分布的函数 bpdf_vec1。

现在，PDF 永远不会为 0，所以我希望区间的面积越大，最终结果就会越大，显然在某个点之后差异可以忽略不计。但是，有时，当我减小间隔的大小时，结果似乎会增加。例如：

```
>> mu_x1=0;mu_y1=0;mu_x2=5;mu_y2=0;
>> bpdf_vec1=@(x,y,mu_x,mu_y)(exp(-((x-mu_x).^2)./2.-((y-mu_y)^2)/2)./(2*pi));
>>  overlap_point = @(x,y) min(bpdf_vec1(x,y,mu_x1,mu_y1),bpdf_vec1(x,y,mu_x2,mu_y2));
>> dblquad(overlap_point,-10,10,-10,10)
ans =
    0.0124
>> dblquad(overlap_point,-100,100,-100,100)
ans =
    1.4976e-005  -----> strange, as theoretically cannot be smaller then the first answer
>> dblquad(overlap_point,-3,3,-3,3)
ans =
    0.0110  -----> makes sense that the result is less than the first answer as the           
interval is decreased 
```

在这里，我们可以检查重叠在间隔的边界点处（接近）为 0。

```
>> overlap_point (100,100)
ans =
 0
>> overlap_point (-100,100)
ans =
 0
>> overlap_point (-100,-100)
ans =
 0
>> overlap_point (100,-100)
ans =
 0 
```

这可能与 dblquad 的实现有关，还是我在某处犯了错误？我使用 MATLAB R2011a。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T19:03:21.350

恭喜！您因成为第 12 百万个提出这个问题的人而获奖。:) 我想说的是，这是一个每个人一开始都会遇到的问题。老实说，这个问题被一遍又一遍地问到，所以真的，这个问题应该被标记为一个重复。

当从足够远的地方观察时，这些事情发生的情况是双变量法线本质上是一个 delta 函数。而且您不需要真正将该区域分散得太远，因为正常密度会迅速下降。在您尝试整合的大部分域上，它基本上为零，至少在所采用的容差范围内。

因此，如果求积恰好碰到有质量的区域附近的一些样本点，那么您可能会得到对积分的一些现实估计。但是，如果该工具看到的所有数字都是在整个域上基本上为零的数字，则它得出的结论是积分为零。请记住，自适应集成工具并非无所不知。他们对您的功能一无所知。对他们来说，这是一个黑匣子。这些不是象征性的工具。

顺便说一句，这不是我希望看到 Octave 与 MATLAB 始终不同的东西。这只是自适应积分器的一个问题，它选择在哪里设置它的样本点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T17:41:00.380

好的，这是我的八度音阶结果。

```
>fomat long
>z10 = dblquad(overlap_point,-10,10,-10,10)
z10 =  0.0124193303284589
>z100 = dblquad(overlap_point,-100,100,-100,100)
z100 =  0.0124193303245106
>z100 - z10
ans = -3.94835379669001e-012

>z10a = dblquad(overlap_point,-10,10,-10,10,1e-8)
z10a =  0.0124193306514996
>z100a = dblquad(overlap_point,-100,100,-100,100,1e-8)
z100a =  0.0124193306527155
>z100a-z10a
ans = 1.21588676627038e-012 
```

顺便提一句。我以前用数值解法就注意到了这种类型的问题。有时，您所做的更改会提高结果的准确性（在这种情况下，通过使您的限制更接近完整平面的理想情况），但您会得到相反的效果，结果会变得不那么准确。在这种情况下发生的情况是，通过“扩大”到 -100..100，您将焦点从函数中真正重要的动作发生的地方转移，这接近原点。在某些时候，您正在使用的 dblquad 的实现必须随着您增加限制而开始增加样本间距离，然后它开始丢失靠近原点的一些重要内容。

也许运行更高版本的matlab的人可以检查一下，看看它是否得到了改进。

# c# - ASP .NET C# 从军用时间更改为标准时间

> ID：16041208
> 
> 赞同：2
> 
> 时间：2013-04-16T15:36:33.670
> 
> 标签：c#, asp.net

我有这个：

```
StringBuilder sb = new StringBuilder(time.Text);
if (DateTime.Parse(time.Text) > DateTime.Parse("12:00:00 AM")
    && DateTime.Parse(time.Text) < DateTime.Parse("11:59:59 AM"))                                    
{
    time.Text = time.Text + " AM";
}
else
{
    time.Text = time.Text + " PM";
} 
```

我现在是下午 16:34，

我希望它显示 04:34 PM

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-16T15:39:04.220

简单地

```
string strTime = DateTime.Now.ToString(@"hh\:mm\:ss tt"); 
```

在您的情况下，它将是：

```
 time.Text=DateTime.Parse(time.Text).ToString(@"hh\:mm\:ss tt"); 
```

并确保自定义格式，比如`HH`24 小时格式，`MM`是一个月的

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T15:40:23.893

尝试

```
time.Text = DateTime.Parse(time.Text).ToString("hh:mm:ss tt"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-27T10:47:07.070

```
 public static string FormattedTime(this TimeSpan TimeIn24Hours)
    {
        String TimeIn12Hours = string.Empty;
        if (TimeIn24Hours != null)
        {
            TimeIn12Hours = DateTime.MinValue.AddHours(TimeIn24Hours.Hours).AddMinutes(TimeIn24Hours.Minutes).ToString("hh:mm");
        }
        return TimeIn12Hours;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-16T00:57:21.137

```
private void UpdateTime()
{
    int hours, mins, sec;
    string TimeofDate = "AM";
    currentTime = DateTime.Now;
    hours = Convert.ToInt32(currentTime.Hour.ToString());
    mins = Convert.ToInt32(currentTime.Minute.ToString());
    sec = Convert.ToInt32(currentTime.Second.ToString());

    // lbCurrentTime.Text = currentTime.ToLongTimeString();
    // label2.Text = hours.ToString() + ":" + mins.ToString() + ":" + sec.ToString();

    if (hours >= 12)
    {
        hours = hours - 12;
        TimeofDate = "PM";
    }
    else TimeofDate = "AM";

    lbCurrentTime.Text = hours.ToString() + ":" + mins.ToString() + ":" + sec.ToString()+" "+TimeofDate;
} 
```

# cakephp - 在 mediatemple/plesk 中生产安装 cake 2.0

> ID：16041211
> 
> 赞同：1
> 
> 时间：2013-04-16T15:36:36.293
> 
> 标签：cakephp, installation, cakephp-2.0, plesk, mediatemple

我目前正在尝试在共享 IP 上托管在 mediatemple/plesk 上的新站点上安装蛋糕。我已将解压缩的蛋糕包添加到 httpdocs 文件夹 (../httpdocs/cake/)，这是该站点的服务器默认设置，如 cake 文档中所述。但是它并没有将我带到蛋糕安装页面，因此按照蛋糕文档中的说明，我重置了该站点的 DocumentRoot。我在网上为 plesk 找到的文档根目录的解决方案是在我想要重定向的站点的 conf 文件夹中的 vhost.conf 和 vhost_ssl.conf 中设置文档根目录。这些文件中的每一个现在都有以下代码行（仅文档中的代码）：

DocumentRoot /var/www/vhosts/(mydomain.com)/httpdocs/cake/app/webroot/

由于它仍然没有加载到蛋糕主页/安装页面（而是我得到了 apache 测试页面......）我继续在网上和这些论坛中搜索，但只是不断重复创建 vhost.conf 和vhost_ssl.conf 文件，就像我在上面所做的一样（同一行代码和所有内容）

通过文件路径手动将我的浏览器引导到 cake/app/webroot/ 和 cake/app/webroot/index.php 只返回一个空白页面。

有没有其他方法可以让它正确指向安装页面，以便我可以开始构建？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:43:00.460

DocumentRoot /var/www/vhosts/(mydomain.com)/httpdocs/cake/app/webroot/

我会说这行不通。

如果我是正确的，您需要访问的 index.php 位于“/var/www/vhosts/(mydomain.com)/httpdocs/cake/”中。

您应该*删除 DocumentRoot*，然后浏览到：**mydomain.com/cake/index.php** 在那里您应该会看到蛋糕页面

（在您尝试将 DocumentRoot 设置在其他地方之前，这应该可以正常工作）

# hadoop - java.io.IOException：0 秒的租约超时已过期

> ID：16041212
> 
> 赞同：7
> 
> 时间：2013-04-16T15:36:37.820
> 
> 标签：hadoop

在 cd4 下运行我的 mapreduce 作业时收到以下警告。

> java.io.IOException：0 秒的租约超时已过期。在 org.apache.hadoop.hdfs.DFSOutputStream.abort(DFSOutputStream.java:1700) 在 org.apache.hadoop.hdfs.DFSClient.closeAllFilesBeingWritten(DFSClient.java:652) 在 org.apache.hadoop.hdfs.DFSClient.renewLease (DFSClient.java:604) 在 org.apache.hadoop.hdfs.LeaseRenewer.renew(LeaseRenewer.java:411) 在 org.apache.hadoop.hdfs.LeaseRenewer.run(LeaseRenewer.java:436) 在 org.apache。 hadoop.hdfs.LeaseRenewer.access$700(LeaseRenewer.java:70) at org.apache.hadoop.hdfs.LeaseRenewer$1.run(LeaseRenewer.java:297) at java.lang.Thread.run(Thread.java:662)

知道这意味着什么吗？

# javascript - 更好地控制 highcharts 图例样式

> ID：16041218
> 
> 赞同：0
> 
> 时间：2013-04-16T15:36:56.530
> 
> 标签：javascript, html, css, highcharts, highstock

借助 highcharts 工具提示，我可以使用自定义 html 标签，并且几乎可以完全控制工具提示的外观。

有谁知道是否可以对传说做同样的事情？目前我使用以下工具提示

```
headerFormat: '<div class="chart-tooltip"><span class="tooltip-header">{point.key}</span><br><div class="markers"><span class="tooltip-bg"></span>',
pointFormat: '<span class="tooltip-marker" style="background: {series.color};"></span>' +
                '<span class="tooltip-series" style="color: {series.color};">{point.y}</span><br>',
footerFormat: '</div></div>', 
```

我希望能够对传奇做同样的事情，我唯一能对传奇做的就是

```
labelFormatter: function () {
  return '<div class="legend-label">' + this.name + '</div>';
                        } 
```

任何帮助都会很棒，谢谢

编辑：或者甚至可能有两个工具提示？一个作为图例的静态只显示系列名称，另一个作为常规工具提示，并一起删除图例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T09:38:46.107

在图例中，您只能使用legendFormatter，类似于工具提示，它也有格式化程序（[http://api.highcharts.com/highcharts#tooltip](http://api.highcharts.com/highcharts#tooltip)）

# c# - 使用 streamReader.ReadBlock（缓冲区）导入文件

> ID：16041220
> 
> 赞同：2
> 
> 时间：2013-04-16T15:37:05.170
> 
> 标签：c#, buffer, streamreader, readblock

需要导入大量的文本文件并查找一些研究资料，特别是针对我的问题，我决定在这里发布解决方案。我相信它会帮助别人。

我的文件是 3,000,000 的注册表。*尝试使用StreamReader.ReadLine()*逐行读取，但这是不切实际的。此外，文件太大而无法将它们加载到内存中。

*解决方案是使用streamReader.ReadBlock()*以块（缓冲区）的形式将文件加载到内存中。

我遇到的困难是*ReadBlock()*逐字节读取，连续发生或获得另一半。然后下一个缓冲区的第一行是不完整的。为了更正，我加载了一个*字符串*（*resto* ）并与下一个缓冲区的第一行（*primeiraLinha ）连接。*

*使用Split*的另一个重要细节，在大多数示例中，变量的第一次验证遵循*Trim()*以消除空格。在这种情况下，我不使用，因为它加入了第一行和第二行缓冲区。

```
using System;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ConsoleApplication2
{
    class Program
    {
        static void Main()
        {
            const string arquivo = "Arquivo1.txt";
            using (var streamReader = new StreamReader(arquivo))
            {
                int deslocamento = 1000;
                int pStart = 0; // buffer starting position
                int pEnd = deslocamento; // buffer end position
                string resto = ""; 
                for (int i = pStart; i < int.MaxValue; i += pStart)
                {
                    string primeiraLinha;
                    char[] buffer = new char[pEnd-pStart];
                    streamReader.ReadBlock(buffer, 0, buffer.Length);
                    var bufferString = new String(buffer);
                    string[] bufferSplit = null;
                    bufferSplit = bufferString.Split(new char[] { '\n' });
                    foreach (var bs in bufferSplit )
                    {
                        if (bs != "")
                        {
                            if (resto != "")
                            {
                                primeiraLinha = resto + bs;
                                Console.WriteLine(primeiraLinha);
                                resto = "";
                            }
                            else
                            {
                                if (bs.Contains('\r'))
                                {
                                    Console.WriteLine(bs);
                                }
                                else
                                {
                                    resto = bs;
                                }
                            }
                        }
                    }
                    Console.ReadLine();
                    // Moves pointers
                    pStart = pEnd;
                    pEnd += deslocamento;
                    if (bufferString == null)
                        break;
                }
            }
        }
    }
} 
```

我的朋友培训加布里埃尔·古斯塔夫（Gabriel Gustaf）帮助我解决了这个问题。

如果有人对进一步改进性能有任何建议或提出任何意见，请随时提出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:56:54.653

C# 有一个设计类来处理大文件：[MemoryMappedFile](http://msdn.microsoft.com/en-us/library/system.io.memorymappedfiles.memorymappedfile.aspx)。这很简单，我想可以帮助你。

# c# - 如何在列中显示带有标点的内容

> ID：16041222
> 
> 赞同：0
> 
> 时间：2013-04-16T15:37:08.850
> 
> 标签：c#, .net, wpf, xaml, data-binding

我有一个 DataGrid，它在列有标点符号时拒绝显示数据。我有以下 SQL 语句，它将结果数据放在 DataTable 中：

```
string statement = "SELECT TOP 200 [Test] AS [Primary key for Department records.] FROM [dbo].[Children]";

using (SqlDataAdapter adapter = new SqlDataAdapter(statement, connection))
                        {
                            adapter.Fill(dtResults);
                        } 
```

由于`.`别名中的字符，DataGrid 不显示包含在 DataTable 中的信息。我通过反复试验发现了这一点。我怎样才能让数据网格用这样的列显示数据？

这是绑定代码：

```
dgResults.DataContext = myDataTable.AsDataView();
dgResults.AutoGeneratingColumn += new EventHandler<DataGridAutoGeneratingColumnEventArgs>(dataGrid_AutoGeneratingColumn);
dgResults.Visibility = Visibility.Visible;

private void dataGrid_AutoGeneratingColumn(object sender, DataGridAutoGeneratingColumnEventArgs e)
{
   //Sets the DataGrid's headers to be TextBlocks, which solves a problem whereby underscore characters in the header are ignored.
   TextBlock block = new TextBlock();
   block.Text = e.Column.Header.ToString();
   e.Column.Header = block;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:50:37.007

我不确定这是否有效，但请尝试：

```
DataSet dset = new DataSet();
using (SqlDataAdapter adapter = new SqlDataAdapter(statement, connection))
{
      adapter.Fill(dset);
}
DataTable dtResults = dset.Tables[0]; 
```

我希望这能解决问题。

更新：尝试摆脱标点符号。

```
 //this is just a list of punctuations. Database field never might not contains some of them. 
       string[] punct = new string[]{"[", "]" ,"(", ")", "{", "}", "<", ">", ":",
            ",", "-", "...", "!", "«", "»", "-", ".", "?", "\"", "'",  "'", ";", "/"};

        foreach (DataColumn column in table.Columns)
        {
            string colName = column.ColumnName;
            bool b = punct.Any(s => colName.Contains(s));
            var listOfPunct = punct.Where(s => colName.Contains(s)).ToList();
            foreach (string p in listOfPunct)
            {
                colName = colName.Replace(p, "");
            }
            column.ColumnName = colName;
        } 
```

# sql - 休眠条件：使用另一个表从一个表中选择对象

> ID：16041225
> 
> 赞同：0
> 
> 时间：2013-04-16T15:37:11.667
> 
> 标签：sql, hibernate, criteria, hibernate-criteria

首先很抱歉，如果我的问题表述得不是很好。

我有一个映射到相应表的简单对象：

```
@Entity
@Table(name = "USERS")
public class User{

    @Id
    @Column(name = "USER_ID")
    @GeneratedValue
    private long userId;

    @Column(name = "NAME")
    private String name;
        //getters and setters... 
```

在我的数据库中，我还有另一个表。此表没有任何关联的对象，但它具有列“USER_ID” - 与“USERS”表中的 ID 相同。

所以问题是，如何使用 Hibernate 标准从第一个表中选择与第二个表具有相同 USER_ID 的所有用户。例如，我有两个用户，用户 ID =1 和 =2。在“USER_ID”列的第二个表中，我只有值“2”。所以我只需要第一个表中 userId = 2 的用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:04:41.213

您的查询是 FOREIGN_KEY 关系的经典示例，但正如您所说，您没有另一个表的休眠映射模型。最好在您的用户映射文件中使用 sql-query 在用户对象中收集此查询结果。

像这样 <sql-query name="userwith"> <return alias="user" class="User"/> SELECT user.Name AS {user.name} FROM USERS JOIN ANOTHER_TABLE another_table ON user.ID = another_table.USER_ID </sql-查询>

# html - CSS溢出：用浮动隐藏

> ID：16041229
> 
> 赞同：26
> 
> 时间：2013-04-16T15:37:22.307
> 
> 标签：html, css, overflow

[我在 w3schools 上](https://www.w3schools.com/css/tryit.asp?filename=trycss_navbar_horizontal_float)阅读了以下代码，但不明白该`overflow`属性将如何影响文本是否出现在右侧`ul`。

```
ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
  overflow: hidden;
}

li {
  float: left;
}

a {
  display: block;
  width: 60px;
  background-color: #dddddd;
  padding: 8px;
}
```

```
<ul>
  <li><a href="#home">Home</a></li>
  <li><a href="#news">News</a></li>
  <li><a href="#contact">Contact</a></li>
  <li><a href="#about">About</a></li>
</ul>
<p><b>Note:</b> overflow:hidden is added to the ul element to prevent li elements from going outside of the list.</p>
```

我知道它`overflow:hidden`用于处理框外的内容，但不明白它在这种情况下如何应用。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-04-17T09:33:50.860

我试图结束混乱：

`ul`和元素一样是块级元素`p`（它们拉伸到父宽度的 100%）。这就是为什么默认情况下，如果没有在这些元素上声明宽度或显示，`p`则会出现在下方。`ul`

现在在您的示例中，`ul`仅包含浮动元素。这使得它折叠到一个高度`0px`（它仍然具有 100% 的宽度，但正如您在示例中看到的那样）。相邻元素`p`将出现在浮动元素的右侧，`li`因为它们被视为正常的浮动元素。

现在声明`overflow`（除 之外的任何值`visible`）建立一个新的[块格式化上下文](https://developer.mozilla.org/en-US/docs/CSS/Block_formatting_context)，这使得`ul`包含它的孩子。突然`ul`“重新出现”，不再有大小`0px`。`p`正在被推到底部。您还可以声明`position:absolute`以实现相同的“清除”效果（副作用是现在s 已从`ul`正常元素流中取出 - `p`s 将与 . 重叠`ul`。）

**[请参阅示例小提琴](http://jsfiddle.net/Mvv8w/4/)**

如果您喜欢技术方面的内容，请比较 CSS 规范的相应段落：

[§10.6.3 当“溢出”计算为“可见”时，正常流中的块级非替换元素](http://www.w3.org/TR/CSS21/visudet.html#normal-block)
和
[§10.6.7 块格式化上下文根的“自动”高度](http://www.w3.org/TR/CSS21/visudet.html#root-height)。（感谢 BoltClock 挖掘链接）。

```
ul{
    list-style-type:none;
    margin:0; padding:0;
    background-color:#dddddd;
    border:2px solid red;
}
li{
    float:left;
}
a{
    display:block;
    width:60px;
    background-color:#555;
    color:white;
}
p{
    margin:0;
    outline:2px dotted blue;
}
#two{
    clear:both;
    overflow:hidden;
}
```

```
No overflow:
<ul>
<li><a href="#home">Home</a></li>
<li><a href="#news">News</a></li>
<li><a href="#contact">Contact</a></li>
<li><a href="#about">About</a></li>
</ul>
<p>Notice the collapsed ul - no background-color visible, collapsed border and this paragraph treats the lis as regular floats  </p>
<br>
With overflow: hidden
<ul id="two">
<li><a href="#home">Home</a></li>
<li><a href="#news">News</a></li>
<li><a href="#contact">Contact</a></li>
<li><a href="#about">About</a></li>
</ul>
<p>the ul reappeared - it now contains the child li's - the float is cleared</p>
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-16T15:44:52.100

对元素进行设置`overflow: hidden`会导致创建新的浮动上下文，因此浮动在已应用元素内的元素`overflow: hidden`将被清除。

[http://www.w3.org/TR/CSS2/visuren.html#block-formatting](http://www.w3.org/TR/CSS2/visuren.html#block-formatting)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-18T14:31:12.533

引用[HTML 和 CSS 很难](https://internetingishard.com/html-and-css/floats/)

> 总而言之，当您在容器 div 的底部有一个额外的未浮动 HTML 元素时，请使用 clear 解决方案。否则，向容器元素添加一个溢出：隐藏声明。这两个选项的基本思想是您需要一种方法来告诉浏览器将浮动合并到其容器元素的高度中

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-16T15:50:51.723

这就是为什么 w3schools 不是网页设计师/开发人员的可靠来源。你是对的，这是一个可怕的例子。

这不是因为，在这个例子中，父元素没有固定的 with。此外，它是一个无序列表标签，无论如何它都会延伸到它的孩子的大小。

[http://jsfiddle.net/EhphH/](http://jsfiddle.net/EhphH/)

**CSS**

```
.parent {
    width: 150px;
    height: 100px;
    padding: 10px;
    background: yellow;
    overflow: hidden;

}
.child {
    float: left;
    width: 75px;
    height: 120px;
    margin: 10px;
    background: blue;

}
.baby {
    width: 200px;
    height: 25px;
    background: green;
} 
```

**标记**

```
<div class="parent">
    <div class="child">
        <div class="baby">
        </div>
    </div>
    <div class="child">
    </div>
</div> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-16T15:44:37.520

而不是`overflow:hidden;`使用`clear:both;`. `<p>`这里正在使用[http://jsfiddle.net/Mvv8w/](http://jsfiddle.net/Mvv8w/)。基本上`overflow:hidden`会清除它旁边的任何东西`clear:both;`。

# django - Django 删除 FileField

> ID：16041232
> 
> 赞同：123
> 
> 时间：2013-04-16T15:37:26.297
> 
> 标签：django, django-models

我正在 Django 中构建一个网络应用程序。我有一个上传文件的模型，但我无法删除该文件。这是我的代码：

```
class Song(models.Model):
    name = models.CharField(blank=True, max_length=100)
    author = models.ForeignKey(User, to_field='id', related_name="id_user2")
    song = models.FileField(upload_to='/songs/')
    image = models.ImageField(upload_to='/pictures/', blank=True)
    date_upload = models.DateField(auto_now_add=True)

    def delete(self, *args, **kwargs):
        # You have to prepare what you need before delete the model
        storage, path = self.song.storage, self.song.path
        # Delete the model before the file
        super(Song, self).delete(*args, **kwargs)
        # Delete the file after the model
        storage.delete(path) 
```

然后，在`python manage.py shell`我这样做：

```
song = Song.objects.get(pk=1)
song.delete() 
```

它从数据库中删除记录，但不删除服务器上的文件。我还能尝试什么？

谢谢！

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2013-04-16T15:50:57.243

在 Django 1.3 之前，当您删除相应的模型实例时，该文件会自动从文件系统中删除。您可能使用的是较新的 Django 版本，因此您必须自己实现从文件系统中删除文件。

### 简单的基于信号的样本

在撰写本文时，我选择的方法是混合`post_delete`和`pre_save`信号，这使得每当删除相应的模型或更改其文件时，都会删除过时的文件。

基于假设`MediaFile`模型：

```
import os
import uuid

from django.db import models
from django.dispatch import receiver
from django.utils.translation import ugettext_lazy as _

class MediaFile(models.Model):
    file = models.FileField(_("file"),
        upload_to=lambda instance, filename: str(uuid.uuid4()))

# These two auto-delete files from filesystem when they are unneeded:

@receiver(models.signals.post_delete, sender=MediaFile)
def auto_delete_file_on_delete(sender, instance, **kwargs):
    """
    Deletes file from filesystem
    when corresponding `MediaFile` object is deleted.
    """
    if instance.file:
        if os.path.isfile(instance.file.path):
            os.remove(instance.file.path)

@receiver(models.signals.pre_save, sender=MediaFile)
def auto_delete_file_on_change(sender, instance, **kwargs):
    """
    Deletes old file from filesystem
    when corresponding `MediaFile` object is updated
    with new file.
    """
    if not instance.pk:
        return False

    try:
        old_file = MediaFile.objects.get(pk=instance.pk).file
    except MediaFile.DoesNotExist:
        return False

    new_file = instance.file
    if not old_file == new_file:
        if os.path.isfile(old_file.path):
            os.remove(old_file.path) 
```

*   我认为我之前构建的其中一个应用程序在生产中使用了此代码，但使用风险自负。
*   例如，有一种**可能的数据丢失**`save()`情况：如果您的方法调用恰好在回滚的事务中，您的数据可能最终会引用一个不存在的文件。您可以考虑按照 Mikhail 的评论中的建议将文件删除逻辑`transaction.on_commit()`包装[到](https://stackoverflow.com/questions/16041232/django-delete-filefield/16041527?noredirect=1#comment123201393_16041527)`transaction.on_commit(lambda: os.remove(old_file.path))`中。图书馆[在这些方面做了一些事情](https://github.com/un1t/django-cleanup/blob/master/django_cleanup/handlers.py#L91)。`django-cleanup`
*   边缘情况：如果您的应用程序上传新文件并将模型实例指向新文件而不调用`save()`（例如通过批量更新 a `QuerySet`），则旧文件将继续存在，因为不会运行信号。如果您使用传统的文件处理方法，则不会发生这种情况。
*   编码风格：本例使用`file`作为字段名，这不是一个好的风格，因为它与内置的`file`对象标识符冲突。

### 附录：定期清理

*实际上，您可能还*希望运行定期任务来处理孤立文件清理，以防运行时故障阻止某些文件被删除。考虑到这一点，您可能可以完全摆脱信号处理程序，并让这样的任务成为处理不敏感数据和不太大文件*的机制。*

但是，无论哪种方式，如果您*正在*处理敏感数据，最好进行双重或三重检查，确保您永远不会及时删除生产中的数据，以避免任何相关的责任。

### 也可以看看

*   [`FieldFile.delete()`](https://docs.djangoproject.com/en/1.11/ref/models/fields/#django.db.models.fields.files.FieldFile.delete)在 Django 1.11 模型字段参考中（请注意，它描述了`FieldFile`类，但您会`.delete()`直接在字段上调用：`FileField`实例代理到相应的`FieldFile`实例，并且您可以像访问字段一样访问它的方法）

    > 请注意，删除模型时，不会删除相关文件。如果您需要清理孤立文件，您需要自己处理（例如，使用可以手动运行的自定义管理命令或计划通过例如 cron 定期运行）。

*   为什么 Django 不自动删除文件：[Django 1.3 发行说明中的​​条目](https://docs.djangoproject.com/en/stable/releases/1.3/#deleting-a-model-doesn-t-delete-associated-files)

    > 在早期的 Django 版本中，当一个包含 a 的模型实例`FileField`被删除时，`FileField`它自己也会从后端存储中删除该文件。这为几种数据丢失场景打开了大门，包括回滚事务和引用同一文件的不同模型上的字段。在 Django 1.3 中，删除模型时不会调用`FileField`'方法。`delete()`如果您需要清理孤立文件，您需要自己处理（例如，使用可以手动运行或计划通过例如 cron 定期运行的自定义管理命令）。

*   [仅使用`pre_delete`信号的示例](https://stackoverflow.com/questions/5372934/how-do-i-get-django-admin-to-delete-files-when-i-remove-an-object-from-the-datab/14310174#14310174)

* * *

## 回答 #2

> 赞同：97
> 
> 时间：2015-03-11T12:14:47.367

尝试[django-cleanup](https://github.com/un1t/django-cleanup)，当您删除模型时，它会自动调用 FileField 上的 delete 方法。

```
pip install django-cleanup 
```

设置.py

```
INSTALLED_APPS = (
     ...
    'django_cleanup.apps.CleanupConfig',
) 
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2017-02-03T08:37:48.657

您可以使用 Django >= 1.10 的文件字段调用方法从文件系统中删除文件，`.delete`如下所示：

```
obj = Song.objects.get(pk=1)
obj.song.delete() 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2019-10-24T13:18:48.930

# Django 2.x 解决方案：

在**Django 2**中处理文件删除非常容易。我尝试过使用 Django 2 和 SFTP Storage 以及 FTP STORAGE 的以下解决方案，我很确定它可以与任何其他实现`delete`方法的存储管理器一起使用。（`delete`方法是`storage`抽象方法之一，应该从物理上从存储中删除文件！）

`delete`以实例在删除自身之前删除其 FileFields 的方式覆盖模型的方法：

```
class Song(models.Model):
    name = models.CharField(blank=True, max_length=100)
    author = models.ForeignKey(User, to_field='id', related_name="id_user2")
    song = models.FileField(upload_to='/songs/')
    image = models.ImageField(upload_to='/pictures/', blank=True)
    date_upload = models.DateField(auto_now_add=True)

    def delete(self, using=None, keep_parents=False):
        self.song.storage.delete(self.song.name)
        self.image.storage.delete(self.image.name)
        super().delete() 
```

它对我来说很容易。如果要在删除之前检查文件是否存在，可以使用`storage.exists`. 例如，如果歌曲存在，`self.song.storage.exists(self.song.name)`将返回一个表示。`boolean`所以它看起来像这样：

```
def delete(self, using=None, keep_parents=False):
    # assuming that you use same storage for all files in this model:
    storage = self.song.storage

    if storage.exists(self.song.name):
        storage.delete(self.song.name)

    if storage.exists(self.image.name):
        storage.delete(self.image.name)

    super().delete() 
```

### 编辑（另外）：

正如[@HeyMan](https://stackoverflow.com/users/2606766/heyman)提到的，使用此解决方案调用`Song.objects.all().delete()`不会删除文件！发生这种情况是因为正在运行[Default Manager](https://docs.djangoproject.com/en/2.2/topics/db/managers/#default-managers)`Song.objects.all().delete()`的删除查询。因此，如果您希望能够使用方法删除模型的文件，则必须编写并使用[自定义管理器](https://docs.djangoproject.com/en/2.2/topics/db/managers/#custom-managers)（仅用于覆盖其删除查询）：`objects`

```
class CustomManager(models.Manager):
    def delete(self):
        for obj in self.get_queryset():
            obj.delete() 
```

并且为了将 分配`CustomManager`给模型，您必须`objects`在模型中初始化：

```
class Song(models.Model):
    name = models.CharField(blank=True, max_length=100)
    author = models.ForeignKey(User, to_field='id', related_name="id_user2")
    song = models.FileField(upload_to='/songs/')
    image = models.ImageField(upload_to='/pictures/', blank=True)
    date_upload = models.DateField(auto_now_add=True)

    objects = CustomManager() # just add this line of code inside of your model

    def delete(self, using=None, keep_parents=False):
        self.song.storage.delete(self.song.name)
        self.image.storage.delete(self.image.name)
        super().delete() 
```

现在您可以在任何子查询`.delete()`的末尾使用。`objects`我写了最简单的`CustomManager`，但你可以通过返回一些关于你删除的对象或任何你想要的东西来做得更好。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2015-02-09T13:45:22.157

您也可以简单地覆盖模型的删除函数以检查文件是否存在并在调用超级函数之前将其删除。

```
import os

class Excel(models.Model):
    upload_file = models.FileField(upload_to='/excels/', blank =True)   
    uploaded_on = models.DateTimeField(editable=False)

    def delete(self,*args,**kwargs):
        if os.path.isfile(self.upload_file.path):
            os.remove(self.upload_file.path)

        super(Excel, self).delete(*args,**kwargs) 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-12-24T04:46:52.740

这是一个应用程序，可以在删除模型或上传新文件时删除旧文件：[django-smartfields](https://github.com/lehins/django-smartfields)

```
from django.db import models
from smartfields import fields

class Song(models.Model):
    song = fields.FileField(upload_to='/songs/')
    image = fields.ImageField(upload_to='/pictures/', blank=True) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-10-09T21:05:51.953

@Anton Strogonoff

I missing something in the code when a file change, if you create a new file generate an error, becuase is a new file a did not find a path. I modified the code of function and added a try/except sentence and it works well.

```
@receiver(models.signals.pre_save, sender=MediaFile)
def auto_delete_file_on_change(sender, instance, **kwargs):
    """Deletes file from filesystem
    when corresponding `MediaFile` object is changed.
    """
    if not instance.pk:
        return False

    try:
        old_file = MediaFile.objects.get(pk=instance.pk).file
    except MediaFile.DoesNotExist:
        return False

    new_file = instance.file
    if not old_file == new_file:
        try:
            if os.path.isfile(old_file.path):
                os.remove(old_file.path)
        except Exception:
            return False 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2021-02-22T07:44:43.477

对于那些在较新版本的 Django（当前为 3.1）中寻找答案的人。

我找到了这个[网站](https://cmljnelson.blog/2020/06/22/delete-files-when-deleting-models-in-django/)，它对我有用，没有任何改变，只需将它添加到您的`models.py`：

```
from django.db.models.signals import post_delete
from django.dispatch import receiver
from django.db import models

""" Only delete the file if no other instances of that model are using it"""    
def delete_file_if_unused(model,instance,field,instance_file_field):
    dynamic_field = {}
    dynamic_field[field.name] = instance_file_field.name
    other_refs_exist = model.objects.filter(**dynamic_field).exclude(pk=instance.pk).exists()
    if not other_refs_exist:
        instance_file_field.delete(False)
""" Whenever ANY model is deleted, if it has a file field on it, delete the associated file too"""
@receiver(post_delete)
def delete_files_when_row_deleted_from_db(sender, instance, **kwargs):
    for field in sender._meta.concrete_fields:
        if isinstance(field,models.FileField):
            instance_file_field = getattr(instance,field.name)
            delete_file_if_unused(sender,instance,field,instance_file_field)

""" Delete the file if something else get uploaded in its place"""
@receiver(pre_save)
def delete_files_when_file_changed(sender,instance, **kwargs):
    # Don't run on initial save
    if not instance.pk:
        return
    for field in sender._meta.concrete_fields:
        if isinstance(field,models.FileField):
            #its got a file field. Let's see if it changed
            try:
                instance_in_db = sender.objects.get(pk=instance.pk)
            except sender.DoesNotExist:
                # We are probably in a transaction and the PK is just temporary
                # Don't worry about deleting attachments if they aren't actually saved yet.
                return
            instance_in_db_file_field = getattr(instance_in_db,field.name)
            instance_file_field = getattr(instance,field.name)
            if instance_in_db_file_field.name != instance_file_field.name:
                delete_file_if_unused(sender,instance,field,instance_in_db_file_field) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-05-04T19:21:55.270

每次我上传新图像（徽标字段）时都会运行此代码，并检查徽标是否已经存在，如果存在，请将其关闭并将其从磁盘中删除。当然，在接收器功能中也可以进行相同的过程。希望这可以帮助。

```
 #  Returns the file path with a folder named by the company under /media/uploads
    def logo_file_path(instance, filename):
        company_instance = Company.objects.get(pk=instance.pk)
        if company_instance.logo:
            logo = company_instance.logo
            if logo.file:
                if os.path.isfile(logo.path):
                    logo.file.close()
                    os.remove(logo.path)

        return 'uploads/{0}/{1}'.format(instance.name.lower(), filename)

    class Company(models.Model):
        name = models.CharField(_("Company"), null=False, blank=False, unique=True, max_length=100) 
        logo = models.ImageField(upload_to=logo_file_path, default='') 
```

# visual-studio-2012 - .net framework 4.5下无法导入system.web.ui.design

> ID：16041237
> 
> 赞同：2
> 
> 时间：2013-04-16T15:37:43.850
> 
> 标签：visual-studio-2012

我正在将一个 VB.net 类从一个使用 .net 2.0 的项目移动到一个使用 .net 4.5 的项目中`Imports System.Web.UI.Design`，但是在 4.5 项目中，这个语句在它下面显示了一条绿色波浪线，鼠标悬停文本说：“在 Imports 'System.Web.UI.Design' 中指定的命名空间或类型不包含任何公共成员或找不到。”

我添加了 System.Design.dll 作为对项目的引用，在对象浏览器中，我可以看到 System.Web.UI.Design 命名空间。我已验证 system.design.dll 存在于 Windows/Microsoft.Net/Framework/v4.0.30319 和 Program Files (x86)/Reference Assemblies/Microsoft/Framework/.NETFramework/v4.5 目录中。

我正在使用 Visual Studio 2012。

在 Windows/Assembly 中，我只看到 2.0.0.0 版本的程序集，但是，在 VS 中添加引用显示我添加的版本为 4.0.0.0。尝试将 dll 从 v4.0.30319 目录拖放到 windows/assembly 并使用 gacutil。虽然 gacutil 说该程序集已添加，但它仍然没有出现在 Windows/Assembly 中。

# wordpress - woocommerce 将类别名称检索为 div 类？

> ID：16041238
> 
> 赞同：1
> 
> 时间：2013-04-16T15:37:50.077
> 
> 标签：wordpress, class, woocommerce

好的，我正在尝试检索显示在 wordpress 循环中的 woocommerce 产品的类别名称，并将其用作循环内的 li 类，我已经尝试过：

```
 <div id="isocontent" class="products">
                <ul><?php while (have_posts()) : the_post(); ?>

                        <li class="<?php echo $product->get_categories(); ?> box">
                            <a href="<?php the_permalink(); ?>"><?php echo the_post_thumbnail(); ?></a>
                            <p><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></p>
                            <a href="<?php the_permalink(); ?>"><span href="<?php the_permalink(); ?> " class="amount price" data-original="<?php echo get_woocommerce_currency(); ?><?php echo $product->get_price(); ?>" data-price="<?php echo $product->get_price(); ?>" title="Original price: <?php echo $product->get_price(); ?>"><?php echo get_woocommerce_currency(); ?><?php echo $product->get_price(); ?></span></a>
                            <a href="<?php the_permalink(); ?>?add-to-cart=<?php echo $post->ID ?>" class="pbutton">Add to Cart</a>
                        </li>
                    <?php endwhile; ?>
                </ul>
            </div> 
```

这是我试图通过以下方式检索课程的部分：

```
<li class="<?php echo $product->get_categories(); ?> box"> 
```

但它只是输出这个：

```
<li class="&lt;a href=" http:="" localhost.no="" fanny="" kategori="" interior-sv="" "="" rel="tag"> 
```

它确实检索了类别，但也使标记打破了循环。我也试过这个：

`<li <?php post_class('box'); ?>`

但因为 woocommerce 使用分类法，它会检索标签而不是产品类别。任何帮助都非常感谢克里斯亲切的问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T16:46:54.127

这并不像打一个电话那么容易 -`get_categories()`旨在显示产品类别的 HTML 表示。产品类别实际上是一种自定义分类法，因此您必须使用[`get_the_terms()`](http://codex.wordpress.org/Function_Reference/get_the_terms)它来了解它。

```
global $post;
$terms = get_the_terms( $post->ID, 'product_cat' );
foreach ( $terms as $term ){
    $category_id = $term->term_id;
    $category_name = $term->name;
    $category_slug = $term->slug;
    break; 
} 
```

# javascript - Twitter用户名不显示推文JSON

> ID：16041244
> 
> 赞同：0
> 
> 时间：2013-04-16T15:38:10.067
> 
> 标签：javascript, xml, json, rest, twitter

我正在尝试获取与此用户 @WeAreShootProd 关联的推文，但 JSON 和 XML 为空。

[https://api.twitter.com/1/users/show.xml?screen_name=WeAreShootProd](https://api.twitter.com/1/users/show.xml?screen_name=WeAreShootProd)

[https://search.twitter.com/search.json?rpp=10&callback=?&q=from:WeAreShootProd](https://search.twitter.com/search.json?rpp=10&callback=?&q=from:WeAreShootProd)

从这个链接可以看出，至少有 5 条推文

[https://twitter.com/WeAreShootProd](https://twitter.com/WeAreShootProd)

有谁知道为什么它们没有出现在 XML 或 JSON 中？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-25T21:06:30.157

当我尝试您提供的 URL 时，我看到以下响应：

```
{
  errors: [
    {
      message: "The Twitter REST API v1 is no longer active. Please migrate to API v1.1\. https://dev.twitter.com/docs/api/1.1/overview.",
      code: 68
    }
  ]
} 
```

我怀疑问题是在 JSON 调用中，URI 的查询部分中有两个问号。但无论当时的问题是什么，这个问题都没有实际意义。不再支持该版本的 Twitter API。

# php - 在 PHP foreach 中根据星期几进行过滤

> ID：16041245
> 
> 赞同：0
> 
> 时间：2013-04-16T15:38:10.113
> 
> 标签：php, facebook-graph-api, facebook-php-sdk, strtotime

我通过以下方法从 Facebook Graph API 获取来自我管理的所有帐户的最近 3 个月的页面查看信息：

```
$since_date = date('Y-m-d', strtotime('-3 months'));
$until_date = date('Y-m-d');
$page_views = $facebook->api('/' . $account['id'] . '/insights/page_views?since=' . $since_date . '&until=' . $until_date . '','GET'); 
```

之后，我使用 php foreach 循环（实际上是两个）以所需的格式（数组）获取所需的信息（页面视图和日期），如下所示：

```
foreach ($page_views['data'] as $page_view) {
    $i = 0;
    $len = count($page_view['values']);
    foreach($page_view['values'] as $key => $page_view_values) {
        $end_time = strval($page_view_values['end_time']);
        $value = intval($page_view_values['value']);
        echo '[\'' . substr($end_time, 0, -14) . '\', ' . $value . ']';
        if ($i == $len - 1) {
            continue;
        } else {
            echo ', ';
        }
        $i++;
    } 
```

哪个输出进一步需要以下数组：

```
(.....],['2013-04-02', 21], ['2013-04-03', 7], ['2013-04-04', 2], ['2013-04-05', 0], ['2013-04-06', 2], ['2013-04-07', 3], ['2013-04-08', 1], ['2013-04-09', 2], ['2013-04-10', 5], ['2013-04-11', 1], ['2013-04-12', 11], ['2013-04-13', 0],[.....) 
```

使用上述数组，一切正常。我渲染了一个非常漂亮的图表，但如果可以的话，我想根据一周中的几天对其进行过滤。例如：我想要一个像上面这样的数组，只有星期一或星期二的日期等等......我需要在第二个 php foreach 中的某个地方过滤以仅返回我想要的日期，但是如何？这种需求使用什么条件？或者我应该使用其他方法，例如，从 Facebook Graph Api 查询其他内容？任何指导都非常受欢迎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:41:29.063

例如，您可以根据工作日的 3 个字母代码做一个 switch case，并为每一天做这样的事情：

```
$tempDate = '2012-07-10';
echo date('D', strtotime( $tempDate)); 
```

它将输出：**星期二**

这将允许您按工作日进行过滤。例如，如果工作日代码是 Tue，您只会添加到数组中。所有其他将被跳过。

添加了@arraintxo 注释：

```
date('N', strtotime($tempDate)) 
```

将返回工作日的数值（1 到 7，1 为星期一，7 为星期日），更易于比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T10:09:03.303

首先，我要感谢大家的及时回复，这是一个很大的帮助，我非常感谢。根据您的指导，我以下列方式解决我的“问题”：

```
$since_date = date('Y-m-d', strtotime('-3 months'));
$until_date = date('Y-m-d');
$page_views = $facebook->api('/' . $account['id'] . '/insights/page_views?since=' . $since_date . '&until=' . $until_date . '','GET');
    foreach ($page_views['data'] as $page_view) {
        $i = 0;
        foreach($page_view['values'] as $key => $page_view_values) {
            $end_time = strval($page_view_values['end_time']);
            $ds = substr($end_time, 0, -14);
            $value = intval($page_view_values['value']);
            if (date('N', strtotime($ds)) != 1) {
                continue;
            } else {
                if ($i==1) {
                    echo ', ';
                }
                $i=1;
                echo '[\'' . $ds . '\', ' . $value . ']';
            }
        }
    } 
```

`date('N', strtotime($ds))`我可以通过使用一天中的相应数字来为一周中的每一天执行此操作。我收到了我想要的数组，但如果可以的话，我想知道是否可以对调用的变量中的数字求和`$page_view_values['value']`（我想比较一周中的天数）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:05:54.360

我建议与当前回复类似的内容，稍作调整：

```
$first=false; $cache=array(); $conv=new \Date('2000-01-01T00:00:00Z');
foreach ($page_views['data'] as $page_view) {
  foreach($page_view['values'] as $key => $page_view_values) {
    $end_time = strval($page_view_values['end_time']);
    $ds=substr($end_time, 0, -14);
    $value = intval($page_view_values['value']);
    if(!isset($cache[$ds])
      $cache[$ds]=(int)$conv->modify($ds)->format('N');
    if($first){ echo ', '; $first=false; }
    echo '[\'' . $ds . '\', ' . $value . ', '.$cache[$ds].']';
  }
} 
```

日索引现在作为数组的第三项出现。注意 1：使用缓存，以便您只查找每个日期一次。注意 2：使用 bool 不添加前导分隔符比从计数向下计数要便宜得多，而计数又比向上计数便宜得多（你首先做了什么）。注意 3：这会一次又一次地修改 $conv 对象，因为我不喜欢创建很多对象，而且这至少应该像程序样式（date() 和 strtotime()）一样执行。

# html - Tidesdk - 在 Windows 启动时启动桌面 titersdk 应用程序

> ID：16041246
> 
> 赞同：1
> 
> 时间：2013-04-16T15:38:14.597
> 
> 标签：html, desktop, startup, tidesdk

我有一个使用 TideSDK 创建的桌面应用程序，我需要这个应用程序在 Windows 启动时启动，但是找不到如何，我的意思是，当第一次安装或启动该应用程序时，我希望它设置为在 Windows 启动时启动. 如果有人对此进行了研究，那将非常有帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T14:26:04.960

这目前不是一个功能。请为功能请求创建一个 github 待办事项。

# windows - 如何通过 WMI 查询以 GB 为单位获取总物理内存 (ram) 信息？

> ID：16041249
> 
> 赞同：1
> 
> 时间：2013-04-16T15:38:25.883
> 
> 标签：windows, wmi, wmic, wql

我知道如何从 win32_computersystem 类中获取总物理内存。但这以字节或 kb 为单位。我想要此信息以 MB 或 GB 为单位。在 wmi (wql) 查询中。wmic 也可以。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T07:13:28.383

您可以[转换](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394102%28v=vs.85%29.aspx)`TotalPhysicalMemory`Win32_ComputerSystem 。尝试这个 ：

```
using System;
using System.Management;
namespace WMISample
{
    public class MyWMIQuery
    {
        public static void Main()
        {
            try
            {
                ManagementObjectSearcher searcher =
                    new ManagementObjectSearcher("root\\CIMV2",
                    "SELECT TotalPhysicalMemory FROM Win32_ComputerSystem");

                foreach (ManagementObject queryObj in searcher.Get())
                { 
                    double dblMemory;
                    if(double.TryParse(Convert.ToString(queryObj["TotalPhysicalMemory"]),out dblMemory))
                    {
                        Console.WriteLine("TotalPhysicalMemory is: {0} MB", Convert.ToInt32(dblMemory/(1024*1024)));
                        Console.WriteLine("TotalPhysicalMemory is: {0} GB", Convert.ToInt32(dblMemory /(1024*1024*1024)));
                    }
                }
            }
            catch (ManagementException e)
            {

            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-16T18:34:49.497

您必须手动转换属性的值。也最好使用[Win32_PhysicalMemory](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394347%28v=vs.85%29.aspx) WMI 类。

试试这个样本

```
using System;
using System.Collections.Generic;
using System.Management;
using System.Text;

namespace GetWMI_Info
{
    class Program
    {

        static void Main(string[] args)
        {
            try
            {
                ManagementScope Scope;
                Scope = new ManagementScope(String.Format("\\\\{0}\\root\\CIMV2", "."), null);

                Scope.Connect();
                ObjectQuery Query = new ObjectQuery("SELECT Capacity FROM Win32_PhysicalMemory");
                ManagementObjectSearcher Searcher = new ManagementObjectSearcher(Scope, Query);
                UInt64 Capacity = 0;
                foreach (ManagementObject WmiObject in Searcher.Get())
                {
                    Capacity+= (UInt64) WmiObject["Capacity"];
                }
                Console.WriteLine(String.Format("Physical Memory {0} gb", Capacity / (1024 * 1024 * 1024))); 
                Console.WriteLine(String.Format("Physical Memory {0} mb", Capacity / (1024 * 1024)));
            }
            catch (Exception e)
            {
                Console.WriteLine(String.Format("Exception {0} Trace {1}", e.Message, e.StackTrace));
            }
            Console.WriteLine("Press Enter to exit");
            Console.Read();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-18T12:06:16.713

想提一下，我使用了 Win32_PhysicalMemory Capacity 属性，直到在 Windows Server 2012 上遇到不一致的结果。现在我使用这两个属性（Win32_ComputerSystem:TotalPhysicalMemory 和 Win32_PhysicalMemory:Capacity）并选择两者中较大的一个。

# java - killBackgroundProcesses 不工作（对于其他应用程序）

> ID：16041251
> 
> 赞同：0
> 
> 时间：2013-04-16T15:38:26.210
> 
> 标签：java, android

我正在尝试使用以下代码让我的应用关闭音乐播放器：

```
import android.app.ActivityManager;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.media.AudioManager;

public class MyBroadcastReceiver extends BroadcastReceiver {
  @Override
  public void onReceive(Context context, Intent intent) {
AudioManager audioManager = (AudioManager) context.getSystemService(Context.AUDIO_SERVICE);
audioManager.setStreamVolume(AudioManager.STREAM_MUSIC, 0, 0);
ActivityManager activityManager = (ActivityManager)      
context.getSystemService(Context.ACTIVITY_SERVICE);
    String music = "com.sec.android.app.music";
    activityManager.killBackgroundProcesses(music);
  }

} 
```

但它只是调低音量，而不是杀死应用程序。我已经向清单添加了适当的权限，并且我的目标是高于 API 8 谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:46:46.163

你不能杀死其他进程。只有系统才能做到这一点。音量会下降，因为它的设置不是每个应用程序。

# excel - 如何仅计算一次唯一记录并基于该计数是或否

> ID：16041263
> 
> 赞同：0
> 
> 时间：2013-04-16T15:38:58.027
> 
> 标签：excel, excel-formula, formula, vba

我有 3 列

ORDER、ID 和 E 是/否

在 C 列顺序 在 D 列 ID 在 E 列 是/否

例如对于`ID = 144`. 我需要计算给 144 的订单数量。因此，查看 144 以下的示例表给出了 1 个订单，即 821，144 的列是 Yes，当 Order = 821 时。

另一个例子`ID=162.` 是 2 阶 ,`861`和`992`。所以他的总订单数是`2`，并且 # of Yes 计数是 1，因为第 13 行是 No。

我真的被这个复杂的逻辑困住了。对于任何反馈，我们都表示感谢。

![在此处输入图像描述](https://i.stack.imgur.com/VfBE4.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T19:55:15.963

给定显示的布局，分别在`B17`和中尝试这些`C17`，然后填写：

```
=SUM(IF(FREQUENCY(IF(MMULT(-(D$2:D$13=A17),1),C$2:C$13),C$2:C$13),1))
=SUM(IF(FREQUENCY(IF(MMULT((D$2:D$13=A17)*(E$2:E$13="YES"),1),C$2:C$13),C$2:C$13),1)) 
```

# cocos2d-iphone - 更改由 CCRenderTexture 创建的 CCSprite 的 textureRect

> ID：16041268
> 
> 赞同：3
> 
> 时间：2013-04-16T15:39:04.670
> 
> 标签：cocos2d-iphone

我有一个`CCSprite`逐渐需要从一端线性耗尽，让我们说从左到右。为此，我试图改变`textureRect`精灵的属性，以便从一端耗尽的部分在“外部”显示精灵的帧。

我之前使用从 spritesheet 加载的 sprite 做过这种事情。它工作得很好。但是我`CCSprite`使用`CCRenderTexture`并通过更改`textureRect`属性创建了这个，整个 sprite 消失了。

第一张图片是我从 CCRenderTexture 获得的原始 CCSprite。第二张图片显示了我想要实现的效果。Sprite 的黑色虚线矩形部分需要省略。只需要显示精灵的蓝色虚线部分。本质上，这个蓝色虚线矩形是我的纹理矩形。

![更改 textureRect 属性以仅显示整个精灵的一部分](https://i.stack.imgur.com/74Wgr.png)

有什么办法可以让我的精灵从一端减少。正常创建的精灵和使用`CCRenderTexture`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T07:18:46.530

原来我犯了一个愚蠢的错误。在为 textureRect(CGRect) 提供值时，我实际上将 textureRect.origin.y 设置为纹理的高度，这使我的 textureRect 超出（高于）纹理区域。这解释了为什么他们会消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:55:38.557

在使用一些低级黑客之前，我已经做过类似的事情。

如果您使用，有一个解决方案`CCProgressTimer`，这很容易，我认为对于您的示例应该足够了。

但是您在评论中说您有一些`special`要求，例如“同时从两端耗尽它”，那么需要一些低级的黑客攻击。我最后一个对象的解决方案是：

1) 获取纹理图像的原始数据。在 cocos2d 中可以使用`CCRenderTexture`，在 cocos2d-x 中可以使用`CCImage`.

2)`CCRenderTexture`有一个方法`- (BOOL) saveToFile: (NSString *) name format: (tCCImageFormat) format` 。您可以阅读其源代码，然后尝试将其保存到二维数组中，而不是像`byte raw[1024][768]`. 这个数组中的每个元素代表你图片上的一个像素（类型可能不是`byte`，我不确定，几乎忘记了细节）。格式必须是 PNG，因为需要透明度。

3）直接修改原始数据，将像素的透明度设置为0x0，您希望它消失。

4）重新初始化`CCRenderTexture`您修改的使用图片数据。

我无法直接提供代码，因为这是我的一个项目的商业机密和核心部分。但我可以和你分享我的解决方案。您还需要一些有关 PNG 文件如何工作的知识。读：

[https://en.wikipedia.org/wiki/Portable_Network_Graphics#File_header](https://en.wikipedia.org/wiki/Portable_Network_Graphics#File_header)

# javascript - Javascript Mouseover 事件代理松鼠

> ID：16041270
> 
> 赞同：0
> 
> 时间：2013-04-16T15:39:12.447
> 
> 标签：javascript, jquery, html, css

我试图显示一个带有子元素的 div 容器，并且只显示容器的顶部，直到鼠标移到它上面，然后显示带有内容的子元素的整个容器。这个排序就像我想要的那样工作，但问题是如果你将鼠标移动到任何子元素上，整个主容器会向上滑动，然后再次向下滑动。我正在尝试使整个容器在 MouseOver 上向下滑动并保持向下直到 MouseOut 应该向上滑动。

```
<div onmouseover="$('#id_content').slideDown('fast', function(){ $(this).css('display', 'block'); $(this).css('visibility', 'visible'); });" 
 onmouseout="$('#id_content').slideUp('fast', function(){ $(this).css('display', 'none'); $(this).css('visibility', 'hidden'); });">
Title
<BR> 
mm/dd/yyyy hh:mm - hh:mm
<div id="id_content" style="visibility: hidden; display: none;">
    Description 
    <BR>
    Content 
</div>
<span class="commands"> <!-- Goes in the top right hand corner of the main container -->
    <span class="delete" onclick="delete_entry('record_id')">X</span>
</span>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:42:06.933

看起来您无论如何都在使用 JQuery，所以不要使用 onmouseover 事件。

改用 JQuery 悬停方法：http: [//api.jquery.com/hover/](http://api.jquery.com/hover/)

它允许您在鼠标进入对象和鼠标离开对象时提供函数。

当您使用它时，我会用 JQuerys .click() 方法替换 onclick 事件。[http://api.jquery.com/click/](http://api.jquery.com/click/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T15:43:23.390

jQuery 有一个功能：[悬停](http://api.jquery.com/hover/)。

它还可以让您避免内联事件处理程序：

```
 <script>
    $('#a').hover(function(){
      $('#id_content').slideDown('fast', function(){ $(this).css('display', 'block'); $(this).css('visibility', 'visible'); });
    }, function(){
      $('#id_content').slideUp('fast', function(){ $(this).css('display', 'none'); $(this).css('visibility', 'hidden'); });
    });
  </script> 
```

[示范](http://jsbin.com/ipusad/1/edit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T15:47:41.177

你想要`mouseenter`和`mouseleave`。它们由 jQuery 在`hover`.

在 JavaScript 中，您可以检测 an 何时`onmouseout`是 an，`onmouseleave`或者您是否只是将鼠标悬停在子元素上。检查是否`event.relatedTarget`是子元素。

# xamarin.android - xamarin 没有使用 android sdk 构建正确的 apk

> ID：16041274
> 
> 赞同：1
> 
> 时间：2013-04-16T15:39:19.803
> 
> 标签：xamarin.android, xamarin

昨天我能够构建apk文件。由于我添加了许多图片和资源来为应用程序设置主题，并且当我想在我的设备上对其进行测试时，Visual Studio 为我构建了一个崩溃的应用程序。

我设置了“发布”模式，我转到工具>发布应用程序，我创建了一个密钥库并构建了 apk。

我将代码放入“禁用调试”并制作了清单。

当我尝试安装它时，它可以工作，但是应用程序崩溃了。

该应用程序与模拟器完美配合。

重量并没有真正改变（有些 Ko），但应用程序必须更大，因为我放了所有图片，所以出了点问题......

感谢帮助我:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T09:40:06.373

我取消选中属性> Mono android选项中的“使用共享运行时”：

![单声道安卓选项](https://i.stack.imgur.com/HXV9v.png)

# java - 单击按钮时强制关闭

> ID：16041275
> 
> 赞同：-1
> 
> 时间：2013-04-16T15:39:21.613
> 
> 标签：java, android

我开始开发安卓应用了！我开始我的第一个并遇到了一个早期的问题。该应用程序的作用是有两个按钮，您可以单击它们来添加或减去主要变量。一切都很顺利，直到我在我的 Nexus 4 上测试它，当我按下按钮时它强制关闭。我查看了类似的问题，但仍然无法弄清楚我的问题。谢谢！

日志猫：

```
04-16 10:42:48.528: D/libEGL(17421): loaded /system/lib/egl/libEGL_adreno200.so
    04-16 10:42:48.538: D/libEGL(17421): loaded /system/lib/egl/libGLESv1_CM_adreno200.so
    04-16 10:42:48.538: D/libEGL(17421): loaded /system/lib/egl/libGLESv2_adreno200.so
    04-16 10:42:48.538: I/Adreno200-EGL(17421): <eglInitialize:269>: EGL 1.4 QUALCOMM build: Nondeterministic AU_full_mako_PARTNER-ANDROID/JB-MR1-DEV_CL2961380_release_AU (CL2961380)
    04-16 10:42:48.538: I/Adreno200-EGL(17421): Build Date: 12/10/12 Mon
    04-16 10:42:48.538: I/Adreno200-EGL(17421): Local Branch: 
    04-16 10:42:48.538: I/Adreno200-EGL(17421): Remote Branch: m/partner-android/jb-mr1-dev
    04-16 10:42:48.538: I/Adreno200-EGL(17421): Local Patches: NONE
    04-16 10:42:48.538: I/Adreno200-EGL(17421): Reconstruct Branch: NOTHING
    04-16 10:42:48.568: D/OpenGLRenderer(17421): Enabling debug mode 0
    04-16 10:42:52.592: D/AndroidRuntime(17421): Shutting down VM
    04-16 10:42:52.592: W/dalvikvm(17421): threadid=1: thread exiting with uncaught exception (group=0x40bef930)
    04-16 10:42:52.592: E/AndroidRuntime(17421): FATAL EXCEPTION: main
    04-16 10:42:52.592: E/AndroidRuntime(17421): java.lang.NullPointerException
    04-16 10:42:52.592: E/AndroidRuntime(17421):    at com.frostbytedev.addsub.StartingPoint$2.onClick(StartingPoint.java:37)
    04-16 10:42:52.592: E/AndroidRuntime(17421):    at android.view.View.performClick(View.java:4204)
    04-16 10:42:52.592: E/AndroidRuntime(17421):    at android.view.View$PerformClick.run(View.java:17355)
    04-16 10:42:52.592: E/AndroidRuntime(17421):    at android.os.Handler.handleCallback(Handler.java:725)
    04-16 10:42:52.592: E/AndroidRuntime(17421):    at android.os.Handler.dispatchMessage(Handler.java:92)
    04-16 10:42:52.592: E/AndroidRuntime(17421):    at android.os.Looper.loop(Looper.java:137)
    04-16 10:42:52.592: E/AndroidRuntime(17421):    at android.app.ActivityThread.main(ActivityThread.java:5041)
    04-16 10:42:52.592: E/AndroidRuntime(17421):    at java.lang.reflect.Method.invokeNative(Native Method)
    04-16 10:42:52.592: E/AndroidRuntime(17421):    at java.lang.reflect.Method.invoke(Method.java:511)
    04-16 10:42:52.592: E/AndroidRuntime(17421):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
    04-16 10:42:52.592: E/AndroidRuntime(17421):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
    04-16 10:42:52.592: E/AndroidRuntime(17421):    at dalvik.system.NativeStart.main(Native Method)
    04-16 10:43:22.033: D/AndroidRuntime(17514): Shutting down VM
    04-16 10:43:22.033: W/dalvikvm(17514): threadid=1: thread exiting with uncaught exception (group=0x40bef930)
    04-16 10:43:22.033: E/AndroidRuntime(17514): FATAL EXCEPTION: main
    04-16 10:43:22.033: E/AndroidRuntime(17514): java.lang.NullPointerException
    04-16 10:43:22.033: E/AndroidRuntime(17514):    at com.frostbytedev.addsub.StartingPoint$2.onClick(StartingPoint.java:37)
    04-16 10:43:22.033: E/AndroidRuntime(17514):    at android.view.View.performClick(View.java:4204)
    04-16 10:43:22.033: E/AndroidRuntime(17514):    at android.view.View$PerformClick.run(View.java:17355)
    04-16 10:43:22.033: E/AndroidRuntime(17514):    at android.os.Handler.handleCallback(Handler.java:725)
    04-16 10:43:22.033: E/AndroidRuntime(17514):    at android.os.Handler.dispatchMessage(Handler.java:92)
    04-16 10:43:22.033: E/AndroidRuntime(17514):    at android.os.Looper.loop(Looper.java:137)
    04-16 10:43:22.033: E/AndroidRuntime(17514):    at android.app.ActivityThread.main(ActivityThread.java:5041)
    04-16 10:43:22.033: E/AndroidRuntime(17514):    at java.lang.reflect.Method.invokeNative(Native Method)
    04-16 10:43:22.033: E/AndroidRuntime(17514):    at java.lang.reflect.Method.invoke(Method.java:511)
    04-16 10:43:22.033: E/AndroidRuntime(17514):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
    04-16 10:43:22.033: E/AndroidRuntime(17514):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
    04-16 10:43:22.033: E/AndroidRuntime(17514):    at dalvik.system.NativeStart.main(Native Method)
    04-16 10:43:23.685: I/Process(17514): Sending signal. PID: 17514 SIG: 9 
```

我也有我的 Activity 和 Class 文件。

活动：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:gravity="top"
    android:paddingBottom="@dimen/activity_vertical_margin"
    android:paddingLeft="@dimen/activity_horizontal_margin"
    android:paddingRight="@dimen/activity_horizontal_margin"
    android:paddingTop="@dimen/activity_vertical_margin"
    tools:context=".StartingPoint" >
<TextView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Your total is 0"
        android:textSize="45dp"
        android:gravity="center"
        android:id="@+id/tvDisplay"
         />
<Button
        android:layout_width="250dp"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:text="Add One"
        android:textSize="20dp"
        android:id="@+id/bAdd" />
 <Button
        android:layout_width="250dp"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:text="Subtract One"
        android:textSize="20dp"
        android:id="@+id/bSub" />

</LinearLayout> 
```

最后，我的类文件：

```
package com.frostbytedev.addsub;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

public class StartingPoint extends Activity {

    int counter;
    Button add, sub;
    TextView display;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_starting_point);
        counter = 0;
        add=(Button) findViewById(R.id.bAdd);
        sub=(Button) findViewById(R.id.bSub);
        add.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                counter++;
                display.setText("Your total is "+counter);
            }
        });

        sub.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                counter--;
                display.setText("Your total is "+counter);
            }
    });
    }
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.starting_point, menu);
        return true;
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T15:41:46.257

你需要找到textview的id。

```
android:id="@+id/tvDisplay"
display = TextView findViewById(R.id.tvDisplay); 
```

您的代码中没有上述语句，这是 NullPointerException 的原因。

一旦你找到上面的 id 将 text 设置为 textview

```
display.setText("Your total is "+counter); 
```

解释：

每个资源（如字符串、drawables 和按钮 textview 等视图）在 R.java 文件中都有一个条目，如下所示

```
public static final int tvDisplay=0x7f080000;// value may differ 
```

值为整数。所以 R.id.textview 将是整数值。您需要通过查找 id 来初始化 textview，然后在 TextView 中设置文本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T15:41:47.317

关于错误的更广泛的解释，所以你不会在一段时间内打开另一个这样的问题。

阅读错误：

```
java.lang.NullPointerException
04-16 10:42:52.592: E/AndroidRuntime(17421):    at com.frostbytedev.addsub.StartingPoint$2.onClick(StartingPoint.java:37) 
```

`null`基本上在那条线（37）有一些东西。

转到该行并查看：

```
display.setText("Your total is "+counter); 
```

你在`setText(String text)`打电话`display`。所以问题就在那里。

如果您在没有实例化之前查看`display`（即为空），那么您正在调用一个方法。正如其他人指出的那样，只需使用 findViewById 获取视图，将其转换为 TextView 并将其保存在显示变量中：

```
display = (TextView) findViewById(R.id.textview); 
```

并学会**调试**，这是关键！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T15:41:04.623

您需要将视图 ( `tvDisplay`) 分配给`display`. 当前`display`仅声明但未分配给，因此为**null**。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-16T15:41:17.897

你还没有初始化显示 TextView

做这个

```
diplay = (TextView) findVidewById(R.id.tvDisplay); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-16T15:41:55.043

添加

> display=(TextView) findViewById(R.id.your id);

# c# - 拆分容器的问题

> ID：16041276
> 
> 赞同：0
> 
> 时间：2013-04-16T15:39:25.520
> 
> 标签：c#, winforms, splitcontainer

也许我不明白它是如何工作的......

所以有一个名为'newDevicesSpliContainer'的SplitContainer，它有Panel1和Panel2。

我正在尝试将 Panel2 设置为可见，但它不起作用。我尝试将属性 Panel2Collapsed 设置为 false，但它不影响 Panel2 的 Visible 属性。当然，不能直接操作 Visible 属性的值...

应该怎么做才能使 Panel2 可见？

# django - Sqlite3 中不存在 Django ManyToManyField

> ID：16041277
> 
> 赞同：1
> 
> 时间：2013-04-16T15:39:30.830
> 
> 标签：django, sqlite, manytomanyfield

我是 Django 新手，我对多对多关系有一些问题。我从事blastn自动化工作，这是我的课程：

```
class Annotation(models.Model):
   sequence = models.IntegerField()
   annotation = models.TextField()
   start = models.IntegerField()
   end = models.IntegerField()

class Blast(models.Model):
    sequence = models.ManyToManyField(Annotation, through="AnnotBlast")
    expectValue = models.IntegerField()

class AnnotBlast(models.Model):
    id_blast = models.ForeignKey(Blast, to_field="id")
    id_annot = models.ForeignKey(Annotation, to_field="id")

class Hit(models.Model):
    id_hit = models.ForeignKey(Blast, to_field="id")
    length = models.IntegerField()
    evalue = models.IntegerField()
    start_seq = models.IntegerField()
    end_seq = models.IntegerField() 
```

在一个视图中，我想通过这个多对多字段从模型的其余部分访问 Annotation 的数据，然后基于表单应用过滤器。但是当我做 a 时`syncdb`，Blast 类的“序列”字段*消失了*：

在 Sqlite3 中：

```
.schema myApp_blast
CREATE TABLE "myApp_blast" (
   "id" integer not null primary key,
   "expectValue" integer not null
); 
```

所以我无法根据需要在此表中加载数据。我不明白为什么这个字段会在同步数据库中消失。如何将第一类链接到其他类（然后能够在模板中合并数据）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:36:50.567

ManyToManyField 本身并不是数据库中的列。它仅由连接表中的一个元素表示，您在此处明确定义为 AnnotBlast（请注意，由于您没有在关系上定义任何额外字段，因此您实际上不需要定义一个直通表 - Django 会如果你没有自动完成）。

因此，要将数据添加到您的模型，您需要将数据添加到 AnnotBlast 表，指向相关的 Blast 和 Annotation 行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:41:58.270

对于多对多关系，会创建一个中间连接表，请参阅此处的文档：[https ://docs.djangoproject.com/en/1.2/ref/models/fields/#id1](https://docs.djangoproject.com/en/1.2/ref/models/fields/#id1)

# android - Google+ 平台无法运行示例 android 应用程序 PlusSampleActivity

> ID：16041283
> 
> 赞同：0
> 
> 时间：2013-04-16T15:39:44.720
> 
> 标签：android, google-plus

遵循[https://developers.google.com/+/quickstart/android](https://developers.google.com/+/quickstart/android)上的确切步骤。在我的 Nexus 7 上启动了示例 PlusSampleActivity。单击“登录”时，显示错误“发生内部错误”。我回溯，发现函数

```
mLastConnectionResult.startResolutionForResult(getActivity(), mRequestCode); 
```

抛出错误。我也没有在示例项目中找到任何地方输入我自己的密钥。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:02:46.807

弄清楚了。要运行示例应用程序，包名不能是您自己的项目，而是“com.google.android.gms.samples.plus”。

# facebook - 我们可以通过 Facebook api 在 Facebook 上获取活动成员的电子邮件吗

> ID：16041284
> 
> 赞同：0
> 
> 时间：2013-04-16T15:39:45.943
> 
> 标签：facebook, facebook-graph-api

我们可以通过 Facebook api 在 Facebook 上获取活动成员的电子邮件吗？

有什么办法吗，我尝试使用图形工具，但没有得到电子邮件地址。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:04:18.417

详细说明@JaysonLane 所说的，这是不可能的，因为用户需要明确授予您阅读其电子邮件地址的权限，并且您需要为每个单独的用户提供有效的 access_token 才能访问它

[https://developers.facebook.com/docs/reference/api/event/](https://developers.facebook.com/docs/reference/api/event/)

[https://developers.facebook.com/docs/reference/login/email-permissions/](https://developers.facebook.com/docs/reference/login/email-permissions/)

# javascript - dragend、dragstart 和“未捕获的类型错误：无法读取属性 '_e3”错误

> ID：16041288
> 
> 赞同：0
> 
> 时间：2013-04-16T15:39:58.353
> 
> 标签：javascript, google-maps, google-maps-api-3

我要创建的是一个“单击”事件，供用户在地图上放置标记，此外，如果用户想要更改标记位置，用户可以将标记拖到他们想要的位置。但是 dragstart 和 dragend 不是诀窍，我不知道为什么......

和“未捕获的类型错误：无法读取未定义的属性 '_ *e3* '”错误在我的错误日志中，我尝试了几种方法来解决它，但仍然无法解决......所以大家知道如何解决它吗？感谢您的帮助谢谢

```
 <script type="text/javascript">
var map;
var geocoder;
var marker;
var mapOptions
function initialize() {
     mapOptions = {
      center: new google.maps.LatLng(3.1597,101.7000),
      zoom: 12,
      disableDefaultUI: true,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
       mapTypeControl: true,
    mapTypeControlOptions: {
    style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,
    position: google.maps.ControlPosition.TOP_LEFT
          },
    };
     map = new google.maps.Map(document.getElementById("map-canvas"),
        mapOptions);
     geocoder = new google.maps.Geocoder();

      google.maps.event.addListenerOnce(map, 'click', function(event) {
            placeMarker(event.latLng);
          });
      function placeMarker(location) {
            marker = new google.maps.Marker({
            position: location,
            map: map,
            draggable:true
          });
        }
          google.maps.event.addListener(marker, 'dragstart', function(evt){
            document.getElementById('current').innerHTML = '<p>Currently dragging marker...</p>';
        });
        google.maps.event.addListener(marker, 'dragend', function(evt){
          document.getElementById('current').innerHTML = '<p>Marker dropped: Current Lat: ' + evt.latLng.lat().toFixed(3) + ' Current Lng: ' + evt.latLng.lng().toFixed(3) + '</p>';
      });

}
google.maps.event.addDomListener(window, "load", initialize);

</script> 
```

为了确认 dragend 和 dragstart 事件正在工作，我在我的 html 中添加了一个 ID 以显示最新的 lat 和 lng

```
 <div id="current">Nothing yet...</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:51:21.167

`addListener`您应该移动into的两个调用`placeMarker`，否则`marker`在执行时未定义。

# java - 在 Spring 应用程序中配置 JPA

> ID：16041291
> 
> 赞同：0
> 
> 时间：2013-04-16T15:40:11.363
> 
> 标签：java, spring, jakarta-ee, jpa

我正在通过使用 Hibernate 实现来配置 Spring 以使用 JPA。但是我不完全理解这个过程。通过关注不同的博客等，我已经让它工作了。我使用了 EJB 3.1，在那里我有一个 persistence.xml。但是在春天，我声明了一个 LocalContainer...Bean 并为其提供了一些属性，但我没有 persistence.xml。有人可以解释它在 Spring 中的工作原理以及声明的 bean 是什么吗？

```
<bean id="emf" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter" />
    </property>
    <property name="packagesToScan" value="com.company.domain" />
    <property name="jpaProperties">
        <props>
            <prop key="hibernate.dialect">
                org.hibernate.dialect.PostgreSQL82Dialect
            </prop>
        </props>
    </property>
</bean> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:04:26.407

使用 JPA 有不同风格的 Spring Configuration，一种需要 persistence.xml，另一种只需要 bean 声明（没有 persistence.xml）。

我将在您的场景中处理案例 2：

我们想要一个persistence.xml的主要原因是因为以下原因：

1.  数据库连接详细信息。
2.  被视为实体或包的 Java 类，在其中扫描实体。
3.  其他供应商特定的设置，如 hibernate.show_sql 或类似的东西。

现在，如果 spring 提供了一种在 bean 配置中一起提及所有这些的方法，那么就不需要persistence.xml。

如果是您的 bean 定义，让我们将其分解。

```
<bean id="emf" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter" />
    </property>
    <property name="packagesToScan" value="com.company.domain" />
    <property name="jpaProperties">
        <props>
            <prop key="hibernate.dialect">
                org.hibernate.dialect.PostgreSQL82Dialect
            </prop>
        </props>
    </property>
</bean> 
```

第一个属性，dataSource 已经包含数据库设置。

第二个属性，jpaVendorAdapter 是 Spring 特有的属性

第三个属性，packagesToScan，这是 Spring 用于扫描实体的属性，我们可以在 persistence.xml 中通过使用“class”标签通过提及每个类 FQN 来执行此操作。

第四个属性，jpaProperties，顾名思义，既可以在 Spring 中，也可以在 persistence.xml 中

例如

```
<property name="hibernate.dialect" value="org.hibernate.dialect.PostgreSQL82Dialect" /> 
```

由于您已经在 Spring bean 中进行了所有配置，因此不需要 persistence.xml

**只需添加脚注：**

Spring 3.1 提供了一个替代方案：LocalContainerEntityManagerFactoryBean，它接受一个 'packagesToScan' 属性，指定基本包以扫描 @Entity 类。

希望这能回答您的疑问。

# java - Java随机设置两个变量，然后设置第三个

> ID：16041299
> 
> 赞同：0
> 
> 时间：2013-04-16T15:40:31.223
> 
> 标签：java, random

我试图弄清楚如何随机分配两个单独的整数作为变量。如何在它们之间随机选择是有意义的（`r.nextInt(02)`），但我似乎找不到任何关于如何分配一个**与**另一个。我还尝试根据前两个变量的总和分配第三个变量，我想我理解`int c = (int a + b)`。但是你如何每次随机设置第三个？所以它可能是A，B或C？

致力于一个游戏创意，但我也受到我正在工作的一个人（他不在）给我的要求的限制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:46:31.007

尝试将 3 `int` A、B、C 添加到数组中并随机选择一个索引。

```
int[] numbers = new int[3];
numbers[0] = a;
numbers[1] = b;
numbers[2] = c;

int index = rand.nextInt(3);
int yourNumber = numbers[index]; 
```

# java - 余额充足异常

> ID：16041302
> 
> 赞同：-1
> 
> 时间：2013-04-16T15:40:36.613
> 
> 标签：java, exception

```
import java.util.Scanner;
public class Bankaccount{
    double diposit, withdraw;
 double balance=0;
 public Bankaccount(double balance)
 {
     this.balance=balance;
 }
  void deposit(double ammount)
{
       Scanner b=new Scanner(System.in);
    System.out.println("diposit a amount");
     ammount=b.nextInt();
     balance +=ammount;
}
 void withdraw(double ammount)
{
       Scanner b=new Scanner(System.in);
    System.out.println("withdraw a amount");
     ammount=b.nextInt();
     balance +=ammount;
}

  void display()
  {
      System.out.println(balance);
  }
public static void main(String[]args)
{

}} 
```

如何在主函数中显示这些条件？我已经为此创建了一个例外，因为余额不足。我想在这里抛出异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:49:26.553

使用它来引发异常。

```
throw new InsufficientBalanceException(); 
```

并将方法声明为

```
void withdraw (double amount) throws InsufficientBalanceException
{
    if (amount > balance)
        throw new InsufficientBalanceException();
    else
        balance -= amount;
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:49:31.577

首先，当您提款时，您必须减去金额而不是添加金额，但首先您必须检查是否可以减去该金额：

```
void withdraw(double ammount) throws InsuffcientBalanceExeption
{
    Scanner b=new Scanner(System.in);
    System.out.println("withdraw a amount");
    ammount=b.nextInt();
    if(balance<amount){
       throw new InsuffcientBalanceExeption();
    }
    balance -=ammount;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-29T09:56:20.010

```
import java.util.*;
import java.util.Scanner;
class DebitException 
{ 
    static void fun() throws IllegalAccessException 
    { 
        double balance = 0, damount, wamount;

        Scanner dep=new Scanner(System.in);
        System.out.println("Deposit an amount");
        damount=dep.nextInt();
        balance += damount;

        Scanner wd=new Scanner(System.in);
        System.out.println("Withdraw an amount");
        wamount=wd.nextInt();
        balance -= wamount;

        if (balance<0)
        {
        throw new IllegalAccessException(); 
        }
        else
        System.out.println(balance);
    }

    public static void main(String args[]) 
    { 

        try
        { 
            fun(); 
        } 
        catch(IllegalAccessException ex) 
        { 
            System.out.println("Exceeding Balance"); 
        } 
    } 
} 
```

您可以使用此代码...此代码将 100% 工作...

# mysql - mysql语句

> ID：16041304
> 
> 赞同：-2
> 
> 时间：2013-04-16T15:40:42.893
> 
> 标签：mysql

我有一个 sql 语句，我想获取所有类别为“游戏”的条目，但不想检索代码为“A00001”的记录。

以下是我的 sql 代码，但 where 子句中有错误。

```
 $sql1 = "SELECT * FROM productItem WHERE productName = '$name' AND skuCode != '$mySKU';"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:56:34.967

```
$mySKU = 'A00001';
$sql1 = "SELECT * FROM productItem WHERE productName = '$name' AND skuCode != '$mySKU'"; 
```

你有一个额外的`;`潜伏在那里的某个地方。`$mySKU`如果是用户输入和使用`prepared`语句，请务必进行清理。

**更新**：
使用 PDO：

```
$stmt = $dbh->prepare("SELECT * FROM productItem WHERE productName = :name AND skuCode != :mySKU");
if ($stmt->execute(array('name' => $name, "mySKU" => $mySKU))) {
$rows = $stmt->fetchAll(); //if you are sure there are records 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-16T15:45:33.003

尝试这个：

```
"SELECT * FROM productItem WHERE productName = '$name' AND skuCode <> '$mySKU';"; 
```

不等于声明是 <> [http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#operator_not-equal](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#operator_not-equal)

# php - 自己的助手代码点火器中未定义的偏移量

> ID：16041306
> 
> 赞同：0
> 
> 时间：2013-04-16T15:40:47.710
> 
> 标签：php, regex, codeigniter, helper

我想在数组值 $stopwords 前面连接字符“/\b”，并在后面连接字符“\b/i”。

**我的帮手**

```
function addRegex_SW($arrayIn = array()){
    $arrayOut = array();
    $count = count($arrayIn);   
    for ($i = 1; $i <= $count; $i++)
    {
       $char1 = "/\b"; 
       $char2 = "\b/i";
       $arrayOut[$i] = $char1.$arrayIn[$i].$char2;
       //echo $arrayOut[$i];
    }
return $arrayOut;
} 
```

**我的观点**

```
$stopwords_Regex = addRegex_SW($stopwords); 
```

然后当我运行代码时

```
A PHP Error was encountered
Severity: Notice
Message: Undefined offset: 317
Filename: helpers/addRegex_helper.php
Line Number: 11 
```

是哪条线

```
$arrayOut[$i] = $char1.$arrayIn[$i].$char2; 
```

我确定我有谷歌它，但我仍然没有得到它。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:43:41.723

你的`for`-loop 是*一个接一个*

改变： `for ($i = 1; $i <= $count; $i++)`

至： `for ($i = 0; $i < $count; $i++)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:42:09.913

你不需要使用 for，使用 foreach 代替：

```
function addRegex_SW($arrayIn = array()) {
    $arrayOut = array();
    foreach ($arrayIn as $value) {
        $arrayOut[] = '/\b' . $value . '\b/i';
    }
    return $arrayOut;
} 
```

# c# - Mocking a service call the object returns null

> ID：16041308
> 
> 赞同：3
> 
> 时间：2013-04-16T15:40:54.323
> 
> 标签：c#, asp.net-mvc, unit-testing, unity-container, moq

Hello :) I'm a novice in using Moq framework with Unit and I have an issue in which, as I will demonstrate below, I'm trying to Moq a service call on a MVC Controller which takes Session objects as parameters. On my Unit test framework I create my object, set it up on the service call and I'm hoping to have it as the result of the response of the test to then Assert.

Problem: I tried to Mock HttpContext based on other solutions, which works because on the Controller side I get the values that I set on my Unit Test but upon SETUP of the service call (I have "Mock(MockBehavior.Strict);") when the debugger reaches the controller, upon the actual call I get an error saying that no SETUP was defined. Or if I take out the "MockBehavior.Strict", the "model" variable on the controller is always returning null and not the object I set it on the Unit Test class.

So here is my simple unit class,

```
[TestClass]
public class SearchControllerTest
{
   #region Variables

   Mock<ControllerContext> _controllerContext;
   Mock<ISearchService> _serviceMock;
   SearchController _controller;

   #endregion

   [TestInitialize]
   public void SetUp()
   {
       // Arrange
       _controllerContext = new Mock<ControllerContext>();
       _serviceMock = new Mock<ISearchService>(MockBehavior.Strict);
       _controller = new SearchController(_serviceMock.Object);
   }

   #region Success Test Cases

   [TestMethod]
   public void SearchListTest()
   {
       string pid = "val1";
       string oid = "val2";
       string lang = "val3";
       string tid = "val4";
       string pattern = "val5";

       DocumentViewModel docModel = SetDocumentViewModel();

       // Bypass
       //_controllerContext.Setup(x => x.HttpContext.Session).Returns(_session.Object);

       _controllerContext.SetupGet(p => p.HttpContext.Session["ProjectId"]).Returns("X");
       _controllerContext.SetupGet(p => p.HttpContext.Session["OverlayId"]).Returns(string.Empty);
       _controllerContext.SetupGet(p => p.HttpContext.Session["ProjectLanguage"]).Returns(string.Empty);
       _controllerContext.SetupGet(p => p.HttpContext.Session["NodeId"]).Returns(string.Empty);
       _controller.ControllerContext = _controllerContext.Object;

       _serviceMock.Setup(x => x.FullTextSearchForAll(pid, oid, lang, tid, pattern)).Returns(docModel);

       // Act
       var result = _controller.SearchList(pid, oid, lang, tid, pattern) as PartialViewResult;

       // Assert
       Assert.AreEqual("#0Id", ((DocumentViewModel)result.Model).Rows[0].UID);
    }

    #endregion

    #region Private

    DocumentViewModel SetDocumentViewModel() 
    {
        return new DocumentViewModel()
        {
            Columns = new Service.QueryResultColumn[]
            {
                new Service.QueryResultColumn
                {
                     Alignment = ServiceConstants.Left, 
                     Index = 0, 
                     Visible = true, 
                     Width = 3, 
                     Header = ServiceConstants.Label
                }
            },
            Properties = new DocumentsInfo[]
            {
                new DocumentsInfo()
                {
                    IsCheckInAllowed = true,
                    IsCheckoutAllowed = true,
                    IsDocumentCheckedOut = false,
                    IsPlaceHolder = false,
                    IsUndoCheckoutAllowed = true,
                    lastVersionUid = "123"
                }
            },
            Rows = new Service.QueryResultRow[]
            {
                new Service.QueryResultRow()
                {
                    Children = null,
                    ExtensionData = null,
                    ImageSource = "Source",
                    Items = new Service.QueryResultItem[]
                    {
                        new Service.QueryResultItem()
                        {
                            ExtensionData = null,
                            ImageSource = "Src",
                            Text = "Txt",
                            UID = "uid"
                        }
                    },
                    UID = "#0Id"
                }
            }
        };
     }

    #endregion
 } 
```

And here's my Controller,

```
 public class SearchController : Controller
 {
    ISearchService _searchService;

    public SearchController(ISearchService searchService) // I use UnityContainer
    {
        _searchService = searchService;
    }

    public PartialViewResult SearchList(string pid, string oid, string lang, string tid, string pattern)
    {
        ViewBag.ProjectId = pid;
        ViewBag.OverlayId = oid;
        ViewBag.ProjectLanguage = lang;
        ViewBag.NodeId = tid;
        ViewBag.Pattern = pattern;

        DocumentViewModel model = null;

        try
        {
            model = _searchService.FullTextSearchForAll(
                Session["ProjectId"] as string,
                Session["OverlayId"] as string,
                Session["ProjectLanguage"] as string,
                Session["ProjectId"] as string,
                pattern
            );
        }
        catch (Exception ex)
        {
            ViewBag.Error = ex.Message;
        }

        // Ajax.OnError() will handle the Custom Exception Error Message
        if (ViewBag.Error != null)
            throw new CustomtException((String)ViewBag.Error);

        return PartialView(model);
    }
 } 
```

Tank your for your patience and time. Have a nice day :)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T15:49:15.807

You've setup params in method with some values:

```
_serviceMock.Setup(x => x.FullTextSearchForAll(pid, oid, lang, tid, pattern)).Returns(docModel); 
```

and trying to give Session variable as empty string

```
_controllerContext.SetupGet(p => p.HttpContext.Session["OverlayId"]).Returns(string.Empty); 
```

it will never match. try setup service with It.IsAny() like

```
_serviceMock.Setup(x => x.FullTextSearchForAll(It.IsAny<string>(), It.IsAny<string>(), It.IsAny<string>(), It.IsAny<string>(), It.IsAny<string>())).Returns(docModel); 
```

And if it will shout change session setup

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:51:31.987

I recommend creating consts for ProjectId, et. al., and then using them to setup your mocks, verify calls, and set the state of any objects. This ensures the value you expect (and only the value you expect) is used throughout.

# android - 无法使用 Facebook Graph API 读取用户喜欢的页面

> ID：16041309
> 
> 赞同：2
> 
> 时间：2013-04-16T15:40:55.283
> 
> 标签：android, facebook-graph-api

我是 android 上 facebook 开发的新手。我的目标是获取用户喜欢的页面名称列表。我正在为此使用休闲代码。

我想确保我使用的是最新的 facebook sdk，并且我使用的所有类或方法都没有被弃用

```
 ArrayList<String> permissions = new ArrayList<String>();
    permissions.add("user_likes");
    loginButton.clearPermissions();
    loginButton.setReadPermissions(permissions);
    loginButton.setUserInfoChangedCallback(new LoginButton.UserInfoChangedCallback() {

        @Override
        public void onUserInfoFetched(GraphUser user) {
            if(user != null)
            {
                Log.d(TAG,"User login successful:"+user.getProperty("favorite_teams"));
                Session session = Session.getActiveSession();
                if(session !=null && session.isOpened())
                {
                    if(session.getPermissions().contains("user_likes"))
                    {
                        requestForPageLikes = new Request(session, "https://graph.facebook.com/me/likes");
                        requestForPageLikes.setCallback(new Request.Callback() {

                            @Override
                            public void onCompleted(Response response) {

                                GraphObject go  = response.getGraphObject();
                                JSONObject  jso = go.getInnerJSONObject();
                                Log.d(TAG,"Facebook response:"+jso.toString());

                            }
                        });
                        Request.executeAndWait(requestForPageLikes);
                    }
                }
            }
        }
    } 
```

上述请求工作正常，我得到的响应代码为 200，没关系。

但日志消息打印为

Facebook 回复：{"id":"https://graph.facebook.com/me/likes"}

我确信有用户喜欢的页面，并且我的应用程序在 developers.facebook.com 中配置得很好，正如我们在上面的代码中看到的那样，我拥有阅读类似页面所需的权限 user_likes。

我被这个问题严重困扰。任何帮助将非常感激。

# android - 如何获取 ContextMenu Switch 语句的不同视图的值

> ID：16041317
> 
> 赞同：0
> 
> 时间：2013-04-16T15:41:18.097
> 
> 标签：android, listview, view, android-contextmenu

我有一个`Activity`使用两个`ContextMenu`的。一种是长按 a 中的行`listView`。另一个，如果你点击一个`ImageView`. 你只能有一种`onCreateContextMenu()`方法，我需要根据`ContextMenu`我打开的方法做不同的事情。

在 上`ListView`，我需要得到一个`TextView`- 但`null`如果用户点击`ImageView`菜单，则会返回。所以我需要一个`switch`声明来将两者分开。

当我登录`View v`进入时`ContextMenu`，我得到了这个：

```
// For the ImageView
04-16 08:36:20.687: D/View:(7152): android.widget.ImageView{426295e0 V.ED..CL ...P.... 20,25-220,225 #7f070093 app:id/ibPP}

//For the ListView
04-16 08:36:20.687: D/View:(7152): android.widget.ListView{425edcb0 VFED..CL .F...... 10,16-710,1134 #102000a android:id/list} 
```

所以当我这样做时：

```
switch (v.getId()) {
        case ??????: { 
```

我应该对这两种不同的案例陈述提出什么看法？

**更新**。这是我的完整代码。我选择了`if`而不是`switch`：

```
 @Override
    public void onCreateContextMenu(ContextMenu menu, View v,
            ContextMenuInfo menuInfo) {
    if (v.getId() == android.R.id.list) {
        menu.setHeaderTitle("Available Actions");

        AdapterContextMenuInfo info = (AdapterContextMenuInfo) menuInfo;

        int position = info.position;
        ListView lv = (ListView) v;
        int firstVisible = lv.getFirstVisiblePosition();
        View rowView = lv.getChildAt(position - firstVisible);

        reviewWords = ((TextView) rowView.findViewById(R.id.labelComment))
                .getText().toString(); // Crashes here when click ImageView

        menu.add(2, 1, 0, "Edit");
        menu.add(2, 2, 0, "Delete");
        menu.add(2, 3, 0, "Share");

    } else if (v.getId() == R.id.ibPP) {

        MenuInflater inflater = getActivity().getMenuInflater();

        if (userName.equals(Rateit.username)) {
            inflater.inflate(R.menu.profile_pic, menu);
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:43:18.843

显然，imageView 是`R.id.ibPP`，listView 是`android.R.id.list`

# angularjs - 控制器的angularjs缩小问题

> ID：16041318
> 
> 赞同：4
> 
> 时间：2013-04-16T15:41:18.507
> 
> 标签：angularjs, bundling-and-minification

这是我的控制器：

```
angular.module('domiciliations').controller('mandatsCtrl', ['$scope', 'Domiciliation', 'logger', function ($scope, Domiciliation, logger) {
    $scope.mandats = Domiciliation.query();

    $scope.fullName = function () {
        return this.Person ? 'test' : 'test2'
    }

    $scope.isNextDisabled = function () {
        return false;
    }

    $scope.isPrevDisabled = function () {
        return true;
    }

    $scope.next = function () {
        logger.info("test");
    }
}]); 
```

缩小时，我收到一个错误：

```
Error: Unknown provider: nProvider <- n 
```

现在，如果我在控制器之后包含以下行，那么它可以工作：

```
mandatsCtrl.$inject = ['$scope', 'Domiciliation', 'logger']; 
```

我认为在控制器函数中声明数组类型的全部意义在于避免使用 $inject .... 我错过了什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T16:57:29.553

如果您要缩小控制器的 JavaScript 代码，它的所有函数参数也会被缩小，并且依赖注入器将无法正确识别服务。有两种方法可以处理角度缩小

```
1)Just assign an array with service identifier strings into the $inject property of the controller function
 mandatsCtrl.$inject = ['$scope', 'Domiciliation', 'logger'];

2) Using bracketnotation
var mandatsCtrl= ['$scope', 'Domiciliation','logger' function($scope, $Domiciliation,logger) { /* constructor body */ }]; 
```

[http://docs.angularjs.org/tutorial/step_05](http://docs.angularjs.org/tutorial/step_05)

# xml - 为 Google importXML 函数编写 XPath 查询

> ID：16041319
> 
> 赞同：0
> 
> 时间：2013-04-16T15:41:22.947
> 
> 标签：xml, xpath, import, google-sheets

我正在尝试查找用于 google 电子表格（importXML 函数）的 xpath 查询，以获取以下 HTML 代码中包含的以下信息：“ThisIsCompanyName”和“123456”。

```
<tr valign="top" class="small"> 
                                <th width="18%" bgcolor="#EFEFEF" id="name" class="commonFontSize"> 
                                  <div align="right">Company Name</div></th>
                                <td width="33%" bgcolor="#FFFFFF" headers="name" align="left" style="padding-left:3px;"> 
                                    <span id="ctl00_ContentPlaceHolder1_lblTblCarrierName" class="oneSmallFontSize">ThisIsCompanyName</span>    
                                </td>
                                <th width="20%" bgcolor="#EFEFEF" id="dot" class="commonFontSize"> 
                                  <div align="right">U.S. DOT Number</div></th>
                                <td width="29%" bgcolor="#FFFFFF" headers="dot" align="left" style="padding-left:3px;"> 
                                    <span id="ctl00_ContentPlaceHolder1_lblTblDOTNumber" class="oneSmallFontSize">123456</span>  
                                </td>
                              </tr> 
```

使用 Chrome，如果我使用“检查元素”功能，然后“复制 xpath”，我会得到以下内容......

```
 //*[@id="ctl00_ContentPlaceHolder1_lblTblCarrierName"]
    //*[@id="ctl00_ContentPlaceHolder1_lblTblDOTNumber"] 
```

但这些并没有产生我需要的结果。我对编程的了解为零，只是想学习一些基本的网络抓取技术。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:51:44.020

尝试这个

```
//span[@id='ctl00_ContentPlaceHolder1_lblTblCarrierName']/text()
//span[@id='ctl00_ContentPlaceHolder1_lblTblDOTNumber']/text() 
```

如果您使用此 xpath，它将返回“ThisIsCompanyName123456”

```
//span[@class='oneSmallFontSize']/text() 
```

# ios - UITableView 从右侧出现在 UIView

> ID：16041330
> 
> 赞同：0
> 
> 时间：2013-04-16T15:41:45.897
> 
> 标签：ios, uiview, uiviewanimation

我正在尝试制作我的第一个动画。目前我正在使用`animateWithDuration:animations`and `transitionFromView:toView:duration:options:completion:`，但我不确定我是否在“正确的页面”中。

我想要做的是创建这样的动画：在左上角，用户点击按钮并`UITableView`从屏幕左侧到达。

我从未在 iOS SDK 中做过任何动画，因此将不胜感激：StackOverflow 中的类似问题、一些教程等。我不知道应该从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:11:10.040

假设您有一个 UITableView 作为 UIViewController 视图的子视图。

首先，在动画之前，将 UITableView 设置在屏幕外，使用 center 或 frame 属性：

```
CGRect screenFrame = [[UIScreen mainScreen] applicationFrame];
self.theTableView.frame = CGRectMake(-screenFrame.size.width, 0.0, screenFrame.size.width, screenFrame.size.height); 
```

然后，完成动画代码：

```
[UIView animateWithDuration:0.5
                      delay:0
                    options:UIViewAnimationOptionCurveEaseInOut
                 animations:^{
                         self.theTableView.frame = CGRectMake(0.0, 0.0, screenFrame.size.width, screenFrame.size.height);
                     }
                     completion:nil]; 
```

希望对您有所帮助！:D

# regex - 访问 vbscript 正则表达式 无效的过程调用或参数

> ID：16041334
> 
> 赞同：0
> 
> 时间：2013-04-16T15:41:54.837
> 
> 标签：regex, ms-access, vba

我有一个带有备注字段的访问表，其中使用表单输入数据，在用户输入新数据之前，以 (Apr-01) 的形式添加日期。保存后，新数据将添加到顶部。然后我有一个如下函数进入该字段并获取最新数据，因此它将位于顶部：

示例数据

```
Apr-01 - new data
Mar-09 - old data
etc 
```

获取最新信息的功能：

```
Public Function GetLatest(text As String) As String
    If (IsNull(text)) Then
        GetLatest = ""
    Else
        Set objRegExpr = New regexp

        objRegExpr.Pattern = "([A-Za-z]{3}-[0-9]{2})"
        objRegExpr.Global = True
        objRegExpr.IgnoreCase = True

        Set colMatches = objRegExpr.Execute(text)

        del = colMatches(1)
        txt = Split(text, del)
        GetLatest = txt(0)
    End If
End Function 
```

在即时窗口中运行这个函数，我得到了预期的结果，但是当我在查询中运行相同的函数时，我`invalid procedure or argument`指向这条线`del = colMatches(1)`。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:02:49.780

要提取您捕获的内容，您需要索引 0 而不是 1 的第一项；

```
del = colMatches.Item(0) 
```

或者避免使用正则表达式对象的替代方法；

```
if ucase$(text) like "[A-Z][A-Z][A-Z]-[0-9][0-9]*" then GetLatest = left$(text,6) 
```

# maven - 禁用重新部署时如何发布多个配置文件项目

> ID：16041336
> 
> 赞同：1
> 
> 时间：2013-04-16T15:41:59.933
> 
> 标签：maven, maven-2, maven-3, nexus

**问题**：当在 Nexus 上禁用重新部署时，我应该如何发布具有 2 个专有配置文件的 maven 项目？

**示例（已编辑）**：我有一个 Maven 项目 MyArtifact，在`pom.xml`（P1 和 P2）中有 2 个配置文件，它生成 2 个不同的耳朵。每个配置文件都将 配置`maven-ear-plugin`为包含不同的模块并自动生成`application.xml`. 生成的工件是`MyArtifact-1.0-P1.ear`（2 个战争模块）和`MyArtifact-1.0-P2.ear`（3 个战争模块）。

**问题1（重新部署到nexus）**：

1.  当我执行“ `mvn deploy -P P1`”时，一切正常（war 和 pom 部署到 Nexus）
2.  当我执行“ `mvn deploy -P P2`”错误！Nexus 抱怨重新部署 pom.xml。

**问题2（maven-release-plugin）**：

当使用`maven-release-plugin`to release 来发布多个配置文件时，maven 会做很多事情（签出和标记 CSM、更新 pom 版本、转向标记、提交到 CSM 等）。至少必须为每个配置文件执行重新发布/重新标记既不高效也不实用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T15:58:28.000

简单的回答。这是不可能的。问题是基于在这种关系中使用了邪恶的配置文件。

此类事情的解决方案是创建一个 Maven 构建，它能够生成两个作为此构建结果的 war 文件。

我假设您对不同的环境有不同的属性，如下所示：

```
.
|-- pom.xml
`-- src
    |-- main
    |   |-- java
    |   |-- resources
    |   |-- environment
    |   |   |-- test
    |   |   |   `-- database.properties
    |   |   |-- qa
    |   |   |   `-- database.properties
    |   |   `-- production
    |   |       `-- database.properties
    |   `-- webapp 
```

这意味着您需要在您的情况下创建两个仅在属性文件内容上有所不同的战争文件。在上面有三个环境。

您需要的是每个环境的程序集描述符，例如：

```
<assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.0 http://maven.apache.org/xsd/assembly-1.1.0.xsd">

  <id>test</id>
  <formats>
    <format>war</format>
  </formats>
  <includeBaseDirectory>false</includeBaseDirectory>
  <dependencySets>
    <dependencySet>
      <unpack>true</unpack>
      <useProjectArtifact>true</useProjectArtifact>
    </dependencySet>
  </dependencySets>
  <fileSets>
    <fileSet>
      <outputDirectory>WEB-INF</outputDirectory>
      <directory>${basedir}/src/main/environment/test/</directory>
      <includes>
        <include>**</include>
      </includes>
    </fileSet>
  </fileSets>
</assembly> 
```

在这种情况下，maven-assembly-plugin 的适当执行如下：

```
 <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-assembly-plugin</artifactId>
    <executions>
      <execution>
        <id>test</id>
        <phase>package</phase>
        <goals>
          <goal>single</goal>
        </goals>
        <configuration>
          <descriptors>
            <descriptor>${project.basedir}/src/main/assembly/test.xml</descriptor>
          </descriptors>
        </configuration>
      </execution>
      <execution>
        <id>qa</id>
        <phase>package</phase>
        <goals>
          <goal>single</goal>
        </goals>
        <configuration>
          <descriptors>
            <descriptor>${project.basedir}/src/main/assembly/qa.xml</descriptor>
          </descriptors>
        </configuration>
      </execution>
      <execution>
        <id>production</id>
        <phase>package</phase>
        <goals>
          <goal>single</goal>
        </goals>
        <configuration>
          <descriptors>
            <descriptor>${project.basedir}/src/main/assembly/production.xml</descriptor>
          </descriptors>
        </configuration>
      </execution>
    </executions>
  </plugin> 
```

这将导致通过以下方式运行一次 maven：

```
mvn package 
```

这会产生三个不同的战争文件，其中包含不同的属性文件或具有不同内容的文件。这是没有配置文件的解决方案，它可以完美运行，并将部署三个不同的 war 文件，命名如下：

1.  artifactId-version-test.war
2.  artifactId-version-qa.war
3.  artifactId-version-production.war

这就是您解决问题所需的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-12T08:04:26.963

是的！

为了使用配置文件，我正在使用 maven`<executions>`功能：为我拥有的每个配置文件执行 1 次。**每次执行都必须在不同的工作文件夹**中生成资源。每个工件都有**不同的分类器**。部署 maven 时会找到 3 个工件（pom、ear、ear）并将它们部署到 Nexus 上。

下面是示例。请让我知道您有任何问题：

```
<plugin>
    <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-ear-plugin</artifactId>
        <executions>
            <execution>
                <!-- Disable default execution -->
                <id>default-ear</id>
                <phase>none</phase>
            </execution>
            <execution>
                <!-- Disable default execution -->
                <id>default-generate-application-xml</id>
                <phase>none</phase>
            </execution>
            <execution>
                <!-- execution for profile P1 -->
                <id>P1</id>
                <goals>
                    <goal>ear</goal>
                    <goal>generate-application-xml</goal>
                </goals>
                <configuration>
                    <!-- Different working directory for each profile (very important) -->
                    <workDirectory>target/P1</workDirectory>
                    <defaultLibBundleDir>APP-INF/lib</defaultLibBundleDir>
                    <generateApplicationXml>true</generateApplicationXml>
                    <displayName>MyArtifactLibraryP1</displayName>
                    <!-- Different classifier for each profile (very important) -->
                    <classifier>P1</classifier>
                    <modules>
                        <jarModule>
                            <groupId>com.example</groupId>
                            <artifactId>MyWar1</artifactId>
                            <includeInApplicationXml>true</includeInApplicationXml>
                        </jarModule>
                        <jarModule>
                            <groupId>com.example</groupId>
                            <artifactId>MyWar2</artifactId>
                            <includeInApplicationXml>true</includeInApplicationXml>
                        </jarModule>
                    </modules>
                </configuration>
            </execution>
            <execution>
                <id>P2</id>
                <goals>
                    <goal>ear</goal>
                    <goal>generate-application-xml</goal>
                </goals>
                <configuration>
                    <workDirectory>target/P2</workDirectory>
                    <defaultLibBundleDir>APP-INF/lib</defaultLibBundleDir>
                    <generateApplicationXml>true</generateApplicationXml>
                    <displayName>MyArtifactLibraryP2</displayName>
                    <classifier>P2</classifier>
                    <modules>
                        <jarModule>
                            <groupId>com.example</groupId>
                            <artifactId>MyWar1</artifactId>
                            <includeInApplicationXml>true</includeInApplicationXml>
                        </jarModule>
                        <jarModule>
                            <groupId>com.example</groupId>
                            <artifactId>MyWar2</artifactId>
                            <includeInApplicationXml>true</includeInApplicationXml>
                        </jarModule>
                        <jarModule>
                            <groupId>com.example</groupId>
                            <artifactId>MyWar3</artifactId>
                            <includeInApplicationXml>true</includeInApplicationXml>
                        </jarModule>
                    </modules>
                </configuration>
            </execution>
        </executions>
    </plugin> 
```

# node.js - 从导出的函数回调中读取结果

> ID：16041341
> 
> 赞同：1
> 
> 时间：2013-04-16T15:42:08.067
> 
> 标签：node.js, callback, mongoose

我找不到这个简单问题的解决方案：我想调用从外部 .js 导出的函数并保存输出。我做了以下事情：

数据库.js

```
function findMessages () {
    allMsg = mongoose.model('allMsg');
    allMsg.find(function (err, message) {
       console.log('here is ok');
       return message;
    });
};

exports.returnMessages = findMessages; 
```

应用程序.js

```
var db = require( './db' );

app.get('/message', function(req, res){
  var messages = db.returnMessages();
  console.log('Nothing here (undefined): ' + messages);
}); 
```

如何阅读 app.js 中的消息？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T15:50:08.873

简单的回答：你不能。这不是回调的工作方式。

您需要更改`findMessages()`以接受回调函数。

```
function findMessages (callback) {
    allMsg = mongoose.model('allMsg');
    allMsg.find(function (err, message) {
       callback(message)
    });
};

// app.js
app.get('/message', function(req, res) {
    db.returnMessages(function(messages) {
        console.log(messages);
    });
}); 
```

# android - 在 Eclipse 中更改 api 导致 R 文件-android 上的错误

> ID：16041342
> 
> 赞同：2
> 
> 时间：2013-04-16T15:42:19.337
> 
> 标签：android

我尝试将 api 从 4.2 更改为 2.2（api 8）。
我与 Eclipse 一起工作。2.2 已安装，但在我更改后，我得到了 R 文件的那个元素 unrecognized 。例如，我在 android.R.id.home 上收到“无法解析主页或不是字段”错误。

是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T15:44:26.300

错误清楚地说

> home 无法解析或不是字段”android.R.id.home 上的错误。

您已导入`android.R.java`与 不同的`R.java`，因此请尝试删除导入，然后清理您的项目并确保您已导入 yourpackagename.R.java

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T15:49:21.860

`android.R.id.home`是一个框架实习生 ID，用于 ActionBars 向上按钮。API 2.2 不支持 ActionBar → Id 不可用。

您必须针对 HC 或更高版本构建它才能使用它。

[这](https://github.com/android/platform_frameworks_base/blob/master/core/res/res/values/ids.xml#L72)是 API 17 框架的 Ids 文件。您可以在线查看 home Id 72。另一方面，
[这](https://github.com/android/platform_frameworks_base/blob/android-2.3.3_r1/core/res/res/values/ids.xml)是 API 10 的 Ids 文件，它没有 Id home。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T15:44:51.873

在eclipse中清理或重建您的项目..它将再次生成R文件这应该可以解决您的问题

# ruby-on-rails - 复杂算法的计算应该在哪里进行

> ID：16041354
> 
> 赞同：1
> 
> 时间：2013-04-16T15:43:02.660
> 
> 标签：ruby-on-rails, hadoop, scalability, mahout

**背景：**
我是一名软件工程专业的学生，​​我正在检查推荐系统的几种算法。其中一种算法，协同过滤有很多循环，它必须遍历所有用户和每个用户他对电影或其他可评分项目的所有评分。我正在考虑在 ruby​​ 上为 Rails 应用程序实现它。

关键是有很多数据需要处理，所以：

1.  这应该在数据库中完成吗？使用常规查询？使用 PL/SQL 或类似的东西（测试 dbs 非常耗时且困难，特别是对于这类算法）

2.  我应该做一个缓存算法结果的后台工作吗？（如果是这样，数据是在内存上处理的，并且如果有数百万用户，这个规模有多好）

3.  我应该在每次有请求或每 x 个请求时运行算法吗？（同样，数据在内存中处理）

**问题：**
我知道有些东西可以做到这一点，比如 Apache Mahout，但它们依赖 Hadoop 进行扩展。还有其他出路吗？ruby 是否有 Mahout 或机器学习等价物，如果有，计算在哪里进行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-19T08:47:09.443

以下是我对每种方法的想法：

1.  不，不应该。有些计算在您的数据库中运行会快得多，有些则不会。但是，准确测试应该在您的数据库中运行哪些计算将是困难且耗时的，并且您会正确体验到算法的某些部分在 postgreSQL 或您使用的任何东西中都很慢。更重要的是：这不是运行逻辑的正确位置，正如您自己所说，这将很难测试，而且总体上是一种不好的做法。每次数据库必须计算算法时，它也会影响整体请求的性能。此外，数据库仍然会使用大量内存来处理这个，所以这不是一个优势。

2.  迄今为止最好的解决方案。有关更多说明，请参见下文。

3.  这是一个比第一个更好的解决方案。但是，这意味着您的应用程序性能将非常不稳定。有时所有资源对于正常请求都是免费的，有时您会在计算中使用所有资源。

选项 2 是最好的解决方案，因为这不会影响应用程序其余部分的性能，并且由于它是独立工作的，因此更容易扩展。例如，如果您遇到工作人员跟不上进度，您可以添加更多正在运行的进程。

更重要的是，您将能够在单独的服务器上运行后台进程，从而轻松监控内存和资源使用情况，并根据需要扩展您的服务器。

即使对于实时更新，后台作业也是最好的解决方案（当然，如果计算不足以在请求中完成）。您可以创建一个“高优先级”队列，该队列有足够的资源几乎总是空的。如果您需要通过重新加载向用户显示结果，则必须在后台作业完成后添加某种推送通知。然后，此通知可以通过 javascript 触发页面上的更新（您还可以查看 rails 4 的新[直播](http://blog.phusion.nl/2012/08/03/why-rails-4-live-streaming-is-a-big-deal/)功能）。

我会推荐类似[Sidekiq](https://github.com/mperham/sidekiq)和 Redis 的东西。然后，您可以将结果缓存在 memcache 中，或者您可以每次重新计算结果，这实际上取决于您需要多久计算一次。但是，使用此解决方案，如果需要，设置稳定的缓存会容易得多。

在我工作的地方，我们有一个应用程序运行一些繁重的查询，并进行大量这样的计算。每天晚上，这些作业都会排队，然后在接下来的几个小时内在隔离的服务器上运行。这可以很好地扩展，并且也很容易使用新遗物进行监控。

希望这会有所帮助，并且有意义（我知道我的英语并不完美），但请随时询问我是否误解了某些内容或您有更多问题。

# php - 如何将 XML 文件从服务器动态保存到本地机器？

> ID：16041355
> 
> 赞同：0
> 
> 时间：2013-04-16T15:43:03.553
> 
> 标签：php, javascript, html, ajax

请帮帮我。我的错误在哪里？我在 IIS 服务器上有很多 XML 文件。单击按钮链接到 XML 后，进入 JS 文件。JS 发送链接到 PHP 文件。PHP 必须显示保存对话框才能保存此链接。见代码：

JS：

```
function showAl(url)
  {
    alert(url);
    var ajax = getRequest();
    ajax.onreadystatechange = function()
    {
        if(ajax.readyState == 4)
        {           
            ...
        }
    }  

    ajax.open("POST", "/do_query.php", true);
    var data = 'info='+url;
    ajax.send(data);
  } 
```

PHP：

```
<?php
  if (isset($_POST['info'])) 
  {
    $info = $_POST['info'];

    header('Content-Type: application/xml;');
    header('Content-Disposition: attachment; filename=file.xml;');

    readfile(str_replace(" ", "%20", $info), false);    
  }
?> 
```

提前致谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:05:50.617

下载文件的三种简单方法：

1.  好旧的形式

    ```
    <form id="the-form" action="/do_query.php" method="post">
        <input type="hidden" name="info" value="test">
        <input type="Submit" value="Download with regular form">
    </form> 
    ```

2.  使用 JavaScript 提交良好的旧表单

    ```
    <script type="text/javascript">
    function download(){
        document.getElementById("the-form").submit();
    }
    </script>
    <input type="Submit" value="Download with JavaScript" onclick="download()"> 
    ```

3.  切换到 GET（需要更改`do_query.php`）：

    ```
    <a href="/do_query.php?info=test">Download with link</a> 
    ```

AJAX 的问题在于它在当前（HTML）页面上运行。它可以操纵页面 HTML 或重定向到另一个位置，但它不能发送自定义 HTTP 响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:58:44.097

使用 AJAX 时不能提示用户保存文件，您需要将浏览器窗口指向要下载的文件的 URL。这也意味着您将需要使用 GET 方法而不是 POST 方法来传输文件。

试试这个：

JS：

```
function showAl(url)
{
    window.location.href = '/do_query.php?info=' + url;
} 
```

PHP：

```
if (isset($_GET['info'])) 
{
    $info = $_GET['info'];

    // ... 
```

这应该会提示用户下载文件。

# jquery - 如何在独立的 HTML 页面中使用 Select2 jQuery 插件？

> ID：16041357
> 
> 赞同：0
> 
> 时间：2013-04-16T15:43:11.953
> 
> 标签：jquery, html, jquery-plugins, jquery-select2

我之前在我的 Rails 应用程序中使用过 select2 jQuery 插件，这很好。但是，我需要在独立的 HTML 页面中使用它。我正在使用来自谷歌的 jQuery 源代码：

```
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js'></script> 
```

但是，为了在 HTML 页面中使用 select2 jQuery 插件，我需要从在线链接中指定 src。我在任何地方都找不到这样的链接。（可能是我很笨）。所以，为了解决我将 select2 文件夹放在我的保管箱文件夹中并使用类似这样的东西来使用 select2 插件：

```
<script src="https://www.dropbox.com/s/0kizh5ant6aomum/select2.js?dl=1" type="text/javascript"></script>
<link href="https://www.dropbox.com/s/r8c0pw5r7t791gh/select2.css?dl=1" rel="stylesheet"/> 
```

这对我来说似乎不是一个好的解决方案。此外，一些图像无法正常工作，在我的 javascript 控制台中，我可以看到一些类似这样的错误：

```
GET https://dl.dropboxusercontent.com/s/r8c0pw5r7t791gh/select2.png 403 (FORBIDDEN) Sample%20HTML%20File.html:55
GET https://dl.dropboxusercontent.com/s/r8c0pw5r7t791gh/select2-spinner.gif 403 (FORBIDDEN) jquery.min.js:4
GET https://dl.dropboxusercontent.com/s/r8c0pw5r7t791gh/select2.png 403 (FORBIDDEN) jquery.min.js:4 
```

那么，我应该怎么做才能为我的问题找到一个干净的解决方案？在单个独立的 HTML 页面中使用 select2 jQuery 插件的最佳方式是什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T15:54:59.100

在官方 github 站点中查找文件：[**JS File**](http://ivaynberg.github.io/select2/select2-master/select2.js) & [**CSS File**](http://ivaynberg.github.com/select2/select2-master/select2.css)。

在这种情况下，您可以在示例/演示页面上使用 Firefox 的 Firebug 的 Chrome 开发人员工具来查找实际使用的文件并避免出现问题...

# sql - 将记录从一个表复制到另一个查询给出错误 sql

> ID：16041361
> 
> 赞同：0
> 
> 时间：2013-04-16T15:43:21.460
> 
> 标签：sql, sql-server-2008

使用以下查询将记录从一个表复制到另一个表，但出现错误

```
insert into table1 (datestamp)
select datestamp
from table2
where table1.datestamp is null 
```

我想将表 2 中的日期戳记录复制到表 1 中，其中表 1 中的日期戳为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:46:43.977

你是这个意思吗？

```
insert into table1 (datestamp)
select datestamp
from table2
where table2.datestamp is null 
```

您在子句中引用 table1 日期戳，`where`这是不允许的。

也许你真的想要一个`update`. 如果是这样，您需要一种方法来链接这两个表：

```
update t1
    set datestamp = t2.datestamp
from table1 t1 join
     table2 t2
     on t1.id = t2.id
where t1.datestamp is null 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:53:45.013

我假设这些表是通过一些唯一的 ID 绑定在一起的？我们将调用该 tableID。

```
UPDATE table1 t1, table2 t2
SET t1.datestamp = t2.datestamp
WHERE t1.datestamp IS NULL
AND t1.tableID = t2.tableID 
```

# java - 在骆驼上通过 netty 发送大交换

> ID：16041369
> 
> 赞同：0
> 
> 时间：2013-04-16T15:43:41.703
> 
> 标签：java, netty, apache-camel

尝试在骆驼中使用 netty 编写大型传输时出现 TooLongFrameException 异常。如果不进行一些认真的重构，我就无法真正缩小交换的规模。

作为一种解决方法，我明确指定了一个具有更大估计长度的 ObjectEncoder。但是，它不会自动将对象转换回其本机形式。我必须在骆驼路线上调用 convertBodyTo()，这需要事先知道类的类型。

这是一个例子：

```
public static void main(String[] args) throws Exception{
    JndiContext registry=new JndiContext();

    //Workaround #1:  explicitly specify the encoder so we can increase the estinatedLength.
    registry.bind("encoder", new ObjectEncoder(99999999));
    CamelContext context=new DefaultCamelContext(registry);
    context.addRoutes(new RouteBuilder() {        
        @Override
        public void configure() throws Exception {
            //This is the receiving end of the large data.
            from("netty:tcp://0.0.0.0:9002?transferExchange=true&encoder=#encoder")
                //At this point the body is a BigEndianHeapChannelBuffer not a String
                .to("log:nettyin?level=INFO")
                .bean(System.out, "println")         

                //Workaround #2:  explicitly convert the body to the expected class.  What do you do if you want several possible classes?
                .convertBodyTo(String.class)

                //Now we have a String as the body.
                .to("log:nettyin.string?level=INFO")
                .bean(System.out, "println");            

            //Use this endpoint to send large data.
            from("direct:start")
                .to("log:start?level=INFO")
                .to("netty:tcp://localhost:9002?transferExchange=true&encoder=#encoder");
        }
    });
    context.start();
    final ProducerTemplate template = context.createProducerTemplate();
    String s=org.apache.commons.lang.StringUtils.repeat("x", 1133461);
    template.sendBody("direct:start", s);                
    context.stop();
} 
```

有没有办法不显式调用 convertBodyTo()？另外我如何处理泛型？例如 convertBodyTo(List.class) 不适用于 List<String>。我得到一个这样的例外：

```
原因：org.apache.camel.NoTypeConversionAvailableException：没有类型转换器可用于从类型：org.jboss.netty.buffer.BigEndianHeapChannelBuffer 转换为所需类型：java.util.ArrayList，值为 BigEndianHeapChannelBuffer（ridx=0，widx=422 , 上限 = 422)
    在 org.apache.camel.impl.converter.BaseTypeConverterRegistry.mandatoryConvertTo(BaseTypeConverterRegistry.java:169) ~[camel-core-2.10.3.jar:2.10.3]
    在 org.apache.camel.impl.MessageSupport.getMandatoryBody(MessageSupport.java:99) ~[camel-core-2.10.3.jar:2.10.3]
    ...省略了40个常用框架

```

# sql - 函数/包问题 PL/SQL

> ID：16041372
> 
> 赞同：4
> 
> 时间：2013-04-16T15:43:51.363
> 
> 标签：sql, oracle, function, plsql, package

我正在尝试创建一个具有四个功能的包。每个函数将添加一组数字并从总数中减去一个。我在语法正确时遇到了很多麻烦。下面的函数独立工作，我尝试在最后调用第一个函数。

当我尝试创建包时，在第 7 行出现错误，“在预期以下情况之一时遇到符号“END”：开始函数 pragma 过程子类型类型当前光标删除在 0.05 秒之前存在”

在包正文中它说“名称已被现有对象使用”。我不明白，因为无论如何它都必须在包的规范中声明，如果错误是已经有一个名为 functionbyfour 的包，那么 create 或 replace 应该可以解决这个问题。

最后，当我尝试使用包中的函数时，它显示“遇到以下符号之一时遇到符号“BEGIN”：:=。（@%；不是空范围默认字符符号“;”被替换为“BEGIN”继续。ORA-06550：第 5 行，第 43 列：PLS-00103：在预期以下之一时遇到符号“FROM”：. ( * % & = - + ; < /> 在 in 是 mod 余数not rem <> or != or ~= >= <= <> and or like2 like4 likec between || multiset me”。

我正在使用 ORACLE EXPRESS 版本 11g，并且是 PL/SQL 的新手（4 周）。

非常感谢任何输入。

```
CREATE OR REPLACE FUNCTION functionbyfour AS

 FUNCTION functone( first number, second number) RETURN NUMBER ;
 FUNCTION functtwo( first number, second number, third number) RETURN NUMBER ;
 FUNCTION functthree(first number, second number, third number, fourth number) RETURN     NUMBER ;
 FUNCTION functfour( first number, second number, third number, fourth number,fifth   number) RETURN NUMBER ;

END  functionbyfour;
/

CREATE OR REPLACE PACKAGE functionbyfour AS

FUNCTION functone (first number, second number ) RETURN number AS total number;
 BEGIN
total:=first + second – 1;
RETURN total;
DBMS_OUTPUT.PUT_LINE(total);
END functone;

FUNCTION functtwo (first number, second number, third number ) RETURN number AS  total     number;
BEGIN
total:=first + second + third – 1;
RETURN total;
DBMS_OUTPUT.PUT_LINE(total);
END functtwo;

FUNCTION functthree (first number, second number,third number, fourth number )     RETURN     number AS total number;
BEGIN
total:=first + second + third + fourth – 1;
RETURN total;
DBMS_OUTPUT.PUT_LINE(total);
END functthree;

FUNCTION functfour (first number, second number, third number, fourth number, fifth     number ) RETURN number AS total number;
BEGIN
total:=first + second + third + fourth + fifth – 1;
RETURN total;
DBMS_OUTPUT.PUT_LINE(total);
END functfour; 
```

/

```
BEGIN

SELECT functionbyfour.functone(1,2) FROM DUAL;

END; 
```

/​</p>

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T15:57:10.903

您需要创建一个名为`FunctionByFour`( `CREATE OR REPLACE PACKAGE`)的包

```
SQL> ed
Wrote file afiedt.buf

  1  CREATE OR REPLACE PACKAGE functionbyfour AS
  2   FUNCTION functone( first number, second number) RETURN NUMBER ;
  3   FUNCTION functtwo( first number, second number, third number) RETURN NUMBER ;
  4   FUNCTION functthree(first number, second number, third number, fourth number) RETURN     NUMBER ;
  5   FUNCTION functfour( first number, second number, third number, fourth number,fifth   number) RETURN NUMBER ;
  6* END  functionbyfour;
  7  /

Package created. 
```

然后是相应的包体 ( `CREATE OR REPLACE PACKAGE BODY`)。您还需要一个`END`for 包体（现在，您的代码在第四个函数的末尾结束）

```
SQL> ed
Wrote file afiedt.buf

  1  CREATE OR REPLACE PACKAGE BODY functionbyfour AS
  2    FUNCTION functone (first number, second number ) RETURN number AS total number;
  3    BEGIN
  4      total:=first + second - 1;
  5      RETURN total;
  6      DBMS_OUTPUT.PUT_LINE(total);
  7    END functone;
  8    FUNCTION functtwo (first number, second number, third number ) RETURN number AS  total     number;
  9    BEGIN
 10      total:=first + second + third - 1;
 11      RETURN total;
 12      DBMS_OUTPUT.PUT_LINE(total);
 13    END functtwo;
 14    FUNCTION functthree (first number, second number,third number, fourth number )     RETURN     number AS total number;
 15    BEGIN
 16      total:=first + second + third + fourth - 1;
 17      RETURN total;
 18      DBMS_OUTPUT.PUT_LINE(total);
 19    END functthree;
 20    FUNCTION functfour (first number, second number, third number, fourth number, fifth     number ) RETURN number AS total number;
 21    BEGIN
 22      total:=first + second + third + fourth + fifth - 1;
 23      RETURN total;
 24      DBMS_OUTPUT.PUT_LINE(total);
 25    END functfour;
 26* END functionbyfour;
SQL> /

Package body created. 
```

完成后，您可以使用该功能

```
SQL> SELECT functionbyfour.functone(1,2) FROM DUAL;

FUNCTIONBYFOUR.FUNCTONE(1,2)
----------------------------
                           2 
```

如果要将`SELECT`语句放在 PL/SQL 块中，则需要声明一个局部变量并`SELECT INTO`使用函数的结果填充局部变量（您也可以只为局部变量分配函数调用而不需要使用 a `SELECT`)。

```
SQL> ed
Wrote file afiedt.buf

  1  DECLARE
  2    l_result NUMBER;
  3  BEGIN
  4    -- First approach
  5    l_result := functionByFour.functOne(1,2);
  6    dbms_output.put_line( l_result );
  7    -- Second approach
  8    SELECT functionByFour.functOne(1,2)
  9      INTO l_result
 10      FROM dual;
 11    dbms_output.put_line( l_result );
 12* END;
 13  /
2
2

PL/SQL procedure successfully completed. 
```

另外，请注意，`DBMS_OUTPUT.PUT_LINE`在您的`RETURN`陈述之后加上一个是没有意义的。永远无法达到该代码。如果要将结果打印到`DBMS_OUTPUT`缓冲区，则需要在`RETURN`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T16:10:40.130

1.  线

    ```
    CREATE OR REPLACE FUNCTION functionbyfour AS 
    ```

    应该

    ```
    CREATE OR REPLACE PACKAGE functionbyfour AS 
    ```

2.  线

    ```
    CREATE OR REPLACE PACKAGE functionbyfour AS 
    ```

    应该

    ```
    CREATE OR REPLACE PACKAGE BODY functionbyfour AS 
    ```

3.  第二个字是关键字，不能用作参数名

4.  你需要一个

    ```
    END functionbyfour; 
    ```

    在你的 END 函数结束包体之后

5.  您的 dbms_outputs 将永远不会在返回后执行

6.  你可以在一个函数中完成所有这些

    ```
     FUNCTION functall(FIRST NUMBER
                         ,sec NUMBER DEFAULT 0
                         ,third NUMBER DEFAULT 0
                         ,fourth NUMBER DEFAULT 0
                         ,fifth NUMBER DEFAULT 0)
      RETURN NUMBER
    AS
      total NUMBER;
    BEGIN
      total := first + sec + third + fourth + fifth - 1;

      dbms_output.PUT_LINE(total);

      RETURN total;
    END functall; 
    ```

7.  想要做什么奇怪的事情？:-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-16T15:51:51.060

您对独立程序和软件包感到困惑。

CREATE FUNCTION 只能用于创建独立的函数。你所拥有的应该是：

```
CREATE OR REPLACE PACKAGE functionbyfour AS 
```

一个包由两部分组成，一个规范和一个主体。规范是 API 的公开面，主体是实现。您作为包（规格）所拥有的是包体。所以改变第二段代码开始

```
CREATE OR REPLACE PACKAGE BODY functionbyfour AS 
```

至少你的程序结构正确。

Oracle PL/SQL 文档是在线的、全面的和免费的。我敦促你阅读它。 [了解更多](http://docs.oracle.com/cd/B19306_01/appdev.102/b14261/packages.htm#i6016)。

# bash - bashrc 中的 $MSYSTEM 变量

> ID：16041374
> 
> 赞同：4
> 
> 时间：2013-04-16T15:43:52.377
> 
> 标签：bash, console, ps1

## 笔记

我使用的是 Windows 7。在安装**msysgit**和**GitHub for Windows**时，我发现可以从文件夹中调用 git bash。我打开了终端，我想要的第一件事就是改变它在控制台中的显示方式。

这是`echo $PS1`给我的：

```
\[\033]0;$MSYSTEM:\w\007 \033[32m\]\u@\h \[\033[33m\w$(__git_ps1)\033[0m\] $ 
```

`PS1`一段时间以来，我一直在修改我的 bash ，并且知道其中的大部分内容。但我以前从未见过`$MSYSTEM`。

除了一些关于使用它来设置`$MSYSTEM=MINGW32`的结果之外，谷歌什么也没有得到，这当然不是这里的情况。

那么，`MSYSTEM`变量有什么作用呢？另外，当我创建一个文件`.bashrc`并将这一行放在那里时；终端现在在我的用户名之前显示一个空格。这是因为该段中的空白空间，`\007 \033`但之前没有。以下是我使用自定义`.bashrc`和不使用自定义时的屏幕截图：

[![没有 <code>bashrc</code>](https://i.stack.imgur.com/kcG0d.png)](https://i.stack.imgur.com/ldWyT.png)

[没有`bashrc`]

[![使用 <code>.bashrc</code>](https://i.stack.imgur.com/ETZFA.png)](https://i.stack.imgur.com/ETZFA.png)

[和`bashrc`]

我知道为什么我的定制终端没有换行符；但问题是：

*   是什么`$MSYSTEM`？
*   为什么在第一种情况下缺少第一个空格？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T15:52:30.963

它将窗口标题设置为`MSYSTEM`变量的值。就空间而言，看起来你搞砸了最后的换行符，请注意

```
export PS1='\[\033]0;$MSYSTEM:\w\007
\033[32m\]\u@\h \[\033[33m\w\033[0m\]
$ ' 
```

在每个新行开头上方的变量中，将文字换行符插入`PS1`.

[如何更改 xterm 的标题](http://faqs.org/docs/Linux-mini/Xterm-Title.html)

# oracle - Oracle Clob 字段值

> ID：16041375
> 
> 赞同：0
> 
> 时间：2013-04-16T15:43:54.407
> 
> 标签：oracle, clob

我在获取 clob 字段的特定值时遇到问题。

（我不能创建函数）这很容易。

所以假设一个clob字段：

键1+val1；键2+val2；键3+val3；键4+val4

例如，在这里我想获取 key3 的值

我试图用 dbms_lob.substr & dbms_lob.instr 归档它，但没有成功。

有人可以在这里帮助我吗？

值的顺序可以不同 (key2+val2;key1+val1;key4+val4;key3+val3)

非常感谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:49:07.213

```
regexp_replace(clob_column, '^(.*?;)*key3\+([^;]*).*$', '\2') 
```

[小提琴](http://www.sqlfiddle.com/#!4/6ea97/1)

# spring-security - 具有隐式和密码流的 Spring OAuth2

> ID：16041378
> 
> 赞同：0
> 
> 时间：2013-04-16T15:44:04.737
> 
> 标签：spring-security, oauth-2.0

我正在尝试使用隐式、密码和授权流程使用 Spring OAuth 2 设置项目。

当我使用相同的令牌端点进行隐式和其他两个令牌端点时出现问题，密码和授权需要基本身份验证进行客户端验证，而隐式不验证客户端密码，我想使用更经典的登录/密码身份验证用于用户授权。

因此，根据配置，一两个流程可以工作。拥有 2 个端点似乎是最简单的解决方案，但我找不到如何实现这一点。

```
<?xml version="1.0" encoding="UTF-8" ?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:oauth="http://www.springframework.org/schema/security/oauth2" 
    xmlns:sec="http://www.springframework.org/schema/security"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="http://www.springframework.org/schema/security/oauth2 http://www.springframework.org/schema/security/spring-security-oauth2-1.0.xsd
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd
        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">
<!--
    <sec:http pattern="/external/oauth/token" create-session="stateless" authentication-manager-ref="clientAuthenticationManager"
        xmlns="http://www.springframework.org/schema/security" entry-point-ref="authenticationEntryPoint">
        <sec:intercept-url pattern="/external/oauth/token" access="IS_AUTHENTICATED_FULLY" />
        <sec:anonymous enabled="false" />
        <sec:access-denied-handler ref="oauthAccessDeniedHandler" />
    </sec:http>
-->
    <sec:http pattern="/external/oauth/token" create-session="stateless" authentication-manager-ref="clientAuthenticationManager"
        xmlns="http://www.springframework.org/schema/security">
        <sec:intercept-url pattern="/external/oauth/token" access="IS_AUTHENTICATED_FULLY" />
        <sec:anonymous enabled="false" />
        <sec:http-basic entry-point-ref="clientAuthenticationEntryPoint" />
        <sec:access-denied-handler ref="oauthAccessDeniedHandler" />
    </sec:http>

    <bean id="clientAuthenticationEntryPoint" class="org.springframework.security.oauth2.provider.error.OAuth2AuthenticationEntryPoint">
        <property name="realmName" value="blablabla" />
        <property name="typeName" value="Basic" />
    </bean>
    <bean id="oauthAccessDeniedHandler" class="org.springframework.security.oauth2.provider.error.OAuth2AccessDeniedHandler" />

    <authentication-manager id="clientAuthenticationManager" xmlns="http://www.springframework.org/schema/security">
        <authentication-provider user-service-ref="clientDetailsUserService" />
    </authentication-manager>

    <bean id="clientDetailsUserService" class="org.springframework.security.oauth2.provider.client.ClientDetailsUserDetailsService">
        <constructor-arg ref="clientDetails" />
    </bean>

    <bean id="tokenStore" class="com.proton.oauthprovider.service.ProtOnTokenStore" />

    <bean id="clientDetails" class="com.proton.oauthprovider.service.ProtOnClientDetailsService" />

    <bean id="oauthCodeDetails" class="com.proton.oauthprovider.service.ProtOnAuthorizationCodeServices" />

    <bean id="tokenServices" class="org.springframework.security.oauth2.provider.token.DefaultTokenServices">
        <property name="tokenStore" ref="tokenStore" />
        <property name="supportRefreshToken" value="true" />
        <property name="clientDetailsService" ref="clientDetails" />
    </bean>

    <bean id="userApprovalHandler" class="com.proton.oauthprovider.service.OAuthUserApprovalHandler">
        <property name="autoApproveClients">
            <set>
                <!--  <value>rest-client</value> -->
            </set>
        </property>
        <property name="tokenServices" ref="tokenServices" />
    </bean>

    <oauth:authorization-server client-details-service-ref="clientDetails"  
        token-services-ref="tokenServices"
        user-approval-handler-ref="userApprovalHandler" authorization-endpoint-url="/external/oauth/authorize" 
        user-approval-page="forward:/external/oauth/confirm_access" 
        error-page="forward:/external/oauth/error" 
        token-endpoint-url="/external/oauth/token" >
        <oauth:authorization-code authorization-code-services-ref="oauthCodeDetails"/>
        <oauth:implicit/>
        <oauth:refresh-token />
        <oauth:password authentication-manager-ref="authenticationManager"/>
    </oauth:authorization-server>

    <oauth:web-expression-handler id="oauthWebExpressionHandler" />

    <!-- Override the default mappings for approval and error pages -->
    <bean id="accessConfirmationController" class="com.proton.oauthprovider.controller.AccessConfirmationController">
        <property name="clientDetailsService" ref="clientDetails" />
    </bean>

</beans> 
```

authenticationEntryPoint 是登录表单入口点，自定义类与 sparklr 和 tonr 或多或少相同，只是使用 DB 后端存储客户端和令牌数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T08:52:32.297

好的，我错了，隐式流不使用令牌端点，它使用授权端点。所以之前的配置没问题，我只需要将隐式流指向 /oauth/authorize/ 就可以按预期工作。

# performance - 以良好的性能服务于数百万条路线

> ID：16041379
> 
> 赞同：0
> 
> 时间：2013-04-16T15:44:05.160
> 
> 标签：performance, routes, bigdata

我正在为一个尚未设置约束和规范的新项目做一些研究。需要的一件事是直接在根域下的大量路径。这可能会增加数百万条路径。这些路径没有共同的结构或独特的部分，所以我必须寻找完全匹配的东西。

现在我知道分解这些路径更有效，这也有助于路径查找。但是我正在研究这里的可能性，所以请耐心等待。

我正在评估实现这一目标的方法，同时保持出色的性能。我想到了以下方法：

*   将路径存储在 SQL 数据库中并对每个请求进行查找。这似乎是最糟糕的选择，绝对不会被使用。
*   将路径存储在 Redis 等键值存储中。这会好很多，而且我认为表现得很好（尽管必须对其进行基准测试）。
*   进行字符串/正则表达式匹配 - 就像许多框架一样，开箱即用 - 因为这么多可能的匹配是疯狂的，因此不是一个真正的选择。但是我可以看到，在结合一些智能优化的情况下，逐字母比较的某种算法是如何起作用的。

但也许有一些我不知道的工具/方法更适合这类问题。不过，我可以使用任何提示来完成此操作。

哦，如果有人想知道，不，这不是家庭作业。

* * *

**更新**

我已经测试了 Redis 方法。基于两组关键词，我得到了 1.5 亿条路径。我已经使用`set`命令添加了它们中的每一个，其值是一个序列化的 id 字符串，我可以使用它来识别请求中的实际关键字。( `SET 'keyword1-keyword2' '<serialized_string>'`)

在具有一百万条记录的数据集的本地 VM 中进行快速测试返回了有希望的结果：对 1000 个请求进行基准测试平均需要 2 毫秒。这是在我的笔记本电脑上，它运行着很多其他的东西。

接下来我在一个 4 核 8GB 内存的 VPS 上做了一个完整的测试，完整的 1.5 亿条记录。这产生了一个文件大小为 3.1G 的数据库和大约 9GB 的内存。由于数据库无法完全加载到内存中，Redis 开始交换，这导致了可怕的结果：平均大约 100 毫秒。

显然这不会起作用并且可以很好地扩展。要么每个 Web 服务器都需要有大量的 RAM，要么我们必须使用专用的 Redis 路由服务器。我读过Instagram 工程师[的一篇文章](http://instagram-engineering.tumblr.com/post/12202313862/storing-hundreds-of-millions-of-simple-key-value-pairs)，他们想出了一个技巧来显着减小数据库大小，但我还没有尝试过。无论哪种方式，这似乎都不是正确的方法。回到绘图板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T23:36:21.217

我认为 Redis 是你最好的选择。SQL 会很慢，根据我的经验，正则表达式在查询中总是非常缓慢。

我将执行以下步骤来测试 Redis：

1.  使用本地 VM 或在 EC2 之类的云中启动 Redis 实例。
2.  下载一两个字典并将这些数据泵入 Redis。例如这里的一些东西：[http](http://wordlist.sourceforge.net/) : //wordlist.sourceforge.net/ 确保你规范化数据。例如，始终将字符串小写并删除字符串开头/结尾处的空格等。
3.  我会忽略哈希。我看不出您需要对 URL 进行哈希处理的原因？如果您想调试东西并且它似乎没有“购买”您任何东西，那么以后就不可能阅读。我去了[http://www.sha1-online.com/](http://www.sha1-online.com/)，然后输入`ryan`并获得`ea3cd978650417470535f3a4725b6b5042a6ab59`了哈希值。将原始文本放入 RAM 中会小得多，这将有助于 Redis。显然，对于更长的路径，散列会更好，但是您的示例非常小。=)
4.  编写一个从 Redis 读取的工具，看看它的性能如何。
5.  利润！

请记住，Redis 需要将整个数据集保存在 RAM 中，因此请进行相应的计划。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T17:10:56.843

> 将路径存储在 SQL 数据库中并对每个请求进行查找。这似乎是最糟糕的选择，绝对不会被使用。

您可能低估了数据库的功能。我可以邀请你重新考虑你在那里的立场吗？

对于 Postgres（或带有 InnoDB 的 MySQL），一百万个条目比微小的要高出一个档次。将整个路径存储在一个字段中，在其上添加索引，清理，分析。在您确定关键对象的 ID 之前，不要进行疯狂的连接，并且您在查找速度方面会很好。从 psql 运行查询时说几毫秒。

如果您获得大量流量，您真正的问题将是与磁盘 IO 相关的瓶颈。这里的经营座右铭是：越少越好。除了在您的 php 服务器上安装 APC、如果您使用 Ruby 则使用Passenger等基础知识之外：

1.  确保服务器有足够的 RAM 来适应该索引。

2.  缓存对与 memcached 中每个路径相关的对象的引用。

3.  如果您可以在十几个正则表达式中对所有路由进行分类，那么它们可能会有所帮助，因为它们允许使用更小、更有针对性的索引，这些索引更容易保存在内存中。如果没有，只需坚持存储（可能是尾部斜线）整个路径并继续前进。

4.  担心错过。如果您有一个重定向到规范 URL 的非规范 URL，请将重定向存储在 memcached 中，没有任何到期日期，然后继续使用它。

5.  我提到了很多 RAM 和 memcached 吗？

6.  哦，也不要高估您正在使用的 ORM。构建查询所花费的时间可能比数据存储解析、检索和返回结果所花费的时间更多。

7.  内存...内存缓存...

老实说，Reddis 与 SQL + memcached 选项没有太大区别，除了在内存管理（如您所见）、分片、复制和语法方面。当然，还有熟悉。

您的关键决策点（除了不包括迭代多个正则表达式）应该是您的数据的结构。如果它是高度结构化的，对原子性有关键需求，SQL + memcached 应该是你的首选。如果您的自定义字段遍布且 EAV 表过于庞大，那么使用 Reddis 或 CouchDB 或其他 NoSQL 存储应该在您的雷达上。

在任何一种情况下，拥有*大量*RAM 来将这些索引保存在内存中都会有所帮助，并且如果您需要扩展，那么整个事物前面的 memcached 集群将永远不会受到伤害。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T19:58:59.700

我建议使用某种键值存储（即散列存储），可能与散列键一起使用，使其更短（恕我直言，SHA-1 之类的就可以了）。

# ruby-on-rails-3 - 自定义路线在开发中匹配，但在生产中导致 404

> ID：16041380
> 
> 赞同：0
> 
> 时间：2013-04-16T15:44:15.350
> 
> 标签：ruby-on-rails-3, routing, ruby-on-rails-3.2, routes, rails-cells

我的 routes.rb 中有以下定义

```
 match "/block/:name/:action" => proc { |env|
    #heavy magic happens here
  } 
```

我用它来处理单元格的渲染。我的问题是以下链接：

```
/block/reporting%2Fother%2Fexample/new?exampleable_id=23736&exampleable_type=Abc%3A%3ASomeType 
```

在开发模式下工作得很好，但在生产中我得到“404 Not Found”。生产和开发 url 之间的唯一区别是开发中的 URL 使用 http，而生产中的 URL 使用 https。如果我在我的 proc 块中编写了错误的代码，我会理解，但看在上帝的份上，我无法理解为什么它在生产环境中不匹配，而它在开发中工作得非常好。

任何有关如何调试的提示都非常感谢。我的头上没有那么多头发了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T15:53:44.523

即使我最终在本地机器上的生产环境中启动了项目，我也会收到此错误。问题是我们不在生产中使用 Thin。我们使用乘客。在我终于让乘客在本地工作后，我设法重现了错误。

事实证明，对于乘客，上述路线中的 :name 并没有被解释为“reporting%2Fother%2Fexample”，而是可能被解释为 /block/ **reporting** /other/example/new”，当然其余的不匹配。

我通过替换修复了错误

```
match "/block/:name/:action" 
```

至

```
match "/block/*name/:action" 
```

我希望这个对我自己问题的回答对将来的人有所帮助。

# c# - 将隐藏模型列表添加到 Razor 表单

> ID：16041382
> 
> 赞同：0
> 
> 时间：2013-04-16T15:44:21.767
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, razor, html-helper

我正在创建一个向导，我需要传播我创建的列表。该列表是我的联系人模型。我需要把它放在表单中，这样当我在最后一步发回控制器时，我可以将联系人列表作为向导模型的一部分（它现在只返回 null）。对于其他简单的表单对象，我使用 HiddenFor 将数据保存在模型中。这不起作用，因为隐藏的 for 只是一个文本框，我有一个复杂的对象。

我考虑创建一个 DropDownListFor 并将其包装在一个隐藏的 div 中。这只是拼凑，实际上需要一些工作才能让 DropDownListFor 接受另一种对象类型（如果它可以工作的话）。

我考虑过将列表保存到 Session["Contacts"]，但这似乎不是正确的 MVC 方式。有没有人有更好的建议？

谢谢， TJ

- 更新 -

作为对 merekel 的回应，我添加了更多细节以澄清我遇到问题的地方。此列表不会被用户修改，也不会显示在表单上。我在我的向导步骤之一中创建列表并将其保存到我的模型中。

查看模型

```
public class WizardViewModel
{
    //...
    public List<Contact> ContactList { get; set; }
    //...
} 
```

控制器代码

```
//Step 4 in the wizard
model.ContactList = CALL FUNCTION THAT CREATES LIST BASED ON FORM SELECTIONS

//other calculations needed for step 5

//Save Contacts for later
Session["Contacts"] = model.ContactList;

//Step 5 in the wizard

//Readd the contacts to the model
model.ContactList = (List<Contact>)Session["Contacts"];

//Save the model to pass to the report page
//My report viewer is on an ASPX page so I am passing all the data here with a session
Session["ReportModel"] = model; 
```

会话保存按预期工作。我似乎不应该使用会话来使用 MVC 逐页保存数据。从 MVC 到 ASPX 时我需要这样做，所以我不担心 Session["ReportModel"] 只有 Session["Contacts"]。感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T19:14:55.497

我相信这样的帖子会对[1](https://stackoverflow.com/questions/9306246/posting-to-a-listmodeltype-mvc3)、[2](http://www.hanselman.com/blog/ASPNETWireFormatForModelBindingToArraysListsCollectionsDictionaries.aspx)有所帮助。关于如何发布后备列表，有很多类似的帖子。

这些联系人是从您的表单中填充的，还是全球联系人？

# jquery - jquery, 图片幻灯片效果

> ID：16041384
> 
> 赞同：0
> 
> 时间：2013-04-16T15:44:25.540
> 
> 标签：jquery, image, user-interface, slider

作为一个对 jquery 很陌生的人，我正在尝试为图像区域制作一个简单的滑块，但我使用的效果是整个 div。我将如何使这仅影响图像。

```
var bgArr = ["../css/img/head/1.png", "../css/img/head/2.png"];
var i = 0;

var interval = self.setInterval("swapBkgnd()", 5000)

function swapBkgnd() {
if (i > (bgArr.length - 1)) {
    i = 0
    $("#header").css("background-image", "url(" + bgArr[i] + ")").effect("slide", { direction: "down" }, 1000);
}
else {
    $("#header").css("background-image", "url(" + bgArr[i] + ")").effect("slide", { direction: "down" }, 1000);
}
i++;
}; 
```

如果可能的话，我希望它保留旧图像，因为新图像也会滑入。

[http://fear.kennyist.com/](http://fear.kennyist.com/) - 现在发生了什么。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:53:27.017

我建议你看看这个教程。它还有一个 jquery 滑块教程。

您可以在一天内构建自己的滑块

[https://tutsplus.com/lesson/the-obligatory-slider/](https://tutsplus.com/lesson/the-obligatory-slider/)

# ruby-on-rails - 单击 ruby on rails 应用程序中的链接时显示路由错误没有路由匹配错误

> ID：16041386
> 
> 赞同：0
> 
> 时间：2013-04-16T15:44:26.340
> 
> 标签：ruby-on-rails, ruby, routing

我尝试使用 ruby​​ on rails 获取 10 篇最新文章的标题，这是博客应用程序的一部分。我这样做了。但是在路由方面我被卡住了。

当我喜欢

（此代码是文章/索引的一部分）

```
<% @article_titles.each do |article_title|%>
              <% if !article_title.nil? %>
               <div style="margin-top:15px; margin-left:8px"> <%= link_to article_title.title,
               article_path(article_title) %></div> 
            <% end %>    
            <% end %> 
```

它给了我路由错误

没有路线匹配 {:action=>"show", :controller=>"articles", :id=>#} 错误。

我尝试了另一种方式，如下所示：-

```
 <% @article_titles.each do |article_title|%>
              <% if !article_title.nil? %>
               <div style="margin-top:15px; margin-left:8px"> <%= link_to article_title.title,
               "/articles?id=#{article_title.id}"   %></div> 
            <% end %>    
            <% end %> 
```

路线.rb

```
match "articles/:id" => "articles#show" 
```

我没有给出任何错误，只显示`("http://localhost:3000/articles?id=")`在我的浏览器的地址栏中，没有采取任何行动。

耙路线：

```
 new_user_session GET    /users/sign_in(.:format)                          devise/sessions#new
            user_session POST   /users/sign_in(.:format)                          devise/sessions#create
    destroy_user_session DELETE /users/sign_out(.:format)                         devise/sessions#destroy
           user_password POST   /users/password(.:format)                         devise/passwords#create
       new_user_password GET    /users/password/new(.:format)                     devise/passwords#new
      edit_user_password GET    /users/password/edit(.:format)                    devise/passwords#edit
                         PUT    /users/password(.:format)                         devise/passwords#update
cancel_user_registration GET    /users/cancel(.:format)                           devise/registrations#cancel
       user_registration POST   /users(.:format)                                  devise/registrations#create
   new_user_registration GET    /users/sign_up(.:format)                          devise/registrations#new
  edit_user_registration GET    /users/edit(.:format)                             devise/registrations#edit
                         PUT    /users(.:format)                                  devise/registrations#update
                         DELETE /users(.:format)                                  devise/registrations#destroy
                    root        /                                                 articles#index
         dashboard_index GET    /dashboard(.:format)                              dashboard#index
                         POST   /dashboard(.:format)                              dashboard#create
           new_dashboard GET    /dashboard/new(.:format)                          dashboard#new
          edit_dashboard GET    /dashboard/:id/edit(.:format)                     dashboard#edit
               dashboard GET    /dashboard/:id(.:format)                          dashboard#show
                         PUT    /dashboard/:id(.:format)                          dashboard#update
                         DELETE /dashboard/:id(.:format)                          dashboard#destroy
                    tags GET    /tags(.:format)                                   tags#index
                         POST   /tags(.:format)                                   tags#create
                 new_tag GET    /tags/new(.:format)                               tags#new
                edit_tag GET    /tags/:id/edit(.:format)                          tags#edit
                     tag GET    /tags/:id(.:format)                               tags#show
                         PUT    /tags/:id(.:format)                               tags#update
                         DELETE /tags/:id(.:format)                               tags#destroy
        article_comments GET    /articles/:article_id/comments(.:format)          comments#index
                         POST   /articles/:article_id/comments(.:format)          comments#create
     new_article_comment GET    /articles/:article_id/comments/new(.:format)      comments#new
    edit_article_comment GET    /articles/:article_id/comments/:id/edit(.:format) comments#edit
         article_comment GET    /articles/:article_id/comments/:id(.:format)      comments#show
                         PUT    /articles/:article_id/comments/:id(.:format)      comments#update
                         DELETE /articles/:article_id/comments/:id(.:format)      comments#destroy
                                /articles/:article_id/articles/:id(.:format)      articles#show
                articles GET    /articles(.:format)                               articles#index
                         POST   /articles(.:format)                               articles#create
             new_article GET    /articles/new(.:format)                           articles#new
            edit_article GET    /articles/:id/edit(.:format)                      articles#edit
                 article GET    /articles/:id(.:format)                           articles#show
                         PUT    /articles/:id(.:format)                           articles#update
                         DELETE /articles/:id(.:format)                           articles#destroy 
```

文章控制器.rb

```
 def index
          @articles = Article.all(:order => "created_at DESC")
      @article_titles = Article.select(:title).first(10)
      end
    def show
      @article = Article.find(params[:id])

    end 
```

路线.rb

```
Mau::Application.routes.draw do
  devise_for :users
  root :to => 'articles#index'
  resources :dashboard
  resources :tags
  resources :articles do
  resources :comments
  match "articles/:id" => "articles#show"
end 
```

调试器日志。

```
ActionController::RoutingError (No route matches [GET] "/assets/defaults.js"):
  actionpack (3.2.11) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
  railties (3.2.11) lib/rails/rack/logger.rb:32:in `call_app'
  railties (3.2.11) lib/rails/rack/logger.rb:16:in `block in call'
  activesupport (3.2.11) lib/active_support/tagged_logging.rb:22:in `tagged'
  railties (3.2.11) lib/rails/rack/logger.rb:16:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/request_id.rb:22:in `call'
  rack (1.4.5) lib/rack/methodoverride.rb:21:in `call'
  rack (1.4.5) lib/rack/runtime.rb:17:in `call'
  activesupport (3.2.11) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
  rack (1.4.5) lib/rack/lock.rb:15:in `call'
  actionpack (3.2.11) lib/action_dispatch/middleware/static.rb:62:in `call'
  railties (3.2.11) lib/rails/engine.rb:479:in `call'
  railties (3.2.11) lib/rails/application.rb:223:in `call'
  rack (1.4.5) lib/rack/content_length.rb:14:in `call'
  railties (3.2.11) lib/rails/rack/log_tailer.rb:17:in `call'
  rack (1.4.5) lib/rack/handler/webrick.rb:59:in `service'
  c:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
  c:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
  c:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

我需要在文章的展示动作中添加一些东西吗？请给我建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:08:22.147

您的问题是 @article_titles 记录不包含 id 属性，因为您只选择了 title `Article.select(:title)`。完成您正在尝试的事情的更好方法是在您的控制器中拥有：

```
@articles = Article.order("created_at DESC")
@first_articles = @articles.limit(10) 
```

在您使用@article_titles 的地方使用@first_articles。

我还质疑你是否需要@articles（你只显示前 10 条记录吗？）我建议它是一个 ActiveRecord::Relation 的代码，除非你真的是，否则它不会被加载（命中数据库）在您的视图中使用变量，但这是另一个 SO 问题的主题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:06:09.513

这可能会或不会解决您的问题，但是您`end`的路线块中缺少 end：

```
Mau::Application.routes.draw do
  devise_for :users
  root :to => 'articles#index'
  resources :dashboard
  resources :tags
  resources :articles do
  resources :comments
  match "articles/:id" => "articles#show"
end 
```

应该

```
Mau::Application.routes.draw do
  devise_for :users
  root :to => 'articles#index'
  resources :dashboard
  resources :tags
  resources :articles do
    resources :comments
  end
end 
```

请注意，您不应该需要`match`您拥有的路线，因为它是`resources :articles`.

**编辑**

您还应该尝试只传递这样的 id：

```
<% @article_titles.each do |article_title|%>
    <% if !article_title.nil? %>
         <div style="margin-top:15px; margin-left:8px"> 
             <%= link_to article_title.title, article_path(article_title.id) %>
         </div> 
    <% end %>    
<% end %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T15:47:49.113

remove `match "articles/:id" => "articles#show"`，确保`resources :articles`存在，并且`article_path(@article)`应该可以工作。

改变

```
Article.select(:title).first(10) 
```

经过

```
Article.select([:id, :title]).first(10) 
```

你总是需要选择 :id 来使用路由。

# ruby-on-rails - 通过翻译属性全球化3订单记录并考虑回退

> ID：16041392
> 
> 赞同：4
> 
> 时间：2013-04-16T15:45:02.620
> 
> 标签：ruby-on-rails, activerecord, fallback, globalize3

我遇到了很棒的 Globalize3 gem 的麻烦。现在我有两种语言：en 和 :ru。并且 :ru 像这样回退到 :en

```
#/config/initializers/globalize.rb
Globalize.fallbacks = {:ru => [:ru, :en]} 
```

在我的控制器中，我试图通过名称翻译或翻译后备值对整个翻译记录集合进行排序。但`with_translations()`似乎没有给我这样的机会！

```
Country.with_translations(:ru).order('country_translations.name ASC')
#this filters out those who have no :ru translations (BUT THEY SHOLD USE FALLBACKS!) 
```

所以要检索所有记录，我可以传递一个语言环境数组：

```
Country.with_translations([:ru, :en]).order('country_translations.name ASC')
#but this completely ruins the sorting order (DAMN NOTHING IS SORTED) 
```

我想要的唯一简单的事情就是把后备和整理在一起！所以我们需要以某种方式让所有记录仅按可用名称值排序。

有什么办法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-19T12:27:19.643

通过深入研究 Globalize3 源解决了这个问题。它使用`with_locales`范围来获取存在适当语言环境的记录。我只需要它们：

```
Model.includes(:translations).
       with_locales(I18n.available_locales).
       order('model_translations.name ASC') 
```

希望它会帮助别人！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-16T05:30:42.387

本来会留下这个作为评论，但还没有声誉，所以我想我不妨把这个作为答案。

1.  在 Rails 4 中，当前编写的查询会引发关于隐式连接的长时间弃用警告（这是您通过`model_translations`在 where 原因中引用表所做的事情）。

2.  我相信您正在尝试返回`Model`记录，而不是`Model::Translation`记录。因此，我认为您可以将 a 换成`includes`a `join`，它应该会更高效并摆脱弃用警告。

在我的 Rails 4 应用程序中，连接运行良好，但我还没有在 Rails 3 中对其进行测试。

# syntax - OCaml 文字负数？

> ID：16041393
> 
> 赞同：5
> 
> 时间：2013-04-16T15:45:06.200
> 
> 标签：syntax, ocaml

我在学。这是我觉得奇怪的事情：

```
let test_treeways x = match x with
  | _ when x < 0 -> -1
  | _ when x > 0 -> 1
  | _ -> 0;; 
```

如果我这样称呼它：

```
test_threeways -10;; 
```

我会得到类型不匹配错误（因为据我了解，它将一元减号解释为好像它是部分函数应用程序，所以它认为表达式的类型是`int -> int`。但是，这是：

```
test_threeways (-10);; 
```

正如预期的那样（尽管这实际上计算了值，据我所知，它不会将常数“减十”传递给函数。

那么，如何在 OCaml 中编写常量负数呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T16:16:50.980

您需要将其括起来以避免解析模糊。“test_threeways -10”也可能意味着：从 test_threeways 中减去 10。

并且不涉及功能应用。只需重新定义一元减号，即可查看差异：

```
#let (~-) = (+) 2 ;; (* See documentation of pervarsives *)
val ( ~- ) : int -> int = <fun>
# let t = -2 ;; 
val t : int = -2 (* no function application, constant negative number *)
# -t ;;
- : int = 0   (* function application *) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T15:42:41.830

您可以使用[~-](http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#6_Integerarithmetic "~~")和 ~-。直接（如另一个答案中所暗示的），它们都是显式[前缀运算符](http://caml.inria.fr/pub/docs/manual-ocaml-4.00/lex.html#prefix-symbol "前缀运算符")，因此解析它们并不模棱两可。但是我更喜欢使用括号。

# python-2.7 - Python ReportLab - 带有 X of Y 页码的可点击目录

> ID：16041397
> 
> 赞同：6
> 
> 时间：2013-04-16T15:45:12.807
> 
> 标签：python-2.7, pdf-generation, reportlab

使用 ReportLab 2.7、Python 2.7：

我可以在目录 (toc) 中创建一个带有可点击书签的 pdf，或者我可以创建一个带有“x of y”页码的 pdf，但是当我尝试同时执行这两种操作时，书签页（键）似乎会中断。

示例代码：

```
class MyDocTemplate(BaseDocTemplate):  
    def __init__(self, filename, **kw):
        self.allowSplitting = 0
        BaseDocTemplate.__init__(self, filename, **kw)
        template = PageTemplate('normal', [Frame(2.5*cm, 2.5*cm, 15*cm, 25*cm)]) #, id='F1'
        self.addPageTemplates(template)

def afterFlowable(self, flowable):
    if isinstance(flowable, Paragraph):
        txt = flowable.getPlainText()
        style = flowable.style.name
        if style == 'Heading1':
            key = 'h1-%s' % self.seq.nextf('heading1')
            self.canv.bookmarkPage(key)                
            self.notify('TOCEntry', (0, txt, self.page))
        elif style == 'Heading2':
            key = 'h2-%s' % self.seq.nextf('heading2')
            print key
            self.canv.bookmarkPage(key)
            self.notify('TOCEntry', (1, txt, self.page, key))

class NumberedCanvas(canvas.Canvas):
    def __init__(self, *args, **kwargs):
        canvas.Canvas.__init__(self, *args, **kwargs)
        self._saved_page_states = []

    def showPage(self):
        self._saved_page_states.append(dict(self.__dict__))
        self._startPage()

    def save(self):
        """add page info to each page (page x of y)"""
        num_pages = len(self._saved_page_states)
        for state in self._saved_page_states:
            self.__dict__.update(state)
            self.draw_page_number(num_pages)
            canvas.Canvas.showPage(self)
        canvas.Canvas.save(self)

    def draw_page_number(self, page_count):
        self.setFont('Times-Bold',14)
        self.drawRightString(7.6*inch,.5*inch,
        "Page %d of %d" % (self._pageNumber, page_count))

    h1 = PS(name = 'Heading1',
    fontSize = 14,
    leading = 16)
    h2 = PS(name = 'Heading2',
    fontSize = 12,
    leading = 14,
    leftIndent = 25)

    #Build story.
    story = []
    toc = TableOfContents()

    #For conciseness, using the same styles for headings and TOC entries
    toc.levelStyles = [h1, h2]
    story.append(toc)
    story.append(PageBreak())
    story.append(Paragraph('First heading', h1))
    story.append(Paragraph('Text in first heading', PS('body')))
    story.append(Paragraph('First sub heading', h2))
    story.append(Paragraph('Text in first sub heading', PS('body')))
    story.append(PageBreak())
    story.append(Paragraph('Second sub heading', h2))
    story.append(Paragraph('Text in second sub heading', PS('body')))
    story.append(Paragraph('Last heading', h1))
    doc = MyDocTemplate("mypdf.pdf")
    doc.multiBuild(story, canvasmaker=NumberedCanvas) 
```

任何意见将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-01-11T00:01:28.567

发现这个最初寻找解决方案无济于事，但是，想出了一些对我有用的东西并希望分享如下：

从 reportlab 示例的起点开始，关于创建包含文档的 toc（我假设您首先使用了该文档），请执行以下操作。

通过添加选项 onPage 和 onPageEnd 来修改 init 函数中的模板分配，这些选项定义了对用于在页面上绘制页眉和页脚的函数的调用，如下所示，猜测您可以只在一个函数中执行相同的操作，但是，我按顺序使用了两个在我的用例中分隔页眉/页脚部分：

```
template = PageTemplate('normal', [Frame(2.5*cm, 2.5*cm, 15*cm, 25*cm, id='F1')],onPage=header,onPageEnd=footer) 
```

将命名的页眉/页脚函数添加到您的类中，如下所示，并说明了一些用于澄清的选项，包括页脚函数中的页码，以确保问题得到回答：

```
def header(canvas, doc):
    canvas.saveState()
    canvas.drawImage('some_image.gif', 5,780, width=None,height=None,mask=None)
    canvas.setLineWidth(1)
    canvas.line(5,780,120,780)
    canvas.setFont('Times-Bold',16)
    canvas.drawString(108, 108, 'blah')
    canvas.restoreState()

def footer(canvas, doc):
    canvas.saveState()
    canvas.setFont('Times-Roman',9)
    canvas.drawImage('py.jpg', inch,inch, width=None,height=None,mask=None)
    canvas.drawString(inch, 0.75 * inch, "Page %d " % doc.page)
    canvas.restoreState() 
```

无论您对添加的“编号画布类”做了什么以及它为什么会中断，我不知道，但由于您提供的代码让我强烈地想起了 reportlab toc 示例，我想您可以从它开始，应用我建议的更改/添加并查看情况如何。

这应该可以解决问题，希望有帮助！

# background-image - 带背景图像的 div，没有内容不显示百分比声明

> ID：16041399
> 
> 赞同：1
> 
> 时间：2013-04-16T15:45:17.823
> 
> 标签：background-image, percentage

我想显示一个带有背景图像的 div。我不希望 div 包含除背景图像之外的任何其他内容，并且我不想使用 img 代替。

它可以使用像高度这样的固定值：100px，但我想使用百分比声明。为什么不显示？甚至可以使用百分比值吗？还是我必须声明其他任何东西？

我想建立一个响应式移动网站，我可以在其中使用模板按钮并用 html 文本填充它，因此我不需要为具有不同文本的同一个按钮使用多个图像。有没有更好的办法？

在此先感谢这是我的代码：

```
<div id="icon1">

</div>

 #icon1 {
   background-image: url(images/MyPicture.png);
   width: 30% ;
   height: 100%;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-18T13:35:18.037

只有将百分比高度设置为 DIV#icon1 的所有父元素，直到 BODY 和 HTML 标记，它才会起作用。

```
http://fiddle.jshell.net/YJQcF/1/ 
```

否则，需要为其分配固定的高度或最小高度值；

# jquery - 根据每个图像名称添加带有 jquery 的标题标签

> ID：16041402
> 
> 赞同：0
> 
> 时间：2013-04-16T15:45:26.367
> 
> 标签：jquery, title

我想使用 jquery 为类 ls-thumb-active 添加一个标题标签，我通过以下方式做到了这一点：

```
<script type='text/javascript'>//<![CDATA[ 
$(window).load(function(){
tooltip = "mouseover";

$('.ls-thumb-active').attr('title', tooltip);

$('.displaytitle').html($('.ls-thumb-active').attr('title'));
});//]]>  

</script> 
```

问题是，我希望它显示实际的 img 名称作为工具提示变量，最后没有 .jpg。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T15:50:38.133

您可以使用以下内容取出图像名称的“.jpg”部分，这将允许您在获得的名称之后删除任何扩展名：

```
var imageName = imageElementYouAreGettingSomewhere.src;
imageName = imageName.substr(0, imageName.lastIndexOf('.'));

$('.displaytitle').attr('title', imageName ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T15:48:36.407

您可以通过“拆分”您的 img 名称轻松地做到这一点。因此，假设 var image 是您的图像名称，如下所示：

```
var image = 'something_unusual.jpg'; 
```

您可以像这样获取图像名称：

```
var image_name = image.split('.')[0]; 
```

然后，当然，您可以像第一次一样添加它：

```
$('.ls-thumb-active').attr('title', image_name); 
```

请注意，我使用“拆分”方法，该方法将您的图像名称按字符“。”拆分。所以如果图像，由于某种原因，作为“。” 以他的名义，这可能会破裂。您还可以使用最后一个点的索引进行子串、拼接等。但是在那个例子中，如果图像名称中没有点，那么无论文件扩展名是什么，它都会完美地工作。希望这有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T15:51:04.777

由于这对每个图像都是必需的，因此您需要遍历所有图像并设置`title`属性。

```
$('.ls-thumb-active').each(function() {
    var imgName = $(this).attr('src').split('.')[0];
    $(this).attr('title', imgName );
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T15:47:21.690

由于扩展名将是：

*   .jpg
*   .png
*   .gif

您可以使用 substring 在末尾剪切四个字符并添加到标题中。

```
$('.ls-thumb-active').attr('title', substr(tooltip, 0, strlen(tooltip) - 4)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-16T16:01:06.643

使用此代码：

```
<script type='text/javascript'>
jQuery(document).ready(function($) {
    tooltip = "mouseover";
    thumActive = $('.ls-thumb-active'); // Cached object
    // Get the source name of the image
    thumbImageSrc = $('.target-of-the-image').attr("src");
    // To slice from the last '/' if there is no '/' then slice from the very start
    thumbImageNameFirstSlice = ( thumbImageSrc.lastIndexOf( '/' ) ? thumbImageSrc.lastIndexOf( '/' ) + 1 : 0 );
    // And will slice to the last '.'
    thumbImageName = thumbImageSrc.slice( thumbImageNameFirstSlice, thumbImageSrc.lastIndexOf( '.' ) );
    // Your code =)
    thumActive.attr('title', tooltip);
    // Assign the name to the '.displaytitle'
    $('.displaytitle').html( thumbImageName );
});
</script> 
```

有一个jsFiddle：http: [//jsfiddle.net/Np6FG/1/](http://jsfiddle.net/Np6FG/1/)

# python - Python：将列表转换为生成器

> ID：16041405
> 
> 赞同：42
> 
> 时间：2013-04-16T15:45:29.850
> 
> 标签：python

说我有一个清单

```
data = []
data.append("A")
data.append("B")
data.append("C")
data.append("D") 
```

如何将其转换为生成器？任何有关示例代码的帮助将不胜感激...

找到一个网址：[http ://eli.thegreenplace.net/2012/04/05/implementing-a-generatoryield-in-a-python-c-extension/](http://eli.thegreenplace.net/2012/04/05/implementing-a-generatoryield-in-a-python-c-extension/)

这是我想做的吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2014-12-12T11:48:37.557

您确定要创建*生成器*吗？生成器是返回迭代器类型的函数，例如通过使用`yield`关键字构造（参见[term-generator](https://docs.python.org/2/glossary.html#term-generator)）。如果您真的想要这个，[steven-rumbalski](https://stackoverflow.com/users/1322401/steven-rumbalski)的答案正是您正在寻找的：

```
data_gen = (y for y in data) 
```

大多数时候，您会想要直接创建一个[*迭代器*](https://docs.python.org/2/library/stdtypes.html#iterator-types)对象，例如使用该`next()`方法。在这种情况下，答案隐含在上面[mgilson](https://stackoverflow.com/users/748858/mgilson)的评论中：

```
data_iter = iter(data) 
```

这相当于`data_iter = data.__iter__()`, cf。[功能#iter](https://docs.python.org/2/library/functions.html#iter)。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2013-04-16T15:50:48.277

```
>>> (n for n in [1, 2, 3, 5])
<generator object <genexpr> at 0x02A52940> 
```

适用于 Python 2.7.4+

```
>>> a2g = lambda x : (n for n in x)
>>> a2g([1, 2, 3, 4, 5])
<generator object <genexpr> at 0x02A57CD8> 
```

编辑：

lambda 生成器工厂模式的另一种细微变化

```
>>> a2g = lambda *args: (n for n in args)
>>> for i in a2g(1, 2, 3, 4, 5): print i

1
2
3
4
5 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-16T15:48:37.930

字面上的等价物是：

```
def data_generator():
    yield 'A'
    yield 'B'
    yield 'C'
    yield 'D' 
```

调用生成器函数会返回一个生成器迭代器。将生成器迭代器传递给列表构造函数给出：

```
>>> list(data_generator())
['A', 'B', 'C', 'D'] 
```

这个生成器迭代器也可以使用生成器表达式创建：

```
data_iter = (c for c in 'ABCD') 
```

**注意：** 您在列表中填写了四个附加语句。这通常不是你写它的方式。

而是这样做：

```
data = ['A', 'B', 'C', 'D'] 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-04-16T15:47:18.817

```
import itertools
iter_data = itertools.chain(data) 
```

像这样：

```
In [10]: data
Out[10]: [1, 2, 3, 4, 5, 6, 7, 8, 9]

In [11]: iter_data=itertools.chain(data)

In [12]: iter_data
Out[12]: <itertools.chain at 0x1ce8950>

In [13]: iter_data.next()
Out[13]: 1 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-16T15:48:44.400

您可以使用生成器功能：

```
def gen():
    for x in "ABCD":
        yield x

In [9]: it = gen()

In [10]: next(it)
Out[10]: 'A'

In [11]: next(it)
Out[11]: 'B'

In [12]: next(it)
Out[12]: 'C'

In [13]: next(it)
Out[13]: 'D' 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-16T15:47:49.277

```
>>> d = ['A', 'B', 'C', 'D']
>>> 
>>> def gen(d):
...     for i in d:
...             yield i
... 
>>> for i in gen(d):
...     print i
... 
A
B
C
D
>>> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-16T15:54:37.597

```
(item for item in listNameHere).next() 
```

如果我没记错的话，这是一般的做法。

```
>>> a = [0,1,2,3,4]
>>> x = (item for item in a)
>>> x
<generator object <genexpr> at 0x028B8440>
>>> x.next()
0
>>> x.next()
1
>>> x.next()
2 
```

等等等等

# php - 如何使用 Amazon Feed API 上传 TSV 亚马逊订单文件？

> ID：16041406
> 
> 赞同：0
> 
> 时间：2013-04-16T15:45:30.733
> 
> 标签：php, amazon-web-services, amazon, amazon-mws

我熟悉亚马逊 MWS，过去使用过报告、Feed 和产品 API，现在我想上传 TSV 订单文件以在我的亚马逊卖家中心账户中运送所有这些订单。请谁能告诉我我应该使用哪种提要类型以及我必须提交的提要的结构是什么。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:58:53.517

您的请求的 FeedType 将`_POST_FLAT_FILE_FULFILLMENT_DATA_`用于平面文件提交。

您可以在本文档中找到所有 FeedType 值：[MWS 开发人员指南（版本 2009-01-01）（第 93 页）](https://images-na.ssl-images-amazon.com/images/G/01/mws/doc/bde/feeds/v20090901/en_US/MWSDeveloperGuide._V196696164_.pdf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-31T13:48:51.780

在此处添加我添加到客户端库的代码，使其比上面的评论更具可读性：

```
//MWSFeedsClient.php

/**
 * Submits the given flat file shipping feed and returns a feed submission id
 *
 * @param string Path to the flat file shipping feed
 * @return string Feed submission id
 */
public function confirmShipmentFlatFile($feedFilePath)
{
    $feedHandle = @fopen($feedFilePath,"r");

    //Computing the MD5 hash
    $contentMD5Header = base64_encode(md5(stream_get_contents($feedHandle), true));
    rewind($feedHandle);

    //Submit the Order Fulfillment feed
    return $this->submitFeed(MarketplaceWebService_Model_FeedType::POST_FLAT_FILE_FULFILLMENT_DATA, $feedHandle, $contentMD5Header);
} 
```

# mongodb - nosql：MongoDB、Cassandra 或数据仓库的替代方案

> ID：16041411
> 
> 赞同：3
> 
> 时间：2013-04-16T15:45:48.623
> 
> 标签：mongodb, cassandra, database, nosql

我在具体决定是否使用 MongoDB 或 Cassandra 来满足我的数据库需求和希望输入我的用例以指导我的决定之间陷入困境。

*要求：*

数据源

*   X 个数据中心包含 Y 个服务器。
*   每台服务器有 N 个网络和 M 个统计信息。

例如目前（3 个数据中心，50 台服务器，19 个网络和 10 个统计数据）。这些数字会随着时间的推移而增加。

*数据获取：*

*   每小时为每个服务器解析一个 xml 页面（~20kb / page ）。（〜25mb /天）

*数据存储：*

*   有组织的（每小时、每天、每月）结构，使用聚合来查找更高的值（小时 -> 天）

*注意：*我们需要具备以下能力：

*   动态添加/删除值（数据中心/服务器/网络/统计）和可扩展性是一个关键问题，因此我们正在从 SQL 转向 NoSQL。
*   可靠性也是一个高优先级（主/从，无损坏），并且需要“简单”的可维护性。
*   写作是每小时一次，不需要“大量”的写作表现。

示例用例：在前端，您将像这样查询，选择；日期窗口、期间报告、特定数据中心、特定/所有网络、特定/所有统计数据以及结果是在服务器上总计还是单独。

```
Example #1

 - From: August 16th 2012 -> April 16th 2013
 - Period: Daily
 - Data-center: EU A
 - Stat-type: Error
 - Servers: All 
```

通过阅读 stack-overflow 和 Web 上的类似文章，我得出的结论是，我最好的选择可能是 MongoDB，因为它具有灵活的查询和与关系数据库的接近性。如果我的写作量较大，Cassandra 似乎是一种选择——尽管我确实喜欢基于列的模型。我是数据库设计和管理的新手，所以易用性也是一个因素（仍然是 CS 学生）。

从我的用例来看，哪个 NoSql 数据库是最佳选择？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T17:21:09.250

你在结论中几乎把它钉牢了。要下定决心，您主要必须在每个数据库的特权之间进行选择，即：

**卡桑德拉**：

*   更好的可用性（主/主，所以没有 SPOF）
*   更好的可扩展性：（线性，弹性）
*   更好的写入性能

**MongoDB**：

*   更好的查询（API 和原生全文搜索）
*   易于使用（各种 API、XML/JSON...）

我猜一致性不是什么大问题，无论如何它们最终都是一致的。即使 MongoDB 可能更容易上手（更接近关系数据模型），Cassandra 也不是那么难，您只需要了解面向列的范例即可。无论如何，从技术角度来看，我想答案取决于您希望系统如何扩大规模以及您的请求是否会发展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-14T22:15:34.773

您的主题是“nosql：MongoDB、Cassandra 或数据仓库的替代方案”。但是，您的描述并不完全是数据仓库。如果问题是：关于如何做一个合适的“数据仓库”，那么答案是没有这些 NOSQL 数据存储。最好的数据仓库解决方案是无共享环境中的并行数据库 (MPP)。对于查询/统计报告需求，Sybase IQ 或 Vertica 等倒排列数据库。这些（MPP 或倒排列）中的任何一个都将在真正的数据仓库环境中清理 NOSQL 的时钟。

# rally - 获取给定版本的迭代列表

> ID：16041415
> 
> 赞同：0
> 
> 时间：2013-04-16T15:46:16.010
> 
> 标签：rally

我正在尝试制作一个自定义应用程序，以提取给定版本的所有迭代。我没有看到如何做到这一点。

有什么想法或建议吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T18:43:56.067

发布和迭代之间没有编码关系。但是，如果您只是在寻找与发布处于同一时间框内的迭代，则可以使用发布的 StartDate 和 EndDate 属性作为迭代开始和结束日期的条件来查询迭代。要记住的一件事：当您查询迭代时，您将获得每次迭代的唯一条目：项目组合。如果您设置了很多项目，它们都共享相同的迭代计划，那么您将获得大量结果，这些结果在您的上下文中代表相同的事物。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T15:02:59.547

如果您正在寻找代码示例，请查看 PlanPlanPalatable 中的此代码。它使用 AppSDK 2.0 根据所选版本构建迭代树。

[https://github.com/RallyCommunity/PlanPlanPalatable/blob/master/IterationsAndReleases.js](https://github.com/RallyCommunity/PlanPlanPalatable/blob/master/IterationsAndReleases.js)

# vba - VBA WORD：匹配段落后跟图片？

> ID：16041417
> 
> 赞同：1
> 
> 时间：2013-04-16T15:46:25.193
> 
> 标签：vba, ms-word

向那些继续阅读我的问题的人道歉，这些问题彼此相似。我刚刚开始，所以最终会点击。

好的，我想消除形状之间的任何间隙（不是单词/字母）。即，如果我在连续线上有两个小形状，我想删除换行符。

我试过这个：

```
Sub RemovePicGaps()
    wrdDoc.Content.Select

    Selection.Find.ClearFormatting
    Selection.Find.Replacement.ClearFormatting

    With Selection.Find
        .Text = "^13([!A-Za-z]@)^13"
        .Replacement.Text = "\1^p"

        .Forward = True
        .Wrap = wdFindContinue
        .Format = False
        .MatchCase = False
        .MatchWholeWord = True
        .MatchWildcards = True
    End With

GoHere:
    Selection.Find.Execute Replace:=wdReplaceAll
    If Selection.Find.Execute = True Then
        GoTo GoHere
    End If

End Sub 
```

但它与我想要的不匹配，如果可能的话，我宁愿有一些特定于图片的东西（而不仅仅是“不是字母”）。

编辑：她我想要发生的事情：这个： ![在此处输入图像描述](https://i.stack.imgur.com/vMwxL.png)

至： ![在此处输入图像描述](https://i.stack.imgur.com/R40MJ.png)

对于那些感兴趣的人，这些是口腔解剖的图片。非常令人兴奋的无聊。

# windows - 错误：无法在 Windows 7x64 上构建 gem 原生扩展

> ID：16041418
> 
> 赞同：1
> 
> 时间：2013-04-16T15:46:25.573
> 
> 标签：windows, gem, appfog

我一直在遵循开发工具包为 ruby​​installer
[https://github.com/oneclick/rubyinstaller/wiki/Development-Kit提供的说明](https://github.com/oneclick/rubyinstaller/wiki/Development-Kit)

当我尝试最后一步时，出现以下错误：
错误：无法构建 gem 原生扩展

这是日志文件。 [http://pastebin.com/mLUCCVd3](http://pastebin.com/mLUCCVd3)

我一直在关注[故障排除](https://github.com/oneclick/rubyinstaller/wiki/Troubleshooting#wiki-gems_fails_comspec_autorun)部分，但无济于事。

运行 windows7x64 这一切都开始了，因为我想让 appfog`tunnel`工作

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T20:29:01.340

我看到一些东西表明 32 位和 64 位构建之间不匹配。

除了查看您的错误日志之外，没有做任何事情，我看到了两件事。

首先，“c:/Ruby192/include/ruby-1.9.1/ruby/ruby.h:112:14: 错误：数组‘ruby_check_sizeof_voidp’的大小为负数”

其次，所有“警告：从不同大小的整数转换为指针[-Wint-to-pointer-cast]”消息。

在第一种情况下，32 位无符号整数值 0xFFFFFFFF 是有符号整数值 -1；在 64 位中，它仍然是 0x00000000FFFFFFFF。在第二种情况下，对于 32 位和 64 位窗口，sizeof(int) 都是 4；在 win32 中，sizeof(*T) 为 4，但在 64 位 Windows 中，sizeof(*T) 为 8，因此，在 32 位中，sizeof(int) == sizeof(*T)，但在 win64 中没有。

在构建脚本、命令行和预处理器定义中寻找矛盾的架构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-04T17:27:43.213

在您最初的尝试中，您似乎使用的是 ruby​​ 1.9.x。我最近尝试在 1.9.3 中安装 json，我遇到了一些与您相同的错误，特别是：

```
c:/Ruby192/include/ruby-1.9.1/ruby/missing.h:42:8: error: redefinition of 'struct timezone' 
```

事实证明，这是因为我使用的是最新版本的 devkit……您需要使用“旧”devkit，我相信它最近已重命名为适用于 1.9.x 和 1.8.7 的“tdm” （我最初将那里的信息页面解释为意味着 tdm 用于 1.8.x，因为浏览速度太快并且过去已经这样做了很多次，而且就语言本身而言，1.9 与 2.0 的兼容性远胜于1.8 到 1.9）。

在您的第二次尝试中（在您对另一个答案的评论中注明）您切换到使用 ruby​​ 2.0，您的 gem 可能与它完全不兼容，idk，这完全是另一个蠕虫罐头。

# sql - 根据变量/查询结果选择列的优雅方式？

> ID：16041423
> 
> 赞同：3
> 
> 时间：2013-04-16T15:46:40.097
> 
> 标签：sql, sql-server, sql-server-2008

我有一个标量函数，它返回`VARCHAR`一个列名。

我想使用此结果作为选择查询的基础，因此：

```
SELECT dbo.udf_GetColName('Val1', ColumnFromThisTable, etc) AS myCol
FROM tbl_ThisTable WHERE ... 
```

目前，这正确列出了每个值的 UDF 的实际输出，即列名。

我想要的是 select 语句返回从函数返回*的列的值*，所以：

```
SET @sql = 'SELECT ' + dbo.udf_GetColName('Val1', ColumnFromThisTable, etc) + ' AS myCol
FROM tbl_ThisTable WHERE ... ' 
```

并运行`EXEC sp_executesql`

有没有比动态 SQL 路由更好的方法？SQL 可以通过某种方式将该列作为 UDF 的输出进行查询？

* * *

***编辑添加***

这是业务需要管理选择输出的规则的地方，因此它们需要位于可更新的表中。如果它们被硬编码到`SELECT`表值函数中，那么控制它们的不再是业务。

所以是的，查询是非常可定制的，但在这种情况下会是“一件好事”。

此外，有有限数量的参数`udf_GetColName`。它接收一个源列名，一个源列值，它在规则表中进行查找。如果规则找到该列与该值的匹配，`output column`则选择并返回一个，否则使用默认值`output column`。这是需要选择的列，因此可能与输入或输入值完全不同。

如前所述，我很高兴听到任何其他想法，当然如果这很愚蠢，应该选择另一条路线！

* * *

***回家前一天的最后编辑***

我正在寻找一种方法来`tbl_ThisTable`根据 中的其他列值选择要使用的列`tbl_ThisTable`。

这些关于使用哪一列的规则需要在表中轻松更新 - 主要限制是数据库的接口/前端 - 我们只能返回直接数据集，因此不能使用前端做出此决定/连接多个数据集等...

如果有部署这些规则的好方法，可以在数据库中更新而无需重写代码，我很想听听。我现在只是在测试这个，所以设计很灵活。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T15:51:04.523

我能想到的唯一其他方法是使用 case 语句：

```
select (case when udf_GetColName('Val1', . . .) = 'Col1' then Col1
             when udf_GetColName('Val1', . . .) = 'Col2' then Col2
             . . .
       ) as MyCol
from tbl_ThisTable . . . 
```

动态 SQL 似乎更简单。但是，在这两种情况下，都要小心类型。使用`case`，这将返回第一个 的类型`then`。对于动态 SQL，返回值的类型取决于基础列的类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:04:48.390

倒带，

而不是

```
SET @sql = 
    'SELECT ' + dbo.udf_GetColName('Val1', ColumnFromThisTable, etc) +
        ' AS myCol FROM tbl_ThisTable WHERE ... ' 
```

为什么不做

```
SELECT Val1 [myCol] FROM tbl_ThisTable WHERE ... 
```

首先？

让调用者进行分支。

* * *

我的意思是，使用您选择的 ORM 在客户端中生成您的 SQL。

**编辑**

* * *

使用`sp_executesql`和阅读[Sommarskog](http://www.sommarskog.se/dynamic_sql.html)

更一般地说，我相信您的数据可以通过连接条件而不是动态列选择来实现您想要的方式进行规范化。如果没有实际的架构和示例数据，我无法完全想象答案。

# php - If 语句检查提交 (PHP)

> ID：16041429
> 
> 赞同：-1
> 
> 时间：2013-04-16T15:46:54.107
> 
> 标签：php, if-statement

我正在尝试创建一个简单的 payment.php 文件来处理来自 buyaticket.html 文件的表单发布。

我需要写一个 if 语句，这样网站就会显示这个：`

```
<h1>Thanks, customer!</h1>
<p>Your information has been recorded.</p>

<dl>
    <dt>Name:</dt>
    <dd><?php print $_POST['name']; ?></dd>
    <dt>Seat:</dt>
    <dd><?php print $_POST['seats']; ?></dd>
    <dt>Credit Card Type:</dt>
    <dd><?php print $_POST['cardtype']; ?></dd>
    <dt>Credit Card Number:</dt>
    <dd><?php print $_POST['creditcardnumber']; ?></dd>
</dl>` 
```

如果填写了所有姓名（姓名、座位、卡类型、信用卡号）。此外，creditcardnumber 必须是 int。

如果它们没有填写（即空或空），那么我需要显示一个简单的 html 标记，说明您没有正确填写表格。

谁能帮我解决我的问题？我需要知道如何编写一个 IF 语句，如果输入（姓名、信用卡号等）留空，将显示错误消息，如果它们已填写，我将显示上述代码，显示所有用户输入信息。

这就是我正在玩的（不是我的实际代码。只是想法）：

```
if empty('name') or empty('cardtype') or empty('seats') or empty('creditcardnumber') 
  <h1>You have filled out the form incorrectly</h1>
else
  <dl>
  </dl? 
```

但我也不知道如何检查 creditcardnumber 是否为整数。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:54:06.580

切勿使用 is_numeric 而是使用校验和和模式检查信用卡号。

这是一个很好的答案： [在 PHP 中验证信用卡的最佳方法是什么？](https://stackoverflow.com/questions/174730/what-is-the-best-way-to-validate-a-credit-card-in-php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:53:23.787

```
if (isset($_POST['name']) && isset($_POST['name']) && isset($_POST['cardtype']) && isset($_POST['cardtype']) && isset($_POST['creditcardnumber']) && is_int($_POST['creditcardnumber']))
{echo('good job');}
else {echo('bad job');} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T15:52:18.900

您可以使用函数检查天气信用卡号是否为整数

[is_numeric](http://php.net/is_numeric)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T15:49:46.933

检查`is_numeric()` 这是您需要的功能。 [http://www.php.net/manual/en/function.is-numeric.php](http://www.php.net/manual/en/function.is-numeric.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-16T16:00:38.353

你可以简单地写

```
<?php

if($_POST['name'] && $_POST['seats'] && $_POST['cardtype'] && $_POST['creditcardnumber']){

//your action for displaying input

}else{
?>
<h1>You have filled out the form incorrectly</h1>
<?php
}

?> 
```

尽管我建议在您的提交按钮中添加一个名称，以验证表单是否确实已提交。假设您的提交按钮的名称是“提交”。

```
 <?php

    if($_POST['submit']){

    //your validation code
     if($_POST['name'] && $_POST['seats'] && $_POST['cardtype'] && $_POST['creditcardnumber']){
    ...
    }else{
    //prompt user for incomplete fields
    }

    } 
?> 
```

# javascript - 如何在 javascript 中解析 Facebook 页面状态？

> ID：16041430
> 
> 赞同：0
> 
> 时间：2013-04-16T15:46:58.980
> 
> 标签：javascript, facebook, facebook-javascript-sdk

在此链接[https://developers.facebook.com/docs/reference/javascript/FB.XFBML.parse/](https://developers.facebook.com/docs/reference/javascript/FB.XFBML.parse/) 中，没有 Facebook 状态解析选项。

例如[https://www.facebook.com/adidas](https://www.facebook.com/adidas)，如何在我的网站中解析此页面的顶部状态。

请帮忙，谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:54:21.310

在这方面，您不是指“解析”方法，如果我理解正确，您想使用 api 在您的网站上显示状态吗？Parse 用于动态渲染 xfbml 标记。对于您想要使用 api 调用（例如 FB.api）的状态，您需要设置一个应用程序并使用 access_token 发出请求

[https://graph.facebook.com/adidas/posts](https://graph.facebook.com/adidas/posts)

可以在[https://graph.facebook.com/adidas访问公共信息（没有 access_token）](https://graph.facebook.com/adidas)

此处提供有关 javascript api 的更多信息

[https://developers.facebook.com/docs/getting-started/graphapi/](https://developers.facebook.com/docs/getting-started/graphapi/) [https://developers.facebook.com/docs/reference/javascript/FB.api/](https://developers.facebook.com/docs/reference/javascript/FB.api/)

# c# - 如何通过名称迭代访问对象（OName1、OName2、OName3...）

> ID：16041432
> 
> 赞同：0
> 
> 时间：2013-04-16T15:47:04.383
> 
> 标签：c#, .net, winforms, loops, reference

我在一个winform（文本框/复选框）中有一堆字段，它们的名称非常相似，并附加了数字。例如，AName1、BName1、CName1，然后是 AName2、BName2、CName2 等。我想做的是在 forloop 中遍历它们，如下所示：

```
for (int i = 0, i<4, i++)
{
    ANamei.Text = blah;
    BNamei.Text = blah;
    CNamei.Text = blah;
} 
```

显然，上面代码中的 i 不起作用。我的问题是，如何在循环中访问给定此变量的文本框对象？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:59:14.957

您可以将所有控件添加到数组中，然后遍历数组：

```
private readonly Control[] m_Controls;

public MyControl() {
    InitializeComponent();

    m_Controls = new[] {
        AName1, AName2, AName3,
        BName1, BName2, BName3,
    }
}

private void DoStuff(string text) {
    foreach (Control c in m_Controls) {
        c.Text = text;
    }
} 
```

或者，如果您真的不想拥有硬编码列表，并且控件都是您运行代码的控件的一部分，则可以使用 Controls 集合：

```
private void DoStuff(string text) {
    for (int i=0; i<4; i++) {
        this.Controls["AName" + i].Text = text;
    }
} 
```

但是，如果表单上有很多控件，这会很慢，因为它会线性扫描表单上的每个控件，直到找到具有指定名称的控件。

编辑：对于多个 repititions，您可以使用嵌套循环：

```
for (string prefix in new[] { "A", "B", "C", ...}) {
    for (int i=0; i<4; i++) {
        this.Controls[prefix + "Name" + i].Text = text;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:04:53.540

如果你必须为这个类的成员命名，你也可以用反射来做，但这可能有点矫枉过正，也比@thecoop的解决方案慢，但这里有一个小样本，仅供参考：

```
class MyObject
{
    public string Text { get; set; }
}

class MyClass
{
    private MyObject _myObject1 = new MyObject();
    private MyObject _myObject2 = new MyObject();
    private MyObject _myObject3 = new MyObject();

    public void Foo()
    {
        for (int i = 1; i < 4; i++)
        {
            // get the member of this type MyClass
            var member = GetType().GetMember("_myObject" + i, BindingFlags.Instance | BindingFlags.NonPublic);
            var fieldInfo = (FieldInfo)member[0];
            // get the value of the member info
            var field = fieldInfo.GetValue(this);
            // get the property to set
            var propertyInfo = field.GetType().GetProperty("Text");
            // set the value
            propertyInfo.SetValue(field, "my text", null);
        }

    }
} 
```

# java - 根据 Map 中 TreeSet 中的值范围返回键

> ID：16041435
> 
> 赞同：0
> 
> 时间：2013-04-16T15:47:11.877
> 
> 标签：java, map, integer, set

第一次在这里发帖，我对 Java（和一般编程）非常陌生！

我试图了解当地图包含其他集合时如何操作地图。我正在尝试编写代码来将名称存储为针对 Map 中的整数集的值的键。然后，我希望能够返回具有在给定范围内的元素的任何值的键。

```
Map<String, Set<Integer>> index = new TreeMap<>();
Set<Integer> numbers = new TreeSet<>;

numbers.add(80);
numbers.add(90);
numbers.add(100);
index.put("Adam", numbers);

numbers = new TreeSet<>();
numbers.add(30);
numbers.add(40);
numbers.add(50);
index.put("Eve", numbers); 
```

我现在有一个带有键“Adam”和 Value [80,90,100] 的条目和另一个带有键“Eve”和 Value [30,40,50] 的条目的 Map。至少我认为我有！

我现在希望能够返回任何包含在给定范围内的键值的名称。

例如，如果范围是 25 到 50，则返回值为“Eve”。如果范围是 50 到 85，则返回值将是“Adam”和“Eve”。

我认为 containsValue() 可能有效但无效（因为 Set？）。

任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:07:46.800

在不改变您的设计的情况下，我能想到的唯一方法是遍历地图和每个值集，但这不是很有效：

```
public Set<String> containsRange(Map<String, Set<Integer>> index, int lowerBound, int upperBound){
    Set<String> result = new HashSet<>();
    for (Map.Entry<String, Set<Integer>> entry : index.entrySet()) {
        String string = entry.getKey();
        for (Integer integer : entry.getValue()) {
            if (integer >= lowerBound && integer <= upperBound) {
                result.add(string);
                break;
            }
        }
    }
    return result;
} 
```

未测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:49:05.603

我认为您无法使用任何标准地图方法来完成此操作。特别是，地图非常适合通过键访问事物，但不能通过值访问。

我认为在这种情况下，您最好创建一个自定义对象的列表。自定义对象将包含值列表和字符串。当您想要获取具有该范围内的值的所有字符串时，您将遍历列表并用匹配的字符串填充一个新列表。

这是它的样子：

```
List<RangedString> index = new ArrayList<RangedString>();
...
public List<String> getStringInRange(int low, int high) {
    List<String> results = new ArrayList<String>();
    for (RangedString rangedString : index) {
        if (rangedString.inRange(low, high)) {
            results.add(rangedString.getString());
        }
    }
} 
```

该`RangedString.inRange`方法如下所示：

```
Set<Integer> values;
...
public boolean inRange(int low, int high) {
    for (Integer value : values) {
        if (value >= low && value <= high) {
            return true;
        }
    }
    return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T15:54:14.417

第一眼就能想到这个算法

1）制作一个Hashset来存储关键结果

2）迭代thu map，然后是每个集合的elemnet。

3) 将其与输入范围进行比较。

4）如果它在那里，则将其添加到哈希集中。

5）就是这样

这里使用哈希集，因为它将确保唯一的键结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T15:54:28.917

您必须编写一个自定义逻辑来遍历地图中每个条目的每个集合，并在它落在所需范围内时获取条目的相应键。

# c - 如何在 Fortran 中读取在 C 中可读的二进制文件

> ID：16041436
> 
> 赞同：1
> 
> 时间：2013-04-16T15:47:13.050
> 
> 标签：c, binary, fortran

我有一个二进制文件，可以用 C 读取，代码如下

```
 int it,ix; 
  double par1,par2,par3,par4,par5,par6; 

  fp = fopen("my_binary_file", "r"); 
  assert(fp != NULL); 
  fscanf(fp, "%d %lf %lf %lf \n",&it, &par1, &par2, &par3);
  fscanf(fp, "%d %lf %lf %lf \n",&ix, &par4 ,&par5,&par6); 
```

我尝试使用这段代码在 Fortran 90 中读取相同的文件

```
 real(kind=8):: par1,par2,par3,par4,par5,par6
  integer :: it,ix

  open(1,file='my_binary_file',form='unformatted')

  read(1) it,par1,par2,par3
  read(1) ix,par4,par5,par6 
```

但我收到文件结束错误。我试着一起读这两行

```
 read(1) it,par1,par2,par3,ix,par4,par5,par6 
```

我读了一些东西，但参数不是我所期望的。这意味着我正在读取错误的字节或变量的声明是错误的。你觉得你能帮上忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:33:22.353

您的 C 代码看起来不像读取通常称为二进制的内容。如果它是 C 二进制文件，则必须使用隐式使用的`STREAM`input，而不是。`SEQUENTIAL`只需尝试正常格式化的列表导向输入。

```
open(10,file='my_binary_file')

read(10,*) it,par1,par2,par3
read(10,*) ix,par4,par5,par6 
```

如果文件中有更多内容，请显示它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T18:19:07.573

在 C 侧

1）您的 C 二进制文件应该已打开为“rb”以进行二进制读取。2) fscanf 不用于读取二进制文件。它们通常使用 fread 读取。3）如果它有效，假设它是一个文本文件

在 Fortran 方面，4) 因为它是一个文本文件，所以表单应该是“格式化”的。5) 每次在 Fortran 中读取后，文件指针都会移动到下一行。这与 C 中的行为不同。 6) 如果您不想弄乱格式语句，请使用自由格式读取来获取数据。

# reporting-services - SSRS IIF 评估所有字段

> ID：16041437
> 
> 赞同：2
> 
> 时间：2013-04-16T15:47:13.037
> 
> 标签：reporting-services, iif

我有一个使用 SSRS 2008 的表外的文本框。我正在尝试使用下面的代码确定任何行是否包含 2、3 或 4。这有效，但仅适用于第一行。

有没有办法让这个评估所有字段而不仅仅是第一行？

提前感谢。

```
=IIf(

    (
            Fields!Type.Value = "2"
            Or Fields!Type.Value = "3"
            Or Fields!Type.Value = "4"
        )

        , "Yes, found it.", "No, it's missing"

) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:09:03.507

除非您定义不支持的范围/数据集，否则它将`IIf` **不起作用**。您可以通过以下方式解决此问题：

*   创建一个`Code`将更新您的外部文本框 ( `Right click on the report > Report properties > Code tab`)
*   在表中使用您的表达式。

这些是我能想到的唯一解决方案。

**更新** 我只是想到了一个对我有帮助的解决方案。

```
=IIf(
    Sum(
        IIf(Fields!Type.Value=2, 1, 0), 
        "YourDataSet"
    ) = 0, 
    "Not Found",
    "found " & Fields!Type.Value
) 
```

不确定这是否适用于您的范围，但这是另一种解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:22:21.263

使用以下表达式：

```
IIF(SUM(IIF(Fields!Type.Value = "2" OR Fields!Type.Value = "3" OR Fields!Type.Value = "4",1,0),"DataSet1")>0,"Yes, found it.", "No, it's missing") 
```

其中*DataSet1*是您的数据集的名称

它的作用是计算找到值 2、3 或 4 的次数。如果计数大于 0，则该值存在，因此它将显示“是的，我找到了”

# user-interface - 如何在 EmberJS 中实现图版视图

> ID：16041442
> 
> 赞同：0
> 
> 时间：2013-04-16T15:47:31.300
> 
> 标签：user-interface, ember.js, implementation

我是一名 Rails 开发人员，并且是 EmberJS 的新手，我需要一些帮助来实现 UI，因为它在 javascript 代码中很重，我想尝试 Ember

这是我想要完成的

![在此处输入图像描述](https://i.stack.imgur.com/oWn78.jpg)

当我单击 GraphEditor 时，它会添加一个新演员并显示新演员弹出框

问题是 UI 元素是用 SVG 标签制作的，以便可以缩放、平移和类似的东西

我的问题是

*   哪些控制器跟踪演员和关系？如何从 SocialNetwork 显示视图中调用它们？
*   如何渲染 Actors 和 Relations 视图？{{render}} 不能多次工作，我需要将视图属性与模型属性绑定（渲染部分类型：'演员'，演员：演员）
*   如何创建 Actor/Relation Details Popover 视图？
*   您如何构建视图层次结构以实现此目的？我的建议是拥有这种嵌套视图层次结构。

![在此处输入图像描述](https://i.stack.imgur.com/Bvqv5.jpg)

对一般问题感到抱歉，但我在 Ember 中实现它，因为它是一个绑定到数据的复杂视图，我不知道如何实现它。任何初步的见解都会很有用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:51:49.300

> 哪些控制器跟踪演员和关系？

可能您`ActorsController`将是一个带有演员列表的数组控制器，并且该列表将填充到`SocialNetwork`路由的`setupController`钩子中。可以对关系做同样的事情，或者它们可以通过参与者访问，这取决于你的模型数据的结构。

> 如何从 SocialNetwork 显示视图中调用它们？

添加`needs: ['actors'] to`SocialNetworkController `so that the property`controllers.actors` 将可用。

> 如何渲染 Actors 和 Relations 视图？

使用`{{each}}`helper 来遍历参与者/关系列表，并指定 itemController 属性，以便将每个参与者包装在`ActorController`

```
{{#each actor in controllers.actors itemController="actor"}}
  {{actor.name}} {{#if actor.isAwesome}}***AWESOME****{{/if}}
{{/each}} 
```

> 如何创建 Actor/Relation Details Popover 视图？

假装它不是弹出窗口，让它工作，以便细节显示在某些 div 中，就好像你在做一个普通的主/细节视图一样。然后，一旦它开始工作，自定义详细视图的 didInsertElement fx 以便它显示在弹出窗口中。

> 您如何构建视图层次结构以实现此目的？

有很多方法可以做到这一点，这是一个（未经测试的）草图。我假设 GraphEditorView 会处理 SVG 的东西——否则这个视图并不是真正需要的。

```
<!-- social_network.hbs -->
<h3>Network Name: {{name}}</h3>
{{view "App.GraphEditorView"}}

<!-- graph_editor.hbs -->
<h3>Network Name: {{name}}</h3>
{{#each actor in controllers.actors itemController="actor"}}
  <g class="actor" {{action showDetails}}>
    <circle></circle>
    <text>{{actor.name}}</text>
  </g>
  {{#if actor.isShowingDetails}}
    {{render actorDetails actor}}
  {{/if}}
{{/each}} 
```

> 对一般问题感到抱歉，但我在 Ember 中实现它，因为它是一个绑定到数据的复杂视图，我不知道如何实现它。任何初步的见解都会很有用

不用担心。也许看到这个相关的帖子也许有助于了解这些概念如何应用于其他人的应用程序：[ember.js 显示项目列表，每个项目都有自己的视图/控制器](https://stackoverflow.com/questions/14612663/ember-js-displaying-list-of-items-each-item-with-its-own-view-controller)

# matlab - 矩阵中 n 个最大元素的行和列索引

> ID：16041445
> 
> 赞同：0
> 
> 时间：2013-04-16T15:47:36.267
> 
> 标签：matlab

我有一个与此处解决的问题非常相似的问题：

[获取矩阵中 n 个最大元素的索引](https://stackoverflow.com/questions/2692482/get-the-indices-of-the-n-largest-elements-in-a-matrix)

但是，此解决方案将矩阵转换为数组，然后根据新数组给出索引。

我想要最大（和最小）n 值的原始矩阵的行和列索引。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:01:01.397

如果您采用该问题中的解决方案来找到 5 个最大的唯一值

```
sortedValues = unique(A(:));          %# Unique sorted values
maxValues = sortedValues(end-4:end);  %# Get the 5 largest values
maxIndex = ismember(A,maxValues);     %# Get a logical index of all values
                                      %#   equal to the 5 largest values 
```

您将获得匹配的那些值的逻辑矩阵。您可以使用`find`获取它们的索引，然后[`ind2sub`](http://www.mathworks.co.uk/help/matlab/ref/ind2sub.html)将它们转换回坐标。

```
idx = find(maxIndex);
[x y] = ind2sub(size(A), idx); 
```

根据评论，另一种选择：

```
[foo idx] = sort(A(:), 'descend'); %convert the matrix to a vector and sort it
[x y] = ind2sub(size(A), idx(1:5)); %take the top five values and find the coords 
```

注意：上述方法不会消除任何重复值，因此例如，如果您有两个具有相同值的元素，它可能会返回两个元素，或者如果它们在边界上，则只返回两个元素之一。

# string-formatting - 我可以格式化 Extj groupHeader

> ID：16041449
> 
> 赞同：0
> 
> 时间：2013-04-16T15:47:40.990
> 
> 标签：string-formatting, extjs4.1, trim

这是我的群组功能

```
this.myGroupingFeature = Ext.create('Ext.grid.feature.Grouping', {
        groupHeaderTpl: '{name}'
    }); 
```

我想要的是修剪第一个字符。有没有办法做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T16:52:12.500

我找到了一个解决方案，伙计们……给任何需要这个的人……在这里

```
this.myGroupingFeature = Ext.create('Ext.grid.feature.Grouping', {
    groupHeaderTpl: '{[values.name.substring(1)]}' }
); 
```

# iphone - 核心数据获取数组objective-c中的信息

> ID：16041451
> 
> 赞同：1
> 
> 时间：2013-04-16T15:47:41.910
> 
> 标签：iphone, ios, objective-c, core-data

我对Objective-C很陌生。我一直在尝试从我的核心数据实体中获取。以下代码获取正确的行，因为它只返回 1 个结果。但是当我尝试`NSlog()`查看它的值时，我得到的是：

```
iGym[3922:c07] (
    "<User: 0x8397690> (entity: User; id: 0x8341580 <x-coredata://114815EF-85F4-411F-925B-8479E1A94770/User/p19> ; data: <fault>)"
) 
```

我习惯了 PHP，我只是做一个`var_dump()`，我得到了数组中的所有信息......特别是当我期待 16 个结果时，因为这个实体有 16 个字段。

谁能告诉我如何检查那个数组？而且，最重要的是，我最终如何做到这一点：获取`Gender`匹配`email`字段的字段并将其分配给一个`NSString`变量。

我想在 sql 中执行的查询是`SELECT Gender FROM myTable WHERE email = "something@something.com;`

```
-(NSInteger*)selectedGenderMethod
{
    NSEntityDescription *entityDesc = [NSEntityDescription entityForName:@"User" inManagedObjectContext:context];
    NSFetchRequest *request = [[NSFetchRequest alloc] init];
    [request setEntity:entityDesc];

    request.predicate = [NSPredicate predicateWithFormat:@"email = %@",_currentUser];
    NSError *error = nil;
    NSArray *matches = [[context executeFetchRequest:request error:&error] mutableCopy];
    NSString * someVar= [matches[0] objectForKey:@"email"];
    NSLog(@"%@",someVar);
//More to come once this is sorted
    return 0;
} 
```

这个获取代码发生在我的`genderPickerViewController : UIViewController`

```
NSLog(@"%@", matches[0]); 
```

返回

```
<User: 0x83a6b00> (entity: User; id: 0x83995f0 <x-coredata://114815EF-85F4-411F-925B-8479E1A94770/User/p19> ; data: <fault>) 
```

这是我的`User.h`：

```
#import <Foundation/Foundation.h>
#import <CoreData/CoreData.h>

@interface User : NSManagedObject

@property (nonatomic, retain) NSDate * dob;
@property (nonatomic, retain) NSString * email;
@property (nonatomic, retain) NSNumber * firstTime;
@property (nonatomic, retain) NSString * gender;
@property (nonatomic, retain) NSString * height;
@property (nonatomic, retain) NSNumber * idFB;
@property (nonatomic, retain) NSNumber * idUserExternal;
@property (nonatomic, retain) NSNumber * idUserInternal;
@property (nonatomic, retain) NSNumber * isPT;
@property (nonatomic, retain) NSString * language;
@property (nonatomic, retain) NSString * metricSystem;
@property (nonatomic, retain) NSString * name;
@property (nonatomic, retain) NSString * nickname;
@property (nonatomic, retain) NSString * password;
@property (nonatomic, retain) NSString * surname;
@property (nonatomic, retain) NSString * weight;

@end 
```

`User.m`：

```
@implementation User

@dynamic dob;
@dynamic email;
@dynamic firstTime;
@dynamic gender;
@dynamic height;
@dynamic idFB;
@dynamic idUserExternal;
@dynamic idUserInternal;
@dynamic isPT;
@dynamic language;
@dynamic metricSystem;
@dynamic name;
@dynamic nickname;
@dynamic password;
@dynamic surname;
@dynamic weight;

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:56:19.307

您所做的是对的，您通常会获得完整的对象而不仅仅是一个属性，Core Data 是一个对象存储。

所以只需要`[((User *)matches[0]) gender]`获取返回用户的性别即可。如果你想从对象中获取一些额外的信息，你必须实现：

```
- (NSString *)description 
```

它用于转换为字符串和记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:59:24.097

您可以使用以下代码，

```
[NSPredicate predicateWithFormat:@"email CONTAINS[c] %@", _currentUser]; 
```

或者

```
[NSPredicate predicateWithFormat:@"email CONTAINS[cd] %@", _currentUser]; 
```

然后您可以将获取的结果打印为`po OBJECT_NAME.PROPERTY`调试区域中的类型

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T15:53:51.120

用户对象是 a`NSDictionary`还是`NSArray`偶然？如果是这种情况，您只是简单地注销对象，则需要在对象中指定要输出的特定实体。

例如，如果它是一个`NSDictionary`

```
NSString *name = [matches[0] objectForKey:@"name"];
NSLog("Name %@", name); 
```

你也可以试试

```
NSString *email = (User *)matches[0].email;
NSLog("Email %@", email); 
```

# ruby-on-rails - Rails 3 ActionMailer 损坏附件

> ID：16041452
> 
> 赞同：2
> 
> 时间：2013-04-16T15:47:42.833
> 
> 标签：ruby-on-rails, ruby, actionmailer

我正在使用 Rails 3.2.13，并且一直在遵循 ActionMailer 指南（[http://guides.rubyonrails.org/action_mailer_basics.html#sending-emails-with-attachments](http://guides.rubyonrails.org/action_mailer_basics.html#sending-emails-with-attachments)），但我在发送电子邮件时遇到了困难附件。

执行后，电子邮件正确发送，但附件始终损坏。特别是，我看到呈现的电子邮件和附件的正确文件名，但作为无法打开的 1KB 文件。我已经在堆栈溢出和其他地方看到过类似的问题（例如[Rails 3: Sending Mail with Attachment - 第一次发送后文件损坏](https://stackoverflow.com/questions/15667565/rails-3-sending-mail-with-attachment-corrupted-file-after-first-send)和[Rails 3.0.7 ActionMailer 附件问题](https://stackoverflow.com/questions/6105561/rails-3-0-7-actionmailer-attachment-issue)），但所提供的解决方案都无法提供帮助。我尝试了两种不同的传输方式（Gmail SMTP 和 Sendgrid）、几种文件类型（png、pdf 等），以及内联附件和普通附件，但效果始终相同。

这是邮件程序的代码：

```
class UserMailer < ActionMailer::Base

    # A hash of default values for email messages
    default from: "me@mysite.com"

    def welcome_email(user)
        @user = user
        @url = "http://localhost:3000"

        attachments['logo_email.png'] = File.read("public/img/logo_email.png")

        mail(:to => user.email, :subject => "Welcome")
    end
end 
```

我在我的控制器中调用它的地方看起来像这样（我在这里使用delayed_job，但即使没有它，附件也已损坏）：

```
UserMailer.delay.welcome_email(@user) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-28T16:53:46.290

显然，这是文件如何（不）读入的仅限 Windows 的行为。您需要为 Windows 中的 Ruby 指定“r”（只读）和“b”（二进制）才能正确读取它。 [http://ruby-doc.org/core-1.9.3/IO.html](http://ruby-doc.org/core-1.9.3/IO.html)

请参阅以下相关问题

[将本地文件的内容读入 Rails 中的变量](https://stackoverflow.com/questions/3055339/read-contents-of-a-local-file-into-a-variable-in-rails)

尝试以下操作：

`attachments['logo_email.png'] = File.read("public/img/logo_email.png", mode: "rb")`

# flash - AS2 getAscii 在 Google Chrome 中没有获得 Caps Lock

> ID：16041457
> 
> 赞同：2
> 
> 时间：2013-04-16T15:47:51.960
> 
> 标签：flash, google-chrome, actionscript, keyboard, actionscript-2

我正在使用 Flash AS2（没有其他选项）来获取用户键入的字母。

似乎在 Google Chrome 中，我得到的 Ascii 代码与平时不同。

我在激活“Caps Lock”后输入“P”进行测试。我正在跟踪 Key.getCode() 和 Key.getAscii() 返回的内容。

在 Firefox 或 IE 甚至独立播放器中：

*   大写锁定 => Key.getCode() : 80 ; Key.getAscii() : 80
*   大写锁定关闭 => Key.getCode() : 80 ; Key.getAscii() : 112

在 Chrome 中，Caps Lock 似乎总是关闭：

*   大写锁定 => Key.getCode() : 80 ; Key.getAscii() : 112
*   大写锁定关闭 => Key.getCode() : 80 ; Key.getAscii() : 112

结果，我无法在 Chrome 上打开或关闭 Caps Lock ......

有没有人见过这个问题？

* * *

编辑：补充测试：

请注意，测试是使用法语 AZERTY 键盘进行的

谷歌浏览器

1

*   pad => Key.getCode()=97 -> a ; Key.getAscii()=49 -> 1
*   正常 => Key.getCode()=49 -> 1 ; Key.getAscii()=49 -> 1
*   shift => Key.getCode()=49 -> 1 ; Key.getAscii()=33 -> ！
*   大写 => Key.getCode()=49 -> 1 ; Key.getAscii()=49 -> 1

一个

*   正常 => Key.getCode()=65 -> A ; Key.getAscii()=97 -> 一个
*   shift => Key.getCode()=65 -> A ; Key.getAscii()=65 -> A
*   大写 => Key.getCode()=65 -> A ; Key.getAscii()=97 -> 一个

其他

1

*   pad => Key.getCode()=97 -> a ; Key.getAscii()=49 -> 1
*   正常 => Key.getCode()=49 -> 1 ; Key.getAscii()=38 -> &
*   shift => Key.getCode()=49 -> 1 ; Key.getAscii()=38 -> &
*   大写 => Key.getCode()=49 -> 1 ; Key.getAscii()=38 -> &

一个

*   正常 => Key.getCode()=65 -> A ; Key.getAscii()=97 -> 一个
*   shift => Key.getCode()=65 -> A ; Key.getAscii()=65 -> A
*   大写 => Key.getCode()=65 -> A ; Key.getAscii()=65 -> A

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T02:30:48.900

尝试根据 Caps Lock 键[`isToggled()`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/2/help.html?content=00001148.html)与否来编写代码。

您可以添加`32`到任何大写字母以获得其小写匹配（或使用`String.toLowerCase()`），您可以从任何小写字母中减去`32`以获得大写匹配（或使用`String.toUpperCase()`）。

```
//this code would change a whole string, but you can 
//do it with individually entered characters
if(Key.isToggled(Key.CAPSLOCK)){
    String.fromCharCode(Key.getCode()-32);
}else{
    String.fromCharCode(Key.getCode());
} 
```

# android - 带有 Ksoap2 的自定义标头

> ID：16041463
> 
> 赞同：0
> 
> 时间：2013-04-16T15:48:15.840
> 
> 标签：android, soap, ksoap2

我需要我的标题看起来像这样：

```
 <soap:Header>
    <ListAuthenticationHeader XmlAttribute="" xmlns="http://example.com/services">
      <ApiKey>1234567890</ApiKey>
    </ListAuthenticationHeader>
  </soap:Header> 
```

我试过了

```
List<HeaderProperty> headerPropertyList = new ArrayList<HeaderProperty>();
headerPropertyList.add(new HeaderProperty("ApiKey","1234567890"));
HttpTransportSE ht = new HttpTransportSE(URL);
ht.call(SOAP_ACTION, envelope, headerPropertyList); 
```

但这不起作用，服务器响应拒绝访问。

# android - 是否可以在不设置 Eclipse 的情况下运行 Android 模拟器

> ID：16041470
> 
> 赞同：8
> 
> 时间：2013-04-16T15:48:34.993
> 
> 标签：android, android-emulator

是否可以在不设置 Eclipse 的情况下运行 Android 模拟器。我正在与一个为我提供 .apk 文件的承包商合作。我希望我可以在不设置整个测试环境的情况下运行它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-16T15:50:45.363

除了启动器图标之外，Eclipse 和 Android 模拟器没有任何关系。您甚至可以将模拟器作为独立应用程序运行，甚至不需要 android SDK。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T15:50:15.630

Android SDK 工具完全独立于 Eclipse。您可以简单地从 Android 网站下载它们并运行 AVD 管理器。

[http://developer.android.com/sdk/index.html](http://developer.android.com/sdk/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T18:29:34.050

如果您想在模拟器上安装 apk，只需启动模拟器并输入控制台

```
adb install path/to/apk/file.apk 
```

您可以在中找到 adb 工具

```
<android_sdk_path>/platform-tools/ 
```

# asp.net - WCF 同步与异步

> ID：16041473
> 
> 赞同：0
> 
> 时间：2013-04-16T15:48:39.523
> 
> 标签：asp.net, wcf, ssl, asynchronous

我一直在看MSDN和codeproject，但我还是有点困惑。

同步服务与异步服务。

我有一个 WCF 服务端点。该服务将 2way SSL 应用于其 web.config 文件。客户端是一个基于 Oracle 的 java Weblogic Suite。这有自己的私钥和公钥。客户端需要与我们的服务进行异步和同步通信。

**我只能在服务器端进行更改**

[http://www.codeproject.com/Articles/91528/How-to-Call-WCF-Services-Synchronously-and-Asynchr](http://www.codeproject.com/Articles/91528/How-to-Call-WCF-Services-Synchronously-and-Asynchr)

[http://msdn.microsoft.com/en-us/library/ms731177.aspx](http://msdn.microsoft.com/en-us/library/ms731177.aspx)

以下代码是SVC、cs文件的同步部分：-

```
public getQuoteSyncResponse1 getQuoteSync(getQuoteSyncRequest request)
     {
        // Create new response
        getQuoteSyncResponse1 res = new getQuoteSyncResponse1();

        res.GetQuoteSyncResponse = new GetQuoteSyncResponse();
        res.GetQuoteSyncResponse.Header = new GetQuoteResponseHeaderType();
        res.GetQuoteSyncResponse.Response = new GetQuoteSyncResponseType();

        // Create and populate header
        res.GetQuoteSyncResponse.Header.MessageId = request.GetQuoteRequestSync.Header.MessageId;
        res.GetQuoteSyncResponse.Header.Timestamp = request.GetQuoteRequestSync.Header.Timestamp;
        res.GetQuoteSyncResponse.Header.QuoteId = request.GetQuoteRequestSync.Header.QuoteId;
        res.GetQuoteSyncResponse.Header.CarrierId = request.GetQuoteRequestSync.Header.CarrierId;

        List<RejectionType> rj = new List<RejectionType>();

        string _sTotalEmployees = request.GetQuoteRequestSync.Request.Employer.TotalEmployees;
        int _TotalEmployees = 0;
        if (int.TryParse(_sTotalEmployees, out _TotalEmployees) == false)
        {

            RejectionType rt;
            rt = new RejectionType();
            rt.ReasonCode = "R01";
            rt.ReasonDescription = "Invalid Number of Employees";

            rj.Add(rt);

            res.GetQuoteSyncResponse.Response.Rejections = rj.ToArray();

            res.GetQuoteSyncResponse.Response.ReceiptStatus = AcceptanceContentType.Reject;

            return res;
        }

        res.GetQuoteSyncResponse.Response.ReceiptStatus = AcceptanceContentType.Success;

        List<QuoteType> q = new List<QuoteType>();

        QuoteType qt;

        qt = new QuoteType();
        qt.PlanId = "P345678";
        qt.EEPremium = 1220;
        qt.EESPPremium = 2222;
        qt.EEDepPremium = 3333;
        qt.EEFamilyPremium = 4444;
        qt.TotalMonthlyPremium = 3456;
        qt.CoverageEffectiveDate = DateTime.Now;

        q.Add(qt);

        res.GetQuoteSyncResponse.Response.Quotes = q.ToArray();

        return res;} 
```

所以服务的这个同步部分正在工作。现在，我如何使用它来将其转换为异步等效项？

我应该在 cs 文件中启动异步方法吗？还是在 svc 文件中？我很困惑...

```
 public getQuoteAsyncResponse getQuoteAsync(getQuoteAsyncRequest request, AsyncCallback callback, Object state)
    {
        // Create new response
        getQuoteAsyncResponse res = new getQuoteAsyncResponse();

        return new getQuoteAsyncResponse();
    } 
```

我对回调 deli-gator、对象状态等有所了解，但是有人可以为我进一步说明这一点吗？如何格式化服务的异步部分？网络上有很多例子……但都非常混乱。我一定对这个概念有一些内在的误解。

***编辑：-我在答案中被告知，服务器端不需要操作异步通信方式。但是我发现了这个：-***

在 WCF 中实现异步操作 正如 WCF 管道使客户端能够异步调用服务器操作，而服务器不需要知道任何有关它的信息，WCF 也允许异步定义服务操作。所以像这样的操作：

```
[OperationContract]
string DoWork(int value); 
```

……可能在服务合同中表示为：

```
[OperationContract(AsyncPattern = true)]
IAsyncResult BeginDoWork(int value, AsyncCallback callback, object state);

string EndDoWork(IAsyncResult result); 
```

请注意，这两种形式是等效的，并且在 WCF 元数据中无法区分：它们都公开了一个名为 DoWork[1] 的操作：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:05:06.443

异步部分需要在客户端完成。这意味着您可能正在做类似的事情： var response = ServiceReference.GetSomething();

相反，制作一个代理来获取回调。每当回调收到响应时，创建和触发（或调用）事件（或委托）。在上面的语句中，您显然在等待响应被分配到变量中，然后再移动到下一行。

相反，你可以

1.  在 Service 契约上，一定要用 [OperationContract(IsOneWay = true)] 来装饰
2.  如果您使用 ServiceReference 或 serviceutil，它将自动创建“传入事件”并为您完成所有客户端异步工作。
3.  如果你使用 TCP，也创建一个回调合约，然后在客户端你可以做类似 ServiceReference1.IncomingSomething += new eventHandler 的事情。现在您可以执行 ServiceReferecnce1.GetSomething()，响应将转到 eventhandler 函数。
4.  如果这是 RESTFUL：

    ```
     public void MakeAsyncRequest(string url, string contentType)
                {
                    try
                    {
                        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
                        request.ContentType = contentType;
                        request.Method = WebRequestMethods.Http.Get;
                        request.Timeout = 10000;
                        request.Proxy = null;

                        request.BeginGetResponse(new AsyncCallback(ReadCallback), request);
                    }
                    catch (Exception ex)
                    {
                        LogManager.LogException(ex);
                    }
                }

                private void ReadCallback(IAsyncResult asyncResult)
                {
                    HttpWebRequest request = (HttpWebRequest)asyncResult.AsyncState;
                    string strContent = string.Empty;
                    string s;

                    try
                    {
                        using (HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(asyncResult))
                        {
                            Stream responseStream = response.GetResponseStream();
                            using (StreamReader sr = new StreamReader(responseStream))
                            {
                                //Need to return this response 
                                strContent = sr.ReadToEnd();
                            }
                        }
                    }
                    catch (Exception ex)
                    {
                        throw;
                    }
                } 
    ```

# java - 使用 java.text.SimpleDateFormat 进行 Java 日期格式化

> ID：16041474
> 
> 赞同：1
> 
> 时间：2013-04-16T15:48:39.833
> 
> 标签：java, coldfusion, coldfusion-9

我有一些来自 java 的 ColdFusion 9 应用程序的代码。我希望日期格式像这样 Nov 05, 2012 no time。目前它的格式是这样的。2012-11-05 00:00:00.0

这是代码

```
 formatter = CreateObject("java", "java.text.SimpleDateFormat");
    formatter.init("EEE MMM d HH:mm:ss 'GMT'Z yyyy"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T15:56:32.057

```
formatter.init("MMM d , yyyy");

SimpleDateFormat format = new SimpleDateFormat("MMM d , yyyy");
String s = format.format(new Date());  printed  **Apr 16 , 2013** 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:00:00.933

你有没有尝试过`formatter.init("MMM d, yyyy") ?`

请参阅[http://docs.oracle.com/javase/1.5.0/docs/api/java/text/SimpleDateFormat.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/text/SimpleDateFormat.html)

我发现用 main() 方法编写小程序来试验这些格式很有帮助。

# java - 计算复杂的数学（积分，推导，...）

> ID：16041487
> 
> 赞同：5
> 
> 时间：2013-04-16T15:49:15.157
> 
> 标签：java, ruby-on-rails-3, math, programming-languages

如何用编程语言计算复杂的数学，例如：

1.  一体化
2.  推导
3.  其他一些不平凡的数学

例如对于这些语言：

*   爪哇
*   Ruby on Rails

我知道对于 C# 存在 Math.NET，但对于其他人呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T15:57:52.280

我不了解 Ruby，但对于我的 Java 应用程序中的数学，我使用了[Apache Commons Math](http://commons.apache.org/proper/commons-math/)。它为概率、统计、线性代数和数值微积分提供了许多可重用的组件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T16:00:17.910

在 java 中，你可以试试**[javaCalc](https://code.google.com/p/javacalculus/)**

**图书馆支持**：

1.  从字符串中解析标准代数表达式（语法树）。
2.  简化代数表达式（因式分解、公分母、三角恒等式等）。
3.  将符号标准微积分函数（微分、积分）应用于代数表达式。
4.  常用微积分工具（泰勒级数、极限、数值近似）。
5.  绘图工具（使用摆动）。
6.  如果时间允许，支持微分方程（符号求解器、欧拉近似、拉普拉斯变换）。

# angularjs - 指令中的自定义嵌入函数

> ID：16041489
> 
> 赞同：1
> 
> 时间：2013-04-16T15:49:19.453
> 
> 标签：angularjs, angularjs-directive

我有一个自定义嵌入函数，用于将特定的 html 片段移动到指令模板中的特定位置。当前的嵌入功能虽然很棒，但仅限于我只能将东西放到一个位置。我有不同的作品需要去不同的领域。这是我的设置：

```
<div ng-app="app">
    <div ng-controller="ParentCtrl">
        <div class="parentDirectiveRepeat" data-list="myList">
            <div data-transclude-ipsum>Ipsum</div>
        </div> 
        <hr>
        <div class="parentDirectiveNoRepeat" data-list="myList">
            <div data-transclude-ipsum>Ipsum</div>
        </div>
    </div>
</div> 
```

这是我的两个指令模板：

```
parentDirectiveRepeat: <div>Parent Directive<div data-ng-repeat="item in list">repeater<div data-transclude-ipsum-destination></div></div></div>
parentDirectiveNoRepeat: <div>Parent Directive<div data-transclude-ipsum-destination></div></div> 
```

以及它们之间的共同共享控制器：

```
function directiveController($scope, $element, $transclude, $compile){
    var ipsumDestination = angular.element($element[0].querySelectorAll("div[data-transclude-ipsum-destination]"));

    $transclude(function(clone){
        var ipsum = csFncFindElement(clone, "data-transclude-ipsum");
        ipsumDestination.append(ipsum);
    });   
} 
```

所以，这里是输出：

```
Parent Directive
repeater
repeater
repeater
-------------
Parent Directive
Ipsum 
```

问题是，输出真的应该是

```
Parent Directive
repeater
ipsum
repeater
ipsum
repeater
ipsum
-------------
Parent Directive
Ipsum 
```

下面是整个过程的**jsFiddle ：http:** [//jsfiddle.net/uBsbC/1/](http://jsfiddle.net/uBsbC/1/)

通过各种测试，我确定当我使用 $transclude 函数时，data-ng-repeat 已经连接并完成了。有没有办法让我告诉它不要让它的孩子连线并等到这个父指令通过之后？

# android-layout - 列表视图的 contextMenu

> ID：16041492
> 
> 赞同：0
> 
> 时间：2013-04-16T15:49:28.410
> 
> 标签：android-layout, listview, contextmenu

我正在使用列表视图。我使用适配器为该列表添加项目。我正在尝试为列表的每个项目添加上下文菜单，但我对此有问题。

这是我的代码

项目清单：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@color/bgActivity"
android:orientation="horizontal" >

<TextView
    android:id="@+id/tv_name"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:paddingLeft="10dp"
    android:textColor="@color/textColorContact"
    android:textSize="20sp"
    android:textStyle="bold" />

<Button
    android:id="@+id/pick_options"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_marginRight="10dp"
    android:background="@drawable/app_icon"
    android:text="@string/label_options" >
</Button>   

</RelativeLayout> 
```

名单 ：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<ListView
    android:id="@+id/lst_contacts"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:background="@color/bgContactItem" />

</RelativeLayout> 
```

菜单 ：

```
<menu 
xmlns:android="http://schemas.android.com/apk/res/android">
<item android:id="@+id/CtxLblOpc1" android:title="OpcEtiqueta1"></item>
<item android:id="@+id/CtxLblOpc2" android:title="OpcEtiqueta2"></item>
</menu> 
```

爪哇代码：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_contacts);

// Getting reference to listview
    ListView lstContacts = (ListView) findViewById(R.id.lst_contacts);
registerForContextMenu(lstContacts);
}

@Override
    public void onCreateContextMenu(ContextMenu menu, 
                                    View v, 
                                    ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.menu_options, menu);

}

/** Actions for the ContextMenu items */
@Override
public boolean onContextItemSelected(MenuItem item) {
  //AdapterContextMenuInfo info = (AdapterContextMenuInfo) item.getMenuInfo();
  switch (item.getItemId()) {
      case R.id.CtxLblOpc1:
        Toast.makeText(getApplicationContext(), 
                         "Option 1",     
                         Toast.LENGTH_LONG).show();
          return true;
      case R.id.CtxLblOpc2:
        Toast.makeText(getApplicationContext(), 
                         "Option 2", 
                         Toast.LENGTH_LONG).show();
          return true;
      default:
          return super.onContextItemSelected(item);
   }
} 
```

但我看不到上下文菜单，请帮忙，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T08:50:44.543

我想你应该尝试添加（在布局中）

```
android:descendantFocusability="blocksDescendants" 
```

在您的布局中。你可以看看[这里](http://www.survivingwithandroid.com/2012/10/android-listviewarrayadapter-and.html) 我建议你使用带有 ActionMode.Callback 的上下文菜单。如果你想要一个例子看[这里](http://www.survivingwithandroid.com/2013/04/android-listview-context-menu.html)

*注：链接来自我的博客*

# java - 从 JTable 到 Excel

> ID：16041494
> 
> 赞同：0
> 
> 时间：2013-04-16T15:49:30.667
> 
> 标签：java, swing, excel, jtable, apache-poi

我正在尝试将我的 JTable 导出到 excel 文件。为此，我使用 apache POI-SS 和 apache POI-XSSF。首先，我用 sax 解析器解析我的 xml 文件并将其转换为 JTable，然后通过单击导出按钮，我想将我的 JTable 导出到 excel。我创建了 2 个类，第一个解析 xml 文件并创建一个Jtable 和第二个用于 Excel 导出。

我的问题是 excel 文件，它只包含 2 个元素：第一行包含 200000，第二行包含 100000……我试图找出问题所在，但徒劳无功……

这是“JTable_create”类：

```
package jtable_excel11;

import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.Vector;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.table.DefaultTableModel;
import javax.xml.parsers.SAXParser;
import javax.xml.parsers.SAXParserFactory;
import org.xml.sax.Attributes;
import org.xml.sax.SAXException;
import org.xml.sax.helpers.DefaultHandler;

public class JTable_create {

public static Vector<Vector> rowData = new Vector<Vector>();
public static Vector<String> rowOne = new Vector<String>();
public static Vector<String> columnNames = new Vector<String>();
public static void main(String[] args) {

try {

SAXParserFactory factory = SAXParserFactory.newInstance();
SAXParser saxParser = factory.newSAXParser();

DefaultHandler handler;
handler = new DefaultHandler() {
boolean bstaff = false;
boolean bfname = false;
boolean blname = false;
boolean bnname = false;
boolean bsalary = false;
private int i;

public void startElement(String uri, String localName,String qName,
Attributes attributes) throws SAXException {

System.out.println("Start Element :" + qName);

if (qName.equalsIgnoreCase("staff"))
{
rowOne = new Vector<String>();
bstaff = true;
}

if (qName.equalsIgnoreCase("FIRSTNAME")) {
bfname = true;
}

if (qName.equalsIgnoreCase("LASTNAME")) {
blname = true;
}

if (qName.equalsIgnoreCase("NICKNAME")) {
bnname = true;
}

if (qName.equalsIgnoreCase("SALARY")) {
bsalary = true;
}

}

public void endElement(String uri, String localName,
String qName) throws SAXException {

System.out.println("End Element :" + qName);
if ("staff".equals(qName)){
rowData.addElement(rowOne);
System.out.println("pffffffffff");
};

}

@Override
public void characters(char ch[], int start, int length)  {

if (bfname) {
String s = new String(ch, start, length);
rowOne.addElement(s);
System.out.println("First Name : " + new String(ch, start, length));

bfname = false;

}

if (blname) {
rowOne.addElement (new String(ch, start, length));
System.out.println("Last Name : " + new String(ch, start, length));
blname = false;

}

if (bnname) {
rowOne.addElement (new String(ch, start, length));
System.out.println("Nick Name : " + new String(ch, start, length));
bnname = false;

}

if (bsalary) {
rowOne.addElement (new String(ch, start, length));
System.out.println("Salary : " + new String(ch, start, length));
bsalary = false;

}

System.out.println("longueur" + rowOne.size());
}
};

saxParser.parse("file.xml", handler);
JFrame frame = new JFrame();
frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
columnNames.addElement("firstname");
columnNames.addElement("lastname");
columnNames.addElement("nickname");
columnNames.addElement("salary");

DefaultTableModel model = new DefaultTableModel(rowData, columnNames);
final JTable table = new JTable(model);

JScrollPane scrollPane = new JScrollPane(table);

JButton export = new JButton("Export");
export.addActionListener(new ActionListener(){
public void actionPerformed(ActionEvent evt){
try {
Escel1 exp = new Escel1();
exp.exportTable(table, new File("C:\\Documents and              Settings\\Adm\\Bureau\\result.xlsx"));
} catch (IOException ex)  {
System.out.println(ex.getMessage());
ex.printStackTrace();
}
}
});

frame.getContentPane().add("South", export);
frame.pack();
frame.setVisible(true);

frame.add(scrollPane, BorderLayout.CENTER);
frame.setSize(300, 150);
frame.setVisible(true);
System.out.println("Fini!");

} catch (Exception e) {
e.printStackTrace();
}

}

} 
```

第二类称为“Excel1”是以下内容：

```
package jtable_excel11;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.Map;
import java.util.Set;
import javax.swing.JTable;
import javax.swing.table.TableModel;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class Excel1 {

public Excel1() {}

public void exportTable(JTable table, File file) throws IOException {

System.out.println(" c bon !");

XSSFWorkbook workbook = new XSSFWorkbook();
XSSFSheet sheet = workbook.createSheet("Sample sheet");

System.out.println(" workbook crée");
TableModel model= table.getModel();
HashMap<String, Object[]> data = new HashMap<String, Object[]>();

for(int i=0; i<model.getRowCount(); i++){
for(int j=0; j< model.getColumnCount(); j++){

data.put(i+"",new Object[]{model.getValueAt(i,j).toString()+"\t"});
System.out.println(model.getValueAt(i,j));
System.out.println(i);
System.out.println(j);

}
//data.put("\n");

}

Set<String> keyset = data.keySet();
int rownum = 0;
for (String key : keyset) {
Row row = sheet.createRow(rownum++);
Object[] objArr = data.get(key);
int cellnum = 0;
for (Object obj : objArr) {
Cell cell = row.createCell(cellnum++);
if (obj instanceof Date)
cell.setCellValue((Date) obj);
else if (obj instanceof Boolean)
cell.setCellValue((Boolean) obj);
else if (obj instanceof String)
cell.setCellValue((String) obj);
else if (obj instanceof Double)
cell.setCellValue((Double) obj);
}
}

try {
FileOutputStream out = new FileOutputStream(file);
workbook.write(out);
out.close();
System.out.println("Excel written successfully..");

}  catch (FileNotFoundException e) {
e.printStackTrace();
} catch (IOException e) {
e.printStackTrace();
}

}
} 
```

这是我的 XML 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<company>
<staff >
<firstname>yong</firstname>
<lastname>mook kim</lastname>
<nickname>mkyong</nickname>
<salary>100000</salary>
</staff>
<staff >
<firstname>low</firstname>
<lastname>yin fong</lastname>
<nickname>fong fong</nickname>
<salary>200000</salary>
</staff>
</company> 
```

在 excel 文件中，我只有 2 行，分别包含 200000 和 100000 。

知道我该如何解决这个问题吗？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:42:17.527

我认为您可以通过将 JTable 设置为简单的 filtype:".csv" Excel 来导出它。

一个简单的例子是

```
kevin,johnson,49
julia,roberts,56 
```

我认为您使用 JTable 作为表而不是树（XML 是树的类型）

祝你好运

# javascript - javascript转换所有函数

> ID：16041497
> 
> 赞同：-4
> 
> 时间：2013-04-16T15:49:35.373
> 
> 标签：javascript

如何遍历对象/数组并将所有函数转换为唯一 ID？

有一点像

**JSON.stringify**

但仅适用于功能

**Function.stringify(obj/arr)**

```
var sum = function(a,b){return a+b}

Function.stringify({
   foo: sum,
   bar: [{
      baz: [["foo", "bar"], "baz", function(){}]
   }]
})

// returns 

{
   foo: "func01",
   bar: [{
      baz: [["foo", "bar"], "baz", "func02"]
   }]
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:06:03.267

类似于以下内容，尽管我没有为函数计数器的填充而烦恼：

```
var mySerializer = function () {
  var counter = 0;

  return function serialize(input, stack, reset) {
    var result, prop, funcId, i;

    if (reset) {
      counter = 0;
    }

    if (typeof stack !== 'object') {
      stack = {};
    }

    switch (typeof input) {
      // input is object
      case 'object':
        result = {};
        for (prop in input) {
          if (input.hasOwnProperty(prop)) {
            result[prop] = serialize(input[prop], stack, false);
          }
        }
        break;

      // input is array
      case 'array':
        result = [];
        for (i = 0; i < input.length; i += 1) {
          result.push(serialize(input[i], stack, false));
        }
        break;

      case 'function':
        funcId = ['func', ++counter].join('');
        funcs[funcId] = input;
        return funcId;

      // default
      default:
        return input;
    }

    return result;
  };
}();

var
  sum = function(a,b){ return a+b; },
  funcs = {},
  result = mySerializer({
    foo: sum,
    bar: [{
      baz: [["foo", "bar"], "baz", function(){}]
    }]
  }, funcs); // supply empty object, which will be used to stored replaced functions

console.log(result, funcs); 
```

演示：http: [//jsbin.com/ujahub/1/](http://jsbin.com/ujahub/1/)

* * *

*更新以使“替换”功能可访问。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T15:54:41.817

您可以将第二个参数用于`JSON.stringify`: `replacer`:

```
function func() {}
var data = {
    "some data": func
};
JSON.stringify(data, function (key, value) {
    if (value === func) {
        return "**func";
    }
    return value;
});
// output: {"some data": "**func"} 
```

更改此代码以处理任意数量的函数很容易。

这确实需要您*了解*所有功能，并且反序列化也是一个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:15:15.590

只是为了好玩...

```
function getAllFunctions()
{
   var functionBodies = [];

    //iterate through keys of window object
    for (var f in window) 
    {
        if (window.hasOwnProperty(f) && typeof window[f] === 'function')
        {
            //ignore native functions
            if(window[f].toString().match(/(\[native code\]|\[object Function\])/g) == null)
            {
                functionBodies.push(window[f].toString());
            }
        }
    }

    return functionBodies.join('\n\n');
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T16:17:59.197

根据 Frits 的想法，我想出了自己的解决方案

```
var id = 0;
func = {};

function mySerializer(data){
    return JSON.parse(JSON.stringify(data, function (key, value) {
        if (typeof value === "function") {
            func["func"+id] = value;
            id++;
            return "func"+id;
        }
        return value;
    }));
}

var sum = function(a,b){ return a+b; };

console.log(mySerializer({
   foo: sum,
   bar: [{
      baz: [["foo", "bar"], "baz", function(){}]
   }]
})); 
```

# spring - Struts2+Spring3+Tiles3

> ID：16041499
> 
> 赞同：-1
> 
> 时间：2013-04-16T15:49:39.657
> 
> 标签：spring, hibernate, struts2, tiles2, struts2-spring-plugin

我想将图块 3 集成到我的 web 应用程序 spring3+struts2+hibernate，但我不知道要开始。我看到的所有示例都仅使用带有瓷砖的 struts2，没有集成 spring。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:55:18.850

这里有几个输入如何集成它。

1.  为了将 Struts2 与 Spring 集成使用[struts2-Spring 插件](http://struts.apache.org/release/2.3.x/docs/spring-plugin.html)，您只需要拥有所需的 spring jar 和插件，以及您的 spring 配置文件。插件文档包含一个基本的开始，如如何配置它以及如何使用它，只需按照这些说明和你很高兴（我假设你知道如何使用 Spring）

2.  Struts2 独立于 Hibernate，您可以自由地以自己的方式使用它，虽然有一些可用的插件，但我建议不要使用它们

3.  对于瓷砖，还有一个插件可以处理集成。

所有这些插件都将帮助您集成各种技术，但是如何使用它们以及它们是如何工作的，您需要独立了解它们。

# wpf - TallComponents PDF Rasterizer.NET convertToWPF 内存错误

> ID：16041501
> 
> 赞同：2
> 
> 时间：2013-04-16T15:49:50.687
> 
> 标签：wpf, pdf, rendertargetbitmap, fixedpage, pdf-rasterizer

我正在尝试使用 TallComponents PDF Rasterizer 栅格化 pdf

tiff 效果很好。虽然我想 ConvertToWpf ..

我直接向他们问了这个问题，虽然没有回应..

所以，我按照他们的示例代码..

```
 TallComponents.PDF.Rasterizer.Document _document;
        using (FileStream file = new FileStream(pSource, FileMode.Open, FileAccess.Read))
        {
            _document = new TallComponents.PDF.Rasterizer.Document(file);
        }

        TallComponents.PDF.Rasterizer.Configuration.RenderSettings rSettings = new TallComponents.PDF.Rasterizer.Configuration.RenderSettings();
        rSettings.TextSettings.ResolveFont += new TallComponents.PDF.Rasterizer.Fonts.ResolveFontEventHandler(TextSettings_ResolveFont);

        TallComponents.PDF.Rasterizer.ConvertToWpfOptions rOptions = new TallComponents.PDF.Rasterizer.ConvertToWpfOptions();
        TallComponents.PDF.Rasterizer.Diagnostics.Summary summary = new TallComponents.PDF.Rasterizer.Diagnostics.Summary();

        int count = _document.Pages.Count;
        for (int i = 0; i < count; i++)
        {

        using (FileStream outStream = new FileStream(path, FileMode.Create)) 
        { 
             System.Windows.Documents.FixedPage fpage = _document.Pages[i].ConvertToWpf(rSettings, rOptions, summary); 

             double width = fpage.Width * rasterize.rast_dpiX / system.scr_dpiX; 
             double height = fpage.Height * rasterize.rast_dpiY / system.scr_dpiY; 

             RenderTargetBitmap renderTarget = new RenderTargetBitmap( 
             (int)width, 
             (int)height, 
             rasterize.rast_dpiX, 
             rasterize.rast_dpiY, 
             System.Windows.Media.PixelFormats.Default); 

             renderTarget.Render(fpage); 

             PngBitmapEncoder enc = new PngBitmapEncoder(); 
             enc.Frames.Add(BitmapFrame.Create(renderTarget)); 
             enc.Save(outStream); 

        } 
```

当我使用只有 1 页的 pdf 时，它可以工作。

当我使用超过 1 页的 pdf 时，出现内存不足错误。

当我使用超过 1 页的 pdf 并从第 2 页开始并跳过第一页时，它可以工作。虽然所有页面都是空白的，但说我只能光栅化第一页，因为它是试用版。

我是否因为它是试用产品而收到内存错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-23T07:15:25.253

很可能您在第一页上有一个图像（或另一个巨大的 PDF 对象），在处理之后您会遇到异常。此异常中断了进一步的渲染，您有一个空白的 2,3,4... 页面。

# solr - Solr 不搜索（非常基本的示例）

> ID：16041502
> 
> 赞同：3
> 
> 时间：2013-04-16T15:49:53.953
> 
> 标签：solr, lucene

**Solr 版本：** 4.2.1

**目标：**
我正在尝试构建一个非常简单的 Solr 示例

**到目前为止：**
安装的 solr
能够成功运行示例\教程[http://lucene.apache.org/solr/4_2_1/tutorial.html](http://lucene.apache.org/solr/4_2_1/tutorial.html)

**下一步：**
现在我正在尝试创建自己的架构
我已经创建了一个架构：[http](http://pastebin.com/vj4ATa8d)
://pastebin.com/vj4ATa8d 和一个测试文档： http: [//pastebin.com/7fvZ5GTQ](http://pastebin.com/7fvZ5GTQ)
我已经使用命令将文档添加到 Solr
*java -jar post.jar testdoc.xml*

**工作原理：**
在 Solr Admin 中，我可以看到架构
我可以看到上传的一个文档
我可以转到管理控制台并查询如下：将
q 指定为“：”。这有效-显示文档

```
http://localhost:8983/solr/collection2/select?q=*%3A*&wt=xml&indent=true 
```

**什么不起作用：**
如果我将 q 作为 Nashua- 我看不到任何结果
这是默认搜索字段
其他属性也不起作用

```
http://localhost:8983/solr/collection2/select?q=Nashua&wt=xml&indent=true 
```

调试响应[http://pastebin.com/fTneyEba](http://pastebin.com/fTneyEba)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:12:29.553

您需要将字段复制到默认搜索字段（在本例中为文本）或使用要搜索的字段限定查询：

```
.../select?q=city:Nashua&wt=xml&indent=true 
```

需要阅读的内容：

1.  默认搜索字段
2.  复制字段

两者都记录在这里：

[https://wiki.apache.org/solr/SchemaXml](https://wiki.apache.org/solr/SchemaXml)

# java - 错误 [Jsr168Dispatcher:38] 找不到动作 没有为动作名称默认映射的动作。- [未知位置]

> ID：16041504
> 
> 赞同：1
> 
> 时间：2013-04-16T15:49:57.467
> 
> 标签：java, configuration, struts2, liferay, portlet

我在运行我的 portlet 应用程序时确实遇到了问题，我有这个错误：

```
ERROR [Jsr168Dispatcher:38] Could not find action There is no Action mapped for action name default. - [unknown location] 
```

我正在使用 Struts 2.2.1 和 Liferay 6.0.6

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>
<constant name="struts.devMode" value="false" />
    <package name="eleve" extends="struts-portlet-default">
        <action name="ajoutereleves">
            <result>/JSPs/eleve/addeleve.jsp</result>
        </action>
        <action name="AddEleveAction" class="com.version.projet.actions.AddEleveAction">
            <interceptor-ref name="jsonValidationWorkflowStack"/>
            <result name="input">/JSPs/eleve/addeleve.jsp</result>
            <result name="error">/JSPs/eleve/addeleve.jsp</result>
            <result>/JSPs/eleve/showseleves.jsp</result>
        </action>
    </package>
</struts> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:11:45.397

您尚未指定`namespace`注释。如何正确地将操作映射到[命名空间](http://struts.apache.org/development/2.x/docs/convention-plugin.html#ConventionPlugin-Namespaceannotation)请查看以下约定插件文档。

# html - 如何给一个带有显示的div：表格单元格的百分比高度？

> ID：16041509
> 
> 赞同：1
> 
> 时间：2013-04-16T15:50:10.810
> 
> 标签：html, css

现在我正在做一个纸牌游戏，现在我正在编写关于手牌的代码。
我们的目标应该是这样的（这是我的代码在 IE10 中的结果）
![目标](https://i.stack.imgur.com/8b76l.png "目标")
有三个要求：
1\. 所有卡片都将填满手牌区域。
2\. 所有卡片的宽度相同。
3.如果卡片太多，右边的一张会在左边的一张。（蓝色边框的卡片是最左边的，在第二张下面）
所以我们决定用table来做。这是代码。

```
<style>
    .hand {
        position: absolute; /* We need to locate it */
        display: table;
        width: 60%;
        height: 15%;
        left: 19.5%;
    }
        .hand .wrap {
            position: relative;
            display: table-cell;
            height: 100%;
        }
        .hand .card {
            position: relative;
            left: 50%;
        }
</style>
<div style="width: 400px; height:100px; position: relative"> 
<!-- Container's width and height will change with JavaScript -->
    <div class="hand">
        <div class="wrap">
            <img class="card" src=""/>
        </div>
        <div class="wrap">
            <img class="card" src=""/>
        </div>
        <!-- More cards can be added using JavaScript. -->
    </div>
</div>
<script>
    function adjust() { // Run this function when inserting new cards.
        $(".hand .card").css("margin-left", function () {
            return 0 - $(this).width() / 2 + "px";
        });
    }
</script> 
```

现在，IE10 中的代码结果在上面，**但在 Firefox 和 Chrome 中， 的`.hand`高度与`.card`.**
我已经阅读了一些其他类似的问题，现在我知道`height`表格上的 CSS 属性不起作用，并且我将解决方案之一设置`.card`为`position: absolute;`，但它仅适用于 Chrome，在 IE10 中，`.card`s 现在的宽度和高度为 0px，在Firefox 他们都在`.hand`.
那么是否有任何跨浏览器解决方案来设置高度或任何其他方式来做到这一点？
非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:04:30.653

您的实现不起作用，因为您无法应用于`position`表格单元格（或行为类似的元素）。您需要一个额外的标记元素来实现这一点。

没有任何 Javascript 的工作示例应该可以在所有现代浏览器中工作：http: [//jsfiddle.net/VN3wx/](http://jsfiddle.net/VN3wx/)

**CSS**

```
#hand {
    display:table;
    width:550px;
    height:210px;
}
.card {
    display:table-cell;
}
.card > div {
    position:absolute;
}
.card img {
    height:210px;
    width:150px;
} 
```

代码当然可以更简洁一些，但它是为了说明目的；）

# search - 如果需要 TABLES 参数但这些参数已过时，如何创建搜索帮助退出功能模块？

> ID：16041511
> 
> 赞同：3
> 
> 时间：2013-04-16T15:50:22.773
> 
> 标签：search, parameters, abap, function-module

试图创建一个搜索帮助出口（实际上是复制一个旧的）。

我的问题是我不能为功能模块声明表参数（因为它们已经过时并且我无法通过警告）但是在功能模块检查时，一个错误告诉我我必须使用表参数 - 并且每个我发现的教程使用了这种方法。

那么有没有办法：

1.  忽略警告并使用 TABLES 参数或
2.  使用 CHANGING 参数并让功能模块知道我使用的是这些参数而不是 TABLES 参数？

[编辑]：实际上可以使用 TABLES 参数，只是您必须多次按 ENTER

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T16:15:35.207

在这种情况下，您必须使用`TABLES`参数，即使它们已过时 - 否则必须调整调用程序（深入 SAP 基础），而这反过来又会立即破坏所有现有的值帮助退出。正如您所说，只需继续按 Enter 键，直到您确认所有警告。

# c#-4.0 - 处理程序完成后，简单的服务总线不乐意回复

> ID：16041512
> 
> 赞同：-1
> 
> 时间：2013-04-16T15:50:23.407
> 
> 标签：c#-4.0

我正在使用来自 Codeplex 的简单服务总线，并有一个处理程序为我提供消息和 IMessageContext。

```
public void Handle(MyEnquiryMessage message, IMessageContext context) 
```

我将这两个都存储在一个列表中并让处理程序完成。在将来的某个时候，我会进行一些处理并尝试通过获取我存储的上下文并调用来发送回复：

```
 context.Endpoint.MessageBus.Reply(myResponse) 
```

不幸的是，这会引发异常“对象引用未设置为对象的实例”。这种异步回复方式是否可行，或者“回复”只能在处理程序中使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:06:10.167

我不知道简单服务总线，但我猜你的上下文只在处理程序中有效。如果您想发回响应，您需要从上下文中收集您需要的所有数据，并在稍后阶段简单地执行“发送”。

即便如此，当它可能在另一个处理相关消息类型的端点中处理时，“稍后”执行过程听起来有点奇怪。如果没有更多信息，很难判断，但您的设计可能不是最佳的。

作为旁注：我认为否决票可能是因为问题不在于“NServiceBus”:) --- 可能带有“esb”标签。

# c# - HiddenField 不是 WebControl？

> ID：16041520
> 
> 赞同：6
> 
> 时间：2013-04-16T15:50:43.870
> 
> 标签：c#, asp.net, .net, inheritance

为什么`System.Web.UI.WebControls.HiddenField`继承`System.Web.UI.Control`而不是 `System.Web.UI.WebControls.WebControl`？如果不是在网页中使用隐藏字段这一事实，这似乎真的不合逻辑。它设计成这样的原因是什么？

当你不能做类似的事情时，这会让事情变得很烦人`WebControl x = new HiddenField();`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T15:55:07.757

`UI.Control`和之间的主要区别在于`UI.WebControls.WebControl`它`WebControl`用作具有 UI 的组件的基类。由于隐藏字段从不向用户显示任何内容（毕竟它是隐藏的），`UI.Control`因此是更合适的基类。

# wcf-data-services - 在 WCF 数据服务 ServiceOperation 中返回自定义对象

> ID：16041529
> 
> 赞同：0
> 
> 时间：2013-04-16T15:51:00.393
> 
> 标签：wcf-data-services, odata

是否可以在 WCF 数据服务 ServiceOperation 中返回自定义对象或通用对象，例如：

```
public class Message {
    public string value { get; set; }
}

[WebGet]
public Message test() {
    return new Message { value = "HelloWorld!" };
}

[WebGet]
public object test2() {
    return new { message = "HelloWorld!" }
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-23T00:56:17.623

我知道这是一个较老的问题，但我将发布此链接，指定服务操作的要求：

[服务操作（WCF 数据服务）](http://msdn.microsoft.com/en-us/library/cc668788%28v=vs.110%29.aspx)

此外，您可以查看从服务操作返回复杂类型。

# ajax - 我正在尝试通过 ajax 将数据传递给我的控制器

> ID：16041530
> 
> 赞同：0
> 
> 时间：2013-04-16T15:51:02.697
> 
> 标签：ajax

这是我的javascript。

```
$(document).ready(function () {
  $("#filters").on('submit', function(e){
    e.preventDefault();

    start_date = $("input[data-name='fromDate']").val();
    end_date = $("input[data-name='toDate']").val();
    project = $("select[name='project']").val();
    repo = $("select[name='repo']").val();
    coder = $("select[name='coder']").val();

    $.ajax({
      url: '/graph/ajax_filter',
      data: {
        start_date: start_date,
        end_date: end_date,
        project: project,
        repo: repo,
        coder: coder
      },
      type: 'POST',
      dataType: 'json',
      success: function(response) {
        view = response.view
      }

    });
  });
}); 
```

这是我的控制器功能

```
 public function ajax_filter() {
    var_dump('hello');die;
    $filter = array(
      'start_date'     =>    $this->input->post('start_date'),
      'end_date'     =>    $this->input->post('end_date')
    );

    $view = $this->load->view('overview', $filter, TRUE);

    $ret = array(
      'view'      =>  $view
    );

    die(json_encode($ret));
  } 
```

我正在尝试过滤图表。我从视图中收集的数据就在那里。但是当我尝试使用 ajax_filter 函数时，我无法显示 var_dump

# chef-infra - 厨师食谱依赖 - berkshelf

> ID：16041536
> 
> 赞同：0
> 
> 时间：2013-04-16T15:51:07.770
> 
> 标签：chef-infra, chef-recipe, berkshelf

我使用 chef-server 来管理我的服务器，我不想让半[官方的 logstash 食谱](https://github.com/lusis/chef-logstash)正常工作，但我遇到了配方依赖问题。

我将所有的食谱和我克隆的 logstash 放在一个 chef-config repo 中。

```
/chef-repo
  /cookbooks
    /mysql
    /ngnix
    /logstash - https://github.com/lusis/chef-logstash 
```

我需要安装 logstash 依赖的食谱，这可以用 berkshelf 完成，但是 berks install 将它们放在 ~/.berkshelf/cookbooks/apache2 中，这似乎有点毫无意义，因为我需要它们在我的食谱文件夹中以允许我将它们上传到厨师服务器。

我确实尝试过：

```
berks install --path /chef-repo/cookbooks 
```

但这有两个问题，首先我覆盖了其他同名的食谱（mysql），我所有的食谱都被删除了。

人们如何处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:30:44.230

也许您想为厨师指定两个包含您的 coobkooks 的文件夹，一个用于您的食谱，另一个用于外国食谱。

# ios - 在 0 和 1 之间规范化 CGRect

> ID：16041538
> 
> 赞同：10
> 
> 时间：2013-04-16T15:51:22.310
> 
> 标签：ios, objective-c

标准化`CGRect`值以使它们介于 0 和 1 之间（单位坐标系）的最佳方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-16T16:44:08.533

一个非常简洁的方法是：

```
CGAffineTransform t = CGAffineTransformMakeScale(1.0 / parentRect.size.width, 1.0 / parentRect.size.height);
CGRect unitRect = CGRectApplyAffineTransform(rect, t); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-16T15:56:53.980

这应该可以解决问题。您只需将所有内容除以父视图或图层的宽度/高度。

```
CGFloat parentWidth = parentView.bounds.size.width;
CGFloat parentHeight = parentView.bounds.size.height;

CGRect rectToConvert = ...;

rectToConvert.origin.x /= parentWidth;
rectToConvert.origin.y /= parentHeight;
rectToConvert.size.width /= parentWidth;
rectToConvert.size.height /= parentHeight; 
```

我们说这些矩形和点在“单位坐标系”中。[您可以在Core Animation Programming Guide](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/CoreAnimation_guide/CoreAnimationBasics/CoreAnimationBasics.html#//apple_ref/doc/uid/TP40004514-CH2-SW16)中阅读有关它的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:08:59.820

这个怎么样：

```
CGRect rectToConvert;
NSAffineTransform *n = [NSAffineTransform transform];
[n scaleXBy:rectToConvert.size.width 
        yBy:rectToConvert.size.height];
[n invert];

CGRect normalizedRect;
normalizedRect.origin = [n transformPoint:rectToConvert.origin];
normalizedRect.size   = [n transformSize: rectToConvert.size];

CGPoint anyPointINeedToConvert;
CGPoint convertedPoint = [n transformPoint:anyPointINeedToConvert]; 
```

我认为这可以让您更清楚地了解正在发生的事情，并让您以一种明显的方式处理翻译，如果您必须这样做的话。

# html - 移动设备的 CSS 字体大小

> ID：16041541
> 
> 赞同：3
> 
> 时间：2013-04-16T15:51:24.850
> 
> 标签：html, css, mobile, web, responsive-design

我完成了简单的页面，似乎对不同尺寸的屏幕反应良好。我没有做任何花哨的事情来实现这一点 - 只是避免了固定尺寸等。

然而，一页有一个大字体的大字：

![在此处输入图像描述](https://i.stack.imgur.com/WCop9.png)

当我调整浏览器大小时，所有其他内容的布局都正确，但标题词当然不会中断：

![在此处输入图像描述](https://i.stack.imgur.com/jgMdV.png)

处理这个问题的正确方法是什么？有没有办法根据屏幕宽度调整字体大小？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-16T18:02:31.813

另一种选择是使用[viewport-percentage lengths](http://www.w3.org/TR/css3-values/#viewport-relative-lengths)。

> **vw 单位：**等于初始包含块宽度的 1%。

[你可以在CSS Tricks](http://css-tricks.com/viewport-sized-typography/)上阅读更多关于它的内容，其中讨论了某些浏览器的重绘错误，但你可以用一点 jQuery 来修复它。

[http://jsfiddle.net/7L9QH/](http://jsfiddle.net/7L9QH/)

### CSS

```
h1 {
    font-size: 25vw;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-16T15:54:47.670

您可以使用以下媒体查询：

```
@media all and (max-width: 699px) and (min-width: 520px), (min-width: 1151px) {
   body {
    background: #ccc;
  }
} 
```

更多信息可以在这里找到：[http ://css-tricks.com/css-media-queries/](http://css-tricks.com/css-media-queries/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T15:55:21.063

你试过[FitText](http://fittextjs.com/)吗？

这是一个为这种场合而设计的 jQuery 插件。引用他们的描述：

> FitText 使字体大小灵活。在您的流体或响应式布局上使用此插件来实现填充父元素宽度的可扩展标题。

# jsf - javax.faces.FacesException：找不到滑块目标组件'txt6; txt7' 在视图中

> ID：16041554
> 
> 赞同：0
> 
> 时间：2013-04-16T15:52:17.947
> 
> 标签：jsf, primefaces, facelets

[我从PrimeFaces`<p:slider>`展示](http://www.primefaces.org/showcase/ui/slider.jsf)中尝试了以下示例：

```
<h3>Range Slider</h3>  

<h:panelGrid columns="1" style="margin-bottom:10px">                      
    <h:outputText id="displayRange" value="Between #{sliderBean.number6} and #{sliderBean.number7}"/>                      
    <p:slider for="txt6,txt7" display="displayRange" style="width:400px" range="true"   
              displayTemplate="Between {min} and {max}"/> 
</h:panelGrid>  
<h:inputHidden id="txt6" value="#{sliderBean.number6}" />  
<h:inputHidden id="txt7" value="#{sliderBean.number7}" /> 
```

但是，它在渲染过程中会引发以下异常：

> 渲染视图时出错[/pages/slides.xhtml]：javax.faces.FacesException：找不到滑块目标组件'txt6; txt7' 在视图中

这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T09:03:24.257

这是 Primefaces 版本中 Primefaces 的滑块错误，已在 Primefaces 版本 3.5 中修复

你可以看到：[列出 Primefaces 的 bug](https://code.google.com/p/primefaces/issues/list?can=1&q=label=TargetVersion-3.5%20status%3aFixed&sort=&groupby=&colspec=ID%20Stars%20Type%20Status%20Priority%20TargetVersion%20Summary&nobtn=Update&num=500) 和[Release notes](http://blog.primefaces.org/?p=2417)

# c# - XAML 中有没有办法在双击时选择文本框中的所有文本？

> ID：16041556
> 
> 赞同：6
> 
> 时间：2013-04-16T15:52:20.813
> 
> 标签：c#, wpf, xaml

有没有办法纯粹通过 XAML 突出显示文本框中的所有文本，还是必须在 Xaml.cs 中完成

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-16T16:46:53.570

这就是你要做的：

首先，将`DoubleClickBehavior.cs`类添加到您的项目中。

```
class DoubleClickBehavior : Behavior<TextBox>
    {
        protected override void OnAttached()
        {
            AssociatedObject.MouseDoubleClick += AssociatedObjectMouseDoubleClick;
            base.OnAttached();
        }

        protected override void OnDetaching()
        {
            AssociatedObject.MouseDoubleClick -= AssociatedObjectMouseDoubleClick;
            base.OnDetaching();
        }

        private void AssociatedObjectMouseDoubleClick(object sender, RoutedEventArgs routedEventArgs)
        {
            AssociatedObject.SelectAll();
        }
    } 
```

然后在 中`.xaml`，将此行为添加到您的 TextBox：

```
<TextBox>
        <i:Interaction.Behaviors>
            <local:DoubleClickBehavior/>
        </i:Interaction.Behaviors>
</TextBox> 
```

您需要添加两个命名空间来`.xaml`使用您的行为。（我的项目名称是`WpfApplication1`，因此您可能需要更改它）：

```
 xmlns:local ="clr-namespace:WpfApplication1" 
 xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity" 
```

而已。您还需要`System.Windows.Interactivity.dll`使用`Behavior`该类。

您可以从[Nuget Package Manager](http://nuget.org/packages/Blend.Interctivity.WPF.v4.0/1.0.3)下载它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-16T17:00:13.997

使用 TextBox，您可以添加`PreviewMouseDoubleClick`事件。

```
<TextBox DockPanel.Dock="Top" Name="MyTextBox" AcceptsReturn="True" PreviewMouseDoubleClick="TextBoxSelectAll"/> 
```

然后将 的TextBox.SelectedText[属性](http://msdn.microsoft.com/en-us/library/system.windows.controls.textbox.selectedtext.aspx)设置为.`TextBox``TextBox`

```
private void TextBoxSelectAll(object sender, MouseButtonEventArgs e) {
    // Set the event as handled
    e.Handled = true;
    // Select the Text
    (sender as TextBox).SelectAll();
} 
```

# java - 用于验证数字逗号分隔值的 Java 正则表达式

> ID：16041557
> 
> 赞同：5
> 
> 时间：2013-04-16T15:52:21.983
> 
> 标签：java, regex, csv, numeric

我需要使这样的数字有效的正则表达式：

```
 "+1", "1.0", "1,233", "1,233,456.34", "-1", ".34", "1,345,234,122,123" 
```

这些无效：

```
 "++1", "1.0.0", "1,23,3", "+-1233456.34", "002", "1.", "a1", "1,,2", "1 2", "1,2", ",2". 
```

我尝试了这个正则表达式的不同变体：

```
 "[\\+\\-]?[1-9]{0,3}([\\d]{3}[\\,]{1})?([\\d]{3}[\\,]{1})?([\\d]{3}[\\,]{1})?([\\d]{3}[\\,]{1})?([\\d]{3}[\\,]{1})?([\\.][\\d]*)?" 
```

测试代码：

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class REGEX {
private static final String REGEX = "[\\+\\-]?[1-9]{0,3}([\\d]{3}[\\,]{1})?([\\d]{3}[\\,]{1})?([\\d]{3}[\\,]{1})?([\\d]{3}[\\,]{1})?([\\d]{3}[\\,]{1})?([\\.][\\d]*)?";

private static String[] validNumbers = { "+1", "1.0", "1,233",
        "1,233,456.34", "-1", ".34", "1,345,234,122,123" };

private static String[] invalidNumbers = { "++1", "1.0.0", "1,23,3",
        "+-1233456.34", "002", "1.", "a1", "1,,2", "1 2", "1,2", ",2" };

public static void main(String[] args) {
    Pattern pattern = Pattern.compile(REGEX);

    for (String number : validNumbers) {
        Matcher matcher = pattern.matcher(number);
        if (!matcher.matches()) {
            System.out.println("Valid number is detected as invalid: "
                    + number);
        }
    }
    for (String number : invalidNumbers) {
        Matcher matcher = pattern.matcher(number);
        if (matcher.matches()) {
            System.out.println("Invalid number is detected as valid: "
                    + number);
        }
    }
} 
```

}

当控制台为空时，任务完成。现在我有这样的问题：

有效号码被检测为无效：1,233

有效号码被检测为无效：1,233,456.34

有效号码被检测为无效：1,345,234,122,123

无效号码被检测为有效：1。

问候。对不起大号。

**更新。**感谢**Noob UnChained**，我已经发展到这个正则表达式：

```
^([\\+\\-]?[1-9]\\d{0,2})*(\\,\\d{3})*([\\.][\\d*])?$ 
```

现在问题更少了：

有效号码被检测为无效：1,233,456.34

有效号码被检测为无效：.34

**更新。**

正则表达式：

```
"([\\+\\-]?[1-9]\\d{0,2})*(\\,\\d{3})*([.][\\d]*)?" 
```

问题：

无效号码被检测为有效：1。

**完成的**

最终结果是：

```
"(?!$)[\\+-]?([1-9]\\d{0,2}|0)?(\\,\\d{3})*(\\.\\d+)?" 
```

自上次更新以来的变化是：([.][\d]+)?

加上在这个块中，当用户输入数字然后放点但后面什么都没有时，这是不可能的情况。

**新更新：**在最后一个块中添加了 2 个“\”以避免输入逗号或其他符号而不是点。

**新更新：**感谢**user2266098**和**nhahtdh**。

**user2266098 将**我的注意力集中在“0.1”数字的未知问题上，并展示了将“|0”添加到第二个块的解决方案。但是他的正则表达式在我的数据中不能正确使用“+”和“-”（因为“（）”而不是“[]”）。而且我不喜欢量词“{0,}”而不是“*”，因为它的大小。

**nhahtdh 将**我的注意力集中在空字符串的未知问题上，并用“（？！$）”显示了解决方案。

**谢谢大家！**

**更新**

本案有新的条件：

我需要使这样的数字有效的正则表达式：

```
"+1", "1.0", "1,233", "1,233,456.34", "-1", ".34", "1,345,234,122,123", "0.1" 
```

这些无效：

```
"++1", "1.0.0", "1,23,3", "+-1233456.34", "002", "1.", "a1", "1,,2", "1 2", "1,2", ",2", "", "0,123" 
```

我仍然无法获得“完美”的正则表达式 =)

```
"(?!$)[\\+-]?([1-9]\\d{0,2}|0)?(\\,\\d{3})*(\\.\\d+)?" 
```

给出：无效数字被检测为有效：0,123

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T16:28:53.407

**FINISHED**

The final result is:

```
"(?!$)[\\+-]?([1-9]\\d{0,2}|0)?(\\,\\d{3})*(\\.\\d+)?" 
```

Change since the last update is:([.][\d]+)?

plus in this block makes impossible situation when user inputs number then puts dot but nothing after it.

New update: added 2 "\" into last block to avoid entering comma or other symbol instead of dot.

New update: Thanks to **user2266098** and **nhahtdh**.

user2266098 pointed my attention on the uncharted problem of "0.1" number and showed solution with adding "|0" to the second block. But his regexp doesn't work correctly with "+" and "-" for my data. And I don't like the quantifier "{0,}" instead of "*" because of it's size.

nhahtdh pointed my attention on the uncharted problem of empty string and showed solution with "(?!$)".

Thanks to everyone!

**Update**

There are new conditions for this case:

I need to make a regular expression with such numbers valid:

```
"+1", "1.0", "1,233", "1,233,456.34", "-1", ".34", "1,345,234,122,123", "0.1" 
```

and these invalid:

```
"++1", "1.0.0", "1,23,3", "+-1233456.34", "002", "1.", "a1", "1,,2", "1 2", "1,2", ",2", "", "0,123" 
```

I still can't get "perfect" regexp =)

```
"(?!$)[\\+-]?([1-9]\\d{0,2}|0)?(\\,\\d{3})*(\\.\\d+)?" 
```

gives: Invalid number is detected as valid: 0,123

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T16:50:14.840

这个适用于我的所有测试数据：

```
^(\\+|-)?([1-9]\\d{0,2}|0)?(,\\d{3}){0,}(\\.\\d+)? 
```

顺便说一句，我希望您也希望 0.1 成为匹配项，但您的正则表达式不适用于它。我无法发表评论，所以我在答案中写了这个

# vb.net - 将行值从表单传输到文本框到另一个（datagridview）

> ID：16041558
> 
> 赞同：0
> 
> 时间：2013-04-16T15:52:27.510
> 
> 标签：vb.net, ms-access

我有一个文本框和一个按钮。

单击按钮时，它会显示一个 DataGridView，它在单独的窗口（表单）中输出 ID 和名称。这些是从 ms-access 加载的 select 语句。

我希望当我双击任何 DataGridView 行时，ID 会传输到另一个窗口（表单）中的文本框。

（新到 vb.net 所以请多多包涵）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T00:27:28.227

尝试使用 DataGridViews cellcontentdoubleclick 事件：

```
 Private Sub DataGridView1_CellContentDoubleClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DataGridView1.CellContentDoubleClick

    Form2.TextBox1.Text = sender.CurrentCell.Value.ToString

    End Sub 
```

注意：将 DataGridView1 替换为 DataGridView 的名称，将 Form2 和 TextBox1 替换为表单和文本框的名称。

' ***

只需重新阅读您的问题，在双击时使用当前行并传递代表 ID 的单元格的索引：

```
Form2.TextBox1.Text = DataGridView1.CurrentRow.Cells(1).Value.ToString 
```

注意：将“1”替换为包含 ID 的列的索引。

# c# - 页面存在时 HttpWebResponse 返回 404 错误

> ID：16041561
> 
> 赞同：1
> 
> 时间：2013-04-16T15:52:32.080
> 
> 标签：c#, httprequest

我正在尝试编写一个小型桌面应用程序，该应用程序将通过他们的 API 监控网站。我从来没有真正用过 API 或 WebRequests，所以我不确定如何处理这个错误。生成请求后，我尝试从页面获取响应，但这会返回 404 错误，即使我在浏览器中导航到相同的 URL，它也可以正常工作。我不知道如何解决这个问题，而且我对有同样问题的人所做的研究并没有帮助我理解它。有人可以向我解释在基本层面发生了什么吗？我的代码已发布在下面：

```
private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        string sURL;
        sURL = @"https://habitrpg.com/api/v1/user";

        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(sURL);

        HttpWebResponse response = null;
        try
        {
            response = (HttpWebResponse)request.GetResponse();
        }
        catch (Exception ex)
        {
            resultText.Text = "Oh no!";
        }
        Stream receiveStream = response.GetResponseStream();
        StreamReader readStream = new StreamReader(receiveStream, Encoding.UTF8);
        string responseData = readStream.ReadToEnd();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:02:57.663

你应该忽略`https`证书，看看这个问题：

[如何使用 WebRequest 访问使用 https 的 SSL 加密站点？](https://stackoverflow.com/questions/560804/how-do-i-use-webrequest-to-access-an-ssl-encrypted-site-using-https)

# c# - 应用程序池标识更改

> ID：16041564
> 
> 赞同：0
> 
> 时间：2013-04-16T15:52:43.450
> 
> 标签：c#, asp.net, web-services, iis-7

我在服务器 A 上设置了一个 Web 方法，需要连接到服务器 B 上的文件系统。

目前，我已经在服务器 A 上运行了大量 Web 服务，其中应用程序池上的标识设置为 NETWORK SERVICE。问题是我似乎无法让 A 上的 NETWORK SERVICE 访问 B 上的文件系统。更改应用程序池上的用户并不是一个真正的选择，因为有太多可能的火车残骸可能会在传出的网络上实现服务电话。

因此，我试图提出的解决方案是在调用 Web 方法时将 Web 方法身份用户从 NETWORK SERVICE 临时更改为 DOMAIN/SOMEUSER。

我需要更改的属性是 System.Web.HttpContext.Current.User.Identity.Name

谁能告诉我我该怎么做？网上的许多解决方案似乎都引用了 Windows Azure——我没有使用它，所以概述的方法不起作用。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:58:31.337

您可能必须使用 web.config 中的标签。我们通常设置为`<identity impersonate="false" />`并且应用程序池使用域用户获取权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:48:27.810

尝试在您的服务中使用模拟。

```
<system.web> ....
<identity impersonate="true" userName="accountname" password="password" /> 
```

# sql - MS Access SQL 正在从查询中删除括号

> ID：16041568
> 
> 赞同：1
> 
> 时间：2013-04-16T15:53:01.293
> 
> 标签：sql, ms-access

我有这个工作正常的查询。当我打开创建查询并在窗口中复制/粘贴 SQL 时，它运行良好，我可以编辑表单编号并保存查询。在我关闭查询然后在设计视图中再次打开它后，括号都消失了，当我尝试更改任何内容或保存它时，我得到不支持加入表达式。查询无论如何都会运行，并且结果是正确的。我能做些什么来防止查询被这样改变？为什么要去掉括号？

```
SELECT DISTINCT 
A01.ID,
A01.Symbol,
A01.Number,
A01.Module,
A02.Form as FormHE3, 
MAX (A02.Sequence) as FormSeq
INTO [CodesAndFormsResults]
FROM 
(01_PreviousTable A01
left outer join tbl_PolForms A02 ON (A02.ID = A01.ID 
and A02.Form = 'HE3'))
GROUP BY 
A02.Form, 
A01.ID, 
A01.Symbol,
A01.Number, 
A01.Module
ORDER BY
A01.Number,A01.Symbol,A01.Module; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:36:14.897

1.  `SELECT DISTINCT``GROUP BY`在查询中是多余的；摆脱`DISTINCT`。
2.  `INTO [CodesAndFormsResults]`当您专注于构建一个`SELECT`返回您想要的内容并且 Access 的查询设计器不会破坏的普通查询时，请放弃。您可以`INTO [CodesAndFormsResults]`稍后再添加，但现在将自己限制为可能的最简单查询。
3.  `Form = 'HE3'`从 join`ON`子句移动到`WHERE`基于`tbl_PolForms`.

```
SELECT
    A01.ID,
    A01.Symbol,
    A01.Number,
    A01.Module,
    A02.Form AS FormHE3, 
    MAX(A02.Sequence) AS FormSeq
FROM 
    [01_PreviousTable] AS A01
    LEFT JOIN 
    (
        SELECT t.ID, t.Sequence, t.Form
        FROM tbl_PolForms AS t
        WHERE t.Form = 'HE3'
    ) AS A02
    ON A01.ID = A02.ID 
GROUP BY 
    A02.Form, 
    A01.ID, 
    A01.Symbol,
    A01.Number, 
    A01.Module
ORDER BY
    A01.Number,
    A01.Symbol,
    A01.Module; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:16:47.063

括号被删除，因为它们是不必要的。MS Access 总是在保存之前尝试简化查询。有时您可以欺骗 MS Access 使其不理会它，但这通常会使您的查询更加复杂和脆弱。

查询解析器抱怨（“不支持连接语法”），因为它无法直观地显示查询。当您指定条件连接时，总是会发生这种情况。真的没有问题。您只需将查询编辑为 SQL 而不是通过设计器。

# ruby - Ruby 文件句柄管理（打开的文件太多）

> ID：16041569
> 
> 赞同：7
> 
> 时间：2013-04-16T15:53:07.670
> 
> 标签：ruby, file-io, limits

我在 ruby​​ (2.0.0 p39474) 中执行非常快速的文件访问，并不断收到异常`Too many open files`

看过[这个线程](https://stackoverflow.com/questions/5350440/i-am-getting-the-error-too-many-open-files-after-writing-a-lot-of-files-in-ruby)、[这里](http://www.cyberciti.biz/faq/linux-unix-nginx-too-many-open-files/)和其他各种来源后，我很清楚操作系统的限制（`1024`在我的系统上设置）。

我执行此文件访问的代码部分是互斥的，并采用以下形式：

```
File.open( filename, 'w'){|f| Marshal.dump(value, f) } 
```

where`filename`会发生快速变化，具体取决于调用该部分的线程。据我了解，此表单在块后放弃其文件句柄。

我可以验证`File`使用打开的对象的数量[`ObjectSpace.each_object(File)`](http://ruby-doc.org/core-2.0/ObjectSpace.html#method-c-each_object)。这报告说内存中最多有 100 个常驻，但正如预期的那样，只有一个是打开的。

`File`此外，异常本身是在仅报告 10-40 个对象时引发的`ObjectSpace`。`sleep`此外，手动垃圾收集无法改善任何这些计数，通过插入调用减慢我的脚本也是如此。

因此，我的问题是：

*   ~~我是否从根本上误解了操作系统限制的性质——它是否涵盖了进程的整个生命周期？~~
    *   ~~如果是这样，Web服务器如何避免在访问`ulimit -n`文件后崩溃？~~
    *   ~~ruby 是在其对象系统之外保留其文件句柄，还是内核在计算“并发”访问时非常慢？~~

编辑 20130417： `strace`表示 ruby​​ 不会将其所有数据写入文件，在这样做之前返回并释放互斥锁。因此，文件处理堆栈直到操作系统限制。

为了解决这个问题，我使用了`syswrite`/ `sysread`，同步模式，并`flush`在之前调用了`close`。这些方法都不起作用。

因此，我的问题被修改为： **为什么 ruby​​ 无法关闭其文件句柄，我该如何强制它这样做？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:02:22.597

使用*dtrace*或*strace*或系统上的任何等效项，并准确找出正在打开的文件。

请注意，这些可能是套接字。

我同意您粘贴的代码似乎无法导致此问题，至少，也不会没有一个相当奇怪的并发错误。

# breeze - Breeze: Unable to get property 'propertyRef' of undefined or null reference

> ID：16041570
> 
> 赞同：0
> 
> 时间：2013-04-16T15:53:07.897
> 
> 标签：breeze

I have an abstract class and another class:

```
public abstract class AClass
    {
        [Key]
        public int Id { get; set; }
        public string Name { get; set; }
    }

public class BClass: AClass
    {
        public string OtherName { get; set; }
    } 
```

The abstract class have key property, but I received the next error:

> Unhandled exception at line 5007, column 9 in /scripts/breeze.debug.js
> 
> 0x800a138f - JavaScript runtime error: Unable to get property 'propertyRef' of undefined or null reference
> 
> Line of error:
> 
> breeze.debug.js
> 
> var keyNamesOnServer = toArray(odataEntityType.key.propertyRef).map(__pluck("name"));

The entity "BClass" doesn't contain key property, but abstract class AClass contain key property.

Please, help me with this error.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:26:37.120

## Edit: As of v 1.3.1 Breeze now DOES support inheritance.

Breeze does not yet support inheritance, but it is on our roadmap. Please vote for this feature on the [Breeze User Voice](https://breezejs.uservoice.com/forums/173093-breeze-feature-suggestions/suggestions/3083057-support-inheritence-in-the-object-model) to indicate that you feel that it is important. We take this venue very seriously in prioritizing which features we add next.

# visual-c++ - MFC 中 OnPaint() 函数的使用

> ID：16041572
> 
> 赞同：3
> 
> 时间：2013-04-16T15:53:14.817
> 
> 标签：visual-c++, mfc

我正在尝试学习 MFC 文档视图应用程序。我开始创建一个简单的图像查看器应用程序。为此，我从 CScrollView 类派生了我的视图类并覆盖了 draw() 函数。

我想知道何时使用 OnPaint() 函数以及它与 draw() 函数的关系。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T15:58:24.797

您不应该在同一个视图中同时需要 an`OnPaint`和`OnDraw`function 。根据[微软的文档](http://msdn.microsoft.com/en-us/library/ssdhfz2t%28v=vs.80%29.aspx)：

> 当视图变得无效时，Windows 会向它发送 WM_PAINT 消息。视图的 OnPaint 处理函数通过创建 CPaintDC 类的设备上下文对象响应消息并调用视图的 OnDraw 成员函数。您通常不必编写重写 OnPaint 处理程序函数。

通过将绘图代码拆分为自己的函数，该框架允许您重用它来绘制屏幕和打印。

# visual-studio - 等待后台操作完成

> ID：16041576
> 
> 赞同：6
> 
> 时间：2013-04-16T15:53:26.307
> 
> 标签：visual-studio, visual-studio-2012, razor, freeze

我一直在遭受 Visual Studio 2012（专业版）中非常常见的“等待后台操作完成...”消息的困扰，但它相当零星。

不过最近，每当我尝试对任何 Razor 视图（主要是单击以移动光标）执行任何操作时，我都非常努力地使用 Visual Studio，Visual Studio 挂起，并且上述消息一次出现大约一分钟。（如果它完成后我再次单击视图，则该过程重复，重复，重复......）

我搜索了高低，并阅读了大量关于此和人们建议的文章，并尝试更改缩进设置、重置设置等，但都没有奏效。

有没有人遇到过其他可能有用的东西，因为这严重阻碍了我使用视觉工作室的能力，可悲的是招致了很多诅咒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-07T15:25:07.727

我知道我不久前问过这个问题，但我认为最好提出我的发现，因为它们可能对其他人有所帮助。

等待对话框的确切原因仍然未知，但我已经将我的项目移动到本地磁盘并实现了 Team Foundation 服务器来执行主项目文件的托管和备份。

自从移动到本地磁盘并使用 TFS 后，我再也没有遇到过 VS Waiting 对话框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-26T09:09:04.820

我在 VS2012 上也遇到了同样的问题，不幸的是，在尝试了以下所有解决方案后，我不得不格式化我的电脑：

1.  移动/清理符号缓存
2.  重置 VS 首选项
3.  安装升级 2
4.  卸载/重新安装 VS

格式化并重新安装 VS2012 后，它再次开始像魅力一样工作（显然）。

对此感到抱歉。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-03T19:27:51.657

检查 IIS 或其他进程（可能是 BizTalk）是否锁定了您的 DLL/引用
如果是，则终止/停止 IIS

# c# - 试图让数据显示在我的列表视图中

> ID：16041578
> 
> 赞同：1
> 
> 时间：2013-04-16T15:53:28.117
> 
> 标签：c#, wpf, listview, file-io

我一直在尝试使用数据绑定和文件 IO 概念进行练习，为此我编写了这个简单的应用程序，它读取 2 列 5 行 .csv 文件并将内容显示到 WPF 中的 Listview 中，具有我可以更改的功能我的 Listview 中第二列的值（如 2 路绑定）。

我无法获得任何信息以显示在我的窗口中。我只得到我在 MainWindow.xaml 中定义的列标题，但没有一个数据绑定工作。

这是我的视图模型代码和读取文件

```
namespace WpfPreview
{

public class LoadMovieData : BindableObject // My Data Context?
{
    public string MovieName { get; set; }
    private double year; public double Year { get { return year; } set { year = value; RaisePropertyChanged("Year"); } }
}

class ViewModel : BindableObject
{
    private List<LoadMovieData> obsMovies = new List<LoadMovieData>();
    public List<LoadMovieData> ObsMovies
    {
        get { return obsMovies; }
        set { obsMovies = value; RaisePropertyChanged("ObsMovies"); }
    }

    public void ReadFile()
    {

            string filepath = System.IO.Path.Combine("C:\\Users\\Param\\Desktop", "excel.csv"); // Get filepath

            using (var csvReader = new StreamReader(filepath)) // using this filepath
            {
                csvReader.ReadLine();       // read first line (headers)
                csvReader.ReadLine();       // read first line of row data

                while (!csvReader.EndOfStream) // while not end of file
                {
                    var words = csvReader.ReadLine().Split(',').ToList(); // read line to list of columns
                    var x = new LoadMovieData()  // new instance of data class
                    {
                        MovieName = words[0],
                        Year = Convert.ToDouble(words[1])
                    };

                    ObsMovies.Add(x); // add instance of data class to list variable

                }
            }

        }

    }
} 
```

我不确定我的条款是否正确。我正在尝试遵循 MVVM 模式。我的窗口代码隐藏是这样的：

```
namespace WpfPreview
{
/// <summary>
/// Interaction logic for MainWindow.xaml
/// </summary>
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        this.DataContext = new ViewModel();
    }
}
} 
```

这是我的 XAML 部分：

```
<Window x:Class="WpfPreview.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:me="clr-namespace:WpfPreview"
    Title="MainWindow" Height="350" Width="525">
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <Border Background="White">

        <ListView x:Name="MovieListView" ItemsSource="{Binding Path=ObsMovies}" VirtualizingStackPanel.IsVirtualizing="True" Background="Transparent">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="Movie Name">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="{Binding ObsMovies.MovieName}" />
                                </Grid>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Year" Width="60">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <Grid>
                                    <TextBlock Text="{Binding ObsMovies.Year}" />
                                </Grid>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>
    </Border>
</Grid> 
```

我对使用文件 IO 和数据绑定/数据上下文非常陌生。我确信某处有一个明显的错误，我正在尝试做的事情可以用一种更容易/不太复杂的方式来完成。请随时给我建议以重组我的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:35:40.887

我通常将数据加载代码放在 ViewModel 构造函数中。此外，如果没有访问修饰符，我相信您的 ViewModel 类是私有的，因此您将无法从类外部调用任何内容。考虑制作它`public`。

看起来您的 obsMovies 列表应该是`ObservableCollection`. obsMovies 的值实现了 PropertyChanged 通知，但是如果您向其添加项目，则该集合不会通知 UI 其集合已更改。

# 改变这个：

```
private List<LoadMovieData> obsMovies = new List<LoadMovieData>();
public List<LoadMovieData> ObsMovies
{
    get { return obsMovies; }
    set { obsMovies = value; RaisePropertyChanged("ObsMovies"); }
} 
```

# 对此：

```
private ObservableCollection<LoadMovieData> obsMovies = new ObservableCollection<LoadMovieData>();
public ObservableCollection<LoadMovieData> ObsMovies
{
    get { return obsMovies; }
    set { obsMovies = value; RaisePropertyChanged("ObsMovies"); }
} 
```

您必须导入 System.Collections.ObjectModel 才能使用它。

此外，看起来您的绑定可能不太正确。尝试使用以下内容：

```
 <ListView.View>
     <GridView>
        <GridViewColumn Header="Movie Name">
            <GridViewColumn.CellTemplate>
                <DataTemplate>
                    <Grid>
                        <TextBlock Text="{Binding ObsMovies.MovieName}" />
                    </Grid>
                </DataTemplate>
            </GridViewColumn.CellTemplate>
        </GridViewColumn>
        <GridViewColumn Header="Year" Width="60">
            <GridViewColumn.CellTemplate>
                <DataTemplate>
                    <Grid>
                        <TextBlock Text="{Binding ObsMovies.Year}" />
                    </Grid>
                </DataTemplate>
            </GridViewColumn.CellTemplate>
        </GridViewColumn>
    </GridView>
</ListView.View> 
```

上述绑定省略了 TextBlock 绑定中的 ObsMovies。由于每一行 DataContext 都是集合中的一项，因此不需要在绑定中引用集合。只需让绑定路径从数据上下文级别开始（在本例中为 ObsMovies）。

最后，正如所承诺的，DataGrid 的示例实现：

```
<DataGrid HorizontalAlignment="Left" VerticalAlignment="Top" ItemsSource="{Binding ObsMovies}">
    <DataGrid.Columns>
        <DataGridTextColumn Binding="{Binding Year}" ClipboardContentBinding="{x:Null}" Header="Year"/>
        <DataGridTextColumn Binding="{Binding MovieName}" ClipboardContentBinding="{x:Null}" Header="Movie Name"/>
    </DataGrid.Columns>
</DataGrid> 
```

要拥有允许编辑项目的文本框，在 listView 示例中，将 TextBlocks 替换为 TextBoxes，对于 DataGrid，指定一个 DataGridTemplateColumn 并将一个 TextBox 放入模板中：

```
<DataGridTemplateColumn ClipboardContentBinding="{x:Null}">
    <DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
            <TextBox Text="{Binding Property}"/>
        </DataTemplate>
    </DataGridTemplateColumn.CellTemplate>
</DataGridTemplateColumn> 
```

# email - 如何在 django 中存储完整的电子邮件

> ID：16041581
> 
> 赞同：3
> 
> 时间：2013-04-16T15:53:34.717
> 
> 标签：email, django-models

这有点难以用谷歌搜索，所以我在这里问......你将如何将整个电子邮件存储为 django 模型？我计划将电子邮件信息存档到数据库（部分也可能最终存储在磁盘上的文件中）。

由于我想尽可能多地存储有关它的信息（同时仍然可以搜索），如果有人已经完成了艰苦的工作，我会很高兴。在我的情况下，仅存储正文和最相关的字段是不够的。

所以问题是：是否有一个 django 应用程序已经提供了模型来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T03:53:10.887

还有另一个[问题](https://stackoverflow.com/questions/65001/storing-email-messages-in-a-database)涉及一般的电子邮件消息模型（不是特定于 Django 的）。对于 Django 模型，请参阅 **django-mailbox**[`Message`](https://github.com/latestrevision/django-mailbox/blob/master/django_mailbox/models.py#L289)中的模型，它看起来像[Django Packages](https://www.djangopackages.com/grids/g/email/)上与电子邮件相关的网格中列出的最相关的应用程序。

# bash - 重定向 bash 错误

> ID：16041589
> 
> 赞同：0
> 
> 时间：2013-04-16T15:54:00.470
> 
> 标签：bash, redirect

我正在编写一个 bash 脚本，它有一个问题：

```
path=$(pwd)
data=$(ls -al $path) > /dev/null 2>/dev/null 
```

如果`$path`是“锁定”目录（用户 x 没有权限），则会出现问题，称之为“BadDir”。在这种情况下，程序输出：

```
ls: cannot access /home/user/.../BadDir/..: Permission denied 
```

我想要的只是隐藏这个输出。我知道有重定向，`/dev/null`但我不知道在这种特殊情况下如何使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-05-10T18:45:04.420

您可以使用重定向所有错误消息到另一个`EXEC`

为了测试，首先创建文件夹

```
mkdir /tmp/t/
sudo chown root /tmp/t/
sudo chgrp root /tmp/t/
sudo chmod 400 /tmp/t/ 
```

例如：

```
ls -al /tmp/t/ 
```

输出：

```
ls: cannot open directory /tmp/t/: Permission denied 
```

并使用`EXEC`第一个文件：

```
exec 2>/dev/null
ls -al /tmp/t/ 
```

您可以控制和`exec`重定向所有`error message`或其他输出

# c# - 使用 for 循环替换 .NET C# 模型中的字符串字符

> ID：16041600
> 
> 赞同：0
> 
> 时间：2013-04-16T15:54:25.380
> 
> 标签：c#, asp.net-mvc, variables

我是 .NET MVC 的新手，来自 PHP/Java/ActionScript。

我遇到的问题是 .NET 模型和`get{}`. 我不明白为什么我的`Hyphenize`字符串会返回`SomeText`截断为 64 个字符的值，但不会替换数组中定义的任何字符。

模型 - 这应该`SomeText`用一个简单的连字符替换某些字符`-`：

```
 public string SomeText{ get; set;} // Unmodified string

    public string Hyphenize{ 
        get {
            //unwanted characters to replace
            string[] replace_items = {"#", " ", "!", "?", "@", "*", ",", ".", "/", "'", @"\", "=" };
            string stringbuild = SomeText.Substring(0, (SomeText.Length > 64 ? 64 : SomeText.Length));

            for (int i = 0; i < replace_items.Length; i++)
            {
                stringbuild.Replace(replace_items[i], "-");
            }

            return stringbuild;
        }

        set { }
    } 
```

或者，下面的方法确实可以正常工作，并将返回替换了`" "`和`"#"`字符的字符串。但是，令我困扰的是，我无法理解为什么 for 循环不起作用。

```
 public string Hyphenize{ 
        get {
            //Replaces unwanted characters
            return SomeText.Substring(0, (SomeText.Length > 64 ? 64 : SomeText.Length)).Replace(" ", "-").Replace("#", "-");
        }

        set { }
    } 
```

最终我结束了

```
return Regex.Replace(SomeText.Substring(0, (SomeText.Length > 64 ? 64 : SomeText.Length)).Replace("'", ""), @"[^a-zA-Z0-9]", "-").Replace("--", "-"); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T15:56:33.587

`string`是*不可变*的，来自[MSDN](http://msdn.microsoft.com/en-us/library/vstudio/362314fe.aspx)：

> Strings are immutable--the contents of a string object cannot be changed after the object is created, although the syntax makes it appear as if you can do this.

so you need to have to assign again:

```
 stringbuild = stringbuild.Replace(replace_items[i], "-"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T15:57:22.337

You're not assigning the value of `Replace()` to anything. It returns its result, and does not modify the string that it operates on. (String's are immutable).

# jquery - jquery appendTo html排序问题

> ID：16041601
> 
> 赞同：0
> 
> 时间：2013-04-16T15:54:26.283
> 
> 标签：jquery

我有下面的代码，将问题/答案附加到 div。

它有效，但它以错误的顺序写入 div。它将任何新的 div 放在最后一个之前，因此编号变得无序，如下所示：

```
Question 3
Question 2
Question 1 
```

我玩过 appendTo、append，但我所做的任何事情都不起作用。

任何帮助，将不胜感激。谢谢！

这是代码：

```
$(".questionButton").click(function () {
var parentId = $("button").closest("div").attr("id");
var newTextBoxDiv = $("<div>").attr("id", 'question' + questionCounter);
        $(this).after(newTextBoxDiv);
        newTextBoxDiv.after().html(
            "<table><tr>" +
            "<td>" +
            "<label>Question " + questionCounter + ": </label>" +
            "</td><td>" +
            "<input type='text' name='tbQuestion' id='tbQuestion" + questionCounter + "' value='' >" +
            "</td>" +
            "<td class='removeQuestion'>x</td>" +
            "</tr><tr><td>" +
            "<label>Answer: </label>" +
            "</td><td>" +
            "<input type='text' name='tbAnswer'" id='tbAnswer" + questionCounter + "' value='' >" +
            "</td></tr></table>");
        newTextBoxDiv.appendTo("#" + parentId);
        questionCounter++;
}); 
```

html:

```
<div id="questionBox">
    <div id="mcq" style="display: none;" class="questionTypeDiv">
        <input type="button" class="questionButton" value="Add Question" style="margin-top: 4px;" />
        <table></table>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:38:58.983

您错误地将 div 附加在按钮之后，而不是您的：http `<div id="mcq">`: [//jsfiddle.net/ZTuhn/1/](http://jsfiddle.net/ZTuhn/1/)

您还可以通过正确选择前面的问题 id 然后在其后附加来修复此错误。但是，这需要对您的初始 questionBox id 属性进行一些异常处理。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-16T16:06:58.553

要按顺序追加，您应该像这样使用 .append() ：

```
$.each([1,2,3], function(i,v) {
    $('#' + parentId).append('<p>Question ' + v + '</p>')
}); 
```

# java - 尽管 Verisign 证书有效，但“PKIX 路径构建失败”

> ID：16041602
> 
> 赞同：0
> 
> 时间：2013-04-16T15:54:28.673
> 
> 标签：java, ssl, openssl

我遇到了与此处所述类似的问题：

[我与之交谈的网络服务器更新了它的 SSL 证书，现在我的应用程序无法与之交谈](https://stackoverflow.com/questions/5758812/the-webserver-i-talk-to-updated-its-ssl-cert-and-now-my-app-cant-talk-to-it)

尽管拥有有效的 Verisign 证书，但出现“PKIX 路径构建失败”异常。

我不明白为什么当我在网络浏览器中点击相同的 URL 时服务器工作正常。

服务器正在发送整个证书链，我可以在我的网络浏览器中看到它：

```
 (Verisign root)
     -> (VeriSign Class 3 Secure Server CA - G3) 
       -> (my server) 
```

但是由于某种原因，Java 和 OpenSSL 命令行工具没有看到它。

`wget`失败，并且`openssl s_connect`只看到中间“G3”证书。

然而 IE 和 Chrome - 没问题。

这里发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:19:41.987

你在浏览器中看到的不一定是服务器发送的链，而是浏览器重构的链。Windows 可能将 G3 中间 CA 作为受信任的锚点，而其他客户端则没有。

要检查服务器发送的实际链，请使用`-showcerts`with `s_connect`：

```
openssl s_client -showcerts -connect your.host.name:443 
```

确保以正确的顺序发送链：首先是服务器证书，然后是中间证书（如果需要）。

```
Certificate chain
 0 s:/.../CN=your.host.name
   i:/.../CN=VeriSign Class 3 Secure Server CA - G3
-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----
 1 s:/.../CN=VeriSign Class 3 Secure Server CA - G3
   i:/.../CN=Verisign root
-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE----- 
```

（以防万一，检查您是否获得了正确的证书，以防万一您使用的是 SNI，但使用不支持它的 Java 或 OpenSSL 版本。）

一个很好的检查工具是[Qualys SSL 实验室测试](https://www.ssllabs.com/ssltest/)。

此外，根据安装方式`wget`或`openssl`安装方式，它们通常没有受信任锚点的默认列表，因此您必须明确为它们提供指向 CA 证书包的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:56:40.280

似乎不被and`G3`认为是信任的`Java``openssl`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:19:05.053

之所以会发生这种情况，是因为根证书必须驻留在本地（在客户端上）才能被信任。如果有问题的威瑞信根证书在本地不受信任，那么它是否包含在服务器发送的链中并不重要 - 它不受客户端信任。

# api - 使用 RESTful API 进行客户端和服务器端验证

> ID：16041604
> 
> 赞同：3
> 
> 时间：2013-04-16T15:54:30.287
> 
> 标签：api, validation, rest

假设我有一个`POST /orders`将订单项目集合作为输入的操作。一个订单不能包含超过 50 件商品，但我在哪里执行此验证？

在客户端和服务器中验证订单大小将是多余的，如果我决定更改订单大小限制，则会增加维护成本。

仅在服务器中对其进行验证将防止客户端“快速失败”（即，您将一千件商品添加到订单中，并且仅在完成时才被告知限制）。

我假设客户端验证不是一个选项，因为 API 可能有其他客户端。

如果我有动态验证规则，问题会变得更加复杂。假设零售客户可以订购 50 件商品，但批发客户的订单中可以订购 500 件商品。API 是否应该公开一个操作，以便客户端可以获取当前的验证规则？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T21:23:49.967

[我同意前面](https://stackoverflow.com/a/16044285)所说的。

虽然，我认为如果您可以预测用户可能遇到的几乎所有情况，您也可以创建客户端验证。

根据您关于批发/零售的示例，您可以首先创建一个下拉列表，要求客户选择他们是批发还是零售，然后根据第一个选项将 500/50 规则应用于输入框。

明显的问题在于，如果您的 API 发布给其他开发人员，他们可能不知道 50/500 规则，这就是我同意之前关于服务器上发生的关键验证的答案的地方。如果您正在构建供自己使用的 API，那么您可以采用任何一种方式，因为您知道输入限制。如果应用程序非常大，它还将节省相当多的服务器成本（服务器上的验证会很费力）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:18:55.207

你必须两者都做，但不同。

为了保证有效操作，所有关键验证都必须在服务器/Web 服务端进行。客户端 UI 就是这样 - 一个用户界面，使人们可以方便地与 Web 服务进行交互。一旦 Web 服务稳定且安全，创建一个默认方法通过客户端将 Web 服务错误传递给用户。在那之后，UI 层中的功能是可用性问题，应该基于测试（即使那是通过监视用户的肩膀或听取反馈的非正式测试。）

# vb.net - 页面加载上的 ASP VB.net 根据其值隐藏详细信息视图

> ID：16041613
> 
> 赞同：0
> 
> 时间：2013-04-16T15:55:00.520
> 
> 标签：vb.net, if-statement, detailsview, visible

我想在控件值为 0 的页面加载时隐藏 Detailsview 控件。Detailsview 链接到 sql 数据库，显示的值是从零向上的数值。

我已将控件设置如下：

```
<asp:DetailsView Height="25px" Width="60px" ID="dv2cG" runat="server" AutoGenerateRows="False" DataSourceID="ds2cG" BorderWidth="0px" HorizontalAlign="Center" BackColor="#ccd0ff" >
    <Fields>
        <asp:BoundField showheader="false" DataField="2cG" HeaderText="2cG" ReadOnly="True" SortExpression="2cG" />
    </Fields>
</asp:DetailsView>

<asp:SqlDataSource ID="ds2cG" runat="server" ConnectionString="<%$ ConnectionStrings:MaltingsConnectionString %>" SelectCommand="select sum(case when (name = 'English' and ks2en = '2c' and result like 'G') or (name = 'Mathematics' and ks2ma = '2c' and result like 'G') or (not name = 'Mathematics' and not name = 'English' and ks2av = '2c' and result like 'G') then 1 else 0 end) as '2cG' from student join subject on student.upn=subject.upn where @TeachingGroup = 'Select All' AND ([StuYear] = @StuYear) AND ([DataCollection] = @DataCollection) AND ([Name] = @SubjectName) OR @TeachingGroup &lt;&gt; 'Select All' AND ([StuYear] = @StuYear) AND ([DataCollection] = @DataCollection) AND ([Name] = @SubjectName) AND ([TeachingGroup] = @TeachingGroup)">

<SelectParameters>
    <asp:ControlParameter ControlID="DdlTeachingGroup" Name="TeachingGroup" PropertyName="SelectedValue" />
    <asp:ControlParameter ControlID="DdlYear" Name="StuYear" PropertyName="SelectedValue" />
    <asp:ControlParameter ControlID="ddlDataCollection" Name="DataCollection" PropertyName="SelectedValue" />
    <asp:ControlParameter ControlID="DdlSubject" Name="SubjectName" PropertyName="SelectedValue" />
 </SelectParameters> 
```

我写了以下简单的程序：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    'G column - sets dataitem to visible false where the dataitem equal 0
     If dv2cG.DataItem = 0 Then
         dv2cG.Visible = False
     Else
         dv2cG.Visible = True
     End If

End Sub 
```

这成功隐藏了 DetailsView。但是，即使控件中的值不等于 1，它也会这样做。

谢谢阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:12:40.147

[我在这里](https://stackoverflow.com/questions/861778/how-to-avoid-the-divide-by-zero-error-in-sql)偶然发现这篇文章时解决了这个问题。

我`nullif()`在 sql 命令上使用了该函数，例如

```
select nullif(sum(case when.....then 1 else 0 end),0) as '2cG' 
```

# cassandra - 如何使用pycassa删除一行中的所有列？

> ID：16041615
> 
> 赞同：1
> 
> 时间：2013-04-16T15:55:04.900
> 
> 标签：cassandra, pycassa

我有一个包含多个简单列的行，我只需要删除行中的列而不删除行键本身。

我尝试使用 remove('row key') 但它会删除行键本身。如何使用 remove() 函数删除一行中的所有列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:00:33.893

Cassandra 中没有实际的行对象——行本身并不存在，它们只是列的容器。查询时，您无法区分已删除列的行和从未存在的行。所以 remove('row key') 正是你需要删除一行中的所有列。

但是，在范围切片查询期间，您可能会看到行墓碑对象 - 请参阅[http://wiki.apache.org/cassandra/FAQ#range_ghosts](http://wiki.apache.org/cassandra/FAQ#range_ghosts)。这是一个临时对象，应用程序不得使用它来指示任何内容。

# jquery - Rails 中的重复表单渲染

> ID：16041617
> 
> 赞同：0
> 
> 时间：2013-04-16T15:55:09.897
> 
> 标签：jquery, html, ruby-on-rails, ruby, ruby-on-rails-3

我有一个像下面这样的rails嵌套形式。我想做的是根据用户在我的主要挑战表单上选择的值自动呈现一定数量的阶段表单。

```
<%= form_for(@challenge, :html => {:id => "new_challenge_form"}) do |f| %>
    .
    .
    .
    <h3 class="color-gray small-padding-bottom">
        <%= t "challenges.form_labels.how_many_phases" %>
    </h3>
    <%= number_field_tag 'quantity', 1, :in => 1...10, :class => "text-input-wizard" %>
    <button> Generate Phases! </button>
<% end %> 
```

我试图用一些 jquery 来实现这一点，但它不起作用。就像是

```
$('.block').html('<%= escape_javascript(render("phases/new")).html_safe %>') 
```

这样做的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:07:54.990

用表单创建部分。对于 new.html.erb 中的 mexample _challenge_form.html.erb，使用 .block 类创建 div。然后创建 new.js.erb 并将 js 代码移到那里

```
$('.block').html('<%= escape_javascript(render("phases/_challenge_form", :challenge => @challenge)).html_safe %>') 
```

# c# - 如何将下拉列表控件脚本应用于 .aspx 页面？

> ID：16041618
> 
> 赞同：0
> 
> 时间：2013-04-16T15:55:17.900
> 
> 标签：c#, asp.net, drop-down-menu, master-pages

我目前开始深入研究 ASP.Net 的世界。到目前为止，我一直在相应地使用 CSS 以 HTML 样式创建我的大部分页面，最近我一直在将 Site.Master 页面应用于我的页面以整理代码。我正在创建一个需要下拉列表控件的页面，该控件最终将进入数据库并显示相关信息，但现在我保持简单，当你在下拉列表中选择一个项目。问题是，我似乎无法弄清楚如何将脚本应用于页面。

到目前为止，这就是我所拥有的：

```
<%@ Page Title="Bowtie Performance Parts - Inventory" Language="C#" MasterPageFile="~/Site.master" AutoEventWireup="true"
    CodeBehind="parts.aspx.cs" Inherits="WebApplication1._Default"%>

<asp:Content ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
<!--Dropdown Menu Setup-->
<head>

</head>
</asp:Content>

<asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">
    <h1 class="defaultTitle">Parts Catalog</h1>
    <p id="defaultLarge">Please Choose from the list below to get started!</p>

    <center>
        <form id="PartsForm" runat="server">
            <asp:DropDownList id="dropDown2" runat="server">
            <asp:ListItem>Please Choose</asp:ListItem>
            <asp:ListItem disabled="disabled">--Motors--</asp:ListItem>
            <asp:ListItem>4 Cylinder</asp:ListItem>
            <asp:ListItem>6 Cylinder</asp:ListItem>
            <asp:ListItem>8 Cylinder</asp:ListItem>
            <asp:ListItem disabled="disabled">--Intakes--</asp:ListItem>
            <asp:ListItem disabled="disabled">--Forced Induction--</asp:ListItem>
            <asp:ListItem>Superchargers</asp:ListItem>
            <asp:ListItem>Turbos</asp:ListItem>
            </asp:DropDownList></form>
   </center>
</asp:Content> 
```

页面按预期设置样式并显示，下拉菜单按预期显示和工作，但现在我试图找出放置脚本的位置，以便当我在列表中选择一个项目时，它会显示“你有选定的项目 #"。

```
<script  runat="server">
Sub submit(sender As Object, e As EventArgs)
   mess.Text="You selected " & dropDown2.SelectedItem.Text
End Sub
</script> 
```

将此脚本放在代码中的任何位置都会导致错误并且页面无法正确编译。我是使用 C# 和 ASP.net 的新手，我不确定我是否掌握了如何做到这一点的逻辑。我看过很多这样的例子：

```
<script  runat="server">
Sub submit(sender As Object, e As EventArgs)
   mess.Text="You selected " & drop1.SelectedItem.Text
End Sub
</script>

<!DOCTYPE html>
<html>
<body>

<form runat="server">
<asp:DropDownList id="drop1" runat="server">
<asp:ListItem>Item 1</asp:ListItem>
<asp:ListItem>Item 2</asp:ListItem>
<asp:ListItem>Item 3</asp:ListItem>
<asp:ListItem>Item 4</asp:ListItem>
<asp:ListItem>Item 5</asp:ListItem>
<asp:ListItem>Item 6</asp:ListItem>
</asp:DropDownList>
<asp:Button Text="Submit" OnClick="submit" runat="server"/>
<p><asp:label id="mess" runat="server"/></p>
</form>

</body>
</html> 
```

但是以这种方式应用脚本会阻止我引用包含横幅、导航栏和指向整个网站样式的 .css 文件的链接的 Site.Master 页面（在所有网页上保持统一）。

如何才能做到这一点？

在此先感谢，泰勒院长

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T03:28:32.650

在您的代码后面使用 drop1_SelectedIndexChanged 事件

```
Protected Sub drop1_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles drop1.SelectedIndexChanged

  mess.text = drop1.SelectedValue     

End Sub 
```

这是在 VB 中，但您可以将其转换为 C#。

# c++ - FFMpeg 编码的视频只能在 FFPlay 中播放

> ID：16041621
> 
> 赞同：0
> 
> 时间：2013-04-16T15:55:34.930
> 
> 标签：c++, ffmpeg, video-encoding

我已经调试我的程序几个星期了，输出视频只显示一个空白屏幕（正在使用 VLC、WMP 和 WMPClassic 进行测试）。我碰巧尝试使用 FFPlay 并看到视频完美运行。我读过这通常是由不正确的像素格式引起的，切换到 PIX_FMT_YUV420P 将使其普遍工作......但我已经在编码过程中使用该像素格式。还有什么导致这种情况的吗？

```
AVCodec* codec;
AVCodecContext* c = NULL;
uint8_t* outbuf;
int i, out_size, outbuf_size;

avcodec_register_all();

printf("Video encoding\n");

// Find the mpeg1 video encoder
codec = avcodec_find_encoder(CODEC_ID_H264);
if (!codec) {
    fprintf(stderr, "Codec not found\n");
    exit(1);
}
else printf("H264 codec found\n");

c = avcodec_alloc_context3(codec);

c->bit_rate = 400000;
c->width = 1920;                                        // resolution must be a multiple of two (1280x720),(1900x1080),(720x480)
c->height = 1200;
c->time_base.num = 1;                                   // framerate numerator
c->time_base.den = 25;                                  // framerate denominator
c->gop_size = 10;                                       // emit one intra frame every ten frames
c->max_b_frames = 1;                                    // maximum number of b-frames between non b-frames
//c->keyint_min = 1;                                        // minimum GOP size
//c->i_quant_factor = (float)0.71;                      // qscale factor between P and I frames
//c->b_frame_strategy = 20;
//c->qcompress = (float)0.6;
//c->qmin = 20;                                         // minimum quantizer
//c->qmax = 51;                                         // maximum quantizer
//c->max_qdiff = 4;                                     // maximum quantizer difference between frames
//c->refs = 4;                                          // number of reference frames
//c->trellis = 1;                                           // trellis RD Quantization
c->pix_fmt = PIX_FMT_YUV420P;
c->codec_id = CODEC_ID_H264;
//c->codec_type = AVMEDIA_TYPE_VIDEO;

// Open the encoder
if (avcodec_open2(c, codec,NULL) < 0) {
    fprintf(stderr, "Could not open codec\n");
    exit(1);
}
else printf("H264 codec opened\n");

outbuf_size = 100000 + c->width*c->height*(32>>3);//*(32>>3);           // alloc image and output buffer
outbuf = static_cast<uint8_t *>(malloc(outbuf_size));
printf("Setting buffer size to: %d\n",outbuf_size);

FILE* f = fopen("example.mpg","wb");
if(!f) printf("x  -  Cannot open video file for writing\n");
else printf("Opened video file for writing\n");

// encode 5 seconds of video
for(i=0;i<STREAM_FRAME_RATE*STREAM_DURATION;i++) {
    fflush(stdout);

    screenCap();

    int nbytes = avpicture_get_size(PIX_FMT_YUV420P, c->width, c->height);
    uint8_t* outbuffer = (uint8_t*)av_malloc(nbytes*sizeof(uint8_t));

    AVFrame* inpic = avcodec_alloc_frame();
    AVFrame* outpic = avcodec_alloc_frame();

    outpic->pts = (int64_t)((float)i * (1000.0/((float)(c->time_base.den))) * 90);
    avpicture_fill((AVPicture*)inpic, (uint8_t*)pPixels, PIX_FMT_RGB32, c->width, c->height);                   // Fill picture with image
    avpicture_fill((AVPicture*)outpic, outbuffer, PIX_FMT_YUV420P, c->width, c->height);
    av_image_alloc(outpic->data, outpic->linesize, c->width, c->height, c->pix_fmt, 1); 

    inpic->data[0] += inpic->linesize[0]*(screenHeight-1);                                                      // Flipping frame
    inpic->linesize[0] = -inpic->linesize[0];                                                                   // Flipping frame

    struct SwsContext* fooContext = sws_getContext(screenWidth, screenHeight, PIX_FMT_RGB32, c->width, c->height, PIX_FMT_YUV420P, SWS_FAST_BILINEAR, NULL, NULL, NULL);
    sws_scale(fooContext, inpic->data, inpic->linesize, 0, c->height, outpic->data, outpic->linesize);

    // encode the image
    out_size = avcodec_encode_video(c, outbuf, outbuf_size, outpic);
    printf("Encoding frame %3d (size=%5d)\n", i, out_size);
    fwrite(outbuf, 1, out_size, f);
    delete [] pPixels;
    av_free(outbuffer);     
    av_free(inpic);
    av_free(outpic);
}

// get the delayed frames
for(; out_size; i++) {
    fflush(stdout);

    out_size = avcodec_encode_video(c, outbuf, outbuf_size, NULL);
    printf("Writing frame %3d (size=%5d)\n", i, out_size);
    fwrite(outbuf, 1, out_size, f);
}

// add sequence end code to have a real mpeg file
outbuf[0] = 0x00;
outbuf[1] = 0x00;
outbuf[2] = 0x01;
outbuf[3] = 0xb7;
fwrite(outbuf, 1, 4, f);
fclose(f);

avcodec_close(c);
free(outbuf);
av_free(c);
printf("Closed codec and Freed\n"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-08T06:05:37.553

尝试将文件保存为`example.h264`，而不是`example.mpg`.

# c++ - 在大型 C++ 项目中处理配置的最佳方式

> ID：16041623
> 
> 赞同：7
> 
> 时间：2013-04-16T15:55:39.400
> 
> 标签：c++

为了启动我的 C++ 程序，我需要读取一些配置，例如 IP 地址、端口号、文件路径……这些设置可能会经常更改（每周或每天！），因此将它们硬编码到源文件中并不是一件容易的事好主意。

经过一些研究，我很困惑是否存在从文件加载配置设置并使这些配置可用于同一项目中的其他类/模块/*.cpp 的最佳实践。

静电*不好*；单例*不好*（*反模式*？）那么，我们还有哪些其他选择？或者，也许“配置文件”的想法是错误的？

编辑：我没有*加载*配置文件的问题。我担心，在将所有这些设置加载到内存中的 std::map< string, string > 之后，如何让其他类、函数访问这些设置。

编辑2：感谢大家的意见。我知道我在这里列出的这些模式是*FINE*，并且它们被许多程序使用。我很好奇是否有（某种）*最佳*模式来处理程序的配置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T16:03:23.530

可以说，配置文件是 Singleton 的合法用途。单例模式通常不受欢迎，因为单例会在多线程环境中导致竞争条件问题，并且由于它们是全局可访问的，因此您会遇到与全局相同的问题。但是，如果您的 Singleton 对象在您读取配置文件时被初始化一次，并且此后从未更改过，那么除了某种货物崇拜心态之外，我想不出有正当理由将其称为“反模式”。

话虽如此，当我需要将配置文件作为对象提供给我的应用程序时，我不使用单例。通常我将配置对象传递给那些需要它的对象/函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T16:11:05.037

我知道解决这个问题的最佳模式是通过一个选项类，它在创建/配置时被注入到你的代码中。

脚步：

1.  创建一个选项解析器类
2.  配置解析器应该接受哪些参数和选项，以及它们的默认值（默认值可以是您的“最可能的”默认值）
3.  编写客户端代码以接受选项作为参数（而不是单例和/或静态的东西）。
4.  创建对象时注入选项。

查看[boost.program_options](http://www.boost.org/doc/libs/1_53_0/doc/html/program_options.html)以获得已经成熟的程序选项模块。如果您熟悉 python，请查看[argparse 文档中的示例](http://docs.python.org/3.4/library/argparse.html)（相同的概念，在 python 库中实现）。他们很容易从中获得概念和交互。

# xcode - 如何将文件置于源代码控制之下？

> ID：16041624
> 
> 赞同：0
> 
> 时间：2013-04-16T15:55:47.197
> 
> 标签：xcode, git, version-control

我知道这是一件简单的事情，但我在 Xcode 中找不到它的控件！

我想做一个 Commit to Github，但它不会让我因为我的文件都不受源代码控制。

如何将我的项目文件置于源代码控制之下？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T19:53:14.320

您可以在管理器 -> 存储库中进行设置。本教程可能对您有所帮助：[http ://www.raywenderlich.com/13771/how-to-use-git-source-control-with-xcode-in-ios-6](http://www.raywenderlich.com/13771/how-to-use-git-source-control-with-xcode-in-ios-6)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-26T11:13:48.160

要首先将项目导入源代码管理，您必须打开终端并进入项目目录并键入：

$ 混帐初始化

$ 混帐 ./*

$ git commit -m "初始提交"

然后在 Xcode 中打开项目并使用“shift cmd 2”访问管理器并在那里找到存储库控件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T03:34:24.983

I recommend you to use "github mac client"([http://mac.github.com/](http://mac.github.com/)) which helps you import your project using GUI. It's very easy.

This article might be helpful : [http://www.hacheka.com/newbie-guide-for-using-github-in-mac-osx/](http://www.hacheka.com/newbie-guide-for-using-github-in-mac-osx/)

# blackberry - 如何通过代码启动黑莓应用程序？

> ID：16041626
> 
> 赞同：2
> 
> 时间：2013-04-16T15:55:50.563
> 
> 标签：blackberry, java-me, push-notification, blackberry-jde

我有一个后台功能监听推送消息。我需要处理推力。我创建了在推送到达时执行任何操作的函数，它运行良好。例如，当推送到达时，我增加一个数字等。

但是，当用户按下 ok 进行推送时，实际使应用程序启动的代码是什么？

我只需要让应用程序正常启动，就像用户刚刚按下应用程序的图标一样。

```
I am using OS < 7.X 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T05:06:54.053

一种典型的模式是构建一个有两个*入口点*的应用程序。也就是说，它可以以两种不同的方式启动。一种方式，将是正常的`UiApplication`。这是可以通过按下主屏幕图标启动的标准 BlackBerry 应用程序。

另一种方法是定义一个后台服务，处理推送通知，并在设备启动时由操作系统启动。

您将通过在应用程序的 BlackBerry_App_Descriptor.xml 文件中添加**备用入口点来定义后台/推送入口点。**确保选中**Auto-run at Startup**和**Do not display the application icon ...**。除了 UiApplication 的正常入口点之外，您的应用程序描述符 xml 文件应包含以下内容：

```
 <AlternateEntryPoints>
    <AlternateEntryPoint Title="PushService" MainMIDletName="" 
                         ArgumentsForMain="-push" HomeScreenPosition="0"
                         StartupTier="7" IsSystemModule="true" 
                         IsAutostartup="true" hasTitleResource="false" 
                         TitleResourceBundleKey="" TitleResourceBundleName="" 
                         TitleResourceBundleClassName="" TitleResourceBundleRelativePath="">
      <Icons/>
      <KeywordResources KeywordResourceBundleName="" KeywordResourceBundleRelativePath="" KeywordResourceBundleClassName="" KeywordResourceBundleKey=""/>
    </AlternateEntryPoint>
  </AlternateEntryPoints> 
```

然后，您将拥有一个像这样的主程序：

```
public class MyApp extends UiApplication

    public static void main(String[] args) {
       if (args.length > 0 && args[0].equals("-push")) {
          // this is the push service
          PushAgent pa = new PushAgent();
          pa.enterEventDispatcher();
       } else {
          // UiApplication
          MyApp app = new MyApp();
          app.enterEventDispatcher();
       }
    }
} 
```

哪里`PushAgent`有课那个`extends Application`，没有`UiApplication`。

然后，当您的推送代理收到通知并且您决定要显示 UI 时，请使用以下内容：

```
ApplicationDescriptor ad = ApplicationDescriptor.currentApplicationDescriptor();
// String[] used for command line args, but we don't pass any to the UI app
ApplicationDescriptor ui = new ApplicationDescriptor(ad, new String[] { });
ApplicationManager.getApplicationManager().runApplication(ui); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T04:30:37.517

试试这个 - 当您单击确定按钮时，使用以下代码运行您的 ui 应用程序。

```
public void dialogClosed(Dialog dialog, int choice) {
      switch (choice) {
          case Dialog.OK: 
              try {

                  ApplicationDescriptor[] appDescriptors =CodeModuleManager.getApplicationDescriptors(CodeModuleManager.getModuleHandle("BlackBerryCity"));    //here BlackBerryCity is the COD module Name
                  ApplicationDescriptor appDescriptor = new ApplicationDescriptor(appDescriptors[0], new String[] {"BlackBerryCity"});
                  ApplicationManager.getApplicationManager().runApplication(appDescriptor);

                } catch (Exception e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

              break;
          case Dialog.CANCEL:

              break;
          default:
              break;
       }
   } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T06:26:11.490

为了完整起见，这里是您可以用来启动应用程序的所有选项：

我假设您已经有多个入口点 - 一个用于后台侦听器，一个用于 UI 应用程序。还假设您没有为 UI 应用程序传递任何应用程序参数。（有关如何执行此操作的完整说明，请参阅 Nate 的回答。）

1.  使用`runApplication()`方法：

    ```
    ApplicationDescriptor ad = ApplicationDescriptor.currentApplicationDescriptor();
    // String[] used for command line args, but we don't pass any to the UI app
    ApplicationDescriptor ui = new ApplicationDescriptor(ad, new String[] { });
    //Launch the application and ask it to come in foreground
    ApplicationManager.getApplicationManager().runApplication(ui, true); 
    ```

2.  使用`launch()`方法：

    ```
    String modulename = "mymodule";
    ApplicationManager.launch(modulename); 
    ```

3.  使用`launchApplication()`方法：

    ```
    String modulename = "mymodule";
    ApplicationManager.launchApplication(modulename); 
    ```

需要注意的一点是，如果您的 UI 应用程序已经打开，那么所有这些方法都会简单地将其带到前台，无论它处于何种状态。如果您需要单击按钮来打开应用程序的新实例，则必须将一些随机参数作为应用程序参数传递，然后在 main 方法中将其忽略。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-16T16:05:46.603

```
class EntryPointForApplication extends UiApplication {

    private static EntryPointForApplication theApp;

    public EntryPointForApplication() { 
        GUIApplication scr = new GUIApplication(); 
        pushScreen(scr);         
    } 

} 
```

另请阅读[如何在黑莓应用程序中设置备用入口点？](https://stackoverflow.com/questions/3921029/how-to-setup-alternate-entry-point-in-blackberry-application)

# guid - How to generate a document ID or Report ID of 8 characters in .net

> ID：16041628
> 
> 赞同：0
> 
> 时间：2013-04-16T15:55:54.637
> 
> 标签：guid, hashcode, hash-code-uniqueness

Can someone point me to the preferred method for generating a report or document ID? I have been looking at maybe using a guid that would be reduced down to a shorter length. We have an application that creates an ID for reports that is about 8 characters long. They appear to be using some type of hash code. Probably using a base 36 encoding scheme. But I cant seem to find a way to make the hash code come out to a length of 8 characters since people have to use them to refer to the documents. They would also be used in a disconnected environment, so you couldnt look up the next usable serialized number in the chain. Just wondering what some of you use in applications like this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:58:50.300

The .net Framwork provides RNGCryptoServiceProvider class which Implements a cryptographic Random Number Generator (RNG) using the implementation provided by the cryptographic service provider (CSP). This class is usually used to generate random numbers. Although I can use this class to generate unique number in some sense but it is also not collision less. Moreover while generating key we can make key more complicated by making it as alpha numeric rather than numeric only. So, I used this class along with some character masking to generate unique key of fixed length.

```
private string GetUniqueKey()
 {
 int maxSize  = 8 ;
 int minSize = 5 ;
 char[] chars = new char[62];
  string a;
  a = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";
 chars = a.ToCharArray();
 int size  = maxSize ;
  byte[] data = new byte[1];
 RNGCryptoServiceProvider  crypto = new RNGCryptoServiceProvider();
 crypto.GetNonZeroBytes(data) ;
 size =  maxSize ;
 data = new byte[size];
 crypto.GetNonZeroBytes(data);
 StringBuilder result = new StringBuilder(size) ;
 foreach(byte b in data )
 { result.Append(chars[__b % (chars.Length - )>); }
  <span class="code-keyword">return result.ToString();
  } 
```

[http://www.codeproject.com/Articles/14403/Generating-Unique-Keys-in-Net](http://www.codeproject.com/Articles/14403/Generating-Unique-Keys-in-Net)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T16:56:29.967

This is what I ended up using. It is a base36 encoding. I borrowed parts of the code from other people, so I cant claim that I wrote it all, but I hope this helps others. This will produce about a 12 digit record ID, or unique ID for databases etc. It uses only the last 2 digits of the year, so it should be good for 100 years.

```
using System;
using System.Collections.Generic;
using System.Windows.Forms;

namespace Base36Converter
{
public partial class Form1 : Form
{ 
    private const string CharList = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";

    public Form1()
    {
        InitializeComponent();
    }

   //Base 36 number consists of only numbers and uppercase letters only.

    private void button1_Click(object sender, EventArgs e)
    {
        if (textBox2.Text.Length > 0)
        {
            label3.Text = "";
            //Get Date and Time Stamp
            string temp1 = GetTimestamp(DateTime.Now);
            //Turn it into a long number
            long l = Convert.ToInt64(temp1);
            //Now encode it as a base36 number.
            string s1 = Encode(l);

            //Get userID as a number, i.e. 1055 (User's index number) and create as a long type.
            long l1 = Convert.ToInt64(textBox2.Text);
            //Encode it as a base36 number.
            string s2 = Encode(l1);

            //Now display it as the encoded user number + datetime encoded number (Concatenated)
            textBox1.Text = s2 + s1;
        }
        else
        {
            label3.Text = "User Number must be greater than 0\. ie 1055";
        }
    }

    public static String Encode(long input)
    {
        if (input < 0) throw new ArgumentOutOfRangeException("input", input, "input cannot be negative");

        char[] clistarr = CharList.ToCharArray();
        var result = new Stack<char>();
        while (input != 0)
        {
            result.Push(clistarr[input % 36]);
            input /= 36;
        }
        return new string(result.ToArray());
    }

    public static String GetTimestamp(DateTime value)
    {
        return value.ToString("yyMMddHHmmssffff");
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        label3.Text = "";
    }

}
} 
```

# javascript - 无论格式如何，都匹配电话号码

> ID：16041630
> 
> 赞同：1
> 
> 时间：2013-04-16T15:55:56.147
> 
> 标签：javascript, regex, mongodb

我为 Mongo 编写了一个查询来搜索电话号码。问题是电话条目是 a`String`而不是 a `Number`。起初我认为它工作正常，但现在我意识到如果查询格式不正确，它将不匹配。

所以我想我的问题是无论格式如何，匹配电话号码的最简单方法是什么？

在最坏的情况下，我使用 $where 语句并通过从两个值中删除数字并对其进行正则表达式匹配来检查相等性。只是想知道是否有更优化的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:04:19.307

我首先将规范化的电话号码（例如，去除非数字字符或格式化为标准格式）存储在数据库中，因为它们尚未规范化，因此为每个搜索请求即时执行将是昂贵的，因此，如果您还没有太多条目（例如，如果这仍在开发中），那么一个脚本将一次性规范所有条目（或者如果您有生产系统，则在非偷窥时间分几批）将成为可能。

然后你的 where 子句只会规范化输入，然后搜索会容易得多。

顺便说一下，地址也是如此，您必须规范化数据以执行良好的搜索，或者您必须开发一些模糊匹配算法，这只会变慢。（并且可能比你想象的要花更多的时间）

# sharepoint-2010 - Sharepoint 2010 客户端模型。在分类字段中设置多个值

> ID：16041634
> 
> 赞同：2
> 
> 时间：2013-04-16T15:56:10.463
> 
> 标签：sharepoint-2010, taxonomy, sharepoint-clientobject, csom

如何使用客户端模型在分类字段中设置多个值？对于单个值，我使用以下代码段：

```
 var item = ctx
    .get_web()
    .get_lists()
    .getByTitle('News')
    .getItemById($("#newsId").val());

    var newTag = "40;#term_title|cd1df680-fff6-4d37-a336-95a2fbc0719d";

    item.set_item("NewsTag", newTag);
    item.update();

    ctx.executeQueryAsync(function () {
    }); 
```

它适用于单个值。

我尝试将 newTag 变量用作数组并尝试使用分隔符连接两个字符串`{id};#{title}|{guid}`，`;`但它不起作用。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T13:24:35.693

我找到了设置多个值的正确方法。实际上，分隔符是分号和锐利“;#”的组合，而不仅仅是分号“;”

# c - OpenCV 2.4.4 和 GPU 支持人脸检测

> ID：16041635
> 
> 赞同：-1
> 
> 时间：2013-04-16T15:56:19.097
> 
> 标签：c, opencv, cuda, gpu, face-detection

我正在使用 GPU 进行更快的人脸检测。我在[这里](http://barkingbogart.wordpress.com/2012/07/01/face-detection-with-opencv-gpu-version/)找到了一个可以接受的教程。我正在使用 VC10 编译器和 CUDA 4.2。设备安装良好，并且 devicequery 通过了测试。我还在 CUDA 中编写了程序，这让我别无选择，只能说 OpenCV 的 GPU 存在问题。当我尝试获取 CascadeClassifier_GPU 的实例时，真正的问题是访问冲突。此外，getCudaEnabledDeviceCount 返回零。我已经编译了带有 CUDA 标志的 OpenCV，并且在编译过程中没有严重问题，只有一个 python 接口失败，这与 GPU 完全无关。有没有人真正成功地在带有 OpenCV 的 GPU 上运行具有 haar 特征的人脸检测代码？你能告诉我我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:25:16.433

问题出在 OpenCV CMake 上。假定输出目录是 /build 目录，但是一旦你检查它，你会发现 /build 中的所有文件都是旧的。您应该从 /bin 和 /lib 收集新的 dll 和 lib 文件。我认为这是一个主要缺陷，因为许多人会使用旧文件并认为他们的编译不成功。另请注意，构建项目后，SDK 和 Toolkit 的 CUDA 版本必须为 4.2.9。现在 GPU 模块对我来说工作得很好。

# vim - 将 python 文档字符串突出显示为注释（vim 语法突出显示）

> ID：16041638
> 
> 赞同：17
> 
> 时间：2013-04-16T15:56:24.187
> 
> 标签：vim, python-2.7, vim-syntax-highlighting

是否可以修改[python.vim](http://www.vim.org/scripts/script.php?script_id=790)（和相应的颜色方案文件），以便在 vim 下的 python 语法突出显示期间，将在 class 和 def 语句（又名 docstrings）下的三引号字符串突出显示为注释？

```
class URLopener:
  """Class to open URLs.
  This is a class rather than just a subroutine because we may need
  more than one set of global protocol-specific options.
  Note -- this is a base class for those who don't want the
  automatic handling of errors type 302 (relocated) and 401
  (authorization needed)."""

def addheader(self, *args):
  """Add a header to be used by the HTTP interface only
  e.g. u.addheader('Accept', 'sound/basic')"""

# sample comment 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-16T17:13:13.010

您可以添加以下行：

```
syn region Comment start=/"""/ end=/"""/ 
```

到你的 ~/.vim/after/syntax/python.vim。如果该文件不存在，您可以创建它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-17T03:43:08.293

以下对我有用：

```
syn region pythonDocstring  start=+^\s*[uU]\?[rR]\?"""+ end=+"""+ keepend excludenl contains=pythonEscape,@Spell,pythonDoctest,pythonDocTest2,pythonSpaceError
syn region pythonDocstring  start=+^\s*[uU]\?[rR]\?'''+ end=+'''+ keepend excludenl contains=pythonEscape,@Spell,pythonDoctest,pythonDocTest2,pythonSpaceError 
```

[取自修改后的](http://concisionandconcinnity.blogspot.com/2009/07/vim-part-i-improved-python-syntax.html)python.vim 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-24T14:03:29.140

PEP 257 规定对文档字符串使用 """三双引号"""。在文档字符串中包含“三单引号”或“单双引号”不是强制性的。有一个困难是我们有类文档字符串、函数文档字符串、模块文档字符串、属性文档字符串和其他文档字符串。这就是为什么我决定更容易考虑 docstring 如下：

```
syn region pythonDocString start=+^\s*"""+ end=+"""+ keepend contains=... 
```

接着：

```
HiLink pythonDocString        Comment 
```

您可能会在此脚本中看到示例（搜索 pythonDocString）：[https ://github.com/andbar-ru/python-syntax/blob/master/syntax/python.vim](https://github.com/andbar-ru/python-syntax/blob/master/syntax/python.vim)

# asp.net - 以客户端 HTML 呈现的 ASP.NET 服务器标记，而不是值？

> ID：16041639
> 
> 赞同：0
> 
> 时间：2013-04-16T15:56:28.837
> 
> 标签：asp.net, html, controls, server-tags

也许我已经忘记了如何使用这些，但我正在疯狂地尝试将服务器端值注入 HTML 输出。我这样做是有原因的，而不是在服务器端，所以请不要建议将其作为解决方案。

服务器端的这段代码：

```
<asp:Label ID="Label1" runat="server" Text='<%= DateTime.Now.ToString() %>' />; 
```

在发送到浏览器的客户端 HTML 中呈现如下：

```
<span id="Label1"> <%= DateTime.Now.ToString()></span>; 
```

它显示为大胖空白，界面没有任何输出。

如果我将 ASP 源代码更改为使用“#”字符定义为数据绑定语法，则呈现到浏览器的输出变为：

```
<span id="Label1"></span> 
```

## 编辑：

为了提出问题，设置标签文本只是一个简化的对象。在现实生活中，我正在设置 CssClass 属性，这不允许我使用一些建议的“包装”解决方法。我想设置一个公共属性，并在页面加载时动态更新所有控件。

理想情况下，因为我已经在 aspx 页面上布置了所有控件。只是想添加一个属性。我想拥有：

```
<asp:textbox ID='MyTxtBox1' CssClass='<% strVal1 %>' />  
<asp:textbox ID='MyTxtBox2' CssClass='<% strVal1 %>' />  
<asp:textbox ID='MyTxtBox3' CssClass='<% strOtherVal %>' />  
<asp:textbox ID='MyTxtBox4' CssClass='<% strVal1 %>' /> 
```

现在看起来我需要做的是在代码块中重复我对代码隐藏的所有（250+）控件，如下所示：

```
MyTxtBox1.CssClass=strVal1  
MyTxtBox2.CssClass=strVal1  
MyTxtBox4.CssClass=strVal1  

MyTxtBox3.CssClass=strOtherVal 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:48:04.730

我相信这可能不适用于已编译的 Web 应用程序，因为它不像 C#“网站”那样在运行时被解释。但是，我能够让它围绕值包装标签：

```
<asp:Label runat="server"><%= DateTime.Now.ToString() %></asp:Label> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:22:43.430

设置 Label1.Text = 值，而不是尝试在服务器控件内使用服务器端属性

# c# - 设置自定义保存对话框属性

> ID：16041642
> 
> 赞同：6
> 
> 时间：2013-04-16T15:56:32.433
> 
> 标签：c#, winforms

目前我正在查看[SaveFileDialog](http://msdn.microsoft.com/en-us/library/system.windows.forms.savefiledialog.aspx)但我看不到任何允许用户设置自定义属性的方法。有谁知道我如何同时提示用户输入自定义属性。

下面的屏幕截图来自 Excel 2010，正在做我想要完成的事情。

![自定义窗口属性](https://i.stack.imgur.com/wVR7o.png)

关于我如何完成同样的事情有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:12:51.850

如果不“扩展”`SaveFileDialog`或创建自己的表单，我认为您无法做到这一点。

我发现了一些您可能会觉得有趣的链接：

> [将控件添加到 SaveFileDialog](http://www.codeproject.com/Articles/8086/Extending-the-save-file-dialog-class-in-NET)
> 
> [扩展 OpenFileDialog 和 SaveFileDialog](http://www.codeproject.com/Articles/19566/Extend-OpenFileDialog-and-SaveFileDialog-the-easy)

不过，它们确实看起来很“hackish”。

如果您决定卷起自己的表单，这里有一些用户控件可能会对您有所帮助，但如果您真的不得不“重新发明”轮子，那就太可惜了。

> [探索者树](http://www.codeproject.com/Articles/14570/A-Windows-Explorer-in-a-user-control)
> 
> [文件浏览器](http://www.codeproject.com/Articles/15059/C-File-Browser)

祝你好运。

# iframe - 从 iframe 中删除滚动条

> ID：16041643
> 
> 赞同：6
> 
> 时间：2013-04-16T15:56:33.240
> 
> 标签：iframe, google-docs

我有一个来自谷歌文档的表格，我嵌入到我的网站中，我希望我指导的学生填写，但滚动条让我很烦。有什么办法摆脱它？

```
<iframe src="https://docs.google.com/forms/d/1kMdmk_f4jrAWwZi6q3YD63oUQAg2hvdheAQ-pY_2FRY/viewform?embedded=true" width="760" height="500" frameborder="0" marginheight="0" marginwidth="0">Loading...</iframe> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-11-01T10:28:03.253

使用滚动=“否”

```
 <iframe src="https://docs.google.com/forms/d/1kMdmk_f4jrAWwZi6q3YD63oUQAg2hvdheAQ-pY_2FRY/viewform?embedded=true" width="760" **scrolling="no"** height="500" frameborder="0" marginheight="0" marginwidth="0">Loading...</iframe> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-09-23T00:35:36.097

我不确定是单滚动条还是双滚动条让您烦恼...根据您嵌入的表单，某些部分可能比其他部分大，他们需要滚动才能继续表单.

我在这里很菜鸟，但使用他们的 html 嵌入工具为 wix 网站修复了一个令人讨厌的双滚动条问题......

采用谷歌表单嵌入代码，我在开头添加了“样式”表，并将高度和宽度更改为“100%”，请参见此处：

```
<style type="text/css">
body {margin:0; overflow: hidden;}
iframe {border: none;}
</style>
<iframe src="YOUR SOURCE" width="100%" height="100%" frameborder="0" marginheight="0" marginwidth="0"></iframe> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-05-17T16:33:13.503

我发现如果您将表单的高度更改为 2000，您的表单在没有滚动条的情况下适合您的网站

例如宽度=“650”高度=“2000”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T16:01:05.620

你可以试试css：`overflow-y: hidden;`

# android - 如何从 ActionBar Sherlock 中删除 HomeAsUpButton 箭头？

> ID：16041651
> 
> 赞同：9
> 
> 时间：2013-04-16T15:56:46.477
> 
> 标签：android, android-actionbar, xamarin.android

我想从 HomeAsUpButton 的箭头图像中删除。

我尝试从布局中删除箭头的 ImageView （没有任何反应），还尝试使用`SupportActionBar.SetDisplayHomeAsUpEnabled(false);`完全删除按钮功能。

我正在使用[johnkil 的 SideNavigation](https://github.com/johnkil/SideNavigation)代码。有什么建议么？

以 YouTube 的 App 为例：

![在此处输入图像描述](https://i.stack.imgur.com/q4sxA.png)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-16T16:16:06.093

使用 ActionBar Sherlock，在 Activity 的`onCreate`方法中，您只需执行以下操作：

```
getSupportActionBar().setDisplayHomeAsUpEnabled(false); 
```

如果向上图像没有消失，则可能与您引用的库有关。在我的应用程序中，我使用了 SlidingMenu 库，它工作得很好（来源：[https](https://github.com/jfeinstein10/SlidingMenu) ://github.com/jfeinstein10/SlidingMenu ）

编辑：使用 SlidingMenu 库，活动将如下所示：

```
public class MainAct extends SlidingFragmentActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        // Sliding menu

        // Here I set the menu's layout
        setBehindContentView(R.layout.menu_frame);
        FragmentTransaction t = getSupportFragmentManager().beginTransaction();
        MenuListFrag frag = MenuListFrag.newInstance(getSlidingMenuItems());
        t.replace(R.id.menu_frame, frag);
        t.commit();

        // Customizing the SlidingMenu
        SlidingMenu sm = getSlidingMenu();
        sm.setShadowWidthRes(R.dimen.shadow_width);
        sm.setShadowDrawable(R.drawable.shadow);
        sm.setFadeDegree(0.35f);

        // Hiding the ActionBar's up button
        getSupportActionBar().setDisplayHomeAsUpEnabled(false);
        getSupportActionBar().setHomeButtonEnabled(true);

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-13T22:43:59.600

我可以通过设置透明图像来隐藏“箭头”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:01:32.683

您可以使用此方法禁用操作栏

```
actionBar.setHomeButtonEnabled(false); 
```

# java - 防止监听器触发自身

> ID：16041656
> 
> 赞同：1
> 
> 时间：2013-04-16T15:56:56.277
> 
> 标签：java, swt, listener

我今天的问题涉及 JFace 中的一个简单争用`TreeViewer` `Composite`。我正在尝试将 a 附加`ControlListener`到我的树的列以强制执行最小宽度。为此，我每次调整列大小时都会观察，如果新宽度太小，我会对其施加最小值。

这是一个 GUI 问题，但实际上它可能在任何带有修改侦听器的 Java 环境中发生。我想也许你们中的一些 Java 极客可能会从中获得乐趣。

```
 public static void getSizeControlListener(final TreeColumn column, final int minSize) {
        column.addControlListener(new ControlListener() {
            @Override
            public void controlMoved(ControlEvent e) {}

            @Override
            public void controlResized(ControlEvent e) {
                if(column.getWidth()<minSize) {
                    column.setWidth(minSize);
                }
            }
    }); 
```

一种可行的解决方案是添加一个在入口处设置的标志，任何嵌套调用都可以引用并在必要时立即退出。它有效，但它又脏又丑。

```
 public static void getSizeControlListener(final TreeColumn column, final int minSize) {
        column.addControlListener(new ControlListener() {

            private boolean isRunning;

            @Override
            public void controlMoved(ControlEvent e) {}

            @Override
            public void controlResized(ControlEvent e) {
                if(isRunning)
                    return;
                isRunning = true;
                if(column.getWidth()<minSize) {
                    column.setWidth(minSize);
                }
                isRunning = false
            }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-02T11:43:43.817

**您使用标志的解决方案完全可以**，我们定期使用此模式来**防止通知级联**。
发生这种级联的一个示例是在 MVC 中同步模型视图状态时。使用这样的标志可以让我们实现双向同步的无级联单向更新。

与您的实现的唯一区别是我们用于`try..finally`确保始终重置标志（即使发生异常时）：

```
if (updating) {
    return;
}
try {
   updating=true;

   // do stuff

} finally {
   updating=false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:12:43.827

我认为您应该将以下代码放入`org.eclipse.swt.widgets.Display.asyncExec(Runnable)`

```
column.setWidth(minSize); 
```

# c# - 在 C# 中加密并使用 Apex 解密

> ID：16041658
> 
> 赞同：0
> 
> 时间：2013-04-16T15:57:08.043
> 
> 标签：c#, .net, salesforce, apex-code

我想将查询字符串中的一个字段从 asp .net 传递到 Apex 。我想加密字段的值，然后在查询字符串中传递它。我不知道如何解决这个问题，是否有相同的示例代码/链接？基本上我想在 C# 中加密并使用 Apex 解密。

在 C# 中

```
 static string key = "eU5WzoFgU4n8Apu5PYxcNGRZswRDZJWDEMdbQVU85gw=";
 static string IV = "9ehY9gYtfIGlLRgwqg6F2g==";
    static void Main(string[] args) 
    {
        string source = "test";
        string encrypted = EncryptStringToBytes_Aes(source, Convert.FromBase64String(key), Convert.FromBase64String(IV));

        Console.ReadLine();
    }
static string EncryptStringToBytes_Aes(string plainText, byte[] Key, byte[] IV)
    {
        // Check arguments. 
        if (plainText == null || plainText.Length <= 0)
            throw new ArgumentNullException("plainText");
        if (Key == null || Key.Length <= 0)
            throw new ArgumentNullException("Key");
        if (IV == null || IV.Length <= 0)
            throw new ArgumentNullException("Key");
        string encrypted;
        // Create an AesManaged object 
        // with the specified key and IV. 
        using (AesManaged aesAlg = new AesManaged())
        {
            aesAlg.Key = Key;
            aesAlg.IV = IV;

            // Create a decrytor to perform the stream transform.
            ICryptoTransform encryptor = aesAlg.CreateEncryptor(aesAlg.Key, aesAlg.IV);

            // Create the streams used for encryption. 
            using (MemoryStream msEncrypt = new MemoryStream())
            {
                using (CryptoStream csEncrypt = new CryptoStream(msEncrypt, encryptor, CryptoStreamMode.Write))
                {
                    using (StreamWriter swEncrypt = new StreamWriter(csEncrypt))
                    {

                        //Write all data to the stream.
                        swEncrypt.Write(plainText);
                    }
                    encrypted = Convert.ToBase64String(msEncrypt.ToArray());// ToArray();
                }
            }
        }

        // Return the encrypted bytes from the memory stream. 
        return encrypted;

    } 
```

### 在顶点：

```
string cryptoKey='eU5WzoFgU4n8Apu5PYxcNGRZswRDZJWDEMdbQVU85gw=';
 String det= System.currentPageReference().getParameters().get('Det'); 
 Blob decryptedData = Crypto.decryptWithManagedIV('AES256', EncodingUtil.base64Decode(cryptoKey), EncodingUtil.base64Decode(det)); 
```

但这不起作用，decryptedData.toString() 不是“测试”（原文）。我如何解密回来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:30:10.943

Why? All communication with SF is done via SSL anyway ([https://salesforce.stackexchange.com/questions/8273/data-loader-cli-and-encryption](https://salesforce.stackexchange.com/questions/8273/data-loader-cli-and-encryption) for example).

If you absolutely have to - Apex has [Crypto](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_classes_restful_crypto.htm) class that supports several algorithms. Hopefully you'll find matching ones in C# libraries.

There's also [EncodingUtil](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_classes_restful_encodingUtil.htm) class if you need to pass some binary data (as base64 for example).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-21T20:48:16.847

创建上述示例的人非常接近。如果他们加密了比“Test”更长的字符串，他们可能会意识到这一点——他们只需要在他们正在加密的内容之前插入一些填充：

字符串 spadding = "paddingxxxxxxxxx"; 字符串来源 = spadding + "Opportunity0065";

-- 输出应该是“Opportunity0065”

# java - Java 6 中的遍历文件树

> ID：16041662
> 
> 赞同：1
> 
> 时间：2013-04-16T15:57:13.637
> 
> 标签：java, file, filesystems

我正在尝试找到一种方法来在 java 6 中的计算机目录中找到某个文件。更具体地说，我的程序通过在硬盘驱动器上定位 pymol.exe 并执行启动它的命令来启动程序 Pymol。通过使用 File Visitor 界面，我让它在 Java 7 中运行良好。但是，我正在尝试使其与 Java 6 兼容，因此我需要找到另一种方法来定位该程序（或确定用户没有安装它）。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:08:45.903

尝试

```
File findFile(String name, File dir) {
    for (File f : dir.listFiles()) {
        if (f.isFile() && f.getName().equals(name)) {
            return f;
        }
    }
    for (File f : dir.listFiles()) {
        if (f.isDirectory()) {
            return findFile(name, f);
        }
    }
    return null;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:01:54.977

只需在文件目录中进行递归树遍历，直到找到文件或遍历结束。

# mysql - MySQL 试图返回交错的结果

> ID：16041663
> 
> 赞同：2
> 
> 时间：2013-04-16T15:57:15.823
> 
> 标签：mysql, sql, database, search

例如，我有一个包含三个字段的表：

1.  标识（整数）
2.  名称（varchar）
3.  公司 (int)

假设我有以下数据（仅示例）

```
id ---    name          ---    company
---------------------------------------
1 ---    John Baker     ---      1
2 ---    Ann Johnson    ---      1
3 ---    John Wu        ---      1
4 ---    Mike Johns     ---      2
5 ---    John John      ---      2
6 ---    Johnny Boy     ---      2 
```

我想对名称进行搜索，并返回按公司交错的数据。因此，如果我在 上执行搜索`LIKE '%John%'`，我希望以按公司排序的方式返回数据，例如：1、2、1、2、1、2，同时保持与原始搜索词的返回顺序尽可能多的相关性可能的。

我不知道如何以这种交错的方式返回数据，我已经考虑了几个小时。如果有人可以请帮助我，我很想听听他们的想法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:53:02.660

`name`如果我们可以使用 SQL 标准函数对每个PARTITIONed BY使用 ROW_NUMBER，这将相当容易`company`。（ROW_NUMBER 给了我们一个“简单的排名”或简单的编号，没有平局也没有差距。）这基本上是@zebediah49 在他的评论中的提议。遗憾的是，MySQL 今天无法做到这一点。

[@GordonLindoff 的答案](https://stackoverflow.com/a/16041708/132382)使用自联接技术在 MySQL 中模拟了此功能。这是另一种方法。

首先，我们按公司对每个人进行分组，然后使用用户变量在全球范围内天真地对他们进行排名。所以，A公司的三个人变成了#1、#2和#3，B公司的两个人变成了#4和#5，以此类推：

```
company | name     == ROW_NUMBER()d after ==>  company | name    | rank
--------+--------  == GROUP BY `company`  ==>  --------+---------+------
    A   | Alice                                    A   | Alice   | 1
    B   | Bob                                      A   | Charlie | 2
    A   | Charlie                                  A   | Deborah | 3
    A   | Deborah                                  B   | Bob     | 4
    B   | Erwin                                    B   | Erwin   | 5 
```

在 MySQL 中模拟 ROW_NUMBER的*用户变量*技术很容易搜索，但这里有一个来自[另一个 SO 答案](https://stackoverflow.com/a/15986591/132382)的紧凑演示。

现在，如果我们根据公司内的人数对全球幼稚排名进行 MOD，我们将得到“分区排名”，即公司内的相对排名：

```
company | name     | rank | npeople | rank % npeople
--------+----------+------+---------+----------------
    A   | Alice    |  1   |  3      | 1
    A   | Charlie  |  2   |  3      | 2
    A   | Deborah  |  3   |  3      | 0
    B   | Bob      |  4   |  2      | 0
    B   | Erwin    |  5   |  2      | 1 
```

综上所述，加入查询以计算每家公司的人数，我们得到：

```
 SELECT id, name, ranked.company
    FROM (  SELECT tbl.id, tbl.name, tbl.company, (@rn := @rn + 1) AS rn
              FROM tbl
              JOIN (SELECT @rn := 0) vars
             WHERE tbl.name LIKE '%John%'
          ORDER BY company) ranked
    JOIN (SELECT company, COUNT(id) AS npeople FROM tbl GROUP BY company) companies
         ON ranked.company = companies.company
ORDER BY rn MOD companies.npeople, company 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T15:59:36.397

如果你想按公司排序：

```
select *
from t
where . . .
order by company, id; 
```

如果你想让它交错，那么公司内的柜台会有所帮助。这是一种方法：

```
select t.*
from (select *,
             (select count(*) from t t2 where <where clause on t2 here> and t2.comapny = t.company and t2.id < t.id) as seqnum
      from t
      where . . .
    ) t
order by seqnum, company 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:43:52.940

一种可能的解决方案：

```
select *
from yourTable
where ...
order by ((company*1000) + id); 
```

根据需要添加尽可能多的零。至少，您需要与此数字一样多的零：

```
select pow(10,length(max(company))) from yourTable; 
```

如果您在此查询中提取大量记录，排序可能会很慢，因此我建议您使用最佳`where`条件。

不是最优雅的解决方案，但它可能会起作用。

# mysql - MySQL 事务和并发插入

> ID：16041664
> 
> 赞同：0
> 
> 时间：2013-04-16T15:57:16.243
> 
> 标签：mysql, concurrency, insert, transactions, isolation

我得到了某人制作的这个脚本，我查看了它，发现了一些我不确定是否安全的东西：

在事务内部有 2 个连续插入，在 2 个不同的表中，都具有自动递增的主键。它们应该是相同的（第一次插入生成的主键 = 第二次插入生成的主键）。

别问我为什么，剧本就是这么写的。

我是交易新手，我不太清楚这里是否存在并发问题。我正在考虑另一个线程同时运行并最终生成密钥的可能性，例如：

```
Thread #1:    Table_A ID: 3                                        Table_B ID: 4
Thread #2:                      Table_A ID: 4     Table_B ID: 3 
```

我很确定（我今天才第一次准备好与交易相关的文档）交易不会防止这种情况发生，但我只是想确保我做对了。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T13:31:32.570

您需要将两个连接都置于可序列化事务隔离级别，以避免您描述的场景，或者通过`tx_isolation`在每个连接上设置：

```
SET @@tx_isolation = SERIALIZABLE; 
```

或者

```
SET SESSION TRANSACTION ISOLATION LEVEL SERIALIZABLE; 
```

或者通过设置全局隔离级别：

```
SET @@global.tx_isolation = SERIALIZABLE; 
```

或者

```
SET GLOBAL TRANSACTION ISOLATION LEVEL SERIALIZABLE; 
```

它由任何随后打开的连接继承。在那个级别，如果另一个事务已经在进行中，事务将阻塞任何查询，即。事务已经在同一个表上发出查询（读或写）。

有关详细信息，请参阅[mysql 文档](http://dev.mysql.com/doc/refman/5.0/en/innodb-transaction-isolation.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:05:38.467

您的情况绝对是可能的。

如果两个表中的主键应该相同，您可以覆盖`AUTO_INCREMENT`第二个表中的主键并显式插入值：

```
INSERT
INTO    a (id)
VALUES  (NULL) -- this inserts an auto incremented value

INSERT
INTO    b (id)
SELECT  LAST_INSERT_ID() -- this inserts the last value inserted into a in this session 
```

# android - 根据选择的产品设置提醒日期

> ID：16041665
> 
> 赞同：0
> 
> 时间：2013-04-16T15:57:18.010
> 
> 标签：android

我设置了一个 Date_Picker ，允许用户选择哪个日期和时间来设置提醒，但我需要设置他们选择订购哪种药物的位置，并将重新订购提醒设置为未来 x 天. 如果他们订购药物“A”，他们将在 5 天内收到提醒。如果他们在 10 天内订购药物“B”提醒。药物“C”15天。我假设我需要删除对 Date_Picker 的引用？并让我的代码 mCalendar.set(Calendar.Year, year) 以某种方式使用 year 作为字符串？我现在很迷茫！这是我的代码。谢谢你。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    mDbHelper = new RemindersDbAdapter(this);

    setContentView(R.layout.reminder_edit);

    mCalendar = Calendar.getInstance(); 
    mTitleText = (EditText) findViewById(R.id.title);
    mBodyText = (EditText) findViewById(R.id.body);
    mDateButton = (Button) findViewById(R.id.reminder_date);
    mTimeButton = (Button) findViewById(R.id.reminder_time);

    mConfirmButton = (Button) findViewById(R.id.confirm);

    mRowId = savedInstanceState != null ?savedInstanceState.getLongRemindersDbAdapter.KEY_ROWID) 
                                        : null;

    registerButtonListenersAndSetDefaultText();
}

private void setRowIdFromIntent() {
    if (mRowId == null) {
        Bundle extras = getIntent().getExtras();            
        mRowId = extras != null ? extras.getLong(RemindersDbAdapter.KEY_ROWID) 
                                : null;

    }
}

@Override
protected Dialog onCreateDialog(int id) {
    switch(id) {
        case DATE_PICKER_DIALOG: 
            return showDatePicker();
        case TIME_PICKER_DIALOG: 
            return showTimePicker(); 
    }
    return super.onCreateDialog(id);
}

private DatePickerDialog showDatePicker() {

    DatePickerDialog datePicker = new DatePickerDialog
(ReminderEditActivity.this,new DatePickerDialog.OnDateSetListener() {

@Override
public void onDateSet(DatePicker view, int year, int monthOfYear, int dayOfMonth) {
            mCalendar.set(Calendar.YEAR, year);
            mCalendar.set(Calendar.MONTH, monthOfYear);
            mCalendar.set(Calendar.DAY_OF_MONTH, dayOfMonth);
            updateDateButtonText(); 
        }
   }, mCalendar.get(Calendar.YEAR), mCalendar.get(Calendar.MONTH),mCalendar.getCalendar.DAY_OF_MONTH)); 
    return datePicker; 
}

private void registerButtonListenersAndSetDefaultText() {

    mDateButton.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            showDialog(DATE_PICKER_DIALOG);  
        }
    }); 

    mConfirmButton.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {
            saveState(); 
            setResult(RESULT_OK);
            Toast.makeText(ReminderEditActivity.this, getString(R.string.task_saved_message), Toast.LENGTH_SHORT).show();
            finish(); 
        }

    });

      updateDateButtonText(); 
      updateTimeButtonText();
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:39:42.773

删除日期和时间选择器，而是使用微调器来选择药物。

使用微调器的 getSelectedItem() 获取所选药物。根据选择的药物找出提醒间隔。最后，使用 Calendar.add() 将间隔添加到当前日期并获取提醒日期。

# git - 允许设计师上传图片 - 限制通过 ssh 或 git 用户或 gitignore 访问？

> ID：16041670
> 
> 赞同：0
> 
> 时间：2013-04-16T15:57:41.870
> 
> 标签：git, ssh, gitignore

事情是这样的：

我们正在开发，我们推动和承诺等。

我们的设计师刚刚完成了一个图像编辑，这对工作流程来说会很好，让设计师自己放置他们的图像。

所有应用程序图像都在一个地方。

我不介意设置设计师的计算机以便他们执行“git push”，但是如果他们只在那个特定的图像文件夹上这样做，我会觉得更安全。

也许是一个 gitignore 声明忽略除图像文件夹内容之外的所有内容？或者更清楚地说，我们可以以某种方式设置一个 git 用户？或者这应该是对该用户进行 ssh 访问的工作吗？

**像有人做过这样的事吗？如果是这样，我们有什么选择？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:07:49.603

Git 本身并不真正支持基于文件夹的访问控制。

执行此操作的首选方法是禁止他们推送到您的主分支，并让他们推送到“私有”分支，然后您从该分支将提交合并/重新定位到您的主/开发分支。

如果这不是一个选项，您很可能会使用 Git 挂钩来拒绝推送，以防它修改图像文件夹之外的任何内容。由于钩子需要在远程端运行才能有效，因此您需要使用`pre-receive`或`update`钩子。有关这些钩子的更多信息，请参阅[Git 文档](http://git-scm.com/book/en/Customizing-Git-Git-Hooks#Server-Side-Hooks)。

# vba - 是否可以在 VBA 中编写名称中包含句点的 UDF？

> ID：16041671
> 
> 赞同：4
> 
> 时间：2013-04-16T15:57:41.963
> 
> 标签：vba, excel, user-defined-functions

Excel 2010 附带了一些名称中包含句点的函数。例如`STDEV.S`和`PERCENTILE.EXC`

是否可以为我自己的函数指定一个名称，例如`PERCENTILE.CUSTOM`使用 VBA？

例如，我想使用公式引用以下函数`=NAME.SUFFIX()`

```
Option Explicit

Function NAMEdotSUFFIX() As Variant

    NAMEdotSUFFIX = 42

End Function 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-01-26T23:43:42.850

正如@SiddharthRout 已经建议的那样，在声明函数名称时，外部库的限制比 VBA 少，因此外部名称中允许使用句点。

尽管有 MSDN 文档，但*可以*在 VBA 标识符中使用*一些*特殊字符，包括 UDF。特殊字符甚至可以是标识符中的*第一个/唯一*字符。根据 VBA 项目和 VBE 的代码页，特殊字符的可用性会有所不同。

这是一个完全有效的 VBA 函数：

```
Public Function Foo·Bar()
  Foo·Bar = 5
End Function 
```

并且可以在 Excel 公式中使用：

```
=Foo·Bar()
5 
```

同样，这个函数的*gem*使用不间断空格作为*函数*名：

```
Public Function  ()
    = 6
End Function 
```

但是，虽然带有 NBSP 的函数是有效的，但遗憾的是，它不能在 Excel 公式中使用。

可以使用：

```
Public Function ·()
  · = 5
End Function 
```

**奖金黑客**

有人忘记告诉`Enum`团队标识符规则。虽然枚举不能在 Excel 公式中使用，但您可以使用除回车或方括号*内*的方括号之外的任何字符作为枚举名称或成员。

这是完全有效的 VBA：

```
Enum [Foo : Bar = 5 : End Enum]
  [.B!a r"] = 6
End Enum 
```

VBE 漂亮的打印机把它变成了这个无法解析的混乱：

```
Enum Foo : Bar = 5 : End Enum
  [.B!a r"] = 6
End Enum 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:12:36.290

从 VBA 是不可能的。[这篇 MSDN 文章](http://msdn.microsoft.com/en-gb/library/sect4ck6.aspx)展示了如何在 VBA 中定义函数，特别是[这篇文章](http://msdn.microsoft.com/en-gb/library/81ed9a62.aspx)列出了元素名称的规则。

# javascript - 使用 ember.js 可排序的 jquery-ui 时更新 ArrayController 模型中的属性

> ID：16041672
> 
> 赞同：2
> 
> 时间：2013-04-16T15:57:50.033
> 
> 标签：javascript, jquery-ui, ember.js

使用[http://www.lukemelia.com/blog/archives/2012/03/10/using-ember-js-with-jquery-ui/](http://www.lukemelia.com/blog/archives/2012/03/10/using-ember-js-with-jquery-ui/)我正在尝试在 Ember 加载的模板中实现可排序列表。 ArrayController 有一个电话号码数组作为内容：

```
{{#collection App.SortableListView contentBinding="phonenumbers" itemViewClass="App.SortableItem"}}
<b>{{phonenumber.cost}}</b>
{{/collection}} 
```

我正在尝试在排序后更新每个电话号码的“订单”属性，但我不知道该怎么做：

```
App.SortableListView = JQ.SortableListView.extend({
  items: 'article',

  //update is a jquery ui method called when the sort ends and dom has been updated
  update: function(event, ui) {
    // I would like to update  and persist each phonenumbers model here
  }
}); 
```

我尝试了各种方法：按顺序绑定Attr，通过jquery 的数据属性，使用每个childView 的contentIndex 属性（但排序时没有更新）......一切都失败了，或者对于这样一个简单的事情来说太复杂了。

我想我错过了一些明显的东西，谢谢你的帮助。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-17T07:15:32.667

数组控制器上有 sortProperty 方法可以执行您想要的操作

# javascript - 防止按下输入键时默认不起作用

> ID：16041673
> 
> 赞同：3
> 
> 时间：2013-04-16T15:57:51.877
> 
> 标签：javascript, jquery

我的 asp.net 控件如下所示；

```
<asp:Button ID="btnLogOut" runat="server" Text="Exit" ClientIDMode="Static" OnClick="btnLogOut_Click" /> 
```

和js事件；

```
 $("#btnLogOut").keyup(function (event) {
    if (event.which == 13 || event.keyCode == 13) {
        alert(event.keyCode);
        $("#btnLogOut").preventDefault();
        return false;
    }
    else return true;
}); 
```

在页面上，当我按下回车键时，它会触发 btnLogOut 按钮。为了防止这种情况，我在上面写了 js 事件。警报说 keyCode 是 13 但它并没有阻止点击功能，我注销了。

我怎样才能解决这个问题？这尤其发生在 IE 中

编辑：`event.preventDefault`也不工作。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-16T15:59:52.077

[`preventDefault()`](http://api.jquery.com/event.preventDefault/)是 Event 对象 ( `event`) 的一个方法，因此您需要在其上调用它：`event.preventDefault()`.

但是，`keyup`如果密钥**已经被处理**，那么阻止事件是没有意义的。`keydown`代替它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T15:58:55.177

你`keyup`不能取消，你*可以*在`keydown`。

并使用`event.preventDefault();`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-16T15:58:53.027

您应该使用`event.preventDefault();`而不是调用`preventDefault()`对象本身。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-16T15:59:19.993

[preventDefault](http://api.jquery.com/event.preventDefault/)与事件对象一起使用

```
$("#btnLogOut").keyup(function (event) {
    if (event.which === 13 || event.keyCode === 13) {
        alert(event.keyCode);
        event.preventDefault();
        return false;
    }
    else return true;
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-16T15:58:58.600

哟需要使用`event.preventDefault()`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-16T16:00:22.963

尝试更改`$("#btnLogOut").preventDefault();`为`event.preventDefault();`

# android - 无法使用通用图像加载器将图像显示到 Gridview 中？

> ID：16041676
> 
> 赞同：0
> 
> 时间：2013-04-16T15:57:53.920
> 
> 标签：android, gridview, universal-image-loader

我正在尝试使用以下代码从内部`sdcard`和`drawable`内部显示图像。`gridview`但它不起作用。`Galaxy Note`由于`Memory Error`显示错误的图像而崩溃，`emulator` 并且还需要大量时间来显示它们。

```
DisplayImageOptions options = new DisplayImageOptions.Builder()
.cacheInMemory().cacheOnDisc()
.bitmapConfig(Bitmap.Config.RGB_565).build(); 
```

**适配器类**

```
 public class GridAdapter extends BaseAdapter {

    public GridAdapter(Context ctx) {
        // TODO Auto-generated constructor stub

        imageLoader = ImageLoader.getInstance();
        imageLoader.init(ImageLoaderConfiguration.createDefault(ctx));
    }

    @Override
    public int getCount() {
        // TODO Auto-generated method stub
        return mImages.size();
    }

    @Override
    public Object getItem(int pos) {
        // TODO Auto-generated method stub
        return mImages.get(pos);
    }

    @Override
    public long getItemId(int arg0) {
        // TODO Auto-generated method stub
        return 0;
    }

    public class ViewHolder {

        ImageView image;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        // TODO Auto-generated method stub

        ViewHolder holder;

        if (convertView == null) {

            holder = new ViewHolder();

            convertView = getLayoutInflater().inflate(R.layout.grid_image,
                    parent, false);
            holder.image = (ImageView) convertView
                    .findViewById(R.id.gridImage);
            holder.image.setLayoutParams(new LinearLayout.LayoutParams(
                    width / 2, width / 2));
            convertView.setTag(holder);

        } else {

            holder = (ViewHolder) convertView.getTag();
        }

        if (mImages.get(position).getImageSource().equals("sdcard")) {

            imageLoader.displayImage(mImages.get(position).getImages(),
                    holder.image,options);
        } else {

            String url = "drawable://"
                    + Integer.parseInt(mImages.get(position).getImages());

            imageLoader.displayImage(url, holder.image,options);

        }

        return convertView;
    }
} 
```

**更新：**我在 gridview 中有大约 30 张图像，一开始它只在整个地方显示第一张图像，并且需要大约 1 分钟才能正确显示所有图像。

**日志猫**

```
04-16 21:41:16.522: E/dalvikvm-heap(738): Out of memory on a 1042024-byte allocation.
04-16 21:41:16.565: I/dalvikvm(738): "pool-1-thread-1" prio=4 tid=15 RUNNABLE
04-16 21:41:16.565: I/dalvikvm(738):   | group="main" sCount=0 dsCount=0 obj=0x4054f720 self=0x279080
04-16 21:41:16.572: I/dalvikvm(738):   | sysTid=762 nice=10 sched=0/0 cgrp=bg_non_interactive handle=2593208
04-16 21:41:16.591: I/dalvikvm(738):   | schedstat=( 47274229556 127781868212 1951 )
04-16 21:41:16.591: I/dalvikvm(738):   at java.io.ByteArrayOutputStream.expand(ByteArrayOutputStream.java:~91)
04-16 21:41:16.591: I/dalvikvm(738):   at java.io.ByteArrayOutputStream.write(ByteArrayOutputStream.java:216)
04-16 21:41:16.591: I/dalvikvm(738):   at android.graphics.Bitmap.nativeCompress(Native Method)
04-16 21:41:16.633: I/dalvikvm(738):   at android.graphics.Bitmap.compress(Bitmap.java:589)
04-16 21:41:16.642: I/dalvikvm(738):   at com.nostra13.universalimageloader.core.download.BaseImageDownloader.getStreamFromDrawable(BaseImageDownloader.java:188)
04-16 21:41:16.642: I/dalvikvm(738):   at com.nostra13.universalimageloader.core.download.BaseImageDownloader.getStream(BaseImageDownloader.java:92)
04-16 21:41:16.642: I/dalvikvm(738):   at com.nostra13.universalimageloader.core.LoadAndDisplayImageTask.downloadImage(LoadAndDisplayImageTask.java:340)
04-16 21:41:16.652: I/dalvikvm(738):   at com.nostra13.universalimageloader.core.LoadAndDisplayImageTask.tryCacheImageOnDisc(LoadAndDisplayImageTask.java:307)
04-16 21:41:16.652: I/dalvikvm(738):   at com.nostra13.universalimageloader.core.LoadAndDisplayImageTask.tryLoadBitmap(LoadAndDisplayImageTask.java:249)
04-16 21:41:16.652: I/dalvikvm(738):   at com.nostra13.universalimageloader.core.LoadAndDisplayImageTask.run(LoadAndDisplayImageTask.java:131)
04-16 21:41:16.652: I/dalvikvm(738):   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
04-16 21:41:16.713: I/dalvikvm(738):   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
04-16 21:41:16.713: I/dalvikvm(738):   at java.lang.Thread.run(Thread.java:1019) 
```

# c# - 按日期过滤 - 考虑用户的时区

> ID：16041679
> 
> 赞同：0
> 
> 时间：2013-04-16T15:58:08.170
> 
> 标签：c#, datetime, timezone

我有一个帖子列表，其中帖子有一个“添加日期”字段，该字段已设置为 UTC 时间。我需要过滤特定月份/年份的帖子。我正在努力的部分是我将如何考虑当前用户的时区（包括夏令时）。

以下是需要考虑的变量：

```
List<Post> posts = ...;
TimeZoneInfo userTimeZone = ...;
int year = ...;
int month = ...; 
```

如果有人能告诉我正确的方法，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:12:37.370

为什么不使用 C# 的`DateTime`类？它应该为您处理所有这些并且它具有比较功能？

[http://msdn.microsoft.com/en-us/library/system.datetime.compare.aspx](http://msdn.microsoft.com/en-us/library/system.datetime.compare.aspx)

它有多种结构，具体取决于您知道时间的准确程度。

您可以使用 LINQ 对`List`.

编辑：对于时区转换[http://msdn.microsoft.com/en-us/library/bb397769.aspx](http://msdn.microsoft.com/en-us/library/bb397769.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:43:29.777

您只需将`DateTime`查询的值转换为 UTC，然后对其进行过滤。

```
// here are some posts
List<Post> posts = new List<Post>
{
    new Post {DateAdded = new DateTime(2013, 1, 1, 0, 0, 0, DateTimeKind.Utc)},
    new Post {DateAdded = new DateTime(2013, 2, 1, 0, 0, 0, DateTimeKind.Utc)},
    new Post {DateAdded = new DateTime(2013, 2, 2, 0, 0, 0, DateTimeKind.Utc)},
    new Post {DateAdded = new DateTime(2013, 3, 1, 0, 0, 0, DateTimeKind.Utc)},
    new Post {DateAdded = new DateTime(2013, 3, 2, 0, 0, 0, DateTimeKind.Utc)},
    new Post {DateAdded = new DateTime(2013, 3, 3, 0, 0, 0, DateTimeKind.Utc)},
};

// And the parameters you requested
TimeZoneInfo userTimeZone = TimeZoneInfo
                                .FindSystemTimeZoneById("Central Standard Time");
int year = 2013;
int month = 2;

// Let's get the start and end values in UTC.
DateTime startDate = new DateTime(year, month, 1);
DateTime startDateUtc = TimeZoneInfo.ConvertTimeToUtc(startDate, userTimeZone);
DateTime endDate = startDate.AddMonths(1);
DateTime endDateUtc = TimeZoneInfo.ConvertTimeToUtc(endDate, userTimeZone);

// Filter the posts to those values.  Uses an inclusive start and exclusive end.
var filteredPosts = posts.Where(x => x.DateAdded >= startDateUtc &&
                                     x.DateAdded < endDateUtc); 
```

# c# - 从具有不同值的字符串构建查询

> ID：16041680
> 
> 赞同：1
> 
> 时间：2013-04-16T15:58:11.427
> 
> 标签：c#, asp.net-mvc, linq, dynamic-queries

我正在构建一个 MVC 应用程序，在这个应用程序中，我需要根据用户使用的过滤器获取对象列表。

所以我最终可能会得到一个这样的字符串：

```
*OBJNAME=[SWORD][OF][THOUSAND][TRUTHS]*OBJTYPE=[ARTEFACT]*OBJNUMBER=[28]*COST=[9]+<*POWER=[3]+>=*RATING=[4]+<*OWNER=[WRIGHT][STAN]*OBJSET=[WORLD OF WARCRAFT]*RARITY=[LEGENDARY]*ADDCOST=[6QGBA]*OBJCOLOR=[ALL] 
```

每个 * 是我在构建字符串时引入的标签，以便我可以在 DAL 类中分别标识每个属性：

```
public List<ObjInfo> ListObjWithQryString(string _objQry)
{
    List<ObjInfo> listToReturn = new List<ObjInfo>();

    char[] firstDelimiters = {'*'};

    string[] parsedValues = _objQry.Split(firstDelimiters,
       StringSplitOptions.RemoveEmptyEntries);

    foreach (string parsedValue in parsedValues)
    {
       if (parsedValue.Contains("OBJNAME"))
       {
           // WRITE CODE HERE
       }
    }

    return listToReturn;
} 
```

现在我的问题是基于每个参数可能或可能不存在的事实，所以查询字符串会改变，我不想处理每 81 种可能性，特别是因为这可能并且最终会改变。

有什么方法可以根据获得的值动态构建对我的数据库的查询，以便我可以只返回我正在寻找的值？

*** 编辑 ***

以下是我可能最终拥有的几个字符串示例：

```
*OBJNAME=[SWORD][OF][THOUSAND][TRUTHS]

// Seeking all objects named Sword of a Thousand Truths

*OBJNAME=[SWORD][OF][THOUSAND][TRUTHS*OBJNUMBER=[28]*COST=[9]+<*POWER=[3]+>=*RATING=[4]+<RARITY=[LEGENDARY]*ADDCOST=[6QGBA]*OBJCOLOR=[ALL]

// Seeking all objects named Sword of a Thousand Truths with number 28 with cost lesser than 9 with power greater or equal to 3 with rating lesser than 4 with rarity Legendary with additional cost 6QGBA with all colors

*OBJNAME=[SWORD][OF][THOUSAND][TRUTHS]*OBJTYPE=[ARTEFACT]*OBJNUMBER=[28]*COST=[9]+<*POWER=[3]+>=*RATING=[4]+<*OWNER=[STAN]*OBJSET=[WORLD OF WARCRAFT]

// Seeking all objects named Sword of a Thousand Truths with type Artefact with number 28 with cost lesser than 9 with power greater or equal to 3 with owner Stan with objSet World of Warcraft

*ADDCOST=[6QGBA]*OBJCOLOR=[ALL]

// Seeking all objects with additional cost 6QGBA with all colors

*ADDCOST=[6QGBA]*OBJCOLOR=[BLUE][RED][PURPLE]

// Seeking all objects with additional cost 6QGBA with specific color Blue, Red, Purple

*OBJTYPE=[ARTEFACT]*POWER=[3]+>=

// Seeking all objects with type Artefact and power greater or equal to 3 
```

所以，你看到我最终可能会对字符串有不同的标签。如果需要，我可以粘贴其他信息。

***** 还*******

 **请记住，这就是我现在构建应用程序的方式，但如果有更好的做事方式，我愿意接受任何建议。

*编辑 2*

感谢@I4V，我有一本字典，实际上对这些值进行了分组。所以：

```
var dict = Regex.Matches(_cardQry, @"\*(\w+)=([^\*$]+)").Cast<Match>()
                            .ToDictionary(x => x.Groups[1].Value,
                                          x => string.Join(" ", x.Groups[2].Value.Split(new char[] {'[', ']'}))); 
```

会给字典。如果我`foreach`用一个字符串在字典中传递第一个参数，我会得到这个：

核心价值

```
OBJNAME= SWORD  OF  THOUSAND TRUTHS  
OBJTYPE= ARTIFACT 
OBJNUMBER= 28 
COST= 9 +>= //(small bug here, there should not be a "=" sign at the end, but it's not major)
POWER= 3 +<=
RATING= 4+<
OWNER= STAN
OBJSET= WORLD OF WARCRAFT
RARITY= LEGENDARY
ADDCOST= 4  W  G  U  G  R 
OBJCOLOR= ALL 
```

并使用这行代码：

```
var whereCondition = "WHERE " + String.Join(" AND ", dict.Select(kv => kv.Key + "='" + kv.Value + "'")); 
```

我最终得到了一个相当有用的字符串，如下所示：

```
WHERE OBJNAME=' SWORD  OF  THOUSAND TRUTHS ' AND OBJTYPE=' ARTIFACT ' AND OBJNUMBER=' 28 ' AND COST=' 9 +<' AND POWER=' 3 +>' AND RATING=' 4 +<' AND OWNER=' STAN ' AND OBJSET='WORLD OF WARCRAFT ' AND RARITY=' LEGENDARY ' AND ADDCOST=' 4  W  G  U  G  R  ' AND OBJCOLOR=' ALL ' 
```

现在，问题不在于构建字符串，而在于如何使用它来进行查询调用。我对 MVC 应用程序非常陌生，尤其是数据库调用。我通常这样调用我的数据库：

```
var objQry = from o in m_DB.O
             where o.NAME == _nameProvided
             select o; 
```

如何使用字符串进行这样的查询调用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:11:57.017

您可以从输入字符串创建字典。使用它会更简单。

```
string input = "*OBJNAME=[SWORD][OF][THOUSAND][TRUTHS]*OBJTYPE=[ARTEFACT]*OBJNUMBER=[28]*COST=[9]+<*POWER=[3]+>=*RATING=[4]+<*OWNER=[WRIGHT][STAN]*OBJSET=[RETURN TO RAVNICA]*RARITY=[LEGENDARY]*ADDCOST=[6QGBA]*OBJCOLOR=[ALL]";

var dict = input.Split(new char[]{'*'},StringSplitOptions.RemoveEmptyEntries)
             .Select(p => p.Split('='))
             .ToDictionary(kv => kv[0], 
                           kv => kv[1].Replace("[", "").Replace("]", " ").Trim()); 
```

或使用正则表达式

```
var dict2 = Regex.Matches(input, @"\*(\w+)=([^\*$]+)").Cast<Match>()
            .ToDictionary(x => x.Groups[1].Value, 
                          x => String.Join(" ",x.Groups[2].Value.Split(new char[]{'[',']'},StringSplitOptions.RemoveEmptyEntries))); 
```**

# python-2.7 - Python 2 - 仅在子目录中导入一些模块

> ID：16041681
> 
> 赞同：0
> 
> 时间：2013-04-16T15:58:18.647
> 
> 标签：python-2.7, import, module, subdirectory

这是Python2.7。我已经看到了一些创建文件的说明，该文件读取目录结构，并将每个 .py 文件作为包含拉入，但它通常取决于有**file**，我不能使用（或没有开始工作）。

我有一系列具有多个目录的模块。让我们从结构开始：

```
\\Scripts:
    script.py  # from ProgramName import *
\ProgramName
    __init__.py # empty
    FileA.py     
    FileB.py
    FileC.py
\ProgramName\SupportFilesA
    __init__.py # empty
    FileX.py    # contains class fileX()
    FileY.py    # contains class fileY()
    FileZ.py    # contains class fileZ() 
```

然而，出于某种原因，我可以访问类 fileX 和 fileY，但不能访问 fileZ。好的，这些类比这复杂得多，所以我复制 FileX 并创建 FileXX.py，类为 fileXX()。这也没有被捡起。

任何文件的编译都没有错误。在脚本中，导入 * 不会失败。我根本无法制作 x = fileZ() 或 x = fileXX()。

# spring - 通过facebook登录后设置spring security记住我的cookie

> ID：16041685
> 
> 赞同：1
> 
> 时间：2013-04-16T15:58:26.190
> 
> 标签：spring, spring-mvc, spring-security

我正在构建一个可以选择通过 facebook/twitter 登录的移动网络应用程序。我希望应用程序通过 Spring 安全的记住我功能记住登录，以便用户需要经常登录。

我有将调用 facebook 并获取将识别用户的 access_token 的部分。我可以使用登录用户

```
    SecurityContextHolder.getContext().setAuthentication(
        new UsernamePasswordAuthenticationToken(principal, credentials, authority));

```

我正在尝试使用类似的方法来添加记住我的功能

```
    RememberMeAuthenticationToken auth = new RememberMeAuthenticationToken(key, principal, authority);
    SecurityContextHolder.getContext().setAuthentication(auth);

```

虽然这会登录用户，但它不会设置记住我的 cookie。我在这里想念什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:11:37.183

尝试注入`RememberMeServices`接口的实现，然后尝试做：

```
rememberMeServices.loginSuccess(request, response, auth); 
```

确保`_spring_security_remember_me`请求中存在该参数。

# erlang - Erlang 基础知识：编译时的语法错误

> ID：16041686
> 
> 赞同：2
> 
> 时间：2013-04-16T15:58:27.297
> 
> 标签：erlang

我对 Erlang 很陌生，我正在尝试编译我的第一个程序，但在编译时出现语法错误。

我得到的语法错误指向`filter_inside`未定义的第 2 行。之前的最后一行还有语法错误`X`。

函数.erl

```
-module(functions).
-export([filteri/2]).

filteri(_, []) -> 
                    []; 
filteri(P,[X|XS]) ->
                    [(map(P) X)|filteri P XS]. 
```

我一直在尝试调试大约一个小时，但没有成功，我想知道是否有人可以帮助我确定导致无法编译的代码是什么。

提前谢谢了！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T16:00:51.887

Erlang 用分号分隔子句`;`。

语句用逗号分隔`,`。

只需`[];`在第 5 行使用。

最后一行也断了。要将元素`Head`添加到列表中，请`Tail`使用`[Head|Tail]`括号。

函数调用看起来像`Fun(Arg1, Arg2, ...)`.

Erlang 区分大小写。`x`是一个原子（您可以将其视为字符串常量），而`X`是变量`X`.

比显式递归更容易使用的是列表推导`[Fun(X) || X <- XS]`（或`[Fun(X) || X <- XS, Predicate(X)]`）。

我想你可以使用

```
filter_inside(Fun, XSS) ->
    [ [Fun(X) || X <- XS] || XS <- XSS ]. 
```

在您的解决方案中，您可以将其用作最后一行：

```
[list:map(P, X)|filter_inside(P, XS)].  % Mind the function call syntax. 
```

Erlang在该`-export`行报告了一个问题，因为该函数包含错误，因此名称未知。

进一步的评论：`filter_inside(_, [])`用作加速的最后一个子句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T16:26:17.043

最后一行 `[(map(P) X)|filter_inside P XS].` 应该是`[P(X) | filter_inside(P, XS)].` 语法需要更正。您正在寻找 map apply 和 predicate 来取回结果，即 implement `lists:map`。

例如：`lists:map(fun(A)->A*2 end, [1,2,3,4,5]).`获得等效的结果`[2,4,6,8,10]`

然后在 Erlang 中你也可以这样写来利用尾递归优化：

```
-module(functions).
-export([filter_inside/2]).

filter_inside(P,L) ->
    filter_inside(P,L, []).

filter_inside(_, [], Acc) -> 
    lists:reverse(Acc); 
filter_inside(P,[X|XS], Acc) ->
    filter_inside(P, XS,  [P(X) | Acc]). 
```

# asp.net - 如何在.net web 应用程序中水平翻转图像

> ID：16041690
> 
> 赞同：5
> 
> 时间：2013-04-16T15:58:37.987
> 
> 标签：asp.net, vb.net, image, flip

我需要在我的 VB.net Web 应用程序中水平翻转位图图像。

IE

![在此处输入图像描述](https://i.stack.imgur.com/AWDmw.png)

我真的四处寻找，但没有遇到任何简单的 vb.net 方法。一个存在吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:26:09.797

您获得对图像的文件引用，将其加载为`Bitmap`，然后使用 RotateFlip 方法。

[http://msdn.microsoft.com/en-us/library/system.drawing.rotatefliptype.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-2](http://msdn.microsoft.com/en-us/library/system.drawing.rotatefliptype.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-2)

如果该链接像 Microsoft 经常发生的那样死掉：

```
 bitmap1 = CType(Bitmap.FromFile("C:\Documents and Settings\All Users\" _
        & "Documents\My Music\music.bmp"), Bitmap)
    bitmap1.RotateFlip(RotateFlipType.RotateNoneFlipX) 
```

您可能对 Image 类感兴趣（Bitmap 就是 Image）。您几乎可以执行任何幼稚的操作（例如这个），并且有多种方法可以利用 3D 卡真正发疯。你可以走得很远。但是，您需要学习图形矩阵才能高效地执行自定义效果。

[http://msdn.microsoft.com/en-us/library/k7e7b2kd.aspx](http://msdn.microsoft.com/en-us/library/k7e7b2kd.aspx)

**编辑**

对问题笔记性能的评论可能是这里的一个问题。根据加载此类图像的频率，您可能应该缓存此结果，例如通过将其写入磁盘并让浏览器通过它写入的路径实际请求文件（这将为您提供任何 IIS 缓存您已经免费配置了），或者通过将 OutputCache 指令应用于此处调用的控制器操作，或者其他任何东西 - 有点超出了这个问题的范围。

也只是为了记录翻转图像非常便宜。

# python - 自动增量未写入对象

> ID：16041693
> 
> 赞同：0
> 
> 时间：2013-04-16T15:58:48.817
> 
> 标签：python, orm, sqlalchemy

我使用 SQLAlchemy 作为我的 ORM 层来访问我的 MySQL 数据库。

这是表格，映射器和模型，我正在谈论：

```
CREATE TABLE user (
    uid INT(12) NOT NULL auto_increment,
    email VARCHAR(128) NOT NULL,
    password VARCHAR(128) NOT NULL,
    display_name VARCHAR(128) NOT NULL,
    timezone VARCHAR(96) NOT NULL,
    join_date DATETIME NOT NULL,
    last_login DATETIME NOT NULL,
    verified INT(1) NOT NULL DEFAULT 0,
    PRIMARY KEY (uid),
    UNIQUE (email)
) ENGINE=InnoDB;

class User(object):
    def __init__(self, id=0, email="", password="", displayName="",
                 timezone="UTC", joinDate=None, lastLogin=None, verified=False):
    self.id = id
    self.email = email
    self.password = password
    self.displayName = displayName
    self.timezone = timezone
    self.joinDate = joinDate or datetime.utcnow()
    self.lastLogin = lastLogin or datetime.utcnow()
    self.verified = verified

userTable = sqlalchemy.Table('user', meta, autoload=True)

sqlalchemy.orm.mapper(models.User, userTable, properties={
    'id': userTable.c.uid,
    'displayName': userTable.c.display_name,
    'joinDate': userTable.c.join_date,
    'lastLogin': userTable.c.last_login
} 
```

问题是，每当我尝试通过 orm 层将对象插入数据库时​​，我希望新生成的 ID 会保存在原始对象中以供将来参考。否则这整件事对我来说毫无用处。

```
>>> session = Session()
>>> u = User(0, 'test@example.com', 'asdf', 'Test User')
>>> session.add(u)
>>> session.flush()
>>> u.id
0 
```

有谁知道如何告诉 SQLALchemy 将 ID 保存到原始对象中？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T14:08:38.793

当然，@msw 和@Aya 是对的。在插入数据库之前，对象的 id 属性必须为 None。

# file-io - 在运行 SSIS 包之前检查 ftp 文件的简单方法

> ID：16041695
> 
> 赞同：0
> 
> 时间：2013-04-16T15:58:52.783
> 
> 标签：file-io, ssis

我有一个 SSIS 包，我计划每 15 分钟运行一次。该软件包将从 ftp 服务器获取文件并将它们移动到服务器上的文件夹，然后处理文件。

我需要做的是在运行 SSIS 包之前检查文件是否存在。

我正在对服务器内文件夹中的文件做类似的事情，将它们移动到 ftp 服务器以返回客户端。

有人有这方面的经验吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:11:23.657

如果它是您希望检查文件的远程 FTP 服务器，并且您的 FTP 任务在 SSIS 包中……那么您将无法在不运行 SSIS 包的情况下检查文件。如果您在包中的初始 FTP 任务中检查文件，那么您每 15 分钟启动一个 SSIS 包，这可能不是一个好习惯。

接下来发生的事情是企业问为什么它不能每五分钟运行一次，然后他们问为什么它不能每两分钟运行一次。这是很多服务器开销。

有时我使用了两个 SSIS 包，一个执行 FTP 传输，另一个执行本地处理，并将它们设置为 SQL Server 代理作业的两个独立步骤。这样做的原因是为了区分错误行为。但这是针对每晚的工作，而不是每 15 分钟运行一次的工作。

如果您正在检查本地网络上的文件，或者直接使用 FTP，那么您可以使用批处理文件或其他东西作为 SQL Server 代理作业的第一步（并在必要时中止）。这样可以降低开销。

# java - 允许分离的 RCP 视图位于主工作台后面

> ID：16041699
> 
> 赞同：0
> 
> 时间：2013-04-16T15:59:10.503
> 
> 标签：java, eclipse, rcp

我正在寻找一个视图，它已经被用户分离，能够放置在主应用程序窗口的前面和后面。以前有没有人处理过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:02:01.037

我认为您正在寻找的是更改分离窗口的外壳样式，因此您可以将其设置为像独立窗口一样，就像它是另一个应用程序一样。

请参阅这篇文章：[如何创建我自己的 shell 来替换在 e4 RCP 中的 MTrimmedWindow 中创建的 shell？](https://stackoverflow.com/questions/14209828/how-to-create-my-own-shell-to-replace-the-shell-created-in-the-mtrimmedwindow-in)

# jaxb - 一对多和多对一 MOXy @XmlInverseReference EclipseLink 2.5

> ID：16041705
> 
> 赞同：2
> 
> 时间：2013-04-16T15:59:25.620
> 
> 标签：jaxb, eclipselink, moxy

我正在向您展示我已经拥有的课程，并且我想使用 jaxb 进行序列化。不幸的是，当我尝试在 Person 内部序列化 positionSet 时，我无法完全获得 Person 对象内部的所有属性

代码：

```
 public class Person {   
        @Id
        @Column(name = "ID")
        private Integer id;

        @Column(name = "FIRST_NAME")
        @NotNullOnlyJsp
        private String firstName;

        @Column(name = "LAST_NAME")
        @NotNullOnlyJsp
        private String lastName;    

        @OneToMany(cascade = { CascadeType.ALL }, fetch = FetchType.LAZY, mappedBy = "person")
        @org.hibernate.annotations.OrderBy(clause = "start_date asc")
        private Set<Position> positionSet = new LinkedHashSet<Position>();

        // getter and setter and other methods..    

    }

    public class Position{

        @Id
        @Column(name = "ID")
        private Integer id;

        @Column(name = "FK_PERSON")
        @NotNull
        private Integer personId;

        @Column(name = "FK_POSITION_TYPE")
        @NotNull
        private Integer positionTypeId;

        @ManyToOne(fetch = FetchType.LAZY)
        @JoinColumn(name = "FK_POSITION_TYPE", insertable = false, updatable = false)
        private Entity positionType;

        @ManyToOne(fetch = FetchType.LAZY)
        @JoinColumn(name = "FK_PERSON", insertable = false, updatable = false)
        // I need this annotation to avoid ciclyc graph
        @XmlInverseReference(mappedBy="positionSet")
        private Person person;

        @Column(name = "FK_ORG_UNIT")
        @NotNull
        private Integer organizationUnitId;

        @ManyToOne(fetch = FetchType.LAZY)
        @JoinColumn(name = "FK_ORG_UNIT", insertable = false, updatable = false)
        // I need this annotation to avoid ciclyc graph
        @XmlInverseReference(mappedBy="organizationUnitPositionSet")
        private OrganizationUnit organizationUnit;

    // getter and setter and other methods..    
    }

    public class OrganizationUnit{

        @Id
        @Column(name = "ID")
        private Integer id;

        @ManyToOne(fetch = FetchType.LAZY)
        @JoinColumn(name = "FK_ORG_UNIT_TYPE", insertable = false, updatable = false)
        private OrganizationUnitType organizationUnitType;

        @Column(name = "FK_ORG_UNIT_TYPE")
        private Integer organizationUnitTypeId;

        @Column(name = "DESCRIPTION", length = 4000)
        @NotNull
        private String description;

        @OneToMany(cascade = { CascadeType.ALL }, fetch = FetchType.LAZY, mappedBy = "organizationUnit")
        @org.hibernate.annotations.OrderBy(clause = "start_date asc")
        // I need this annotation to avoid ciclyc graph
        private Set<Position> organizationUnitPositionSet = new LinkedHashSet<Position>();

        // getter and setter and other methods..    
    } 
```

现在，正如您可以理解的那样，关系是： Person 一对多 Position 多对一 OrganizationUnit Position 有两个属性：“positionType”和“organizationUnit”，它们引用了 OrganizationUnit 当 jaxb 序列化时，我只能看到 positionType 元素和关于 organizationUnit 元素的任何内容内位置。我试图检查 Position 是否包含值，并且发现数据在对象内部可用。Position 类中positionType 和organizationUnit 属性之间的区别在于@XmlInverseReference 注释，我需要OrganizationUnit 类映射的organizationUnit 属性，而我不需要positionType 的此注释。

我该如何解决这个问题？为什么注释不允许我访问 Position 中的 organizationUnit？

我希望有人能帮助我。为了向您展示它序列化但不正确，我将向您展示 xml 输出文件：我看不到 organizationUnit 属性

```
 <person>
    // other property
    <position-set>
        <position>
            <id>174215</id>
            <discriminator>support</discriminator>
            <endDate>2005-06-30T00:00:00</endDate>
            <organizationUnitId>1234</organizationUnitId>
                <positionType>
                    <id>2733</id>
                    <displayValue>BLABLA</displayValue>
                        <organization-unit-type>
                            <id>101</id>
                            <description>supportRole</description>
                        </organization-unit-type>
                </positionType>
            <startDate>2005-02-01T00:00:00</startDate>
        </position>
    </position-set>

    This is the oxm file:
    <?xml version="1.0"?>
    <xml-bindings
        xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
        package-name="it.mymodel.ga.model" >
        <xml-schema
            element-form-default="QUALIFIED"/>  
        <java-types>
            <java-type name="Person"  xml-accessor-type="NONE">
                <xml-root-element/>
                <java-attributes>
                    <xml-element java-attribute="firstName" name="first-name" />
                    <xml-element java-attribute="lastName" name="last-name" />
                    <xml-element java-attribute="stringMap" name="string-map" />
                     <xml-element java-attribute="positionSet"  name="position" >
                          <xml-element-wrapper name="position-set"/>
                     </xml-element>
                </java-attributes>
            </java-type>
            <java-type name="Position"> <!-- I had to use this approach than xml-accessor-type="NONE" unlikely -->
                    <java-attributes>
                          <xml-element java-attribute="discriminator" />
                          <xml-element java-attribute="startDate" />
                          <xml-element java-attribute="endDate"/>
                          <xml-element java-attribute="organizationUnit" name="organization-unit"/>
                          <xml-element java-attribute="positionType" name="position-type"/>
                          <xml-transient java-attribute="person"/>
                          <xml-transient java-attribute="positionTypeId"/>
                          <xml-transient java-attribute="fileInfo"/>
                          <xml-transient java-attribute="personId"/>
                          <xml-transient java-attribute="priority"/>
                          <xml-transient java-attribute="uniqueIdentifier"/>
                          <xml-transient java-attribute="uuid"/>
                          <xml-transient java-attribute="removeFile"/>
                   </java-attributes>
            </java-type>
           <java-type name="OrganizationUnit">
                   <java-attributes>
                    <xml-transient java-attribute="description" name="description" />
                    <xml-element java-attribute="organizationUnitType"  name="organization-unit-type"/>
                    <xml-transient java-attribute="displayAs"/>
                    <xml-transient java-attribute="organizationUnitTypeId"/>
                    <xml-element java-attribute="displayValue" />
                  </java-attributes>
            </java-type>
            <java-type name="OrganizationUnitType" >
                        <java-attributes>
                            <xml-element java-attribute="description"/>
                            <xml-transient java-attribute="priority"/>
                        </java-attributes>
            </java-type> 
        </java-types>
    </xml-bindings> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T14:58:34.957

我只是通过删除 Position 类内的 organizationUnit 属性上的注释 @XmlInverseReference 来解决，我为 OrganizationUnit 类内的属性 positionSet 指定了 xml-transient

```
oxm file :
<?xml version="1.0"?>
<xml-bindings
    xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
    package-name="mypackage" >
    <xml-schema
        element-form-default="QUALIFIED"/>  
    <java-types>
        <java-type name="Person"  xml-accessor-type="NONE">
            <xml-root-element/>
            <xml-type prop-order="firstName lastName addressSet contactSet integerMap dateMap stringMap positionSet personElementSet clobMap blobMap gaDictionaryMap "/>
            <java-attributes>
                <xml-element java-attribute="firstName" name="first-name" />
                <xml-element java-attribute="lastName" name="last-name" />
                <xml-element java-attribute="stringMap" name="string-map" >
                    <xml-java-type-adapter value="it.cineca.jaxb.adapter.StringMapAdapter" />    
                </xml-element>
                <xml-element java-attribute="personElementSet" name="person-element">
                    <xml-element-wrapper name="person-element-set"/>
                 </xml-element>
                <xml-element java-attribute="dateMap" name="date-map" >
<!--                <xml-java-type-adapter value="it.cineca.jaxb.adapter.DateMapAdapter" /> -->
                </xml-element>
                 <xml-element java-attribute="positionSet"  name="position" >
                      <xml-element-wrapper name="position-set"/>
                 </xml-element>
                <xml-element java-attribute="addressSet" name="address">                
                    <xml-element-wrapper name="address-set"/>
                 </xml-element>
                 <xml-element java-attribute="contactSet" name="contact">               
                    <xml-element-wrapper name="contact-set"/>
                 </xml-element>
                 <xml-element java-attribute="integerMap" name="integer-map"/>          
                 <xml-element java-attribute="blobMap" name="blob-map"/>
                 <xml-element java-attribute="clobMap" name="blob-map"/>
                 <xml-element java-attribute="gaDictionaryMap" name="ga-dictionary-map"/>
            </java-attributes>
        </java-type>
        <java-type name="Position">
               <java-attributes>
                      <xml-element java-attribute="discriminator" />
                      <xml-element java-attribute="startDate" />
                      <xml-element java-attribute="endDate"/>
                      <xml-element java-attribute="organizationUnit" name="organization-unit"/>
                      <xml-element java-attribute="positionType" name="position-type"/>
                      <xml-transient java-attribute="organizationUnitId"/>
                      <xml-transient java-attribute="person"/>
                      <xml-transient java-attribute="positionTypeId"/>
                      <xml-transient java-attribute="fileInfo"/>
                      <xml-transient java-attribute="personId"/>
                      <xml-transient java-attribute="priority"/>
                      <xml-transient java-attribute="uniqueIdentifier"/>
                      <xml-transient java-attribute="uuid"/>
                      <xml-transient java-attribute="removeFile"/>
               </java-attributes>
        </java-type>
       <java-type name="OrganizationUnit">
               <java-attributes>
                    <xml-element java-attribute="displayValue" />
                    <xml-element java-attribute="organizationUnitType"  name="organization-unit-type"/>
                    <xml-element java-attribute="stringMap" name="string-map" />
                    <xml-element java-attribute="dateMap" name="date-map" />
                    <xml-element java-attribute="startDate" />
                    <xml-element java-attribute="endDate" />        
                    <xml-transient java-attribute="addressSet"/>
                    <xml-transient java-attribute="contactSet"/>
                    <xml-transient java-attribute="blobMap"/>
                    <xml-transient java-attribute="clobMap"/>
                    <xml-transient java-attribute="childOrganizationUnitLinkSet" />
                    <xml-transient java-attribute="dataSet"/>
                    <xml-transient java-attribute="displayAs"/>
                    <xml-transient java-attribute="discriminatorSet"/>
                    <xml-transient java-attribute="lastModified"/>
                    <xml-transient java-attribute="lastModifiedString"/>
                    <xml-transient java-attribute="organizationUnitTypeId"/>
                    <xml-transient java-attribute="description"/>
                    <xml-transient java-attribute="parentOrganizationUnitLinkSet" />
                    <xml-transient java-attribute="positionSet"/>
                    <xml-transient java-attribute="principalContactMap"/>
              </java-attributes>
        </java-type>

    </java-types>
</xml-bindings> 
```

# jquery - 通过输入名称获取检查输入的索引

> ID：16041706
> 
> 赞同：0
> 
> 时间：2013-04-16T15:59:26.747
> 
> 标签：jquery

我有 2`name`个输入（`group1`和`group2`）。给定其中一个，如何获取复选框的索引`name`？

```
<input type="radio" name="group1" value="Milk"> Milk<br>
<input type="radio" name="group1" value="Butter" checked> Butter<br>
<input type="radio" name="group1" value="Cheese"> Cheese
<hr>
<input type="radio" name="group2" value="Water"> Water<br>
<input type="radio" name="group2" value="Beer"> Beer<br>
<input type="radio" name="group2" value="Wine" checked> 
```

例如，如果我选中`group2`("Beer") 中的第二个单选框，它将返回 2。

编辑：基于反馈的[演示；](http://jsfiddle.net/vtGay/3/)还是行不通。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:06:45.717

您需要为每个组找到选中的元素，然后找到它的索引。确保在`index()`函数内部进行过滤，否则它将给出所有兄弟姐妹之间的索引，而不仅仅是该组的输入。

```
var group1Index = $('input[name="group1"]:checked').index('input[name="group1"]');
var group2Index = $('input[name="group2"]:checked').index('input[name="group2"]'); 
```

**编辑**注意[index()](http://api.jquery.com/index/)函数是 0 索引的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:01:24.857

您可以使用 javascript 来遍历按钮，并返回被选中的那个：

```
function getRadioValue(RadioName)
{
var colRadio = document.getElementsByName(RadioName);
for (var i = 0; i < colRadio.length; i++)
{
if (colRadio[i].checked)
{
return colRadio[i].value;
}
return null;
}

vValue = getRadioValue("group1"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T16:03:54.937

返回名为“group1”的已检查输入元素的基于 0 的索引

```
$('input[name="group1"]:checked').index() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T16:05:38.953

我不确定您要做什么。几乎所有其他答案都是关于**index()**，但在你的情况下，第二个单选按钮 index() 不会像你想要的那样返回 2 ，**它会返回 1**因为索引是基于 0 的。

[这个 jsfiddle](http://jsfiddle.net/vtGay/5/)展示了如何获取特定组中选定输入的*索引/值/分数/编号*，以及如何汇总所有选定单选按钮的值。

```
<form id="myForm">
     <h3>First Group</h3>

    <input type="radio" name="group1" value="the-first" data-points="0">First</input>
    <input type="radio" name="group1" value="the-second" data-points="20">Second</input>
    <input type="radio" name="group1" value="the-third" data-points="300">Third</input>
    <hr>
    <h3>Second Group</h3>
    <input type="radio" name="group2" value="four" data-points="4">4</input>
    <input type="radio" name="group2" value="five" data-points="5">5</input>
    <input type="radio" name="group2" value="six" data-points="6">6</input>
    <hr>
    <input type="submit" value="Submit" />
</form> 
```

和 javascript/jQuery（出于演示目的使用 alert 而不是 console.log）：

```
$(function () {
    $("#myForm").submit(function () {
        //This gets the checked input in group1
        var g1 = $("input[name='group1']:checked");
        alert("Group 1 \n Selected Value: " + g1.val() + " \n Selected Index: " + g1.index() + "\n Points: " + g1.data('points'));

        var totalPoints = 0;

        //This loops through all checked inputs
        $.each($("input:checked"), function () {
            totalPoints += $(this).data("points");
        });

        alert("Total points from all groups: " + totalPoints);

        return false; //remove if you want to submit
    });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-16T16:08:20.060

您可以使用[$.index()](http://api.jquery.com/index/)：

```
 $('input[type=checkbox]').click(function(){
    var idx = $(this).index();
    // do whatever with the index
  }); 
```

[看到它在行动](http://jsbin.com/isovil/1/edit)

在上面的代码（和给出的示例）中，将复选框分组在一个仅包含它们的容器中是很重要的，因为它`index`返回一个数字，表示元素关于其容器的索引。

# html - 固定导航栏

> ID：16041710
> 
> 赞同：0
> 
> 时间：2013-04-16T15:59:42.243
> 
> 标签：html, css, uinavigationbar, center, css-position

我有一个导航栏，我想保持固定和居中。我的栏目前居中，但是当我添加“位置：固定”时，它将我的导航栏一直移动到屏幕的左侧。我的导航栏目前距离屏幕顶部大约 20%（居中）。

CSS：

```
div.social-wrap{
width: 500px;
margin: 0 auto 0 auto;
padding-top: 25px;
} 
```

HTML：

```
<div class="social-wrap">
        <ul>
            <li><a href="index.html" class="link_home shadow extend">Home</a>
            </li>
            <li><a href="about.html" class="link_identity shadow extend">Identity</a>
            </li>
            <li><a href="books.html" class="link_books shadow extend">Books</a>
            </li>
            <li><a href="contact.html" class="link_contact shadow extend">Contact</a>
            </li>
            <li><a href="https://twitter.com/Christdentity" class="link_twitter shadow extend" target="_blank">Twitter</a>
            </li>
        </ul>
</div> 
```

这是jsfiddle：

[http://jsfiddle.net/Sederu/uPZuu/](http://jsfiddle.net/Sederu/uPZuu/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:05:04.030

您`<div>`在使用固定定位时正在移动，因为默认情况下[它从文档流中取出](http://www.w3.org/TR/CSS2/visuren.html#propdef-position)并相对于其最近的定位祖先（静态除外）..在您的情况下，`<html>`如果您没有任何其他元素，那可能是根元素为您的导航栏定位祖先。如果它移动到视口的左上角，这是有道理的。

您基本上需要将 left 属性设置为 50% 以居中，还需要将 margin-left 设置为 div 宽度的负一半以将中心移向 div 的中间。

例子：

```
div.social-wrap{
width: 500px;
position: fixed;
left: 50%;
margin-left: -250px;
padding-top: 25px;
} 
```

# windows - 从内核模式 WinDBG 调试用户进程时是否可以使用线程/本地窗口？

> ID：16041715
> 
> 赞同：1
> 
> 时间：2013-04-16T15:59:54.193
> 
> 标签：windows, windbg

我正在调试过滤器驱动程序并查看资源管理器卡在所述驱动程序中的位置。这里是探险家：

```
PROCESS 86cce2a0  SessionId: 1  Cid: 0b98    Peb: 7ffdb000  ParentCid: 0aac
    DirBase: 3f4ca3e0  ObjectTable: 00000000  HandleCount:   0.
    Image: explorer.exe 
```

我现在可以：

```
!process 86cce2a0 17 
```

显示资源管理器的完整用户和内核模式堆栈。但是，我希望能够在 WinDBG 中使用 UI 线程/本地/堆栈窗口。有谁知道如何设置这些？如果资源管理器崩溃，WinDBG 会自动正确设置这些窗口（我什至可以看到我的资源管理器外壳扩展的源代码），所以它必须是可能的。

我试过了：

```
.process 86cce2a0 
```

但这并不能解决 UI 问题。

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:24:33.663

我已经弄清楚了调用堆栈和本地人的一部分。我缺少的部分是`/r`，在列出线程后`!process <address> 17`，可以：

```
.thread /r 86d6dd48 
```

这将设置调用堆栈窗口和本地窗口。我唯一缺少的是线程窗口，但也许我可以没有它。

# elasticsearch - NEST 编码问题？

> ID：16041716
> 
> 赞同：1
> 
> 时间：2013-04-16T15:59:54.963
> 
> 标签：elasticsearch, nest

使用 NEST+ElasticSearch，我怀疑需要特殊编码的字符没有得到正确处理。示例：这不会返回任何结果

```
var results = 
client.Search<MyClass>(s => s.Query(q => q.Term(t => t.ProgrammingLanguage, "C#"))); 
```

但在用例如“Ruby”替换“C#”后工作正常。查看索引，两个搜索都应该有结果。

已知问题？有解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T13:23:08.780

这**不是**编码问题，而是或多或少 lucene 和代理 elasticsearch 的工作方式。

默认分析器将拆分单词，因此 C# 将变为“c”。查看弹性搜索分析器，以便使用关键字分析器之类的东西按原样存储您的字段数据。

有关更多信息，请参见[http://www.elasticsearch.org/guide/reference/index-modules/analysis/](http://www.elasticsearch.org/guide/reference/index-modules/analysis/)

# javascript - 用百万表示任何给定的数字

> ID：16041720
> 
> 赞同：0
> 
> 时间：2013-04-16T16:00:06.163
> 
> 标签：javascript, jquery, jquery-ui, jquery-plugins

我正在寻找一个 jquery 函数来以百万表示任何给定的数字。例如

```
1,000,000 = 1,

450,0000 = 0.45,

25,000 = 0.025,

500,780,000 = 500.78 
```

如果不将它们转换为字符串，是否可以使用 jquery 或 javascript 来实现这一点。谢谢

更新：逗号仅用于可读性，因此在实际计算过程中将被忽略。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:02:45.393

是的你可以。只需将数字除以 1000000 并使用 parseInt。如果您使用 parseInt，您也可以保留逗号

```
parseInt('1,000,000'.replace(/,/g, ''))/1000000 = 1
parseInt('450,000'.replace(/,/g, ''))/1000000 = 0.45
And so on... 
```

另外，如果数字是浮点数，您可以这样做

```
parseFloat('1,000,000'.replace(/,/g, ''))/1000000 = 1
parseFloat('450,000'.replace(/,/g, ''))/1000000 = 0.45 
```

**更新：**这是小提琴[http://jsfiddle.net/E4UCL/1/](http://jsfiddle.net/E4UCL/1/)

# c# - facebook Insights api - 需要代码/步骤在没有用户干预的情况下进行身份验证

> ID：16041724
> 
> 赞同：-1
> 
> 时间：2013-04-16T16:00:29.217
> 
> 标签：c#, authentication, facebook-c#-sdk, console-application

Need Facebook Insights API - 在 C# 中检索自动 Windows 控制台应用程序的身份验证令牌的示例代码/步骤。

我们在 C# 中开发了一个自动化的 Windows 控制台应用程序，以连接到 Facebook Insights api 以检索数据。在身份验证步骤中，用于身份验证的源代码步骤，无论我通过谷歌搜索找到什么，都会打开浏览器进行 facebook 登录。但是我们的系统是一个自动化系统，一旦部署到生产服务器上，用户干预就无法点击登录按钮等让 facebook 进行身份验证。系统应设置为自动运行而无需用户干预。让我知道我在控制台应用程序中实现 facebook 洞察力身份验证的步骤/文档/示例代码，而无需用户干预点击浏览器弹出窗口中的按钮等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T08:55:40.953

首先你下载这个包

[http://nuget.org/packages/Facebook.CSharp.SDK/](http://nuget.org/packages/Facebook.CSharp.SDK/)

```
var config = new Dictionary<string, object>();
//your application id and secret from https://developers.facebook.com/apps
config.Add("appId", "3955.......");
config.Add("secret", "4c1d...............");
config.Add("fileUpload", true); //optional

FacebookClient client = new FacebookClient(config);

var appToken = client.getAccessToken();
client.setAccessToken(appToken);
Console.Writeline(client.fql("SELECT metric, value FROM insights WHERE      object_id=your_application_id AND metric='application_active_users' AND end_time=end_time_date('your_date') AND period=period('day')")); 
```

这应该工作

# facebook - Facebook open Graph：规范的 URL 可以指向一个完全不同的域吗？

> ID：16041726
> 
> 赞同：5
> 
> 时间：2013-04-16T16:00:29.997
> 
> 标签：facebook, facebook-like

facebook 是否允许您在开放图元标记中引用不相关的域？

例如，假设用户 Bill 导航到我网站上的以下页面：

```
http://BillsEmployer.MySite.Com/ProductSuggestions 
```

在 html 的部分中，我有以下元素

```
<meta property="og:url" 
      content="http://www.amazon.com/dp/1590593898/" /> 
```

请记住，我只是以亚马逊为例。我真正的实现不会引用亚马逊。但它会引用一个我实际上无法控制的网站。

如果 Facebook 不允许我使用 3rd 方网站作为规范 URL，我是否能够引用我控制的不同域？换句话说，我可以指出

[http://CompanyA.MySite.com](http://CompanyA.MySite.com)、[http://CompanyB.MySite.Com](http://CompanyB.MySite.Com)、[http://CompanyC.MySite.com都](http://CompanyC.MySite.com)[指向 http://generic.MySite.com](http://generic.MySite.com)的规范 URL ？

# cassandra - OperationTimeoutException Cassandra 集群 AWS / EMR

> ID：16041727
> 
> 赞同：1
> 
> 时间：2013-04-16T16:00:31.387
> 
> 标签：cassandra, astyanax

我在由 Priam 管理的 Cassandra 集群上运行在 Amazon 上的 Java 应用程序。

我们使用 Amazon 的 Elastic Map/Reduce 服务，在某个时刻，当我运行 EMR 并尝试在 Cassandra 上插入一些数据时，我得到了一个异常：OperationTimeoutException。

这些是我在 Astyanax 上创建 Cassandra 池时传递的配置参数：

```
`ConnectionPoolConfigurationImpl conPool = new` `ConnectionPoolConfigurationImpl(getConecPoolName())`
    .setMaxConnsPerHost(20)
        .setSeeds("ec2-xx-xxx-xx-xx.compute-1.amazonaws.com")
    .setMaxOperationsPerConnection(100)                       .setMaxPendingConnectionsPerHost(20) 
    .setConnectionLimiterMaxPendingCount(20) 
    .setTimeoutWindow(10000) 
    .setConnectionLimiterWindowSize(1000) 
    .setMaxTimeoutCount(3) 
    .setConnectTimeout(5000) 
    .setMaxFailoverCount(-1) 
    .setLatencyAwareBadnessThreshold(20)
        .setLatencyAwareUpdateInterval(1000)
    .setLatencyAwareResetInterval(10000) 
        .setLatencyAwareWindowSize(100) 
    .setLatencyAwareSentinelCompare(100f) 

AstyanaxContext<Keyspace> context = new AstyanaxContext.Builder()
        .forCluster("clusterName")
        .forKeyspace("keyspaceName")
    .withAstyanaxConfiguration(
           new AstyanaxConfigurationImpl().setDiscoveryType(NodeDiscoveryType.NONE))
    .withConnectionPoolConfiguration(conPool)
    .withConnectionPoolMonitor(new CountingConnectionPoolMonitor())
    .buildKeyspace(ThriftFamilyFactory.getInstance()); 
```

完整的堆栈跟踪：

```
ERROR com.s1mbi0se.dg.input.service.InputService (main): EXCEPTION:OperationTimeoutException: [host=ec2-xx-xxx-xx-xx.compute-1.amazonaws.com(10.100.6.242):9160, latency=10004(10004), attempts=1]TimedOutException()

com.netflix.astyanax.connectionpool.exceptions.OperationTimeoutException: OperationTimeoutException: [host=ec2-54-224-65-18.compute-1.amazonaws.com(10.100.6.242):9160, latency=10004(10004), attempts=1]TimedOutException()
    at com.netflix.astyanax.thrift.ThriftConverter.ToConnectionPoolException(ThriftConverter.java:171)
    at com.netflix.astyanax.thrift.AbstractOperationImpl.execute(AbstractOperationImpl.java:61)
    at com.netflix.astyanax.thrift.ThriftColumnFamilyQueryImpl$1$2.execute(ThriftColumnFamilyQueryImpl.java:206)
    at com.netflix.astyanax.thrift.ThriftColumnFamilyQueryImpl$1$2.execute(ThriftColumnFamilyQueryImpl.java:198)
    at com.netflix.astyanax.thrift.ThriftSyncConnectionFactoryImpl$ThriftConnection.execute(ThriftSyncConnectionFactoryImpl.java:151)
    at com.netflix.astyanax.connectionpool.impl.AbstractExecuteWithFailoverImpl.tryOperation(AbstractExecuteWithFailoverImpl.java:69)
    at com.netflix.astyanax.connectionpool.impl.AbstractHostPartitionConnectionPool.executeWithFailover(AbstractHostPartitionConnectionPool.java:253)
    at com.netflix.astyanax.thrift.ThriftColumnFamilyQueryImpl$1.execute(ThriftColumnFamilyQueryImpl.java:196)
    at com.s1mbi0se.dg.input.service.InputService.searchUserByKey(InputService.java:833)
    at org.apache.hadoop.mapreduce.Mapper.run(Mapper.java:144)
    at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:771)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:375)
    at org.apache.hadoop.mapred.Child$4.run(Child.java:255)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:396)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1132)
    at org.apache.hadoop.mapred.Child.main(Child.java:249)
Caused by: TimedOutException()
    at org.apache.cassandra.thrift.Cassandra$get_slice_result.read(Cassandra.java:7874)
    at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:78)
    at org.apache.cassandra.thrift.Cassandra$Client.recv_get_slice(Cassandra.java:594)
    at org.apache.cassandra.thrift.Cassandra$Client.get_slice(Cassandra.java:578)
    at com.netflix.astyanax.thrift.ThriftColumnFamilyQueryImpl$1$2.internalExecute(ThriftColumnFamilyQueryImpl.java:211)
    at com.netflix.astyanax.thrift.ThriftColumnFamilyQueryImpl$1$2.internalExecute(ThriftColumnFamilyQueryImpl.java:198)
    at com.netflix.astyanax.thrift.AbstractOperationImpl.execute(AbstractOperationImpl.java:56) 
```

所以我不知道解决这个问题的方向是什么，因为问题可能出在 Astyanax 池配置、EC2 机器配置（内存增加？）、Priam 配置或 AWS 上 Cassandra 或 EMR 服务所需的其他配置在我的代码中......任何提示？

* * *

遵循堆栈跟踪：

```
INFO org.apache.hadoop.mapred.TaskLogsTruncater (main): Initializing logs' truncater with mapRetainSize=-1 and reduceRetainSize=-1
WARN org.apache.hadoop.mapred.Child (main): Error running child
java.lang.RuntimeException: InvalidRequestException(why:Start key's token sorts after end token)
    at org.apache.cassandra.hadoop.ColumnFamilyRecordReader$WideRowIterator.maybeInit(ColumnFamilyRecordReader.java:453)
    at org.apache.cassandra.hadoop.ColumnFamilyRecordReader$WideRowIterator.computeNext(ColumnFamilyRecordReader.java:459)
    at org.apache.cassandra.hadoop.ColumnFamilyRecordReader$WideRowIterator.computeNext(ColumnFamilyRecordReader.java:406)
    at com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:143)
    at com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:138)
    at org.apache.cassandra.hadoop.ColumnFamilyRecordReader.getProgress(ColumnFamilyRecordReader.java:103)
    at org.apache.hadoop.mapred.MapTask$NewTrackingRecordReader.getProgress(MapTask.java:522)
    at org.apache.hadoop.mapred.MapTask$NewTrackingRecordReader.nextKeyValue(MapTask.java:547)
    at org.apache.hadoop.mapreduce.MapContext.nextKeyValue(MapContext.java:67)
    at org.apache.hadoop.mapreduce.Mapper.run(Mapper.java:143)
    at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:771)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:375)
    at org.apache.hadoop.mapred.Child$4.run(Child.java:255)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:396)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1132)
    at org.apache.hadoop.mapred.Child.main(Child.java:249)
Caused by: InvalidRequestException(why:Start key's token sorts after end token)
    at org.apache.cassandra.thrift.Cassandra$get_paged_slice_result.read(Cassandra.java:14168)
    at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:78)
    at org.apache.cassandra.thrift.Cassandra$Client.recv_get_paged_slice(Cassandra.java:769)
    at org.apache.cassandra.thrift.Cassandra$Client.get_paged_slice(Cassandra.java:753)
    at org.apache.cassandra.hadoop.ColumnFamilyRecordReader$WideRowIterator.maybeInit(ColumnFamilyRecordReader.java:438)
    ... 
INFO org.apache.hadoop.mapred.Task (main): Runnning cleanup for the task 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T13:16:30.587

我们解决了这个问题（院长，我在 Cassandra 用户组上回答了这个问题，但我会再次说明我们在这里为解决问题所做的工作）

*   首先我们将 Cassandra 更新为 1.2.3 版本
*   更新 Cassandra 后，启动了一个新异常“没有可借用的主机”，我们发现命令“ConnectionPoolConfigurationImpl(...).setConnectTimeout(-1)”是原因...
*   我们把 .setConnectTimeout(2000)
*   我们增加了 Astyanax 池中的其他值，我们的应用程序终于工作了......

基本上我认为我们最初的问题是亚马逊延迟太高，所以我们改变了我们的池配置并且一切正常......

感谢所有人的帮助（主要是院长）！

在我们在 Amazon 上运行的实际池配置下方：

```
new ConnectionPoolConfigurationImpl(getConecPoolName())
.setMaxConnsPerHost(CONNECTION_POOL_SIZE_PER_HOST)
.setSeeds(getIpSeeds())
    .setMaxOperationsPerConnection(10000) 
    .setMaxPendingConnectionsPerHost(20) 
    .setConnectionLimiterMaxPendingCount(20)    
        .setTimeoutWindow(10000) 
    .setConnectionLimiterWindowSize(2000)
    .setMaxTimeoutCount(3) 
    .setConnectTimeout(100) 
    .setConnectTimeout(2000)
    .setMaxFailoverCount(-1) 
    .setLatencyAwareBadnessThreshold(20)
    .setLatencyAwareUpdateInterval(1000) // 10000
    .setLatencyAwareResetInterval(10000) // 60000
    .setLatencyAwareWindowSize(100) // 100
    .setLatencyAwareSentinelCompare(100f)                      .setSocketTimeout(30000)
    .setMaxTimeoutWhenExhausted(10000)
    .setInitConnsPerHost(10)
        ;

AstyanaxContext<Keyspace> context = new AstyanaxContext.Builder().forCluster(clusterName).forKeyspace(keyspaceName)
                .withAstyanaxConfiguration(new AstyanaxConfigurationImpl().setDiscoveryType(NodeDiscoveryType.NONE).setConnectionPoolType(ConnectionPoolType.ROUND_ROBIN).setDiscoveryDelayInSeconds(10000)
        .setDiscoveryDelayInSeconds(10000))
        .withConnectionPoolConfiguration(conPool)
            .withConnectionPoolMonitor(new CountingConnectionPoolMonitor())
        .buildKeyspace(ThriftFamilyFactory.getInstance()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:02:15.883

那么，如果将超时设置为 -1 会发生什么？就个人而言，我会深入研究 astyanax 代码并尝试找出如何禁用超时。再次运行你的东西，它应该会继续运行，尽管如果你遇到超时，你的集群当然可能会受到重创......我假设你对此没问题。

编辑（后期编辑后）：拍摄，我忘了问你使用的是哪个版本的 cassandra。我正在查看此代码，但第 346 行是您的第 438 行（您正在使用 Widerow 迭代器，这很可能意味着行扫描（即行的片段）。

[http://grepcode.com/file/repo1.maven.org/maven2/org.apache.cassandra/cassandra-all/1.2.2/org/apache/cassandra/hadoop/ColumnFamilyRecordReader.java#ColumnFamilyRecordReader.0split](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.cassandra/cassandra-all/1.2.2/org/apache/cassandra/hadoop/ColumnFamilyRecordReader.java#ColumnFamilyRecordReader.0split)

我们至少可以在其中看到这是一个键范围，但由于行可能太宽而分页（对于内存来说，对于不太宽的行还有另一个迭代器）。我相信您是正确的，您不能使用两种分区器类型。要获得有关此的更多信息，我强烈建议修改 ColumnFamilyRecordReader.java 以记录 ColumnFamilySplit（它上面有一个 toString）。您可以在初始化方法中记录它，也可以记录 JobRange（它也有一个 toString ）。

IE。

```
logger.warn("my split range="+split+" job's total range="+jobRange); 
```

您的版本将与此代码有很多相似之处。你在哪个版本？

除了拆分之外，我还将记录 KeySlice，以防万一，如果我没记错的话，任何一个都可能导致该错误。让我知道您使用的版本并添加一些日志以获取有关您情况的更多信息。（他们的东西通常很容易开箱即用地编译，没有问题）。

院长

# html - 使用 php 包含在 html 文件中

> ID：16041729
> 
> 赞同：2
> 
> 时间：2013-04-16T16:00:36.450
> 
> 标签：html, php-include

我在使用一些 php 代码的网站上遇到了一些问题。
我的网站主要使用 html 和 php。我没有在每个页面的顶部重复很多行脚本，而是使用 php include 语句：

```
<?php include('main.php'); ?> 
```

我的网站上有一个本地 WAMP 服务器和混合的 html 和 php 文件。
当我在本地运行所有内容时，它都运行得很好，并且“包含”语句有效。
但是，当我将所有内容上传到托管在 goDaddy 上的网站时，include 语句仅适用于 .php 文件。如果我在 .html 文件中使用它，它会失败。它只是不包括任何东西。

我看过一些帖子说这可以通过使用 .htaccess 文件来解决。目前我的网站上没有。我确实尝试将一个上传到根目录，但唯一的影响是当我单击一个页面时它显示一个“另存为”对话框。
我猜要么我的语法错误，要么我走错了路来解决这个问题。

下面是我的 .htaccess 文件的内容。关于如何让 include 语句在 .html 文件中工作的任何想法都会很棒。谢谢。

```
#
# Server root folder www .htaccess
# This file provides server security limiting access to the localhost only.
# Comment next four lines to deactivate. (Allows external access)
#

# Order Deny,Allow
# Deny from all
# Allow from 127.0.0.1
# Allow from ::1
AddType application/x-httpd-php .html .php .htm

# To allow execution of cgi scripts in this directory uncomment next two lines.

# AddHandler cgi-script .pl .cgi
# Options +ExecCGI +FollowSymLinks

# Activate this section to use the Private Server Feature!
# Defaults: Username - root; Password - root
# Note AuthUserFile: File path is relative to server root
# To lock server, uncomment the next 4 lines. (A name and password is required)

#AuthName "Uniform Server - Server Access"
#AuthType Basic
#AuthUserFile ../../../htpasswd/www/.htpasswd
#Require valid-user 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:05:04.123

尝试使用这个：

```
AddHandler x-httpd-php5-cgi .html 
```

见这里：[http ://httpd.apache.org/docs/2.2/mod/mod_mime.html#addhandler](http://httpd.apache.org/docs/2.2/mod/mod_mime.html#addhandler)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T16:05:18.387

您所要做的就是将您包含的所有文件更改为**.php**文件。它不会对它们产生负面影响，只是浏览器会知道将其解释为 php.ini 文件。

您的所有格式仍然有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T16:03:59.693

如果您`<?php include ... ?>`在 HTML 文件中使用，它将不起作用。原因？如果文件有`.html`扩展名，浏览器不会期待 PHP，所以它不会做任何事情。如果您在任何文件中有任何 PHP 代码，请给该文件一个`.php`扩展名。（除非你有特定的理由不这样做......？）

# c# - Linq to SQL - 以表格形式加载数据然后保存

> ID：16041732
> 
> 赞同：0
> 
> 时间：2013-04-16T16:00:39.170
> 
> 标签：c#, winforms, linq-to-sql

我在弄清楚如何做一些看起来很简单的事情时遇到了一些麻烦，但是在提交更改时需要一些帮助来确定我哪里出错了。此 Windows 窗体的基本前提是查询数据库以获取有关窗体加载的特定信息，然后将其加载以进行任何需要进行的更改。

它加载得很好，我仔细检查以确保有一个主键（它是），但由于某种原因它不会保存。tkts.Log = Console.Out; 单击保存按钮时甚至不显示任何内容。我是一名初学者程序员，正在尝试 Linq to SQL，所以如果有什么问题，请提供指点。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using TicketLogger;

namespace TicketLogger
{
    public partial class TicketInfo : Form
    {
        ITDataClassesDataContext tkts = new ITDataClassesDataContext();
        private Int32 ticket_id = 0;

        public TicketInfo(Int32 TicketID = 0)
        {
            InitializeComponent();
            //Set local TicketID variable for use on load
            ticket_id = TicketID;
        }

        private void tBL_TICKET_HDRBindingNavigatorSaveItem_Click(object sender, EventArgs e)
        {
            //Save the new ticket to the database
            //I think the object Tickets contains the changes, not tkts, but how to access?
                try
                {
                    tkts.Log = Console.Out;
                    tkts.SubmitChanges();
                    tkts.Log.Close();
                }
                catch (Exception m)
                {
                    MessageBox.Show(m.ToString());
                }
        }

        private void TicketInfo_Load(object sender, EventArgs e)
        {

            tkts.Log = Console.Out;
            //Get the ticket ID and retrieve information
            var Ticket = from objTkts in tkts.TBL_TICKET_HDRs
                         where objTkts.TICKET_ID == ticket_id
                         select objTkts;
            this.tBL_TICKET_HDRBindingSource.DataSource = Ticket;
            tkts.Log.Close();

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T13:55:51.287

我发现为什么它不会更新。我从来没有向它传递任何数据。我在提交更改之前在 try 块中添加了此代码，并且它接受了它。

```
 TBL_TICKET_HDR tkthdr = tkts.TBL_TICKET_HDRs.Single(t => t.TICKET_ID == ticket_id);
            tkthdr.ISSUE_DESC = iSSUE_DESCTextBox.Text; 
```

出于某种原因，我只是希望代码“知道”表单上的控件应该放在哪里。

# mysql - 错误 1093。您不能在 FROM 子句中指定目标表“ps_order_history”进行更新

> ID：16041740
> 
> 赞同：0
> 
> 时间：2013-04-16T16:01:01.247
> 
> 标签：mysql, mysql-error-1093

我一直在寻找，但我仍然不明白为什么它是错误的。我检查了子查询，它们只返回 1 行。

```
UPDATE ps_order_history

SET id_order_state = 18

WHERE id_order = 
(
    SELECT max(p.id_order)
    FROM ps_orders p
    INNER JOIN ps_order_detail d ON d.id_order = p.id_order
    INNER JOIN ps_order_history oh ON oh.id_order = p.id_order
    WHERE d.product_name = "Academia Mastermaq" 

    AND p.id_customer = 
    (
        SELECT id_customer
        FROM ps_customer
        WHERE firstname = "Cristiano"
        AND lastname = "Ferreira dos Santos"
        LIMIT 1
    )
)

Error Code: 1093\. You can't specify target table 'ps_order_history' 
for update in FROM clause 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:14:21.420

现在我知道我不能在子查询中加入我的更新表。感谢[马克 B](https://stackoverflow.com/users/118068/marc-b)！

```
UPDATE ps_order_history h
INNER JOIN ps_order_detail d ON d.id_order = h.id_order

SET h.id_order_state = 15

WHERE d.product_name = "Academia Mastermaq" 
AND h.id_order = 
(
    SELECT max(p.id_order)
    FROM ps_orders p
    /*INNER JOIN ps_order_detail d ON d.id_order = p.id_order
    INNER JOIN ps_order_history oh ON oh.id_order = p.id_order*/

    WHERE p.id_customer = 
    (
        SELECT id_customer
        FROM ps_customer
        WHERE firstname = "Cristiano"
        AND lastname = "Ferreira dos Santos"
        LIMIT 1
    )
) 
```

# asp.net - 将表添加到 Elmah 错误详细信息视图

> ID：16041748
> 
> 赞同：1
> 
> 时间：2013-04-16T16:01:24.793
> 
> 标签：asp.net, asp.net-mvc, logging, elmah

我刚刚开始在 ASP.NET MVC 项目中使用 Elmah。我想知道是否有办法将新表添加到错误详细信息视图中，例如来自服务器变量的表。我知道如何使用以下方法将一些额外的数据添加到日志中：

```
Exception newEx = new Exception("Preview Error\n"+ article.ExceptionString(),e);
Elmah.ErrorSignal.FromCurrentContext().Raise(newEx); 
```

但我有兴趣添加一个带有我的局部变量的自定义表，比如这个。 ![在此处输入图像描述](https://i.stack.imgur.com/oL4OC.png)

# cordova - Jquery Mobile NO_FAST_DRAW = FALSE

> ID：16041751
> 
> 赞同：1
> 
> 时间：2013-04-16T16:01:31.040
> 
> 标签：cordova, jquery-mobile

我正在为 JQM 1.3 和 Phonegap 2.5 在 ICS 4.0.4 上开发应用程序。

我正在展示一些动态列表视图，大约 50 个项目会在 html 页面中产生滚动。当我在非滚动项目上单击/点击时，事件会很好地触发，但是当我滚动页面并执行相同操作时，事件不会触发，直到我滚动到页面顶部。

在每次点击/点击中，我都会收到相同的消息：

```
04-16 17:53:02.843: V/webview(31651): NO_FAST_DRAW = false
04-16 17:53:03.656: V/webview(31651):  singleCursorHandlerTouchEvent -getEditableSupport FASLE 
```

我已经尝试了这个论坛的一些解决方案，但没有！

请帮忙...

谢谢

# c - 如何使用 sigsuspend

> ID：16041754
> 
> 赞同：11
> 
> 时间：2013-04-16T16:01:36.670
> 
> 标签：c

我有这段代码，我必须让程序块反复等待信号。我的老师希望我们使用 sigsuspend 和 mask 而不是暂停或睡眠。我不熟悉 sigsuspend 或掩码，我知道 sigsuspend() 用掩码给出的掩码临时替换调用进程的信号掩码，然后暂停进程，直到传递一个信号，其动作是调用信号处理程序或终止进程。但是我该如何实现它。

```
#include <stdlib.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>
#include <sys/types.h>

unsigned Conta = 0;

void mypause(int sign)
{
    switch (sign)
    {
        case SIGINT:
            printf("You've pressed ctrl-C\n");
            printf("I'm running waiting for a signal...\n");
            Conta++;
            break;

        case SIGQUIT:
            printf("You've pressd ctrl-\\n");
            printf("Number of times you've pressed CTRL-C: %d", Conta); 
            exit(0);
            break;
    }
}

int main()
{
    alarm(3);
    printf("I'm Alive\n");

    signal(SIGINT, mypause);
    signal(SIGQUIT, mypause);
    printf("I'm running, waiting for a signal...\n");
    while (1)
    {
    }

    return (0);
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-16T16:14:43.487

开始的简单方法是`sigsuspend`使用空掩码调用（即任何信号都可以唤醒程序）：

```
sigset_t myset;
(void) sigemptyset(&myset);
while (1) {
    (void) printf("I'm running, waiting for a signal...\n");
    (void) sigsuspend(&myset);
} 
```

下一步是`sigprocmask`用来禁止两个已处理信号 (`SIGINT`和`SIGQUIT`) 的发生，而不是在`sigsuspend`. 然后，您将在挂起时使用从中获得的“旧掩码”`sigprocmask`而不是空掩码。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-16T16:11:03.097

[GNU libc 手册](http://www.gnu.org/software/libc/manual/html_node/Sigsuspend.html)的描述似乎清晰透彻：

> 功能： int sigsuspend (const sigset_t *set)
> 
> 该函数用 set 替换进程的信号掩码，然后暂停进程，直到传递一个信号，该信号的动作是终止进程或调用信号处理函数。换句话说，程序被有效地挂起，直到不是集合成员的信号之一到达。
> 
> 如果通过传递调用处理函数的信号唤醒进程，并且处理函数返回，则 sigsuspend 也返回。
> 
> 仅当 sigsuspend 处于等待状态时，掩码才会保持设置。函数 sigsuspend 总是在返回时恢复之前的信号掩码。
> 
> 返回值和错误条件与暂停相同。
> 
> 使用 sigsuspend，您可以用完全可靠的东西替换上一节中的暂停或睡眠循环：
> 
> ```
>  sigset_t mask, oldmask;
> 
>  ...
> 
>  /* Set up the mask of signals to temporarily block. */
>  sigemptyset (&mask);
>  sigaddset (&mask, SIGUSR1);
> 
>  ...
> 
>  /* Wait for a signal to arrive. */
>  sigprocmask (SIG_BLOCK, &mask, &oldmask);
>  while (!usr_interrupt)
>    sigsuspend (&oldmask);
>  sigprocmask (SIG_UNBLOCK, &mask, NULL); 
> ```
> 
> 最后一段代码有点棘手。这里要记住的关键点是，当 sigsuspend 返回时，它将进程的信号掩码重置为原始值，即调用 sigsuspend 之前的值——在这种情况下，SIGUSR1 信号再次被阻塞。对 sigprocmask 的第二次调用是显式解除阻塞此信号所必需的。
> 
> 还有一点：您可能想知道为什么需要 while 循环，因为程序显然只等待一个 SIGUSR1 信号。答案是传递给 sigsuspend 的掩码允许通过传递其他类型的信号（例如作业控制信号）唤醒进程。如果进程被未设置 usr_interrupt 的信号唤醒，它只会再次挂起自己，直到“正确”类型的信号最终到达。
> 
> 这种技术需要多做几行准备，但对于您要使用的每种等待标准，只需要一次。实际等待的代码只有四行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-04-26T20:25:21.733

-通过使用 sigsuspend() API，进程可以暂停其执行，直到从一组信号中传递出任何一个信号。

*   等待信号的干净可靠的方法是阻止它，然后使用 sigsuspend。

*   通过在循环中使用 sigsuspend，可以等待某种信号，同时允许其他类型的信号由其处理程序处理。

*   它允许进程暂停其执行，直到接收到一个不存在于掩码指向的集合中的信号。

*   语法：int sigsuspend(sigset_t *mask);

*   它暂时用新的掩码替换进程当前掩码，并在信号处理程序返回后恢复。

*   由于 sigsuspend() 无限期地暂停线程执行，因此没有成功完成返回值，失败时返回 -1。

该程序确保程序在临界区执行时阻塞 SIGKILL 和 SIGTERM 信号，并在发出 SIGINT 信号并执行其相应的信号处理程序后恢复执行 */

```
 #include <stdio.h>
     #include <string.h>
     #include <errno.h>
     #include <signal.h>

     int cs = 0;
     int value = 5;

     /* This is the function called on receipt of signal(cntl+c) */
     void sig_handler (int sig)
     {
        printf("\n This is signal handler for signal %d\n", sig);
        cs =1;
     }

    int main()
    {
        struct sigaction act;
        act.sa_handler = sig_handler;
        sigemptyset (&act.sa_mask);
        sigaddset (&act.sa_mask, SIGPIPE);
        act.sa_flags = 0;

        sigset_t sig_term_kill_mask;
        sigaddset (&sig_term_kill_mask, SIGTERM);
        sigaddset (&sig_term_kill_mask, SIGKILL);

        sigaction (SIGINT, &act, NULL);

        /* Critical section */
        value++;
        printf ("\n Value is %d\n", value);
        while (cs == 0)
            sigsuspend (&sig_term_kill_mask);

        printf("\n Return from suspended successful\n");
        int ret = sigismember (&act.sa_mask, SIGPIPE);
        if (ret)
            printf("\n Old Mask that is SIGPIPE is restored after return from sigsuspend\n");
        else
            printf("\n Old Mask that is SIGPIPE failed to restored after return from sigsuspend\n");

         return 0; } 
```

**输出：**

gcc sigsuspend.c

./a.out

值为 6 ^C 这是信号 2 的信号处理程序

从暂停成功返回

从 sigsuspend 返回后恢复作为 SIGPIPE 的旧掩码

# php - MY_Model 指定的数据库在 MY_Controller 中不起作用

> ID：16041756
> 
> 赞同：0
> 
> 时间：2013-04-16T16:01:49.207
> 
> 标签：php, codeigniter

我正在开发一个多站点系统，该系统具有“站点管理器”数据库，然后是每个站点的数据库。

为了决定应该加载的站点数据库以及设置一些其他配置内容，我已经实现了 MY_Controller 以在我们到达任何主控制器之前从站点管理器数据库加载信息。

我已经设置了几个模型来使用 sitemanager 数据库，为此我简单地包括了

```
public function __construct()
{       
    $this->_db_group = 'sitemanager';
    parent::__construct();
} 
```

在模型声明的顶部，然后在我的 database.php 中指定站点管理器设置

当我从标准控制器调用模型时，此方法工作正常，我已经设置了一个登录页面来处理 sitemanager 数据库中的一个表，这工作正常，但是，当我尝试使用调用 sitemanager 数据库的模型时从 MY_Controller 中它不起作用，并且我收到“表 'translation.domains' 不存在”的错误消息，这很明显是在尝试加载我的默认数据库而不是站点管理器。

谁能告诉我我做错了什么？为什么站点管理器数据库的设置被忽略？

MY_Controller.php 看起来像这样：

```
<?php
class MY_Controller extends CI_Controller {

function MY_Controller() {

    parent::__construct();

    $this->load->model('company_model');

    // Get domain and load info from database
    $domain_info = $this->domain_model->get_by(array('domain' => $_SERVER['HTTP_HOST']));

    // Company info
    $company_info = $this->company_model->get($domain_info->company_id);

    // Set global variables
    define('GLOBAL_COMPANY_ID',$company_info->id);
    define('GLOBAL_COMPANY_NAME',$company_info->name);
    }
} 
```

域模型如下所示：

```
class Domain_model extends MY_Model {

    public function __construct()
    {
        $this->_db_group = 'sitemanager';
        parent::__construct();
    }

} 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T09:00:39.440

我解决了这个问题，以防其他人遇到同样的事情。

我将域模型加载移回 MY_Controller 而不是自动加载它。**直到我将域模型的负载移到公司模型下方**（公司模型使用默认数据库），这仍然不起作用，然后一切正常。

# regex - 从 bash 3.2 到 bash 4 的正则表达式匹配（解析来自 sql 的输出）

> ID：16041762
> 
> 赞同：0
> 
> 时间：2013-04-16T16:02:13.687
> 
> 标签：regex, bash, bash4

$SQL_RESULT 通常是这样的：

```
TDM_PROC
-------------------------------------------------------------------
N 
```

我需要从中提取最后一个单词（在本例中为 N）。

在 bash 3.2 中，我使用了这个表达式：

```
if [[ $SQL_RESULT =~ "(\w+)$" ]] ; then
  RES=${BASH_REMATCH[1]}
else
  echo "Error" > $LOG_FILE
  exit 1
fi 
```

我发现在 bash 4 中我不应该使用引号，但它仍然不起作用

```
if [[ $SQL_RESULT =~ (\w+)$ ]] ; then
  RES=${BASH_REMATCH[1]}
else
  echo "Error" > $LOG_FILE
  exit 1
fi 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:31:15.707

使用以下 BASH shell 选项：

```
shopt -s compat31 
```

允许在正则表达式匹配中引用。使用上述选项集，您可以按照通常的方式进行操作：

```
if [[ $SQL_RESULT =~ "([A-Za-z0-9_]+)$" ]] ; then
  RES=${BASH_REMATCH[1]}
else
  echo "Error" > $LOG_FILE
  exit 1
fi 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:58:37.487

以下对我有用`bash 4.0`。请注意，我曾经`$'\n'`在组之前指定换行符`(..)`。另外，我替换`\w`为`.`

```
 if [[ $SQL_RESULT =~ ^.*$'\n'(.+?)$ ]]; then RES=${BASH_REMATCH[1]}; else echo ' 
```

不'; 菲

```
echo $RES
N 
```

# jboss6.x - JBoss 6 - 战争部署

> ID：16041767
> 
> 赞同：-1
> 
> 时间：2013-04-16T16:02:29.100
> 
> 标签：jboss6.x

大家。我在以下情况下工作：

*   Eclipse Helios 服务版本 2
*   老板6
*   JDK 6

我观察到 JBoss 将“ *war* ”文件部署在名为“ *temp* ”（`C:\JBOSS_6\jboss-6.0.0.Final\server\default\tmp`）的临时目录中。每次重置 JBoss 时，部署的位置都会更改（在“ *temp* ”目录中）。结果，应用程序找不到要读取的文本文件。

当应用程序尝试访问该文件时，会显示以下错误：

> "C:\JBOSS_6\jboss-6.0.0.Final\server\default\deploy\ScadaJ2eeWeb.war\WEB-INF\classes\es\indra\transporte\central\j2ee\core\resources\config_0000_ESTACION.properties (El sistema no puede encontrar la ruta especificada)"

我检查了文件文本是否包含在战争文件中（将其解压缩为 zip 文件）。

有没有什么方法可以配置JBOSS（或者用Eclipse生成war文件的方法），让JBoss总是把war文件部署在同一个目录下（在本例中是路径“ `C:\JBOSS_6\jboss-6.0.0.Final\server\default\deploy\ScadaJ2eeWeb.war\`”）？

非常感谢您提前。

我正在使用绝对路径来读取文件。我需要阅读这个文件来生成另一个。最后一个与第一个相同，但只有一行。我执行以下句子序列：

```
private static final String NAME_FILE_PROP_STAT = "config_0000_ESTACION.properties";
ClassLoader classLoader = BackingUploadMonitoringMaps.class.getClassLoader();
urlResource = classLoader.getResource("es/indra/transporte/central/j2ee/core/resources/" + NAME_FILE_PROP_STAT);
File originalFile = new File(urlResource.getFile());
// I use this class to read the file and generate the other one (changing a certain line) 
Scanner scan = new Scanner(originalFile); 
```

当最后一句话被调用时，我得到了我之前提到的错误

```
"C:\JBOSS_6\jboss-6.0.0.Final\server\default\deploy\ScadaJ2eeWeb.war\WEB-INF\classes\es\indra\tran 
```

sporte\central\j2ee\core\resources\config_0000_ESTACION.properties (El sistema no puede encontrar la ruta especificada)"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-17T13:32:30.280

不需要知道 WAR 解压到哪里。只需使用

```
InputStream stream = classLoader.getResourceAsStream("..."); 
```

并从流中读取文件。`java.util.Scanner`也可以将流作为输入，因此无需更改任何其他内容。

# php - 使用 Eventbrite PHP API 列出公共事件

> ID：16041768
> 
> 赞同：1
> 
> 时间：2013-04-16T16:02:34.723
> 
> 标签：php, api, eventbrite

我可以使用 Eventbrite PHP API 和这个[示例事件列表代码](https://github.com/ryanjarvinen/eventbrite.php/blob/master/examples/event-list-example.php)来显示我的事件列表。这是提供身份验证的方式：

```
$authentication_tokens = array('app_key' => 'YOUR_APP_KEY',
                               'user_key' => 'YOUR_USER_KEY'); 
```

我从 Eventbrite 文档中了解到，您可以通过不提供身份验证令牌来优化列表以仅显示公共事件。但是，如果我排除：

```
,'user_key' => 'YOUR_USER_KEY' 
```

我收到以下错误消息：

```
Fatal error: Uncaught exception 'Exception' with message 'Invalid email address . [None]'.... 
```

谁能建议如何通过不提供身份验证令牌来仅显示 eventbrite 公共事件？

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:56:49.110

*您正在使用的 API 调用按用户*查找事件：

[http://developer.eventbrite.com/doc/users/user_list_events/](http://developer.eventbrite.com/doc/users/user_list_events/)

通过不提供`user_key`or`user`字段（这是用户的电子邮件），它实际上没有任何意义。

如果您想获取公共事件的列表，可以使用`event_search`API：

[http://developer.eventbrite.com/doc/events/event_search/](http://developer.eventbrite.com/doc/events/event_search/)

`curl http://www.eventbrite.com/json/event_search -G -d app_key=$EB_APP_KEY`

所有字段都是可选的，因此通过省略所有字段，您可以有效地获得公共事件的列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T11:23:24.223

对于其他想要实现相同目标的人，我想我会列出一些示例代码：

```
<!DOCTYPE HTML>
<html>
<head>
  <title>Eventbrite</title>

 <meta charset="UTF-8">

 </head>
 <body>

 <?php
 // load the API Client library
 include "eventbrite.php";

 // Initialize the API client
 // Eventbrite API / Application key (REQUIRED)
 // http://www.eventbrite.com/api/key/
 // Eventbrite user_key (OPTIONAL, only needed for reading/writing private user data)
 // http://www.eventbrite.com/userkeyapi
 $authentication_tokens = array('app_key' => 'YOURAPPKEYGOESHERE',
                                'user_key' => 'YOURUSERKEYGOESHERE');
 $eb_client = new Eventbrite( $authentication_tokens );

 // For more information about the features that are available through the Eventbrite API, see      http://developer.eventbrite.com/doc/
 // $events = $eb_client->user_list_events();

 $search_params = array(
     'organizer' => 'YOURORGANISERNAMEGOESHERE',
     'sort_by' => 'date',
 );
 $resp = $eb_client->event_search( $search_params );

 //mark-up the list of events that were requested
 // render in html - ?>
 <style type="text/css">
 .eb_event_list_item{
   padding-top: 20px;
 }
 .eb_event_list_title{
   position: absolute;
   left: 300px;
   width: 300px;
   overflow: hidden;
 }
 .eb_event_list_date{
   padding-left: 20px;
 }
 .eb_event_list_time{
   position: absolute;
   left: 200px;
 }
 .eb_event_list_location{
   position: absolute;
   left: 620px;
 }
 </style>

 <h1>My Event List:</h1>
 <?= Eventbrite::eventList( $resp, 'eventListRow'); ?>  

 </body>
 </html> 
```

如果要更改返回数据的方式，请编辑 eventbrite.php 页面。例如，我想在日期中包含年份，所以我编辑了第 258 行，将 strftime 更改为

```
 strftime('%a, %e, %B, %Y', $time) 
```

希望这可以帮助某人:)

# python - 在python中找到最小值的行和列？

> ID：16041772
> 
> 赞同：1
> 
> 时间：2013-04-16T16:02:53.580
> 
> 标签：python

我的程序中有一个函数可以进行拆分和浮动。然后将矩阵传递给主程序。现在我有一个函数可以找到最小值的行和列。我得到了所有值的列表，但没有得到最小值的行和列。

```
def closest_pair(e):
    for row in range(len(e)):
       for col in range(0,len(row),1):
          minrow = min(e[row])
          mincol = min(e[col])
          return ([minrow], [mincol]) 
```

E 是从 main 传递给此函数的方阵。输入是具有如下值的 txt 文件：

```
2 1 7 7
1 2 7 7
2 5 6 7
5 6 8 9 
```

预期的输出应该是 (1, 1) 或第 1 行和第 1 列，它在矩阵中具有较低的值。

这帮助我找到了行和列的最小值，但是输出是得到这对。同样对于第一个值为 0 的值，0 将不计入，因此如果 (0, 0) 的值为 0，则不算作最小值。话虽如此，例如，如果第 1 行和第 1 列，值是 [2,2] 作为对，并且是唯一比输出 (1,1) 的最小对。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:07:42.020

*您需要找到每行*的最小值，然后才能确定具有最小列的行的坐标：

```
result = min((min((v, c) for c, v in enumerate(row)), r) for r, row in enumerate(e))
return result[1], result[0][1] 
```

此代码用于使用`enumerate()`列索引注释每个值，找到每行的*最小值*，用行号（再次使用`enumerate`）注释每行最小值并找到最小行。结果是一个带有 的嵌套元组`((value, column), row)`，我们将其解包以返回行和列索引。

演示：

```
>>> e = [[2, 1, 7, 7], [1, 2, 7, 7], [2, 5, 6, 7], [5, 6, 8, 9]]
>>> result = min((min((v, c) for c, v in enumerate(row)), r) for r, row in enumerate(e))
>>> result[0][1], result[1]
(0, 1) 
```

所以位置`e[0][1]`是矩阵中*的*最小值。如果您还想包含该位置的确切值，请返回：

```
return result[1], result[0][1], result[0][0] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:09:35.720

`e`是一个列表，对吗？

因此`min(e[row])`，并且`min(e[col])`会给你列表。

[您还可以使用enumerate](http://docs.python.org/2/library/functions.html#enumerate)更轻松地遍历列表

```
for col, row in enumerate(e):
  minrow = min(row)
  mincol = min([row[col] for row in e]) # need to transpose to a new list
  return ([minrow], [mincol]) 
```

# java - servlet api 3.0 jar 中缺少异步方法？

> ID：16041773
> 
> 赞同：4
> 
> 时间：2013-04-16T16:02:53.727
> 
> 标签：java, asynchronous, servlet-3.0

我正在开发一个必须异步处理请求的 servlet 3.0 应用程序。

编译失败并出现

```
cannot find symbol
symbol  : method startAsync(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)
location: interface javax.servlet.http.HttpServletRequest 
```

信息。

我的**pom.xml**中有以下依赖项：

```
<dependency>
    <groupId>javax</groupId>
    <artifactId>javaee-web-api</artifactId>
    <version>6.0</version>
</dependency> 
```

有趣的是，**导入 javax.servlet.AsyncContext**成功了。但是当我列出**javax.servlet.ServletRequest**的方法时，3.0 API 中没有处理异步请求的方法。

```
public abstract java.lang.String javax.servlet.ServletRequest.getScheme()
public abstract java.lang.String javax.servlet.ServletRequest.getProtocol()
public abstract javax.servlet.ServletInputStream javax.servlet.ServletRequest.getInputStream() throws java.io.IOException
public abstract int javax.servlet.ServletRequest.getContentLength()
public abstract java.lang.Object javax.servlet.ServletRequest.getAttribute(java.lang.String)
public abstract java.lang.String javax.servlet.ServletRequest.getContentType()
public abstract java.util.Locale javax.servlet.ServletRequest.getLocale()
public abstract java.util.Enumeration javax.servlet.ServletRequest.getAttributeNames()
public abstract java.lang.String javax.servlet.ServletRequest.getCharacterEncoding()
public abstract void javax.servlet.ServletRequest.setCharacterEncoding(java.lang.String) throws java.io.UnsupportedEncodingException
public abstract java.lang.String javax.servlet.ServletRequest.getParameter(java.lang.String)
public abstract java.util.Enumeration javax.servlet.ServletRequest.getParameterNames()
public abstract java.lang.String[] javax.servlet.ServletRequest.getParameterValues(java.lang.String)
public abstract java.util.Map javax.servlet.ServletRequest.getParameterMap()
public abstract java.lang.String javax.servlet.ServletRequest.getServerName()
public abstract int javax.servlet.ServletRequest.getServerPort()
public abstract java.io.BufferedReader javax.servlet.ServletRequest.getReader() throws java.io.IOException
public abstract java.lang.String javax.servlet.ServletRequest.getRemoteAddr()
public abstract java.lang.String javax.servlet.ServletRequest.getRemoteHost()
public abstract void javax.servlet.ServletRequest.setAttribute(java.lang.String,java.lang.Object)
public abstract void javax.servlet.ServletRequest.removeAttribute(java.lang.String)
public abstract java.util.Enumeration javax.servlet.ServletRequest.getLocales()
public abstract boolean javax.servlet.ServletRequest.isSecure()
public abstract javax.servlet.RequestDispatcher javax.servlet.ServletRequest.getRequestDispatcher(java.lang.String)
public abstract java.lang.String javax.servlet.ServletRequest.getRealPath(java.lang.String)
public abstract int javax.servlet.ServletRequest.getRemotePort()
public abstract java.lang.String javax.servlet.ServletRequest.getLocalName()
public abstract java.lang.String javax.servlet.ServletRequest.getLocalAddr()
public abstract int javax.servlet.ServletRequest.getLocalPort() 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T18:49:54.690

我假设您以某种方式“设法”引用了`servlet-api`位于类路径中的旧库（可能是可传递的）`javaee-web-api`。这意味着现有的类是从旧规范中获取的`servlet-api`，而旧规范中不存在的类是从`javaee-web-api`.

您可以运行`mvn dependency:tree`以查看引用该过时库的位置，然后将其排除。

# perl - perl中最简单的推荐外发电子邮件？

> ID：16041777
> 
> 赞同：1
> 
> 时间：2013-04-16T16:02:59.243
> 
> 标签：perl, email

我想设置一个基本的电子邮件发件人。这是为了验证我网站上用户的电子邮件，并给他们一个可以点击的令牌。服务器未设置电子邮件。它是一个普通的 ubuntu 盒子，我真的不想运行邮件服务器，部分原因是我不想担心另一个开放端口。我还希望编程简单并避免垃圾邮件过滤器。

首先，我尝试了 Gmail。

```
use Net::SMTP::TLS;
my $mailer = new Net::SMTP::TLS(  'smtp.gmail.com',
                  Hello   => 'smtp.gmail.com',
                  Port    => 587,
                  User    => $me2,
                  Password=> $pw); 
```

但我收到了有关“Gmail 的 Net::SMTP::TLS => 无效 SSL_version”的投诉。

然后我尝试了 Email::Send::Gmail。

```
my $email_address = $me;

($me =~ /^[\w\-_\.]+\@[\w\-_\.]+$/) or die "$email_address is invalid";

use Email::Send;
use Email::Send::Gmail;
use Email::Simple::Creator;

my $email = Email::Simple->create(
                  header => [
                         From    => $me,
                         To      => $me,
                         Subject => 'Testing',
                        ],
                  body => 'Testing email sending with perl.',
                 );

my $sender = Email::Send->new(
                  {   mailer      => 'Gmail',
                  mailer_args => [
                          username => $me2,
                          password => $pw,
                         ]
                  }
                 );
eval { $sender->send($email) };
die "Error sending email: $@" if $@; 
```

这个抱怨 Return::Value 已被弃用。然后，它失败了——可能是因为我的 gmail 帐户有双重身份验证。这对我想要的来说太复杂了。

对于这个简单的任务，推荐的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T13:32:59.293

不幸的是，您选择的两个模块都不起作用，您应该使用[Net::SMTP::TLS::ButMaintained](https://metacpan.org/module/Net%3a%3aSMTP%3a%3aTLS%3a%3aButMaintained)而不是 Net::SMTP::TLS 和[Email::Send::SMTP::Gmail](https://metacpan.org/module/Email%3a%3aSend%3a%3aSMTP%3a%3aGmail)而不是 Email::Send::邮箱。您选择的模块是旧的、未维护的并且已知已损坏。

有时通过模块的 CPAN 页面检查可用的错误报告会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-06T15:16:56.960

Email::Send 现已弃用。这对我有用，使用首选的电子邮件::发件人：

```
use strict;
use warnings;

use Email::Sender::Simple qw(sendmail);
use Email::Sender::Transport::SMTPS ();
use Email::Simple ();
use Email::Simple::Creator ();

my $smtpserver = 'server';
my $smtpport = 587;
my $smtpuser   = 'username';
my $smtppassword = 'password';

my $transport = Email::Sender::Transport::SMTPS->new({
  host => $smtpserver,
  port => $smtpport,
  ssl => "starttls",
  sasl_username => $smtpuser,
  sasl_password => $smtppassword,
});

my $email = Email::Simple->create(
  header => [
    To      => 'mymail@gmail.com',
    From    => 'sender@example.com',
    Subject => 'Hi!',
  ],
  body => "This is my message\n",
);

sendmail($email, { transport => $transport }); 
```

# boost-python - RandomForest.Writehdf5 给出 boost.python 参数不匹配错误

> ID：16041778
> 
> 赞同：0
> 
> 时间：2013-04-16T16:02:59.973
> 
> 标签：boost-python

我是 python 编程的新手。在 python 代码中调用 Vigra.learning.RandomForest.Writehdf5 函数时，会出现如下错误：

```
self.RF.writeHDF5(fileName, pathInFile, overwriteFlag)
Boost.Python.ArgumentError: Python argument types in
RandomForest.writeHDF5(RandomForest, str, str, bool)
did not match C++ signature:
writeHDF5(class vigra::RandomForest<unsigned int,struct vigra::ClassificationTag>,          class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >   filename, class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > pathInFile='') 
```

我已经安装了 python 扩展包 vigranumpy 以及 boost python，但我还没有安装 vigra (c++ image processing lib)。我无法追踪错误的原因。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:36:42.770

Boost.Python 错误表明调用者正在尝试使用 C++ 签名，`RandomForest.writeHDF5(str, str, bool)`但导出的 C++ 函数需要`RandomForest.writeHDF5(str, str)`. 我不确定`overwriteFlag`它打算做什么，但正在改变：

```
self.RF.writeHDF5(fileName, pathInFile, overwriteFlag) 
```

至

```
self.RF.writeHDF5(fileName, pathInFile) 
```

应该解决`Boost.Python.ArgumentError`异常。

# javascript - 将 Bower 组件安装到两个不同的目录中？

> ID：16041779
> 
> 赞同：27
> 
> 时间：2013-04-16T16:03:13.083
> 
> 标签：javascript, components, sass, organization, bower

在使用 CSS 和 JS 组件时，是否有可能，甚至，将它们安装到不同的目录是否有意义？

```
.
|-- app
    |-- scripts
        |-- components           # js components go here
            |-- backbone-amd
            |-- etc
    |-- styles
        |-- modules
        |-- partials
        |-- components           # sass components go here
            |-- normalize.scss
            |-- etc 
```

构建这样组织的项目的最有效方法是什么？是否有一个很好的 Grunt 任务来实现为开发环境集成 Bower 安装的 sass 组件的目标？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-17T09:38:10.873

Bower 需要跟踪您安装的每个组件。如果他们分散在多个位置，那将非常困难。对于 Sass 开发，只需将 components 文件夹放在 Sass 搜索路径中即可。

* * *

如果您坚持这样做，有些[繁重的任务可以帮助您将其拆分：](https://github.com/curist/grunt-bower)

*（虽然不推荐）*

*   [咕噜咕噜任务](https://github.com/yatskevich/grunt-bower-task)
*   [咕噜鲍尔组织者](https://github.com/mavdi/grunt-bower-organiser)
*   [咕噜咕噜](https://github.com/curist/grunt-bower)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-02-16T23:14:25.877

有一个名为[bower-installer](https://www.npmjs.org/package/bower-installer)的节点包，它提供了一个用于管理备用安装路径的命令。

跑`npm install -g bower-installer`

设置你的 bower.json

```
{
  "name" : "test",
  "version": "0.1",
  "dependencies" : {
    "jquery-ui" : "latest"
  },
  "install" : {
    "path" : {
      "css": "src/css",
      "js": "src/js"
    },
    "sources" : {
      "jquery-ui" : [
        "components/jquery-ui/ui/jquery-ui.custom.js",
        "components/jquery-ui/themes/start/jquery-ui.css"
      ]
    }
  }
} 
```

然后运行`bower-installer`命令。

这将安装`components/jquery-ui/themes/start/jquery-ui.css`到`./src/css`等

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-06T22:37:28.180

也许您可以将`.bowerrc`文件放在不同的目录中，您可以在其中配置`"directory"`键以指向凉亭组件目录。

但是您需要`cd`先更正目录`bower install whatever`：

```
app/
  scripts/
    .bowerrc
  styles/
    .bowerrc
tests/
  .bowerrc 
```

# c# - 尝试使用 episerver 邮件以编程方式发送邮件但失败

> ID：16041780
> 
> 赞同：1
> 
> 时间：2013-04-16T16:03:15.930
> 
> 标签：c#, episerver, episerver-7

我正在尝试使用 episerver 邮件发送一组电子邮件。我写了以下内容作为概念证明

```
 ISite site = (Site)SiteHandler.Instance.CurrentSite;
       ICategory category = site.Categories[0]; //..  hack I know

        Message message = new Message(subject: "Test 1",
                                        bodyText: "Test 1",
                                        bodyHtml: "Test 1",
                                        container: GetRecipientContainer(),
                                        fromAddress: "demo@demo.com",
                                        fromName: "Email User",
                                        addParametersToRedirectedLinks: false,
                                        category: category,
                                        site: site);

        var returnMessage = EPiServerMailHandler.Send(message, true); 
```

但它不断崩溃

> 调用的目标已引发异常。[你调用的对象是空的。

具体来说，它无法获得对该站点的引用。`SiteHandler.Instance.CurrentSite`一片空白

我已经尝试将此作为计划任务的一部分（最终需要在其中），并在页面的上下文中尝试。在这两种情况下它都是空的。

有没有人知道我是如何得到这个参考的。文档对此很模糊。我担心这是不可能的。

我正在使用表服务器 7

非常感谢

**编辑**

深入了解 SDK - 代码

```
EPiServerMailSection.Instance.CurrentSite.SiteId 
```

将返回正确的站点 ID。因此调度程序知道它只是未能拾取站点对象的站点。

还有代码

```
SiteHandler.Instance.GetSiteList().Count() 
```

返回计数 0，因此它显然没有在沿线某处加载网站集合。这似乎是它的关键问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T10:33:03.583

好的 - 我终于解决了这个问题。

1.  您必须在 Episerver 邮件中创建至少一个部分。没有这个 CurrentSite 为空
2.  获得网站后，可以从以下代码中获取类别。然后 send 方法停止出错。它是否发送邮件目前是一个悬而未决的问题 - 我似乎有 SMPT 服务器/垃圾邮件过滤器类型问题。那好吧。

    ```
    ISite site = (ISite)SiteHandler.Instance.CurrentSite;
    ICategory category = EPiServerMailModule.Instance.GetSiteCategory(site); 
    ```

# c++ - C ++：在不同类的派生对象的基指针上调用静态成员函数

> ID：16041782
> 
> 赞同：0
> 
> 时间：2013-04-16T16:03:24.583
> 
> 标签：c++, cocos2d-x

**编辑**：下面的例子不像想象的*那样工作。*对于*这个*问题，[Steve Jessop](https://stackoverflow.com/users/13005/steve-jessop)的回答是正确的。已使用更正示例创建了一个新[问题。](https://stackoverflow.com/questions/16059116/)根据社区规则，该问题可能会被删除。或者正文可以缩短为“是否可以在基类的指针上调用静态成员函数（指针）？” 用下面的例子来匹配答案。示例下方的更多细节（cocos2d-x）部分可能会被删除*。*

在基类的指针上调用静态成员函数（指针）是否“安全”（和/或可移植），但对象是不同的派生类。

```
class Base { /* ... */ }
class DerivedA  : public Base {
    /* ... */ 
    static void doSomethingStaticA(float f);
}
class DerivedB  : public Base { /* ... */ }

typedef void (Base::*SEL_SCHEDULE)(float);
SEL_SCHEDULE pCallback = (&DerivedA::doSomethingStaticA);

DerivedB db = new DerivedB();
Base *b = &db;
/* pCallback and b are saved in a list elsewhere (a scheduler) which calls */
b->pCallback(0.f); 
```

~~这*似乎工作*（在 MSVC/Debug 模式下）没问题，但我想知道这是否是 Bad (TM) - 为什么？（我尚未使用 Android 和 iOS 的编译器测试此代码）。~~

如果需要，请提供更多细节：我正在构建一个基于[cocos2d-x](https://github.com/cocos2d/cocos2d-x/)的项目。`Base`是[`CCObject`](https://github.com/cocos2d/cocos2d-x/blob/master/cocos2dx/cocoa/CCObject.h)，`DerivedA`并且`DerivedB`是 的子类[`CCLayer`](https://github.com/cocos2d/cocos2d-x/blob/master/cocos2dx/layers_scenes_transitions_nodes/CCLayer.h)。

层次结构是`DerivedA`和`DerivedB`< [`CCLayer`](https://github.com/cocos2d/cocos2d-x/blob/master/cocos2dx/layers_scenes_transitions_nodes/CCLayer.h)< [`CCNode`](https://github.com/cocos2d/cocos2d-x/blob/master/cocos2dx/base_nodes/CCNode.h)< [`CCObject`](https://github.com/cocos2d/cocos2d-x/blob/master/cocos2dx/cocoa/CCObject.h)。

`DerivedA`有一个不同的静态函数来设置音乐的播放，它接收一个[`CCNode`](https://github.com/cocos2d/cocos2d-x/blob/master/cocos2dx/base_nodes/CCNode.h)调用者对象作为参数并[安排](https://github.com/cocos2d/cocos2d-x/blob/master/cocos2dx/base_nodes/CCNode.cpp#L1059)另一个[选择器](https://github.com/cocos2d/cocos2d-x/blob/master/cocos2dx/cocoa/CCObject.h#L78)（`doSomethingStaticA`）开始播放并使用类似的东西慢慢淡入：

```
callerNode->schedule(schedule_selector(DerivedA::doSomethingStaticA), 0.05f); 
```

`doSomethingStaticA`做诸如此类的[事情](https://github.com/cocos2d/cocos2d-x/blob/master/CocosDenshion/include/SimpleAudioEngine.h#L141)

```
CocosDenshion::SimpleAudioEngine::sharedEngine()->setBackgroundMusicVolume(sFadeMusicVolume); 
```

运行时调用`doSomethingStaticA`发生在[CCTimer::update](https://github.com/cocos2d/cocos2d-x/blob/master/cocos2dx/CCScheduler.cpp#L160)中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:13:29.010

您甚至不能用 初始化`pCallback`，`&DerivedA::doSomethingStaticA`因为指向静态成员函数的指针实际上是指向函数的指针，而不是指向成员函数的指针。

所以有些东西很糟糕，即使只是你的示例代码；-) 也`b->pCallback`可能应该是`b->*pCallback`，`new`返回一个不能用于初始化的指针，`db`缺少一些分号，也许还有其他我错过的问题。编写一个简短的程序来编译，发布它，然后问你关于这个程序的问题。

# ruby-on-rails - 解决 Rails 孤立迁移的最佳方法是什么？

> ID：16041790
> 
> 赞同：50
> 
> 时间：2013-04-16T16:03:43.557
> 
> 标签：ruby-on-rails, ruby-on-rails-3, git, migration, rails-migrations

我一直在项目中的分支之间切换，每个分支都有不同的迁移......这是场景：

> $ rake db:迁移:状态

```
 Status   Migration ID    Migration Name
--------------------------------------------------
   ...
   up     20130307154128  Change columns in traffic capture
   up     20130311155109  Remove log settings
   up     20130311160901  Remove log alarm table
   up     20130320144219  ********** NO FILE **********
   up     20130320161939  ********** NO FILE **********
   up     20130320184628  ********** NO FILE **********
   up     20130322004817  Add replicate to root settings
   up     20130403190042  ********** NO FILE **********
   up     20130403195300  ********** NO FILE **********
   up     20130403214000  ********** NO FILE **********
   up     20130405164752  Fix ap hostnames
   up     20130410194222  ********** NO FILE ********** 
```

问题是`rake db:rollback`由于缺少文件而根本不起作用...

我应该怎么做才能再次回滚并摆脱 NO FILE 消息？

顺便说一句，`rake db:reset`或者`rake db:drop`不是一个选项，我不能从其他表中丢失数据......

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-04-22T19:39:59.830

我最终解决了这样的问题：

**(1)**到有迁移文件的分支回滚。当您有许多分支时，这并非微不足道，如果您尝试合并它们会导致许多冲突。所以我使用这个命令来找出每个孤儿迁移所属的分支。

所以，我需要找到上次修改迁移的提交。

```
git log --all --reverse --stat | grep <LASTEST_ORPHAN_MIGRATION_ID> -C 10 
```

我获取提交哈希并确定它属于哪个分支，如下所示：

```
git branch --contains <COMMIT_HASH> 
```

然后我可以回到那个分支，回滚并为所有丢失的文件重复这个过程。

**(2)**运行迁移：签出您最终要处理的分支并运行迁移，您应该一切顺利。

**故障排除**

在某些情况下，我还在删除的分支上运行了孤立迁移。

为了解决这个问题，我创建了具有与丢失文件相同的 migration_id 的虚拟迁移文件并将它们回滚。在那之后，我能够删除他们的虚拟迁移并拥有一个干净的迁移状态:)

另一种选择是直接从数据库中删除丢失的文件：

```
delete from schema_migrations where version='<MIGRATION_ID>'; 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2016-10-25T14:41:18.010

迁移存储在您的数据库中。如果要删除放弃的迁移，请将它们从数据库中删除。

Postgres 的示例：

1.  打开 psql：

    ```
    psql 
    ```

2.  连接到您的数据库：

    ```
    \c your_database 
    ```

3.  如果您好奇，请显示 schema_migrations：

    ```
    SELECT * FROM schema_migrations; 
    ```

4.  如果您很好奇，请检查是否存在废弃的迁移：

    ```
    SELECT version FROM schema_migrations WHERE version IN 
    ('20130320144219', '20130320161939', '20130320184628', '20130403190042',
     '20130403195300', '20130403214000', '20130410194222'); 
    ```

5.  删除它们：

    ```
    DELETE FROM schema_migrations WHERE version IN (<version list as above>); 
    ```

现在，如果您运行`bundle exec rake db:migrate:status`，您将看到孤立的迁移已成功删除。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2019-07-19T16:17:49.217

这是来自@medik 的 psql 答案的 rake 版本，它不会擦除您的数据库或做任何疯狂的事情：

1) 找到您的孤立迁移版本：

```
rails db:migrate:status 
```

2) 记下缺少迁移的版本并进入数据库控制台：

```
rails dbconsole 
```

3) 现在手动从迁移表中删除版本：

```
delete from schema_migrations where version='[version_number]'; 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2014-03-13T18:32:14.603

编辑：**以下将删除您的数据库**

一种对我有用的更简单的方法（请注意，此命令将删除数据库并且您的所有数据都将丢失）：

`rake db:migrate:reset`

..接着：

`rake db:migrate:status`

孤儿应该消失。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-04-20T18:16:50.427

创建具有名称的新文件，例如 `20130320144219_migration_1` 将一些空白代码放入

```
class Migration1 < ActiveRecord::Migration 
  def change; end 
end 
```

并运行命令`rails db:migrate:down VERSION= 20130320144219` ，最后 - 删除这些文件

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-09-01T21:57:49.197

这是我为此目的编写的一个 rake 任务。`db:migrate:status`它调用与引擎盖下使用的方法相同的方法，`ActiveRecord::Base.connection.migration_context.migrations_status`

```
# lib/tasks/cleanup_migration_entries.rake

desc 'Removes schema_migration entries for removed migration files'
task 'db:migrate:cleanup': :environment do
  migration_context = ActiveRecord::Base.connection.migration_context
  versions_to_delete =
    migration_context.migrations_status
                     .filter_map { |_status, version, name| version if name.include?('NO FILE') }

  migration_context.schema_migration.delete_by(version: versions_to_delete)

  puts "Cleaned up #{versions_to_delete.size} orphaned migrations."
end 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-16T23:42:58.820

假设您使用的是 Git，那么获取这些迁移并将它们带入您当前的分支应该相对简单。如果你有一个特定的提交，你想要一个文件，你可以使用：

```
git checkout <commit hash> <file_name> 
```

（感谢[这个答案](https://stackoverflow.com/questions/215718/how-do-i-reset-revert-a-specific-file-to-a-specific-revision-using-git)）

或者，您可以从特定分支 HEAD 签出：

```
git checkout <branch name> -- <file_name> 
```

根据这篇[博文](http://nicolasgallagher.com/git-checkout-specific-files-from-another-branch/)

假设这些实际上是在数据库上运行的迁移版本，那么您应该很好地回滚。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-20T07:13:45.000

您可以将两个分支合并回主分支，以便您拥有所有可用的迁移。如果您真的不希望这些迁移在那里，但希望能够回滚，您可以编辑数据库中的 schema_migrations 表以删除与您没有文件的迁移相对应的行。但是，如果您随后切换到具有不同迁移的另一个分支，这将导致问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-01T16:39:22.110

如果迁移文件确实丢失（例如运行迁移，忘记回滚迁移，然后在提交之前删除迁移文件），我能够重现丢失的迁移，如下所示：

1.  返回 git 历史记录以获取 schema.rb 文件的副本并保存在 git repo ( `git log; git checkout xxxxxx; cp schema.rb ~/schema_old.rb, git checkout master)`.
2.  对这两个文件运行 diff，并将迁移命令复制到与缺少的迁移 ID ( `diff schema.rb ~/schema_old.rb > migration_file.rb; vi migration_file.rb`)匹配的迁移文件中
3.  检查您的迁移状态和回滚 ( `rake db:migrate:status; rake db:rollback; rake db:migrate:status;`)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-06-04T14:36:27.410

`rake db:migrate`一旦您获得来自失败或没有文件条目的版本号，Rails 控制台的一个衬垫`rake db:migrate:status`

```
 class SchemaMigration < ActiveRecord::Base; end; SchemaMigration.where(version: %i[the version numbers to delete]).delete_all 
```

这意味着，从终端，您可以

```
rails runner "class SchemaMigration < ActiveRecord::Base; end; SchemaMigration.where(version: %i[the version numbers to delete]).delete_all" 
```

但是，在那时，使用先前答案中的直接数据库命令之一可能会更快。

# mockjax - Mockjax 通过函数和数据

> ID：16041797
> 
> 赞同：3
> 
> 时间：2013-04-16T16:03:57.087
> 
> 标签：mockjax

在 mockjax 中，您可以使用函数根据请求数据类型返回不同的响应，如下所示：

```
$.mockjax(function(settings) {
    if ( settings.dataType == 'json' ) {
         return {
             dataType: 'json',
             proxy: 'test.json'
         };
    }
    return false;
}); 
```

有没有办法根据通过请求发送的数据做同样的事情？这是迄今为止我能找到的唯一方法：

```
$.mockjax({
    url: '/',
    data: { variable: 0 },
    proxy: 'test.json'
}); 
```

我想要做的是将代理更改为不同的文件，如果`variable > 0`.

因此，例如有没有办法解析：

```
data: { variable: <0 } 
```

或类似的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-17T02:45:43.960

我知道这是旧的，但您应该能够为此调查该`settings.data`属性：

```
$.mockjax(function(settings) {
    var proxyFile = 'test.json'; // a default proxy?

    if ( settings.data.variable > 0 ) {
        proxyFile = 'test-greater-than-zero.json'
    }

    return {
        proxy: proxyFile
    };
}); 
```

# tdd - 聚合根是否应该在域驱动设计中实现接口

> ID：16041804
> 
> 赞同：7
> 
> 时间：2013-04-16T16:04:05.227
> 
> 标签：tdd, domain-driven-design

我正在开发一个同时使用领域驱动设计和测试驱动开发的项目。在阅读 Evans 的 DDD 书时，我注意到他没有为域中的聚合根定义接口。

如果我同时使用 DDD 和 TDD，我是否应该为每个聚合根定义接口以使聚合根类易于测试和模拟？如果是这样，我是否也应该为聚合根中包含的每个实体定义接口？

从我在 Google 和 StackOverflow 上的搜索中，我找到了与我正在寻找的答案相近的答案，但我在做 DDD 和 TDD 时特别寻求建议，因为我的假设是，在做 TDD 时，可测试性可能在我迄今为止看到的答案中被忽视。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T16:11:45.337

不，直接针对聚合进行测试。聚合本身不应注入依赖项，如果特定行为需要依赖项，则通常应将其表示为接口。聚合上的接口是一种不必要的抽象——只有一种行为实现——这就是重点。另外，看看[BDD 和 DDD](http://www.infoq.com/presentations/bdd-and-ddd) - 行为驱动开发可以看作是 TDD 的演变，并且与 DDD 很好地保持一致。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T16:23:32.280

我习惯于[为所有实体和域服务定义接口，](http://epic.tesio.it/doc/manual/poco.html)以简化使用域的客户端的测试。此外，这种方法在需要时简化了 AOP。

至于价值对象，这取决于。例如，我不将接口用于事件参数、[标识符](http://epic.tesio.it/doc/manual/shared_identifiers.html)、[异常](http://epic.tesio.it/2013/03/04/exceptions-are-terms-ot-the-ubiquitous-language.html)（显然）和一些其他类型的“合同”。但是，我不得不引入接口来简化客户端代码测试的隔离。因此我的经验法则是：客户端需要多少步才能使值对象处于所需状态？如果它不止一个（或两个，我的朋友很有道理:-D），我从一开始就介绍一个接口。

**注意**我不是在谈论聚合，因为我所有的聚合也是实体。

# google-places-api - Google Places API - 封闭的 POI？

> ID：16041805
> 
> 赞同：7
> 
> 时间：2013-04-16T16:04:09.443
> 
> 标签：google-places-api

谷歌地图似乎有关于一个地方是关闭（永久关闭）还是打开的信息，但谷歌地方 API 似乎没有这些信息。有谁知道是否可以检索此信息？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-06-16T20:49:35.793

`permanently_closed` *是一个布尔标志，指示该场所是否已永久关闭（值为 true）。如果该地点未永久关闭，则响应中不存在该标志。* [https://developers.google.com/places/web-service/details#PlaceDetailsResults](https://developers.google.com/places/web-service/details#PlaceDetailsResults) (2015+)

此外，Places Autocomplete API 会更喜欢那些没有永久关闭的地方，尽管如果没有更好的匹配用户输入，您可能仍然会得到一个。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-16T18:13:23.923

Google Places API 包含有关地点在当前时间打开或关闭但未永久关闭或打开的信息。

有关更多信息，请查看此文档 [https://developers.google.com/places/documentation/details#PlaceDetailsResults](https://developers.google.com/places/documentation/details#PlaceDetailsResults)

# ssh - sftp 的 Cygwin 用户权限（不允许操作）

> ID：16041806
> 
> 赞同：3
> 
> 时间：2013-04-16T16:04:09.513
> 
> 标签：ssh, cygwin, openssh, sshd

因此，我在 Win7 上安装了 Cygwin 1.7.17，我使用 mkpasswd 引入了域用户（我的主管理员帐户）。我再次使用 mkpasswd 来引入我创建的名为“ffftp”的本地帐户。

```
mkpasswd -d -u administrator > /etc/passwd
mkpasswd -l -u ffftp >> /etc/passwd 
```

我使用 mkgroup 来引入所有必要的 Windows 组。

我可以打字

```
$ login
user: ffftp
password: mypassword 
```

它登录......但它说的是：

```
Last login: Tue Apr 16 11:36:49 on pty0
login: no shell: /bin/bash: Operation not permitted 
```

本地用户 ffftp 只是 Windows 中的常规“用户”组。

ffftp 的 SID 以 S-1-5-21 开头。

我已经创建了一个 cygwin/home/ffftp

并在windows中设置它的权限。

如果我无法登录该用户，我怎么可能设置“ffftp”的私钥？我错过了什么？？？

此外，如果有人有关于使用 cygwin sshd 设置 AES 加密的指南，我们将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-01T20:27:37.377

这是我解决错误的方法：

```
/bin/bash: Operation not permitted 
```

首先，在`/etc/passwd`文件中，您创建的本地用户 (ffftp) 应该有一个与之关联的默认组。

例如，我的本地用户名为 sshd_server。与我的本地用户帐户关联的组 ID# 是 544。它是位于描述本地帐户（特权服务器）的文本之前的数字。看这里：

```
sshd_server:unused:1004:544:Privileged server,U-USCHEPMSTGP01\sshd_server,S-1-5-21-2770448234-4262186856-4033879849-1004:/var/empty:/bin/bash 
```

您可以将此组 ID# 与定义为的组列表进行比较`/etc/group`。

```
Administrators:S-1-5-32-544:544:

Users:S-1-5-32-545:545:

None:S-1-5-21-2770448234-4262186856-4033879849-513:513:

Domain Users:S-1-5-21-329068152-343818398-1801674531-513:10513: 
```

为了使我的 Cygwin SSH 连接正常工作，我必须修改我的`/etc/passwd`文件，并将与我的本地帐户 (sshd_server) 关联的组更改为与“无”关联的组 ID#。

```
sshd_server:unused:1004:513:Privileged server,U-USCHEPMSTGP01\sshd_server,S-1-5-21-2770448234-4262186856-4033879849-1004:/var/empty:/bin/bash 
```

通过将我的组 ID#`/etc/passwd`从 544（管理员）更改为 513（无），此错误得到解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-18T04:59:58.463

我有错误

```
/bin/bash: Operation not permitted 
```

在将 Cygwin 从 1.7.9 版更新到 2.9.0 版后连接到 sshd 时。问题的可能原因是“cyg_server”用户缺少“替换进程级别令牌”权限。但是，本地管理员的权限不足以在域中的计算机上授予此权限。我的解决方案（部分）：

在域用户帐户下运行“CYGWIN sshd”服务，而不是“cyg_server”。

这允许您仅在此用户下连接到 sshd（当您尝试在另一个用户下连接时，会发生错误）。

您也可以回到旧版本的 Cygwin（例如 1.7.30-1），但这种解决方案没有前途。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-09T19:31:58.140

我花了很多时间试图解决同样的问题。在这里偶然发现了一个解决方案：

[https://cygwin.com/ml/cygwin/2015-08/msg00162.html](https://cygwin.com/ml/cygwin/2015-08/msg00162.html)

在 cygwin 服务器上：

1.  转到控制面板 > 管理工具。
2.  选择本地安全策略 > 本地策略 > 用户权限分配。
3.  右键单击替换进程级别令牌并选择安全或属性。
4.  单击添加以添加运行 sshd 的帐户。（ cyg_server 在我的情况下）
5.  gp更新
6.  重启sshd服务

现在尝试通过 ssh 连接...我成功了

# ios - 未正确设置第一响应者

> ID：16041809
> 
> 赞同：0
> 
> 时间：2013-04-16T16:04:11.100
> 
> 标签：ios, objective-c, ipad

我有一个分组的表格视图，并尝试在用户按 Enter 时将新的第一响应者设置为文本字段。

这对我来说并不是什么新鲜事，我的代码在我进行一些不相关的更改之前有效，而现在却没有。当我设置它的第一响应者时，我有一个指向正确文本字段的指针，没有任何反应。

焦点完全从任何文本字段中消失，键盘留在屏幕上。然后 enter 和 'hide keyboard' 键都停止工作，直到用户再次重新启动对文本字段的关注。

这是代码：

```
- (void)uiTextFieldShouldReturn:(ObjectEditTextField *)uiTextField
 {
        if ((group.fields.count - 1) > uiTextField.fieldTag) 
        {

       //loop through every table group
        for (int i = uiTextField.fieldTag + 1; i < group.fields.count; i++) {

            //get whatever field is in the row (not necessarily a text field)

            ObjectEditField *field = [group.fields objectAtIndex:i];

            // a check if the field is of type UITextField
            if (field.propName && field.updateObjectOnEdit == YES && [field isKindOfClass:[UITextField class]]) {
                // set the active field
                activeField = field;

                // adjust the table view offset to make sure the text field is visble
                [self setTableViewOffsetForTextField:field];

                // obtain a pointer to the textfield object and set it to be the first responder
                UITextField *textField = (UITextField *)field;
                NSLog(@"field %@", textField.fieldLabel);
                if (![textField.field isFirstResponder]) {

                    [textField.field becomeFirstResponder];
                    return; 
                }
                break;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:15:45.083

首先，我绝对会验证您上面的描述，即您的代码“之前有效”并且更改是“不相关的”。根据定义，您对工作代码所做的任何更改都会在某种程度上导致它不再工作。如果不是直接的，那么间接由于副作用。

从您发布的代码示例中跳出来的所有内容都是以下行：

```
// adjust the table view offset to make sure the text field is visble
[self setTableViewOffsetForTextField:field]; 
```

您正在做正确的事情，确保包含 textField 的单元格滚动到视图中。一种可能性是当您将单元格滚动到视图中时会创建单元格，这取决于您的代码的其余部分，可能会导致以下问题：

1.  您发送`becomeFirstResponder`到的 textField 是与单元格中实际的 textField 不同的实例。

2.  `becomeFirstResponder`由于动画将带有 textField 的单元格滚动到视图中，因此在您调用时尚未创建单元格。

我会取消您为返回工作版本所做的任何更改，并真正确保`becomeFirstResponder`在预期的时间发送正确的 textField。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T19:13:35.100

通过评论，该字段位于模态（呈现）控制器内。

首先解释一下 - 默认情况下，如果模态控制器中的文本字段失去焦点，则键盘不会隐藏。这是由方法控制的`-[UIViewController disablesAutomaticKeyboardDismissal]`

> 此方法的默认实现在视图控制器的模态呈现样式设置为 UIModalPresentationFormSheet 时返回 YES，而对于其他呈现样式返回 NO。因此，系统通常不允许为模态表单关闭键盘。

这解释了为什么键盘的行为方式如此。没有文本字段被聚焦，键盘也没有被隐藏，因为我们在一个模态控制器中。

那么，会发生什么？我们知道当前文本字段退出第一响应者，并且没有视图成为第一响应者，或者不可编辑的视图成为第一响应者。

好吧，你的整个代码看起来很可疑：

```
ObjectEditField *field = [group.fields objectAtIndex:i]; 
```

这里我们有一个类型的对象`ObjectEditField`

```
[field isKindOfClass:[UITextField class]] 
```

现在，我们正在测试该字段是否是`UITextField`. 这是**非常**可疑的。如果是`ObjectEditField`，它怎么可能`UITextField`也是？

让我们继续

```
UITextField *textField = (UITextField *)field; 
```

好吧，让我们假设它是一个`UITextField`

```
if (![textField.field isFirstResponder]) { 
```

再次，**非常**可疑的事情。A`UITextField`没有`field`财产。

所以：

```
[textField.field becomeFirstResponder]; 
```

在未知对象上调用。我们甚至不知道它是否是一个`UITextField`.

请注意，大多数代码应该在您的 IDE 中发出警告。

解决方案：

1.  清理你的代码，检查警告。
2.  在通话`NSLog(@"%@", textField.field)`前放一个。`becomeFirstResponder`检查日志。

# ios - 过滤器：FMDatabase vs. NSDictionary vs. NSArray

> ID：16041811
> 
> 赞同：0
> 
> 时间：2013-04-16T16:04:11.697
> 
> 标签：ios, performance, sqlite, nsarray, nsdictionary

在我当前的应用程序中，我有一个数据表，其中包含 10,000 多行数据，每行包含大约 20 个属性。是的，这可能看起来很奇怪，但没有其他方法可以保存数据。

在应用程序启动时，所有数据都被读入一个 NSDictionary。每个对象都是一个自定义类的实例，它拥有与数据库表相同的属性。很基本的东西。

在 UITableView 中，我想显示此数据的过滤“子集”。关于移动设备上的性能，哪种过滤数据的方式最快或占用内存最少？

1.  FMDatabase 和 SELECT-query，基本 WHERE-syntaxx
2.  NSArray，遍历每个对象并将匹配的对象临时存储在另一个 NSArray 中（分别为 NSMutableArray）
3.  与 2 相同，但使用 NSDictionary 对象

提前感谢您的建议！

# mysql - 创建条件为真时添加两个值或仅获得一个值的查询

> ID：16041812
> 
> 赞同：0
> 
> 时间：2013-04-16T16:04:12.260
> 
> 标签：mysql, sql, doctrine-orm, doctrine

我有两张桌子，第一张

```
Table1 
ID   Name  Value    start       end         fk_table
1    edd   3     2013-03-25  2013-05-25       1 
2    tom   3     2013-03-25  2013-05-25       1
3    emi   3     2013-11-25  2013-25-25       1 
```

第二张桌子

```
Table2
ID VALUE
1   3 
```

我只想在 start <= Date AND t.end >= Date 时从**table1**和**table2**添加值但是如果日期超出范围，我只想从**table1获取值**

假设我们今天的日期为 2013-04-16，预期结果是

```
edd 6
tom 6
emi 3 
```

我使用学说和 Symfony2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:24:35.617

该解决方案可能取决于您的数据库引擎，因为不同的引擎提供不同的 SQL 扩展。你会用

```
SELECT Table1.Name, Table1.Value+IF(Table1.start<=? and Table1.end>=?,Table2.VALUE,0) 
FROM Table1 
   INNER JOIN Table2 ON Table1.fk_table=Table2.ID 
```

对于mysql。

你没有写足够多的关于你的实体来为你提供特定于 Doctrine 的代码，但你可以用它来运行它

```
$entityManager->createQuery($sql)->execute(array($dateParam,$dateParam))```. 
```

# c# - C#如何将文本文件中的字节异或读入字符串

> ID：16041817
> 
> 赞同：2
> 
> 时间：2013-04-16T16:04:24.930
> 
> 标签：c#

我需要防止一些孩子修改 json 文本文件并将“fartface”放入其中。我当前的代码从文本文件中获取一个字符串，如下所示：

```
using (StreamReader file = File.OpenText(basePath + "jsontxt"))
{
    string s = file.ReadToEnd(); 
```

我可以对我的 jsontxt 文件应用 XOR，这足以防止恶意放屁玩笑，但是在我的 wpf C# 应用程序中，当文件被读入字符串时，我不确定如何实现字节 XOR。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T16:12:52.700

尝试将字符串作为字节数组获取，并简单地用一些密钥对每个字节进行异或：

```
Byte[] byteString;
using (StreamReader file = File.OpenText(basePath + "jsontxt"))
{
   Byte secretByte = 125;
   string s = file.ReadToEnd();
   byteString = Encoding.UTF8.GetBytes(s);
   foreach(Byte b in byteString)
   {
      b ^= secretByte;
   }
}
//here save stream 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T19:45:13.757

You should use [System.IO.CryptoStream](http://msdn.microsoft.com/en-us/library/system.security.cryptography.cryptostream%28v=vs.100%29.aspx), Microsoft's stream decorator for reading/writing encrypted streams. Simple!

To read the encrypted text, something like this suffices:

```
static IEnumerable<string> ReadEncryptedTextFile( string path , byte[] key , byte[] iv , Encoding encoding )
{
  string value ;
  using ( Stream s = File.OpenRead(path) )
  using ( SymmetricAlgorithm algorithm = SymmetricAlgorithm.Create() )
  using ( ICryptoTransform transform = algorithm.CreateDecryptor( key , iv ) )
  using ( CryptoStream cs = new CryptoStream( s , transform , CryptoStreamMode.Read ) )
  using ( TextReader sr = new StreamReader(cs,encoding))
  {
      string line ;
      while ( null != ( line = sr.ReadLine() ) )
      {
          yield return line ;
      }
  }
} 
```

To write the encrypted text, something like this:

```
static void WriteEncryptedTextFile ( IEnumerable<string> lines , string path , byte[] key , byte[] iv , Encoding encoding )
{
  using ( Stream             s         = File.OpenWrite(path) )
  using ( SymmetricAlgorithm algorithm = SymmetricAlgorithm.Create() )
  using ( ICryptoTransform   transform = algorithm.CreateEncryptor( key , iv ) )
  using ( CryptoStream       cs        = new CryptoStream( s , transform , CryptoStreamMode.Write ) )
  using ( TextWriter         tw        = new StreamWriter( cs , encoding ) )
  {
    foreach ( string line in lines )
    {
      tw.WriteLine( line ) ;
    }
  }
  return ;
} 
```

You might want to dial in the specific algorithm you use (and each algorithm has requirements about `key` and `iv` size).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T16:17:47.760

我看到这个想法有两个问题。

首先，您会发现很难得出一个 XOR 值，当应用该值时，它会始终产生可读的字符。在这种情况下，您的文件将成为二进制文件，而不是文本文件。

其次，假设您可以想出一种方法来保证文件的可读性，这不会阻止人们对其进行修改。

如果要加密文件，请使用真正的加密技术。或者至少将您的字符串转换为字节数组，对字节进行异或，然后将文件写入二进制文件。要读回它，请将文件作为二进制文件读入`byte[]`（即`File.ReadAllBytes`），对字节进行异或，然后将该字节缓冲区转换为字符串。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-16T16:32:03.170

我假设您正在尝试实施某种类型的验证以确保文件未被修改。为什么不直接获取字符串的哈希码并进行检查呢？

```
using (StreamReader file = File.OpenText(basePath + "jsontxt"))
{
    string s = file.ReadToEnd();
}
if (verificationCode != s.GetHashCode())
{
    // Malicious fart joke eminent!
} 
```

您可以通过在文件目录上运行 Powershell 脚本轻松生成您的验证码……您没有提及如何存储 XOR 值以进行检查，但您可以将脚本写入您可以检查的位置。 .

```
$files = Get-Item "C:\test\*.js"

foreach ($file in $files)
{
    $text = Get-Content $file
    $file.BaseName +" "+ $text.GetHashCode()
} 
```

# linux - 如何在linux系统中安装tcl

> ID：16041821
> 
> 赞同：2
> 
> 时间：2013-04-16T16:04:35.823
> 
> 标签：linux, tcl

我正在使用 Tcl 脚本通过生成 telnet 命令来更改轮询器密码。我已经使用下面的脚本完成了这项工作，并在安装后在 Windows 机器上进行了测试`ActiveTcl8.5.13.0.296436-win32-ix86-threaded`

```
spawn telnet $serNumber $pNumber
#flush stdout
expect ">"

send "Clients\r"
expect ">"

send "1\r"
expect ">"

send "Pollers\r"
expect ">" 
```

现在我想在 Linux 机器上运行相同的脚本，但是由于我是 Linux 系统的新手，任何人都可以帮助我如何在 linux 系统中安装 tcl 并在那里执行相同的脚本吗？

任何帮助对我来说都很棒。请提供任何有用的链接。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T06:19:32.310

你很幸运。RHEL 4 在其存储库中具有期望。你可以简单地安装它`yum`：

```
yum install expect 
```

它应该安装期望及其所有依赖项。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T17:19:22.920

You're not using Tcl, you're using `expect`, which is a separate program which just happens to use Tcl. To install it, do

```
apt-get install expect 
```

Note that the above command is a guess as you did not tell us which Linux-based OS you're using ("Linux" is not an OS, it's just a kernel).

If you have no one to ask which system you're running, post the results of running the following commands:

```
uname -a
lsb_release -a
cat /etc/issue 
```

so we could try to make an educated guess.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-03T18:09:40.130

要在 Linux 上安装 Tcl（我使用的是 RedHat），你可以这样做

```
yum install tcl 
```

您将获得最新版本的 tcl。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-29T00:21:51.077

在 ubuntu 上：

```
 sudo apt-get install tcl 
```

# php - 使用 ajax 将数组发布到 PHP

> ID：16041835
> 
> 赞同：8
> 
> 时间：2013-04-16T16:05:11.263
> 
> 标签：php, javascript, arrays, posting

我在使用 AJAX 将数组发布到 PHP 页面时遇到问题。我一直在使用[这个问题](https://stackoverflow.com/questions/9001526/send-array-with-ajax-to-php-script)作为指导，但无论出于何种原因，我仍然无法让它发挥作用。据我所知`print_r($_POST)`，我发布了一个空数组，但在 HTML/Javascript 页面上，我使用警报来查看数组已被填充。该帖子正在工作，因为它在帖子中将空白值输入到 MySQL 数据库中，但我无法弄清楚它为什么传递一个空数组。代码如下：

Javascript：

```
<script type="text/javascript">
    var routeID = "testRoute";
    var custID = "testCustID";
    var stopnumber = "teststopnumber";
    var customer = "testCustomer";
    var lat = 10;
    var lng = 20;
    var timeStamp = "00:00:00";

    var dataArray = new Array(7);
  dataArray[0]= "routeID:" + routeID;
  dataArray[1]= "custID:" + custID;
  dataArray[2]= "stopnumber:" + stopnumber;
  dataArray[3]= "customer:" + customer;
  dataArray[4]= "latitude:" + lat;
  dataArray[5]= "longitude:" + lng; 
  dataArray[6]= "timestamp:" + timeStamp; 
  var jsonString = JSON.stringify(dataArray);
  function postData(){
    $.ajax({
       type: "POST",
       url: "AddtoDatabase.php", //includes full webserver url
       data: {data : jsonString}, 
       cache: false,

       success: function(){
           alert("OK");
       }
    });
  window.location = "AddtoDatabase.php"; //includes full webserver url
  }
alert(JSON.stringify(dataArray))
</script> 
```

PHP：

```
<?php
  print_r($_POST);

$routeID = $_POST['routeID'];
  $custID = $_POST['custID'];
  $stopnumber = $_POST['stopnumber'];
  $customer = $_POST['customer'];
  $latitude = $_POST['latitude'];
  $longitude = $_POST['longitude'];
  $timestamp = $_POST['timestamp'];

$mysqli= new mysqli("fdb5.biz.nf","username","password","database");

mysqli_select_db($mysqli,"database");

    $sql = "INSERT INTO Locations (routeID, custID, stopnumber, customer, latitude, longitude, timestamp) VALUES " .
           "('$routeID','$custID','$stopnumber','$customer','$latitude','$longitude','$timestamp')";
    mysqli_query($mysqli, $sql); 

    $error = mysqli_error($mysqli);  
echo $error;
?> 
```

`print_r($_POST)`仅在 php 页面上显示 Array() 而 javascript 页面上的 jsonString 警报显示 `["routeID:testRoute", "custID:testCustID", "stopnumber:teststopnumber", "customer:testCustomer", "latitude:10", "longitude:20", "timestamp:00:00:00"]`

有人看到我做错了什么吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-16T16:15:21.070

**注意：**您的代码输出的*主要原因是您**在发送/处理异步（AJAX）请求之前*`array()`重定向客户端 基本上移动到成功回调，如下所述。 *`window.location = "AddtoDatabase.php";`*

 *第一个问题：您应该使用对象文字（~= php 中的 assoc 数组），而不是使用数组。

为此，请更改此位：

```
var dataArray = new Array(7);//<== NEVER do this again, btw
dataArray[0]= "routeID:" + routeID;
dataArray[1]= "custID:" + custID;
dataArray[2]= "stopnumber:" + stopnumber;
dataArray[3]= "customer:" + customer;
dataArray[4]= "latitude:" + lat;
dataArray[5]= "longitude:" + lng; 
dataArray[6]= "timestamp:" + timeStamp; 
```

而是写这个：

```
var dataObject = { routeID: routeID,
                   custID:  custID,
                   stopnumber: stopnumber
                   customer: customer,
                   latitude: lat,
                   longitute: lng,
                   timestamp: timeStamp}; 
```

也没有什么了。最后，只需像这样发送数据：

```
function postData()
{
    $.ajax({ type: "POST",
             url: "AddtoDatabase.php",
             data: dataObject,//no need to call JSON.stringify etc... jQ does this for you
             cache: false,
             success: function(resopnse)
             {//check response: it's always good to check server output when developing...
                 console.log(response);
                 alert('You will redirect in 10 seconds');
                 setTimeout(function()
                 {//just added timeout to give you some time to check console
                    window.location = 'AddtoDatabase.php';
                 },10000);
             }
    }); 
```

其次，您的`postData`函数在发送 AJAX 请求之前重定向客户端！在调用 之后`$.ajax`，您的代码中有一个`window.location = "AddtoDatabase.php";`语句。如果您希望在 ajax 调用之后重定向客户端，则必须将该表达式移动到第二个片段 ^^ 中的`success`回调函数（我记录 的那个`response`）。

当你改变了这一切，你的`$_POST`变量应该看起来是正确的。如果不是，则打印出该`$_REQUEST`对象并查看 ajax 调用的响应是什么。

最后，*请*注意，使用支持准备好的语句（从而保护您免受**大多数**注入攻击）的 api，这并不意味着将未经检查的 POST/GET 数据串入查询比以前更安全...
底部行：当您使用支持关键安全功能（例如准备好的语句）的 API 时，请*使用这些功能*。

为了绝对清楚和完整，这里还有一个稍微修改过的 PHP 代码版本：

```
$routeID = $_POST['routeID'];
$custID = $_POST['custID'];
$stopnumber = $_POST['stopnumber'];
$customer = $_POST['customer'];
$latitude = $_POST['latitude'];
$longitude = $_POST['longitude'];
$timestamp = $_POST['timestamp'];
//you're connecting OO-style, why do you switch to procedural next?
//choose one, don't mix them, that makes for fugly code:
$mysqli = mysqli_connect('fdb5.biz.nf', 'username', 'password', 'database');//procedural
//or, more in tune with the times:
$mysqli= new mysqli("fdb5.biz.nf","username","password","database");//OO

mysqli_select_db($mysqli,"database");
//or
$mysqli->select_db('database'); 
```

如果需要，请查看文档以查看我将从这里开始使用的所有方法的程序对应部分。我更喜欢 OOP-API

```
//making a prepared statement:
$query = 'INSERT INTO Locations 
          (routeID, custID, stopnumber, customer, latitude, longitude, timestamp) VALUES 
          (?,?,?,?,?,?,?)';
if (!($stmt = $mysqli->prepare($query)))
{
    echo $query.' failed to prepare';
    exit();
}
$stmt->bind_param('s', $routeID);
$stmt->bind_param('s',$custID);
//and so on
$stmt->bind_param('d', $latitude);//will probably be a double
$stmt->execute();//query DB 
```

准备好的语句的有用链接：

*   [`mysqli::prepare`文档页面](http://www.php.net/mysqli_prepare)
*   [`mysqli_stmt::bind_result`文档页面](http://be2.php.net/manual/en/mysqli-stmt.bind-result.php)在获取数据时非常宝贵...
*   [快速教程1](http://www.databasejournal.com/features/mysql/article.php/3599166/Connecting-and-prepared-statements-with-the-mysqli-extension.htm)
*   [问答式教程2](http://www.phpmysqlitutorials.com/)
*   以防万一：[`PDO`也有教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:19:42.997

你应该使用序列化。然后......

```
<script>

jQuery(document).ready(function($){
/* attach a submit handler to the form */
$("#submit").click( function(event) {

/* stop form from submitting normally */
 event.preventDefault();

 /*clear result div*/
 $("#loginresponse").html('');

 /* use serialize take everthing into array */
    var frmdata = $("#formname").serialize();

$.ajax({
  url: "/file.php",
  type: "post",
  dataType: "json",
  data: frmdata,
  success: function(data, textStatus){
    if(data.redirect == 'true'){
       $('#formresponse').html(data.message);
      return true;
    }else{
      $('#formresponse').html(data.message);
      return false;
    }
  },
  error:function(){
      $("#formresponse").html('error');
  }
});
});
}); 

</script> 
```

比在 php 中使用 post 获取数据

```
<?php
$routeID = $_POST['routeID'];
$custID = $_POST['custID'];
$stopnumber = $_POST['stopnumber'];
$customer = $_POST['customer'];
$latitude = $_POST['latitude'];
$longitude = $_POST['longitude'];
$timestamp = $_POST['timestamp'];
?> 
```

并使用 json 编码显示。这样你就可以显示错误

```
<?php 

if(true)
    echo json_encode(array('redirect'=>'true', 'message'=>'form submitted'));
else
    echo json_encode(array('redirect'=>'false', 'message'=>'form not submited'));
?> 
```*

# jquery - 使用 jQuery 从表中选择行

> ID：16041842
> 
> 赞同：0
> 
> 时间：2013-04-16T16:05:30.597
> 
> 标签：jquery, html, html-table

我有一个如下概述的 HTML 表格（带有示例数据）：

```
<table class="tbl">
  <caption>Version History Table</caption>

  <thead>   
    <tr>
      <th>Change Date</th>
      <th>Change Type</th>
      <th>Description</th>
      <th>StaffID</th>
    </tr>   
  </thead>

  <tbody>
    <tr>
      <td>16/04/2010 07:30</td>
      <td>Edit</td>
      <td>New role</td>
      <td>00215</td>
    </tr>
    <tr>
      <td>15/02/2012 14:37</td>
      <td>Edit</td>
      <td>Out of stock</td>
      <td>85487</td>
    </tr>
    <tr>
      <td>14/03/2013 10:18</td>
      <td>Add</td>
      <td>Out of date</td>
      <td>15748</td>
    </tr>              
  </tbody>

</table> 
```

我想要实现的是，当用户选择一行时，会出现一个弹出/对话框，显示历史的详细信息。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T16:14:38.837

用一点 jQuery

```
$(document).ready(function(){
    $('table tbody tr').click(function(){
        alert($(this).text());
    });
}); 
```

还有一些CSS...

```
table tbody tr:hover {
    background-color: orange;
    cursor: pointer;
} 
```

你可以完成你的要求

试试这个[jsFiddle](http://jsfiddle.net/beyym/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:09:30.917

尝试这个

```
$('tr', 'table.tbl tbody').click(function(){
    alert($(this).text());
}); 
```

编辑：-根据您的评论，您不需要在所有 trs 中都添加 onClick。您可以使用 Jquery 选择器将点击事件分配给您的所有 trs

使用您的 showDialog 方法，您可以执行此操作，并且在 showDIalog 中，这将被单击`tr`。

```
$('tr', 'table.tbl tbody').click(showDialog); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-17T17:20:22.443

下面的代码将显示问题中提到的详细信息。

[![附上快照](https://i.stack.imgur.com/NNgPo.png)](https://i.stack.imgur.com/NNgPo.png)

```
<script>
    $(document).ready(function () {
      $('.tbl tbody tr').click(function () {
        var details = '';
        details += 'Change Date : ' + $(this).find('td:first-child').html() + '\n';
        details += 'Change Type : ' + $(this).find('td:nth-child(2)').html() + '\n';
        details += 'Description : ' + $(this).find('td:nth-child(3)').html() + '\n';
        details += 'StaffID : ' + $(this).find('td:nth-child(4)').html() + '\n';
            alert(details);
      });
    });
  </script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-17T16:12:39.493

例如，如果您使用诸如**p之类的****标记**或其他标记来识别作为上下文键的列

 **```
 <table class="tbl">
    <caption>Version History Table</caption>

    <thead>   
        <tr>
        <th>Change Date</th>
        <th>Change Type</th>
        <th>Description</th>
        <th>StaffID</th>
        </tr>   
    </thead>

    <tbody>
        <tr>
        <td>16/04/2010 07:30</td>
        <td>Edit</td>
        <td>New role</td>
        <td><p>00215</p></td>
        </tr>
        <tr>
        <td>15/02/2012 14:37</td>
        <td>Edit</td>
        <td>Out of stock</td>
        <td><p>85487</p></td>
        </tr>
        <tr>
        <td>14/03/2013 10:18</td>
        <td>Add</td>
        <td>Out of date</td>
        <td><p>15748</p></td>
        </tr>              
    </tbody>
    </table>
    <p>Picked row:</p>
    <p id="linea"></p>
    <p>The key for the row picked (StaffID) was:</p>
    <p id="StaffID"></p> 
```

您也可以使用此脚本提取所选行的键：

```
$(document).ready(function(){
    $('table tbody tr').click(function(){
        $("#linea").text($(this).text())
        $("#StaffID").text($(this).children('td').children('p').text())
    });
}); 
```**

# c# - 可以使用哪些工具来检查VB程序使用的依赖dll？

> ID：16041846
> 
> 赞同：-1
> 
> 时间：2013-04-16T16:05:36.890
> 
> 标签：c#, vb.net

我们有一个用VB编写的程序，当它在Windows XP中运行时，它运行良好，但是在Windows server 2003中运行时，它就失败了。我确信这是由VB程序引用的错误dll引起的，所以我想知道是否有人可以建议我一个工具来找出VB程序在不同环境中使用的依赖dll，以便我对此进行调查。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T16:09:46.760

您需要使用[Dependency Walker](http://www.dependencywalker.com/)。

# c++ - QT如何使用QTableView在QList中显示QMap

> ID：16041857
> 
> 赞同：1
> 
> 时间：2013-04-16T16:06:01.720
> 
> 标签：c++, qt-creator, qtableview, qlist

我有一个 QList 如下：

`QList< QMap<QString, QString> > x;`

例如：

`table(1) <name<name(1),ABC> >`

`table(1) <age<age(1),10> >`

我想将“姓名”和“年龄”作为列标题，并将它们的值“ABC”和“10”。接下来当我有：

`table(1) <name<name(2),DFG> >`

`table(1) <age<age(2),20> >`

值“DFG”和“20”在下一行

那么，我该如何做这个显示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:55:10.980

为此，您必须将数据传递给模型，然后您可以使用 QTableView 来显示您的数据；要为表设置模型，请使用以下示例：

```
// creating a 4*4 table
QStandardItemModel* table_model = new QStandardItemModel(4, 4);
for (int row = 0; row < 4; ++row) {
    for (int column = 0; column < 4; ++column) {
        QStandardItem *item = new QStandardItem((QString())); // you should set your data here (in this case as a string)
        table_model.setItem(row, column, item);
    }
} 
```

那么你应该将模型传递给一个tableview：

```
QTableView table;
table.setModel(table_model);
table.show(); 
```

# .net - 以编程方式找出进程位数

> ID：16041862
> 
> 赞同：1
> 
> 时间：2013-04-16T16:06:16.913
> 
> 标签：.net

无论如何我可以找出我的 .NET 进程是作为 32 位进程还是 64 位进程运行的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T16:09:00.860

如果您使用的是 .NET 4.0 或更高版本，您可能需要[Environment.Is64BitProcess 。](http://msdn.microsoft.com/en-us/library/system.environment.is64bitprocess.aspx)否则，请`IntPtr.Size`按照其他答案中的建议进行检查。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T16:07:32.787

```
if (IntPtr.Size == 4)
    // 32-bit

else if (IntPtr.Size == 8)
    // 64-bit 
```

[从这个问题](https://stackoverflow.com/questions/1953377/how-to-know-a-process-is-32-bit-or-64-bit-programmatically)

但是，正如@Jim Mischel 所指出的，在 .NET 4 及更高版本上，您应该使用

[`Environment.Is64BitProcess`](http://msdn.microsoft.com/en-us/library/system.environment.is64bitprocess.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T16:07:37.277

使用 IntPtr.Size 属性找出进程位数。

```
if(IntPtr.Size == 4)
 // 32 bit process
else
 // 64bit process 
```

# javascript - 检查所有图像的宽度，如果超过一定尺寸则设置新宽度

> ID：16041863
> 
> 赞同：1
> 
> 时间：2013-04-16T16:06:17.067
> 
> 标签：javascript, jquery, dom

我有一个页面，其中包含多个具有相同类的图像 ".bestsell-thumb" 。如何将所有这些图像制作成一个数组，然后获取每个宽度，如果大于 80 像素，将其更改为 80 像素？

我试过这个

```
var  bsThumb = $(".bestsell-thumb").each(function(){
             $(this).height();
}); 
```

只是为了获得高度，但我很确定我已经走了。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T16:09:02.663

```
$(".bestsell-thumb").width(function(i, w) {
    return w > 80 ? 80 : w;
}); 
```

他们当然必须先加载，然后才能得到任何东西！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:08:46.390

尝试

```
$(".bestsell-thumb").each(function(){
    if ($(this).width() > 80) {
        $(this).css("width", "80px");
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:08:51.940

你可以试试：

```
$(".bestsell-thumb").each(function(){
    if($(this).width() > 80){
        $(this).width("80px");
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T16:14:28.893

使用 CSS 而不是 JavaScript：

```
.bestsell-thumb {
  max-width: 80px;
  height: auto; /* maintains proportions */
} 
```

您也可以`max-height`在相同的样式块中进行设置——也可以设置`width: auto`。

# python - SQLAlchemy Session.add 不起作用？

> ID：16041868
> 
> 赞同：2
> 
> 时间：2013-04-16T16:06:46.957
> 
> 标签：python, python-3.x, sqlalchemy

我在使用 Python 3.3.0 和 SQLAlchemy 0.8.0 时遇到了一个奇怪的错误：

```
from sqlalchemy import create_engine, Integer, String, Text, Column, Sequence, DateTime, ForeignKey
from sqlalchemy.orm import sessionmaker, relationship, backref
from sqlalchemy.ext.declarative import declarative_base

engine = create_engine("sqlite:///:memory:", echo=True)
Session = sessionmaker(bind = engine)
Base = declarative_base()

class Product(Base):
    __tablename__ = "products"

    id = Column(Integer, primary_key=True)
    name = Column(String(200))
    description = Column(Text)

Base.metadata.create_all(engine)

session = Session()
product = Product()
product.id = 1
product.name = "Test"
product.description = "Test"

session.add(product)
print(product in session) # Expected true
session.commit()
print(session.query(Product).all()) # Expected the previous item 
```

如代码中所述，我希望 add 方法使用 INSERT 将产品添加到数据库中。但它不会也不会抛出异常。这是日志：

```
2013-04-16 18:03:14,368 INFO sqlalchemy.engine.base.Engine PRAGMA table_info("products")
2013-04-16 18:03:14,369 INFO sqlalchemy.engine.base.Engine ()
2013-04-16 18:03:14,371 INFO sqlalchemy.engine.base.Engine 
CREATE TABLE products (
    id INTEGER NOT NULL, 
    name VARCHAR(200), 
    description TEXT, 
    PRIMARY KEY (id)
)

2013-04-16 18:03:14,371 INFO sqlalchemy.engine.base.Engine ()
2013-04-16 18:03:14,371 INFO sqlalchemy.engine.base.Engine COMMIT
False
2013-04-16 18:04:04,706 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2013-04-16 18:04:04,708 INFO sqlalchemy.engine.base.Engine SELECT products.id AS products_id, products.name AS products_name, products.description AS products_description 
FROM products
2013-04-16 18:04:04,709 INFO sqlalchemy.engine.base.Engine ()
[] 
```

我已经尝试了几件事：

*   换发动机没用。我也试过postgresql。
*   我尝试调试。当我到达 add 方法的主体时，没有什么可以进入的。

我做错了什么还是这是一个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T14:15:39.720

此问题似乎是 Python 版本特定的问题。使用 Python 3.3.1 解决了这个问题。

# regex - 使用正则表达式查找中心标签之间的所有内容

> ID：16041870
> 
> 赞同：0
> 
> 时间：2013-04-16T16:06:47.267
> 
> 标签：regex

所以我正在使用一个供应商应用程序，它使用正则表达式从我的网站中删除代码。我有一个想要使用正则表达式控件查找和删除的整个 div，但是当我尝试它时，换行符和 div 会妨碍我。有没有人有任何想法？我正在尝试.+？但就像我说的那样，用换行符和一切来思考它会阻止它收集一切。

```
<center>
<div id="divSiteFooter">
<div class="container darkblue">
<div class="row">
<div class="twocol">
<h3>Experience</h3>
</div>
<div class="twocol">
<h3>Access</h3>
</div>
<div class="twocol">
<h3>Assistance</h3>
</div>
<div class="twocol">
<h3>Inquire</h3>
</div>
<div class="fourcol last">
<h3>Connect</h3>
</div>
</div>
</div>
<div class="container darkerblue">
<div class="twocol">
<ul>
<li><a href="/Experience-Avalon/">Avalon Choice Cruising</a></li>
<li><a href="/Cruise-Vacations/">Our Cruises</a></li>
<li><a href="/River-Cruise-Ships/">Our Fleet</a></li>
<li><a href="/interactive-suite/">Photos & Videos</a></li>
<li><a href="/Affiliations/">Awards and Affiliations</a></li>
</ul>
</div></div></div>
</center> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:23:05.523

要么使用

```
<center>[\s\S]+?</center> 
```

或打开`singleline`或`DOTALL`模式（如果可用）`.`匹配任何字符，*包括*换行符，

```
(?s)<center>.+?</center> 
```

您打开`singleline`模式的方式因语言/工具而异，但添加`(?s)`到正则表达式的开头将适用于其中的许多（但不适用于 Javascript）。

*进一步评论*

最好包含开始`div`标签以确保您删除了正确的`center`元素。IE

```
<center>\s*<div id="divSiteFooter">[\s\S]+?</center> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:12:32.510

您是否尝试过正则表达式修饰符（或匹配模式）多行来搜索换行符？

[http://www.regular-expressions.info/anchors.html#multi](http://www.regular-expressions.info/anchors.html#multi)

# twitter-bootstrap - 将 bootstrap 与同位素集成

> ID：16041876
> 
> 赞同：1
> 
> 时间：2013-04-16T16:07:16.843
> 
> 标签：twitter-bootstrap, jquery-isotope

在下面的链接中，我想通过添加引导类（和砌体布局模式） 将`DIV`s 列表转换为 3 列网格。[演示 - twitter 引导程序和同位素](http://mhesabi.com/test/test.html)`span4`

```
$('#grid').on('click', function() {
    $('.item').hide().addClass('span4');
    $('.item:nth-child(3n+1)').css('margin-left', 0); // remove extra margin-lefts
    $('.item').show();
    $('#posts').isotope({
        itemSelector: '.item',
        resizable: false,
        animationEngine: 'best-available'
    });
});
$(window).smartresize(function() {
    $('#posts').isotope('reLayout');
}); 
```

但如您所见，第 3 列进入下一行。我尝试减少引导`span4`宽度，但这没有任何区别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-30T02:13:55.757

***2019 年更新***

**引导程序 4**

现在 Bootstrap 4 使用 flexbox，您需要使用`fitRows`Masonry/Isotope 的布局：[https ://www.codeply.com/go/zNeDtV9nLE](https://www.codeply.com/go/zNeDtV9nLE)

**Bootstrap 3（原始答案）**

您提供的示例链接已损坏。我用于 Bootstrap 和 Isotope 的方法是使用 bootstrap-responsive.css 和自定义媒体查询（在您的 CSS 中）随着浏览器视口的变化相应地调整同位素单元（Bootstrap .span3 DIV）的大小。

这些是我调整的@media 查询：

```
@media (min-width: 768px) and (max-width: 980px) {
  .span3 {
    width: 352px;
  }
}

@media (min-width: 980px) and (max-width: 1200px) {
  .span3 {
    width: 300px;
  }
}

@media (min-width: 1200px) {
  .span3 {
    width: 270px;
  }
} 
```

**Bootply 上完整的 Bootstrap / 同位素示例**：http : [//www.bootply.com/60295](http://www.bootply.com/60295)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-22T14:01:41.920

使用最新版本的同位素。集成错误已修复！

[http://isotope.metafizzy.co/](http://isotope.metafizzy.co/)

# sharepoint-2013 - 在 SharePoint 2013 中将列表数据从子网站聚合到父网站

> ID：16041877
> 
> 赞同：0
> 
> 时间：2013-04-16T16:07:17.257
> 
> 标签：sharepoint-2013

我正在尝试实施一个项目管理网站。这是一个简单的网站集，其中包含一个项目组合父网站和该父网站下的多个项目子网站。每个项目子站点都有一个相同的自定义列表，“详细信息和状态”。我正在寻找的解决方案是能够汇总父站点中每个项目子站点“项目详细信息”列表中的所有数据

```
 Project Management (Parent)
                              > [Aggregate List of Project Sub-Sites' "Details & Status"
    __________________________________________________________________________
    |                                |                                       | 
```

项目 1（子站点） 项目 2（子站点） 项目 3（子站点）

> “详细信息与状态”>“详细信息与状态”>“详细信息与状态”

我希望聚合结果的格式可以类似于 ListView webpart，这样我就可以从聚合中过滤/排序结果（例如，仅显示特定项目经理的项目详细信息和状态，仅显示项目的项目详细信息和状态具体状态）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-17T16:38:43.150

Bamboo List Rollup webpart 完全符合您的要求。它搜索子站点并根据关键字、列表类型、列表名称、包含的名称等显示结果。它也支持相对 url，听说 MS，相对 url。什么概念！而且，作为奖励，它确实有效。如果我可以让 IT 中的 dweebs 安装我们的共享点 List Rollup，我会做你想做的事。聚合器的另一个重要用途是创建一个所有已签出给个人的文档的列表，并检查需要签入的所有内容。老实说，除非您有一些 IT 人员，否则只需将所有内容放在托管站点上. 然后，可以将托管站点的成本与 IT 人员无法合作并为设计和营销支付账单的产品的人员提供必要的工具进行比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T06:58:57.930

这是不可能的OOB，似乎应该这样做时需要自定义代码。您真的需要将其放置在不同的子站点中吗？如果可以不将其放置在单独的工作流中，您可以为您最初计划创建的每个子站点创建单独的列表，然后创建一个父列表。您可以共享点设计器，其中每次添加项目时，它都会将该列表中的所有数据复制到“父列表”。默认情况下，可以很容易地过滤列表。

# ruby-on-rails - 使用 to_json 包含方法中的嵌套信息

> ID：16041879
> 
> 赞同：5
> 
> 时间：2013-04-16T16:07:23.423
> 
> 标签：ruby-on-rails, json

我有一个嵌套方法，我想通过 to_json 输出：

`Venue`有一个称为`published_events`返回已发布事件的方法：

```
def published_events

    events_array = []

    self.events.each do |event|
      if event.published
        events_array << event
      end
    end

    events_array

  end 
```

`Event`有一个`to_param`方法，我想包含在 json 渲染中`Venue`：

```
format.json { render :json => @venue.to_json(:methods => :published_events => {:include => :to_param}) } 
```

当然，这不适用于包含事件的 to_param 方法。有没有其他方法可以解决这个问题，或者我需要构建自己的 json？方法中有没有`published_events`可以包含 to_param 方法的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-16T17:06:37.823

```
 @venue.to_json(:include => {:published_events => {:method => :to_param}}) 
```

# entity-framework - 忽略某些枚举的实体框架迁移

> ID：16041880
> 
> 赞同：1
> 
> 时间：2013-04-16T16:07:23.607
> 
> 标签：entity-framework, enums, entity-framework-migrations

首先，我们使用的是 .NET 4.5，所以这应该不是问题。

我有六个具有枚举属性的类，但是当我创建迁移时，由于某种原因，它忽略了其中两个类的枚举属性，而不是其他类！

例如，这个类：

```
public class CreditCardForeignUsage : EntityBase
{
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public override int Id { get; set; }

    public virtual CreditCard CreditCard { get; set; }
    public int CreditCardId { get; set; }

    public bool? Active { get; set; }
    public ForeignUsageNetwork? Network { get; set; }
    public ForeignUsageLocation? Location { get; set; }
    public decimal? Percent { get; set; }
    public bool? ManuallyAdded { get; set; }
} 
```

生成以下迁移代码（一切正常）：

```
 CreateTable(
            "dbo.CreditCardForeignUsage",
            c => new
                {
                    Id = c.Int(nullable: false, identity: true),
                    CreditCardId = c.Int(nullable: false),
                    Active = c.Boolean(),
                    Network = c.Int(),
                    Location = c.Int(),
                    Percent = c.Decimal(precision: 18, scale: 2),
                    ManuallyAdded = c.Boolean(),
                    Timestamp = c.Binary(nullable: false, fixedLength: true, timestamp: true, storeType: "rowversion"),
                    Created = c.DateTime(nullable: false),
                })
            .PrimaryKey(t => t.Id)
            .ForeignKey("dbo.CreditCard", t => t.CreditCardId)
            .Index(t => t.CreditCardId); 
```

但是这个类：

```
public class CreditCardRate : EntityBase
{
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public override int Id { get; set; }

    public virtual CreditCard CreditCard { get; set; }
    public int CreditCardId { get; set; }

    public bool? Active { get; set; }
    public RateType? RateType { get; set; }
    public int? MinBalance { get; set; }
    public int? MaxBalance { get; set; }
    public int? RatePeriod { get; set; }
    public DateTime? RateDate { get; set; }
    public decimal? MonthlyRate { get; set; }
    public YearlyRateType? YearlyRateType { get; set; }
    public decimal? YearlyRate { get; set; }
    public bool? ManuallyAdded { get; set; }
} 
```

生成这个（RateType 和 YearlyRateType 缺失）：

```
 CreateTable(
            "dbo.CreditCardRate",
            c => new
                {
                    Id = c.Int(nullable: false, identity: true),
                    CreditCardId = c.Int(nullable: false),
                    Active = c.Boolean(),
                    MinBalance = c.Int(),
                    MaxBalance = c.Int(),
                    RatePeriod = c.Int(),
                    RateDate = c.DateTime(),
                    MonthlyRate = c.Decimal(precision: 18, scale: 2),
                    YearlyRate = c.Decimal(precision: 18, scale: 2),
                    ManuallyAdded = c.Boolean(),
                    Timestamp = c.Binary(nullable: false, fixedLength: true, timestamp: true, storeType: "rowversion"),
                    Created = c.DateTime(nullable: false),
                })
            .PrimaryKey(t => t.Id)
            .ForeignKey("dbo.CreditCard", t => t.CreditCardId)
            .Index(t => t.CreditCardId); 
```

有任何想法吗？这是某种错误吗？

**编辑**

枚举声明如下：

```
namespace CE.Core.Portal.DTOs.CreditCards
{
    public enum RateType
    {
        StandardDirectDebit = 1,
        StandardPurchases = 2,
        StandardCash = 3,
        StandardOther = 4,
        IntroPurchases = 5,
        BalanceTransfer = 6,
    }
} 
```

# android - 如果表单字段位于导航栏下方，则按 Android 软键盘“下一步”键时单击 jqm 导航栏按钮

> ID：16041882
> 
> 赞同：4
> 
> 时间：2013-04-16T16:07:25.093
> 
> 标签：android, jquery-mobile

当用户使用 Android 软键盘的“下一步”键在编辑字段之间“切换”时触发导航栏按钮，我们遇到了一个令人不安的问题。这似乎仅限于 Android 4.1，因为该问题未出现在 Android 4.0 上。我们使用的是三星 Galaxy Tab2 7" 设备，目前无法访问任何其他 Andorid 设备进行比较。我们使用 jQuery v1.8.2 和 jQuery Mobile v1.2.0。jQM 1.3 目前不适合我们，由于我们项目中的其他依赖库目前不支持 jQM 1.3。

如果从设备浏览器查看，以下代码可用于重现该行为；

```
<!DOCTYPE html>
<html>
    <head>
        <link href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" rel="stylesheet" type="text/css" />
        <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
        <meta charset="UTF-8" />
        <style>
            body {font-size:14px;}
            .my-ui-header > .ui-btn {margin: 10px; height: 3.7em; width: 5.3em;}
            .my-ui-header .ui-btn-inner {padding-top:1.65em; padding-bottom:1.65em; }
            .ui-header .my-title {font-size: 32px; margin-bottom:0px; margin-left: 3em; margin-right: 2em;text-align: center; overflow: hidden;}
            .ui-header .my-subtitle {font-size: 18px; margin-top: 0px; margin-left: 4em; margin-right: 2em; text-align: center; overflow: hidden;}
            .footer-nav .ui-btn .ui-btn-inner {padding-top: 40px !important;}
            .footer-nav .ui-btn .ui-icon { width: 30px!important; height: 30px!important; margin-left: -15px !important; box-shadow: none!important; -moz-box-shadow: none!important; -webkit-box-shadow: none!important;-webkit-border-radius: 0 !important; border-radius: 0 !important; background-size: 30px 30px;}            
        </style>        
        <title>JQM Fixed Footer</title>
    </head>
    <body>
        <div data-role="page" id="home">
            <script type="text/javascript">
                $('#home').live('pageinit', function() {
                    $("#button1").bind("click", function(event, ui) {
                        alert("Oy...button 1 was clicked!");
                    });
                    $("#button2").bind("click", function(event, ui) {
                        alert("Oy...the other button was clicked,\nyeah,button 2 it was!");
                    });
                });
            </script>
            <div data-role="header" data-position="fixed" data-tap-toggle="false" class="my-ui-header">
                <p class="my-title">DEMO TITLE</p>
                <p class="my-subtitle">Subtitle</p>
            </div>
            <div data-role="content">
                <div data-role="fieldcontain">
                    <label for="dateField">Date</label>
                    <input id="dateField" name="dateField" type="date" name="clear" id="dateField" />
                </div>
                <div data-role="fieldcontain">
                    <label for="timeField">Time</label>
                    <input id="timeField" name="timeField" type="time" name="clear" data-clear-btn="true" />
                </div>
                <div data-role="fieldcontain">
                    <label for="Item1Select">Item 1</label>
                    <input id="Item1Select" name="Item1Select" type="text" name="clear" data-clear-btn="true" />
                </div>
                <div data-role="fieldcontain">
                    <label for="obsobs" >Item 2</label>
                    <input id="obsobs" name="obsobs" type="number" name="clear" data-clear-btn="true" />
                </div>
                <div data-role="fieldcontain">
                    <label for="item3" >Item 3</label>
                    <input id="item3" name="item3" type="number" name="clear" data-clear-btn="true" />
                </div>
                <div data-role="fieldcontain">
                    <label for="item4">Item 4</label>
                    <input id="item4" name="item4" type="number" name="clear" data-clear-btn="true" />
                </div>
                <div data-role="fieldcontain">
                    <label for="item5" >Item 5</label>
                    <input id="item5" name="item5" type="number" name="clear" data-clear-btn="true" />
                </div>
                <div data-role="fieldcontain">
                    <label for="item6">Item 6</label>
                    <textarea cols="40" rows="8" name="item6" id="item6"></textarea>
                </div>
                <div data-role="fieldcontain">
                    <label for="item7">Item 7</label>
                    <textarea cols="40" rows="8" name="item7" id="item7"></textarea>
                </div>
                <div data-role="fieldcontain">
                    <label for="item8" >Item 5</label>
                    <input id="item8" name="item8" type="number" name="clear" data-clear-btn="true" />
                </div>
            </div>
            <div data-role="footer" data-position="fixed" data-tap-toggle="false" data-id="oneFooter">
                <div data-role="navbar" class="footer-nav">
                    <ul>
                        <li><a href="#" id="button1" data-icon="custom">Button 1</a></li>
                        <li><a href="#" id="button2" data-icon="custom">Button 2</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </body>
</html> 
```

我们的项目基于 Cordova，因此它出现在股票浏览器上。我在这里为上面的代码创建了一个 jsFiddle ( [http://jsfiddle.net/UMm3c/11](http://jsfiddle.net/UMm3c/11)) 可用于观察行为。要查看此问题的实际效果，请向下滚动页面并选择 Col 2\. 标签下顶行的第二个编辑框。出现软键盘。当键盘可见时，向下滚动页面，使第二行编辑框被键盘覆盖（如果还没有的话）。然后点击键盘的“下一步”按钮。根据您的方向，您将收到一条警报，指示已按下导航栏按钮之一。软键盘将消失，焦点将在第二行的第一个编辑框上。事实上，当软键盘可见时，您可以通过尝试“制表”到导航栏正下方的任何字段元素来导致它发生。

谁能看到我在导致这种行为的页面设置中出错的地方？我能做些什么来解决这个问题吗？

如果您已经阅读到这里，感谢您的坚持，并感谢您提供的所有帮助。

亚历克斯。

# javascript - 如何使用 IE8 从 js 中包含 js

> ID：16041884
> 
> 赞同：2
> 
> 时间：2013-04-16T16:07:27.197
> 
> 标签：javascript, internet-explorer-8

我尝试了[https://stackoverflow.com/a/950146/151453](https://stackoverflow.com/a/950146/151453)提供的代码，并成功验证我可以`t2.js`从`t1.js`. 但是，`t2.js`完成加载回调仅适用于 Chrome（v26）、Firefox（v17）和 IE10，不适**用于 Microsoft IE8（Windows 7）**。

IE8 上的症状是：`start_deco()`从不调用回调。

如何在 IE8 中获得相同的结果？谢谢你。

==== 下面的代码 ====

t1.html：

```
<html>
<head></head>

<body>
Hello!

<script src="t1.js"></script>

</body>
</html> 
```

t1.js：

```
// loadScript function provided by https://stackoverflow.com/a/950146/151453
function loadScript(url, callback)
{
    // adding the script tag to the head as suggested before
    var head = document.getElementsByTagName('head')[0];
    var script = document.createElement('script');
    script.type = 'text/javascript';
    script.src = url;

    // then bind the event to the callback function 
    // there are several events for cross browser compatibility
    //script.onreadystatechange = callback;  // chj: !!!
    script.onload = callback;

    // fire the loading
    head.appendChild(script);
}

function start_deco()
{
    alert('Done t2.js.');
    loadScript('t3.js.');
}

loadScript('t2.js', start_deco) // wish to load jquery.js etc 
```

t2.js：

```
console.log('Loading t2.js...') 
```

t3.js：

```
console.log('Loading t3.js...') 
```

![在此处输入图像描述](https://i.stack.imgur.com/aYyfJ.png)

**============== UPDATE1 =================**

在 IE8 上，如果我启用`script.onreadystatechange = callback;`in ，则会`loadScript()`弹出警告框，但是，调用`loadScript('t3.js.');`失败并在该行显示“未实现错误”，因此 t3.js 无法加载。下图：

![在此处输入图像描述](https://i.stack.imgur.com/8bID3.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T02:46:33.737

哦，我明白了。是我的错！[https://stackoverflow.com/a/950146/151453](https://stackoverflow.com/a/950146/151453)提供的 loadScript()在 IE8 和 Firefox、Chrome 上完全可以使用。

而且，为了让它在 IE9+ 中工作，我必须遵循微软的建议： http: [//msdn.microsoft.com/en-us/library/ie/hh180173](http://msdn.microsoft.com/en-us/library/ie/hh180173(v=vs.85).aspx) (v=vs.85).aspx 。

评论`script.onreadystatechange = callback;`声明是我的错。

我的 IE8 控制台上显示的“未实现”错误是由于`callback`调用`loadScript('t3.js.');`.

所以，要解决这个问题，我应该在 loadScript() 中添加一行，最终结果是：

```
function loadScript(url, callback)
{
    // adding the script tag to the head as suggested before
    var head = document.getElementsByTagName('head')[0];
    var script = document.createElement('script');
    script.type = 'text/javascript';
    script.src = url;

    if(!callback) callback = function(){}; // ★★★★★★★★★ JUST ADD THIS LINE!

    // bind the event to the callback function 
    if(script.addEventListener) {
      script.addEventListener("load", callback, false); // IE9+, Chrome, Firefox
    } 
    else if(script.readyState) {
      script.onreadystatechange = callback; // IE8
    }

    // fire the loading
    head.appendChild(script);
} 
```

已在 IE8、IE9、Firefox 17、Chrome 27 上验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:12:21.470

IE8 和更早版本处理`script`对象的方式略有不同——它们不公开`onLoad`事件，而是公开`onReadyStateChange`事件。您可以在[https://github.com/mootools/mootools-more/blob/master/Source/Utilities/Assets.js](https://github.com/mootools/mootools-more/blob/master/Source/Utilities/Assets.js)`Asset.javascript`上查看 Mootools 的功能，作为一个很好的示例。您主要是在寻找这部分：

```
if (!script.addEventListener){
  script.addEvent('readystatechange', function(){
    if (['loaded', 'complete'].contains(this.readyState)) load.call(this);
  });
} else {
  script.addEvent('load', load);
} 
```

当然应该注意，这样的情况是总是使用像 Mootools 或 jQuery 这样的库的主要原因之一，以完全避免这样的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:09:47.190

我知道它不是来自 js，但这是一个选项吗？

```
<html>
    <head></head>
    <body>
        Hello!

        <script src="t1.js"></script>
        <!--[if IE 8]>
            <script src="t2.js"></script>
        <![endif]-->
    </body>
</html> 
```

# c# - 实体框架 6 无法检索元数据

> ID：16041894
> 
> 赞同：2
> 
> 时间：2013-04-16T16:07:51.987
> 
> 标签：c#, entity-framework, entity-framework-6

我正在使用 EF 6 pre-3。

产品型号：

```
namespace ProductStore.Models
{
    public class Product
    {
        [ScaffoldColumn(false)]
        public int Id { get; set; }
        [Required]
        public string Name { get; set; }
        public decimal Price { get; set; }
        public decimal ActualCost { get; set; }
    } 
```

}

创建控制器时，出现以下错误：

```
Unable to retrieve metadata for 'ProductStore.Models.Project'. Unable to cast object of type 'System.Data.Entity.Core.Objects.ObjectContext' to type 'System.Data.Objects.ObjectContext'. 
```

上下文是：

```
namespace ProductStore.Models
{
    public class OrdersContext : DbContext
    {
        public OrdersContext()
            : base("name=OrdersContext")
        {
        }

        public DbSet<Product> Products { get; set; }
        public DbSet<Order> Orders { get; set; }
        public DbSet<OrderDetail> OrderDetails { get; set; }
    }
} 
```

我的连接字符串是：

```
<add name="OrdersContext" connectionString="Data Source=(LocalDB)\v11.0;AttachDbFilename=|DataDirectory|\Orders.mdf;Integrated Security=True" providerName="System.Data.SqlClient" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-07T03:09:14.617

Entity Framework 6 不支持脚手架。使用 NuGet 包管理器控制台获取 Entity Framework 5 将解决此问题。然后，您将能够使用 CRUD 操作创建控制器。 [这](http://www.nuget.org/packages/EntityFramework/5.0.0)是 NuGet EF5 的链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T05:17:52.383

我已经测试过了，Entity Framework 6 还不能做脚手架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-08T16:06:26.100

将 EF 更新到版本 6.0.1，然后重建您的解决方案。之后应该工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-23T16:03:17.890

我也测试过，我认为Entity FrameWork 6不稳定。你可以重建项目，使用Nuget安装Entity FrameWork 5。

# mongodb - mongo恢复期间的异常

> ID：16041895
> 
> 赞同：2
> 
> 时间：2013-04-16T16:07:54.910
> 
> 标签：mongodb

我试图从 mongo 的突然关闭中恢复，正如 [fady mohamed osman](https://stackoverflow.com/a/6848840/587228)在这篇文章中所写的那样，但我遇到了一些问题。这是日志文件

我的日志是：

```
Tue Apr 16 17:45:25 [initandlisten] MongoDB starting : pid=3563 port=27017 dbpath=/var/lib/mongodb 64-bit host=milos-desktop
Tue Apr 16 17:45:25 [initandlisten] db version v2.0.2, pdfile version 4.5
Tue Apr 16 17:45:25 [initandlisten] git version: 514b122d308928517f5841888ceaa4246a7f18e3
Tue Apr 16 17:45:25 [initandlisten] build info: Linux bs-linux64.10gen.cc 2.6.21.7-2.ec2.v1.2.fc8xen #1 SMP Fri Nov 20 17:48:28 EST 2009 x86_64 BOOST_LIB_VERSION=1_41
Tue Apr 16 17:45:25 [initandlisten] options: { auth: "true", config: "/etc/mongodb.conf", dbpath: "/var/lib/mongodb", logappend: "true", logpath: "/var/log/mongodb/mongodb1.log", repair: true }
Tue Apr 16 17:45:25 [initandlisten] journal dir=/var/lib/mongodb/journal
Tue Apr 16 17:45:25 [initandlisten] recover begin
Tue Apr 16 17:45:25 [initandlisten] recover lsn: 77394770
Tue Apr 16 17:45:25 [initandlisten] recover /var/lib/mongodb/journal/j._0
Tue Apr 16 17:45:25 [initandlisten] journal file version number mismatch. recover with old version of mongod, terminate cleanly, then upgrade.
Tue Apr 16 17:45:25 [initandlisten] exception during recovery
Tue Apr 16 17:45:25 [initandlisten] exception in initAndListen: 13536 journal version number mismatch 0, terminating
Tue Apr 16 17:45:25 dbexit: 
Tue Apr 16 17:45:25 [initandlisten] shutdown: going to close listening sockets...
Tue Apr 16 17:45:25 [initandlisten] shutdown: going to flush diaglog...
Tue Apr 16 17:45:25 [initandlisten] shutdown: going to close sockets...
Tue Apr 16 17:45:25 [initandlisten] shutdown: waiting for fs preallocator...
Tue Apr 16 17:45:25 [initandlisten] shutdown: lock for final commit...
Tue Apr 16 17:45:25 [initandlisten] shutdown: final commit...
Tue Apr 16 17:45:25 [initandlisten] shutdown: closing all files...
Tue Apr 16 17:45:25 [initandlisten] closeAllFiles() finished
Tue Apr 16 17:45:25 [initandlisten] shutdown: removing fs lock...
Tue Apr 16 17:45:25 dbexit: really exiting now 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-01T17:23:27.353

[如错误SERVER-5380](https://jira.mongodb.org/browse/SERVER-5380?focusedCommentId=107906&page=com.atlassian.jira.plugin.system.issuetabpanels%3acomment-tabpanel#comment-107906)中所述，由于不干净的重新启动/关闭也可能发生这种情况。删除`/db/data/journal`（可能与您的设置不同，您可以在启动服务时生成的日志中确认）文件夹中的所有文件并重新启动服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:45:10.843

从日志中我可以看到您使用的是 2.0.2。如果崩溃前的 Mongo 版本与此不同，则会出现上述错误。使用相同版本的 Mongo 来解决问题。

# java - 什么是持久对象？

> ID：16041898
> 
> 赞同：3
> 
> 时间：2013-04-16T16:08:10.243
> 
> 标签：java, jpa

我正在阅读 Java EE 教程，[在这里](http://docs.oracle.com/javaee/6/tutorial/doc/bnbqa.html)我在开头看到了这句话：

> 实体是一个轻量级的持久域对象。

我搜索了**持久性对象**，但找不到明确的解释。

**持久域对象**到底是什么 ？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T17:03:37.887

Java EE 假设有一个称为[域模型](http://c2.com/cgi/wiki?DomainModel)的东西。域模型由表示实体的对象组成，其中[实体](http://martinfowler.com/bliki/EvansClassification.html)是具有与业务相关的身份的东西。（例如，如果您在银行工作，您的域可能涉及账户、客户、控股和贷款等内容）。

*这是 Bauer 和 King 的Java Persistence with Hibernate 中*描述域模型的引述：

> 3.1.1。分析业务领域
> 
> 软件开发工作始于对问题域的分析（假设不存在遗留代码或遗留数据库）。
> 
> 在这个阶段，您在问题领域专家的帮助下，确定与软件系统相关的主要实体。实体通常是系统用户理解的概念：支付、客户、订单、项目、投标等。一些实体可能是用户考虑的不太具体的事物的抽象，例如定价算法，但即使这些实体通常对用户来说也是可以理解的。所有这些实体都可以在业务的概念视图中找到，我们有时将其称为业务模型。面向对象软件的开发人员和架构师分析业务模型并创建面向对象的模型，但仍处于概念级别（无 Java 代码）。这个模型可能就像只存在于开发者脑海中的心理图像一样简单，或者它可能像 ArgoUML 或 TogetherJ 等计算机辅助软件工程 (CASE) 工具创建的 UML 类图一样精细。图 3.1 显示了一个用 UML 表示的简单模型。
> 
> 此模型包含您在任何典型拍卖系统中必然会找到的实体：类别、项目和用户。实体及其关系（可能还有它们的属性）都由这个问题域模型表示。我们称这种来自问题域的面向对象的实体模型（仅包含用户感兴趣的实体）称为域模型。这是对现实世界的抽象视图。
> 
> 分析和设计领域模型背后的动机是为了应用程序的目的捕获业务信息的本质。

理想情况下（在一种称为[域驱动设计](http://en.wikipedia.org/wiki/Domain-driven_design)的方法中）这些域对象具有 2 个特性：它们不了解诸如持久性或事务之类的基础架构问题，并且它们包含实现在业务处理过程中对其进行操作时发生的状态转换的逻辑; 这些组合意味着业务逻辑可以独立于基础设施进行测试。在现实世界中，更常见的是不包含任何业务逻辑的[贫血领域对象，业务逻辑都以](http://www.martinfowler.com/bliki/AnemicDomainModel.html)[事务脚本](http://martinfowler.com/eaaCatalog/transactionScript.html)结束。

无论如何，这个想法是你有一个由持久实体组成的域模型。有某种配置（注释或 XML 文件或其他）将实体及其属性映射到数据库中的表和列，并映射实体之间的关系。有一个 Object-Relational Mapper（JPA 是实现 ORM 的标准，Hibernate 就是这样一种实现）知道如何在数据库表示和对象图表示之间来回转换数据，以便开发人员可以操作对象而不是数据库行数。

对于那些声称业务逻辑不应该成为领域模型一部分的人，这里引用了*Java Persistence with Hibernate*一书的第 3.1.2 节：

> 领域模型中的实体应该封装状态和行为。例如，用户实体应定义客户的姓名和地址，以及计算项目（到该特定客户）的运输成本所需的逻辑。领域模型是一个富对象模型，具有复杂的关联、交互和继承关系。可以在企业应用程序架构模式（Fowler，2003）或领域驱动设计（Evans，2003）中找到有关使用领域模型的面向对象技术的有趣且详细的讨论。
> 
> 在本书中，我们不会过多谈论业务规则或领域模型的行为。这不是因为我们认为它不重要；相反，这种担忧大多与持久性问题正交。实体的状态是持久的，因此我们集中讨论如何在我们的领域模型中最好地表示状态，而不是如何表示行为。例如，在本书中，我们对如何计算已售商品的税款或系统如何批准新用户帐户不感兴趣。我们更感兴趣的是用户和他们销售的商品之间的关系是如何被表示和持久化的。每当我们仔细研究分层应用程序设计以及逻辑和数据访问的分离时，我们将在后面的章节中重新讨论这个问题。

显然，Hibernate 开发人员认为它是一种可行的替代方案，尽管它似乎不是典型企业开发中的常用方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-30T19:52:42.530

我只是添加了与[Koray Tugay 的另一个问题](https://stackoverflow.com/questions/15980473/does-spring-framework-come-with-its-own-beans/15981341#15981341)相关的答案。

在 Java EE 中，JPA 实体通常是由 JPA 容器管理的 Bean。此容器在任何经过​​ Java EE 认证的应用程序服务器中都提供。

每个实体对象都是 RDBMS 实例中一个或多个表的状态的内存表示。事务中实体的每个状态修改[`managed`](http://docs.oracle.com/javaee/6/tutorial/doc/bnbqw.html#bnbrc) 都将由容器自动处理，并映射为对数据库执行的 sql 顺序。因此，您不必关心域模型的持久性部分。只需修改对应的Java对象（实体）状态，就会自动反映到数据库中。 *（当然，这不是魔术，它有自己的陷阱。）*

每个实体都是`persistence unit`关联到 a的一部分，`datasource`为其提供了连接池。

一个持久性单元由许多`EntityManager`实例管理。`EntityManager`负责管理关联的所有实体的内存表示`persistence unit`；至少是当前从数据库中加载的那些。通常`EntityManager`每个线程都有一个实例（〜每个http请求）。

当使用`container-managed EntityManager`（意味着注入`@PersistenceContext`）时，容器将自动为您传播持久性单元操作中隐含的所有 bean（控制器/服务/dao/等）之间的事务上下文。

（最后一句的意思是当遇到`@transactionnal`注解时它会打开一个事务，并且在当前方法调用期间执行的任何 bean 上的每个方法都将是同一个事务的一部分。事务将在方法执行结束时提交（或回滚） ）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:09:32.553

它是域对象的状态。

> 持久实例在数据库中具有表示形式和标识符值。它可能刚刚被保存或加载，但是，根据定义，它在 Session 的范围内。

例如在 java ORM [framework hibernate中查看对象的状态](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/objectstate.html)

*免责声明：这只是一个想法。*

# jquery - jquery mobile 中的 Response.redirect 和 data-rel="back"

> ID：16041899
> 
> 赞同：1
> 
> 时间：2013-04-16T16:08:11.253
> 
> 标签：jquery, asp.net, jquery-mobile

我正在使用 asp.net webforms 开发 webapp。我的问题是当我点击后退按钮时我没有获得历史记录，这是我的代码：

```
 <div class="header" data-role="header" data-theme="f"  >
        <div>
            <a class="ui-btn-left" data-theme="f" data-role="button" data-corners="true"  data-rel="back"
                class="ui-btn-left ui-btn ui-shadow  ui-btn-up-b ui-btn-corner-all " data-shadow="true" href="#"
                data-iconshadow="true" data-icon="back" data-ajax="true">Back</a> 

                <a class="ui-btn-right btnLogout"
                    href="#" data-theme="f" data-role="button" data-corners="true" id="btnLogout"
                    class="ui-btn ui-shadow  ui-btn-up-b ui-btn-corner-all " data-shadow="true" data-iconshadow="true"
                    onclick="Dologout(); return false;">Logout</a>
        </div> 
```

上面的代码在母版页中。我在一个页面中有一些选择，在另一个页面上有搜索结果，我正在使用`response.redirect()`方法导航搜索结果。但是当我单击后退按钮时，它会清除所有内容。我想展示历史。我做了

```
 <script type="text/javascript">
        $(document).bind("mobileinit", function () {
            // jQuery Mobile's Ajax navigation does not work in all cases (e.g.,
            // when navigating from a mobile to a non-mobile page), especially when going back, hence disabling it.
            $.mobile.ajaxEnabled = false;
            $.mobile.ajaxLinksEnabled = false;
            $.mobile.ajaxFormsEnabled = false;
        }); 
```

请帮我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-13T21:11:17.360

问题仅出在 Internet Explorer 上。它适用于 FF 和 chrome。我使用 session 来保存变量并在单击返回时将值恢复到下拉列表中，除了使用 session 之外，我没有找到任何其他解决方法。

# ms-access - 嵌入导航表单时访问VBA子表单不过滤其他子表单

> ID：16041901
> 
> 赞同：0
> 
> 时间：2013-04-16T16:08:20.397
> 
> 标签：ms-access, vba

我有一个未绑定的表单，其中两个子表单嵌入到导航表单中，如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/N3Tds.png)

在左侧的子表单中，我有以下与 CustomerName 字段的 OnFocus 事件相关的代码，它过滤右侧的子表单以显示从右侧选择的客户详细信息：

```
Private Sub CustomerName_GotFocus()

Forms!frmCustomers_sjh![Customer Address Form].Form.Filter = "CustomerName = '" & Me.CustomerName & "'"
Forms!frmCustomers_sjh![Customer Address Form].Form.FilterOn = True

End Sub 
```

当我自己打开 frmCustomers_sjh 时，这很有效，但是当我从导航表单运行它时，它会崩溃。我收到运行时错误“2450”，Access 找不到引用的表单“frmCustomers_sjh”。

我已经做了足够的研究，知道在导航表单中运行代码是不同的，而且玩起来有点棘手，但我无法在这里解决这个问题。

注意事项：

1.  不使用导航表单不是一种选择（客户要求）
2.  拆分表格也不是一个选项，因为我需要一个搜索目录，右侧只有客户姓名，左侧有详细表格。
3.  我对任何其他设计解决方案持开放态度，因为我刚开始使用导航表单时对它的理解很低。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T16:37:29.017

这个附加站点为我对这个错误的体验增加了更多价值：[http ://www.mrexcel.com/forum/microsoft-access/635816-visual-basic-applications-buttons-dont-work-navigation-form.html](http://www.mrexcel.com/forum/microsoft-access/635816-visual-basic-applications-buttons-dont-work-navigation-form.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:23:39.030

我解决了这个！

我取出VBA代码，在未绑定表单的左侧子表单中放置了一个控件源设置为CustomerName字段的文本框。然后，我在该文本框和该表单中的 CustomerName 字段之间为右侧的子表单创建了父子关系！

呜呼！

这个[链接](http://www.btabdevelopment.com/ts/refer2sfrms)帮助很大！

# android - 用于任意字符串的 Android 选择器小部件

> ID：16041905
> 
> 赞同：5
> 
> 时间：2013-04-16T16:08:40.347
> 
> 标签：android, android-widget

我希望在 Android 中创建一个基本的选择器，它看起来像内置的日期和时间选择器，但使用自定义的字符串数组而不是日期和时间：

![在此处输入图像描述](https://i.stack.imgur.com/f0ckA.png)

[http://developer.android.com/guide/topics/ui/controls/pickers.html](http://developer.android.com/guide/topics/ui/controls/pickers.html)

这可能是最基本的问题之一，我看到很多自定义拾取器和轮子四处飘荡，但我特别希望它具有与内置拾取器相同的外观和感觉。做这个的最好方式是什么？

编辑：所以我使用`TimePicker`小部件来显示时间选择器，但是我可以用什么来从任意字符串列表中进行选择呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T17:49:24.770

外观来自[android.widget.NumberPicker](https://github.com/android/platform_frameworks_base/blob/master/core/java/android/widget/NumberPicker.java)

```
<NumberPicker
    android:id="@+id/numberPicker1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" /> 
```

# r - 如何使用时间作为 R 中的 xlabel 进行绘图

> ID：16041906
> 
> 赞同：-1
> 
> 时间：2013-04-16T16:08:40.377
> 
> 标签：r, time, plot

数据格式：

2013 年 4 月 15 日 8:59 0.56525

2013 年 4 月 15 日 9:00 0.8123

我想使用第二列和第三列在 R 中绘制一个图形，分别为 xlabel 和 ylabel。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:27:57.700

您可以尝试此代码，看看它是否符合您的要求。

```
library(ggplot2)
library(scales)
sample <- structure(list(Date = structure(c(1L, 1L), .Label = "4/15/2013", class = "factor"), 
               Time = structure(1:2, .Label = c("8:59:00 AM", "9:00:00 AM"
               ), class = "factor"), Value = c(0.56525, 0.8123)), .Names = c("Date", 
                                                                             "Time", "Value"), class = "data.frame", row.names = c(NA, -2L
                                                                             ))
time <- strptime(sample$Time," %H:%M")
qplot(time,sample$Value)+xlab("Time")+ylab("Value")+scale_x_datetime(breaks=date_breaks("1 min"), minor_breaks=date_breaks("10 sec")) 
```

我希望它有所帮助。

你只有两点。如果你有更多的点，那么绘制和可视化会更容易。

# c# - 将点击事件动态添加到其他表单

> ID：16041908
> 
> 赞同：0
> 
> 时间：2013-04-16T16:08:45.060
> 
> 标签：c#, events, button

我想动态添加一个从form1到form2的点击事件。

这是我在 form1 中的代码：

```
Form2 frm = new Form2();
string title =(string)listBox1.SelectedItem;
TabPage myTabPage = new TabPage(title);
frm.tabControl1.TabPages.Add(myTabPage);
//create button and it's event
Button button1 = new Button();
button1.Click += new System.EventHandler(button1_Click);
button1.Location = new Point((myTabPage.Width/2)-(button1.Width/2),myTabPage.Height-30);
button1.Text = "Click On Me!";
myTabPage.Controls.Add(button1);
frm.Show(); 
```

我收到以下错误：当前上下文中不存在名称“button1_Click”

请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:13:49.527

您需要创建`button1_Click`事件处理程序。目前，您正在将事件处理程序分配给“调用 button1_Click”的按钮，但实际上尚未创建要调用的“button1_Click”方法。

```
private void button1_Click(object sender, EventArgs e) 
{
   //code to call when the button is clicked.  
} 
```

从评论更新。您可以创建一个[匿名方法](http://msdn.microsoft.com/en-us/library/0yw3tz5k%28v=VS.100%29.aspx)。

```
button1.Click += (s,e) =>
     { 
         //code to call when the button is clicked. 
     }; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-16T16:11:57.997

您能否提前创建按钮并禁用并使其不可见，直到您想使用它？

# ubuntu - 在 Ubuntu 12 上创建 dbase ODBC

> ID：16041915
> 
> 赞同：1
> 
> 时间：2013-04-16T16:08:54.837
> 
> 标签：ubuntu, odbc, dbf, dbase

首先，对不起我的英语。

我正在使用 PHP 和 dbase 数据库进行开发。通常我在 Windows 机器上这样做，但有时我必须在 Ubuntu 上开发。问题是，我找不到***使用***dbase 在 Ubuntu 上创建 odbc 数据源的方法。

那么，有什么建议吗？这可能吗？

我不想直接从 .dbf 文件中获取数据，我想连接到 odbc dsn。

感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-29T17:10:25.627

[作者在 xbase 的手册页](http://manpages.ubuntu.com/manpages/precise/man3/XBase%3a%3aFAQ.3pm.html)底部一直写道：

> 这个 DBD::XBase 与 DBD::ODBC 有什么关系？DBD::XBase 使用（包含的）XBase.pm 模块直接读取 dbf 文件。所以它可以在任何具有合理新 perl 的平台上运行。使用 DBD::ODBC，您需要一个 DBD::ODBC 可以与之通信的 ODBC 服务器或某些程序。许多专有软件可以用作 dbf 文件的 ODBC 源，但它似乎无法在 Un*x 系统上运行。

由于 dBase 在很大程度上是一个遗留系统，因此任何人都不太可能投入大量精力来编写或保持 odbc 驱动程序是最新的。

如果您现有的 dBase 代码的复杂性允许，也许您可​​以开始迁移到一些基于 SQL 的 DBMS。从 Microsoft SQL Server 到 SQLlite 的任何驱动程序都更容易找到。

如果您现有的代码库或时间表不允许迁移，那么通过 Web 服务进行连接可能会打开一个 Ubuntu 窗口。

# python - httplib python/wxpython。袜子流错误

> ID：16041916
> 
> 赞同：0
> 
> 时间：2013-04-16T16:08:56.127
> 
> 标签：python, wxpython, httplib

在我进一步操作它们之前，我正在尝试检查一些 URL 以查看它们是否返回正常，我在 self.myList 中有一个 URL 列表，然后通过 httplib HTTP 连接运行这些 URL 以获取响应，但是我从 cmd 中的 httplib 获取大量错误。

代码有效，因为我已经用下面的代码进行了测试，它正确地返回并在 wx.TextCtrl 中设置值：

```
#for line in self.myList:
            conn = httplib.HTTPConnection("www.google.com")
            conn.request("HEAD", "/")
            r1 = conn.getresponse()
            r1 = r1.status, r1.reason
            self.urlFld.SetValue(str(r1)) 
```

当我从 myList 传递超过 1 个 URL 时，它似乎不起作用。

```
for line in self.myList:
            conn = httplib.HTTPConnection(line)
            conn.request("HEAD", "/")
            r1 = conn.getresponse()
            r1 = r1.status, r1.reason
            self.urlFld.SetValue(line + "\t\t" + str(r1)) 
```

我在 cmd 上遇到的错误是

```
Traceback (most recent call last):
File "gui_texteditor_men.py", line 96, in checkBtnClick
conn.request("HEAD", "/")
File "C:\Python27\lib\httplib.py", line 958, in request
self._send_request(method, url, body, headers)
File "C:\Python27\lib\httplib.py", line 992, in _send_request
self.endheaders(body)
File "C:\Python27\lib\httplib.py", line 954, in endheaders
self._send_output(message_body)
File "C:\Python27\lib\httplib.py", line 814, in _send_output
self.send(msg)
File "C:\Python27\lib\httplib.py", line 776, in send
self.connect()
File "C:\Python27\lib\httplib.py", line 757, in connect
self.timeout, self.source_address)
File "C:\Python27\lib\socket.py", line 553, in create_connection
for res in getaddrinfo(host, port, 0, SOCK_STREAM):
socket.gaierror: [Errno 11004] getaddrinfo failed 
```

**使用 urlparse**编辑、更新代码。**我已经导入了 urlparse。**

 **```
for line in self.myList:
            url = urlparse.urlparse(line)
            conn = httplib.HTTPConnection(url.hostname)
            conn.request("HEAD", url.path)
            r1 = conn.getresponse()
            r1 = r1.status, r1.reason
            self.urlFld.AppendText(url.hostname + "\t\t" + str(r1)) 
```

带回溯，

```
C:\Python27\Coding>python gui_texteditor_men.py
Traceback (most recent call last):
File "gui_texteditor_men.py", line 97, in checkBtnClick
conn = httplib.HTTPConnection(url.hostname)
File "C:\Python27\lib\httplib.py", line 693, in __init__
self._set_hostport(host, port)
File "C:\Python27\lib\httplib.py", line 712, in _set_hostport
i = host.rfind(':')
AttributeError: 'NoneType' object has no attribute 'rfind' 
```

我现在在 .txt 文件中有 www.google.com 和 www.bing.com，当它抛出此错误时。

**编辑 2** @Aya，

由于 2 个 URL 之间的“\n”，它似乎失败了。我以为我对其进行了编码以使用 .strip() 删除“\ n”，但似乎没有任何效果。

```
Failed on u'http://www.google.com\nhttp://www.bing.com'
Traceback (most recent call last):
File "gui_texteditor_men.py", line 99, in checkBtnClick
conn.request("HEAD", url.path)
File "C:\Python27\lib\httplib.py", line 958, in request
self._send_request(method, url, body, headers)
File "C:\Python27\lib\httplib.py", line 992, in _send_request
self.endheaders(body)
File "C:\Python27\lib\httplib.py", line 954, in endheaders
self._send_output(message_body)
File "C:\Python27\lib\httplib.py", line 814, in _send_output
self.send(msg)
File "C:\Python27\lib\httplib.py", line 776, in send
self.connect()
File "C:\Python27\lib\httplib.py", line 757, in connect
self.timeout, self.source_address)
File "C:\Python27\lib\socket.py", line 553, in create_connection
for res in getaddrinfo(host, port, 0, SOCK_STREAM):
socket.gaierror: [Errno 11004] getaddrinfo failed 
```

当我打开文件时，我又看了看我的 .strip()，

```
if dlg.ShowModal() == wx.ID_OK:
        directory, filename = dlg.GetDirectory(), dlg.GetFilename()
        self.filePath = '/'.join((directory, filename))
        self.fileTxt.SetValue(self.filePath)
        self.urlFld.LoadFile(self.filePath)
        self.myList = self.urlFld.GetValue().strip() 
```

现在它使用“Failed on u'h'”回溯错误

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:34:53.517

如果`self.myList`包含 URL 列表，则不能`HTTPConnection`像在此处那样直接在构造函数中使用它们...

```
for line in self.myList:
    conn = httplib.HTTPConnection(line)
    conn.request("HEAD", "/") 
```

构造`HTTPConnection`函数应该只传递 URL 的主机名部分，而请求方法应该传递路径部分。您需要使用类似...的内容解析 URL

```
import urlparse

for line in self.myList:
    url = urlparse.urlparse(line)
    conn = httplib.HTTPConnection(url.hostname)
    conn.request("HEAD", url.path) 
```

**更新**

能不能把代码改成...

```
for line in self.myList:
    try:
        url = urlparse.urlparse(line)
        conn = httplib.HTTPConnection(url.hostname)
        conn.request("HEAD", url.path)
        r1 = conn.getresponse()
        r1 = r1.status, r1.reason
        self.urlFld.AppendText(url.hostname + "\t\t" + str(r1))
    except:
        print 'Failed on %r' % line
        raise 
```

...并包括运行它的全部输出？

**更新#2**

我不太确定应该做什么`self.fileTxt`和`self.urlFld`应该做什么，但是如果您只是从 中读取行`self.filePath`，则只需要...

```
if dlg.ShowModal() == wx.ID_OK:
    directory, filename = dlg.GetDirectory(), dlg.GetFilename()
    self.filePath = '/'.join((directory, filename))
    self.myList = [line.strip() for line in open(self.filePath, 'r').readlines()] 
```**

# ajaxcontroltoolkit - 手动添加ajax控制工具包级联下拉

> ID：16041917
> 
> 赞同：0
> 
> 时间：2013-04-16T16:08:57.037
> 
> 标签：ajaxcontroltoolkit, cascadingdropdown

Visual Studio 2010, .NET Framework 4.0 尝试手动将 AjaxControlToolkit CascadingDropDown 扩展器动态添加到网页。该网页有一个占位符。当它回发时，控件会动态构建并添加到占位符中。我有想要添加 CascadingDropDown 扩展器的常规 ASP.NET 下拉列表框。

```
myCascadingDropDown = New AjaxControlToolkit.CascadingDropDown
myCascadingDropDown.ID = "cdd_" & myDisplayedField.ControlID
myCascadingDropDown.BehaviorID = "cdd_" & myDisplayedField.ControlID
myCascadingDropDown.TargetControlID = myDisplayedField.ControlID
myCascadingDropDown.Category = myDisplayedField.ControlID
myCascadingDropDown.PromptText = "Select " & aField.Caption
myCascadingDropDown.ServicePath = "CascadingDropDown.asmx"
myCascadingDropDown.ServiceMethod = "DropDownListBoxChanged"
myPanelForFields.Controls.Add(myCascadingDropDown) 
```

错误是添加 CascadingDropDown 的最后一行。错误是：

> 值不能为空。参数：没有为扩展器`name`设置目标控制。`CascadingDropDown`

如果您查看 myCascadingDropDown 上的 TargetControl 属性，它为空（无）。但是你不能设置它（它是只读的）。我假设因为我设置了 TargetControlID，所以 ASP.NET 会从 TargetControlID 设置 TargetControl。

有什么想法或建议吗？

更完整的异常：
System.ArgumentNullException 未被用户代码处理 Message=Value 不能为空。
参数名称：没有为 CascadingDropDown 扩展器设置目标控件。ParamName=没有为 CascadingDropDown 扩展器设置目标控件。
Source=AjaxControlToolkit
StackTrace:
在 AjaxControlToolkit.CascadingDropDown.CascadingDropDown_ClientStateValuesLoaded(Object sender, EventArgs e)
在 AjaxControlToolkit.ExtenderControlBase.LoadClientStateValues()
在 AjaxControlToolkit.ExtenderControlBase.OnLoad(EventArgs e)
在 System.Web.UI.Control.LoadRecursive()
在 System .Web.UI.Control.AddedControl（控制控件，Int32 索引）
在 System.Web.UI.ControlCollection.Add（控制子）

**VB.NET 中的答案：**

Yuriy Rozhovetskiy 做到了。我在 vb.net 中编程这个应用程序，所以首先我创建了一个全局变量（我在这个类中的函数是共享/静态的）：

```
Shared ControlToResolve As System.Web.UI.Control 
```

然后我创建的代码是：

```
myCascadingDropDown = New AjaxControlToolkit.CascadingDropDown
myCascadingDropDown.ID = "cdd_" & myDisplayedField.ControlID
myCascadingDropDown.BehaviorID = "cdd_" & myDisplayedField.ControlID
myCascadingDropDown.TargetControlID = myDisplayedField.ControlID
myCascadingDropDown.Category = myDisplayedField.ControlID
myCascadingDropDown.PromptText = "Select " & aField.Caption
myCascadingDropDown.ServicePath = "CascadingDropDown.asmx"
myCascadingDropDown.ServiceMethod = "DropDownListBoxChanged"
ControlToResolve = myBSCComboBox
AddHandler myCascadingDropDown.ResolveControlID, AddressOf myCascadingDropDown_ResolveControlID
myPanelForFields.Controls.Add(myCascadingDropDown) 
```

那么处理程序是：

```
Shared Sub myCascadingDropDown_ResolveControlID(sender As Object, e As ResolveControlEventArgs)
    e.Control = ControlToResolve
End Sub 
```

我将 CascadingDropDown 的 TargetControl 定义为“ControlToResolve”。在将 CascadingDropDown 添加到包含控件的面板之前，我将 ControlToResolve 设置为目标下拉列表框。当我添加 CascadingDropDown 时，它调用处理程序 myCascadingDropDown_ResolveControlID 将下拉列表框分配给 CascadingDropDown.Target

我的网络服务看起来像：

```
<System.Web.Services.WebService(Namespace:="http://tempuri.org/")> _
<System.Web.Services.WebServiceBinding(ConformsTo:=WsiProfiles.BasicProfile1_1)> _
<System.Web.Script.Services.ScriptService()> _
<ToolboxItem(False)> _
Public Class CascadingDropDown
    Inherits System.Web.Services.WebService

    <WebMethod(EnableSession:=True)> _
    Public Function DropDownListBoxChanged(ByVal knownCategoryValues As String, ByVal category As String) As CascadingDropDownNameValue()
    End Function 
```

每次我需要下拉列表框中的一个值时，它都会使用我的 ControlID 调用此 Web 服务。顺便说一句 - 使用 ControlID 我可以判断哪个下拉列表框需要数据，如果它是父或子下拉列表框并且可以获取数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:45:43.100

有两种可用的解决方案：第一个是将目标控件和扩展器放在同一个命名容器中，第二个是订阅扩展器的`ResolveControlID`事件，并在此事件处理程序中将目标控件直接设置为 eventArgs.Control 属性。C#代码如下：

```
myCascadingDropDown.ResolveControlID += myCascadingDropDown_ResolveControlID;

void myCascadingDropDown_ResolveControlID(object sender, ResolveControlEventArgs e)
{
    e.Control = myDisplayedField;
} 
```

# qt - 如何使用 Qt::CustomizeWindowHint 在 QDialog 中保持模态行为？

> ID：16041927
> 
> 赞同：0
> 
> 时间：2013-04-16T16:09:26.943
> 
> 标签：qt, modal-dialog, qdialog

使用 setWindowFlags 上的 CustomizeWindowHint 禁用所有框架时，QDialog 的模态不起作用...

```
QDialog dialog(getMainW());
dialog.setObjectName("dialog");
dialog.setWindowFlags( Qt::CustomizeWindowHint );
dialog.setWindowModality(Qt::ApplicationModal); 
```

当我评论第三行时，它根本不起作用。我专注于其余的事情。我怎样才能让它工作？

或者如何在不这样做的情况下移除按钮和框架？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:20:54.413

此代码在 Windows7/x32/Qt 5 上肯定有效。*

```
 setWindowFlags( Qt::SplashScreen | Qt::FramelessWindowHint ); 
```

你不需要对 WindowModality 做任何事情。

MacOSX 中存在一些问题，但还没有时间深入研究它们

# ms-access - 创建运行访问文件的计划任务

> ID：16041931
> 
> 赞同：1
> 
> 时间：2013-04-16T16:09:34.950
> 
> 标签：ms-access, scheduled-tasks

我很困惑计划任务如何运行 Microsoft Access 模块。

我想拥有一个带有访问数据库和表单（accdb 文件）的服务器。在此服务中，没有 Microsoft 访问仅安装了 accdb 文件。用户通过远程访问文件。

我创建了一个发送电子邮件的模块，我想知道是否可以创建任何 ST 来访问访问文件而无需安装 Microsoft Access。

最好的祝福

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:14:48.853

如果在运行计划任务的计算机上未安装 Access，您将无法运行存储在 ACCDB 文件中的 VBA 模块中的过程。

使您的 VBA 过程适应 VBScript，并将 VBScript 文件作为计划任务运行。

# wpf - 数据网格列多个绑定源

> ID：16041933
> 
> 赞同：0
> 
> 时间：2013-04-16T16:09:39.743
> 
> 标签：wpf, wpfdatagrid, advanceddatagrid, itemssource

您好，我有一个有 10 列的数据网格。第一个从数据网格的 itemsource 属性中获取它们的值。但最后两个我希望他们从其他来源获取他们的价值观。

具体来说，项目源两次都是对象列表。我想知道如何让最后两个列从不同的来源获取它们的值。环顾四周，我发现您不能同时在数据网格中设置多个源。

我一直在尝试创建一个新的对象列表，该列表可以组合我需要的数据，但是因为一切都是通过代码而不是 xaml 动态完成的，所以它一直在使我的程序的其他部分崩溃！

那么关于如何绑定到与datagrid.itemsource不同的datagridcolumn的任何想法？？？

我还尝试为每个 datagridtextcolumn 创建一个绑定，将我想要的列表设置为绑定，将我需要的参数设置为路径，然后绑定到列，但是我在每个单元格中都获得了相同的值

因此，如果我解释得不够好，请告诉我，我会尽力解释得更好，欢迎所有建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-19T11:43:42.407

为您的 AdvancedDataGrid 编写您自己的列渲染器。然后你可以在运行时提供你想要的任何值。更多信息[在这里](http://livedocs.adobe.com/flex/3/html/help.html?content=advdatagrid_10.html)。

# xcode - 有什么办法可以解决调试时 XCode 死机，并且无法填充变量监视窗口？

> ID：16041934
> 
> 赞同：0
> 
> 时间：2013-04-16T16:09:41.163
> 
> 标签：xcode, remote-debugging

我经常在 XCode 4.6.1 向我显示这个几乎无穷无尽的进度微调器时冻结，并在返回前冻结 3 分钟：

![在此处输入图像描述](https://i.stack.imgur.com/TFPWf.png)

这只发生在真实的 iPhone 目标上，所以我怀疑问题出在与真实 iOS 设备目标上的远程调试器内核的通信中。

有没有人看到这个并且知道解决方法或修复？（除了明显的，关闭调试器监视窗口。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T20:21:57.397

这似乎在 XCode 4.6.2 中得到修复。（4月15日）

如果这不能解决您的问题，或者您在 XCode 6 中遇到它，请尝试清理您的二进制构建产品（派生数据）文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-10T19:50:41.227

我在使用 Xcode 6.4 (6E35b) 时偶尔会遇到这个问题。我没有尝试清除我的“派生数据”文件夹，但我发现在“本地”和“自动”之间切换变量视图有时会导致该视图变得不稳定并开始工作。你的旅费可能会改变。

# r - 从列名中删除点

> ID：16041935
> 
> 赞同：19
> 
> 时间：2013-04-16T16:09:45.767
> 
> 标签：r

我有一个包含几列的数据框，我想删除列名上的点。数据如下：

```
structure(list(JulDay = c(260.0208435, 260.0416565, 260.0625, 
260.0833435, 260.1041565, 260.125), i.46.j.8.k.1 = c(17.99964905, 
18.5903511, 22.93223381, 25.75687981, 25.78559113, 25.8169651
), i.47.j.8.k.1 = c(18.36571884, 21.15985107, 24.80698013, 25.75730324, 
25.78366089, 25.65381622), i.48.j.8.k.1 = c(18.45543289, 22.02331543, 
24.99463654, 25.5712738, 25.64232635, 25.66119385), i.46.j.8.k.2 = c(17.99798965, 
18.60897827, 22.95389748, 25.75719261, 25.78653336, 25.81692505
), i.47.j.8.k.2 = c(18.36762619, 21.17233467, 24.82248497, 25.75767899, 
25.7840023, 25.64115906), i.48.j.8.k.2 = c(18.45938683, 22.04619026, 
24.9859066, 25.56440544, 25.63998032, 25.66089439), i.46.j.8.k.3 = c(17.99430084, 
17.92090797, 19.67384911, 21.70389938, 23.67287827, 24.04380417
), i.47.j.8.k.3 = c(18.36631203, 19.82550049, 21.42166328, 23.76496887, 
24.87460899, 25.41026688), i.48.j.8.k.3 = c(18.44684792, 20.60981369, 
22.68632317, 24.1877079, 25.12503052, 24.99880028), i.46.j.8.k.4 = c(17.98368073, 
17.92047691, 18.11532974, 18.67082596, 20.23210907, 21.7181263
), i.47.j.8.k.4 = c(18.33089066, 18.41581535, 18.53464127, 19.18972206, 
20.14752388, 20.11002922), i.48.j.8.k.4 = c(18.21522522, 18.52231598, 
19.21397209, 19.58755302, 20.11982536, 21.28104591)), .Names = c("JulDay", 
"i.46.j.8.k.1", "i.47.j.8.k.1", "i.48.j.8.k.1", "i.46.j.8.k.2", 
"i.47.j.8.k.2", "i.48.j.8.k.2", "i.46.j.8.k.3", "i.47.j.8.k.3", 
"i.48.j.8.k.3", "i.46.j.8.k.4", "i.47.j.8.k.4", "i.48.j.8.k.4"
), row.names = c(NA, 6L), class = "data.frame") 
```

谁能让我知道如何从列名中删除点？

> 我想要像 i46j8k1、i47j8k1、i48j8k1 这样的东西。

对于这个简单的数据集，我可以手动替换名称，但我需要对多个数据集执行此操作。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-04-16T16:12:18.837

一种直接的方法是使用`gsub`从列名中删除句点：

```
> names(mydf)
 [1] "JulDay"       "i.46.j.8.k.1" "i.47.j.8.k.1" "i.48.j.8.k.1" "i.46.j.8.k.2"
 [6] "i.47.j.8.k.2" "i.48.j.8.k.2" "i.46.j.8.k.3" "i.47.j.8.k.3" "i.48.j.8.k.3"
[11] "i.46.j.8.k.4" "i.47.j.8.k.4" "i.48.j.8.k.4"
> names(mydf) <- gsub("\\.", "", names(mydf))
> names(mydf)
 [1] "JulDay"  "i46j8k1" "i47j8k1" "i48j8k1" "i46j8k2" "i47j8k2" "i48j8k2" "i46j8k3"
 [9] "i47j8k3" "i48j8k3" "i46j8k4" "i47j8k4" "i48j8k4" 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-06-07T22:52:24.053

```
library(janitor)

mydf %>%
  clean_names() 
```

包中的`clean_names`函数`janitor`将删除任何不是小写字母、下划线或数字的字符。不过，它可能会将句点转换为下划线，因此如果您的目标是完全摆脱该字符，则 gsub 解决方案将最有效。

# java - Java EE 的 Eclipse Juno 仅在一个 Java SE 类上没有“作为 Java 应用程序运行”

> ID：16041942
> 
> 赞同：1
> 
> 时间：2013-04-16T16:10:02.663
> 
> 标签：java, eclipse, jakarta-ee, eclipse-juno

我对**Eclipse (Juno) for Java EE Developers**有一个奇怪的问题。作为 Java SE GUI（扩展 JFrame）创建的一个特定类不显示“**作为 Java 应用程序运行**”选项。

到目前为止，我尝试了以下方法无济于事：

*   创建了另一个项目并在那里复制了我的java源文件
*   创建了一个新的 java 类并将我的代码复制粘贴到其中

我还验证了我在 Java（不是 Java EE）视图中，并且旧项目中的其他 Java 类仍然具有“作为 Java 应用程序运行”选项。

任何想法如何解决这种情况？

如果我在这里发布我的代码（它相当小）会有帮助吗？

**更新：**

那实际上是在代码中：

```
public void  main() { 
```

我改正后，问题就消失了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:13:11.700

该类必须有一个有效的 main 方法：

```
public static void main (String[] args){}

public static void main (String... args){} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T16:12:10.687

通常，运行方式... Java 应用程序选项可用于具有`main`方法的类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-16T16:22:45.223

该类是否定义了一个`public static void main(String[] args)`方法？

# c++ - 将 C 函数转换为 Lua 函数

> ID：16041946
> 
> 赞同：0
> 
> 时间：2013-04-16T16:10:16.963
> 
> 标签：c++, lua

假设我有一个回调函数，它在指定玩家死亡时执行。

```
function OnPlayerDeath(playerid)

end 
```

我希望在 Lua C 模块中调用此函数而不将其放入 lua 脚本中：

```
static int l_OnPlayerConnect (lua_State * L) {
  enum { lc_nformalargs = 1 };
  lua_settop(L,1);

  // so here I can use playerid argument - 1 arg

  return 0;
} 
```

以某种方式可以在 C 中接收此回调参数？

```
#define LUA extern "C" __declspec(dllexport) int __cdecl

LUA luaopen_mymodule(lua_State *L)
{
  /* function OnPlayerConnect( playerid )
   *    
   * end */
  lua_pushcfunction(L,l_OnPlayerConnect);
  lua_setfield(L,LUA_GLOBALSINDEX,"OnPlayerConnect"); //there's already OnPlayerConnect I just want to also call it here but I don't know how.
  assert(lua_gettop(L) - lc_nextra == 0);

  return 1;
} 
```

我不想把这个函数推到 lua 堆栈上，因为这个函数已经存在。我只是希望它是已经存在的 Lua 函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:23:55.173

如果你想从 C API 在 Lua 中运行它，你需要以一种或另一种方式将它推入堆栈。如果它已经存在于全局表的某个地方，你可以通过调用 lua_getglobal 来推送它。lua_call (lua_pcall) 要求函数被调用并且它的参数在调用之前存在于栈顶。

如果你喜欢它，你可以检查 LuaJIT ffi 回调功能，但它不是普通的 Lua。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:58:32.127

解决了。有可能WB

解决方案：从 C 调用 loadstring。

# jquery - 调用隐藏的div时如何启动jquery动画？

> ID：16041954
> 
> 赞同：0
> 
> 时间：2013-04-16T16:10:53.230
> 
> 标签：jquery, css, animation

我有一个隐藏的 div，其中有一个运行打字机动画的 jquery。我想知道一旦 div 显示，我如何才能开始动画？在显示 div 的那一刻，类型已经存在。

这是现在基本上发生的事情[http://jsfiddle.net/caW8d/](http://jsfiddle.net/caW8d/)

```
$(document).ready(function()                         
/*-----------------FADE EFFECT --------------------*/
    {   var synopsis = $('#synopsis');
function runIt() {
   synopsis.animate({opacity:'+=1'}, 1000);
   synopsis.animate({opacity:'-=0.9'}, 2000, runIt).delay(2000);
}
       runIt(); 

    $("#trigger1").mouseover(function () {
   $("#somethingThere").fadeIn('slow');
});
    $("#trigger1").mouseout(function() {
    $("#somethingThere").fadeOut('slow');
});
    $("#trigger1").click(function () {
   $("#caption").fadeIn('slow');
});
    $("#caption").click(function () {
   $("#caption").hide();
});

/*-----------------TYPERWRITER EFFECT --------------------*/    
      $.fn.typer = function(options) {
        var defaults = {speed: 50},
            settings = $.extend({}, defaults, options);
        return this.each(function(e,options){
            var el = $(this), 
                text = el.html(), 
                chars = 0, 
                timeout = null, 
                tw = function() {
                    el.html(text.substr(0, chars));
                    chars += 1;
                    timeout = setTimeout(function(){tw();}, settings.speed);
                    if(text.length === chars){clearTimeout(timeout);}
                };

            el.html("");
            tw();
        });
    };

})(jQuery);

$(function(){
    $('div').typer({speed:25});

    }); 
```

这是动画的样子[http://jsfiddle.net/yMYgZ/](http://jsfiddle.net/yMYgZ/)

```
(function($) {
    $.fn.typer = function(options) {
        var defaults = {speed: 50},
            settings = $.extend({}, defaults, options);
        return this.each(function(e,options){
            var el = $(this), 
                text = el.html(), 
                chars = 0, 
                timeout = null, 
                tw = function() {
                    el.html(text.substr(0, chars));
                    chars += 1;
                    timeout = setTimeout(function(){tw();}, settings.speed);
                    if(text.length === chars){clearTimeout(timeout);}
                };

            el.html("");
            tw();
        });
    };

})(jQuery);

$(function(){
    $('div').typer({speed:25});
}); 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:12:45.697

显示/隐藏 jquery 方法都有回调。假设您想`typer`在元素`id="#somethingThere`淡入后调用插件作为示例：

```
 $('#somethingThere').fadeIn(100, function() {
    $('div').typer({speed:25});
 }); 
```

fadeIn 的文档示例：http: [//api.jquery.com/fadeIn/](http://api.jquery.com/fadeIn/)

该函数将在淡入发生后执行。

# asp.net - ASP.NET MVC - 将外部模型传递给编辑器模板

> ID：16041961
> 
> 赞同：4
> 
> 时间：2013-04-16T16:11:10.393
> 
> 标签：asp.net, .net, asp.net-mvc, razor, mvc-editor-templates

我的大多数表单都使用自定义编辑器模板，但是在尝试使用它们来呈现自定义对象选择器时，我发现没有简单的方法将有关包含上下文的信息传递给编辑器模板。

具体来说，我的主表单呈现域对象的编辑，编辑器模板需要呈现一个 AJAX 选择器，其中包含依赖于域对象 ID 的对象列表。我`additionalViewData`目前正在使用参数传递 ID，我认为这很容易出错，因此非常难看。

我的表单包含类似于以下的代码：

```
@Html.EditorFor(model => model.CategoryId, new { id = model.id }) 
```

编辑器模板包含如下代码：

```
@{
var domainObjectId = ViewData["id"] as int?;
} 
```

我正在使用自定义`ModelMetadataProvider`来选择对象选择器编辑器模板，并希望使用类似的技术将有关包含模型的信息传递给编辑器模板，但这似乎是不可能的。

所以，我的问题是：

1.  无论如何使用 a`ModelMetadataProvider`将有关包含模型的信息传递给编辑器模板？
2.  `additionalViewData`如果没有，除了通过弱类型参数传递每条附加信息之外，是否有任何更简洁/更简单的方法来实现我正在尝试的内容？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T16:49:30.470

您需要了解 EditorTemplates 被设计为特定于类型，而不是特定于上下文。使用 AdditionalViewData 参数对此进行了一些思考，但这是您将获得的最佳结果。

如果您担心类型安全，请改用 ViewBag，它是 ViewData 的类型安全动态包装器。

```
@{
    var domainObjectId = ViewBag.Id;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T16:41:47.407

我想知道首先创建此视图模型的控制器是否应该是选择对象列表的东西。因此，与其在您的视图模型上拥有一个整数属性，您还可以拥有另一种类型的视图模型的子属性，即：

```
public class OuterViewModel
{
    public CategoryViewModel Category { get; set; }
}

public class CategoryViewModel
{
    public int CategoryId { get; set; }

    public IEnumerable<SelectListItem> ListOfThings { get; set; }
} 
```

然后你的原始视图可以有：

```
@Html.EditorFor(model => model.Category) 
```

CategoryViewModel 的 EditorTemplate 如下所示：

```
@model CategoryViewModel
@Html.DropDownFor(m => m.CategoryId, Model.ListOfThings) 
```

您唯一需要记住的是，如果您进行任何服务器端业务逻辑验证、添加模型错误并返回到您的视图，您将需要在控制器发布操作中重新填充您的事物列表。

# python - 从 bash 脚本中愚弄 python 的 os.isatty

> ID：16041963
> 
> 赞同：7
> 
> 时间：2013-04-16T16:11:21.963
> 
> 标签：python, bash, cron, tty

我正在编写一个将从 cron 调用的 bash 脚本。

bash 脚本运行一个 python 命令，该命令通过使用 [pythons os.isatty 函数](http://docs.python.org/2/library/os.html#os.isatty)在终端中进行感知，并根据它是手动运行还是通过 cron 运行输出不同的内容。这使调试变得非常困难，我想使它始终假定它不在 TTY 中。

我希望能够在 bash 脚本中添加一些东西来欺骗 python 脚本，使其没有在终端中运行，因此总是输出相同的东西。

为了确认，我可以控制 bash 脚本，但不想编辑 python，因为这是一个打包的应用程序。

有任何想法吗？

我希望这是有道理的。

非常感谢您提前。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T16:26:23.797

您可以将输出重定向到`cat`（假设脚本测试`sys.stdout`的文件描述符的`atty`-ness）。

```
python myscript.py | cat 
```

一个.py

```
import sys
print sys.stdout.isatty() 
```

去测试：

```
> python a.py
True
> python a.py | cat
False 
```

# c++ - cppUnit 在启动每个单元测试时是否使用 fork()？

> ID：16041964
> 
> 赞同：3
> 
> 时间：2013-04-16T16:11:25.020
> 
> 标签：c++, c, unit-testing, cppunit

我正在使用 cppunit 对我的项目进行单元测试。

我想知道 cppunit 是否在新的 fork() 系统调用中启动每个单元测试，因为：

*   使用 fork 将允许创建一个新的地址空间来运行每个单元测试
*   使用 fork 将允许单元测试保持运行，即使其中一个导致崩溃。

我定义了一个全局变量，然后我尝试在单元测试中更改全局变量，并且更改对父进程没有影响，但不幸的是我发现全局变量已更改。

所以默认情况下 cppunit 不支持使用`fork()`. 我想知道 cppunit 中是否有可以启动单元测试的宏`fork()`？

我的测试按以下方式定义：

```
class MYTest : public CppUnit::TestCase {

   CPPUNIT_TEST_SUITE( MYTest );
   CPPUNIT_TEST( getRetryValueTest );
   CPPUNIT_TEST( getRetryValueTest2 );
   CPPUNIT_TEST_SUITE_END(); 

   public:
      virtual void setUp();

      void getRetryValueTest();
      void getRetryValueTest2();
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T02:14:42.517

Cppunit 不使用 fork 来分隔测试。但是，同一套件中的测试是独立的对象，因此每个测试都有自己的一组变量，因此彼此独立，不会相互影响。

# php - PHP：发送带空格的 URL

> ID：16041974
> 
> 赞同：0
> 
> 时间：2013-04-16T16:12:02.430
> 
> 标签：php, url, get

$my_venue 有带空间的数据。例如=“娜娜诺诺”。当我将鼠标悬停在链接上时，它会被空间切断。如果没有空间，它工作正常。

```
<tr onmouseover="mouse_event(this, 'hlt');" onmouseout="mouse_event(this, '');">
    <?php
    $my_venue= $row['name'];

    echo "<td><a href= http://x.x.x.x:xx/JUNK/search_results.php?user-val=&venue-val=$my_venue&region-val=&lhversion-val=&releaseversion-val=&testtype-val=&api-val=&rate-val=&journaldate-val=&comments-val=&date-val=&record=%25>{$row['name']} </a></td>";
    echo "<td>{$row['region']} </td>"; 
```

哦，顺便说一句，我需要空间，因为我需要将此信息传递给数据库，并且在数据库中，数据确实有空间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:13:23.623

您需要对值进行[原始编码](http://php.net/rawurlencode)并引用属性。尤其是后者是您应该始终做的事情。浏览器可能会因缺乏编码而宽容，但未引用参数中的空格无论如何都会结束它。

```
echo '<td><a href="http://x.x.x.x:xx/JUNK/search_results.php?user-val=&venue-val='.rawurlencode($my_venue).'&region-val=&lhversion-val=&releaseversion-val=&testtype-val=&api-val=&rate-val=&journaldate-val=&comments-val=&date-val=&record=%25">'.htmlspecialchars($row['name']).'</a></td>'; 
```

哦，如果`mouse_event()`在悬停时添加 CSS 类：您可以使用`:hover`CSS 伪类，并且不需要任何 JavaScript。当然，除非您需要支持 IE6，但如果是这种情况，您的问题无论如何都出在其他地方。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:13:28.473

```
$my_venue = str_replace(' ', '%20', $row['name']) 
```

# javascript - 卡在 javascript 中实现 HMAC

> ID：16041982
> 
> 赞同：1
> 
> 时间：2013-04-16T16:12:26.553
> 
> 标签：javascript, cryptography, hmac

我一直在尝试用 Javascript 编写 HMAC 算法，但已经到了无法弄清楚出了什么问题的地步。我正处于创建内部哈希的位置，但在使用 SHA1（步骤 6）时，返回的值与 FIPS 198 文档示例 A1 中指定的值不匹配。

```
/*
function hmac (key, message)
    if (length(key) > blocksize) then
        key = hash(key) // keys longer than blocksize are shortened
    end if
    if (length(key) < blocksize) then
        key = key ∥ [0x00 * (blocksize - length(key))] // keys shorter than blocksize are zero-padded ('∥' is concatenation) 
    end if

    o_key_pad = [0x5c * blocksize] ⊕ key // Where blocksize is that of the underlying hash function
    i_key_pad = [0x36 * blocksize] ⊕ key // Where ⊕ is exclusive or (XOR)

    return hash(o_key_pad ∥ hash(i_key_pad ∥ message)) // Where '∥' is concatenation
end function
*/

/*
STEPS
Step 1
Table 1: The HMAC Algorithm
STEP-BY-STEP DESCRIPTION
If the length of K = B: set K0 = K. Go to step 4.
Step 2 If the length of K > B: hash K to obtain an L byte string, then append (B-L)
      zeros to create a B-byte string K0 (i.e., K0 = H(K) || 00...00). Go to step 4.
Step 3 If the length of K < B: append zeros to the end of K to create a B-byte string K0
      (e.g., if K is 20 bytes in length and B = 64, then K will be appended with 44
     zero bytes 0x00).
Step 4 Exclusive-Or K0 with ipad to produce a B-byte string: K0  ̄ ipad.
Step 5 Append the stream of data 'text' to the string resulting from step 4:
      (K0  ̄ ipad) || text.
Step 6 Apply H to the stream generated in step 5: H((K0  ̄ ipad) || text).
Step 7 Exclusive-Or K0 with opad: K0  ̄ opad.
Step 8 Append the result from step 6 to step 7:
      (K0  ̄ opad) || H((K0  ̄ ipad) || text).
Step 9 Apply H to the result from step 8:
      H((K0  ̄ opad )|| H((K0  ̄ ipad) || text)).
Step 10 Select the leftmost t bytes of the result of step 9 as the MAC.
*/

/*
FIPS PUB 198, The Keyed-Hash Message Authentication Code
http://csrc.nist.gov/publications/fips/fips198/fips-198a.pdf

A.1
SHA-1 with 64-Byte Key
*/

//Check sha1 hashers
if ($u.sha1("test") !==  CryptoJS.SHA1("test").toString()) {
    throw new Error("hasher output mismatch");
}

var key = "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f";
var k0 = "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f";
var k0ipad = "36373435323330313e3f3c3d3a3b383926272425222320212e2f2c2d2a2b282916171415121310111e1f1c1d1a1b181906070405020300010e0f0c0d0a0b0809";
var k0opad = "5c5d5e5f58595a5b54555657505152534c4d4e4f48494a4b44454647404142437c7d7e7f78797a7b74757677707172736c6d6e6f68696a6b6465666760616263";
var ipt = "36373435323330313e3f3c3d3a3b383926272425222320212e2f2c2d2a2b282916171415121310111e1f1c1d1a1b181906070405020300010e0f0c0d0a0b080953616d706c65202331";
var h1 = "bcc2c68cabbbf1c3f5b05d8e7e73a4d27b7e1b20";
var message = "Sample #1";
var result = "";

function hmac(key, message) {
    key = key.replace(/\s*/g, "");

    var swap = false, // for swap endianess
        length = key.length,
        blockSize = 64 * 2, // for sha 1 = 64, as hex * 2
        ml = message.length,
        i = 0,
        o_key_pad = "",
        i_key_pad = "",
        ikeypmessage = "",
        hipt,
        temp1,
        temp2;

    // 1\. If the length of K = B: set K0 = K. Go to step 4.
    if (length !== blockSize) {
        // 2\. If the length of K > B: hash K to obtain an L byte string, then append (B-L)
        //    zeros to create a B-byte string K0 (i.e., K0 = H(K) || 00...00). Go to step 4.
        //    Actually in code, goto step3 ri append zeros
        if (length > blockSize) {
            key = $u.sha1(key);
        }

        // 3\. If the length of K < B: append zeros to the end of K to create a B-byte string K0
        //   (e.g., if K is 20 bytes in length and B = 64, then K will be appended with 44
        //   zero bytes 0x00).
        while (key.length < blockSize) {
            key += "0";
            i += 1;
        }
    }

    // check against the FIP198 example
    if (key !== k0) {
        console.log(key, k0);
        throw new Error("key and k0 mismatch");
    }

    // 4\. Exclusive-Or K0 with ipad to produce a B-byte string: K0  ̄ ipad.
    // 7\. Exclusive-Or K0 with opad: K0  ̄ opad.
    i = 0;
    while (i < blockSize) {
        temp1 = parseInt(key.slice(i, i + 2), 16);

        temp2 = (temp1 ^ 0x36).toString(16);
        i_key_pad += temp2.length > 1 ? temp2 : "0" + temp2;

        temp2 = (temp1 ^ 0x5c).toString(16);
        o_key_pad += temp2.length > 1 ? temp2 : "0" + temp2;

        i += 2;
    }

    if (i_key_pad !== k0ipad) {
        console.log(i_key_pad, k0ipad);
        throw new Error("i_key_pad and k0ipad mismatch");
    }

    if (o_key_pad !== k0opad) {
        console.log(o_key_pad, k0opad);
        throw new Error("o_key_pad and k0opad mismatch");
    }

    // 5\. Append the stream of data 'text' to the string resulting from step 4:
    //    (K0  ̄ ipad) || text.
    i = 0;
    temp1 = "";
    while (i < ml) {
        temp1 += message.charCodeAt(i).toString(16);
        i += 1;
    }

    ikeypmessage = i_key_pad + temp1;
    if (ikeypmessage !== ipt) {
        console.log(i_key_pad + temp1, ipt);
        throw new Error("i_key_pad + temp1 and ipt mismatch");
    }

    // convert hex string to ucs2 string
    ml = ikeypmessage.length;
    temp1 = [];
    i = 0;
    while (i < ml) {
        // for changinging endianess
        if (swap) {
            temp1[i >> 1] = ikeypmessage.charAt(i + 1) + ikeypmessage.charAt(i);
        } else {
            temp1[i >> 1] = ikeypmessage.slice(i, i + 2);
        }

        i += 2;
    }

    // for changinging endianess
    if (swap) {
        temp1.reverse();
    }

    // convert byte to ucs2 string
    ml = temp1.length;
    temp2 = "";
    i = 0;
    while (i < ml) {
        temp2 += String.fromCharCode(parseInt(temp1[i], 16));
        i += 1;
    }

    ikeypmessage = temp2;

    // This is the point where it goes bottom up
    // 6\. Apply H to the stream generated in step 5: H((K0  ̄ ipad) || text).
    console.log(ikeypmessage);
    hipt = $u.sha1(ikeypmessage);
    if (hipt !== h1) {
        console.log(hipt, h1);
        throw new Error("hipt and h1 mismatch");
    }
}

console.log(hmac(key, message)); 
```

此代码可从[jsfiddle 获得](http://jsfiddle.net/Xotic750/nfLd3/)，如果有人可以给我一个关于我哪里出错的指针，我将不胜感激。

我尝试从十六进制字符串转换为 ucs2 字符串并更改字节顺序，都给了我不同的结果，但没有一个与示例匹配。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T18:38:10.750

你的问题是你有错误的测试向量。你的钥匙：

> 000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3

并且您的消息“ `Sample #1`”来自**Example A.1: SHA-1 with 64-Byte Key** in [FIPS 198a](http://csrc.nist.gov/publications/fips/fips198/fips-198a.pdf)，而您的预期输出：

> 74766e5f6913e8cb6f7f108a11298b15010c353a

来自**示例 A.2: SHA-1 with 20-Byte Key**。示例 A.1 的正确第一阶段哈希输出是：

> bcc2c68cabbbf1c3f5b05d8e7e73a4d27b7e1b20

另请注意，NIST 发布了一套更新的、更全面的[HMAC-SHA-1 和 HMAC-SHA-2 测试向量](http://csrc.nist.gov/groups/ST/toolkit/examples.html#aMsgAuth)。

* * *

好的，我发现了第二个问题。查看 的源代码`$u.sha1()`，该函数以：

```
var msg = internal.utf8EncodeToCharCodeArray(str) 
```

也就是说，它希望其输入是一个 Unicode 字符串，并在对其进行散列之前使用 UTF-8 编码将其转换为八位字节字符串。特别是，这意味着代码点高于 127 的字符将转换为多个字节。

不幸的是，HMAC 构造在原始八位字节字符串上运行，而不是在 Unicode 字符串上运行。更糟糕的是，似乎没有任何方法可以将原始八位字节字符串提供给`$u.sha1()`; UTF-8 转换是自动完成的，您需要在 HMAC 中散列的八位字节字符串甚至不太可能成为*任何*Unicode 字符串的有效 UTF-8 编码。

但是，如果您改用[CryptoJS](https://code.google.com/p/crypto-js/)，则可以将八位字节字符串（或它的十六进制表示）转换为 a`WordArray`并将其直接传递给`CryptoJS.SHA1()`：

```
var words = CryptoJS.enc.Latin1.parse(ikeypmessage);
hipt = CryptoJS.SHA1(words).toString(); 
```

当然，如果您使用的是 CryptoJS，将密钥和消息转换为`WordArray`s 开始，然后直接使用它们会更容易和更有效。或者您可以只使用内置`CryptoJS.HmacSHA1()`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-14T14:24:53.770

如果我没看错，您将“0”附加到密钥，这是数字 0 的字符。并且“0”字符的十六进制数为 0x30，并且通过[HMAC rfc 文档](https://www.rfc-editor.org/rfc/rfc2104)，您需要应用 0x00 字节，即 NULL 字符ascii 表，而不是 0x30。

* * *

##Idea## 似乎 sha1 函数默认返回 40 个十六进制字符的字符串，这只是底层数据的*十六进制字符串表示，***而不是数据本身**。意思是如果 sha1 产生数据流，例如：

`0100 1110` *如果表示为十六进制字符串，则为“4e”*

，它返回“4e”。默认。

但是我们不能直接在我们的[hmac 算法](https://en.wikipedia.org/wiki/Hash-based_message_authentication_code#Implementation)中使用它，因为“4e”是*不同*的数据流：

`0011 0110 0110 1001` *它的十六进制是“3465”*

所以我们不能使用 sha1*真正*产生的不同数据，我们可以做的是底层数据的这个十六进制字符串表示（“4e”）转换成它的字符对应：

`0100 1110`<-- ("4e") 变为 char ("N")--> `0100 1110`。

在这种情况下，最好认为 sha1 通过处理每 4 位基础数据（*一个*nibble ）来吐出十六进制字符串。我们通过将 8 位数据映射到它们的字符串表示来压缩该字符串。

也就是说 char "N" 是 sha1 生成的数据的精确映射，它*不是 data 的十六进制字符串表示*。如果我们有 40 个十六进制字符，这意味着 40 个字节，通过 sha1 rfc，sha1 产生 20 个字节的数据。通过进行这种转换，我们得到了 20 字节的数据，并且我们一直在使用具有相同效果的字符串，如果我们使用`ArrayBuffer`，至少是这样。

* * *

## 执行

我已经完成了一些使用上述方法的代码。`ArrayBufer`因此，它应该在您出于任何原因无法访问的地方工作。它仅适用于纯 JavaScript 字符串。

我使用 Rusha.js 作为 sha1 函数，你可以在[这里](https://github.com/srijs/rusha)找到所有信息。你可以使用任何东西。由于帖子正文限制为 30000 个字符，因此无法在此处包含它。这一切都在 jsfiddle 链接下面的代码中。用于测试的密钥和消息（baseString）从[twitter api 示例](https://dev.twitter.com/oauth/overview/creating-signatures)中使用。还有 3 个函数，`byteLength` `hexToString`和`oneByteChar`用于`hmacSha1`使用的操作。

```
var sha = new Rusha();  
var sha1 = sha.digest; 

function byteLength(str){  // counts characters only 1byte in length, of a string. Very similar to oneByteChar()
                           // For clarity I made 2 functions.
    var len = str.length;
    var i = 0;
    var byteLen = 0;
    for (i; i < len; i++){
      var code = str.charCodeAt(i); 
      if(code >= 0x0 && code <= 0xff) byteLen++; 
      else{
         throw new Error("More the 1 byte code detected, byteLength functon aborted.");
         return;
      }

    }

    return byteLen;

}

function oneByteCharAt(str,idx){
     var code = str.codePointAt(idx);
     if(code >= 0x00 && code <= 0xff){ // we are interested at reading only one byte
          return str.charAt(idx); // return char.

     }    
     else{ 
        throw new Error("More then 1byte character detected, |oneByteCharAt()| function  is aborted.")
     }

}

function hexToString(sha1Output){ // converts every pair of hex CHARS to their character conterparts
                                  // example1: "4e" is converted to char "N" 
                                  // example2: "34" is converted to char "4"

  var l;        // char at "i" place, left
  var lcode;    // code parsed from left char
  var shiftedL; // left character shifted to the left

  var r;     // char at "i+1" place, right
  var rcode; // code parsed from right char

  var bin;   // code from bitwise OR operation
  var char;  // one character
  var result = ""; // result string 

 for (var i = 0; i < sha1Output.length; i+=2){ // in steps by 2
         l = sha1Output[i]; // take "left" char

         if(typeof l === "number") lcode = parseInt(l); // parse the number
         else if(typeof l === "string") lcode = parseInt(l,16);  // take the code if char letter is hex number (a-f)

          shiftedL = lcode << 4 ; // shift it to left 4 places, gets filled in with 4 zeroes from the right
          r = sha1Output[i+1];    // take next char

         if(typeof r === "number") rcode = parseInt(r); // parse the number
         else if(typeof r === "string") rcode = parseInt(r,16); 

          bin = shiftedL | rcode; // concatenate left and right hex char, by applying bitwise OR
          char = String.fromCharCode(bin); // convert back code to char
          result += char;

  }
  // console.log("|"+result+"|", result.length); // prints info, line can be deleted

  return result;
}

function hmacSha1(key, baseString){   // the actual HMAC_SHA1 function

  var blocksize = 64; // 64 when using these hash functions: SHA-1, MD5, RIPEMD-128/160 .
  var kLen = byteLength(key); // length of key in bytes;
  var opad = 0x5c; // outer padding  constant = (0x5c) . And 0x5c is just hexadecimal for backward slash "\" 
  var ipad = 0x36; // inner padding contant = (0x36). And 0x36 is hexadecimal for char "6".

    if(kLen < blocksize){  
       var diff = blocksize - kLen; // diff is how mush  blocksize is bigger then the key
    }

    if(kLen > blocksize){ 
       key = hexToString(sha1(key)); // The hash of 40 hex chars(40bytes) convert to exact char mappings, from 0x00 to 0xff,
                                     // Produces string of 20 bytes.

       var hashedKeyLen =  byteLength(key); // take the length of key
    }

    var opad_key = ""; // outer padded key
    var ipad_key = ""; // inner padded key

    (function applyXor(){  // reads one char, at the time, from key and applies XOR constants on it acording to byteLength of the key
       var o_zeroPaddedCode;  // result from opading the zero byte
       var i_zeroPaddedCode;  // res from ipading the zero byte
       var o_paddedCode;      // res from opading the char from key
       var i_paddedCode;      // res from ipading the char from key

       var char;      
       var charCode;

       for(var j = 0; j < blocksize; j++){ 

             if(diff && (j+diff) >= blocksize || j >= hashedKeyLen){ // if diff exists (key is shorter then blocksize) and if we are at boundry 
                                                                     // where we should be, XOR 0x00 byte with constants. Or the key was 
                                                                     // too long and was hashed, then also we need to do the same.
                o_zeroPaddedCode = 0x00 ^ opad; // XOR zero byte with opad constant  
                opad_key += String.fromCharCode(o_zeroPaddedCode); // convert result back to string 

                i_zeroPaddedCode = 0x00 ^ ipad;
                ipad_key += String.fromCharCode(i_zeroPaddedCode);
             }
             else {

                char = oneByteCharAt(key,j);     // take char from key, only one byte char
                charCode = char.codePointAt(0);  // convert that char to number

                o_paddedCode =  charCode ^ opad; // XOR the char code with outer padding constant (opad)
                opad_key += String.fromCharCode(o_paddedCode); // convert back code result to string

                i_paddedCode = charCode ^ ipad;  // XOR with the inner padding constant (ipad)
                ipad_key += String.fromCharCode(i_paddedCode);

             }

        }
      //  console.log("opad_key: ", "|"+opad_key+"|", "\nipad_key: ", "|"+ipad_key+"|"); // prints opad and ipad key, line can be deleted
    })()

    return sha1(opad_key + hexToString(sha1(ipad_key + baseString))) ;

}

var baseStr = "POST&https%3A%2F%2Fapi.twitter.com%2F1%2Fstatuses%2Fupdate.json&include_entities%3Dtrue%26oauth_consumer_key%3Dxvz1evFS4wEEPTGEFPHBog%26oauth_nonce%3DkYjzVBB8Y0ZFabxSWbWovY3uYSQ2pTgmZeNu2VS4cg%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1318622958%26oauth_token%3D370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb%26oauth_version%3D1.0%26status%3DHello%2520Ladies%2520%252B%2520Gentlemen%252C%2520a%2520signed%2520OAuth%2520request%2521"

var key= "kAcSOqF21Fu85e7zjz7ZN2U4ZRhfV3WpwPAoE3Z7kBw&LswwdoUaIvS8ltyTt5jkRh4J50vUPVVHtR2YPi5kE";
console.log(hmacSha1( key, baseStr ) ); // b679c0af18f4e9c587ab8e200acd4e48a93f8cb6 
```

[hmac_sha1 测试](https://jsfiddle.net/jmuy5Lch/)（打开浏览器控制台查看摘要）

可以找到其他测试向量（键和消息）： [here from official hmac_sha1 guy](http://csrc.nist.gov/groups/ST/toolkit/documents/Examples/HMAC_SHA1.pdf)和[wiki](https://en.wikipedia.org/wiki/Hash-based_message_authentication_code#Examples)。

[或者，您可以在jsSHA](https://caligatio.github.io/jsSHA/)上输入几乎任何内容，看看是否符合您在 hmacSha1 摘要中看到的内容。

* * *

**注意：**如果键或消息具有“”转义序列字符，则函数将产生不正确的摘要（结果）。示例： `key = "ke\y"`并且`baseStr = "So\me messa\ge"`该函数生成摘要，例如两个字符串中都不存在“”。

你应该像这样逃避它：

`key = "ke\\y"`和`baseStr = "So\\me messa\\ge"`。

然后它的摘要正如预期的那样。请报告错误和错误。

# android - 三星 Galaxy fileNameMap.getContentTypeFor(path) 返回 NULL

> ID：16041984
> 
> 赞同：0
> 
> 时间：2013-04-16T16:12:28.290
> 
> 标签：android

我的申请中有一些严重的问题。在任何三星 Galaxy 手机“fileNameMap.getContentTypeFor(path)”上运行此行时，我得到空值。我在 NEXUS、LG Optimus 和许多其他手机上尝试了相同的代码，但此语句返回的不是 null，而是任何文件类型，即 video/mp4、video/3gp、video.avi 等...请帮助

```
//----Code

public static String getMimeType(){

        String path="__MACOSX/._MR_BEAN_FUNNY.3gp";

        FileNameMap fileNameMap = URLConnection.getFileNameMap();
        if (path.startsWith("/"))
        {

            path = "file:/"+ path;
        }
        else
        {

            path = "file://" + path;
        }

       String type = fileNameMap.getContentTypeFor(path);

        return type;        
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T15:10:51.543

这解决了我的问题....

```
String type;

        String extension = MimeTypeMap.getFileExtensionFromUrl(path);
        type=MimeTypeMap.getSingleton().getMimeTypeFromExtension(extension);

return type; 
```

# java - Multimaps 中的 Java 泛型擦除

> ID：16041990
> 
> 赞同：4
> 
> 时间：2013-04-16T16:12:40.213
> 
> 标签：java, generics, guava

我有两个由 (i) s 和 (ii) `Multimap`s`String`索引的s 和一个输出 s 列表的例程。`Integer``Double``String`

```
public static void outputInteger(Multimap<Integer, String> map) {
    for (Integer key : map.keySet()) {
        Collection<String> strings = map.get(key);
        output(strings);
    }
}

public static void outputDouble(Multimap<Double, String> map) {
    for (Double key : map.keySet()) {
        Collection<String> strings = map.get(key);
        output(strings);
    }
} 
```

我想将这些组合成一个例程，`Number`用作和的超`Integer`类`Double`

```
public static void outputNumber(Multimap<? extends Number, String> map) {
    for (Number key : map.keySet()) {
        Collection<String> ids = map.get(key); //** 
    }
} 
```

但带星号的行无法编译

```
The method get(capture#5-of ? extends Number) in the type 
Multimap<capture#5-of ? extends Number,String> is not 
applicable for the arguments (Number) 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T16:26:19.297

宣言

```
Multimap<? extends Number, String> map; 
```

表示 map 的键类型是*Number 的未知但特定的子类型（包括）*。换句话说，编译器认为它可能是 a `Multimap<Integer, String>`， or `Multimap<Short, String>`， or`Multimap<Number, String>`等​​。因此，您不能调用`map.get(Number)`，因为据编译器所知，它可能是 a `Multimap<Double, String>`。

无法做到这一点的原因在`put`. 你应该可以做`put(Number, String)`吗`map`？不，因为如果它碰巧是 a `Multimap<Integer, String>`，那么您可以添加一个`Double`密钥，这将违反地图的完整性。

使用普通`Map<K, V>`界面，这不是问题，因为`get`定义为`get(Object)`，而不是`get(K)`。

保罗的回答对这种情况有很好的解决方法。本质上，他使用中间泛型方法为未知类型（在本例中由 表示`capture#5-of ? extends Number`）命名（类型参数`T`）。这允许您将发生在两个不同上下文中的捕获关联起来，以便您可以在这些上下文中执行某些操作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-16T16:24:16.083

您应该能够使用[通用方法](http://docs.oracle.com/javase/tutorial/extra/generics/methods.html)来实现您想要的：

```
public static <T extends Number> void outputNumber(Multimap<T, String> map) {
    for (T key : map.keySet()) {
        Collection<String> strings = map.get(key);
        output(strings);
    }
} 
```

它不适用于通配符的原因是因为`? extends Number`意味着*某些未知类型*is 或 extends `Number`。同时，`Number key`可以引用其他一些不兼容的类型（编译器都知道）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-16T16:28:19.600

```
public static void output(Multimap<? extends Number, String> map) {
    for (Collection<String> strings : map.asMap().values()) {
        output(strings);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T16:28:12.743

问题是您没有传递泛型参数而是声明它。

如果您有这种类型的实现，则不会发生错误

```
public static <T extends Number> void outputNumber(Multimap<T, String> map) {

        for (T key : map.keySet()) {
            map.get(key);
        }
    } 
```

# sql-server - SQL_ATTR_QUERY_TIMEOUT 未超时

> ID：16041991
> 
> 赞同：2
> 
> 时间：2013-04-16T16:12:42.567
> 
> 标签：sql-server, sql-server-2008-r2, timeout, odbc

**设置**

使用 SQL Server 2008 R2。

我使用带有 SQL_ATTR_QUERY_TIMEOUT 参数的 SQLSetStmtAttr 函数对存储过程进行了 ODBC 调用，该存储过程应在 3 秒后超时。

```
SQLSetStmtAttr( command, SQL_ATTR_QUERY_TIMEOUT, (SQLPOINTER)&timeOut, NULL ); 
```

**测试**

我在存储过程中设置了 15 秒的延迟。存储过程确实需要 15 多秒才能返回。

```
WAITFOR DELAY '00:00:15' 
```

**问题**

问题是存储过程正确返回，我预计会出现错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:06:19.580

发现的问题。

timeOut 变量（int）作为引用传入 SQLSetStmtAttr，引用位置的值远大于 3。

正确的实现是：

```
SQLSetStmtAttr( command, SQL_ATTR_QUERY_TIMEOUT, (SQLPOINTER)timeOut, NULL ); 
```

# ruby-on-rails - 允许用户在 rails 3 中删除自己的评论

> ID：16041994
> 
> 赞同：0
> 
> 时间：2013-04-16T16:12:44.383
> 
> 标签：ruby-on-rails, ruby

对于每个帖子，都有帖子评论。

Postcomment 的模型如下所示：

```
class Postcomment < ActiveRecord::Base
  attr_accessible :comment_content

  belongs_to :user
  belongs_to :post
end 
```

和 Post 模型

```
class Post < ActiveRecord::Base
  attr_accessible :content, :image, :comment_content
  belongs_to :user
  has_many :postcomments, dependent: :destroy
end 
```

我想允许用户删除他们自己的帖子评论。这是我在视图中已经拥有的

_postcomment.html.erb

```
<% if post.postcomments.exists? %>
  <% post.postcomments.each do |postcomment| %>
    <%= link_to postcomment.user.name, postcomment.user %>
    <span class="content2"><%= postcomment.postcomment_content %></span>
  <% end %>
<% end %> 
```

应该如何更改下面的代码以允许用户删除评论？

```
 <% if current_user?(postcomment.user) %>
    <%= link_to "delete", postcomment.content, method: :delete,
                                             confirm: "You sure?",
                                             title: postcomment.content %>
 <% end %> 
```

`current_user`会话助手中的方法

```
def current_user=(user)
    @current_user = user
  end

  def current_user
    @current_user ||= User.find_by_remember_token(cookies[:remember_token])
  end

  def current_user?(user)
    user == current_user
  end 
```

这是 Postcomments 表

```
 create_table "postcomments", :force => true do |t|
    t.text      "content"
    t.integer   "user_id"
    t.integer   "post_id"
    t.timestamp "created_at",      :null => false
    t.timestamp "updated_at",      :null => false
    t.text      "comment_content"
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T20:55:41.140

如果您只是比较用户ID，可能会更好。这也更容易调试。

```
def current_user?(user)
  user.id == current_user.id
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:40:11.433

也许...

如果 current_user == postcomment.user

如果 current_user 无论如何都返回一个用户实例......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T21:02:41.540

也许是这样的：

```
<%= link_to("delete", postcomment.content, :method => :delete, :confirm => "You sure?", :title => postcomment.content) if postcomment.user == current_user %> 
```