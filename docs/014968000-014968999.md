# StackOverflow 问答 14968000-14968999

# c# - 尝试从 SSRS 服务器读取报告名称时出现服务器错误

> ID：14968000
> 
> 赞同：1
> 
> 时间：2013-02-19T21:41:16.860
> 
> 标签：c#, web-services, reporting-services

我正在尝试将报告名称从 SSRS 服务器读取到列表中。我已经毫无问题地创建了 Web 引用，并且可以通过 IE 访问 Web 服务。

我收到 503 错误：执行代码时服务器不可用。我认为这可能是权限问题，但使用管理员凭据无济于事。异常发生在“items = service.ListChildren("/BRADS", true) 行。

```
 ReportService.ReportingService2005 service;

    public ReportsRepository()
    {
        service = new ReportService.ReportingService2005();
        //string rptUserID = ConfigurationManager.AppSettings["rptUser"];
        //string rptPassword = ConfigurationManager.AppSettings["rptPwd"];
        //System.Net.NetworkCredential cred = new System.Net.NetworkCredential(rptUserID, rptPassword);
        //service.Credentials = cred;
        service.Credentials = System.Net.CredentialCache.DefaultCredentials; 
    }

    IEnumerable<DataModels.ReportingService> IReportsRepository.GetReports()
    {
        CatalogItem[] items;
        DataModels.ReportingService rpt = null;
        List<DataModels.ReportingService> lstReports = null;
        try
        {
            items = service.ListChildren("/BRADS", true);
            if (items != null)
            {
                lstReports = new List<DataModels.ReportingService>();
                foreach (CatalogItem item in items)
                {
                    if (item.HiddenSpecified == false && item.Type == ItemTypeEnum.Report)
                    {
                        rpt = new DataModels.ReportingService();
                        rpt.ReportName = item.Name;
                        rpt.ReportPath = item.Path;
                        rpt.Category = item.Description;
                    }
                    lstReports.Add(rpt);
                }
            }
        }

        catch (Exception ex)
        {
            throw ex;
        }

        return lstReports; 
```

任何想法将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T02:49:11.670

您需要将 service.Url 属性设置为有效的 RS2005 端点（即。`http://servername/reportserver/reportservice2005.asmx`）

# c# - Xml 序列化浮点值

> ID：14968001
> 
> 赞同：1
> 
> 时间：2013-02-19T21:41:17.487
> 
> 标签：c#, xml, serialization, floating-point

```
Invoice invoice = new Invoice();
invoice.TotalInclTax = 4194.00f;
invoice.serialize(); 
```

我需要一些帮助来序列化浮点值。目前它序列化 4194.00 如下：

```
<TotalInclTax>4194</TotalInclTax> 
```

但是，我想要这样的东西：

```
<TotalInclTax>4194.00<TotalInclTax> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T21:50:50.310

您可以稍微调整您的课程以自定义 TotalInclTax 的序列化方式：

```
static CultureInfo ci = CultureInfo.InvariantCulture;
float _TotalInclTax = 0;

[XmlIgnore]
public float TotalInclTax 
{
    get { return _TotalInclTax ; }
    set { _TotalInclTax  = value; }
}

[XmlElement("TotalInclTax")]
public string CustomTotalInclTax
{
    get { return TotalInclTax.ToString("#0.00", ci); }
    set { float.TryParse(value, NumberStyles.Float, ci, out _TotalInclTax); }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:51:38.757

如果您使用反序列化方法来检索值，应该没有问题。如果您尝试在小数点之后序列化具有非零值的值（如 4672.34），它应该放置小数点和其他数字

但是，如果由于其他原因您绝对需要控制小数点格式，我会说将其序列化为字符串，并使用浮点的字符串打印格式来设置字符串值并将字符串值读回浮点类型的变量。

# git - “git svn rebase”和“git rebase trunk”之间的区别

> ID：14968002
> 
> 赞同：3
> 
> 时间：2013-02-19T21:41:18.673
> 
> 标签：git, svn, git-svn, rebase

我正在为我的项目使用 git-svn。

`git svn rebase`和 和有什么不一样`git rebase trunk`？

`git svn rebase`在master上运行与在master上运行基本相同吗`git rebase trunk`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T13:04:45.877

No.`git svn rebase`相当于运行以下命令：

```
git svn fetch --parent
git rebase remotes/trunk 
```

（假设您正在处理的 Git 分支是基于 off 的`remotes/trunk`；如果它基于不同的 Subversion 分支，它将重新定位到正确的分支。）

不同之处在于`git svn rebase`在进行变基之前从 Subversion 中提取最新代码，并且它还会自动计算出正确的远程分支以进行变基。

# java - 动态更改JTree中特定节点的图标

> ID：14968005
> 
> 赞同：4
> 
> 时间：2013-02-19T21:41:28.950
> 
> 标签：java, swing, icons, jtree, renderer

我已经看到很多在树实例化期间更改节点图标的示例，但我想要一种稍后动态更改单个节点图标的方法。因此，在我的主代码中，我将自定义渲染器添加到我的树中：

```
// Icon I want to set nodes to later
ImageIcon checkIcon = new ImageIcon("check.jpg");

// Creates tree with my nodes
JTree tree = new JTree(nodes.top);

// Create custom renderer
Scenario1Renderer renderer = new Scenario1Renderer();

// Set to single tree selection 
tree.getSelectionModel().setSelectionMode(TreeSelectionModel.SINGLE_TREE_SELECTION);

// Set tree to my custom renderer
//renderer.setRendererIcon(greenIcon);
tree.setCellRenderer(renderer); 
```

我在渲染器中的代码是

```
public class Scenario1Renderer extends DefaultTreeCellRenderer {

ImageIcon rendererIcon;

    public void setRendererIcon(ImageIcon myIcon){
      this.rendererIcon = myIcon;
    };

public Component getTreeCellRendererComponent( 
         JTree tree, 
         Object value, 
         boolean sel, 
         boolean expanded, 
         boolean leaf, 
         int row, 
         boolean hasFocus)
{ 

    Component ret = super.getTreeCellRendererComponent(tree, value,
            selected, expanded, leaf, row, hasFocus);
            //setIcon( rendererIcon ) ;
            return ret;
    } 
```

所以，很明显，如果我设置了我的 rendererIcon，它会用我在树实例化期间传入的图标来绘制我的所有节点。相反，我想要某种方法可以在以后执行我的程序时设置单个节点的图标。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-20T01:09:51.140

您可以根据不同的条件设置不同的图标。下面是一个更改所选节点图标的简单示例：

```
import java.awt.Component;
import javax.swing.Icon;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTree;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;
import javax.swing.tree.DefaultMutableTreeNode;
import javax.swing.tree.DefaultTreeCellRenderer;
import javax.swing.tree.DefaultTreeModel;

public class TestTree {
    private static void createAndShowUI() {
        JFrame frame = new JFrame();
        final JTree tree = new JTree(buildDemoModel());

        tree.setCellRenderer(new DefaultTreeCellRenderer() {
            private Icon loadIcon = UIManager.getIcon("OptionPane.errorIcon");
            private Icon saveIcon = UIManager.getIcon("OptionPane.informationIcon");
            @Override
            public Component getTreeCellRendererComponent(JTree tree,
                    Object value, boolean selected, boolean expanded,
                    boolean isLeaf, int row, boolean focused) {
                Component c = super.getTreeCellRendererComponent(tree, value,
                        selected, expanded, isLeaf, row, focused);
                if (selected)
                    setIcon(loadIcon);
                else
                    setIcon(saveIcon);
                return c;
            }
        });
        tree.setVisibleRowCount(10);
        frame.add(new JScrollPane(tree));

        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLocationByPlatform(true);
        frame.pack();
        frame.setVisible(true);
    }

    private static DefaultTreeModel buildDemoModel() {
        DefaultMutableTreeNode root = new DefaultMutableTreeNode("Root");

        root.add(new DefaultMutableTreeNode("A"));
        root.add(new DefaultMutableTreeNode("B"));
        root.add(new DefaultMutableTreeNode("C"));

        return new DefaultTreeModel(root);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                createAndShowUI();
            }
        });
    }
} 
```

# c# - 如何映射一条路线，它将为 最后一个 url 提供 1 的输出

> ID：14968013
> 
> 赞同：1
> 
> 时间：2013-02-19T21:41:47.653
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-routing

我在 RouteConfig.cs 中有一个自定义路由

```
 routes.MapRoute(
             "Category3",
             "category/{action}/{top}/{middle}/{category}",
            new { controller = "Category", action = "Index", top = UrlParameter.Optional, middle = UrlParameter.Optional, category = UrlParameter.Optional }
            ); 
```

我的 categoryController 看起来像

```
public class CategoryController : Controller
{
    //
    // GET: /Category/

    public string Get(string top, string middle, string category)
    {
        return top + "/" + middle +  "/" + category;

    }

} 
```

一切都很好

```
/category/get/1/2/3 gives output 1/2/3

/category/get/1/2 gives output 1/2 
```

但

```
/category/get/1 gives output "" 
```

如何映射一条路线，它将为​​最后一个 url 提供 1 的输出？

最终目标是获得像

```
/category/get/main/sub/category 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:44:17.883

这条路线是否低于默认路线？如果是这样，您可能正在执行该`Index`操作。路线按从上到下的顺序处理，第一场比赛获胜。

# javascript - 有人可以向我解释这段 javascript 代码吗？

> ID：14968021
> 
> 赞同：0
> 
> 时间：2013-02-19T21:42:18.717
> 
> 标签：javascript

基本上我希望console.log 输出'是的'，但事实并非如此。我能做些什么来让它输出是的，而不是直接在里面引用它`usefulFunction`？

```
App = {
    config: {
        updateThis: 'false'
    },
    init: function(){
        this.usefulFunction(this.config.updateThis);
        this.consoleIt();
    },
    usefulFunction: function(item){
        item = 'yeah';
        // swap the above line for the line below and it works as expected
        // this.config.updateThis = 'yeah';
    },
    consoleIt: function(){
        console.log(this.config.updateThis);
    }
}

App.init(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:45:56.370

在 中 `usefulFunction`，您期望通过引用传递的 C++ 样式会影响对 的原始引用`config.updateThis`，但是，当您调用

```
 this.usefulFunction(this.config.updateThis); 
```

您正在创建对 'false' 字符串的新引用（传递给`usefulFunction`），并且无法更新 from 中的原始`this.config`引用`usefulFunction`。

解决此问题的唯一方法是传递要更新的对象的名称。同样，在 JS 中没有 C++ 引用传递。[**工作示例**](http://jsfiddle.net/dXX5R/)

```
App = {
    config: {
        updateThis: 'false'
    },
    init: function(){
        this.usefulFunction(this.config, 'updateThis');
        this.consoleIt();
    },
    usefulFunction: function(object, prop){
        object[prop] = 'yeah';
    },
    consoleIt: function(){
        console.log(this.config.updateThis);
    }
} 
```

# 问题不在于字符串是不可变的

ᚗ̸̢̛͝ 声称问题在于字符串是不可变的；然而，问题远不止于此。字符串是不可变的这一事实意味着您不能更改当前引用（因此所有其他引用都会更新），但即使它们是可变的，您也不能只设置单独的引用并影响现有引用

```
var a = {b:1};
function change(obj) {
    // This is assigning {c:2} to obj but not to a
    // obj and a both point to the same object, but 
    // the following statement would simple make obj point to a different object
    // In other languages, you could define function(&obj) {}
    // That would allow the following statement to do what you intended
    obj = {c:2};
}

change(a);
console.log(a); // still {b:1} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T21:49:43.110

您可以将对象（而不是字符串对象）传递给您的函数。这是因为 JavaScript 字符串是不可变的。

> **原始值**
> 
> 除了对象之外的所有类型都定义了不可变的值。具体来说，字符串是不可变的（例如，与 C 不同）。我们将这些类型的值称为“原始值”。这在下面的字符串部分中有更详细的解释。
> 
> 来源：[https ://developer.mozilla.org/en-US/docs/JavaScript/Data_structures](https://developer.mozilla.org/en-US/docs/JavaScript/Data_structures)

* * *

如果你想传递一些可变的东西给你的函数，传递一个对象。

```
// Calling code
this.usefulFunction(this.config);

// Useful function isn't very useful
usefulFunction: function(config) {
   config.updateThis = "some new value";
} 
```

回到您的示例，通过函数更新配置对象。

```
// Calling code
this.usefulFunction("updateThis", "some new value");

// Useful function is a bit useful
usefulFunction: function(name, value) {
    this.config[name] = value;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:45:28.900

假设您的代码确实有效：

```
App = {
    config: {
        updateThis: 'false'
    },
    init: function(){
        this.config.updateThis=this.usefulFunction( this.config.updateThis);
        this.consoleIt();
    },
    usefulFunction: function(item){
       return item = 'yeah';
        // swap the above line for the line below and it works as expected
        // this.config.updateThis = 'yeah';
    },
    consoleIt: function(){
        console.log(this.config.updateThis);
    }
} 
```

# google-maps - 将折线转换为 GeoJSON

> ID：14968026
> 
> 赞同：9
> 
> 时间：2013-02-19T21:42:44.007
> 
> 标签：google-maps, maps, geojson

我从 Google Maps / Open Street Maps 等服务中捕获了一系列（编码或解码的）折线。

例如：

```
var polylines = ["kclaG|i_qLe@i@{AgBu@_AsCyCiBmBMMW[eCiC}A_BEEeBiB{@}@MW]a@a@e@]a@IGGG_AgAm@i@MOYYMEQSCCi@k@KKu@y@{A}Ay@cA{@{@eBiBOMe@k@_@a@e@e@QQY[cAkAUWMOUWu@w@AACCYY?AMKUUSSSQ]]GGECCCECA?AAA?A?C?G?WB"
       ,"yfnaGld}pL?e@?]AuDAgA?KAkBGqG?{C?_B?S?aC?[?]A}A?wAASAQ"
       ,"qmnaGlxxpLn@tEL~@"] 
```

我想将这些存储为 GeoJSON。我找到了很多通过 Leaflet 等工具呈现 GeoJSON 的包，但是我很难找到可以将折线导出到 GeoJSON 的包。

是否存在这样的解决方案，或者是否有我应该研究的 GeoJSON 标准的特定子集，以便我可以编写工具 myset？

**旁注：**我最终想要一个 KML 或 SHP 文件。我打算使用[http://ogre.adc4gis.com/](http://ogre.adc4gis.com/)从 GeoJSON 转换为 SHP。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-07-11T11:44:44.673

您正在寻找 GeoJSON LineString 几何类型。虽然算法有点复杂，但[Github 上有一个项目](https://github.com/mapbox/polyline)提供了 JavaScript 的功能。您应该能够轻松地将其移植到您选择的语言。我还将功能包装到 JSFiddle 中，因此您可以将其用作在线工具。

您可以在[https://jsfiddle.net/ivansams/tw7qLvh4/2/](https://jsfiddle.net/ivansams/tw7qLvh4/2/)找到该工具- 您可以将编码的折线粘贴到“编码的折线”中，然后单击“解码”，这将返回一个 GeoJSON LineString。由于 StackOverflow 关于要求 JSFiddle 附带代码的规则，代码在下面被复制，但在 Github 项目站点上获取最新代码。

```
function decode() {
  var encodedPolyline = document.getElementById("encoded-polyline").value;
  document.getElementById("geojson").value = encodedPolyline;
  var coords = polyline.toGeoJSON(encodedPolyline);
  document.getElementById("geojson").value = JSON.stringify(coords);
}

var polyline = {};

function encode(current, previous, factor) {
  current = Math.round(current * factor);
  previous = Math.round(previous * factor);
  var coordinate = current - previous;
  coordinate <<= 1;
  if (current - previous < 0) {
    coordinate = ~coordinate;
  }
  var output = '';
  while (coordinate >= 0x20) {
    output += String.fromCharCode((0x20 | (coordinate & 0x1f)) + 63);
    coordinate >>= 5;
  }
  output += String.fromCharCode(coordinate + 63);
  return output;
}

/**
 * Decodes to a [latitude, longitude] coordinates array.
 *
 * This is adapted from the implementation in Project-OSRM.
 *
 * @param {String} str
 * @param {Number} precision
 * @returns {Array}
 *
 * @see https://github.com/Project-OSRM/osrm-frontend/blob/master/WebContent/routing/OSRM.RoutingGeometry.js
 */
polyline.decode = function(str, precision) {
  var index = 0,
    lat = 0,
    lng = 0,
    coordinates = [],
    shift = 0,
    result = 0,
    byte = null,
    latitude_change,
    longitude_change,
    factor = Math.pow(10, precision || 5);

  // Coordinates have variable length when encoded, so just keep
  // track of whether we've hit the end of the string. In each
  // loop iteration, a single coordinate is decoded.
  while (index < str.length) {

    // Reset shift, result, and byte
    byte = null;
    shift = 0;
    result = 0;

    do {
      byte = str.charCodeAt(index++) - 63;
      result |= (byte & 0x1f) << shift;
      shift += 5;
    } while (byte >= 0x20);

    latitude_change = ((result & 1) ? ~(result >> 1) : (result >> 1));

    shift = result = 0;

    do {
      byte = str.charCodeAt(index++) - 63;
      result |= (byte & 0x1f) << shift;
      shift += 5;
    } while (byte >= 0x20);

    longitude_change = ((result & 1) ? ~(result >> 1) : (result >> 1));

    lat += latitude_change;
    lng += longitude_change;

    coordinates.push([lat / factor, lng / factor]);
  }

  return coordinates;
};

/**
 * Encodes the given [latitude, longitude] coordinates array.
 *
 * @param {Array.<Array.<Number>>} coordinates
 * @param {Number} precision
 * @returns {String}
 */
polyline.encode = function(coordinates, precision) {
  if (!coordinates.length) {
    return '';
  }

  var factor = Math.pow(10, precision || 5),
    output = encode(coordinates[0][0], 0, factor) + encode(coordinates[0][1], 0, factor);

  for (var i = 1; i < coordinates.length; i++) {
    var a = coordinates[i],
      b = coordinates[i - 1];
    output += encode(a[0], b[0], factor);
    output += encode(a[1], b[1], factor);
  }

  return output;
};

function flipped(coords) {
  var flipped = [];
  for (var i = 0; i < coords.length; i++) {
    flipped.push(coords[i].slice().reverse());
  }
  return flipped;
}

/**
 * Encodes a GeoJSON LineString feature/geometry.
 *
 * @param {Object} geojson
 * @param {Number} precision
 * @returns {String}
 */
polyline.fromGeoJSON = function(geojson, precision) {
  if (geojson && geojson.type === 'Feature') {
    geojson = geojson.geometry;
  }
  if (!geojson || geojson.type !== 'LineString') {
    throw new Error('Input must be a GeoJSON LineString');
  }
  return polyline.encode(flipped(geojson.coordinates), precision);
};

/**
 * Decodes to a GeoJSON LineString geometry.
 *
 * @param {String} str
 * @param {Number} precision
 * @returns {Object}
 */
polyline.toGeoJSON = function(str, precision) {
  var coords = polyline.decode(str, precision);
  return {
    type: 'LineString',
    coordinates: flipped(coords)
  };
};

if (typeof module === 'object' && module.exports) {
  module.exports = polyline;
} 
```

# jquery - jquery 将淡入淡出添加到 div 块

> ID：14968027
> 
> 赞同：0
> 
> 时间：2013-02-19T21:42:51.790
> 
> 标签：jquery

我总共有 4 个 div 块，div 块可以是 4 个，有时根据权限可能是 3 个或 2 个，或者只有 1 个 div 块。我有 4 个 div 块，每个 div 块都以 100 延迟淡入。

我怎样才能让它们总是对每个 div 块有 100 秒的延迟，例如，如果 div span4 仅靠它自己，它应该是 100 秒而不是 400 秒。因为 400 秒本身就太长了。

我怎样才能做到这一点？我的 JS 代码

```
$('div.span1').fadeIn(100);
$('div.span2').fadeIn(200);
$('div.span3').fadeIn(300);
$('div.span4').fadeIn(400);

<div class="span1"></div>
<div class="span2"></div>
<div class="span3"></div>
<div class="span4"></div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T21:48:17.367

假设所有这些 div 元素都具有相似的类属性，您将能够计算`each()`函数中每个元素所需的延迟。一些与此类似的代码可能会有所帮助 -

```
var delta = 100;
$('div[class^="span"]').each(function(index,elem){
  $(this).fadeIn((index+1)*delta);
}); 
```

请注意，我正在增加索引，因为[它是从零开始的](http://api.jquery.com/each/)。

我使用的选择器 ( `$('div[class^="span"]')`) 将匹配`class` [属性以 . 开头](http://api.jquery.com/attribute-starts-with-selector/) `span`的所有元素。我假设您必须将其自定义为您的“现实生活”代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T21:48:04.787

给所有 div 相同的类，然后执行：

```
$('div.span').hide().each(function (i) {
   $(this).fadeIn((i+1)*100);
}) 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/VKS2v/1/)**

# c++ - 枚举类“无法转换为无符号整数”

> ID：14968029
> 
> 赞同：14
> 
> 时间：2013-02-19T21:42:59.793
> 
> 标签：c++, casting, enum-class

我有一个这样的枚举类：

```
 typedef unsigned int binary_instructions_t;

    enum class BinaryInstructions : binary_instructions_t
    {
        END_INSTRUCTION = 0x0,

        RESET,

        SET_STEP_TIME,
        SET_STOP_TIME,
        START,

        ADD
    }; 
```

我正在尝试在这样的 switch 语句中使用枚举的成员：

```
const std::string& function(binary_instructions_t arg, bool& error_detect)
{
    switch(arg)
    {
        case (unsigned int)BinaryInstructions::END_INSTRUCTION:
            return "end";
        break;
    }
    translate_error = true;
    return "ERROR";
} 
```

`(unsigned int)`当基础类型已经是 时，为什么需要强制转换`unsigned int`？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-19T21:45:45.883

那是因为“枚举类”是“强类型”，所以不能隐式转换为任何其他类型。[http://en.wikipedia.org/wiki/C%2B%2B11#Strongly_typed_enumerations](http://en.wikipedia.org/wiki/C%2B%2B11#Strongly_typed_enumerations)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-19T21:44:57.570

因为 C++11[强类型枚举](http://en.wikipedia.org/wiki/C%2B%2B11#Strongly_typed_enumerations)在设计上不能隐式转换为整数类型。底层类型是 an 的`unsigned int`事实并不意味着枚举的类型是`unsigned int`。它是`BinaryInstructions`。

~~但是你实际上并不需要转换~~因为`arg`它是一个无符号整数，你需要一个强制转换，但为了清楚起见你应该更喜欢 a `static_cast`：

```
switch(arg)
{
    case static_cast<unsigned int>(BinaryInstructions::END_INSTRUCTION) :
        return "end";
    break;
} 
```

# pyqt - 当我尝试在其 QLabel 上绘制某些东西时，为什么像素图（足球场图像）会消失？

> ID：14968031
> 
> 赞同：0
> 
> 时间：2013-02-19T21:43:13.637
> 
> 标签：pyqt, pyqt4, qpainter, qpixmap

伙计们。我有一个带有像素图的 QLabel - 一个 PNG 图像（通常是一个足球场），我想在操场上画一些矩形（代表一些机器人），我使用画家类在它的容器 QLabel 上实际绘制。但是当我使用画家绘制REC时，RECT显示但图像只是变成空白。我不知道为什么它失败了，你能帮我一个忙并给我一些提示吗？

```
class FieldLabel(QtGui.QLabel):

    positionData = {"1":{"x":13,"y":20},"2":{"x":28,"y":19},"3":{"x":17,"y":21}}
    def __init__(self, image_path):
        QtGui.QLabel.__init__(self)
        self.field = QtGui.QPixmap("field.png")
        self.setPixmap(self.field.scaled(self.size(),
                                         QtCore.Qt.KeepAspectRatio))
        self.setSizePolicy(QtGui.QSizePolicy.Expanding,
                           QtGui.QSizePolicy.Expanding)
        self.setAlignment(QtCore.Qt.AlignHCenter | QtCore.Qt.AlignVCenter)

    def paintEvent(self,e):
        draw = QtGui.QPainter()
        draw.begin(self)
        draw.setBrush(QtCore.Qt.NoBrush)
        draw.setPen(QtCore.Qt.blue)
        draw.drawRect(0,0,10,10)
        draw.end() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T23:47:52.987

`paintEvent`负责绘制小部件中的所有内容。由于您要覆盖它，因此不会调用`QLabel`绘制 的默认实现。`QPixmap`

所以，首先你应该让它`QLabel`做它的绘画，然后你可以随心所欲地在它上面绘画：

```
def paintEvent(self,e):
    # call the base implementation to paint normal interface
    super(FieldLabel, self).paintEvent(e)

    # then paint over it
    draw = QtGui.QPainter()
    draw.begin(self)
    draw.setBrush(QtCore.Qt.NoBrush)
    draw.setPen(QtCore.Qt.blue)
    draw.drawRect(0,0,10,10)
    draw.end() 
```

# sql-server - Linq-To-Sql 和 MARS 问题 - 当前命令出现严重错误。结果，如果有的话，应该被丢弃

> ID：14968033
> 
> 赞同：0
> 
> 时间：2013-02-19T21:43:17.890
> 
> 标签：sql-server, linq-to-sql, sql-server-mars, kigg

我们根据 CodePlex 上 Kigg 项目的设计搭建了一个网站：

[http://kigg.codeplex.com/releases/view/28200](http://kigg.codeplex.com/releases/view/28200)

基本上，代码使用存储库模式，以及基于 Linq-To-Sql 的存储库实现。完整的源代码可以在上面的链接中找到。

该网站已经运行了一段时间，大约一年前，我们开始收到如下错误：

*   已经有一个与此命令关联的打开的 DataReader，必须先关闭它。
*   ExecuteNonQuery 需要一个开放且可用的连接。连接的当前状态为关闭。

这些是我根据记忆找到的最接近的错误示例。当网站流量开始增加时，这些错误开始发生。把头撞在墙上后，我~~想通了~~假设问题出在 Linq-To-Sql 内部，以及我们如何使用同一连接在单个 Web 请求中调用多个命令。

最终，我发现了 MARS（多个活动结果集）并将其添加到数据上下文的连接字符串中，就像魔术一样，我所有的错误都消失了。

现在，快进大约 1 年，网站流量大幅增加。每周左右，我都会在 SQL Server 中收到一条错误消息，内容为：

> 当前命令发生严重错误。结果，如果有的话，应该被丢弃

在此错误之后，我立即在错误日志中收到数百到数千个 InvalidCastException 错误。基本上，每次调用 Linq-To-Sql 数据上下文时都会出现此错误。只有在我重新启动 Web 服务器后，这些错误才会清除。

我在 Micosoft 支持网站上阅读了一篇文章，描述了我的问题（减去 InvalidCastException 错误），并指出解决方案是，如果我要使用 MARS，我也应该使用 Asncronous Processing=True。我试过这个，但它也没有解决我的问题。

不太确定从这里去哪里。希望这里有人已经看到并解决了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-20T03:37:41.467

我有同样的问题。一旦错误开始，我必须重新启动 IIS 应用程序池来修复。

尽管尝试了许多涉及多线程、保持连接打开等不同的场景，但我仍然无法在 dev 中重现该错误。

我确实有一个可能的线索是，服务器事件日志中的错误是应用程序池的 OutOfMemoryException。也许这是虚假 SQL Datareader 错误（其他地方的内存泄漏）的根本原因。尽管我再次无法在 dev.xml 中重现这一点。

显然，如果您使用的是 64 位操作系统，那么这可能不是您的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-25T21:09:21.643

因此，经过多次重构和重新架构，我们发现问题一直是 MARS（多活动结果集）本身。不知道为什么或究竟发生了什么，但 MARS 以某种方式将结果集弄混了，并且在重新启动 Web 应用程序之前无法恢复。

**我们删除了 MARS，错误停止了。**

如果我没记错的话，我们添加了 MARS 来解决已经使用 LinqToSql 关闭连接/命令并且我们尝试访问尚未加载的对象图的问题。如果没有 MARS，我们会得到一个错误。但是当我们添加 MARS 时，它似乎并不关心它。这确实是一个很好的例子，说明我们并没有真正理解我们到底在做什么，我们从中学到了一些有价值的（和昂贵的）教训。

希望这对经历过这种情况的其他人有所帮助。

感谢所有如何贡献他们的评论和答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-10T16:05:15.867

我知道你想出了解决方案..

以下不是问题的直接解决方案；不过给别人看看就好了

1.  [什么是“当前命令发生严重错误。结果（如果有）应丢弃。” SQL Azure 错误是什么意思？](https://stackoverflow.com/questions/14808612/what-does-a-severe-error-occurred-on-the-current-command-the-results-if-any/20499226#20499226)

2.  [http://social.msdn.microsoft.com/Forums/en-US/bbe589f8-e0eb-402e-b374-dbc74a089afc/severe-error-in-current-command-during-datareaderread](http://social.msdn.microsoft.com/Forums/en-US/bbe589f8-e0eb-402e-b374-dbc74a089afc/severe-error-in-current-command-during-datareaderread)

# javascript - 将值附加到现有的锚点 href

> ID：14968034
> 
> 赞同：5
> 
> 时间：2013-02-19T21:43:23.613
> 
> 标签：javascript, append, add, appendchild

我已经使用 JavaScript 从数据列表模板中捕获了 3 个值，现在我需要将这些值附加到现有的锚点中，即：

```
<a id="link" href='nextpage.aspx?id=<%#Eval("PlateId")%>&pp= #Eval("price")%>'> 
```

我找到了从 JavaScript 获取锚点 href 的方法：

```
<script language='javascript' type="text/javascript" >
    function addLink() { 
        var anchor = document.getElementById("link"); 
        anchor.href = anchor + "&qty=";} 
</script> 
```

但是，我不能在之后添加 js 值 `"&qty="`，我尝试添加这样的值：

```
anchor.href = anchor +"&qty=+Value+" 
```

有了这个：

```
anchor.href = anchor +"&qty='Value' " 
```

我不能把它放在引号之外，因为它不会显示在锚点中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T21:51:17.350

```
anchor.href = anchor + "&qty=" 
```

应该

```
anchor.href = anchor.href + "&qty=" 
```

...否则，您正在尝试将链接元素转换为字符串！

同时，您仍然需要`Value`避开引号，否则生成的最终文本将始终是该文本：`Value`。如果`Value`是一个变量并且没有返回您期望的值（例如，一个空或未定义的值），那么您需要查看声明它的代码并更改它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-07T09:28:01.947

> 动态更改`<a href=""></a>`href 属性值（或）您可以附加现有的 URL

**提示：1 - 使用 jQuery .attr() 方法**

```
 $("selector").attr("href", newURL)); 
```

**提示：2 - 使用 javascript 元素选择器 document.getElementById**

例子：

```
<a href="test.php" id="test">TEST URL</a>
var redirect_url = document.getElementById('test');
redirect_url.href = "new url"; 
```

（或者）

```
document.getElementById('test').href = "newURL"; 
```

（或者）

**使用 setAttribute() 方法 *注意：在 IE 中损坏**

```
redirect_url.setAttribute("href", "new url"); 
```

# c# - 邻接列表图实现 - 可重用类

> ID：14968051
> 
> 赞同：1
> 
> 时间：2013-02-19T21:44:35.620
> 
> 标签：c#

我将 Graph （在我的 Graph 类中）存储为： `Dictionary< Vertex<T>, List<Vertex<T>> _edges`.

我应该如何存储边缘的重量、颜色等属性？（使其可重用，例如`WeightedGraphs`等`ColoredGraphs`）为了创建通用 Graph 类，我考虑在 Graph 类中添加`IGraph`接口（它将包含常见的 Graph 操作，如`Traverse`等`InsertEdge`）作为属性。

但是我不知道如何处理边缘属性。如果我实现`IGraph`接口，因为`ColoredGraph`我想拥有带有颜色属性的顶点，`IGraph`实现`WeightedGraph`我想拥有权重属性等等。我还想听听您将如何将 Graph 实现为邻接列表。

ps：不是学校作业

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:54:19.137

`Edge ={2 Vertices = {Adjacent Vertices per a vertex}, weighted value, color value, etc}`

然后

```
public Vertex
{
//get adjacent list of vertices
}
public class Edge
{
//define necesary values
//define pair of vertices to make an edge
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-18T00:08:52.277

您可以通过使用 a`Tuple<>`作为图的顶点来实现这一点。这`Tuple<>`将允许您存储边缘的各种属性。

图的签名可以定义为：

```
Dictionary< Vertex<T>, List<Tuple<T, T>> _edges. 
```

中的第一项`Tuple`指示边缘的目标节点。中的其余项目`Tuple`将保留该边缘的属性。

# events - TinyOS/nesC Receive.receive 事件定期发出信号但只处理一次

> ID：14968053
> 
> 赞同：1
> 
> 时间：2013-02-19T21:44:39.847
> 
> 标签：events, tinyos, nesc

我目前正在为 TinyOS 实现 AODV 协议，当网络层向应用程序发送有关收到消息的信号时，我看到了奇怪的行为。

下面是相关的应用程序和 AODV 库代码 + 一些调试输出，以显示正在发生的事情。

**测试应用**

配置

```
configuration BasicTestAppC{
}
implementation{
    components MainC, BasicTestC, AODV, LedsC;

    BasicTestC.Boot->MainC.Boot;
    BasicTestC.SplitControl->AODV.SplitControl;

    BasicTestC.AMSend->AODV.AMSend[1];
    BasicTestC.Receive->AODV.Receive[1];

    ...
} 
```

执行

```
#include "BasicTest.h"

module BasicTestC {
    uses {
        interface Boot;
        interface SplitControl;
        interface Timer<TMilli> as MilliTimer;
        interface AMSend;
        interface Receive;
        interface Leds;
        interface Packet;
    }
}

implementation {
    message_t pkt;
    message_t * p_pkt;

    uint16_t src = 0x0007;
    uint16_t dest = 0x000A;

    uint16_t ctr = 0;
    test_msg* test_pkt; 
    test_msg* rcv_pkt;

    ...

    //Send counter value to node 10 on every timer tick
    event void MilliTimer.fired() {
        call Leds.led0Toggle();

            ctr = ctr + 1;

        test_pkt = (test_msg*)(call Packet.getPayload(p_pkt, sizeof (test_msg)));
        test_pkt->counter = ctr;
        call AMSend.send(dest, p_pkt, sizeof(test_msg));
    }

    event void AMSend.sendDone(message_t * bufPtr, error_t error) {
        test_pkt = (test_msg*)(call Packet.getPayload(p_pkt, sizeof (test_msg)));
        dbg("APPS", "%s\t APPS: sendDone!! (error=%d) ctr=%u\n", sim_time_string(), error, test_pkt->counter);
    }

    event message_t* Receive.receive(message_t * bufPtr, void * payload, uint8_t len) {
        rcv_pkt = (test_msg * ) payload;
        dbg("APPS", "%s\t APPS: receive!! %u\n", sim_time_string(), rcv_pkt->counter);
        return bufPtr;
    }

} 
```

**AODV 模块**

处理来自 AMReceiverC 组件的接收事件：

```
event message_t* SubReceive.receive( message_t* p_msg, void* payload, uint8_t len ) {

    uint8_t i;
    aodv_msg_hdr* aodv_hdr = (aodv_msg_hdr*)(p_msg->data);

    test_msg_y* tmp;
    uint16_t ctr;

    dbg("AODV", "%s\t AODV: SubReceive.receive() dest: %d src:%d\n", sim_time_string(), aodv_hdr->dest, aodv_hdr->src);

    if( aodv_hdr->dest == call AMPacket.address() ) {

        for( i=0;i<len;i++ ) {
            p_app_msg_->data[i] = aodv_hdr->data[i];
        }

        tmp = (test_msg_y*) p_app_msg_->data;
        ctr = tmp->counter;

        //Send signal to application layer
        p_msg = signal Receive.receive[aodv_hdr->app]( p_app_msg_, p_app_msg_->data, len - AODV_MSG_HEADER_LEN );

        dbg("AODV", "%s\t AODV: SubReceive.receive() delivered to upper layer - %u\n", sim_time_string(), ctr);

    } else {

        am_addr_t nexthop = get_next_hop( aodv_hdr->dest );

        dbg("AODV", "%s\t AODV: SubReceive.receive() deliver to next hop:%x\n", sim_time_string(), nexthop);

        /* If there is a next-hop for the destination of the message, 
           the message will be forwarded to the next-hop.            */
        if (nexthop != INVALID_NODE_ID) {
                forwardMSG( p_msg, nexthop, len );
        }
    }
    return p_msg;
} 
```

**调试输出**

```
DEBUG (7): 0:0:2.006653503   APPS: sendDone!! (error=0) ctr=2
DEBUG (10): 0:0:2.019577622  AODV: SubReceive.receive() dest: 10 src:7
DEBUG (10): 0:0:2.019577622  AODV: SubReceive.receive() delivered to upper layer - 2
DEBUG (10): 0:0:2.019577622  APPS: receive!! 2
DEBUG (7): 0:0:3.010407143   APPS: sendDone!! (error=0) ctr=3
DEBUG (10): 0:0:3.021820651  AODV: SubReceive.receive() dest: 10 src:7
DEBUG (10): 0:0:3.021820651  AODV: SubReceive.receive() delivered to upper layer - 3
DEBUG (7): 0:0:4.005264961   APPS: sendDone!! (error=0) ctr=4
DEBUG (10): 0:0:4.023239710  AODV: SubReceive.receive() dest: 10 src:7
DEBUG (10): 0:0:4.023239710  AODV: SubReceive.receive() delivered to upper layer - 4
DEBUG (7): 0:0:5.010010417   APPS: sendDone!! (error=0) ctr=5
DEBUG (10): 0:0:5.024780838  AODV: SubReceive.receive() dest: 10 src:7
DEBUG (10): 0:0:5.024780838  AODV: SubReceive.receive() delivered to upper layer - 5
DEBUG (7): 0:0:6.003983230   APPS: sendDone!! (error=0) ctr=6
DEBUG (10): 0:0:6.010147745  AODV: SubReceive.receive() dest: 10 src:7
DEBUG (10): 0:0:6.010147745  AODV: SubReceive.receive() delivered to upper layer - 6
DEBUG (7): 0:0:7.008331960   APPS: sendDone!! (error=0) ctr=7
DEBUG (10): 0:0:7.020187970  AODV: SubReceive.receive() dest: 10 src:7
DEBUG (10): 0:0:7.020187970  AODV: SubReceive.receive() delivered to upper layer - 7
DEBUG (7): 0:0:8.004013748   APPS: sendDone!! (error=0) ctr=8
DEBUG (10): 0:0:8.013474142  AODV: SubReceive.receive() dest: 10 src:7
DEBUG (10): 0:0:8.013474142  AODV: SubReceive.receive() delivered to upper layer - 8
DEBUG (7): 0:0:9.009140671   APPS: sendDone!! (error=0) ctr=9
DEBUG (10): 0:0:9.020233746  AODV: SubReceive.receive() dest: 10 src:7
DEBUG (10): 0:0:9.020233746  AODV: SubReceive.receive() delivered to upper layer - 9
DEBUG (7): 0:0:10.010391884  APPS: sendDone!! (error=0) ctr=10
DEBUG (10): 0:0:10.018341667 AODV: SubReceive.receive() dest: 10 src:7
DEBUG (10): 0:0:10.018341667 AODV: SubReceive.receive() delivered to upper layer - 10 
```

如您所见 - 应用层的接收事件仅触发/执行一次。以下所有消息都到达目标节点，但未到达网络层之上。

关于这里可能发生的事情有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:30:14.340

问题出在以下行：

```
p_msg = signal Receive.receive[aodv_hdr->app]( p_app_msg_, p_app_msg_->data, len - AODV_MSG_HEADER_LEN ); 
```

Receive.receive 上的文档建议它不应该重用接收消息缓冲区，最常见的做法是返回作为第一个参数传递给它的相同指针。

它的问题是 - 如果用户应用程序在实现 Receive.receive 事件处理程序时遵循指南，它将返回指向消息缓冲区的指针（第一个参数）。但是，在上一行中传递给 Receive.receive 的第一个参数是 p_app_msg_，这意味着在接收到第一条消息后，p_msg 不再指向原始消息缓冲区。

仍在考虑解决此问题的最佳方法是什么，但目前我只是不将 Receive.receive 的结果分配回 p_msg 并避免在应用程序代码中重用接收消息缓冲区。

# c# - 将具有 3 个循环的老式方法重构为 LINQ 查询

> ID：14968055
> 
> 赞同：1
> 
> 时间：2013-02-19T21:44:45.280
> 
> 标签：c#, linq

我有一个日期时间值的通用列表：weekADates

我有一个时间表实体的通用列表： response.TimeTableWeek

```
public class TimeTable
{
    public int LessonNumber { get; set; }

    /// <summary>
    /// For each day and lessonnumber in the week there is a schooclass code assigned
    /// </summary>
    public IDictionary<DayOfWeek,string> WeeklySchoolclassCodes { get; set; }
} 
```

这段代码需要改成 LINQ 查询：

```
var periodList = new List<Period>();
foreach (DateTime date in weekADates)
{
    foreach (TimeTable timetable in response.TimeTableWeek)
    {
        for (int i = 0; i < timetable.WeeklySchoolclassCodes.Count; i++)
        {
            var p = new Period();
            p.LessonNumber = timetable.LessonNumber + 1;
            p.LessonDate = date;
            p.SchoolclassCode = timetable.WeeklySchoolclassCodes[date.DayOfWeek];
            periodList.Add(p);
        }
    }
} 
```

我尝试了 .Select 和 .SelectMany 的许多变体，但我找不到解决方案。

这就是周期列表的样子。

![在此处输入图像描述](../Images/2e13c3a4bbd23f3a24509e17b81fa7ff.png)

您如何将其更改为 linq？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:49:40.903

试试这个

```
periodList.AddRange(
    from date in weekADates
    from timetable in response.TimeTableWeek
    from schoolclassCode in timetable.WeeklySchoolclassCodes.Values
    select new Period
    {
        LessonNumber = timetable.LessonNumber + 1,
        LessonDate = date,
        SchoolclassCode = schoolclasscode
    }); 
```

编辑：修复了第三个 from 以从字典中获取值，而不是 KeyValuePairs。

在方法风格中，你可以这样写：

```
periodList.AddRange(
    weekADates.SelectMany(date => 
    response.TimeTableWeek.SelectMany(timetable =>
    timetable.WeeklySchoolclassCodes.Values.Select(schoolclassCode =>
    new Period
    {
        LessonNumber = timetable.LessonNumber + 1,
        LessonDate = date,
        SchoolclassCode = schoolclasscode
    }))); 
```

# perl - 未终止的 `s' 命令

> ID：14968056
> 
> 赞同：0
> 
> 时间：2013-02-19T21:44:45.243
> 
> 标签：perl, sed

我正在研究一个 perl 脚本，该脚本将获取客户服务信息并更改服务 ID。我现在拥有的代码可以使用 2 列 csv 文件作为参考，并交换数字，但是当我尝试使用“\n”或“\|”时 就像我需要的那样，它会给我`ol：

“sed：-e 表达式 #1，字符 29：未终止的‘s’命令”

这是我的原始代码，可用于更改引号内的数字：

```
#!/usr/bin/perl
use strict;
use warnings;
use Text::CSV; #load Text::CSV module for parsing CSV
use LWP::Simple; #load LWP module for doing HTTP get

my $file = 'sid_swap.csv'; #CSV file to parse and load
my $csv = Text::CSV->new(); #create a new Text::CSV object

open (CSV, "<", $file) or die $!; #open CSV file for parsing

while (<CSV>) {
    if ($csv->parse($_)) {

        my @columns = $csv->fields(); #parse csv files and load into an array for each row
        my $newSID = $columns[0];
        my $oldSID = $columns[1];
        system("sed -i 's/\<row SERVICE_MENU_ID=\"$oldSID\"/\<row SERVICE_MENU_ID=\"$newSID\"/g' customer_data.txt");

    } else {
        my $err = $csv->error_input;
        print "Failed to parse line: $err";
    }
}
close CSV; 
```

这是引发错误的新代码：

```
#!/usr/bin/perl
use strict;
use warnings;
use Text::CSV; #load Text::CSV module for parsing CSV
use LWP::Simple; #load LWP module for doing HTTP get

my $file = 'sid_swap.csv'; #CSV file to parse and load
my $csv = Text::CSV->new(); #create a new Text::CSV object

open (CSV, "<", $file) or die $!; #open CSV file for parsing

while (<CSV>) {
    if ($csv->parse($_)) {

        my @columns = $csv->fields(); #parse csv files and load into an array for each row
        my $newSID = $columns[0];
        my $oldSID = $columns[1];
        system("sed -i 's/\<row SERVICE_MENU_ID=\"$oldSID\"/\n$newSID\|/g' customer_data.txt");

    } else {
        my $err = $csv->error_input;
        print "Failed to parse line: $err";
    }
}
close CSV; 
```

感谢您的任何帮助，您可以提供！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T21:58:16.917

要调试，请更改`system("sed ...")`为`die("sed ...");`. 你会看到你正在尝试执行

```
sed -i 's/<row SERVICE_MENU_ID="OLDSID"/
NEWSID|/g' customer_data.t 
```

我想`sed`在它的论点中间不喜欢实际的换行符？这可以通过适当的转义来解决，但你的方法是......疯狂的。您正在处理 CSV 每一行的整个文件！

```
open(my $CSV, "<", $file) or die $!;    # Let's not use global vars!

my %fixes;
while (<$CSV>) {
    $csv->parse($_)
        or die "Failed to parse line: ".$csv->error_input."\n";

    my ($newSID, $oldSID) = $csv->fields();
    $fixes{$oldSID} = $newSID;
}

my $pat = join "|", map quotemeta, keys(%fixes);
my $re = qr/$pat/;

{
    local @ARGV = 'customer_data.txt';
    local $^I = '';  # "perl -i" mode
    while (<>) {
        s/<row SERVICE_MENU_ID="($re)"/\n$fixes{$1}|/g;
        print;
    }
} 
```

一次性完成也可以解决问题

```
1111,2222
2222,3333 
```

与

```
1111,3333
2222,3333 
```

# php - 尝试从命令行运行 PHP 时出错

> ID：14968065
> 
> 赞同：1
> 
> 时间：2013-02-19T21:45:28.383
> 
> 标签：php, cmd

我正在使用 Windows 7 x64 并尝试从命令行运行一个小型 PHP 程序。我已经放置了 php `C:/php`，我的程序位于：`C:/schoolproject/launch.php`

所以我跑：`C:/php/php.exe -f "C:/schoolproject/launch.php"`

然后我得到一个错误：`PHP.EXE is not a valid Win32 Application`

我知道有很多记录在案的案例，但到目前为止我还没有找到一个成功的解决方案，它真的让我很烦恼，因为我需要它来工作。我重新安装了 Windows 7 无济于事。

谢谢

# linux - 磁盘上的嵌入式 linux 根文件系统

> ID：14968067
> 
> 赞同：1
> 
> 时间：2013-02-19T21:45:39.510
> 
> 标签：linux, root

我想知道如何为存储在硬盘上的嵌入式 Linux 系统创建根文件系统。如果它在闪存卡上，这将是相同的程序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T23:07:59.953

不，您的引导加载程序需要知道如何初始化硬盘驱动器。使用闪存卡，引导加载程序初始化为 MTD，并且可以理解文件系统。

您可能能够在引导加载程序中使用 IDE HD 和 IDE 支持取得进展。

在普通计算机（例如 PC）上，BIOS 负责初始化所有外围设备，例如主 HD。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-03T02:37:05.683

通常 Linux 嵌入式系统不是直接在基于磁盘的文件系统中运行，而是使用一种机制将操作系统从持久存储（硬盘驱动器、闪存卡或内存等）加载到易失性内存空间 (RAM)。通常，这些操作系统的文件（通常称为固件）是内核映像文件和`initrd`（初始 RAM 磁盘）文件，initrd 文件包含根文件系统的文件和任何系统的相关文件，在启动时 initrd 将被解压缩并部署到 RAM基于[tmpfs](https://www.kernel.org/pub/linux/kernel/people/marcelo/linux-2.4/Documentation/filesystems/tmpfs.txt)的文件系统，一旦完成，系统将像任何基于磁盘的文件系统（ext3，btrfs）一样使用 tmpfs 文件系统，例如运行`init`程序或脚本来进行系统初始化。嵌入式系统倾向于最小化持久存储上的 I/O，以获得一些优势：可靠性、速度和成本。

您可以通过了解如何创建和修改 initrd 文件的任何通用 Linux 发行版来了解如何完成此操作。

# php - 为什么 PHP 生成的内容在通过 jQuery 加载时会抖动，我该如何解决？

> ID：14968069
> 
> 赞同：0
> 
> 时间：2013-02-19T21:45:46.343
> 
> 标签：php, ajax, jquery

当我在由 jQuery 异步加载的文件中生成 PHP 时，动画运行时文本似乎有点抖动或闪烁。这不会发生在请求文件中的常规 HTML 上，只会发生在 PHP 生成的内容上。

只是想要一些关于什么可以结束抖动的提示。

这是 jQuery 中的`main.php`：

```
$(document).ready(function(){
    var demo = $('#demo');
    demo.hide();
    $("button").click(function(){
        demo.load('demo.php', function() {
        demo.show('medium');
        });
    });
}); 
```

这是 HTML 和 PHP 中的`demo.php`：

```
<p><?php echo "Hello World with PHP trough AJAX"; ?></p> 
```

我真的不确定从哪里开始。我应该避免一起使用 PHP`demo.php`吗？即便如此，我真的很想有可能在称为槽 AJAX 的脚本中使用 PHP。

根据要求，这是整个该死的事情：

`main.php`：

```
<!DOCTYPE html>
<html>
<head>
    <title>Testing Ajax</title>
    <link rel="stylesheet" type="text/css" href="main.css" />
    <meta charset="utf-8" />
    <script type="text/javascript" src="js/jquery-1.9.0.js"></script>
    <script>
        $(document).ready(function(){
            var demo = $('#demo');
            demo.hide();
            $("button").click(function(){
                demo.load('demo.php', function() {
                    demo.show('medium');
                });
            });
        });
    </script>
    <style type="text/css">
        #demo {background-color: MidnightBlue;color: white;padding: 0.1em 1em 1.5em 1.5em;}
        #demo h1 {color: white;}
    </style>
</head>
<body>
    <section>
        <article>
            <h1>Ajax</h1>
            <hr />
            <button>Load External Content</button>
            <div id="demo"></div>
        </article>
    </section>
</body>
</html> 
```

（比起矢车菊蓝，我更喜欢 MidnightBlue...）

`demo.php`：

```
<h1>Ajax criex Hello World!</h1>
<p><?php echo "PHP also cries Hello World trough Ajax!"; ?></p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:53:08.123

从技术上讲，使用 PHP 生成的文本与在 ASP.net 中生成的文本与包含在 .txt 文件中的文本与在键盘上键入的文本之间绝对没有区别——都是字母和数字。事实上，我想说的是，在没有其他线索的情况下检查文本，完全和 100% 不可能说出它是如何创建的。不，您不应该避免使用 AJAX 的 PHP。

您看到的任何“抖动”都是其他问题的产物，很可能与浏览器性能有关——处理器可用性、可用内存、当前进程内存消耗、扩展活动/对页面内容的干扰等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:01:05.037

我不知道这是否会帮助你。如果上面显示的代码是您的全部代码，则可能不会`really`。

但是：前段时间，当我通过 Ajax 加载内容时，我也遇到了动画抖动问题。原因是：加载的内容包含带有其他动画命令的 Javascript 代码，然后两个动画都受到干扰。也许这里也是如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T22:11:42.390

在我的测试中，尝试重现“抖动”时，您的代码正在产生一个**无限的 ajax 循环**（在 Web 控制台中查看，您看），这很可能是您的抖动效果：

这是一个基本的 PHP 和 AJAX 示例：

```
<?php 
if(isset($_SERVER['HTTP_X_REQUESTED_WITH']) && strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) === 'xmlhttprequest' && $_SERVER['REQUEST_METHOD']=='POST' && isset($_POST['action'])){
    $action = $_POST['action'];
    switch($action){
        case "hello":
            echo "Hello World with PHP through AJAX";
            break;
        case "foobar":
            echo "Hello Foobar";
            break;
    }
    die;
}
?>

<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script>
$(document).ready(function(){
    $("button").click(function(){
           var action = this.value;
           ajaxload('demo',action);
    });
});
function ajaxload(placement,action){
    $.post("./demo.php", { 'action': action },
    function(data) {
        $("#"+placement).hide().html(data).fadeIn('slow');
    });
}
</script>

<button type="button" value="hello">Hello World</button>
<button type="button" value="foobar">Foobar</button>

<p id="demo"></p> 
```

# c - c中的星星钻石

> ID：14968070
> 
> 赞同：-1
> 
> 时间：2013-02-19T21:45:47.307
> 
> 标签：c

我试图画出这颗钻石，以便在中间行之后，钻石的其余部分向右移动 3 个空格，就好像你正在通过一杯水看它一样。你能以某种方式修改下面的代码来合并这种转变吗？

输出应该类似于：

```
 *
    ***
   *****
  *******
      *****
       ***
        * 
```

（但中间最多有 15 颗星）。
谢谢！

```
define TOTAL_ROWS 15
int main() {
    int row, col, numstars=1;
    int half, rate=1;

    for (row=1; row<=TOTAL_ROWS; row++) {

        half=TOTAL_ROWS/2

        for (col=0; col<half+1-numstars; col++)
            printf(" ");

        for (col=1; col<=2*numstars-1; col++)
            printf("*");

        if (numstars==(half+1))
            rate = -rate;

        numstars+=rate;  
        printf("\n");

    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T21:53:28.223

只需检查行是否大于一半并添加这 3 个空格...

```
if(row>half+1)
    printf("    "); 
```

见[小提琴](http://cfiddle.net/sDddvu)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:52:22.483

当您*切换*到另一半时，设置一个标志并在此后打印 3 个空格。

```
int flag = 0;

    ....

  if (numstars==(half+1)) {
        rate = -rate;
        flag = 1;
    }

    numstars+=rate;

    printf("\n");
    if (flag) printf("   "); 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T22:09:55.637

在第一个内部 for 中，如果变量超过中心，您可以启动`col`变量：`-3`

```
for (col=(row <= half+1 ? 0 : -3); col<half+1-numstars; col++)
    printf(" "); 
```

我认为这已经足够且容易了。

# java - 枚举方法覆盖

> ID：14968075
> 
> 赞同：18
> 
> 时间：2013-02-19T21:46:07.617
> 
> 标签：java, coding-style, enums

我发现`Enum`s 定义如下：

```
public Enum MyEnum {

   ONE
   {
      @Override
      public int getSomething() {
         return 1;
      } 
   },

   TWO
   {
      @Override
      public int getSomething() {
        return 2;
      }
   }

   int getSomething()
   {
      return 0;
   }
} 
```

不知何故，我对此实现感到某种不适，因为我认为理想情况下应该为此目的定义一个字段，并且该类应该类似于：

```
public Enum MyEnum{

   ONE(1),
   TWO(2)

   private int theSomething;

   private MyEnum(int something) {
      theSomething = something;
   }

   int getSomething()
   {
      return theSomething;
   }
} 
```

问题是除了个人不适之外，我找不到任何好的理由来更改此代码。有吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-02-19T22:03:54.363

（移自评论）

您的第一个示例通常用于在 Java中实现[有限状态机。](https://en.wikipedia.org/wiki/Finite-state_machine)它消除了每种方法都必须有`if (state == FOO) {} else if (state == BAR)`等的需要

```
class MyFSM {

    enum State {
        FIRST_STATE {
            @Override
            void start(MyFSM fsm) {
                fsm.doStart();
            }
            @Override
            void stop(MyFSM fsm) {
                throw new IllegalStateException("Not Started!");
            }
        },
        SECOND_STATE {
            @Override
            void start(MyFSM fsm) {
                throw new IllegalStateException("Already Started!");
            }
            @Override
            void stop(MyFSM fsm) {
                fsm.doStop();
            }
        };

        abstract void start(MyFSM fsm);
        abstract void stop(MyFSM fsm);       
    }

    private volatile State state = State.FIRST_STATE;

    public synchronized void start() {
        state.start(this);
    }

    private void doStart() {
        state = SECOND_STATE;
    }

    public synchronized void stop() {
        state.stop(this);
    }

    private void doStop() {
        state = FIRST_STATE;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-11T18:36:34.483

对于不需要全部覆盖的“默认”方法，第一种模式稍好一些。

```
public enum Modes {
    MODE_ONE {
        @Override public boolean canDoA() {
            return true;
        }
    },
    MODE_TWO {
        @Override public boolean canDoB() {
            return true;
        }
    },
    MODE_THREE {
        @Override public boolean canDoC() {
            return true;
        }
    };

    public boolean canDoA() {
        return false;
    }

    public boolean canDoB() {
        return false;
    }

    public boolean canDoC() {
        return false;
    }

} 
```

# java - 在正则表达式与 Java 中匹配多个

> ID：14968077
> 
> 赞同：1
> 
> 时间：2013-02-19T21:46:09.553
> 
> 标签：java, regex, regex-negation

我需要考虑一组非常复杂的差异。是编写一个匹配所有这些的正则表达式，还是用 Java 编写单个的正则表达式并在 if-then 块中测试每个正则表达式更好？

我什至无法想出匹配每种情况的正则表达式，所以这可能是一个有争议的问题：

这是输入：

*   **CN666SEEEI**
*   **FOC000007HW** (2190000002)
*   **FHK10AAAAAA** (2850000004)
*   **JAB031444BA** (3108888022)
*   **编号**JAE14445WW7
***   序列号：**FOC0818S08R**型号：Cisc*   序列号：**FHK10HHHQ4***   型号：CISCO7200VXR，序列号：**36555555***   思科 CISCO3845 SN：**FGL15555532***   CISCO2831 **FHK13XXXX1E***   CISCO1851 序列号：**FHK1XXXX55M***   CISCO2821 序列号：**FHK1333F11J***   CISCO2921/K9，序列号：**FHK1444FF7F***   思科 1941/k9 锡：**FHK13HHHTQ***   CISCO2121 SN：**FHKFFFFEY***   WS-C2970-24TC-L，序列号：**FOCXXXXZ34K***   WS-C3760-24TS-S，序列号：**FDOXXXXX0F6***   38 42 42 42 42 42 42 44 42 42**

 **现在我需要提取序列号——实际上第一行是最简单的形式，其余的都**隐藏**在字符串中。最后一个完全无效，应该匹配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:46:03.920

这适用于给出的示例。

但是，可能需要详细概述“非常复杂的一组差异”，以获得无懈可击的解决方案。

```
String str = "CN666SEEEI\n" +
    "FOC000007HW (2190000002)\n" +
    "FHK10AAAAAA (2850000004)\n" +
    "JAB031444BA (3108888022)\n" +
    "S/N JAE14445WW7\n" +
    "Serial :FOC0818S08R Model : Cisc\n" +
    "Serial_Number: FHK10HHHQ4\n" +
    "Model:CISCO7200VXR, SN:36555555\n" +
    "Cisco CISCO3845 SN: FGL15555532\n" +
    "CISCO2831 FHK13XXXX1E\n" +
    "CISCO1851 SN: FHK1XXXX55M\n" +
    "CISCO2821 SN: FHK1333F11J\n" +
    "CISCO2921/K9, SN: FHK1444FF7F\n" +
    "Cisco 1941/k9 Sn: FHK13HHHTQ\n" +
    "CISCO2121 SN: FHKFFFFFFEY\n" +
    "WS-C2970-24TC-L, SN: FOCXXXXZ34K\n" +
    "WS-C3760-24TS-S, SN: FDOXXXXX0F6\n" +
    "38 42 42 42 42 42 42 44 42 42";

Matcher m = Pattern.compile( "\\b(?!CISCO)[A-Z\\d]{8,}(?=\\s|$)" ).matcher( str ); 

while ( m.find() ) {
    System.out.println( m.group() );
} 
```

我以为你的意思是最后一个不应该*匹配*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:57:29.610

我会将字符串分成不同的组，并根据初始分组对它们应用不同的模式。

第一组可能很简单，例如`str.contains(":")`字符串包含分号。然后进一步分解，下一组是否包含“Cisco”这个词。在您将该列表分解为一些更易于处理的子列表后，如下所示，为每个子列表编写正则表达式会容易得多。

没有 'SN' 或 ':' 或 'Cisco'

```
CN666SEEEI
FOC000007HW (2190000002)
FHK10AAAAAA (2850000004)
JAB031444BA (3108888022) 
```

然后进一步分解 -

包含“”（空格）：

```
FOC000007HW (2190000002)
FHK10AAAAAA (2850000004)
JAB031444BA (3108888022) 
```

才不是 -

```
CN666SEEEI 
```

这两个组甚至不需要正则表达式，您只需在拆分后提取正确的位。

使用提供的示例来分解您的列表并将简单的正则表达式应用于每个！**

# iphone - iPhone up 不再加载到设备或模拟器中，当我运行它时什么也不做

> ID：14968082
> 
> 赞同：0
> 
> 时间：2013-02-19T21:46:44.917
> 
> 标签：iphone

当我尝试运行我的应用程序时，它构建时没有错误，但不会运行。在 Xcode 窗口的顶部，它显示“附加到 golfflixlight”，下面有一个小动画。

我让它运行了 20 分钟然后放弃了，我被卡住了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:09:20.610

这是 Xcode 反复出现的祸害。它在那里让我们的生活变得悲惨。解决方案非常难以捉摸，我还没有读到一个单一的、连贯的解释发生了什么。

看看[这个 SO question](https://stackoverflow.com/questions/5382968/xcode-4-hangs-at-attaching-to-app-name)，它可能会让你知道如何解决你的难题。就个人而言，除了编辑方案并将调试器设置为 GDB 之外，没有什么对我有用。祝你好运。

# asp.net-mvc - 如何将 JSON 数组 ajax/post 到 ASP MVC

> ID：14968085
> 
> 赞同：1
> 
> 时间：2013-02-19T21:47:02.887
> 
> 标签：asp.net-mvc, json, jquery

尝试发布包含一些 JSON 数据的帖子，其中包含整数数组。按下我页面上的按钮来执行帖子正在执行操作，但预期的数据不存在（两个 int[] 变量为空）。在发布时执行网络配置文件显示请求正文包含如下数据：

> 组%5B%5D=2&groups%5B%5D=3&alerts%5B%5D=5&alerts%5B%5D=9

Javascript：

```
$('#modal-save').click(function() { 
                var selectedGroups = [];
                var selectedAlerts = [];
                $('input:checked').filter('[data-group="true"]').each(function() {selectedGroups.push($(this).data('id')); });
                $('input:checked').filter('[data-group="false"]').each(function() {selectedAlerts.push($(this).data('id')); });
$.ajax({
                        type:'Post',
                        dataType: 'json',
                        url:'@Url.Action("UpdateAlertStores", new { alias = ViewBag.Alias})',
                        data: {groups: selectedGroups, alerts: selectedAlerts},
                    }); 
```

MVC 动作：

```
[HttpPost]
public bool UpdateAlertStores(string alias, Guid? groupID, Guid? storeID, int[] groups, int[] alerts)
{
    return true;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:52:01.843

添加`traditional:true`

```
traditional: true,
type:'Post',
dataType: 'json',
url:'@Url.Action("UpdateAlertStores", new { alias = ViewBag.Alias})',
data: {groups: selectedGroups, alerts: selectedAlerts}, 
```

在此更改您的网址后，如下所示：

```
groups=2&groups=3&alerts=5&alerts=9 
```

# ruby-on-rails - 直接获得 Ruby 语法

> ID：14968087
> 
> 赞同：0
> 
> 时间：2013-02-19T21:47:08.777
> 
> 标签：ruby-on-rails, ruby

我正在尝试自学 Ruby 和 Ruby on Rails。[有人可以从http://guides.rubyonrails.org/getting_started.html](http://guides.rubyonrails.org/getting_started.html)给我一些关于这段代码的快速指示吗

```
<%= form_for(@post) do |f| %>
  <% if @post.errors.any? %>
    <div id="errorExplanation">
      <h2><%= pluralize(@post.errors.count, "error") %> prohibited
      this post from being saved:</h2>
      <ul>
      <% @post.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :name %><br />
    <%= f.text_field :name %>
  </div>
  <div class="field">
    <%= f.label :title %><br />
    <%= f.text_field :title %>
  </div>
  <div class="field">
    <%= f.label :content %><br />
    <%= f.text_area :content %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

问题：

1.  有时代码使用`<%`，有时使用`<%=`. 我什么时候使用这些中的任何一个？
2.  `@`在 Ruby 中究竟是什么意思，什么时候使用？
3.  除了 HTML，是所有的 Ruby 代码，还是 Ruby on Rails 引入了一些新的代码/语法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:50:06.213

1.  `<%=`将表达式的结果输出到页面。`<%`只是评估它。
2.  `@`表示类中的实例变量。在 Rails 中，这也是将控制器变量公开给视图的方式。
3.  Rails 没有为 Ruby 添加任何新语法，尽管有一些约定可能看起来与“传统”Ruby 代码不同。

# git - 有没有办法从远程仓库（在这种情况下为 github）拉/合并到与本地不同的分支？

> ID：14968091
> 
> 赞同：0
> 
> 时间：2013-02-19T21:47:37.710
> 
> 标签：git, github

每当我在那里推送更改时，我都会尝试使用 Github 挂钩来更新我的服务器存储库。我面临的问题是，有时该存储库可能位于与 Github 中更新的分支不同的分支中。例子：

*   服务器仓库位于“master”分支
*   分支“开发”在 Github 中更新
*   Github 触发网络钩子
*   钩子从 github 中提取，**但在 master 而不是在开发中改变土地**

粗体字基本上是问题所在，我不想让钩子脚本更改当前分支以进行更新。我试过这个：

```
git pull origin development:development 
```

但随后开发被正确拉动，**并**合并到主控中。

我已经检查了这个问题：

[git 从特定分支拉到特定分支](https://stackoverflow.com/questions/13453436/git-pulling-from-a-specific-branch-to-a-specific-branch#comment-18422202)

（当然，在尝试了上述方法之后）并且似乎没有办法通过拉动来做到这一点。但是合并也只在当前分支中有效？（可能这就是为什么 pull 也不起作用）

那么，有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:57:19.043

在“拉合并”之后，您可以将原始分支重置回原来的位置。或者您可以克隆到新存储库，创建/合并到目标分支，然后将该新存储库的分支推送到您的原始存储库。请记住，git 中的“分支”并不是什么神奇的东西，它们只是指向特定提交哈希的标签（指针）。您可以根据需要移动它们。

# jquery - 我应该在什么级别缓存 jQuery DOM 查询的结果？

> ID：14968093
> 
> 赞同：6
> 
> 时间：2013-02-19T21:47:49.190
> 
> 标签：jquery, performance

有很多关于缓存 jQuery 对象的问题，但我找不到一个询问 jQuery 对象可以并且应该被缓存的确切位置。我有一个网页，其中包含一个带有一堆函数的 JavaScript 文件，如下所示。

```
$(document).ready(function () {

    // do some setup
});

/* function queries the DOM with the same selector multiple times without caching */
function myFunctionOne() {

    $('#name_input').css("border","1px solid #ccc");
    $('#name_input').val(someValue);        
}

/* function uses cached object from a single query */
function myFunctionTwo() {

    var nameInput = $('#name_input')
    nameInput.css("border","1px solid #ccc");
    nameInput.val(someValue);
    // do some other stuff with cached selector        
} 
```

在`myFunctionOne`我查询 DOM 两次时效率低下，而在`myFunctionTwo`我查询 DOM 一次时，将结果缓存在局部变量中，然后使用该变量。我知道这种方法`myFunctionTwo`更有效，但我不确定我应该在哪里缓存这些对象。目前我正在方法级别缓存对象，但我想知道是否可以在更高级别缓存它，然后在多个函数中使用它。这样我只会查询一次 DOM，然后在这个文件的所有函数中重用结果。我建议的一个例子如下所示。

```
$(document).ready(function () {

    // do some setup
    var nameInput = $('#name_input')
});

/* function uses cached query result from .ready function above */
function myFunctionOne() {

    nameInput .css("border","1px solid #ccc");
    nameInput .val(someValue);        
}

/* function uses cached query result from .ready function above */
function myFunctionTwo() {

    nameInput.val(someValue);
    // do some other stuff with cached selector        
} 
```

这种方法是明智的还是有更好的方法呢？也许使用 .ready 函数是做这种设置的不好的地方，因为它会减慢页面加载速度？是否有另一种方法可以在对象级别缓存 jQuery 对象，还是应该只在函数级别缓存？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-19T21:52:33.153

与此类问题一样，不要过早优化。在这种情况下，这意味着在您注意到性能问题之前不要使用任何缓存。如果您的目标客户使用低规格的计算机或移动设备，这意味着您需要自己在低规格的硬件上进行测试，以便识别此类问题。我强烈建议您在尝试通过添加缓存来提高速度之前先弄清楚。

进一步的几点：

*   如果您使用的是使用 ID 的选择器，它应该很快，因为它将`getElementById`在幕后使用，因此不需要缓存。
*   使用方法链而不是缓存，它只会使用一次选择器
*   如果您确实实现了缓存，请先在本地进行。方法之间的缓存将比本地缓存花费更多的代码复杂性。
*   使用`.ready`是好的。它在 DOM 加载后运行，是执行设置任务的正确位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:52:23.560

一种方法是将选择器存储在`$.cache`：

```
$(function(){

      var $nameInput = $('#name_input');

      $('body').data({ nameInput: $nameInput });

}); 
```

然后使用以下命令访问它：

```
function myFunctionOne() {

    var $nameInput = $('body').data('nameInput');
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-12-10T00:55:15.397

这段代码会很好地混淆。您可以在 _initControls 中添加任意数量的控件，并稍后在整个脚本块中使用它们。如果您希望它对所有脚本块都是全局的，则将 _initControls 函数移出 jQuery onreadystate 函数。

```
 $(function () {
    "use strict";

    var _controls = {},
    _init = function () {
        _initControls();
        _updateData("Hello");
    },
    _initControls = function () {            
        _controls.nameInput = $("#name_input");
    },
    _updateData = function (value) {
        var nameInput = _controls.nameInput;
        nameInput.css("border", "1px solid #ccc");
        nameInput.val(value);
    };

    _init();
}); 
```

# javascript - 如何链接纯 Javascript 和 Jquery

> ID：14968098
> 
> 赞同：0
> 
> 时间：2013-02-19T21:48:07.883
> 
> 标签：javascript, jquery

我有这样的代码：

```
document.body.innerHTML=data(); 
```

这段代码完成后，我想做一些事情（url/split）：

```
$(data).find('a').prop('href', function(_, href){
    url = href.split('/');          
    return href.replace(url[2], 'someUrl');

}); 
```

如何将两个代码链接在一起？我试过：

```
document.body.innerHTML=data().end().find('a').prop('href', function(_, href){
    url = href.split('/');          
    return href.replace(url[2], 'someUrl');

}) 
```

不起作用，尝试了其他一些变化，但没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:52:58.920

也许尝试：

```
document.body.innerHTML = $(data).find('a').prop('href', function(_, href){
    url = href.split('/');          
    return href.replace(url[2], 'someUrl');
}).wrap("<div>").parent().html(); 
```

我不完全确定您的和之间的区别`data()`，`$(data)`因为您将它们混合在一起，但它们完全不同。

无论如何，结果`.prop(name, func)`是之前选择的元素。因此，当您在链中的最后一个调用是`.prop(name, func)`时，您正在尝试设置`document.body.innerHTML`为 jQuery 对象...基本上：`document.body.innerHTML = $("element");`。但我认为您正在尝试获取`data`s HTML，所以这就是我添加的额外链接应该做的。

# r - R 无法识别 Pandoc Linux Mint

> ID：14968103
> 
> 赞同：1
> 
> 时间：2013-02-19T21:48:26.167
> 
> 标签：r, pandoc, linux-mint

我问了一个相关的问题：[检查是否安装了程序](https://stackoverflow.com/questions/14964457/check-if-a-program-is-installed)

但是在我在所有三个系统上为自己测试解决方案之前，我会避免回答。我可以让 pandoc 在 Windows 机器上的 R 中工作，但在 linux 上，我从 R 终端得到每个方法的这个错误/响应：

1：

```
> system('pandoc -v')
sh: 1: pandoc: not found 
```

2：

```
> myPaths <- c("pandoc", 
+              "~/.cabal/bin/pandoc", 
+              "~/Library/Haskell/bin/pandoc", 
+              "C:\\PROGRA~1\\Pandoc\\bin\\pandoc") 

> Sys.which(myPaths)
                           pandoc               ~/.cabal/bin/pandoc 
                               ""   "/home/tyler/.cabal/bin/pandoc" 
     ~/Library/Haskell/bin/pandoc C:\\PROGRA~1\\Pandoc\\bin\\pandoc 
                               ""                                "" 
```

3：

```
> Sys.which("pandoc")
pandoc 
"" 
```

你可能认为我没有安装 pandoc 并且在路径上，但我相信我有。从干净的终端会话：

```
> tyler@trinker ~ $ echo $PATH
> /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/home/tyler/.cabal/bin 
```

和

```
tyler@trinker ~ $ pandoc -v
pandoc 1.10.1
Compiled with citeproc-hs 0.3.7, texmath 0.6.1.3, highlighting-kate 0.5.3.6.
Syntax highlighting is supported for the following languages:
    Actionscript, Ada, Alert, Alert_indent, Apache, Asn1, Asp, Awk, Bash,
    Bibtex, Boo, C, Changelog, Clojure, Cmake, Coffee, Coldfusion, Commonlisp,
    Cpp, Cs, Css, Curry, D, Diff, Djangotemplate, Doxygen, Doxygenlua, Dtd,
    Eiffel, Email, Erlang, Fortran, Fsharp, Gnuassembler, Go, Haskell, Haxe,
    Html, Ini, Java, Javadoc, Javascript, Json, Jsp, Julia, Latex, Lex,
    LiterateCurry, LiterateHaskell, Lua, Makefile, Mandoc, Matlab, Maxima,
    Metafont, Mips, Modula2, Modula3, Monobasic, Nasm, Noweb, Objectivec,
    Objectivecpp, Ocaml, Octave, Pascal, Perl, Php, Pike, Postscript, Prolog,
    Python, R, Relaxngcompact, Rhtml, Ruby, Scala, Scheme, Sci, Sed, Sgml, Sql,
    SqlMysql, SqlPostgresql, Tcl, Texinfo, Verilog, Vhdl, Xml, Xorg, Xslt, Xul,
    Yacc, Yaml
Copyright (C) 2006-2013 John MacFarlane
Web:  http://johnmacfarlane.net/pandoc
This is free software; see the source for copying conditions.  There is no
warranty, not even for merchantability or fitness for a particular purpose. 
```

**如何让 Linux Mint 上的 R 识别 pandoc？**（我是 Linux 新手）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T02:03:25.453

我也有这个问题。我也通过 cabal 安装了 pandoc。如果你通过 apt-get 安装应该没有问题。如果我从终端启动 R，我没有问题，但尝试从 RStudio 中检测 pandoc 会遇到一些麻烦。原因是 RStudio 不会读取您的 bash 环境变量，因此如果您修改 .bashrc 中的路径，RStudio 将不会检测到这一点。一种解决方案是改为通过 .profile 修改路径。

将此添加到 .profile 文件的底部并删除 .bashrc 文件中的路径修改，您应该能够从 R 中识别 pandoc。

```
if [ -d "$HOME/.cabal/bin" ] ; then
    PATH="$PATH:$HOME/.cabal/bin"
fi 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-20T03:16:31.400

这就是我的想法。我去掉了你`html5`函数中的所有其他东西，只是为了看看它会返回什么，并让你大致了解我的思维过程：

首先，创建一个函数来确定 Pandoc 的安装位置。如果匹配多个位置（在您的情况下很可能是“pandoc”和“~/.cabal/bin/pandoc”，*如果*它正确检测到路径），它将只选择第一个选项。

```
wheresPandoc <- function() {
  myPaths <- c("pandoc", 
               "~/.cabal/bin/pandoc", 
               "~/Library/Haskell/bin", 
               "C:\\PROGRA~1\\Pandoc\\bin\\pandoc.exe")
  temp <- Sys.which(myPaths)
  temp <- names(temp[temp != ""])[1]
  if (is.na(temp)) stop("Pandoc not installed in one of the typical locations")
  else temp
} 
```

单独运行该函数如下所示：

```
wheresPandoc()
# [1] "~/.cabal/bin/pandoc" 
```

所以，你可以在你的`html5`函数中使用它的输出来构造你的`system`“动作”。

```
html5 <- function(in.file = NULL, out.file = NULL) {
  action <- paste0(wheresPandoc(), 
                   " -s -S -i -t dzslides --mathjax ", 
                   in.file, " -o ", out.file)
  action
}

html5(in.file = "this.txt", out.file = "that.html")
# [1] "~/.cabal/bin/pandoc -s -S -i -t dzslides --mathjax this.txt -o that.html" 
```

* * *

这可能会使事情变得过于复杂，但如果您认为您的用户精通技术或在有趣的位置安装程序（并记住他们安装程序的位置）的用户类型，您可以考虑更改`wheresPandoc`为类似以下内容。我已经注释掉了典型的阴谋集团位置，所以你可以看到它是如何工作的。

```
wheresPandoc <- function() {
  myPaths <- c("pandoc", 
  #            "~/.cabal/bin/pandoc", 
               "~/Library/Haskell/bin", 
               "C:\\PROGRA~1\\Pandoc\\bin\\pandoc.exe")
  temp <- Sys.which(myPaths)
  temp <- names(temp[temp != ""])[1]
  if (is.na(temp)) {
    ans <- readline("Pandoc not installed in one of the typical locations.\n 
                    Do you know where Pandoc is installed? (y/n) ")
    if (ans == "y") temp <- readline("Enter the (unquoted) path to Pandoc: ")
    else if (ans == "n") stop("Pandoc not installed or not found.")
  } 
  temp
} 
```

在我的系统上，运行它看起来像这样。对于第一个问题，我回答“y”，然后它要求我指定 Pandoc 的未引用路径并使用它来构建您的`system`调用。

```
> html5(in.file = "this.txt", out.file = "that.html")
Pandoc not installed in one of the typical locations.

Do you know where Pandoc is installed? (y/n) y
Enter the (unquoted) path to Pandoc: ~/.cabal/install/pandoc
[1] "~/.cabal/install/pandoc -s -S -i -t dzslides --mathjax this.txt -o that.html" 
```

我认识的大多数普通用户如果看到这样的问题就会直接关闭，但我认识的大多数 R 用户都比较注重技术，所以他们可能不会被它吓到。

# javascript - 如何将 HTML id 存储为 js 变量？

> ID：14968108
> 
> 赞同：1
> 
> 时间：2013-02-19T21:48:34.590
> 
> 标签：javascript, html, variables, getelementbyid, onmouseover

我正在编写一个每页有 200 多个链接的网页。每个链接都有一个与另一个帧中的 id 匹配的唯一 id。我想运行一个 onmouseover 函数，该函数将跨帧更改两个链接的文本颜色。这是我到目前为止所得到的。

```
<html><head><title>Test</title>
  <script>
    function hey()
      {var id=//HELP PLEASE; document.getElementById(id).style.color = "red";} 
    function bye()
      {var id=//HELP PLEASE; document.getElementById(id).style.color = "black";}
  </script>
 </head>
<body>
 <a id="1" class="word" onmouseover="hey()" onmouseout="bye()">hello</a> 
 <a id="2" class="word" onmouseover="hey()" onmouseout="bye()">world</a>....
</body></html> 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:52:33.257

将 id 传递给函数：

```
<html><head><title>Test</title>
  <script>
    function hey(id)
      {document.getElementById(id).style.color = "red";} 
    function bye(id)
      {document.getElementById(id).style.color = "black";}
  </script>
 </head>
<body>
 <a id="1" class="word" onmouseover="hey(this.id)" onmouseout="bye(this.id)">hello</a> 
 <a id="2" class="word" onmouseover="hey(this.id)" onmouseout="bye(this.id)">world</a>....
</body></html> 
```

# mysql - 如何用整个表格显示 MIN 值

> ID：14968111
> 
> 赞同：0
> 
> 时间：2013-02-19T21:48:43.083
> 
> 标签：mysql, select, min

我有这样的表：

```
id col1 col2
1   a    55
2   b    77 
```

结果我想看到：

```
id col1 col2 MIN(col2)
1   a    55   55
2   b    77 
```

类似的东西，或者在其他情况下，我如何获得整个表格的一个最小值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:51:07.737

您可以将 a与子查询一起使用，该子查询将为整个表`CROSS JOIN`选择值：`min(col2)`

```
select t1.id, 
  t1.col1, 
  t1.col2, 
  t2.minCol2
from yourtable t1
cross join
(
  select min(col2) minCol2
  from yourtable
) t2 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/4aee1/2)。

如果要将其扩展为仅显示`min(col2)`第一行的值，则可以使用用户定义的变量：

```
select id,
  col1, 
  col2,
  case when rn = 1 then mincol2 else '' end mincol2
from
(
  select t1.id, 
    t1.col1, 
    t1.col2, 
    t2.minCol2,
    @row:=case when @prev:=t1.id then @row else 0 end +1 rn,
    @prev:=t1.id
  from yourtable t1
  cross join
  (
    select min(col2) minCol2
    from yourtable
  ) t2
  cross join (select @row:=0, @prev:=null) r
  order by t1.id
) d
order by id 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/4aee1/7)

如果您有多个要比较的列，则可以使用查询*取消透视*`UNION ALL`数据，然后选择`min`结果的值：

```
select t1.id, 
  t1.col1, 
  t1.col2, 
  t2.MinCol
from yourtable t1
cross join
(
  select min(col) MinCol
  from
  (
    select col2 col
    from yourtable
    union all
    select col3
    from yourtable
  ) src
) t2 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/875d1/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:54:45.750

你不能。列数是固定的，因此您可以获得@bluefeet 描述的所有行的最小值。

您可以使用以下逻辑在较少的行数（通常为 1）上获取它：

```
(case when t2.minCol2 = t1.col2 then t2.minCol2 end) 
```

但这会将 NULL 放在其他行上。

# arrays - 为整个数组创建 If 语句

> ID：14968112
> 
> 赞同：0
> 
> 时间：2013-02-19T21:48:46.683
> 
> 标签：arrays, if-statement

所以这是我的情况。我是编程新手，我刚刚开始制作一个非常非常基本的平台游戏。我的意思是真正的平台游戏。

我已经让我的角色进入并跳来跳去，我已经将我的平台创建为一个阵列。这样我就可以将它们并排放在底部。现在还有其他方法可以解决这个问题，但我想知道如何为数组做这件事。

所以我的性格因此而堕落

```
kirby.yVelocity += 1.0f 
```

这一切都很好，但我希望他的 yVelocity 在他击中阵列中的任何平台时达到 0.0f。

所以我尝试了这段代码

```
if (plat[i].drawRect.Intersects(kirby.drawRect))
{
kirby.yVelocity = 0.0f
} 
```

我认为这会起作用，但它给了我一个错误，因为 [i] 说它在这种情况下不适用。

几点注意事项：

kirby 是我的角色名称，drawRect 是 Rectangle 的定义，plat 是我的 Platform 数组，由 13 个平台组成。

感谢任何能提供帮助的人

* * *

更新

问题是 plat.drawRect 或 plat[i].drawRect 的任何变体都不起作用。这是我与平台数组相关的所有代码。

```
 struct Platform
    {
        public Texture2D txr;
        public Rectangle drawRect;
    }

Platform[] plat;

   plat = new Platform[13];
           for (int i = 0; i < plat.Length; i++)
           {
               plat[i].txr = Content.Load<Texture2D>("platform");
               plat[i].drawRect = new Rectangle(i * plat[i].txr.Width, 460, plat[i].txr.Width, plat[i].txr.Height);`
           }

 for (int i = 0; i < plat.Length; i++)
            {
                spriteBatch.Draw(plat[i].txr, plat[i].drawRect, Color.White);
            }
            spriteBatch.End(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:55:13.710

似乎您必须添加一个 for 循环才能在平台上循环。也许是这样的：

```
for(Platform : plat){
    if (platform.drawRect.Intersects(kirby.drawRect)){
        kirby.yVelocity = 0.0f;
    }
} 
```

在这里，我假设您使用的是 Java，并且`Platform`是您的 plat-array 的类，它具有 class `List<Platform>`。

# jquery - Rails jquery在选择中包含空白

> ID：14968117
> 
> 赞同：0
> 
> 时间：2013-02-19T21:48:53.477
> 
> 标签：jquery, ruby-on-rails, coffeescript

当用户创建新工作订单时，他们首先选择工作组，然后他们可以从包含该工作组中员工列表的下拉列表中选择分配给人员。这样做，我正在使用 jquery 创建该组中员工的选择列表。

但是，我不知道如何通过 jquery 添加空白选择。

这是视图代码：

```
 <%= f.grouped_collection_select :employee_id, Workgroup.order(:id), :employees, :group_name, :id, :employee_full_name, :include_blank => true %> 
```

这是 jquery cofeescript：

```
employees = $('#workorder_employee_id').html()
$('#workorder_workgroup_id').change ->
  group = $('#workorder_workgroup_id :selected').text()
  options = $(employees).filter("optgroup[label='#{group}']").html()
  if options
    $('#workorder_employee_id').html(options)
    $('#workorder_employee_id').parent().show()
  else
    $('#workorder_employee_id').empty()
    $('#workorder_employee_id').parent().hide() 
```

如何在选项列表中添加空白？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T23:52:19.163

`if`将语句后的第一行更改为

```
$('#workorder_employee_id').html('<option value="">Please Select</option>' + options) 
```

# c++ - PyRun_SimpleString 对于 def foo() 失败：

> ID：14968119
> 
> 赞同：1
> 
> 时间：2013-02-19T21:48:53.790
> 
> 标签：c++, python, python-embedding

对于名称/路径中包含 unicode（widechar）的文件，我无法让 PyRun_SimpleFile 工作（FILE* 兼容性问题），因此这个问题！

因此，我决定自己打开 python 脚本，然后使用 PyRun_SimpleString 执行每一行。

此处显示的伪代码。

```
wchar_t* pWScriptName=NULL;
// pWScriptName malloced & populated here
FILE* fp = _wfopen(pWScriptName, L"r");
while (fgets(line, BUFSIZ, fp) != NULL) {
    int ret = PyRun_SimpleString(line);
    if(ret != 0) {
        ... error at lineNum ...
    }
    lineNum++;
} 
```

上面在下面的 def 语句中给出了错误（<- 如下所示）

Python版本是2.7

```
import os
print "hello"
def foo():  # <-- PyRun_SimpleString fails here
    print "hello again" 
```

我想用它来显示如果/它失败的脚本的行号。许多其他人似乎使用 PyRun_SimpleString 取得了成功！

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:51:15.800

在这种情况下，您不会使用 PyRun_SimpleString，因为它希望在一行中读取整个程序，您将其分成多行。

你应该只使用`PyRun_SimpleFile(fileReference, scriptPath)`

注意：您需要创建 globals 和 locals 对象才能使上述工作。

[看到这个](http://docs.python.org/2/c-api/veryhigh.html)

# c# - 将数据检索到组合框中

> ID：14968125
> 
> 赞同：1
> 
> 时间：2013-02-19T21:49:11.907
> 
> 标签：c#, sql-server, combobox, textbox

这就是我的[表单](http://www.mediafire.com/view/?myfiles#5itvbjj1cu1112l)的样子，我的代码如下所示：

```
using System.Data.SqlClient;

namespace ProjectCSharpSQLserver
{
    public partial class Form1 : Form
    {
        SqlConnection cn = new SqlConnection(@"Data Source=.\SQLEXPRESS;AttachDbFilename=I:\ProjectCSharpSQLserver\ProjectCSharpSQLserver\CsSQL.mdf;Integrated Security=True;User Instance=True");
        SqlCommand cmd = new SqlCommand();
        DataTable dt = new DataTable();

        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            cn.Open();
            SqlDataAdapter sda = new SqlDataAdapter("insert into info (id, Name, phone, Address) Values ('" + textBox1.Text + "', '" + textBox2.Text + "', '" + textBox3.Text + "', '" + textBox4.Text + "')", cn);
            sda.Fill(dt);
            cn.Close();
        }
    }
} 
```

我需要知道如何打开组合框，找到 Id，选择一个，然后文本框由数据库中的数据填充，这样我就可以删除和更新数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:56:24.087

我找到了一个可以[在这里](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selectedindexchanged.aspx)使用的例子。

```
private void cb1_SelectedIndexChanged(object sender, EventArgs e)
{
   ComboBox cb = (ComboBox)sender;
   cn.Open();
   SqlDataAdapter sda = new SqlDataAdapter("Place your DELETE statement here", cn);
   sda.Fill(dt);
   cn.Close();
} 
```

这将在`combobox`每次更改时运行选定的语句。顺便说一句，当您运行 SqlDataAdapter 时，它会*自动为您打开和关闭*与数据库的连接，因此您不必*使用*`cn.Open()`/ `cn.Close()`。但是这样做仍然是一个好习惯。

提醒您，一旦您对 C# 和 ADO.NET 更加熟悉，我会认真考虑使用[参数化查询。](https://stackoverflow.com/questions/5468425/how-do-parameterized-queries-help-against-sql-injection)

# php - 如何修复 Symfony2 SonataAdminBundle undefined index _per_page ？

> ID：14968127
> 
> 赞同：1
> 
> 时间：2013-02-19T21:49:23.030
> 
> 标签：php, doctrine-orm, symfony-2.1, sonata-admin

我刚刚将我的 symfony2.1.6 升级到 Symfony2.1.7 并遇到了这个问题。请让我知道我可以提供更多详细信息。2.1.6 很好，但在 2.1.7 中似乎不起作用。

当我尝试访问 Customer.php 实体（客户列表）时出现此错误

```
Notice: Undefined index: _per_page in /var/www/playground/vendor/sonata-project/admin-bundle/Sonata/AdminBundle/Admin/Admin.php line 720 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T12:29:06.197

The datagridValues are initialized on the $datagridValues of the base Sonata\AdminBundle\Admin\Admin class. The reason i saw this problem was when people where updating $this->datagridValues in their code by assigning a full array. We fixed the issue by assigning single values in the array instead of overwriting the full array.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T05:29:47.227

感谢 prodigitalson 的评论，我通过传递参数解决了您建议的问题。

现在我的 CustomerAdmin.php 扩展了覆盖 Admin 的 AbstractAdmin 类。这个 AbstractAdmin 包含公共代码，所有其他 Admin 类都扩展了这个抽象类。

```
<?php

namespace xxxx\AdminBundle\Admin;
use Sonata\AdminBundle\Admin\Admin;
use Doctrine\ORM\EntityManager;
use Sonata\AdminBundle\Datagrid\DatagridMapper;
use Sonata\AdminBundle\Datagrid\ListMapper;
use Sonata\AdminBundle\Show\ShowMapper;
use Sonata\AdminBundle\Form\FormMapper;
use Sonata\AdminBundle\Route\RouteCollection;

abstract class AbstractAdmin extends Admin
{
    /** @var int */
    protected $maxPerPage = 10;
    //other attributes

    public function __construct($code, $class, $baseControllerName)
    {
        parent::__construct($code, $class, $baseControllerName);
        $this->fields = $this->sortFields($fields);

        // custome arguments
        if (!$this->hasRequest()) {
            $this->datagridValues = array(
              ***'_per_page' => $this->maxPerPage*** //passing ***_per_page*** argument
        );
    }
}

<?php

namespace xxxx\AdminBundle\Admin;
use Sonata\AdminBundle\Admin\Admin;
use Sonata\AdminBundle\Route\RouteCollection;

class CustomerAdmin extends AbstractAdmin
{
   //code here
} 
```

# iphone - UITableView 内容未出现在 UIAlertView 中

> ID：14968129
> 
> 赞同：0
> 
> 时间：2013-02-19T21:49:25.680
> 
> 标签：iphone, ios, popup, uitableview, uialertview

我将自定义 UITableViewController 放入 UIAlertView。我填充了表格，但没有出现内容。

```
- (void)addC { // <== This is get called first
    //Create alertView
    UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"" message:@"" delegate:self cancelButtonTitle:nil otherButtonTitles:nil, nil];

    //PopUpTableViewController is a subclass of UITableViewController
    PopUpTableViewController *popUpViewController = [[PopUpTableViewController alloc] initWithStyle:UITableViewStylePlain];
    // ..
    popUpViewController.array = ...;
    UITableView *tableView = [[UITableView alloc] initWithFrame:CGRectMake(10, 8, 300, MIN(8*44, categoricalVariables.count*44)) style:UITableViewStylePlain];
    popUpViewController.tableView = tableView;
    tableView.delegate = popUpViewController;
    tableView.dataSource = popUpViewController;
    popUpViewController.tableView.tag = 1;

    [alertView addSubview:popUpViewController.tableView];

   //Show alertView
    [alertView show];
}

- (void)willPresentAlertView:(UIAlertView *)alertView { 
// This method is an UIAlertViewDelegate method.
// I set here the sizes of alertView and tableView
    UITableView *tableView = (UITableView *)[alertView viewWithTag:1];
    CGRect r0 = tableView.frame;
    r0.size.width = alertView.frame.size.width - 20;
    tableView.frame = r0;

    CGRect r = alertView.frame;
    r.size.height = tableView.frame.size.height + 24;
    alertView.frame = r;     
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T23:16:50.890

尝试在 willPresentAlertView 中重新加载 tableview 顺便说一下，如果 PopUpTableViewController 是 UITableViewController 的子类，我认为不需要再次设置 tableview 及其委托和数据源。因为所有这些都会在你分配和初始化时自动设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T00:08:41.490

使用 UIActionSheet 将 UITableView 嵌套到 UIAlertView 中是更好的方法。

# azure - AjaxMin 无法在 Azure 站点上运行

> ID：14968131
> 
> 赞同：0
> 
> 时间：2013-02-19T21:49:32.483
> 
> 标签：azure, asp.net-mvc-4, ajaxmin

我正在使用 Microsoft 的 AjaxMin 来缩小我的网站上的 javascript，该网站由 Azure 托管。我正在使用 BuildTask 在运行时自动缩小 javascript。此构建任务在 .csproj 文件中指定。

该过程在我的本地环境中运行，但是，当我部署到我的 Azure 站点时它不起作用。当我尝试引用 .js 文件的缩小版本时，天蓝色站点抛出 404: file not found 错误。

是否可以在 Azure 站点上使用构建任务？有什么我想念的吗？我已经确保不要在源代码管理中包含 .min.js 文件，因为这个（[http://www.asp.net/ajaxlibrary/AjaxMinQuickStart.ashx](http://www.asp.net/ajaxlibrary/AjaxMinQuickStart.ashx)）教程建议，但我想知道是否有任何特定于 Azure 的东西我需要设置。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T16:01:46.163

我已经在我的项目中正常工作了。我会告诉你我是怎么做到的，尽管这可能不是最简单或最直接的方法。

在我们开始之前，能够检查您的缩小文件是否包含在 Azure 部署包中而不实际部署会很有帮助。这很容易做到。该`.cspkg`文件实际上是一个 zip 格式的文件，因此您可以使用任何 zip 存档器打开它。（我喜欢为此使用 7Zip，因为右键单击 -> 打开存档命令不需要您重命名文件，但您可以使用 Windows 资源管理器、WinRAR 等。）在里面`.cspkg`你会看到另一个大文件一个`.cssx`扩展。那也是一个zip文件。在其中，`.cssx`您会找到一个`sitesroot`文件夹，其中包含您正在部署的每个网站的子目录，其中包含您所有的实际网站文件。因此，您可以在那里四处逛逛，看看哪些文件正在部署到 Azure。

首先，尝试为您的 Web 项目编辑项目文件（包含所有 Javascript/CSS 文件的文件）。您可以使用记事本，或者在 Visual Studio 中右键单击项目，选择“卸载项目”，然后再次右键单击并选择“编辑”。在项目文件中，插入如下部分：

```
<ItemGroup>
    <!-- Copy over all the minified CSS & JS to the output directory-->
    <Content Include="**\*.min.css" />
    <Content Include="**\*.min.js" />
</ItemGroup> 
```

然后重新加载项目，重新打包，看看你的文件是否包含在`.cspkg`文件中。如果他们是，那么你就完成了。

如果没有，还有其他几件事需要检查。您的缩小可能未在正确的构建阶段运行。我的缩小目标如下所示：

```
<Target Name="PrepWebApp" Condition="$(Configuration)=='Release'" AfterTargets="AfterBuild"> 
```

如果这仍然不起作用，并且您的 Web 角色中有多个站点和/或虚拟应用程序，则可能是所有站点的打包步骤都没有运行。因此，当您将项目打包以部署到 Azure 时，它​​可能仍未运行缩小步骤（以及 web.config 转换和其他一些事情）。如果是这种情况，请参阅[此博客文章](http://michaelcollier.wordpress.com/2013/01/14/multiple-sites-in-a-web-role/)以了解解决方法。

以防万一该博客文章消失，我将在此处复制最相关的部分。您可以将其放入您的网络角色的 .ccproj 文件中（更改适当的位以匹配您的项目结构）：

```
<PropertyGroup>
  <!-- Inject the publication of "secondary" sites into the Windows Azure build/project packaging process. -->
  <CoreBuildDependsOn>
    CleanSecondarySites;
    PublishSecondarySites;
    $(CoreBuildDependsOn)
  </CoreBuildDependsOn>
  <!-- This is the directory within the web application project directory to which the project will be "published" for later packaging by the Azure project. -->
  <SecondarySitePublishDir>azure.publish\</SecondarySitePublishDir>
</PropertyGroup>
<!-- These SecondarySite items represent the collection of sites (other than the web application associated with the role) that need special packaging. -->
<ItemGroup>
  <SecondarySite Include="..\WebApplication1\WebApplication1.csproj" />
  <SecondarySite Include="..\WebApplication2\WebApplication2.csproj" />
</ItemGroup>
<Target Name="CleanSecondarySites">
  <RemoveDir Directories="%(SecondarySite.RootDir)%(Directory)$(SecondarySitePublishDir)" />
</Target>
<Target Name="PublishSecondarySites" Condition="'$(PackageForComputeEmulator)' == 'true'
                      Or '$(IsExecutingPublishTarget)' == 'true' ">
  <!--
    Execute the Build (and more importantly the _WPPCopyWebApplication) target to "publish" each secondary web application project.

    Note the setting of the WebProjectOutputDir property; this is where the project will be published to be later picked up by CSPack.
  -->
  <MSBuild Projects="%(SecondarySite.Identity)" Targets="Build;_WPPCopyWebApplication" Properties="Configuration=$(Configuration);Platform=$(Platform);WebProjectOutputDir=$(SecondarySitePublishDir)" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:12:54.543

构建项目时，构建任务将在 Visual Studio 中运行。您需要确保将缩小文件也部署到 Azure。

我猜这可能是因为该项目是在构建时生成的，它不是项目本身的一部分，并且部署步骤忽略了这一点。

请检查正在使用的部署系统将包括所有脚本文件，而不仅仅是项目本身中的那些。

# android - 在 Android 中设置设备上登录过滤器

> ID：14968133
> 
> 赞同：0
> 
> 时间：2013-02-19T21:49:39.500
> 
> 标签：android, logging, logcat

当您在 Android 中记录某些内容时，它会将一行放入固定大小的缓冲区中。如果您收到的消息多于缓冲区的容量，则旧消息将被丢弃。您总是会看到一个固定大小的最新日志消息窗口。

运行 logcat 将为您提供此缓冲区的当前内容，如果继续运行，它将向您显示记录的新事件。您可以过滤 logcat 的输出，例如，您只能看到属于某个标签的消息。

> 是否有任何方便的设施，首先只有带有特定标签的事件才被放入固定大小的缓冲区中？

基本上，我希望能够告诉 Android 我只希望 Log 类使用我的标签记录事件。我不希望它记录所有事件并在以后处理它们，因为我的事件很少见，而其他事件很常见，以至于它们会导致我的事件从缓冲区中被逐出。

我更喜欢不涉及让设备插入的解决方案（即，让 logcat 运行并将过滤后的输出重定向到文件）。一个可行的解决方案是编写我自己的设备上日志记录系统（写入我创建的文件），但如果我可以从 Android 日志记录中免费获得这个，我会更喜欢。

我环顾四周，到目前为止还没有取得很大的成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:54:31.967

> 是否有任何方便的设施，首先只有带有特定标签的事件才被放入固定大小的缓冲区中？

也许在有根设备上，尽管我不知道有一个。

在非 root 设备上，您无权影响其他应用程序的日志记录或操作系统自己的日志记录。

# django - Django 安全性

> ID：14968135
> 
> 赞同：0
> 
> 时间：2013-02-19T21:49:43.367
> 
> 标签：django, tastypie

希望可以有人帮帮我。

我有一个带有 Django 和美味派的堆栈（我使用 apikey 来验证和授权用户）。让我解释一下我想要做什么。

我有几个用户只能访问他们的数据，所以想象一个用户通过一个 rest 服务访问模型 requestoffer 的所有行，如下所示。

```
http://127.0.0.1:8001/api/v1/requestoffer/?format=json&username=door1&api_key=84051c6fd1581ad60ffa96bcf5a50d3fc11ccdd3 
```

但我不希望该用户访问所有请求提供，我只希望他访问他是“专有”的那些。

你知道如何用 Django 或 Tastypie 做到这一点吗？

我说清楚了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:19:05.590

如果每一行都属于一个特定用户，那么您可以将其作为外键添加到 requestoffer 并过滤用户的查询集。另一种方法是扩展 Authorization 类并实现 apply_limits。

```
class MyAuthorization(DjangoAuthorization):
    def apply_limits(self, request, object_list):
        if request and hasattr(request, 'user'):
            return object_list.filter(requestoffer__user=request.user.id)

        return object_list.none() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:22:25.213

有很多方法可以实现权限管理。哪一个适合您的需求完全取决于您。实现此目的的一种方法可能是与相关模型创建“所有权”关系，然后为该模型创建一个管理器，仅根据请求返回记录。模型管理器的文档非常简单（而且优雅）。

要自动化记录所有权，您可以创建一个 CurrentUserField，如[Pro Django](http://prodjango.com/)中所述，还有多种方法可以实现它。所以长话短说，你应该通过反复试验来学习。

# php - curl 和 get_file_contents 不适用于 url 上的参数

> ID：14968138
> 
> 赞同：0
> 
> 时间：2013-02-19T21:49:47.007
> 
> 标签：php

我正在尝试编写一个能够从网站收集数据的 php 脚本。我的问题是 file_get_contents 和 curl 功能：我需要获取 URL [http://www.booking.com/searchresults.it.html?city=-121726;rows=20;offset=20](http://www.booking.com/searchresults.it.html?city=-121726;rows=20;offset=20)的 html，这是第二个米兰酒店列表页面。我得到的总是列表的第一页，就好像我从 offset=0 得到的一样！您可以轻松验证，上述网址在任何浏览器中都可以正常工作，显示酒店列表的第二页！问题仅在于 curl 和 file_get_contents 函数！你能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:20:56.170

试试这个网址 [http://www.booking.com/searchresults.it.html?city=-121726&rows=20&offset=20](http://www.booking.com/searchresults.it.html?city=-121726&rows=20&offset=20)

我已经为booking.com做了一个爬虫，真是巧合

# objective-c - 如何检测某个应用程序何时打开？

> ID：14968140
> 
> 赞同：0
> 
> 时间：2013-02-19T21:49:58.830
> 
> 标签：objective-c, macos, applescript

有没有办法在 Applescript 或 Objective-C 中检测某个应用程序何时打开？我的目标是向我正在开发的应用程序添加一项功能，以便在“QuickTime Player”打开时显示一条消息，但我在 Apple 开发人员文档中没有找到任何内容来显示如何执行此类操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:06:57.220

这对于 Objective-C 来说非常简单。这是代码：

从以下位置注册适当的通知`NSWorkspace`：

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    //Fetch the notification center from the workspace
    NSNotificationCenter* center = [[NSWorkspace sharedWorkspace] notificationCenter];

    [center addObserver:self selector:@selector(newApplicationDidLaunch:) name:NSWorkspaceDidLaunchApplicationNotification object:nil];

    [center addObserver:self selector:@selector(newApplicationWillLaunch:) name:NSWorkspaceWillLaunchApplicationNotification object:nil];

} 
```

然后，为通知添加您的选择器。通知的 userInfo 字典将包含您需要知道的所有内容：

```
-(void)newApplicationDidLaunch:(NSNotification*)notification {

    NSDictionary* userInfo = notification.userInfo;
    //Do what you want here after application launch.
}

-(void)newApplicationWillLaunch:(NSNotification*)notification {

    NSDictionary* userInfo = notification.userInfo;
    //Do what you want here to prepare for application launch.
} 
```

希望有帮助。

# php - 使用正则表达式在php中解析html字符串

> ID：14968143
> 
> 赞同：1
> 
> 时间：2013-02-19T21:50:15.273
> 
> 标签：php, html, regex, parsing

我想使用 php 解析一个 html 字符串（简单数字匹配）。

```
<i>1002</i><i>999</i><i>344</i><i>663</i> 
```

我想要结果作为一个数组。例如：`[1002,999,344,633,...]` 我试过这样：

```
<?php
    $html="<i>1002</i><i>999</i><i>344</i><i>663</i>";
    if(preg_match_all("/<i>[0-9]*<\/i>/",$html, $matches,PREG_SET_ORDER))
        foreach($matches as $match) {
            echo strip_tags($match[0])."<br/>";
        }
?> 
```

我得到了我想要的确切输出。

```
1002
999
344
663 
```

但是，当我通过对正则表达式进行小的更改来尝试相同的代码时，我得到了不同的答案。

像这样：

```
<?php
    $html="<i>1002</i><i>999</i><i>344</i><i>663</i>";
    if(preg_match_all("/<i>.*<\/i>/",$html, $matches,PREG_SET_ORDER))
        foreach($matches as $match) {
            echo strip_tags($match[0])."<br/>";
        }
?> 
```

输出 ：

```
1002999344663 
```

（正则表达式匹配整个字符串。）

现在我想知道为什么我会变成这样？`.*`如果使用（零个或多个）而不是 有什么区别`[0-9]*`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:05:37.120

正`.*`则表达式中的 匹配*任何*字符（`[0-9]*`仅匹配数字而`</i><i>`不是数字）。正则表达式`/<i>.*<\/i>/`匹配：

```
<i>1002</i><i>999</i><i>344</i><i>663</i>
^ from here ------------------- to here ^ 
```

因为，整个字符串都在里面`<i></i>`。

这是因为`*`贪心。它需要它可以匹配的*最大字符数。*

要解决您的问题，您需要使用`.*?`. 这使得它可以匹配的字符数量*最少*。

正则表达式`/<i>.*?<\/i>/`将按您的意愿工作。

# android - 我的移动 Android 设备和我的 PC 之间的套接字连接

> ID：14968146
> 
> 赞同：0
> 
> 时间：2013-02-19T21:50:20.813
> 
> 标签：android, sockets, android-networking

我想在我的移动 Android 设备和我的 PC 之间建立一个套接字连接，以便将一个字符串从我的手机发送到 PC 上运行的 Android 应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:34:57.573

请参阅本教程以设置 TCP 连接，这可能是您正在寻找的，基于 PC 端的 Java，可能是服务器或客户端： [链接](http://myandroidsolutions.blogspot.co.il/2012/07/android-tcp-connection-tutorial.html)

有关编写客户端-服务器软件的更多基本信息，您还可以查看这一[系列 YouTube 教程](http://www.youtube.com/watch?v=pr02nyPqLBU)

# json - 加载后访问jquery json数据？

> ID：14968148
> 
> 赞同：0
> 
> 时间：2013-02-19T21:50:35.430
> 
> 标签：json

如何从 getJSON 命令外部访问我的数据？

```
//LOAD JSON
$.getJSON("users.js", function(data) {
   numberOfPieces = data.users.length;
   alert("Loaded "+numberOfPieces); //   <------WORKS
});

//Select a piece
var pieceSelected = Math.floor(Math.random() * (numberOfPieces));
alert("pieceSelected: "+data.users[pieceSelected].Name); //   <------RETURNS "data is not defined" 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:56:43.883

您的问题是函数参数的范围仅限于该函数并且在函数之外无法访问。通过使用范围之外的变量，事情应该按预期工作。

```
var piecesData;

//LOAD JSON
$.getJSON("users.js", function(data) {
   piecesData = data;
   numberOfPieces = data.users.length;
   alert("Loaded "+numberOfPieces); //   <------WORKS
});

//Select a piece
var pieceSelected = Math.floor(Math.random() * (numberOfPieces));
alert("pieceSelected: "+ piecesData.users[pieceSelected].Name); 
```

# openerp - OpenERP：通过继承销售订单在“状态”字段上添加新选择

> ID：14968150
> 
> 赞同：0
> 
> 时间：2013-02-19T21:50:43.960
> 
> 标签：openerp

我真的需要在我的销售订单对象上添加一个额外的“状态”值。从 7.0 版开始，'sale_stock' 模块已经做到了这一点。当您尝试从自己的模块中执行相同的操作时，您的*键值*将被忽略。有没有其他选择可以实现这一目标？
正如我发现的那样，这似乎是两年前的一个老问题，正如这个[线程](http://openerp-expert-framework.71550.n3.nabble.com/fields-selection-inherit-problem-td923892.html)中所解释的那样。建议的解决方法是执行以下操作：

```
_inherit = 'sale.order'
def __init__(self, pool, cr):
    super(sale_order, self)._columns['state'].selection.append(('keyx', 'valuex')) 
```

我发现这种方法是合乎逻辑的，但它导致了以下错误：

```
`File "/home/nicolas/Eclipse/OpenERP/7.0/src/openerp/osv/orm.py", line 2958, in _auto_init
    self._field_create(cr, context=context)
File "/home/nicolas/Eclipse/OpenERP/7.0/src/openerp/osv/orm.py", line 764, in _field_create
    ir_model_fields_obj = self.pool.get('ir.model.fields')
AttributeError: 'sale.order' object has no attribute 'pool'` 
```

应该在启动板上报告此错误还是意外使用？您还能建议哪些其他可能的解决方案？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:16:16.367

尝试这个

```
from openerp.osv import osv, fields
class sale_order(osv.osv):
    _inherit = 'sale.order'
    selection_list = [];#add your selection list here.
    _columns = {
        'state': fields.selection(selection_list,'State');#add necessary arguments
    }
sale_order() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T06:14:24.380

只需继承 sale.order 模型并添加您在现有模型中定义的状态字段，添加您需要添加的外部状态

例如：

```
class sale_order(osv.osv)

    _inherit ='sale.order'

    _columns = {
       'state': fields.selection([
        ('draft', 'Quotation'),
        ('waiting_date', 'Waiting Schedule'),
        ('manual', 'To Invoice'),
        ('progress', 'In Progress'),
        ('shipping_except', 'Shipping Exception'),
        ('invoice_except', 'Invoice Exception'),
        ('done', 'Done'),
        ('cancel', 'Cancelled'),
        **('key','value')**, 
```

# 上面这将是您新添加的选择值序列无关紧要。

```
 ], 'Order State', readonly=True, help="Gives the state of the quotation or sales order. \nThe exception state is automatically set when a cancel operation occurs in the invoice validation (Invoice Exception) or in the picking list process (Shipping Exception). \nThe 'Waiting Schedule' state is set when the invoice is confirmed but waiting for the scheduler to run on the order date.", select=True),

    }

sale_order() 
```

高于键值将是您的附加选择字段，您可以根据您的要求在序列中的任何位置设置它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-14T05:47:34.403

有同样的问题，我看了一下线程，你注意到了。我想问题出在我们的模块和 sale_stock 是“冲突的”这一事实，因为它们修改了 sale.order 对象中的相同字段（'state'）并且不相互依赖。一种解决方案是修改您自己的模块并在 openerp .py 的“依赖”列表中添加“sale_stock **”**：

```
depends : ['sale_stock',...] 
```

您可以在此模块中看到一个示例，该示例在状态字段中有另一个（键，值）：[http ://bazaar.launchpad.net/~agaplan/agaplan-addons/7.0/files/head:/sale_double_validation/](http://bazaar.launchpad.net/~agaplan/agaplan-addons/7.0/files/head:/sale_double_validation/)

希望能帮助到你

# javascript - 在 Javascript 变量声明中使用逻辑与

> ID：14968152
> 
> 赞同：5
> 
> 时间：2013-02-19T21:50:54.010
> 
> 标签：javascript

我对使用`&&`这样的声明变量的实际应用感兴趣：

```
var x = undefined && 4;

// Evaluate to the first falsey value
// or else the last value.

eval(x);
// undefined 
```

我了解如何评估价值（请参阅[此 SO answer](https://stackoverflow.com/a/7602012/1351736)）。我也了解它的姐妹`||`（请参阅[此处](https://stackoverflow.com/a/476445/1351736)以获取详细说明）以及为什么使用以下表达式声明变量会很有用：

```
// Some other variable
var y;

var x = y || 4;

// Evaluate to the first truthy value
// or else the last value. 
```

实际上：使用第一个值，除非第一个值是错误的；如果是这样，请使用最后一个值。我们可以`||`在浏览器控制台中演示这个特性：

```
> null || 4
  4
> 4 || null
  4

> null || undefined
  undefined
> undefined || null
  null

> true || 4
  true
> 4 || true
  4 
```

至于`&&`：

```
> null && 4
  null
> 4 && null
  null

> null && undefined
  null
> undefined && null
  undefined

> true && 4
  4
> 4 && true
  true 
```

我们是否应该理解为：使用第一个值，除非第一个值是真实的；如果是这样，使用最后一个值？

我对使用编码快捷方式来尽量减少条件语句的使用很感兴趣，我想知道我是否能够以某种方式使用它。

我在 jQuery 核心源代码的[第 472 行](https://github.com/jquery/jquery/blob/451d0c37d9297598743b1372bf623d4b7d38e951/src/core.js#L472)找到了这种编码方法的示例：

```
scripts = !keepScripts && []; 
```

所以问题是这样的：任何人都可以描述一个`&&`在 javascript 变量声明中使用的好的上下文吗？你认为这是不好的做法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T21:59:34.557

一般来说，你应该只使用这样的“快捷方式”，如果它使典型的 JavaScript 程序员的代码比替代方案*更*易读。

在考虑什么更具可读性且不那么令人惊讶时，请考虑

```
var foo;
if(bar) {
    foo=[];
} 
```

和

```
var foo = bar && []; 
```

不一样。例如， if `bar`is `NaN`， then`foo`将`NaN`在后一种情况下，这在以后可能有点令人头疼。

由于有优化/最小化 JavaScript 的工具，因此您应该关注代码的可读性，这与简洁并不总是一回事。

假设您连续有几个这样的重复初始化，所有这些都依赖于不同的变量（因此它们不能被包装到单个条件中），但遵循相同的逻辑公式。在这种情况下，一旦读者在精神上解析了公式的含义，他们就可以快速浏览所有实例并查看每个实例之间的差异。在这种情况下，您将创建一个本地化的约定，而不是依赖于大多数 JavaScript 程序员都熟悉的约定（例如`var foo = some_opt || {}`），读者将不得不为这个文件学习。即使在这种情况下，我也建议仔细考虑，这可能不值得。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-05T05:19:35.867

`&&`我发现在调试过程中使用它可能很有用的一种特定情况。

假设我们有一个变量`x`。有时`x`有一个值`null`，有时`x`是一个有值的对象`{'foo':'bar'}`。我们想编写一个表达式，返回`x.foo`如果它存在的值。

但是，我们必须小心。调用不存在的对象的属性可能会导致：

```
> Uncaught TypeError: Cannot read property 'foo' of null 
```

所以我们可以这样写：

```
x && x.foo 
```

执行以下操作：

1.  如果`x`是一个对象并且`x.foo`存在，给我们 的值`x.foo`。

2.  如果`x`是一个对象并且`x.foo`不存在，则返回`undefined`。

3.  如果`x`为空，则返回`null`。

只要在`x`某处提到过（即使`x`只是简单地设置为 null 或未定义），表达式就不应破坏代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:57:00.793

实际上，您不应该像 Jquery 那样经常使用 && 运算符，因为它总是有风险的代码。由于这种用法，您可能会忘记您所做的事情，或者您可能找不到错误。我个人认为这是一种不好的做法。您可能更喜欢使用，但代码变得不可读。我们，开发人员应该考虑代码的可理解性和可读性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T22:03:13.400

好吧，这是一个常见的习惯用法，但它可能会降低您的代码的可读性。所以，我的建议是保持简单，即使这意味着更多的击键。

# php - PHP Mysqli 类扩展

> ID：14968157
> 
> 赞同：2
> 
> 时间：2013-02-19T21:51:09.950
> 
> 标签：php, mysqli, extends

**问题已解决。UserControl 函数关闭数据库连接。谢谢**

当我厌倦了`real_escape_string()`功能时，出现了问题

> 致命错误：在...中的非对象上调用成员函数 real_escape_string()

Sql类：

```
class Sql {

    protected $mysqli = '';
    private $table = '';
    private $where = '';
    private $limit = '';
    private $orderby = '';
    private $data = '';
    private $columns = '';

    function __construct(){
        try{
            if(!$this->mysqli){
                $this->mysqli = new mysqli(VTConnectIP, VTConnectRoot, VTConnectPass, VTConnectDB)
                                                                        or die(mysqli_connect_error());
                $this->tr_fix_db();
            }
            return;
        }catch(Exception $ex){
            echo $ex->getMessage(); 
        }   
    } 
```

扩展类：

```
class LoginClass extends Sql
{
    private $username;
    private $password;
    private $email;
    private $errors = array();

    public function __construct(){
        parent::__construct();
    }

    public function username($data){
        $this->UserControl($data);
        $this->username = $this->mysqli->real_escape_string($data); // Error Code
        return $this;
    } 
```

# html - 如何在html页面上将变量传递给表单

> ID：14968162
> 
> 赞同：0
> 
> 时间：2013-02-19T21:51:24.850
> 
> 标签：html, forms

我确定我在这里遗漏了一些基本的东西，但我就是无法理解它..

如果我登陆一个 url，即 domain.com?key=123 并且 domain.com 上有一个表单，其中有一个名为 key 的字段。我认为它会自己用值 123 填充该字段，因为它已被传递。我在这里错过了什么吗？...

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:02:22.590

如果您想要一个包含 URL 参数的表单字段，请执行以下操作：

**PHP**

```
<label>Key:</label>
<input type="text" value="<?php echo $_GET["key"]; ?>"> 
```

**冷融合**

```
<label>Key:</label>
<input type="text" value="<cfoutput>#URL.key#</cfoutput>"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:57:54.540

您需要将 GET 数组中的值打印到输入元素的 value 属性中。（即，如果您使用的是 php 使用`<input name="key" value="<?php echo $_GET["key"]; ?>" />`）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T22:20:04.757

您在浏览器地址栏中看到的是一个 HTTP URL，它只是表示正在发出的 HTTP 请求。要查看完整的 HTTP 请求 - 使用 Chrome - 开发人员工具。（HTTP 请求/响应/正文/Cookie）

您的 HTML 页面由您向其发送 HTTP 请求的服务器构成。该 HTML 页面在 HTTP 响应正文中发送回浏览器。您的浏览器具有运行“仅解析/呈现 HTTP 响应中的 HTML”的布局 (HTML) 引擎。

引擎将 - 解析以检查任何 HTML 不一致，构建 DOM 树，加载脚本/图像/css

纯粹是您，只有您自己决定如何使用这些数据。这些数据既可以由 JavaScript 使用，也可以由 JSP 等服务器端代码使用。

其他用户已经向您建议了如何实现这一点，例如运行一些脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T21:53:38.143

您使用什么语言？通常，您以问号开头...

```
domain.com/?key=123 
```

如果您有其他变量，则使用＆符号。

```
domain.com/?key=123&anotherKey=456&lastKey=789 
```

更新：这是使用 Javascript 解析查询字符串的链接： [如何在 JavaScript 中获取查询字符串值？](https://stackoverflow.com/questions/901115/how-can-i-get-query-string-values)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-19T21:55:42.307

网站管理员可能决定在 html 表单中传递变量，但也可能并非如此。大多数情况下，GET 请求用于将数据从表单发送到 php 脚本，但很少看到使用 php 脚本编译的 html 表单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-19T22:07:05.490

该页面上发生了其他事情 - 您填写表格，然后发布时，服务器获取您的变量 KEY 以用于作者认为合适的任何页面。这是另一回事，您是否会在发布后重新加载表单时在表单上看到此变量

# php - PHP - 哪个类调用了我的静态方法？

> ID：14968166
> 
> 赞同：0
> 
> 时间：2013-02-19T21:51:44.677
> 
> 标签：php, methods, static

我需要知道哪种调用静态方法，而不作为参数发送

```
class foo
{
    public static function test($clase)
    {
        echo "Class invoke:" . FUNCTION();
    }
}

class A { public function x { foo::test(); } }
class B { public function y { foo::test(); } }
class C { public function z { foo::test(); } } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:01:21.607

你可以使用后期静态绑定和[`get_called_class()`](http://php.net/get_called_class)(PHP >= 5.3) 如果你让你的所有类都 extend `foo`，像这样：

```
class foo
{
    public static function test($clase)
    {
        echo "Class invoke:" . get_called_class();
    }
}

class A extends foo { public function x() { self::test(''); } }
class B extends foo { public function y() { self::test(''); } }
class C extends foo { public function z() { self::test(''); } } 
```

使用这些对象：

```
$a = new A; $a->x();
$b = new B; $b->y();
$c = new C; $c->z(); 
```

你会[得到输出](http://viper-7.com/4aszOv)：

```
Class invoke:A
Class invoke:B
Class invoke:C 
```

# cordova - Phonegap 条码扫描器更快

> ID：14968169
> 
> 赞同：4
> 
> 时间：2013-02-19T21:51:52.500
> 
> 标签：cordova, barcode

这是我的代码（它工作正常）：

```
document.addEventListener('deviceready', myDeviceReady, false);
function myDeviceReady() {
    $('#Print').append('Device is ready');
    function Scan() {
        try {
            $('#Print').append('Scanning')
            window.plugins.barcodeScanner.scan(mySuccess,myError);
        } catch (myCatch) {
            $('#Print').append('catch: ' + myCatch)
            Scan();
        }   
    }
    function mySuccess(result) {
        if (result.cancelled) {
            $('#Print').append('The user cancelled the scan.')
        } else {
            $('#Print').append(result.text);
            $('#Print').append(result.format);
        }
        Scan();
    }

    function myError(error) {
        $('#Print').append('Scanning failed: ' + error);
        Scan();
    }
    Scan();
} 
```

问：有什么方法可以更快地轮询扫描仪？每次扫描都需要几秒钟，我的用户需要扫描大量条码。

他们过去常常用楔子扫描笔记本电脑，但现在他们想使用 iPad。

编辑：

也许我正在寻找的是第 3 方解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T16:35:59.960

除非您的 HTML 很大（通过 $('#Print') 获取 DOM 节点可能需要一些时间），或者您正在运行应用程序很长时间（在这种情况下 .append 可能会变慢，因为它是从未清除），您的 JavaScript 代码没有任何问题。事实上，我假设延迟来自您的条形码插件，而不是您的 JavaScript 处理程序。

在做任何其他事情之前，您应该检查我的假设是否正确，并且延迟实际上发生在您的 .barcodeScanner.scan() 调用和 mySuccess()/myFailure() 函数之间。

PhoneGap 似乎正在使用 ZXing（[“斑马线”](http://code.google.com/p/zxing/)），这是一个既定标准。如果这还不够快，您可能想尝试其他库：

*   [VisionSmarts VSbarcodeReader](http://www.visionsmarts.com/products/vs-barcode-reader.html)
*   [ZBar SDK](http://zbar.sourceforge.net/iphone/sdkdoc/)
*   [ShopSavvy 条码 SDK](http://shopsavvy.mobi/developers/)

但可能是移动相机的自动对焦速度不足以满足您的要求，您需要基于激光的硬件。[此链接](http://www.iphonelife.com/issues/2012January-February/BarcodeScanning)有许多与硬件接口的产品。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-07-26T20:19:23.200

如果您在cordova中使用官方插件[http://ngcordova.com/docs/plugins/barcodeScanner/](http://ngcordova.com/docs/plugins/barcodeScanner/)

你可以让它在 iOS 上更快，

在您的 XCode 项目中，转到 plugins 文件夹，然后打开 CDVBarcodeScanner.mm

改变这一行：

```
captureSession.sessionPreset = AVCaptureSessionPresetHigh; 
```

为了：

```
captureSession.sessionPreset = AVCaptureSessionPresetMedium; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T17:45:54.090

在之前的工作中，我曾在条形码扫描仪制造商[CipherLab工作。](http://us.cipherlab.com/catalog.asp)

## 关于条码扫描仪

首先，您需要澄清不是扫描仪本身很慢，而是读取它的应用程序。扫描仪性能本身在某种程度上是价格的函数。如果你有一个便宜的扫描仪，它可能会更慢，把钱花在一个好的扫描仪上会提高性能和适应性（读取损坏/弄脏/脏条码的能力）。仅供参考，大多数移动扫描仪没有@Hazzit 建议的“自动对焦”，但有一个针对特定距离范围优化的固定预对焦镜头。如果它是成像扫描仪（不是激光），则将扫描仪对准条形码，然后将其拉回，直到扫描仪读取。如果最终用户正在扫描大量条码，他们将很快记住“最佳位置”。

## 关于你的 JS 代码

扫描仪插件似乎正在同步执行（阻止 JS 直到它获得条形码）。该库中是否还有另一个功能可以异步使用扫描仪？如果没有，请考虑查看其他 SDK，看看是否有其他人允许异步使用条形码扫描仪。

可能有点小，但我会尝试将您的 DOM 操作 JS 与扫描仪代码分开。DOM 操作可能会很慢，具体取决于 DOM 结构、您的选择器和您在做什么。

如果您可以获得对扫描仪的异步访问，您可能能够解耦这些并在“可能的情况下”进行所有 DOM 操作，如果扫描仪在等待下一个条形码时没有阻塞（基本上是在您启动扫描仪接受后 UI 更新下一个条形码）。

## 关于键盘楔形扫描

现在，键盘楔形扫描仪显然输入数据的速度与打字一样快*，无论应用程序是否已为它们做好准备或是否可以跟上击键*。这将很快，但缺乏应用程序级别的控制。

您可以将蓝牙条码扫描仪用作 HID 设备（在现代技术中基本上是“键盘楔”），它的工作原理与上述完全一样。速度快，但仍缺乏对硬件的应用级控制。

当然，这些蓝牙库中的许多还支持 SPP 串行端口蓝牙配置文件，这为您提供了应用程序级别的控制。您可以发送扫描仪命令/配置，然后读回扫描的数据。

这就是您的 SDK 工具发挥作用的地方。它们只是读取/写入蓝牙串行端口（扫描仪）以轮询扫描的条形码。这可能非常快，但取决于 SDK 的质量。我不是 iOS 程序员，对那个特定平台一无所知，但我知道在 Windows 中它们是访问串行端口的高级方法和性能更高的低级方法。

不管怎样，如果你愿意，你仍然可以选择回到键盘楔形的做事方式！只是想我会指出这一点。

同样在此键盘楔形模式中，通常会在扫描仪数据前加上快捷键。大多数扫描仪可以在扫描数据的开头或结尾插入一些额外的击键。例如，您可以将扫描仪配置为键入`F3+{barcode data}+Enter`并让您的页面监视该快捷方式，将焦点移动到正确的输入框，然后接受数据。

## 如果一切都失败了

如果所有其他方法都失败了，并且您无法获得所需的性能……唯一的方法是为 iOS 编写本机应用程序。虽然高级工具很棒，但无论如何（对于硬件访问或 UI 性能），您永远无法完全获得本机应用程序的性能。

# android - android.database.sqlite.SQLiteException：表 MyMovies 没有名为 _ReleaseDate 的列

> ID：14968171
> 
> 赞同：0
> 
> 时间：2013-02-19T21:51:58.787
> 
> 标签：android, database, sqlite, android-sqlite

我的数据库中有这张表

```
 public static final String TABLE_MOVIES_NAME = "MyMovies";
  public static final String TABLE_MOVIES_COLUMN_ID = "_Id";
  public static final String TABLE_MOVIES_COLUMN_NAME = "_Name";
  public static final String TABLE_MOVIES_COLUMN_DATE_ADDED = "_AddedDate";
  public static final String TABLE_MOVIES_COLUMN_DATE_RELEASE = "_ReleaseDate";
  public static final String TABLE_MOVIES_COLUMN_DESCRIPTION = "_Description";

  private static final String DATABASE_NAME = "????.db";
  private static final int DATABASE_VERSION = 1;

  public static final String DATABASE_CREATE = "create table "
      + TABLE_MOVIES_NAME + "("
      + TABLE_MOVIES_COLUMN_DATE_RELEASE + "text not null, "
      + TABLE_MOVIES_COLUMN_ID + " integer primary key, "
      + TABLE_MOVIES_COLUMN_NAME + " text not null, "
      + TABLE_MOVIES_COLUMN_DATE_ADDED + " text not null, "
      + TABLE_MOVIES_COLUMN_DESCRIPTION + " text not null);"; 
```

我尝试在其中添加一些值（电影）`ContentValues values = _ReleaseDate=2013-06-18 _Id=0 _Name=a _AddedDate=2013-02-18 _Description=asfsgagafgadf`

当我插入时`database.insertOrThrow(SQLiteHelper.TABLE_MOVIES_NAME, null, values);`
我得到这个错误`android.database.sqlite.SQLiteException: table MyMovies has no column named _ReleaseDate (code 1): , while compiling: INSERT INTO MyMovies(_ReleaseDate,_Id,_Name,_AddedDate,_Description) VALUES (?,?,?,?,?)` 我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:53:54.457

改变：

```
public static final String DATABASE_CREATE = "create table "
      + TABLE_MOVIES_NAME + "("
      + TABLE_MOVIES_COLUMN_DATE_RELEASE + "text not null, "
      + TABLE_MOVIES_COLUMN_ID + " integer primary key, "
      + TABLE_MOVIES_COLUMN_NAME + " text not null, "
      + TABLE_MOVIES_COLUMN_DATE_ADDED + " text not null, "
      + TABLE_MOVIES_COLUMN_DESCRIPTION + " text not null);"; 
```

到：

```
public static final String DATABASE_CREATE = "create table "
      + TABLE_MOVIES_NAME + "("
      + TABLE_MOVIES_COLUMN_DATE_RELEASE + " text not null, "//Space added here.
      + TABLE_MOVIES_COLUMN_ID + " integer primary key, "
      + TABLE_MOVIES_COLUMN_NAME + " text not null, "
      + TABLE_MOVIES_COLUMN_DATE_ADDED + " text not null, "
      + TABLE_MOVIES_COLUMN_DESCRIPTION + " text not null);"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:55:04.847

在此处添加空格：

```
 + TABLE_MOVIES_COLUMN_DATE_RELEASE + " text not null, "  // space before 'text' 
```

# vb.net - 如何在 Visual basic 2010 中压缩和提取 JAR 文件？

> ID：14968173
> 
> 赞同：0
> 
> 时间：2013-02-19T21:52:04.433
> 
> 标签：vb.net, visual-studio-2010, compression

您好，我有一个简短的问题如何使用 Visual Basic 2010 提取 JAR 文件以及如何压缩文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T01:12:28.050

JAR 文件是 java 文件，因此您无法使用 Visual Basic 编辑、提取或编译 jar 文件。Visual Basic 用于制作 .exe 文件。对于编辑 Jar 文件，您可以使用 Eclipse 或其他工具。对于提取或编译，只需将文件扩展名更改为 .zip 并返回 .jar ;)

Een JAR bestand 是 een java bestand，dus kan je niet niet veranderen 在 Visual Basic 中，Visual Basic 是 namelijk bedoeld om .exe bestanden te maken。Wat je wel kunt doen 是 een ander 编辑程序 Eclipse 中的 een .jar bestand veranderen。Om hem te "compilen" of te "extracten", gewoon de extensie veranderen van .jar naar .zip en weer terug ;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T00:31:45.710

我自己找到了答案，并将其发布在：

[http://www.codeproject.com/Answers/549144/Howplusdoplusipluscompressplusandplusextractplusap#answer2](http://www.codeproject.com/Answers/549144/Howplusdoplusipluscompressplusandplusextractplusap#answer2)

如果您有同样的问题，那么您绝对应该查看该答案。不管怎么说，还是要谢谢你。

# firebird - Firebird 2.5.1 列出服务器正在使用的数据库（超级服务器模式）

> ID：14968187
> 
> 赞同：3
> 
> 时间：2013-02-19T21:52:57.797
> 
> 标签：firebird, server-administration

我想编写一个 C++ 管理应用程序来简化我负责的数据库的管理。目前，当我想知道是否有用户连接到由 2 个不同实例操作的多个 Firebird 数据库时，我必须连接到每个数据库并检查。没关系，但我不想注册每个正在创建的新数据库，而我不看，我想要一些方法来列出当前打开或服务器正在使用的数据库。我能想到的这个功能的当前两种用途是：

1.  自动包含在备份过程中
2.  应用程序更新，要求用户注销（一看，我就能知道要踢谁，或者至少要打电话给哪个部门）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T10:16:16.810

Firebird 没有列出所有可用数据库的 API。从技术上讲，Firebird 根本不知道数据库的存在，直到您实际连接到它。

您可能能够使用 Trace API 或监控表找到所有正在连接的数据库，但这并不排除您的系统上存在其他数据库的可能性。

# c# - C++/C# Python 钩子

> ID：14968190
> 
> 赞同：4
> 
> 时间：2013-02-19T21:53:00.343
> 
> 标签：c#, c++, python, hook, code-injection

我已经搜索了好和 Stack Overflow，但找不到我正在寻找的答案。有没有办法从 C++/C# 中挂钩 Python 函数的调用？捕获函数调用及其参数？

用一个例子编辑：

def a(pOne): //做事

def b(): a("a")

因此，在调用“a”时，我希望 C++ 挂钩该函数（假设函数名称已知）并在调用“a”时执行 C++ 函数/事件，并将传递给 C++ 函数/事件的参数作为值'pOne' 传入的内容。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:10:58.363

C++ 有几个不同的选项，具体取决于您想要做什么。

做你想做的最好的方法是“扩展”Python。

我最喜欢的方法是[Boost.Python](http://www.boost.org/doc/libs/release/libs/python/)

您也可以使用原始[C-API](http://docs.python.org/2/extending/)，但我不推荐这样做。

有关使用 Boost.Python 进行嵌入和扩展的一些示例，您可以查看我一直在从事的[这个项目。](https://github.com/anhstudios/swganh/tree/develop/src/swganh/scripting)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:48:22.330

如果您只想编写一些 C++ 代码并使其可从 Python 调用，您可以通过[扩展和嵌入 Python 解释器](http://docs.python.org/2/extending/index.html#extending-index)来实现。（其实只是Extending；忽略另一半。）

基本上，如果您编写一个新模块`foo`，任何人都可以`import foo`调用`foo.a("a")`，无论模块`foo`是作为 Python 文件实现`foo.py`还是编译`foo.cpp`为动态库都无关紧要`foo.so`。

为此，正如 Kyle C 所建议的那样，有许多高级方法可以做到这一点，因此您无需直接处理 C API。（除了他对 Boost.Python 的建议之外，我还建议您查看[`Cython`](http://www.cython.org)，它可以让您使用几乎是 Python 的语言编写代码，该语言可以直接与您的 C++ 对话，同时也可以直接向 Python 公开内容。）

然而，这不是你所要求的。您想要做的是获取一些在 Python 代码中定义的函数，并将其挂钩以执行不同的操作。为此，您确实需要阅读上面链接的扩展和嵌入文档。你将不得不编写一个嵌入式解释器，重现一些行为（具体多少取决于你想在哪里钩住它），并确保在任何地方`PyObject_Call`或类似的函数被调用，它首先检查是否该对象是`a`函数，如果是，则调用您的钩子代码。

这将非常困难。如果您还没有编写嵌入式 Python 解释器，请在考虑如何钩住它之前就这样做。

值得注意的是，从 Python 内部进行挂钩可能比从解释器外部进行挂钩要容易得多。（如果你从来没有听说过“monkeypatching”，去谷歌搜索一下。）你总是可以从你用 C++ 构建的模块制作你的 Python 钩子调用代码，甚至可以通过 .so 直接调用编译的 .so 文件`ctypes`。

* * *

最后，如果你想在运行时挂钩一些正在运行的解释器实例，那就更难了。您显然需要能够进行某种调试/跟踪/等。附加和代码插入，其细节完全取决于您的平台。然后，你会想要做你在以前的硬版本中所做的同样的事情，除了你必须通过拦截调用来做到这一点，例如，`PyObject_Call`（来自`libpython.so`/// whatever `Python.dll`）`Python.framework`首先通过你的钩子. 如果您还不知道如何在您的平台上挂钩 SO 调用，那么您需要先了解这一点，然后才能考虑从外部挂钩 Python 代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-23T09:43:34.507

你有理由不改变 in-python 代码吗？如果没有，为什么不[为你的 dll编写一个扩展模块或一个 python](http://python.net/crew/theller/ctypes/tutorial.html) [ctypes](https://docs.python.org/2/library/ctypes.html)调用，并用一个调用你的钩子的装饰器包装呢？`a`

```
import my_cpp_module
def hook_a_to_call_my_cpp_module(orig_a):
    def replacement_a(pOne):
        try:
            my_cpp_module.my_cpp_function(pOne)
        finally:
            return orig_a(pOne)
    # 
    return replacement_a

@hook_a_to_call_my_cpp_module
def a(pOne):
    pass 
```

您甚至可以在不接触具有 的源文件的情况下执行此操作`a`，如下所示：

```
# in this other file you import the module that contains function a
import the_py_that_has_a

# next line just to avoid copy-pasting the above code from my answer here again
from the_decorator_from_the_previous_example import hook_a_to_call_my_cpp_module

the_py_that_has_a.a = hook_a_to_call_my_cpp_module(the_py_that_has_a.a) 
```

如果你有一些理由*根本不*改变你的 py 代码*，*你能在评论中说明它们吗？

# tsql - 使用用户定义的日期类型时，tSQLt FakeTable 失败

> ID：14968195
> 
> 赞同：0
> 
> 时间：2013-02-19T21:53:11.467
> 
> 标签：tsql, tsqlt

当我尝试伪造使用用户定义的数据类型的表时，出现以下错误。

COLLATE 子句不能用于用户定义的数据类型。{,1}

看起来这是 tSQLt 中的一个已知问题。

[https://groups.google.com/forum/?fromgroups#!topic/tsqlt/AS-Eqy6BjlA](https://groups.google.com/forum/?fromgroups#!topic/tsqlt/AS-Eqy6BjlA)

除了更改表定义之外，是否有解决方法？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-03T14:14:33.757

感谢 Chris Francisco，现在有一个补丁：

> 仅供参考，我遇到了同样的问题，并且能够通过深入研究 tSQLt 代码来解决它。有一个名为 Private_GetFullTypeName 的函数
> 
> 函数返回的最后一列名为“Collat​​ion”，如果变量 @Collat​​ionName 为空，则返回空字符串 ''。如果您将“OR is_user_defined = 1”添加到空字符串的条件中，我就能够伪造具有用户定义数据类型的表。
> 
> 我没有遇到这种改变带来的任何奇怪的副作用，但我不是 tSQLt（或一般的 tSQLt）内部工作的专家，所以这可能会破坏其他地方的功能。

换句话说：

```
 CASE WHEN @CollationName IS NULL OR is_user_defined = 1 THEN ''
               ELSE ' COLLATE ' + @CollationName 
```

# javascript - 从 jQuery 滑块控件中获取淘汰计算的 observables

> ID：14968196
> 
> 赞同：0
> 
> 时间：2013-02-19T21:53:14.573
> 
> 标签：javascript, knockout.js

我有一个用于 jQuery 滑块控件的自定义剔除活页夹。滑块正在更新 currentPage 可观察对象，但依赖于 currentPage() 的通用 ko.computed 永远不会触发。 **为什么会这样以及如何修复它以便触发泛型？**

我在这里找到了使用带有淘汰赛的异步 ajax 调用的这种技术... [Asynchronous Dependent Observables](https://github.com/SteveSanderson/knockout/wiki/Asynchronous-Dependent-Observables)。显然`dependentObservable`已被`computed`. 我能够让它与`dependentObservable`或 一起工作`computed.deferEvaluation=false`，但我需要`deferEvaluation=true`这样 ajax 调用不会被多次触发。

**小提琴** [http://jsfiddle.net/jeljeljel/3WN6v/](http://jsfiddle.net/jeljeljel/3WN6v/)

**HTML**

```
<div style="margin:10px;" data-bind="slider: currentPage, sliderOptions: {min: 0, max: 10, range: 'min'}"></div>

<div id="plugin" data-bind="template: { name: 'template1', data: $data }" ></div>

<script type="text/html" id="template1">
        <span data-bind="text: displayText"></span>
</script> 
```

**Javascript**

```
// create ko custom binding handler for slider control
ko.bindingHandlers.slider = {
    init: function (element, valueAccessor, allBindingsAccessor) {
        var options = ko.toJS(allBindingsAccessor().sliderOptions) || {};
        $(element).slider(options);
        ko.utils.domNodeDisposal.addDisposeCallback(element, function () {
            $(element).slider('destroy');
        });
        ko.utils.registerEventHandler(element, 'slidechange', function (event, ui) {
            var observable = valueAccessor();
            observable(ui.value);
        });
    }
};

function DataModel() {
    var self = this;
    self.currentPage = ko.observable(0);
    self.displayText = ko.observable(0);

    ko.computed({
        read: function () {
            $.ajax({
                url: '/echo/json/',
                //data: { page: currentPage() },
                success: function(){
                    self.displayText(currentPage());
                }
            });
        },
        deferEvaluation: true
    });
}

dataModel = new DataModel();
ko.applyBindings(dataModel); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T08:49:00.833

您实际上并没有在滑块更改事件中更新 displayText，因为您发送到绑定事件的 valueAccessor 是您绑定到滑块的属性，即 currentPage。更改自定义绑定的签名以包含 viewModel，然后使用它来更新 displayText 的值：

```
// create ko custom binding handler for slider control
ko.bindingHandlers.slider = {
    init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var options = ko.toJS(allBindingsAccessor().sliderOptions) || {};
        $(element).slider(options);
        ko.utils.domNodeDisposal.addDisposeCallback(element, function () {
            $(element).slider('destroy');
        });
        ko.utils.registerEventHandler(element, 'slidechange', function (event, ui) {
            viewModel.displayText(ui.value);
        });
    }
}; 
```

# c# - 如何取消选择所有 MenuStripItems？

> ID：14968198
> 
> 赞同：2
> 
> 时间：2013-02-19T21:53:16.923
> 
> 标签：c#, winforms

我正在尝试在我的菜单条中制作某种选择器/最后一个检测器。基本上我在一个菜单条项目下有一堆“子项目”。我想检查所有这些，取消选中它们，然后只检查被点击的那个。

![在此处输入图像描述](../Images/b4d61823de5d0754e0ca1454f881284a.png)

本质上，我想取消选中所有以 de_ 开头的东西（以及最后一个，所以全部）

编辑：让它工作，这是我最终使用的代码

```
private void ItemClick(object sender, EventArgs e)
{
  foreach (ToolStripMenuItem item in mapsToolStripMenuItem.DropDownItems)
  {
    item.Checked = false;
  }
  ((ToolStripMenuItem)sender).Checked = true;
} 
```

但我不确定用什么来代替它？以寻找正确的地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:03:37.027

尝试使用父菜单的 DropDownItems 集合：

```
foreach (ToolStripMenuItem item in mapStripMenuItem.DropDownItems ) {
  item.Checked = false;
} 
```

从你的图像来看，它应该被命名为 Map-something，我猜。

# playframework-2.1 - 输入PlayReloader所需的play.Project.jdbc类文件时播放2.1错误异常丢失

> ID：14968209
> 
> 赞同：1
> 
> 时间：2013-02-19T21:54:00.510
> 
> 标签：playframework-2.1

运行、清洁或播放时出现问题，启动 play2.1 应用程序。我可以创建应用程序，但是如果我尝试运行、清理、播放或启动。我得到这个错误

键入 PlayReloader 所需的 play.Project.jdbc 类文件时出现异常。

任何想法将不胜感激..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T02:38:21.630

原来是权限问题。该应用程序已失去其可执行权限。不知道它是怎么发生的

# nhibernate - NHibernate No-Proxy Lazy Load 防止集合被加载

> ID：14968210
> 
> 赞同：2
> 
> 时间：2013-02-19T21:54:04.030
> 
> 标签：nhibernate, lazy-loading

我有一个类层次结构，我使用每个类层次结构的表进行了映射：

```
 AbstractClass
                     |
        -----------------------------
        |                           |
   ConcreteClassA             ConcreteClassB 
```

AbstractClass 有一个名为“Status”的“Status”类型的属性，并且有一个“Widgets”的散列集。

如果我将“状态”引用的惰性设置为“无代理”，则当我尝试访问它时不会加载我的“小部件”集合。此外，具体的子类将被代理。

如果“状态”引用的惰性设置为“代理”，我的“小部件”集合将按预期延迟加载。

为什么在多对一引用上设置“无代理”会影响我的集合延迟加载的方式？我正在使用 NHibernate 3.3.2 GA 和 Fluent NHibernate。数据库是 iSeries DB2，如果这有什么不同的话。

# html - 嵌入标签的 mouseleave 事件

> ID：14968213
> 
> 赞同：2
> 
> 时间：2013-02-19T21:54:08.717
> 
> 标签：html, mouseover, mouseleave

我将a`mouseover`和`mouseleave`事件绑定到`#container`div，html如下：

```
<div id="container">
<a href="#">test</a>
<div class="zclip" id="zclip-ZeroClipboardMovie_2" style="width: 110px; height: 31px;     left: 75px; top: 85px;"><embed width="110" height="31" align="middle" wmode="transparent" flashvars="id=2&amp;width=110&amp;height=31" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" allowfullscreen="false" allowscriptaccess="always" name="ZeroClipboardMovie_2" bgcolor="#ffffff" quality="best" menu="false" loop="false" src="/static/js/zclip/ZeroClipboard.swf" id="ZeroClipboardMovie_2">    
</div>
</div> 
```

问题是，每次我的鼠标进入`.zclip`div然后离开时，即使我的鼠标还在容器中，也会触发div的`mouseleave`事件。`#container`里面的锚标签没有这样的问题`#container`。不知道是不是和div`embed`里面的元素有关系。`.zclip`有人可以给我一些想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:59:05.153

只需`event.stopPropagation()`在您的`mouseleave`事件处理程序中使用

[.stopPropagation()](http://api.jquery.com/event.stopPropagation/)

# java - 如何在Java中使用正则表达式查找带点的单词？

> ID：14968214
> 
> 赞同：5
> 
> 时间：2013-02-19T21:54:09.120
> 
> 标签：java, regex

我是 Java 新手。我想在文本文件中搜索一个字符串。假设文件包含：

> 你好，我正在学习Java。

我正在使用下面的模式来搜索每个确切的单词。

```
Pattern p = Pattern.compile("\\b"+search string+"\\b", Pattern.CASE_INSENSITIVE); 
```

它工作正常，但找不到“java”。如何找到这两种模式。即带有边界符号和“。” 在字符串的末尾。有人对我如何解决这个问题有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T22:01:33.077

您应该解析您的*搜索字符串*，以便将点更改`.`为 RegEx 点：`\\.`。请注意，[单个点是正则表达式中的元字符，](http://www.regular-expressions.info/dot.html)表示任何字符。例如，您可以将字符串中的所有点替换为`\\.`

如果您不想做所有这些工作，那么只需发送`java\\.`您的*搜索字符串*

更多信息：

*   [在 Java 中使用正则表达式](http://www.regular-expressions.info/java.html)
*   [Java 正则表达式教程](http://www.vogella.com/articles/JavaRegularExpressions/article.html)
*   [Java 正则表达式](http://docs.oracle.com/javase/tutorial/essential/regex/)

代码示例：

```
public static void main(String[] args) {
    String fileContent = "Hi i am learning java.";
    String searchString = "java";
    Pattern p = Pattern.compile(searchString);
    Matcher m = p.matcher(fileContent );
    while(m.find()) {
        System.out.println(m.start() + " " + m.group());
    }
} 
```

它会打印：`17 java`

```
public static void main(String[] args) {
    String fileContent = "Hi i am learning java.";
    String searchString = "java\\.";
    Pattern p = Pattern.compile(searchString);
    Matcher m = p.matcher(fileContent );
    while(m.find()) {
        System.out.println(m.start() + " " + m.group());
    }
} 
```

它会打印：（`17 java.`注意最后的点）

编辑：作为一个非常基本的解决方案，因为您唯一的问题是点，您可以将字符串中的所有点替换为`\\.`

```
public static void main(String[] args) {
    String fileContent = "Hi i am learning java.";
    String searchString = "java.";
    //this will do the trick even if the "searchString" doesn't contain a dot inside
    searchString = searchString.replaceAll("\\.", "\\.");
    Pattern p = Pattern.compile(searchString);
    Matcher m = p.matcher(fileContent );
    while(m.find()) {
        System.out.println(m.start() + " " + m.group());
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T00:10:56.097

```
"\\b" + searchstring + "(?:\\.|\\b)" 
```

如果您想规定点后面必须跟一个非单词字符或字符串的结尾，您可以添加一个肯定的前瞻

```
"\\b" + searchstring + "(?:\\.(?=\\W|$)|\\b)" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T12:22:56.253

```
Pattern p = Pattern.compile(".*\\W*" + searchWord + "\\W*.*", Pattern.CASE_INSENSITIVE); 
```

可以肯定的是，上面说“给我找一段以 0 个或多个字符开头的文本，后跟 0 个或多个非单词字符，特别是（\W* - 单词边界），然后是搜索词，然后是下一个单词边界，然后是其他任何内容”。

这将迎合搜索词位于文件开头、结尾或标点之间的情况，例如：“hi,I am learning,java.”。

希望这可以帮助...

# ruby-on-rails - 作为另一个对象的一部分的模型/控制器的 Ruby on Rails 命名约定是什么？

> ID：14968217
> 
> 赞同：0
> 
> 时间：2013-02-19T21:54:23.277
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我不确定 Ruby on Rails 中与对象相关/对象的一部分的命名约定。下面是一个例子：

我有一个`User`对象

我有一个单独的`Image`模型，只存储`User`对象的图像

我还有一个单独的`History`模型，它只存储`User`

是否会遵循 Rails 约定将它们命名为`UserImage`和`UserHistory`模型？还是这不符合惯例？如果是这样，为什么不呢？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:03:46.583

它通常取决于您的应用程序中使用的其他名称，并且在某种程度上取决于个人喜好。

我的偏好是不添加命名空间前缀，除非由于命名空间冲突而确实有必要，或者因为我的应用程序具有类似命名的结构而令人困惑。此外，使用后缀来防止与不同区域中的类发生命名冲突更像是一种 Rails 约定。例如控制器都以 为后缀`Controller`，邮件以 为后缀`Mailer`，装饰器以`Decorator`等为后缀。

在你的情况下，我会坚持使用用户、图像和历史。为图像和历史添加前缀并不能真正为您带来任何好处，除非您有其他类型的图像/历史模型，在这种情况下，最好查看多态关系而不是命名空间前缀。

这主要是样式和可维护性的问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-20T05:05:46.737

如果您以这种方式命名模型，那么您将无法在模型之间建立关联。前任。UserImage 模型将被视为单个实体，而不是用户和图像模型的关联。如果要开发这种类型的关联，请使用 HABTM 关系。这就是为什么 Rails 遵循“约定优于配置”的原因。

# wpf - ListView 项目突出显示

> ID：14968221
> 
> 赞同：0
> 
> 时间：2013-02-19T21:54:44.913
> 
> 标签：wpf, xaml, listview, virtualization, listviewitem

我正在设计一个使用虚拟化 ListView 控件来显示代码行的代码查看器。

现在我想在用户单击将他们带到特定行的链接时创建突出显示效果。我希望突出显示目标行。

效果将是出现（和消失）的“下划线”或出现（和消失）的半透明覆盖（如记号笔）。实际的图形效果本身并不重要，这不是问题。

实现这一目标的最佳方法是什么？我不太确定从哪里开始。

一些技术要求*可能*是我需要：

*   找到正确的事件来响应 - 或使用数据绑定
*   获得虚拟化目标项目的绝对边界矩形（尽管当进入视图时项目应该可用）
*   绝对将画布效果放在顶部，淡入淡出

...理想情况下，视图模型中的一些状态更改，一段 XAML 通过触发的故事板动画显示（淡入）相关 ListViewItem 上方，然后再次动画消失（淡出）。当然，在淡入之前，元素必须已经正确定位在相关的 ListViewItem...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T06:55:33.853

我研究了一个 Listview 的搜索功能，其中每个 ListViewItem 都有几个文本框。当用户在搜索文本框中输入内容时，列表视图中的所有匹配项都应该突出显示。

我根据搜索字符串创建了 Run 对象（使用 Regex 查找匹配项），然后将 Background 设置为某种颜色。此外，在 Run 对象的标记中保存了 ListViewItem 的引用，这有助于我使用调用 ScrollIntoView。希望这对您的情况有所帮助。

# internet-explorer - Internet Explorer 上的 ≤ 和 ≥ 符号？

> ID：14968226
> 
> 赞同：0
> 
> 时间：2013-02-19T21:55:12.630
> 
> 标签：internet-explorer, character

我注意到符号 ≥ 和 ≤ 在 Internet Explorer 上被破坏：它们显示为`&geq;`而`&leq;`不是实际符号（至少在 Win7 下的 IE9 上）。

有什么方法可以在 Internet Explorer 上显示实际字符 ≤ 和 ≥（例如，另一种编写方式，javascript 修复...）？我需要在我网站上的几个地方展示它们，并且我希望该网站也可以在 Internet Explorer 中查看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T05:19:24.370

您可以直接使用字符“≥”和“≤”，前提是您的页面是 UTF-8 编码并声明为这样。如果这不可行或不够方便，您可以使用字符引用`&#x2265;`和`&#x2264;`（或它们的十进制等效项）。

或者，您可以使用较旧的实体引用`&ge;`and `&le;`，它们与 and 具有相同的含义`&geq;`，`&leq;`但得到更好的支持（普遍）。

应避免实体引用，例如（与[HTML 4.01 中定义](http://www.cs.tut.fi/~jkorpela/html/guide/entities.html)`&geq;`的实体集相反）。它们没有增加 HTML 语言的表达能力；它们只是为字符引用提供了一种欺骗性的准助记符替代方案。在 HTML5 草案中引入它们主要是因为它们是在 MathML 中定义的，而不到两年前*还没有*浏览器支持它们，所以仍然有大量浏览器将它们视为未定义，按字面意思显示。

# java - Android Freebase 查询 IOException

> ID：14968229
> 
> 赞同：1
> 
> 时间：2013-02-19T21:55:15.490
> 
> 标签：java, android, ioexception, freebase, mql

我正在尝试在 Android Eclipse 中进行简单的 Freebase 查询。我相信 URL 编译正确，因为我可以复制/粘贴编码的 URL，将其复制/粘贴到浏览器中，它会提取正确的结果。HttpResponse httpResponse = httpClient.execute... 行正在引发 IOException。

```
JSONParser parser = new JSONParser();
String query = "{\"type\":\"/user/tsegaran/language/phrase\",\"id\":null,\"name\":\"Affidavit\",\"/user/tsegaran/language/phrase/translation\":[]}";
String testQuery = URLEncoder.encode(query, "UTF-8");
String testQuery1 = "https://www.googleapis.com/freebase/v1/mqlread?query=" + testQuery + "&key=" + API_KEY;
HttpClient httpClient = new DefaultHttpClient();
HttpResponse httpResponse = httpClient.execute(new HttpGet(testQuery1));
JSONObject response = (JSONObject)parser.parse(EntityUtils.toString(httpResponse.getEntity()));
String jsonResults =  response.getString("result");
JSONObject object = (JSONObject) new JSONTokener(jsonResults).nextValue();
String name = object.getString("/user/tsegaran/language/phrase/translation");
... 
```

**这是我的堆栈跟踪的格式更好的版本：**

```
java.net.UnknownHostException: www.googleapis.com
java.net.InetAddress.lookupHostByName(InetAddress.java:506)
java.net.InetAddress.getAllByNameImpl(InetAddress.java:294)
java.net.InetAddress.getAllByName(InetAddress.java:256)
 org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:136)
org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
 org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:359)
org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
 org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
 org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
com.example.nworthen_androidpoc.MainActivity.test(MainActivity.java:60)
com.example.nworthen_androidpoc.MainActivity.onCreate(MainActivity.java:32)
android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
android.app.ActivityThread.access$1500(ActivityThread.java:117)
android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
android.os.Handler.dispatchMessage(Handler.java:99)
android.os.Looper.loop(Looper.java:130)
android.app.ActivityThread.main(ActivityThread.java:3683)
java.lang.reflect.Method.invokeNative(Native Method)
java.lang.reflect.Method.invoke(Method.java:507)
com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
dalvik.system.NativeStart.main(Native Method) 
```

**我的异常不一致（NullPointer、IOException、NetworkonMainThread）。我将发布的代码添加到 AsyncTask。不幸的是，我不再在我的 Logcat 上获得输出，但是在调试时它把我踢到：** 类文件编辑器

找不到源 JAR 文件 C:/users..... 没有源附件。可以附上源码... // 编译自 ThreadPoolExecutor.java（版本 1.5 : 49.0，超级位）

```
public class java.util.concurrent.ThreadPoolExecutor extends java.util.concurrent.AbstractExecutorService {

  // Method descriptor #17 (IIJLjava/util/concurrent/TimeUnit;Ljava/util/concurrent/BlockingQueue;)V
  // Signature: (IIJLjava/util/concurrent/TimeUnit;Ljava/util/concurrent/BlockingQueue<Ljava/lang/Runnable;>;)V
  // Stack: 3, Locals: 7
  public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, java.util.concurrent.TimeUnit unit, java.util.concurrent.BlockingQueue workQueue);
     0  aload_0 [this]
     1  invokespecial java.util.concurrent.AbstractExecutorService() [1]
     4  new java.lang.RuntimeException [2]
     7  dup 
```

...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:51:18.080

您是否确保您的应用程序有权访问 Internet？

请参阅：[https ://stackoverflow.com/a/442590/81821](https://stackoverflow.com/a/442590/81821)

# django - 选择表单域上的选项

> ID：14968231
> 
> 赞同：0
> 
> 时间：2013-02-19T21:55:21.163
> 
> 标签：django, django-forms, django-views

我有一个带有 CHOICE 元组的 Django 表单：

```
ANIMAL_TYPE_CHOICE = (
    (1, 'Lion'),
    (2, 'Tiger'),
    (3, 'Dolphin'),
    (4, 'Shark'),
)

class AnimalInfoForm(forms.Form):
    ...
    animal_type = forms.ChoiceField(
        choices=ANIMAL_TYPE_CHOICE,
    ) 
```

不过，我想做的是根据命名的 url 模式提供不同的选择。

所以在我看来，我有这样的事情：

```
 def AnimalInfo(request, environment=None):
      ... 
```

我需要帮助的是根据`environment`变量提供不同的选择选项。例如：

```
 def AnimalInfo(request, environment=None):
      ...
     if environment == 'marine':
         # only offer choices 3,4
         ANIMAL_TYPE_CHOICE = (
             (3, 'Dolphin'),
             (4, 'Shark'),
         ) 
```

如何根据请求动态配置这样的选择？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:03:46.247

您可以通过将环境变量传递给表单来动态修改表单 init 中的选项：

视图.py

```
form = AnimalInfoForm(environment) 
```

表格.py

```
ANIMAL_TYPE_CHOICE = (
    (1, 'Lion'),
    (2, 'Tiger'),
    (3, 'Dolphin'),
    (4, 'Shark'),
)

ANIMAL_TYPE_CHOICE_AFRICA = (
    (1, 'Lion'),
    (2, 'Tiger'),
    (3, 'Elephant'),
    (4, 'Monkey'),
)

class AnimalInfoForm(forms.Form):
    animal_type = forms.Field()
    def __init__(self, environment, *args, **kwargs):
       super(AnimalInfoForm, self).__init__(*args, **kwargs)
       if environment == "Africa":
           self.fields['animal_type'] = forms.ChoiceField(choices=ANIMAL_TYPE_CHOICE_AFRICA))
       else:
            self.fields['animal_type'] = forms.ChoiceField(choices=ANIMAL_TYPE_CHOICE)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:59:11.213

您应该修改表单字段小部件的选择属性。

# android - 如何在 Google Play 应用说明中包含要点？

> ID：14968233
> 
> 赞同：27
> 
> 时间：2013-02-19T21:55:38.217
> 
> 标签：android, google-play

我对此进行了研究，但只发现您可以使用 < b >...</b > 和 < i >...</i > 进行基本格式设置，以获取 Google Play 中的应用描述，所以有人知道是否是否可以显示一个项目符号（实心圆圈） - 最好是缩进？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-02-19T22:06:00.693

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-08-24T13:41:06.267

I had the same issue but it does seem that HTML character entites are supported. You can check this out on [this link](http://www.w3.org/TR/html4/sgml/entities.html). You can insert special characters like bullets '•' (`&bull;`), ® (`&reg;`), ™ (`&trade;`), ... etc pretty much the HTML way. This worked out for me.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-06-21T09:19:00.320

This is not bullet but you can consider it. As there is nothing like big dot.

I used New Moon symbol in the description and its working fine. [http://emojipedia.org/new-moon-symbol/](http://emojipedia.org/new-moon-symbol/)

⚫ Black Circle

New Moon

Full Moon

Diamond With a Dot

Small Orange Diamond

⚙ Gear

Black Flag

White Flag

▶ Play Button

⏩ Fast-Forward Button

⭕ Heavy Large Circle

✴ Eight-Pointed Star

◼ Black Medium Square

◽ White Medium-Small Square

◾ Black Medium-Small Square

⬛ Black Large Square

Also you can use full moon character.

You just need to copy and paste it over description. Below is the result.

![enter image description here](../Images/91446d092d5ce51aebb5d844a2899cb1.png)

# android - 列的 SQLite 异常数据插入问题

> ID：14968234
> 
> 赞同：0
> 
> 时间：2013-02-19T21:55:41.030
> 
> 标签：android, android-sqlite

这是我的 dbHelper 类的代码：

```
package com.example.emp_management;

import android.content.ContentValues;
import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteDatabase.CursorFactory;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

public class DatabaseHelper extends SQLiteOpenHelper {

public DatabaseHelper(Context context) {
    super(context, dbName, null, 1);
    // TODO Auto-generated constructor stub
}
static final String dbName="EmployeeManagementSystem";
static final String Login_Table="Login_Authentication";
static final String colID="ID";
static  final String colUsername="Username";
static final String colPassword="Passwrod";

@Override
public void onCreate(SQLiteDatabase db) {
// TODO Auto-generated method stub
//db.execSQL("CREATE TABLE" + Login_Table+ "(" +
    //       colID + "INTEGER PRIMARY KEY AUTOINCREMENT, " +
        //  colUsername + "TEXT NOT NULL," +
          // colPassword + "TEXT NOT NULL);"                    
            //);
//db.execSQL("CREATE TABLE "+Login_Table+" ("+colID+ " INTEGER PRIMARY KEY AUTOINCREMENT ,"+
    //    colUsername+ " TEXT ,"+ colPassword + "TEXT");
db.execSQL("CREATE TABLE " + Login_Table + "(colID INTEGER PRIMARY KEY AUTOINCREMENT, colUsername TEXT NOT NULL,colPassword TEXT NOT NULL);");
Log.w("Come aww man", "Database Table Created!!");

}
    @Override
   public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
// TODO Auto-generated method stub
db.execSQL("DROP TABLE IF EXISTS " + "Login_Authentication");
onCreate(db);
}
public void insert_new_user(String username,String password)
{
    SQLiteDatabase db = this.getWritableDatabase();
    ContentValues cv = new ContentValues();
    cv.put(DatabaseHelper.colUsername,username);
    cv.put(DatabaseHelper.colPassword,password);
    db.insert(Login_Table, null, cv);
    db.close();
    }
} 
```

这是用于将新员工添加到我创建的表中的代码：

```
 package com.example.emp_management;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class Adding_Employee extends Activity{

@Override
protected void onCreate(Bundle aglakaam) {
    // TODO Auto-generated method stub
    super.onCreate(aglakaam);

    setContentView(R.layout.add_employee);
    final EditText new_user = (EditText) findViewById(R.id.editText1);
    final EditText new_pass = (EditText) findViewById(R.id.editText2);
    final Button create_acc = (Button) findViewById(R.id.creat_acc);

    create_acc.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View v) {
        // TODO Auto-generated method stub
        DatabaseHelper accessing_db = new DatabaseHelper(Adding_Employee.this);
        accessing_db.insert_new_user(new_user.getText().toString(), new_pass.getText().toString());
        Toast.makeText(getApplicationContext(), "New User Has Been Created!!", Toast.LENGTH_SHORT).show();

    }
});
}

} 
```

这是我的日志：

```
02-20 02:42:26.491: E/Database(384): Error inserting Passwrod=1234 Username=sjdf
02-20 02:42:26.491: E/Database(384): android.database.sqlite.SQLiteException: table     Login_Authentication has no column named Passwrod: , while compiling: INSERT INTO Login_Authentication(Passwrod, Username) VALUES(?, ?);
02-20 02:42:26.491: E/Database(384):    at android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method) 
```

对我来说有点奇怪的是用户名列存在。为什么它只显示密码而不是用户名的异常，即使存在密码列，为什么这里会抛出异常。请帮助我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:57:51.323

您正在创建名称为 colPassword 、 colUsername 和 colID 的列

```
db.execSQL("CREATE TABLE " + Login_Table + "(colID INTEGER PRIMARY KEY AUTOINCREMENT, colUsername TEXT NOT NULL,colPassword TEXT NOT NULL);"); 
```

然后尝试使用

```
static final String colID="ID";
static  final String colUsername="Username";
static final String colPassword="Passwrod"; 
```

由于 Passwrod != colPassword .. 当然，您将无法找到该列。

尝试这样的操作，以确保在创建表和访问表时使用相同的列名称。您需要增加数据库版本才能显示更改。

```
db.execSQL("CREATE TABLE " + Login_Table + "(" + colID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + colUsername + " TEXT NOT NULL," + colPassword + " TEXT NOT NULL);"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:25:45.310

也许你只需要 colID 、 colUsername 、 colPassword 之后的空格

db.execSQL("CREATE TABLE " + Login_Table + "(" + colID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + colUsername + " TEXT NOT NULL," + colPassword + " TEXT NOT NULL);");

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-19T21:57:05.157

您将 Password 拼错为 Passwrod。简单的错字。此外，Java 不进行变量字符串插值，您需要使用连接。

# ioctl - IOCTL 调用和检查返回值

> ID：14968238
> 
> 赞同：3
> 
> 时间：2013-02-19T21:55:49.353
> 
> 标签：ioctl, errno

```
if((err = ioctl(fd, IOC_CARD_LOCK, &lock)) < 0)
{
     printf("ioctl failed and returned errno %d \n",err);
} 
```

上面的代码是否正确并且是一种良好的编程习惯？它确实在我的电脑上编译。即它是否填充`err`了返回值`ioctl`并检查是否`err`是`< 0`

上述方法是返回 IOCTL 返回的“err”的标准方法吗？

似乎有一些标准变量称为 errno？它是什么？会和上面一样吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-19T22:12:58.683

我找到了一个更好的方法来做到这一点。

```
if(ioctl(fd, IOC_CARD_LOCK, &lock) < 0)
{
     printf("ioctl failed and returned errno %s \n",strerror(errno));
} 
```

errno 是为系统调用设置的全局变量。strerror 将代码（负整数）转换为有意义的字符串（例如“无效参数”。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-20T09:55:16.673

只是偶然发现了这个回应。答案只是部分正确，因为 printf 可能会覆盖 errno - 根据手册页，必须保存 errno。因此，更可靠的答案是：

```
if(ioctl(fd, IOC_CARD_LOCK, &lock) < 0)
{
    int errsv = errno;
    printf("ioctl failed and returned errno %s \n",strerror(errsv));
} 
```

# sql - 如何在此处使用自连接来产生所需的输出

> ID：14968247
> 
> 赞同：0
> 
> 时间：2013-02-19T21:56:23.913
> 
> 标签：sql, sql-server-2008, tsql

我有这样的表结构：

```
CREATE TABLE Item
(
  ItemKey BIGINT,
  DisplayName VARCHAR(100)
)

INSERT INTO Item VALUES (136172,'Computer')
INSERT INTO Item VALUES (156737,'Car')

CREATE TABLE ItemTypeFactvw
(
   ItemKey BIGINT,
   TypeDimKey BIGINT
)

INSERT INTO ItemTypeFactvw VALUES (136172,483)
INSERT INTO ItemTypeFactvw VALUES (136172,1353)
INSERT INTO ItemTypeFactvw VALUES (156737,1000)

CREATE TABLE ItemTypeDimvw
(
  Id BIGINT,
  BaseId BIGINT,
  TypeDimKey BIGINT,
  DisplayName VARCHAR(100)

)

INSERT INTO ItemTypeDimvw VALUES (1,80,483,'IT Gadgets')
INSERT INTO ItemTypeDimvw VALUES (3,1,1353,'Electronics')
INSERT INTO ItemTypeDimvw VALUES (2,44,1000,'Vehicle') 
```

我需要产生这样的结果（期望的输出）：

```
| ITEMKEY | DISPLAYNAME | TYPEDIMKEY | ID | BASEID | ITEM BASE TYPE |
---------------------------------------------------------------------
|  136172 |    Computer |        483 |  1 |     80 |    Electronics |
|  156737 |         Car |       1000 |  2 |     44 |        Vehicle | 
```

这是我的查询：

```
SELECT i.ItemKey, 
        i.DisplayName, 
        it.TypeDimKey,
        itd.Id,
        itd.BaseId,
        itd.DisplayName 'Item Base Type'
  FROM Item i
INNER JOIN ItemTypeFactvw it
on i.ItemKey = it.ItemKey
INNER JOIN  ItemTypeDimvw itd
ON itd.TypeDimKey = it.TypeDimKey 
```

上面的查询不会产生所需的输出，因为它还会从`ItemTypeDimvw`where `DisplayName`is带来额外的记录`"IT Gadgets"`。

将其视为类层次结构。IT 小工具继承自电子产品。所以我需要在这种情况下显示基本类型，它是用于 IT 小工具的电子产品

[http://sqlfiddle.com/#!3/ef094/1](http://sqlfiddle.com/#!3/ef094/1)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:20:44.457

这是你想要的吗？

```
select  i.ItemKey, 
        i.DisplayName, 
        it.TypeDimKey,
        itd.Id,
        itd.BaseId,
        itd.DisplayName 'Item Base Type'
  from Item i
inner join ItemTypeFactvw it
on i.ItemKey = it.ItemKey
inner join ItemTypeDimvw itd
on itd.TypeDimKey = it.TypeDimKey
left outer join ItemTypeDimvw itd2
on itd2.id = itd.BaseId
where itd2.id is null 
```

# c - 如何让我的程序只检查括号内？

> ID：14968248
> 
> 赞同：0
> 
> 时间：2013-02-19T21:56:29.603
> 
> 标签：c

该程序的目标是能够提取字符串（char）中的整数，前提是它们位于一组括号内。如果字符串不满足这些要求，我还想打印出一条错误消息。

例如：`char str = "( 1 2 3)";` 这将打印它找到整数 1、2 和 3。但是假设 str is`char str = " 1 2 3( 4 5 6);`会返回对我的错误函数的调用，因为它的格式不正确。如果字符串包含任何不是数字或空格的其他内容，它也应该打印错误。最后，假设检查括号内的内容，直到找到结束括号。

目前，我可以搜索任何字符串并提取整数，但我无法弄清楚如何确定除了数字之外是否还有其他内容，只能检查括号内的内容。

```
void scanlist(char *str)
{
    char *p = str;
    while (*p) {
    if ((*p == '-' && isdigit(p[1])) || (isdigit(*p))) {
        int val = strtol(p, &p, 10);
        on_int(val);
    }
    else {
        p++;
    }

} 
```

我曾尝试在 while 之后放置另一个 if 语句，看看它是否以 '(' 开头，但它什么也没做。请谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:00:39.403

你需要保持一些关于你的职位的状态。例如：

```
int inside_paren = 0;
while (*p) {
    switch (*p) {
    case '(':
        if (inside_paren)
            /* error */
        inside_paren = 1;
        break;
    case ')':
        /* ... */
        inside_paren = 0;
        break;
    default:
        if (!isdigit(*p) || !inside_paren)
            /* error */
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:48:08.903

希望这可以帮助

```
int main()
    {
        //variable declerations
        int j = 0;
        // str is the string that is to be scanned for numbers
        string  str= "(123)";
        //iterator to point at individual characters in a string 
        //It starts at the beginning of a string
        //a string is an array of characters
        string::iterator p = str.begin();
        //if the iterator that i named p does not find the bracket at the begining 
        //prints out an error massage
        if(*p != '(')
        {
            cout<<"error";
        }
        //else if it finds a bracket at the begining goes into the loop
        // I use *p to veiw the content that the iterator points to 
        // if you only use p you will get the address which is a bunch of wierd numbers like A0Bd5 
        if(*p == '(')
        {
            //while loop to move the iterator p one caracter at a time until reach end of string
            while(p != str.end())
            {
                       // if end bracket is reached end loop
                       if(*p == ')')
                       {
                       break;
                       }
                //if it finds a digit prints out the digit as character not as int! 
                if(isdigit(*p))
                {

                    cout<<*p<<endl;
                }
                //increments the iterator by one until loop reach end of string it breaks
                p++;
            }
        }

        //to pause the screen and view results
        cin.get();

    } 
```

# java - 在其他计算机上未找到主类错误

> ID：14968251
> 
> 赞同：1
> 
> 时间：2013-02-19T21:56:40.323
> 
> 标签：java, class, netbeans, executable-jar

我的 java 程序有一个大问题。当我在我的计算机上（通过 netbeans）运行它们时，它们工作得非常好。现在奇怪的是，当我将它们构建成 jar 文件并将其发送到另一台计算机时，它们不起作用，说“找不到主类错误”（当我在自己的计算机上尝试 jar 文件时，它完全正常工作） . 也许这与不同的java版本和jdks有关。或者可能是 jar 文件搞砸了。我使用 netbeans 生成的一个（单击 clean and build 后）。请告诉我问题是什么以及如何解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:26:06.967

我没有使用 Netbeans 的经验，但是，根据我对`jar`s 的经验，您的主类应该有如下方法：

```
public static void main(String[] args) {
    // Note the string array argument, it's important.
} 
```

你`jar`也应该有一个正确的设置`manifest`。也许[这个问题](https://stackoverflow.com/questions/2848642/how-to-setup-main-class-in-manifest-file-in-jar-produced-by-netbeans-project)可以为您提供更多见解。我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:29:21.770

我有同样的问题。检查导出过程，将其设为 Runnable Jar File，然后选择主类。如果这不起作用，请创建一个新的 Jar 项目并通过将所有其他文件从旧 jar 复制到新 jar 来重新开始。

# ruby-on-rails - Spree/Rails 用户密码重置

> ID：14968254
> 
> 赞同：2
> 
> 时间：2013-02-19T21:56:53.350
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, spree

我正在尝试从 Rails 控制台设置用户（管理员）密码：

```
bundle exec rails console
> Spree::User.first.email
=> "admin@mysite.com"
> Spree::User.first.encrypted_password
  Spree::User Load (1.1ms)  SELECT "spree_users".* FROM "spree_users" LIMIT 1
=> "4ec556............................................."
>  Spree::User.first.password='spree123'
  Spree::User Load (1.0ms)  SELECT "spree_users".* FROM "spree_users" LIMIT 1
=> "spree123"
>  Spree::User.first.password_confirmation='spree123'
  Spree::User Load (1.0ms)  SELECT "spree_users".* FROM "spree_users" LIMIT 1
=> "spree123"
>  Spree::User.first.save!
  Spree::User Load (1.0ms)  SELECT "spree_users".* FROM "spree_users" LIMIT 1
   (0.3ms)  BEGIN
   (1.3ms)  SELECT COUNT(DISTINCT "spree_users"."id") FROM "spree_users" LEFT OUTER JOIN "spree_roles_users" ON "spree_roles_users"."user_id" = "spree_users"."id" LEFT OUTER JOIN "spree_roles" ON "spree_roles"."id" = "spree_roles_users"."role_id" WHERE "spree_roles"."name" = 'admin'
   (0.3ms)  COMMIT
=> true
> Spree::User.first.encrypted_password
  Spree::User Load (1.0ms)  SELECT "spree_users".* FROM "spree_users" LIMIT 1
=> "1bc15d.............................................." 
```

到目前为止，一切都很好。看起来用户的新密码已更改并提交到数据库。但是，当我稍后尝试使用 Web 客户端登录并使用新密码时，它会失败并显示无效的身份/密码消息。我什至尝试更新密码，`Spree::User.first.reset_password!('spree123', 'spree123')`但仍然无法登录。

Rails 3.2.12 大礼包 1.3.2

知道我在做什么错吗？如何正确设置新密码？

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-20T01:30:48.333

问题是每次你这样做时都会`Spree::User.first`从数据库中重新加载记录。这意味着您正在为记录的一个实例设置值，重新加载它，然后保存实际上没有更改的重新加载的模型。解决此问题的一种简单方法是创建一个包含记录的本地实例变量并更新它：

```
user = Spree::User.first
user.password='spree123'
user.password_confirmation='spree123'
user.save! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-27T16:22:13.450

```
Spree::User.first.update_attributes(password: 'password') 
```

# php - mysql 查询 - 创建按月显示销售额的表的查询

> ID：14968255
> 
> 赞同：0
> 
> 时间：2013-02-19T21:56:56.247
> 
> 标签：php, mysql

我有一个包含销售信息的 mysql 表：卖家、产品、销售日期。

如何编写查询以生成一个表格，显示每个卖家、每月和总计显示的产品总数？

这是我用来创建一个包含 SellerName 和 7 月份总销售额的表的查询：

```
select SellerName, count(*) as july 
from onlineDATA
where ReportMonth = 201207
GROUP BY SellerName
ORDER BY july DESC
LIMIT 0,30 
```

如何修改它以获得每个月的额外销售总额？

我正在寻找这样的输出：

```
 SellerName   | Jun  | Jul  | Aug  | YTD
    John Doe     | 30   |  25  |  30  | 85 
```

额外的问题 - 当月数是用户输入时，我将如何在 PHP 中编写代码 - 从 1 到 12？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:04:40.937

我认为您将不得不单独定义列，如下所示：

```
SELECT 

SellerName,     
SUM(IF(ReportMonth = 201206, 1.0)) AS Jun,
SUM(IF(ReportMonth = 201207, 1.0)) AS Jul,
SUM(IF(ReportMonth = 201208, 1.0)) AS Aug,
COUNT(*) AS YTD

FROM onlineDATA

GROUP BY SellerName 
ORDER BY SellerName DESC LIMIT 30; 
```

# c# - 如何绑定到索引属性？

> ID：14968259
> 
> 赞同：1
> 
> 时间：2013-02-19T21:57:14.253
> 
> 标签：c#, asp.net, data-binding, indexer

我正在尝试绑定这样的属性：

```
public string this[string field] 
{
     get 
     { 
        // TODO: accessor code goes here
     }
} 
```

...到 GridView 中的 BoundField。类似的事情可以用例如DataTable（通过绑定到列名）来完成，但我一直坚持如何让它与我自己的类一起工作。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T01:46:00.410

这行得通吗？

`<TextBlock Text="{Binding [someColumnName]}" />`

# python - Python中的日语数字到阿拉伯数字的转换器

> ID：14968260
> 
> 赞同：7
> 
> 时间：2013-02-19T21:57:17.310
> 
> 标签：python, translation, machine-translation

Python中有一个开源库可以将汉字数字转换为阿拉伯数字吗？

输入：10亿2千9百万
输出：1,029,000,000

输入：1亿6,717万2,600
输出：167,172,600

输入：3,139 百万
输出：3,139,000,000

日本数字系统：[http ://en.wikipedia.org/wiki/Japanese_numerals](http://en.wikipedia.org/wiki/Japanese_numerals)

基于网络的转换器：[http ://www.sljfaq.org/cgi/kanjinumbers.cgi](http://www.sljfaq.org/cgi/kanjinumbers.cgi)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:03:23.567

这应该有效：

```
import kanjinums
kanjinums.kanji2num("五百十一") 
```

下载并安装[kanjinums](http://ginstrom.com/scribbles/2009/04/28/converting-kanji-numbers-to-integers-with-python/)后，很遗憾无法通过 pip 获得。

**编辑：**这仅适用于基本数字，而不是提到的复杂情况。

稍加修改，这实际上可以工作，例如：

```
3139*kanjinums.kanji2num("百万")
3139000000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-21T18:28:01.150

这实际上可以在函数中相对容易地完成：

```
def convert_kanji(self, zahl):
    japnumber = ("兆", "億",  "万")
    jap_factors = {
            "兆": 1000000000000,
            "億": 100000000,
            "万": 10000
            }

    #Define the variables
    converted_number = 0
    already_found = False
    found_kanji_previous = 0

    try: #If the number can be returned as an integer (i.e. no Kanji in it) -> do it
        return(int(zahl)) 
    except ValueError: #If not, disintegrate it
        for key in japnumber: #do it for every Kanji
            if key in zahl: #If it has been found in the original string:
                gef_kanji = zahl.find(key) #mark, which Kanji has been found
                if not already_found: #if it is the first kanji:
                    intermediate_step = int(zahl[:gef_kanji]) * jap_factors[key] #Convert the number in front of the Kanji with the appropriate factor
                    converted_number = intermediate_step
                    already_found = True
                    found_kanji_previous = gef_kanji
                else: #for sll other kanjis
                    intermediate_step = int(zahl[found_kanji_previous+1:gef_kanji]) * jap_factors[key]
                    converted_number = converted_number + intermediate_step #sum them up
                    found_kanji_previous = gef_kanji

        if len(zahl) > (found_kanji_previous+1):
            converted_number = converted_number + int(zahl[found_kanji_previous+1:])
        return converted_number 
```

这个还是比较简单的。只能接受2314兆3424亿3422万2342形式的数字。

代码也可能非常糟糕，因为这实际上是我很长一段时间以来的第一个程序。但这对您来说可能是一个很好的起点。

实际上，我目前正在开发一个简单的转换器，它将日本数字转换为易于阅读的西方数字（例如将 231 亿转换为“230 亿 1 亿”；它实际上已经这样做了）。我想还有很多事情要做，例如全角字符、完全用汉字的数字等。如果我已经解决了所有这些问题，我可能会像 kanjinums 一样上传它：D

# apache - htaccess 重写导致 500 错误

> ID：14968262
> 
> 赞同：0
> 
> 时间：2013-02-19T21:57:20.013
> 
> 标签：apache, .htaccess, mod-rewrite, redirect

我正在尝试做一些我认为很简单的重定向，但由于某种原因，下面的重定向（以及我尝试过的其他 1000 次尝试！）似乎会导致 500 错误。

我已经设法让 domain.co.uk 到 www.domain.co.uk 自己工作，但是一旦我尝试添加额外的重定向，它就会失败。

基本上，我只想要一个从 domain.co.uk 到 www.domain.co.uk 的标准 301，我还想暂时将 www.domain.co.uk 指向 www.domain.co.uk/blog

任何帮助，非常感谢！

```
Options +FollowSymLinks
RewriteEngine On

RewriteCond %{HTTP_HOST} ^domain.co.uk$ [NC]
RewriteRule ^(.*)$ http://www.domain.co.uk/$1 [R=301,L]

RewriteCond %{REQUEST_URI} !^/blog [NC]
RewriteRule (.*) blog/$1 [R=307, L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T23:11:44.670

以为我会在这里回答，因为我浪费了几个小时，这个问题非常愚蠢！所以希望这可以节省一些时间：

问题是由我在第二个重写标志中放置的空间引起的：

```
RewriteRule (.*) blog/$1 [R=307, L] 
```

请参阅上面 L 之前的空格。以下（减去空格）解决了这个问题：

```
RewriteRule (.*) blog/$1 [R=307,L] 
```

# python - Celery 任务链和访问 **kwargs

> ID：14968265
> 
> 赞同：13
> 
> 时间：2013-02-19T21:57:30.030
> 
> 标签：python, celery, chain, keyword-argument

我的情况与[此处](https://stackoverflow.com/questions/14396267/celery-chaining-tasks-with-multiple-arguments)概述的情况类似，除了我不想用多个参数链接任务，而是想链接返回具有多个条目的字典的任务。

这是 - 非常松散和抽象地 - 我正在尝试做的事情：

任务.py

```
@task()
def task1(item1=None, item2=None):
  item3 = #do some stuff with item1 and item2 to yield item3
  return_object = dict(item1=item1, item2=item2, item3=item3)
  return return_object

def task2(item1=None, item2=None, item3=None):
  item4 = #do something with item1, item2, item3 to yield item4
  return_object = dict(item1=item1, item2=item2, item3=item3, item4=item4)
  return return_object 
```

从 ipython 工作，我能够单独和异步调用 task1，没有问题。

我也可以单独调用 task2，并将 task1 返回的结果作为双星参数：

```
>>res1 = task1.s(item1=something, item2=something_else).apply_async()
>>res1.status
'SUCCESS'
>>res2 = task2.s(**res1.result).apply_async()
>>res2.status
'SUCCESS 
```

但是，我最终想要实现的是与上面相同的最终结果，但是通过一个链，在这里，我无法弄清楚如何实例化 task2，而不是使用 task1 返回的（位置）*参数*，而是使用 task1.result 作为**kwargs：

```
chain_result = (task1.s(item1=something, item2=something_else) | task2.s()).apply_async()  #THIS DOESN'T WORK! 
```

我怀疑我可以回去重写我的任务，以便它们返回位置参数而不是字典，这可能会解决问题，但在我看来，应该有某种方法可以访问 task1 在 task2 中的返回对象**双星的功能。我还怀疑我在这里遗漏了一些关于 Celery 子任务实现或 *args 与 **kwargs 的相当明显的东西。

希望这是有道理的。并提前感谢任何提示。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-10-24T11:11:50.090

这是我对这个问题的看法，使用抽象任务类：

```
from __future__ import absolute_import
from celery import Task
from myapp.tasks.celery import app   

class ChainedTask(Task):
    abstract = True    

    def __call__(self, *args, **kwargs):
        if len(args) == 1 and isinstance(args[0], dict):
            kwargs.update(args[0])
            args = ()
        return super(ChainedTask, self).__call__(*args, **kwargs)

@app.task(base=ChainedTask)
def task1(x, y):
    return {'x': x * 2, 'y': y * 2, 'z': x * y}    

@app.task(base=ChainedTask)
def task2(x, y, z):
    return {'x': x * 3, 'y': y * 3, 'z': z * 2} 
```

您现在可以像这样定义和执行您的链：

```
from celery import chain

pipe = chain(task1.s(x=1, y=2) | task2.s())
pipe.apply_async() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T13:12:17.727

`chain`其他画布原语属于功能实用程序家族，例如`map`和`reduce`。

例如 where`map(target, items)`调用`target(item)`列表中的每个项目，Python 有一个很少使用的 map 版本，称为`itertools.starmap`，而不是调用`target(*item)`.

虽然我们可以添加工具箱，`starchain`甚至可以添加`kwstarchain`到工具箱中，但这些工具箱非常专业，可能不会经常使用。

有趣的是，Python 使用 list 和 generator 表达式使这些变得不必要，因此 map 被替换为 ，`[target(item) for item in item]`而 starmap被替换为`[target(*item) for item in item]`。

因此，与其为每个原语实现几个替代方案，我认为我们应该专注于寻找一种更灵活的方式来支持这一点，例如使用 celery 驱动的生成器表达式（如果可能，如果不是类似强大的东西）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-03T03:05:55.450

因为这不是 celery 内置的，所以我自己写了一个装饰器函数来做类似的事情。

```
# Use this wrapper with functions in chains that return a tuple. The
# next function in the chain will get called with that the contents of
# tuple as (first) positional args, rather than just as just the first
# arg. Note that both the sending and receiving function must have
# this wrapper, which goes between the @task decorator and the
# function definition. This wrapper should not otherwise interfere
# when these conditions are not met.

class UnwrapMe(object):
    def __init__(self, contents):
        self.contents = contents

    def __call__(self):
        return self.contents

def wrap_for_chain(f):
    """ Too much deep magic. """
    @functools.wraps(f)
    def _wrapper(*args, **kwargs):
        if type(args[0]) == UnwrapMe:
            args = list(args[0]()) + list(args[1:])
        result = f(*args, **kwargs)

        if type(result) == tuple and current_task.request.callbacks:
            return UnwrapMe(result)
        else:
            return result
    return _wrapper 
```

我的像这个`starchain`概念一样展开，但你可以很容易地修改它来展开 kwargs。

# linux - shell脚本终止程序但不是脚本本身

> ID：14968269
> 
> 赞同：-1
> 
> 时间：2013-02-19T21:57:39.953
> 
> 标签：linux, shell, shell-trap

我正在使用 shell 脚本自动搜索网络接入点，在 airodump 中，您使用 ctrl + c 停止搜索，我希望它取消搜索但保持我的 shell 脚本运行。因为我想在搜索完 wifi 网络后进行用户输入。我尝试使用陷阱，它停止了 airodump 和我的脚本。

我只是想停止 airodump wifi 搜索并转到我的用户输入 shell 脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:23:37.900

我并不完全清楚，但我相信您希望用户能够以交互方式停止搜索`ctrl-C`，然后提示输入。这应该这样做：

```
#!/bin/sh

trap 'test "$airo" && kill -2 $airo' 2
airodump ... &
airo=$!
wait
unset airo

# Commands here will execute after the user hits ctrl-C to terminate the search 
```

# php - 我需要从 MySQL 数据库中选择最新的行，但要验证我是否还返回了具有给定 ID 的行

> ID：14968270
> 
> 赞同：0
> 
> 时间：2013-02-19T21:57:39.553
> 
> 标签：php, mysql

我是新手，如果标题令人困惑，对不起。我正在构建一个简单的 php/mysql 库。当用户第一次访问它时，它将显示最新的 25 个条目，并且还允许离线链接到列表中的各个项目。如果 URL 包含一个 ID，javascript 将滚动到它。但是如果有 25 个以上的条目，我的查询可能会获取最新的结果，但会忽略恰好在 URL 中作为 ID 的旧条目。

这意味着我需要做这样的事情......

```
SELECT * FROM `submissions` WHERE uid='$sid' 
```

但是在成功找到具有特殊ID的提交之后，也这样做

```
SELECT * FROM `submissions`  ORDER BY `id` DESC LIMIT 0, 25` 
```

这样我就可以填充画廊的其余部分。

我可以查询该数据库两次，但我假设有一些很好的方法可以避免这种情况。MySQL 还对所有内容进行排序（基于最新的、视图和其他变量），并且使用两个查询会破坏这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:07:42.953

您可以像这样限制 UNION：

```
(SELECT * FROM submissions WHERE uid = '$uid')
UNION
(SELECT * FROM submissions WHERE uid <> '$uid' ORDER BY `id` LIMIT 25)
LIMIT 25 
```

注意`LIMIT`在第一个查询返回结果的情况下列出了两次，我们将在联合集中有 26 个结果。这也会将“搜索”项放在返回的排序结果集中的首位（其他 24 个结果按排序顺序显示）。如果这不是可取的，您可以`ORDER BY`在联合中放置一个，但如果它恰好是第 26 条记录，您的搜索结果将被截断。

如果您需要 25 行并对其进行排序，我的猜测是您需要执行两种查询方法（根据第一个查询是否匹配，将第二个查询限制为 24 条或 25 条记录），然后只需插入 uid - 匹配的结果在显示之前放入适当位置的排序记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:19:34.790

我认为更好的解决方案是：

```
SELECT *
FROM `submissions`
order by (case when usid = $sid then 0 else 1 end),
         id desc
limit 25 
```

我认为不能`union`保证按联合的顺序返回结果（标准或其他数据库中没有保证）。

# delphi - 如何在 Delphi 中将自己的摘要详细信息写入/读取文件属性？

> ID：14968279
> 
> 赞同：1
> 
> 时间：2013-02-19T21:58:10.153
> 
> 标签：delphi, delphi-xe3, file-properties

大多数流行的文件（如 Word 文档、TXT 文件、JPG 图像等）在属性中都有其特定的摘要详细信息字段。

我的程序生成它的保存文件，是否可以在我生成的文件的属性中拥有我自己的摘要详细信息字段？我在互联网上进行了搜索，但我只是找到了有关这些常见文件的读/写详细信息的文章和代码（Word 文档、mp3 文件的 ID3 标记……）

![在此处输入图像描述](../Images/11e89edda54a218fbddce647272fcd9f.png)

# iphone - 如何查询实际的应用程序版本字符串？

> ID：14968281
> 
> 赞同：0
> 
> 时间：2013-02-19T21:58:28.130
> 
> 标签：iphone, ios, objective-c, xcode, cocoa-touch

CFBundleVersion 键检索 Xcode 4 中设置的“Build”号，但不检索“Version”。

我想获取用户在 App Store 上看到的版本字符串。这有不同的密钥吗？

```
NSString *appVersion = [[[NSBundle mainBundle] infoDictionary] objectForKey:@"CFBundleVersion"]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:02:11.413

您是否尝试过使用`CFBundleShortVersionString?`

`[[[NSBundle mainBundle] infoDictionary] objectForKey:@"CFBundleShortVersionString"]`

# latex - 如何使 x-lable 在 gnuplot 中处理几何级数数据？

> ID：14968283
> 
> 赞同：0
> 
> 时间：2013-02-19T21:58:37.500
> 
> 标签：latex, gnuplot

x-lable 数据是几何级数，例如：50000000、5000000、500000、50000、5000、500、50、5。但是，gnuplot 中的默认值是算术级数。获取这些数据时如何使我的图表看起来不错？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T00:01:50.857

您可能想要使用对数刻度：

```
set logscale x 
```

# salesforce - 如何指定特定应用的 url？

> ID：14968285
> 
> 赞同：0
> 
> 时间：2013-02-19T21:58:44.323
> 
> 标签：salesforce

假设我有几个应用程序（应用程序 A、应用程序 B、应用程序 C）并且我的域名是 mycompany.salesforce.com 我可以在哪里指定以便我的应用程序 url 是 appa.mycompanrey.salesforce.com？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T06:55:40.890

据我所知，Salesforce 不会为应用程序/包分配子域。相反，它[为托管包提供子域](https://na7.salesforce.com/help/doc/en/register_namespace_prefix.htm)，例如`https://namespace.na1.visual.force.com/00A987654321`.

如果您使用的是 Salesforce 站点，那么您将能够[注册一个域](http://www.salesforce.com/docs/developer/cookbook/Content/sites_using_custom_domain.htm)，而不是使用`www.salesforce.com`.

# spring-mvc - 找不到具有此 URI 的标记库

> ID：14968287
> 
> 赞同：1
> 
> 时间：2013-02-19T21:58:45.303
> 
> 标签：spring-mvc, weblogic-10.x, tiles2

我的项目结构如下

```
EAR
--APP
 --lib
   Spring jars
   tiles jar here

--war 1- tiles dependent webpages 
```

我的标签包含在 jsp 布局中

```
<%@ taglib uri="http://tiles.apache.org/tags-tiles" prefix="tiles"%> 
```

当尝试从战争 1 加载页面时，我在 weblogic 10.3 版本中遇到异常

原因：weblogic.servlet.jsp.CompilationException：无法编译 JSP /admin/template/layout.jsp layout.jsp:2:5：找不到带有此 URI 的标记库。可能的原因可能是 URI 不正确，或者在解析 .tld 文件期间出现错误。<%@ taglib uri="http://tiles.apache.org/tags-tiles" prefix="tiles"%> ^----^ layout.jsp:2:5: 找不到标签库URI。可能的原因可能是 URI 不正确，或者在解析 .tld 文件期间出现错误。<%@ taglib uri="http://tiles.apache.org/tags-tiles" 前缀="tiles"%> ^----^

```
 at weblogic.servlet.jsp.JavelinxJSPStub.reportCompilationErrorIfNeccessary(JavelinxJSPStub.java:226)
    at weblogic.servlet.jsp.JavelinxJSPStub.compilePage(JavelinxJSPStub.java:162)
    at weblogic.servlet.jsp.JspStub.prepareServlet(JspStub.java:256)
    at weblogic.servlet.jsp.JspStub.prepareServlet(JspStub.java:216)
    at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:243)
    at weblogic.servlet.internal.ServletStubImpl.onAddToMapException(ServletStubImpl.java:416)
    at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:326)
    at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:183)
    at weblogic.servlet.internal.RequestDispatcherImpl.invokeServlet(RequestDispatcherImpl.java:523)
    at weblogic.servlet.internal.RequestDispatcherImpl.forward(RequestDispatcherImpl.java:253)
    at org.apache.tiles.servlet.context.ServletTilesRequestContext.forward(ServletTilesRequestContext.java:241)
    at org.apache.tiles.servlet.context.ServletTilesRequestContext.dispatch(ServletTilesRequestContext.java:222)
    at org.apache.tiles.renderer.impl.TemplateAttributeRenderer.write(TemplateAttributeRenderer.java:44)
    at org.apache.tiles.renderer.impl.AbstractBaseAttributeRenderer.render(AbstractBaseAttributeRenderer.java:106)
    at org.apache.tiles.impl.BasicTilesContainer.render(BasicTilesContainer.java:670)
    at org.apache.tiles.impl.BasicTilesContainer.render(BasicTilesContainer.java:690)
    at org.apache.tiles.impl.BasicTilesContainer.render(BasicTilesContainer.java:644)
    at org.apache.tiles.impl.BasicTilesContainer.render(BasicTilesContainer.java:627)
    at org.apache.tiles.impl.BasicTilesContainer.render(BasicTilesContainer.java:321)
    at org.springframework.web.servlet.view.tiles2.TilesView.renderMergedOutputModel(TilesView.java:124)
    at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)
    at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1157)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:927)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:827)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
    at weblogic.servlet.internal.StubSecurityHelper$ServletServiceAction.run(StubSecurityHelper.java:227)
    at weblogic.servlet.internal.StubSecurityHelper.invokeServlet(StubSecurityHelper.java:125)
    at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:300)
    at weblogic.servlet.internal.TailFilter.doFilter(TailFilter.java:26)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:311)
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:116)
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:113)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:101)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:113)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:45)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:182)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:173)
    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56)
    at com.cccis.consumer.security.CrossScriptingFilter.doFilter(CrossScriptingFilter.java:29)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56)
    at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.wrapRun(WebAppServletContext.java:3715)
    at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.run(WebAppServletContext.java:3681)
    at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:321)
    at weblogic.security.service.SecurityManager.runAs(SecurityManager.java:120)
    at weblogic.servlet.internal.WebAppServletContext.securedExecute(WebAppServletContext.java:2277)
    at weblogic.servlet.internal.WebAppServletContext.execute(WebAppServletContext.java:2183)
    at weblogic.servlet.internal.ServletRequestImpl.run(ServletRequestImpl.java:1454)
    at weblogic.work.ExecuteThread.execute(ExecuteThread.java:209)
    at weblogic.work.ExecuteThread.run(ExecuteThread.java:178) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-19T18:49:50.073

这令人沮丧！我通过从tiles-jsp-2.1.2.jar 中提取titles-jsp.tld 并将其复制到/WEB-INF 目录来解决此问题，然后将taglib 声明添加到我的web.xml！啊啊啊！网络逻辑！

```
<jsp-config>
    <taglib>
        <taglib-uri>http://tiles.apache.org/tags-tiles</taglib-uri>
        <taglib-location>/WEB-INF/tiles-jsp.tld</taglib-location>
    </taglib>
</jsp-config> 
```

希望这可以解决您的问题，也可以解决我的问题。（我必须为 Spring MVC 标签做同样的事情！）

# python - 将 ctime (like) 时间戳转换为 tz 感知日期时间实例

> ID：14968288
> 
> 赞同：1
> 
> 时间：2013-02-19T21:58:57.617
> 
> 标签：python, datetime

我有以下格式的时间戳

```
"Sat Feb 06 07:00:13 -0800 2010" 
```

将这种时间戳转换为 tz 感知日期时间实例的惯用/pythonic 方式是什么？...我已经摆弄了时间戳的单个部分，但看起来都很丑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:03:59.477

您无法使用 解析时区`datetime`。但是您可以改用该`dateutil.parser`模块，如下所示。它返回一个`datetime.datetime`对象。

```
>>> dateutil.parser.parse('Sat Feb 06 07:00:13 -0800 2010')
datetime.datetime(2010, 2, 6, 7, 0, 13, tzinfo=tzoffset(None, -28800)) 
```

公平地说，请参阅这个[完整的答案](https://stackoverflow.com/q/14958976/2009616)。

# javascript - 指定时间的 Javascript 运行循环

> ID：14968289
> 
> 赞同：9
> 
> 时间：2013-02-19T21:58:57.277
> 
> 标签：javascript, timing

我有一个与电话程序接口并呼叫人的功能。我想知道，有没有一种方法可以在一定时间内给人们打电话？

我想运行一个循环，如：

```
while(flag = 0){
    call(people);

    if(<ten minutes have passed>){
        flag = 1;
    }
} 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-19T22:01:41.477

你可能想要这个`setTimeout()`功能。

像这样的东西应该可以工作（未经测试）：

```
var keepCalling = true;
setTimeout(function () {
    keepCalling = false;
}, 60000);

while (keepCalling) {
    callPeople();
} 
```

如果您遇到 setTimeout() 问题的另一种方法：

```
var startTime = Date.now();
while ((Date.now() - startTime) < 60000) {
    callPeople();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:03:45.780

您应该编写如下内容，

```
while(flag == 0){
   call(people);
}
setTimeout(function(){flag=1},60000); 
```

# javascript - jQuery添加不适用于HTML

> ID：14968290
> 
> 赞同：2
> 
> 时间：2013-02-19T21:59:04.670
> 
> 标签：javascript, jquery

在[jQuery`add`文档](http://api.jquery.com/add/)中，它列出了一个`add(html)`将参数描述为的重载`html`：

> 要添加到匹配元素集的 HTML 片段。

由于已经有一个`add(element)`重载，我假设这意味着您将一个 HTML 字符串传递给它，如下所示：

```
var set = $();
set.add("<div></div>");
document.write(set.length); // prints 0 
```

但是，[当此代码运行时](http://jsfiddle.net/s2zQr/)，它对 jQuery 包装集没有影响。我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:04:09.063

您必须将返回设置为`add`如下`set`所示，

`set = set.add("<div></div>");`

`.add`返回您可以链接的整理后的 jQuery 对象，它并没有真正将其添加到原始对象中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:04:50.873

如果您在一行中定义它，它工作正常：http: [//jsfiddle.net/s2zQr/3/](http://jsfiddle.net/s2zQr/3/)

```
var set = $().add("<div></div>");
document.write(set.length); 
```

正如@Pavel Chernov 指出的那样...... .add() 方法创建了一个新集合（这就是您的计数从未更新的原因）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T22:05:03.550

> 以下将不会保存添加的元素，因为 .add() 方法会创建一个新集合，并保持 pdiv 中的原始集合不变：
> 
> ```
> var pdiv = $("p");
> pdiv.add("div"); // WRONG, pdiv will not change 
> ```

所以你的集合还是空的

# cuda - 将符号地址复制到符号

> ID：14968293
> 
> 赞同：1
> 
> 时间：2013-02-19T21:59:11.590
> 
> 标签：cuda

我想从主机设置一个指向符号地址的符号指针。就像是：

```
__device__ float * symbolPtr;   // address of symbol[3]
__device__ float symbol[5];

cudaGetSymbolAddress( &symbolPtr, symbol[3] ); 
```

我只用它来获取主机的设备地址。但是没有提到它不能设置符号变量。

这是另一种方法：

```
cudaMemcpytoSymbol(&symbolPtr, &symbol[3], sizeof(void*), 0, cudaMemcpyDeviceToDevice); 
```

我怀疑其中任何一个都行得通。有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T23:43:08.073

这种方法对我有用。可能有更好的方法。

```
#include <stdio.h>
#define N 5
#define Q 3

#define cudaCheckErrors(msg) \
    do { \
        cudaError_t __err = cudaGetLastError(); \
        if (__err != cudaSuccess) { \
            fprintf(stderr, "Fatal error: %s (%s at %s:%d)\n", \
                msg, cudaGetErrorString(__err), \
                __FILE__, __LINE__); \
            fprintf(stderr, "*** FAILED - ABORTING\n"); \
            exit(1); \
        } \
    } while (0)

__device__ float *symbolPtr;
__device__ float symbol[N];

__global__ void mykernel(){

  for (int i=0; i<N; i++)
    symbol[i] = (float) i;
  printf("symbol[%d] = %f\n", Q, *symbolPtr);

}

int main(){

  float *temp;
  cudaGetSymbolAddress((void **)&temp, symbol);
  cudaCheckErrors("cudaGetSymbolAddress fail");
  temp += Q;
  cudaMemcpyToSymbol(symbolPtr, &temp, sizeof(float *));
  cudaCheckErrors("cudaMemcpyToSymbol fail");

  mykernel<<<1,1>>>();
  cudaDeviceSynchronize();
  cudaCheckErrors("kernel fail");

  return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:46:37.853

静态方法是：

```
__device__ float symbol[5];
__device__ float * symbolPtr= &symbol[3]; 
```

# c# - 将数据保存到 .net 中的文件时的良好编码习惯

> ID：14968296
> 
> 赞同：5
> 
> 时间：2013-02-19T21:59:15.293
> 
> 标签：c#, .net, file-io

给一点背景。

我创建了一个应用程序，允许用户保存设置，然后在以后调用设置。为此，我创建了一些可序列化的对象。我已经使用 BinaryFormatter 轻松完成了这项工作。

当我升级软件并添加新设置时，我开始遇到问题。现在我的可序列化对象不匹配，所以我必须更新文件。我已经成功完成了几个版本。但要做到这一点，我尝试反序列化文件，如果它引发异常，我尝试使用下一个版本。. .然后是下一个。. .然后是下一个。. . 直到我找到合适的。然后我必须为每个旧版本编写转换函数以将其转换为最新版本。我也创建了一个“修订”文件，所以我可以先检查他们有什么版本然后升级它，但我仍然必须保持很多不同的“版本”并为它们编写转换函数. . . 如果我继续走这条路，这对我来说似乎天生就很混乱，而且以后很容易膨胀。

必须有更好的方法来做到这一点，我只是不确定如何。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:00:27.663

您需要编写[序列化绑定](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.serializationbinder.aspx)程序来解析程序集。

对于设置，我使用 a`Dictionary<string, byte[]>`保存到文件。我序列化了字典，一切都很好。添加新设置时，如果在设置文件中找不到，我会提供默认设置。

此外，如果您要向序列化对象添加字段，则可以使用 [Optional] 进行装饰。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T22:49:58.937

这正是设置类的用途。您在 app.config 中定义默认值，然后用户可以更改它们，当您保存时，他们的更改将保存到其用户配置文件中的某个位置。当您阅读它们时，您只会得到修改后的设置。

此链接适用于 VS 2005，但它在 VS 2012 中的工作方式完全相同：http: [//msdn.microsoft.com/en-us/library/aa730869 (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/aa730869(v=vs.80).aspx)

找到 VS2012 的链接：http: [//msdn.microsoft.com/EN-US/library/k4s6c3a0 (v=VS.110,d=hv.2).aspx](http://msdn.microsoft.com/EN-US/library/k4s6c3a0(v=VS.110,d=hv.2).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-27T15:23:25.853

XML 格式适用于这种情况。您将在非常早期版本的设置文件中找到必要的旧设置。甚至旧版本也可以处理从新版本创建的 XML 设置。它不能“自动”工作，即使用 Serialize/Deserialize 之类的方法，但编写转换函数并不容易或更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T22:08:48.427

实际上，这可以通过将`[DefaultValue()]`属性添加到设置对象的较新属性来完成 - 至少对于 XML 序列化。我没有尝试过使用二进制序列化。对于 xml，这意味着它们是“可选的”，并且在加载旧版本的文件时序列化不会中断。您可以在命名空间中找到此属性`System.ComponentModel`；

```
class MySettings
{
    public int MaxNumLogins { get; set; }

    // specify the value to default to if it's not present in the serialized file...
    [DefaultValue(0)]
    public int CacheTimeoutMinutes { get; set; }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-19T22:46:00.677

除了像其他人建议的那样命名字段之外，这种事情只是需要版本号。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-19T23:03:26.253

如果你正在做二进制，你可以看看 ProtoBuf-Net [http://code.google.com/p/protobuf-net/wiki/GettingStarted](http://code.google.com/p/protobuf-net/wiki/GettingStarted)，因为所有这些都涉及到版本控制等。它也非常紧凑。它也在积极开发中，如果您使用 .proto 文件可能有跨平台需求，您也可以实现这一点。

如果您希望人们能够编辑设置（在您的程序之外），那么您可以使用 XML* 序列化方法。

# javascript - 在 Angular 控制器中使用下划线

> ID：14968297
> 
> 赞同：126
> 
> 时间：2013-02-19T21:59:16.190
> 
> 标签：javascript, angularjs, underscore.js

如何在 angularjs 控制器中使用下划线库？

在这篇文章中：[AngularJS limitTo by last 2 records](https://stackoverflow.com/questions/11943130/angularjs-limitto-by-last-2-records) 有人建议将 _ 变量分配给 rootScope，以便该库可用于应用程序内的所有范围。

但我不清楚在哪里做。我的意思是它应该继续应用程序模块声明吗？IE：

```
var myapp = angular.module('offersApp', [])
            .config(['$rootScope', function($rootScope) { } 
```

但是我在哪里加载下划线库？我的索引页面上只有 ng-app 指令和对 angular-js 和下划线库的脚本引用？

`index.html`：

```
<head>
</head>
<body ng-app="offersApp">
...
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="scripts/vendor/angular.js"></script>
<script src="scripts/vendor/underscore.js"></script>
... 
```

我如何实现这一目标？

* * *

## 回答 #1

> 赞同：231
> 
> 时间：2013-02-19T22:33:22.850

当您包含下划线时，它会将自己附加到`window`对象，因此全局可用。

因此，您可以按原样从 Angular 代码中使用它。

如果您希望注入它，您也可以将其包装在服务或工厂中：

```
var underscore = angular.module('underscore', []);
underscore.factory('_', ['$window', function($window) {
  return $window._; // assumes underscore has already been loaded on the page
}]); 
```

`_`然后你可以在你的应用模块中询问：

```
// Declare it as a dependency of your module
var app = angular.module('app', ['underscore']);

// And then inject it where you need it
app.controller('Ctrl', function($scope, _) {
  // do stuff
}); 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2013-11-06T18:52:38.783

我在这里实现了@satchmorun 的建议： [https ://github.com/andresesfm/angular-underscore-module](https://github.com/andresesfm/angular-underscore-module)

要使用它：

1.  确保在项目中包含 underscore.js

    ```
    <script src="bower_components/underscore/underscore.js"> 
    ```

2.  得到它：

    ```
    bower install angular-underscore-module 
    ```

3.  将 angular-underscore-module.js 添加到您的主文件 (index.html)

    ```
    <script src="bower_components/angular-underscore-module/angular-underscore-module.js"></script> 
    ```

4.  在您的 App 定义中添加模块作为依赖项

    ```
    var myapp = angular.module('MyApp', ['underscore']) 
    ```

5.  要使用，请将作为注入依赖项添加到您的 Controller/Service 中，即可使用

    ```
    angular.module('MyApp').controller('MyCtrl', function ($scope, _) {
    ...
    //Use underscore
    _.each(...);
    ... 
    ```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2014-06-01T21:29:27.010

我用这个：

```
var myapp = angular.module('myApp', [])
  // allow DI for use in controllers, unit tests
  .constant('_', window._)
  // use in views, ng-repeat="x in _.range(3)"
  .run(function ($rootScope) {
     $rootScope._ = window._;
  }); 
```

有关. [_](https://github.com/angular/angular.js/wiki/Understanding-Dependency-Injection) _`run`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-10-16T04:52:57.617

你也可以看看这个模块的角度

[https://github.com/floydsoft/angular-underscore](https://github.com/floydsoft/angular-underscore)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-02T19:45:43.407

如果您不介意使用 lodash，请尝试[https://github.com/rockabox/ng-lodash](https://github.com/rockabox/ng-lodash)它完全包装了 lodash，因此它是唯一的依赖项，您不需要加载任何其他脚本文件，例如 lodash。

Lodash 完全超出了窗口范围，并且没有“希望”它在您的模块之前被加载。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2015-04-18T04:24:11.140

你可以使用这个模块-> [https://github.com/jiahut/ng.lodash](https://github.com/jiahut/ng.lodash)

这是`lodash`为了`underscore`

# php - Overriding Kohana_Exception::_handler() for Production - 3.3

> ID：14968298
> 
> 赞同：5
> 
> 时间：2013-02-19T21:59:19.780
> 
> 标签：php, exception-handling, kohana

I am using Kohana 3.3 and I read in this [forum post](http://forum.kohanaframework.org/discussion/10791/changes-to-custom-error-handling-in-3-3/p1).

It says that to prevent stack traces from being shown to the end users, I need to override Kohana_Exception::_handler() to do something different with the errors that percolate up. Does that mean overriding `Kohana_Exception` and adding the following function?

```
public static function _handler(Exception $e)
{
    try
    {
        // Log the exception
        Kohana_Exception::log($e);

        // Generate the response
        //instead of below line:
        //$response = Kohana_Exception::response($e);
        $response = //what do I do here, return a 404 page or custom 500 page?
        return $response;
    }

    //rest of function
} 
```

If so, what do I return there?

EDIT:

bootstrap.php

```
/**
 * Attach the file write to logging. Multiple writers are supported.
 */
Kohana::$log->attach(new Log_File(APPPATH.'logs'));

/**
 * Attach a file reader to config. Multiple readers are supported.
 */
Kohana::$config->attach(new Config_File);

/**
 * Attach customer error handler if we are in production
 */
if(Kohana::$environment == Kohana::PRODUCTION || Kohana::$environment == Kohana::STAGING)
{
    set_exception_handler(array('My_Exception', 'handler'));
    throw new Exception('text'); //this works, if removed however my  exception handler does not do anything
} 
```

My_Exception.php (in classes/My/Exception.php)

```
<?php   
    class My_Exception extends Kohana_Exception 
    {
        public static function handler(Exception $e)
        {
            try 
            {
                // Log the exception
                Kohana_Exception::log($e);

                // Let's try and load an error View             
                $class = get_class($e);

                if($class == 'HTTP_Exception_404')
                {
                    $view = View::factory('errors/404');
                    $view->set('error_code', 404);
                }
                else
                {
                    $view = View::factory('errors/general');
                    $view->set('error_code', $e->getCode()); // alternatively use $e->getCode()
                    $view->set('error_message', $e->getMessage()); // alternatively use $e->getMessage();
                }

                // Let's render the output and send it to the browser
                $response = $view->render();
                echo $response;
            }
            catch (Exception $e)
            {
                /**
                 * Things are going *really* badly for us, We now have no choice
                 * but to bail. Hard.
                 */
                // Clean the output buffer if one exists
                ob_get_level() AND ob_clean();

                // Set the Status code to 500, and Content-Type to text/plain.
                header('Content-Type: text/plain; charset='.Kohana::$charset, TRUE, 500);

                // This will output the Exceptiones error message
                // You may want to display something else
                echo $e->getMessage();

                exit(1);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-20T08:43:50.843

I have actually investigated quite a bit further this issue and rewritten my asnwer from scratch now that I have a more complete understanding of Kohana's behaviour in this area.

To achieve what you're after you need to do two things:

1.  Change the default error View (in `APPPATH/bootstrap.php`):

    ```
    /**
     * Change default error View
     */
    if(Kohana::$environment == Kohana::PRODUCTION || Kohana::$environment == Kohana::STAGING)
    {
        Kohana_Exception::$error_view = 'errors/general';
    } 
    ```

    **Note** that your template file has to use the same (and only those) variable names as Kohana's native one, i.e.:

    *   $class
    *   $code
    *   $message
    *   $file
    *   $line
    *   $trace

  2\. Create custom HTTP error pages following [the tutorial you linked to](http://kohanaframework.org/3.3/guide/kohana/tutorials/error-pages#extending-the-httpexception-classes) in the comments.

By following these steps you assure that:

*   You have your own view for all Kohana's error pages.
*   You can have custom views for different HTTP errors.
*   You don't have to override Kohana's default Exception Handler (which, as this exercise proved, isn't exactly simple to implement).

I have tested the above approach and it worked like a charm for me.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-01T21:48:47.077

I just set the Kohana_Exception::$error_view at the bootstrap file, and created the corresponding view, nothing else was necessary, all errors have redirected auto-magically...

# python - SQLAlchemy & PassLib

> ID：14968300
> 
> 赞同：6
> 
> 时间：2013-02-19T21:59:24.473
> 
> 标签：python, hash, passwords, sqlalchemy, pyramid

***tl;dr -- 在使用 SQLAlchemy 将密码插入 MySQL 数据库之前，如何使用 Python 端库（如 PassLib）对密码进行哈希处理？***

好吧，所以我一直在我的桌子上敲了一两天试图弄清楚这一点，所以它是这样的：

我正在使用 Pyramid/SQLAlchemy 编写一个 Web 应用程序，并且我正在尝试与我的 MySQL 数据库的用户表交互。

最终，我想做以下事情：

将密码与哈希进行比较：

```
if user1.password == 'supersecret' 
```

插入新密码：

```
user2.password = 'supersecret' 
```

我希望能够在密码进入数据库之前使用 PassLib 对其进行哈希处理，而且我不太喜欢使用内置的 MySQL SHA2 函数，因为它没有加盐。

但是，只是为了尝试一下，我确实使用 SQL 端函数进行了这项工作：

```
from sqlalchemy import func, TypeDecorator, type_coerce
from sqlalchemy.dialects.mysql import CHAR, VARCHAR, INTEGER
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy import Column

class SHA2Password(TypeDecorator):
  """Applies the SHA2 function to incoming passwords."""
  impl = CHAR(64)

  def bind_expression(self, bindvalue):
    return func.sha2(bindvalue, 256)

  class comparator_factory(CHAR.comparator_factory):
    def __eq__(self, other):
      local_pw = type_coerce(self.expr, CHAR)
      return local_pw == func.sha2(other, 256)

class User(Base):
  __tablename__ = 'Users'
  _id = Column('userID', INTEGER(unsigned=True), primary_key=True)
  username = Column(VARCHAR(length=64))
  password = Column(SHA2Password(length=64))

  def __init__(self, username, password):
    self.username = username
    self.password = password 
```

[这是从http://www.sqlalchemy.org/trac/wiki/UsageRecipes/DatabaseCrypt](http://www.sqlalchemy.org/trac/wiki/UsageRecipes/DatabaseCrypt)的示例 2 复制而来的

这样就可以了，并允许我使用内置的 MySQL SHA2 函数（通过调用`func.sha2()`）并完全按照我的意愿行事。但是，现在我试图在 Python 端用 PassLib 替换它。

PassLib 提供了两个功能：一个是创建新的密码哈希，另一个是验证密码：

```
from passlib.hash import sha256_crypt

new_password = sha256_crypt.encrypt("supersecret")

sha256_crypt.verify("supersecret", new_password) 
```

我不太清楚如何实际实现这一点。阅读了所有文档后，我认为它要么是 TypeDecorator 的不同形式，要么是自定义类型声明，要么是混合值，要么是混合属性。我尝试遵循[这个](https://stackoverflow.com/questions/12212636/sql-alchemy-overriding)，但这对我来说并没有真正意义，也没有实际运行建议的代码。

所以，总结一下我的问题——我如何重载`=`and`==`运算符，以便它们通过适当的散列函数运行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-09-28T14:43:23.917

来自[sqlalchemy-utils的](https://github.com/kvesteri/sqlalchemy-utils)[PasswordType](http://sqlalchemy-utils.readthedocs.org/en/latest/data_types.html#module-sqlalchemy_utils.types.password)应该最适合这个问题。它使用 passlib。从文档中截取：

> 以下用法将创建一个密码列，该列将自动将新密码散列为 pbkdf2_sha512，但仍将密码与预先存在的 md5_crypt 散列进行比较。比较密码时；数据库中的密码哈希将更新为 pbkdf2_sha512。

```
class Model(Base):
    password = sa.Column(PasswordType(
        schemes=[
            'pbkdf2_sha512',
            'md5_crypt'
        ],
        deprecated=['md5_crypt']
    )) 
```

> 验证密码很简单：

```
target = Model()
target.password = 'b'
# '$5$rounds=80000$H.............'
target.password == 'b'
# True 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-20T04:35:31.693

据我了解，您想要的是：

1.  创建帐户时加密用户的密码。使用你的盐和算法
2.  当用户登录时，以与存储密码时相同的方式对传入密码进行哈希处理
3.  在您的数据库请求中使用常规字符串比较来比较两个哈希值

所以，登录代码是这样的：

```
from passlib.hash import sha256_crypt
passHash = sha256_crypt.encrypt(typed_password)
// call your sqlalchemy code to query the db with this value (below)

// In your SQLAlchemy code assuming "users" is your users table
// and "password" is your password field
s = users.select(and_(users.username == typed_username, users.password == passHash))
rs = s.execute() 
```

rs 将是匹配用户的结果集（当然应该是零或一）。

免责声明 - 我没有测试任何这些

**编辑：** 感谢您指出 PassLib 每次运行时都使用不同的盐。在这种情况下，您最好的选择是，因为似乎没有使用 sqlalchemy 的直接方法，所以如下：

```
s=users.select(users.username == typed_username)
rs = s.execute()
userRow = rs.fetchone()
if (sha256_crypt.verify(userRow.password)):
    # you have a match 
```

此外，为了解决您的抽象请求：处理此操作的常用方法是创建一个“安全”实用程序类，以获取与传递的登录凭据匹配的用户（对象）。

您当前设置的问题是 User 构造函数有两个不同的操作目标，虽然相关，但不一定是同一件事：验证用户和获取 User 对象（例如，组中的用户列表）。在这种情况下，构造函数变得不必要的复杂。最好将该逻辑放在可以与其他安全或登录相关功能封装的地方，例如通过会话 ID 或 SSO 令牌而不是用户名/密码登录用户：

```
security.loginUser(username, password)
# or security.loginUser(single_sign_on_token), etc. for polymorphic Security
loggedInUser = security.getLoggedInUser()

... later ...
otherUser = User(username) #single job, simple, clean 
```

# sql - 在 node.js 中将 SQL 查询结果作为变量返回

> ID：14968308
> 
> 赞同：1
> 
> 时间：2013-02-19T21:59:53.537
> 
> 标签：sql, node.js

我试图获取 SQL 查询的结果，以便在我的代码中的其他地方使用它，但我只是不知道如何将它们取出。我有嵌套的函数，所以我试图通过两次调用返回，但出来的结果是无效的。

```
var users = getUsers();

function getUsers(req, res){
  dbConnect(req,res);
  return connection.query('SELECT * FROM USERS', function selectAll(err, rows, fields) {
    if (err) {
        throw err;
    }
    for (var i in rows) {
        console.log(rows[i]);
    }
    return rows;
    dbClose(req,res);
  })
} 
```

这里有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T22:06:24.367

connection.query 是一个异步函数。

`rows`仅在`selectAll`函数内可用。如果你想对这些行做一些事情，你需要从`selectAll`.

`users`将是未定义的，因为函数`getUsers`本身不返回任何内容（并且不能返回行。

而不是做

```
users = get Users();
doSomethingWithUsers(users); 
```

改为这样做：

```
getUsers();

function getUsers(req, res){
  dbConnect(req,res);
  return connection.query('SELECT * FROM USERS', function selectAll(err, rows, fields) {
    if (err) {
        throw err;
    }
    for (var i in rows) {
        console.log(rows[i]);
    }
    doSomethingWithUsers(rows);
    dbClose(req,res);
  })
} 
```

或者在 getUsers 中传递一个回调函数来传递结果。

# linux - madvise(___, ___, MADV_DONTNEED) 是否指示操作系统延迟写入磁盘？

> ID：14968309
> 
> 赞同：9
> 
> 时间：2013-02-19T21:59:54.853
> 
> 标签：linux, linux-kernel, kernel, shared-memory, mmap

假设，假设我想对一个可能非常大的文件执行顺序写入。

如果我 mmap() 一个巨大的区域并在整个区域上使用 madvise(MADV_SEQUENTIAL)，那么我可以以相对有效的方式写入内存。我已经开始工作了。

现在，为了在我编写时释放各种操作系统资源，我偶尔会在已写入的小块内存上执行 munmap()。我担心 munmap() 和 msync() 会阻塞我的线程，等待数据物理提交到磁盘。我根本不能放慢我的作家的速度，所以我需要找到另一种方式。

在已经写入的小块内存上使用 madvise(MADV_DONTNEED) 会更好吗？我想告诉操作系统将该内存延迟写入磁盘，而不是阻止我的调用线程。

madvise() 的联机帮助页有这样的说法，这是相当含糊的：

```
MADV_DONTNEED
Do  not expect access in the near future.  (For the time being, the 
application is finished with the given range, so the kernel can free
resources associated with it.)  Subsequent accesses of pages in this
range will succeed, but will result either in re-loading  of the memory
contents from the underlying mapped file (see mmap(2)) or
zero-fill-on-demand pages for mappings without an underlying file. 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-10-29T14:34:13.617

# 不！

为了自己好，远离`MADV_DONTNEED`。Linux**不会**将此作为在写回页面后将其丢弃的提示，而是立即将其丢弃。这不被认为是一个错误，而是一个深思熟虑的决定。

具有讽刺意味的是，原因是非破坏性的功能`MADV_DONTNEED`已经由 给出`msync(MS_INVALIDATE|MS_ASYNC)`，`MS_ASYNC`另一方面不启动 I/O（事实上，它什么都不做，遵循脏页写回无论如何都可以正常工作的推理），`fsync`总是阻塞，如果你超过一些模糊的限制并且被文档认为是“极其危险的”，无论这意味着什么，它`sync_file_range` *可能会阻塞。*

无论哪种方式，您都必须`msync(MS_SYNC)`，或`fsync`（都阻塞），或`sync_file_range`（可能阻塞）后跟`fsync`，否则您**将**丢失数据`MADV_DONTNEED`。如果您无法承受阻塞，可悲的是，您别无选择，只能在另一个线程中执行此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-05-14T15:00:45.507

对于最近的 Linux 内核（刚刚在 Linux 5.4 上测试过），`MADV_DONTNEED`当映射**不是 private**时，例如`mmap`没有`MAP_PRIVATE`标志，可以按预期工作。我不确定以前版本的 Linux 内核的行为是什么。

从 Linux 手册页项目手册页的 4.15 版开始`madvise`：

> 操作成功后`MADV_DONTNEED`，指定区域中内存访问的语义发生变化：后续访问该范围内的页面将成功，但会导致**从底层映射文件的最新内容重新填充内存内容（用于共享文件映射、共享匿名映射和基于 shmem 的技术（例如 System V 共享内存段）**或用于匿名私有映射的按需零填充页面。

[Linux 在Linux 4.5](https://kernelnewbies.org/Linux_4.5#Add_MADV_FREE_flag_to_madvise.282.29)`MADV_FREE`的 BSD 系统中添加了一个具有相同行为的新标志

> 如果需要，它只是将页面标记为可释放，但它不会立即释放它们，从而可以重用内存范围而不会产生再次出错页面的成本。

对于为什么`MADV_DONTNEED`私有映射可能会在未来访问时导致零填充页面，请观看[Bryan Cantrill 的咆哮](https://www.youtube.com/watch?v=bg6-LVCHmGM&feature=youtu.be&t=3518)​​，正如@Damon 的答案评论中提到的那样。剧透：它来自 Tru64 UNIX。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-07-09T14:07:21.807

如前所述，`MADV_DONTNEED`不是你的朋友。从 Linux 5.4 开始，您可以使用`MADV_COLD`它来告诉内核它应该在存在内存压力时分页该内存。这似乎正是在这种情况下想要的。

在此处阅读更多信息： [https ://lwn.net/Articles/793462/](https://lwn.net/Articles/793462/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T02:26:42.530

首先， madv_sequential 启用主动预读，因此您不需要它。其次，os 无论如何都会懒惰地将脏的文件烘焙内存写入磁盘，即使你什么也不做。但是 madv_dontneed 会指示它立即释放内存（你称之为“各种操作系统资源”）。第三，不清楚顺序写入的映射文件有什么优势。只需 write(2) （但使用缓冲区 - 手动或 stdio），您可能会得到更好的服务。

# ios - 自动导入 iTunes Connect 崩溃报告

> ID：14968312
> 
> 赞同：2
> 
> 时间：2013-02-19T22:00:00.177
> 
> 标签：ios, app-store-connect

Apple 支持下载销售数据的脚本，但我找不到 iTunes Connect 应用程序崩溃的任何内容。我只是没看到吗？

有谁知道从 iTunes Connect 为我的应用程序自动下载崩溃报告的脚本/方法？

# java - 为什么布尔 TRUE 不是 TRUE？

> ID：14968315
> 
> 赞同：2
> 
> 时间：2013-02-19T22:00:18.707
> 
> 标签：java, boolean

我在调试我的 android 应用程序时发现了奇怪的行为。

**有表达：**

```
if (r == true) 
```

其中 var`r`具有值`true`，但整个语句是错误的。我尝试使用对象`Boolean`和原始类型`boolean`。

我确定我犯了一些基本错误。

这是调试器的屏幕。

![在此处输入图像描述](../Images/42d63fd2ca0652635c75265e89792703.png)

**编辑：**

我正在使用`java.lang.Boolean`.

方法`isSyncRequired`返回`Boolean.TRUE`并在 if-else 块中进行比较。

```
if(isSyncRequired(s))
if (r)
if (r == true) 
```

不工作。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-19T22:02:03.287

因为您使用的是大写字母 B `Boolean`，它是一个对象，所以`==`使用引用相等语义。

你应该做的只是

```
if (r) 
```

无需测试它是否等于 true。或内联它：

```
if (isSyncRequired(s)) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:03:02.477

`==`通过引用进行比较。您正在将一个`Boolean`对象与一个`boolean`值进行比较。

改为使用`if (r)`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T23:13:15.203

您应该将`Boolean`值拆箱。尝试

```
if (r.booleanValue()) 
```

或者

```
if (r.booleanValue() == true) 
```

# java - HTTP 状态 500 - Servlet Dispatcher 的 Servlet.init() 抛出异常

> ID：14968318
> 
> 赞同：6
> 
> 时间：2013-02-19T22:00:40.643
> 
> 标签：java, spring, eclipse, spring-mvc, tomcat7

当我尝试运行这个简单的 html 表单时：

```
 <html>
       <head>
        <title>Enter a new Page</title>
       </head>

       <body>

          <div id="editPresPage">
             <form action="editPresPage.do" method="post"> 
            <label>Enter Page ID</label><input type="text" name="page_id"/>
            <label>Enter Header1</label><input type="text" name="h1"/>
            <label>Enter Header2</label><input type="text" name="h2"/>
            <label>Enter Header3</label><input type="text" name="h3"/>
            <label>Enter Header4</label><input type="text" name="h4"/>            
            <label>Enter Page Text</label><input type="text" name="page_text"/>

            <input type="submit" value="Add New Page"/>
         </form>              
          </div>

       </body>
    </html> 
```

我收到错误 HTTP Status 500 - Servlet.init() for servlet Dispatcher 在我的浏览器中抛出异常。

在我的命令行窗口（当我运行 tomcat 的 start.batch 文件时打开）我收到以下错误：

> log4j：警告找不到记录器的附加程序（org.springframework.web.servlet.dispatcherservlet）

我的 Dispatcher-servlet.xml 文件：

```
<beans xmlns="http://www.springframework.org/schema/beans" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:p="http://www.springframework.org/schema/p" 
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans 
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-3.0.xsd">       

        <import resource="/application.xml"/>

        <bean name="/editPresPage.do"
                class="my.pack.webTier.control.EditPresPageController" >
            <property name="page_manager_service" ref="page_manager_service"/>
        </bean> 

       <!--  I also tried using with annotations -->    
        <!-- <context:component-scan base-package="my.pack"/> -->        

</beans> 
```

我的 web.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
         version="2.5">

    <servlet>
       <servlet-name>Dispatcher</servlet-name>
       <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
       <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
       <servlet-name>Dispatcher</servlet-name>
       <url-pattern>*.do</url-pattern>
</servlet-mapping>

    <!-- Tomcat configuration -->
    <Context path="/myWebApp" docBase="../tomcat\work\Catalina\localhost\mywebapptomcat\work\Catalina\localhost\mywebapp">
    <Loader
    loaderClass="org.springframework.instrument.classloading.tomcat.TomcatInstrumentableClassLoader"/>
    </Context>

</web-app> 
```

那就是我的控制器：

```
package my.pack.webTier.control;

import my.pack.dataAccessTier.domain.Presentation_page;
import my.pack.serviceTier.services.Page_manager_service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.servlet.ModelAndView;

//@Controller
public class EditPresPageController {

    //@Autowired
    private Page_manager_service page_manager_service;

    public void setPage_manager_service(Page_manager_service page_manager_service) {
        this.page_manager_service = page_manager_service;
    }

    @RequestMapping("/editPresPage")
    public ModelAndView EditPresPage(@RequestParam("page_id") int page_id,
                                     @RequestParam("h1") String h1_value,
                                     @RequestParam("h2") String h2_value,
                                     @RequestParam("h3") String h3_value,
                                     @RequestParam("h4") String h4_value,
                                     @RequestParam("page_text") String page_text)

    {
        Presentation_page new_page=new Presentation_page(page_id,h1_value,h2_value,
                h3_value,h4_value,page_text);

        page_manager_service.create_new_page(new_page);

        return new ModelAndView("/thanks.html");

    }

} 
```

堆栈跟踪异常：

```
javax.servlet.ServletException: Servlet.init() for servlet Dispatcher threw exception
    org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002)
    org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
    org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)
    java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    java.lang.Thread.run(Thread.java:722) 
```

我正在使用 spring MVC 3.2、eclipse 3.7、springTomcat/7.0.30 并在我的项目中使用 ANT。

我已经搜索了此要求的答案 - 但没有找到。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-21T11:16:23.613

您将调度员映射到 *.do 上：

```
<servlet-mapping>
   <servlet-name>Dispatcher</servlet-name>
   <url-pattern>*.do</url-pattern>
</servlet-mapping> 
```

但是您的控制器映射到没有 .do 的 url 上：

```
@RequestMapping("/editPresPage") 
```

尝试将其更改为：

```
@RequestMapping("/editPresPage.do") 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2014-03-29T01:22:25.330

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>teste4</groupId>
    <artifactId>teste4</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <packaging>war</packaging>

    <repositories>
        <repository>
            <id>prime-repo</id>
            <name>PrimeFaces Maven Repository</name>
            <url>http://repository.primefaces.org</url>
            <layout>default</layout>
        </repository>
    </repositories>

    <dependencies>
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-impl</artifactId>
            <version>2.2.4</version>
        </dependency>

        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-api</artifactId>
            <version>2.2.4</version>
        </dependency>

        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>servlet-api</artifactId>
            <version>2.5</version>
        </dependency>
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>
        <dependency>
            <groupId>org.primefaces</groupId>
            <artifactId>primefaces</artifactId>
            <version>4.0</version>
        </dependency>
        <dependency>
            <groupId>org.primefaces.themes</groupId>
            <artifactId>bootstrap</artifactId>
            <version>1.0.9</version>
        </dependency>
        <dependency>
            <groupId>commons-fileupload</groupId>
            <artifactId>commons-fileupload</artifactId>
            <version>1.3</version>
        </dependency>

        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.27</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>4.2.7.Final</version>
        </dependency>

    </dependencies>

</project> 
```

# ios - Monotouch OwnerDrawnElement 点击事件

> ID：14968320
> 
> 赞同：0
> 
> 时间：2013-02-19T22:00:47.427
> 
> 标签：ios, xamarin.ios, monotouch.dialog

我正在使用 Monotouch.Dialog 示例项目中的 OwnerDrawnElement 示例（修改颜色，仅此而已）。

我想知道如何为每一行注册点击事件。我听说`OwnerDrawnElement`它还不够复杂，无法做到这一点。我想扩展如果，但不确定这是可能的。

选项 2：

这`MessageElement`对于我正在尝试做的事情非常有用，但是......我需要设置背景颜色，但我也不确定我该怎么做。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T09:10:00.597

你可以`OwnerDrawnElement`用这个扩展：

```
public event Action<DialogViewController, UITableView, NSIndexPath> Tapped;
public override void Selected (DialogViewController dvc, UITableView tableView, NSIndexPath path)
{
    if (Tapped != null) {
        Tapped (dvc, tableView, path);
    }
    tableView.DeselectRow (indexPath, true);
} 
```

之后可以通过以下方式设置点击事件：

```
var ownTap = new MyOwnerDrawnElement ();
ownTap.Tapped += (DialogViewController arg1, UITableView arg2, NSIndexPath arg3) => {
    Console.WriteLine ("Test");
}; 
```

# ios - 容器视图控制器 - 通知父操作

> ID：14968321
> 
> 赞同：8
> 
> 时间：2013-02-19T22:00:48.427
> 
> 标签：ios, uiviewcontroller, parentviewcontroller, childviewcontroller

假设我有一个自定义容器视图控制器 (MainViewController)，我在其中执行以下操作：

```
- (void)viewDidLoad
{
    [super viewDidLoad];        

    HomeViewController *homeVC = [[HomeViewController alloc] initWithNibName:@"HomeViewController" bundle:nil];
    [self addChildViewController:homeVC];
    [self.view addSubview:homeVC.view];

} 
```

HomeViewController 将有一个按钮，例如“go”，当按下该按钮时需要前进到下一个视图控制器。所以我需要通知 MainViewController 这个动作。做这个的最好方式是什么？

我正在使用自定义容器，因为我需要在视图控制器之间进行自定义转换。当按下“go”时，HomeViewController 上的一些视图将动画，而来自新视图控制器的视图正在动画到位。

显然，我可以给 HomeViewController 一个 MainViewController 类型的属性并以这种方式进行调用，但我希望容器视图控制器 API 有一种更简洁的方式。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-19T22:19:22.960

您可以使用委托或阻止；

**使用委托**

创建协议：

```
@protocol SomeProtocol <NSObject>
- (void)someAction; 
@end 
```

只需在 HomeViewController.h 中声明一个委托，如下所示：

```
id<SomeProtocol> delegate; 
```

然后在 MainViewController 的 viewDidLoad 中设置如下：

```
homeVC.delegate = self;
//some where in MainViewController implement the protocol method
-(void)someAction
{
    //do something
} 
```

然后当您按下 homeVC 中的按钮时，只需调用：

```
if ([self.delegate respondsToSelector:@selector(someAction)]) {
    [self.delegate someAction];
} 
```

**使用块**：

在 HomeViewController.h 中声明一个块属性：

```
typedef void (^ActionBlock)();

@property (nonatomic, copy) ActionBlock block; 
```

然后在 MainViewController ViewDidLoad 中：

```
homeVC.block = ^(){
    //do something
}; 
```

然后当您按下 homeVC 中的按钮时，只需调用：

```
self.block(); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-08-24T16:43:05.677

还有另一种方法......每个视图控制器都有一个`parentViewController`属性，所以使用它你可以做到这一点......

在`MainViewController`为您要执行的操作定义方法...

```
- (void)someMethod:(BOOL)someParam; 
```

然后在`HomeViewController`你可以做...

```
MainViewController* parent = (MainViewController*)[self parentViewController];
[parent someMethod:paramValue]; 
```

HTH :)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-02-16T08:24:11.740

这是一种非常常见的模式。`protocol`通过提供一个和一个[默认扩展](http://samwize.com/2016/10/24/swift-protocol-development-guide/)，父级将是处理操作的实际实例。

在斯威夫特 3 中：

父视图控制器：

```
protocol SomeProtocol {
    func foo()
}

extension ParentViewController: SomeProtocol {
    func foo() {
        // Parent handles it
    }
} 
```

子视图控制器：

```
 @IBAction func tapGo(_ sender: Any) {
    (parent as? SomeProtocol)?.foo()
 } 
```

# java - 用java获取文件的第一行

> ID：14968323
> 
> 赞同：0
> 
> 时间：2013-02-19T22:00:52.073
> 
> 标签：java, file

我正在尝试使用 java 获取文件的第一行，但我不确定它为什么不工作或为什么我得到我得到的错误。这是我第一次在java中尝试这个。

错误

```
Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: 16
    at getSum.main(getSum.java:33) 
```

代码

```
import java.io.BufferedInputStream;
import java.io.DataInputStream;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.File;
import java.io.FileNotFoundException;
public class getSum {

    public static void main(String[] args) {
            File file = new File("path/InputArray.txt");
            FileInputStream fis = null;
            BufferedInputStream bis = null;
            DataInputStream dis = null;
            String line = null;
            try{
                fis = new FileInputStream(file);
                bis = new BufferedInputStream(fis);
                dis = new DataInputStream(bis);

                while(dis.available() != 0){
                    line = dis.readLine();
                }
            }catch (FileNotFoundException e){
                e.printStackTrace();
            }catch (IOException e){
                e.printStackTrace();
            }
            String[] splitLine = line.split("\\s+");
            int[] numbers = new int[splitLine.length];

            for(int i = 0; i< line.length(); i++){
                try{
                    numbers[i] = Integer.parseInt(splitLine[i]);
                }catch(NumberFormatException nfe){};
            }

           int amount = 0;
           System.out.print(numbers.length);
           /*amount = sumArray(0,numbers.length,numbers.length,numbers);
           System.out.print("Total: " + amount);*/
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T22:03:19.040

看这个：

```
int[] numbers = new int[splitLine.length];
for(int i = 0; i< line.length(); i++){
    try{
        numbers[i] = Integer.parseInt(splitLine[i]);
    }catch(NumberFormatException nfe){};
} 
```

您正在使用`i`from 0 to `line.length()`... 这与`splitLine.length`. 我怀疑你的意思是：

```
for (int i = 0; i< splitLine.length; i++) { 
```

那时，由于两者`numbers`和`splitLine`具有相同的长度，您肯定不会得到`ArrayIndexOutOfBoundsException`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:04:38.433

我认为你的 for 循环条件是错误的。我认为你应该检查 splitLine.length()。

```
for(int i = 0; i< splitLine.length(); i++){
     try{
          numbers[i] = Integer.parseInt(splitLine[i]);
     }catch(NumberFormatException nfe){};
} 
```

# php - 手机进入睡眠状态后 GPS 服务进入睡眠状态

> ID：14968325
> 
> 赞同：0
> 
> 时间：2013-02-19T22:01:05.460
> 
> 标签：php, android, gps

我有一个由活动、接收器和服务组成的 android 应用程序。活动仅在安装后启动一次以设置用户名和密码并启动服务。接收器在手机启动后调用服务。发生的情况是服务在手机进入睡眠状态后一段时间进入睡眠状态，我需要它来工作时间 。我已经在一个线程中调用了网站。这就是服务

```
public class MyService extends Service {
public int indikator=0;
public String mojsadrzaj=new String();
public String pib=new String();
public String username=new String();
public String password=new String();
public String url=new String();
public URL myURL;

@Override
public IBinder onBind(Intent intent) {

    return null;
}

@Override
public void onCreate() {
super.onCreate();

Toast.makeText(this,"Service created ...",Toast.LENGTH_LONG).show();

    final SQLiteDatabase db=openOrCreateDatabase("TruckMe", MODE_PRIVATE, null);

    String idvozaca=new String();
    db.execSQL("create table if not exists vozac (id INTEGER  PRIMARY KEY AUTOINCREMENT NOT NULL, idvozaca VARCHAR(15));");
    Cursor d=db.rawQuery("select idvozaca from vozac", null);

    if(d.getCount() > 0)
    {
        d.moveToLast();
        idvozaca=d.getString(d.getColumnIndex("idvozaca"));
        mojsadrzaj=idvozaca;

    }

    final Time t=new Time();

     final Handler handler = new Handler();
        final Runnable runnable = new Runnable() {
            public void run() {

                if(indikator != 0)
                {   

                try {

                    URL myURL = new URL(url);

                    URLConnection myURLConnection = myURL.openConnection();
                    myURLConnection.connect();

                    BufferedReader in = new BufferedReader(new InputStreamReader(myURLConnection.getInputStream()));
                    String inputLine;
while ((inputLine = in.readLine()) != null) 
    System.out.println(inputLine);
    in.close();

                } 
                catch (MalformedURLException e) { 
                    // new URL() failed
                    // ...
                } 
                catch (IOException e) {   
                    // openConnection() failed
                    // ...
                }

                }
                indikator=1;
                handler.postDelayed(this, 180000);

            }
        };

    Criteria criteria = new Criteria();
    criteria.setAccuracy(Criteria.ACCURACY_FINE);
    criteria.setPowerRequirement(Criteria.POWER_LOW);

final   LocationManager m=(LocationManager) this.getSystemService(Context.LOCATION_SERVICE);

String locationprovider =m.getBestProvider(criteria,true);

        LocationListener l=new LocationListener() {

                @Override
                public void onStatusChanged(String arg0, int arg1, Bundle arg2) {
                    // TODO Auto-generated method stub

                }

                @Override
                public void onProviderEnabled(String arg0) {

                }

                @Override
                public void onProviderDisabled(String arg0) {

                }

                @Override
                public void onLocationChanged(Location arg0) {

                    String zauzetost=new String();
                     zauzetost="ZAUZET";

                    String format="MM/dd/yyyy";
                    SimpleDateFormat sdf = new SimpleDateFormat(format,Locale.US);
                    String date= sdf.format(new Date());

                t.setToNow();   

                String longitude=new String();
                String latitude=new String();
                String speed=new String();

                if((int)arg0.getSpeed()==0)
                {
                    speed="0";
                }
                else
                {
                speed=""+(((int)arg0.getSpeed()*3600)/1000);
                }
                longitude=""+  arg0.getLongitude();
                latitude=""+ arg0.getLatitude();

                String mydate = java.text.DateFormat.getDateTimeInstance().format(Calendar.getInstance().getTime());
                mydate=mydate.replaceAll("\\s","");

                url="http://www.compensatemeonline.com/truckmeonline/TruckMeOnline/S.php?id="+mojsadrzaj+"&a="+longitude+"&b="+latitude+"&c="+speed+"&d="+mydate+"&e="+date+"&f="+zauzetost;    
            Log.e("Poruka", url);

                    // TODO Auto-generated method stub

                }

            };

             runnable.run();

            m.requestLocationUpdates(locationprovider, 180000, 0, l);

        }

@Override
public int onStartCommand(Intent intent, int flags, int startId) {

   return START_STICKY;

}

@Override
public void onStart(Intent intent, int startId) {
    //Toast.makeText(this, "Service started onstart...",Toast.LENGTH_LONG).show();

}

@Override
public void onDestroy() {
super.onDestroy();
final SQLiteDatabase db=openOrCreateDatabase("TruckMe", MODE_PRIVATE, null);
db.execSQL("drop table vozac;");

} 
```

}

既然我不希望我的服务永远休眠，我应该将 m.requestLocationUpdates(locationprovider, 180000, 0, l) 减少到 60000 ，把从调用 gps 从 oncreate 到 onstartcommant 的所有内容，或者我应该做什么。

# php - phpdoc 一直告诉我我的页面级文档块不存在

> ID：14968326
> 
> 赞同：0
> 
> 时间：2013-02-19T22:01:12.090
> 
> 标签：php, phpdoc

PHPDocumenter 一直告诉我我的文件中不存在我的页面级文档块，我在线阅读了几页文档以使其工作但仍然无法正常工作，有人知道出了什么问题吗？

```
<?php
namespace Activis\Catalog\Model;

/**
* This file represents the factory for the domain object Product for the Activis catalog.
* 
* For now, this factory is simple and abstract but will slowly change into a non-static set of factory functions
* The domain model for this object is \Activis\Catalog\Model\Product
*
* @category Domain model factory
* @package  Activis.Catalog.Model
* @author   Mathieu Dumoulin
* @license  LGPL v3
* @link     http://activis.ca/
* @todo     Change the methods in the factory to not be abstract and require an instance of this class
*/
/**
* Declares the catalog's product's domain model factory
* 
* @abstract
* @static
*/
abstract class ProductFactory
{
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T14:38:21.877

页面级文档块应放在文件顶部，在命名空间声明之前

# c# - 如何将表单数据转换为 C# .Net MVC3 实体框架中的模型？

> ID：14968333
> 
> 赞同：1
> 
> 时间：2013-02-19T22:01:53.990
> 
> 标签：c#, .net, asp.net-mvc-3, model

我有如下代码

看法：

```
$("form").live('submit', function () {
var formData = $(this).toObject();

$.ajax({
  url: "../Home/Index",
  type: "POST",
  dataType: "json",
  data: formData,
  success: function (data) {<<Some handling>>
} 
```

控制器：

```
public JsonResult Index(Task task)
{
 //operations on the task object like getting data from task and setting to it.
} 
```

**任务**在这里是一个模型。这里当表单提交时，表单对象直接发送给控制器，控制器作为模型接收它。这种转换是如何发生的？我现在在表单中添加了一个文件组件

```
<input type="file" name = "file" id="file"/> 
```

并将文件属性添加到模型任务。

```
public HttpPostedFileBase file{ get; set; } 
```

但我正在获取`null`控制器中的文件。但所有其他价值都在顺利进行。

请帮帮我。如果您需要任何其他信息来正确理解我的问题，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:05:56.013

通常是模型绑定器负责将请求值转换为模型。

但在您的情况下，您似乎正在尝试使用 AJAX 发送文件。这是不支持的。原因是 jQuery 的 ajax 方法不支持。如果客户端浏览器支持，您可以使用[`HTML5 File API`](https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications)它，因为 XHR2 对象允许您将文件异步上传到服务器。这是一个例子：

```
$(document).on('submit', 'form', function () {
    var xhr = new XMLHttpRequest();
    xhr.open(this.method, this.action);
    xhr.onreadystatechange = function() {
        if (xhr.readyState == 4 && xhr.status == 200) {
            alert(xhr.responseText); // handle response.
        }
    };
    xhr.send(new FormData(this));
    return false;
} 
```

另请注意，我已使用该[`.on()`](http://api.jquery.com/on/)方法订阅提交事件，而不是[`.live()`](http://api.jquery.com/live/)已过时并已在 jQuery 1.9 中删除。

另一方面，如果您需要支持旧版浏览器，则可以使用诸如[`Fine Uploader`](http://fineuploader.com/)或的插件[`jQuery form`](http://malsup.com/jquery/form/)来完成此任务。这些插件所做的是检测浏览器的功能，如果它支持 XHR2，它将使用它，如果不支持，它将使用不同的技术（例如隐藏 iframe、flash ......）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:05:47.870

您不能直接使用 jquery ajax post 上传文件。你应该为此添加一些插件。也许你可以使用[这个插件](http://jquery.malsup.com/form/#getting-started)

[这个问题](https://stackoverflow.com/questions/14955560/asp-net-mvc-tinymce-usage)将向您展示使用此插件的起点。

另外，我也是从@DarinDimitov 的建议中学到的：）

# javascript - iframe里面的iframe不能做改变

> ID：14968334
> 
> 赞同：0
> 
> 时间：2013-02-19T22:01:56.560
> 
> 标签：javascript

我在 iframe 上有一个 iframe，我想用这段代码更改图像的 src

```
window.top.frames[0].frames[0].document.getElementById("maquina").src = "https://developer.cdn.mozilla.net/media/img/mdn-logo-sm.png"; 
```

当我尝试它时它可以工作，但我看不到页面中的变化，只有当 e 读取该元素的 .src 时才出现在代码中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:07:10.290

如果没有用于访问子 DOM 的全局方法，则无法从父框架中操作 iframe 的内容。[这里](https://stackoverflow.com/questions/5181911/access-child-iframe-dom-from-parent-page)有一个适合您需要的答案，但我将复制以下内容以供参考：

在子 iframe 中：

```
parent.childGetElementById = function (id) {return document.getElementById(id);}
parent.childLoaded(); 
```

在父级中：

```
function childLoaded() {var dom = childGetElementById('someid');} 
```

假设您实际上可以访问子页面，我建议您修改您的设计，避免使用 iframe。

*[回复评论]*

好吧，这取决于您是使用直接的 HTML 还是脚本语言（如 PHP）。如果是纯 HTML，则可以使用服务器端包含

```
<!-- #include virtual="path/to/included/file.html" --> 
```

在 PHP 中，您可以像这样包含页面

```
require('/real/path/to/included/file.php'); 
```

不要误会我的意思，iFrame 在某些特定情况下可能很有用（规避跨域源策略、oAuth 实现等）；它们经常被滥用而不是正确使用。

# c - Win32 在多大程度上支持中断？

> ID：14968337
> 
> 赞同：4
> 
> 时间：2013-02-19T22:02:06.297
> 
> 标签：c, windows, winapi, assembly, operating-system

Win32 对处理器定义之外的中断的支持程度如何？例如，x86 机器定义了至少 18 个中断，包括诸如断点陷阱 (INT 3) 之类的陷阱。英特尔将其他 19-255 个中断作为软件定义的中断保持打开状态。Windows/WinAPI 是否使用这些中的任何一个，或者它们只是开放且免费供应用程序随意使用？如果 Windows 使用它们，我在哪里可以找到相关文档？我查看了 MSDN 并找不到任何东西。

（顺便说一句，我正在做编译器、调试器和其他系统级编程，所以请不要一开始就对使用中断的可取性发表意见。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T22:28:08.250

在 Win32 应用程序中，可能只有一个常用的中断，`int 2Eh`. 它用作系统调用入口点。这类似于`int 21h`在 DOS 中。应用程序不使用其余的中断。

但是，应用程序可以通过结构化异常处理 ( `SEH`)/矢量异常处理 ( ) 处理一些 CPU 异常（和调试中断`VEH`）。如果可能的话，Windows 会捕获源自应用程序的 CPU 异常并将它们反射回应用程序（Windows 在模仿 CPU 异常模型方面并不完美）。

Windows 在内部使用设备中断，不会让应用程序干扰它们。x86 CPU 在内核运行的最高特权模式下处理中断。

如今，许多设备中断与固定中断向量无关，并且是可配置的，您需要使用诸如 PCI 之类的各种东西来查询或更改设置。

如果要直接使用设备和中断，则需要为 Windows 编写内核模式驱动程序。有 Device Driver Kit ( `DDK`) 和类似的书籍`Windows Internals`可以帮助您入门。

尽管如此，如果您正在寻找设备 XYZ 及其中断编程的详细信息，您不会在 MSDN 或 DDK 上找到所有内容或很多内容，因为您需要特定于硬件的信息，这些信息超出了 Microsoft 的控制范围。内核提供了执行 I/O 和处理中断所需的功能，但最终取决于设备驱动程序以一种或另一种方式使用它们。

# jquery - 我在“全屏”时在我的网站中平均划分了三个垂直元素，我怎样才能让我的中心元素“占主导地位”？

> ID：14968338
> 
> 赞同：1
> 
> 时间：2013-02-19T22:02:05.737
> 
> 标签：jquery, html, css, resize, flexbox

我喜欢中心元素占据所有视口空间，当屏幕最小化时，拖到一半。（两边的两个元素都只是美学）是否有任何属性可以在 CSS 或 Jquery 中实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:39:25.517

使用媒体查询。[在这里](https://stackoverflow.com/questions/4296012/hide-div-if-screen-is-smaller-than-1024)查看答案。如果您需要支持旧版浏览器（请参阅 Google），您可以提供 javascript 后备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T02:19:25.903

像这样的事情怎么样（使用媒体查询来检测浏览器窗口的宽度）：

```
#leftBox, #centerBox, #rightBox{
    width:33%; 
    float:left; 
    background:#fccbae; 
    border:1px solid red;
    min-height:500px;
    height:auto;
}

/* Smaller than standard 960 */
@media only screen and (max-width: 979px) {

    #centerBox{width:100%;}
    #leftBox, #rightBox{display:none;}

} 
```

```
<div id="leftBox"></div>
<div id="centerBox"></div>
<div id="rightBox"></div> 
```

# vbscript - 如何在VBScript中将字符串的第一个字母大写

> ID：14968342
> 
> 赞同：4
> 
> 时间：2013-02-19T22:02:20.033
> 
> 标签：vbscript

我在这里阅读了一篇非常有帮助的帖子[如何在 JavaScript 中将字符串的第一个字母设为大写？](https://stackoverflow.com/questions/1026069/capitalize-the-first-letter-of-string-in-javascript)我很好奇使用 VBScript 的一个好的解决方案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-19T22:38:39.330

```
>> s = "first word of string"
>> WScript.Echo UCase(Left(s, 1)) &  Mid(s, 2)
>>
First word of string 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-02-01T10:13:13.553

```
str = "mY nAME iS sACHIN"

arrStr = split(str," ")

For i=0 to ubound(arrStr)

 word = lcase(trim(arrStr(i)))
 word = replace(word,mid(word,1,1),chr(asc(mid(word,1,1))-32),1,1)
 str1 = str1 & word & " "
next

msgbox trim(str1) 
```

输出：我的名字是萨钦

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-18T05:46:38.463

```
str = "mY nAME iS sACHIN"
arrStr = split(str," ")
For i=0 to ubound(arrStr)
 word = lcase(trim(arrStr(i))) 
 word = replace(word,mid(word,1,1),ucase(mid(word,1,1)),1,1)                  
 str1 = str1 & word & " "
 next
msgbox trim(str1) 
```

# libspotify - libspotify sp_search_type

> ID：14968343
> 
> 赞同：1
> 
> 时间：2013-02-19T22:02:21.510
> 
> 标签：libspotify

执行 sp_search_create 时，定义了 sp_search_type 的参数

```
typedef enum sp_search_type {
  SP_SEARCH_STANDARD  = 0,
  SP_SEARCH_SUGGEST = 1,
} sp_search_type; 
```

我看不出结果有任何变化。有没有建议的方法来处理这个与普通搜索不同的方法？例如，如果我们正在实现自动完成，或者我在这里遗漏了什么。

谢谢，

# c# - 如何采取概率步骤？

> ID：14968345
> 
> 赞同：0
> 
> 时间：2013-02-19T22:02:32.193
> 
> 标签：c#, math, simulated-annealing

我正在设计一个递归搜索函数，在某些条件下，它将正常递归，而在其他条件下，必须以概率 e^(E/Temperature) 递归。除递归步骤外，所有代码都已完成，因为我无法弄清楚如何根据一定的概率执行某些操作

```
Node Search(Node start)
{//first, calculate temperature. count will keep timestep
    count++;
    double temperature = 1000 * (Math.Pow(.995,count));//CALCULATES TEMP

    for (int i = 0; i < start.state.Length; i++)
    {
        string temp = StateReturn(start.state, i);
        if (temp.Length > 1 && temp != start.state 
            &&visited.Contains(temp) == false)
        {
            list.Add(new Node(start, temp));
            visited.Add(temp);
        }
    }
    //add all relevant nodes to list.
    Random gen = new Random();
    int rand = gen.Next(list.Count);//think this should work
    //random number has been taken. now just to pull rand node from list 
    Node next = list.ElementAt(rand);
    list.RemoveAt(rand);
    double E = -(next.wrongNum - start.wrongNum); //we want less wrong 
    // if next has 
    if (E> 0)
    {
        //standard recursion

    }
    else //recurse with probability e^(E/t)
    {

    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-19T22:23:31.027

> 我正在设计一个递归搜索函数，在某些条件下，它将正常递归，而在其他条件下，必须以概率 e^(E/Temperature) 递归。除递归步骤外，所有代码都已完成，因为我无法弄清楚如何根据一定的概率执行某些操作

让我们通过使其更笼统来简化您的问题。

> 我正在设计一个函数，它将用概率`p`（where `0 <= p <= 1`）做一件事，用概率做另一件事`1 - p`。我无法弄清楚如何根据一定的概率执行某些事情。

选择一个介于 0 和 1 之间的随机数。您已经`Random`在变量中有一个对象`gen`，所以只需调用

```
double result = gen.NextDouble(); // Produce a random double between zero and one. 
```

现在您可以使用它来做出选择：

```
if (result <= p)
    DoSomething();
else
    DoSomethingElse(); 
```

`DoSomething()`是用概率完成的`p`，`DoSomethingElse()`也是用概率完成的`1 - p`。

说得通？

# java - 从 Lucene 3.6 更新到 Lucene 4.1 时，字段似乎已成为二进制字段

> ID：14968346
> 
> 赞同：0
> 
> 时间：2013-02-19T22:02:36.670
> 
> 标签：java, lucene

将代码从 Lucene 3.6 转换为 Lucene 4.1 后奇怪的测试失败

```
public void testIndexPuid() throws Exception {

        addReleaseOne();
        RAMDirectory ramDir = new RAMDirectory();
        createIndex(ramDir);

        IndexReader ir = IndexReader.open(ramDir);
        Fields fields = MultiFields.getFields(ir);
        Terms terms = fields.terms("puid");
        TermsEnum termsEnum = terms.iterator(null);
        termsEnum.next();
        assertEquals("efd2ace2-b3b9-305f-8a53-9803595c0e38", termsEnum.term());
    } 
```

返回：

Expected :efd2ace2-b3b9-305f-8a53-9803595c0e38 Actual :[65 66 64 32 61 63 65 32 2d 62 33 62 39 2d 33 30 35 66 2d 38 61 35 33 2d 39 38 30 33 35 39 35 63 30 65 33 38 ]

似乎将该字段添加为二进制字段而不是文本字段，但我检查并使用已弃用的字段添加该字段

新字段（“puid”，值，Field.Index.NOT_ANALYZED_NO_NORMS，新关键字分析器（））

所以不应该像以前一样工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T10:26:31.640

Doh，我的错误缺少 utf8ToString()，行应该是：assertEquals("efd2ace2-b3b9-305f-8a53-9803595c0e38", termsEnum.term().utf8ToString()); ——保罗·泰勒 2 月 19 日 22:20

# asp.net-mvc - iTextSharp 在内存中创建文件导致文件损坏

> ID：14968347
> 
> 赞同：1
> 
> 时间：2013-02-19T22:02:44.237
> 
> 标签：asp.net-mvc, itextsharp

我正在尝试使用 iTextSharp 在 MVC 中创建一个 pdf 文件。我确实有以下简单的用例。正在创建文件，但是当我打开 PDF 时出现错误**文件已损坏，无法打开文件**。任何想法/帮助？

我的控制器代码如下

```
public FileStreamResult GetPdfMemory()
{
            iTextSharp.text.Document doc = new iTextSharp.text.Document();

            MemoryStream mem = new MemoryStream();
            PdfWriter pdfWriter = PdfWriter.GetInstance(doc, mem);
            //pdfWriter.CloseStream = false;

            doc.Open();
            doc.Add(new Paragraph("Charts"));

            mem.Position = 0;

            FileStreamResult fileStreamResult = new FileStreamResult(mem, System.Net.Mime.MediaTypeNames.Application.Pdf)
            {
                FileDownloadName = "chart_" + ".PDF"
            };

            return fileStreamResult;
} 
```

查看：@Html.ActionLink("Pdf Memory", "GetPdfMemory", "Home", null, new { id = "download"})

仅供参考：当我尝试使用 FileStream 而不是 MemoryStream 时，一切正常。但我需要使用内存流创建 PDF。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T08:11:04.970

您操作 ( `mem.Position = 0`) 并使用 ( `new FileStreamResult(mem, ...)`)`MemoryStream`之前的信号 iTextSharp 它可以完成文档。因此，根据内存流中数据的隐式销毁或数据的使用是否`Document`首先`PdfWriter`出现，您可能有一个 PDF 缺少其关闭部分或关闭部分（在您重新定位内存流后写入）覆盖开始的数据。

要向 iTextSharp 发出它可以完成文档的信号，请`doc.Close()`在操作内存流之前调用，或者`Document`在`using`块中使用，例如：

```
using (MemoryStream ms = new MemoryStream()) {
  // step 1
  using (Document document = new Document()) {
    // step 2
    PdfWriter.GetInstance(document, ms);
    // step 3
    document.Open();
    // step 4
    document.Add(new Paragraph("HelloWorldMemory"));      
  }
  HttpContext.Current.Response.BinaryWrite(ms.ToArray());
} 
```

*（无耻地从 Webified iTextSharp 示例中的示例 HelloWorldMemory.cs 复制）[用于](http://kuujinbo.info/iTextInAction2Ed/index.aspx)[iText](http://kuujinbo.info/iTextInAction2Ed/index.aspx?ch=Chapter01&ex=HelloWorldMemory) in [Action — 第 2 版](http://itextpdf.com/book/)）*

`using`隐式使用会导致`Document`关闭。

# python - 方法的文本参考

> ID：14968349
> 
> 赞同：1
> 
> 时间：2013-02-19T22:03:01.640
> 
> 标签：python, serialization, pickle, apscheduler

说我有以下内容：

```
def func():
    print 'this is a function and not a method!!!'

class Test:
    def TestFunc(self):
        print 'this is Test::TestFunc method' 
```

我有以下功能（取自[https://bitbucket.org/agronholm/apscheduler/src/d2f00d9ac019/apscheduler/util.py](https://bitbucket.org/agronholm/apscheduler/src/d2f00d9ac019/apscheduler/util.py)）：

```
def get_callable_name(func):
    """
    Returns the best available display name for the given function/callable.
    """
    f_self = getattr(func, '__self__', None) or getattr(func, 'im_self', None)
    if f_self and hasattr(func, '__name__'):
        if isinstance(f_self, type):
            # class method
            clsname = getattr(f_self, '__qualname__', None) or f_self.__name__
            return '%s.%s' % (clsname, func.__name__)
        # bound method
        return '%s.%s' % (f_self.__class__.__name__, func.__name__)
    if hasattr(func, '__call__'):
        if hasattr(func, '__name__'):
            # function, unbound method or a class with a __call__ method
            return func.__name__
        # instance of a class with a __call__ method
        return func.__class__.__name__
    raise TypeError('Unable to determine a name for %s -- '
                    'maybe it is not a callable?' % repr(func))

def obj_to_ref(obj):
    """
    Returns the path to the given object.
    """
    ref = '%s:%s' % (obj.__module__, get_callable_name(obj))
    try:
        obj2 = ref_to_obj(ref)
        if obj != obj2:
            raise ValueError
    except Exception:
        raise ValueError('Cannot determine the reference to %s' % repr(obj))
    return ref

def ref_to_obj(ref):
    """
    Returns the object pointed to by ``ref``.
    """
    if not isinstance(ref, basestring):
        raise TypeError('References must be strings')
    if not ':' in ref:
        raise ValueError('Invalid reference')
    modulename, rest = ref.split(':', 1)
    try:
        obj = __import__(modulename)
    except ImportError:
        raise LookupError('Error resolving reference %s: '
                          'could not import module' % ref)
    try:
        for name in modulename.split('.')[1:] + rest.split('.'):
            obj = getattr(obj, name)
        return obj
    except Exception:
        raise LookupError('Error resolving reference %s: '
                          'error looking up object' % ref) 
```

上述函数 -`obj_to_ref`返回给定函数对象的文本引用，并`ref_to_obj`返回给定文本引用的对象。例如，让我们试试这个`func`功能。

```
>>> 
>>> func
<function func at 0xb7704924>
>>> 
>>> obj_to_ref(func)
'__main__:func'
>>> 
>>> ref_to_obj('__main__:func')
<function func at 0xb7704924>
>>> 
```

该`func`功能工作正常。但是当尝试在 的实例上使用这些函数时`class Test`，它无法获得文本引用。

```
>>> 
>>> t = Test()
>>> 
>>> t
<__main__.Test instance at 0xb771b28c>
>>> 
>>> t.TestFunc
<bound method Test.TestFunc of <__main__.Test instance at 0xb771b28c>>
>>> 
>>> 
>>> obj_to_ref(t.TestFunc)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 11, in obj_to_ref
ValueError: Cannot determine the reference to <bound method Test.TestFunc of <__main__.Test instance at 0xb771b28c>>
>>> 
>>> 
```

`obj_to_ref`给定输入的函数以文本表示形式`t.TestFunc`出现，`__main__:Test.TestFunc`但不能使用相同的文本生成对象。

问题：

有没有一种方法`Python`可以表示一个像

```
>>> t.TestFunc
<bound method Test.TestFunc of <__main__.Test instance at 0xb771b28c>>
>>> 
```

在字符串中并从字符串中重建对象？

如果我们将地址保存`0xb771b28c`为字符串的一部分并通过取消引用该地址来重新生成对象，是否有可能？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T23:12:09.153

正如我在上面的评论中所说，问题出在`get_callable_name`. `get_callable_name(t.TestFunc)`显然`'Test.TestFunc'`是错误的。它应该是“t.TestFunc”。我添加`variable_name_in_module`并使用了它`get_callable_name`，现在代码可以工作了。底部的支票返回`True`。但是，`variable_name_in_module`这非常hackish，我找不到干净利落的方法。

如果你只需要它来处理小东西，那么这应该没问题，但请注意，`variable_name_in_module`每次调用都会导致 N 字典查找，`get_callable_name`其中 N 是模块中的变量数。

代码如下：

```
def variable_name_in_module(module, var):
    for name in dir(module):
        if getattr(module, name) == var:
            return name

def get_callable_name(func):
    """
    Returns the best available display name for the given function/callable.
    """
    f_self = getattr(func, '__self__', None) or getattr(func, 'im_self', None)
    if f_self and hasattr(func, '__name__'):
        if isinstance(f_self, type):
            # class method
            clsname = getattr(f_self, '__qualname__', None) or f_self.__name__
            return '%s.%s' % (clsname, func.__name__)
        # bound method
        return '%s.%s' % (variable_name_in_module(__import__(f_self.__module__), f_self), func.__name__)
    if hasattr(func, '__call__'):
        if hasattr(func, '__name__'):
            # function, unbound method or a class with a __call__ method
            return func.__name__
        # instance of a class with a __call__ method
        return func.__class__.__name__
    raise TypeError('Unable to determine a name for %s -- '
                    'maybe it is not a callable?' % repr(func))

def obj_to_ref(obj):
    """
    Returns the path to the given object.
    """
    ref = '%s:%s' % (obj.__module__, get_callable_name(obj))
    try:
        obj2 = ref_to_obj(ref)
        if obj != obj2:
            raise ValueError
    except Exception:
        raise ValueError('Cannot determine the reference to %s' % repr(obj))
    return ref

def ref_to_obj(ref):
    """
    Returns the object pointed to by ``ref``.
    """
    if not isinstance(ref, basestring):
        raise TypeError('References must be strings')
    if not ':' in ref:
        raise ValueError('Invalid reference')
    modulename, rest = ref.split(':', 1)
    try:
        obj = __import__(modulename)
    except ImportError:
        raise LookupError('Error resolving reference %s: '
                          'could not import module' % ref)
    try:
        for name in modulename.split('.')[1:] + rest.split('.'):
            obj = getattr(obj, name)
        return obj
    except Exception:
        raise LookupError('Error resolving reference %s: '
                          'error looking up object' % ref)

class Test:
    def TestFunc(self):
        print "test"

t = Test()
print t.TestFunc == ref_to_obj(obj_to_ref(t.TestFunc)) 
```

编辑： PS：`variable_name_in_module`如果找不到任何东西，可能应该抛出异常，尽管我不知道这是怎么发生的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T23:28:38.683

你的问题很有趣但很纠结。

1）您不应该调用在我的答案`func`中的参数，`get_callable_name(func)`
我将其替换为`X`.

2）您将部分代码放在错误的位置。

```
try:
    obj2 = ref_to_obj(ref)
    print 'obj != obj2  : ',obj != obj2
    if obj != obj2:
        raise ValueError
except Exception:
    raise ValueError('Cannot determine the reference to %s' % repr(obj))
return ref 
```

在里面无事可做`obj_to_ref()`

在我的回答中，我将它移到了这个函数之外。

3）您的代码问题的明显原因是为对象获得的引用（在我的代码中`t.TestFunc`传递给参数）是，而不是“应该”。`X``'__main__:Test.TestFunc'``'__main__:t.TestFunc'`

决定这一点的秘密步骤是在**熵**`get_callable_name()`所说的函数中。 因为is并且有一个名字 (TestFunc) 但不是一个类型的类(因为是一个实例) ， 所以指令被执行。 **`f.self``t``X``type``t`
`return '%s.%s' % (f_self.__class__.__name__, X.__name__)`**

 ****但是你把表达式写错了`f_self.__class__.__name`：它是类的名称`t`，而不是`t`它本身的名称。**

.

问题是，对于一个类（具有一个属性`__name__`）来说，Python 语言中没有任何东西可以按需提供实例的名称：一个实例与一个类的属性不同`__name__`，这会给实例的名称。

因此，由于不容易获得它，必须采用一种绕过方式。
每次需要一个未引用的名称时，绕过方法是在命名空间的所有名称中进行搜索，并针对相关对象测试相应的对象。
这就是`get__callable_name()`熵**的**作用。

.

有了这个功能，它就可以工作了。

但我想强调的是，这只是一个棘手的绕过，没有真正的基础。
我的意思是`t.TestFunc`该方法的名称是一种错觉。有一个微妙之处：没有属于实例的方法。这看起来很奇怪，但我相信这是事实。
多亏了 like 表达式，我们调用方法这一事实`t.TestFunc`导致相信`TestFunc`属于实例。实际上它属于类，Python 从一个实例到它的类来查找方法。

我没有发明任何东西，我读过它：

> 类实例具有作为字典实现的命名空间，这是搜索属性引用的第一个位置。如果在那里找不到属性，并且实例的类具有该名称的属性，则使用类属性继续搜索。如果发现类属性是用户定义的函数对象或未绑定的用户定义的方法对象，其关联类是为其启动属性引用的实例的类（称为 C）或其基之一，它转化为im_class属性为C，im_self属性为实例的绑定用户自定义方法对象。
> 
> [http://docs.python.org/2/reference/datamodel.html#new-style-and-classic-classes](http://docs.python.org/2/reference/datamodel.html#new-style-and-classic-classes)

但好吧，我认为这是另一个我会争论的故事，我没有时间参与。

只需验证以下几点：
尽管`getattr(t,"TestFunc")`给出了：
`<bound method Test.TestFunc of <__main__.Test instance at 0x011D8DC8>>`
方法 TestFunc 不在的命名空间中`t`：结果**`t.__dict__`是`{ }`**！

我只是想指出这一点，因为该函数`get_callable_name()`仅复制和模仿 Python 的明显行为和实现。
然而，真正的行为和实现是不同的。

.

在下面的代码中，我通过使用 istruction
`return '%s.%s' % ('t', X.__name__)`而不是
`return '%s.%s' % (f_self.__class__.__name__, func.__name__)` or
`return '%s.%s' % (variable_name_in_module(__import__(f_self.__module__), f_self), func.__name__)`
因为它本质上是函数的作用`get_callanle_name()`（它不使用正常的过程，它使用了狡猾）来获得良好的结果

```
def get_callable_name(X):
    """
    Returns the best available display name for the given function/callable.
    """
    print '- inside get_callable_name()'
    print '  object X arriving in get_callable_name() :\n    ',X
    f_self = getattr(X, '__self__', None) or getattr(X, 'im_self', None) 
    print '  X.__call__ ==',X.__call__  
    print '  X.__name__ ==',X.__name__
    print '\n  X.__self__== X.im_self ==',f_self
    print '  isinstance(%r, type)  is  %r' % (f_self,isinstance(f_self, type))
    if f_self and hasattr(X, '__name__'): # it is a method
        if isinstance(f_self, type):
            # class method
            clsname = getattr(f_self, '__qualname__', None) or f_self.__name__
            return '%s.%s' % (clsname, X.__name__)
        # bound method
        print '\n  f_self.__class__          ==',f_self.__class__
        print '  f_self.__class__.__name__ ==',f_self.__class__.__name__
        return '%s.%s' % ('t', X.__name__)
    if hasattr(X, '__call__'):
        if hasattr(X, '__name__'):
            # function, unbound method or a class with a __call__ method
            return X.__name__
        # instance of a class with a __call__ method
        return X.__class__.__name__
    raise TypeError('Unable to determine a name for %s -- '
                    'maybe it is not a callable?' % repr(X))

def obj_to_ref(obj):
    """
    Returns the path to the given object.
    """
    print '- obj arriving in obj_to_ref :\n  %r' % obj

    ref = '%s:%s' % (obj.__module__, get_callable_name(obj))

    return ref

def ref_to_obj(ref):
    """
    Returns the object pointed to by ``ref``.
    """
    print '- ref arriving in ref_to_obj == %r' % ref

    if not isinstance(ref, basestring):
        raise TypeError('References must be strings')
    if not ':' in ref:
        raise ValueError('Invalid reference')
    modulename, rest = ref.split(':', 1)

    try:
        obj = __import__(modulename)
    except ImportError:
        raise LookupError('Error resolving reference %s: '
                          'could not import module' % ref)

    print '  we start with dictionary obj == ',obj
    try:
        for name in modulename.split('.')[1:] + rest.split('.'):
            print '  object of name ',name,' searched in',obj
            obj = getattr(obj, name)
            print '  got obj ==',obj
        return obj
    except Exception:
        raise LookupError('Error resolving reference %s: '
                          'error looking up object' % ref)

class Test:
    def TestFunc(self):
        print 'this is Test::TestFunc method'

t = Test()

print 't ==',t

print '\nt.TestFunc ==',t.TestFunc

print "getattr(t,'TestFunc') ==",getattr(t,'TestFunc')

print ('\nTrying to obtain reference of t.TestFunc\n'
       '----------------------------------------')

print '- REF = obj_to_ref(t.TestFunc)  done'
REF = obj_to_ref(t.TestFunc)
print '\n- REF obtained: %r' % REF

print ("\n\nVerifying what is ref_to_obj(REF)\n"
       "---------------------------------")
try:
    print '- obj2 = ref_to_obj(REF)  done'
    obj2 = ref_to_obj(REF)
    if obj2 != t.TestFunc:
        raise ValueError
except Exception:
        raise ValueError('Cannot determine the object of reference %s' % REF)
print '\n- object obtained : ',obj2 
```

结果

```
t == <__main__.Test instance at 0x011DF5A8>

t.TestFunc == <bound method Test.TestFunc of <__main__.Test instance at 0x011DF5A8>>
getattr(t,'TestFunc') == <bound method Test.TestFunc of <__main__.Test instance at 0x011DF5A8>>

Trying to obtain reference of t.TestFunc
----------------------------------------
- REF = obj_to_ref(t.TestFunc)  done
- obj arriving in obj_to_ref :
  <bound method Test.TestFunc of <__main__.Test instance at 0x011DF5A8>>
- inside get_callable_name()
  object X arriving in get_callable_name() :
     <bound method Test.TestFunc of <__main__.Test instance at 0x011DF5A8>>
  X.__call__ == <method-wrapper '__call__' of instancemethod object at 0x011DB990>
  X.__name__ == TestFunc

  X.__self__== X.im_self == <__main__.Test instance at 0x011DF5A8>
  isinstance(<__main__.Test instance at 0x011DF5A8>, type)  is  False

  f_self.__class__          == __main__.Test
  f_self.__class__.__name__ == Test

- REF obtained: '__main__:t.TestFunc'

Verifying what is ref_to_obj(REF)
---------------------------------
- obj2 = ref_to_obj(REF)  done
- ref arriving in ref_to_obj == '__main__:t.TestFunc'
  we start with dictionary obj ==  <module '__main__' (built-in)>
  object of name  t  searched in <module '__main__' (built-in)>
  got obj == <__main__.Test instance at 0x011DF5A8>
  object of name  TestFunc  searched in <__main__.Test instance at 0x011DF5A8>
  got obj == <bound method Test.TestFunc of <__main__.Test instance at 0x011DF5A8>>

- object obtained :  <bound method Test.TestFunc of <__main__.Test instance at 0x011DF5A8>>
>>> 
```**

# uinavigationcontroller - SenchaTouch 2 - 使用导航视图

> ID：14968352
> 
> 赞同：0
> 
> 时间：2013-02-19T22:03:07.273
> 
> 标签：uinavigationcontroller, sencha-touch-2

我是 Sencha Touch 开发的新手，正在尝试使用它开发应用程序。我一直在阅读它的文档和示例。我想知道根据以下场景启动应用程序的最佳方法是什么。

LoginView 启动应用程序，然后是导航视图。

我正在努力弄清楚是使用 NavigationView 还是 Card（用于登录）+ Navigation View（用于休息）或任何其他方法。

如果我从 NavigationView 开始，则返回按钮会出现在顶部，我不想在第二个视图上显示。不知道如何隐藏它，所以我可以使用卡片（用于登录）+导航视图之类的东西。

帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T14:15:29.723

创建登录视图。

从您的登录视图执行您的 ajax 请求。

如果成功登录，那么您可以执行以下操作：

```
Ext.Viewport.animateActiveItem(Ext.Viewport.getComponent('mainPanel'), { type: 'slide'}); 
```

这将为您的 mainPanel 设置动画并将其滑入视图。假设您的“mainPanel”是您的导航视图。导航视图将从其默认位置开始，没有后退按钮。您现在可以将视图推送到导航视图中。

从控制器：

```
config: {
    refs: {
        mainPanel: 'main'
    },

    control: {
        "list": {
            itemtap: 'onListItemTap'
        }
    }
},

onListItemTap: function(dataview, index, target, record, e, options) {
    var myNewView = Ext.create('MyApp.view.Testview');
    this.getMainPanel().push(myNewView);
} 
```

稍后，如果需要，您可以随时切换回登录视图：

```
Ext.Viewport.setActiveItem(0); 
```

或者

```
Ext.Viewport.setActiveItem(Ext.Viewport.getComponent('MyLoginpanel')) 
```

# android - 我可以将本地文本文件逐行读入字符串数组吗？

> ID：14968355
> 
> 赞同：2
> 
> 时间：2013-02-19T22:03:14.690
> 
> 标签：android, readline, arrays, datainputstream

问题“如何逐行读取本地（res / raw）文件？” 处理类似的问题，但我无法根据那里提供的答案构建解决方案。我确实得到了一条非常有用的信息（具有 readLine 方法的 DataInputStream 类），我一直在开发者网站上对此进行研究并尝试使其工作。

我想要做的是将存储在文本文件的连续行中的信息读入字符串数组，这样第一行是第一个数组元素，第二行是下一个数组元素，等等......然后这个字符串数组将用于填充下一个打开的活动中的文本字段。这一切都发生在开关盒内（取决于情况，即选择了哪个列表项，加载了不同的文本文件）。这是我到目前为止所拥有的：

```
//Retrieve necessary text file for inputstream
InputStream buildinginfo = getResources().openRawResource(R.raw.testbuilding);
class DataInputStream extends FilterInputStream{
    protected DataInputStream(InputStream buildinginfo) {
        super(buildinginfo);
        // TODO Auto-generated constructor stub
        int i;  
        String[] building_info;
        //Assign lines of text to array
        for(i=0; i<5; i++){
            building_info[i] = buildinginfo.readLine();
        }
    }
} 
```

到目前为止，除了这些错误之外，编辑器还可以，而且我没有足够的经验来理解它们。我明白他们在说什么，但不知道如何解决。错误位于我试图设置输入流并分配值的开关盒内的部分。最重要的是，在执行 readLine 命令的行中，我得到：“- 未定义类型 DataInputStream 的方法 readLine” “- 未定义类型 InputStream 的方法 readLine”

这我不明白，因为如果我没记错的话，这里（[http://developer.android.com/reference/java/io/DataInputStream.html](http://developer.android.com/reference/java/io/DataInputStream.html)）说 DataInputStream 类有可用的 readLine 方法（我发现了关于这来自上面提到的问题）。显然我没有正确使用 DataInputStream，但我似乎无法弄清楚如何。我在这里查看了几个问题，并多次引用了上面链接的页面。

如果有人能看到我做错了什么，我将非常感谢您的帮助。如果我为这种类型的任务完全找错了树，我为浪费时间而道歉，但是非常感谢一些指导或推荐到适当的教程资源。我花了过去两天试图找出这些错误。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-19T22:59:22.010

好的，所以没有其他人在这里帮助过你……就这样吧。

从本质上讲，您对如何使用 API 类的理解出现了错误。

您的代码正在尝试**定义**DataInputStream 类。您想改用 API 已经提供的那个。通过重新定义类，您实际上是在屏蔽 API 类（您绝对不希望这样）。

因此，如果您查看 DataInputStream 的文档，您会看到一个构造函数。这允许您创建一个类的**实例**。这就是你想要的:)

```
InputStream buildinginfo = getResources().openRawResource(R.raw.testbuilding);
DataInputStream myDIS = new DataInputStream(buildinginfo);

//you've now got an instance of DataInputStream called myDIS

String firstString = myDIS.readLine();

//voila ... your firstString variable should contain some text 
```

你的数组代码也有问题......但我不会以这种方式使用数组。

您应该使用 ArrayList，然后在 while 循环中读取这些行，这样您就不需要修改大小。

首先让我们摆脱这一行（我将其注释掉：

```
//String firstString = myDIS.readLine(); 
```

并创建一个 ArrayList 的实例，它是一个模板类，所以请注意`String`尖括号中的表示我们想要在我们的数组中使用哪种类型的元素：

```
ArrayList<String> list = new ArrayList<String>(); 
```

您可以使用 add 方法将元素添加到 arraylist。我们将一口气完成整个事情，别担心，我会在之后解释...

```
String myLine; //declare a variable

//now loop through and check if we have input, if so append it to list

while((myLine=myDIS.readline())!=null) list.add(myLine); 
```

最后一行有点难懂，但是当您分配 myLine 变量时，它会返回一个结果，您可以将其与 NULL 进行比较……一旦读取最后一行，readline 函数将返回 null。while 循环的条件等于 false 并退出循环。

调用了一个简单的辅助函数`toArray`来将你的数组列表变成一个简单的数组。

```
String[] myStringArray = list.toArray(new String[list.size()]) 
```

您现在有了所需的输出。我建议在 Android 上观看一些视频以大致了解该语言，但我希望这有助于您了解错误所在。

# python - 构建在字符串中搜索不同子字符串的 Python 代码的最佳方式

> ID：14968357
> 
> 赞同：0
> 
> 时间：2013-02-19T22:03:21.187
> 
> 标签：python, if-statement

自从尝试学习 python 以来，我正在使用 BeautifulSoup 作为我的第一个项目制作足球评论刮板。

基本上对于每个目标陈述，它可能是一个目标、一个乌龙球或一个点球，我需要将这些单独记录在我的数据库中。

出现的问题是有时目标语句包含“罚球区”或“罚球区”，因此我需要将这些情况记录为进球而不是罚球。

我用大量嵌套语句模拟了一些东西，但它很脏。

所以最初我有一些类似的东西

```
if goal in statement:
   if 'own goal' in statement:
      {record own goal in db}
   elif 'penalty' in statement:
      if not 'penalty area' in statement:
          if not 'penalty box' in statement:
              {record penalty in db}
   else:
      {record goal in db} 
```

我只是一起嘲笑它，因为我没有代码。这是实现这一目标的唯一方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:16:36.493

To clean it up, you can maybe combine some logical statements, but apart from that I don't see much improvement.

```
if 'goal' in statement:
    if 'own goal' in statement:
        {record own goal}
    elif 'penalty' in statement and not('penalty area' in statement) and not('penalty box' in statement):
        {record penalty}
    else:
        {record goal} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:12:58.443

也许这样更好：

```
 if 'goal' in statement:
       if 'own goal' in statement:
           {record own goal in db}
       elif not('penalty area' in statement or 'penalty box' in statement):
           {record goal in db}
       elif 'penalty' in statement:
           {record penalty in db}
       else:
           {record goal in db} 
```

# jquery - 动态生成的 iframe 不响应 .load()

> ID：14968363
> 
> 赞同：0
> 
> 时间：2013-02-19T22:03:32.193
> 
> 标签：jquery, iframe

我想在加载 iframe 时触发一个函数，问题是有些是动态生成的，不会触发 .load() 事件，我试过：

```
$('.upload-target').on('load',uploadDone)

function uploadDone(){
    alert('ewfweewf');
} 
```

但没有运气..如何在加载动态生成的 iframe 时触发函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:18:24.287

试试这个：

```
$('.upload-target').load(function(){
    alert('ewfweewf');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:21:22.753

正如您在这个小提琴中看到的那样，[http://jsfiddle.net/Uj3bH/](http://jsfiddle.net/Uj3bH/)加载事件不会传播，因此您将无法使用事件委托绑定到 iframe 的加载事件。相反，在创建动态 iframe 时绑定事件。

```
$(iframehtmlstring).appendTo("body").on("load",function(){
    console.log("worky")
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T22:24:33.953

我会说负载不会因为同源策略而传播攻击者可能会滥用加载时间来获取更多信息。例如，如果登录，加载时间可能需要更长的时间。

如果不是......好吧，那么我发现了一个安全问题；）

# php - 不在表单中时使用 PHP 只选择一个单选按钮

> ID：14968365
> 
> 赞同：0
> 
> 时间：2013-02-19T22:03:40.080
> 
> 标签：php, radio-button

我一直在为学校做这个项目，我们制作了一个迷你课程网站，就我们选择的主题对用户进行测验。问题、选择和答案都必须在一个数组中，然后可以显示为问题和单选按钮选择。我已经达到了这一点，我现在只在做一个，直到我完成它。我现在遇到的问题是所有单选按钮都是可选的。我怎样才能使每个问题只能选择一个单选按钮？

这是我的代码：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Untitled Document</title>
    </head>

    <body>
    <?php
$score = 0;

    //multi-dimensional arrays for questions, selections, and answers
    $questions = array(
    array('question' => 'Which is optional to making Easy Fudge?', 
        'choice 1' => 'Nuts', 
        'choice 2' => 'Condensed Milk', 
        'choice 3' => 'semi-sweet morsels', 
        'choice 4' => 'bakers chocolate', 
        'answer' => 'nuts'),
        );

    //looping through the questions with nested loops
    foreach($questions as $question){
echo $question['question'] . '<br />';  
echo '<input type="radio" name = "nuts" value="nuts" id="nuts"> ' . $question['choice 1'] . '<br />';   
echo '<input type="radio" name = "condensed milk" value="condensed milk" id="condensed milk"> ' . $question['choice 2'] . '<br />';
echo '<input type="radio" name = "semi-sweet morsels" value="semi-sweet morsels" id="semi-sweet morsels"> ' . $question['choice 3'] . '<br />';
echo '<input type="radio" name = "bakers chocolate" value="bakers chocolate" id="backers chocolate"> ' . $question['choice 4'] . '<br />';  
    }

    ?>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:05:21.967

为所有相关的单选按钮提供相同的名称。例子：

```
foreach($questions as $question){
    echo $question['question'] . '<br />';  
    echo '<input type="radio" name = "nuts" value="nuts" id="nuts"> ' . $question['choice 1'] . '<br />';   
    echo '<input type="radio" name = "nuts" value="condensed milk" id="condensed_milk"> ' . $question['choice 2'] . '<br />';
    echo '<input type="radio" name = "nuts" value="semi-sweet morsels" id="semi-sweet_morsels"> ' . $question['choice 3'] . '<br />';
    echo '<input type="radio" name = "nuts" value="bakers chocolate" id="backers_chocolate"> ' . $question['choice 4'] . '<br />';  
} 
```

作为进一步说明.. 有效的 Id 属性不能包含空格，因此在上面的示例中，我已将您的空格替换为下划线。

# c# - 如何避免重新启动迭代器方法？

> ID：14968371
> 
> 赞同：2
> 
> 时间：2013-02-19T22:03:51.333
> 
> 标签：c#, linq, iterator, yield-return

请考虑以下 C# 块：

```
int resultIndex = 0;

Result firstResult = results.First();
DoAVeryImportOperationWithFirstResult(firstResult);

Console.WriteLine(String.Format("This is the {0} result.", resultIndex++));
yield return firstResult;

foreach(Result result in results)
{
   Console.WriteLine(String.Format("This is the {0} result.", resultIndex++));
   yield return result;
} 
```

如果您熟悉 Linq 和迭代器，您会注意到在`foreach`块的第一次迭代中，将返回 results 的第一个结果而不是第二个结果。

所以，基本上这是我的问题：我无法从迭代器方法中获取第一个值，然后在不重新启动此方法的情况下在其他地方使用它。

有人知道一些解决方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T22:07:48.677

Others have shown the approach using a `foreach` loop and conditional execution. That's actually a neat approach - but here's another option in case the `foreach` loop is inappropriate for whatever reason.

```
using (var iterator = results.GetEnumerator())
{
    if (!iterator.MoveNext())
    {
        // Throw some appropriate exception here.
    }

    Result firstResult = iterator.Current;
    DoAVeryImportOperationWithFirstResult(firstResult);

    Console.WriteLine(String.Format("This is the {0} result.", resultIndex++));
    yield return firstResult;

    while (iterator.MoveNext())
    {
        Result result = iterator.Current;
        Console.WriteLine(String.Format("This is the {0} result.", resultIndex++));
        yield return result;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T22:06:12.130

只需明确地这样做：

```
bool first = true;
foreach(var item in results) {
    if(first) {
        first = false;
        // whatever
    } else {
        // whatever else
    }
} 
```

或更复杂：

```
using(var iter = results.GetEnumerator()) {
    if(iter.MoveNext()) {
        // do first things with iter.Current

        while(iter.MoveNext()) {
            // do non-first things with iter.Current
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-19T22:06:13.830

您需要手动迭代：

```
var enumerator = results.GetEnumerator();
enumerator.MoveNext();
yield return enumerator.Current; //first
while(enumerator.MoveNext())
 yield return enumerator.Current; //2nd, ... 
```

省略所有错误检查...也不要忘记处理。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-19T22:07:10.330

```
bool isFirst = true;
foreach(Result result in results)
{
   if(isFirst)
   {
      DoAVeryImportOperationWithFirstResult(firstResult);
      isFirst = false;
   }

   Console.WriteLine(String.Format("This is the {0} result.", resultIndex++));
   yield return result;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-19T22:06:17.167

您需要使用跳过

```
foreach(Result result in results.Skip(1))
{
   Console.WriteLine(String.Format("This is the {0} result.", resultIndex++));
   yield return result;
} 
```

或手动迭代结果。

如果您考虑如何实现迭代器，您所看到的确实是预期的行为！

# iis-7 - ServerVariables("REMOTE_HOST") 在不同的 Web 服务器上返回不同的响应

> ID：14968374
> 
> 赞同：0
> 
> 时间：2013-02-19T22:04:04.220
> 
> 标签：iis-7, asp-classic

我们使用 ServerVariables("REMOTE_HOST") 来识别访问经典 ASP 页面的工作站（内部公司工作站，不扫描公共用户），因为我不能假设 IP 地址总是适用于同一个工作站。

我发现返回给 Win7 IIS 服务器的 REMOTE_HOST 值在主机名之后包含域名，但 IIS 的 VM 服务器 2008 实例不包含域名。

我希望能够针对一致的值进行编程，而不必在最后尝试匹配带有/不带有预定义域名字符串的值。

有谁知道这是由 IIS 或服务器 O/S 上的配置决定的吗？

# c# - 如果 listBox 中的项目超出右侧的界限，我该如何做到这一点，所以它会向下移动一行？

> ID：14968377
> 
> 赞同：1
> 
> 时间：2013-02-19T22:04:11.730
> 
> 标签：c#

我在一个新表单中有此代码，我将文本添加到文本框，然后将其作为项目添加到列表框：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace GatherLinks
{
    public partial class ChangeLink : Form
    {

        public ChangeLink()
        {
            InitializeComponent();

        }

        public string getText()
        {
            return textBox1.Text;
        }

        private void button1_Click(object sender, EventArgs e)
        {
            if (!string.IsNullOrEmpty(textBox1.Text))
            {
                DialogResult = DialogResult.OK;
            }
            else
            {

            }

        }

        private void ChangeLink_Load(object sender, EventArgs e)
        {
            this.AcceptButton = button1;
        } 

    }
} 
```

这就是我将文本添加到列表框的方式：

```
private void button2_Click(object sender, EventArgs e)
        {
            cl = new ChangeLink();
            cl.StartPosition = FormStartPosition.CenterParent;
            DialogResult dr = cl.ShowDialog(this);
            if (dr == DialogResult.Cancel)
            {
                cl.Close();
            }
            else if (dr == DialogResult.OK)
            {
                label4.Text = cl.getText();
                mainUrl = cl.getText();
                if (!LocalyKeyWords.ContainsKey(mainUrl))
                {
                    newUrl = true;
                    KeysValuesUpdate();
                }
                else
                {
                    newUrl = false;
                    KeysValuesUpdate();
                }
                OptionsDB.set_changeWebSite(cl.getText());
                cl.Close();
                listBox1.SelectedIndex = listBox1.Items.Count - 1;
            }
        } 
```

问题是如果文本很长，那么在 listBox 的右边界/边框中，项目的文本会被剪切。所以要看到它，我想以某种方式将它向下移动一行，或者需要多少行才能显示项目文本/名称的其余部分

所以它会算作一个项目，但如果需要在某些行上。

更新：

这是我在运行应用程序时将项目加载到 listBox 的部分：

```
private void ListBoxLoadKeys(Dictionary<string, List<string>> dictionary, string FileName)
        {
            int t = listBox1.Width;
            using (StreamReader sr = new StreamReader(FileName))
            {
                while ((line = sr.ReadLine()) != null)
                {
                    int i = line.Count();
                    tokens = line.Split(',');
                    dictionary.Add(tokens[0], tokens.Skip(1).ToList());
                    string tt = tokens[1].Substring(t - tokens[1].Length);
                    data.Add("Url: " + tokens[0] + " --- " + "Localy KeyWord: " + tokens[1]);
                }

            }
            listBox1.DataSource = data;
        } 
```

所以变量 t 是列表框长度（宽度） 在这一行中，我尝试计算并获取标记 [1] 的文本“

```
string tt = tokens[1].Substring(t - tokens[1].Length); 
```

但是我得到一个错误 startIndex 不能大于字符串的长度

现在我知道列表框长度（宽度），但我不想将文本标记 [1] 放在新行中，只有当它超出列表框宽度（长度）的范围时

我该如何解决并做到这一点？

再次更新：

现在再次更改代码，我首先尝试检查变量数据 lngth 中的每一行是否大于变量 t：

```
private void ListBoxLoadKeys(Dictionary<string, List<string>> dictionary, string FileName)
        {
            int t = listBox1.Width;
            using (StreamReader sr = new StreamReader(FileName))
            {
                while ((line = sr.ReadLine()) != null)
                {
                    int i = line.Count();
                    tokens = line.Split(',');
                    dictionary.Add(tokens[0], tokens.Skip(1).ToList());
                    //string tt = tokens[1].Substring(t - tokens[1].Length);
                    data.Add("Url: " + tokens[0] + " --- " + "Localy KeyWord: " + tokens[1]);
                    if (data[i].Length > t)
                    {
                        MessageBox.Show("big");
                    }
                }

            }
            listBox1.DataSource = data;
        }

if (data[i].Length > t)
                        {
                            MessageBox.Show("big");
                        } 
```

但我收到一个错误：索引超出范围。必须是非负数且小于集合的大小

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:38:00.547

您不能使用标准列表框执行此操作。您需要创建自己的多行列表框。请参阅此链接以获取一些指导。 [http://www.codeproject.com/Articles/2695/An-editable-multi-line-listbox-for-NET](http://www.codeproject.com/Articles/2695/An-editable-multi-line-listbox-for-NET)

我已经在工作中实现了这一点（忽略了作者对配色方案的糟糕选择），并且效果很好。

# php - 提交表单后php会话丢失

> ID：14968379
> 
> 赞同：0
> 
> 时间：2013-02-19T22:04:14.623
> 
> 标签：php, session, session-variables

页面下方的代码在 GET 请求或刷新浏览器时保持会话，但是当我提交表单时，会话数据会丢失。

```
$user=$_POST['user']; $pass=$_POST['pass'];
if ($_POST['user'])
{ if($user==$un and $pass=$pw)
  { $_SESSION['uid']=$Xid;header('Location: '.$uri.'?welcome'); }
  else { $msg="chybny login";  }
}

if(isset($_GET['logout']))   { session_destroy(); header('Location: '.$uri); }
$cnt=$_SESSION['cnt']+1; $_SESSION['cnt']=$cnt; 
```

上面是登录代码，它在验证后将我重定向到欢迎页面，但是会话丢失了。如果我只是刷新或重复加载页面而不提交，则会话通过回显会话变量 cnt（计数为 1、2、3、...）来保持

提交表单后，我看到会话丢失并且 cnt 变量也被重置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:08:44.503

I usually don't work with session directly try the following, place it a the top of your script :

```
session_start();
$uid = $_SESSION['uid'];
$cnt = $_SESSION['cnt']; 
```

then work with the variable instead

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:11:35.053

问题可能是您的“和”陈述。它应该是 ＆＆。条件不会成立。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T22:18:55.440

`PHP.ini`根据您上面的评论，如果您 100% 确定代码一切正常并且问题就是问题所在。查看此链接以检查`.ini` [http://php.net/manual/en/session.configuration.php中的设置](http://php.net/manual/en/session.configuration.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T22:27:42.280

首先，确保你在每个页面上做的第一件事是启动一个会话（我建议在你所有子站点上需要的头文件中调用它一次）。

这样你就有 session_start(); 系统中的任何地方。

其次，收紧你的代码；使其更易于阅读。就像是

```
$userName = isset($_POST['userName']) ? $_POST['userName'] : false;
$password = isset($_POST['password']) ? $_POST['password'] : false;
$logout = isset($_POST['logout']) ? $_POST['logout'] : false;

$url = '../index.php';

if(!($logout))
{
    if($userName && $password)
    {
        if($userName == $un && $password == $pw)
        {
            $_SESSION['loggedIn']=true;
            $_SESSION['uid']=$Xid;
            $_SESSION['message']="success";
        }
        else
        {
            $_SESSION['loggedIn']=false;
            $_SESSION['message']="fail, incorrect login information.";
        }
    }
    else
    {
        $_SESSION['loggedIn']=false;
        $_SESSION['message']="fail ; username and password not submitted.";
    }
    header("Location: $url");

}
else
{
    session_start();
    session_destroy();
    session_start();
    header("Location: $url");
} 
```

如果您想根据用户是否登录来显示不完整的内容，那么您可以简单地检查每个页面上是否设置了登录会话，而不是为此修改标题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-09T21:01:28.623

将当前会话传递到下一页...我相信这就是您要问的...

您当前没有将会话传递到下一页并`session_start()`在下一页顶部使用。

将第 4 行更改为：

```
{ $_SESSION['uid']=$Xid;header('Location: '.$uri.'?'.SID.'&page=welcome'); } // Where "page" is the name of the data you are retrieving 
```

或者，您可以将会话数据保存到 cookie，然后在下一页检索它。

您可以`session_start("NameHere")`在每个页面上使用时交替命名会话，但是如果访问者最近访问过并且会话没有被破坏，如果您启用了它们，他们可能会看到解析错误。

# javascript - 骨干 triggerEvents 变量

> ID：14968387
> 
> 赞同：0
> 
> 时间：2013-02-19T22:04:37.850
> 
> 标签：javascript, performance, backbone.js

我正在阅读 Backbone.js 源代码，对此感到困惑

```
var triggerEvents = function(events, args) {
  var ev, i = -1, l = events.length;
  switch (args.length) {
    case 0: while (++i < l) (ev = events[i]).callback.call(ev.ctx);
    return;
    case 1: while (++i < l) (ev = events[i]).callback.call(ev.ctx, args[0]);
    return;
    case 2: while (++i < l) (ev = events[i]).callback.call(ev.ctx, args[0], args[1]);
    return;
    case 3: while (++i < l) (ev = events[i]).callback.call(ev.ctx, args[0], args[1], args[2]);
    return;
    default: while (++i < l) (ev = events[i]).callback.apply(ev.ctx, args);
  }
}; 
```

我有几个问题-

1.  为什么这是触发事件的优化（如注释源所说）？
2.  ev.ctx 是什么？
3.  什么是.callback()？

这种结构意味着，如果有机会出于速度的考虑始终使用 call 而不是 apply，因为该函数的结构似乎在说“如果我知道有多少个 args 则使用 call，而不是使用 apply”，当一个人可以一直使用 apply 时。

简而言之，我不确定这个函数的目的是什么，以及为什么按照它的编写方式编写它，如果有人能告诉我它会很棒！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:24:51.130

我创建了一个小型[JSPerf 测试套件](http://jsperf.com/js-function-call-vs-function-apply)，用于比较`Function.call`和`Function.apply`性能。它非常清楚地表明（使用 Chrome 24）`Function.call`速度提高了 30-50%。尝试在浏览器中运行它，看看性能有何不同。

然而，这并不意味着您应该在自己的代码中遵循这种优化。Backbone 事件功能是 Backbone 的核心，并且会触发**很多事件。**作者已经优化了这段代码，以挤出最后一点性能。在大多数其他情况下，这将是过度优化。

该`ev.callback`属性是事件的回调函数。

考虑以下示例：

```
this.model.on('change', this.handleChange, this); 
```

在这种情况下，回调是`this.handleChange`方法。

符号`(ev = events[i]).callback.call`只是一个快捷方式

```
ev = events[i];
ev.callback.call 
```

该快捷方式有效，因为在 javascript 中，赋值操作返回分配的值。

`ev.ctx`另一方面，属性是作为上下文绑定到回调函数的对象`this`。`Backbone.Events.on`将上下文作为可选参数。在上面的示例中，最后一个参数`this`指定回调函数的上下文应该是包含类。

# android - 为什么我可以将另一个Android项目用作库项目而不设置为库项目？

> ID：14968389
> 
> 赞同：0
> 
> 时间：2013-02-19T22:04:48.790
> 
> 标签：android, library-project

好的，我知道如何将 Android 项目设置为库项目并将其添加到另一个 Android 项目作为库引用。

然而，在我这样做之后，我删除了“是库”的复选标记，所以第一个项目不是库项目，可以作为普通的 Android 项目运行。

引用第一个项目的第二个项目也运行良好，我可以更改第一个项目并仍然直接在第二个项目中使用它。

那么，当我之后可以删除复选标记并且引用仍然有效时，为什么将项目设置为库大惊小怪呢？我不明白 - 谁能解释一下？

我将 Eclipse 3.7 (Indigo) 与 ADT 插件版本 21 一起使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:09:00.187

> 那么，当我之后可以删除复选标记并且引用仍然有效时，为什么将项目设置为库大惊小怪呢？我不明白 - 谁能解释一下？

程序员的一般规则是“在接受输入时要自由，在生成输出时要保守”。在这种情况下，构建系统是自由的，并且将您的第一个项目用作库，尽管它目前没有被标记为库。

然而：

*   如果没有在 Eclipse 中选中“Is Library”，则无法设置初始主机-> 库关系

*   **`android update lib-project`**如果没有等效设置，您可能无法设置初始主机->库关系`project.properties`（它可能有效——我只是没有尝试过）

*   您不应该假设输入的自由解释从长远来看是可靠的，因为未来版本的工具可能需要检查该标志并强制执行其设置

# linux - 詹金斯、xvfb 和硒

> ID：14968391
> 
> 赞同：19
> 
> 时间：2013-02-19T22:04:50.717
> 
> 标签：linux, selenium, jenkins, xvfb

我一直在尝试按照此处的说明运行 Xvfb 插件： [https ://wiki.jenkins-ci.org/display/JENKINS/Xvfb+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Xvfb+Plugin)

目前 xvfb 可执行文件位于`/usr/bin/Xvfb`.

我的项目配置和 Jenkins 配置与说明相同，但是我收到此错误：

> 错误：未定义 Xvfb 安装，请在配置中定义一个。定义后，您需要在 Xvfb 插件作业设置的高级选项下选择一项并保存作业配置。

我还尝试将可执行文件的路径放在 Jenkins 配置中，结果没有改变。

有什么想法可以让这个工作吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-27T07:22:23.433

You must define a Xfvb installation in "Manage Jenkins" => "Configure System" => "Xvfb installation"

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-05-01T19:04:38.700

您必须在 Jenkins 上定义安装 Xvfb。访问**管理 Jenkins** >>**全局工具配置**。在**[Xvfb 安装](https://i.stack.imgur.com/7lNU3.png)**部分，输入名称并使用**/usr/bin**填写“**查找 Xvfb 可执行文件的目录**”字段。

 **![](../Images/b0bfe108913aac4fcea06c7291453c3d.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-15T15:32:52.553

> 目前 xvfb 可执行文件位于 /usr/bin/Xvfb

不，默认 xvfb 位置是`/usr/bin`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-05T09:45:21.687

使用插件的 1.10 版本，我无法保存属性。升级到1.12版本后，开始保存。**

# html - 使用 colspan 单元格设置表格中的交替列样式

> ID：14968393
> 
> 赞同：1
> 
> 时间：2013-02-19T22:04:51.513
> 
> 标签：html, css, html-table

我被要求做一个项目，在其中创建一个具有交替列背景颜色的表。这一切都很好，除了有几行需要跨越其他列，同时仍然具有“已检查”背景，这是在每个 td 中确定的。

请参阅[jsfiddle](http://jsfiddle.net/JEXq2/1/)或代码：

```
body {
    font-family:Calibri, Trebuchet MS, Verdana, Tahoma, sans-serif;
}
table {
    border:1px solid #444;
    text-align:center;
}
th, td {
    width:200px;
    padding:2px;
}
.lg {
    background-color:#eee;
}
.dg {
    background-color:#ddd;
}
} 
```

对应的html：

```
<table>
    <tr>
        <th>Fruits</th>
        <td class="lg">Peach</td>
        <td class="dg">Blueberry</td>
        <td class="lg">Apple</td>
    </tr>
    <tr>
        <th>Chocolate</th>
        <td class="lg">Chocolate-Chip</td>
        <td class="dg">Double Chocolate</td>
        <td class="lg">Turtle</td>
    </tr>
    <tr>
        <th>Peanut Butter</td>
            <td colspan="3">Peanut Butter Swirl and a long list of items</td>
    </tr>
    <tr>
        <th>Classics</th>
        <td class="lg">Chocolate</td>
        <td class="dg">Vanilla</td>
        <td class="lg">Strawberry</td>
    </tr>
</table> 
```

目前，我插入了一个背景图像，以在跨列的 td 中复制此效果。唯一的问题是，无论我如何尝试（对结果进行屏幕截图等），这都不能完美排列；我应该注意到这是一个固定宽度的表格。老实说，除了 Opera 之外，所有这些都非常接近，它看起来很遥远。

有没有办法始终如一地做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:21:58.833

这是一个非常棘手的问题。这是一种[开箱即用的解决方案](http://jsfiddle.net/ySyE4/2/)，它*可能适合您，也可能不适合您*。它涉及 colspan3 单元格上的线性“梯度”，但需要：

*   列上的给定宽度（在您的示例代码中以 200 像素存在）
*   实际上可以容纳该宽度的表格（如在我的示例中，最小宽度为 800 像素）
*   要么在渐变中包含单元格的填充，要么删除它们（如我的示例）

您的 html 使用 colspan-cell 上的一个类进行了轻微更新：

```
<td class="fullspan" colspan="3">Peanut Butter Swirl and a long list of items</td> 
```

[CSS 使用Gradient Generator](http://www.colorzilla.com/gradient-editor/#c8c8c8+0,c8c8c8+33,969696+33,969696+67,c8c8c8+67;Custom)添加了这个：

```
.fullspan {
    background: #eee; /* Old browsers */
    background: -moz-linear-gradient(left,  #eee 0%, #eee 200px, #ddd 200px, #ddd 400px, #eee 400px); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, right top, color-stop(0%,#eee), color-stop(200px,#eee), color-stop(200px,#ddd), color-stop(400px,#ddd), color-stop(400px,#eee)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(left,  #eee 0%,#eee 200px,#ddd 200px,#ddd 400px,#eee 400px); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(left,  #eee 0%,#eee 200px,#ddd 200px,#ddd 400px,#eee 400px); /* Opera 11.10+ */
    background: -ms-linear-gradient(left,  #eee 0%,#eee 200px,#ddd 200px,#ddd 400px,#eee 400px); /* IE10+ */
    background: linear-gradient(to right,  #eee 0%,#eee 200px,#ddd 200px,#ddd 400px,#eee 400px); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#eee', endColorstr='#eee',GradientType=1 ); /* IE6-9 */
} 
```

在现代浏览器中提供这样的东西，包括 Opera：

![渐变黑客渲染](../Images/9f8f377ba32c4e72526b258930f1bc48.png)

# ruby-on-rails - Rails和数据库：如果存在则查找条目，否则创建

> ID：14968397
> 
> 赞同：0
> 
> 时间：2013-02-19T22:04:56.827
> 
> 标签：ruby-on-rails

我在数据库中有一个表，其中包含以下列：

> 1.  ID
> 2.  package1_name
> 3.  package2_name

我`file_field`的 s 中有两个`_form.html.erb`：

```
<%= form_for(@submission, :html => { :multipart => true }) do |f| %>
 <%= f.fields_for :uploads do |upload| %>
  <%= upload.file_field :package1 %>
  <%= upload.file_field :package2 %>
 <% end %>
<% end %> 
```

每次我单击提交按钮时，它都会在数据库中创建两个单独的条目。

有没有办法改变它的行为，`create`以便它找到数据库条目（如果存在），否则创建一个新条目？

我已经尝试过了，但它不起作用：

```
def create
    @submission = Submission.find_or_create_by_id(params[:submission])
    ...
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:29:16.373

这只会在 params[:submission][:id] 中具有 id 的记录不存在时创建提交。

```
def create
   @submission = Submission.where(:id => params[:submission][:id]).first_or_create(params[:submission])
end 
```

但是，我同意表单两次调用 create 方法似乎不正确。你需要这样做似乎很奇怪。无论如何，如果这种行为是正确的，我希望这会有所帮助。

# javascript - Javascript，仅在用户使用 IE10 时运行

> ID：14968399
> 
> 赞同：0
> 
> 时间：2013-02-19T22:05:02.457
> 
> 标签：javascript

我正在使用一个在除 IE10 之外的所有浏览器上都能完美运行的库，其中一个按钮需要双击而不是 1，所以我想创建一些仅在 IE10 上运行的 JavaScript，当用户单击此按钮进行双击时一个，但我怎样才能让它只在 IE10 中运行。

编辑 ：

这是我遇到问题的代码：

```
<p:fileUpload widgetVar="upload" id="upload" fileUploadListener="#{fileUploadController.handleFileUpload}"
                                  mode="advanced" 
                                  multiple="false" 
                                  update="messages Nav upload"
                                  label="Select File"
                                  sizeLimit="100000000" 
                                  allowTypes="/(\.|\/)(gif|jpe?g|png|doc|docx|txt|pdf|html)$/"
                                  auto="true"
                                  disabled="#{fileUploadController.uploadComplete}"
                                  /> 
```

在所有经过测试的浏览器中，firefox、chrome、opera、safari 和 IE 7 - 9 只有 IE10 存在点击上传时需要双击的问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:34:15.157

虽然 Internet Explorer 10 确实不再支持HTML 中的[条件注释](http://msdn.microsoft.com/en-gb/library/ms537512%28v=vs.85%29.aspx)，但有一个不太广泛使用的功能称为“[条件编译](http://msdn.microsoft.com/en-us/library/7kx09ct1%28v=vs.80%29.aspx)”，IE10 JScript 引擎仍然支持该功能。

```
/*@cc_on

  @if (@_jscript_version >= 10)
    console.log("You are using IE10 or greater!");
  @end

@*/ 
```

如您所见，所有其他浏览器都会将此解析为`/* ... */`多行注释并忽略您的 IE 特定代码。

当与特征检测结合使用时，条件编译提供了一种非常强大的缩小 IE 版本检测范围的方法。

这听起来很可能是您正在使用的库的错误。考虑向 Primefaces 库的作者报告该错误，而不是绕过它。

如果它是一个库错误，并且您在 IE10 中遇到单击与双击的问题，那么纯特征检测可能不会产生最合适的结果，因为您会尝试检测不相关的特征。"onclick" 和 "ondblclick" DOM0 事件已经可用于 IE 很长时间了。

此外，如果按钮从 IE11 开始工作，则通过检查 HTML5/CSS3 属性进行的特征检测可能会导致难以识别 IE10，或者在最坏的情况下会触发误报。尤其是考虑到从 IE 的一个主要版本 (8) 到其下一个主要版本 (9) 的巨大变化时，您希望尽可能减少误报和检测不相关功能的威胁。

请注意，与用户代理嗅探（通常不受欢迎）不同，JScript 引擎不会面临用户代理欺骗等相同的风险。JScript 引擎版本是硬编码的，通常只随 Internet Explorer 的每个主要版本更新。（...、6、7、8、9、10 等）

因此，为了准确检测 IE10 并使您的软件面向未来，条件编译是必须的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:09:54.047

whatever you do - don't try to sniff the user agent. Use feature detection instead!

```
var isThisIeTen = document.getElementsByTagName("body")[0].style.msGrid;
if (isThisIeTen) { // that feature is present in IE10+, so yeah... } 
```

Not sure what you're actually trying to detect, so I can't get more specific about which feature to detect, but that's the idea

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T22:11:52.937

我喜欢这样做：

首先在 HTML 中检测浏览器：

```
<!--[if lt IE 7 ]> <html class="ie6"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie7"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie8"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie9"> <![endif]-->
<!--[if (gt IE 9)]><!--> <html class=""> <!--<![endif]--> 
```

然后写你的JS

```
$(function () {
  var ie10 = true;
  if ($('html').is('.ie6, .ie7, .ie8')) {
      ie10 = false;
  }

  if (ie10) {
      // IE10 JS
  } else {
      // Other JS
  }
} 
```

但正如其他人所提到的，浏览器检测很少是处理此类事情的好方法。最好检测功能支持

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T22:29:59.987

如果这是由 IE 10 中的错误引起的，并且您无法通过更改代码以很好的方式解决它，我建议您改为让 IE 使用较旧的引擎，只需将此标记放在该`head`部分中，您就可以替换IE 10 的错误/功能集与 IE 7、8 或 9 的错误/功能集：

```
<meta http-equiv="X-UA-Compatible" content="IE=8"> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-14T10:49:26.680

试试这个 CSS 解决方法。

```
 .fileinput-button input {
      -moz-transform : none !important;
      border : none !important;
      border-width : 0 !important;
      transform : translate(-300px, 0) scale(4) !important;
      font-size : 23px !important;
   } 
```

检查您生成的按钮类（fileinput-button）并应用到它。在我的情况下，班级名称是`.file_upload.`

[在这里](https://stackoverflow.com/questions/16036655/primefaces-pfileupload-doesnt-work-in-ie-10)找到这个。这对我很有效。

# c++ - 将 CString 与 sprintf 一起使用

> ID：14968405
> 
> 赞同：3
> 
> 时间：2013-02-19T22:05:32.463
> 
> 标签：c++, printf, cstring

我有一些 C++ 代码，我需要将 CString 与 sprintf 一起使用。在这段代码中，我创建的文件名是由 sprintf 定义的 CString。代码如下。

```
double Number;     
Number = 0.25; 

char buffer [50];

CString sFile;
sFile = sprintf(buffer,"TRJFPICD(%3.3f).txt",Number);

CString SFFile;
SFFile = sprintf(buffer,"TRJFPICV(%3.3f).txt",Number);

CString SFFFile;
SFFFile = sprintf(buffer,"TRJFPICA(%3.3f).txt",Number); 
```

所需的文件名是`TRJFPICD(0.25).txt, TRJFPICV(0.25).txt`和`TRJFPICA(0.25).txt`。我的代码必须使用 CStrings。

我得到的错误是 ' `operator =`' 是模棱两可的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T22:18:23.310

看一下[`CString::Format`](http://msdn.microsoft.com/en-us/library/18he3sk6%28v=vs.80%29.aspx)（忽略`CStringT`部分 -`CString`源自`CStringT`）。它做你想做的事，并允许你干净地重写你的代码：

```
double Number = 0.25; 

CString sFile;
sFile.Format(_T("TRJFPICD(%3.3f).txt"), Number);

CString SFFile;
SFFile.Format(_T("TRJFPICV(%3.3f).txt"),Number);

CString SFFFile;
SFFFile.Format(_T("TRJFPICA(%3.3f).txt"),Number); 
```

# ruby - 使用自定义退出代码使 rake 任务失败？

> ID：14968409
> 
> 赞同：2
> 
> 时间：2013-02-19T22:05:41.500
> 
> 标签：ruby, rake

我想用自定义退出代码中止 rake 任务（以与执行的 shell 脚本通信满足特定条件）。

成功的 Rake 任务返回 0，失败总是返回 1。有没有办法制作自定义代码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-02-01T14:24:33.130

正确的方法是`exit`使用所需的退出代码进行调用，这与您对其他编程语言的期望不同 - 实际上并不会立即退出程序，而是会引发一个`SystemExit`异常，然后由 Rake 捕获并正确处理（通过执行任何所需的清理，然后将带有状态代码的退出请求传播到运行的脚本`rake`）。

# ruby-on-rails - 我可以将微型 cloudfoundry 实例作为生产服务器运行吗？或者，厨师/木偶？

> ID：14968410
> 
> 赞同：1
> 
> 时间：2013-02-19T22:05:44.397
> 
> 标签：ruby-on-rails, node.js, cloud-foundry, chef-infra, puppet

我希望自己托管一堆多语言网络应用程序（ruby on rails，偶尔是 node.js 和 WordPress）。我绝对可以自己设置这些，但我很想找到一个简单且安全的平台，我可以托管它来自动化所有这些。如果我决定要设置 mongo 或其他东西，请为我提供灵活性。微型云代工实例是实现此目的的好方法吗？或者，我应该使用 chef 还是 puppet 来编写我的工作流程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T23:59:41.430

您可以使用 cloudfoundry 平台完成上述所有操作（ruby on rails、node.js 等应用程序）。要开始并查看所有可用的框架和示例，请查看[http://docs.cloudfoundry.com/getting-started.html](http://docs.cloudfoundry.com/getting-started.html)。

如果您需要任何进一步的帮助，请告诉我。

谢谢， - Hitesh

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:18:37.087

Have you looked at Heroku (www.heroku.com). It will allow you to do both Rails and Node.js apps. You can add Mongo and a host of other third-party subsystems to your app via the command line or their web interface. All together it's a great place to grow an app from concept to production.

I run several production sites on it currently with very few issues.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T00:41:45.090

免责声明：我为[OpDemand](http://www.opdemand.com/)工作。

在使事情更易于部署和管理的过程中，像 Cloud Foundry 和 Heroku 这样的 PaaS 会为您做出很多决定：运行时、库版本、数据库版本等。对于习惯于：

1.  拥有 SSH 访问权限以自定义内容
2.  能够选择自己的运行时/库
3.  具有与以某种方式构建的支持服务集成的灵活性

如果你对更灵活的基于 Puppet/Chef 的解决方案感兴趣，你应该看看[OpDemand 之](http://www.opdemand.com/)类的东西。在 PaaS 的快速部署优势与提供您可能需要的控制、自托管和 Puppet/Chef 支持之间取得了很好的平衡。

OpDemand 为 Ruby 和 Node.js 预先构建了应用程序堆栈，所有这些都具有一键式部署功能。您可以使用 ELB 从单节点或多节点中进行选择。还有一堆数据库/缓存选项，包括 MongoDB 甚至 3 节点副本集。

所有这些都由[开源 Puppet 模块](https://github.com/opdemand/puppet-modules)提供支持，这些模块为定制提供了一个很好的起点。祝你好运！

# c# - 使用 COM 对 C# 应用程序进行内存分析

> ID：14968411
> 
> 赞同：2
> 
> 时间：2013-02-19T22:05:46.850
> 
> 标签：c#, delphi, com, profiling

是否有任何工具可用于对包含`C#`和`Delphi`部分的应用程序进行内存分析？

这两个部分不能单独启动 - 它是一个应用程序。`C#`并`Delphi`通过`COM`彼此交流。

*我尝试过的*更新*`dotTrace Memory 3.5`- 应用程序因异常而崩溃，`clr.dll.`我可以通过分析器启动应用程序 - 选择*标记内存*- 如果我想获取快照，则会发生崩溃。*

 ** * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T22:31:23.680

我假设您分别编译它们，这意味着它们可以单独分析。根据您的 delphi 版本，AQTime 随附用于从调试器进行粗略分析。

我对 C# 部分真的无能为力，但我假设分析器存在，也许在 Microsoft 自己的工具链中，也可以从 IDE 运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:37:20.433

.NET 的 dotTrace 内存或 Scitech 内存分析器和 Delphi 的 AQTime 或 FastMM，只需将它们一起使用。我不知道任何集成解决方案。*

# mysql - MySQL“真正与众不同”的加入

> ID：14968414
> 
> 赞同：0
> 
> 时间：2013-02-19T22:05:56.393
> 
> 标签：mysql, join, distinct

我已经为此奋斗了几个小时，并且在使用正确的 MySQL 语法方面遇到了困难。任何关于我正在寻找的 SQL 类型的指针都将不胜感激。

请考虑这两个简单的表：

```
purchase:
id  email   product_id
1   andy@aaa.com    1
2   bob@bar.com     2
3   charly@code.com     1
4   charly@code.com     2

subscriber:
id  email   name
1   andy@aaa.com    Andy
2   bob@bar.com     Bob
3   charly@code.com     Charly 
```

我想选择*没有*购买 product_id 1 的订阅者。即：在这种情况下，它应该只返回 Bob 的行。

但是，我目前正在使用这个...

```
SELECT DISTINCT subscriber.*
FROM subscriber
LEFT OUTER JOIN purchase
ON subscriber.email = purchase.email
WHERE ( purchase.product_id <> 1 ) 
```

...返回这个：

```
id  email   name
2   bob@bar.com     Bob
3   charly@code.com     Charly 
```

我知道我需要处理有人在“购买”表中出现两次的情况。我怎样才能做到这一点？

谢谢指点！

法比安

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:16:51.393

只需使用以下内容：

```
SELECT DISTINCT subscriber.*
FROM subscriber
LEFT OUTER JOIN purchase
ON (subscriber.email = purchase.email and purchase.product_id = 1)
WHERE purchase.product_id IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:07:59.300

我认为最简单的方法是考虑购买产品的订阅者*——*然后将它们过滤掉。以下使用`not exists`子句执行此操作：

```
SELECT subscriber.*
FROM subscriber
where Not exists (select 1 from purchase where subscriber.email = purchase.email and purchase.product_id = 1) 
```

# android - 不明白为什么线程在 Android 中会发生变化？

> ID：14968416
> 
> 赞同：0
> 
> 时间：2013-02-19T22:05:56.693
> 
> 标签：android, multithreading

对于特定线程，我有以下代码

```
public void run() {

    while (true) {
        currentWord = words.get(new Random().nextInt(words.size()));
        tvForeignWord.setText(currentWord.getWordForeign());
        tvScore.setText("Your score is " + score);
        for (int i = timer_length; i > 0; i--) {
            tvTimer.setText("You have " + i + " seconds remaining.");
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                //DEBUG e.printStackTrace();
            }
        }
    }
} 
```

但是，我似乎收到此错误消息：

```
02-19 22:03:38.950: E/AndroidRuntime(17236): android.view.ViewRootImpl$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views. 
```

问题是什么？

当我这样做时：

```
public void run() {

    //while (true) {
        currentWord = words.get(new Random().nextInt(words.size()));
        tvForeignWord.setText(currentWord.getWordForeign());
        tvScore.setText("Your score is " + score);
        //for (int i = timer_length; i > 0; i--) {
            //tvTimer.setText("You have " + i + " seconds remaining.");
            //try {
                //Thread.sleep(1000);
            //} catch (InterruptedException e) {
                //DEBUG e.printStackTrace();
            //}
        //}
    } 
```

我没有错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:20:48.340

您不应该从单独的线程更新 UI。要么在你的线程之外创建一个 Handler 对象并将可运行对象发布到该对象，要么尝试使用 context.runOnUiThread() 在主线程上执行你的 UI 操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:08:31.677

只允许 UI 线程操作 UI 对象。您需要在 UI 线程和工作线程之间设置消息传递，以便工作线程在屏幕上产生更改。

# php - 使用 PHP 动态快速生成页面

> ID：14968417
> 
> 赞同：0
> 
> 时间：2013-02-19T22:05:57.353
> 
> 标签：php, performance, api, dynamic

我已经可以创建动态页面，并且可以正常工作，但是登录页面加载速度非常慢。

我真的很想得到一些帮助。以下是我的网站的功能。

让我们从以下链接开始`http://example.com/search.php`：

```
<?php 

session_start(); 

//(pretend there is code here that gets, decodes, and displays data from an api)

$title = $titleFromApi;
$a = $dataFromApi;

$_SESSION['storeTitle'] = $title;     // stores 'title' in a session  variable       
$_SESSION['store_a']    = $a;         // stores 'a' in a session variable

echo '<a href="http://example.com/'. $a .'/' . $title .'> ' . $title . '</a>';

// the line above is a clickable link that will take them to the landing page 

?> 
```

现在这里是登录页面 ( `http://example.com/$a/$title`)：

```
<?php

session_start();

$al = $_SESSION['store_a'];     // stores session variable in new variable 'al'

$getter = 'http://api.somewebsite.com/dev/' . $al . '/get_these_variables'; 

// the line above gets data from an api using variable 'al'

// (pretend that there is code here that decodes the data)

// the code below displays the data retrieved from the api

foreach($data as $entry){

echo '

 <div> 
  ' . $entry['decoded_data_1'] 
  . ' 
 </div>

 <div> 
  ' . $entry['decoded_data_2']            // and so on
  . ' 
 </div>

';                                        // ends echo

}

?> 
```

我今天刚刚了解了会话（我认为它会使事情变得更快）；之前，我将数据从 search.php 发送到地址栏中，然后在登录页面上读取它以携带变量（畏缩​​，我知道，我对 php 和一般开发都很陌生）。登陆页面的页面加载速度没有改变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:34:24.207

正如评论中提到的，在当前的情况下，您的脚本不能比查询 API 的响应时间快。

您没有对 API 发表任何意见，因此无法保证该领域的加速。但是，如果该 API 始终为同一查询返回相同的结果，您可以通过实现结果缓存来缓解该问题。

基本上，您应该将由其参数索引的查询结果存储在一个持久数组中，并且每次进行查询时，检查结果是否已经存在。您可以选择在[数据库](http://php.net/manual/en/book.pdo.php)中或在基于内存的缓存机制（如[memcache](http://php.net/manual/en/book.memcache.php) ）中将该数组设置为会话值。

每种方法都有其优点和缺点，选择一种解决方案而不是另一种解决方案也取决于 API：

*   基于会话的缓存将受到每个客户端的限制，这将大大降低其有效性，但如果 API 的使用必须对客户端保密，则可能是强制性的，
*   如果基于 db 的访问速度比 API 服务器快，例如，基于 db 可能会有些有效。具有足够大带宽的本地数据库，
*   memcache选项应该是最快的，但是如果必须重启服务，缓存数据会丢失，

您也可以将 db 和 memcache 结合起来，以获得后者的速度和前者的持久性。

这一切都假设您可以在一定程度上预测查询是否可以缓存，以及它将保持有效多长时间。您还需要对服务器配置进行一些控制，或者希望它已经支持上面讨论的功能。

# magento - 如何在 Magento 中找到运输承运人的名称？

> ID：14968427
> 
> 赞同：2
> 
> 时间：2013-02-19T22:06:18.637
> 
> 标签：magento, e-commerce, tracking, shipping

我正在尝试在我的商店中跟踪货件的标题/交付方式，以便在跟踪弹出窗口中使用。在弹出模板中，我有一个 Mage_Shipping_Model_Tracking_Result_Status 对象，如下所示：

```
object(Mage_Shipping_Model_Tracking_Result_Status)#182 (7) 
{ 
    ["_data":protected]=> array(5) 
    { 
        ["carrier"]=> string(3) "ups" 
        ["carrier_title"]=> string(21) "United Parcel Service" 
        ["tracking"]=> string(22) "9102969006713002493469" 
        ["popup"]=> int(1) 
        ["url"]=> string(211) "http://wwwapps.ups.com/WebTracking/processInputRequest?HTMLVersion=5.0&error_carried=true&tracknums_displayed=5&TypeOfInquiryNumber=T&loc=en_US&InquiryNumber1=9102969006713002493469&AgreeToTermsAndConditions=yes" 
    } 
    ["_hasDataChanges":protected]=> bool(true) 
    ["_origData":protected]=> NULL 
    ["_idFieldName":protected]=> NULL 
    ["_isDeleted":protected]=> bool(false) 
    ["_oldFieldsMap":protected]=> array(0) { } 
    ["_syncFieldsMap":protected]=> array(0) { } 
} 
```

我遇到的问题是我需要知道在管理面板中看到的货件的“标题”是什么。在管理面板中，我看到了这个：

```
+-----------------------+------------------------+------------------------+--------+
|        Carrier        |         Title          |         Number         | Action |
+-----------------------+------------------------+------------------------+--------+
| United Parcel Service | MI Expedited Irregular | 9102969006713002493469 | Delete |
+-----------------------+------------------------+------------------------+--------+ 
```

现在我要查找的是表格中的标题，即“MI Expedited Irregular”。我想要这样，所以我可以在代码中对其进行检查，以便它使用不同的跟踪 URL，然后使用对象的 url 变量中列出的跟踪 URL。但我不知道如何使用上面列出的对象来获取 Mage_Sales_Model_Order_Shipment_Track，我相信我正在寻找的特定数据是生命。在我最近的尝试中，我尝试了这个

```
$forder = Mage::getModel('sales/order')->loadByIncrementId($shipid);
foreach($forder->getShipmentsCollection() as $shipment){
    var_dump($shipment);
}

$ship_col = Mage::getResourceModel('sales/order_shipment_collection')->setOrderFilter($forder)->load();
var_dump($ship_col);
foreach($ship_col as $sc){
    var_dump($sc);
}
$ship_col = Mage::getResourceModel('sales/order_shipment_collection');
$ship_col->addAttributeToFilter('order_id', $forder->getId());
foreach($ship_col as $sc){
    $ship = Mage::getModel('sales/order_shipment');
    $ship->load($sc->getId());
    $ftrack = Mage::getModel('sales/order_shipment_track')->loadById($ship->getId());
    foreach($ftrack as $tr){
        var_dump($tr);
    }
} 
```

在所有这些尝试中，我得到的只是 var_dumps 中的 NULL/空结果。我尝试添加功能的文件是 popup.phtml，它位于 app/design/frontend/default//template/shipping/tracking 中。

因此，我想我要查找的两件事是 1）“标题”字段在哪里，如管理面板中装运详细信息页面上显示的表格中所示，在对象和表格的混合中麦金托？2）我如何获得该值，以便我可以对其进行检查？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T19:45:01.640

所以我终于想出了这个。我的最终目标是我想为不同的承运商添加一个 switch 语句，这样我就可以始终为每批货物提供一个跟踪链接。我知道我正在寻找的数据存在于 sales_flat_order_shipment 表中，并且通常位于 Mage_Sales_Order_Model_Shipment_Track 对象中，但无法弄清楚如何从 app/design/frontend/default//template/shipping/tracking/popup 内部到达那里.phtml。在继续使用 var_dumps 并阅读 error_logs 以及纯粹的试验和错误之后。这是我想出的有效代码。

```
<?php
    $ship_col = Mage::getResourceModel('sales/order_shipment_track_collection')->addAttributeToFilter('track_number', $track->getTracking())->load();
    foreach($ship_col as $sc){
        $trackMethod = $sc->getTitle();
    }
?> 
```

我还有更多的测试要做，以验证在处理部分装运等时一切正常，但这是我对单件装运所拥有的，它就像一个魅力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-05T12:24:49.443

这在寻找自定义标题时对我有用：

```
$order         = Mage::getModel('sales/order')->loadByIncrementId($orderId);
$shippingTitle = $order->getTracksCollection()->getFirstItem()->getTitle(); 
```

# .net - 在 Ajax.Beginform 的 OnComplete 事件函数中接收 JSON 数据

> ID：14968428
> 
> 赞同：3
> 
> 时间：2013-02-19T22:06:19.673
> 
> 标签：.net, ajax, json, asp.net-mvc-3

我正在尝试使用 Ajax.BeginForm 功能。

表单已正确发布，但我需要从控制器操作中检索 json 格式的数据，并使用操作结果消息刷新**div 。**

我在 Stackoverflow 中找到了一些建议，但没有一个有用。

这是找到的建议：

```
var data = content.get_response().get_object(); 
```

[但这对我不起作用](https://stackoverflow.com/questions/304233/how-to-use-ajax-beginform-mvc-helper-with-json-result)。而且我相信今天已弃用，仅适用于 MVC 2 及更低版本。我当前的**MVC**版本是**3**。

这是一段代码：

```
<script type="text/javascript">
   function fnCompleted(data){
    if(data.Success)
    $("#somediv").html(data.StatusMessage).addClass("success");
    else
    $("#somediv").html(data.StatusMessage).addClass("error");
   }
</script>

@{
   var ajaxOptions= new AjaxOptions{
                    OnComplete= "fnCompleted",
                    Url= '@Url.Action("myAction", "myController")',
                    Method= "POST"
 }     

<div id="somediv">/*Here goes the json response*/</div>

using(Ajax.BeginForm(ajaxOptions)){

 @Html.EditorForModel()
 <input type="submit" name="send" value="Send"> 
```

}

这是我的控制器操作的一部分：

```
[HttpPost]
 public JsonResult myAction(MyModel mymodel)
 {
  try
        {
            if (myModel== null)
                throw new Exception("The model is empty");
            if (!ModelState.IsValid)
                throw new Exception("The model is wrong");

            var found = /*Look for existence of the model in the database*/;
            if(found)
                throw new Exception("Already exists the object");

            /*Operation with the database*/

            var result = Json(
                new
                {
                    Success = true,//success
                    StatusMessage = "Object created successfully"
                });
            return result;
        }
        catch (Exception exception)
        {
            var result = Json(
                new
                {
                    Success = false,//error
                    StatusMessage = exception.Message
                });
            return result;
        }
   } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T14:35:59.653

对我们来说获得最佳解释的解释可能是：

当我们使用 OnComplete 和 JSON 时，响应直接嵌入到页面的 DOM 中。为此，建议使用 OnSuccess 和 OnFailure。这些实际上可以完美地处理来自控制器操作的 JSON 结果。

我将你们汇给[帮助我的链接，这与我之前忽略的相同](https://stackoverflow.com/questions/304233/how-to-use-ajax-beginform-mvc-helper-with-json-result)，我继续阅读并找到了**Joel Purra 的**答案。

在您的 Ajax.BeginForm 中：

```
new AjaxOptions
{
    **OnFailure** = "onTestFailure",
    **OnSuccess** = "onTestSuccess"
} 
```

脚本块：

```
<script>
//<![CDATA[

function onTestFailure(xhr, status, error) {

    console.log("xhr", xhr);
    console.log("status", status);       

    // TODO: make me pretty
    alert(error);
}

function onTestSuccess(data, status, xhr) {

    console.log("data", data);
    console.log("status", status);
    console.log("xhr", xhr);

    // Here's where you use the JSON object
    //doSomethingUseful(data);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T00:20:52.863

有没有办法将结果存储在视图 OnComplete JS 函数中？

当然，有多种方法可以存储控制器接收到的数据，我可以建议您使用客户端模型，例如骨干网模型。

使用backbone.js 模型可以在客户端存储格式正确的JSON 数据对象和集合。

另一种方法是使用隐藏的浏览器变量将少量数据存储在隐藏的输入控件中是可行的。

另一种方法是使用基于会话的 cookie。

编辑：如果使用了像backbone.js这样的客户端MVC，可能需要重新访问您当前的视图设计。但从长远来看，我认为这是有益的。

# sql - Doctrine 2.1 where foreign key id =?，编辑：在 Doctrine 2.2 中修复

> ID：14968432
> 
> 赞同：8
> 
> 时间：2013-02-19T22:06:37.213
> 
> 标签：sql, doctrine-orm

我在这里查看了很多与 Doctrine 2.1 中似乎严重缺乏功能有关的答案，这可能是 OOP 正确性胜过关系理智的结果。

我有两个具有多对一关系的表，文章和成员。一个会员可以有许多已发表的文章。拥有方的注释是

```
/**
 * @var \Member
 * @ORM\ManyToOne(targetEntity="Member")
 * @ORM\JoinColumns({
 *   @ORM\JoinColumn(name="member_id", referencedColumnName="id")
 * })
 */
 private $member; 
```

我想获取成员 6 的所有活动文章，这是 SQL 中的一个简单查询：

```
SELECT * FROM mbr_article 
   WHERE active = 1 AND member_id = 6 
   ORDER BY article_id DESC 
```

我最终得到的是

```
$rep = $this->getDoctrine()->getRepository('SMWMemberBundle:Article');
$q = $rep->createQueryBuilder('a')
     ->leftJoin('a.member','m')    
     ->where('m.id = ?1')
     ->andWhere('a.active = 1')
     ->orderBy('a.id', 'DESC')
     ->setParameter(1, $id)    
     ->getQuery(); 
```

这产生了

```
SELECT m0_.id AS id0, m0_.active AS active1, m0_.update_time AS update_time2,
       m0_.content AS content3, m0_.member_id AS member_id4 
   FROM mbr_article m0_ 
   LEFT JOIN mbr_member m1_ ON m0_.member_id = m1_.id 
   WHERE m1_.id = ? AND m0_.active = 1 
   ORDER BY m0_.id DESC 
```

它可以工作并且可能不会慢很多，但是不需要 JOIN ，因为我已经有了 Member 对象。当我以另一种方式尝试时，我得到了所有文章，而不仅仅是活跃的文章。

我已经看到诸如[Can you get a foreign key from an object in Doctine2 without loading that object？](https://stackoverflow.com/questions/8211679/can-you-get-a-foreign-key-from-an-object-in-doctine2-without-loading-that-object)使用`getEntityIdentifier`并提到了 2.2 中的改进，我可以说`IDENTITY(member)`。

在 Doctrine 2.1 中是否有合理的方法来做到这一点？增强功能是否允许`andWhere('IDENTITY(member) = ?')`在查询生成器中使用？

编辑：

感谢@Ocramius， ->where('IDENTITY(a.member) = ?1') 在 Doctrine 2.2 中确实有效

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-19T23:19:46.933

IDENTITY 适用于由 Doctrine 2.2 中的查询生成器生成的 WHERE 子句，例如。

```
$q = $rep->createQueryBuilder('a')
    ->where('IDENTITY(a.member) = ?1')
    ->andWhere('a.active = 1')
    ->orderBy('a.id', 'DESC')
    ->setParameter(1, $id)    
    ->getQuery(); 
```

生成以下 SQL：

```
SELECT m0_.id AS id0, m0_.active AS active1, m0_.update_time AS update_time2, 
       m0_.content AS content3, m0_.member_id AS member_id4 
    FROM mbr_article m0_ 
    WHERE m0_.member_id = ? AND m0_.active = 1 
    ORDER BY m0_.id DESC 
```

# xml - 使用 XSD 和 xmlns="" 验证 XML

> ID：14968433
> 
> 赞同：4
> 
> 时间：2013-02-19T22:06:37.897
> 
> 标签：xml, xsd, xml-namespaces

我有 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<song id="id1" 
          xmlns="urn:Test:Song:1.0" 
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
          xsi:schemaLocation="urn:Test:Song:1.0 song.xsd">
  <name>name1</name>
</song> 
```

它无法针对 XSD 进行验证：

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema xmlns="urn:Test:Song:1.0" 
               targetNamespace="urn:Test:Song:1.0" 
               xmlns:xs="http://www.w3.org/2001/XMLSchema" >

  <xs:element name="song">
  <xs:complexType>
    <xs:sequence>
      <xs:element name="name" type="xs:string" minOccurs="0" />
    </xs:sequence>
    <xs:attribute name="id" type="xs:string" />
  </xs:complexType>
  </xs:element>
</xs:schema> 
```

在 Eclipse 和 Visual Studio 中。在 Eclipse 中，错误是：cvc-complex-type.2.4.a：发现以元素“名称”开头的无效内容。应为“{name}”之一。

XML 验证成功：

```
<?xml version="1.0" encoding="utf-8"?>
<song id="id1" 
          xmlns="urn:Test:Song:1.0" 
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
          xsi:schemaLocation="urn:Test:Song:1.0 song.xsd">
  <name xmlns="">name1</name>
</song> 
```

唯一的区别是名称元素上的 xmlns=""。有没有办法在不使用“无命名空间”的情况下使验证成功？究竟是什么导致第一个 XML 失败？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T22:23:14.100

您需要将`elementFormDefault="qualified"`属性添加到您的架构`<xs:schema>`元素。

只有全局定义的元素和属性会自动在模式目标命名空间中。在定义中定义的元素`<complexType>`称为本地元素。属性`elementFormDefault`定义本地元素是否应该被限定。对于属性，有`attributeFormDefault`属性。

这些属性的默认值为`unqualified`。因此，在您的架构中，该元素`<name>`被认为没有命名空间 URI。通常所有元素都希望在目标命名空间中，因此使用`elementFormDefault="qualified"`属性是一种常见的做法。另一方面，属性通常不应该有命名空间，所以`attributeFormDefault`经常被省略。

W3C 推荐中的更多信息[http://www.w3.org/TR/xmlschema-0/#re​​f50](http://www.w3.org/TR/xmlschema-0/#ref50)

# javascript - Moustache.js 中的列表和来自 mongodb 的 bson 数据

> ID：14968438
> 
> 赞同：1
> 
> 时间：2013-02-19T22:06:58.953
> 
> 标签：javascript, jquery, node.js, mongodb, mustache

嗨，我是小胡子的新手，最近一直在玩它。

我喜欢它的简单性以及它只专注于演示的方式。没有逻辑！

在 node.js 中使用 mongodb 和 mongoose 时，我要求一个名为 products 的集合。目前我收到的所有文件都非常小。

显示此数据时，我想使用小胡子的列表功能。

```
<script id="listTemplate" type="text/html" >
{{#.}}
<div class="singleItem">
    <div class="title">{{title}}</div>
    <div class="description">{{description}}</div>
</div>
{{/.}}
</script> 
```

我正在使用的 BSON 响应是：

```
[
  {
    "title": "item",
    "description": "All about the details. Of course it's black.",
    "style": "12345",
    "_id": "5116874d2ac8dc2804000001",
    "__v": 0,
    "modified": "2013-02-09T17:28:45.000Z"
  },
  {
    "title": "item",
    "description": "All about the details. Of course it's black.",
    "style": "12348",
    "_id": "511688222ac8dc2804000003",
    "__v": 0,
    "modified": "2013-02-09T17:32:18.000Z"
  }
 ] 
```

结果是一个数组，mustache 在其模板中需要一个数组名称吗？是否可以使用正确的语法将 BSON 直接打入 mustache 模板？

我可以在 mongo 的响应中添加一个数组名称吗？甚至通过节点。{{arrayname}} & {{/arrayname}}

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:16:53.890

You are pretty much there. Assuming that `data` = BSON data segment you provided and `template` = the template you provided, this should work:

```
Mustache.render(template, data) 
```

For example, a simplified example of this would be the following:

```
console.log(Mustache.render('{{#.}}{{a}}{{/.}}', [{a:'bob'}, {a:'jim'}])); 
```

That will output:

```
bobjim 
```

Are you having problems with this syntax? Which Mustache variant are you using. The latest version is here: [https://github.com/janl/mustache.js](https://github.com/janl/mustache.js)

# ios - iOS悬停效果点击而不是点击

> ID：14968439
> 
> 赞同：3
> 
> 时间：2013-02-19T22:07:03.837
> 
> 标签：ios, css, hover

我一直认为 iOS 设备上的悬停效果仅在完整的“点击”（或“触摸”）时可见，但后来我发现了这个页面：

[http://www.theverge.com/2013/2/19/4004250/sunrise-for-iphone-calendar-app-for-a-post-google-world](http://www.theverge.com/2013/2/19/4004250/sunrise-for-iphone-calendar-app-for-a-post-google-world)

在这里，当我点击一个元素（没有延迟）时，悬停效果是可见的，当我离开手指时离开 - 不需要完全点击。

我不明白。诀窍是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-19T23:32:55.043

我知道了！

只需添加`ontouchstart=""`到您的身体标签：

```
<body ontouchstart=""> ... 
```

# python - 无论如何提供 os.walk 的进展？

> ID：14968441
> 
> 赞同：2
> 
> 时间：2013-02-19T22:07:07.037
> 
> 标签：python

`for root, dirs, files in os.walk(rootDir, topdown='true'):`是python脚本中经常使用的东西。只是想知道这里有什么众所周知的方法可以提供进展吗？当您有一个大型文件夹结构时，此 API 可能需要一段时间？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T00:29:13.873

本身无法为您提供`walk`进度，因为无法提前知道某个目录树下有多少条目。*

但是，在大多数使用 的程序中`walk`，您实际上是*在*`stat`对文件进行操作，这通常比隐式调用花费的时间要长得多。例如，`os.walk`在其中抓取我的第一个程序`list(os.walk(path))`需要 2.301 秒，而我的实际功能（尽管只对这些文件的一小部分进行操作）需要 139.104 秒。我认为这种事情很典型。

因此，您可以先阅读整个步行过程（例如，使用`list(os.walk(path))`），然后使用该信息生成实际工作的进度。

在实际的程序中，您可能希望在执行 时显示带有“正在确定大小...”之类的标签的“不确定进度条” `list(os.walk(path))`，然后将其替换为带有“0/12345 文件”的百分比进度条一次完成了。（事实上​​，我打算将那个不确定的进度条添加到我的程序中，现在我已经想到了这个想法……）

（对于单线程交互式程序，您显然不想只是阻塞；您可以在后台线程中执行此操作并`list(os.walk(path))`回调主线程，或者每次通过事件循环等）`walk``runLater`

* 这不是因为没有文件系统或操作系统*可以*做这样的事情，只是因为他们*没有*. 显然会有一些折衷——例如，如果您必须遍历整个树的更新计数，则创建和删除大量小文件会慢很多。Classic Mac 过去通过在 Finder 信息中保留缓存计数来解决这个问题……这很棒，除了这意味着调用可能需要 1us 或 1min 才能返回，而无法提前预测（或中断它）以编程方式。

# python - Pandas：合并列上的两个数据框，但只保留不同列的数据

> ID：14968445
> 
> 赞同：1
> 
> 时间：2013-02-19T22:07:24.937
> 
> 标签：python, pandas

我有 2 个数据帧：frame1 和 frame2

```
In [10]: frame1[:5]
Out[10]:
    cid
0   531
1  1102
2  1103
3  1406
4  1409

In [14]: frame2[:5]
Out[14]:
     cid   media_cost     imps  booked_revenue
0  72692    29.671446    13918       84.961853
1  72704  3121.781201  6992946     9912.982516
2    531     0.001540        2        0.000000
3  39964  2307.119001  3997167     5425.629736
4  72736    45.716847   143574       56.280000 
```

frame1 有 60,888 行，frame2 有 139,846 行。

使用这两个数据框，我想创建第三个数据框，它基本上由 frame2 组成，并删除了它与 frame1 共享的所有 cid 值。所以，在这个例子中，我想要一个 frame3，它是 frame2，没有**第 2 行，cid 531，**它与 frame1 共享。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:12:02.300

怎么样：

```
>>> f1
    cid
0   531
1  1102
2  1103
3  1406
4  1409
>>> f2
     cid   media_cost     imps  booked_revenue
0  72692    29.671446    13918       84.961853
1  72704  3121.781201  6992946     9912.982516
2    531     0.001540        2        0.000000
3  39964  2307.119001  3997167     5425.629736
4  72736    45.716847   143574       56.280000
>>> f2[~f2.cid.isin(f1.cid)]
     cid   media_cost     imps  booked_revenue
0  72692    29.671446    13918       84.961853
1  72704  3121.781201  6992946     9912.982516
3  39964  2307.119001  3997167     5425.629736
4  72736    45.716847   143574       56.280000 
```

# angularjs - Angular.js selecting from a hash / object

> ID：14968449
> 
> 赞同：1
> 
> 时间：2013-02-19T22:07:43.447
> 
> 标签：angularjs

I have a simple dropdown:

```
 {{x}}            
 <select ng-model="x" ng-options="k for k in [1,2,3]"></select> 
```

easy: {{x}} will be replaced with the selected value 1, 2 or 3.

But what if my data looks like this?

```
 <select ng-model="x" ng-options="k.a for k in [{a:1},{a:2},{a:3}]"> 
```

I want the ones, twos and threes depending on selection but I usually get "{a:1}".

Hm.. [this](https://groups.google.com/forum/#!topic/angular/OqFpB4souEI) suggests that maybe I won't get what I want. Ideas?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:24:35.450

你只少了一件。

如果您查看 的[文档`ng-options`](http://docs.angularjs.org/api/ng.directive%3aselect)，则理解表达式可以采用多种形式。

您拥有的表格是`label for value in array`. 使用这种形式，当您选择一个选项时，它会为您提供数组项的整个值，在您的情况下类似于`{a: 1}`.

您可以使用的其他形式之一是`select as label for value in array`. 您在 from 中添加一个额外的表达式，***该***表达式的结果将绑定到您的模型。

所以像：

```
ng-options="k.a as k.a for k in [...]" 
```

然后您将获得`a`所选数组项的属性值。

[这是给你的小提琴](http://jsfiddle.net/SyCSK/)。

# objective-c - How to create a global alias for an Objective-C class?

> ID：14968454
> 
> 赞同：1
> 
> 时间：2013-02-19T22:07:52.313
> 
> 标签：objective-c, xcode, alias, autocorrect

I keep typing `NSStrung` and `NSStrong` for `NSString`. It was so bad today, it made me wish I had a global alias for those so they worked just like `NSString`.

This made me wonder if this is somehow possible to setup a global alias for a class name (or function) in Xcode? Without writing code that is.

Perhaps there's even some way that I can Xcode to autocorrect NSStrung and NSStrong to NSString, or a tool that does this in any program.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-04-08T08:03:47.783

您正在寻找的当然是：

`@compatibility_alias ExistingClass OldClass;`

它非常简单，但如果您需要更多信息，可以在[GCC 手册](http://gcc.gnu.org/onlinedocs/gcc/compatibility_005falias.html)或[此 NSHipster 文章中阅读相关信息](http://nshipster.com/at-compiler-directives/)

答案很晚，但您的问题是 DuckDuckGo 中`objective-c class alias`搜索词的第一个链接

编辑：[在这个 SO 上回答了一个相关问题](https://stackoverflow.com/questions/14107441/how-to-use-compatibility-alias-to-alias-classes-for-previous-versions-of-ios)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T22:30:21.023

我认为您应该尝试做对，但作为您问题的可能答案，您可以在“语言和文本”系统偏好设置中设置 NSStrong 和 NSStrung 文本替换条目。在 Xcode 中启用 Edit > Format > Substitutions > Text Replacement。

理论上应该可以，但是现在我已经在我的电脑上尝试过了，它似乎并不一致，并且不会每次都进行替换。这个问题可能是我的电脑特有的，所以也许试试看。

另一个帮助您的选项是为 NSString 添加一个片段，其中“快捷方式”为 NSStrung/NSStrong ，这样当您输入它时，您只需按 enter/return/tab 即可获得正确的`NSString`. 不利的一面是，如果您按下空格键，它不会纠正它，这是您不看屏幕时通常会做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-26T05:38:42.263

我刚刚回答了我的一个问题并记住了这一点。[这](https://stackoverflow.com/q/16228725/1311910)是我的问题。

基本上你可以做的是`#define NSStrung NSString`在默认的 Prefix.pch 文件中有（和其他）。

我建议在您自己的自定义模板中执行此操作，但您也可以通过打开 plist`/Applications/Xcode.app/Contents/Developer/Library/Xcode/Templates/Project Templates/Base/Base.xctemplate/TemplateInfo.plist`并在键的值中添加您的#defines（如上所述）来执行此操作`Definitions > ___PACKAGENAME___-Prefix.pch > Beginning`。

这绝对不是最佳实践，但它可以解决您的问题。使用风险自负。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-26T16:29:10.540

typedef 怎么样。

```
typedef exist_class new_class; 
```

* * *

## 回答 #5

> 赞同：-10
> 
> 时间：2014-01-26T00:18:14.810

这很容易/很棒/我一直都这样做（甚至毫不掩饰*地极端*）..

有关如何在您的代码/免责声明等中使用的好建议，请参阅@7usam 的答案...... [但请转到我的项目的 AtoZMacroDefines.h 以获得更多的好处](https://github.com/mralexgray/AtoZ.framework/blob/Core/AtoZMacroDefines.h)......

```
#define            NSR NSRect
#define           NSPI NSProgressIndicator
#define        NSSPLTV NSSplitView
#define          NSTSK NSTask
#define            NSS NSString
#define           NSIV NSImageView
#define          NSBWM NSBorderlessWindowMask
#define           NSDO NSDragOperation
#define         NSSEGC NSSegmentedControl
#define            NST NSTimer
#define          NSRNG NSRange
#define          NSMIS NSMutableIndexSet
#define         NSTBAR NSToolbar
#define           NSSZ NSSize
#define          NSAPP NSApplication
#define           NSDE NSDirectoryEnumerator
#define          NSVAL NSValue
#define       NSDCLASS NSDictionary.class
#define           NSFH NSFileHandle
#define         NSBUTT NSButton
#define       NSURLRES NSURLResponse
#define            NSV NSView
#define            NSA NSArray 
```

我实际上是[从 plist](https://github.com/mralexgray/AtoZ.framework/blob/Core/AtoZMacroDefines.plist)创建这个文件，它很容易编辑，等等......然后我有一个为我生成标题的机制。再一次，看看这个项目，如果这种 ⓢi✝ 满足*你的喜好*..

对于所有讨厌的玩家......谁想要*真正使用他们的代码......喘不过气来......其他人*......您可以轻松地在“标准”/“长格式”和“内部”“快捷方式之间移动“ [通过 git 的 smudge and clean](https://github.com/gilesbowkett/git-smudge-and-clean)，没有人知道你肮脏的小秘密。只需在签出/提交之前/之后处理/处理您想要的“替换”等。

# ruby - 续集：为什么保存方法不保存？

> ID：14968457
> 
> 赞同：0
> 
> 时间：2013-02-19T22:07:58.330
> 
> 标签：ruby, sequel

我一定在这里遗漏了一些超级简单的东西。在下面的 rspec 代码中，第二个断言失败，代码应该设置为 true：

```
 describe "#redeem!" do

    it "marks a code as redeemed" do
      existing_code = LotteryCode[promo_code: "A5"]
      existing_code.is_redeemed.should == false
      existing_code.redeem!
      changed_code = LotteryCode[promo_code: "A5"]
      changed_code.is_redeemed.should == true
    end
  end 
```

这是模型代码：

```
require 'sequel'

class LotteryCode < Sequel::Model

  many_to_one :campus

  def redeem!
    is_redeemed = true
    save
  end

end 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:13:08.053

您想要`self.is_redeemed = true`，您当前的代码只是创建一个局部变量。

# javascript - 父单元格的输出 id

> ID：14968460
> 
> 赞同：1
> 
> 时间：2013-02-19T22:08:11.093
> 
> 标签：javascript, jquery, html

我四处搜索，实际上从 Stackoverflow 上类似的另一个问题中得到了帮助，但是我似乎无法让它工作。当用户点击它时，我正在尝试输出父单元格 ID。HTML：

```
<table>
<tr>
<td class='test' id='1'><img src='images/dog.gif'/></td>
<td class='test' id='2'><img src='images/cat.gif'/></td>
<td class='test' id='3'><img src='images/mouse.gif'/></td>
<td class='test' id='4'><img src='images/human.gif'/></td>
</tr> 
```

JS：

```
$('.test').on('click', 'td', function(e)
{ alert(this.id); }) 
```

有什么帮助吗？另外我将如何在页面上将其显示为文本而不是警报？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:09:22.810

这里不需要使用事件委托，也应该从元素的静态父元素之一委托事件，而不是元素本身，试试这个：

```
$(document).ready(function() { // when DOM is ready
    $('td.test').click(function(e) { 
       alert(this.id); 
    })
}) 
```

如果要将值设置为另一个元素的文本内容，可以使用`text`方法：

```
$('#element').text(this.id); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:19:07.313

您可以在当前 html 的末尾添加一个 div，如下所示：

```
<table>
<tr>
<td class='test' id='1'><img src='images/dog.gif'/></td>
<td class='test' id='2'><img src='images/cat.gif'/></td>
<td class='test' id='3'><img src='images/mouse.gif'/></td>
<td class='test' id='4'><img src='images/human.gif'/></td>
</tr>
<div id='output'></div> 
```

并将您的警报更改为

```
$('#output').append(this.id + '<br>'); 
```

现在，这将在您的 div 中创建一行，其中包含您单击的单元格的 id。将此与 undefined 对事件处理程序的更改结合起来，一切就绪。

# iframe - Cross domain iframe height - I have control over both domains and need to navigate the iframe

> ID：14968462
> 
> 赞同：0
> 
> 时间：2013-02-19T22:08:20.727
> 
> 标签：iframe, navigation, height, cross-domain

I have a page where I need to embed a simple web-store from another domain which I have control over (a Big Cartel store).

I need to get the height of the iframe and I need to be able to navigate it.

I have tried out multiple things now. Some work in a way, but have problems like not working in all browsers, refreshing when navigating inside the iframe etc.

Is there a way that could work in my case?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T06:59:16.120

我认为你需要的是[postMessage](https://developer.mozilla.org/en/DOM/window.postMessage)

也请看看这个[帖子](https://stackoverflow.com/questions/3683163/accessing-parent-window-variable-from-an-cross-domain-iframe/14213116#14213116)

# heroku - App limit on a single Heroku account

> ID：14968464
> 
> 赞同：41
> 
> 时间：2013-02-19T22:08:25.223
> 
> 标签：heroku

Is there a limit to the number of apps I can host with a single Heroku account?

I currently run multiple apps each using 1 dyno for free. But could I host hundreds (or even thousands) of small applications for free?

I also know there is a 2TB bandwidth soft limit, but is there any other limitation I could encounter?

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-07-03T19:36:13.917

A clear answer surfaced in the Heroku July 2013 newsletter about platform limits. The maximum number of apps per account is 100.

Reference: [https://devcenter.heroku.com/articles/limits#maximum-number-of-apps](https://devcenter.heroku.com/articles/limits#maximum-number-of-apps)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-02-19T23:18:23.307

目前您可以创建的应用程序数量没有限制，但请参阅[Heroku 服务条款](https://policy.heroku.com/tos)第 4.4 条。

```
You may not develop multiple Applications to simulate or act as a single
Application or otherwise access the Heroku Services in a manner intended
to avoid incurring fees. 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-11-22T09:39:11.893

如果您有未验证的帐户，则应用程序的最大数量仅为 5 个，已验证的帐户数量为 100。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-02-07T08:58:10.653

未经验证的帐户最多可以创建 5 个应用程序。经过验证的帐户可以创建不超过 200 个应用程序。

来源：[https ://devcenter.heroku.com/articles/limits#maximum-number-of-applications](https://devcenter.heroku.com/articles/limits#maximum-number-of-applications)

PS：要验证您的帐户，您需要提供付款方式（信用卡/借记卡/预付卡）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-25T00:54:01.330

已验证帐户最多可以创建 100 个应用程序，而未验证帐户最多只能创建 5 个应用程序。要获得验证，您必须在帐户设置部分添加您的信用卡详细信息。或者，您也可以使用团队帐户。

来源：[https ://devcenter.heroku.com/articles/limits](https://devcenter.heroku.com/articles/limits)

# ios - Sprite not remove from scene iOS

> ID：14968476
> 
> 赞同：0
> 
> 时间：2013-02-19T22:08:53.037
> 
> 标签：ios, cocos2d-iphone, sprite

I'm making a JewelDash type game. For some reason after a while, 1 sprite which was supposed to be removed from the scene didn't. That sprite won't respond to touch, nothing, it just there. Hangout underneath other newly created sprites. What might be the cause of this?

I added all my sprites into a spritesArray. Whenever user touch a block, I loop through spritesArray and identify which sprite was touched. The fact that it doesn't respond to touch telling me that it was removed from spritesArray

This happens when many sprites get removed at the same time. And rarely happen.

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T05:43:26.787

如果您使用的是 NSMuttableArray，则可能会发生您没有分配 init spritesArray 的情况，因此在添加任何精灵之前在 init 方法中分配初始化它有时这发生在我身上，所以我无法访问任何精灵，因为数组未初始化。我得到我的数组 nil

也将孩子从自我中移除

```
[spritesArray removeObject:sprite name];
[self removeChild:sprite name cleanup:YES]; 
```

试试这个可能会有所帮助

# java - Figuring out where Android stores files

> ID：14968477
> 
> 赞同：0
> 
> 时间：2013-02-19T22:08:54.013
> 
> 标签：java, android, file

I am writing to a file in my application. I want to find the file to check that the file has been written correctly (and so I can access the file via a web view). Here is the code I am using to write the file:

```
try {
    FileOutputStream fos = openFileOutput("rules.txt", Context.MODE_PRIVATE);
    fos.write(content.getBytes());
    fos.close();
} 
catch (Exception e) {
    e.printStackTrace();
} 
```

and then I use this to get the directory of the file:

```
getFilesDir() 
```

However the string it provides is not available as a directory on the my device (hidden files are shown).

Any help would be appreciated!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:11:26.020

Android 将您的内部文件写入`/data/data/<your package name>/files/<filename>`. 除非您是 root，否则您无法通过文件浏览器或其他方式访问它。

# haskell - Count inversions: StackOverflowError in Frege, works fine in Haskell

> ID：14968480
> 
> 赞同：4
> 
> 时间：2013-02-19T22:09:00.547
> 
> 标签：haskell, frege

I am trying to count inversions for a list of numbers. The following Frege program works for small set of numbers but throws StackOverflowError for 100000 numbers.

```
import frege.IO

inversionCount [] _ = (0, [])
inversionCount [x] _ = (0, [x])
inversionCount xs n = (count, sorted) where
  count = lcount + rcount + mergecount
  (lcount, lsorted) = inversionCount left lsize
  (rcount, rsorted) = inversionCount right rsize
  (mergecount, sorted) = inversionMergeCount lsorted lsize rsorted rsize (0, [])
  (left, right) = splitAt mid xs
  mid = n `quot` 2
  lsize = mid
  rsize = n - mid

inversionMergeCount xs _ [] _ (acc,sorted) = (acc, reverse sorted ++ xs)
inversionMergeCount [] _ ys _ (acc,sorted) = (acc, reverse sorted ++ ys)
inversionMergeCount (xs@(x:restx)) m (ys@(y:resty)) n (acc, sorted)
  | x < y = inversionMergeCount restx (m - 1) ys n (acc, x:sorted)
  | x > y = inversionMergeCount xs m resty (n - 1) (acc + m, y:sorted)
  | otherwise = inversionMergeCount restx (m - 1) resty (n - 1) (acc, x:y:sorted)

main (fileName:_) = do
  input <- readFile fileName
  let xs = map atoi (lines input)
  println . fst $ inversionCount xs 100000

--Haskell's readFile using Java's Scanner
type JScanner = JScannerT RealWorld

data JScannerT s = native java.util.Scanner where
  native new :: File -> ST s (Exception JScanner)
  native useDelimiter :: JScanner -> String -> ST s JScanner
  native next :: JScanner -> ST s String

readFile f = do
  file <- File.new f
  exceptionScanner <- JScanner.new file
  let scanner = either throw id exceptionScanner
  scanner.useDelimiter "\\Z"
  scanner.next 
```

The same code in Haskell works fine:

```
import System.Environment

inversionCount [] _ = (0, [])
inversionCount [x] _ = (0, [x])
inversionCount xs n = (count, sorted) where
  count = lcount + rcount + mergecount
  (lcount, lsorted) = inversionCount left lsize
  (rcount, rsorted) = inversionCount right rsize
  (mergecount, sorted) = inversionMergeCount lsorted lsize rsorted rsize (0, [])
  (left, right) = splitAt mid xs
  mid = n `quot` 2
  lsize = mid
  rsize = n - mid

inversionMergeCount xs _ [] _ (acc,sorted) = (acc, reverse sorted ++ xs)
inversionMergeCount [] _ ys _ (acc,sorted) = (acc, reverse sorted ++ ys)
inversionMergeCount (xs@(x:restx)) m (ys@(y:resty)) n (acc, sorted)
  | x < y = inversionMergeCount restx (m - 1) ys n (acc, x:sorted)
  | x > y = inversionMergeCount xs m resty (n - 1) (acc + m, y:sorted)
  | otherwise = inversionMergeCount restx (m - 1) resty (n - 1) (acc, x:y:sorted)

main = do
  (fileName: _) <- getArgs
  contents <- readFile fileName
  let xs :: [Int]
      xs = map read (lines contents)
  print . fst $ inversionCount xs 100000 
```

What could be the cause for stack overflow? Is it some function not being tail-recursive?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T23:23:42.890

Haskell 很可能有更好的严格性分析器，或者尾递归的实现方式不同，或者运行时只是有更多可用的堆栈。

我会尝试的第一件事是设置-Xss8m，甚至16m。

如果这没有帮助，请记住，使用 (-)、(+) 等严格函数的应用程序更新的惰性参数会构建有时稍后必须立即评估的 thunk。这与 with 的问题相同`foldl`，看起来 inversionMergeCount 和 inversionCount 的第二个参数受此影响。

如果 Frege 编译器看到这一点，它应该对此发出警告，但目前还没有。

另一点是，为什么要在元组中传递最后两个参数？您也可以使 acc 严格。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-20T06:51:04.540

根据 Ingo 的建议，我进行了更改，代码现在可以正常工作。我还必须计数`Integer`而不是`Int`避免 int 溢出。这是带有严格注释和`Integer`转换的更新代码：

```
inversionCount [] _ = (zero, [])
inversionCount [x] _ = (zero, [x])
inversionCount xs n = (count, sorted) where
  count = lcount + rcount + mergecount
  (lcount, lsorted) = inversionCount left lsize
  (rcount, rsorted) = inversionCount right rsize
  (mergecount, sorted) = inversionMergeCount lsorted lsize rsorted rsize zero []
  (left, right) = splitAt mid xs
  mid = n `quot` 2
  lsize = mid
  rsize = n - mid

inversionMergeCount xs _ [] _ !acc sorted = (acc, reverse sorted ++ xs)
inversionMergeCount [] _ ys _ !acc sorted = (acc, reverse sorted ++ ys)
inversionMergeCount (xs@(x:restx)) !m (ys@(y:resty)) n !acc sorted
  | x < y = inversionMergeCount restx (pred m) ys n acc (x:sorted)
  | x > y = inversionMergeCount xs m resty (pred n) (acc + m.big) (y:sorted)
  | otherwise = inversionMergeCount restx (pred m) resty (pred n) acc (x:y:sorted) 
```

# jquery - Is there a way to remove optgroup without destroying the code?

> ID：14968481
> 
> 赞同：4
> 
> 时间：2013-02-19T22:09:13.740
> 
> 标签：jquery, drop-down-menu

All I was attempting was to edit some old code, where I had made an option group, but now I'd like to take it away. I can't just do it with css because it's using the chosen plugin.

```
function flavorChooser (title, item) {
var title = 'hidden';
var optgroup = jQuery('<optgroup display="' + title + '"/>');

jQuery.each(item, function(sub_title, sub_item) {
    if (typeof sub_item[0] !== "undefined") {
        var opt = jQuery('<option value="' + sub_item[0] + '" data-store-locator-value="' + sub_item[0] + '">' + sub_title + '</option>');
        optgroup.prepend(opt);
    }
});
// console.log('chozen ');
// jQuery('.chzn-container .chzn-results .group-result').css('display', 'none');
return optgroup; 
```

}

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-19T22:16:36.040

This works to remove all of the `optgroup` children of a given `select` element:

Markup:

```
<select id="mySelect">
    <optgroup label="MyGroup"></optgroup>
    <option>Option</option>
    <option>Option</option>
    <option>Option</option>
    <option>Option</option>
    <optgroup label="MyGroup2"></optgroup>
    <option>Option</option>
    <option>Option</option>
    <option>Option</option>
</select> 
```

jQuery:

```
 $(function () {
        $("#mySelect").children().remove("optgroup");
    }); 
```

jsFiddle: [http://jsfiddle.net/frJEq/](http://jsfiddle.net/frJEq/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-02T09:42:23.080

这是如何从标签中找到它并删除，

```
$("#mySelect").children().remove("optgroup[label='MyGroup']"); 
```

ps 这就是我想要的，为了他人的利益而出版

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-09T04:33:31.673

```
$("#mySelect").children().remove('optgroup[label=MyGroup2]');
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<select id="mySelect">
	<optgroup label="MyGroup">
		<option>Option1</option>
		<option>Option2</option>
		<option>Option3</option>
		<option>Option4</option>
	</optgroup>
		<optgroup label="MyGroup2">
		<option>Option5</option>
		<option>Option6</option>
		<option>Option7</option>
	</optgroup>
</select>
```

# java - Calendar.getTime() fails with java.lang.IllegalArgumentException:MINUTE for Asia/Singapore timezone

> ID：14968483
> 
> 赞同：3
> 
> 时间：2013-02-19T22:09:15.920
> 
> 标签：java, date, calendar, timezone

Why is this code failing? The purpose was to remove the time part.

```
String dateStr = "1982-01-01";
String timeZoneID = "Asia/Singapore";

DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
Date date = dateFormat.parse(dateStr);      

Calendar calendar = Calendar.getInstance();
calendar.setTimeZone(TimeZone.getTimeZone(timeZoneID));
calendar.setLenient(false);
calendar.setTime(date);
calendar.set(Calendar.HOUR_OF_DAY, 0);
calendar.set(Calendar.MINUTE, 0);
calendar.set(Calendar.SECOND, 0);
calendar.set(Calendar.MILLISECOND, 0);

System.out.println(calendar.getTime()); 
```

The error message:

```
Exception in thread "main" java.lang.IllegalArgumentException: MINUTE
    at java.util.GregorianCalendar.computeTime(GregorianCalendar.java:2482)
    at java.util.Calendar.updateTime(Calendar.java:2265)
    at java.util.Calendar.getTimeInMillis(Calendar.java:1049)
    at java.util.Calendar.getTime(Calendar.java:1022)
    at Prog.main(Prog.java:31) 
```

It works fine for the following input:

*   dateStr = "1982-01-01", timeZoneID = "Europe/Berlin"
*   dateStr = "1981-01-01", timeZoneID = "Asia/Singapore"
*   dateStr = "1982-01-01", timeZoneID = "Asia/Seoul"

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T22:13:51.807

您的代码从 1982 年 1 月 1 日开始，并将 HOUR_OF_DAY 和 MINUTE 都设置为 0。

但是在 1982 年 1 月 1 日，新加坡没有 12:00:00 AM。1981 年 12 月 31 日晚上 11 点 59 分 59 秒之后，新加坡领先半小时到凌晨 12 点 30 分。它之前是在 UTC+7:30，但移到了 UTC+8 的整小时区域。

资料来源：[新加坡标准时间](https://en.wikipedia.org/wiki/Singapore_Standard_Time)和[timeanddate.com](http://www.timeanddate.com/worldclock/timezone.html?n=236&syear=1980)。另请参阅[*为什么新加坡在“错误”时区？*](http://www.math.nus.edu.sg/aslaksen/teaching/timezone.html)新加坡时间简史。

# string - Perl 字符串解析为哈希

> ID：14968488
> 
> 赞同：-1
> 
> 时间：2013-02-19T22:09:51.037
> 
> 标签：string, perl, parsing, hash

所以可以说我有字符串。

```
 $my str = "Hello how are you today. Oh thats good I'm glad you are happy. Thats wonderful; thats fantastic." 
```

我想创建一个哈希表，其中每个键都是一个唯一的单词，值是它在字符串中出现的次数，即我希望它是一个自动化的过程。

```
my %words {
  "Hello" => 1,
  "are" => 2,
  "thats" => 2,
  "Thats" => 1
  }; 
```

老实说，我是 PERL 的新手，不知道如何做到这一点，如何处理标点符号等。

更新：

另外，是否可以使用

```
 split('.!?;',$mystring) 
```

不是使用这种语法，而是基本上以 . 或者 ！或者 ？等等..哦和''（空格）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T22:25:50.933

一种简单的方法是`split`在您认为不是有效单词字符的任何字符上使用字符串。请注意，这绝不是一个详尽的解决方案。我只是采用了一组有限的字符。

`[ ... ]`当您发现边缘情况时，您可以在括号内添加有效的单词字符。您也可以在[http://search.cpan.org](http://search.cpan.org)搜索为此目的而设计的模块。

正则表达式`[^ ... ]`表示匹配*不在*括号内的任何字符。`\pL`是更大的字母子集，而其他字母。破折号`-`必须转义，因为它是字符类括号内的元字符。

```
use strict;
use warnings;
use Data::Dumper;

my $str = "Hello how are you today. Oh thats good I'm glad you are happy.
           Thats wonderful; thats fantastic.";
my %hash;
$hash{$_}++                      # increase count for each field
    for                          # in the loop
    split /[^\pL'\-!?]+/, $str;  # over the list from splitting the string 
print Dumper \%hash; 
```

**输出：**

```
$VAR1 = {
          'wonderful' => 1,
          'glad' => 1,
          'I\'m' => 1,
          'you' => 2,
          'how' => 1,
          'are' => 2,
          'fantastic' => 1,
          'good' => 1,
          'today' => 1,
          'Hello' => 1,
          'happy' => 1,
          'Oh' => 1,
          'Thats' => 1,
          'thats' => 2
        }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:25:21.143

这将使用空格来分隔单词。

```
#!/usr/bin/env perl
use strict;
use warnings;

my $str = "Hello how are you today."
        . " Oh thats good I'm glad you are happy."
        . " Thats wonderful. thats fantastic.";

# Use whitespace to split the string into single "words".
my @words = split /\s+/, $str;

# Store each word in the hash and count its occurrence.
my %hash;
for my $word ( @words ) {
    $hash{ $word }++;
}

# Show each word and its count. Using printf to align output.
for my $key ( sort keys %hash ) {
    printf "\%-10s => \%d\n", $key, $hash{ $key };
} 
```

您需要进行一些微调才能获得“真实”的单词。

```
Hello      => 1
I'm        => 1
Oh         => 1
Thats      => 1
are        => 2
fantastic. => 1
glad       => 1
good       => 1
happy.     => 1
how        => 1
thats      => 2
today.     => 1
wonderful. => 1
you        => 2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T22:30:33.533

试试这个：

```
use strict;
use warnings;

my $str = "Hello, how are you today. Oh thats good I'm glad you are happy. 
           Thats wonderful.";
my @strAry = split /[:,\.\s\/]+/, $str;
my %strHash;

foreach my $word(@strAry) 
{
    print "\nFOUND WORD: ".$word;
    my $exstCnt = $strHash{$word};

    if(defined($exstCnt)) 
    {
        $exstCnt++;
    } 
    else 
    {
        $exstCnt = 1;
    }

    $strHash{$word} = $exstCnt;
}

print "\n\nNOW REPORTING UNIQUE WORDS:\n";

foreach my $unqWord(sort(keys(%strHash))) 
{
    my $cnt = $strHash{$unqWord};
    print "\n".$unqWord." - ".$cnt." instances";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T01:53:12.543

```
 use YAML qw(Dump);
 use 5.010;

 my $str = "Hello how are you today. Oh thats good I'm glad you are happy. Thats wonderful; thats fantastic.";
 my @match_words = $str =~ /(\w+)/g;
 my $word_hash = {};
 foreach my $word (sort @match_words) {
     $word_hash->{$word}++;
 }
 say Dump($word_hash);
 # -------output----------
 Hello: 1
 I: 1
 Oh: 1
 Thats: 1
 are: 2
 fantastic: 1
 glad: 1
 good: 1
 happy: 1
 how: 1
 m: 1
 thats: 2
 today: 1
 wonderful: 1
 you: 2 
```

# java - UDP套接字编程（提取数据，将其存储在字符串中）

> ID：14968492
> 
> 赞同：1
> 
> 时间：2013-02-19T22:09:55.343
> 
> 标签：java, sockets, tcp, network-programming, udp

我正在学习使用 Java 进行 TCP 和 UDP 套接字编程，我正在为我的网络课程阅读的其中一本书有以下内容：

```
DatagramPacket receivedPacket = new DatagramPacket(receiveData, receiveData.length);

String modifiedSentence = new String(receivedPacket.getData()); 
```

receivedPacked 只是一个 DatagramPacket 类型的对象，modifiedSentence 存储从服务器返回的内容。在这种情况下，ReceivedPacket.getData() 在存储之前将数据包从字节转换为字符串。

我的问题是为什么要创建一个字符串对象并将转换后的数据包存储/传递给它，而不是使用以下内容：

```
String modifiedSentence = receivedPacket.getData(); 
```

这行不通吗？我认为在 Java 中专门创建 String 类的对象是不切实际的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:12:52.290

`DatagramPacket.getData()`返回字节数组而不是字符串。因此，您需要将其转换为字符串以将其分配给字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:39:44.203

> String modifiedSentence = new String(receivedPacket.getData())

反正那是错的。它应该是

```
String modifiedSentence = new String(receivedPacket.getData(), 0, receivedPacket.getLength()) 
```

> 我的问题是为什么要创建一个字符串对象并将转换后的数据包存储/传递给它，而不是使用以下内容：
> 
> String modifiedSentence = receivedPacket.getData();

因为它不编译。`getData()`返回`byte[]`，而不是`String`。

> 我认为在 Java 中专门创建 String 类的对象是不切实际的。

只有当参数已经是 a`String.`在这种情况下它不是。

# facebook - How to get extended access token for perl app?

> ID：14968495
> 
> 赞同：0
> 
> 时间：2013-02-19T22:10:05.197
> 
> 标签：facebook, oauth-2.0

I found this on facebook site, but what I need to do with this to get extended access token?

```
https://graph.facebook.com/oauth/access_token?             
    client_id=APP_ID&
    client_secret=APP_SECRET&
    grant_type=fb_exchange_token&
    fb_exchange_token=EXISTING_ACCESS_TOKEN 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:19:56.337

假设您已经从成功的 OAuth 交互中获得了访问令牌，只需调用此 url，将 EXISTING_ACCESS_TOKEN 替换为您从初始 OAUth 获得的令牌，并将 client_id 和 client_secret 替换为您的应用程序的应用程序 ID 和应用程序密钥（请参阅[https:// /developers.facebook.com/apps](https://developers.facebook.com/apps)）。您将获得包含扩展令牌的 json。

此上下文中的 OAuth 交互会提示用户授予您的应用访问其个人资料数据的权限，或代表用户使用某些权限进行操作。在 facebook 中，如果您将用户浏览器重定向到

```
https://www.facebook.com/dialog/oauth/?
    client_id=YOUR_APP_ID
    &redirect_uri=YOUR_REDIRECT_URL
    &state=YOUR_STATE_VALUE
    &scope=COMMA_SEPARATED_LIST_OF_PERMISSION_NAMES 
```

其中范围类似于 publish_stream,read_friendlists，用户将看到一个对话框，上面写着“APP X 正在请求写入您的墙并读取您的朋友列表的权限。允许或拒绝”。如果用户允许，您将获得 json 发布到 YOUR_REDIRECT_URL，其中将包含访问令牌。这是 EXISTING_ACCESS_TOKEN。

在这里查看 facebook oauth 文档[https://developers.facebook.com/docs/reference/dialogs/oauth/](https://developers.facebook.com/docs/reference/dialogs/oauth/)

# python - Python 的 zipfile 模块无法更新条目

> ID：14968496
> 
> 赞同：4
> 
> 时间：2013-02-19T22:10:04.800
> 
> 标签：python, zipfile

我想使用 pythons [zipfile](http://docs.python.org/3.3/library/zipfile)模块更新 zip 文件中的条目。我的问题是这会生成一个新条目。

请假设我有这个代码：

```
from zipfile import ZipFile,ZIP_DEFLATED
with ZipFile("myfile.zip","w") as z:
    z.writestr("hello.txt", "the content of hello.txt", ZIP_DEFLATED)
    ###  how to update the hello.txt file here ?
    z.writestr("hello.txt", "the content of hello.txt", ZIP_DEFLATED) 
```

在此之后，实际的 zip 文件有两个条目而不是一个：

```
$ unzip -l myfile.zip 
Archive:  myfile.zip
  Length      Date    Time    Name
---------  ---------- -----   ----
       24  2013-02-19 22:48   hello.txt
       24  2013-02-19 22:48   hello.txt
---------                     -------
       48                     2 files
$ python --version
Python 3.3.0
$ 
```

我知道编写一个完整的新文件的方法，但是如果内容很大，这将花费很多时间。

*zip(1)*实用程序可以做到这一点（使用“-u”选项），那么为什么不使用 python 呢？有什么方法我仍然可以使用 python 实现这一点？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T00:20:03.590

该`zip`格式没有任何简单的方法可以删除或替换存档中的文件。可能有一些图书馆可以就地这样做，但我不知道有哪一个。

可是等等：

> zip(1) 完全可以做到这一点（使用“-u”选项）那么为什么不是 python？

首先，`-u`所做的只是告诉它“仅在时间戳不是较新的情况下替换现有文件”，这在这里并不真正相关。如果没有`-u`它，默认命令是`add`，它会在不检查时间戳的情况下执行相同的操作：

> 更新现有条目并添加新文件。如果存档不存在，请创建它。这是默认模式。

但是，更重要的是，正如您明确[引用的联机帮助页所说：](http://linux.die.net/man/1/zip)

> 压缩文件。更改现有 zip 存档时，zip 将使用新内容写入一个临时文件，并且仅在创建新版本的过程完成且没有错误时替换旧文件。

这正是您想要做的：将一个完整的新文件写入临时位置，然后用新文件替换原始文件。

如果您需要使其在 Windows 上运行，这可能会有点痛苦。（如果没有，只需使用`tempfile.NamedTemporaryFile`and `os.rename`。）但是您已经知道如何做到这一点：

> 我知道编写一个完整的新文件的方法，但是如果内容很大，这将花费很多时间。

只不过`zip -u`需要太多时间而已。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:49:44.027

我怀疑该`zipfile`模块可以根据需要修改档案。如果可以的话，将有一种方法可以从 a 中删除文件`ZipFile`，但没有。

# python - How to detect an exchange does not exist with py-amqp

> ID：14968498
> 
> 赞同：1
> 
> 时间：2013-02-19T22:10:34.587
> 
> 标签：python, amqp, py-amqplib

I want to be able to detect whether an exchange does not exist when submitting a message to AMQP.

Consider following example.

```
#!/usr/bin/python

import amqp
from time import sleep

conn = amqp.Connection(host="localhost:5672", userid="guest", password="guest", virtual_host="/")
outgoing = conn.channel()
message = amqp.Message("x")

while True:
    print "publish message."
    outgoing.basic_publish(message,exchange="non-existing",routing_key="fubar")
    sleep(1) 
```

This script keeps publishing to the exchange but does not raise any errors if the exchange does not exist. When the exchange exists, the messages arrive.

```
#!/usr/bin/python

import amqp
from time import sleep

conn = amqp.Connection(host="localhost:5672", userid="guest", password="guest", virtual_host="/")
outgoing = conn.channel()
message = amqp.Message("x")

while True:
    print "publish message."
    outgoing.basic_publish(message,exchange="non-existing",routing_key="fubar")
    outgoing.wait()
    sleep(1) 
```

When I add outgoing.wait() a amqp.exceptions.NotFound is raised which is what I want. The problem is however that if in this case the exchange exists, the message arrives but outgoing.wait() blocks my loop. (I could run outgoing.wait() in a separate thread but that I do not want to do.)

How to deal with this?

Any advice tips pointers welcome

Thanks,

Jay

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T18:54:50.700

如果您想查明交换是否存在，请使用 exchange_declare 方法并将被动标志设置为 True。将被动标志设置为 True 将阻止服务器尝试创建交换，如果交换不存在则抛出错误。

```
import amqp
from amqp.exceptions import NotFound

conn = amqp.Connection(host="localhost:5672", userid="guest", password="guest",
                       virtual_host="/")
outgoing = conn.channel()
try:
    outgoing.exchange_declare("fubar", "", passive=True)
except NotFound:
    print "Exchange 'fubar' does not exist!" 
```

如果您真正感兴趣的是确保交换在发布到它之前存在，只需在进入发送循环之前声明它。如果交换已经存在，则不会发生任何事情。如果交易所不存在，它将被创建。

```
import amqp

conn = amqp.Connection(host="localhost:5672", userid="guest", password="guest",
                       virtual_host="/")
outgoing = conn.channel()
outgoing.exchange_declare("fubar", "direct") 
```

这是您正在使用的 amqp 库中 exchange_declare 的方法声明的链接：

[https://github.com/celery/py-amqp/blob/master/amqp/channel.py#L460-L461](https://github.com/celery/py-amqp/blob/master/amqp/channel.py#L460-L461)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T07:51:39.573

不幸的是，您*需要*一个阻塞调用来检查来自 basic_publish() 的异常。但是，您可以做的是在进入异步循环之前运行一次阻塞调用：

```
# send a test message synchronously to see if the exchange exists
test_message = amqp.Message('exchange_test')
outgoing.basic_publish(test_message,exchange="non-existing",routing_key="fubar")
try:    
    outgoing.wait()
except amqp.exceptions.NotFound:
    # could not find the exchange, so do something about it
    exit()

while True:
    # fairly certain the exchange exists now, run the async loop
    print "publish message."
    outgoing.basic_publish(message,exchange="non-existing",routing_key="fubar")
    sleep(1) 
```

# ios - 如何在 AFNetworking 中使用正确的块语句，将其响应数据传递给多个视图控制器？

> ID：14968500
> 
> 赞同：-1
> 
> 时间：2013-02-19T22:10:40.220
> 
> 标签：ios, request, return, block, afnetworking

我正在为我使用 ASIHTTPRequest 的旧应用程序进行更新。由于客户想要升级这个应用程序，我选择将我现有的项目转换为正在处理内存管理的“ [ARC](http://developer.apple.com/library/ios/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html) ”项目由应用程序本身。

由于[ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest/)在执行多个请求时出现了一些错误（以及 ASI 已过时的事实），我选择使用一个名为[AFNetworking](https://github.com/AFNetworking/AFNetworking)的新库。在将此当前项目设置转换为 AFNetworking 时，我遇到了问题。

在我当前的设置中，我对给定服务器执行了如下请求：

```
_request = [[ASIHTTPRequest alloc ] initWithURL:[NSURL URLWithString:url]];
[_request setShouldContinueWhenAppEntersBackground:NO];
[_request setDidFinishSelector:@selector(downloadPageHasFinished:)];
[_request setDidFailSelector:@selector(downloadPageHasFailed:)];
[_request setDelegate:self];
[_request startAsynchronous];
[ASIHTTPRequest setShouldUpdateNetworkActivityIndicator:YES]; 
```

在上面的设置中，我一直在使用两个选择器（didFinish 和 didFailed），我可以在其中捕获我的（非）成功请求。在该选择器中，我将我的 responseData 传回给给定的父级。

```
[parent downloadCompleted:YES andContent:responseData]; 
```

现在我已经切换到 AFNetworking，我也想在其中执行请求并将 responseData 传回给给定的父级。由于 AFNetworking 使用块，我不确定何时或如何传回此 responseData。由于 web 服务返回 XML，我选择添加 KissXML 标头[链接](https://github.com/AFNetworking/AFKissXMLRequestOperation)，它是 AFHTTPRequestOperation 的子类。现在我可以在我的块语句中检索我的完整 XML 文档（我想要的）。但我不知道如何将此数据返回到我的特定视图控制器（并且我可以同时执行多个请求）。我目前对 AFNetworking 的设置如下。

```
-(NSData *)doAFNetworkRequest:(NSURL *)url {
    __block NSData * datathingy = nil;

        AFKissXMLRequestOperation *operation = [AFKissXMLRequestOperation XMLDocumentRequestOperationWithRequest:[NSURLRequest requestWithURL:url] success:^(NSURLRequest *request, NSHTTPURLResponse *response, DDXMLDocument *XMLDocument) {
            NSLog(@"THE COMPLETE DOCUMENT: %@", XMLDocument);
            datathingy = [[XMLDocument description] dataUsingEncoding:NSUTF8StringEncoding];

            //the place where I can't return values

        } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, DDXMLDocument *XMLDocument) {

        }];

        [operation start];
    return datathingy;
} 
```

当我放置“return datathingy”时；在成功块部分我收到错误：

“不兼容的块指针类型发送 'NSData *(^)(NSURLRequest * _strong, *NSHTTPURLResponse ** _strong, DDXMLDocument *_strong *)' 到类型参数 'void (^)(NSURLRequest ** _strong, NSHTTPURLResponse *_strong *, DDXMLDocument ** _strong )'"

那么我如何能够在我的块中返回该 NSData 对象，以便请求的视图控制器将接收正确的 responseData 并且不会收到 nil 值？

注意 1：我想将完整的 XML 文档传回给我的视图控制器，因为解析是在每个特定的视图控制器中处理的。所以只有将 responseData 传递给父 Viewcontroller 才应该这样做。

注意2：我已经找到了一个可以将 ASI 直接转换为 AF 的[资源](https://github.com/AFNetworking/AFNetworking-ASIHTTPRequest)，但我不确定 AFNetworking 的这些附加标头是否支持我以前对 ASI 的所有需求（即缓存和/或 ASIHTTPRequest 的附加属性）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:47:13.690

如果 doAFNetworkRequest 方法在 viewcontroller 类中，你可以简单地这样做：

```
-(void)doAFNetworkRequest:(NSURL *)url {
    __block NSData * datathingy = nil;
    __unsafe__unretained selfPointer = self;
    AFKissXMLRequestOperation *operation = [AFKissXMLRequestOperation XMLDocumentRequestOperationWithRequest:[NSURLRequest requestWithURL:url] success:^(NSURLRequest *request, NSHTTPURLResponse *response, DDXMLDocument *XMLDocument) {
        NSLog(@"THE COMPLETE DOCUMENT: %@", XMLDocument);
        datathingy = [[XMLDocument description] dataUsingEncoding:NSUTF8StringEncoding];

        [selfPointer parseXML:datathingy];

    } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, DDXMLDocument *XMLDocument) {

    }];

    [operation start]; 
```

}

但是把这个请求代码放在viewcontroller中是不好的。更好的方法是创建一个单例类来处理所有的网络请求。如果是这样，在该网络处理程序类中创建一个协议：

```
@protocol NetworkHandlerProtocol
-(void)requestSuccessWithData:(NSData *)data;
-(void)requestFailedWithError:(NSError *error); 
```

和一个代表：

```
id<NetworkHandlerProtocol> delegate; 
```

在 -(void)doAFNetworkRequest:(NSURL *)url 应该是这样的：

```
 __block NSData * datathingy = nil;

    AFKissXMLRequestOperation *operation = [AFKissXMLRequestOperation XMLDocumentRequestOperationWithRequest:[NSURLRequest requestWithURL:url] success:^(NSURLRequest *request, NSHTTPURLResponse *response, DDXMLDocument *XMLDocument) {
        NSLog(@"THE COMPLETE DOCUMENT: %@", XMLDocument);
        datathingy = [[XMLDocument description] dataUsingEncoding:NSUTF8StringEncoding];

        //the place where I can't return values
        [self.delegate requestSuccessWithData:datathingy];
    } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, DDXMLDocument *XMLDocument) {

    }];
    [operation start]; 
```

然后在视图控制器中，当您执行请求时：

```
NetworkHandler *handler = [NetworkHandler sharedHander];
handler.delegate = self;
[handler doAfNetworkRequest:url];

//some where implement the protocol methods
-(void)requestSuccessWithData:(NSData *)data
{
    //you can do something with the return data here
} 
```

# .net - 在 Windows Communication Framework 中，何时以 XML 而非以编程方式定义客户端配置更好？

> ID：14968501
> 
> 赞同：1
> 
> 时间：2013-02-19T22:10:40.767
> 
> 标签：.net, wcf

我只是在学习如何使用 WCF 服务，我是按照[这篇 MSDN 文章](http://msdn.microsoft.com/en-ca/library/ms734712.aspx)中的 6 步教程开始的。第 4 部分讨论了使用 svcutil.exe 生成客户端代码~~，第 5 部分显示了一个配置 WCF 客户端的大型 XML 文件~~。相对于我为 WCF 演示采用的非常简单的解决方案，使用 svcutil.exe~~和这个 XML似乎太重了：~~

```
class Program
{
    static void Main(string[] args)
    {
        WSHttpBinding bhb = new WSHttpBinding();
        EndpointAddress epa = new EndpointAddress("http://localhost:8000/index/ServiceReference1");
        ChannelFactory<ServiceReference1.IDemoChannel> cf = new ChannelFactory<ServiceReference1.IDemoChannel>(bhb, epa);

        cf.Open(); 
        ServiceReference1.IDemoChannel channel = cf.CreateChannel();
        channel.Open();

        String s = channel.getHelloWorld(5);
        channel.Close();
        cf.Close();
        Console.WriteLine("Result: {0}", s);
        Console.WriteLine("I'm the client! Press Enter to exit...");
        Console.ReadLine();
    }
} 
```

~~看到这两种非常不同的客户端配置方式后，我想知道使用生成的代码和 XML 文件有什么好处，什么时候比编程方式更好？~~

更新：我在本教程的第 5 部分重新阅读了 XML 文件，似乎 XML 文件被复制了，并且查看了预期的 XML，我收回了我的问题的 XML 方面。我想我真正要问的是“为什么我要使用 svcutil.exe 生成我的代码，而编写客户端代码看起来还不错”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:15:37.660

在我看来：**始终使用 XML**，因为您可以在部署程序后更改它，您只需要重新启动服务。

如果您使用演示代码，则需要重新构建**、重新编译、重新部署**等，这比使用**XML****慢**得多。

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:48:34.223

除了可以轻松更改 xml 配置之外，svcutil（或向项目添加服务引用）的另一个巨大好处是 wcf 方法所需和返回的自动生成类型，这些类型可供您使用，无需引用声明程序集. 在方法返回字符串的 hello world 示例中，这无关紧要，但大型 wcf 实现可能有许多请求/响应类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T23:17:57.533

> “当编写客户端代码看起来还不错时，为什么我要使用 svcutil.exe 生成我的代码”？

当您编写一个简单的测试程序时，您在代码中所做的工作效果很好。

当您开发需要团队和长期维护的大型应用程序时，xml 配置是更好的选择。想象一下，服务是由一个完全不同的团队编写和维护的，他们不会让你阅读他们的代码。客户端配置必须与服务上的配置完全匹配。当服务团队更改 uri、端口或使用证书 (https) 时，作为客户端开发人员，您将如何发现？调用将失败（可能带有非常无信息的错误消息）。你如何解决它？只需再次运行 svcutil 并重新生成配置。无需召开会议、阅读（希望）更新的文档等。

回到您发布的示例测试代码：当您的服务到达部署在 localhost 以外的其他地方的那一刻，您必须重新编译客户端，除了更新 url...在配置中定义连接信息的值。在那之前，不要担心。**

# sql - 从 PL/SQL 创建 Oracle 方案

> ID：14968502
> 
> 赞同：0
> 
> 时间：2013-02-19T22:10:42.387
> 
> 标签：sql, oracle, plsql, oracle11g

我在 SQL 文件中有一个 Oracle 方案。我很感兴趣是否可以从 PL/SQL 块运行 SQL 文件并将方案导入 Oracle？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:19:51.227

这种架构通常没有多大意义......

假设 .SQL 文件存储在数据库服务器上，您可以编写一个`UTL_FILE`用于读取文件的 PL/SQL 块，识别分隔符，然后使用动态 SQL 执行每个单独的语句。但这将是一项相当大的工作量。

同样，假设 .SQL 文件存储在数据库服务器上，您还可以编写调用主机操作系统、启动 SQL*Plus、连接回数据库并执行 .SQL 文件的 Java 存储过程。这比尝试自己解析文件的内容要少得多。但这将涉及第二个会话和一个单独的可执行文件，这也增加了一堆复杂性。

您是否有理由不简单地启动 SQL*Plus，将 .SQL 文件传递​​给它，然后让 SQL*Plus 运行？PL/SQL 在这种情况下添加了什么？

# objective-c - UICollectionViewCell 标签被重用和错误放置

> ID：14968505
> 
> 赞同：1
> 
> 时间：2013-02-19T22:11:07.563
> 
> 标签：objective-c, xcode, uilabel, uicollectionview, uicollectionviewcell

我有一个带有原型单元的 UICollectionView。单元格加载和图像并显示标签。由于单元格具有不同的大小，它们通过 CollectionViewFlowLayout 进行更改。这很好用。

当我在模拟器中滚动视图时，标签似乎被重复使用并错误地添加到图像上。如何确保不会发生这种情况并且图像在 collectionview 上只有一个标签？

![问题截图](../Images/844b7c6def36c834550a883c0d9d98f6.png)

**UICollectionView**

```
#pragma mark - Collection view 
-(NSInteger)numberOfSectionsInCollectionView:(UICollectionView *)collectionView
{
    self.Data = [NSArray arrayWithObjects:@1, @2, @3, @4, @5, @6, @7, @8, @9, @10, @11, @12, @13, @14, @15, @16, nil];
    return 1;
}
-(NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section
{
    return self.magazineLayout.count;
}

-(UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    MagazineCell *mCell = (MagazineCell *)[collectionView dequeueReusableCellWithReuseIdentifier:cellID forIndexPath:indexPath];
    int item = [indexPath row];

    mCell.backgroundColor = [UIColor lightGrayColor];

    // Set Image
    UIImage *image;
    image = [UIImage imageNamed:@"testimage.png"];
    mCell.imageView.image = image; 

    // Set Label
    NSString *title = [[NSString alloc] initWithFormat:@"Image %@", self.Data[item]];
    [mCell addSubview:[self cellTitle:title indexPath:indexPath]];

    return mCell; 
}

// Title will be reused and placed wrongly on pictures !
-(UILabel *)cellTitle:(NSString *)name indexPath:(NSIndexPath *)indexPath {

    CGSize itemSize = [self collectionView:self.collectionView layout:self.collectionView.collectionViewLayout sizeForItemAtIndexPath:indexPath];
    int top = itemSize.height - 40;
    int width = itemSize.width;

    UILabel *title = [[UILabel alloc] initWithFrame:CGRectMake(0, top, width, 40)];
    title.textColor = [UIColor blackColor];
    title.text = name;
    title.backgroundColor = [UIColor whiteColor];
    title.alpha = 0.5f;

    return title; 
} 
```

编辑：**解决方法**

`viewWithTag`工作正常，但我无法重新定位标签。可悲的是，我认为这将是最好的方法。这是我的解决方法，没有`viewWithTag`：

```
-(UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    MagazineCell *mCell = (MagazineCell *)[collectionView dequeueReusableCellWithReuseIdentifier:cellID forIndexPath:indexPath];
    mCell.backgroundColor = [UIColor lightGrayColor];

    // Set Image
    UIImage *image;
    image = [UIImage imageNamed:@"testimage.png"];
    mCell.imageView.image = image; 

    [self cellTitleAndBackground:mCell indexPath:indexPath];

    return mCell; 
}

-(void)cellTitleAndBackground:(MagazineCell *)mCell indexPath:(NSIndexPath *)indexPath {

    // Get title
    NSString *name = [[NSString alloc] initWithFormat:@"Image %@", self.Data[indexPath.row]];

    // Get current cell size
    CGSize itemSize = [self collectionView:self.collectionView layout:self.collectionView.collectionViewLayout sizeForItemAtIndexPath:indexPath];
    int top = itemSize.height - 40;
    int width = itemSize.width;

    // Create title background
    UILabel *titleBackground = [[UILabel alloc] initWithFrame:CGRectMake(0, top, width, 40)];
    titleBackground.backgroundColor = [UIColor blackColor];
    titleBackground.alpha = 0.2f;
    titleBackground.tag = 70;
    [self removeReusedLabel:mCell tag:70]; 
    [mCell addSubview:titleBackground];

    // Create titleLabel
    UILabel *titleLabel = [[UILabel alloc] initWithFrame:CGRectMake(8, top-8, width, 40)];
    titleLabel.textColor = [UIColor whiteColor];
    titleLabel.font = [UIFont boldSystemFontOfSize:14];
    titleLabel.text = name;
    titleLabel.backgroundColor = [UIColor clearColor];
    titleLabel.tag = 72;
    [self removeReusedLabel:mCell tag:72];
    [mCell addSubview:titleLabel];
}

-(void)removeReusedLabel:(MagazineCell *)mCell tag:(int)tag {
    UILabel *foundLabelBackground = (UILabel *)[mCell viewWithTag:tag];
    if (foundLabelBackground) [foundLabelBackground removeFromSuperview];
} 
```

干杯——杰里克

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T22:38:45.860

这是由于单元重用而发生的。如果要像这样添加标签，则应检查从 dequeue 方法获得的单元格上是否有标签，如果存在则将其删除。您可以给标签一个标签，然后使用 viewWithTag: 查看标签是否存在，然后让它调用 removeFromSuperview。我没有对此进行测试，但我认为这样的事情应该有效：

```
-(UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    MagazineCell *mCell = (MagazineCell *)[collectionView dequeueReusableCellWithReuseIdentifier:cellID forIndexPath:indexPath];
    UILabel *foundLabel = [mCell viewWithTag:47];
    if (foundLabel) [foundLabel removeFromSuperview];
    ....... 
```

在 cellTitle:indexPath 方法中创建标签时，请记住将标签的标签设置为相同的数字。顺便说一句，您应该将此标签添加到单元格的 contentView 而不是单元格本身。

**编辑后：**

使用 viewWithTag 对您的代码进行的这种修改对我来说效果很好：

```
-(CGSize)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout *)collectionViewLayout sizeForItemAtIndexPath:(NSIndexPath *)indexPath {
    CGSize cellSize = [self.magazineLayout[indexPath.item] size];
    return cellSize;
}

-(UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath {
    MagazineCell *mCell = (MagazineCell *)[collectionView dequeueReusableCellWithReuseIdentifier:@"RDCell" forIndexPath:indexPath];
    mCell.backgroundColor = [UIColor lightGrayColor];
    if ([mCell viewWithTag:47]) [[mCell viewWithTag:47] removeFromSuperview];
    UIImage *image = self.magazineLayout[indexPath.item];
    mCell.imageView.image = image;

    NSString *title = [[NSString alloc] initWithFormat:@"Image %@", self.data[indexPath.item]];
    [mCell addSubview:[self cellTitle:title indexPath:indexPath]];

    return mCell;
}

-(UILabel *)cellTitle:(NSString *)name indexPath:(NSIndexPath *)indexPath {
    CGSize itemSize = [self.magazineLayout[indexPath.item] size];
    int top = itemSize.height - 40;
    int width = itemSize.width;
    UILabel *title = [[UILabel alloc] initWithFrame:CGRectMake(0, top, width, 40)];
    title.textColor = [UIColor blackColor];
    title.text = name;
    title.backgroundColor = [UIColor whiteColor];
    title.alpha = 0.5f;
    title.tag = 47;
    return title;
} 
```

在此示例中，数组 magazineLayout 填充了 16 张不同大小的图片。

不过，更简单的方法是将标签添加到情节提要（或 xib）中的自定义单元格。如果您将其固定在侧面和底部，并将其高度设置为 40，您将获得所需的内容，而无需创建标签或检查其存在的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-11T12:28:12.410

我知道答案已被接受并关闭。但是以防万一有人偶然发现这个线程，避免这个问题的正确方法是继承 UICollectionViewCell 然后使用

```
[self.collectionView registerClass:[LPCollectionViewCell class] forCellWithReuseIdentifier:cellIdentifier]; 
```

在子类的 initWithFrame 方法中初始化所有元素

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {

        self.lblName = [[UILabel alloc] initWithFrame:CGRectMake(0.0, 95.0, 106.0, 20)];
        self.lblName.text = @"";
        self.lblName.textAlignment = NSTextAlignmentCenter;
        [self.lblName setFont:[UIFont fontWithName:@"GothamRounded-Bold" size:10]];
        [self.lblName setTextColor:[UIColor colorWithRed:137.0f/255.0 green:137.0f/255.0 blue:137.0f/255.0 alpha:1.0]];
        [self.lblName setBackgroundColor:[UIColor clearColor]];
        [self addSubview:self.lblName];
} 
```

将元素设为公开，以便稍后在集合视图数据源调用中对其进行访问。

```
- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath {

    LPCollectionViewCell *cell = (LPCollectionViewCell *)[collectionView dequeueReusableCellWithReuseIdentifier:cellIdentifier forIndexPath:indexPath];
    cell.backgroundColor = [UIColor whiteColor];
    [cell.lblName setText:@"This is awesome"];
} 
```

就是这样！

# jquery - 使用元素触发动作

> ID：14968506
> 
> 赞同：0
> 
> 时间：2013-02-19T22:11:11.243
> 
> 标签：jquery

我写了一个小插件来获取元素并将其放入模态框。一旦选择了元素，它就会像这样附加到正文中：

```
$('body').append(overlay, modal).show(); 
```

但是，我刚刚注意到，当单击或选择模式中的元素时，我似乎无法检测到任何操作。

我试过 .on() 和 .live() 无济于事。

```
$(document).ready(function() {
    $('#myLink').click(function() {
        $('#myEl').myModal();
    });

    $('#myLink').on('click', function() {
        alert('clicked me!');
    });
}); 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:13:47.743

尝试：

```
$(document).ready(function() {
    $(document).on('click', '#myLink', function() {
        alert('clicked me!');
    });
}); 
```

理想情况下，您希望在 DOM 中使用更接近元素的选择器，而不是`document`在文档准备好时出现的选择器。根据 jQuery 文档[`.on()`](http://api.jquery.com/on/)

> 事件处理程序仅绑定到当前选定的元素；当您的代码调用 .on() 时，它们必须存在于页面上。为确保元素存在并且可以被选择，请在页面 HTML 标记中的元素的文档就绪处理程序内执行事件绑定。如果将新 HTML 注入页面，请在将新 HTML 放入页面后选择元素并附加事件处理程序。

# git - 如何将 Git 目录或文件设为只读？

> ID：14968512
> 
> 赞同：1
> 
> 时间：2013-02-19T22:11:27.010
> 
> 标签：git, file

我想将我的 Photoshop 文档 (PSD) 添加到存储库中。但是，我想成为唯一可以编辑/推送文件并且所有其他人都可以阅读的人。原因是开发人员对 Photoshop 有足够的了解，可以使用文档来获取值（字体大小、颜色等），但我不希望他们意外地编辑文件并提交它。

或者也许还有另一种方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:46:43.410

Place the PSD files in a different repo where they only have pull access.

You can not set access rights within the repo using git.

# c# - 如何模拟 LINQ to Entities 助手，例如“SqlFunctions.StringConvert()”

> ID：14968513
> 
> 赞同：6
> 
> 时间：2013-02-19T22:11:34.120
> 
> 标签：c#, unit-testing, entity-framework-4, mocking, moq

我正在使用 EF 4 并尝试使用 Moq 对以下行进行单元测试：

```
var convertError = models
             .Where(x => SqlFunctions.StringConvert((decimal?) (x.convert ?? 0)) == "0")
             .Any(); 
```

`SqlFunctions.StringConvert()`如果它检测到上下文被嘲笑，它似乎会抛出。

它给出了一个错误说：

> 此函数只能从 LINQ to Entities 调用

是否可以告诉`SqlFunctions.StringConvert`返回一个模拟对象，以便我可以摆脱这个错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-12-04T02:02:53.200

我所做的是提供我自己的 DbFunctions 实现，以便单元测试中的 LINQ To Objects 使用简单的 .NET 实现，而 LINQ To EF 在运行时使用 DbFunctionAttribute，其方式与 System.Data.Entity.DbFunctions 相同。我曾考虑过模拟 DbFunctions，但是嘿，LINQ to Objects 实现很有用并且工作正常。这是一个例子：

```
public static class DbFunctions
{
    [DbFunction("Edm", "AddMinutes")]
    public static TimeSpan? AddMinutes(TimeSpan? timeValue, int? addValue)
    {
        return timeValue == null ? (TimeSpan?)null : timeValue.Value.Add(new TimeSpan(0, addValue.Value, 0));
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-20T08:37:42.790

不，这是不可能的，因为函数的实现看起来像：

```
[EdmFunction("SqlServer", "STR")]
public static string StringConvert(decimal? number, int? length)
{
    throw EntityUtil.NotSupported(Strings.ELinq_EdmFunctionDirectCall);
} 
```

您不能使用 Moq 来伪造此功能。你需要更强大的模拟框架，它可以让你替换静态函数调用——可能是 Microsoft Fakes、TypeMock Isolator 或 JustMock。

或者您需要考虑您的测试方法，因为模拟上下文是错误的想法。你应该有类似的东西：

```
var convertError = myQueryProvider.ConvertQuery(x.convert); 
```

`queryProvider`您的可模拟类型将在哪里隐藏您的查询。查询是与数据库相关的逻辑，应该针对真实数据库进行测试。查询周围的代码是您的应用程序逻辑，它应该进行单元测试 - 正确测试它们的最佳解决方案是通过一些接口将它们分开（在这种情况下是查询提供程序，但人们通常使用完整的特定存储库）。这个原则来自关注点分离——查询执行是独立关注点，因此它被放置在单独测试的自己的方法中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-07T20:53:00.897

您可以模拟 EdmFunctions，我使用 NSubstitute 完成了此操作（它也不支持模拟静态函数）。诀窍是将您的 DbContext 包装在一个接口中。然后，将您的静态 EdmFunction 函数添加到静态类，并在静态类中为您的上下文创建扩展方法以调用该方法。例如

```
public static class EdmxExtensions
{
   [EdmFunction("SqlServer", "STR")]
   public static string StringConvert(decimal? number, int? length)
   {
      throw EntityUtil.NotSupported(Strings.ELinq_EdmFunctionDirectCall);
   }

   public static IQueryable<Person> MyFunction(this IDbContext context, decimal? number, int? length)
   {
      context.Person.Where(s => StringConvert(s.personId, number, length);
   } 
```

然后，您将能够模拟 MyFunction，因为它是接口可用的方法，并且 EntityFramework 在您尝试调用它时不会生气。

我还没有在起订量上试过这个，但你可以用类似的方式做到这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-08T18:20:05.713

另一种方法是您可以编写自己的方法，该方法具有相同的属性标记和方法签名，然后实际实现方法单元测试目的，而不是引发异常。Entity Framework 忽略函数中的代码，所以它永远不会调用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-24T19:29:10.300

你不能告诉`SqlFunctions.StringConvert`返回一个模拟对象，因为它是一个静态方法。但是您可以为它创建一个接口并创建一个外观类。

像这样创建一个界面并确保包含属性

```
public interface ISqlFunctions
{
    [System.Data.Entity.Core.Objects.DataClasses.EdmFunction("SqlServer", "STR")]
    string StringConvert(Decimal? number);
} 
```

然后编写你的外观类。这应该是您希望 Linq to Entity 做的任何事情的 C# 方式。

```
public class SqlFunctionsFacade : ISqlFunctions
{
    public string StringConvert(decimal? number)
    {
        return number?.ToString();
    }
} 
```

在您的实现中，在您的 linq 查询中使用您的接口

```
 public SomethingOrOther(ISqlFunctions sqlFunctions)
    {
        var convertError = models
            .Where(x => sqlFunctions.StringConvert((decimal?)(x.convert ?? 0)) == "0")
            .Any();
    } 
```

实体框架将使用接口上的属性，其方式与在`SqlFunctions.StringConvert(decimal?)`.

在你的单元测试中，你可以为你的被测系统提供你的外观类或接口的模拟。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-08T14:34:28.407

使用***System.Data.Entity.DbFunctionAttribute***并创建 EF DbFunction 的“存根”实现。然后，当您运行您的应用程序时，它将使用 EF 实现，当您运行单元测试时，您的“存根”实现就会发挥作用。

“存根”实现最接近MSSQL 中的***Str()***使用 new ***System.Data.Entity.DbFunctionAttribute***所做的。对于那些不喜欢浪费时间重新发明轮子但为了单元测试而需要它的人。享受。

```
 [DbFunction("SqlServer", "STR")]
    public static string StringConvert(double? number, int? length, int? decimalArg)
    {
        if (number == null)
            return null;

        var roundedValue = decimalArg != null 
                ? Math.Round(number.Value, decimalArg.Value).ToString($"##.{new string('0', decimalArg.Value)}") 
                : number.Value.ToString(CultureInfo.InvariantCulture); 

        return length != null && length - roundedValue.Length > 0
            ? $"{roundedValue}{new string(' ', length.Value - roundedValue.Length)}"
            : roundedValue;
    } 
```

# javascript - 嵌套 $.get 的返回值

> ID：14968521
> 
> 赞同：2
> 
> 时间：2013-02-19T22:11:50.267
> 
> 标签：javascript, jquery, nested-function

我需要对几个不同的 php 脚本运行多个 $.get 函数，我想知道我是否可以在一个通用函数中完成所有操作并返回数据。我的计划是做类似的事情：

```
var companyName = 'Google';

var customers = get('Customers', companyName);
var vendors = get('Vendors', companyName);

function get(table, variable){
    $.get('http://www.mysite.com/phps/get'+table+'.php', {company: variable}, function(data){return data});
} 
```

但是，这不起作用，因为它位于嵌套函数中。这可能（很容易）还是我必须一次做一个 $.get ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:15:44.617

如果您使用的是 jquery 1.5，[$.get](http://api.jquery.com/jQuery.get/)将返回一个`jqXhr`对象，该对象实现了 Promise 接口：

> 从 jQuery 1.5 开始，所有 jQuery 的 Ajax 方法都返回 XMLHTTPRequest 对象的超集。这个由 $.get() 返回的 jQuery XHR 对象或“jqXHR”实现了 Promise 接口，为它提供了 Promise 的所有属性、方法和行为

可以这样使用：

```
function yourMultipleGetFunction(success, error) {

    var jqXhr1 = $.get('url', data);
    var jqXhr2 = $.get('url2', data2);

    $.when(jqXhr1, jqXhr2).then(success, error);
}

yourMultipleGetFunction(function(data1, data2){
     //handle the objects returned from the get requests
}, function(jqXHR, textStatus, errorThrown){
    //something went wrong, handle the error here
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T23:01:18.250

请记住，在 Javascript 中，函数是一等公民，因此您最好发送一个函数，而不是返回一个值：

```
var companyName = 'Google';

var customers, vendors;

get('Customers', companyName, function(data) { customers = data; });
get('Vendors', companyName, function(data) { vendors = data; });

function get(table, variable, success){
    $.get('http://www.mysite.com/phps/get'+table+'.php', {company: variable}, success);
} 
```

这是一个糟糕的示例，因为它不处理异常等。但它应该让您了解提供给您的灵活性。关键是要记住，函数是语言的基石，也是赋予它力量的东西。

如果你真的想坚持你正在使用的方法**（我不推荐）**，你可以添加一个额外的功能...... **（我真的不推荐）**。

```
var companyName = 'Google';

var customers, vendors;

get('Customers', companyName, customers);
get('Vendors', companyName, vendors);

function get(table, variable, results){
    $.get('http://www.mysite.com/phps/get'+table+'.php', {company: variable}, function(data){ results = data});
} 
```

这样做会导致您失去根据呼叫结果更改体验处理方式的能力。也许您希望禁用一个选择框，直到呼叫完成并填充它，或者您可能希望在呼叫失败时执行一些特殊操作。使用函数是一种更好的方法。

希望这可以帮助。

# javascript - Bootstrap Collapse 不允许检查电台

> ID：14968524
> 
> 赞同：1
> 
> 时间：2013-02-19T22:11:57.420
> 
> 标签：javascript, jquery, twitter-bootstrap

好的，所以我在每个可折叠部分的折叠标题中都有一个收音机。如果我点击标题本身，收音机就会检查。如果我点击收音机，折叠功能，但收音机取消选中本身。您必须在 javascript 中设置断点才能注意到它正在检查。

```
 $('#accordion-advfeatures .accordion-heading a').click(function(){
        if (!$(this).parent().parent().children('.accordion-body').hasClass('in')) {
           $(this).children('input').attr('checked',true);
        } else {
           $("#advancedDefault").attr('checked',true);
        }
    }); 
```

JSFiddle：http: [//jsfiddle.net/d2y6a/](http://jsfiddle.net/d2y6a/)

任何人都知道如何让这些收音机发挥应有的作用？

# .net - 如何创建具有时区支持的日历约会

> ID：14968525
> 
> 赞同：1
> 
> 时间：2013-02-19T22:12:00.880
> 
> 标签：.net, vb.net, email, outlook, html-email

我正在尝试为 Outlook 创建一个新的日历事件。它创建成功，但是当来自另一个国家（另一个区域时间）的某个人打开它时，日期和时间不正确。

这是代码

```
Dim calendarEventText As StringBuilder = New StringBuilder
calendarEventText.AppendLine("BEGIN:VCALENDAR")
calendarEventText.AppendLine("PRODID:-//Company Name")
calendarEventText.AppendLine("VERSION:2.0")
calendarEventText.AppendLine("METHOD:REQUEST")
calendarEventText.AppendLine("BEGIN:VEVENT")
calendarEventText.AppendLine(String.Format("DTSTART:{0:yyyyMMddTHHmmssZ}", Convert.ToDateTime(changeStartDate.ToString)))
' I'm using the UTC time
calendarEventText.AppendLine(String.Format("DTSTAMP:{0:yyyyMMddTHHmmssZ}", DateTime.UtcNow))
calendarEventText.AppendLine(String.Format("DTEND:{0:yyyyMMddTHHmmssZ}", Convert.ToDateTime(changeEndDate.ToString)))
calendarEventText.AppendLine(String.Format("LOCATION:{0}", location.ToString))
calendarEventText.AppendLine(String.Format("UID:{0}", Guid.NewGuid()))
calendarEventText.AppendLine(String.Format("DESCRIPTION:{0}", _mail.Body))
calendarEventText.AppendLine(String.Format("X-ALT-DESC;FMTTYPE=text/html:{0}", _mail.Body))
calendarEventText.AppendLine(String.Format("SUMMARY:{0}", _mail.Subject))
calendarEventText.AppendLine(String.Format("ORGANIZER:MAILTO:{0}", _mail.From.Address))
If _mail.To.Count > 0 Then
    calendarEventText.AppendLine(String.Format("ATTENDEE;CN=\{0}\;RSVP=TRUE:mailto:{1}", _mail.To(0).DisplayName, _mail.To(0).Address))
Else
    calendarEventText.AppendLine(String.Format("ATTENDEE;CN=\{0}\;RSVP=TRUE:mailto:{1}", "", ""))
End If
calendarEventText.AppendLine("BEGIN:VALARM")
calendarEventText.AppendLine("TRIGGER:-PT15M")
calendarEventText.AppendLine("ACTION:DISPLAY")
calendarEventText.AppendLine("DESCRIPTION:Reminder")
calendarEventText.AppendLine("END:VALARM")
calendarEventText.AppendLine("END:VEVENT")
calendarEventText.AppendLine("END:VCALENDAR")
Dim ct As System.Net.Mime.ContentType = New System.Net.Mime.ContentType("text/calendar")
ct.Parameters.Add("method", "REQUEST")
Dim avCal As AlternateView = AlternateView.CreateAlternateViewFromString(calendarEventText.ToString(), ct) 
```

如何添加时区支持？

环境：

*   .NET 2.0

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:19:00.987

您将需要添加 VTIMEZONE 部分（见下文）并在指定时间时使用该时区，例如

```
DTSTART;TZID="USA Mountain Standard Time!":20110627T080000

BEGIN:VTIMEZONE
TZID:USA Mountain Standard Time!
BEGIN:STANDARD
DTSTART:16010101T000000
TZOFFSETFROM:-0600
TZOFFSETTO:-0700
END:STANDARD
END:VTIMEZONE 
```

# c# - 将 OpenGL 场景绘制到 C# 位图；屏幕外被剪辑

> ID：14968529
> 
> 赞同：2
> 
> 时间：2013-02-19T22:12:17.953
> 
> 标签：c#, opengl, bitmap, screenshot, glreadpixels

我将复杂的 2D 场景绘制到 OpenGL 窗口。我希望用户能够截取场景的屏幕截图并将其保存为 JPG。但是，我希望他们能够指定可以将场景绘制得比他们的屏幕大（这将使他们能够看到更多细节等）。

当他们指定大于适合他们屏幕的视口的数字时，他们不可见的所有内容都不会被绘制到位图上。我觉得我对其中一些我无法追踪的 OpenGL 函数的行为有错误的理解。

当`renderSize`小于我启动程序的默认视口时，下面的代码工作得很好。如果`renderSize`更大，则会创建适当大小的 JPG，但超出屏幕可见区域的右侧/顶部部分只是空白。如果我在第二个显示器上单击并拖动视口，则会绘制更多图片，但如果`renderSize`比两个显示器都大，则仍然不是全部。我怎样才能使这个绘图独立于屏幕上显示的视口是什么？

（我可以验证`renderLocation`并`renderSize`在调用此函数时正确设置，`renderSize`并且数字很大，例如 7000 x 2000）

```
public Bitmap renderToBitmap(RenderMode mode)
    {
        // load a specific ortho projection that will contain the entire graph
        GL.MatrixMode(MatrixMode.Projection);
        GL.PushMatrix();
        GL.LoadIdentity();

        GL.Ortho(0, renderSize.Width, 0, renderSize.Height, -1, 1);
        GL.Viewport(0, 0, renderSize.Width, renderSize.Height);

        GL.MatrixMode(MatrixMode.Modelview);
        GL.PushMatrix();
        GL.LoadIdentity();

        // move the graph so it starts drawing at 0, 0 and fills the entire viewport
        GL.Translate(-renderLocation.X, -renderLocation.Y, 0);

        GL.ClearColor(Color.White);
        GL.Clear(ClearBufferMask.ColorBufferBit | ClearBufferMask.DepthBufferBit);

        // render the graph
        this.render(mode);

        // set up bitmap we will save to
        Bitmap bitmap = new Bitmap(renderSize.Width, renderSize.Height, System.Drawing.Imaging.PixelFormat.Format32bppArgb);
        BitmapData bData = bitmap.LockBits(new Rectangle(0, 0, bitmap.Width, bitmap.Height), ImageLockMode.ReadWrite, bitmap.PixelFormat);

        // read the data directly into the bitmap's buffer (bitmap is stored in BGRA)
        GL.ReadPixels(0, 0, renderSize.Width, renderSize.Height, OpenTK.Graphics.OpenGL.PixelFormat.Bgra, PixelType.UnsignedByte, bData.Scan0);

        bitmap.UnlockBits(bData);
        bitmap.RotateFlip(RotateFlipType.RotateNoneFlipY); // compensate for openGL/GDI y-coordinates being flipped

        // revert the stuff about openGL we changed
        GL.MatrixMode(MatrixMode.Projection);
        GL.PopMatrix();
        GL.MatrixMode(MatrixMode.Modelview);
        GL.PopMatrix();

        return bitmap;
    } 
```

下面是我如何初始化我的 GL 窗口，以防万一。

```
private void initGL()
    {
        GL.ClearColor(Color.AntiqueWhite);
        GL.Disable(EnableCap.Lighting);

        GL.Clear(ClearBufferMask.ColorBufferBit | ClearBufferMask.DepthBufferBit);

        resetCamera();
    }

    private void resetCamera()
    {
        offsetX = offsetY = 0; // Bottom-left corner pixel has coordinate (0, 0)
        zoomFactor = 1;
        setupViewport();
        glWindow.Invalidate();
    }

    private void setupViewport()
    {
        int w = glWindow.Width;
        int h = glWindow.Height;
        GL.MatrixMode(MatrixMode.Projection);
        GL.LoadIdentity();
        GL.Ortho(0 + offsetX, w + offsetX, 0 + offsetY, h + offsetY, -1, 1);
        GL.Viewport(0, 0, w, h); // Use all of the glControl painting area
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T00:25:41.083

听起来您遇到了[像素所有权](http://www.opengl.org/archives/resources/faq/technical/rasterization.htm#rast0070)问题：

> **14.070 为什么当我调用 glReadPixels() 时，窗口的一部分与另一个窗口重叠时，我没有得到重叠区域的有效像素数据？**
> 
> 这是由于称为像素所有权测试的 OpenGL 规范的一部分。如果一个窗口被另一个窗口遮挡，它不必存储遮挡区域的像素数据。因此，glReadPixels() 调用可以返回模糊区域的未定义数据。
> 
> 像素所有权测试因 OpenGL 实现而异。一些 OpenGL 实现将窗口的模糊区域或整个窗口存储在屏幕外缓冲区中。这样的实现可以为被遮挡的窗口返回有效的像素数据。但是，许多 OpenGL 实现将屏幕上的像素一对一地映射到帧缓冲区存储位置，并且不存储（也不能返回）窗口模糊区域的像素数据。
> 
> 一种策略是指示窗口系统将窗口前移到窗口堆栈的顶部，渲染，然后执行 glReadPixels() 调用。然而，这种方法仍然存在用户干预的风险，可能会混淆源窗口。
> 
> 一种可能适用于某些应用程序的方法是渲染到不可见的窗口中，例如 X Windows 下的 Pixmap。这种类型的绘图表面不能被用户遮挡，其内容应始终通过像素所有权测试。从这样的绘图表面读取应该始终产生有效的像素数据。不幸的是，渲染到这样的绘图表面通常不会被图形硬件加速。

查看[FBO](http://www.songho.ca/opengl/gl_fbo.html)或 PBuffers 以获得大于窗口和/或屏幕外的渲染。

[`libtr`](http://www.mesa3d.org/brianp/TR.html)如果你不能/不会使用 FBO 或 PBuffers，也有。

# asp-classic - 我的字符串的一部分是否存在于另一个字符串中？

> ID：14968535
> 
> 赞同：1
> 
> 时间：2013-02-19T22:12:53.890
> 
> 标签：asp-classic, postal-code

对不起这个问题，我对我的经典 ASP 很生疏，无法理解它。

我有一个包含一系列邮政编码开头的变量：

```
strPostCode = "HS1,HS2,HS3,HS4,HS5,HS6,HS7,HS8,HS9,IV41,IV42" etc etc 
```

现在我需要查看用户输入的邮政编码是否存在于该字符串中。

所以，“HS2 4AB”、“HS2”、“HS24AB”都需要返回一个匹配项。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T09:58:30.933

您需要用逗号分隔邮政编码，然后逐个查找匹配项。

代码如下所示：

```
Dim strPostCode, strInput, x
Dim arrPostCodes, curPostCode, blnFoundMatch
strPostCode = "HS1,HS2,HS3,HS4,HS5,HS6,HS7,HS8,HS9,IV41,IV42"
strInput = "HS24AB"
arrPostCodes = Split(strPostCode, ",")
blnFoundMatch = False
For x=0 To UBound(arrPostCodes)
    curPostCode = arrPostCodes(x)
    'If Left(strInput, Len(curPostCode))=curPostCode Then
    If InStr(strInput, curPostCode)>0 Then
        blnFoundMatch = True
        Exit For
    End If
Next
Erase arrPostCodes
If blnFoundMatch Then
    'match found, do something...
End If 
```

以上将在用户输入的任何位置查找每个邮政编码，例如“4AB HS2”也将返回匹配项；如果您希望邮政编码仅出现在输入的开头，请使用`If`上述代码中标注的替代行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:24:31.597

您可以将搜索字符串拆分为字符，然后在循环中检查该字符是否存在于字符串中。对不起代码 - 也生锈了，但我想你可以看到我在说什么......

```
Dim strPostCode As String = "HS1,HS2,HS3,HS4,HS5,HS6,HS7,HS8,HS9,IV41,IV42" 
Dim SearchString As String = "HS24AB"
Dim Match As Boolean = False

Dim i As Integer 

For(i = 0; i< SearchString.Length; i++)
  If(strPostCode.Contains(SearchString.charAt(i)) Then
    Match = True
  Else
   Match = False
  End If
Next 
```

# windows - ZMQ::LibZMQ3 和草莓 perl

> ID：14968538
> 
> 赞同：11
> 
> 时间：2013-02-19T22:12:58.357
> 
> 标签：windows, perl, zeromq, cpan, strawberry-perl

我正在尝试在草莓 perl 上安装 ZMQ::LibZMQ3，但在安装此模块时收到以下错误消息，我的 zmq 库和包含位于 C:\Program Files\ZeroMQ 3.2.2 下：

```
cpan> install ZMQ::LibZMQ3

Running install for module 'ZMQ::LibZMQ3'
Running make for D/DM/DMAKI/ZMQ-LibZMQ3-1.09.tar.gz
Checksum for C:\strawberry\cpan\sources\authors\id\D\DM\DMAKI\ZMQ-LibZMQ3-1.09.tar.gz ok
Scanning cache C:\strawberry\cpan\build for sizes
............................................................................DONE

  CPAN.pm: Building D/DM/DMAKI/ZMQ-LibZMQ3-1.09.tar.gz

Cannot determine perl version info from lib/ZMQ/LibZMQ3.pm
Probing environment variables:
Probing libzmq via pkg-config ...
'pkg-config' is not recognized as an internal or external command,
operable program or batch file.
 - No libzmq found...
Probing zeromq3 via pkg-config ...
'pkg-config' is not recognized as an internal or external command,
operable program or batch file.
 - No zeromq3 found...
Detected the following ZMQ settings:
 + ZMQ_HOME = "C:\Program Files\ZeroMQ 3.2.2"
 + ZMQ_H = "C:\Program Files\ZeroMQ 3.2.2\include\zmq.h"
 + ZMQ_INCLUDES = "C:\Program Files\ZeroMQ 3.2.2\include"
 + ZMQ_LIBS = "C:\Program Files\ZeroMQ 3.2.2\lib"
 + ZMQ_TRACE = (null)
Can't link/include C library 'zmq.h', 'zmq', aborting.
Warning: No success on command[C:\strawberry\perl\bin\perl.exe Makefile.PL]
  DMAKI/ZMQ-LibZMQ3-1.09.tar.gz
  C:\strawberry\perl\bin\perl.exe Makefile.PL -- NOT OK
Running make test
  Make had some problems, won't test
Running make install
  Make had some problems, won't install
Stopping: 'install' failed for 'ZMQ::LibZMQ3'.
Failed during this command:
 DMAKI/ZMQ-LibZMQ3-1.09.tar.gz                : writemakefile NO 'C:\strawberry\perl\bin\perl.exe Ma
kefile.PL' returned status 512 
```

是否可以在 Windows 上安装这个 cpan 模块，如果可以，有人可以帮忙这里可能是什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-03T08:59:07.603

我刚刚在我的 ActiveStatePerl 环境中尝试过。

首先我得到了相同的结果，但后来我重命名了我的 ZMQ 安装并删除了空格。

（从`C:\App\ZeroMQ 2.2.0`到`C:\App\ZeroMQ2_2_0`。）

```
+ ZMQ_HOME = C:\App\ZeroMQ2_2_0
+ ZMQ_H = C:\App\ZeroMQ2_2_0\include\zmq.h
+ ZMQ_INCLUDES = C:\App\ZeroMQ2_2_0\include
+ ZMQ_LIBS = C:\App\ZeroMQ2_2_0\lib
+ ZMQ_TRACE = (null) 
```

所以我通过了问题

```
Can't link/include C library 'zmq.h', 'zmq', aborting. 
```

并在 Makefile.PL 中进行下一步

```
Detecting zmq version... 
```

（这在我的系统上失败了，因为我有一个 0mq 2.2.0 并且 perl 绑定需要 3.3）

希望这也对你有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T23:54:39.460

您使用的是草莓 Perl 还是 ActiveState Perl？Active State Perl 在从 CPAN 安装时可能会遇到问题，除非您已经获得`nmake`并安装了 MinGW 实用程序。我担心这个：

```
Probing libzmq via pkg-config ...
'pkg-config' is not recognized as an internal or external command,
operable program or batch file. 
```

这给我带来了巨大的危险信号。当我尝试安装时，我也注意到了这个小曲子：

```
Detected the following ZMQ settings:
 + ZMQ_HOME = (null)
 + ZMQ_H = (null)
 + ZMQ_INCLUDES = (null)
 + ZMQ_LIBS = (null)
 + ZMQ_TRACE = (null) 
```

嗯..我必须先设置这些环境变量。

接下来，我无法链接/包含 C 库“zmq”，正在中止。这是来自`assert`Makefile中的。[我在Github](https://github.com/lestrrat/ZeroMQ-Perl/issues/15)上发现了这个问题。它说：

> 啊，不错的指针。pthread_create 问题。我的 perl 是用线程支持编译的。我已经重新编译了 perl，这个问题已经消失了。

嗯，是的，Strawberry Perl 是用线程支持编译的。而且，我不会重新编译它。

我推荐的是以下内容：

*   将 ZMQ 安装在名称中没有空格的目录中。我直接安装在`C:\ZeroMQ-3.2.2`.
*   定义那些环境变量。我查看了 Makefile.PL，它需要`ZMQ_LIBS`和`ZMQ_INCLUDES`.
*   确保您只使用 Strawberry Perl 而不是 ActiveState。您可以使用 ActiveState，但需要对类似的东西进行一些调整。
*   在 Makefile.PL 中添加该 Debug 标志`debug => 1`（这意味着您必须执行从命令行运行的 Makefile 安装的手动方法`perl Makefile.PL`。

如果没有线程支持，我不会下载和重新编译 Perl，看看这是否可行。我希望我已经把你送到了正确的道路上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-03T03:17:21.620

这个包不会安装在我的基于 ActiveState Perl Windows 的机器上——尽管一些 ZMQ 包会。似乎在 Windows/Perl 下的支持充其量是有限的。

请参阅此页面： [https](https://github.com/lestrrat/p5-ZMQ/issues/14) ://github.com/lestrrat/p5-ZMQ/issues/14 因为 Strawberry Perl 似乎确实存在已知问题。

讨厌添加这个（不喜欢 Python），但它似乎在 Windows 下使用 Python 2.7 工作。只是做了一个快速安装并运行了包含的测试，它通过了。文档还说 Java 在 Windows 下也能很好地工作。

如果您不是 64 位，这可能会有所帮助（来自 laufeyjarson）：

```
A work-around is to change $^I to have a backup. I used ~ like gvim does:

Line 100 of Makefile.PL:
local $^I = '~';
EDIT:  On recent versions, it is line 203 - JimB

That lets the Makefile.PL work. 
```

# html - 如何从 apache 日志中删除 apple-touch-icon-precomposed.png 错误并保持 iOS 图标效果

> ID：14968539
> 
> 赞同：3
> 
> 时间：2013-02-19T22:12:57.513
> 
> 标签：html, ios, apache, icons

关于标题的总结。

我想摆脱 apple-touch-icon-precomposed.png 日志中的所有 404 错误，而不必添加这样的图像，从而失去 iOS 图标效果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T16:58:31.223

想到两个想法：

*   用于`mod_rewrite`强制错误，使用标志`[F]`（403 禁止）、`[G]`（410 消失）或`[R=404,L]`（“重定向”到 404）。我认为这些跳过错误日志。
*   使用零长度文件（如果设备支持）。

# java - 如何在给定其他数组的情况下创建新的锯齿状数组？有没有从数组中删除元素的方法？

> ID：14968543
> 
> 赞同：1
> 
> 时间：2013-02-19T22:13:01.077
> 
> 标签：java, jagged-arrays

```
public class Yearly { 

    public void getYearlyData() throws FileNotFoundException  {

        String[] state = StatesList.getValues();
        int numberOfStates = state.length; 
```

我有一个数组：`String[] state`，其中包含用户指定的状态的名称。

它可能看起来像这样：`String[] state = {"Illinois", "Kansas", "Wyoming"};`

下面是二维的锯齿状数组。每个元素的第一个子元素是州名，然后是该州的报纸名称。

```
String statePapersInitial[][] = {
                { "Alabama", "BGNB"},
                { "Alaska", "ADNB", "ALKP"},
                { "Arizona", "ADSB" },
                ..................//Total = 51.................
                { "Wyoming","WTEB", "WYOM", "WMPP"}; 
```

目标是创建一个新的锯齿状数组，该数组将仅`statePapersInitial`包含数组中包含用户在`state`数组中选择的状态名称的那些元素。

我调用了新数组`statePapers`

我尝试了以下方法：

```
String[][] statePapers = null;  
int x = 0;
for (x = 0; x < state.length; x++)
{
    int i = 0;
    for (i = 0; i < statePapersInitial.length; i++)
    {   
        if (state[x].equals(statePapersInitial[i][0]))
        {
            int j = 1;
            for (j = 1; j < statePapersInitial[i].length; j++)
                statePapers[x][j-1] = statePapersInitial[i][j];
            System.out.println(statePapers[x][j-1]);
        }
        else;
    }
} 
```

但是，它不起作用，它在线程“main”中引发异常

```
java.lang.NullPointerException
at Yearly.getYearlyData(Yearly.java:95)
at Main.main(Main.java:9) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:55:02.453

仅使用数组：

```
public class q14968543 {
  public static void main(String[] args) {
    String statePapersInitial[][] = {
      { "Alabama", "BGNB" },
      { "Alaska",  "ADNB", "ALKP" },
      { "Arizona", "ADSB" },
      { "Wyoming", "WTEB", "WYOM", "WMPP" }
    };

    for(String[] papers : selectOnly(statePapersInitial, "Alabama", "Wyoming")) {
      for(String paper : papers) {
        System.out.print(paper+ " ");
      }
      System.out.println();
    }
  }

  private static String[][] selectOnly(String[][] statePapers, String ... states) {
    String[][] selected = new String[states.length][0];
    int index = 0;
    for(String state : states) {
      for(String[] papers : statePapers) {
        if(state.equals(papers[0])) {
          selected[index++] = papers;
        }
      }
    }
    return selected;
  }
} 
```

输出是：

```
Alabama BGNB 
Wyoming WTEB WYOM WMPP 
```

现在使用`Map`s 的方法可能如下所示：

```
import java.util.*;
public class q14968543 {
  public static void main(String[] args) {
    Map<String, List<String>> statePapers = new HashMap<>();
    statePapers.put("Alabama", Arrays.asList((new String[] {"BGNB"})));
    statePapers.put("Alaska",  Arrays.asList((new String[] {"ADNB", "ALKP"})));
    statePapers.put("Arizona", Arrays.asList((new String[] {"ADSB"})));
    statePapers.put("Wyoming", Arrays.asList((new String[] {"WTEB", "WYOM", "WMPP"})));

    for(Map.Entry<String, List<String>> state : selectOnly(statePapers, "Alabama", "NOT A STATE", "Wyoming").entrySet()) {
      System.out.print(state.getKey()+"=");
      for(String paper : state.getValue()) {
        System.out.print(paper+ " ");
      }
      System.out.println();
    }
  }
  private static Map<String, List<String>> selectOnly(Map<String, List<String>> statePapers, String ... states) {
    Map<String, List<String>> selected = new HashMap<>();
    for(String state : states) {
      if(statePapers.containsKey(state)) {
        selected.put(state, statePapers.get(state));
      }
    }
    return selected;
  }
} 
```

这个的输出是：

```
Wyoming=WTEB WYOM WMPP 
Alabama=BGNB 
```

在这里你可以看到它忽略了`"NOT A STATE"`传递的那个，它使用状态名称作为键而不是数组中的第一个元素。

# android - Android 使用没有静态变量的 JNI

> ID：14968547
> 
> 赞同：2
> 
> 时间：2013-02-19T22:13:08.747
> 
> 标签：android, ffmpeg, java-native-interface

我使用 MediaMetadataRetriever.java 的源代码作为基础创建了我自己的 Android 版本的 MediaMetadataRetriever。我的版本使用 FFmpeg 来检索元数据。这种方法有效，但是它依赖于 C 代码中的静态变量来保留 JNI 调用之间的状态。这意味着我一次只能使用此类的一个实例，否则状态可能会损坏。这两个Java函数定义如下：

```
public class MediaMetadataRetriever
{
    static {
        System.loadLibrary("metadata_retriever_jni");
    }

    public MediaMetadataRetriever() {

    }

    public native void setDataSource(String path) throws IllegalArgumentException;
    public native String extractMetadata(String key); 
```

}

对应的C（JNI）代码代码为：

```
const char *TAG = "Java_com_example_metadataexample_MediaMetadataRetriever";
static AVFormatContext *pFormatCtx = NULL;

JNIEXPORT void JNICALL
Java_com_example_metadataexample_MediaMetadataRetriever_setDataSource(JNIEnv *env, jclass obj, jstring jpath) {

    if (pFormatCtx) {
        avformat_close_input(&pFormatCtx);
    }

    char duration[30] = "0";
    const char *uri;

    uri = (*env)->GetStringUTFChars(env, jpath, NULL);

    if (avformat_open_input(&pFormatCtx, uri, NULL, NULL) != 0) {
        __android_log_write(ANDROID_LOG_INFO, TAG, "Metadata could not be retrieved");
        (*env)->ReleaseStringUTFChars(env, jpath, uri);
        jniThrowException(env, "java/lang/IllegalArgumentException", NULL);
        return;
    }

    if (avformat_find_stream_info(pFormatCtx, NULL) < 0) {
        __android_log_write(ANDROID_LOG_INFO, TAG, "Metadata could not be retrieved");
        avformat_close_input(&pFormatCtx);
        (*env)->ReleaseStringUTFChars(env, jpath, uri);
        jniThrowException(env, "java/lang/IllegalArgumentException", NULL);
        return;
    }

    (*env)->ReleaseStringUTFChars(env, jpath, uri);
}

JNIEXPORT jstring JNICALL
Java_com_example_metadataexample_MediaMetadataRetriever_extractMetadata(JNIEnv *env, jclass obj, jstring jkey) {

    const char *key;
    jstring value = NULL;

    key = (*env)->GetStringUTFChars(env, jkey, NULL) ;

    if (!pFormatCtx) {
        goto fail;
    }

    if (key) {
        if (av_dict_get(pFormatCtx->metadata, key, NULL, AV_DICT_IGNORE_SUFFIX)) {
            value = (*env)->NewStringUTF(env, av_dict_get(pFormatCtx->metadata, key, NULL, AV_DICT_IGNORE_SUFFIX)->value);
        }
    }

    fail:
    (*env)->ReleaseStringUTFChars(env, jkey, key);

    return value;
} 
```

概述我的问题的示例用法是：

```
MediaMetadataRetriever mmr = new MediaMetadataRetriever();
mmr.setDataSource("one.mp3");

MediaMetadataRetriever mmr2 = new MediaMetadataRetriever();
// This line resets the data source to two.mp3
mmr2.setDataSource("two.mp3");

// should retrieve the artist from one.mp3 but retrieves it from two.mp3 due to the static
// variable being reset in the previous statement       
String artist = mmr.extractMetadata(MediaMetadataRetriever.ARTIST); 
```

有人能解释一下我将如何构造这段代码，这样我就可以使用 MediaMetadataRetriever 的多个实例而不会相互干扰吗？我不想将代码切换到 C++，而且我相当确定我不需要修改 MediaMetadataRetriever.java，因为此代码是从 Android 框架中逐行获取的（它允许多个实例，请参见下面的示例）。看来我需要重新构造 C 代码，但我不确定如何在不使用静态变量的情况下跨 JNI 调用保留状态。提前致谢。

```
File file1 = new File(Environment.getExternalStorageDirectory(), "Music/one.mp3");
File file2 = new File(Environment.getExternalStorageDirectory(), "Music/two.mp3");

android.media.MediaMetadataRetriever mmr = new android.media.MediaMetadataRetriever();
mmr.setDataSource(file1.toString());

android.media.MediaMetadataRetriever mmr2 = new android.media.MediaMetadataRetriever();
mmr2.setDataSource(file2.toString());

// Returns the artist of one.mp3, not two.mp3, as expected. This is the expected behavior
// and confirms that multiple instances of MediaMetadataRetriever can be used simultaneously
mmr.extractMetadata(android.media.MediaMetadataRetriever.METADATA_KEY_ARTIST)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:53:38.503

Restructuring the code would be very straight forward. Instead of using `pFormatCtx` you simply extend the interfaces of the JNI calls so you can pass around the pointer you stored in `pFormatCtx` before. Now the big guestion is how to pass around the pointers while java doesn't know such a datatype? The most straight forward soulution would be to use ints (for 32 bit systems) or longs (for 64 bit systems) to passing pointers to and from the Java environment. Unfortunately you could get you a bit in hot water as soon as you switch between 64 and 32 bit versions of your library.

While I was trying to solve this problem some months ago I stumbled over an article of [Clebert Suconic](http://planet.jboss.org/post/pointers_in_jni_c). He pointed out a very elegant way for passing pointers safely through JNI without "hacking" around with typecasting. Instead he proposes to use `java.nio.ByteBuffer`.

The concept put in a nutshell is: He suggest to create a new ByteBuffer object of length zero: `env->NewDirectByteBuffer(myPointer, 0);` and pass the resulting jobject through the JNI back and forth.

The call `env->NewDirectByteBuffer(myPointer, 0);` creates a imutable byte buffer object pointing to the location you wanted to pass around. The fact that the buffer is imutable is perfect as you don't want to modify the memory location, you only want to store the location itself. What you get is an object encapsulating your pointer and you can leave the pointer size issues to the JVM.

**Edit:** Just for completeness: The pointer can later be retrieved calling `env->GetDirectBufferAddress(myPointer);`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T12:58:11.927

添加一个长字段（或 int，如果您知道您只会在 32 位系统上）来存储本机指针，并在对象被 GC 时将其丢弃在对象的终结器中。然后，您可以从 JNI 将“打开”资源时获得的指针保存到该字段。

从 JNI 手册：

> **访问 Java 字段的过程**
> 
> 要从本机方法获取和设置 Java 字段，您必须执行以下操作：
> 
> 从其类、名称和类型签名中获取该字段的标识符。例如，在 FieldAccess.c 中，我们有：
> 
> `fid = (*env)->GetStaticFieldID(env, cls, "si", "I");`
> 
> 和：
> 
> `fid = (*env)->GetFieldID(env, cls, "s", "Ljava/lang/String;");`
> 
> 使用几个 JNI 函数之一来获取或设置由字段标识符指定的字段。将类传递给适当的静态字段访问函数。将对象传递给适当的实例字段访问函数。例如，在 FieldAccess.c 中，我们有：
> 
> `si = (*env)->GetStaticIntField(env, cls, fid);`
> 
> 和：
> 
> `jstr = (*env)->GetObjectField(env, obj, fid);`
> 
> 与调用 Java 方法类似，我们使用两步过程计算出字段查找的成本。字段 ID 唯一标识给定类中的字段。与方法 ID 类似，字段 ID 在派生它的类被卸载之前保持有效。字段签名
> 
> 字段签名的指定遵循与方法签名相同的编码方案。字段签名的一般形式是：
> 
> `"field type"`
> 
> 字段签名是字段类型的编码符号，用双引号 ("") 括起来。字段符号与方法签名中的参数符号相同。也就是说，你用“I”表示一个整数字段，用“F”表示一个浮点字段，用“D”表示一个双精度字段，用“Z”表示一个布尔字段，等等。
> 
> Java 对象（如字符串）的签名以字母 L 开头，后跟对象的完全限定类，并以分号 (;) 结束。因此，您可以为字符串变量（FieldAccess.java 中的 cs）形成字段签名，如下所示：
> 
> `"Ljava/lang/String;"`
> 
> 数组由前导方括号 ([) 表示，后跟数组的类型。例如，您指定一个整数数组，如下所示：
> 
> `"[I"`
> 
> 请参阅上一节中的表格，该表格总结了 Java 类型签名的编码及其匹配的 Java 类型。
> 
> 您可以使用带有选项“-s”的 javap 从类文件中生成字段签名。例如，运行：
> 
> `> javap -s -p FieldAccess`
> 
> 这将为您提供包含以下内容的输出：
> 
> ```
> ... 
> static si I 
> s Ljava/lang/String; 
> ... 
> ```

# opencv - 在 Visual Studio 2012 中安装 OpenCV

> ID：14968548
> 
> 赞同：3
> 
> 时间：2013-02-19T22:13:25.510
> 
> 标签：opencv, visual-studio-2012, linker, installation

我正在尝试安装 OpenCV 以使用 Visual Studio。我用的是2012Pro版本，不过我觉得应该和vs10一样。我正在关注本教程： [http ://docs.opencv.org/doc/tutorials/introduction/windows_visual_studio_Opencv/windows_visual_studio_Opencv.html#windows-visual-studio-how-to](http://docs.opencv.org/doc/tutorials/introduction/windows_visual_studio_Opencv/windows_visual_studio_Opencv.html#windows-visual-studio-how-to)

我有一个只有一个项目且只有一个文件的解决方案。出于测试目的，我使用了与教程中相同的代码。

```
// Video Image PSNR and SSIM
#include <iostream> // for standard I/O
#include <string>   // for strings
#include <iomanip>  // for controlling float print precision
#include <sstream>  // string to number conversion

#include <opencv2/imgproc/imgproc.hpp>  // Gaussian Blur
#include <opencv2/core/core.hpp>        // Basic OpenCV structures (cv::Mat, Scalar)
#include <opencv2/highgui/highgui.hpp>  // OpenCV window I/O

using namespace std;
using namespace cv;

double getPSNR ( const Mat& I1, const Mat& I2);
Scalar getMSSIM( const Mat& I1, const Mat& I2);

static void help()
{
    cout
        << "\n--------------------------------------------------------------------------" << endl
        << "This program shows how to read a video file with OpenCV. In addition, it tests the"
        << " similarity of two input videos first with PSNR, and for the frames below a PSNR "  << endl
        << "trigger value, also with MSSIM."<< endl
        << "Usage:"                                                                       << endl
        << "./video-source referenceVideo useCaseTestVideo PSNR_Trigger_Value Wait_Between_Frames " << endl
        << "--------------------------------------------------------------------------"   << endl
        << endl;
}
int main(int argc, char *argv[])
{
    help();
    if (argc != 5)
    {
        cout << "Not enough parameters" << endl;
        return -1;
    }
    stringstream conv;

    const string sourceReference = argv[1],sourceCompareWith = argv[2];
    int psnrTriggerValue, delay;
    conv << argv[3] << argv[4];       // put in the strings
    conv >> psnrTriggerValue >> delay;// take out the numbers

    char c;
    int frameNum = -1;          // Frame counter

    VideoCapture captRefrnc(sourceReference),
                 captUndTst(sourceCompareWith);

    if ( !captRefrnc.isOpened())
    {
        cout  << "Could not open reference " << sourceReference << endl;
        return -1;
    }

    if( !captUndTst.isOpened())
    {
        cout  << "Could not open case test " << sourceCompareWith << endl;
        return -1;
    }

    Size refS = Size((int) captRefrnc.get(CV_CAP_PROP_FRAME_WIDTH),
                     (int) captRefrnc.get(CV_CAP_PROP_FRAME_HEIGHT)),
         uTSi = Size((int) captUndTst.get(CV_CAP_PROP_FRAME_WIDTH),
                     (int) captUndTst.get(CV_CAP_PROP_FRAME_HEIGHT));

    if (refS != uTSi)
    {
        cout << "Inputs have different size!!! Closing." << endl;
        return -1;
    }

    const char* WIN_UT = "Under Test";
    const char* WIN_RF = "Reference";

    // Windows
            namedWindow(WIN_RF, CV_WINDOW_AUTOSIZE );
            namedWindow(WIN_UT, CV_WINDOW_AUTOSIZE );
            cvMoveWindow(WIN_RF, 400       ,            0);      //750,  2 (bernat =0)
            cvMoveWindow(WIN_UT, refS.width,            0);      //1500, 2

    cout << "Frame resolution: Width=" << refS.width << "  Height=" << refS.height
         << " of nr#: " << captRefrnc.get(CV_CAP_PROP_FRAME_COUNT) << endl;

    cout << "PSNR trigger value " <<
          setiosflags(ios::fixed) << setprecision(3) << psnrTriggerValue << endl;

    Mat frameReference, frameUnderTest;
    double psnrV;
    Scalar mssimV;

    for(;;) //Show the image captured in the window and repeat
    {
        captRefrnc >> frameReference;
        captUndTst >> frameUnderTest;

        if( frameReference.empty()  || frameUnderTest.empty())
        {
            cout << " < < <  Game over!  > > > ";
            break;
        }

        ++frameNum;
        cout <<"Frame:" << frameNum;

        ///////////////////////////////// PSNR ////////////////////////////////////////////////////
        psnrV = getPSNR(frameReference,frameUnderTest);                 //get PSNR
        cout << setiosflags(ios::fixed) << setprecision(3) << psnrV << "dB";

        //////////////////////////////////// MSSIM /////////////////////////////////////////////////
        if (psnrV < psnrTriggerValue)
        {
            mssimV = getMSSIM(frameReference,frameUnderTest);

            cout << " MSSIM: "
                 << "R" << setiosflags(ios::fixed) << setprecision(3) << mssimV.val[2] * 100
                 << "G" << setiosflags(ios::fixed) << setprecision(3) << mssimV.val[1] * 100
                 << "B" << setiosflags(ios::fixed) << setprecision(3) << mssimV.val[0] * 100;
        }

       cout << endl;

        ////////////////////////////////// Show Image /////////////////////////////////////////////
        imshow( WIN_RF, frameReference);
        imshow( WIN_UT, frameUnderTest);

        c = (char)cvWaitKey(delay);
        if (c == 27) break;
    }

    return 0;
}

double getPSNR(const Mat& I1, const Mat& I2)
{
    Mat s1;
    absdiff(I1, I2, s1);       // |I1 - I2|
    s1.convertTo(s1, CV_32F);  // cannot make a square on 8 bits
    s1 = s1.mul(s1);           // |I1 - I2|^2

    Scalar s = sum(s1);         // sum elements per channel

    double sse = s.val[0] + s.val[1] + s.val[2]; // sum channels

    if( sse <= 1e-10) // for small values return zero
        return 0;
    else
    {
        double  mse =sse /(double)(I1.channels() * I1.total());
        double psnr = 10.0*log10((255*255)/mse);
        return psnr;
    }
}

Scalar getMSSIM( const Mat& i1, const Mat& i2)
{
    const double C1 = 6.5025, C2 = 58.5225;
    /***************************** INITS **********************************/
    int d     = CV_32F;

    Mat I1, I2;
    i1.convertTo(I1, d);           // cannot calculate on one byte large values
    i2.convertTo(I2, d);

    Mat I2_2   = I2.mul(I2);        // I2^2
    Mat I1_2   = I1.mul(I1);        // I1^2
    Mat I1_I2  = I1.mul(I2);        // I1 * I2

    /*************************** END INITS **********************************/

    Mat mu1, mu2;   // PRELIMINARY COMPUTING
    GaussianBlur(I1, mu1, Size(11, 11), 1.5);
    GaussianBlur(I2, mu2, Size(11, 11), 1.5);

    Mat mu1_2   =   mu1.mul(mu1);
    Mat mu2_2   =   mu2.mul(mu2);
    Mat mu1_mu2 =   mu1.mul(mu2);

    Mat sigma1_2, sigma2_2, sigma12;

    GaussianBlur(I1_2, sigma1_2, Size(11, 11), 1.5);
    sigma1_2 -= mu1_2;

    GaussianBlur(I2_2, sigma2_2, Size(11, 11), 1.5);
    sigma2_2 -= mu2_2;

    GaussianBlur(I1_I2, sigma12, Size(11, 11), 1.5);
    sigma12 -= mu1_mu2;

    ///////////////////////////////// FORMULA ////////////////////////////////
    Mat t1, t2, t3;

    t1 = 2 * mu1_mu2 + C1;
    t2 = 2 * sigma12 + C2;
    t3 = t1.mul(t2);              // t3 = ((2*mu1_mu2 + C1).*(2*sigma12 + C2))

    t1 = mu1_2 + mu2_2 + C1;
    t2 = sigma1_2 + sigma2_2 + C2;
    t1 = t1.mul(t2);               // t1 =((mu1_2 + mu2_2 + C1).*(sigma1_2 + sigma2_2 + C2))

    Mat ssim_map;
    divide(t3, t1, ssim_map);      // ssim_map =  t3./t1;

    Scalar mssim = mean( ssim_map ); // mssim = average of ssim map
    return mssim;
} 
```

我已经下载了 2.4.3 版本并将其解压缩到 C:\BUILD\ 所以现在我有 C:\BUILD\opencv 等等

在 Visual Studio 的属性管理器中，我转到 Microsoft.Cpp.Win.32.user 表并更改以下内容：（根据堆栈溢出中的上述教程和其他解决方案）

在*C/C++ -> General*我在*Additional Include Directories中添加*

```
C:\BUILD\opencv\modules\core\include\opencv2\core
C:\BUILD\opencv\include\opencv
C:\BUILD\opencv\include\opencv2
C:\BUILD\opencv\build\include
C:\BUILD\opencv\build\include\opencv2
C:\BUILD\opencv\build\include\opencv 
```

在*Linker->General*我添加了*Additional Library Directories*

```
C:\BUILD\opencv\build\x86\vc10\lib 
```

在*链接器->输入->附加依赖项中*

```
opencv_core243.lib
opencv_imgproc243.lib
opencv_highgui243.lib
opencv_ml243.lib
opencv_video243.lib
opencv_features2d243.lib
opencv_calib3d243.lib
opencv_objdetect243.lib
opencv_contrib243.lib
opencv_legacy243.lib
opencv_flann243.lib 
```

（是的，我知道用于调试的 d 。但两者都不起作用）

我尝试构建解决方案，但出现以下错误：

```
1>Test.obj : error LNK2019: unresolved external symbol "void __cdecl cv::fastFree(void *)" (?fastFree@cv@@YAXPAX@Z) referenced in function "public: __thiscall cv::Mat::~Mat(void)" (??1Mat@cv@@QAE@XZ)
1>Test.obj : error LNK2019: unresolved external symbol "public: __thiscall cv::_InputArray::_InputArray(class cv::Mat const &)" (??0_InputArray@cv@@QAE@ABVMat@1@@Z) referenced in function "class cv::Mat & __cdecl cv::operator-=(class cv::Mat const &,class cv::Mat const &)" (??Zcv@@YAAAVMat@0@ABV10@0@Z)
1>Test.obj : error LNK2019: unresolved external symbol "public: __thiscall cv::_OutputArray::_OutputArray(class cv::Mat &)" (??0_OutputArray@cv@@QAE@AAVMat@1@@Z) referenced in function "class cv::Mat & __cdecl cv::operator-=(class cv::Mat const &,class cv::Mat const &)" (??Zcv@@YAAAVMat@0@ABV10@0@Z)
1>Test.obj : error LNK2019: unresolved external symbol "class cv::_OutputArray const & __cdecl cv::noArray(void)" (?noArray@cv@@YAABV_OutputArray@1@XZ) referenced in function "class cv::Mat & __cdecl cv::operator-=(class cv::Mat const &,class cv::Mat const &)" (??Zcv@@YAAAVMat@0@ABV10@0@Z)
1>Test.obj : error LNK2019: unresolved external symbol "public: void __thiscall cv::Mat::convertTo(class cv::_OutputArray const &,int,double,double)const " (?convertTo@Mat@cv@@QBEXABV_OutputArray@2@HNN@Z) referenced in function "class cv::Scalar_<double> __cdecl getMSSIM(class cv::Mat const &,class cv::Mat const &)" (?getMSSIM@@YA?AV?$Scalar_@N@cv@@ABVMat@2@0@Z)
1>Test.obj : error LNK2019: unresolved external symbol "public: class cv::MatExpr __thiscall cv::Mat::mul(class cv::_InputArray const &,double)const " (?mul@Mat@cv@@QBE?AVMatExpr@2@ABV_InputArray@2@N@Z) referenced in function "class cv::Scalar_<double> __cdecl getMSSIM(class cv::Mat const &,class cv::Mat const &)" (?getMSSIM@@YA?AV?$Scalar_@N@cv@@ABVMat@2@0@Z)
1>Test.obj : error LNK2019: unresolved external symbol "public: void __thiscall cv::Mat::deallocate(void)" (?deallocate@Mat@cv@@QAEXXZ) referenced in function "public: void __thiscall cv::Mat::release(void)" (?release@Mat@cv@@QAEXXZ)
1>Test.obj : error LNK2019: unresolved external symbol "public: void __thiscall cv::Mat::copySize(class cv::Mat const &)" (?copySize@Mat@cv@@QAEXABV12@@Z) referenced in function "public: __thiscall cv::Mat::Mat(class cv::Mat const &)" (??0Mat@cv@@QAE@ABV01@@Z)
1>Test.obj : error LNK2019: unresolved external symbol "void __cdecl cv::subtract(class cv::_InputArray const &,class cv::_InputArray const &,class cv::_OutputArray const &,class cv::_InputArray const &,int)" (?subtract@cv@@YAXABV_InputArray@1@0ABV_OutputArray@1@0H@Z) referenced in function "class cv::Mat & __cdecl cv::operator-=(class cv::Mat const &,class cv::Mat const &)" (??Zcv@@YAAAVMat@0@ABV10@0@Z)
1>Test.obj : error LNK2019: unresolved external symbol "void __cdecl cv::divide(class cv::_InputArray const &,class cv::_InputArray const &,class cv::_OutputArray const &,double,int)" (?divide@cv@@YAXABV_InputArray@1@0ABV_OutputArray@1@NH@Z) referenced in function "class cv::Scalar_<double> __cdecl getMSSIM(class cv::Mat const &,class cv::Mat const &)" (?getMSSIM@@YA?AV?$Scalar_@N@cv@@ABVMat@2@0@Z)
1>Test.obj : error LNK2019: unresolved external symbol "class cv::Scalar_<double> __cdecl cv::sum(class cv::_InputArray const &)" (?sum@cv@@YA?AV?$Scalar_@N@1@ABV_InputArray@1@@Z) referenced in function "double __cdecl getPSNR(class cv::Mat const &,class cv::Mat const &)" (?getPSNR@@YANABVMat@cv@@0@Z)
1>Test.obj : error LNK2019: unresolved external symbol "class cv::Scalar_<double> __cdecl cv::mean(class cv::_InputArray const &,class cv::_InputArray const &)" (?mean@cv@@YA?AV?$Scalar_@N@1@ABV_InputArray@1@0@Z) referenced in function "class cv::Scalar_<double> __cdecl getMSSIM(class cv::Mat const &,class cv::Mat const &)" (?getMSSIM@@YA?AV?$Scalar_@N@cv@@ABVMat@2@0@Z)
1>Test.obj : error LNK2019: unresolved external symbol "void __cdecl cv::absdiff(class cv::_InputArray const &,class cv::_InputArray const &,class cv::_OutputArray const &)" (?absdiff@cv@@YAXABV_InputArray@1@0ABV_OutputArray@1@@Z) referenced in function "double __cdecl getPSNR(class cv::Mat const &,class cv::Mat const &)" (?getPSNR@@YANABVMat@cv@@0@Z)
1>Test.obj : error LNK2019: unresolved external symbol "int __cdecl cv::_interlockedExchangeAdd(int *,int)" (?_interlockedExchangeAdd@cv@@YAHPAHH@Z) referenced in function "public: __thiscall cv::Mat::Mat(class cv::Mat const &)" (??0Mat@cv@@QAE@ABV01@@Z)
1>Test.obj : error LNK2019: unresolved external symbol "class cv::MatExpr __cdecl cv::operator+(class cv::Mat const &,class cv::Mat const &)" (??Hcv@@YA?AVMatExpr@0@ABVMat@0@0@Z) referenced in function "class cv::Scalar_<double> __cdecl getMSSIM(class cv::Mat const &,class cv::Mat const &)" (?getMSSIM@@YA?AV?$Scalar_@N@cv@@ABVMat@2@0@Z)
1>Test.obj : error LNK2019: unresolved external symbol "class cv::MatExpr __cdecl cv::operator+(class cv::MatExpr const &,class cv::Scalar_<double> const &)" (??Hcv@@YA?AVMatExpr@0@ABV10@ABV?$Scalar_@N@0@@Z) referenced in function "class cv::Scalar_<double> __cdecl getMSSIM(class cv::Mat const &,class cv::Mat const &)" (?getMSSIM@@YA?AV?$Scalar_@N@cv@@ABVMat@2@0@Z)
1>Test.obj : error LNK2019: unresolved external symbol "class cv::MatExpr __cdecl cv::operator*(double,class cv::Mat const &)" (??Dcv@@YA?AVMatExpr@0@NABVMat@0@@Z) referenced in function "class cv::Scalar_<double> __cdecl getMSSIM(class cv::Mat const &,class cv::Mat const &)" (?getMSSIM@@YA?AV?$Scalar_@N@cv@@ABVMat@2@0@Z)
1>Test.obj : error LNK2019: unresolved external symbol "void __cdecl cv::GaussianBlur(class cv::_InputArray const &,class cv::_OutputArray const &,class cv::Size_<int>,double,double,int)" (?GaussianBlur@cv@@YAXABV_InputArray@1@ABV_OutputArray@1@V?$Size_@H@1@NNH@Z) referenced in function "class cv::Scalar_<double> __cdecl getMSSIM(class cv::Mat const &,class cv::Mat const &)" (?getMSSIM@@YA?AV?$Scalar_@N@cv@@ABVMat@2@0@Z)
1>Test.obj : error LNK2019: unresolved external symbol _cvMoveWindow referenced in function _main
1>Test.obj : error LNK2019: unresolved external symbol _cvWaitKey referenced in function _main
1>Test.obj : error LNK2019: unresolved external symbol "void __cdecl cv::namedWindow(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,int)" (?namedWindow@cv@@YAXABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@H@Z) referenced in function _main
1>Test.obj : error LNK2019: unresolved external symbol "void __cdecl cv::imshow(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,class cv::_InputArray const &)" (?imshow@cv@@YAXABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@ABV_InputArray@1@@Z) referenced in function _main
1>Test.obj : error LNK2019: unresolved external symbol "public: __thiscall cv::VideoCapture::VideoCapture(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &)" (??0VideoCapture@cv@@QAE@ABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z) referenced in function _main
1>Test.obj : error LNK2019: unresolved external symbol "public: virtual __thiscall cv::VideoCapture::~VideoCapture(void)" (??1VideoCapture@cv@@UAE@XZ) referenced in function _main
1>Test.obj : error LNK2019: unresolved external symbol "public: virtual bool __thiscall cv::VideoCapture::isOpened(void)const " (?isOpened@VideoCapture@cv@@UBE_NXZ) referenced in function _main
1>Test.obj : error LNK2019: unresolved external symbol "public: virtual double __thiscall cv::VideoCapture::get(int)" (?get@VideoCapture@cv@@UAENH@Z) referenced in function _main 
```

我试图在这里查看类似的问题，但所有解决方案都是将实际库添加到 Addicionl Dependencies。我已经做到了。所以我不知道...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-04T12:22:36.310

您是否已将 OpenCv 路径添加到您的环境详细信息中？这通常是大多数教程告诉您要做的第一步。

但是，如果这在这里不起作用，我总是用来帮助我设置它的[链接。](http://karanjthakkar.wordpress.com/2012/11/21/usin-opencv-2-4-2-with-visual-studio-2012-on-windows-7-64-bit/)它使用的是 VS 2012 和 OpenCV 2.4.3 版本，因此与您的问题非常相似。

# mysql - 当多个表被锁定时，DBA 可以做什么？

> ID：14968549
> 
> 赞同：0
> 
> 时间：2013-02-19T22:13:37.770
> 
> 标签：mysql

我有多个表`locked`，似乎它们正在阻止其他查询运行。什么可能导致此问题，我该如何预防？在此期间我能做些什么来释放这些`locks`？我通读了 mysql 文档，但我真的不明白防止这个问题的程序是什么。

```
+----------+----------+--------+-------------+
| Database | Table    | In_use | Name_locked |
+----------+----------+--------+-------------+
| bd1      | table1   |      0 |           0 |
| bd1      | table2   |      5 |           0 |
| bd1      | table3   |      0 |           0 |
| bd1      | table4   |      1 |           0 |
| bd1      | table5   |      0 |           0 |
| bd1      | table6   |      2 |           0 |
| bd1      | table7   |      4 |           0 |
+----------+----------+--------+-------------+ 
```

显示引擎 INNODB 状态；

```
---TRANSACTION A7DF86B, ACTIVE 10 sec starting index read
mysql tables in use 1, locked 1
LOCK WAIT 2 lock struct(s), heap size 376, 1 row lock(s)
MySQL thread id 170083, OS thread handle 0x15a8, query id 1780479 23.20.117.233 Server2 Updating
UPDATE table7 SET EId = 'b457200', LEd = '2013-02-19 16:03:34', ELR = 'y', LU = '2013-02-19 16:03:
34' WHERE (ObKey = '79321fc7b5ac') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:19:06.933

好吧，首先，您应该找到引用这些表的查询并了解它们的使用方式。其次，您可以尝试使用一些查询提示来增加并发性。见[http://dev.mysql.com/doc/refman/5.0/en/innodb-locking-reads.html](http://dev.mysql.com/doc/refman/5.0/en/innodb-locking-reads.html)

# c# - 使用 TryParse 检查负数

> ID：14968550
> 
> 赞同：0
> 
> 时间：2013-02-19T22:13:45.703
> 
> 标签：c#, tryparse

是否可以使用检查负数`Int32.TryParse`？

```
int defaultTop;
displayTop = (Int32.TryParse(DisplayTop, out defaultTop) ? Convert.ToInt32(DisplayTop) : 1000 ); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T22:27:33.340

为什么不使用`UInt32.TryParse(DisplayTop, out defaultTop)`？

如果数字为 0 或正数，这将返回 true，如果为负数，则返回 false。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T22:19:29.293

试试这个

```
int defaultTop;
var isValidInt = Int32.TryParse(DisplayTop, out defaultTop);
displayTop = isValidInt && defaultTop >= 0 ? defaultTop : 1000; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T22:19:45.840

你不能单独使用 TryParse 来做到这一点，你必须`defaultTop`独立检查 的值。如果您想在一行中完成所有操作，可以尝试：

```
displayTop = ((Int32.TryParse(DisplayTop, out defaultTop) && defaultTop >= 0) ? defaultTop : 1000 ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-19T22:19:35.767

使用 Math.Max：

```
displayTop = Math.Max(1,(Int32.TryParse(DisplayTop, out defaultTop) ? Convert.ToInt32(DisplayTop) : 1000 )); 
```

诚然，这么长的表达式有点难看，但它确实有效。

# c# - 使用带分隔符的 += 运算符

> ID：14968553
> 
> 赞同：0
> 
> 时间：2013-02-19T22:14:02.887
> 
> 标签：c#, asp.net

我有一个带有文本框、按钮和标签控件的简单 ASP.net 程序。

在按钮单击事件中，我将文本框文本分配给标签文本，并每次使用赋值运算符添加到它。我使用逗号分隔值。

```
protected void Button1_Click(object sender, EventArgs e)
{
    Label1.Text += TextBox1.Text + ",";
} 
```

问题是这段代码给了我一个额外的逗号。例如，如果在文本框中输入值 1、2、3、4 和 5，则标签文本将为：

```
1,2,3,4,5, 
```

我需要它是：

```
1,2,3,4,5 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T22:16:19.563

完成后，执行以下操作：

```
Label1.Text.Trim(','); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T22:16:30.083

第一次只需分配 textbox.text，然后先添加逗号，然后添加 textbox.text

```
protected void Button1_Click(object sender, EventArgs e)
{
    if(Label1.Text.Length == 0)
        Label1.Text = TextBox1.Text;
    else
        Label1.Text += "," + TextBox1.Text;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T22:16:48.437

```
protected void Button1_Click(object sender, EventArgs e)
{
    if(Label1.Text.Lenght <= 0)
        Label1.Text = TextBox1.Text;
    else
        Label1.Text += "," + TextBox1.Text;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-19T22:17:44.943

先附加逗号，除非标签为空白

```
protected void Button1_Click(object sender, EventArgs e)
{
    if (String.IsNullOrEmpty(Label1.Text))
        Label1.Text = TextBox1.Text;
    else
        Label1.Text += "," + TextBox1.Text;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-19T22:17:33.303

尝试：

```
protected void Button1_Click(object sender, EventArgs e)
{
    Label1.Text += (Label1.Text.Length == 0 ? "" : "," ) + TextBox1.Text;
} 
```

这样，仅当标签为空时，您才在添加的文本前添加逗号

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-19T22:18:55.243

```
Label1.Text += string.IsNullOrEmpty(Label1.Text) ? TextBox1.Text : string.Format(",{0}", TextBox1.Text); 
```

# nodatime - 将 NodaTime DateTimeZone 转换为 TimeZoneInfo

> ID：14968554
> 
> 赞同：12
> 
> 时间：2013-02-19T22:14:16.460
> 
> 标签：nodatime

我使用 NodaTime 是因为它很好地支持 zoneinfo 数据，但是我有一个案例需要将其`DateTimeZone`转换`TimeZoneInfo`为在 Quartz.NET 中使用。

这里推荐的方法是什么？IANA 有一个 Windows 时区和 zoneinfo 时区之间的映射文件，我可以创建一个利用此信息的扩展方法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-23T08:32:40.423

如果可能的话，我会避免使用反射。我不想打赌您使用未来版本的方法:)

随时为将来的版本提交此功能的功能请求，但目前我会以更稳定的方式构建您的反向字典：

```
// Note: this version lets you work with any IDateTimeZoneSource, although as the only
// other built-in source is BclDateTimeZoneSource, that may be less useful :)
private static IDictionary<string, string> LoadTimeZoneMap(IDateTimeZoneSource source)
{
    var nodaToWindowsMap = new Dictionary<string, string>();
    foreach (var bclZone in TimeZoneInfo.GetSystemTimeZones())
    {
        var nodaId = source.MapTimeZoneId(bclZone);
        if (nodaId != null)
        {
            nodaToWindowsMap[nodaId] = bclZone.Id;
        }
    }
    return nodaToWindowsMap;
} 
```

当然，这*不会*涵盖 TZDB 中的所有时区。事实上，它甚至不会根据我们使用的 CLDR 信息提供我们*可以*提供的所有信息……CLDR 为每个 Windows ID 提供了多个映射，我们目前只存储第一个。我们一直在努力研究如何公开更多内容，但还没有成功。欢迎在 Noda Time 邮件列表上发表想法 :)

另请注意，仅仅因为 BCL 和 TZDB 区域之间存在映射并不意味着它们实际上会为所有内容提供相同的结果 - 它只是可用的最接近的映射。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-19T22:21:55.527

啊哈，我找到了 -`TzdbDateTimeZoneSource`有一个`MapTimeZoneId`我可以弹出的方法`TimeZoneInfo.FindSystemTimeZoneById`。

编辑：`MapTimeZoneId`是否从 Windows 时区映射到 zoneinfo ......我最终诉诸反射来做相反方向的映射：

```
using System;
using System.Collections.Generic;
using System.Reflection;

using NodaTime;
using NodaTime.TimeZones;

/// <summary>
/// Extension methods for <see cref="DateTimeZone" />.
/// </summary>
internal static class DateTimeZoneExtensions
{
    private static readonly Lazy<IDictionary<string, string>> map = new Lazy<IDictionary<string, string>>(LoadTimeZoneMap, true);

    public static TimeZoneInfo ToTimeZoneInfo(this DateTimeZone timeZone)
    {
        string id;
        if (!map.Value.TryGetValue(timeZone.Id, out id))
        {
            throw new TimeZoneNotFoundException(string.Format("Could not locate time zone with identifier {0}", timeZone.Id));
        }

        TimeZoneInfo timeZoneInfo = TimeZoneInfo.FindSystemTimeZoneById(id);
        if (timeZoneInfo == null)
        {
            throw new TimeZoneNotFoundException(string.Format("Could not locate time zone with identifier {0}", timeZone.Id));
        }

        return timeZoneInfo;
    }

    private static IDictionary<string, string> LoadTimeZoneMap()
    {
        TzdbDateTimeZoneSource source = new TzdbDateTimeZoneSource("NodaTime.TimeZones.Tzdb");
        FieldInfo field = source.GetType().GetField("windowsIdMap", BindingFlags.Instance | BindingFlags.NonPublic);
        IDictionary<string, string> map = (IDictionary<string, string>)field.GetValue(source);

        // reverse the mappings
        Dictionary<string, string> reverseMap = new Dictionary<string, string>();
        foreach (KeyValuePair<string, string> kvp in map)
        {
            reverseMap.Add(kvp.Value, kvp.Key);
        }

        return reverseMap;
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-12-21T21:53:46.333

您可以使用[Matt Johnson的](https://stackoverflow.com/users/634824/matt-johnson)[TimeZoneConverter](https://github.com/mj1856/TimeZoneConverter)库。

NodeTime TzdbZoneLocation 使用的 ZoneId 是[IANA time zone](https://www.iana.org/time-zones)，因此您可以像这样获取 TimeZoneInfo ：

```
string windowsTimeZoneName = TZConvert.IanaToWindows(tzdbZoneLocation.ZoneId);
var timeZoneInfo = TimeZoneInfo.FindSystemTimeZoneById(windowsTimeZoneName); 
```

不要忘记用 try-catch 包装它，以防万一。

另请查看[原始的 Matt Johnson 解决方案](https://stackoverflow.com/a/17348822/810306)，用于在 IANA 时区和 Windows 时区之间进行转换。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-06-21T16:55:14.720

但是，这在 PCL 中不起作用，因为大部分工作是由 .NET 在 .GetSystemTImeZones() 和 .FindSystemTIemZoneById() 方法中完成的——这在 PCL 中不存在。

令我震惊的是，对于您可以从 NodaTime 获得的所有信息，当您已经拥有“美国/东部”的区域名称时，获得像“EST”缩写这样简单的东西似乎已经阻止了我的前进。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-28T18:26:20.900

对于`NodaTime`汇编版本`3.0.9.0`，tzdb time zone ids ( `NodaTime.DateTimeZone.Id`) 到 dotnet time zone info ids ( `System.TimeZoneInfo.Id`) 的映射和相反的过程可以通过这两个字符串键和值字典实现：`NodaTime.TimeZones.TzdbDateTimeZoneSource.Default.TzdbToWindowsIds`, `NodaTime.TimeZones.TzdbDateTimeZoneSource.Default.WindowsToTzdbIds`.

# ruby-on-rails - Rails 应用程序中与 SOLR 的关联

> ID：14968555
> 
> 赞同：0
> 
> 时间：2013-02-19T22:14:18.663
> 
> 标签：ruby-on-rails, solr, full-text-search

我面临一个难题。

我正在尝试构建一个搜索选项以及允许用户按已确定记录的位置进行搜索的方面。

问题是我的数据库结构如下：

{Location (id, name)} has_many {User (id, name)} and user has_many {pins (id, name)}

我的控制器：

```
def index
    @search = Pin.search do
      fulltext params[:search]
      order_by :created_at, :desc
    end
    @pins = @search.results

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @pins }
    end
  end 
```

我的引脚模型：

```
 searchable do
    text :title, :boost => 5
    text :description
  end
    belongs_to :user 
```

我能做些什么？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:19:20.223

您可以将任何您想要的东西放在您的`searchable`区块中，例如您的关联和其他您需要能够搜索的东西。

```
searchable do
    text :title, :boost => 5
    text :description
    text :location do
      location.name
    end
  end 
```

# java - 在 GAE 类路径上读取配置文件

> ID：14968557
> 
> 赞同：0
> 
> 时间：2013-02-19T22:14:35.320
> 
> 标签：java, google-app-engine, io, filesystems

我了解您无法`java.io.File`从 GAE 应用程序（受限）访问。但是，我记得在某处读过它可以访问 WAR 中的任何内容（可能是 WAR 下的任何内容`WEB-INF/`？）。

所以我问：**有没有办法从 GAE 应用程序访问 WAR 中的文件？**换句话说，如果我部署具有以下结构的 WAR：

```
MyApp/
    WEB-INF/
        web.xml
        appengine-web.xml
        ...etc.

        my-special-config.xml 
```

我有什么方法可以`my-special-config.xml`从我的 GAE 应用程序中阅读吗？如果是这样，如何以及使用什么课程？我在 GAE SDK 中看到有一个`AppEngineFile`，并且想知道我是否可以使用它。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T02:18:49.007

[在此处](https://developers.google.com/appengine/docs/java/#Java_The_sandbox)查看开发指南：

> ## 文件系统
> 
> Java 应用程序不能使用任何用于写入文件系统的类，例如 java.io.FileWriter。应用程序可以使用 java.io.FileReader 等类从文件系统中读取自己的文件。应用程序还可以将自己的文件作为“资源”访问，例如使用[Class.getResource()](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Class.html#getResource%28java.lang.String%29)或[ServletContext.getResource()](http://docs.oracle.com/javaee/5/api/javax/servlet/ServletContext.html#getResourceAsStream%28java.lang.String%29)。
> 
> 应用程序只能通过文件系统访问被视为“资源文件”的文件。默认情况下，WAR 中的所有文件都是“资源文件”。[您可以使用appengine-web.xml](https://developers.google.com/appengine/docs/java/config/appconfig)文件从该集合中排除文件。

POJO类中classpath下读取资源文件的示例代码：

```
String file = "/WEB-INF/my-special-config.xml";
InputStream in = getClass().getResourceAsStream(file); 
```

Servlet类中classpath下读取资源文件的示例代码：

```
String file = "/WEB-INF/my-special-config.xml";
InputStream in = getServletContext().getResourceAsStream(file); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T23:38:21.707

似乎您可以像这样使用 File 类：

```
 String FileName = "my-special-config.xml";
    File file = new File(FileName);
    BufferedReader bufferedReader = new BufferedReader(new FileReader(file)); 
```

看到[这个](https://groups.google.com/forum/?fromgroups=#!topic/google-appengine-java/SDPm_HJcMaQ)。

# python - 如何在不同类中创建的 matplotlib 画布上绘图

> ID：14968559
> 
> 赞同：0
> 
> 时间：2013-02-19T22:14:53.867
> 
> 标签：python, class, matplotlib, traits, traitsui

我有一堂课：

```
class CalcPlot(HasTraits):
    display = Instance(Figure)
    ax1 = self.display.axes[0]
    x = np.linspace(0,10,11)
    y = np.linspace(0,10,11)
    self.display = ax1.plot(x,y,color='r',marker='o')
    wx.CallAfter(self.display.canvas.draw)

    def _display_default(self):
        figure = Figure()
        ax1 = figure.add_subplot(111)
        ax1 = figure.axes[0] 
```

显然上面的代码不起作用。如果我想绘制一个新图形，我将如何访问不同类中的显示实例。

# python - 如何从字符串中获取对象？

> ID：14968560
> 
> 赞同：0
> 
> 时间：2013-02-19T22:14:56.543
> 
> 标签：python, string, object, serialization

说我有以下`class`

```
class Test:
    def TestFunc(self):
        print 'this is Test::TestFunc method' 
```

现在，我创建了一个实例`class Test`

```
>>> 
>>> t = Test()
>>> 
>>> t
<__main__.Test instance at 0xb771b28c>
>>> 
```

现在，`t.TestFunc`表示如下

```
>>> 
>>> t.TestFunc
<bound method Test.TestFunc of <__main__.Test instance at 0xb771b28c>>
>>> 
```

现在我将`Python`表示存储`t.TestFunc`到一个字符串`string_func`

```
>>> 
>>> string_func = str(t.TestFunc)
>>> string_func
'<bound method Test.TestFunc of <__main__.Test instance at 0xb771b28c>>'
>>> 
```

现在，有没有办法从字符串中获取函数句柄`<bound method Test.TestFunc of <__main__.Test instance at 0xb771b28c>>`。例如，

```
>>> 
>>> func = xxx(string_func)
>>> func 
<bound method Test.TestFunc of <__main__.Test instance at 0xb771b28c>>
>>> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T22:23:23.097

您不能单独使用字符串返回同一个对象，因为 Python 没有提供通过内存地址查找对象的方法。

如果它的构造函数不带任何参数，您*可以*返回*另一个*实例`__main__.Test`，然后再次查找该方法，但它不会具有相同的内存地址。

您必须解析字符串的组件（模块、类名和方法名），然后`getattr()`在各种组件上使用，将类作为流程的一部分进行实例化。我怀疑这是你想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:22:23.250

有几个陷阱需要考虑：

*   `Test`可能或可能不再存在的实例
*   该实例可能已被垃圾收集
*   该实例可能具有猴子修补功能`Test.TestFunc`
*   可能已创建不同的对象`0xb771b28c`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T22:19:58.473

您可以使用[getattr](http://docs.python.org/2/library/functions.html#getattr)。

```
 In [1]:
    class Test:
        def TestFunc(self):
            print 'this is Test::TestFunc method'

    In [2]: t = Test()

    In [3]: getattr(t, 'TestFunc')
    Out[3]: <bound method Test.TestFunc of <__main__.Test instance at 0xb624d68c>>

    In [4]: getattr(t, 'TestFunc')()
    this is Test::TestFunc method 
```

# load - jmeter 用户帐户与线程

> ID：14968561
> 
> 赞同：3
> 
> 时间：2013-02-19T22:15:00.310
> 
> 标签：load, automated-tests, jmeter

我刚开始使用 jmeter，但有一个问题我无法找到答案：

线程是否与用户相同？

我问的原因是我有一个需要用户名/密码的网页。如果我在记录步骤期间使用一个用户名和密码，但在测试运行期间使用 50 个线程 - 这是模拟 50 个用户还是仅模拟一个？

我需要创建 50 个测试用户帐户才能正确测试吗？我知道我可以使用变量和 jmeter 中的各种控件来执行此操作，但我需要了解的是这是必需的。

而且，如果我不需要创建 50 个用户，为什么不呢？似乎所有线程都将使用相同的会话信息 - 或者这没有发挥作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T20:06:03.160

In JMeter 1 User = 1 Thread

Yes you must have 50 test user accounts to be realistic.

[CSV_Data_Set_Config](http://jmeter.apache.org/usermanual/component_reference.html#CSV_Data_Set_Config) is the component to look at for variables.

You understand well, 50 threads using 1 account => TOTALLY WRONG AND UNREALISTIC :-)

# ios - 使用 AdWhirl 的第一个 iAd 请求始终会在 iPad 上返回纵向广告

> ID：14968562
> 
> 赞同：0
> 
> 时间：2013-02-19T22:15:03.170
> 
> 标签：ios, ipad, iad, adwhirl

我正在使用 AdWhirl 在我的应用中显示 iAd 和 AdMob 广告。在 iPad 上，当处于横向时，我创建了一个 1024 宽的 AdWhirlView，但返回的第一个 iAd 始终是纵向宽度广告 (768)。如果我将 iPad 旋转为纵向，然后再转回横向，则广告会以 1024 宽的全横向正确显示。

为什么横向广告在不需要轮播的情况下无法开始展示？

```
- (void) setupAdWhirl {
    if (self.adWhirlView == nil) {
        CGFloat adWhirlHeight = 90.0;

        CGSize size = self.rootViewController.view.bounds.size;
        NSLog(@"rootVC.bounds=%@", NSStringFromCGRect(self.rootViewController.view.bounds));

        AdWhirlView *adWhirl = [AdWhirlView requestAdWhirlViewWithDelegate:self];
        adWhirl.frame = CGRectMake(0, size.height - adWhirlHeight, size.width, adWhirlHeight);
        adWhirl.autoresizingMask = UIViewAutoresizingFlexibleRightMargin | UIViewAutoresizingFlexibleTopMargin;
        NSLog(@"adWhirl.frame=%@", NSStringFromCGRect(adWhirl.frame));

        [self.rootViewController.view addSubview:adWhirl];
        self.adWhirlView = adWhirl;
    }
} 
```

这两个日志语句输出以下内容：

```
rootVC.bounds={{0, 0}, {1024, 748}}
adWhirl.frame={{0, 658}, {1024, 90}} 
```

所以我最初在 adWhirlView 上设置的框架是 1024 宽和 90 高。但是，当它加载第一个 iAd 时，它会调整为 768 宽。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:39:29.823

我不知道是否有“正确”的方法来做到这一点，但我破解了 AdWhirl 源并设法让它按我的预期工作。

在iAd适配器中，-getAd方法，在创建完ADBannerView之后，我添加了如下代码：

```
 iAdView = [[ADBannerView alloc] initWithAdType:ADAdTypeBanner];
  iAdView.autoresizingMask = UIViewAutoresizingFlexibleWidth;

  // Added lines below

  if (self.adWhirlView.bounds.size.width > self.adWhirlView.bounds.size.height) {
      iAdView.currentContentSizeIdentifier = kADBannerContentSizeIdentifierLandscape;
  }
  else {
      iAdView.currentContentSizeIdentifier = kADBannerContentSizeIdentifierPortrait;
  } 
```

# javascript - 查找剩余的 setTimeouts 和 setIntervals

> ID：14968563
> 
> 赞同：2
> 
> 时间：2013-02-19T22:15:05.903
> 
> 标签：javascript, google-chrome, firebug, google-chrome-devtools

有没有办法查看当前运行的超时和/或使用 setTimeout 或 setInterval 创建的间隔？

由于每个都返回一个 ID，有没有办法在开发者控制台中查看当前的 ID？这将帮助我在我的应用程序中找到“泄漏”。

我现在能想到的唯一方法是为我的 setInterval/setTimeout 调用创建一个包装器。或者覆盖窗口中的内置对象（即`window.setTimeout=function()`），然后让对象映射保持跟踪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:51:15.803

基于[这个答案](https://stackoverflow.com/questions/958433/how-can-i-clearinterval-for-all-setinterval)，

```
for (var i = 1; i < 99999; i++){
   window.clearInterval(i);
   window.clearTimeout(i);
} 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T23:08:39.920

我刚刚为您编写的这段代码（有趣的练习）覆盖了`setTimeout`and`clearTimeout`函数，并创建了跟踪全局变量中可用的超时的函数`timeouts`。在 jsfiddle 上试试：http: [//jsfiddle.net/KqZmb/](http://jsfiddle.net/KqZmb/)

```
(function() {
  window.timeouts = [];
  var _setTimeout = window.setTimeout;
  window.setTimeout = function() { 
    var id = _setTimeout.apply( this, arguments );
    timeouts.push( id );
    _setTimeout( function() {
        timeouts.splice( timeouts.indexOf( id ), 1);
      }, arguments[1] );
     return id;
  };
  var _clearTimeout = window.clearTimeout;
  window.clearTimeout = function( id ) { 
    _clearTimeout( id );
    timeouts.splice( timeouts.indexOf( id ), 1);
  };
})(); 
```

您可以轻松地将其调整为`setInterval`和`clearInterval`。

不过我想说的是，您可能需要跟踪超时，以避免应用程序中出现奇怪的行为......

# knockout.js - ko.dataFor() 是否适用于“选择”元素？

> ID：14968565
> 
> 赞同：0
> 
> 时间：2013-02-19T22:15:08.473
> 
> 标签：knockout.js

我试图`ko.dataFor()`在一个`select`元素上使用，但它返回了整个 ViewModel。我期望得到 selected 的对象`option`，但我总是得到 ViewModel 。我试过通过`select`and`option`但无论哪种方式我都会得到相同的结果。

[http://jsfiddle.net/LzAAB/3/](http://jsfiddle.net/LzAAB/3/)

```
<select id="companies" data-bind="options: companies, optionsText: 'name', optionsValue: 'id', optionsCaption: ' ' "></select>
<br/>
ko.DataFor(select)<br/>
<textarea id="a" cols="40" rows="10"></textarea>
<br/>
ko.DataFor(option)<br/>
<textarea id="b" cols="40" rows="10"></textarea>
<br/>
<div data-bind="text: ko.toJSON($root)"></div>

function MyViewModel() {
    var self = this;
    self.companies = ko.observableArray([{id:1, name: "Chevy"},{id:2, name: "Ford"}, {id:2, name: "Dodge"}]);
    self.countries = ko.observableArray([{id:1, name: "USA"},{id:2, name: "Canada"}, {id:2, name: "Mexico"}]);
}

var vm = new MyViewModel();

ko.applyBindings(vm);

$("#companies").change(function(){    
    $("#a").val("dataFor("+this.id+"):"+  ko.toJSON(ko.dataFor(this)));

    var selectedOption = $(this).find(":selected")[0];
    $("#b").val("dataFor("+this.id+"):"+  ko.toJSON(ko.dataFor(selectedOption)));
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T23:15:03.673

该`ko.dataFor()`函数为您提供的是元素绑定到的对象。如果您访问`$data`上下文变量，它与您的绑定将看到的对象相同。绑定生成的选项元素`options`使用相同的上下文，因此您不会看到任何差异。它仅与绑定上下文发生更改的绑定相关（例如，在 foreach 绑定中）。

* * *

如果您使用淘汰赛的功能来访问您想要的对象而不是依赖 jquery 会更好。创建一个 observable 并将值绑定到选择。然后，您可以使用所选值执行您想要的操作。

```
function MyViewModel() {
    var self = this;
    self.selectedCompany = ko.observable();
    self.companies = ko.observableArray(...);
    self.countries = ko.observableArray(...);
} 
```

```
<select id="companies"
        data-bind="value: selectedCompany,
                   options: companies,
                   optionsText: 'name',
                   optionsCaption: ' '">
</select>
<br/>
Selected<br/>
<textarea cols="40" rows="10" data-bind="text: ko.toJSON(selectedCompany)">
</textarea> 
```

[更新的小提琴](http://jsfiddle.net/jeff1203/z9ckd/)

# c++ - 引用和复制对象的返回类型

> ID：14968569
> 
> 赞同：0
> 
> 时间：2013-02-19T22:15:19.303
> 
> 标签：c++, string, copy

如果我从函数返回 std::string& 并且返回类型是赋值的右值，我会从 GCC 收到警告消息。这是因为通过引用传递不会正确复制吗？该错误表明我正在传递一个临时值，因为它很快就会从堆栈中删除。

这里有一些代码供您考虑：我要做什么有问题吗？

```
const std::string& TranslationTable::EnglishTranslate()
{
    return "end";
} 
```

内部主要：

```
std::string me;
me = EnglishTranslate(); 
```

返回的字符串的内容会正确复制到 中`me`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:18:06.577

`const char`由表示的数组`"end"`被转换为类型的临时对象`std::string`。那个临时的一`EnglishTranslate`回来就被销毁了。这会使返回的引用悬空，而不是指向有效的对象。

将返回的引用传递给复制赋值运算符`me`将导致未定义的行为（假设运算符被定义为执行它应该执行的操作）。

我建议改为按值返回：

```
std::string TranslationTable::EnglishTranslate()
{
    return "end";
} 
```

不要担心返回值的复制——编译器可以完全删除复制。

从函数返回引用的唯一真正常见用途是返回对数据成员的引用。与局部变量不同，数据成员不会在函数结束时被销毁。参见[`std::vector::operator[]`](http://en.cppreference.com/w/cpp/container/vector/operator_at)示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T22:21:18.070

> 我要做的事情有问题吗？

**是的。**

根据 C++11 标准的第 12.2/5 段：

> 临时绑定到函数返回语句 (6.6.3) 中的返回值的生命周期不会延长；**临时在 return 语句中的完整表达式结束时被销毁**。

因此，您的函数返回的引用是悬空的，并且在取消引用它时您有**未定义的行为。**

# php - 如何从 php 中的方法返回变量和数组？

> ID：14968570
> 
> 赞同：0
> 
> 时间：2013-02-19T22:15:36.413
> 
> 标签：php, arrays, variables, methods, return

php n00b 在这里：

我正在尝试从一副牌中挑选一张牌。

类实例是“$test_1”，函数“pick_card”是该类的方法。

我希望函数返回 1）我想要的卡片，以及 2）套牌，减去一张卡片。

我哪里错了？

```
$card, $deck = $test_1->pick_card($play_deck);

public function pick_card(&$deck)
{
    $card = $deck[0];
    echo "picked this card: " . $card . "<br />";
    array_splice($deck,0,0);
    return $card; $deck;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:24:04.033

你不能在 PHP 中返回两个这样的变量。我注意到您是通过`$deck`引用传递给函数的，因此您对该变量所做的任何修改都将在函数对其进行操作时反映在该变量中。

话虽这么说，因为这是一个类，你真的不应该传递一个变量，你真的应该有一个存储你的牌组的属性。我会建议这样的事情：

```
class card_deck {
    protected $deck = NULL;

    public function __construct() {
        // some logic to create, shuffle, and set deck array to $this->deck
    }

    public function pick_card() {
        if($this->get_card_count() < 1) {
            throw new Exception('The deck is empty.');
        }
        return array_shift($this->deck);
    }

    public function get_card_count() {
        return count($this->deck);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T22:26:59.827

您必须将其作为数组返回。您可以使用关联数组，也可以使用[list](http://php.net/manual/en/function.list.php)将数组拆分为如下变量：

```
list($card, $deck) = $test_1->pick_card($play_deck);

public function pick_card(&$deck)
{
    $card = $deck[0];
    echo "picked this card: " . $card . "<br />";
    array_splice($deck,0,0);
    return array($card, $deck);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T22:28:53.303

因为你有一个对象，你也可以使用`$this`

```
class card_deck {
  public $card;
  public $deck;
  public function pick_card(&$deck) {
    $this->card = $deck[0];
    $this->deck = $deck;
    echo "picked this card: " . $this->card . "<br />";
    array_splice($this->deck,0,0);
  }
}

$test_1 = new card_deck();
//set $play_deck 
$test_1->pick_card($play_deck);

// now use
$test_1->card;
$test_1->deck; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T22:23:09.757

您可以在关联数组中返回所需的值。我认为您熟悉数组，就像您在函数中使用`deck[0]`的那样`pick_card`：

```
class Foo{
    public function pick_card(&$deck){
        $card = $deck[0];
        echo "picked this card: " . $card . "<br />";
        array_splice($deck,0,0);
        return array('card'=>$card,'deck'=>$deck);
    }
}
$test_1 = new Foo;
$deck = $test_1->pick_card($play_deck);
echo 'Card: '.$deck['card'].'<br>';
echo 'Deck: '.$deck['deck']; 
```

# .htaccess - HTACCESS 301 Joomla 到 Wordpress

> ID：14968572
> 
> 赞同：0
> 
> 时间：2013-02-19T22:15:37.363
> 
> 标签：.htaccess

在 .htaccess 和 301 重定向方面需要一些帮助。

目前我在 Joomla 上的网站有以下格式的网址

```
http://www.example.com/indian/bombay-grill.html 
```

我正在迁移到 wordpress 平台，我选择的主题可以通过这种方式显示到 url

```
http://www.example.com/restaurants/indian/bombay-grill/ 
```

请注意在 url 中添加了“restaurants”和删除的“.html”。当然，这也适用于墨西哥、泰国、越南等。

我的 url 已经被索引并且排名很好，我担心改变结构会很糟糕。

有比使用 .htaccess 更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:26:01.190

超文本访问可以工作，但它并不总是可行的。

例如，如果您有其他包含两个段的路由（即不是`region/restaurant`），您会遇到问题：在使用通用的包罗万象规则时，您永远不想`about/overview.html`重定向到（只是一个示例）。`restaurants/about/overview/`

但是，如果该错误不适用于您的网站，那么您可以简单地使用：

```
RewriteRule ^([a-zA-Z-]+)/([a-zA-Z-]+).html$ restaurants/$1/$2 [R=301,L] 
```

尽管如此，如果您只有几条路线会发生冲突，那么您可以通过为每个路线指定格式来捕获上述全部内容之前的路线。这可能很乏味，但由于您网站的原始结构，有必要：

```
RewriteRule ^(about/overview)\.html$ $1 [L] 
```

或者，一个通用的包罗万象，前提是任何非餐厅页面只有一个段（即，路径中的任何地方都没有正斜杠）：

```
RewriteRule ^([a-zA-Z0-9\-])\.html$ $1 [L] 
```

# ios - Calling didReceiveRemoteNotification when app is launching for the first time

> ID：14968578
> 
> 赞同：24
> 
> 时间：2013-02-19T22:15:50.207
> 
> 标签：ios, objective-c, xcode, push-notification, apple-push-notifications

I have implemented my didReceiveRemoteNotification method. It works and displays a view controller with the notification data which is passed through. This only works when the app was already in the foreground or if it was running in the background. However, when the app is not running and the user clicks a notification, the app launches, but it appears as if no notification has been received. The notification is not written into the text file and the viewcontroller is not being pushed.

```
- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo
{
    if ( application.applicationState == UIApplicationStateActive)
    {
        NSDictionary *apsInfo = [userInfo objectForKey:@"aps"];

        NSString *alertMsg = @"";
        NSString *badge = @"";
        NSString *sound = @"";
        NSString *custom = @"";

        if( [apsInfo objectForKey:@"alert"] != NULL)
        {
            alertMsg = [apsInfo objectForKey:@"alert"];
        }

        if( [apsInfo objectForKey:@"badge"] != NULL)
        {
            badge = [apsInfo objectForKey:@"badge"];
        }

        if( [apsInfo objectForKey:@"sound"] != NULL)
        {
            sound = [apsInfo objectForKey:@"sound"];
        }

        if( [userInfo objectForKey:@"Type"] != NULL)
        {
            custom = [userInfo objectForKey:@"Type"];
        }

        // Set your appending text.
        NSString *textToAdd = [NSString stringWithFormat:@":%@", alertMsg];

        NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
        NSString *documentsDirectory = [paths objectAtIndex:0];
        NSString *fileName = [NSString stringWithFormat:@"%@/AccountNotifications.txt", documentsDirectory];
        NSString *fileContents = [[NSString alloc]  initWithContentsOfFile:fileName usedEncoding:nil error:nil];

        NSString *textToFile;

        if (fileContents == NULL)
        {
            textToFile = alertMsg;
        }

        // Here you append new text to the existing one
        if (fileContents != NULL)
        {
            textToFile = [fileContents stringByAppendingString:textToAdd];
        }

        // Here you save the updated text to that file
        paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
        documentsDirectory = [paths objectAtIndex:0];
        fileName = [NSString stringWithFormat:@"%@/AccountNotifications.txt", documentsDirectory];
        NSString *content = textToFile;
        [content writeToFile:fileName atomically:NO encoding:NSStringEncodingConversionAllowLossy error:nil];

        NSArray *fileData = [textToFile componentsSeparatedByString:@":"];

        NSMutableArray *tableDataFromFile;
        tableDataFromFile = [[NSMutableArray alloc] init];

        int i = 0;

        for (i = 1; i < [fileData count]; i++)
        {
            [tableDataFromFile addObject:fileData[i]];
        }

        NotificationViewController *vc = [[NotificationViewController alloc] initWithNibName:@"NotificationViewController" bundle:nil];
        vc.tableData = tableDataFromFile;

        UIViewController *root = self.mainNavController.topViewController;
        NSArray *vcs = [NSArray arrayWithObjects:root, vc, nil];
        [self.mainNavController setViewControllers:vcs animated:YES];
    }
        // app was already in the foreground
    else
    {
        while (done == FALSE)
        {

        }

        NSDictionary *apsInfo = [userInfo objectForKey:@"aps"];

        NSString *alertMsg = @"";
        NSString *badge = @"";
        NSString *sound = @"";
        NSString *custom = @"";

        if( [apsInfo objectForKey:@"alert"] != NULL)
        {
            alertMsg = [apsInfo objectForKey:@"alert"];
        }

        if( [apsInfo objectForKey:@"badge"] != NULL)
        {
            badge = [apsInfo objectForKey:@"badge"];
        }

        if( [apsInfo objectForKey:@"sound"] != NULL)
        {
            sound = [apsInfo objectForKey:@"sound"];
        }

        if( [userInfo objectForKey:@"Type"] != NULL)
        {
            custom = [userInfo objectForKey:@"Type"];
        }

        // Set your appending text.
        NSString *textToAdd = [NSString stringWithFormat:@":%@", alertMsg];

        NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
        NSString *documentsDirectory = [paths objectAtIndex:0];
        NSString *fileName = [NSString stringWithFormat:@"%@/AccountNotifications.txt", documentsDirectory];
        NSString *fileContents = [[NSString alloc]  initWithContentsOfFile:fileName usedEncoding:nil error:nil];

        NSString *textToFile;

        if (fileContents == NULL)
        {
            textToFile = alertMsg;
        }

        // Here you append new text to the existing one
        if (fileContents != NULL)
        {
            textToFile = [fileContents stringByAppendingString:textToAdd];
        }

        // Here you save the updated text to that file
        paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
        documentsDirectory = [paths objectAtIndex:0];
        fileName = [NSString stringWithFormat:@"%@/AccountNotifications.txt", documentsDirectory];
        NSString *content = textToFile;
        [content writeToFile:fileName atomically:NO encoding:NSStringEncodingConversionAllowLossy error:nil];

        NSArray *fileData = [textToFile componentsSeparatedByString:@":"];

        NSMutableArray *tableDataFromFile;
        tableDataFromFile = [[NSMutableArray alloc] init];

        int i = 0;

        for (i = 1; i < [fileData count]; i++)
        {
            [tableDataFromFile addObject:fileData[i]];
        }

        NotificationViewController *vc = [[NotificationViewController alloc] initWithNibName:@"NotificationViewController" bundle:nil];
        vc.tableData = tableDataFromFile;

        UIViewController *root = self.mainNavController.topViewController;
        NSArray *vcs = [NSArray arrayWithObjects:root, vc, nil];
        [self.mainNavController setViewControllers:vcs animated:YES];

    }
            // app was just brought from background to foreground

} 
```

Could someone please help me solve this problem? The boolean done is set to true once the didFinishLaunchingWithOptions is completed. I just want the notificationviewcontroller to open and display the notification if a notification is pressed while the app is not running at all.

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-02-19T22:30:33.050

你应该在你的代码中添加这样的东西：

```
 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary
    *)launchOptions {

        NSDictionary *remoteNotif = [launchOptions objectForKey: UIApplicationLaunchOptionsRemoteNotificationKey];

        //Accept push notification when app is not open
        if (remoteNotif) {      
            [self handleRemoteNotification:application userInfo:remoteNotif];
            return YES;
        }

        return YES;
    } 
```

您可以将逻辑从`didReceiveRemoteNotification`某个常用函数移至两个位置并调用该函数。这仅在用户通过点击通知打开应用程序时才有效。如果用户通过点击应用程序图标打开应用程序，通知数据将不会到达应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-08T06:56:28.917

SWIFT代码

```
let remoteNotif: AnyObject? = launchOptions?[UIApplicationLaunchOptionsRemoteNotificationKey]

            //Accept push notification when app is not open
            if ((remoteNotif) != nil) {

                self.handleRemoteNotification(remoteNotif!)
            }

func handleRemoteNotification(remoteNotif: AnyObject?){
//handle your notification here
} 
```

@Eran 谢谢 :)

# java - Eclipse Juno - Constant crash (805306369) when highlighting anything

> ID：14968580
> 
> 赞同：5
> 
> 时间：2013-02-19T22:15:54.543
> 
> 标签：java, eclipse-juno

Whenever I mouse over any imported.. anything in Juno, Eclipse immediately hangs.

Editing Java files - types, classes, annotations, the import itself - mousing over anything to view the javadoc will instantly hang eclipse.
Also happens with auto-completes if the popup stays open for more than a second.

Here's the error:
![Juno Error 805306369](../Images/8935eadc477d32d2668ad4d5e6ebd13b.png)

Running:

```
java version "1.7.0_15"
Java(TM) SE Runtime Environment (build 1.7.0_15-b03)
Java HotSpot(TM) 64-Bit Server VM (build 23.7-b01, mixed mode) 
```

The latest Eclipse Juno (Java EE) 64bit
Win7 x64.

There shouldn't be any incompatibilities there (All x64).

Looking around the proposed fixes are either related to Java 6, or say to delete `Mylyn`, which I've done but no fix.

This error happens consistently every single time.

Edit: And to make things more annoying, the log in the .metadata folder is empty.
I'm assuming I'm missing something obvious as the *exact same setup* on my other laptop works fine. And searching just gets me unreadable mailing lists, or bug trackers saying it's fixed - when clearly it's not in this case.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-10-16T04:08:59.523

在对所有事物进行了许多排列之后，包括所有不同的 JDK 等等等等 ..

这对我有用（Fedora19/64、ADT 4.3/SDK 22.x、OpenJDK 1.8、Opteron64）：将此行添加到`eclipse.ini`文件中

```
-Dorg.eclipse.swt.browser.DefaultType=mozilla 
```

显然，工具提示位会在不同时间以“冲突”启动不同的浏览器，但仅限于 mozilla 似乎只能解决问题

在这里找到它（[https://bugs.launchpad.net/ubuntu-gnome/+bug/1163501](https://bugs.launchpad.net/ubuntu-gnome/+bug/1163501)）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-06-08T14:21:23.793

**警告**：*下面描述的解决方案纠正了我电脑上的问题，但你的电脑上的问题可能不一样...... YMMV。*

因此，被指控的弹出窗口正在显示一个 HTML 片段。*此代码段是使用mshtml.dll*呈现的。

相同的*mshtml.dll*用于呈现 HTML 帮助文件（扩展*名为 .chm*的文件）。在我的计算机上，我发现我无法打开任何 HTML 帮助文件：HTML 帮助可执行文件 ( *hh.exe* ) 在启动时崩溃。

经过更多研究（我不会详细介绍搜索的所有细节），我的显示适配器（即 nVidia GeForce 540M）的驱动程序似乎有问题。它们已经过时，并且它们的安装可能已损坏。

更新驱动程序后，系统恢复正常：我可以再次打开 HTML 帮助文件，并且 Eclipse 在显示那些填充了 HTML 的小弹出窗口时不再崩溃！

因此，第一步是检查您是否可以正确打开 HTML 帮助文件。然后你应该检查你的显示适配器驱动程序安装...如果它不能解决你的问题，mshtml.dll文件崩溃的原因可能有很多，尝试使用mshtml.dll崩溃：这个崩溃可能会给你更多信息比日食残酷地退出时。

（请注意，损坏的驱动程序阻止了从 nVidia 下载的标准驱动程序安装程序包的执行。我不得不去设备管理器，打开我的显示适配器的属性，然后单击“更新驱动程序”按钮。一切顺利，并且自动，从那里）

（另请注意，我的系统运行的是 Windows 7 64 位）

# javascript - Determine a function object's parameter types

> ID：14968581
> 
> 赞同：-1
> 
> 时间：2013-02-19T22:15:55.420
> 
> 标签：javascript

I'm trying to find a way to determine a function objects parameters so that I can determine their respective types.

```
Params.prototype.getParams = function (fn) {
   var a = fn.length;
   console.log("Args: " + a);

   for (var i = 0; i < a; i++) {
      // This is where I want to print the type
      console.log("Arg[" + i + "] type is: " + typeof(fn.arguments[i]));
   }
} 
```

Then if I define a few functions (could be any JS functions), such as:

```
function callback1("one") {}
function callback2("one", 2) {}
function callback3(1, "two", []) {} 
```

If I later invoke each:

```
var params = new Params();

params.getParams(callback1);
params.getParams(callback2);
params.getParams(callback3); 
```

I would like to figure out each param type for each function instance. I've Google'd it, searched it on SO but can't find anything helpful. If it knows the 'length' I don't see why it wouldn't know the params also?

**Update - 2013.02.19 17:41**

Yes, I do know there are potential errors in the code above, I stripped it for simplicity of reading.

Here is what I was trying to accomplish:

I was reading this (interesting) article: [JavaScript Function Overloading](http://ejohn.org/blog/javascript-method-overloading/)

Coming from Java and being a purist, I wanted to start experiment with method overloading (damn I can't believe how primitive JS is).

I wanted to 'enhance' the example in the article by replacing the 'function count' methodology with one where the parameter types are used instead to 'resolve' which overloaded function should be invoked. It seems this is pretty much only doable by actually knowing the parameter types of 'fn' in my example.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T22:20:05.303

### 函数参数没有类型。

```
function fun(a,b,c) {... } 
```

在 JavaScript 中，任何变量或函数参数都可以包含任何类型的对象或原语。

唯一的方法是在运行时使用`arguments`

```
function callback3(a,b,c) {
    if (typeof a != 'string') {
      throw new Error('callback3 expects a string for its first argument');
    }
} 
```

由于看起来您想要进行类型检查，因此您可以使用类似的东西来抽象它

```
function checkParams(args, types) {
    if (args.length != types.length) {
        throw new Error('Invalid number of arguments passed');
    }
    for (var i=0; i < args.length; i ++) {
        if (typeof args[i] != types[i]) {
            throw new Error('Argument number '+ i +' has wrong type'); 
        }
    }
}

function callback3(a,b,c) {
    checkParams(arguments, ['string', 'number', 'object') );
    // rest of the code
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T01:08:26.603

函数参数没有类型，如果你想要类似重载的东西，你需要自己实现它。

使用它的最简单方法是重载一个 getter，而像 jQuery 一样的 setter 方法为其`val()`和许多其他功能所做。如果你不传递任何东西，它会检索值，如果你传递一些东西，它会设置一个值。我写的东西与 John Resig 的建议略有不同。这样，您将有两个示例可供查看。

重要的是您无法检索参数的类型，只能检索函数定义中声明了多少个参数。

```
function overload(/*fun1, fun2, fun3... */) {
    var overloadedFuns = arguments;
    return function() {
        var argCount = arguments.length;
        for (var i=0; i < overloadedFuns.length; i++) {
           if (overloadedFuns[i].length === argCount) {
               return overloadedFuns[i].apply(this, arguments);
               break;
           }
        }
    }
}

var obj = {
  _val = 0;
  val: overload(
      // This will get called when called with no arguments
      function() {
          return this._val;
      },
      // This will get called when called with one arguments
      function(val){
          this._val = val;
      }
  )
}

console.log( obj.val() ); // Outputs 0
obj.val(5); // Sets it to 5
console.log( obj.val() ); // Outputs 5 
```

可以引入类似的概念来添加类型。但是由于您无法从函数定义中推断出类型，因此您需要自己添加该信息

**示例：http:** [//jsfiddle.net/UPuwE/1/](http://jsfiddle.net/UPuwE/1/)

```
/**
 * @param {object[]} fnDefs, Each object should contain a paramList and a fn
 *  {paramMap: ["string"], fn: function() {myString}}
 *
 */
function overload(fnDefs) {

    function matches(arr1, arr2) {
        if (arr1.length !== arr2.length) {
            return false;
        }
        for (var i=0; i < arr1.length; i++) {
            if (arr1[i] !== arr2[i]) {
                return false;
            }
        }
        return true;
    }

    return function() {
        var types = [];
        for (var i =0; i < arguments.length; i++) {
            types.push(typeof arguments[i]);
        }
        for (var i=0; i < fnDefs.length; i++) {
            if (matches(types, fnDefs[i].paramMap)) {
                return fnDefs[i].fn.apply(this, arguments);
            }
        }
    }
}

var obj = {
    _val: 0,
    val: overload([
        {
            paramMap: ['string'],
            fn: function(str) {
                this._val = str;
            }
        },

        {
            paramMap: ['object'],
            // If an object is passed in, grab the string from its 
            // str property or by calling the toString() method;
            fn: function(obj) {
                this._val = obj.str || obj.toString();
            }
        },
        {
            paramMap: [],
            // Getter
            fn: function(obj) {
                return this._val;
            }
        }
    ])
};

obj.val('34');
console.log( obj.val() );

obj.val({str: '35'});
console.log( obj.val() );

obj.val( {toString: function(){return '36';} } );
console.log( obj.val() ); 
```

我希望这个例子告诉你运行时有很多开销，这就是大多数库不使用它的原因

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T22:17:04.983

Are you looking for the `arguments` variable?

```
function sayHi(name) {console.log(arguments)}

    sayHi('hackNightly')
>>> ['hackNightly'] 
```

It seems like if you had the arguments, you could just loop over them and use typeOf() or something similar to do type checking.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T22:28:46.420

我有一个小时的空闲时间，所以我想我会尝试实施我从“胡安门德斯”和“系统”收到的各种建议。

以下只是一个工作示例（未优化、未进行基准测试、未清理），因此请认为它正在进行中。在我做任何其他事情之前，我想运行一些基准测试，看看它最终会提供什么样的“膨胀”。

如果有人认为这有什么问题，请提供建设性的批评！

```
function Overload() {
    // Empty for now!
}

Overload.prototype.link = function (object, method) {   
    console.log("Creating dispatch method '" + method + "()'");

    object.prototype[method] = function () {
        var target = method + "_";

        console.log("Invoked dispatch method '" + method + "()'...");

        for (var i=0; i < arguments.length; i++) {
            target += (typeof arguments[i]).substring(0, 1);
        }

        console.log("Resolved target as '" + target + "'");

        if (typeof object.prototype._overloaded[target] !== "undefined") {
            console.log("Dispatching to overloaded method: '" + target + "'");
            return object.prototype._overloaded[target].apply(object, arguments);
        } else {
            console.log("Method not found: '" + method + "('" + target + "')'");
            //throw "Exception ...";
        }
    }
} 
```

以下函数将用于重载对象上的所有其他函数：

```
Overload.prototype.overload = function (object, method, fn, params) {
    var target = method + "_" + params;

    console.log("Overloading method '" + method + "()' to '" + method + "('" + params + "')'");

    if (typeof object === "undefined") {
        console.log("Object doesn't exist!");
    }

    if (typeof object.prototype[method] === "undefined") {
        this.link(object, method);
    }

    if (typeof object.prototype._overloaded === "undefined") {
        console.log("Creating '[obj].prototype._overloaded' property");
        object.prototype._overloaded = {};
    }

    if (typeof object.prototype._overloaded[target] === "undefined") {
        //console.log("Assigning overload function as target '" + method + "('" + params + "')'");
        object.prototype._overloaded[target] = fn;
    } else {
        console.log("Definition for '" + method + "('" + params + "')' already eixsts!");
    }

    return fn;
} 
```

现在定义一些本质上“模拟”重载函数的示例函数：

```
function fn1(one) {
    console.log("Invoked function 1: " + one);
}

function fn2(one, two) {
    console.log("Invoked function 2: " + one + ", " + two);
}

function fn3(one, two, three) {
    console.log("Invoked function 3: " + one + ", " + two + ", " + three);
}

function fn4(one, two, three) {
    console.log("Invoked function 4: " + one + ", " + two);
}

function fn5(one, two, three) {
    console.log("Invoked function 5: " + one + ", " + two);
} 
```

使用它来运行我们的测试：

```
function testMethodOverloading() {
    console.log("Testing method overloading!");

    var ov = new Overload();

    function OBJ() {}

    console.log("--");

    ov.overload(OBJ, "name", fn1, 's');
    ov.overload(OBJ, "name", fn2, 'sn');
    ov.overload(OBJ, "name", fn3, 'sns');
    ov.overload(OBJ, "name", fn4, 'ss');
    ov.overload(OBJ, "name", fn5, 'nn');

    console.log("--");

    var obj = new OBJ();

    obj.name("one");
    obj.name("two", 1);
    obj.name("three", 2, "four");
    obj.name("five", "six");
    obj.name(3, 4);
} 
```

这是我从上面运行测试得到的输出：

```
Overloading method 'name()' to 'name('s')'
Creating dispatch method 'name()'
Creating '[obj].prototype._overloaded' property
Overloading method 'name()' to 'name('sn')'
Overloading method 'name()' to 'name('sns')'
Overloading method 'name()' to 'name('ss')'
Overloading method 'name()' to 'name('nn')'
--
Invoked dispatch method 'name()'...
Resolved target as 'name_s'
Dispatching to overloaded method: 'name_s'
Invoked function 1: one
Invoked dispatch method 'name()'...
Resolved target as 'name_sn'
Dispatching to overloaded method: 'name_sn'
Invoked function 2: two, 1
Invoked dispatch method 'name()'...
Resolved target as 'name_sns'
Dispatching to overloaded method: 'name_sns'
Invoked function 3: three, 2, four
Invoked dispatch method 'name()'...
Resolved target as 'name_ss'
Dispatching to overloaded method: 'name_ss'
Invoked function 4: five, six
Invoked dispatch method 'name()'...
Resolved target as 'name_nn'
Dispatching to overloaded method: 'name_nn'
Invoked function 5: 3, 4 
```

所以它肯定会按照我的预期/想要的那样运行！但是它将获得什么样的基准。接下来我将这样做，看看我是否在引用文章的基准范围内（即在剥离所有日志记录之后）。一旦我有一个大致的想法，我会发布结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-19T22:20:24.570

函数对象不再存储它的参数，它们可以通过使用 var 直接在函数调用中使用`arguments`。

[http://www.sitepoint.com/arguments-a-javascript-oddity/](http://www.sitepoint.com/arguments-a-javascript-oddity/)

```
 //try this instead
  console.log("Arg[" + i + "] type is: " + typeof(arguments[i])); 
```

# wolfram-mathematica - Adding a Style to a Slider Control in Mathematica's Manipulate function

> ID：14968583
> 
> 赞同：1
> 
> 时间：2013-02-19T22:16:16.067
> 
> 标签：wolfram-mathematica

I would like to add a font style for the variable z in my Slider control below. In this toy manipulate example when the user changers the SetterBar or Slider values, the y slider is reset to y=0.1\. Of course I can wrap the z Slider control with Row[{Style["Z",Bold], {z, Slider ....}], but then I need to somehow suppress the appearance of z. Thanks in advance for any help.

Brian

```
Manipulate[
Module[{}, {x, y, z}], {x, 
SetterBar[Dynamic[x, (x = #; y = 0.1) &], {"A", "B", "C"}] &}, {z, 
Slider[Dynamic[z, (z = #; y = 0.1) &], {.1, 10}, 
Appearance -> "Labeled"] &},
{{y, 0.1, Style["Y", 14]}, 0.1, 5, Appearance -> "Labeled"}, 
Initialization :> ({x, z} = {"B", 1})] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T23:44:14.023

做我认为你要求的最简单的方法是使用`{{u, uinit, ulbl}, ...}`你已经在规范表单中使用的控制规范表单`y`。例如：

```
Manipulate[
 Module[{}, {x, y, z}],
 {x, SetterBar[Dynamic[x, (x = #; y = 0.1) &], {"A", "B", "C"}] &},
 {{z, .1, Style["Z", Darker@Green, Bold, 16, FontFamily -> Times]}, 
  Slider[Dynamic[z, (z = #; y = 0.1) &], {.1, 10}, 
    Appearance -> "Labeled"] &},
 {{y, 0.1, Style["Y", 14]}, 0.1, 5, Appearance -> "Labeled"},
 Initialization :> ({x, z} = {"B", 1})] 
```

如果您想避免这种情况，这不需要对您的表达进行太多重组...

# java - JSF CSV download in bean

> ID：14968593
> 
> 赞同：1
> 
> 时间：2013-02-19T22:16:50.223
> 
> 标签：java, jsf, csv, download

I am trying to do a csv download in the same fashion as here: [How to provide a file download from a JSF backing bean?](https://stackoverflow.com/questions/9391838/how-to-stream-a-file-download-in-a-jsf-backing-bean)

My response keeps throwing a `nullPointerException` at the `output.write()` line. The bean is of the request scope. Any thoughts as to the null pointer?

```
 try
    {
        //submitForm();
        FacesContext fc = FacesContext.getCurrentInstance();
        HttpServletResponse response = (HttpServletResponse) fc.getExternalContext().getResponse();

        response.reset();
        response.setContentType("text/csv"); 
        //response.setContentLength(contentLength); 
            response.setHeader ( "Content-disposition", "attachment; filename=\"Reporting-" + 
                    new Date().getTime() + ".csv\"" );

        OutputStream output = response.getOutputStream();
        String s = "\"Project #\",\"Project Name\",\"Product Feature(s)\",";
        s+="\"Project Status\",";
        s+="\"Install Type\",";
        s+="\"Beta Test\",\"Beta Test New/Updated\",";
        s+="\"Production\",\"Production New/Updated\",";
        s+="\n";
        InputStream is = new ByteArrayInputStream( s.getBytes("UTF-8") );
        int nextChar;

         while ((nextChar = is.read()) != -1) 
         {
            output.write(nextChar);
         }
         output.close();

    }
    catch ( IOException e )
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T00:28:11.083

3件事在这里跳出来

1.  几乎没有调用意味着 JSF 将`responseComplete()`继续`FacesContext`处理请求并且您不会影响结果。

2.  `reset()`通话是不必要的。

3.  输出流应该是类型`ServletOutputStream`

    请尝试以下代码段

    ```
    try
    {
    //submitForm();
    FacesContext fc = FacesContext.getCurrentInstance();
    HttpServletResponse response = (HttpServletResponse) fc.getExternalContext().getResponse();

    response.setContentType("text/csv"); 
    fc.responseComplete();
    //response.setContentLength(contentLength); 
        response.setHeader ( "Content-disposition", "attachment; filename=\"Reporting-" + 
                new Date().getTime() + ".csv\"" );

    ServletOutputStream output = response.getOutputStream();
    String s = "\"Project #\",\"Project Name\",\"Product Feature(s)\",";
    s+="\"Project Status\",";
    s+="\"Install Type\",";
    s+="\"Beta Test\",\"Beta Test New/Updated\",";
    s+="\"Production\",\"Production New/Updated\",";
    s+="\n";
    InputStream is = new ByteArrayInputStream( s.getBytes("UTF-8") );
    int nextChar;

     while ((nextChar = is.read()) != -1) 
     {
        output.write(nextChar);
     }
        output.flush();

     output.close();

    }
    catch ( IOException e )
    {
     // TODO Auto-generated catch block
        e.printStackTrace();
    } 
    ```

此外，您可以直接拨打电话`sos.println(s)`，而无需您在那里进行的所有工作

# android - 如何在 Android 中更改应用程序的主题？

> ID：14968595
> 
> 赞同：0
> 
> 时间：2013-02-19T22:16:51.840
> 
> 标签：android, android-xml, android-theme

我正在开发一个安卓应用程序。我想添加一个功能，让用户在运行时更改应用程序的主题。

我尝试在我的主要活动中使用以下语句。

```
setTheme(android.R.style.Theme_Black); 
```

但是，它只是将对话框更改为带有白色文本的黑色背景。

我该怎么做才能将所有组件的主题更改为黑色，包括操作栏和片段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:24:09.343

使用`Theme_Holo`代替`Theme_Black`，请记住，如果您希望所有内容都变黑，则需要创建自己的主题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:24:14.767

对于全局运行时更改，可以扩展[Application](http://developer.android.com/reference/android/app/Application.html)并设置主题（可能在.[`onCreate()`](http://developer.android.com/reference/android/app/Application.html#onCreate%28%29)[`setTheme()`](http://developer.android.com/reference/android/content/ContextWrapper.html)`ContextWrapper`

确保在清单中声明您的 Application 类：

```
<application
        android:name="com.yourpackage.ApplicationClass" >
</application> 
```

但是，由于通常不赞成扩展应用程序，我宁愿根据每个基础设置主题，因为活动比对象`Activity`更频繁地被销毁和重新创建。`Application`也许制作一个返回当前主题的静态方法`SharedPreferences`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T22:27:18.443

我建议阅读开发者文档[http://developer.android.com/guide/topics/ui/themes.html的样式和主题部分](http://developer.android.com/guide/topics/ui/themes.html)

您可以使用以下内容从清单中进行大量主题化：

```
<activity android:theme="@style/android:Theme.Dark"> 
```

# sql - Send data To SQL Server Through Socket

> ID：14968603
> 
> 赞同：0
> 
> 时间：2013-02-19T22:17:37.030
> 
> 标签：sql, sockets

I have been trying for days now to connect to my SQL Server through a socket. I can't find what is wrong.

I think I did a correct setup of my sql server, I am able to connect to it from ever the Server manager or Visual Studio with the same connection info that I am using in my Socket. It works everytime but with the socket. The socket can connect but when it send a string to the server, the SQL Server Logs gives me this: "length specified in netword packet payload did not match number of bytes read; the connection have been closed Error: 17836, Severity 20, State 17".

Here is the Socket code I use. It Took it from Microsoft Socket Server/client example:

```
#include "stdafx.h"

#include "ClientMFC.h"

#define WIN32_LEAN_AND_MEAN

#include <windows.h>
#include <winsock2.h>
#include <ws2tcpip.h>
#include <stdlib.h>
#include <stdio.h>

// Need to link with Ws2_32.lib, Mswsock.lib, and Advapi32.lib
#pragma comment (lib, "Ws2_32.lib")
#pragma comment (lib, "Mswsock.lib")
#pragma comment (lib, "AdvApi32.lib")

using namespace std;

int _tmain(int argc, TCHAR* argv[], TCHAR* envp[])
{
    int nRetCode = 0;

    HMODULE hModule = ::GetModuleHandle(NULL);

    if (hModule != NULL)
    {
        // initialize MFC and print and error on failure
        if (!AfxWinInit(hModule, NULL, ::GetCommandLine(), 0))
        {
            // TODO: change error code to suit your needs
            _tprintf(_T("Fatal Error: MFC initialization failed\n"));
            nRetCode = 1;
        }
        else
        {
            // TODO: code your application's behavior here.
        }
    }
    else
    {
        // TODO: change error code to suit your needs
        _tprintf(_T("Fatal Error: GetModuleHandle failed\n"));
        nRetCode = 1;
    }
    //WSADATA is a struct that is filled up by the call 
    //to WSAStartup
    WSADATA wsaData;

    //WSAStartup initializes the program for calling WinSock.
    //The first parameter specifies the highest version of the 
    //WinSock specification, the program is allowed to use.
    int wsaret=WSAStartup(0x101,&wsaData);

    //WSAStartup returns zero on success.
    //If it fails we exit.
    if(wsaret!=0)
    {
        return 0;
    }

    SOCKET ConnectSocket = INVALID_SOCKET;

    struct sockaddr_in dest_addr;   // will hold the destination addr  

    dest_addr.sin_family = AF_INET;          // host byte order
    dest_addr.sin_port = htons(2433);   // short, network byte order
    dest_addr.sin_addr.s_addr = inet_addr("10.100.17.114");
    memset(&(dest_addr.sin_zero), '\0', 8);  // zero the rest of the struct
    ConnectSocket = socket(AF_INET, SOCK_STREAM, 0); // do some error checking!

   // Connect to server.
    int iResult = connect( ConnectSocket, (struct sockaddr *)&dest_addr, sizeof(struct sockaddr));
    if (iResult == SOCKET_ERROR) {
        closesocket(ConnectSocket);
        ConnectSocket = INVALID_SOCKET;
    }

    const char *   toto   = "<connectionString>Data Source=10.100.17.114,2433;ENCRYPT=false;Initial Catalog=MetricsLocal;Persist Security Info=True;User ID=sa;Password=XXX</connectionString>";

    char *SendBuf = (char*)malloc(strlen(toto) * sizeof(char));
    // convert to network byte ordering. This is important for running on the ps3 and xenon
    for(INT BufIndex = 0; BufIndex < strlen(toto); ++BufIndex)
    {
        SendBuf[BufIndex] = toto[BufIndex];//htons(toto[BufIndex]);
    }

    int BytesSent           = send(ConnectSocket, SendBuf , strlen(SendBuf),0);

    printf("BytesSent = %d, Supposed = %d\n", BytesSent, strlen(toto));

    if (ConnectSocket == INVALID_SOCKET) {
        printf("Unable to connect to server!\n");
        WSACleanup();
        return 1;
    }

    return nRetCode;
} 
```

Note that I have hidden my password. This code should be really easy for you to try. Just add ws2_32.lib in your linker additional dependancies. I am really really stuck with this. I am pretty sure the size is correct. I also coded a Socket server to check what I receive and it seems correct. Ideas: - Do I need a header not described anywhere? -Do I have a special settings to do somewhere ? My telnet connection tells me my port is open and ready.<

Thank you for your help

# c++ - 在服务中模拟和加载用户配置文件后，环境变量是否会受到影响？

> ID：14968606
> 
> 赞同：5
> 
> 时间：2013-02-19T22:17:43.123
> 
> 标签：c++, winapi, service, environment-variables

我有一个在 LocalSystem 帐户下运行的 Windows 服务，我正在尝试访问一些特定于用户的环境变量。当我调用 ExpandEnvironmentStrings("%AppData%") 时，我得到“C:\windows\system32\config\systemprofile\AppData\Roaming”。

我认为模拟和加载用户配置文件应该可以解决这个问题，所以我打电话给：

*   登录用户（）
*   加载用户配置文件（）
*   创建环境块（）
*   ImpersonateLoggedOnUser()

而且，ExpandEnvironmentStrings("%AppData%") 返回系统文件夹，而不是像“C:\Users\Username\AppData\Roaming”这样的文件夹。

然后我又搜索了一些，发现了 SHGetFolderPath(CSIDL_LOCAL_APPDATA)，它就像一个魅力后模仿。

我的问题不是我应该做什么（即 SHGetFolderPath），而是更多关于环境变量如何在服务中工作的问题。我在想我的问题是：

1.  我的 LoadUserProfile() 代码仍然缺少一些东西，即使一切都返回成功。我无知的一面想让我相信，理论上，加载用户配置文件应该使 ExpandEnvironmentStrings() 返回加载的用户的值。

2.  根据一些读数，服务中的环境变量似乎在系统启动时只读取一次（[http://support.microsoft.com/kb/887693](http://support.microsoft.com/kb/887693)），所以我的服务只知道系统环境变量。

我倾向于 2。但我只需要有人来确认这一点，所以我不认为有什么可能是错误的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T22:27:42.830

[环境变量的文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682653%28v=vs.85%29.aspx)表明#2 是正确的。引用，重点补充：

> 每个**进程**都有一个环境块，其中包含一组环境变量及其值。

MSDN 指向[`ExpandEnvironmentStringForUser()`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762275%28v=vs.85%29.aspx)解决您原来的问题。

# windows - Perl Open multiple files and write to a single file side by side

> ID：14968609
> 
> 赞同：0
> 
> 时间：2013-02-19T22:17:53.657
> 
> 标签：windows, perl, concatenation

I am running a Perl script in windows ,which creates multiple text files with some info. I would like some help with a Perl script to put all the text file data into one file side by side. I know I could use nested `foreach` loop to parse through each file and print them side by side. But the number of files varies. For example:

Input:

`file1.txt`:

```
AAA
BBB
CCC 
```

`file2.txt`:

```
DDD
EEE
FFF 
```

Output:

```
AAA  DDD
BBB  EEE
CCC  FFF 
```

Thanks in advance

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T00:19:22.647

`paste`如果您没有设置滚动您自己的 perl 脚本，则linux 工具也提供此功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:24:12.003

关于什么 ：

```
open my $fh, ">", "concat.txt" or die $!;
my $string = qx(
    @echo off;
    type %*.txt;
);
print $fh $string; 
```

?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T00:08:12.417

这应该这样做。

```
use strict;
use warnings;
use IO::File;

my @files = (q[a.txt], q[b.txt]);

my @fhs = ();

foreach my $file (@files)
{
    my $fh = new IO::File $file, O_RDONLY;
    push @fhs, $fh if defined $fh;
}

while(1)
{
    my @lines = map { $_->getline } @fhs;

    last if grep { not defined $_ } @lines[0..(@fhs-1)];

    print join(qq[\t], map { s/[\r?\n]+/ /g; $_ } @lines) . qq[\r\n];
}

map { $_->close } @fhs; 
```

# javascript - Rounding to the nearest hundredth of a decimal in JavaScript

> ID：14968615
> 
> 赞同：16
> 
> 时间：2013-02-19T22:18:17.890
> 
> 标签：javascript, math, decimal

I'm doing simple math in JavaScript using variables to represent the numbers. Here is an example of my code:

```
var ones = 0;
var fives = 0;
function results (){
    _fives = (fives * 5);
    var res = (_fives + ones);
    document.innerHTML = res;
} 
```

This isn't the full code but basically I'm having the user enter the amount of bills and coins from 1 cent coins up to $100 bills. The code multiplies the amount of bills to the amount the bill is worth. This is no problem works just fine... For some reason on some of my results it shows a decimal like 1.899999999997 not sure how this is happening.

Is there a way to change this so it round to the nearest hundredth of a decimal?

For example instead of it showing 1.89999999997 it would just show 1.90 in reality this isn't a big issue. This is a personal thing that I can just round it myself however it would be nice to learn how to do this for future reference.

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-19T22:22:41.300

**更新**：MDN 实际上有一个[很好的小数舍入示例，可以避免浮点数不准确](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round#Decimal_rounding)。根据 OP，他们的方法可以修改为始终向上取整。

* * *

### 原始（有些不正确）答案

```
//to round to n decimal places
function round(num, places) {
    var multiplier = Math.pow(10, places);
    return Math.round(num * multiplier) / multiplier;
} 
```

**编辑**：我没有完全阅读这个问题。既然我们在谈论货币，我们可能想把它四舍五入：

```
//to round up to two decimal places
function money_round(num) {
    return Math.ceil(num * 100) / 100;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2020-03-26T14:43:31.563

这是我个人决定在我正在开发的应用程序之一中使用的！

```
const roundToHundredth = (value) => {
  return Number(value.toFixed(2));
};

console.log(roundToHundredth(1.98723232))
console.log(roundToHundredth(3.14159265359))
console.log(roundToHundredth(2.67528))
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-30T23:12:44.530

实际上，这种方法并非在所有情况下都有效。我正在做类似于将测量值四舍五入到一定位数的事情。

在我的情况下，我有一个测量的平均值和标准偏差，比如 0.20812345967 +/- 0.0031647859。现在显然额外的有效数字是没有意义的，所以我想把它写成 0.208 +/- 0.003。当我进行浮点数学运算时，我得到 0.20800000000000002 +/- 0.003

通常这会正确四舍五入，但因为以十进制为底的十进制数有时不能精确地存储为二进制，所以你会得到这样的废话。

相反，我将寻找一个字符串格式的解决方案

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-20T12:56:02.587

我知道这可能会迟到一天并且少了一美元，但我也在寻找类似的东西，这个问题让我研究了 Math.round 功能

我想出了这个，它成功地将给定值四舍五入到最接近的第 5 位，第 100 位。所以 0.07 变成 0.05。23.45 变为 23.45。1006.32 变为 1006.30。

```
<script>
function rounder() {
var exampleInput = $("#inputId").val();
$("#output").html(((Math.round(((Math.round(exampleInput*100)/5)*5)/5)*5)/100).toFixed(2));
}
</script> 
```

作为一个新手，我确信有办法让这段代码更有效率。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-23T00:54:26.050

实际上，我一直在处理这个问题，因为我一直在努力为我正在从事的向量项目实施舍入解决方案。实际上，我很惊讶这个较旧的（2011 年）[javascripter.net](http://www.javascripter.net/faq/rounding.htm)资源没有成功，尤其是在`Math.round( // ...`前面提到的使用中。

我已经添加了一些，也使用了`.toFixed()`（尽管这会去掉任何尾随的零，在这个阶段，我个人并不太担心）：

```
 const round = (number, places) => {
   let rounder = '1';

   for (let i = 0; i < places; i++) {
       rounder += '0';
   }

   return (Math.round(number * rounder) / rounder).toFixed(places);
}; 
```

我确信上述在效率或冗余方面存在一些问题；但我的观点是，它`Math.round()`仍然可以满足您的需要。在迭代之后，可能需要在上面进行转换。

它也比其他一些建议的解决方案更容易阅读。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-24T06:02:00.603

用于大小数的四舍五入工具。可以通过为“十进制”分配不同的值来调整以处理不同的小数大小。

```
const roundToWholeNumber = (num, decimal = 100000) => {

    const _roundingHelper = (val, decimalPlace) => {

        return Math.round(val * decimalPlace) / decimalPlace;

    }

    while(decimal > 1){
        num = _roundingHelper(num, decimal)
        decimal = decimal / 10
    }

    return Math.round(num)   
}
roundToWholeNumber(5.44444555) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-08-04T05:50:42.670

当您执行以下操作时，这是 JavaScript 的已知问题：

```
0.1 + 0.5 = 0.600000000001 or 0.599999999998 
```

此问题的解决方案是使用具有固定精度和舍入模式的 JavasSript 库之一。你可以试试诈骗链接。这是代码示例：

```
// Initialization
var bn = new BigNumbers({
    precision: 20, // fixed precision 20 digits after decimal separator 
    roundingMode: BigNumbers.RoundingMode.HALF_UP // rounding mode is Half Up
});

var number1 = bn.of('15');
var number2 = bn.of('12');

var divideResult = number1.divide(number2); // result "1.25"
var multiplyResult = divideResult.multiply(1/2); // result "0.625"
var roundingToTwoDecimalResult = multiplyResult.toPrecision(2); // result "0.63" 
```

*（提供的外部链接在被诈骗者破坏或黑客攻击后被删除 - 2020 年 10 月）*

# html-email - 电子邮件 NewsLetter 背景图片和圆角

> ID：14968618
> 
> 赞同：1
> 
> 时间：2013-02-19T22:18:30.330
> 
> 标签：html-email, newsletter

我正在编码`Email Templates`。给我的 Psd 就是要转换成电子邮件的模板是`rounded corners`有的和一些`background images`.
使用背景图像和图像制作圆角表好还是我应该用它 来`css`制作。`rounded corners``background images`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T16:19:16.447

使用图像作为角落。您不会让边界半径在所有客户端上正常工作。10x10 透明 .png 是最佳选择。我没有制作圆角图像，但您应该通过以下示例了解想法：

```
<table width="320" border="0" align="center" cellpadding="0" cellspacing="0" bgcolor="#959595">
  <tr>
    <td width="10" height="10" bgcolor="#ffffff">
      <img src="" style="display:block;">
    </td>
    <td width="100" height="10">
    </td>
    <td width="10" height="10" bgcolor="#ffffff">
      <img src="" style="display:block;">
    </td>    
  </tr>
  <tr>
    <td width="10">
    </td>
    <td width="300">
      Here is your content<br>...<br>...<br>...
    </td>
    <td width="10">
    </td>    
  </tr>
    <tr>
    <td width="10" height="10" bgcolor="#ffffff">
      <img src="" style="display:block;">
    </td>
    <td width="100" height="10">
    </td>
    <td width="10" height="10" bgcolor="#ffffff">
      <img src="" style="display:block;">
    </td>    
  </tr>
</table> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T17:07:19.830

**背景图片**

基本上，如果您需要对各种电子邮件阅读器的支持，则根本不能选择背景图像。它主要影响 Outlook 2007 及更高版本，以及 Hotmail（尚未测试 Outlook.com）。

如果 PSD 有大面积的背景图像，但上面没有文字，您可以将电子邮件的那部分剪切为前景图像。

如果同一区域有文字内容，有3个选项：

1.  完全跳过 bg 图像。
2.  使用内联 CSS 实现 bg 图像并以优雅降级为目标（接受电子邮件在某些电子邮件阅读器中看起来不太好）。
3.  将电子邮件的该部分剪切为单个前景图像（带有图像中的文本）。在图像中剪切文本的风险在于它会影响可用性（许多电子邮件阅读器默认阻止外部图像），它会损害可访问性，最重要的是，如果文本与图像的比率变得太低，则会触发垃圾邮件过滤器。因此，尽可能少地执行此操作（将文本剪切为图像）是一个好主意。但偶尔一点通常是安全的。

在选择选项 1 或 2 之前，您可能需要与设计团队确认。在进行大量选项 3 之前，明智的做法是在各种垃圾邮件过滤器中对其进行测试。

HTML 电子邮件中的 bg 图像的影响，以及尽量减少使用它们的需要，应该尽早并经常地传达给设计师，因为它的问题在他们之间不是常识，即使在他们中最好的人之间也是如此。

**圆角**

正如@samanthasquared 所提到的，电子邮件阅读器不太支持圆角。它们需要被实现为图像（或者，与背景图像一样，交替跳过它们或选择优雅降级，如果设计团队可以接受的话）。

如果您为整个顶部切割单个图像，为整个底部切割单个图像，而不是为每个单独的角切割单独的图像，您可以减少用户必须下载的图像总数。更少的图像意味着更快的加载和更少的触发垃圾邮件过滤器的风险。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T02:18:11.240

`border-radius`在电子邮件客户端中的支持非常差，虽然有更多支持，`background-image`但不会在 Outlook 2007+ 中显示。

见： http: [//www.campaignmonitor.com/css/](http://www.campaignmonitor.com/css/)

此外，为了获得最佳的跨客户端支持，您的所有 CSS 都必须是内联的，并且您应该使用`table`s.

# django - 如何使用 Django 打印完整模式？

> ID：14968621
> 
> 赞同：0
> 
> 时间：2013-02-19T22:18:50.730
> 
> 标签：django

我正在将我的 Django 应用程序移至异地 MySQL 服务器，但该应用程序将位于另一台机器上。

是否有要运行的命令可以打印我的应用程序的架构，以便我可以轻松地在新机器上开始使用？或者它不是那样工作的？

在写这篇文章时，我想到了——将 MySQL 凭据放在 Django 设置中并使用 sync.db 是最简单的事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:22:14.110

迁移架构的最佳方法是使用[South Migrations](http://south.aeracode.org/)。

通读非常简单的教程的第一部分，看看它是如何工作的：[http ://south.readthedocs.org/en/latest/tutorial/part1.html](http://south.readthedocs.org/en/latest/tutorial/part1.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:23:15.793

看一下[sqlall](https://docs.djangoproject.com/en/dev/ref/django-admin/#sqlall-appname-appname)命令，它将打印出您需要运行以在数据库服务器上创建模式的数据库命令。

或者，如果您的 settings.py 已经指向新数据库 - 您应该能够运行 syncdb 并以这种方式创建所有内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T22:29:56.607

我想你中了它。用于`dumpdata`在您的应用程序机器上转储数据，连接您的设置文件以连接到您的新数据库，`syncdb`然后`loaddata`.

# php - PHP Active Record 查找两个日期之间的行

> ID：14968624
> 
> 赞同：0
> 
> 时间：2013-02-19T22:18:59.587
> 
> 标签：php, activerecord

我刚刚开始使用 php 活动记录来选择 2 个日期之间的行，它似乎适用于某些测试，但在某些测试中它失败了，这就是我到目前为止所拥有的

```
$to = $_POST['to'];

$from = $_POST['from'];

$visitors = Visitors::find('all', array('conditions' => "visitdate >= '$from' AND visitdate <= '$to'")); 
```

是否有可用的 between 子句？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:25:49.070

您需要指定`visitdate`为 a`DATE`才能比较字符串。

```
$visitors = Visitors::find('all', array('conditions' => "DATE(visitdate) BETWEEN '$from' AND '$to'")); 
```

更多信息：http: [//dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#operator_between](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#operator_between)

# iphone - 在后台线程和 sizeWithFont 中执行 drawRect 使用 NSOperationQueue 崩溃应用程序

> ID：14968632
> 
> 赞同：2
> 
> 时间：2013-02-19T22:19:25.153
> 
> 标签：iphone, ios, objective-c, ipad

我在后台线程上调用 sizeWithFont，这个 sizeWithFont 位于 drawRect 上，它在后台线程上的 NSOperationQueue 上调用。我偶尔会在 sizeWithFont 上发生随机崩溃。我一直在谷歌搜索，似乎有人说这是苹果的问题。那么有什么更好的方法来解决这个问题呢？

从 iOS 4 开始，以下文档中说：

> 在 UIKit 中绘制到图形上下文现在是线程安全的。具体来说：用于访问和操作图形上下文的例程现在可以正确处理驻留在不同线程上的上下文。字符串和图像绘制现在是线程安全的。现在可以安全地在多个线程中使用颜色和字体对象。

我有这样的事情：

```
 titleSize = [storyTitleString sizeWithFont:[UIFont fontWithName:kProximaNovaBold size:15] constrainedToSize:CGSizeMake(200, kCellMaximumTitleHeight) lineBreakMode:UILineBreakModeWordWrap]; 
```

在我的drawRect中。你可以用你想要的任何字符串替换storyTitleString。而且我还使用[这个](https://github.com/mindsnacks/MSCachedAsyncViewDrawing)库在后台线程中执行绘图。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T22:22:31.327

UIKit 不是线程安全的，所以你不能在后台线程上调用任何东西，它会导致间歇性的错误。您最好的选择是在主线程上开始操作之前从 UIKit 计算您需要的所有内容，或者在操作运行期间切换到主线程，这取决于您要完成的工作。

# asp.net - 如何在asp.net中保留前一页的值

> ID：14968636
> 
> 赞同：2
> 
> 时间：2013-02-19T22:19:45.093
> 
> 标签：asp.net

我在 asp.net 网络表单中工作。我在一个表单中收集用户输入，比如 Page1，其中包含几个服务器控件，例如文本框、组合框和单选按钮。当用户单击保存按钮时，将显示一个新页面，例如 Page2，其中显示所有输入的值以供验证。Page2 在 Page1 的按钮点击事件中通过 Server.Transfer("~/Page2") 方法显示。在 Page2 中，用户输入的值是通过读取 PreviousPage 属性获得的，如下所示：

```
var memberData = PreviousPage.dependentData; 
```

Page2 有一个取消按钮。当用户发现一些数据输入错误并想返回 Page1 时，他们可以点击这个按钮。取消按钮单击事件在客户端运行以下代码：

```
if (confirm('Are you sure to leave this page?')) {
                window.history.back(1);
            } 
```

问题是，当达到 Page1 时，所有用户输入的值都消失了。请让我知道如何构建这两个页面，以便保留上一页 (Page1) 中的值。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:26:16.023

您必须将这些值保存在*某处*，以便两个页面都可以访问它们。大多数情况下，这是在数据库中完成的，但如果需要，您也可以使用[Session](http://msdn.microsoft.com/en-us/library/ms178581%28v=vs.100%29.aspx)、[Cache](http://msdn.microsoft.com/en-us/library/xsbfdd8c%28v=vs.100%29.aspx)甚至是[Cookie](http://msdn.microsoft.com/en-us/library/ms178194%28v=vs.100%29.aspx)。

由于这是特定于用户的，我怀疑 Session 是您最好的选择。创建一个简单的数据结构来匹配您的数据并将其保存到会话中：

```
public class UserData{
   public String Name {get; set;}
   public Int32 Age {get; set;}
} 
```

然后当用户提交页面时：

```
var userData = new UserData();
userData.Name = //Get from form;
userData.Age = //Get from form;

HttpContext.Current.Session["UserData"] = userData; 
```

然后在加载其他页面时：

```
var userData = HttpContext.Current.Session["UserData"] as UserData;

if(userData != null){
   //Do some stuff!
} 
```

现在...有一些注意事项请注意。例如，如果您在[负载均衡](http://en.wikipedia.org/wiki/Load_balancing_%28computing%29)器后面的多个服务器上运行它，那么您需要确保您使用的是粘性会话，或者至少是某种持久[会话提供者](http://msdn.microsoft.com/en-us/library/aa478952.aspx)。

我想我要说的是在将其添加到您的应用程序之前做一些功课:)

# sql - 带有 createQuery 的搜索引擎不起作用

> ID：14968639
> 
> 赞同：0
> 
> 时间：2013-02-19T22:19:52.067
> 
> 标签：sql, spring, hibernate, jpa, hibernate-entitymanager

我只想使用 JPA 编写一个简单的搜索引擎。以下是适用于 PHP 的本机 sql 请求示例：

```
"SELECT mobiles.brand, argus_waitings_mobiles_prices.mobile, argus_waitings_mobiles_prices.argus_buyer_id, "
                . "MATCH(mobile) AGAINST('$mobile_tags' IN BOOLEAN MODE) AS pertinence "
                . "FROM argus_waitings_mobiles_prices "
                . "WHERE argus_waitings_mobiles_prices.argus_buyer_id = $buyerId "
                . "ORDER BY pertinence DESC "
                . "LIMIT 10"); 
```

我想这样做，但它不起作用：

```
 @Override
    @SuppressWarnings("unchecked")
    @Transactional(readOnly=true)
    public List<Thread> findAllWithReferer(String referer) {
        EntityManager entityManager = EntityManagerUtil.createEntityManagerAndOpenTransaction();
        Query query = entityManager.createQuery("SELECT t "
            + "MATCH(t.title) AGAINST(:referer IN BOOLEAN MODE) AS pertinence "
            + "FROM Thread t MATCH(t.title) AGAINST(:referer IN BOOLEAN MODE)"
            + "ORDER BY pertinence DESC "
            + "LIMIT 10");

        return (query.getResultList());
    } 
```

这是错误消息的开头：

```
Caused by: org.hibernate.hql.internal.ast.QuerySyntaxException: unexpected token: MATCH near line 1, column 40 [SELECT t FROM fr.dorian.model.Thread t MATCH(t.title) AGAINST(:referer IN BOOLEAN MODE)] 
```

有人可以帮助我吗？
在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T09:01:40.667

`MATCH ... AGAINST`Hibernate 不支持。您将不得不修改您的查询或使用 SQL`entityManager.createSqlQuery(...)`

# python - 在 IPython 中默认启用漂亮的打印

> ID：14968651
> 
> 赞同：7
> 
> 时间：2013-02-19T22:20:33.907
> 
> 标签：python, ipython, pretty-print

如何在 IPython 中默认启用漂亮的打印？我无法在任何地方找到有关如何执行此操作的明确说明。非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-15T17:32:09.850

```
$ ipython help notebook | grep pprint -A1
--pprint
    Enable auto pretty printing of results.
--
--no-pprint
    Disable auto auto pretty printing of results.

$ ipython help console | grep pprint -A1
--pprint
    Enable auto pretty printing of results.
--
--no-pprint
    Disable auto auto pretty printing of results. 
```

# java - 如何在 Eclipse 项目中拥有 2 个同名文件但在 2 个不同的子文件夹中？

> ID：14968656
> 
> 赞同：0
> 
> 时间：2013-02-19T22:20:47.023
> 
> 标签：java, eclipse, subdirectory

现在我有这样的设置：

...\lab18\18a\18a.java

...\lab18\18a\monster.java

和

...\lab18\18b\18b.java

...\lab18\18b\monster.java

问题是 18a 和 18b 子文件夹中的 2 个“monster.java”文件，有没有办法保持这些名称相同但不会导致 18b、18c 等子文件夹中的“monster.java”出错文件夹？eclipse 指出的错误`Monster`是已经定义了引用 18a 文件夹中的 .java 文件。

这是我所指的屏幕截图： ![问题截图](../Images/62d48c44ba49f65c9038ad93520c87fa.png)

以下是 Windows 资源管理器中文件和文件夹组织方式的屏幕截图：![Windows 资源管理器屏幕截图](../Images/8d24181771a9060e356988fb4c57b54b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:39:41.483

相同的源文件夹，两个包：

![在此处输入图像描述](../Images/5ea5464d5106fff93b89bb8544081661.png)

* * *

Java 类中的包声明 ![在此处输入图像描述](../Images/be7e9052628c4108c029e2075527ecec.png)

-> 相同的项目，相同的源文件夹，不同的包，相同的类名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:34:42.897

您已将它们放入两个不同源文件夹中的同一个包（默认包）中。您能够拥有两个具有相同名称的类的唯一方法是它们位于不同的包中。

例如，对于lab18 one，将其放入名为lab 18a 的子文件夹中，并将lab18b 放入名为lab18b 的子文件夹中

```
lab18_oop_interfaces
  lab18a
    lab18a
      Lab18a.java
      Monster.java
  lab18b
    lab18b
      Lab18b.java
      Monster.java 
```

或者，将两个子文件夹放入一个 src 文件夹并将其标记为源文件夹：

```
lab18_oop_interfaces
  src
    lab18a
      Lab18a.java
      Monster.java
    lab18b
      Lab18b.java
      Monster.java 
```

# scala - 发布/订阅中的 Redis 插件阻塞

> ID：14968660
> 
> 赞同：2
> 
> 时间：2013-02-19T22:20:56.877
> 
> 标签：scala, playframework, redis, publish-subscribe, playframework-2.1

我正在尝试使用[Typesafe Redis Play plugin](https://github.com/typesafehub/play-plugins/tree/master/redis)连接到 Redis 以进行发布订阅。

我有以下测试场景，由每秒生成消息的参与者组成：

```
 // Initialization happens in Application.scala,
  private lazy val fakeStreamActor = Akka.system.actorOf(Props[FakeStreamActor])

  val actorPut = Akka.system.scheduler.schedule(
    Duration(1000, MILLISECONDS),
    Duration(1000, MILLISECONDS),
    fakeStreamActor,
    Put("This is a sample message")) 
```

演员来源：

```
class FakeStreamActor extends Actor {
  implicit val timeout = Timeout(1, SECONDS)

  val CHANNEL = "channel1"
  val plugin = Play.application.plugin(classOf[RedisPlugin]).get
  val listener = new MyListener()

  val pool = plugin.sedisPool

  pool.withJedisClient{ client =>
    client.subscribe(listener, CHANNEL)
  }

  def receive = {

    case Put(msg: String) => {
      //send data to Redis
      Logger.info("Push %s".format(msg))
      pool.withJedisClient { client =>
        client.publish(CHANNEL, msg)
      }

    }
  }
}

/** Messages */
case class Put(msg: String) 
```

还有一个订阅监听器：

```
case class MyListener() extends JedisPubSub {
  def onMessage(channel: String, message: String): Unit = {
    Logger.info("onMessage[%s, %s]".format(channel, message))
  }

  def onSubscribe(channel: String, subscribedChannels: Int): Unit = {
    Logger.info("onSubscribe[%s, %d]".format(channel, subscribedChannels))
  }

  def onUnsubscribe(channel: String, subscribedChannels: Int): Unit = {
    Logger.info("onUnsubscribe[%s, %d]".format(channel, subscribedChannels))
  }

  def onPSubscribe(pattern: String, subscribedChannels: Int): Unit = {
    Logger.info("onPSubscribe[%s, %d]".format(pattern, subscribedChannels))
  }

  def onPUnsubscribe(pattern: String, subscribedChannels: Int): Unit = {
    Logger.info("onPUnsubscribe[%s, %d]".format(pattern, subscribedChannels))
  }

  def onPMessage(pattern: String, channel: String, message: String): Unit = {
    Logger.info("onPMessage[%s, %s, %s]".format(pattern, channel, message))
  }
} 
```

现在，理想情况下，我应该订阅定义的频道并在日志中查看**监听器**如何每秒处理接收到的消息。但这不会发生，因为订阅的行为会锁定线程。

我的问题是：

有什么方法可以利用 Play 异步特性进行非阻塞订阅？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T19:02:24.573

是的。这就是我在 Global.scala 中的做法：

```
Akka.future { 
  val j = new RedisPlugin(app).jedisPool.getResource
  j.subscribe(PubSub, "*")
} 
```

我在实例化插件时遇到了麻烦，但是您实际上将 withJedisClient 位放在了 future 块中。

感谢您向我展示如何在 scala 中实例化插件！

# c++ - 如何使用 QLineEdit 使光标从其内容的开头开始？

> ID：14968663
> 
> 赞同：5
> 
> 时间：2013-02-19T22:21:01.037
> 
> 标签：c++, qt

Windows 7 SP1
MSVS 2010
Qt 4.8.4

这段代码：

```
#include <QTGui>

int main(int argc, char *argv[])
{
    QApplication app(argc, argv);
    QMainWindow*          window = new QMainWindow;
    QLineEdit*         line_edit = new QLineEdit;

    line_edit->setText("ABCDEFG");
    line_edit->setFixedSize(40,20);
    window->setCentralWidget(line_edit);
    window->show();
    return app.exec();
} 
```

显示这个：

![在此处输入图像描述](../Images/4a8cbff3efbdb0e38daab90e9435a862.png)

请注意，“AB”被截断，光标位于行编辑的末尾。

我希望它显示：

![在此处输入图像描述](../Images/8485aadf5e207e903deaa4fb15a0d176.png)

这里“FG”被截断，光标位于行编辑的开头。

我试图 setCursorPosition 和 cursorBackward 无济于事。如果我通过字体度量的 elidedText 转换文本，它将从开头显示尾随“...”。但我不想那样做。

问题：有没有办法让光标在显示 QLineEdit 后从其内容的开头开始？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T22:41:48.557

在设置文本之后将光标位置设置为 0 应该可以正常工作。至少它在 Linux，Qt 4.8.3 上是这样。

```
#include <QtGui>

int main(int argc, char *argv[])
{
    QApplication app(argc, argv);
    QMainWindow*          window = new QMainWindow;
    QVBoxLayout*          layout = new QVBoxLayout;
    QLineEdit*         line_edit = new QLineEdit;

    line_edit->setText("ABCDEFG");
    line_edit->setFixedSize(40,20);
    line_edit->setCursorPosition(0);
    layout->addWidget(line_edit);
    window->setCentralWidget(line_edit);
    window->show();
    return app.exec();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T22:41:31.777

[`setCursorPosition(0)`](http://qt-project.org/doc/qt-4.8/qlineedit.html#cursorPosition-prop)对我来说很好：

```
// ...
line_edit->setFixedSize(40,20);
line_edit->setCursorPosition(0);
// ... 
```

(Windows, VC++2010, Qt5.0.0)

# c# - 具有可变数量属性的实体的正确设计

> ID：14968666
> 
> 赞同：1
> 
> 时间：2013-02-19T22:21:11.837
> 
> 标签：c#, nhibernate, fluent-nhibernate

我正在实现一个自定义表单设计器。我现在到了我想将布局保存到数据库的地步。

### 技术限制

*   .NET 4.0
*   休眠
*   流畅的 NHibernate
*   MSSQL 2008 R2

这是我想出的一个设计：

## 控制表

*   Id int 身份
*   输入 varchar(300)

## 控制属性表

*   Id int 身份
*   ControlId int FK 到 Controls.ID
*   名称 varchar(300)
*   值 varchar(最大值)

## 控制类

```
public class Control
{
  public virtual int Id { get; set; }
  public virtual string Type { get; set; }
  public virtual Dictionary<string, string> Properties { get; set; }
} 
```

然后我会映射它，这样我就可以做这样的**事情**来重新加载布局：

```
var controls = GetListOfControlsUsingNHibernate();
foreach (var control in controls){
  var newControl = CreateControlFromType(control.Type);
  SetPropertiesViaTypeDescriptor(newControl, control.Properties);
  this.Controls.Add(newControl);
} 
```

我有两个问题。

1.  如何使用 Fluent NHibernate 映射这个？
2.  有没有更好的方法不涉及 EAV 并将所有值存储为字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T06:46:59.970

一些替代方法可以做到这一点。

一种解决方案是使用继承

```
public abstract class Control
{
    // ...
}
public class TextBox : Control
{
    public virtual string Text { get; set; }
}
public class MaskedTextBox : TextBox
{
    public virtual string Mask { get; set; }
} 
```

另一种是使用不同种类的属性

```
public class Control
{
  public virtual ISet<Property> Properties { get; set; }
} 
public abstract class Property
{
  public virtual string Name { get; set; }
}
public class IntProperty : Property
{
  public virtual int Value { get; set; }
}
public class DecimalProperty : Property
{
  public virtual decimal Value { get; set; }
}
// ... 
```

还有一个是使用接口

```
public abstract class Control
{
}
public class TextBox : Control, ITextControl
{
  public virtual string Text { get; set; }
}

public class ConcreteControlMap<T> : SubclassMap<T> where T : Control
{
  public ConcreteControlMap()
  {
    if(typeof(ITextControl).IsAssignableFrom(typeof(T)))
    {
      Map(c => ((ITextControl)c).Text);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T20:03:26.290

twitter 上的一个 bud 为我指出了使用 Fluent NHibernate 进行映射的正确方向：

首先创建一个表`Properties`来保存我们的属性：

```
╔═══════════╦══════════════╦═══════════════╗
║ ControlId ║ PropertyName ║ PropertyValue ║
╚═══════════╩══════════════╩═══════════════╝ 
```

现在像这样改变我们的映射：

```
public class ControlMap : ClassMap<Control>
{
    public ControlMap()
    {
        Table("Controls");
        Id(x => x.Id);
        Map(x => x.Type);
        HasMany(x => x.Properties).Table("ControlProperties")
            .AsMap<string>(index => index.Column("PropertyName").Type<string>(),
                           element => element.Column("PropertyValue").Type<string>())
            .Cascade.All(); 
    }
} 
```

有关这背后的 hbm xml 的一些背景信息，请参见 Ayende 的[NHibernate Mapping Map](http://ayende.com/blog/4045/nhibernate-mapping-map)。

# javascript - EmberJS 应用程序 - 结构等

> ID：14968673
> 
> 赞同：1
> 
> 时间：2013-02-19T22:21:29.103
> 
> 标签：javascript, model-view-controller, ember.js

在准备这个大型项目的过程中，我正在研究一些 JS MV* 框架，这些框架将被大约 10 名开发人员的团队使用。
首先我尝试了 AngularJS，因为它的性能看起来是所有框架中最好的（[SO 主题](https://stackoverflow.com/questions/11458436/angular-js-backbone-js-or-which-has-better-performance)）。它有一些像 DI 一样美好的未来，但我真的不喜欢使用它，因为对我来说它有点混乱的代码很难理解，我喜欢代码尽可能干净，结构良好且易于读。

目前我正在尝试 EmberJS，它看起来像 ember，对开发人员非常友好，并且很容易使用它。所以我写了一个小的“登录小部件”来看看 ember 应用程序应该如何构建。在开发过程中，我试图解决一些问题，如异步请求、动画等......

[提琴手](http://jsfiddle.net/VwgpV/1/)

“小部件”已经可以工作，并且可以完成我希望他做的所有事情，但在这一点上，我仍然有一些问题，我想听听经验丰富的 ember 开发人员关于当前代码结构、对象角色和问题的一些建议我可以稍后在使用 ember 时见面。

所以这里有一些问题：

1) Ember 视图很酷，但是如果我想让 ember 处理现有元素的动作和动画怎么办？我的意思是，例如我在服务器上呈现了链接（或通过 AJAX 接收到的 HTML），我如何绑定 ember 动作来处理它的点击动作并为它实例化我的自定义 LinkView？我确定我可以通过使用 jQuery 或其他东西“手动”绑定到 DOM 事件来找到解决方案，但是是否存在“Ember”方法来做到这一点？

2) 是否可以`StateManager`在进入初始状态之前设置属性，但不在类级别设置？

3）有人可以指点我如何使用的例子`Em.Deffered`吗？我做出了使用 jQuery 的承诺`$.Deferred()`，但我不想在我的`StateManager`.

4) 是否存在其他“Ember”方式来告诉框架在已经隐藏的状态下向 DOM 添加视图？我试图设置 isVisible: false，但它不起作用。

5) 是否存在其他方式然后再次添加隐藏视图，以解决错误“无法对不在 DOM 中的 Metamorph 执行操作。”？

以下是参考来源：

```
<script type="text/x-handlebars" data-template-name="GuestView">
        User: {{view Ember.TextField valueBinding='controller.username' placeholderBinding='controller.usernameHint'}}
        Pass: {{view Ember.TextField valueBinding='controller.password' placeholderBinding='controller.passwordHint' }}
        <br/>
        <button {{action login this}}>Login</button>
    </script>

<script type="text/x-handlebars" data-template-name="UserView">
        Hello {{ username }}
        <button {{action logout this}}>Logout</button>
    </script>

<script type="text/javascript">
        var App = Em.Application.create({
            authController: null,
            currentUserBinding: 'authController.content',

            ready: function () {
                this.set("authController", App.AuthController.create());
            }
        });

        App.AuthController = Em.ObjectController.extend({
            content: null,
            target: null,
            init: function () {
                this.set("content", this.getUserFromCookieOrDefault());

                //Is it possible in Ember, to set the controller before entering initial state,
                //but without setting it on Class level?
                this.set("target", App.AuthManager.reopen({ controller: this }).create({
                    //initialState: this.get("content").isAuthorized ? "authorized" : "guest"
                }));
                this.get("target").transitionTo(this.get("content").isAuthorized ? "authorized" : "guest");
            },

            doLogin: function (mgr, context) {
                console.log("logging in");

                //Validation, etc...
                //Imulating async Data loading, actually, it should be done with promises
                setTimeout(function () { mgr.transitionTo("authorized"); }, 1000);
            },

            doLogout: function (mgr, context) {
                console.log("logging out");

                //logout logic
                mgr.transitionTo("guest");
                this.set("content", App.Guest.create());
            },

            getUserFromCookieOrDefault: function () {
                return App.Guest.create();
                //return App.User.create({ username: "TestUser" });
            },
        });

        App.AuthManager = Em.StateManager.extend({
            controller: null,
            canTransist: true,

            // { data, commitCallback, abortCallback } 
            transitionTo: function (path, context) {
                var originalTransitionTo = this._super,
                    manager = this,
                    canTransist = "canTransist",
                    deffered = null,
                    originalTransitionToParams = context && (context.data || context.commitCallback || context.abortCallback) ?
                                                 context.data : context;

                if (!manager.get(canTransist)) {
                    Em.assert("Already in Transition");
                    return;
                }

                manager.set(canTransist, false);

                if (!manager.currentState) {
                    originalTransitionTo.apply(manager, [path, originalTransitionToParams]);
                    manager.set(canTransist, true);
                    return;
                }

                if (!manager.currentState.isAsyncExit) {
                    originalTransitionTo.apply(manager, [path, originalTransitionToParams]);
                    manager.set(canTransist, true);
                }
                else {

                    //How to use Em.Deffered?
                    deffered = $.Deferred();
                    deffered.done(commitTransition).fail(abortTransition);
                    manager.currentState.beforeExit(deffered, originalTransitionToParams);
                }

                function commitTransition() {
                    originalTransitionTo.apply(manager, [path, originalTransitionToParams]);
                    manager.set(canTransist, true);
                }

                function abortTransition() {
                    manager.set(canTransist, true);
                }
            },

            states: {
                guest: Em.State.create({
                    isAsyncExit: true,

                    enter: function (mgr) {
                        console.log("guest");

                        App.guestView = App.GuestView.create({
                            templateName: "GuestView",
                            controller: mgr.controller,
                        }).append();
                    },

                    beforeExit: function (promise, context) {
                        App.guestView.remove(promise);
                    },

                    login: function (mgr, context) {
                        mgr.controller.doLogin(mgr, context);
                    }
                }),

                authorized: Em.State.create({
                    isAsyncExit: true,

                    enter: function (mgr) {
                        console.log("authorized");

                        App.userView = App.UserView.create({
                            templateName: "UserView",
                            controller: mgr.controller,
                        }).append();
                    },

                    beforeExit: function (promise) {
                        App.userView.remove(promise);
                    },

                    logout: function (mgr, context) {
                        mgr.controller.doLogout(mgr, context);
                    }
                })
            }
        });

        App.FadingView = Em.View.extend({
            //Does exists other "Ember" way to tell framework to add view to DOM in already hidden state?
            //I tried to set isVisible: false, but it not works
            classNames: ['initialHidden'],

            didInsertElement: function () {

                //If using this.$().hide().show('slow') without 'initialHidden' class then view is still visible when alert shown
                //alert("View visible");
                this.$().hide().fadeIn(500).removeClass("initialHidden");

            },

            remove: function (promise) {

                var originalView = this,
                    originalViewElement = originalView.$(),
                    clonedView = originalView.$().clone(),
                    originalRemove = this._super;

                $(clonedView).attr("id", $(clonedView).attr("id") + "_clone").removeClass('ember-view');
                $("*", clonedView).removeClass('ember-view').remove("script[id^=metamorph]");
                originalView.$().replaceWith(clonedView);

                //This line exists, only because of Metamorph error:
                //Cannot perform operations on a Metamorph that is not in the DOM.
                $(originalViewElement).css("display", "none").appendTo("body");

                clonedView.fadeOut(1000, function () {
                    $(this).remove();
                    originalRemove.apply(originalView);
                    promise.resolve();
                });

            }
        });

        App.GuestView = App.FadingView.extend();
        App.UserView = App.FadingView.extend();

        App.User = Em.Object.extend({
            username: "",
            isAuthorized: true
        });

        App.Guest = Em.Object.extend({
            isAuthorized: false,
            password: "",
            usernameHint: "Username...",
            passwordHint: "Password..."
        });
    </script> 
```

# java-7 - java 7 可关闭的 PreparedStatement

> ID：14968674
> 
> 赞同：0
> 
> 时间：2013-02-19T22:21:30.630
> 
> 标签：java-7

谁能解释如何将以下代码转换为 JDK 7 风格的自动关闭？

```
PreparedStatement p = = conn.prepareStatement("INSERT INTO myTable(colName) VALUES(?)", Statement.RETURN_GENERATED_KEYS);
p.setObject(1, obj);
int r = p.executeUpdate();
ResultSet rs = p.getGeneratedKeys();
if (null != rs && rs.next()) {
activityInfoId = rs.getLong(1);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T17:08:22.843

很好地发现你不能在 try ( ... ) 中使用像 p.setObject(1,obj) 这样的语句

# c++ - glGetActiveUniformName 的意外行为

> ID：14968677
> 
> 赞同：3
> 
> 时间：2013-02-19T22:21:39.800
> 
> 标签：c++, opengl, opengl-3

glGetActiveUniformName 是一个函数，可用于根据**[文档](http://www.opengl.org/sdk/docs/man3/xhtml/glGetActiveUniformName.xml)**查询 GLSL 统一的名称长度。这可以通过将*uniformName*设置为 NULL (0) 并将*GLsizei*指针作为 out 变量提供给*length*来完成。执行此操作时，会期望在*长度*参数中返回制服名称的长度，但在调用上述函数后，此变量不变。给出的错误是 GL_INVALID_VALUE，根据文档，它可能意味着以下三种情况之一：

```
GL_INVALID_VALUE is generated if uniformIndex is greater than or equal to the value of GL_ACTIVE_UNIFORMS.

GL_INVALID_VALUE is generated if bufSize is negative.

GL_INVALID_VALUE is generated if program is not the name of a program object for which glLinkProgram has been issued. 
```

在我的情况下，*uniformIndex*为 0，GL_ACTIVE_UNIFORMS 报告为 5。*bufSize*故意设置为 0，因此不能为负数。在使用的程序上使用 GL_LINK_STATUS 调用 glGetProgram 会返回 GL_TRUE (1)。这排除了此错误的所有 3 个已知原因。根据 glGetError 在调用 glGetActiveUniformName 之前没有先前的错误，并使用有效的*bufSize*和*uniformName*调用它都成功且没有错误，并按预期写入*uniformName*中的缓冲区；正确书写制服的名称。

除了不报告制服名称的长度而犯错之外，还有其他令人不安的迹象；如果*bufSize*设置为大于零的正值并且*uniformName*保留为 NULL (0)，则该函数无论如何都会写入*uniformName*，这可能会导致严重的内存损坏。此行为不符合规范，该规范规定应*统一名称*为 NULL (0)，则不应向其写入任何内容。

将上面的所有信息放在一起，我想我可以有把握地得出结论，我的代码中没有错误，而是在我自己的代码之外的某个地方出现了错误，这就是我在这里发布的原因。如上所述使用时，是否有人可以验证此功能的行为？

我认为这很可能是一个驱动程序问题，这意味着只有运行 nVidia 驱动程序/硬件的人才能看到这个问题，但现在排除任何用户组还为时过早。

PS：上述情况发生在一台安装了 nVidia GeForce 660 GTX 并运行最新驱动程序（专门更新以验证上述声明）的机器上。该机器是运行 64 位 Windows 7 Professional SP1 的戴尔 XPS 8500。该程序是使用完全更新的 Visual Studio 2012 Professional 构建的。这篇文章也发布到了 nVidia 开发者论坛和 DevMaster 上，在这里发布是为了更好地曝光并希望更快地解决问题。

更新 1：有问题的代码在另一台具有不同 GPU（nVidia GeForce 9600M GT）的机器上进行了测试，再次使用最新的驱动程序并提供了相同的结果。本机运行 64 位 Windows 7 Ultimate SP1。再次使用 VS2012 构建二进制文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T23:34:14.270

这里的文档似乎是错误的。OpenGL规范在这里非常明确：`length`是针对实际写入缓冲区的字符数。此外，规范不需要对`uniformName`参数进行任何 NULL 检查。

或者，换一种说法，您不能使用`glGetActiveUniformName`来获取制服名称的*长度*。你必须这样做`glGetActiveUniform`。

我已经更正[了 wiki 上的文档](http://www.opengl.org/wiki/GLAPI/glGetActiveUniformName)。

# ajax - 在 Knockout.js foreach 之后刷新 iScrollView

> ID：14968678
> 
> 赞同：1
> 
> 时间：2013-02-19T22:21:42.157
> 
> 标签：ajax, cordova, jquery-mobile, knockout.js, iscroll

我正在使用 jQuery Mobile/Knockout.js/iScrollView 构建一个 Web 应用程序。我有一个使用 Knockout.js foreach 填写的列表。我发出一个 ajax 请求，我得到一个 JSON 对象，我将它推送到我的 observable 数组中，并且我的页面通过向我显示我需要的所有内容来更新。

现在我想使用 iScrollView 以便随着列表的增长，我可以顺利向下滚动并利用上拉或下拉功能。

我似乎无法弄清楚在`$(element).iscrollview('refresh')`正确的时间调用的正确方法，以便在添加更多项目后调整滚动窗口的大小。

有没有办法等到所有项目都插入到 DOM 中然后调用`$(element).iscrollview('refresh')`.

这是我的 HTML

```
<div data-role="page" id="List" data-bind="event: {pageshow: loadItems}">
      <div data-role="content" data-iscroll>
      <button value='load' data-bind="event: {click: loadItems}">load more stuff</button>
        <ul data-role="none" class="list" data-bind="foreach: items">
            <li style="visibility:hidden">
                <div class="header">
                    <h3 data-bind="text: name"></h3>
                    <p></p> 
                </div>
                <div class="feat-list-btn feat-list-action">
                    <img src="image.png" />
                </div>
                <div class="feat-list-btn feat-list-comments">
                    <img src="image.png" />
                </div>
                    <img data-bind="attr: {src: imageurl}" />
            </li>
        </ul>
      </div>
</div> 
```

这是我获取内容的方式：

```
function List(){
    var self = this;
    self.loadItems = function(){
        $('#List [data-role="content"]').fadeOut(0);
        $.mobile.showPageLoadingMsg();
            jQuery.ajax({
                url: mybackend.php',
                type: 'POST',
                data: 'howMany=10',
                dataType: 'jsonp',
                jsonp: 'jsoncallback',
                success: function(data, textStatus, jqXHR){
                        for (i=0;i<data.items.length;i++){
                            self.items.push(data.items[i]);
                            }   
                    },
                complete: function(){
                    $.mobile.hidePageLoadingMsg();
                    }
                });
        };
    self.items = ko.observableArray();
    self.updateScroller = function(){
        //????????
        };
    } 
```

我可以通过这样做来解决这个问题

```
setTimeout(function(){$('#List [data-role="content"]').iscrollview('refresh');}, 1000); 
```

但我宁愿不依赖 setTimeOut 来完成这样的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T11:08:45.400

只需插入这一行：

```
$('#List [data-role="content"]').iscrollview('refresh'); 
```

`for`在成功回调中循环后：

```
success: function(data, textStatus, jqXHR){
    for (i=0;i<data.items.length;i++){
        self.items.push(data.items[i]);
    }
    $('#List [data-role="content"]').iscrollview('refresh');
}, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T14:30:20.147

所以这比我想象的要简单得多，我意识到正在发生的事情是我的图像尚未加载到内存中，这意味着由 Knockout 生成的标记没有图像应该提供体积的地方。我放入了从本地来源获取的填充图像，但它们不一定具有正确的尺寸，并且我最终可能会得到不精确的滚动高度。

我尝试并最终完成的工作是在将图像添加到 ko.Observablearray 之前预加载图像。所以我把这个简单的图像预加载器写成一个 jQuery 插件：

```
(function($) {
    $.fn.preload = function( callback ) {           
        var count = 0,
            $this = this;
        for (i=0;i<this.length;i++){        
            var image = new Image();        
            $(image).on('load error', function(e){count++; if (count === $this.length){if ($.isFunction(callback)){callback.call()}}});
            image.src = this[i];;
            }
        }
    })(jQuery); 
```

这基本上可以让我等到我所有的图像都加载到内存中

然后我添加到我的 ko.Observablearray，它将我的标记与图像插入到位......然后像这样调用 REFRESH：

```
 success: function(data, textStatus, jqXHR){
            var myImages = [];
            for (i=0;i<data.urls.length;i++){
                myImages.push(data.urls[i]);
                }
                $(myImages).preload(function(){ //only execute insertion after all images are preloaded into memory
                    for (i=0;i<data.items.length;i++){
                        self.items.push(data.items[i]);
                        }   
                        $('#featList [data-role="content"]').iscrollview('refresh');//refresh iScroll
                        $.mobile.hidePageLoadingMsg(); 
                    });         
            }, 
```

比可能会优化一些，但它是一个有效的解决方案......

# c - C比较函数中的数组元素

> ID：14968683
> 
> 赞同：0
> 
> 时间：2013-02-19T22:21:55.547
> 
> 标签：c, arrays, function, int

这可能是一个非常基本的问题，但我对如何实现这样的事情感到困惑。

对于我正在上 CI 的课程，需要采用两个长度不同的数组，并在单独的函数中比较它们的元素。（此函数仅将数组作为参数，而不是它们的大小）两个数组中的任何元素我需要放入另一个数组并返回该数组（注意：每个数组就像一个集合，没有元素在同一个数组中重复）。我已经研究了如何实现这一点，这是我遇到的一些问题。

1.  我怎么知道数组的末端在哪里？

    我想我看到我可以将 {0} 作为数组中的一个元素来处理空元素。如果这是真的，我不知道我会将这个元素与什么进行比较以检查是否为空。

2.  我想我应该将指针传递给数组的第一个元素，因为我认为 C 不会让数组的值被传递，但有点不确定。

    如果我确实将数组作为指针传递，我如何访问数组元素以获取它们的数据？

3.  将数组返回给主函数时，如何在不清理内存的情况下返回结果函数？

    我应该将结果数组设为全局，还是有更好的处理方法？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:35:49.630

你的问题有点含糊。看起来您想要实现集合交集，其中您有两个集合，由数组表示，输出是另一个实现为数组的数组。

**1.我怎么知道数组的末尾在哪里？**

在 C 中，没有办法说出来。如果您不能将长度作为函数传递，那么您将无法做出稳健的解决方案。它需要类似于#2。

**2\. 我想我看到我可以将 {0} 作为数组中的一个元素来处理空元素。如果这是真的，我不知道我会将这个元素与什么进行比较以检查是否为空。**

您可以添加一个空字符，它只是值 0。要检查，您需要与 0 进行比较。我不知道您的每个数组元素由什么组成，但要注意的一件事是没有这些值不再允许为零，因为它被保留为数组标记的结尾。

**3\. 我认为我应该将指针传递给数组的第一个元素，因为我认为 C 不会让数组的值被传递，但有点不确定。**

是的。您将传递指向的第一个元素，它在 C 中是数组符号。

```
int A[10]; // pass A 
```

**4\. 如果我确实将数组作为指针传递，我如何访问数组元素以获取它们的数据？**

假设您传递了指针 A，您可以通过简单的索引为 A[i] 来访问元素，以获取元素 i。

**5\. 将数组返回给main函数时，如何在不清理内存的情况下返回结果函数？**

在您正在编写的函数中，您可以`malloc`创建一个数组并将指针传递给 malloc 创建的数组。函数退出时不会删除 Malloce 的内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:56:36.430

> 我怎么知道数组的末端在哪里？

如果您没有将数组的大小作为单独的参数（您应该是）传递，那么您将*不得不*使用某种标记值（C 字符串在字符串中的最后一个字符之后使用 0 的方式）。

> 我想我应该将指针传递给数组的第一个元素，因为我认为 C 不会让数组的值被传递，但有点不确定。

C 的数组语义有点棘手。除非它是`sizeof`, `_Alignof`, 或一元运算符的操作数`&`，或者是用于在声明中初始化数组的字符串文字，否则“N-element array of `T`”类型的表达式将转换为“pointer”类型的表达式到`T`"，表达式的值将是数组中第一个元素的地址。所以，给定代码

```
int arr1[10];

foo(arr1); // equivalent to foo(&arr1[0]); 
```

`arr1`调用中的表达式`foo`将从“10元素数组`int`”转换为“指针`int`”，接收的值`foo`是数组第一个元素的地址：

```
void foo(int *a)
{
  // do stuff with a[i]
} 
```

表达式`a[i]`被解释为`*(a + i)`; 我们找到后面的第`i`' 个元素的地址`a`并取消引用结果。

这是一种冗长的说法，您将`[]`在函数的参数上使用运算符，就好像它们是常规数组一样。

> 将数组返回给主函数时，如何在不清理内存的情况下返回结果函数？

不太清楚你在这里的意思。请注意，以下代码*将*不起作用：

```
int *foo(int *a1, int *a2)
{
  int a3[SOME_SIZE];

  // copy elements from a1 and a2 to a3;

  return a3;
} 
```

一旦`foo`退出，数组`a3`就不存在了；该内存被系统回收，因此您返回的指针值不再有效。你有三个选择：

首先，您可以将目标数组作为第三个参数传递：

```
int main(void)
{
  int arr1[N];
  int arr2[M];
  int arr3[K];
  ...
  foo(arr1, arr2, arr3);
  ...
}

void foo(int *a1, int *a2, int *result) { ... } 
```

前提是`result`指向一个足够大的数组以容纳您找到的所有元素（它应该与两个源数组中较大的一个一样大）。如果您不想搞乱动态内存管理，这就是要走的路。

其次，可以在函数中动态分配目标数组：

```
int main(void)
{
  int a1[M];
  int a2[N];
  int *a3;
  ...
  a3 = foo(a1, a2);
  ...
  free(a3);
}

int *foo(int *a1, int *a2)
{
  int *result = malloc(sizeof *result * SOME_SIZE);
  ...
  if (element_in_both_arrays())
    result[n++] = element_from_both_arrays();
  ...
  return result;
} 
```

完成后，您必须记住释放内存。

最后，您可以将目标数组声明为全局变量（即在文件范围内）。我不打算举一个例子，因为你不想那样做。

每当您将数组传递给函数或返回动态分配的缓冲区时，您确实需要将数组大小作为单独的参数传递。通常，仅根据指针值无法确定数组中有多少元素。您可以使用标记值，但它们只告诉您数组的*逻辑大小，而不是其**物理*大小。例如：

```
char buffer[1024] = "foo"; 
```

的*逻辑*大小`buffer`为 3（字符串的长度），但其*物理*大小为 1 KB。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T22:30:39.403

1.  要知道数组的长度，您需要将长度作为参数传递，或者您需要在数组中有一个特殊值，表示它是最后一项。

2.  如果你传递一个数组，你传递的是一个指向该数组的指针。如果不清楚，也许您应该包含一些代码。

3.  如果将数组传递给函数，则对数组所做的任何更改将对调用方法可见。没有必要返回任何东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T22:33:43.410

For 1：函数的调用者应该知道每个数组的长度。允许将此信息传递到函数中。您可以选择使用标记值来指示有效元素的结束，但您必须确保该函数的所有用户都知道此约定并遵循它。

对于 2：数组名称将降级为指针类型，其值为数组第一个元素的地址（在大多数情况下）。不需要做任何特别的事情来实现这一点。

对于 3：您可以让调用者提供一个指向将输出复制到其中的内存的指针。或者，一个数组可以由函数动态分配，但是调用者需要知道释放这个内存。

```
/* Finds elements common to both a and b, and copies them to c. The c out
   parameter is assumed to be at least as large as the smaller of the a_sz
   and b_sz. Returns the number of elements copied into c. */
int find_in_common (const int *a, size_t a_sz, const int *b, size_t b_sz,
                    int *c)
{
    /* ... */
} 
```

# php - PHP 中返回方法的最佳实践

> ID：14968685
> 
> 赞同：1
> 
> 时间：2013-02-19T22:22:06.617
> 
> 标签：php, design-patterns

在 PHP 中，哪些以及为什么是这种情况下的最佳实践：

```
class Main {
    public function getSomeBean() {
        ...
        return array(
            'value1' => $value1,
            'value2' => $value2
        );
    }
} 
```

或者

```
class SomeBean() {
    $value1;
    $value2;
}
class Main {
    public function getSomeBean() {
        $someBean = new SomeBean();
        ...
        return $someBean;
    }
} 
```

在 java 中，最佳实践总是使用 bean 类。但是在 PHP 中我总是看到返回数组，但在 Netbeans 中很难知道数组的键是什么，只阅读文档，有一个类更容易，但另一方面，提供了更多的工作。那么......最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:31:07.287

取决于您要返回的内容。如果拥有一个容器类（很像 C 结构）是有意义的，那么您可以选择它。如果要返回相同类型的数据，则应改为使用数组。

但是创建一个类只是为了旧的特定类型的返回值是没有意义的。您可以使用适当的构造函数和适当的方法创建一个完整的类，或者只使用`stdClass`.

那时使用`stdClass`or`array`作为容器并不重要。那里没有对错。例如，PDO 两者都提供，因为这取决于您和您的风格。

# angularjs - AngularJS 完成加载时发送事件

> ID：14968690
> 
> 赞同：117
> 
> 时间：2013-02-19T22:22:35.080
> 
> 标签：angularjs, angularjs-scope

想知道当所有指令都完成编译/链接时，检测页面加载/引导完成的最佳方法是什么。

有什么活动吗？我应该重载引导功能吗？

* * *

## 回答 #1

> 赞同：209
> 
> 时间：2014-05-18T01:57:45.030

只是一个预感：为什么不看看 ngCloak 指令是如何做到的呢？显然，ngCloak 指令会在加载后显示内容。我敢打赌看 ngCloak 会得出确切的答案……

**1 小时后编辑：** 好的，好吧，我查看了[ngCloak](https://github.com/angular/angular.js/blob/master/src/ng/directive/ngCloak.js)，它真的很短。这显然意味着编译函数在 {{template}} 表达式被评估（即它加载的模板）之前不会被执行，因此 ngCloak 指令的功能很好。

我有根据的猜测是只用与 ngCloak 相同的简单性制作一个指令，然后在你的编译函数中做你想做的任何事情。:) 将指令放在应用程序的根元素上。您可以调用类似 myOnload 的指令并将其用作属性 my-onload。一旦模板被编译（表达式评估和子模板加载），编译函数将执行。

**编辑，23 小时后：** 好的，所以我做了一些研究，我也[问了我自己的问题](https://stackoverflow.com/questions/23719622/why-does-the-link-function-of-my-directive-never-get-called)。我问的问题与这个问题间接相关，但它巧合地引导我找到解决这个问题的答案。

答案是您可以创建一个简单的指令并将代码放入指令的链接函数中，该函数（对于大多数用例，如下所述）将在您的元素准备好/加载时运行。根据[Josh 对编译和链接函数执行顺序的描述](https://groups.google.com/forum/#!msg/angular/bBgJ6Tb-mHo/PDSU76pNPtAJ)，

> 如果你有这个标记：
> 
> ```
> <div directive1>
>   <div directive2>
>     <!-- ... -->
>   </div>
> </div> 
> ```
> 
> 然后 AngularJS 将通过按特定顺序运行指令函数来创建指令：
> 
> ```
> directive1: compile
>   directive2: compile
> directive1: controller
> directive1: pre-link
>   directive2: controller
>   directive2: pre-link
>   directive2: post-link
> directive1: post-link 
> ```
> 
> 默认情况下，直接的“链接”函数是后链接，因此外部指令 1 的链接函数在内部指令 2 的链接函数运行之前不会运行。这就是为什么我们说只有在 post-link 中进行 DOM 操作才是安全的。因此，对于最初的问题，从外部指令的链接函数访问子指令的内部 html 应该没有问题，尽管必须编译动态插入的内容，如上所述。

由此我们可以得出结论，当一切准备就绪/编译/链接/加载时，我们可以简单地创建一个指令来执行我们的代码：

```
 app.directive('ngElementReady', [function() {
        return {
            priority: -1000, // a low number so this directive loads after all other directives have loaded. 
            restrict: "A", // attribute only
            link: function($scope, $element, $attributes) {
                console.log(" -- Element ready!");
                // do what you want here.
            }
        };
    }]); 
```

现在你可以做的是把 ngElementReady 指令放到应用程序的根元素上，`console.log`当它被加载时会触发：

```
<body data-ng-app="MyApp" data-ng-element-ready="">
   ...
   ...
</body> 
```

就是这么简单！只需制作一个简单的指令并使用它。;)

您可以进一步自定义它，以便它可以通过添加来执行表达式（即函数）`$scope.$eval($attributes.ngElementReady);`：

```
 app.directive('ngElementReady', [function() {
        return {
            priority: Number.MIN_SAFE_INTEGER, // execute last, after all other directives if any.
            restrict: "A",
            link: function($scope, $element, $attributes) {
                $scope.$eval($attributes.ngElementReady); // execute the expression in the attribute.
            }
        };
    }]); 
```

然后你可以在任何元素上使用它：

```
<body data-ng-app="MyApp" data-ng-controller="BodyCtrl" data-ng-element-ready="bodyIsReady()">
    ...
    <div data-ng-element-ready="divIsReady()">...<div>
</body> 
```

只需确保在元素所在的范围（在控制器中）中定义了函数（例如 bodyIsReady 和 divIsReady）。

警告：我说这适用于*大多数*情况。使用某些指令（如 ngRepeat 和 ngIf）时要小心。他们创建自己的范围，您的指令可能不会触发。例如，如果您将我们的新 ngElementReady 指令放在也具有 ngIf 的元素上，并且 ngIf 的条件评估为 false，那么我们的 ngElementReady 指令将不会被加载。或者，例如，如果您将我们的新 ngElementReady 指令放在也具有 ngInclude 指令的元素上，如果 ngInclude 的模板不存在，我们的指令将不会被加载。您可以通过确保嵌套指令而不是将它们全部放在同一个元素上来解决其中的一些问题。例如，通过这样做：

```
<div data-ng-element-ready="divIsReady()">
    <div data-ng-include="non-existent-template.html"></div>
<div> 
```

而不是这个：

```
<div data-ng-element-ready="divIsReady()" data-ng-include="non-existent-template.html"></div> 
```

ngElementReady 指令将在后面的示例中编译，但不会执行它的链接函数。注意：指令总是被编译，但它们的链接函数并不总是根据上面的某些场景执行。

**编辑，几分钟后：**

哦，为了完全回答这个问题，您现在可以从属性中执行的表达式`$emit`或`$broadcast`函数中获取事件。`ng-element-ready`:) 例如：

```
<div data-ng-element-ready="$emit('someEvent')">
    ...
<div> 
```

**编辑，几分钟后：**

@satchmorun 的答案也有效，但仅适用于初始加载。这是一个[非常有用的 SO 问题](https://stackoverflow.com/questions/20663076/angularjs-app-run-documentation)，它描述了执行的顺序，包括链接函数、`app.run`等等。因此，根据您的用例，`app.run`可能会很好，但不适用于特定元素，在这种情况下链接功能会更好。

**编辑，五个月后，10 月 17 日太平洋标准时间 8:11：**

这不适用于异步加载的部分。您需要将簿记添加到您的部分中（例如，一种方法是让每个部分跟踪其内容何时完成加载，然后发出一个事件，以便父范围可以计算已加载的部分数量并最终执行所需的操作在加载所有部分后执行）。

**编辑，太平洋标准时间 10 月 23 日晚上 10:52：**

我做了一个简单的指令，用于在加载图像时触发一些代码：

```
/*
 * This img directive makes it so that if you put a loaded="" attribute on any
 * img element in your app, the expression of that attribute will be evaluated
 * after the images has finished loading. Use this to, for example, remove
 * loading animations after images have finished loading.
 */
  app.directive('img', function() {
    return {
      restrict: 'E',
      link: function($scope, $element, $attributes) {
        $element.bind('load', function() {
          if ($attributes.loaded) {
            $scope.$eval($attributes.loaded);
          }
        });
      }
    };
  }); 
```

**编辑，太平洋标准时间 10 月 24 日上午 12:48：**

我改进了原始`ngElementReady`指令并将其重命名为`whenReady`.

```
/*
 * The whenReady directive allows you to execute the content of a when-ready
 * attribute after the element is ready (i.e. done loading all sub directives and DOM
 * content except for things that load asynchronously like partials and images).
 *
 * Execute multiple expressions by delimiting them with a semi-colon. If there
 * is more than one expression, and the last expression evaluates to true, then
 * all expressions prior will be evaluated after all text nodes in the element
 * have been interpolated (i.e. {{placeholders}} replaced with actual values). 
 *
 * Caveats: if other directives exists on the same element as this directive
 * and destroy the element thus preventing other directives from loading, using
 * this directive won't work. The optimal way to use this is to put this
 * directive on an outer element.
 */
app.directive('whenReady', ['$interpolate', function($interpolate) {
  return {
    restrict: 'A',
    priority: Number.MIN_SAFE_INTEGER, // execute last, after all other directives if any.
    link: function($scope, $element, $attributes) {
      var expressions = $attributes.whenReady.split(';');
      var waitForInterpolation = false;

      function evalExpressions(expressions) {
        expressions.forEach(function(expression) {
          $scope.$eval(expression);
        });
      }

      if ($attributes.whenReady.trim().length == 0) { return; }

      if (expressions.length > 1) {
        if ($scope.$eval(expressions.pop())) {
          waitForInterpolation = true;
        }
      }

      if (waitForInterpolation) {
        requestAnimationFrame(function checkIfInterpolated() {
          if ($element.text().indexOf($interpolate.startSymbol()) >= 0) { // if the text still has {{placeholders}}
            requestAnimationFrame(checkIfInterpolated);
          }
          else {
            evalExpressions(expressions);
          }
        });
      }
      else {
        evalExpressions(expressions);
      }
    }
  }
}]); 
```

例如，`someFunction`当一个元素被加载`{{placeholders}}`但尚未被替换时，像这样使用它来触发：

```
<div when-ready="someFunction()">
  <span ng-repeat="item in items">{{item.property}}</span>
</div> 
```

`someFunction`将在所有`item.property`占位符被替换之前调用。

评估尽可能多的表达式，并使最后一个表达式`true`等待`{{placeholders}}`被评估，如下所示：

```
<div when-ready="someFunction(); anotherFunction(); true">
  <span ng-repeat="item in items">{{item.property}}</span>
</div> 
```

`someFunction`并在被替换`anotherFunction`后被解雇。`{{placeholders}}`

这仅适用于第一次加载元素时，不适用于将来的更改。如果在最初替换占位符后继续发生，它可能无法按预期工作`$digest`（$digest 最多可能发生 10 次，直到数据停止更改）。它将适用于绝大多数用例。

***编辑，太平洋标准时间 10 月 31 日晚上 7:26：***

好吧，这可能是我最后一次也是最后一次更新了。这可能适用于 99.999 个用例：

```
/*
 * The whenReady directive allows you to execute the content of a when-ready
 * attribute after the element is ready (i.e. when it's done loading all sub directives and DOM
 * content). See: https://stackoverflow.com/questions/14968690/sending-event-when-angular-js-finished-loading
 *
 * Execute multiple expressions in the when-ready attribute by delimiting them
 * with a semi-colon. when-ready="doThis(); doThat()"
 *
 * Optional: If the value of a wait-for-interpolation attribute on the
 * element evaluates to true, then the expressions in when-ready will be
 * evaluated after all text nodes in the element have been interpolated (i.e.
 * {{placeholders}} have been replaced with actual values).
 *
 * Optional: Use a ready-check attribute to write an expression that
 * specifies what condition is true at any given moment in time when the
 * element is ready. The expression will be evaluated repeatedly until the
 * condition is finally true. The expression is executed with
 * requestAnimationFrame so that it fires at a moment when it is least likely
 * to block rendering of the page.
 *
 * If wait-for-interpolation and ready-check are both supplied, then the
 * when-ready expressions will fire after interpolation is done *and* after
 * the ready-check condition evaluates to true.
 *
 * Caveats: if other directives exists on the same element as this directive
 * and destroy the element thus preventing other directives from loading, using
 * this directive won't work. The optimal way to use this is to put this
 * directive on an outer element.
 */
app.directive('whenReady', ['$interpolate', function($interpolate) {
  return {
    restrict: 'A',
    priority: Number.MIN_SAFE_INTEGER, // execute last, after all other directives if any.
    link: function($scope, $element, $attributes) {
      var expressions = $attributes.whenReady.split(';');
      var waitForInterpolation = false;
      var hasReadyCheckExpression = false;

      function evalExpressions(expressions) {
        expressions.forEach(function(expression) {
          $scope.$eval(expression);
        });
      }

      if ($attributes.whenReady.trim().length === 0) { return; }

    if ($attributes.waitForInterpolation && $scope.$eval($attributes.waitForInterpolation)) {
        waitForInterpolation = true;
    }

      if ($attributes.readyCheck) {
        hasReadyCheckExpression = true;
      }

      if (waitForInterpolation || hasReadyCheckExpression) {
        requestAnimationFrame(function checkIfReady() {
          var isInterpolated = false;
          var isReadyCheckTrue = false;

          if (waitForInterpolation && $element.text().indexOf($interpolate.startSymbol()) >= 0) { // if the text still has {{placeholders}}
            isInterpolated = false;
          }
          else {
            isInterpolated = true;
          }

          if (hasReadyCheckExpression && !$scope.$eval($attributes.readyCheck)) { // if the ready check expression returns false
            isReadyCheckTrue = false;
          }
          else {
            isReadyCheckTrue = true;
          }

          if (isInterpolated && isReadyCheckTrue) { evalExpressions(expressions); }
          else { requestAnimationFrame(checkIfReady); }

        });
      }
      else {
        evalExpressions(expressions);
      }
    }
  };
}]); 
```

像这样使用它

```
<div when-ready="isReady()" ready-check="checkIfReady()" wait-for-interpolation="true">
   isReady will fire when this {{placeholder}} has been evaluated
   and when checkIfReady finally returns true. checkIfReady might
   contain code like `$('.some-element').length`.
</div> 
```

当然，它可能会被优化，但我就这样吧。[requestAnimationFrame](https://developer.mozilla.org/en-US/docs/Web/API/window.requestAnimationFrame)很好。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2013-02-19T22:27:55.493

在 的[文档中`angular.Module`](http://docs.angularjs.org/api/angular.Module)`run`，有一个描述该函数的条目：

> 使用此方法注册在注入器完成加载所有模块时应执行的工作。

因此，如果您有一些模块是您的应用程序：

```
var app = angular.module('app', [/* module dependencies */]); 
```

您可以在模块加载后运行东西：

```
app.run(function() {
  // Do post-load initialization stuff here
}); 
```

### 编辑：手动初始化救援

所以有人指出，`run`当 DOM 准备好并链接起来时，不会调用 。`$injector`当被引用的模块加载了它的所有依赖项时，它会被调用`ng-app`，这与 DOM 编译步骤是分开的。

我又看了看[手动初始化](http://docs.angularjs.org/guide/bootstrap)，看来这应该可以解决问题。

[我做了一个小提琴来说明](http://jsfiddle.net/FZcZ4/1/)。

HTML 很简单：

```
<html>
    <body>
        <test-directive>This is a test</test-directive>
    </body>
</html> 
```

请注意缺少`ng-app`. 我有一个指令会做一些 DOM 操作，所以我们可以确保事情的顺序和时间。

像往常一样，创建一个模块：

```
var app = angular.module('app', []); 
```

这是指令：

```
app.directive('testDirective', function() {
    return {
        restrict: 'E',
        template: '<div class="test-directive"><h1><div ng-transclude></div></h1></div>',
        replace: true,
        transclude: true,
        compile: function() {
            console.log("Compiling test-directive");
            return {
                pre: function() { console.log("Prelink"); },
                post: function() { console.log("Postlink"); }
            };
        }
    };
}); 
```

我们将用一个of class替换`test-directive`标签，并将其内容包装在一个.`div``test-directive``h1`

我添加了一个编译函数，它返回前链接函数和后链接函数，这样我们就可以看到这些东西何时运行。

这是其余的代码：

```
// The bootstrapping process

var body = document.getElementsByTagName('body')[0];

// Check that our directive hasn't been compiled

function howmany(classname) {
    return document.getElementsByClassName(classname).length;
} 
```

在我们做任何事情之前，`test-directive`在 DOM 中应该没有具有 class of 的元素，而在我们完成之后应该有 1。

```
console.log('before (should be 0):', howmany('test-directive'));

angular.element(document).ready(function() {
    // Bootstrap the body, which loades the specified modules
    // and compiled the DOM.
    angular.bootstrap(body, ['app']);

    // Our app is loaded and the DOM is compiled
    console.log('after (should be 1):', howmany('test-directive'));
}); 
```

这很简单。文档准备好后，`angular.bootstrap`使用应用程序的根元素和一组模块名称进行调用。

实际上，[如果您将`run`函数附加到`app`模块](http://jsfiddle.net/FZcZ4/2/)，您会看到它在任何编译发生之前运行。

如果您运行小提琴并观察控制台，您将看到以下内容：

```
before (should be 0): 0 
Compiling test-directive 
Prelink
Postlink
after (should be 1): 1 <--- success! 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-03-27T18:22:56.520

Angular 没有提供一种方法来指示页面何时完成加载，可能是因为**“完成”取决于您的应用程序**。例如，如果您有部分分层树，则一个加载其他部分。“完成”意味着所有这些都已加载。任何框架都很难分析您的代码并理解一切都已完成或仍在等待。为此，您必须提供特定于应用程序的逻辑来检查和确定。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2013-10-30T15:21:38.143

我想出了一个在评估角度初始化何时完成时相对准确的解决方案。

该指令是：

```
.directive('initialisation',['$rootScope',function($rootScope) {
            return {
                restrict: 'A',
                link: function($scope) {
                    var to;
                    var listener = $scope.$watch(function() {
                        clearTimeout(to);
                        to = setTimeout(function () {
                            console.log('initialised');
                            listener();
                            $rootScope.$broadcast('initialised');
                        }, 50);
                    });
                }
            };
        }]); 
```

然后可以将其作为属性添加到`body`元素中，然后监听使用`$scope.$on('initialised', fn)`

它的工作原理是假设应用程序在没有更多 $digest 循环时被初始化。$watch 在每个摘要周期都被调用，因此会启动一个计时器（setTimeout 不是 $timeout，因此不会触发新的摘要周期）。如果在超时时间内没有出现摘要循环，则假定应用程序已初始化。

它显然不如 satchmoruns 解决方案准确（因为消化周期可能比超时时间长），但我的解决方案不需要您跟踪模块，这使得管理更容易（尤其是对于大型项目）。无论如何，似乎对我的要求足够准确。希望能帮助到你。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2014-12-23T20:46:00.483

如果你使用[Angular UI Router](https://github.com/angular-ui/ui-router/wiki)，你可以监听`$viewContentLoaded`事件。

*“$viewContentLoaded - 在视图加载**后触发，在 DOM 渲染后**触发。视图的 '$scope' 会发出事件。” -[链接](https://github.com/angular-ui/ui-router/wiki#view-load-events)*

```
$scope.$on('$viewContentLoaded', 
function(event){ ... }); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-05-24T22:01:21.140

我用 JQuery 观察了 Angular 的 DOM 操作，我确实为我的应用程序设置了一个完成（某种预定义和令人满意的情况，我需要我的应用程序摘要），例如我希望我的 ng-repeater 产生 7 个结果，并且在那里为我为此目的，将在 setInterval 的帮助下设置一个观察函数。

```
$(document).ready(function(){

  var interval = setInterval(function(){

  if($("article").size() == 7){
     myFunction();
     clearInterval(interval);
  }

  },50);

}); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-07-31T14:17:03.063

如果您不使用[ngRoute](https://docs.angularjs.org/api/ngRoute)模块，即您没有[$viewContentLoaded](https://docs.angularjs.org/api/ngRoute/directive/ngView#$viewContentLoaded)事件。

您可以使用另一种指令方法：

```
 angular.module('someModule')
        .directive('someDirective', someDirective);

    someDirective.$inject = ['$rootScope', '$timeout']; //Inject services

    function someDirective($rootScope, $timeout){
        return {
            restrict: "A",
            priority: Number.MIN_SAFE_INTEGER, //Lowest priority
            link    : function(scope, element, attr){
                $timeout(
                    function(){
                        $rootScope.$emit("Some:event");
                    }
                );
            }
        };
    } 
```

因此，对于[trusktr 的回答](https://stackoverflow.com/a/23717845/3715524)，它的优先级最低。加上[$timeout](https://docs.angularjs.org/api/ng/service/$timeout)将导致 Angular 在回调执行之前运行整个事件循环。

[使用$rootScope](https://docs.angularjs.org/api/ng/service/$rootScope)，因为它允许在应用程序的任何范围内放置指令并仅通知必要的侦听器。

> $rootScope.$emit 将为所有 $rootScope.$on 监听器触发一个事件。有趣的部分是 $rootScope.$broadcast 将通知所有 $rootScope.$on 以及 $scope.$on 侦听器 [源](http://toddmotto.com/all-about-angulars-emit-broadcast-on-publish-subscribing/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-04-21T20:02:25.097

根据 Angular 团队和这个[Github 问题](https://github.com/angular/angular.js/issues/734)：

> 我们现在有分别在 ng-view 和 ng-include 中发出的 $viewContentLoaded 和 $includeContentLoaded 事件。我认为这与我们何时完成编译一样接近。

基于此，目前似乎**无法**以可靠的方式做到这一点，否则 Angular 会提供开箱即用的事件。

引导应用程序意味着在根范围上运行摘要周期，并且也没有摘要周期完成事件。

根据 Angular 2[设计文档](https://drive.google.com/folderview?id=0B7Ovm8bUYiUDR29iSkEyMk5pVUk&usp=drive_web&urp=https://angular.io/&pli=1&tid=0BxgtL8yFJbacUnUxc3l5aTZrbVk)：

> 由于有多个摘要，无法确定并通知组件模型是稳定的。这是因为通知可以进一步更改数据，从而重新启动绑定过程。

据此，这是不可能的事实是决定在 Angular 2 中进行重写的原因之一。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-12-03T00:56:40.713

我有一个片段在通过路由进入的主要部分之后/被加载。

我需要在加载该子部分后运行一个函数，我不想编写新指令并发现你可以使用厚脸皮`ngIf`

父部分的控制器：

```
$scope.subIsLoaded = function() { /*do stuff*/; return true; }; 
```

子部分的 HTML

```
<element ng-if="subIsLoaded()"><!-- more html --></element> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-08-27T09:05:09.383

如果您想使用服务器端数据（JSP、PHP）生成 JS，您可以将您的逻辑添加到服务中，该服务将在您的控制器加载时自动加载。

此外，如果您想在所有指令完成编译/链接时做出反应，您可以在初始化逻辑中添加上面提出的适当解决方案。

```
module.factory('YourControllerInitService', function() {

    // add your initialization logic here

    // return empty service, because it will not be used
    return {};
});

module.controller('YourController', function (YourControllerInitService) {
}); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-04-02T06:25:13.373

这些都是很好的解决方案，但是，如果您当前正在使用路由，那么我发现此解决方案是最简单且所需代码量最少的解决方案。在触发路由之前，使用 'resolve' 属性等待 Promise 完成。例如

```
$routeProvider
.when("/news", {
    templateUrl: "newsView.html",
    controller: "newsController",
    resolve: {
        message: function(messageService){
            return messageService.getMessage();
    }
} 
```

})

[单击此处获取完整文档 - 感谢 K. Scott Allen](http://odetocode.com/blogs/scott/archive/2014/05/20/using-resolve-in-angularjs-routes.aspx)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-08-13T13:45:33.623

也许我可以通过这个例子来帮助你

在自定义花式框中，我显示带有插值的内容。

在服务中，在“打开”fancybox 方法中，我愿意

```
open: function(html, $compile) {
        var el = angular.element(html);
     var compiledEl = $compile(el);
        $.fancybox.open(el); 
      } 
```

$compile 返回编译后的数据。你可以检查编译的数据

# google-drive-api - 使用 Google API Java 客户端库的可恢复媒体上传停止在 90%

> ID：14968694
> 
> 赞同：1
> 
> 时间：2013-02-19T22:22:59.390
> 
> 标签：google-drive-api, google-api-java-client

我尝试使用 Google API Java 客户端库启用“可恢复媒体上传”；

[http://code.google.com/p/google-api-java-client/wiki/MediaUpload](http://code.google.com/p/google-api-java-client/wiki/MediaUpload)

但是我的上传每次都在 90 en 100% 之间停止……有人知道出了什么问题吗？

# javascript - 如何在javascript中从画布制作gif

> ID：14968695
> 
> 赞同：0
> 
> 时间：2013-02-19T22:23:04.203
> 
> 标签：javascript, html, canvas, gif, animated-gif

我有一个每 2 秒更新一次的画布。
如何使用画布创建 gif 动画？

也许有一种方法可以将 getImageData 与每一帧合并来创建一个 GIF？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:39:41.320

您无法使用画布创建动画 Gif。

你可以做的是创建一个精灵——它的工作方式与 gif 非常相似。如果您询问是否可以将其保存到文件中，那么不能。精灵纯粹是为了显示在您的屏幕上。

# php - 使用 Codeigniter 将表中的一行与 MySQL 中其他两个表的多行连接起来

> ID：14968698
> 
> 赞同：0
> 
> 时间：2013-02-19T22:23:09.740
> 
> 标签：php, mysql, codeigniter, web-applications

我见过其他类似的问题，但没有一个对我想做的事情真正有帮助。

我有三张桌子；`sites`,`user_sites`和`site_domains`. 我想从`user_sites`和`site_domains`表中查询一个站点以及用户和域的列表。以下是表格示例：

数据库站点

```
+------+-------------+---------------------+--------------+
| id   | site_name   | site_options        | created_on   |
+------+-------------+---------------------+--------------+
| 1    | name1       | {serialized data}   | 10/10/12     |
+------+-------------+---------------------+--------------+
| 2    | name2       | {serialized data}   | 24/10/12     |
+------+-------------+---------------------+--------------+
| 3    | name3       | {serialized data}   | 08/09/12     |
+------+-------------+---------------------+--------------+
| 4    | name4       | {serialized data}   | 03/01/12     |
+------+-------------+---------------------+--------------+
| 5    | name5       | {serialized data}   | 10/12/11     |
+------+-------------+---------------------+--------------+ 
```

db.user_sites

```
+------+-----------+-----------+-----------+
| id   | user_id   | site_id   | default   |
+------+-----------+-----------+-----------+
| 1    | 1         | 1         | 0         |
+------+-----------+-----------+-----------+
| 2    | 3         | 2         | 0         |
+------+-----------+-----------+-----------+
| 3    | 1         | 3         | 0         |
+------+-----------+-----------+-----------+
| 4    | 10        | 1         | 0         |
+------+-----------+-----------+-----------+
| 5    | 5         | 1         | 1         |
+------+-----------+-----------+-----------+ 
```

db.site_domains

```
+------+-----------+-------------------+
| id   | site_id   | site_domain       |
+------+-----------+-------------------+
| 1    | 1         | www.domain1.com   |
+------+-----------+-------------------+
| 2    | 1         | sub.domain2.com   |
+------+-----------+-------------------+
| 3    | 3         | www.domain3.com   |
+------+-----------+-------------------+
| 4    | 2         | www.domain4.com   |
+------+-----------+-------------------+
| 5    | 3         | www.domain5.com   |
+------+-----------+-------------------+ 
```

当它完成时。我希望能够填充这样的对象：

```
array (
    [1] => array (
        [site_name]  => 'Name1',
        [created_on] => '10/10/12',
        [site_options]    => {serialized data},
        [domains]    => array (
                            [0] => 'www.domain1.com',
                            [1] => 'www.domain2.com'
                        ),
        [users]      => array (
                            [0] => 1,
                            [1] => 10,
                            [2] => 5
                        )
    ),
    [2] => array (
        [site_name] => 'Name2',
        [created_on] => '24/10/12',
        [site_options] => {serialized data},
        [domains]    => array (
                            [0] => 'www.domain4.com'
                        ),
        [users]      => array (
                            [0] => 3
                        )
    )
) 
```

....等等。

我正在使用 Codeigniter 创建我的应用程序，但如果我只知道它的 SQL，我可以将其转换为使用 Codeigniter。SQL 不是我最适合的，但任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T00:20:39.700

如果您使用 ActiveRecord，那么交叉表查询的语法非常简单：

```
$this->db->select('sites.site_name');
$this->db->from('sites');
$this->db->join('sites', 'sites.id = user_sites.user_id');
$data['query'] = $this->db->get(); 
```

显然这不是确切的查询，因为我不知道您要在数据之间寻找什么关系，但希望您能理解。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-20T00:28:26.980

我认为您将很难将其纳入一个查询。

我没有对此进行测试，但这样的事情可能会给你一些里程：

```
function get_site_data() {

    $sites = $this->db->get('sites')->result();

    foreach ($sites as &$row)
    {
       $row['domains'] = $this->get_domains_for_site($row->id);
       $row['users'] = $this->get_users_for_site($row->id);
    }

    return $sites;
}

function get_domains_for_site($site_id) {
    return $this->db->get_where("site_domains", array("site_id" => $site_id))->result();
}

function get_users_for_site($site_id) {
    return $this->db->get_where("user_sites", array("site_id" => $site_id))->result();
} 
```

# c++ - 链表 C++。插入、删除、搜索

> ID：14968703
> 
> 赞同：-2
> 
> 时间：2013-02-19T22:23:34.843
> 
> 标签：c++, search, linked-list

任何建议或指导都会非常棒......

```
 #include <iostream>
  #include <string.h>

  using namespace std;

 struct Book { 
char title[1024];       // Book name
int id;                 // Book id or ISBN number
float price;            // Book price
struct Book* next;
  } *COLLECTION = NULL;

//-- Forward Declaration --// 
void menu(); 
void branching(char option);
void insertion();
void printall();
struct Book* search(); 
void deletion();
void quit(struct Book* HEAD);

 int main()
 {
char ch; 

cout << "\n\nWelcome to CSE240: Bookstore\n";

do {
     menu();

     ch = tolower(getchar()); // read a char, convert to lower case
     cin.ignore();

     branching(ch);
} while (ch != 'q');

return 0; 
}

 void menu()
    {
cout << "\nMenu Options\n";
cout << "------------------------------------------------------\n";
cout << "i: Insert a book\n";
cout << "d: Delete a book\n";
cout << "s: Search a book\n";
cout << "p: Review your list\n"; 
cout << "q: Quit\n";
cout << "\n\nPlease enter a choice (i, d, s, p, or q) ---> "; 
 }

  void branching(char option)
 {
switch(option)
{
    case 'i':
        insertion();
    break;

    case 'd':
        deletion();
    break;

    case 's':
        search();
    break;

    case 'p':
        printall();
    break;

    case 'q':
        quit(COLLECTION);
        COLLECTION = NULL;
    break;

    default:
        cout << "\nError: Invalid Input.  Please try again..."; 
    break;
}
 }

  void insertion()
  {
// add code to insert a new book into the COLLECTION linked list.   
// HINT: You can insert a new book at the beginning of the linked list

 }

  struct Book* search() 
 {    
// add code to search for an existing book in the COLLECTION linked-list
// HINT: If no book matches the tile return a error messag

return NULL;
 }

 void deletion()
 {
// add code to the deletion method. You must call "delete" to remove the object    from the heap.
  }

  void printall()
  {
// Add code to print the book collection.  (HINT: You will need to use a loop.)

  }

  void quit(struct Book* HEAD)
  {
// Add code to delete the objects/books from the lniked-list.
// HINT: Refer to the slides in the homework assignment

   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:52:38.027

我会给你一个线索`insertion()`——假设你有一本书要插入

```
void insertion(Book* newBook)
{
  // The new book will be inserted at the beginning of the linked list,
  // with the original list following on from it
  newBook->next = COLLECTION;

  // The new beginning of the collection should be the new book
  COLLECTION = newBook;
} 
```

而对于`search()`- 假设您正在搜索具有特定 ID 的书

```
Book* search(int id) 
{
  Book* current = COLLECTION;

  while(current != NULL)
  {
    if(current->id == id)
    {
      // Found it
      return current;
    }

    // Try the next book in the list
    current = current->next;
  }

  // Reached the end, but still could not find the book you are looking for
  return NULL;
} 
```

# video - Starling(Stage3d) 仅播放视频的性能优势

> ID：14968707
> 
> 赞同：1
> 
> 时间：2013-02-19T22:23:46.927
> 
> 标签：video, starling-framework

我正在构建一个播放高清视频的 AIR 桌面应用程序。
由于桌面版 AIR 不支持 StageVideo，我仍然想知道使用 Starling(Stage3D) 代替常规显示列表来渲染和播放视频是否有任何性能优势？

# git - 带有私有和公共分支的 Git 存储

> ID：14968710
> 
> 赞同：0
> 
> 时间：2013-02-19T22:23:55.577
> 
> 标签：git, github, bitbucket

我想建立一个存储库（bitbucket / github / ...），我可以在其中为开发人员提供私有 Git 存储库，但也可以公开访问发布。哪个服务提供这个？
在 Sourceforge 上一切都是公开的，在 Bitbucket 中似乎一切都是私有的或公开的。

您推荐哪种服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:26:54.310

我不确定你的目标是什么，但这没有多大意义。一旦你将你的私有分支合并到公共分支中，私有分支中的每一个提交到新的提示都将不可避免地变成公共的。如果您只是不想在发布之前维护隐私，您可以拥有“全部私有或全部公开的所有内容”，并且只将您的私有分支推送到该存储库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:27:02.767

Github 以合理的价格提供免费的公共回购和私人回购。您可以确定何时创建存储库是公共的还是私有的。

帐户上的公共回购没有限制，但是随着您添加私人回购，它们的成本会增加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T10:54:01.873

如果您不想为 github 中的私人仓库支付任何费用，您可以设置两个不同的远程仓库。

[使用gitlab](http://gitlab.org/)或[gitolite](https://github.com/sitaramc/gitolite)的个人服务器上的私有服务器和 github / bitbucket 上的公共服务器。

发布分支将 github / bitbucket 作为远程仓库：

```
git remote add release github:user/repo 
```

具有私有访问权限的开发分支：

```
git remote add develop server:/path/to/repo 
```

要推送到特定的远程分支，只需键入

```
git push release / develop 
```

# ruby-on-rails - 很棒的打印一个 Ruby 哈希

> ID：14968712
> 
> 赞同：0
> 
> 时间：2013-02-19T22:24:06.497
> 
> 标签：ruby-on-rails, output, awesomeprint

我正在尝试输出一个哈希，它是调用 Flickr 的 collection.getTree 方法的结果。

我有：

```
ap @flickr_collections 
```

它正在打印出散列，但周围有所有转义的 html 标签。我该如何解决这个问题。我确实尝试过`.html_safe`，但没有奏效。

基本上我想要的只是这个哈希的漂亮打印输出。不多不少。

更新：

这就是我正在运行的：`= ap(@flickr_collections, html: true)`

输出是：

```
<pre class="debug_dump">{ <pre>&quot;collections&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre>{ <pre>&quot;collection&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre>[ <kbd style="color:white">[0] </kbd><pre>{ <pre>&quot;set&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre>[ <kbd style="color:white">[0] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629511800621&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;On-Ride Photography&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[1] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629391565747&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;First Day with Flash, Rocket &amp; Piper&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre> ]</pre>, <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;57928212-72157629836236274&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Misc&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre>, <pre>&quot;iconlarge&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;/images/collection_default_l.gif&quot;</kbd></pre>, <pre>&quot;iconsmall&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;/images/collection_default_s.gif&quot;</kbd></pre> }</pre>, <kbd style="color:white">[1] </kbd><pre>{ <pre>&quot;collection&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre>[ <kbd style="color:white">[0] </kbd><pre>{ <pre>&quot;set&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre>[ <kbd style="color:white">[ 0] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629683535562&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 1 - Hollywood Tour and Santa Monica Pier&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 1] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629683541696&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 2 - Drive to Bay Area&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 2] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629683554852&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 3 - Six Flags Discovery Kingdom&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 3] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629710465912&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 4 - Gilroy Gardens &amp; Santa Cruz Beach Boardwalk&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 4] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629710474644&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 5 - California's Great America &amp; Long Drive South&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 5] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629710489442&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 6 - Six Flags Magic Mountain&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 6] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629834618028&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 7 - Universal Studios Hollywood &amp; Scandia Amusement Park &amp; John's Incredible Pizza&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 7] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629834637138&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 8 - Sea World San Diego &amp; Belmont Park&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 8] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629836419418&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 9 - Legoland California &amp; Castle Amusement Park&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 9] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629851123596&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 10 - Knott's Berry Farm &amp; Adventure City&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[10] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629851700916&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 11 &amp; 12 - Disneyland Resort&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[11] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629851713058&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 13,14 &amp; 15 - Las Vegas&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre> ]</pre>, <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;57928212-72157629691182748&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;West Coast Tour 2009&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre>, <pre>&quot;iconlarge&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;/images/collection_default_l.gif&quot;</kbd></pre>, <pre>&quot;iconsmall&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;/images/collection_default_s.gif&quot;</kbd></pre> }</pre>, <kbd style="color:white">[1] </kbd><pre>{ <pre>&quot;set&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre>[ <kbd style="color:white">[ 0] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629866337538&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 0 - Arrival and Mall of America&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 1] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629868655454&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 1 - Mall of America&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 2] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629970737598&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 2 - Adventureland and Worlds of Fun&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 3] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157630011649024&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 3 - Worlds of Fun&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 4] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157630034790528&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 4 - Silver Dollar City&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 5] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157630035520246&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 5 - St Louis Arch and City Museum&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 6] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157630043090072&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 6 - Six Flags St Louis&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 7] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157630043098290&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 7 - Holiday World&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 8] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157630048416804&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 8 - Indiana Beach&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 9] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157630048431390&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 9 - Six Flags Great America&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[10] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157629997482351&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 10 - Mount Olympus, Timber Falls and Knuckleheads&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[11] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157630059600702&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 11 - Valleyfair&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre> ]</pre>, <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;57928212-72157629866347760&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Middle America Tour 2010&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre>, <pre>&quot;iconlarge&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;/images/collection_default_l.gif&quot;</kbd></pre>, <pre>&quot;iconsmall&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;/images/collection_default_s.gif&quot;</kbd></pre> }</pre>, <kbd style="color:white">[2] </kbd><pre>{ <pre>&quot;set&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre>[ <kbd style="color:white">[0] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157631693409808&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 1 - Great Wall of China, Tiananmen Square, Forbidden City&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[1] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157630657898798&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 1 - Carowinds&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[2] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157630692436584&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 2 - Dollywood&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[3] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157630699845912&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 3 - Random Pigeon Forge Activities&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[4] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157630714758818&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 4 - Long Drive to Williamsburg&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[5] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157630717785454&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 5 - Busch Gardens Williamsburg&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[6] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157630717785576&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 6 - Kings Dominion&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre> ]</pre>, <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;57928212-72157630658165668&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;IntimidaTOUR 2010&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre>, <pre>&quot;iconlarge&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;/images/collection_default_l.gif&quot;</kbd></pre>, <pre>&quot;iconsmall&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;/images/collection_default_s.gif&quot;</kbd></pre> }</pre>, <kbd style="color:white">[3] </kbd><pre>{ <pre>&quot;set&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre>[ <kbd style="color:white">[ 0] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157631693011733&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 0 - Early Arrival Day, Crab Island Childrens Amusement Park, Crab Island Amusement Park, Aoyun Fuwa Eden, Beijing World Park&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 1] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157631693409808&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 1 - Great Wall of China, Tiananmen Square, Forbidden City&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 2] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157631698474564&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 2 - Shijingshan Amusement Park, Sun Park&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 3] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157631703216195&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 3 - Happy Valley Beijing and visit to 2008 Olympic Park&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 4] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157631713251068&quot;</kbd></pre>, <pre>&quot;title&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;Day 4 - Victory Kingdom, Children's Palace, Langfang&quot;</kbd></pre>, <pre>&quot;description&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;&quot;</kbd></pre> }</pre>, <kbd style="color:white">[ 5] </kbd><pre>{ <pre>&quot;id&quot;</pre><kbd style="color:slategray"> =&gt; </kbd><pre><kbd style="color:brown">&quot;72157631761492087&quot;</kbd></pre>, <pre>&quot;title&quot;</pre> 
```

我不能添加其余的输出，因为我只能在这个框中使用 30,000 个字符。以上是输出的第一部分。

如果我在前面添加一个原始调用`ap`，那么它确实有帮助，但它会在新行上输出每个字符串、哈希箭头和大括号/方括号，这没有任何用处。

我将不胜感激这个问题被重新打开。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:40:13.193

你想在视图中打印这个？你有没有尝试过

```
ap(@flickr_collections, :html => true) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:27:45.053

你试过`strip_tags`吗？

见文档： [http ://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html#method-i-strip_tags](http://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html#method-i-strip_tags)

# jquery - 简单的 jQuery 幻灯片图像向下移动一瞬间

> ID：14968715
> 
> 赞同：1
> 
> 时间：2013-02-19T22:24:12.767
> 
> 标签：jquery, html, slideshow

所以我在这里有一个简单的幻灯片的代码：

```
$("#slideshow > div:gt(0)").hide();

setInterval(function() { 
  $('#slideshow > div:first')
    .fadeOut(100)
    .next()
    .fadeIn(1000)
    .end()
    .appendTo('#slideshow');
},  3000); 
```

这是我的 HTML div：

```
<div style= "display:block;max-height: 210px;" id="slideshow">
   <div>
     <img src="https://lh5.googleusercontent.com/-hmenNgmckUY/UMYwzUQNdrI/AAAAAAAAB0Y/Z__BD-lxgYo/s912/gears.JPG">
   </div>
   <div>
     <img src="https://lh6.googleusercontent.com/-Xn464dhgk6g/UNTgxgKrbvI/AAAAAAAAAwA/2omVTkLCjSE/s928/didy%2520site%25201.JPG">
   </div>

</div> 
```

这是一个工作小提琴：http: [//jsfiddle.net/shrimpboyho/9n9GK/](http://jsfiddle.net/shrimpboyho/9n9GK/)

但是，请注意，当图片发生变化时，您可以看到之前的图像褪色并向下移动，然后完全消失？

这对我来说是个问题，因为幻灯片需要放在一段文字的上方，而且随着图片的变化，图片在文字上闪烁，很烦人。有什么办法可以解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:29:43.183

```
<div style= "display:block;max-height: 210px;" id="slideshow"> 
```

这个最大高度是否真的有效，如果是，试试这个：

```
 <div style= "display:block;max-height: 210px; overflow:hidden;" id="slideshow"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:32:35.190

```
#slideshow {
    position: relative;
}
#slideshow > div {
    position: absolute;
    top: 0;
    left: 0;
} 
```

这会将图像放在彼此的顶部。

# c# - 为什么实例化变量内联会导致更快的代码？

> ID：14968716
> 
> 赞同：0
> 
> 时间：2013-02-19T22:24:14.540
> 
> 标签：c#, .net

我正在将一个巨大的数据集加载到内存中。代码基本上循环通过 DataTable 并将 DataRow 中的值复制到`int`变量中。出于某种原因，我在循环中声明的变量的处理速度几乎是在方法顶部声明的变量的两倍。

下面是 Ants Perf Profiler 的屏幕截图。尽你所能，这条线`siteID = (int) oDR[FIELD_SITE_ID]`的速度几乎是前一条线的两倍。为什么会这样？

![在此处输入图像描述](../Images/7768c76c4207bf4f6783508e1b30d495.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:28:40.973

难道这`oDR[FIELD_SITE_ID]`就是这里的慢吗？尝试将其分配给循环中的变量，然后将其分配给`siteID`变量。如果我是正确的，您应该看到惩罚已经从您的`sideID`分配转移到从`oDR`.

```
int siteIDtmp = (int)oDR[FIELD_SITE_ID];
siteID = siteIDtmp; 
```

# java - APNS - 发送消息失败

> ID：14968718
> 
> 赞同：3
> 
> 时间：2013-02-19T22:24:15.607
> 
> 标签：java, ios, push-notification, apple-push-notifications

我遇到了 APNS 的奇怪问题。我使用 com.notnoop.apns 库，当我尝试将相同的消息推送到 40 台设备时，我得到了

```
ApnsConnectionImpl : Failed to send message 
com.notnoop.apns.EnhancedApnsNotification@be443877... trying again
java.net.SocketException: Connection reset by peer: socket write error
at java.net.SocketOutputStream.socketWrite0(Native Method)
at java.net.SocketOutputStream.socketWrite(Unknown Source)
... 
```

一切顺利，当我尝试将相同的消息推送到 4、10 甚至 15 台设备时。

我尝试将带有推送令牌的集合从 40 拆分为 4*10 并在 foreach 中推送此通知，但第二次尝试我遇到了同样的问题。

这是带有推送方法的代码：

```
//prepared collection and message
private void sendMessage(Collection<String> ids, PayloadBuilder message) {
try{
    service.push(ids, message.build);       
}catch(Exception e) {
    logger.debug("APNS ERROR : size of collection - " + ids.size());
} 
```

}

服务构造器：

```
 try {
        service = APNS.newService()
                .withCert(pathToCertificate, certificatePasswd)
                .withProductionDestination()
                .build();
    } catch(IOException e){
        e.printStackTrace();
    } 
```

我用不同的推送令牌集合（集合从 1 到 40 个令牌随机）用这种方法午餐 10 次，有一次我遇到了这个异常（所有令牌都是正确的）。是否可以无缘无故地通过 APNS 重置连接？如果我失去连接，该怎么办？重新连接并尝试再向设备推送一条丢失时间的消息？请帮忙，我没有想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T09:55:20.443

我推荐 Java PNS 库：[http](http://code.google.com/p/javapns/) ://code.google.com/p/javapns/ 。我在我的一个项目中使用了它，它工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T02:11:02.177

您的数据库中可能有无效的设备令牌。

以下是一些可以帮助您的类似问题：

[验证设备令牌](https://stackoverflow.com/questions/14842597/validate-apn-push-token/14843528#14843528)

[另一个](https://stackoverflow.com/questions/14715921/critical-outcome-when-sending-push-notification-from-our-server/14716564#14716564)

[多一个](https://stackoverflow.com/questions/14185842/push-notification-not-delivering-on-multiple-devices-in-iphone-app/14188046#14188046)

[最后一个](https://stackoverflow.com/questions/10848970/sending-messages-in-bulk-to-apns-what-happens-if-there-is-an-error-with-some-of/13770897#13770897)

此外，您应该阅读这篇关于[Apple Push Notification Service 问题的](http://redth.info/the-problem-with-apples-push-notification-ser/)精彩文章。

# c# - Html Agility Pack 循环遍历表的行和列

> ID：14968729
> 
> 赞同：9
> 
> 时间：2013-02-19T22:25:03.453
> 
> 标签：c#, .net, html-agility-pack

我有一张这样的桌子

```
<table border="0" cellpadding="0" cellspacing="0" id="table2">
    <tr>
        <th>Name
        </th>
        <th>Age
        </th>
    </tr>
        <tr>
        <td>Mario
        </td>
        <th>Age: 78
        </td>
    </tr>
            <tr>
        <td>Jane
        </td>
        <td>Age: 67
        </td>
    </tr>
            <tr>
        <td>James
        </td>
        <th>Age: 92
        </td>
    </tr>
</table> 
```

并想使用 HTML Agility Pack 来解析它。我试过这段代码无济于事：

```
foreach (HtmlNode row in doc.DocumentNode.SelectNodes("//table[@id='table2']//tr"))
{
    foreach (HtmlNode col in row.SelectNodes("//td"))
    { 
        Response.Write(col.InnerText); 
    }
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T22:43:35.823

为什么不直接选择`td`s 呢？

```
foreach (HtmlNode col in doc.DocumentNode.SelectNodes("//table[@id='table2']//tr//td"))
    Response.Write(col.InnerText); 
```

或者，如果您确实需要`tr`s 单独进行其他处理，请删除`//`并执行以下操作：

```
foreach (HtmlNode row in doc.DocumentNode.SelectNodes("//table[@id='table2']//tr"))
    foreach (HtmlNode col in row.SelectNodes("td"))
        Response.Write(col.InnerText); 
```

当然，这只有在`td`s 是 s 的直接子代时才有效，`tr`但它们应该是，对吧？

* * *

编辑：

```
var cols = doc.DocumentNode.SelectNodes("//table[@id='table2']//tr//td");
for (int ii = 0; ii < cols.Count; ii=ii+2)
{
    string name = cols[ii].InnerText.Trim();
    int age = int.Parse(cols[ii+1].InnerText.Split(' ')[1]);
} 
```

使用 LINQ 可能有一种更令人印象深刻的方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T22:44:45.287

我运行了代码，它只显示*Names*，这是正确的，因为*Ages*是使用无效的 HTML 定义的：（`<th></td>`可能是错字）。

顺便说一句，代码可以简化为只有一个循环：

```
foreach (var cell in doc.DocumentNode.SelectNodes("//table[@id='table2']/tr/td"))
{
    Response.Write(cell.InnerText);
} 
```

这是我用来测试的代码：http: [//pastebin.com/euzhUAAh](http://pastebin.com/euzhUAAh)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T21:58:47.973

我必须提供完整的 xpath。[我从@Coda ( https://stackoverflow.com/a/3104048/1238850](https://stackoverflow.com/a/3104048/1238850) )的建议中使用 Firebug 获得了完整的 xpath ，我最终得到了以下代码：

```
foreach (HtmlNode row in doc.DocumentNode.SelectNodes("/html/body/table/tbody/tr/td/table[@id='table2']/tbody/tr"))
{
    HtmlNodeCollection cells = row.SelectNodes("td");
    for (int i = 0; i < cells.Count; ++i)
    {
        if (i == 0)
        { Response.Write("Person Name : " + cells[i].InnerText + "<br>"); }
        else {
            Response.Write("Other attributes are: " + cells[i].InnerText + "<br>"); 
        }
    }
} 
```

我相信它可以写得比这更好，但它现在对我有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-12-19T03:23:11.853

我用这个做了同样的项目：

```
 private List<PhrasalVerb> ExtractVerbsFromMainPage(string content)
    {
        var verbs =new List<PhrasalVerb>(); ;
        HtmlDocument doc = new HtmlDocument();
        doc.LoadHtml(content);
        var rows = doc.DocumentNode.SelectNodes("//table[@class='idioms-table']//tr");
        rows.RemoveAt(0); //remove header
        foreach (var row in rows)
        {
            var cols = row.SelectNodes("td");
            verbs.Add(new PhrasalVerb { 
            Uid = Guid.NewGuid(),
            Name = cols[0].InnerHtml,
            Definition = cols[1].InnerText,
            Count =int.TryParse(cols[2].InnerText,out _) == true ? Convert.ToInt32(cols[2].InnerText) : 0
            });
        }
        return verbs;
    } 
```

# c++ - 将库添加到现有项目 netbeans

> ID：14968730
> 
> 赞同：0
> 
> 时间：2013-02-19T22:25:05.137
> 
> 标签：c++, netbeans

我正在为我公司的（其他人）现有项目添加扩展。现在我想导入一个现有的库，比如 boost 。我正在使用 netbeans 来调试现有项目。现在，为了将库导入 netbeans，通常需要执行 2 个步骤：

1.  包括目录
2.  链接器-> 添加库。

但是，当我右键单击现有项目时，没有出现 Linker->Add Library 选项。（虽然我已经包含了目录，因为该选项在那里）。

有人可以指导我如何通过链接器将库添加到我现有的项目中吗？我的项目是 C++

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T00:26:09.013

假设您使用的是 unix/linux 变体：

头文件和库链接的目录是两个不同的东西。包含目录将具有所需的标头，但在编译后，可能还需要驻留在库（*.a、*.so 等）中的实际编译代码。

例如，如果您使用 pthreads，除了需要包含的标头之外，您还需要 libpthread。

链接时，您需要提供与 pthread 链接的标志，即： -lpthread 您可以在 unix 系统上使用 find 或 locate 进行搜索以查找库。就我而言，它在

> /usr/lib/libpthread.so

所以，

> gcc myfile.c -lpthread -o myfile

将 myfile.c 与 pthread 库链接

然而，

> gcc -L/usr/local/lib/

告诉 gcc 在 /usr/local/lib 下查找库（不是标题！）。

告诉 netbeans 标题在哪里是不够的，它可能会给你链接错误。告诉 netbeans 库在哪里可能就足够了，因为它可能使用正确的标志。如果这也失败了，那么您必须同时指定库标志和路径。

或者，您可以使用 cmake、make 等工具来自动化此过程并提供更多控制 IMO。

[见链接 1](http://www.cprogramming.com/tutorial/shared-libraries-linux-gcc.html) [见链接 2](https://cs.nyu.edu/~xiaojian/bookmark/linux/ld_so%20%20Dynamic-Link%20Library%20support.htm)

# php - php & 运算符构造

> ID：14968735
> 
> 赞同：0
> 
> 时间：2013-02-19T22:25:22.317
> 
> 标签：php

我得到了我正在分析的这段代码，它有这个条件

```
if(($hint&self::HINT_WRITE  && $hint&self::HINT_NOWRITE) || ($hint&self::HINT_READ  && $hint&self::HINT_NOREAD))
{
    some code ..
} 
```

知道 '$variable&self::CONSTANT' 中的 '&' 是什么意思吗？

# c# - 我应该将 C# App.config 用于我的自定义应用程序设置吗？

> ID：14968738
> 
> 赞同：0
> 
> 时间：2013-02-19T22:25:31.597
> 
> 标签：c#, config

我需要在配置文件中存储一些设置（连接字符串、文件夹路径）。

我应该使用 App.config 吗？

看起来很明显，但是......

1）应用程序。包含一些我不希望任何人能够接触到的 .NET 配置内容（包、版本等）——我宁愿总是将这些内容编译到程序中。

2）将我的开发模式配置设置编译到程序中并在缺少 App.Config 时调用（默认为内置资源或其他东西）感觉很奇怪

3）我喜欢干净的配置文件，这样我一眼就能看出设置是什么（而且我有强迫症）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:37:10.433

是的，把它全部塞进`app.config`. 我的理由是，最终用户无法*真正*`app.config`编辑其中的任何内容，即使是只有最终用户才知道的那些位（连接字符串和文件夹路径）。您想要一个不懂计算机的人用记事本编辑 XML 文件吗？我知道我没有。

 *获取最终用户值的唯一可靠方法`app.config`是在安装过程中提示用户输入它们，然后自己将它们编写为自定义操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:35:46.500

我对 *.config 文件的规则是在我希望能够在不重新部署二进制文件的情况下更改设置时使用它们。如果我不关心需要部署来进行更改，那么我将使用常量。如果我有疑问，我将使用配置文件。我几乎**总是**使用配置文件。

当我**确实**将 *.config 用于某事时，我将通过另一个“配置”类公开这些值，该类对我希望公开的每个值都有一个静态只读属性。即，如果我的应用配置有设置

```
<add key="ServerLoadTime" value="-30" /> 
```

然后我的配置类可能如下所示：

```
public static class Configuration
{

    /// <summary>
    /// Get the number of minutes before prior to the event that the server is started.
    /// </summary>
    public static int ServerLoadTime
    {
        get
        {
            if (ConfigurationManager.AppSettings["ServerLoadTime"] != null)
                return int.Parse(ConfigurationManager.AppSettings["ServerLoadTime"]);

            Logging.Write("ServerLoadTime is missing from the Configuration file.", EventLogEntryType.Warning, Logging.Sources.General, "Configuration.ServerLoadTime", null);
            return -30; // return a default value.
        }
    } 
```

}

这种方法创建了一个标准化的封装，它提供：

*   一种快速引用值的方法，无需通过 CM 和检查有效性。
*   处理错误配置值/缺失值的表面。
*   将来自配置文件的字符串转换为所需类型的地方。
*   一个记录缺失值的地方，同时仍提供默认的最后手段。
*   如果需要，可以将逻辑附加到结果的处理位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T22:29:27.233

是的，这是最佳实践，并且可以防止人们不得不重新编译您的应用程序来进行基本的配置更改：例如。新用户需要收到一封自动电子邮件，更改配置文件比重新编译和重新部署应用程序要容易得多。关于您的配置文件问题，这是一个优雅的解决方案：[http ://www.hanselman.com/blog/ManagingMultipleConfigurationFileEnvironmentsWithPreBuildEvents.aspx](http://www.hanselman.com/blog/ManagingMultipleConfigurationFileEnvironmentsWithPreBuildEvents.aspx)

我更喜欢只重命名文件，或者保留注释字符串，具体取决于我从开发到生产需要做多少。*

# bash - [bash]如何更新文件夹的内容

> ID：14968739
> 
> 赞同：1
> 
> 时间：2013-02-19T22:25:37.887
> 
> 标签：bash, stat

这是我的情况：

我有两个文件夹（A1 和 B1），我希望 A1 中包含的每个文件和子文件夹都复制到带有时间戳的 B1 中。我还想，如果文件被修改，则必须使用新的时间戳将其复制到 B1 中。

所以：

```
A1 contains: pluto.txt pippo(empty folder)

B1 contains: pluto_timestamp.txt pippo(empty folder) 
```

2天后：

```
A1 contains: pluto.txt pippo(empty folder)

B1 contains: pluto_timestamp.txt pluto_timestamp2days.txt pippo(empty folder) 
```

我的想法是：

递归启动A1 的*stat*命令并将输出保存到 txt 文件中。

像轮询器一样，当我的脚本被调度时，我想检查每个文件的*修改字段*，看看是否有一些文件被修改了。也许我可以通过再次启动*stat*命令来做到这一点

```
PSEUDOCODE

while (A1 =! empty) {

open stat_result.txt

if file_A1 already exists in_B1

       if modify_date_A1 =! modify_date_B1

                cp file_A1_TIMESTAMP into B1

       else do nothing

else 

   cp file_A1_FILESTAMP into B1  #because it doesn't exist yet

} 
```

希望可以更清楚。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-13T14:30:06.420

```
# first create the directories in B1, if they do not already exist
# then copy the timestamped files to B1, if they are not there yet
(cd A1; find -type d)|(cd B1; xargs mkdir -p)
(cd A1; find -type f)|
while read file
do  cp -n A1/$file B1/$(<<<$file sed "s,.*/[^.]*,&_`date -rA1/$file +%F_%T`,")
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:33:11.620

```
rsync --archive --dry-run A1/ B1/ 
```

[https://stackoverflow.com/tags/rsync/info](https://stackoverflow.com/tags/rsync/info)

# kendo-ui - Kendo UI Grid - 按单个字段分组

> ID：14968741
> 
> 赞同：1
> 
> 时间：2013-02-19T22:25:39.193
> 
> 标签：kendo-ui, kendo-grid

我正在尝试使用 Kendo UI Grid 替换页面中的现有网格，而不更改支持业务逻辑。我能够查询按单个字段分组的数据（业务和数据层是遗留代码，不开放更改）。

在 Kendo UI 网格中，是否可以允许对任何 ONE 字段进行分组，但不允许添加更多分组字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T23:18:11.737

这应该这样做。

### 字段/列设置

```
columns.Bound(p => p.Action).Groupable(false); 
```

### 分组配置

```
.DataSource(ds => ds
    .Server()
    .Group(g => g.Add(p => p.ChangeDateTime)
) 
```

# jquery - 使用 AJAX 和 Jquery 检查加载页面的高度

> ID：14968746
> 
> 赞同：0
> 
> 时间：2013-02-19T22:25:57.673
> 
> 标签：jquery, ajax

我试图使用 Ajax 和 Jquery 检查加载页面的高度，这是我的代码：

```
 $.ajax({
                            url: url,
                            success: function(msg){ 
                                var heigOfDiv = html(msg).height();
                                alert (heigOfDiv);
                            }
                        }); 
```

**即**如果加载页面`example.php`并且`height of this page is 2500px`我想提醒这个号码。我试过了，`document.height()`但确实给了我实际页面的高度。任何想法如何做到这一点？我需要计算高度，因为我想使用 jquery 滚动条和高度将其分配给视口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:42:38.960

您需要将元素附加到 DOM 中，以便浏览器渲染元素并生成它的尺寸。我会通过附加它做一个1x1px的隐藏容器（通过`visibility:hidden`，而不是）来做到这一点，这样它就不会影响当前页面尺寸，然后通过jQuery测量它的高度。`display:none``overflow:hidden`

# drupal-7 - 如何根据当前 URL 或路径自定义块视图中的字段值？

> ID：14968747
> 
> 赞同：0
> 
> 时间：2013-02-19T22:25:59.817
> 
> 标签：drupal-7, views, block

我正在使用 Drupal 7，并有一个视图列出了一些内容以及完整文章的链接。使用分类术语根据路径过滤内容。我想根据相同的过滤器更新文章的链接。

例如，我有一个词汇表，其中包含 Start、Grow、Move 等术语。这些页面标有以下术语：

```
Child1 (start, grow)
Child2 (start, move)
Child3 (grow, move)
Child4 (start, grow) 
```

对于网址`http://domain.com/start`，我得到一个带有`Child1, Child2, Child4`. 这些页面的链接将我带到正确的 url `domain.com/start/childx`。

对于网址`http://domain.com/grow`，我得到一个带有`Child1, Child3, Child4`. 但是，这些页面的链接将我带到

```
domain.com/start/childx 
  instead of 
domain.com/grow/childx 
```

有没有办法获取当前的分类术语或解析 URL 并在重写链接时重用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T00:14:58.127

你在使用pathauto吗？每个节点只能有一个别名，因为别名不依赖于上下文。为了让它像你想要的那样工作，你可能需要使用一个 phpfield 和一个为不同 URL 显示正确节点的模块编写一个自定义 url。

我的建议是为 URL 设置不同的模式，因为它是最简单的解决方案。

# android - 在 Android 中检测到已移除的 USB 电缆

> ID：14968750
> 
> 赞同：0
> 
> 时间：2013-02-19T22:26:12.587
> 
> 标签：android, usb, broadcastreceiver

问题有点说：

如何检测 USB 电缆（可能还有电源？）是否与设备断开连接？我认为会有一些明显的许可，我可以用它来谷歌搜索，但我没有找到任何东西）。

Stackoverflow上也有人说没有检测到USB移除但是充电状态的变化但是我失去了链接并且不能为了上帝的爱再次找到它:<希望你有一些想法我能做些什么.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:30:35.877

您可以接收电源连接或断开事件，如下所示：

```
<receiver android:name=".PowerConnectionReceiver">
  <intent-filter>
    <action android:name="android.intent.action.ACTION_POWER_CONNECTED"/>
    <action android:name="android.intent.action.ACTION_POWER_DISCONNECTED"/>
  </intent-filter>
</receiver> 
```

# visual-c++ - 如何在 IIS 7.5 上使用 FastCGI 和 C++

> ID：14968757
> 
> 赞同：0
> 
> 时间：2013-02-19T22:26:49.603
> 
> 标签：visual-c++, iis, fastcgi

有人知道如何在 IIS 7.5 下使用 FastCGI 运行 C++ 应用程序吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T00:04:53.343

IIS 仅为服务器实现 FastCGI 所需的 API，您有责任在您自己的 C++ 应用程序中实现其余的 API，以便它不仅适用于 IIS，而且适用于任何其他启用了 FastCGI 的 Web 服务器。

[http://technet.microsoft.com/library/hh831548.aspx](http://technet.microsoft.com/library/hh831548.aspx)

您可以从上面的链接中看到，IIS 接受任何满足基本要求的可执行文件。

您可以参考 PHP 或 Python 的 IIS 集成以了解技术细节，

[http://pypi.python.org/pypi/iiswsgi/0.3](http://pypi.python.org/pypi/iiswsgi/0.3)

它们是开源的，因此您可能会从代码库中找到一些有用的东西。

# javascript - Node.js 中是否需要逗号？

> ID：14968761
> 
> 赞同：7
> 
> 时间：2013-02-19T22:27:07.833
> 
> 标签：javascript, node.js, syntax

在 node.js 的变量声明中省略逗号会产生风险吗？例如，声明一些像下面这样的全局变量就可以了：

```
express = require('express')
jade = require('jade') 
```

如果不写逗号是安全的，我不想写逗号（我不关心“代码的美/清晰”参数）。

**重要提示**：我的意思是逗号，而不是分号（得到 3 个关于分号的答案）。完全没问题，甚至建议从 node.js 中删除分号。npm 的创建者也这样做了： http: [//blog.izs.me/post/3393190720/how-this-works](http://blog.izs.me/post/3393190720/how-this-works)

如果有疑问，请查看最新的 javascript 规范： http: [//www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)

请注意，您也不需要编写

```
var 
```

对于全局变量。

但是这个问题是关于“逗号”的，所以在编辑我的问题（之前完成）时，请不要错误地用分号替换逗号。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-19T23:01:07.613

在 JavaScript 中，如果你不写*分号* `;`，它们会为你插入，不可见。而且您可能并不总是喜欢他们去的地方。

从技术上讲，您不需要以分号结束每个语句。然而，大多数人认为这是一个好主意。

有关更多信息，请仔细阅读[此 google 搜索](https://www.google.com/webhp?q=javascript%20semicolon%20debate#hl=en&output=search&sclient=psy-ab&q=javascript%20semicolon%20debate&oq=javascript%20semicolon%20debate&gs_l=hp.12...0.0.0.2437.0.0.0.0.0.0.0.0..0.0.les;..0.0...1c..4.psy-ab.Zle9tOaKgRM&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&bvm=bv.42661473,d.cGE&fp=50b26647ad5972f8&biw=1707&bih=1342)的结果。我们为这个话题争论了很久。

* * *

这是一个示例，说明为什么这比乍一看更复杂。虽然从技术上讲，您不需要以分号结束每个语句，但在某些情况下您必须这样做，否则事情会中断。在大多数代码库中，您不能完全忽略它们。

```
foo.def = bar
(function() {
  // some self executing closure
})() 
```

看起来很简单吧？好吧，口译员看着它并这样做：

```
foo.def = bar(function() {
  // some self executing closure
})() 
```

这可能不是您所期望的。修复它的方法是使用分号。

```
foo.def = bar;
(function() {
  // some self executing closure
})() 
```

这样的案例很多。你可以全部学习它们，只在那些情况下使用它们，当你不可避免地忘记你尝试调试你的代码时，你会尝试调试你的代码，这些代码正在做一些如此奇怪和离奇的事情，以至于你把头发扯了好几个小时...... *“你的意思`wtfvar`是不是一个函数？！？它不应该是一个函数！”*

或者您可以只使用分号以保持一致性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-15T22:08:56.283

这个很晚的答案只会让其他可能读到这篇文章的人感到困惑。

由于您*实际上是*在谈论**commas**，而不是分号，因此我只能假设您对引擎隐式添加的内容有误解。

逗号**不是**可选的。而这段代码：

```
express = require('express')
jade = require('jade') 
```

正在被隐式转换为：

```
var express = require('express');
var jade = require('jade'); 
```

不是这个，你可能期待：

```
var express = require('express'),
    jade = require('jade'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T22:53:20.070

简而言之，没有。当您进行代码压缩等操作并且编译器认为您的两个语句是一个时，您可能会遇到的问题会出现。无论如何，如果你选择不使用逗号/分号，这是绝对不推荐的，你应该没问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T23:01:53.780

Node.js 使用 V8 引擎来读取您的代码，因此它的行为与 Google Chrome 中的行为非常相似。也就是说，不使用**分号**通常是一种不好的做法。解释器将尝试理解您的代码，并且有时可能会出错（由于您的错）。

查看此内容以获得完整解释：[您是否建议在 JavaScript 中的每个语句后使用分号？](https://stackoverflow.com/questions/444080/do-you-recommend-using-semicolons-after-every-statement-in-javascript)

# jquery - 计算元素在元素树中的数字位置

> ID：14968762
> 
> 赞同：1
> 
> 时间：2013-02-19T22:27:11.457
> 
> 标签：jquery

我正在准备一组演示幻灯片，每张幻灯片上都可以包含多个代码部分。我正在制作一个 jQuery 插件，让我突出显示各个代码行，并逐行上下移动突出显示。

这是标记的示例：

```
<div class='slide'>
    <div class='section'>
        <span class='line'>Line 1</span>
        <span class='line'>Line 2</span>
    </div>
    <div class='section'>
        <span class='line'>Line 3</span>
        <span class='line'>Line 4</span>
    </div>
    <div class='section'>
        <span class='line'>Line 5</span>
        <span class='line'>Line 6</span>
    </div>
</div>

<div class='slide active'>
    <div class='section'>
        <span class='line'>Line 1</span>
        <span class='line'>Line 2</span>
    </div>
    <div class='section'>
        <span class='line'>Line 3</span>
        <span class='line selected'>Line 4</span>
        <span class='line'>Line 5</span>
    </div>
    <div class='section'>
        <span class='line'>Line 6</span>
        <span class='line'>Line 7</span>
    </div>
</div>

<div class='slide'>
    <div class='section'>
        <span class='line'>Line 1</span>
        <span class='line'>Line 2</span>
    </div>
    <div class='section'>
        <span class='line'>Line 3</span>
        <span class='line'>Line 4</span>
    </div>
</div> 
```

第二张幻灯片（共三张）是活动的可见幻灯片，在该幻灯片中，第二个代码部分的中间行被选中（突出显示）。

我可以使用 jQuery 按数字选择一行，如下所示：

```
var the_line = $(".slide.active").find("span.line")[lineno-1]; 
```

我似乎无法做的是计算当前所选行的行号。我试着用这个来计算选定的行后面有多少行，但它只在一个部分内有效：

```
var following_lines = $(".slide.active").find("span.line.selected").nextAll("span.line"); 
```

如何获取所选行的行号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:32:08.387

如果要查找*所选*跨度的索引，可以使用`index`方法：

```
var $lines = $('.slide.active').find('span.line'),
    index = $lines.index( $lines.filter('.selected') ) // 3 
```

[http://jsfiddle.net/3dkAM/](http://jsfiddle.net/3dkAM/)

# php - 如何从查询中排除不需要的记录

> ID：14968763
> 
> 赞同：0
> 
> 时间：2013-02-19T22:27:14.713
> 
> 标签：php, mysql, sql

我有一个 MySQL 语句，我需要一些帮助。我正在正确提取数据，但我只需要一些帮助，排除不需要的记录。如果候选人剩余尝试次数等于 0，我不想提取该记录，但如您所见，我正在使用子查询来生成候选人可能进行的重新挖掘尝试次数。

有没有办法使用 WHERE 语句中的剩余尝试字段来排除不需要的记录？

```
 SELECT (
                SELECT  count(*) AS Number_Attempts_Used
                FROM    candidate_exam_record
                WHERE   candidate_exam_record.idcandidate_eligibilty = candidate_eligibilty.idcandidate_eligibilty
            ) AS remaining_attempts
            , (
                SELECT CASE WHEN count(*) > '0' THEN candidate_exam_record.idcandidate_eligibilty END
                FROM candidate_exam_record
                WHERE candidate_exam_record.idcandidate_eligibilty = candidate_eligibilty.idcandidate_eligibilty) AS EL_ID
    FROM    candidate_eligibilty
            INNER JOIN candidate ON candidate_eligibilty.idcandidate = candidate.idcandidate
            INNER JOIN exam ON candidate_eligibilty.exam_id = exam.exam_id
            INNER JOIN jurisdiction ON exam.jurisdiction_id = jurisdiction.jurisdiction_id
    WHERE   jurisdiction.jurisdiction_id = 'xxxx' 
            AND candidate_eligibilty.eligibility_end_date >= '2013-02-19'
            AND remaining_attempts > '0' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:30:05.613

它很乱，但对我来说看起来还可以。尝试更改`'0'`为只是简单的 old `0`。我假设您将其存储为 INT ，对吗？

# drag-and-drop - 在没有查看器获得焦点的情况下从 treeviewer 中拖动项目

> ID：14968765
> 
> 赞同：1
> 
> 时间：2013-02-19T22:27:23.717
> 
> 标签：drag-and-drop, swt, jface

**问题**

有没有办法在开始拖放操作时防止 treeviewer 获得焦点？或者您知道另一种防止它在拖动时更改其选择的方法吗？

**情况**

*   第一类
    *   注释 1.1
*   第 2 类
    *   注释 2.1

我有显示类别的 TreeViewer“类别”和显示所选类别中的注释的 1 个 TableViewer“注释”。“注释”视图内容由通过数据绑定选择“类别”视图提供。

**问题**

当我在“类别”视图中选择了类别 1 时，我会在“注释”视图中看到注释 1.1。问题是当我想将类别 2 拖到 Note 1.1 上时，“类别”视图选择类别 2，我不能再将类别放在 Note 1.1 上，因为现在“注释”视图仅显示 Note 2.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T06:36:41.647

当您想开始拖动时，我认为您无法阻止类别视图获得焦点和触发选择更改。这只是控件的自然行为。可能有一些非常规的方法来延迟选择触发，但它们可能无法完美运行。

但是，为了解决您的问题，我建议配置您的拖放支持，这样当您开始拖动“类别 2”（并因此更改选择）时，您首先必须将鼠标悬停在“类别 1”上（应重新选择“类别 1” ) 并且它将允许您在“Note 1.1”上删除“Category 2”。

这意味着您还可以为类别查看器添加拖放支持，并在`DropTargetListener#dragOver(DropTargetEvent)`您将选择设置为鼠标悬停的类别。这应该开始显示您的正确注释，以便您可以将拖动的类别放在它上面。

# objective-c - 表格视图中的 SetNeedsDisplay

> ID：14968766
> 
> 赞同：0
> 
> 时间：2013-02-19T22:27:27.163
> 
> 标签：objective-c, uiview, uitableview, setneedsdisplay

我的问题是，并非所有单元格都使用正确的 UIView 正确初始化为渲染图像。（请参见下面的代码）在 iphone 4 上，具有视网膜显示的 iphone 上的相同 cel 也是另一个单元格。在此设置中 setNeedsDisplay 将不起作用。如果我在 IBoutlet 中使用相同的结构，它就可以工作。！我需要在某些单元格中使用图像文件 .png 并在其他一些单元格中使用定义的绘图方法，它使用 drawrect 或更好我应该使用 setNeedsDisplay 方法.....

怎么回事！！！

我的代码

表格视图...单元格

```
static NSString *CellIdentifier = @"TypeCell";
    UITableViewCell *cell = [self.tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    // Configure the cell...
    CellTypes *cellType = [self.fetchedResultsController objectAtIndexPath:indexPath];
    cell.textLabel.text = cellType.title;
    cell.detailTextLabel.text = cellType.detail;

    if ( [cellType.type rangeOfString:@"TL"].location != NSNotFound) {
        cell.imageView.image = [UIImage imageNamed:[cellType.type stringByAppendingString:@"Thumb"]];
        cell.indentationWidth = 10;

    }
    else {

        static CGFloat scale = 0.0;  // old API , screen  values
        UIScreen *screen = [UIScreen mainScreen];
        if ([[[UIDevice currentDevice] systemVersion] floatValue] >= 4.0) {
            scale = [screen scale];
        }
        if (scale>0.0) {
            UIGraphicsBeginImageContextWithOptions(cell.imageView.bounds.size, NO, scale);
        }
        else {
            UIGraphicsBeginImageContext(cell.imageView.bounds.size);
        }

        CGRect imageRect = CGRectMake(0, 0, 84, 84 );  //    cell.imageView.bounds;

        FittingImageView *fittingImage = [[FittingImageView alloc] initWithFrame:imageRect];
        fittingImage.thumb = YES;
        fittingImage.title = offSetType.title;

        [fittingImage drawRect:imageRect]; // this works but skips one imageRect
//        [fittingImage setNeedsDisplay]; //this won't work.
        [cell.layer renderInContext:UIGraphicsGetCurrentContext()];

        cell.imageView.image = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();

    }
    return cell; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T23:11:15.397

你永远不能给`drawRect:`自己打电话。它由 Cocoa 调用，只有 Cocoa 可以设置上下文。目前尚不清楚您要在这里做什么。我不知道a`FittingImageView`是什么。您正在创建它，然后在任何情况下都将其丢弃。

然后，您尝试将单元格本身渲染为图像，并将该图像放入单元格的图像视图中。那没有意义。

您可能会误解 tableview 单元格是如何创建、重用和绘制的。您应该重新阅读[“创建和配置表视图”。](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/tableview_iphone/TableViewCells/TableViewCells.html)

要记住的主要事项：

*   在这个例程中，你的工作是要么创建一个新单元，要么重新配置一个可重复使用的单元（如果`dequeueReusableCellWithIdentifier:`返回给你一些东西）。
*   此例程不适用于*绘制*单元格。这将在很久以后发生，并且它是细胞的工作来绘制自己。您只是在*配置*单元格。把以后需要绘制的所有东西都放进去。
*   您通常不想在此例程中计算昂贵的东西。在其他地方计算并缓存它们。该例程应该配置一个单元格，将数据放入其中，然后返回。如果您尝试在此例程中创建新图像，您的表格视图将会结结巴巴。
*   您不应该在此例程中间弄乱单元格的层。如果您需要一些复杂的东西，您应该创建一个带有自己的自定义单元格`drawRect:`。

# intuit-partner-platform - 通过 IPP 和 .net devkit 在线连接到 quickbooks 时遇到问题

> ID：14968767
> 
> 赞同：0
> 
> 时间：2013-02-19T22:27:26.963
> 
> 标签：intuit-partner-platform, quickbooks-online

我正在尝试在线连接到 QB，但遇到了问题。我为 QBO 创建了一个演示帐户，并将我的测试应用程序添加到该帐户并授予我的应用程序的访问权限。我有我的消费者密钥和秘密令牌。我已经安装了 .net devkit 并设置了我的测试项目。

我正在使用此处的代码示例...

[https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0200_DevKits_for_Intuit_Partner_Platform/0100_IPP_.NET_DevKit/0299_Synchronous_Calls/0001_Data_Service_APIs](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0200_DevKits_for_Intuit_Partner_Platform/0100_IPP_.NET_DevKit/0299_Synchronous_Calls/0001_Data_Service_APIs)

一切正常，直到我调用 add 方法来创建客户。就添加数据而言，我尝试做的任何其他事情也是如此。

这是我得到的错误...

“消息=异常验证 OAuth；errorCode=003200；statusCode=401；源=OAuthStrategy；oauth_problem=token_rejected；原因=net.oauth.OAuthProblemException：token_rejected”

它说令牌被拒绝，所以我不清楚我错过了什么。这些是在线应用部分给我的代币。

这是我的代码..

```
 Dim AccessToken As String = [redacted]
        Dim AccessTokenSecret As String = [redacted]

        Dim ConsumerKey As String = [redacted]
        Dim ConsumerSecret As String = [redacted]

        Dim OAuthValidator As OAuthRequestValidator = New OAuthRequestValidator(AccessToken, AccessTokenSecret, ConsumerKey, ConsumerSecret)
        Dim Context As ServiceContext = New ServiceContext(OAuthValidator, RealmID, IntuitServicesType.QBD)

        Dim dataServices As DataServices = New DataServices(Context)

        Dim qbdCustomer As Customer = New Customer()
        With qbdCustomer
            qbdCustomer.Name = "My New Customer"
            qbdCustomer.GivenName = "New Customer"
            qbdCustomer.FamilyName = "New Customer"
        End With
        Dim customerAdded As Customer = dataServices.Add(qbdCustomer) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T13:50:41.380

如果您尝试连接到 QBO，则说明您使用了错误的实体。

您应该使用 QBO 而不是 QBD。

此外，您的 InitializeServiceContext 看起来缺少一些参数。

# php - 如何在 Plupload 中中止文件上传？

> ID：14968768
> 
> 赞同：1
> 
> 时间：2013-02-19T22:27:32.503
> 
> 标签：php, wordpress, plupload

我正在尝试为 Wordpress 创建一个图库插件，并且正在使用[Plupload](http://www.plupload.com)上传一些图像。

在用户上传新图库的图像之前，必须添加图库名称。由于我使用拖放，如果画廊名称为空，我需要中止文件上传。

我尝试了各种解决方案，但我无法停止文件上传（我认为）。

在我的 SJ 脚本的底部，我正在检查`dragover`. 我想中止的地方标有`//HERE FILE UPLOAD MUST ABORT`。

但我不确定这是否是正确的地方。谁能告诉我在哪里可以中止dragover（和drop）上的上传？

```
// PHP code - I'm adding this data here, because I need some WP data
function plupload_init() {

    //$image_size = get_option('sim_gallery_max_width_height');

    $plupload_arr = array(
        'runtimes' => 'html5,silverlight,flash,html4,browserplus,gears',
        'browse_button' => 'plupload-browse-button', // will be adjusted per uploader
        'container' => 'plupload-upload-ui', // will be adjusted per uploader
        'drop_element' => 'drag-drop-area', // will be adjusted per uploader
        'file_data_name' => 'async-upload', // will be adjusted per uploader
        'multiple_queues' => true,
        'max_file_size' => wp_max_upload_size() . 'b',
        'url' => admin_url('admin-ajax.php'),
        'flash_swf_url' => includes_url('js/plupload/plupload.flash.swf'),
        'silverlight_xap_url' => includes_url('js/plupload/plupload.silverlight.xap'),
        'filters' => array(array('title' => __('Image files'), 'extensions' => 'jpg,jpeg,gif,png')),
        'multipart' => true,
        'urlstream_upload' => true,
        'multi_selection' => false, // will be added per uploader
        // additional post data to send to our ajax hook
        'multipart_params' => array(
            '_ajax_nonce' => "", // will be added per uploader
            'action' => 'plupload_action', // the ajax action name
            'imgid' => 0 // will be added per uploader
        )
    );
?>
    <script type="text/javascript">
        var plupload_config_vars = <?php echo json_encode($plupload_arr); ?>;
    </script>
<?php
}

// JS scrip
function init_image_upload() {

    if(jQuery('#image-upload').length == 0)
        return;

    var plupload_config = JSON.parse(JSON.stringify(plupload_config_vars));
    var uploader = new plupload.Uploader(plupload_config);

    // Control gallery name
    control_gallery_name();

    uploader.bind('Init', function(up){});

    uploader.init();

    // a file was added in the queue
    uploader.bind('FilesAdded', function(up, files){
    });

    // Change border color on drop zone
    function drop_area_visual_feedback(up) {
        var uploaddiv = jQuery('#plupload-upload-ui');

        if ( up.features.dragdrop) {
            uploaddiv.addClass('drag-drop');

            jQuery('#drag-drop-area').bind('dragover.wp-uploader', function(){ // dragenter doesn't fire right :(
                if(!jQuery('input[name="gallery-name"]').val()) {
                    jQuery('label.missing-name').removeClass('hidden');

                    //HERE FILE UPLOAD MUST ABORT

                } else {
                    uploaddiv.addClass('drag-over');
                }

            }).bind('dragleave.wp-uploader, drop.wp-uploader', function(){
                    uploaddiv.removeClass('drag-over');
            });
        } else {
            uploaddiv.removeClass('drag-drop');
            jQuery('#drag-drop-area').unbind('.wp-uploader');
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T08:56:15.893

您是否尝试过像这样将代码放入 FilesAdded 处理程序中？

```
// a file was added in the queue
uploader.bind('FilesAdded', function(up, files){
       if(!jQuery('input[name="gallery-name"]').val()) {
                jQuery('label.missing-name').removeClass('hidden');
                up.splice(0);
        }
}); 
```

# jquery - 来自 jquery modal 的表单域不会发布

> ID：14968770
> 
> 赞同：1
> 
> 时间：2013-02-19T22:27:33.717
> 
> 标签：jquery, coldfusion

我所拥有的是一个基于查询结果动态创建单选表单字段的表单。除了这些动态创建的表单字段中的每一个之外，我希望能够打开一个带有单独表单的模式窗口，该窗口允许我将其他数据添加到与单选行项目相关的单独表格中。我遇到的问题是在我发布表格之前一切正常。发布的唯一结果是隐藏字段的值。这是代码。

**jQuery**

```
<script type="text/javascript">
    $(function() {
        var options = {
            open : function(event, ui) {
                $(".ui-dialog-titlebar-close").hide();
            },
            autoOpen : false,
            width : 'auto',
            modal : true,
            width : 600,
            height : 500,
            buttons : {
                "Submit" : function() {
                    $('#mForm').submit();
                    return true;
                },
                Cancel : function() {
                    $(this).dialog("close");
                }
            },
            close : function() {
                $('#defaultSectionName').val('');
                $('#defaultSectionDesc_hidden').val('');
                $('#Photo').val('');
                $('#Check2').val('');
                $('#Check21').val('');
            }
        };
        var num = 1;
        $("div#parent div").each(function() {
            var dlg = $('#dialog-window-' + num).dialog(options);
            $('#image-link-' + num).click(function() {
                dlg.dialog("open");
                return false;
            });
            num = num + 1;
        });
    }); 
</script> 
```

**HTML**

```
<div id="parent">
    <div id="dialog-window-#i#" title="#ItemName#" class="uniForm"  style="z-index: 1800 !important;">
        <p>
            <form ACTION="index.cfm?#cgi.QUERY_STRING#" class="uniForm" id="mForm" method="post">
                <input type="hidden" name="Check2" value="#ID#" id="Check2">
                <input type="hidden" name="PhotoNew" value="New" id="Check21">
                <div class="ctrlHolder">
                    <label for="" style="display:none"><em>*</em>Picture</label>
                    <input name="Photo" type="file" id="Photo"
                    value=""
                    size="30"
                    data-default-value="Select file"
                    class="textInput "/>
                </div>

                <div class="ctrlHolder" >
                    <label for="" style="display:none"><em>*</em>Section</label>
                    <input name="Number2" style="z-index:1900 !important;"
                    id="defaultSectionName"
                    value=""
                    size="30"
                    data-default-value="Select Section"
                    class="textInput "/>
                    <p class="formHint">
                        Select a solution name
                    </p>
                </div>

                <div class="ctrlHolder">
                    <label for="" style="display:none"><em>*</em>Notes</label>
                    <textarea name="picture_note"
                    id="defaultSectionDesc_hidden"
                    data-default-value="Additional Picture Notes"
                    size="100" cols="70" rows="10"
                    class="textInput validateMaxLength val-500"
                    <p class="formHint">
                        additional notes are optional
                    </p>
                </div>
            </form>
        </p>
    </div>
    <div>
        <a id="image-link-#i#"> <img src="assets/images/camera-icon.png" alt="o" /></a>
    </div>
</div> 
```

注意：此 div 包含在 cfoutput 循环中，并嵌套在另一个 cfform 中。

# image - 图像边框在 Outlook 2010/2007 中不起作用

> ID：14968774
> 
> 赞同：2
> 
> 时间：2013-02-19T22:27:42.980
> 
> 标签：image, outlook, border

问题是：我想要图片上有一个白色边框，但是当我将它发送到我的 Outlook 2007 或 2010 时，它没有显示。这是相关图像的代码：

`<img src="my.jpg" alt="" width="220" height="220" border="3" style="border:3px solid #FFF;" />`

这个问题有解决办法吗？我觉得我已经尝试了一切，但没有任何效果。

这确实渲染了一个边框，但这不是一个理想的解决方案，因为图像和边框之间有一个空间。

```
<table width="220" height="220" border="0" cellspacing="0" cellpadding="0" style="border:3px solid #FFF;">
    <tr>
        <td>
            <img src="my.jpg" alt="" width="220" height="220" border="0" title="70's Styled House and Pool" />
        </td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T00:00:34.493

我想你必须把它包起来。跨度怎么样：

```
s = "<html><body>" _
& "<span style='display:inline-block;padding:5px;border:5px solid #fff;'>" _
& "<img src='z:\docs\image1.jpg' alt='' width=220 height=220></span>" _
& "</body></html> "

Set oEmail = Application.CreateItem(olMailItem)

oEmail.HTMLBody = s
oEmail.Display 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-31T10:40:03.727

我无法让 SPAN 解决方案工作（我怀疑是因为我的 CMS 添加了额外的代码）。

我的解决方案是将图像包装在表格中，将单元格填充设置为所需的边框宽度，并将 bgcolor 设置为所需的边框颜色。几乎没有语义，但这是 Outlook 的错。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-09-23T20:08:58.107

您的问题之一是电子邮件中不支持十六进制颜色速记。所以你应该使用所有六个十六进制数字。

```
<img
    src="http://example.com/image.jpg" 
    alt="" 
    width="220" 
    height="220" 
    border="3"
    style="border:3px solid #ffffff;" /> 
```

# android - 如何在android中发送位置图

> ID：14968775
> 
> 赞同：0
> 
> 时间：2013-02-19T22:27:44.900
> 
> 标签：android, database, google-maps, location

我正在尝试在我的 Android 应用程序中添加一项功能，那就是发送我的位置，就像在 whatsapp 或 viber 上一样。我知道如何通过谷歌地图或通过提供商的坐标来检索我的位置，但是任何人都可以帮助我开始如何实际发送我的位置地图吗？可能到数据库

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T01:58:44.373

1-使用 locationManager 获取位置后，您可以将值 lat/long 存储在变量中。

2-将变量存储在 json 对象中。

3- 使用 HTTP 请求 POST json

在网页上

1-处理json响应

2-将值存储在变量中

3-通过将变量放在谷歌地图API给出的代码中来查看地图

# php - 如何将 Oracle 10G 数据放入 PHP 数组，然后将其转换为 JavaScript 数组？

> ID：14968778
> 
> 赞同：1
> 
> 时间：2013-02-19T22:27:49.763
> 
> 标签：php, javascript, oracle, oracle10g

我正在尝试定义一个 PHP 数组，然后连接到 Oracle 10g 并获取从连接请求的数据并将其放入 PHP 数组中。

最后，我想获取 PHP 数组并将其转换为 JavaScript 数组。

这就是我正在尝试的。

有人可以指出为什么这不起作用并可能提供解决方案吗？

谢谢你。

```
 $dbArray = array();
        $conn = oci_connect("username", "password", "connecturl");
        $query = 'select endpoint_name from endpoint_ref order by endpoint_name asc';
        $stid = oci_parse($conn, $query);
        $result = oci_execute($stid); 
        while ($row = oci_fetch_array($stid, OCI_RETURN_NULLS+OCI_ASSOC)) 
        {
            foreach ($row as $item) {
                array_push($dbArray, $item);
                var_dump($dbArray);
                echo $dbArray;
            }
        }
        $jsArray = json_encode($dbArray); 
```

另外，如何设置这个名为“availableTags”的 JavaScript 变量等于我新编码的 JavaScript 数组？

```
 $(function() {
    var availableTags = jsArray;
    $( "#tags" ).autocomplete({
      source: availableTags
    });
  });
  </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T00:22:41.817

我的问题中的转换是正确的，问题是 JavaScript 函数。这是正确调用包含 Oracle 10g 数据的 JSON 编码 PHP 数组的方法。

```
 <script>
    $(function() {
        var availableTags = <?php echo json_encode($dbArray); ?>;
        $( "#endPointName" ).autocomplete({
        source: availableTags
        });
    });
    </script> 
```

# php - 如果我在插入数据库之前对密码进行加密，我必须使用 mysql_real_escape_string 吗？

> ID：14968779
> 
> 赞同：1
> 
> 时间：2013-02-19T22:27:51.327
> 
> 标签：php

我正在使用 sha1 对其进行加密。我也应该使用 mysql_real_escape_string()，还是加密它就足够了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T22:29:49.507

从技术上讲，输出`sha1`将始终是十六进制字符串，因此您无需转义它。

**但是：**这个问题的答案总是一样的：转义值。如果它来自 SQL 前 2 行的硬编码变量，请将其转义。总是。逃脱。时期。还有很多其他的事情需要担心优化。

然而，参数化查询和 PDO 始终是最佳选择

第二个注意事项：`sha1`并且`md5`不是最安全的密码。如果您不是太远，请考虑另一种解决方案，例如河豚

# email - 使用3G时无法发送邮件，但在WIFI下可以正常工作

> ID：14968780
> 
> 赞同：0
> 
> 时间：2013-02-19T22:27:53.693
> 
> 标签：email

我正在使用 Hmailserver 作为邮件服务器，它对于使用标准互联网连接（有线或无线）的邮件客户端正常工作。

但是在 3G 模式下使用移动设备时，突然无法再发送电子邮件了。在邮件客户端中，有一条不言而喻的错误消息（例如发生未知错误）。这有什么原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:50:09.723

很难说；[但是，使用SMTP](http://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol)时，电子邮件通常通过端口 25 传输。很可能您的 3G 提供商正在阻止传出端口 25 连接。

您可以通过使用 telnet（“Windows telnet”的 Google 将提供一些 Microsoft 文档）连接到知名邮件服务器（这些在[DNS MX](http://en.wikipedia.org/wiki/MX_record)记录中公布）来验证这一点。在 Windows 上，我相信命令行的语法是：“telnet <host> 25”（对于 Google，有效的邮件主机是 alt2.aspmx.l.google.com）。

如果您的提供商阻止端口 25 流量，您将看到连接被拒绝消息。通常 ISP 更喜欢你连接到他们的 SMTP 服务器——这样他们就可以防止垃圾邮件从他们的网络中发出。

# c# - 如何终止 MVC4 中的 Razor 语句？

> ID：14968781
> 
> 赞同：2
> 
> 时间：2013-02-19T22:27:54.697
> 
> 标签：c#, razor, asp.net-mvc-4

所以我的html中有一行这样

```
someVariable: "@(SomeClass.SomeFunction(SomeParameter))", 
```

但是我想在没有 quatations 的情况下得到相同的结果，所以当我做这样的事情时，它不会作为字符串传入

```
someVariable: @(SomeClass.SomeFunction(SomeParameter)), 
```

它不起作用，我在这里缺少什么格式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:28:57.703

这取决于这个函数返回什么。如果是某个对象，您可以使用以下`Json.Encode`方法将其转换为 JSON：

```
someVariable: @Html.Raw(Json.Encode(SomeClass.SomeFunction(SomeParameter)), 
```

这将确保该值被正确转换为 javascript 对象，并且`Html.Raw`帮助程序将确保它没有被 HTML 编码。

# ruby - 在 ruby 中解析字典文本文件

> ID：14968796
> 
> 赞同：0
> 
> 时间：2013-02-19T22:28:53.213
> 
> 标签：ruby, parsing, search, text-files

我正在使用 ruby​​ 尝试解析具有以下形式的文本文件...

```
AAB eel bbc 
ABA did eye non pap mom ere bob nun eve pip gig dad nan ana gog aha
    mum sis ada ava ewe pop tit gag tat bub pup
    eke ele hah huh pep sos tot wow aba ala
    bib dud tnt 
ABB all see off too ill add lee ass err xii ann fee vii inn egg odd bee dee goo
    woo cnn pee fcc tee wee ebb edd gee ott ree vee ell orr rcc att boo cee cii
    coo kee moo mss soo doo faa hee icc iss itt kii loo mee nee nuu ogg opp pii
    tll upp voo zee 
```

我需要能够按第一列进行搜索，例如“AAB”，然后搜索与该键关联的所有值。我试图将文本文件导入到数组的哈希中，但永远无法获得超过要存储的第一个值。我对如何搜索文件没有偏好，无论是将数据存储到某个数据结构中还是每次都搜索文本文件，我只需要能够做到。我不知道如何进行此操作，任何帮助将不胜感激。谢谢

-amc25114

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T03:41:33.740

这将读取您的字典文件。我将内容存储在一个字符串中，然后将其转换为 StringIO 对象，让我假装它是一个文件。您可以使用 [`File.readlines`](http://www.ruby-doc.org/core-1.9.3/IO.html#method-c-readlines)直接从文件本身读取：

```
require 'pp'
require 'stringio'

text = 'AAB eel bbc 
ABA did eye non pap mom ere bob nun eve pip gig dad nan ana gog aha
    mum sis ada ava ewe pop tit gag tat bub pup
    eke ele hah huh pep sos tot wow aba ala
    bib dud tnt 
ABB all see off too ill add lee ass err xii ann fee vii inn egg odd bee dee goo
    woo cnn pee fcc tee wee ebb edd gee ott ree vee ell orr rcc att boo cee cii
    coo kee moo mss soo doo faa hee icc iss itt kii loo mee nee nuu ogg opp pii
    tll upp voo zee
'

file = StringIO.new(text)

dictionary = Hash[
  file.readlines.slice_before(/^\S/).map{ |ary| 
    key, *values = ary.map(&:strip).join(' ').split(' ')
    [key, values] 
  }
] 
```

`dictionary`是一个看起来像这样的哈希：

```
{
  "AAB"=>[
    "eel", "bbc"
  ],
  "ABA"=>[
    "did", "eye", "non", "pap", "mom", "ere", "bob", "nun", "eve", "pip",
    "gig", "dad", "nan", "ana", "gog", "aha", "mum", "sis", "ada", "ava",
    "ewe", "pop", "tit", "gag", "tat", "bub", "pup", "eke", "ele", "hah",
    "huh", "pep", "sos", "tot", "wow", "aba", "ala", "bib", "dud", "tnt"
  ],
  "ABB"=>[
    "all", "see", "off", "too", "ill", "add", "lee", "ass", "err", "xii",
    "ann", "fee", "vii", "inn", "egg", "odd", "bee", "dee", "goo", "woo",
    "cnn", "pee", "fcc", "tee", "wee", "ebb", "edd", "gee", "ott", "ree",
    "vee", "ell", "orr", "rcc", "att", "boo", "cee", "cii", "coo", "kee",
    "moo", "mss", "soo", "doo", "faa", "hee", "icc", "iss", "itt", "kii",
    "loo", "mee", "nee", "nuu", "ogg", "opp", "pii", "tll", "upp", "voo", "zee"
  ]
} 
```

您可以使用以下键查找：

```
字典['AAB']
=> [“鳗鱼”，“英国广播公司”]

```

并使用以下方法在数组内搜索`include?`：

```
字典['AAB'].include?('eel')
=> 真
字典['AAB'].include?('foo')
=> 假的

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T23:34:58.017

```
class A

  def initialize
    @h, key = readlines.inject({}) do |m, s|
      a = s.split
      m[key = a.shift] = [] if s =~ /^[^\s]/
      m[key] += a
      m
    end
  end

  def lookup k, v # not sure what you really want to do here
    p [k, v, (@h[k].index v)]
  end

  self
end.new.lookup 'ABA', 'wow' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T23:54:58.923

我的 2 美分：

```
file = File.open("/path_to_file_here")
recent_key = ""
results = Hash.new
while (line = file.gets)
  key = line[/[A-Z]+/]
  recent_key = key if key
  line.scan(/[a-z]+/).each do |val|
    results[recent_key.to_sym] = [] if !results[recent_key.to_sym]
    results[recent_key.to_sym] << val
  end
end
puts results 
```

这会给你这个输出：

```
{

:AAB=>["鳗鱼", "bbc"],

:ABA=>[“did”、“eye”、“non”、“pap”、“mom”、“ere”、“bob”、“nun”、“eve”、“pip”、“gig”、“ dad”、“nan”、“ana”、“gog”、“aha”、“mum”、“sis”、“ada”、“ava”、“ewe”、“pop”、“tit”、“gag” ，“tat”，“bub”，“pup”，“eke”，“ele”，“hah”，“huh”，“pep”，“sos”，“tot”，“wow”，“aba”，“ ala”、“围兜”、“哑弹”、“tnt”]、

 :ABB=>["all", "see", "off", "too", "ill", "add", "lee", "ass", "err", "xii", "ann", " fee”、“vii”、“inn”、“egg”、“odd”、“bee”、“dee”、“goo”、“woo”、“cnn”、“pee”、“fcc”、“tee” ，“wee”，“落潮”，“edd”，“gee”，“ott”，“ree”，“vee”，“ell”，“orr”，“rcc”，“att”，“boo”，“ cee”、“cii”、“coo”、“kee”、“moo”、“mss”、“soo”、“doo”、“faa”、“hee”、“icc”、“iss”、“itt” , “纪”、“loo”、“mee”、“nee”、“nuu”、“ogg”、“opp”、“pii”、“tll”、“upp”、“voo”、“zee”]

}

```

# ios - iOS 动画 2D 游戏

> ID：14968800
> 
> 赞同：0
> 
> 时间：2013-02-19T22:29:02.933
> 
> 标签：ios, objective-c, animation, scroll

我正在为 iPhone 制作一个 2D 游戏的应用程序。我已经完成了所有的精灵表，但现在我需要特别为其中的一些设置动画：我的游戏是一个你的英雄应该避开一些障碍的游戏。边界应该移动，以通过增加速度来给人一种游戏更加困难的印象（所以英雄看起来越来越快）。我有我的边框图像，但真的不知道如何动态动画它，当图像结束时，将图像的顶部放在它后面。

注意：我知道如何进行翻译，为图像设置动画，但在这里我需要越来越快地对其进行动画处理，以便动态改变动画的速度。

谢谢你的帮助 ！

代码或 UIImageView ：

```
nuages_bas2 = [[UIImageView alloc] initWithFrame:CGRectMake(-100, 0, 160, 1000)];
UIImage * ImageNuages = [UIImage imageNamed:@"Menu_nuage.png"];
nuages_bas2.image = ImageNuages;
nuages_bas2.alpha = 0.0f;
[menu_principale addSubview:nuages_bas2];
[nuages_bas2 release]; 
```

其中一个动画的代码：

```
- (void)AnimationNuagesBas2
{
nuages_bas2.alpha = 1.0f;
CABasicAnimation * nuagesbas2 = [CABasicAnimation animationWithKeyPath:@"transform.translation.y"];
nuagesbas2.fromValue = [NSNumber numberWithFloat:480.0f];
nuagesbas2.toValue = [NSNumber numberWithFloat:-960.0f];
nuagesbas2.duration = 35.0f;
nuagesbas2.repeatCount = 10;
[nuages_bas2.layer addAnimation:nuagesbas2 forKey:@"nuagesbas2"];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T00:26:49.933

首先，如果您正在制作游戏，您可能不应该使用 UIKit，除非它非常简单。你应该看看像[cocos2d这样的库](http://www.cocos2d-iphone.org/)

至于这个问题，你可能想看看[CAKeyframeAnimation](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CAKeyframeAnimation_class/Introduction/Introduction.html)。我将尝试勾勒出一些可以执行此类操作的代码，但您可能想要修改它（另外，我没有办法对其进行测试）。

请注意，下面是一个 hack，其中包括创建一个关键帧动画，其中对象每次来回移动的时间较短。

```
- (void)AnimationNuagesBas2
{
    nuages_bas2.alpha = 1.0f;
    CAKeyframeAnimation * nuagesbas2 = [CAKeyframeAnimation animationWithKeyPath:@"transform.translation.y"];
    float from = [NSNumber numberWithFloat:480];
    float to = [NSNumber numberWithFloat:-960];
    int repeatCount = 10;
    float duration = 6;
    float durationDecrease = 0.5;
    float t = 0;
    NSMutableArray * values = [NSMutableArray array];
    NSMutableArray * times = [NSMutableArray array];
    [values addObject:from];
    [times addObject:[NSNumber numberWithFloat:0]];
    for (int i = 0; i < repeatCount; i++){
        t += duration/2;
    [values addObject:to];
    [times addObject:[NSNumber numberWithFloat:t]];
        t += duration/2;
    [values addObject:from];
    [times addObject:[NSNumber numberWithFloat:t]];
    duration -= durationDecrease;
    }

    [nuages_bas2.layer addAnimation:nuagesbas2 forKey:@"nuagesbas2"];
} 
```

另一种方法是将自己设置为 的委托，`CABasicAnimation`并将其设置为 repeatCount 为 0。然后，每次完成时，您都以更短的持续时间重新启动它。

# php - 发布会话数据时标头重定向未运行的问题

> ID：14968803
> 
> 赞同：1
> 
> 时间：2013-02-19T22:29:25.140
> 
> 标签：php, xml

本质上，我有一个打印表格的页面，填写表格 - 然后用户被重定向到第 3 方支付页面（并且数据通过 xml 请求发送到第 3 方支付页面）。这是应该工作的功能：

```
function redirect_form()
{
  global $pxpay;

  $request = new PxPayRequest();

  $http_host   = getenv("HTTP_HOST");
  $request_uri = getenv("SCRIPT_NAME");
  $server_url  = "http://$http_host";
  #$script_url  = "$server_url/$request_uri"; //using this code before PHP version 4.3.4
  $script_url  = "$server_url$request_uri"; //Using this code after PHP version 4.3.4
  #$script_url = (version_compare(PHP_VERSION, "4.3.4", ">=")) ?"$server_url$request_uri" : "$server_url/$request_uri";

  $MerchantReference = $_REQUEST["Reference"];   
  $StudentName = $_REQUEST["x_name"];
  $Venue = $_REQUEST["x_venue"];
  $Course = $_REQUEST["x_course"];
  $AmountInput = $_REQUEST["x_amount"];
  $Currency = $_REQUEST["x_currency"];
  $Email = $_REQUEST["x_email"];

  #Generate a unique identifier for the transaction
  $TxnId = uniqid("ID");

  #Set PxPay properties
  $request->setMerchantReference($MerchantReference);
  $request->setAmountInput($AmountInput);
  $request->setTxnData1($StudentName);
  $request->setTxnData2($Venue);
  $request->setTxnData3($Course);
  $request->setTxnType("Purchase");
  $request->setCurrencyInput($Currency);
  $request->setEmailAddress($Email);
  $request->setUrlFail($script_url);            # can be a dedicated failure page
  $request->setUrlSuccess($script_url);         # can be a dedicated success page
  $request->setTxnId($TxnId);  

  #The following properties are not used in this case
  # $request->setEnableAddBillCard($EnableAddBillCard);    
  # $request->setBillingId($BillingId);
  # $request->setOpt($Opt);

  #Call makeRequest function to obtain input XML
  $request_string = $pxpay->makeRequest($request);

  #Obtain output XML
  $response = new MifMessage($request_string);

  #Parse output XML
  $url = $response->get_element_text("URI");
  $valid = $response->get_attribute("valid");

   #Redirect to payment page
   header("Location: ".$url);
} 
```

此表单在使用 $_REQUEST 时在示例代码中完美运行，并且如果我注释掉定义每个变量的部分，则表单可以完美发送 - 每个变量也是一个字符串。

我已经完成了将变量定义为纯文本的测试，它仍然有效。

此函数由以下人员调用：

```
if (isset($_POST['StudentName'])) { redirect_form(); } 
```

问题是该页面只是进入一个空白页面 - 应该在哪里进入付款页面。

任何建议，将不胜感激。

编辑：- PHP 错误报告显示：

```
Warning: Cannot modify header information - headers already sent by (output started at /home/becky/public_html/paymentconfirmation.php:244) in /home/becky/public_html/paymentconfirmation.php on line 288 
```

第 244 行是：

```
 $MerchantReference = $_REQUEST["Reference"]; 
```

第 288 行是标题调用：

```
header("Location: ".$url); 
```

我不明白的是，这个问题只有在已经有一个会话开始填写表格时才会出现（我需要这个）。如果您在此页面上开始会话，则没有问题。

如果这是一个简单的问题，请原谅我 - 我试图找到一个已经解决但很困难的类似问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T01:48:18.267

调用您的函数的脚本似乎是页面的一部分，其中标题和输出已发送到浏览器。

如果您使用输出缓冲，则只能在此之后修改标头。您收到的错误告诉我您不是。

```
<?php

/*
 * Establish output buffer, build output string
 */
ob_start();

/* (YOUR ENTIRE SCRIPT / PAGE GOES HERE) */

/*
 * Send output and flush the buffer
 */
ob_end_flush();

?> 
```

# java - 为什么我的 GUI 总是看起来不对？

> ID：14968806
> 
> 赞同：2
> 
> 时间：2013-02-19T22:29:29.670
> 
> 标签：java, user-interface, netbeans, look-and-feel

在 Java 的 Mac 上使用 Netbeans GUI 构建器构建。

这是 Netbeans 中 GUI 的样子：

![Netbeans 图形用户界面](../Images/a9404f5ba4bcb18c7f6c817f29bde47c.png)

当我点击预览时，它看起来并没有太糟糕，但有一些小的变化：

![图形用户界面预览](../Images/a69a6f3ce73e9e2ee325dabb3990fb90.png)

最后，当我运行它时，它看起来像这样： - 可怕

![外观和感觉](../Images/b29ff08a25a77826a0449ccb6b798b62.png)

我认为这与 Java 的“外观和感觉”有关。我试过删除它，GUI 变得一团糟。那么我的选择是什么？正如您在 Netbeans 中看到的那样，当我运行它时，一切都是一团糟。

有任何想法吗？花了一天时间搞砸这个，至少可以说我受够了

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T22:38:03.927

从外观上看，Netbeans 中的预览版使用的*外观与*Java 在运行应用程序时使用的外观不同。
但是，您可以尝试手动设置所需的*外观*。Oracle 提供了一个关于如何获取和设置*外观的*[教程](http://docs.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html)。

 ** * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-19T23:15:06.820

在您的代码中的某些地方，Netbeans 会创建一个`main`方法（这将在 Netbeans 执行的类中，并且可能是您的主框架 - 我认为那将是`SPPMainGUI`）

它看起来像这样（注意它可能是“折叠的”，所以你只会看到第一条评论和`decs`第二条评论（`Look and feel setting code (optional)`））

```
/* Set the Nimbus look and feel */
//<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
/* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
 * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
 */
try {
    for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
        if ("Nimbus".equals(info.getName())) {
            javax.swing.UIManager.setLookAndFeel(info.getClassName());
            break;
        }
    }
} catch (ClassNotFoundException ex) {
    java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
} catch (InstantiationException ex) {
    java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
} catch (IllegalAccessException ex) {
    java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
} catch (javax.swing.UnsupportedLookAndFeelException ex) {
    java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
}
//</editor-fold> 
```

通过单击边距中的小 + 展开代码块并将其替换`for-loop`为`UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());`如下

```
/* Set the Nimbus look and feel */
//<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
/* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
 * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
 */
try {
    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
} catch (ClassNotFoundException ex) {
    java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
} catch (InstantiationException ex) {
    java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
} catch (IllegalAccessException ex) {
    java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
} catch (javax.swing.UnsupportedLookAndFeelException ex) {
    java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
}
//</editor-fold> 
```

当 afsantos 发现问题时，如果你能接受他的回答是正确的，我会很高兴的（并且改为对我投赞成票；），轻推，轻推，眨眼，眨眼，不要再说了）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T23:14:56.247

正如您所提到的，它与外观和感觉有关，所以真的，如果找到 L&F Netbeans 默认使用的唯一问题。谷歌调出了[这个页面](http://www.oracle.com/webfolder/technetwork/tutorials/obe/java/NimbusLookandFeel_OBE2012/CustomizingLandF.html)。我引用，

> 在 NetBeans 7 中，默认外观自动设置为 Nimbus 外观。

[来自甲骨文：](http://docs.oracle.com/javase/tutorial/uiswing/lookandfeel/nimbus.html)

> Nimbus 是在 Java SE 6 Update 10 (6u10) 版本中引入的一种经过优化的跨平台外观。

要启用 Nimbus 外观和感觉，只需在某处添加这些不言自明的行：

```
try {
    for (LookAndFeelInfo info : UIManager.getInstalledLookAndFeels()) {
        if ("Nimbus".equals(info.getName())) {
            UIManager.setLookAndFeel(info.getClassName());
            break;
        }
    }
} catch (Exception e) {
    // If Nimbus is not available, you can set the GUI to another look and feel.
} 
```*

# angularjs - AngularJS HTML5 模式降级为全页重新加载，而不是 hashbang

> ID：14968809
> 
> 赞同：22
> 
> 时间：2013-02-19T22:29:37.030
> 
> 标签：angularjs

通过在 AngularJS 中启用 HTML5 模式，`$location`服务将重写 URL 以从中删除 hashbang。这是一个很棒的功能，可以帮助我处理我的应用程序，但是它回退到 hashbang 模式存在问题。我的服务需要身份验证，我被迫从我的应用程序中使用外部身份验证机制。如果用户尝试访问带有 hashbang 的应用程序的 URL，它将首先将他们重定向到身份验证页面（除非成功通过身份验证，否则永远不会接触我的服务），然后将他们重定向回我的应用程序。由于哈希标签只能从客户端看到，所以当它们到达我的服务器时，它会丢弃路由的任何部分。一旦他们通过身份验证，他们可能会重新输入 URL 并且它会起作用，但它是第一次会导致用户体验中断。

那么我的问题是，有没有什么办法可以从不`$location.html5Mode(true)`支持的浏览器的全页面重新加载的回退，跳过完全在 AngularJS 中路由的 hashbang 方法？

我的目标可用实现的最佳比较是诸如浏览 github.com 上的文件夹之类的东西。如果浏览器支持在不启动页面刷新的情况下重写 URL，则页面将异步加载必要的部分。如果浏览器不支持，当用户点击文件夹时，会发生整页刷新。这可以用 AngularJS 代替使用 hashbang 模式来实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-22T07:06:18.927

不要覆盖核心功能。

使用 Modernizr，进行特征检测，然后进行相应的操作。

**检查历史 API 支持**

```
if (Modernizr.history) {
  // history management works!
} else {
  // no history support :(
  // fall back to a scripted solution like History.js
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T12:24:46.813

尝试在浏览器的 HTML5 History API 检查中包装 $location 和 $routeProvider 配置，如下所示：

```
if (isBrowserSupportsHistoryAPI()) {
    $location.html5Mode(true)
    $routeProvider.when(...);
} 
```

如果您使用它来更改路径，您可能还需要为 $location 创建一个包装器。（对不起糟糕的英语）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-09T22:21:13.063

您可以尝试覆盖 $location 服务的功能。一般的想法是根据某人是否已经过身份验证来重写 URL，或者只对所有 URL 使用单一方法（没有 hashbang），而不管 html5mode 是否打开。

我不确定我是否完全理解用例，所以我无法编写您需要的确切代码。以下是如何覆盖/实现和注册 $location 服务的示例实现，只需确保**始终**消除 hashbang：

```
app.service('$location', [function() {
    var DEFAULT_PORTS = {
        ftp: 21,
        http: 80,
        https: 443
    };

    angular.extend(this, {
        absUrl: function() {
            return location.href;
        },
        hash: function(hash) {
            return location.hash.substr(1);
        },
        host: function() {
            return location.host;
        },
        path: function(path) {
            if (!path) {
                return location.pathname;
            }
            location.pathname = path;
            return this;
        },
        port: function() {
            return location.port ? Number(location.port) : DEFAULT_PORTS[this.protocol()] || null;
        },
        protocol: function() {
            return location.protocol.substr(0, location.protocol.length - 1);
        },
        replace: function() {
            return this;
        },
        search: function(search, paramValue) {
            if (search || paramValue) {
                return this;
            }
            var query = {};
            location.search.substr(1).split("&").forEach(function(pair) {
                pair = pair.split("="); query[pair[0]] = decodeURIComponent(pair[1]);
            });
            return query;
        },
        url: function(url, replace) {
            return this.path();
        }
    });
}]); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-30T20:15:45.600

对于这种情况，为什么不在客户端处理未经身份验证的重定向？我需要更多地了解您的应用程序是如何工作的，以便为您提供更具体的解决方案，但本质上是这样的：

1.  用户转到由 AngularJS 处理的路由，服务器提供 AngularJS 主模板和 javascript
2.  用户未通过身份验证，AngularJS 检测到这一点并重定向到身份验证页面

当 AngularJS 应用程序启动时，您可以在模块的运行块中包含一些内容：

```
module('app',[])
  .configure(...yadda...yadda...yadda...)
  .run(['$location', 'authenticationService', function($location, auth) {
    if (!auth.isAuthenticated()) {
      $location.url(authenticationUrl) 
    }
  }); 
```

我已经加入了一项服务，该服务会查明您是否以某种方式通过了身份验证，取决于您如何检查会话 cookie，可能会点击您的 API 来询问。真正取决于您希望在客户端应用程序运行时如何继续检查身份验证。

# ruby-on-rails - 将类方法范围限定为 current_user

> ID：14968814
> 
> 赞同：0
> 
> 时间：2013-02-19T22:29:44.367
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在实施一个标记系统，但在查询带有范围的标记对象时遇到问题。

例如，我想查找具有特定标签的所有用户项目。使用类方法，我目前可以找到所有对象：

```
def self.tagged_with(name)
  Tag.find_by_name(name).items
end 
```

然而，这有一个问题。如果我要做类似的事情：`current_user.items.tagged_with(name)`这个现有方法不会返回所有项目，而不仅仅是 current_user 拥有的项目吗？我想这是一个简单的查询问题，但我不知道如何将类方法更改为集合上调用的东西。我尝试过相反的方式，通过标签获取集合，例如......`tag.items.where(:user_id => current_user.id)`但在这种情况下，这是一个多对多的关系，我也无法掌握这一点。

限制这样的查询的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:41:27.597

在您的班级上创建一个`User`指向您`Tag`班级的关联。

```
class User < ActiveRecord::Base
  has_many :tags
end 
```

然后你可以这样做： `current_user.tags.where(...)`

如果您尚未建立关联，则需要创建迁移以使表使用外键`tags`引用您的表。`users`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:55:27.357

我认为这会帮助你：

```
 class Account < ActiveRecord::Base
        has_many :people do
            def find_or_create_by_name(name)
                first_name, last_name = name.split(" ", 2)
                find_or_create_by_first_name_and_last_name(first_name, last_name)
            end
        end
    end

    person = Account.first.people.find_or_create_by_name("David Heinemeier Hansson")
    person.first_name # => "David"
    person.last_name    # => "Heinemeier Hansson" 
```

所以，基本上你可以`tagged_with`直接在关联中定义你的方法！

此示例取自文档[ActiveRecord::Associations](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)

# jquery - mouseenter 正在应用于所有元素

> ID：14968822
> 
> 赞同：1
> 
> 时间：2013-02-19T22:30:01.840
> 
> 标签：jquery

我已经编写了一些具有超时功能的 jquery，因此在您将鼠标悬停在元素上一段时间后，会出现一个更多按钮，然后将其悬停以查看有关文章的更多信息。

这一切都可以作为一个单独的元素正常工作，但我会拥有不止一个。

每次我将鼠标悬停在一个上时，效果都会应用于所有元素。

我试过使用 $(this).find('') 但这没有任何效果。

任何人都可以帮忙吗？

这是JS小提琴。

[http://jsfiddle.net/8x429/](http://jsfiddle.net/8x429/)

```
$(document).ready(function () {
// Article hover function   
var myTimeout;

$('.articleContainer').mouseenter(function () {

    myTimeout = setTimeout(function () {

        $('.moreBtn').animate({
            'top': '0px'
        }, 'normal');
        $('.moreBtn').hover(function () {
            $('.moreDetail').animate({
                'top': '0px'
            }, 'slow');
        });

    }, 500);

})

    .mouseleave(function () {
    $('.moreDetail').animate({
        'top': '-335px'
    }, 'fast',

    function () {

        $('.moreBtn').animate({
            'top': '40px'
        }, 'fast');

    });

    clearTimeout(myTimeout);

}); 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:36:07.587

确保您在函数范围闭包之外引用了您想要的项目。

```
$(document).ready(function () {
    // Article hover function   
    var myTimeout;

    $('.articleContainer').mouseenter(function () {
        var article = $(this);
        var moreButton = $(article).find('.moreBtn');
        var moreDetail = $(article).find('.moreDetail');
        myTimeout = setTimeout(function () {

            moreButton.animate({
                'top': '0px'
            }, 'normal');
            moreButton.hover(function () {
                moreDetail.animate({
                    'top': '0px'
                }, 'slow');
            });

        }, 500);

    });

        .mouseleave(function () {
        var article = $(this);
        var moreButton = $(article).find('.moreBtn');
        var moreDetail = $(article).find('.moreDetail');
        moreDetail.animate({
            'top': '-335px'
        }, 'fast',

        function () {

            moreButton.animate({
                'top': '40px'
            }, 'fast');

        });

        clearTimeout(myTimeout);

    });
}); 
```

[jsfiddle](http://jsfiddle.net/ngnqg/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:38:44.887

一个解决方案可能包含以下内容 - （`this`在超时内设置函数外部的变量）

```
$('.articleContainer').mouseenter(function () {
    var el = this;
    myTimeout = setTimeout(function () {
        $(el).find('.moreBtn').animate({
            'top': '0px'
        }, 'normal'); 
```

# assembly - pushl/popl %esp 的汇编级表示是什么？

> ID：14968824
> 
> 赞同：10
> 
> 时间：2013-02-19T22:30:09.587
> 
> 标签：assembly, x86, stack-memory, instruction-set, stack-pointer

我试图了解推送和弹出堆栈指针寄存器的行为。在美国电话电报公司：

```
pushl %esp 
```

和

```
popl %esp 
```

请注意，它们将计算值存储回`%esp`.

我正在独立考虑这些指令，而不是按顺序考虑。我知道存储在其中的值`%esp`始终是递增/递减之前的值，但我怎么能用汇编语言来表示行为呢？到目前为止，这是我想出的。

对于`pushl %esp`（忽略 FLAGS 和对临时寄存器的影响）：

```
movl %esp, %edx     1\. save value of %esp
subl  $4, %esp      2\. decrement stack pointer
movl %edx, (%esp)   3\. store old value of %esp on top of stack 
```

对于`popl %esp`：

```
movl (%esp), %esp   You wouldn’t need the increment portion. 
```

它是否正确？如果没有，我哪里错了？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-19T22:50:58.690

正如英特尔® 64 和 IA-32 架构开发`push esp`人员[手册：组合卷](http://www.intel.com/content/www/us/en/architecture-and-technology/64-ia-32-architectures-software-developer-manual-325462.html)（实际上在第 2 卷，或[https://www.felixcloutier.com/x86/push](https://www.felixcloutier.com/x86/push)上的 HTML 抓取）中所述：

> PUSH ESP 指令压入 ESP 寄存器的值，因为它在指令执行之前就存在。如果 PUSH 指令使用内存操作数，其中 ESP 寄存器用于计算操作数地址，则在 ESP 寄存器递减之前计算操作数的地址。

至于`pop esp`（[https://www.felixcloutier.com/x86/pop](https://www.felixcloutier.com/x86/pop)）：

> POP ESP 指令在将旧堆栈顶部的数据写入目标之前递增堆栈指针 (ESP)。

和`pop 16(%esp)`

> 如果 ESP 寄存器用作寻址内存中目标操作数的基址寄存器，则 POP 指令在 ESP 寄存器**递增后计算操作数的有效地址。**

所以是的，您的伪代码是正确的，除了修改 FLAGS 和`%edx`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-10-08T02:28:44.963

是的，除了对 FLAGS 的影响之外，这些序列是正确的，当然`push %esp`不会破坏`%edx`。相反，如果您想将其分解为单独的步骤，请想象一个内部临时¹`push` ，而不是考虑在执行任何其他操作之前对其输入（源操作数）进行快照的原始操作。

（类似地`pop DST`可以建模为`pop %temp`/ `mov %temp, DST`，所有 pop 的效果在它评估并写入目标之前完成，即使那是或涉及堆栈指针。）

### `push`即使在 ESP 特殊情况下也有效的等价物

（在所有这些中，我假设 SS 配置正常的 32 位兼容或保护模式，堆栈地址大小与模式匹配，如果情况并非如此的话。64 位模式等效于`%rsp`工作与`-8`/相同`+8`。16 位模式不允许`(%sp)`寻址模式，因此您必须将其视为伪代码。）

```
#push SRC         for any source operand including %esp or 1234(%esp)
   mov  SRC, %temp
   lea  -4(%esp), %esp         # esp-=4 without touching FLAGS
   mov  %temp, (%esp) 
```

即`mov SRC, %temp`；`push %temp`
或者因为我们无论如何都在描述一个不可中断的事务（单`push`条指令），所以
我们[不需要在存储之前移动 ESP](https://stackoverflow.com/questions/52258402/is-it-valid-to-write-below-esp)：

```
#push %REG              # or immediate, but not memory source
   mov  %REG, -4(%esp)
   lea  -4(%esp), %esp 
```

（这个更简单的版本不会真正与内存源组装，只有寄存器或立即数，如果中断或信号处理程序在 mov 和 LEA 之间运行，则不安全。在实际组装中，`mov mem, mem`具有两种显式寻址模式是' t 可编码，但`push (%eax)`因为内存目标是隐式的。即使对于内存源，您也可以将其视为伪代码。但是临时快照是内部发生的更现实的模型，例如第一个块或`mov SRC, %temp`/ `push %temp`。）

如果您正在谈论在实际程序中实际使用这样的序列，我认为没有一种方法可以在没有临时寄存器（第一个版本）或（第二个版本）禁用中断或使用红色 ABI 的情况下*完全*复制`push %esp`-区。（就像 x86-64 System V 的非内核代码一样，所以你可以复制`push %rsp`.）

### `pop`等价物：

```
#pop DST   works for any operand
  mov  (%esp), %temp
  lea  4(%esp), %esp      # esp += 4 without touching FLAGS
  mov  %temp, DST         # even if DST is %esp or 1234(%esp) 
```

即`pop %temp`/ `mov %temp, DST`。这准确地反映了`DST`涉及 ESP 的内存寻址模式的情况：使用增量*后的 ESP 值。*我用 ; 验证了英特尔的文档`push $5`；`pop -8(%esp)`. 当我在 Skylake CPU 上的 GDB 中单步执行它时，这会将dword复制`5`到所写的 dword 的正下方。`push`如果`-8(%esp)`在该指令执行之前使用 ESP 进行地址计算，则会有 4 个字节的间隙。

在 的特殊情况下`pop %esp`，是的，它会增加增量，简化为：

```
#pop %esp  # 3 uops on Skylake, 1 byte
   mov  (%esp), %esp             # 1 uop on Skylake.  3 bytes of machine-code size 
```

* * *

### 英特尔手册有误导性伪代码

英特尔在其指令集手册条目（SDM vol.2）的操作部分中的伪代码*不能*准确反映堆栈指针的特殊情况。只有描述部分中的额外段落（在[@nrz 的答案](https://stackoverflow.com/questions/14968824/what-is-an-assembly-level-representation-of-pushl-popl-esp/14969137#14969137)中引用）才能做到这一点。

[https://www.felixcloutier.com/x86/pop](https://www.felixcloutier.com/x86/pop)显示（对于 StackAddrSize = 32 和 OperandSize = 32）加载到 DEST*然后*递增 ESP

```
 DEST ← SS:ESP; (* Copy a doubleword *)
     ESP ← ESP + 4; 
```

但这具有误导性，`pop %esp`因为它意味着 ESP += 4 发生在 ESP = load(SS:ESP) 之后。正确的伪代码将使用

```
 if ... operand size etc.
     TEMP ← SS:ESP; (* Copy a doubleword *)
     ESP ← ESP + 4;

 ..
 // after all the if / else size blocks:
 DEST ← TEMP 
```

[`pshufb`](https://www.felixcloutier.com/x86/pshufb#operation)对于其他指令，例如伪代码开始`TEMP ← DEST`于快照读写目标操作数的原始状态，英特尔获得了这一权利。

同样，[https://www.felixcloutier.com/x86/push#operation](https://www.felixcloutier.com/x86/push#operation)显示 RSP 首先递减，而不显示在此`src`之前快照的操作数。只有文本描述部分中的额外段落才能正确处理这种特殊情况。

* * *

[**AMD 的手册**第 3 卷：通用和系统说明（2021 年 3 月）](https://www.amd.com/system/files/TechDocs/24594.pdf#page=315)对此同样错误（我强调）：

> 将堆栈指针 (SS:rSP) 指向的值复制到指定的寄存器或内存位置 **，然后**将 rSP 递增 2（对于 16 位弹出）、4（对于 32 位弹出）或 8（对于 64 位）流行音乐。

与英特尔不同，它甚至没有记录弹出堆栈指针本身或涉及 rSP 的内存操作数的特殊情况。至少不在这里，并且搜索`push rsp`或`push esp`没有找到任何东西。

（AMD`rSP`根据 SS 选择的当前堆栈大小属性来表示 SP / ESP / RSP。）

AMD没有像英特尔那样的伪代码部分，至少没有像推/弹出这样的简单指令。（有一个用于`pusha`。）

* * *

**脚注 1**：这甚至可能发生在某些 CPU 上（尽管我不这么认为）。例如，在 Skylake 上，[Agner Fog 测得](https://agner.org/optimize/) `push %esp`前端为 2 微秒，而推送任何其他寄存器为 1 微融合存储。

我们确实知道 Intel CPU 确实有一些寄存器像架构寄存器一样被重命名，但只能通过微码访问。例如[https://blog.stuffedcow.net/2013/05/measuring-rob-capacity/](https://blog.stuffedcow.net/2013/05/measuring-rob-capacity/)提到“一些额外的架构寄存器供内部使用”。所以`mov %esp, %temp`/`push %temp`理论上可能是它的解码方式。

**但更可能的解释**是，在长指令*序列*中额外测量的 uops`push %esp`只是**堆栈同步**uops ，就像我们得到的任何时候 OoO 后端在 push/pop 操作后显式读取 ESP 一样。例如`push %eax`/`mov %esp, %edx`也会导致堆栈同步 uop。（“[堆栈引擎](https://stackoverflow.com/questions/36631576/what-is-the-stack-engine-in-the-sandybridge-microarchitecture)”避免了需要额外的 uop`esp -= 4`部分`push`）

`push %esp`有时很有用，例如推送您刚刚保留的一些堆栈空间的地址：

```
 sub   $8, %esp
  push  %esp
  push  $fmt         # "%lf"
  call  scanf
  movsd 8(%esp), %xmm0

  # add $8, %esp    # balance out the pushes at some point, or just keep using that allocated space for something.  Or clean it up just before returning along with the space for your local var. 
```

`pop %esp`在 Skylake 上花费 3 微指令，一个负载 (p23) 和两个 ALU，用于任何整数 ALU 端口 (2p0156)。所以它的效率更低，但它基本上没有用例。您不能有用地保存/恢复堆栈上的堆栈指针；如果您知道如何到达保存位置，则可以使用`add`.

# excel - Excel Application.Ready=False 当通过 COM dll 接收数据时

> ID：14968826
> 
> 赞同：2
> 
> 时间：2013-02-19T22:30:15.983
> 
> 标签：excel, com, excel-addins, vba

我通过 COM dll 使用调度接口将外部数据传递到 Excel 插件。在 VBA 接收器方法中，我检查 Application.Ready = True 之前尝试将数据写入适当的单元格，如下所示，

```
 If Application.Ready = True Then
                With Workbooks(bookName).Sheets(sheetName).Range(rangeName)
                    .Value = thisData
                End With
            Else
                Debug.Print "Dropped Payload"
            End If 
```

我不想只删除数据，所以我尝试做一些事情来让它正确。

*   调用 Application.OnTime 而不是设置值。不幸的是，当 Application.Ready=False 时，Excel 不允许我调用 Application.OnTime。
*   使用[此处](https://stackoverflow.com/questions/8520732/i-dont-want-my-excel-add-in-to-return-an-array-instead-i-need-a-udf-to-change/8711582#8711582)的技术启动 Windows 计时器，然后调用 OnTime。这里的问题是多个事件相互叠加，并且它们都试图同时访问 AfterUDFRoutine1，从而导致崩溃。

所以我最近的想法是将数据放入队列中，然后在Application.Ready=True时清空队列。为了实现这一点，我需要在 Application.Ready 更改状态时触发一个事件，但我在列表中找不到该事件。有谁知道这是否存在以及如何暴露它？或者，如果有人对如何完成这项工作有更好的想法，我非常愿意接受。我不能做的唯一建议是使用 RTD 而不是我已经拥有的调度 - 我不能改变那部分。

提前致谢！

# c - Valgrind 报告“条件跳转取决于未初始化的值”；教授说应该检查字符串

> ID：14968829
> 
> 赞同：0
> 
> 时间：2013-02-19T22:30:25.867
> 
> 标签：c

当 valgrind 运行这个程序（实现一种简单类型的数据压缩）时，它会报告“条件跳转取决于未初始化的值”。它也偶尔会出现段错误。问题是，我似乎无法确定哪个变量未初始化。我的 CS 教授提到“您的代码不能确保字符串正确以空值结尾”，但我看不出在哪里。

[https://gist.github.com/anonymous/9f6c87fb33985606a297](https://gist.github.com/anonymous/9f6c87fb33985606a297)

（编辑 - 在此处添加实际代码：）

```
 #include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define WORDLIM 128
#define REPEAT for(;;)
struct word {
    char *cont;
    char *wsp;  
    int ctr;
}; 

char peekchar(void)
{
    char c;
    c = getchar();
    if(c != EOF) 
        ungetc(c, stdin);

    /* puts it back */    
    return c;
} 

struct word *getword()
{
    char cont[WORDLIM];
    char wsp[WORDLIM];
    cont[0] = '\0';
    wsp[0] = '\0';
    if (peekchar() == EOF) 
    {
        return NULL;
    }

    REPEAT{
        char c = getchar();
        char buf[2];
        buf[0]=c;
        buf[1]='\0';
        if (c == '\n' || c == ' ' || c == EOF)
        {
            if (c != EOF)
                strcat(wsp, buf);
            if (peekchar() != '\n' && peekchar() != ' ')
            {
                struct word *toret;
                toret = malloc(sizeof(struct word));
                toret->cont = malloc(strlen(cont) + 1);
                strcpy(toret->cont, cont);
                toret->wsp = malloc(strlen(wsp) + 1);
                strcpy(toret->wsp, wsp);
                toret->ctr = -1;
                return toret;
            }
            continue;
        }
        else {
            strcat(cont, buf);
            continue;
        }
    }
    printf("PANIC PANIC PANIC THIS IS GOING WROOOOONG!!!!!\n");
}

void numbrify(struct word **wordlist)
{
    int oc = 0;
    int roc = oc;
    struct word *w;
    while ((w = wordlist[oc]) != NULL){
        int ic;
        if (w->ctr == -1){
            for (ic = oc + 1; wordlist[ic] != NULL; ic++){
                if (!strcmp(wordlist[ic]->cont, w->cont)){
                    //printf("**found match between %s and %s**\n", wordlist[ic]->cont, w->cont);
                    wordlist[ic]->ctr = roc;
                }
            }
            if (w->cont[0]!='\0')
        roc++;
        }
        oc++;
    }
} 

int main(void){
    struct word *wlist[4096];
    int i = 0;
    struct word *w;
    for (i = 0; (w = getword()) != NULL; i++){
        wlist[i]=w;
    }

    wlist[i+1] = NULL;
    numbrify(wlist);
    i = 0;
    for (i = 0; wlist[i]!=NULL; i++){
        if (wlist[i]->ctr == -1) 
            printf("%s%s", wlist[i]->cont, wlist[i]->wsp);
        else 
            printf("%d%s", wlist[i]->ctr, wlist[i]->wsp);
            //printf("'%s'\t'%s'\t%d\n", wlist[i]->cont, wlist[i]->wsp, wlist[i]->ctr);
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:40:21.087

在程序的第 85 行：

```
wlist[i+1] = NULL; 
```

`i`已经指向数组中未使用的条目，因此分配`NULL`给`wlist[i+1]`在结束之前留下一个未定义的值。

我通过运行[Clang 静态分析器](http://clang-analyzer.llvm.org/)* 确定了这一点，该分析器在前两个诊断中发现了这个问题（以及一个无关的、无害的错误作为第三个）：

```
14968829.c:62:12: warning: Assigned value is garbage or undefined
        while ((w = wordlist[oc]) != NULL){
                  ^ ~~~~~~~~~~~~
14968829.c:65:35: warning: The left operand of '!=' is a garbage value
                        for (ic = oc + 1; wordlist[ic] != NULL; ic++){
                                          ~~~~~~~~~~~~ ^
14968829.c:87:2: warning: Value stored to 'i' is never read
        i = 0;
        ^   ~ 
```

纠正问题（通过更改`wlist[i+1]`为`wlist[i]`）导致两个 Clang 诊断以及 Valgrind 错误消失。

*： 命令行：`clang --analyze -Wall 14968829.c -o 14968829`

# asp.net-mvc-4 - ASP.NET MVC 4 网站移动版

> ID：14968830
> 
> 赞同：0
> 
> 时间：2013-02-19T22:30:28.297
> 
> 标签：asp.net-mvc-4

我正在使用 ASP.NET MVC4 框架开发一个内部 Web 应用程序，并且我完成了它。现在我想支持 Web 应用程序的移动版本，这样当用户从移动设备浏览网站时，他会***自动***切换到移动版本。

我在这里询问如何组织控制器和视图模型之类的东西。我想使用相同的控制器并根据浏览器代理选择视图。

也因为移动页面不像桌面版那样包含所有数据，视图模型会有所不同。如果有一种***通用的方法***可以将模型传递给视图，那就太好了。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:35:04.347

ASP.NET MVC 4 支持[`Display Mode Providers`](http://www.asp.net/mvc/tutorials/mvc-4/aspnet-mvc-4-mobile-features)允许您拥有移动用户代理的特定视图并共享相同的控制器和模型。例如，您可能有以下视图：

```
Index.cshtml
Index.Mobile.cshtml
Index.iPhone.cshtml
... 
```

根据您配置的用户代理和设备模式提供程序，ASP.NET MVC 将自动为您选择正确的视图。

# ruby-on-rails - 如何将“全局”设置为默认 gemset？

> ID：14968831
> 
> 赞同：-1
> 
> 时间：2013-02-19T22:30:30.137
> 
> 标签：ruby-on-rails, ruby, gem, rvm

在 RVM 中，每次我重新启动它都会说找不到 gem，因为它们都安装在我的“全局”gemset 中。

我怎样才能将其设置为默认值，这样我就不需要每次都切换到该 gemset？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:35:17.637

我实际上浏览了一段时间的文档并没有看到任何东西，但是我通过搜索一堆不同的东西从堆栈溢出中发现了这一点。

首先运行`rvm list`看看你的红宝石

然后跑去`rvm gemset list`看你的宝石

最后，运行`rvm use <desired-ruby-version>@<gemset> --default`

例如：

`rvm use ruby-1.9.3-head@global --default`

# java - KeyListeners 和 KeyBinders 有什么区别？

> ID：14968836
> 
> 赞同：-3
> 
> 时间：2013-02-19T22:30:36.647
> 
> 标签：java, swing, keyboard, keylistener

标题几乎概括了它。我是在程序中使用键盘的新手，想知道是什么让它们与众不同，哪个更易于使用等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T23:08:57.917

`KeyListener`是 AWT 和 Swing 使用的原始机制，允许组件注册对关键事件的兴趣。它是一个低级 API，可提供有关按键事件的大量信息（如修饰符）。

由于多种原因，在大多数情况下不鼓励这种监视关键事件的方法。第一个事实是，为了让组件（通过此 API）接收键事件，它必须是可聚焦的并且具有当前键盘焦点。这是一个陷阱，99% 的问题都与此`KeyListeners`有关。

第二个与代码的外观有关，传统上，使用`KeyListener`将需要您有一个大的`if-else`声明，考虑到各种击键及其潜在的修饰符，随着时间的推移，这可能会变得很麻烦——同样的批评也可能会受到批评`ActionListener`。

Key Bindings 是一个较新的 API（并且是更大的输入绑定 API 的一部分），可用于监视非常具体的键事件。这包括单个按键和修饰符。

Key Bindings 也使用[Actions](http://docs.oracle.com/javase/tutorial/uiswing/misc/action.html) API，这意味着您可以`Action`在程序的许多不同部分重用它们，而无需每次都重新实现逻辑。

从[如何使用键绑定](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)

> 键绑定的替代方法是使用键侦听器。按键侦听器作为键盘输入的低级接口有它们的位置，但对于响应单个按键，按键绑定更合适，并且往往会导致更容易维护的代码。如果要在组件没有焦点时激活键绑定，则键侦听器也很困难。键绑定的一些优点是它们在某种程度上是自我记录的，考虑到包含层次结构，鼓励可重用的代码块（Action 对象），并允许轻松删除、自定义或共享操作。此外，它们使更改绑定到动作的键变得容易。

# javascript - JQuery 本地文件夹浏览按钮

> ID：14968837
> 
> 赞同：0
> 
> 时间：2013-02-19T22:30:36.383
> 
> 标签：javascript, jquery, path, directory

我正在努力寻找一种方法来在我的 JQuery 页面上添加一个按钮，该按钮允许我以“ `<input type='file' />`”浏览器的方式浏览本地驱动器，但它只能通过选择给我文件夹。

我愿意接受任何解决方法，我只想浏览文件夹并在文本框中获取结果路径。

我是 JQuery 的新手，如果你也可以提供一个简单的例子......如果我没有要求太多的话。

提前致谢

马可

# php - Codeigniter：如果日期不在 2 个值之间，则返回 true

> ID：14968841
> 
> 赞同：2
> 
> 时间：2013-02-19T22:30:50.710
> 
> 标签：php, codeigniter, activerecord

我正在使用 codeigniter 为客户建立一个租赁网站。仅当没有租赁期与我的查询匹配时，我才尝试返回 true。基本上有一张出租表，上面有开始日期和结束日期。

我的客户从日期选择器中选择开始日期，结束日期是开始日期后的固定天数。

因此，我想了解在这些日期是否有任何出租物品正在出租，以验证客户是否可以预订该物品。这是我到目前为止所拥有的，我需要使用 Codeigniters 活动记录来完成这一点......

```
function check_product($periodLength) {

     //This is the start time they chose from the picker
    $startTime = $_POST['date'];
     //The period length is a variable of days, so the end date would be their chosen start date plus a certain amount of days...
    $endTime = strtotime('+'.$periodLength.'day', $startTime);

    $this->db->where('productsId', $_POST['productId']);
           //This is where I need help!!! What query would give me records that are NOT between the start and end dates that i'm wanting
    $query = $this->db->get('rentals');
    $data = array();

    foreach ($query->result() as $row) {
    $data[] = array(
        'id' => $row->id,
        'customerId' => $row->customerId,
        'productsId' => $row->productsId,
        'periodStart' => $row->periodStart,
        'periodEnd' => $row->periodEnd,
        'status' => $row->status,
        'specialInstructions' => $row->specialInstructions,
        'adminNotes' => $row->adminNotes
    );
    }
    return $data;
} 
```

我确定我的大部分问题都在我的脑海中，但我需要弄清楚我的开始日期到结束日期期间是否已经保留。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T06:04:06.607

试试这个：

```
 $startTime = $_POST['date'];
    $endTime = strtotime('+'.$periodLength.'day', $startTime);

    $this->db->where('productsId', $_POST['productId']);
    $this->db->where(" $startTime NOT BETWEEN periodStart AND periodEnd AND $endTime NOT BETWEEN periodStart AND periodEnd OR ($startTime < periodStart AND $endTime > periodEnd) ");
    //Since this is a complex where clause i would recommend 
    //to put enitre clause in single where statement rather than 
    //putting in different where statement. 
    //And it is upto codeigniter active record standards

     $query = $this->db->get('rentals'); 
```

# html - 我无法在其容器内正确对齐导航菜单

> ID：14968842
> 
> 赞同：0
> 
> 时间：2013-02-19T22:30:51.010
> 
> 标签：html, css

我附上了一张图片，这样你就可以看到我收到了什么样的问题。我希望导航菜单与导航容器对齐，以便它们显示为相同的元素。图片显示了导航菜单“E-MAIL”的最后一个元素，然后它所在的容器只是一个黄色条带（如下面的代码所示）。

我曾尝试在导航容器上使用负边距，但目前还没有解决方案。

[网页图形 http://jaylefler.com/webgraphic.png](http://jaylefler.com/webgraphic.png)

```
 <!DOCTYPE html>
    <html>
    <head>
        <title>css example</title>

    <style type="text/css">

    #logo {
        background-color: black;
        width: 100%;
        color: rgb(255,200,0);
    }

    #logo img {
        padding: 10px;
    }

    body {
        font-family: Arial, Helvetica, Verdana;
        margin: 0;
    }

    #contents {
        border: 2px solid black;
        border-radius: 15px;
        box-shadow: 6px 6px 4px 4px #000;
        width: 90%;
        min-height: 650px;
        margin: 0 5%;
        margin-top: 15px;
        padding: 15px;
    }

    #navMenu {
        width: 760px;
        height: 30px;
        background-color:rgb(255,200,0);
        border:1px #000 solid;
        font-weight:bold;
        margin-left: -2px;
    }

    #navMenu ul{
        margin:-1px 0 0 0;
        padding:0;
        line-height:32px;
    }

    #navMenu li{
        margin:0;
        padding:0;
        list-style:none;
        position:relative;
        background-color:rgb(255,200,0);
        float:left;
        border:1px #000 solid;
    }

    #navMenu ul li a{
        text-align:center;
        text-decoration:none;
        height:30px;
        width:150px;
        display:block;
        color:#000;
    }

    #navMenu ul ul{
        position:absolute;
        visibility:hidden;
        top: 31px;
        margin-left: -2px;  
    }

    #navMenu ul li:hover ul{
        visibility: visible;
    }

    #navMenu a:hover {
        background-color:#000;
        color:rgb(255,200,0);
    }

    .left_part {
        background:black;
    }

    .right_part {
       background:yellow;   
       float:right;
       white-space:nowrap;
       display:inline;
       text-overflow:ellipsis;
       overflow:hidden;
    }

    #navContainer {
        background-color:rgb(255,200,0);
        width:100%
        margin-top:-3x;
        padding:0;
        border:1px solid;
        height:31px;
        clear:left;

    }

    </style>

    </head>

    <body>

    <div id="logo">

        <div class="left_part">
            <img src="demo.gif">
        </div>

        <div class="right_part">

        </div>

    </div>

    <div id="navContainer">
        <div id="navMenu">
            <nav>
                <ul>
                    <li><a href="#">HOME</a></li>
                    <li><a href="#">PROFILE</a></li>
                    <li><a href="#">MANAGE SUB</a>
                    <ul>
                        <li><a href="#">VIEW TITLES</a></li>
                        <li><a href="#">ADD TITLE</a></li>
                        <li><a href="#">MODIFY TITLE</a></li>
                        <li><a href="#">REMOVE TITLE</a></li>
                    </ul>
                    </li>
                    <li><a href="#">NEW RELEASES</a></li>
                    <li><a href="#">E-MAIL</a></li>
                </ul>
            </nav>
        </div>
    </div>

    <div id="contents">

        <p>This is just some dummy text. </p>

    </div>

    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:35:01.130

```
#navmenu {
    width: 760px;
    height: 30px;
    background-color: #FFC800;
    border: 1px black solid;
    border-top: 0; /* REMOVE TOP BORDER */
    margin-left: -2px;
}
#navContainer {
    background-color:rgb(255,200,0);
    width:100%
    height: 30px; /* MATCH HEIGHT */
    margin-top:-3x;
    padding:0;
    border:1px solid;
    height:31px;
    clear:left;

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:44:34.687

我做了一点清理工作。由于我没有您的徽标图像，因此我删除了那部分代码，我想您将设法自己添加。

这是解决您的问题的简化代码：

```
<!DOCTYPE html>
<html>
<head>
    <title>css example</title>

<style type="text/css">

body {
    font-family: Arial, Helvetica, Verdana;
    margin: 0;
    padding: 0;
}

#contents {
    border: 2px solid black;
    border-radius: 15px;
    box-shadow: 6px 6px 4px 4px #000;
    width: 90%;
    min-height: 650px;
    margin: 0 5%;
    margin-top: 15px;
    padding: 15px;
}

nav {
    width: 100%;
    height: 30px;
    background-color:rgb(255,200,0);
    border-bottom:1px solid #000;
}

nav ul{
    padding:0;
    margin: 0;
    overflow: hidden;
}

nav > ul{
    min-width: 755px;
}

nav ul li{
    float: left;
    margin:0;
    padding:0;
    list-style:none;
    background-color:rgb(255,200,0);
    border-right:1px solid #000;
}

nav ul li a{
    text-align:center;
    text-decoration:none;
    width:150px;
    height: 25px;
    padding-top: 5px;
    display:block;
    color:#000;
}

nav ul li ul{
    position:absolute;
    visibility:hidden;
    top: 31px;
    border-bottom: 1px solid #000;
    border-left: 1px solid #000;
    margin-left: -1px;  
}

nav ul li:hover ul{
    visibility: visible;
}
nav ul li ul li {
    float: none;
}

nav a:hover {
    background-color:#000;
    color:rgb(255,200,0);
}

</style>

</head>

<body>
<nav>
    <ul>
        <li><a href="#">HOME</a></li>
        <li><a href="#">PROFILE</a></li>
        <li><a href="#">MANAGE SUB</a>
        <ul>
            <li><a href="#">VIEW TITLES</a></li>
            <li><a href="#">ADD TITLE</a></li>
            <li><a href="#">MODIFY TITLE</a></li>
            <li><a href="#">REMOVE TITLE</a></li>
        </ul>
        </li>
        <li><a href="#">NEW RELEASES</a></li>
        <li><a href="#">E-MAIL</a></li>
    </ul>
</nav>

<div id="contents">

    <p>This is just some dummy text. </p>

</div>

</body>
</html> 
```

# eclipse - 如何在 Tycho SWTBot 测试运行时中使用我的 RCP 应用程序添加插件

> ID：14968845
> 
> 赞同：5
> 
> 时间：2013-02-19T22:31:04.707
> 
> 标签：eclipse, testing, eclipse-rcp, tycho, swtbot

我的 RCP 是在 3.x Eclipse 上创建的，现在使用兼容层在 4.x 上。这是我的设置：我有两个插件：`xyz-plugin`和`xyz-rcp-plugin`. 我的 RCP 应用程序由这两个插件组成。我有一个测试片段 ( `xyz-test`)，其主机插件是`xyz-plugin`并包含 SWTBot 测试。我的产品配置指向的 plugin.xml 中定义的应用程序`xyz-rcp-plugin`。

当我通过 Eclipse 运行 SWTBot 测试时，一切正常。我将它指向主选项卡上的正确应用程序，它会启动正确的应用程序。

当我尝试通过 Maven 运行它时（`mvn integration-test`使用

我觉得这种情况正在发生，因为我的测试片段仅`xyz-plugin`作为它的主机，因此知道它的依赖关系，但应用程序实际上包含在其中，`xyz-rcp-plugin`所以我猜它不会将该插件带入测试工作区。事实上，当我`<application>`在我的 pom 文件中省略配置时，测试就会运行；它简单地启动了默认的 Eclipse SDK。

那么，如果带有应用程序的插件不是测试插件的依赖项，我怎样才能让 SWTBot 测试运行我的应用程序呢？

* * *

下面是我的测试片段的 pom 文件，

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>com.xyz</groupId>
        <artifactId>all</artifactId>
        <version>1.0.0-SNAPSHOT</version>
    </parent>
    <artifactId>com.xyz.test</artifactId>
    <packaging>eclipse-test-plugin</packaging>

    <properties>
        <ui.test.vmargs></ui.test.vmargs>
    </properties>

    <profiles>
        <profile>
            <id>macosx</id>
            <activation>
                <os>
                    <family>mac</family>
                </os>
            </activation>
            <properties>
                <ui.test.vmargs>-XstartOnFirstThread</ui.test.vmargs>
            </properties>
        </profile>
    </profiles>

    <build>
        <plugins>
            <plugin>
                <groupId>org.eclipse.tycho</groupId>
                <artifactId>tycho-surefire-plugin</artifactId>
                <version>${tycho-version}</version>
                <configuration>
                    <useUIHarness>true</useUIHarness>
                    <useUIThread>false</useUIThread>
                    <product>com.xyz.rcp.product</product>
                    <application>com.xyz.rcp.Application</application>
                    <argLine>${ui.test.vmargs}</argLine>
                    <dependencies>
                        <dependency>
                            <!-- explicit dependency is only needed because SWTbot brings its 
                                own hamcrest bundle which conflicts with the one from junit in the eclipse 
                                platform -->
                            <type>p2-installable-unit</type>
                            <artifactId>org.hamcrest</artifactId>
                            <version>0.0.0</version>
                        </dependency>
                    </dependencies>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-dependency-plugin</artifactId>
                <executions>
                    <execution>
                        <id>unpack-xyz</id>
                        <phase>compile</phase>
                        <goals>
                            <goal>unpack-dependencies</goal>
                        </goals>
                        <configuration>
                            <excludeTransitive>true</excludeTransitive> 
                            <includeTypes>tar.gz</includeTypes>
                            <outputDirectory>${project.build.directory}/work</outputDirectory>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
</project> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T13:13:13.247

Tycho 不会自动将定义配置的包添加`<application>`到测试运行时 - 您需要手动确保包含此包。

一种方法是在测试项目的 pom.xml 中指定额外的依赖项。通过这种方式，您可以将捆绑包甚至整个功能（一如既往，包括传递依赖项）添加到测试运行时。

示例 pom.xml 片段：

```
<plugin>
  <groupId>org.eclipse.tycho</groupId>
  <artifactId>target-platform-configuration</artifactId>
  <version>${tycho-version}</version>
  <configuration>
    <dependency-resolution>
      <extraRequirements>
        <requirement>
          <type>eclipse-plugin</type>
          <id>xyz-rcp-plugin</id>
          <versionRange>0.0.0</versionRange>
        </requirement>
      </extraRequirements>
    </dependency-resolution>
  </configuration>
</plugin> 
```

# php - 警告：mysql_result() 期望参数 1 是资源，布尔值在第 6 行的 /home/roscapex/public_html/core/functions/users.php 中给出

> ID：14968847
> 
> 赞同：-2
> 
> 时间：2013-02-19T22:31:09.310
> 
> 标签：php, mysql, database

我正在尝试创建登录/注册系统，但我不断收到错误消息：警告：mysql_query() 期望参数 2 是资源，在第 8 行的 /home/roscapex/public_html/core/functions/users.php 中给出的整数

> 警告：mysql_result() 至少需要 2 个参数，1 个在 /home/roscapex/public_html/core/functions/users.php 的第 8 行给出

我的代码是：

```
<?php
function user_exists($username) {

$username = sanitize($username);

$query = mysql_query("SELECT COUNT(`user_id`) FROM `users` WHERE `username` = '$username'");

return (mysql_result(mysql_query($query, 0) == 1) ? true : false);

}
?> 
```

*注意*这可能是重复的，但我尝试了所有其他相关问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:16:12.083

您的代码中有多个错误。让我注释它：

```
<?php
function user_exists($username) {

$username = sanitize($username);

$query = mysql_query("SELECT COUNT(`user_id`) FROM `users` WHERE `username` = '$username'"); // $query now contains the result of the query (a Resource)

// Here you try to run the resource *again* trough mysql_query, with with 2 parameters (which results in the warning). I am not quite sure what you intended.
return (mysql_result(mysql_query($query, 0) == 1) ? true : false);

}
?> 
```

我修好了它。

```
<?php
function user_exists($username) {
  $username = sanitize($username);  // This hopefully santizes the username. Better use mysql_real_escape_string($username)

  $query = "SELECT COUNT(`user_id`) FROM `users` WHERE `username` = '$username'";

  $result = mysql_query($query) or die(mysql_error());  // Check if query was successful
  $row = mysql_fetch_array($result); // fetch the first row
  return ($row[0] > 1);  // If there is one or more users with this name, return true.

}
// omit the closing ?>, because it causes trouble, when there are any chars behind it (headers alreay sent error etc.) 
```

# c - 子进程等待父进程然后它执行，然后在 C linux 中反之亦然

> ID：14968848
> 
> 赞同：0
> 
> 时间：2013-02-19T22:31:15.050
> 
> 标签：c, linux, ubuntu, parent-child, shared-memory

我在 C 中创建一个父子进程，这些进程使用字符数组作为共享内存，我希望执行按此顺序进行

### 父->子->父->子->父->子

....等等，我`Wait(NULL)`在父母中使用，但执行顺序是

### 父->子->父->父->父....

我试图在没有信号量或其他任何东西的情况下做到这一点我仍然是一个新手 Linux 程序员

```
int main(void)
{
    if (fork( ) == 0)
    { //child
        if( (id = shmget(key, sizeof(char[n]), 0)) == -1 )
        {
            exit(1);
        }
        shm = shmat(id, 0, 0);
        if (shm == (char *) -1)
            exit(2);
        .......................//some work
        ..........................
    }
    else //parent
    {
            if( (id = shmget(key, sizeof(char[n]), 0666 | IPC_CREAT)) == -1 )
            {
                exit(1);
            }
            shm = shmat(id, 0, 0); //attach shared memory to pointer
            if (shm == (char *) -1)
                exit(2); //error while atatching
                        ....
                        .....
        do
        {
            //parent turn here
            wait(NULL);
                        ....................................
                        //some work ..................
        }
        while(done!=1);
        shmdt(NULL);
        if( shmctl(id, IPC_RMID, NULL) == -1 )//delete the shared memory
        {
            perror("shmctl");
            exit(-1);
        }
    }
    exit(0);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:44:20.613

1.  您可能想在调用 fork() 之前调用 shmget(IPC_CREAT)，因为 POSIX 不保证调用后的执行顺序，因此子进程中的 shmget() 可能会失败，因为父进程没有机会创建共享段。

2.  wait() 等待子进程结束。它不用于在父进程和子进程之间进行调度。

3.  你到底想做什么？

# c++ - 制作板的副本

> ID：14968852
> 
> 赞同：0
> 
> 时间：2013-02-19T22:31:35.703
> 
> 标签：c++, pointers, memory-management, copy

我正在尝试制作棋盘游戏，因为每一步都必须有效，所以我正在制作棋盘的副本并进行移动，以便我可以验证该移动是否有效。

首先，我将棋盘上的所有位置初始化为 0（**遍历**棋盘并将每个 p 设置为 0

```
 pair<int, int> p(y, x); 
 board_[p] = 0; 
```

这是抄板法

```
void Board::copy(Board & gb) {
for (int y = MIN_Y; y <= MAX_Y; ++y) {
    for (int x = MIN_X; x <= MAX_X; ++x) {
        pair<int, int> p(y, x); 
        if (gb.board_.at(p) != 0) {
            board_[p] = new Pieces(*gb.board_.at(p));  // **where I am confused**
        } else {
            board_[p] = 0;
        }   
    }
}
} 
```

我在 Board 中的容器是：

```
map<pair<int,int>, Pieces*> board_; 
```

现在在一个游戏方法中，我复制了棋盘

```
unsigned int play(Board & b){
   b.copy(*this);
} 
```

我的问题：两者

```
board_[p] = new Pieces(*gb.board_.at(p)); //Pieces is a class I defined 
```

和

```
board_[p] = gb.board_.at(p); 
```

编译没有任何错误或警告。我应该使用哪一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:39:49.387

这是一个*浅*拷贝：

```
board_[p] = gb.board_.at(p); 
```

这是一个*深*拷贝：

```
board_[p] = new Pieces(*gb.board_.at(p)); 
```

第一个仅复制一个指针，因此对 in 中的片段的`board_`更改将导致对 in 中的同一片段的更改`gb.board_`。第二个实际上是复制数据，因此更改是隔离的。

使用哪个取决于您的应用程序。如果您希望更改传播，那么浅拷贝。否则，您将需要一个深层副本。

值得注意的是，您的代码片段使您看起来面临严重内存泄漏的风险。你正在创作`new`作品，但从不制作`delete`它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:42:26.777

任何一个都可能是正确的，但您可能想要第一个。第一个将把每一个都复制`Pieces`到新的板上——这被称为深拷贝。第二个只会复制指向每个指针的指针`Pieces`，因此两个板都指向同一组`Pieces`——这是一个浅拷贝。

然而，这里有一个更大的问题。您正在定义一个`copy`函数，但 C++ 为我们提供了一种语言特性来执行此操作 - 复制构造函数。您应该改为定义一个函数，如下所示：

```
Board::Board(const Board& other_board) {
  // Copy everything from other_board to this board
} 
```

你会像这样使用它：

```
Board board;
Board newBoard(b); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T22:37:47.607

那么， board_[p] 可以是指向 Pieces 的指针吗？

那么第一个是正确的。第二个是零件编号（据我了解，不是您真正打算分配的指针）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T22:39:57.463

由于您不想修改原始文件，因此您需要一个深层副本。第二个是浅拷贝。所以你需要第一个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-19T22:42:58.593

第一个将进行深拷贝，即复制对象（克隆它们），而第二个将进行浅拷贝，即复制指向对象的指针。在后一种情况下，您必须使用具有对相同`Piece`对象实例的引用的板。这样做的问题是，如果其中一个板删除了碎片，另一个将指向悬空内存。

# mysql - MySQL - 将电话单词转换为数字

> ID：14968853
> 
> 赞同：0
> 
> 时间：2013-02-19T22:31:37.520
> 
> 标签：mysql

非常像 MySQL 菜鸟，所以如果我问一个明显的问题，请原谅我。

我的问题是我必须将电话号码从文本字段转换为整数。文本字段一直是自由文本，因此用户可以输入他们想要的内容。我已经处理了 90% 的行（空格、非 alpha 等），但我坚持翻译 0800“单词”——即 0800PHONEME 需要转换为 08007466363。我需要在0800 号码。

如果可能的话，我想在数据库级别执行此操作

请问有什么想法/建议吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T23:06:13.337

我认为您最好的选择是使用 UDF（用户定义的函数）[`REGEXP_REPLACE`](https://launchpad.net/mysql-udf-regexp)来查找和替换 alpha。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T23:17:46.723

2号：

```
UPDATE `t_contact` SET `c_phonenumber` = REPLACE(UPPER(`c_phonenumber`),'A','2');
UPDATE `t_contact` SET `c_phonenumber` = REPLACE(UPPER(`c_phonenumber`),'B','2');
UPDATE `t_contact` SET `c_phonenumber` = REPLACE(UPPER(`c_phonenumber`),'C','2'); 
```

3号：

```
UPDATE `t_contact` SET `c_phonenumber` = REPLACE(UPPER(`c_phonenumber`),'D','3');
UPDATE `t_contact` SET `c_phonenumber` = REPLACE(UPPER(`c_phonenumber`),'E','3');
UPDATE `t_contact` SET `c_phonenumber` = REPLACE(UPPER(`c_phonenumber`),'F','3'); 
```

等等...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T23:00:19.790

我希望我有机会/时间来完成这个例子，但你应该明白：

[http://sqlfiddle.com/#!2/73482/1](http://sqlfiddle.com/#!2/73482/1)

只需继续链接所有数字的替换功能。

# java - GWT 的 JSR 303 验证是否适用于 AutoBeans？

> ID：14968854
> 
> 赞同：2
> 
> 时间：2013-02-19T22:31:42.850
> 
> 标签：java, validation, gwt, autobean

GWT 的最新版本支持[JSR 303 Bean Validation](https://developers.google.com/web-toolkit/doc/latest/DevGuideValidation)。

我四处寻找，但我还没有找到任何关于这是否适用于 AutoBeans 的信息。

有任何想法吗？

提前谢谢！

# bash - zenity 输入文件有几行

> ID：14968855
> 
> 赞同：1
> 
> 时间：2013-02-19T22:31:50.870
> 
> 标签：bash, input, line, cat, zenity

我的 zenity 有问题，我无法锻炼。你们能帮帮我吗？

我有一个 7 行长的 tmp3 文件：

```
AAA
BBB
...
FFF
GGG 
```

我想通过 zenity 发送这个文件，以便它显示一个清单，可以用我想要的每个组合检查我想要的每一行。

我之前写过：

```
cat tmp3 | zenity --list \
                  --column='#' \
                  --text "Select playlist from the list below" \
                  --title "Please select one or more playlists" \
                  --multiple \
                  --width=300 \
                  --height=300 \
                  --checklist \
                  --column "Select" \
                  --separator="/ ") 
```

所有这一切都是在 zenity 中创建一个包含所有 7 个 tmp3 文件的单行。那不是我想要的。

我目前是这样写的：

```
choice=$(zenity --list \
                --column "Playlists" FALSE $(cat tmp3) \
                --text "Select playlist from the list below" \
                --title "Please select one or more playlists" \
                --multiple \
                --width=300 \
                --height=300 \
                --checklist \
                --column "Select" \
                --separator="/ ") 
```

这里发生了一些我不明白的非常奇怪的事情。zenity 中创建了 7 个字段中的 4 个：AAA CCC EEE 和 GGG。但不是其他的。当我设置 -x 进行调试时，我可以看到所有 7 行都通过管道传输到 zenity ......发生了什么事？？？？？？

我尝试了另一种解决方案，列出了我当前文件夹中的 7 个子文件夹（恰好与 tmp3 中的行具有完全相同的名称）。发生同样的事情！：

我写了这个：

```
choice=$(zenity --list \
                --column "Playlists" FALSE $(ls -d -1 */) \
                --text "Select playlist from the list below" \
                --title "Please select one or more playlists" \
                --multiple \
                --width=300 \
                --height=300 \
                --checklist \
                --column "Select" \
                --separator="/ ") 
```

第二种解决方案似乎更容易，但我的技能不是很高。我想了解后一种解决方案以及它为什么这样做。

感谢你们！

编辑：我找到了这个并试图让它按照我的方式工作，但到目前为止没有成功...... [http://www.linuxquestions.org/questions/programming-9/reading-lines-to-an-array-and-生成-动态-zenity-list-881421/](http://www.linuxquestions.org/questions/programming-9/reading-lines-to-an-array-and-generate-dynamic-zenity-list-881421/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-12T14:05:29.770

该部分`FALSE $(cat tmp3)`扩展为

```
FALSE AAA
BBB
CCC
DDD
EEE
FFF
GGG 
```

你需要的是

```
FALSE AAA
FALSE BBB
FALSE CCC
FALSE DDD
FALSE EEE
FALSE FFF
FALSE GGG 
```

实现这一目标的一种方法是`--column "Playlists" $(sed s/^/FALSE\ / tmp3) \`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-29T21:06:37.787

我知道我有点晚了，但想要的只是同样的事情，最后想通了。我的解决方案进行搜索（隐藏错误），为每个结果添加 TRUE 和换行符（这是关键！），然后将结果发送到 zenity：

```
CHECKED=`find /music/folder -name "*.mp3" -type f 2>/dev/null | \
         awk '{print "TRUE\n"$0}' | \
         zenity --list --checklist --separator='\n' --title="Select Results." \
                --text="Finding all MP3 files..." --column="" --column="Files"` 
```

在你的情况下，我想这应该是：

```
CHECKED=`cat tmp3 | awk '{print "TRUE\n"$0}' | zenity --list --checklist \
         --separator='/ ' --title="Select Results." \
         --text="Finding all MP3 files..." --column="" --column="Select"` 
```

因此，Zenity 似乎将每个换行符放在一列中，并以这种方式填充列表。这意味着您可以操纵进入 Zenity 的字符串以添加任意数量的列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-13T11:07:05.373

简而言之，您有两种选择：

**选项一：** 输入文件，换行分隔列

代替

```
cat tmp3 | zenity ... ... 
```

做：

```
sed 's/^/.\n/' tmp3 | zenity ... ... 
```

**选项二：**内联命令，列从命令 args 中成对读取

代替

```
cat tmp3 | zenity ... ... 
```

做：

```
zenity ... ... `sed 's/^/. /' tmp3` 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T22:38:52.053

有一个有趣的例子`man zenity`：

```
zenity \
    --list \
    --checklist \
    --column "Buy" \
    --column "Item" \
    TRUE Apples \
    TRUE Oranges \
    FALSE Pears \
    FALSE Toothpaste 
```

你只需要打开一个神经元来适应它=）

![你能行的](../Images/de48125a1b105a626674afe24f6d275d.png)

**编辑**：

如果你有一个未定义的长度列表，这个例子会更有趣：

```
find . -name '*.h' |
zenity \
    --list \
    --title "Search Results" \
    --text "Finding all header files.." \
    --column "Files" 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-11-24T13:45:36.620

```
$ zenity --list --checklist --height 400 --text "Select playlist from the list below" --title "Please select one or more playlists" --column "Playlists" --column "Select" --separator="/ "  
$(ls -d -1 */ | xargs -L1 echo FALSE) 
```

# opengl - 在 OpenGL 应用程序中控制 FPS 限制

> ID：14968857
> 
> 赞同：18
> 
> 时间：2013-02-19T22:32:02.990
> 
> 标签：opengl, 3d, frame-rate

我正在尝试找到一种可靠的方法来准确设置我希望我的 OpenGL 应用程序在屏幕上呈现多少 FPS。我可以在某种程度上通过休眠 1000/fps 毫秒来做到这一点，但这并没有考虑到渲染所需的时间。将 fps 限制在所需数量的最一致的方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-19T22:39:01.980

您可以在 opengl 中使用 wglSwapIntervalEXT 同步到 vblank。它不是很好的代码，但它确实有效。

[http://www.gamedev.net/topic/360862-wglswapintervalext/#entry3371062](http://www.gamedev.net/topic/360862-wglswapintervalext/#entry3371062)

```
bool WGLExtensionSupported(const char *extension_name) {
    PFNWGLGETEXTENSIONSSTRINGEXTPROC _wglGetExtensionsStringEXT = NULL;

    _wglGetExtensionsStringEXT = (PFNWGLGETEXTENSIONSSTRINGEXTPROC)wglGetProcAddress("wglGetExtensionsStringEXT");

    if (strstr(_wglGetExtensionsStringEXT(), extension_name) == NULL) {
        return false;
    }

    return true;
} 
```

和

```
PFNWGLSWAPINTERVALEXTPROC       wglSwapIntervalEXT = NULL;
PFNWGLGETSWAPINTERVALEXTPROC    wglGetSwapIntervalEXT = NULL;

if (WGLExtensionSupported("WGL_EXT_swap_control"))
{
// Extension is supported, init pointers.
    wglSwapIntervalEXT = (PFNWGLSWAPINTERVALEXTPROC)wglGetProcAddress("wglSwapIntervalEXT");

// this is another function from WGL_EXT_swap_control extension
    wglGetSwapIntervalEXT = (PFNWGLGETSWAPINTERVALEXTPROC)wglGetProcAddress("wglGetSwapIntervalEXT");
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-19T22:41:44.577

由于 OpenGL 只是一个低级的图形 API，因此您不会在 OpenGL 中直接找到类似的东西。

但是，我认为您的逻辑有点缺陷。而不是以下内容：

1.  并条框
2.  等待 1000/fps 毫秒
3.  重复

你应该做这个：

1.  启动计时器
2.  并条框
3.  停止计时器
4.  等待 (1000/fps - (stop - start)) 毫秒
5.  重复

这样，如果您只等待您应该等待的数量，并且您最终应该非常接近每秒 60（或任何您的目标）帧。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-10-23T12:29:49.047

OpenGL 本身没有任何允许限制帧速率的功能。时期。

然而，在现代 GPU 上，有很多功能涵盖帧速率、帧预测等。John Carmack 提出了一些问题，他推动了一些功能可用。还有 NVidia 的自适应同步。

这一切对你意味着什么？把它留给GPU。假设绘图是完全不可预测的（当您只坚持使用 OpenGL 时应该这样做），您自己为事件计时并将逻辑更新（例如物理）与绘图分开。这样，用户将能够从所有这些先进技术中受益，而您不必再担心这一点。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-10-30T03:12:54.210

不要使用睡眠。如果你这样做了，那么你的应用程序的其余部分必须等待它们完成。

相反，跟踪已经过去了多少时间并仅在达到 1000/fps 时才进行渲染。如果没有达到计时器，跳过它并做其他事情。

在单线程环境中，很难确保您以 1000/fps 的速度精确绘制，除非这绝对是您唯一要做的事情。一种更通用和更强大的方法是将所有渲染都在一个单独的线程中完成，并在计时器上启动/运行该线程。这是一个更复杂的问题，但会让你最接近你的要求。

此外，跟踪发布渲染需要多长时间将有助于即时调整渲染的时间。

```
static unsigned int render_time=0;
now = timegettime();
elapsed_time = last_render_time - now - render_time;
if ( elapsed_time > 1000/fps ){
    render(){
        start_render = timegettime();

        issue rendering commands...

        end_render = timegettime();
        render_time = end_render - start_render;
    }
    last_render_time = now;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-30T09:02:37.027

把它放在绘制和调用交换缓冲区之后：

```
//calculate time taken to render last frame (and assume the next will be similar)
thisTime = getElapsedTimeOfChoice(); //the higher resolution this is the better
deltaTime = thisTime - lastTime;
lastTime = thisTime;

//limit framerate by sleeping. a sleep call is never really that accurate
if (minFrameTime > 0)
{
    sleepTime += minFrameTime - deltaTime; //add difference to desired deltaTime
    sleepTime = max(sleepTime, 0); //negative sleeping won't make it go faster :(
    sleepFunctionOfChoice(sleepTime);
} 
```

如果你想要 60fps，`minFrameTime = 1.0/60.0`（假设时间以秒为单位）。

这不会为您提供 vsync，但意味着您的应用程序不会失控，这可能会影响物理计算（如果它们不是固定步长）、动画等。请记住**在睡眠*****后*****处理输入***！我尝试过尝试平均帧时间，但到目前为止效果最好。*

 *因为`getElapsedTimeOfChoice()`，我使用[这里](https://stackoverflow.com/a/275231/1888983)提到的内容，即

*   LINUX：[`clock_gettime(CLOCK_MONOTONIC, &ts);`](http://linux.die.net/man/3/clock_gettime)
*   视窗：[`QueryPerformanceCounter`](https://stackoverflow.com/questions/1739259/how-to-use-queryperformancecounter)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-24T20:05:45.903

另一个想法是使用 WaitableTimers （如果可能，例如在 Windows 上）

基本思想：

```
while (true) 
{ 
    SetWaitableTimer(myTimer, desired_frame_duration, ...); 
    PeekMsg(...) 
    if (quit....) break; 
    if (msg)
        handle message; 
    else 
    { 
        Render(); 
        SwapBuffers();
    }
    WaitForSingleObject(myTimer); 
} 
```

更多信息：[如何限制 fps 信息](http://www.bfilipek.com/2012/03/fps-limit.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-02-23T10:37:51.417

一个简单的方法是使用 GLUT。这段代码可以大致完成这项工作。

```
static int redisplay_interval;

void timer(int) {
    glutPostRedisplay();
    glutTimerFunc(redisplay_interval, timer, 0);
}

void setFPS(int fps)
{
    redisplay_interval = 1000 / fps;
    glutTimerFunc(redisplay_interval, timer, 0);
} 
```*

# ruby - Ruby 的 browsermob-proxy gem 是否对其他人不起作用？

> ID：14968861
> 
> 赞同：1
> 
> 时间：2013-02-19T22:32:15.657
> 
> 标签：ruby, selenium, proxy, selenium-webdriver

我一直在尝试实现 Browsermob 代理来检测我想要自动化的东西的网络流量，并且我已经将 Github 存储库中的示例代码复制到我自己的代码中，但是终端告诉我 proxy.har（ har 部分）是一个未定义的方法。经过进一步检查，proxy.rb 文件几乎完全是空的，没有任何定义的方法或构造函数。

这是 github 存储库： [https ://github.com/jarib/browsermob-proxy-rb](https://github.com/jarib/browsermob-proxy-rb)

谁能告诉我这里发生了什么？

```
Before ('@selenium_firefox_networkproxy') do
@server = BrowserMob::Proxy::Server.new("/Users/eliotchan/.rvm/gems/ruby-1.9.2-p320@cucumber/gems/browsermob-proxy-0.0.9/lib/browsermob-proxy.rb")
@server.start

@proxy = server.create_proxy

@profile = Selenium::WebDriver::Firefox::Profile.new
@profile.proxy = proxy.selenium_proxy

@driver = Selenium::WebDriver.for(
:remote,
:url => "http://"+FIREFOX_IP+"/wd/hub",
:desired_capabilities => :firefox,
:profile => @profile)

@proxy.new_har "Analytics"

@driver.manage.timeouts.implicit_wait = 30

@verification_errors = []
end

After ('@selenium_firefox_networkproxy') do
@harfile = @proxy.har
@har.save_to "/Users/eliotchan/Documents/Analytics.har"
@proxy.close
@driver.quit
@verification_errors.should == []
end 
```

我得到的错误是 nil:NilClass (NoMethodError) 的未定义方法“har”

# html - 对齐某些文本时出错

> ID：14968863
> 
> 赞同：0
> 
> 时间：2013-02-19T22:32:29.213
> 
> 标签：html, css

[JS小提琴](http://jsfiddle.net/brJEc/)

我试图让文本“消息”与顶部对齐，因此它就在消息框开始的位置旁边，而不是在框的底部，我尝试了多种方法并尝试使用表格，但表格确实如此不要给我想要的样子。完成这项工作的最佳方法是什么？

**我尝试过的代码：**

```
vertical-align:text-top; 
```

和

```
text-align: top; 
```

上述示例都无法为我提供所需的输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:35:23.950

也许

```
vertical-align: top; 
```

也就是说，我知道表格并不时尚，但它对我来说确实像表格布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:39:23.697

```
.contacttitle {
width: 100px;
font-size: 18px;
display:inline-block;
vertical-align: top;
text-align: top;
} 
```

在此处查看结果：http: [//jsfiddle.net/EBGGg/](http://jsfiddle.net/EBGGg/)

# php - 如何编写文本文件

> ID：14968865
> 
> 赞同：0
> 
> 时间：2013-02-19T22:32:44.033
> 
> 标签：php

test.php 打开 test.txt 并写入它。它在一台托管服务器上运行良好。

将代码迁移到另一台主机后，test.php 现在无法写出 test.txt。错误显示：

```
Warning: fopen(/home/username/public_html/test.txt)
[function.fopen]: failed to open stream: Permission denied 
```

仅当 test.txt 文件设置为 777 时才有效。在原始主机上，test.txt 设置为 755。

在这个新主机上允许 test.php 在没有 777 的情况下写入文件，我缺少什么？

此外，文件上传 PHP 脚本也不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:39:06.533

重要的不仅仅是权限，还有谁拥有这些文件。如果文件夹/文件由用于运行 Web 服务器的同一用户所有，则 755 就足够了。

直接写入 public_html 目录是一个巨大的安全风险。我建议创建一个子目录（可能最好在 public_html 之外）文件夹并赋予它适当的权限/所有权。

让运行 apache（或正在使用的任何 Web 服务器）的用户拥有的文件夹更安全——通常是 apache 或 www-data 之类的东西，而不是授予世界写入权限。

# ajax - JSF Ajax (ViewRoot) 更新后重定向

> ID：14968866
> 
> 赞同：1
> 
> 时间：2013-02-19T22:32:45.597
> 
> 标签：ajax, jsf, redirect, omnifaces

当使用 ajax 请求触发任何异常时，我使用omnifaces FullAjaxExceptionHandler 进行重定向，在我的情况下是捕获ViewExpiredException。

我将尝试解释我的情况：

1）我有一个带有commandButton（ajax请求）的index.xhtml页面，以使会话无效并返回类似“/login?faces-redirect = true”的操作。

2) 在同一个浏览器中打开 index.xhtml 两次。

3) 在第一个 index.xhtml 中单击按钮（会话无效并重定向到 login.xhtml）

在这一点上，考虑到我有一个自定义 PhaseListener 来检查用户是否已成功登录，login.xhtml 用于公共访问，但 index.xhtml 仅限于授权用户，web.xml 用于查看过期和 403 错误是：

```
<error-page>
    <exception-type>javax.faces.application.ViewExpiredException</exception-type>
    <location>/index.xhtml</location>
</error-page>
<error-page>
    <error-code>403</error-code>
    <location>/403.xhtml</location>
</error-page> 
```

4）转到第二个index.xhtml（此时会话无效），现在单击按钮以启动异常。

FullAjaxExceptionHandler 捕获 ViewExpiredException 并尝试渲染 index.xhtml，但同时我的 Phaselistener 正在检查用户是否被授权，比如会话无效，用户未被授权并且我的 PhaseListener 触发 responseSendError(403)，但不是显示 403.xhtml，因为是 ajax 请求。

如何发送 403 错误以从我的 PhaseListener 显示 403.xhtml？responseSendError 正在取消 FullAjaxExceptionHandler 的正常进程，在该异常发生的那一刻，不会发生重定向。

此外，为了澄清视图何时过期，我需要重定向到 index.xhtml，因为在生产中我使用的是 CAS（中央身份验证服务）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T11:40:18.677

具体问题本质上与`FullAjaxExceptionHandler`. 不使用它时，您仍然会遇到完全相同的问题。`responseSendError()`至少有两个原因不能用于ajax 请求：

1.  ajax 响应必须具有状态 200 才能成功处理。
2.  ajax 响应必须表示有效的 JSF ajax XML 结构，而不是纯 HTML 页面。

在里面`PhaseListener`，你最好的办法是使用[`ExternalContext#redirect()`](http://docs.oracle.com/javaee/6/api/javax/faces/context/ExternalContext.html#redirect%28java.lang.String%29).

```
ExternalContext ec = context.getExternalContext();

if (context.getPartialViewContext().isAjaxRequest()) {
    ec.redirect(ec.getRequestContextPath() + "/403.xhtml");
} else {
    ec.responseSendError(403, "Unauthorized");
} 
```

诚然，这最终以 HTTP 200 响应结束，但到目前为止，当您想要在 ajax 请求的情况下完整地显示错误页面时，这是您可以获得的最佳结果。

* * *

**与具体问题无关**，如果 a`ViewExpiredException`被抛出，那么原因几乎在所有情况下都是过期的会话。让异常的错误页面`/login.xhtml`直接指向而不是`/index.xhtml`. 或者，至少对用户更友好，到某个`/expired.xhtml`页面，其中解释了最终用户最终进入那里的原因以及他的选择是什么，以及一些链接。

# matlab - Matlab 2D轮廓使用XY坐标数据

> ID：14968867
> 
> 赞同：2
> 
> 时间：2013-02-19T22:32:56.703
> 
> 标签：matlab, contour

我有一组数据，如下所示：

```
!Sr.#    x-coord.    y-coord     potential at (x,y)
  1       0.0000     1.0000      0.3508
  2       0.7071     0.7071      2.0806
  .       ....       ....        ....
  .       ....       ....        ....
 1000    0.0000     -1.0000      0.5688 
```

我需要为上述数据生成一个 2D 轮廓，其中电位值将绘制在 2D 轮廓图上的相应 (x,y) 位置。我相信为了能够在 Matlab 中使用轮廓命令绘制 2D 轮廓，我将不得不使用 2D 矩阵（在我的情况下它基本上包含潜在值）。如何为这种情况创建 2D 矩阵？或者是否有一种解决方法可以完全避免 2D 矩阵并仍然给出 2D 轮廓。我拥有的 xy 坐标数据没有任何特定的顺序，但可以根据需要进行排列。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T23:04:31.393

我自己也遇到过这个问题，并且从 stackoverflow 成员[John D'Errico](http://www.mathworks.com/matlabcentral/fileexchange/authors/679)那里找到了一个令人难以置信的解决方案，即木片。他在 Matlab Central 上调用的[软件包](http://www.mathworks.com/matlabcentral/fileexchange/8998-surface-fitting-using-gridfit)`gridfit,`将轻松解决您的问题。这是我自己的示例，但 John 在他令人难以置信的文档和演示文件中有更好的示例。

```
% first, get some random x,y coordinates between -3 and 3
% to allow the peaks() function to look somewhat meaningful
x = rand(10,1)*6 - 3;
y = rand(10,1)*6 - 3;
% calculate the peaks function for this points
z = peaks(x,y);
% now, decide the grid we want to see, -3 to 3 at 0.1 intervals
% will be fine for this crude test
xnodes = -3:0.1:3;
ynodes = -3:0.1:3;
% now, all gridfit, notice, no sorting!  no nothing!
% just tell it the rectangular grid you want, and give it
% the raw data.  It will use linear algebra and other robust
% techniques to fit the function to the grid points
[zg,xg,yg] = gridfit(x,y,z,xnodes,ynodes);
% finally, plot the data, Viola!
contour(xg,yg,zg) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-27T19:50:01.897

对于任意分散的数据，请查看[TriScatteredInterp](http://www.mathworks.com/help/matlab/ref/triscatteredinterp.html)作为 gridfit 的替代方案。

# codeigniter - 如何在codeigniter中集成html模板

> ID：14968868
> 
> 赞同：4
> 
> 时间：2013-02-19T22:32:59.470
> 
> 标签：codeigniter, templates

我是codeigniter的新手。请告诉我如何在 codeigniter 中集成或安装 html 主题/模板？（我的css文件夹路径=news/css和应用程序文件夹路径=news/application，其中news是我的主文件夹）

-谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T02:41:30.110

这是在 codeigniter 中做模板的一种非常简单、非常强大的方法，而且非常灵活。
[http://news.dice.com/2013/02/18/how-to-build-a-to-do-app-with-codeigniter/](http://news.dice.com/2013/02/18/how-to-build-a-to-do-app-with-codeigniter/)

忽略标题，大部分课程都是关于在 CI 中设置模板。

请注意，我是从 net.tutsplus.com 上的 jeffrey 方式 CI 教程中第一次接触到这种方法所有这些都值得一试：http: [//net.tutsplus.com/sessions/codeigniter-from-scratch/](http://net.tutsplus.com/sessions/codeigniter-from-scratch/)

编辑——好的，这是对帖子的补充。所以在教程中，在 template.php 页面上，你会看到

```
 $this->load->view($maincontent); 
```

这很酷。但这要好得多：

```
// load your header views

 $templatefolder = 'beta/';

 if(isset($content01))
 $this->load->view($templatefolder.$content01);

 if(isset($content02))
 $this->load->view($templatefolder.$content02);

 if(isset($content03))
 $this->load->view($templatefolder.$content03);

 // load your footer views 
```

so instead of calling the view "maincontent", i've put in references to $content1, $content2, etc. Because we are doing if isset none of them are required. that way you can easily send more then one view file to the template. Or none at all if you are just showing a message, etc. Also notice that we have $templatefolder - that way you can easily reuse the template file for other site templates, even with the same content.

in your controller (similar to tutorial) it would be

```
 $data['content01'] = 'codeigniterrawks';
 $data['content02'] = 'mypetlion';
 // beta template
 $this->load->view( 'template_beta', $data ); 
```

note how easy it is if i want to bring in those same view files into a different template

```
 $data['content01'] = 'codeigniterrawks';
 $data['content02'] = 'mypetlion';
 // alpha template
 $this->load->view( 'template_alpha', $data ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:45:09.777

大约一周前我遇到了这个确切的问题，这个指南真的帮助了我：

[http://net.tutsplus.com/tutorials/php/an-introduction-to-views-templating-in-codeigniter/](http://net.tutsplus.com/tutorials/php/an-introduction-to-views-templating-in-codeigniter/)

为了处理 CSS url，我在 config/autoload.php 中的库中添加了“uri”（所以它看起来像这样：

```
$autoload['libraries'] = array('uri', 'database');) 
```

" type="text/css" 媒体="screen" />

base_url 函数会自动返回您网站的基本 url，即

```
http://localhost/news/ 
```

将参数附加到末尾。

这背后的原因是，如果/当您需要迁移服务器时，您只需更改配置文件中的 base_url，它就会自动更新所有模板和源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T07:24:16.553

Try this,

I'm using this and it's very powerful.

[https://github.com/philsturgeon/codeigniter-template](https://github.com/philsturgeon/codeigniter-template)

# couchdb - 我正在将 River-couchdb 与 ElasticSearch 一起使用，并且想将其 last_seq 重置为 0。有人知道这是否可能吗？

> ID：14968872
> 
> 赞同：2
> 
> 时间：2013-02-19T22:33:14.297
> 
> 标签：couchdb, elasticsearch

我正在使用一个名为 river-couchdb 的带有 elasticSearch 的插件来创建我的 couchdb 的全文索引。它使用 couchdb _changes api 来监听文档。我假设它正在跟踪 _changes api 的最后一个序列。

有时我们重建我们的 CouchDB 并将我们的 last-seq 设置回 0。我发现重置 river-couchdb seq 的唯一方法是删除它的索引和河流本身并重新创建它。有没有更好的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T01:20:46.170

据我记得，您的 _river 索引中有一个 _seq 文档，用于您的河流。该文档有一个 _last_seq 条目。

如果你想从头开始，我想你可以简单地删除这个文件：

```
curl -XDELETE localhost:9200/_river/yourrivername/_seq 
```

它有帮助吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-02T15:19:58.163

来自 couchdb-river 手册： [starting-at-a-specific-sequence](https://github.com/elasticsearch/elasticsearch-river-couchdb#starting-at-a-specific-sequence)

```
curl -XDELETE localhost:9200/_river/yourrivername/_seq

curl -XPUT 'localhost:9200/_river/yourrivername/_seq' -d '
{
  "couchdb": {
    "last_seq": "100"
  }
}' 
```

Elasticsearch 无法在不删除旧文档的情况下更新 last_seq

# r - 插入符号。数据拆分与trainControl的关系

> ID：14968874
> 
> 赞同：15
> 
> 时间：2013-02-19T22:33:29.047
> 
> 标签：r, machine-learning, cross-validation

我已经仔细阅读了位于[http://caret.r-forge.r-project.org/training.html的](http://caret.r-forge.r-project.org/training.html)[CARET](http://cran.r-project.org/web/packages/caret/index.html)文档，其中的小插曲，一切都很清楚（网站上的示例很有帮助！），但是我仍然对以下两个论点之间的关系感到困惑：`trainControl`

```
method 
index 
```

以及`trainControl`插入符号中的数据拆分函数之间的相互作用（例如`createDataPartition`、`createResample`和）`createFolds``createMultiFolds`

为了更好地提出我的问题，让我使用文档中的以下示例：

```
data(BloodBrain)
set.seed(1)
tmp <- createDataPartition(logBBB,p = .8, times = 100)
trControl = trainControl(method = "LGOCV", index = tmp)
ctreeFit <- train(bbbDescr, logBBB, "ctree",trControl=trControl) 
```

我的问题是：

1.  如果我使用`createDataPartition`（我假设它会进行分层引导），如上例所示，并且我将结果传递`index`给`trainControl`我是否需要`LGOCV`在我的调用中用作方法`trainControl`？如果我使用另一个（例如`cv`）会有什么不同？在我看来，一旦你修复`index`了.`method``index`

2.  `createDataPartition`和 和有什么不一样`createResample`？是`createDataPartition`分层引导，而`createResample`不是？

3) 如何使用插入符号进行**分层**k 折（例如 10 折）交叉验证？下面会做吗？

```
tmp <- createFolds(logBBB, k=10, list=TRUE,  times = 100)
trControl = trainControl(method = "cv", index = tmp)
ctreeFit <- train(bbbDescr, logBBB, "ctree",trControl=trControl) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T00:09:05.533

如果您不确定使用索引时方法扮演什么角色，为什么不应用所有方法并比较结果。这是一种盲目的比较方法，但它可以给你一些直觉。

```
 methods <- c('boot', 'boot632', 'cv', 
               'repeatedcv', 'LOOCV', 'LGOCV') 
```

我创建我的索引：

```
 n <- 100
  tmp <- createDataPartition(logBBB,p = .8, times = n) 
```

我申请`trainControl`了我的方法列表，并从结果中删除了索引，因为它对我的所有方法都是通用的。

```
ll <- lapply(methods,function(x)
         trControl = trainControl(method = x, index = tmp))
ll <- sapply(ll,'[<-','index', NULL) 
```

因此我的 ll 是：

```
 [,1]      [,2]      [,3]      [,4]         [,5]      [,6]     
method            "boot"    "boot632" "cv"      "repeatedcv" "LOOCV"   "LGOCV"  
number            25        25        10        10           25        25       
repeats           25        25        1         1            25        25       
verboseIter       FALSE     FALSE     FALSE     FALSE        FALSE     FALSE    
returnData        TRUE      TRUE      TRUE      TRUE         TRUE      TRUE     
returnResamp      "final"   "final"   "final"   "final"      "final"   "final"  
savePredictions   FALSE     FALSE     FALSE     FALSE        FALSE     FALSE    
p                 0.75      0.75      0.75      0.75         0.75      0.75     
classProbs        FALSE     FALSE     FALSE     FALSE        FALSE     FALSE    
summaryFunction   ?         ?         ?         ?            ?         ?        
selectionFunction "best"    "best"    "best"    "best"       "best"    "best"   
preProcOptions    List,3    List,3    List,3    List,3       List,3    List,3   
custom            NULL      NULL      NULL      NULL         NULL      NULL     
timingSamps       0         0         0         0            0         0        
predictionBounds  Logical,2 Logical,2 Logical,2 Logical,2    Logical,2 Logical,2 
```

# php - 为什么“if ("ss"==0)" 结果为真；

> ID：14968880
> 
> 赞同：0
> 
> 时间：2013-02-19T22:34:02.107
> 
> 标签：php, if-statement

正在学习，所以不要因为我的要求而杀了我。哈哈

```
if ("ss"==0)
   print "TRUE";
else
   print "FALSE"; 
```

# grails - Titanium Studio 到 Grails 图像发布

> ID：14968881
> 
> 赞同：0
> 
> 时间：2013-02-19T22:34:02.410
> 
> 标签：grails, titanium-mobile

我正在尝试将图像发布到我的 grails 应用程序，但运气不佳。

我的钛代码是：

```
function upload(){  
    var xhr = Titanium.Network.createHTTPClient();
    xhr.onerror = function(e){
        Ti.API.info(picMedia + " : " +message.value);
        Ti.API.info('IN ERROR ' + e.error);
        alert('Sorry, we could not upload your photo! Please try again.');
    };
    xhr.onload = function(){
        Ti.API.info('IN ONLOAD ' + this.status + ' readyState ' + this.readyState);
    };
    xhr.onsendstream = function(e){
        Ti.API.info('ONSENDSTREAM - PROGRESS: ' + e.progress);
    };
    // open the client
    xhr.open('POST', 'http://localhost:8080/FYP/Profile/appUploader'); 
    // send the data
    xhr.send({
        media: picMedia,
        message: message.value,
    });

} 
```

我的grails代码如下：

```
 def appUploader(){

            println "MEDAI PARAMS: " + params.media
          def f = request.getFile('media') ;
             println "HERE: " + f
           if (request.getFile(params.media).getOriginalFilename()) {
               println     "FROM APP: "      +    request.getFile('myFile').getOriginalFilename()

               return
           }
    } 
```

我从移动应用程序中收到错误，并且在网络应用程序的“if”行上出现错误。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T08:58:20.377

我们在我们的一个应用程序中遇到了同样的问题。困难在于钛在这种情况下并不能真正处理二进制文件。

我们做了以下事情：

*   在客户端创建图像的base64编码字符串
*   将此字符串发布到后端
*   再次将base64解码为图像

我们分析了很多网络流量，在大多数情况下，钛试图发送文件，但由于 javascript，它总是转换成某种 ascii，这在服务器端是不可用的。

# objective-c - 了解协议和委托之间的关系

> ID：14968883
> 
> 赞同：2
> 
> 时间：2013-02-19T22:34:07.060
> 
> 标签：objective-c, cocoa-touch

我正在阅读 Stephen G. Kochan 的“Objective C 编程”，在第 11 章中他混合了一些内容：类别、协议、委托、非正式协议。

现在，他只是谈到了他们每个人，这让我更加困惑......我知道委托是 obj c 中最重要的主题之一，它与协议一起出现。

请帮忙，这对我很重要，所以我不会搞砸。tnx

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T22:54:20.677

我会试着为你解释一下委托。当您知道时，这真的很简单，但是需要时间来解决它！

假设您有两个类，一个`Calculator`执行计算的`CalculatorScreen`类和一个用于向用户呈现计算结果的类。Calculator 类应该在完成计算时通知 CalculatorScreen，以便后者可以更新 UI。

**协议**提供了一种方法来定义一组与指定名称相关的方法。您可以在 Calculator 类中名为 CalculatorDelegate 的协议中*定义许多方法，但方法**实现*在其他地方定义。

定义协议的类（在本例中为 Calculator）可以告诉**委托**（**符合**协议的对象 - 在本例中为 CalculatorScreen）实现该方法。计算器类可能会完成一个加法计算并告诉它的委托（屏幕）进行更新。你懂我吗？

抱歉，当我在写作时，我意识到很难解释和同情每一个尝试过的作者！

iOS 示例：当您在 iPad 的显示屏上设置表格时，您使用 UITableView 类。但是那个类不知道表格的标题是什么，或者它有多少个部分和行，或者用什么来填充它。因此，它通过定义称为 UITableViewDataSource 和 UITableViewDelegate 的协议将责任委托给您。当 UITableView 需要知道一些信息，例如行数时，它会调用委托（你自己的类）上的相应方法，委托类包含协议中定义的那些方法的实现。

为了回答您的问题，我会暂时放下这本书，然后开始在一个虚拟应用程序中编写您迄今为止所学的内容！最好的学习方式是做（至少对我来说）。

# excel - 在另一个单元格中使用单元格名称查找单元格值

> ID：14968888
> 
> 赞同：0
> 
> 时间：2013-02-19T22:34:40.233
> 
> 标签：excel

假设我有一个带有文本“n25”的单元格 (A1)。在另一个单元格中，我想在另一个单元格中找到 A1 中定义的单元格的值，比如说 A2。换句话说，我如何输入 =（来自另一个单元格的文本，在本例中为“n25”，然后它将返回单元格 n25 中的值）。我问的原因是因为包含 n25 的单元格将随着数据的变化而动态变化（它可以是 n26 ，其中所有其他单元格都会更新）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:37:20.353

利用

```
=INDIRECT(address_of_cell_with_reference_to_another_cell) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T22:37:52.730

是的，试试：

```
=间接（A1）

```

这将从 N25 返回值。

# css - *width IE-hack 导致的验证错误

> ID：14968890
> 
> 赞同：0
> 
> 时间：2013-02-19T22:34:44.110
> 
> 标签：css, w3c-validation

我正在使用这个工具来验证 CSS 文件：http: [//jigsaw.w3.org/css-validator/](http://jigsaw.w3.org/css-validator/)

我的 CSS 文件中有 23 个错误，其中一半以上看起来像这样：

```
Line 46  #left_navigation    Parse Error ;*width: 175px; 
```

实际的 CSS 如下所示：

```
#left_navigation {
    float: left;
    width: 165px;
    *width: 175px;
    margin:0px;
    padding:12px 5px 5px 5px;
} 
```

错误是由于星号设置了宽度。本来我没有放在这里，但是很明显它需要处理IE中的一些显示问题。

所以我的问题是：我关心这些错误吗？有没有另一种/更好的方法来做到这一点？我不能把它拿掉，因为当我们这样做时，IE 中会发生坏事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:40:31.093

> 我关心这些错误吗？

我不知道。你？

不过还有一个选择。确保您的页面包含以下内容：

```
<!--[if lt IE 7 ]> <html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8" lang="en"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--><html><!--<![endif]--> 
```

然后，您可以使用带有自定义选择器的 IEx 特定样式，如下所示：

```
.ie7 #left_navigation { width: 175px; } 
```

不再需要`*prop: value;`黑客了。

作为上述方法的替代方案，您还可以使用 IE 条件来包含单独/附加或替代 IE 样式表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:41:58.983

无论如何，任何浏览器都可以正常工作。如果出于某种原因验证 CSS 不是至关重要的，请忽略它。

困难的解决方案是让它在所有浏览器上正常工作。根据所需的向后兼容性，它可能很难。

还有像 (Modernizr)[http://modernizr.com/] 这样的东西可以帮助你完成任务，比如：

```
#left_navigation.ie{
/* IE specific code */
} 
```

Althrough Jeoren 发布了现成的解决方案:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T23:00:05.037

如果您想进行有效的 CSS *hack*，以下内容允许您包含一个解决方案，而无需包含整个modernizr 脚本或通过添加 IE 条件注释来更改 HTML（预）标题：

`* html #left_navigation { width: 175px; }`对于 IE4-6 和

`*+html #left_navigation { width: 175px; }`IE7

见[http://en.wikipedia.org/wiki/CSS_filter#Star_hack](http://en.wikipedia.org/wiki/CSS_filter#Star_hack)

# django - 我可以索引另一个源文件中的模型字段吗？

> ID：14968892
> 
> 赞同：0
> 
> 时间：2013-02-19T22:34:45.280
> 
> 标签：django

我有一些表是作为外部库的一部分安装的，这些表具有需要为速度目的编制索引的字段。我可以通过数据库命令行对它们进行索引，但我更愿意告诉 django 自己进行索引，但我不想修补和维护库。有没有一种简单的方法可以在这些模型之外的源文件中告诉 Django 索引该字段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:14:41.157

我使用 south 来管理我的模型及其各自的数据表。我认为这将是我的方法，假设表都在同一个数据库上。（如果不是，则没有真正的解决方案，甚至可能不值得寻找一些破解方法来解决对 Django 的限制。）

```
$ python manage.py startapp data_models
$ python manage.py inspectdb > inspectdb.py 
```

这两个步骤创建了一个包含模型的文件来表示数据库中的每个表。将要使用的数据表的模型从文件复制`inspectdb.py`到`data_models\models.py`文件中。根据需要调整复制的模型。然后假设你有南方：

```
$ python manage.py convert_to_south data_models
$ python manage.py migrate data_models 
```

现在，您的 django 项目中有一个用于这些数据表的活动模型。最后，设置您想要拥有的 ForeignKey 关系（如果您还没有这样做的话）。如果您更改了任何模型，请执行通常的南方更新舞蹈：

```
$ python manage.py schemamigration [app-with-changed-models] --auto
$ [repeat above as necessary]
$ python manage.py migrate 
```

# python - 区分两个字典键集以生成结果字典

> ID：14968893
> 
> 赞同：3
> 
> 时间：2013-02-19T22:34:48.900
> 
> 标签：python

我有，

```
dict1={a:1, b:2, c:3}
dict2={a:3, c:7} 
```

我想找出我在 dict1 中有哪些在 dict2 中没有的键。所以我愿意

```
diff_as_set = set(dict1.keys()) - set (dict2.keys()) 
```

这给了我：`b`

但是，我想要一个字典，其中包含 dict1 中所有不在 dict 2 中的键的键值映射，所以我这样做：

```
diff_as_dict = {k:v for k,v in dict1 if k in diff_as_set} 
```

我得到：

```
diff_as_dict = {k:v for k, v in dict1 if k in diff_as_set}
ValueError: too many values to unpack (expected 2) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:39:09.590

遍历 dict 仅提供键，您需要使用：

```
diff_as_dict = {k:v for k, v in dict1.iteritems() if k in diff_as_set}
                                      ^^^^^^^^^^^ 
```

或`.items()`用于 Python 3.x

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T22:43:28.240

而不是遍历整个字典来挑选与您的集合匹配的那些，只需迭代集合。

```
diff_as_dict = {k:dict1[k] for k in diff_as_set} 
```

例子：

```
>>> dict1={'a':1, 'b':2, 'c':3}
>>> dict2={'a':3, 'c':7}
>>> diff_as_set = set(dict1.keys()) - set (dict2.keys())
>>> diff_as_set
set(['b'])
>>> diff_as_dict = {k:dict1[k] for k in diff_as_set}
>>> diff_as_dict
{'b': 2} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T22:41:44.473

你错过了这个`.iteritems()`部分：

```
dict1 = {'a':1, 'b':2, 'c':3}
dict2 = {'a':3, 'c':7}
newdict = {k : v for k,v in dict1.iteritems() if not(k in dict2)} 
```

在此之后，`newdict`等于`{'b': 2}`。这可以一口气完成所有事情。

# ffmpeg - 如何使用 avconv 创建带有私有二进制数据的 MPEG 流？

> ID：14968898
> 
> 赞同：2
> 
> 时间：2013-02-19T22:35:03.193
> 
> 标签：ffmpeg, mpeg, transport-stream

我有一些需要通过 MPEG 传输流传输的二进制数据。我不需要担心表格，因为过程中的另一个软件会将它们插入流中。

我有一个必须使用的固定私有 PID。有没有办法只使用这个命令行工具（avconv）用我的私人 PID 将这个二进制数据“分解”成 TS 数据包？如果没有，是否可以使用 C 库？

# python - Heroku 应用程序因数据库而崩溃

> ID：14968905
> 
> 赞同：2
> 
> 时间：2013-02-19T22:35:19.617
> 
> 标签：python, postgresql, heroku, flask

我的代码在本地工作，但是当我尝试在 Heroku 上运行它时它不起作用。我在 Heroku 上添加了一个数据库，但它仍然无法工作。为什么会发生这种情况的任何线索？

```
import sys
import os

from flask import Flask, render_template
from flask.ext.sqlalchemy import SQLAlchemy

db_local =   #it works, just not shown here

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = os.environ.get('DATABASE_URL', db_local)

app.secret_key = '  '  #it's a secret for a reason

db = SQLAlchemy(app)

from views import *
from model import *
db.create_all()

if __name__ == '__main__':
    port = int(os.environ.get('PORT', 5000))
    app.run(host='0.0.0.0', port=port, debug=True) 
```

我的一些heroku日志

```
2013-02-19T22:29:59+00:00 app[web.1]:   File "app.py", line 23, in <module>
2013-02-19T22:29:59+00:00 app[web.1]:     from views import *
2013-02-19T22:29:59+00:00 app[web.1]:   File "/app/views.py", line 1, in <module>
2013-02-19T22:29:59+00:00 app[web.1]:     from app import db
2013-02-19T22:29:59+00:00 app[web.1]:   File "/app/app.py", line 25, in <module>
2013-02-19T22:29:59+00:00 app[web.1]:     db.create_all()
2013-02-19T22:29:59+00:00 app[web.1]:     self._execute_for_all_tables(app, bind, 'create_all')
2013-02-19T22:29:59+00:00 app[web.1]:   File "/app/.heroku/python/lib/python2.7/site-packages/flask_sqlalchemy.py", line 822, in create_all
2013-02-19T22:29:59+00:00 app[web.1]:   File "/app/.heroku/python/lib/python2.7/site-packages/flask_sqlalchemy.py", line 814, in _execute_for_all_tables
2013-02-19T22:29:59+00:00 app[web.1]:   File "/app/.heroku/python/lib/python2.7/site-packages/sqlalchemy/schema.py", line 2564, in create_all
2013-02-19T22:29:59+00:00 app[web.1]:     import utils
2013-02-19T22:29:59+00:00 app[web.1]:   File "/app/utils.py", line 1, in <module>
2013-02-19T22:29:59+00:00 app[web.1]: Traceback (most recent call last):
2013-02-19T22:29:59+00:00 app[web.1]:     conn = self.contextual_connect(close_with_result=False)
2013-02-19T22:29:59+00:00 app[web.1]:   File "/app/.heroku/python/lib/python2.7/site-packages/sqlalchemy/engine/base.py", line 2490, in contextual_connect
2013-02-19T22:29:59+00:00 app[web.1]:     self.pool.connect(), 
2013-02-19T22:29:59+00:00 app[web.1]:     tables=tables)
2013-02-19T22:29:59+00:00 app[web.1]:     con = self._create_connection() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T01:58:27.183

我想`DATABASE_URL`你的配置变量中的值不存在。您可以通过以下方式验证这一点`heroku config:get DATABASE_URL --app your-app`

尝试`heroku pg:info --app your-app`找出您安装了哪些数据库。确保您的数据库也是 DATABASE_URL（它也会显示在 的输出中`pg:info`）。如果不是，只需运行`heroku pg:promote HEROKU_POSTGRESQL_<color> --app your-app`并再次尝试您的脚本。

# c++ - OpenCV 绘制边界框中心点

> ID：14968910
> 
> 赞同：2
> 
> 时间：2013-02-19T22:35:33.927
> 
> 标签：c++, opencv

我正在尝试在边界框中绘制一个点，它将代表该框的中心点。我已经计算了中心点，但它只在 CMD 中输出，我不会在图像上看到这个点。

我在 Visual Studio 2010 C++ 上使用 OpenCV2.4.3

```
 for(int i= 0; i < boundRect.size(); i++ )
       {
            //BoundingBox Area
            boundingBoxArea.clear();
            boundingBoxArea.push_back(Point2f(boundRect[i].x, boundRect[i].y));
            boundingBoxArea.push_back(Point2f(boundRect[i].x + boundRect[i].width, boundRect[i].y));
            boundingBoxArea.push_back(Point2f(boundRect[i].x + boundRect[i].width, boundRect[i].y + boundRect[i].height));
            boundingBoxArea.push_back(Point2f(boundRect[i].x, boundRect[i].y + boundRect[i].height));

            double area0 = contourArea(boundingBoxArea);

            cout << "area of bounding box no." << i << " = " << area0 << endl;

            //Bounding Box Centroid
            area0 = (boundRect[i].x + boundRect[i].width)/2, (boundRect[i].y + boundRect[i].height)/2;

            cout<<"Rectangle " <<i<< " Centroid possition is at: " "=" <<area0<<endl;
            cout<<""<<endl;
            cout<<""<<endl;
     } 
```

以上是我很好用的代码，只有一小部分，但有一部分负责边界框的计算

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:48:51.803

oh, you already calculated the area, and now you're trying to assing the center(Point) to that ? oh, no. replace your last lines with:

```
//Bounding Box Centroid
Point center = Point((boundRect[i].x + boundRect[i].width)/2, (boundRect[i].y + boundRect[i].height)/2);

// print it:
cout<<"Rectangle " <<i<< " Centroid position is at: " << center.x << " " << center.y << endl; 
```

also, your boundingBoxArea is wrong. take the original boundingRect[i] instead (for calculating the area), please!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-24T13:06:51.063

**选择**

使用 Moments，您的代码也可能如下所示（java，未测试）：

```
..
MatOfPoint contour = new MatOfPoint();
Rect box = boundRect[i];
//Points order doesn't matter
contour.fromArray(new Point[]{new Point(box.x, box.y), //top-left
                  new Point(box.x + box.width, box.y), // top-right
                  new Point(box.x,  box.y + box.height)}); //bottom-left
                  new Point(box.x + box.width, box.y + box.height), //bottom right
int Cx = (int)Math.round(M.get_m10()/M.get_m00());
int Cy = (int)Math.round(M.get_m01()/M.get_m00());
..
double area0 = Imgproc.contourArea(contour);
.. 
```

**背景**

**图像时刻**可帮助您计算一些特征，例如物体的质心、物体的面积等。查看图像时刻上的[维基百科](http://en.wikipedia.org/wiki/Image_moment)页面

```
import cv2
import numpy as np

img = cv2.imread('star.jpg',0)
ret,thresh = cv2.threshold(img,127,255,0)
contours,hierarchy = cv2.findContours(thresh, 1, 2)

cnt = contours[0]
M = cv2.moments(cnt)
print M 
```

质心由关系**Cx=M10/M00**和**Cy=M01/M00**给出。

```
Cx = int(M['m10']/M['m00'])
Cy = int(M['m01']/M['m00']) 
```

[请参阅此处](http://docs.opencv.org/master/dd/d49/tutorial_py_contour_features.html#gsc.tab=0)的OpenCV 教程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T00:20:55.840

好吧，伙计们，我自己解决了自己的问题让我感到自豪，呵呵：D

我发布了它自己的方程式是错误的，因为我将 x & width 和 y & 除错了 x & y 给出的偏移量是错误的。所以我改变了代码，所以我只划分 width/2 和 height/2

解决方案的最终成分是使用 cv::circle(); 我用来绘制中心点的函数。

希望有一天这能帮助一些人：D

谢谢@berak

最后结果：

![在此处输入图像描述](../Images/d76cd84eb57a73b3d638776f5869fbf1.png)

# php - 封装单行或多行搜索结果 PHP/regex

> ID：14968914
> 
> 赞同：0
> 
> 时间：2013-02-19T22:35:50.227
> 
> 标签：php, regex

我需要封装这个字符串：

```
<p class="someclass">some text</p> 
```

在这样的表格标签中：

```
<table class="anotherclass"><tr><td>
<p class="someclass">some text</p>
</td></tr></table> 
```

它变得稍微复杂一些，因为可能会有一、两或三行代码像这样被封装：

```
<table class="anotherclass"><tr><td>
<p class="someclass">some text</p>
<p class="someclass">more text</p>
<p class="someclass">another line of text</p>
</td></tr></table> 
```

我已经尽力使用 PHP 和以下代码，但它不起作用：/ $doc 包含 html 文档的字符串代码，首先我计算需要生成所需正则表达式的行数，我不确定 $& 是否可以常说：这是我需要装的东西。。

```
$line_count=substr_count($doc, '<p class="someclass">');

for($i=0;$i<$line_count;$i++)
{$add.='[^</p>]</p>';}

$regex='/<p class="someclass">'.$add.'/';
$replace='<table class="anotherclass"><tr><td>$&</td></tr></table>';
$doc=preg_replace($regex, $replace, $doc); 
```

我什至接近解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T23:02:26.087

试试这个代码 - 它会选择一个或多个

“someclass”块

```
$doc = '
<p class="someclass">Jerky tri-tip pancetta t-bone beef, meatball meatloaf flank brisket beef ribs biltong short ribs capicola fatback.</p>
<p class="someclass">Meatball short ribs venison leberkas shoulder meatloaf corned beef ham salami. Shank sirloin fatback flank pig spare ribs.</p>
<p class="someclass">Cow hamburger leberkas drumstick jerky beef short loin tenderloin swine pork. Kielbasa short loin jerky salami.</p>
';

$regex='/((<p class="someclass">(?:(?!(<\/p>)).*?)<\/p>\s*)+)/is';
$replace='<table class="anotherclass"><tr><td>$1</td></tr></table>';
$doc=preg_replace($regex, $replace, $doc); 
```

一些评论：

((\s*)+) - ()+ 将使其匹配 1 个或更多，\s* 确保间距将被忽略

接下来

, external () 是获得所有匹配所必需的

块到 $1 变量

/is - 使整个文档被视为单个字符串并忽略大小写的修饰符。可能很方便。

(?:(?!(</p>)).*?) - 这是主要部分 - 否定条件匹配以确保没有

在匹配的字符串内

# jquery - 如何通过 jQuery 将带有逗号分隔 id 的 JavaScript 函数添加到元素的 ontouchend 属性中？

> ID：14968917
> 
> 赞同：1
> 
> 时间：2013-02-19T22:36:05.627
> 
> 标签：jquery

我有这个 JavaScript 函数，里面有四个逗号分隔的 id。

```
function expCountDown(id1, id2, id3, id4) 
```

目前，我正在尝试通过 jQuery 将包含 JavaScript 函数的 ontouchend 属性附加到元素......但它不起作用。

```
$("#gaskup1_cash").bind("touchstart", function(){
$(".dialogOKtext").attr("ontouchend": "expCountDown('gaskup1_check', 'gaskup1_count', 'gaskup1_expired', 'gaskup1')");
}); 
```

我已经成功地尝试使用只有一个或没有 id 的 JavaScript 函数来做到这一点，所以我想这是由于函数中的逗号。

我知道这是一种可怕的方式来解决这个问题。但只是为了争论，这甚至可能吗？在任何情况下，如何/为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:40:33.103

我不确定绑定`touchend`事件是否*正是*您想要的。如果是这种情况，您应该按以下方式进行。

```
$(".dialogOKtext").on("touchend", function(){
  expCountDown('gaskup1_check', 'gaskup1_count', 'gaskup1_expired', 'gaskup1');
}); 
```

作为备注，从 jQuery 1.7 开始，绑定事件处理程序的首选方法是[`.on()`](http://api.jquery.com/on/).

# java - JVM 中的设置以在本机 C/C++ 代码中发生崩溃时忽略 JRE 错误消息？

> ID：14968923
> 
> 赞同：0
> 
> 时间：2013-02-19T22:36:40.973
> 
> 标签：java, c++, c, jvm, java-native-interface

我从创建 JavaVM() 的 C/C++ 应用程序调用 Java Swing 面板。一切正常。出于任何原因，如果 C/C++ 崩溃，那么我会看到消息致命错误已被 Java 运行时环境检测到。崩溃发生在 JVM 之外的本机代码中。

我可以在 JVM 中设置任何选项来忽略本机代码中的错误吗？以下是留言。

> Java 运行时环境检测到一个致命错误：
> 
> SIGSEGV (0xb) 在 pc=0xfd933144，pid=29358，tid=1
> 
> JRE 版本：6.0_22-b04 Java VM：Java HotSpot(TM) 客户端 VM（17.1-b03 混合模式 solaris-sparc） 有问题的框架：C [libc.so.1+0x33144] strlen+0x80
> 
> 如果您想提交错误报告，请访问：http: [//java.sun.com/webapps/bugreport/crash.jsp](http://java.sun.com/webapps/bugreport/crash.jsp) 崩溃发生在 Java 虚拟机之外的本地代码中。请参阅有问题的框架以了解报告错误的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T23:03:52.197

不，绝对不。

如果您收到致命错误，那是因为 JRE 检测到一种情况，它认为 JRE 数据结构已发生严重损坏；例如，堆已损坏。

没有办法让 JRE 继续处于可能损坏的状态。无论如何尝试都是个坏主意。

* * *

您需要找到并修复导致这些崩溃的 C/C++ 代码中的问题。如果这太难了，那么：

*   用 Java 重新编码本机代码并放弃 C/C++ 版本，或者
*   将 C / C++ 代码转换为独立的应用程序，并使用`System.exec()`... 或其他方式运行它。

（或者，由于您在 C/C++ 应用程序中运行 JVM，请让后者启动一个单独的 JVM。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T07:32:48.513

正如@Stephen C 指出的那样，您应该尝试修复崩溃，而不是忽略它们并以另一种方式看待。

但是，如果崩溃超出了您的范围（例如，有缺陷的库），您可以重写您的应用程序以从 Java 开始。Java 程序只会通过 JNI 调用 C++ 应用程序，将 C++ 调用包含在 try/catch 块中的本机代码中。如果您期望出现异常（例如，内存访问冲突），只需捕获它并且什么都不做。

代码示例可以在这个 SO 答案中看到：[https ://stackoverflow.com/a/918891/1043352](https://stackoverflow.com/a/918891/1043352)

# php - 使用 CodeIgniter 2 的学说 2 没有要处理的元数据类

> ID：14968924
> 
> 赞同：2
> 
> 时间：2013-02-19T22:36:42.453
> 
> 标签：php, codeigniter, doctrine-orm

我将 CodeIgniter 2 与学说 2 一起使用，这是我正在从事的项目

[https://github.com/wildlyinaccurate/CodeIgniter-2-with-Doctrine-2](https://github.com/wildlyinaccurate/CodeIgniter-2-with-Doctrine-2)

我需要从现有数据库生成实体类

所以我将 Doctrine 配置为开发模式，并在 CodeIgniter 上设置了数据库

之后我写了这个命令

php 学说 orm:convert-mapping --from-database 注释模型/生成

从数据库正确生成的类但没有任何方法，之后我编写了这个命令来生成实体

php 教义 orm:generate-entities --regenerate-entities="1" 模型/生成

但我发现此错误“没有要处理的元数据类”

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-07T17:57:07.010

在生成的实体文件中，您需要删除“use Doctrine\ORM\Mapping as ORM;”

并将“ORM\”替换为“”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-15T17:34:40.353

在库文件夹中的 Doctrine.php 中添加这些行，以加载驱动程序：

```
$driver = new \Doctrine\ORM\Mapping\Driver\PHPDriver(APPPATH.'models/Mappings');
$config->setMetadataDriverImpl($driver); 
```

创建您的[映射文件](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/php-mapping.html)。并[生成实体](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/tools.html#command-overview)：

```
php cli-doctrine.php orm:generate-entities models --generate-annotations=true 
```

现在您可以在数据库中创建表：

```
php cli-doctrine.php orm:schema-tool:create 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-23T09:15:11.310

这是正确的代码行现在尝试：

```
php doctrine orm:generate-entities --generate-annotations=true models/generated 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-04T03:19:42.673

大多数学说文档和教程都不正确。你应该使用这个命令：

```
php doctrine orm:generate:entities --generate-annotations=true models/generated 
```

# mysql - Wordpress 插件自定义数据库查询（SQL UPDATE SET WHERE）

> ID：14968925
> 
> 赞同：1
> 
> 时间：2013-02-19T22:36:46.033
> 
> 标签：mysql, wordpress

**快速背景：**

*   CRUD 插件

*   可湿性粉剂 3.5

*   根据我的个人知识创建这个插件 - 我确定一个已经存在。

*   变量回显正常。

*   插件的创建部分需要 3 个小时的研究才能使查询正常工作。尝试了 codex 中的所有内容，从 Stack Overflow 获得了一些答案，直到某些东西奏效。

**问题：**

*   更新自定义表中的行。
*   此查询将在 SQL 中工作 ->

    更新 wp_current_issue SET issue_year=9999, issue_month=29 WHERE issue_id=17;

**试过：**

```
global $wpdb;
$wpdb->update(CURRENT_ISSUE_TABLE, 
        array(
            'issue_year' => $issue_year,
            'issue_month' => $issue_month
            ),
        array('issue_id' => $issue_edit_id),
        array('%d','%d'),
        array('%d')); 
```

以及：（列名周围有和没有反引号）

```
global $wpdb;
$sql = $wpdb->prepare("UPDATE wp_current_issue SET issue_year=".$issue_year.", issue_month=".$issue_month." WHERE issue_id=".$issue_edit_id);

$wpdb->query($sql); 
```

现在有趣的是，我用 INSERT INTO 语句经历了同样的事情。什么都试过了。唯一可行的是：

```
 global $wpdb;

    $sql = $wpdb->prepare(
        "INSERT INTO `".CURRENT_ISSUE_TABLE."` (`issue_path`,`issue_img_path`,`issue_year`,`issue_month`) VALUES (%s,%s,%d,%d)", $fileName_issue, $fileName_img, $issue_year, $issue_month);

    $wpdb->query($sql); 
```

任何人都知道我如何为更新语句重写此查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:50:15.640

假设我正确理解了您的问题，如果您想将该插入重写到更新中，那么只需使用

```
$sql = $wpdb->prepare(
"UPDATE `".CURRENT_ISSUE_TABLE."` SET `issue_path` = %s, `issue_img_path` = %s, `issue_year` = %s, `issue_month` = %s
    WHERE issue_id = %i", $fileName_issue, $fileName_img, $issue_year, $issue_month, $issue_edit_id); 
```

其余的都是一样的。

# django - Django：从 ForeignKey 中的过滤器访问用户字段

> ID：14968926
> 
> 赞同：0
> 
> 时间：2013-02-19T22:36:46.267
> 
> 标签：django, django-models, django-users

我想用不是员工的用户填写选择字段。我正在使用扩展的用户类（使用 django 文档中提到的 OneToOneField ）：

```
class Usuario(models.Model):
    user =  models.OneToOneField (User)    
    departamento   = models.ForeignKey(Departamento, null=True) 
```

然后，

```
class Proyecto(models.Model):
    ip = models.ForeignKey(Usuario, limit_choices_to = {'user.is_staff__exact': False },  related_name='pr_ip') # not working!
    jp = models.ForeignKey(Usuario, limit_choices_to = {'departamento__isnull': False },   related_name='pr_jp') # works! 
```

问题是我不能使用 user.is_staff 字段进行过滤。关于如何解决这个问题或如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T23:04:27.150

改用双下划线：

```
'user__is_staff__exact': False 
```

# c# - 更改模型而不更改数据库？

> ID：14968927
> 
> 赞同：0
> 
> 时间：2013-02-19T22:36:47.233
> 
> 标签：c#, entity-framework

我有一个模型用于填充数据库

```
public class Account
{
    public int NumberOfPayPeriods { get { return 24; } }
    public decimal YearAmount { get; set; }
    public decimal PlanTotal
    {
        get { return NumberOfPayPeriods*YearAmount; }
    }
} 
```

`NumberOfPayPeriods`我需要从 a 更改为 a`get`的属性`get; set;`

但是，当我更改它时，我得到一个`EntityCommandExecutionException`（无效的列名）。我认为这是因为它试图将其映射到以前不存在此类列的数据库（因为它只是一个获取）。

有什么办法可以将其更改为 get;set; 无需删除表？那里有很多不能丢失或重新创建的重要数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:38:52.640

`[NotMapped]`在您不想存储的属性上添加一个属性。

```
public class Account
{
    [NotMapped]
    public int NumberOfPayPeriods { get { return 24; } set { ... } }
    public decimal YearAmount { get; set; }
    public decimal PlanTotal
    {
        get { return NumberOfPayPeriods*YearAmount; }
    }
} 
```

# git - 在 git 中使用发布分支总是更好吗？

> ID：14968929
> 
> 赞同：0
> 
> 时间：2013-02-19T22:36:53.970
> 
> 标签：git

我正在按照[这个模型](http://nvie.com/img/2009/12/Screen-shot-2009-12-24-at-11.32.03.png)使用 git 。我即将准备好发布我的第一个版本。我不作为团队的一员工作，只有我自己。是否有必要使用“发布”分支？我有一种感觉，这可能只是让事情变得复杂，所以我打算将开发分支中的更改直接合并到主分支中，并以这种方式继续未来的版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T22:38:37.607

除非您想开始在不属于即将发布的版本中的开发分支上工作，否则无需创建发布分支。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:41:09.797

它不是*必需*的，但如果您想发布 1.0 版，同时向 2.0 工作，您将不希望放弃 1.x 系列，并挑选更改或应用本地错误修正。在这种情况下，拥有发布分支和开发分支很有用。

# magento - Magento - customer.xml 中的动态标签？

> ID：14968937
> 
> 赞同：0
> 
> 时间：2013-02-19T22:37:23.123
> 
> 标签：magento

在我的 customer.xml 页面中，我希望将“我的帐户”链接的标签更改为客户的姓名。这样做的正确方法是什么？

```
<customer_logged_in>
    <reference name="account.links">
        <action method="addLink" translate="label title" module="customer"><label>My Account</label><url helper="customer/getAccountUrl"/><title>My Account</title><prepare/><urlParams/><position>35</position></action>
        <action method="addLink" translate="label title" module="customer"><label>Log Out</label><url helper="customer/getLogoutUrl"/><title>Log Out</title><prepare/><urlParams/><position>40</position></action>
    </reference>
</customer_logged_in> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T05:44:59.030

您可以通过查看这些帖子找到问题的解决方案。所以请通过帖子。

[magento 的 customer.xml 布局文件中的附加参数](https://stackoverflow.com/questions/7321364/additional-parameters-in-magentos-customer-xml-layout-file)

[http://www.magentocommerce.com/boards/viewthread/230512/#t326018](http://www.magentocommerce.com/boards/viewthread/230512/#t326018)

# c# - FTPWebRequest 530 错误：未登录问题

> ID：14968938
> 
> 赞同：0
> 
> 时间：2013-02-19T22:37:43.160
> 
> 标签：c#, asp.net, ftpwebrequest

我一直在挖掘关于如何在 C# 中正确登录 FTP 的大量帖子，但是当我实际尝试时，它不起作用。通过我的阅读，我开始认为这是因为我的用户名中有“at”符号。这是真的还是似乎还有其他问题？我可以使用 FileZilla 登录没问题。

```
var file = f.Element("FILE_PATH").Value;
string ftpHost = "myFTP.com";

var URI = @"ftp://" + ftpHost + "/download/" + file; 
FtpWebRequest ftp = (FtpWebRequest)FtpWebRequest.Create(URI);
ftp.Credentials = new NetworkCredential(@"me@mysite.com", "Password");
ftp.UseBinary = true;
ftp.Method = WebRequestMethods.Ftp.DownloadFile;

FtpWebResponse ftpResponse = (FtpWebResponse)ftp.GetResponse(); 
```

# java - 如何将 Java 进程锁定到内存？(MLock)

> ID：14968942
> 
> 赞同：1
> 
> 时间：2013-02-19T22:37:46.790
> 
> 标签：java, memory, locking, java-native-interface

我从 2010 年发现了这个堆栈溢出问题： [Lock or Pin java process into memory](https://stackoverflow.com/questions/3936027/lock-or-pin-java-process-into-memory)

基本上它说将java进程锁定到内存的方法是使用JNI。它指向的示例是断开的链接。现在是 2013 年，我的问题是……有更好的方法吗？有没有人在 Java 中使用 mlock 的例子？我对 JNI 和一般的 C 代码非常缺乏经验，但对 Java 非常熟悉（尽管我从未使用过 JNI）。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T23:57:36.390

> 我想知道如果可能的话，是否有一个不涉及 JNI 的好的 java 解决方案。

没有。将应用程序固定在内存中是特定于操作系统的，并且不受标准 JVM API 的支持。

* * *

做一件相当危险的事情……因为可能会对整体系统性能产生严重影响。因此，它*应该*在任何支持它的系统上都需要 root 权限（或同等权限）。

我个人不会尝试这样做，并且会非常犹豫使用执行此操作的应用程序。你想要达到的目标（可能）会以其他方式更好地完成......

* * *

> 出于安全原因，我想这样做。

哦。所以你*实际上*想要做的是阻止“超级秘密”的东西被写入磁盘上的交换/页面空间？

1.  我不相信 mlock 会阻止将内容写入交换。

2.  如果有人可以访问交换磁盘，他们就有可能使用其他机制来提取数据；例如，通过使用“/dev/mem”或等效的从物理内存或进程虚拟内存中读取内容。

3.  解决交换盘上“超级机密”问题的常规方法是使用 char 数组而不是字符串来保存这些内容，并在完成后立即用零手动覆盖它们。

4.  或者调查光盘级加密。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-08T10:28:37.213

我正在寻找类似的东西并发现了这个：

[https://github.com/LucidWorks/mlockall-agent/](https://github.com/LucidWorks/mlockall-agent/)

对于固定 Java 内存的问题，这似乎是一个非常好的解决方案。如果您使用它，请确保您的初始堆大小（-XMs）设置为与您的最大堆大小（-Xmx）相同 - 文档说如果您不这样做，则在初始堆之后分配的任何内存不会被锁定。

# postgresql - 从备份恢复 PostgreSQL 数据库

> ID：14968946
> 
> 赞同：3
> 
> 时间：2013-02-19T22:38:01.727
> 
> 标签：postgresql, windows-server-2008-r2, database-backups, database-restore, postgresql-9.2

我正在尝试启动并运行一个站点，并拥有 .asp 源文件和 PostgreSQL 数据库的 .backup。

我在尝试恢复 Postgres 备份时不断收到错误消息：“进程返回退出代码 0。” 我已经创建了一个新的数据库并通过 pgadmin GUI 添加了表，当我右键单击空表并选择恢复时出现错误。

任何具有 Postgres 经验的人都可以提供帮助，或者向我指出一些特定文档的方向？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T23:35:38.713

使用客户端应用程序从由其中一种非纯文本格式[`pg_restore`](http://www.postgresql.org/docs/current/interactive/app-pgrestore.html)创建的存档中恢复。[`pg_dump`](http://www.postgresql.org/docs/current/interactive/app-pgdump.html)

# wpf - 无法将 IEnumerable 类型转换为 ObservableCollection...您是否缺少演员表？

> ID：14968948
> 
> 赞同：3
> 
> 时间：2013-02-19T22:38:08.307
> 
> 标签：wpf, entity-framework-4, filter

我正在尝试返回布尔“isAssy”为真的实体：

```
 public ObservableCollection<MasterPartsList> ParentAssemblyBOM
 {
      get {return this._parentAssemblyBOM.Where(parent => parent.isAssy == true); }
 } 
```

但整个声明用红色下划线表示我不能“将类型 IEnumerable 转换为 ObservableCollection ......你错过了演员表吗？”

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-19T22:41:37.203

`ObservableCollection<T>`有一个接受 a作为参数的[重载构造函数。](http://msdn.microsoft.com/en-us/library/cc679169.aspx)`IEnumerable<T>`假设您的 Linq 语句返回`MasterPartsList`项目集合：

```
public ObservableCollection<MasterPartsList> ParentAssemblyBOM
{
    get 
    {
        var enumerable = this._parentAssemblyBOM
                             .Where(parent => parent.isAssy == true);

        return new ObservableCollection<MasterPartsList>(enumerable); 
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:42:30.073

您必须显式创建 ObservableCollection，最简单的是：

```
public ObservableCollection<MasterPartsList> ParentAssemblyBOM
{
    get {return new ObservableCollection<MasterPartsList>(this._parentAssemblyBOM.Where(parent => parent.isAssy == true)); }
} 
```

这可能是低效的，因为您每次都在创建新集合。但是，如果您每次都返回一组完全不同的数据，这可能是最简单的解决方案。否则，您必须遍历集合，删除不再在返回集中的项目并添加新项目。

# mysql - 来自两个不同表的mysql时间总和

> ID：14968949
> 
> 赞同：1
> 
> 时间：2013-02-19T22:38:13.513
> 
> 标签：mysql, nested, sum

[http://sqlfiddle.com/#!2/b814c/6/0](http://sqlfiddle.com/#!2/b814c/6/0)

```
select listener, SEC_TO_TIME( SUM( TIME_TO_SEC(time))) as total_time, count(listener) as total_listened from db1 where date = "2013-02-20" group by listener 
```

如何将 db2 值添加到此查询？

我尝试了嵌套查询，但它运行得太慢并且不只显示 db2 侦听器。

如果它改变了某些东西，这两个表都在不同的数据库中。

结果应该与此样本类似；

```
LISTENER    TOTAL_TIME  TOTAL_LISTENED
listener1   00:15:39    1
listener2   00:22:59    2
listener3   00:13:34    1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:45:26.923

这是您的原始查询

```
select listener, SEC_TO_TIME( SUM( TIME_TO_SEC(time))) as total_time,
count(listener) as total_listened from db1 where date = "2013-02-20"
group by listener 
```

尝试结合`listener`和`time`列

然后，将您的操作应用到他们的 UNION

```
SET @GivenDate='2013-02-20';
SELECT listener,SEC_TO_TIME( SUM( TIME_TO_SEC(time))) as total_time,
COUNT(listener) as total_listened
FROM
(
    SELECT listener,time FROM db1
    where date = @GivenDate
    UNION ALL
    SELECT listener,time FROM db2
    where date = @GivenDate
) A GROUP BY listener; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:46:27.017

你在找吗？

```
select listener, SEC_TO_TIME( SUM( TIME_TO_SEC(time))) as total_time, count(listener) as total_listened from 
(
  SELECT * FROM db1
  UNION ALL
  SELECT * FROM db2
) A
where date = "2013-02-20" group by listener 
```

**[SQL 小提琴演示](http://sqlfiddle.com/#!2/b814c/10)**

# c++ - c++中的VisualState示例？

> ID：14968951
> 
> 赞同：0
> 
> 时间：2013-02-19T22:38:30.137
> 
> 标签：c++, winrt-xaml, visualstatemanager

有人可以为以下等效 C# 提供 C++ 示例吗？

```
VisualStateManager.GoToState(this, "statename", true); 
```

我不懂 C++，正在努力为另一组转换一些动画。MSDN 示例是空白的！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:40:39.060

它应该是：

```
VisualStateManager::GoToState(this, "statename", true); 
```

# git - 有没有办法从 git 中的特定提交中获取标签？

> ID：14968952
> 
> 赞同：0
> 
> 时间：2013-02-19T22:38:30.673
> 
> 标签：git, tagging, git-tag

如何获取特定 git commit SHA 上的 git 标签？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:38:30.673

使用*--contains*参数。

示例：要从 shell 中查看 SHA *abcd1234*上有哪些标签：

```
git tag --contains abcd1234 
```

它返回标签的名称

```
v1.1 
```

如果该特定提交上有多个标签，您将用换行符将它们分开：

```
v1.1
LATEST_STABLE
MY-TAG 
```

要通过 bash 脚本在环境变量中设置它：

```
export GIT_TAG=`git tag --contains $MY_SHA` 
```

# r - 从最接近给定元素的值的向量返回索引

> ID：14968954
> 
> 赞同：8
> 
> 时间：2013-02-19T22:38:33.860
> 
> 标签：r

我有一个元素列表，例如

```
A=
  0.992688
  0.892195
  0.889151
  0.380672
  0.180576
  0.685028
  0.58195 
```

给定一个输入元素，比如 0.4，我怎样才能找到包含最接近这个数字的数字的索引。例如，`A[4] = 0.380672` 最接近 0.4。因此，它应该返回到 4

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-19T22:48:19.987

I would use `which.min`

```
which.min(abs(x-0.4)) 
```

This will return the first index of the closest number to `0.4`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-19T22:40:18.713

单程：

```
# as mnel points out in his answer, the difference,
# using `which` here gives all indices that match
which(abs(x-0.4) == min(abs(x-0.4))) 
```

`x`你的向量在哪里。

交替，

```
# this one returns the first index, but is SLOW
sort(abs(x-0.4), index.return=T)$ix[1] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-01-29T17:28:40.797

你也可以使用`base::findInterval(0.4, x)`

# php - 将扩展配置文件实体添加到 FOS UserBundle

> ID：14968969
> 
> 赞同：8
> 
> 时间：2013-02-19T22:39:16.483
> 
> 标签：php, symfony, fosuserbundle

我正在尝试扩展 FOS UserBundle 以允许扩展的配置文件实体在基本 UserBundle 字段之外保存其他信息。因为我在网站上有多种类型的用户，所以我创建了单独的实体来保存个人资料信息。我的实体设置如下：

```
class UserProfile
{
    /**
     * @var integer
     */
    private $id;

    /**
     * @var integer
     */
    private $userId;

    /**
     * @var string
     */
    private $phone;

    /**
     * @var string
     */
    private $language;

    /**
     * @var string
     */
    private $company;

    /**
     * @var string
     */
    private $salutation;

    /**
     * @var string
     */
    private $fax;

    /**
     * @var string
     */
    private $region; 
```

我的配置

```
type: entity
table: user_profile
fields:
    id:
        type: integer
        id: true
        generator:
            strategy: AUTO
    phone:
        type: string
        length: '15'
    language:
        type: string
        length: '50'
    company:
        type: string
        length: 255
    salutation:
        type: string
        length: '5'
    fax:
        type: string
        length: '15'
    region:
        type: string
        length: 255
oneToOne:
    userId:
        targetEntity: User
        joinColumn: 
            name: user_id
            referencedColumnName: id
lifecycleCallbacks: {  } 
```

我还有其他几种用户类型，它们的具体信息完全不同，所以我需要单独的实体，例如我可能有一个用户有 3 个地址或员工 ID 等。鉴于此，我应该如何实施注册表单在创建 UserBundle 信息时创建用户配置文件信息？提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-20T02:26:07.870

如果您使用 MySQL 和 php 作为实体定义，则必须按如下方式创建实体：

```
<?php
// src/Acme/UserBundle/Entity/UserProfile.php

namespace Acme\UserBundle\Entity;

use FOS\UserBundle\Entity\User as BaseUser;
use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\Entity
 * @ORM\Table(name="user_profile")
 */
class UserProfile extends BaseUser
{
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
     * @var string
     */
    private $phone;

    /**
     * @var string
     */
    private $language;

    //....................
    //Add all your properties here

    public function __construct()
    {
        parent::__construct();
        // your own logic
    }
} 
```

第二步是创建表单类型，询问您想要的字段：

```
// src/Acme/UserBundle/Form/Type/RegistrationFormType.php
<?php

namespace Acme\UserBundle\Form\Type;

use Symfony\Component\Form\FormBuilderInterface;
use FOS\UserBundle\Form\Type\RegistrationFormType as BaseType;

class RegistrationFormType extends BaseType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        parent::buildForm($builder, $options);

        // add your custom field
        $builder->add('phone');
        $builder->add('language');

        //...............
        //Add all your properties here with $builder->add('property name')
    }

    public function getName()
    {
        return 'acme_user_registration';
    }
} 
```

现在你需要让包知道你想使用你的自定义表单：

```
# src/Acme/UserBundle/Resources/config/services.yml
services:
    acme_user.registration.form.type:
        class: Acme\UserBundle\Form\Type\RegistrationFormType
        arguments: [%fos_user.model.user.class%]
        tags:
            - { name: form.type, alias: acme_user_registration } 
```

最后一步是告诉 FOSUserBundle 它将使用您的表单类型而不是默认类型：

```
# app/config/config.yml
fos_user:
    # ...
    registration:
        form:
            type: acme_user_registration 
```

**资源：**

[https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/index.md#step-3-create-your-user-class](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/index.md#step-3-create-your-user-class)
[https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master /Resources/doc/overriding_forms.md](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/overriding_forms.md)

# html - twitter Bootstrap 侧边栏和内容

> ID：14968975
> 
> 赞同：0
> 
> 时间：2013-02-19T22:39:37.487
> 
> 标签：html, css, twitter-bootstrap

我正在使用 twitter bootstrap 开发应用程序，

一个子标题，一个侧边栏和主要内容。以下是测试。

此处为 Photoshop 示例！[示例][1]

我想重现这个例子，但结果并不好

```
<div class="navbar">
    <div class="navbar-inner">
        <a class="brand" href="#">Title</a>
        <ul class="nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#">Link</a></li>
            <li><a href="#">Link</a></li>
        </ul>
    </div>
</div>
<div id="sub-header">subheader???</div>
<div class="container-fluid">
    <div class="row-fluid">
      <div class="span9" id="file">
          <ol class="group" id="alist">
            <li>
              <div class="filename">
                  <i class="icon-ban-circle"></i>
                  <span> 3 files .</span>
              </div>
              <div class="alist">
                  <span class="info">28 minutes ago</span>
              </div>
           </li>
        </ol>
     </div>
    <div class="span3" id="sidebar">
    <li>
        <div class="filename2">
           <i class="icon-ban-circle"></i><span> INFO .</span>
        </div>
    </li>
      <div class="row-fluid" >
        <div class="span12 center-block">
    <li>
        <div class="filename">
           <i class="icon-ban-circle"></i><span> INFO .</span>
        </div>
    </li>
        </div>
      </div>
    </div>
  </div>

</div> 
```

在线测试：http: [//jsfiddle.net/q2CBj/](http://jsfiddle.net/q2CBj/)

那么如何使用 twitter bootstrap重现良好的**子标题**和**内容？**

对不起我的英语不好。

谢谢你的未来回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T23:03:54.383

[bootstrap docs](http://twitter.github.com/bootstrap/getting-started.html#examples)上有一堆示例布局，看看它们。

首先，您尝试过什么？我建议您尝试使用引导程序的主题滚轮，[http](http://bootswatchr.com/) ://bootswatchr.com/或[http://www.bootstrapthemeroller.com/](http://www.bootstrapthemeroller.com/)，您可以在其中轻松创建您想要的内容。

# php - 用javascript形成一个数组，然后将数组发送到php提交到数据库

> ID：14968976
> 
> 赞同：0
> 
> 时间：2013-02-19T22:39:37.420
> 
> 标签：php, javascript, html, arrays

我正在尝试从这种形式形成一个 javascript 函数：

```
<form class="responseForm" action="javascript:parseResponse123<?php echo $id; ?>()" id="responseForm<?php echo $id; ?>"> 
<input name="hiddenField5<?php echo $id; ?>" id="hiddenField5<?php echo $id; ?>" type="hidden" value="<?php echo $id; ?>" />
<input name="hiddenField4<?php echo $id; ?>" type="hidden" id="hiddenField4<?php echo $id; ?>" value="<?php echo $qty; ?>" />

<font color="red"><?php echo $val; ?></font><br />
<?php
$i=1;
while($i<=$qty)
{
?>
Participant <?php echo $i; ?>:<input name="hiddenField2[]" id="hiddenField2" type="text" /><br />
<?php  $i++;
 }
 ?>
<input name="submit" type="submit" value="Submit" />
</form> 
```

参与者输入字段 (hiddenfield2) 可以是具有相同名称和 ID 的 1 个或多个字段。

然后我有这个代码提交到 php 页面：

```
function parseResponse123<?php echo $id; ?> () 
{
var hiddenField2<?php echo $id; ?> = $("#hiddenField2<?php echo $id; ?>");
var hiddenField4<?php echo $id; ?> = $("#hiddenField4<?php echo $id; ?>");
var hiddenField5<?php echo $id; ?> = $("#hiddenField5<?php echo $id; ?>");
var hiddenField1<?php echo $id; ?> = $("#hiddenField1<?php echo $id; ?>");

var url = "insert.php";

    $.post(url,{  hiddenField2: $('[name="hiddenField2<?php echo $id; ?>[]"]').serialize(),hiddenField: hiddenField5<?php echo $id; ?>.val(), hiddenField1:hiddenField1<?php echo $id; ?>.val(), hiddenField4:hiddenField4<?php echo $id; ?>.val()  } , 
    function(data) {

    });
    setTimeout(function() {

    $.ajax({
    type:"POST",
    data:"getNews=true",
    success: function(r){
        $("#newsContent").html(r);

    },
    error: function(){
 alert($(".hiddenField2<?php echo $id; ?>").val());     
$("#error").text($(".hiddenField2<?php echo $id; ?>")).fadeIn(300)
    }
})

},200);
 } 
```

请忽略其中的所有 echo id，它们比任何东西都更适合将来使用。我需要帮助使用 javascript 为 hiddenField2 形成数组，然后将其提交到 insert.php，然后如何解码数组以便 php 可以使用 foreach 循环。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T23:09:17.580

您应该查看 jQuery Serialize 函数：

[http://api.jquery.com/serialize/](http://api.jquery.com/serialize/)

```
$.ajax({
type:"POST",
data: $("#form-id").serialize(),
success: function(r){
 // do something here after success
}); 
```

**编辑：详述**

我没有测试这个，但你可以做这样的事情

```
<form class="responseForm" action=""> 
<input name="formData[id]" type="hidden" value="<?php echo $id; ?>" />
<input name="formData[qty]" type="hidden" value="<?php echo $qty; ?>" />

<font color="red"><?php echo $val; ?></font><br />
<?php
$i=1;
while($i<=$qty)
{
?>
Participant <?php echo $i; ?>:<input name="formData[participants][]" type="text" /><br />
<?php  $i++;
 }
 ?>
<input name="submit" type="submit" value="Submit" />
</form> 
```

为 javascript 使用这个

```
<script>
    $("form.responseForm").submit(function(e){
        e.preventDefault();
        var formData = $(this).serialize();
        $.ajax({
            url : '/insert.php', // assuming from root of your domain dir 
            type:"POST",
            data: formData,
            success: function(response){
                $("#newsContent").html(response);
            },
            error: function(){

            }
        });
    });
</script> 
```

并在您的 insert.php 中

```
<?php

    $formData = $_POST['formData']; // an array of the form
    foreach($formData['participants'] as $participant){
        // do something
    }
?> 
```

# r - 创建嵌套 for 循环以用于 R 中的抓取

> ID：14968977
> 
> 赞同：1
> 
> 时间：2013-02-19T22:39:37.200
> 
> 标签：r, loops, nested-loops

我在执行嵌套 for 循环以创建用于抓取的词干列表时遇到问题。简单的数据框包含 2 个变量，名称和照片数量。我希望代码吐出这样的词干列表/矩阵：

亚历克斯/1 亚历克斯/2 亚历克斯/3 爱丽丝/1 .....

我可以在一次做一行时让它工作，但不幸的是我无法弄清楚如何通过所有名称的循环来完成它。

任何帮助将不胜感激，希望任何想用这种结构抓取 HTML 的人都可以使用！

**到目前为止，这是我的代码：**

```
stems<-list()
for(Name in data$Names){
    for(Photo in data$Photos)
    stems[Photo]<-print(paste(Name,1:data$Photos,sep="/"))
}
stems.matrix<-as.matrix(stems) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T22:52:33.383

这是你想要的吗？我知道你说你想要一个列表，但我认为字符向量同样简单。

```
#I'm guessing your data looks something like this...
data <- data.frame( Names = c("Simon" , "Alex" , "Ben", "Dave") , Photos = c( 4 , 3 , 2 , 3) , Misc = c( 4 , 3 , 4 , 4 ) )

#Use apply rather than nested loops
stem.list <- unlist( apply( data , 1 , function(x) { i <- 1:x[2]; paste( x[1] , i , x[3] , sep ="/") } ) ) 
```

这使...

```
> stem.list
 [1] "Simon/1/4" "Simon/2/4" "Simon/3/4" "Simon/4/4" "Alex/1/3"  "Alex/2/3"  "Alex/3/3" 
 [8] "Ben/1/4"   "Ben/2/4"   "Dave/1/4"  "Dave/2/4"  "Dave/3/4" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T23:00:08.750

```
 dat <- data.frame(name=letters[1:4],photo=1:4)
 dat.ex <- expand.grid(dat)
 paste(dat.ex[,1],dat.ex[,2],sep='/')
 [1] "a/1" "b/1" "c/1" "d/1" "a/2" "b/2" "c/2" "d/2" "a/3" "b/3" "c/3" "d/3" "a/4" "b/4" "c/4" "d/4" 
```

# c# - MVC 路由不适用于虚拟目录上的非默认/根操作控制器

> ID：14968979
> 
> 赞同：3
> 
> 时间：2013-02-19T22:39:39.663
> 
> 标签：c#, asp.net, asp.net-mvc-2

我在 IIS 上使用默认的“ASP.NET MVC 2 Web 应用程序”（我没有管理员访问权限），虽然我可以导航到

“服务器/ITEC”

如果服务器不返回错误，我无法导航到“服务器/ITEC/About” - 404 错误。

我还在使用 RouteDebugger 进行测试 - 当我使用默认的“服务器/ITEC”时，它匹配（也就是默认的主页/索引控制器操作）但是当我手动输入“服务器/ITEC/About”时，我什至看不到RouteDebugger 页面。另外，值得注意的是，当我在“server/Itec/About”中放置一个“index.html”文件时，它会返回结果，这让我相信该目录配置为使用文件系统，而不是在处理请求时使用 MVC 路由- 这是一个安全的假设吗？

如何更新我的 Global.asax 文件，以便我可以返回非默认控制器/操作？或者这是服务器问题，我该如何解决？

谢谢！

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.Web.Routing;

namespace mikeProg
{
    // Note: For instructions on enabling IIS6 or IIS7 classic mode,
    // visit http://go.microsoft.com/?LinkId=9394801

    public class MvcApplication : System.Web.HttpApplication
    {
        public static void RegisterRoutes(RouteCollection routes)
        {
            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");           

            routes.MapRoute(
                "Default", // Route name
                "{controller}/{action}/{id}", // URL with parameters
                new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults            
            );

            RouteDebug.RouteDebugger.RewriteRoutesForTesting(RouteTable.Routes);

        }

        protected void Application_Start()
        {
            AreaRegistration.RegisterAllAreas();

            RegisterRoutes(RouteTable.Routes);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T23:35:59.750

我想通了！

在 aspnet_isapi.dll 的通配符应用程序映射部分中，复选框

“验证该文件是否存在”被选中。

一旦我要求系统管理员取消选中它，一切都完美路由。

为什么这甚至是一个选择？？？我什么时候使用它？

# c++ - boost 序列化对大对象抛出异常

> ID：14968986
> 
> 赞同：0
> 
> 时间：2013-02-19T22:40:00.283
> 
> 标签：c++, serialization, boost, boost-serialization

我正在尝试序列化大小超过 50mb 的对象——特别是，这些对象包含非常大的浮点数组（50+ 百万）。序列化函数似乎失败，并抛出异常 (e=735)。

关于为什么会发生这种情况以及如何解决问题的任何想法？

注意：序列化大小小于一个数量级（500 万个浮点数或更少）的对象没有问题。

# bash - emacs 编译：在后台调用脚本

> ID：14968989
> 
> 赞同：0
> 
> 时间：2013-02-19T22:40:07.877
> 
> 标签：bash, emacs, compile-mode

我有一个脚本（我们称之为`ding`），它在后台播放声音（基本上只是调用`paplay <file> &`）。我希望在完成编译后从 emacs 调用它，如下所示：

`M-x compile`,`make && ding`

不幸的是，因为`paplay`在后台调用，所以什么都没有发生（没有声音播放）。如果我删除`&`from `ding`，声音播放得很好。

为什么会发生这种情况，有没有办法让脚本在编译模式下在后台执行（不使其成为前台作业）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T00:17:05.963

当命令完成时，Emacs 将关闭命令的输出，但很可能`paplay`不是这样。尝试`nohup paplay ... &`

# ruby-on-rails - 从rails3中的数组声明范围

> ID：14968993
> 
> 赞同：0
> 
> 时间：2013-02-19T22:40:24.037
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rails-activerecord, scopes

我有一个符号数组，我想在 ActiveRecord 模型中为每个符号声明一个范围。

以下不起作用：

```
@@animal_types = [:horse, :cat, :dog]
@@animal_types.each do |a|
    scope a, :conditions => "animal_type = '#{a.to_s}'"
end 
```

实现这一目标的最佳方法是什么？

**更新：**我测试不正确，这确实有效