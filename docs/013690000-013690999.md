# StackOverflow 问答 13690000-13690999

# javascript - 如何使用 JS 捕获 html 表单上的所有击键？

> ID：13690000
> 
> 赞同：1
> 
> 时间：2012-12-03T19:09:55.743
> 
> 标签：javascript, html, javascript-events

当光标位于表单内时，有没有办法捕获所有击键。我需要检测 ENTER 命中，然后模拟 TAB 命中（光标跳转到下一个表单元素）。为什么？人们（会计师）习惯于用单手输入数据，只需使用数字键盘。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:17:58.993

这是我用来在 asp.net 网格中模拟“Enter”键的代码，就像“TAB”键一样：

```
function handleEnter (field, event) {
    var keyCode = event.keyCode ? event.keyCode : event.which ? event.which : event.charCode;
    if (keyCode == 13) {
        var i;
        for (i = 0; i < field.form.elements.length; i++){
            if (field == field.form.elements[i]) //Find the control's index
                break;
        }
        i++; // Go to next control index
        var precField = field.form.elements[i];

        if (precField.type == 'text') {
            if (field.form.elements[i+1].type == 'hidden' && field.form.elements[i + 2].type!='submit')
                handleEnter(field.form.elements[i + 1], event);
            else
                precField.focus();
        }
        else if (precField.type != 'hidden')
            handleEnter(precField, event);

        return false;
    } 
    else
        return true;
} 
```

如您所见，它只是从 1 个文本字段到另一个 ( `if (precField.type == 'text')`)，但我相信您可以根据需要对其进行调整。

我将 js 函数添加到我的 TextBoxes 的 OnKeyDown 事件中：

```
<asp:TextBox ID="txtP1s" runat="server" OnKeyDown='return handleEnter(this, event);'></asp:TextBox> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T19:40:54.160

这是一些在表单中模拟选项卡的 jQuery。您需要以`:input`与您所在的形式相同的形式获取所有元素，然后遍历。它也适用于复选框和任何其他`:input`捕获的表单元素。

**演示：http: [//jsfiddle.net/hbV5b/](http://jsfiddle.net/hbV5b/)**

```
var onkey = function(e) {
    if ( e.which == 13 ) {
        e.preventDefault();
        var index = -1,
            el = this,
            $forms = $(this).closest('form').find(':input').each(function(i) {
                if( this === el ) {
                    index = i+1;
                    return false;
                }
            });
        index < $forms.length ? $forms[index].focus() : $(el).blur()
    }
};
// attach/detach the handler
$(':input').focus(function() {
    $(this).keypress(onkey);
}).blur(function() {
    $(this).unbind('keypress', onkey);
});
​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T19:18:56.120

使用 JQuery，您可以在按下 ENTER（键代码 13）时模拟 TAB（键代码 9），使用如下所示：

```
$(".input").keyup(function (e) {
    if (e.keyCode == 13) {
      jQuery.event.trigger({ type : 'keypress', which : 9 });
    }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T19:17:24.127

如果您的脚本使用 jQuery，那么：

```
var form = $('someForm');

form.find(':text').on('keyup', function(e) {
    if (e.which === 13){
       form.find(':text[tabindex = ' + (+$(this).prop('tabindex') + 1) + ']').trigger('focus');
    }
}); 
```

此代码需要每个字段的 tabindex 属性。例如：

第一个字段：

```
<input type="text" tabindex="1"> 
```

第二个字段：

```
<input type="text" tabindex="2"> 
```

在第一个字段中按 Enter 键后 - 焦点将传递给第二个字段。

# json-simple - 错误：包 org.json.simple 不存在

> ID：13690004
> 
> 赞同：2
> 
> 时间：2012-12-03T19:10:11.147
> 
> 标签：json-simple

我正在尝试以 JSON 格式解析 FourSqure.com 的返回值。我在 Google 上下载 json-simple-1.1.1.jar 并将其放在 lib 文件夹中：“C:\Java\jdk1.7.0\lib”，我的 Java 文件位于此文件夹中：“C:\Java\jdk1 .7.0\bin" 。

```
I set classpth: "C:\Java\jdk1.7.0\bin\Getlocations>set CLASSPATH=$CLASSPATH:$C:\Java\jdk1.7.0\lib\json-simple-1.1.1.jar" 
```

并编译它，它显示错误：

```
C:\Java\jdk1.7.0\bin\Getlocations>set CLASSPATH=$CLASSPATH:$C:\Java\jdk1.7.0\lib\json-simple-1.1.1.jar

C:\Java\jdk1.7.0\bin\Getlocations>javac GetLocation.java 
```

GetLocation.java:22：错误：包 org.json.simple 不存在导入 org.json.simple.JSONArray；^

我尝试以这种方式运行：“C:\Java\jdk1.7.0\bin\Getlocations>javac -classpath .;$C:\Java\jdk1.7.0\lib\json-simple-1.1.1.jar GetLocation.爪哇”

```
it still doesn't recognize "package org.json.simple".

After this I also try to set classpath in the "Invironment Variables" in the Window : 
"C:\Java\jdk1.7.0\lib\json-simple-1.1.1.jar;C:\Java\jre7\lib\json-simple-1.1.1.jar;C:\Program Files\Java\jre7\lib;C:\Program Files\Java\jdk1.7.0\lib;" 
```

但是当我运行 C:\Java\jdk1.7.0\bin\Getlocations>javac GetLocation.java

它仍然显示此错误：

```
C:\Java\jdk1.7.0\bin\Getlocations>javac GetLocation.java
GetLocation.java:22: error: package org.json.simple does not exist
import org.json.simple.JSONArray;
                  ^ 
```

如何设置 json-simple-1.1.1.jar 文件的 Classpath 以使其工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-06-18T10:51:27.067

回显您的路径以交叉检查您想要的 .jar 文件位置是否存在。尝试使用不同版本的 json-simple，以消除兼容性问题。我有类似的问题。解决问题后回信。快乐编码。

# objective-c - 如何在 tableView 中找到点击的附件按钮的 indexPath

> ID：13690008
> 
> 赞同：15
> 
> 时间：2012-12-03T19:10:19.923
> 
> 标签：objective-c, ios, uitableview, segue

我很简单`UITableView`，只有一个部分和几行。当用户单击单元格附件按钮（与 连接`detailsSegue`。我想知道它是哪个单元格行。所以我可以从我的数组中选择正确的对象并将其分配给下一个视图中的变量。

我使用了委托方法`tableview:accessoryButtonTappedForRowWithIndexPath:`并将 indexPath 值分配给我的私有财产`myRow`。比在`prepareForSegue:sender:`方法中我使用我的`self.myRow.row`值从数组中选择正确的对象。

我的问题是这两种方法似乎以错误的顺序执行。从 NSLog 我可以看到该`prepareForSegue:sender:`方法首先执行，而我的委托方法正在更改`self.myRow`它之后的值。

所以`prepareForSegue:sender:`方法总是将错误的对象传递给下一个视图（之前点击的那个）。

对不起我的英语家伙。提前感谢您的帮助。

```
-(void)tableView:(UITableView *)tableView accessoryButtonTappedForRowWithIndexPath:(NSIndexPath *)indexPath {
    self.myRow = indexPath;
    NSLog(@"tapped button at row: %i",self.myRow.row); 
}

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if([segue.identifier isEqualToString:@"addSegue"]) {
        AddViewController *avc = segue.destinationViewController;
        avc.delegate = self;
    }
    else if ([segue.identifier isEqualToString:@"detailsSegue"]) {
        NSLog(@"Segue row: %i",self.myRow.row);
        Annotation *annotation = [self.viewsList objectAtIndex:self.myRow.row];
        NSLog(@"Segue annotation object: %@",annotation.title);
        DetailsViewController *dvc = segue.destinationViewController;
        dvc.wikiKey = annotation.title;
    }
} 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-12-03T19:41:41.080

正如您所发现的，系统在向您发送`prepareForSegue:sender:`消息*之前*先向您发送`tableview:accessoryButtonTappedForRowWithIndexPath:`消息。

**但是**，当它向您发送`prepareForSegue:sender:`消息时，`sender`参数是`UITableViewCell`包含附件视图。您可以使用它来确定点击了哪一行的辅助按钮：

```
else if ([segue.identifier isEqualToString:@"detailsSegue"]) {
    NSIndexPath *indexPath = [self.tableView indexPathForCell:sender];
    Annotation *annotation = [self.viewsList objectAtIndex:indexPath.row];
    DetailsViewController *dvc = segue.destinationViewController;
    dvc.wikiKey = annotation.title;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T19:41:10.673

发件人将是附件按钮，对吗？在这种情况下，您应该能够通过超级视图向上找到它的包含单元格，然后获取该单元格的索引路径。我以前用过这样的方法来做第一部分：

```
+ (UITableViewCell *)findParentCellOfView:(UIView *)view {
  if (view == nil || [view isKindOfClass:[UITableViewCell class]]) {
    return (UITableViewCell *)view;
  }
  return [self findParentCellOfView:[view superview]];
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-11T07:30:42.397

// 我告诉你一个简单、更好、更简单的选择：-

// 解决方案 :- 可以在tableView的这个方法中给附属视图的按钮分配标签

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    // set accessory view
    UIButton *oValidHomeAccessryBtn = [UIButton buttonWithType:UIButtonTypeCustom];

    // set target of accessory view button
    [oValidHomeAccessryBtn addTarget:self action:@selector(AccessoryAction:) forControlEvents:UIControlEventTouchUpInside];

    // set tag of accessory view button to the row of table
    oValidHomeAccessryBtn.tag =indexPath.row;

    // set button to accessory view
    cell.accessoryView = oValidHomeAccessryBtn ;
} 
```

// 使你传入选择器的方法并获取标签值，你将获得点击的附件视图的 indexPath

```
- (void)AccessoryAction:(id)sender
{
    NSLog(@"%d",[sender tag]);
} 
```

这是获取单击附件视图所在行的 indexPat 的最简单方法。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-12-03T19:18:48.883

您需要做的是`segue`从委托方法中以编程方式调用。假设您正在使用情节提要，您需要`segue`在情节提要和委托方法中取消链接：

```
[self performSegueWithIdentifier: @"IdentifierNameHere" sender: self]; 
```

# php - 在重写 htaccess 中强制使用斜杠

> ID：13690009
> 
> 赞同：0
> 
> 时间：2012-12-03T19:10:23.363
> 
> 标签：php, apache, .htaccess

我的 htaccess

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)/(.*)$ /sentence-examples/examplesentence.php?havethis=$1&word=$2 [L] 
```

结果 URL 为 /sentence-examples/acco-acti/accolading/

如果我删除最后一个斜杠 /sentence-examples/acco-acti/accolading 仍然可以正常工作

如果我删除第三个斜杠 /sentence-examples/acco-acti <- 404's

有没有办法强制使用斜线，所以即使用户键入没有斜线的 url，它也会将其更改为斜线？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:06:16.997

尾部斜杠的问题是它们可以修改查询。例如：

```
 http://mysite.com/index.php?par=this_query
 // is differente from
 http://mysite.com/index.php?par=this_query/ 
```

在最后一种情况下，$_GET 值有一个尾部斜杠，这通常会导致错误。

所以是的，有一些方法可以在 .htacces 文件中强制使用斜杠，但这不是一个好主意。已经很难弄清楚在某些情况下如何删除它们，为什么还要创建更多。

# asp.net - urlRewriting 后 Page.IsPostBack 始终为 false

> ID：13690010
> 
> 赞同：0
> 
> 时间：2012-12-03T19:10:25.983
> 
> 标签：asp.net, url-rewriting

我有一个奇怪的问题。

url 重写后，Page.IsPostBack 总是返回 false。

我正在使用指向函数的链接，例如，

```
<a href="#" onclick="return getHelp('4','P')"> 
```

这将转到页面方法下方的 js 文件和 js 调用。

```
<script>
function getHelp(id, type) {
PageMethods.displayHelp(id, type, CallSuccess, CallFailed);
}
</script> 
```

这是我尝试从 javascript 访问的 pageMethod，

```
[System.Web.Services.WebMethod]
public static string displayHelp(string id, string type)
{
 response.writeline(id+type);
} 
```

如果我不使用 urlrewriting 它工作完美。但是，如果我使用 urlrewriting，则无法识别回发。

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:13:43.700

从您的代码中我看不出来，但如果您只是通过 JavaScript 重新加载页面，回发模型将被破坏。

```
Page.ClientScript.GetPostBackEventReference() 
```

获取客户端回发方法。

# proxy - 鱿鱼 dstdom_regex 不工作

> ID：13690011
> 
> 赞同：1
> 
> 时间：2012-12-03T19:10:30.130
> 
> 标签：proxy, centos, squid

我想在 squid 3.2.3 中拒绝所有以 iso 开头的 URL 所以，我放入了 squid.conf：

```
 acl torrent_sites dstdom_regex -i iso
  acl music_sites dstdom_regex -i music 
```

和我的 http 控件，如：

```
 http_access allow localhost
  http_access allow localnetp1
  http_access deny torrent_sites localnetp1
  http_access deny music_sites
  http_access deny ftp_request
  http_access deny localnetp1 norm_conn
  http_access deny all 
```

但是我可以进入isohunt.com页面，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-10T10:14:15.340

I'm using a slightly different method. I'm using the standard squid.conf file but changed the `#acl localnet src 192.168.0.0/16` to my network IE: "192.168.1.0". Then search the conf file for the section that reads,

```
#deny_info TCP_RESET ads". 
```

just **above** the TCP_RESET line, add the following.

```
acl torrent dstdom_regex "/path/torrent_sites.txt"
http_access deny torrent
acl music dstdom_regex "/path/music_sites.txt"
http_access deny music 
```

Now create 2 text files (`/path/torrent_sites.txt` and `/path/music_sites.txt`) that contain your URLs in the following format.

```
(^|\.)isohunt\.com$
(^|\.)thepiratebay\.org$
(^|\.)torrentz\.com$ 
```

etc.

```
sudo /etc/init.d/squid3 restart 
```

or however else you want to restart it and everything should be good to go!

Blacklists can be found here: [squid ACL examples & blacklist to download](http://dobo.us/squid.html)

# google-custom-search - 使用多个搜索标签的 Google 自定义搜索 - 优化？

> ID：13690014
> 
> 赞同：3
> 
> 时间：2012-12-03T19:10:37.077
> 
> 标签：google-custom-search

使用 google 自定义搜索，可以使用 more: 运算符将结果细化为标签，如下所示：

```
searchterm more:blog 
```

但是如何将结果限制在多个标签上呢？看起来这应该有效：

```
searchterm more:blog,articles 
```

..但它似乎没有 - 相反，它被忽略，就好像我指定了一个无效的标签一样。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T15:10:44.767

根据我的研究，您不能`more:`在 Google 查询字符串中使用运算符，原因如下：

首先，[关于搜索优化的 Google 自定义搜索文档从未提供查询字符串示例](https://developers.google.com/custom-search/docs/refinements)。此外，[自定义搜索是通过 API 和 XML 请求执行的，而不是通过直接查询](https://developers.google.com/custom-search/docs/dev_guide)。

其次，详细说明（以下示例）如何自定义 Google 查询字符串的网站不包含带有`more:`标签的示例。所以，我认为不可能使用`more:`运算符创建标签。

*   [http://jwebnet.net/advancedgooglesearch.html](http://jwebnet.net/advancedgooglesearch.html)
*   [http://www.blueglass.com/blog/google-search-url-parameters-query-string-anatomy/](http://www.blueglass.com/blog/google-search-url-parameters-query-string-anatomy/)
*   [http://en.wikipedia.org/wiki/Google_Search#Search_options](http://en.wikipedia.org/wiki/Google_Search#Search_options)
*   [http://support.google.com/websearch/bin/answer.py?hl=en&p=adv_operators&answer=136861](http://support.google.com/websearch/bin/answer.py?hl=en&p=adv_operators&answer=136861)

[自动优化](http://support.google.com/customsearch/bin/answer.py?hl=en&answer=70346)的另一个发现。

> `more:`您的第二个选项是将运算符（后跟标签名称）自动附加到用户的查询中，以触发您的标签之一。您可以通过更改用户提交查询的搜索表单来做到这一点。

因此，可以使用`more:`运算符，但只能引用您已经创建的标签。

* * *

**更新**

此外，我建议使用 Google 的网站来[测试和排除 Linked CSE](http://www.google.com/cse/tools/cref)的问题。您可以[为搜索引擎定义自己的上下文](https://developers.google.com/custom-search/docs/context?hl=en)并满足您的要求。

```
<Facet>
    <FacetItem title="Blogs">
        <Label name="more:blog" mode="FILTER" weight="0.8">
        </Label>
    </FacetItem>
</Facet>
<Facet>
    <FacetItem title="Articles">
        <Label name="more:articles" mode="FILTER" weight="0.8">
        </Label>
    </FacetItem>
</Facet> 
```

这里还有一些资源：

*   [http://www.google.com/cse/](http://www.google.com/cse/) - Google 有一个向导来帮助创建和自定义搜索
*   [Google 帮助文章 › 了解详情 › 搜索结果 > 改进](http://support.google.com/customsearch/bin/topic.py?hl=en&topic=11498&parent=&ctx=topic)
*   从[开发人员指南：入门](https://developers.google.com/custom-search/docs/start#refinements)页面：

    > **改进**
    > 
    > 细化是您按主题对网站进行分类的一种方式。例如，如果您有一个自行车搜索引擎，您可以拥有自行车维护、自行车评论、自行车商店、自行车技能等类别。您可以创建与您在“站点”选项卡中列出的站点相关联的优化标签。优化链接显示在搜索结果页面的顶部，用户可以单击它们来缩小搜索范围。一个搜索页面可以有多达 16 个优化链接。
    > 
    > 要创建细化标签，请单击**添加细化**并定义设置。要使用标签标记网站，请转到站点选项卡，选中站点旁边的复选框，然后从**标签操作**下拉列表中选择标签。您可以使用多个标签标记网站。
    > 
    > 在创建标签之前，您可能需要检查[现有标签](https://developers.google.com/custom-search/docs/ref_prebuiltlabels)并将您的资源与 Google 和其他用户共享。

*   如果你想通过 API 过滤结果，[程序员指南：过滤和排序搜索结果](https://developers.google.com/custom-search/docs/structured_search)有你需要的一切。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T12:44:11.870

我找到了一种在许多细化标签中进行搜索的方法。虽然不可能添加几个“更多”参数，但我们可以在查询中添加几个“更少”参数。

假设我们定义了这些细化标签： **博客、文章、新闻、文档**

做**+more:blogs +more:articles**会失败。

但是**+less:news +less:documents**会完成这项工作，并且只会在博客和文章中找到结果！

因此，可以使用 less 参数并仅获取您想要的类别；）

唯一奇怪的是，实际上 less 参数似乎不在谷歌 API 文档中......当它为您工作时，我很高兴收到您的反馈

# php - 使用 preg_replace() 的 PHP 正则表达式

> ID：13690017
> 
> 赞同：-4
> 
> 时间：2012-12-03T19:10:47.480
> 
> 标签：php, regex, preg-replace

假设我有字符串：`"Test [[1294]] example"`

我该怎么做才能`preg_replace()`从双括号中提取数字？

获取该数字的（贪婪）表达式是什么？- 它始终是双括号内的整数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:13:04.203

你会使用`preg_match()`，而不是`preg_replace()`：

```
$subject = 'Test [[1294]] example';
preg_match('/\[\[(\d+)\]\]/', $subject, $match);
echo $match[1]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T19:13:28.967

[您可能想查看教程。](http://www.regular-expressions.info/tutorial.html)

如果要“提取”数字，则无需`preg_replace`. 使用`preg_match`or `preg_match_all`（如果有多次出现）代替：

```
preg_match('/\[\[(\d+)\]\]/', $input, $matches);
$integer = $matches[1]; 
```

或者

```
preg_match_all('/\[\[(\d+)\]\]/', $input, $matches);
$integerArray = $matches[1]; 
```

如果不是“提取”，您实际上的意思是“我如何`preg_replace`使用这个术语并使用提取的整数”，您可以使用相同的正则表达式并引用捕获的整数，使用`$1`：

```
$output = preg_replace('/\[\[(\d+)\]\]/', 'Found this integer -> $1 <-', $input); 
```

这将导致：

```
Test Found this integer -> 1294 <- example 
```

# objective-c - prepareForSegue 和 MVC 设计

> ID：13690022
> 
> 赞同：0
> 
> 时间：2012-12-03T19:11:20.507
> 
> 标签：objective-c, model-view-controller, uitableview, segue

我有一个显示模型对象数据的基本表视图控制器，我们称之为 object `userInfo`。每个单元格都连接到不同的视图控制器，用户可以在其中修改`userInfo`属性。一个属性是数组`names`。数组中的每个`name`都显示在单个表格部分中。名称单元格连接到一个简单的视图控制器，其中包含一个文本字段来编辑`name`或添加`name`到数组中。

这是一个非常简单的概念，但我看到了几种不同的实现方式。我想使用最符合 MVC 设计的最干净的方法。

在我当前的实现中 prepareForSegue

```
if ([segue.identifier isEqualToString:@"EditName"]) {
        EditNameVC *controller = segue.destinationViewController;
        controller.userInfo = self.userInfo;
        NSArray *names = [self.userInfo objectForKey:@"names"];
        NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];
        NSDictionary *nameInfo = [names objectAtIndex:indexPath.row];
        NSString *name = [nameInfo objectForKey:@"title"];
        if (name) {
            controller.name = name;
        }
    } 
```

我通过`isEditing`BOOL 告诉 Edi​​tNameVc`nameInfo`字典将被替换而不是添加到`array`. 这在目标视图控制器中提出了一个问题。如果编辑 a `name`，vc如何知道替换字典的索引？我应该在 EditNameVC 中创建一个私有属性`oldNameObject`，遍历每个`nameInfo`ins`names`并使用`replaceObjectIdenticalTo`吗？我应该通过 indexPath 吗？任何一种选择都显得草率。

作为另一个考虑，EditTableVC 是否应该对模型对象一无所知，只是调用主表视图控制器的委托，然后修改模型对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T22:25:44.570

要使用块完成来执行此操作，您需要执行...

在编辑 viewController （你推的那个）中，你需要声明一个块指针

```
@interface YourClass : UIViewController

// some properties
@property (nonatomic, copy) void (^onCompletion)(NSString *editedName);

@end 
```

然后在实现中，您需要在调用完成操作时调用此块：

```
- (void)doneTapped;
{
  if (self.onCompletion) {
    self.onCompletion(self.editedName);    
  }
} 
```

现在您需要做的就是在您推动此控制器的位置设置回调

```
if ([segue.identifier isEqualToString:@"EditName"]) {
  // Create and set up controller

  controller.onCompletion = ^(NSString *editedString) {
    [self.navigationController popViewControllerAnimated:YES];

    // do whatever you want with the edited string
    // If names was mutable

    [names replaceObjectAtIndex:indexPath.row withObject:editedString];
  }
} 
```

我试图坚持使用相似的名称，但您很可能会更概括这一点

# c# - 在结构中声明的新受保护成员

> ID：13690026
> 
> 赞同：7
> 
> 时间：2012-12-03T19:11:49.937
> 
> 标签：c#

C# 编译器抱怨以下代码包含`new protected member declared in struct`. 问题是什么？

```
struct Foo {
    protected Object _bar;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-03T20:40:41.590

从[MSDN 文档](http://msdn.microsoft.com/en-us/library/hd2e1t2c%28v=vs.80%29.aspx)：

```
A struct cannot be abstract and is always implicitly sealed. 
```

看起来 C# 希望您使用“私有”而不是受保护。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T19:11:49.937

因为这是一个结构，所以它不能被覆盖。似乎 C# 编译器希望像结构这样的密封类型使用“private”关键字而不是“protected”关键字，即使在功能上没有任何区别。改用这个：

```
struct Foo {
    private Object _bar;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T19:14:26.207

结构是隐式密封的，因此您不能以任何方式创建后代，而受保护的修饰符意味着只有此类型的实例和派生类型的所有实例才能访问它。

# jsf - jsf - flash 范围 - 方法参数评估阶段

> ID：13690031
> 
> 赞同：0
> 
> 时间：2012-12-03T19:12:00.757
> 
> 标签：jsf, parameters

我考虑过使用 flash 范围来保存以前的站点 uri 以允许在目标站点上进行反向重定向。

在主站点上，ajax 调用一个 bean 方法将当前 URI 保存在 flash 中并导航到作为参数提供的目标子站点。

在子站点上，使用来自闪存的先前存储的 uri 调用来自 bean 的简单导航方法。

**这是问题所在：** 闪存中的数据是空的，但是当我在网站上打印出来时，它是正确的。

**子站点**

```
#{flash.PREVIOUS_URI}
<h:form>
    <h:commandLink value="Redirect from flash" 
        action="#{bean.navigate(flash.PREVIOUS_URI)}"/>
</h:form>

public String navigate(final String outcome)
{
    return outcome;
} 
```

是否在下一个请求上评估了`flash.PREVIOUS_URI`in the action 调用导致 flash 值为空？

或者我如何将它保存为网站上的 var 以使其工作？`<c:set>`似乎不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:40:15.633

的`action`属性`<h:commandLink>`是在回发请求的调用操作阶段而不是在初始请求的呈现响应阶段评估的，正如您所期望的那样。因此，在调用操作期间，flash 作用域属性将不再可用。

你最好的选择是通过它`<f:param>`：

```
<h:commandLink value="Redirect from flash" action="#{bean.navigate}">
    <f:param name="previousURI" value="#{flash.PREVIOUS_URI}" />
</h:commandLink> 
```

您可以通过`@ManagedProperty("#{param.previousURI}")`、`<f:viewParam name="previousURI">`或获取它`ExternalContext#getRequestParameterMap()`。

* * *

或者，如果这真的是您基本上拥有的所有东西（并且您基本上不需要执行任何业务操作），那么您也可以只使用它`<h:link>`。

```
<h:link value="Redirect from flash" outcome="#{flash.previousURI}" /> 
```

这样`<h:form>`就不需要了，而且您最终也会得到一个`<a>`可收藏且可搜索机器人索引的完整元素。

# ember.js - 在 Emberjs 中，如何将数据从一个视图传递到另一个视图？

> ID：13690036
> 
> 赞同：0
> 
> 时间：2012-12-03T19:12:27.610
> 
> 标签：ember.js

我有一个呈现`Comment`. 其中一条信息是评论更新的时间，我想使用视图来呈现它。

在我的“评论”车把模板中，我正在尝试这个：

```
{{view App.TimeView titleBinding="comment.updated_time"}} 
```

然后在我的“时间”车把模板中，我希望能够做到`{{title}}`，但这是未定义的。

我的`TimeView`样子是这样的：

```
App.TimeView = Em.View.extend({                                                                       
    templateName: 'time',                                                                                
    tagName: 'abbr',
    classNames: ['timeago'],                                                                                
    attributeBinding: ['title'],                                                                            

    didInsertElement: function() {
        this._super();                                                                                      
        this.$().timeago();                                                                                 
    }
}); 
```

我想要的最终结果是这样的：

```
<abbr class="timeago" title="TIMESTAMP_GOES_HERE">
    TIMESTAMP_GOES_HERE
</abbr> 
```

但是我对 Ember 的理解肯定有一些差距，因为那没有发生。

实现我的想法的正确方法是什么？

# java - 具有动态创建的数据成员的 Java 对象

> ID：13690042
> 
> 赞同：0
> 
> 时间：2012-12-03T19:12:41.067
> 
> 标签：java, class, object

我在 Javascript 中看到过，

```
var obj = {
}
function addMember(memberName,value) {
    obj[memberName] = value;
} 
```

IE。对象可以在对象/类声明中拥有名称未知的成员。那么在 Java 中是否有类似的方法，我可以将新成员添加到名称未知的对象中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T19:14:09.117

你可以用地图做到这一点。

```
Map<String, Object> map = new HashMap<>();

map.put(memberName, value); 
```

# cuda - 寄存器溢出是否可能导致 CUDA_EXCEPTION_5, Warp Out-Of-Range Address 错误？

> ID：13690043
> 
> 赞同：2
> 
> 时间：2012-12-03T19:12:43.273
> 
> 标签：cuda

我收到一个 CUDA_EXCEPTION_5, Warp Out-of-range Address 错误，我试图找出可能导致这种情况的各种情况。

我正在将一个 C 项目（由其他人编写）移植到 CUDA。C 代码非常多寄存器，在堆栈中实例化了许多数组。我假设寄存器溢出很可能会发生，这可能会触发扭曲超出范围错误。

请注意，我想让它首先运行，然后我将开始优化代码。

我正在使用 Compute Capable 3.0 硬件，根据维基百科，它有 512KB 的“每个线程的本地内存”。我在别处读到它每个 SM 有 512KB 的寄存器空间。每个正在运行的线程是否可以有 512KB 的寄存器空间？

我目前正在执行我的内核如下（是的，我知道它超慢）：

```
dim3 grid(28800,1);
cuPlotLRMap<<<grid,1>>>(...) 
```

一些细节（我不知道这会有多大帮助）：

我的硬件有 7 个 SM。有 112 个运行块，这是否意味着每个块获得 512k 的寄存器空间的 1/16？

我也明白如果一个线程超出了寄存器空间，它可能会溢出到全局内存中。发生这种情况时，并发线程是否有可能溢出到同一个全局内存空间中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:57:48.483

> “每个线程的本地内存”为 512KB。我在别处读到它每个 SM 有 512KB 的寄存器空间。每个正在运行的线程是否可以有 512KB 的寄存器空间？

请参阅CUDA C 编程指南中的[计算能力](http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#compute-capabilities)表。计算能力 2.x 及更高版本的设备支持每个线程最多 512KB 的本地内存。函数 cudaDeviceSetLimit( cudaLimitStackSize, bytesPerThread ) 可用于设置值。我相信默认值是每个线程 2 KB。

> 我的硬件有 7 个 SM。有 112 个运行块，这是否意味着每个块获得 512k 的寄存器空间的 1/16？

计算能力 3.x 设备每个多处理器最多可以有 16 个驻留块。这假设您的寄存器/线程、线程/块或共享内存/块不会将内核限制为小于设备最大值。Visual Profiler 和 Nsight VSE CUDA Profiler 您的内核使用的配置。

目前，您只启动 1 个线程/块。您应该在每个块 (32) 中启动多个 WARP_SIZE。

> 我也明白如果一个线程超出了寄存器空间，它可能会溢出到全局内存中。发生这种情况时，并发线程是否有可能溢出到同一个全局内存空间中？

在编译或 JIT 时，编译器将执行寄存器分配。如果每个线程没有足够的寄存器，那么编译器将溢出到本地内存。此操作是确定性的，而不是在运行时确定的。

计算能力 3.0 设备限制为 63 个寄存器/线程。计算能力 3.5 设备限制为每个线程 255 个寄存器。

# jquery - jstree在删除后不移动节点

> ID：13690044
> 
> 赞同：1
> 
> 时间：2012-12-03T19:12:57.540
> 
> 标签：jquery, jstree

我正在尝试在 jstree 中设置拖放。我想要它，以便节点只能移动，不能重新排序。

我的`check_move`功能如下所示：

```
"crrm" : {
    "move" : {
        "check_move" : function (m) {
            if(m.p == "inside")
                return true;
            else
                return false;
        }
    }
}, 
```

但是，这似乎不起作用。树永远不会移动节点，并且`move_node`永远不会触发事件。

我有一个 JSFiddle 设置来演示我的意思：http: [//jsfiddle.net/PJcHm/1/](http://jsfiddle.net/PJcHm/1/)尝试拖放以将节点 2 移动到节点 1 内。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:19:05.120

经过一点调试，我想通了。看起来在释放将节点放入另一个节点后，该`check_move`函数被再次调用一次，级别变量`p`等于`"last"`。所以我为此返回错误。正确的代码是：

```
"crrm" : {
    "move" : {
        "check_move" : function (m) {
            if(m.p == "inside" || m.p == "last")
                return true;
            else
                return false;
        }
    }
}, 
```

# ruby-on-rails - 如何在 Rails 应用的每个文件中添加版权信息

> ID：13690051
> 
> 赞同：0
> 
> 时间：2012-12-03T19:13:15.713
> 
> 标签：ruby-on-rails, ruby, copyright-display

我需要在我的 Rails 源代码的每个文件的顶部添加版权信息。例如。**就像 Xcode 在您进行 ios 开发时所做的那样**。

喜欢：

```
**********
// Copyright (c) 2012 
// List of Authors
********* 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:19:43.087

通常的方法是在项目的基础中包含一个名为 LICENSE 的文件，并在其中包含项目中所有文件的所有版权信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:45:23.747

这实际上取决于您选择的编辑器，您应该指定。许多编辑器支持某种文件模板，例如，[这里是](http://www.jetbrains.com/ruby/webhelp/file-templates.html)如何在 Rubymine 中实现的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-03T19:20:12.197

对于视图，您可以将其放在`app/views/layouts/application.html.erb`文件的顶部，并且应该将其包含在每个视图中，除了部分视图（我认为您必须手动完成）。

不知道有没有办法自动为其他任何事情做这件事。虽然可能是错的。

# mobile - 我的页面不会在手机/平板电脑上滚动（在 opencart 上运行）

> ID：13690066
> 
> 赞同：2
> 
> 时间：2012-12-03T19:14:28.990
> 
> 标签：mobile, iframe, scroll, lightbox

我已经建立了一个站点，并且最近在其上添加了一个商店（建立在 opencart 平台上）。在浏览器上，我通过灯箱和 iFrame（彩盒）为购物车提供服务，并且效果很好。

网站：[http](http://www.gardenofflavor.com/) ://www.gardenofflavor.com/然后点击“商店”在浏览器中查看

但是带有 iFrame 的颜色框在 iOS 上无法正常运行（请参阅有关移动设备的 iFrame 线程（iOS6 似乎使情况变得更糟：[如何在移动 safari 中正确显示 iFrame](https://stackoverflow.com/questions/5267996/how-to-properly-display-an-iframe-in-mobile-safari/5359546#5359546)），因此我无法向移动用户提供相同的内容。

我正在考虑为移动用户提供直接链接作为临时修复，看起来不是最好的，但我需要这个功能。

移动/平板电脑用户将直接链接到商店（例如）：[https ://shop.gardenofflavor.com/index.php?route=product/category&path=59](https://shop.gardenofflavor.com/index.php?route=product/category&path=59)

我遇到的问题是页面不会在移动设备中滚动。我检查了与整个容器相关的绝对定位，但没有找到任何东西。我担心opencart js中有一些东西在移动设备上很有趣，这会导致问题吗？

# c# - 我究竟做错了什么？错误消息未显示

> ID：13690067
> 
> 赞同：0
> 
> 时间：2012-12-03T19:14:30.113
> 
> 标签：c#, javascript, html, regex

我有一个多行文本框，我不应该允许用户输入任何 HREF 链接。所以我正在尝试使用正则表达式进行字符串匹配，如下所示。但我没有收到错误消息。我究竟做错了什么？

```
Regex strMatch = new Regex(@"^(?:(?:<a )?href|</a>)", RegexOptions.Compiled | RegexOptions.IgnoreCase);
if (strMatch.IsMatch(EmailTextBox.Text.Trim()))
 {
   vsumPage.AddErrorMessage("Cannot enter links");
 } 
```

同样的检查也需要在 JS 中工作。但它给了我一些例外。不知道我做错了什么。这是我的 JS 函数

```
function doPreview()
 {
  var getEncodedStr = encode("<%=EmailTextBox.ClientID%>"); 
  var strInvalid = "Email instructions cannot have links included";
  var str = getEncodedStr.match(/@"(?:<a )?href|</a>"/) ;
  if (str == null)
  {
    var targetURL = 'Preview.aspx?txtName=' + getEncodedStr ;
    window.open(targetURL, null, "height=700,width=600,dependent=yes,hotkey=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=no,toolbar=no");
    return false;
  }
  else
  {
   alert(strInvalid);
  }
} 
```

这是我正在测试它的输出

```
Testing Testing <br/>
<b> Hello Testing </b> <br/>
<b> Testing 2000 character and link check </b> <br/>
<b> Hello </b> <a href="www.google.com">Click Me </a> 
```

再次更新：尝试了这个，如下所示：但它总是出现在警报“Test3 0”部分......即使是

```
 function doPreview()
      {
          var getEncodedStr = encode("<%=EmailTextBox.ClientID%>"); 
          var strInvalid = "Email instructions cannot have links included";
          var checkCount = "0" ;
          alert("Test 1" + checkCount);
          if(/<\/[\s\S]?a\b/gm.test(decode(getEncodedStr)))
          { 
            checkCount = "1" ;
            alert("Test 2" + checkCount);
            alert((/<\/?a\b/.test(decode(getEncodedStr))));
            return false;
          }
          if (checkCount == "0")
          {                  
            alert("Test 3" + checkCount);
            var targetURL = 'EPreview.aspx?txtName=' + getEncodedStr ;
            window.open(targetURL, null, "height=700,width=600,dependent=yes,hotkey=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=no,toolbar=no");
            return false;
          }
      } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:19:42.817

`^`断言此模式出现在字符串的开头。尝试删除它。您也可以将模式更改为：

```
@"</?a\b" 
```

这将通过使用单词边界（它断言之后没有字母或数字或下划线 - 而是一个空格或例如）来简单地查找`<a`或`</a`确保它确实是一个锚标记。`\b``>`

如果不这样做，那么查看您的实际输入确实会有所帮助。

# excel - 未登录时 Excel 无法启动

> ID：13690069
> 
> 赞同：2
> 
> 时间：2012-12-03T19:14:54.423
> 
> 标签：excel, vbscript, scheduled-tasks

这是我试图实现的事件序列： 计划任务 - 每天同时运行并启动 VBScript VBScript 启动 Excel 工作簿并运行宏。这是片段-

```
Set xlApp = CreateObject ("Excel.Application")
xlApp.Visible = False
Set xlBook = xlApp.Workbooks.Open (xlFilePath,0,False)
xlApp.Run "Main" 
```

现在的问题是，如果我手动运行任务，它运行良好。当我未登录到服务器时运行计划任务时，它不会启动 excel。当没有用户登录时，我必须在上面的代码中进行哪些更改才能启动 excel？我已将 Excel 宏安全性设置为低。

Excel 2003 和 Windows Server2003 64

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T21:04:33.313

Take a look at [MS Knowledge Base](http://support.microsoft.com/kb/257757) - according to this, Office apps need an UI to run.

Thus, try using any user but the system user:

> For example, code that is started by Task Scheduler under the SYSTEM account runs in the same environment as "server-side" ASP code or as DCOM code. Therefore, many of the issues that this article describes may occur.

Also, try to call `Main` from the Workbook_Open event in the Excel file instead of `xlApp.Run "Main"`...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-03-07T18:27:47.080

不确定它是否已经解决，但我遇到了问题并通过以下步骤解决。

创建以下文件夹

（32 位，始终）C:\Windows\System32\config\systemprofile\Desktop

(64Bit) 以上文件夹和 C:\Windows\SysWOW64\config\systemprofile\Desktop

如果您使用系统帐户运行，这将解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T19:58:39.420

You should be able to set an option to use a username when running the task as well as have the task run whether the user is logged on or not. Here's an example from Windows Server 2008:

![enter image description here](../Images/194c9b1c2786e853ce0096be59bde7b6.png)

# opengl - 如何通过 glm::mat4 转换 glm::vec3

> ID：13690070
> 
> 赞同：10
> 
> 时间：2012-12-03T19:14:57.200
> 
> 标签：opengl, transform, glm-math

我想用（camera.rotationMatrix）转换`glm::vec3`（`glm::mat4`camera.target）。我尝试乘以这给我一个错误：错误：'originalTarget * 中的'operator*' 不匹配`((Camera*)this)->Camera::rotationMatrix`。我想我不能乘以 vec3 * mat4。GLM 是否有一些功能可以改变这一点？其他方式进行转换？

编码：

```
void Camera::Update(void)
{
// Aplicamos la rotacion sobre el target
glm::vec3 originalTarget = target;
glm::vec3 rotatedTarget = originalTarget * rotationMatrix;

// Aplicamos la rotacion sobre el Up
glm::vec3 originalUp = up;
glm::vec3 rotatedUp = originalUp * rotationMatrix;

// Establecemos las matrices de vista y proyeccion
view = lookAt(
position, //eye
rotatedTarget, //direction
rotatedUp //up
);
projection = perspective(
FOV,
(float) getParent()->getEngine()->GetCurrentWidth() / getParent()->getEngine()->GetCurrentWidth() ,
near_plane,
far_plane);
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-03T19:21:10.877

您想首先将您的第 4 个元素转换`glm::vec3`为 a ，然后将它们相乘。`glm::vec4``0`

```
glm::vec4 v(originalUp, 0); 
```

# objective-c - iOS 应用程序在后台任务结束后运行

> ID：13690077
> 
> 赞同：0
> 
> 时间：2012-12-03T19:15:27.623
> 
> 标签：objective-c, ios, cocoa-touch, uiapplication

我制作了自定义 voip 应用程序。几乎一切都很好；但有时会重新启动应用程序。

```
From crash log:
Exception Type:  00000020
Exception Codes: 0xbad22222
Highlighted Thread:  4

SBUnsuspendLimit CryptTalkDev[24820] exceeded 15 wakes in 300 sec

Highlighted thread call stack:
Thread 4 name:  com.apple.NSURLConnectionLoader
Thread 4:
0   libsystem_kernel.dylib          0x35eab004 0x35eaa000 + 4100
1   libsystem_kernel.dylib          0x35eab1fa 0x35eaa000 + 4602
2   CoreFoundation                  0x355d93ec 0x3554c000 + 578540
3   CoreFoundation                  0x355d8124 0x3554c000 + 573732
4   CoreFoundation                  0x3555b49e 0x3554c000 + 62622
5   CoreFoundation                  0x3555b366 0x3554c000 + 62310
6   Foundation                      0x35094bb2 0x35084000 + 68530
7   Foundation                      0x35094a7a 0x35084000 + 68218
8   Foundation                      0x3512858a 0x35084000 + 673162
9   libsystem_c.dylib               0x329c872e 0x329ba000 + 59182
10  libsystem_c.dylib               0x329c85e8 0x329ba000 + 58856 
```

这次没有传入流量 - 我从应用程序日志中检查过。

前几分钟应用程序收到网络更改通知并开始在服务器上重新注册。后台任务开始保护它。在崩溃后台任务完成前一分钟。但是应用程序仍然运行 - 我在日志中看到它！

可能是什么原因？

PS检查今天控制台：

```
Dec  4 13:57:36 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:57:36 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:57:46 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:57:46 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:57:56 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:57:56 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:58:06 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:58:06 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:58:16 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:58:16 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:58:27 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:58:27 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:58:37 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:58:37 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:58:47 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:58:47 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:58:57 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:58:57 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:59:07 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:59:07 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:59:17 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:59:17 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:59:27 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:59:27 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:59:37 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:59:37 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:59:47 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:59:47 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:59:57 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 13:59:58 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 14:00:08 unknown SpringBoard[51] <Warning>: Unable to deliver SBApplicationNotificationStateChanged notification to port com.apple.springboard.appstatechanged: (ipc/send) timed out
Dec  4 14:00:08 unknown SpringBoard[51] <Warning>: SBUnsuspendLimit CryptTalkDev[3925] exceeded 15 wakes in 300 sec
Dec  4 14:00:08 unknown SpringBoard[51] <Warning>: Forcing crash report of CryptTalkDev[3925]...
Dec  4 14:00:09 unknown ReportCrash[3956] <Notice>: Formulating crash report for process ReportCrash[3955]
Dec  4 14:00:09 unknown SpringBoard[51] <Error>: simulatecrash call failed with status (-308)
Dec  4 14:00:09 unknown SpringBoard[51] <Warning>: Finished crash reporting. 
```

PPS Today 在应用程序上运行 I/O 活动工具。发现两件事：1）应用程序每10秒恢复一次，暂停100-200毫秒，然后再次恢复2）iOS系统调用中有socket I/O；不是 SIP 信令套接字。看起来它类似于 [http://trac.pjsip.org/repos/ticket/1482](http://trac.pjsip.org/repos/ticket/1482)

但困难的部分是找到断开连接的 tcp 套接字......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:29:44.287

解决。原因是后台模式的 tcp 连接准备不当。

对我来说正确的方法：

1.  为 BSD 套接字创建一对流（我使用 bsd 套接字）
2.  将两个流的 kCFStreamPropertyShouldCloseNativeSocket 设置为 kCFBooleanFalse
3.  将两个流的 kCFStreamNetworkServiceType 设置为 kCFStreamNetworkServiceTypeVoIP

步骤 1) - 3) 在从服务器接收到第一个数据后运行。

# php - 两个用户是否可以共享相同的浏览器和站点但具有不同的会话

> ID：13690083
> 
> 赞同：2
> 
> 时间：2012-12-03T19:15:38.020
> 
> 标签：php, session

尽管它可能不会经常发生，但可能会发生 UserA 已登录并具有活动会话的情况。然后 UserB 拿起笔记本电脑并想使用同一个站点。在 PHP 中是否可以对此进行测试并允许此操作，或者每个会话一个用户。

我遇到的示例是在测试时我让 userA 登录到他们的个人资料，然后对于 userB，我单击了一个链接来重置他们的密码，但是我没有点击密码重置页面，而是被重定向到 userA 的个人资料页面。这是我编码的方式，但我想知道这些天与家人一起在笔记本电脑上为每个人使用我是否应该设计一种方法让每个人都有自己的会话来处理电子邮件链接等案例？

**编辑：**我决定完全放弃这个想法。我将把它留给用户来保护他们的会话。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T19:22:33.173

我只是发布这个来展示它是如何成为可能的，但我**强烈**建议你永远不要尝试使用这种技术。它打开了整个安全问题的世界，您可以为用户提供的任何小便利都将被它引起的问题完全摧毁。

话虽如此，您可以使用 PHP `trans_sid`（“透明会话 ID”）支持，其中会话 ID 自动嵌入到 URL 中并作为隐藏的表单字段。这将允许您打开多个窗口，每个窗口都有自己的会话，窗口之间没有共享。

基本上，您将关闭基于 cookie 的会话并仅使用透明 ID：PHP 将自动修改`<a href="...">`以将会话 ID 参数添加到查询字符串中，并根据需要插入隐藏的表单字段。它不适用于 JS 代码等，但您可以在那里自己添加 ID。

但是，问题出在：既然会话 ID 嵌入在 URL 和表单中，为您网站上的页面添加书签会将书签与当时正在使用的特定会话联系起来。剪切和粘贴 URL 以共享某些内容也会将用户的会话传输给他们将链接发送给的任何人。从您的站点单击任何指向外部世界的链接都会将会话 ID 作为引用者的一部分传输。例如，您刚刚使会话劫持变得微不足道，因为用户每次做任何事情时都会在屋顶上大喊他们的会话 ID。

* * *

更简单的解决方案：使用浏览器的“色情模式”，这样每个窗口都有自己的 cookie 存储，将每个用户的窗口/会话与其他窗口/会话分开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:20:45.057

到目前为止，我担心 chrome 和 firefox 是可能的（我不使用其他浏览器）。这种功能称为“多会话”。

在 chrome 中，可以通过进入 chrome://chrome/settings/ 并将用户添加到 chrome 来激活它。

关于 com：

> 您的服务器如何知道谁在物理上使用笔记本电脑？传统的（明智的）手段实际上是不可能的

服务器只是问你一个 id 来获取你的会话。从技术上讲，这个 id 存储在一个 cookie 中，所以它链接到物理机

# android - Android：将字母数字键盘设置为在 EditText 中首先显示数字

> ID：13690084
> 
> 赞同：14
> 
> 时间：2012-12-03T19:15:40.173
> 
> 标签：android

我正在实现一个 Android 应用程序，我需要一个小费。通常，我`EditText`的只是数字，但有时是数字和字母。

这是我需要作为“默认”的键盘，当`EditText`聚焦时：

![数字键盘](../Images/835e0e1a9bee7ce3165e7761eb2d531a.png)

如果我放`android:inputType="phone"`or `android:inputType="number"`，结果不是我需要的：

![手机布局键盘](../Images/863d84857358eb3374289d6e778993da.png)

我需要数字和字母。那么，有可能做到吗？我已经试过了`inputType`。我尝试“混合”一些`inputType`s，例如`number | text`，，但没有任何变化。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-11-20T09:43:04.890

尝试这个

```
android:inputType="textVisiblePassword" 
```

[资源](https://stackoverflow.com/a/40702557/5327495)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-07-26T12:29:04.160

如果你想要一个通用键盘，你可以使用这个：

```
android:inputType="text" 
```

这将允许您使用带有所有特殊字符、数字和字母的默认键盘。

*看看问这个问题的日期，毫无疑问，要输入所需的键盘类型很麻烦。无论如何，如果您仍在跟踪这个问题。这是答案。*

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-12-03T19:26:23.503

```
<EditText android:inputType="number" ... /> 
```

上面的代码如果不能工作，必须需要**1.5 或更高版本** 也试试

```
EditText num = new EditText(this);
num.setInputType(InputType.TYPE_CLASS_NUMBER); 
```

# javascript - 从 2 个不同的 jQuery 代码触发触发器

> ID：13690087
> 
> 赞同：1
> 
> 时间：2012-12-03T19:15:52.310
> 
> 标签：javascript, jquery, triggers, click, fancybox

我正在尝试将 FancyBox 脚本与自定义幻灯片结合使用，但我无法使其工作。

这是我的页面： [http](http://www.edital.co.il/?page_id=37) ://www.edital.co.il/?page_id=37 （如果链接不起作用，请等待并重新加载）

如您所见（第 53 行），我在 fancybox 加载后立即弹出了它，只是为了测试 fancybox 是否正常工作。

问题始于脚本'http://www.edital.co.il/wp-content/themes/ediTal/library/js/libs/zoom-showcase.js?ver=3.4.2'（脚本在行加载145) 在文件内部，第 57 行：$this.trigger('click');

```
function gotoURL(event) {
    var $this = $(this); // the <li> that has the youtube href attribute.
    // the <li> has class="fancybox-youtube", so it should work:
    $this.trigger('click'); // should trigger the <li>, but its not! (the problem)
} 
```

触发器由 fancybox 在 html 文件的第 67 行设置：

```
jQuery(document).ready(function($){
    /* Fancybox code start... */
    var fb_timeout = null;
    var fb_opts = { 'overlayShow' : true, 'centerOnScroll' : true, 'showCloseButton' : true, 'showNavArrows' : true, 'onCleanup' : function() { if(fb_timeout) { window.clearTimeout(fb_timeout); fb_timeout = null; } } };
    $('[href*="youtube.com/"]:not(.nofancybox)').addClass('fancybox-youtube');
    $('[href*="youtu.be/"]:not(.nofancybox)').addClass('fancybox-youtube');
    $('.fancybox-youtube').fancybox( $.extend({}, fb_opts, { 'type' : 'iframe', 'width' : 640, 'height' : 390, 'padding' : 0, 'autoScale' : false, 'titleShow' : false, 'titlePosition' : 'float', 'titleFromAlt' : true, 'onStart' : function(selectedArray, selectedIndex, selectedOpts) { selectedOpts.href = selectedArray[selectedIndex].href.replace(new RegExp('youtu.be', 'i'), 'www.youtube.com/embed').replace(new RegExp('watch\\?v=([a-z0-9\_\-]+)(&|\\?)?(.*)', 'i'), 'embed/$1?version=3&$3') } }) );
    /* Fancybox code end... */

    /* Thats working, but gotoURL() does not. */ 
    $('a[class=fancybox-youtube]').filter(':first').trigger('click'); 
}); 
```

基本上是怎么回事：Fancybox 正在向任何带有 href=youtube 的标签添加“fancybox-youtube”类...

我的猜测-他们都有不同的美元，这就是他们不一起工作的原因。我不知道这是否是导致问题的原因。

# c# - 两个链表中的数字相乘

> ID：13690090
> 
> 赞同：0
> 
> 时间：2012-12-03T19:16:05.867
> 
> 标签：c#, linked-list

我正在尝试将存储在两个单链表中的数字相乘。但是，我的算法变得非常复杂。我正在按照我们在小学时所做的方式进行乘法运算。获取其中一个列表的值并乘以另一个列表的每个值，直到我们覆盖所有数字。问题是我必须在最后将这些数字相加才能得到乘法的最终结果，这就是我遇到麻烦的地方。我必须找到一种能够将任意数量的元素相乘并能够在最后将结果相加的方法。到目前为止我的代码是这样的

```
public SingleyLinkedList Multiply(SingleyLinkedList list1, 
                                  SingleyLinkedList list2)
        {
        SingleyLinkedList multiplyList = new SingleyLinkedList();
        SingleyLinkedList tempList1 = new SingleyLinkedList();
        SingleyLinkedList tempList2 = new SingleyLinkedList();

        for (int j = 0; j < list2.Size(); j++)
        {
            int carry = 0;
            int B = Convert.ToInt32(list2.GetValue(j));

            for (int k = 0; k < list1.Size(); k++)
            {

                int A = Convert.ToInt32(list1.GetValue(k));

                if (k == list1.Size()-1)
                {
                    int multiply = ((A * B) + carry);
                    multiplyList.InsertAtFront(multiply);
                    carry = 0;
                }
                if (k < list1.Size()-1)
                {
                    int multiply = ((A * B) + carry) % 10;
                    multiplyList.InsertAtFront(multiply);
                    carry = 0;
                }
                carry = (int)((A * B) / 10);
            }
        }
      //return multiplyList;

        for ( int t = 0 ; t < list2.Size() ; t++)
        {

            for (int n = 0; n < list1.Size(); n++)
            {
                int val = Convert.ToInt32(multiplyList.GetValue(n));
                tempList1.InsertAtFront(val);
            }

            // adding zero to take care of 10th                
            for (int m = 0; m < list2.Size() - 1; m++)
            {
                tempList1.InsertAtFront(0);
            }

        }

        return tempList1;` 
```

在这个阶段之后，我必须将我的值传递给我创建的 Add 方法，该方法将两个链表作为参数并进行加法。我需要能够对任意数量的数字执行此过程。有什么建议，或者您是否知道任何更好的乘法方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-29T19:32:12.713

您可能想要复制此 java 代码。

```
import java.util.LinkedList;
import java.util.ListIterator;

public class MultiplyTwoLinkedLists {

    public static void main(String[] args) {

        LinkedList<Integer> number1 = new LinkedList<Integer>();
        LinkedList<Integer> number2 = new LinkedList<Integer>();
        number1.addFirst(1);
        number1.addFirst(2);

        number2.addFirst(1);
        number2.addFirst(2);

        multiply(number1, number2);
    }

    public static int multiply(LinkedList<Integer> n1, LinkedList<Integer> n2){

        int placeValue1 = 1;
        int sum=0;
        for(int digit1 : n1){
            int placeValue2 = 1;
            for(int digit2 : n2){
                sum+=((digit1*placeValue1) * (digit2*placeValue2));
                placeValue2=placeValue2*10;
            }
            placeValue1=placeValue1*10;
        }
        System.out.println(sum);
        return 1;
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:46:02.957

这看起来像是对一个简单问题的不必要的复杂实现。闻起来像家庭作业。

您提到最终将值相加时遇到了麻烦（就像在长乘法中一样。

我建议实现一个`sum`方法，并使用一个`sum`列表。

将总和列表初始化为 0，然后在乘法过程的每次迭代之后，使用该`sum`方法将新列表添加到`sum`列表中。

或者，您可以为乘法的第一部分提供一个列表列表，然后在最后将所有这些列表相加。

此实现将占用更多内存，但可视化也会更容易一些。

# android - 为什么在列表适配器中没有调用自定义视图的 onDraw(Canvas canvas) 方法？

> ID：13690091
> 
> 赞同：3
> 
> 时间：2012-12-03T19:16:15.373
> 
> 标签：android

整个代码是这样的

首先是自定义视图类

```
public class AnimatedView extends View {
private static final String TAG="ANIMATEDVIEW";
    private Movie mMovie;
     private long mMoviestart;
    private InputStream is;
    private Context mContext;
public AnimatedView(Context context, AttributeSet attrs) {
    super(context, attrs);
    mContext=context;
    is=context.getResources().openRawResource(R.drawable.ic_action_search);
    mMovie=Movie.decodeStream(is);
    //this.draw(context.getSystemService(Context.))
    this.setWillNotDraw(false);
    Log.v(TAG,"calling constructor of 2 params");
    // TODO Auto-generated constructor stub
}
    public void setImageId(int id){
is=mContext.getResources().openRawResource(id);
mMovie=Movie.decodeStream(is);
this.invalidate();
this.setWillNotDraw(false);
this.setWillNotCacheDrawing(false);
    }
public AnimatedView(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
    is=context.getResources().openRawResource(R.drawable.ic_action_search);
    mMovie=Movie.decodeStream(is);
    Log.v(TAG,"calling constructor of 3 params");
    // TODO Auto-generated constructor stub
}

public AnimatedView(Context context) {
    super(context);
    is=context.getResources().openRawResource(R.drawable.ic_action_search);
    mMovie=Movie.decodeStream(is);
    Log.v(TAG,"calling constructor of 1 params");
    // TODO Auto-generated constructor stub
}

@Override
protected void onDraw(Canvas canvas) {
    // TODO Auto-generated method stub
    canvas.drawColor(Color.TRANSPARENT);
    super.onDraw(canvas);       
    final long now = SystemClock.uptimeMillis();
    if (mMoviestart == 0) {
        mMoviestart = now;
    }
    int startTime = (int) (now - mMoviestart);
    int dur = 1;
    if (mMovie != null)
        dur = mMovie.duration();
    final int relTime = startTime % dur;
    mMovie.setTime(relTime);
    mMovie.draw(canvas, 10, 10);
    this.invalidate();
}
   protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        Log.v(TAG,"On onMeasure==>");
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);

        int parentWidth = MeasureSpec.getSize(widthMeasureSpec);
        int parentHeight = MeasureSpec.getSize(heightMeasureSpec);
        setMeasuredDimension(
                parentWidth * 2, parentHeight);
    }

     } 
```

适配器代码：

```
public class AnimAdapter extends BaseAdapter {
private Context mContext;
private List<Item> piclist;
private int rowResID;

public AnimAdapter(Context mContext, List<Item> piclist, int rowResID) {
super();
this.mContext = mContext;
this.piclist = piclist;
this.rowResID = rowResID;
}

@Override
public int getCount() {
    // TODO Auto-generated method stub
    return piclist.size();
}

@Override
public Object getItem(int pos) {
    // TODO Auto-generated method stub
    return piclist.get(pos);
}

@Override
public long getItemId(int pos) {
    // TODO Auto-generated method stub
    return pos;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    // TODO Auto-generated method stub
     Item imgAnimItm= piclist.get(position);
        LayoutInflater inflate=(LayoutInflater)   mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View v=inflate.inflate(rowResID, parent, false);
        TextView animTxtName= (TextView)v.findViewById( R.id.helloTxt );
        if( animTxtName != null )
            animTxtName.setText( imgAnimItm.getName());
        AnimatedView animView= (AnimatedView)v.findViewById( R.id.anim_view );
        if( animView!= null )
            animView.setImageId(imgAnimItm.getId());
        return v;
}

 } 
```

列出活动代码：

```
public class CustomActivity extends ListActivity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_custom);
    ArrayList<Item> alarmList = new ArrayList<Item>();
    Item a = new Item("Low memory", R.drawable.angel_pray_anim);
    alarmList.add(a);
    a = new Item("Process #345 stopped", R.drawable.anim_angry);
    alarmList.add(a);
    a = new Item("Low memory", R.drawable.engg_anim);
    alarmList.add(a);
    a = new Item("Process #456 stopped", R.drawable.finger_anim);
    alarmList.add(a);
    AnimAdapter AnimAdapter = new AnimAdapter(this, alarmList,
            R.layout.anim_row_layout);
    setListAdapter(AnimAdapter);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_custom, menu);
    return true;
}
} 
```

anim_row.xml 代码

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:fitsSystemWindows="true"
android:orientation="horizontal" >

<TextView
    android:id="@+id/helloTxt"
    android:layout_width="200dp"
    android:layout_height="wrap_content" >
</TextView>

<com.example.customviewdemo.AnimatedView
    android:id="@+id/anim_view"
    android:layout_width="50dip"
    android:layout_height="50dip" >
</com.example.customviewdemo.AnimatedView>

</LinearLayout> 
```

主要活动：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<ListView
    android:id="@+id/android:list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >
</ListView>

<TextView
    android:id="@+id/android:empty"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:text="No items" >
</TextView>

</LinearLayout> 
```

物品类别：

```
public class Item {
private String name;
private int id;

public Item(String name, int id) {
    super();
    this.name = name;
    this.id = id;
}

public String getName() {
    return name;
}

public void setName(String name) {
    this.name = name;
}

public int getId() {
    return id;
}

public void setId(int id) {
    this.id = id;
}

} 
```

这是我尝试使用自定义视图并在列表视图中显示动画 gif 文件的整个代码，但 AnimatedView 的 onDraw() 方法没有被调用，因此它没有显示任何内容。

为什么 onDraw() 没有被调用？

我还尝试直接在适配器的布局中添加 AnimatedView 的实例，但结果相同。

# jquery - 淡化除焦点图像以外的所有图像 - jQuery Slider

> ID：13690093
> 
> 赞同：0
> 
> 时间：2012-12-03T19:16:29.207
> 
> 标签：jquery

我已经设置了一个响应式滑块，并希望除聚焦的图像之外的所有图像都是透明的（不透明度 50%）。聚焦图像将是最左侧的图像。

我为滑块使用了以下插件：

[http://matthewtoledo.com/creations/responsive-carousel/example/example-1.html](http://matthewtoledo.com/creations/responsive-carousel/example/example-1.html)

并在以下位置实施：

[http://www.schafrick.com/portfolio-clients-nike.html](http://www.schafrick.com/portfolio-clients-nike.html)

我的 jQuery 知识很差，我不确定从哪里开始。任何帮助将不胜感激。谢谢

*请记住，当我说“专注”时，我指的不是鼠标通风口，而是指最左边的图像。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:33:54.727

轮播的创建者已经有了一些实现：

[示例 2](http://matthewtoledo.com/creations/responsive-carousel/example/example-2.html)

onShift 方法是一个带有函数的设置参数。请参阅：[Docu](https://github.com/mrbinky3000/responsive_carousel)
我为您改编了它：

```
$('#example').responsiveCarousel({
    // your setup tasks
    onShift: function (i) {
        i = Math.round(i);
        var $current = $('.slider-target li[data-slide=' + i + ']');
        $('.slider-target li[data-slide]').removeClass('current');
        $current.addClass('current');
    }
}); 
```

您可以使用 .current 类设置当前帧的样式。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-03T19:22:06.723

像这样的东西：

CSS

```
.slider-target img    {opacity:0.8;} 
```

查询

```
$('body').on('mouseenter', '.slider-target img', function () {
    $(this).css( "opacity", "1.0" );
}).on('mouseleave', '.slider-target img', function () {
    $(this).css( "opacity", "0.8" );
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-03T19:22:20.450

```
jQuery('.slider-target li').hover(function(e)
{
    $(this).closest('ul').find('li').not(this).fadeTo(200, 0.5);
}, function()
{
    $(this).closest('ul').find('li').not(this).fadeTo(200, 1);
}); 
```

如果您包含 jquery，此代码应该可以工作

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-03T19:25:44.900

像这样的东西应该可以工作xD

```
$(document).ready(){

  $("img#gallery").hover(function(){
    $(this).siblings("img").fadeTo("slow",0.5)
  },
  function(){
    $(this).siblings("img").fadeTo("slow",1)
  })

} 
```

只需根据您的需要调整代码 xD

# android - ADK - 用户提示对话框几乎立即被取消/绕过

> ID：13690096
> 
> 赞同：0
> 
> 时间：2012-12-03T19:16:33.253
> 
> 标签：android, dialog, android-alertdialog, adk

我正在尝试根据先前的输入提示用户输入。

请允许我澄清并添加一些上下文：
此应用程序是一个掷骰子模拟器。主活动显示每个骰子上的骰子数和面数，可通过从菜单中打开子活动来更改。使用 调用此子活动以获取其结果`startActivityForResult()`，并且完全由一个`RadioGroup`和两个按钮组成 - “接受”和“取消” - 并将一个`String`额外的回传给主活动（格式为“XdN” - 例如“1d20”） ，然后主要活动对其进行解析并用于相应地调整骰子数和边数。

该系统对于像“1d6”、“1d10”等类似的例子运行得非常好，而且**不是**问题——*据我所知*。

现在，这是我的问题：
我有一个通过`String`“自定义”（而不是类似“XdN” `String`）的单选按钮。选择后（最后，单击“接受”时），我的意图是打开一个对话框并提示用户输入自定义计数值 - 这有点工作。对话框显示，布局是正确的，看起来应该是正确的，但是**布局会在一瞬间消失，并传递当前的计数值，而不是*用户*输入的值。**这也会向 LogCat（我正在使用 Eclipse 和 ADT）抛出一个错误，上面写着：

```
Application            Tag             Text
org.x3chaos.nicedice   WindowManager   Activity org.x3chaos.nicedice.DiceActivity
                                       has leaked window com.android.internal.pol
                                       icy.impl.PhoneWindow$DecorView@44786f20 th
                                       at was originally added here
org.x3chaos.nicedice   WindowManager   android.view.WindowLeaked: Activity org.x3
                                       chaos.nicedice.DiceActivity has leaked win
                                       dow com.android.internal.policy.impl.Phone
                                       Window$DecorView@44786f20 that was origina
                                       ly added here
org.x3chaos.nicedice   WindowManager   at android.view.ViewRoot.<init>(ViewRoot.j
                                       ava:247)

[more if needed] 
```

--

`Button` *button_accept*的`android:onClick`方法如下：

```
public void accept(View view) {

    RadioGroup group = (RadioGroup) findViewById(R.id.dice_radiogrp);
    RadioButton selected = (RadioButton) findViewById(group
            .getCheckedRadioButtonId());
    String tmpResult = selected.getText().toString();

    if (!tmpResult.matches("[0-9|xX](.*)[Dd][0-9](.*)")) {

        // Show dialog

        LayoutInflater li = LayoutInflater.from(this);
        View dialogView = li.inflate(R.layout.prompt_dice, null);

        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setView(dialogView);
        builder.setTitle("Custom Dice");
        builder.setCancelable(false);

        final EditText editCount = (EditText) findViewById(R.id.edit_promptDiceCount);
        final EditText editSides = (EditText) findViewById(R.id.edit_promptDiceSides);

        builder.setPositiveButton("Accept", new OnClickListener() {

            @Override
            public void onClick(DialogInterface dialog, int which) {

                boolean flag = false;
                String textCount, textSides;
                textCount = editCount.getText().toString();
                if (textCount.equals("")) {
                    textCount = "1";
                    flag = true;
                }
                textSides = editSides.getText().toString();
                if (textSides.equals("")) {
                    textSides = "20";
                    flag = true;
                }

                int count = Integer.parseInt(textCount);
                int sides = Integer.parseInt(textSides);

                if (count > 20)
                    count = 20;
                if (sides > 20)
                    sides = 20;

                String finRes = count + "d" + sides;

                setResultExtra(finRes);

                if (flag) {
                    String msg = "Invalid input: set dice to " + finRes;
                    Toast toast = Toast.makeText(context, msg,
                            Toast.LENGTH_SHORT);
                    toast.show();
                }

            }

        });

        builder.setNegativeButton("Cancel", new OnClickListener() {

            @Override
            public void onClick(DialogInterface dialog, int which) {
                dialog.cancel();
                exitActivity(false);
            }

        });

        AlertDialog dialog = builder.create();
        dialog.show();

    } else {
        result = tmpResult;
    }

    exitActivity(true);

} 
```

所有其他功能都有效，所以我不确定为什么不这样。我确定这是我搞砸的事情 - 因为这是我的第一个应用程序，我正在使用一些我以前从未接触过的对象和方法 - 所以我非常感谢任何帮助。:]

**编辑：**在阅读[了这个问题](https://stackoverflow.com/questions/6336930/android-dialog-disappears-on-its-own)之后，我开始认为这可能`Intent`不是在等待对话完成。但这并不完全有意义，因为调用对话框的活动被调用以获得结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:32:26.723

在 Android 中，对话框是**异步**的。您无法显示它并期望您的代码在此处等待。你所做的就是`dialog.show()`然后立即`exitActivity()`，所以它看起来就像你做的那样。

**编辑**

快速修复您的代码可能是替换这部分：

```
} else {
    result = tmpResult;
}

exitActivity(true); 
```

和

```
} else {
    result = tmpResult;
    exitActivity(true);
} 
```

因为这`exitActivity()`是导致您出现问题的原因。

# sql - 函数从具有特定列的 sql 返回 sys_refcursor 调用

> ID：13690110
> 
> 赞同：5
> 
> 时间：2012-12-03T19:17:47.560
> 
> 标签：sql, function, plsql, oracle10g, sys-refcursor

这可能有点傻，但我想知道这是否可能。

我有一个返回 sys_refcursor 的函数

```
CREATE OR REPLACE FUNCTION get_employee_details(p_emp_no IN EMP.EMPNO%TYPE)
   RETURN SYS_REFCURSOR
AS
   o_cursor   SYS_REFCURSOR;
BEGIN
   OPEN o_cursor FOR
      SELECT EMPNO,
             ENAME,
             JOB,
             MGR,
             HIREDATE,
             SAL,
             COMM,
             DEPTNO
        FROM emp
       WHERE EMPNO = p_emp_no;

   RETURN o_cursor;
 -- exception part
END;
/ 
```

我可以使用

```
select  get_employee_details('7369') from dual; 
```

是否可以通过指定列名从上述函数中获取结果？例如，如果我想获得ename 或salary，如何在不使用plsql 块的情况下在sql 语句中指定？就像是

```
select  get_employee_details('7369') <specific column> from dual; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-09-19T17:04:41.260

为此，您可能需要查看`PIPELINED`函数。不过，您必须在 PL/SQL 级别声明显式类型。该部分将设置输出列名：

```
CREATE OR REPLACE TYPE my_rec AS OBJECT (
  c CHAR,
  n NUMBER(1)
);

CREATE OR REPLACE TYPE my_tbl AS TABLE OF my_rec; 
```

现在，最大的优势是您不仅可以“重命名”列，还可以动态修改光标*中*的记录。例如：

```
CREATE OR REPLACE FUNCTION my_fct
RETURN my_tbl PIPELINED
AS
  -- dummy data - use your own cursor here
  CURSOR data IS
      SELECT 'a' as A, 1 AS B FROM DUAL UNION 
      SELECT 'b', 2 FROM DUAL UNION 
      SELECT 'c', 3 FROM DUAL UNION 
      SELECT 'd', 4 FROM DUAL;
BEGIN
  FOR the_row IN data
  LOOP 
      PIPE ROW(my_rec(the_row.a, the_row.b*2));
      --                                  ^^
      --                            Change data on the fly
  END LOOP;
END 
```

用法：

```
SELECT * FROM TABLE(my_fct())
--            ^^^^^^^^^^^^^^^
--     Use this "virtual" table like any
--     other table. Supporting `WHERE`  clause
--     or any other SELECT clause you want 
```

生产：

```
C   N
a   2
b   4
c   6
d   8 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-03T19:29:06.450

不，根本没有 a `ref cursor`，否则没有创建 SQL 类型以将返回值转换为，例如：[http](http://dbaspot.com/oracle-server/9308-select-ref-cursor.html) ://dbaspot.com/oracle-server/9308-select-ref-cursor.html ：

```
create or replace type myType as object (
a int,
b varchar2(10)
)
/

create or replace type myTable as table of myType;
/

create or replace function f1 return myTable as
l_data myTable := myTable();
begin
for i in 1 .. 5 loop
l_data.extend;
l_data(i) := myType(i, 'Row #'||i );
end loop;
return l_data;
end;
/

select * from TABLE ( cast( f1() as myTable ) );

---------- ----------
1 Row #1
2 Row #2
3 Row #3
4 Row #4
5 Row #5 
```

从该线程的最后一篇文章中：

> 您已经知道的方式是唯一在选择语句中使用 REF CURSOR 的方式。

# java - JSON 转换后抛出的 Android 异常（仅在设备上）

> ID：13690114
> 
> 赞同：1
> 
> 时间：2012-12-03T19:17:56.383
> 
> 标签：java, android, eclipse, json, android-emulator

我编写的 Android 应用程序有问题，但只有在我的实际手机设备上运行它时才明显。它在模拟器中运行没有问题。这是发生问题的类：

```
public class JsonServiceHandler {
    private final static String QUEUE_SERVICE_URI = "http://192.168.1.132/QueueTest/AccessService.svc/JSON";

    public static <T extends QueueAccessObject> List<T> GetServiceResult(String serviceMethod, Class<T> classType, Hashtable parameters){
        try
        {
            String url = QUEUE_SERVICE_URI + "/" + serviceMethod;

            if(parameters != null && parameters.size() > 0)
            {
                url += "?";

                Enumeration e = parameters.keys();

                while(e.hasMoreElements())
                {
                    Object key = e.nextElement();
                    url += key.toString() + "=" + parameters.get(key);
                }
            }

            // Send GET request to <service>/<endpoint>
            HttpGet request = new HttpGet(url);
            request.setHeader("Accept", "application/json");
            request.setHeader("Content-type", "application/json");

            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpResponse response = httpClient.execute(request);

            HttpEntity responseEntity = response.getEntity();

            // Read response data into buffer
            char[] buffer = new char[(int)responseEntity.getContentLength()];
            InputStream stream = responseEntity.getContent();
            InputStreamReader reader = new InputStreamReader(stream);
            reader.read(buffer);
            stream.close();

            JSONObject jsobj = new JSONObject(new String(buffer));
            JSONObject ridesResult = jsobj.getJSONObject(serviceMethod + "Result");

            List<T> array = GetObjectsFromJSONArray(ridesResult.getJSONArray("RootResults"), classType);

            return array;
        }
        catch(Exception e){
            return null;
        }
    }

    private static <T extends QueueAccessObject> List<T> GetObjectsFromJSONArray(JSONArray jArray, Class<T> classType) {
        List<T> list = new ArrayList<T>();

        try
        {
            for(int i = 0; i < jArray.length(); ++i){
                T item = classType.getConstructor(JSONObject.class).newInstance(jArray.getJSONObject(i));
                list.add(item);
            }
        }
        catch(Exception ex){}

        return list;                
    }

} 
```

在我获取 HttpGet 的 JSON 结果并将其复制到强类型对象数组之后，问题就发生了。

抛出异常时，JSON 响应看起来很好，并且强类型对象列表似乎被创建并返回得很好。它只会在调用 GetObjectsFromJSONArray*后*`List<T> array = GetObjectsFromJSONArray(...`对分配造成影响。

当它放下 catch 块（之后的 4 行）时，该异常似乎没有在 Eclipse 中实例化。

正如我所提到的，我在安卓模拟器中没有这个问题，只有在我的手机上测试时。此外，该问题仅在设备本身 4 次中出现约 3 次，因此不会始终如一地发生。

仅供参考，这一切都发生在 AsyncTask 中，因此在 UI 线程上进行 Async 网络调用应该没有问题。

我是 Android 新手，实际上是 Java 和 Eclipse 新手，所以我很容易忽略一些简单的事情。

关于正在发生的事情或为什么我的异常在 catch 块中不可用的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:21:46.760

这里抛出了一个真正的异常，我终于让它显示出来了。导致它保持未实例化的问题似乎是异常本身从未在 Catch 块中使用过（我只返回一个空值）。也许对Android环境有某种类型的编译器优化，如果不使用异常参数就不会创建它？

当我添加实际使用异常本身而不是吞下它的代码时，我收到一个 JSONException 告诉我我的响应在中途被截断了。当然，现在我必须弄清楚为什么会发生这种情况（并且仅在设备上），但是异常实例化的问题与它因缺乏使用而被修剪掉的事实有关。

**编辑：**

有关 JSONException 本身的更多信息：显然，我用来将 HttpResponse 加载到 JSONObject 中的代码是无效的，或者至少是不一致的有效：

```
 // Read response data into buffer
    char[] buffer = new char[(int)responseEntity.getContentLength()];
    InputStream stream = responseEntity.getContent();
    InputStreamReader reader = new InputStreamReader(stream);
    reader.read(buffer);
    stream.close();

    JSONObject jsobj = new JSONObject(new String(buffer)); 
```

[我已删除此代码，而不是在此处](http://senior.ceng.metu.edu.tr/2009/praeda/2009/01/11/a-simple-restful-client-at-android/)找到的 convertStreamToString 方法的内容。这让我滚动。

# jar - JAR 文件版本

> ID：13690117
> 
> 赞同：2
> 
> 时间：2012-12-03T19:18:05.010
> 
> 标签：jar, versioning

我正在使用 Visual Studio 2008 for C# 和 Eclipse 20120216-1857 for Java 1.6.37 来构建 Web 应用程序。我的每个 Java 项目都包含 bin 和 src 目录，以及 .project、*.classpath*和*build.xml*文件。我想用 2.1.1.1 之类的东西对这些 JAR 文件中的每一个进行版本控制，并且能够一目了然地看到这些版本，就像在 assembly.cs 文件中指定版本并且可以在 Windows 资源管理器的文件属性中查看的 C# DLL 一样。

我在这里查看了其他帖子，并尝试了诸如*build.xml*、.project 和单行中`name="version" value="2.1.1.1"`的属性或作为 Eclipse 项目一部分的 manifest.txt 文件中的*属性。*对 Java 非常陌生（再说一遍 - 15 年来没有做过 Java）一切正常，因为当使用 WinZip 打开 JAR 文件时，我在 JAR 文件的属性和作为 JAR 文件一部分的 MANIFEST.MF 文件中都看不到 Version 属性。*`<version>2.1.1.1</version>``key="Version" value="2.1.1.1"``Specification-Version: 2.1.1.1`*

 **构建过程是由 Nant 完成的，我没有使用 Maven 或 Hudson，我今天只能通过搜索我的版本控制问题才知道这两者。所以我在这里不知所措，试图找出可能很容易做到的事情，但我不知道如何找到它。非常感谢任何建议和/或解决方案。**

# csv - 熊猫 read_csv 和 UTF-16

> ID：13690122
> 
> 赞同：13
> 
> 时间：2012-12-03T19:18:44.793
> 
> 标签：csv, python-2.7, pandas, utf-16

我有一个以 UTF-16 编码的 CSV 文本文件（以便在其他人使用 Excel 时保留 Unicode 字符）但是当使用 Pandas 0.9.0 执行 read_csv 时，我得到了这个神秘的错误：

```
df = pd.read_csv('data.txt',encoding='utf-16',sep='\t',header=0)
df.head()

---------------------------------------------------------------------------
Exception                                 Traceback (most recent call last)
<ipython-input-18-85da1383cd9e> in <module>()
----> 1 df = pd.read_csv('candidates-spanish.txt',encoding='utf-16',sep='\t',header=0)
  2 df.head()

/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas/io/parsers.pyc in read_csv(filepath_or_buffer, sep, dialect, header, index_col, names, skiprows, na_values, keep_default_na, thousands, comment, parse_dates, keep_date_col, dayfirst, date_parser, nrows, iterator, chunksize, skip_footer, converters, verbose, delimiter, encoding, squeeze, **kwds)
248         kdict['delimiter'] = sep
249 
--> 250     return _read(TextParser, filepath_or_buffer, kdict)
251 
252 @Appender(_read_table_doc)

/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas/io/parsers.pyc in _read(cls, filepath_or_buffer, kwds)
198         return parser
199 
--> 200     return parser.get_chunk()
201 
202 @Appender(_read_csv_doc)

/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas/io/parsers.pyc in get_chunk(self, rows)
853         elif not self._has_complex_date_col:
854             index = self._get_simple_index(alldata, columns)
--> 855             index = self._agg_index(index)
856 
857         elif self._has_complex_date_col:

/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas/io/parsers.pyc in _agg_index(self, index, try_parse_dates)
980                 arr, _ = _convert_types(arr, col_na_values)
981                 arrays.append(arr)
--> 982             index = MultiIndex.from_arrays(arrays, names=self.index_name)
983         return index
984 

/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas/core/index.pyc in from_arrays(cls, arrays, sortorder, names)
1570 
1571         return MultiIndex(levels=levels, labels=labels,
-> 1572                           sortorder=sortorder, names=names)
1573 
1574     @classmethod

/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas/core/index.pyc in __new__(cls, levels, labels, sortorder, names)
1254         assert(len(levels) == len(labels))
1255         if len(levels) == 0:
-> 1256             raise Exception('Must pass non-zero number of levels/labels')
1257 
1258         if len(levels) == 1:

Exception: Must pass non-zero number of levels/labels 
```

[基于此示例](https://stackoverflow.com/questions/9177820/python-utf-16-csv-reader)使用 csv.reader 逐行读取数据意味着我的数据格式不正确：

```
from io import BytesIO
import csv

with open('data.txt','rb') as f:
    r = f.read().decode('utf-16').encode('utf-8')
    for l in csv.reader(BytesIO(r),delimiter='\t'):
        print l

['Country', 'State/City', 'Title', 'Date', 'Catalogue', 'Wikipedia Election Page', 'Wikipedia Individual Page', 'Electoral Institution in Country', 'Twitter', 'CANDIDATE NAME 1', 'CANDIDATE NAME 2']
['Venezuela', 'N/A', 'President', '10/7/12', 'Hugo Rafael Chavez Frias', 'Hugo Ch\xc3\xa1vez', 'Hugo Ch\xc3\xa1vez', 'Hugo Chavez', 'Hugo Ch\xc3\xa1vez Fr\xc3\xadas', 'Hugo Chavez', 'Hugo Ch\xc3\xa1vez']
['Venezuela', 'N/A', 'President', '10/7/12', 'Henrique Capriles Radonski', 'Henrique Capriles Radonski', 'Henrique Capriles Radonski', 'Henrique Capriles Radonski', 'Henrique Capriles R.', 'Henrique Capriles', ''] 
```

是否有一些预处理，read_csv 中的附加选项，或者在 pandas.read_csv 可以读取 utf-16 文件之前需要完成的其他操作？谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T22:42:58.227

这是一个错误，我认为是因为 csv 阅读器一开始就传回了一个额外的空行。如果我这样做，它在 Python 2.7.3 和 pandas 0.9.1 上对我有用：

```
In [36]: pd.read_csv(BytesIO(fh.read().decode('UTF-16').encode('UTF-8')), sep='\t', header=0)
Out[36]: 
<class 'pandas.core.frame.DataFrame'>
Int64Index: 50 entries, 0 to 49
Data columns:
Country                             43  non-null values
State/City                          43  non-null values
Title                               43  non-null values
Date                                43  non-null values
Catalogue                           43  non-null values
Wikipedia Election Page             43  non-null values
Wikipedia Individual Page           43  non-null values
Electoral Institution in Country    43  non-null values
Twitter                             43  non-null values
CANDIDATE NAME 1                    43  non-null values
CANDIDATE NAME 2                    16  non-null values
dtypes: object(11) 
```

我在这里报告了这个错误：[https](https://github.com/pydata/pandas/issues/2418) ://github.com/pydata/pandas/issues/2418 不幸的是，在 github master 上，它会导致 c-parser 中的段错误。我们会修复它。

现在，有趣的是：[https](https://softwareengineering.stackexchange.com/questions/102205/should-utf-16-be-considered-harmful) ://softwareengineering.stackexchange.com/questions/102205/should-utf-16-be-considered-harmful ;)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-06-26T12:43:49.593

Python3：

```
with open('data.txt',encoding='UTF-16') as f:
    df = pd.read_csv(f) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T19:39:17.397

```
from StringIO import StringIO
import pandas as pd

a = ['Venezuela', 'N/A', 'President', '10/7/12', 'Hugo Rafael Chavez Frias', 'Hugo Ch\xc3\xa1vez', 'Hugo Ch\xc3\xa1vez', 'Hugo Chavez', 'Hugo Ch\xc3\xa1vez Fr\xc3\xadas', 'Hugo Chavez', 'Hugo Ch\xc3\xa1vez']

pd.read_csv(StringIO('\t'.join(a)), delimiter='\t') 
```

在这里工作可以上传你的数据头，所以我可以测试

# c# - 如果单击行的边缘，WPF PreviewMouseDown 事件不会触发 Grid 中的元素

> ID：13690124
> 
> 赞同：1
> 
> 时间：2012-12-03T19:18:53.327
> 
> 标签：c#, wpf, mouseevent

我有一个网格，其中有一行 TextBlocks，每行都分配了一个 PreviewMouseDown 事件处理程序。当我单击 TextBlocks 的文本时，此事件会触发，但如果我单击边缘，即使画布更新，该事件也不会触发。

我尝试为 TextBlock 和 Grid 设置透明背景，但这没有帮助。

有什么建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T15:40:37.690

我通过转到 GridView 并使用 SelectionChanged 处理程序解决了这个问题（如果您没有单击不同的行，但仍然无法捕捉到这种情况，但这似乎就足够了）。

# image - Matlab - 在imagesc中自动设置比例

> ID：13690127
> 
> 赞同：3
> 
> 时间：2012-12-03T19:19:01.550
> 
> 标签：image, matlab

我正在尝试比较我通过 matlab imagesc 创建的图，因此需要颜色限制与更高的颜色限制相同。

我尝试挖掘，但找不到一种简单的方法来做到这一点，或者至少在不打开颜色图编辑器的情况下找出限制。

非常感谢您的帮助！

阿隆。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:43:22.577

您可以使用设置色标的限制`caxis`

```
img1 = randn(100);
img2 = rand(100);

%# find global min/max
clim(1) = min(min(img1(:)),min(img2(:)));
clim(2) = max(max(img1(:)),max(img2(:)));

figure
ah1 = axes;
imagesc(img1)
caxis(ah1,clim)

%# show the other figure set the same limits to colormap
figure
ah2 = axes
imagesc(img2);
caxis(ah2,clim) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:53:49.077

```
imagesc(name_of_your_matrix,[0 255]); 
```

这将显示您的图像并使用 [0 255] 强度标度对其进行缩放。当然，您可以增加它以显示更多颜色的图像。

希望这会有所帮助。

# javascript - 如何在 JavaScript 中使用来自 db/php 的 JSON

> ID：13690131
> 
> 赞同：10
> 
> 时间：2012-12-03T19:19:12.500
> 
> 标签：javascript, jquery

我正在使用地图插件来呈现一些数据。数据来自数据库并进入 json 文件 - 脚本运行良好。我决定直接使用来自 php 输出的数据，而不是制作一个 json 文件。由于某种原因，javaScript 不接受直接的 php 输入。我正在使用 codeigniter MVC

这是当前有效的示例代码：

```
$.getJSON('_data/index/data.json', function(data){ ... 
```

这是我尝试过的：

```
 var dataMap = '<? print $mapData;?>';
        $.getJSON(dataMap, function(data){... 
```

*** 编辑 2 ***

根据答案 - 此选项也不起作用。

```
var dataMap = '<?php echo $mapData;?>';
        $.get(dataMap, function(data){... 
```

这是json数据

```
{"countries":{"AL":"1","GB":"1","RS":"1","BG":"6","CA":"3","AT":"2","CD":"1"}} 
```

***编辑***

$mapData 是

```
FOREACH LOOP
 $retdata['countries'][] = strtoupper($row->code);
 $retdata['num'][] = $row->num;
ENDFOREACH LOOP
 $retdata['countries'] = array_combine($retdat['code'], $retdata['num']);
 $retdata = json_encode($retdata); 
```

然后像往常一样将其打印到文件中。这是模型，然后我将它传递给控制器​​，然后传递给视图。该字符串与`$dataMap`我存档的字符串和发送到视图的字符串相同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:33:17.050

如果您只是要将 JSON 数据直接插入到 javascript 变量中（而不是使用 AJAX），那么您根本不需要`getJSON`调用。直接这样写对象就好了。

```
var js_object = <?php echo $mapData; ?>;
alert(js_object.countries.AL);
alert(js_object.countries.GB); 
```

请注意，PHP 字符串不会回显到括起来的引号中，这意味着您正在直接创建一个 javascript 对象文字，而不是需要通过以下方式将其解析为对象的字符串`JSON.parse()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:39:40.910

从您更新的代码开始，看起来您根本不需要调用`getJSON`，因为您已经拥有 json 数据。

只需`<? echo $mapData;?>`将其分配给您的 javascript 代码中的变量并直接使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T19:41:51.760

只需直接将 dataMap 用作 JSON 即可。

```
alert(dataMap.countries.AL); //output: 1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-19T19:05:49.330

尽管给定的答案*确实*有效，但您可能希望以不同的方式实现它，以便您的代码更易于维护。

您可以有一个控制器来处理您的所有 api 调用，并将所有与地图相关的功能放在那里。

如果您的控制器被调用`maps`并且您创建了一个`countries`从数据库中获取并返回包含国家/地区的 json 的方法，那么在您的 JS 中您可以执行以下操作：

```
$.get('maps/countries', function(data){
  console.log(data.countries);
  //outputs: {"AL":"1","GB":"1","RS":"1","BG":"6","CA":"3","AT":"2","CD":"1"}
}; 
```

更多关于[CI 控制器](https://ellislab.com/codeigniter/user-guide/general/controllers.html)

# php - SQL：我似乎无法弄清楚的左连接问题

> ID：13690134
> 
> 赞同：1
> 
> 时间：2012-12-03T19:19:30.897
> 
> 标签：php, mysql, sql, database

这是声明：

```
SELECT order.order_id, order.member_id, order.date_ordered, coupon.coupon_name, coupon.coupon_type, coupon.coupon_amount
FROM order
LEFT JOIN coupon
ON order.coupon_id = coupon.coupon_id 
```

这是 MySQL 错误：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'order LEFT JOIN coupon ON order.coupon_id = coupon.coupon_id' at line 2 
```

两个表都有一个`coupon_id`. 我只是不明白我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T19:21:12.407

`order`是一个保留字，你应该转义它：

```
SELECT `order`.order_id, `order`.member_id, `order`.date_ordered, 
        coupon.coupon_name, coupon.coupon_type, coupon.coupon_amount
FROM `order`
LEFT JOIN coupon
ON `order`.coupon_id = coupon.coupon_id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T19:21:12.093

order 是保留字。你需要“逃离”它。

对于 MySQL，您可以使用反引号 (`) 来转义列名，尤其是当它恰好与保留字相同时。

```
SELECT * FROM `order` 
```

顺便说一句，SQL Server 使用方括号 [] 来转义列名。

```
SELECT * FROM [order] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T19:21:29.120

订单是一个保留字。

将其放在反引号中或将您的表格命名为其他名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T19:33:55.380

`order`是保留关键字。您需要将其指定为

```
`order` 
```

让您的查询工作

# python - python总是同步调用__del__吗？

> ID：13690135
> 
> 赞同：3
> 
> 时间：2012-12-03T19:19:35.013
> 
> 标签：python

python 文档[`__del__`](http://docs.python.org/2/reference/datamodel.html#object.__del__)解释了当对象的`__del__`引用计数减少到零时可以调用对象的方法。它总是立即调用（即同步）吗？或者该`__del__`方法是否有可能“在未来的某个时候”被调用？

此外，这个问题的答案是否普遍适用于 Python？或者是否授予语言实现一些自由度？（我使用 CPython。）

对于这个问题，假设如下：

*   有问题的对象继承自`object`.
*   有问题的对象具有自定义`__del__`实现。
*   对象的自定义`__del__`实现不会创建对任何对象的新引用。
*   有问题的对象不是引用循环的一部分。
*   解释器未处于关闭过程中。

据我所知，围绕这个话题似乎有很多困惑。为了避免一些不必要的讨论，让我举一些不可接受的答案的例子：

*   “不要用`__del__`！很混乱！”
*   “不要使用`__del__`！它不是'pythonic'。”
*   “不要使用`__del__`，而是使用上下文管理器。”
*   在没有引用可靠来源的情况下断言什么是或不保证的任何答案。（请随意引用其他 SO 答案，但不要依赖它们作为您的唯一来源。在这种情况下，“可信”是指文档中的某些内容，或有信誉的人，甚至可能是 CPython 来源本身。）

用一个例子来解释这个问题，考虑这个代码：

```
class C(object):
    def __init__(self, i):
        self.i = i

    def __del__(self):
        print "C.__del__:", self.i

print "Creating list"
l = [C(0), C(1), C(2)]

print "Popping item 1"
l.pop(1)

print "Clearing list"
l = []

print "Exiting..." 
```

产生以下输出：

```
$ python test_del.py
Creating list
Popping item 1
C.__del__: 1
Clearing list
C.__del__: 2
C.__del__: 0
Exiting... 
```

请注意，在此示例中，`__del__` *是*同步调用的。这种行为是由语言保证的吗？（请记住上面列出的假设。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:30:54.473

来自 Python 语言参考（Python 2.7.3 版），[第 3 章，数据模型](http://docs.python.org/2/reference/datamodel.html)：

> 对象永远不会被显式销毁；但是，当它们变得无法访问时，它们可能会被垃圾收集。允许实现推迟垃圾收集或完全忽略它——只要没有收集仍然可访问的对象，垃圾收集的实现方式就是实现质量的问题。
> 
> > **CPython 实现细节：** CPython 目前使用引用计数方案，对循环链接的垃圾进行（可选）延迟检测，一旦它们变得不可访问，它就会收集大多数对象，但不能保证收集包含循环引用的垃圾。`gc`有关控制循环垃圾收集的信息，请参阅模块的文档。其他实现的行为不同，CPython 可能会改变。当对象变得无法访问时，不要依赖于立即完成对象（例如：始终关闭文件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:31:20.247

语言不保证该行为。例如，请参阅[PyPy 关于其垃圾收集方案的文档，](https://pypy.readthedocs.org/en/latest/cpython_differences.html#differences-related-to-garbage-collection-strategies)其中明确指出`__del__`在 PyPy 中调用的时间与 CPython 不同。

如果您的对象不是引用循环的一部分，那么我知道这种行为在 CPython 中是可靠的，但我不知道有任何明确的保证。

# prolog - 我很好奇逻辑程序是否可以做代数

> ID：13690136
> 
> 赞同：10
> 
> 时间：2012-12-03T19:19:36.307
> 
> 标签：prolog, algebra, declarative, clpfd, clpq

我读了一篇关于 Prolog 和逻辑编程的简短文章。我很好奇逻辑程序是否可以做代数。就像你能问方程 5+X = 7 中 X 的变量是什么并得到 -2 的答案吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-03T20:52:28.060

所有严肃的 Prolog 系统都提供有限域上的约束逻辑编程，简称 CLP(FD)，您可以使用它轻松求解许多此类方程。例如，使用 SICStus Prolog、SWI 和 Yap：

```
?- use_module(library(clpfd)).
true.

?- 5+X #= 7.
X = 2. 
```

显然，答案是 2 而不是 -2。还可以查看其他领域的约束逻辑编程，例如 library(clpq) 的有理数。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-10T00:52:21.830

是的，Prolog 可以做代数。

如果你用谷歌搜索[Prolog](http://en.wikipedia.org/wiki/Prolog)和[CAS](http://en.wikipedia.org/wiki/Computer_algebra_system)（计算机代数系统），你会得到很多结果。

例如[使用 Prolog 作为 CAS](http://rfdz.ph-noe.ac.at/fileadmin/Mathematik_Uploads/ACDCA/VISITME2002/contribs/Stolyarevska/Stolyarevska.pdf)

如果您了解 Prolog =[语法统一](http://en.wikipedia.org/wiki/Unification_%28computer_science%29)+[反向链接](http://en.wikipedia.org/wiki/Backward_chaining)+ [REPL](http://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop)，

然后意识到统一是解决问题/方程式的核心，您可能会遇到用于解决包含等于 (=) 的问题的方程式推理。同样的逻辑也用于[自动定理证明器](http://en.wikipedia.org/wiki/Automated_theorem_proving)和[证明助手](http://en.wikipedia.org/wiki/Proof_assistant)。

如果你看[这里，](http://www.cl.cam.ac.uk/~jrh13/atp/)你会发现[prolog.ml](http://www.cl.cam.ac.uk/~jrh13/atp/OCaml/prolog.ml)，它在这个自动定理证明器中实现了统一和反向链接。

您还应该查看[术语重写](http://www.meta-environment.org/doc/books/extraction-transformation/term-rewriting/term-rewriting.html)并在 Google 上搜索术语重写，以了解有关使用术语求解方程的科学的更多信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-07-31T22:57:14.940

Prolog 中有一些计算机代数系统的实现，包括[方程简化](https://github.com/SJasoria/Reduce-Algebraic-Expressions)器和[PRESS](https://github.com/maths/PRESS)方程求解器。还有一些线性和非线性方程的约束求解器，包括[CLP(R,Q)](http://www.swi-prolog.org/man/clpqr.html)和[CLP (BNR) ，以及使用](https://github.com/ridgeworks/clpBNR_pl)[约束处理规则](https://dtai.cs.kuleuven.be/CHR/examples.shtml)实现的其他几个求解器。

除了在 Prolog 中实现计算机代数系统，还可以在计算机代数系统中实现 Prolog 解释器。例如，有一篇文章描述了[Mathematica 中基于规则的编程系统的](https://www.ricam.oeaw.ac.at/files/reports/04/rep04-03.pdf)实现。Wolfram Library Archive中的 Mathematica中还有一个[逻辑编程系统的实现。](http://library.wolfram.com/infocenter/MathSource/809/)

显然也可以使用 Sympy 的统一算法[在 Sympy 中实现逻辑程序。](http://matthewrocklin.com/blog/work/2012/11/01/Unification)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-03T20:02:26.067

这个怎么样？请注意，这仅适用于`X+Y=Z`.

```
equation(X,Y,Z):- var(X),X is Z-Y.
equation(X,Y,Z):- var(Y),Y is Z-X.
equation(X,Y,Z):- var(Z),Z is X+Y. 
```

你可以问：

```
equation(5,X,7).
X = 2 .
?- equation(2,5,X).
X = 7.
?- equation(X,5,7).
X = 2 
```

# php - 如何在 Codeigniter 中弹出验证表单的消息？

> ID：13690142
> 
> 赞同：-1
> 
> 时间：2012-12-03T19:20:10.403
> 
> 标签：php, jquery, html, codeigniter, css

如果我的表单的某些字段为空，我想显示一条消息（类似 jquery）。弹出窗口什么的。在我的控制器中，我有这段代码：

```
 if($this->form_validation->run() == FALSE) 
    {
        $this->load->view('registry_v');
        //Here I want to show some message, some popup or anything (not echo)
        //Saying that some field is missing or empty.
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:11:27.367

这是一个示例，您应该如何为您的任务执行此操作：

```
<!DOCTYPE html>
<html>
<head>
<script>
function validateForm()
{
var age = document.forms["myForm"]["age"].value;

if (age == null || age == "")
  {
  alert("Enter your age.");
  return false;
  }

}
</script>
</head>

<body>
<form name="myForm" action="age.php" onsubmit="return validateForm()" method="POST">
Age: <input type="text" name="age">
<input type="submit" value="Submit">
</form>
</body>

</html> 
```

此类任务的常用方法是使用 Javascript 检查客户端机器上的输入。但是，客户的输入永远不应该被信任（他可能会犯错误，他可能会故意提供不正确的数据，他可能会尝试执行诸如 SQL 注入之类的攻击），因此您应该始终再次检查他的输入，但在服务器上-那边已经。

基本逻辑：
1）。检查客户端机器上的客户端输入。如果有问题 - 给他一个警报/写一个错误。如果检查完成且没有任何错误 - 接受用户输入并将其发送到服务器。（由 Javascript/JQuery 执行）
2）。在使用此输入执行服务器逻辑之前，在服务器端再次检查用户的输入（防止 SQL 注入和其他潜在危险的客户端操作）。（由后端语言执行，在您的情况下为 PHP）。

至于您的任务，您可以使用警报功能回显脚本部分。但这种方法是完全错误的，因为：

*   它增加了服务器负载，并且您在编程网站时的主要目标是试图将用户对服务器的请求减少到最低限度。为此，您应该尽可能多地进行客户端计算和检查（同时仍然保持您的安全性。不要忘记用户可以检查脚本源以查看他的数据是如何计算的。）
*   它仍然使用 JavaScript，那么为什么不从一开始就在客户端页面上执行呢？
*   它创建的代码更复杂、更难阅读、组织更少

所以你只是在执行不必要的服务器请求，应该避免它。

基本上，在客户端检查客户端的输入，在服务器端执行您的业务逻辑（没有人应该看到）和数据库工作。

另外我建议你阅读一些基本的 PHP/web 开发书籍来学习与用户交互的基本逻辑，它将为你节省大量的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:25:48.303

做这个服务器端会很痛苦。你想为这种事情使用 javascript。但是，javascript 可能在客户端被禁用，因此您希望优雅地降级为某些替代方案，例如字段下方的简单标签或类似的东西。

*虽然*在服务器端可能会从 php 代码中回显一些 javascript，尽管这可能不被认为是好的做法。我个人反对这一点，但由你决定你想怎么做。

# visual-studio - httpwebrequest 异常

> ID：13690146
> 
> 赞同：1
> 
> 时间：2012-12-03T19:20:23.613
> 
> 标签：visual-studio, httpwebrequest

当我使用 VS IDE 在代码下方运行时，它工作正常，但从 IIS 运行时出现异常

```
 Dim strurl As String = "abc"
 Dim myHttpWebRequest As HttpWebRequest = CType(WebRequest.Create("http://www.google.com/search?sourceid=navclient&gfns=1&q=" + strurl), HttpWebRequest) 
```

我得到的例外是

**例外**

```
 System.Net.WebException: Unable to connect to the remote server ---> 
System.Net.Sockets.SocketException: No connection could be made because the target machine actively refused it 173.194.67.147:80 at
 System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress) at System.Net.ServicePoint.ConnectSocketInternal(Boolean connectFailure, Socket s4, Socket s6, Socket& socket, IPAddress& address, ConnectSocketState state, IAsyncResult asyncResult, Int32 timeout, Exception& exception) --- End of inner exception stack trace --- at System.Net.HttpWebRequest.GetResponse() 
```

# coq - 在 Coq 中使用 Omega 证明一个引理

> ID：13690147
> 
> 赞同：3
> 
> 时间：2012-12-03T19:20:29.050
> 
> 标签：coq, proof, induction

我正在尝试使用 Omega 在 Coq 中进行证明。我花了很多时间在这上面，但什么都没有。不得不说我是Coq新手，所以对这种语言不太适应，也没有太多经验。但我正在努力。

这是我必须证明的代码：

```
Require Import Arith Omega.

Fixpoint div2 (n : nat) :=
 match n with
   S (S p) => S (div2 p)
 | _ => 0
 end.

Fixpoint mod2 (n : nat) :=
 match n with
   S (S p) => mod2 p
 | x => x
 end. 
```

为了证明这一点，我认为首先通过归纳证明这个引理会有所帮助：

```
Lemma div2_eq : forall n, 2 * div2 n + mod2 n = n. 
```

然后这个，使用 omega 和 div2_eq ：

```
Lemma div2_le : forall n, div2 n <= n. 
```

但我没能走得更远。

有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T21:38:30.277

您可以轻松地从函数中得出归纳原则，`div2`如下`mod2`所示：

```
Functional Scheme div2_ind := Induction for div2 Sort Prop.
Functional Scheme mod2_ind := Induction for mod2 Sort Prop. 
```

`div2_ind`并`mod2_ind`有或多或少的类型：

```
forall P1,
  P1 0 0 ->
  P1 1 0 ->
  (forall n1, P1 n1 (div2 n1) -> P1 (S (S n1)) (S (div2 n1))) ->
  forall n1, P1 n1 (div2 n1)

forall P1,
  P1 0 0 ->
  P1 1 1 ->
  (forall n1, P1 n1 (mod2 n1) -> P1 (S (S n1)) (mod2 n1)) ->
  forall n1, P1 n1 (mod2 n1) 
```

要应用这些定理，您可以方便地编写`functional induction (div2 n)`或`functional induction (mod2 n)`通常编写的地方`induction n`。

但更强的归纳原理与这些功能相关：

```
Lemma nat_ind_alt : forall P1 : nat -> Prop,
  P1 0 ->
  P1 1 ->
  (forall n1, P1 n1 -> P1 (S (S n1))) ->
  forall n1, P1 n1.
Proof.
intros P1 H1 H2 H3\. induction n1 as [[| [| n1]] H4] using lt_wf_ind.
  info_auto.
  info_auto.
  info_auto.
Qed. 
```

事实上，任何函数的域都是一个有用的归纳原理的线索。例如，与功能域相关的归纳原理`plus : nat -> nat -> nat`就是`mult : nat -> nat -> nat`结构归纳。这让我想知道为什么`Functional Scheme`不只是产生这些更一般的原则。

在任何情况下，您的定理证明将变为：

```
Lemma div2_eq : forall n, 2 * div2 n + mod2 n = n.
Proof.
induction n as [| | n1 H1] using nat_ind_alt.
  simpl in *. omega.
  simpl in *. omega.
  simpl in *. omega.
Qed.

Lemma div2_le : forall n, div2 n <= n.
Proof.
induction n as [| | n1 H1] using nat_ind_alt.
  simpl. omega.
  simpl. omega.
  simpl. omega.
Qed. 
```

您应该熟悉功能归纳，但更重要的是，您应该真正熟悉有根据的归纳。

# eclipse - Eclipse 控制台无输出

> ID：13690149
> 
> 赞同：0
> 
> 时间：2012-12-03T19:20:37.070
> 
> 标签：eclipse, ubuntu, jvm, java

我在 Ubuntu 12.04 下使用 Eclipse Juno。我已经安装了 CDT，并且控制台在那里完美运行。我在从命令行编译一些 java 代码时遇到了一些问题——这与安装了多个 jdk 并且系统使用 1.7 编译并尝试使用 1.6 运行的事实有关——> int 产生了一些错误。在我将 JAVA_HOME 设置为 1.7 和基于此的 java-alternatives 之后：[https](https://askubuntu.com/questions/121654/how-to-set-default-java-version) ://askubuntu.com/questions/121654/how-to-set-default-java-version一切都解决了。直到现在我还没有注意到，这可能会影响 Eclipse，因为当我现在尝试运行一些它没有显示在控制台中的东西时，但是如果我直接从终端运行 bin 目录中的二进制文件，则会显示输出在终端。在 java -version 之后，我得到以下响应：

```
java version "1.7.0_09"
OpenJDK Runtime Environment (IcedTea7 2.3.3) (7u9-2.3.3-0ubuntu1~12.04.1)
OpenJDK 64-Bit Server VM (build 23.2-b09, mixed mode) 
```

如何让 Eclipse 在控制台中显示运行结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:12:50.723

您应该签入项目属性，在构建路径上设置了哪个版本的 Java。右键单击您的项目 -> 属性 -> Java 构建路径 -> 库。

另请查看控制台视图是否处于活动状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T13:35:20.807

我想到了。这是我犯的一个愚蠢的错误......我安装了Aptana3，它改变了eclipse的配色方案，当我试图修复它时，我改变了很多颜色，并且错误地将背景和输出颜色都改为白色，所以实际上输出在那里，只是我看不到它。任何版主都可以删除我的问题，因为我认为这是一个愚蠢的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-07T10:02:54.887

右键单击您的项目。选择“属性”。选择新窗口左侧的“运行/调试设置”属性。

在右侧窗口中，单击您的可执行文件以突出显示（即 - Test.exe），然后单击“编辑”。在“环境”选项卡中，点击“新建”名称：PATH 值：MinGW bin 目录的路径。（对我来说这是：C:\devcore\MinGW\bin）

在所有窗口上单击“确定”以关闭。

再次尝试运行，它应该将输出打印到屏幕上。

# html - iOS Web 应用程序内的 Facebook/Google+/Twitter 共享功能

> ID：13690155
> 
> 赞同：1
> 
> 时间：2012-12-03T19:20:52.630
> 
> 标签：html, ios, iframe, mobile-safari, iphone-web-app

我正在为 iOS 创建一个网络应用程序，用户必须将网站固定到主屏幕才能启动该应用程序。

我的网络应用程序是一个新闻阅读器，我想在我的应用程序中添加文章的社交分享。

在 Web 应用程序中，如果 Web 应用程序尝试打开新选项卡或弹出窗口，Mobile Safari 会启动，并且在关闭移动 Safari 后，用户将返回主屏幕，而**不是我的应用程序。**

所以我不能使用他们的分享按钮，因为他们打开了用于登录和分享的弹出窗口......

此外，它们正在阻止`iframe`标签，因此我无法`iframe`在我的网络应用程序中加载登录和共享页面。

那么，在我的网络应用程序中集成共享可能性（Facebook/Twitter/Google+）的最佳方式是什么？（在我的网络应用程序中共享，或者从移动 Safari 回到我的应用程序，或者......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T11:10:03.397

最后，我找到了解决此问题的方法，**仅适用于 facebook**。*（如果有人知道如何用 Google+ 和 Twitter 解决这个问题，请告诉我。谢谢）*

可以使用[**Facebook Dialogs**](https://developers.facebook.com/docs/reference/dialogs/)。

实现共享的最简单方法是使用[**Feed Dialog**](https://developers.facebook.com/docs/reference/dialogs/feed/)。它显示一个登录页面，然后显示一个共享页面，然后返回到您在查询字符串中指定的 url。但是只有一个问题：用户无法从facebook登录页面返回应用程序（但他可以从共享页面取消共享，页面在登录页面后显示）

另一种更好但更难实现的方法是使用[**Login (OAuth) Dialog**](https://developers.facebook.com/docs/reference/dialogs/oauth/)，然后通过[**like 和/或 send plugin**](https://developers.facebook.com/docs/plugins/)实现共享。您应该首先检查用户是否已使用 facebook javascript SDK 登录（在 facebook 中），然后如果用户已登录，则显示喜欢/发送按钮，如果用户未登录，则重定向到登录对话框进行登录，然后显示喜欢和发送按钮。

第二种方法的优点是，在用户登录 facebook 后，他可以以一种不错的 AJAX 方式分享和喜欢你喜欢的任何内容，而无需任何重定向。我认为它更快，当然也很酷！

# ruby-on-rails - Rails + Postgres fe_sendauth：未提供密码

> ID：13690162
> 
> 赞同：29
> 
> 时间：2012-12-03T19:21:12.000
> 
> 标签：ruby-on-rails, postgresql

嗨，我正在尝试将 postgresql 连接到我的 rails 项目。我正在学习测试，但由于密码不正确的 postgresql 错误，我的测试没有运行：

```
Edmunds-MacBook-Pro:langexchange edmundmai$ rake test:units
rake aborted!
fe_sendauth: no password supplied 
```

我已经阅读过，我的 pg_hba.conf 文件原本是这样的：

```
# TYPE  DATABASE        USER            ADDRESS                 METHOD

# "local" is for Unix domain socket connections only
local   all             all                                     trust
# IPv4 local connections:
host    all             all             127.0.0.1/32            trust
# IPv6 local connections:
host    all             all             ::1/128                 trust
# Allow replication connections from localhost, by a user with the
# replication privilege.
#local   replication     edmundmai 
```

这是我的 rails 项目中的 database.yml 文件

```
default: &default
  adapter: postgresql
  encoding: utf8
  pool: 5
  username: edmundmai
  password: 

development:
  <<: *default
  database: project_development

test:
  <<: *default
  database: project_test

production:
  <<: *default
  database: project_production 
```

有谁知道我该如何解决这个问题？如果方便的话，我们可以聊天。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-05-09T20:38:41.013

确保您已在生产托管服务器上定义了 RAILS_ENV 和 RACK_ENV。我遇到了一个类似的问题，除此之外一切正常`rake`，解决方案是将 RACK_ENV=production 添加到我的环境中。RAILS_ENV 已设置为生产。

`export RACK_ENV=production`

`bundle exec rake db:version`

您应该看到一些输出，例如：

`Current version: 20121126151935`

解决方案：确保您的 Rails 应用程序可以访问 RAILS_ENV 和 RACK_ENV 环境变量。另外，确保它们的值相同。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-03T19:38:00.687

首先你应该改变：

```
local   all             all                                     trust 
```

到：

```
local   all             all                                     md5 
```

然后，您应该在 PostgreSQL 中使用and创建一个**super_user** ，然后将新用户添加到您的文件中。`username``password``username``password``database.yml`

要创建新`super_user`的，打开`Pg Admin III`并右键单击底部`Login Roles`以创建新的超级用户。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-03-28T10:11:05.650

`test`在文件的和`development`部分下的本地计算机上，`database.yml`您应该将 更改`username`为您的登录用户名。rails 生成器使其与您的应用程序名称相同，这将不起作用。该`production`部分将取决于您的生产设置。如果你使用heroku，你不需要在那里改变任何东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-29T23:42:23.957

您只需要使用 pgadmin 在 postgres 中创建用户/密码和模式（db），并将用户/密码放在 database.yml 中。当我尝试在当前的 rails 项目文件夹中使用 rake db:create 创建数据库时，它失败了，并提示我错误无法为 postgreSQL 适配器创建。之后，我使用 pgadmin 创建了 rails 项目的模式，一切都很好，pg_hba.conf 没有任何更改。

# perl - Excel::Writer::XLSX 单元格（带有日期和时间）需要刷新

> ID：13690165
> 
> 赞同：2
> 
> 时间：2012-12-03T19:21:24.037
> 
> 标签：perl, excel

我可以使用 Excel::Writer::XLSX 包从 DBI 查询的结果成功创建 xlsx。

唯一的麻烦是日期和时间单元格，当在 Excel 2010 中打开时，需要刷新，即`F2 <enter>`正确显示。

显示的示例：`2012-12-02 17:48:33.000`打开电子表格时

刷新 `02/12/2012 17:49` 后：所需格式`F2 <enter>`

对于可能导致此问题的任何提示/指导以及是否可以在我的 Perl 脚本中解决此问题，我将不胜感激？

非常感谢...

PS 启用自动计算，Win 7 上的 StrawberryPerl 5.16

**更新：**为了完整起见，并且可能对其他人有帮助：我正在使用以下构造从查询中写入记录，该查询可以是纯字符串或日期时间。

如果一个 muff 是捕获日期的正则表达式，或者将`sprintf`其放入`write_excel_date`方法所需的正确格式字符串中，则会将纯字符串写入单元格。那是我的问题。

```
if ( $item =~ qr[(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})\.000] ) {
    my $date = sprintf "%4d-%02d-%02dT%02d:%02d:%02d", $1, $2, $3, $4, $5, $6;
    $worksheet->write_date_time( $row, $col++, $date, $date_format);
}
else {
    $worksheet->write( $row, $col++, $item );
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T23:58:33.443

如果您使用 Worksheet`write_date_time()`方法编写日期，那么您不必在 Excel 中刷新它们，因为它们只是格式化的数字，不需要重新计算。

但是，如果您将日期写为字符串，那么您需要在 Excel 中执行一些操作以将它们转换为日期。不过，您不需要这样做，因为 Excel::Writer::XLSX 提供了一种专用的写入日期的方法：

```
#!/usr/bin/perl

use strict;
use warnings;
use Excel::Writer::XLSX;

my $workbook    = Excel::Writer::XLSX->new( 'date_example.xlsx' );
my $worksheet   = $workbook->add_worksheet();
my $date_format = $workbook->add_format( num_format => 'dd/mm/yyyy hh:mm' );

# Increase the column width to make the output clearer.
$worksheet->set_column( 'A:A', 20 );

# Write the date.
$worksheet->write_date_time( 'A1', '2012-12-02T17:48:33.000', $date_format );

__END__ 
```

![在此处输入图像描述](../Images/f1dd929b5091fa7cc2171a0a3da4ac9c.png)

有关如何处理日期的详细说明，请参阅 Excel::Writer::XLSX 文档的[日期和时间部分。](http://search.cpan.org/~jmcnamara/Excel-Writer-XLSX/lib/Excel/Writer/XLSX.pm#DATES_AND_TIME_IN_EXCEL)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:27:08.143

在事件中添加一行 VBA 代码`Workbook_Open()`怎么样？

```
Private Sub Workbook_Open()

  Application.Calculate

End Sub 
```

那会满足你的需求吗？

# c# - Jqgrid Grouping - 摘要标题？

> ID：13690169
> 
> 赞同：0
> 
> 时间：2012-12-03T19:21:33.370
> 
> 标签：c#, jquery, asp.net-mvc, jqgrid

是否可以以某种方式显示“单击以展开”行中的每一列进行分组？例如，在[这里](http://www.trirand.com/blog/jqgrid/jqgrid.html)的分组演示中，我希望该行包含每一列的表格单元格，而不是简单地显示展开图标和文本“测试”。

对于我正在做的事情，我希望该行汇总/聚合组中每一行的数据。因此，最初，该行将包含加载网格时的汇总数据，用户可以单击展开以查看详细信息。

所以基本上，我想要一个摘要标题而不是摘要页脚，并且展开图标应该在这个标题行上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T18:54:11.317

没关系，我得到它的工作。我让 JqGrid 完成所有聚合数据的工作，然后，我只需获取页脚行的所有子项（表格单元格）并将它们放在标题行中。

注意：如果您在分组视图中打开了摘要页脚行，则必须确保页脚行存在，即使您没有使用它（即使其中没​​有任何内容）。如果您不这样做，并且您尝试扩展该组，它最终会扩展它下面的每个组。

# php - 带有自签名证书的 POST 请求

> ID：13690173
> 
> 赞同：17
> 
> 时间：2012-12-03T19:21:52.283
> 
> 标签：php, security, post, ssl, ssl-certificate

我将使用 PHP 将一些数据从站点 A 发布到站点 B。站点 A 具有商业 SSL 证书。站点 B 将拥有一个自签名证书。这是可行的吗？如果没有，我可以设置 PHP（或 Apache）中的任何配置选项以绕过限制吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-12-03T19:26:03.300

大概您将在服务器 A 上使用 curl？curl 中有几个选项可以禁用证书验证，这将允许自签名证书通过。该链接仍将被加密，但您将无法相信服务器 B 真的**是**服务器 B：

```
curlopt_ssl_verifypeer  (checking the CA auth chain)
curlopt_ssl_verifyhost  (hostname/certname match checks) 
```

示例 PHP 代码：

```
$ch = curl_init("https://example.com/example/path"); 
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
$response = curl_exec($ch); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-12-20T20:52:53.733

`CURLOPT_SSL_VERIFYPEER`不应接受建议禁用的答案。问题是“为什么它不能与 cURL 一起使用”，并且正确指出它是危险的。禁用证书检查为中间人攻击打开了大门，这接近于仅使用纯文本 http。

该错误可能是由于没有最新的 CA 根证书包引起的。这通常是一个带有一堆加密签名的文本文件，curl 使用它来验证主机的 SSL 证书。

您需要确保您的 PHP 安装具有这些文件之一，并且它是最新的（否则在这里下载一个：http: [//curl.haxx.se/docs/caextract.html](http://curl.haxx.se/docs/caextract.html)）。

然后在php.ini中设置：

```
curl.cainfo = <absolute_path_to> cacert.pem 
```

如果您在运行时设置它，请使用：

```
curl_setopt ($ch, CURLOPT_CAINFO, dirname(__FILE__)."/cacert.pem"); 
```

出于安全原因，从[https://stackoverflow.com/a/23585500/2650835](https://stackoverflow.com/a/23585500/2650835)复制的答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-07-13T03:15:09.823

通过将网站的证书添加到受信任的 CA 列表中，您可以使用自签名证书发布到网站。我已经在 Debian 中对此进行了测试，也许它也适用于 Ubuntu、CentOS 等。

首先获取自签名网站的证书（ssws = 自签名网站）：

```
openssl s_client -connect <ssws-hostname>:<ssws-port> 
```

Ctrl-C 退出 openssl 命令并检查输出。找到在这些标记之间编码的服务器的自签名证书：

```
-----BEGIN CERTIFICATE-----

-----END CERTIFICATE----- 
```

复制证书、标记和所有内容，并将其内容粘贴到一个新文件中，并给文件一个“.crt”扩展名，例如“my-favorite-self-signed-website.crt”。然后...

```
sudo chmod 644 my-favorite-self-signed-website.crt
sudo chown root:root my-favorite-self-signed-website.crt
sudo mv my-favorite-self-signed-website.crt /usr/local/share/ca-certificates/.
sudo /usr/sbin/update-ca-certificates 
```

最后[一个命令](https://manpages.debian.org/buster/ca-certificates/update-ca-certificates.8.en.html)应指示“添加 1”，表明您的自签名网站现在是此计算机的真正可信实体。PHP 会自动从系统中获取它并符合要求。

除非您正在进行一些非常初步的开发/测试/集成，否则您永远不应该在 SSL/TLS 中禁用对等验证，正如其他答案中所提供的那样。如果没有对等验证，你还不如只做普通的 HTTP。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T19:25:53.567

这是可行的。在 PHP 中，如果您使用 cURL 执行 POST，您只需将选项设置为 false `CURLOPT_SSL_VERIFYPEER`，`CURLOPT_SSL_VERIFYHOST`这样它就不会因为证书是自签名的而失败。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-03T19:27:09.803

如果您要求浏览器发布数据，那么用户将收到有关证书不受信任的正常警告。

如果您使用 cURL 从 PHP 代码中执行 POST，则需要禁用 cURL 的 SSL 检查。根据一个[相关问题](https://stackoverflow.com/questions/521418/reading-ssl-page-with-curl-php#521460)，

> 您需要设置`CURLOPT_SSL_VERIFYPEER`和`CURLOPT_SSL_VERIFYHOST`to `FALSE`。这应该禁用两个主要检查。它们可能都不是必需的，但这至少应该让你继续前进。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-20T11:14:29.223

就我而言，只有我的开发服务器是自签名的，所以我将 verifypeer 选项设置为 false 并且它可以工作。但是我的生产服务器是完全签名的，所以我没有设置 verifypeer 选项。无论哪种情况，都不需要 verifyhost 选项。

# html - 如何在 svg 中引用 jpg？

> ID：13690177
> 
> 赞同：4
> 
> 时间：2012-12-03T19:22:14.770
> 
> 标签：html, svg

我有一个简单的 svg 示例，它只包装了一个 jpg。这是HTML：

```
<html>
<head>
</head>
<body>
    <div id="theimageholder">
        <img id="theimage" src="Images/simplepng.svg"></img>
    </div>
</body>
</html> 
```

这是 simplepng.svg 的 SVG：

```
<?xml version="1.0"?>
<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve"
         width="410" height="340"
         viewBox="0 0 200 200"
         zoomAndPan="enable"
         preserveAspectRatio="xMidYMin meet" >
<image x="0" y="0" width="200px" height="200px" xlink:href="earth.jpg"/>
</svg> 
```

这适用于 IE9，但不适用于 Chrome 或 Firefox。他们都没有显示任何内容。xlink:href 在那些浏览器中工作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T22:13:15.277

SVG 文件看起来 100% 正确： [http ://apike.ca/prog_svg_images.html](http://apike.ca/prog_svg_images.html)

如果将图像标签切换为嵌入或对象标签，它将起作用：

```
<embed src="Images/test.svg" type="image/svg+xml" width="410" height="340" />
<object data="Images/test.svg" type="image/svg+xml" width="410" height="340" /> 
```

这可能只是这些浏览器的限制。我确认这也是 Safari 中的一个问题。我找不到这方面的参考资料或错误编号。

# c - 如何使用 FILE *fp 和 fopen 读取文件？

> ID：13690182
> 
> 赞同：0
> 
> 时间：2012-12-03T19:22:26.573
> 
> 标签：c

所以对于这个任务，我应该阅读一个文件，并处理内容。现在我只想能够打开文件，阅读它并打印出它有多少行。我相信我有正确的代码来执行此操作，但我不知道如何“读取”或连接到我的程序之外的文件！我正在使用

```
FILE *fp = NULL; 
fp = fopen (); 
```

部分对吗？那就是如何打开/连接到文件？但不确定这是做什么的，以及它如何连接到程序外部的文件。要阅读文件，我让用户输入他们的文本文件，例如

```
printf ("Enter the name of the data file: ");
scanf ("%[^\n]", &filename); 
```

然后阅读我放的

```
fp = fopen("&filename", "r"); 
```

但这似乎不对，而且不起作用。谁能解释我做错了什么，以及如何读取用户输入的文件？如果有意义的话，我在一个 SSH 矩阵组中，就像我使用 ssh 终端登录腻子一样？不知道如何解释，但这是我学校在线 SSH 的事情......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:24:05.063

```
fp = fopen("&filename", "r"); 
```

`filename`是变量，你为什么要用`""`双引号传递它。

试试下面这样的事情：

```
char filename[50]; // need a character array or buffer to hold the filename

printf ("Enter the name of the data file: ");
scanf ("%[^\n]", filename);   // no & operator 
```

现在使用

```
fp = fopen(filename, "r");   // filename variable should contain complete path 

                              //with the actual file name 
```

我认为这应该有效。

您还需要检查`fp`as

```
if(fp == NULL)   // It's always a safe way to proceed
   printf("Error in file opening\n"); 
```

# r - 函数内的 update() 只搜索全局环境？

> ID：13690184
> 
> 赞同：9
> 
> 时间：2012-12-03T19:22:37.537
> 
> 标签：r, function, environment

我尝试编写一个包装函数来批量进行似然比测试。我试图包含 update() 来更新初始模型。但是，似乎不是在函数内部查找对象，而是在全局环境中查找对象。

```
fake <- data.frame(subj= rep(1:5, 4), 
                   factor1 = rep(LETTERS[c(1,2,1,2)], each=5), 
                   factor2 = rep(letters[1:2], each=10), 
                   data=sort(rlnorm(20)))

foo <- function(){
                  temp <- fake
                  model1 <- lmer(data~factor1*factor2 + (1 |subj), temp)
                  model1a <- update(model1, ~.-factor1:factor2)
                  model1a} 
```

它在下面给出了一条错误消息：

```
Error in eval(expr, envir, enclos) : object 'factor1' not found 
```

无论如何要在函数中进行 update() 搜索？谢谢！

编辑：

我犯了一个错误。我想将“temp”传递给 lmer，而不是“fake”。

EDIT2：建议的一种方便的解决方案是简单地指定数据对象。虽然 update() 现在对此没有任何问题，但 anova() 似乎认为我试图比较的模型是基于不同的数据对象

```
 foo <- function(){
                  temp <- fake
                  model1 <- lmer(data~factor1*factor2 + (1 |subj), data=temp)
                  model1a <- update(model1, ~.-factor1:factor2, data=temp)
                  anova(model1, model1a)
            }
 foo() 
```

我收到一条错误消息：

```
 Error in anova(model1, model1b) : 
   all models must be fit to the same data object 
```

我想这个错误超出了更新（）。但我想知道是否有人知道如何解决这个问题。请注意，如果我在不使用 update() 的情况下编写函数，而是拼出模型（见下文），上面的错误就会消失：

```
 foo <- function(){
                  temp <- fake
                  model1 <- lmer(data~factor1*factor2 + (1 |subj), data=temp)
                  model1a <- lmer(data~factor1 + factor2 + (1 |subj), data=temp)
                  anova(model1, model1a)
            }
 foo()

 Data: temp
 Models:
 model1a: data ~ factor1 + factor2 + (1 | subj)
 model1: data ~ factor1 * factor2 + (1 | subj)
         Df     AIC    BIC  logLik  Chisq Chi Df Pr(>Chisq)  
 model1a  5 -4.6909 3.7535  7.3454                           
 model1   6 -8.8005 1.3327 10.4003 6.1097      1    0.01344 *
 ---
 Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 
```

编辑 3：似乎问题出在 anova() 上。我也尝试了@hadley 的建议

```
foo2 <- function(){
  my_update <- function(mod, formula = NULL, data = NULL) {
  call <- getCall(mod)
  if (is.null(call)) {
    stop("Model object does not support updating (no call)", call. = FALSE)
  }
  term <- terms(mod)
  if (is.null(term)) {
    stop("Model object does not support updating (no terms)", call. = FALSE)
  }
  if (!is.null(data)) call$data <- data
  if (!is.null(formula)) call$formula <- update.formula(call$formula, formula)
  env <- attr(term, ".Environment")
  eval(call, env, parent.frame())}

      model1 <- lmer(data~factor1*factor2 + (1 |subj), temp)
      model1a <- my_update(model1, ~.-factor1:factor2)
      anova(model1, model1a)
 }
 foo2() 
```

我收到一条错误消息，如下所示：

```
 Error in as.data.frame.default(data) : 
   cannot coerce class 'structure("mer", package = "lme4")' into a data.frame 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-03T20:14:33.550

我以前也被这种行为所困扰，所以我编写了自己的`update`. 它评估公式环境中的所有内容，因此它应该相当健壮。

```
my_update <- function(mod, formula = NULL, data = NULL) {
  call <- getCall(mod)
  if (is.null(call)) {
    stop("Model object does not support updating (no call)", call. = FALSE)
  }
  term <- terms(mod)
  if (is.null(term)) {
    stop("Model object does not support updating (no terms)", call. = FALSE)
  }

  if (!is.null(data)) call$data <- data
  if (!is.null(formula)) call$formula <- update.formula(call$formula, formula)
  env <- attr(term, ".Environment")

  eval(call, env, parent.frame())
}

library(nlme4)

fake <- data.frame(
  subj = rep(1:5, 4), 
  factor1 = rep(LETTERS[c(1,2,1,2)], each = 5), 
  factor2 = rep(letters[1:2], each = 10), 
  data = sort(rlnorm(20)))

foo <- function() {
  temp <- fake
  model1 <- lmer(data ~ factor1 * factor2 + (1 | subj), fake)
  model1a <- my_update(model1, ~ . - factor1:factor2)
  model1a
}
foo() 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-03T20:31:54.947

尽管我真的很喜欢@Hadley 的回答（并且我自己可能会使用该函数），但您也可以`data`在函数中指定一个参数`update`。（在这里，我假设你想传递`temp`给你的模型。）

```
model1a <- update(model1, ~.-factor1:factor2, data = temp) 
```

* * *

**编辑**

如果您希望将模型与 进行比较`anova`，`update`将修改`data`参数的名称并“欺骗”`anova`以相信这两个模型使用两个不同的数据集进行拟合。仅更新公式并创建新模型将避免这种情况：

```
foo <- function(){
                  temp <- fake
                  model1 <- lmer(data~factor1*factor2 + (1 |subj), data=temp)
                  newForm <- update.formula(formula(model1), ~.-factor1:factor2)
                  model1a <- lmer(newForm, data=temp)
                  anova(model1, model1a)
            } 
```

# django - Django admin 可排序更改列表（grappelli）标题位移

> ID：13690185
> 
> 赞同：1
> 
> 时间：2012-12-03T19:22:40.657
> 
> 标签：django, jquery-ui-sortable, django-grappelli

我在 github 上安装了 grappelli 和 ff0000-django-sortable 的可排序应用程序，一切正常，但您可以在此[链接的图片中看到一个细节](http://xleon.net/static/dev/files/sortable-problem.jpg)

表头向右移动。这仅在启用排序时发生。如果我对任何其他字段进行排序（单击其他列标题），标题看起来没问题。我也意识到问题出在[“django-admin-sortable.js”中的javascript函数“$(table).find('tbody').sortable()”上](https://github.com/ff0000/django-sortable/blob/master/sortable/static/js/django-admin-sortable.js)

我想这很容易解决，但我找不到在哪里或如何解决。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-23T12:13:18.890

这个问题是由 JQuery UI 的 ui-sortable 类上的“浮动”引起的，这会导致所有单元格向左浮动。这可以很容易地通过将 css 文件添加到您的管理类来解决。

```
class SortableAdminMixin(object):

    # Make instances reorderable
    list_editable = ('position',)
    list_display = ('position', )

    class Media:
        js = (
            'admin/js/django-admin-sortable.js',
        )

        css = {
            'all': ('admin/css/admin-sortable-fix.css',)
        } 
```

'admin-sortable-fix.css' 文件应包含以下行：

```
tbody.ui-sortable {float:none;} 
```

# asp.net - 如何从后面的代码更改 GridView 字段的格式？

> ID：13690189
> 
> 赞同：0
> 
> 时间：2012-12-03T19:22:46.303
> 
> 标签：asp.net, vb.net, oracle

我可以从后面的代码中显示包含所需数据的 GridView，如下所示：

```
SqlDataSource3.SelectCommand = "select * from table" 
```

但是，我有一个日期字段，例如，这样做会显示为 12/03/2012 12:00:00 am。在 ASP 上完成后，可以这样修复：

```
<asp:BoundField DataField="DATE" DataFormatString="{0:dd/MM/yy}" HeaderText="DATE" ReadOnly="True" SortExpression="DATE" /> 
```

但是我只使用后面的代码。如果我尝试使用 BoundField 作为日期，我会得到 2 个日期列，如果我不将日期字段添加到 select 语句中，那么我根本就没有日期。

所以无论如何我可以从后面的代码中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:56:00.313

我对 asp.net 不熟悉，但您可以随时更改 sql 查询中的格式：

```
select to_char(<your_date_column>, 'dd/mm/yy') "DATE" from table 
```

但是您不应该在 IIS 中执行此操作`Globalization - colture`吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:32:19.207

基于[此链接](https://stackoverflow.com/questions/1140245/changing-gridview-column-properties-from-code-behind)，您可以使用以下代码：

```
BoundField dateField = new BoundField();
dateField.HeaderText = "Date";
dateField.DataField = "date";
dateField.DataFormatString = "{0:dd/MM/yy}";
gridView.Columns.Add(dateField); 
```

# python - 人名拼写更正（Python）

> ID：13690194
> 
> 赞同：12
> 
> 时间：2012-12-03T19:23:07.117
> 
> 标签：python, nlp, spell-checking, nltk, whoosh

我有大量的人名（例如“john smith”）。我想按名字查找其中的人。但是，某些查询会拼写错误（例如“jon smth”、“johnsm ith”）。是否有任何带有 Python 绑定的拼写更正库可以为我找到拼写更正的匹配项？

我知道 Whoosh 和 Python-aspell。Whoosh 的拼写更正对我来说不太有效，因为它将正确拼写的集合写入磁盘而不是将其存储在内存中。这使得查找对我的应用程序来说太慢了。由于代码的结构方式，更改此行为似乎并非易事。同样，Whoosh 不会对不同的字符编辑进行不同的加权，即使“y”更容易与“i”（“jim kazinsky”->“jim kazinski”）混淆，而不是“z” .

Aspell 不能很好地处理人名，因为名称通常包含空格——Aspell 认为单词是更正的基本单位。另外，据我了解，Aspell 使用 n-gram 拼写校正模型，而不是字符编辑距离模型。虽然 n-gram 模型对字典单词有意义，但它不适用于名称：人们“bob ruzatoxg”和“joe ruzatoxg”有很多稀有的三元组，因为他们有相同的稀有姓氏. 但他们显然是不同的人。

我还应该提到，我不能只将每个查询与集合中的所有条目进行比较——这太慢了。一些索引需要预先建立。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T19:54:27.427

听起来（这里没有双关语）你需要某种形式的[Metaphone 算法](http://en.wikipedia.org/wiki/Metaphone)，它已经在 Python 中实现并且在 Pypi 上可用：http: [//pypi.python.org/pypi/Metaphone/0.4](http://pypi.python.org/pypi/Metaphone/0.4)。

还有其他算法，例如[Levenshtein](http://pypi.python.org/pypi/python-Levenshtein/)和[Soundex](http://en.wikipedia.org/wiki/Soundex)（尚未找到可靠的 Python 实现） - 您可能希望使用其中多个算法计算某种形式的度量（甚至可能对每个结果赋予不同的权重）提出可能更正的结果列表。

# php - php mysqli 检查 mysqli 查询是否返回 false

> ID：13690195
> 
> 赞同：1
> 
> 时间：2012-12-03T19:23:09.657
> 
> 标签：php, mysql, mysqli

如果返回 boolean(false) 或结果，我如何检查 mysqli 查询？如果我尝试获取 num_rows 我会收到 php 错误，因为我试图将非对象作为对象访问。但我需要检查这一点，因为如果它是假的，我必须设置一个变量，如果它不是得到查询的结果。

我的查询如下所示：

```
<?php
$q = "SELECT `id` FROM `table` ORDER BY `id` DESC LIMIT 0, 1";
$res = mysqli->query($q);
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:24:57.717

您需要使用`===`还检查参数类型的运算符：

```
$q = "select ,....";
$res = mysqli->query( $q );

if( $res !== false ) { 
   // query ok
} else {
   // query failed
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:26:59.213

要知道变量是否设置为 false，您可以使用

```
if($res === false){//strictly false, no 0 or ''
   //do something
} 
```

在这种情况下，您可以只说要显示错误以更正它：

```
$res = mysqli->query($q) or exit mysqli_error(); 
```

# mysql-connector - MySQL 连接器/C++ 宽字符编码

> ID：13690198
> 
> 赞同：0
> 
> 时间：2012-12-03T19:23:14.397
> 
> 标签：mysql-connector

在 MySQL Connector/C++ 中，setString() 和 execute() 函数都将 sql::SQLString 字符串作为输入。

类 sql::SQLString 似乎与宽字符不兼容。

那么如何将宽字符字符串传递给这些函数呢？我应该将它们转换为 UTF8 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:36:43.787

是的，传递 UTF8 版本的字符串有效。

# r - 如何计算落在树的每个节点中的观察值

> ID：13690201
> 
> 赞同：2
> 
> 时间：2012-12-03T19:23:18.080
> 
> 标签：r, tree, classification, decision-tree

我目前正在处理 MMST 包中的葡萄酒数据。我已将整个数据集拆分为训练和测试，并构建了一个类似于以下代码的树：

```
library("rpart")
library("gbm")
library("randomForest")
library("MMST")

data(wine)
aux <- c(1:178)
train_indis <- sample(aux, 142, replace = FALSE)
test_indis <- setdiff(aux, train_indis)

train <- wine[train_indis,]
test <- wine[test_indis,]    #### divide the dataset into trainning and testing

model.control <- rpart.control(minsplit = 5, xval = 10, cp = 0)
fit_wine <- rpart(class ~ MalicAcid + Ash + AlcAsh + Mg + Phenols + Proa + Color + Hue + OD + Proline, data = train, method = "class", control = model.control)

windows()
plot(fit_wine,branch = 0.5, uniform = T, compress = T,  main = "Full Tree: without pruning")
text(fit_wine, use.n = T, all = T, cex = .6) 
```

我可以得到这样的图像： ![不修剪的树](../Images/3ddd95f310cbff3cd0c285326bb51118.png)

每个节点下的数字（例如 Grigolino 下的 0/1/48）是什么意思？如果我想知道每个节点有多少训练和测试样本，我应该在代码中写什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-03T21:35:21.060

数字表示该节点中每个类的成员数。因此，标签“0 / 1 / 48”告诉我们，类别 1（Barabera，我推断）有 0 个案例，类别 2（Barolo）只有一个示例，类别 3（Grignolino）有 48 个示例。

您可以使用 获取有关树和每个节点的详细信息`summary(fit_wine)`。
有关`?summary.rpart`更多详细信息，请参阅。

您还可以使用`predict()`（将调用`predict.rpart()`）来查看树如何对数据集进行分类。例如，`predict(fit_wine, train, type="class")`。或将其包裹在桌子上以便于查看`table(predict(fit_wine, train, type = "class"),train[,"class"])`

如果您特别想知道观察结果落在哪个叶节点上，则此信息存储在`fit_wine$where`. 对于数据集中的每个案例，包含代表案例所在叶节点`fit_wine$where`的行号。`fit_wine$frame`因此，我们可以通过以下方式获取每个案例的叶子信息：

```
trainingnodes <- rownames(fit_wine$frame)[fit_wine$where] 
```

为了获取测试数据的叶子信息，我曾经运行`predict()`并`type="matrix"`推断它。令人困惑的是，这会返回一个矩阵，该矩阵是通过连接预测的类、拟合树中该节点处的类计数以及类概率而产生的。所以对于这个例子：

```
testresults <- predict(fit_wine, test, type = "matrix")
testresults <- data.frame(testresults)
names(testresults) <- c("ClassGuess","NofClass1onNode", "NofClass2onNode",
     "NofClass3onNode", "PClass1", "PClass2", "PClass2") 
```

由此，我们可以推断出不同的节点，例如，从`unique(testresults[,2:4]`) 但它是不优雅的。

但是，[Yuji 在之前的问题中有一个聪明的技巧](https://stackoverflow.com/a/6430747/1700987)。他复制 rpart 对象并用节点替换类，因此运行 predict 返回节点而不是类：

```
nodes_wine <- fit_wine
nodes_wine$frame$yval = as.numeric(rownames(nodes_wine$frame))
testnodes <- predict(nodes_wine, test, type="vector") 
```

我在这里包含了解决方案，但人们[应该支持他](https://stackoverflow.com/a/6430747/1700987)。

# php - 如何允许用户编辑包含 html 标签的输入字段

> ID：13690202
> 
> 赞同：1
> 
> 时间：2012-12-03T19:23:18.493
> 
> 标签：php, htmlspecialchars

我正在使用 PHP5，并且数据库中的某些字段包含 HTML 标记。用户应该能够编辑这些并将它们保存为表单的一部分。让我们举一个简单的例子。

我有一个`link`来自数据库的字段，它包含一个 HTML 链接标签，例如：

```
$link = "<a href=\"http://www.google.com\">go to google</a>"; 
```

在我的 html 表单中，我有一个输入字段，允许用户编辑 $link 内容（包括标签） - 我使用 Smarty 模板引擎，因此`{$link}`符号

```
<input name="link" id="link" value="{$link}" /> 
```

我现在遇到的问题是链接字段第一次按原样显示，所以带有标签和所有标签，但是当用户保存到数据库并刷新页面时，我看到“去谷歌”字样，所以标签被剥离出去。经过仔细检查，这也是保存在数据库中的内容。

鉴于上面的简单示例，我该如何处理这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:36:03.610

使用 PHP 函数`htmlentities($link)`来转义这些标签。

这是[手册](http://php.net/manual/pt_BR/function.htmlentities.php)。

# user-interface - Tibco RV 消息的简单 GUI？

> ID：13690203
> 
> 赞同：0
> 
> 时间：2012-12-03T19:23:20.000
> 
> 标签：user-interface, tibco

我想要一个可以编辑、发送和接收 Tibco RV 消息的简单 GUI，用于测试/开发目的。有没有人见过或听说过这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T13:44:46.157

听说过一些可以做到这些（以及更多）的专有产品。寻找开放的替代品，这就是我得到的。

TIBCOmmunity 提供了名为[Anderstool的](http://java.net/projects/anderstool)[消息监视器](https://www.tibcommunity.com/docs/DOC-2676)的链接。这是一个 java.net 项目，源代码也是如此。

此外，TIBCOMmunity 中还有[TIB RV Test 2.1](https://www.tibcommunity.com/docs/DOC-1149)。这也包含在其中的来源。

# python - 怎么知道reactor所有的流程都完成了

> ID：13690204
> 
> 赞同：1
> 
> 时间：2012-12-03T19:23:23.437
> 
> 标签：python, twisted

我是twisted 和python 的新手，我正在阅读twisted python。

挂号电话

```
reactor.callLater(_interval, self.count, *args) 
```

我创建了 Countdown 类，它包含计数函数，我调用了它三次

```
reactor.callWhenRunning(Countdown().count, 1)
reactor.callWhenRunning(Countdown().count, 2)
reactor.callWhenRunning(Countdown().count, 3) 
```

具有不同的时间间隔，我需要在所有呼叫完成后停止反应器。因此，在扭曲的 API 中有一些方法可以知道所有调用已完成。

我的代码是

```
class Countdown(object):

    counter = 5

    def count(self, *args):
    _interval = args[0]
        name = args[1]
        if self.counter == 0 and name == "Third Call":
            reactor.stop()
        elif self.counter == 0:
        print name, " Finished..!"
        else:
            print self.counter, '...'
            self.counter -= 1
            reactor.callLater(_interval, self.count, *args)

from twisted.internet import reactor

reactor.callWhenRunning(Countdown().count, 1, "First Call")
reactor.callWhenRunning(Countdown().count, 2, "Second Call")
reactor.callWhenRunning(Countdown().count, 3, "Third Call")

print 'Start!'
reactor.run()
print 'Stop!' 
```

现在我使用 if self.counter == 0 和 name == "Third Call": 来防止我的所有计数器进程完成。所以现在我需要知道，twisted 中是否有任何内置方法可以知道所有呼叫已完成或我的所有计数器呼叫已完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T14:36:31.253

Twisted 有一个用于处理事件列表的 API： DeferredList [http://twistedmatrix.com/documents/current/core/howto/defer.html#auto8](http://twistedmatrix.com/documents/current/core/howto/defer.html#auto8)

这是一个如何工作的小例子：

```
from twisted.internet import defer 
from twisted.internet import reactor

def delayedFunction(dF):
    print('I was called')
    dF.success(True)

class Counter(object):
    def timeOffsetExecute(self,delay):
        dF = defer.Deferred()
        reactor.callLater(delay,delayedFunction,dF)
        return dF

def onAllResult(val):
    print 'All delayed functions called'
    reactor.stop()

cp = Counter()

dl = defer.DeferredList([cp.timeOffsetExecute(1), cp.timeOffsetExecute(3), cp.timeOffsetExecute(9)], consumeErrors=True)
dl.addCallback(onAllResult)

reactor.run() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-17T07:47:55.647

我在[Twisted Introduction](http://krondo.com/?p=1333)中进行相同的练习，发现解决方案非常简单（假设它应该在不使用延迟的情况下解决）使用共享静态变量来计算正在运行的实例：

```
from twisted.internet import reactor

class Countdown(object):

    running = 0

    def __init__(self, value, delay=1):
        self.delay = delay
        self.counter = value
        Countdown.running += 1

    def __call__(self):
        if self.counter == 0:
            Countdown.running -= 1
            if Countdown.running == 0:
                reactor.stop()
        else:
            print self.counter, '...'
            self.counter -= 1
            reactor.callLater(self.delay, self)

reactor.callWhenRunning(Countdown(10, 0.5))
reactor.callWhenRunning(Countdown(5, 2))
reactor.callWhenRunning(Countdown(7, 1.5))

print 'Start!'
reactor.run()
print 'Stop!' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-28T17:23:35.003

我的看法：

```
class Countdown(object):

counter1 = 5
counter2 = 20
counter3 = 50

def count1(self):
    if self.counter1 == 0 and self.counter2 == 0 and self.counter3 == 0:
        reactor.stop()
    elif self.counter1 > 0:
        print self.counter1, '... process',1
        self.counter1 -= 1
        reactor.callLater(0.1, self.count1)

def count2(self):
    if self.counter1 == 0 and self.counter2 == 0 and self.counter3 == 0:
        reactor.stop()
    elif self.counter2 > 0:
        print self.counter2, '... process',2
        self.counter2 -= 1.25
        reactor.callLater(0.12, self.count2)

def count3(self):
    if self.counter1 == 0 and self.counter2 == 0 and self.counter3 == 0:
        reactor.stop()
    elif self.counter3 > 0:
        print self.counter3, '... process',3
        self.counter3 -= 12.5
        reactor.callLater(0.2345, self.count3)

from twisted.internet import reactor

obj = Countdown()
reactor.callWhenRunning(obj.count1)
reactor.callWhenRunning(obj.count2)
reactor.callWhenRunning(obj.count3)

print 'Start!'
reactor.run()
print 'Stop!' 
```

在这里，我没有使用任何延迟方法解决方案。

# java - createNewFile() 之后的 myfile 在哪里

> ID：13690205
> 
> 赞同：2
> 
> 时间：2012-12-03T19:23:29.187
> 
> 标签：java, createfile

> **可能重复：**
> [当没有给出路径时，将在哪里创建一个新文件？](https://stackoverflow.com/questions/2333046/where-will-be-create-a-new-file-in-java-when-path-is-not-given)

我正在尝试在当前目录中创建一个 txt 文件。我运行了下面的代码，没有错误。但是我在任何地方都找不到 myfile.txt 。我想在当前目录中创建 myfile.txt。我怎样才能做到这一点？

我使用的代码：

```
public void createFile(){
        try{
            File f = new File("myfile.txt");
            if (!f.exists()){
                f.createNewFile();
                System.out.println("New file \"myfile.txt\" has been created");
            }
        }catch(Exception e){
            System.out.println("Error while creating file " + e);
        }   
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T19:26:12.033

它在用户目录中，可以通过以下方式检索：

```
 System.getProperty("user.dir"); 
```

有关详细信息，请参见此处：

[在 Java 中，新建文件的默认位置是什么？](https://stackoverflow.com/questions/5154529/in-java-what-is-the-default-location-for-newly-created-files)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T19:26:45.400

尝试在控制台上打印：

```
System.out.println(f.getAbsolutePath()); 
```

那肯定会告诉你。

# android - 如何使用 LibGDx 制作 Android 动态壁纸？

> ID：13690207
> 
> 赞同：4
> 
> 时间：2012-12-03T19:23:38.017
> 
> 标签：android, live, wallpaper

我想做安卓动态壁纸。我想使用 LibGDx。我找到了这些信息： [http ://www.badlogicgames.com/wordpress/?p=2652](http://www.badlogicgames.com/wordpress/?p=2652)

不幸的是，将代码复制到我的壁纸，eclipse 显示错误。

有谁知道如何使用 LibGDx 制作壁纸？

Eclipse 显示以下信息：“MyApplicationListener 无法解析为类型”？有 3 个快速修复可用： 1\. 创建类 MyApplicationListener 2\. 更改为“ApplicationListener” (com.badlogic.gdx) 3\. 修复项目设置

选择 2 修复后，eclipse 显示另一个错误：“无法实例化类型 ApplicationListener”

我在 HaMMeReD 的帮助下解决了我的问题。

我在android项目中的代码：

```
public class MainActivity extends AndroidLiveWallpaperService {

    @Override
    public ApplicationListener createListener(boolean isPreview) {
        // TODO Auto-generated method stub
        return new SexyWomen();// here should be wrote name of class form main LibGDx project
    }

    @Override
    public AndroidApplicationConfiguration createConfig() {
        // TODO Auto-generated method stub
        return new AndroidApplicationConfiguration();
    }

    @Override
    public void offsetChange(ApplicationListener listener, float xOffset, float yOffset, float xOffsetStep, float yOffsetStep,
            int xPixelOffset, int yPixelOffset) {
        // TODO Auto-generated method stub
        Gdx.app.log("LiveWallpaper", "offset changed: " + xOffset + ", " + yOffset);

    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T01:23:04.933

将您的代码恢复原状。

选择选项 3 进行快速修复。

它应该在您的构建路径中包含您的 Main Gdx 项目并修复该错误。

手动转到 Java-Build-Path/Projects 选项卡并添加您的 Gdx 项目。

您的后端项目需要能够访问您的主 gdx 项目才能找到该类。

# android - 服务：启动互联网时刷新

> ID：13690210
> 
> 赞同：0
> 
> 时间：2012-12-03T19:23:46.880
> 
> 标签：android, twitter, service, notifications, broadcastreceiver

我是 android 新手，我正在创建一个使用 twitter api 的应用程序，并存储在字符串数组中以列出我的 twitter。

我需要创建一个将在后台运行的服务，每次我连接到互联网时，它都会更新我的字符串数组并调用我的 brodcast 以获取通知。

有谁知道该怎么做？也许是一个例子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:30:27.337

定义“在后台运行”？无限期地离开 UI 线程，等待连接到 Internet 的请求然后回复？

使用 IntentService。当你想连接时，向它发送一个 Intent。使用 LocalBroadcastReceiver 将 Intent 发送回您的 Activity。

# python - Python：是否有使用多个键的优化字典类型（类似于数据库）？

> ID：13690214
> 
> 赞同：1
> 
> 时间：2012-12-03T19:24:05.203
> 
> 标签：python, performance, optimization, python-2.7, dictionary

即允许您像在数据库中一样有效地访问和更新数据。

我的具体情况如下：

我有一个非常大的蒙特卡洛模拟+优化，数据被分类到几个字典中，每个字典有 600k+ 元组键，格式如下：

```
simple_dictionary[(year, month, day, hour, minute)] = value_or_small_list_or_small_numpy_array 
```

事实证明，上面的内容实际上比嵌套字典要慢一些：

```
simple_dictionary[year][month][day][hour][minute] = value_or_small_list_or_small_numpy_array 
```

这让我相信——如果我错了，请纠正我——后一种格式检查的密钥比前者少。这个假设是基于我的代码（太长无法发布）。我的代码在 之后不会创建新键`__init__`，但每次迭代至少调用一次每个键/值对。但是，并非所有值都会更新。

*假设这可以/应该从 RAM 运行*，是否有比上述代码更有效的替代方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:38:52.577

您是否考虑过尝试使用内存中的[sqlite3](http://docs.python.org/2.7/library/sqlite3.html#module-sqlite3)数据库？这将与您所能获得的“类似于数据库”一样，并且都在内存中。:)

使用连接字符串`:memory:`为您提供了一个内存数据库。

# actionscript-3 - AS3 Signals：有没有办法知道信号何时已经发送？

> ID：13690220
> 
> 赞同：0
> 
> 时间：2012-12-03T19:24:46.810
> 
> 标签：actionscript-3, events, signals

我在我的最新项目中使用了 Robert Penner 的 Signals。它工作得很好。

[https://github.com/robertpenner/as3-signals](https://github.com/robertpenner/as3-signals)

现在我需要一种方法来知道过去某个地方何时已经发送了信号 hal。例如，我有一个类在完全加载时分派信号，但我需要在同一个类中设置一些标志，以允许某些方法仅在事件已被分派时才能工作。

因此，快速而快速的解决方案是在事件处理程序中添加一个布尔值：

```
isLoaded = true; 
```

但我想知道 Signal 类中是否已经实现了一些我可以使用的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T11:39:31.760

我在 Penner 的原始类中添加了 RelaxedSignal 类。他们还没有被合并到他的代码库中，并且怀疑他们永远不会。不知道为什么，我问了他好几次，他都没有反应。

无论如何，如果您订阅了一个已经发送的信号，它将立即为订阅者调用监听器。我特别为像你这样的情况创建了这个，你想对可能已经发生或可能尚未发生的事件做出响应。

> 信号很棒，但确实缺少一个功能：在发送信号后订阅信号的能力。

说明：[http ://creynders.wordpress.com/2011/10/06/relaxedsignals/](http://creynders.wordpress.com/2011/10/06/relaxedsignals/)

来源：[https ://github.com/creynders/as3-signals](https://github.com/creynders/as3-signals)

示例：[https ://github.com/creynders/RelaxedSignalsDemo](https://github.com/creynders/RelaxedSignalsDemo)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:33:50.797

我认为你会在你的类中添加一个布尔值，我认为你不应该让它依赖于信号，因为也许你稍后会将它更改为正常事件，然后你就搞砸了。`isLoaded`布尔值应该是加载器的一部分，而不是信号/事件。

# c++ - 包括之间的冲突：stdafx.h 和 VisualStudio 2012 C++（错误 C2953：类模板已被定义）

> ID：13690222
> 
> 赞同：1
> 
> 时间：2012-12-03T19:24:57.943
> 
> 标签：c++, include, compiler-errors, visual-studio-2012

我在这个问题上卡了太久，必须问全能的 Stack。请原谅问题的简单性！

我正在使用 VisualStudio 2012 中的 BowlingGame kata 来练习他们的单元测试版本。我在测试#2 的重构部分的中间，我在我的 Game 类中添加了一个向量，以保存滚动的引脚数。

然而，当我将向量包含添加到我的头文件时，我得到了一个编译器错误！事实上，是我的单元测试类引发了编译器错误（不是我的源代码）。

我认为问题是单元测试类中的 stdafx.h 包含与源代码标头中的向量包含之间的冲突，但我不确定。它也可能是托管/本机 C++ 问题？在这个练习中，我不得不完成其中的一些。

下面是编译器错误（缩写，因为它一直在继续）和到目前为止我的三个文件的代码。请让我知道我能做些什么来解决这个问题。我正在尝试在此练习中使用“最佳实践”，因此，如果您发现任何其他看起来可疑的内容，请告诉我！

```
1>------ Build started: Project: BowlingGameUnitTests, Configuration: Debug Win32 ------
1>  BullseyeCoverage Compile C++ 8.7.21 Windows License 7978 
1>  Copyright (c) Bullseye Testing Technology 1990-2012
1>CL : Command line warning d9999: changing /clr:safe to -clr
1>  BowlingGameTest.cpp
1>c:/Program Files (x86)/Microsoft Visual Studio 11.0/VC/include/xrefwrap(156): warning C4561: '__fastcall' incompatible with the '/clr' option: converting to '__stdcall'
1>c:/Program Files (x86)/Microsoft Visual Studio 11.0/VC/include/xrefwrap(156): error C2953: 'std::_Result_of<_Ret(__stdcall &)(void),std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil>' : class template has already been defined
1>          c:/Program Files (x86)/Microsoft Visual Studio 11.0/VC/include/xrefwrap(156) : see declaration of 'std::_Result_of<_Ret(__stdcall &)(void),std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil>'
1>c:/Program Files (x86)/Microsoft Visual Studio 11.0/VC/include/xrefwrap(156): error C2953: 'std::_Result_of<_Ret(__stdcall *)(void),std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil>' : class template has already been defined
1>          c:/Program Files (x86)/Microsoft Visual Studio 11.0/VC/include/xrefwrap(156) : see declaration of 'std::_Result_of<_Ret(__stdcall *)(void),std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil,std::_Nil>' 
```

游戏.h：

```
#pragma once
#include <vector>
using namespace std;

class Game
{
public:
    Game(void);
    ~Game(void);
    void roll( int pins );
    int score();

private:
    int totalScore;
    vector<int> rolls;
    int currentRoll;
}; 
```

游戏.cpp：

```
#include "stdafx.h"
#include "Game.h"

Game::Game(void)
{
    totalScore = 0;
    currentRoll = 0;
}

Game::~Game( void )
{
}

void Game::roll( int pins )
{
    totalScore += pins;
    rolls.push_back(pins);
}

int Game::score()
{
    return totalScore;
} 
```

BowlingGameTest.cpp:

```
#include "stdafx.h"
#include "../BowlingGame/Game.h"

using namespace System;
using namespace System::Text;
using namespace System::Collections::Generic;
using namespace Microsoft::VisualStudio::TestTools::UnitTesting;

namespace BowlingGameUnitTests
{
    [TestClass]
    public ref class BowlingGameTest
    {
    private:
        Game* game;

    public: 
        [TestInitialize()]
        void MyTestInitialize() 
        {
            game = new Game();
        }

        void rollMany( int frames, int pins ) 
        {
            for (int i = 0; i < frames; i++)
            {
                game->roll(pins);
            }
        }

        [TestMethod]
        void gutterGame()
        {
            rollMany(20, 0);
            Assert::AreEqual<int>(0, game->score());
        }

        [TestMethod]
        void testAllOnes()
        {
            rollMany(20, 1);
            Assert::AreEqual<int>(20, game->score());
        }
    };
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:01:55.370

感谢 pstrjds！

回答第 1 部分：将 std::vector 更改为 cliext vector，因为我的单元测试项目是 C++/CLI 项目。

回答第 2 部分：重新配置解决方案。目前，它是本地源代码和托管单元测试，但这会导致很多小问题。将更改为原生源代码和原生单元测试。

# shell - 如何使用 PowerShell 快捷方式中的“默认”颜色启动 powershell.exe？

> ID：13690223
> 
> 赞同：35
> 
> 时间：2012-12-03T19:24:59.847
> 
> 标签：shell, powershell, powershell-3.0

当您从预安装的快捷方式之一启动 PowerShell 窗口时，我会附上漂亮的蓝色窗口。但是，如果你手动启动 powershell.exe，你不会得到这些颜色，你会得到黑色/白色 :(

这是因为默认设置是在快捷方式 (.lnk) 文件中设置的：

![PowerShell 快捷方式颜色设置](../Images/7aed5d90d962243db54afad464938069.png)

我在资源管理器上下文菜单中有一个“PowerShell Prompt Here”条目，我希望它使用与常用快捷方式相同的漂亮颜色来启动 PowerShell；黑色很糟糕，而且拥有不同颜色的窗口会令人困惑（尤其是当我经常打开一些也是黑色的老式命令窗口时！）。

到目前为止，我在尝试设置时发现了两个问题：

1.  从 PowerShell 中设置颜色似乎只允许某些值（ConsoleColor 枚举），这些值都不匹配默认快捷方式上的值。
2.  在 PS 配置文件中设置颜色只会导致之后写入的文本采用新的背景颜色。添加“cls”会导致原始颜色在开始时出现令人讨厌的闪光。

有什么方法可以从命令行启动 PowerShell（即，我可以将其作为资源管理器上下文菜单项嵌入注册表）使用与快捷方式相同的设置？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-04T13:47:46.463

编辑您的配置文件脚本（由 $profile 指向）并自己设置所需的颜色：

```
# set regular console colors
[console]::backgroundcolor = "darkmagenta"
[console]::foregroundcolor = "darkyellow"

# set special colors

$p = $host.privatedata

$p.ErrorForegroundColor    = "Red"
$p.ErrorBackgroundColor    = "Black"
$p.WarningForegroundColor  = "Yellow"
$p.WarningBackgroundColor  = "Black"
$p.DebugForegroundColor    = "Yellow"
$p.DebugBackgroundColor    = "Black"
$p.VerboseForegroundColor  = "Yellow"
$p.VerboseBackgroundColor  = "Black"
$p.ProgressForegroundColor = "Yellow"
$p.ProgressBackgroundColor = "DarkCyan"

# clear screen
clear-host 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-12-03T20:12:48.067

这是一个非常简单的方法：

# 1\. 将 .LNK 添加到您的 PATHEXT 变量中。

开始 -> 运行“sysdm.cpl” -> 高级 -> 环境变量

向下滚动系统变量，双击 PATHEXT

添加.LNK；如下图所示：

![路径扩展](../Images/799235985fe9856b90b1edd049b14ac9.png)

# 2 复制默认的“Windows Powershell.lnk”

```
Copy-Item "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Accessories\Windows PowerShell\Windows PowerShell.lnk" "C:\Windows\System32\powershell.lnk" 
```

# 3\. 在运行提示符下键入“powershell”现在将显示默认控制台颜色/配置。

您可以根据自己的喜好进一步自定义 C:\Windows\System32 中的 .lnk。

请注意，这只会起作用，因为您已将 .lnk 添加到可接受的扩展名列表中，并且默认情况下 c:\windows\system32 是搜索路径（PATH 系统变量）中的第一项。

***如果控制台是通过 cmd.exe 启动的，这将不会自定义控制台。***

# 4\. 要从“在此处运行 Powershell”上下文菜单中执行此操作，请将其保存为 .reg 文件并导入：

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Directory\shell\PowerShellHere\command]
@="C:\\WINDOWS\\system32\\cmd.exe /c start powershell -NoExit \"cd '%1';(get-host).ui.rawui.windowtitle = 'Oompa Loompa'\""

[HKEY_CLASSES_ROOT\Directory\shell\PowerShellHere\command]
@="C:\\WINDOWS\\system32\\cmd.exe /c start powershell -NoExit \"cd '%1';(get-host).ui.rawui.windowtitle = 'Oompa Loompa'\"" 
```

我正在使用 cmd.exe 调用“start”，它将启动 powershell.lnk 并将当前工作目录作为参数传递。似乎还不能从地址栏工作。我应该在 45 分钟前回家，但你的问题解决起来很有趣！:)

奖励积分：您可以将发送到 Powershell 的命令线程化。因此，如果您要修改 Powershell 控制台的标题属性：

```
\"cd '%1';(get-host).ui.rawui.windowtitle = 'Oompa Loompa'" 
```

只需在命令之间添加一个分号。

快乐炮击

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2017-01-02T13:52:05.587

我发现使用[concfg 工具](https://github.com/lukesampson/concfg)和[scoop](https://github.com/lukesampson/scoop)为 Powershell 安装颜色和字体非常有用：

1.  安装勺子：

    ```
    iex (new-object net.webclient).downloadstring('https://get.scoop.sh') 
    ```

2.  安装配置：

    ```
    scoop install concfg 
    ```

3.  安装[Solarized 主题](https://github.com/lukesampson/concfg/blob/master/preset_examples/README.md#solarized)：

    ```
    concfg import solarized 
    ```

就是这样，感谢作者！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-07-23T16:53:09.053

单击系统菜单（窗口左上角的 PowerShell 图标），然后单击默认值。您可以在此处更改默认颜色，PowerShell Prompt Here 命令将遵守该颜色。

来自：[https ://superuser.com/a/523017/109736](https://superuser.com/a/523017/109736)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-05-18T00:08:39.180

正确的方法是使用注册表

```
cd hkcu:/console
$0 = '%systemroot%_system32_windowspowershell_v1.0_powershell.exe'
ni $0 -f
sp $0 ColorTable00 0x00562401
sp $0 ColorTable07 0x00f0edee 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-12-05T14:23:01.223

1.  运行`regedit`命令打开注册表编辑器
2.  通过导出来跟踪`HKEY_CURRENT_USER > CONSOLE`和备份整个文件夹以防万一
3.  删除文件夹

重新启动您的 Powershell，配色方案必须已重置为默认值。

注意：如果您有任何其他与 PowerShell（或命令提示符、Git Bash 等）相关的设置需要保留，请进一步探索控制台文件夹以删除相应的键

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-04-17T16:06:08.150

这是我的解决方案（在作为系统启动的脚本中设置颜色）。可能超出您的需要（请参阅我自己的答案）：

[https://superuser.com/questions/891519/using-psexec-to-launch-powershell-session-as-system-with-specific-window-attribu](https://superuser.com/questions/891519/using-psexec-to-launch-powershell-session-as-system-with-specific-window-attribu)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-12-13T14:41:02.500

基于@rex-hardin 出色的[回答](https://stackoverflow.com/a/13690899/1034782)，我改进了此处的注册表编辑器内容以添加一个图标，并使用 PowerShell 原生参数从正确的路径开始。

右键单击目录背景以及直接右键单击目录图标时，将启用上下文菜单。

当然，我们还运行一个与默认控制台完全相同的蓝色背景控制台。

## 1.在环境变量中添加“ `.LNK`”扩展名`%PATHEXT%`

这允许系统执行带有`.lnk`扩展名的文件（快捷方式的隐藏扩展名）

## 2.将默认的PowerShell快捷方式链接复制到system32作为`powershell`文件

这允许`powershell`命令从`system32`文件夹（位于`%PATH%`）中启动我们的快捷方式

使用资源管理器（复制+重命名）或下面的命令行：

```
Copy-Item "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Accessories\Windows PowerShell\Windows PowerShell.lnk" "C:\Windows\System32\powershell.lnk" 
```

## 3\. 将以下代码添加到`powershell_here.reg`文件中并执行。

**powershell_here.reg**

```
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\directory\background\shell\PowerShell]
@="PowerShell Here"
"Icon"="%SystemRoot%\\system32\\WindowsPowerShell\\v1.0\\powershell.exe"

[HKEY_CLASSES_ROOT\directory\background\shell\PowerShell\command]
@="cmd.exe /c start powershell -NoExit -NoProfile -Command Set-Location -LiteralPath '%V'"

[HKEY_CLASSES_ROOT\directory\shell\PowerShell]
@="PowerShell here"
"Icon"="%SystemRoot%\\system32\\WindowsPowerShell\\v1.0\\powershell.exe"

[HKEY_CLASSES_ROOT\directory\shell\PowerShell\command]
@="cmd.exe /c start powershell -NoExit -NoProfile -Command Set-Location -LiteralPath '%L'" 
```

[![在此处输入图像描述](../Images/00dd7565e50fecf5b97d09292d5f052c.png)](https://i.stack.imgur.com/57CUl.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-06-16T21:48:17.690

在 Windows 7 Pro 64 位上从 Explore 或 Total Commander 或 Double Commander 启动当前文件夹中默认蓝色和白色的 powershell：

1.  星形菜单 -> 搜索 PowerShell 链接 -> 右键单击​​它 -> 属性 -> 快捷方式选项卡（默认打开的选项卡） -> 修改 Start in: -> %CD%

[![在此处输入图像描述](../Images/1ff1307d7398fb2d5daba974bf70a9fb.png)](https://i.stack.imgur.com/GWiZo.png)

2.  在系统 PATH 上的某个文件夹中的某处创建一个名为**ps.bat**的批处理文件（如果您没有这样的文件夹，只需创建一个，假设*C:\run\cli*并将其添加到 PATH 系统环境变量中）。此批处理文件必须包含以下命令：

    开始 "" "C:\ProgramData\Microsoft\Windows\开始菜单\程序\附件\Windows PowerShell\Windows PowerShell.lnk"

就是这样。现在只需在显示当前文件夹的资源管理器的路径栏中或在 Total Commander 或 Double Commander 等的命令行框中键入 ps...

在 Windows 10 上，无需从“开始”菜单修改 PowerShell 快捷方式，上面的 ps.bat 文件可能仅包含以下命令：

```
start %SystemRoot%\system32\WindowsPowerShell\v1.0\powershell.exe 
```

# jsf-2 - 如何在名为 div 的复合组件中正确包装 Richfaces 面板

> ID：13690224
> 
> 赞同：0
> 
> 时间：2012-12-03T19:25:04.993
> 
> 标签：jsf-2, composite-component

我尝试在resources/ui/div.xhtml中写：

```
<?xml version="1.0" encoding="utf-8"?>
<ui:component xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:composite="http://java.sun.com/jsf/composite"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    >
    <composite:interface>
        <composite:attribute name="binding" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="bodyClass" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="header" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="headerClass" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="id" required="false" type="java.lang.String" />
        <composite:attribute name="ondblclick" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="onkeydown" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="onkeypress" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="onkeyup" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="onmousedown" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="onmousemove" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="onmouseout" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="onmouseover" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="onmouseup" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="rendered" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="style" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="styleClass" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="onclick" required="false"
            type="javax.el.ValueExpression" />
        <composite:attribute name="title" required="false"
            type="javax.el.ValueExpression" />
    </composite:interface>
    <composite:implementation>
        <rich:panel         
            binding="cc.attrs.binding"
            bodyClass="cc.attrs.bodyClass" header="cc.attrs.header"
            headerClass="cc.attrs.headerClass" id="cc.attrs.id"
            ondblclick="cc.attrs.ondblclick" onkeydown="cc.attrs.onkeydown"
            onkeypress="cc.attrs.onkeypress" onkeyup="cc.attrs.onkeyup"
            onmousedown="cc.attrs.onmousedown"
            onmousemove="cc.attrs.onmousemove"
            onmouseout="cc.attrs.onmouseout"
            onmouseover="cc.attrs.onmouseover"
            onmouseup="cc.attrs.onmouseup" rendered="cc.attrs.rendered"
            style="cc.attrs.style" styleClass="cc.attrs.styleClass" 
            onclick="cc.attrs.onclick" 
            title="cc.attrs.title">
            <composite:insertChildren />
        </rich:panel>
    </composite:implementation>
</ui:component> 
```

并从这里调用它：

```
<html
...
xmlns:u="http://java.sun.com/jsf/composite/ui">
...
<u:div styleClass="dualbrand">
    test        
</u:div>
...
</html> 
```

但我收到错误：

> javax.servlet.ServletException：java.lang.String 无法转换为 javax.faces.component.UIComponent javax.faces.webapp.FacesServlet.service(FacesServlet.java:606) org.jboss.weld.servlet.ConversationPropagationFilter.doFilter( ConversationPropagationFilter.java:62) com.ocpsoft.pretty.PrettyFilter.doFilter(PrettyFilter.java:118) org.jboss.solder.servlet.exception.CatchExceptionFilter.doFilter(CatchExceptionFilter.java:65) org.jboss.solder.servlet。 event.ServletEventBridgeFilter.doFilter(ServletEventBridgeFilter.java:74)

如果我将实现更改为：

```
<composite:implementation>
    <rich:panel         
        binding="#{cc.attrs.binding}"
        bodyClass="#{cc.attrs.bodyClass}" header="#{cc.attrs.header}"
        headerClass="#{cc.attrs.headerClass}" id="#{cc.attrs.id}"
        ondblclick="#{cc.attrs.ondblclick}" onkeydown="#{cc.attrs.onkeydown}"
        onkeypress="#{cc.attrs.onkeypress}" onkeyup="#{cc.attrs.onkeyup}"
        onmousedown="#{cc.attrs.onmousedown}"
        onmousemove="#{cc.attrs.onmousemove}"
        onmouseout="#{cc.attrs.onmouseout}"
        onmouseover="#{cc.attrs.onmouseover}"
        onmouseup="#{cc.attrs.onmouseup}" rendered="#{cc.attrs.rendered}"
        style="#{cc.attrs.style}" styleClass="#{cc.attrs.styleClass}" 
        onclick="#{cc.attrs.onclick}" 
        title="#{cc.attrs.title}">
        <composite:insertChildren />
    </rich:panel>
</composite:implementation> 
```

我会得到：

> javax.servlet.ServletException: /WEB-INF/templates/main.xhtml @34,33 styleClass="dualbrand" 无法将类 java.lang.String 类型的 dualbrand 转换为类 javax.el.ValueExpression javax.faces.webapp.FacesServlet .service(FacesServlet.java:606) org.jboss.weld.servlet.ConversationPropagationFilter.doFilter(ConversationPropagationFilter.java:62) com.ocpsoft.pretty.PrettyFilter.doFilter(PrettyFilter.java:118) org.jboss.solder.servlet .exception.CatchExceptionFilter.doFilter(CatchExceptionFilter.java:65) org.jboss.solder.servlet.event.ServletEventBridgeFilter.doFilter(ServletEventBridgeFilter.java:74)

我应该怎么做才能正确包裹面板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:50:55.733

至于你的第一个例外，首先使用`attributename="cc.attrs.attributename"`是完全错误的。这不是它的工作原理。EL 表达式应该像 in`#{}`一样包含在`attributename="#{cc.attrs.attributename}"`. 这就是规范要求它的方式。

至于您的第二个例外，那是因为您将类型声明为 a`javax.el.ValueExpression`而不是表达式后面的实际对象类型，这是`java.lang.String`在`styleClass`属性的情况下。相应地修复它：

```
<composite:attribute name="styleClass" required="false"
    type="java.lang.String" /> 
```

对其他类型执行相同操作。有关正确类型的概述，请参阅您尝试委托给的[VDL 文档。](http://docs.jboss.org/richfaces/latest_4_X/vdldoc/rich/panel.html)`<rich:panel>`

# php - 如何创建以下红色标记框

> ID：13690225
> 
> 赞同：-5
> 
> 时间：2012-12-03T19:25:09.667
> 
> 标签：php, javascript, jquery, css

我想在我的网页中创建一个模式弹出窗口，但我对它们的了解还不够，无法自己制作一个。你能帮我提供任何指向教程、代码等的链接吗？

这就是我希望我的模态的样子：

![在此处输入图像描述](../Images/0d6781c2d88755174265c38e5947b945.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:33:42.697

您可能想查看 jQuery UI 对话[http://jqueryui.com/dialog/](http://jqueryui.com/dialog/)

名称是：弹出框、模式框和对话框，但我相信还有很多其他的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:28:52.143

[使用 HTML 创建一个弹出窗口](http://www.quackit.com/html/codes/html_popup_window_code.cfm)

可能不是指向的最佳位置。但它会显示/给你创建弹出窗口的代码。

自定义取决于您。

未来参考：**首先做你的研究**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T19:41:20.220

检查 Twitter Bootstrap 的 Modals；它们看起来像这样：

[推特引导 | GitHub](http://twitter.github.com/bootstrap/javascript.html#modals)

堆栈溢出不是您获取代码的地方。这是一个发布您已经完成的工作并寻求修改帮助的地方。

# python - python对象何时是垃圾收集的候选对象？

> ID：13690226
> 
> 赞同：2
> 
> 时间：2012-12-03T19:25:27.497
> 
> 标签：python, object, reference, garbage-collection

我试图弄清楚python对象何时是垃圾收集的候选对象。我已经阅读了一些文件/帖子，但无法找到明确的答案。

以下面一行为例。这是对 foo 的最后一次引用。foo 指向的对象何时可用于垃圾回收？

```
ret = func(['xyz: ' + foo.name]) 
```

将其分解为（可能的）单个步骤：

1.  创建对名称的临时引用。
2.  'xyz:' 与名称连接并返回值。
3.  列表是使用新字符串创建的。
4.  使用新数组调用函数。
5.  函数返回。
6.  结果分配给ret。
7.  下一个指令...

在哪两个步骤之间，对象首先有资格被收集？对象的引用计数何时减少？

如果步骤列表不完整/不正确，也请告诉我。我只是试图列举它们，为可能的参考答案提供一个共同的起点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T19:34:25.373

与其他垃圾收集语言一样，经验法则是：当它无法访问时。这意味着，只要程序（它的任何部分）仍然可以访问它，就不能 gc'd。在那之后，这是公平的游戏。何时（甚至*是否*）*实际*回收它完全取决于实现。

在您的示例中，该名称`foo`使对象保持活动状态，因为程序仍然可以在以后的语句中使用它。（理论上，一个实现可以检测一个变量是否不再使用，并删除该引用 - 可能使该对象更快无法访问。实际上，这在 Python 中是不可能的，除非在 JIT 编译器编译的某些跟踪中。）列表，相反，如果在某些可到达的位置（例如，可到达对象的属性或全局变量）不存储对它的引用，`func`则可能在执行之后甚至在执行期间变得不可访问。`func`

请注意，您混淆了`foo`它所指的对象，这在推理垃圾收集时是致命的。没有对象`foo`，只有一个`foo`在给定时间点引用的对象（因此，它在不同的时间点引用了一组对象）。这很重要：

*   `foo`可能会更改为引用另一个对象，并且它最初引用的对象可能变得无法访问。除非您区分这两种情况，否则您不能谈论这种情况。
*   可能有许多其他对对象`foo`指向的引用（实际上很有可能）。`foo`在超出范围、被馈送到`del`或更改为引用另一个对象后，该对象可能会保持存活很长时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T19:26:35.150

只要对该变量的所有引用超出范围或被手动删除（`del x`），该变量就可以进行垃圾回收。

在您的示例中，`foo`必须在此行之前存在（否则它是 a `NameError`），因此在您的示例代码块中永远不会被垃圾收集，因为在此之后引用仍然存在。即使有人`del foo`在此之后调用，我们也必须假定在其他任何地方都没有对该对象的引用，以便对其进行垃圾收集。

# javascript - 如何将 jquery 用于 div 的 onclick 事件？

> ID：13690228
> 
> 赞同：0
> 
> 时间：2012-12-03T19:25:36.663
> 
> 标签：javascript, jquery, html, onclick

我的页面上有几个 div。请参阅示例[http://jsfiddle.net/AYRh6/26/](http://jsfiddle.net/AYRh6/26/) 当我尝试将此代码传输到我的 asp.net mvc3 项目时，它看起来像：

```
<html>
<head>
    <meta charset="utf-8" />
    <title>@ViewBag.Title</title>
    <link href="@Url.Content("/Content/Site.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("/Scripts/jquery-1.8.3.js")" type="text/javascript"></script>
    <script src="@Url.Content("/Scripts/modernizr-1.7.min.js")" type="text/javascript"></script>
    <script type="text/javascript">  
        $('.tab').click(function() {
        $(this).addClass('active').siblings().removeClass('active');
        })​;
    </script>
</head>
<body>
<div class="main">
        <div class="tab" style="float:right;">Tab 3</div>
        <div class="tab" style="float:right;">Tab 2</div>
        <div class="tab active" style="float:right;">Tab 1</div>
    </div>
</body>
</html> 
```

CSS：

```
.main{
    width:325px;
}
div.tab {
    background: white;
    width: 100px;
    border: 1px solid grey;
    padding-left:5px;
}
div.tab.active {
    background: blue;
}
div.tab:hover {
    background: aqua;
} 
```

如您所见，javascript 位于 html 页面的标题处。它对我不起作用。我试图为以下`onclick`事件设置此脚本：

```
<div class="tab" style="float:right;" onclick="$(this).addClass('active').siblings().removeClass('active');">Tab 3</div>
            <div class="tab" style="float:right;" onclick="$(this).addClass('active').siblings().removeClass('active');">Tab 2</div>
            <div class="tab active" style="float:right;" onclick="$(this).addClass('active').siblings().removeClass('active');">Tab 1</div> 
```

它工作正常！当这个脚本位于标题时，我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T19:28:19.067

Javascript 代码会立即执行，但您要附加处理程序的元素尚未放入 DOM。您可以在 jQuery 中使用[.ready](http://api.jquery.com/ready/)或将您的脚本放在文档的底部：

```
<script type="text/javascript">  
    $(document).ready(function(){
            $('.tab').click(function() {
            $(this).addClass('active').siblings().removeClass('active');
        }
     })​;
</script> 
```

如果您使用调试器并`$('.tab').click`在代码中设置断点，您会注意到它`$('.tab')`返回一个空的元素数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:28:30.053

如果您查看您的链接，您会看到您选择了在 DOM 就绪上执行脚本的选项。你必须在你的网站上做同样的事情。

```
jQuery(document).ready(function() {
    $('.tab').click(function() {
        $(this).addClass('active').siblings().removeClass('active');
    })​;

}); 
```

# entity-framework - 具有相关数据的多个 where 条件

> ID：13690232
> 
> 赞同：1
> 
> 时间：2012-12-03T19:26:00.133
> 
> 标签：entity-framework

我有一种情况需要对查询应用一些过滤器，所以我有一个代表过滤器的类：

```
public class ReportNoteFilterDto
{
    public int Year { get; set; }
    public int Month { get; set; }
} 
```

我需要根据这个过滤器选择数据。

```
var query = _db.User;

if (filter.Month > 0 && filter.Month <= 12)
    query.Select(u => new {
        User = u,
        Notes = u.Notes.Where(n => n.Begin.Month == filter.Month)
    });

if (filter.Year > 2011)
    query.Select(u => new
    {
        User = u,
        Notes = u.Notes.Where(n => n.Begin.Year == filter.Year)
    });

var results = query.Include("Notes.Foo.Bar").ToList(); //doesn't work 
```

我也需要选择 Notes.Foo.Bar。

我怎样才能做到这个多重过滤器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:32:44.197

~~您没有将第一个查询的结果分配给*`query`*变量~~

你可以在这里看到一个类似的问题是如何解决的：

```
class Program
{
    //A simple class to hold the results
    public class Result
    {
        public string Item { get; set; }

        public IQueryable<string> Collection { get; set; }
    }

    static void Main(string[] args)
    {
        var list1 = new List<Result>();
        var objects = list1.Select(o => new Result { Item = o.Item, Collection = o.Collection.Where(a=> a.Length == 10) });
        if(true)
           objects = objects.Select(o => new Result { Item = o.Item, Collection = o.Collection.Where(a=> a.Length > 15) });
    }
} 
```

# javascript - Iframe 中的画布未在 Firefox 中调整大小和重绘

> ID：13690233
> 
> 赞同：0
> 
> 时间：2012-12-03T19:26:00.690
> 
> 标签：javascript, iframe, canvas, resize

我有一个使用选项designermode =“on”创建的所见即所得Iframe。在其中，我插入了一个画布，当它有焦点时，它会根据键盘输入依次绘制和调整大小。

在 Chrome 和 Safari 中一切正常，但在 Firefox 中，画布不会调整大小。有谁知道为什么它在 Firefox 中不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:09:48.357

发现了；我在画布更改之前禁用了设计器模式并在之后启用了它。

# razor - 使用 MVC 4 和 Razor 定期更新 textarea 值

> ID：13690235
> 
> 赞同：1
> 
> 时间：2012-12-03T19:26:09.510
> 
> 标签：razor, asynchronous, asp.net-mvc-4

在不刷新整个页面的情况下更新 textarea 值的最简单方法是什么？控制器中的异步方法会更改 textarea 的值，但是如何更新视图？我已经阅读了有关使用 SignalR 推送更新的信息，这种方法会有帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T13:47:57.453

在您的 AjaxOptions 中指定一个 JavaScript 方法来调用 OnSuccess

```
 new AjaxOptions { OnSuccess = "UpdatePage(data)" }) 
```

从控制器中的操作发回 JsonResult

```
 return new JsonResult
        {
            Data = new
            {
                variable1 = value1,
                variable2 = value2,
                variable3 = value3
            },
            JsonRequestBehavior = JsonRequestBehavior.AllowGet
        }; 
```

并在 javascript 方法中处理您发回的数据

```
 function UpdatePage(data) {            
        $("input[name='UpdateMe1']").val(data.variable1);
        $("input[name='UpdateMe2']").val(data.variable2);
        $("#UpdateMe3").html(data.variable3);
    } 
```

# google-apps-script - 为 Google 表单的 OnFormSubmit 触发器定义 e.values 时遇到问题

> ID：13690240
> 
> 赞同：0
> 
> 时间：2012-12-03T19:26:26.453
> 
> 标签：google-apps-script

我正在尝试创建一个脚本，该脚本将使用提交的 Google 表单来创建会议议程。我使用脚本“本周员工奖”作为首发，但我对编码的完全缺乏经验让我很难过。

我创建了一个 googde 文档议程模板，其中的关键占位符与我在 google 表单中要求的数据相匹配（因此是我的 google 电子表格中列的标题）。目标是当有人提交描述会议议程项目的表单时，此脚本会获取该数据并使用 google doc 议程模板为他们的会议创建议程。

这是我编辑的脚本：

```
// Global variables 
    var docTemplate = "1-4ELCpEGvrtnprnBYoLapwASK6TYmt3YpY0BkBKICrM";  
    var docName     = "Agenda";

function onFormSubmit(e) { // add an onsubmit trigger
// Meeting name and date values come from the spreadsheet form
   var meeting_name     = e.values[1];
   var date             = e.values[2];
// Get document template, copy it as a new temp doc, and save the Doc’s id
   var copyId = DocsList.getFileById(docTemplate)
            .makeCopy(docName+' for '+Meeting_Name)
            .getId();
// Open the temporary document
   var copyDoc = DocumentApp.openById(copyId);
// Get the document’s body section
   var copyBody = copyDoc.getActiveSection();
// Replace place holder keys,  
   copyBody.replaceText('keyMeeting_Name', Meeting_Name); 
   copyBody.replaceText('keyDate', Date);
   var Agenda_Item_1 = e.values[3]
   var Item_1_Time   = e.values[4] 
   var Agenda_Item_2 = e.values[5] 
   var Item_2_Time   = e.values[6] 
   var Agenda_Item_3 = e.values[7] 
   var Item_3_Time   = e.values[8] 
   copyBody.replaceText('keyAgenda_Item_1', Agenda_Item_1);
   copyBody.replaceText('keyItem_1_Time', Item_1_Time);
   copyBody.replaceText('keyAgenda_Item_2', Agenda_Item_2);
   copyBody.replaceText('keyItem_2_Time', Item_2_Time);
   copyBody.replaceText('keyAgenda_Item_3', Agenda_Item_3);
   copyBody.replaceText('keyItem_3_Time', Item_3_Time);
// Save and close the temporary document
   copyDoc.saveAndClose();
} 
```

当我运行它时，我得到`TypeError: Cannot read property "values" from undefined (line 7)`. 我假设该错误对于所有后续`e.values`行都是正确的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-29T06:21:41.880

如果您手动运行此函数，则 e 将未定义。当有人提交表单时，您将需要安装触发器以运行 onFormSubmit()。相关说明在[“](https://developers.google.com/apps-script/understanding_triggers)使用容器特定的可安装触发器”标题下。安装触发器后，脚本将在有人提交表单时运行，然后可以在分配给 e 的对象中找到“表单提交”事件的各个方面，如[“](https://developers.google.com/apps-script/understanding_events)电子表格表单提交事件”表中所述。具体来说，e.values 将是一个数组，其中包含用户在表单中输入的值。

# java - 在 JOptionPane 中打印数组

> ID：13690241
> 
> 赞同：0
> 
> 时间：2012-12-03T19:26:31.283
> 
> 标签：java, arrays, printing, joptionpane

```
public String show(int[] row)
    {
        for(int i = 0; i < row.length; i++)
        {
            JOptionPane.showMessageDialog(null, row[i]);
        }
    } 
```

这段代码有什么问题？我只想打印参数中给出的数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:30:24.030

您可以将返回类型更改为`void`：

```
public void show(int[] row) { 
```

此外，如果您希望显示数组中的所有元素，您可以执行以下操作：

```
JOptionPane.showMessageDialog(null, Arrays.toString(row)); 
```

如果需要退货`String`，可以使用相同的方法：

```
return Arrays.toString(row); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:33:31.467

尝试这个：

```
public void show(int[] row)
    {
        for(int i = 0; i < row.length; i++)
        {
            JOptionPane.showMessageDialog(null, row[i]);
        }
    return;
    } 
```

或者...

```
public String show(int[] row)
    {
        String s = "";
        for(int i = 0; i < row.length; i++)
        {
            s  += row[i]);
        }
        JOptionPane.showMessageDialog(null, s);
        return s;
    } 
```

或者...

```
public String show(int[] row)
        {
            String s = "";
            for(int i = 0; i < row.length; i++)
            {
                JOptionPane.showMessageDialog(null, row[i]);
                s  += row[i]);
            }
            return s;
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T19:31:56.553

试试这个：

```
public String show(int[] row) {
  String returnValue = Arrays.toString(row);
  JOptionPane.showMessageDialog(null, returnValue);

  return returnValue;
} 
```

# vb.net - VB.Net 类到 CSV

> ID：13690247
> 
> 赞同：0
> 
> 时间：2012-12-03T19:26:41.350
> 
> 标签：vb.net

我正在互联网上寻找一种干净、直接的方法来转换可以转换为 CSV 的实体类的 List 集合。基本上，我正在创建一个网页，用户可以在其中输入一些参数，MS SQL 返回映射到一个类的结果，该类本身会建立一个列表。但是，结果不是用于显示，而是用于保存到 CSV。

是否有将（实体）列表转换为 CSV 的简单方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T01:16:12.287

我认为 .NET 中没有任何本机 CSV 支持，因此如果您可以使用 XML 而不是 CSV，那么您将更容易序列化为 XML。对于 CSV，您需要编写自己的序列化程序。

就个人而言，我编写了将 DataTable 转换为 CSV 文件并返回的函数。CSV 是二维的，因此首先将对象转换为数据表对我来说是有意义的。

如果你想使用 XML，那么 DataTable 的序列化/反序列化例程是内置的：`DataTable.WriteXml()`和`DataTable.ReadXml()`

CSV 没有标准，所以我建议你在处理字符串、转义字符等的方式上模仿 Microsoft Excel 版本的 CSV。[这篇文章](http://creativyst.com/Doc/Articles/CSV/CSV01.htm)对解析也很有帮助。

# hive - DynamoDB 上的 Hive 工作没有进展

> ID：13690249
> 
> 赞同：0
> 
> 时间：2012-12-03T19:26:48.543
> 
> 标签：hive, amazon-dynamodb

我在 DynamoDB 数据库中有大约 35GB（2200 万行）的网络点击数据。我可以通过按键提取数据就好了。我现在正在尝试使用 Hive 来计算该数据的聚合，并且即使是基本的东西也无法正常工作。

我的 DynamoDB 设置为读取吞吐量为 40。我的 EMR 设置有一个 m1.small 主服务器和三个 m1.large 核心。我在 Hive 中执行以下操作：

```
SET dynamodb.throughput.read.percent=1.0;

CREATE EXTERNAL TABLE AntebellumHive (user_id string, session_time string, page_count string, custom_os string)
STORED BY 'org.apache.hadoop.hive.dynamodb.DynamoDBStorageHandler' 
TBLPROPERTIES ("dynamodb.table.name" = "AntebellumClickstream", 
"dynamodb.column.mapping" = "user_id:user_id,session_time:session_time,page_count:x-page-count,custom_os:x-custom-os"); 

select count(*)
from AntebellumHive
WHERE session_time > "2012/08/14 11:48:00.210 -0400"
  AND session_time < "2012/08/14 12:48:00.210 -0400"; 
```

所以，我映射了四列（包括 user_id 键和 session_time 范围字段，以及其他两件事）。然后我只是想计算一个小时的数据中的行数，应该是数百个。

这是输出：

```
Total MapReduce jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapred.reduce.tasks=<number>
Starting Job = job_201212031719_0002, Tracking URL = http://ip-xxxxx.ec2.internal:9100/jobdetails.jsp?jobid=job_201212031719_0002
Kill Command = /home/hadoop/bin/hadoop job  -Dmapred.job.tracker=x.x.x.x:9001 -kill job_201212031719_0002
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 1
2012-12-03 19:13:58,988 Stage-1 map = 0%,  reduce = 0%
2012-12-03 19:14:59,415 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 4.5 sec
2012-12-03 19:15:00,423 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 4.5 sec
2012-12-03 19:15:01,435 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 4.5 sec
2012-12-03 19:15:02,441 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 4.5 sec
2012-12-03 19:15:04,227 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 4.5 sec
2012-12-03 19:15:05,233 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 4.5 sec
2012-12-03 19:15:06,255 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 4.5 sec
2012-12-03 19:15:07,263 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 4.5 sec
2012-12-03 19:15:08,269 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 4.5 sec
2012-12-03 19:15:09,275 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 4.5 sec
2012-12-03 19:15:10,290 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 4.5 sec
2012-12-03 19:15:11,296 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 4.5 sec 
```

（被屏蔽的 IP。）每分钟左右，我就会获得另一秒钟的 CPU 时间，但 map% 永远不会从零开始增加，即使在 20 分钟或更长时间之后，它也永远不会完成。我绝对可以在 Dynamo 和 EMR 的监控图中看到发生的事情。

我究竟做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T01:25:13.087

如果我正确阅读了您的帖子，则您有 35 GB 的数据，并且您正在尝试使用 40 读取 IOPS 读取数据。40 IOPS 大致转换为 40 KBPS 进行扫描。这意味着完成查询大约需要 254 小时。

一旦一个或多个映射器完成处理，Hive 就会更新查询百分比。由于创建的每个映射器都可能需要很长时间才能运行，因此您不会很快看到 Hive 更新。

您可以登录到主节点上的 Hadoop UI 并查看 Hadoop 统计信息。它将向您显示各个地图任务的状态以及有关读取数据的一些统计信息。请参考文档：

[http://docs.amazonwebservices.com/ElasticMapReduce/latest/DeveloperGuide/emr-web-interfaces.html](http://docs.amazonwebservices.com/ElasticMapReduce/latest/DeveloperGuide/emr-web-interfaces.html) http://docs.amazonwebservices.com/ElasticMapReduce/latest/DeveloperGuide/UsingtheHadoopUserInterface.html

# sql - SQL Server 对分隔列的全文搜索

> ID：13690254
> 
> 赞同：0
> 
> 时间：2012-12-03T19:26:58.163
> 
> 标签：sql, sql-server-2008-r2

我正在 SQL Server 2008 R2 中创建数据仓库的原型。客户希望将几个关键字段放入一个以逗号分隔的列中，他们可以在其中进行关键字搜索。我已经实现了全文搜索，但是有没有办法只搜索列的特定部分？例如，如果列数据如下所示：

DATA_Column

A,B,C,D,A,E

B,B,D,C,A,G

有没有办法对只存在于第 5 位的“A”进行全文搜索？

这样的查询应该返回上例中的第二行，而不是第一行。

# coldfusion - 根据用户角色更改 FullCalendar 中的全局“可编辑”回调值

> ID：13690255
> 
> 赞同：2
> 
> 时间：2012-12-03T19:27:03.177
> 
> 标签：coldfusion, fullcalendar

我正在使用[FullCalendar](http://arshaw.com/fullcalendar/) jQuery 插件以及 ColdFusion 和 MySQL。我有两个用户级别，“管理员”和“只读”。我希望“只读”用户只能查看日历上的事件而不进行任何更改，而“管理员”角色具有完整的编辑功能。`editable`我希望通过向 FullCalendar选项添加一个函数来做到这一点，`true`如果用户的角色是管理员并且`false`用户角色是只读的，则该选项将设置为。

该变量`userRole`基于 ColdFusion 会话变量在页眉中设置。我验证了`userRole`在 javascript 中调用时确实包含正确的字符串。

我尝试了什么：

```
$("#calendar").fullCalendar({
    // other options and callbacks
    // ....

    editable: function(){
        if (userRole == 'Read-Only') {
            return false //events can not be modified
        }
        else if (userRole == 'Admin') {         
            return true  //events can be modified
        }
    },
    // other callbacks
    // ...
}); 
```

`editable`当我使用 Firebug 单步执行代码时，会跳过该选项的整个功能，并且两种用户类型的事件都是可编辑的。

我的 jQuery 函数是否存在缺陷（我是 jQuery 编程新手）？FullCalendar`editable`选项是否不允许使用函数？

我可以通过对每个 FullCalendar 回调（例如 eventDrop、eventResize、select 和 eventClick）进行用户角色检查来解决这个问题

```
select: function(start, end, allDay) {
        // check if user is Admin, if not, unselect and return
        if (userRole != 'Admin') {
            alert("You do not have the permissions to edit events.");
            $("#calendar").fullCalendar( 'unselect' );
            return
        }

        // proceed if user is Admin
        // ...
} 
```

并且仅在用户角色为“管理员”时才继续，但我希望能够更全局地设置角色。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T01:06:37.960

根据您对日历的实施，有几种方法可以解决此问题。

由于您已经在使用 ColdFusion 设置 JavaScript 变量，所以您不能简单地执行以下操作：

```
editable: <cfif session.userType eq 'Admin'>true<cfelse>false</cfif> 
```

或者，我控制它的方式是通过 Event 对象。我通常将日历默认设置为“可编辑：false”，然后选择性地允许事件对象在每个对象的基础上进行编辑。我通过一个返回 JSON 的 web 服务 cfc 从 ColdFusion 生成我的事件，让 ColdFusion 决定谁可以编辑什么，然后使用 FullCalendar 进行显示。

# facebook-graph-api - 在 PostCompleted 事件中检索 FacebookBatchParameter

> ID：13690257
> 
> 赞同：1
> 
> 时间：2012-12-03T19:27:06.007
> 
> 标签：facebook-graph-api, facebook-c#-sdk

我正在使用 Facebook C# SDK，但使用 Visual Basic 编写应用程序。因此，我无法动态创建事件处理程序，如 C# 示例中所示：

```
fb.GetCompleted += (o, e) => {             }; 
```

相反，我这样做：

```
AddHandler fb.GetCompleted , AddressOf HandleGetCompleted 
```

这个问题是我不确定如何判断我在`HandleGetCompleted`函数中向 Facebook API 发出了哪个请求。例如`me/home`，`me/accounts`两者都返回一个`JsonArray`被调用`data`但我无法判断它是帐户数据还是新闻提要数据。有什么方法可以跟踪`FacebookBatchParameters`用于触发每个事件的事件吗？

# android - Android关闭服务或仅在需要内存时暂停？

> ID：13690259
> 
> 赞同：0
> 
> 时间：2012-12-03T19:27:10.977
> 
> 标签：android, service, background

我正在尝试提供一项服务以在后台无限期地继续工作，如果它结束，则自行重新启动。运行良好一段时间，但 30 或 40 分钟后停止发送信号，但服务仍在列表中继续。并且永远不会进入 OnDestroy()。

我不知道android是真的停止还是只是暂停。我想不要停下来，因为我等了很长时间，再也没有表现出生命的迹象。这是我的代码的一部分。测试原因，干脆做一个无限循环，每分钟在通知栏显示一条消息。

```
 public int onStartCommand(Intent intent, int flags, int startId) {

      Log.i("Timer", "Service starting" );

      new Thread(new Runnable() { 
            public void run() {
                Runit();
            }
        }).start();

      return START_STICKY;
  }

 private void Runit(){

      Log.i(getClass().getSimpleName(), "Timer started.");
      try {

          while (true){
              Thread.sleep(60000);
              iTimer += 1;                   
              new Thread(new Runnable() { 
                  public void run() {
                      SendNotification("Timer "+String.valueOf(iTimer));
                  }
              }).start();

          }

      } catch (InterruptedException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
        SendNotification(e1.getMessage());

      }

    SendNotification("Service Stop");

} 
```

我使用 startForeground() 进行了另一次测试，因此持续了两天的工作直到我停止它。但我不想显示在通知栏中。

它停止工作的原因是什么？android暂停还是停止？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:29:32.773

当 android 需要释放一些内存时，它会**杀死**占用该内存的进程。暂停没有多大意义，因为暂停的进程仍然可以锁定资源。

您的测试用例无效 - 没有理智的人会在移动设备上进行繁忙循环。如果您每分钟都需要做某事，请设置重复警报并尽可能快地完成您的工作。

# r - 使用 Rmpi 时如何调试/解决“序列化太大而无法存储在原始向量中”错误

> ID：13690260
> 
> 赞同：0
> 
> 时间：2012-12-03T19:27:14.083
> 
> 标签：r, parallel-processing, apply

我正在使用 R 和 Rmpi​​ 中的并行处理工具对我大学的 Unix 集群进行分析。当我使用 snow 包或仅使用标准 apply 函数在本地（Windows）机器上运行下面显示的 R 脚本时，它非常慢，但似乎工作正常。当我使用 Rmpi​​ 在 Unix 集群上运行它时，我收到一个错误“序列化太大而无法存储在原始向量中”。这篇[文章](https://stackoverflow.com/questions/5775064/mclapply-with-big-objects-serialization-is-too-large-to-store-in-a-raw-vector)似乎是正确的，但我来回传递的向量（50K）不应该接近触发这个错误。此外，我可以通过将数据分成更小的部分来让事情部分发挥作用。我认为问题一定是与 Rmpi​​ 相关的某种内存泄漏，但我没有调试这种东西所需的工具。希望您至少可以为我指明调试这里发生的事情的工具的方向。

我正在使用的数据有大约 250 万条记录，每条记录有大约 40 列。我向 parApply 提交了一个 50K x 40 的数据帧，它返回一个 50K 的数值向量。

```
#In an effort to avoid the serialization error I break into smaller pieces to avoid    
#problems with large vectors getting transferred between master and slave nodes
numBreaks<-floor(length(data[,1])/50000)
base<-min(length(data[,1]),50000)  #test data sets are < 50K and shouldn't 
                                   #crash the function    piece.in<-data[c(1:base),]         #this is the first batch of records I submit

status<-mpi.parApply(piece.in,1,test) #returns a vector of length 50K
#status<-apply(piece.in,1,test)   #commented out, function runs fine locally using                 
                                  #standard apply function
#cl <- makeSOCKcluster(c("localhost","localhost","localhost","localhost","localhost"))
#status<-parApply(cl,piece.in,1,test) #commented out, function runs fine locally
                                      #using snow's SOCK cluster and identical
                                      #parApply function
if(numBreaks>1){
for (i in 2:numBreaks){
  piece.in<-data[c((base+1):(base+50000)),]
  piece.out<-mpi.parApply(piece.in,1,test)  #returns a vector of length 50K

 #piece.out<-apply(piece.in,1,test)
 #piece.out<-parApply(cl,piece.in,1,test)
  status<-append(status,piece.out)          #add to existing vector
  base<-base+50000                          #increment base
  print(paste("clusters assigned to records",base,"through",(base+50000)))
 }
}

#This piece cleans up the residual records 
if((length(c(base:length(data[,1])))>1) & (base < length(data[,1]))){
  piece.in<-data[c((base+1):length(data[,1])),]
  #piece.out<-apply(piece.in,1,test)
  piece.out<-mpi.parApply(piece.in,1,test)
  #piece.out<-parApply(cl,piece.in,1,test)
  status<-append(status,piece.out)
  print(paste("Final: status has length",length(status)))
 } 
```

此函数在测试数据集（约 100K 记录）上按预期工作。它使用雪或标准应用功能在本地工作（尽管需要一天）。在我将它分解成更小的部分之前，它因“序列化太大......”错误而失败。当我制作 10 万条记录时，它失败并出现同样的错误。它成功运行（如写入文件的打印语句所记录）一直到覆盖记录 130 万到 135 万的迭代，记录分批提交 50K，然后因序列化错误而失败。

我知道还有其他方法可以进行并行处理（我希望在这里使用 foreach 命令），但我受限于对创建并行节点的计算环境一无所知，所以我想留下如果可以的话，用 Rmpi​​。关于如何调试的任何提示？

非常感谢。

克里斯

# java - JTextPane 语法高亮

> ID：13690269
> 
> 赞同：1
> 
> 时间：2012-12-03T19:28:08.743
> 
> 标签：java, swing, jtextpane, syntaxhighlighter

我目前正在开发一个非常简单的 IDE，用于 Java 中的 C 编程。简单地说，我的意思是它有一些小的代码猜测（类似于 Eclipse）、一些小的自动完成（再一次，想想 Eclipse）和一些语法突出显示。我几乎把所有的事情都弄清楚并粗略了（即工作，但不漂亮或效率不高），除了我在正确的语法突出显示方面遇到了一些麻烦。

我的意思是；在我的代码 JFrame 中，我放入了一个 JTextPane，这样我就可以使用不同的字体、粗体、非粗体、斜体，并相对轻松地添加不同的文本颜色。我有一个键监听器连接到这个 JTextPane，并且在每次按下空格键时，它都会抓取你刚刚写的内容，通过“if”语句树运行它以查看你写的单词是否是关键字。如果你这样做了，它会尝试突出（或不突出）你刚刚写的内容。但是，在某些情况下，我需要它在点击空格键之前更改颜色（例如注释或#define 语句）。没问题，对吧？只需添加另一个“if”语句来检测是否已按下该键，如果已按下，则更改字体颜色。好吧，这就是我试图做的，但是它不起作用。

抱歉，如果这没有多大意义，如果需要，我很乐意解释一下。我还尽可能多地删除了不必要的代码，以尝试缩短它。

非常感谢您的宝贵时间！

〜美分

SSCCE：

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.util.ArrayList;

import javax.swing.JFrame;
import javax.swing.JTextPane;
import javax.swing.text.SimpleAttributeSet;
import javax.swing.text.StyleConstants;
import javax.swing.text.StyledDocument;

public class Main implements Runnable
{
private static final long serialVersionUID = 1L;
private static final int WIDTH = 800;
private static final int HEIGHT = 600;
private static final String NAME = "";
private JFrame frame;
private JTextPane textPane = new JTextPane();
private int keysPressed = -1; /* Keys pressed */
private ArrayList<Integer> keyCode = new ArrayList<Integer>(); /* List of our keyCodes */

public void run()
{
    frame = new JFrame(NAME);
    frame.setPreferredSize(new Dimension(WIDTH, HEIGHT));
    frame.setMinimumSize(new Dimension(WIDTH, HEIGHT));
    frame.setMaximumSize(new Dimension(WIDTH, HEIGHT));
    frame.setResizable(false);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
    frame.setLayout(new BorderLayout()); 
    frame.add(textPane, BorderLayout.CENTER);
    textPane.setPreferredSize(new Dimension(WIDTH, HEIGHT));
    textPane.setEditable(true);
    textPane.addKeyListener(new KeyListener(){
                @Override 
                public void keyPressed(KeyEvent e) 
                {
                     int previousPos; /* Previous position of the caret */
                     int length; /* Length of our grabbed string */

                     int currentPos; /* Current position of the caret */

                     String text; /* The entire text of the JTextPane */
                     String subText; /* Our sub-string-text we're using */
                     String subTextP; /* Our sub-string-text plus one character*/

                     boolean first = true; /* Be default, it's the first letter */

                     StyledDocument doc = textPane.getStyledDocument(); 
                     SimpleAttributeSet sas = new SimpleAttributeSet(); /* So we can set bold, and such */

                     keyCode.add(new Integer(e.getKeyCode())); /* The key pressed */
                     keysPressed++;
                     currentPos = textPane.getCaretPosition(); /* The current position of the caret */

                     text = textPane.getText(); /* Grabbing the text on the text pane */
                     previousPos = text.lastIndexOf(" ", currentPos); /* Getting the last position of a space */
                     if(previousPos <= 0) /* If the position if before or equal to 0 */ 
                     {
                         previousPos = 0; /* Then the position is 0 */
                     }
                     length = currentPos - previousPos; /* The length of the string we're messing with, is between the two positions */
                     subText = text.substring(previousPos, currentPos); /* Grabbing the string between our two positions */
                     if(first) /* If this is the first letter, or insert */
                     {
                         if(keyCode.contains(KeyEvent.VK_SHIFT))
                         {
                             first = true;
                             subTextP = text.substring(0, 0); /* Then we want to grab it, at 0, 0 */
                         }
                         else
                         {
                             subTextP = text.substring(0, 0); /* Then we want to grab it, at 0, 0 */
                             first = false; /* it's no longer the first */
                         }
                     }
                     else /* If it isn't */
                     {
                         subTextP = text.substring(previousPos + 1, currentPos); /* Then we want to grab the usual */
                     }
                     subText = subText.replaceAll("[\\n\\t\\r]", ""); /* Getting rid of all the tabs and newlines */
                     subTextP = subTextP.replaceAll("[\\n\\t\\r]", ""); /*Getting rid of all the tabs and new lines */

                     if(keyCode.contains(KeyEvent.VK_3)) 
                     {
                         if(keyCode.contains(KeyEvent.VK_SHIFT)) 
                         {
                             System.out.println("Number sign hit!");                                 
                             StyleConstants.setForeground(sas, Color.GREEN); /* Anything following a number sign will be green */
                             doc.setCharacterAttributes(previousPos, length, sas, false);  /* Turning it green */
                         }
                     }
                     if(keyCode.contains(KeyEvent.VK_SPACE)) /* If a space has been hit! */
                     {
                         /* This is were we'll do all text coloring and such */
                         if(subText.equals(" if") || subText.equals("if") || subTextP.equals("if")) /* All things to be bolded */
                         {
                             StyleConstants.setForeground(sas, Color.GRAY); /* All of these statements will be gray... */
                             StyleConstants.setBold(sas, true); /* ... and bold */
                             doc.setCharacterAttributes(previousPos, length, sas, false); /* Making them so! */
                             StyleConstants.setBold(sas, false); /* We don't want these attributes to remain... */
                             StyleConstants.setForeground(sas, Color.black); /* ... So we're removing them. */
                         }
                     }
                }

                public void keyReleased(KeyEvent e) 
                {
                    for(int i = keysPressed; i >= 0; i--) /* For loop to remove all keyPresses from our list */
                    {
                        keyCode.remove(i); /* Removing the specified keyPress */
                    }
                    keysPressed = -1; /* Because the first index is 0, and we want to add one to keysPressed, we need to start below 0 */
                }

                @Override
                public void keyTyped(KeyEvent arg0) {
                }
    });
    frame.pack(); 
    frame.setVisible(true);
}

public void start()
{
    new Thread(this).start();
}

public final static void main(String args[])
{
    new Main().start();
}

} 
```

编辑：

要重现此问题，请运行上面提供的代码。在 textPane 中，输入单词“if”（不带引号），然后按空格键。这个词现在应该加粗，并且是灰色的。现在，尝试在它之后输入“#”（不带引号），（中间有空格）并点击空格或任何其他键；什么都没发生。但是，系统应该打印出“数字符号命中！” 一旦你输入一个“#”，这意味着代码实际上仍然可以访问。另请注意，我对“#”使用与“if”*相同的代码（除了更改颜色）。*希望能帮助你们更多地理解这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T06:14:30.743

首先在`KeyListener`这里使用是不正确的。

使用`KeyBindings`or`DocumentListener`或`DocumentFilter`代替（甚至用自己的扩展替换 Document 以覆盖`insertString()`和`remove()`方法）。您不仅应该在输入空格之后更改突出显示，而且还应该在有人从关键字中间删除字符时更改突出显示。

请发布[SSCCE](http://sscce.org)以显示实际问题并提供重现实际行为和描述所需行为的步骤。

# java - 使用注释处理器替换代码

> ID：13690272
> 
> 赞同：23
> 
> 时间：2012-12-03T19:28:15.293
> 
> 标签：java, code-generation, annotation-processing

我正在尝试编写一个[注释处理器](http://docs.oracle.com/javase/7/docs/api/javax/annotation/processing/Processor.html)来在一个类上插入方法和字段......并且文档非常稀疏。我没有走远，我不知道我是否正确接近它。

处理环境提供了一个[`Filer`](http://docs.oracle.com/javase/7/docs/api/javax/annotation/processing/Filer.html)对象，该对象具有创建新源文件和类文件的方便方法。这些工作正常，但后来我试图弄清楚如何读取现有的源文件，它提供的只是“getResource”。所以在我的处理器实现中，我这样做了：

```
@Override
public boolean process(Set<? extends TypeElement> annotations, RoundEnvironment roundEnv) {
    try {
        for (TypeElement te : annotations) {
            for (Element element : roundEnv.getElementsAnnotatedWith(te)) {
                FileObject in_file = processingEnv.getFiler().getResource(
                    StandardLocation.SOURCE_PATH, "",
                    element.asType().toString().replace(".", "/") + ".java");

                FileObject out_file = processingEnv.getFiler().getResource(
                    StandardLocation.SOURCE_OUTPUT, "",
                    element.asType().toString().replace(".", "/") + ".java");

                //if (out_file.getLastModified() >= in_file.getLastModified()) continue;

                CharSequence data = in_file.getCharContent(false);

                data = transform(data); // run the macro processor

                JavaFileObject out_file2 = processingEnv.getFiler().createSourceFile(
                    element.asType().toString(), element);
                Writer w = out_file2.openWriter();
                w.append(data);
                w.close();
            }
        }
    } catch (Exception e) {
        e.printStackTrace();
        processingEnv.getMessager().printMessage(Diagnostic.Kind.ERROR, e.getMessage());
    }
    return true;
} 
```

我的第一个困惑是我不禁觉得`element.asType().toString().replace(".", "/") + ".java"`（获取限定类型名称并将其转换为包和源文件路径）不是解决问题的好方法。API 的其余部分被过度设计，但似乎没有一种方便的方法来检索原始源代码。

真正的问题是编译器会自发地被输出目录中的第二个源文件（“错误：重复类”）弄乱，现在我被卡住了。

我已经写了剩下的部分——一个宏词法分析器和解析器，以及用于计算一些数据和插入字段值和方法的东西——但它作为编译器之外的初始步骤运行。除了原始文件不能具有 .java 扩展名（以防止编译器看到它们）这一事实之外，这很好用。然后听说注解可以做代码生成，我觉得会比较合适和方便，但是找不到太多的指导。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-20T20:38:01.497

注释处理器背后的意图是允许开发人员添加新类，而不是替换现有类。话虽如此，有一个错误允许您将代码添加到现有类。 [Lombok 项目](http://projectlombok.org/)利用[这一](http://notatube.blogspot.com/2010/11/project-lombok-trick-explained.html)点将 getter 和 setter（除其他外）添加到已编译的 java 类中。

我采取的“替换”方法/字段的方法是从输入类扩展或委托给输入类。这允许您覆盖/转移对目标类的调用。

因此，如果这是您的输入类：

InputImpl.java：

```
public class InputImpl implements Input{
    public void foo(){
        System.out.println("foo");
    }
    public void bar(){
        System.out.println("bar");
    }
} 
```

您可以生成以下内容来“替换”它：

InputReplacementImpl.java：

```
public class InputReplacementImpl implements Input{

    private Input delegate;

    //setup delegate....

    public void foo(){
        System.out.println("foo replacement");
    }
    public void bar(){
        delegate.bar();
    }
} 
```

这就引出了一个问题，你如何引用`InputReplacementImpl`而不是`InputImpl`. 您可以生成更多代码来执行包装，也可以简单地调用预期生成的代码的构造函数。

我不太确定你的问题是什么，但我希望这能对你的问题有所启发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-01-08T08:30:40.103

有点晚了:)，但一种解决方案可能是使用 Byte Buddy 的转换器作为构建过程的一部分。参见例如[https://github.com/raphw/byte-buddy/tree/master/byte-buddy-maven-plugin](https://github.com/raphw/byte-buddy/tree/master/byte-buddy-maven-plugin)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-09T12:58:35.670

我不知道这个提示是否符合您的需求，但您的想法将与依赖注入（例如 Spring）结合使用。

1.  为类型和保留“SOURCE”创建一个自定义注释，它将被 Spring 忽略。
2.  对注释处理器中的代码进行所需的更改，并将 Spring 的 @Component 注释添加到生成的 Java-Type 中，并将其保存为原始类型的子类型，其类名与原始类型不同。
3.  当 Spring 创建上下文时，它将根据您的处理结果而不是原始结果加载类。

相反，Lombok 直接操作抽象源代码树，这比生成源代码复杂得多。这里的问题是，Java-Compiler-Module 被暴露（拼图）。

Another alternative could be to use some bytecode-api like ByteBuddy, to proxy the original class at runtime. This will also require dependency-injection if you do not want to write code for instantiatig the class. Here the magic is an autowired field of type collection inside a Configuration class. Let me know, if this is interesting to you. Then I will add more details, here.

# java - Android TextView 在一段后截断

> ID：13690273
> 
> 赞同：1
> 
> 时间：2012-12-03T19:28:17.740
> 
> 标签：java, android, textview

我正在为我的校报创建一个应用程序，但在尝试显示全文时遇到了问题。目前我有一个从 RSS 提要中提取的文章列表，当单击它时，它会显示文章的内容。然而，只有第一段显示在 TextView 中，无论它有多长。这让我也相信它与`<p></p>`HTML 标签有关。我对 RSS 提要或解析 XML 不是很熟悉（这是我第一次尝试），并且一直在寻找方法来完成我想要完成的工作。

我的这个项目基于这个博客的一系列帖子：[http ://android-er.blogspot.com/2010/04/simple-rss-reader-in-listview.html](http://android-er.blogspot.com/2010/04/simple-rss-reader-in-listview.html)

我采用了此处提供的项目并将其添加到带有滑动模板的选项卡中，并更改了某些元素的布局方式。

免责声明：有很多评论丑陋的代码，我懒得拿出来。这主要是我在布局中不想要的东西。这是包含文章列表的片段：

```
public class AllStoriesFragment extends ListFragment {

    /*********************************************************************
     * RSS Async Task
     *********************************************************************/
    public class RssLoadingTask extends AsyncTask<Void, Void, Void> {

        @Override
        protected void onPostExecute(Void result) {
            // TODO Auto-generated method stub
            displayRss();
        }

        @Override
        protected void onPreExecute() {
            // TODO Auto-generated method stub
            preReadRss();
        }

        @Override
        protected void onProgressUpdate(Void... values) {
            // TODO Auto-generated method stub
            //super.onProgressUpdate(values);
        }

        @Override
        protected Void doInBackground(Void... arg0) {
            // TODO Auto-generated method stub
            readRss();
            return null;
        }

    }
    /*********************************************************************
     * End RSS Async Task
     *********************************************************************/

    private RSSFeed myRssFeed = null;

    TextView feedTitle;
    TextView feedDescription;
    //TextView feedPubdate;
    TextView feedLink;
    //TextView feedContent;

    /*********************************************************************
     * Custom Array Adapter 
     *********************************************************************/
    public class MyCustomAdapter extends ArrayAdapter<RSSItem> {
        public MyCustomAdapter(Context context, int textViewResourceId,
                List<RSSItem> list) {
            super(context, textViewResourceId, list);
        }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            // TODO Auto-generated method stub
            //return super.getView(position, convertView, parent);

            View row = convertView;

            if(row==null){
                LayoutInflater inflater=getActivity().getLayoutInflater();
                row=inflater.inflate(R.layout.row, parent, false);
            }

            TextView listTitle=(TextView)row.findViewById(R.id.listtitle);
            listTitle.setText(myRssFeed.getList().get(position).getTitle());
            TextView listPubdate=(TextView)row.findViewById(R.id.listpubdate);
            listPubdate.setText(myRssFeed.getList().get(position).getPubdate());

            if (position%2 == 0){
                listTitle.setBackgroundColor(0xff101010);
                listPubdate.setBackgroundColor(0xff101010);
            }
            else{
                listTitle.setBackgroundColor(0xff080808);
                listPubdate.setBackgroundColor(0xff080808);
            }

            return row;
        }
    }
    /*********************************************************************
     * End Custom Array Adapter 
     *********************************************************************/

   /** Called when the fragment is first created. */
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        // Inflate the layout for this fragment
        View v =  inflater.inflate(R.layout.fragment_allstories, null);;

        feedTitle = (TextView)v.findViewById(R.id.feedtitle);
        feedDescription = (TextView)v.findViewById(R.id.feeddescription);
        //feedPubdate = (TextView)v.findViewById(R.id.feedpubdate);
        feedLink = (TextView)v.findViewById(R.id.feedlink);
        startReadRss();

        return v ;
    }

   private void startReadRss(){
       new RssLoadingTask().execute();
   }

   private void preReadRss(){
       setListAdapter(null);

       Toast.makeText(getActivity(), "Reading RSS, Please wait.", Toast.LENGTH_LONG).show();
   }

   private void readRss(){
       try {
           URL rssUrl = new URL("http://www.campusslate.com/feed/");
           SAXParserFactory mySAXParserFactory = SAXParserFactory.newInstance();
           SAXParser mySAXParser = mySAXParserFactory.newSAXParser();
           XMLReader myXMLReader = mySAXParser.getXMLReader();
           RSSHandler myRSSHandler = new RSSHandler();
           myXMLReader.setContentHandler(myRSSHandler);
           InputSource myInputSource = new InputSource(rssUrl.openStream());
           myXMLReader.parse(myInputSource);

           myRssFeed = myRSSHandler.getFeed();
       } 
       catch (MalformedURLException e) {
           // TODO Auto-generated catch block
           e.printStackTrace();
       } 
       catch (ParserConfigurationException e) {
           // TODO Auto-generated catch block
           e.printStackTrace();
       } 
       catch (SAXException e) {
           // TODO Auto-generated catch block
           e.printStackTrace();
       } 
       catch (IOException e) {
           // TODO Auto-generated catch block
           e.printStackTrace();
       }
    }

   private void displayRss(){

       if (myRssFeed!=null){

           MyCustomAdapter adapter = new MyCustomAdapter(getActivity(), R.layout.row, myRssFeed.getList());
           setListAdapter(adapter);
       }
   }

   public void onListItemClick(ListView l, View v, int position, long id) {
       // TODO Auto-generated method stub
       Intent intent = new Intent(getActivity(), ShowDetails.class);
   intent.putExtra("keyPubdate", myRssFeed.getItem(position).getPubdate());
   intent.putExtra("keyLink", myRssFeed.getItem(position).getLink());
   intent.putExtra("keyTitle", myRssFeed.getItem(position).getTitle());
   intent.putExtra("keyContent", myRssFeed.getItem(position).getContent());
       startActivity(intent);
   }

   public boolean onCreateOptionsMenu(Menu menu) {
       // TODO Auto-generated method stub
       menu.add(0, 0, 0, "Reload");
       return true;
   }

   @Override
   public boolean onOptionsItemSelected(MenuItem item) {
       // TODO Auto-generated method stub
       switch(item.getItemId()){
       case (0): startReadRss();
       break;
       default:
           break;
       }
       return true;
   }  
} 
```

这是单击列表中的项目时启动的活动：

```
package com.nick.pocketslate;

import android.app.Activity;
import android.os.Bundle;
import android.text.Html;
import android.text.method.ScrollingMovementMethod;
import android.widget.TextView;

public class ShowDetails extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.details);
        TextView detailsTitle = (TextView)findViewById(R.id.detailstitle);
        TextView detailsPubdate = (TextView)findViewById(R.id.detailspubdate);
        TextView detailsLink = (TextView)findViewById(R.id.detailslink);
        TextView detailsContent = (TextView)findViewById(R.id.detailscontent);

        Intent intent = getIntent();
    detailsTitle.setText(intent.getStringExtra("keyTitle"));
    detailsPubdate.setText(intent.getStringExtra("keyPubdate"));
    detailsLink.setText(intent.getStringExtra("keyLink"));
    detailsContent.setText(Html.fromHtml(intent.getStringExtra("keyContent")));

    detailsContent.setMovementMethod(new ScrollingMovementMethod());

    }
} 
```

在这一点上，我已经做了很多搜索并没有找到解决方案，我不确定我的代码的哪一部分可能会导致问题。如果有人可以查看并找到问题，我有一个链接可以在此处下载我的完整项目。

如果有人知道从哪里开始寻找，我会提出那部分代码。

[https://lh.rs/zbdYev99O1G5](https://lh.rs/zbdYev99O1G5)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:34:36.327

您显示的内容看起来是正确的，但是您的模型的代码在哪里 - RSSFeed？您可能希望获得一些调试输出，以显示您的 RSS 读取是否正常。也许您只得到摘要而不是全文？也许整篇文章应该从它自己的链接中阅读，而不是从删节的 RSS 提要中阅读？

对于 HTML 内容，您通常使用[LinkMovementMethod](http://developer.android.com/reference/android/text/method/LinkMovementMethod.html)，因此可以正确处理内容中的链接。假设您没有设置 TextView.maxLines 属性（可能需要检查），TextViews 会自动滚动。

此外，为简单起见，您应该直接从 Intent 添加/读取数据 - 实际上不需要通过中间 Bundle。[putExtra(String,String)](http://developer.android.com/reference/android/content/Intent.html#putExtra%28java.lang.String,%20java.lang.String%29)和[getStringExtra(String)](http://developer.android.com/reference/android/content/Intent.html#getStringExtra%28java.lang.String%29)或者您可以使用它们的 CharSequence 等效项，具体取决于 RSSReader 的确切输出内容。

**编辑：**您是否正在检查 TextView 是否正常滚动显示长度超过 5 行的虚拟文本？[您还可以尝试从外部复制您的提要中的内容数据（通过外部提要阅读器），并使用TextView.setText(CharSequence)](http://developer.android.com/reference/android/widget/TextView.html#setText%28java.lang.CharSequence%29)将其显式放入您的 TextView以检查提要本身中的某些内容是否导致您的问题。

（Html.fromHtml 是基于 TagSoup 的，它的设计目的是处理格式很差的 HTML，但您可以随时尝试使用纯文本进行测试，看看是否有效。您也可以使用调试日志/LogCat 来检查之前/after HTML 解析您的 RSS 提要内容。）

如果这些事情有问题，那么它可能是您的 TextView 布局/初始化的问题。如果这些都正常工作，那么您就知道问题出在您的 RSS 相关代码中。

您可以发布详细视图的布局代码吗？另外，你用的是模拟器还是手机？有时模拟器对滚动手势的响应方式与实际设备的响应方式不同。

**编辑：**如果问题出在 RSSHandler，我建议创建一个单独的/新的问题，适当地标记（SAX、XML-Parser、RSS）。如果您在此处发布指向该新问题的链接，我可以尝试在那里提供帮助。您也可以先尝试寻找可能有助于使用 SAX 方法进行 XML 解析的具体答案。这是我最近一直在使用的一个很好的教程 - [http://tutorials.jenkov.com/java-xml/sax.html](http://tutorials.jenkov.com/java-xml/sax.html)

# javascript - jQuery gridster 插件

> ID：13690279
> 
> 赞同：1
> 
> 时间：2012-12-03T19:28:48.117
> 
> 标签：javascript, jquery, html, jquery-plugins

我如何修改这个小提琴以将新项目添加到右侧而不是捕捉到底部...我希望固定高度并将其扩展到右侧的新项目

[http://jsfiddle.net/maxgalbu/UfyjW](http://jsfiddle.net/maxgalbu/UfyjW)

```
var layout;
var grid_size = 100;
var grid_margin = 5;
var block_params = {
max_width: 6,
max_height: 6
};
$(function() {

layout = $('.layouts_grid ul').gridster({
    widget_margins: [grid_margin, grid_margin],
    widget_base_dimensions: [grid_size, grid_size],
    serialize_params: function($w, wgd) {
        return {
            x: wgd.col,
            y: wgd.row,
            width: wgd.size_x,
            height: wgd.size_y,
            id: $($w).attr('data-id'),
            name: $($w).find('.block_name').html(),
        };
    },
    min_rows: block_params.max_height
}).data('gridster');

$('.layout_block').resizable({
    grid: [grid_size + (grid_margin * 2), grid_size + (grid_margin * 2)],
    animate: false,
    minWidth: grid_size,
    minHeight: grid_size,
    containment: '#layouts_grid ul',
    autoHide: true,
    stop: function(event, ui) {
        var resized = $(this);
        setTimeout(function() {
            resizeBlock(resized);
        }, 300);
    }
});

$('.ui-resizable-handle').hover(function() {
    layout.disable();
}, function() {

    layout.enable();
});

function resizeBlock(elmObj) {

    var elmObj = $(elmObj);
    var w = elmObj.width() - grid_size;
    var h = elmObj.height() - grid_size;

    for (var grid_w = 1; w > 0; w -= (grid_size + (grid_margin * 2))) {

        grid_w++;
    }

    for (var grid_h = 1; h > 0; h -= (grid_size + (grid_margin * 2))) {

        grid_h++;
    }

    layout.resize_widget(elmObj, grid_w, grid_h);
}
});​ 
```

# android - 限制 android 中的 SQLite 查询

> ID：13690281
> 
> 赞同：5
> 
> 时间：2012-12-03T19:28:55.883
> 
> 标签：android, sqlite, android-cursor, sql-limit

我在我的 android 应用程序中使用 SQLite 数据库，并且我有一个从某个表中选择行的函数：

```
public Cursor getAllDiscounts() {
    // return db.query(table, columns, selection, selectionArgs, groupBy,
    // having, orderBy);
    return db.query(DATABASE_TABLE, new String[] { KEY_ROWID,
            KEY_PORTALNAME, KEY_TITLE, KEY_TITLESHORT, KEY_DEALURL,
            KEY_ENDDATE, KEY_COORDS, KEY_CITY, KEY_IMAGEDEAL,
            KEY_CLICKPRICE, KEY_CONVERSIONPERCENTAGE, KEY_FINALPRICE,
            KEY_ORIGINALPRICE, KEY_SALES, KEY_KATEGORIJA, KEY_POPUST },
            null, null, null, null, null, null);
} 
```

我想要做的是选择从某一行开始的行并将结果限制为另一个数字。因此，例如，我想从第十行开始并选择以下 20 行。我试过这样：

```
public Cursor getAllDiscounts() {
    return db.query(DATABASE_TABLE, new String[] { KEY_ROWID,
            KEY_PORTALNAME, KEY_TITLE, KEY_TITLESHORT, KEY_DEALURL,
            KEY_ENDDATE, KEY_COORDS, KEY_CITY, KEY_IMAGEDEAL,
            KEY_CLICKPRICE, KEY_CONVERSIONPERCENTAGE, KEY_FINALPRICE,
            KEY_ORIGINALPRICE, KEY_SALES, KEY_KATEGORIJA, KEY_POPUST },
            null, null, null, null, null, "10, 20");
} 
```

但应用程序崩溃。我也尝试使用“LIMIT 10,20”而不是“10, 20”，但这也不起作用。任何人？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-02-27T12:02:15.437

限制子句应该是“10,20”，逗号和 20 之间没有空格。

```
public Cursor getAllDiscounts() {
    return db.query(DATABASE_TABLE, new String[] { KEY_ROWID,
            KEY_PORTALNAME, KEY_TITLE, KEY_TITLESHORT, KEY_DEALURL,
            KEY_ENDDATE, KEY_COORDS, KEY_CITY, KEY_IMAGEDEAL,
            KEY_CLICKPRICE, KEY_CONVERSIONPERCENTAGE, KEY_FINALPRICE,
            KEY_ORIGINALPRICE, KEY_SALES, KEY_KATEGORIJA, KEY_POPUST },
            null, null, null, null, null, "10,20");
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-03T19:53:59.080

尝试这个：

```
db.rawQuery("SELECT * FROM " + TABLE_NAME + " ORDER BY " + ORDER_BY + " LIMIT 0, 20", NULL); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-03T19:46:58.070

使用“limit 10 offset 20”作为限制子句。

```
 public Cursor getAllDiscounts() {
    return db.query(DATABASE_TABLE, new String[] { KEY_ROWID,
            KEY_PORTALNAME, KEY_TITLE, KEY_TITLESHORT, KEY_DEALURL,
            KEY_ENDDATE, KEY_COORDS, KEY_CITY, KEY_IMAGEDEAL,
            KEY_CLICKPRICE, KEY_CONVERSIONPERCENTAGE, KEY_FINALPRICE,
            KEY_ORIGINALPRICE, KEY_SALES, KEY_KATEGORIJA, KEY_POPUST },
            null, null, null, null, null, " limit 10 offset 20");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-23T17:03:24.517

`db.rawQuery("SELECT * FROM com_kkorm_data_Entity WHERE id!=0 ORDER BY id LIMIT 0,2",null);`

也许我的sql可以帮助你理解`LIMIT`sql

# google-apps-script - 遇到错误：缺少宏参数

> ID：13690285
> 
> 赞同：0
> 
> 时间：2012-12-03T19:29:30.000
> 
> 标签：google-apps-script

我正在生成谷歌文档，然后尝试更改锚点的地址，使其指向该文档

当我单击链接时，它会引发此错误错误遇到：缺少宏参数但是它仍然在新选项卡中打开正确的页面锚点是在 UIbuilder 中创建的，并使用以下代码进行了更改

```
 var newid= createPersonal(ename, reportPeriod);
var link= 'https://docs.google.com/a/meditech.com/document/d/'+newid+'/edit'
var anc=app.getElementById("Anchor1").setHref(link); 
```

我尝试手动添加一个锚点，它不会抛出错误。但是，它将链接放在页面底部，而不是我指定的位置

```
var anchor = app.createAnchor("report", link);
anchor.setStyleAttributes({LEFT: '385px'}).setStyleAttributes({TOP: '235px'}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T05:49:16.100

从上面的代码来看，错误似乎是在代码的其他部分产生的，而不是由您共享的代码产生的。

当您拥有文档 ID 时，我不确定您为什么要通过 DocsList 服务手动构建链接

```
var newId = 'ID_OF_YOUR_DOC';
var link = DocsList.getFileById(newId).getUrl();
var anc = app.getElementById("Anchor1").setHref(link); 
```

要相对于屏幕具有固定位置，您需要设置位置属性。例如。

```
var anchor = app.createAnchor("report", link);
anchorAttributes = {
  'position' : 'fixed',
  'left' : '100',
  'top' : '100'
};
anchor.setStyleAttributes(anchorAttributes); 
```

# ffmpeg - 如何使用新的 Flascc 编译器编译 ffmpeg？

> ID：13690290
> 
> 赞同：0
> 
> 时间：2012-12-03T19:29:50.327
> 
> 标签：ffmpeg, alchemy, flascc

我尝试使用具有以下参数的新 flascc 编译器编译 ffmpeg（我只设置了 h263 能力作为测试）：

```
PATH=/cygdrive/c/download/flascc/sdk/usr/bin:$PATH ./configure --enable-static 
--disable-shared --extra-libs=-static --extra-cflags=--static --disable-doc  --disable-ffplay 
--disable-ffprobe --disable-ffserver --disable-avdevice   --disable-avfilter   
--disable-pthreads  --disable-everything --enable-muxer=flv 
--enable-encoder=flv --enable-encoder=h263 --disable-mmx --disable-shared   
--prefix=bin/  --disable-protocols --disable-network --disable-optimizations --disable-debug 
--disable-asm --disable-stripping 
--prefix=/cygdrive/c/download/flascc/sdk/usr 
```

然后我尝试如下：

```
PATH=/cygdrive/c/download/flascc/sdk/usr/bin:$PATH make

PATH=/cygdrive/c/download/flascc/sdk/usr/bin:$PATH make install 
```

*.a 文件已在子目录中创建，例如：libavcodec.a。但是如何从 *.a 文件创建 .swf/.swc？

谢谢！查尔斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T16:25:24.890

在[文档](http://www.adobe.com/devnet-docs/flascc/docs/Reference.html)中它说您可以使用 -emit-swf 生成 SWF

> 要生成 SWF（适用于 Flash 运行时的可执行格式），请将 -emit-swf 参数传递给 GCC：
> 
> `gcc -emit-swf hello.c -o hello.swf`

和带有 -emit-swc 的 SWC

> -emit-swc= 发出一个 SWC，可以链接到 Flash Builder 项目或分发给其他人以链接到他们自己的项目。您必须指定要用于替换默认 com.adobe.flascc 命名空间的命名空间，这允许您将多个 FlasCC 生成的 SWC 链接到一个项目中。

请注意，您需要为您的 AS3 代码编写某种 shim layer api，或者您可以使用 SWIG 将其自动化。

# youtube-api - youtube api 与常规搜索查询的区别？

> ID：13690292
> 
> 赞同：0
> 
> 时间：2012-12-03T19:30:06.853
> 
> 标签：youtube-api

我不明白通过常规 youtube 搜索与通过 api 执行的搜索返回的差异。

这是我的示例查询：[http](http://gdata.youtube.com/feeds/api/videos?q=Alien) ://gdata.youtube.com/feeds/api/videos? q=Alien Moons the universe&max-results=25&v=2&duration=long

youtube 常规搜索的第一个结果就是我正在寻找的内容（Alien Moons Documentary，长度为 44:28）。API 查询的结果中显示了相同的视频，但顺序不同 - 就像结果列表的一半。

API 不应该允许轻松访问常规搜索吗？我什至尝试添加 &orderby=relevance 标签，但没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:48:20.003

我们不保证网站和 API 将始终以相同的顺序返回结果，不。

话虽如此，我看到视频 id`8Jucta-ZwxY`作为 Web 和 API 搜索的第一个结果返回。您可能会遇到一些特定于区域的自定义或其他问题——同样，结果不一定匹配。

# java - 从 JList 中检索表值

> ID：13690294
> 
> 赞同：2
> 
> 时间：2012-12-03T19:30:15.800
> 
> 标签：java, data-binding, netbeans, jlist

（NetBeans 7.2.1）

我创建了一个`JList` `Employees_List`并将其绑定如下：

```
Bind elements:
    Binding source = tblEmployeesList
    Binding Expression = null
    Display Expression = ${empLName}, ${empFName} ${empMName}
Bind selectedElement:
    Binding source = tblEmployeesList
    Binding Expression = ${EmpID} 
```

选择列表中的项目时，如何`EmpID`从表中检索 的值`tblEmployeesList`？（我不希望`EmpID`显示在列表中。）

我尝试了以下操作：

```
String strEmpID;
strEmpID = Employees_List.getSelectedValue().toString(); 
```

它返回列表框中的选定值。但是，我需要获取`EmpID`绑定到 selectedElement 的那个。我发现没有类似`.getselectedElement`的列表。

# java - 编译 Android 应用程序时出现错误

> ID：13690298
> 
> 赞同：3
> 
> 时间：2012-12-03T19:30:30.703
> 
> 标签：java, android

我正在尝试编译一个月前曾经工作过的代码，但由于某种原因，我在 Eclipse 中再次启动了它，现在我收到了这些奇怪的错误。我正在制作一个应用程序，它接收加速度计数据并以带有图形的可视格式显示它，这样就可以了。由于我觉得 eclipse 不与我合作，这变得相当头疼。

```
12-03 14:17:30.046: E/AndroidRuntime(368): FATAL EXCEPTION: main
12-03 14:17:30.046: E/AndroidRuntime(368): java.lang.VerifyError:     com.example.test.Activity2
12-03 14:17:30.046: E/AndroidRuntime(368):  at java.lang.Class.newInstanceImpl(Native Method)
    12-03 14:17:30.046: E/AndroidRuntime(368):  at java.lang.Class.newInstance(Class.java:1409)
    12-03 14:17:30.046: E/AndroidRuntime(368):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
    12-03 14:17:30.046: E/AndroidRuntime(368):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1561)
    12-03 14:17:30.046: E/AndroidRuntime(368):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
    12-03 14:17:30.046: E/AndroidRuntime(368):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
    12-03 14:17:30.046: E/AndroidRuntime(368):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
    12-03 14:17:30.046: E/AndroidRuntime(368):  at android.os.Handler.dispatchMessage(Handler.java:99)
    12-03 14:17:30.046: E/AndroidRuntime(368):  at android.os.Looper.loop(Looper.java:123)
    12-03 14:17:30.046: E/AndroidRuntime(368):  at android.app.ActivityThread.main(ActivityThread.java:3683)
    12-03 14:17:30.046: E/AndroidRuntime(368):  at java.lang.reflect.Method.invokeNative(Native Method)
    12-03 14:17:30.046: E/AndroidRuntime(368):  at java.lang.reflect.Method.invoke(Method.java:507)
    12-03 14:17:30.046: E/AndroidRuntime(368):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
    12-03 14:17:30.046: E/AndroidRuntime(368):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
    12-03 14:17:30.046: E/AndroidRuntime(368):  at dalvik.system.NativeStart.main(Native Method)

package com.example.test;

import java.util.Date;

import org.achartengine.ChartFactory;
import org.achartengine.GraphicalView;
import org.achartengine.chart.PointStyle;
import org.achartengine.model.TimeSeries;
import org.achartengine.model.XYMultipleSeriesDataset;
import org.achartengine.renderer.XYMultipleSeriesRenderer;
import org.achartengine.renderer.XYSeriesRenderer;

import android.app.Activity;
import android.graphics.Color;
import android.hardware.Sensor;
import android.hardware.SensorEvent;
import android.hardware.SensorEventListener;
import android.hardware.SensorManager;
import android.os.Bundle;

public class Activity2 extends Activity implements SensorEventListener{

private static TimeSeries[] timeSeries;
private static XYMultipleSeriesDataset dataset;
private static XYMultipleSeriesRenderer renderer;
private static XYSeriesRenderer rendererSeries;
private static GraphicalView view;
private static Thread mThread;
private SensorManager sensorManager;
float x;
float y;
float z;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);     

   // generateCsvFile("Example1.csv");

    sensorManager=(SensorManager)getSystemService(SENSOR_SERVICE);
    sensorManager.registerListener(this,
            sensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER),
            SensorManager.SENSOR_DELAY_NORMAL);

    dataset = new XYMultipleSeriesDataset();

    renderer = new XYMultipleSeriesRenderer();
    renderer.setAxesColor(Color.BLUE);
    renderer.setAxisTitleTextSize(16);
    renderer.setChartTitle("Time");
    renderer.setChartTitleTextSize(15);
    renderer.setFitLegend(true);
    renderer.setGridColor(Color.LTGRAY);
    renderer.setPanEnabled(false, false);
    renderer.setPointSize((float)0.25);
    renderer.setXTitle("Time");
    renderer.setYTitle("XYZ");
    renderer.setMargins( new int []{20, 30, 15, 0});
    renderer.setZoomButtonsVisible(false);
    renderer.setBarSpacing(4);
    renderer.setShowGrid(true);

    rendererSeries = new XYSeriesRenderer();
    rendererSeries.setColor(Color.RED);
    rendererSeries.setFillPoints(true);
    rendererSeries.setPointStyle(PointStyle.CIRCLE);
    renderer.addSeriesRenderer(rendererSeries);
    rendererSeries = new XYSeriesRenderer();
    rendererSeries.setColor(Color.BLUE);
    rendererSeries.setFillPoints(true);
    rendererSeries.setPointStyle(PointStyle.CIRCLE);
    renderer.addSeriesRenderer(rendererSeries);
    rendererSeries = new XYSeriesRenderer();
    rendererSeries.setColor(Color.GREEN);
    rendererSeries.setFillPoints(true);
    rendererSeries.setPointStyle(PointStyle.CIRCLE);
    renderer.addSeriesRenderer(rendererSeries);

    timeSeries = new TimeSeries[3];
    timeSeries[0] = new TimeSeries("Random 0");
    timeSeries[1] = new TimeSeries("Random 1");
    timeSeries[2] = new TimeSeries("Random 2");
    timeSeries[0].add(new Date(), x);
    timeSeries[1].add(new Date(), y);
    timeSeries[2].add(new Date(), z);

}
/*private static void generateCsvFile(String sFileName)
{
    try
    {
        File root = Environment.getExternalStorageDirectory();
        File gpxfile = new File(root, sFileName);
        FileWriter writer = new FileWriter(gpxfile);

        writer.append("Emp_Name");
        writer.append(',');
        writer.append("Adress");
        writer.append('\n');

        writer.append("hussain");
        writer.append(',');
        writer.append("Delhi");
        writer.append('\n');

        //generate whatever data you want

        writer.flush();
        writer.close();
    }
    catch(IOException e)
    {
        e.printStackTrace();
    } 
 }
 */
public void onAccuracyChanged(Sensor sensor,int accuracy){

}

public void onSensorChanged(SensorEvent event){

    // check sensor type
    if(event.sensor.getType()==Sensor.TYPE_ACCELEROMETER){

        // assign directions
        x=event.values[0];
        y=event.values[1];
        z=event.values[2];
    }
}

@Override
protected void onStart() {
    super.onStart();
    dataset.addSeries(timeSeries[0]);
    dataset.addSeries(timeSeries[1]);
    dataset.addSeries(timeSeries[2]);
    view = ChartFactory.getTimeChartView(this, dataset, renderer, "Test");
    view.refreshDrawableState();
    view.repaint();
    setContentView(view);
    mThread = new Thread(){
        public void run(){
            while(true){
            try {
                Thread.sleep(300L);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
                timeSeries[0].add(new Date(), x);
                timeSeries[1].add(new Date(), y);
                timeSeries[2].add(new Date(), z);
                view.repaint();
            }
        }
    };
    mThread.start();
} 
```

}

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.test"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<application
    android:debuggable="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".Activity2"
        android:label="@string/title_activity_activity2" >
        <meta-data
            android:name="android.support.PARENT_ACTIVITY"
            android:value="com.example.test.MainActivity" />
    </activity>
</application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:48:24.607

尝试使用

*   Android 工具 -> 修复项目属性

如果不能解决问题，请尝试

*   项目 -> 清理

我已经在我的设备上运行了您的 Activity，它可以正常工作。

# android - 脸书排行榜

> ID：13690300
> 
> 赞同：0
> 
> 时间：2012-12-03T19:30:44.957
> 
> 标签：android, facebook, facebook-graph-api, leaderboard

我想知道是否有人有任何有用的指南来在 Android 游戏中实现 Facebook 分数。我目前正在游戏中构建个人资料，但 Facebook SDK 和 Graph API 中有很多我不知道如何使用的功能。

有人熟悉发布分数和检索 Facebook 朋友的排行榜吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T22:33:03.973

您可以制作自己的排行榜 - 将分数存储在您的数据库中，计算排名等，并使用标准的开放图形操作发布到用户墙。

或者，您可以使用 Facebooks [scores API](http://developers.facebook.com/docs/scores/)为您处理很多此类问题，但它确实有其局限性。您还可以使用[成就 API](https://developers.facebook.com/docs/achievements/)，它允许您将流故事发布到用户时间线，例如“乔刚刚解锁了星徽”。

最后，您可以使用第三方工具，例如[Leaderboarded](http://www.leaderboarded.com/home/product/data/)，尽管我不确定这与您的游戏有多大的相关性。

至于有用的指南 - 我发现提供朋友排行榜而不是全球排行榜更好/更相关，因为这些通常对用户来说更有趣。

# http - HTTP 服务器可以响应 404 来隐藏资源的存在吗？

> ID：13690305
> 
> 赞同：1
> 
> 时间：2012-12-03T19:31:20.487
> 
> 标签：http, http-status-code-404

在某些情况下，应该告诉无权访问资源的客户端它不存在，而不是被告知他们没有被授权。如果服务器这样做，在技术上是否违反了 HTTP 1.1？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T10:13:35.220

RFC 中没有任何内容强制您每次都告诉客户真相。

最后，它归结为您希望浏览器背后的人如何对某个响应做出反应。如果您发送一个`403 Forbidden`用户会知道他们可能无法访问此资源（并且不会自动打开任何身份验证窗口）。如果你改为发送一个`404 Not Found`，他们可能会认为服务器操作员（你）犯了一个错误。

你的选择。

# c++ - 不推荐从字符串文字到 char* 的转换

> ID：13690306
> 
> 赞同：30
> 
> 时间：2012-12-03T19:31:30.187
> 
> 标签：c++, string, char

我在我的代码中不断收到错误“从字符串文字转换为 char* 已弃用”。代码的目的是使用一个指向指针的指针来为 string1 和 string2 分配一个单词，然后将其打印出来。我怎样才能解决这个问题？

这是我的代码：

```
#include <iostream>
using namespace std;

struct WORDBLOCK
{
    char* string1;
    char* string2;
};

void f3()
{
    WORDBLOCK word;

    word.string1 = "Test1";
    word.string2 = "Test2";

    char *test1 = word.string1;
    char *test2 = word.string2;

    char** teststrings;

    teststrings = &test1;
    *teststrings = test2;

    cout << "The first string is: "
         << teststrings
         << " and your second string is: "
         << *teststrings
         << endl;  
} 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-12-03T20:02:51.797

C++ 字符串文字是*const* `char`的数组，这意味着您不能合法地修改它们。

如果您想安全地将字符串文字分配给指针（这涉及到隐式数组到指针的转换），您需要将目标指针声明为`const char*`，而不仅仅是声明为`char*`。

这是您的代码的一个版本，可以在没有警告的情况下编译：

```
#include <iostream>

using namespace std;

struct WORDBLOCK
{
    const char* string1;
    const char* string2;
};

void f3()
{
    WORDBLOCK word;

    word.string1 = "Test1";
    word.string2 = "Test2";

    const char *test1 = word.string1;
    const char *test2 = word.string2;

    const char** teststrings;

    teststrings = &test1;
    *teststrings = test2;

    cout << "The first string is: "
         << teststrings
         << " and your second string is: "
         << *teststrings
         << endl;
} 
```

考虑一下如果语言*没有*施加这个限制会发生什么：

```
#include <iostream>
int main() {
    char *ptr = "some literal";  // This is invalid
    *ptr = 'S';
    std::cout << ptr << "\n";
} 
```

A（非`const`）`char*`允许您修改指针指向的数据。如果您可以将字符串文字（隐式转换为指向字符串第一个字符的指针）分配给 plain `char*`，您将能够使用该指针来修改字符串文字，而不会来自编译器的警告。上面的无效代码，*如果有效*，将打印

```
Some literal 
```

- 它实际上可能在某些系统上这样做。但是，在我的系统上，它因分段错误而死，因为它尝试写入只读内存（不是物理 ROM，而是被操作系统标记为只读的内存）。

（顺便说一句：C 对字符串文字的规则与 C++ 的规则不同。在 C 中，字符串文字是 的数组`char`，*而不是*-- 但尝试修改它的数组`const char`具有未定义的行为。这意味着在 C 中您可以合法地编写`char *s = "hello"; s[0] = 'H';`, 并且编译器不一定会抱怨——但是当你运行它时程序很可能会因为分段错误而死掉。这样做是为了保持与在`const`引入关键字之前编写的 C 代码的向后兼容性。C++`const`从一开始就具有，因此不需要这种特殊的妥协。）

# multithreading - TLS 变量查找速度

> ID：13690307
> 
> 赞同：3
> 
> 时间：2012-12-03T19:31:30.957
> 
> 标签：multithreading, compiler-construction, linker, x86, loader

考虑以下程序：

```
#include <pthread.h>

static int final_value = 0;

#ifdef TLS_VAR
static int __thread tls_var;
#else
static int tls_var;
#endif

void  __attribute__ ((noinline)) modify_tls(void) {
  tls_var++;
}

void *thread_function(void *unused) {
  const int iteration_count = 1 << 25;

  tls_var = 0;
  for (int i = 0; i < iteration_count; i++) {
    modify_tls();
  }
  final_value += tls_var;
  return NULL;
}

int main() {
  const int thread_count = 1 << 7;

  pthread_t thread_ids[thread_count];
  for (int i = 0; i < thread_count; i++) {
    pthread_create(&thread_ids[i], NULL, thread_function, NULL);
  }

  for (int i = 0; i < thread_count; i++) {
    pthread_join(thread_ids[i], NULL);
  }

  return 0;
} 
```

在我的 i7 上，执行定义需要 1.308 秒，`TLS_VAR`未定义执行需要 8.392 秒；我无法解释如此巨大的差异。

的组件`modify_tls`看起来像这样（我只提到了不同的部分）：

```
;; !defined(TLS_VAR)
movl tls_var(%rip), %eax
addl $1, %eax
movl %eax, tls_var(%rip)

;; defined(TLS_VAR)
movl %fs:tls_var@tpoff, %eax
addl $1, %eax
movl %eax, %fs:tls_var@tpoff 
```

TLS 查找是可以理解的，有来自 TCB 的负载。但是为什么`tls_var`第一种情况下的负载相对于`%rip`？为什么它不能是由加载器重定位的直接内存地址？这种`%rip`相对负载是造成缓慢的原因吗？如果是这样，为什么？

编译标志：`gcc -O3 -std=c99 -Wall -Werror -lpthread`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:02:50.203

没有`__thread`属性`tls_var`只是一个共享变量。每当一个线程写入它时，写入首先会进入线程执行的核心缓存。但是由于它是一个共享变量并且 x86 机器是缓存一致的，因此其他内核的缓存会失效，并且它们的内容会从最后一级缓存或主内存中刷新（在你的情况下很可能来自最后一级缓存，这是 Core i7 上的共享 L3 缓存）。请注意，虽然比主内存快，但最后一级缓存并不是无限快的——它仍然需要很多周期才能将数据从那里移动到每个内核私有的 L2 和 L1 缓存。

使用该`__thread`属性，每个线程都有自己的副本`tls_var`，位于线程本地存储中。由于这些线程本地存储在内存中彼此相距很远，因此在修改它们时不涉及缓存一致性消息，并且数据保留在最快的 L1 缓存中。

`RIP`-related 寻址（System V ABI 推荐的用于“近”数据的 x64 默认寻址模式）通常会导致更快的数据访问，但缓存一致性开销如此巨大，以至于当所有内容都保存在中时，较慢的 TLS 访问实际上更快一级缓存。

这个问题在 NUMA 系统上被大大放大，例如在多处理器（后）Nehalem 或 AMD64 板上。不仅保持缓存一致的成本要高得多，而且共享变量将驻留在内存中，连接到套接字，第一次“接触”该变量的线程所在的位置。然后，在来自其他套接字的内核上运行的线程必须通过连接套接字的 QPI 或 HT 总线执行远程内存访问。正如一位客座教授最近所说（粗略的解释）：“对共享内存系统进行编程，就好像它们是分布式内存系统一样。” 这涉及制作全局数据的本地副本以进行处理——这正是该`__thread`属性所实现的。

另请注意，无论`tls_var`是否在 TLS 中，您都应该期待不同的结果。由于它在 TLS 中，一个线程所做的修改对其他线程*不可见*。由于它是一个共享变量，因此您必须确保在给定时间只有一个线程可以访问它。这通常通过关键部分或锁定添加来实现。

# codeigniter - 如何使用 CodeIgniter 中的 Active Record 类从多个表中获取数据

> ID：13690310
> 
> 赞同：0
> 
> 时间：2012-12-03T19:31:50.583
> 
> 标签：codeigniter, activerecord

我正在尝试学习如何从多个表中提取数据并将它们放入一个变量中并将它们返回给我的控制器。

我可以从一个表中获取信息，如下所示：

```
 $this->db->select('first_name, last_name');
            $this->db->from('people');
            $this->db->where('first_name', $firstname);
            $this->db->where('last_name', $lastname);
            $result = $this->db->get(); 
```

但我很困惑如何从另一个表中获取数据并将它们与保存更多用户输入的其他变量相匹配。

我已经阅读了 CI 网站上的 Active Record 文档，但我发现唯一可能是我正在寻找的是 join() 查询，但我不知道如何使用它，示例没有帮助在网站上，因为我不明白这一点：

```
$this->db->join('comments', 'comments.id = blogs.id'); 
```

“评论”是否意味着表格“评论”？如果您将变量与comments.id 进行比较，您是否必须将变量包括在单引号之外，如下所示：`'comments.id =' $blogid`？

或者我可以这样做：从一个表中查询并将这些结果放入一个变量中，如下所示：

```
$result1 = $this->db->get(); 
```

然后再次从另一个表中进行另一个查询并将其放入

```
$result2 
```

那我可以说：`$query = $result1 + $result2;`

那可能吗？

如果有人可以请确认此信息/帮助我，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T20:17:40.520

如果您在使用活动记录连接时遇到问题，您可以通过这种方式简单地使用 MySQL 查询：

```
$query_str = "SELECT user.*,role.*  FROM user ,role  where role.id = user.role_id and  user.username = ? AND user.password = ?";
$result = $this->db->query($query_str,array($username,$password)); 
```

您的代码： `$this->db->join('comments', 'comments.id = blogs.id');`表示从评论表 ID 等于博客表 ID 的评论和博客表中获取数据。

我上述查询的活动记录也将是：

```
 $this->db->select('user.*,role.*')
  $this->db->from('user');
  $this->db->where('user.username', $username);
  $this->db->where('user.password', $password);
  $this->db->join('role','role.id = user.role_id')
  $result = $this->db->get(); 
```

您需要确保两个表都是相关的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-02T11:16:09.807

我有另一种方法来实现它，

```
$this->db->select('a.*,b.course_name');
$this->db->from('fees_master a,course_master b');
$this->db->where('a.course_id = b.course_id',NULL,FALSE);
$query = $this->db->get();
return $query->result_array(); 
```

我尝试了这个并且它有效，我希望这可以帮助某人。

# python - 从给定模块中腌制所有对象的函数

> ID：13690314
> 
> 赞同：1
> 
> 时间：2012-12-03T19:32:14.837
> 
> 标签：python, namespaces, scope, ipython, pickle

我想编写一个函数来腌制当前命名空间中的所有对象，这些对象是给定模块中类的实例。这个想法是，在 ipython 会话期间，用户从 中创建许多对象`mymodule`，并且可能需要快速保存所有对象。

所以，例如我想要这样的东西

```
from mymodule import cat, dog, pickle_all
c= cat(), d=dog()
pickle_all('killer_sesh.p') 
```

结束会话，忘记一个月，回来开始新的会话，

```
from mymodule import upickle_all 
objs = unpickle_all('killer_sesh.p') 
```

所以我的第一次尝试（如下所示）在粘贴到当前命名空间时有效。如果我定义为一个函数，或者把它放在其他地方，比如在 mymodule 中，那么该`dir()`命令不会返回当前命名空间，而是返回函数看到的命名空间。即使我将 dir() 的结果作为参数传递，对象在函数中也不可用。

```
import pickle
filename= 'killer_sesh.p'
module='mymodule'
module_objects = {}
for k in dir():
    try:
        if eval(k).__module__.split('.')[0] == module:
            if k[0]!='_':
                print(k)
                module_objects[k] = eval(k)
    except(AttributeError):
        pass
    file= open(filename,'w')
pickle.dump(module_objects, file)
file.close() 
```

这样的功能可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:24:07.533

> 如果我定义为一个函数，或者把它放在其他地方，比如在 mymodule 中，那么 dir() 命令不会返回当前命名空间，而是返回函数所看到的命名空间。即使我将 dir() 的结果作为参数传递，对象在函数中也不可用。

对，那是因为您正在使用`eval`来评估它们，它在当前命名空间中评估它们。您*可以*从不同的主空间传递`globals`and ，并使用这些参数进行调用。换句话说，不是, foo(dir(), globals(), locals())`。`locals``eval``foo(dir())`

然而，这整个设计是一个坏主意。用于`eval`获取范围的成员是一个坏主意。事实上，`eval`用于几乎*任何事情*都是一个坏主意。

A much better solution is to pass the thing you want to evaluate the members of, and use [`getattr`](http://docs.python.org/3/library/functions.html#getattr) to get them.

And an even better solution is to avoid using `dir` and then figuring out how to get the attributes with those names; if you want to inspect things, that's what the [inspect](http://docs.python.org/3/library/inspect.html) module is for. (And even when you want to do something that `inspect` doesn't quite offer, reading its source code—which is linked from the docs—will usually tell you the best way to do it.)

# iphone - 在 iOS 中它们自己的窗口中的模态视图

> ID：13690322
> 
> 赞同：0
> 
> 时间：2012-12-03T19:32:50.793
> 
> 标签：iphone, ios, window, modal-view

我想这是一个简单的答案。当我调用要在模态视图中呈现的视图控制器时，它是驻留在自己的窗口层中还是只是在呈现视图控制器之上的动画视图？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:33:44.257

找出你自己；）

```
NSLog(@"%@", [myModalView recursiveDescription]); 
```

# html - 我正在尝试使用背景颜色的右上角边框图像

> ID：13690324
> 
> 赞同：1
> 
> 时间：2012-12-03T19:33:04.203
> 
> 标签：html, css, background-image

因此，我有几个位置背景图像和背景颜色，并且图像具有透明边缘，我想知道是否可以从图像透明的位置消除背景颜色。

我目前得到这个[Image](http://bit.ly/SBUuRg)。

并想得到这样的东西[Image](http://bit.ly/SHbaFF)。

PS 很抱歉只是将图片作为链接发布，但在发布此帖子时，我不允许实际发布图片。

网页：desertednoir.uhostfull.com

相关代码：

```
#content {
    padding: 1.5%;
    float: left;
    width: 73%;
    text-align: center;
    z-index: 1;
    color: Silver;
    border: 1px solid black;
    background: url("/images/e_bl.png") no-repeat left bottom,
    url("/images/e_tr.png") no-repeat right top,
    url("/images/e_tc.png") no-repeat center top,
    url("/images/e_br.png") no-repeat right bottom,
    #3C3C3C;
} 
```

<div id="content">内容资料</div>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:06:12.907

仅 HTML 和 CSS 不足以编辑图像以添加或删除透明像素。但是，除非您告诉他们，否则他们也不会**添加颜色。**只要确保您的元素上**没有**指定`background-color`，它将保持透明。

我已将您的示例代码放入[http://jsfiddle.net/XQumV/](http://jsfiddle.net/XQumV/)。如您所见，如果您`, #3C3C3C`从规则的末尾删除`background`，那么您的元素是透明的。

因为 HTML 中的元素本质上是矩形的，所以它们的背景颜色也总是矩形的。不要使用`background-image`to 获取复杂的背景图像，而是尝试使用`border-image`. 有关详细信息，请参阅[https://developer.mozilla.org/en-US/docs/CSS/border-image](https://developer.mozilla.org/en-US/docs/CSS/border-image)。

# php - javascript或php数组的交集和差法

> ID：13690326
> 
> 赞同：0
> 
> 时间：2012-12-03T19:33:09.017
> 
> 标签：php, javascript

我正在寻找一个无错误的代码，通过比较两个数组来获得不变、添加和删除的项目数组。

![在此处输入图像描述](../Images/0ba4075154344903a31d1ad46155069c.png)

有没有使用单一方法获得三个数组的有效方法？

php 或 javascript 都可以使用

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T19:38:43.427

PHP 拥有丰富的数组特性，你所需要的只是`array_diff`和`array_intersect`

```
$i = array("k1","k2","k3","k4","k5");
$l = array("k1","k3","k5","k6");

// Removed
$r = array_diff($i, $l);

// Unchanged
$u = array_intersect($i, $l);

// Added
$a = array_diff($l, $i);

var_dump($r, $u, $a); 
```

输出

```
array (size=2)
  1 => string 'k2' (length=2)
  3 => string 'k4' (length=2)
array (size=3)
  0 => string 'k1' (length=2)
  2 => string 'k3' (length=2)
  4 => string 'k5' (length=2)
array (size=1)
  3 => string 'k6' (length=2) 
```

您可以创建自己的功能

```
function getSet($l, $r) {
    return array("diff" => array_diff($l, $r),"unchanged" => array_intersect($l, $r),"added" => array_diff($r, $l));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:40:35.823

使用 PHP，您可能会使用 array_diff 和 array_intersect，因此在定义它们时使用 I 和 L：

```
$added = array_diff(L,I);
$removed = array_diff(I,L);
$unchanged = array_intersect(I,L); 
```

您可以根据需要将其打包在一个函数中。

# c# - 接口的内存分配

> ID：13690327
> 
> 赞同：4
> 
> 时间：2012-12-03T19:33:13.383
> 
> 标签：c#, memory-management

我知道接口不能被实例化，但是如果我们将它分配给一个对象，谁能解释一下内存是如何分配给它的。例如：

```
ITest obj = (ITest) new TestClass1();  //TestClass1 is a class which implements ITest
obj.MethodsDefinedInInterface(); 
```

ITest 是否转换为对象以保存 TestClass1 的属性和方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T19:54:13.920

我不确定您所说的“分配”到底是什么意思。以下语句进行了两个单独的“分配”：

```
TestClass1 test = new TestClass1(); 
```

首先是`new TestClass1()`在堆上分配 sizeof(TestClass1) 的语句。二、堆分配地址的赋值存储在变量`test`中，在栈上分配为sizeof(object *)（即IntPtr.Size，根据硬件+OS+软件运行情况为32/64位） .

以下语句在“分配”中完全相同：

```
ITest test = new TestClass1(); 
```

两者之间的唯一区别是可在变量上调用的方法`test`。

注意：这不适用于实现接口的结构。接口*必须*是引用类型，如您所知，结构不是。这在 .NET 中称为*装箱*，并允许通过首先将结构的副本放在堆上来引用结构，就好像它是引用类型一样。

所以我们现在重新评估这个语句：

```
TestSTRUCT1 test2 = new TestSTRUCT1(); 
```

这在命名变量的堆栈上“分配” sizeof(TestSTRUCT1) `test2`。（不确定分配的影响是什么`new TestSTRUCT1()`，它可能会创建一个额外的堆栈副本，但应在分配后立即删除。

如果我们然后将此值分配给接口：

```
ITest test3 = test2; 
```

我们现在又进行了两次分配。首先将结构复制到堆中。然后该堆驻留结构的地址被放置在一个新的“分配”变量`test3`中（在堆栈上）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T19:37:42.087

它应该类似于：

```
TestClass1 test = new TestClass1();  
ITest obj = (ITest) test;
obj.MethodsDefinedInInterface(); 
```

我认为，这回答了你的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T19:59:13.800

因此，首先，当您进入此方法时，将在堆栈上为所有参数分配空间（如果适用），返回值（如果适用）以及该方法的所有局部变量。对于我们在这里展示的内容，唯一需要分配的局部变量是`obj`. `obj`是一个接口，因此需要足够的空间用于单个引用（3​​2 位系统上为 32 位，64 位系统上为 64 位）。由于没有其他局部变量、返回值或参数，我们将只占用堆栈上的那个单词。

因为我们正在分配单个对象 ( `new TestClass1()`) 并假设该对象是一个类（而不是 a `struct`，因为命名 a`struct` `TestClass1`会非常卑鄙）将在堆上分配足够的空间来解释`TestClass`. 该空间将足以容纳每个字段（无论可访问性如何），再加上一些额外的对象开销。对这个新分配的对象的引用将进入为我们的局部变量分配的堆栈中的位置。

这都忽略了处理器在运行时使用的寄存器；由于编译器、抖动、操作系统、处理器硬件等的复杂转换和优化。我无法开始尝试预测会发生什么。幸运的是，由于所有这些抽象，我真的不需要关心。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T19:37:08.920

像任何其他对象一样为实现接口的对象分配内存。它是否暗示一个接口只是对象的一个​​属性

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-03T19:37:13.440

仅`TestClass1`例如分配内存。接口`ITest`只是一种引用类型，它指向分配的内存。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-03T19:38:18.700

> ITest 是否转换为对象以保存 TestClass1 的属性和方法

ITest 是一种类型。TestClass1 属性和方法仍然存在，只是您无法通过 obj 变量访问它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-03T19:38:23.600

它非常简单。您为 TestClass1 分配，然后将其转换回接口。请注意，您不是在实例化一个接口，而是在实例化一个实现该接口的类，然后调用在具体类中实现（强制）的接口方法！

另一种说法是：

```
TestClass1 test = new TestClass1();
ITest obj = (ITest) test;
obj.MethodsDefinedInInterface(); 
```

请注意，分配的区域是为 TestClass1！它不会因为演员而增长或缩小！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-12-03T19:38:40.017

`interfaces`只需确保对象在编译时在技术上和逻辑上都满足某些标准。

当执行代码并使用接口时，内存将被分配，就好像你只是使用类来实例化对象一样。

所以两者之间没有区别（就内存分配而言）

```
ITest obj = (ITest) new TestClass1();  //TestClass1 is a class which implements ITest
obj.MethodsDefinedInInterface(); 
```

和

```
TestClass1 obj = new TestClass1();  //TestClass1 is a class which implements ITest
obj.MethodsDefinedInInterface(); 
```

# node.js - Node.Js/ Express - 输出响应前几个字符的简单中间件

> ID：13690335
> 
> 赞同：4
> 
> 时间：2012-12-03T19:33:43.417
> 
> 标签：node.js, express, response, middleware

对于日志记录/调试，我想在响应发送到浏览器之前输出前一百个字符左右。我可以用中间件和响应对象做一些简单的事情吗？

理想情况下，它类似于：

```
app.use(function(req, res, next) {
    console.log('Response snippet: '+((res.body || '').substr(0,100)));
    next();
}); 
```

除了响应没有正文，我无法弄清楚当前要发回的正文在哪里传递。

**更新：**

彼得的回答奏效了，我想我会把我的中间件代码放在这里，以节省未来的观众点击：

```
App.use(function(req, res, next) {
    var end = res.end;
    res.end = function(chunk, encoding){
        res.end = end;
        if (chunk) {
            console.log(chunk);
        }
        res.end(chunk, encoding);
    };
    next();
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T05:38:24.713

因此，您需要挂钩响应输出 API，这在中间件中并不像挂钩请求处理那么简单。最好的例子是[connect 的内置记录器中间件](https://github.com/geta6/connect-logger/blob/master/lib/logger.js#L33-L47)。它基本上是猴子修补`req.end`方法并将数据转发到它的流，然后继续调用真正的`req.end`函数。您需要遵循这种模式，它应该适用于非流式响应。

该模式最终可能只会给您最后一块数据（对于流式响应的情况）。如果是这样，你只需要猴子补丁`res.write`而不是`res.end`你就可以访问第一个块。`res.write`一旦你记录了第一个块，只需 un-monkey-patch即可。

# python - 用于调用另一个 Python 脚本的 Python 子进程

> ID：13690336
> 
> 赞同：0
> 
> 时间：2012-12-03T19:33:44.843
> 
> 标签：python, python-3.x, subprocess

我有几个包含脚本的数据文件夹`ExportScriptGen.py`，我想要一个可以遍历目录结构并`ExportScriptGen.py`在找到它的每个文件夹中运行的脚本。这是我到目前为止所拥有的：

```
import sys
import os
import os.path
import subprocess

script = "ExportScriptGen.py"

if len(sys.argv) > 1:
    top = sys.argv[1]
else:
    top = os.path.realpath(".")

for root, dirs, files in os.walk(top):
    if (script in files):
        subprocess.call(os.path.join(root,script), shell=True) 
```

`ExportScriptGen.py`在另一个文件夹中生成脚本（并经过测试）。当我小规模测试我的主脚本时（即一个`ExportScriptGen.py`没有子目录的文件夹），一切正常。但是，当我在我的全面问题（有大量目录/子目录）上运行它时，不会产生任何输出`ExportScriptGen.py`。为什么会这样？我在 Windows 7 上运行 Python 3.2。

这是`ExportScriptGen.py`：

```
import sys
import os.path
import os

### Declarations ###

script_check_dir = # directory to place scripts in
layout_name = # parameter to write into top of script
template_name = # template for script
out_script_tail = # string to add at end of output script file

### Code ###

if len(sys.argv) > 1:
    folder = sys.argv[1]
else:
    folder = os.path.dirname(os.path.realpath(__file__))

data_files = filter(os.path.isfile, os.listdir(folder))
data_files = [f for f in data_files if ("." in f) and os.path.splitext(f)[1][1].isdigit()]

for dfile in data_files:
    out_script_name = os.path.join(script_check_dir, dfile+out_script_tail)
    out_script = open(out_script_name, 'w')

    out_script.write("folder = \"{}\\\"\n".format(folder))
    out_script.write("layout = folder + \"{}\"\n".format(layout_name))
    out_script.write("dataFile = folder + \"{}\"\n".format(dfile))

    template = open(os.path.join(folder, template_name), 'r')
    for line in template:
        out_script.write(line)

    out_script.close() 
```

# javascript - 尝试使用等效的输入名称属性值来定位属性名称

> ID：13690337
> 
> 赞同：1
> 
> 时间：2012-12-03T19:33:44.150
> 
> 标签：javascript, jquery, raphael

我正在使用由 Raphael 构建的 svg，并使用表单使其部分可编辑。

我有类似于以下的路径变量：

```
uk.isle_of_man
uk.republic_of_ireland
uk.england 
```

和输入字段，如：

```
<input id="england-form" type="text" name="england"> 
```

我正在使用以下代码根据选择的输入字段更新填充。它对 id 工作正常，但我正在做一些愚蠢的事情`var b = $(this).attr("name");`并试图用它来定位变量属性。这是代码：

```
$('#form').find('input').focus(function(){
var a = $(this).attr("id");
var b = $(this).attr("name");

$('#'+a).live('change', (function() {
    var value = $(this).val();
    uk.(b).color = (value);
})); 
```

我的意图是`uk.(b).color`to 等同于`uk.england.color`. 知道我做错了什么吗？如果我使用这种`uk.england`格式，一切都很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:37:02.567

当你使用`.`它时，它会搜索一个名为`b`inside的属性`uk`。
要搜索变量值，您必须使用`[]`.

所以，如果我有以下对象。

```
var 'uk' = {
    'england': {
        color: 'green'
    },
    'b': {
        color: 'wrong'
    }
}; 
```

当我使用`uk.(b).color`. 我明白了`'wrong'`。
得到`'green'`使用`uk[b].color`。

# java - 如何使用 Swing 暂停 Java 模拟

> ID：13690339
> 
> 赞同：1
> 
> 时间：2012-12-03T19:33:49.920
> 
> 标签：java, multithreading, swing, simulation

好的，我正在运行模拟。我已经在我的模拟 GUI 上实现了两个 JButton，它们是 actionListeners。我想要的是让整个模拟在我按下暂停按钮时暂停，如果我按下恢复按钮则恢复。

有多个线程正在运行，我尝试获取每个线程并在单击暂停按钮时调用它们的 wait() 方法，但我没有成功。

因此，我需要一些关于如何做到这一点的建议。我将 Swing 用于 GUI，监听器工作正常。我确实尝试在 View 类（使用 MVC 模式）的当前线程上调用 sleep() 和 wait() 只是为了看看发生了什么，但这会导致整个应用程序崩溃。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:45:08.937

您需要为模拟线程提供额外的逻辑，该逻辑将接受来自控制（GUI）线程的“信号”并等待下一个控制信号恢复执行。

例如，您可以`volatile boolean isPaused`在模拟线程中使用实例字段。将其设置为 true/false 以暂停/恢复模拟线程。在仿真线程中实现相应的逻辑：

```
public void run() {
    while (true) {
        simulate();
        while (isPaused) {
            Thread.sleep(100);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T02:08:01.577

如果动画使用 Swing [`Timer`](http://docs.oracle.com/javase/7/docs/api/javax/swing/Timer.html)，简单的答案是调用[`stop()`](http://docs.oracle.com/javase/7/docs/api/javax/swing/Timer.html#stop%28%29).

我强烈建议使用`Timer`for 动画，因为它可以确保在 EDT 上执行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T19:40:06.400

我认为您可以创建一个`ThreadGroup`来存储所有线程，然后尝试使用

`ThreadGroup threadGroup = Thread.currentThread( ).getThreadGroup( );`

顺便说一句，`ExecutorService`也是一个不错的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T19:46:31.213

使用共享对象在两个类之间进行通信。然后让您的 gui 在单击按钮时设置状态对象的值，并在再次单击按钮时再次更改它。这是一些示例代码：

```
public class Simulation implements Runnable {
  private State myState = null;

  public Simulation(State myState) {
    this.myState = myState;
  }

  public void run() {
    while(myState != null) {
      if (myState.isPaused()) myState.wait();
      // Do other stuff
    }
  }
}

public class MainClass implements ActionListener() {
  private State myState = new MyState();

  private void beginSimulation() {
    Simulation s = new Simulation(this.myState());
    new Thread(s).start();
  }  

  public void actionPerformed(ActionEvent e) {
    if(myState.isPaused()) {
      myState.setPaused(false);
      myState.notify();
    } else {
      myState.setPaused(true);
    }
  }
}

public class MyState() {
  private boolean paused = false;
  public MyState(boolean paused) { this.paused = paused; }
  public boolean getPaused() { return paused; }
  public void setPaused(boolean paused) { this.paused = paused; }
} 
```

# asp.net-mvc - ASP.NET MVC 中的多个控制器

> ID：13690341
> 
> 赞同：2
> 
> 时间：2012-12-03T19:33:52.697
> 
> 标签：asp.net-mvc

我有一个站点，控制器是用户的名称，就像`/John/NewPage`Mary 一样。

如何在不必为每个新用户创建控制器的情况下做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:47:31.507

查看自定义路由。就像是：

```
 context.MapRoute(
        "User_default", // Route name
        "{userName}/{controller}/{action}/{id}", // URL with parameters
        new { id = UrlParameter.Optional } // Parameter defaults
    ) 
```

但是您必须自己处理这些 url。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:20:57.907

你可以做这样的事情。定义一个名为“UserController”的控制器，然后使用自定义路由，这样就不需要在 URL 中包含“UserController”：

```
context.MapRoute(
    "User_Route", // Route name
    "{userName}/{action}", // URL with parameters
    new { 
      controller = "UserController",
      action = "NewPage"
    } // Parameter defaults
); 
```

通过该设置，“/Mary/NewPage”URL 将调用 UserController.NewPage(“Mary”)，“/John/EditPage”将调用 UserController.EditPage(“John”)，而仅“/Jane”将调用 UserController。新页（“简”）。

您还需要为该路由上方的不同控制器定义路由，以便首先调用它们。例如：

```
context.MapRoute(
    "SomeOther_Route", // Route name
    "SomeOtherController/{action}/{id}", // URL with parameters
    new { 
      controller = "SomeOtherController"
    } // Parameter defaults
); 
```

上面的 URL 仍然可以工作，但现在这个 URL“/SomeOtherController/DefinedAction/12”将调用类似于 SomeOtherController.DefinedAction(12) 的东西。

# android - 如何使用 roboguice 将对象注入到 surfaceview 类中

> ID：13690345
> 
> 赞同：0
> 
> 时间：2012-12-03T19:33:57.457
> 
> 标签：android, guice, surfaceview, roboguice

我有一个扩展 SurfaceView 的类 MapView 和一个用于更新地图上位置的类 MapUpdater。我希望能够将 MapUpdater 类注入 MapView，因为它有几个依赖项也注入了 roboguice。然而 MapView 对象是由框架实例化的，而不是注入的，所以只是尝试注入 MapUpdater 只会给我一个空值。获取可以将对象注入其中的 MapUpdater 实例的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T04:25:05.083

尝试使用`RoboGuice.getInjector(context).getInstance(MapUpdater.class)`.

或者，在您的 MapView 构造函数中，调用`RoboGuice.getInjector(context).injectMembers(this)`以在您的 MapView 实例上手动执行注入。

# animation - Prolog 或任何其他逻辑编程语言的合理场景

> ID：13690350
> 
> 赞同：1
> 
> 时间：2012-12-03T19:34:26.440
> 
> 标签：animation, 3d, prolog, declarative

作为从事计算机动画的人，以下场景在 Prolog 或任何其他逻辑编程语言中是否合理：

假设我用一个 3D 模型狗创建了一个场景，一个具有完整角色物理和控制的装备，我为狗制作了一个环境。现在让我们说，我将场景中所有对象和物理的所有变量和算法作为 Prolog（或任何语言）中的原子和规则包括在内。现在让我们说我给出了我希望我的狗在我的环境中从 A 点到达 B 点的目标。考虑到所有数据的逻辑编程是否会为从 a 点到 b 点的步行设置动画，即使作为动画师，我从来没有为遛狗设置动画，只是提供了需要狗走路的所有信息和军事信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T22:36:54.573

我从事动画工作，并在 Prolog 中编程。

Prolog 是图灵完备的语言，所以任何可以编程的东西都可以在 Prolog 中编程。

但....

你的问题假设你有一个“完整的物理和控制”——这意味着狗的心理生理运动学模型。你必须拥有狗的肌肉、神经系统和大脑的完整模型。这实际上是不可能的（一方面，我们没有足够好的犬脑模型，并且可能没有足够的犬运动学知识）。

现在，如果您的意思是“我想给它一个步行循环，并生成运动”，那么是的，这是非常可行的。Cogbot ( [http://code.google.com/p/opensim4opencog/](http://code.google.com/p/opensim4opencog/) ) 使用 SWI-Prolog 为 OpenSim 虚拟世界系统中的两足动物执行此操作。

# android - 三星 Galaxy Nexus 未在 ADT 中显示

> ID：13690352
> 
> 赞同：0
> 
> 时间：2012-12-03T19:34:44.757
> 
> 标签：android, windows-8

我在试图让这个 Galaxy Nexus 出现在 ADT 中时遇到了一个大问题。

我尝试安装三星的所有驱动程序，但没有运气。

我的设备驱动程序详细信息显示我使用的是 2006 年的 Microsoft 驱动程序。显然这是不正确的。所以我尝试卸载没有运气。我还尝试更新驱动程序并指向 SAMSUNG/USB 驱动程序文件夹中的一个 Crazy 名称，但是 Windows 认为它​​比我更聪明并且总是说“它已确定我的设备的驱动程序软件是最新的”然后将该设备列为 MTP USB 设备。

电话显示为

便携式设备 Galaxy Nexus

在设备管理器中。

我试过在 MTP 和 PTP 模式下切换手机，但没有成功。

更新：在禁用和卸载一段时间后，我终于让设备在 MTP 模式下使用“SAMSUNG Electronics Co., Ltd”。但是它仍然没有出现在 adb devices 下，当我切换到 PTP 模式时，它又回到使用旧的 Microsoft 驱动程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:00:58.867

哇。所以我猜我的手机更新到了 4.2，默认情况下“开发者选项”是隐藏的。这也让我的手机关闭了USB调试。

无论如何....打开它[http://developer.android.com/about/versions/jelly-bean.html](http://developer.android.com/about/versions/jelly-bean.html) 并确保最近的更新没有关闭该选项。

# java - Java - LinkedList - 性能随着其中不同类的数量而降低

> ID：13690353
> 
> 赞同：6
> 
> 时间：2012-12-03T19:34:44.747
> 
> 标签：java, performance, linked-list

以下代码测量从接口*Handler调用 100 次方法**handle(Object o)*所需的时间（是的，这是质量差的分析）：

 *```
package test;

import java.util.LinkedList;

public class Test {

    static int i = 0;

    private interface Handler {
        public void handle(Object o);
    }
    private static class SuperHandler implements Handler {
        public void handle(Object o) { i += 1; }
    }
    private static class NoSuperHandler implements Handler {
        public void handle(Object o) { i += 1; }
    }
    private static class LulSuperHandler implements Handler {
        public void handle(Object o) { i += 1; }
    }
    private static class LilSuperHandler implements Handler {
        public void handle(Object o) { i += 1; }
    }
    private static class LolSuperHandler implements Handler {
        public void handle(Object o) { i += 1; }
    }
    private static class LalSuperHandler implements Handler {
        public void handle(Object o) { i += 1; }
    }
    private static class LylSuperHandler implements Handler {
        public void handle(Object o) { i += 1; }
    }
    private static class LzlSuperHandler implements Handler {
        public void handle(Object o) { i += 1; }
    }

    public static void main(String[] args) {
        LinkedList<Handler> ll = new LinkedList<Handler>();
        for(int j = 0; j < 100; j++) {
            if((j % 8) == 0) ll.add(new SuperHandler());
            if((j % 8) == 1) ll.add(new NoSuperHandler());
            if((j % 8) == 2) ll.add(new LulSuperHandler());
            if((j % 8) == 3) ll.add(new LilSuperHandler());
            if((j % 8) == 4) ll.add(new LolSuperHandler());
            if((j % 8) == 5) ll.add(new LalSuperHandler());
            if((j % 8) == 6) ll.add(new LylSuperHandler());
            if((j % 8) == 7) ll.add(new LzlSuperHandler());
        }
        long begin = System.currentTimeMillis();
        for(int j = 0; j < 1000000; j++) for(Handler h: ll) h.handle(null);
        System.out.println("time in ms: " + (System.currentTimeMillis() - begin));
        System.out.println("i: " + i);
    }
} 
```

事实是，如果*LinkedList*仅包含一种*Handler*，例如*SuperHandler*，则执行时间比它们是 2、3 等不同种类的*Handler*时要短。每次我在列表中添加一种新的*Handler*时，性能都会下降。

例如，当我只更改这部分时，我会得到比上面更好的性能：

```
for(int j = 0; j < 100; j++) {
    if((j % 2) == 0) ll.add(new SuperHandler());
    if((j % 2) == 1) ll.add(new NoSuperHandler());
} 
```

这里有特殊的优化操作吗？JAVA 架构中的哪些性能会降低？我的测试是错误的，因为未使用的*Handler*被编译器“删除”或“隐藏”了吗？（我正在使用来自 Oracle 的 Linux Ubuntu - JAVA 1.7）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-03T19:38:04.800

> 这里有特殊的优化操作吗？

是的。Hotspot 在处理虚方法方面非常聪明。如果一个接口只有几个实现，并且这些实现很小，它可以通过检查正确的类型并内联代码来避免完整的 vtable-lookup。

当你有几个不同的实现时，它会回到 vtable 实现。（Hotspot 足够聪明，可以*撤消*不再实用的优化。我很震惊这一切都挂在一起，但显然确实如此。）

请注意，这与列表中有多少不同的类无关——这里还有更多内容。有关详细信息，请参阅彼得的答案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-03T20:51:36.080

我同意乔恩的回答，但我相信代码点调用的类型数量会有所不同。在下面的示例中，加载了所有 8 个类，并且针对列表中相同数量的元素运行相同的代码，除了一个列表有 8 个，另一个有 2 种不同的类型。

```
import java.util.ArrayList;
import java.util.LinkedList;
import java.util.List;

public class Test {

    static int i = 0;

    private interface Handler {
        public void handle();
    }

    public static void main(String[] args) {
        List<Handler> ll8 = new ArrayList<Handler>();
        for (int j = 0; j < 128; j += 8) {
            ll8.add(new SuperHandler());
            ll8.add(new NoSuperHandler());
            ll8.add(new LulSuperHandler());
            ll8.add(new LilSuperHandler());
            ll8.add(new LolSuperHandler());
            ll8.add(new LalSuperHandler());
            ll8.add(new LylSuperHandler());
            ll8.add(new LzlSuperHandler());
        }
        List<Handler> ll2 = new ArrayList<Handler>();
        for (int j = 0; j < 128; j += 2) {
            ll2.add(new SuperHandler());
            ll2.add(new NoSuperHandler());
        }
        for (int j = 0; j < 5; j++) {
            test8(ll8);
            test8a(ll8);
            test2(ll2);
        }
        System.out.println("i: " + i);
    }

    private static void test8(List<Handler> ll8) {
        long begin = System.nanoTime();
        for (int j = 0; j < 1000000; j++) for (Handler h : ll8) h.handle();
        System.out.println("8 classes, time in ms: " + (System.nanoTime() - begin) / 100000 / 10.0);
    }

    private static void test8a(List<Handler> ll8) {
        long begin = System.nanoTime();
        for (int j = 0; j < 1000000; j++)
            for (int k = 0; k < ll8.size(); k += 8) {
                ll8.get(k + 0).handle();
                ll8.get(k + 1).handle();
                ll8.get(k + 2).handle();
                ll8.get(k + 3).handle();
                ll8.get(k + 4).handle();
                ll8.get(k + 5).handle();
                ll8.get(k + 6).handle();
                ll8.get(k + 7).handle();
            }
        System.out.println("8 classes unrolled, time in ms: " + (System.nanoTime() - begin) / 100000 / 10.0);
    }

    private static void test2(List<Handler> ll2) {
        long begin = System.nanoTime();
        for (int j = 0; j < 1000000; j++) for (Handler h : ll2) h.handle();
        System.out.println("2 classes, time in ms: " + (System.nanoTime() - begin) / 100000 / 10.0);
    }

    private static class SuperHandler implements Handler {
        public void handle() { i += 1; }
    }

    private static class NoSuperHandler implements Handler {
        public void handle() { i += 1; }
    }

    private static class LulSuperHandler implements Handler {
        public void handle() { i += 1; }
    }

    private static class LilSuperHandler implements Handler {
        public void handle() { i += 1; }
    }

    private static class LolSuperHandler implements Handler {
        public void handle() { i += 1; }
    }

    private static class LalSuperHandler implements Handler {
        public void handle() { i += 1; }
    }

    private static class LylSuperHandler implements Handler {
        public void handle() { i += 1; }
    }

    private static class LzlSuperHandler implements Handler {
        public void handle() { i += 1; }
    }
} 
```

印刷

```
8 classes, time in ms: 1467.9
8 classes unrolled, time in ms: 144.7
2 classes, time in ms: 515.8
8 classes, time in ms: 1455.1
8 classes unrolled, time in ms: 126.2
2 classes, time in ms: 509.6
8 classes, time in ms: 1234.1
8 classes unrolled, time in ms: 107.8
2 classes, time in ms: 274.3
8 classes, time in ms: 1212.0
8 classes unrolled, time in ms: 108.1
2 classes, time in ms: 273.0
8 classes, time in ms: 1208.8
8 classes unrolled, time in ms: 107.8
2 classes, time in ms: 274.5
i: 1920000000 
```*

# javascript - 验证不应包含具有相同 id 属性的标签的 HTML 文档

> ID：13690356
> 
> 赞同：-4
> 
> 时间：2012-12-03T19:34:57.057
> 
> 标签：javascript, jquery, html

我的表单有一个`textarea`和一个提交按钮。textarea 用于输入 HTML 代码，我想使用 JavaScript (JQuery) 通过正则表达式验证输入。如果多个 html 标记具有相同的`id`值，则将整个源代码打印在页面上，并且将违规标记标记为红色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:48:50.143

你可以使用这个片段：

[见演示](http://jsfiddle.net/shNuK/)

```
var isValid = true;
$('[id]').each(function() {
    if ($('[id="'+this.id+'"]').length > 1) {
        isValid = false;
        return false;
    }
});

alert(isValid);​ 
```

# javascript - 字符串之间的jQuery变量

> ID：13690365
> 
> 赞同：0
> 
> 时间：2012-12-03T19:35:50.293
> 
> 标签：javascript, jquery, variables

我想像这样传递以下变量：

```
var $headerHeight = jQuery("#header").outerHeight() - jQuery("#header .main-menu").outerHeight();

jQuery(this).find('nav').attr('style', 'margin-top:' + $headerHeight + '!important'); 
```

它显然是用错误的语法使用的；我只是不知道如何正确使用它。jQuery“.css”函数不是一个选项，因为它必须有“！important”声明。我怎样才能通过`$headerHeight`上面的例子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:50:02.237

```
 var headerHeight = $("#header").outerHeight() - $("#header .main-menu").outerHeight();

    jQuery(this).find('nav').attr('style', 'margin-top:' +headerHeight+'px ' + '!important'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:39:36.490

您需要为属性值添加一个单位。（大概`px`）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:01:04.633

你正在解决错误的问题。与其取消slideToggle 所做的更改，不如不要使用slideToggle。

```
$(myelement).animate({
    height: "200px" // or whatever your target height is, calculated or static.
},500/*duration*/); 
```

# php - 使用 PHP 将大型、复杂的 XML 文档转换为 HTML

> ID：13690367
> 
> 赞同：0
> 
> 时间：2012-12-03T19:35:58.157
> 
> 标签：php, html, xml, parsing

我正在开发一个项目来创建一个解析器，该解析器采用存储在 XML 中的教科书并使用 PHP 将它们转换为 HTML。这是用于在线教育服务。我花了很多时间研究 PHP 中的 XML 解析器选项。从我所见，我相信我最好的选择是使用 DOMDocument 或 XMLReader（也许将它与 SimpleXML 混合）。

这些书被分成单独的文件，分别为 Front、Units、Chapter 和 Back。这是从外部源提供的，因此我无法控制 XML。话虽如此，我发现他们正在使用[Syntext Serna Free](http://www.serna-xmleditor.com/)来构建 XML 文档。

因此书籍以 ISBN# 命名，文件格式为 1234567890_ch01.xml。这是 XML 文档的一个示例。这是高度浓缩的可读性，因为实际文档是每个文档 700-1000 行，每个教科书大约 25 个文档。

```
<frontmatter id="1234567890_001_000003" page-num="i" filename="1234567890_001_fm01.xml" sourcefilename="prelims.pdf">
    <titleinfo id="1234567890_001_000004" page-num="i">
        <title id="1234567890_001_000005" page-num="i">I'm a Book Title</title>
        <subtitle id="1234567890_001_000006" page-num="i">I'm a subtitle</subtitle>
    </titleinfo>
    <creditinfo id="1234567890_001_000007" page-num="i">
        <author id="1234567890_001_000008" page-num="i">
            <name><emph type="bold">Senior Author</emph>
                <fname><emph type="bold">Bob</emph></fname>
                <lname><emph type="bold">Loblaw</emph></lname>
            </name>
            <organizationname>District School Board</organizationname>
        </author>
        <author id="1234567890_001_000009" page-num="i">
            <name><emph type="bold">Authors</emph>
                <fname><emph type="bold">Spongebob</emph></fname>
                <lname><emph type="bold">Squarepants</emph></lname>
            </name>
            <organizationname>District School Board</organizationname>
        </author>
    </creditinfo>
</frontmatter> 
```

所以这是布局的基本思想。当然，它还有很多内容，但本质上它都是按父标签排序的。我在想我的策略是制作一个父标签列表，使用 SAX 解析器读取这些标签，然后将子标签转换为 SimpleXML 对象以便于使用。本质上保持相同的 XML 结构，但将其包装在 HTML 元素中，并将 XML 元素名称作为类或 id 名称，并将 XML 属性直接转换为 HTML 属性。

呸。好的，所以我的问题是……有没有人可以分享一些知识或经验来解析这种大小/复杂性的 XML 文档？对于这种规模的东西，推荐的策略是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T00:56:19.107

我肯定会研究 Jani Hartikainen 对 XSLT 的建议。XSLT 是一种基于 XML 的语言，用于编写规则（称为“样式表”，但它们不同于 CSS 样式表）将任意 XML 文档（例如您正在处理的输入）转换为其他格式，包括 HTML（转换为HTML 是如此普遍，以至于 XSLT 有一些专用于它的功能）。PHP 有一个内置的 XSLT 处理器。

可能是教科书出版商已经有一些用于将教科书转换为 HTML 的 XSLT 样式表；您可能需要根据您的特定需求对它们进行一些修改，但这比从头开始编写自己的代码要容易得多且不易出错。

# ruby-on-rails - Rails 和 Mongoid：尝试从控制器查询数据库

> ID：13690368
> 
> 赞同：0
> 
> 时间：2012-12-03T19:36:00.043
> 
> 标签：ruby-on-rails, ruby, mongodb, mongoid

在我的控制器中，我试图获取与每个键相关联的所有请求，这些请求与某个用户相关联。

```
class PendingsController < ApplicationController
  # GET /pendings
  # GET /pendings.json
  def index
    @pending_requests = current_user.keys.reduce do |key|
      key.requests.where(ready: false).to_a
    end

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @pending_requests }
    end
  end 
```

但是，在@pending_requests，“[]:Array 有一个未定义的方法‘requests’”

有多个键与某个用户关联，多个请求与某个键关联。

在调试器中，key.requests 被识别为 Mongoid 关系，但仍然失败。

为什么是这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:50:13.513

我猜你误解了`reduce`用法。尝试：

```
@pending_requests = current_user.keys.each_with_object([]) do |key, array|
  array.concat key.requests.where(ready: false).to_a
end 
```

# ruby-on-rails-3 - 显示类似于显示页面上显示的另一个对象的对象

> ID：13690370
> 
> 赞同：1
> 
> 时间：2012-12-03T19:36:05.597
> 
> 标签：ruby-on-rails-3, methods, scopes

希望标题有意义，但我会详细介绍。我有一个简单的应用程序，允许用户上传食谱。然后，您可以通过显示操作查看全部或单独查看每个配方

```
def show
@recipe = Recipe.find(params[:id])
end 
```

然后在视图中显示该配方的各种属性，如下所示

```
 <b><%= @recipe.dish_name %></b><br>
  <b><%= image_tag @recipe.avatar.url(:showrecipe) %><b><br>
  <b>by&nbsp;<%= @recipe.user.name %></b></br></br>
  <b>Description</b></br>
  <b><%= @recipe.description %></b></br>
  <b>Ingredients</b></br>
  <b><%= raw(ingredient_names_list(@recipe.ingredients)) %></b>
  <br>
  <b>Preperation Steps</b></br>
  <ol>
  <li><%= raw(preperation_steps_list(@recipe.preperations)) %></li>
  </ol> 
```

我想要实现的是在同一页面上有一个部分，该部分将列出其他食谱的名称，这些食谱与所显示的食谱相似，基于 disc_name

这是我第一次做这样的事情，所以我正在寻找一些关于要查看哪些资源或我将如何去做的指针

到目前为止，我的想法是

1) 创建一个方法，该方法根据显示的菜名调用作用域，并传递菜名的参数。

那可能是错误的，请在正确的方向上轻推

编辑

我也在我的表演动作中尝试过这个，但我得到错误的参数数量（1 代表 0）

```
@relatedrecipe = Recipe.where(@recipe.dish_name('LIKE'),(params[:dish_name])) 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:45:21.040

如果我这样做，我会将我的应用程序插入全文搜索数据库，例如标题、描述和成分列表并为其编制索引`sunspot_solr`。`sunspot_rails`

然后使用标准化版本的标题和成分创建一个通用搜索，不包括您已经查看的记录，以提供近乎热门和相关内容。

**编辑**一个更具体的例子`sunspot_rails`（我有一些经验）：

sunspot_rails 使用模型中的可搜索块来告诉它应该在创建/更新/销毁时索引什么。您可以使用 :ingredient_names 创建如下所示的自定义索引。

```
class Recipe < ActiveRecord::Base

  searchable do
    integer :id
    string  :description
    text    :preparations
    text    :ingredient_names
  end

  def ingredient_names
    ingredients.map{|i| i.name }.uniq.compact.join(' ')
  end

  def similar_recipes
    search = Recipe.search do
      without(:id, self.id) # don't return the same record
      fulltext(self.description) do
        boost_fields(:description => 2) # give extra weight to description matches
      end
      fulltext(self.ingredient_names)
    end
    search.results
  end

end 
```

# android - 覆盖现有数据库

> ID：13690371
> 
> 赞同：1
> 
> 时间：2012-12-03T19:36:12.253
> 
> 标签：android, database, filestream

我有一个从[规则设计.com](http://reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)获得的数据库帮助程序类，它运行良好。问题是当我编辑我的数据库 sqlbrowser 并将它放在我的资产文件夹中时，它不会替换我现有的数据库，因为在这个 databasehelper 类中，如果它不存在，它只会从资产文件夹中复制数据库，我的问题是，什么会我添加到这个帮助类，让它覆盖我现有的数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:38:47.740

`Context.deleteDatabase()`首先使用（[文档链接](https://developer.android.com/reference/android/content/Context.html#deleteDatabase%28java.lang.String%29)）删除您现有的数据库。

# c# - c#中的正则表达式匹配模式

> ID：13690372
> 
> 赞同：1
> 
> 时间：2012-12-03T19:36:16.543
> 
> 标签：c#, regex

嘿，我有以下字符串作为输入：

```
"abcol"  
"ab_col"  
"cold"  
"col_ab"  
"col.ab" 
```

我有要搜索的字符串 col。我正在使用正则表达式进行匹配

```
Match matchResults = Regex.Match(input , "col", RegexOptions.IgnoreCase); 
```

我只想匹配具有此模式的字符串 `[Any special character or nothing ] + col + [Any special character or nothing]`

从上面的输入中，我只想返回 `ab_col, col_ab , col.ab`

非常感谢任何帮助。
谢谢

[任何特殊字符] = [^A-Za-z0-9]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T19:39:12.520

你可以使用这个正则表达式： -

```
(?:^.*[^a-zA-Z0-9]|^)col(?:[^a-zA-Z0-9].*$|$) 
```

**解释 ： -**

```
(?:   // non-capturing
  ^   // match at start of the string
  .*[^a-zA-Z0-9]  // match anything followed by a non-alphanumeric before `col`
    |     // or
  ^       // match the start itself (means nothing before col)
)
  col  // match col
(?:   // non-capturing
  [^a-zA-Z0-9].*  // match a non-alphanumeric after `col` followed by anything
   $     // match end of string
   |     // or
   $     // just match the end itself (nothing after col)
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T19:38:48.197

`@"(^|.*[\W_])col([\W_].*|$)"`这是你的模式。`\w`是字母数字字符并且`\W`是非字母数字字符。`^`表示行开始，`$`表示行结束。`|`是或。所以`(^|.*\W)`表示行开始或一些字符和它们后面的非字母数字。

**编辑：**

是的，下划线也是字母数字......所以你应该写`[\W_]`（非字母数字或下划线）而不是`\W`

# java - 在 GWT 应用程序中使用 jdbc 连接到 mysql (xampp) 时遇到问题 - 即使 jar 在构建路径中也找不到类

> ID：13690375
> 
> 赞同：2
> 
> 时间：2012-12-03T19:36:43.107
> 
> 标签：java, mysql, jdbc

我正在尝试使用 JDBC 连接到 MySQL 数据库。MySQL 数据库使用 XAMPP 运行。我做的第一件事是使用这个查询在 phpMyAdmin 中创建一个用户：

```
CREATE USER 'root'@'%' IDENTIFIED BY  '***';

GRANT SELECT , 
INSERT ,
UPDATE ,
DELETE ON * . * TO  'root'@'%' IDENTIFIED BY  '***' WITH MAX_QUERIES_PER_HOUR 0     MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0 MAX_USER_CONNECTIONS 0 ;

GRANT ALL PRIVILEGES ON  `my_database` . * TO  'root'@'%'; 
```

我正在使用 GWT，因此我在 GWT 中创建了一个服务并使用 web.xml 正确设置它。我已经确认我的应用程序可以很好地找到该服务并正在尝试连接到数据库。我将 mysql-connector-java-5.1.22-bin.jar 放在我项目的 war/WEB-INF/lib 目录（并将其添加到 Eclipse 中的构建路径）和 Tomcat 的 lib 文件夹中，这是一个很好的衡量标准（我读过可能需要的地方）。

我正在尝试使用此代码连接到我的数据库（密码和数据库名称是正确的，出于隐私考虑，我在此处对其进行了编辑）：

```
// import java.sql.*; is in the import statements

Connection db = null; 
System.out.println("Attempting to connect to database.");

String uid = "root"; 
String pwd = "my_password"; 
String db_name = "my_database"; 
String url = "jdbc:mysql://127.0.0.1/" + db_name; 
Class.forName("com.mysql.jdbc.Driver").newInstance(); 
db = DriverManager.getConnection(url, uid, pwd); 
System.out.println("DB connection successful for database \"" + db_name + "\"");

Statement s = db.createStatement(); 
s.executeQuery("INSERT INTO `companies`(`name`) VALUES ('blahblah');"); 
```

当我运行该应用程序时，它会打印“尝试连接到数据库”。但随后以红色打印“数据库连接失败：com.mysql.jdbc.Driver”。当我在 phpMyAdmin 中检查我的数据库时，当然没有“blahblah”公司添加到公司表中。

我正在拔头发试图找出问题所在。我将不胜感激任何帮助！

编辑：我导入`com.mysql.jdbc.Driver;`并且错误消息发生了变化。这是新的堆栈跟踪。我什至指定了 URL 以包含端口号，如下所示：`String url = "jdbc:mysql://localhost:3306/" + db_name;`但这没有帮助。

```
Dec 03, 2012 5:19:23 PM com.google.appengine.tools.development.ApiProxyLocalImpl log
SEVERE: javax.servlet.ServletContext log: Exception while dispatching incoming RPC call
com.google.gwt.user.server.rpc.UnexpectedException: Service method 'public abstract java.lang.Boolean com.candor.cougar.client.SqlService.connect()' threw an unexpected exception: java.lang.ExceptionInInitializerError

at com.google.gwt.user.server.rpc.RPC.encodeResponseForFailure(RPC.java:385)
at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:588)
at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:208)
at com.google.gwt.user.server.rpc.RemoteServiceServlet.processPost(RemoteServiceServlet.java:248)
at com.google.gwt.user.server.rpc.AbstractRemoteServiceServlet.doPost(AbstractRemoteServiceServlet.java:62)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
at com.google.appengine.api.socket.dev.DevSocketFilter.doFilter(DevSocketFilter.java:74)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.ResponseRewriterFilter.doFilter(ResponseRewriterFilter.java:110)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:34)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:61)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:125)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:94)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:380)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at org.mortbay.jetty.Server.handle(Server.java:326)
at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:938)
at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:755)
at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)
at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)

Caused by: java.lang.ExceptionInInitializerError
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Unknown Source)
at com.candor.cougar.server.SqlServiceImpl.connect(SqlServiceImpl.java:21)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at com.google.appengine.tools.development.agent.runtime.Runtime.invoke(Runtime.java:115)
at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:569)
... 38 more

Caused by: java.security.AccessControlException: access denied ("java.lang.RuntimePermission" "modifyThreadGroup")
at java.security.AccessControlContext.checkPermission(Unknown Source)
at java.security.AccessController.checkPermission(Unknown Source)
at java.lang.SecurityManager.checkPermission(Unknown Source)
at com.google.appengine.tools.development.DevAppServerFactory$CustomSecurityManager.checkPermission(DevAppServerFactory.java:289)
at com.google.appengine.tools.development.DevAppServerFactory$CustomSecurityManager.checkAccess(DevAppServerFactory.java:314)
at java.lang.ThreadGroup.checkAccess(Unknown Source)
at java.lang.Thread.init(Unknown Source)
at java.lang.Thread.<init>(Unknown Source)
at com.mysql.jdbc.NonRegisteringDriver$1.<init>(NonRegisteringDriver.java:90)
at com.mysql.jdbc.NonRegisteringDriver.<clinit>(NonRegisteringDriver.java:89)
... 47 more

Dec 03, 2012 5:19:28 PM com.google.appengine.tools.development.LocalResourceFileServlet doGet
WARNING: No file found for: /favicon.ico

com.google.gwt.user.client.rpc.StatusCodeException: 500 The call failed on the server; see server log for details

at com.google.gwt.user.client.rpc.impl.RequestCallbackAdapter.onResponseReceived(RequestCallbackAdapter.java:209)
at com.google.gwt.http.client.Request.fireOnResponseReceived(Request.java:287)
at com.google.gwt.http.client.RequestBuilder$1.onReadyStateChange(RequestBuilder.java:395)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at com.google.gwt.dev.shell.MethodAdaptor.invoke(MethodAdaptor.java:103)
at com.google.gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:71)
at com.google.gwt.dev.shell.OophmSessionHandler.invoke(OophmSessionHandler.java:172)
at com.google.gwt.dev.shell.BrowserChannelServer.reactToMessagesWhileWaitingForReturn(BrowserChannelServer.java:337)
at com.google.gwt.dev.shell.BrowserChannelServer.invokeJavascript(BrowserChannelServer.java:218)
at com.google.gwt.dev.shell.ModuleSpaceOOPHM.doInvoke(ModuleSpaceOOPHM.java:136)
at com.google.gwt.dev.shell.ModuleSpace.invokeNative(ModuleSpace.java:561)
at com.google.gwt.dev.shell.ModuleSpace.invokeNativeObject(ModuleSpace.java:269)
at com.google.gwt.dev.shell.JavaScriptHost.invokeNativeObject(JavaScriptHost.java:91)
at com.google.gwt.core.client.impl.Impl.apply(Impl.java)
at com.google.gwt.core.client.impl.Impl.entry0(Impl.java:213)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at com.google.gwt.dev.shell.MethodAdaptor.invoke(MethodAdaptor.java:103)
at com.google.gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:71)
at com.google.gwt.dev.shell.OophmSessionHandler.invoke(OophmSessionHandler.java:172)
at com.google.gwt.dev.shell.BrowserChannelServer.reactToMessages(BrowserChannelServer.java:292)
at com.google.gwt.dev.shell.BrowserChannelServer.processConnection(BrowserChannelServer.java:546)
at com.google.gwt.dev.shell.BrowserChannelServer.run(BrowserChannelServer.java:363)
at java.lang.Thread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:40:27.740

我发现了问题所在，所以我想我会在这里回答我自己的问题。问题在于 Google App Engine 是默认启用的，因为它是 GWT 应用程序，并且 GAE 与数据库访问冲突。因此，我在项目属性中禁用了 GAE，并从构建路径中删除了所有与 GAE 相关的 .jar（对我来说，这意味着除了 mysql 连接器之外的所有 .jar），它解决了这个问题。

# mysql - 按一些 id 分组数据

> ID：13690377
> 
> 赞同：3
> 
> 时间：2012-12-03T19:36:54.613
> 
> 标签：mysql, sql, jasper-reports

英语不是我的母语，所以我认为举个例子可能会更好。

这是我想要的：

```
GROUP NAME 1 (when ids = 1,3 or 8) - SUM
id = 1
id = 3
id = 8

GROUP NAME 2 (when ids = 5 or 8) - SUM
id = 5 - NAME - SUM
id = 8 - NAME - SUM 
```

...

如您所见，我需要指定查询（对于*MySQL*）哪个 ID 在组中。

这可能吗？

如果没有，还有其他方法吗？我想我可以在许多子报告中做到这一点，但这并不“干净”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T06:11:19.493

我想你正在寻找这个：

```
 SELECT SUM(CASE WHEN (id =1 or id=3 or id=8) then WhichEverColumnYouWanaSum
            ELSE 0
            END )AS Group1,
            SUM (CASE WHEN (id =5 or id=8)  then WhichEverColumnYouWanaSum
            ELSE 0
            END)AS Group2 
```

# php - 如何根据下拉菜单结果从数据库中提取信息

> ID：13690383
> 
> 赞同：0
> 
> 时间：2012-12-03T19:37:17.090
> 
> 标签：php, sql, database, drop-down-menu

我只是使用 SQL 查询从数据库中提取了不同的健身房，现在必须根据下拉结果将它们拉入。这是我到目前为止所拥有的。任何帮助将非常感激。

```
<?php 

require_once('connect.php'); //connecting to my database

mysql_select_db("gyms", $connect);

$result = mysql_query("SELECT * FROM gym WHERE id='1'"); //each gym has an "id" field of 1-5

while($row = mysql_fetch_array($result))
{
echo $row['name']; //all different attributes in the gym database
echo $row['type'];
echo $row['price'];
echo $row['hours'];
echo $row['parking'];
echo $row['facilities'];
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:13:00.080

下拉字段必须是表单的一部分。

```
if (!isset($_POST['gyms'])) {
echo '<form action="same.php" method="post">
    <select name="gyms">
        <option value="1">Gym 1</option>
        <option value="2">Gym 2</option>
    </select>
</form>';
} else {

    $id = $_POST['gyms'];
    // DO NOT forget to sanitize the value of $id before plugging it in
    // NEVER trust user input. Always assume it's a hacker.
    $result = mysql_query("SELECT * FROM gym WHERE id=$id");
    $row = mysql_fetch_array($result)
    // $row should contain the results from the database for the given gym
    var_dump($row);
} 
```

顺便说一句，我强烈建议使用 PDO 而不是 mysql_*() 函数。以下是一些相关链接：

*   [http://php.net/manual/en/book.pdo.php](http://php.net/manual/en/book.pdo.php)
*   [http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)

# c# - 无法显示树结构

> ID：13690386
> 
> 赞同：0
> 
> 时间：2012-12-03T19:37:36.967
> 
> 标签：c#, .net, linq

我想显示这样的树结构：

*   使命1

    *   活动1
        *   项目1
    *   活动2
*   任务2

    *   活动3
        *   项目2

但相反，我得到一个列表，该列表重复每个活动或项目的父元素，如下所示：

*   使命1

    *   活动1
        *   项目1
*   使命1

    *   活动2

我想将活动和项目分组在一个父（“任务”）元素下。

这是我的 LINQ 查询：

```
var q = from mission in _context.tMissions
                join activity in _context.tActivities on mission.id equals activity.missionId
                join project in _context.tDefaultEventTypes on activity.id equals project.activityId
                where !project.isRemoved && project.defaultCategoryId == 4
                orderby mission.name
                select CreateFrom(project);

        return q.ToList(); 
```

然后我将它绑定到一个列表并显示在页面上。这是我的aspx：

```
 <asp:DataList ID="dlTierTypes" runat="server">
      <ItemTemplate>
        <li><%# Eval("Activity.Mission.Name") %></li>
          <ul>
            <li><%# Eval("Activity.Name") %></li>
            <ul>
              <li><%# Eval("Name") %></li>
            </ul>
      </ItemTemplate>
    </asp:DataList> 
```

后面的代码只是绑定它：

```
 public void SetTierTree(IEnumerable<DefaultEventType> tierList)
    {
      dlTierTypes.DataSource = tierList;
      dlTierTypes.DataBind();
    } 
```

不知道如何准确解决这个问题。

编辑 - 这是我在存储库中的新功能。

```
 public ICollection<DefaultEventType> GetTierTree()
    {
        var q = from mission in _context.tMissions
                join activity in _context.tActivities on mission.id equals activity.missionId
                join project in _context.tDefaultEventTypes on activity.id equals project.activityId
                where !project.isRemoved && project.defaultCategoryId == 4
                orderby mission.name
                select new DefaultEventType(project.tierLevel.TryParseEnum<GanttType>(GanttType.Unknown), DefaultCategoryRepository.CreateFrom(project.tDefaultCategory))
                {
                    //t = new DefaultEventType(project.tierLevel.TryParseEnum<GanttType>(GanttType.Unknown), DefaultCategoryRepository.CreateFrom(project.tDefaultCategory)),
                    AllowNumericSuffix = project.allowNumericSuffix,
                    AttachMilestoneMoniker = project.attachMilestoneMoniker,
                    Description = project.description,
                    Id = project.id,
                    IsReadOnly = project.isReadOnly,
                    IsSticky = project.isSticky,
                    Name = project.name,
                    Sid = project.sid,
                    Style = project.style.TryParseEnum<GanttElementStyle>(GanttElementStyle.Unknown),
                    TimeStamp = project.createdDT,
                    UpdatedTimeStamp = project.updatedDT,
                    Activity = new Activity { Id = activity.id, Name = activity.name, Mission = new Mission { Id = mission.id, Name = mission.name } }
                };

        var q2 = q.GroupBy(row => row.Activity.Mission.Id)
            .Select(group => group.GroupBy(row => row.Activity.Id));

        return q2.Cast<DefaultEventType>().ToList();
    } 
```

但我在显示页面时收到此错误：“无法从类型 'System.Collections.Generic.List `1[System.Linq.IGrouping`2[System.Int32,DefaultEventType]]' 转换为类型 'DefaultEventType'。”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:48:39.807

首先，您需要调整查询。在这个例子中使用`GroupBy`可以*极大地帮助。*

只取你所拥有的，然后按任务对结果进行分组。对于每个组，按活动对任务进行分组（这需要嵌套分组，而不是顺序分组）。

```
var q2 = q.GroupBy(row => row.MissionID)
     .Select(group => group.GroupBy(row => row.ActivityID)); 
```

我不确定您的提供商是否可以在数据库端进行映射；`AsEnumerable`如果没有在需要的地方抛出一个查询。

接下来，您需要更改呈现数据的方式以反映此更改。

`DataList`您需要 3 个嵌套的数据列表，而不是一个。您将整个查询绑定到显示任务的外部级别，然后订阅数据绑定事件以将内部组设置为内部数据列表实例的数据源。然后，在那个内层数据列表中，显示活动并将最内层的组级别绑定到最内层`DataList`，这样就可以正常绑定项目名称了。

此外，您可以考虑使用 a`TreeView`来呈现数据结构而不是 a `DataList`，因为 a`TreeView`旨在呈现树。我不确定您是否出于某种原因需要拒绝它或者只是没有考虑它，但它可能更容易使用。如果您确实走这条路，查询仍将按照我的建议进行修改，您将不需要任何嵌套的 ASP 控件。

# php - finally 异常给出了一个错误 php

> ID：13690393
> 
> 赞同：4
> 
> 时间：2012-12-03T19:37:55.937
> 
> 标签：php, exception

我正在尝试学习 PHP，我刚刚转到异常，当我尝试从

[http://php.net/manual/en/language.exceptions.php](http://php.net/manual/en/language.exceptions.php)

`Example #2 Exception handling with a finally block`

我得到一个错误

`Parse error: syntax error, unexpected '{' in C:\xampp\htdocs\test\filename.php on line 13`

```
<?php
function inverse($x) {
    if (!$x) {
        throw new Exception('Division by zero.');
    }
    else return 1/$x;
}

try {
    echo inverse(5) . "\n";
} catch (Exception $e) {
    echo 'Caught exception: ',  $e->getMessage(), "\n";
} finally {
    echo "First finally.\n";
}

try {
    echo inverse(0) . "\n";
} catch (Exception $e) {
    echo 'Caught exception: ',  $e->getMessage(), "\n";
} finally {
    echo "Second finally.\n";
}

// Continue execution
echo 'Hello World'; 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-03T19:40:47.850

try-catch 块是在仍在开发中的`finally`PHP 5.5 中添加的，因此它不适合您的可能原因是您使用的是 PHP 5.4 或更早版本。

除非他们将其反向移植到较早的 PHP 版本或您使用的是 5.5 版本，否则您将无法使用 finally。

# android - 我的自定义列表视图适配器抛出空指针异常我不知道为什么

> ID：13690396
> 
> 赞同：0
> 
> 时间：2012-12-03T19:38:02.940
> 
> 标签：android

在getView 1 个周期后抛出空指针。即列表中的第一个元素返回正常，但它在第二个元素上崩溃。

它说持有人为空。指位`holder.textName.setText(station)`。

知道为什么吗？

```
...
static class StationHolder {
        TextView textName;
        ImageView imgStationImage;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View row = convertView;
        StationHolder holder = null;

        Typeface tfBoldCon = Typeface.createFromAsset(context.getAssets(),
                "Roboto-BoldCondensed.ttf");
        Typeface tfCon = Typeface.createFromAsset(context.getAssets(),
                "Roboto-Condensed.ttf");
        Typeface tfLight = Typeface.createFromAsset(context.getAssets(),
                "Roboto-Light.ttf");

        if (row == null) {
            LayoutInflater inflater = ((Activity) context).getLayoutInflater();
            row = inflater.inflate(viewResourceId, parent, false);

            holder = new StationHolder();
            holder.textName = (TextView) row.findViewById(R.id.station_name);
            holder.textName.setTypeface(tfCon);
            holder.imgStationImage = (ImageView) row
                    .findViewById(R.id.station_image);

        } else {
            holder = (StationHolder) row.getTag();
        }

        final String station = stations.get(position);
        Log.i("", station);

        if (station != null) {
            holder.textName.setText(station);
        }
        return row;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:41:26.860

你忘了

```
row.setTag(holder); 
```

在对行进行充气并设置持有人值之后。

这样，当您重用 row.tag 时，它被设置为 null。

# javascript - 如何将JQuery JCrop居中在图片的中心

> ID：13690404
> 
> 赞同：7
> 
> 时间：2012-12-03T19:38:40.913
> 
> 标签：javascript, jquery, jcrop

我想在图片的中心开始 JCrop 选择。有没有办法做到这一点？

有什么选择吗？手册中没有规定。

我们必须手动计算吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-03T19:55:21.467

如果您无法弄清楚如何在中心设置选择：

检查设置选项[http://deepliquid.com/content/Jcrop_Manual.html#Setting_Options](http://deepliquid.com/content/Jcrop_Manual.html#Setting_Options)

像这样的东西（取自 API ref）：

```
<script language="Javascript">

    jQuery(function($) {
        $('#target').Jcrop({
            onSelect:    showCoords,
            bgColor:     'black',
            bgOpacity:   .4,
            setSelect:   [ x, y, x1, y1 ],
            aspectRatio: 16 / 9
        });
    });

</script> 
```

如果`w is the width`和`h is the height`所需的选择 和`W is the width of the image`, `H is the height of the image`, 坐标将是

```
x = W/2 - w/2
y = H/2 - h/2
x1 = x + w
y1 = y + h 
```

（我希望我的数学是正确的:)

# asp.net - ASP.NET 4.0 使用带有现有 DropDownList 控件的 Ajax

> ID：13690407
> 
> 赞同：0
> 
> 时间：2012-12-03T19:38:46.023
> 
> 标签：asp.net, ajax, asp.net-controls

每次用户更改 ASP.NET DropDownList 控件中的值时，我都需要在后端进行更新。我想使用 AJAX 来执行此操作，因此浏览器不会进行完全刷新并将用户重新定位到他们当前所在的控件之外。我的问题是用户在这一页上执行了很多输入，所以我想在每次更改时自动保存。我遇到了会话状态超时并且用户丢失所有更改的问题。我尝试更改 web.config 中的超时设置，但没有奏效。因此，我想在每个 DropDownList 控件发生更改时进行 AJAX 回调。那怎么做？我目前没有在网站的任何地方使用 Ajax。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:41:59.550

尝试将 DropDownList 放在[UpdatePanel](http://msdn.microsoft.com/en-us/library/bb386454(v=vs.100).aspx)中。

# c++ - 不受欢迎的常规 Perlin 噪音

> ID：13690410
> 
> 赞同：3
> 
> 时间：2012-12-03T19:38:50.493
> 
> 标签：c++, hlsl, directx-11, perlin-noise

我正在尝试将 fBm 实现到行星的球体上。为了创建我的球体，我将它从一个立方体转换为这样的。不幸的是，生成的 fBm 显示为镜像补丁。此外，它只在 2 个面上进行（包装其他面的值）。[当渲染为球体](http://skullyb.tumblr.com/post/37126270357/undesired-tile-effect-for-fbm)时，这会导致类似的拉伸外观

[噪声函数是由Ken Perlin](http://mrl.nyu.edu/~perlin/noise/)描述的改进噪声，我将它用于 HLSL：

```
 float fade(float t) { return t * t * t * (t * (t * 6 - 15) + 10); }

  float lerp(float t, float a, float b) { return a + t * (b - a); }

  float grad(int hash, float x, float y, float z) {
  int h = hash & 15;                      // CONVERT LO 4 BITS OF HASH CODE
  float u = h<8 ? x : y,                 // INTO 12 GRADIENT DIRECTIONS.
         v = h<4 ? y : h==12||h==14 ? x : z;
  return ((h&1) == 0 ? u : -u) + ((h&2) == 0 ? v : -v);
  } 
  int p[512] = { 151,...180 }; //0-255 twice

  float noise(float x, float y, float z) {

  int X = (int)floor(x) & 255;                  // FIND UNIT CUBE THAT
  int Y = (int)floor(y) & 255;                  // CONTAINS POINT.
  int Z = (int)floor(z) & 255;
  x -= floor(x);                                // FIND RELATIVE X,Y,Z
  y -= floor(y);                                // OF POINT IN CUBE.
  z -= floor(z);
  float u = fade(x),                                // COMPUTE FADE CURVES
         v = fade(y),                                // FOR EACH OF X,Y,Z.
         w = fade(z);
  int A = p[X  ]+Y, AA = p[A]+Z, AB = p[A+1]+Z,      // HASH COORDINATES OF
      B = p[X+1]+Y, BA = p[B]+Z, BB = p[B+1]+Z;      // THE 8 CUBE CORNERS,

  return lerp(w, lerp(v, lerp(u, grad(p[AA  ], x  , y  , z   ),  // AND ADD
                                 grad(p[BA  ], x-1, y  , z   )), // BLENDED
                         lerp(u, grad(p[AB  ], x  , y-1, z   ),  // RESULTS
                                 grad(p[BB  ], x-1, y-1, z   ))),// FROM  8
                 lerp(v, lerp(u, grad(p[AA+1], x  , y  , z-1 ),  // CORNERS
                                 grad(p[BA+1], x-1, y  , z-1 )), // OF CUBE
                         lerp(u, grad(p[AB+1], x  , y-1, z-1 ),
                                 grad(p[BB+1], x-1, y-1, z-1 ))));
  } 
```

这个实现在之前的项目中按预期工作，但是对于这个项目，当我使用顶点位置作为输入时，它似乎创建了一个平滑的网格。它是一个单位立方体，因此这些值不是整数，但我无法弄清楚为什么它没有创建典型的 Perlin 噪声纹理。

任何帮助将不胜感激，如果需要，我会提供更多信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:05:03.153

该函数无法访问整数 p 数组，因此我假设其中的值未定义。一个快速的解决方法是使数组静态，但这真的很慢。所以现在我需要传入数组。但我遇到了麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-24T23:21:40.010

我在一个 Dx11 行星渲染项目中使用了下面的噪声函数。我也包含了一个 fBm 函数。[我在 WebGL 着色器编程网站ShaderToy](http://shadertoy.com)上找到了它（用 GLSL 编写）。

它是由网站的作者、神一样的 inigo quilez 编写的。

试试看，希望对你有帮助。所有功劳都应归功于 inigo quilez 的工作。将其移植到 HLSL 是微不足道的。我只在着色器模型 5 中进行了测试，但我确信它至少可以在 4 下工作。

```
// hash based 3d value noise
// function taken from https://www.shadertoy.com/view/XslGRr
// Created by inigo quilez - iq/2013
// License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.

// ported from GLSL to HLSL

cbuffer cbNoiseParameters
{
    float _rOctaves;
    float _rLacunarity;
    float _rFrequency;
    float _rAmplitude;
    float _rGain;
    float _rOffset;
};

float hash( float n )
{
    return frac(sin(n)*43758.5453);
}

float noise( float3 x )
{
    // The noise function returns a value in the range -1.0f -> 1.0f

    float3 p = floor(x);
    float3 f = frac(x);

    f       = f*f*(3.0-2.0*f);
    float n = p.x + p.y*57.0 + 113.0*p.z;

    return lerp(lerp(lerp( hash(n+0.0), hash(n+1.0),f.x),
                   lerp( hash(n+57.0), hash(n+58.0),f.x),f.y),
               lerp(lerp( hash(n+113.0), hash(n+114.0),f.x),
                   lerp( hash(n+170.0), hash(n+171.0),f.x),f.y),f.z);
}

float fBm( float3 vPt )
{
    float octaves       = _rOctaves;    
    float lacunarity    = _rLacunarity;
    float frequency     = _rFrequency;
    float amplitude     = _rAmplitude;  
    float gain          = _rGain;
    float offset        = _rOffset;
    float value         = 0.f;

    for( int i = 0; i < octaves; ++ i )
    {
        value += noise( vPt * frequency ) * amplitude;

        amplitude *= gain;
        frequency *= lacunarity;
    }

    return value;
} 
```

# iphone - UIActionsheet Ipad/Iphone

> ID：13690413
> 
> 赞同：2
> 
> 时间：2012-12-03T19:39:07.733
> 
> 标签：iphone, ios, ipad, uiactionsheet

我目前正在为我的通用应用程序使用 UIActionsheet，效果很好，但我希望 iPad 操作表类似于 iPhone 操作表。

iPad 上是否有与 iPhone 操作表类似的内容？或者，有没有办法在没有方向箭头的情况下重新定位 iPad 操作表和弹出视图？

谢谢

编辑：这是我实现和添加操作表的代码

```
adActionSheet = [[UIActionSheet alloc]initWithTitle:@"Title" delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:nil otherButtonTitles:@"Go to Site", @"Some other button", nil];
    [adActionSheet showFromRect:CGRectMake(300, 1150, 200, 200) inView:self.view animated:YES]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:03:54.103

在 iPad 上，操作表会自动显示在弹出窗口中。这是无法改变的。您也不能删除阵列。`UIActionSheet`API 不支持你想要的。

您唯一的解决方案是执行您想要的自定义实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:45:11.557

实际上你可以从 ipad 中的 UIPopover 中删除箭头

```
[self.popoverController presentPopoverFromBarButtonItem:anItem   
                                permittedArrowDirections:0
                                                animated:YES]; 
```

或者

```
[self.popoverViewController presentPopoverFromRect:rect
 inView:self.view  permittedArrowDirections:0 animated:YES]; 
```

零表示没有方向。

# android - Android - 使用帖子时弹出窗口不显示

> ID：13690414
> 
> 赞同：3
> 
> 时间：2012-12-03T19:39:09.730
> 
> 标签：android, popupwindow

当我在没有帖子的情况下调用 showAsDropDown 时（即直接在代码中），我看到了弹出窗口 -

```
PopupWindow w = new PopupWindow(v.getContext());
w.showAsDropDown(v); 
```

但是，当我尝试使用时`v.post()`（无论是否延迟），我都看不到弹出窗口。

```
v.post(new Runnable() {
            @Override
            public void run() {
                w.showAsDropDown(v);
            }
        }); 
```

这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T19:42:31.983

好吧，我觉得很愚蠢，但是我已经找到了问题，并将问题+解决方案留给后代-

问题是我忘记在帖子中调用更新:)

```
v.post(new Runnable() {
            @Override
            public void run() {
                w.showAsDropDown(v);
                w.update(v, 0, 0, LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
            }
        }); 
```

此代码有效。

# c++ - 如何检索 USB 设备接口 GUID？

> ID：13690417
> 
> 赞同：6
> 
> 时间：2012-12-03T19:39:17.767
> 
> 标签：c++, windows, winapi, usb

要获取 HID 设备的 GUID，我知道我可以这样做：

```
GUID myHidGuid;
memset(&myHidGuid, 0, sizeof(GUID)); //allocate
HidD_GetHidGuid(&myHidGuid); //define the HID GUID 
```

是否有类似于 HidD_GetHidGuid() 的函数可以为我提供其他设备类的 GUID？

我正在尝试确定是否连接了 USB 无线网络适配器。我相信我想要 GUID_DEVINTERFACE_NET 但我不知道如何检索它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T21:12:28.650

我认为您没有类似的东西，这些 ClassGuid 由 Microsoft 决定，列表如下：

[http://msdn.microsoft.com/en-us/library/windows/hardware/ff553426(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff553426(v=vs.85).aspx)

[http://msdn.microsoft.com/en-us/library/windows/hardware/ff553428(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff553428(v=vs.85).aspx)

[这个CodeProject 文章](http://www.codeproject.com/Articles/14412/Enumerating-windows-device)就是一个很好的例子。

# objective-c - NSComboBox 动作选择器在 setHidden:YES 时触发

> ID：13690418
> 
> 赞同：1
> 
> 时间：2012-12-03T19:39:23.943
> 
> 标签：objective-c, macos, cocoa, nscombobox, nscontrol

我有一个 NSComboBox。我已经设置了一个动作选择器。当盒子被隐藏时，选择器会触发，即使用户从未接触过它。是的，我需要隐藏它。

```
IBOutlet NSComboBox *comboBox;

[comboBox setAction:@selector(onComboBoxSelection:)];

- (void)onComboBoxSelection:(id)sender
{
   NSLog(@"Why does this fire twice");
   //My code doesn't actually set hidden here, it's just for proof while debugging the issue.
   [comboBox setHidden:YES];
} 
```

为什么隐藏 NSControl 会触发它的选择器？修复它的最佳方法是什么？

**更新：** 我已经通过包装方法来修复它。但我仍然想了解原因或其他解决方法。

```
- (void)onComboBoxSelection:(id)sender
{
   if(![sender isHidden]{
     NSLog(@"Now only fires once");
     //My code doesn't actually set hidden here, it's just for proof while debugging the issue.
     [comboBox setHidden:YES];
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T22:12:59.190

在第二次调用时设置断点`onComboBoxSelection:`并查看回溯（`bt`在调试器中键入以查看回溯）。这将解释发生了什么。

组合框既是文本字段又是弹出窗口，它将触发两者的操作。当编辑结束时触发文本字段动作，或者通过按下 Return 键或者当它退出第一响应者时（例如，跳出到另一个字段）。

当您隐藏组合框时，文本字段将退出第一响应者并触发其操作。

您可能想要做的是检查组合框的值是否实际发生了变化，然后才继续隐藏组合框等。

另一种选择是使用数据绑定来观察组合框的变化。将组合框绑定`value`到控制器上的属性。然后在控制器中实现属性设置器。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-03T19:58:36.660

试试这个`[comboBox setHidden:1];`

# android - Android上的可写和可执行位置

> ID：13690419
> 
> 赞同：17
> 
> 时间：2012-12-03T19:39:25.050
> 
> 标签：android, android-ndk, filesystems

我已经使用 Android NDK 工具链编译了一个二进制文件，并试图将其部署到设备上。然后，使用 JNI 使用 NDK 构建的应用程序将通过本机代码执行此二进制文件。我希望避免生根设备。

该二进制文件将被多个应用程序使用，因此我想将其存储在共享位置，而不是每个应用程序一次。

我找不到合适的位置来部署这个二进制文件 - 这些是我尝试过的地方：

1.  **/mnt/sdcard** - 使用SDK 中的*getExternalStoragePublicDirectory()*，但是 SD 卡安装为 noexec，这意味着我无法运行它。

2.  **/system/bin** - 只读文件系统，所以不能复制。如果我在模拟器上重新挂载 /system ，我可以使用 adb push 推送文件：

    ```
    mount -o rw,remount -t yaffs2 /dev/block/mtd3 /system 
    ```

    但是我想避免这种情况，因为设备需要植根。

3.  **/data/local** - 使用 adb push，我可以将二进制文件推送到这个位置。但是，我似乎找不到在代码中执行此操作的方法（使用 Android SDK）。内部存储机制指向*/data/data/package*。

我使用NDK 工具链附带的*arm-linux-androideabi-g++编译了调用此可执行文件的本机代码。*这适用于*/system/bin*和*/data/local*中的二进制文件。

总之，我正在 Android 文件系统中寻找一个位置，我可以将项目 /assets 文件夹中的文件复制到该位置，该位置可能具有全局可执行权限。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-07-18T11:58:14.353

`/data/local/tmp/`和`"/data/data/" + packageName + "/files"`

对于直接测试您的目标二进制文件，首先是推荐的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-03T23:25:37.720

如果可以使用 adb，则可以准备目录 /data/local/bin 777 权限。

或者，您可以在私有应用程序目录（/data/data/your.package.unique.name/files）中创建一个文件，并将文件权限设置为~~777~~ 755。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T23:30:17.540

如果你想避免生根设备，那么基本上 SD 卡是你唯一可以假设是世界可写的地方

* * *

**编辑**：请注意截至 2014/2015 年 Android 框架的最新变化！。

最好将您的二进制文件作为可安装 APK 的一部分，然后将这个二进制文件从 APK 中提取到私有存储中，使其成为全球可执行文件等，并以某种方式宣布二进制位置，但通常会出现一些问题，具体取决于操作系统版本和供应商

# heroku - 在运行时更改 Heroku rails 上的语言环境

> ID：13690425
> 
> 赞同：0
> 
> 时间：2012-12-03T19:40:07.357
> 
> 标签：heroku, localization, ruby-on-rails-3.2

我的开发环境允许我通过设置更改控制器中的应用程序区域设置

```
I18n.locale = 'fr' 
```

它适用于我笔记本电脑上的 dev 和 prod 环境，但如果我将它部署在 Heroku 上，它就不再有效，就好像这些更改被忽略了一样。有人可能知道为什么？

ps：如果我在初始化程序中预设了 default_locale，则站点的两个版本（在我的情况下为英语和法语）都可以工作。但是运行时的切换不会

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T05:44:45.833

问题与此无关。我未能解释我正在 Spree 上构建一个应用程序，并且它们的本地化工作基于该`session[:locale]`变量。我必须先设置它。

# sql - 使用动态 SQL 返回字符串

> ID：13690426
> 
> 赞同：1
> 
> 时间：2012-12-03T19:40:07.960
> 
> 标签：sql, sql-server

我正在使用 SQL Server 2008，并且我有一个`@sqlFinal`类型为`Varchar(500)`.

我在存储过程运行时填充变量。我想动态返回字符串中的内容以显示结果

```
SELECT @sqlFinal = 'SELECT @Error_Return AS Final_Report'
--PRINT @sqlFinal
EXEC (@sqlFinal) 
```

但我收到以下错误

> *Msg 137, Level 15, State 2, Line 1
> 必须声明标量变量“@Error_Return”。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:06:58.500

我假设@Error_Return 与@SqlFinal 在同一范围内？

如果你只需要返回@Error_Return 的内容，你可以只执行这一行：

```
SELECT @Error_Return as Final_Report 
```

...使其成为静态 SQL 行而不是动态行。

但如果这不可接受，您可能不得不改用 sp_executeSQL。这允许您将变量传递给正在执行的行。

```
Declare @Error_Return VARCHAR(10)
Set @Error_return= 'Whatever'

exec sp_executesql N'SELECT @Error_Return as Final_Report', N'@Error_Return varchar(10)', @Error_Return 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:12:41.660

该`EXEC()`函数创建一个*新*的执行范围。在当前作用域中定义的变量，如 @Error_Return，在 Exec() 函数中将不可用。改为查看[sp_executesql](http://msdn.microsoft.com/en-us/library/ms188001.aspx)。

# postgresql - Postgresql：如何在 Mac 上检查用户名和（忘记的）密码？

> ID：13690432
> 
> 赞同：0
> 
> 时间：2012-12-03T19:40:38.000
> 
> 标签：postgresql

嗨，我试过四处寻找答案，但不知道如何访问我本地机器的 postgresql 用户名和密码。在命令行和 bash 等方面，我是个大菜鸟，所以请帮忙。有人可以帮我找出 Mac 上 postgres 的用户名和密码吗？

```
Edmunds-MacBook-Pro:postgres edmundmai$ psql -d db -U postgres
Password for user postgres: 
psql: FATAL:  password authentication failed for user "postgres" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:45:44.240

我不知道从 PostgreSQL 恢复密码的方法。但是，如果您添加`local all all trust`到您的 pg_hba.conf 文件，它将允许您从本地计算机登录集群而无需密码。更改完成后，重启服务器使其生效，然后您就可以登录并更改密码了。完成后，请务必从 pg_hba.conf 中删除此行并重新启动服务器，因为这不是特别安全。

# android - 为什么我的动画不会在 to-x 给定值处停止？

> ID：13690444
> 
> 赞同：1
> 
> 时间：2012-12-03T19:41:28.473
> 
> 标签：android, animation, view

我想在触摸时移动一个视图，当用户松开这个视图时，它会启动一个动画，将我的视图移动到其父视图的末尾。

这是我的布局：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/time_view"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

<AbsoluteLayout
    android:id="@+id/slide_layout"
    android:layout_width="match_parent"
    android:layout_height="50dp"
    android:layout_alignParentBottom="true"
    android:layout_margin="20dp"
    android:background="#0000FF" >

    <View
        android:id="@+id/slide_to_pause"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:background="#00FFFF" />
</AbsoluteLayout>
</RelativeLayout> 
```

这就是我将视图设置为在我的 onCreate 中移动的方式：

```
slideView = ((View) findViewById(R.id.slide_to_pause));
slideView.setOnTouchListener(this); 
```

这就是我移动视图并启动动画的方式：

```
@Override
public boolean onTouch(View view, MotionEvent event) {
    AbsoluteLayout.LayoutParams layoutParams = (AbsoluteLayout.LayoutParams) view.getLayoutParams();

    switch (event.getAction() & MotionEvent.ACTION_MASK) {

    case MotionEvent.ACTION_DOWN:
        mX = event.getRawX();
        break;

    case MotionEvent.ACTION_UP:
        int endOfAnimation = findViewById(R.id.slide_layout).getWidth() - view.getWidth();
        mSlideAnimation = new TranslateAnimation(0, endOfAnimation - layoutParams.x, 0, 0);
        mSlideAnimation.setDuration(1000);          
        view.startAnimation(mSlideAnimation);
        Log.d(TAG, "endOfAnimation = " + layoutParams.x + " | " + endOfAnimation);
        break;

    case MotionEvent.ACTION_MOVE:
        layoutParams.x = (int) event.getRawX();         
        view.setLayoutParams(layoutParams); 

        break;
    }
    return true;
} 
```

问题是当视图到达末尾时，它会回到屏幕中间的一个点，这是用户松开视图的点。我怎样才能解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:06:39.903

你需要使用

```
mSlideAnimation.setFillAfter(true); 
```

使其不会恢复到开始。

如果这不起作用，您可能必须遵循[Animation.setFillAfter/Before 上的建议 - 它们是否有效/它们有什么用？](https://stackoverflow.com/questions/5886624/animation-setfillafter-before-do-they-work-what-are-they-for)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:00:14.897

您可以使用手动模拟动画（自己移动视图，无需动画框架）

```
View.offsetLeftAndRight(int offset)
View.offsetTopAndBottom(int offset) 
```

# mysql - 更新 mysql 并设置信息块

> ID：13690446
> 
> 赞同：1
> 
> 时间：2012-12-03T19:41:32.100
> 
> 标签：mysql, perl

我正在尝试运行一个更新，它根据多个变量为 varchar 分配一个巨大的数据块。这是我的 sql 代码示例：

```
 'update details set full = "Miles reported by $name - $empname - $deptname\n\n"
 "Total Miles in $month: $dailytotal\n"
 "Total Business Miles in $month: $busitotal\n"
 "Total Personal Miles in $month: $perstotal\n\n"
  "$month 1: START: $start1...STOP: $stop1...DAILY: $daily1...BUSINESS: $busi1...PERSONAL: $personal1\n"
  "$month 2: START: $start2...STOP: $stop2...DAILY: $daily2...BUSINESS: $busi2...PERSONAL: $personal2\n"
  ')
    or die "Could not prepare sql statement"; 
```

效果很好，但问题在于它将变量存储为“$name”，而不是 $name 与所有其他变量一样。我该如何解决这个问题，并对我的格式感到抱歉。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:01:29.500

正确答案已经给出，我只是想补充一点，您可以使用该`qq()`函数轻松插入变量。它也很容易与较长的字符串一起使用，因为您可以更改分隔符。你会这样做：

```
qq(update details set full = "Miles reported by $name - $empname - $deptname\n\n"
"Total Miles in $month: $dailytotal\n"
"Total Business Miles in $month: $busitotal\n"
"Total Personal Miles in $month: $perstotal\n\n"
"$month 1: START: $start1...STOP: $stop1...DAILY: $daily1...BUSINESS: $busi1...PERSONAL: $personal1\n"
"$month 2: START: $start2...STOP: $stop2...DAILY: $daily2...BUSINESS: $busi2...PERSONAL: $personal2\n"); 
```

当我说更改分隔符时，如果您有这样的字符串，那会派上用场：

```
foo(bar) 
```

然后，您可以使用，例如，`qq//`避免转义括号：

```
qq/foo(bar)/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:45:37.497

您在字符串周围使用单引号，因此变量和其他转义序列不会按照您希望的方式进行解释。请参阅此处的 PHP 文档：

[http://php.net/manual/en/language.types.string.php](http://php.net/manual/en/language.types.string.php)

同样在您的情况下，您应该在要插入的整个字段周围放置单引号。为了便于阅读代码，并让行返回您想要的方式，我强烈建议您在变量中设置字符串值并在查询中使用该变量，如下所示：

```
$insert_string = "Miles reported by $name - $empname - $deptname\n\n".
"Total Miles in $month: $dailytotal\n".
"Total Business Miles in $month: $busitotal\n".
"Total Personal Miles in $month: $perstotal\n\n".
"$month 1: START: $start1...STOP: $stop1...DAILY: $daily1...BUSINESS: $busi1...PERSONAL: $personal1\n".
"$month 2: START: $start2...STOP: $stop2...DAILY: $daily2...BUSINESS: $busi2...PERSONAL: $personal2\n";
$query = "UPDATE details SET full = '$insert_string'"; 
```

也不是您的`UPDATE`查询将为`full`表中的每条记录设置此字符串的值。我不知道这是否是有意的（我猜不是因为这似乎是特定月份的记录）。如果您只想更新单个记录或记录子集，则需要`WHERE`在查询中添加一个子句。

# flash - Channel.Security.Error 错误 错误 #2048 url: 'http://localhost/flex2gateway/'

> ID：13690447
> 
> 赞同：1
> 
> 时间：2012-12-03T19:41:34.473
> 
> 标签：flash, apache-flex, adobe, builder

这是我尝试在 ColdFusion 所在的服务器或同一网络上的另一台计算机上运行 Adob​​e Flash Builder 应用程序时收到的错误消息。我编辑了 cross domain.xml 文件以包含正确的域，但仍然出现错误。我在这里尝试了许多类似问题的解决方案，但我一直收到同样的错误。如何让这个错误消失？

这是完整的错误消息：

`Send failed Channel.Security.Error error Error #2048 url: 'http://localhost/flex2gateway/'`

我安装了 Charles Proxy，这就是我收到错误的原因：

`URL: http://localhost/crossdomain.xml Status: Failed Failure: Connect: Connection Refused`

如何将其从“localhost”更改为服务器的 IP 地址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T12:41:56.187

您可以使用 Charles 或 HTTPAnalyzer 查看是否以及在何处请求了新的 crossdomain.xml 文件。如果您使用多台服务器，很容易将 crossdomain.xml 放在错误的位置。

# c# - XNA + HLSL 高斯模糊产生偏移伪影

> ID：13690448
> 
> 赞同：2
> 
> 时间：2012-12-03T19:41:35.580
> 
> 标签：c#, hlsl, gaussian, resampling

所以我在 XNA（3.1。是的，我知道它已经非常过时了。是的，我有理由使用它）和 HLSL 中构建了一个下采样算法。本质上，它的工作原理是对原始纹理应用高斯模糊，然后使用内置于 XNA 中的默认最近邻重新缩放来调整其大小。我的想法是，高斯模糊会给出一个颜色区域平均值的近似值，因此它本质上是一种减少混叠的廉价方法。它工作得很好，而且速度很快，但会产生一些有趣的伪影——它似乎略微拉伸了图像。这通常不明显，但我下采样的一些东西是精灵表，当动画时，很明显精灵没有放在正确的位置。我' 我想知道一个不同的重采样器（也内置在 HLSL 中以提高 GPU 的速度）可能是一个更好的选择，或者我可以修复这个错误。我会把我的代码贴在这里，看看有没有人可以启发我。

首先是我的 HLSL 高斯效果文件：

```
#define RADIUS  7
#define KERNEL_SIZE (RADIUS * 2 + 1)

float weightX[KERNEL_SIZE];
float weightY[KERNEL_SIZE];
float2 offsetH[KERNEL_SIZE];
float2 offsetV[KERNEL_SIZE];

texture colorMapTexture;

sampler TextureSampler : register(s0);

void BlurH(inout float4 color : COLOR0, float2 texCoord : TEXCOORD0)
{
    float4 c = float4(0.0f, 0.0f, 0.0f, 0.0f);

    for (int i = 0; i < KERNEL_SIZE; ++i)
        c += tex2D(TextureSampler, texCoord + offsetH[i]) * weightX[i];

        color = c;
}

void BlurV(inout float4 color : COLOR0, float2 texCoord : TEXCOORD0)
{
    float4 c = float4(0.0f, 0.0f, 0.0f, 0.0f);

    for (int i = 0; i < KERNEL_SIZE; ++i)
        c += tex2D(TextureSampler, texCoord + offsetV[i]) * weightY[i];

        color = c;
}

technique GaussianBlur
{
    pass
    {
        PixelShader = compile ps_2_0 BlurH();
    }
    pass
    {
        PixelShader = compile ps_2_0 BlurV();
    }
} 
```

还有我初始化高斯效应的代码（注意 gaussianBound 设置为 8，即 1+ HLSL 文件中的半径）：

```
 public static Effect GaussianBlur(float amount, float radx, float rady, Point scale)
        {
            Effect rtrn = gaussianblur.Clone(MainGame.graphicsManager.GraphicsDevice);

            if (radx >= gaussianBound)
            {
                radx = gaussianBound - 0.000001F;
            }
            if (rady >= gaussianBound)
            {
                rady = gaussianBound - 0.000001F;
            }
            //If blur is too great, image becomes transparent,
            //so cap how much blur can be used.
            //Reduces quality of very small images.

            Vector2[] offsetsHoriz, offsetsVert;
            float[] kernelx = new float[(int)(radx * 2 + 1)];
            float sigmax = radx / amount;
            float[] kernely = new float[(int)(rady * 2 + 1)];
            float sigmay = rady / amount;
            //Initialise kernels and sigmas (separately to allow for different scale factors in x and y)

            float twoSigmaSquarex = 2.0f * sigmax * sigmax;
            float sigmaRootx = (float)Math.Sqrt(twoSigmaSquarex * Math.PI);
            float twoSigmaSquarey = 2.0f * sigmay * sigmay;
            float sigmaRooty = (float)Math.Sqrt(twoSigmaSquarey * Math.PI);
            float totalx = 0.0f;
            float totaly = 0.0f;
            float distance = 0.0f;
            int index = 0;
            //Initialise gaussian constants, as well as totals for normalisation.

            offsetsHoriz = new Vector2[kernelx.Length];
            offsetsVert = new Vector2[kernely.Length];

            float xOffset = 1.0f / scale.X;
            float yOffset = 1.0f / scale.Y;
            //Set offsets for use in the HLSL shader.

            for (int i = -(int)radx; i <= radx; ++i)
            {
                distance = i * i;
                index = i + (int)radx;
                kernelx[index] = (float)Math.Exp(-distance / twoSigmaSquarex) / sigmaRootx;
                //Set x kernel values with gaussian function.
                totalx += kernelx[index];
                offsetsHoriz[index] = new Vector2(i * xOffset, 0.0f);
                //Set x offsets.
            }

            for (int i = -(int)rady; i <= rady; ++i)
            {
                distance = i * i;
                index = i + (int)rady;
                kernely[index] = (float)Math.Exp(-distance / twoSigmaSquarey) / sigmaRooty;
                //Set y kernel values with gaussian function.
                totaly += kernely[index];
                offsetsVert[index] = new Vector2(0.0f, i * yOffset);
                //Set y offsets.
            }

            for (int i = 0; i < kernelx.Length; ++i)
                kernelx[i] /= totalx;

            for (int i = 0; i < kernely.Length; ++i)
                kernely[i] /= totaly;

            //Normalise kernel values.

            rtrn.Parameters["weightX"].SetValue(kernelx);
            rtrn.Parameters["weightY"].SetValue(kernely);
            rtrn.Parameters["offsetH"].SetValue(offsetsHoriz);
            rtrn.Parameters["offsetV"].SetValue(offsetsVert);
            //Set HLSL values.

            return rtrn;
        } 
```

除此之外，我的函数只是简单地在每次通过效果时绘制到纹理，然后将结果绘制到不同比例的新纹理。这看起来真的很好，但正如我所说，会产生这些不正确的东西的人工制品。一些帮助在这里将不胜感激。

![文物展示](../Images/63092c3b6d4f45f3a6573bf493f40eb9.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T18:06:45.407

好吧，我发现了一些东西：它与高斯模糊无关。问题是我正在缩小最近邻，它会由于数据丢失而产生这些伪影（例如，当某些东西需要基本上位于像素 5.5 时，它只是将其放在像素 5 处，从而产生位置错误） . 感谢所有试图帮助解决此问题的人，但看起来我只需要稍微重新考虑我的算法。

我通过添加一个额外的约束来修复它，即重采样仅适用于整数重采样。其他任何东西都会重新采样到最接近的可用整数样本，然后用 NN 缩放其余部分。这几乎和我之前的工作完全一样，但现在由于 HLSL 快了很多。我希望得到一个任意的缩放算法，但它足以满足我的需要。它并不完美，因为我仍然遇到偏移错误（由于数据丢失，在下采样时几乎不可能完全避免），但它们现在明显小于一个像素，因此除非你正在寻找，否则不会引起注意他们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T12:15:18.113

我有些疑惑。第二遍应该使用第一遍的结果。否则，您可以将 BlurH 和 BlurV 组合在一起，结果将是相同的。我没有找到任何使用第一遍结果或将其从第一遍传递到第二遍的代码。

# asp.net-mvc - Kendo: Grid/Ajax - 发布客户端模板？

> ID：13690450
> 
> 赞同：0
> 
> 时间：2012-12-03T19:41:43.777
> 
> 标签：asp.net-mvc, kendo-ui

我在 MVC4 中有一个运行良好的剑道网格：

```
Html.Kendo().Grid<SearchUserResultViewModel>()
  .Name("Grid")
  .Columns(columns =>
      {
          columns.Bound(p => p.UserLoginId);
          columns.Bound(p => p.AppUserName);
          columns.Bound(p => p.AppUserStatus);
          columns.Bound(p => p.AppUserGUID).ClientTemplate(
          "<a href='" + Url.Action("EditUser", "Edit") +  "/#= AppUserGUID #'" + ">Modify</a>");
      })
  .DataSource(dataSource => dataSource
      .Ajax()
      .Read(read => read.Action("SearchUser_Read", "Search").Data("parentModel"))
  )
  .Pageable() 
```

但是，我希望用户在单击字段 AppUserGUID 时导致发布，而不是获取。那可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:18:01.990

更改列客户端模板如下：

```
<form action="@Url.Action("EditUser", "Edit")">
Html.Kendo().Grid<SearchUserResultViewModel>()
  .Name("Grid")
  .Columns(columns =>
      {
          columns.Bound(p => p.UserLoginId);
                  columns.Bound(p => p.AppUserName);
                  columns.Bound(p => p.AppUserStatus);
                  columns.Bound(p => p.AppUserGUID).ClientTemplate(
                  "<input type="submit" value="Modify"/>");
      })
  .DataSource(dataSource => dataSource
      .Ajax()
      .Read(read => read.Action("SearchUser_Read", "Search").Data("parentModel"))
  )
  .Pageable()

    </form> 
```

您还必须使用 from 标记包装网格。

# c - 从 xmlNode 获取源文件名？

> ID：13690451
> 
> 赞同：3
> 
> 时间：2012-12-03T19:41:48.240
> 
> 标签：c, libxml2

在 libxml2 中，我可以轻松找到 an`xmlNode`来自 ( `xmlNode::line`) 的源代码行，但我看不到如何找到它来自的文件的名称。这在加载的文档包含 XInclude 指令时特别有用。虽然我可以考虑手动处理此问题的方法（`xml:base`在给定节点上方查找属性；手动存储文件名并使用它，如果`xml:base`未设置），我宁愿使用 libxml2 中内置的东西。

是否有用于检索`xmlNode`加载任何给定对象的文件名的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T20:57:31.180

看起来不像。[xmlDocPtr](http://xmlsoft.org/html/libxml-tree.html#xmlDoc)的文档说这`name`是“文档的名称/文件名/U​​RI”，但这并没有在我的测试中填充`xmlReadFile`.

查看代码，文件名似乎没有保存在文档中，解析器上下文在 parser.c 的末尾消失了`xmlDoRead()`。

# mongodb - java.lang.NoClassDefFoundError: com/mongodb/ServerAddress

> ID：13690453
> 
> 赞同：2
> 
> 时间：2012-12-03T19:41:52.437
> 
> 标签：mongodb, jpa-2.0, eclipselink, java-ee-6, glassfish-3

我有一个带有 eclipselink 和 mongodb 的 jee6 应用程序。我使用 nosql 扩展 org.eclipse.persistence.nosql

当我在本地 glassfish 实例上部署我的应用程序时，一切正常。

当我在远程 glassfish 上部署应用程序时，出现以下错误

glassfish 版本在两个位置都相同 mongodb 驱动程序 jar 在 WEB-INF/lib 中

但是在远程服务器上我得到了一个`"java.lang.NoClassDefFoundError: com/mongodb/ServerAddress"`

问题出在哪里 ？？？

```
[#|2012-12-03T19:19:36.281+0000|CONFIG|glassfish3.1.2|org.eclipse.persistence.session.file:/usr/glassfish3/glassfish3/glassfish/domains/domain1/applications/ForecastWebApp-0.0.1-SNAPSHOT/WEB-INF/classes/_forecastMongoDB.connection|_ThreadID=1306;_ThreadName=Thread-2;|connecting(EISLogin(
        platform=> MongoPlatform
        user name=> ""
        MongoConnectionSpec()
))|#]

[#|2012-12-03T19:19:36.288+0000|SEVERE|glassfish3.1.2|org.eclipse.persistence.session.file:/usr/glassfish3/glassfish3/glassfish/domains/domain1/applications/ForecastWebApp-0.0.1-SNAPSHOT/WEB-INF/classes/_forecastMongoDB.ejb|_ThreadID=1306;_ThreadName=Thread-2;|java.lang.NoClassDefFoundError: com/mongodb/ServerAddress
        at org.eclipse.persistence.internal.nosql.adapters.mongo.MongoConnectionFactory.getConnection(MongoConnectionFactory.java:74)
        at org.eclipse.persistence.eis.EISConnectionSpec.connectToDataSource(EISConnectionSpec.java:150)
        at org.eclipse.persistence.nosql.adapters.mongo.MongoConnectionSpec.connectToDataSource(MongoConnectionSpec.java:150)
        at org.eclipse.persistence.eis.EISLogin.connectToDatasource(EISLogin.java:73)
        at org.eclipse.persistence.internal.databaseaccess.DatasourceAccessor.connectInternal(DatasourceAccessor.java:330)
        at org.eclipse.persistence.internal.databaseaccess.DatasourceAccessor.connect(DatasourceAccessor.java:418)
        at org.eclipse.persistence.sessions.server.ConnectionPool.buildConnection(ConnectionPool.java:216)
        at org.eclipse.persistence.sessions.server.ConnectionPool.startUp(ConnectionPool.java:504)
        at org.eclipse.persistence.sessions.server.ServerSession.connect(ServerSession.java:484)
        at org.eclipse.persistence.internal.sessions.DatabaseSessionImpl.login(DatabaseSessionImpl.java:734)
        at org.eclipse.persistence.internal.jpa.EntityManagerFactoryProvider.login(EntityManagerFactoryProvider.java:217)
        at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.deploy(EntityManagerSetupImpl.java:542)
        at org.eclipse.persistence.internal.jpa.EntityManagerFactoryDelegate.getDatabaseSession(EntityManagerFactoryDelegate.java:186)
        at org.eclipse.persistence.internal.jpa.EntityManagerFactoryDelegate.createEntityManagerImpl(EntityManagerFactoryDelegate.java:278)
        at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManagerImpl(EntityManagerFactoryImpl.java:304)
        at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:282)
        at org.glassfish.persistence.jpa.PersistenceUnitLoader.loadPU(PersistenceUnitLoader.java:211)
        at org.glassfish.persistence.jpa.PersistenceUnitLoader.<init>(PersistenceUnitLoader.java:120) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T09:22:20.360

好的，我发现了问题

org.eclipse.persistence.nosql_2.4.1.v20121003-ad44345.jar 和 mongodb 驱动程序 jar 在 /WEB-INF/lib

但在远程服务器 `org.eclipse.persistence.nosql_2.4.1.v20121003-ad44345.jar` 上，`../glassfish/modules directory` 但这里没有 mongodb 驱动程序

当我`org.eclipse.persistence.nosql_2.4.1.v20121003-ad44345.jar` 从`../glassfish/modules directory`

或者

添加mongodb驱动jar到`../glassfish/modules directory`

一切正常

# c++ - 如何直接从内存编译执行？

> ID：13690454
> 
> 赞同：60
> 
> 时间：2012-12-03T19:41:53.350
> 
> 标签：c++, linux

是否可以在不生成可执行文件但直接从内存中写入和执行的情况下编译 C++（或类似）程序？

例如，使用`GCC`and `clang`，其效果类似于：

```
c++ hello.cpp -o hello.x && ./hello.x $@ && rm -f hello.x 
```

在命令行中。

但是没有将可执行文件写入磁盘以立即加载/重新运行它的负担。

（如果可能，该过程可能不使用磁盘空间或至少不使用当前目录中可能是只读的空间）。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-12-04T11:40:44.197

Possible? Not the way you seem to wish. The task has two parts:

## 1) How to get the binary into memory

When we specify `/dev/stdout` as output file in Linux we can then pipe into our program `x0` that reads an executable from stdin and executes it:

```
 gcc -pipe YourFiles1.cpp YourFile2.cpp -o/dev/stdout -Wall | ./x0 
```

In `x0` we can just read from stdin until reaching the end of the file:

```
int main(int argc, const char ** argv)
{
    const int stdin = 0;
    size_t ntotal = 0;
    char * buf = 0;
    while(true)
    {
        /* increasing buffer size dynamically since we do not know how many bytes to read */
        buf = (char*)realloc(buf, ntotal+4096*sizeof(char));
        int nread = read(stdin, buf+ntotal, 4096); 
        if (nread<0) break;
        ntotal += nread;
    }
    memexec(buf, ntotal, argv); 
} 
```

It would also be possible for `x0` directly execute the compiler and read the output. This question has been answered here: [Redirecting exec output to a buffer or file](https://stackoverflow.com/questions/2605130/redirecting-exec-output-to-a-buffer-or-file)

*Caveat:* I just figured out that for some strange reason this does not work when I use pipe `|` but works when I use the `x0 < foo`.

*Note:* If you are willing to modify your compiler or you do JIT like LLVM, clang and other frameworks you could directly generate executable code. However for the rest of this discussion I assume you want to use an existing compiler.

## Note: Execution via temporary file

Other programs such as UPX achieve a similar behavior by executing a temporary file, this is easier and more portable than the approach outlined below. On systems where `/tmp` is mapped to a RAM disk for example typical servers, the temporary file will be memory based anyway.

```
#include<cstring> // size_t
#include <fcntl.h>
#include <stdio.h> // perror
#include <stdlib.h> // mkostemp
#include <sys/stat.h> // O_WRONLY
#include <unistd.h> // read
int memexec(void * exe, size_t exe_size, const char * argv)
{
    /* random temporary file name in /tmp */
    char name[15] = "/tmp/fooXXXXXX"; 
    /* creates temporary file, returns writeable file descriptor */
    int fd_wr = mkostemp(name,  O_WRONLY);
    /* makes file executable and readonly */
    chmod(name, S_IRUSR | S_IXUSR);
    /* creates read-only file descriptor before deleting the file */
    int fd_ro = open(name, O_RDONLY);
    /* removes file from file system, kernel buffers content in memory until all fd closed */
    unlink(name);
    /* writes executable to file */
    write(fd_wr, exe, exe_size);
    /* fexecve will not work as long as there in a open writeable file descriptor */
    close(fd_wr);
    char *const newenviron[] = { NULL };
    /* -fpermissive */
    fexecve(fd_ro, argv, newenviron);
    perror("failed");
} 
```

*Caveat:* Error handling is left out for clarities sake. Includes for sake of brevity.

*Note:* By combining step `main()` and `memexec()` into a single function and using `splice(2)` for copying directly between `stdin` and `fd_wr` the program could be significantly optimized.

## 2) Execution directly from memory

One does not simply load and execute an [ELF](http://linux.die.net/man/5/elf) binary from memory. Some preparation, mostly related to dynamic linking, has to happen. There is a lot of material explaining the various steps of the ELF linking process and studying it makes me believe that *theoretically* possible. See for example this closely related [question on SO](https://stackoverflow.com/questions/4911993/how-to-generate-and-run-native-code-dynamically) however there seems not to exist a working solution.

**Update** UserModeExec seems to come very close.

Writing a working implementation would be very time consuming, and surely raise some interesting questions in its own right. I like to believe this is by design: for most applications it is strongly undesirable to (accidentially) execute its input data because it allows [code injection](http://www.codeproject.com/Articles/33340/Code-Injection-into-Running-Linux-Application).

What happens exactly when an ELF is executed? Normally the kernel receives a file name and then creates a process, loads and maps the different sections of the executable into memory, performs a lot of sanity checks and marks it as executable before passing control and a file name back to the run-time linker `ld-linux.so` (part of libc). The takes care of relocating functions, handling additional libraries, setting up global objects and jumping to the executables entry point. AIU this heavy lifting is done by `dl_main()` (implemented in libc/elf/rtld.c).

Even `fexecve` is implemented using a file in `/proc` and it is this need for a file name that leads us to reimplement parts of this linking process.

Libraries

*   [UserModeExec](http://plash.beasts.org/wiki/UserModeExec)
*   [libelf](http://www.mr511.de/software/) -- read, modify, create ELF files
*   [eresi](http://www.eresi-project.org/) -- play with elfes
*   [OSKit](http://www.cs.utah.edu/flux/oskit/) (seems like a dead project though)

Reading

*   [http://www.linuxjournal.com/article/1060?page=0,0](http://www.linuxjournal.com/article/1060?page=0,0) -- introduction
*   [http://wiki.osdev.org/ELF](http://wiki.osdev.org/ELF) -- good overview
*   [http://s.eresi-project.org/inc/articles/elf-rtld.txt](http://s.eresi-project.org/inc/articles/elf-rtld.txt) -- more detailed Linux-specific explanation
*   [http://www.codeproject.com/Articles/33340/Code-Injection-into-Running-Linux-Application](http://www.codeproject.com/Articles/33340/Code-Injection-into-Running-Linux-Application) -- how to get to hello world
*   [http://www.acsu.buffalo.edu/~charngda/elf.html](http://www.acsu.buffalo.edu/~charngda/elf.html) -- nice reference of ELF structure
*   [Loaders and Linkers by John Levine](http://www.iecc.com/linker/) -- deeoer explanation of linking

Related Questions at SO

*   [Linux user-space ELF loader](https://stackoverflow.com/questions/1784495/linux-user-space-elf-loader)
*   [ELF Dynamic loader symbol lookup ordering](https://stackoverflow.com/questions/12666248/elf-dynamic-loader-symbol-lookup-ordering)
*   [load-time ELF relocation](https://stackoverflow.com/questions/1349120/load-time-elf-relocation)
*   [How do global variables get initialized by the elf loader](https://stackoverflow.com/questions/2649333/how-do-global-variables-get-initialized-by-the-elf-loader)

So it seems possible, you decide whether is also practical.

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-12-03T19:48:52.747

是的，尽管正确执行此操作需要考虑到这一点来设计编译器的重要部分。LLVM 人已经做到了这一点，首先使用了一个独立的 JIT，然后使用了[MC](http://blog.llvm.org/2010/04/intro-to-llvm-mc-project.html)子项目。我认为没有现成的工具可以做到这一点。但原则上，它只是链接到 clang 和 llvm，将源传递给 clang，并将它创建的 IR 传递给 MCJIT 的问题。也许一个演示可以做到这一点（我隐约记得一个像这样工作的基本 C 解释器，尽管我认为它是基于遗留 JIT 的）。

编辑：找到我记得的[演示。](http://llvm.org/viewvc/llvm-project/cfe/trunk/examples/clang-interpreter/)此外，还有[cling](http://root.cern.ch/drupal/content/cling)，这似乎基本上符合我的描述，但更好。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-12-03T19:44:36.780

Linux 可以使用[tempfs](http://en.wikipedia.org/wiki/Tmpfs)在 RAM 中创建虚拟文件系统。例如，我`tmp`在文件系统表中设置了我的目录，如下所示：

```
tmpfs       /tmp    tmpfs   nodev,nosuid    0   0 
```

使用它，我放入的任何文件`/tmp`都存储在我的 RAM 中。

Windows 似乎没有任何“官方”的方式来做到这一点，但有很多[第三方选项](http://en.wikipedia.org/wiki/List_of_RAM_drive_software#Microsoft_Windows)。

如果没有这个“RAM 磁盘”概念，您可能必须大量修改编译器和链接器才能完全在内存中运行。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-12-04T06:10:50.940

如果您不是特别依赖于 C++，您还可以考虑其他基于 JIT 的解决方案：

*   在 Common Lisp 中，[SBCL](http://www.sbcl.org/)能够动态生成机器代码
*   您可以使用 TinyCC 及其`libtcc.a`从内存中的 C 代码中快速发出较差（即未优化）的机器代码。
*   还可以考虑任何 JITing 库，例如[libjit](http://www.gnu.org/software/dotgnu/libjit-doc/libjit.html)、 GNU [Lightning](http://www.gnu.org/software/lightning/)、[LLVM](http://llvm.org/)、[GCCJIT](https://gcc.gnu.org/onlinedocs/jit/)、[asmjit](http://code.google.com/p/asmjit/)
*   当然在一些 tmpfs 上发出 C++ 代码并编译它......

但是，如果您想要好的机器代码，则需要对其进行优化，这并不快（因此写入文件系统的时间可以忽略不计）。

如果你依赖于 C++ 生成的代码，你需要一个好的 C++ 优化编译器（例如`g++`或`clang++`）；他们需要花费大量时间将 C++ 代码编译为优化的二进制文件，因此您应该生成某个文件`foo.cc`（可能在像 some 这样的 RAM 文件系统中`tmpfs`，但这会带来很小的收益，因为大部分时间都花在内部`g++`或`clang++`优化通过，而不是从磁盘读取），然后将其编译`foo.cc`为`foo.so`（也许使用`make`，或者至少使用 forking `g++ -Wall -shared -O2 foo.cc -o foo.so`，也许使用其他库）。最后让你的主程序`dlopen`生成`foo.so`. FWIW，[MELT](http://starynkevitch.net/Basile/gcc-melt/)正是这样做的，在 Linux 工作站上，[manydl.c](https://github.com/bstarynk/misc-basile/blob/master/manydl.c)程序显示一个进程可以生成然后[dlopen(3)](https://man7.org/linux/man-pages/man3/dlopen.3.html)数十万个临时插件，每个插件都是通过生成一个临时 C 文件并编译它来获得的。对于 C++，请阅读[C++ dlopen mini HOWTO](https://tldp.org/HOWTO/html_single/C++-dlopen/)。

^(或者，生成一个独立的源程序`foobar.cc`，将其编译为可执行文件，`foobarbin`例如`g++ -O2 foobar.cc -o foobarbin`使用`execve`该`foobarbin`可执行二进制文件执行)

在生成 C++ 代码时，您可能希望避免生成微小的 C++ 源文件（例如，仅十几行；如果可能，至少生成几百行的 C++ 文件；除非`template`通过大量使用现有 C++[容器](https://en.cppreference.com/w/cpp/container)进行大量扩展，其中生成一个将它们组合起来的小型 C++ 函数是有意义的）。例如，尽可能尝试将多个生成的 C++ 函数放在同一个生成的 C++ 文件中（但避免生成非常大的 C++ 函数，例如在单个函数中包含 10KLOC；它们需要很长时间才能被 GCC 编译）。如果相关，您可以考虑在生成的 C++ 文件中只有一个`#include`，并预编译通常包含的头文件。

[雅克·皮特拉 (Jacques Pitrat](https://en.wikipedia.org/wiki/Jacques_Pitrat) ) 的书《*人造人，有意识的机器的良心》* (ISBN 9781848211018) 详细解释了为什么在运行时生成代码是有用的（在像他的 CAIA 系统这样的符号人工智能系统中）。RefPerSys项目试图遵循这个想法，并在[运行](http://refpersys.org/)时生成一些 C++ 代码（希望越来越多）。[**部分评价**](https://en.wikipedia.org/wiki/Partial_evaluation)是一个相关概念。

您的软件在生成 C++ 代码时花费的 CPU 时间可能比在编译时花费更多的[GCC时间。](https://gcc.gnu.org/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-07T01:23:30.030

可以轻松地修改编译器本身。这听起来很难，但仔细想想，它接缝很明显。因此，修改编译器源代码直接公开一个库并使其成为共享库不应该花太多钱（取决于实际实现）。

只需用内存映射文件的解决方案替换每个文件访问。

这是我要做的事情，在后台透明地编译一些东西来操作代码并从 Java 中执行这些代码。

-

但是考虑到您最初的问题，您希望加快编译以及您的编辑和运行周期。首先获得一个 SSD 磁盘，您几乎可以获得内存速度（使用 PCI 版本），并且可以说它是我们正在谈论的 C。C 执行此链接步骤会导致非常复杂的操作，这些操作可能比从磁盘读取和写入磁盘花费更多时间。因此，只需将所有内容都放在 SSD 上并忍受滞后。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-09-16T07:25:10.563

tcc 编译器“-run”选项允许这样做，编译到内存中，在那里运行，最后丢弃编译的东西。不需要文件系统空间。"tcc -run" 可用于 shebang 以允许 C 脚本，来自 tcc 手册页：

```
#!/usr/local/bin/tcc -run
#include <stdio.h>

int main()
{
    printf("Hello World\n");
    return 0;
} 
```

[C 脚本](https://www.raspberrypi.org/forums/viewtopic.php?f=33&p=1913980#p1912584)允许混合 bash/C 脚本，“tcc -run”不需要任何临时空间：

```
#!/bin/bash

echo "foo"
sed -n "/^\/\*\*$/,\$p" $0 | tcc -run -

exit
/**
*/
#include <stdio.h>

int main()
{
    printf("bar\n");
    return 0;
} 
```

执行输出：

```
$ ./shtcc2
foo
bar
$ 
```

带有 gcc 的 C 脚本也是可能的，但需要像其他提到的那样临时空间来存储可执行文件。此脚本产生与前一个相同的输出：

```
#!/bin/bash

exc=/tmp/`basename $0`
if [ $0 -nt $exc ]; then sed -n "/^\/\*\*$/,\$p" $0 | gcc -x c - -o $exc; fi

echo "foo"
$exc

exit
/**
*/
#include <stdio.h>

int main()
{
    printf("bar\n");
    return 0;
} 
```

带有后缀“.c”的 C 脚本很好，[headtail.c](https://gist.github.com/Hermann-SW2/209918befa911209e06c5812e438dc37)是我第一个需要可执行的“.c”文件：

```
$ echo -e "1\n2\n3\n4\n5\n6\n7" | ./headtail.c 
1
2
3
6
7
$ 
```

我喜欢 C 脚本，因为你只有一个文件，你可以轻松地四处移动，并且 bash 或 C 部分的更改不需要进一步的操作，它们只会在下一次执行时起作用。

PS：
上面显示的“tcc -run” C 脚本有问题，C 脚本标准输入不能用于执行的 C 代码。原因是我通过管道将提取的 C 代码传递给“tcc -run”。新的要点[run_from_memory_stdin.c](https://gist.github.com/Hermann-SW/7bc1a49b90adabed45f5775b15139c5f)正确地做到了：

```
...
echo "foo"
tcc -run <(sed -n "/^\/\*\*$/,\$p" $0) 42
... 
```

“foo”由 bash 部分打印，“bar 42”由 C 部分打印（42 被传递 argv[⁠1]），然后从 C 代码打印管道脚本输入：

```
$ route -n | ./run_from_memory_stdin.c 
foo
bar 42
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         172.29.58.98    0.0.0.0         UG    306    0        0 wlan1
10.0.0.0        0.0.0.0         255.255.255.0   U     0      0        0 wlan0
169.254.0.0     0.0.0.0         255.255.0.0     U     303    0        0 wlan0
172.29.58.96    0.0.0.0         255.255.255.252 U     306    0        0 wlan1
$ 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-18T21:26:47.270

最后，OP问题的答案是肯定的！

我从 guitmz 中找到了 memrun repo，它演示了使用 golang 和汇编程序从内存中运行 (x86_64) ELF。我分叉了它，并提供了 C 版本的 memrun，它可以从标准输入或通过第一个参数进程替换运行 ELF 二进制文件（在 x86_64 和 armv7l 上验证）。repo 包含演示和文档（memrun.c 只有 47 行代码）：
[https ://github.com/Hermann-SW/memrun/tree/master/C#memrun](https://github.com/Hermann-SW/memrun/tree/master/C#memrun)

这是最简单的示例，使用“-o /dev/fd/1”gcc 编译的 ELF 被发送到标准输出，并通过管道传输到执行它的 memrun：

```
pi@raspberrypi400:~/memrun/C $ gcc info.c -o /dev/fd/1 | ./memrun
My process ID : 20043
argv[0] : ./memrun
no argv[1]
evecve --> /usr/bin/ls -l /proc/20043/fd
total 0
lr-x------ 1 pi pi 64 Sep 18 22:27 0 -> 'pipe:[1601148]'
lrwx------ 1 pi pi 64 Sep 18 22:27 1 -> /dev/pts/4
lrwx------ 1 pi pi 64 Sep 18 22:27 2 -> /dev/pts/4
lr-x------ 1 pi pi 64 Sep 18 22:27 3 -> /proc/20043/fd
pi@raspberrypi400:~/memrun/C $ 
```

我对这个话题感兴趣的原因是在“C 脚本”中的使用。run_from_memory_stdin.c 一起演示：

```
pi@raspberrypi400:~/memrun/C $ wc memrun.c | ./run_from_memory_stdin.c 
foo
bar 42
  47  141 1005 memrun.c
pi@raspberrypi400:~/memrun/C $ 
```

产生显示输出的 C 脚本是如此之小......

```
#!/bin/bash

echo "foo"
./memrun <(gcc -o /dev/fd/1 -x c <(sed -n "/^\/\*\*$/,\$p" $0)) 42

exit
/**
*/
#include <stdio.h>

int main(int argc, char *argv[])
{
  printf("bar %s\n", argc>1 ? argv[1] : "(undef)");

  for(int c=getchar(); EOF!=c; c=getchar())  { putchar(c); }

  return 0;
} 
```

PS：
我在gcc和g++中添加了tcc的“-run”选项，详情见：
[https ://github.com/Hermann-SW/memrun/tree/master/C#adding-tcc--run-option-to- gcc 和 g](https://github.com/Hermann-SW/memrun/tree/master/C#adding-tcc--run-option-to-gcc-and-g)

很好，没有任何东西存储在文件系统中：

```
pi@raspberrypi400:~/memrun/C $ uname -a | g++ -O3 -Wall -run demo.cpp 42
bar 42
Linux raspberrypi400 5.10.60-v7l+ #1449 SMP Wed Aug 25 15:00:44 BST 2021 armv7l GNU/Linux
pi@raspberrypi400:~/memrun/C $ 
```

# c# - WP7/8 使用 C# 在事件发生后动态更改 InputScope

> ID：13690457
> 
> 赞同：6
> 
> 时间：2012-12-03T19:42:10.337
> 
> 标签：c#, events, microsoft-metro, windows-phone, inputscope

我正在为 Windows Phone 制作一个应用程序，我一直在尝试让主文本框的 InputScope 在方向更改为横向时更改（以便键盘在没有自动更正栏的情况下占用更少的横向空间)，然后再次返回。

我尝试使用第二个文本框并在方向更改时隐藏其他文本框，但这并没有很好地工作。:P

尽我所能尝试，我无法让它工作，并且找不到在 OrientationChangedEvent 参数之后更改 InputScope 值的方法，该参数在改变页面元素围绕方向的位置方面效果很好。

我对使用 C# 和 XAML 开发应用程序还很陌生，我希望有一种很好的简单方法来设置我的文本框的 InputScope，你们中的一个很棒的人可以告诉我！

-编辑：这是事件处理程序，里面的所有东西都工作得很好，但是我尝试添加与 InputScope 相关的任何东西都不起作用:(

```
private void MainPage_OrientationChanged(object sender, OrientationChangedEventArgs e)
    {
        if ((e.Orientation & PageOrientation.Portrait) == (PageOrientation.Portrait))
        {
            //Portrait
            PlaceholderText.FontSize = 29.333;
            PlaceholderText.Padding = new Thickness (0,0,0,0);
            MainTweet.FontSize = 29.333;
            MainTweet.Padding = new Thickness (12,8,12,8);
            Counter.Margin = new Thickness (0,212,28,0);
        }
        else
        {
            //Landscape
            PlaceholderText.FontSize = 23;
            PlaceholderText.Padding = new Thickness (8,0,0,0);
            MainTweet.FontSize = 22;
            MainTweet.Padding = new Thickness (16,8,180,0);
            Counter.Margin = new Thickness (0,-18,28,0);
        }
    } 
```

MainTweet.Text 是键盘默认关注的文本框，当页面更改为横向时，我希望能够将其从“搜索”输入范围更改为另一个，可能是“URL”。当方向改变时，当前在那里的东西很好地重新排列页面上的元素，我很欣赏它可能看起来不那么整洁......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T20:02:16.490

枚举中有多个“方向”状态——不仅仅是`Portrait`and `Landscape`。以下对我有用以更改范围（在 Windows Phone 7.5 模拟器上）：

```
if (e.Orientation == PageOrientation.Landscape
    || e.Orientation == PageOrientation.LandscapeRight
    || e.Orientation == PageOrientation.LandscapeLeft)
{
    InputScope inputScope = new InputScope();
    InputScopeName inputScopeName = new InputScopeName();
    inputScopeName.NameValue= InputScopeNameValue.Url;
    inputScope.Names.Add(inputScopeName);
    textBox1.InputScope = inputScope;
} 
```

所以你会把它放到你的`MainPage_OrientationChanged`事件处理程序中。

# bash - 使用 cut 命令删除多列

> ID：13690461
> 
> 赞同：80
> 
> 时间：2012-12-03T19:42:23.693
> 
> 标签：bash, cut

给定输入

```
回声 1,2,3,4,5,6,7,8,9,...100 

```

如果我想削减第 5 列，我可以做到

```
切-d，-f-4,6-

```

如果我想剪切多个不连续的列，如 5、7 等，是否有一个内衬？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2012-12-03T19:49:30.950

您应该能够直接在现有`-f`规范中继续序列。

要跳过 5 和 7，请尝试：

```
cut -d, -f-4,6-6,8- 
```

当您跳过单个连续列时，这也可以写成：

```
cut -d, -f-4,6,8- 
```

为了让它继续，如果你想跳过 5、7 和 11，你可以使用：

```
cut -d, -f-4,6-6,8-10,12- 
```

为了更清楚地了解它，当您使用分别位于序列列表开头/结尾的开始/结束列时，更容易可视化。例如，以下将打印第 2 到 20 列，跳过第 5 和 11 列：

```
cut -d, -f2-4,6-10,12-20 
```

因此，这将打印“2 到 4”，跳过 5，“6 到 10”，跳过 11，然后是“12 到 20”。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2016-02-03T18:00:16.297

有时更容易考虑要排除哪些字段。

如果未剪切（未保留在输出中）的字段数量很少，则使用该标志可能更容易`--complement`，例如，包括除 3、7 和 12 之外的所有字段 1-20 - 执行以下操作：

```
cut -d, --complement -f3,7,12 <inputfile 
```

而不是

```
cut -d, -f-2,4-6,8-11,13- 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-12-03T19:53:14.607

您可以使用 seq 剪切所有奇数/偶数列：

这将打印所有奇数列

```
echo 1,2,3,4,5,6,7,8,9,10 | cut -d, -f$(seq -s, 1 2 10) 
```

要打印所有偶数列，您可以使用

```
echo 1,2,3,4,5,6,7,8,9,10 | cut -d, -f$(seq -s, 2 2 10) 
```

通过更改 seq 的第二个数字，您可以指定要打印的列。

如果要打印的列的规范更复杂，您还可以使用“one-liner-if-clause”，例如

```
echo 1,2,3,4,5,6,7,8,9,10 | cut -d, -f$(for i in $(seq 1 10); do if [[ $i -lt 10 && $i -lt 5 ]];then echo -n $i,; else echo -n $i;fi;done) 
```

这将打印从 1 到 5 的所有列 - 您可以简单地修改条件以创建更复杂的条件来指定应打印列的天气。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-02-22T19:55:13.240

Perl 也可以这样做
因为它使用基于 0 的索引而不是基于 1 的索引，所以字段值偏移 1

```
perl -F, -lane 'print join ",", @F[1..3,5..9,11..19]' 
```

相当于：

```
cut -d, -f2-4,6-10,12-20 
```

如果输出中不需要逗号：

```
perl -F, -lane 'print "@F[1..3,5..9,11..19]"' 
```

# iis - IIS 7 中的详细错误

> ID：13690465
> 
> 赞同：1
> 
> 时间：2012-12-03T19:42:55.143
> 
> 标签：iis, iis-7, web

我试图弄清楚为什么在 IIS 中设置网站时出现 500 个错误。

到目前为止，我已经尝试了以下步骤：

*   启用失败请求跟踪（不为此站点编写日志，但适用于其他站点）
*   启用详细的错误消息。仍然获得默认的 500 页面，没有其他信息。
*   授予应用程序池对项目目录的完全权限。
*   确保应用程序池在经典 .NET 2（旧应用程序）上运行
*   在（经典/集成，.NET 2/4）的排列下运行站点
*   启用匿名身份验证

所以我的想法是，不知何故，网站在日志模块运行之前就失败了。

我怀疑是这种情况，因为我在事件查看器、IIS 高级日志文件夹或失败的请求跟踪文件夹中看不到新实体。我唯一的信息来源（除了 500 错误）是 IIS 日志中的一个新条目：

```
2012-12-04 13:06:05 127.0.0.7 GET / - 80 - 127.0.0.1 Mozilla/5.0+(compatible;.....) 
```

为了验证这一点，有没有办法检查请求失败的管道阶段？是否可以在故​​障发生之前运行日志记录模块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-07T18:16:28.327

HTTP.sys有一个[跟踪事件记录器](http://blogs.msdn.com/b/wndp/archive/2007/01/18/event-tracing-in-http-sys-part-1-capturing-a-trace.aspx)。有了这个，您可以确定请求是否甚至发送到 IIS 中的正确应用程序池。[使用说明](http://helephant.com/2012/07/23/debugging-iis7-requests-with-windows-event-tracing/)

作为最后的手段，Microsoft 提供了一个名为[Debug Diagnostic](http://www.microsoft.com/en-us/download/details.aspx?id=26798)的工具。当您没有其他选择时，请使用此选项。它将生成您选择的应用程序池的崩溃转储。不容易通过，但它是一个线索。[使用说明](http://support.microsoft.com/kb/919789)

# .net - Castle ActiveRecord 未使用 WCF 初始化会话

> ID：13690467
> 
> 赞同：1
> 
> 时间：2012-12-03T19:43:05.427
> 
> 标签：.net, wcf, nhibernate, castle-activerecord

这可能是一个小众问题，但也许有人可以帮助我。我正在将我的 Web 服务从 ASMX 移植到 WCF，但是我完全建立在 Castle ActiveRecord 上。为了确保我的配置中没有某种奇怪的问题，我使用来自 NuGet 的所有最新 Castle 和 NHibernate 库从头开始构建了一个独立的重现。

我做的第一件事是在`Application_Start`. 通常我会使用一个`web.config`实例，但这可能无关紧要：

```
protected void Application_Start(object sender, EventArgs e)
{
   //NHibernate.Driver.OracleClientDriver
   IDictionary<string, string> properties = new Dictionary<string, string>();

   properties.Add("connection.driver_class", "NHibernate.Driver.OracleClientDriver");
   properties.Add("dialect", "NHibernate.Dialect.Oracle10gDialect");
   properties.Add("connection.provider", "NHibernate.Connection.DriverConnectionProvider");
   properties.Add("connection.connection_string", "user Id=xxx;password=xxx;server=localhost;persist security info=True");
   properties.Add("proxyfactory.factory_class", "NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle");

   InPlaceConfigurationSource source = new InPlaceConfigurationSource();
   source.IsRunningInWebApp = true;
   source.ThreadScopeInfoImplementation = typeof(Castle.ActiveRecord.Framework.Scopes.HybridWebThreadScopeInfo);

   source.Add(typeof(ActiveRecordBase), properties);

   ActiveRecordStarter.Initialize(source, typeof(Task), typeof(Project));
} 
```

请注意，我也在使用该`HybridWebThreadScopeInfo`实现，因为`HttpContext.Current`在 WCF 中将为空。

接下来，我实现我的 Web 服务：

```
public class Service1 : IService1
{
   public string GetData(int value)
   {
      Project p;

      p = Project.Find(123M);
      var count = p.Tasks.Count(); //Force count query

      return p.GoldDate.ToString();
   }
} 
```

当我打电话时`Project.Find()`，它工作正常。接下来，我调用`p.Tasks.Count()`which 将强制执行新查询，因为该`Tasks`属性是惰性的。当我这样做时，我得到了异常：

Initializing[NHTest.Project#123] - 无法延迟初始化角色集合：NHTest.Project.Tasks，没有会话或会话已关闭

发生这种情况的原因是因为没有会话范围。我猜如果内部`ActiveRecordBase`方法不存在或其他东西，它会创建一个会话。现在，我可以用这个手动创建一个：

```
public string GetData(int value)
{
   Project p;

   using (new SessionScope())
   {
      p = Project.Find(123M);
      var count = p.Tasks.Count(); //Force count query

      return p.GoldDate.ToString();
   }
} 
```

这会很好用。但是，我不想在我的所有代码中都这样做，因为这在 ASP.NET Web 服务中非常有效。

**那么为什么它可以在 ASP.NET 中工作呢？**

之所以有效，是因为 ActiveRecord 带有一个名为`Castle.ActiveRecord.Framework.SessionScopeWebModule`. 这个模块在每个 HTTP 请求之前运行，并在 ActiveRecord 中创建一个默认会话。但是，在 WCF HTTP 请求之前*不会调用此模块。*

**ASP.NET 兼容模式呢？**

您可以使用以下方法启用 ASP.NET 兼容模式：

```
<serviceHostingEnvironment aspNetCompatibilityEnabled="true" ... /> 
```

这也将解决问题，并提供对 WCF 中 HTTP 请求管道的其他访问。这将是一种解决方案。但是，尽管它可以在 Visual Studio 测试网络服务器上运行，但我从来没有能够让兼容模式在 IIS7 上运行。另外，我觉得最好的设计是完全在 WCF 基础架构内工作。

**我的问题：**

Castle ActiveRecord 是否提供在 WCF 请求中创建会话范围的能力？如果是这样，这是如何配置的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:13:59.627

在挖掘了 Castle ActiveRecord 源代码后，我发现答案是否定的；ActiveRecord 没有*任何*类型的本机 WCF 支持。然而，处理起来并不复杂，因为 ActiveRecord 会处理所有混乱的 NHibernate 细节，例如配置和会话工厂。事实上，为每个 WCF 操作自动创建会话范围与实现自定义`IDisplayMessageInspector`. 此消息检查器只需在`SessionScope`收到请求时新建一个对象，并在请求结束时处理它：

```
public class MyInspector : IDispatchMessageInspector
{
   public MyInspector()
   {
   }

   public object AfterReceiveRequest(ref System.ServiceModel.Channels.Message request, System.ServiceModel.IClientChannel channel, System.ServiceModel.InstanceContext instanceContext)
   {
      return new SessionScope();
   }

   public void BeforeSendReply(ref System.ServiceModel.Channels.Message reply, object correlationState)
   {
      SessionScope scope = correlationState as SessionScope;

      if (scope != null)
      {
         scope.Flush();
         scope.Dispose();
      }
   }
} 
```

for 的构造函数`SessionScope`将设置当前会话范围，然后可以在该线程中的任何其他位置访问该范围。这使得诸如延迟加载和传递数据读取器之类的事情变得简单。您还会注意到，我在请求期间使用`correlationState`状态来跟踪对 的引用`SessionScope`，类似于如何`SessionScopeWebModule`使用 HttpContext 项目集合。

这`IDispatchInspector`可以在 web.config 中配置，或者通过`Attribute`类附加到 WCF 服务：

```
public class MyServiceBehaviorAttribute : Attribute, IServiceBehavior
{
   public void AddBindingParameters(ServiceDescription serviceDescription, System.ServiceModel.ServiceHostBase serviceHostBase, System.Collections.ObjectModel.Collection<ServiceEndpoint> endpoints, System.ServiceModel.Channels.BindingParameterCollection bindingParameters)
   {
   }

   public void ApplyDispatchBehavior(ServiceDescription serviceDescription, System.ServiceModel.ServiceHostBase serviceHostBase)
   {
      foreach (ChannelDispatcher cDispatcher in serviceHostBase.ChannelDispatchers)
         foreach (EndpointDispatcher eDispatcher in cDispatcher.Endpoints)
            eDispatcher.DispatchRuntime.MessageInspectors.Add(new MyInspector());

   }

   public void Validate(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase)
   {
   }
} 
```

然后当然用 . 标记服务类`[MyServiceBehavior]`。

**确认线程！**

啊，是的，这一切在理论上可能有效，但实际上，`IDispatchMessageInspector`可能不会与操作在同一个线程中运行。为了解决这个问题，我们需要实现一个 ActiveRecord`IWebThreadScopeInfo`类。当 ActiveRecord 查找当前会话范围时使用此对象。这通常`HttpContext`在使用 ASP.NET 时使用 键控，但`HybridThreadScopeInfo`也能够按线程键控每个会话范围堆栈。两者都不适用于 WCF，因此我们需要一个超级混合实现，它支持 ASP.NET（如果`HttpContext.Current`存在）、WCF（如果存在）`OperationContext.Current`，并且当您只是在某个任意线程中运行时支持每个线程。

我的实现（未经高度测试）基于[HybridThreadScopeInfo 实现](https://wcell.svn.codeplex.com/svn/wcell/Libraries/Source/Castle/Castle.ActiveRecord/Framework/Scopes/HybridWebThreadScopeInfo.cs)，并进行了一些调整：

```
public class WcfThreadScopeInfo : AbstractThreadScopeInfo, IWebThreadScopeInfo
{
   const string ActiveRecordCurrentStack = "activerecord.currentstack";

   [ThreadStatic]
   static Stack stack;

   public override Stack CurrentStack
   {
      [MethodImpl(MethodImplOptions.Synchronized)]
      get
      {
         Stack contextstack;

         if (HttpContext.Current != null) //We're running in an ASP.NET context
         {
            contextstack = HttpContext.Current.Items[ActiveRecordCurrentStack] as Stack;
            if (contextstack == null)
            {
               contextstack = new Stack();
               HttpContext.Current.Items[ActiveRecordCurrentStack] = contextstack;
            }

            return contextstack;
         }

         if (OperationContext.Current != null) //We're running in a WCF context
         {
            NHibernateContextManager ctxMgr = OperationContext.Current.InstanceContext.Extensions.Find<NHibernateContextManager>();
            if (ctxMgr == null)
            {
               ctxMgr = new NHibernateContextManager();
               OperationContext.Current.InstanceContext.Extensions.Add(ctxMgr);
            }

            return ctxMgr.ContextStack;
         }

         //Working in some random thread
         if (stack == null)
         {
            stack = new Stack();
         }

         return stack;
      }
   }
} 
```

您还需要一个`IExtension<InstanceContext>`派生类，WCF 使用它在操作上下文中存储数据：

```
public class NHibernateContextManager : IExtension<InstanceContext>
{
   public Stack ContextStack { get; private set; }

   public NHibernateContextManager()
   {
      this.ContextStack = new Stack();
   }

   public void Attach(InstanceContext owner)
   {
   }

   public void Detach(InstanceContext owner)
   {
   }
} 
```

然后，您可以通过在配置节点上设置属性或在使用对象时设置属性来配置 ActiveRecord 以使用此类`IWebThreadScopeInfo`。`web.config``threadinfotype``<activerecord>``ThreadScopeInfoImplementation``InPlaceConfigurationSource`

希望这对某人有帮助！

# django - 为什么我的 django formset 需要一个指针字段引用？

> ID：13690468
> 
> 赞同：2
> 
> 时间：2012-12-03T19:43:05.557
> 
> 标签：django, django-forms

没有什么比不理解为什么会起作用更糟糕的了。几天前我问了这个问题并想出了一个解决方法，但我不知道它为什么有效：

[如何在 Formset POST 上调试 Django MultiValueDictKeyError](https://stackoverflow.com/questions/13666852/how-to-debug-a-django-multivaluedictkeyerror-on-formset-post)。

为什么表单集需要一个指向表单集模型表单模型超类的指针字段引用？我还有其他类似的表单集没有。

**为了使这成为一个独立的问题，以下是详细信息：**

当我发布我的表单集时，我得到一个 MultiValueDictKeyError。具体来说：

```
MultiValueDictKeyError at /core/customers/1/update/documents/
"Key u'documents-0-attachment_ptr' not found in <QueryDict: {u'documents-1-last_modified_date': [u''], u'documents-1-name': [u''], u'documents-MAX_NUM_FORMS': [u''], u'documents-0-attachment_file': [u''], u'documents-INITIAL_FORMS': [u'1'], u'documents-1-document_type': [u''], u'documents-0-notes': [u''], u'documents-1-notes': [u''], u'submit': [u'Submit changes'], u'documents-0-DELETE': [u'on'], u'documents-1-attachment_file': [u''], u'documents-0-document_type': [u''], u'documents-TOTAL_FORMS': [u'2'], u'documents-0-name': [u'test'], u'documents-1-creation_date': [u''], u'documents-0-creation_date': [u'2012-12-01 23:41:48'], u'csrfmiddlewaretoken': [u'NCQ15jA7erX5dAbx20Scr3gWxgaTn3Iq', u'NCQ15jA7erX5dAbx20Scr3gWxgaTn3Iq', u'NCQ15jA7erX5dAbx20Scr3gWxgaTn3Iq'], u'documents-0-last_modified_date': [u'2012-12-01 23:41:48']}>" 
```

`documents-0-attachment_ptr`关键部分是 Django在 post 数据中寻找密钥。这很令人困惑——文档是附件的子类。所有其他帖子数据都符合预期。为什么 Django 在我的表单集中需要指针数据？

这是表单集中使用的表单：

```
class DocumentInlineForm(forms.ModelForm):  # pylint: disable=R0924
    attachment_file = forms.FileField(widget=NoDirectoryClearableFileInput)
    notes = forms.CharField(
        required=False,
        widget=forms.Textarea(attrs={'rows': 2,}), 
    )
    helper = DocumentInlineFormHelper()

    class Meta: # pylint: disable=W0232,R0903
        fields = (
            'attachment_file', 
            'creation_date',
            'document_type',
            'last_modified_date',
            'name',
            'notes',
        )
        model = Document 
```

这是文档模型：

```
"""
Handles document model definitions.
"""
from django.db import models
from eee_core.models.attachments import Attachment
from django.db.models.signals import pre_save
from datetime import datetime
from django.utils.timezone import utc

class Document(Attachment):
    """
    A document is an attachment with additional meta data.
    """
    creation_date = models.DateTimeField(
        blank=True, 
        null=True,
    )
    document_type = models.CharField(
        blank=True, 
        choices=(
            ('CONTRACT', 'Contract'),
            ('INVOICE', 'Invoice'),
            ('FACILITY', 'Facility change form'),
            ('LOA', 'Letter of authorization'),
            ('USAGE', 'Usage history document'),
            ('OTHER', 'Other'),
        ),
        default=None, 
        null=True, 
        max_length=8, 
    )
    last_modified_date = models.DateTimeField(
        blank=True, 
        null=True,
    )
    notes = models.TextField(
        blank=True,
        null=True,
    )

    class Meta(Attachment.Meta): # pylint: disable=W0232,R0903
        """
        Sets meta fields for model.
        """
        app_label = 'core'

    def __str__(self):
        return unicode(self).encode('utf-8')

    def __unicode__(self):
        return unicode(self.name)

def pre_save_callback(sender, instance, *args, **kwargs): # pylint: disable=W0613
    if not isinstance(instance, Document):
        return

    if not instance.creation_date:
        instance.creation_date = datetime.utcnow().replace(tzinfo=utc)

    instance.last_modified_date = datetime.utcnow().replace(tzinfo=utc)

pre_save.connect(pre_save_callback, dispatch_uid='document_pre_save') 
```

**附加信息：**

奇怪的是，表单集的初始帖子工作正常。只有在更新帖子上——当表单集中有初始表单时——当我收到这个错误时。当我尝试从表单集中删除表单时也会发生这种情况。

此外，该表单集是使用 django 脆表单的通用内联表单集。

**更新**

有一个使用模板代码的请求。这是简化版：

```
{% load crispy_forms_tags %}
{% load url from future %}
<form action="" method="post" enctype="multipart/form-data">
    {{ formset.management_form }}
    {% for subform in formset.forms %}
      {{ subform.id }}
      {% crispy subform %}
    {% endfor %}
    <div class="btn-toolbar">
        <input class='btn btn-primary' type="submit" name="submit" value="Submit changes" />
    </div>
</form> 
```

`attachment_ptr`我通过添加到表单的字段列表来停止此错误。现在`DocumentInlineForm`也是：

```
class DocumentInlineForm(forms.ModelForm):  # pylint: disable=R0924
    attachment_file = forms.FileField(widget=NoDirectoryClearableFileInput)
    notes = forms.CharField(
        required=False,
        widget=forms.Textarea(attrs={'rows': 2,}), 
    )
    helper = DocumentInlineFormHelper()

    class Meta: # pylint: disable=W0232,R0903
        fields = (
            'attachment_ptr',
            'attachment_file', 
            'creation_date',
            'document_type',
            'last_modified_date',
            'name',
            'notes',
        )
        model = Document 
```

也许这是我以前不知道的事情，但是 Django 是否要求您在所有使用子类模型的形式中提供指向超类的指针？这让我很惊讶。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:08:35.073

不要忘记，非抽象模型的子类实际上只是两个模型之间的一对一关系。所以自然地 Django 需要某种从一个到另一个的指针，否则它不可能知道在子表更改时要更新父表中的哪一行。

# asp.net - 集成我的数据库 - 单独的项目或只是合并它？

> ID：13690470
> 
> 赞同：1
> 
> 时间：2012-12-03T19:43:11.260
> 
> 标签：asp.net, entity-framework

我正在创建一个新的 MVC Web 应用程序。我以前从未使用过 MVC（在 asp.net 中）。无论如何，在我的上一个项目中，我使用 Code First 和 Entity Framework 来处理我的数据，我喜欢使用它，所以我想再次使用它。

现在，在最后一个项目中，我有一个单独的项目/文件夹来处理模型和上下文，我只是将它引用到我的主项目中。在 MVC 项目中做这样的事情仍然是正确的选择，还是应该从“模型”部分运行它？

这是我学习如何实现它的网站：http: [//www.codeproject.com/Articles/468777/Code-First-with-Entity-Framework-5-using-MVC4-and](http://www.codeproject.com/Articles/468777/Code-First-with-Entity-Framework-5-using-MVC4-and)

这种方法有什么问题还是没问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:46:59.323

没有错。

如果你的项目不够大，那就去做吧。尽管您必须保持代码井井有条，但只有一个项目会使其变得更简单

如果您的项目可能变得很大，那么为您的应用程序的不同层和层设置两个或多个项目将是一个不错的选择，这样不同的人可以在自己的项目上工作。

# jquery - IE8 e.preventDefault() 只工作一次（ajax 提交后忽略）

> ID：13690476
> 
> 赞同：0
> 
> 时间：2012-12-03T19:43:41.320
> 
> 标签：jquery, internet-explorer-8, cross-browser, jquery-events

我在[jquery form plugin](http://www.malsup.com/jquery/form/)的帮助下使用 AJAX 提交表单。它工作得很好，除了`e.preventDefault()`在 IE8 中只工作一次。第二次提交后，页面重定向到表单的 url。

我很确定我需要做某种事件委托，但我不完全确定如何去做。

上下文是一个 wordpress 网站。以下脚本出现在注册表单 HTML 之前。

```
 <script type="text/javascript">

    jQuery.fn.outerHTML = function(s) {
    return (s)
      ? this.before(s).remove()
      : jQuery("<p>").append(this.eq(0).clone()).html();
    }

    jQuery(document).ready(function($){

        $("form input").removeAttr('tabindex');

        ajaxregister = function(e) {
            //e = e || window.event;
            e.preventDefault();
            $(this).animate({opacity:0}, 500);
            $(this).siblings("#loading").fadeIn();
            $(this).ajaxSubmit({
                //cache : false,
                //url:'http://streetofwalls.dev/wp-login.php?action=register'
                success: function( data ) {
                    //console.log(data);

                    var $message = $(data).find('.message').outerHTML();
                    var $error = $(data).find('#login_error').outerHTML();
                    var $form = $(data).find('#registerform').outerHTML();
                    //console.log( 'success' );

                    //$(e.target).html( ( ($error) ? $error : $message ) + $form ).fadeTo(500,1);
                    var target_id = $(e.target).attr("id");
                    $("#"+target_id).html( ( ($error) ? $error : $message ) + $form ).animate({opacity:1}, 500);
                    $("#"+target_id).siblings("#loading").css('display', 'none');

                }
            });
        return false;
        }

        $(".widget_reg_widg #registerform").submit( ajaxregister ); //should this be .delegate() ???

    });
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:53:59.587

我通过在成功回调函数的末尾添加以下几行来解决这个问题。Wordpress 检测到 IE 并将“ie8” id 添加到 html 标记。您也可以使用 jquery 或 modernizr 轻松检查 ie。

```
if ( $('html').attr('id') == "ie8" ) {
    $(".widget_reg_widg #registerform").delegate( this, "submit", ajaxregister );
} 
```

# java - 从资源加载时 GSON 出现 EOF 错误

> ID：13690480
> 
> 赞同：0
> 
> 时间：2012-12-03T19:43:45.620
> 
> 标签：java, android, xml, json, gson

我正在尝试使用 GSON 将 Json 字符串转换为对象。当我从这样的文件中加载字符串时：

```
File f = new File(Environment.getExternalStorageDirectory()
            + File.separator + "jsonTest");
    BufferedReader br = new BufferedReader(new FileReader(f));
    String Json = br.readLine();
    br.close();
    Gson gson = new Gson();
    dreFieldArray = gson.fromJson(Json, DreField[].class); 
```

它工作正常。但是，如果我尝试像这样使用字符串资源：

```
String Json = this.getString(R.string.NewFileData);
Gson gson = new Gson();
    dreFieldArray = gson.fromJson(Json, DreField[].class); 
```

我得到一个EOF异常。资源中的字符串是从文件中复制的，所以它应该是相同的。我读到如果对象后面有多余的字符，可能会发生此异常，但我看不到任何字符。关于这里出了什么问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:52:15.327

`getString()`不会显示所有特殊字符。你可能不得不逃离他们。

记录 的内容`R.string.NewFileData`，查看丢失的字符，然后在 中转义`strings.xml`（在删除的字符前放一个“\”）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T05:27:30.820

试试用怎么样

```
String Json= "{\"userName\":\"hello\",\"userId\":123}" 
```

代替`String Json = this.getString(R.string.NewFileData);`

导致 readline 分析段落由`\r\n`

if you put message `e.printStackTrace()` of `IOException`will be more helpful

# ubuntu - 无法在 gdb 中打印 errno，抱怨缺少共享库，但它存在

> ID：13690481
> 
> 赞同：2
> 
> 时间：2012-12-03T19:43:48.263
> 
> 标签：ubuntu, gdb, shared-libraries, libc, errno

在调试我的应用程序时，如果我闯入 GDB 并尝试打印 errno，即使是从检查 errno 的函数内部，我也会从 GDB 收到以下错误：

```
(gdb) print errno
Cannot find shared library `/usr/lib/debug/lib/libc-2.11.1.so' in dynamic linker's load module list 
```

我尝试过的事情：

1.  检查文件是否存在，它确实存在并且大约 7.3MB。
2.  将 /usr/lib/debug/lib/ 添加到我的 LD_LIBRARY_PATH 的前面。没有效果。
3.  设置 LD_PRELOAD=/usr/lib/debug/lib/libc-2.11.1.so 会导致我的应用程序在启动时出现段错误。
4.  如果我在二进制文件上运行 ldd，它说它正在使用“/lib/libc.so.6”，而 aptitude（我正在运行 Ubuntu）告诉我 libc6-dbg*已*安装。
5.  检查我没有在 .gdbinit 中设置自定义库路径，我没有。

该应用程序似乎运行良好，所以我无法想象 libc 本身被搞砸了。有任何想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-04T05:23:16.397

该文件`/usr/lib/debug/lib/libc-2.11.1.so`不包含 glibc 的调试版本*。*它*仅*包含libc 的调试部分，但*没有实际的可执行代码*。将其放入`LD_PRELOAD`or`LD_LIBRARY_PATH`是*错误*的做法。不要那样做。

[您可以在此处](http://sourceware.org/gdb/onlinedocs/gdb/Separate-Debug-Files.html)阅读有关单独调试文件的信息。

> (gdb) print errno
> 在动态链接器的加载模块列表中找不到共享库`/usr/lib/debug/lib/libc-2.11.1.so'

这是 GDB 中的一个 buglet。

您应该知道 GDB 会查找变量`errno`，但您的应用程序不使用任何此类变量。相反，`errno`是一个`#define`d 宏，它扩展为`*(__errno_location())`，而 GDB 不知道这一点。

试试这个：

```
(gdb) p __errno_location()
$1 = (int *) 0x7ffff78396a8

(gdb) x/x $1
0x7ffff78396a8: 0x00000000 
```

# python - 实例化后对象的python范围

> ID：13690482
> 
> 赞同：1
> 
> 时间：2012-12-03T19:44:06.113
> 
> 标签：python, python-2.7

我正在尝试学习 OO Python，一旦实例化，我对对象属性的范围有疑问。所以，我决定写一个非常简单的程序：

```
class Struct:
    def __init__(self):
        self.resadd=[]
        self.ressub=[]
        self.resmul=[]

class MathStruct:
    def mathss(self,x,y):
        add=x+y
        sub=x-y
        mul=x*y
        resstruct.resadd.append(add)
        resstruct.ressub.append(sub)
        resstruct.resmul.append(mul)

if __name__=='__main__':
    resstruct=Struct()
    for i in range(10,20):
        mathsstuff=MathStruct()
        mathsstuff.mathss(i,5)
    print len(resstruct.resadd),resstruct.resadd
    print len(resstruct.ressub),resstruct.ressub
    print len(resstruct.resmul),resstruct.resmul 
```

如您所见，该程序非常简单-但是，这是我的问题-我使用以下方法实例化“结果”对象： resstruct=Struct() 然后使用 resstruct.resadd、resstruct.ressub 和 resstruct.resmul 中的属性“数学”功能。这合法吗（我得到了正确的答案！）？这是否意味着即使在其他功能中也可以使用对象属性？

通常，我会从函数返回值，然后将其附加到对象属性，但我（令人愉快地）惊讶地发现我可以直接在另一个函数中修改对象属性。

..简而言之，我的问题是对象属性在实例化后的范围是什么？对不起，如果这是一个 101 问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T19:50:46.887

该行`restruct = Struct()`出现在模块顶层，在任何函数或类之外，因此它在模块全局命名空间中创建一个对象。顾名思义，这个命名空间对模块来说是全局的，并且可以从所有函数中访问。如果您在`restruct = Struct()`函数内部完成，则它不会是全局的，并且会在函数完成时消失。

换句话说，如果您在函数范围内创建它，则对象的生命周期将被限制在该范围内。但是你在全局范围内创建了它，所以它永远存在。（一个对象的*属性*本身没有范围；它们位于该对象自己的实例命名空间内，并且只能通过该对象访问。`obj.attr`只要可以访问，您就可以访问`obj`。）

（但请注意，从函数内部*分配*给全局变量需要一个`global`语句。您可以访问`restruct`，因为您只读取变量的值并使用方法改变该对象。如果您尝试`restruct`在函数内分配，您将创建一个新的局部变量来覆盖全局变量。）

# c - 在 C/C++ 中定义 PI 的更好/更便携的方法？

> ID：13690483
> 
> 赞同：4
> 
> 时间：2012-12-03T19:44:11.387
> 
> 标签：c, math, constants, portability, angle

目前在我的科学计算代码中，我有以下内容：

```
//Include M_PI constant
#define _USE_MATH_DEFINES
//Needed for square root function.
#include <math.h> 
```

这工作......至少在 Linux 上......我没有在所有平台上为 C 编译器测试过它。然而，在调查一些较旧的 Fortran 代码时，我最近遇到了这种在另一个代码（不是我自己的）中定义 pi 的看似聪明的方法：

```
<angle in deg.>*8.0d0 * datan(1.0d0) / 360.0d0 
```

当然，这在 C 中是完全可行的，对吧？所以我可以定义我的转换函数，例如：

```
inline double DegToRad(const double A)
{
   return A * atan(1.0) / 45.0;
} 
```

哪种方法更便携？是否有任何数字（例如四舍五入）考虑值得使用一种方法而不是另一种方法？

我确实喜欢 M_PI 常量使代码更具可读性。当然，我可以很高兴地使用上述方法分配我自己的 PI 常数。

针对多个平台（Windows、Linux 等）的 C/C++ 代码的最佳实践是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T20:00:04.343

不要最小化可读性问题；就个人而言，我会做这样的事情：

```
#ifndef M_PI
// Source: http://www.geom.uiuc.edu/~huberty/math5337/groupe/digits.html
#define M_PI 3.141592653589793238462643383279502884197169399375105820974944592307816406 
#endif

#define DEG_TO_RAD (M_PI/180.0)
#define RAD_TO_DEG (180.0/M_PI) 
```

然后声明

```
inline double DegToRad(const double deg) {
   return deg * DEG_TO_RAD;
}

inline double RadToDeg(const double rad) {
   return rad * RAD_TO_DEG;
} 
```

这可能不会或多或少具有可移植性（在 C`atan`和`M_PI`C++ 中都是标准的）。但是，它比使用更具可读性，`atan`并且取决于编译器的优化设置，可能会为您节省昂贵的触发函数调用。

**更新**：看起来 M_PI 不像我想象的那样标准。包含`#ifndef`上述内容应注意不可用的情况。

# java - 如何通过添加布尔列将 JCheckBox 添加到 DefaultTableModel？

> ID：13690488
> 
> 赞同：1
> 
> 时间：2012-12-03T19:44:35.777
> 
> 标签：java, swing, jtable, jcheckbox, defaulttablemodel

我正在尝试将*jcheckbox*添加到 JTable 的第一列，它使用`DefaultTableModel`. 我尝试`Boolean.class`为该列返回 a，但它不起作用。

我在最后一列中已经有一个*jcombobox*，但是使用我用来添加它以添加*jcheckbox*的相同方法不起作用。我在网上读到，如果您在列中呈现 a，java 会自动为您返回一个*复选框*`Boolean.class`，但使用它也不起作用。我认为这可能是我订购组件方式的一个问题。

```
//import statements. 
public class CourseSelection extends GUIDesign implements ActionListener{
    // lot of extraneous stuff,
    JLabel termLabel;
    String term;

    JLabel departmentLabel;
    String department;
    String[] columns = {
        "Select", "CRN", "Title", "Instructor", "Time", 
        "Days", "Location", "Section", "Code", "Mode of Grading"
    };
    int courses;
    Object[][] data;

    String[] modes = {"Audit", "Pass/Fail", "Letter Grding"};

    // create the table here, with model. 
    JTable table;

    DefaultTableModel model = new DefaultTableModel() {
        Class[] types = {
            Boolean.class, String.class, String.class, String.class, 
            String.class, String.class, String.class, String.class, 
            String.class, Object.class
        };
        // making sure that it returns boolean.class.   
        @Override
        public Class getColumnClass(int columnIndex) {
            return types[columnIndex];
        }
    };

    JPanel termPanel = new JPanel();
    JPanel departmentPanel = new JPanel();

    JButton backButton = new JButton("Back");
    JButton registerButton = new JButton("Register");
    JButton refreshButton = new JButton("Refresh");

    public CourseSelection(GTPort gPort) {
        super("Course Selection", 3);
        setLayout(new BoxLayout(this,BoxLayout.PAGE_AXIS));
        header = new JPanel();
        header.setSize(getWidth(), 30);
        body = new JPanel();
        body.setLayout(new BoxLayout(body,BoxLayout.Y_AXIS));

        header.setBackground(color);
        title.setFont(new Font("Helvetica", 1,20));
        header.add(title);

        termLabel = new JLabel("Term:        " + term);

        data = new Object[25][10];
        model = new DefaultTableModel(data, columns);
        table = new JTable(model);
        table.setModel(model);

        departmentLabel = new JLabel("Department: " + department);

        termPanel.add(termLabel);
        departmentPanel.add(departmentLabel);

        JComboBox box = new JComboBox(modes);

        JCheckBox checkBox = new JCheckBox();

        // lot of other code I tried that doesn't work. 
        // table.getColumnModel().getColumn(1)
        //      .setCellEditor(table.getDefaultEditor(Boolean.class));  
        // table.getColumnModel().getColumn(1)
        //      .setCellRenderer(table.getDefaultRenderer(Boolean.class));  

        // table.setDefaultEditor(Boolean.class, new DefaultCellEditor(checkBox));
        // table.setDefaultRenderer(Boolean.class, new DefaultTableCellRenderer());

        // model.getColumnModel().getColumn(1)
        //      .setCellEditor(new DefaultCellEditor(checkBox));
        // model.getColumnModel().getColumn(1)
        //      .setCellRenderer(new DefaultTableCellRenderer());

        table.getColumnModel().getColumn(9)
             .setCellEditor(new DefaultCellEditor(box));
        //   .setCellEditor(new DefaultCellEditor(box));

        // table = new JTable(model);

        body.add(termPanel);
        body.add(departmentPanel);

        body.add(table.getTableHeader());
        body.add(table);

        // body.add(body);
        buttonPanel.add(backButton);
        buttonPanel.add(refreshButton);
        buttonPanel.add(registerButton);

        backButton.addActionListener(this);
        refreshButton.addActionListener(this);
        registerButton.addActionListener(this);

        add(header);
        add(body);
        add(buttonPanel);

        gtPort = gPort;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:37:26.750

您不会`getColumnClass()`在模型中覆盖：

```
model = new DefaultTableModel(data, columns); // nothing overridden here
table = new JTable(model);
table.setModel(model); 
```

覆盖它，它将起作用：

```
model = new DefaultTableModel(data, columns) {
    @Override
    public Class<?> getColumnClass(int column) {
        ...
    }
};
table = new JTable(model);
table.setModel(model); 
```

# php - 从 PHP 执行程序会挂起 APACHE

> ID：13690490
> 
> 赞同：1
> 
> 时间：2012-12-03T19:44:38.953
> 
> 标签：php, c, windows, createprocess, mingw32

您好，提前感谢您的关注。

在过去的两周里，我一直在与一些让我发疯的事情作斗争。我在我的 Windows 机器上安装了 APACHE (2.2.22) 和 PHP (5.4.3)，我试图从同时调用另一个程序的 PHP 脚本中调用一个程序。这两个程序都是用 C/C++ 编写的，并用 MINGW32 编译。关于 Windows 版本，我测试了 Windows 2003 Server 和 Windows 7 Professional，都给我同样的问题。

让我介绍一下这两个程序：

1) mytask.exe：这是一个将在后台执行的程序，它会定期将其状态填充到文件中。

2）job.exe：这是我想从PHP脚本调用的程序。它的目标是将 mytask.exe 作为独立进程（而不是线程）生成。

如果我从控制台窗口运行下面的命令，那么 job.exe 会立即返回并让 mytask.exe 在后台运行，直到它终止。

```
> job.exe spawn mytask.exe
jobid=18874111458879FED 
```

请注意，job.exe 会转储一个用于管理 mytask.exe 的标识符。例如：

```
> job.exe status 18874111458879FED
RUNNING 
```

我已经检查过，如果我从 PHP 脚本运行第一个命令，PHP 脚本会永远*随机*阻塞。如果我查看 Windows 的任务管理器，我可以看到 job.exe 处于类似僵尸的状态。我可以断言 job.exe`return 0;`在其`main()`例程中有效地达到了通常的语句，所以它似乎是在 C 运行时中的木头下的东西。此外，如果我编写一个简单的 mytask.exe，它只是休眠 10 秒，那么 PHP 脚本也会阻塞 10 秒（或者在我刚刚提到的随机行为之后永远阻塞）。换句话说，当我从 PHP 脚本调用 job.exe 时，我无法让 job.exe 生成一个进程而不等待它结束。

所以：在生成 mytask.exe 时我做错了，现在，这是题外话的第二部分。

我使用 WINAPI 函数[CreateProcess()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682425(v=vs.85).aspx)从 job.exe 生成任务。在 MSDN 文档中，我使用 调用 CreateProcess `bInheritHandles = FALSE`，以避免子进程使用 PHP 脚本产生 I/O 死锁。我还关闭了 PROCESS_INFORMATION 结构中 CreateProcess() 返回的进程句柄。我唯一不做的就是等待过程结束。另一方面，关于 PHP 方面，我尝试了`exec()`PHP`proc_open()`函数来调用 job.exe，但没有成功。

不过，我最后的观察似乎是正确的，但它们并不能说服我，因为我不明白为什么它们会以某种方式起作用。事实上，如果 mytask.exe`fclose(stdout)`在睡眠之前执行，那么 PHP 脚本会立即返回。但是，如何？？？我告诉 CreateProcess() 不要继承句柄，那么为什么我会得到这些结果？无论如何，我不能坚持使用这个补丁，因为由 job.exe 启动的程序可能不知道是谁在调用它们，因此从这些程序中关闭 stdout 并不是一个好的解决方案。在 UNIX 中，事情就是这么简单......一个人只需调用`fork()`，关闭标准流，然后调用`execve`调用程序。在 Windows 中，我还尝试使用 CreateThread() 创建一个包装线程（以模拟 fork()），然后在关闭标准流后从该线程调用 CreateProcess() ......但这也关闭了 job.exe 的流！

所有这些问题都可以归结为一个问题：我如何从 PHP 中执行一个创建其他进程的程序？

我希望有人能对这个问题有所了解......非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T07:52:58.083

我想我已经确定了解决方案，它分为两部分：

**1）关于主进程停止直到子进程结束的事实。**

在 MSDN 文档中，这是以下定义`CreateProcess()`：

```
BOOL WINAPI CreateProcess(
  _In_opt_     LPCTSTR lpApplicationName,
  _Inout_opt_  LPTSTR lpCommandLine,
  _In_opt_     LPSECURITY_ATTRIBUTES lpProcessAttributes,
  _In_opt_     LPSECURITY_ATTRIBUTES lpThreadAttributes,
  _In_         BOOL bInheritHandles,
  _In_         DWORD dwCreationFlags,
  _In_opt_     LPVOID lpEnvironment,
  _In_opt_     LPCTSTR lpCurrentDirectory,
  _In_         LPSTARTUPINFO lpStartupInfo,
  _Out_        LPPROCESS_INFORMATION lpProcessInformation
); 
```

正如我在问题中所说，我传递`FALSE`给`bInheritHandles`，但我也传递`0`给`dwCreationFlags`。经过一番研究，我发现有一个名为 的标志`DETACHED_PROCESS`，MSDN 对此表示：

> *对于控制台进程，新进程不会继承其父控制台（默认）。新进程可以稍后调用 AllocConsole 函数来创建控制台。有关更多信息，请参阅创建控制台。*

现在，尽管子进程继续执行，job.exe 仍会立即返回。

**2）关于调用 exec() 时 PHP 脚本随机挂起的事实**

这似乎是PHP的一个错误。在 PHP 会话的上下文中运行`exec()`族函数可能会使 APACHE 随机挂起，这是重新启动服务器所必需的。我[在 Internet 上发现了一个线程，](http://bugs.php.net/bug.php?id=44942)其中用户注意到`session_write_close()`在调用之前关闭会话（直通）`exec()`会阻止脚本挂起。这同样适用于`proc_open/proc_close`功能。所以，我的脚本现在看起来像这样：

```
session_write_close();  //Close the session before proc_open()
$proc = proc_open($cmd,$pipedesc,$pipes);
//do stuff with pipes... 
//... and close pipes
$retval = proc_close($proc);
session_start(); //restore session 
```

希望这可以帮助。

# asp.net-mvc - 如何在局部视图中提交表单？

> ID：13690491
> 
> 赞同：1
> 
> 时间：2012-12-03T19:44:43.440
> 
> 标签：asp.net-mvc, partial-views

我问这个问题是为了确保自己理解这个主题。

> “在局部视图中使用提交按钮的唯一方法是使用 Ajax 技术提交表单”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:50:32.183

Well, technically you could do a normal postback from a partial view. But that would tend to defeat the point of a partial:

1.  the entire page would have to be re-loaded, which means the result of the partial-view postback would need to be a complete page.
2.  the partial view's modularity suffers, because the result of its postback falls out of the partial view's scope (ie, the partial view needs to know about the entire current page).

So, it's an irregular thing to do a non-AJAX postback from a partial view. But there are scenarios where it would be useful/appropriate. Consider for example a "login" partial: you may want to post the credentials back to a specific controller/action, and have that action redirect back to the current page. In that case you could reasonably use a non-AJAX form.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:50:09.233

> 在局部视图中使用提交按钮的唯一方法是使用 Ajax 技术提交表单

你没有说你从哪里得到报价，但这不是真的。

从局部视图提交表单的方式与在主视图中提交表单的方式完全相同。您可以使用自定义字段或通过强类型化您的局部视图来做到这一点。你在哪里挂机？

# asp.net - 使用 Visual Studio 2012 的 Web 表单格式问题

> ID：13690495
> 
> 赞同：0
> 
> 时间：2012-12-03T19:45:02.040
> 
> 标签：asp.net, visual-studio-2010, visual-studio, visual-studio-2012

我升级到 Visual Studio 2012，我似乎无法让格式化程序解开我的指令标签。我有这个指令标签

```
<%@ Page Title=""
    Language="C#"
    MasterPageFile="~/MasterPages/Master1.Master"
    EnableEventValidation="false" 
    AutoEventWireup="true" 
    CodeBehind="WebForm1.aspx.cs" 
    Inherits="Test" %> 
```

当我格式化它时，什么也没有发生（键盘快捷键 control+k，control+f）。在 Visual Studio 2010 中，它将解开标记，使其看起来像这样。

```
<%@ Page Title="" Language="C#" MasterPageFile="~/MasterPages/Master1.Master" EnableEventValidation="false" AutoEventWireup="true" CodeBehind="WebForm1.aspx.cs" Inherits="Test" %> 
```

我比较了两个版本的 Visual Studio 之间的设置，我看不出有什么不同会影响指令标签的展开方式。我需要更改哪些设置才能打开指令标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T17:25:46.683

根据 Visual Studio 团队的回复，这是一个已知错误，不会修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:53:03.700

According to my VS2012, the Key combination is the same (Ctrl E, F).

You can look which Combination your VS is using by going in the Edit Menu, then Advanced >.

# c - 将 fscan() 用于文件，我该如何处理文件中的值？

> ID：13690498
> 
> 赞同：-1
> 
> 时间：2012-12-03T19:45:17.247
> 
> 标签：c

因此，如果我有一个包含多个数字的文件，并且我使用

```
fp = fopen (filename, "r"); 
```

那么现在我可以正确读取文件的内容了吗？我怎么能对文件做点什么。就像在这个文件中一样，有数字，我希望能够将它们相加。

```
fscanf(fp) 
```

将是什么应该是正确的开始？但我不确定除此之外还能做什么。什么代码代表我正在打开的文件中的项目？如果是“x”，那么我想将所有“x”相加，然后除以文件总数。

如何使用文件中的变量并用它们做事？

* * *

编辑代码：

```
if (fp != NULL)
{
     while (fscanf(fp, "%lf", &d) == 1)
     sum += d;
     mean = sum / total;

     printf ("The number of data values read from this file was %.0lf\n", total);
     printf ("\n%.2lf\n", mean);

     fclose(fp);
} 
```

* * *

```
if (fp != NULL)
{
    do
    {
        c = fgetc(fp);
        if (c != EOF)
        {
            if ((char)c == '\n')
            total++;
        }
    } while (feof(fp) == 0); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:40:08.400

添加从文件中读取的数字的简单示例（未强化）...

```
#include <stdbool.h>
#include <stdio.h>

int main(int argc, char** argv)
{
    float sum = 0;
    float eachValue;
    FILE *fp;
    fp = fopen(argv[1], "r");
    while (true)
    {
        int scanned = fscanf(fp, "%f\n", &eachValue);
        if (scanned == 1)
        {       
            sum += eachValue;
        }
        else
        {
            break;
        }
    }
    fclose(fp);
    printf("%f\n", sum);
} 
```

对于硬化，您应该执行诸如处理空行、验证是否有要打开的 arg[1]、处理没有要打开的文件或在打开过程中出现其他错误等情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:57:26.363

通常，您可以使用许多函数从文件中读取。

```
int fgetc(FILE *stream);
char *fgets(char *s, int size, FILE *stream);
int getc(FILE *stream);
int fscanf(FILE *restrict stream, const char *restrict format, ...);
size_t fread(void *restrict ptr, size_t size, size_t nitems,FILE *restrict stream); 
```

根据您的要求使用其中任何一种。

例如，正如您所说，您必须添加文件中的数字。

因此，尝试使用上述任何函数从文件中读取 char 数组，然后使用分隔符（在文件中分隔数字的字符）将数组解析为整数数组或不同的数字。然后很容易找到总和。

你应该看到[man strtod](http://linux.die.net/man/3/strtod)

还有这个[人strtok](http://www.manpagez.com/man/3/strtok/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:18:44.413

如果文件中的唯一内容是有效数字，这将起作用。实际上，它会一直工作到第一个不是有效数字的文本：

```
#include <stdio.h>

int main(void)
{
    double sum = 0.0;
    char const *filename = "data.file";
    FILE *fp = fopen(filename, "r");
    if (fp != 0)
    {
        double d;
        while (fscanf(fp, "%lf", &d) == 1)
            sum += d;
        fclose(fp);
    }
    printf("%g\n", sum);
    return(0);
} 
```

作为一般规则，如果一个函数成功打开一个文件，它应该在完成后关闭它。在这个例子中，系统无论如何都会关闭文件，但养成良好的习惯也是如此。稍加注意，您可以区分格式错误（从 0 返回值`fscanf()`）和 EOF 或 I/O 错误。

# mysql - 查询加入百万条记录很慢，请帮我优化

> ID：13690504
> 
> 赞同：1
> 
> 时间：2012-12-03T19:45:35.623
> 
> 标签：mysql

这是我的查询：

```
SELECT SQL_BUFFER_RESULT SQL_BIG_RESULT users.id, users.email, 
        COUNT(av.user_id) AS article_views_count,
        COUNT(af.id) AS article_favorites_count,
        COUNT(lc.user_id) AS link_clicks_count,
        COUNT(ai.user_id) AS ad_impressions_count,
        COUNT(ac.user_id) AS ad_clicks_count
          FROM users
            LEFT JOIN article_views AS av     ON (av.user_id = users.id AND av.created_at >= '2012-11-28 00:00:00' AND av.created_at <= '2012-11-30 23:59:59')
            LEFT JOIN article_favorites AS af ON (af.user_id = users.id AND af.created_at >= '2012-11-28 00:00:00' AND af.created_at <= '2012-11-30 23:59:59')
            LEFT JOIN link_clicks AS lc       ON (lc.user_id = users.id AND lc.created_at >= '2012-11-28 00:00:00' AND lc.created_at <= '2012-11-30 23:59:59')
            LEFT JOIN ad_impressions AS ai    ON (ai.user_id = users.id AND ai.created_at >= '2012-11-28 00:00:00' AND ai.created_at <= '2012-11-30 23:59:59')
            LEFT JOIN ad_clicks AS ac         ON (ac.user_id = users.id AND ac.created_at >= '2012-11-28 00:00:00' AND ac.created_at <= '2012-11-30 23:59:59')
          GROUP BY users.id
          HAVING (article_views_count + article_favorites_count + link_clicks_count + ad_impressions_count + ad_clicks_count) > 0 
```

一些统计数据可以为您提供背景信息：

1.  用户：1,474,348 行
2.  article_views：32,603,637 行
3.  article_favorites：10,199 行
4.  链接点击次数：4,258,901 行
5.  ad_impressions：66,758,573 行
6.  ad_clicks：324,125 行

加入的每个表在 user_id 和 created_at 上都有一个复合索引（按此顺序）。

我们正在运行 Mysql 5，每个表都是 MyISAM 引擎。

这是查询的解释：[https ://gist.github.com/4197482](https://gist.github.com/4197482)

目标是仅返回在该时间段内有任何活动（查看、收藏、点击、展示、广告点击）的用户。

有什么想法可以优化这个坏男孩吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:16:11.537

您的查询似乎是一个分析查询，可以根据大量数据进行一些分析（因为它包含一个聚合函数和一个 GROUP BY 子句）。

为了提高此类查询的性能，您可以使用以下方式创建然后 JOIN 的物化视图结果：

```
CREATE TABLE my_view AS SELECT ... FROM ... JOIN ... 
```

通过这样做，下一个查询将更加高效，因为 MySQL 只需要计算聚合

然后，您只需要实施一个策略来刷新表（例如通过时间戳）

另一种解决方案是将数据导入 DBMS，该 DBMS 旨在高效处理此类查询：面向列的数据库。例如，InfiniDB 是一个基于 MySQL 的开源 dbms，具有针对分析查询优化的存储引擎。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:53:09.677

Try to split query to `INNER JOIN` with each table and combine them with `UNION`. Like

```
SELECT users.id, users.email, COUNT(av.user_id) AS article_views_count
FROM users
JOIN article_views AS av ON (av.user_id = users.id AND av.created_at >= '2012-11-28 00:00:00' AND av.created_at <= '2012-11-30 23:59:59')
GROUP BY users.id, users.email

UNION

.... 
```

# file - Node.js：处理文件上传，从未调用过“数据”事件

> ID：13690508
> 
> 赞同：2
> 
> 时间：2012-12-03T19:45:44.037
> 
> 标签：file, node.js, file-upload, upload

一个描述问题的简单案例......客户端（使用 HTML5 文件 API 和 XMLHttpRequest2）：

```
var xhr = new XMLHttpRequest ()
xhr.open ('POST', '/upload', true)
xhr.send (file) /* sends as plain binary blob, no multipart/form-data */ 
```

服务器端：

```
var size = 0
request.setEncoding ('binary')
request.on ('data', function (chunk) {
    console.log ('Received ' + (size += chunk.length) / (1024.0 * 1024.0) + ' Mb')
})
request.on ('end', function (chunk) {
    console.log ('Done')
}) 
```

问题是“数据”事件要么永远不会被调用，要么开始拾取文件的错误部分（不是从头开始）。似乎实际数据块在“数据”事件绑定发生之前开始到达。

如何处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T19:34:09.520

我找到了导致问题的原因，结果发现我的数据接收代码是在应用程序逻辑深处的异步回调中执行的。

通过在请求处理程序的开头使用 request.pause() 暂停请求，并在它通过应用程序逻辑层，在绑定“数据”和“结束”事件之后恢复它，可以解决这个问题。

# c# - 添加对列表 c# 结构的引用

> ID：13690509
> 
> 赞同：3
> 
> 时间：2012-12-03T19:45:46.530
> 
> 标签：c#, list, xna

我在 XNA 中遇到了 BoundingSpheres 的问题。我想将 BoundingSphere 添加到 BoundingSpheres 列表中。目前是这样的：

```
Aircraft(Vector3 pos, float radius, CollisionManager colMan)
{ 
    BoundingSphere sphere = new BoundingSphere(pos, radius);
    colMan.AddSphere(sphere)
}

List<BoundingSphere> spheres = new List<BoundingSphere>();

CollisionManager()
{
    spheres = new List<BoundingSphere>();
}

AddSphere(BoundingSphere boundingSphere)
{
    spheres.Add(boundingSphere);
} 
```

而不是添加一个引用，它似乎是在添加值。我相信这是因为 boundingSpheres 是结构？我怎样才能绕过这个？我尝试了 ref 关键字，但列表中的值仍未更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:03:00.777

直截了当，你不能，至少不能直接。结构是[值类型](http://msdn.microsoft.com/en-us/library/s1ax56ch%28v=VS.80%29.aspx)，因此按值传递和存储。即使明智地使用`ref`关键字也无法绕过它，因为`List<T>.Item`无法返回对值类型的引用。

解决方法是将你的`struct`变成 a `class`，或者嵌入到`stuct`a`class`中，或者，只是处理它是一个值类型的事实并适当地对待它（即，不要尝试修改本地副本，而是替换更改时列出）。最后一个选项是，imo，最好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:57:23.553

值类型是按值传递的（这意味着您在方法或容器中获得了新的副本）以避免这种情况，您可以将结构更改为类，向结构声明添加接口并将结构装箱以存储对的引用而是界面。

但是您似乎正在使用可变结构，这是非常危险的，因为您可能会面临非常危险的行为（有关更多详细信息，请参阅[被认为有害](https://stackoverflow.com/search?q=mutable%20structs%20evil)的可变结构）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:02:47.257

您必须将定义[`BoundingSphere`](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.boundingsphere.aspx)从[class](http://msdn.microsoft.com/en-us/library/0b0thckt%28v=vs.71%29.aspx)更改为[struct](http://msdn.microsoft.com/en-us/library/ah19swz4.aspx)。这是不可能的，因为它是在[您无法控制的程序](http://msdn.microsoft.com/en-us/library/bb196942.aspx)集中定义的。

您不能对结构进行装箱，因为每次拆箱时，您都会得到您所持有的结构的副本。

也就是说，您可以做到这一点的唯一方法（在我看来，这不是一个好主意）是为结构创建一个类包装器，并将所有来自属性的调用委托给内部结构：

```
public class BoundingSphereWrapper
{
     // Set through constructor.
     private readonly BoundingSphere _boundingSphere = ...;

     // One of the forwarded calls.
     public ContainmentType Contains(BoundingBox box)
     {
         // Forward the call.
         return _boundingSphere.Contains(box);
     }

     // And so on...
} 
```

当然，您不能将这些类实例传递给期望 a 的成员`BoundingSphere`，并且当您公开底层结构时，您必须尝试检测更改（这几乎是不可能的，除非实例通过引用传递）。

也就是说，虽然，你并不是真的想这样做；该结构的设计者可能出于以下原因选择它作为结构：

*   虽然是可变的（在处理结构时这是一个禁忌），但它的生命周期是有限的
*   可能同时实例化了许多这样的实例，并且在堆栈上执行此操作比在堆上执行此操作更有效（这会导致大量第一代垃圾收集，这肯定会对性能产生影响）游戏平台）

# asp.net - 在 ASP.Net 中检测计算机或移动设备

> ID：13690512
> 
> 赞同：-2
> 
> 时间：2012-12-03T19:46:02.880
> 
> 标签：asp.net, vb.net

当用户访问您的网站时，是否有办法知道他们使用的是什么类型的设备：计算机、平板电脑或移动设备？例如，当我收到电子邮件时，有时我会看到它说是通过 iphone 发送的；他们怎么知道的？任何帮助或指出我正确的方向都会非常有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:53:02.503

**Short answer**: You can't.

**Long answer**:

All you have is the information in the HTTP User-Agent header, which usually contains the OS name and version.

Usually, browsers running on Mac OS and Linux send enough information to identify the exact OS. For example, here's my User-Agent header:

```
Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.0.7) Gecko/2009030423 Ubuntu/8.10 (intrepid) Firefox/3.0.7 
```

You can see that I'm running Ubuntu 8.10 Intrepid Ibex.

And here's what Firefox and Safari 4 Beta report on my MacBook Pro:

```
Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.0.7) Gecko/2009021906 Firefox/3.0.7

Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_6; en-us) AppleWebKit/528.16 (KHTML, like Gecko) Version/4.0 Safari/528.16 
```

Windows browsers, on the other hand, usually only report the OS version and not the specific package (Pro, Business, etc.):

```
Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:x.x.x) Gecko/20041107 Firefox/x.x 
```

**I did not write this awnser i copied it from: [Detect exact OS version from browser](https://stackoverflow.com/questions/647969/detect-exact-os-version-from-browser) Thanks to: Can Berk Güder**

# python - 使用 Python / Django 后端使用 XML 或 JSON 将数据解析为 Objective-C

> ID：13690514
> 
> 赞同：0
> 
> 时间：2012-12-03T19:46:09.870
> 
> 标签：python, objective-c, xml, django, json

好吧！我有一个问题要问您...目前正在考虑使用 Objective-C 构建 Iphone 应用程序，并且由于网站已经构建，因此将使用 Python / Django 作为后端。这意味着所有内容都已存储在数据库中。我们将使用一个名为 sweetpie 的应用程序作为我们的 API，它可以将数据提取为 JSON 格式或 XML。

但是我想知道哪个最适合我的需求，JSON 还是 XML？将要提取的数据是一个目录列表，它将在每个属性中显示一个地图。然后是一个显示大量食谱的页面。

如果您能给出您认为最适合从 JSON 或 XML 使用的想法，那就太棒了！:)

如果您需要了解更多信息，请告诉我。

谢谢，

乔什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:01:42.683

这实际上取决于您需要表示的数据。

如果您需要表示编程语言对象，JSON 可能是您的最佳选择，它比 XML 更轻量级且更易于阅读。

如果您需要使用其自定义模式来表示一个复杂的数据结构，您可能希望尝试一下 XML。

话虽如此，Objective-C 提供了 XML 和 JSON 解析器。

# c# - 检查一组总是变化的字符串是否包含字符串的最快方法

> ID：13690515
> 
> 赞同：2
> 
> 时间：2012-12-03T19:46:14.043
> 
> 标签：c#, arrays, string, comparison, hashset

这就是我正在做的事情：

1.  取一个字符串
2.  检查 HashSet 是否包含字符串
3.  如果没有，则将字符串添加到 HashSet（如果有，请执行其他操作）

这必须以最快的方式处理非常大的字符串数组

使用 HashSet 是检查字符串是否已经出现的最快方法，还是 .net 4.5 有更好的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T19:48:33.670

请参阅[HashSet.Add](http://msdn.microsoft.com/en-us/library/bb353005.aspx)

> 如果元素被添加到 HashSet 对象，则返回**true ；**如果元素已经存在，则返回**false 。**

```
HashSet<string> hs = new HashSet<string>();
bool b1 = hs.Add("xxx"); //returns true
bool b2 = hs.Add("xxx"); //returns false 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T19:55:40.047

也许使用新的并发数据类型可以加快您的程序，但使用分析器来比较场景并选择最佳选项。

[http://blogs.msdn.com/b/pfxteam/archive/2010/04/26/9997562.aspx](http://blogs.msdn.com/b/pfxteam/archive/2010/04/26/9997562.aspx)

[http://geekswithblogs.net/BlackRabbitCoder/archive/2011/06/16/c.net-fundamentals-choosing-the-right-collection-class.aspx](http://geekswithblogs.net/BlackRabbitCoder/archive/2011/06/16/c.net-fundamentals-choosing-the-right-collection-class.aspx)

[帮助 C#.NET 泛型集合性能和优化](https://stackoverflow.com/questions/1522737/help-with-c-net-generic-collections-performance-and-optimization)

# html - twitter bootstrap 流体网格列

> ID：13690516
> 
> 赞同：0
> 
> 时间：2012-12-03T19:46:27.563
> 
> 标签：html, css, twitter-bootstrap

在使用 Bootstrap 的流体网格时，当您希望内容跨越行的整个宽度时，是否需要声明一列。换句话说，这是否足够

```
<div class="row-fluid">
  This column should span the full width of the row
</div> 
```

或者真的有必要这样做（正如文档所建议的那样）：

```
<div class="row-fluid">
  <div class="span12">This column should span the full width of the row</div>
</div> 
```

另外，根据[文档，当我想在流体网格中嵌套列时](http://twitter.github.com/bootstrap/scaffolding.html#fluidGridSystem)

> 使用流体网格嵌套有点不同[与非流体网格]：嵌套列的数量不应与父级的列数匹配。相反，每个级别的嵌套列都会被重置，因为每一行都占用了父列的 100%。

然后文档继续给出这个例子，其中第一行是一个全角列，第二行有 2 个半角列

```
<div class="row-fluid">
  <div class="span12">Fluid 12
    <div class="row-fluid">
      <div class="span6">Fluid 6</div>
      <div class="span6">Fluid 6</div>
    </div>
  </div>
</div> 
```

除了行的类名之外，我看不出这与非流体网格有什么不同。此外，这个例子似乎与陈述相矛盾

> 嵌套列的数量不应与父级的列数匹配

因为上次我检查了 6 + 6 = 12。有人可以改进这个解释吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T19:52:24.463

(1) I don't see how this is at all different to a non-fluid grid

*   It uses percentages

(2) the number of nested columns should not match the parent's number of columns

Well, bad example, what they simply mean is that the number in the class names should always add up to 12, regardless of what they are nested in.

This is correct:

```
<div class="row-fluid">
  <div class="span6 row-fluid">
     <div class="span4"> &nbsp; </div>
     <div class="span4"> &nbsp; </div>
     <div class="span4"> &nbsp; </div>
  </div>
</div> 
```

instead of this, which is wrong:

```
<div class="row-fluid">
  <div class="span6 row-fluid">
     <div class="span2"> &nbsp; </div>
     <div class="span2"> &nbsp; </div>
     <div class="span2"> &nbsp; </div>
  </div>
</div> 
```

# c++ - 如何使用 C++ 将终端中的列数保存到变量中？

> ID：13690521
> 
> 赞同：0
> 
> 时间：2012-12-03T19:46:48.727
> 
> 标签：c++, terminal, ncurses

我一直在寻找很多，我所拥有的只是 C 的答案，而不是 C++。我正在使用 Linux，所以我将无法使用 windows.h

我需要做的是获取它正在运行的终端窗口中的列数，然后在中间用 ncurses 打印一些东西。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T02:57:08.710

如果您要使用 ncurses，只需使用库中存在[的工具（第 6.3.4 节）即可：](http://www.tldp.org/HOWTO/NCURSES-Programming-HOWTO/printw.html)

```
int main(void) {
    int rows, cols;

    initscr();
    getmaxyx(stdscr, rows, cols); // you now have the max for both axis
} 
```

请务必注意，您应该在收到 SIGWINCH 信号后刷新这些值（和屏幕），否则如果有人更改终端程序的高度或宽度，您的窗口会看起来很奇怪。

ncurses 没有 C++ 版本，因为它不是必需的，但许多人更喜欢*围绕*它创建自己的包装器，以便更轻松地访问他们在应用程序上下文中想要的功能。标`ncurses.h`头将检查是否正在使用 C++，并进行相应调整：

```
#ifdef __cplusplus
extern "C" { 
```

要使用它，只需链接它并按程序使用它，或者在您处理程序中终端 I/O 的任何类中使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:00:13.307

方法如下：

```
int columns=system("tput cols"); 
```

你需要`#include<stdlib.h>`。然后，您可以使用在[任何](http://pubs.opengroup.org/onlinepubs/7908799/xcurses/wprintw.html)您想要的地方`mvprintw(y, x, "your text here") ;`打印文本。

注意`tput lines`给出行数，以防你也想要它。

请注意，我忽略了这条线`I've been searching quite a lot, and all I've had are answers for C, not C++.`。这是（一种方式）你如何做到这一点，*C 或 C++*。您可以[将此](https://github.com/madaan/gamex/blob/master/BitOps.cpp)作为示例。

# c++ - 单例线程的局部方法变量是否安全？

> ID：13690524
> 
> 赞同：3
> 
> 时间：2012-12-03T19:47:00.677
> 
> 标签：c++, thread-safety, singleton

我确实发现了很多关于单例和线程安全的问题，但没有一个能完全回答我这个问题......但如果它是重复的，我深表歉意。

如果我有一个将由多个线程使用的单例对象，我知道应该仔细考虑对成员变量的任何突变，但是对于方法来说是本地的变量呢？

考虑这个伪代码：

```
class Singleton  [assume this has all the trappings of a proper singleton]
{
    int doSomething() {
        SomeObject obj;
        obj.doStuff();
        return obj.result();
    }

} 
```

在这种情况下，本地“obj”线程安全吗？即使 Singleton 类只有一个对象，每个线程是否都有自己的副本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T19:48:35.423

是的，`obj`每个线程都是唯一的。

但是，如果它访问和修改公共数据 - 例如`doStuff`或`result`访问某个`static`成员`SomeObject`或某个全局数据，则可能存在线程问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:55:35.530

正如 Luchian 所说，到目前为止你很好，但是，如果你有一个静态或任何 & 或 * 变量，那么尝试使用互斥锁或自旋锁。互斥锁和自旋锁存在于所有基于 unix 的系统中，我认为您也可以在 Windows 中使用它们，但您首先需要以某种方式添加它们。

这是 pthread 互斥锁的链接：[http ://www.thegeekstuff.com/2012/05/c-mutex-examples/](http://www.thegeekstuff.com/2012/05/c-mutex-examples/)

这里还有一个适用于 Windows 的：http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms686927 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686927%28v=vs.85%29.aspx)

# xml - 以可读格式输出的xml

> ID：13690526
> 
> 赞同：0
> 
> 时间：2012-12-03T19:47:08.630
> 
> 标签：xml, oracle11g, xml-attribute

我有以下查询，它在 xml 的一行中返回所有内容，有没有办法让输出格式为可读格式？就像下面的示例一样。

```
SELECT XMLELEMENT("rss", 
            XMLATTRIBUTES('http://www.georss.org/georss' AS "xmlns:georss"),
                    XMLELEMENT("channel",
                                 XMLAGG(XMLELEMENT("item",
                                                   XMLFOREST(title AS "title",
                                                              description AS "description",
                                                              point AS "georss:point"))))).EXTRACT('/*')
    FROM (SELECT trim(s.sitedesc) AS title, 
          'Employee Count: ' || s.sitefte || '<br /> Bldg Gross SF: ' || s.bldgarea || '<br />' || CASE WHEN s.leasestat = '0' THEN 'Owned' WHEN s.leasestat = '1' THEN 'Leased, end date: ' || trim(l.edate) END || '<br /><a href="../scripts/fmiinfo.asp?file_code=_BLDGLIST&sitecode='||trim(s.sitecode)||'&forceDB=">'||'More Details'||'</a> <br />' AS description,
          trim(s.latitude) || ' ' || trim(s.longitude) AS point
          FROM ls s
            LEFT OUTER JOIN c0 l ON l.sitecode = s.sitecode
          WHERE s.sold <> 1
            AND s.longitude != ' '
        )
; 
```

返回

```
<rss xmlns:georss="http://www.georss.org/georss"><channel><item><title>TITLE</title><description>DESCRIPTION<description><georss:point>LAT LON</georss:point></item> ... </channel></rss> 
```

但为了更容易阅读，希望输出更接近于：

```
<rss xmlns:georss="http://www.georss.org/georss">
<channel>
    <item>
        <title>TITLE</title>
        <description>DESCRIPTION</description>
        <georss:point>LAT LON</georss:point>
    </item>
...
</channel>
</rss> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:56:38.013

您可以使用一个小的 shell 脚本添加返回值，如下所示：

```
#!/bin/sh
# Usage: ./addreturns.sh foobar.xml. 

file=$1

cat $file | perl -pe 's|(<\/.*?>)|\1\n|g' | perl -pe 's|><|>\n<|g' > /tmp/newlines.xml; mv /tmp/newlines.xml $file 
```

# php - 检测重复的标题 - Wordpress RPC

> ID：13690534
> 
> 赞同：0
> 
> 时间：2012-12-03T19:47:41.693
> 
> 标签：php, wordpress

我正在使用以下代码发布到 wordpress

```
 <?php
            require("class-IXR.php");  
            $client = new IXR_Client('http://domain.com/xmlrpc.php');

            $USER = 'user';
            $PASS = 'pass';

            $content['title'] = 'Test title';
            $content['categories'] = array("games");
            $content['description'] = '<p>Lorem ipsum dolor sit amet</p>';
            $content['custom_fields'] = array( array('key' => 'my_custom_fied','value'=>'yes') );
            $content['mt_keywords'] = array('foo','bar');

            if (!$client->query('metaWeblog.newPost','', $USER,$PASS, $content, true))
            {
                die( 'Error while creating a new post' . $client->getErrorCode() ." : ". $client->getErrorMessage());  
            }
            $ID =  $client->getResponse();

            if($ID)
            {
                echo 'Post published with ID:#'.$ID;
            }

    ?> 
```

我怎样才能避免发布重复的标题。例如，如果我已经有标题的帖子`Test it`。当我尝试发布另一个带有标题的帖子时，`Test it`它不应该发布。

Ps：我的博客里有1000个帖子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:28:21.737

```
if (is_null(get_page_by_title( $content['title'], OBJECT, 'post'))) {

// Do your stuff in this case (no post with the same title)

}

else {

// Do not create post

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-25T05:29:15.220

如果您想使用 WordPress XML-RPC API 检查重复的 WordPress 帖子，您将需要使用`wp.getPosts`获取所有已发布的 WordPress 帖子的列表，然后遍历所有帖子以确保存在没有重复。

如[https://codex.wordpress.org/XML-RPC_WordPress_API/Posts](https://codex.wordpress.org/XML-RPC_WordPress_API/Posts)中所示，您需要先检索所有博客文章的列表，然后遍历所有博客文章以确定是否已设置 post_title 或 post_name。

```
$result = $client->query('wp.getPosts','', $USER, $PASS)
if (!$result) {
    die( 'Error while getting posts' . $client->getErrorMessage());
}

$posts = $client->message->params[0];

$title_to_search_for = 'This is a duplicate title   ';

// loop through all of the $posts, see if the title is duped.
$title_to_search_for = trim(strtolower($title_to_search_for));

$is_duplicate = false;

foreach($posts as $post) {
    if (trim(strtolower($post->post_title) === $title_to_search_for)
        $is_duplicate = true;

    if (trim(strtolower($post->post_name) === $title_to_search_for)
        $is_duplicate = true;
} 
```

# mysql - 自动更新队列优先级

> ID：13690540
> 
> 赞同：0
> 
> 时间：2012-12-03T19:48:07.897
> 
> 标签：mysql

我有这张表，它决定了在我的门户网站中显示的文章顺序：-

```
Table- ARTICLE_POSITION
`article_id` int(12) NOT NULL,

`article_position` int(11) NOT NULL 
```

说这是表中的示例数据：-

```
article_id     article_position
56             1
58             2
443            3
88             4
5667           5
322            6 
```

为了显示相关文章，我使用查询根据 article_position 对它们进行排序并显示在网页上，现在的问题是，当我尝试将任何文章移动到不同的位置时说我想将文章 5667 从位置 5 移动到位置 1，我有使用 UPDATE 查询更新介于 1 和 5 之间的每篇文章的位置

最终表结构

```
article_id     article_position
5667           1*
56             2*
58             3*
443            4*
88             5*  
322            6 
```

> （*位置已更新）

当数据库很大时，此更新查询变得非常耗时且效率低下，有没有其他方法可以做到......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:17:25.893

如果您想避免重新排序所有文章，请尝试为 article_position 使用除 int 之外的其他数据类型。使用时间戳之类的东西。然后您的订购查询可以按从最新时间戳到最旧的顺序显示文章。如果您需要将一篇文章移到顶部，只需为其 article_position 元素分配一个较新的时间戳。这应该可以解决必须重新排序原始示例中的所有 article_position 元素的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T21:36:32.257

我假设您正在寻找在 article_position 顺序中的任何位置插入的解决方案。我想不出一个解决方案，您永远不必为所有 article_id 更新 article_position，但您可以抵消每次 article_position 更改时都需要这样做。不是将每个 article_position 增加 1，而是通过增加的位置增量（5、10、25、100 等）为插入添加一些填充。这将为更改现有文章的 article_position 留出空间，而无需更新所有其他文章。

用您的示例进行演示：

```
article_id     article_position
56             5
58             10
443            15
88             20
5667           25
322            30 
```

重新订购后（* = 更新的文章位置）

```
article_id     article_position
5667           2*
56             5
58             10
443            15
88             20
322            30 
```

最终，您将需要更新所有 article_position，以防止在某些文章之间耗尽插入空间。但这可以在某个计划的维护间隔内完成，而不是在每次 article_position 更改时完成。

# objective-c - 从 Plist 加载 AVAudioPlayer 文件 URL

> ID：13690544
> 
> 赞同：1
> 
> 时间：2012-12-03T19:48:27.883
> 
> 标签：objective-c, ios, plist, avaudioplayer

我正在使用大约 50 个 AVAudioPlayers，每个都加载一个单独的音频文件。这些文件是固定的并且在应用程序包中。它们由稍后在应用程序中的事件触发。目前我正在硬编码每个播放器实例的创建，如下所示：

```
//No01
NSURL *no01URL = [[NSURL alloc] initFileURLWithPath: [[NSBundle mainBundle] pathForResource:@"audio1" ofType:@"aiff"]]; 
self.no01Player = [[AVAudioPlayer alloc] initWithContentsOfURL:no01URL error:nil];  
no01Player.numberOfLoops = 0;
no01Player.volume = 0;
no01Player.delegate = self;

//No02
NSURL *no02URL = [[NSURL alloc] initFileURLWithPath: [[NSBundle mainBundle] pathForResource:@"audio2" ofType:@"aiff"]]; 
self.no02Player = [[AVAudioPlayer alloc] initWithContentsOfURL:no02URL error:nil];  
no02Player.numberOfLoops = 0;
no02Player.volume = 0;
no02Player.delegate = self;

//No03 and so on... 
```

显然，这是费力且糟糕的编码实践。我希望将文件列表放在 Plist 中，并将它们加载到仅填充上述代码示例的变量中。我想学习如何做到这一点，但从 Plists、数组、字典等加载数据的经验有限。

任何帮助表示赞赏，即使它是指向我相关教程的方向。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T05:15:54.967

您可以使用“换行符”分隔符简单地将音频文件名放在文本文件中。并读取文件并将名称存储在数组中。要创建 URL，请从数组中动态获取文件名，如下所示

```
// Read description from text file
NSBundle *audioBundle = [NSBundle mainBundle];
NSString *audioPath = [audioBundle pathForResource:audioFileNames ofType:@"txt"];
NSString *audioContent = [NSString stringWithContentsOfFile:audioPath encoding:NSUTF8StringEncoding error:nil];
// ===========Make an array using audioContent=============
NSArray *audioFiles = [audioContent componentsSeparatedByString:@"\n"]; 
```

使用数组获取文件名：

```
NSURL *no01URL = [[NSURL alloc] initFileURLWithPath: [[NSBundle mainBundle] pathForResource:[NSString stringWithFormat:@"%@",[audioFiles objectAtIndex:audioCount]] ofType:@"aiff"]]; 
```

如果你的文件名像 audio1,audio2.. 不需要使用所有这些。只需更改 URL，例如：

```
NSURL *no01URL = [[NSURL alloc] initFileURLWithPath: [[NSBundle mainBundle] pathForResource:[NSString stringWithFormat:@"audio%d",audioCount] ofType:@"aiff"]]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T00:21:18.910

对于其他需要这样做的人来说，这就是我最终得到的结果：

```
//Load location data from Plist file into an Array

NSString *path = [[NSBundle mainBundle] pathForResource:@"Audionodes" ofType:@"plist"];
locationArray = [[NSArray alloc] initWithContentsOfFile:path];

// Create AVAudioPlayers for this view

self.audioPlayerArray = [[NSMutableArray alloc] init];

for (int i = 0; i < [locationArray count]; i++) {

    NSString *filename = [[locationArray objectAtIndex:i] valueForKey:@"filename"];
    NSString *filetype = [[locationArray objectAtIndex:i] valueForKey:@"filetype"];
    int loops = [[[locationArray objectAtIndex:i] valueForKey:@"loops"] intValue];
    NSURL *url = [[NSURL alloc]initFileURLWithPath:[[NSBundle mainBundle] pathForResource:filename ofType:filetype]];

    AVAudioPlayer *player = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:nil];
    player.delegate = self;
    player.numberOfLoops = loops;
    player.volume = 0;

    [self.audioPlayerArray addObject:player];

    [url release];
    [player release];

} 
```

将生成的播放器放在 audioPlayerArray 中意味着我可以稍后再使用它们。

# c++ - 模板函数：如何使用模板类作为参数制作模板函数？

> ID：13690547
> 
> 赞同：1
> 
> 时间：2012-12-03T19:48:35.707
> 
> 标签：c++, templates

是否可以为在其参数列表中具有模板类的函数制作模板？

我想为 statSelection() 和 statInsertion() 制作一个模板，这样我就可以测试不同的排序算法，而不必为我正在测试的每种排序算法创建单独的 stat 函数。（我的排序算法是模板类）

```
#include <iostream>
#include <fstream>
#include <iomanip>
#include <cstdlib>
#include <ctime>
#include "FileGen.h"
#include "FileRead.h"
#include "SelectionSort.h"
#include "SelectionSort.cpp"
#include "InsertionSort.h"
#include "InsertionSort.cpp"

using namespace std;

void statSelection(int[], int[], Selection<int>, Selection<int>);
void statInsertion(int[], int[], Insertion<int>, Insertion<int>);

int main () 
{
    FileGen fileGen;
    FileRead fileRead;
    Selection<int> selectHundred;
    Selection<int> selectThousand;
    Insertion<int> insertionHundred;
    Insertion<int> insertionThousand;
    int valuesHundred[100];
    int valuesThousand[1000];
    fileGen.generateFiles();
    fileRead.readFiles(valuesHundred, valuesThousand);
    statSelection(valuesHundred, valuesThousand, selectHundred, selectThousand);
    fileGen.generateFiles();
    fileRead.readFiles(valuesHundred, valuesThousand);
    statInsertion(valuesHundred, valuesThousand, insertionHundred, insertionThousand);
    system("pause");
    return 0;
}

void statSelection(int vHundred[], int vThousand[], Selection<int> sHundred, Selection<int> sThousand)
{
    cout << "One Hundred Items" << endl;
    sHundred.SelectionSort(vHundred, 100);
    sHundred.selectionSortPreformance();
    cout << "One Thousand Items" << endl;
    sThousand.SelectionSort(vThousand, 1000);
    sThousand.selectionSortPreformance();
}

void statInsertion(int vHundred[], int vThousand[], Insertion<int> iHundred, Insertion<int> iThousand)
{
    cout << "One Hundred Items" << endl;
    iHundred.InsertionSort(vHundred, 100);
    iHundred.insertionSortPreformance();
    cout << "One Thousand Items" << endl;
    iThousand.InsertionSort(vThousand, 1000);
    iThousand.insertionSortPreformance();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:58:05.490

**我宁愿使用多态性。** （没有多态性的解可以在横尺后找到）

我将从一个名为 的抽象类（接口）继承`Insertion<_Tp>`和继承，并将名称和成员函数简单地称为（这将是 Sortable<_Tp> 的虚拟成员函数）。`Selection<_Tp>``ISortable<_Tp>``.InsertionSort``.SelectionSort``.Sort`

```
template<typename _Tp>
class ISortable<_Tp>{
public:
    virtual void Sort(_Tp *, int)=0; // btw functions are usually lowercase
    virtual void Performance()=0; 
};

template<typename _Tp>
class InsertionSort<_Tp> : public Sortable<_Tp>{
//...
    virtual void Sort(_Tp *, int); 
    virtual void Performance(); 
};
//... 
```

所以你的函数可以这样写：

```
void statSelection(int[], int[], Sortable<int>&, Sortable<int>&);

void statSelection(int[], int[], Sortable<int>&sHundred, Sortable<int>&)
{
//...
  sHundred.Sort(vHundred, 100);
  sHundred.Performance();
//...
} 
```

* * *

**没有多态性的解决方案：**

可以这样做，只需将您的排序和性能函数**命名为相同的名称**。

然后

```
template<typename _Tp_sortable>
void statGeneral(int[], int[], _Tp_sortable sHundred, _Tp_sortable)
{
//...
  sHundred.Sort(vHundred, 100);
  sHundred.Performance();
//...
} 
```

例子：（我不确定你是否真的需要`<Selection<int> >`函数后面的部分，但我会用它来调用它。）

```
statGeneral<Selection<int> >(valuesHundred, valuesThousand, selectHundred, selectThousand);
statGeneral<Insertion<int> >(valuesHundred, valuesThousand, insertionHundred, insertionThousand); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:56:49.763

目前尚不清楚您在追求什么，但这是一个具有类模板参数的函数模板。

```
// class template
template <typename T> class Foo {};

// function template
template <typename T>
T doSomething(const Foo<T>& f) { .... } 
```

如果您希望能够将类模板指定为模板参数，那么您需要一个“模板模板参数”：

```
// class templates
template <typename T> class Foo {};
template <typename T> class Bar {};

template <template<class> class T1, class T2>
T2 doSomething(const T1<T2>& f);

Foo<int> f;
Bar<double> b;
int n = doSomething(f);
double x = doSomething(b); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T19:57:39.963

大概是这样的？

```
template <typename T>
void statSelection(T vHundred[], T vThousand[], Selection<T> sHundred, Selection<T> sThousand);

template <typename T>
void statInsertion(T vHundred[], T vThousand[], Insertion<T> iHundred, Insertion<T> iThousand); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T20:05:57.930

你可以使用这样的类：

```
template <class T>
class Sortclass
{
public:
    virtual void sort(T array[] , int size) = 0;
    virtual void preformance() = 0;
};

template <class T>
class AsortClass : public Sortclass<T> 
{
public:
    virtual sort(T array[] , int size)
    {
        //do stuff
    }

    virtual void preformance()
    {
        //do stuff
    }
};

template <class T>
void stat(T vHundred[], T vThousand[], Sortclass<T>& iHundred, Sortclass<T>& iThousand)
{
    cout << "One Hundred Items" << endl;
    iHundred.sort(vHundred, 100);
    iHundred.preformance();
    cout << "One Thousand Items" << endl;
    iThousand.sort(vThousand, 1000);
    iThousand.preformance();
} 
```

然后你可以从这个类继承并实现排序功能。有了这个，你可以很容易地改变排序算法，而不用改变 stat 函数。

其称为策略模式请参阅： [http ://en.wikipedia.org/wiki/Strategy_pattern](http://en.wikipedia.org/wiki/Strategy_pattern)

# java - 在没有换行符的情况下将文本插入 JTextPane

> ID：13690555
> 
> 赞同：0
> 
> 时间：2012-12-03T19:48:52.990
> 
> 标签：java, swing, autocomplete, jtextpane

一段时间以来，我一直在尝试使用以下代码将一个字符（类似于 Eclipse 中的自动完成）插入到 JTextPane 中：

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.util.ArrayList;

import javax.swing.JFrame;
import javax.swing.JTextPane;
import javax.swing.text.StyledDocument;

public class Main implements Runnable
{
private static final long serialVersionUID = 1L;
private static final int WIDTH = 800;
private static final int HEIGHT = 600;
private static final String NAME = "";
private JFrame frame;
private JTextPane textPane = new JTextPane();

public void run()
{
    frame = new JFrame(NAME);
    frame.setPreferredSize(new Dimension(WIDTH, HEIGHT));
    frame.setMinimumSize(new Dimension(WIDTH, HEIGHT));
    frame.setMaximumSize(new Dimension(WIDTH, HEIGHT));
    frame.setResizable(false);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
    frame.setLayout(new BorderLayout()); 
    frame.add(textPane, BorderLayout.CENTER);
    textPane.setPreferredSize(new Dimension(WIDTH, HEIGHT));
    textPane.setEditable(true);
    textPane.addKeyListener(new KeyListener(){

                @Override
                public void keyPressed(KeyEvent arg0) {
                    ArrayList<Integer> keyCode = new ArrayList<Integer>();
                    StyledDocument doc = textPane.getStyledDocument(); 
                    keyCode.add(arg0.getKeyCode());
                    if(keyCode.contains(KeyEvent.VK_OPEN_BRACKET)) /* If an open brace has been hit! */
                    {
                        if(keyCode.contains(KeyEvent.VK_SHIFT)) /* Because brackets and braces use the same keyCode, we needed to 
                                                                 * make sure it was a brace */
                        {
                            try
                            {
                                doc.insertString(textPane.getCaretPosition(), "\n}", null); /* Putting in our new string */
                            } catch(Exception e1) {
                                e1.printStackTrace();
                            }
                            return;
                        }
                        /* Auto-complete it */
                        try
                        {
                            doc.insertString(textPane.getCaretPosition(), "]", null); /* Putting in our new string */
                        } catch(Exception e1) {
                            e1.printStackTrace();
                        }
                    }

                }

                @Override
                public void keyReleased(KeyEvent arg0) {
                    // TODO Auto-generated method stub

                }

                @Override
                public void keyTyped(KeyEvent arg0) {
                    // TODO Auto-generated method stub

                }
    });
    frame.pack(); 
    frame.setVisible(true);

}

public void start()
{
    new Thread(this).start();
}

public final static void main(String args[])
{
    new Main().start();
} 
```

}

我遇到的唯一问题是，似乎 insertString 中的偏移量是行，而不是列；例如，当我尝试将 insertString 的 offest 设置为 0 时，它会将字符*放在*键入的字符后面，所以它最终看起来像这样：

```
)( 
```

而不是我想要的输出：

```
() 
```

但是，如果我将偏移量设置为 1，那么它会下降一整行，使其看起来像：

```
(
) 
```

我无法弄清楚这里发生了什么，或者*除了*使用 setText 之外的任何其他插入文本的方式。

有任何想法吗？我注定只能使用 setText 吗？感谢您的所有时间！

〜美分

编辑：

将代码更改为 SSCCE。

# objective-c - NSUInteger 和 NaN 的值？

> ID：13690556
> 
> 赞同：3
> 
> 时间：2012-12-03T19:49:01.250
> 
> 标签：objective-c, cocoa, nan, foundation, nsuinteger

为什么 NSUInteger 的值是 2^32 - 1 而不是 2^32？这个事实和需要一个 nan 值之间有关系吗？这太令人困惑了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T20:01:29.397

用手指数到 10。真的 ：）

数到 10 的标准方法是`1,2,3,..10`（计算每个手指的[序](http://en.wikipedia.org/wiki/Ordinal_number_%28linguistics%29)数）。然而，“0指”呢？

通常这可能通过将您的手放在我们背后来表示，但这会向系统添加*另*一条信息：您的手是在前面（存在）还是在后面（丢失）？

在这种情况下，将手放在背后相当于分配`nil`给一个`NSNumber`变量。但是，`NSUInteger`表示一个本机整数类型，*它没有*这种额外的状态，并且*仍然必须编码 0*才能有用。

在手指上编码值 0 的关键是简单地计数`0,1,2..9`。相同数量的手指（或信息位）可用，但现在`0`可以考虑有用.. 以没有`10`价值为代价（仍然有 10 根手指，但第 10 根手指仅代表价值`9`）。这与无符号整数具有最大值`2^n-1`而不是的原因相同`2^n`：它允许`0`以最高效率进行编码。

现在，**[`NaN`](http://en.wikipedia.org/wiki/NaN)不是典型的整数值，*而是***来自浮点编码——想想`float`or `CGFloat`。一种这样的常见编码是[IEEE 754](http://en.wikipedia.org/wiki/IEEE_floating_point)：

> 在计算中，NaN，代表非数字，是一个数值数据类型值，表示一个未定义或无法表示的值，尤其是*在浮点计算中*..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T19:50:46.447

2^32-1 因为从 0 开始计数。如果更容易将其视为 2^32 - 2^0。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T19:52:40.687

它是 32 位无符号整数变量可以容纳的最大值。加一，它会环绕为零。

原因是最小的无符号数是零，而不是一。想一想：您可以容纳到小数点后四位的最大数字是 9999，而不是 10000。那是 10^4-1。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T19:51:31.940

您不能将 2^32 存储在 4 个字节中，但如果减去一个，则它适合（结果为 0xffffffff）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-04T10:15:58.870

与您汽车中的里程表显示最大值为 999999 英里/公里（假设为 6 位数字）完全相同的原因 - 虽然有 10^6 个可能的值，但它不能显示 10^6 本身，而是从 0 到 10^6-1。

# android - 使用来自 beem 的 asmack 配置的 jar 获取错误

> ID：13690557
> 
> 赞同：1
> 
> 时间：2012-12-03T19:49:11.737
> 
> 标签：android, xmpp, smack, asmack

所以我最近几天尝试了很多......

我为我的电脑构建了一个 XMPP 服务器和一个客户端，没有任何问题。

比我开始为 Android 创建一个客户端......是的......我只是说我只是不想阅读更多错误......

我阅读了有关 XMPP、Android 和 PubSub 错误的所有内容。现在我建立了这个apk。

我能够连接并保持在线。我的问题是无法构建节点。

所以这是我的代码：

`

```
package com.Eis.androidclient;
import org.jivesoftware.smack.ConnectionConfiguration;
import org.jivesoftware.smack.XMPPConnection;
import org.jivesoftware.smack.XMPPException;
import org.jivesoftware.smackx.pubsub.LeafNode;
import org.jivesoftware.smackx.pubsub.PayloadItem;
import org.jivesoftware.smackx.pubsub.PubSubManager;
import org.jivesoftware.smackx.pubsub.PublishItem;
import org.jivesoftware.smackx.pubsub.SimplePayload;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.View;
import android.widget.Button;

public class Client extends Activity {

static {
    XMPPConnection.DEBUG_ENABLED = true;
}

ConnectionConfiguration connConfig = new ConnectionConfiguration(
        "192.168.0.100", 5222);
XMPPConnection connection = new XMPPConnection(connConfig);
String pubSubAddress = "pubsub."+ connection.getServiceName();
PubSubManager manager = new PubSubManager(connection,pubSubAddress);
SimplePayload payload = new SimplePayload("session",
        "pubsub:NewNode:session", "<sessionId>5678</sessionId>");
PayloadItem<SimplePayload> item = new PayloadItem<SimplePayload>(null,
        payload);

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    org.jivesoftware.smack.SmackAndroid.init(this);
    Button node = (Button)findViewById(R.id.button1);

    node.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {
            node();     
        }
    });

    Thread thread = new Thread(){
        public void run(){

            try {
                connection.connect();
                connection.login("tester", "tester");
            } catch (XMPPException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }

    };

    thread.run();
    // putting null for id means you let server generate id
    // you could use publish() for asynchronous call

}

public void node(){

    PubSubManager manager = new PubSubManager(connection);
    LeafNode myNode = null;

   // manager.discoverNodes("NewNode");
    try {
        manager.getNode("NewNode");
        System.out.println("found");
        manager.deleteNode("NewNode");
        System.out.println("delete");
    } catch(XMPPException e){
        System.out.println("nothing to do");
        e.printStackTrace();
    }
    try{
        myNode = manager.createNode("NewNode2");
        System.out.println("created");
    } catch (XMPPException e) {
        System.out.println("nothing created");
        e.printStackTrace();
    }

    // you could use publish() for asynchronous call

//      try {
//          myNode.send(item);
//          System.out.println("versendet");
//      } catch (XMPPException e) {
//          System.out.println("wird nicht gesendet");
//          e.printStackTrace();
//      }

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
} 
```

} `

我的应用程序在 VM 2.3.3 上运行，因此不应该有任何线程问题。

这是错误日志

`07:20:48 PM RCV (1079090656): <iq type="error" id="s1YUr-9" from="pubsub.nils-lappi" to="tester@nils-lappi/Smack"><pubsub xmlns="http://jabber.org/protocol/pubsub"><create node="NewNode2"/></pubsub><error code="409" type="cancel"><conflict xmlns="urn:ietf:params:xml:ns:xmpp-stanzas"/></error></iq>`

所以我不知道为什么会有冲突，但似乎其余的都可以

由于冲突的错误代码： `at org.jivesoftware.smackx.pubsub.packet.SyncPacketSend.getReply(SyncPacketSend.java:53)`

希望这里有人可以帮助我...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T14:20:19.230

节点**NewNode2**已经存在，您正在尝试再次创建它。

注意：您可以将 PubsubManager 的创建简化为

```
new PubsubManager(connection); 
```

使用*pubsub*作为服务名其实是默认的。

# python - 一种关闭能够在 Python 中分析可变长度字符串的阅读窗口的干净方法？

> ID：13690559
> 
> 赞同：0
> 
> 时间：2012-12-03T19:49:27.693
> 
> 标签：python, frame, sequence

我正在尝试创建一个可以分析字符串序列的程序。目前，我的程序能够逐个字符地检查序列，但我不知道如何干净地让它识别字符串的结尾，这将是可变的。

```
str_exp="ABCDAABKLYWAKAT"

n=0
x=5

while n<=10:

  window=str_exp[n:x]
  print window,
  n+=1
  x+=1

  countA=window.count('A') 
  print countA 
```

这应该输出：

```
ABCDA 2
BCDAA 2
CDAAB 2
DAABK 2
AABKL 2
ABKLY 1
BKLYW 0
KLYWA 1
LYWAK 1
YWAKA 2
WAKAT 2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:58:55.270

您只需将`while`循环中的条件更改为基于`len(str_exp)`，这将检测字符串的长度。我会留给你来计算算术，因为你已经掌握了所有的基本部分

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:58:02.773

您可以使用`len(s)`. 因此，一种方法是替换这一行：

```
while n<=10: 
```

有了这个：

```
while n<=len(str_exp) - 5: 
```

但是，您通常不想要`n = 0 … while n<=bound: … n+=1`Python 中的循环。最好用 just 替换所有三行`for n in range(bound):`。`range(5)`只是意味着`[0, 1, 2, 3, 4]`, 并且意味着“用, 然后用, ..., 然后用`for n in [0, 1, 2, 3, 4]:`” 运行这个循环，这正是它的意思。所以：`n=0``n=1``n=4``n = 0 … while n<=4: … n+=1`

```
for n in range(len(str_exp)-5): 
```

但是，无论哪种方式，很容易搞砸并得到一个错误的错误，您要么错过最后一个窗口，要么走得太远并通过它。（幸运的是，在 Python 中，这意味着您只需打印一个只有 4 个字符而不是 5 个字符的窗口，而不是说，由于段错误而崩溃。）因此，通常最好想办法重写您的代码，这样您不需要那个。

有时，向后思考比向前思考更容易。需要花点时间来确定我想从`0`to转到`len(str_exp) - 5`……但是如果我向后定义切片，对我来说很明显我可以从`5`to 转到`len(str_exp)`。如果你也是这样，你可以像这样重写它：

```
for n in range(5, len(str_exp)):
    window=str_exp[n-5:n]
    … 
```

或者，如果两者都不明显，您可以用不同的方式定义事物。例如，如果你想直到窗口不再长 5 个字符：

```
for n in range(len(str_exp)):
    window=str_exp[n:x]
    if len(window) < 5:
        break
    … 
```

还有更激进的方式来重新思考这一点。举个例子，你可以写一个通用`window`函数，然后你的循环看起来像这样：

```
for window in iterwindow(str_exp, 5):
    … 
```

你可能还不能写，甚至读这个`iterwindow`函数。它看起来像这样：

```
def window(iterable, windowlength):
  window = ''
  for i in iter(iterable):
    if len(window) == windowlength:
      window = window[1:]
    window = window + i
    if len(window) == windowlength:
      yield window 
```

但是如果其他人已经编写了它（在标准库中，或者您可以在 PyPI 上找到的模块中），您可以使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T19:58:39.193

做这个：

```
windowlen = 5
for end in range(windowlen,len(str_exp)):
    print str_exp[end-windowlen:end] 
```

Range 只是创建一个数字列表。通过让最后一个数字成为 中的最后一个索引`str_exp`，并通过参考结尾创建窗口的开头，您可以确保您永远不会跑到结尾。

将`range`表达式放入您的 python shell 以查看它的作用。

# testing - 角http测试

> ID：13690561
> 
> 赞同：1
> 
> 时间：2012-12-03T19:49:29.650
> 
> 标签：testing, mocking, angularjs

我有一个相当简单的控制器，它获取一个简单的 json 对象列表......

```
function ProductGroupsCtrl($scope, $http, $routeParams, sharedService, popupService) {

$scope.list = null;
$scope.selectedItem = null;
$scope.selectedItemJsonString = '';

$scope.selectItem = function (item) {
    $scope.selectedItem = item;
    $scope.selectedItemJsonString = JSON.stringify(item);
    //alert(JSON.stringify(item));
};

$scope.closePopup = function () {
    $scope.selectedItem = null;
    $scope.selectedItemJsonString = '';
};

// sharedService.prepForBroadcast($routeParams.anotherVar);

$http({
    method: 'GET',
    url: '/ProductGroup'
}).success(function (data) {
    $scope.list = data;
}).
error(function (data) {
    $scope.message = 'There was an error with the data request.';
});

} 
```

然后我尝试在测试类中模拟请求：

```
var scope, ctrl, $httpBackend, sharedServiceMock = {}, popupServiceMock = {};

beforeEach(inject(function (_$httpBackend_, $rootScope, $controller) {
    $httpBackend = _$httpBackend_;

    $httsypBackend.expectGET('/ProductGroup').
    respond([{
        ProductGroupID: 5,
        MenuTitle: "Promotional Products",
        AlternativeText: "Coming soon - a collection of environmentally friendly Promotional Products",
        OrdinalPosition: 5,
        Active: false
    }]);

    scope = $rootScope.$new();
    ctrl = $controller(ProductGroupsCtrl, {
        $scope: scope,
        $http: $httpBackend,
        sharedService: sharedServiceMock,
        popupService: popupServiceMock
    });})); 
```

但是我在睾丸窗口中收到一个错误`object undefined`。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T11:11:03.703

找到了答案。如果我从 $http.get 方法中删除错误回调函数，那么它可以工作，即删除以下...

```
error(function (data) {
    $scope.message = 'There was an error with the data request.';
} 
```

我不得不说，对于不是日常 JavaScript 程序员的人来说，Angular 确实是一条陡峭的学习曲线（尽管我似乎做得越来越多）。无论如何，感谢您的帮助 KatieK :-)

# antlr - 如何使用 ANTLR 重写具有复合根的子树？

> ID：13690564
> 
> 赞同：2
> 
> 时间：2012-12-03T19:49:40.600
> 
> 标签：antlr, antlr3

我有一个带有如下子树的 antlr 语法：

```
 ^(type ID) 
```

我想转换为：

```
 ^(type DUMMY ID) 
```

其中类型是“a”|“b”。

注意：我真正想做的是通过生成虚拟名称将匿名实例转换为显式实例。

我已将其范围缩小到以下语法，但我得到了这个：

```
(a bar) (b bar)
got td
got bu
Exception in thread "main" org.antlr.runtime.tree.RewriteEmptyStreamException: rule type
        at org.antlr.runtime.tree.RewriteRuleElementStream._next(RewriteRuleElementStream.java:157)
        at org.antlr.runtime.tree.RewriteRuleSubtreeStream.nextNode(RewriteRuleSubtreeStream.java:77)
        at Pattern.bu(Pattern.java:382) 
```

错误消息继续。到目前为止我的调试：

1.  输入通过初始语法生成两棵树。一个酒吧和一个酒吧。
2.  第二个语法确实匹配树。它正在打印 td 和 bu。
3.  重写崩溃，但我不知道为什么？RewriteEmptyStreamException 是什么意思。

**进行这种重写的正确方法是什么？**

我的主要语法 Rewrite.g：

```
grammar Rewrite;

options {
  output=AST;
}

@members{
  public static void main(String[] args) throws Exception {
      RewriteLexer lexer = new RewriteLexer(new ANTLRStringStream("a foo\nb bar"));
      RewriteParser parser = new RewriteParser(new CommonTokenStream(lexer));
      CommonTree tree = (CommonTree)parser.test().getTree();
      System.out.println(tree.toStringTree());

      CommonTreeNodeStream nodes = new CommonTreeNodeStream(tree);        
      Pattern p = new Pattern(nodes);

      CommonTree newtree = (CommonTree) p.downup(tree);
  }
}

type 
    : 'a'
    | 'b'
    ;

test : id+;
id   : type ID  -> ^(type ID["bar"]);

DUMMY : 'dummy';
ID   : ('a'..'z')+;
WS : (' '|'\n'|'r')+ {$channel=HIDDEN;}; 
```

和 Pattern.g

```
tree grammar Pattern;

options {
    tokenVocab = Rewrite;
    ASTLabelType=CommonTree;
    output=AST;
    filter=true;             // tree pattern matching mode
}

topdown
    : td
    ;

bottomup
    : bu
    ;

type 
    : 'a'
    | 'b'
    ;

td
    : ^(type ID) { System.out.println("got td"); }
    ;

bu
    : ^(type ID) { System.out.println("got bu"); }
        -> ^(type DUMMY ID)
    ; 
```

编译：

```
java -cp ../jar/antlr-3.4-complete-no-antlrv2.jar org.antlr.Tool Rewrite.g 
java -cp ../jar/antlr-3.4-complete-no-antlrv2.jar org.antlr.Tool Pattern.g 
javac -cp ../jar/antlr-3.4-complete-no-antlrv2.jar *.java 
java -classpath .:../jar/antlr-3.4-complete-no-antlrv2.jar RewriteParser 
```

编辑 1：我也尝试过使用 antlr4，但我遇到了同样的崩溃。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:48:38.863

有两个小问题需要解决才能使重写工作，一个问题`Rewrite`在`Pattern`.

`Rewrite`语法`^(type ID)`在输出 AST 中作为根元素生成，如输出所示`(a bar) (b bar)`。不能转换根元素，因为转换实际上是子交换的一种形式：元素的父元素丢弃该元素并用新的“转换”版本替换它。没有父母，你会得到错误`Can't set single child to a list`。添加根是创建一个虚构的令牌`ROOT`或任何您喜欢的名称并在您的入门级规则的 AST 生成中引用它的问题，如下所示`test : id+ -> ^(ROOT id+);`：

产生错误的`Pattern`语法被`type`规则混淆：`type : 'a' | 'b' ;`作为重写的一部分。我不知道这里的低级细节，但显然树解析器不会像编写转换时那样维护已访问根规则的状态`type`（`^(type ID)`或者它不能或不应该，或者它可能是一些其他限制）。解决此问题的最简单方法是进行以下两个更改：

*   通过将 rule in from更改为 just ，让文本“a”和“b”匹配`ID`词法分析器中的规则。`type``Rewrite``type: 'a' | 'b';``type: ID;`
*   让规则匹配并转换`bu`为。`Pattern``^(ID ID)``^(ID DUMMY ID)`

现在对`Rewrite`'s进行一些小的调试更改`main`，输入`"a foo\nb bar"`会产生以下输出：

```
(ROOT (a foo) (b bar))
got td
got bu
(a foo) -> (a DUMMY foo)
got td
got bu
(b bar) -> (b DUMMY bar)
(ROOT (a DUMMY foo) (b DUMMY bar)) 
```

以下是我更改后的文件：

### 重写.g

```
grammar Rewrite;

options {
  output=AST;
}

tokens { 
 ROOT;
}

@members{
  public static void main(String[] args) throws Exception {
      RewriteLexer lexer = new RewriteLexer(new ANTLRStringStream("a foo\nb bar"));
      RewriteParser parser = new RewriteParser(new CommonTokenStream(lexer));
      CommonTree tree = (CommonTree)parser.test().getTree();
      System.out.println(tree.toStringTree());

      CommonTreeNodeStream nodes = new CommonTreeNodeStream(tree);        
      Pattern p = new Pattern(nodes);

      CommonTree newtree = (CommonTree) p.downup(tree, true); //print the transitions to help debugging
      System.out.println(newtree.toStringTree()); //print the final result
  }
}

type : ID;
test : id+ -> ^(ROOT id+);
id   : type ID  -> ^(type ID);

DUMMY : 'dummy';
ID   : ('a'..'z')+;
WS : (' '|'\n'|'r')+ {$channel=HIDDEN;}; 
```

### 模式.g

```
tree grammar Pattern;

options {
    tokenVocab = Rewrite;
    ASTLabelType=CommonTree;
    output=AST;
    filter=true;             // tree pattern matching mode
}

topdown
    : td
    ;

bottomup
    : bu
    ;

td
    : ^(ID ID) { System.out.println("got td"); }
    ;

bu
    : ^(ID ID) { System.out.println("got bu"); }
        -> ^(ID DUMMY ID)
    ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:27:22.150

我对树模式没有太多经验，不管有没有重写。但是当在其中使用重写规则时，我相信您的选项也应该包括`rewrite=true;`. Definitive ANTLR Reference 不处理它们，所以我不完全确定（查看[ANTLR wiki](http://www.antlr.org/wiki)了解更多信息）。

但是，对于这种（相对）简单的重写，您实际上并不需要单独的语法。您可以制作`DUMMY`一个虚构的标记并将其*注入*其他一些解析器规则，如下所示：

```
grammar T;

options {
  output=AST;
}

tokens {
  DUMMY;
}

test : id+;
id   : type ID  -> ^(type DUMMY["dummy"] ID);

type 
 : 'a'
 | 'b'
 ;

ID : ('a'..'z')+;
WS : (' '|'\n'|'r')+ {$channel=HIDDEN;}; 
```

这将解析输入：

```
a bar 
b foo 
```

进入以下AST：

![在此处输入图像描述](../Images/076b376108623bd5d6dab76d8dc90a58.png)

请注意，如果您的词法分析器还打算将输入标记`"dummy"`为标记，请将块`DUMMY`更改为：`tokens { ... }`

```
tokens {
  DUMMY='dummy';
} 
```

而且您仍然可以在其他规则中*注入*a 。`DUMMY`

# android - Android多种屏幕尺寸，避免重复图像

> ID：13690566
> 
> 赞同：1
> 
> 时间：2012-12-03T19:49:50.023
> 
> 标签：android, resources, screen, resolution

我有一个应用程序在 TextView 中将位图显示为“drawableTop”：

```
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_height="fill_parent"
    android:layout_weight="1"
    android:drawableTop="@drawable/bitmap"
    android:gravity="center"
    android:text="@string/text" /> 
```

位图来自 res/drawable 文件夹中的一个 PNG 文件，我们称之为 bitmap.png。

我需要支持多种屏幕尺寸和密度，并且想找到最便宜的方法（就我需要在 res/* 文件夹中有多少 PNG 文件而言）来做到这一点。

**各种密度：仅限手机**

我得出的结论是，将 bitmap.png 放在 res/drawable-xhdpi 文件夹中就足够了。在高密度的手机上显示时，会按原样显示，而在低密度的手机上会自动缩小。换句话说，不需要在 res/drawable-hdpi、res/drawable-mdpi 等中使用较低分辨率的 bitmap.png 版本。基本上，对于所有手机来说，**只需一个版本**的 PNG 文件就足够了。

**各种密度：平板电脑**

现在，如果我还想支持平板电脑，就会出现问题：大屏幕和超大屏幕。在平板电脑上，我希望图标的纵横比与手机上的相同：如果位图占据手机屏幕的 1/4，我希望它占据平板电脑屏幕的 1/4。我不能像以前一样重复使用相同的 PNG 文件，否则它看起来太小了，因为平板电脑只有更多的像素......所以对于平板电脑，我需要更高分辨率的 PNG。这适用于大屏幕和超大屏幕。

这导致需要 3 个文件夹和 3 个版本的 PNG：

1: res/drawable-xhdpi/bitmap.png
2: res/drawable-large-xhdpi/bitmap.png
3: res/drawable-xlarge-xhdpi/bitmap.png

但是 1 和 2 基本上是 3 的低分辨率版本。

那么有没有一种简单的方法来拥有一个文件夹而不是 3？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:02:08.770

如果您正在谈论最便宜的方法（不在可绘制对象中添加多个图像），请使用**9-Patch Images**。如果您对此不了解，请在此处查看并了解用法：

[http://www.androiddom.com/2011/05/android-9-patch-image-tutorial.html](http://www.androiddom.com/2011/05/android-9-patch-image-tutorial.html)

[http://www.androiddom.com/2011/05/creating-custom-drawn-button.html](http://www.androiddom.com/2011/05/creating-custom-drawn-button.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-11T22:57:29.333

从您的问题来看，平板电脑或手机不需要不同方向的图像。如果您希望图像在两个设备上都采用 1/4 大小，则在 xml 中将图像定义为使用 d(i)p。这会将图像缩放到所有设备上的相同大小。

d(i)p 相对于 640x480（或纵向的 480x640 分辨率）进行缩放。因此您可以计算不同的分辨率组合以覆盖 1/4 的屏幕空间，例如 320x240 或 240x320

如果您想控制图像的缩放，我建议将图像放在 ImageView 中。这将允许您使用**android:scaleType**属性按您的意愿缩放图像。

您可以将 TextView 的背景设置为透明，并将其下方的 ImageView 包含在所需大小的 relativeLayout 中，以实现与当前相同的效果，如下所示：

```
<RelativeLayout
    android:layout_width="320dp"
    android:layout_height="240dp" 
    >

    <!-- Images at the top of the xml are drawn on the bottom! -->

    <ImageView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:scaleType="fitCenter"
        android:src="@drawable/bitmap" 
        />

    <TextView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:gravity="center"
        android:text="@string/text"
        />

</RelativeLayout> 
```

还要考虑使用[别名资源](http://developer.android.com/guide/topics/resources/providing-resources.html#AliasResources)。

这将允许您定义一个 xml 文件，该文件的行为就好像它是真正的 PNG 图像（并且在 R.drawable. 中如此引用，但实际上是对另一个图像的引用。

从链接的谷歌文档：

> 要为现有的可绘制对象创建别名，请使用该元素。例如：
> 
> ```
> <?xml version="1.0" encoding="utf-8"?>
> <bitmap xmlns:android="http://schemas.android.com/apk/res/android"
>     android:src="@drawable/icon_ca" /> 
> ```
> 
> 如果将此文件保存为 icon.xml（在备用资源目录中，例如 res/drawable-en-rCA/），它会被编译为可以引用为 R.drawable.icon 的资源，但实际上是别名对于 R.drawable.icon_ca 资源（保存在 res/drawable/ 中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:43:00.323

如果您只想为所有分辨率保留一张图像，为什么不保留在 res/drawable 和 res/drawable-land 文件夹中呢？

# c++ - QRegExp 一次匹配包含 N 个单词的行，但不考虑顺序（即逻辑与）

> ID：13690571
> 
> 赞同：4
> 
> 时间：2012-12-03T19:50:06.853
> 
> 标签：c++, regex, qt, qregexp

我有一个包含多行文本的文件，我只想匹配那些包含多个单词的行。**所有单词都必须出现**在该行中，但**它们可以以任何顺序出现**。

所以如果我们想匹配*one* , *two* , *three*，下面的前 2 行将被匹配：

```
three one four two <-- match
four two one three <-- match
one two four five
three three three 
```

这可以使用 QRegExp 来完成（**无需拆分文本**并为每个单词分别测试每一行）吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:28:42.880

是的，有可能。使用[前瞻](http://www.regular-expressions.info/lookaround.html)。这将检查主题字符串的以下部分，而不会实际使用它们。这意味着在前瞻完成后，正则表达式引擎将跳回到它开始的位置，您可以运行另一个前瞻（当然在这种情况下，您从字符串的开头使用它）。试试这个：

```
^(?=[^\r\n]*one)(?=[^\r\n]*two)(?=[^\r\n]*three)[^\r\n]*$ 
```

否定字符类`[^\r\n]`确保我们永远不会越过行尾。因为前瞻实际上并没有为匹配消耗任何东西，所以我们`[^\r\n]*`在最后（前瞻之后）和`$`行尾添加 。事实上，你可以省略`$`, 由于 greediness `*`，但我认为它使表达式的含义更加明显。

~~确保将此正则表达式与多行模式一起使用（以便`^`与行首`$`匹配）。~~

**编辑：**

抱歉，QRegExp 显然[不支持多行模式`m`](http://doc.qt.digia.com/qt/qregexp.html)：

> QRegExp 没有与 Perl 的 /m 选项等效的选项，但是可以通过多种方式来模拟，例如通过将输入拆分为行或通过使用搜索换行符的正则表达式进行循环。

它甚至建议将字符串分成几行，这是您要避免的。

由于 QRegExp 也不支持lookbehinds（这将有助于模拟`m`），其他解决方案有点棘手。你可以和

```
(?:^|\r|\n)(?=[^\r\n]*one)(?=[^\r\n]*two)(?=[^\r\n]*three)([^\r\n]*) 
```

那么你想要的那一行应该在 capture group`1`中。但我认为将字符串分成几行可能会产生比这更易读的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-08T14:41:50.060

您可以使用`MultilineOption` `PatternOption`来自新 Qt5 [QRegularExpression](http://doc.qt.io/qt-5/qregularexpression.html#PatternOption-enum)的方法，例如：

```
QRegularExpression("\\w+", QRegularExpression::MultilineOption) 
```

# c++ - 在 Xcode 上将第三方库添加到 OpenCV 项目

> ID：13690572
> 
> 赞同：0
> 
> 时间：2012-12-03T19:50:07.070
> 
> 标签：c++, xcode, opencv

我是 XCode 环境的新手，如果这听起来微不足道，我深表歉意。

我正在尝试使用用于 OpenCV 的第三方库，它可以帮助我进行一些 blob 分析、CCL 等。托管[在这里](http://opencv.willowgarage.com/wiki/cvBlobsLib)

我进行了很多搜索，但似乎没有太多关于如何添加和使用这些新库的文档。我正在使用 XCode 4.5.2、OpenCV 2.4.2。

当我简单地将所有头文件添加到项目文件夹并在源代码中#include 时，它​​无法编译。我也尝试添加“标题路径”，但没有帮助。我错过了什么？

我试图按照说明进行操作（使用终端编译它，但它也没有编译）我不清楚如何或何时使用 CMAKE。

任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:58:50.217

试试这个：[cvBlob：OSX 安装](https://stackoverflow.com/questions/8324155/cvblob-osx-installation)

编译完成后，您需要将库包含在 Link Binary with Libraries in Build Phases 下。（此屏幕截图显示`core`、`imgproc`和`highgui`库。您的`cvBlob`库将在同一个地方。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:55:26.753

我建议你**在谷歌代码上使用 CvBlob，**这与 Willowgarage 上的代码不同，我最近对此感到困惑，所以[看看这个问题以获取替代 blob 分析库](https://stackoverflow.com/questions/13530054/blobs-with-opencv-which-library-is-best)。

此外，CvBlob 在这里也有一个很好的支持社区。（在“[cvblobslib]”或“[blob] [opencv]”上搜索）

# c - Serial-/Socket IO 和 GCC nothrow 属性

> ID：13690584
> 
> 赞同：1
> 
> 时间：2012-12-03T19:51:08.307
> 
> 标签：c, gcc, io, mingw

我有在 C 中实现的抽象*串行*和*套接字 IO*（Linux / Windows）的函数。它们都被标记为，`extern "C"`因为它们也可以从 C++ 中调用。

在这里使用`__attribute__((__nothrow__))`（或 MinGW Macro `__MINGW_NOTHROW`）是否安全/我可以假设没有抛出异常吗？

**调用函数 - 套接字：（**
*未列出 WinSock 的所有添加项）*

*   `socket`
*   `connect`
*   `send`/`recv`
*   `close`（`closesocket`在 Windows 上）
*   `sendto`/`recvfrom`

**调用函数 - 串行：**
*由于 windows / linux 之间的串行 IO 代码差异很大，因此此处未列出所有函数*

*   *Linux (GNU)*
    *   `open`
    *   `tcgetattr`
    *   `read`/`write`
    *   `close`
*   *视窗 (MinGW)*
    *   `CreateFile`
    *   `GetCommState`/`SetCommTimeouts`
    *   `ReadFile`/`WriteFile`
    *   `CloseHandle`

由于*ANSI C*没有异常（如果我错了，请纠正我）它们不会被抛出，但是 GCC 扩展和 OS API 调用呢？

文档： http: [//gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html)（参见参考资料`nothrow`）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T20:52:47.953

## C

GNU C (Linux) 使用`__THROW`宏而不是`__MINGW_NOTHROW`. 虽然 MinGW 仅是`__nothrow__`属性，但也`__THROW`包含`__leaf__`属性。

## C++

如果使用 C++，`__THROW`则有另外一种含义：`throw()`- 表示不抛出异常（类似于`__nothrow__`; 但在 C++ 标准中定义）。

所以这取决于你是用 C 还是 C++**编译**，而不是你从什么调用函数（*仅限 GNU C / C++！*）。

**例子：**

```
void f() __THROW; 
```

像...一样对待 ...

**GNU C：**

```
void f() __attribute__((__nothrow__, __leaf__)) 
```

**GNU C++：**

```
void f() throw() 
```

功能^(1))是*取消点*， 因此**未标记**`__THROW`：

*   `open()`
*   `read()`
*   `write()`
*   `close()`
*   `connect()`
*   `send()`
*   `recv()`
*   `close()`
*   `sendto()`
*   `recvfrom()`

功能^(1)) **标**有`__THROW`：

*   `tcgetattr()`
*   `socket()`

至少，这些都保存到`__nothrow__`.

相比之下，**MinGW 并没有将**C 与 C++ 区别开来。在这两种情况下，都设置了属性。

使用上面的示例，`__nothrow__`在 C*和*C++ 上设置：

```
void f() __attribute((__nothrow__)) 
```

功能^(1)) 未**标记**`__MINGW_NOTHROW`：

*   `socket()`
*   `connect()`
*   `send()`
*   `recv()`
*   `closesocket()`
*   `sendto()`
*   `recvfrom()`
*   `CreateFile()`
*   `GetCommState()`
*   `SetCommTimeouts()`
*   `ReadFile()`
*   `WriteFile()`
*   `CloseHandle()`

简而言之：**没有！**

> ## 兼容性
> 
> ### 与 C
> 
> 期望与 C++ 互操作的 C 语言代码应使用 -fexceptions 进行编译。这将使调试作为 C++ 引发的堆栈展开的一部分调用的 C 语言函数成为可能。
> 
> 特别是，展开到没有异常处理数据的帧将导致运行时中止。如果展开器在找到处理程序之前用完展开信息，则调用 std::terminate()。
> 
> 请注意，大多数开发环境都应该注意正确获取这些细节。对于 GNU 系统，GNU C 库的所有适当部分都已使用 -fexceptions 进行编译。

[（来源： http: [//gcc.gnu.org/onlinedocs/libstdc++/manual/using_exceptions.html](http://gcc.gnu.org/onlinedocs/libstdc++/manual/using_exceptions.html)）]

因此编译时`-fexceptions`不需要等效属性。如果您只能标记您必须/应该使用的特定功能`__nothrow__`。

但是，虽然使用`__nothrow__`属性看起来只在 GNU C++ 上保存，并且在 Linux 上使用 GNU C 的一些功能，但在 Windows 上并不那么清楚。

* * *

### 附录：

为了避免这个问题的某些部分，我编写了一个类似于`__THROW`但也可以在 MinGW 上使用的宏：

```
#if defined __GNUC__
    #ifndef __THROW
        #ifdef  __cplusplus
            #define __THROW         throw()
        #else
            #define __THROW         __attribute__((__nothrow__))
        #endif
    #endif
#else
    #define __THROW
#endif 
```

*注：* `__leaf__`不包括在内。

* * *

^(1）) *只谈论我的问题中列出的那些。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T23:16:54.943

照顾 gcc 版本，`nothrow`已与 gcc 3.3 一起引入！

你可以`__THROW`从`sys/cdefs.h`mingw 移植：

```
/* skip this entire part on linux (= glibc available)*/
#if defined __GNUC__ && !defined __linux__

/********* port __GNUC_PREREQ macro to mingw *********/
# if !defined __GNUC_PREREQ

# if !defined __MINGW_H
#  include <_mingw.h>
#  define __GNUC_PREREQ(major, minor)       __MINGW_GNUC_PREREQ(major, minor)
# else
#  if defined (__GNUC_MINOR__)
#   define __GNUC_PREREQ(major, minor)      __GNUC__ > (major) || (__GNUC__ == (major) && __GNUC_MINOR__ >= (minor)))
#  else
#   define __GNUC_PREREQ(major, minor)      0
#  endif
# endif 

#endif /* __GNUC_PREREQ */

/********* from gnu c blirary *********/

/* All functions, except those with callbacks or those that
   synchronize memory, are leaf functions.  */
# if __GNUC_PREREQ (4, 6) && !defined _LIBC
#  define __LEAF , __leaf__
#  define __LEAF_ATTR __attribute__ ((__leaf__))
# else
#  define __LEAF
#  define __LEAF_ATTR
# endif

/* GCC can always grok prototypes.  For C++ programs we add throw()
   to help it optimize the function calls.  But this works only with
   gcc 2.8.x and egcs.  For gcc 3.2 and up we even mark C functions
   as non-throwing using a function attribute since programs can use
   the -fexceptions options for C code as well.  */
# if !defined __cplusplus && __GNUC_PREREQ (3, 3)
#  define __THROW       __attribute__ ((__nothrow__ __LEAF))
#  define __THROWNL     __attribute__ ((__nothrow__))
#  define __NTH(fct)    __attribute__ ((__nothrow__ __LEAF)) fct
# else
#  if defined __cplusplus && __GNUC_PREREQ (2,8)
#   define __THROW      throw ()
#   define __THROWNL    throw ()
#   define __NTH(fct)   __LEAF_ATTR fct throw ()
#  else
#   define __THROW
#   define __THROWNL
#   define __NTH(fct)   fct
#  endif
# endif

#else   /* Not GCC.  */

# define __inline       /* No inline functions.  */

# define __THROW
# define __THROWNL
# define __NTH(fct) fct

#endif  /* GCC.  */ 
```

有关完整代码，请参见[glibc - sys/cdefs.h](http://sourceware.org/git/?p=glibc.git;a=blob_plain;f=misc/sys/cdefs.h;hb=HEAD)。

*编辑：* `__GNUC_PREREQ`可以替换为`__MINGW_GNUC_PREREQ(major, minor)`，那么您不必像上面那样重新定义它。

# javascript - 从 xml 动态创建下拉列表

> ID：13690587
> 
> 赞同：2
> 
> 时间：2012-12-03T19:51:38.363
> 
> 标签：javascript, xml, forms, drop-down-menu

我今天在创建下拉列表时遇到问题：

我有这样的结构的xml文件：

```
<resultset>
  <row>
    <field name="iso3166_2">AF</field>
    <field name="country">AFGHANISTAN</field>
    <field name="fixed">1.000</field>
    <field name="mobile">1.300</field>
  </row>
  <row>
    <field name="iso3166_2">US</field>
    <field name="country">ALASKA</field>
    <field name="fixed">0.100</field>
    <field name="mobile">0.100</field>
  </row>
</resultset> 
```

我想创建一个包含国家名称的下拉列表（取自这些字段：）`<field name="country">...</field>`。

此外，在从此下拉列表中选择国家后，我想显示来自`fixed`和来自与在此类跨度中选择`mobile`的相同`row`集合的变量：`country`

`<span id="mobile"><!-- mobile value --></span>`并且在`<span id="fixed"><!-- fixed value --></span>`

我希望很清楚我想要实现什么，我试图用类似问题的答案来解决它：[从 xml 动态加载数据到带有 jquery 的下拉框，](https://stackoverflow.com/questions/655340/dynamic-load-data-from-xml-to-drop-down-box-with-jquery)但它对我不起作用（我想我做错了什么）。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T21:29:07.520

像这样的东西应该工作：

```
$.ajax({
    url: 'img/test.xml',
    dataType: 'xml', // Make sure it knows to treat it as XML
    success: function(xml) {
        var rows = xml.childNodes[0].getElementsByTagName("row"),
            // This assumes your <select> has id of "countries"
            $dropdown = $("#countries");

        $(rows).each(function(index, row) {
            var fields = row.getElementsByTagName("field"),
                $option = $(document.createElement("option"));

            $(fields).each(function(index, field) {
                var name = field.getAttribute("name"),
                    // A special way to get the text contents of an XML node
                    value = $(field).contents()[0].wholeText;

                // If it's the "country" field, just stick it in the option
                if (name == "country") {
                    $option.text(value);
                } else {
                    // If it's anything else, store it as extra data
                    $option.data(name, value);
                }
            });

            $dropdown.append($option);
        });

        // Whenever you change which option is selected
        $dropdown.change(function() {
            $option = $dropdown.find(":selected");

            // Fill in the spans using the extra data you saved
            $("#fixed").text($option.data("fixed"));
            $("#mobile").text($option.data("mobile"));
        });
    }
}); 
```

简而言之，如果您通过 AJAX 提取 XML，请确保将其视为 XML，然后您可以将其视为任何其他类型的文档（有一些警告）。很明显，这可以用 vanilla JavaScript 完成，但我发现用 jQuery 更容易。

# java - filtering Timestamp using jpcap

> ID：13690589
> 
> 赞同：0
> 
> 时间：2012-12-03T19:51:45.010
> 
> 标签：java

```
public void receivePacket(Packet packet) { 
for (byte b : ((TCPPacket)packet).option ) 

        { 
                 str += Integer.toHexString(b & 0xff) + ":"; 
                System.out.print(Integer.toHexString(b & 0xff) + ":"); 
        } 

    //if byte has  kind=8 and length=10, that means it has TCP Timestamp Option enabled 

    if(Pattern.matches("(.*)8:a(.*)", str)) 
        { 
                int tsval=0,tsecr=0; 
                int i = str.indexOf("8:a:"); 
                String tmp = str.substring(i+4); 

        for(int lp =1; lp<=3;lp++) 
            { 
                tmp=tmp.replaceFirst(":",""); 
            } 
        tsval = java.lang.Integer.parseInt(tmp.substring(0,tmp.indexOf(":")),16); 

        tmp = tmp.substring(tmp.indexOf(":")+1); 
        for(int lp =1; lp<=3;lp++) 
            { 
                tmp=tmp.replaceFirst(":",""); 
            } 
        if(tmp.indexOf(":")!=-1) 
            tsecr = java.lang.Integer.parseInt(tmp.substring(0,tmp.indexOf(":")),16); 
        else 
            tsecr = java.lang.Integer.parseInt(tmp.substring(0,16)); 
            System.out.println("\tTSval: "+tsval + "\tTSecr: "+tsecr); 

        } } 
```

i have found this solution online for filtering the timestamp of a tcp packet but its giving me an error on str ("cannot find variable str") can anyone help ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:54:41.983

许多这些变量是您从中获取的类的字段。您最好尝试了解该类的工作原理，然后从头开始编写它，而不是尝试修改他们的代码。

# knockout.js - Knockoutjs - complex object binding for newly instanced VM

> ID：13690591
> 
> 赞同：0
> 
> 时间：2012-12-03T19:51:50.333
> 
> 标签：knockout.js

I have a particularly tricky problem with ko. I'll try to explain around some example stuff.

First, here's the html junk I'm trying to render to. The foreach variable "Appliances" is an array and is a property of the viewModel. The option data is also a property array of the view model. The name of that here is ApplianceTypes.

```
 <table>   
 <tbody data-bind="foreach: Appliances">
        <tr>
             <td>
                  <select data-bind="options: $root.ApplianceTypes, value: $data.ApplianceType.Id, optionsValue: 'Id', optionsText: 'ApplianceTypeDesc'">
                  </select>
             </td>
             <td>
                  <input data-bind="value: UnitNumber" />
             </td>                
        </tr>
 </tbody>
 </table> 
```

Ok, so now that we have that in mind, here's the data to fill out ideas a bit better:

```
 var viewModel = {
    RequestNumber:37,
    UnitNumber:3,
    Appliances:[{
        Id:2,
        ApplianceType:{Id:5, ApplianceTypeDesc:"Water Heating Tankless"},
        ServiceApplianceQuantity:"1",
    }],
    ApplianceTypes:[
        {Id:5, ApplianceTypeDesc:"Water Heating Tankless"},
        {Id:1, ApplianceTypeDesc:"Dryer"},
        {Id:2, ApplianceTypeDesc:"Range"},
        {Id:3, ApplianceTypeDesc:"Heating"},
        {Id:4, ApplianceTypeDesc:"Water Heating"},
        {Id:6, ApplianceTypeDesc:"Fireplace"},
        {Id:7, ApplianceTypeDesc:"Make Up Air Heating"},
        {Id:8, ApplianceTypeDesc:"BBQ"}
    ]
    } 
```

So, there's no big problem here yet. I get a UI with a row for each appliance. Each row is a type dropdown filled with appliance types. If I'm just editing what I have, viewModel.Appliances[i].ApplianceType.Id updates and life is good. If I try to add new to my appliances array, the applianceType.Id doesn't get updated. Here's the code for that:

```
function ApplianceTypeViewModel() {
var self = this;
self.Id = ko.observable("5");
self.ApplianceTypeDesc = ko.observable("");
};

function ApplianceViewModel(applianceType) {
    var self = this;
    self.Id = ko.observable("-1");
    self.ApplianceType = ko.observable(applianceType);
    self.ServiceApplianceQuantity:"1"
};

viewModel.AddAppliance = function () {
    viewModel.Appliances.push(new ApplianceViewModel(new ApplianceTypeViewModel()));
}; 
```

Ultimately it would be nice to have the applianceType copied from the array over the Appliances[i].ApplianceType, but honestly, I'm just trying to get the Id to update there. The rest I can do on the server.

If the data exists, it will change everytime. When I create it new (with AddAppliance), the data will not change.

Thanks Everyone!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:32:41.317

你`ApplianceType`在你`ApplianceViewModel`是一个可观察的。但是，您`value`对 select 元素的绑定是

```
value: $data.ApplianceType.Id 
```

您想获取`Id`observable 值的属性，而不是从 observable 本身。您应该将绑定的那部分更改为：

```
value: ApplianceType().Id 
```

或者也许更好的选择是使`ApplianceType`不可观察。您通常应该创建要观察可观察对象的特定值，而不是其他视图模型。

```
function ApplianceViewModel(applianceTypeViewModel) {
    var self = this;

    // ...
    self.ApplianceType = applianceTypeViewModel; // just assign the view model
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T09:13:06.670

只需在数据绑定中删除“Id”部分，您`Appliances[i].ApplianceType`将正确填写所选的设备类型。

`value: $data.ApplianceType.Id`应该`value: $data.ApplianceType`

`value`检查此 jsfiddle 以获取有关绑定如何工作的示例[http://jsfiddle.net/angelyordanov/gRxMq/](http://jsfiddle.net/angelyordanov/gRxMq/)。

并且您的代码已修改为可以在这里工作[http://jsfiddle.net/angelyordanov/vvGgD/](http://jsfiddle.net/angelyordanov/vvGgD/)。

淘汰赛的设计方式`options`可以是任意 javascript 对象的数组，而不仅仅是字符串，并且所选项目（the `value`）将是这些对象之一。这就是为什么你有`optionsText`绑定，以指定选项的显示文本是什么。

# php - issue in lightbox effect in php

> ID：13690592
> 
> 赞同：0
> 
> 时间：2012-12-03T19:51:57.543
> 
> 标签：php, lightbox

I am using lightbox to show an image in php.

My current code:

```
<a class="sri" href="administrator/all_photo/mywork/
<?php 
    echo $res['path'];
?>
_1.jpg" rel="lightbox">
<img src="administrator/all_photo/mywork/
<?php 
    echo $res['path'];
?>
_1.jpg" class="photo_frame photo_size" >
<br />
<?php 
    echo $res['title'];
?>
</a> 
```

CSS and JS for lightbox have already been included. In the above code, `$res['title']` and `$res['path']` are being fetched from database.

If I click on the image or the text which is showing as `$res['title']`, lightbox effect is showing. The image is within the lightbox. Now I need the `$res['title']` value also be displayed when the lightbox is opened along with the image.

How do I do that?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:26:09.003

您必须添加标题：

```
<a class="sri" href="administrator/all_photo/mywork/
<?php 
    echo $res['path'];
?>
_1.jpg" rel="lightbox">
<img src="administrator/all_photo/mywork/
<?php 
    echo $res['path'];
?>
_1.jpg" title="
<?php 
    echo $res['title'];
?>
" class="photo_frame photo_size" >
</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:11:52.563

只需使用标签中的`title`参数，如[灯箱文档](http://lokeshdhakar.com/projects/lightbox2/)中所述：`<a>`

> 可选：如果要显示标题，请使用 title 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:09:52.397

您应该能够将所有标记移动到 div 中。将 rel="lightbox" 添加到该 div，它应该可以工作。虽然这取决于您使用的灯箱库。

# python - Is it good practice to develop python applications as packages

> ID：13690598
> 
> 赞同：0
> 
> 时间：2012-12-03T19:52:19.283
> 
> 标签：python, user-interface, wxpython

I'm developing a rather complex desktop application using wxPython framework. At this point, app already contains a dozens of modules: libraries, UI modules, util modules.

Project looks like this:

```
MyApp/
    __init__.py -- empty
    main.py
    util/
        __init__.py -- empty
    lib1/
        __init__.py
    lib2/
        __init__.py
    gui/
        __init__.py -- empty
        window1.py 
```

Unfortunately with current project structure I cannot use absolute imports, because `python MyApp/main.py` will fail with error like `ImportError: No module named MyApp.gui`

To overcome this, I'd like to make MyApp an executable package:

```
my_app/
    __init__.py -- empty
    __main__.py
    util/
        __init__.py -- empty
    lib1/
        __init__.py
    lib2/
        __init__.py
    gui/
        __init__.py -- empty
        window1.py 
```

Now application can be started using `python -m my_app`

Everything seems ok so far… but I am full of doubts, because no-one uses such approach. If you take a look at demo that comes with wxPython you'll see that it's mostly flat project.

I'm definitely not the smartest one therefore I'm missing something simple and obvious why no-one uses such approach.

Maybe I should just stick with subfolders or flat project structure? Maybe absolute imports don't worth such changes?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:03:01.577

如果我是你，我会查看一些现有的 wxPython 应用程序，看看它们是如何做到的。

*   [Editra](http://editra.org/) - 文本文件编辑器 + 更多
*   [钱德勒项目](http://chandlerproject.org/)
*   [法奇](http://www.phatch.org/)

甚至是 wxPython 演示包。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T21:46:02.083

将大部分内容放在包命名空间中是最好的方法，因为您还可以利用字节码缓存，并且 setuptools/Distribute 可以轻松安装它。然后，您只需提供一个简单的顶级脚本来加载主模块并运行它。

就像是：

```
#!/usr/bin/python

import sys
from MyApp import main

main.main(sys.argv) 
```

只需将其命名`myapp`并安装在 /usr/local/bin （或 PATH 上的某个位置）。它所做的只是导入主模块并运行主函数（或类）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T21:50:36.603

您似乎明白为什么将它放在一个包中是一件好事。所以我想我会简单地回顾一下：

1.  你可以更好地组织你的项目。如果您有多个模块负责不同的事情，那么您不必担心与其他库发生冲突。所以它将基本上充当一个简单的命名空间。
2.  您可以通过 easy_install 或其他方式获得更新的好处。我不确定这是否真的是一个很大的优势。
3.  使用插件可以更容易地扩展，无论是自愿允许它们，还是只是在用户端进行一些调整。

我只会给你一些使用这种方法的例子，我认为主要是插件方法：

*   [Exaile](http://bazaar.launchpad.net/~exaile-devel/exaile/trunk/files/head:/)：音乐播放器，允许您通过此结构添加插件，同时注意 gui 位于单独的包中。不知道为什么，但它确实使 UI（GTK，但没关系）的分离清晰。
*   我只是在这里为自己做广告 :) [wxpos](http://code.google.com/p/wxpos/)：这是我的项目之一，如果你想看看我以 wxPython 为例的方法。

比我能想到的还要多，我敢肯定我在其他地方也看到过。

# c++ - 为什么将参考计数器值读取为对易失性常数的参考？

> ID：13690600
> 
> 赞同：4
> 
> 时间：2012-12-03T19:52:39.300
> 
> 标签：c++, boost

在 Boost 1.5.1 源代码下`smart_ptr\detail\atomic_count_win32.hpp`是一个整洁的小原子引用计数器`boost::detail::atomic_count`。

在第 48 行，他们做了一个我很好奇的演员表：

```
class atomic_count
{
public:

// ...

operator long() const
{
    return static_cast<long const volatile &>( value_ );
}

private:
long value_; 
```

为什么将计数器值转换为 a-reference-to-a-volatile-constant-long ( `long const volatile&`)？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T20:18:14.913

MSVC 提供了一个现已弃用[的](http://msdn.microsoft.com/en-US/library/12a04hfd%28v=vs.110%29.aspx)[variables](http://msdn.microsoft.com/en-US/library/12a04hfd%28v=vs.110%29.aspx)[*扩展*`volatile`](http://msdn.microsoft.com/en-US/library/12a04hfd%28v=vs.110%29.aspx)，赋予它们获取和释放语义（内存排序保证，关于多线程编程。）

此强制转换“启用”变量上的此扩展，赋予它读取-获取语义（以匹配任何也可能发生的发布-写入）。同样，这是*非标准的*。在 C++11 代码中，您应该使用`std::atomic<>`.

他们需要这个，因为`boost::shared_ptr`它保证了`shared_ptr<T>`多线程（共享）使用的正确性；这是他们实现的无[锁](http://preshing.com/20120612/an-introduction-to-lock-free-programming)计数器。

（此外，这只是故事的一半：虽然此扩展可能提供所需的顺序和可见性保证，但它不保证原子性。在 Win32 上，这由它运行的平台隐式保证：对齐的字大小整数读取和写入是每个平台都是原子的。）

在它开始之前将它扼杀在萌芽状态：没有这个扩展`volatile`对多线程编程没有用处。甚至不要尝试。此扩展已被弃用，因此您应该尽可能避免使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:17:20.447

在 x86 平台上，对于原生宽度的对齐值，这已经足够了。

他们试图避免的问题是：

1.  该变量具有十六进制值`0000FFFF`。

2.  线程 A 开始读取值并获取`0000xxxx`零件。

3.  线程 B 将值从`0000FFFF`增加到`00010000`。

4.  线程 A 完成读取值，得到`xxxx0000`它尚未读取的部分。

5.  线程 A 现在读取的值为`00000000`!

这称为字撕裂。但是，众所周知，这不会发生在 x86 上对齐的原生宽度类型中。因此，只需进行一次强制`volatile`转换（众所周知，这可以避免有问题的编译器优化）。

请注意，这不是一些普遍的事实。这恰好是平台的属性。这不是可移植的代码。

# xml - 使用 PowerShell 从 xml 的元标记中提取文本

> ID：13690602
> 
> 赞同：3
> 
> 时间：2012-12-03T19:52:42.110
> 
> 标签：xml, powershell, epub

使用以下 xml 文件，我如何提取一些元标记的文本？例如，我想从带有属性“role”属性的元标记中获取文本“aut”。

```
<?xml version="1.0" encoding="UTF-8"?>
<package xmlns="http://www.idpf.org/2007/opf" version="3.0" xml:lang="en" unique-identifier="pub-  id" prefix="cc: http://creativecommons.org/ns#">
    <metadata xmlns:dc="http://purl.org/dc/elements/1.1/">
        <dc:title id="title">Moby-Dick</dc:title>
        <meta refines="#title" property="title-type">main</meta>
        <dc:creator id="creator">Herman Melville</dc:creator>
        <meta refines="#creator" property="file-as">MELVILLE, HERMAN</meta>
        <meta refines="#creator" property="role" scheme="marc:relators">aut</meta>
        <dc:identifier id="pub-id">code.google.com.epub-samples.moby-dick-basic</dc:identifier>
        <dc:language>en-US</dc:language>
        <meta property="dcterms:modified">2012-01-18T12:47:00Z</meta>
        <dc:publisher>Harper &amp; Brothers, Publishers</dc:publisher>
        <dc:contributor id="contrib1">Dave Cramer</dc:contributor>
        <meta refines="#contrib1" property="role" scheme="marc:relators">mrk</meta>
        <dc:rights>This work is shared with the public using the Attribution-ShareAlike 3.0 Unported (CC BY-SA 3.0) license.</dc:rights>        
        <link rel="cc:license" href="http://creativecommons.org/licenses/by-sa/3.0/"/>
        <meta property="cc:attributionURL">http://code.google.com/p/epub-samples/</meta>
    </metadata>
</package> 
```

我尝试过使用这样的选择单节点（）方法但没有成功：

```
[xml]$doc = get-content myxmlfile.xml
$node = $doc.selectsinglenode("/package/metadata/meta[@property='role']")

//and

$node = $doc.selectsinglenode("//meta[@property='role']")

// $node is null for both cases 
```

我也尝试过这样使用 Select-XML：

```
[xml]$doc = get-content myxmlfile.xml
Select-Xml -xml $doc -Xpath "/package/metadata/meta[@property='role']"

//and

Select-Xml -xml $doc -Xpath "//meta[@property='role']" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T20:38:19.093

该标签定义了一个默认命名空间。您要么需要定义该默认命名空间，要么使用通配符来避免指定命名空间。后者更容易：

```
select-xml -xml $xml -xpath "//*[@property='role']/text()" | % { $_.Node.Value } 
```

这里有几个参考：http: [//blog.stevex.net/xpath-and-xml-namespaces/](http://blog.stevex.net/xpath-and-xml-namespaces/) [http://huddledmasses.org/xpath-and-namespaces-in-powershell/](http://huddledmasses.org/xpath-and-namespaces-in-powershell/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T20:24:28.353

这是一种查找角色节点的方法：

```
$xmlFile = [xml](Get-Content C:\temp\meta.xml)
$xmlFile.package.metadata.meta |Where-Object {$_.property -eq "role"}
$xmlFile.package.metadata.meta |Where-Object {$_.property -eq "role"} | foreach {$_.innertext} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T20:23:55.867

这里有几种方法之一：

```
[xml]$foo = Get-Content PATH\TO\FILE.xml
$foo.package.metadata.meta | ?{$_.property -eq 'role'} | Select '#text'

#text
-----
aut
mrk 
```

这将获得两个角色节点。只用 aut 获得一个：

```
$foo.package.metadata.meta | ?{($_.property -eq 'role') -and ($_.refines -eq '#creator')} | Select '#text' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T20:32:50.473

这将为您提供每个“元”节点中包含的文本：

```
PS> $xml = [xml](gc .\pkg.xml)
PS> $xml.package.metadata.meta | % {write-output $_."#text"} 
```

输出：

```
main
MELVILLE, HERMAN
aut
2012-01-18T12:47:00Z
mrk
http://code.google.com/p/epub-samples/ 
```

# node.js - 如何在 node.js 中解压文件

> ID：13690613
> 
> 赞同：7
> 
> 时间：2012-12-03T19:53:19.580
> 
> 标签：node.js, tar

有一些 untar 库，但我无法让它们工作。

我的想法是这样的

```
untar(bufferStreamOrFilePath).extractToDirectory("/path", function(err){}) 
```

有这样的东西吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2014-10-07T17:49:02.000

只是对此答案的更新，而不是`node-tar`，考虑使用[`tar-fs`](https://github.com/mafintosh/tar-fs)它会产生显着的性能提升以及更整洁的界面。

```
var tarFile = 'my-other-tarball.tar';
var target = './my-other-directory';

// extracting a directory
fs.createReadStream(tarFile).pipe(tar.extract(target)); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-09-01T00:56:41.990

[tar-stream](https://github.com/mafintosh/tar-stream)模块是一个非常好的模块：

```
var tar = require('tar-stream')    

var extract = tar.extract();
extract.on('entry', function(header, stream, callback) {
    // make directories or files depending on the header here...
    // call callback() when you're done with this entry
});

fs.createReadStream("something.tar").pipe(extract)

extract.on('finish', function() {
    console.log('done!')
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-01-02T15:13:45.427

一个在内存中完全提取 base64 编码的 tar 的函数，假设 tar 中的所有文件都是 utf-8 编码的文本文件。

```
const tar=require('tar');
let Duplex = require('stream').Duplex;

function bufferToStream(buffer) {
    let stream = new Duplex();
    stream.push(buffer);
    stream.push(null);
    return stream;
}

module.exports=function(base64EncodedTar){
    return new Promise(function(resolve, reject){
        const buffer = new Buffer.from(base64EncodedTar, "base64");

        let files={};

        try{

            bufferToStream(buffer).pipe(new tar.Parse())
                .on('entry', entry => {
                    let file={
                        path:entry.path,
                        content:""
                    };
                    files[entry.path]=file;
                    entry.on('data', function (tarFileData) {
                        file.content += tarFileData.toString('utf-8');
                    });

                    // resolve(entry);
                }).on('close', function(){
                  resolve(files);
                });
        } catch(e){
            reject(e);
        }

    })

};
```

# templates - Joomla 模板无法识别

> ID：13690615
> 
> 赞同：2
> 
> 时间：2012-12-03T19:53:25.977
> 
> 标签：templates, joomla, joomla2.5

我正在制作一个 Joomla 2.5.8 模板，但 joomla 无法识别它。

我有这个文件结构（注意，它是一个子域）

```
kadobos (root of subdomain)
    |>templates
          |>kadobosTemplate
                |>index.php
                |>templateDetails.xml 
```

index.php 现在只包含以下代码：

```
<!DOCTYPE html>
<html>
    <head>
        <title>KadoBos, voor al uw speelgoed</title>
    </head>
    <body>
        Welkom op deze website
    </body>
</html> 
```

并且 templateDetails.xml 包含以下代码：

```
<?xml version="1.0" encoding="utf-8">
<install version="1.5" type="template">
    <name>kadoBosTemplate</name>
    <author>Marc Meesters</author>
    <version>1.0</version>
    <description>
        Template op maat gemaakt voor KadoBos, door Marc Meesters
    </description>
    <files>
        <filename>index.php</filename>
        <filename>templateDetails.xml</filename>
    </files>
</install> 
```

但我在模板管理器中看不到模板。所以我不能为网站选择它作为默认模板。我怎样才能让 joomla 识别它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:01:34.493

看到您使用的是 Joomla 2.5，您的 XML 文件应如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<extension version="2.5" type="template" client="site">
    <name>kadoBosTemplate</name>
    <author>Marc Meesters</author>
    <version>1.0</version>
    <description>
        Template op maat gemaakt voor KadoBos, door Marc Meesters
    </description>
    <files>
        <filename>index.php</filename>
        <filename>templateDetails.xml</filename>
    </files>
</extension> 
```

注意`<install>`应该是`<extension>`和`1.5`应该是`2.5`。我还添加 `client="site"`了专门告诉 Joomla 模板是用于前端的。

请务必在进行这些更改后重新安装模板。

# c# - 将日期范围拆分为日期范围块

> ID：13690617
> 
> 赞同：25
> 
> 时间：2012-12-03T19:53:29.957
> 
> 标签：c#, .net

我正在寻找一种按天的块大小将日期范围拆分为一系列日期范围的方法。我打算用它来缓冲对服务的调用，如果日期范围太大，服务就会出错。

到目前为止，这是我想出的。它似乎有效，但我不确定它是否会正确退出。这似乎以前可能已经做过好几次了，但我找不到。

```
public IEnumerable<Tuple<DateTime, DateTime>> SplitDateRange(DateTime start, DateTime end, int dayChunkSize)
{
    var newStart = start;
    var newEnd = start.AddDays(dayChunkSize);

    while (true)
    {
        yield return new Tuple<DateTime, DateTime>(newStart, newEnd);

        if (newEnd == end)
            yield break;

        newStart = newStart.AddDays(dayChunkSize);
        newEnd = (newEnd.AddDays(dayChunkSize) > end ? end : newEnd.AddDays(dayChunkSize));
    }
} 
```

我正在寻找改进建议，或者“老兄，为此使用这个现有功能！”

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-12-03T20:53:56.683

我认为当开始和结束之间的差异小于 dayChunkSize 时，您的代码会失败。看到这个：

```
var singleRange = SplitDateRange(DateTime.Now, DateTime.Now.AddDays(7), dayChunkSize: 15).ToList();
Debug.Assert(singleRange.Count == 1); 
```

建议的解决方案：

```
public static IEnumerable<Tuple<DateTime, DateTime>> SplitDateRange(DateTime start, DateTime end, int dayChunkSize)
{
    DateTime chunkEnd;
    while ((chunkEnd = start.AddDays(dayChunkSize)) < end)
    {
        yield return Tuple.Create(start, chunkEnd);
        start = chunkEnd;
    }
    yield return Tuple.Create(start, end);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T20:53:30.617

你的代码对我来说看起来不错。我不太喜欢`while(true)`
但其他解决方案是使用 enumerable.Range 的想法：

```
public static IEnumerable<Tuple<DateTime, DateTime>> SplitDateRange(DateTime start, DateTime end, int dayChunkSize)
{
    return Enumerable
          .Range(0, (Convert.ToInt32((end - start).TotalDays) / dayChunkSize +1))
          .Select(x => Tuple.Create(start.AddDays(dayChunkSize * (x)), start.AddDays(dayChunkSize * (x + 1)) > end
                                                                       ? end : start.AddDays(dayChunkSize * (x + 1))));
} 
```

或者，这也将起作用：

```
public static IEnumerable<Tuple<DateTime, DateTime>> SplitDateRange(DateTime start, DateTime end, int dayChunkSize)
{
    var dateCount = (end - start).TotalDays / 5;
    for (int i = 0; i < dateCount; i++)
    {
        yield return Tuple.Create(start.AddDays(dayChunkSize * i)
                                , start.AddDays(dayChunkSize * (i + 1)) > end 
                                 ? end : start.AddDays(dayChunkSize * (i + 1)));
    }
} 
```

我没有任何实现的对象。它们实际上是相同的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T20:53:44.613

您的解决方案存在几个问题：

*   ~~测试`newEnd == end`可能永远不会是真的，所以`while`可能永远循环~~（我现在看到这个条件*应该*总是被触发，但在第一次阅读代码时并不明显；`while(true)`感觉还是有点危险）
*   `AddDays`每次迭代调用 3 次（性能小问题）

这是一个替代方案：

```
public IEnumerable<Tuple<DateTime, DateTime>> SplitDateRange(DateTime start, DateTime end, int dayChunkSize)
{
    DateTime startOfThisPeriod = start;
    while (startOfThisPeriod < end)
    {
        DateTime endOfThisPeriod = startOfThisPeriod.AddDays(dayChunkSize);
        endOfThisPeriod = endOfThisPeriod < end ? endOfThisPeriod : end;
        yield return Tuple.Create(startOfThisPeriod, endOfThisPeriod);
        startOfThisPeriod = endOfThisPeriod;
    }
} 
```

请注意，这会截断要结束的最后一个句点，`end`如问题中的代码所示。如果不需要，`while`可以省略第二行，简化方法。此外，`startOfThisPeriod`这不是绝对必要的，但我觉得这比重用`start`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-06-22T09:34:49.190

关于接受的答案，您可以使用元组的简短形式：

```
private static IEnumerable<(DateTime, DateTime)> GetDateRange1(DateTime startDate, DateTime endDate, int daysChunkSize)
{
    DateTime markerDate;

    while ((markerDate = startDate.AddDays(daysChunkSize)) < endDate)
    {
        yield return (startDate, markerDate);
        startDate = markerDate;
    }

    yield return (startDate, endDate);
} 
```

但我更喜欢使用命名元组：

```
private static IEnumerable<(DateTime StartDate, DateTime EndDate)> GetDateRange(DateTime startDate, DateTime endDate, int daysChunkSize)
{
    DateTime markerDate;

    while ((markerDate = startDate.AddDays(daysChunkSize)) < endDate)
    {
        yield return (StartDate: startDate, EndDate: markerDate);
        startDate = markerDate;
    }

    yield return (StartDate: startDate, EndDate: endDate);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-18T14:20:49.720

到目前为止，答案中有很多未处理的极端案例。而且还不完全清楚你想如何处理它们。你想要重叠范围的开始/结束吗？有最小范围大小吗？下面是一些将处理一些极端情况的代码，您必须特别考虑重叠，并可能将范围的开始/结束推几秒钟或更长时间，具体取决于您返回的数据。

```
 public static IEnumerable<(DateTime start, DateTime end)> PartitionDateRange(DateTime start,
                                                                                DateTime end,
                                                                                int chunkSizeInDays)
    {
        if (start > end)
            yield break;

        if (end - start < TimeSpan.FromDays(chunkSizeInDays))
        {
            yield return (start, end);
            yield break;
        }

        DateTime e = start.AddDays(chunkSizeInDays);

        for (;e < end; e = e.AddDays(chunkSizeInDays))
        {
            yield return (e.AddDays(-chunkSizeInDays), e);
        }

        if (e < end && end - e > TimeSpan.FromMinutes(1))
            yield return (e, end);
    } 
```

示例调用：

```
 static void Main(string[] _)
    {
        Console.WriteLine("expected");

        DateTime start = DateTime.Now - TimeSpan.FromDays(10);
        DateTime end = DateTime.Now;

        foreach (var range in PartitionDateRange(start, end, 2))
        {
            Console.WriteLine($"{range.start} to {range.end}");
        }

        Console.WriteLine("start > end");

        start = end + TimeSpan.FromDays(1);

        foreach (var range in PartitionDateRange(start, end, 2))
        {
            Console.WriteLine($"{range.start} to {range.end}");
        }

        Console.WriteLine("less than partition size");

        start = end - TimeSpan.FromDays(1);

        foreach (var range in PartitionDateRange(start, end, 2))
        {
            Console.WriteLine($"{range.start} to {range.end}");
        }
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-14T13:19:32.177

如果您知道要将时间范围分成多少块/间隔/周期/部分，我发现以下内容很有帮助

您可以使用[DateTime.Ticks](https://msdn.microsoft.com/en-us/library/system.datetime.ticks(v=vs.110).aspx)属性来定义您的时间间隔，然后根据您定义的时间间隔创建一系列 DateTime 对象：

```
IEnumerable<DateTime> DivideTimeRangeIntoIntervals(DateTime startTS, DateTime endTS, int numberOfIntervals)
{
    long startTSInTicks = startTS.Ticks;
    long endTsInTicks = endTS.Ticks;
    long tickSpan = endTS.Ticks - startTS.Ticks;
    long tickInterval = tickSpan / numberOfIntervals;

    List<DateTime> listOfDates = new List<DateTime>();
    for (long i = startTSInTicks; i <= endTsInTicks; i += tickInterval)
    {
        listOfDates.Add(new DateTime(i));
    }
    return listOfDates;
} 
```

您可以将其转换`listOfDates`为您想要表示的时间范围（元组、专用日期范围对象等）。你也可以修改这个函数，直接以你需要的形式返回。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-24T08:50:46.883

在大多数情况下，公认的解决方案看起来不错。如果您需要消除每个块的开头和结尾的重叠，那么这可能会更好。

```
public static IEnumerable<(DateTime FromDate, DateTime ToDate)> SplitDateRange(DateTime start, DateTime end, int dayChunkSize)
        {
            DateTime chunkEnd;
            while ((chunkEnd = start.AddDays(dayChunkSize-1)) < end)
            {
                yield return (start, chunkEnd);
                start = chunkEnd.AddDays(1);
            }
            yield return (start, end);
        } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-22T17:13:12.197

野兔是一个按月拼接的例子

```
IEnumerable<(DateTime, DateTime)> SplitDateRange(DateTime start, DateTime end, int monthChunkSize)
{
    DateTime dateEnd=DateTime.Parse(end.ToString());

    for (int i = 0;start.AddMonths(i) < dateEnd; i+=monthChunkSize)
    {
            end = start.AddMonths(i+monthChunkSize);
             start.AddMonths(i);

        yield return (start.AddMonths(i), end<dateEnd?end:dateEnd);     
    }
} 
```

# c++ - C++11所有控制路径还需要返回值吗？

> ID：13690618
> 
> 赞同：4
> 
> 时间：2012-12-03T19:53:31.053
> 
> 标签：c++, visual-c++, c++11

这似乎是一个荒谬的问题，但今天我用 C++ 编写了一个成员函数，它应该返回和 int，但并非总是如此。我什至写了一个不返回值的非常简单的函数......

```
int derp()
{
    if (11 == 22) return 0;
} 
```

这是最近的变化吗？我的编译器坏了吗？哈哈

编辑：这确实编译顺便说一句

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T20:02:51.437

在非 void 函数中，所有控制路径都必须返回。这里的关键问题是编译器不需要诊断它。注意*编译*和*正确*不一定相同。所有*正确的*代码都会编译，但并非所有编译的代码都是*正确*的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-03T19:54:52.183

不，C++ 从不要求所有控制路径都返回一个值。它在 C++11 和 C++03 中也有效（在语法上）。

一些编译器*可以*检测到您缺少返回的大多数情况，但不需要进行诊断。如果至少有一个返回的控制路径，大多数都不会发出诊断。

无论如何，它是UB。

# android - 未找到 Android odata4j Consumer EntitySet

> ID：13690619
> 
> 赞同：0
> 
> 时间：2012-12-03T19:53:35.980
> 
> 标签：android, odata, edmx, odata4j

我正在尝试将一些数据从 Android 放到 OData 服务器：

```
<edmx:Edmx Version="1.0">
  <edmx:DataServices m:DataServiceVersion="1.0" m:MaxDataServiceVersion="3.0">
    <Schema Namespace="DBModel">
      <EntityType Name="insertData">
        <Key>
          <PropertyRef Name="ID"/>
        </Key>
        <Property Name="ID" Type="Edm.Guid" Nullable="false"/>
        <Property Name="double_data" Type="Edm.Double"/>
      </EntityType>
    </Schema>
    <Schema Namespace="Data">
      <EntityContainer Name="DataEntities" m:IsDefaultEntityContainer="true" p6:LazyLoadingEnabled="true">
        <EntitySet Name="insertStuff" EntityType="DBModel.insertData"/>
      </EntityContainer>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx> 
```

我将数据发送到服务器的方法：

```
public class DataTransmitter {
  String serviceUrl = "http://url.tld/Data.svc";
  String entitySet = "insertStuff";

  ODataJerseyConsumer c = ODataJerseyConsumer.newBuilder(serviceUrl).build();

  void sendData(double data, UUID uuid) throws Exception {
    OEntity newLocation = c.createEntity(entitySet)
        .properties(OProperties.guid("ID", uuid.toString()))
        .properties(OProperties.double_("double_data", data))
        .execute();
} 
```

每当我启动应用程序时，我都会收到以下错误`adb logcat`：

```
org.odata4j.exceptions.NotFoundException: EdmEntitySet insertStuff is not found 
```

我想我必须以`DBModel`某种方式包含命名空间。但我不知道如何，似乎无法在文档中找到它。

**编辑：**我添加了这条线`ODataConsumer.dump.all(true);`以查看客户端从服务器接收到的内容。我可以`$metadata`在输出中看到如上所示的整体。

```
I/System.out( 2984): GET http://url.tld/Data.svc/$metadata
I/System.out( 2984): Accept: application/xml
I/System.out( 2984): User-Agent: odata4j.org
I/System.out( 2984): Status: 200
I/System.out( 2984): Cache-Control: no-cache
I/System.out( 2984): Content-Length: 1455
I/System.out( 2984): Content-Type: application/xml;charset=utf-8
I/System.out( 2984): DataServiceVersion: 1.0;
I/System.out( 2984): Date: Tue, 04 Dec 2012 17:39:34 GMT
I/System.out( 2984): Server: Microsoft-IIS/7.5
I/System.out( 2984): X-Android-Received-Millis: 1354642777769
I/System.out( 2984): X-Android-Sent-Millis: 1354642777536
I/System.out( 2984): X-AspNet-Version: 4.0.30319
I/System.out( 2984): X-Content-Type-Options: nosniff
I/System.out( 2984): X-Powered-By: ASP.NET
I/System.out( 2984): <edmx:Edmx Version="1.0" xmlns:edmx="http://schemas.microsoft.com/ado/2007/06/edmx">
I/System.out( 2984):   <edmx:DataServices m:DataServiceVersion="1.0" m:MaxDataServiceVersion="3.0" xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata">
I/System.out( 2984):     <Schema Namespace="DBModel" xmlns="http://schemas.microsoft.com/ado/2009/11/edm">
I/System.out( 2984):       <EntityType Name="insertData">
I/System.out( 2984):         <Key>
I/System.out( 2984):           <PropertyRef Name="ID" />
I/System.out( 2984):         </Key>
I/System.out( 2984):         <Property Name="ID" Type="Edm.Guid" Nullable="false" />
I/System.out( 2984):         <Property Name="double_data" Type="Edm.Double" />
I/System.out( 2984):       </EntityType>
I/System.out( 2984):     </Schema>
I/System.out( 2984):     <Schema Namespace="Data" xmlns="http://schemas.microsoft.com/ado/2009/11/edm">
I/System.out( 2984):       <EntityContainer Name="DataEntities" m:IsDefaultEntityContainer="true" p6:LazyLoadingEnabled="true" xmlns:p6="http://schemas.microsoft.com/ado/2009/02/edm/annotation">
I/System.out( 2984):         <EntitySet Name="insertStuff" EntityType="DBModel.insertData" />
I/System.out( 2984):       </EntityContainer>
I/System.out( 2984):     </Schema>
I/System.out( 2984):   </edmx:DataServices>
I/System.out( 2984): </edmx:Edmx> 
```

因此客户端能够连接到服务器*并*访问 EntitySet `insertStuff`。但它仍然显示错误

```
E/MainActivity(  987): null
E/MainActivity(  987): org.odata4j.exceptions.NotFoundException: EdmEntitySet insertStuff is not found
E/MainActivity(  987):  at org.odata4j.edm.EdmDataServices.getEdmEntitySet(EdmDataServices.java:55)
E/MainActivity(  987):  at org.odata4j.internal.EdmDataServicesDecorator.getEdmEntitySet(EdmDataServicesDecorator.java:36)
E/MainActivity(  987):  at org.odata4j.consumer.ConsumerCreateEntityRequest.execute(ConsumerCreateEntityRequest.java:42)
.
.
.
E/MainActivity(  987):  at android.os.Handler.dispatchMessage(Handler.java:99)
E/MainActivity(  987):  at android.os.Looper.loop(Looper.java:137)
E/MainActivity(  987):  at android.app.ActivityThread.main(ActivityThread.java:4966)
E/MainActivity(  987):  at java.lang.reflect.Method.invokeNative(Native Method)
E/MainActivity(  987):  at java.lang.reflect.Method.invoke(Method.java:511)
E/MainActivity(  987):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
E/MainActivity(  987):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:558)
E/MainActivity(  987):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T21:10:59.347

看来，这与此处的错误 postet 有关：[问题 226：odata4j 无法正确识别 WCF-$metadata](https://code.google.com/p/odata4j/issues/detail?id=226&colspec=ID%20Type%20Status%20Priority%20Stars%20Milestone%20Owner%20Summary)

因此，要解决这个问题，我所要做的就是根据当前的 odata4j 源创建 odata4j-0.8.0-SNAPSHOT-clientbundle.jar。因为 0.8.0-SNAPSHOT 中已包含修复（[问题 226 修复](https://code.google.com/p/odata4j/source/detail?r=09bfd54271ab)）

很抱歉在查阅错误报告之前在这里询问！

# node.js - Node.js 回调 | 具有瀑布流的异步 forEach 嵌套循环

> ID：13690622
> 
> 赞同：1
> 
> 时间：2012-12-03T19:53:55.090
> 
> 标签：node.js, asynchronous

我迷失在回调中。代码和所需的输出如下。所以发生的事情是内部循环没有执行，应该打印@b array=> ['a','b','c']

```
Async = require('async')

  @a = [1,2,3]
  @b = ['a','b','c']

  Async.forEachSeries @a, (aa , cbLoop1) =>
    console.log aa
    console.log "^ number from Loop-1"
    Async.forEachSeries @b, (bb , cbLoop2) =>
      #call the method below
      Async.waterfall(
          [
            (cb) ->
              #call method 'start'
              #'start' method has a callback that gets info using HTTP GET
              start bb , (error , response) ->
                  #console.log(response) or do something with response
              cbLoop2()
          ]    
      )
   cbLoop1()

   # Desired OUTPUT
   1
   ^ number from Loop-1
   a
   b
   c
   2
   ^ number from Loop-1
   a
   b
   c
   3
   ^ number from Loop-1
   a
   b
   c 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:59:33.320

`async.waterfall`接受第二个参数：“所有函数完成后运行的可选回调”。您的问题尚不清楚这是否会破坏您试图实现的流程，但是您是否可以将`cbLoop2()`其作为第二个参数`waterfall`调用而不是在第一个任务结束时调用它？一个简化的例子：

```
async = require('async')

a = [1,2,3]
b = ['a','b','c']

cb = ->

async.forEachSeries a, (item , cb) ->
  console.log item
  async.forEachSeries b, (item , cb) ->
    console.log item
    async.waterfall [], cb()
  cb() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T03:52:48.473

*大卫的回答帮助了我。我试图掌握 Async forSeries 和瀑布语法。*欢迎任何改进意见！

```
Async = require('async')

class Test
  constructor: () ->
    @a1       = [1,2,3]
    @b1       = ['a','b','c']

  test: (t , callback) ->
    Async.forEachSeries @a1, (aa , cbLoop1) =>
      console.log "Value from Array @a1 - > #{aa}"
      count = 0
      Async.forEachSeries @b1, (bb , cbLoop2) =>
    cb = cbLoop2
    # console.log bb
    Async.waterfall(
      [
        (cbLoop2) ->
          count = count + 1
          t.methd1 "Value from Array @b2 - #{bb}" , (er ,response) ->
            console.log response
            cbLoop2(null , count)
        , (resp , cbLoop2) ->
          #have to do some manupulations here
          cbLoop2(null , count)
      ] , (err ,response) ->
        cbLoop2()

    )

  , (err) ->
    console.log("===")
    cbLoop1()

  methd1: (data , callback) ->
    @finalmethod "$$ #{data} $$" , callback

  finalmethod: (data, callback) ->
    setTimeout () ->
      callback(undefined , data)
    , 1500

  t = new Test()
  t.test t, t.test_cb

output
Value from Array @a1 - > 1
$$ Value from Array @b2 - a $$
$$ Value from Array @b2 - b $$
$$ Value from Array @b2 - c $$
===
Value from Array @a1 - > 2
$$ Value from Array @b2 - a $$
$$ Value from Array @b2 - b $$
$$ Value from Array @b2 - c $$
===
Value from Array @a1 - > 3
$$ Value from Array @b2 - a $$
$$ Value from Array @b2 - b $$
$$ Value from Array @b2 - c $$
=== 
```

# tcl - 如何将带有日期和时间的配置文件保存在文件夹中

> ID：13690624
> 
> 赞同：0
> 
> 时间：2012-12-03T19:54:04.843
> 
> 标签：tcl, expect

我想自动备份我的路由器的启动配置，但它会覆盖以前的配置。如何将命名日期和时间保存到备份文件以避免覆盖。请帮忙！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:21:25.070

命令[时钟](http://www.tcl.tk/man/tcl/TclCmd/clock.htm)将帮助您处理与时间相关的事情。由于一切都是字符串，您只需将格式化的日期插入要打开的文件名即可。`w+`表示打开文件进行写入，如果它不存在则创建它。

```
#!/usr/bin/tclsh

set f [open "[clock format [clock seconds] -format "%Y%m%d-%H%M%S"].txt" w+]
puts $f "foo"
close $f 
```

# ruby - 在 Sinatra 中，我如何将控制权传递给命名路由？

> ID：13690631
> 
> 赞同：0
> 
> 时间：2012-12-03T19:54:26.823
> 
> 标签：ruby, sinatra

从那里我看到的文档`pass`将自动确定控件将传递到的路由。

如何将控制权传递给命名路由？

这对我不起作用：

```
get '/:title.:ext' do
  pass "/old/#{params[:title]}" if params[:ext] == 'php'
  # more logic
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:05:56.747

如果您确实希望更改用户浏览器中的 URL，您可以使用[`redirect`](http://www.sinatrarb.com/intro#Browser%20Redirect)，或者[`call!`](http://www.sinatrarb.com/intro#Triggering%20Another%20Route)如果您希望对最终用户隐藏转发，则可以直接使用（即浏览器中的 URL 保持不变，但在内部转发请求到您的应用程序中的不同路线）。

所以在你的情况下，它要么是

```
redirect "/old/#{params[:title]}" if params[:ext] == 'php' 
```

或者

```
call! env.merge('PATH_INFO' => "/old/#{params[:title]}") if params[:ext] == 'php' 
```

# json - 春季的杰克逊：如何解组一个“通用”类而不认为它是一个 LinkedHashMap？

> ID：13690640
> 
> 赞同：0
> 
> 时间：2012-12-03T19:55:06.280
> 
> 标签：json, spring, jackson

所以我的实体看起来像这样：

```
public class HappyClass<T>
{
    private String id;
    prviate int ver;
    private Object obj;

    public String getId()
    {
        return this.id;
    }

    public void setId( String id )
    {
        this.id = id;
    }

    public int getVer()
    {
        return this.ver;
    }

    public void setVer( int ver )
    {
        this.ver = ver;
    }

    @JsonTypeInfo( use = Id.NONE )
    public T getObj()
    {
        return obj;
    }

    public void setObj( T obj )
    {
        this.obj = obj;
    }
}

public class HappyGeneric
{
    private String someStuff();

    public String getSomeStuff()
    {
        return this.someStuff();
    }

    public void setSomeStuff( String someStuff )
    {
        this.someStuff = someStuff;
    }
} 
```

如果我实例化这样的类：

```
HappyClass<HappyGeneric> hc = new HappyClass<HappyGeneric>(); 
```

如果我将它发送到 Spring，`@ResponseBody`它会返回：

```
{
    "id" : "iamsomeid",
    "ver" : 123,
    "obj" : {
        "someStuff" : "iamsomestuff"
    }
} 
```

但是，当 Spring 和/或 Jackson 尝试解组相同的 JSON 时，它发现主类是 a `HappyClass`，但是，无论我用什么注释它，`getObj()`它都会解组为 a`LinkedHashMap`而*不是*a 。`HappyGeneric`

任何人有任何想法我可以如何强迫杰克逊将通用解组为原始类？

谢谢！

编辑：我知道我可以通过这种方式调用`mapper.convertValue( blah.getObj(), HappyGeneric.class )`并获取对象——我希望让 Spring 自动解决它（例如，通过注释）。

# ckeditor - 我想从浏览服务器按钮从 CKeditor 中选择文件

> ID：13690642
> 
> 赞同：0
> 
> 时间：2012-12-03T19:55:15.560
> 
> 标签：ckeditor

我有 browae 服务器按钮

我在 asp.net c# 中工作。

我想从我的图像文件夹中选择图像

这意味着当我单击浏览服务器按钮时，我的图像文件夹必须打开并且当我单击任何图像时。必须选择它，并且必须将所选图像路径复制到 url 文本框上。

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:30:19.573

如果我正确理解你的问题，基本上你需要两件事：

1.  确保文件浏览器插件在您的*CKEditor*包中可用 - 这个插件可以将外部文件管理器附加到 CKEditor
2.  ...并且您需要一些文件管理器。

CKSource 为 CKEditor 创建了一个官方的 ajax 文件管理器，它被称为[CKFinder](http://cksource.com/ckfinder)。如果您决定尝试一下，请务必查看[文档](http://docs.cksource.com/CKFinder_2.x/Developers_Guide/ASP.NET)

# c++ - 启动配置中指定的程序文件不存在

> ID：13690644
> 
> 赞同：20
> 
> 时间：2012-12-03T19:55:31.760
> 
> 标签：c++, c, eclipse

我面临一些关于 eclipse for c/c++ 的问题。我正在尝试创建一个新项目，我提供了代码，运行代码后出现此错误：

```
The program file specified in the launch configuration does not exist
C:\Users\elisabeth\workspace\mm\Debug\mm.exe not found 
```

请注意，我正在使用 spice 工具包；我为“包含”文件和库设置了路径，但仍然没有结果。

是什么导致此错误，我该如何解决？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-07-27T09:41:21.363

1.  右键单击您的项目->属性
2.  运行/调试设置
3.  删除任何设置为“'........'的启动配置
4.  项目 --> 清理
5.  项目 --> 构建项目

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-06T14:34:07.173

您可以创建运行配置。去`Run > Run Configurations`。单击`New`按钮，填写`C/C++ Application`字段，即插入可执行文件的路径。当您单击运行按钮旁边的箭头时，新配置将出现在出现的列表中。

当然，这假设您可以毫无问题地构建，否则您将看不到要指向的可执行文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-14T19:26:18.953

您可以清理项目，重新构建它并将其作为本地 C/C++ 应用程序运行。简化步骤如下，

1.  右键单击项目
2.  清洁项目
3.  再次右键单击项目
4.  构建项目
5.  再次右键单击项目
6.  运行方式->
7.  本地 C/C++ 应用程序

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-20T17:08:43.140

如错误所示：

```
C:\Users\elisabeth\workspace\mm\Debug\mm.exe not found 
```

1.  首先，您需要检查您的 Debug 文件夹中是否有可执行文件“mm.exe”。（当然，它不存在，这就是错误的原因）

2.  转到 Project > Clean，您应该会看到一些文件已从您的 Debug 文件夹中删除

3.  转到 Project > Build Project，您应该会看到正在生成的一些新文件，例如 mm.d、mm.o、mm。这个“mm”可能是您正在寻找的可执行文件

4.  现在您知道可执行文件是什么，您应该告诉 eclipse 执行哪个文件而不是 mm.exe。转到项目属性并在运行调试设置中创建一个新配置（或编辑现有配置，如果已经存在）。在此配置中，在主选项卡中，在 C/C++ 应用程序中指定“mm”的完整路径。在您的情况下，哪个是-`"C:\Users\elisabeth\workspace\mm\Debug\mm"` 在 Eclipse 中执行此操作的更好方法是：

    ${project_loc}/"你的文件夹"/"你的可执行文件"

例如`${project_loc}/Debug/mm`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-05T14:18:02.697

对我有用的是`file->refresh`

然后通过再次选择正确的 c/c++ 二进制文件再次进行调试配置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-15T18:10:14.250

通过进入项目属性 > C/C++ 构建 >**刷新策略**并指定您的项目文件夹来避免配置问题。配置选项“搜索项目”将显示一个正确的文件夹，然后您将看到您在那里构建的任何内容 - 调试、发布或两者兼而有之。您不想在每次导入项目或切换配置时使用“浏览”选项指定文件夹。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-11T23:36:04.810

几天前我遇到了类似的问题及其相关问题。最后，我发现，只是因为我将我的项目文件夹（Eclipse 的工作区文件夹）移动到了另一个地方，所以 Eclipse 无法像往常一样找到它需要的东西。
解决方案：我刚刚将工作区设置为我的新位置（嘿 Eclipse，我的工作区现在在这里）：菜单“文件”->“切换工作区”->“其他...”->单击“浏览...”按钮并指向新位置，然后单击“选择文件夹”按钮，然后单击“启动”按钮。

美好的一天。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-12-15T15:07:06.987

由于这是在 Google 上针对该主题出现的第一个 SO 讨论，并且没有一个答案解决了我的学生遇到的问题，所以我想提一下我们最终从[这个答案](https://stackoverflow.com/questions/9407430/launch-failed-binary-not-found-eclipse-for-c-in-windows)中找到的解决方案：

1.  打开项目属性（右键单击您的项目，在菜单上选择属性）
2.  C/C++ 构建 -> 设置
3.  单击 Binary Parsers 选项卡并检查 PE Windows Parser
4.  继续点击 Move Up 直到它在顶部

这已设置为 Elf，即使我们使用的是新下载的 Windows 版本的 Eclipse。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-07-11T22:16:02.533

有时错过闭合花括号可能是问题的一部分。确保在文件开头对您的函数进行原型设计。然后在左侧栏中右键单击您的项目。单击清理项目。然后单击构建项目，最后运行项目

# javascript - jQuery 动态对象选择器

> ID：13690647
> 
> 赞同：0
> 
> 时间：2012-12-03T19:55:44.127
> 
> 标签：javascript, jquery

看看下面的代码：

```
 this.forms = {
            signIn: {
                email: $('#tb-input-sign-in-email'),
                password: $('#tb-input-sign-in-password')
            },
            signUp: {
                fullName: $('#tb-input-sign-up-full-name'),
                email: $('#tb-input-sign-up-email'),
                password: $('#tb-input-sign-up-password')
            }
        }; 
```

这是初始化我的文本框 jQuery 插件的旧代码：

```
$('#tb-sign-in-email, #tb-sign-in-password').textbox(); 
```

新代码（使用 this.forms 数组）将是：

```
this.forms.signIn.email.textbox();
this.forms.signIn.password.textbox(); 
```

基本上我想用一行代码初始化文本框插件，就像“旧代码”初始化 jQuery 插件（使用单个选择器）一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:01:08.813

您当前的代码仅使用 jQuery 选择器获取 DOM 上的元素，旧代码也是如此。

不同之处在于新代码更改了选择器。
**从** `#tb-sign-in-email` **到** `#tb-input-sign-in-email`。
**从** `#tb-sign-in-password` **到** `#tb-input-sign-in-password`。

`$('#tb-input-sign-in-email, #tb-input-sign-in-password').textbox();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:01:28.237

您可以尝试使用该[`.add()`](http://api.jquery.com/add/)方法

```
var textbox = this.forms.signIn ;

 (textbox.email).add(textbox.password).textbox(); 
```

# ios - iOS 不会尊重支持的界面方向

> ID：13690648
> 
> 赞同：0
> 
> 时间：2012-12-03T19:55:52.090
> 
> 标签：ios

令人沮丧。我试图只制作一个应用程序肖像。

在 Targets => Summary => Supported Interface Options 中，仅选择了纵向。

我在我的应用程序的导航控制器上放置了以下内容：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

-(NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskPortrait;
}

-(BOOL)shouldAutorotate{
    return NO;
} 
```

甚至将其复制到导航控制器的根视图控制器上。仍然显示允许旋转视图。我仍然可以在 iPad 上将我的应用程序旋转到横向，甚至在 iPhone 上甚至可以上下颠倒。

谢谢！

# .net - 表达式：从范围引用的变量，但未定义异常

> ID：13690653
> 
> 赞同：5
> 
> 时间：2012-12-03T19:56:08.700
> 
> 标签：.net, linq, lambda, expression

我是 System.Linq.Expresions 的新手，我试图找出这段代码有什么问题：

```
 var mc = new MyClass();

        ParameterExpression value = Expression.Parameter(typeof(object), "value");
        ParameterExpression xParam = Expression.Parameter(typeof(MyClass), "x");

        Expression<Func<MyClass, object>> e = x => x.Val;

        BlockExpression block = Expression.Block(new[] { xParam, value },
            Expression.Assign(e.Body, value));

        Expression.Lambda<Action<MyClass, object>>(block, xParam, value).Compile()(mc, 5); //I'm getting exception here when Compile()

...

class MyClass
    {
        public object Val
        {
            get;
            set;
        }
        public object OtherVal
        {
            get;
            set;
        }
    } 
```

我只想构建类似 mc.Val = 5 的东西，假设 MyClass 和 object 参数是 lambda 的参数（我不想使用闭包）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T20:00:35.973

`e.Body`引用来自 的参数`e`。但这是一个不同的参数`xParam`。两人同名是不够的。它们必须是同一个对象。

在理解中，您尝试使用 lambdas 作为生成表达式的工具来获取表达式。要使该方法起作用，您需要将所有参数替换为`e`您控制的参数 ( `xParam`)。你必须保持一致。

# c++ - 如何使用 Boost 执行监视器来确保我的函数是否挂起，它会在 30 分钟后超时？

> ID：13690654
> 
> 赞同：1
> 
> 时间：2012-12-03T19:56:15.380
> 
> 标签：c++, boost

有人可以给我看一个使用 Boost 执行监视器的示例代码吗？这必须在 Redhat (6.0 ??) 上运行

```
int main(int argc, char *argv[])
{
   runTest();//I need a timeout of 30 mins here. That way if the gets hung, process will get killed

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T08:05:58.110

要实现这一点，您只需要：

1.  使用获取“unit_test_monitor”的句柄`auto& inst = boost::test::unit_test_monitor::instance()`
2.  使用设置预期的超时值`inst.p_timeout.set( num_seconds );`
3.  通过执行监视器的`execute()`方法调用您的函数。

执行监视器的`execute()`方法具有以下签名：

```
int execute( unit_test::callback0<int> const& F ); 
```

这意味着它期望函数的签名调用 return 和 int 并且不接受任何参数。如果您的函数与所需的签名不匹配，请使用 boost::bind 或手卷函数包装器。

完整示例：

```
#define BOOST_TEST_DYN_LINK
#define BOOST_TEST_MODULE MyTest
#include <boost/test/included/unit_test.hpp>
#include <boost/test/unit_test_monitor.hpp>
#include <boost/bind.hpp>

#include <unistd.h>

namespace bt=boost::unit_test;

bool DodgyFunc( unsigned wait )
{
    for( unsigned x=0; x<wait; ++x)
    {
        std::cout << "Sleeping....\n";
        usleep( 1000000 );
    }

    return true;
}

BOOST_AUTO_TEST_CASE(MyTestCase)
{
    // simple call
    std::cout << "Simple call to DodgyFunc, this will pass\n";
    BOOST_CHECK_EQUAL( true, DodgyFunc( 5 ) );

    // get the execution monitor instance
    bt::unit_test_monitor_t& theMonitor = bt::unit_test_monitor_t::instance();

    // Set the  timeout
    theMonitor.p_timeout.set( 3 );

    // Now call using the execution monitor
    std::cout << "\n\nCall to DodgyFunc, using the execution monitor " 
              << "this will timeout and result in an error\n";
    theMonitor.execute( boost::bind( DodgyFunc, 10 ) );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:00:45.473

您不一定需要 Boost 来执行此操作。实现超时的一种非常简单且常用的技术是[看门狗定时器](http://en.wikipedia.org/wiki/Watchdog_timer)。本质上，工作线程或进程定期与管理器线程“签入”。这可以简单地通过设置一个变量来完成（尽管它应该是使用新的 C++11 原子库之类的原子，或者用互斥锁保护）。如果工人没有在规定的时间内签到，你可以杀死工人，或者以你选择的任何方式处理错误。

# iphone - 从 parse.com 检索图像

> ID：13690655
> 
> 赞同：4
> 
> 时间：2012-12-03T19:56:23.947
> 
> 标签：iphone, ios, image, parsing

我不知道这是否可能，但我认为这是可能的，我不知道该怎么做。我只是想从 parse.com 加载图像，就像从 parse.com 检索对象一样。我应该像从 parse.com 获取字符串一样吗？我刚刚找到了如何在解析时保存图像，但没有找到如何获取它们。如果有人可以向我展示执行此操作的链接或示例代码，我会很高兴。

我已经设置了一个从解析中检索到的字符串：

```
PFQuery *query = [PFQuery queryWithClassName:@"app"];
[query getObjectInBackgroundWithId:@"ID"
                             block:^(PFObject *textdu, NSError *error) {
                                 if (!error) {

                                     UIFont *welcomeLabelFont = [UIFont boldSystemFontOfSize:17];

                                     welcomeLabel.text = [textdu objectForKey:@"ueberschriftnews"];
                                     welcomeLabel.font = welcomeLabelFont;
                                     welcomeLabel.textColor = [UIColor whiteColor];
                                     welcomeLabel.textAlignment = NSTextAlignmentCenter;
                                     welcomeLabel.backgroundColor = [UIColor clearColor];
                                     welcomeLabel.shadowColor = [UIColor blackColor];
                                     welcomeLabel.shadowOffset = CGSizeMake(0, 1);
                                     [contentView addSubview:welcomeLabel];

                                     // The get request succeeded. Log the score
                                     NSString *text = [textdu objectForKey:@"newstext"];
                                     UIFont *font = nil;
                                     CGFloat points = 17;
                                     CGFloat maxHeight = infoLabel.frame.size.height;
                                     CGFloat textHeight;
                                     do {
                                         font = [UIFont systemFontOfSize:points];
                                         CGSize size = CGSizeMake(infoLabelRect.size.width, 100000);
                                         CGSize textSize = [text sizeWithFont:font constrainedToSize:size lineBreakMode: NSLineBreakByWordWrapping];
                                         textHeight = textSize.height;
                                         points -= 1;
                                     } while (textHeight > maxHeight);
                                     infoLabel.text = text;
                                     infoLabel.numberOfLines = 9;
                                     infoLabel.font = font;
                                     infoLabel.textColor = [UIColor whiteColor];
                                     infoLabel.textAlignment = NSTextAlignmentCenter;
                                     infoLabel.backgroundColor = [UIColor clearColor];
                                     infoLabel.shadowColor = [UIColor blackColor];
                                     infoLabel.shadowOffset = CGSizeMake(0, 1);

                                     [infoLabel sizeToFit];
                                     [contentView addSubview:infoLabel];

                                 } else {

                                     infoLabel.text = @"something";
                                     [infoLabel sizeToFit];
                                     [contentView addSubview:infoLabel];
                                 }

                             }]; 
```

我的解析设置：

![在此处输入图像描述](../Images/b27ca56413a791c3b839c0f9942897dc.png)

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-03T20:01:29.000

是的，这是可能的。如果您使用 Web 界面而不是字符串，则应将 PFFile 指定为类型。如果您从 iOS 客户端上传图像，这里有一个解析 iOS 指南的链接[https://parse.com/docs/ios_guide#files/iOS](https://parse.com/docs/ios_guide#files/iOS)。一旦你的图像在那里，你可以通过这种方式下载图像：

```
PFQuery *query = [PFQuery queryWithClassName:@"app"];
[query getObjectInBackgroundWithId:@"ID"
                         block:^(PFObject *textdu, NSError *error) {
{
     // do your thing with text 
     if (!error) {
          PFFile *imageFile = [textdu objectForKey:@"image"];
          [imageFile getDataInBackgroundWithBlock:^(NSData *data, NSError *error) {
              if (!error) {
                  UIImage *image = [UIImage imageWithData:data];
              }
          }];
     }
 }]; 
```

# .net - 在 IIS 上部署 .NET MVC 4 应用程序时，物理路径应指向何处

> ID：13690656
> 
> 赞同：3
> 
> 时间：2012-12-03T19:56:30.233
> 
> 标签：.net, asp.net-mvc, vb.net, iis, iis-7

好的，这可能是一个愚蠢的问题，但是在使用 IIS 服务器部署 .NET MVC 4 应用程序时，应该在哪里指示物理路径？父目录？控制器目录？视图目录？我不断收到错误消息，说找不到他的资源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:01:59.547

应用程序的顶级`Web.config`文件所在的目录。这个，如果你有的话，就是你的`Global.asax`文件所在的同一个文件夹。

# perl - 从 Perl 调用 mat2gray 函数时不起作用

> ID：13690657
> 
> 赞同：0
> 
> 时间：2012-12-03T19:56:34.993
> 
> 标签：perl, octave

我在 perl 中有一个脚本，它根据一系列参数生成一个 .m 文件，然后通过如下刻度运行八度音阶算法：

```
`octave my_script`; 
```

然后我将结果捕获到一个单独的文件中。问题是即使成功安装了图像包 mat2gray 功能也无法正常工作。如果我像手动使用单独的控制台一样手动打开八度音阶，并调用我的脚本，它确实可以正常工作。该问题仅在从 Perl 调用 octave.exe 时出现。表明：

```
error: `mat2gray' undefined near line 21 column 6 
```

这看起来像是您在没有图像包时遇到的典型错误（我确实安装了它，并且可以直接在 octave 控制台上使用该功能）。我已经尝试在脚本的最顶部添加一行以在每次脚本运行时重建包，如下所示：

```
pkg rebuild -auto image; 
```

但这并没有解决问题。有人见过这种奇怪的行为吗？

我使用的是 Octave 3.2.4，因为与我们需要的其他软件存在一些兼容性问题，我需要该版本。从 perl 调用时，一些绘图功能不能很好地工作。以防万一你想知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T17:39:41.837

[为了将来参考，我在这里](http://octave.1599824.n4.nabble.com/mat2gray-not-working-when-called-from-Perl-only-console-td4647513.html)回答了这个问题。

# math - Netlogo 编程：如何编写“令人反感”的动作？

> ID：13690666
> 
> 赞同：1
> 
> 时间：2012-12-03T19:57:01.483
> 
> 标签：math, computer-science, netlogo

我正在考虑如何在 netlogo 中编写“令人反感”的动作。就是这样：我们正在尝试建立一个模型，其中牧羊犬放牧一群羊。当狗靠近羊时（即距离小于羊的“反应距离”时）羊会从狗身边跑开。我不知道如何做到这一点“当它们的距离小于响应距离时，羊会从狗身边跑开”。有人可以帮我吗？非常感谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T05:14:31.607

这是一个完整的解决方案。解释如下。

```
breed [sheep a-sheep]
breed [dogs dog]

globals [
  panic-distance
  the-dog
]

to setup
  clear-all
  set panic-distance 10
  set-default-shape sheep "sheep"
  create-sheep 50 [
    setxy random-xcor random-ycor
  ]
  create-dogs 1 [
    set the-dog self
  ]
  reset-ticks
end

to go
  ask the-dog [
    rt random 30
    lt random 30
    fd 1
  ]
  ask sheep [
    if distance the-dog < panic-distance [
      face the-dog
      right 180
      fd 1
    ]
  ]
  tick
end 
```

您的评论中有两个关键语句，它们非常直接地转换为 NetLogo 代码：

> 当狗靠近最近的绵羊并且距离低于恐慌距离时

就如何接近它而言，“最近的绵羊”可能有点红鲱鱼。您可能想要做的是询问每只羊当前与狗的距离是否小于恐慌距离。NetLogo 有这个[`distance`](http://ccl.northwestern.edu/netlogo/docs/dictionary.html#distance)原语！在代码中，它变成：

`ask sheep [if distance the-dog < panic-distance [...]]`

在这种情况下，您只需要将 替换为`...`您想要羊做的事情，这在您的下一个语句中进行了描述：

> 羊会和狗走相反的路

我想，您可能是指*远离*狗，因为“与狗相反的方式”实际上可能是*朝向*狗。

NetLogo**没有**`face-away-from`原语，但它有一个原[`face`](http://ccl.northwestern.edu/netlogo/docs/dictionary.html#face)语，它会让羊转向狗。您可以使用它，然后将其完全转回以便它可以逃跑：

```
face the-dog
right 180 
```

你去吧。这就是它的核心。你可以随心所欲地和其他人一起玩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:12:40.273

打开 NetLogo 并查看*模型库的**Shepherds*演示（在*文件*菜单中找到它）。

 **您也可以在[这里在线](http://ccl.northwestern.edu/netlogo/models/Shepherds)找到它。**

# class - 我可以添加到 ::oo::define 以添加全局 tclOO 类定义扩展，我该如何非全局执行此操作？

> ID：13690670
> 
> 赞同：0
> 
> 时间：2012-12-03T19:57:28.857
> 
> 标签：class, tcl

我发现一些 TclOO 资源提到您可以创建`::oo::class`. 您也可以使用 创建裸对象`::oo::object create`，但不能从裸类迁移到真实类（即 parent`oo::object`到 parent `oo::class`）

我正在寻找一个用于定义模块的 DSL，它只是创建类定义。

```
module create mysql 5.5 {
  executable mysqld
  method post_install { ... }
}

module create redis 2.6 {
  executable redis-server
  ...
} 
```

然后这些可以用作

```
set mod [mysql new]
$mod install
$mod post_install 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:07:03.697

虽然您无法直接在`oo::define`系统中创建特定于类的扩展命令，但您可以非常轻松地完成次优任务。诀窍是`namespace path`仅在定义处理期间将附加命令配置到命名空间。说元类构造函数很容易做这种事情，这有点过分了：

```
# First, build the definition of the extensions
namespace eval ::ModuleDefineExtensions {
    proc executable {program} {
        # I'm not quite sure how you want to handle this, but [uplevel] and
        # [info level] will reveal what you need.
        puts "define executable as $program here"
    }
}

# Now, the [module] metaclass
oo::class create module {
    superclass oo::class
    constructor {definitionScript} {
        # Save the old path
        set oldpath [namespace eval ::oo::define {namespace path}]

        # Set the new one
        namespace eval ::oo::define {namespace path ::ModuleDefineExtensions}

        # Now let the superclass constructor handle this, trapping errors
        catch {next $definitionScript} msg opt

        # Restore the old path
        namespace eval ::oo::define [list namespace path $oldpath]

        # Rethrow any errors
        return -options $opt $msg
    }
} 
```

您可能需要更多零碎的东西（例如，定义通用方法的合适的默认模块类超类），但这些都是常规的。

* * *

如果您使用的是 8.6，则`module`定义可以更简单（这次没有注释）：

```
oo::class create module {
    superclass oo::class
    constructor {definitionScript} {
        set oldpath [namespace eval ::oo::define {namespace path}]
        namespace eval ::oo::define {namespace path ::ModuleDefineExtensions}
        try {
            next $definitionScript
        } finally {
            namespace eval ::oo::define [list namespace path $oldpath]
        }
    }
} 
```

原理上是一样的，只是使用了8.6的try/finally命令。

# powerpoint - 从远程自动运行连续的PowerPoint演示文稿

> ID：13690671
> 
> 赞同：1
> 
> 时间：2012-12-03T19:57:35.347
> 
> 标签：powerpoint

我的公司举办研讨会。每个研讨会为期三天，每个研讨会每天都包含多个 PowerPoint 演示文稿。

我们的演示者拥有最少的技术专长。当他们演示时，他们使用一个非常基本的遥控器，可以转发和推进幻灯片或切换到黑屏。而已。

当他们完成第一个 PowerPoint 演示文稿时，他们不想走到笔记本电脑前，关闭演示文稿，然后打开下一个演示文稿。这需要无缝进行。多年来，它确实如此。旧版本的 PowerPoint 有一个名为“CD 包”的选项，它将所有演示文稿捆绑到一个文件夹中（以及任何嵌入的音频和视频文件 - 有很多）。该文件夹还将包含一个 PowerPoint Viewer 的 EXE，以及一个包含所有节目文件名的 .BAT 文件。所以我们只需要运行 BAT 文件，每个 PPT 文件就会依次播放。

但是 PPT 2010 不再将多个文件捆绑在一起。我试图想出一个调用PPT exe运行的BAT文件，然后列出每个文件，并带有命令行开关以幻灯片模式运行。它有效……有时。然后有时会出现“无法读取文件”错误。

简而言之——我们需要一种以幻灯片模式运行一系列 PPT 文件的方法，以便打开一个文件，然后在文件末尾打开下一个文件，而无需按任何按钮或触摸笔记本电脑。

这是我创建的间歇性工作的 BAT 文件的文本：

"C:\Program Files (x86)\Microsoft Office\Office14\POWERPNT.EXE" /S 00Intro.pptx 01Legal.pptx 02pers.pptx

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T07:42:27.637

> 当他们完成第一个 PowerPoint 演示文稿时，他们不想走到笔记本电脑前，关闭演示文稿，然后打开下一个演示文稿。这需要无缝进行。

SlideDog ( [http://slidedog.com](http://slidedog.com) ) 正是这样做的。

1.  您将 Powerpoints 添加到播放列表
2.  SlideDog 加载它们
3.  当您在当前 PPT 的最后一张幻灯片上单击遥控器上的下一步时，SlideDog 将无缝切换到下一个 PPT。

SlideDog 目前支持 Office 2010 PowerPoint 和 PowerPoint Viewer 2010

免责声明：我是 SlideDog 的创建者之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:35:25.313

我没有测试过这个。我假设 ppt thingy 忽略了你的第二个和第三个参数。文档没有说明要处理 arg 列表中的多个文件。

尝试这个：

```
START /WAIT POWERPNT.EXE" /S 00Intro.pptx 
START /WAIT POWERPNT.EXE" /S 01Legal.pptx 
```

（使用相关的 SET PATH=%PATH%;c:/prog .... 或适当的完整路径名）

在批处理文件打开下一个之前，用户必须关闭 powerpoint。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-15T22:20:53.507

使用单独的模板将所有演示文稿整合到一个演示文稿中的巧妙方法：

1.  在**新幻灯片**下，单击**重复使用幻灯片**，选择演示文稿。

要保持格式：

1.  在演示文稿的任何地方创建新的主滑块。
2.  保存要从中传输幻灯片的演示文稿的设计模板。
3.  突出显示传输的幻灯片并进行设计 - 浏览已保存的设计模板。

很高兴回答任何问题。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-11-05T11:29:54.133

不要将您的代码放到 BAT 文件中，而是放到快捷方式： "C:\Program Files (x86)\Microsoft Office\Office14\POWERPNT.EXE" /S " ¤文件的完整路径¤\00Intro.pptx" "¤完整路径到文件¤\01Legal.pptx" "¤文件的完整路径¤\02pers.pptx" 或者为任务计划程序创建任务（如果你想在自动模式下运行它：运行：“C:\Program Files (x86)\Microsoft Office \Office14\POWERPNT.EXE" 参数： /S " ¤文件的完整路径¤\00Intro.pptx" "¤文件的完整路径¤\01Legal.pptx" "¤文件的完整路径¤\02pers.pptx" 这两种情况都是在 Win 8.1 / Office 2010 下成功测试

在我的例子中： "C:\Program Files (x86)\Microsoft Office\Office14\POWERPNT.EXE" /S "D:\Publications\CAD.pptx" "D:\Publications\showmustgoon.pptx"

# javascript - NodeJS：有没有办法在不通过我的管道的情况下从另一台服务器流式传输文件？

> ID：13690678
> 
> 赞同：1
> 
> 时间：2012-12-03T19:57:58.487
> 
> 标签：javascript, node.js, express

我有一个网站，我在其中提供了用于下载/流式传输另一台服务器上的媒体文件的链接。目前我的设置方式类似于以下内容：

```
download = (req, res) ->
  song_id = req.params.id
  download_url = "http://mediaserver.com/#{song_id}"
  console.log("Returning download from: #{download_url}")
  res.set('Content-Type', 'audio/mpeg')
  res.set('Content-Disposition', 'attachment; filename="download.mp3"')
  request.get(download_url).pipe(res)
  #For some reason, express.js on a response end event emits a finish
  #http://www.samcday.com.au/blog/2011/06/27/listening-for-end-of-response-with-nodeexpress-js/
  res.on "finish", ()->
    console.log("Completed song download") 
```

但是，我正在寻找一种方法，我可以只返回一个 HTTP 响应对象，告诉浏览器从适当的服务器而不是我自己的服务器下载它？（可能仍在更改 HTTP 标头以允许将文件另存为下载）。

这有什么可能吗？

泰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:58:59.747

只需使用带有位置标头的 301（永久）或 302（临时）重定向。

```
response.writeHead(302, {
  'Location': 'http://someUrlHere'
}); 
```

我不是 Express 用户，但看起来您可以在 Express 中使用`res.send(302)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:04:20.283

你能不能简单地提供托管实际文件的服务器的链接，然后浏览器会在点击时下载它们？

例如

```
<a href="http://www.assets.com/file.mp3">File</a> 
```

# javascript - $observe 函数在我的测试中永远不会被调用

> ID：13690680
> 
> 赞同：2
> 
> 时间：2012-12-03T19:58:02.933
> 
> 标签：javascript, unit-testing, angularjs

我们有一个指令，上面有一个可选属性。如果该属性不存在，它会提供一个默认值。属性通常从范围内的数据中设置（即属性的值通常是表达式而不是文字字符串。参见[http://jsfiddle.net/8PGZ4/](http://jsfiddle.net/8PGZ4/)

因此，我们`attrs.$observe`在指令中使用来正确设置范围。这在应用程序本身中效果很好。但是，当尝试对此进行测试时（使用 Jasmine），函数中的函数`$observe`永远不会运行。我们的测试看起来像这样：

```
describe("myDirective", function(){ 
    function getDirectiveScope(compile, rootScope, directiveHTML)
    {
        return (compile(directiveHTML)(rootScope)).scope();
    }

    describe("foo", function () {
        it("should return the default value", inject(function ($compile, $rootScope) {
            var directiveScope = getDirectiveScope($compile, $rootScope, '<div my-directive></div>');
            expect(directiveScope.bar).toBe("No Value");
        }));
        it("should now return the value given", inject(function ($compile, $rootScope) {
            $rootScope.foo = "asdf";
            var directiveScope = getDirectiveScope($compile, $rootScope, '<div my-directive foo="{{foo}}"></div>');
            expect(directiveScope.bar).toBe("asdf");
        }));
    });
}); 
```

然后这些失败并出现以下错误：

```
Expected undefined to be 'No Value'.
Expected undefined to be 'asdf'. 
```

我在函数中放置了一个 console.log`$observe`来尝试查看发生了什么，当测试运行时，我从来没有看到日志。我必须进行明确的调用`$observe`才能运行吗？这里还有其他事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:27:47.413

你需要触发一个摘要循环，让 AngularJS 的魔力在你的测试中发生。尝试：

```
it("should return the default value", inject(function ($compile, $rootScope) {
  var directiveScope = getDirectiveScope($compile, $rootScope, '<div my-directive></div>');
  $rootScope.$digest();
  expect(directiveScope.bar).toBe("No Value");
})); 
```

# php - PHP exec() 和 SSL

> ID：13690682
> 
> 赞同：0
> 
> 时间：2012-12-03T19:58:04.493
> 
> 标签：php, ssl, exec

我使用第三方框架（exe 文件）将一个 php 应用程序与 taxt 服务连接起来。

框架是开源的，exe文件签名xml，给soap封面并发送到中央信息税务系统。

当我在批处理文件（run.bat）中打开它时，一切正常：Raverus.FiskalizacijaDEV.EXE.exe GetInvoice "" "C:\xampp\htdocs\get\racun.xml" "C:\xampp\htdocs\get \OutInvoice.xml" true true "C:\xampp\htdocs\get\certifikat.pfx" "密码"

但是当我使用“echo exec('run.bat');”在 PHP 中打开时 服务器给我这个错误：底层连接已关闭：无法为 SSL/TLS 安全通道建立信任关系。

有人知道我该如何解决这个问题吗？当我手动打开批处理文件（在 Windows 中）时，一切正常。我使用 Xampp 服务器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:08:54.463

PHP 用户没有所需的配置或访问权限。

如果您不确定哪个用户正在运行您的 PHP 脚本，您可以使用以下方法来查找：

```
<?php
echo '<pre>';
system('set', $retval);
echo ' </pre>'; 
```

它应该提供有关您的 PHP 正在使用哪个用户的信息。然后*为该用户*设置环境，以便他可以运行您的批处理文件。这可能包括为该用户导入证书。

# php - 将两个数组连接在一起

> ID：13690684
> 
> 赞同：0
> 
> 时间：2012-12-03T19:58:13.370
> 
> 标签：php, arrays, wordpress

我将从代码开始：

```
$checkIpaddresses = $wpdb->get_results( $wpdb->prepare("SELECT affiliateID, source FROM am_ipaddress WHERE affiliateID = $affiliateID"));

foreach ($checkIpaddresses as $ipaddress) { 
    $ipSource = explode(",", $ipaddress->source);
}

$newIP = ",".$ipAddress;
array_push($newIP, $ipSource);

print_r($ipSource); 
```

我在数据库中有一个列，其中包含由`,`（逗号）分隔的 IP 地址列表。我希望能够从数据库中获取该列表，添加一个新的 IP 地址并使用新的 IP 地址列表更新该列。

上面的代码给出了这个错误。`array_push() expects parameter 1 to be array`.

的`$ipAddress`值为`$_SERVER['REMOTE_ADDR'];`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:07:58.497

首先，如果这仅返回一行，则不需要`foreach`.

```
$ipSource = explode(",", $checkIpaddresses[0]->source);  // Get the 1st row as an array 
```

其次，将新 IP 地址添加到阵列过于复杂。

```
$ipSource[] = $ipAddress; 
```

而已。现在`$ipSource`数组包含新的 IP 地址。

（PS`implode(',', $ipSource)`用来把数组变成逗号分隔的字符串）

# android - Android警报队列没有会议时间

> ID：13690686
> 
> 赞同：-1
> 
> 时间：2012-12-03T19:58:27.393
> 
> 标签：android, alarm

我不明白为什么我不能创建警报管理器队列。一旦第一个警报，其他警报级联而不是会议时间。这是单击“开始”按钮时将调用的代码：

```
final AlarmManager[] alarmManager=new AlarmManager[50];    
Integer i =0;
final Calendar calendar = Calendar.getInstance();
public void onClick(View arg0) {

            Intent myIntent = new Intent(AndroidAlarmSMS.this, 
                                         MyAlarmService.class);

            pendingIntent = PendingIntent.getService(AndroidAlarmSMS.this, i, 
                                                     myIntent, 0);

             thatDay.set(dataPick.getYear(), dataPick.getMonth(),dataPick.getDayOfMonth(), timePicker1.getCurrentHour(), timePicker1.getCurrentMinute());

            calendar.setTimeInMillis(System.currentTimeMillis());

            long diff = (thatDay.getTimeInMillis()- calendar.getTimeInMillis());

            int sec =   (int) (diff / 1000 % 60);

                      calendar.add(Calendar.SECOND,sec);//Sec it's the difference between time selected and now
          alarmManager[i] = (AlarmManager)getSystemService(ALARM_SERVICE);
          alarmManager[i].set(AlarmManager.RTC_WAKEUP, 
                      calendar.getTimeInMillis(), pendingIntent);

           i++; 

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T00:16:52.207

您将所有警报设置为在`calendar`' 时间发生，我猜您打算使用`thatDay`：

```
alarmManager[i].set(AlarmManager.RTC_WAKEUP, thatDay.getTimeInMillis(), pendingIntent); 
```

* * *

我有几点注意事项：

*   AlarmManager 只有一个，因此`alarmManager`最多可以包含同一系统服务的 50 个副本。
*   您的索引`i`取决于用户的操作，您可能有少于或*多于*50 个警报。您应该使用 ArrayList 和`add()`.

# java - 在eclipse中找到所有实现抽象类的具体类

> ID：13690690
> 
> 赞同：6
> 
> 时间：2012-12-03T19:58:41.917
> 
> 标签：java, eclipse, class

`Change`在eclipse中 的类上单击“F3” ，

```
Change change = refactoring.createChange(monitor); 
```

我可以打开 Class.java。

```
public abstract class Change implements IAdaptable {
... 
```

但是，我需要实现该类的具体 Java`Change`类。我怎样才能在日食中找到它们？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-03T20:05:28.310

您可以使用快捷键`Ctrl`+`T`查看该类的所有实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T20:04:57.637

> 转到`Windows`-> 打开`Outline View`-> 右键单击​​所需的类 -> 选择`Open Type Hierarchy`。

这将打开包含该类的层次结构的窗口。

# ruby - ruby 正则表达式，拆分为多行

> ID：13690691
> 
> 赞同：-1
> 
> 时间：2012-12-03T19:58:44.523
> 
> 标签：ruby, regex

> **可能重复：**
> [在多行上拆分 Ruby 正则表达式](https://stackoverflow.com/questions/3762183/split-ruby-regex-over-multiple-lines)

如果我在 ruby​​ 中有一个很长的正则表达式，我如何将它分成多行以使其更具可读性？

有没有一种简单的方法可以做到这一点？

```
 line.regexp = /^([^\ ]+) ([^\ ]+) \[(#{timestamp('%d/%b/%Y:%H:%M:%S %z')})?\] (#{ip_address}) ([^\ ]+) ([^\ ]+) (\w+(?:\.\w+)*) ([^\ ]+) "([^"]+)" (\d+) ([^\ ]+) (\d+) (\d+) (\d+) (\d+) "([^"]*)" "([^"]*)"/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:04:15.180

您需要使用`/x`修饰符，它表示自由间距模式。更多关于这里[http://www.regular-expressions.info/freespacing.html](http://www.regular-expressions.info/freespacing.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:27:19.313

我可以想出三种方法让你的代码更具可读性。采用：

1.  修饰符并使用.`/x`添加注释`#`。
2.  `(?#comment_here)`带有修饰符的内联注释。
3.  命名组；例如：`(?<year>\d{2,4})`对于之后的反向引用或操作值很有用。

更多信息： [http ://www.ruby-doc.org/core-1.9.3/Regexp.html](http://www.ruby-doc.org/core-1.9.3/Regexp.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T21:05:08.810

除了`/x`在其他答案中提到的使用之外，分块创建正则表达式，然后逐渐组合它们可以让您从小的原子大小的部分开始，然后慢慢增长正则表达式。您会看到使用一些巨大的模式来完成此操作，例如用于解析电子邮件地址、互联网 URL 等的模式。

例如，这是来自 Ruby 的 OpenURI 源代码：

```
RE_LWS = /[\r\n\t ]+/n
RE_TOKEN = %r{[^\x00- ()<>@,;:\\"/\[\]?={}\x7f]+}n
RE_QUOTED_STRING = %r{"(?:[\r\n\t !#-\[\]-~\x80-\xff]|\\[\x00-\x7f])*"}n
RE_PARAMETERS = %r{(?:;#{RE_LWS}?#{RE_TOKEN}#{RE_LWS}?=#{RE_LWS}?(?:#{RE_TOKEN}|#{RE_QUOTED_STRING})#{RE_LWS}?)*}n 
```

`RE_PARAMETERS`决议：

```
/(?:;(?-mix:[\r\n\t ]+)?(?-mix:[^\x00- ()<>@,;:\\"\/\[\]?={}\x7f]+)(?-mix:[\r\n\t ]+)?=(?-mix:[\r\n\t ]+)?(?:(?-mix:[^\x00- ()<>@,;:\\"\/\[\]?={}\x7f]+)|(?-mix:"(?:[\r\n\t !#-\[\]-~\x80-\xff]|\\[\x00-\x7f])*"))(?-mix:[\r\n\t ]+)?)*/n 
```

# ios6 - Scrolling UIImageView through Interface Builder

> ID：13690696
> 
> 赞同：1
> 
> 时间：2012-12-03T19:58:59.093
> 
> 标签：ios6, interface-builder, constraints, autolayout

Can someone PLEASE help me out here. I've been scouring the internet for 2 days now looking for ways on how to do this. It seems like it should be simple enough, but it's not.

Just like many others, I'm following along the Stanford iOS 5 tutorials and got to Lecture 8: Controller Lifecycle & Image/Scroll/WebViews. I know in this example, he's using springs and struts, but I'd like to see it get done just as easily in iOS 6.

So, in iOS 5, we just set the contentSize of our UIScrollView = to the size of our UIImageView. However, in iOS 6, we're told NOT to set contentSize.

So, I start off with a new project, drag in the UIImageView, embed it into a UIScrollView. I make sure that Auto Layout is enabled. I create outlets in my view controller for both the scroll view and the image view, then I look to my constraints. This is where I get stuck.

With how great everyone says the new constraints are, I can't believe that something as simple as this can't be so straight forward. I've gone through all my constraints. I've made sure that they're all adequate, yet when I run my app, the scroll view doesn't pan the image.

Now, if I implement the following:

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    [self.scrollView removeConstraints:self.scrollView.constraints];
    [self.imageView removeConstraints:self.imageView.constraints];

    NSDictionary *viewsDictionary = [NSDictionary dictionaryWithObjectsAndKeys:self.scrollView, @"sv", self.imageView, @"iv", nil];
    [self.view addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"H:|[sv]|" options:0 metrics:nil views:viewsDictionary]];
    [self.view addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"V:|[sv]|" options:0 metrics:nil views:viewsDictionary]];
    [self.scrollView addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"H:|[iv]|" options:0 metrics:nil views:viewsDictionary]];
    [self.scrollView addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"V:|[iv]|" options:0 metrics:nil views:viewsDictionary]];
} 
```

It works fine, but look at the constraints I set up. It's not like they're complicated. So why can't this be done easily in IB (at least not from everything I've tried)?

If this CAN be done in IB, can someone please show me how?!?!

# debugging - Does cuda-gdb automatically pick the correct focus for a CUDA_EXCEPTION_5 Warp out-of-range address error?

> ID：13690698
> 
> 赞同：2
> 
> 时间：2012-12-03T19:59:01.070
> 
> 标签：debugging, exception, cuda

I have a kernel that's failing with CUDA_EXCEPTION_5, Warp Out-of-range Address.

cuda-gdb automatically places the focus on a specific block. Is that the block where the error is occuring or when nvidia documentation states CUDA_EXCEPTION_5 "is not precise" it means the debugger can't determine which block/thread that specific exception occurred in?

If it's only granular to the warp is there a way to find out within cuda-gdb which warp the exception occurred within and which blocks belong to that warp?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T23:11:09.013

cuda-gdb 并不总是能够精确检测抛出异常的线程。为了提高精度，您需要在使用“set cuda memcheck on”命令启动应用程序之前启用 memcheck 集成。请注意，在启用集成 memcheck 的情况下运行应用程序会降低性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T17:32:03.630

在 CUDA 5.0 中，从 cuda-gdb 中使用 cuda-memcheck 具有与独立运行时类似的内存访问错误检测功能。独立的 cuda-memcheck 应用程序具有额外的功能，例如检测竞争条件、检测内存泄漏以及继续超过第一个错误的能力。cuda-memcheck 与 autostep 无关，当与 cuda-gdb 集成时，将在第一次检测到超出范围或未对齐内存访问的错误时准确停止应用程序。

# css - 为什么 Internet Explorer 使 div 内的内容溢出：隐藏消失？

> ID：13690700
> 
> 赞同：0
> 
> 时间：2012-12-03T19:59:07.767
> 
> 标签：css, internet-explorer

最内层 div 中的内容会显示在除 IE 之外的所有浏览器上。为什么？我注意到如果我从 中删除`overflow:hidden`，`.absolute_container`那么里面的内容`.item`会显示出来，但是出于显示原因，我需要保留 `overflow:hidden`。

HTML：

```
<tr>
    <td>
        <div class="relative">
            <div class="absolute">
                <div class="absolute_container">
                    <div class="relative">
                        <div class="item_wrap">
                            <div class="item">
                                // doesn't show up in IE
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </td>
</tr> 
```

CSS：

```
.relative {
    position: relative;
    width: 100%;
    height: 100%;
}

.absolute {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.absolute_container {
    position: absolute;
    top: 25px;
    right: 5px;
    bottom: 5px;
    left: 5px;
    overflow: hidden;
}

.item_wrap {
    overflow: hidden;
    height: 16px;
    font-size: 12px;
    clear: right;
    white-space: nowrap;
    margin-bottom: 1px;
}

.item {
    position: relative;
    z-index: 999999;
    background-color: transparent;
    float: left;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:08:20.833

您需要清除浮动`.item`以将其放回该布局，否则父元素不知道元素有多大，这就是为什么它在使用`overflow:hidden`.

# biztalk - 已创建主机和主机实例，但无法在接收位置选择它们

> ID：13690703
> 
> 赞同：2
> 
> 时间：2012-12-03T19:59:22.883
> 
> 标签：biztalk, biztalk-2010

我创建了正在运行的主机和主机实例，但在接收处理程序下拉菜单中看不到它们。有没有额外的步骤？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T23:55:32.283

您还需要在平台设置的适配器部分创建一个新的发送和/或接收处理程序。这指示单个进程（主机实例）将适配器处理程序的实例加载到进程空间中。

然后，您将能够在端口配置的下拉列表中选择发送或接收处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-13T07:42:36.340

适配器处理程序绑定到 BizTalk 主机实例，而 BizTalk 主机实例绑定到 BizTalk 服务器。

适配器处理程序是适配器代码在其中运行的 BizTalk 主机的一个实例。当您为适配器指定发送或接收处理程序时，您正在指定适配器代码将在其上下文中运行的主机实例。适配器处理程序负责执行适配器并包含适配器特定实例的属性。默认 BizTalk Server 配置将为所有已安装的适配器创建适配器处理程序。

对于您创建的主机实例，为了使主机在发送/接收处理程序中可见，您必须将主机与适配器链接。

这是通过展开平台设置 -> 适配器 -> 右键单击​​任何适配器 -> 新发送/接收处理程序来完成的。

现在，将主机添加到处理程序。

现在它将在发送/接收处理程序中可见。

除 HTTP 和 SOAP 适配器接收处理程序之外的所有适配器处理程序都必须配置为在进程内主机中运行。HTTP 和 SOAP 适配器接收处理程序只能在隔离主机中运行。

# sql - 对 3 个表的 SQL 查询

> ID：13690704
> 
> 赞同：2
> 
> 时间：2012-12-03T19:59:27.690
> 
> 标签：sql

我有三张桌子：

星系、太阳系和行星。

它们都以明显的方式通过 Id 连接（星系可能有 xx 个太阳系，SS 可以有 xx 个行星）。假设他们有这样的结构：

```
 Galaxy: id, name
    Solar System: id, id_galaxy, name
    Planet: id, id_solar_system, name 
```

我真的在努力创建一个查询来执行以下操作：

**选择根本没有行星的星系名称**。（他们仍然可以拥有空的太阳系）。

请忽略这样一个事实，即某些事情在科学方面似乎不太可能；）

我认为它一定是带有左外连接的东西，我可以轻松选择没有任何行星的太阳系，但我似乎很难将它“传播”到星系。我想我需要一些更复杂的查询，也许是一个子查询）。

请帮忙，我真的很感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:13:39.067

你需要一个`having`子句：

```
SELECT G.id, G.name
FROM Galaxy G LEFT OUTER JOIN
     SolarSystem SS
     ON G.id = SS.id_galaxy LEFT OUTER JOIN
     Planet P
     ON SS.id = P.id_solar_system
group by g_id, g.name
having max(P.id) IS NULL 
```

s将`left outer join`所有行星和太阳系聚集在一起。该`having`子句选择那些在银河系中根本没有行星的行星。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T20:21:28.960

我发现`not exists`对这类问题使用最易读的方法：

```
select name
from galaxy g
where not exists( select * 
                  from solarsystem s join planet p on s.id=p.id_solar_system
                  where id_galaxy=g.id ) 
```

# c# - Timer C# 在游戏开发中的使用

> ID：13690708
> 
> 赞同：0
> 
> 时间：2012-12-03T19:59:35.990
> 
> 标签：c#, timer, stopwatch

我有一个 C# 游戏，我需要允许锦标赛模式，其中每轮为 2 分钟。如何在表格上显示从 0:00 到 2:00 的时间？

我在构造函数中有这个：

```
 Timer timer = new Timer();
        timer.Interval = 1000;
        timer.Tick += new EventHandler(Timer_Tick);
        timer.Start(); 
```

这是事件处理程序

```
 void Timer_Tick(object sender, EventArgs e)
    {
        this.textBox1.Text = DateTime.Now.ToLongTimeString();
    } 
```

但我不知道如何从当前时间的 0:00 开始计时。我尝试创建一个 DateTime 实例，但是当我执行 myDateTime.ToString(); 在事件处理程序中，它仍然是 0:00。

我尝试搜索，但找不到任何相关内容。非常感谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:06:48.343

启动计时器时将当前时间保存到字段：

```
_startTime = DateTime.Now;
timer.Start(); 
```

并稍后计算差异：

```
void Timer_Tick(object sender, EventArgs e)
{
    this.textBox1.Text = (DateTime.Now - _startTime).ToString(@"mm\:ss");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:12:49.410

您需要一个在定时器初始化和 Timer_Tick 事件处理程序范围内的成员变量。

```
class Something
{
    DateTime _myDateTime;
    Timer _timer;

    public Something()
    {
        _timer = new Timer();
        _timer.Interval = 1000;
        _timer.Tick += Timer_Tick;

        _myDateTime = DateTime.Now;
        _timer.Start();

    }

    void Timer_Tick(object sender, EventArgs e)
    {
        var diff = DateTime.Now.Subtract(_myDateTime);
        this.textBox1.Text = diff.ToString();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:06:21.823

```
Stopwatch stopWatch = new Stopwatch();
stopWatch.Start();
Thread.Sleep(10000);
stopWatch.Stop();
// Get the elapsed time as a TimeSpan value.
TimeSpan ts = stopWatch.Elapsed;

// Format and display the TimeSpan value. 
string elapsedTime = String.Format("{0:00}:{1:00}:{2:00}.{3:00}",
ts.Hours, ts.Minutes, ts.Seconds,
ts.Milliseconds / 10);

void Timer_Tick(object sender, EventArgs e)
    {
        label1.Text = stopWatch.ElapsedTicks.ToString();
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T20:07:04.070

您可以在启动计时器时存储 DateTime.Now，然后在每个计时器滴答处理程序中计算 DateTime.Now 和存储的开始日期之间经过的时间。如果您有暂停，您还需要跟踪游戏暂停的时间。

考虑到上述方法的不便之处，我建议您在某处声明一个[StopWatch](http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx)，在您调用 timer.Start 的位置实例化并启动它，然后在您的计时器滴答中读取 StopWatch 的 Elapsed 属性。如果需要，您甚至可以停止和启动（暂停）它。

# jquery - jQUERY星级评分不起作用

> ID：13690709
> 
> 赞同：1
> 
> 时间：2012-12-03T19:59:41.153
> 
> 标签：jquery

目前我尝试将以下星级插件添加到我的 wordpress 博客：[FYNEWORKS](http://www.fyneworks.com/jquery/star-rating/#tab-Testing)

但由于某种原因，我似乎没有工作。我对 jQuery 完全陌生，所以希望你能帮助我。

添加到标题：

```
 <script type="text/javascript" src="/wp-content/themes/wordpress-naked/js/jquery.js"/>
    <script type="text/javascript" src="/wp-content/themes/wordpress-naked/js/jquery.rating.js"/>
    <script type="text/javascript" src="/wp-content/themes/wordpress-naked/js/jquery.form.js"/>
    <script type="text/javascript" src="/wp-content/themes/wordpress-naked/js/jquery.MetaData.js"/>
    <script type="text/javascript" src="/wp-content/themes/wordpress-naked/js/jquery.rating.pack.js"/> 
```

而且在标题中：

```
<script type="text/javascript">
jQuery(function($){
    ('.hover-star').rating({ 
        focus: function(value, link){ 
            var tip = $('#hover-test'); 
            tip[0].data = tip[0].data || tip.html(); 
            tip.html(link.title || 'value: '+value); 
        }, 
        blur: function(value, link){ 
            var tip = $('#hover-test'); 
            $('#hover-test').html(tip[0].data || ''); 
        } 
     });
});
</script> 
```

我的 CSS 文件：

```
/* jQuery.Rating Plugin CSS - http://www.fyneworks.com/jquery/star-rating/ */
div.rating-cancel,div.star-rating{float:left;width:17px;height:15px;text-indent:-999em;cursor:pointer;display:block;background:transparent;overflow:hidden;}
div.rating-cancel,div.rating-cancel a{background:url("/wp-content/themes/wordpress-naked/js/delete.gif") no-repeat 0 -16px; !important}
div.star,div.star a{background:url("/wp-content/themes/wordpress-naked/js/star.gif") no-repeat 0 0px; !important}
div.rating-cancel a,div.star-rating a{display:block;width:16px;height:100%;background-position:0 0px;border:0 !important;}
div.star-rating-on a{background-position:0 -16px!important;}
div.star-rating-hover a{background-position:0 -32px;}
/* Read Only CSS */
div.star-rating-readonly a{cursor:default !important;}
/* Partial Star CSS */
div.star-rating{background:transparent!important;overflow:hidden!important;}
/* END jQuery.Rating Plugin CSS */ 
```

我的单选按钮具有第二个代码部分“.hover-star”中定义的类。

但是，它仍然无法正常工作。我打错字还是忽略了什么？

谢谢 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:04:15.513

您的脚本应该几乎总是在文档完全加载后启动，否则它会执行得太早并且找不到项目。

```
$(document).ready(function() { ... // your code // ... }) 
```

*关于丢失的 $， wirey*也是正确的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:05:23.780

首先，您没有在这里调用 jQuery：

`('.hover-star').rating({`

`$`您需要使用or调用 jQuery `jQuery`：

`$('.hover-star').rating({`

可能还有其他问题。我建议使用调试器。这将有助于找到这个问题和其他问题。

# ios - iOS中的程序化无间隙音频序列

> ID：13690712
> 
> 赞同：1
> 
> 时间：2012-12-03T20:00:01.963
> 
> 标签：ios, objective-c, loops, audio, playback

我有许多必须无缝播放的循环，这样我只有在最后一个完成时才知道要播放哪个循环。

所以我用 AVAudioPlayer 完成了它，添加了一个委托，这样我就知道音频何时完成播放，并且在该方法中我触发了下一个要播放的音频，但是两个音频之间存在静音间隙，我无法使用它。

我尝试使用 .CAF 格式而不是 .AIF 格式，但效果不佳。

谁能帮我这个？Core Audio 现在对我来说似乎有点难以理解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T05:30:50.483

刚刚在github上找到了Novocaine，稍微调整了一下：

[https://github.com/alexbw/novocaine](https://github.com/alexbw/novocaine)

[Novocaine - 如何循环播放文件？(iOS)](https://stackoverflow.com/questions/13189251/novocaine-how-to-loop-file-playback-ios/13785092#13785092)

# php - 检查行是否在while循环中分组

> ID：13690714
> 
> 赞同：0
> 
> 时间：2012-12-03T20:00:03.947
> 
> 标签：php, mysql, group-by

我想一个简单的问题，我如何检查该行是否在一个while循环中分组。我希望能够确定它是否已分组，以便我可以更改在分组时回显的文本，但保持未分组的行相同。我希望这是有道理的，因为我不确定如何解释它。

这是我的代码

```
if($r['type'] == "Wall"){
$offern = $r['aff'];
}else{
$offern = $offn['name'];
}
//  IF GROUPED $r['user_id'] <- It is grouped by `user_id` -> $offern = "Several";

print "<tr>
<td></td>
                <td><a href='lockedf.php?id=".$r['user_id']."'>{$namess['username']}</a></td>
                <td>".$offern."</td>
                <td>{$r['point']} Points</td>
                <td>".date("m/d/Y h:i:s A", $r['date_submitted'])."</td>
                <td><a href='unlock.php?id={$r['id']}' class='ask'><img src='images/unlock.png' alt='' title='' border='0' /></a></td>
                <td><a href='deny.php?id={$r['id']}' class='ask'><img src='images/trash.png' alt='' title='' border='0' /></a></td>
                </tr>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:43:36.397

所以，如果你有这样的数据：

```
`USER_ID`  |  `FavoriteCandy`

1        |   'Snickers'
1        |   'Butterfinger'
2        |   'Hershey'
3        |   'Twix' 
```

和这样的查询：

```
SELECT USER_ID
FROM tbl
GROUP BY USER_ID; 
```

你的目标是找出哪个用户（在这种情况下是用户 1）可能缺少糖果，因为它被分组了......你可以这样做：

```
SELECT `USER_ID`, COUNT(`FavoriteCandy`)
FROM tbl
GROUP BY USER_ID; 
```

或者，将其限制为仅按如下方式分组的用户：

```
SELECT `USER_ID`
FROM tbl
GROUP BY USER_ID
HAVING COUNT(`FavoriteCandy`) > 1; 
```

# php - php如何区分0或1和布尔值

> ID：13690715
> 
> 赞同：0
> 
> 时间：2012-12-03T20:00:05.187
> 
> 标签：php, variables, boolean

在某些情况下，array_search() 返回的键是 0 或 1。当我在 if 语句中使用此返回值时，php 将其解释为布尔值。但我希望将其解释为字符串。我怎样才能做到这一点？

例子：

```
$array=array('abc','a','b');

$returnvalue=array_search('abc',$array); // will be 0

if($returnvalue!=false){
statement // right now, this will not be executed
} 
```

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:01:01.527

使用类型安全比较：

```
if ($returnvalue !== false) 
```

== 也支持相同的操作，使用 ===：

```
if ($returnvalue === false)
{
    // not found
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:02:34.490

`==`比较价值

`===`比较值和数据类型

看：

```
$array = array('abc','a','b');
$returnvalue = array_search('abc', $array); // will be 0

if($returnvalue == false){
    // Executed
    var_dump($returnvalue);
}

if($returnvalue === false){
    // Not executed
    var_dump($returnvalue);
} 
```

# jsp - 使用 doBody 从自定义 JSP 标记将变量传递回父 JSP

> ID：13690716
> 
> 赞同：1
> 
> 时间：2012-12-03T20:00:07.967
> 
> 标签：jsp, jstl, jsp-tags

我正在处理一个处理分层 Bean 的自定义标记。bean 看起来像这样：

```
public class HierarchyBean {
    public List<HierarchyBean> children;
    public List<SomeOtherBean> someListOfBeans;
    // getters/setters for Bean
} 
```

现在我想制作一个标签，以便我可以在我的 JSP 中执行此操作：

```
<ul>
<cust:hierarchy hierarchyBean="${root}">
    <li>${subBean}</li>
</cust:hierarchy>
</ul> 
```

自定义标签看起来像这样：

```
<%@ tag body-content="scriptless" %>

<%@ attribute name="hierarchyBean" required="true" rtexprvalue="true" type="com.publix.webforms3.survey.domain.Element" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"  %>
<%@ taglib uri="http://www.springframework.org/tags" prefix="spring" %>
<%@ taglib uri="http://www.springframework.org/tags/form" prefix="form" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %>
<%@ taglib prefix="cust" tagdir="/WEB-INF/tags/hierarchy" %>

<c:forEach items="${someListOfBeans}" var="bean">
    <c:set var="subBean" value="${bean}" scope="page" />
    <jsp:doBody />
</forEach>
<ul>
<c:forEach items="${children}" var="child">
<cust:hierarchy hierarchyBean="${root}">
    <li>${subBean}</li>
</cust:hierarchy>
</c:forEach>
</ul> 
```

所以，首先，让我道歉，如果上面的代码有草率的错误......我的实际项目是相当复杂的，我试图手动输入一个更简单的例子。

其次，我想指出标签 IS 工作的递归性质。不起作用的是“subBean”的设置。我尝试了使用和不使用 c:set，但在我的调用 JSP 代码中，似乎 subBean 没有从标记执行回到标记内的主体。

我知道 jsp:doBody 有一些属性，即 var 和 varReader，但似乎两者都没有做我需要的。

这是否可能，如果是这样，我在这里做错了什么导致它不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:13:45.093

您应该将以下内容添加到您的标签中：

```
<%@ variable name-given="subBean" scope="NESTED" %> 
```

这将导致容器保存页面中 subBean 属性的值（如果有），然后调用您的标签并使标签定义的 subBean 变量可用于标签的主体，然后恢复保存的 subBean 值属性。

更多细节[在这里](http://docs.oracle.com/javaee/1.4/tutorial/doc/JSPTags5.html#wp90024)。

# c# - 将数据表绑定到文本框用户控件

> ID：13690718
> 
> 赞同：0
> 
> 时间：2012-12-03T20:00:12.947
> 
> 标签：c#, winforms, visual-studio-2010, data-binding, user-controls

我搜索了很多这个问题，但我没有找到任何明确的帖子。

我用这个命令进行数据绑定：

```
userControl11.DataBindings.Clear();
userControl1.DataBindings.Add( "Text",dt,"DM" ); 
```

我也把`dt` datagridview数据源。

这适用于通常的控件，但不适用于用户控件。

现在，如果我选择不同的 datagridview 行并且它始终为空，则用户控件的文本不会改变。

我认为这个问题很简单。我应该使用`INotifyPropertyChanged`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T15:31:44.087

我知道答案很简单！

只是我在 Usercontrol 中做到了这一点：

```
 public override string Text
    {
        get { return txtmoney.Text; }
        set
        {

            txtmoney.Text = value;

        }
    } 
```

这要以我的形式绑定：

```
uctextbox1.DataBindings.Add( "text",DT,"DM" ); 
```

# c++ - 如何为会话中的多个 put 请求重用相同的 HTTPS 连接？

> ID：13690721
> 
> 赞同：2
> 
> 时间：2012-12-03T20:00:15.723
> 
> 标签：c++, web, https, put, winhttp

要将文件发送到服务器，我在 Windows 中执行 HTTPS put 请求，如下所示：

```
hSession = WinHttpOpen(  L"Agent/1.0",..
hConnect = WinHttpConnect(hSession,..
hRequest = WinHttpOpenRequest( hConnect, L"PUT",..
WinHttpSetCredentials(hRequest,..
WinHttpAddRequestHeaders( hRequest,..
WinHttpSendRequest( hRequest,..
WinHttpWriteData(hRequest,..
WinHttpReceiveResponse(hRequest,..
WinHttpQueryHeaders(hRequest,..
if (hRequest) WinHttpCloseHandle(hRequest);
if (hConnect) WinHttpCloseHandle(hConnect);
if (hSession) WinHttpCloseHandle(hSession); 
```

此命令包针对应发送到服务器的每个文件运行。为要发送的每个文件从头开始建立连接会产生额外的开销。现在我正在寻找一种方法来减少这种开销。

所以我有两个问题：

*   是否有必要为每个 put 请求打开和关闭一个新的 HTTPS 连接？
*   有没有办法建立一个会话并为这个会话中的许多 put 请求重用相同的 HTTPS 连接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T00:54:07.567

答案如下：

1.  不会。一个连接可能会执行一堆请求。
2.  这是代码的草稿：

    ```
    hSession = WinHttpOpen( L"Agent/1.0",..
    hConnect = WinHttpConnect(hSession,.. 
    for (all_files_to_upload) { 
        hRequest = WinHttpOpenRequest( hConnect, L"PUT",..
        WinHttpSetCredentials(hRequest,.. 
        WinHttpAddRequestHeaders( hRequest,.. 
        WinHttpSendRequest( hRequest,.. 
        WinHttpWriteData(hRequest,.. 
        WinHttpReceiveResponse(hRequest,.. 
        WinHttpQueryHeaders(hRequest,.. 
        WinHttpCloseHandle(hRequest);
    } 

    if (hConnect) WinHttpCloseHandle(hConnect);
    if (hSession) WinHttpCloseHandle(hSession); 
    ```

# crystal-reports - CrystalDecisions.CrystalReports.Engine.LogOnException

> ID：13690722
> 
> 赞同：1
> 
> 时间：2012-12-03T20:00:20.240
> 
> 标签：crystal-reports, report

当我将代码移动到新服务器时，出现错误：

> 程序集“CrystalDecisions.Shared，版本=13.0.2000.0，文化=中性，PublicKeyToken=692fbea5521e1304”中的类型“CrystalDecisions.CrystalReports.Engine.LogOnException”未标记为可序列化。

它在我当地工作得很好。服务器是window 2008 R2，数据库是Oracle。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T07:53:42.480

您的报告的数据源是什么？

正如 Ivan 所说，有很多选择 - 但您可能应该首先检查您是否可以从新服务器连接。您是否使用 SSPI 但未使用具有权限等的域帐户运行应用程序

# javascript - 附加一个 div 使其出现在另一个 div 旁边

> ID：13690723
> 
> 赞同：0
> 
> 时间：2012-12-03T20:00:23.010
> 
> 标签：javascript, jquery

我正在尝试使用 Jquery 拖放创建“匹配”效果。

我有这个 html -

```
<div class="questionMatch">
    <text class="matchingText clear">Q1</text>
    <div class="dropAcceptor floatRight"></div>
</div>
<div class="questionMatch">
    <text class="matchingText">Q2</text>
    <div class="dropAcceptor"></div>

</div>
<div class="questionMatch">
    <text class="matchingText">Q3</text>
    <div class="dropAcceptor"></div>

</div>
<div class="questionMatch">
    <text class="matchingText clear">Q4</text>
    <div class="dropAcceptor"></div>

</div>
<div class="answerPane">
    <div class="answerMatch floatRight">
        <text class="matchingText">Match1</text>
    </div>
    <div class="answerMatch">
        <text class="matchingText">Match2</text>

    </div> 
```

我想要它，以便当我将 .answerMatch 拖放到 .questionMatch 上时，.answerMatch 会以这样的方式附加到 .questionMatch 中，使其显示在 .questionMatch 的文本旁边。

我试过这个 JS

```
$(document).ready(function(){
$(".questionMatch").droppable({accept:".answerMatch",
    drop:function(event,ui){
        $(this).find(".dropAcceptor").append($(ui.draggable));
        }
    }

    )
$(".answerMatch").draggable(); 
```

});

并且正确地附加了元素，但它出现在 .questionMatch/not 旁边的上方。

我该怎么做才能达到这个效果？

正在使用的 CSS-

```
.floatLeft{
    float:left;
}
.floatRight{
    float:right;
}
.clear{
    clear:both;
} 
```

JSFIDDLE 显示问题 - [http://jsfiddle.net/qMxxF/1/](http://jsfiddle.net/qMxxF/1/)

更新-控制台中的检查显示 Jquery 拖放在样式属性中添加了定位-我已将其删除，并且 answerMatch 现在出现在问题下方。使它显示在右侧的 css 是什么？当我向右浮动时，它会出现在浏览器的右端。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:05:56.940

利用[`.after()`](http://api.jquery.com/after/)

```
$(this).after($(ui.draggable)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:10:41.667

如何用 div 标签替换你的文本标签：

```
<div class="matchingText floatLeft"></div> 
```

和：

```
floatLeft {float:left;} 
```

或者，为了与答案格式一致：

```
<div class="QA">
<div class="questionMatch floatLeft"><text class="matchingText clear">Q1</text></div>
<div class="dropAcceptor floatRight"></div>
</div> 
```

# javascript - 无法配置 Require.js baseUrl

> ID：13690726
> 
> 赞同：-1
> 
> 时间：2012-12-03T20:00:43.163
> 
> 标签：javascript, backbone.js, requirejs

我有以下应用程序结构：

```
+ project
  + app
  + script
    + vendors
      + backbone
      + underscore
      - require.js
      - require.config.js
  package.json 
```

我已经使用`jam.js`. 它`package.json`看起来像这样：

```
{
   "name": "Project",
   "jam": {
             "packageDir": "app/scripts/vendor",
         "baseUrl": "app",
         "dependencies": {
                 "backbone": null
         }
   }
} 
```

baseUrl 设置为 app 文件夹，如果我从 `localhost/project/app`它运行我的应用程序就可以了。但最终在后端，我的应用程序`index.html`包含在一个 php 网页中，因此所有模块的 url 都被破坏了，例如：

```
GET http://builder1.localhost/user/scripts/vendor/require.js 404 (Not Found) 
```

而不是加载：

```
localhost/project/app/scripts/vendor/require.js 
```

我该如何配置`'baseUrl'`它才能知道我是通过加载的`http://builder1.localhost/user/`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T12:33:06.507

您的入口脚本（由 require.js 加载的第一个脚本）应该具有类似于以下内容的内容

```
require.config({
   baseUrl: "/another/path",
    paths: {
        "some": "some/v1.0"
    },
    waitSeconds: 15
});
require( ["some/module", "my/module", "a.js", "b.js"],
    function(someModule,    myModule) {
        //This function will be called when all the dependencies
        //listed above are loaded. Note that this function could
        //be called before the page is loaded.
        //This callback is optional.
    }
); 
```

那是直接从那里的文档中获取的。仔细检查您的代码。如果基本 URL 是绝对路径而不是相对路径，则它会更好。

# castle-windsor - 自定义 HandleExceptionFilter 的临时生活方式可以吗？

> ID：13690728
> 
> 赞同：0
> 
> 时间：2012-12-03T20:00:48.867
> 
> 标签：castle-windsor, ioc-container, castle

使用城堡 Windsor，我将 HandleException Filter 添加到 Windsor 容器中，这样我就可以将 ILogger 注入到 HandleExceptionFilter 中。我无法使用 LifestylePerWebRequest，因为我会收到此[错误](http://blog.ploeh.dk/2009/11/17/UsingCastleWindsorsPerWebRequestLifestyleWithASPNETMVCOnIIS7.aspx)。我想知道我的 HandleExceptionFilter 是否会在瞬态时正确释放？

```
 public override IController CreateController(RequestContext requestContext, string controllerName)
        {

            var controller = base.CreateController(requestContext, controllerName);

            var c = controller as Controller;

            if (c != null)
            {
                c.ActionInvoker = new ErrorHandlingActionInvoker(_kernel.Resolve<IExceptionFilter>());
            }

            return controller;
        }
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T22:01:53.250

对于瞬态分量：

如果您使用 Resolve< > 从容器中解析它们，它们将一直存在，直到您明确释放它们为止。

如果您使用类型化工厂创建组件，则该组件将一直存在，直到您在工厂上调用 Destroy 方法，或者如果您在工厂的生命周期结束之前不调用任何方法。

如果瞬态组件被解析为构造函数中的依赖项或属性的设置器，则组件将一直存在，直到包含组件的生命周期结束。

这假定使用了默认的发布策略。如果使用 NoTracking 删除策略，容器将不会保存对组件的引用。（不推荐使用它）。

我希望这回答了你的问题。

# javascript - 取消html5视频下载

> ID：13690729
> 
> 赞同：1
> 
> 时间：2012-12-03T20:00:55.957
> 
> 标签：javascript, jquery, html5-video

我正在建立一个视频播放列表。每次用户单击新项目时，我想在开始下载新视频之前**停止下载当前视频**（如果它仍在进行中）。

这是我能想出的代码。它部分有效，但是当我调用 destroyVideo() 方法时，似乎没有任何下载被​​取消。我正在使用 Chrome 的网络监视器进行检查。

```
function createVideo(videoObject) {
    var html = '<video id="video" loop><source id="mp4" src="' + video.mp4 + '" type="video/mp4" /><source id="webm" src="' + video.webm + '" type="video/webm" /><source id="ogg" src="'+ video.ogg + '" type="video/ogg" /></video>';

    var videoContainerDiv = $('#videoContainerDiv');    
    videoContainerDiv.append(html);

    var asset = $('#video');
    asset.get(0).load();
}

function destroyVideo() {
    var asset = $('#video');

    var mp4 = $('#mp4');
    mp4.attr('src', '');

    var webm = $('#webm');
    webm.attr('src', '');

    var ogg = $('#ogg');
    ogg.attr('src', '');

    asset.attr('src', '');
    asset.get(0).load();

    var videoContainerDiv = $('#videoContainerDiv');
    videoContainerDiv.empty();
} 
```

我的问题是：有没有更有效的方法来做到这一点，跨浏览器？

高度赞赏帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:21:00.330

```
function destroyVideo() {
    var asset = $('#video');
    asset.remove();
} 
```

# go - 从多个 go 例程中汇集数据的线程安全方法

> ID：13690734
> 
> 赞同：21
> 
> 时间：2012-12-03T20:01:09.017
> 
> 标签：go

给定以下示例：[http ://play.golang.org/p/owvJ8Oi77S](http://play.golang.org/p/owvJ8Oi77S)

```
func produce(dataChannel chan int) {
    for i := 0; i < 10; i++ {
        dataChannel <- i
    }
}

func main() {
    dataChannel := make(chan int)

    go produce(dataChannel)
    go produce(dataChannel)
    go produce(dataChannel)

    for i := 0; i < 30; i++ {
        data := <-dataChannel
        fmt.Printf("%v ", data)
    }
} 
```

我认为从多个 go 例程写入通道不安全的假设是否正确？

有没有一种常见/惯用的方法可以安全地做到这一点？我知道您可以为每个生成数据的例程创建一个单独的通道，我只是想知道这是否是最干净的解决方案，或者是否有其他替代方案。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-12-03T20:04:02.997

通道是完全线程安全的。它们是 goroutine 之间通信的官方方式。我认为您的代码没有任何问题。这就是围棋之美。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-04T20:55:24.013

通道旨在在线程之间共享（这是“线程安全”的正常含义）。使用通道意味着您没有共享内存，您可能会面临竞争风险。所以丹尼尔的回答是正确的：使用渠道，因为这就是它们的用途。

但请注意，goroutine 会创建通信顺序进程的网络，如果出现设计错误，**有时可能会死锁。**他们也可以活锁（同样的事情，但很忙）。

关于如何避免死锁/活锁，有相当多的知识。其中大部分来自 Occam 在 80 年代和 90 年代流行的日子。Jeremy Martin（[无死锁并发系统的设计策略](http://wotug.ukc.ac.uk/parallel/theory/formal/csp/jeremy-martin/)）、Peter Welch（[高级范式](http://kar.kent.ac.uk/21094/1/HigherWelch.pdf)）等人提供了一些特别的杰作。

# java - 我应该在 apache fop 的类路径中包含哪些 jar

> ID：13690735
> 
> 赞同：1
> 
> 时间：2012-12-03T20:01:14.747
> 
> 标签：java, websphere-7, apache-fop

我在 websphere 7.0 的 WEB-INF lib 目录`ClassNotFoundException`中`Apache-FOP`包含 fop.jar。我将 xmlgraphics-commons-1.4.jar 添加到我的库中，然后它会引发验证错误。

`Caused by: java.lang.VerifyError: JVMVRFY012 stack shape inconsistent; class=org/apache/fop/fo/ElementMappingRegistry, method=findFOMaker(Ljava/lang/String;Ljava/lang/String;Lorg/xml/sax/Locator;)Lorg/apache/fop/fo/ElementMapping$Maker;, pc=127`

```
Caused by: java.lang.NoClassDefFoundError: org.apache.xmlgraphics.image.loader.ImageContext
    at java.lang.ClassLoader.defineClassImpl(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:274)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:69)
    at com.ibm.ws.classloader.CompoundClassLoader._defineClass(CompoundClassLoader.java:768)
    at com.ibm.ws.classloader.CompoundClassLoader.localFindClass(CompoundClassLoader.java:687)
    at com.ibm.ws.classloader.CompoundClassLoader.loadClass(CompoundClassLoader.java:510)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:618)
    at cat.gis.portal.servicehistory.controllers.EquipmentServiceHistoryDetailsViewController.generatePDF(EquipmentServiceHistoryDetailsViewController.java:281)
    at cat.gis.portal.servicehistory.controllers.EquipmentServiceHistoryDetailsViewController.workOrderDetailsView(EquipmentServiceHistoryDetailsViewController.java:205)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
    at java.lang.reflect.Method.invoke(Method.java:600)
    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:176)
    at org.springframework.web.portlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:362)
    at org.springframework.web.portlet.mvc.annotation.AnnotationMethodHandlerAdapter.doHandle(AnnotationMethodHandlerAdapter.java:349)
    at org.springframework.web.portlet.mvc.annotation.AnnotationMethodHandlerAdapter.handleResource(AnnotationMethodHandlerAdapter.java:296)
    at org.springframework.web.portlet.DispatcherPortlet.doResourceService(DispatcherPortlet.java:825)
    ... 119 more
Caused by: java.lang.ClassNotFoundException: org.apache.xmlgraphics.image.loader.ImageContext
    at java.net.URLClassLoader.findClass(URLClassLoader.java:421)
    at com.ibm.ws.bootstrap.ExtClassLoader.findClass(ExtClassLoader.java:191)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:652)
    at com.ibm.ws.bootstrap.ExtClassLoader.loadClass(ExtClassLoader.java:111)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:618)
    at com.ibm.ws.classloader.ProtectionClassLoader.loadClass(ProtectionClassLoader.java:62)
    at com.ibm.ws.classloader.ProtectionClassLoader.loadClass(ProtectionClassLoader.java:58)
    at com.ibm.ws.classloader.CompoundClassLoader.loadClass(CompoundClassLoader.java:540)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:618)
    at com.ibm.ws.classloader.CompoundClassLoader.loadClass(CompoundClassLoader.java:508)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:618)
    at com.ibm.ws.classloader.CompoundClassLoader.loadClass(CompoundClassLoader.java:508)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:618)
    ... 137 more 
```

**更新**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.1"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:fo="http://www.w3.org/1999/XSL/Format">
<xsl:output encoding="iso-8859-1" />
<xsl:template match ="services">
    <fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format">
        <fo:layout-master-set>
            <fo:simple-page-master master-name="service">
                <fo:region-body></fo:region-body>
            </fo:simple-page-master>
        </fo:layout-master-set>

        <fo:page-sequence master-reference="service">
            <fo:flow flow-name="xsl-region-body">
                <fo:block>
                    <fo:table>
                        <fo:table-body>
                            <fo:table-row>
                                <fo:table-cell border="solid 1px black" 
                                text-align="center" font-weight="bold">
                                    <fo:block>Service Id</fo:block>
                                </fo:table-cell>
                                <fo:table-cell border="solid 1px black" 
                                text-align="center" font-weight="bold">
                                    <fo:block>Open Date</fo:block>
                                </fo:table-cell>
                                <fo:table-cell border="solid 1px black" 
                                text-align="center" font-weight="bold">
                                    <fo:block>Close Date</fo:block>
                                </fo:table-cell>                                    
                                <fo:table-cell border="solid 1px black" 
                                text-align="center" font-weight="bold">
                                    <fo:block>Order Status</fo:block>
                                </fo:table-cell>                                    
                                <fo:table-cell border="solid 1px black" 
                                text-align="center" font-weight="bold">
                                    <fo:block>Description</fo:block>
                                </fo:table-cell>
                                <fo:table-cell border="solid 1px black" 
                                text-align="center" font-weight="bold">
                                    <fo:block>Repair Cost</fo:block>
                                </fo:table-cell>
                            </fo:table-row>
                            <xsl:for-each select="./service">
                                <fo:table-row>
                                    <fo:table-cell border="solid 1px bold" text-align="center">
                                        <fo:block><xsl:value-of select="serviceId" /></fo:block>
                                    </fo:table-cell>
                                    <fo:table-cell border="solid 1px bold" text-align="center">
                                        <fo:block><xsl:value-of select="openDate" /></fo:block>
                                    </fo:table-cell>
                                    <fo:table-cell border="solid 1px bold" text-align="center">
                                        <fo:block><xsl:value-of select="closeDate" /></fo:block>
                                    </fo:table-cell>                                
                                    <fo:table-cell border="solid 1px bold" text-align="center">
                                        <fo:block><xsl:value-of select="orderStatus" /></fo:block>
                                    </fo:table-cell>
                                    <fo:table-cell border="solid 1px bold" text-align="center">
                                        <fo:block><xsl:value-of select="description" /></fo:block>
                                    </fo:table-cell>
                                    <fo:table-cell border="solid 1px bold" text-align="center">
                                        <fo:block><xsl:value-of select="repairCost" /></fo:block>
                                    </fo:table-cell>
                                </fo:table-row>
                            </xsl:for-each>
                        </fo:table-body>
                    </fo:table>
                </fo:block>
            </fo:flow>
        </fo:page-sequence>
    </fo:root>
</xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T14:56:38.160

请记住，jar 文件主要只是一个带有清单的 zip 文件：使用您最喜欢的解压缩工具解压缩 jar，查看*META-INF/MANIFEST.MF*文件的内部，并检查类路径中的所有内容是否存在。对我来说（FOP 1.0），类路径条目是这个：

类路径：avalon-framework-4.2.0.jar batik-all-1.7.jar commons-io-1。3.1.jar commons-logging-1.0.4.jar fop-hyph.jar serializer-2.7.0.jar s ervlet-2.2.jar xalan-2.7.0.jar xercesImpl-2.7.1.jar xml-apis-1.3。 04.j ar xml-apis-ext-1.3.04.jar xmlgraphics-commons-1.4.jar

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-15T16:07:18.927

*……5年后……*

`NoClassDefFoundError`我遇到了同样的问题，并通过搜索包名称来迭代所有 throwed 来快速修复它，例如，并添加了从[Maven Repository](https://mvnrepository.com/)下载的`org.apache.xmlgraphics`所有丢失的内容。`.jars`

也许，您可以使用 Maven 插件来避免依赖地狱并引用所有丢失的 .jar，但我没有尝试过。

我**从 Apr, 2017 开始使用 Apache FOP 2.2 版**。将以下所有 .jar 添加到您的`WEB-INF/lib`，您可能能够处理：

*   avalon-framework-4.2.0.jar
*   蜡染桥-1.9.1.jar
*   commons-io-2.4.jar
*   commons-logging-1.2.jar
*   fop.jar
*   org.apache.batik.css-1.6.0.v201011041432.jar
*   org.apache.batik.svggen-1.6.0.v201011041432.jar
*   org.apache.batik.transcoder-1.6.0.v201011041432.jar
*   org.apache.batik.util-1.6.0.v201011041432.jar
*   xmlgraphics-commons-2.2.jar

# ios - 如何在 iOS 应用中更快地搜索本地数据？

> ID：13690742
> 
> 赞同：1
> 
> 时间：2012-12-03T20:01:39.063
> 
> 标签：ios, ipad, uitableview

我有一个预填充的 Coredata 文件，我想在 iOS 应用程序中进行搜索。该文件有这样的索引词~（70,000 行）~10 MB 文件。

```
ad
adam
arm
apple
..
..
zen
zener 
```

我已经从文件中构建了 Coredata 并查询了 SQLLite 例如：给我所有以“a”开头的单词。在模拟器上搜索大约需要 300 毫秒，但在 iPad 设备上大约需要 2 秒或更长时间？我怎样才能让它更快？其他搜索引擎类型的应用程序如何在设备上执行此操作？

```
//////////////////////////////////////////////////////////////////////
//This will get list of words begining with letters from search word
//////////////////////////////////////////////////////////////////////
-(void) FetchWords
{
NSString *entityName=@"KeyWord";
NSString *sortKey = @"word";
NSArray *fetchColumns = [[NSArray alloc] initWithObjects:@"word", nil];

//init fetch request
NSFetchRequest *req = [[NSFetchRequest alloc] init];

NSString *query = self.searchBar.text;

//
//split search phrase into words - searches words with any order and not case senitive - remove last space if any
//
NSMutableArray *words = [[query componentsSeparatedByString:@" "] mutableCopy];
if([words[words.count-1] isEqualToString:@""])
    [words removeObjectAtIndex:[words count]-1];

if(query.length)
{

    NSMutableArray *subpredicates = [NSMutableArray array];

    if(words.count >1)
    {
       [self GetMatchingCategoryCodes];
      //  NSLog(@"%@",categories);

        for (NSString *code in categories)
        {
            //intersection between last word and previous categories already filtered for previous words in search

           NSPredicate *pred = [NSPredicate predicateWithFormat:@"word BEGINSWITH[cd] %@ AND code BEGINSWITH [cd] %@",words[words.count-1],code]; 
           [subpredicates addObject:pred];
        }

      req.predicate = [NSCompoundPredicate orPredicateWithSubpredicates:subpredicates];

    }
    else
    {
       for(NSString *token in words)
       {
           NSPredicate *pred = [NSPredicate predicateWithFormat:@"word BEGINSWITH[cd] %@",token];
          [subpredicates addObject:pred]; 
       }
       req.predicate = [NSCompoundPredicate orPredicateWithSubpredicates:subpredicates];

    }
}

//setup request
NSEntityDescription *entity = [NSEntityDescription entityForName:entityName inManagedObjectContext:context];
[req setEntity:entity];
[req setFetchBatchSize:100];

//sort descriptors
NSSortDescriptor *desc = [[NSSortDescriptor alloc] initWithKey:sortKey ascending:YES];
NSArray *descriptors = [NSArray arrayWithObject:desc];
[req setSortDescriptors:descriptors];

//for unique values - ignore repeatition
req.propertiesToFetch = fetchColumns;
req.returnsDistinctResults = YES;
req.resultType = NSDictionaryResultType;

//execute request
NSError *error;
Codes = [context executeFetchRequest:req error:&error];

//  NSLog(@"Fetched=%d",Codes.count);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:19:21.777

您可以尝试延迟加载并将输出限制为 50 或更少的项目，因为它们无论如何都不会在屏幕上可见。当用户在结果列表中滚动时，您可以根据需要获取更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:34:25.150

优化方法不止一种。

例如，使用 CONTAINS 会减慢搜索速度。Apple 建议对搜索词使用单独的实体 - 称为 searchWords（或其他），并在该实体中存储您要搜索的所有词，将其设为小写并删除重音符号。这些单独的实体具有将它们链接回原始对象的关系。确保 word 字段已编入索引。

此外，只有输入到搜索字段中的第一个字母才能命中磁盘。在第一个字母之后，您应该只优化内存中已经存在的搜索结果。

您应该使用已有的谓词过滤内存中的数组（从第一个字母搜索），并避免执行获取请求，因为它是不必要的。

此外，如果您要搜索已经在内存中的数据（例如生活在 NSFetchedResultsController 中），那么您的整个搜索应该只命中内存中的对象。去磁盘是不必要的，而且非常浪费。如果不使用 ResultsController，您可以将数据缓存在数组中，仅在您第一次点击后在内存中执行搜索。这也应该加快您的请求。

因此，使用启用了批量大小和缓存的 FetchedResultsController 也应该可以改善您的搜索。

顺便说一句：您可以在后台线程上执行那些“密集”搜索，以避免键盘滞后。但是你必须确保一次只执行一个后台请求并且只获取最新的结果。将线程标记为较低的优先级可确保 UI 运行良好。

这里有一个关于通过示例代码提高 coredata 搜索速度的 wwdc：
[Apple WWDC Core Data](http://developer.apple.com/itunes/?destination=adc.apple.com.4092349126.04109539109.4144345613?i=2041584141)
[Optimizing Core Data Performance on iPhone OS（幻灯片）](http://adcdownload.apple.com//wwdc_2010/wwdc_2010_video_assets__pdfs/137__optimizing_core_data_performance_on_iphone_os.pdf)
[Optimizing Core Data Performance on iPhone OS（视频）](https://developer.apple.com/itunes/?destination=adc.apple.com.4092349126.04109539109.4144345647?i=1251375466)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:24:16.507

如果您在表格视图中显示这些单词，您当然应该考虑使用 NSFetchedResultsController 并启用缓存。

# mysql - 如何限制 SOLR 在索引时建立的数据库连接数？

> ID：13690751
> 
> 赞同：3
> 
> 时间：2012-12-03T20:02:06.317
> 
> 标签：mysql, database, solr, lucene

您可以增加数据库允许的数据库连接数，但这并不是真正的解决方案。如果 SOLR 在索引时建立了很多连接，您网站的其他一些部分可能会开始出现“连接太多”，这是不好的。

实际上 SOLR 完全导入会产生如此多的连接，以至于我最多只能连接 150 个连接。

以下是一些统计数据：1) 我启动了完整的重新索引 2) 几秒钟后：

```
mysql> 显示进程列表；

| 身份证 | 用户 | 主持人 | 分贝 | 命令 | 时间 |
| 158 | xxx | 本地主机：58804 | 年年 | 查询 | 0 |
| 159 | xxx | 本地主机：58810 | 年年 | 睡眠 | 3 |
| 160 | xxx | 本地主机：58811 | 年年 | 睡眠 | 1 |
| 161 | xxx | 本地主机：58812 | 年年 | 睡眠 | 1 |
...
| 255 | xxx | 本地主机：58906 | 年年 | 睡眠 | 0 |
| 256 | xxx | 本地主机：58907 | 年年 | 睡眠 | 0 |
```

3) 导入失败的原因是：

> 引起：com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException：连接太多

我没有找到放置在 solrconfig.xml 中的参数来解决这个问题。顺便说一句，SOLR 版本是 1.3。

非常感谢！

PS只是更多信息：在我看到的日志中：

```
信息：使用 URL 为实体 abc 创建连接：jdbc:mysql://10.0.2.2/xyz
信息：getConnection() 花费的时间：9
```

这会重复数百次，直到达到我的本地最大连接数限制（151）并出错。我不知道为什么 SOLR 为每个实体打开一个新连接。我希望这是可以修复的，因为它看起来不像是正确的行为。有谁知道升级到 1.4 或 4.0 是否可以解决这个问题？

再次感谢！

PPS我也会添加一个猜测。它只为每个实体或子实体打开一个连接：我拥有的结构是一个巨型实体和 160 多个子实体。并且[http://mail-archives.apache.org/mod_mbox/lucene-solr-user/201205.mbox/%3CA1EB2532250E8945BC3E1FA3AE836F6BE1118F18@adonia.local.uship.com%3E](http://mail-archives.apache.org/mod_mbox/lucene-solr-user/201205.mbox/%3CA1EB2532250E8945BC3E1FA3AE836F6BE1118F18@adonia.local.uship.com%3E)说 solr 有一个错误......如果有人知道修复其他然后升级，请告诉。

# c# - 如何将 var 的值从 1 func 转移到另一个？

> ID：13690758
> 
> 赞同：0
> 
> 时间：2012-12-03T20:02:38.330
> 
> 标签：c#

我有 3 个功能：

```
public int ok_join(string gr)
{

        ...................
        string gash = Regex.Match(response, @"gash:""(?<id>[^""]+)""").Groups["id"].Value;
        string groupId = Regex.Match(response, @"state:""smd=(?<id>[^""]+)""").Groups["id"].Value;
       ......................
}

public bool ok_post(string gr)
{
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://www.site.ru/" + gash + "&stoud=" + groupId + "&");
    .........................
 }

public void go()
{
    while (true)
    {
        ........

                int h = ok_join(gr);
                if (h == 0)
                    ok_post(gr);
        .............
     }
} 
```

如何将函数 ok_join 的 gash 和 groupid 值发送到 ok_post？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:17:06.483

全力以赴：`ok_join`返回一个包含您的返回值的完整对象`int`（无论`h`应该代表什么，我猜它是通过/失败？），`gash`然后`groupId`将其传递到`ok_join`：

```
public class JoinResults
{
    public int h { get; private set; }
    public string gash { get; private set; }
    public string groupId { get; private set; }

    public JoinResults(int h, string gash, string groupId)
    {
        this.h = h;
        this.gash = gash;
        this.groupId = groupId;
    }
} 
```

然后您的方法/用法如下所示：

```
public JoinResults ok_join(string gr)
{
        string gash = Regex.Match(response, @"gash:""(?<id>[^""]+)""").Groups["id"].Value;
        string groupId = Regex.Match(response, @"state:""smd=(?<id>[^""]+)""").Groups["id"].Value;

        return new JoinResults(0, gash, groupId);
}

public bool ok_post(JoinResults joinResults, string gr)
{
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://www.site.ru/" + joinResults.gash + "&stoud=" + joinResults.groupId + "&");
}

public void go()
{
    while (true)
    {
        JoinResults results = ok_join(gr);
        if (results.h == 0)
            ok_post(results, gr);
     }
} 
```

尽管我强烈建议您在成员名称、大小写等方面以及该`gr`变量应该是什么方面进行可读性通行证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T20:07:28.683

你可以使用 out 参数

```
public int ok_join(string gr, out string gash, out string groupId) 
{
        ...................
        gash = Regex.Match(response, @"gash:""(?<id>[^""]+)""").Groups["id"].Value;
        groupId = Regex.Match(response, @"state:""smd=(?<id>[^""]+)""").Groups["id"].Value;
       ......................  
}

public bool ok_post(string gr, string gash, string groupId) 
{
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://www.site.ru/" + gash + "&stoud=" + groupId + "&");
    .........................  
}

public void go() 
{
    while (true)
    {
        ........
                string gash;
                string groupId

                int h = ok_join(gr, out gash, out groupId);
                if (h == 0)
                    ok_post(gr, gash, groupId);
        .............
     } 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:24:23.293

这里有两条真正的路径：

1.  这两个变量代表包含这两种方法的对象的“状态”。我们很难知道您是否属于这种情况，因为我们不知道对象是什么，这些变量可能在哪里使用，它们何时过时等等。如果这些变量应该存在于大多数情况下，如果不是全部，那么在它们所在的对象的生命周期中，它们很可能是该对象“状态”的一部分。如果这对您来说是正确的，那么您应该为包含这两种方法的类创建两个私有实例变量，将它们都设置在中`ok_join`，然后将它们读入`ok_post`.
2.  这两个变量*不代表*该对象状态的一部分；您只是想在紧随其后调用的另一个函数中使用某个函数的结果；数据不应超过这两个函数调用。在这种情况下，您希望从第一个函数返回这两个值，并将它们传递给下一个函数。

对于选项#2，有几种方法可以在实践中实际实现它。您遇到的最大障碍是 C#（和大多数编程语言）中的方法只能`return`有一个值，而不是多个值。解决这个问题的一种方法是使用`out`参数，正如juharr 对您的问题[的](https://stackoverflow.com/a/13690837/1159478)另一个答案所示。另一种选择是创建自己的自定义类型，将函数需要返回的所有内容放入该类型，然后将该类型传递给第二个函数。可以这样实现：

```
public class JoinResults
{
    public int H { get; set; }
    public string Gash { get; set; }
    public string GroupId { get; set; }
} 
```

然后你可以调整你的方法看起来像：

```
public JoinResults ok_join(string gr)
{
    string gash = "";
    string groupID = "";
    //...
    return new JoinResults()
    {
        H = 0,
        Gash = gash,
        GroupId = groupID,
    };
}

public bool ok_post(string gr, JoinResults joinResults)
{
    string url = "http://www.site.ru/" + joinResults.Gash + "&stoud="
        + joinResults.GroupId + "&";
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
    //.........................
    return true;
} 
```

然后调用代码将如下所示：

```
JoinResults results = ok_join(gr);
if (results.H == 0)
    ok_post(gr, results); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-03T20:05:36.957

为什么不使用 delcare`gash`和`groupid`as 全局变量？

# javascript - 如何将数据从网页传递到 chrome ext？

> ID：13690759
> 
> 赞同：2
> 
> 时间：2012-12-03T20:02:38.687
> 
> 标签：javascript, google-app-engine, google-chrome-extension

我尝试将 *auth_token* 传递给我的 Chrome 扩展，以便在 GET 请求中进一步使用它。

我认为如果

1.  我们尝试从 $.get('APP/get/user' {auth_token:''}, callback) [在我的 Chrome 扩展中] 获取用户
2.  如果我们得到“not_auth”响应，回调 open auth_page in new tab [in my Chrome extension]
3.  我们登录并重定向到生成 *auth_token* [in my WEB-APP-PAGE] 的页面
4.  将 *auth_token* 传递给我的 Chrome 扩展 ????? 如何？通过 JS？[在我的 WEB-APP-PAGE]

如何实现第 4 段？谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T20:55:54.623

**对apsillers好**

是的，最后，我明白了！在我的 contentscript.js（在我的令牌页面中加载）中获取令牌并将其发送到后台

**内容脚本.js**

```
$(function(){
  //get token from page
  var token = $.getUrlVar('token');
  if (typeof token != 'undefined') {
    chrome.extension.sendMessage({token: token});
  }
}); 
```

**背景.js**

```
/*button handler*/
function main_click() {
  alert(localStorage['auth_token']);
}
chrome.browserAction.onClicked.addListener(main_click);

/*listener*/
chrome.extension.onMessage.addListener(
  function(request, sender, sendResponse) {
    if (request.token)
      localStorage['auth_token'] = request.token;
  }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:57:02.357

我认为`localStorage`页面可以充当页面和扩展之间的桥梁。

在创建**auth_token**的第 3 阶段，将其转储到`localStorage`,

```
<script type="text/javascript">
 ...
 var auth_token = "sfafsafasfsaf";
 localStorage["auth_token"] = auth_token;
 ...
</script> 
```

[并获取内容脚本](http://developer.chrome.com/extensions/content_scripts.html)（content.js）中的 auth_token ，

```
console.log(localStorage["auth_token"]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T21:17:36.620

[关于内容脚本通信](http://developer.chrome.com/extensions/content_scripts.html#host-page-communication)的 Chrome 文档建议[`window.postMessage`](https://developer.mozilla.org/en-US/docs/DOM/window.postMessage)在发送代码（此处为网页）和`window.addEventListener("message", ...)`侦听代码（此处为 Chrome 扩展程序的内容脚本，注入页面）中使用。从技术上讲，任何类型的自定义 DOM 事件也可以做到这一点，但`postMessage`/`message`已经有内置支持。

您应该能够几乎逐字逐句地从代码中提取示例代码：

**原生网页：**

```
// right after we get auth_token saved to a variable...
window.postMessage({ auth_token: auth_token }, "http://www.mypagedomain.com"); 
```

（确保`http://www.mypagedomain.com`更改为您的实际协议/域。）

**contentscript.js**（在 Chrome 扩展中，监听）

```
window.addEventListener("message", function(event) {
    // We only accept messages from ourselves
    if (event.source != window) {
      return;
    }

    console.log("auth_token received: " + event.data.auth_token);
}, false); 
```

如有必要，您可以从事件侦听器内部使用[消息传递将](http://developer.chrome.com/extensions/messaging.html)其传递`auth_token`到您的后台页面。

**编辑：**

你的清单应该包括这样的东西（注意使用`run_at`下面的在页面加载之前注入脚本）：

```
...
"content_scripts": [
  {
    "matches": ["http://www.mypagedomain.com/*"],
    "js": ["contentscript.js"],
    "run_at": "document_start"
  }
],
... 
```

# vst - 离线处理——文件加载，非实时算法

> ID：13690767
> 
> 赞同：4
> 
> 时间：2012-12-03T20:02:58.327
> 
> 标签：vst

我正在实现一种音频算法来将音符与复音录音（如旋律）分开。我的计划是让它成为一个 VST 插件。研究文档，我很难弄清楚我将如何实现非实时任务。所需的任务是加载波形文件并对其进行非实时分析，然后才能对其进行实时循环和操作。应该可以随时加载新文件。

很难找到有关该主题的信息。如果有人有经验并可以给我一个提示：

*   VST可以做到这一点吗？SDK 提供离线处理，但 DAW 似乎不支持它。
*   如果我让我的程序成为一个独立的程序，我如何将它与 VST 主机同步？
*   有谁知道一本好书，详细的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T08:35:08.887

我认为你在考虑离线的东西。:) 这实际上很容易做到，但棘手的部分是制作一个好的 UI 来向用户解释正在发生的事情。如果我是你，我会简单地在一个单独的线程中加载文件，当这个任务运行时，你应该在你的 GUI 中显示一个“正在加载文件...”微调器并在你的`process()`例程中输出静默。这将涉及一些互斥，以确保三个线程（GUI、进程和加载程序）都知道彼此在做什么。

至于制作插件的独立版本，[Juce](http://www.rawmaterialsoftware.com/juce.php)绝对是要走的路。这个可爱的框架还将处理 VST/AU 插件抽象，并允许您导出独立的应用程序。Juce 可能看起来有点贵，但如果你要使用这个插件进行商业化，那么每一分钱都是值得的。如果您不打算商业化，那么您可以只 GPL 您的代码并免费使用它。

如果您更喜欢独立插件的 DIY 路线，您可能可以与[MrsWatson](https://github.com/teragonaudio/MrsWatson/)一起破解一些东西。（*免责声明：我是 MrsWatson 的作者*）。目前，MrsWatson 缺少该项目所需的一些功能，但我计划在未来添加它们，因为这是一个非常常见的用例，我想支持。

至于好的 VST 编程书籍，嗯，我不知道。=/

# c# - OrderByDescending() 无效

> ID：13690770
> 
> 赞同：1
> 
> 时间：2012-12-03T20:03:04.747
> 
> 标签：c#

我有那个课

```
public class jQGridModel
{
    public List<jQGridModelItem> Items { get; set; }

    public class jQGridModelItem
    {
        public DBUser UserItem { get; set; }
        public int ItemsSold { get; set; }
    }
} 
```

和`DBUser`类（由实体框架生成）

```
public class DBUser 
{
    public string UserName { get; set; }
    public string UserID { get; set; }
    public string PromoCode { get; set; }
    ...
} 
```

我有`jQGridModel`一些反对`Items`。这是“简单”的问题 - 我想`Items`根据`UserName`

我试过了

```
jQGridModel result = new jQGridModel();
result.Items = GetItems();

result.Items = result.Items.OrderByDescending(x => x.UserItem.UserName).ToList(); 
```

但我看到收集顺序没有改变。我究竟做错了什么 ？

完整代码：

```
 var query = (from x in db.User
                     where (...)
                     select x);

        var totalRecords = query.Count();

        jQGridModel result = new jQGridModel();

        result.Items = query.OrderBy(x => x.UserID).Skip(page * pageSize)
                            .Take(pageSize)
                            .Select(x => new jQGridModel.jQGridModelItem
                            {
                                UserItem = x,
                                ItemsSold = (from o in db.Order
                                             where
                                                 o.PromoCode.Equals(x.PromoCode)
                                             select o).Count()
                            })
                            .ToList();

  result.Items = result.Items.OrderByDescending(x => x.UserItem.UserName).ToList(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:33:29.717

我应该说它“不返回 IQueryable”，但事实并非如此。因此，您按照获取列表的顺序获取列表，*然后*尝试按（很可能）延迟加载的属性进行排序。所以你并没有真正做你认为你正在做的事情。:)

~~要么将 UserName 作为 jQGridModelItem 的属性，要么如果你真的需要完整的 DBUser 实体，你可以先加载它，然后排序。~~

**编辑**

实际上，只需在初始 orderby 中指定正确的顺序：

```
result.Items = query.OrderBy(x => x.UserName).Skip(page * pageSize)
                            .Take(pageSize)
                            .Select(x => new jQGridModel.jQGridModelItem
                            {
                                UserItem = x,
                                ItemsSold = (from o in db.Order
                                             where
                                                 o.PromoCode.Equals(x.PromoCode)
                                             select o).Count()
                            })
                            .ToList(); 
```

# git - 硬重置后推送到服务器损坏

> ID：13690771
> 
> 赞同：0
> 
> 时间：2012-12-03T20:03:14.637
> 
> 标签：git

我是 git 新手，正在尝试使用[http://danielmiessler.com/study/git/#website](http://danielmiessler.com/study/git/#website)设置 git来管理我的网站。我在win7中使用git gui

我已经让事情正常了，但由于错误的原因最终做了一个 git 硬重置。现在，尽管当我将本地的最新更改推送到我的网站时，IDE 说它有效，但远程服务器上的实际站点没有发生任何更改。

这是一个示例消息：

> ==[IDE]== 2012 年 12 月 3 日下午 2:15:38 推送 git push ssh://****.com/home/*****/site_hub.git +refs/heads/master:refs /heads/master 远程存储库更新分支：master 旧 ID：d8ad488e1d9f8db069cf2f93d289b7****** 新 ID：c51319292573d3d159a628c73ca20844663b72db****** 结果：OK 本地存储库更新无更新

当我转到服务器的文件管理器时，今天似乎没有文件更新。

在硬重置之前它工作正常。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T22:19:58.923

输出告诉您本地存储库中没有服务器中尚未更改的更改。

```
git reset --hard 
```

只会删除您在上次提交和当前状态之间在本地分支中跟踪的更改。

做一个

```
git log 
```

您可能会看到您没有提交的更改。

你也可以试试

```
git push --force <MYREMOTE> <MYBRANCH> 
```

要将服务器分支替换为当前分支，这将覆盖服务器上的任何更改。

# grails - 从 Spock 规范中提取规范

> ID：13690778
> 
> 赞同：3
> 
> 时间：2012-12-03T20:03:43.873
> 
> 标签：grails, spock

有没有办法从我打印在文件中的 Spock 测试中获取规范（过滤代码）？

例如，对于以下规范：

```
class CarSpec extends IntegrationSpec {

    def 'it should not retrieve deleted cars'() {
        given: 'a car'
            def car = new Car(uniqueName: 'carName')
            car.save()
        when: 'I delete the car'
            car.delete()
        then: 'it shouldn't find me the car on the DB'
            Car.find { uniqueName == 'carName' } == null
    }
} 
```

应该打印如下内容：

```
CarSpec
    it should not retrieve deleted cars
        given a car
        when I delete the car
        then it shouldn't find me the car on the DB 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:44:40.097

您可以使用可用的第三方插件之一（例如[https://github.com/damage-control/report](https://github.com/damage-control/report)），或编写自己的 Spock 扩展程序（请参阅[https://github.com/spockframework/smarter-testing- with-spock/tree/master/src/test/groovy/extension/custom](https://github.com/spockframework/smarter-testing-with-spock/tree/master/src/test/groovy/extension/custom)）。

# python - Python 图形用户界面工具

> ID：13690784
> 
> 赞同：-4
> 
> 时间：2012-12-03T20:04:11.783
> 
> 标签：python

我想创建一个 GUI 实用程序，该实用程序可用于根据用户在 GUI 工具中输入的标准从生产环境中的 UNIX 日志中检索信息。但不确定我该怎么做？Perl、Python 或 Java 都可以用来完成这个？

请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:17:16.627

鉴于您问题的性质，我猜您对编程知之甚少（或者至少对您列出的三种语言知之甚少）。由于答案是简单而明显的肯定，所有这三种语言都是通用语言，完全有能力解决你提出的问题。

因此，如果您将此作为一个有趣的项目或学习体验，那么我建议您从简单的开始，例如 Python + [EasyGui](http://easygui.sourceforge.net/index.html)。Python，因为 IMO 比其他两个更容易上手。还有 EasyGui，因为它与我在 Python 中看到的一样简单的 GUI 工具包。

现在，如果您被要求在截止日期前完成此操作，请确保在一周到一个月或更长时间的培训中烘烤，具体取决于您的一般舒适程度，例如安装软件和编程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:07:16.767

有很多用于 Python 编程的 GUI 工具。

[http://wiki.python.org/moin/GuiProgramming](http://wiki.python.org/moin/GuiProgramming)

[http://www.wxpython.org/](http://www.wxpython.org/)

# nhibernate - 魔术字符串导致 nHibernate Profiler 中的错误

> ID：13690785
> 
> 赞同：0
> 
> 时间：2012-12-03T20:04:11.557
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-profiler

我有一个我负责维护的业务应用程序，并且关于在其中创建新评论时不断弹出这个间歇性错误。我终于得到了一个导致它的确切字符串，并且在慢慢地将文本段落缩小到导致它的确切部分之后，我已经将它缩小到了最基本的组件。但除了在各处使用创可贴之外，我没有任何解决办法。我想看看这是否是一个常见问题，并可能得到一些反馈。

我正在使用 Fluent nHibernate (1.3.0.773) 和 nHibernate (3.3.1.400)，我也剥离了我的映射文件，所以请确保这不是因为我可以得到它并且仍然重现错误（并具有功能正常的构建）。这是用于`FluentMappings.ExportTo()`转储配置时的注释结果内容。

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <class xmlns="urn:nhibernate-mapping-2.2" name="Core.Comment, Core, Version=5.0.4720.19853, Culture=neutral, PublicKeyToken=null" table="tblComments">
    <id name="CommentId" type="System.Guid, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
      <column name="CommentId" />
      <generator class="guid.comb" />
    </id>
    <property name="OwnerId" type="System.Guid, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
      <column name="OwnerId" />
    </property>
    <property name="Text" type="System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
      <column name="Description" />
    </property>
  </class>
</hibernate-mapping> 
```

非常简单，但是如果要提交的文本中有一个撇号，然后是单词 update 后跟一个右括号，那么`ArgumentOutOfRangeException`当我尝试提交事务时会出现错误。

以下字符串导致问题

*   Lorem ipsum dolor sit amet, consectetur。（这个不更新）
*   也不更新）
*   '更新）

这些不会导致问题

*   Lorem ipsum dolor sit amet, consectetur。（这确实更新）
*   更新）
*   '更新
*   '更新）

您可以提供的任何见解都会很棒。

**更新：** 我应该提到，当我将 nHibernate Profiler 连接到这个时，没有生成与插入新记录相关的 SQL。所以我假设它来自nHibernate内部的某种逻辑？

**堆栈跟踪**

```
[ArgumentOutOfRangeException: Index was out of range. Must be non-negative and less than the size of the collection.
Parameter name: index]
   System.ThrowHelper.ThrowArgumentOutOfRangeException() +72
   System.Collections.Generic.List`1.get_Item(Int32 index) +34
   NHibernate.AdoNet.Util.FormatProcess.CloseParen() +141
   NHibernate.AdoNet.Util.FormatProcess.Perform() +452
   NHibernate.AdoNet.Util.BasicFormatter.Format(String source) +67
   NHibernate.AdoNet.SqlClientBatchingBatcher.AddToBatch(IExpectation expectation) +310
   NHibernate.Persister.Entity.AbstractEntityPersister.Insert(Object id, Object[] fields, Boolean[] notNull, Int32 j, SqlCommandInfo sql, Object obj, ISessionImplementor session) +914
   NHibernate.Persister.Entity.AbstractEntityPersister.Insert(Object id, Object[] fields, Object obj, ISessionImplementor session) +341
   NHibernate.Action.EntityInsertAction.Execute() +371
   NHibernate.Engine.ActionQueue.Execute(IExecutable executable) +48
   NHibernate.Engine.ActionQueue.ExecuteActions(IList list) +128
   NHibernate.Engine.ActionQueue.ExecuteActions() +35
   NHibernate.Event.Default.AbstractFlushingEventListener.PerformExecutions(IEventSource session) +156
   NHibernate.Event.Default.DefaultFlushEventListener.OnFlush(FlushEvent event) +180
   NHibernate.Impl.SessionImpl.Flush() +295
   NHibernate.Transaction.AdoTransaction.Commit() +189
   Web.Filters.NHibernateActionFilter.OnActionExecuted(ActionExecutedContext filterContext) in c:\Development\[Project Folder]\Web.Controllers\Filters\NHibernateActionFilter.cs:82
   System.Web.Mvc.Async.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49() +354
   System.Web.Mvc.Async.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49() +323
   System.Web.Mvc.Async.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49() +323
   System.Web.Mvc.Async.<>c__DisplayClass37.<BeginInvokeActionMethodWithFilters>b__36(IAsyncResult asyncResult) +44
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +139
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +102
   System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethodWithFilters(IAsyncResult asyncResult) +74
   System.Web.Mvc.Async.<>c__DisplayClass2a.<BeginInvokeAction>b__20() +68
   System.Web.Mvc.Async.<>c__DisplayClass25.<BeginInvokeAction>b__22(IAsyncResult asyncResult) +184
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +136
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +56
   System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeAction(IAsyncResult asyncResult) +66
   System.Web.Mvc.<>c__DisplayClass1d.<BeginExecuteCore>b__18(IAsyncResult asyncResult) +40
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +47
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +151
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +59
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +40
   System.Web.Mvc.Controller.EndExecuteCore(IAsyncResult asyncResult) +68
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +47
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +151
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +59
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +40
   System.Web.Mvc.Controller.EndExecute(IAsyncResult asyncResult) +65
   System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController.EndExecute(IAsyncResult asyncResult) +39
   System.Web.Mvc.<>c__DisplayClass8.<BeginProcessRequest>b__3(IAsyncResult asyncResult) +45
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +47
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +151
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +59
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +40
   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +66
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +38
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +9629708
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +155 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T18:27:31.170

好的，所以我发现了导致它的原因。一旦我从我的项目中删除了 nHibernate Profiler 的初始化，错误就停止发生了。它一定是在执行它之前尝试格式化字符串以进行记录 - 因为它爆炸了，它从来没有真正执行查询。我错了，日志记录应该吞下错误，或者至少不要让它干扰正常操作。

**更新**：使用 nHibernate Profiler 2 时会出现同样的问题，但只要我注释掉`NHibernateProfiler.Initialize()`，问题就会消失。去看看能不能得到开发商的支持。请注意，您实际上不必使用 nHibernate Profiler 附加您的进程，只需初始化分析器就足以导致问题。我试图在 12 月 5 日通过电子邮件联系 nHibernate Profiler 支持，但还没有收到任何回复，所以我不知道这是否已经被查看过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-18T06:53:37.497

由于这是我在网上搜索确切的错误消息时弹出的首要问题之一，我认为这对人们了解我如何修复它会有所帮助。

问题中提到的错误堆栈跟踪实际上是由 NHibernate 的 BasicFormatter 抛出的。在 NHibernate 的 GitHub 存储库中，有一个针对此错误的记录问题。这是链接 - [https://github.com/nhibernate/nhibernate-core/issues/1319](https://github.com/nhibernate/nhibernate-core/issues/1319)。

在撰写此答案时，该错误已在最新的 NHibernate 中得到修复。对于旧版本，例如 3.1.0（我遇到错误时正在使用的版本），在文件中将`format_sql`属性设置为 false可以解决问题。`nhibernate.config`

# android - Android：如何使用 ACCOUNT_SYNC_SETTINGS 意图过滤器操作

> ID：13690788
> 
> 赞同：0
> 
> 时间：2012-12-03T20:04:14.373
> 
> 标签：android, android-intent

我想要一个覆盖我的帐户类型的同步设置的 Android 活动。在清单文件中，我的活动下有一个意图过滤器，如下所示：

```
<intent-filter>
    <action android:name="android.intent.action.MAIN"/>
    <action android:name="android.settings.ACCOUNT_SYNC_SETTINGS"/>
    <category android:name="android.intent.category.DEFAULT"/>
</intent-filter> 
```

但是，如果我在“帐户和同步”设置屏幕中选择任何帐户，我现在会看到“使用完成操作”对话框。我可以做些什么来确保我的活动被自动选择为我的帐户类型，而不是任何其他帐户类型的选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:38:20.157

广播接收器是 Android 的发布/订阅消息模式的实现，更准确地说是观察者模式。应用程序（称为发布者）可以生成广播以简单地发送事件，而不知道谁（如果有的话）会得到它们。想要信息的接收者（称为订阅者）通过过滤器订阅特定消息。如果消息与过滤器匹配，则激活订阅者（如果它尚未运行）并通知消息。

因此，您只能接收广播消息，不能阻止其他应用程序注册相同的消息。

# functional-programming - 创建一个具有可变但固定数量的参数的函数

> ID：13690790
> 
> 赞同：2
> 
> 时间：2012-12-03T20:04:20.127
> 
> 标签：functional-programming, scheme

是否有可能创建一个具有可变但固定数量的参数的函数，即不是可变参数函数？我的意思是这样的。

```
(bind n 42)
(lambda (x_1, x_2, ..., x_n) (do_something x_1 x_2 ... x_3)) 
```

我唯一知道的，它创建具有不同参数计数的新函数，是“咖喱”，但我不知道如何迭代这个原则。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:18:16.247

[`case-lambda`](http://www.r6rs.org/final/html/r6rs-lib/r6rs-lib-Z-H-6.html#node_idx_262)在有它的 Scheme 实现中使用。它也应该适用于所有 r6rs 实现。此外，一些实现有一种方法来定义可选参数，而不是手动调整 rest 参数。

# php - 在不指定键的情况下访问数组键值

> ID：13690793
> 
> 赞同：0
> 
> 时间：2012-12-03T20:04:31.727
> 
> 标签：php, arrays

我有：

```
public $staticRoutes = array(
        'dog-toys' => 'Index',
        ) ;

if(array_key_exists($controller, $this->staticRoutes))
{
    $controller = new $controller ;
} 
```

新的 $controller 正在变成“狗玩具”，这不是我想要的。

我怎样才能改变我所拥有的`$controller = new Index ;`呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:06:10.117

一些变化：

```
$controller = new ${staticRoutes[$controller]} ; 
```

我现在无法测试它，所以为了安全起见，你也可以这样做：

```
$ctrl = $staticRoutes[$controller];
$controller = new $ctrl; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:09:05.967

你需要`$staticRoutes`像这样实际使用你的数组：

```
$controller_instance = new $this->staticRoutes[$controller]; 
```

请注意，为清楚起见，我更改了您分配给的变量的名称。我还假设尝试实例化此控制器的代码`$staticRoutes`位于定义属性的同一类（或继承类）中（因此使用`$this`）。

# android - 如何在 viewpager 中使用 instantiateItem() 来更新页面

> ID：13690794
> 
> 赞同：1
> 
> 时间：2012-12-03T20:04:35.540
> 
> 标签：android, android-fragments, android-viewpager

> **可能重复：**
> [片段更改时如何更新视图？](https://stackoverflow.com/questions/13687280/how-can-i-update-view-when-fragment-change)

有一个在此有 2 个片段的活动 前两个页面显示带有自定义列表视图的片段，这些视图是使用 AsyncTask 从服务器的 xml 构建的。但是，当应用程序运行时，只显示一个列表视图，其他页面只是空白

我可以用这个方法来更新这个寻呼机吗

```
public Object instantiateItem(View container, int position) { 
```

我的适配器代码是

```
public class VpiAbsTestActivity extends SherlockFragmentActivity {

private static final String[] CONTENT = new String[] { "1","2"};

TestFragmentAdapter mAdapter;
 ViewPager mPager;
 PageIndicator mIndicator;

protected void onCreate(Bundle savedInstanceState) {
setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
super.onCreate(savedInstanceState);
setContentView(R.layout.simple_tabs);

mAdapter = new TestFragmentAdapter(getSupportFragmentManager());
mPager = (ViewPager)findViewById(R.id.pager);
mPager.setAdapter(mAdapter);

mIndicator = (TabPageIndicator)findViewById(R.id.indicator);
mIndicator.setViewPager(mPager);
mIndicator.notifyDataSetChanged();
}

class TestFragmentAdapter extends FragmentPagerAdapter {        
private int mCount = CONTENT.length;

public TestFragmentAdapter(FragmentManager fm) {
    super(fm);
}

@Override
public Fragment getItem(int position) {
    switch(position) {

    case 0:
        return new customlist();

    case 1:
        return new customlistnotuser();

    default:
        return null;

    }
}

@Override
public int getCount() {
    return mCount;
}

public CharSequence getPageTitle(int position) {
    return VpiAbsTestActivity.CONTENT[position %             VpiAbsTestActivity.CONTENT.length].toUpperCase();
}

 @Override
    public void destroyItem(View collection, int position, Object view) {
         ((ViewPager) collection).removeView((View) view);
    }

 } 
```

# security - 如何将 Sitecore 语言写入限制为仅内容树的某些部分

> ID：13690804
> 
> 赞同：4
> 
> 时间：2012-12-03T20:05:32.940
> 
> 标签：security, localization, permissions, content-management-system, sitecore

在我们的 Sitecore 实施中，我们有分支编辑，他们需要对英语及其母语（例如德语）的语言写入权限。但是，我们的内容树的某些部分不应由这些分支编辑器编辑英文版本，但母语版本应该。

举一个具体的例子，如果我们有一个产品页面，上面有一些全局信息（例如零件号）和一些可本地化的信息（例如描述字段），我们正在使用字段级安全性来锁定全局（部件号）字段，但需要一种方法来确保德语编辑器可以创建项目的德语版本并放入其翻译的可本地化（描述）文本，但不会无意中切换到和更新英文版本那个描述。

我了解在系统 > 语言中为某些角色设置语言读/写。我们已经涵盖了那部分。我想知道的是，对于具有英语和德语版本的写入权限的假设内容编辑器，是否有一种方法可以有效地完成以下类型的场景：

*   家
    *   第 1 项*（编辑拥有英文和德文版本的写入权限）*
    *   ...子项目 1
    *   ...子项目 2
    *   第 2 项*（编辑只有德语版本的写权限）*
    *   ...子项目 1
    *   ...子项目 2

在此先感谢您的任何建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T00:50:06.583

据我所知，Sitecore 原生的安全模型在这方面存在不足。语言读/写访问不能本地化到内容树的给定部分。也就是说，如果您可以编辑一种语言，那么您可以对您具有写入权限的所有内容项执行此操作。

但是，我认为您可以结合使用 saveUi 管道和 getContentEditorWarnings 管道来满足您的要求。

**保存UI**

在此管道中，您需要一个处理器来检查用户是否应该能够以当前语言编辑给定内容。我将把它留给您如何配置/确定（XML 配置？用户访问内容树分支中特定于语言的项目？），但如果应该拒绝用户访问，您可以阻止节省。

```
public class CheckLanguageWritePermission
    {
        public string WorkflowStateID { get; set; }

        public void Process(SaveArgs args)
        {
            Assert.ArgumentNotNull(args, "args");
            Assert.IsNotNull(args.Items, "args.Items");
            foreach (SaveArgs.SaveItem item in args.Items)
            {
                Item item2 = Sitecore.Client.ContentDatabase.Items[item.ID, item.Language];
                    if (/* user should not have permission*/)
                    {
                        AbortSave(args);
                        return;
                    }
            }
        }

        protected void AbortSave(SaveArgs args)
        {
            if (args.HasSheerUI)
            {
                SheerResponse.Alert("You do not have permission to edit this item in the current language.");
                SheerResponse.SetReturnValue("failed");
            }
            args.AbortPipeline();
        }
    } 
```

**获取内容编辑器警告**

由于您无法阻止用户使用这种方法实际编辑内容（只是保存它），因此您可能应该提供一个警告，说明这一点。

```
public class CheckLanguageWritePermission
{
    // Methods
    public void Process(GetContentEditorWarningsArgs args)
    {
        Item item = args.Item;
        if (/* user should not have permission*/)
        {
            GetContentEditorWarningsArgs.ContentEditorWarning warning = args.Add();
            warning.Title = "You do not have permission to edit this item in the current language.";
            warning.IsExclusive = true;
        }
    }
} 
```

这不是一个完美的解决方案，但它确实可以防止对内容进行不必要的编辑。如果版本控制/工作流程在起作用，您可以通过覆盖 item:addversion 和 item:checkout 的 UI 命令来完全阻止添加新版本。

确定访问权限可能很棘手，最好的方法取决于您的特定业务规则。

# parsing - 解析和查询多行半结构化内容的简单方法

> ID：13690806
> 
> 赞同：5
> 
> 时间：2012-12-03T20:05:43.633
> 
> 标签：parsing, command-line, multiline, structured-data

我偶尔会处理一些文本文件，其中某些部分确实有多个具有相同结构的段落。这是一个例子：

```
Some unrelated preface I'm not interested in... Lorem ipsum dolor sit amet, 
consectetur adipiscing elit. Etiam scelerisque. 
Lorem ipsum dolor sit amet, consectetur adipiscing elit. 
Etiam scelerisque. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam scelerisque. 

001 [SomeTitle 1] - Some Subtitle 1
  Name: SomeName
  Area: SomeArea
  Content: Some multi-line comment...Lorem ipsum dolor sit amet, consectetur 
           adipiscing elit. Etiam scelerisque. Lorem ipsum dolor sit amet, 
           consectetur adipiscing elit. Etiam scelerisque. 

002 [SomeTitle 2] - Some Subtitle 2
  Name: SomeOtherName
  Area: SomeOtherArea
  Content: Some other multi-line comment...Lorem ipsum dolor sit amet, consectetur 
           adipiscing elit. 
```

我正在寻找一种简单的方法来查询这样的文件。例如，如果我查询“Area:SomeOtherArea”，结果应该是具有该区域的文件的所有块。我的意思是所有四个段落：标题、名称、区域、内容。我可以将**grep**与 -A 和 -B 选项一起使用，但问题是内容段落可能包含任意数量的行。这只是这个具体的例子；结构可能完全不同。

我正在寻找一种轻量级、易于适应的解决方案，也许是 CLI 工具的组合。我不想重新发明轮子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T02:46:12.800

抱歉，您只能解决此类问题，因为您似乎想要一把具有无限可扩展功能的瑞士军刀，但您的编程不会有任何痛苦:-)！这样的事情是有可能的，但是鉴于您的广泛开放的规范，回想一下人们花费数年时间构建像 Lucene、Google 和其他数千个搜索引擎来解决这类问题。

也就是说，如果您对具有必须遵守的非常简单规则的搜索工具感到满意，并且您正在使用或可以访问 Unix/Linux/Cygwin 系统，那么以下方法可以工作。

基本规则：将基于空格搜索数据块，例如分隔每个块（如上面的示例数据）。

```
cat paraSearch.ksh

#!/bin/ksh
#  (or #!/bin/bash or likely others)

case $# in 0 ) echo "usage:paraSearch.ksh SearchTargetPattern file2search [file2 ....]" ; exit 1 ;;esac

# read the first pattern as the search target, 
# use quotes on cmd-line if you want to use
# regexp chars like '*'
mySrchPat="$1" ; shift

#dbg set -vx
awk  -v mySrchPattern="$mySrchPat"   \
  'BEGIN{RS=""; ORS="\n\n"}
  #dbg {print "$0="$0; print "----------------------------------------------" }
  $0 ~ mySrchPattern{ print $0}
' "${@}"

chmod 755 paraSearch.ksh 
```

**使用您的示例文本和 searchTarget 和输出进行测试**

```
$ ./paraSearch.ksh SomeName multiLineTest.txt
001 [SomeTitle 1] - Some Subtitle 1
  Name: SomeName
  Area: SomeArea
  Content: Some multi-line comment...Lorem ipsum dolor sit amet, consectetur
           adipiscing elit. Etiam scelerisque. Lorem ipsum dolor sit amet,
           consectetur adipiscing elit. Etiam scelerisque. 
```

要了解有关 awk 的更多信息，请通读（多次）这个出色的教程： [The Grymoire 的 Awk 教程](http://www.grymoire.com/Unix/Awk.html)。

IHTH

# java - Java JFrame 和程序流程

> ID：13690807
> 
> 赞同：3
> 
> 时间：2012-12-03T20:05:47.393
> 
> 标签：java, swing, jframe, exit, flow

当我用 JFrame 创建一个简单的程序时，从 setVisible 方法为真的那一刻起，无论我对框架做什么，程序都不会退出。有人可以解释一下流程吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:07:08.663

当您调用时，`myJFrame.setVisible(true)`您正在创建一个非守护程序 Swing 事件线程，该线程会阻止程序结束，直到该线程和所有非守护程序线程结束。注意，如果您希望程序在 JFrame 关闭时结束，请调用

```
myJFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T20:08:17.890

当 JFrame 打开时，我知道即使 JFrame 不可见，程序也会继续更新它，例如检查它是否再次可见，以及检查屏幕是否需要更新。如果要在 JFrame 关闭时关闭程序，可以使用： `JFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);` 它不会更新检查可见性的线程，它只是在 JFrame 停止可见时停止程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T20:08:50.133

也许你错过了`frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE)`？

`frame`你的框架的名字在哪里。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-04T01:53:08.427

从[`setDefaultCloseOperation(int)`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JFrame.html#setDefaultCloseOperation%28int%29).

> 您必须指定以下选项之一：
> 
> *   `DO_NOTHING_ON_CLOSE`（定义在`WindowConstants`）：什么都不做；要求程序在`windowClosing`注册`WindowListener`对象的方法中处理操作。
> *   `HIDE_ON_CLOSE`(..)：调用任何注册`WindowListener`对象后自动隐藏框架。
> *   **`DISPOSE_ON_CLOSE`(..)：在调用任何注册`WindowListener`对象后自动隐藏和处理框架。**
> *   `EXIT_ON_CLOSE`(..)：使用系统退出方法退出应用程序。仅在应用程序中使用它。

我选择突出显示第三个，因为它通常比上一个更好。这里有两个原因。

1.  多个框架实例可以按顺序打开和处理，如[本例所示](https://stackoverflow.com/a/7143398/418556)。
    ![](../Images/2df12300d0a17e7b750c5283eff2a786.png)
2.  JVM 在关闭最后一帧时不会退出的唯一原因是因为有其他非守护线程正在运行。反过来，这表明它们应该被正确关闭。在这种情况下，'用'杀死虚拟机`System.exit(n)`'并不构成'正确'。

# nginx - nginx - 连接到上游时连接（）失败（111：连接被拒绝）

> ID：13690814
> 
> 赞同：2
> 
> 时间：2012-12-03T20:06:12.807
> 
> 标签：nginx, centos

无法弄清楚为什么我不断收到 502 bad gateway nginx 错误。

这是来自 nginx 错误日志的错误。

```
2012/12/03 19:30:21 [error] 20650#0: *939328 connect() failed (111: Connection refused) while connecting to upstream, client: 70.94.18.35, server: demo.domain.com, request: "GET /assets/js/msgFBmodal.js HTTP/1.1", upstream: "http://108.166.94.94:7080/assets/js/msgFBmodal.js", host: "demo.domain.com", referrer: "http://demo.domain.com/register/user_profile" 
```

我在机架空间云服务器 CentOS 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T05:26:33.293

我遇到了同样的问题，在我的情况下，需要打开防火墙端口。

请检查您的防火墙/可能拒绝连接的机器前面的防火墙。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-15T08:31:14.303

检查您的上游地址是否正确（在您的情况下为 108.166.94.94:7080/assets/js/msgFBmodal.js）。如果一切正常，然后尝试查看从 nginx 到上游的数据包，例如像这样

```
sudo ngrep -q -d eth0 -W byline port 7080 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-03T19:01:57.913

我也遇到了同样的问题，这是因为我没有在我的 nginx 服务器上安装 php

通过安装 php-fpm 这个问题完全解决了。它和 php fastcgi 一样，但有很多配置选项和优势

[你可以在这里](http://php-fpm.org/)了解更多关于 php-fpm 的信息！

或者你可以关注这个[问题](https://stackoverflow.com/questions/21524373/nginx-connect-failed-111-connection-refused-while-connecting-to-upstream)！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-09T11:05:20.803

我正在关注关于 uwsgi 和 nginx 的教程，但我一直收到同样的消息和失败，但我的问题是因为我认为设置的初始起始目录不是由于不再工作的配置选项，而我的 unix 套接字正在放入（或试图放入） / 目录。当我将套接字的完整路径放在 .ini 配置文件中时，它工作正常。是的，那是一个我永远不会回来的夜晚：D

像这样 [uwsgi] .... socket = /var/www/stage/deeznts.sock

# css - 更改 Fancybox2 iframe css 内联

> ID：13690817
> 
> 赞同：0
> 
> 时间：2012-12-03T20:06:21.107
> 
> 标签：css, iframe, inline, fancybox-2

我有几种情况需要更改 Fancybox iframe 内联的 css，但我无法弄清楚如何做到这一点。

* * *

**编辑 - 部分成功** 更改函数内的选项会更改 iframe 的高度、宽度和填充，但是 wrapCSS 无法使用，因此我无法调整字体颜色或大小。我也无法将它与下面列出的其他方法结合使用。

```
parent.$.fancybox({
content: "Thank you for creating an account",
         type : 'iframe',
 padding : 50,
         width: 50,
         height:50,   
}); 
```

* * *

我尝试过的其他方法：

1.  分配班级
2.  在 javascript 中设置 css - $(this).css({...})
3.  在脚本中设置 iframe css - $("#customer_info").css({...});
4.  添加一个类到fancybox-wrap - $('.fancybox-wrap').addClass('thank_you');

方法 #3（在脚本中设置 iframe 的 css）成功更改 iframe 内容的 css，但不会更改 iframe 容器的 css。

我需要这样做的一个例子是，当客户提交表单并且显示的成功消息需要不同的布局（最重要的是 iframe 的高度和宽度）时。

```
success: function () {                           
   $("#customer_info").fadeOut("fast", function(){
   $(this).before("Thank you for creating an account");
   setTimeout("$.fancybox.close()", 1000);
   });                         
} 
```

我正在使用 Fancybox2，其他布局问题需要我设置此内联，而不是允许 iframe 调整大小以适应内容（除非有一种方法可以仅在一个地方覆盖它而不为任何其他内容调整 iframe 的大小显示）

我在另一篇文章中遇到了这个脚本，如果我能找出将它插入我的代码的正确方法，我相信它应该可以工作。

```
$('.fancybox-inner').height($(this).contents().find('body').height()+30); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:14:28.937

您必须更新两个 css 类。.fancybox-inner 调整内容大小， .fancybox-skin 调整皮肤大小。

```
$('.fancybox-iframe').contents().find('body').replaceWith('<body>Thank you</body>')
$('.fancybox-inner').css('width', 200);
$('.fancybox-skin').css('width', 200); 
```

你也可以使用

```
$.fancybox.update() 
```

但这只会将 FancyBox 高度更新为内容的高度。

您最好和最干净的选择就是打开一个带有感谢信息的新花式框。

# javascript - 寻求 SLOW 加密/解密方法或库

> ID：13690820
> 
> 赞同：0
> 
> 时间：2012-12-03T20:06:30.127
> 
> 标签：javascript, encryption

我正在尝试保护用户在一系列记事卡上提交的数据。加密/解密将（希望）发生在浏览器中，因此用户可以控制尽可能多的安全过程。

我发现了一个很棒的 AES 库（https://github.com/mdp/gibberish-aes）。不幸的是，我依靠用户来创建加密密钥，所以我想要一个慢得多的算法。有很多散列库（比如 PHP 的 PHPPass），但我需要一些双向的东西。

我也对其他想法持开放态度。我只需要找到解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:23:12.517

您将加密算法与[密钥派生](http://en.wikipedia.org/wiki/Key_derivation_function)混合在一起。您不希望您的加密算法变慢，因为 AES 不存在使用适当密钥进行暴力破解的风险。

大概既然您说“用户创建加密密钥”，您的意思是这是一种使用密码作为密钥的方案？[PBKDF2](http://en.wikipedia.org/wiki/PBKDF2)是推荐的方法，并[在 SP800-132 中获得 NIST 的批准](http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf)

既然你有这个标记的 Javascript，它看起来像[crypto-js](http://code.google.com/p/crypto-js/#PBKDF2)支持 PBKDF2

当您从用户那里获得密码/密码时，您需要生成一个 salt 并从 PBKDF2 派生实际的 AES 密钥。它不需要是双向的，因为相同的输入（密码、盐和轮数）将始终生成相同的密钥。

请注意，即使这也不是一个设计合理的密码系统。您不应该在没有[CBC 或 CTR mode](http://code.google.com/p/crypto-js/#Block_Modes_and_Padding)的情况下使用 AES ，并且您仍然需要对您的数据进行 MAC 处理（或使用[GCM](http://en.wikipedia.org/wiki/Galois/Counter_Mode)，这两者都会处理）。

# c# - 针对特定的 .NET 框架

> ID：13690821
> 
> 赞同：0
> 
> 时间：2012-12-03T20:06:31.510
> 
> 标签：c#, .net, windows, visual-studio

正如我们所知，在 Visual Studio for C# 项目中，我们可以指定我们想要定位的 .NET 框架。这是我在目标 .NET 4.0 时得到的 app.config 文件：

```
<configuration><startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/></startup></configuration> 
```

所以那里有sku属性。这是否意味着我的代码无法在安装了 .NET 4.5 且未安装 .NET 4.0 的机器上运行。我从 MSDN 中发现它令人困惑，我想对此进行一些澄清。如果是这样，我会说这是相当糟糕的设计。如果我希望我的代码在任何 .NET 版本的 .NET 4.0 及更高版本（例如 .NET 4.5）上运行怎么办？我无法为不同的环境分发不同的 app.config。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:12:56.637

当您以 .Net 版本为目标时，您正在设置运行项目所需的**最低版本。**您还限制自己使用该版本中可用的 .Net 框架元素进行编码。

在我的公司，我们必须将 .Net v2.0 用于我们想要推送给所有客户的一些项目，因为他们有旧硬件，这些硬件要么不能运行，要么不能运行更高版本的 .Net。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T20:08:59.043

检查这个帖子，它解释得很好：

[http://www.hanselman.com/blog/NETVersioningAndMultiTargetingNET45IsAnInplaceUpgradeToNET40.aspx](http://www.hanselman.com/blog/NETVersioningAndMultiTargetingNET45IsAnInplaceUpgradeToNET40.aspx)

**摘自源码：**

> 为 .NET 4 和 .NET 4.5 安全开发
> 
> 博客中暗示，如果您在计算机上安装 .NET 4.5，则无法安全地为 .NET 4 开发。在 Rick 的帖子中，他比较了 .NET 4 计算机上的两个 DLL，并在 .NET 4.5 到位后再次比较升级。如果您已安装 .NET 4.5，如何安全地针对 .NET 4？您不再拥有那些 .NET 4 DLL，对吧？

# java - Java - 强制实例化类

> ID：13690822
> 
> 赞同：1
> 
> 时间：2012-12-03T20:06:38.583
> 
> 标签：java, reflection, deserialization

当我尝试从我的自定义反序列化器运行以下代码时，我不断收到错误“InstantiationException”：

```
String attr = nel.getAttribute("class");
//happens when attr = "java.awt.Color"
if (attr != null && !attr.isEmpty()){
    Object no = Class.forName(attr).newInstance(); <--- dies here
    readObject(nel, no, true);
    field.set(obj,  no);
} 
```

奇怪的是，它曾一度起作用，而现在却不起作用。

如何强制 newInstance 然后稍后在该对象中设置字段（哪个 readObject 是我自己的函数）？

这是一些调试信息：

```
java.lang.InstantiationException: java.awt.Color
at java.lang.Class.newInstance0(Class.java:357)
at java.lang.Class.newInstance(Class.java:325)
at wms.lsw.tool.CustomXMLDecoder.readObject(CustomXMLDecoder.java:240)
at wms.lsw.tool.CustomXMLDecoder.decode(CustomXMLDecoder.java:92)
at wms.lsw.tool.Utils.openProject(Utils.java:716)
at wms.lsw.tool.SecondaryMenuBar$2.actionPerformed(SecondaryMenuBar.java:52)
at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018)
at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2341)
at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:402)
at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:252)
at java.awt.AWTEventMulticaster.mouseReleased(AWTEventMulticaster.java:289)
at java.awt.Component.processMouseEvent(Component.java:6505)
at javax.swing.JComponent.processMouseEvent(JComponent.java:3321)
at java.awt.Component.processEvent(Component.java:6270)
at java.awt.Container.processEvent(Container.java:2229)
at java.awt.Component.dispatchEventImpl(Component.java:4861)
at java.awt.Container.dispatchEventImpl(Container.java:2287)
at java.awt.Component.dispatchEvent(Component.java:4687)
at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4832)
at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4492)
at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4422)
at java.awt.Container.dispatchEventImpl(Container.java:2273)
at java.awt.Window.dispatchEventImpl(Window.java:2719)
at java.awt.Component.dispatchEvent(Component.java:4687)
at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:723)
at java.awt.EventQueue.access$200(EventQueue.java:103)
at java.awt.EventQueue$3.run(EventQueue.java:682)
at java.awt.EventQueue$3.run(EventQueue.java:680)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87)
at java.awt.EventQueue$4.run(EventQueue.java:696)
at java.awt.EventQueue$4.run(EventQueue.java:694)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
at java.awt.EventQueue.dispatchEvent(EventQueue.java:693)
at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:244)
at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:163)
at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:151)
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:147)
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:139)
at java.awt.EventDispatchThread.run(EventDispatchThread.java:97) 
```

**更新 1**

好的，由于类 Color 需要参数，如果一个类自动需要参数，我如何将默认的东西传递给一个类？或者是否可以注入默认构造函数？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-03T20:09:24.847

[`newInstance()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#newInstance%28%29)需要一个无参数的构造函数，并且[`Color`](http://docs.oracle.com/javase/7/docs/api/java/awt/Color.html)没有这样的构造函数。

你需要找到一个合适的[`Constructor`](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Constructor.html)，并使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T20:09:11.350

**原因之一**应该是您尝试调用静态方法并且不需要调用`newInstance()`.

例如：

```
....
Class<?> c = Class.forName(attr);
Class[] argTypes = new Class[] { String[].class };
Method main = c.getDeclaredMethod("main", argTypes);
String[] mainArgs = Arrays.copyOfRange(args, 1, args.length);

main.invoke(null, (Object)mainArgs);
.... 
```

**其他原因**，您没有将参数传递给构造函数（验证您是否有默认值）

对于参数使用：

```
 MyClass c = MyClass .class.getConstructor(String.class).newInstance("some string"); 
```

# azure - 连接到 SQL Azure 时出错

> ID：13690826
> 
> 赞同：1
> 
> 时间：2012-12-03T20:06:49.837
> 
> 标签：azure, azure-sql-database

我得到一个“无法建立连接”。当我点击右下角的设计时（见提供的图片）。我一直在寻找地狱，但无法弄清楚。这三个数据库都是一样的。使用使用它们的应用程序似乎可以正常工作（但我想检查的一件事除外）。任何想法甚至更好的答案:)？ ![在此处输入图像描述](../Images/d613f246f4b1fa941d3c1cf43a550775.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T03:49:00.810

您正在使用的 PC 是否已添加到数据库服务器的防火墙列表中？这是最常见的原因。如果您所指的“应用程序”是 Azure 应用程序，那么您将不会遇到问题，因为 azure 基础架构位于防火墙内。

如果您的 IP 一直在变化，您将不得不重复此操作（或打开一系列 IP）。

如果不确定，请转到 Azure 门户，选择“SQL 数据库”，然后选择“服务器”选项，然后选择底部的“管理”按钮。如果您的 IP 不在防火墙规则集中，您将收到如下所示的消息 [对不起 - 没有图像 - 显然我是新用户，不能提供帮助]。选择对勾，你就可以走了。

菲尔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T21:53:13.403

上面的屏幕可以从订阅帐户访问，我必须使用 Azure SQL 帐户登录才能工作。我什至不知道它存在，但 Azure Microsoft 支持在几封电子邮件后找到了解决方案。我必须说很棒的支持服务！

# ruby-on-rails - 使用按钮/链接将固定值传递给字段

> ID：13690829
> 
> 赞同：0
> 
> 时间：2012-12-03T20:07:03.053
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

如何使用 Rails 中的按钮或链接将对象的字段设置为固定值？看起来这应该是一个相当基本的程序，但我并没有成功。一个示例是将产品模型的 parent_id 设置为 nil（[通过 Rails 中的 link_to 相关的早期问题 Update field](https://stackoverflow.com/questions/13687085/update-field-through-link-to-in-rails)）。我设法通过将文本字段留空来通过表单实现这一点：

```
<%= form_for @product do |f| %>    
    <%= f.label :parent_id %>
    <%= f.text_field :parent_id %>
    <%= f.submit "Update", class: "btn" %>  
<% end %> 
```

但是没有文本字段怎么能做到这一点，只需使用一个按钮，以便在按下按钮时将 parent_id 设置为 nil 呢？我也尝试将 parent_id 设置在隐藏字段中，但这不起作用。

```
<%= form_for @product do |f| %>
   <%= f.hidden_field parent_id: nil %>
   <%= f.submit "Remove", class: "btn" %>
<% end %> 
```

对于编辑/更新操作，控制器看起来像这样。

**products_controller.rb**

```
def edit
   @product = Product.find_by_id(params[:id])    
end

def update
  if @product.update_attributes(params[:product])
    flash[:success] = "Product updated"
    redirect_to @product
  else
    render 'edit'
  end
end 
```

**编辑**

有关如何使用 link_to 而不是表单来执行此操作，请参阅[Rails 中的通过 link_to 更新字段。](https://stackoverflow.com/questions/13687085/update-field-through-link-to-in-rails)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:25:18.770

尝试

```
<%= f.hidden_field :parent_id, value: nil %> 
```

代替

```
<%= f.hidden_field parent_id: nil %> 
```

并确保`parent_id`在`attr_accessible`模型列表中。

# javascript - jQuery 代理函数和事件

> ID：13690834
> 
> 赞同：1
> 
> 时间：2012-12-03T20:07:17.340
> 
> 标签：javascript, jquery

看看我制作的以下jquery插件：

```
(function($) {

    //
    // Constructor.
    //

    var Tb = function(element, options) {
        var self = this;

        this.options = options;
        this.$element = $(element);
        this.$input = $(element).find('.tb-input');
        this.$label = $(element).find('.tb-label');

        this.$element
            .proxy('click', this.$input.click)
            .proxy('val', this.$input.val);
    };

    Tb.prototype = {
        constructor: Tb
    };

  //
    // jQuery plugin.
    //

    $.fn.tb = function(option) {
        return this.each(function() {
            var $this = $(this)
                , data = $this.data('tb')
                , options = $.extend({}, $.fn.tb.defaults, $this.data(), typeof option == 'object' && option);

            if (!data) {
                $this.data('tb', (data = new Tb(this, options)));
            }

            if (typeof(option) == 'string') {
                data[option]();
            }
        });
    };

    $.fn.tb.defaults = {};
    $.fn.tb.Constructor = Tb;

})(window.jQuery); 
```

HTML（演示）

```
<div id="tb-user-name" class="tb">
    <label class="tb-label">This is the placeholder</label>
    <input type="text" class="tb-input" />
</div> 
```

javascript初始化：

```
$('#tb-user-name').tb(); 
```

所以基本上如果我这样做：

```
$('#tb-user-name').val(); // Should return the value of the input not the "container".
$('#tb-user-name').focus(); // Should focus on the input, not the "container" 
```

但是我的代码不起作用，我该怎么做？我已经尝试过“on”，但这也不起作用，确实可以通过一些工作来专注于焦点，但“val”不是一个事件而是一个函数。

***更新（工作但很老套）***

[http://jsfiddle.net/tppiotrowski/WSdmL/3/](http://jsfiddle.net/tppiotrowski/WSdmL/3/)

感谢@teddybeard 提供此解决方案，但这不是最好的方法，因为这有点骇人听闻，而且由于在每个关键事件上都会触发 val 事件，所以我正在寻找一种替代方法，如果有人可以帮助我的话惊人的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T03:51:42.733

看看这个小提琴：http: [//jsfiddle.net/tppiotrowski/WSdmL/3/](http://jsfiddle.net/tppiotrowski/WSdmL/3/)

您尝试做的是在特定元素上使用 jQuery 时覆盖默认值`focus()`和行为。`val()`下面，我重写了`val()`and`focus()`函数，使其在被具有 class 的元素调用时具有特殊行为`.tb`：

```
(function($) {
    var originalVal = $.fn.val;
    $.fn.val = function(value) {
        var self = this;
        if (this.hasClass('tb')) self = this.find('.tb-input').first();
        if (typeof value == 'undefined') {
            return originalVal.call(self);
        } else {
            return originalVal.call(self, value);
        }
    };
    var originalFocus = $.fn.focus;
    $.fn.focus = function(value) {
        var self = this;
        if (this.hasClass('tb')) self = this.find('.tb-input').first();
        if (typeof value == 'undefined') {
            return originalFocus.call(self);
        } else {
            return originalFocus.call(self, value);
        }
    };
})(jQuery); 
```

# ruby-on-rails - Rails 没有通过 rake 脚本向 DB 添加新模型，不知道为什么

> ID：13690835
> 
> 赞同：0
> 
> 时间：2012-12-03T20:07:23.810
> 
> 标签：ruby-on-rails, ruby, sqlite, nokogiri, mechanize

Rake 脚本

```
desc "Update departments and classes listing"
task :update_classes => :environment do 
require 'rubygems'
require 'mechanize'
require 'nokogiri'
def getSubject(agent, subject)
  #subj_form.field_with(:name=>"SUBJ").options.first.unselect

  page_form = agent.get('https://was.nd.edu/reg/srch/ClassSearchServlet').form()
  select = page_form.field_with(:name => "SUBJ")

  select.select_none()

  pp subject

  #pp select.
  select.options_with(:value => "#{subject}").each do |field|
    field.select
  end

  response = agent.submit(page_form)
  #pp page.body
  results = response.body

  pp "Response submitted succesfully!"

  doc = Nokogiri::HTML(results, 'UTF-8')

  pp "Passed the doc"
  parseHTML(doc, subject)
end

def parseHTML(doc, subject)
  #Find nodes by XPATH
  pp "Enter the parseHTML function"
  rows = doc.xpath('//table[@id="resulttable"]/tbody/tr')

  pp "Trying to find department by key . . . "

  #@department = Department.where(:key => subject)

  pp "Success!"

  #cells = rows.css('td')
  details = rows.collect do |row|
          detail = {}
          [
              [:subject, subject],
                  [:course, 'td[1]/a[1]'],
                  [:section, 'td[1]/a[1]'],
                  [:title, 'td[2]'],
                  [:credits, 'td[3]'],
                  [:status, 'td[4]'],
                  [:max_spots, 'td[5]'],
                  [:open_spots, 'td[6]'],
                  [:xlst, 'td[7]'],
                  [:crn, 'td[8]'],
                  [:syl, 'td[9]'],
                  [:instructor, 'td[10]/a'],
                  [:when, 'td[11]'],
                  [:begin, 'td[12]'],
                  [:end, 'td[13]'],
                  [:location, 'td[14]'],
          ].each do |name, xpath|
              # Want to loop through each cell/detail, then perform actions accordingly
              if name == :course
                    detail[name] = row.xpath(xpath).text.strip.split('-').first.strip
                    #pp detail[name]
                elsif name == :section
                    detail[name] = row.xpath(xpath).text.strip.split('-').last.strip
                    #pp detail[name]
                  elsif name == :subject
                    detail[name] = subject
                else
                    detail[name] = row.xpath(xpath).text.strip
                    #pp detail[name]              
              end         
          end
          detail
  end

  #pp details
  # Let's build our Courses array!

  prev = ''
  #c = Course.new(nil, nil, nil)
  details.each do |d|
    #temp = Course.new(d[:title], d[:course], d[:credits])

    #pp prev
    #unless @courses.empty?

    #Check if the course number already exists in the array
    if d[:course] == prev
        #loc = @courses.find_index{|course| course.name == d[:title]}

      #@course = Course.where(:coursenum => d[:course]).first
     # s = Section.new(d[:section], d[:open_spots], d[:max_spots], d[:crn], d[:instructor], d[:when], d[:location])
      #c.add(s)
      #@section = Section.new(:num => d[:section], :opspots => d[:open_spots], :maxspots => d[:max_spots], :crn => d[:crn], :instructor => d[:instructor], :time => d[:when], :location => d[:location])

      @section = @course.sections.new(:num => d[:section], :opspots => d[:open_spots], :maxspots => d[:max_spots], :crn => d[:crn], :instructor => d[:instructor], :time => d[:when], :location => d[:location])
      @section.save
      @course.save
      @dept.save
      #@department.save
    else
      #c = Course.new( d[:title], d[:course], d[:credits])
      #s = Section.new(d[:section], d[:open_spots], d[:max_spots], d[:crn], d[:instructor], d[:when], d[:location])
      ##c.add(s)
      #add(c)

      #@course = Course.new( :name => d[:title], :coursenum => d[:course], :credit => d[:credits])
      #@dept.save
      @course = @dept.courses.new(:name => d[:title], :coursenum => d[:course], :credit => d[:credits])
      #@course.sections.build(:course_id => @course.id)
      #@section = Section.new(:num => d[:section], :opspots => d[:open_spots], :maxspots => d[:max_spots], :crn => d[:crn], :instructor => d[:instructor], :time => d[:when], :location => d[:location])
      #@section.save
      @section = @course.sections.new(:num => d[:section], :opspots => d[:open_spots], :maxspots => d[:max_spots], :crn => d[:crn], :instructor => d[:instructor], :time => d[:when], :location => d[:location])
      @section.save
      #@course.save
      @course.save
      @dept.save

    end

    unless d[:course] == nil
      prev = d[:course]
    end

  end
  #exportHash(subject, @courses)

  #@courses.each do |co|
  # pp co
  #end
end

#def exportHash(subject, courselist)
 # File.open("courses/#{subject}.yml", File::WRONLY|File::CREAT) do |file|
  #  file.write courselist.to_yaml
  #end
#end
#end

a = Mechanize.new
page = a.get('https://was.nd.edu/reg/srch/ClassSearchServlet')

subj_form = page.form()

options = subj_form.field_with(:name=>"SUBJ").options

options.each { |op|
  @dept = Department.new(:deptname => op.text.strip, :key => op.value.strip)
  @dept.save

  getSubject(a, op)
  #pp op.text.strip
  #getSubject(a, op)
}
end 
```

所有模型、部门、课程和部分。

```
class Course < ActiveRecord::Base
  belongs_to :department
  attr_accessor :department_id
  attr_accessible :coursenum, :credit, :name, :course_id, :department

  validates :coursenum, :presence => true, :uniqueness => true
  validates :credit, :presence => true
  validates :name, :presence => true

  has_many :sections, :autosave => true
  accepts_nested_attributes_for :sections

end

class Department < ActiveRecord::Base
  attr_accessible :deptname, :key

  validates :key, :presence => true, :uniqueness => true
  validates :deptname, :presence => true, :uniqueness => true

  has_many :courses, :autosave => true
  accepts_nested_attributes_for :courses

end

class Section < ActiveRecord::Base
  attr_accessible :crn, :instructor, :location, :maxspots, :num, :opspots, :time

  validates :crn, :presence => true, :uniqueness => true
  validates :instructor, :presence => true
  validates :location, :presence => true
  validates :maxspots, :presence => true
  validates :num, :presence => true
  validates :opspots, :presence => true
  validates :time, :presence => true

  belongs_to :course
  attr_accessor :course_id

  #validates :num, :presence => true, :uniqueness => true
end 
```

没有抛出错误，但我不知道为什么它不存储数据。正如代码所示，我正在使用 Mechanize/Nokogiri 来解析一个 HTML 页面，该页面是一个表单自动化的类和部分，但它似乎没有将新课程存储在正确的部门中，如果有的话。. . 我已经坚持了好几个小时，这让我发疯。

# vb.net - 以 Windows 7 和 Windows XP 的管理员身份运行程序

> ID：13690836
> 
> 赞同：0
> 
> 时间：2012-12-03T20:07:24.577
> 
> 标签：vb.net

现在我知道您可以执行以下代码以使其在 Windows 7 中以管理员身份运行。

```
 Dim myProcess2 As New System.Diagnostics.Process()
            Dim startInfo2 As New ProcessStartInfo
            startInfo2.FileName = Application.StartupPath & "\installs\Assistant\RegisterSureFire.exe"
            startInfo2.Verb = "runas"
            myProcess2.StartInfo = startInfo2
            Application.DoEvents()
            myProcess2.Start() 
```

但是当您在 Windows XP 中执行此操作时，会出现该框，询问您是否要在当前用户或管理员中运行它。然后通常我的客户会感到困惑并给我们打电话，等等等等......有没有办法让它检测到 Windows 版本，如果它低于 Windows Vista，那么不要使用“runas”？

或者任何其他有用的方法也会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:09:39.753

您正在寻找[`Environment.OSVersion`物业](http://msdn.microsoft.com/en-us/library/system.environment.osversion.aspx)。

# biztalk - 如何为双向接收端口制作文件接收位置？

> ID：13690839
> 
> 赞同：0
> 
> 时间：2012-12-03T20:07:50.543
> 
> 标签：biztalk, biztalk-2010

我有一个双向接收端口，接收位置设置为使用 MLLP。一切都绑定到接收端口，所以我想创建一个额外的接收位置，我可以使用它来手动将文件放入其中，这样它们就会被发送端口和编排处理，就像数据可以通过 MLLP 进入一样。即，没有

有什么方法可以做到这一点，而无需更新发送端口和编排以绑定到另一个接收端口？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T23:37:59.573

FILE 适配器不能用于双向接收端口。早在 2010 年的 MSDN 论坛上就有关于这个问题的讨论（询问原因并建议微软让这成为可能）：http: [//social.msdn.microsoft.com/forums/en-us/biztalkgeneral/thread/A61EEE82- 703A-4D74-AAA9-63467C42DD86](http://social.msdn.microsoft.com/forums/en-us/biztalkgeneral/thread/A61EEE82-703A-4D74-AAA9-63467C42DD86)

# node.js - 你能在 Node.JS Express 应用程序中插入中间件吗

> ID：13690840
> 
> 赞同：7
> 
> 时间：2012-12-03T20:07:54.253
> 
> 标签：node.js, express

有没有办法在 Express 堆栈中注入中间件？我的意思是我想让我的 app.js 设置主中间件链，然后调用传递应用程序实例的其他模块，他们可能想要插入更多中间件（例如，想要在正确位置添加护照的身份验证模块)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-03T20:56:39.110

您当然可以将您的`app`对象传递给其他模块并`use`在那里调用。当然，中间件函数是**按照它们添加的顺序**执行的，所以你必须非常小心，确保你`use`以正确的顺序调用。

应用程序.js

```
var app = express();
// ...

app.use(express.logger()); // first middleware function

var someOtherModule = require('./mod.js');
someOtherModule.init(app);

app.use(express.static()); // last middleware function) 
```

mod.js

```
exports.init = function(app) {
    app.use(function(req, res, next) {

    });
}; 
```

* * *

至于实际在堆栈中间*注入*中间件函数（在您已经`app.use`使用一组中间件函数调用之后），没有记录的方法可以做到这一点。 `use`只将一个函数添加到堆栈的末尾。

`use`实际上是由[proto.js](https://github.com/senchalabs/connect/blob/2.7.0/lib/proto.js#L62-93)中的 Connect 提供的：

```
app.use = function(route, fn){

  ...

  this.stack.push({ route: route, handle: fn });

  return this;
}; 
```

*从技术上讲*，你可以摆弄`app.stack`自己，但**我不会这样做**。你会弄乱一个未记录的实现细节，这很可能会改变。换句话说，未来对Connect 或 Express 的更新可能会破坏您的应用程序*。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:22:18.780

您可以使用 app.use(fn) 或像这样堆叠它们：

```
app.get('/foo', fn1, fn2, fn3); 
```

签名必须始终相同并调用 next();

```
function(req, res, next) {
  next();
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-03T20:36:45.580

我不明白这是什么问题？

您可以在中间件中添加任何功能：

```
app.use(function(req,res,next){
   //some munipulation with req and res
   next()
}) 
```

你可以把它发送`app`到你的模块中

# ajax - 使用 aspupload 上传 Ajax 文件

> ID：13690843
> 
> 赞同：0
> 
> 时间：2012-12-03T20:08:07.070
> 
> 标签：ajax, asp-classic

我已经阅读了我能找到的所有内容。是的，我还在使用经典的 asp

我试图弄清楚如何使用 aspupload 组件但使用 ajax 将文件上传到服务器。

我得到了很多 php 示例 .net 和客户端，它们并没有真正做任何事情

那么如何通过类获取输入内容呢？因为我将在页面中有多个上传者：`$(".file").val()`不是这样，那是什么？

我不介意在任何形式上使用 ajax。我知道我可以拥有`<form target=iframe></form><iframe name=iframe></iframe>`但不确定我想要页面上有很多 iframe

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T00:02:52.170

it's complicated, check [jQuery File Upload Plugin](https://github.com/blueimp/jQuery-File-Upload) By BlueImp, it's a nice component to upload files support Ajax, Iframe's etc .... there is a Asp-Classic example that comes with the download file, check if adecuates to your needs.

# mysql - Rails 表单未写入数据库

> ID：13690844
> 
> 赞同：0
> 
> 时间：2012-12-03T20:08:08.493
> 
> 标签：mysql, ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我在将新添加的列中的信息写入我的 mysql 数据库时遇到问题。特别是“site_email”。当我在本地运行项目时，我*可以*使用我的新列内容写入数据库，它会出现在随后的显示页面上。

但是在开发服务器上我不能。开发服务器日志显示请求中发送的内容。

```
Started PUT "/sites/18" for x.x.139.147 at 2012-12-03 19:47:39 +0000
      Processing by SitesController#update as HTML
      Parameters: {"utf8"=>"✓", "authenticity_token"=>"6QXzdALrXqXoQz+Q5SFXd+egNQGxOAdNIC8ZH9A9yqU=", "site"=>{"customer_id"=>"1", "site_name"=>"Demohello", "site_domain"=>"Demo", "site_email"=>"test@email.comhello", "google_analytics_code"=>"", "visible"=>"1", "mobile_visible"=>"1", "logo_cache"=>"", "background_logo_cache"=>"", "header_cache"=>"", "background_cache"=>"", "campaign_wrapbar_cache"=>""}, "commit"=>"Update Site", "id"=>"18"}
    Redirected to http://x.com/sites/18
    Completed 302 Found in 17ms 
```

但是当它进入显示页面时，新的/更新的电子邮件数据不存在。奇怪的是，如果我将任何数据添加到预先存在的列以及其他数据已成功发送到数据库但电子邮件不是。

索引显示和编辑页面都显示没有错误，如果我手动更改数据库中的信息，它会显示在显示页面上。在发送请求数据并且页面没有产生错误时，我什至无法调试它。

从 /var/www/sitename/current 我跑

```
bundle exec rake db:migrate 
```

使用 SequelPro 连接到开发数据库我可以看到该列看起来在那里，并且实际上如果我在 site_email 列中插入一个值，数据就会出现在显示页面上。

D B

[http://i.imgur.com/QwAfC.png](http://i.imgur.com/QwAfC.png)

显示插入值的页面

[http://i.imgur.com/Sn7ws.png](http://i.imgur.com/Sn7ws.png)

_form.html.erb

```
<%= form_for(@site) do |f| %>
  <% if @site.errors.any? %>
  <div id="error_explanation">
    <h2><%= pluralize(@site.errors.count, "error") %> prohibited this site from being saved:</h2>

    <ul>
      <% @site.errors.full_messages.each do |msg| %>
      <li><%= msg %></li>
      <% end %>
    </ul>
  </div>
  <% end %>

  <div class="field">
    <%= f.label :customer_id %><br />
    <%#= f.text_field :customer %>
    <%= f.collection_select(:customer_id, Customer.all , :id , :customer_name ) %>

  </div>
  <div class="field">
    <%= f.label :site_name %><br />
    <%= f.text_field :site_name %>
  </div>
  <div class="field">
    <%= f.label :site_domain %><br />
    <%= f.text_field :site_domain %>
  </div>
    <div class="field">
    <%= f.label :site_email %><br />
    <%= f.text_field :site_email %>
  </div>
  <div class="field">
    <%= f.label :google_analytics_code %><br />
    <%= f.text_field :google_analytics_code %>
  </div>
  <div class="field">
   <%= f.label :visible %><br />
   <%= f.check_box :visible %><br />
  </div>
  <div class="field">
    <%= f.label :mobile_visible %><br />
    <%= f.check_box :mobile_visible %><br />
  </div>
  <div class="field">
    <%= f.label :logo %>
    <%= f.file_field :logo %>
    <%= f.hidden_field :logo_cache %><br />
    <%= image_tag(@site.logo_url) if @site.logo? %>
  </div>
  <div class="field">
    <%= f.label :background_logo %>
    <%= f.file_field :background_logo %>
    <%= f.hidden_field :background_logo_cache %><br />
    <%= image_tag(@site.background_logo_url) if @site.background_logo? %>
  </div>
  <div class="field">
    <%= f.label :header %>
    <%= f.file_field :header %>
    <%= f.hidden_field :header_cache %><br />
    <%= image_tag(@site.header_url) if @site.header? %>
  </div>
  <div class="field">
    <%= f.label :background %>
    <%= f.file_field :background %>
    <%= f.hidden_field :background_cache %><br />
    <%= image_tag(@site.background_url) if @site.background? %>
  </div>
  <div class="field">
    <%= f.label :campaign_wrapbar %>
    <%= f.file_field :campaign_wrapbar %>
    <%= f.hidden_field :campaign_wrapbar_cache %><br />
    <%= image_tag(@site.campaign_wrapbar_url) if @site.campaign_wrapbar? %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

显示.html.erb

```
<section id="otherpage">
  <div class="otherpagetitle"> <%= @site.site_name %></div>
  <div class="otherpagetext dark_border_24_no_pad">

    <p>
      <b>Site name:</b>
      <%= @site.site_name %>
    </p>

    <p>
      <b>Site customer:</b>
      <%= @site.customer %>
    </p>

    <p>
      <b>Site domain:</b>
      <%= @site.site_domain %>
    </p>

    <p>
      <b>Site email:</b>
      <%= @site.site_email %>
    </p>

    <p>
      <b>Google analytics code:</b>
      <%= @site.google_analytics_code %>
    </p>

    <div class="field">
      <p>
        <b>Visible: </b>
        <%= check_box_tag "Visible", "yes", @site.visible, disabled: true %>
      </p>
    </div>
    <div class="field">
      <p>
        <b>Mobile Visible: </b>
        <%= check_box_tag "Mobile Visible", "yes", @site.mobile_visible, disabled: true %>
      </p>
    </div>
    <div class="field">
      <p>
        <b>Logo: </b><br />
        <%= @site.logo? ? image_tag(@site.logo_url) : "No logo uploaded" %>
      </p>
    </div>
    <div class="field">
      <p>
        <b>Background Logo: </b><br />
        <%= @site.background_logo? ? image_tag(@site.background_logo_url) : "No background logo uploaded" %>
      </p>
    </div>
    <%= link_to 'Edit', edit_site_path(@site) %> |
    <%= link_to 'Back', sites_path %>
  </div>
</section> 
```

编辑.html.erb

```
<section id="otherpage">

      <div class="otherpagetitle">Editing Site</div>
      <div class="otherpagetext dark_border_24_no_pad">

        <%= render 'form' %>

        <%= link_to 'Show', @site %> |
        <%= link_to 'Back', sites_path %>
      </div>
    </section> 
```

站点控制器.rb

```
class SitesController < ApplicationController
  load_and_authorize_resource

  # GET /sites
  # GET /sites.json
  def index
    @sites = Site.all
    @site = Site.first(conditions: { site_domain: request.subdomain }) || not_found

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @sites }
    end
  end

  # GET /sites/1
  # GET /sites/1.json
  def show
    @site = Site.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @site }
    end
  end

  # GET /sites/new
  # GET /sites/new.json
  def new
    @site = Site.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @site }
    end
  end

  # GET /sites/1/edit
  def edit
    @site = Site.find(params[:id])
  end

  # POST /sites
  # POST /sites.json
  def create
    @site = Site.new(params[:site])

    respond_to do |format|
      if @site.save
        format.html { redirect_to @site, notice: 'Site was successfully created.' }
        format.json { render json: @site, status: :created, location: @site }
      else
        format.html { render action: "new" }
        format.json { render json: @site.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /sites/1
  # PUT /sites/1.json
  def update
    @site = Site.find(params[:id])

    respond_to do |format|
      if @site.update_attributes(params[:site])
        format.html { redirect_to @site, notice: 'Site was successfully updated.' }
        format.json { head :ok }
      else
        format.html { render action: "edit" }
        format.json { render json: @site.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /sites/1
  # DELETE /sites/1.json
  def destroy
    @site = Site.find(params[:id])
    @site.destroy

    respond_to do |format|
      format.html { redirect_to sites_url }
      format.json { head :ok }
    end
  end

  def site_styles
    @site = Site.first(conditions: { site_domain: request.subdomain }) || not_found

    respond_to do |format|
      format.html
      format.json { render json: @site }
      format.css
    end
  end
end 
```

Gemlock.文件

```
GEM
  remote: http://rubygems.org/
  specs:
    actionmailer (3.1.5)
      actionpack (= 3.1.5)
      mail (~> 2.3.3)
    actionpack (3.1.5)
      activemodel (= 3.1.5)
      activesupport (= 3.1.5)
      builder (~> 3.0.0)
      erubis (~> 2.7.0)
      i18n (~> 0.6)
      rack (~> 1.3.6)
      rack-cache (~> 1.2)
      rack-mount (~> 0.8.2)
      rack-test (~> 0.6.1)
      sprockets (~> 2.0.4)
    activemodel (3.1.5)
      activesupport (= 3.1.5)
      builder (~> 3.0.0)
      i18n (~> 0.6)
    activerecord (3.1.5)
      activemodel (= 3.1.5)
      activesupport (= 3.1.5)
      arel (~> 2.2.3)
      tzinfo (~> 0.3.29)
    activeresource (3.1.5)
      activemodel (= 3.1.5)
      activesupport (= 3.1.5)
    activesupport (3.1.5)
      multi_json (>= 1.0, < 1.3)
    ansi (1.4.2)
    arel (2.2.3)
    bcrypt-ruby (3.0.1)
    best_in_place (1.0.6)
      jquery-rails
      rails (~> 3.1)
    builder (3.0.0)
    cancan (1.6.7)
    capistrano (2.11.2)
      highline
      net-scp (>= 1.0.0)
      net-sftp (>= 2.0.0)
      net-ssh (>= 2.0.14)
      net-ssh-gateway (>= 1.1.0)
    capistrano-ext (1.2.1)
      capistrano (>= 1.0.0)
    carrierwave (0.5.8)
      activesupport (~> 3.0)
    ckeditor (3.7.0.rc2)
      mime-types (~> 1.17.2)
      orm_adapter (~> 0.0.6)
    coffee-rails (3.1.1)
      coffee-script (>= 2.2.0)
      railties (~> 3.1.0)
    coffee-script (2.2.0)
      coffee-script-source
      execjs
    coffee-script-source (1.2.0)
    daemons (1.1.8)
    devise (1.5.3)
      bcrypt-ruby (~> 3.0)
      orm_adapter (~> 0.0.3)
      warden (~> 1.1)
    erubis (2.7.0)
    eventmachine (0.12.10)
    execjs (1.2.13)
      multi_json (~> 1.0)
    friendly_id (4.0.1)
    has_scope (0.5.1)
    highline (1.6.11)
    hike (1.2.1)
    i18n (0.6.0)
    inherited_resources (1.2.2)
      has_scope (~> 0.5.0)
      responders (~> 0.6.0)
    jquery-rails (1.0.19)
      railties (~> 3.0)
      thor (~> 0.14)
    json (1.7.3)
    mail (2.3.3)
      i18n (>= 0.4.0)
      mime-types (~> 1.16)
      treetop (~> 1.4.8)
    mime-types (1.17.2)
    mini_magick (3.4)
      subexec (~> 0.2.1)
    minitest (2.6.1)
    multi_json (1.2.0)
    mysql2 (0.3.11)
    net-scp (1.0.4)
      net-ssh (>= 1.99.1)
    net-sftp (2.0.5)
      net-ssh (>= 2.0.9)
    net-ssh (2.3.0)
    net-ssh-gateway (1.1.0)
      net-ssh (>= 1.99.1)
    orm_adapter (0.0.6)
    polyglot (0.3.3)
    rack (1.3.6)
    rack-cache (1.2)
      rack (>= 0.4)
    rack-mount (0.8.3)
      rack (>= 1.0.0)
    rack-ssl (1.3.2)
      rack
    rack-test (0.6.1)
      rack (>= 1.0)
    rails (3.1.5)
      actionmailer (= 3.1.5)
      actionpack (= 3.1.5)
      activerecord (= 3.1.5)
      activeresource (= 3.1.5)
      activesupport (= 3.1.5)
      bundler (~> 1.0)
      railties (= 3.1.5)
    rails-i18n (0.3.0)
      i18n (~> 0.5)
    railties (3.1.5)
      actionpack (= 3.1.5)
      activesupport (= 3.1.5)
      rack-ssl (~> 1.3.2)
      rake (>= 0.8.7)
      rdoc (~> 3.4)
      thor (~> 0.14.6)
    rake (0.9.2.2)
    rdoc (3.12)
      json (~> 1.4)
    responders (0.6.5)
    sass (3.1.15)
    sass-rails (3.1.4)
      actionpack (~> 3.1.0)
      railties (~> 3.1.0)
      sass (>= 3.1.4)
      sprockets (~> 2.0.0)
      tilt (~> 1.3.2)
    sprockets (2.0.4)
      hike (~> 1.2)
      rack (~> 1.0)
      tilt (~> 1.1, != 1.3.0)
    sqlite3 (1.3.5)
    subexec (0.2.1)
    thin (1.3.1)
      daemons (>= 1.0.9)
      eventmachine (>= 0.12.6)
      rack (>= 1.0.0)
    thor (0.14.6)
    tilt (1.3.3)
    treetop (1.4.10)
      polyglot
      polyglot (>= 0.3.1)
    truncate_html (0.5.4)
    turn (0.8.3)
      ansi
    tzinfo (0.3.33)
    uglifier (1.2.3)
      execjs (>= 0.3.0)
      multi_json (>= 1.0.2)
    warden (1.1.0)
      rack (>= 1.0)
    will_paginate (3.0.3)

PLATFORMS
  ruby

DEPENDENCIES
  best_in_place
  cancan
  capistrano-ext
  carrierwave
  ckeditor (= 3.7.0.rc2)
  coffee-rails (~> 3.1.1)
  devise (~> 1.5)
  execjs (~> 1.2.11)
  friendly_id
  inherited_resources
  jquery-rails
  mini_magick
  minitest
  mysql2 (~> 0.3.11)
  rails (~> 3.1.4)
  rails-i18n
  sass-rails (= 3.1.4)
  sqlite3
  thin
  truncate_html
  turn
  uglifier (>= 1.0.3)
  will_paginate (~> 3.0) 
```

移民

```
class AddSiteEmailColumnToSites < ActiveRecord::Migration
      def change
        add_column :sites, :site_email, :string
      end
    end 
```

capistrano 部署

```
cap staging deploy
    triggering load callbacks
  * 2012-12-03 20:45:57 executing `staging'
    triggering start callbacks for `deploy'
  * 2012-12-03 20:45:57 executing `multistage:ensure'
Identity added: /Users/me/.ssh/id_rsa (/Users/me/.ssh/id_rsa)
  * 2012-12-03 20:45:57 executing `deploy'
  * 2012-12-03 20:45:57 executing `deploy:update'
 ** transaction: start
  * 2012-12-03 20:45:57 executing `deploy:update_code'
    executing locally: "git ls-remote ssh://gitolite@site_repo:2011/proto_mysitename_rails HEAD"
    command finished in 2997ms
  * executing "git clone -q ssh://gitolite@site_repo:2011/proto_mysitename_rails /var/www/sitename/releases/20121203204600 && cd /var/www/sitename/releases/20121203204600 && git checkout -q -b deploy ed9ca3a2f10b049ed17b952d90ec7b61e9e98822 && (echo ed9ca3a2f10b049ed17b952d90ec7b61e9e98822 > /var/www/sitename/releases/20121203204600/REVISION)"
    servers: ["x.x.x.x"]
    [x.x.x.x] executing command
    command finished in 80618ms
  * 2012-12-03 20:47:21 executing `deploy:finalize_update'
    triggering before callbacks for `deploy:finalize_update'
  * 2012-12-03 20:47:21 executing `deploy:assets:symlink'
  * executing "rm -rf /var/www/sitename/releases/20121203204600/public/assets &&\\\n        mkdir -p /var/www/sitename/releases/20121203204600/public &&\\\n        mkdir -p /var/www/sitename/shared/assets &&\\\n        ln -s /var/www/sitename/shared/assets /var/www/sitename/releases/20121203204600/public/assets"
    servers: ["x.x.x.x"]
    [x.x.x.x] executing command
    command finished in 118ms
  * executing "chmod -R -- g+w /var/www/sitename/releases/20121203204600 && rm -rf -- /var/www/sitename/releases/20121203204600/public/system && mkdir -p -- /var/www/sitename/releases/20121203204600/public/ && ln -s -- /var/www/sitename/shared/system /var/www/sitename/releases/20121203204600/public/system && rm -rf -- /var/www/sitename/releases/20121203204600/log && ln -s -- /var/www/sitename/shared/log /var/www/sitename/releases/20121203204600/log && rm -rf -- /var/www/sitename/releases/20121203204600/tmp/pids && mkdir -p -- /var/www/sitename/releases/20121203204600/tmp/ && ln -s -- /var/www/sitename/shared/pids /var/www/sitename/releases/20121203204600/tmp/pids"
    servers: ["x.x.x.x"]
    [x.x.x.x] executing command
    command finished in 120ms
    triggering after callbacks for `deploy:update_code'
  * 2012-12-03 20:47:21 executing `deploy:assets:precompile'
  * executing "cd /var/www/sitename/releases/20121203204600 && rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile"
    servers: ["x.x.x.x"]
    [x.x.x.x] executing command
 ** [out :: x.x.x.x] /usr/local/bin/ruby /usr/local/bin/rake assets:precompile:nondigest RAILS_ENV=production RAILS_GROUPS=assets
    command finished in 101748ms
  * 2012-12-03 20:49:03 executing `deploy:create_symlink'
  * executing "rm -f /var/www/sitename/current && ln -s /var/www/sitename/releases/20121203204600 /var/www/sitename/current"
    servers: ["x.x.x.x"]
    [x.x.x.x] executing command
    command finished in 111ms
 ** transaction: commit
  * 2012-12-03 20:49:03 executing `deploy:restart'
  * executing "rm /var/www/sitename/current/config/database.yml"
    servers: ["x.x.x.x"]
    [x.x.x.x] executing command
    command finished in 65ms
  * executing "ln -s /var/www/sitename/shared/database.yml /var/www/sitename/current/config/database.yml"
    servers: ["x.x.x.x"]
    [x.x.x.x] executing command
    command finished in 65ms
  * executing "ln -s /var/www/sitename/shared/session_store.rb /var/www/sitename/current/config/initializers/session_store.rb"
    servers: ["x.x.x.x"]
    [x.x.x.x] executing command
    command finished in 69ms
  * executing "ln -s /var/www/sitename/shared/public/uploads /var/www/sitename/current/public/uploads"
    servers: ["x.x.x.x"]
    [x.x.x.x] executing command
    command finished in 63ms
  * executing "ln -s /var/www/sitename/shared/public/ckeditor_assets /var/www/sitename/current/public/ckeditor_assets"
    servers: ["x.x.x.x"]
    [x.x.x.x] executing command
    command finished in 62ms
  * executing "sudo -p 'sudo password: ' touch /var/www/sitename/current/tmp/restart.txt"
    servers: ["x.x.x.x"]
    [x.x.x.x] executing command 
```

非常欢迎有关此问题的任何帮助或建议。

谢谢

**更新**

在不改变任何东西的情况下，值现在写入数据库。24岁左右。我现在对实时服务器有同样的问题。我又等了 24 小时，看看这是否解决了问题，或者我是否不小心以其他方式修复了它。

以防万一其他人将来遇到这个问题，有没有人知道它为什么会这样？

**更新 2**

实时服务器现在也在更新这些值。似乎服务器可能负载过重，或者数据库正在以某种方式运行。

**参考**

作为参考，如果您尝试尝试评论中的所有建议并查看 Thomas 的回答，这应该可以解决 99.9% 的问题。如果它在本地工作但不在服务器上，并且您已经尝试了所有这些步骤，那么它很可能与我遇到的问题相同，不幸的是我目前对此没有真正的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:19:26.153

这可能是某种批量分配问题，如果没有列出属性，除非进行了某些设置，否则它们会被静默删除。

尝试在您的站点模型中添加`:site_email`您的呼叫。`attr_accessible`

```
# app/models/site.rb
...
attr_accessible :name, :site_email # mass-assignment protection 
```

您需要在那里列出您希望能够`@site.update_attributes(params[:site]`在控制器中更新的所有属性，并使用所谓的**质量分配**实例化`Site.new(name: ..., site_email: ...)`or `Site.create(name: ..., site_email: ...)`。

# php - 在 catch 块中设置对象属性时 PHPUnit 测试失败

> ID：13690848
> 
> 赞同：8
> 
> 时间：2012-12-03T20:08:25.953
> 
> 标签：php, zend-framework, object, phpunit, try-catch

我正在测试`setSubject`将主题设置为*（空主题）*的方法，如果它丢失。如果试图访问未声明的属性，Zend_Mail 会抛出异常（例如，缺少电子邮件主题，最好抛出一些异常）。更多信息： http: [//framework.zend.com/issues/browse/ZF-11371](http://framework.zend.com/issues/browse/ZF-11371) 这是我需要使用才能成功测试它：

班级

```
protected function setSubject()
{
    # catch exception thrown if non existing $this->message object property is accessed
    try
    {
      $this->subject = $this->defunctTheContent($this->message->getHeaders(), $this->message->subject);
    }
    catch (Zend_Mail_Exception $e)
    {
    }
    if( ! $this->subject)
      $this->subject = '(empty subject)';
} 
```

测试

```
public function testNoSubject()
{
  $email = new parseEmail(file_get_contents('mail.x'));
  $this->AssertEquals('(empty subject)', $email->subject);
} 
```

但是，如果我尝试此代码，您会看到 catch 块是空的...

```
protected function setSubject()
{
    try
    {
      $this->subject = $this->defunctTheContent($this->message->getHeaders(), $this->message->subject);
    }
    catch (Zend_Mail_Exception $e)
    {
      $this->subject = '(empty subject)';
    }
} 
```

测试失败并显示消息：

> 有 1 个错误：
> 
> 1) Email_ParseTest::testNoSubject InvalidArgumentException: 主题是必需的

它抱怨 $this->subject 未设置（或类似）。

更多信息：

*   PHP 5.4.8
*   Zend 框架 1.9.5
*   PHPUnit 3.6.12
*   `subject`被定义为空字符串 ( `""`)

我已经“手动”测试了第二种方法，它按预期工作（主题设置在 catch 块中）。我对 PHPUnit 没有太多经验，所以这可能很`E_PEBKAC`容易。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T16:07:59.500

除非我误解了您的问题，否则您正在尝试测试受保护的方法……您不能这样做。假设通过测试使用它们的公共方法来测试受保护和私有方法。

如果您将 PHP 5.3.2+ 与 PHPUnit 一起使用，您可以在运行测试之前通过使用反射将它们设置为公开来直接测试您的私有和受保护方法，但是，正如我所提到的，您应该测试公共方法。

但是如果你想使用反射，这里有一个通用的例子：

```
protected static function getMethod($name) {
  $class = new ReflectionClass('MyClass');
  $method = $class->getMethod($name);
  $method->setAccessible(true);
  return $method;
}

public function testFoo() {
  $foo = self::getMethod('foo');
  $obj = new MyClass();
  $foo->invokeArgs($obj, array(...));
  ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T11:22:42.733

看起来你捕捉到了错误的异常： Zend_Mail 似乎抛出了一个`InvalidArgumentException`，而你捕捉到了一个`Zend_Mail_Exception`.

试试下面的代码：

```
protected function setSubject()
{
    # catch exception thrown if non existing $this->message object property is accessed
    try {
        $this->subject = $this->defunctTheContent($this->message->getHeaders(), $this->message->subject);
    }
    catch (InvalidArgumentException $e) {
        $this->subject = '(empty subject)';
    }
} 
```

* * *

## 编辑

再次阅读您的问题，我会说这`Zend_Mail_Exception`永远不会被抛出。如果您从第一个代码块中删除`try`/ `catch`，我敢打赌它也会起作用：

```
protected function setSubject()
{
    $this->subject = $this->defunctTheContent($this->message->getHeaders(), $this->message->subject);
    if (! $this->subject) {
        $this->subject = '(empty subject)';
    }
} 
```

[第 396 行](https://github.com/dmelo/Zend-1.11/blob/master/Mail/Part.php#L396)引用了一个不存在的标头，但看起来即使`$this->subject`为空也不会触发它（异常类和消息与您的测试结果不匹配）。我怀疑这个头文件之前已经在 Zend 或其他地方设置为空值。

这可以解释为什么在第二种情况下，`$this->subject`永远不会设置（`catch`代码永远不会执行）。可能是由检测到未设置的类`InvalidArgumentException`抛出的。`parseEmail``subject`

然而，第二个块确实无条件地检查`! $this->subject`，并相应地设置它。所以测试通过了。

总结一下：

*   `Zend_Mail_Exception`永远不会被抛出
*   `InvalidArgumentException`被扔进去`parseEmail`

# javascript - 禁止浏览器默认右键单击菜单 - 细化？

> ID：13690850
> 
> 赞同：3
> 
> 时间：2012-12-03T20:08:37.223
> 
> 标签：javascript, jquery

好的，据我所知，到目前为止，我们有两种方法

首先是一些我可以在给定脚本中使用的javascript。但这会关闭所有内容的右键单击。

```
window.oncontextmenu = function() {
        return false;
}; 
```

或者在html中可以编码

```
<body oncontextmenu="return false;"> 
```

但到目前为止，我找不到任何可以为我提供 javascript 或 jquery 解决方案的地方，我可以将其应用于给定的选择器。这根本不可能，还是我误解了什么。

我发现单击鼠标右键会立即出现我的子菜单，然后是浏览器的默认菜单。我发现抑制这种情况的唯一方法是将 oncontextmenu 设置为 false。有没有更精细的解决方案？

**对已接受答案的进一步说明**

还使用委托在动态菜单上成功应用：

```
$(document).on("contextmenu", "#existing_Flavours .field_Input_Left.flavour", function(){
        return false;   // suppress browsers default right click menu
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T20:11:09.290

```
$('#mySelector').on('contextmenu', function(){
  return false;
}); 
```

就像绑定任何其他事件一样绑定它...

但是，如果您想这样做以*“保护”*内容，那么安全性就很低。很容易绕过。

演示：http: [//jsfiddle.net/V3sWc/](http://jsfiddle.net/V3sWc/)

# wcf - 客户端在使用传输安全时会自动加密吗？

> ID：13690851
> 
> 赞同：0
> 
> 时间：2012-12-03T20:08:45.587
> 
> 标签：wcf, security, ssl

在通过 fiddler 检查流量时，我注意到对我的在线服务器的调用没有加密，即使调用的是 https 地址（已经为域安装了 SSL），发送的数据在soap body 中也很容易读取。我正在使用没有客户端身份验证的传输安全性。这是默认行为吗？，我的印象是通过 SSL 传递到服务器的数据也是加密的，无法查看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:35:20.273

是的，如果您指定了传输安全性，将使用 SSL。我建议两种可能性：

1.  您已将 Fiddler 配置为查看受 SSL 保护的连接（这是可能的，但在大多数情况下不建议这样做）。
2.  您没有引用您认为您正在引用的绑定。

# android - 在 API 9 中拦截来自 WebView 的资源请求

> ID：13690856
> 
> 赞同：1
> 
> 时间：2012-12-03T20:09:00.087
> 
> 标签：android, android-webview

我需要拦截来自 WebView 的资源请求，以便提供以前下载的资源（预缓存）。API 11+ 中有[一种方法](http://developer.android.com/reference/android/webkit/WebViewClient.html#shouldInterceptRequest%28android.webkit.WebView,%20java.lang.String%29)，但我需要支持 Gingerbread。

有没有人有一个好主意来完成这个？

到目前为止，我已经考虑过使用[addJavascriptInterface()](http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface%28java.lang.Object,%20java.lang.String%29)和一些注入页面的 JS 来异步提供资源，但这很混乱，因为我无法控制正在显示的 Web 内容，并且必须使用正则表达式来修改图片标签等

以前几乎有人问过这个问题，但是这两个线程都没有针对这种情况提供好的解决方案。（[问题](https://stackoverflow.com/questions/8833597/intercept-and-update-javascript-from-webview)）（[问题](https://stackoverflow.com/questions/4780899/intercept-and-override-http-requests-from-webview)）

# c - 信号量 + pthreads，无法正常工作

> ID：13690857
> 
> 赞同：2
> 
> 时间：2012-12-03T20:09:02.647
> 
> 标签：c, pthreads, semaphore

我有这个过程图。在每个线程中都开始新进程。首先是进程 1，当它结束时会发布信号，下一个可能的进程是 2 和 4。
此图解释更多：[1](http://i.stack.imgur.com/AoPCY.png)：http: [//i49.tinypic.com/34t5uo0.png](http://i49.tinypic.com/34t5uo0.png)。我的脚本有时会崩溃。进程 1、2 或 4 不执行。哪里有问题？

```
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>
#include <semaphore.h> 

sem_t semA,semB,semC,semD,semE;

void* process_2 (void* param)
{ 
  sem_wait(&semA);
  int pid2, status2; 
  pid2 = fork ();
  if ( pid2 < 0 ) {
   exit(1);
  }
 if ( pid2==0 ) { 

  printf("Process 2\n");
  }
 else {
  wait(&status2);
  sem_post(&semC);
 } 
 return NULL;
}

void* process_4(void* param)
{   
 sem_wait(&semB);
 int pid4, status4;
 pid4 = fork ();
 if ( pid4 < 0 ) {
  exit(1);
 }
 if ( pid4==0 ) { 

   printf("Process 4\n");

  exit(0);
 }
 else {
  wait(&status4);
  sem_post(&semD);                          
 }

 return NULL;
}

void* process_3(void* param)
{
 sem_wait(&semC);
 int pid3, status3;
 pid3 = fork();
  if (pid3 < 0) {
  exit(0);
 }
 if (pid3 == 0) {  

   printf("Process 3\n");
 }
 else{
  wait(&status3);
  sem_post(&semE);
 }

 return NULL;

}

void* process_5(void* param)
{
 sem_wait(&semD);
 sem_wait(&semE);
 int pid5, status5;
 pid5 = fork();
 if (pid5 < 0) {
   exit(0);
 }
 if (pid5 == 0) {  
  printf("Process 5\n");
 }
 else{
  wait(&status5);
  exit(0);
 }

 return NULL;

}

int main () {

  pthread_t thread_id[4];
  pthread_create(&thread_id[0], NULL,&process_2, NULL);
  pthread_create(&thread_id[1], NULL,&process_3, NULL);
  pthread_create(&thread_id[2], NULL,&process_4, NULL);
  pthread_create(&thread_id[3], NULL,&process_5, NULL);

  sem_init(&semA,0,0); 
  sem_init(&semB,0,0);
  sem_init(&semC,0,0);
  sem_init(&semD,0,0);
  sem_init(&semE,0,0);

  int pid, status;

  pid = fork ();
  if ( pid < 0 ) {
   exit(1);
   }
  if ( pid==0 ) {  
   printf("Process 1\n");    
   }
  else { 
   wait(&status);
   sem_post(&semA);
   sem_post(&semB);
   int i;
   for (i = 0; i < 4; i++)
    pthread_join(thread_id[i],NULL);   
   return 0;
   }
 exit(0);

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:19:37.407

至少有一个问题是在初始化信号量之前生成线程：

```
pthread_t thread_id[4];
pthread_create(&thread_id[0], NULL,&process_2, NULL);
pthread_create(&thread_id[1], NULL,&process_3, NULL);
pthread_create(&thread_id[2], NULL,&process_4, NULL);
pthread_create(&thread_id[3], NULL,&process_5, NULL);

sem_init(&semA,0,0); 
sem_init(&semB,0,0);
sem_init(&semC,0,0);
sem_init(&semD,0,0);
sem_init(&semE,0,0); 
```

这会在初始化信号量的主线程和使用它们的子线程之间创建一个竞争条件。这里很有可能使用未初始化的数据。

我建议在你的 main() 函数中交换顺序：

```
pthread_t thread_id[4];

sem_init(&semA,0,0); 
sem_init(&semB,0,0);
sem_init(&semC,0,0);
sem_init(&semD,0,0);
sem_init(&semE,0,0);

pthread_create(&thread_id[0], NULL,&process_2, NULL);
pthread_create(&thread_id[1], NULL,&process_3, NULL);
pthread_create(&thread_id[2], NULL,&process_4, NULL);
pthread_create(&thread_id[3], NULL,&process_5, NULL); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T21:15:17.353

本的回答向您展示了您的主要问题，但您还有其他问题。您正在轻松地使用线程、进程和信号量进行编程。

*   信号量不能这样编程。所有信号量函数都给出错误返回码是有充分理由的。例如`sem_wait` ，如果进程接收到信号，可能会遇到“虚假唤醒”。所以你必须检查返回然后`errno`看看发生了什么，在编程 POSIX 信号量时没有办法解决这个问题。

*   信号量只是 POSIX 中的一个可选功能。从一开始就设计的 POSIX 功能开始可能更容易，即`pthread_mutex_t`和`pthread_cond_t`. 您作为补充获得的是便携性。仍然有一些非常常见的架构不完全支持信号量。

*   您这样做的方式*不是*在进程之间共享信号量的方式：

    > 父级的整个虚拟地址空间在子级中复制

    这意味着child中的信号量是一个副本，两个进程将无法通过它进行通信。您必须使用类似的东西`shm_open`并`mmap`创建进程共享信号量。

*   混合`fork`和线程通常不是一项微不足道的任务，在这样做之前你真的应该三思而后行。

# mysql - MySQL 查询选择唯一时间戳

> ID：13690864
> 
> 赞同：0
> 
> 时间：2012-12-03T20:09:27.833
> 
> 标签：mysql

我有一个跟踪用户点击的数据库。如果有人两次单击同一事物，则可能会在数据库中产生具有相同时间戳的重复条目。

有没有办法修改我的查询以仅返回具有唯一时间戳的结果而不是重复的结果。

```
$stmt1 = $dbConn1->prepare("
    SELECT count(*)
    FROM asset_lookup
    "); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:14:00.970

我相信您正在寻找独特的关键字。阅读此线程它应该对您有所帮助。

[mysql查询：SELECT DISTINCT column1，GROUP BY column2](https://stackoverflow.com/questions/2483492/mysql-query-select-distinct-column1-group-by-column2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:22:46.523

笔记：

*   因为您在子句中使用了连接，所以`product`100% 等同于连接。除此之外，是否有必要计算表格中不存在且仅存在于表格中的产品（如果有）的点击次数？`INNER``product.product_type_id = 2``WHERE``product``asset`

*   因为您在子句中使用了`LEFT`连接，所以`event`100% 等同于连接。`INNER``event.activation_date``WHERE`

*   加入`tracking_product_lookup`似乎完全没用。

*   外`COUNT(*)`连接可能会给出错误的结果。`COUNT(*)`计算中间结果集中的行数，外部连接在某些列中生成带有 Null 的行（例如，根本没有点击的产品仍将显示计数为 1）。

*   要回答实际问题，如果要计算不同的时间戳，请使用`COUNT(DISTINCT column)`，而不是`COUNT(*)`。

查询将被写为：

```
SELECT product.id, product.name, 
       count(DISTINCT asset_lookup.timestamp)
FROM asset_lookup
  JOIN product ON asset_lookup.product_id = product.id
  JOIN event ON asset_lookup.event_id = event.id
WHERE asset_lookup.event_id = ?
  AND product.product_type_id = 2
  AND asset_lookup.timestamp > event.activation_date
GROUP by asset_lookup.product_id ; 
```

# c++ - XSD 生成的解析器中的 gSOAP 替代方案

> ID：13690867
> 
> 赞同：1
> 
> 时间：2012-12-03T20:09:49.230
> 
> 标签：c++, xml, xsd, gsoap

我正在使用 gSOAP 从我自己准备的 XSD Schema 生成 XML 解析代码。它与 Web 服务无关。XML 数据是从本地文件或内存缓冲区中读取的（通过提供适当的`istream`to `soap`）。

起初它似乎很简单。但是现在随着我越来越多地使用它，我开始看到一些问题。

例如，名称是在全局命名空间中引入的。可以强制使用命名空间，但随后构建变得更加困难（由于需要生成额外的代码来处理错误），只能使用一个命名空间，并且由于使用宏，它也可能导致其他问题。

`.exe`一旦每个二进制构建单元（ , `.dll`, ...）拥有多个模式，您就确实需要这些名称空间！

所以我开始考虑一些替代方案。特别是我不需要那些网络服务人员。仅用于基于 XSD 解析 XML 的自动代码生成。

有没有这样的选择（对于本机 C++）？这些是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-29T14:14:32.190

以下是有关 XML 数据绑定的资源列表： [http ://www.rpbourret.com/xml/XMLDataBinding.htm](http://www.rpbourret.com/xml/XMLDataBinding.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-30T00:26:06.010

gSOAP 的 wsdl2h 的 XSD 转换不会产生 C++ 名称空间，而是将 XSD 名称空间映射到一个非常易于使用的前缀名称约定 (ns__name)，并且避免了 C（和 C++）中的名称冲突。任何绑定工具都必须强制执行这种映射规则。为什么你说“一旦每个二进制构建单元有多个模式，你就需要这些命名空间”？您可以简单地在所有 XSD 上一起运行 wsdl2h。

# php - Zend 框架模型，Active Record 模式替代方案

> ID：13690868
> 
> 赞同：2
> 
> 时间：2012-12-03T20:09:50.447
> 
> 标签：php, zend-framework, activerecord

我正在编写一些代码，允许用户阅读网站上的报告，使用 AJAX 调用动态加载仅请求的内容，而不是整个 15+MB 报告。

我正在编写一个模型来访问数据库中的所有报告数据，并且我不想使用 Active Record 模式。我遵循“一个模型有一个表，而不是 IS-A 表”的想法，因为这个模型将访问 5 个不同的表，并且这些表之间有一些复杂的 MySQL JOIN。

Zend 框架中遵循的好的设计模式是什么，示例？

* * *

**更新于 2012-12-05 @ 12:14PM EST**

我目前在一家市场研究报告公司工作。不使用实际的函数名称，或透露代码的任何有意义的细节，这里是基础：

![代码图](../Images/511e51406a0a68dd0a927a1f90cdffe8.png)

readreportAction() 会：

*   获取报表元数据
*   获取报告“目录”

readsectionAction() 会：

*   获取报告文本，只是其中的一部分
*   获取嵌入的表格数据
*   获取数字/图像
*   获取脚注
*   格式化报告文本

reportpdfAction() 与 readreportAction() 和 readsectionAction() 做的事情完全相同，除了一次。我正在尝试概念化一种不复制+粘贴此代码/编程逻辑的方法。数据映射器似乎可以解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:39:47.177

我会推荐[Data Mapper 模式](http://martinfowler.com/eaaCatalog/dataMapper.html)。

![在此处输入图像描述](../Images/1e38c10d86f5e1d5552ef705ab5a774d.png)

你说的一切都很有道理，这种模式很合适。你的模型不应该知道或关心它是如何被持久化的。相反，映射器会按照它的建议进行 - 将您的模型映射到您的数据库。我喜欢这种方法的一件事是它鼓励人们根据对象而不是关系数据库表来考虑模型，就像活动记录模式和表行网关经常发生的那样。

您的对象，除非非常简单，否则通常不会反映数据库表的结构。这使您可以编写好的对象，然后再担心持久性方面。有时需要更多的手动操作，因为您的映射器需要处理复杂的连接，可能需要编写一些代码或 SQL，但最终结果是它只做您想要的，仅此而已。如果您不想利用它们，则不需要魔法或约定。

我一直认为这些文章很好地解释了一些可以在 ZF 中很好使用的设计模式：http: [//survivethedeepend.com/zendframeworkbook/en/1.0/implementing.the.domain.model.entries。 and.authors#zfbook.implementing.the.domain.model.entries.and.authors.exploring.the.entry.data.mapper](http://survivethedeepend.com/zendframeworkbook/en/1.0/implementing.the.domain.model.entries.and.authors#zfbook.implementing.the.domain.model.entries.and.authors.exploring.the.entry.data.mapper)

**更新：**

好吧，您的映射器可能会从类似于以下的接口扩展：

```
<?php
interface Mapper_Interface
{

    /**
     * Sets the name of the entity object used by the mapper.    
     */
    public function setObjectClass($class);

    /**
     * Sets the name of the list class used by the mapper.
     */
    public function setObjectListClass($listClass);

    /**
     * Get the name of the object class used by the mapper.
     * 
     */
    public function getObjectClass();

    /**
     * Get the name of the object list class used by the mapper.
     * 
     * @return string
     */
    public function getObjectListClass();

    /**
     * Fetch one row.
     *   
     * @param array $where Criteria for the selection.
     * @param array [$order = array()] Optionally the order of results
     * @return Object_Abstract
     * @throws Mapper_Exception
     */
    public function fetchRow($where, $order = array());

    /**
     * Fetch all records.  If there is no underlying change in the persisted data this    should
     * return a consistant result.
     * 
     * @param string|array|Zend_Db_Table_Select $where  OPTIONAL An SQL WHERE clause or Zend_Db_Table_Select object.
     * @param string|array                    $order  OPTIONAL An SQL ORDER clause.
     * @param int                              $count  OPTIONAL An SQL LIMIT count.
     * @param int                              $offset OPTIONAL An SQL LIMIT offset.
     * @return Object_List_Abstract 
     * @throws Mapper_Exception
     */
    public function fetchAll($where = null, $order = null, $count = null, $offset = null);

    /**
     * Deletes one or more object.
     * 
     * @param array|string $where Criteria for row deletion.
     * @return integer $affectedRows  
     * @throws Mapper_Exception
     */
    public function delete($where);

    /**
     * Saves a record. Either updates or inserts, as required.
     *   
     * @param $object Object_Abstract
     * @return integer $lastInsertId
     * @throws Mapper_Exception
     */
    public function save($object);
} 
```

您将与映射器进行交互，例如：

```
$fooObjectMapper = new Foo_Mapper;
$fooObjectList = $fooObjectMapper->fetchAll();
var_dump($fooObjectList->first()); 
```

或者

```
$fooObjectMapper = new Foo_Mapper;
$fooObject = $fooObject->fetch(array('id = ?' => 1));
$fooObject->setActive(false);
$fooObjectMapper->save($fooObject); 
```

我通常为任何启用“PDO”的数据库编写映射器摘要。该具体映射器的属性之一是 Zend_Db_Adapter 来发出命令。提供灵活的解决方案，易于在测试中使用模拟数据源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:14:44.667

您可以考虑使用[Doctrine 2](http://www.doctrine-project.org/)。这是一个不使用 ActiveRecord 模式的 ORM。

在 Doctrine 中，您的模型（实体）都只是普通的 PHP 对象，对数据库的了解为零。您使用映射（xml、yaml 或注释）来告诉 Doctrine 它们在数据库中的显示方式，而实体管理器和存储库用作持久实体或执行其他数据库操作的网关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T09:08:34.577

首先，您似乎需要在概念上进行更多的飞跃。使用数据映射器模式，它有助于根据对象而不是数据库表进行思考。当我需要实现飞跃时，我发现这两篇文章很有帮助。

[http://phpmaster.com/building-a-domain-model/](http://phpmaster.com/building-a-domain-model/)
[http://phpmaster.com/integrating-the-data-mappers/](http://phpmaster.com/integrating-the-data-mappers/)

话虽如此，ZF 1 有一些非常有用的工具可用于构建数据映射器/域模型。

ZF 1 中的约定是通过 Zend_Db_Table api 访问您正在使用的每个表。我发现的最简单的方法是只为每个表使用[DbTable 资源](http://framework.zend.com/manual/1.12/en/zend.db.table.html#zend.db.table.defining)。您也可以使用`Zend_Db::factory`或`new Zend_Db_Table('tableName')`或任何其他吸引您的方法。

此示例基于 mp3 歌曲曲目。

```
//in effect this is the database adapter for database table 'track', This is $tableGateway used later.
<?php
class Application_Model_DbTable_Track extends Zend_Db_Table_Abstract
{
    //name of database table, required to be set if name of class does not match name of table
    protected $_name = 'track';
    //optional, column name of primary key
    protected $_primary = 'id';

} 
```

有几种方法可以将表附加到 Db 适配器和 Zend_Db_Table api，我只是发现这种方法实现起来很简单，而且它也使设置映射器变得简单。

映射器类是数据源和您的对象（域实体）之间的桥梁。在本例中，映射器与 Zend_Db_Table 的 api 交互。

**要理解的一个非常重要的点：**当使用扩展 Zend_Db_Table_Abstract 的类时，您可以使用 Zend_Db 组件的所有基本功能。(find(),fetchall(), fetchRow(), select() ...)

```
<?php
class Music_Model_Mapper_Track extends Model_Mapper_Abstract
{

    //the mapper to access the songs artist object
    protected $artistMapper;
    //the mapper to access to songs album object
    protected $albumMapper;

    /**
     * accepts instance of Zend_Db_Table_Abstract
     *
     * @param Zend_Db_Table_Abstract $tableGateway
     */
    public function __construct(Zend_Db_Table_Abstract $tableGateway = null)
    {
        //at this point I tend to hardcode $tablegateway but I don't have to
        $tableGateway = new Application_Model_DbTable_Track();
        parent::__construct($tableGateway);
        //parent sets the $tablegateway variable and provides an abstract requirement
        //for createEntity(), which is the point of this class
    }
    /**
     * Creates concrete object of Music_Model_Track
     *
     * @param object $row
     * @return Music_Model_Track
     */
    public function createEntity($row)
    {
        $data = array(
            'id'           => $row->id,
            'filename'     => $row->filename,
            'format'       => $row->format,
            'genre'        => $row->genre,
            'hash'         => $row->hash,
            'path'         => $row->path,
            'playtime'     => $row->playtime,
            'title'        => $row->title,
            'track_number' => $row->track_number,
            'album'        => $row->album_id,//foriegn key
            'artist'       => $row->artist_id//foriegn key
        );
        //instantiate new entity object
        return new Music_Model_Track($data);
    }
    /**
     * findById() is proxy for find() method and returns
     * an entity object.
     *
     * @param type $id
     * @return object Model_Entity_Abstract
     */
    public function findById($id)
    {
        //instantiate the Zend_Db_Select object
        $select = $this->getGateway()->select();
        $select->where('id = ?', $id);
        //retrieve one database table row
        $row = $this->getGateway()->fetchRow($select);
        //create one entity object Music_Model_Track
        $entity = $this->createEntity($row);
        //return one entity object Music_Model_Track
        return $entity;
    }

  //truncated
} 
```

之前所做的一切都是为了明确构建以下对象：

```
<?php
class Music_Model_Track extends Model_Entity_Abstract
{
    /**
     * $id, __set, __get and toArray() are implemented in the parent
     */
    protected $album;
    protected $artist;
    protected $filename;
    protected $format;
    protected $genre;
    protected $hash;
    protected $path;
    protected $playtime;
    protected $title;
    protected $track_number;
    //artist and album mappers
    protected $albumMapper  = null;
    protected $artistMapper = null;

   //these are the important accessors/mutators because they convert a foreign key
   //in the database table to an entity object.
    public function getAlbum()
    {
        //if the album object is already set, use it.
        if(!is_null($this->album) && $this->album instanceof Music_Model_Album) {
            return $this->album;
        } else {
            //else we make a new album object
            if(!$this->albumMapper) {
                $this->albumMapper = new Music_Model_Mapper_Album();
            }
            //This is the album object we get from the id in our reference array.
            return $this->albumMapper->findById($this->getReferenceId('album'));
        }
    }
    //same as above only with the artist object.
    public function getArtist()
    {
        if(!is_null($this->artist) && $this->artist instanceof Music_Model_Artist) {
            return $this->artist;
        } else {
            if(!$this->artistMapper) {
                $this->artistMapper = new Music_Model_Mapper_Artist();
            }
            return $this->artistMapper->findById($this->getReferenceId('artist'));
        }
    }
    //the setters record the foriegn keys recorded in the table row to an array,
    //this allows the album and artist objects to be loaded only when needed.
    public function setAlbum($album)
    {
        $this->setReferenceId('album', $album);
        return $this;
    }

    public function setArtist($artist)
    {
        $this->setReferenceId('artist', $artist);
        return $this;
    }

  //standard setter and getters truncated...
}

so when using the track object you would get album or artist info like:

//this would be used in a controller most likely.
$mapper = new Music_Model_Mapper_Track();
$track = $mapper->findById('1');
//all of the information contained in the album or artist object is
//available to the track object.
//echo album title, year or artist. This album object also contains the artist object
//so the artist object would be available in two ways.
echo $track->album->title; //or
echo $track->artist->name;
echo $track->album->artist->name;
echo $track->getAlbum()->getArtist()->getName(); 
```

所以你真正需要决定的是你想如何构建你的应用程序。我认为显而易见的可能不是您希望实施的选项。您的问题的很多答案都取决于这些资源的确切使用方式。

我希望这至少对您有所帮助。

# mobile - 如何在 Web 应用程序中将 iPhone 从纵向变为横向时防止文本放大？

> ID：13690870
> 
> 赞同：0
> 
> 时间：2012-12-03T20:09:54.517
> 
> 标签：mobile, web, responsive-design

我正在创建我的第一个响应式网站，我遇到了麻烦，因为当 iPhone 处于纵向时，文本看起来不错，但是当转向横向时，文本、图像等都会放大并变大以适应屏幕。字体大小以像素为单位，所以它不应该保持不变吗？如何使它保持相同的大小并仅调整文本换行？我试图实现的一个例子是 iPhone 上的这个网站。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T11:34:23.253

这听起来像 iOS 方向错误。在视口元标记中设置最大比例有很多不正确的建议，这似乎可以解决它，但实际上会引入许多其他问题。您可能想查看工作区，[看看](http://filamentgroup.com/lab/a_fix_for_the_ios_orientationchange_zoom_bug/)这是否满足您的需求。

# php - session_cache_limiter private_no_expire ...表单和缓存

> ID：13690872
> 
> 赞同：0
> 
> 时间：2012-12-03T20:10:07.220
> 
> 标签：php

我遇到的问题是我必须继续删除缓存或表单没有提交任何新内容。例如，我在表单中输入了新数据并提交，但它没有插入到 mysql 中。我必须先删除缓存。

On`submit.php`是一种形式。 `done.php`从接收`$_POST`变量`submit.php` 。在顶部`done.php`我有`session_cache_limiter('private_no_expire');`。我有这个，所以当用户按下后退按钮并返回时`done.php`，他们不会收到页面过期消息。

我只添加`session_cache_limiter('private_no_expire');`了摆脱页面过期消息。有没有其他选择，所以当我用户按下后退按钮时，他们不会收到页面过期消息？...或者我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:23:11.127

一种替代方法是在提交失败或成功后将 301 重定向从表单处理器发送回 submit.php。这将防止在使用返回按钮时出现提示。它将跳过提交过程回到用户之前所在的任何页面（通常是 submit.php）。

不过，您必须修改 submit.php 中的逻辑来处理这种情况。您不想使用用户以前的条目重新填充表单字段，并且还能够显示有关表单未提交原因的任何错误消息。

处理此问题的一种方法是将所有表单提交和任何错误消息保存到会话中，并在重新显示 submit.php 时，检查会话中是否有任何表单数据。如果是这样，请使用会话中的先前条目重新填充表单字段，并同时显示会话中的任何错误消息。

**完成.php**

```
// validate form inputs here...

if (!$formIsValid) {
    // save $_POST values to $_SESSION
    // save any error message to $_SESSION
    header('Location: /submit.php');  // redirect back to form
    exit;
} else {
    header('Location: /success.php'); // redirect to success page
    exit;
} 
```

# ios - 为 UICollectionView 中的所有 UICollectionViewCell 设置动画

> ID：13690873
> 
> 赞同：5
> 
> 时间：2012-12-03T20:10:17.367
> 
> 标签：ios, uicollectionview

我想知道为 UICollectionView 中的所有单元格设置动画的好方法是什么。我正在尝试在 UICollectionView 中模拟编辑。所以我想做的是缩小 UICollectionViewCells 的所有边界。所以我所拥有的是：

```
- (IBAction)startEditingMode:(id)sender {
    [_items enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
        NSIndexPath *indexPath = [NSIndexPath indexPathForRow:idx inSection:0];
        UICollectionViewCell *cell = [self.collectionView cellForItemAtIndexPath:indexPath];

        [UIView animateWithDuration:0.25 animations:^{
            cell.layer.transform = CATransform3DMakeScale(0.9, 0.9, 1);
        }];
    }];
} 
```

它可以工作，但我不确定 UICollectionView 上是否有属性，或者有更好更标准的方法来做这样的事情。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-22T17:08:33.290

我会创建一个 UICollectionViewLayout 子类。添加一个名为editing 的BOOL 属性。编辑更改时，调用 invalidateLayout。然后在 -layoutAttributesForItemAtIndexPath: 方法返回的属性中，您可以指定一个变换。

您的方法的问题在于它仅影响可见单元格。UICollectionViewLayout 子类很好，因为即使添加了新单元格，它也会将转换应用于所有单元格。并且它将所有集合视图布局处理移出视图控制器。

单元格属性可以包括 frame、size、center、transform(3D)、alpha 和您自己的自定义属性。

您将按照 wL_ 的建议更改 -performBatchUpdates: 块中的编辑值。

```
- (IBAction)startEditingMode:(id)sender {
    [self.collectionView performBatchUpdates:^{
        ((MyCollectionViewLayout *)self.collectionView.collectionViewLayout).editing = YES;
    }
    completion:NULL];
} 
```

在 UICollectionViewLayout 子类中：

```
- (UICollectionViewLayoutAttributes *)layoutAttributesForItemAtIndexPath:(NSIndexPath *)indexPath
{
    UICollectionViewLayoutAttributes *attributes = [UICollectionViewLayoutAttributes layoutAttributesForCellWithIndexPath:indexPath];

    if (self.editing) {
        attributes.transform = CGAffineTransformMakeScale(0.9, 0.9);
    }
    else {
        attributes.transform = CGAffineTransformIdentity;
    }

    return attributes;
} 
```

另请注意，您（可能）在这里不需要 3D 变换。仿射变换就足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T23:43:11.577

你试过使用`UICollectionView performBatchUpdates:`吗？

就像是：

```
[collectionView performBatchUpdates:^{
    [_items enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
        NSIndexPath *indexPath = [NSIndexPath indexPathForRow:idx inSection:0];
        UICollectionViewCell *cell = [self.collectionView cellForItemAtIndexPath:indexPath];
        cell.layer.transform = CATransform3DMakeScale(0.9, 0.9, 1);
    }];
} completion:^{}]; 
```

# sql - SQL Server 2008 R2 DMV - sys.dm_sql_referencing_entities - 查询使用

> ID：13690879
> 
> 赞同：1
> 
> 时间：2012-12-03T20:10:54.587
> 
> 标签：sql, sql-server-2008-r2, dependencies, dmv

我正在尝试使用`sys.dm_sql_referencing_entities`DMV 获取表列表的所有依赖项。

这个查询给了我所有表的列表：

```
SELECT TableName from FinalTableList; 
```

这个查询给出了 TableA 的依赖关系：

```
SELECT  referencing_entity_name
FROM sys.dm_sql_referencing_entities ('dbo.TableA', 'OBJECT') ; 
```

我想将上述 2 组合到一个查询或过程中，以便我可以获得以下格式的所有依赖项：

```
TableA  Dependency1
        Dependency2
        Dependency3
TableB  Dependency1
        Dependency2
................... 
```

应该如何构建查询？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:23:20.580

这是您想要使用的一个很好的例子`cross apply`。这是一个例子：

```
SELECT  tablename, referencing_entity_name
FROM (select 'information_schema.columns' as tablename, 'object' as type) t cross apply
     sys.dm_sql_referencing_entities(t.tablename, t.type) 
```

在第一个子查询（称为`t`）中，您可以列出所有参数对。然后，`cross apply`将在他们每个人上运行该功能。

# visual-studio-2010 - 获取无效异常

> ID：13690881
> 
> 赞同：-1
> 
> 时间：2012-12-03T20:10:58.773
> 
> 标签：visual-studio-2010

System.InvalidOperationException 未处理 Message=创建表单时出错。有关详细信息，请参阅 Exception.InnerException。错误是：无法加载文件或程序集“Interop.WMPLib，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null”或其依赖项之一。试图加载格式不正确的程序。*Source=kn 日记StackTrace*：在 kn_diary.My.MyProject.MyForms.Create_Instance*ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Threading.ThreadHelper.ThreadStart() InnerException: System.BadImageFormatException Message=Could not load file or assembly 'Interop.WMPLib, Version=1.0.0.0, Culture=neutral , PublicKeyToken=null' 或其依赖项之一。试图加载格式不正确的程序。Source=AxInterop.WMPLib FileName=Interop.WMPLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null FusionLog==== 预绑定状态信息=== LOG: User = Pak-PC\Pak LOG: DisplayName = Interop.WMPLib，版本=1.0.0.0，文化=中性，PublicKeyToken=null（完全指定）日志：Appbase = file:///C:/Users/Pak/Desktop/project/kn diary/kn diary/bin/调试/日志：初始 PrivatePath = NULL 在 System.Threading.ThreadHelper.ThreadStart() InnerException 处运行（ExecutionContext executionContext，ContextCallback 回调，对象状态）：System.BadImageFormatException 消息=无法加载文件或程序集“Interop.WMPLib，版本=1.0.0.0，文化=中性，PublicKeyToken =null' 或其依赖项之一。试图加载格式不正确的程序。Source=AxInterop.WMPLib FileName=Interop.WMPLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null FusionLog==== 预绑定状态信息=== LOG: User = Pak-PC\Pak LOG: DisplayName = Interop.WMPLib，版本=1.0.0.0，文化=中性，PublicKeyToken=null（完全指定）日志：Appbase = file:///C:/Users/Pak/Desktop/project/kn diary/kn diary/bin/调试/日志：初始 PrivatePath = NULL 在 System.Threading.ThreadHelper.ThreadStart() InnerException 处运行（ExecutionContext executionContext，ContextCallback 回调，对象状态）：System.BadImageFormatException 消息=无法加载文件或程序集“Interop.WMPLib，版本=1.0.0.0，文化=中性，PublicKeyToken =null' 或其依赖项之一。试图加载格式不正确的程序。Source=AxInterop.WMPLib FileName=Interop.WMPLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null FusionLog==== 预绑定状态信息=== LOG: User = Pak-PC\Pak LOG: DisplayName = Interop.WMPLib，版本=1.0.0.0，文化=中性，PublicKeyToken=null（完全指定）日志：Appbase = file:///C:/Users/Pak/Desktop/project/kn diary/kn diary/bin/调试/日志：初始 PrivatePath = NULL 对象状态）在 System.Threading.ThreadHelper.ThreadStart() InnerException: System.BadImageFormatException Message=Could not load file or assembly 'Interop.WMPLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' 或其依赖项之一. 试图加载格式不正确的程序。Source=AxInterop.WMPLib FileName=Interop.WMPLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null FusionLog==== 预绑定状态信息=== LOG: User = Pak-PC\Pak LOG: DisplayName = Interop.WMPLib，版本=1.0.0.0，文化=中性，PublicKeyToken=null（完全指定）日志：Appbase = file:///C:/Users/Pak/Desktop/project/kn diary/kn diary/bin/调试/日志：初始 PrivatePath = NULL 对象状态）在 System.Threading.ThreadHelper.ThreadStart() InnerException: System.BadImageFormatException Message=Could not load file or assembly 'Interop.WMPLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' 或其依赖项之一. 试图加载格式不正确的程序。Source=AxInterop.WMPLib FileName=Interop.WMPLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null FusionLog==== 预绑定状态信息=== LOG: User = Pak-PC\Pak LOG: DisplayName = Interop.WMPLib，版本=1.0.0.0，文化=中性，PublicKeyToken=null（完全指定）日志：Appbase = file:///C:/Users/Pak/Desktop/project/kn diary/kn diary/bin/调试/日志：初始 PrivatePath = NULL BadImageFormatException Message=无法加载文件或程序集 'Interop.WMPLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' 或其依赖项之一。试图加载格式不正确的程序。Source=AxInterop.WMPLib FileName=Interop.WMPLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null FusionLog==== 预绑定状态信息=== LOG: User = Pak-PC\Pak LOG: DisplayName = Interop.WMPLib，版本=1.0.0.0，文化=中性，PublicKeyToken=null（完全指定）日志：Appbase = file:///C:/Users/Pak/Desktop/project/kn diary/kn diary/bin/调试/日志：初始 PrivatePath = NULL BadImageFormatException Message=无法加载文件或程序集 'Interop.WMPLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' 或其依赖项之一。试图加载格式不正确的程序。Source=AxInterop.WMPLib FileName=Interop.WMPLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null FusionLog==== 预绑定状态信息=== LOG: User = Pak-PC\Pak LOG: DisplayName = Interop.WMPLib，版本=1.0.0.0，文化=中性，PublicKeyToken=null（完全指定）日志：Appbase = file:///C:/Users/Pak/Desktop/project/kn diary/kn diary/bin/调试/日志：初始 PrivatePath = NULL 试图加载格式不正确的程序。Source=AxInterop.WMPLib FileName=Interop.WMPLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null FusionLog==== 预绑定状态信息=== LOG: User = Pak-PC\Pak LOG: DisplayName = Interop.WMPLib，版本=1.0.0.0，文化=中性，PublicKeyToken=null（完全指定）日志：Appbase = file:///C:/Users/Pak/Desktop/project/kn diary/kn diary/bin/调试/日志：初始 PrivatePath = NULL 试图加载格式不正确的程序。Source=AxInterop.WMPLib FileName=Interop.WMPLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null FusionLog==== 预绑定状态信息=== LOG: User = Pak-PC\Pak LOG: DisplayName = Interop.WMPLib，版本=1.0.0.0，文化=中性，PublicKeyToken=null（完全指定）日志：Appbase = file:///C:/Users/Pak/Desktop/project/kn diary/kn diary/bin/调试/日志：初始 PrivatePath = NULL*

 *# 调用程序集：AxInterop.WMPLib，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null。

LOG：此绑定在默认加载上下文中开始。LOG：使用应用程序配置文件：C:\Users\Pak\Desktop\project\kn diary\kn diary\bin\Debug\kn diary.vshost.exe.config LOG：使用来自 C:\Windows\Microsoft 的机器配置文件。 NET\Framework64\v2.0.50727\config\machine.config。LOG：此时未将策略应用于引用（私有、自定义、部分或基于位置的程序集绑定）。日志：正在尝试下载新的 URL 文件：///C:/Users/Pak/Desktop/project/kn diary/kn diary/bin/Debug/Interop.WMPLib.DLL。ERR：无法完成程序集的设置（hr = 0x8007000b）。探测终止。

```
 StackTrace:
        at AxWMPLib.AxWindowsMediaPlayer.AttachInterfaces()
        at System.Windows.Forms.AxHost.GetOcxCreate()
        at System.Windows.Forms.AxHost.TransitionUpTo(Int32 state)
        at System.Windows.Forms.AxHost.CreateHandle()
        at System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible)
        at System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible)
        at System.Windows.Forms.AxHost.EndInit()
        at kn_diary.Form1.InitializeComponent() in C:\Users\Pak\Desktop\project\kn diary\kn diary\Form1.designer.vb:line 91
        at kn_diary.Form1..ctor()
   InnerException: 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:28:37.010

This is an indication of failure to load one of the reference assemblies in the chain of references, in this case, an indirect reference. I normally check the fusion log to find out exactly what assembly is failing to load and often why.

Can you check the fusion log and paste the log here in case if you do not already spot the culprit there? You can lunch logger by running "fuslogvw.exe" from VS command prompt. (this link has more detail on how to use the fusion log viewer: [http://msdn.microsoft.com/en-us/library/e74a18c4(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/e74a18c4(v=vs.80).aspx))*

# javascript - 主干不渲染 $el 但可以直接引用元素

> ID：13690884
> 
> 赞同：0
> 
> 时间：2012-12-03T20:11:16.070
> 
> 标签：javascript, events, backbone.js, rendering

这让我很生气，正在阅读此站点上的示例，但无法弄清楚它为什么会这样工作。我想将值传递回我的视图，该视图具有可用于更改值的按钮。如果我使用以下

```
 this.$el.empty().html(view.el) 
```

View.el 包含正确的 html，但未在屏幕上呈现。如果我使用以下

```
 $("#handicap").html( view.el); 
```

值会显示在屏幕上，但即使我在 html 代码中添加了 onclick 函数，事件也不会再被拾取。

理想情况下，我想让 this.$el.empty().html(view.el) 工作。它与上下文有关，但不明白为什么。

我在这里创建了一个 jsbin [http://jsbin.com/iritex/1/edit](http://jsbin.com/iritex/1/edit)

如果我必须使用 $("#handicap").html(view.el)，我是否需要做一些特殊的事情来取消绑定事件。我试过取消所有的委托，但这也没有成功。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:28:44.600

Backbone View 的 el 属性将始终包含对有效 DOM 对象的引用。但是，该 DOM 对象可能在也可能不在您的显示树中。您可以确保它在需要时出现在显示树中。此功能允许 Backbone 保持其 View 元素的状态，而无需将其呈现到屏幕上。例如，您可以有效地在屏幕上添加和删除视图。

有几种方法可以将 View 的元素放入显示树中。

1) 通过将 jquery 选择器作为“el”属性传递给初始化程序，将视图与页面上现有的 DOM 元素相关联。

```
var view = new MyView({el: '#MyElementSelector'}); 
```

2) 通过将 jQuery 选择器硬编码到视图的“el”属性中，将视图与页面上现有的 DOM 元素相关联。

```
var MyView = Backbone.View.extend({
  el: '#MyElementSelector'
}); 
```

3）从另一个视图中将其渲染到页面

```
var view = new MyView();
view.render();
this.$el.empty().html(view.el); 
```

如果您有兴趣，我会在我整理 的[Backbone Demo中展示示例。](https://github.com/jamesor/backbone-demo)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:16:10.493

您需要将两个视图都放入 DOM。无论您在哪里创建上面的视图，都`this`需要将其插入到 DOM 中。如果你这样做，那么第一行就可以正常工作`this.$el.empty().html(view.el)`。

# ruby-on-rails - Ruby on Rails 中类似 Trello 的拖放“Stories”应用程序框架

> ID：13690885
> 
> 赞同：1
> 
> 时间：2012-12-03T20:11:16.893
> 
> 标签：ruby-on-rails, trello

出于学习目的，我想在 RoR 中构建一个应用程序，允许用户上传他们的“故事”，并通过拖放获取不同列表（或板）上的故事，例如仪表板上的小部件。最终目标与 Trello 非常相似。

您能否推荐一个适合这种学习努力的框架、gem、教程或起点？

谢谢你。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-03T20:57:46.990

您所描述的应用程序分为两个几乎独立的区域，您可能会在其中寻找宝石，但大多数功能实际上可以是标准 Rails。

对于拖放排序，您可能会查看[这些 (jQuery) 插件](http://www.knight.io/categories/drag-drop-sorting-nesting-js)。

如果您在此过程中遇到任何问题，请随时提出具体问题。

# java - 我的刚体碰撞代码如何不一致？

> ID：13690891
> 
> 赞同：2
> 
> 时间：2012-12-03T20:11:35.590
> 
> 标签：java, physics, collision, rigid-bodies

我一直在尝试复制此处找到的系统：[http ://www.myphysicslab.com/collision.html](http://www.myphysicslab.com/collision.html)

到目前为止，这是我的代码（对于击中无限大物体的情况，例如不可移动的墙）：

```
public static Orientation collide( float bodyMass_1, float bodyVelocityX_1, float bodyVelocityY_1, float bodyAngleMomentum_1 , float pointXFromCenterX_1, 
float pointYFromCenterY_1, float momentOfInertia_1,
float edgeNormalX, float edgeNormalY, float elasticity )
{
    Orientation returning;

    float outAngleMomentum_1;

    float outVelocityX_1, outVelocityY_1;

    float relativeNormal;
    float deltaParameter;

    float pointVelocityX_1, pointVelocityY_1;

    pointVelocityX_1 = bodyVelocityX_1 - bodyAngleMomentum_1 * pointYFromCenterY_1;
    pointVelocityY_1 = bodyVelocityY_1 + bodyAngleMomentum_1 * pointXFromCenterX_1;

    System.out.println( edgeNormalX );
    System.out.println( edgeNormalY );

    relativeNormal = (float) Funct3D.dotProduct( pointVelocityX_1, pointVelocityY_1,edgeNormalX, edgeNormalY );

    if ( relativeNormal < 0 )
    {

        deltaParameter = (-(1 + elasticity) *( (float) Funct3D.dotProduct( pointVelocityX_1, pointVelocityY_1, edgeNormalX, edgeNormalY ) ))/ 
        ( 1/bodyMass_1 + Funct3D.sqr( (float) Funct3D.perpDotProduct(pointXFromCenterX_1,pointYFromCenterY_1,edgeNormalX,edgeNormalY)) / momentOfInertia_1 );

        outVelocityX_1 = bodyVelocityX_1 + deltaParameter * edgeNormalX / bodyMass_1;
        outVelocityY_1 = bodyVelocityY_1 + deltaParameter * edgeNormalY / bodyMass_1;

        outAngleMomentum_1 = bodyAngleMomentum_1 + (float)     Funct3D.perpDotProduct(pointXFromCenterX_1, pointYFromCenterY_1,     deltaParameter*edgeNormalX, deltaParameter*edgeNormalY ) / momentOfInertia_1;

        returning = new Orientation( outVelocityX_1, outVelocityY_1, outAngleMomentum_1 );
    }
    else
    {
        System.out.println( "NO COLLISION" );
        returning = new Orientation( bodyVelocityX_1, bodyVelocityY_1, bodyAngleMomentum_1 );
    }
    return returning;
} 
```

我的代码的结果通常导致速度没有通过法线反映，或者完全缺乏动量守恒。即使我有它只是让它在执行后立即输出结果，结果表明它不是多次注册碰撞的问题，它也会在第一次运行时发生。

`dotProduct`返回两个向量的点积。

`perpDotProduct`返回两个向量的 perp 点积

如果您需要任何解释，或者如果您想请求扩大代码范围，请随时提出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:29:57.070

对于这种任务，我建议编写一个简单的测试，将输入参数传递给`collide`方法并期望`Orientation`使用已知有效的值。

您可以使用 JUnit 框架或简单`main`方法：

```
Orientation orientation = collide(a, b, c, d, ...);
assertEquals(KNOWN_X, orientation.getX());
assertEquals(KNOWN_Y, orientation.getX());
assertEquals(KNOWN_MOMENTUM, orientation.getMomentum()); 
```

使用此代码，您可以调试您的方法并检查算法的每个步骤中的值是否正确。然后您可以使用一组新的已知输入和输出值检查算法。

还要考虑清理您的代码并将重复计算移至局部变量（即`deltaParameter * edgeNormalX`）

# php - 使用 YAML 替换较小的 SQL 表？

> ID：13690894
> 
> 赞同：3
> 
> 时间：2012-12-03T20:12:22.247
> 
> 标签：php, mysql, symfony, yaml

`Symfony`让我了解了[YAML](http://symfony.com/doc/2.0/components/yaml.html)的力量。过去，我默认使用 MySQL 为电子商务网站制作表格`supported_countries`，`units_of_measure`或者`sku_conditions`. 但现在，我可能更喜欢使用`YAML`来创建`config/countries.yml`,`config/units.yml`或`config/skuConditions.yml`. 所以我很好奇——在这种情况下，在决定**解析和分析 YAML 文件时是否需要考虑重要的性能因素 ~ 与 ~ 查询和分析 SQL 数据？**

## 国家.yml

```
US:
    code: US
    name: United States
CA: 
    code: CA
    name: Canada 
```

## skuConditions.yml

```
default-unit: new
units
    new:
        short: new
        long: brand spanking new
        description: never been used.
    open-box:
        short: open
        long: pretty much new
        description: the box has been opened but never used. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:18:57.940

我认为 YAML 非常适合配置文件，Symfony 就是这样使用它的，但是如果你的数据变化很大，你需要一个数据库。如果您担心性能，请考虑使用像 MongoDB 这样的 NoSQL 数据库。

# android - 正确处理绘制多个对象？

> ID：13690895
> 
> 赞同：0
> 
> 时间：2012-12-03T20:12:30.673
> 
> 标签：android, opengl-es, opengl-es-2.0

虽然我在技术上使用 OpenGL 2.0 ES 在 android 平台上工作，但我相信这可以应用于更多的 OpenGL 技术。

我有一个我试图在网格上绘制的对象（敌人、角色等）列表，每个空间都是 1x1，并且每个对象都匹配。目前，每个对象都是自我平移的……也就是说，它获取其模型坐标并通过一个简单的循环将它们调整为位于其适当网格位置的世界坐标中。（即，如果它应该在 (3,2) 处，它将相应地转换它的坐标。

我遇到的问题是我不确定如何有效地绘制它们。我有一个循环遍历所有对象并为每个对象调用 draw，类似于 android 教程，但这似乎非常低效。

每个对象都有自己的方形图像纹理，与它们填充的 1x1 网格相匹配。他们可能永远不需要自己独特的着色器，因此对象之间唯一变化的似乎是顶点和着色器。

有没有一种有效的方法可以让每个模型进入管道而不会因为统一的变化而刷新？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T05:36:28.617

这可能需要一些尝试和错误过程，并且可能取决于硬件。我会使用带有 GL_STATIC_DRAW 的网格的缓冲区对象，将一些纹理打包成一个更大的纹理，并根据该更大的纹理批量绘制所有对象，以尽可能避免状态变化。分析并让我们了解您的瓶颈在哪里的更多信息。

# jquery - 带有 jquery css 的自定义选择框滚动条 - 是否有跨浏览器兼容的解决方案？

> ID：13690907
> 
> 赞同：3
> 
> 时间：2012-12-03T20:13:04.840
> 
> 标签：jquery, css, select, listbox, scrollbars

我已经搜索了几个小时，发现了 0 个带有自定义滚动条/箭头的框的示例。我可以找到一些人谈论它是不可能的，最好的想法是不这样做。

除了这些建议之外，是否有跨浏览器兼容的解决方案？有谁知道目前使用自定义滚动条的任何网站，所以也许我可以查看该代码？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:17:46.640

通常，该元素会被一组精心设计的s 和and`<select>`即时替换，使其隐藏，并在您的 s 上添加一些事件委托，因此您可以在 hidden 中选择真正的选项。`<div>``<ul>``<li>``<li>``<select>`

例如，它看起来像这样：

```
 $(function(){
    $('select:visible').each(function(){
       var 
          $this = $(this), 
          $select = $('<div/>', {
            'css':{
              'display': 'inline-block',
              'position': 'relative'
            }
          }),
          $items, $ul,
          $display = $('<p/>');

       $this.hide();
       $items = $this.find('option').map(function(){ return '<li data-value="'+this.value+'">'+$(this).text()+'</li>'; }).get().join(''); // map the options from the select in an html string

       $ul = $('<ul/>', {
         'css':{
           'display':'none',
           'position':'absolute',
           'bottom': '0',
           'width': 'inherit'
         }
       });

       $ul.append($items); // append the items from the original select

       $select.append($display).append($ul); // create the "fake" select
       $this.before($select);

       $ul.on('click', 'li', function(e){
          $display.text($(e.target).text()); // set the text of your select
          $this.val($(e.target).data('value')); // set the value of the original select that is hidden
       });

       $select.click(function(){
         $ul.toggle(); // show/hide the items
       });
    });
 }); 
```

我现在创建了这段代码，但还没有测试过，但这就是想法。所有样式（CSS）都由您决定。只需确保为 LI 设置类，`white-space: nowrap;`以便它可以根据需要进行扩展。

现在有了所有这些自定义 HTML，您可以添加自己的箭头，对于滚动条，您可以使用现有的解决方案，如 jScrollpane 并附加到`$ul`包含您的项目的您的项目上，提醒您为其设置`max-height`css 样式以使其生效。

# php - 如何选择最近的 ineger，这比你得到的值大

> ID：13690908
> 
> 赞同：-1
> 
> 时间：2012-12-03T20:13:03.720
> 
> 标签：php, mysql, select

如何选择最接近的整数，这比你得到的值大？如何按要求制作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:17:24.077

怎么样

```
SELECT * 
FROM yourTable 
WHERE yourColumn > yourInt 
ORDER BY yourColumn
LIMIT 1 
```

这将选择你的第一个更大的数字

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:14:22.317

我认为以下内容适用于正整数：

```
$next_num = intval($your_num) + 1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:15:19.843

PHP的`ceil()`函数应该为你做这个

[http://php.net/manual/en/function.ceil.php](http://php.net/manual/en/function.ceil.php)

# wpf - 将 WPF 画布呈现为特定大小的位图

> ID：13690909
> 
> 赞同：0
> 
> 时间：2012-12-03T20:13:05.867
> 
> 标签：wpf, scaling, rendertargetbitmap

我有一个想要制作位图的 WPF 画布。

具体来说，我想在 300dpi 位图上渲染它的*实际大小。*画布上对象的“实际大小”在现实生活中是 10 个[设备独立像素](http://msdn.microsoft.com/en-us/library/ms748373.aspx)= 1"。理论上，WPF 设备独立像素为 96dpi。

我花了几天的时间试图让它发挥作用，但我感到困惑。

我的理解是，一般程序大致是：

```
var masterBitmap = new RenderTargetBitmap((int)(canvas.ActualWidth * ?SomeFactor?),
                                          (int)(canvas.ActualHeight * ?SomeFactor?),
                                          BitmapDpi, BitmapDpi, PixelFormats.Default);
masterBitmap.Render(canvas); 
```

并且我需要将画布的 LayoutTransform 设置为 ScaleTransform 吗？SomeOtherFactor？然后对画布进行测量和排列到？SomeDesiredSize？

我坚持的是什么用于？SomeFactor？，？SomeOtherFactor？和？SomeDesiredSize？使这项工作。 [MSDN 文档](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.rendertargetbitmap.aspx)没有说明要使用哪些因素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:40:45.927

我使用此代码以 1:1 像素精度显示图像。

```
double dpiXFactor, dpiYFactor;  
Matrix m = PresentationSource.FromVisual(Application.Current.MainWindow).CompositionTarget.TransformToDevice;
if (m.M11 > 0 && m.M22 > 0)
{
    dpiXFactor = m.M11;
    dpiYFactor = m.M22;
}
else
{
    // Sometimes this can return a matrix with 0s.
    // Fall back to assuming normal DPI in this case.
    dpiXFactor = 1;
    dpiYFactor = 1;
}

double width = widthPixels / dpiXFactor;
double height = heightPixels / dpiYFactor; 
```

不要忘记在控件上启用 UseLayoutRounding。

# mysql - Drupal 用户数据存储位置

> ID：13690912
> 
> 赞同：0
> 
> 时间：2012-12-03T20:13:08.443
> 
> 标签：mysql, drupal

Drupal 7 在哪里存储用户数据？我相信我们的客户一直在将从 MS Word 复制的错误数据（不正确的字符）插入到他们的 Drupal 安装中（用于他们的用户列表）。

如何导出/查看用户以查看其中是否有坏字符？

我正在查看 MySQL 中数据库的结构，但没有看到任何包含数据的清晰表。它是仅包含在一个表中还是多个表中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T21:59:53.067

用户数据存储在多个表中，其中一个是`users`表。已添加到用户实体的任何字段都将在`field_data_field_user...`表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-08T21:04:25.367

如果您使用 phpMyAdmin 或类似界面，您将只能立即看到 Drupal 拥有的部分表。使用过滤器查找“用户”，用户表将出现在列表中。如果没有对自定义用户字段进行修改，则只有一个表。

您可以将表格导出为 CSV 并在电子表格界面中打开，例如 Excel；尽管 Excel 并不总是对 UTF-8 友好，如果它没有设置为显示它。或者，您可以将文件保存为 .SQL 并在数据库查看器（例如 Firefox 中的 SQLite）中查看。

# wordpress - 通过wordpress用simplepie显示视频？

> ID：13690914
> 
> 赞同：0
> 
> 时间：2012-12-03T20:13:22.813
> 
> 标签：wordpress, simplepie

我正在通过这个客户的网站[http://www.redvaultproductions.com/Latest.php](http://www.redvaultproductions.com/Latest.php)展示一个 wordpress 提要，但视频没有显示在帖子中。

请注意第二个（当我写这篇文章时）帖子“Mount Bachelor, Oregon”，它在 wordpress 上有一个视频 - 在这里可以看到[http://redvaultproduction.wordpress.com/2012/11/14/mount-bachelor-oregon/](http://redvaultproduction.wordpress.com/2012/11/14/mount-bachelor-oregon/) -但不在我客户的网站上。

这是文档顶部的内容

```
<?php
require_once('autoloader.php');

$feed = new SimplePie();

$feed->set_feed_url('http://redvaultproduction.wordpress.com/feed/');

$feed->enable_cache(true); 
$feed->set_cache_location('cache'); 
$feed->set_cache_duration(120);

$feed->init();

$feed->handle_content_type();

?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"> 
```

这是每个帖子的文件上的内容。

```
<?php
 $item = $feed->get_item() ?>
<div class="postTitleTop"><br />
<?php print $item->get_title(); ?></div>
<?php print $item->get_content(); ?> 
```

谁能帮忙解释一下？我找不到这方面的任何信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-05T20:30:44.397

SimplePie 自动删除这些 HTML 标签：'base'、'blink'、'body'、'doctype'、'embed'、'font'、'form'、'frame'、'frameset'、'html'、'iframe' , '输入', '选框', 'meta', 'noscript', 'object', 'param', 'script', 'style'。

您必须指定不想删除的标签，如下所示：

```
$feed = new SimplePie();
$feed->set_feed_url('http://simplepie.org/blog/feed/');

// Remove these tags from the list
$strip_htmltags = $feed->strip_htmltags;
array_splice($strip_htmltags, array_search('object', $strip_htmltags), 1);
array_splice($strip_htmltags, array_search('param', $strip_htmltags), 1);
array_splice($strip_htmltags, array_search('embed', $strip_htmltags), 1);

$feed->strip_htmltags($strip_htmltags);

$feed->init();
$feed->handle_content_type();
echo $feed->get_title(); 
```

[http://simplepie.org/wiki/reference/simplepie/strip_htmltags](http://simplepie.org/wiki/reference/simplepie/strip_htmltags)

# c++ - 关于 C++ 中 Class 的私有成员

> ID：13690917
> 
> 赞同：1
> 
> 时间：2012-12-03T20:13:29.253
> 
> 标签：c++, arrays, private

我对 C++ 中 Class 的私有成员有疑问：

我有一个这样定义的类：

```
class Hello
{
   private:
      int a[2][2] = {{1,1},{2,2}};
   public:
      int* getA();
} hello; 
```

`a`是一个数组，它是类 hello 的私有成员，它被保护不能从类外部访问，但是如果我使用`getA()`这样的方式返回数组 a 的地址：

```
int* Hello::getA()
{
   return &a[2][2];
} 
```

并且在类之外`hello`使用一个变量来保持这样的地址`a[2][2]`：

```
int* i = getA(); 
```

有`i`地址`a[2][2]`吗？我们可以像这样修改`array`类的外部吗？**仍然受****关键字保护****吗？`a[2][2]``private`**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-03T20:15:21.443

发生的情况是您返回了一个指向私有成员的指针。一旦调用者有了那个指针，他们就可以自由地修改指向的数组元素。没有保护，`private`也不再相关。

此外，您无法控制调用者对该指针的操作，或者他们持有该指针的时间。如果`a`您需要强制执行某些不变量，则不能。如果`a`是动态分配的并且您需要重新分配它，则不能。

这很好地说明了为什么将指针泄漏到私有成员中通常不是一个好主意。

（在这里，我假设您打算返回一个指向有效元素的指针；`a[2][2]`超出范围。）

> 如果我不想修改值，只想读取数组的值，有更好的方法吗？

在这种情况下，要么通过值返回元素，要么通过`const`引用返回元素（你也可以通过`const`指针返回它，但这会给调用者带来不必要的尴尬）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:26:26.350

据我所知，您必须为二维数组返回一个双指针。

```
int ** Hello::getA()
{
    &a[0][0];
} 
```

你可以自由地做

```
 myHello.getA()[1][1] = value; //better use pointer just in place than storing it anywhere anyway. 
```

顺便说一句，数组是基于 0 的索引，所以如果你声明

```
int a[5]; 
```

最大可寻址索引是 a[4] （你有 5 个内存位置从 0 开始而不是 1.. 所以你有 a[0],a[1],a[2],a[3],a[4] ）。

无论如何，在您知道自己在做什么之前，返回原始指针并不是很好的做法。

另请注意，返回

```
return &a[1];// is wrong (if you have a[2]) 
```

因为如果你这样做

```
Hello.getA()[1]; 
```

实际上，您正在尝试访问 a[2]，而 a[2] 无效，因为您最多有 a[1]（a[1] 是第二个值，a[1] 再次表示第二个值第二个值是第三个值！）

..如果你很幸运，那只会给你一个分段错误。如果你不走运，你将不得不搜索和调试为什么你会在某些时候得到未定义的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:16:03.213

发生的情况是您遇到**未定义的行为**，因为`&a[2][2]`访问了无效的索引。

除此之外，`private`它主要是程序员的关键字 - 它不强制执行运行时检查。

# javascript - 将模型类型设置为在主干中具有外部 url 的集合

> ID：13690931
> 
> 赞同：2
> 
> 时间：2012-12-03T20:14:49.287
> 
> 标签：javascript, jquery, backbone.js, backbone.js-collections

我正在创建一个具有如下外部 url 的集合：

```
var todoCollection = Backbone.Collection.extend({
    model: Todo

    url: function() {
        return "http:externalurl.com";
    },

    parse: function(dat) {
        return dat.obj.data;
    }
});
return new todosCollection;​ 
```

我的模型看起来像这样：

```
var TodoModel = Backbone.Model.extend({
    initialize: function() {}
});
return TodoModel;​ 
```

现在在我看来，我以这种方式使用集合：

```
$.each(this.collection.models,function(i,model){
      console.log(model);
}) 
```

问题是，我的模型没有设置为 TodoModel 类型。它们是简单的对象类型。有人可以帮我告诉我这里哪里出错了吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:20:01.433

我不认为你是正确的。`console.log`可能会说它是一个对象，但几乎可以肯定它是您的模型的一个实例。此外，如果您的示例中的代码是您的真实代码，那么它会被破坏，因为您正在使用`each`带有向后参数的函数并且您正在使用`Todo`您应该使用的地方`TodoModel`。

```
this.collection.each(function (model) {
  console.log(model instanceof TodoModel);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T16:51:05.067

我想你只是有一个错字。`model: Todo`应该`model: TodoModel`

# playframework - Play 2 上的 LESS 编译速度非常慢

> ID：13690936
> 
> 赞同：10
> 
> 时间：2012-12-03T20:15:01.253
> 
> 标签：playframework, playframework-2.0, less

在我新安装的 Play 2 中，LESS 编译真的很慢。即使在不需要直接编译的文件上放置“_”后，LESS 编辑后的页面刷新也需要大约 8 秒才能完成。这与使用 Codekit 不到一秒的本地编译相比。

有关加快此过程的任何建议？是否值得向 Play 提交一个错误来查看这个问题？

以下是我的文件大小的详细信息： 我的 LESS 设置非常简单。_reset.less (.5k) _desktop.less (13k)、_tablet.less (10k)、_mobile.less (8k)、_sprites.less (25k) 文件。将所有内容放在一起的 all.less (.3k) 文件。就是这样。生成的 css 文件为 53k。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-12T22:38:41.717

我写了一篇关于这个问题的小调查。你可以在[这里](http://brizzled.clapper.org/blog/2012/12/12/play-framework-less-vs-sass-recompilation-performance/)找到它。

底线：通过切换到 Sass，我获得了更快的性能。这并不难。使用 [Play-Sass](https://github.com/jlitola/play-sass) SBT 插件，如果您使用的是 Bootstrap，请使用[sass-twitter-bootstrap](https://github.com/jlong/sass-twitter-bootstrap) 项目中的 SASS Bootstrap 文件。

通过命令预编译 LESS 文件`lessc`是另一种解决方案，而且速度非常快。

假设您的项目使用 Bootstrap，使用预编译的 Bootstrap，而不是 Bootstrap LESS 文件，也是一个巨大的胜利，因为当其中一个文件发生更改时，Play LESS 编译器会重新编译*所有*LESS 文件，而 Bootstrap 相当大。但是，对于我们中的一些人来说，使用预编译的 Bootstrap 很不方便......

使用 Play 2.0 基于 Rhino 的按需 LESS 编译是最慢的选择。事实上，猪慢。并忽略我对`incrementalAssetsCompilation`. 它已记录在案，但似乎不在 2.0.x 代码库中。

**编辑**（2013 年 5 月 22 日）[Jonathan Parsons](https://github.com/jmparsons/)已经将一个*play-lessc*插件放在一起，该插件使用该`lessc`命令来编译 LESS 文件。它可以显着减少 Play 项目中的 LESS 编译时间。见[https://github.com/jmparsons/play-lessc](https://github.com/jmparsons/play-lessc)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-23T12:10:08.493

这将大大减少编译时间：

```
export SBT_OPTS="$SBT_OPTS -Dsbt.jse.engineType=Node" 
```

它使 Play 在运行 JavaScript 时使用 Node 而不是 Rhino。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-26T18:19:08.983

从 Play Framework 2.3 开始，你可以使用 node.js 作为默认的 JavaScript 引擎，用于少编译、js lint、CoffeeScript 等。

下载并安装 node.js ( [https://nodejs.org](https://nodejs.org) ) 库并放置

```
JsEngineKeys.engineType := JsEngineKeys.EngineType.Node 
```

构建.sbt。

[参考 #1](https://github.com/sbt/sbt-js-engine/blob/master/README.md "参考1") - [参考 #2](https://www.playframework.com/documentation/2.4.x/Assets#Managed-assets "参考文献 2")

# caching - CakePHP 缓存不写入文件

> ID：13690937
> 
> 赞同：0
> 
> 时间：2012-12-03T20:15:01.317
> 
> 标签：caching, cakephp-2.0

我无法弄清楚这个......这意味着它必须是一个简单的，对吧？！

问题：Cake 没有将文件写入文件缓存。

配置：

```
//app/Config/core.php

Configure::write('debug', 0);

Configure::write('Cache.disable', true);

Configure::write('Cache.check', true);

//app/Config/bootstrap.php

Cache::config('default', array('engine' => 'File'));

//app/Controller/CategoriesController.php, 'view' method:

public function view($id = null) {

$this->helpers[] = 'Format';
$this->helpers[] = 'Cache';
$this->cacheAction = "3600";    

....
} 
```

app/tmp/cache/* 上的权限是 0777。世界可写。

但仍然没有文件被写入缓存......我错过了什么？

DJC

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:16:38.220

```
Configure::write('Cache.disable', true); 
```

你不知道为什么缓存没有被写入......？

# vb.net - 将文本格式化成列

> ID：13690939
> 
> 赞同：0
> 
> 时间：2012-12-03T20:15:14.300
> 
> 标签：vb.net, string, visual-studio-2010

很久没有用 VB.NET 写程序了，现在我想写一个 WinForm 应用程序。我有几个字符串，我想把它们放在一起，以便它们可以添加到`ListView`控件中。

我有这个：

```
text1 = ("00 | 34123 | 232")
text2 = ("023 | 233 | 23332 ")
text2 = ("00 | 2342432 | 122 ") 
```

但我想要这个：

```
text1 = ("00     |     34123       |  232   ")
text2 = ("023    |     233         |  23332 ")
text2 = ("00     |     2342432     |  122   ") 
```

请注意，每个数字都是一个字符串变量，因此每个数字都可以是：“12”或“123”或“1234”......我怎么能这样做！？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:21:10.783

您想使用[String.PadRight](http://msdn.microsoft.com/en-us/library/34d75d7s.aspx)方法。

示例用法：

```
Dim result = "00".PadRight(7) & "|    " _
             & "34123".PadRight(12) & "|  " _
             & "232".PadRight(6) 
```

在这种情况下，这种`String.Format`方法甚至更好。请注意，要使这两种方法都起作用，您需要使用固定宽度的字体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:25:14.603

```
Public Function ToFixedColumns(ByVal input As String) As String
    'Separate individual items 
    Dim values = input.Split("|"c).Select(Function(s) s.Trim()).ToArray()

    'Validate split operation
    If values.Length <> 3 Then 
        Throw New InvalidArgumentException("The string was not in the correct starting format.")
    End If

    'Create new formatted string
    Return String.Format("{0,-6} |     {1,-12}  |  {2,-6}", _
           values(0),values(1),values(2))
End Function 
```

# jquery-mobile - Jquery Mobile 正在加载什么页面

> ID：13690941
> 
> 赞同：0
> 
> 时间：2012-12-03T20:15:17.057
> 
> 标签：jquery-mobile

我的任务是在 Jquery Mobile 中的 pagechange 上执行特定页面 javascript（例如在一个页面上定位用户或在另一个页面上显示 Google 地图）

它真的不清楚如何在页面更改后执行 javascript 但我快到了，我能够使用

```
$(document).bind('pageinit', function(event){

    loadGmaps();
    geolocate();

}); 
```

但问题是此代码在每个页面更改/页面初始化时执行，如果我不在具有#map 标签的页面上，它只会执行代码。最差？Jquery 将页面加载到内存中但隐藏它们。因此，如果我更改页面，它可以连续 16 次重新加载地图。

对于您应该如何在 jquery 移动加载页面中绑定特定页面 javascript，我真的很困惑。我潜伏在网络上，我敢肯定我不是唯一一个在寻找那个特定技巧的人......

谢谢

* * *

**编辑**

我更改了代码以反映 Jasper 的解决方案，除了地理位置之外它工作正常：

```
$(document).on('pageinit', '#wp-post-id-70', function(event){
    geolocate();
});
$(document).on('pageinit', '.wp-post-type-spa', function(event){
    loadGmaps();
}); 
```

地图在我访问的每个水疗页面上都可以正常加载，但是当我从新加载的水疗页面加载时，如果我单击徽标返回主页，它会加载主页然后触发“ geolocate”功能，但在地理位置方面没有任何反应：

```
function geolocate()
{
    if (navigator.geolocation) { 
        navigator.geolocation.getCurrentPosition(
            function(position){
                $('#near_spa').load('?latitude='+position.coords.latitude.toString()+'& longitude='+position.coords.longitude.toString()+' #near_spa > *');
            }
        );
    }else{ 
        alert('Votre navigateur ne supporte pas la géolocalisation ou refuse l\'accès aux données de localisation');
    }
} 
```

代码真的上升到 navigator.geolocation.getCurrentPosition，它被调用，但随后 pffff，什么都没有。如果我用 F5 手动重新加载主页，我现在会收到地理定位请求...

* * *

**编辑**

别介意“地图”在每一页上都加载得很好，它不再是了，可能是我和我的大脑太累了……

因此，

```
$(document).on('pageinit', '.wp-post-type-spa', function(event){
    loadGmaps();
}); 
```

根本不再加载地图，是的，我验证了，这些页面确实具有 wp-post-type-spa 类...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:43:58.353

如果你的代码每个伪页面只运行一次，那么使用`pageinit`事件，每次将伪页面添加到 DOM 时它只运行一次。

您还可以在通话中定位特定的伪页面`bind`：

```
$(document).on('pageinit', '#some-map-page', function(event){

    loadGmaps();
    geolocate();

}); 
```

只有当`pageinit`事件在 ID 为 的元素上触发时才会运行`some-map-page`。例如，您可以向要运行地图代码的每个伪页面元素添加一个类：

```
<div data-role="page" id="some-map-page" class="map-page">...</div> 
```

这将与以下事件绑定一起使用：

```
$(document).on('pageinit', '.map-page', function(event){

    loadGmaps();
    geolocate();

}); 
```

请注意，我使用`.on()`的是委托事件处理程序，这在使用 jQuery Mobile 时非常有用，因为您无法确定 DOM 中何时存在伪页面。

# c# - pushsharp 在尝试发送苹果通知时抛出一个模棱两可的错误

> ID：13690944
> 
> 赞同：0
> 
> 时间：2012-12-03T20:15:45.200
> 
> 标签：c#, apple-push-notifications

这些是我能看到的唯一异常细节：

> PushSharp.Apple.NotificationFailureException：引发了“PushSharp.Apple.NotificationFailureException”类型的异常。

当我运行该方法从我的开发桌面实际排队通知时，它工作正常。当我将代码发布到我的服务器时，它才开始失败。有趣的是，它在服务器上正常工作了大约 2 周，然后就停止了工作。我承认我已经对这个应用程序中的许多代码进行了一些更改，但没有任何内容会因苹果通知而动摇船。不幸的是，我无法获得有关该异常的更多详细信息，也无法获得它被抛出服务器的原因。我试图在这个应用程序上增加 elmah，但是当抛出异常时，elmah 甚至没有触发。我也没有看到 YSOD，我只能在查看 NLog 生成的日志时看到异常。

有人在这里有什么想法吗？

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T20:03:47.493

事实证明其中一个 iOS 设备令牌是坏的。我仍然不确定为什么我的循环由于一次通知失败而被炸毁，但这就是原因所在。

pushsharp 真的可以使用一些更好的异常处理。

# java - 如何在配置文件而不是代码中在客户端为 WCF 服务配置用户 ID/密码

> ID：13690945
> 
> 赞同：0
> 
> 时间：2012-12-03T20:15:46.240
> 
> 标签：java, wcf, binding, wsdl

要求是调用 Java Web 服务。提供了一个 WSDL。呼叫以不安全的方式成功。现在需要对服务调用进行身份验证。服务调用将仅通过特定的 Windows 用户名/密码成功。由于我们应用程序中的所有内容都是基于配置的，因此我们不想在代码中硬编码任何内容。欣赏是否有人可以展示如何做到这一点？

顺便说一句，我有这个配置......

```
 <basicHttpBinding>

        <binding name="MyBinding" closeTimeout="00:01:00"
                    openTimeout="00:01:00" receiveTimeout="00:30:00" sendTimeout="00:10:00"
                    allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
                     maxBufferSize="2147483647" maxBufferPoolSize="2147483647" maxReceivedMessageSize="2147483647"
                    messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
                    useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
              maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="None">
            <transport clientCredentialType="None" proxyCredentialType="None" 
                realm="" />
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>

  </basicHttpBinding> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:56:05.910

您不能在 WCF 特定配置中的任何位置设置用户名/密码。但是，您可以将用户名/密码对设置为应用程序设置，从代码中检索它们，然后在 WCF 客户端中进行设置。

```
<configuration>
  <appSettings>
    <add key="UserName" value="My user name" />
    <add key="Password" value="Your secret password" />
  </appSettings>
</configuration> 
```

并在代码中：

```
var username = ConfigurationManager.AppSettings["UserName"];
var password = ConfigurationManager.AppSettings["Password"];
client.ClientCredentials.UserName.UserName = username;
client.ClientCredentials.UserName.Password = password; 
```

# php - 在一个数组php中获取多个子字符串匹配

> ID：13690946
> 
> 赞同：0
> 
> 时间：2012-12-03T20:15:47.627
> 
> 标签：php, regex

我正在尝试查找包含特定子字符串的数组的所有行。

我有一个包含我所有产品编号或 SKU 的数组。

我有另一个数组，其中包含在目录及其许多子目录中找到的图像路径。

（这个图像路径数组使用遍历目录并将所有文件路径添加到该数组的 RecursiveIterator 填充）

每个图像名称都包含其中的 SKU，因此 sku# 123 可能具有以下图像：
123.jpg
123_1.jpg
123_2.jpg
等等等等。

我想输出与特定 sku 关联的所有图像。这是我开始的代码。出于某种原因，我只得到了最后一个 sku 的预期结果。

```
$dir = "./images";          // directory with images
$skus = file("./source.csv");   // source file with all skus
$all_images = array();      // array to hold all image paths found in folder

// recursively search through directory save all file paths to array
foreach (new RecursiveIteratorIterator(new RecursiveDirectoryIterator($dir)) as $f) {
 $all_images[] = $f;   
}

// loop through each sku and find its image paths
for($i=0; $i < count($skus); $i++){
    $values = preg_grep("/$skus[$i]/", $all_images);
    echo "----sku: $skus[$i] -----<br /><br />";

    foreach($values as $val)
        echo "Values: $val<br />";  
} 
```

我的结果页面如下所示：

```
----sku: TR450 -----

----sku: TR451 -----

----sku: TR452 -----

----sku: TR453 -----

----sku: TR454 -----

----sku: TR455 -----

----sku: TR456 -----

Values: ./images\brand\make\TR456 - abacus\TR457.jpg
Values: ./images\brand\make\TR457 - abacus\TR457_Diagram.jpg
Values: ./images\brand\make\TR458 - abacus\Thumbs.db 
```

我不确定为什么这仅适用于最后一个 SKU？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:25:35.250

尝试在变量中设置您的模式并将变量传递给`preg_grep`.

```
$pattern = '/'. $skus[$i] . '/';
$values = preg_grep($pattern, $all_images); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T17:13:34.580

通过发现 $skus 末尾都有空格，我设法解决了这个问题。不知道空间是如何进入那里的，但这导致模式无法被识别！

```
('sku123 ' != 'sku123') 
```

这是我的代码：

```
$dir = "./images";              // directory with images
$skus = file("./source.csv");   // source file with all skus
$skus = array_filter(array_map('trim', $skus)); // this is the only new line, 
                                                //it removes white space after the sku
                                                // so the pattern below can actually work.
$all_images = array();      // array to hold all image paths found in folder

// recursively search through directory save all file paths to array
foreach (new RecursiveIteratorIterator(new RecursiveDirectoryIterator($dir)) as $f) {
 $all_images[] = $f;   
}

// loop through each sku and find its image paths
for($i=0; $i < count($skus); $i++){
    $values = preg_grep("/$skus[$i]/", $all_images);
    echo "----sku: $skus[$i] -----<br /><br />";

    foreach($values as $val)
        echo "Values: $val<br />";  
} 
```

# jquery - JSON字符串化循环结构错误

> ID：13690955
> 
> 赞同：0
> 
> 时间：2012-12-03T20:16:34.457
> 
> 标签：jquery, json

在下面的代码中，对于每个工作人员，我试图获取他们监督的组的 group_id 列表，然后我想对包含这些 id 的数组进行字符串化并将其发送出去以更新数据库。

但是，当我尝试对映射数组进行字符串化时，出现关于转换循环结构的错误。我不太明白下面代码中的循环是什么。

任何帮助深表感谢。

```
$(".staff_member").each(function() {
        var staff_id = $(this).attr("staff_id");

        var newarr = $(this).find(".staff_groups .staff_group").map(function() {
            return $(this).attr("group_id");
        });
        alert(JSON.stringify(newarr));
        $.post(
            "staff_update.php",
            { staff_id: staff_id, groups: newarr },
            function(data) {
                var response = jQuery.parseJSON(data);
                if(response.code == "success") {
                    alert("Done!");
                } else if(response.code == "failure") {
                    alert("Failure!");
                }
            }
        );
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:19:44.397

首先将其转换为数组..`.map()`返回一个**jQuery 对象**

```
var newarr = $(this).find(".staff_groups .staff_group").map(function() {
            return $(this).attr("group_id");
        }).get() ; 
```

# amazon-ec2 - 如何引用其他ec2实例？Elastic IP 是唯一可行的解 决方案吗？

> ID：13690957
> 
> 赞同：2
> 
> 时间：2012-12-03T20:16:47.680
> 
> 标签：amazon-ec2

最初我的问题是“我如何在无需先找到其 IP 地址的情况下 RDP 进入 EC2 实例”。为了解决这个问题，我编写了一个在每个实例上定期执行的脚本。该脚本读取特定标签值并使用实例的公共 dns 名称更新 Route53 中的相应条目。

这样我总是可以 rdp 进入 web-01.ec2.mydomain.com 并连接到正确的实例。

当我继续设置我的实例时，我意识到要设置 mongodb 复制，我需要以某种方式引用三个独立的实例。我无法使用内部私有 IP 地址，因为它们不断变化（或者在实例停止/启动和 dhcp 租约到期时容易发生变化）。

尝试`web-01.ec2.mydomain.com`从我的 EC2 实例中访问会返回实例的内部 IP 地址。这似乎是标准行为。因此，通过提及我的三个实例的 route53 cnames，我可以确保它们始终可以被彼此发现。我不会支付任何额外的数据传输费用，因为 cnames 将始终解析为内部 ip。但是，我将为所有这些 route53 查询付费。

我可以每 30 秒或更短的时间运行一次脚本，以确保 dns 条目尽可能是最新的。

在这一点上，我意识到我所拥有的在很大程度上是一个弹性 IP 替代方案。也许不完全，但肯定适用于我所有的用例。所以我想知道是否使用弹性IP。只要我的实例正在运行，就不会产生任何费用。这似乎是一个更简单的选择。

**大多数人做什么？** 如果有这方面经验的人可以回复，我将不胜感激。

其次，在实例丢失其当前私有 ip 并获得新的内部 ip 的那几秒/分钟内会发生什么。我假设所有现有的连接都被丢弃。这会影响 ELB 健康检查（每 30 秒 ping 一次）吗？我假设如果我使用的是弹性 IP，dns 名称将立即解析为新的 ip，而不是在我的脚本执行后说。假设我的脚本每 30 秒运行一次，是否只有 30 秒的停机时间，还是可能更多？Elastic ip 的性能是否总是比我的脚本解决方案更好？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T07:28:49.127

根据[官方 AWS 文档](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/using-instance-addressing.html)，“私有 IP 地址在其生命周期内仅与实例关联，并且仅在实例停止或终止时返回给 Amazon EC2。在 Amazon VPC 中，实例在实例停止运行时保留其私有 IP 地址。停了。” 因此，如果有变化，每 30 秒检查一次似乎本质上是错误的。这给您留下了两个明显的选择：

*   在启动时/启动后更新一次 DNS
*   使用弹性 IP 和静态 DNS

使用过的弹性 IP 不会花费您任何费用，即使是停放的 IP 也只需很少的费用。如果您的实例大部分都在运行，请使用弹性 IP。如果它们大部分都处于关闭状态，请转到启动时间更新路线。如果您的实例位于 VPC 中，则甚至不需要启动时间更新（但在 VPC 中，您可能有不同的需求和更复杂的网络设置）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T16:31:55.177

您可以考虑的另一个选择是使用*软件定义的数据中心*解决方案，例如 Amazon VPC 或 Ravello Systems（免责声明：我们公司）。

使用这样的解决方案将允许您在公共云中创建一个封闭的私有环境。在环境内部，您拥有完全的控制权，包括您自己的私有 L2 网络，您可以在该网络上管理 IP 地址并可以使用例如静态分配的 IP。与外部（例如您的应用服务器）的通信通过您配置的 IP 和端口进行。

# math - 简单进位

> ID：13690959
> 
> 赞同：1
> 
> 时间：2012-12-03T20:17:06.003
> 
> 标签：math, assembly, carryflag

好的，所以我正在修改测试其中一个修改问题是：

如果

*   R4 = FEh
*   R5 = DCh
*   R6= ABh
*   进位 = 0

以下代码`A`及其后的内容是什么：`Carry`

```
MOV A,R6 
SUBB A,R4 
SUBB A,R5 
```

正确答案是`Carry = 1`和 `A = D0h`

我可以计算出寄存器是什么，但我无法得到进位位的正确答案。谁能帮我理解这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:22:36.707

第一个减法是 AB - FE => AD 由于 FE > AB 进位位被设置

第二个减法是 AD - (DC + 1) => DO 因为 DD > AD 进位位被再次设置。

# python - 字典的三元运算

> ID：13690961
> 
> 赞同：13
> 
> 时间：2012-12-03T20:17:09.087
> 
> 标签：python, dictionary, conditional-operator

有没有办法对测试为 has_key() 的字典进行三元运算而不会遇到关键错误？IE

```
variable = dict["the_key"] if dict.has_key("the_key") else "something" 
```

（这显然是关键错误）

如果做不到这一点，根据可能有或没有相关键的 dict 分配一堆变量值的最 Pythonic 方法是什么？重复：

```
if dict.has_key('key'):
    value = dict['key']
else:
    value = "value" 
```

ad nauseum 似乎很不雅。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-03T20:19:12.743

这：

```
mydict.get(key, default_value) 
```

不是 100% 与立即评估的相同，`default_value`而`else`仅在满足条件时才评估零件。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-03T20:36:37.590

Jochen Ritzel 的回答是 99.9999% 的正确方法：

```
variable = d.get("the key", "something") 
```

正如他所指出的，它不允许您短路默认值的评估。你通常不在乎。它的默认值是`"something"`，你当然不知道。仅当默认值是危险的或非常昂贵的生成时才重要。

只有在这种情况下，您才能并且应该使用您的想法。除了你想要`in`而不是`has_key`（因为它更具可读性，更快，并且不被弃用）：

```
variable = d["the key"] if "the key" in d else expensiveComputation() 
```

但是，使用`if`语句而不是三元表达式可能值得，因为您避免使用的事实很`expensiveComputation`重要，并且您希望它更明显：

```
if "the_key" in d:
    variable = d["the key"]
else:
    variable = expensiveComputation() 
```

如果您希望默认情况很少见，则更好：

```
try:
    variable = d["the key"]
except KeyError:
    variable = expensiveComputation() 
```

如果由于某种原因您需要避免两次查找密钥，并且您也无法处理异常，并且您需要一次短路默认值：

```
sentinel = object()
variable = d.get(sentinel)
if variable == sentinel:
    variable = expensiveComputation() 
```

是的，您可以将所有这些都包装在一个函数中，这样它就可以成为一个单行代码，但是您几乎肯定不想隐瞒您同时做三件罕见的事情的事实。

或者，当然，你可以这样做：

```
d = collections.defaultdict(expensiveComputation) 
```

然后，它只是：

```
variable = d["the key"] 
```

这具有在返回给您之前设置`d["the key"]`为的副作用，因此稍后调用将返回相同的值。如果这听起来合适，这是最好的答案；如果您永远不会使用相同的密钥两次，或者这些东西很大而且很浪费，等等，这是一个坏主意。`expensiveComputation()``d["the key"]`

或者，或者，您可以覆盖该`dict.__missing__`方法而不是使用`defaultdict`：

```
class MyDict(dict):
    def __missing__(self, key):
        return expensiveComputation() 
```

然后，再次，它只是：

```
variable = d["the key"] 
```

当您希望每次都单独生成值而不是将其保留以供以后使用时，此选项是合适的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-03T20:21:18.190

使用 .get() 方法 - 如果密钥不存在，它将返回 None ，或者您可以设置自己的默认值：

[http://docs.python.org/2/library/stdtypes.html#dict.get](http://docs.python.org/2/library/stdtypes.html#dict.get)

```
value = mydict.get("key", "default") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T20:19:32.167

`variable = d['the_key'] if 'the_key' in d else 'something'`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T20:19:30.513

```
value = 'value'
if 'key' in dict:
   value = dict['key'] 
```

或定义一个默认值

> dict.get('key', 'value')

# php - 管理员密码更改后的内部服务器错误...（Mac OSX 和 PHP）

> ID：13690976
> 
> 赞同：-1
> 
> 时间：2012-12-03T20:18:08.060
> 
> 标签：php, macos, administrator, internal-server-error

在工作中，我最近采用了一个相当无证的 Mac OSX/PHP Web 服务器。“管理员”帐户密码未知，另一位技术人员在将服务器交给我之前将其重置。托管在服务器上的网站运行良好，除了一个子文件夹，当您尝试访问子文件夹中的任何内容时会生成“内部服务器错误”。该文件可以是 PHP 文件、HTML 文件，甚至是我创建的文件（当您将其放入根目录或那里的任何其他子文件夹时，它就可以正常工作。

尝试访问子文件夹中的任何内容确实会显示用户名/密码提示，但我在该子文件夹中没有看到 .htaccess 文件。当我使用“管理员”帐户用户名/密码成功登录时，就会出现“内部服务器错误”。我在 PHP 错误日志中没有看到任何内容，这让我觉得它还没有走那么远——而且我在服务器日志中也没有看到任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:27:32.710

根据我的经验，听起来子文件夹不包含索引文件，并且目录列表可能被禁用，因此导致您将“内部服务器错误”视为 httpd 服务器的最后手段。在子文件夹中创建一个文件：

```
touch index.html 
```

保护域/文件夹的密码不需要 .htaccess/.htpasswd（或选择的其他命名文件）存在于同一文件夹中。它可以放置在 httpd 可以读取的任何其他位置。我建议您通读 httpd 的配置文件并检查 php-error 日志，但在这种情况下，我会先查看 httpd-error 日志。

# delphi - Delphi反向解密函数

> ID：13690986
> 
> 赞同：1
> 
> 时间：2012-12-03T20:19:04.363
> 
> 标签：delphi

我在delphi中有以下代码要解密：

```
 new_size := Length(Source) - 1;
      for c := 24 to new_size - 1 do
        begin
          v := Source[c];
          v := v - key;
          v := v AND $FF;
          x := v XOR (Source[c + 1]);
          Source[c] := x;
        end; 
```

在哪里

```
 Source: Array of Byte;

      Key: Byte; 
```

任何人都知道如何扭转这个（再次加密）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T20:45:05.027

此代码与问题中的代码相反：

```
for c := new_size - 1 downto 24 do
  Source[c] := (Source[c] xor Source[c+1]) + key; 
```

问题中的代码可以更简单地写成这样：

```
for c := 24 to new_size - 1 do
  Source[c] := (Source[c] - key) xor Source[c+1]; 
```

# bash - 尝试用变量中的空格符号替换 substr

> ID：13690988
> 
> 赞同：1
> 
> 时间：2012-12-03T20:19:19.910
> 
> 标签：bash

我需要将第一个匹配 $d1 的 substr 替换为 $d2 值。我写了这段代码：

```
i=${i/${d1}/${d2}} 
```

它运行良好，但如果 $d1 或 $d2 包含空格符号则失败。我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:24:16.083

使用双引号：

```
$ i="abc def ghi"
$ d1="c d"
$ d2="C  D"
$ i="${i/${d1}/${d2}}"
$ echo "$i"
abC  Def ghi
$ 
```

# javascript - jQuery - 在 IE9 中获取附加内容的 HTML（没有选择包装器的选项）

> ID：13690989
> 
> 赞同：2
> 
> 时间：2012-12-03T20:19:19.520
> 
> 标签：javascript, jquery, internet-explorer-9

在 AJAX 请求之后，我得到一个带有一些 HTML 数据的字符串，如下所示：

```
var test = '<div id="test-options"><option value="">Select</option><option value="true@153237119">XS</option><option value="true@153237120">S</option><option value="true@153237121">M</option><option value="true@153237122">L</option><option value="true@153237123">XL</option><option value="true@153237124">XXL</option></div><div class="athoerstuff">Ather stuff here</div>'; 
```

我想附加它，在附加它之后只获取没有包装器的 div 的内容：

```
var li = $(test).appendTo('form');

$("body").find('#test-options').html(); 
```

## -------------------------------------------

**问题**仅出现在 IE9 上，因为没有包装器的选项。IE9 正在查看 div 内的选项并意识到这是无效的。这就是为什么 IE9 没有让我选择的原因。

我在发出请求（选项值）的服务器端脚本中添加了一个选择包装器，而不是：

```
$('#test-options').html(); 
```

我补充说：

```
$('#test-options select').html(); 
```

结果结果与之前的代码相同，但现在也可以在 IE9 上运行。

感谢大家的帮助。

**也许有人可以告诉我为什么 IE9 在没有选择包装器的情况下无法获得选项，而其他浏览器则可以？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:23:04.477

如果您正在尝试获取`option`s html，那么您可以简单地执行以下操作，

```
$(test).unwrap().html(); 
```

而不是附加到正文并检索内容。

[http://jsfiddle.net/XYhbg/](http://jsfiddle.net/XYhbg/)

以上是假设您在测试变量中拥有的数据。让我知道是否有任何不同。

# c# - SQL Server XML 数据类型在 .NET 中转换为什么以及如何将其转换为 XmlDocument？

> ID：13690991
> 
> 赞同：18
> 
> 时间：2012-12-03T20:19:20.807
> 
> 标签：c#, .net, sql-server-2005

我们在数据库中有一个类型为`xml`. 我正在通过 .net 阅读此信息`SqlDataReader`，但我不确定将其转换为什么。

msdn 表 ( [http://msdn.microsoft.com/en-us/library/cc716729.aspx](http://msdn.microsoft.com/en-us/library/cc716729.aspx) ) 表明它属于 .net 类型`Xml`，但没有`System.Xml`，`System.Web.UI.WebControls.Xml`所以我不确定这是否正确。

所以我的问题是：

当我`SqlDbType.Xml`从 a 中读取它时`SqlDataReader`，我应该将它转换为什么，以及如何将它转换为`XmlDocument`？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-03T20:24:30.217

它转化为[`SqlXml`](http://msdn.microsoft.com/en-us/library/system.data.sqltypes.sqlxml.aspx)，你可以从中得到`XmlReader`一个[`SqlXml.CreateReader`](http://msdn.microsoft.com/en-us/library/system.data.sqltypes.sqlxml.createreader.aspx)。您必须使用 [`SqlDataReader.GetSqlXml`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.getsqlxml.aspx)方法来获取类型而不是字符串。

例如：

```
 SqlDataReader reader = cmd.ExecuteReader();
        while (reader.Read())
        {
            SqlXml xmlData =
            reader.GetSqlXml(0);
            XmlReader xmlReader = xmlData.CreateReader();

            xmlReader.MoveToContent();
            while (xmlReader.Read())
            {
                if (xmlReader.NodeType == XmlNodeType.Element)
                {
                    string elementName = xmlReader.LocalName;
                    xmlReader.Read();
                    Console.WriteLine(elementName + ": " + xmlReader.Value);
                }
            }
        } 
```

**更新：**回答@Wiktor Zychla 的有用评论

这种方法的性能更好，并且在处理大型 XML 字段时会好*很多*`SqlReader.GetString`，因为会先将字段内容加载到字符串中，同时`SqlReader.GetSqlXml`直接从流中创建 XmlReader。这可以通过查看 Reflector 中的 System.Data 或类似工具来快速验证。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-03T20:24:14.620

我记得把它转换成一个字符串。然后像往常一样用字符串输入 XmlDocument。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-03T20:33:26.330

我自己使用这种方法，使用`SqlCommand.ExecuteXmlReader();`

```
XmlDocument xdoc = new XmlDocument();
using (SqlCommand command = new SqlCommand(queryString, connection))
{
    XmlReader reader = command.ExecuteXmlReader();
    if (reader.Read())
    {
        xdoc.Load(reader);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T20:23:37.553

当然，有一个[System.Xml 命名空间](http://msdn.microsoft.com/en-us/library/system.xml%28v=vs.110%29.aspx)：

> System.Xml 命名空间为处理 XML 提供基于标准的支持。

但是，要使用它，您可能必须将它作为参考添加到您的项目中。Microsoft 有[在 Visual Studio 中执行此操作的说明](http://msdn.microsoft.com/en-us/library/wkze6zky.aspx)。

# image-processing - 在图像中定位多个 blob

> ID：13690994
> 
> 赞同：0
> 
> 时间：2012-12-03T20:19:32.320
> 
> 标签：image-processing, myro

对于计算机科学课，我应该编写一个程序，可以在这样的图片中找到未知数量的外星人的位置和大小：[http ://www-bcf.usc.edu/~stejada/ csci101/Pix/MARS2.jpg](http://www-bcf.usc.edu/~stejada/csci101/Pix/MARS2.jpg) . 我目前有以下代码：

```
#include "Myro.h"
#include <iostream>
#include <stdlib.h>
#include <stdio.h>
#include "alien.h"
#include <vector>

using std::cout;
using std::cin;
using std::endl;
using std::vector;

void trackBlob(PicturePtr &aPic, int x, int y);
int BlobSize(PicturePtr &aPic, int x, int y, vector<int>& xLocs, vector<int>& yLocs);

vector<alien> found;
int returned;

int main()
{
returned = 0;
cout << "Pick a picture to search 0-5, or choose 6 to quit" << endl;
int selection;
cin >> selection;
PicturePtr thePic;

// Choose a picture to search
bool selecting = true;
while (selecting) {
    switch (selection) {
        case 0:
            thePic = makePicture("MARS.jpg");
            selecting = false;
            break;
        case 1:
            thePic = makePicture("MARS1.jpg");
            selecting = false;
            break;
        case 2:
            thePic = makePicture("MARS2.jpg");
            selecting = false;
            break;
        case 3:
            thePic = makePicture("MARS3.jpg");
            selecting = false;
            break;
        case 4:
            thePic = makePicture("MARS4.jpg");
            selecting = false;
            break;
        case 5:
            thePic = makePicture("MARS6.jpg");
            selecting = false;
            break;
        case 6:
            cout << "Terminating." << endl;
            return 0;
        default:
            cout << "Invalid input. Please try again." << endl << endl;
            break;
    }// end switch
} // end while

// Find the aliens
cout << endl;
cout << "Pic size: " << getHeight(thePic) * getWidth(thePic) << endl << endl;
int numGreen = 0;
for (int i = 0; i < getWidth(thePic); i++) {
    for (int j = 0; j < getHeight(thePic); j++) {
        Pixel pix;
        pix = getPixel(thePic,i,j);

        // Check for alien color
        if (pix.R >= 100 && pix.R <= 120 && pix.G >= 240 && pix.G <= 255 && pix.B >= 1 && pix.B <= 15) {
            trackBlob(thePic,i,j);
            numGreen++;
        }
        else if (pix.R >= 165 && pix.R <= 185 && pix.G >= 215 && pix.G <= 235 && pix.B >= 65 && pix.B <= 85) {
            trackBlob(thePic,i,j);
            numGreen++;
        }
        else if (pix.R >= 130 && pix.R <= 155 && pix.G >= 210 && pix.G <= 230 && pix.B >= 145 && pix.B <= 175) {
            trackBlob(thePic,i,j);
            numGreen;
        }
        else if (pix.R >= 27 && pix.R <= 47 && pix.G <= 265 && pix.G >= 245 && pix.B >= 1 && pix.B <= 10) {
            trackBlob(thePic,i,j);
            numGreen++;
        }
        else if (pix.R >= 240 && pix.R <= 255 && pix.G <= 240 && pix.G >= 255 && pix.B >= 25 && pix.B <= 45) {
            trackBlob(thePic,i,j);
            numGreen++;
        }
        else if (pix.R >= 235 && pix.R <= 255 && pix.G <= 245 && pix.G >= 210 && pix.B >= 200 && pix.B <= 230) {
            trackBlob(thePic,i,j);
            numGreen++;
        }
        else if (pix.R <= 240 && pix.R >= 210 && pix.G <=255 && pix.G >= 240 && pix.B >= 1 && pix.B <= 10) {
            trackBlob(thePic,i,j);
            numGreen++;
        }
    }
}
cout << endl << endl;
cout << "Number of Aliens: " << found.size() << endl;
for (int n = 0; n < found.size(); n++) {
    cout << "Position of Alien #" << n << ": (" << found[n].x << "," << found[n].y << ")" << endl;
    cout << "Size of Alien #" << n << ": " << found[n].size << endl;
}

cout << endl << endl << "Number pixels tried: " << numGreen << endl << endl;
cout << "Times blob returned: " << returned << endl;
show(thePic);
return 0;
}

void trackBlob(PicturePtr &aPic, int x, int y) {
// Just to be safe
Pixel aPixel = getPixel(aPic,x,y);
//if (aPixel.R == 0 && aPixel.G == 0 && aPixel.B == 0)
    //return;

// Find the size of the alien
vector<int> xLocs;
vector<int> yLocs;
int size = BlobSize(aPic,x,y,xLocs,yLocs);
cout << "Blob size: " << size << endl;
returned++;

// Make sure it's big enough to be an alien
if (size < 5) {
    return;
}

alien newAlien;

// Find the position
newAlien.x = 0;
for (int i = 0; i < xLocs.size(); i++) {
    newAlien.x += xLocs[i];
}
newAlien.x = newAlien.x/xLocs.size();

newAlien.y = 0;
for (int j = 0; j < yLocs.size(); j++) {
    newAlien.y += yLocs[j];
}
newAlien.y = newAlien.y/yLocs.size();

found.push_back(newAlien);
}

int BlobSize(PicturePtr &aPic, int x, int y, vector<int>& xLocs, vector<int>& yLocs)
{
if (x >= getWidth(aPic) || x < 0)
    return 0;

Pixel pix = getPixel(aPic,x,y);

// Just to be safe
//if (pix.R == 0 && pix.G == 0 && pix.B == 0)
    //return 0;

bool isAlien = false;
if (pix.R >= 100 && pix.R <= 120 && pix.G >= 240 && pix.G <= 255 && pix.B >= 1 && pix.B <= 15)
    isAlien = true;
else if (pix.R >= 165 && pix.R <= 185 && pix.G >= 215 && pix.G <= 235 && pix.B >= 65 && pix.B <= 85)
    isAlien = true;
else if (pix.R >= 130 && pix.R <= 155 && pix.G >= 210 && pix.G <= 230 && pix.B >= 145 && pix.B <= 175)
    isAlien = true;
else if (pix.R >= 27 && pix.R <= 47 && pix.G <= 265 && pix.G >= 245 && pix.B >= 1 && pix.B <= 10)
    isAlien = true;
else if (pix.R >= 240 && pix.R <= 255 && pix.G <= 240 && pix.G >= 255 && pix.B >= 25 && pix.B <= 45)
    isAlien = true;
else if (pix.R >= 235 && pix.R <= 255 && pix.G <= 245 && pix.G >= 210 && pix.B >= 200 && pix.B <= 230)
    isAlien = true;
else if (pix.R <= 240 && pix.R >= 210 && pix.G <=255 && pix.G >= 240 && pix.B >= 1 && pix.B <= 10)
    isAlien = true;

if (!isAlien)
    return 0;

// Store the location in the position vectors
xLocs.push_back(x);
yLocs.push_back(y);

// Make sure the pixel doesn't get counted again
setPixelColor(aPic,x,y,0,0,0);

int size = 0;

for (int i = 0; i <= 2; i++) {
    for (int j = 0; j <= 2; j++) {
        if (i == 0 && j == 0) {
            break;
        }
        size += BlobSize(aPic,x + (i-1), y + (j-1),xLocs,yLocs);
    }
}

return 1 + size;
} 
```

当我运行代码时，它说它发现了数百个“外星人”。如果有帮助的话，它找到的每一个都比上一个大。我已经盯着这个好几天了，不知道出了什么问题。任何帮助将非常感激。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T09:08:50.203

首先，您应该像这样从 BlobSize() 中删除注释：

```
// So pixels aren't counted twice
if (pix.R == 0 && pix.G == 0 && pix.B == 0)
    return 0; 
```

由于 BlobSize() 将计数的像素更改为黑色，因此您需要将这些行保留在代码中，这样它就不会对像素进行两次计数。

此外，您在 BlobSize() 末尾的 for 循环略有错误。它应该如下所示：

```
for (int i = -1; i <= 1; i++) {
    for (int j = -1; j <= 1; j++) {
        // skip pixel at this location
        if (i == 0 && j == 0) {
            continue;
        }
        size += BlobSize(aPic,x + (i-1), y + (j-1),xLocs,yLocs);
    }
} 
```

以前的方式是检查当前位置像素上方和左侧的像素，看到`i == 0 && j == 0`，然后跳过检查第一列。该程序将对其他 6 个像素（包括当前位置的像素）运行 BlobSize()。

顺便说一句，很好地使用了向量和递归。抱歉，如果我回答得太晚并且您已经上交了。由于延期，我将在周日上交我的。

# ios - 我是否需要消除对`glUseProgram()`的额外调用？

> ID：13690995
> 
> 赞同：0
> 
> 时间：2012-12-03T20:19:33.930
> 
> 标签：ios, opengl-es

假设我有一些代码`glUseProgram(programId)`在不同的点调用，但有时最终会调用`glUseProgram(1)`两次，使用相同的参数（即 program1 被要求两次）。

我应该消除虚假调用`glUseProgram`还是`glUseProgram`已经在内部执行了该检查？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T18:54:44.633

正如[OpenGL ES Programming Guide for iOS](http://developer.apple.com/library/ios/documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/OpenGLESApplicationDesign/OpenGLESApplicationDesign.html#//apple_ref/doc/uid/TP40008793-CH6-SW6)中所建议的，您应该防止对`glEnable`状态更改的冗余调用。因此可以假设这同样适用于`glUseProgram`. 即使这个假设不正确，如果可能的话，按照程序和统一设置对绘图调用进行排序仍然是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T01:02:44.837

在我的电脑上，如果我使用`gluseprogram(PROGRAMID)`相同的 ID 两次，而没有在两者之间进行设置，则显示驱动程序会崩溃。所以我不会。

（编辑）对不起，那不是真的。这实际上与 SFML 窗口环境有关。在 OpenGL 函数能够“清理房屋”之前，设置错误，因此关闭了窗口（以及 OpenGL 环境）。