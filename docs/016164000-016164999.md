# StackOverflow 问答 16164000-16164999

# javascript - SlideUp 向下滑动

> ID：16164003
> 
> 赞同：0
> 
> 时间：2013-04-23T07:59:09.350
> 
> 标签：javascript, jquery, slidedown, slideup

我有这个 javascript 代码：

```
var x="#wrapper"
//var xyz;
$(document).ready(function(){ 
    $("#about").click(function(){
    if (!(x=="#about")){
        $(x).slideUp("slow",function(){
            $("#aboutus").slideDown("slow");
            });

            x="#aboutus";
        }
    });
});
$(document).ready(function(){
    $("#home").click(function(){ 
        if(!(x=="#wrapper")){
        $(x).slideUp("slow", function(){
            $("#wrapper").slideDown("slow");
            });
        dd="#wrapper";
        }
    });
}); 
```

有了这个“菜单”

```
<nav>
    <div class="menu">
        <ul class="ul">
    <h6>
                <li id="home" >Home</li >
                <li id="about">About</li >
                <li >performance</li >
                <li >testimonials</li >
                <li >faqs</li >
                <li >forum</li >
                <li onclick="slideUpDown()">Contact  </li >
            </ul>
        </h6>
    </div>
</nav> 
```

我必须使用 li 标签作为链接，当我单击关于“链接”时，home div 必须缓慢向上滑动，而 about div 应该缓慢下降。请帮忙！

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-12T10:03:29.340

不久前我来过这个不错的。它很简单而且很有效。

```
function toggleForm(x) {
        if ($('#'+x).is(":hidden")) {
            $('#'+x).slideDown(200);
        } else {
            $('#'+x).slideUp(200);
        }
} 
```

然后叫它...

```
onmousedown="javascript:toggleForm('div_ID'); 
```

并且不更改您的 URL 在同一个呼叫中将其添加到前面

```
onclick="return false" 
```

有了这个，您可以使用一个脚本来调用任意数量的滑动操作。要定位的 div 是在调用中具有其 ID 的 div。

编辑：对不起......刚刚注意到它是 jQuery，但不应该影响任何东西。我在其他 jQuery 没有的地方使用了它。所以似乎也不冲突。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:14:49.133

在代码的最后一行，将**x**设置为**#wrapper**而不是 dd：

```
var x="#wrapper"

//var xyz; 
$(document).ready(function(){

    $("#about").click(function(){
        if (!(x=="#about")){
            $(x).slideUp("slow",function(){
                $("#aboutus").slideDown("slow");
            });
            x="#aboutus";
        }
    });

    $("#home").click(function(){ 
        if(!(x=="#wrapper")){
            $(x).slideUp("slow", function(){
                $("#wrapper").slideDown("slow");
            });
            x="#wrapper";
        }

    }); 
}); 
```

# php - 排序数组 - 从外部数据中对数组进行排序

> ID：16164004
> 
> 赞同：0
> 
> 时间：2013-04-23T07:59:11.160
> 
> 标签：php, arrays

我正在尝试根据 SQL 数据库中的未排序数组创建有序数组。

从数据库中获取的数据将如下所示：

```
Array (
  //array ('name', position)
  array ('george', 2),
  array ('lenny' , 4),
  array ('rabbit', 1),
  array ('pet'   , 3)
) 
```

这个想法是对数组中的“名称”进行排序`position`。我想最终成为：

```
Array ( 'rabbit', 'george', 'pet', 'lenny' ) 
```

我尝试过的当前方法是使用 split_array()

`$result`是数据库中的数组。

```
foreach ( $result as $res ){
  $a = array(array($res['name'], $res['position']));
  array_splice($finalArray, ($res['position'] - 1), 0, $a);
} 
```

问题有时取决于检索用户的顺序，它不会正确排序，有没有更好的方法来做到这一点，或者这很好，我做错了？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:02:27.400

使用`uasort` [http://php.net/manual/en/function.uasort.php](http://php.net/manual/en/function.uasort.php)函数，您可以在其中传递用户定义的比较`function`，如下所示：

```
$myArray = array(array('bill',3),array('joe',4),array('john',1));

/**
 * @desc compare two arrays by the second element
 * @param array $a (array to compare with an other)
 * @param array $b (array to compare with an other)
 * @return int 0|1|-1 equals|first is bigger|second is bigger
 */ 
function myCompare($a,$b){
    if( $a[1] == $b[1] ){
        return 0;        //if the 2nd elements equals return 0
    }
    return ( $a[1] > $b[1] )?1:-1;  //if the 2nd element of the 1st parameters is bigger returns 1 , else returns -1
} 
```

用法：

```
uasort( $myArray, 'myCompare' ); 
```

将`uasort`原件操作`array`到位。

结果：

```
 var_dump($myArray);

 array(
       array('john',1),
       array('bill',3),
       array('joe',4)
 ); 
```

推荐：

如果您可以编辑`SQL`查询，最好使用`ORDER BY`如下指令缩短查询中的结果：

```
 SELECT `name`,`position` 
 FROM `mytable`  #your table name
 WHERE 1  #or your conditions here
 ORDER BY `position` ASC  #ordering directive 
```

这应该运行得更快。如果使用这个，建议添加`index`到`position`字段。

# ruby-on-rails - 条件为假时的 where 方法

> ID：16164011
> 
> 赞同：1
> 
> 时间：2013-04-23T07:59:32.413
> 
> 标签：ruby-on-rails

如果条件为假，它是否返回空数组或 nil？例如：

```
@result=Result.where(:test_id=>test_id, :user_id => current_user.id).first 
```

如果没有这样的 test_id 和 user_id 的结果。

我只是不明白，我认为第一个选项，但这返回零。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T08:12:12.773

您的变量由两部分构成，第一部分返回一个`ActiveRecord::Relation`（*本质上是*一个数组）：

```
 @result_array = Result.where(:test_id=>test_id, :user_id => current_user.id)

 > @result_array.class
  => ActiveRecord::Relation 
```

*`[]`如果没有结果，则为空（显示为）。*

第二个返回第一项，**或者**（如果它是空数组）`nil`：

```
> (1..10).first
 => 1

> [].first
 => nil

@first_or_nil = @result = @result_array.first 
```

我建议在 Rails 控制台中键入这些类型的命令，以查看结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T05:52:41.580

您也可以使用这个简单的查询...

```
@result=current_user.results.find_by_test_id(:test_id) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:01:09.033

对于您的问题，您可以使用这样的代码。

```
@result=Result.where(:test_id=>test_id).(:user_id => current_user.id).first 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T09:22:03.407

您可以将 #bang 与方法 .first 一起使用`!` 例如：

```
@result=Result.where(:test_id=>test_id, :user_id => current_user.id).first! 
```

它应该返回 ruby​​ 将在表“结果”中遇到的第一个元素。
它应该有帮助。

# css - 如何在 Twitter Bootstrap 中制作自定义宽度居中的容器？

> ID：16164015
> 
> 赞同：0
> 
> 时间：2013-04-23T07:59:54.640
> 
> 标签：css, twitter-bootstrap, less, margin

过去一天我一直在处理一个非常奇怪的问题，到目前为止我无法理解我哪里出错了。

首先，我想要做的是使用 Bootstrap 创建一个单列固定容器布局，该布局具有`33em`宽度并使用自动边距水平居中。

我要实现的第二件事是使用`span`具有这种新`33em`布局的类。

我怎样才能做到这一点？我已经取得了第一个，但是自动边距不起作用（它们因页面而异）。

使用 LESS 和 Bootstrap 2.3。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:28:41.447

如果你想让你的 div 居中创建一个类；

```
wrap {
    position: absolute;
    display: block;
    width: 33em;
    height: 330px;
    margin-top: -165px;
    margin-left: -16.5em;
    left: 50%;
    top: 50%;
} 
```

并且`<div class="container wrap"></div>`会居中。

# c++ - 使用 detours DLL 挂钩从函数中读取数据

> ID：16164016
> 
> 赞同：0
> 
> 时间：2013-04-23T07:59:54.903
> 
> 标签：c++, dll, detours

我想知道是否可以从函数中读取数据。
我知道我可以使用 detours 来挂钩函数并自由更改参数。
但这就是我对使用弯路的理解。

例如：

```
//cryptkeys
typedef int (WINAPI *pCryptKey)(int crypt1, int crypt2, int crypt3);
int WINAPI MyCryptKey(int crypt1, int crypt2, int crypt3);
pCryptKey MyCrypt2Key = (pCryptKey)(0x60FF50);

int WINAPI MyCryptKey(int crypt1, int crypt2, int crypt3)
{
    cout << crypt1 << crypt2 << crypt3 << endl;
    return MyCrypt2Key(999,135,2);
} 
```

该代码绕过游戏中的加密密钥函数，并在调用它之前更改参数。因此，当它被调用时，参数已被更改。

我在想如果函数内部有数据而不是参数怎么办。
如何更改或显示它？

我应该重写整个函数吗？

我想要得到的是使用游戏本身来加密和解密数据包。
我已经挂钩了执行此操作的函数，但我所能做的就是更改参数。
游戏只是继续它的事情。

我在加密之前更改了数据包，因此发送了另一个数据包。但这只有在我尝试发送数据包并对其进行修改时才会发生。我想从字面上调用该函数，而无需等待游戏调用它，然后就可以修改值。
就像我将使用游戏输入我自己的未加密数据包并按加密以查看加密值，反之亦然。

解释或教程链接会很棒。

* * *

如果我像这样：

```
int WINAPI MyCryptKey(int crypt1, int crypt2, int crypt3)
{
    //dont know whats supposed to be in here. But it should be alot of codes.
} 
```

并将返回称为：

```
int cryptValue = MyCrypt2Key(999,135,2);
cout << cryptValue << endl;    //to get the return? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:43:35.710

您的示例已经走在正确的轨道上，`cout`并且都`endl`存在于 detour 函数之外。对于在函数 detour 中放置的代码，实际上并没有任何明确的限制。在函数之外访问数据与任何其他程序相同。

```
int globalVar = 1;

int WINAPI MyCryptKey(int crypt1, int crypt2, int crypt3)
{
    cout << crypt1 << crypt2 << crypt3 << globalVar << endl;

    globalVar++;

    return MyCrypt2Key(999,135,2);
} 
```

要将数据保存在函数内部，您可以像往常一样声明变量，必要时使用静态存储持续时间。

```
int WINAPI MyCryptKey(int crypt1, int crypt2, int crypt3)
{
    static int staticVar = 1;
    int localVar = staticVar + 1;

    staticVar++;

    cout << localVar << crypt1 << crypt2 << crypt3 << endl;
    return MyCrypt2Key(999,135,2);
} 
```

如果您想完全替换该函数，只需删除对原始函数的调用并提供完整的实现。您应该记住，该函数在调用时应该表现出与原始函数相同的行为，否则使用它的代码可能会失败。

```
int WINAPI MyCryptKey(int crypt1, int crypt2, int crypt3)
{
    cout << crypt1 << crypt2 << crypt3 << endl;

    return 5;
} 
```

弄清楚一个函数是如何工作的以替换它的实现是你必须付出努力的地方。您通常可以通过阅读该函数的文档来很好地了解该函数的工作原理。如果没有文档或没有太多文档，您将不得不为此工作。

您可以像往常一样调用原始函数。下面的示例将调用真正的`MyCryptKey`函数，而不会被您正在挂钩的应用程序调用。

```
int  FunctionForAnotherThread()
{
    int cryptValue = MyCrypt2Key(999,135,2);

    cryptValue += rand() % 10;

    return cryptValue;
} 
```

# java - InetAddress.getByName(ip).isReachable(timeout);

> ID：16164021
> 
> 赞同：0
> 
> 时间：2013-04-23T08:00:12.990
> 
> 标签：java, reachability

**InetAddress.getByName(ip).isReachable(2000)**用于在 2 秒内找到系统的可达性。
但是当我试图在我的网络中连续查找多个系统（比如 n 个系统）的可达性时，它需要 2n 秒。有没有其他方法，以便我可以在更短的时间内找到它们的可达性，比如 3 到 4 秒？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-17T09:11:47.867

您可以使用 jnetpcap 自己制作 ping 数据包，并听取响应。您可以（几乎）一次将所有 ping 请求发送到网络，并在（稍长于）2 秒内完成。不过，您将需要知道 MAC 地址。

# c - int32_t 和 int_fast32_t 的区别

> ID：16164025
> 
> 赞同：18
> 
> 时间：2013-04-23T08:00:19.000
> 
> 标签：c, types, int32

两者有什么区别？我知道无论环境如何，int32_t 都是 32 位，但是，顾名思义，它很快，与 int32_t 相比，int_fast32_t 真正快多少？如果它明显更快，那为什么会这样呢？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-04-23T08:09:22.630

C 是根据理想化的抽象机器来指定的。但是现实世界的硬件具有语言标准没有捕捉到的行为特征。这些`_fast`类型是类型别名，允许每个平台指定对硬件“方便”的类型。

例如，如果您有一个 8 位整数数组，并且想要单独改变每个整数，这在现代台式机上将是相当低效的，因为它们的加载操作通常想要填充整个处理器寄存器，即 32 或 64位宽（“机器字”）。所以大量加载的数据最终被浪费了，更重要的是，你不能并行加载和存储两个相邻的数组元素，因为它们存在于同一个机器字中，因此需要按顺序加载-修改-存储。

如果可行，这些`_fast`类型通常与机器字一样宽。也就是说，它们可能比您需要的*更宽*，因此会消耗更多内存（因此更难缓存！），但您的硬件可能能够更快地访问它们。不过，这一切都取决于使用模式。（例如，一个数组`int_fast8_t`可能是一个机器字数组，修改这样一个数组的紧密循环可能会显着受益。）

找出它是否有任何区别的唯一方法是比较！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-23T08:11:36.063

`int32_t`是一个正好是 32 位的整数。例如，如果您想创建一个具有精确内存位置的结构，这很有用。

`int_fast32_t`是您当前处理器的“最快”整数，最终大于或等于`int32_t`. 我不知道当前处理器（x86 或 ARM）是否真的有好处

但我终于可以概述一个真实的案例：我曾经使用 32 位 PowerPC 处理器。当访问未对齐的 16bits`int16_t`时，它必须首先在其 32bits 寄存器之一中重新对齐它们是低效的。对于非内存映射的数据，由于我们没有内存限制，使用起来效率更高`int_fast16_t`（实际上是 32bits int）。

# javascript - 如何将 JavascriptSerializer 序列化的 DateTime 字符串转换为 Javascript Date 对象

> ID：16164026
> 
> 赞同：16
> 
> 时间：2013-04-23T08:00:23.060
> 
> 标签：javascript, asp.net

`DateTime`在使用字段序列化对象后`JavaScriptSerializer`，我看到该`DateTime`字段如下所示：

```
EffectiveFrom: "/Date(1355496152000)/" 
```

如何将此字符串转换为 Javascript Date 对象？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-11-07T20:37:25.737

**更新**：此答案可能不适用于所有情况。有关可能更好的优雅解决方案，请参阅[JD 的答案。](https://stackoverflow.com/a/26411466/1961413)

您可以从`JavaScriptSerializer`.Net 方面“修复”输出：

```
JavaScriptSerializer serializer = new JavaScriptSerializer();
var json = serializer.Serialize(this);
json = Regex.Replace(json,@"\""\\/Date\((-?\d+)\)\\/\""","new Date($1)");
return json; 
```

这会改变

```
EffectiveFrom: "/Date(1355496152000)/" 
```

至

```
EffectiveFrom: new Date(1355496152000) 
```

Javascript可以直接使用哪个

编辑：更新以适应负日期

编辑：这是 VB 人员的正则表达式行：

```
json = Regex.Replace(json, """\\/Date\((-?\d+)\)\\/""", "new Date($1)") 
```

更新 2016.11.20：在我身后的 javascript/json 中有更多的日期时间处理，我建议将正则表达式更改为简单的

```
json = Regex.Replace(json,@"\""\\/Date\((-?\d+)\)\\/\""","$1"); 
```

结果值是有效的 JSON，并且可以在 javascript 端转换为 Date 对象。

还值得注意的是，moment.js ( [http://momentjs.com/docs/#/parsing/](http://momentjs.com/docs/#/parsing/) ) 可以很愉快地处理这种格式。

```
moment("/Date(1198908717056-0700)/"); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-23T08:05:17.960

有一个答案可以帮助你：

[将日期和时间从 JavaScript 解析为 C#](https://stackoverflow.com/questions/10872143/parsing-date-and-times-from-javascript-to-c-sharp/15548067#15548067)

如果您想使用 javascript 将日期时间字符串解析为日期时间值，则必须使用“新日期”，如下所示：

```
var data = new Date("1355496152000"); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-23T08:17:37.163

```
var obj = { EffectiveFrom: "/Date(1355496152000)/" };

//parse the Date value and replace the property value with Date object:

var dateValue = parseInt(obj.EffectiveFrom.replace(/\/Date\((\d+)\)\//g, "$1"));
obj.EffectiveFrom = new Date(dateValue); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-10-16T18:32:17.683

这有点骇人听闻，但上面的内容对于我想要实现的目标似乎并不优雅，所以在我序列化的对象定义中，我这样做了：

```
 /// <summary>Date of the record retention event or document date.
        /// </summary>
        public string DateOfRetentionEvent;
        [ScriptIgnore]
        public DateTime RetentionEventDate 
        {
            get
            {
                return _retentionEventDate;
            }
            set
            {
                _retentionEventDate = value;
                DateOfRetentionEvent = value.ToShortDateString();
            }
        } 
```

关键是，至少在我的用例中（反序列化永远不会发生），JSON 并不真正关心 C# 对日期值做了什么。添加`[ScriptIgnore]`到**DateTime**值并为解析器输出提供替代视图应该可以解决问题。在我的情况下是这样的：

```
{
    "DateToDispose": "1/1/2020",
    "DateOfRetentionEvent": "10/1/2014",
    "FullRetentionCode": "NR+5",
    "RetentionEvent": "NR",
    "RetentionPeriod": 5
} 
```

# ios - iOS 按钮动画像邮件应用程序

> ID：16164031
> 
> 赞同：0
> 
> 时间：2013-04-23T08:00:59.083
> 
> 标签：ios, objective-c, core-animation, calayer

在 iOS 邮件应用程序中，如果您转到收件箱并在某个项目上滑动，存档按钮会从右到左显示（以及何时消失）。我试图在我的应用程序中实现这种行为，我接近这个的方式是为按钮的遮罩层设置动画并将其从右向左移动。我在这里遇到的问题是，一旦动画结束，按钮就会消失。

```
//Create Mask Layer
CALayer *maskLayer = [CALayer layer];
maskLayer.frame = CGRectMake(cell.deleteButton.frame.size.width,0,cell.deleteButton.frame.size.width,cell.deleteButton.frame.size.height);
maskLayer.backgroundColor = [UIColor whiteColor].CGColor;

cell.deleteButton.layer.mask = maskLayer;

// Setting the animation
CABasicAnimation *animation = [CABasicAnimation animationWithKeyPath:@"position.x"];
animation.byValue = [NSNumber numberWithFloat:-cell.deleteButton.frame.size.width];
animation.duration = 0.4f;

[cell.deleteButton.layer.mask addAnimation:animation forKey:@"maskAnimation"]; 
```

所以我想知道如何让按钮在动画后不消失，或者是否有更好的方法来创建动画。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:29:34.090

通过您的实现，您将在动画完成后用动画移动遮罩，它将保留遮罩的最后位置。这就是按钮被隐藏的原因。

您需要将委托设置为您的班级：

```
animation.delegate = self; 
```

然后在委托方法中实现以下代码：

```
 -(void) animationDidStop:(CAAnimation *)anim finished:(BOOL)flag
 {
     CALayer *maskLayer = [CALayer layer];
     maskLayer.frame = CGRectMake(0,0,self.btnLogin.frame.size.width,
          self.btnLogin.frame.size.height);
     maskLayer.backgroundColor = [UIColor whiteColor].CGColor;

     self.btnLogin.layer.mask = maskLayer;
 } 
```

希望能帮助到你。

# c# - Convert.ToDateTime() 问题

> ID：16164034
> 
> 赞同：0
> 
> 时间：2013-04-23T08:01:03.217
> 
> 标签：c#, asp.net, date, datetime

我有一个字符串，看起来日期格式是 01/04/2013

为了`string date="01/04/2013"`

上面的字符串格式如：**01 是日期，04 是月份，2013 年。**

现在我正在使用`convert.todatetime()`

见下文 ：

```
DateTime **DateTimeValue** =Convert.ToDateTime(date); 
```

我系统中的 DateTimeValue 返回：`01-04-2013T00:00:00` **// 日期 1 日和月 2 日**

但是当转换相同的 DateTimeValue 在其他系统上返回时`:04-01-2013T00:00:00` **//Month 1st and date 2nd**

为什么`Convert.DateTime()`在不同的系统中返回不同的，不同的日期？？？？

**回答 ：**

现在我将我的 DataBase Coloumn DataType DateTime 更改为 Nvarchar 。所以我不应该转换为 DateTime 。这适用于所有系统。

多谢你们

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T08:07:11.933

> 为什么 Convert.DateTime() 在不同的系统中返回不同的、不同的日期？？？？

因为它使用当前区域性将字符串转换为日期时间。在某些文化中，月份在日期之前，而在其他文化中，反之亦然。

您可以指定文化或用途`CultureInfo.InvariantCulture`（类似于`en-US`），也可以[`DateTime.ParseExact`](http://msdn.microsoft.com/en-us/library/system.datetime.parseexact.aspx)在可以指定格式的地方使用。

```
string date="01/04/2013";
 // day 4 month 1
DateTime dt = DateTime.Parse(date, CultureInfo.InvariantCulture); 
```

或者

```
// day 4 month 1
DateTime dt = DateTime.ParseExact(date, "MM/dd/yyyy", CultureInfo.InvariantCulture); 
```

一般来说，使用这些`TryParse`方法来检测输入的格式是否正确是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:08:36.420

你可以试试这个：

```
string date = "01/04/2013";
        DateTime dtTime;
        if (DateTime.TryParseExact(date, "dd/MM/yyyy",
           System.Globalization.CultureInfo.InvariantCulture,
           System.Globalization.DateTimeStyles.None, out dtTime))
        {
            Console.WriteLine(dtTime);
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:03:27.903

这是一个区域/本地化设置的事情。确保在不知道这些设置的情况下不会发生这种情况的方法是像这样设置日期字符串：`yyyy-mm-dd`，例如`2013-04-01`，它将始终被视为 2013 年 4 月 1 日。

`Convert.ToDateTime`有关此处的更多信息：http: [//msdn.microsoft.com/en-us/library/xhz1w05e.aspx](http://msdn.microsoft.com/en-us/library/xhz1w05e.aspx)

相关位：

> 如果 value 不为 null，则返回值是使用为当前区域性初始化的 DateTimeFormatInfo 对象中的格式信息对 value 调用 DateTime.Parse 方法的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T08:05:07.487

如果您在 PC 上打开控制面板，将会有一个区域和语言选项（名称可能因您的 Windows 版本而异）。您可以在此处指定长日期和短日期和时间的格式。

如果您希望格式完全相同，请在日期时间上使用 ToString() 方法并设置格式，如下[所述](http://msdn.microsoft.com/en-gb/library/zdtaw1bw.aspx)。

# android - 相同权限 Facebook 应用

> ID：16164041
> 
> 赞同：0
> 
> 时间：2013-04-23T08:01:12.003
> 
> 标签：android, ios, facebook

目前我有一个 Facebook 应用程序。我也想创建一个 IOS 和 Android 应用程序。用户是否需要再次授予权限，我可以使用 Facebook 应用程序上提供的相同信息吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:26:30.843

不，一旦您的 facebook 应用程序要求用户授予权限（如果移动设备上未安装 facebook 应用程序，则会触发浏览器，如果已安装 facebook 应用程序），如果您的应用程序已被用户批准 - 而您没有请求比用户在您的网络应用程序上批准的更多权限 - 您的移动应用程序将自动获得批准。

行为应如下所示：

*   **如果用户当前未登录 facebook**（在 facebook 应用程序或移动网络上）。当用户第一次运行您的应用程序时，您的应用程序会调用登录 API，Facebook 应用程序或浏览器会打开（在 iOS 上，您会看到窗口滑出而 Facebook 应用程序滑入）。系统将提示用户登录。登录后，控制权将切换回您的应用程序。
*   **如果用户*当前*登录到 facebook**。当用户第一次运行您的应用程序时，您的应用程序会调用登录 API，无论是 Facebook 应用程序还是移动浏览器都会打开。不久之后，在没有任何用户干预的情况下，它会切换回您的应用程序（在 iOS 上，您只会看到窗口滑动两次——从您的应用程序中滑出并再次滑入）。

# java - 在 finally 块中静默关闭 InputStream 而不会丢失原始异常的正确方法是什么？

> ID：16164044
> 
> 赞同：31
> 
> 时间：2013-04-23T08:01:30.047
> 
> 标签：java

我想知道下面的代码是否在 finally 块中正确关闭 InputStream

```
InputStream is = new FileInputStream("test");
try {
    for(;;) {
        int b = is.read();
        ...
    }
} finally {
    try {
        is.close();
    } catch(IOException e) {
    }
} 
```

如果在 is.read() 期间发生异常，如果在 is.close() 期间发生异常，它会被忽略/抑制吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-23T08:07:57.593

最好的方法是使用 Java 7 并使用资源尝试，或者手动执行相同的操作并将关闭时的异常添加为抑制的异常。

Pre Java 7：如果您要抛出自定义异常，则可以像在 Java 7 中那样添加抑制异常（在您的异常中创建字段列表被抑制并放置关闭操作中的异常，在处理您的异常时，看看那里也。如果你不能这样做，我不知道什么比记录它更好。

示例：来自[Java 教程](http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)

```
static String readFirstLineFromFile(String path) throws IOException {
    try (BufferedReader br = new BufferedReader(new FileReader(path))) {
        return br.readLine();
    }
} 
```

但更好的形式是：

```
static String readFirstLineFromFile(String path) throws IOException {
    try (FileReader fr = new FileReader(path);
         BufferedReader br = new BufferedReader(fr)) {
        return br.readLine();
    }
} 
```

这样即使 FileReader 创建成功但 BufferedReader 创建失败（例如内存不足），FileReader 也会被关闭。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-12-23T07:25:04.787

[您可以使用来自https://commons.apache.org/proper/commons-io/](https://commons.apache.org/proper/commons-io/)的 IOUtils 关闭它

```
public void readStream(InputStream ins) {
    try {
        //do some operation with stream         
    } catch (Exception ex) {
        ex.printStackTrace();
    } finally {
        IOUtils.closeQuietly(ins);
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-23T08:50:29.330

Java [6 规范](http://docs.oracle.com/javase/specs/jls/se5.0/html/statements.html#14.20.2)说

> 如果 try 块的执行由于任何其他原因 R 突然完成，则执行 finally 块。然后有一个选择：如果 finally 块正常完成，那么 try 语句由于原因 R 突然完成。如果 finally 块由于原因 S 突然完成，那么 try 语句由于原因 S 突然完成（并且原因 R 被丢弃）。

所以你是对的，你会失去原来的例外。

解决方案可能是这样防御性地编写您的 finally 块，以至于如果 finally 块失败，而不是 try catch 块中出现异常，这将是一个更大的惊喜（值得传播）。

因此，例如，如果当您尝试关闭流时流可能为空，请检查它：

```
InputStream is = new FileInputStream("test");
try {
    for(;;) {
        int b = is.read();
        ...
    }
} finally {
    try {
        if( is!=null ) {
            is.close();
        }
    } catch(IOException e) {
    }
} 
```

在 Java 7 中，Alpedar 的解决方案当然是要走的路。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-23T08:04:56.413

is.close() 的异常将被抑制，is.read() 的异常将向上传播。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-23T09:37:19.670

使用您发布的代码：

*   如果`is.close()`抛出一个`IOException`，它将被丢弃并且原始异常传播。
*   如果`is.close()`抛出其他东西（a`RuntimeException`或 an `Error`），它会传播并丢弃原始异常。

在 Java 7 中，在不丢失原始异常的情况下关闭 InputStream 的正确方法是使用[try-with-resources 语句](http://docs.oracle.com/javase/7/docs/technotes/guides/language/try-with-resources.html)：

```
try (InputStream is = new FileInputStream("test")) {
    for(;;) {
        int b = is.read();
        // ...
    }
} 
```

在 Java 7 之前，您所做的一切都很好，除了您可能想要捕获所有异常而不是`IOException`s。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-23T08:05:32.873

根据您的代码示例，如果`int b = is.read();`此时发生异常，则异常将在调用链的上层引发。

请注意，尽管 finally 块仍将执行，并且如果`Inputstream`无效，将引发另一个异常，但此异常将被“吞下”，这可能是可以接受的，具体取决于您的用例。

编辑：

根据您的问题的标题，我想补充一点，我认为您所拥有的一切都很好。您可能希望另外添加一个`catch`块来显式处理（或包装）第一个`try`块中的任何异常，但也可以让任何 IO 异常引发 - 这实际上取决于您的 API。让 IO 异常引发可能是可接受的，也可能是不可接受的。如果是，那么你有什么好 - 如果不是，那么你可能想用更适合你的程序的东西来处理/包装 IO 异常。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-23T09:48:36.947

下一个解决方案如何：

```
InputStream is = new FileInputStream("test");
Exception foundException=null;
try {
    for(;;) {
        int b = is.read();
        ...
    }
} catch (Exception e){
  foundException=e;
}
finally {
    if(is!=null)
    try {
        is.close();
    } catch(IOException e) {
    }
}
//handle foundException here if needed 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-23T10:56:02.780

> 如果在 is.read() 期间发生异常，如果在 is.close() 期间发生异常，它会被忽略/抑制吗？

是的。您在 close() 中有一个异常的 catch 块，它不会重新引发异常。因此，它不会被传播或重新抛出。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-12-11T17:31:17.510

这是帮助理解您的问题的示例，如果您在 try-catch 块中声明扫描程序，它将向编译器发出警告资源未关闭。所以要么在本地制作，要么在 try() 中制作

```
import java.util.InputMismatchException;
import java.util.Scanner;

class ScanInt {
public static void main(String[] args) {
    System.out.println("Type an integer in the console: ");

    try (Scanner consoleScanner = new Scanner(System.in);) {
        System.out.println("You typed the integer value: "
                + consoleScanner.nextInt());

    } catch (InputMismatchException | ArrayIndexOutOfBoundsException exception) {
        System.out.println("Catch Bowled");
        exception.printStackTrace();

    }
    System.out.println("----------------");
}
} 
```

# c# - 在 8000 毫秒 word 文件中查找字符串

> ID：16164050
> 
> 赞同：-1
> 
> 时间：2013-04-23T08:01:46.907
> 
> 标签：c#, filestream

我使用 FileStream 在我的 SQL 数据库中存储了许多 word 文件，现在我想搜索所有这些文件以返回那些包含字符串的女巫。

我找到的第一个解决方案是打开每个文件并读取它们的内容并搜索给定的字符串（使用文件流）

第二种解决方案是不使用FileStream，将word的内容存储在数据库中，所以这导致我们需要很大很大的硬盘空间！！！

有没有人可以帮助我解决这个问题！？

* **UPDATE1**：我正在 WPF 中创建一个文档管理系统。此应用程序将在 LAN 上运行。有2个应用程序。第一个将安装在服务器上，用户将使用它添加或删除文件。第二部分将安装在客户端上，用户将使用它来搜索文件的内容

* **UPDATE2**：在你们回答我的问题期间，我发现了 SQL Server 2012 的新功能，名为 File Table。这个能帮到我吗？！我想我可以使用这个和第三方解决方案来做到这一点？！你同意我吗 ？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T05:17:56.233

最后我使用了名为 File Table 的 MSSQL 2012 的新功能，因为它只支持 .doc 文件，所以我安装了 Microsoft IFilter 2.0 来支持 .docx 文件。还在我的文件表上创建全文索引，效果很好

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-23T08:08:31.467

我建议使用第一个解决方案，因为首先你可以分配内存一次读取一个文件，完成后释放内存并将内存分配给另一个文件并读取它。在这个过程中，你可以返回你需要的字符串，而不需要大的硬空间。

# php - 如何根据用户在 opencart 管理部分添加翻译？

> ID：16164052
> 
> 赞同：1
> 
> 时间：2013-04-23T08:01:56.990
> 
> 标签：php, opencart, shopping-cart

我正在使用 opencart 版本 1.5.5.1。我们有一个使用 opencart 框架编码的网站。该站点还使用 opencart 多商店功能。我已经根据[如何为 opencart 多商店使用单独的语言文件中给出的商店添加了语言标签的翻译？](https://stackoverflow.com/questions/16161348/how-to-use-separate-language-files-for-opencart-multi-stores/ "如何为 opencart 多商店使用单独的语言文件？").

现在的问题是，是否可以在管理员端为不同的用户使用不同的语言标签，具体取决于他们创建用户帐户的商店。例如：一个用户从与运动项目相关的商店创建用户帐户，而另一用户从与手表相关的商店创建用户帐户。因此，当“运动”用户登录（管理员端）时，我们需要显示与运动项目相关的语言标签，而当“手表”用户登录（管理员端）时，我们需要显示与手表相关的语言标签。

注意：新用户不是超级管理员。

请帮我。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:54:45.180

这里的问题有点复杂——你必须抓住用户注册的网站。

打开您的 phpMyAdmin（或您想要的数据库管理工具）并`customer`通过添加一个新列来编辑表格，例如`register_site`类型为 eg `VARCHAR(20)`。您可以将寄存器所在的站点保存到此新列中。

这意味着分别向商店正在使用的模板添加`<input type="hidden" name="register_site" value="sports" />`或。`<input type="hidden" name="register_site" value="watches" />`您将编辑两个模板文件：

*   `/catalog/view/theme/<THEME>/template/account/register.tpl`
*   `/catalog/view/theme/<THEME>/template/checkout/register.tpl`

您在其中添加提到的**隐藏输入**（每个商店只有一个 adequote，切换`<THEME>`为真实主题名称）和此模型文件：

*   `/catalog/model/account/customer.php`

您必须**`addCustomer`**通过在 SQL 中添加一个新的 coulmn-value 对来编辑该方法`insert`（应该是第 14 行）：

```
$this->db->query("INSERT INTO " . DB_PREFIX . "customer SET store_id = '" . (int)$this->config->get('config_store_id') . "', firstname = '" . $this->db->escape($data['firstname']) . "', lastname = '" . $this->db->escape($data['lastname']) . "', email = '" . $this->db->escape($data['email']) . "', telephone = '" . $this->db->escape($data['telephone']) . "', fax = '" . $this->db->escape($data['fax']) . "', salt = '" . $this->db->escape($salt = substr(md5(uniqid(rand(), true)), 0, 9)) . "', password = '" . $this->db->escape(sha1($salt . sha1($salt . sha1($data['password'])))) . "', newsletter = '" . (isset($data['newsletter']) ? (int)$data['newsletter'] : 0) . "', customer_group_id = '" . (int)$customer_group_id . "', ip = '" . $this->db->escape($this->request->server['REMOTE_ADDR']) . "', status = '1', approved = '" . (int)!$customer_group_info['approval'] . "', date_added = NOW(), register_site = '" . $this->db->escape($data['register_site']) . "'");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^^^^^^^^^^^^^ --------- THIS IS NEWLY ADDED ---------- ^^^^^^^^^^^^^^ 
```

（检查行尾......）。

现在在管理员中，您可以检查`register_site`登录的客户数组中的新属性/索引，并使站点相应地运行（这现在应该很简单......）。

# html - 如何嵌入 YouTube 体育频道

> ID：16164054
> 
> 赞同：0
> 
> 时间：2013-04-23T08:02:03.733
> 
> 标签：html, iframe, youtube, youtube-api

我想在 iframe 中嵌入 YouTube 自动生成的体育频道：[http ://www.youtube.com/channel/HC7Dr1BKwqctY](http://www.youtube.com/channel/HC7Dr1BKwqctY)

不知何故，常规方法（[http://apiblog.youtube.com/2012/03/new-player-options-for-lists-of-videos.html](http://apiblog.youtube.com/2012/03/new-player-options-for-lists-of-videos.html)）似乎不适用于这种方法。

任何帮助/替代方案表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:45:34.553

不幸的是，目前这是不可能的。如果您希望将来添加它，请随时在[问题跟踪器中请求它。](https://code.google.com/p/gdata-issues/issues/entry?template=YouTube%20%28Enhancement%20Request%29)

# php - 来自数据库的静态 php 页面

> ID：16164056
> 
> 赞同：-1
> 
> 时间：2013-04-23T08:02:11.027
> 
> 标签：php, mysql, .htaccess, templates

我在网上到处冲浪，我找不到我的问题的答案..所以我问你:)

我想在我的网站中导航到该格式的页面：（`http://example.com/category/page.php`例如：）`http://example.com/action/login.php`而不是： `http://example.com/index.php?action=login`

并且将一个页面的所有数据存储在mysql数据库中，而不是自己创建数百个.html或.php文件。我只需要一个带有模板模型的页面，其中将显示数据......

有没有办法将动态链接转换为来自mysql数据库的静态链接unisng数据？

请给我解释一下.htaccess文件是什么...我不明白如何处理它...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:08:39.777

在您有 index.php 的地方创建具有类别名称的文件夹然后在这些文件夹中，放置您的 php 文件。

例如，`login.php`将在文件夹内`action`。

如果您不想拥有文件和文件夹，则需要修改所需的 url，例如：

```
http://example.com/action.php?page=login.php 
```

或者

```
http://example.com/?cat=action&page=login.php 
```

或者

```
http://example.com/?script=action/login.php 
```

# javascript - 当想要从 URL 检索数据时，AJAX 在浏览器中不起作用

> ID：16164057
> 
> 赞同：1
> 
> 时间：2013-04-23T08:02:11.953
> 
> 标签：javascript, jquery, ajax, browser

当我想从 URL 检索数据时，我遇到了这个奇怪的问题。

```
 $.ajax({
 url: 'URLHERE',
dataType: 'html',
success: function(data) { //function 2
    var xml = $.parseXML(data)
    $(xml).find('StopLocation').each(function() //function 3 
{
    var name = $(this).attr('name');
    var x = $(this).attr('x');
    alert(name);
    alert(x);

});   //function 3 end } //function 2 end       }); //ajax end 
```

这在 Dreamweaver 中有效，但在浏览器中无效。我一直在阅读这可能是因为 AJAX 在浏览器上的跨域上不起作用。这是真的？另请阅读我可以将 dataType 更改为 'jsonp' - 但这甚至在 Dreamweaver 中都不起作用。

有什么想法可能是错的吗？或者我应该使用 AJAX 以外的其他东西来解决这个问题？

这是PhoneGap中的一个移动应用程序，所以我也在使用jquery。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T08:04:39.653

您没看错，这是工作中的跨脚本漏洞预防。您可以使用 JSONP 绕过它，但 JSONP 不是 JSON - 语法略有不同，因此您联系的服务器必须以 JSONP 格式向您发送数据。如果您期待 JSONP 并接收 JSON，难怪它在任何地方都不起作用。如果您期待 JSONP 并接收 XML，那就像苹果和丰田一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T07:03:23.760

当您使用PhoneGap时，我认为这是可能的。您可以使用 IE（而不是其他浏览器）对其进行测试

```
var xhr = new XMLHttpRequest();
        xhr.open("GET", "url", true);
        xhr.onreadystatechange = function() {
         if (xhr.readyState == 4) {
         var text = xhr.responseText;
         alert(text);
         }
            }
        xhr.send(); 
```

希望这有效，至少对我有用。在此之后，您可以解析为 xml.... 并按照您的意图继续您的工作。

# android - 如何使用 Smack 删除 XMPPClient 的数据包侦听器

> ID：16164065
> 
> 赞同：2
> 
> 时间：2013-04-23T08:02:35.123
> 
> 标签：android, xmpp, smack, asmack

**我使用Smack** by **XMPP server(openFire)**开发了一个聊天应用程序。为了获取传入的消息，我使用**PacketFilter** 这是传入的消息代码：-

```
PacketFilter filter = new MessageTypeFilter(Message.Type.chat);
        connection.addPacketListener(new PacketListener() {
            public void processPacket(Packet packet) {
                Message message = (Message) packet;
                incomemsg = message.getBody();
                if (incomemsg != null) {
                    String fromName = StringUtils.parseBareAddress(message.getFrom());
                    frmname =  message.getBody();
                    Log.i("XMPPClient", "Got text [" + message.getBody() + "] from [" + fromName + "]");
                    // Add the incoming message to the list view
                    mHandler.post(new Runnable() {
                        public void run() {
                            // show the msg of chat in right side.
                              showMessage(frmname,false);
                              scrollContainer.getFocusables(scrollContainer.getChildCount());
                        }
                    });

                }
            }
        }, filter); 
```

但我想在活动关闭或停止或销毁期间删除 paketListener。我按照这个[http://community.igniterealtime.org/thread/28921](http://community.igniterealtime.org/thread/28921)删除数据包侦听器但没有找到解决方案。

请检查。谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:21:42.380

您可以从以下内容开始：

```
public class YourClass {
    private PacketListener packetListener;
    ....
} 
```

然后稍后一旦你想实例化 PacketListener：

```
packetListener = new PacketListener(
....
);
connection.addPacketListener(packetListener); 
```

并删除它：

```
connection.removePacketListener(packetListener); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-17T17:28:36.530

你可以试试这个，它对我有用：`

```
PacketFilter filter;
PacketListener packetListener;
filter = new MessageTypeFilter(Message.Type.chat);
packetListener = new PacketListener() {
                                public void processPacket(Packet packet) {
                                    // do something with your packet here
                                    Message message = (Message)packet;
                                    String from  = message.getFrom();
                                    String body = message.getBody();
                                    System.out.println("Message from: " + from + " " + body);
                                }
                            };
                            connection.addPacketListener(packetListener, filter);
//And when you want to remove it:
connection.removePacketListener(packetListener); 
```

# asp.net - 在 ASP.NET 中以中等信任将文件保存到网站中的文件夹

> ID：16164067
> 
> 赞同：1
> 
> 时间：2013-04-23T08:02:40.563
> 
> 标签：asp.net, hosting, medium-trust

在我的网站中，我通过调用将图像保存到代码隐藏中的文件夹（照片）中

`ImageUploadControl.PostedFile.SaveAs(HttpContext.Current.Server.MapPath("~/Photos/" + Name + ext));`

`'Access not allowed'`这会在中等信任度中引发错误。以中等信任度保存图像的任何替代方法？该文件夹需要可公开访问，因为客户端无需任何身份验证即可访问这些图像，因此我无法将其保存在 App_Data 中（解决此问题的一个方法）

*网站托管在 hostgator 共享计划上。我可以要求服务器配置的数量是有限的。

**编辑：**

是的，它是一个访问问题，因为解决 ~ tilda，不允许使用虚拟路径。我希望任何人都有解决此问题的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:49:34.977

好的，因为这是一个路径问题：

[https://support.hostgator.com/articles/hosting-guide/lets-get-started/server-path-absolute-path](https://support.hostgator.com/articles/hosting-guide/lets-get-started/server-path-absolute-path)

它是在 *nix 机器上运行 ASP.NET 吗？还是在 Windows Server 和 IIS 上运行？

另外，我认为您可能需要在这种情况下修改您的代码：

```
string pathRoot = HttpContext.Current.Server.MapPath("~/Photos/");
ImageUploadControl.PostedFile.SaveAs(pathRoot + "/" + Name + ext); 
```

看起来您的原始代码正在尝试使用`mapPath`包含的不存在的文件路径。

如果您必须拥有一行，这可能会起作用：

```
ImageUploadControl.PostedFile.SaveAs(HttpContext.Current.Server.MapPath("~/Photos/") + Name + ext); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:13:25.230

鉴于您使用的是本机 .NET 控件，我认为这更多是由于文件系统权限而不是环境的信任。如果您使用的是第 3 方控件，我会说这是一个信任问题。

快速浏览一下他们使用 cPanel 的 Hostgator，从那里有文件管理器部分，在这里如果您选择`'Photos'`文件夹并选择“更改权限”，请确保该文件夹具有来自应用程序的写入权限。

## 编辑

* * *

此处支持文章设置 *nix 权限： https: [//support.hostgator.com/articles/cpanel/how-to-change-permissions-chmod-of-a-file](https://support.hostgator.com/articles/cpanel/how-to-change-permissions-chmod-of-a-file)

并且： https: [//support.hostgator.com/articles/specialized-help/technical/my-script-needs-to-use-777-permissions](https://support.hostgator.com/articles/specialized-help/technical/my-script-needs-to-use-777-permissions)

# opengl - 渲染到帧缓冲区和屏幕

> ID：16164068
> 
> 赞同：0
> 
> 时间：2013-04-23T08:02:43.483
> 
> 标签：opengl, framebuffer

我正在尝试渲染到 fbo，然后将该纹理用作我的第二个渲染通道的输入以进行后期处理，但似乎会`glClear`影响`glClearColor`已渲染到的纹理。我怎样才能让它们只影响显示缓冲区？

我的代码看起来像这样：

```
UseRenderingShaderProgram();
glBindFramebuffer(GL_FRAMEBUFFER, fb);
glClearColor(0.0, 0.0, 0.0, 0.0);
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

renderWorld();

// render to screen
UsePostProcessingShaderProgram();
glBindFramebuffer(GL_FRAMEBUFFER, 0);

glClearColor(0.0, 0.0, 0.0, 1.0); // <== texture appears to get cleared in this two lines.
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

renderWorld();

glfwSwapBuffers(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T09:50:59.550

如果我必须做出有根据的猜测，您已将纹理定义为使用 mipmap 缩小过滤。使用 FBO 渲染到纹理后，只定义了一个 mipmap 级别。但是，如果没有创建所有选定的 mipmap 级别，则纹理是不完整的，并且不会传递数据。最简单的解决方案是通过设置其缩小过滤器参数来禁用此纹理的 mipmapping

```
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR); 
```

此外，您必须确保正确解绑和绑定附加到 FBO 的纹理。

*   在绑定 FBO 之前取消绑定纹理（您可以一直安全地将其连接到它）。

*   在将纹理绑定为图像源进行渲染之前取消绑定 FBO。

添加这两个更改（绑定顺序和 mipmap 级别）应该会使您的纹理出现。

# javascript - JS数组上的分组排序

> ID：16164078
> 
> 赞同：5
> 
> 时间：2013-04-23T08:03:26.143
> 
> 标签：javascript

我有一个具有两个属性的对象数组：名称和时间。

例如：

```
array = [
    {name: "ANDY", hours: 40 }, 
    {name: "ANDY", hours: 50 }, 
    {name: "GREG", hours: 40 },
] 
```

例如，在我的数组中，我希望排序的结果首先是安迪的小时数最多，然后是安迪的小时数略少，然后是格雷格，因为他的名字按字母顺序排在后面，依此类推。

由于 array.sort() 函数传递数组的两个元素进行比较，我意识到这不是我要走的路，但未能提出一个优雅的解决方案。请帮帮我。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-23T08:11:59.720

```
array = [
    {name: "ANDY", hours: 40 }, 
    {name: "GREG", hours: 40 },
    {name: "ANDY", hours: 50 }, 
]

function cmp(x, y) {
  return x > y ? 1 : (x < y ? -1 : 0);
}

array.sort(function(a, b) {
  return cmp(a.name, b.name) || cmp(b.hours, a.hours)
})

console.log(array)
```

如果 javascript 有一个[宇宙飞船操作符](https://stackoverflow.com/questions/827649/what-is-the-ruby-spaceship-operator)，那就更优雅了。请注意，此代码很容易扩展以使用更多属性：

```
ary.sort(function(a, b) {
    return cmp(a.name, b.name) || cmp(a.age, b.age) || cmp(b.hours, a.hours) || ....
}) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T08:14:09.590

```
var arr = [{
    name: "GREG",
    hours: "40"
}, {
    name: "ANDY",
    hours: "50"
}, {
    name: "ANDY",
    hours: "40"
}];

Array.prototype.sortOn = function(conds){
    this.sort(function(a, b){
        for(var i=0; i < conds.length; i++){
            var c = conds[i].split(" ");
            if(a[c[0]] < b[c[0]]){
                return c[1] == "asc" ? -1:1;
            }
            if(a[c[0]] > b[c[0]]){
                return c[1] == "asc" ? 1:-1;
            }
        }
        return 0;
    });
    return this;
}

arr.sortOn(["name asc", "hours dsc"]); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T08:12:59.490

您可以按*Name排序，然后按**Hours*对具有相同名称的元素进行排序

 *例子：

```
var array = [{"Name":"ANDY", "Hours":40},
             {"Name":"ANDY", "Hours":50},
             {"Name":"GREG", "Hours":40}];

var sortedArray = array.sort(function(a,b) {
            return (a["Name"] > b["Name"]) ? 1 : -1;
    }).sort(function(a,b) {
            if(a["Name"] == b["Name"])
                return (a["Hours"] < b["Hours"]) ? 1 : -1;
            else 
                return 0;
    }); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-23T08:13:44.160

```
obj.sort(function(item1,item2) {
  if ( item1.Name < item2.Name )
    return -1;
  if ( item1.Name > item2.Name )
    return 1;
  return item1.Hours - item2.Hours;
}); 
```*

# eclipse - 如何将我的 eclipse java 项目作为可运行的 jar 导出到远程服务器？

> ID：16164080
> 
> 赞同：0
> 
> 时间：2013-04-23T08:03:27.787
> 
> 标签：eclipse, ant, jar

有没有办法将我的 eclipse java 项目作为可运行的 jar 直接从 eclipse 导出到我的远程服务器。这可以使用 Ant 完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:13:23.587

是的，这可以通过蚂蚁来完成。使用[jar](https://ant.apache.org/manual/Tasks/jar.html)任务创建一个 jar，使用[scp](https://ant.apache.org/manual/Tasks/scp.html)任务将您的 jar 传输到服务器。

一些例子：

```
<target name="jar" depends="compile">
    <mkdir dir="${dist}" />
    <jar jarfile="${dist}/myjar.jar" basedir="${target}">
        <fileset dir="${source}">
            <include name="**/*.gif" />
            <include name="**/*.properties" />
        </fileset>
    </jar>
</target>

<target name="dist" depends="jar" >
    <scp file="${dist}/myjar.jar" trust="true" keyfile="/tmp/keyfile.openssh" todir="user@server:/directory" passphrase="phrase" />
</target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:30:55.433

您可以添加网络驱动程序映射，然后将其导出到本地服务器等远程服务器。

# mysql - MySQL 变量，GROUP_CONCAT 不工作

> ID：16164084
> 
> 赞同：1
> 
> 时间：2013-04-23T08:03:52.417
> 
> 标签：mysql

我有一个变量不等于输出的问题。一只宠物有一个主人，这会尝试查看该主人是否有其他宠物并将它们组合在一起。

```
SELECT
o.id,
o.last_name,
@dog_names := GROUP_CONCAT(concat(p2.name,' (',REPLACE(REPLACE(p.type,'Big Dog','BD'),'Small Dog','LD'),')') SEPARATOR ', ') as dog_names,
@dog_names as dog_variable,
concat(o.last_name,' - ',@dog_names) as label
FROM pets p
LEFT JOIN owners o ON p.owner_id = o.id
LEFT JOIN pets p2 ON p.owner_id = p2.owner_id
WHERE p.name = 'wolfie'
GROUP BY o.id 
```

输出如下：

```
id   | last_name | dog_names               | dog_variable | label
1647 | Reeve     | Wolfie (BD), Ember (BD) | Wolfie (BD)  | Reeve - Wolfie (BD) 
```

为什么 dog_variable 与 dog_names 不匹配？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:23:49.800

它们按相同级别计算，没有特定顺序。这就是 SQL 的工作方式：它是声明性的而不是程序性的，并且在任何查询中都不能假定同一级别的评估顺序。

换句话说，`@dog_names as dog_variable`将使用较旧的值，`@dog_names`因为如果尚未对此迭代进行重新评估

如果您希望它是理智的，请重复表达式或使用嵌套查询

```
SELECT
   id, last_name,
   @dog_names := dog_names,
   @dog_names as dog_variable,
   concat(last_name,' - ', @dog_names) as label
FROM
    (
    SELECT
      o.id,
      o.last_name,
      GROUP_CONCAT(concat(p2.name,' (',REPLACE(REPLACE(p.type,'Big Dog','BD'),'Small Dog','LD'),')') SEPARATOR ', ') as dog_names
    FROM pets p
    LEFT JOIN owners o ON p.owner_id = o.id
    LEFT JOIN pets p2 ON p.owner_id = p2.owner_id
    WHERE p.name = 'wolfie'
    GROUP BY o.id, o.last_name
    ) x 
```

话虽如此，为什么要在 GROUP_CONCAT 中使用变量？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:34:56.693

```
SELECT 
    o.id, 
    o.last_name, 
    @dog_names := GROUP_CONCAT(concat(p2.name,' (',REPLACE(REPLACE(p.type,'Big Dog','BD'),'Small Dog','LD'),')') SEPARATOR ', '),
    @dog_names as dog_names, 
    @dog_names as dog_variable, 
    concat(o.last_name,' - ',@dog_names) as label
FROM pets p
LEFT JOIN owners o ON p.owner_id = o.id
LEFT JOIN pets p2 ON p.owner_id = p2.owner_id
WHERE p.name = 'wolfie'
GROUP BY o.id 
```

# multithreading - 为什么我的线程不能在 perl 中加入？

> ID：16164085
> 
> 赞同：0
> 
> 时间：2013-04-23T08:03:53.270
> 
> 标签：multithreading, perl

我用 Perl 写了一个非常简短的脚本，并在其中使用`multi-thread`了它。

我的问题是，我创建的线程不是`joinable`. 所以我想知道，使线程可连接的条件是什么？

Perl 中线程的限制是什么？

```
#!/usr/bin/env perl
#
#
use lib "$::XCATROOT/lib/perl";
use strict;
use threads;
use Safe;

sub test
{
    my $parm = shift; 
}
my $newchassis = ["1", "2", "3"];
my @snmp_threads ;

for my $item (@$newchassis)
{
    my $thread =  threads->create(\&test, $item);
    push @snmp_threads, $thread;
}

for my $t (@snmp_threads)
{
    $t->join();
} 
```

这可能非常棘手，因为它可以在 RHEL 6.3 上找到，但在 SLES 11sp2 上失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:51:36.433

虽然没有代码，但我会继续假设您正在使用`join foreach @threads;`加入线程。现在线程的加入取决于后处理。没有看到你的代码很难知道你在做什么。但它的工作原理是：

1.  如果后处理步骤需要所有线程在开始工作之前完成，那么等待单个线程是不可避免的。

2.  如果后处理步骤特定于每个线程的结果，则应该可以将后处理部分作为线程本身。

3.  在这两种情况下，`$_->join foreach @threads;`都是要走的路。

4.  如果不需要等待线程完成，请使用 detach 命令而不是 join。但是，线程可能返回的任何结果都将被丢弃。

您确定您为您的活动提供了有效的后处理方案吗？

# c++ - 如何将此 C# 脚本转换为本机 C++？

> ID：16164089
> 
> 赞同：1
> 
> 时间：2013-04-23T08:04:02.897
> 
> 标签：c++, sorting, keyvaluepair

我是 C++ 的初学者。在我使用 C# 之前。Bellow 是一个 C# 脚本。我如何在本机 C++ 中做同样的事情？

我需要的是：

*   列表或类似列表具有 int-int 键值对
*   可以按值自动排序。如果不是，它必须可以按键排序，并且可以获取一个值的索引（我的每个值都是确定的）

我试过`std::map`了，但它没有内置的按值排序或按值获取键。C++ 有类似的东西`sortedlist`吗？

非常感谢！

```
public static SortedList<int, int> sortedList1 = new SortedList<int, int>();

static void List_Add(int i) // 0 < i < 1000
{
    if (!sortedList1.ContainsValue(i))
        sortedList1[Environment.TickCount] = i;
}

static void List_Remove(int i) // 0 < i < 1000
{
    if (sortedList1.ContainsValue(i))
        sortedList1.RemoveAt(sortedList1.IndexOfValue(i));
}

static int List_toInt()
{
    int time = 0;
    int keys = 0;
    bool modifier = false;
    foreach (KeyValuePair<int, int> i in sortedList1)
    {
        if (i.Value > 90) modifier = true;
        if (i.Key - time > 200 | modifier | keys > 1000)
        {
            keys = keys * 1000 + i.Value;
            time = i.Key;
        }
    }
    return keys;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T08:06:41.250

您似乎做错了事情，因为通常使用键对事物进行排序，并且使用键而不是使用值来完成查询。但是，这里似乎对`std::map<int,int>`您有所帮助。只需将您的值用作地图的键，并将您的键用作值（以便您可以使用该值进行查询）。如果允许重复，请使用 multimap。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:06:31.817

这是一些转换器工具：
请访问以下链接：

*   [http://sourceforge.net/projects/convetercpptocs/](http://sourceforge.net/projects/convetercpptocs/)

*   [http://www.tangiblesoftwaresolutions.com/Product_Details/CSharp_to_CPlusPlus_Converter_Details.html](http://www.tangiblesoftwaresolutions.com/Product_Details/CSharp_to_CPlusPlus_Converter_Details.html)

*   [http://cscpp.codeplex.com/](http://cscpp.codeplex.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T08:15:09.490

像那样：

```
#include <map>
#include "Winbase.h"

std::map<int, int> sortedList1;

void List_Add(int i) // 0 < i < 1000
{
    if (sortedList1.find(i) == sortedList1.end())
        sortedList1.insert(std::make_pair<int, int>(GetTickCount(), i));
}

void List_Remove(int i) // 0 < i < 1000
{
    if (sortedList1.find(i) != sortedList1.end())
        sortedList1.erase(sortedList1.find(i));
}

int List_toInt()
{
    int time = 0;
    int keys = 0;
    bool modifier = false;
    for (std::map<int, int>::const_iterator it = sortedList1.cbegin(); 
        it != sortedList1.cend(); it++)
    {
        if (it->second > 90) modifier = true;
        if (it->first - time > 200 || modifier || keys > 1000)
        {
            keys = keys * 1000 + it->second;
            time = it->first;
        }
    }
    return keys;
} 
```

# python - 在方法级别进行静态类型检查，python

> ID：16164090
> 
> 赞同：0
> 
> 时间：2013-04-23T08:04:06.637
> 
> 标签：python

我对python很陌生，我有以下疑问。

假设我有一个名为`TestRequest`and的类`TestResponse`。并且有一个`testStatic`在另一个类中命名的方法。

我希望`testStatic`方法只接受`TestRequest`它的参数并且只返回`TestReponse`对象作为响应。

这在python中可能吗？

我来自java背景，我可以这样写：

```
public TestResponse testStatic(TestRequest request)
{
    return response
} 
```

如何在python中实现相同的功能？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:06:41.493

您不会像在 Java 中那样获得“编译时”类型检查，但您可以在运行时通过断言对象是类的实例来进行，如下所示：

```
def testStatic(self, request):
    assert isinstance(request, TestRequest)
    ... 
```

（但正如其他人所指出的，这不是您通常在 Python 中所做的事情。查找“Duck Typing”。）

# java - 基于 netty 的压力工具和连接计数

> ID：16164099
> 
> 赞同：1
> 
> 时间：2013-04-23T08:04:48.460
> 
> 标签：java, connection, netty, counter, stress-testing

我正在为 Web 应用程序构建一个简单且最快的压力测试工具。要求：来自单个节点的最大输出 http 请求（例如，普通获取）。

我们之前使用过netty，我选择它来编写这个简单的测试。这非常简单，我只完成了 4 个扩展 netty api 的小类（[代码在这里](https://github.com/yetanothercoder/main/tree/master/src/main/java/ru/yetanothercoder/tests/stress)），它在 localhost 开发机器（linux）上提供了大约 30K rps。

主要限制是传出连接限制（Linux 中的打开文件/套接字限制），在我的机器上大约为 30-40K。你会遇到`java.net.BindException`这种情况。**因此，您必须手动限制传出 netty 连接的数量，以防止达到限制时性能下降**。

我用计数器实现了这个限制，在第一个版本中，我增加了它`SimpleChannelUpstreamHandler.channelConnected`并减少了它`future.getChannel().getCloseFuture().addListener`（参见代码，那些地方的注释）它没有工作：连接没有按预期增加并且计数器失败。

只有在我把增量放在附近之后`bootstrap.connect`：

```
connected.incrementAndGet();
ChannelFuture future = bootstrap.connect(new InetSocketAddress(host, port)); 
```

并减少`SimpleChannelUpstreamHandler.messageReceived`：

```
 @Override
    public void messageReceived(ChannelHandlerContext ctx, MessageEvent e) throws Exception {
        // the same here - decrementing connections here is not fully fair but works!
        connected.decrementAndGet();
        e.getChannel().close();
    } 
```

-它开始工作了。唯一的问题 - 这有点不公平，因为您可以增加计数器但无法连接或减少并且在它之后无法断开连接。

那么，为什么计数器在正确的版本中不起作用？

更新：按照建议尝试，inc/dec in `SimpleChannelUpstreamHandler.channelConnected`：

```
 @Override
    public void channelConnected(ChannelHandlerContext ctx, ChannelStateEvent e) throws Exception {
        // by logic you should count connection here, but in practice - it doesn't work
        connected.incrementAndGet();
        ctx.getChannel().getCloseFuture().addListener(new ChannelFutureListener() {
            @Override
            public void operationComplete(ChannelFuture future) throws Exception {
                connected.decrementAndGet();
            }
        });

        e.getChannel().write(GET);
        sent.incrementAndGet();
    } 
```

没有用，再次发送>连接的不可预测的数字，例如：

```
client1 stat: connected=    0, sent=    0, ERRORS: timeouts=    0, binds=    0, connects=0
client1 stat: connected=   11, sent= 4990, ERRORS: timeouts=    0, binds=    0, connects=0
client1 stat: connected=    1, sent= 8591, ERRORS: timeouts=    0, binds=    0, connects=0
client1 stat: connected=  459, sent=13064, ERRORS: timeouts=    0, binds=    5, connects=0
client1 stat: connected= 1545, sent= 7234, ERRORS: timeouts=    0, binds=  115, connects=0
client1 stat: connected=    0, sent=10037, ERRORS: timeouts=    0, binds=   80, connects=0 
```

萨德夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T17:41:54.273

您需要增加 ChannelFutureListener 中发送的计数，该计数被添加到从 write(...) 操作返回的 ChannelFuture 中。否则，即使写入未决，您也会增加它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T08:50:48.150

一个理论。

在您的原始版本中，您减少所有连接尝试的*连接计数器，如果失败了。*如果您在*channelConnected* () 中增加计数器并向 ChannelCloseFuture 添加一个递减侦听器，那么我想您会得到更好的结果。

这是因为

```
boostrap.connect().getChannel().getCloseFuture(...) 
```

将始终调用 operationComplete，即使通道从未连接过。

更新：

确保只计算连接的通道。在 STressClientHandler 的 channelConnected() 回调中：

```
 connected.incrementAndGet();
    ctx.getChannel().getCloseFuture().addListener(new ChannelFutureListener() {

        @Override
        public void operationComplete(ChannelFuture future) throws Exception {
             connected.decrementAndGet();
        }
    }); 
```

# c++ - nullptr 是否引用了 C++ 中未定义的行为？

> ID：16164106
> 
> 赞同：3
> 
> 时间：2013-04-23T08:05:05.387
> 
> 标签：c++, reference, undefined-behavior, nullptr

以下代码使用`nullptr`指针和引用来欺骗：

```
#include <cstdio>

void printRefAddr(int &ref) {
    printf("printAddr %p\n", &ref);
}

int main() {    
    int *ip = nullptr;
    int &ir = *ip;

    // 1\. get address of nullptr reference
    printf("ip=%p &ir=%p\n", ip, &ir);

    // 2\. dereference a nullptr pointer and pass it as reference
    printRefAddr(*ip);

    // 3\. pass nullptr reference
    printRefAddr(ir);

    return 0;
} 
```

**问题**：在 C++ 标准中，注释语句 1..3 是有效代码还是未定义行为？

这与不同版本的 C++ 相同还是不同（旧版本当然会使用`0`文字而不是`nullptr`关键字）？

额外的问题：是否有已知的编译器/优化选项，实际上会导致上述代码做一些意外/崩溃？例如，是否有任何编译器的标志，它将`nullptr`为初始化引用的任何地方生成隐式断言，包括从 ? 传递引用参数`*ptr`？

* * *

一个好奇的输出示例，没有什么意外：

```
ip=(nil) &ir=(nil)
printAddr (nil)
printAddr (nil) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T08:09:11.303

> `// 2\. dereference a nullptr pointer and pass it as reference`

取消引用空指针是**Undefined Behavior**，因此无论您将它作为引用还是按值传递，事实是您已经取消引用它并因此调用了 UB，这意味着从那时起所有赌注都关闭了。

您已经在这里调用了 UB：

```
int &ir = *ip; //ip is null, you cannot deref it without invoking UB. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:09:40.577

因为`ir`它只是它的一个影子，`*ip`它本身不会导致未定义的行为。

未定义的行为是使用指向`nullptr_t`. 我的意思是使用`*ip`. 所以

```
int &ir = *ip;
          ^^^ 
```

导致UB。

# google-maps - Google 地理编码 API - 通知

> ID：16164108
> 
> 赞同：1
> 
> 时间：2013-04-23T08:05:11.773
> 
> 标签：google-maps, google-geocoding-api

我在我的一个应用程序中使用以下 API。 [http://maps.googleapis.com/maps/api/geocode/output?parameters](http://maps.googleapis.com/maps/api/geocode/output?parameters)

正在使用 XML 配置的输出。我想知道是否有任何方法可以获得以下信息。

1.  这个 API 将来是否有可能被关闭？
2.  是否可以选择使用我的电子邮件地址进行注册，以便接收升级或关闭通知？
3.  由于这似乎是一项免费服务，将来会转换为付费版本吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:11:24.293

我会一一回答你的问题。。

1.  与大多数 Google API 一样，它将在未来被弃用，但旧的 api 将在相当长的一段时间内得到支持。例如.. Maps API V2[现已弃用](https://developers.google.com/maps/documentation/javascript/v2/)

2.  如果您阅读了[使用限制](https://developers.google.com/maps/documentation/geocoding/)，您就会知道这项服务对于普通用户每天 2500 次请求是免费的。

3.  它是基于使用情况的免费和付费服务的组合。（每天 2500 个请求是免费的）之后它将被阻止，除非您付费。

# dart - 可以将 Web UI 模板添加到 Dart 库包中吗？

> ID：16164112
> 
> 赞同：2
> 
> 时间：2013-04-23T08:05:16.140
> 
> 标签：dart, dart-webui

为 web_ui 应用程序生成的示例内容在 web 文件夹中添加了 xclickcounter.dart 和 xclickcounter.html。这是一个应用程序包。

我如何将这些添加到 lib 文件夹中以用作其他包将依赖的包？可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T09:31:16.107

（TL；DR - 只需将 xclickcounter 文件拖到 lib 文件夹中，然后在另一个包中使用该包）

是的，这是可能的。您将像这样构建您的项目：

```
 xclickcounter/
       pubpec.yaml
       build.dart
       lib/
          xclickcounter.html
          xclickcounter.css
          xclickcounter.dart
       web/
          test.html -- if you wanted to test it in this project

    ...elsewhere...
    myAppProject/
      pubspec.yaml
      build.dart
      web/
        myapp.html
        myapp.dart 
```

myapp`pubspec.yaml`将包含

```
 dependencies:
           xclickcounter:
             path: ..\..[relative_or_absolute]..\xclickcounter
                    [or deploy xclickcounter to git] 
```

`myapp.html`将包含以下内容：

```
<head>
  <link rel="components" href="package:xclickcounter/xclickcounter.html">
</head>
<body>
   <x-click-counter></x-click-counter>
   ...
</body> 
```

# sql-server - 来自两个不同日期时间的时间和日期

> ID：16164113
> 
> 赞同：0
> 
> 时间：2013-04-23T08:05:16.110
> 
> 标签：sql-server, datetime

我的表中有一个日期时间列，我想更新它，以便它获取今天的日期但保留时间部分。

例子：

```
2011-01-21 01:12...  -> 2013-04-23 01:12...
2012-04-20 19:22...  -> 2013-04-23 19:22... 
```

最简单的方法是什么？

问候奥斯卡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:11:39.123

试试这个——

```
DECLARE @date_old DATETIME
SELECT @date_old = '2011-01-21 01:12'

DECLARE @date_new DATETIME
SELECT @date_new = '2013-04-23 05:24'

SELECT CAST(CAST(@date_new AS DATE) AS DATETIME) + CAST(@date_old AS TIME) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:18:03.593

**编辑**这是一个经过测试的解决方案

```
DECLARE @Today DATETIME2(7)
Declare @OldDate DateTime2(7)
SET @Today=GETDATE()

Select @OldDate = date From <SomeDatabase>

SELECT DATEADD(day, -DATEDIFF(day, @Today, @OldDate), @OldDate) 
```

这是更新：

```
Update <SomeDatabase>  Set date = DATEADD(day, -DATEDIFF(day, @Today, @OldDate), @OldDate) where date = @OldDate 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:31:15.627

要更新表`self join`，请使用@Devart 的方法来保留`time`但更新`date`值

```
Declare @Sample table ( myDate datetime )
Insert into @Sample
values
('2013-04-21 11:42:51.897'),('2013-04-22 13:42:51.897')
Select * from @Sample

Update t
set myDate =convert(datetime,convert(date,getdate())) + convert (time,s.mydate)
from @Sample t inner join @Sample s
on s.myDate=t.myDate
Select * from @Sample 
```

初步结果

```
╔═════════════════════════╗
║         myDate          ║
╠═════════════════════════╣
║ 2013-04-21 11:42:51.897 ║
║ 2013-04-22 13:42:51.897 ║
╚═════════════════════════╝ 
```

最后结果

```
╔═════════════════════════╗
║         myDate          ║
╠═════════════════════════╣
║ 2013-04-23 11:42:51.897 ║
║ 2013-04-23 13:42:51.897 ║
╚═════════════════════════╝ 
```

# php - 如何使用 PHP 提取 BLOB 图像并将其保存在目录中？

> ID：16164115
> 
> 赞同：0
> 
> 时间：2013-04-23T08:05:23.293
> 
> 标签：php, mysql, blob

我已将数据库中的图像保存为 BLOB，现在我想提取图像并将它们保存到一个目录中。

到目前为止，我可以使用以下代码查看 BLOB 图像。

```
<?
$con = mysql_connect("genetech002" , "username" , "mypass");
$db = mysql_select_db("Mydatabase", $con);
$sql = "SELECT * FROM hs_hr_emp_picture WHERE emp_number = 5";
$result = mysql_query($sql) or die(mysql_error());  
$row = mysql_fetch_array($result);

?> 
```

执行上述脚本后，我可以在浏览器中看到图像，但现在我想将此图像保存在一个目录中（在我的服务器上）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:15:04.083

你可以用`file_put_contents()`.

```
file_put_contents("pic.jpg", $row['epic_picture']); 
```

# c# - Unity .net Remoting Server get_animation 只能从主线程调用

> ID：16164117
> 
> 赞同：2
> 
> 时间：2013-04-23T08:05:29.060
> 
> 标签：c#, thread-safety, unity3d, remoting

我正在做一个项目，我有两个需要相互通信的 Unity 项目。我正在尝试通过使用 .net Remoting Framework 来解决这个问题。为此，我创建了一个两个 Unity 项目都将使用的 dll。该dll包括：

> MyRemotableObject.cs

```
public class MyRemotableObject : MarshalByRefObject
{
    public MyRemotableObject()
    {

    }
    public void NotifyStatusChange(int status)
    {
        Cache.GetInstance().Status = 0;
    }
    public int GetCreditCount()
    {
        return Cache.GetInstance().CreditCount;
    }
} 
```

> 缓存.cs

```
public class Cache
{
    private static Cache myInstance;
    public static IObserver Observer;
    private Cache()
    {

    }
    public static void Attach(IObserver observer)
    {
        Observer = observer;
    }
    public static Cache GetInstance()
    {
        if(myInstance==null)
        {
            myInstance = new Cache();
        }
        return myInstance;
    }

    public int Status
    {
        set
        {
            Observer.NotifyFinished(value);
        }
    }
    public int CreditCount
    {
        get
        {
            return Observer.QueryCreditCount();
        }
    }
} 
```

> IObserver.cs

```
public interface IObserver
{
    void NotifyFinished(int status);
    int QueryCreditCount();
} 
```

现在我有我的菜单 - Unity 项目，充当远程服务器

> 菜单控制器.cs

```
public class MenuController : MonoBehaviour, IObserver
{
    private object lockObject;
    List<ControllerBase> controllers;
    private MyRemotableObject remotableObject;
    private System.ComponentModel.Container components = null;

    void Awake()
    {
        lockObject = new object();
        try
        {
            remotableObject = new MyRemotableObject();

            //für fehler:  //http://www.mycsharp.de/wbb2/thread.php?postid=199935
            //************************************* TCP *************************************//
            // using TCP protocol
            TcpChannel channel = new TcpChannel(124);
            ChannelServices.RegisterChannel(channel, false);
            RemotingConfiguration.RegisterWellKnownServiceType(typeof(MyRemotableObject), "TargetShooterMenu", WellKnownObjectMode.SingleCall);
            //************************************* TCP *************************************//
            RemotableObjects.Cache.Attach(this);
        }
        catch (Exception e)
        {
            Debug.Log(e.ToString());
        }

        controllers = new List<ControllerBase>();
        foreach (GameObject controllerObject in GameObject.FindGameObjectsWithTag(GlobalNames.Tags.CONTROLLEROBJECT))
        {
            if (controllerObject.GetComponent<ControllerBase>())
                controllers.Add(controllerObject.GetComponent<ControllerBase>());
        }
    }
    delegate void PresentNameInputControllerDelegate(int status);
    private void PresentNameInputController(int status)
    {
        if (status == (int)LevelStatusCode.OK)
            foreach (ControllerBase controller in controllers)
            {
                controller.Hide();
                if (controller.GetType() == typeof(NameInputController))
                    controller.Show();
            }
    }
    public void NotifyFinished(int status)
    {
        Debug.Log("Notify");
        lock (lockObject)
        {
            PresentNameInputControllerDelegate d = PresentNameInputController;

            d(status);
        }
    }
    public int QueryCreditCount()
    {
        Debug.Log("Query");
        return 100;
    }
} 
```

此服务器实现了 IObserver 函数 NotifyFinished 和 QueryCreditCount（暂时返回 dummy 值）当从客户端调用 NotifyFinished 函数时，出现以下错误：

> get_animation 只能从主线程调用。加载场景时，构造函数和字段初始化程序将从加载线程中执行。不要在构造函数或字段初始化程序中使用此函数，而是将初始化代码移至 Awake 或 Start 函数。

有人可以告诉我，如何解决这个问题？

提前致谢，

霍夫曼纽尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T10:51:17.407

经过大量搜索，我找到了解决方案：使用 Loom Unity 包来自： 关于线程的[Unity Gems 条目，并像](http://unitygems.com/threads/)[Unity 回答关于线程的条目](http://answers.unity3d.com/questions/305882/how-do-i-invoke-functions-on-the-main-thread.html) 中提到的那样使用它：

```
 void Start()
    {
        var tmp = Loom.Current;
        ...
    }
    //Function called from other Thread
    public void NotifyFinished(int status)
    {
        Debug.Log("Notify");
        try
        {
            if (status == (int)LevelStatusCode.OK)
            {
                Loom.QueueOnMainThread(() =>
                {
                    PresentNameInputController();
                });
            }
        }
        catch (Exception e)
        {
            Debug.LogError(e.ToString());
        }
    } 
```

# sql - 在 SQL 存储过程中实现此联接

> ID：16164120
> 
> 赞同：1
> 
> 时间：2013-04-23T08:05:45.623
> 
> 标签：sql, stored-procedures, join

我有 4 个表 Position、Employee、Training 和 Trmatrix。

表位置

```
PositionId 职位名称 TrainingId
  1 开发者 1,2,3
  2 设计师 4,5
  3 BDA 2,3,6

```

表员工

```
Employeeid Ename Posid Courseid
   1 亚历克斯 1 4
   2 肖恩 2 1,2,3
   3 哈尔斯 3        

```

餐桌训练

```
Trainingid 培训名称
  1 爪哇
  2点网
  3 PHP
  4 Photoshop
  5 查询
  6 客户处理

```

矩阵

```
TrmatId TrID empID
 1 1 1
 2 2 1
 3 3 1
 4 4 1
 5 4 2
 6 5 2
 7 1 2
 8 2 2
 9 2 3
 10 3 3

```

foreign Key 关系 trmatrix trId 对应于trainingtable的trainingID。Employee posid 对应于 Positiontable 的 PositionId。Employee courseId 对应 trianingtable 的 trainingId。

通过基本目标是获取与 trmatrix 表相对应的 EMployee.Courseid 列中不存在的课程/培训名称，该表定义我必须从 trmatrix 表中获取员工中没有条目的所有条目表 Courseid 列。假设在 Alex 的情况下，我必须从 trmatrix 表中获取除 course 4 之外的所有数据，因为它存在于 Employee 表的 courseid 列中，所以它会返回 course no 1,2,3 而不是 no 4。我我是 SQL 的新手，所以请帮我解决这个问题。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:33:18.003

首先，您还应该制作 PositionTraining 和 EmployeeCourse 表：

职位培训

```
PositionId   TrainingId
  1          1
  1          2
  1          3
  2          4
  2          5
  3          2
  3          3
  3          6 
```

员工课程

```
Employeeid    Courseid 
   1          4
   2          1
   2          2
   3          3 
```

然后删除`Position.TrainingId`and `Employee.Courseid`。

通过这样做，您可以更轻松地查询数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:41:04.027

要从另一个表中获取一个表中不存在的东西，您可以使用

```
WHERE NOT EXISTS (SELECT value FROM OtherTable) 
```

或者

```
WHERE NOT IN (SELECT value FROM OtherTable) 
```

然而，有一类称为子查询的查询在这种情况下非常有用，关于它们的一篇非常好的文章在这里 [http://allenbrowne.com/subquery-01.html](http://allenbrowne.com/subquery-01.html) （它是为 ms 访问而编写的，但是 synstax 和 MS SQL规则完全相同，所以不要推迟）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T14:12:55.787

用于拆分条目的 UDF

```
Create function [dbo].[atf_BarListToTable]
    (@list ntext)
RETURNS @tbl TABLE (ListPosn int IDENTITY(1, 1) NOT NULL,
                          SString  VARCHAR(1028) NOT NULL) AS
BEGIN
    DECLARE @pos int
    DECLARE @textpos int
    DECLARE @ChunkLength smallint
    DECLARE @str nvarchar(4000)
    DECLARE @tmpstr nvarchar(4000)
    DECLARE @leftover nvarchar(4000)
    SET @textpos = 1
    SET @leftover = ''
    WHILE @textpos <= datalength(@list) / 2
    BEGIN
        SET @ChunkLength = 4000 - datalength(@leftover) / 2
        SET @tmpstr = ltrim(@leftover + substring(@list, @textpos, @ChunkLength))
        SET @textpos = @textpos + @ChunkLength
        SET @pos = charindex('|', @tmpstr)
        WHILE @pos > 0
            BEGIN
                SET @str = substring(@tmpstr, 1, @pos - 1)
                INSERT @tbl (SString) VALUES( @str)
                SET @tmpstr = ltrim(substring(@tmpstr, @pos + 1, len(@tmpstr)))
                SET @pos = charindex('|', @tmpstr)
            END
        SET @leftover = @tmpstr
    END
    IF ltrim(rtrim(@leftover)) <> ''
        INSERT @tbl (SString) VALUES(@leftover)
    RETURN
END 
```

# php - Mysql Fetch 问题 - 在本地罚款

> ID：16164121
> 
> 赞同：0
> 
> 时间：2013-04-23T08:05:47.177
> 
> 标签：php, mysql

我可以在 mysql 控制台中很好地执行以下查询，但是当尝试在 php 脚本中执行时，我得到了错误。这是我的查询：

```
$tfa2_db=mysql_query("select * from `avotf`.`callerid_vault` ORDER BY `dateused` LIMIT 100",$stor);
while ($tfa2 = mysql_fetch_row($tfa2_db)) { 
```

当我运行 php 文件时，它给了我以下信息：

```
mysql_fetch_row() expects parameter 1 to be resource, boolean given 
```

它告诉我我的查询有一个布尔值。我不确定出了什么问题。

非常感谢任何形式的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:08:02.123

这意味着您的 qurty 很可能失败并返回 false，我会在日志中找到错误并尝试从那里找出错误。

# ios - iPod 设备在 Xcode 中无法识别

> ID：16164125
> 
> 赞同：0
> 
> 时间：2013-04-23T08:05:50.710
> 
> 标签：ios, xcode, ios6, xcode4.5, ipod

我有一个新升级到`IOS 6.1`. 在我`xcode(4.5.2)`的 中，该设备未被识别。这发生在我升级设备操作系统之后。我已经尝试重新启动/重新启动设备并重新启动 xcode 和 mac。但是，它仍然没有被识别。

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:18:22.090

您需要将 Xcode 升级到 4.6 才能使用 iOS 6.1。

# android - Android RelativeLayout 选择器 state_pressed 不起作用

> ID：16164128
> 
> 赞同：15
> 
> 时间：2013-04-23T08:06:06.660
> 
> 标签：android, android-relativelayout

我有`RelativeLayout`这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
android:id="@+id/contacts"
xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_weight="0.2"
android:layout_width="wrap_content"
android:layout_height="wrap_content">

<ImageView
    android:id="@+id/image"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:adjustViewBounds="true"
    android:contentDescription="@string/content_description_contacts"
    android:scaleType="fitXY"
    android:src="@drawable/contacts" />

<TextView
    android:id="@+id/text"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_alignBottom="@id/image"
    android:paddingBottom="10dp"
    android:textColor="@drawable/text_color"
    android:text="@string/button_contacts"
    android:textSize="12sp" />    
</RelativeLayout> 
```

![在此处输入图像描述](https://i.stack.imgur.com/G28sM.png)

看起来像：

![在此处输入图像描述](https://i.stack.imgur.com/iqK3m.png)

我的`contacts`选择器似乎：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
<item android:state_pressed="true" 
    android:drawable="@drawable/contacts_over" />
<item android:state_selected="true"
    android:drawable="@drawable/contacts_selected" />
<item
     android:drawable="@drawable/contacts_default" />
</selector> 
```

如您所见，我有 3 张图像：默认情况下，选中并按下。

但我有一个问题：**只有默认值和`state_selected`图像按预期工作，但`state_pressed`似乎不起作用。**

我上面提到了几个`RelativeLayouts`，没有人使用`state_pressed`.

有人知道我的问题在哪里吗？

谢谢！

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-04-23T08:30:07.827

确保您的 RelativeLayout 是可点击的

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-12-21T19:05:08.930

您也可以设置`android:addStatesFromChildren="true"`在 your`RelativeLayout`而不是`android:clickeable="true"`. 如果您的孩子已经可点击、可聚焦等。您不应该让您的`RelativeLayout`可点击或可聚焦。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-23T08:09:29.617

尝试添加到您的 ImageView android:clickable="true"

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-23T08:14:55.120

在我看来，您应该`Button`为它使用和创建选择器，而不是通过创建`RelativeLayout`和放置自定义按钮`ImageView`和`TextView`. 然后你可以使用`android:drawableTop="@drawable/your_contact_icon"`. 之后，您可以检查您的选择器是否正常工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-02T08:28:33.837

希望这些对某人有所帮助；

1.  确保查看可点击。后代可以阻止点击事件。更多信息搜索以下属性。

android：可点击，android：descendantFocusability，android：focusable，android：focusableInTouchMode

2.  在样式 xml 中，您应该定义项目元素状态属性或确保没有属性的项目必须位于末尾。

    ```
    <?xml version="1.0" encoding="utf-8"?> <selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="true">
        <shape>
            <solid android:color="@color/lightGold"/>
            <stroke android:width="1dp" android:color="@color/lightGrey"/>
            <padding android:bottom="@dimen/padding1" android:left="@dimen/padding1" android:right="@dimen/padding1" android:top="@dimen/padding1"/>
        </shape>
    </item>
    <item>
        <shape>
            <solid android:color="@color/white_two"/>
            <stroke android:width="1dp" android:color="@color/lightGrey"/>
            <padding android:bottom="@dimen/padding1" android:left="@dimen/padding1" android:right="@dimen/padding1" android:top="@dimen/padding1"/>
        </shape>
    </item> 
    ```

但是这个样本不起作用；

```
<?xml version="1.0" encoding="utf-8"?><selector xmlns:android="http://schemas.android.com/apk/res/android">
<item>
    <shape>
        <solid android:color="@color/white_two"/>
        <stroke android:width="1dp" android:color="@color/lightGrey"/>
        <padding android:bottom="@dimen/padding1" android:left="@dimen/padding1" android:right="@dimen/padding1" android:top="@dimen/padding1"/>
    </shape>
</item>
<item android:state_pressed="true">
    <shape>
        <solid android:color="@color/lightGold"/>
        <stroke android:width="1dp" android:color="@color/lightGrey"/>
        <padding android:bottom="@dimen/padding1" android:left="@dimen/padding1" android:right="@dimen/padding1" android:top="@dimen/padding1"/>
    </shape>
</item> 
```

或者您可以为这两个项目定义状态属性。所以顺序并不重要。

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="false">
        <shape>
            <solid android:color="@color/white_two"/>
            <stroke android:width="1dp" android:color="@color/lightGrey"/>
            <padding android:bottom="@dimen/padding1" android:left="@dimen/padding1" android:right="@dimen/padding1" android:top="@dimen/padding1"/>
        </shape>
    </item>
    <item android:state_pressed="true">
        <shape>
            <solid android:color="@color/lightGold"/>
            <stroke android:width="1dp" android:color="@color/lightGrey"/>
            <padding android:bottom="@dimen/padding1" android:left="@dimen/padding1" android:right="@dimen/padding1" android:top="@dimen/padding1"/>
        </shape>
    </item>
</selector> 
```

参考；

> 在每次状态更改期间，从上到下遍历状态列表并使用与当前状态匹配的第一项——选择不是基于“最佳匹配”，而只是满足状态最低标准的第一项

状态列表 [https://developer.android.com/guide/topics/resources/drawable-resource.html](https://developer.android.com/guide/topics/resources/drawable-resource.html)

# web-services - 在 Scala 中模拟外部 Web 服务的最轻量级 Web 服务框架

> ID：16164129
> 
> 赞同：3
> 
> 时间：2013-04-23T08:06:08.850
> 
> 标签：web-services, scala, scalatra

我正在尝试测试一个依赖于外部 Web 服务的组件，我通过 Play WS 库访问该组件。该组件接收 web 服务的 url。

我想通过将组件连接到假网络服务来对组件进行单元测试。

哪个 scala web 框架更适合这个目的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T08:07:32.840

我找不到比[scalatra](http://www.scalatra.org/)更简单的东西。尽管主页上的代码**非常简单**，但您必须做一些额外的工作才能将 scalatra 嵌入您自己的应用程序/测试中。

```
import org.scalatra._
import org.eclipse.jetty.server.Server
import org.eclipse.jetty.webapp.WebAppContext

private class Mocker extends ScalatraServlet {
    get("/somepath") {
      <h1>Mocked response</h1>
    }
  }

// ↓ you won't need that part if you start jetty as sbt command

private val jetty = new Server(8080)
private val context = new WebAppContext()
context setContextPath "/"
context setResourceBase "/tmp"
context addServlet(classOf[Mocker], "/*")

jetty.setHandler(context)
jetty.start 
```

独立应用程序[真的那么简单](http://www.scalatra.org/getting-started/first-project.html)。

# java - Android 设置启动画面（活动），如 Iphone 第 2 部分

> ID：16164132
> 
> 赞同：3
> 
> 时间：2013-04-23T08:06:14.593
> 
> 标签：java, android, xml, scroll

在获得一次调用我的启动活动的解决方案（第 1[部分问题](https://stackoverflow.com/questions/16163365/android-setting-up-splash-screenactivity-like-iphone-part1)）之后，现在我必须设置我的启动活动。

在我的第一个布局上，我想要这样的功能：

**图片一 <--> 图片二 <--> 图片三 --> 第二个 xml(Activity)**

**同样在每个图像上，它们将是一个页面控件，该控件将指示当前在布局中的图像（如所附的屏幕截图）/或可以是任何其他方式来显示这一点。**

这意味着从图像一我可以在向右滚动时转到图像二（我可以在向左滚动时返回到图像一） 从图像二我可以在向右滚动时转到图像三（我可以从图像返回到图像 2三个如果我向左滚动）但是如果我从第三个图像向右滚动那么我应该进入我的第二个活动并且永远不会返回这些图像。

即，我希望在页面控制器中有这三个图像的滚动视图，然后在我们向下滚动到第三个/最后一个图像并进一步向右滚动后，我希望我的第二个活动应该被加载，并且启动画面不应该出现。

谁能告诉我如何做到这一点。

制作带有滚动视图和页面控制的启动表，并在滚动完成后切换到第二个活动。我不想要动画我希望它像滚动/或任何其他方式来实现它手动工作。

编码将不胜感激。

![在此处输入图像描述](https://i.stack.imgur.com/3qDZt.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T09:04:04.217

1.  要实现如上所示的可滚动图像，请使用[HERE](https://github.com/JakeWharton/Android-ViewPagerIndicator)`ViewPagerIndicator`给出的库。它易于集成，只需几分钟。您所要做的就是阅读给定链接中的*使用*部分。

**   对于最后一页的切换活动，只需执行`onPageChangeListener`链接中描述的操作并检查页码。*

# php - 如何在从 csv 获得的 HTML 表格中嵌入图标？

> ID：16164133
> 
> 赞同：0
> 
> 时间：2013-04-23T08:06:21.867
> 
> 标签：php, html

下面的 php 代码从 .csv 文件中提取数据并生成 HTML 表格。它工作正常。我想知道是否可以在 html 表中嵌入一些图标，例如与 csv 文件中的某些特定单词（例如：red、green）相对应的红点或绿点（reddot.gif、greendot.gif）。

换句话说，当在 csv 文件中的特定列（例如：第 3 列）中出现红色或绿色时，应该在生成的 html 文件中出现 reddot.gif 或 greendot.gif。

提前致谢。垫

```
<?php
$row = 1;
if (($handle = fopen("example.csv", "r")) !== FALSE) {
 while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
    $num = count($data);
    if ($row == 1) {
        echo '<tr>';
    }else{
        echo '<tr>';
    }

    for ($c=0; $c < $num; $c++) {

        if(empty($data[$c])) {
           $value = "&nbsp;";
        }else{
           $value = $data[$c];
        }
        if ($row == 1) {
// ------------- head row --------
            echo '<td style="border-top: 1px solid rgb(111,180,224); border-left: 1px solid rgb(111,180,224); border-bottom: 1px solid rgb(111,180,224);"  align="left" bgcolor="#0066cc" height="36" valign="middle" ><b><font color="#ffffff" size="2">&nbsp;&nbsp;'.$value.'&nbsp;&nbsp;</font></b></td>';
        }else{

// ------------- Generic row -------
            echo '<td style=" border-bottom: 1px solid rgb(111,180,224);" sdval="9" sdnum="1040;" align="left" bgcolor="#ffffff" height="25"  valign="middle"><font color="#000000" size="2">&nbsp;&nbsp;'.$value.'&nbsp;&nbsp;</font></td>';
        }
    }

    if ($row == 1) {
        echo '</tr>';
    }else{
        echo '</tr>';
    }
    $row++;
}

echo '</tbody></table>';
echo '</center>';   
fclose($handle);
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:49:59.423

**在任何循环之外**声明这个函数，就在 if 的开头，甚至在脚本的开头或结尾：

```
function img($img){ return "<img src='{$img}dot.gif'/>";} 
```

这在其他方面：

```
$value = preg_replace(array('/red/i', '/green/i'), array(img('red'), img('green')), $data[$c]); 
```

* * *

如果您需要更多颜色，只需按照逻辑将它们添加到 preg_replace 内的两个数组中。

如果您需要为图像添加属性，请在声明的函数中添加它们。

希望这对你有用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:14:09.337

请试一试。

```
 if(empty($data[$c])) {
       $value = "&nbsp;";
    }else{
       $value = $data[$c];
       switch(strtolower(trim($value))){
       case 'green': $value = '<img src="greendot.gif" '
                             .'alt="green" height="32" width="32">';
                             break;
       case 'red':   $value = '<img src="reddot.gif" '
                             .'alt="red" height="32" width="32">';
                             break;
       // you can add other cases here like blue, triangle etc :)
       }
    } 
```

# java - 将组件添加到 JTable

> ID：16164140
> 
> 赞同：0
> 
> 时间：2013-04-23T08:06:35.133
> 
> 标签：java, swing, jdbc, jtable, jbutton

我想在表中添加 JButton。我正在使用表格来显示数据库记录。实际上我想为表格中的每条记录添加按钮，但是该按钮未显示在表格上。它没有显示任何错误。请帮忙。提前致谢。

```
package addPanel;

import java.sql.*;
import javax.swing.*;
import javax.swing.table.DefaultTableModel;

public class panelShowData extends JPanel
{

    Connection connection = null;
    Statement statement = null;
    ResultSet resultSet = null;

    String url = "jdbc:mysql://localhost:3306/records";
    String driver = "com.mysql.jdbc.Driver";
    String userName = "root";
    String password = "";

    JScrollPane scrollPane;
    JTable table;
    DefaultTableModel tableModel;

    String nameSearch="";

    public panelShowData()
    {

         this.setLayout(null);
         setVisible(true);
         setBounds(0, 200, 500, 450);
    }

    public void searchData( String nameSearch)
    {

         tableModel = new DefaultTableModel();

            try 
            {           
                Class.forName( driver ).newInstance(  );
                connection = DriverManager.getConnection( url, userName, password );

                statement = connection.createStatement( ResultSet.TYPE_SCROLL_SENSITIVE,
                                    ResultSet.CONCUR_UPDATABLE );

                resultSet = statement.executeQuery( "select * from registration where firstname='"
                                    + nameSearch
                                + "'or lastname ='"
                                + nameSearch + "'" );

                System.out.println( "Query executed" );
                System.out.println( "nameSearch="+nameSearch );

                String firstName;
                String lastName;
                int id;

                JButton add=new JButton("ADD");

                    while ( resultSet.next(  ) )
                    {       
                        System.out.print( resultSet.getString( 2 ) + "\t" );
                        System.out.print( resultSet.getString( 4 ) + "\n" );

                        firstName = resultSet.getString( 2 );
                        lastName = resultSet.getString( 4 );
                        id = resultSet.getInt(1);

                        String[ ] columnName = { "Id","First Name", "Last Name","click" };
                        Object[ ] data = { id, ""+firstName, "" + lastName, add };

                        System.out.println("Names is:"+firstName);
                        tableModel.setColumnIdentifiers( columnName );
                        tableModel.addRow( data );
                        tableModel.fireTableDataChanged();
                    }

                table = new JTable( tableModel );
                table.setEnabled(false);
                scrollPane = new JScrollPane( table );
                scrollPane.setBounds( 10, 10, 350, 100 );
                scrollPane.revalidate();
                scrollPane.repaint();

                add( scrollPane );
                connection.close(  );   
            }
            catch (Exception e)
            {
                e.printStackTrace();
                JOptionPane.showMessageDialog(  null, "Record Not Found",
                                "Sorry", JOptionPane.ERROR_MESSAGE );
            }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T11:22:11.733

1.  您帖子中的所有代码行都是重要原因，为什么有 ResultSetTableModel、TableFromDatabase（和/或从 SwingWorker、Runnable#Thread 调用的 JDBC）
2.  永远不要调用 tableModel.fireTableDataChanged();,
    *   在 XxxTableModel 定义之外
    *   DefaultTableModel 已实现此通知程序并正确
    *   您的代码需要覆盖此通知程序，因为谈论 Swing 中的并发性（[Oracle 教程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)），再次谈到我的第 1 点。
3.  重要的一切都在那里，请[阅读有关 ListModel 和 JList 的答案](https://stackoverflow.com/a/16166269/714968)，所有要点，相同的问题，
4.  JPanel在API中实现了FlowLayout，没有理由使用NullLayout，改为BorderLayout
5.  覆盖 getPreferredSize 以获得 JPanel 的合理 Dimension，包含 JScrollPane 中包装的 JTable
6.  [JTable中添加的JButton在这里解决了几次](https://stackoverflow.com/questions/tagged/java+swing+jtable+jbutton)

# git - 在使用 svn2git 创建的 repo 上使用 git svn

> ID：16164144
> 
> 赞同：4
> 
> 时间：2013-04-23T08:06:45.103
> 
> 标签：git, svn, svn2git

我们正在将旧的 SVN 存储库迁移到 Git。这与[svn2git](https://github.com/nirvdrum/svn2git)配合得很好。现在我们想专门在 git 上工作，但需要将任何新的 git 提交镜像到旧的 SVN 存储库。这是必要的，因为一些生产系统仍然通过 SVN 部署。

所以我尝试`git svn`在我之前运行的同一个存储库上使用`svn2git`。我不是专家（还），但我认为，这样的事情应该可以解决问题：

```
$ git svn dcommit --interactive
Unable to determine upstream SVN information from HEAD history.
Perhaps the repository is empty. at /usr/lib/git-core/git-svn line 780. 
```

我还尝试获取有关导入的 SVN 数据的一些信息：

```
$ git svn info
Unable to determine upstream SVN information from working tree history 
```

因此，似乎`svn2git`做了一些魔术并`git svn`处于“未配置状态”。据我所知，git 必须保留一些引用以将 SVN 提交映射到 git 提交。相反的命令`svn2git --rebase`起作用：它获取任何新的 SVN 提交并将它们应用到 git repo。所以数据似乎在那里并且可供`svn2git`（AFAIK基于`git svn`）使用。

那么我怎样才能`git svn`工作呢？还是有另一种方法可以将 git 提交从那个新的 repo 反向移植到 SVN（无需从头开始）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-22T09:45:43.997

尝试“git svn rebase”。

我遇到了完全相同的问题，并使用了托管@vhttps://github.com/nirvdrum/svn2git 的包装脚本。请花点时间阅读[SVN 到 GIT 迁移失败，使用 svn2git](https://stackoverflow.com/questions/9890247/svn-to-git-migration-failed-using-svn2git/13985703#13985703)。

# javascript - 用于测验的 HTML5 拖放

> ID：16164147
> 
> 赞同：0
> 
> 时间：2013-04-23T08:07:01.900
> 
> 标签：javascript, html, drag-and-drop

我正在做基于网络的测验来帮助一些人获得一些资格。在最近发现了 HTML5 的奇妙世界之后（我之前一直在用 XHTML 进行编程），我认为将图片从开始框拖放到答案框的能力将是打破列表单调的一个很好的补充，单选按钮和文本框。

我无权访问 PHP 或 JQUERY。（该站点旨在在没有互联网的机器上运行，我也无权设置 Web 服务器来支持 PHP）。

是否有可能使用 JavaScript 和四个框/div（一个用于起始位置和三个可能的答案框）来确定图像在哪个框/div 中？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:38:44.033

您可以下载 jQuery ( [http://jquery.com/download/](http://jquery.com/download/) ) 和 jQuery UI ( [http://jqueryui.com/download/](http://jqueryui.com/download/) ) 并将它们作为脚本添加到您的页面

然后看看 jQuery UI 文档上的可拖动和可放置：http: [//jqueryui.com/droppable/](http://jqueryui.com/droppable/)

# c - 在 Lua 中，我应该如何处理来自 C 的从零开始的数组索引？

> ID：16164149
> 
> 赞同：16
> 
> 时间：2013-04-23T08:07:07.673
> 
> 标签：c, lua, lua-table

在 C 代码中，我有一个数组和一个从零开始的索引，用于在其中查找，例如：

```
char * names[] = {"Apple", "Banana", "Carrot"};
char * name = names[index]; 
```

从嵌入式 Lua 脚本中，我可以`index`通过`getIndex()`函数访问并希望复制数组查找。鉴于 Lua 的 one-based 数组，是否有一致的“最佳”方法来执行此操作？

例如，我可以创建一个与我的 C 数组内容相同的 Lua 数组，但这需要在索引时添加 1：

```
names = {"Apple", "Banana", "Carrot"}
name = names[getIndex() + 1] 
```

或者，我可以通过使用更复杂的表来避免添加 1，但这会破坏以下内容`#names`：

```
names = {[0] = "Apple", "Banana", "Carrot"}
name = names[getIndex()] 
```

推荐什么方法？

**编辑：**谢谢你到目前为止的答案。不幸的是，在 getIndex 函数中将索引加 1 的解决方案并不总是适用。这是因为在某些情况下索引是“众所周知的”——也就是说，可以记录索引 0 表示“Apple”等等。在这种情况下，是否应该首选上述解决方案中的一个或另一个，还是有更好的选择？

**编辑2：**再次感谢您的回答和评论，他们确实帮助我思考了这个问题。我已经意识到可能有两种不同的情况会出现问题，并且每种情况的理想解决方案都可能不同。

例如，在第一种情况下，考虑一个可能不时不同的数组和一个仅相对于当前数组的索引。索引在代码之外没有任何意义。Doug Currie 和 RBerteig 是绝对正确的：数组应该是从 1 开始的并且`getIndex`应该包含一个`+1`. 如前所述，这允许 C 和 Lua 端的代码是惯用的。

第二种情况涉及有意义的索引，并且可能是一个始终相同的数组。一个极端的例子是 where `names`contains `"Zero", "One", "Two"`。在这种情况下，每个索引的期望值是众所周知的，我觉得让Lua端的索引基于one是不直观的。我相信应该首选其他方法之一。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-23T21:53:33.317

使用从 1 开始的 Lua 表，并把函数埋在`+ 1`里面`getIndex`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-26T16:22:26.170

这就是 Lua 方法和元表派上用场的地方。使用表代理和几个元方法，您可以以适合您需要的方式修改对表的访问。

```
local names = {"Apple", "Banana", "Carrot"} -- Original Table
local _names = names -- Keep private access to the table
local names = {}    -- Proxy table, used to capture all accesses to the original table

local mt = {
  __index = function (t,k)
    return _names[k+1]   -- Access the original table
  end,

  __newindex = function (t,k,v)
    _names[k+1] = v   -- Update original table
  end
}

setmetatable(names, mt) 
```

所以这里发生的事情是，原始表有自己的代理，然后代理会捕获对表的每次访问尝试。当访问表时，它会增加访问它的值，模拟一个从 0 开始的数组。以下是打印结果：

```
print(names[0]) --> Apple
print(names[1]) --> Banana
print(names[2]) --> Carrot
print(names[3]) --> nil

names[3] = "Orange" --Add a new field to the table
print(names[3]) --> Orange 
```

所有的表操作都像往常一样。使用这种方法，您不必担心会弄乱对表的任何非正常访问。

编辑：我想指出新的“名称”表只是访问原始名称表的代理。因此，如果您查询`#names`结果将为 nil，因为该表本身没有值。您需要查询`#_names`以访问原始表的大小。

编辑 2：正如查尔斯斯图尔特在下面的评论中指出的那样，您可以将 __len 元方法添加到 mt 表中，以确保 #names 调用为您提供正确的结果。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-26T04:52:03.247

First of all, this situation is not unique to applications that mix Lua and C; you can face the same question even when using Lua only apps. To provide an example, I'm using an editor component that indexes lines starting from 0 (yes, it's C-based, but I only use its Lua interface), but the lines in the script that I edit in the editor are 1-based. So, if the user sets a breakpoint on line 3 (starting from 0 in the editor), I need to send a command to the debugger to set it on line 4 in the script (and convert back when the breakpoint is hit).

Now the suggestions.

(1) I personally dislike using `[0]` hack for arrays as it breaks too many things. You and Egor already listed many of them; most importantly for me it breaks `#` and `ipairs`.

(2) When using 1-based arrays I try to avoid indexing them and to use iterators as much as possible: `for i, v in ipairs(...) do` instead of `for i = 1, #array do`).

(3) I also try to isolate my code that deals with these conversions; for example, if you are converting between lines in the editor to manage markers and lines in the script, then have `marker2script` and `script2marker` functions that do the conversion (even if it's simple +1 and -1 operations). You'd have something like this anyway even without +1/-1 adjustments, it would just be implicit.

(4) If you can't hide the conversion (and I agree, +1 may look ugly), then make it even more noticeable: use c2l and l2c calls that do the conversion. In my opinion it's not as ugly as +1/-1, but has the advantage of communicating the intent and also gives you an easy way to search for all the places where the conversion happens. It's very useful when you are looking for off-one bugs or when API changes cause updates to this logic.

Overall, I wouldn't worry about these aspects too much. I'm working on a fairly complex Lua app that wraps several 0-based C components and don't remember any issues caused by different indexing...

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-04-23T09:27:51.320

我更喜欢

```
names = {[0] = "Apple", "Banana", "Carrot"}
name = names[getIndex()] 
```

某些表格操作功能 - `#`, `insert`, `remove`, `sort`- 已损坏。
其他 - `concat(t, sep, 0)`, `unpack(t, 0)`- 需要明确的起始索引才能正确运行：

```
print(table.concat(names, ',', 0))  --> Apple,Banana,Carrot
print(unpack(names, 0))             --> Apple   Banana  Carrot 
```

我讨厌不断地记住这一点，`+1`以迎合 Lua 默认的基于 1 的索引样式。
您的代码应该反映您的领域特定索引，以便更具可读性。
如果基于 0 的索引非常适合您的任务，则应该在 Lua 中使用基于 0 的索引。

我喜欢 Pascal 中数组索引的实现方式：您完全可以自由选择所需的任何范围，例如，`array[-10..-5]of byte`对于 6 个元素的数组来说绝对可以。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-04-30T15:19:14.200

为什么不把 C 数组也变成一个基于 1 的数组呢？

```
char * names[] = {NULL, "Apple", "Banana", "Carrot"};
char * name = names[index]; 
```

坦率地说，这会导致 C 端出现一些不直观的代码，但如果你坚持必须有在双方都有效的“知名”索引，这似乎是最好的选择。

一个更干净的解决方案当然是不让那些“众所周知的”索引成为界面的一部分。例如，您可以使用命名标识符而不是普通数字。在 C 端，枚举是一个很好的匹配，而在 Lua 中，您甚至可以使用字符串作为表键。

另一种可能性是将表封装在接口后面，这样用户就不会直接访问数组，而只能通过 C 函数调用，然后可以执行任意复杂的索引转换。然后你只需要在 Lua 中公开那个 C 函数，你就有了一个干净且可维护的解决方案。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-05-02T06:43:17.463

为什么不将你的 C 数组作为用户数据呈现给 Lua？[该技术在PiL 的“用户数据”部分](http://www.lua.org/pil/28.1.html)中使用代码进行了描述；您可以设置`__index`, `__newindex`, 和metatable 方法，并且您可以从一个类继承以提供其他序列操作函数作为常规方法（例如，使用, ,函数`__len`定义一个数组，可以通过进一步调整将其定义为对象方法） . 以这种方式做事意味着你在 Lua 和 C 之间没有“同步”问题，并且它避免了“数组”表被视为普通表而导致错误的风险。`array.remove``array.sort``array.pairs``__index`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-11-05T20:59:01.123

您可以通过使用了解不同索引基数的迭代器来修复此 lua 缺陷：

```
function iarray(a)
  local n = 0
  local s = #a
  if a[0] ~= nil then
    n = -1
  end
  return function()
    n = n + 1
    if n <= s then return n,a[n] end
  end
end 
```

但是，您仍然必须手动添加第零个元素：

使用示例：

```
myArray = {1,2,3,4,5}
myArray[0] = 0
for _,e in iarray(myArray) do
  -- do something with element e
end 
```

# c# - wcf 上的 HttpContex 为空

> ID：16164168
> 
> 赞同：2
> 
> 时间：2013-04-23T08:07:58.547
> 
> 标签：c#, wcf, httpcontext, appserver

我有 2 台服务器 Web 服务器和应用服务器上的应用服务器，我正在运行 WCF。在 wcf 上的任何函数中，我试图使用 System.Web.HttpContext.Current.User 获取当前用户，但我得到 null 有一种方法可以让用户无需将参数移动到任何函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:11:54.147

WCF 试图与 ASP.NET 保持距离，因为它可以在任意数量的主机上运行——而不仅仅是 ASP.NET。这也允许它切出大块 ASP.NET 管道，从而提高吞吐量。您可以通过添加以下内容强制它使用 ASP.NET 模式：

```
<serviceHostingEnvironment aspNetCompatibilityEnabled="true"/> 
```

到配置，但坦率地说，你最好（IMO）使用线程主体。WCF 完全支持主体模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:10:18.980

尝试使用`ServiceSecurityContext.Current.PrimaryIdentity`.

# python - 在 python 中将处理后的图像编码为 BASE64 以便在 json 中使用

> ID：16164171
> 
> 赞同：0
> 
> 时间：2013-04-23T08:08:20.637
> 
> 标签：python, image, base64

我是stackoverflow的新手，这将是我的第一个问题。我会尽力解释我的问题。

我正在为服务器做 python 代码。我在哪里加载图像并对其进行大量图像处理。它最终成为 np.array 二进制掩码（如果需要，可以转换为 Image 对象）。现在我需要在base64中编码这个图像，用json把它发送给客户端。在客户端，它不是 python 代码，它必须作为普通图像格式进行解码和读取。我只找到了对直接从文件加载的图像进行编码的示例。因此，一种解决方案是将其保存为临时图像，然后加载此图像并对其进行编码。但这非常难看。必须有一种方法可以直接对其进行编码并指定您要将其编码为什么图像格式？

# c++ - 有通用的智能指针吗？

> ID：16164172
> 
> 赞同：3
> 
> 时间：2013-04-23T08:08:24.567
> 
> 标签：c++, generics, smart-pointers

我最近阅读了各种智能指针类型，我认为尤其是 unique_ptr 将非常有用，并且在某种程度上，shared_ptr 和weak_ptr 也是如此。但是我不确定如何创建可以处理任何一种指针类型的“通用”函数，如果这甚至是一个好主意。

所以想象有一个由智能指针封装的对象向量，你想使用一个函数对所有元素应用一些操作，如下所示：

```
void doSomething(vector<shared_ptr<SomeType>>& array) {
   // iterate over all array elements and do something
} 
```

显然，您需要为 shared/unique/weak_ptr 复制此函数 3 次，这有点麻烦。拥有适合所有函数参数使用的“通用”/“多态”智能指针类型会更容易：

```
void doSomething(vector<generic_ptr<SomeType>>& array) {
   // iterate over all array elements and do something
   // no matter if array is a vector<shared_ptr> or vector<unique_ptr>
} 
```

那么，是否存在这样的智能指针呢？如果是 - 使用它可能会出现哪些问题？如果没有 - 为什么不呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T08:12:38.127

不同的指针类型允许不同的所有权处理，需要不同的运行时开销。在您的情况下，您可以使用模板：

```
template<typename TVector>
void doSomething(TVector& array) {
   // iterate over all array elements and do something
} 
```

并对所有智能（而不是那么智能）指针使用 common`operator*`和`operator->`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T09:17:38.607

一些误解会导致尴尬的代码风格：

1.  智能指针与原始指针一样通用：在调用指向对象的函数时，您可以将它们视为相同。如果您确实需要将它们传递给采用原始指针的函数（并且这些函数不会获得所有权），您可以使用它们的`get()`函数为您提供该指针。见 3。

2.  作用于集合的函数不应该将集合作为参数，而应该是一个带有一对迭代器的模板，然后可以通过取消引用迭代器指向的指针来使用它，从而为您提供对真实对象的引用。

3.  不要编写采用原始指针的函数。改用引用并在调用站点取消引用。我知道这并不总是可能的，但大多数情况下是这样。

在函数中循环的另一种方法是使函数作用于单个对象（引用），并将循环放在调用点。C++11 让这变得非常干净：

```
void some_function(item_type& item); // const if necessary
for(auto&& item_ptr : collection_of_item_smart_ptrs)
  some_function(*item_ptr); 
```

清楚地表达意图、目的和类型，没有任何句法或风格上的麻烦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:15:42.350

所有这些指针类型实际上都包装了一个裸指针。所以我们有两种情况：

1.  您的方法以某种方式修改了指针。在这种情况下，您将无法概括它，因为它应该根据类型而有所不同。

2.  你永远不会修改指针。只需将 const 裸指针传递给函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T08:16:42.397

这些智能指针类型中的每一种都有其 onw 使用模型。

*   unique_ptr 不能放在容器中，它既不可复制也不可复制分配

*   weak_ptr 必须转换为 shared_ptr 才能访问引用的对象。例如，可用于缓存，在所有地方使用都很麻烦。

*   shared_ptr 是在你的情况下走的路

# java - 在真实的 Java 程序中使用 IPv6

> ID：16164175
> 
> 赞同：8
> 
> 时间：2013-04-23T08:08:30.860
> 
> 标签：java, network-programming, ipv6

现在 IPv6 的使用正在慢慢开始，所以我目前正在修复和更新所有应用程序，为 IPv6 做好准备。

应用程序之一是 Java 编辑器 JOSM ( [http://josm.openstreetmap.de/](http://josm.openstreetmap.de/) )。即使操作系统使用 IPv6，Java 也不会在默认配置中真正使用 IPv6。

根据 [http://docs.oracle.com/javase/1.5.0/docs/guide/net/ipv6_guide/#using](http://docs.oracle.com/javase/1.5.0/docs/guide/net/ipv6_guide/#using) 我设置`java.net.preferIPv6Addresses`让它`true`使用 IPv6。结果是有关断开互联网连接的用户错误报告。

似乎 Java 只切换到使用 IPv6 地址而不是 IPv4，但没有做任何其他事情。我维护的所有基于 C/C++ 的软件都已更改为检查并尝试所有可用的 IP 地址，因此只要其中一个地址有效，就会跳过损坏的 IPv6（或 IPv4）地址。对我来说，Java 似乎只尝试一次，这在现实世界中是行不通的。

当 IPv6 被隧道化时，操作系统通常更喜欢 IPv4 而不是 IPv6。Java 似乎也忽略了这个设置。

所以我的问题是：有什么好的方法可以让 Java 应用程序在默认情况下使用 IPV6，而不会破坏 IPv4 用户的应用程序。

用户错误报告： http: [//josm.openstreetmap.de/ticket/8562，http](http://josm.openstreetmap.de/ticket/8562) : [//josm.openstreetmap.de/ticket/8627](http://josm.openstreetmap.de/ticket/8627)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-14T13:48:56.150

似乎这个话题对其他人来说也很有趣，所以我描述了我目前的解决方案。

*   该软件会检测 IPv6 是否工作并记住状态 -> 这是通过 TCP 连接到已知的 IPv6 地址来完成的（isReachable() 的 Ping 不可靠，请参阅此错误报告：[https://josm。 openstreetmap.de/ticket/11452](https://josm.openstreetmap.de/ticket/11452)）。
*   根据记住的状态，软件以“java.net.preferIPv6Addresses”设置为“true”开始。
*   这意味着对于从 IPv4 到 IPv6 网络的切换，它将使用 IPv4 直到下一次重新启动，这没关系。
*   对于从启用 IPv6 到仅 IPv4 的网络的切换，它根本无法工作，这可以通过重新启动软件来解决。
*   如有疑问，我们假设 IPv6 不起作用。
*   进行检测后无法更改“java.net.preferIPv6Addresses”，因为该值似乎只能在第一次网络连接之前读取。如果有办法在运行时重置该状态，我想知道它。

这个解决方案似乎有效，我们的日志 ATM 中有大约 4% 的 IPv6 连接，但这并不是一个真正令人满意的解决方案。

```
/**
 * Check if IPv6 can be safely enabled and do so. Because this cannot be done after network activation,
 * disabling or enabling IPV6 may only be done with next start.
 */
private static void checkIPv6() {
  if ("auto".equals(Main.pref.get("prefer.ipv6", "auto"))) {
    new Thread(new Runnable() { /* this may take some time (DNS, Connect) */
      public void run() {
        boolean hasv6 = false;
        boolean wasv6 = Main.pref.getBoolean("validated.ipv6", false);
        try {
          /* Use the check result from last run of the software, as after the test, value
             changes have no effect anymore */
          if (wasv6) {
            Utils.updateSystemProperty("java.net.preferIPv6Addresses", "true");
          }
          for (InetAddress a : InetAddress.getAllByName("josm.openstreetmap.de")) {
            if (a instanceof Inet6Address) {
              if (a.isReachable(1000)) {
                /* be sure it REALLY works */
                Socket s = new Socket();
                s.connect(new InetSocketAddress(a, 80), 1000);
                s.close();
                Utils.updateSystemProperty("java.net.preferIPv6Addresses", "true");
                if (!wasv6) {
                  Main.info(tr("Detected useable IPv6 network, prefering IPv6 over IPv4 after next restart."));
                } else {
                  Main.info(tr("Detected useable IPv6 network, prefering IPv6 over IPv4."));
                }
                hasv6 = true;
              }
              break; /* we're done */
            }
          }
        } catch (IOException | SecurityException e) {
          if (Main.isDebugEnabled()) {
            Main.debug("Exception while checking IPv6 connectivity: "+e);
          }
        }
        if (wasv6 && !hasv6) {
          Main.info(tr("Detected no useable IPv6 network, prefering IPv4 over IPv6 after next restart."));
          Main.pref.put("validated.ipv6", hasv6); // be sure it is stored before the restart!
          new RestartAction().actionPerformed(null);
        }
        Main.pref.put("validated.ipv6", hasv6);
      }
    }, "IPv6-checker").start();
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T17:27:20.213

所以你在这里有两个问题：

1.  操作系统供应商提供带有损坏的默认 IPv6 配置的操作系统，和/或用户启用损坏的 IPv6 配置。

2.  当它不起作用时，他们会错误地责怪你。

您可以在这里做两件事：

1.  建议用户如何禁用不必要的和损坏的 IPv6 转换机制，例如 Teredo、ISATAP 和 6to4。这些说明可在 Internet 上广泛获取。

    如果某些操作系统供应商默认不启用这种废话，那也很好，但这可能要求太多了。

2.  在您的应用程序中实现 Happy Eyeballs ( [RFC 6555](https://www.rfc-editor.org/rfc/rfc6555) )。这就是现代网络浏览器解决这个问题的方式。

    Happy Eyeballs 指定了一种算法，应用程序通过该算法尝试（几乎）同时通过 IPv6 和 IPv4 进行连接，如果 IPv6 在短时间内无法工作，则回退到 IPv4 连接。该试验的结果也会被缓存几分钟。

    不幸的是，我对 Java 不够熟悉，无法为您提供特定的代码来绕过 Oracle 默认情况下向您隐藏的所有有趣的东西，但它*应该*是可行的。

# asp.net - WAMP 上的 ASPX (asp.net)

> ID：16164178
> 
> 赞同：0
> 
> 时间：2013-04-23T08:08:38.893
> 
> 标签：asp.net, wamp

我正在使用 WAMP，最近我一直在处理扩展名为**.aspx**的文件。我正在尝试为 wamp 安装模块： **mod_aspdotnet**但随后出现错误：

`C:\Program Files (x86)\Apache Software Foundation\apache2\ is not a valid path to an installed instance of apache.`

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:16:17.233

> mod_aspdotnet 是一个用于 Apache HTTP Server 2.0.44 或更高版本的模块，在 Windows、Windows NT Service Pack 6 或更高版本（包括 2000、2003、XP 和 Vista）上运行**，带有 .NET Framework 1.1**（或 1.0），包括 Microsoft 的 ASP。 NET 托管框架。
> 
> 它最初由 Covalent Technologies 开发，曾在 Apache 软件基金会工作过一段时间，现在由托管在 SourceForge 上并由 Covalent Technologies 赞助的 mod-aspdotnet 项目维护。**不知道它是否可以在非 Windows 平台上使用** ***早期版本的 Apache，或 .NET** ***框架的 2.0 和更高版本。***有关更多详细信息，请参阅项目页面。

[http://mod-aspdotnet.sourceforge.net/](http://mod-aspdotnet.sourceforge.net/)

# linux - 在 Perl 中运行 Shell 命令

> ID：16164179
> 
> 赞同：1
> 
> 时间：2013-04-23T08:09:02.807
> 
> 标签：linux, perl, shell, command, execute

我可以在 Perl 中运行一些 Shell Linux 命令（例如创建一个文件夹）。但我无法执行以下命令：

```
echo 'mypassword' | gpg --passphrase-fd 0 --output outfile --decrypt inputfile 
```

我将此命令添加到 .sh 文件中，并且可以在 Shell 中正常执行。但是当我调用 .sh 文件时，Perl 无法运行它。我使用`open3`, `system`,`open`命令运行。我可以运行其他 .sh 文件，但不能运行此命令。

你能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:19:16.873

尝试使用反引号/反引号，似乎工作正常：

```
#!/usr/bin/perl
use strict;

`echo 'mypassword' | gpg --passphrase-fd 0 --output outfile --decrypt inputfile` 
```

PS我最好使用一些像[GPG](http://search.cpan.org/~miles/GPG-0.06/GPG.pm)这样的 cpan 模块。

# mysql - 如何通过 dbgrid 更改 mysql 数据库的值？

> ID：16164180
> 
> 赞同：0
> 
> 时间：2013-04-23T08:09:03.017
> 
> 标签：mysql, database, delphi, tdbgrid, unidac

嘿伙计们早上好，

我有一个 DBGrid 和 UniDac 组件。我使用弹出菜单并选择一行。我通过弹出菜单中的 onclick 事件在我的 TEdit 中用我的数据填写一个新表单。

现在的问题是，我想编辑从 dbgrid 中选择的数据。

这段代码一直有效，直到刷新 dbgrid，然后旧值又回到我的 dbgrid 中。我如何不仅为 dbgrid 也为 mysql 表更改它？

我的实际代码：

```
 FQuery.Edit;
   FQuery.FieldByName('CfgUID').AsString := Edit4.Text;
   FQuery.FieldByName('CfgMod').AsString := Edit1.Text;
   FQuery.Post; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T14:05:37.663

解决方案是禁用 CachedUpdates 或在 Post 之后调用 ApplyUpdates。

# c++ - 从 libcuda.so.1 调用的 __pthread_getspecific 中的分段错误

> ID：16164185
> 
> 赞同：7
> 
> 时间：2013-04-23T08:09:14.847
> 
> 标签：c++, cuda, segmentation-fault

**问题：**分段错误（SIGSEGV，信号 11）

**简要程序说明：**

*   处理来自远程客户端的请求的高性能 gpu (CUDA) 服务器
*   每个传入的请求都会产生一个线程，该线程在多个 GPU（串行，非并行）上执行计算并将结果发送回客户端，这通常需要 10-200 毫秒，因为每个请求都包含数十或数百个内核调用
*   请求处理线程具有对 GPU 的独占访问权限，这意味着如果一个线程在 GPU1 上运行某些东西，所有其他线程都必须等到它完成
*   使用 -arch=sm_35 -code=compute_35 编译
*   使用 CUDA 5.0
*   我没有明确使用任何 CUDA 原子或任何内核同步障碍，尽管我显然使用了推力（各种函数）和 cudaDeviceSynchronize()
*   Nvidia 驱动程序：NVIDIA dlloader X Driver 313.30 Wed Mar 27 15:33:21 PDT 2013

**操作系统和硬件信息：**

*   Linux lub1 3.5.0-23-generic #35~precise1-Ubuntu x86_64 x86_64 x86_64 GNU/Linux
*   GPU：4x GPU 0：GeForce GTX TITAN
*   32 GB 内存
*   MB：华硕 MAXIMUS V EXTREME
*   CPU：i7-3770K

**崩溃信息：**

在处理了数千个请求后（有时更快，有时更晚），崩溃“随机”发生。一些崩溃的堆栈跟踪如下所示：

```
#0  0x00007f8a5b18fd91 in __pthread_getspecific (key=4) at pthread_getspecific.c:62
#1  0x00007f8a5a0c0cf3 in ?? () from /usr/lib/libcuda.so.1
#2  0x00007f8a59ff7b30 in ?? () from /usr/lib/libcuda.so.1
#3  0x00007f8a59fcc34a in ?? () from /usr/lib/libcuda.so.1
#4  0x00007f8a5ab253e7 in ?? () from /usr/local/cuda-5.0/lib64/libcudart.so.5.0
#5  0x00007f8a5ab484fa in cudaGetDevice () from /usr/local/cuda-5.0/lib64/libcudart.so.5.0
#6  0x000000000046c2a6 in thrust::detail::backend::cuda::arch::device_properties() ()

#0  0x00007ff03ba35d91 in __pthread_getspecific (key=4) at pthread_getspecific.c:62
#1  0x00007ff03a966cf3 in ?? () from /usr/lib/libcuda.so.1
#2  0x00007ff03aa24f8b in ?? () from /usr/lib/libcuda.so.1
#3  0x00007ff03b3e411c in ?? () from /usr/local/cuda-5.0/lib64/libcudart.so.5.0
#4  0x00007ff03b3dd4b3 in ?? () from /usr/local/cuda-5.0/lib64/libcudart.so.5.0
#5  0x00007ff03b3d18e0 in ?? () from /usr/local/cuda-5.0/lib64/libcudart.so.5.0
#6  0x00007ff03b3fc4d9 in cudaMemset () from /usr/local/cuda-5.0/lib64/libcudart.so.5.0
#7  0x0000000000448177 in libgbase::cudaGenericDatabase::cudaCountIndividual(unsigned int, ...

#0  0x00007f01db6d6153 in ?? () from /usr/lib/libcuda.so.1
#1  0x00007f01db6db7e4 in ?? () from /usr/lib/libcuda.so.1
#2  0x00007f01db6dbc30 in ?? () from /usr/lib/libcuda.so.1
#3  0x00007f01db6dbec2 in ?? () from /usr/lib/libcuda.so.1
#4  0x00007f01db6c6c58 in ?? () from /usr/lib/libcuda.so.1
#5  0x00007f01db6c7b49 in ?? () from /usr/lib/libcuda.so.1
#6  0x00007f01db6bdc22 in ?? () from /usr/lib/libcuda.so.1
#7  0x00007f01db5f0df7 in ?? () from /usr/lib/libcuda.so.1
#8  0x00007f01db5f4e0d in ?? () from /usr/lib/libcuda.so.1
#9  0x00007f01db5dbcea in ?? () from /usr/lib/libcuda.so.1
#10 0x00007f01dc11e0aa in ?? () from /usr/local/cuda-5.0/lib64/libcudart.so.5.0
#11 0x00007f01dc1466dd in cudaMemcpy () from /usr/local/cuda-5.0/lib64/libcudart.so.5.0
#12 0x0000000000472373 in thrust::detail::backend::cuda::detail::b40c_thrust::BaseRadixSortingEnactor

#0  0x00007f397533dd91 in __pthread_getspecific (key=4) at pthread_getspecific.c:62
#1  0x00007f397426ecf3 in ?? () from /usr/lib/libcuda.so.1
#2  0x00007f397427baec in ?? () from /usr/lib/libcuda.so.1
#3  0x00007f39741a9840 in ?? () from /usr/lib/libcuda.so.1
#4  0x00007f39741add08 in ?? () from /usr/lib/libcuda.so.1
#5  0x00007f3974194cea in ?? () from /usr/lib/libcuda.so.1
#6  0x00007f3974cd70aa in ?? () from /usr/local/cuda-5.0/lib64/libcudart.so.5.0
#7  0x00007f3974cff6dd in cudaMemcpy () from /usr/local/cuda-5.0/lib64/libcudart.so.5.0
#8  0x000000000046bf26 in thrust::detail::backend::cuda::detail::checked_cudaMemcpy(void* 
```

如您所见，通常它最终会`__pthread_getspecific`从`libcuda.so`库本身或某个地方调用。据我记得，只有一种情况它没有崩溃，而是以一种奇怪的方式挂起：如果我的请求不涉及任何 GPU 计算（统计数据等），程序能够响应我的请求，否则我从来没有得到答复。此外，执行 nvidia-smi -L 不起作用，它只是挂在那里，直到我重新启动计算机。在我看来，这有点像 GPU 死锁。不过，这可能是与此完全不同的问题。

有没有人知道问题可能出在哪里或可能导致这种情况的原因？

**更新：**

一些额外的分析：

*   `cuda-memcheck`不打印任何错误消息。
*   `valgrind`- 泄漏检查确实会打印很多消息，如下所示（有数百个这样的消息）：

> ```
> ==2464== 16 bytes in 1 blocks are definitely lost in loss record 6 of 725
> ==2464==    at 0x4C2B1C7: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
> ==2464==    by 0x568C202: ??? (in /usr/local/cuda-5.0/lib64/libcudart.so.5.0.35)
> ==2464==    by 0x56B859D: ??? (in /usr/local/cuda-5.0/lib64/libcudart.so.5.0.35)
> ==2464==    by 0x5050C82: __nptl_deallocate_tsd (pthread_create.c:156)
> ==2464==    by 0x5050EA7: start_thread (pthread_create.c:315)
> ==2464==    by 0x6DDBCBC: clone (clone.S:112)
> ==2464==
> ==2464== 16 bytes in 1 blocks are definitely lost in loss record 7 of 725
> ==2464==    at 0x4C2B1C7: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
> ==2464==    by 0x568C202: ??? (in /usr/local/cuda-5.0/lib64/libcudart.so.5.0.35)
> ==2464==    by 0x56B86D8: ??? (in /usr/local/cuda-5.0/lib64/libcudart.so.5.0.35)
> ==2464==    by 0x5677E0F: ??? (in /usr/local/cuda-5.0/lib64/libcudart.so.5.0.35)
> ==2464==    by 0x400F90D: _dl_fini (dl-fini.c:254)
> ==2464==    by 0x6D23900: __run_exit_handlers (exit.c:78)
> ==2464==    by 0x6D23984: exit (exit.c:100)
> ==2464==    by 0x6D09773: (below main) (libc-start.c:258)
> 
> ==2464== 408 bytes in 3 blocks are possibly lost in loss record 222 of 725
> ==2464==    at 0x4C29DB4: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
> ==2464==    by 0x5A89B98: ??? (in /usr/lib/libcuda.so.313.30)
> ==2464==    by 0x5A8A1F2: ??? (in /usr/lib/libcuda.so.313.30)
> ==2464==    by 0x5A8A3FF: ??? (in /usr/lib/libcuda.so.313.30)
> ==2464==    by 0x5B02E34: ??? (in /usr/lib/libcuda.so.313.30)
> ==2464==    by 0x5AFFAA5: ??? (in /usr/lib/libcuda.so.313.30)
> ==2464==    by 0x5AAF009: ??? (in /usr/lib/libcuda.so.313.30)
> ==2464==    by 0x5A7A6D3: ??? (in /usr/lib/libcuda.so.313.30)
> ==2464==    by 0x59B205C: ??? (in /usr/lib/libcuda.so.313.30)
> ==2464==    by 0x5984544: cuInit (in /usr/lib/libcuda.so.313.30)
> ==2464==    by 0x568983B: ??? (in /usr/local/cuda-5.0/lib64/libcudart.so.5.0.35)
> ==2464==    by 0x5689967: ??? (in /usr/local/cuda-5.0/lib64/libcudart.so.5.0.35) 
> ```

**更多信息：**

*我尝试在更少的卡上运行（3 个，因为这是程序所需的最小值），但仍然发生崩溃。*

**以上不正确，我错误地配置了应用程序，它使用了所有四张卡。仅用 3 张卡重新运行实验似乎可以解决问题，它现在在重负载下运行了几个小时而没有崩溃。**我现在将尝试让它运行更多，然后尝试使用 3 张卡的不同子集来验证这一点，同时测试问题是否与一张特定的卡有关。

我在测试运行期间监测了 GPU 温度，似乎没有任何问题。卡在最高负载下达到约 78-80 °C，风扇运转约 56%，这一直持续到崩溃发生（几分钟），对我来说似乎不太高。

我一直在考虑的一件事是处理请求的方式 - 有很多 cudaSetDevice 调用，因为每个请求都会产生一个新线程（我正在使用 mongoose 库），然后这个线程通过调用 cudaSetDevice( id) 具有适当的设备 ID。切换可以在一个请求期间发生多次，并且我没有使用任何流（因此它全部转到默认 (0) 流 IIRC）。这可能与 pthread_getspecific 中发生的崩溃有关吗？

我也尝试升级到最新的驱动程序（测试版，319.12），但这并没有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-01T00:44:42.427

如果您可以识别出 3 张有效的卡片，请尝试循环使用第 4 张卡片代替 3 张卡片中的一张，然后查看是否再次出现故障。这只是我认为的标准故障排除。如果您可以识别出一张卡片，当包含在一组 3 中时，仍然会引发问题，那么该卡片是可疑的。

但是，我建议使用更少的卡运行也是基于这样的想法，即它可以减少 PSU 的整体负载。即使在 1500W 下，您也可能没有足够的果汁。因此，如果您循环使用第 4 张卡，而不是 3 张卡中的一张（即系统中仍然只保留 3 张卡或将您的应用配置为使用 3 张卡）并且您没有失败，则问题可能是由于整体功耗与4张牌。

请注意，GTX Titan 满载时的功耗可能在 250W 左右，甚至可能更高。所以看起来你的 1500W PSU 应该没问题，但它可能归结为仔细分析每个导轨上有多少 DC 电源可用，以及主板和 PSU 线束如何将 12V DC 导轨分配给每个 GPU。

因此，如果无论您使用哪 3 个 GPU，减少到 3 个 GPU 似乎都能解决问题，我的猜测是您的 PSU 无法胜任这项任务。并非所有 1500W 都可从单个 DC 导轨获得。12V“轨”实际上是由几个不同的 12V 轨组成，每一个都提供整体 1500W 的一定部分。因此，即使您可能没有拉 1500W，您仍然可以使单个导轨过载，具体取决于 GPU 电源如何连接到导轨。

我同意 80C 范围内的温度应该没问题，但这表明（大约）一个满载的 GPU，所以如果你同时在所有 4 个 GPU 上看到它，那么你正在承受沉重的负载。

# iphone - 无法在 iTunes 连接中为 AppStore 中的实时应用程序获取崩溃报告

> ID：16164190
> 
> 赞同：0
> 
> 时间：2013-04-23T08:09:23.043
> 
> 标签：iphone, ios, app-store-connect

我开发了一个应用程序并上传到 AppStore。该应用程序现已上线。对于某些用户，应用程序仍然崩溃，我无法在上传应用程序的 iTunes 连接帐户中获取崩溃日志。

谁能帮我找到问题。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T08:19:20.213

不幸的是，Apple 确实*在*将崩溃报告交付给您之前对其进行了处理。它似乎以某种方式聚合它们，尽管尚不清楚这是一个旨在提供帮助的过程还是只是一个错误。你无能为力；耐心*可能会*有所帮助。你最好的选择是当崩溃发生时，一个乐于助人的用户会告诉你。

获取所有崩溃报告的唯一可靠方法——现在这并不能真正帮助你——是包含你自己的崩溃报告代码。我在博客上[写了我的经历。](http://www.zx81.org.uk/computing/opinion/why-you-need-a-crash-reporter.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:45:25.343

对于来自 Apple 通过 iTunes 的崩溃报告，**用户必须主动启用**向 Apple 报告崩溃 - 否则不会发送任何报告。对于我所有的应用程序，我几乎没有看到任何崩溃报告，所以我猜大多数用户不允许将崩溃报告发送给 Apple。

最好的办法是包含一些用于崩溃报告的**第三方工具**（例如， [BugSense](http://www.bugsense.com)或在某种程度上，[Flurry](http://www.flurry.com)）或自己做。

# android - 录制视频时保持预览回调？

> ID：16164195
> 
> 赞同：6
> 
> 时间：2013-04-23T08:09:47.223
> 
> 标签：android, camera, android-mediarecorder

我目前正在使用 onPreviewCallback，因此我可以在预览时从相机捕获帧并通过 http 流式传输它们。

这行得通，但随后我发出一个开始录制的命令，而且似乎我不再有预览回调了。

那么，如何保持预览回调，以便我可以将帧从表面发送到我的服务器并在设备上录制视频？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-28T01:28:01.277

我很长一段时间都没有使用 Android 相机。然而，据我记忆

1) 录制时不会调用 onPreviewCallback

它在几个问题中提到：

[未调用相机 onPreviewFrame](https://stackoverflow.com/questions/7042377/camera-onpreviewframe-not-called) [如何在录制视频时显示实时过滤的相机预览？](https://stackoverflow.com/questions/12352615/how-to-show-real-time-filtered-camera-preview-while-recording-videos)

2）我看到它是在 SipDroid 和其他几个 Android SIP 客户端中处理的（这是 1-2 年前，所以这种方法可能已经过时了）：

*   创建了一个管道
*   管道的接收套接字被包裹在 FileDescriptor 中并传递给 MediaRecorder setOutputFile
*   在线程中不断读取管道的发送套接字。
*   这样您就可以接收写入文件的内容
*   现在，如何处理内容的问题（因为它是 H.263 或 H.264 编码的，如果您用声音录制视频，可能会与声音混合）。
*   有一些启发式算法可以解析内容（但是，这很麻烦）

3）您可以使用 onPreviewFrame + start AudioRecorder 并自己编码（使用 ffmpeg 或类似的东西）到 mp4 文件。这样您就不需要启动 MediaRecorder 录制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-04T10:08:30.613

您可以在调用 media recorder.start() 后调用这些方法，如下所示：

```
camera.reconnect();
camera.setPreviewCallback();
surfaceview.getHolder().addCallback(); 
```

原因：

1.  调用camera.unlock()后，另一个进程（这里是媒体记录器进程）可能会使用摄像头；该过程完成后，您必须重新连接到相机，这将重新获得锁定并允许您继续使用相机。
2.  然后在相机重新连接后重新注册surfaceview帧数据回调，因为重新连接后它的某些状态可能会改变。

在我的应用程序中，我曾经遇到过和你一样的问题，我通过这个解决了它。希望它能解决你的问题！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-28T10:26:58.477

一旦我让相机和 MediaRecorder 开始和停止录制而不会崩溃（这并不容易），我仍然遇到像你描述的那样的问题，预览回调将停止被调用。

我最终找到的修复是在 mediaRecorder.start() 之后添加对 setPreviewCallback 的调用，在 mediaRecorder.stop() 之后添加另一个调用。不确定这是否正确，但它适用于正在测试的 Razr MI。

# delphi - OnMouseMove 事件是否应该无休止地到达？

> ID：16164196
> 
> 赞同：0
> 
> 时间：2013-04-23T08:09:52.370
> 
> 标签：delphi

我正在尝试在 Delphi (XE3) 中处理 OnMouseMove，即使我不移动鼠标，我也会得到源源不断的 OnMouseMove 事件，一个接一个。

**前任。**：启动新的 VCL 表单应用程序。使用以下代码将 OnMouseMove 处理程序添加到表单：

```
var s: string;
begin
  s := IntToStr(GetTickCount()) + ': MouseMove';
  OutputDebugString(PChar(s));
end; 
```

将鼠标放在窗体上，观察 IDE 消息日志中无尽的 OnMouseMoves。

我希望 MouseMove 消息只有在我实际移动光标时才会到达（并且可能在其他一些特殊情况下）。事实上，我一直认为 OnMouseMove 是这样工作的。

难道我做错了什么？从德尔福的角度来看（即设计）这是正确的吗？WinAPI 是否正确？该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T08:19:05.777

这只是与 Delphi 调试器处理`OutputDebugString`. 但是您的诊断并不能反映`OnMouseMove`消息在实际程序中的实际到达方式。

例如，考虑您的程序的这个变体：

```
procedure TForm1.FormMouseMove(Sender: TObject; Shift: TShiftState; 
  X, Y: Integer);
begin
  Caption := IntToStr(GetTickCount()) + ': MouseMove';
end; 
```

您会注意到表单的标题仅在您移动鼠标时发生变化。

或者使用您的程序，并使用不同的调试字符串监视器。例如，`DbgView`来自 SysInternals。使用该外部调试字符串监视器，您会发现调试消息仅在鼠标真正移动时到达。

我不确定 Delphi 调试器在做什么会导致您观察到的行为。但是，请确保`OnMouseMove`您的实际程序中的消息只有在鼠标确实在移动时才会到达。

# c - 在 C99 中初始化包含指向另一个结构的指针的结构

> ID：16164200
> 
> 赞同：1
> 
> 时间：2013-04-23T08:10:13.637
> 
> 标签：c, struct, initialization, c99

我在下面有一些结构定义：

```
typedef struct { 
  uint16_t a ;
} my_type1_t ;

typedef struct { 
  uint16_t b ; 
} my_type2_t ; 

typedef struct {
  my_type1_t* a_ptr ;
  my_type2_t* b_ptr ;
} both_t ; 

typedef struct {
  both_t* both_ptr ;
} gathered_t 
```

以及上述结构的一些实例：

```
my_type1_t a = { 
  .a = 0x01U,
} ;

my_type2_t b = { 
  .b = 0xAAU,
} ; 
```

我想问一下这是否可以在 C99 标准或更高版本中对结构进行一些初始化，如下所示：

```
gathered_t all = {
  .both_ptr.a_ptr = &a,
  .both_ptr.b_ptr = &b,
}; 
```

我知道这个问题的解决方案可以定义both_t结构的实例，但是这会引入额外的消耗内存的对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T08:20:25.360

由于您的结构声明了指针类型，因此您必须在某处为对象分配内存。但是你不需要为此声明一个变量，一个复合文字就可以了：

```
gathered_t all = {
  .both_ptr = &(both_t){ 
     .a_ptr = &a,
     .b_ptr = &b,
   }
}; 
```

复合字面量是根据这个初始化所在的范围分配的；如果它在文件范围内，分配将是静态的，否则它将是自动的（在“堆栈”上）；

在这里，如果您不向 的声明添加任何存储说明符，则`all`此复合文字将具有与该变量相同的生命周期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:15:04.880

不，那是不可能的。`both_t`无论如何，您将需要内存。所以解决方案

```
both_t both = { &a, &b };
gathered_t all = { &both }; 
```

将使用与您期望的一样多的内存。

请参阅其他答案以避免引入新变量`both`，这确实显示了 C99 的新功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:22:30.163

试试这个

```
gathered_t all = {
    .both_ptr = &(both_t){ &a, &b }
}; 
```

完整示例在[http://codepad.org/kGxiPPxT](http://codepad.org/kGxiPPxT)

# django - Django 1.5 中所有博客文章中显示的 Disqus 评论

> ID：16164203
> 
> 赞同：1
> 
> 时间：2013-04-23T08:10:19.137
> 
> 标签：django, disqus

在有人告诉我这个问题是重复的之前，我已经阅读了与我的问题类似的所有 django-disqus 相关问题的解决方案。

1.  我有一个基于 Django 的博客应用程序。
2.  下载并安装 django-disqus (pip install django-disqus)
3.  遵循本文档中的说明（[http://django-disqus.readthedocs.org/en/latest/templatetags.html](http://django-disqus.readthedocs.org/en/latest/templatetags.html)）
4.  但是评论显示在所有博客文章中。

我有一个 base.html 文件，其中包括页眉和页脚，并且在整个站点中都是通用的。我有 post.html，从 base.html 单击时将显示特定的帖子。

所以我已经`{% load disqus_tags %}`在 post.html 的顶部加载并包含了这样的 javascript

```
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'impras';
    var disqus_url = 'http://impras.in/{{ post.get_absolute_url }}';
    var disqus_identifier = '{{ post.get_absolute_url }}';
    var disqus_title = '{{ post.title }}';
    var disqus_developer = 1;

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })(); 
    </script> 
```

我在本地机器上测试这个，而不是在生产服务器上，所以我设置`DEBUG=True`了等等`disqus_developer = 1`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-12T14:42:49.487

在 django 视图中你不需要任何 javascript。我通过从我的模板中删除来解决**同样的问题。**`{% disqus_dev %}`

# function - 创建自定义 XSLT 函数

> ID：16164205
> 
> 赞同：6
> 
> 时间：2013-04-23T08:10:22.680
> 
> 标签：function, xslt, xslt-2.0

我正在尝试创建自定义 XSLT 函数，但每次收到此错误时：

“非静态 Java 函数‘compareCI’的第一个参数不是有效的对象引用。”

```
 <xsl:stylesheet version="2.0" 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:foo="http://whatever">

  <xsl:function name="foo:compareCI">
    <xsl:param name="string1"/>
    <xsl:param name="string2"/>
    <xsl:value-of select="compare(upper-case($string1),upper-case($string2))"/>
  </xsl:function>

  <xsl:template match="/">
      <xsl:value-of select="foo:compareCI('red','blue')"/>
  </xsl:template>

</xsl:stylesheet> 
```

我希望你们中的某个人可以帮助我。非常感谢提前。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T09:57:32.280

我认为您正在尝试使用 Xalan 来运行它，它是一个 XSLT 1.0 处理器，因此无法识别 xsl:function。发生的情况是 (a) Xalan 忽略了 xsl:function，因为 XSLT 1.0 处理器被指定了一个指定 version="2.0" 的样式表应该忽略它不理解的东西（在规范中称为“向前兼容模式” ); 然后当它看到对 foo:compareCI() 的函数调用时，它认为这一定是对外部 Java 方法的调用。

您需要使用 XSLT 2.0 处理器（通常是 Saxon）来运行它。

# c# - .Net Framework 3.5 及以下版本中 CopyTo() 和 WriteTo() 的等效方法是什么？

> ID：16164207
> 
> 赞同：1
> 
> 时间：2013-04-23T08:10:37.313
> 
> 标签：c#, .net-framework-version

我需要为我的应用程序使用 .NetFramework3.5，但是3.5`CopyTo()`中`WriteTo()`没有方法。3.5中的等效方法是什么？

当我使用 3.5 运行代码时，它会引发以下错误：

> “System.IO.Stream”不包含“WriteTo”的定义，并且找不到接受“System.IO.Stream”类型的第一个参数的扩展方法“WriteTo”

这是代码：

```
int fileId = 1;
foreach (string uri in uriList)
{

    request = (HttpWebRequest)WebRequest.Create (baseURL + uri);
    request.Headers.Add ("X", authenticateStr);
    request.Accept = "application/pdf";
    request.Method = "GET";

    webResponse = (HttpWebResponse)request.GetResponse();
    using (MemoryStream ms = new MemoryStream())
    using (FileStream outfile = new FileStream("document_", FileMode.Create)) {
        webResponse.GetResponseStream().WriteTo(ms);
        if (ms.Length > int.MaxValue) {
            throw new NotSupportedException("Cannot write a file larger than 2GB.");
        }
        outfile.Write(ms.GetBuffer(), 0, (int)ms.Length);
    }
}
Console.WriteLine("Done!"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:21:14.930

1.  [`Stream.CopyTo`](http://msdn.microsoft.com/en-us/library/dd992542.aspx)确实是在 .NET 4 中添加的。早期版本的 .NET 缺少许多在后期版本中添加的有用方法。.NET 4.5 仍然缺少许多“明显”的方法，我认为如果 MS 感知到足够的需求，未来的版本将继续添加此类帮助程序。

2.  没有[`Stream.WriteTo`](http://msdn.microsoft.com/en-us/library/ts2303ww.aspx)。它仅存在于某些子类中（例如[`MemoryStream.WriteTo`](http://msdn.microsoft.com/en-us/library/system.io.memorystream.writeto.aspx)，自 .NET 1.0 以来就存在）。

（我怀疑`Stream.CopyTo`被添加为常见`MemoryStream.WriteTo`但显然 using`WriteTo`将是 API 的重大更改，因为例如，对其进行反思会产生不同的结果。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-13T09:54:48.323

如果您需要 CopyTo，我使用此扩展程序

```
public static void CopyTo(this Stream input, Stream output)
{
   // This method exists only in .NET 4 and higher

   byte[] buffer = new byte[4 * 1024];
   int bytesRead;

   while ((bytesRead = input.Read(buffer, 0, buffer.Length)) != 0)
   {
      output.Write(buffer, 0, bytesRead);
   }
} 
```

# javascript - 浏览器后退和前进按钮不会调用带有历史.js 的 statechange 事件的回调方法

> ID：16164210
> 
> 赞同：5
> 
> 时间：2013-04-23T08:10:52.450
> 
> 标签：javascript, jquery, browser-history, pushstate, history.js

我使用（[https://github.com/browserstate/history.js](https://github.com/browserstate/history.js)）并有一段这样的代码

```
History.Adapter.bind(window, 'statechange', function() { 
    var State = History.getState();
    alert('Inside History.Adapter.bind: ' + State.data.myData);
});

function manageHistory(url, data, uniqueId){
    var History = window.History;
    if ( !History.enabled ) { return false; }        
    History.replaceState({myData: data}, null, '?stateHistory=' + uniqueId);
} 
```

如果我`manageHistory()`在我的 ajax 调用之后调用，那么`History.Adapter.bind`回调方法会被正确调用。但是，如果我向后单击浏览器，然后单击前进按钮，**导致页面导航从 B 到 A，然后 A 返回到 B**`History.Adapter.bind` ，则不会调用内部的回调方法。这发生在 chrome 和 IE9 上。任何人都知道如何解决这个问题，我需要让`State`点击后浏览器返回然后转发，以更新我的 DOM。请帮忙

**注意：我为html4 浏览器 IE9**使用版本 1.7.1 jquery.history.js

 ****更新（2013 年 5 月 3 日）：多谈谈我的要求**

对不起，我正忙于其他任务，直到现在我有时不得不看这个问题。因此`oncomplete`，在 ajax 调用中，我获取了返回给我的信息，并将其推送到状态。我的要求是：如果我从页面 A 导航到页面 B，然后在页面 B 上，我执行导致 DOM 操作的 ajax 请求的数量（让调用每个导致 DOM 操作的 ajax 请求 a `state`）。如果我点击后退按钮，我应该回到页面 A，如果我点击前进按钮，我应该回到页面 B，我处于最后的状态。

所以我的想法是，`oncomplete`在我的 ajax 请求中，我会用我当前的状态替换历史中的最后一个状态（我的 json 对象是我从 ajax 请求中收到的 html）。如果我使用推送状态，假设我在页面 B 上，然后单击一个按钮，我的页面现在变为`aaa`，我 pushState `aaa`。然后，如果我单击其他按钮，我的页面现在变为`bbb`，我 pushState `bbb`。如果我现在点击后退按钮，我仍然会在页面 B 上，我的状态`History.Adapter.bind(window, 'statechange', function() {})`显示为`aaa`，如果我再次点击后退按钮，我会转到页面 A。我不想要这种行为。我希望如果我在带有 state 的页面 B 上`bbb`，然后单击返回，我会转到页面 A，如果我单击前进，我会转到带有 state 的页面`bbb`B。我希望这更有意义。请帮忙

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-03T10:04:55.627

你需要做的如下：

*   如果您来自的页面是另一个页面（例如，您打开页面 B 并且前一页是页面 A），那么您执行`pushState`.
*   另一方面，如果上一页与您当前所在的页面相同，则只需执行 a `replaceState`，将信息替换为有关您当前状态的信息。

（*您需要在某些变量中手动跟踪上一页*）

这意味着如果你从 A 到 B (pushState) 到 B 的新状态 (replaceState)，后退按钮 (转到 A 的状态信息) 和下一个前进 (转到 B 的最新状态)。此外，如果您第一次打开 A，您需要`replaceState`使用有关 A 的状态的信息执行 a，以便 A 至少具有某种状态（否则它将有一个空的数据对象）。

[查看我的这个答案](https://stackoverflow.com/a/10893931/1266242)可能很有用，这只是关于您使用`pushStates`. 当然，这不完全是您想要的，但是它的编写更简单一些，并且与此答案中的信息一起，它应该可以为您提供所需的行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T14:35:56.507

我看到您正在使用`History.replaceState`它删除堆栈中的最后一个历史状态并将其替换为参数中给出的状态。

我`History.pushState`在我的网站上使用，并没有遇到这样的问题，因为这个函数不会拉最后一个状态，而是在它上面添加新状态。它使后退按钮正常工作。

我希望它对你有帮助。

**编辑：**使用`change of select tag`作为事件侦听器的示例：

```
function manageHistory(url, data, uniqueId){
    var History = window.History;
    if ( !History.enabled ) { return false; }        
    History.replaceState({myData: data}, null, '?stateHistory=' + uniqueId);
}

$('select.select').change(function(e) {

    e.preventDefault(); 

    // get url
    // get data
    // get uniqueId

    manageHistory(url, data, uniqueId)

});

History.Adapter.bind(window, 'statechange', function() { 
    var State = History.getState();
    // Launch the ajax call and update DOM using State.data.myData
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-04T13:18:52.750

还，

relpaceState 将始终擦除 B 状态。

用于`pushState`A 和 B 状态。

并`replacestate` 用于 aaa、bbb、ccc 状态。

```
function manageHistoryBack(url, data, uniqueId){
    var History = window.History;
    if ( !History.enabled ) { return false; }        
    History.replaceState({myData: data}, null, '?stateHistory=' + uniqueId);

}

function manageHistory(url, data, uniqueId){
    var History = window.History;
    if ( !History.enabled ) { return false; }        
    History.pushState({myData: data}, null, '?stateHistory=' + uniqueId);

}

// Event listenner triggering aaa,bbb,ccc 
$('select.select').change(function(e) {

    e.preventDefault(); 

    // get url
    // get data
    // get uniqueId

    manageHistoryBack(url, data, uniqueId)

});

// Event listenner triggering A, B
$('select.select').change(function(e) {

    e.preventDefault(); 

    // get url
    // get data
    // get uniqueId

    manageHistory(url, data, uniqueId)

});

History.Adapter.bind(window, 'statechange', function() { 
    var State = History.getState();
    // Launch the ajax call and update DOM using State.data.myData 
}); 
```

祝你好运**

# c# - 评估一系列条件并在条件满足时停止

> ID：16164211
> 
> 赞同：0
> 
> 时间：2013-04-23T08:10:52.993
> 
> 标签：c#, asp.net, winforms

这只是一个“最佳实践”问题......

我有一个函数，它接受一个输入字符串，然后必须根据内容对其进行更改，但是一旦满足特定条件，所有进一步的处理就会停止。

目前，我使用“while（true）”循环，然后当我得到我想要的东西时“break”，下面是伪代码..

```
string Input = "xyz";
string Output = string.Empty;
while (true)
{
    if (Input.StartsWith("x"))
    {
        Output = "string starts with an X";
        break;
    }

    if (Input.Contains("y"))
    {
        Output = "string has a 'y' in it";
        break;
    }

    if (Input.IndexOf("z") == 2)
    {
        Output = "string has a 'z' as the 3rd character";
        break;
    }

    Output = "string does not match any conditions";
    break;
} 
```

有没有更“纯粹”的方式来实现上述目标？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T08:13:29.163

你应该在这里使用标准`if-ifelse-else`。对于您的情况，它更常见且更具可读性。

```
string Input = "xyz";
string Output = string.Empty;

if (Input.StartsWith("x"))
{
    Output = "string starts with an X";
}
else if (Input.Contains("y"))
{
    Output = "string has a 'y' in it";
}
else if (Input.IndexOf("z") == 2)
{
    Output = "string has a 'z' as the 3rd character";
}
else
{
    Output = "string does not match any conditions";
} 
```

***更新***

第二个版本，使用 LINQ。您可以创建`List`条件函数和所需的输出，然后用于`FirstOrDefault`获取第一个匹配条件。

```
string Input = "xyz";
string Output = string.Empty;

var conditionList = new List<Tuple<Func<string, bool>, string>>();
conditionList.Add(Tuple.Create<Func<string, bool>, string>((string x) => x.StartsWith("x"), "string starts with x"));
conditionList.Add(Tuple.Create<Func<string, bool>, string>((string x) => x.Contains("y"), "string has a 'y' in it"));
conditionList.Add(Tuple.Create<Func<string, bool>, string>((string x) => x.IndexOf("z") == 2, "string has a 'z' as the 3rd character"));

var firstMatch = conditionList.FirstOrDefault(x => x.Item1(Input));
Output = firstMatch != null ? firstMatch.Item2 : "string does not match any conditions"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:38:16.313

正如您所说，这只是一个更大问题的简单示例，我可能会这样做（当然，对于一个小示例来说，这有点矫枉过正，但它可以很好地扩展）：

```
public interface ICondition
{
    bool IsMatch(string input);
    string GetMessage();
}

public class StartsWithTest : ICondition
{
    public bool IsMatch(string input)
    {
        return input.StartsWith("x");
    }   

    public string GetMessage()
    {
        return "string starts with an X";
    }
}

public class TestInput
{

    private readonly IList<ICondition> _conditions;

    public TestInput()
    {
        _conditions = new List<ICondition>();

        _conditions.Add(new StartsWithTest());
        //etc etc
    }

    public string Test(string input)
    {
        var match = _conditions.FirstOrDefault(c => c.IsMatch(input));

        if (match != null)
            return match.GetMessage();
        else
            return string.Empty;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:14:57.643

我觉得`if else if..`应该够了。你这样做的方式，如果你重构你的代码并忘记最后`break;`你可能会面临更大的问题。

# java - Android 内置 SIP 库无法正确结束通话？

> ID：16164214
> 
> 赞同：2
> 
> 时间：2013-04-23T08:11:03.780
> 
> 标签：java, android, sip, voip, asterisk

我使用 Android 内置的 sip 库编写了一个通过我自己的 Asterisk 服务器进行调用的应用程序。呼叫正确进行，但大多数情况下，呼叫未正确结束。

这是我结束通话的代码：

```
public void stopCalling(){
    try {
        call.endCall();
        call.close();
    } catch (SipException e) {
        e.printStackTrace();
    }
} 
```

有人可以向我解释为什么有时电话会正确结束，但大多数时候不是吗？

举个例子，当我从我的 android 手机呼叫 pc 上的 sip 客户端时，它会响铃。当我从 android 设备调用 stopCalling 方法时，pc 客户端一直响铃，当我在 pc 上接听电话时，没有任何声音，最终，连接超时，通话在 pc 客户端上结束边。当我在pc客户端接听后结束通话时，音频流立即停止，但直到连接超时才结束通话。

# c# - 并非所有代码路径都返回值（布尔值）

> ID：16164215
> 
> 赞同：1
> 
> 时间：2013-04-23T08:11:07.540
> 
> 标签：c#, boolean

我正在为体验创建消息服务应用程序。但是，我偶然发现了以前遇到的错误。这是我的方法：

```
bool userExists(string pcName)
    {
        string[] files = Directory.GetFiles(usersFile);

        foreach (string fileName in files)
        {
            if (fileName == pcName)
            {
                return true;
            }
            else
            {
                return false;
            }
        }
    } 
```

如您所见，如果文件夹中存在用户的 txt 文件，此方法将返回是或否答案。现在，对我来说，所有代码路径都返回一个值。这是有道理的，显然编译器不这么认为，因为我在“bool userExists”上收到一个错误，抱怨并非所有代码路径都返回一个值。我该如何解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:12:14.617

例如，如果列表文件为空，会发生什么情况？
编译器到达函数的末尾而不点击 return 语句，这就是它告诉你的。

编写代码的好方法是：

```
bool userExists(string pcName)
{
    string[] files = Directory.GetFiles(usersFile);

    foreach (string fileName in files)
    {
        if (fileName == pcName)
        {
            return true;
        }
    }
    return false;
} 
```

这可能是熟悉 Linq 的时刻：

```
bool userExists(string pcName)
{
    return Directory.GetFiles(usersFile)
                    .Any(file => file == pcName);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:12:23.160

如果`files`是空的呢？所以你可以这样做：

```
string[] files = Directory.GetFiles(usersFile);

foreach (string fileName in files)
{
    if (fileName == pcName)
    {
        return true;
    }
}

return false; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T08:15:21.580

如果你`files`没有文件怎么办？

您的代码将跳过`foreach`语句，但它不会返回任何内容，因为在您的`foreach`语句之外，您没有任何`return`语句。

```
string[] files = Directory.GetFiles(usersFile);

foreach (string fileName in files)
{
    if (fileName == pcName)
    {
        return true;
    }
}

return false or true; 
```

或者有其他`Linq`方法可以解决；

```
return Directory.GetFiles(usersFile)
                .Where(fileName => fileName == pcName)
                .Any(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T08:14:03.600

```
bool userExists(string pcName)
{
    return Directory
        .GetFiles(usersFile)
        .Any(fileName => fileName == pcName);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T08:14:51.010

问题是您的“文件”数组可能为空。如果是这种情况，您的布尔返回语句将永远不会被击中。放一个最后的'return false;' 在 for...each 循环之后，您将不会再收到任何错误。

话虽这么说，你的基本逻辑是有缺陷的。通过在 else 语句中返回 false，循环将永远不会继续（假设有多个文件）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-23T08:43:19.143

首先，为什么要使用[`GetFiles`](http://msdn.microsoft.com/en-us/library/07wt70x2.aspx)？改为使用[`EnumerateFiles`](http://msdn.microsoft.com/en-us/library/system.io.directory.enumeratefiles.aspx)。

```
bool UserExists(string pcName)
{
    return Directory.EnumerateFiles(this.usersFile).FirstOrDefault(f => f == pcName);
} 
```

此代码实现与您的代码等效的功能。

但是，您实际上可能想要，

```
bool UserExists(string pcName)
{
    return Directory.EnumerateFiles(this.usersFile).Any(f => f == pcName);
} 
```

枚举将立即开始，无需创建中间数组。如果发现匹配，将避免早期不必要的处理和从磁盘读取。

* * *

您可以通过执行来避免“并非所有代码路径都返回值”消息

```
bool userExists(string pcName)
{
    string[] files = Directory.GetFiles(usersFile);

    return files.Length > 0 && files[0] == pcName;
} 
```

如果您只想检查第一个文件。这处理`files`为空的情况。虽然，我怀疑你真的想要，

```
bool userExists(string pcName)
{
    string[] files = Directory.GetFiles(usersFile);

    foreach (string fileName in files)
    {
        if (fileName == pcName)
        {
            return true;
        }            
    }

    return false;
} 
```

检查任何文件。

# c# - 关于 base..ctor() 的解释

> ID：16164229
> 
> 赞同：8
> 
> 时间：2013-04-23T08:11:38.597
> 
> 标签：c#

我从朋友那里得到一个应用程序来开发。然后在代码中我得到了这样令人困惑的代码：

```
public someNameHere()
{
   base..ctor();
} 
```

好吧，我从来没有这样的应用程序。我需要一个解释

> 基础..ctor();

我在谷歌上搜索，找不到让我满意的答案。感谢您给我的任何帮助。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-23T08:17:38.363

`.ctor()`是构造函数使用的内部名称。它在 C# 中不以这种方式使用，并且不编译。更典型的`base..ctor()`是，仅在执行以下操作时由编译器使用：

```
public class Foo : Bar {
    public Foo(string s) : base(s) {...} 
    public Foo() {...} // has an implicit :base()
} 
```

我见过的唯一不同的做法是在反编译（通过反射器等）一些非 C# IL 时，它以与 C# 编译器不同的顺序执行构造代码，因此在“纯”C# 中无法表达. 在原始 IL（以及来自 C++ 等）中，您可以在构造函数*中的任何位置*调用基本构造函数 - 而不仅仅是在开始时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T08:14:54.947

应该是基类的默认无参数构造函数。Elaborating，`.ctor()`是编译 C# 时自动生成的构造函数的别名。所以Writing`base..ctor()`就是引用`.ctor()`基类中的方法。

# c++ - 消息队列不断发送/接收垃圾

> ID：16164233
> 
> 赞同：0
> 
> 时间：2013-04-23T08:11:41.047
> 
> 标签：c++, linux, ubuntu, message-queue

在我的任务中，我必须分叉进程来模拟分布式操作系统，使用启发式算法在 Linux 上使用 IPC 进行进程分配。

现在我 fork`n`孩子，然后让他们模拟算法，这不是问题，尽管问题出在所有孩子之间的消息队列连接中

有 2 个消息队列`UP`，`DOWN`它们都不能正常工作。每次我尝试通过这些队列中的任何一个发送一些东西时，它们都会在另一端作为垃圾接收。

所以，我使用这个结构和那些方法来处理消息队列

```
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/msg.h>
#include <sys/shm.h>
struct msgbuff
{
   long mtype;
   char mtext[70];
};

void Send(key_t msgqid,char* S,long pid)
{
  int send_val;
  struct msgbuff message;

  message.mtype = pid;      /* arbitrary value */
  strcpy(message.mtext,S);
  cout<<"Message is "<<message.mtext<<endl;
  //strcpy(message.mtext, str);
  cout<<getpid()<<" Entering Send process"<<endl;
  send_val = msgsnd (msgqid, &message, sizeof(message), IPC_NOWAIT);

  if(send_val == -1)
    perror("Error in send");

}

char* Recieve(key_t msgqid,bool nowait)
{
        int rec_val;
          struct msgbuff message;

          cout<<getpid()<<" Entering Receive process"<<endl;
          /* receive all types of messages */
          if(nowait)
  rec_val = msgrcv(msgqid, &message, sizeof(message), getpid(), IPC_NOWAIT);  
  else rec_val = msgrcv(msgqid, &message, sizeof(message), getpid(), !IPC_NOWAIT);  
  if(rec_val == -1){
//      perror("Error in receive");
    return "none";
}
  return message.mtext;
} 
```

然后我像这样对每个孩子使用它们

```
 DOWN = msgget(200, IPC_CREAT|0644);
        UP = msgget(201,IPC_CREAT|0644); 
```

和

```
 while(1)
            {
                int countfail =0;
                char* ask =Recieve(DOWN,true); //nowait
                string asks(ask);
                cout<<getpid()<<" ask= "<<asks<<endl; //This here prints either garbage (symbols and other random characters) or "none"
                if(strcmp(ask,"none")!=0)
                {
                           ///////Logic for the algorithm
                    cout<<"*********"<<getpid()<<" In ASK "<<endl;
                    stringstream ss1;
                    ss1.str(ask);
                    int senderpid=0,processSize=0;
                    ss1>>processSize>>senderpid;
                    char* processRecMessage = new char[70];

                              ///setting up what will be sent to other process
                    if(count+ processSize <= load)
                    {
                        count+=processSize;
                        strcpy(processRecMessage,"Taken");

                    }
                    else
                    {
                        strcpy(processRecMessage,"Not Taken");
                    }

                           //Another Garbage here
                    Send(UP,processRecMessage,senderpid);

                }
                else{
                    int nextProcess = (rand()%3) +1;
                    if(count + nextProcess <=load)
                    {
                        count +=nextProcess;
                    }
                    else{

                        for(int k = 0;k<3;k++)
                        {
                            int selectedChild = rand()%n;
                            cout<<getpid()<<" Selected Child no "<<selectedChild+1<<" PID="<<children[selectedChild]<<endl;
                            char* x = new char[70];
                            stringstream ss;
                            ss<<nextProcess;
                            ss<<" "<<getpid();
                            strcpy(x,ss.str().c_str());// x= "nextProcess pid" 
                            cout<<x<<endl;
                 //// sending here also recieves garbage
                            Send (DOWN , x,children[selectedChild]);
                //// receiving  garbage
                            x= Recieve(UP,false);
                            cout<<getpid()<<" UP Value = "<<x<<endl;
                            if (strcmp(x,"Taken")==0){
                                cout<<"Process sent from "<<getpid()<<" to "<<children[selectedChild]<<endl;
                                break;
                            }
                            else
                            {
                                countfail++;
                                printf("TRAIL #%d failed\n",countfail);

                            }

                        }
                        if(countfail==3)
                        {
                            cout<<"Algorithm failed to allocate process.\n";
                            cout<<"Terminating Process "<<getpid()<<endl;
                            break;
                        }
                    }
                }
            } 
```

因此，如果有人可以帮助我，我将不胜感激

ps：程序每次运行失败后我都会删除所有消息队列，因此每次它们重新启动但仍然没有用。

**编辑**：添加完整代码

```
#include <iostream>
#include <fstream>
#include <string>
#include <algorithm>
#include <math.h>
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/msg.h>
#include <sys/shm.h>
#include <string.h>
#include <map>
#include <sstream>
#include <ctime>

using namespace std;

struct msgbuff
{
   long mtype;
   char mtext[70];
};

void Send(key_t msgqid,char* S,long pid)
{
  int send_val;
  struct msgbuff message;

  message.mtype = pid;      /* arbitrary value */
  strcpy(message.mtext,S);
  cout<<"Message is "<<message.mtext<<endl;
  //strcpy(message.mtext, str);
  cout<<getpid()<<" Entering Send process"<<endl;
  send_val = msgsnd (msgqid, &message, sizeof(message), IPC_NOWAIT);

  if(send_val == -1)
    perror("Errror in send");

}

char* Recieve(key_t msgqid,bool nowait)
{
        int rec_val;
          struct msgbuff message;

          cout<<getpid()<<" Entering Receive process"<<endl;
          /* receive all types of messages */
          if(nowait)
  rec_val = msgrcv(msgqid, &message, sizeof(message), getpid(), IPC_NOWAIT);  
  else rec_val = msgrcv(msgqid, &message, sizeof(message), getpid(), !IPC_NOWAIT);  
  if(rec_val == -1){
//      perror("Error in receive");
    return "none";
}
  return message.mtext;
}

int main()
{
    int n ;
    pid_t pid;
    key_t DOWN,UP;
    DOWN = msgget(200, IPC_CREAT|0644);//Creates new identifier
    UP = msgget(201,IPC_CREAT|0644);

        int shmid;
        shmid = shmget(50, 393216, IPC_CREAT|0644);
void *shmaddr;

  shmaddr = shmat(shmid, (void *)0, 0);
    printf("DOWN = %d\n", DOWN);
    printf("UP = %d\n", UP);
    cout<<"Please enter the number of machines "<<endl;
    cin>>n;
    int* children = new int[n];
    string pids;
    stringstream ss4;
    ss4<<n;
    string number = ss4.str();
    pids+=number;
    pids+=" ";
    for (int i=0;i<n;i++)
    {
         pid = fork();
         children[i]=pid;
         stringstream ss3;
         ss3<<pid;
         string pidstr=ss3.str();
         pids+=pidstr;
         pids+=" ";
        if (pid==0)
            break;
    }
    if (pid==-1) 
    cout<<"Error in fork" <<endl;

    else if (pid==0) // child 
    {
        sleep(1);
        DOWN = msgget(200, IPC_CREAT|0644);
        UP = msgget(201,IPC_CREAT|0644);
        //cout<<"Entering child process"<<endl;

        shmid = shmget(50, 393216, IPC_CREAT|0644);
        shmaddr = shmat(shmid, (void *)0, 0);
        char* pidsrec = new char[100];
        strcpy(pidsrec,(char*) shmaddr);
        stringstream sss;
        string spid(pidsrec);
        sss.str(spid);
        sss>>n;
        children = new int[n];
        for(int i =0;i<n;i++)
        {
            sss>>children[i];
            //cout<<getpid()<<"Child #"<<i<<" = "<<children[i]<<endl;
        }

        srand(getpid());
        int load = (rand()%10) +1;  // load of operating on this system from 1-10
        int count=0;
        while(1)
        {
            int countfail =0;
            char* ask =Recieve(DOWN,true); //nowait
            string asks(ask);
            cout<<getpid()<<" ask= "<<asks<<endl;
            if(strcmp(ask,"none")!=0)
            {
                cout<<"*********"<<getpid()<<" In ASK "<<endl;
                stringstream ss1;
                ss1.str(ask);
                int senderpid=0,processSize=0;
                ss1>>processSize>>senderpid;
                char* processRecMessage = new char[70];
                if(count+ processSize <= load)
                {
                    count+=processSize;
                    strcpy(processRecMessage,"Taken");

                }
                else
                {
                    strcpy(processRecMessage,"Not Taken");
                }
                Send(UP,processRecMessage,senderpid);

            }
            else{
                int nextProcess = (rand()%3) +1;
                if(count + nextProcess <=load)
                {
                    count +=nextProcess;
                }
                else{

                    for(int k = 0;k<3;k++)
                    {
                        int selectedChild = rand()%n;
                        cout<<getpid()<<" Selected Child no "<<selectedChild+1<<" PID="<<children[selectedChild]<<endl;
                        char* x = new char[70];
                        stringstream ss;
                        ss<<nextProcess;
                        ss<<" "<<getpid();
                        strcpy(x,ss.str().c_str());// x= "nextProcess pid" 
                        cout<<x<<endl;
                        Send (DOWN , x,children[selectedChild]);

                        x= Recieve(UP,false);
                        cout<<getpid()<<" UP Value = "<<x<<endl;
                        if (strcmp(x,"Taken")==0){
                            cout<<"Process sent from "<<getpid()<<" to "<<children[selectedChild]<<endl;
                            break;
                        }
                        else
                        {
                            countfail++;
                            printf("TRAIL #%d failed\n",countfail);

                        }

                    }
                    if(countfail==3)
                    {
                        cout<<"Algorithm failed to allocate process.\n";
                        cout<<"Terminating Process "<<getpid()<<endl;
                        break;
                    }
                }
            }
        }

    }
    else //parent
    {

    strcpy((char*) shmaddr,pids.c_str());
    }
    cout<<getpid()<<" GOODBYE"<<endl;
    return 0;
} 
```

我尝试使用任意数量的进程，并且在消息队列的接收端总是收到垃圾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:18:12.100

在你的`Receive`功能中，当你这样做时

```
return message.mtext; 
```

您正在返回一个指向在堆栈上本地分配的数据的指针。函数返回后，堆栈的该区域将无效，因此取消引用指针将导致未定义的行为。此外，如果您在调用另一个函数后使用此指针，则堆栈的该区域很可能已被另一个函数覆盖。

既然您使用的是 C++，为什么不返回`std::string`？它将解决这个问题。

# c# - 如何从列表中取出第一个对象 using Linq I have below code in c# 4.0. //Dictionary object with Key as string and Value as List of Component type object Dictionary<String, List<Component>> dic = new Dictionary<Strin 问问题 问问题 2013-04-23T08:11:53.100 330769 次 This question shows research effort; it is useful and clear 63 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I have below code in c# 4.0. //Dictionary object with Key as string and Value as List of Component type object Dictionary<String, List<Component>> dic = new Dictionary<String, List<Component>>(); //Here I am trying to do the loping for List<Component> foreach (List<Component> lstComp in dic.Values.ToList()) { // Below I am trying to get first component from the lstComp object. // Can we achieve same thing using LINQ? // Which one will give more performance as well as good object handling? Component depCountry = lstComp[0].ComponentValue("Dep"); } Try: var firstElement = lstComp.First(); You can also use FirstOrDefault() just in case lstComp does not contain any items. http://msdn.microsoft.com/en-gb/library/bb340482(v=vs.100).aspx Edit: To get the Component Value: var firstElement = lstComp.First().ComponentValue("Dep"); This would assume there is an element in lstComp. An alternative and safer way would be... var firstOrDefault = lstComp.FirstOrDefault(); if (firstOrDefault != null) { var firstComponentValue = firstOrDefault.ComponentValue("Dep"); } c#.netlistlinqc#-4.0 4 10 回答 10 This answer is useful 109 尝试： var firstElement = lstComp.First(); 您也可以使用FirstOrDefault()以防万一lstComp不包含任何项目。 http://msdn.microsoft.com/en-gb/library/bb340482(v=vs.100).aspx 编辑： 要获得Component Value： var firstElement = lstComp.First().ComponentValue("Dep"); 这将假设lstComp. 另一种更安全的方法是...... var firstOrDefault = lstComp.FirstOrDefault(); if (firstOrDefault != null) { var firstComponentValue = firstOrDefault.ComponentValue("Dep"); } 于 2013-04-23T08:13:27.977 回答 This answer is useful 6 [0] or .First() will give you the same performance whatever happens. But your Dictionary could contains IEnumerable<Component> instead of List<Component>, and then you cant use the [] operator. That is where the difference is huge. So for your example, it doesn't really matters, but for this code, you have no choice to use First(): var dic = new Dictionary<String, IEnumerable<Component>>(); foreach (var components in dic.Values) { // you can't use [0] because components is an IEnumerable<Component> var firstComponent = components.First(); // be aware that it will throw an exception if components is empty. var depCountry = firstComponent.ComponentValue("Dep"); } 于 2013-04-23T08:21:22.387 回答 This answer is useful 3 I do so. List<Object> list = new List<Object>(); if(list.Count>0){ Object obj = list[0]; } 于 2017-11-04T18:17:29.560 回答 This answer is useful 2 You can do Component depCountry = lstComp .Select(x => x.ComponentValue("Dep")) .FirstOrDefault(); Alternatively if you are wanting this for the entire dictionary of values, you can even tie it back to the key var newDictionary = dic.Select(x => new { Key = x.Key, Value = x.Value.Select( y => { depCountry = y.ComponentValue("Dep") }).FirstOrDefault() } .Where(x => x.Value != null) .ToDictionary(x => x.Key, x => x.Value()); This will give you a new dictionary. You can access the values var myTest = newDictionary[key1].depCountry 于 2013-04-23T08:58:47.080 回答 This answer is useful 1 You also can use this: var firstOrDefault = lstComp.FirstOrDefault(); if(firstOrDefault != null) { //doSmth } 于 2013-04-23T08:15:46.160 回答 This answer is useful 1 Try this to get all the list at first, then your desired element (say the First in your case): var desiredElementCompoundValueList = new List<YourType>(); dic.Values.ToList().ForEach( elem => { desiredElementCompoundValue.Add(elem.ComponentValue("Dep")); }); var x = desiredElementCompoundValueList.FirstOrDefault(); To get directly the first element value without a lot of foreach iteration and variable assignment: var desiredCompoundValue = dic.Values.ToList().Select( elem => elem.CompoundValue("Dep")).FirstOrDefault(); See the difference between the two approaches: in the first one you get the list through a ForEach, then your element. In the second you can get your value in a straight way. Same result, different computation ;) 于 2013-04-23T08:30:38.397 回答 This answer is useful 1 for the linq expression you can use like this : List<int> list = new List<int>() {1,2,3 }; var result = (from l in list select l).FirstOrDefault(); for the lambda expression you can use like this List list = new List() { 1, 2, 3 }; int x = list.FirstOrDefault(); 于 2013-04-23T08:47:24.807 回答 This answer is useful 0 There are a bunch of such methods: .First .FirstOrDefault .Single .SingleOrDefault Choose which suits you best. 于 2013-04-23T08:14:33.573 回答 This answer is useful 0 var firstObjectsOfValues = (from d in dic select d.Value[0].ComponentValue("Dep")); 于 2013-04-23T08:27:34.427 回答 This answer is useful 0 I would to it like this: //Dictionary object with Key as string and Value as List of Component type object Dictionary<String, List<Component>> dic = new Dictionary<String, List<Component>>(); //from each element of the dictionary select first component if any IEnumerable<Component> components = dic.Where(kvp => kvp.Value.Any()).Select(kvp => (kvp.Value.First() as Component).ComponentValue("Dep")); but only if it is sure that list contains only objects of Component class or children 于 2013-04-23T08:39:10.380 回答 Related 1 jquery - bootstrap-datepicker 查看准备好的 html 3 android - 如何从postexecute循环更新ui 4 angularjs - AngularJS 错误 - [$compile:multidir] 多指令错误 5 git - 创建中间 git 存储库 0 ios - 帐户续订后未显示应用内购买 1 android - 如何做像gridview这样的android响应式设计 0 c++ - 将字符串复制到动态分配的数组时出现段错误？ 2 android - 单击 listpreference-android 中的项目时显示警报对话框 3 c++ - 不能在没有对象的情况下调用成员函数 std::string class::function() 1 jquery - 带下载进度条的跨域请求 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：16164235
> 
> 赞同：63
> 
> 时间：
> 
> 标签：c#, .net, list, linq, c#-4.0

I have below code in c# 4.0.

```
//Dictionary object with Key as string and Value as List of Component type object
Dictionary<String, List<Component>> dic = new Dictionary<String, List<Component>>();

//Here I am trying to do the loping for List<Component>
foreach (List<Component> lstComp in dic.Values.ToList())
{
    // Below I am trying to get first component from the lstComp object.
    // Can we achieve same thing using LINQ?
    // Which one will give more performance as well as good object handling?
    Component depCountry = lstComp[0].ComponentValue("Dep");
} 
```

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2013-04-23T08:13:27.977

尝试：

```
var firstElement = lstComp.First(); 
```

您也可以使用`FirstOrDefault()`以防万一`lstComp`不包含任何项目。

[http://msdn.microsoft.com/en-gb/library/bb340482(v=vs.100).aspx](http://msdn.microsoft.com/en-gb/library/bb340482(v=vs.100).aspx)

**编辑：**

要获得`Component Value`：

```
var firstElement = lstComp.First().ComponentValue("Dep"); 
```

这将假设`lstComp`. 另一种更安全的方法是......

```
var firstOrDefault = lstComp.FirstOrDefault();
if (firstOrDefault != null) 
{
    var firstComponentValue = firstOrDefault.ComponentValue("Dep");
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-23T08:21:22.387

`[0]` or `.First()` will give you the same performance whatever happens.
But your `Dictionary` could contains `IEnumerable<Component>` instead of `List<Component>`, and then you cant use the `[]` operator. That is where the difference is huge.

So for your example, it doesn't really matters, but for this code, you have no choice to use First():

```
var dic = new Dictionary<String, IEnumerable<Component>>();
foreach (var components in dic.Values)
{
    // you can't use [0] because components is an IEnumerable<Component>
    var firstComponent = components.First(); // be aware that it will throw an exception if components is empty.
    var depCountry = firstComponent.ComponentValue("Dep");
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-11-04T18:17:29.560

I do so.

```
List<Object> list = new List<Object>();

if(list.Count>0){
  Object obj = list[0];
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-23T08:58:47.080

You can do

```
Component depCountry = lstComp
                       .Select(x => x.ComponentValue("Dep"))
                       .FirstOrDefault(); 
```

Alternatively if you are wanting this for the entire dictionary of values, you can even tie it back to the key

```
var newDictionary = dic.Select(x => new 
            {
               Key = x.Key,
               Value = x.Value.Select( y => 
                      {
                          depCountry = y.ComponentValue("Dep")
                      }).FirstOrDefault()
             }
             .Where(x => x.Value != null)
             .ToDictionary(x => x.Key, x => x.Value()); 
```

This will give you a new dictionary. You can access the values

```
var myTest = newDictionary[key1].depCountry 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-23T08:15:46.160

You also can use this:

```
var firstOrDefault = lstComp.FirstOrDefault();
if(firstOrDefault != null) 
{
    //doSmth
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-23T08:30:38.397

Try this to get all the list at first, then your desired element (say the First in your case):

```
var desiredElementCompoundValueList = new List<YourType>();
dic.Values.ToList().ForEach( elem => 
{
   desiredElementCompoundValue.Add(elem.ComponentValue("Dep"));
});
var x = desiredElementCompoundValueList.FirstOrDefault(); 
```

To get directly the first element value without a lot of foreach iteration and variable assignment:

```
var desiredCompoundValue = dic.Values.ToList().Select( elem => elem.CompoundValue("Dep")).FirstOrDefault(); 
```

See the difference between the two approaches: in the first one you get the list through a ForEach, then your element. In the second you can get your value in a straight way.

Same result, different computation ;)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-23T08:47:24.807

for the linq expression you can use like this :

```
 List<int> list = new List<int>() {1,2,3 };
        var result = (from l in list
                     select l).FirstOrDefault(); 
```

for the lambda expression you can use like this

List list = new List() { 1, 2, 3 }; int x = list.FirstOrDefault();

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-23T08:14:33.573

There are a bunch of such methods:
`.First .FirstOrDefault .Single .SingleOrDefault`
Choose which suits you best.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-04-23T08:27:34.427

```
var firstObjectsOfValues = (from d in dic select d.Value[0].ComponentValue("Dep")); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-04-23T08:39:10.380

I would to it like this:

```
//Dictionary object with Key as string and Value as List of Component type object
Dictionary<String, List<Component>> dic = new Dictionary<String, List<Component>>();

//from each element of the dictionary select first component if any
IEnumerable<Component> components = dic.Where(kvp => kvp.Value.Any()).Select(kvp => (kvp.Value.First() as Component).ComponentValue("Dep")); 
```

but only if it is sure that list contains only objects of Component class or children

# jsf - 带转换器的 primefaces 的 selectOneMenu 不能与我的 backingBean 一起使用

> ID：16164237
> 
> 赞同：2
> 
> 时间：2013-04-23T08:11:56.093
> 
> 标签：jsf, converter, selectonemenu

我在使用 selectOneMenu 时遇到了问题，它可以清楚地将 Suppliers 转换为 SupplierBean（我的老板曾经这样称呼它-他是设置它的人），并在页面上正确显示它，但是当我保存它的那一刻，它返回一个空值。

我在 XHTML 中的代码：

```
 <p:selectOneMenu value="#{itemSupplierController.supplierBean}"
converter="supplierConverter">
<f:selectItem itemLabel="Select..." itemValue="" />
<f:selectItems value="#{supplierController.suppliersBean}"
    var="s" itemValue="#{s}" itemLabel="#{s.supplierName}" />
</p:selectOneMenu> 
```

SupplierBean 中的代码：

```
public class SupplierBean {
private int id;
private String supplierName;
public SupplierBean(){
}

public int getId() {
    return id;
}
public void setId(int id) {
    this.id = id;
}
public String getSupplierName() {
    return supplierName;
}
public void setSupplierName(String supplierName) {
    this.supplierName = supplierName;
}
} 
```

转换器代码：

```
@FacesConverter(value = "supplierConverter")
public class SupplierConverter implements Converter {

private static final Logger logger = Logger.getLogger("SupplierConverter");

@Override
public Object getAsObject(FacesContext arg0, UIComponent arg1, String id) {
    logger.info(id);
    SupplierManager manager = EjbInitializer.getSupplierManager();
    if (StringUtils.isNullOrEmpty(id)
            || !org.apache.commons.lang.math.NumberUtils.isNumber(id)) {
        return null;
    } else {
        SupplierBean sb = null;
        try {
            sb = convertToPojo((Supplier) manager.find(Integer.valueOf(id)));
        } catch (SoftTechPersistenceException e) {
            e.printStackTrace();
        }
        return sb;
    }
}

@Override
public String getAsString(FacesContext arg0, UIComponent arg1, Object s) {
    String val = null;
    logger.info("object: " + s);
    if (s != null && (s instanceof SupplierBean)) {
        SupplierBean supplier = (SupplierBean) s;
        val = Integer.toString(supplier.getId());
    }
    logger.info(String.format("value %s", val));
    return val;
}

public static SupplierBean convertToPojo(Supplier s) {
    SupplierBean supplier = new SupplierBean();
    supplier.setId(s.getId());
    String name = "";
    if (s.getFullName().isEmpty()) {
        name = s.getFullName();
    } else {
        name = s.getCompany();
    }
    supplier.setSupplierName(name);
    return supplier;
}
} 
```

我用来保存供应商的 backingBean 中的方法概述（我以前称之为控制器）：

```
public void supplierSave() {
    logger.info("supplier save or update commenced.");
    if (SupplierAction.Create.equals(supplierCurrentAction)) {
        logger.info("adding supplier to the table...");
        addSupplierToTable();
    } else if (SupplierAction.Update.equals(supplierCurrentAction)) {
        logger.info("supplier updating...");
        updateSupplier();
    }
}

public void addSupplierToTable() {
    try {
        logger.info(String.format("supplier id: %s", getSupplierBean().getId()));
        setSupplier((Supplier)supplierManager.find(getSupplierBean().getId()));
        getItemSupplier().setSupplier(getSupplier());
        getItemSuppliers().add(getItemSupplier());
        resetSupplier();
    } catch (Exception e) {
        e.printStackTrace();
    }
    logger.info("supplier successfully added to the table.");
} 
```

# azure - Azure CNAME / A 记录混淆

> ID：16164244
> 
> 赞同：3
> 
> 时间：2013-04-23T08:12:21.953
> 
> 标签：azure, dns, cname, a-records

我在 Azure 上建立了我的第一个站点。我们称它为“mysite.org.uk”。我已将文件作为共享 Azure 网站上传到 Azure。可通过“mysite.azurewebsites.net”访问。现在我想通过将一个实时子域指向它来测试它，所以基本上我希望它用 URL 'cloud.mysite.org.uk' 解析。我已经阅读了文档，它说在我可以将 A 记录添加到我的域来执行此操作之前，我需要创建一个 CNAME 记录。它给出的指令是：

> 无法找到指向“mysite.azurewebsites.net”的“cloud.mysite.org.uk”的 DNS 记录。如果要配置 A 记录，您必须首先使用您的 DNS 提供商为“awverify.cloud.mysite.org.uk”创建一个指向“awverify.mysite.azurewebsites.net”的 CNAME 记录。首先允许资源记录传播，然后创建 A 记录。

好的，所以我已经登录到当前主机的 Plesk 控制面板（控制 DNS）并添加了一条带有“主机”的 CNAME 记录：awverify.www.mysite.org.uk。和“价值”：awverify.mysite.azurewebsites.net。我在 24 多个小时前执行此操作，所以它现在应该已经传播，但是当我尝试在 Azure 门户中添加域时，它仍然告诉我没有验证 CNAME 记录。同样，当我 ping awverify.www.mysite.org.uk 时，它也无法解析（如果设置正确，它肯定应该解析，因为它是一条新记录，所以它不应该依赖 DNS 传播时间？）。

为了安全起见，我还创建了一个包含主机的 CNAME：awverify.cloud.mysite.org.uk 和值：awverify.mysite.azurewebsites.net，但这也不起作用。事实上，当我添加这些 CNAME 记录时，Plesk 告诉我：

> 无法解析规范名称 awverify.mysite.azurewebsites.net。

无论如何，我有点卡住了。我以为我已经非常密切地遵循了文档，但显然有些地方不对劲。

如果有人有任何指示，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T07:44:19.843

奇怪的是，它一定是一个传播问题，因为 48 小时后，当我将域添加到 Azure 时它就可以工作了。

# java - android 的 RTMP 客户端使用 wowza 发布视频

> ID：16164246
> 
> 赞同：2
> 
> 时间：2013-04-23T08:12:24.640
> 
> 标签：java, android, rtmp, wowza

现在我正在研究 android 中的 RTMP 视频流。请给出一些 RTMP 客户端的示例，用于在 android 中发布视频。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-17T11:48:48.027

我会建议 使用 ffmpeg 的[javacv](https://code.google.com/p/javacv/)。我尝试了不同的方法，这是唯一有效的方法。此[示例](http://www.walking-productions.com/notslop/2013/01/16/android-live-streaming-courtesy-of-javacv-and-ffmpeg/)对您有很大帮助，但您需要进行一些更改并更新库。

如果不需要身份验证，您可以使用 flazr。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-17T13:24:44.627

试试这个库[http://code.google.com/p/android-rtmp-client/](http://code.google.com/p/android-rtmp-client/) 这是一个从red5移植的rtmp客户端库，可以在android和其他java平台上使用。与 red5 相比，这个 lib 具有最小的 lib 依赖。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-25T18:01:54.333

您应该使用 Yasea 或 LibRestreaming。

Yasea 可以将实时视频发布到您的 rtmp 服务器（需要 API 16+）

-某些设备，例如 MTK 芯片，您可以使用 yasea 获得 8-14 fps。

如果您的目标 api 是 18 及更高版本，我还向您推荐 LibRestreaming。

- 你可以通过 librestreaming 获得 20-30 fps

[https://github.com/begeekmyfriend/yasea](https://github.com/begeekmyfriend/yasea)

[https://github.com/lakeinchina/librestreaming](https://github.com/lakeinchina/librestreaming)

*我不建议 javacv 发布实时视频，因为它在 apk 中占用 10-15 mb 并且适用于慢 fps*

# regex - Devexpress TextEdit 掩码正则表达式无效

> ID：16164250
> 
> 赞同：1
> 
> 时间：2013-04-23T08:12:59.033
> 
> 标签：regex, winforms, devexpress, percentage, textedit

我正在将掩码设置应用于 Devexpress TextEdit 控件，但在执行时给我语法错误。

```
textEdit1.Properties.Mask.MaskType = DevExpress.XtraEditors.Mask.MaskType.RegEx;
textEdit1.Properties.Mask.EditMask = "(100(?:\\.0{1,3})?|0*?\\.\\d{1,3}|\\d{1,2}(?:\\.\\d{1,3})?)%"; 
```

使用此正则表达式背后的概念是输入 0-100 百分比的值，可选 3 位小数。

like`25, 25.5, 60, 60.369, 99 but 101, 10.2569`是无效值。

请指导我如何纠正这个表达。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:44:36.713

尝试以下操作（我在这里无法访问 devexpress，因此无法完全测试）：

```
(100(\R.0{1,3})?)|((\d{1,2}(\R.\d{1,3})?)) 
```

它分为两个用“|”分隔的备用部分，第一部分检查 100，最多三个十进制零（100、100.0、100.00、100.000）

第二部分处理小数点前一位或两位数的数字，可选小数点和后三位数字（25、25.5、60、60.369、99）。

`\R.`实际*匹配当前区域性的 System.Globalization.NumberFormatInfo.NumberDecimalSeparator 属性指定的小数分隔符*。 根据文档。如果您只想选择小数，则可以更改`\R.`为`\.`

# git - Apt-get 在 Ubuntu 12.04 上找不到包 `git`

> ID：16164261
> 
> 赞同：13
> 
> 时间：2013-04-23T08:13:31.003
> 
> 标签：git, github, ubuntu-12.04

我正在尝试在 ubuntu 12.04 上安装 git。但是当输入命令时

```
sudo apt-get install git 
```

我收到以下消息。我已经跑`sudo apt-get update`了。

```
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Package git is not available, but is referred to by another package.
This may mean that the package is missing, has been obsoleted, or
is only available from another source
However the following packages replace it:
  git-el

E: Package 'git' has no installation candidate 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-23T08:20:48.220

您必须`git-core`安装

```
sudo apt-get -y install git-core 
```

# javascript - javascript中的Django反向url

> ID：16164263
> 
> 赞同：-1
> 
> 时间：2013-04-23T08:13:34.257
> 
> 标签：javascript, django, location, href, reverse

这个 javascript

```
window.location.href = "{% url 'namespace:name' object.slug " + currentRow + " %}" 
```

导致 NoReverseMatch 错误，因为它将“currentRow”作为参数而不是 currentRow 后面的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:18:35.020

您正在混合使用 Javascript 和 Django 模板引擎。

Django 模板引擎看不到 Javascript 变量。没有脚本标签。它只看到文本。

在 Django 模板引擎在服务器端生成 HTML 和 Javascript 之后，在客户端处理 Javascript。

如果您有一个名为 的上下文变量（例如，来自您的 Django 视图或可能在`{% for %}`循环中创建）`currentRow`，您可以像这样直接使用它：

```
 window.location.href = "{% url 'namespace:name' object.slug currentRow %}" 
```

# android - 显示来自mysqllite数据库android的数据

> ID：16164267
> 
> 赞同：-1
> 
> 时间：2013-04-23T08:13:38.777
> 
> 标签：android, android-sqlite

我是android中数据库的新手。我想知道如何从我的数据库中获取行 ID，例如 NAME。我已经使用以下内容进行了一些研究，现在我坚持显示部分。

```
 public class DestinateurTable {

                public String TABLE_NAME="destinateur";

                public String ROW_ID="rowid";
                public String NAME="name";
                public String AGENCE="agence";
                public String EMAIL="email";

            }

        public class Destinataire { 

            public String rowid,name,agence,email;

        }

    **My DBHelper.class**

    public class DBHelper {

    private final String DATABASE_PATH = "/data/data/.../databases/";
    private final String DATABASE_NAME = "...sqlite";
    private final static int DATABASE_VERSION = 1;

    private Context context;
    private SQLiteDatabase database = null;
    OpenHelper openHelper=null;
    StringBuilder query =null;
    Cursor cursor=null;

    DestinateurTable destinataireTable = new DestinateurTable();

    public static DBHelper dbHelper = null;

    private DBHelper(Context context) {

    this.context = context;
    openHelper = new OpenHelper(this.context);
    this.database = openHelper.getWritableDatabase();

    try {

        createDataBase();
        openDataBase();

    } catch (IOException e) {

        e.printStackTrace();
    }

    }
    public static DBHelper getInstance(Context context)
    {
    if(dbHelper == null)
        dbHelper = new DBHelper(context);
    return dbHelper;
    }

   public void openDataBase() throws SQLException{

    //Open the database
    String myPath = DATABASE_PATH + DATABASE_NAME;
    database = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READWRITE);
    }

    /**
     * Creates a empty database on the system and rewrites it with your own database.
     * */
    public void createDataBase() throws IOException
    {
    openHelper.getReadableDatabase();
    if(getDBAlreadyCopiedToDeviceOnceFlag(context) == false){
        try {
        copyDataBase();
        setDBAlreadyCopiedToDeviceOnceFlag(context);
        } catch (IOException e) {
        e.printStackTrace();
        throw new Error("Error copying database");
        }
    }
    }

    /**
     * Check if the database already exist to avoid re-copying the file each time you open the application.
     * @return true if it exists, false if it doesn't
     */
    @SuppressWarnings("unused")
    private boolean checkDataBase(){

    SQLiteDatabase checkDB = null;

    try{
        String myPath = DATABASE_PATH + DATABASE_NAME;
        checkDB = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READWRITE);

    }catch(SQLiteException e){

        //database does't exist yet.

    }

    if(checkDB != null){

        checkDB.close();

    }

    return checkDB != null ? true : false;
    }

    /**
     * Copies your database from your local assets-folder to the just created empty database in the
     * system folder, from where it can be accessed and handled.
     * This is done by transfering bytestream.
     * */
    private void copyDataBase() throws IOException{

    //Open your local db as the input stream
    InputStream myInput = context.getAssets().open(DATABASE_NAME);

    // Path to the just created empty db
    String outFileName = DATABASE_PATH + DATABASE_NAME;

    //Open the empty db as the output stream
    OutputStream myOutput = new FileOutputStream(outFileName);

    //transfer bytes from the inputfile to the outputfile
    byte[] buffer = new byte[1024];
    int length;
    while ((length = myInput.read(buffer))>0){
        myOutput.write(buffer, 0, length);
    }

    //Close the streams
    myOutput.flush();
    myOutput.close();
    myInput.close();

    }

    private class OpenHelper extends SQLiteOpenHelper
    {

        @SuppressWarnings("unused")
        SQLiteStatement insertStmt;

        public OpenHelper(Context context)
        {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
        }

        @Override
        public void onCreate(SQLiteDatabase db)
        {
            // TODO Auto-generated method stub
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion)
        {
            // TODO Auto-generated method stub
        }
    }

    public void setDBAlreadyCopiedToDeviceOnceFlag(Context ctx)
    {
        SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(ctx);
        SharedPreferences.Editor editor = prefs.edit();
        editor.putBoolean("isDBAlreadyCopiedToDeviceOnce", true);
        editor.commit();
    }

    public boolean getDBAlreadyCopiedToDeviceOnceFlag(Context ctx)
    {
        SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(ctx);
        boolean isDBAlreadyCopiedToDeviceOnce = prefs.getBoolean("isDBAlreadyCopiedToDeviceOnce", false);
        return isDBAlreadyCopiedToDeviceOnce; 
    }

    ////////////////////////////
    //// Write your methods here
    ////////////////////////////

    public ArrayList<Destinataire> getDestinataireList()
    {
        ArrayList<Destinataire> items=new ArrayList<Destinataire>();

        try
        {
            query = new StringBuilder();
            query.append("select * from "+destinataireTable.TABLE_NAME);

            cursor=this.database.rawQuery(query.toString(),null);
            if (cursor.moveToFirst())
            {
                do
                {
                    Destinataire d=new Destinataire();

                    d.rowid=cursor.getString(cursor.getColumnIndex(destinataireTable.ROW_ID));
                    d.name=cursor.getString(cursor.getColumnIndex(destinataireTable.NAME));
                    d.agence=cursor.getString(cursor.getColumnIndex(destinataireTable.AGENCE));
                    d.email=cursor.getString(cursor.getColumnIndex(destinataireTable.EMAIL));

                    items.add(d);

                }

                while (cursor.moveToNext());
            }
            if (cursor != null && !cursor.isClosed())
            {
            cursor.close();

            }
        }
        catch(SQLiteException e){

            e.printStackTrace();
            return null;
        }

        return items;
    }

    //--here
    public boolean addDestinataire(Destinataire d){
        this.database.beginTransaction();

        try{

            ContentValues contentValues=new ContentValues();

            contentValues.put(destinataireTable.ROW_ID, d.rowid);
            contentValues.put(destinataireTable.NAME, d.name);
            contentValues.put(destinataireTable.AGENCE, d.agence);
            contentValues.put(destinataireTable.EMAIL, d.email);

            this.database.insert(destinataireTable.TABLE_NAME,null,contentValues);

            this.database.setTransactionSuccessful();

        } catch(Exception e){

            e.printStackTrace();

            return false;

        }   finally{

            this.database.endTransaction();

        }

        return true;
    }

    public boolean deleteDestinataire(String id){

        try {

            String query="delete from " + destinataireTable.TABLE_NAME+" where "+destinataireTable.ROW_ID+"='"+id+"'";
            this.database.execSQL(query);
        }

        catch(SQLiteException e){
            e.printStackTrace();
            return false;
        }
        return true;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:50:52.727

您的整个数据库操作似乎很好。您提到现在要显示数据。最常见的方法是使用连接到[Adapter的](http://developer.android.com/reference/android/widget/Adapter.html)[ListView](https://developer.android.com/reference/android/widget/ListView.html) ，您可以直接将适配器与 Cursor 一起使用，但您已经将它作为 List 获得，因此您可以使用[ArrayAdapter](http://developer.android.com/reference/android/widget/ArrayAdapter.html)

把它当作一个简单的测试，你就开始了解它是如何工作的。创建一个新的 Activity，`extends ListActivity`然后在其上编写以下代码：

```
public class MyListActivity extends ListActivity{
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
         ArrayList<Destinataire> items = getDestinataireList();
         ArrayAdapter<Destinataire> adapter = new ArrayAdapter<Destinataire>(this, android.R.layout.simple_list_item_1 , android.R.id.text1, items)
         setListAdapter(adapter);
    }
} 
```

在 Destinataire 类中也包括这一行：

```
@Override
public String toString() {
    return name + " " + agence + " " + email;
} 
```

这是一个非常基本的示例，并且没有经过优化（例如，您应该使用后台线程从数据库加载数据），但它应该显示一个列表，其中包含您的数据库中的每个项目显示`name agence email`.

快乐编码！

**编辑：**

这一行：

```
new ArrayAdapter<Destinataire>(this, android.R.layout.simple_list_item_1 , android.R.id.text1, items) 
```

...有一些重要的部分，所以让我解释一下：

*   ArrayAdapter：它的标准行为是为 Array 中的对象调用 toString()，在完成第一部分之后，您可以开始研究 CustomAdapter，以制作更复杂（有趣）的东西。
*   this：这是对 ListActivity 的引用。每个活动都扩展了一个 ContextWrapper，这意味着它们持有对设备资源的引用。对于适配器创建布局非常重要。
*   android.R.layout.simple_list_item_1：这是一个标准的 Android 布局，只有 1 行文本。非常简单，但适合快速测试。它告诉适配器为每个项目使用此布局。
*   android.R.id.text1：布局内文本的ID。它告诉适配器布局中有一个具有该 ID 的 TextView。因此它将从数据对象中获取 toString() 并将其设置为 TextView
*   items：那是你的数据。

# c# - Silverlight 应用程序的 CRM2011 插件服务

> ID：16164270
> 
> 赞同：0
> 
> 时间：2013-04-23T08:13:48.413
> 
> 标签：c#, silverlight, service, dynamics-crm-2011

是否可以通过插件将一堆 CRM 实体从 CRM2011 提供给 Silverlight 应用程序？

将 WSDL Url 添加到 Silverlight 失败，并且无法将使用 CRMSVCUTIL 生成的上下文添加到 Silverlight 项目。

获得实体的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T09:01:00.750

不是通过插件。

您可能希望使用 SOAP 或 REST 端点，两者都可以在 MSDN 上找到示例。

从这里开始：[在 Web 资源中使用 Web 服务数据（REST 和 SOAP 端点）](http://msdn.microsoft.com/en-us/library/gg490659.aspx)

（此上下文中的 Web 资源包括 Silverlight）。

选择您希望使用的端点，然后深入到下面的文章，应该足以让您入门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T12:34:14.380

您可以下载用于 Silvelight 的 CSDL 文件。这应该在设置中的开发人员资源中可用。一旦你有了它，谷歌将成为你的朋友。（我会放更多但目前无法浏览）。

# css - 将盒子锁定到位 CSS

> ID：16164271
> 
> 赞同：0
> 
> 时间：2013-04-23T08:13:49.650
> 
> 标签：css, position, css-position

我有一个正在建设的网站，并且有一些定位问题。我在内容部分有两个主要文本框，一个在左上角，一个在右下角。但是，当浏览器边缘移入时，th 框移动到左侧的底部框和右侧的顶部框，因为我使用的是 position:absolute。我想知道是否有办法将它们锁定到位，或者在中间设置一堵“墙”，让它们无法被推过。

```
 #contentleft {
font: normal 14px verdana, sans-serif;
width: 450px;height:275px;
overflow-wrap:normal;
word-wrap:break-word;
position:absolute;
left:550px;
top:175px;
}
#contentright {
font: normal 14px verdana, sans-serif;
margin:0 auto;width: 500px;height:275px;
overflow-wrap:normal;
word-wrap:break-word;
position:absolute;
right:550px;
bottom:100px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:18:46.307

如果两个文本框在父 div 内，则不要过度使用 css 定位。使`#contentleft {float: left}` 控制定位。不要使用`position: absolute`，因为当浏览器未最大化时，它会转到不同的位置。相反，使用`position: relative`以便定位仅在其父 div 内。

# java - java中的套接字服务器

> ID：16164272
> 
> 赞同：2
> 
> 时间：2013-04-23T08:13:51.120
> 
> 标签：java, sockets

我使用 Socket 在 java 中有一个简单的客户端/服务器聊天。问题是程序相互连接，但由于某些原因我无法从双方获取/接收数据。当我断开服务器时，客户端给我一个错误“连接重置”，表明它们已连接但它们不交换数据。

该代码与取自[此处](http://docs.oracle.com/javase/tutorial/networking/sockets/clientServer.html)的 Java 教程中的代码相同。

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package javaapplication3;

/**
 *
 * @author Amr
 */
import java.net.*;
import java.io.*;

public class KnockKnockServer {
    public static void main(String[] args) throws IOException {

        ServerSocket serverSocket = null;
        try {
            serverSocket = new ServerSocket(4440);
        } catch (IOException e) {
            System.err.println("Could not listen on port: 4444.");
            System.exit(1);
        }

        Socket clientSocket = null;
        try {
            clientSocket = serverSocket.accept();
            System.out.println(Inet4Address.getLocalHost());
        } catch (IOException e) {
            System.err.println("Accept failed.");
            System.exit(1);
        }

        PrintWriter out = new PrintWriter(clientSocket.getOutputStream(), true);
        BufferedReader in = new BufferedReader(
                new InputStreamReader(
                clientSocket.getInputStream()));
        String inputLine, outputLine;

        while ((inputLine = in.readLine()) != null) {
             outputLine = "heelo";
             out.println(outputLine);
             if (outputLine.equals("Bye."))
                break;
        }
        out.close();
        in.close();
        clientSocket.close();
        serverSocket.close();
    }
}

import java.io.*;
import java.net.*;

public class KnockKnockClient {
    public static void main(String[] args) throws IOException {

        Socket kkSocket = null;
        PrintWriter out = null;
        BufferedReader in = null;

        try {
            kkSocket = new Socket(Inet4Address.getLocalHost(), 4440);
            out = new PrintWriter(kkSocket.getOutputStream(), true);
            in = new BufferedReader(new InputStreamReader(kkSocket.getInputStream()));
        } catch (UnknownHostException e) {
            System.err.println("Don't know about host: taranis.");
            System.exit(1);
        } catch (IOException e) {
            System.err.println("Couldn't get I/O for the connection to: taranis.");
            System.exit(1);
        }

        BufferedReader stdIn = new BufferedReader(new InputStreamReader(System.in));
        String fromServer;
        String fromUser;

        while ((fromServer = in.readLine()) != null) {
            System.out.println("Server: " + fromServer);
            if (fromServer.equals("Bye."))
                break;

            fromUser = stdIn.readLine();
        if (fromUser != null) {
                System.out.println("Client: " + fromUser);
                out.println(fromUser);
        }
        }

        out.close();
        in.close();
        stdIn.close();
        kkSocket.close();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T08:18:49.433

建立连接后，您的服务器要做的第一件事是

```
while ((inputLine = in.readLine()) != null) 
```

也就是说，它等待客户说些什么。

你的客户做的第一件事是

```
while ((fromServer = in.readLine()) != null) 
```

也就是说，它等待服务器说些什么。

让两者中的一个先发送一些东西，它应该可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T08:25:55.413

该教程中缺少的部分是此块：

```
// initiate conversation with client
KnockKnockProtocol kkp = new KnockKnockProtocol();
outputLine = kkp.processInput(null);
out.println(outputLine); 
```

目前，您没有初始化对话，因此其他海报指出了套接字读取阻塞。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T08:19:08.183

您在客户端和服务器上都有一个线程，该线程`BufferedReader`使用[`readLine()`](http://docs.oracle.com/javase/6/docs/api/java/io/BufferedReader.html#readLine%28%29)阻塞的方法从各自的 .

*由于客户端和服务器都希望在它们中的任何一个发送任何内容之前*相互读取，因此它们都会坐在那里并阻塞。您要么需要分叉并拥有一个从 读取的线程`BufferedReader`和一个写入的线程`PrintWriter`，或者您必须拥有：

```
outputLine = "heelo";
out.println(outputLine); 
```

在你的while循环之外。

# node.js - 一个查询导致 socket.io 上的 3 个连接

> ID：16164275
> 
> 赞同：0
> 
> 时间：2013-04-23T08:14:08.323
> 
> 标签：node.js, socket.io

当用户访问网页时，node.js 会触发 io.sockets.on("connection", ..) 事件 3 次。我想避免这种情况，因为它执行 SQL 查询，并且我不想每个访问者执行 3 次。

其中之一似乎是我的客户端 JS - 我注释掉了客户端 JS 中除了 socket.io 连接线之外的所有内容，我仍然看到在 node.js 中触发了 2 个连接事件。

可能是什么原因？

# java - Google Maps v2 中的动画信息窗口

> ID：16164278
> 
> 赞同：2
> 
> 时间：2013-04-23T08:14:16.323
> 
> 标签：java, android, animation, google-maps-android-api-2

我最近询问了如何将动画应用于标记弹出窗口（信息窗口），并解释了为什么这是不可能的：

> **注意：**绘制的信息窗口不是实时视图。视图在返回时呈现为图像（使用`View.draw(Canvas)`）。这意味着对视图的任何后续更改都不会反映在地图上的信息窗口中。要稍后更新信息窗口（例如，加载图像后），请调用`showInfoWindow()`. 此外，信息窗口不会尊重任何普通视图的典型交互性，例如触摸或手势事件。但是，您可以在整个信息窗口上收听通用单击事件，如下节所述。

研究了更多，我发现了一个使用 V1 的项目，它在标记的位置上手动创建视图。为此，另一个人做了这样的事情：

```
public void showPopup(View view, GeoPoint point, boolean centerPopup) {

    removeAllViews();

    MapView.LayoutParams lp = new MapView.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT,
            point,
            Utils.dipsToPixels(0.0f, mContext),
            Utils.dipsToPixels(-12.0f, mContext),
            MapView.LayoutParams.BOTTOM_CENTER);

    if (centerPopup) {
        getController().animateTo(point);
        mIgnoreNextChangeEvent = true;
    }

    View balloon = mInflater.inflate(R.layout.balloon, null);
    balloon.setLayoutParams(lp);

    ((ViewGroup) balloon.findViewById(R.id.balloonBody)).addView(view);

    balloon.startAnimation(AnimationUtils.loadAnimation(mContext, R.anim.bounce_in));
    addView(balloon);
} 
```

因此，他手动创建了一个气球视图并将其附加到 MapView。

我一直在尝试使用 V2 来模拟同样的事情，但我做不到，我什至不知道这是否可能。例如，我使用“GoogleMap”而不是“MapView”，我不确定这是否与 V1 和 V2 之间的某些差异有关。

我将添加到目前为止的内容作为参考。我试图从另一个项目复制代码并尝试修改它，以便它可以在这个项目中工作，但我什至无法编译它。

```
public boolean onMarkerClick(Marker marker) {
    map.removeAllViews();

    MapView.LayoutParams lp = new MapView.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT,
            marker.getPosition(),
            Tools.dipsToPixels(0.0f, this),
            Tools.dipsToPixels(-12.0f, this),
            MapView.LayoutParams.BOTTOM_CENTER);

    if (centerPopup) {
        getController().animateTo(point);
        mIgnoreNextChangeEvent = true;
    }

    View balloon = mInflater.inflate(R.layout.balloon, null);
    balloon.setLayoutParams(lp);

    ((ViewGroup) balloon.findViewById(R.id.balloonBody)).addView(view);

    balloon.startAnimation(AnimationUtils.loadAnimation(mContext, R.anim.bounce_in));
    addView(balloon);

    return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T14:48:10.173

您无法将滚动地图与可能在其上方的任何视图同步，即使您完成了这种解决方案，它也会看起来很滞后。

您是否尝试过此解决方法：[https](https://stackoverflow.com/a/16147630/2183804) ://stackoverflow.com/a/16147630/2183804 ？

# ios - UIColor resolveClassMethod 未从选择器解析

> ID：16164280
> 
> 赞同：0
> 
> 时间：2013-04-23T08:14:24.617
> 
> 标签：ios, objective-c, uicolor

我对这段代码有疑问：

```
NSString *value = (NSString*)[self.colorsData objectForKey:key]; 
SEL selector = NSSelectorFromString(value);   
BOOL isColorMethod = [[UIColor class] resolveClassMethod:selector]; 
```

`SEL`作为选择器传入的 String 值是`@"redColor"`; 如您所知，它是 ; 的类方法`UIColor`。但`'isColorMethod'` `BOOL`总是返回 NO。

此代码适用于我正在构建的样式引擎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:29:20.513

你使用了错误的方法。如果你想知道某个东西是否是一个字符串方法，你应该使用[`respondsToSelector:`](http://developer.apple.com/mac/library/documentation/cocoa/reference/foundation/Protocols/NSObject_Protocol/Reference/NSObject.html#//apple_ref/occ/intfm/NSObject/respondsToSelector%3a)and [`instancesRespondToSelector:`](https://developer.apple.com/library/mac/#documentation/cocoa/reference/foundation/Classes/NSObject_Class/Reference/Reference.html#//apple_ref/occ/clm/NSObject/instancesRespondToSelector%3a)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:28:41.207

好的，我有一个修复......尽管`respondsToSelector`没有显示为可用的类方法，但您可以这样做：

```
BOOL isColorMethod = [[UIColor class] respondsToSelector:selector]; 
```

但是，我不确定为什么`resolveClassMethod`不起作用`respondsToSelector`。

所以，虽然我在回答我自己的问题，但我很想知道这里发生了什么。

# python - scikit-image 将图像保存到字节串

> ID：16164283
> 
> 赞同：5
> 
> 时间：2013-04-23T08:14:31.163
> 
> 标签：python, in-memory, stringio, scikit-image

我正在使用[scikit-image](http://scikit-image.org/)读取图像：

```
img = skimage.io.imread(filename) 
```

在对 进行一些操作后`img`，我想将其保存到内存文件（a la [`StringIO`](http://docs.python.org/2/library/stringio.html)）以传递给另一个函数，但它看起来[`skimage.io.imsave`](http://scikit-image.org/docs/dev/api/skimage.io.html#imsave)需要文件名，而不是文件句柄。

如果可能的话，我想避免碰到磁盘（`imsave`然后从另一个映像库中读取）。有没有一种很好的方法来使用`imsave`（或其他一些对 scikit-image 友好的功能）`StringIO`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T08:59:08.837

**更新：2020-05-07**

我们现在建议使用该`imageio`库进行图像读取和写入。此外，在 Python 3 中，StringIO 更改为 BytesIO：

```
from io import BytesIO
import imageio

buf = BytesIO()
imageio.imwrite(buf, image, format='png') 
```

* * *

`scikit-image`将图像存储为 numpy 数组，因此您可以使用如下包`matplotlib`：

```
import matplotlib.pyplot as plt
from StringIO import StringIO

s = StringIO()

plt.imsave(s, img) 
```

这可能值得将其添加为默认行为`skimage.io.imsave`，因此如果您愿意，也可以在[https://github.com/scikit-image/scikit-image](https://github.com/scikit-image/scikit-image)提交问题。

# jsf - 如何隐藏 h:selectManyListbox 默认滚动

> ID：16164287
> 
> 赞同：0
> 
> 时间：2013-04-23T08:14:40.307
> 
> 标签：jsf, jsf-2

我 hava **h:selectManyListbox** with **size=3**并且出现了默认禁用的滚动，我想隐藏它，并在必要时显示它（如果 size >3 ）。

请告知如何做到这一点，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:40:15.663

像这样的东西

```
<h:selectManyListbox styleClass="#{(myBean.hideScroll gt 3)?'':'myHideScrollClass'}"... 
```

你的CSS在哪里

```
.myHideScrollClass {

 } 
```

或者简化一点

```
 <h:selectManyListbox style="#{(myBean.hideScroll gt 3)?'':'overflow-y:hidden;'}"... 
```

* * *

此外，`myBean.hideScroll gt 3`您可以使用`myBean.myList.size() gt 3`但确保`myList`不是`null`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:52:32.920

`<h:selectManyListbox />`渲染“选择”和“选项”html 标签。您无法如此详细地控制选择框的外观，它的显示取决于系统。您可以使用一些技巧（条件**size=3**：您可以使用@Daniel 方法）：

```
<style type="text/css">
 .test { 
    display:inline-block; 
    vertical-align:top; 
    overflow:hidden; 
    border:solid grey 1px; 
 }
 .test select { 
    padding:10px; 
    margin:-5px -20px -5px -5px; 
 }
</style>
<div class="test">
<h:selectManyListbox />
</div> 
```

# javascript - 图片库分页

> ID：16164288
> 
> 赞同：0
> 
> 时间：2013-04-23T08:14:44.997
> 
> 标签：javascript, image, pagination, gallery

我创建了以下图片库。

[http://jsfiddle.net/sfiddle/Nf7yR/7/](http://jsfiddle.net/sfiddle/Nf7yR/7/)

我认为问题是，即使我可以掌握段落 css，currentIndex 也不会更新，即似乎缺少事件侦听器。

```
var thumb = document.getElementById("thumb");
myParagraphs = thumb.getElementsByTagName("p");

console.log(myParagraphs[1]);

function thumby(){
$(myParagraphs[currentIndex]).css("background-color", "red");
}

thumby(); 
```

问题是我无法将图像索引与分页点的索引（具有正常的 p 标签）链接起来。

我想这样编码，如果显示第一张图片，第一个点是红色的，如果显示第二张图片，第二个......

我怎么能接近这个？

感谢您提供任何好的建议，因为我已经投入了几个小时，但无法理解它。

PS：不，我不想要插件或现成的图片库，我想要我的工作方法:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T09:46:16.653

您创建了一个函数`thumby()`，但只调用了一次（在脚本启动期间）。您只需要在更改时调用它`currentIndex`。在这里你有固定的代码： http: [//jsfiddle.net/Nf7yR/10/](http://jsfiddle.net/Nf7yR/10/)（我评论了我的编辑）。

顺便说一句，您的代码看起来很糟糕。您应该正确缩进以使其更易于阅读:)

# c# - 更改 DataGrid.ItemSource 的工作方式

> ID：16164302
> 
> 赞同：1
> 
> 时间：2013-04-23T08:15:27.307
> 
> 标签：c#, datetime, datagrid

我正在用数据填充表格。一些数据需要显示日期，为此我使用了`DateTime`对象。它是我编写的合同对象的一部分。

这种方法的问题是，当我想要调用`table.ItemSource`并提供一个合同对象列表`ToString()`时，它会在填充表格时调用它，而不是我想要的 ToShortDateString()。我可以改变它，所以它调用`ToShortDateString()`而不是`ToString()`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:38:33.593

我假设您正在使用 WindowsForms 中的 DataGridView。它与其他 DataGrid 的工作方式几乎相同。

您可以通过设置[Column.DefaultCellStyle.Format](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcellstyle.format.aspx)属性来格式化您的日期。

```
myDateColumn.DefaultCellStyle.Format = CultureInfo.CurrentCulture.DateTimeFormat.ShortDatePattern; 
```

然后当需要打印日期时，它将调用[`.ToString(string format)`](http://msdn.microsoft.com/library/zdtaw1bw%28v=vs.80%29.aspx)而不是`.ToString()`.

由于您使用`ShortDatePattern`当前文化的 ，它应该给出与 完全相同的结果`ToShortDateString()`。

# cuda - cudaBindTextureToArray 和异步操作

> ID：16164303
> 
> 赞同：1
> 
> 时间：2013-04-23T08:15:28.487
> 
> 标签：cuda

我在 CUDA 中进行异步操作。我有以下代码：

```
 cudaBindTextureToArray( tex, ptr1, ... )   // bind texture to cuda array 1.

    Kernel1<<<,,,stream>>>                     // async. kernel1 that uses tex.

    cudaBindTextureToArray( tex, ptr2, ... )   // bind texture to cuda array 2.

    Kernel2<<<,,,stream>>>                     // async. kernel2 that uses tex. 
```

我不得不提问：

*   我可以安全地假设在纹理绑定到 cuda 数组 1 之后执行 Kernel1 吗？

*   我可以安全地假设在纹理绑定到 cuda 数组 2 之后执行 Kernel2 吗？

# java - 更改布局/框架以响应按钮按下

> ID：16164304
> 
> 赞同：2
> 
> 时间：2013-04-23T08:15:29.227
> 
> 标签：java, swing, jframe

我正在尝试使用 Swing 组件（Boggle 类型的游戏）在 Java 上制作一个小游戏。我现在设置它的方式，它基本上会立即打开游戏 - 但我想要一个带有两个按钮的启动窗口 - “Tutorial”和“Play”。我已经有了这个功能（我的教程按钮只是打开一个包含所有东西的新窗口）我只是不确定如何创建第二个 JFrame，然后在我按下 Play 时切换到它（或者更确切地说，创建一个 JFrame，然后切换到按下 JButton 时我已经创建的那个）。我想我可能会导致一个新的 JFrame 在同一位置打开，而旧的 JFrame 变得不可见 - 但我希望有一个更简单的解决方案。

我也想在游戏完成时这样做，再次自动切换到一个小的统计页面 - 所以任何信息都会受到赞赏。

这是我到目前为止所拥有的，以防你们想查看我的代码（我还没有连接 Enter 键发送 userWord 以在我的其他课程中进行验证和评分，或者用 Tile 对象填充 tileGrid，或者计时器....但这一切都将在以后出现！）

```
public class Game implements Runnable {
public void run(){

    final JFrame frame = new JFrame("Boggle");
    frame.setLocation(500,200);

    // Input - holds typing box

    final JLetterField typingArea = new JLetterField(1); 
    typingArea.setFocusTraversalKeysEnabled(false);
    typingArea.setEditable(true);
    typingArea.setFocusable(true);
    typingArea.requestFocusInWindow(); //also this request isn't being granted.. 
                                       //if anyone could explain why i would love you
                                       // I want the focus on the TextField on startup

    frame.add(typingArea, BorderLayout.SOUTH);
    typingArea.addKeyListener(new KeyAdapter() {
        public void keyPressed (KeyEvent e) {
            if (e.getKeyCode() == KeyEvent.VK_ENTER) { // enter key is pressed
                String userWord = typingArea.getText().toLowerCase();
                typingArea.setText("");

            }
        }
    });

    final JLabel status = new JLabel("Running...");

    // Main playing area

    GridLayout tileGrid = new GridLayout(4,4);
    final JPanel grid = new JPanel(tileGrid);
    frame.add(grid, BorderLayout.CENTER);

    // Reset button
    final JPanel control_panel = new JPanel();
    frame.add(control_panel, BorderLayout.NORTH);

    final ImageIcon img = new ImageIcon("Instructions.png", "My Instructions...");
    final JButton info = new JButton("Help");
    info.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            final JFrame infoFrame = new JFrame("Tutorial");
            infoFrame.setLocation(500,50);
            JLabel tutorialImg = new JLabel(img);
            int w = img.getIconWidth();
            int h = img.getIconHeight();
            infoFrame.setSize(w, h);
            infoFrame.add(tutorialImg);
            infoFrame.setVisible(true);
        }
    });
    control_panel.add(info);

    // Put the frame on the screen
    frame.pack();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setVisible(true);

}

public static void main(String[] args){
    SwingUtilities.invokeLater(new Game());
}

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T08:24:57.287

1.  使用[CardLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)而不是[第二个 JFrame](http://docs.oracle.com/javase/tutorial/uiswing/components/frame.html)，[您的概念将走向 OutOfMemory](https://stackoverflow.com/questions/6309407/remove-top-level-container-on-runtime)

2.  如果您想在运行时更改 JFrames 边界，请使用[JFrame.pack（在 CardLayout 中的卡片之间切换后） ，](http://docs.oracle.com/javase/7/docs/api/java/awt/Window.html#pack%28%29)

# c# - 需要使用 for 循环和临时表的存储过程

> ID：16164313
> 
> 赞同：0
> 
> 时间：2013-04-23T08:15:57.987
> 
> 标签：c#, stored-procedures, for-loop

我有一个要求，比如需要显示目标金额、收款金额、当月每天的百分比 例如：本月有 30 天意味着 2013 年 1 月 4 日，我有 3 列，2013 年 2 月 4 日还有 3 列像那样。

我已经在 C# windows 应用程序中使用 for 循环等在代码后面实现了这一点，但是加载时间太长了，请给我任何使用临时表执行上述任务的存储过程或函数

# zend-framework - Zend Framework 下拉列表 onChange

> ID：16164318
> 
> 赞同：0
> 
> 时间：2013-04-23T08:16:19.943
> 
> 标签：zend-framework, html-select

每当我在下拉列表中选择/更改某些内容时，我都想调用一个函数。我的代码是这样的：

```
$aar = $form->createElement ('select','id_category', array('label'=>'Category' , 'required' => true , 'multiOptions'=>$sampleArray));
$aar->setAttribs(array('style' => 'width:300px;', 'width' => '50'));
$aar->setOptions(array('onChange' => $this->go())); 
```

但这不正确，因为当我创建 Zend_Form 时，该函数被调用一次。
请帮助我，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:29:22.437

你可以像这样添加

```
$name = $this->createElement(‘select’,'name’);
$name->addMultioptions(array(

‘select’=>’[select]‘,

’1′ => ‘Faheem’,

’2′ => ‘Abbas’

));

$name->setAttrib(‘onchange’,'AutoFill(this.value)’); 
```

让我知道我是否可以帮助你..

# asp.net - 循环遍历文本框和标签

> ID：16164321
> 
> 赞同：0
> 
> 时间：2013-04-23T08:16:23.377
> 
> 标签：asp.net, vb.net, testing, loops

我正在使用 Microsoft Visual Studios 2012 在 VB 中使用 ASP.NET 进行在线测试。

我试图让一个循环遍历我的文本框并根据一个单词检查它们，这将更改为针对数据库进行验证以查看答案是否正确，但是当我执行循环时，我无法从文本框中获取我的文本。

请看下面

```
Private Sub GoGoGo()

    Dim Textboxname As String        '
    Dim textbox As Object
    Dim TextboxText As Object
    Dim Labelname As String
    Dim label As Object
    Dim LabelText As Object
    Dim Number As Integer  = 1
    Dim MaxTime As Integer = 9
    Dim Currentloop As Integer = 1

    For check As Integer = Currentloop To MaxTime

        If Currentloop <= MaxTime Then
            Textboxname = "TextQ" + Number
            textbox = Textboxname
            TextboxText = textbox
            textbox.ReadOnly = True

        End If

        If Currentloop <= MaxTime Then
            Labelname = "Label" + Number
            label = Labelname
            LabelText = label.Text
            label.Visible = True

        End If

        Number = Number + 1

        If TextboxText = "" Then
            label.Text = "no imput"
            label.ForeColor = Drawing.Color.Black

        End If

        If TextboxText = "server" Then
            label.Text = "Correct"
            label.ForeColor = Drawing.Color.Green
        End If

        If TextboxText = "Wrong" Then
            label.Text = "Wrong"
            label.ForeColor = Drawing.Color.Red
        End If

        If check = 9 Then
            Exit For
        End If

    Next

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:33:12.737

看起来您正在尝试使用控件的字符串标识符来代替实际的控件。相反，您应该使用此标识符并搜索页面上的实际控件。您可以使用[FindControl 方法执行此操作](http://msdn.microsoft.com/en-us/library/31hxzsdw.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1)

因此，您的函数看起来像（未经编译测试）：

```
Private Sub GoGoGo()
    '
    Dim oTextBox As TextBox
    Dim oLabel As Label

    Dim MaxTime As Integer = 9
    Dim Currentloop As Integer = 1

    For check As Integer = Currentloop To MaxTime

        If Currentloop <= MaxTime Then
            'NB You may have to use a recursive call to FindControl. See below.
            oTextBox = CType(Page.FindControl("TextQ" & CStr(check)), TextBox) 
            OTextBox.ReadOnly = True;
        End If

        If Currentloop <= MaxTime Then
            'NB You may have to use a recursive call to FindControl. See below.
            oLabel = CType(Page.FindControl("Label" & CStr(check)), Label)
            oLabel.Visible = True
        End If

        If oTextBox.Text = "" Then
            oLabel.Text = "no imput"
            oLabel.ForeColor = Drawing.Color.Black

        End If

        If oTextBox.Text = "server" Then
            oLabel.Text = "Correct"
            oLabel.ForeColor = Drawing.Color.Green
        End If

        If oTextBox.Text = "Wrong" Then
            oLabel.Text = "Wrong"
            oLabel.ForeColor = Drawing.Color.Red
        End If

    Next

End Sub 
```

一些注意事项：

您不需要所有这些变量。相反，只需找到实际的控件，并直接与属性交互 - 只需在需要时检查 TextBox.Text 值，并直接设置 Label.text 属性。该设置特别重要，因为您要更新原始控件属性以使其显示在页面上。

同样，您不需要`Number`- 您可以使用`check`，因为这是您的循环计数变量。

是否使用`+`运算符或`&`运算符进行字符串连接取决于您。这里已经有一个[很好的问题和几个答案](https://stackoverflow.com/questions/3006153/ampersand-vs-plus-for-concatenating-strings-in-vb-net)。

您也不需要循环的退出条件 - 一旦达到 MaxTime，循环就会退出。如果您希望它提前退出，只需改变您的`To`条件（例如`Currentloop To MaxTime - 1`）

**更新：**

Page.FindControl 仅适用于作为页面上根元素的直接子级的控件。相反，您应该尝试递归调用 FindControl。您还应该确保`TextQ1`存在具有 id 的控件 - 在客户端上查看页面的 HTML 源代码以确保存在`TextBox`具有此 id 的控件。

网上有很多这样的例子。这是您可以添加到页面的 VB.Net 版本（来源： http: [//www.pavey.me/2007/09/recursive-pagefindcontrol-for-vbnet.html ）：](http://www.pavey.me/2007/09/recursive-pagefindcontrol-for-vbnet.html)

```
Public Function FindControlRecursive(Of ItemType)(ByVal Ctrl As Object, ByVal id As String) As ItemType
     If String.Compare(Ctrl.ID, id, StringComparison.OrdinalIgnoreCase) = 0 AndAlso TypeOf Ctrl Is ItemType Then
          Return CType(Ctrl, ItemType)
     End If

     For Each c As Control In Ctrl.Controls
          Dim t As ItemType = FindControlRecursive(Of ItemType)(c, id)

          If t IsNot Nothing Then
               Return t
          End If
     Next

     Return Nothing
End Function 
```

上面代码中的行将变为：

`oTextBox = FindControlRecursive(of TextBox)(Page.Controls(0), "TextQ" & CStr(check))`

您还需要对 Label 控件执行相同的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T09:11:16.940

看起来您只使用名称而不是文本框尝试使用下面的代码

```
Private Sub GoGoGo()

    Dim Textboxname As String        '
    Dim textbox As TextBox
    Dim TextboxText As Object
    Dim Labelname As String
    Dim label As Object
    Dim LabelText As Object
    Dim Number As Integer  = 1
    Dim MaxTime As Integer = 9
    Dim Currentloop As Integer = 1

For check As Integer = Currentloop To MaxTime

    If Currentloop <= MaxTime Then
        Textboxname = "TextQ" + Number
        textbox = Ctype(Me.Controls(Textboxname), TextBox)
        TextboxText = textbox.Text
        textbox.ReadOnly = True

    End If

    If Currentloop <= MaxTime Then
        Labelname = "Label" + Number
        label = Labelname
        LabelText = label.Text
        label.Visible = True

    End If

    Number = Number + 1

    If TextboxText = "" Then
        label.Text = "no imput"
        label.ForeColor = Drawing.Color.Black

    End If

    If TextboxText = "server" Then
        label.Text = "Correct"
        label.ForeColor = Drawing.Color.Green
    End If

    If TextboxText = "Wrong" Then
        label.Text = "Wrong"
        label.ForeColor = Drawing.Color.Red
    End If

    If check = 9 Then
        Exit For
    End If

Next

End Sub 
```

# mysql - 查询执行全表扫描

> ID：16164323
> 
> 赞同：0
> 
> 时间：2013-04-23T08:16:25.900
> 
> 标签：mysql, performance

我的查询没有使用任何索引。查询执行全表扫描。我能做些什么来避免这种情况？

```
explain select * from 
timed_delivery_messages 
where start_time <= '06:39' 
and end_time > '06:39' 
and mode='Active' 
and rotation_weight like '%,45,%' 
and substr(day_of_week, 2, 1) = 'T' 
limit 1; 
```

解释计划

```
+----+-------------+-------------------------+------+---------------+------+---------+------+------+-------------+
| id | select_type | table                   | type | possible_keys | key  | key_len | ref  | rows | Extra       |
+----+-------------+-------------------------+------+---------------+------+---------+------+------+-------------+
|  1 | SIMPLE      | timed_delivery_messages | ALL  | NULL          | NULL | NULL    | NULL |   22 | Using where |
+----+-------------+-------------------------+------+---------------+------+---------+------+------+-------------+
1 row in set (0.00 sec) 
```

表：

```
mysql> show create table timed_delivery_messages\G
*************************** 1\. row ***************************
       Table: timed_delivery_messages
Create Table: CREATE TABLE `timed_delivery_messages` (
  `row_create` datetime DEFAULT NULL,
  `row_mod` datetime DEFAULT NULL,
  `rule_id` int(11) NOT NULL,
  `start_time` time DEFAULT NULL,
  `end_time` time DEFAULT NULL,
  `day_of_week` varchar(7) DEFAULT NULL,
  `rotation_weight` varchar(50) DEFAULT NULL,
  `mode` varchar(10) DEFAULT 'active',
  `long_message` varchar(256) DEFAULT NULL,
  `short_message` varchar(256) DEFAULT NULL,
  PRIMARY KEY (`rule_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
1 row in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T11:40:05.040

您必须创建一个包含列 `start_time`、 `end_time`、 的组索引`mode`

并进行实验以`day_of_week`纳入该索引。也许它会加速你的系统

# asp.net-mvc - 使用 id 从数据库中检索数据并在 mvc 的视图中显示它

> ID：16164324
> 
> 赞同：1
> 
> 时间：2013-04-23T08:16:26.143
> 
> 标签：asp.net-mvc, listview, asp.net-mvc-4, ado.net-entity-data-model

我的问题就在眼前……请给我一个适合我的数据库和操作的新视图。

我的详细信息表：

![明细表](https://i.stack.imgur.com/COLNT.jpg)

使用 html 操作链接传递请求 ID：

```
 @Html.ActionLink(item.Request_ID, "Details",new { requestid = item.Request_ID },null ) 
```

单击链接，我们应该从数据库中获取与链接对应的详细信息。

动作方法：

```
public ActionResult Details(string requestid)
    {
        var entities = new EmployDBEntities1();
       var detailsModel = entities.Details.Single(e => e.Id == requestid);
       return View(detailsModel);
        //return View(entities.Details.ToList());
    } 
```

希望我的问题是返回视图和设计视图。我的要求是我想要特定 id 的详细信息，并且应该在下面设计的视图中显示它们。我能够检查 var 详细信息模型中的 id，然后我必须从数据库中读取剩余的字段并在我的视图中显示这些字段。我值得注意的是这样做。请帮我。

## 看法：

```
model IEnumerable<Approvals.Models.Detail>

@{
ViewBag.Title = "Details";
//Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Header {
@Html.ActionLink("Back", "PendingRequests", "Account", null, new { data_icon = "arrow-l", data_rel = "back" })
<h1>@ViewBag.Title</h1>
@Html.ActionLink("Log Off", "LogOff") 

}

<head>
 <link href="~/StyleSheet1.css" rel="stylesheet" type="text/css" />
    </head>
<div data-role="collapsible"  data-theme="b" data-content-theme="b">
    <h3>Employee Details</h3>
    <table class="td3">
        @foreach (var item in Model) {
        <tr>
            <td>Employee ID</td>
            <td>@Html.Encode(item.EmpID)</td>
        </tr>
            <tr>
                <td>Short ID</td>
                <td>
                    @Html.Encode(item.ShortID)
                </td>
            </tr>
            <tr>
            <td>Grade</td>
            <td>@Html.Encode(item.Grade)</td>
        </tr>
            <tr>
            <td>Vertical</td>
            <td>@Html.Encode(item.Vertical)</td>
        </tr>
            <tr>
            <td>Vertical Head</td>
            <td>@Html.Encode(item.VerticalHead)</td>
        </tr>
            <tr>
            <td>L1 Manager</td>
            <td>@Html.Encode(item.L1_Manager)</td>
        </tr>
            <tr>
            <td>L2 Manager</td>
            <td>@Html.Encode(item.L2_Mnager)</td>
        </tr>
            <tr>
            <td>CostCentre</td>
            <td>@Html.Encode(item.CostCentre)</td>
        </tr>
        }
    </table>
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T08:31:31.097

```
 model Approvals.Models.Detail

@{
ViewBag.Title = "Details";
//Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Header {
@Html.ActionLink("Back", "PendingRequests", "Account", null, new { data_icon = "arrow-l", data_rel = "back" })
<h1>@ViewBag.Title</h1>
@Html.ActionLink("Log Off", "LogOff") 

}

<head>
 <link href="~/StyleSheet1.css" rel="stylesheet" type="text/css" />
    </head>
<div data-role="collapsible"  data-theme="b" data-content-theme="b">
    <h3>Employee Details</h3>
    <table class="td3">
        <tr>
            <td>Employee ID</td>
            <td>@Html.Encode(Model.EmpID)</td>
        </tr>
            <tr>
                <td>Short ID</td>
                <td>
                    @Html.Encode(Model.ShortID)
                </td>
            </tr>
            <tr>
            <td>Grade</td>
            <td>@Html.Encode(Model.Grade)</td>
        </tr>
            <tr>
            <td>Vertical</td>
            <td>@Html.Encode(Model.Vertical)</td>
        </tr>
            <tr>
            <td>Vertical Head</td>
            <td>@Html.Encode(Model.VerticalHead)</td>
        </tr>
            <tr>
            <td>L1 Manager</td>
            <td>@Html.Encode(Model.L1_Manager)</td>
        </tr>
            <tr>
            <td>L2 Manager</td>
            <td>@Html.Encode(Model.L2_Mnager)</td>
        </tr>
            <tr>
            <td>CostCentre</td>
            <td>@Html.Encode(Model.CostCentre)</td>
        </tr>
    </table>
    </div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T10:19:48.233

1.  而不是详细信息模型对象的 var 类型，而是在“详细信息”操作中给出绑定视图的类型，即 Approvals.Models.Detail 的 IEnumerable。

2.  如果未在 return View() 中提供，您的视图名称应与操作名称匹配。否则在“详细信息”操作中返回视图（“xxx”，详细信息模型）。

# android - 需要一个用于 Android NDK + SDK 开发的 IDE

> ID：16164327
> 
> 赞同：4
> 
> 时间：2013-04-23T08:16:44.707
> 
> 标签：android, debugging, sdk, ide, android-ndk

由于我在 Eclipse 上遇到了 ndk 开发问题（当我在 JNI 中打开一个 .c 文件时出现多个错误，所以我无法设置任何断点而无需关闭并在之后重新打开项目）我想知道你们中是否有人知道另一个 IDE，对于我打算使用 NDK 调用本机库和 SDK 其余部分（App gui，对 lib 的调用等）的环境更有效

非常感谢您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-20T14:01:40.867

我会推荐使用基于来自 jetBrains 的 IntelliJ IDEA 的 Android-Studio，当有 v1 版本时，它的 UI 清晰有效，调试器比 eclipse 的不那么烦人，但是原生开发有点棘手，不像 eclipse 提供使用 C++ 编写模块时使用的插件（如果使用 C 编写，当您在 IDE 中打开文件时，编译器会将其视为错误）。因此，我将使用 eclipse 进行原生开发，直到 Android Studio 存在原生模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:56:32.963

可以使用Eclipse，可以在里面集成NDK，还有一些插件可以用来调试原生代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T11:33:35.520

继续在 Linux 上使用具有完整功能的 Eclipse 怎么样。Java 支持和本机语言支持的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-30T17:34:08.393

你试用**过 Visual Studio 2017+**吗？

请记住，使用 Visual Studio 和 C/C++，您可以从单个代码支持 windows、android（也可能是 IO，但未尝试过）。VS 是轻量级但功能强大的 IDE。

我推荐VS2017。

在[visualstudio.microsoft.com](https://visualstudio.microsoft.com/vs/features/cplusplus-mdd/)：

> 一次编写目标所有 C++ 是移动应用程序开发的绝佳语言
> 
> 将现有 C++ 库迁移到 Android、iOS 和 Windows 平台，或使用这些 C++ 库构建完整的 Xamarin Android Native、Java Native Interface 或 iOS 应用程序。您还可以在 Visual Studio 中开发完整的 Android Native-Activity 应用程序。

[![在此处输入图像描述](https://i.stack.imgur.com/zDIoQ.jpg)](https://i.stack.imgur.com/zDIoQ.jpg)

文章：[为 Android、iOS 和 Windows (C++) 构建应用程序](https://docs.microsoft.com/en-us/visualstudio/cross-platform/cross-platform-mobile-development-in-visual-studio?view=vs-2019#build-an-app-for-android-ios-and-windows-c)

文章：[使用 C++ 进行移动开发 | Windows UWP、Android 和 iOS](https://docs.microsoft.com/en-us/cpp/cross-platform/?view=msvc-160)

视频：[ndk 和 Visual Studio 入门](https://www.youtube.com/watch?v=3SJmf1HsVQU)

# spring - 在 tomcat 上运行 spring 3 应用程序的问题

> ID：16164329
> 
> 赞同：0
> 
> 时间：2013-04-23T08:16:52.547
> 
> 标签：spring, tomcat, server-configuration, spring-tool-suite

我正在使用 Spring Tool Suite 作为服务器 VMware vFabric tc Server Developer，但我必须更改为 tomcat6。

启动应用程序时没有任何错误或异常，但由于来自 tomcat 的 404 错误，我无法访问它。

这是日志

```
23 avr. 2013 10:13:12 org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: D:\javatools\java\jdk1.6.0_12\bin;.;C:\WINDOWS\Sun\Java\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\Program Files (x86)\RSA SecurID Token Common;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\Program Files\PuTTY;D:\javatools\java\jdk1.6.0_12;D:\javatools\apache-maven-2.0.10\bin;D:\javatools\java\jdk1.6.0_12;D:\strawberry\c\bin;D:\strawberry\perl\site\bin;D:\strawberry\perl\bin
23 avr. 2013 10:13:13 org.apache.tomcat.util.digester.SetPropertiesRule begin
ATTENTION: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:dashboard' did not find a matching property.
23 avr. 2013 10:13:13 org.apache.coyote.http11.Http11Protocol init
INFO: Initialisation de Coyote HTTP/1.1 sur http-8080
23 avr. 2013 10:13:13 org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 599 ms
23 avr. 2013 10:13:13 org.apache.catalina.core.StandardService start
INFO: Démarrage du service Catalina
23 avr. 2013 10:13:13 org.apache.catalina.core.StandardEngine start
INFO: Starting Servlet Engine: Apache Tomcat/6.0.36
23 avr. 2013 10:13:13 org.apache.catalina.loader.WebappClassLoader validateJarFile
INFO: validateJarFile(D:\Utilisateurs\a553416\Documents\workspace-sts-3.1.0.RELEASE\.metadata\.plugins\org.eclipse.wst.server.core\tmp2\wtpwebapps\dashboard\WEB-INF\lib\javax.servlet-api-3.0.1.jar) - jar not loaded. See Servlet Spec 2.3, section 9.7.2\. Offending class: javax/servlet/Servlet.class
23 avr. 2013 10:13:13 org.apache.coyote.http11.Http11Protocol start
INFO: Démarrage de Coyote HTTP/1.1 sur http-8080
23 avr. 2013 10:13:13 org.apache.jk.common.ChannelSocket init
INFO: JK: ajp13 listening on /0.0.0.0:8009
23 avr. 2013 10:13:13 org.apache.jk.server.JkMain start
INFO: Jk running ID=0 time=0/18  config=null
23 avr. 2013 10:13:13 org.apache.catalina.startup.Catalina start
INFO: Server startup in 604 ms 
```

有人会知道tomcat或配置有什么问题吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-30T16:55:19.310

您的应用程序的上下文路径已更改。按照这个链接

[如何在 Eclipse 中更改动态 Web 项目的上下文根？](https://stackoverflow.com/questions/2437465/java-how-to-change-context-root-of-a-dynamic-web-project-in-eclipse)

将上下文路径设置为 URI，它是应用程序的入口点或在 VMware vFabric tc Server 中工作。从 Tomcat 中取消部署应用程序并再次部署它。

# xpath - Xpath/ 按文本搜索输入节点

> ID：16164334
> 
> 赞同：2
> 
> 时间：2013-04-23T08:17:02.390
> 
> 标签：xpath, webdriver, selenium-webdriver

我有一个搜索框（`<input>`元素），我尝试通过写入其中的文本来获取元素。

我尝试做下一个：

```
// input [@value= "my text"] 
```

但它不起作用（只是为了清楚 - 值不是输入元素的属性。准确地说，当我检查元素时，我看不到这个文本框中写的文本）。

```
<div class="EwdOOOOO">
 <div class="GOOOEOOO">Hello </div> 
 <input type="text" class="GOBLEOOO"> 
</div> 
```

和我放的座位盒：

```
"How are you?" 
```

您可以看到`"How are you?"`在 DOM 中找不到它。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T08:23:08.713

你确定得到你的输入并填充它吗？

喜欢 ：

```
WebElement input = driver.findElement(By.xpath("//input[@class='GOBLEOOO']"));
input.sendKeys("How are you?"); 
```

所以你可以得到你的元素：

```
WebElement inputByValue = driver.findElement(By.xpath("//input[@value='my text']")); 
```

或者你有另一种方法来做到这一点

```
WebElement inputByValue= driver.findElement(By.xpath("//input[contains(@value,'my text')]")); 
```

`contains()``@value`如果您的属性值包含下一个参数（字符串），则返回 true

因为在你输入值之后 总是有一个`value attribute`in 。[这里有更多的输入规范。](http://www.w3schools.com/tags/tag_input.asp)`input`

* * *

如果您想找到具有您在输入字段中键入的值的元素，您可以使用此 xpath。

```
// you get the value you typed in the input
String myValue = driver.findElement(By.xpath("//input[@class='GOBLEOOO']")).getAttribute("value"); 

//you get a element that contains myValue into his attributes
WebElement element = driver.findElement(By.xpath("//*[contains(@id ,myValue) or contains(@value, myValue) or contains(@name, myValue)]")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T19:40:26.277

[在这里](https://stackoverflow.com/questions/7272700/selenium-webelement-value-empty-after-sending-keys/7294090#7294090)查看我的答案。有时，您设置的文本值被分配为文本框的“值”属性而不是“文本”

```
WebElement input = driver.findElement(By.cssSelector("input[type='text']"));
input.sendKeys(enteredValue)
String retrievedText = input.getAttribute("value");
if(retrievedText.equals(enteredValue)){
 //do stuff
} 
```

# ios - 应用未打开时收到推送通知时更新徽章编号

> ID：16164339
> 
> 赞同：10
> 
> 时间：2013-04-23T08:17:28.820
> 
> 标签：ios, push-notification, apple-push-notifications, badge

我有一个应用程序，我面临的问题是只有在我打开通知时才会更新徽章编号，但即使未打开应用程序，我也需要更新徽章编号。

任何人都可以帮我吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-23T08:23:01.247

您需要为`badge`推送通知有效负载中的键设置一个值。根据您的描述，听起来只有您的应用程序在更新徽章编号，而不是通知本身。

有关详细信息，请参阅本地和推送通知编程指南[的通知有效负载：](https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CreatingtheNotificationPayload.html#//apple_ref/doc/uid/TP40008194-CH10-SW1)

> **aps 字典的键和值**
> 
> `badge`（数字）：显示为应用程序图标标记的数字。如果此属性不存在，则徽章不会更改。要移除徽章，请将此属性的值设置为 0。

# javascript - JS D3 textPath 不显示

> ID：16164348
> 
> 赞同：2
> 
> 时间：2013-04-23T08:17:54.617
> 
> 标签：javascript, text, svg, path, d3.js

我有下面的代码，想知道为什么不显示文本路径？任何人都可以帮忙吗？

```
var areas = svg.append("g").selectAll("path")
    .data(chord.groups)
    .enter().append("path")
    .style("fill", function(d) { return fill(d.index); })
    .style("stroke", function(d) { return fill(d.index); })
    .attr("class", "bar")
    .attr("id", function(d, i) { return "group" + i; })
    .attr("d", d3.svg.arc().innerRadius(innerRadius).outerRadius(outerRadius))
    .on("mouseover", fade(.1))
    .on("mouseout", fade(1));

svg.selectAll(".bar").append("text")
    .style("font-size", "10px")
    .attr("fill", "black")
.append("textPath")
    .attr("x", 8)
    .attr("dy", ".35em")
    .style("fill", "#ff00ff")
    .attr("xlink:href", function(d, i) { return "#group" + i; })
    .text("Textexample"); 
```

非常感谢！本杰明

# c# - API 调整屏幕色温 Win RT

> ID：16164349
> 
> 赞同：1
> 
> 时间：2013-04-23T08:17:57.087
> 
> 标签：c#, windows, windows-runtime

我看到 f.lux（桌面应用程序）在 Win 7 上改变了屏幕色温。所以我想知道在 Win RT（只是 Metro 风格的应用程序）中是否有办法做到这一点？

我试过在谷歌上搜索，但找不到任何相关信息。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:28:13.260

在 WinRT 中无法实现这一点。该 api 不提供任何功能来执行此操作，它非常严格。

# c# - 我使用什么协议？rtsp?

> ID：16164350
> 
> 赞同：0
> 
> 时间：2013-04-23T08:17:58.233
> 
> 标签：c#, java, streaming, rtsp, ip-camera

我正在尝试在移动设备（android）上构建一个 IP 摄像头应用程序，该应用程序接收来自摄像头的输入并将其直接发送到端点服务器，每个人都可以在该服务器上跟踪摄像头的输出。问题是我以前没有使用过这个，从一开始对我来说就很难。谁能给我一个线索我使用什么协议？服务器端可以用任何东西编写，我认为是用 C# 编写的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T09:44:14.417

您可以将 native 用于 Android [RTSP](http://developer.android.com/guide/appendix/media-formats.html)。很好的例子它的[Spydroid](https://code.google.com/p/spydroid-ipcamera/)

也不是 Android [RTMP](http://en.wikipedia.org/wiki/Real_Time_Messaging_Protocol)的原生- 从 android 流式传输的方式：Android 的[RTMP 客户端](http://code.google.com/p/android-rtmp-client/)或非免费[的 Aftek 库](http://www.aftek.com/afteklab/aftek-RTMP-library.shtml)。

而且我认为[HTTP Live](http://en.wikipedia.org/wiki/HTTP_Live_Streaming) - 也是可能的，但我找不到示例。

希望有帮助。

# android - Android：空指针异常

> ID：16164353
> 
> 赞同：0
> 
> 时间：2013-04-23T08:18:07.210
> 
> 标签：android, exception, nullpointerexception, loading, ocr

这是我在 Logcat 中遇到的错误。

```
04-23 08:00:07.524: E/AndroidRuntime(1384): FATAL EXCEPTION: main 
04-23 08:00:07.524: E/AndroidRuntime(1384): java.lang.RuntimeException: Unable to start                 activity     ComponentInfo{com.datumdroid.android.ocr.simple/com.datumdroid.android.ocr.simple.SimpleAndroidOCRActivity}: java.lang.NullPointerException
04-23 08:00:07.524: E/AndroidRuntime(1384):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
04-23 08:00:07.524: E/AndroidRuntime(1384):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
04-23 08:00:07.524: E/AndroidRuntime(1384):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
04-23 08:00:07.524: E/AndroidRuntime(1384):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
04-23 08:00:07.524: E/AndroidRuntime(1384):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-23 08:00:07.524: E/AndroidRuntime(1384):     at android.os.Looper.loop(Looper.java:137)
04-23 08:00:07.524: E/AndroidRuntime(1384):     at android.app.ActivityThread.main(ActivityThread.java:5039)
04-23 08:00:07.524: E/AndroidRuntime(1384):     at java.lang.reflect.Method.invokeNative(Native Method)
04-23 08:00:07.524: E/AndroidRuntime(1384):     at java.lang.reflect.Method.invoke(Method.java:511)
04-23 08:00:07.524: E/AndroidRuntime(1384):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-23 08:00:07.524: E/AndroidRuntime(1384):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-23 08:00:07.524: E/AndroidRuntime(1384):     at dalvik.system.NativeStart.main(Native Method)
04-23 08:00:07.524: E/AndroidRuntime(1384): Caused by: java.lang.NullPointerException
04-23 08:00:07.524: E/AndroidRuntime(1384):     at com.datumdroid.android.ocr.simple.SimpleAndroidOCRActivity.onCreate(SimpleAndroidOCRActivity.java:68)
04-23 08:00:07.524: E/AndroidRuntime(1384):     at android.app.Activity.performCreate(Activity.java:5104)
04-23 08:00:07.524: E/AndroidRuntime(1384):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
04-23 08:00:07.524: E/AndroidRuntime(1384):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144) 
```

启动画面活动

```
public class SplashAct extends Activity {
    /** Called when the activity is first created. */
    private final Handler mHandler = new Handler();
    private static final int duration = 1500;

    @Override
    protected void onCreate(final Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.splash);

        mHandler.postDelayed(mPendingLauncherRunnable,
                SplashAct.duration);
    }

    @Override
    protected void onPause() {
        super.onPause();
        mHandler.removeCallbacks(mPendingLauncherRunnable);
    }

    private final Runnable mPendingLauncherRunnable = new Runnable() {

        public void run() {
            final Intent intent = new Intent(SplashAct.this,
                    SimpleAndroidOCRActivity.class);

            startActivity(intent);
            finish();
        }
    };

} 
```

主要活动

```
public class SimpleAndroidOCRActivity extends Activity implements OnInitListener {
    public static final String PACKAGE_NAME = "com.datumdroid.android.ocr.simple";
    public static final String DATA_PATH = Environment
            .getExternalStorageDirectory().toString() + "/SimpleAndroidOCR/";

    // You should have the trained data file in assets folder
    // You can get them at:
    // http://code.google.com/p/tesseract-ocr/downloads/list
    public static final String lang = "eng";

    private static final String TAG = "SimpleAndroidOCR.java";

    protected Button _button, btnSpeak;
    // protected ImageView _image;
    protected EditText _field;
    protected String _path;
    protected boolean _taken;

    protected static final String PHOTO_TAKEN = "photo_taken";

    //tts
    private TextToSpeech tts;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        //tts
         tts = new TextToSpeech(this, this);

         btnSpeak = (Button) findViewById(R.id.button1);
         btnSpeak.setOnClickListener(new View.OnClickListener() {

                @Override
                public void onClick(View arg0) {
                    speakOut();
                }

            });
        //ocr
        String[] paths = new String[] { DATA_PATH, DATA_PATH + "tessdata/" };

        for (String path : paths) {
            File dir = new File(path);
            if (!dir.exists()) {
                if (!dir.mkdirs()) {
                    Log.v(TAG, "ERROR: Creation of directory " + path + " on sdcard failed");
                    return;
                } else {
                    Log.v(TAG, "Created directory " + path + " on sdcard");
                }
            }

        }

        // lang.traineddata file with the app (in assets folder)
        // You can get them at:
        // http://code.google.com/p/tesseract-ocr/downloads/list
        // This area needs work and optimization
        if (!(new File(DATA_PATH + "tessdata/" + lang + ".traineddata")).exists()) {
            try {

                AssetManager assetManager = getAssets();
                InputStream in = assetManager.open("tessdata/eng.traineddata");
                //GZIPInputStream gin = new GZIPInputStream(in);
                OutputStream out = new FileOutputStream(DATA_PATH
                        + "tessdata/eng.traineddata");

                // Transfer bytes from in to out
                byte[] buf = new byte[1024];
                int len;
                //while ((lenf = gin.read(buff)) > 0) {
                while ((len = in.read(buf)) > 0) {
                    out.write(buf, 0, len);
                }
                in.close();
                //gin.close();
                out.close();

                Log.v(TAG, "Copied " + lang + " traineddata");
            } catch (IOException e) {
                Log.e(TAG, "Was unable to copy " + lang + " traineddata " + e.toString());
            }
        }

        super.onCreate(savedInstanceState);

        setContentView(R.layout.main);

        // _image = (ImageView) findViewById(R.id.image);
        _field = (EditText) findViewById(R.id.field);
        _button = (Button) findViewById(R.id.button);
        _button.setOnClickListener(new ButtonClickHandler());

        _path = DATA_PATH + "/ocr.jpg";
    }

    public class ButtonClickHandler implements View.OnClickListener {
        public void onClick(View view) {
            Log.v(TAG, "Starting Camera app");
            startCameraActivity();
        }
    }

    // Simple android photo capture:
    // http://labs.makemachine.net/2010/03/simple-android-photo-capture/

    protected void startCameraActivity() {
        File file = new File(_path);
        Uri outputFileUri = Uri.fromFile(file);

        final Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
        intent.putExtra(MediaStore.EXTRA_OUTPUT, outputFileUri);

        startActivityForResult(intent, 0);
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {

        Log.i(TAG, "resultCode: " + resultCode);

        if (resultCode == -1) {
            onPhotoTaken();
        } else {
            Log.v(TAG, "User cancelled");
        }
    }

    @Override
    protected void onSaveInstanceState(Bundle outState) {
        outState.putBoolean(SimpleAndroidOCRActivity.PHOTO_TAKEN, _taken);
    }

    @Override
    protected void onRestoreInstanceState(Bundle savedInstanceState) {
        Log.i(TAG, "onRestoreInstanceState()");
        if (savedInstanceState.getBoolean(SimpleAndroidOCRActivity.PHOTO_TAKEN)) {
            onPhotoTaken();
        }
    }

    protected void onPhotoTaken() {
        _taken = true;

        BitmapFactory.Options options = new BitmapFactory.Options();
        options.inSampleSize = 4;

        Bitmap bitmap = BitmapFactory.decodeFile(_path, options);

        try {
            ExifInterface exif = new ExifInterface(_path);
            int exifOrientation = exif.getAttributeInt(
                    ExifInterface.TAG_ORIENTATION,
                    ExifInterface.ORIENTATION_NORMAL);

            Log.v(TAG, "Orient: " + exifOrientation);

            int rotate = 0;

            switch (exifOrientation) {
            case ExifInterface.ORIENTATION_ROTATE_90:
                rotate = 90;
                break;
            case ExifInterface.ORIENTATION_ROTATE_180:
                rotate = 180;
                break;
            case ExifInterface.ORIENTATION_ROTATE_270:
                rotate = 270;
                break;
            }

            Log.v(TAG, "Rotation: " + rotate);

            if (rotate != 0) {

                // Getting width & height of the given image.
                int w = bitmap.getWidth();
                int h = bitmap.getHeight();

                // Setting pre rotate
                Matrix mtx = new Matrix();
                mtx.preRotate(rotate);

                // Rotating Bitmap
                bitmap = Bitmap.createBitmap(bitmap, 0, 0, w, h, mtx, false);
            }

            // Convert to ARGB_8888, required by tess
            bitmap = bitmap.copy(Bitmap.Config.ARGB_8888, true);

        } catch (IOException e) {
            Log.e(TAG, "Couldn't correct orientation: " + e.toString());
        }

        // _image.setImageBitmap( bitmap );

        Log.v(TAG, "Before baseApi");

        TessBaseAPI baseApi = new TessBaseAPI();
        baseApi.setDebug(true);
        baseApi.init(DATA_PATH, lang);
        baseApi.setImage(bitmap);

        String recognizedText = baseApi.getUTF8Text();

        baseApi.end();

        // You now have the text in recognizedText var, you can do anything with it.
        // We will display a stripped out trimmed alpha-numeric version of it (if lang is eng)
        // so that garbage doesn't make it to the display.

        Log.v(TAG, "OCRED TEXT: " + recognizedText);

        if ( lang.equalsIgnoreCase("eng") ) {
            recognizedText = recognizedText.replaceAll("[^a-zA-Z0-9]+", " ");
        }

        recognizedText = recognizedText.trim();

        if ( recognizedText.length() != 0 ) {
            _field.setText(_field.getText().toString().length() == 0 ? recognizedText : _field.getText() + " " + recognizedText);
            _field.setSelection(_field.getText().toString().length());
        }

        // Cycle done.
    }

    //tts
    @Override
    public void onDestroy() {
        // Don't forget to shutdown tts!
        if (tts != null) {
            tts.stop();
            tts.shutdown();
        }
        super.onDestroy();
    }

    @Override
    public void onInit(int status) {

        if (status == TextToSpeech.SUCCESS) {

            int result = tts.setLanguage(Locale.US);

            if (result == TextToSpeech.LANG_MISSING_DATA
                    || result == TextToSpeech.LANG_NOT_SUPPORTED) {
                Log.e("TTS", "This Language is not supported");
            } else {
                btnSpeak.setEnabled(true);
                speakOut();
            }

        } else {
            Log.e("TTS", "Initilization Failed!");
        }

    }

    private void speakOut() {

        String text = _field.getText().toString();

        tts.speak(text, TextToSpeech.QUEUE_FLUSH, null);
    }   
} 
```

这是我的类文件，从技术上讲，文件的 OCR 部分来自示例代码，我哪里出错了？我通过启动屏幕活动没有任何问题。如果我`NullPointerException,`推荐 btnSpeak 行，`View.OnClickListener,`我会得到 superOnCreate 错误，添加 super.onCreate 也无济于事。

我一无所知。

顺便说一句，button、button1 和 field 分别是 Button、Button 和 EditText 的 id。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T08:20:08.797

你缺少设置`onCreate`布局`SimpleAndroidOCRActivity`

正如**异常所说：**它的开启`SimpleAndroidOCRActivity.onCreate(SimpleAndroidOCRActivity.java:68)`

所以这样做

```
@Override
            public void onCreate(Bundle savedInstanceState) {
                super.onCreate(savedInstanceState);
                //tts//<<<<<-----------set a layout here first like setContentView(R.layout.main);
                 tts = new TextToSpeech(this, this);

                 btnSpeak = (Button) findViewById(R.id.button1); //then get button or text id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T08:21:05.753

您必须在访问孩子之前设置布局。所以，

```
setContentView(R.layout.main);
btnSpeak = (Button) findViewById(R.id.button1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T08:21:27.270

您尚未为活动设置 contentView `SimpleAndroidOCRActivity`。

添加`setContentView(layoutID);` 下面的行`super.onCreate(savedInstanceState);`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T08:24:25.217

```
 public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.your_activity_layout);//Set your activity layout content first
            //tts
             tts = new TextToSpeech(this, this);

             btnSpeak = (Button) findViewById(R.id.button1);
             btnSpeak.setOnClickListener(new View.OnClickListener() {

                    @Override
                    public void onClick(View arg0) {
                        speakOut();
                    }

                }); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-02T21:42:04.837

基本上每个人都想说的是，你需要确保当你从你的 xml 调用你的视图时，你在 onCreate 方法本身而不是在子方法中调用它，在你设置布局之后和使用视图之前. 把 findViewById 放在你的布局线之后，你会没事的

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-30T09:05:36.703

```
setContentView(R.layout.main);
btn1Speak = (Button)findViewById(R.id.button1); 
```

并检查是否按照 Er 的建议调节或管理您的应用程序。马杜尔达曼德

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-11-19T04:36:43.300

`setContentView(R.layout.activity_main);`

在此之后为布局中使用的所有组件分配 ID。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2018-05-29T11:57:25.810

您必须插入 setContentView (R. layout. main); 查找视图后，请在 findViewById 视图之前插入 setContentView（R.layout.main）。

# gwt - 带 XS 的 GWT。没有帖子，只有选项。加载取消

> ID：16164354
> 
> 赞同：1
> 
> 时间：2013-04-23T08:18:10.823
> 
> 标签：gwt, post, xss, rpc, cors

我有一个 GWT 应用程序的问题，该应用程序相当简单，但将 gwt 的跨站点脚本机制与 GWT-RPC（异步接口）结合使用。

问题是，浏览器只向 RPC-Backend 发送 OPTIONS 命令，而不是 POST。因此数据永远不会到达服务器。这是客户端-服务器通信的捕获：

从 GWT 客户端

```
OPTIONS /contact/contact/dispatchService HTTP/1.1
Host: svr3.dmz.mycompany.com:8380
Connection: keep-alive
Access-Control-Request-Method: POST
Origin: http://www.mycompany.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.43 Safari/537.31
Access-Control-Request-Headers: x-gwt-module-base, x-gwt-permutation, origin, content-type
Accept: */*
Referer: http://www.mycompany.com/contact.html
Accept-Encoding: gzip,deflate,sdch
Accept-Language: de-DE,de;q=0.8,en-US;q=0.6,en;q=0.4
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3 
```

从服务器

```
HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
Allow: POST, TRACE, OPTIONS
Content-Length: 0
Date: Tue, 23 Apr 2013 07:13:06 GMT 
```

但是没有数据通过 POST 发送。

在我的 module.gwt.xml 中，我有以下行用于使用 xs-Linker：

```
<inherits name="com.google.gwt.core.Core" />
<add-linker name="xs" /> 
```

不幸的是，我也尝试过 xsiframe，结果相同。

当我在没有跨站点脚本的情况下直接从同一服务器调用 GWT-Application 时，一切正常：

```
POST /contact/contact/dispatchService HTTP/1.1
Host: svr3.dmz.mycompany.com:8380
Connection: keep-alive
Content-Length: 273
X-GWT-Module-Base: http://svr3.dmz.mycompany.com:8380/contact/contact/
X-GWT-Permutation: 5BE2BF501B916E292DCA5282B8B896AE
Origin: http://svr3.dmz.mycompany.com:8380
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.43 Safari/537.31
Content-Type: text/x-gwt-rpc; charset=UTF-8
Accept: */*
Referer: http://svr3.dmz.mycompany.com:8380/contact/
Accept-Encoding: gzip,deflate,sdch
Accept-Language: de-DE,de;q=0.8,en-US;q=0.6,en;q=0.4
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3
Cookie: __utma=179080955.1318578617.1360141977.1366109245.1366612633.29; __utmc=179080955; __utmz=179080955.1366104741.27.5.utmcsr=www.mycompany.com|utmccn=(referral)|utmcmd=referral|utmcct=/index.html 
```

从服务器

```
7|0|9|http://svr3.dmz.mycompany.com:8380/contact/contact/|C4C9C36F0F0B498822C3C822496B3301|com.mycompany.contact.client.DispatchService|dispatch|com.mycompany.contact.client.DispatchService$Message/2078545930||lastname@mycompany.com|Direct via 
svr3.|givenname|1|2|3|4|1|5|5|6|7|8|9|6|HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
Content-Disposition: attachment
Content-Type: application/json;charset=utf-8
Content-Length: 12
Date: Tue, 23 Apr 2013 07:15:44 GMT

//OK[[],0,7] 
```

Web 应用程序在通过 mod_jk 连接的 Apache2 后面的 Tomcat6 上运行。

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:48:10.353

这称为*预检请求*，由浏览器在您执行跨域请求（由于遗留原因有一些例外）首先检查服务器是否允许 POST 时发出。

您必须`OPTIONS`在服务器端处理请求并使用适当的`Access-Control-Allow-Origin`标头（可能还有`Access-Control-Max-Age`,`Access-Control-Allow-Headers`等）进行响应

见[http://www.w3.org/TR/cors/#cross-origin-request-with-preflight-0](http://www.w3.org/TR/cors/#cross-origin-request-with-preflight-0)

请注意，这（显然）仅适用于支持 CORS 的浏览器，这排除了很多人（IE 仅支持从 IE10 开始的 CORS，不幸的是尚未成为主流）：[http](http://caniuse.com/cors)
://caniuse.com/cors 另见[https： //developers.google.com/web-toolkit/doc/latest/FAQ_Server#SOP,_GWT,_and_XMLHTTPRequest_Calls](https://developers.google.com/web-toolkit/doc/latest/FAQ_Server#SOP,_GWT,_and_XMLHTTPRequest_Calls)

使用`xs`链接器（顺便说一句，你`xsiframe`现在应该更喜欢链接器，文档有点过时了）只修复了脚本的加载，它不包括对服务器的请求。您可以在与 HTML 主机页面相同的源上使用*代理（servlet、脚本、服务器配置等），将请求**路由*到实际部署 RPC 服务的服务器；请参阅[https://developers.google.com/web-toolkit/doc/latest/DevGuideServerCommunication#DevGuideRPCDeployment](https://developers.google.com/web-toolkit/doc/latest/DevGuideServerCommunication#DevGuideRPCDeployment)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T13:39:01.203

根据来自 Thomas Broyer 的信息，我设法通过添加 CORS-Support-Filter 来解决问题：

首先，我将它添加到我的 pom.xml 中：

```
 <dependency>
        <groupId>com.thetransactioncompany</groupId>
        <artifactId>cors-filter</artifactId>
        <version>1.3.2</version>
    </dependency> 
```

然后将此添加到我的 web.xml 中：

```
<filter>
    <!-- The CORS filter with parameters -->
    <filter-name>CORS</filter-name>
    <filter-class>com.thetransactioncompany.cors.CORSFilter</filter-class>

    <!-- Note: All parameters are options, if ommitted CORS Filter
         will fall back to the respective default values.
      -->
    <init-param>
        <param-name>cors.allowGenericHttpRequests</param-name>
        <param-value>true</param-value>
    </init-param>

    <init-param>
        <param-name>cors.allowOrigin</param-name>
        <param-value>*</param-value>
    </init-param>

    <init-param>
        <param-name>cors.allowSubdomains</param-name>
        <param-value>false</param-value>
    </init-param>

    <init-param>
        <param-name>cors.supportedMethods</param-name>
        <param-value>GET, HEAD, POST, OPTIONS</param-value>
    </init-param>

    <init-param>
        <param-name>cors.supportedHeaders</param-name>
        <param-value>Content-Type, X-Requested-With, x-gwt-module-base, x-gwt-permutation, origin</param-value>
    </init-param>

    <init-param>
        <param-name>cors.exposedHeaders</param-name>
        <param-value>X-Test-1, X-Test-2</param-value>
    </init-param>

    <init-param>
        <param-name>cors.supportsCredentials</param-name>
        <param-value>true</param-value>
    </init-param>

    <init-param>
        <param-name>cors.maxAge</param-name>
        <param-value>3600</param-value>
    </init-param>
</filter>
<filter-mapping>
    <filter-name>CORS</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

有关过滤器的更多信息，请参阅[此处](http://software.dzhuvinov.com/cors-filter.html "这里")。

**注意：**此外，我已经使用 IE 8 测试了此解决方案，不幸的是，正如预期的那样，它**不适用于 IE 8**。我还没有使用更新的版本对其进行测试，但由于 IE 8 仍然在野外，我必须通过 mod_jk 将 rpc-servlet 包含到同一个源网站中。

# php - 在 PDO 连接字符串中使用常量并通过 PDO 连接调用函数

> ID：16164358
> 
> 赞同：3
> 
> 时间：2013-04-23T08:18:16.177
> 
> 标签：php, pdo, constants

我在 PDO 连接中使用常量以及调用包含 PDO 连接的函数时遇到问题。

我仅在需要时才使用该功能连接数据库。在不需要数据库工作的页面上，不需要连接。

我已经尝试了很多，但不知道我哪里出错了。

```
<?php
/** The name of the database */
define('DB_NAME', 'dev-db');

/** MySQL database username */
define('DB_USER', 'root');

/** MySQL database password */
define('DB_PASSWORD', 'dxdb');

/** MySQL hostname */
define('DB_HOST', 'localhost');

function connect(){
try
    {**//Here's where the first problem is**
        $conn = new PDO('mysql:host=DB_HOST;dbname=DB_NAME',DB_USER,DB_PASSWORD);
        $conn ->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    }catch(PDOException $e) 
    {
        echo 'ERROR: ' . $e->getMessage();
    }
}

connect();// Here's where it fails again

$sql = 'insert into names (names) values (:what)';
$what = "testValue";
$stmt = $conn->prepare($sql);
$stmt->bindParam(':what', $what, PDO::PARAM_STR, 5);
$stmt->execute(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:59:51.560

事实上，这个问题与 PDO 无关，而与 PHP*字符串*有关。

所以，问题是，“如何在字符串中使用常量？”。

答案很简单——用字符串连接它们。

此外，您连接的方式是错误的。参考[标签wiki](https://stackoverflow.com/tags/pdo/info)了解正确方法

您的第二个问题再次与 PDO 无关，只是[变量范围](http://php.net/manual/en/language.variables.scope.php)问题。只需让你的函数返回`$conn`变量，然后调用它

```
$conn = connect(); 
```

此外，在使用 PDO 的情况下，为主机和数据库定义单独的常量是没有意义的 - DSN 是一个不同的实体，类似于其他驱动程序中的 HOST。

因此，代码可能是（尽管我不确定 dev-db 是否是有效的数据库名称）：

```
define('DB_DSN', 'mysql:host=localhost;dbname=dev-db;charset=utf8');
define('DB_USER', 'root');
define('DB_PASSWORD', 'dxdb');

function connect() 
{
    $opt = array(
        PDO::ATTR_ERRMODE            => PDO::ERRMODE_EXCEPTION,
        PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC
    );
    return new PDO(DB_DSN,DB_USER,DB_PASSWORD, $opt);
}
$conn = connect(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T08:21:28.507

更好的方法是直接使用 connect 语句，在你的情况下不需要函数。

```
$conn = new PDO('mysql:host='. DB_HOST .';dbname='. DB_NAME , DB_USER,DB_PASSWORD); 
```

# c# - 计时元素在列表中的时间

> ID：16164361
> 
> 赞同：2
> 
> 时间：2013-04-23T08:18:22.200
> 
> 标签：c#, unity3d

什么是最简单的方法来跟踪一个元素在列表中的时间长度？例如，我想在添加 2 分钟后从列表中弹出一个元素。

我是否必须创建两个列表，一个保存实际元素，另一个保存该元素添加到列表中的时间？然后检查“时间”列表以知道它何时已达到两分钟？

我有一种感觉有一种更简单有效的方法来做到这一点，但我现在想不出......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T08:21:51.243

如果你想写最少的代码，你可以看看[MemoryCache](http://msdn.microsoft.com/en-us/library/system.runtime.caching.memorycache.aspx)类，它实现了过期策略。

使用[CacheItemPolicy](http://msdn.microsoft.com/en-us/library/system.runtime.caching.cacheitempolicy.aspx)您甚至可以在过期后删除项目时执行回调方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T08:21:43.740

您可以使用包含元素及其存储时间的包装类，而不是将元素直接存储在列表中，然后存储包装类的实例。

您可能希望使用队列而不是列表；您将从前面删除很多项目，这对于队列来说比使用列表更有效。

检查队列的频率是您需要决定的。您可能会使用一个单独的线程来经常检查，在这种情况下，您可能想要使用[`ConcurrentQueue<T>`](http://msdn.microsoft.com/en-us/library/dd267265.aspx)

# sql - 查看 SQL Server 数据到 Oracle

> ID：16164362
> 
> 赞同：2
> 
> 时间：2013-04-23T08:18:26.097
> 
> 标签：sql, sql-server, oracle, oracle-sqldeveloper, gateway

您好，我已经使用 Oracle 网关创建了从 Oracle 到 SQL Server 2008 的数据库链接。

数据库链接：

```
create public database link mssql
connect to "user" identified by "password" 
using 'gateway-SID'; 
```

当我使用简单的查询时，`SELECT * FROM TABLE@MSSQL`结果显然没问题。

当我从表中选择不同的列时会出现问题，例如

```
SELECT COLUMN_NAME FROM TABLE@mssql 
```

我从我的 SQL 开发人员那里得到一个查询错误，说：

> ORA-00904：“客户 ID”：无效标识符
> 00904。00000 -“%s：无效标识符”
> 原因：
> 操作：
> 行错误：1 列：8

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T08:47:58.917

（免责声明：我不是 SQL Server 专家，但我会试一试）

SQL Server 区分大小写 - 你必须引用你的列名，所以而不是

```
SELECT COLUMN_NAME FROM TABLE@mssql 
```

你需要

```
SELECT "COLUMN_NAME" FROM TABLE@mssql 
```

甚至

```
SELECT "COLUMN_NAME" FROM "TABLE"@mssql 
```

请参阅[有关 SQL Server、Oracle 网关和 ORA-00904 的 Oracle 论坛](https://forums.oracle.com/forums/thread.jspa?threadID=2297633)

# delphi - 没有“ShellExecute”Delphi 的重载版本

> ID：16164365
> 
> 赞同：1
> 
> 时间：2013-04-23T08:18:36.620
> 
> 标签：delphi, delphi-2006

我是 Delphi 的初学者，现在我想学习这门语言，但我遇到了错误，我不知道问题出在哪里以及如何解决它。这个例子我把它从书本带到了delphi。

**错误**

[Pascal 错误] Engine.pas(41): E2250 没有可以使用这些参数调用的“ShellExecute”的重载版本

**所有代码：**

```
unit Engine;
interface
uses Windows, Classes, SysUtils;
type
  TTemplate = array of String;
  TEngine = class
private
  FFileName : String;
  FFileLines : TStringList;
protected
  procedure Execute(Path : String); virtual;
public
  Pattern : TTemplate;
  Replace : TTemplate;
  procedure Parse;
  constructor Create(FileName : String);
  destructor Destroy; override;
end;
implementation
{ TEngine }
uses ShellAPI; // włączenie modułu ShellAPI
constructor TEngine.Create(FileName : String);
begin
  FFileName := FileName; // przypisanie wartości parametru do
  FFileLines := TStringList.Create; // utworzenie typu TStringList
  FFileLines.LoadFromFile(FileName); // załadowanie zawartości
  inherited Create;
end;
destructor TEngine.Destroy;
begin
  FFileLines.Free; // zwolnienie typu
  { zwolnienie tablic }
  Pattern := nil;
  Replace := nil;
  DeleteFile('temporary.html'); // wykasowanie pliku tymczasowego
  inherited; // wywołanie destruktora klasy bazowej
end;
procedure TEngine.Execute(Path: String);
begin
  // otwarcie pliku w przeglądarce Internetowej
  ShellExecute(0, 'open', PChar(Path), nil, nil, SW_SHOW);
end;
procedure TEngine.Parse;
var
  i : Integer;
begin
  for I := Low(Pattern) to High(Pattern) do
  { zastąpienie określonych wartości w FFileLines }
  FFileLines.Text := StringReplace(FFileLines.Text, Pattern[i],
  Replace[i], [rfReplaceAll]);
  FFileLines.SaveToFile('temporary.html');
  Execute('temporary.html');
end;
end. 
```

**有错误的地方**

```
ShellExecute(0, 'open', PChar(Path), nil, nil, SW_SHOW); 
```

图片错误 ![在此处输入图像描述](https://i.stack.imgur.com/9noGJ.png)

Ctrl + 单击

```
[SuppressUnmanagedCodeSecurity, DllImport(shell32, CharSet = CharSet.Auto, SetLastError = True, EntryPoint = 'ShellExecute')]
function ShellExecute(hWnd: HWND; Operation, FileName, Parameters,
  Directory: string; ShowCmd: Integer): HINST; external;
[SuppressUnmanagedCodeSecurity, DllImport(shell32, CharSet = CharSet.Auto, SetLastError = True, EntryPoint = 'ShellExecute')] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T09:43:15.113

查看`ShellExecute`.net 实现中的声明`ShellAPI`，很清楚该怎么做。停止转换`PChar`并编写您的代码，如下所示：

```
ShellExecute(0, 'open', Path, '', '', SW_SHOW); 
```

* * *

直到现在我才意识到这一点，但您从 Delphi.net 进行的 Windows API 调用似乎使用与`DllImport`其他 .net 语言相同的属性。我想这是有道理的，这些只是普通的 p/invoke 调用，就像在 C# 互操作代码中一样。

有趣的是，您报告尝试传递`nil`给这些字符串参数之一会导致编译器错误。这意味着没有简单的方法可以将空指针传递给需要 C 字符串的 API 函数。你需要做的是使用一个重载的外部声明，它接收到`Pointer`你想要传递`nil`给的参数。

顺便说一句，Embarcadero 开发商在他们的`DllImport`声明中犯了一个错误。他们设置`SetLastError = True`哪个不正确，`ShellExecute`哪个不设置线程最后一个错误值。

# android - 在android中调用notifyDataSetChanged（）方法时卡住了

> ID：16164370
> 
> 赞同：0
> 
> 时间：2013-04-23T08:18:50.747
> 
> 标签：android, adapter, notifydatasetchanged

这是我更新 ListView 的代码

```
public void onReceive(Conversation newConversation, Message message) {
                LogManager.getLogger(getClass()).info("onReceive");
                Conversation conversation = null;
                ListConversationAdapter adapter = (ListConversationAdapter)listViewConversation.getAdapter();
                int size = adapter.getCount();
                LogManager.getLogger(getClass()).info("size: " + size);
                if(size > 0)
                {
                    for(int i=0;i<size;i++)
                    {
                        if(adapter.getItemId(i) == newConversation.getId())
                        {
                            conversation = (Conversation)adapter.getItem(i);
                            break;
                        }
                    }
                }

                if(conversation == null)
                {
                    adapter.addItem(newConversation);
                    LogManager.getLogger(getClass()).info("add new conversation to adapter");
                }
                LogManager.getLogger(getClass()).info("adapter.getCount(): " + adapter.getCount());
                adapter.notifyDataSetChanged();
                LogManager.getLogger(getClass()).info("notify dataset changed");
            }
        } 
```

这是我的方法调用后的输出结果

```
onReceive
size: 0
add new conversation to adapter
adapter.getCount(): 1 
```

它停在 LogManager.getLogger(getClass()).info("adapter.getCount(): " + adapter.getCount()); 并锁定 adapter.notifyDataSetChanged(); 方法永远我的代码有什么问题？请帮帮我！这是 getView 方法

```
public View getView(int position, View convertView, ViewGroup parent) {
        Conversation conversation = conversations.get(position);
        if(conversation != null)
        {
            LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            LinearLayout parentView = (LinearLayout) inflater.inflate(R.layout.conversation_item, null);

            TextView textViewName = (TextView)parentView.findViewById(R.id.textViewName);
            TextView textViewLastMessage = (TextView)parentView.findViewById(R.id.textViewLastMessage);

            textViewName.setText(conversation.getName());

            List<Message> messages = MessageManager.getProvider().getMessages(conversation.getId(), 0, 0);
            if(messages.size() > 0)
            {
                Message message = messages.get(messages.size() - 1);
                textViewLastMessage.setText(Emoticon.getSmiledText(message.getBody()));
            }

            LogManager.getLogger(getClass()).info("return not null view");
            return parentView;
        }
        LogManager.getLogger(getClass()).info("return null view");
        return null;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T10:35:47.817

首先，在您的 getView 方法中有很多对我来说似乎是错误的事情......

```
public View getView(int position, View convertView, ViewGroup parent) {
        Conversation conversation = conversations.get(position);
        if(convertView == null)
        {
            LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = (LinearLayout) inflater.inflate(R.layout.conversation_item, parent);
        }
            TextView textViewName = (TextView)convertView.findViewById(R.id.textViewName);
            TextView textViewLastMessage = (TextView)convertView.findViewById(R.id.textViewLastMessage);

       if(conversation=null{
            textViewName.setText(conversation.getName());

            List<Message> messages = MessageManager.getProvider().getMessages(conversation.getId(), 0, 0);
            if(messages.size() > 0)
            {
                Message message = messages.get(messages.size() - 1);
                textViewLastMessage.setText(Emoticon.getSmiledText(message.getBody()));
            }
      }
      LogManager.getLogger(getClass()).info("return not null view");
      return convertView;

        } 
```

现在尝试调试您的应用程序并告诉我们它在哪里停止。

# javascript - 将图像放入数组中 - Javascript

> ID：16164371
> 
> 赞同：0
> 
> 时间：2013-04-23T08:18:50.957
> 
> 标签：javascript, jquery, arrays, children

目前，我有代码可以将“幻灯片”类的所有子项放入 jQuery 的数组中。

```
$('.slides').children().each(function (i) {
    var oImg = new Image();
    oImg.src = this.src;
    aImages.push(oImg);         
}); 
```

但现在我听说我们必须使用 Javascript 来创建它。我所有将代码段从 jQuery 重新编码为 Javascript 的尝试都失败了。有人知道如何使它工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:30:19.623

就像是：

```
var elements = document.getElementsByClassName("slides");
for(var i in elements){
  var childElements = elements[i].children;
  for(var j in childElements){
     var child = childElements[j];

     //your code here
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T08:25:29.330

尝试这个：

```
// Get all the elements with class 'slides'
var elements = document.getElementsByClassName('slides');

// Loop through all the elements first...
for (var j = 0; j < elements.length; j++) {

    // Get all the childNodes within each class 'slides'
    var children = elements[j].childNodes;

    // Loop through all the childrens
    for (var i = 0; i < children.length; i++) {
        var oImg = new Image();
        oImg.src = children[i].src;
        aImages.push(oImg);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:30:01.073

尝试

```
var aImages = [];

// get all elements with class slides
var slides = document.getElementsByClassName('slides');

// iterate through the slides array
for (var i = 0; i < slides.length; i++) {
    var slide = slides[0];

    // iterate through each child of slide
    for (var j = 0; i < slide.childNodes.length; i++) {
        var child = slide.childNodes[j];
        var oImg = new Image();
        oImg.src = this.src;
        aImages.push(oImg);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T08:28:04.573

尝试这个：

```
 var elements = document.getElementsByClassName('slides');
    var myImages = elements.getElementsByTagName("img");

    for (var i = 0; i < myImages.length; i++) {
        var oImg = new Image();
        oImg.src = myImages[i].src;
        aImages.push(oImg);
    } 
```

# java - 计算一长串随机双打的几何平均值

> ID：16164373
> 
> 赞同：5
> 
> 时间：2013-04-23T08:18:52.713
> 
> 标签：java, math

所以，我今天在构建受限玻尔兹曼机时遇到了一个问题，这个问题应该是微不足道的，但似乎非常困难。基本上我将 2k 值初始化为 0 到 1 之间的随机双精度值。

我想做的是计算这个数据集的几何平均值。我遇到的问题是，由于数据集很长，将所有内容相乘总是会导致零，并且在每一步都进行正确的根操作只会变成 1。

我可能会将列表分块，但我认为这真的很糟糕。关于如何以优雅的方式做到这一点的任何想法？

理论上，我想扩展我当前的 RBM 代码，使其拥有接近 15k+ 的条目，并且能够跨多个线程运行 RBM。可悲的是，这排除了 apache commons 数学（几何平均方法不同步），longs。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-23T08:33:15.857

哇，使用大的十进制类型太矫枉过正了！

只需取所有内容的对数，找到算术平均值，然后取幂即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T09:18:22.227

Mehrdad 的对数解决方案确实有效。不过，您可以做得更快（并且可能更准确）：

1.  计算数字的指数之和，例如`S`。
2.  将所有指数全部归零，使每个数字都在`1/2`和之间`1`。
3.  将数字分组为最多 1000 个的字符串。
    *   对于每个组，计算数字的乘积。这不会下溢。
    *   将乘积`S`的指数加到并将指数猛击为零。
4.  你现在有大约 1/1000 的数字。重复步骤 2 和 3，除非您只有一个号码。
5.  拨打剩下的一个号码`T`。几何平均值是`T`^(1/`N`) 2 ^(`S`/`N`)，其中`N`是输入的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:30:26.870

看起来在足够数量的乘法之后，双精度不再足够了。太多的前导零，如果你愿意的话。

[关于任意精度算术的 wiki 页面](http://en.wikipedia.org/wiki/Bignum)显示了一些处理该问题的方法。在 Java 中，BigDecimal 似乎是要走的路，尽管以牺牲速度为代价。

# jenkins - 一台 Jenkins 服务器和多台 Gerrit 服务器

> ID：16164376
> 
> 赞同：1
> 
> 时间：2013-04-23T08:18:59.860
> 
> 标签：jenkins, jenkins-plugins, gerrit

我需要一个解决方案来处理一个连接到多个 Gerrit 服务器的 Jenkins 服务器。据我所知，Jenkins 中的 Gerrit 插件只能填写一个 URL。任何人都知道是否可以为多个 gerrit 服务器配置一个插件？或者我需要安装几个插件（如果可能的话）。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:46:55.927

不幸的是，Jenkins 的 gerrit-trigger 插件目前只能连接到一台 Gerrit 服务器。开发人员表示他们愿意为增强插件以支持多个 Gerrit 服务器的贡献开放，但目前还没有人为此完成工作。

无法在 Jenkins 中加载插件的多个副本。此时您唯一的选择是为每个 Gerrit 服务器设置至少一个 Jenkins 服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-31T12:16:10.907

从版本 2.11.0-beta-1（2013 年 11 月 26 日发布）开始支持多个 Gerrit 服务器

# python - 多次调用 Python cgi fieldstorage

> ID：16164385
> 
> 赞同：4
> 
> 时间：2013-04-23T08:19:09.823
> 
> 标签：python, cgi

我对 python 的 cgi.FieldStorage() 不太熟悉，我在我的项目中遇到了麻烦。基本上，在我的主页上，我有一个名为criteria 的html 表单。表单的操作调用 process.py，它使用 FieldStorage() 从表单获取输入并生成新的结果页面。它第一次加载很好。

```
 <form action="process.py" name="SearchForm">
 <select id="criterion">
        <option value="None">None</option>
        <option value="result1">Result 1</option>
        <option value="result2">Result 2</option>
    </select>
 <input type = "submit">
 </form> 
```

我的问题是，在我的 process.py 中，我使用 Python 生成与主页相同的 html。所以结果页面也有一个名为criteria的表单，它调用process.py。但是，如果我再次在表单中输入内容，则调用 process.py 但 cgi.FieldStorage 完全为空。有可能解决这个问题吗？

编辑：在我的 process.py

```
import cgi

form = cgi.FieldStorage() 
if 'criterion' in form:
table_name = form['criterion'].value

print "Content-Type: text/html\r\n\r\n"
print """\
  <html>
   <head></head>
   <body>  
  <form action="process.py" name="SearchForm">
    <select id="criterion">
        <option value="None">None</option>
        <option value="result1">Result 1</option>
        <option value="result2">Result 2</option>
    </select>
 <input type = "submit">
 </form>"""
 select(table_name) 
```

打印"""\
"""

这不是我的全部代码，但这是它的要点。select(table_name) 是用于根据标准值生成信息的 python 方法。再次调用 process.py 但 cgi.fieldstorage() 现在是空的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T10:02:30.023

`cgi.FieldStorage()`消耗标准输入，所以它应该只被实例化一次。您确定在任何情况下都不会再次实例化它吗？该问题的推荐解决方案是将第一个实例放在变量中，并将其作为参数传递给需要访问请求数据的函数。

此外，您可以尝试将完整的`process.py`url (ie `http://localhost/process.py`) 放入表单操作中，看看是否有帮助。

来源：[http ://docs.python.org/2/library/cgi.html](http://docs.python.org/2/library/cgi.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T09:07:02.647

我想代码给了你一个例外，所以你总是可以使用 try/except。这不是最好的方法，但我想它可能会奏效。

```
flag = True
try:
    form = cgi.FieldStorage() 
    if 'criterion' in form:
        table_name = form['criterion'].value
exception:
    # you catch the exception
    flag = False 
```

现在使用 flag 您可以控制 FieldStorage 为空的情况：

```
if flag:
    select(table_name)  
else:
    # do whatever
    pass 
```

# visual-studio-2012 - Firebird NET 提供程序和 Visual Studio 2012

> ID：16164392
> 
> 赞同：0
> 
> 时间：2013-04-23T08:19:23.403
> 
> 标签：visual-studio-2012, firebird

我已经使用 Visual Studio 2012 Premium 在 Windows 8 Enterprise（64 位）上成功安装了 Firebird NETProvider 和 DDEXProvider：我在服务器资源管理器中添加了一个连接，并且能够看到数据库对象。但是，当我安装其他扩展程序（Web Essentials、Power Tools、Resharper）时，我失去了以前保存的连接并且无法重新创建它，因为 Firebird NETProvider 不再可用。安装 Windows 更新 (KB2781514) 后的结果相同，涉及 VS2012 的修复。重新安装 NETProvider 和 DDEXProvider 会导致 VS 配置出现问题（数据提供者的双重条目等）。

我不确定在具有旧版 Firebird-database 的项目中使用 Firebird NETProvider) ，因为它在 VS2012 中似乎不稳定。希望有人可以帮助我。

提前谢谢了

德克·谢尔福

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-25T15:59:58.930

安装 VS 2012 SDK 后我遇到了同样的问题。解决方法：点击安装程序中的高级按钮，验证是否勾选了VS和OS的正确组合。在我的安装中，检查了 VS 2012（64 位操作系统），但我有 W7 32 位......您可能还需要检查 machine.config 文件。重新安装后，我有几个 Firebird 数据提供者的重复条目。问候，乌利。

# wpf - 如何更改部分数据模板背景

> ID：16164398
> 
> 赞同：0
> 
> 时间：2013-04-23T08:19:38.617
> 
> 标签：wpf, listbox, datatemplate

我有一个 ListBox，它的 DateTemplate 如下所示：

```
<Grid Margin="30,0,0,0" HorizontalAlignment="Left">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <Image Source="{Binding Path=IconSource}"/>
                <TextBlock Grid.Column="1" Background="{x:Null}" Text="{Binding Path=DisplayText, Mode=Default}" Foreground="Black"/>
            </Grid> 
```

这是 ItemContainerStyle：

```
 <Style x:Key="Test" TargetType="ListBoxItem">
        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListBoxItem">
                    <Border Name="Border" SnapsToDevicePixels="True">
                        <ContentPresenter/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsSelected" Value="true">
                            <Setter TargetName="Border" Property="Background" Value="Blue" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

选择一个ListBoxItem时，是否可以不设置图像的背景？就像在 VS 的 Intellisense 中一样，API 的图标没有背景。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T12:01:39.243

最简单的方法是将您的图像放入另一个Grid 中`Grid`，并将 Grid 设置为`Background`您希望图像具有的背景颜色 - 然后当您更改`Background`parent`Border`时，图像的父网格将保护它免受背景颜色更改的影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T09:26:01.340

我不完全确定这是否是您的意思，但我建议不要使用数据模板，而是使用项目容器控件模板的元素进行所有必要的数据绑定。这是可能的，因为项目容器和数据模板实际上共享相同的数据上下文。在 a 的情况下`ListBoxItem`，这将如下所示：

```
<ControlTemplate x:Key="ListBoxItemTemplate" TargetType="ListBoxItem">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>
        <Image Source="{Binding IconSource}" Height="50" Margin="0,0,5,0"/>
        <Border x:Name="Border" VerticalAlignment="Center" Grid.Column="1">
            <TextBlock Text="{Binding Name}" />
        </Border>
    </Grid>
      <ControlTemplate.Triggers>
          <Trigger Property="IsSelected" Value="true">
              <Setter TargetName="Border" Property="Background" Value="Blue" />
          </Trigger>
      </ControlTemplate.Triggers>

</ControlTemplate> 
```

您将`ItemsContainerStyle`在您的`ListBox`.

总之：不要使用数据模板，而是将其合并到 ItemContainerStyle 中。因此，您可以保持 Image 元素的背景不变。

希望这可以帮助。

# delphi - 在delphi中隐藏对象检查器的属性

> ID：16164399
> 
> 赞同：5
> 
> 时间：2013-04-23T08:19:41.060
> 
> 标签：delphi

我想制作一个新组件。如何`Caption`在对象检查器中隐藏属性？我`TPanel`用作祖先类。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-23T08:48:31.480

用作`TCustomPanel`基类并发布您需要的属性。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-23T08:22:53.950

通过使用 [UnlistPublishedProperty](http://docwiki.embarcadero.com/Libraries/XE2/en/DesignIntf.UnlistPublishedProperty)。在此链接[http://delphihaven.wordpress.com/2009/05/17/tip-removing-a-property-at-design-time/](http://delphihaven.wordpress.com/2009/05/17/tip-removing-a-property-at-design-time/)您可以找到一个完整解释的示例。

LE：作为一种好的做法，您应该创建另一个类，TCustomPanel 的后代，并仅发布您需要/想要的属性。

# ruby - 安装 gem 时输出格式化程序无效

> ID：16164400
> 
> 赞同：0
> 
> 时间：2013-04-23T08:19:43.450
> 
> 标签：ruby, gem, rdoc

我为自己的使用构建了一个 gem，当我想安装它时，我得到以下信息：

```
$ gem install mygem

Successfully installed mygem-0.0.1
1 gem installed
Installing RDoc documentation for mygem-0.0.1...

Invalid output formatter

For help on options, try 'rdoc --help' 
```

gem**工作正常**，但我想知道是什么原因造成的，因为我在安装任何其他 gem 时从未见过它。看起来它与 RDoc 有某种关系，但我找不到任何关于它的搜索。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T13:34:29.030

你能检查你的 RDoc 输出格式吗？在这里发现了一个类似的问题

[https://github.com/tenderlove/paddle/issues/1](https://github.com/tenderlove/paddle/issues/1)

# html - 滚动条显示在窗口而不是我的 div 上

> ID：16164401
> 
> 赞同：0
> 
> 时间：2013-04-23T08:19:53.373
> 
> 标签：html, css, resize, scrollbar, overflow

当内容太宽时，我无法在我的 div 上获得滚动条。相反，我总是在窗口本身上获得滚动条。我玩过溢出设置，但我无法正确设置。

[jsFiddle](http://jsfiddle.net/UFcuQ/)

**HTML**

```
<table class="wrapper" cellSpacing="0" cellPadding="0">
    <tr>
        <td class="header">
            <div>
                <p class="title">HEADER</p>
                <p class="subtitle">subheader</p>
            </div>
        </td>
    </tr>
    <tr>
        <td class="content">
            <div class="clearfix">
                <div class="col4">
                    <div>
                        <label class="fieldname">Field 1</label>
                        <span class="fieldcontrol"><input type="text" id="Text1" /></span>
                    </div>
                    <div>
                        <label class="fieldname">Field 2</label>
                        <span class="fieldcontrol"><input type="text" id="Text2" /></span>
                    </div>
                    <div>
                        <label class="fieldname">Field 3</label>
                        <span class="fieldcontrol"><input type="text" id="Text3" /></span>
                    </div>
                    <div>
                        <label class="fieldname">Field 4</label>
                        <span class="fieldcontrol"><input type="text" id="Text4" /></span>
                    </div>
                </div>
            </div>
        </td>
    </tr>
    <tr>
        <td class="footer">
            <div class="clearfix">
                <div class="left">
                </div>
                <div class="right">
                    <button type="submit">Ok</button>
                    <button>Cancel</button>
                </div>
            </div>
        </td>
    </tr>
</table> 
```

**CSS**

```
.content > div
{
    overflow: auto;
} 
```

它是使用表格的页眉、正文和页脚。在正文中，我想要一个 div 来拉伸表格单元格的整个宽度和高度。当我调整窗口大小时，我希望页眉和页脚保持调整大小，并且当内容位于可见区域之外时，正文显示滚动条。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:32:04.690

只使用 div 不是更容易吗？ [http://jsfiddle.net/tP79v/2/](http://jsfiddle.net/tP79v/2/)

html

```
<div class="header">Header</div>
<div class="main">
    <div class="toBig"></div>
</div>
<div class="footer"></div> 
```

css

```
.body {
    overflow:hidden;
}

.header {
    position: absolute;
    top:0;
    left:0;
    width:100%;
    height:30px;
    background-color:lightblue;
}

.main {
    position: absolute;
    top:30px;
    bottom: 20px;
    width:100%;
    left: 0;
    background-color:red;
    overflow: auto;
}

.toBig {
    position:relative;
    width: 1000px;
    height: 200px;
    background-color:yellow;
    margin:20px;
}

.footer {
    position: absolute;
    bottom:0;
    left:0;
    height:20px;
    width:100%;
    background-color:green;
} 
```

# java - 加快实体管理器对 3000 条记录的提交

> ID：16164403
> 
> 赞同：0
> 
> 时间：2013-04-23T08:20:03.703
> 
> 标签：java, jpa, eclipselink, derby, entitymanager

我有 3 个实体，每个实体有 5 个成员字符串，我想为每个实体保留 1000 条记录。当我进行性能测试`entitymanager.commit()`大约需要 1.1 秒时，我认为这太长了……有办法加快实体管理器的提交速度吗？

我正在使用带有 Eclipse 链接的 Derby DB。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T09:04:51.913

您可以通过启用批处理获得最大收益，但您还应该考虑其他优化。您可以通过在持久性 xml 中为持久性单元设置以下属性来启用批处理：“eclipselink.jdbc.batch-writing”="JDBC"。

我建议阅读[http://java-persistence-performance.blogspot.fi/2011/06/how-to-improve-jpa-performance-by-1825.html上的文章](http://java-persistence-performance.blogspot.fi/2011/06/how-to-improve-jpa-performance-by-1825.html)

# django - 更新 M2M 关系 django rest framework (many=true)

> ID：16164404
> 
> 赞同：3
> 
> 时间：2013-04-23T08:20:05.523
> 
> 标签：django, django-rest-framework

我尝试更新频道：

```
PUT
content [{'url': 'http://localhost:8000/api/movies/2', 'title': u'Ariel', 'backdrop_path': u'/z2QUexmccqrvw1kDMw3R8TxAh5E.jpg', 'popularity': 0.082, 'poster_path': u'/8ld3BEg8gnynRsfj2AzbLocD8NR.jpg', 'release_date': datetime.date(1988, 10, 21), 'runtime': 69L, 'tagline': u'', 'vote_average': 9.0, 'vote_count': 0L}]
csrfmiddlewaretoken XXXXXXXXXXXXXXXXXXXXXXXXXXx
name    cody private
owner   http://localhost:8000/api/users/1
private 1 
```

我得到这个错误：

```
instance should be a queryset or other iterable with many=True 
```

这是您需要了解正在发生的事情的代码。

```
class Channel(models.Model):
    """
    A channel is a "container" for a users movies and television shows.
    """
    PUBLIC_VISIBILITY, PRIVATE_VISIBILITY = 0, 1
    VISIBILITY_CHOICES = (
        (PUBLIC_VISIBILITY, 'public'),
        (PRIVATE_VISIBILITY, 'private'),
    )
    owner = models.ForeignKey(User, related_name='owned_channels')
    name = models.CharField(max_length=60)
    content = models.ManyToManyField(Movie, db_table='channel_contents',
                                     related_name='channels', null=True, blank=True, default=None)
    subscribers = models.ManyToManyField(User, db_table='channel_subscribers',
                                         related_name='subscribed_channels', null=True, blank=True, default=None)
    created = models.DateTimeField(auto_now_add=True)
    last_mod = models.DateTimeField(auto_now=True)
    query = models.CharField(max_length=255, default='')
    private = models.IntegerField(choices=VISIBILITY_CHOICES, default=PRIVATE_VISIBILITY)

    default = models.BooleanField(default=False)

class Movie(models.Model):
    id = models.BigIntegerField(primary_key=True)
    adult = models.BooleanField()
    backdrop_path = models.ImageField(upload_to='backdrop/')
    budget = models.IntegerField(blank=True, null=True)
    genres = models.ManyToManyField('Genre',
                                    through='MovieGenre',
                                    blank=True, null=True)
    homepage = models.URLField(blank=True, null=True)
    imdb_id = models.CharField(max_length=20, blank=True, null=True)
    original_title = models.CharField(max_length=100)
    overview = models.TextField(blank=True, null=True)
    popularity = models.FloatField(blank=True, null=True)
    poster_path = models.ImageField(upload_to='poster/')
    release_date = models.DateField(blank=True, null=True)
    revenue = models.IntegerField(blank=True, null=True)
    runtime = models.IntegerField(blank=True, null=True)
    tagline = models.CharField(max_length=200, blank=True, null=True)
    title = models.CharField(max_length=100, db_index=True)
    vote_average = models.FloatField(blank=True, null=True)
    vote_count = models.IntegerField(blank=True, null=True)
    actors = models.ManyToManyField('Actor',
                                    through='MovieActor',
                                    blank=True, null=True)
    directors = models.ManyToManyField('Director',
                                       through='MovieDirector',
                                       blank=True, null=True)
    production_companies = models.ManyToManyField(
        'ProductionCompany',
        through='MovieProduction',
        blank=True, null=True) 
```

通道序列化代码：

```
# Routes
url(r'^channels$', ChannelList.as_view(), name='channel-list'),
url(r'^channels/(?P<pk>\d+)$', ChannelDetail.as_view(), name='channel-detail'),

# Views
class ChannelList(generics.ListCreateAPIView):
    """
    API endpoint that represents a list of users.
    """
    model = Channel
    serializer_class = ChannelSerializer

class ChannelDetail(generics.RetrieveUpdateDestroyAPIView):
    """
    API endpoint that represents a single users.
    """
    model = Channel
    serializer_class = ChannelSerializer

# Serializer
class ChannelSerializer(serializers.HyperlinkedModelSerializer):
    content = MovieSerializer(many=True)

    class Meta:
        model = Channel
        fields = ('url', 'owner', 'name', 'content', 'private') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T01:11:21.360

如您[在此处](https://stackoverflow.com/a/13923686/1326146)阅读的，嵌套关系目前不支持写操作。改用[`HyperlinkedRelatedField`](http://www.django-rest-framework.org/api-guide/relations/#hyperlinkedrelatedfield)或编写自定义序列化程序，以实现您需要的功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-07-07T06:26:26.280

如果你想更新嵌套关系，你可以这样做，

```
 class SchoolSerializer(serializers.HyperlinkedModelSerializer):

                students = StudentSerializer(many=True, read_only=True)
                students_ids = serializers.PrimaryKeyRelatedField(many=True,\
                read_only=False, queryset=Student.objects.all(),\ 
                source='students')

                class Meta:
                    model = School
                    fields = ('name', 'image', 'address', 'url',\
                    'students', 'students_ids') 
```

使用 PrimaryKeyRelatedField 这将允许您创建、更新、嵌套关系（多对多字段），只需传递 id 的学生列表即可为您提供嵌套数据，students_ids 可用于写入操作 [![DRF 可浏览 api](https://i.stack.imgur.com/Gs4zA.png)](https://i.stack.imgur.com/Gs4zA.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-09T13:41:08.793

这有点过时了，但对于未来寻找此问题潜在解决方案的人来说，我发现修补视图集很有用。

您不能两次读取帖子参数，这是唯一阻止传递相关更新的主键并在 post_save 中执行 m2m 更新的事情

我制作了一个基于 ModelViewSet 的自定义视图集，其中包含更新的创建和更新语句：

在您的应用程序中，您可以创建一个名为 viewsets.py 的模块：

```
# -*- coding: utf-8 -*-

from rest_framework import mixins
from rest_framework import status
from rest_framework.response import Response
from rest_framework.viewsets import GenericViewSet

class RelatedCreateModelMixin(mixins.CreateModelMixin):

    '''
    Monkey patch the UpdateModel for ModelViewSet Mixin to support data
    transferrance from pre - to - save - to - post
    '''

    def create(self, request, *args, **kwargs):
        data = request.DATA
        serializer = self.get_serializer(data=data, files=request.FILES)

        if serializer.is_valid():
            self.pre_save(serializer.object, data=data)
            self.object = serializer.save(force_insert=True)
            self.post_save(self.object, created=True, data=data)
            headers = self.get_success_headers(serializer.data)
            return Response(serializer.data, status=status.HTTP_201_CREATED,
                            headers=headers)

        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

class RelatedUpdateModelMixin(mixins.UpdateModelMixin):

    def update(self, request, *args, **kwargs):
        partial = kwargs.pop('partial', False)
        self.object = self.get_object_or_none()

        data = request.DATA

        serializer = self.get_serializer(self.object, data=data,
                                         files=request.FILES, partial=partial)

        if not serializer.is_valid():
            return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

        try:
            self.pre_save(serializer.object, data=data)
        except ValidationError as err:
            # full_clean on model instance may be called in pre_save,
            # so we have to handle eventual errors.
            return Response(err.message_dict, status=status.HTTP_400_BAD_REQUEST)

        if self.object is None:
            self.object = serializer.save(force_insert=True)
            self.post_save(self.object, data=data, created=True)
            return Response(serializer.data, status=status.HTTP_201_CREATED)

        self.object = serializer.save(force_update=True)
        self.post_save(self.object, created=False)
        return Response(serializer.data, status=status.HTTP_200_OK)

class RelatedModelViewSet(RelatedCreateModelMixin,
                          mixins.RetrieveModelMixin,
                          RelatedUpdateModelMixin,
                          mixins.DestroyModelMixin,
                          mixins.ListModelMixin,
                          GenericViewSet):
    pass 
```

然后，在您看来，请改用：

```
from MYAPP import viewsets 
```

这使您可以执行以下操作：

```
def post_save(self, obj, *args, **kwargs):
    data = kwargs.get('data')
    model_id = data.get('id')
    parent_obj = Model.objects.get(id=model_id)
    method = self.request.method
    if method == 'POST':
        parent_obj.m2m.add(obj)
    elif method == 'PUT':
        parent_obj.m2m.remove(obj) 
```

不是最优雅的解决方案，但我发现编写自定义序列化程序更可取

# django - Django 异步请求

> ID：16164409
> 
> 赞同：2
> 
> 时间：2013-04-23T08:20:33.780
> 
> 标签：django, asynchronous, celery

Django 是否有类似于 ASP.NET MVC 的[异步控制器](http://msdn.microsoft.com/en-us/library/ee728598%28v=vs.100%29.aspx)的东西？

我有一些请求将由芹菜工人处理，但不会花费很长时间（几秒钟）。我希望客户在工作人员完成后得到响应。我可以让我的视图功能等待任务完成，但我担心它会给网络服务器带来太多负担。

澄清：

这是我今天可以拥有的流程

```
def my_view(request):
    async = my_task.delay(params)
    result = async.get()
    return my_response(result) 
```

`async.get()`可能需要几秒钟——不要太长，以免客户端无法等待 HTTP 响应返回。

此代码可能会给服务器带来不必要的压力。ASP.NET MVC`AsynchronousController`提供的是将这个函数分成两部分的能力，类似于：

```
def my_view(request):
    async = my_task.delay(params)
    return DelayedResponse(async, lambda result=>my_response(result)) 
```

这将释放 Web 服务器以处理其他请求，直到异步操作完成。完成后，它将对结果执行 lambda 表达式，并返回响应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:53:03.500

1.  您可以返回“进行中”状态，而不是等待请求完成，然后再发送一个请求以检查状态是否已更改。由于您正在执行纯查找，因此响应将非常快，并且不会给您的 Web 服务器带来太多负担。

2.  您可以将此特定视图/功能外包给专为异步回调设计的 Tornado Web 服务器。该站点的其余部分可能会继续在 django 上运行。

3.  最有可能的解决方案不应该是技术性的，而是在 UI/UX 领域。如果某件事需要很长时间，如果通知明确，则可以通知用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:32:52.787

是的，只有当任务完成时，您才能做某事。你会想研究一个叫做`chain()`. 您可以在链中绑定 celery 任务：

```
 chain = first_function.s(set) | second_Function.s(do)

    chain() 
```

这两个函数`first_function and second_function`都是 celery 函数。second_function 只有在 first_function 完成执行时才会执行。

# jsf - JSF 中支持 bean 的 POS 支付

> ID：16164411
> 
> 赞同：1
> 
> 时间：2013-04-23T08:20:37.030
> 
> 标签：jsf, payment-processing

我想实现对虚拟 POS 的 POST 调用以进行卡支付处理。POS 只是银行提供的一个服务器程序，必须通过带有交易数据的表格来访问。这可以通过组合一个表单、方法帖子和一组隐藏参数来完成，然后将输出定位到一个新窗口（这是必需的，因为从这一点开始，银行软件会控制）。但是，出于安全问题，我想从支持 bean 进行 POST 调用。因此：

1.  我的 facelet 中的按钮调用 RequestScoped bean 中的方法。这个 bean 可以访问会话中的事务数据。
2.  豆子做了一些东西。
3.  **在**该方法中，我可以打开一个 URLConnection，添加参数，然后调用银行的程序（我假设它是一个 servlet）。
4.  无论这个 servlet 的输出是什么，它都必须重定向到客户端的一个新窗口。这个新窗口将包含身份验证和真实支付的内容，但它是银行的软件。

哪个是使用 JSF 实现该行为的正确模式？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T18:11:05.630

我想我现在明白了，您希望将银行 servlet 功能集成到您的 JSF 应用程序中，但不想为 PCI 合规性而烦恼。

重定向是一个 HTTP 服务器响应代码，它指定执行 GET 的 url，因此您无法重定向表单 POST 的响应。

您也不希望以编程方式将此 POST 请求从服务器端传递给银行 servlet 并呈现收到的响应，因为您已经与银行 servlet 启动了一个单独的会话，而不是用户和您的 Web 应用程序之间存在的会话。这实际上是一个严重的安全问题。

除非服务器正在处理与银行 servlet 的所有 HTTP 通信，否则无法通过 JSF 启动此 Bank Servlet 会话。

在您的场景下我会这样做的方法是使用 Javascript 打开一个带有常规 HTML 表单的新窗口，并将表单的操作设置为银行 servlet URL，并使该表单的初始输入与所需的参数名称匹配对于 HTTP 帖子。提交此 HTML 表单时，SSL 证书将与用户浏览器协商，并且将呈现 POST 响应，而无需您的 Web 应用程序的任何参与。客户端将维护两个单独的会话，即您的应用程序的会话以及 Bank Servlet 的会话。

这是执行此操作的安全方法，不会对您的 Web 应用程序提出任何 PCI 合规性要求。

# iphone - 用于 UIImageView / UIView 时如何调整使用 resizableImageWithCapInsets 创建的 UIImage 的大小

> ID：16164412
> 
> 赞同：1
> 
> 时间：2013-04-23T08:20:38.160
> 
> 标签：iphone, ios, uiview, uiimageview, uiimage

我正在编写代码以使用自定义图像作为`UIView`.

该应用程序仅以纵向运行。在 4" 视网膜屏幕之前，我使用固定大小的手绘 png 作为背景图像（`card.png`如下）。我有这样的代码：

```
UIView* frontView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, self.bounds.size.width, self.bounds.size.height)];
frontView.autoresizingMask = UIViewAutoresizingFlexibleWidth|UIViewAutoresizingFlexibleHeight;

UIImage* cardImage = [UIImage imageNamed:@"card.png"];
UIImageView* im = [[UIImageView alloc] initWithImage:cardImage];
im.autoresizingMask = UIViewAutoresizingFlexibleLeftMargin | UIViewAutoresizingFlexibleRightMargin | UIViewAutoresizingFlexibleBottomMargin;
[frontView addSubview:im];

// frontView has a bunch of stuff added... 
```

如您所料，当我在 iPhone 5 上运行此程序时，所有内容都可以动态调整大小和位置，除了手绘 png `card.png`、. 所以该背景图像没有使用可用的完整高度......

那么（我认为）我想做的事情是这样的......

```
UIImage* cardImage = [[UIImage imageNamed:@"card_resizable.png"] resizableImageWithCapInsets:UIEdgeInsetsMake(72, 0, 60, 0)]; 
```

我已重绘`card.png`为`card_resizable.png`- 它的高度为 140 像素，中间有一个 8 像素的块，我想平铺，所以顶部插图是 72 像素高，底部插图是 60 像素高。

下一步是什么？

我应该创建`UIImageView`具有动态大小的`frontView`？

如何制作可调整大小的图像，调整大小？

我尝试过的几件事......它们都没有导致平铺可调整大小的图像。

干杯，加文

**更新：**

我错误地设置了这些值的像素值，`UIEdgeInsetsMake(72, 0, 60, 0)` 这些值是基于`@2x`图像的。当更改为`UIEdgeInsetsMake(36, 0, 30, 0)`- 我得到正确的垂直调整大小。

正如迈克指出的那样，我需要将大小设置`UIImageView`为父级，并正确设置为`autoresizingMask`：

`im.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;`

我知道`UIImageView`正确地调整大小以填充其父视图- `frontView`（我给它一个绿色背景，以便在 3.5" 屏幕和 4" 屏幕上进行目视检查。

可调整大小的图像`cardImage`也在垂直平面上正确调整大小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:28:23.283

将可拉伸图像传递给 a 后`UIImageView`，您只需将该图像视图的大小调整为所需的任何高度。

在您的情况下，您可能希望通过执行以下操作使图像视图填充其父级：

```
im.frame = frontView.bounds;
im.autoresizingMask =
    UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
[frontView addSubview:im]; 
```

我们`im`填充`frontView`并告诉它在其父级 ( `frontView`) 更改大小时自动增加其宽度/高度。这应该做你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:33:21.023

你能用stretchableImage试试吗

```
UIImage *image = [UIImage imageNamed:@"card_resizable.png"];
UIImage* cardImage = [image stretchableImageWithLeftCapWidth:0.0f 
                                                topCapHeight:70.0f]; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-23T08:22:42.117

看看 UIView contentMode 属性。它应该让您了解 UIImageView 如何在内部呈现图像，无论何时改变它的大小。

# java - MongoDB - 在java中复制集合而不循环所有项目

> ID：16164413
> 
> 赞同：3
> 
> 时间：2013-04-23T08:20:39.830
> 
> 标签：java, mongodb, collections

有没有办法将所有项目集合复制到新集合而不循环所有项目？我找到了一种通过 DBCursor 循环的方法：

```
...
DB db = mongoTemplate.getDb();
DBCursor cursor = db.getCollection("xxx").find();

//loop all items in collection
while (cursor.hasNext()) {
   BasicDBObject b = (BasicDBObject) cursor.next();
   // copy to new collection 
   service.createNewCollection(b);
}
... 
```

你能建议在java中复制而不循环所有项目吗？
（不在 mongo shell 中，使用 java 实现）Tnx。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-05-02T16:24:33.790

在 MongoDB 2.6 中，添加了[$out 聚合运算符](http://docs.mongodb.org/manual/reference/operator/aggregation/out/)，它将聚合结果写入集合。这提供了一种简单的方法，可以使用 Java 驱动程序（我使用 Java 驱动程序版本 2.12.0）将集合中的所有项在服务器端复制到同一数据库中的另一个集合：

```
// set up pipeline
List<DBObject> ops = new ArrayList<DBObject>();
ops.add(new BasicDBObject("$out", "target")); // writes to collection "target"

// run it
MongoClient client = new MongoClient("host");
DBCollection source = client.getDB("db").getCollection("source")
source.aggregate(ops); 
```

单行版本：

```
source.aggregate(Arrays.asList((DBObject)new BasicDBObject("$out", "target"))); 
```

根据文档，对于大型数据集（>100MB），您可能需要使用 allowDiskUse 选项（[聚合内存限制](http://docs.mongodb.org/manual/core/aggregation-pipeline-limits/#memory-restrictions)），尽管我在 >2GB 集合上运行它时没有遇到该限制，因此它可能不适用到这个特定的管道，至少在 2.6.0 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-05T01:41:37.470

我遵循了插入对象数组的建议：[将 MongoDB 集合移动到另一个集合的更好方法](https://stackoverflow.com/questions/18525348/better-way-to-move-mongodb-collection-to-another-collection/20889762#20889762) 这将我的时间从 45 分钟减少到 2 分钟。这是Java代码。

```
 final int OBJECT_BUFFER_SIZE = 2000;
        int rowNumber = 0;
        List<DBObject> objects;
        final int totalRows = cursor.size();
        logger.debug("Mongo query result size: " + totalRows);
            // Loop design based on this:
            // https://stackoverflow.com/questions/18525348/better-way-to-move-mongodb-collection-to-another-collection/20889762#20889762
            // Use multiple threads to improve
            do {
                logger.debug(String.format("Mongo buffer starts row %d - %d copy into %s", rowNumber,
                        (rowNumber + OBJECT_BUFFER_SIZE) - 1, dB2.getStringValue()));
                cursor = db.getCollection(collectionName.getStringValue()).find(qo)
                        .sort(new BasicDBObject("$natural", 1)).skip(rowNumber).limit(OBJECT_BUFFER_SIZE);
                objects = cursor.toArray();
                try {
                    if (objects.size() > 0) {
                        db2.getCollection(collectionName.getStringValue()).insert(objects);
                    }
                } catch (final BSONException e) {
                    logger.warn(String.format(
                            "Mongodb copy %s %s: mongodb error. A row between %d - %d will be skipped.",
                            dB1.getStringValue(), collectionName.getStringValue(), rowNumber, rowNumber
                                    + OBJECT_BUFFER_SIZE));
                    logger.error(e);
                }
                rowNumber = rowNumber + objects.size();
            } while (rowNumber < totalRows); 
```

缓冲区大小似乎很重要。10,000 的大小可以正常工作；但是，出于各种其他原因，我选择了较小的尺寸。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T02:59:08.603

我的想法是从 Java 驱动程序发送[cloneCollection管理命令。](http://docs.mongodb.org/manual/reference/command/cloneCollection/)下面是一个部分示例。

```
DB db = mongo.getDB("admin");
DBObject cmd = new BasicDBObject();
cmd.put("cloneCollection", "users.profiles");//the collection to clone

//add the code here to build the rest of the required fields as JSON string 

CommandResult result = db.command(cmd); 
```

我记得利用驱动程序的[JSON.parse(...)](http://api.mongodb.org/java/2.11.1/com/mongodb/util/JSON.html#parse%28java.lang.String%29) util API 让驱动程序在幕后构建结构。试试这个，因为这更简单。

**注意：**我还没有尝试过，但我相信这会奏效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T09:10:12.627

你可以使用谷歌番石榴来做到这一点。要从迭代器中获取 Set，您可以使用[Sets#NewHashSet(Iterator)](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Sets.html#newHashSet%28java.util.Iterator%29)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-02T14:24:53.203

如果目标集合在同一个数据库中，我认为使用 kellogg.lee 声明的聚合运算符是最好的方法。

为了复制到在不同 mongod 实例上运行的其他数据库中的集合，可以使用以下方法：

第一种方法：

```
List<Document> documentList = sourceCollection.find().into(new ArrayList<Document>);
targetCollection.insertMany(documentList); 
```

但是，如果源集合很大，此方法可能会导致 outOfMemory 错误。

第二种方法：

```
sourceCollection.find().batchSize(1000).forEach((Block<? super Document>) document -> targetCollection.insertOne(document)); 
```

这种方法比第一种方法更安全，因为它不保留整个文档的本地列表，并且可以根据内存要求确定块大小。但是，这可能比第一个慢。

# magento - Magento：如何将未设置的属性显示为空而不是“No”/“N/A”？

> ID：16164414
> 
> 赞同：0
> 
> 时间：2013-04-23T08:20:43.597
> 
> 标签：magento

Magento 在将空属性显示为“否”或“不适用”方面做得很好，但我需要它们显示为空表格单元格。

我知道这段代码完全隐藏了空属性：

```
<?php foreach ($_additional as $_data): ?>
    <?php $_attribute = $_product->getResource()->getAttribute($_data['code']);
    if (!is_null($_product->getData($_attribute->getAttributeCode())) && ((string)$_attribute->getFrontend()->getValue($_product) != '')) { ?>
    <tr>
        <th class="label"><?php echo $this->htmlEscape($this->__($_data['label'])) ?></th>
        <td class="data"><?php echo $_helper->productAttribute($_product, $_data['value'], $_data['code']) ?></td>
    </tr>
    <?php } ?>
<?php endforeach; ?> 
```

来源： http: [//www.magthemes.com/magento-blog/empty-attributes-showing-na-fix/](http://www.magthemes.com/magento-blog/empty-attributes-showing-na-fix/)

但由于我是 php 新手，我真的不知道如何修改它以显示它们为空。

我知道我可以转到核心文件并修改 Attributes.php，但这是一种不好的做法，我想把它做对。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T16:07:16.160

1.  您可以编写一个扩展来重写 Mage_Catalog_Block_Product_View_Attributes::getAdditionalData。但这需要比修改模板更多的知识。

2.  修改模板。您的代码已经完成。只需要少量修改

    ```
    <?php foreach ($_additional as $_data): ?>
    <?php 
        $_attribute = $_product->getResource()->getAttribute($_data['code']);
        $_isEmpty = (!is_null($_product->getData($_attribute->getAttributeCode())) &&((string)$_attribute->getFrontend()->getValue($_product) != ''));
    ?>

        <tr>
            <th class="label"><?php echo $this->htmlEscape($this->__($_data['label'])) ?></th>
            <td class="data"><?php if (!$_isEmpty) { echo $_helper->productAttribute($_product, $_data['value'], $_data['code'])} ?> </td>
        </tr>
    <?php endforeach; ?> 
    ```

PS代码可能包含错误，尚未测试:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-11T10:10:19.240

`ALT`+0160

编辑产品时，使用上述键盘快捷键作为属性值。

如何？

至少在 Windows 上，请执行以下操作：

按住`ALT`键并在键盘上键入数字 0160。现在松开`ALT`钥匙。

基本上会出现一个不是空格字符的空白字符。这将为您的产品字段注册为非空值，并且引擎将呈现字符，幸运的是，对于我们人类来说，这是一个我们不会看到的空格。

它并不优雅，但它会帮助那些无法修改模板代码的人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-26T15:36:09.833

我尝试使用此选项删除“No or N/A”并确定删除此词，但不要删除属性名称。我使用这个代码：

```
 <?php
    $_helper = $this->helper('catalog/output');
    $_product = $this->getProduct()
?>
<?php if($_additional = $this->getAdditionalData()): ?>
<div class="akordeon-item-head">
    <div class="akordeon-item-head-container">
        <div class="akordeon-heading">
            <?php echo $this->__('Additional Information') ?>
        </div>
    </div>
</div>
<div class="akordeon-item-body">
    <div class="akordeon-item-content">
        <table class="data-table" id="product-attribute-specs-table">
            <col width="25%" />
            <col />
            <tbody>
            <?php foreach ($_additional as $_data): ?>
            <?php 
    $_attribute = $_product->getResource()->getAttribute($_data['code']);
    $_isEmpty = (!is_null($_product->getData($_attribute->getAttributeCode())) &&((string)$_attribute->getFrontend()->getValue($_product) != ''));?>
                <tr>
                    <th class="label"><?php echo $this->htmlEscape($this->__($_data['label'])) ?></th>
                    <td class="data"><?php if ($_isEmpty) { echo $_helper->productAttribute($_product, $_data['value'], $_data['code']);} ?>
                </tr>
            <?php endforeach; ?>
            </tbody>
        </table>
        <script type="text/javascript">decorateTable('product-attribute-specs-table')</script>
    </div>
</div>
<?php endif;?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-26T17:05:46.187

我发现这个问题并为我工作

```
<?php foreach ($_additional as $_data): ?>
<?php if ($_data['value'] == 'No') {continue;} ?>
<tr>
    <th class="label"><?php echo $this->htmlEscape($this->__($_data['label'])) ?></th>
    <td class="data"><?php echo $_helper->productAttribute($_product, $_data['value'], $_data['code']) ?></td>
</tr> 
```

# html - HTML textarea：略微扩展的功能

> ID：16164423
> 
> 赞同：0
> 
> 时间：2013-04-23T08:21:19.043
> 
> 标签：html, textarea, styling, rte

在我正在开发的 Web 应用程序中，我需要一个 HTML 文本区域的稍微扩展的功能：我可以让用户单击列表中的项目，以便它们出现在文本区域中，但我希望这些东西成为一个带有其样式的单一样式“对象”在这个文本区域中拥有自己的颜色。

例如，列表包含如下所示的内容：`<--test-->`。在 textarea 中，这需要是可样式化的（颜色、粗体、边框等）。如果用户删除其中的一个字符，整个单词都会被删除，这将是一件好事。

除了功能齐全的 RTE，最好使用什么？一些 JQuery 模拟文本区域会很好。

编辑：至少需要 IE8 支持

# git - 将 git 与 2 台笔记本电脑和多个身份一起使用

> ID：16164429
> 
> 赞同：0
> 
> 时间：2013-04-23T08:21:29.333
> 
> 标签：git, ssh, bitbucket, public-key

我在办公室电脑上开始了一个项目。现在我正在尝试将开发转移到我的家用笔记本电脑上。但是我的家用笔记本电脑已经拥有自己的密钥（用于其他几个项目）。

这个特定的项目在 bitbucket 上。这台计算机上的其他人在汇编和其他几个地方。因此，我考虑尝试为我的办公室密钥创建除 id_rsa （现有集）之外的密钥。

我正是这样做的，但是我的键被调用`bitbucket`而不是`id_rsa`. 所以我创建`config file`了`~/.ssh`这个代码并将其放入其中并带有适当的缩进。我将 Tower 用于 GIT，它给了我错误：

```
Warning: Permanently added 'bitbucket.org,' (RSA) to the list of known hosts.
Permission denied (publickey).
fatal: The remote end hung up unexpectedly 
```

现在我不确定这是否是我所要做的。我错过了一些步骤吗？我该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T09:40:19.873

您是否将新的公钥加载到 bitbucket？[请参阅此处](https://confluence.atlassian.com/pages/viewpage.action?pageId=302811860)的 Bitbucket 知识库中有关此问题的“原因”部分。

# eclipse - 我应该使用哪个版本的 Scala Eclipse 插件？

> ID：16164432
> 
> 赞同：-1
> 
> 时间：2013-04-23T08:21:38.087
> 
> 标签：eclipse, scala, eclipse-indigo, scala-ide

在 Scala 下载页面上，提供了两个版本的 Scala Eclipse 插件，2.10.x 和 2.9.x：

[http://scala-ide.org/download/current.html](http://scala-ide.org/download/current.html)

![在此处输入图像描述](https://i.stack.imgur.com/6YfsN.png)

我应该为 Eclipse Indigo 2.10.x 或 2.9.x 使用哪个版本的 Scala？每个版本有什么区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T09:16:29.403

如果开始一个新项目，只需下载最新的 2.10.x。2.9.x 是为了向后兼容。

我建议我的项目[框架](http://github.com/fractal/skeleton)开始使用 SBT + Eclipse

# github - 统计和分析 Github 组织中的提交（不是 repo）

> ID：16164436
> 
> 赞同：6
> 
> 时间：2013-04-23T08:21:43.663
> 
> 标签：github, plone

我想在[http://github.com/plone](http://github.com/plone)和[http://github.com/collective中计算 2012 年的提交](http://github.com/collective)

是否有任何工具可以做到这一点——为 Github 组织提供统计数据？

我是否需要编写自己的脚本来抓取存储库，单独检查它们并计算提交？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T08:58:40.070

这是我的做法：

*   使用 GitHub API 枚举存储库（有关示例，请参阅[JSON for Plone ）。](https://api.github.com/orgs/plone/repos)循环遍历 JSON 结果和每个：
    *   使用;查看存储库（`git_url`URL）`git clone --bare`只有 git 信息，没有工作副本。这会创建一个`<repository_name>.git>`目录，假设`plone.event.git`您克隆了`git://github.com/plone/plone.event.git`.
    *   `git --git-dir=<git_directory> rev-list HEAD --count`用;计算修订 将计数输出到标准输出，所以`subprocess.check_output()`应该可以很好地完成这项工作。
    *   再次删除`.git`目录

这只需要 2 次 API 调用，因此您可以避免受到速率限制；使用 API 对所有提交进行分页将需要太多请求来计算所有存储库提交，无论如何检查一个裸存储库副本会更快。

# javascript - 在按钮单击事件上取消设置会话变量

> ID：16164437
> 
> 赞同：0
> 
> 时间：2013-04-23T08:21:44.947
> 
> 标签：javascript, php, session, shopping-cart

我无法使用“删除按钮”单击正确取消设置会话变量。我有两个页面：*产品页面*和*购物车页面*，但问题是我的购物车中有一个“删除按钮”无法正常工作。

当我单击“删除按钮”时，它应该运行`unset($_SESSION['product1']`。

但是当我选择另一个项目时，它可以显示“上一个会话项目”，因此这意味着删除按钮无法`unset($_SESSION['product1']`正常运行。我该如何解决这个问题？

**产品页面**

```
session_start();
$id=$_REQUEST['id'];
$_SESSION['pid1']= $_POST['ids']; //Product ID//
$_SESSION['product1'][]=$_POST['product'];

<form method="post">
<input type="hidden" name="product[]" value="<?php echo $row1['product']; ?>" />
<input type="hidden" name="ids" value="<?php echo $id?>" />
</form>

<input type="submit" class="button1" name="addtocart" value="Add To Cart"
/>

</form> 
```

**购物车页面**

```
session_start();
$pid=$_SESSION['pid1'];   

function remove_product($pid){
$pid=intval($pid);
$max=count($_SESSION['product1']);
for($i=0;$i<$max;$i++){
if($pid==$_SESSION['product1'][$i]['pid']){
unset($_SESSION['product1'][$i]);
break;
}
}
$_SESSION['product1']=array_values($_SESSION['product1']);
}

if($_REQUEST['command']=='delete' && $_REQUEST['pid']>0){
remove_product($_SESSION['product1'][$pid]);
}

<form  name="form1" method="post">  
<input type="hidden" name="pid" />
<input type="hidden" name="command" />  

<input type="button" class="button2" value="Remove" 
onclick="javascript:del(<?php echo $pid?>)"/> 
```

**购物车页面 Javascript**

```
<script language="javascript">
function del(pid){
if(confirm('Do you really mean to delete this item')){
document.form1.pid.value=pid;
document.form1.command.value='delete';
document.form1.submit();
}
}

function clear_cart(){
if(confirm('This will empty your shopping cart, continue?')){
document.form1.command.value='clear';
document.form1.submit();
}
}
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:56:06.703

这可能是由于

1.  `$pid=$_SESSION['pid1'];`代替`$pid=$_POST['pid1'];`

2.  与包裹在按钮周围的标签相关的事件，您可以使用

`<input type="button" class="button2" value="Remove" onclick="del('<?php echo $pid?>');"/>`

# magento - 如何在magento中将发票pdf徽标显示为全尺寸？

> ID：16164439
> 
> 赞同：0
> 
> 时间：2013-04-23T08:22:01.537
> 
> 标签：magento, pdf-generation

我有尺寸为 961*210 的图像。我需要在徽标区域顶部的整页（如横幅图像）的发票 pdf 生成中显示此图像。

我需要为函数中的参数（x1，y1，x2，y2）设置什么值`insertLogo()`？

```
 $page->drawImage($image, x1, y1, x2, y2); 
```

我尝试了多个值，但我无法弄清楚。请帮我？。我需要整页图像的精确坐标（如横幅图像）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T09:37:27.343

啊 Zend_Pdf 的乐趣。drawImage() 方法的参数如下：

*   $image = 使用创建的图像

    $image = Zend_Pdf_Image::imageWithPath($path);

其中 path 是文件系统上所需图像的路径

*   $x1 = 从页面左侧到图像左侧的距离
*   $y1 = 从页面底部到图像底部的距离
*   $x2 = 页面左侧到图片右侧的距离
*   $y2 = 从页面底部到图像顶部的距离

不幸的是，使用 PDF 是一个非常手动的过程，您将不得不尝试不同的值，直到正确为止。还要记住打印边距，您需要为此留出一点空间。

# macvim - 启动时最大化 MacVim 中的窗口

> ID：16164440
> 
> 赞同：7
> 
> 时间：2013-04-23T08:22:01.693
> 
> 标签：macvim

如何将 MacVim 设置为以扩展整个高度（减去菜单栏）和宽度（不是全视图）的窗口启动？

如果这在启动时不可能，我该如何手动更改它（不是通过拖动窗口，而是通过命令）？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-24T04:24:53.300

# c - 使用 C 语言转换从 1970 年 1 月 1 日到现在的秒数

> ID：16164442
> 
> 赞同：1
> 
> 时间：2013-04-23T08:22:15.513
> 
> 标签：c

将秒转换为日期的 C 程序。我有以下 C 程序代码。

```
#include <sys/types.h>
#include <sys/stat.h>
#include <stdio.h>

#ifdef HAVE_ST_BIRTHTIME
#  define birthtime(x) (x).st_birthtime
#else
#  define birthtime(x) (x).st_ctime
#endif

int main(int argc, char *argv[])
{
    struct stat st;
    size_t i;

    for( i=1; i<argc; i++ )
    {
        if( stat(argv[i], &st) != 0 )
            perror(argv[i]);
        printf("%i\n", birthtime(st));
    }

    return 0;
} 
```

它以秒为单位返回从 1970 年 1 月 1 日到文件创建日期的时间。如何仅使用 C 语言将秒转换为创建日期？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T09:43:32.677

用于将自纪元以来的秒数转换为故障时间的标准 C 函数是`localtime()`或`gmtime()`，具体取决于您的需要。然后，您可以使用`asctime()`将分解时间转换为字符串。不要忘记`#include <time.h>`阅读相应的手册页。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T09:46:23.373

以下是我使用的一些功能：

```
typedef int64_t timestamp_t;

timestamp_t currentTimestamp( void )
{
  struct timeval tv;
  struct timezone tz;
  timestamp_t timestamp = 0;
  struct tm when;
  timestamp_t localeOffset = 0;

  { // add localtime to UTC
    localtime_r ( (time_t*)&timestamp, &when);
    localeOffset = when.tm_gmtoff * 1000;
  }

  gettimeofday (&tv, &tz );
  timestamp = ((timestamp_t)((tv.tv_sec) * 1000) ) + ( (timestamp_t)((tv.tv_usec) / 1000) );

  timestamp+=localeOffset;

  return timestamp;
}

/* ----------------------------------------------------------------------------- */

int32_t timestampToStructtm ( timestamp_t timestamp, struct tm* dateStruct)
{
  timestamp /= 1000; // required timestamp in seconds!
  //localtime_r ( &timestamp, dateStruct);
  gmtime_r ( &timestamp, dateStruct);

  return 0;
}

/* ----------------------------------------------------------------------------- */

int32_t sprintf_timestampAsYYYYMMDDHHMMSS ( char* buf, timestamp_t timestamp )
{
  int year = 0;
  int month = 0;
  int day = 0;
  int hour = 0;
  int minute = 0;
  int second = 0;
  struct tm timeStruct;

  if (timestamp==TIMESTAMP_NULL) {
    return sprintf(buf, "NULL_TIMESTAMP");
  }

  memset (&timeStruct, 0, sizeof (struct tm));
  timestampToStructtm(timestamp, &timeStruct);

  year = timeStruct.tm_year + 1900;
  month = timeStruct.tm_mon + 1;
  day = timeStruct.tm_mday;
  hour = timeStruct.tm_hour;
  minute = timeStruct.tm_min;
  second = timeStruct.tm_sec;

  return sprintf(buf, "%04d%02d%02d%02d%02d%02d", year, month, day, hour, minute, second);
} 
```

# knockout.js - 淘汰赛可见绑定没有得到重新评估

> ID：16164444
> 
> 赞同：0
> 
> 时间：2013-04-23T08:22:17.587
> 
> 标签：knockout.js, knockout-2.0

我对淘汰赛可见绑定有点困惑。我创建了一个示例来演示该问题。主要目标是在用户选择“其他”选项时显示一些 div (otherDetails)。它不工作。更改“mySelection”字段时，不会重新评估可见的。

```
<!DOCTYPE html> 
<html> 
<head> 
    <meta charset="utf-8" /> 
    <meta name="viewport" content="width=device-width" /> 
    <title>Test</title> 

    <script src="Scripts/jquery-1.8.2.min.js" type="text/javascript"></script> 
    <script src="Scripts/knockout-2.2.0.js" type="text/javascript"></script> 

    <script type="text/javascript"> 

    function data() 
    { 
            this.mySelection =  ko.observable('other'); 

            this.isOtherSelected = ko.computed(function () 
            { 
                    return this.mySelection.peek() == 'other'; 
            }, this); 
    } 

    var myData = new data(); 

    $(document).ready(function () 
    { 
             $('#selections').change(function () 
             { 
                 myData.mySelection = $(this).val();         
             }); 

            dataBind(); 
    }); 

    function dataBind() 
    { 
            ko.applyBindings(myData); 
    } 
    </script> 
</head> 

<body> 
        <div> 
                <select id="selections" data-bind="value: mySelection"> 
                    <option value='one'>One</option> 
                    <option value='two'>Two</option> 
                    <option value='three'>Three</option> 
                    <option value='other'>Other</option> 
                </select> 
        </div> 
        <div id="otherDetails" data-bind="visible: isOtherSelected"> 
            <span>Some controls and stuff...</span> 
        </div> 
</body> 
```

在此先感谢，亚龙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:36:41.587

您应该以不同的方式使用 observables。每个 observable 都是一个函数，因此要获得价值，您必须调用它：

```
return this.mySelection() == 'other'; 
```

如果你想给它赋值，你应该将值传递给这个函数：

```
myData.mySelection($(this).val()); 
```

这是工作小提琴：http: [//jsfiddle.net/kkGRs/](http://jsfiddle.net/kkGRs/)

PS 你不需要在那里使用 jQuery 更改处理程序。KO 会自动更新 observable 的值。这是重构代码：http: [//jsfiddle.net/kkGRs/1/](http://jsfiddle.net/kkGRs/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:25:04.037

只需删除`peek()`：
`return this.mySelection() == 'other';`

peek 函数获取 observable 的值，但不订阅外部计算的 observable 更改。因此，您的绑定不会被重新评估。

# c# - 如何使全局对象线程安全

> ID：16164445
> 
> 赞同：3
> 
> 时间：2013-04-23T08:22:23.743
> 
> 标签：c#, winforms, task-parallel-library, async-await

总而言之，我最近使用多线程的大型应用程序存在并发问题。问题出在可以运行批处理作业的脚本处理器中

```
public async Task<Result> ProcessScriptAsync(
    CancellationTokenSource cancelSource,
    TaskScheduler uiScheduler)
{
    ...
    // Get instance of active workbook on UI thread.
    IWorkbook workbook = this.workbookView.ActiveWorkbook;
    while (notFinished)
    {
        ...
        Task<bool> runScriptAsyncTask = null;
        runScriptAsyncTask = Task.Factory.StartNew<bool>(() =>
        {
            return RunScript(ref workbook);
        }, this.token,
           TaskCreationOptions.LongRunning,
           TaskScheduler.Default);
        // Some cancellation support here...

        // Run core asynchroniously.
        try
        {
            bGenerationSuccess = await runScriptAsyncTask;
        }
        catch (OperationCanceledException)
        {
            // Handle cancellation.
        }
        finally 
        {
            // Clean up.
        }
    }
...
} 
```

当您考虑该`RunScript`方法时，我的问题就来了。传入的对象`RunScript`不是线程安全的，而是在 UI 线程上创建的。因此，我必须在`RunScript`方法内创建该对象的“深层副本”......

```
private bool RunScript(ref IWorkbook workbook)
{
    ...
    // Get a new 'shadow' workbook with which to operate on from a background thread.
    IWorkbook shadowWorkbook;
    if (File.Exists(workbook.FullName)) 
    {
        // This opens a workbook from disk. The Factory.GetWorkbook method is thread safe.
        shadowWorkbook = SpreadsheetGear.Factory.GetWorkbook(workbook.FullName); // (##)
    }
    else
        throw new FileNotFoundException(
            "The current workbook is not saved to disk. This is a requirement. " + 
            "To facilitate multi-threading!");

    // Do hard work here...
    shadowWorkbook.WorkbookSet.GetLock();
    try
    {
        // Do work and add worksheets to shadowWorkbook.
    }
    finally
    {
        // Reassign the UI workbook object to our new shadowWorkbook which 
        // has been worked on. This is fine to do as not work is actually being 
        // done on workbook.
        workbook = shadowWorkbook;
        shadowWorkbook.WorkbookSet.ReleaseLock();
    }
} 
```

我的问题在 (##) 标记的行上。每次执行都是从磁盘`RunScript`创建一个新的。`shadowWorkbook`这样做的问题是在其中创建了一些工作表，随后在处理结束时将`shadowWorkbook`其复制回。`workbook`但是，每次执行时，`RunScript`我都会从磁盘中获取工作簿，该工作簿没有在最后一个循环中生成的新工作表。

我已经研究过制作`shadowWorkbook`一个全局对象，但它是在 UI 线程上创建的，因此随后无法从我的后台操作中使用。解决此问题的一种方法是在每个工作表创建后将工作簿保存到磁盘，但是有很多创建，这将是昂贵的。

**有没有办法使`shadowWorkbook`全局*和*线程安全，使我能够持久更改`IWorkbook`跨线程调用？**

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:34:58.493

嗯，我想说`this.workbookView.ActiveWorkbook`在这种情况下，可变资源需要是线程安全的。您所说的工作簿对象是在 UI 线程上创建的，因此当您分配时，您将在那里和任务线程中争用它`workbook = shadowWorkbook`。

也许声明一个同步对象，例如：

```
private static Object _objectLock = new Object(); 
```

并在您的 RunScript 方法（以及修改工作簿的其他任何地方）中使用这样的方法，以确保从不同线程对资源的串行访问：

```
lock(_objectLock)
{
    workbook.AddWorkSheet();
} 
```

在这种情况下，您不需要深度复制您的工作簿，因此消除了昂贵的调用及其产生的所有额外复杂性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T14:00:47.257

如果我理解正确，您应该为每个`workbook`创建一个`Thread`. 在此之上`Thread`，创建您的`shadowWorkbook`，然后运行一个循环来处理对该工作簿的请求，使用类似`BlockingCollection<Action<IWorkbook>>`.

您可以通过编写类似的东西来使用它

```
workbookManager.Run(workbook, w => /* do work and add worksheets to w */); 
```

# php - 如何使用 phpDocumentor、教程/扩展文档编写代码块？

> ID：16164453
> 
> 赞同：15
> 
> 时间：2013-04-23T08:22:53.080
> 
> 标签：php, external, phpdoc

如何在编写教程/扩展文档时使用 phpDocumentor 编写代码块？

我试过`<programlisting>`了，它可以生成`<code>`标签，但它不解析它的内容。

```
<refentry id="{@id}">  

 <refnamediv>  
  <refname>Guide for MyApp</refname>  
  <refpurpose>To demonstrate ...</refpurpose>  
 </refnamediv>  

 <refsynopsisdiv>  
  <author>  
   My Name
   <authorblurb>  
    {@link mail@mail.com My Name}  
   </authorblurb>  
  </author>  
 </refsynopsisdiv>  

 {@toc}  
 <refsect1 id="{@id intro}">  
  <title>User Guide for MyApp</title>  

  <para>  
   Some Description
  </para>

      <programlisting>

            $some = 'code';

      </programlisting>

 </refsect1>
</refentry> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-01T06:43:19.103

我检查了它，我认为您可以使用 javascriptMVC 文档工具。我认为[文档工具](http://www.javascriptmvc.com/docs.html#!DocumentJS)。
它的演示在[这里](http://www.javascriptmvc.com/docs.html#!jQuery.Controller)。我建议你试试这个。（-：

这是 javascriptMVC 的 documentJs 的输出，这是 /i 认为你想要的东西。或者至少我希望。（-： ![在此处输入图像描述](https://i.stack.imgur.com/bC9xP.jpg)

* * *

* * *

和关于 phpDocumentor 正如我所说的，我需要一些解释来理解你的意思，但现在请检查这些。[链接1](http://www.phpdoc.org/docs/latest/for-users/phpdoc/tags/source.html)。 [链接2](http://www.phpdoc.org/docs/latest/for-users/introduction/definitions.html#term-doccomment)。（如果以下是您想要的东西）。

```
 /** @type int This is a counter. */
 $int = 0;

 // there should be no docblock here
 $int++; 
```

或者：

```
 /**
  * This class acts as an example on where to position a DocBlock.
  */
 class Foo
 {
     /** @type string|null Should contain a description if available */
     protected $description = null;

     /**
      * This method sets a description.
      *
      * @param string $description A text with a maximum of 80 characters.
      *
      * @return void
      */
     public function setDescription($description)
     {
         // there should be no docblock here
         $this->description = $description;
     }
 } 
```

另一个例子是在 foreach 中显式地记录变量；许多 IDE 使用此信息来帮助您自动完成：

```
 /** @type \Sqlite3 $sqlite */
 foreach($connections as $sqlite) {
     // there should be no docblock here
     $sqlite->open('/my/database/path');
     <...>
 } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-28T22:16:36.140

一旦你知道如何，这实际上很容易。您只需要在元素上设置`role`属性。`programlisting`

```
<programlisting role="php">
  $some = 'code';
</programlisting> 
```

[除了发布说明](http://sourceforge.net/project/shownotes.php?release_id=163614)中的简短提及外，我在任何地方都找不到此文档，但是从查看代码来看，似乎支持四个角色：

1.  **php** - 将 PHP 语法高亮添加到内容中，并在每一行包含一个行号。
2.  **教程**- 将 HTML 语法高亮添加到内容中，并在每一行包含一个行号。
3.  **xml** - 在内容周围添加`pre`标签，但没有语法高亮，也没有行号。
4.  **html** - 将内容视为原始 HTML，因此您可以使用任何您喜欢的标记。

但是，任何时候您想使用尖括号，都需要转义这些字符或将内容包装在 CDATA 部分中。这甚至适用于您想要使用原始 HTML 的情况。如果不是，解析器将尝试将内容解释为 XML。

例如，原始 HTML 示例看起来像这样：

```
<programlisting role="html">
  <![CDATA[
    <b>This sentence will be bold.</b>
  ]]>
</programlisting> 
```

另请注意，所有这些都适用于*phpDocumentor*的初始版本。据我所知，新版本（*phpDocumentor 2*）似乎不支持教程/扩展文档。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-05-02T05:47:26.257

您可以使用 zend studio 工具，它可以自动生成选定的项目文档

# css - 使用css隐藏超链接行

> ID：16164456
> 
> 赞同：4
> 
> 时间：2013-04-23T08:22:56.857
> 
> 标签：css, hyperlink, hover, text-styling

我有这个 HTML 代码

```
<a href="test.html">
<div class=" menubox mcolor1">
<h3>go to test page</h3>
</div>
</a> 
```

这是CSS

```
.menubox {
    height: 150px;
    width: 100%;
    font-size: 14px;
    color: #777;
    margin: 0 0 0 0;
    padding: 0; 
    -moz-border-radius: 10px;
    border-radius: 10px; 
    position: relative;}

.mcolor1 { background: #3A89BF url(../images/prod2.png) no-repeat center center; } 
```

鼠标悬停在这个 div 上，文本显示超链接行，我该如何隐藏它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-23T08:45:26.887

正如其他人所建议的那样，从链接中删除下划线很容易。但是，如果您只需要针对此特定链接，请尝试给它一个类。例子：

```
.no-underline:hover {
    text-decoration: none;
}
```

```
<a href="test.html" class="no-underline">
  <div class=" menubox mcolor1">
    <h3>go to test page</h3>
  </div>
</a>
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T08:27:03.690

如果要删除悬停时的下划线，请使用以下 CSS：

```
a:hover {
   text-decoration: none;
} 
```

* * *

### 笔记 ：

除非您的页面使用 HTML5 doctype ( `<!doctype html>`)，否则您的 HTML 结构无效。Div不能嵌套`a`在 HMTL5 之前的元素内。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T08:27:32.190

就目前的 HTML 而言，您不能*仅*针对该链接隐藏链接下划线。

以下 CSS 将删除所有链接的下划线：

```
a:hover {
    text-decoration: none;
} 
```

要仅为此链接删除它，您可以将链接移动到`<div>`：

```
.menubox > a {
    display: block;
    height: 100%;
}

.menubox > a:hover {
    text-decoration: none;
}
```

```
<div class="menubox mcolor1">
    <a href="test.html">
        <h3>go to test page</h3>
    </a>
</div>
```

# java - “SOAPAction：”和“SOAPAction”HTTP 请求属性之间的区别

> ID：16164463
> 
> 赞同：0
> 
> 时间：2013-04-23T08:23:06.497
> 
> 标签：java, web-services, soap

我正在检查如何在不使用 jax-ws 之类的库的情况下执行 SOAP 调用，而只需使用普通的 HttpURLConnection。在阅读我在某些地方找到的文档时

> conn.setRequestProperty("SOAPAction", soapAction);

而在其他地方

> conn.setRequestProperty("SOAPAction:", soapAction);

但是我找不到这两个标题之间的区别。好吧，我发现了一个，当使用“SOAPAction：”时，如果动作拼写错误，“：”就像动作名称的一部分。

有人知道区别吗？还是“SOAPAction：”完全错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T11:16:12.747

`SOAPAction:`是错的。HTTP 添加冒号。实际上，标题名称中不允许使用冒号。

# ios - UILabel 最小字体大小阴影问题

> ID：16164466
> 
> 赞同：11
> 
> 时间：2013-04-23T08:23:25.763
> 
> 标签：ios, objective-c, layout, uilabel, font-size

在我的`UILabels`. 如您所见，阴影没有跟随字体大小。它应该只有 1 px 高。

**我的标签：**

![UILabel 设置模拟器](https://i.stack.imgur.com/sZDbo.png)

**我的设置：**

![UITableViewCell IB](https://i.stack.imgur.com/NrsWv.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-05-17T10:37:41.007

关闭“收紧字母间距”。

阴影、自动收缩和自动收紧似乎存在错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:41:47.110

`shadow.offset`根据字体大小以编程方式设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:44:35.607

您已将值 12 设置为低于最小字体大小，您无法将此值设置为太大，将其设置为 0.5 或 0.8 之类的东西。

其次，您的垂直阴影偏移量为 1，因此没有机会获得那么多阴影。您可能已经通过代码传递了阴影，请先检查它。

当您在 xib 文件中检查它时，如果它没有改变，那么只需重新打开窗口就可以了。

希望这会有所帮助。

# android - 如何在 Android 中显示输入文本视图

> ID：16164469
> 
> 赞同：-4
> 
> 时间：2013-04-23T08:23:43.703
> 
> 标签：android, textview

在此屏幕截图中：

![在此处输入图像描述](https://i.stack.imgur.com/r23eW.png)

我正在寻找使 UI 更体面的解决方案。我喜欢输入框的蓝线，但它只显示用户名或密码。让 2 条蓝线按顺序出现在用户名和密码下方的最简单方法是什么？

干杯

这是我到目前为止尝试过的

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/myBackground"
    tools:context=".MainActivity" >

    <ImageView
            android:id="@+id/imageView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:layout_marginTop="20dp"
            android:src="@drawable/voicemeno" />

        <TextView
            android:id="@+id/userName"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:layout_marginTop="40dp"
            android:layout_below="@+id/imageView1"
            android:text="User Name"
            android:textAppearance="?android:attr/textAppearanceMedium"
            android:textColor="@color/myText" />

        <EditText
            android:id="@+id/userNameInput"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:layout_marginTop="5dp"
            android:layout_below="@+id/userName"
            android:ems="10"
            android:inputType="textPersonName"
            android:textColor="@color/myText"
            android:textCursorDrawable="@null" >
        </EditText>

        <TextView
            android:id="@+id/password"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:layout_marginTop="40dp"
            android:layout_below="@+id/userNameInput"
            android:text="Password"
            android:textAppearance="?android:attr/textAppearanceMedium"
            android:textColor="@color/myText" />

        <EditText
            android:id="@+id/passwordInput"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:layout_marginTop="5dp"
            android:layout_below="@+id/password"
            android:ems="10"
            android:inputType="textPassword"
            android:textColor="@color/myText"
            android:textCursorDrawable="@null" >
        </EditText>
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:43:06.943

**编辑：**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:tools="http://schemas.android.com/tools"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:background="@color/myBackground"
        tools:context=".MainActivity" 
        android:selectAllOnFocus="true">

        <ImageView
                android:id="@+id/imageView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_centerHorizontal="true"
                android:layout_marginTop="20dp"
                android:src="@drawable/voicemeno" />

            <TextView
                android:id="@+id/userName"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_centerHorizontal="true"
                android:layout_marginTop="40dp"
                android:layout_below="@+id/imageView1"
                android:text="User Name"
                android:textAppearance="?android:attr/textAppearanceMedium"
                android:textColor="@color/myText" />

            <EditText
                android:id="@+id/userNameInput"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_centerHorizontal="true"
                android:layout_marginTop="5dp"
                android:layout_below="@+id/userName"
                android:ems="10"
                android:inputType="textPersonName"
                android:textColor="@color/myText"
                android:textCursorDrawable="@null" >
            </EditText>

            <TextView
                android:id="@+id/password"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_centerHorizontal="true"
                android:layout_marginTop="40dp"
                android:layout_below="@+id/userNameInput"
                android:text="Password"
                android:textAppearance="?android:attr/textAppearanceMedium"
                android:textColor="@color/myText" />

            <EditText
                android:id="@+id/passwordInput"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_centerHorizontal="true"
                android:layout_marginTop="5dp"
                android:layout_below="@+id/password"
                android:ems="10"
                android:inputType="textPassword"
                android:textColor="@color/myText"
                android:textCursorDrawable="@null" >
            </EditText>
    </RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-17T09:54:54.387

您可以为所需的每个字段（用户名，密码）使用 TextView 后跟 EditText 视图。

# selenium-rc - 如何使用 Selenium RC 提高测试稳定性

> ID：16164474
> 
> 赞同：0
> 
> 时间：2013-04-23T08:24:00.237
> 
> 标签：selenium-rc, wait

我正在使用 seleniun RC 进行自动化测试脚本。我用

```
selenium.waitForPageToLoad(DEFAULT_TIMEOUT); 
```

但它并不稳定，50% 的情况下我的测试失败，因为等待后的下一个元素没有找到。例如：

```
selenium.open("some_url");
selenium.waitForPageToLoad(DEFAULT_TIMEOUT);
selenium.click("id=first"); 
```

`DEFAULT_TIMEOUT`设置为 50000。

有人可以解释 waitForPageToLoad 是如何工作的吗？我可以使用什么替代方法来提高测试稳定性？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T12:57:53.197

通常您可能会遇到动态内容（Ajax 调用、更新等）的此类问题。这意味着该页面已加载，但尚未从服务器接收某些部分。

最好的方法（就像我一直做的那样）是检查元素的存在：

如果（硒。isElementPresent（））

selenium.click()

这种方法应该会有所帮助。

或者您可以使用 waitForElementPresent()。如果它不可用 - 开发你自己的：

而（！selenium.isElementPresent（））

线程.sleep(1000)

# ruby-on-rails - 与多个 URL 匹配时如何在正则表达式中使用变量？

> ID：16164476
> 
> 赞同：0
> 
> 时间：2013-04-23T08:24:14.487
> 
> 标签：ruby-on-rails, ruby, regex

我正在删除我的应用程序中特定用户的多个缓存 URL。我将 user_id 存储在所有 URL 中，因此当特定用户注销时。需要为特定用户清除缓存。我使用了以下内容，但它没有不行。

```
cache_store.delete_matched('*id=#{current_user.id}*') 
```

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T09:17:35.617

您需要使用双引号进行字符串插值：

```
cache_store.delete_matched("*id=#{current_user.id}*") 
```

# scala - 如何将动作的主体作为字符串

> ID：16164478
> 
> 赞同：0
> 
> 时间：2013-04-23T08:24:18.763
> 
> 标签：scala, playframework-2.1

我有两个动作。第一个服务于单一资产，第二个应该服务于所有单一资产组合成一个资产。所以我的想法是从服务于组合资产的第二个动作中调用为单个资产提供服务的第一个动作。你们中的一些人会说这是一个坏主意，因为我可以直接从文件系统加载资产并将它们组合起来。但这是不可能的，因为第一个操作与其他操作链接在一起以对资产执行一些额外的操作（指纹识别，...）。

**所以这是我的行动：**

第一个服务于单一资产。在这个实现中，它只调用链中的下一个动作。

```
abstract override def at(path: String, file: String): Action[AnyContent] = {
  super.at(path, file)
} 
```

第二个接受 JSON 格式的文件列表。然后它遍历列表并使用单个文件调用第一个操作。

```
def consolidate = Action(parse.json) { request =>
  val files = request.body.as[List[String]]
  for (file <- files) {
    val action = at(path, new URL(file).getPath.substring(1))
    val result = action.apply(request)
  }
  Ok()
} 
```

现在我的问题是，我怎样才能将资产作为字符串？变量 result 包含一个`Iteratee[Array[Byte], Result]`. 如何从中提取资产数据？

play.api.test.Helper*对象*包含一个*contentAsString*和一个*contentAsBytes*方法。但这对我没有进一步的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:34:43.747

`Iteratee`代表行动的消费者方面。没有返回该方法的文档，`Iteratee`但我猜测它将用于在请求期间使用来自客户端的数据输入流。所以，简而言之，它在这里对你没有帮助。

您可以从第一个操作中获取代码，您需要调用该操作`consolidate`并将其分解到某个方法中，并在两个操作中使用该方法。这对你可行吗？

# sencha-touch-2 - ST2.2 - 带有选择器配置的日期选择器错误

> ID：16164480
> 
> 赞同：0
> 
> 时间：2013-04-23T08:24:25.330
> 
> 标签：sencha-touch-2

我正在使用最新的 sencha touch 版本，但发现日期选择器有问题。

这按预期工作：

```
var view=new Ext.field.DatePicker({label:"Test"}); 
```

但如果我这样做：

```
 var view = new Ext.field.DatePicker({
    label: "Test",
    picker: {
        yearTo: "2020"
    }
}); 
```

如果我单击日期选择器字段，则不会发生任何事情。一段时间后，该网站甚至“崩溃”。

我正在使用 Chrome 26.0.1410.64 m 进行测试。

ST 2.2 中可能存在错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T12:52:20.573

使用`new`关键字不是在 Sencha Touch 2.x 中创建组件的正确方法

使用`Ext.create`：

```
var view = Ext.create('Ext.field.DatePicker', {
    label: "Test",
    picker: {
        yearTo: 2020 // without the quotes
    }
}); 
```

希望这可以帮助

# ruby-on-rails - Ruby on Rails - 分页注释

> ID：16164483
> 
> 赞同：0
> 
> 时间：2013-04-23T08:24:44.007
> 
> 标签：ruby-on-rails, comments

我创建了一个应用程序，用户可以在其中创建项目并对这些项目发表评论。现在，我可以让用户在每个项目页面上发表评论。

问题：根据我下面的代码，我可以使用 will_paginate 吗？我确实安装了 gem，所以，如果是这样，我将如何将它集成到下面的代码中？如果没有，我需要做什么来建立分页？

评论.rb

```
class Comment < ActiveRecord::Base
  attr_accessible :content, :project_id, :user_id
  validates :content, presence: true

  belongs_to :project
  belongs_to :user

  scope :newest, order("created_at desc")
end 
```

评论控制器.rb

```
class CommentsController < ApplicationController
  before_filter :authenticate_user! 

  def create
    project = Project.find(params[:project_id])
    @comment = project.comments.create!(params[:comment])
    redirect_to project_path(project)
  end
end 
```

项目/show.html.erb

```
 <!-- Add Comments -->

          <% if signed_in? %>
            <p class="comment_header">Add Comment:</p>

            <span class="comment">
                <%= form_for([@project, @project.comments.build]) do |f| %>
                  <div class="field">
                    <%= f.text_area :content, :class => "span7", :rows => "3" %>
                  </div>

                  <%= f.hidden_field :user_id, :value => current_user.id %>

                  <div class="actions">
                    <%= f.submit "Add Comment", :class => "btn btn-header" %>
                  </div>
                <% end %>
            </span>

          <% else %>

            <p class="comment_header"><%= link_to 'Sign in', new_user_session_path %> to post comments.</p> 

          <% end %>

          <!-- Show Comments -->
          <p class="comment_header">Comments:</p>

          <% if @project.comments.blank? %>     
            <p>No comments made yet for this project.</p>        
          <% else %>        
            <% @project.comments.newest.each do |comment| %>   
              <div class="comments">        
                <p><%= comment.content %></p>
                <span>By <%= link_to comment.user.name, comment.user %> <%= time_ago_in_words(comment.created_at) %> ago</span>
              </div>
            <% end %>       
          <% end %>
          <!-- end of comments section --> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:30:09.527

是的，您可以使用 will_paginate gem。此 gem 仅用于获取具有页码的行数，您可以指定每页的元素数。例如第 1 页将为您提供元素 1 到 30 第 2 页 31 到 60 .... 在您必须实现视图之后

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:31:17.577

您可以毫无问题地使用 will_paginate。你也可以看看更灵活的[kaminari 。](https://github.com/amatsuda/kaminari)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:48:56.060

您没有`will_paginate`正确实施。（[您可以在此处的文档中阅读有关正确实施的信息。](https://github.com/mislav/will_paginate/wiki)）

简而言之，您需要`@comments = @project.comments.paginate(page: params[:page])`在控制器中使用类似的东西来执行索引操作，然后遍历`@comments`. 然后做`will_paginate @comments`应该正常工作。

您不能只`will_paginate @user.comments.newest`在视图中执行查询 ( )，因为该`paginate`方法返回一个处理分页的特殊对象，这与普通的 ActiveRecord 查询不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T08:47:13.023

您可以在重定向之前调用分页方法

在你的控制器中

```
 @comments = @project.comments.pagenate(page: params[:page]||1,per_page: 20) 
```

并将以下内容添加到您的模板中

```
 <%= will_paginate @comments %> 
```

# php - PHP通过发布表单上传图像

> ID：16164485
> 
> 赞同：-3
> 
> 时间：2013-04-23T08:24:47.037
> 
> 标签：php

我正在尝试通过以下代码上传图片。尽管我的 if 条件正在执行，如下所示，但图像没有移动到我给出的指定路径。我的代码如下。这是我的html代码

```
<form enctype="multipart/form-data" action="catcher.php" method="POST">
Send this file: <input name="userfile" type="file" />
    <input type="submit" value="Send File" />
</form> 
```

这是我的php代码

```
<?php
$uploaddir = '/xampp/project/';
echo '<pre>';
if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploaddir)) {
    echo "File is valid, and was successfully uploaded.\n";
} else {
    echo "Possible file upload attack!\n";
}

echo 'Here is some more debugging info:';
print_r($_FILES);

print "</pre>";

?> 
```

任何人都可以指出我的代码有什么问题吗？我的意思是为什么我要上传的图像没有移动到指定的路径，，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:28:55.213

[`move_uploaded_file()`](http://php.net/manual/en/function.move-uploaded-file.php)要求第二个参数是目标文件，而不是目录。

你可以这样做：

```
$filename = $uploaddir . basename($_FILES['userfile']['tmp_name']);

if( move_uploaded_file($_FILES['userfile']['tmp_name'], $filename)){
// ... 
```

但是很有可能多个用户会尝试上传同名文件，所以我强烈建议处理这种可能性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:38:38.070

```
 $folder =  "../images/stories/";
$result =   move_uploaded_file($_FILES['excel']['tmp_name'], $folder.$filename); 
```

给出目标文件夹名称。（在上面的代码中，$folder 是目标路径变量）您可以查看此函数的详细信息：

```
function upload($name,$tmp_name){   

$fileextarr=explode('.',$name);
$fileextarr[0];
$fileext=$fileextarr[count($fileextarr)-1];
$fpath = "../images/stories/lab_excel/";
$filename = ereg_replace(" ","_",$fileextarr[0]).'.'.$fileext;

//You can use restriction on file extensions also. (not necessary)

if($fileext=="xls" || $fileext=="xlsx" || $fileext=="doc"|| $fileext=="docx" || $fileext=="jpeg" || $fileext=="png" || $fileext=="gif" || $fileext=="tiff" || $fileext=="bmp" || $fileext=="jpg")
{
    $uploadedfile = $filename;

}

//Here is the use of destination path:

 $folder =  "../images/stories/lab_excel/";
$result =   move_uploaded_file($_FILES['excel']['tmp_name'], $folder.$filename);

/*echo $folder.$_FILES['excel']['name'];
die();*/

if($result){
$msg="File Uploaded Successfully";
    return $folder.$filename;
}
else
{
    return false;
} 
```

}

# facebook - iOS Facebook SDK 3.5 发布。不显示应用名称（通过“iOS”发布的帖子）

> ID：16164486
> 
> 赞同：0
> 
> 时间：2013-04-23T08:24:48.343
> 
> 标签：facebook, ios6

我想在 iOS6 上发布 Facebook。我这样做的方式：

1.  请求阅读权限
2.  请求发布许可
3.  调用 [FBDialogs presentOSIntegratedShareDialog...]

它可以工作，但在提要中我看到“通过 iOS”，我想看到我的应用程序名称。如何修复？如果我使用 Feed Dialog（基于 Web）发布 - 我的应用程序名称显示正确

```
- (IBAction)facebookShareButtonTaped:(id)sender
{
    [FBSession openActiveSessionWithReadPermissions:@[@"email"]
                                       allowLoginUI:YES
                                  completionHandler:^(FBSession *session, FBSessionState status, NSError *error)
    {
        if (status == FBSessionStateOpen)
        {
            [FBSession.activeSession requestNewPublishPermissions:@[@"publish_actions"] defaultAudience:FBSessionDefaultAudienceOnlyMe completionHandler:^(FBSession *session, NSError *error) {
                [self sendFacebookPost];
            }];
        }
    }];
}

- (BOOL)sendFacebookPost
{
    BOOL dialogShown = [FBDialogs presentOSIntegratedShareDialogModallyFrom:self initialText:@"" image:nil url:nil handler:^(FBOSIntegratedShareDialogResult result, NSError *error) {
        if (error && [error code] == 7)
        {
            return;
        }

        if (error)
        {
            [self showAlert:[self checkErrorMessage:error]];
        }
        else if (result == FBNativeDialogResultSucceeded)
        {
            [self showAlert:@"Posted successfully."];
        }
    }];

    return dialogShown;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-06T17:09:04.757

您可以通过在 plist 文件中的信息属性列表中添加新条目来指定应显示的名称。只需添加`FacebookDisplayName`具有您想要的名称的键作为其值。

# java - Java DOM 解析器不解析一行 XML

> ID：16164487
> 
> 赞同：0
> 
> 时间：2013-04-23T08:24:54.833
> 
> 标签：java, xml, dom, xml-parsing

我有这个**单行 xml 文件**（没有缩进和新行），如下所示

```
 <?xml version="1.0" encoding="UTF-8"?>
    <Document xmlns="urn:iso:std:iso:20022:tech:xsd:camt.054.001.03" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="urn:iso:std:iso:20022:tech:xsd:camt.054.001.03 
camt.054.001.03.xsd">
    <BkToCstmrDbtCdtNtfctn><GrpHdr><MsgId>0000000006</MsgId>
<CreDtTm>2013-04-
    16T14:38:00</CreDtTm>
</GrpHdr>
</BkToCstmrDbtCdtNtfctn></Document> 
```

我正在使用这个 java DOM 解析器程序来解析和检索值

```
import java.io.File;
import java.util.ArrayList;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;

import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.NodeList;

public class GetNodeValues {
    static String value = null;
    static ArrayList alist = null;

    /****************** GET XPATH FOR EACH TAG **************************************/

    public static String getXPath(Element elemnt) {
        String xpath = null;
        String curNode = elemnt.getNodeName();
        ArrayList<String> al = new ArrayList<String>();
        al.add(curNode);
        // al.add(parNode);
        while (!elemnt.getParentNode().getNodeName().equals("#document")) {
            al.add(elemnt.getParentNode().getNodeName());
            elemnt = (Element) elemnt.getParentNode();
        }

        for (int i = al.size() - 1; i >= 0; i--) {
            xpath = xpath + "/" + al.get(i);
        }
        return xpath.replaceAll("null", "");
    }

    /******************************************************************************************/

    /**************************** GET TAG NAMES AND VALUES ***********************/

    public static ArrayList getValues() {
        try {

            alist = new ArrayList();
            String xmlFile = "C:/Users/Administrator/Desktop/sample2.xml";
            File file = new File(xmlFile);
            if (file.exists()) {

                // Create a factory
                DocumentBuilderFactory factory = DocumentBuilderFactory
                        .newInstance();
                // Use the factory to create a builder
                DocumentBuilder builder = factory.newDocumentBuilder();
                Document doc = builder.parse(xmlFile);

                doc.getDocumentElement().normalize();

                // Get a list of all elements in the document
                NodeList list = doc.getElementsByTagName("*");

                for (int i = 0; i < list.getLength(); i++) {
                    // Get element
                    Element element = (Element) list.item(i);
                    String nodnam = element.getNodeName();

                    if (element.getChildNodes().getLength() > 0) // then it has
                                                                    // text
                    {
                        String val = element.getChildNodes().item(0)
                                .getNodeValue();
                        if (val.startsWith("\n")) { // Discarding pseudo nodes

                        } else {
                            value = nodnam + " > " + val + " > "
                                    + getXPath(element); // print node names and
                                                            // values
                            System.out.println(value);
                            alist.add(value);
                        }
                    }
                }
            } else {
                System.out.print("File not found!");
            }
        } catch (Exception e) {
            System.exit(1);
        }

        return alist;
    }

    /********************************************************************************************/

    /************************** MAIN METHOD **********************************************/
    public static void main(String[] args) {
        System.out.println(getValues());

    }
} 
```

而且它不打印任何值。但是，如果我编辑 xml 文件并像这样添加缩进和新行

```
<?xml version="1.0" encoding="UTF-8"?>
<Document xmlns="urn:iso:std:iso:20022:tech:xsd:camt.054.001.03" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:iso:std:iso:20022:tech:xsd:camt.054.001.03 camt.054.001.03.xsd">
    <BkToCstmrDbtCdtNtfctn>
        <GrpHdr>
            <MsgId>0000000006</MsgId>
            <CreDtTm>2013-04-16T14:38:00</CreDtTm>
        </GrpHdr>
    </BkToCstmrDbtCdtNtfctn>
</Document> 
```

然后我得到如下输出

```
MsgId > 0000000006 > /Document/BkToCstmrDbtCdtNtfctn/GrpHdr/MsgId
CreDtTm > 2013-04-16T14:38:00 > /Document/BkToCstmrDbtCdtNtfctn/GrpHdr/CreDtTm 
```

所以问题是我不能编辑每个 xml 文件。要处理的文件很大。我在 java dom 解析器中遗漏了什么吗？我所需要的是程序应该解析和打印没有缩进和新行的 xml 文件的值....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:35:57.283

请注意，通过这样做：

```
} catch (Exception e) {
     System.exit(1);
} 
```

您正在隐藏异常，并且无法看到真正的问题。至少打印堆栈跟踪，例如：

```
} catch (Exception e) {
     e.printStackTrace();
     System.exit(1);
} 
```

在这种情况下，`var`from`String val = element.getChildNodes().item(0).getNodeValue();`可以为空。因此，使用以下修复程序应该可以解决此问题：

```
String val = element.getChildNodes().item(0).getNodeValue();
if (val != null) {
   if (val.startsWith("\n")) { // Discarding pseudo nodes
   } else {
       value = nodnam + " > " + val + " > "
            + getXPath(element); // print node names and
                                // values
       System.out.println(value);
       alist.add(value);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T12:55:07.777

除了导致 NPE 的实际问题外，我认为此时您的代码存在 3 个不同的问题：

```
 } catch (Exception e) {
     System.exit(1);
  } 
```

第一个问题（如@dan 所述）是您没有打印堆栈跟踪。

第二个问题是你在抓`Exception`。在大多数情况下，这是一个坏主意，因为您最终会捕获各种意外异常……除了您可能期望的任何异常。最好只捕获您期望并在那时可以处理的异常。其余的应该被允许传播。

第三个问题是您正在调用`System.exit`看似实用的方法。这是一个坏主意，有几个原因：

*   救助一种方法将使该方法难以在其他情况下使用……在这种情况下救助是错误的做法。

*   任何调用 System.exit 的方法都很难进行单元测试。如果您不采取措施避免它（例如，使用可以“模拟”该调用的模拟框架），那么该方法将导致运行单元测试的 JVM 立即停止……。

在我看来，编写该代码的正确方法是：

1.  在方法声明中添加任何必要`throws`的子句，以及`getValues()`
2.  `try ... catch`将方法放入`main`方法中...当然还有一些代码来输出或记录异常堆栈跟踪。

# android - Android - Canvas 或 TextView.draw 上的 DrawText

> ID：16164491
> 
> 赞同：-1
> 
> 时间：2013-04-23T08:25:17.650
> 
> 标签：android, canvas, textview

在我的 Android ( `API 10`) 游戏中，我使用了 a `MVC pattern`， a`SurfaceView`带有画布， a`ListView`用于输入选择。

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="horizontal" >

<com.gorgo.pirates.MainGamePanel
    android:id="@+id/surface"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center" >
</com.gorgo.pirates.MainGamePanel>

<ListView
    android:id="@+id/mylist"
    android:layout_width="match_parent"
    android:layout_height="110dp"
    android:layout_gravity="center_horizontal|bottom"
    android:background="@android:color/transparent"
    android:cacheColorHint="@android:color/transparent"
    android:divider="#00000000"
    android:drawSelectorOnTop="true" >
</ListView> 
```

所以现在我需要在屏幕上显示很多字符串（字符或旁白文本之间的语音）：它们会在屏幕上停留 4 秒，然后它们会隐藏自己，我更改文本并重新使用它们等等。

我已经编写了[这个有效的类](http://pastebin.com/bYmzpxCg)，但它初始化了一个新的`TextView`每次`draw()`调用 O_O

但我发现我无法创建 3 或 4`TextView`以及`setText`我想创建的任何时候，因为我的外部线程无法修改`View`. 我已经尝试过没有成功的处理程序。

所以我正在考虑，`canvas.drawText()`但我不知道这是否是正确的方法。我还需要我的字符串自动适合我的 widht（Pastebin 的类做到了）并使用自定义字体。

提示？:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:40:22.773

提示？当然，你必须使用这个：http: [//developer.android.com/reference/android/text/Layout.html](http://developer.android.com/reference/android/text/Layout.html)

# ruby-on-rails - 使用 Rails 以编程方式生成缓存

> ID：16164492
> 
> 赞同：1
> 
> 时间：2013-04-23T08:25:23.760
> 
> 标签：ruby-on-rails, ruby, http, caching, auto-generate

我有一个用 rails caches_page 命令缓存的大页面。在生成缓存之前，第一个 http 请求需要大约 30 秒来生成缓存。我想避免这种情况，以便第一个点击页面的用户可以更快地加载它。

我正在尝试使用 http 以编程方式生成缓存，但这似乎不起作用：

```
uri = URI.parse("http://mydomain.com/huge_page")

http = Net::HTTP.new(uri.host, uri.port)
request = Net::HTTP::Get.new(uri.request_uri)

response = http.request(request) 
```

我得到的响应是超时错误：

```
Timeout::Error (execution expired) 
```

你有什么建议我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:43:42.370

如果您尝试通过 HTTP 请求生成缓存，则必须确保您没有在原始请求的上下文中发出该请求。这意味着该页面将请求自己。

如果您这样做并且只有一个线程或服务器运行您的应用程序，它将永远无法完成请求并且会超时。这是因为动作在完成该部分之前不会完成`response = http.request(request)`。但是，您的服务器将无法响应，因为它正在执行操作。

然而，这一切都是说，在任何情况下，你都不应该**有**一个需要这么长时间才能加载的请求。任何花费超过一秒（或者，在生产中，比如 200 毫秒）的东西都应该被移动到一个 Delayed::Job 工作者或类似的后台队列中。

在不了解您的应用程序的详细信息的情况下，我强烈建议您想出一种方法来更快地生成页面，而不是在这里依赖缓存。

# c++ - 类方法的显式特化 - 符号已定义

> ID：16164496
> 
> 赞同：7
> 
> 时间：2013-04-23T08:25:32.570
> 
> 标签：c++, templates, linker-errors, explicit-specialization, one-definition-rule

单一定义规则规定程序应该包含*每个非内联函数的一个定义*。对于模板类的成员，这对我来说并不完全清楚：

```
 ///////////
 // Tfoo.h
 template<typename T> class A { 
     void foo(){} 
 };

 ///////////
 // intfoo.h
 #include <Tfoo.h>
 template<> class Foo<int> { 
     void foo(); // declaration only
 }; 
 /*inline*/ void Foo<int>::foo(){} // definition

 ///////////
 // X.cpp
 #include <intfoo.h>

 ///////////
 // Y.cpp
 #include <intfoo.h> 
```

在这种情况下，clientX.obj 和 clientY.obj 都有一个 .obj 的定义`Foo<int>::foo`。链接器抱怨这个符号被定义了不止一次：

```
Y.obj : error LNK2005: "private: void __thiscall Foo<int>::foo(void)" 
(?foo@?$Foo@H@@AAEXXZ) already defined in X.obj 
```

当我`inline`添加 的定义时`Foo<int>::foo()`，一切顺利，链接器很高兴。此外，当我在单独的编译单元（例如 intfoo.cpp）中定义它们时。

（注意：此解决方案在[https://stackoverflow.com/a/1481796/6610](https://stackoverflow.com/a/1481796/6610)中提出）

可能是一个误解，但模板类的成员函数不是总是“内联”的吗？这里的规则是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-23T08:30:54.727

类模板的*显式*特化的成员函数就像非模板类的成员函数。毕竟，显式特化*是*不依赖任何模板参数的具体类。

如果您将其定义放在一个包含多个翻译单元的头文件中，编译器将在处理每个翻译单元时为该函数生成目标代码。

最终，链接器会抱怨多重定义的符号。关键字可以防止这种`inline`行为，就像它对常规非模板函数或非模板类的常规成员函数所做的那样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-12T19:15:26.790

您可以移动显式专业化的定义

`void Foo<int>::foo() {}`

到 .cpp 文件中。在 .h 中留下声明：

```
template<>
void Foo<int>::foo(); 
```

# asp.net - EntityDataSource OrderBy 冲突

> ID：16164503
> 
> 赞同：2
> 
> 时间：2013-04-23T08:26:18.450
> 
> 标签：asp.net, .net, entitydatasource

我将 EntityDataSource 与 RadGrid 一起使用。我在将 EntityDataSource“OrderBy”与“Select Top”语句组合在一起时遇到问题。

```
<asp:EntityDataSource runat="server" 
                      ID="EntityDataSourceAlarm"
                      ConnectionString="name=AlarmEntities" 
                      DefaultContainerName="AlarmEntities" 
                      EnableFlattening="False" 
                      EntitySetName="Alarms" 
                      OrderBy="it.Status ASC, it.TS DESC" 
                      Select="top(10) it.[OID], it.[TS], it.[Status]">
</asp:EntityDataSource> 
```

我希望在select 子句**之前应用 order by 子句。**`top(10)`当省略select 子句的 " " 部分时，这一切都有效。它应该首先按 [Status] 排序，然后按 [TS] 排序。然后在 select 语句中使用 top ，似乎它丢弃了 order by 子句。

我正在使用 .Net 4.5 和 EntityFramework 5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-18T04:24:45.527

这是一个解决方案，我对性能持怀疑态度，但效果很好：

```
<asp:EntityDataSource 
ID="edsHighUsage" 
runat="server" 
ConnectionString="name=DbEntities" 
DefaultContainerName="DbEntities" 
EnableFlattening="False" 
EntitySetName="HighUsages" 
OnSelecting="edsHighUsage_Selecting" 
OrderBy="it.MonthlyCost desc"
Select="it.[PhoneNumber], it.[MonthlyCost]">
</asp:EntityDataSource> 
```

代码隐藏：

```
protected void edsHighUsage_Selecting(object sender, EntityDataSourceSelectingEventArgs e)
{
    e.SelectArguments.MaximumRows = 100;
} 
```

# c - Intel Xeon Phi 上的快速popcount

> ID：16164507
> 
> 赞同：9
> 
> 时间：2013-04-23T08:26:46.793
> 
> 标签：c, vectorization, xeon-phi, intel-mic, hammingweight

我正在 Intel Xeon® Phi® 上实现超快速 popcount，因为它是各种生物信息学软件的性能热点。

我已经实现了五段代码，

```
#if defined(__MIC__)
#include <zmmintrin.h>
__attribute__((align(64))) static const uint32_t POPCOUNT_4bit[16] = {0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4};
__attribute__((align(64))) static const uint32_t MASK_4bit[16] = {0xF, 0xF, 0xF, 0xF, 0xF, 0xF, 0xF, 0xF, 0xF, 0xF, 0xF, 0xF, 0xF, 0xF, 0xF, 0xF};
inline uint64_t vpu_popcount1(uint64_t* buf, size_t n)  {
    register size_t result = 0;
    size_t i;
    register const __m512i popcnt = _mm512_load_epi32((void*)POPCOUNT_4bit);
    register const __m512i mask = _mm512_load_epi32((void*)MASK_4bit);
    register __m512i total;
    register __m512i shuf;

#pragma unroll(8)
    for (i = 0; i < n; i+=8) {
        shuf = _mm512_load_epi32(&buf[i]);
        _mm_prefetch((const char *)&buf[i+256], _MM_HINT_T1); // vprefetch1
        _mm_prefetch((const char *)&buf[i+64], _MM_HINT_T0); // vprefetch0
        total = _mm512_setzero_epi32();

        total = _mm512_add_epi32(_mm512_permutevar_epi32(_mm512_and_epi32(shuf, mask), popcnt), total);
        total = _mm512_add_epi32(_mm512_permutevar_epi32(_mm512_and_epi32(_mm512_srli_epi32(shuf, 4),  mask), popcnt), total);
        total = _mm512_add_epi32(_mm512_permutevar_epi32(_mm512_and_epi32(_mm512_srli_epi32(shuf, 8),  mask), popcnt), total);
        total = _mm512_add_epi32(_mm512_permutevar_epi32(_mm512_and_epi32(_mm512_srli_epi32(shuf, 12), mask), popcnt), total);
        total = _mm512_add_epi32(_mm512_permutevar_epi32(_mm512_and_epi32(_mm512_srli_epi32(shuf, 16), mask), popcnt), total);
        total = _mm512_add_epi32(_mm512_permutevar_epi32(_mm512_and_epi32(_mm512_srli_epi32(shuf, 20), mask), popcnt), total);
        total = _mm512_add_epi32(_mm512_permutevar_epi32(_mm512_and_epi32(_mm512_srli_epi32(shuf, 24), mask), popcnt), total);
        total = _mm512_add_epi32(_mm512_permutevar_epi32(_mm512_and_epi32(_mm512_srli_epi32(shuf, 28), mask), popcnt), total);

        /* Reduce add, which is analogous to SSSE3's PSADBW instruction,
           is not implementated as a single instruction in VPUv1, thus
           emulated by multiple instructions*/
        result += _mm512_reduce_add_epi32(total);
    }

    return result;
}

__attribute__((align(64))) static const unsigned magic[] = {\
        0x55555555, 0x55555555, 0x55555555, 0x55555555,\
        0x55555555, 0x55555555, 0x55555555, 0x55555555,\
        0x55555555, 0x55555555, 0x55555555, 0x55555555,\
        0x55555555, 0x55555555, 0x55555555, 0x55555555,\
        0x33333333, 0x33333333, 0x33333333, 0x33333333,\
        0x33333333, 0x33333333, 0x33333333, 0x33333333,\
        0x33333333, 0x33333333, 0x33333333, 0x33333333,\
        0x33333333, 0x33333333, 0x33333333, 0x33333333,\
        0x0F0F0F0F, 0x0F0F0F0F, 0x0F0F0F0F, 0x0F0F0F0F,\
        0x0F0F0F0F, 0x0F0F0F0F, 0x0F0F0F0F, 0x0F0F0F0F,\
        0x0F0F0F0F, 0x0F0F0F0F, 0x0F0F0F0F, 0x0F0F0F0F,\
        0x0F0F0F0F, 0x0F0F0F0F, 0x0F0F0F0F, 0x0F0F0F0F,\
        0x00FF00FF, 0x00FF00FF, 0x00FF00FF, 0x00FF00FF,\
        0x00FF00FF, 0x00FF00FF, 0x00FF00FF, 0x00FF00FF,\
        0x00FF00FF, 0x00FF00FF, 0x00FF00FF, 0x00FF00FF,\
        0x00FF00FF, 0x00FF00FF, 0x00FF00FF, 0x00FF00FF,\
        0x0000FFFF, 0x0000FFFF, 0x0000FFFF, 0x0000FFFF,\
        0x0000FFFF, 0x0000FFFF, 0x0000FFFF, 0x0000FFFF,\
        0x0000FFFF, 0x0000FFFF, 0x0000FFFF, 0x0000FFFF,\
        0x0000FFFF, 0x0000FFFF, 0x0000FFFF, 0x0000FFFF,\
            0x000000FF, 0x000000FF, 0x000000FF, 0x000000FF,\
            0x000000FF, 0x000000FF, 0x000000FF, 0x000000FF,\
            0x000000FF, 0x000000FF, 0x000000FF, 0x000000FF,\
            0x000000FF, 0x000000FF, 0x000000FF, 0x000000FF
    };

inline uint64_t vpu_popcount2(uint64_t* buf, size_t n)  {
    register size_t result = 0;
    size_t i;

    register const __m512i B0 = _mm512_load_epi32((void*)(magic+0));
    register const __m512i B1 = _mm512_load_epi32((void*)(magic+16));
    register const __m512i B2 = _mm512_load_epi32((void*)(magic+32));
    register const __m512i B3 = _mm512_load_epi32((void*)(magic+48));
    register const __m512i B4 = _mm512_load_epi32((void*)(magic+64));
    register __m512i total;
    register __m512i shuf;

#pragma unroll(8)
    for (i = 0; i < n; i+=8) {
        shuf = _mm512_load_epi32(&buf[i]);
        _mm_prefetch((const char *)&buf[i+512], _MM_HINT_T1); // vprefetch1
        _mm_prefetch((const char *)&buf[i+64], _MM_HINT_T0); // vprefetch0
        total = _mm512_sub_epi32(shuf, _mm512_and_epi32(B0, _mm512_srli_epi32(shuf,1)));
        total = _mm512_add_epi32(_mm512_and_epi32(B1, total), _mm512_and_epi32(B1,_mm512_srli_epi32(total,2)));
        total = _mm512_and_epi32(B2, _mm512_add_epi32(total, _mm512_srli_epi32(total,4)));
        total = _mm512_and_epi32(B3, _mm512_add_epi32(total, _mm512_srli_epi32(total,8)));
        total = _mm512_and_epi32(B4, _mm512_add_epi32(total, _mm512_srli_epi32(total,16)));

        /* Reduce add, which is analogous to SSSE3's PSADBW instruction,
           is not implementated as a single instruction in VPUv1, thus
           emulated by multiple instructions*/
        result += _mm512_reduce_add_epi32(total);
    }

    return result;
}

inline uint64_t vpu_popcount3(uint64_t* buf, size_t n)  {
    register size_t result = 0;
    size_t i;

    register const __m512i B0 = _mm512_load_epi32((void*)(magic+0));
    register const __m512i B1 = _mm512_load_epi32((void*)(magic+16));
    register const __m512i B2 = _mm512_load_epi32((void*)(magic+32));
    register const __m512i B3 = _mm512_load_epi32((void*)(magic+48));
    register const __m512i B4 = _mm512_load_epi32((void*)(magic+64));
    register __m512i total;
    register __m512i shuf;

#pragma unroll(4)
    for (i = 0; i < n; i+=16) {
        shuf = _mm512_load_epi32(&buf[i]);
        result += _mm_countbits_64(buf[i+8]);
        _mm_prefetch((const char *)&buf[i+512], _MM_HINT_T1); // vprefetch1
        _mm_prefetch((const char *)&buf[i+576], _MM_HINT_T1); // vprefetch1
        result += _mm_countbits_64(buf[i+9]);
        _mm_prefetch((const char *)&buf[i+64], _MM_HINT_T0); // vprefetch0
        _mm_prefetch((const char *)&buf[i+128], _MM_HINT_T0); // vprefetch0
        total = _mm512_sub_epi32(shuf, _mm512_and_epi32(B0, _mm512_srli_epi32(shuf,1)));
        result += _mm_countbits_64(buf[i+10]);
        total = _mm512_add_epi32(_mm512_and_epi32(B1, total), _mm512_and_epi32(B1,_mm512_srli_epi32(total,2)));
        result += _mm_countbits_64(buf[i+11]);
        total = _mm512_and_epi32(B2, _mm512_add_epi32(total, _mm512_srli_epi32(total,4)));
        result += _mm_countbits_64(buf[i+12]);
        total = _mm512_and_epi32(B3, _mm512_add_epi32(total, _mm512_srli_epi32(total,8)));
        result += _mm_countbits_64(buf[i+13]);
        total = _mm512_and_epi32(B4, _mm512_add_epi32(total, _mm512_srli_epi32(total,16)));
        result += _mm_countbits_64(buf[i+14]);

        /* Reduce add, which is analogous to SSSE3's PSADBW instruction,
           is not implementated as a single instruction in VPUv1, thus
           emulated by multiple instructions*/
        result += _mm512_reduce_add_epi32(total);
        result += _mm_countbits_64(buf[i+15]);
    }

    return result;
}

/* Using VPU or SSE's machine intrinsic, CPUs not supporting SIMD 
 * will use compiler's implementation, the speed of which depends */
static inline size_t scalar_popcountu(unsigned *buf, size_t n) {
  register size_t cnt = 0;
  size_t i;
#pragma vector always
#pragma unroll(8)
  for (i = 0; i < n; i++) {
    cnt += _mm_countbits_32(buf[i]);
    _mm_prefetch((const char *)&buf[i+512], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[i+64], _MM_HINT_T0); // vprefetch0
  }
  return cnt;
}

static inline size_t scalar_popcountlu(uint64_t *buf, size_t n) {
  register size_t cnt = 0;
  size_t i;
#pragma vector always
#pragma unroll(8)
  for (i = 0; i < n; i++) {
    cnt += _mm_countbits_64(buf[i]);
    _mm_prefetch((const char *)&buf[i+512], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[i+64], _MM_HINT_T0); // vprefetch0
  }
  return cnt;
}
#endif 
```

[可以从https://www.dropbox.com/sh/b3sfqps19wa2oi4/iFQ9wQ1NTg](https://www.dropbox.com/sh/b3sfqps19wa2oi4/iFQ9wQ1NTg)下载支持 OpenMP 的代码总结

该代码是使用 Intel C/C++ Compiler XE 13 使用命令编译的：

```
icc -debug inline-debug-info -O3 -mmic -fno-alias -ansi-alias -opt-streaming-stores always -ipo popcnt-mmic.cpp -o popcnt-mmic -vec-report=2 -openmp 
```

代码在协处理器（61 个内核）上以“122 个线程”本地运行，线程亲和性为“平衡”，使用导出：

```
export OMP_NUM_THREADS=122;export KMP_AFFINITY=balanced 
```

我正在使用Xeon Phi SE10p，B1 stepping，CentOS6.4在28兆的垃圾（由rand()填充）上测试并迭代10000次，性能如下：

```
Buffer allocated at: 0x7f456b000000
OpenMP scalar_popcountu       4310169 us; cnt = 28439328
OpenMP scalar_popcountlu      1421139 us; cnt = 28439328
OpenMP vpu_popcount           1489992 us; cnt = 28439328
OpenMP vpu_popcount2          1109530 us; cnt = 28439328
OpenMP vpu_popcount3           951122 us; cnt = 28439328 
```

“scalar_popcountu”和“scalar_popcountlu”分别使用“_mm_countbits_32”和“_mm_countbits_64”内在函数，它们利用标量“popcnt”指令。设置“#pragma vector always”要求编译器将负载和总和向量化为 16 个无符号整数或 8 个无符号长整数，尽管 popcount 本身仍然是一个标量指令。

vpu_popcount1 的实现类似于 SSSE3 popcount 实现[http://wm.ite.pl/articles/sse-popcount.html](http://wm.ite.pl/articles/sse-popcount.html)。但是，1) Xeon Phi 不支持对整数的打包字节操作（最小值是双字，也就是 32 位）和 2) 它不实现“绝对差的打包和”指令（如 SSSE3 中的 _mm_sad_epu8），因此减少添加是由“vpermf32x4”、“vpaddd”和“movslq”四组组合执行的。因此，该实现生成的指令比原始 SSSE3 版本多得多。

vpu_popcount2 的实现类似于 SSE2 popcount 的实现（可以参考《Hacker's Delight》）。该实现生成的指令比 vpu_popcount1 少，速度快 30% 左右。然而，繁琐的“减加”依然无法避免。

vpu_popcount3 的实现非常特定于 Xeon Phi。混合使用向量和标量操作，它比 vpu_popcount2 快约 15%（在我的实现中，向量操作中的标量操作的穿插是休闲的，可以根据编译器生成的汇编代码重新排列标量操作，但预期的改进就我而言是有限的）。改进基于以下观察：1) Xeon Phi 是按顺序调度，2) 每个时钟周期可以发出两条标量指令或“1 个向量+1 个标量”指令。我已将展开从 8 减少到 4，以避免寄存器文件饱和。

每个函数中提前从内存到 L2 8 循环和从 L2 到 L1 1 循环的显式预取使 L1 命中率从 0.38 增加到 0.994。

展开确实将性能提高了约 15%。这是反直觉的，因为 Xeon Phi 是按顺序调度的。但是 unroll 使 icc 编译器能够进行尽可能多的编译时间调度。

我们有更多的技术来提高性能吗？

来自 Brian Nickerson 的两段更快的代码，

```
OpenMP vpu_popcount2          1110737 us; cnt = 28439328
OpenMP vpu_popcount3           951459 us; cnt = 28439328
OpenMP vpu_popcount3_r         815126 us; cnt = 28439328
OpenMP vpu_popcount5           746852 us; cnt = 28439328 
```

vpu_popcount3_revised：

```
inline uint64_t vpu_popcount3_revised(uint64_t* buf, size_t n) {
  _mm_prefetch((const char *)&buf[0], _MM_HINT_T0); // vprefetch0
  _mm_prefetch((const char *)&buf[8], _MM_HINT_T0); // vprefetch0
  _mm_prefetch((const char *)&buf[16], _MM_HINT_T1); // vprefetch1
  _mm_prefetch((const char *)&buf[24], _MM_HINT_T1); // vprefetch1
  _mm_prefetch((const char *)&buf[32], _MM_HINT_T1); // vprefetch1
  _mm_prefetch((const char *)&buf[40], _MM_HINT_T1); // vprefetch1
  _mm_prefetch((const char *)&buf[48], _MM_HINT_T1); // vprefetch1
  _mm_prefetch((const char *)&buf[56], _MM_HINT_T1); // vprefetch1
  _mm_prefetch((const char *)&buf[64], _MM_HINT_T1); // vprefetch1
  _mm_prefetch((const char *)&buf[72], _MM_HINT_T1); // vprefetch1
  _mm_prefetch((const char *)&buf[80], _MM_HINT_T1); // vprefetch1
  _mm_prefetch((const char *)&buf[88], _MM_HINT_T1); // vprefetch1
  _mm_prefetch((const char *)&buf[96], _MM_HINT_T1); // vprefetch1
  _mm_prefetch((const char *)&buf[104], _MM_HINT_T1); // vprefetch1
  _mm_prefetch((const char *)&buf[112], _MM_HINT_T1); // vprefetch1
  _mm_prefetch((const char *)&buf[120], _MM_HINT_T1); // vprefetch1
  register size_t result;
  size_t i;

  register const __m512i B0 = _mm512_load_epi32((void*)(magic+0));
  register const __m512i B1 = _mm512_load_epi32((void*)(magic+16));
  register const __m512i B2 = _mm512_load_epi32((void*)(magic+32));
  register const __m512i B3 = _mm512_load_epi32((void*)(magic+48));
  register const __m512i B4 = _mm512_load_epi32((void*)(magic+64));
  register __m512i total0;
  register __m512i total1;
  register __m512i shuf0;
  register __m512i shuf1;
  register __m512i result0;
  register __m512i result1;

  result0 = _mm512_setzero_epi32();
  result1 = _mm512_setzero_epi32();

  for (i = 0; i < n; i+=16) {
      shuf0 = _mm512_load_epi32(&buf[i  ]);
      shuf1 = _mm512_load_epi32(&buf[i+8]);
      _mm_prefetch((const char *)&buf[i+128], _MM_HINT_T1); // vprefetch1
      _mm_prefetch((const char *)&buf[i+136], _MM_HINT_T1); // vprefetch1
      _mm_prefetch((const char *)&buf[i+16], _MM_HINT_T0); // vprefetch0
      _mm_prefetch((const char *)&buf[i+24], _MM_HINT_T0); // vprefetch0
      total0 = _mm512_sub_epi32(shuf0, _mm512_and_epi32(B0, _mm512_srli_epi32(shuf0,1)));
      total1 = _mm512_sub_epi32(shuf1, _mm512_and_epi32(B0, _mm512_srli_epi32(shuf1,1)));
      total0 = _mm512_add_epi32(_mm512_and_epi32(B1, total0), _mm512_and_epi32(B1,_mm512_srli_epi32(total0,2)));
      total1 = _mm512_add_epi32(_mm512_and_epi32(B1, total1), _mm512_and_epi32(B1,_mm512_srli_epi32(total1,2)));
      total0 = _mm512_and_epi32(B2, _mm512_add_epi32(total0, _mm512_srli_epi32(total0,4)));
      total1 = _mm512_and_epi32(B2, _mm512_add_epi32(total1, _mm512_srli_epi32(total1,4)));
      total0 = _mm512_and_epi32(B3, _mm512_add_epi32(total0, _mm512_srli_epi32(total0,8)));
      total1 = _mm512_and_epi32(B3, _mm512_add_epi32(total1, _mm512_srli_epi32(total1,8)));
      total0 = _mm512_and_epi32(B4, _mm512_add_epi32(total0, _mm512_srli_epi32(total0,16)));
      total1 = _mm512_and_epi32(B4, _mm512_add_epi32(total1, _mm512_srli_epi32(total1,16)));
      result0 = _mm512_add_epi32(result0,total0);
      result1 = _mm512_add_epi32(result1,total1);

  }

  result0 = _mm512_add_epi32(result0,result1);
  result  = _mm512_reduce_add_epi32(result0);

  return result;
} 
```

vpu_popcount5：

```
inline uint64_t vpu_popcount5(uint64_t* buf, size_t n)  {
    _mm_prefetch((const char *)&buf[0], _MM_HINT_T0); // vprefetch0
    _mm_prefetch((const char *)&buf[8], _MM_HINT_T0); // vprefetch0
    _mm_prefetch((const char *)&buf[16], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[24], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[32], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[40], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[48], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[56], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[64], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[72], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[80], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[88], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[96], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[104], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[112], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[120], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[128], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[136], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[144], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[152], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[160], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[168], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[176], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[184], _MM_HINT_T1); // vprefetch1
    register size_t result;
    size_t i;

    register const __m512i B0 = _mm512_load_epi32((void*)(magic+0));
    register const __m512i B1 = _mm512_load_epi32((void*)(magic+16));
    register const __m512i B2 = _mm512_load_epi32((void*)(magic+32));
    register const __m512i B3 = _mm512_load_epi32((void*)(magic+48));
    register const __m512i B4 = _mm512_load_epi32((void*)(magic+64));
    register const __m512i B6 = _mm512_load_epi32((void*)(magic+80));
    register __m512i total0;
    register __m512i total1;
    register __m512i total2;
    register __m512i total3;
    register __m512i shuf0;
    register __m512i shuf1;
    register __m512i shuf2;
    register __m512i shuf3;
    register __m512i result0;
    register __m512i result1;

    result0 = _mm512_setzero_epi32();
    result1 = _mm512_setzero_epi32();

    for (i = 0; i < n; i+=32) {
            shuf0 = _mm512_load_epi32(&buf[i   ]);
            shuf1 = _mm512_load_epi32(&buf[i+ 8]);
            shuf2 = _mm512_load_epi32(&buf[i+16]);
            shuf3 = _mm512_load_epi32(&buf[i+24]);
            _mm_prefetch((const char *)&buf[i+192], _MM_HINT_T1); // vprefetch1
            _mm_prefetch((const char *)&buf[i+200], _MM_HINT_T1); // vprefetch1
            _mm_prefetch((const char *)&buf[i+208], _MM_HINT_T1); // vprefetch1
            _mm_prefetch((const char *)&buf[i+216], _MM_HINT_T1); // vprefetch1
            _mm_prefetch((const char *)&buf[i+32], _MM_HINT_T0); // vprefetch0
            _mm_prefetch((const char *)&buf[i+40], _MM_HINT_T0); // vprefetch0
            _mm_prefetch((const char *)&buf[i+48], _MM_HINT_T0); // vprefetch0
            _mm_prefetch((const char *)&buf[i+56], _MM_HINT_T0); // vprefetch0
            total0 = _mm512_sub_epi32(shuf0, _mm512_and_epi32(B0, _mm512_srli_epi32(shuf0,1)));                        //  max value in nn is 10
            total1 = _mm512_sub_epi32(shuf1, _mm512_and_epi32(B0, _mm512_srli_epi32(shuf1,1)));
            total2 = _mm512_sub_epi32(shuf2, _mm512_and_epi32(B0, _mm512_srli_epi32(shuf2,1)));
            total3 = _mm512_sub_epi32(shuf3, _mm512_and_epi32(B0, _mm512_srli_epi32(shuf3,1)));
            total0 = _mm512_add_epi32(_mm512_and_epi32(B1, total0), _mm512_and_epi32(B1,_mm512_srli_epi32(total0,2))); //  max value in nnnn is 0100
            total1 = _mm512_add_epi32(_mm512_and_epi32(B1, total1), _mm512_and_epi32(B1,_mm512_srli_epi32(total1,2)));
            total2 = _mm512_add_epi32(_mm512_and_epi32(B1, total2), _mm512_and_epi32(B1,_mm512_srli_epi32(total2,2)));
            total3 = _mm512_add_epi32(_mm512_and_epi32(B1, total3), _mm512_and_epi32(B1,_mm512_srli_epi32(total3,2)));
            total0 = _mm512_and_epi32(B2, _mm512_add_epi32(total0, _mm512_srli_epi32(total0,4)));                      //  max value in 0000nnnn is 00001000
            total1 = _mm512_and_epi32(B2, _mm512_add_epi32(total1, _mm512_srli_epi32(total1,4)));
            total2 = _mm512_and_epi32(B2, _mm512_add_epi32(total2, _mm512_srli_epi32(total2,4)));
            total3 = _mm512_and_epi32(B2, _mm512_add_epi32(total3, _mm512_srli_epi32(total3,4)));
            total0 = _mm512_add_epi32(total0, total1);                                                                 //  max value in 000nnnnn is 00010000
            total1 = _mm512_add_epi32(total2, total3);
            total0 = _mm512_add_epi32(total0, _mm512_srli_epi32(total0,8));                                            //  max value in xxxxxxxx00nnnnnn is 00100000
            total1 = _mm512_add_epi32(total1, _mm512_srli_epi32(total1,8));
            total0 = _mm512_and_epi32(B6, _mm512_add_epi32(total0, _mm512_srli_epi32(total0,16)));                     //  max value in each element is 01000000, i.e. 64
            total1 = _mm512_and_epi32(B6, _mm512_add_epi32(total1, _mm512_srli_epi32(total1,16)));
            result0 = _mm512_add_epi32(result0,total0);
            result1 = _mm512_add_epi32(result1,total1);
    }

    result0 = _mm512_add_epi32(result0,result1);
    result  = _mm512_reduce_add_epi32(result0);

    return result;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-30T19:44:51.003

自昨天发布以来，我已经能够在我自己的卡片上运行您的代码和我的建议。我没有得到与你完全相同的时间，可能是由于我的硬件步进，也可能与我的编译器版本有关。但趋势依然存在，我的建议似乎实现了大约 15% 的性能提升。

我得到了额外的小幅性能提升，在 5% 到 10% 之间，并进行了一些调整，如下面的代码所示。请注意，在以下代码片段中，B6 将每个元素设置为 0x000000FF。在这一点上，我认为算法可能会逼近从 GDDR 到 L2 缓存的最大可持续带宽。

**（补充说明：这个断言的一个证明是，如果我用一个重复它十次的 for 循环包装 popcount5 函数的主体 - 请注意这是输入数据的“chunk_size”的十次快速重复，所以九在 L2 中它会变得炙手可热的时候——测试的总时间只增加了大约 5 倍，而不是 10 倍。我提出这个是因为我认为你的目标是调整位计数逻辑的速度, 但也许您希望在其中部署它的应用程序实际上有一个更小和/或更热的工作集。如果是这样，DRAM--> L2 带宽引入的节流会使情况变得模糊。但请注意，将您的测试输入使其在 L2 中保持更热似乎会导致其他开销（可能是 openmp 开销）变得相对更重要。）**

```
inline uint64_t vpu_popcount5(uint64_t* buf, size_t n)  {
    _mm_prefetch((const char *)&buf[0], _MM_HINT_T0); // vprefetch0
    _mm_prefetch((const char *)&buf[8], _MM_HINT_T0); // vprefetch0
    _mm_prefetch((const char *)&buf[16], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[24], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[32], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[40], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[48], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[56], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[64], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[72], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[80], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[88], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[96], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[104], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[112], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[120], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[128], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[136], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[144], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[152], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[160], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[168], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[176], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[184], _MM_HINT_T1); // vprefetch1
    register size_t result;
    size_t i;

    register const __m512i B0 = _mm512_load_epi32((void*)(magic+0));
    register const __m512i B1 = _mm512_load_epi32((void*)(magic+16));
    register const __m512i B2 = _mm512_load_epi32((void*)(magic+32));
    register const __m512i B6 = _mm512_load_epi32((void*)(magic+80));
    register __m512i total0;
    register __m512i total1;
    register __m512i total2;
    register __m512i total3;
    register __m512i shuf0;
    register __m512i shuf1;
    register __m512i shuf2;
    register __m512i shuf3;
    register __m512i result0;
    register __m512i result1;

    result0 = _mm512_setzero_epi32();
    result1 = _mm512_setzero_epi32();

    for (i = 0; i < n; i+=32) {
        shuf0 = _mm512_load_epi32(&buf[i   ]);
        shuf1 = _mm512_load_epi32(&buf[i+ 8]);
        shuf2 = _mm512_load_epi32(&buf[i+16]);
        shuf3 = _mm512_load_epi32(&buf[i+24]);
        _mm_prefetch((const char *)&buf[i+192], _MM_HINT_T1); // vprefetch1
        _mm_prefetch((const char *)&buf[i+200], _MM_HINT_T1); // vprefetch1
        _mm_prefetch((const char *)&buf[i+208], _MM_HINT_T1); // vprefetch1
        _mm_prefetch((const char *)&buf[i+216], _MM_HINT_T1); // vprefetch1
        _mm_prefetch((const char *)&buf[i+32], _MM_HINT_T0); // vprefetch0
        _mm_prefetch((const char *)&buf[i+40], _MM_HINT_T0); // vprefetch0
        _mm_prefetch((const char *)&buf[i+48], _MM_HINT_T0); // vprefetch0
        _mm_prefetch((const char *)&buf[i+56], _MM_HINT_T0); // vprefetch0
        total0 = _mm512_sub_epi32(shuf0, _mm512_and_epi32(B0, _mm512_srli_epi32(shuf0,1)));                        //  max value in nn is 10
        total1 = _mm512_sub_epi32(shuf1, _mm512_and_epi32(B0, _mm512_srli_epi32(shuf1,1)));
        total2 = _mm512_sub_epi32(shuf2, _mm512_and_epi32(B0, _mm512_srli_epi32(shuf2,1)));
        total3 = _mm512_sub_epi32(shuf3, _mm512_and_epi32(B0, _mm512_srli_epi32(shuf3,1)));
        total0 = _mm512_add_epi32(_mm512_and_epi32(B1, total0), _mm512_and_epi32(B1,_mm512_srli_epi32(total0,2))); //  max value in nnnn is 0100
        total1 = _mm512_add_epi32(_mm512_and_epi32(B1, total1), _mm512_and_epi32(B1,_mm512_srli_epi32(total1,2)));
        total2 = _mm512_add_epi32(_mm512_and_epi32(B1, total2), _mm512_and_epi32(B1,_mm512_srli_epi32(total2,2)));
        total3 = _mm512_add_epi32(_mm512_and_epi32(B1, total3), _mm512_and_epi32(B1,_mm512_srli_epi32(total3,2)));
        total0 = _mm512_and_epi32(B2, _mm512_add_epi32(total0, _mm512_srli_epi32(total0,4)));                      //  max value in 0000nnnn is 00001000
        total1 = _mm512_and_epi32(B2, _mm512_add_epi32(total1, _mm512_srli_epi32(total1,4)));
        total2 = _mm512_and_epi32(B2, _mm512_add_epi32(total2, _mm512_srli_epi32(total2,4)));
        total3 = _mm512_and_epi32(B2, _mm512_add_epi32(total3, _mm512_srli_epi32(total3,4)));
        total0 = _mm512_add_epi32(total0, total1);                                                                 //  max value in 000nnnnn is 00010000
        total1 = _mm512_add_epi32(total2, total3);
        total0 = _mm512_add_epi32(total0, _mm512_srli_epi32(total0,8));                                            //  max value in xxxxxxxx00nnnnnn is 00100000
        total1 = _mm512_add_epi32(total1, _mm512_srli_epi32(total1,8));
        total0 = _mm512_and_epi32(B6, _mm512_add_epi32(total0, _mm512_srli_epi32(total0,16)));                     //  max value in each element is 01000000, i.e. 64
        total1 = _mm512_and_epi32(B6, _mm512_add_epi32(total1, _mm512_srli_epi32(total1,16)));
        result0 = _mm512_add_epi32(result0,total0);
        result1 = _mm512_add_epi32(result1,total1);

        /* Reduce add, which is analogous to SSSE3's PSADBW instruction,
           is not implementated as a single instruction in VPUv1, thus
           emulated by multiple instructions*/
    }

    result0 = _mm512_add_epi32(result0,result1);
    result  = _mm512_reduce_add_epi32(result0);

    return result;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-30T01:41:39.933

Will you please try the following variant, and report back whether this improves performance for you? I am addressing several points that I think aren't quite optimal in your coding:

*   I don't think your prefetching distances were quite right. It looked to me like you might have been thinking of byte offset distances when the indexing was really in terms of uint64's.
*   I see no reason to do the reduction operation every iteration of the loop. You can do partial accumulations of bit counts in the 16 SIMD elements, and then do a single reduction outside the loop.
*   I do not think that doing scalar-side popcount instructions is as advantageous as really getting the best of VPU scheduling. Focusing on an excellent VPU schedule is of highest importance. I also do not think that the scalar popcount instruction actually pairs with a vector operation; i.e. I think it is supported only in the U-pipe.

* * *

```
inline uint64_t vpu_popcount3_revised(uint64_t* buf, size_t n) {
    _mm_prefetch((const char *)&buf[0], _MM_HINT_T0); // vprefetch0
    _mm_prefetch((const char *)&buf[8], _MM_HINT_T0); // vprefetch0
    _mm_prefetch((const char *)&buf[16], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[24], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[32], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[40], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[48], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[56], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[64], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[72], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[80], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[88], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[96], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[104], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[112], _MM_HINT_T1); // vprefetch1
    _mm_prefetch((const char *)&buf[120], _MM_HINT_T1); // vprefetch1
    register size_t result;
    size_t i;

    register const __m512i B0 = _mm512_load_epi32((void*)(magic+0));
    register const __m512i B1 = _mm512_load_epi32((void*)(magic+16));
    register const __m512i B2 = _mm512_load_epi32((void*)(magic+32));
    register const __m512i B3 = _mm512_load_epi32((void*)(magic+48));
    register const __m512i B4 = _mm512_load_epi32((void*)(magic+64));
    register __m512i total0;
    register __m512i total1;
    register __m512i shuf0;
    register __m512i shuf1;
    register __m512i result0;
    register __m512i result1;

    result0 = _mm512_setzero_epi32();
    result1 = _mm512_setzero_epi32();

    for (i = 0; i < n; i+=16) {
        shuf0 = _mm512_load_epi32(&buf[i  ]);
        shuf1 = _mm512_load_epi32(&buf[i+8]);
        _mm_prefetch((const char *)&buf[i+128], _MM_HINT_T1); // vprefetch1
        _mm_prefetch((const char *)&buf[i+136], _MM_HINT_T1); // vprefetch1
        _mm_prefetch((const char *)&buf[i+16], _MM_HINT_T0); // vprefetch0
        _mm_prefetch((const char *)&buf[i+24], _MM_HINT_T0); // vprefetch0
        total0 = _mm512_sub_epi32(shuf0, _mm512_and_epi32(B0, _mm512_srli_epi32(shuf0,1)));
        total1 = _mm512_sub_epi32(shuf1, _mm512_and_epi32(B0, _mm512_srli_epi32(shuf1,1)));
        total0 = _mm512_add_epi32(_mm512_and_epi32(B1, total0), _mm512_and_epi32(B1,_mm512_srli_epi32(total0,2)));
        total1 = _mm512_add_epi32(_mm512_and_epi32(B1, total1), _mm512_and_epi32(B1,_mm512_srli_epi32(total1,2)));
        total0 = _mm512_and_epi32(B2, _mm512_add_epi32(total0, _mm512_srli_epi32(total0,4)));
        total1 = _mm512_and_epi32(B2, _mm512_add_epi32(total1, _mm512_srli_epi32(total1,4)));
        total0 = _mm512_and_epi32(B3, _mm512_add_epi32(total0, _mm512_srli_epi32(total0,8)));
        total1 = _mm512_and_epi32(B3, _mm512_add_epi32(total1, _mm512_srli_epi32(total1,8)));
        total0 = _mm512_and_epi32(B4, _mm512_add_epi32(total0, _mm512_srli_epi32(total0,16)));
        total1 = _mm512_and_epi32(B4, _mm512_add_epi32(total1, _mm512_srli_epi32(total1,16)));
        result0 = _mm512_add_epi32(result0,total0);
        result1 = _mm512_add_epi32(result1,total1);

    }

    /* Reduce add, which is analogous to SSSE3's PSADBW instruction,
       is not implementated as a single instruction in VPUv1, thus
       emulated by multiple instructions*/

    result0 = _mm512_add_epi32(result0,result1);
    result  = _mm512_reduce_add_epi32(result0);

    return result;
} 
```

# android - irrlicht android on opengl es 2.0 驱动程序

> ID：16164508
> 
> 赞同：8
> 
> 时间：2013-04-23T08:26:53.060
> 
> 标签：android, graphics, opengl-es-2.0, irrlicht

我正在学习[在 Android 上使用 Irrlicht](http://gitorious.org/irrlichtandroid/pages/Home)。上个月我一直在开发基于 openGL es 1.0 的驱动程序，效果很好（我使用 1.0 是因为当我尝试运行基于驱动程序 es 2.0 的示例时结果很奇怪）。加载网格是可以的，但让我困惑的是纹理无法正确显示。渲染代码如下：

```
smgr = device->getSceneManager();
guienv = device->getGUIEnvironment();

stringc myDir = gSdCardPath;
myDir += "/Irrlicht";
device->getFileSystem()->changeWorkingDirectoryTo(myDir.c_str());

stringc sydneyFilename = "/Irrlicht/sydney.md2";
mesh=smgr->getMesh("/sdcard/Irrlicht/sydney.md2");
if (!mesh) {
    device->drop();
    __android_log_print(ANDROID_LOG_INFO, "Irrlicht", "cannot getMesh");
    return;
}
nodeSydney = smgr->addAnimatedMeshSceneNode(mesh);

if (nodeSydney) {
    nodeSydney->setMaterialFlag(EMF_LIGHTING, false);
    nodeSydney->setMD2Animation(scene::EMAT_STAND);
    stringc sydneyTextureFilename = "/Irrlicht/sydney.bmp";
    texture=driver->getTexture("/sdcard/Irrlicht/sydney.bmp");
    if (!texture)
        LOGI("sydney.bmp load failed");
    else{
        nodeSydney->setMaterialTexture(0,texture);
        LOGI("sydney.bmp load successfully");
    }
    nodeSydney->setPosition(core::vector3df(0.0f,0.0f,0.0f));
}
smgr->addCameraSceneNode(0, vector3df(0, 10, -50), vector3df(0, 5, 0));

receiver = new AndroidEventReceiver(context);
device->setEventReceiver(receiver); 
```

除了删除的注释和节点的位置之外，一切都与原始代码相同，我也确信代码中需要的文件位于正确的目录中。

那么任何有在 Android 上使用 Irrlicht 经验的人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-19T06:14:56.520

我们遇到了同样的问题。统一名称的长度是唯一的问题。统一名称将存储在 COGLES2FixedpipelineShader、COGLES2NormalMapShader 等类的 SBuiltinShaderUniformNames[] 数组中。将统一名称缩短到 10 个字符以下。

编辑：缩短统一名称将解决此问题。

# vim - VIM：命令/函数的可选行范围

> ID：16164518
> 
> 赞同：11
> 
> 时间：2013-04-23T08:27:38.110
> 
> 标签：vim

我有这个`.vimrc`删除尾随空格：

```
function! RemoveTrailingWhitespace()
  for lineno in range(a:firstline, a:lastline)
    let line = getline(lineno)
    let cleanLine = substitute(line, '\(\s\| \)\+$', '', 'e')
    call setline(lineno, cleanLine)
  endfor
endfunction
command -range RemoveTrailingWhitespace <line1>,<line2>call RemoveTrailingWhitespace()
command -range RT                       <line1>,<line2>call RemoveTrailingWhitespace() 
```

这使我可以调用`:'<,'>RT`以删除视觉选择的行范围的尾随空格。但是，当我只是调用`:RT`时，它仅在当前行上运行。我想要的是将命令应用于整个缓冲区。如何做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-23T08:31:41.990

如果你不给`range`，命令`range`将应用于当前行。如果您想在整个缓冲区上执行此操作，请使用`:%RT`或`:1,$RT`

您可以将整个缓冲区设置为默认范围的方法是：

```
command -range=% RT  <line1>,<line2>call RemoveTrailingWhitespace() 
```

细节：

```
:h command-range 
```

然后你会看到：

```
Possible attributes are:

-range      Range allowed, default is current line
-range=%    Range allowed, default is whole file (1,$)
-range=N    A count (default N) which is specified in the line
        number position (like |:split|); allows for zero line
        number.
-count=N    A count (default N) which is specified either in the line
        number position, or as an initial argument (like |:Next|).
        Specifying -count (without a default) acts like -count=0 
```

**对您的职能的**一条评论/问题****

 **如果您有范围信息，为什么不直接在命令中调用 vim-build`:[range]s`来进行替换？那么你可以保存那些行`getline`, `setline`, 也是`loop`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T09:07:49.997

最后我选择了这个更简单的解决方案，它也保持光标位置：

```
command -range=% RemoveTrailingWhitespace <line1>,<line2>s/\(\s\| \)\+$// | norm! ``
command -range=% RT                       <line1>,<line2>RemoveTrailingWhitespace 
```

感谢@Kent 的建议！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-20T11:28:17.260

```
command! TrimAllWhitespace %s/\s\+$// 
```**

# html - CSS中的相对和绝对定位？

> ID：16164519
> 
> 赞同：-1
> 
> 时间：2013-04-23T08:27:47.517
> 
> 标签：html, css

这是到目前为止的代码：http: [//jsfiddle.net/WJve3/3/](http://jsfiddle.net/WJve3/3/)

我如何制作`Object1`和`Object2`定位两者相对于“标题”？

我现在似乎遇到的问题`Object1`是相对于`title`和`Object2`相对于`Object1`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:33:41.360

你拼错了“位置”；并且您需要对 Object1 和 Object 2 使用静态定位。试试这个：

```
.title {
    position: absolute;
    top: 0%;
    left: 45%
}
.Object1 {
    position: absolute;
    top 0;
    left: 0;
}
.Object2 {
    position: absolute;
    top 0%;
    left: 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:35:38.177

你少了一个`</div>`

```
<DIV class="title">
    <h1><font face="Comic Sans MS" color=black><center>Title</center></font></h1>
    <DIV style="position: relative;"> 
        <DIV class="Object1">
            <h2><font face="Comic Sans MS" color=black><center>Object1</center></font></h2>
        </DIV>
        <DIV class="Object2">
            <h2><font face="Comic Sans MS" color=black><center>Object2</center></font></h2>
        </DIV> <!-- MISSING /DIV -->
    </DIV>
</DIV> 
```

并且拼错了“位置”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:41:26.357

您可以使用此 CSS 将对象放在 1 行

```
.title {
   margin: 0 auto;
   width: 300px;
}
.Object1 {
   float: left;
   width: 50%;
}
.Object2 {
   width: 50%;
   float: right;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T08:42:47.313

如果您需要彼此相邻的对象，则不需要位置：

```
 .title {
      position: absolute;
      top: 0%;
      left: 45%
    }
   .Object1 {
      float:left
    }
    .Object2 {
      float:left;
      margin-left:20px;
    } 
```

或者您可以给标题 div 一个相对位置，并给 object1 和 2 绝对定位。这样您就可以将对象放置在标题 div 中。

# list - List in Resource.XAML and access in ViewModel

> ID：16164521
> 
> 赞同：0
> 
> 时间：2013-04-23T08:27:49.143
> 
> 标签：list, xaml, viewmodel, application-resource

how to create a list in resources.xaml ( I will use it as itemsource for my listbox) and how can I access it in ViewModel? Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:57:05.390

这可能会有所帮助：[Silverlight：在 XAML 中声明数据集合？](https://stackoverflow.com/questions/4599066/silverlight-declaring-a-collection-of-data-in-xaml)

然后，您可以使用声明集合的控件的 Resources 属性来访问它。

编辑例如：

你需要声明一个新的集合类型，因为你不能在 XAML 中声明一个泛型类型：

```
using System.Collections.Generic;

namespace YourNamepace
{
    public class Genders : List<string>
    {
    }
} 
```

然后，在添加必要的命名空间之后，在 XAML 中声明一个列表：

```
xmlns:local="clr-namespace:YourNamespace"
xmlns:sys="clr-namespace:System;assembly=mscorlib"
...
<Window.Resources>
    <local:Genders x:Key="AvailableGenders">
        <sys:String>Female</sys:String>
        <sys:String>Male</sys:String>
    </local:Genders>
</Window.Resources> 
```

您当然可以在内部使用更复杂的数据结构来声明它。然后，将其用作您的 ListBox 的 ItemsSource：

```
<ListBox ItemsSource="{Binding Source={StaticResource AvailableGenders}}"/> 
```

那行得通，我刚刚测试过:-)

# hadoop - Hadoop Map Reduce queries for large key spaces

> ID：16164534
> 
> 赞同：0
> 
> 时间：2013-04-23T08:28:40.950
> 
> 标签：hadoop, mapreduce

I need to process one billion of records periodically. The unique keys can be in range of 10 millions. Value is string with maximum 200K chars.

Here are my questions:

1.  Is the key space very large (10 millions). Would Hadoop be able to handle such a large key space? There will be one reducer per key, so there will be millions of reducers.

2.  I want to update the DB in the reducer itself. In the reducer, I will merge the values (say it current value), read existing value from DB (say it existing value), merge current and existing value and update the DB. Is this a right strategy?

3.  How many reducers can run per box simultaneously? Is it configurable? If only a single reducer runs per box at a time, it will be problem, as I won't be able to update the state for keys in DB very fast.

4.  I want the job to get completed in 2-3 hours. How many boxes would I need ( I can spare max 50 boxes - 64 GB RAM, 8 Core machines)

Thanks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T19:17:39.397

回答您的问题：

一个。您对减速器之间的键值分布有错误的概念。reducer 的数量不等于唯一映射器输出键的数量。这个概念是 - 与映射器中的键关联的所有值都转到单个减速器。这绝不意味着 reducer 只会得到一个键。

例如，考虑以下映射器输出：

```
Mapper(k1,v1), Mapper(k1,v2), Mapper(k1,v3)
Mapper(k2,w1), Mapper(k2,w2)
Mapper(k3,u1), Mapper(k3,u2), Mapper(k3,u3), Mapper(k3,u4) 
```

因此，与*k1 - v1,v2*和*v3*相关的值将进入单个减速器，例如*R1*，它不会被拆分为多个减速器。但这并不意味着 R1 将只有 1 个密钥*k1*来处理。它也可能具有*k2*或*k3*的值。但是对于 reducer 接收到的任何 key，与该 key 关联的所有值都将来自同一个 reducer。希望它能消除你的疑问。

湾。您使用的是哪个数据库？要减少 DB 调用或更新语句，您可以在完成与特定键相关的值的循环后，在 reducer() 末尾进行查询。

例如：

```
public static class ReduceJob extends MapReduceBase implements Reducer<Text, Text, Text, Text> {

        @Override
        public synchronized void reduce(Text key, Iterator<Text> values, OutputCollector<Text, Text> output,
                Reporter reporter) throws IOException {

            while (values.hasNext()) {
                      // looping through the values
            }
            // have your DB update etc. query here to reduce DB calls
      }
} 
```

C。是的，reducer 的数量是可配置的。如果要根据作业设置它，可以在作业代码 run() 方法中添加一行来设置减速器的数量。

```
jobConf.set("mapred.reduce.tasks", numReducers) 
```

如果你想在每台机器的基础上设置它，即集群中每台机器应该有多少个reducer，那么你需要将集群的hadoop配置更改为：

> mapred.tasktracker.{map|reduce}.tasks.maximum - MapReduce 任务的最大数量，这些任务分别在给定的 TaskTracker 上同时运行。默认为 2（2 个 map 和 2 个 reduce），但会根据您的硬件而有所不同。

更多细节在这里：[http ://hadoop.apache.org/docs/stable/cluster_setup.html#Configuring+the+Hadoop+Daemons](http://hadoop.apache.org/docs/stable/cluster_setup.html#Configuring+the+Hadoop+Daemons)

d。如果您的数据文件不是 gZipped（hadoop InputSplit 不适用于 gZipped 文件），那么按照您所说的，您大约有 200 * 1024 * 10 亿字节 = 204800 GB 或 204.800 TB 数据，所以如果你想得到它在 2-3 小时内完成，最好保留所有 50 个盒子，如果减速器的内存占用低，则根据最后一个答案增加每台机器的减速器数量。此外，将 InputSplit 大小增加到 128MB 左右可能会有所帮助。

谢谢并恭祝安康。
卡蒂克亚·辛哈

# encoding - Convert number into 7 bit words with 96 states max

> ID：16164538
> 
> 赞同：1
> 
> 时间：2013-04-23T08:28:45.977
> 
> 标签：encoding, binary, bit

I would like to encode some information in Code128 barcodes which allow 96 different characters to be used in one slot. Therefore, `95` decimal would translate to `101 1111b` and `96` to `1 000 0000b`.

Now I need an algorithm that converts a decimal (or binary) number into 7 bit words with 96 states at maximum. I sat here all morning trying to figure that algorithm out (playing with bit shifts and logarithms), but it seems that I'm missing some important point here.

How would I translate, for example, `537` (`10 0001 1001b`) into such words?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T12:25:40.377

在玩了一些数字之后，我终于找到了解决方案。对于`883.736`：

```
883.736 / 96 = 9.205 R: 56
  9.205 / 96 =    95 R: 85
     95 / 96 =     0 R: 95 
```

这些数字可以转换为 7 位字。获取原始值：

```
883.736 = 56 * 96^0 + 85 * 96^1 + 95 * 96^2 
```

**用 C# 表示的算法（小端）：**

```
public static class Base96
{
  private const int BASE = 96;

  public static byte[] Encode(int number)
  {
    var list = new List<Byte>();

    do
    {
      list.Add((byte)(number % BASE));
    }
    while ((number = (number / BASE)) > 0);

    return list.ToArray();
  }

  public static int Decode(byte[] words)
  {
    int result = 0;

    for (int i = 0; i < words.Length; i++)
    {
      result += (words[i] * (int)Math.Pow(BASE, i));
    }

    return result;
  }

} 
```

像这样调用：

```
var encoded = Base96.Encode(883736);
var decoded = Base96.Decode(encoded); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-08-04T15:00:36.257

将任意二进制数据编码为具有大约 96 个不同字母的字母序列通常称为[二进制到文本编码或 ASCII 装甲](http://en.wikipedia.org/wiki/binary-to-text_encoding)。

当您的“二进制”输入字节流是“短”并且可能具有 256 个可能字节中的任何一个，但主要是 ASCII 文本（字母、数字）时，让字母和数字代表自己是最紧凑的（1 个输入字节到 1输出字母），为超出该范围的字节保留一个或四个“转义”符号（将 1 个“异常字节”扩展为 3 或 2 个输出字母），如[百分比编码](http://en.wikipedia.org/wiki/percent-encoding)或[带引号的可打印](http://en.wikipedia.org/wiki/quoted-printable)编码。

当您的二进制输入字节流对于所有 256 个可能的字节具有或多或少相等的频率（即，流已被加密或压缩或两者兼而有之）时，使用某种[基本转换算法](http://en.wikipedia.org/wiki/base_conversion)（例如十六进制（扩展每个八位字节为 2 个十六进制数字）或[base32](https://en.wikipedia.org/wiki/Base32)（将 5 个八位字节扩展为 8 个 base32 数字）或[base64url](http://en.wikipedia.org/wiki/base64#URL_applications)（将 3 个八位字节扩展为 4 个 base64 数字）或[Z85](http://en.wikipedia.org/wiki/Ascii85#ZeroMQ_Version_.28Z85.29)（将 4 个八位字节扩展为 5 个 base85 数字）或[baseE91](http://base91.sourceforge.net/)或[base95](http://www.icerealm.org/FTR/?s=docs&p=base95)。

当您的二进制输入字节流具有不相等的频率（例如主要包含 ASCII 文本）或重复，并且“足够长”时，首先压缩它是最紧凑的（可能使用[LZ4](http://en.wikipedia.org/wiki/LZ4_(compression_algorithm))或[LZO](http://en.wikipedia.org/wiki/Lempel%E2%80%93Ziv%E2%80%93Oberhumer)或 DEFLATE 或[LZRW1-A](http://en.wikibooks.org/wiki/Data_Compression/Dictionary_compression#LZSS_and_LZRW1-A)），创建一个大致相等频率的压缩字节流，然后如上所述对该字节流进行编码。

# google-app-engine - Change Global isolation level in google clould SQL

> ID：16164540
> 
> 赞同：4
> 
> 时间：2013-04-23T08:28:52.463
> 
> 标签：google-app-engine, google-cloud-sql

I need to change the isolation level in the google cloud SQL , I searched a lot , but could not find it any where When i did

SET GLOBAL TRANSACTION ISOLATION LEVEL READ COMMITTED

It gets changed , but only for that session and not for global , ie all other subsequent are not changed.

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-16T11:41:20.537

每次实例预热时，都会重置 ISOLATION LEVEL。所以现在唯一的选择是每次创建连接时设置它

# ruby-on-rails - 从现有的 mysql 表在 rails 中创建迁移文件

> ID：16164542
> 
> 赞同：10
> 
> 时间：2013-04-23T08:28:55.403
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我正在开发 Rails 中的应用程序。我在mysql中创建了一个表说“学生”。无论如何要在rails应用程序中创建它的迁移文件吗？我在 config/database.yml" 中指定了数据库名称并使用其他表。但我想创建表迁移文件。我该怎么做？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-04-23T09:04:14.463

*   首先在 database.yml 中引用您现有的 MySQL 数据库
*   运行`rake db:schema:dump`以生成*schema.rb*文件
*   *将schema.rb*`create_table`中的方法粘贴到新的迁移中，瞧！

# jsf - JSF 生成的错误 url

> ID：16164543
> 
> 赞同：1
> 
> 时间：2013-04-23T08:28:58.297
> 
> 标签：jsf, jsf-2

在我的 style.css 文件中，我`#{resource}`用来生成图像的 url。问题是有时这些 url 生成不正确。例如，我使用它`background: url("#{resource['default:img/contact/contact.png']};") #cd4c0a no-repeat`来生成背景图像。在大多数情况下，url 生成正确，看起来像这样`background: url("/javax.faces.resource/img/contact/contact.png.xhtml?ln=default") #cd4c0a`，但有时 url 是空的，看起来像这样`url("")`。有任何想法吗？

**[编辑]**

我的应用程序在 openshift (openshift.redhat.com) 服务器上运行并使用 Tomcat 7 (JBoss EWS 2.0)。

# javascript - Javascript Object-like-string to Object

> ID：16164546
> 
> 赞同：3
> 
> 时间：2013-04-23T08:29:03.780
> 
> 标签：javascript, object, eval

我将验证规则存储在 HTML 属性中。

字符串文字中的验证规则如下所示：

```
'{required:true, minlength:2, maxlength:100}' 
```

要将其转换为我可以使用的 javascript 对象`eval(string_literal)`

然而，`eval`是……不愉快。

是否有替代使用 eval 将*字符串等对象转换为对象*的*替代*方法？

一个限制是我不能使用 JSON。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T08:32:53.087

使用*来自您信任的来源的控制良好的数据*`eval`很好。解析器的启动成本在最坏的情况下可以忽略不计。自然，使用来自您*不*信任的来源的控制不佳的数据是一个坏主意^(tm)。*`eval`*

 **如果你不使用`eval`，恐怕没有真正的捷径，你必须自己解析字符串。如果它真的只是一个简单的列表，那么`split`使用正则表达式的几个调用就可以完成，不需要完整的解析器。

快速即用示例（[实时副本](http://jsbin.com/ecaqeg/1)|[来源](http://jsbin.com/ecaqeg/1/edit)）：

```
(function() {

  var data = '{required:true, minlength:2, maxlength:100}';
  var entries, index, entry, parts;

  entries = data.substring(1, data.length - 2).split(/, ?/);

  for (index = 0; index < entries.length; ++index) {
    entry = entries[index];
    parts = entry.split(/: ?/);
    display("Key '" + parts[0] + "', value '" + parts[1] + "'");
  }

  function display(msg) {
    var p = document.createElement('p');
    p.innerHTML = String(msg);
    document.body.appendChild(p);
  }

})(); 
```

当然，这充满了假设（最值得注意的是，值永远不会是包含逗号或冒号的字符串），但同样，如果数据足够简单，您可以避免使用完整的解析器。**

# vim - main_syntax是什么意思

> ID：16164549
> 
> 赞同：7
> 
> 时间：2013-04-23T08:29:15.350
> 
> 标签：vim

我正在编写一个 vim 语法文件。我发现`main_syntax`在几个现有的语法文件中使用了一个名为的变量。但我找不到任何解释它的文档。

本[文档](http://vimdoc.sourceforge.net/htmldoc/usr_44.html#44.12)仅描述了另一个变量 ，`b:current_syntax`它用于告诉另一个脚本当前的语法是什么。

貌似`main_syntax`有同样的意思。它是一个遗留变量吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T14:28:46.427

一些语法脚本支持通过 导入到另一种语法中`:syntax include`，例如*html*中的*javascript*。

 *该`main_syntax`变量跟踪用户/文件类型实际设置的语法；包含语法脚本然后在设置此变量时忽略现有语法项的清除。（而如果设置了语法脚本，则应该`:finish`没有任何操作`b:current_syntax`。）另一个区别`b:current_syntax`是`main_syntax`仅在实际语法加载过程中定义，而另一个则持续存在。

TL;DR：如果您自己支持包含/包含其他语法，请从现有语法中复制条件样板，例如`$VIMRUNTIME/syntax/html.vim`；如果没有，你可以忽略这个。*

# c - c printf("%x"), 它打印什么？

> ID：16164554
> 
> 赞同：5
> 
> 时间：2013-04-23T08:29:38.910
> 
> 标签：c, gdb

我在 c: 中键入此代码`__asm__("mov $10, %rsi"); printf("%x")`，它打印`a`。
我在调试它`gdb`，发现结果存储在 int`register esi`中。
**问题**：为什么结果是`esi`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-23T08:31:11.083

`printf("%x")`试图获得第二个参数，但它不存在，所以它只是读取它应该存在的内存，找到那里的任何垃圾，然后打印它。

简而言之：它是未定义的行为。

**编辑：**您看到与寄存器中的值相同的原因`esi`是因为[System V AMD64 ABI](https://en.wikipedia.org/wiki/X86_calling_conventions#System_V_AMD64_ABI)（这是大多数 Unix 遵循的规范）尽可能通过寄存器传递前几个参数。第二个参数是通过 传递的`rsi`，因此这`printf`就是读取的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T08:36:22.737

调用`printf("%x")`时，它需要的参数被推送到堆栈（以相反的顺序），最终，使用汇编命令调用该函数`call`。提供格式字符串`"%x"`时，`printf()`至少需要一个参数，因此它将读取堆栈上的下一个值，可以是任何值......
所以这种行为实际上是未定义的，通常是漏洞的原因，因为你可能会破坏堆栈.

也许关于这个话题的一些[交流。](http://en.wikipedia.org/wiki/Format_string_attack)

# svg - 剪辑路径并在“g”标签中翻译 svg

> ID：16164565
> 
> 赞同：1
> 
> 时间：2013-04-23T08:30:21.770
> 
> 标签：svg, jquery-svg

我已经对我们的图表系列进行了分组，并在 svg 中使用了裁剪概念和转换逻辑

请参考下面的剪辑路径。它指的是图表区域。

```
<defs><clipPath id="container_svg_ChartAreaClip"><rect id="container_svg_ChartAreaClipRect" x="65" y="46" width="715" height="428" fill="white" stroke-width="1" stroke="Gray"/></clipPath></defs> 
```

请参考以下组：

```
<g clip-path="url(#container_svg_ChartAreaClip)" id="container_svg_SeriesCollection" transform="translate(65,474)"><path id="container_svg_John_0" fill="none" stroke-width="2" stroke="#AFB117" stroke-linecap="butt" stroke-linejoin="round" d="M 62.307142857141926 -0.09416 L 53.11428571428618 -0.5136 M 53.11428571428618 -0.5136 L 71.5 -0.27392 M 71.5 -0.27392 L 81.71428571428571 -0.9416000000000001 M 81.71428571428571 -0.9416000000000001 L 91.92857142857142 -2.0115999999999996 M 91.92857142857142 -2.0115999999999996 L 102.14285714285714 -3.15864 M 102.14285714285714 -3.15864 L 112.35714285714286 -5.478400000000001 M 112.35714285714286 -5.478400000000001 L 122.57142857142857 -8.602799999999998 M 122.57142857142857 -8.602799999999998 L 132.78571428571428 -12.292159999999999 M 132.78571428571428 -12.292159999999999 L 143 -17.659280000000003 M 143 -17.659280000000003 L 153.2142857142857 -26.16792 M 153.2142857142857 -26.16792 L 163.42857142857142 -39.530080000000005 M 163.42857142857142 -39.530080000000005 L 173.64285714285714 -55.16064 M 173.64285714285714 -55.16064 L 183.85714285714283 -84.07632 M 183.85714285714283 -84.07632 L 531.1428571428571 -126.59384 M 531.1428571428571 -126.59384 L 541.3571428571429 -115.92808 M 541.3571428571429 -115.92808 L 551.5714285714286 -109.62792000000002 M 551.5714285714286 -109.62792000000002 L 561.7857142857142 -103.61023999999999 M 561.7857142857142 -103.61023999999999 L 572 -94.98176000000001 M 572 -94.98176000000001 L 582.2142857142857 -87.57736 M 582.2142857142857 -87.57736 L 592.4285714285714 -86.8412 M 592.4285714285714 -86.8412 L 602.6428571428571 -86.38752000000001 M 602.6428571428571 -86.38752000000001 L 623.0714285714286 -92.33672 M 623.0714285714286 -92.33672 L 633.2857142857142 -93.23552 M 633.2857142857142 -93.23552 L 643.5 -88.58744 M 643.5 -88.58744 L 653.7142857142857 -87.60304000000001 M 653.7142857142857 -87.60304000000001 L 194.07142857142856 -132.40608 M 194.07142857142856 -132.40608 L 204.28571428571428 -174.13608 M 204.28571428571428 -174.13608 L 214.5 -206.51856 M 214.5 -206.51856 L 224.71428571428572 -234.43272 M 224.71428571428572 -234.43272 L 234.92857142857142 -252.16904000000002 M 234.92857142857142 -252.16904000000002 L 245.14285714285714 -265.83936 M 245.14285714285714 -265.83936 L 255.35714285714286 -274.2624 M 255.35714285714286 -274.2624 L 265.57142857142856 -267.35448 M 265.57142857142856 -267.35448 L 275.7857142857143 -267.26888 M 275.7857142857143 -267.26888 L 286 -250.15744 M 286 -250.15744 L 296.2142857142857 -234.04752 M 296.2142857142857 -234.04752 L 306.4285714285714 -228.22671999999997 M 306.4285714285714 -228.22671999999997 L 316.6428571428571 -230.70912000000004 M 316.6428571428571 -230.70912000000004 L 326.85714285714283 -238.92672 M 326.85714285714283 -238.92672 L 337.07142857142856 -248.23143999999996 M 337.07142857142856 -248.23143999999996 L 347.2857142857143 -247.9404 M 347.2857142857143 -247.9404 L 357.5 -238.19056 M 357.5 -238.19056 L 367.71428571428567 -218.95624 M 367.71428571428567 -218.95624 L 377.92857142857144 -220.18032 M 377.92857142857144 -220.18032 L 388.1428571428571 -206.58704 M 388.1428571428571 -206.58704 L 398.3571428571429 -208.3932 M 398.3571428571429 -208.3932 L 408.57142857142856 -210.29352 M 408.57142857142856 -210.29352 L 418.78571428571433 -196.98272 M 418.78571428571433 -196.98272 L 429 -198.72039999999998 M 429 -198.72039999999998 L 439.2142857142857 -205.62832 M 439.2142857142857 -205.62832 L 449.42857142857144 -209.31768 M 449.42857142857144 -209.31768 L 459.64285714285717 -210.67871999999997 M 459.64285714285717 -210.67871999999997 L 500.49999999999994 -195.99831999999998 M 500.49999999999994 -195.99831999999998 L 510.7142857142857 -186.02591999999999 "/><path id="container_svg_Andrew_1" fill="none" stroke-width="2" stroke="#479735" stroke-linecap="butt" stroke-linejoin="round" d="M 102.14285714285714 -4.28 L 112.35714285714286 -2.14 M 112.35714285714286 -2.14 L 122.57142857142857 -4.28 M 122.57142857142857 -4.28 L 132.78571428571428 -1.0272 M 132.78571428571428 -1.0272 L 143 -1.284 M 143 -1.284 L 153.2142857142857 -1.712 M 153.2142857142857 -1.712 L 163.42857142857142 -3.64656 M 163.42857142857142 -3.64656 L 173.64285714285714 -13.738799999999998 M 173.64285714285714 -13.738799999999998 L 183.85714285714283 -7.4386399999999995 M 183.85714285714283 -7.4386399999999995 L 194.07142857142856 -9.0736 M 194.07142857142856 -9.0736 L 204.28571428571428 -26.16792 M 204.28571428571428 -26.16792 L 214.5 -21.15176 M 214.5 -21.15176 L 224.71428571428572 -28.43632 M 224.71428571428572 -28.43632 L 234.92857142857142 -36.27728 M 234.92857142857142 -36.27728 L 245.14285714285714 -44.69176 M 245.14285714285714 -44.69176 L 255.35714285714286 -52.46424 M 255.35714285714286 -52.46424 L 265.57142857142856 -60.68184000000001 M 265.57142857142856 -60.68184000000001 L 275.7857142857143 -71.38184000000001 M 275.7857142857143 -71.38184000000001 L 286 -80.45544 M 286 -80.45544 L 296.2142857142857 -90.20528 M 296.2142857142857 -90.20528 L 306.4285714285714 -99.66408 M 306.4285714285714 -99.66408 L 316.6428571428571 -112.06752 M 316.6428571428571 -112.06752 L 326.85714285714283 -123.93168 M 326.85714285714283 -123.93168 L 337.07142857142856 -136.23239999999998 M 337.07142857142856 -136.23239999999998 L 347.2857142857143 -148.81560000000002 M 347.2857142857143 -148.81560000000002 L 357.5 -163.11079999999998 M 357.5 -163.11079999999998 L 367.71428571428567 -197.25664 M 367.71428571428567 -197.25664 L 377.92857142857144 -217.36408 M 377.92857142857144 -217.36408 L 388.1428571428571 -239.12359999999998 M 388.1428571428571 -239.12359999999998 L 398.3571428571429 -257.33072 M 398.3571428571429 -257.33072 L 408.57142857142856 -274.33944 M 408.57142857142856 -274.33944 L 418.78571428571433 -290.62912 M 418.78571428571433 -290.62912 L 429 -306.48224000000005 M 429 -306.48224000000005 L 480.07142857142856 -350.96 M 480.07142857142856 -350.96 L 531.1428571428571 -265.36 M 531.1428571428571 -265.36 L 541.3571428571429 -248.71079999999998 M 541.3571428571429 -248.71079999999998 L 551.5714285714286 -214 M 551.5714285714286 -214 L 561.7857142857142 -205.44 M 561.7857142857142 -205.44 L 572 -196.88 M 572 -196.88 L 582.2142857142857 -188.32 M 582.2142857142857 -188.32 L 592.4285714285714 -179.76 M 592.4285714285714 -179.76 L 602.6428571428571 -171.20000000000002 M 602.6428571428571 -171.20000000000002 L 623.0714285714286 -162.64000000000001 M 623.0714285714286 -162.64000000000001 L 633.2857142857142 -154.07999999999998 M 633.2857142857142 -154.07999999999998 L 643.5 -154.07999999999998 M 643.5 -154.07999999999998 L 653.7142857142857 -145.52 "/></g> 
```

它将显示空白图表区域，而不是在图表区域中显示折线图。当我删除剪辑路径工作正常（即它显示图表）但剪辑路径ID和矩形值是正确的。我在“g”标签中提到了正确的剪辑路径。

我的问题是当我翻译“g”标签时，我无法使用“clip-path”概念。为什么 ？当我单独使用剪辑路径时，它可以正常工作，但是当我同时使用两者时，它不会显示图表。

请参考下面的 SVG 截图。空图表

![在此处输入图像描述](https://i.stack.imgur.com/2pMSX.png)

请提供正确的方向，而不是像剪辑路径那样更新错误？我知道剪辑路径是正确的。

谢谢，

湿婆

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T09:52:06.410

你的元素与你使用它的元素`clip-path`相同。`g`看来您已经为目标位置设计了剪辑路径。如果你这样做，你必须`g`用它的逆来抵消元素上的变换，这样两个变换的连接就变成了恒等变换。

`clip-path`具体来说，将您的定义更改为

```
 <clipPath id="container_svg_ChartAreaClip" transform="translate(-65,-474)">
        <rect id="container_svg_ChartAreaClipRect" x="65" y="46" width="715" height="428" fill="white" stroke-width="1" stroke="Gray"/>
    </clipPath> 
```

# twitter-bootstrap - section links with ember.js

> ID：16164566
> 
> 赞同：4
> 
> 时间：2013-04-23T08:30:24.077
> 
> 标签：twitter-bootstrap, ember.js, ember-router

I'm trying to include the [bootstrap scrollspy](http://twitter.github.io/bootstrap/javascript.html#scrollspy) in my ember app.

The scrollspy needs `href="#section1"` to do it's work, which is obviously confusing the router. That is giving me javascript errors like `Uncaught Error: No route matched the URL 'section1'`, and breaking the scrollspy I believe. The last element is always selected.

Has somebody else managed to get this going? Is there a way to tell the router not to worry about this view?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-31T01:35:48.243

这不是 ScrollSpy 的问题，而是 Ember 路由器的问题[http://discuss.emberjs.com/t/handle-incoming-links-with/4839](http://discuss.emberjs.com/t/handle-incoming-links-with/4839)

也许您可以隔离问题以确认？在 Ember 中使用常规的旧哈希链接进行测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-28T14:25:23.250

> “这不是 ScrollSpy 的问题，而是 Ember 路由器的问题”。--@elise-chant

问题在于，Ember 的核心依赖于破解 url 中的哈希 ('#') 并将其用于自己的目的。不支持这样的网址 - [http://example.com/#/about#faq](http://example.com/#/about#faq)

@elise-chant 的回复将我引向了[核心问题](https://github.com/emberjs/ember.js/issues/4098)，我现在很高兴地报告，从 Ember 1.9.0 开始，支持具有多个哈希 ('#') 的 url。

杰伊菲尔普斯提供了修复，最近有这样的说法：

* * *

> 我们可以看到它[[Fix #4098]](https://github.com/emberjs/ember.js/issues/4098)登陆了稳定的 v1.9.0 版本。
> 
> 不过，目前还没有任何代码可以将页面实际滚动到 id="anchor" 。所做的更改是为了允许这种代码发生。我已经与一些核心成员讨论过这样的实现，并且仍计划尝试将其添加到核心中，但与此同时，您绝对可以使用 >=1.9.0 并添加自己的代码来这样做，这应该是公平的对于简单的情况，直截了当：
> 
> 像这样但完全未经测试的东西：

```
didTransition: function () {   
 Ember.run.schedule('afterRender', this,
 function () {
     if (window.location.hash) {
       var el = document.getElementById(window.location.hash.substr(1));
       if (el) {
         el.scrollIntoView();
       }
     }   
   }); 
 } 
```

> 当我找到可以解决此问题的周期时，我将提供一个可行的示例，但是如果可以的话，我建议您继续努力。

我个人热衷于让人们尝试一下，并在这里报告你的进展情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T10:57:51.480

您应该能够使用 data-target 而不是 href 与 scrollspy。

```
data-target="#section1" 
```

# api - 如何使用 C#.NET 访问谷歌分析 api？

> ID：16164570
> 
> 赞同：1
> 
> 时间：2013-04-23T08:30:36.973
> 
> 标签：api, google-analytics, google-analytics-api

我已经在 Google-Analytics 注册了我的网站，现在我想用 C#.NET 获取所有访问资源并将它们显示在我的网页上，我什至从 google 下载了 SDK，但在其中找不到任何示例。有经验的人可以帮助我吗？谢谢！

# javascript - jQuery alert on unload except when save button is clicked

> ID：16164571
> 
> 赞同：0
> 
> 时间：2013-04-23T08:30:37.440
> 
> 标签：javascript, jquery, bbcode

I have a textbox and I want it to show an alert when leaving the page with unsaved changes, except if you click the submit button. This works great, except it still alerts you if the submit button is pressed and I really have no idea how to fix it.

I have 2 files, my Set.js to take the actions of the BBcode, and my script.js

script.js

```
$(document).ready(function() {
    var saveClicked = false;

    $(window).bind('beforeunload', function() {
        if(y != $("#markItUp").val()) {
            if(!saveClicked) {          
                return 'You have unsaved changes!';
            }
        }
    });
}); 
```

Set.js

```
{
    name: 'Save',
    className:"miu-save",
    call: function() {
        $('form#edit').submit(); 
        saveClicked = true;
    }
}, 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T07:19:49.850

改变这个

```
{
    name: 'Save',
    className:"miu-save",
    call: function() {
        $('form#edit').submit(); 
        saveClicked = true;
    }
}, 
```

至

```
{
    name: 'Save',
    className:"miu-save",
    call: function() {
        saveClicked = true; // true is called first here if you notice and then submit
        $('form#edit').submit(); 
    }
}, 
```

这也是必要的

```
var saveClicked = false;
$(document).ready(function(){ 
```

在 document.ready 函数之外声明你 saveClicked var

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:40:50.223

把你的`saveClicked`外面`document.ready`。这样它将是全局的，然后只有一个人可以将其值设置为`true`or `false`。

所以你的脚本应该是这样的：

```
 var saveClicked = false;
  $(document).ready(function(){

$(window).bind('beforeunload', function(){
   if(y != $("#markItUp").val()){
     if(!saveClicked){           
   return 'You have unsaved changes!';
  }}
 });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:36:22.787

我不确定这会起作用，但也许如果你从做开始

```
saveClicked = true; 
```

然后**才**做

```
$('form#edit').submit(); 
```

这样就可以了。

# mysql - Select a sequence between two numbers on MySQL

> ID：16164573
> 
> 赞同：6
> 
> 时间：2013-04-23T08:30:41.067
> 
> 标签：mysql, sql, date, sql-view

I have this table named `people` with two dates on MySQL:

```
| Name | start_date | end_date   |
| John | 2007-03-01 | 2009-10-12 |
| Mike | 2001-06-06 | 2010-12-01 | 
```

I want to create a view that lets me search by activity year, being *activity year* any year between the `start_date` and the `end_date`. So, I'd like to get a field with a sequence of years, like this:

```
| Name | activity_years                                    |
| John | 2007,2008,2009                                    |
| Mike | 2001,2002,2003,2004,2005,2006,2007,2008,2009,2010 | 
```

I've tried some approaches, but I can't get it. Since I want to create a view, I have to do it everything inside a SELECT statement and that is giving me some headache.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T08:40:05.553

这样的事情应该这样做： -

```
SELECT a.Name, GROUP_CONCAT(YEAR(DATE_ADD(a.start_date, INTERVAL b.aNum YEAR))) AS activity_years  
FROM person a
CROSS JOIN (SELECT a.i + b.i * 10 AS aNum FROM integers a, integers b) b
WHERE YEAR(DATE_ADD(a.start_date, INTERVAL b.aNum YEAR)) <= YEAR(a.end_date)
GROUP BY a.Name 
```

它依赖于一个整数表，其中有一列名为 i，其值为 0 到 9。它将它与自身连接起来以获得从 0 到 99 的数字范围，因此可以处理相距很远的日期范围。

删除子选择以在视图中使用它

```
SELECT p.Name, GROUP_CONCAT(YEAR(DATE_ADD(p.start_date, INTERVAL (a.i + b.i * 10) YEAR))) AS activity_years  
FROM person p
CROSS JOIN integers a
CROSS JOIN integers b
WHERE YEAR(DATE_ADD(p.start_date, INTERVAL (a.i + b.i * 10) YEAR)) <= YEAR(p.end_date)
GROUP BY p.Name 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T08:55:43.497

[SQLFiddle 演示](http://sqlfiddle.com/#!2/c8616/8)

```
select name,
       group_concat(tYears.row ORDER BY tYears.row)
  from people

join

(
SELECT @row := @row + 1 as row FROM 
(select 0 union all select 1 union all select 3 union all select 4 union all 
  select 5 union all select 6 union all select 6 union all select 7) t,
(select 0 union all select 1 union all select 3 union all select 4 union all 
  select 5 union all select 6 union all select 6 union all select 7) t2, 
(select 0 union all select 1 union all select 3 union all select 4 union all 
  select 5 union all select 6 union all select 6 union all select 7) t3, 

(SELECT @row:=1900) t21
) tYears

on tYears.row between year(start_date) and year(end_date)
group by name 
```

# mysql - EAV 和数据类型

> ID：16164574
> 
> 赞同：0
> 
> 时间：2013-04-23T08:30:52.867
> 
> 标签：mysql, entity-attribute-value

我们将在一个场景中使用 EAV 模式，其中我们将拥有具有非常不同属性的各种不同实体。

“基本” EAV 模式由 3 个表组成。由于不同的属性将具有不同的数据类型（日期、长整数、布尔值......），我目前正在考虑如何解决这个问题。

第一种方法是将所有内容存储为字符串。这需要“解析”，如果这是一个双精度、布尔值或任何东西，则不会直接显示像“1”这样的数字。属性值表看起来像

```
id|attribute_id|entity_id|value
1  2            3         17.0
2  4            2         Foobar 
```

第二种方法是将不同的类型分成不同的列，使值列可以为空，例如：

```
id|attribute_id|entity_id|value_string|value_long|value_float|value_date
1  2            3         NULL         NULL       17.0        NULL
2  4            2         Foobar       NULL       NULL        NULL 
```

然而，这会产生很多 NULL 值，这基本上就是为什么决定导致 EAV 模式的原因（减少未使用列中的 NULL 值）

因此，这导致了第三种可能的解决方案，即创建类型化的属性表：

```
attribute_values_string
id|attribute_id|entity_id|value
2  4            2         Foobar

attribute_values_float
id|attribute_id|entity_id|value
1  2            3         17.0 
```

但是，这会使查询更加复杂，因为必须始终`n`检查表是否存在`attribute_value`. `attribute_ids`如果所有人都使用自己的auto_increment，那么像这样使用它也会导致不同的值类型相等。因此，将一个值转换为另一种类型可能有些棘手，因为它`id`无法维护。当然，这可以通过添加另一个`attribute_values`服务于 auto_increment 值并且可能包含一些类型信息和/或元数据的非类型表来避免。（因为我们需要使用版本控制/修订我们不能使用自动生成的属性值_ids，因为两个修订版仍然需要共享相同的 id）

所以，第一个决定是布局。有人有使用 EAV*的*经验吗？每次尝试的瓶颈是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-01T08:15:30.803

使用 NULL 方法。其他查询通常需要更多资源。

SQL Server 2008 提供了一些可以提供帮助的稀疏列。

此外，我可以看到您错过了实体实体的 Instance_Id 列具有属性，然后该实体有很多实例。您需要将其与 GUID 链接

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-01T09:23:31.170

Fwiw，我对你的第一个模式和你的第二个模式的变体有很好的经验。（类型列、单个值列和适当表达式的部分索引，即转换数据。使用 MySQL 最接近的是您的第二个模式：您关心的每种类型的列。）

如果您计划在第二个模式上添加索引，请不要忘记区分 value_string（对于您希望索引的短字符串，例如枚举等）和 value_text（对于不应被索引的长文本）。

不过，从长远来看，我实际上建议第一个选项，并带有通常的警告和注意事项：EAV 表唯一合理的长期用例是如果结构未定义并且存储在其中的实际数据是装饰性的东西。这里的操作词是未定义的和装饰性的。任何时候您真正想要或需要查询 EAV 表中的一条数据时，您都应该问自己应该如何修改架构以适应新列。不这样做会导致查询缓慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:49:46.880

我理解您关于尝试减少 Null 值的观点，但是我相信 The [5 Normal forms](http://www.databasedesign-resource.com/normal-forms.html)总能解决这个问题。如果您的客户需要实时或按需添加属性，那么我同意 EAV 模型。

在我看到的许多其他问题中：

1.  属性名称难以控制，难以统一；
2.  难以强制执行数据类型完整性和引用完整性；
3.  旋转和/或自连接值以形成单行是困难的（而且速度很慢）；
4.  很难强制某些属性；

我一直在使用 Magento，它需要大量缓存和辅助表才能“正常”工作，当然，保持其运行的服务器必须是强大的服务器。也许您的应用程序要小得多。

不管怎样，这只是我的意见，你，狗鼻子，也可以检查一下[这个其他](https://stackoverflow.com/questions/4066463/should-i-use-eav-model)观点并做出自己的结论

# graph - How to detect the touch on a line drawn in drawrect?

> ID：16164577
> 
> 赞同：1
> 
> 时间：2013-04-23T08:30:58.677
> 
> 标签：graph, touch, drawrect

I'm preparing a graph plot application,and i need to detect the touch of the user on the drawn lines using drawRect() method and show an alert message to user with the values at that point. I have drawn the lines using NSBezierPath. Is there any way to detect the touch only on the lines ,not at any other places of screen?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-10T09:00:12.657

我认为唯一要做的就是检测绘制线的初始点和最终点并添加约束，以便 touch 不会提供除 line 之外的任何值。这可以使用矩形概念来完成，绘制的线将是矩形的对角线，我们可以根据矩形和它的对角线放置约束。

# php - 如何获取字符串的初始字符？

> ID：16164582
> 
> 赞同：6
> 
> 时间：2013-04-23T08:31:20.357
> 
> 标签：php, string

我正在尝试提取字符串的初始字符。我需要一些帮助来用 PHP 做这件事。

以下是我正在使用的一些示例字符串以及我需要的结果：

```
$String="Progress in Veterinary Science"; 
```

输出将是

```
// PIVS 
```

谢谢！

# javascript - is it possible to create Highchart polar chart which has x-axis at center rather than at circumference

> ID：16164584
> 
> 赞同：0
> 
> 时间：2013-04-23T08:31:38.897
> 
> 标签：javascript, highcharts

I'm trying to create a polar column chart. This chart has to show a stacked column. this was simple but the real thing is I'm getting the x-axis & labels for the polar chart outside the chart at its circumference, but I want them to be inside at the center. Is it achievable ?

Thanks for your time

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T13:01:46.437

这不是直接支持的，但可以实现。

我们需要为那个创建一个额外的假序列和轴。然后使用偏移我们可以将主轴移动到中心。最后一件事是计算 yAxis 的最小值，以确保列不会从内部开始。

```
$('#container').highcharts({
    series: [{
        data: [12,13,14,15,5,17]  
    }, {
        data: [13,15,4,12,14,16]   
    }, {
        data: [1,15,13,4,14,16]   
    },{
        data: [13,15,3,12,1,16]   
    },  {
        data: [null,null,null,null,null,null],
        xAxis: 1
    }],
    chart: {
        polar: true,
        type: 'column'
    },

    xAxis: [{
        offset: 120,
        tickInterval: 1,
        tickmarkPlacement: 'on'
    }, {
        lineWidth: 0,
        tickInterval: 1,
        labels: {
            enabled: false
        }
    }],

    yAxis: {
        min: -35,
        endOnTick: false,
        showLastLabel: true,
        title: {
            text: null
        },
        labels: {
            align: 'center',
            formatter: function () {
                if(this.value >= 0 ){
                    return this.value + '%';
                } else {
                    return '';
                }
            }
        }
    },
    plotOptions: {
        series: {
            stacking: 'normal',
        }
    }
}); 
```

给你的例子：http: [//jsfiddle.net/QgUgW/4/](http://jsfiddle.net/QgUgW/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:48:00.590

您可以使用偏移属性：[http ://api.highcharts.com/highcharts#xAxis.offset](http://api.highcharts.com/highcharts#xAxis.offset)

但这会导致图表混乱。极坐标图通常很混乱，因为它是..

# javascript - 在 HTTPS 中获取用户的地理位置

> ID：16164586
> 
> 赞同：0
> 
> 时间：2013-04-23T08:31:59.957
> 
> 标签：javascript, https, geolocation

如何获取在 Javascript 中查看我的 HTTPS（安全）站点的用户的位置？

或者我可以使用任何免费的基于 HTTPS 的 API 网络服务吗？

它禁用我的 javascript 来获取我的位置

# python - 删除 Django 数据库中的子对象

> ID：16164591
> 
> 赞同：1
> 
> 时间：2013-04-23T08:32:36.187
> 
> 标签：python, django, django-models

消费者和工人模型。Costumer 从 User 继承， Worker 从 Costumer 继承，当我这样做时

```
 worker.delete(), 
```

它将删除所有三个表中的所有相关对象，我该怎么办，它只会删除 Worker 表中的数据，其余表中的数据仍然存在（假设，一个客户不想再当工人了，但他仍然想要成为客户）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:59:06.973

我不认为有一种内置的方法可以将模型“降级”为超类，也没有将模型“提升”为子类。

如果您需要修改原始记录，而不是创建新记录，您可能必须使用[原始查询](https://docs.djangoproject.com/en/1.2/topics/db/sql/#executing-custom-sql-directly)，例如...

```
DELETE FROM <the_worker_table_name> WHERE id=<the_worker_object_id> 
```

...然后重新选择对象作为`Costumer`任何进一步处理的类型。

# jquery - jquery add html content to div from struts action class variable

> ID：16164593
> 
> 赞同：0
> 
> 时间：2013-04-23T08:32:43.573
> 
> 标签：jquery, struts2

I am trying to add HTML content into a div on page load. This HTML content is coming from a struts action class variable. I have tested that the I get the HTML content passed to the resultant jsp file but the problem is that I don't get how to add it inside a particular div from struts action class variable.

I want to append it to topcontblock div shown below:

```
<div class="main nobg">
<div class="topcontblock" id="contentBlock">
//my html content here
</div>
</div> 
```

I am really stuck on this. Any help would be greatly appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T10:03:40.450

您可以使用标签输出一个`Struts2` `Action`变量（及其提供的）：`Getter``<s:property />`

```
<s:property value="yourVariableName"/> 
```

默认情况下，出于安全原因，`HTML`变量中包含的标签在将其注入页面时会被转义（因此不会被评估）。为防止这种情况，您可以将属性修改`escapeHtml`为 false：

```
<s:property value="yourVariableName" escapeHtml="false" /> 
```

但是你应该停下来问问自己一个`Action`变量是否真的是你想要注入的片段的正确位置；最好在另一个 JSP 中定义它，并将其包含在`<s:include />`指令中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:36:23.207

您可以使用以下方法简单地添加它：

```
 $("div#contentBlock").html("here you can put your HTML code"); 
```

或者如果您将内容作为对象

```
 $("div#contentBlock").append($("<span>").addClass("your class")); 
```

# javascript - 'Infinite' Zoom Gallery – 有没有非 Flash (Java + HTML5 +CSS3) 的方式来实现这个效果？

> ID：16164595
> 
> 赞同：0
> 
> 时间：2013-04-23T08:32:47.423
> 
> 标签：javascript, jquery, html, flash, canvas

早上的快速问题。我遇到了这个法国网站，我真的很喜欢他们的投资组合页面上的效果：[http ://www.lasourissurlegateau.com/#/book/](http://www.lasourissurlegateau.com/#/book/)

就像您在放大项目而不是滚动一样。现在，据我所知，这是使用 Flash 实现的。有没有办法仅使用带有 CSS3 的 Javascript 和/或 HTML5 来实现类似的效果？

如果是这样，任何链接或教程将不胜感激！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T09:07:15.670

你可以试试[`impress.js`](http://bartaz.github.io/impress.js/#/step-3)

这看起来很有趣，似乎可以满足您的需求。

# xcode - NSFEtchrequest 的接口上没有可见声明选择器

> ID：16164599
> 
> 赞同：0
> 
> 时间：2013-04-23T08:32:53.913
> 
> 标签：xcode, interface, selector, visible

第一：对不起我的英语不好，我是法国人......

我正在尝试在我的 Xcode 应用程序上添加 2 个解析函数，但我总是遇到同样的错误：

> NSFEtchrequest 的接口上没有可见声明选择器

我在 .h 文件中添加了 NSFEtchRequest 信息：

```
 @interface TableViewControllerRSS : UITableViewController <UIApplicationDelegate> {
        //TableViewControllerRSS *newsRequest;
        NSMutableArray *allNews;
    @private NSManagedObjectModel *managedObjectModel_;
        NSManagedObjectContext *managedObjectContext_;
        NSPersistentStoreCoordinator *persistentStoreCoordinator_;
        NSManagedObject *managedObject_;
        NSFetchRequest *newsRequest;

@property (nonatomic, retain ) NSFetchRequest *newsRequest;

- (NSString *) dateConverter:(NSString *) dateToConvert; 
```

我在我的 .m 文件中添加了：

```
@synthesize newsRequest; 
```

我正在尝试更改我的 RSS 请求中的日期格式：

前 ： `cell.dateArt.text = [uneNews datepub];`

后 ： `cell.dateArt.text = [newsRequest dateConverter:[uneNews datepub]];`

但问题就在这里：当我调用 newsRequest dateConverter 函数时。

newsRequest 是我的 .m 文件中的 ViewDidLoad ：

```
newsRequest = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription entityForName:@"News" inManagedObjectContext:managedObjectContext_];
[newsRequest setEntity:entity]; 
```

我的 .m 文件中的日期转换器函数是：

```
- (NSString *) dateConverter:(NSString *) dateToConvert {

    NSDateFormatter *inputFormat = [[NSDateFormatter alloc] init];
    [inputFormat setDateFormat:@"eee', 'dd MMM yyyy HH:mm:ss '+0000'"];

    NSLocale *usLocale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US"];
    [inputFormat setLocale:usLocale];

    NSDate *formatterDate = [inputFormat dateFromString:dateToConvert];

    NSDateFormatter *outputFormat = [[NSDateFormatter alloc] init];
    [outputFormat setDateFormat:@"dd'/'MM/yy"];

    NSLocale *frLocale = [[NSLocale alloc] initWithLocaleIdentifier:@"fr_FR"];
    [outputFormat setLocale:frLocale];

    NSString *newDate = [outputFormat stringFromDate:formatterDate];

    return newDate;

} 
```

真的很难理解为什么我总是有这个错误！

顺便说一句：感谢每个人的阅读并最终希望提供帮助。

祝你有美好的一天问候马努

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:44:54.713

NSFetchRequest 没有将 " `dateConverter`" 方法定义为该类的一部分，除非您将其添加为类别的一部分。通过查看“ `dateConverter`”代码，我不明白为什么它应该成为您的“ `NSFetchRequest`”对象的一部分。

也许你想`dateConverter`在你的视图控制器上定义那个“”方法，或者在你的 NSFetchRequest 之外的一些其他对象上？

# java - 看不到java框架中的所有文本

> ID：16164602
> 
> 赞同：0
> 
> 时间：2013-04-23T08:33:05.567
> 
> 标签：java, swing, jpanel, frame, jscrollpane

我有一个无法解决的问题。我真的是编程新手。

主框架 (glavnoOkno) 正常打开。单击主框架上的按钮时，会打开新框架。而且您看不到其中的所有文本或文本框。可以进入屏幕宽度的那些，但其他的则不能。

我尝试了 .pack()，但没有用，然后我尝试了 ScrollPane()，但也没有用（可能是因为我不知道把它放在哪里:().. 无论如何，我的代码是在四个班级中。在这里我放了两个，我认为这很重要。如果我错了，我也可以放其他两个。变量都不是英文的，我希望这不是太大的问题。

所以……请帮忙。这是主框架的类。并且在底部定义了第二帧。

```
 import java.io.*;
    import java.awt.*;
    import java.awt.event.*;
    import javax.swing.*;

     public class GlavnoOkno extends JFrame implements ActionListener {
          private JLabel naslov;
      private JButton gumbVnesiEleganten;
      private JButton gumbKoncaj;
      private JPanel plosca;
      private JScrollPane zvitek = new JScrollPane();
      private JTextArea tekstnoOkno = new JTextArea();
      private Trgovina trgovina;

public void setTrgovina(Trgovina trgovina) {
    this.trgovina = trgovina;
}

public Trgovina getTrgovina() {
    return trgovina;
}

public JTextArea getTekstnoOkno() {
    return tekstnoOkno;
}

public GlavnoOkno(Trgovina trg) {
    setTrgovina(trg);

    Container cp = this.getContentPane();
    cp.setLayout(new BorderLayout());

    naslov = new JLabel("Prosim, da pritisnete ustrezen gumb ...");
    cp.add(naslov, BorderLayout.PAGE_END);

    plosca = new JPanel();
    cp.add(plosca, BorderLayout.PAGE_START);

    gumbVnesiEleganten = new JButton("Vnesi eleganten cevelj.");
    plosca.add(gumbVnesiEleganten);
    gumbVnesiEleganten.addActionListener(this);

    gumbKoncaj = new JButton("Koncaj");
    plosca.add(gumbKoncaj);
    gumbKoncaj.addActionListener(this);

    zvitek.setAutoscrolls(true);
    cp.add(zvitek, BorderLayout.CENTER);
    zvitek.getViewport().add(tekstnoOkno);

    setSize(300, 400);
    setTitle("Glavno okno programa");
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

}

public void actionPerformed(ActionEvent e) {

    Object m = e.getSource();;

    if (m == gumbVnesiEleganten) {
        Eleganten novi = null;
        try {
            JFrame oknoVnesiEleganten = new VnesiEleganten(novi, this);
            oknoVnesiEleganten.setVisible(true);
            oknoVnesiEleganten.pack();
            trgovina.getCevlji1()[0] = novi;
        } catch (Exception e1) {
            getTekstnoOkno().append("Napaka - poskusite znova!\n");
        } 
    } 
    else if (m == gumbKoncaj) {
        System.exit(0);
    }
} 
```

}

这是第二帧的一个类。

```
 import java.io.*;
    import java.awt.*;
    import java.awt.event.*;
    import javax.swing.*;

    public class VnesiEleganten extends JFrame implements ActionListener {

    private Eleganten nov;
private JLabel naslov;
private GlavnoOkno glavnoOkno;
private JButton gumbShraniEleganten;
private JTextField poljeCena;
private JTextField poljePopust;
private JTextField poljeMaterial;
private JTextField poljeBarva;
private JTextField poljeOtroski;
private JTextField poljeSpol;
private JTextField poljePeta;
private JPanel plosca;

public void setEleganten(Eleganten novi) {
    this.nov = novi;
}
public Eleganten getEleganten() {return nov;}

public VnesiEleganten(Eleganten novi, GlavnoOkno okno) {

setEleganten(novi);
glavnoOkno = okno;

Container cp = this.getContentPane();
cp.setLayout(new BorderLayout());

naslov = new JLabel("Prosim, da vnesete polja, shranite eleganten cevelj ter zaprete okno.");
cp.add(naslov, BorderLayout.PAGE_END);

plosca = new JPanel();
cp.add(plosca, BorderLayout.PAGE_START);

plosca.add(new JLabel("Cena = "));
poljeCena = new JTextField(10);
plosca.add(poljeCena);

plosca.add(new JLabel("Popust = "));
poljePopust = new JTextField(10);
plosca.add(poljePopust);

plosca.add(new JLabel("Material = "));
poljeMaterial = new JTextField(20);
plosca.add(poljeMaterial);

plosca.add(new JLabel("Barva = "));
poljeBarva = new JTextField(20);
plosca.add(poljeBarva);

plosca.add(new JLabel("Otroski (false/true) = "));
poljeOtroski = new JTextField(10);
plosca.add(poljeOtroski);

plosca.add(new JLabel("Moski/zenski = "));
poljeSpol = new JTextField(10);
plosca.add(poljeSpol);

plosca.add(new JLabel("Visina pete = "));
poljePeta = new JTextField(10);
plosca.add(poljePeta);

gumbShraniEleganten = new JButton("Shrani");
plosca.add(gumbShraniEleganten);
gumbShraniEleganten.addActionListener(this);

setTitle("Vnos novega elegantnega cevlja.");
setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

}

public void actionPerformed(ActionEvent e) {

    Object m = e.getSource();;
    Eleganten novi = null;;

    if (m == gumbShraniEleganten) {
        try {
            novi = new Eleganten();
            novi.setCena(Double.parseDouble(poljeCena.getText()));
            novi.setPopust(Integer.parseInt(poljePopust.getText()));
            novi.setMaterial(poljeMaterial.getText());
            novi.setBarva(poljeBarva.getText());
            novi.setOtroski(Boolean.parseBoolean(poljeOtroski.getText()));
            novi.setSpol(poljeSpol.getText());
            novi.setVisinaPete(Double.parseDouble(poljePeta.getText()));
            setEleganten(novi);
            glavnoOkno.getTekstnoOkno().append("" + novi + "\n");
            poljeCena.setText("");
            poljePopust.setText("");
            poljeMaterial.setText("");
            poljeBarva.setText("");
            poljeOtroski.setText("");
            poljeSpol.setText("");
            poljePeta.setText("");
        } catch (Exception e1) {
            glavnoOkno.getTekstnoOkno().append("Napaka - poskusite znova!\n");
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T08:38:52.673

旁注：非英文变量名使代码难以阅读。避免这种情况。

* * *

我*认为*您应该使用 JScrollPane。尝试这个：

```
JPanel yourPanel = new JPanel();
// all kinds of code that adds elements to it
// now wrap the panel in a scroll pane
JScrollPane scrollPane = new JScrollPane(yourPanel);

// and use the scroll pane instead of your main component
Container cp = this.getContentPane();
cp.setLayout(new BorderLayout());
cp.add(scrollPane, BorderLayout.CENTER); 
```

# mongodb - REST AJAX request to mongoDB

> ID：16164604
> 
> 赞同：8
> 
> 时间：2013-04-23T08:33:08.260
> 
> 标签：mongodb, jquery

I am trying to fire a `XMLHttpRequest` to mongoDB to retrieve a document via AJAX.

This is my code:

```
function getJsonDocumentByModeldid(model_id) {
    var valoreInput = document.getElementById('inputModelId').value;
    alert(valoreInput);

    $.ajax({
      url: "http://localhost:28017/test/",
      type: "get",
      //data: "filter_a=" + valoreInput,
      dataType: 'jsonp',
      crossDomain: true,

      success: function (data) {
        alert("success");
        //var json2javascript = $.parseJSON(data);
        manageLayout();
      },

      error: function (XMLHttpRequest, textStatus, errorThrown) {
       alert("Status: " + textStatus + "    Error:" + errorThrown);
      }
  });
} 
```

My function always returns an error. So what is the problem?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-25T10:05:30.147

此功能作为[简单（只读）REST 接口](http://docs.mongodb.org/ecosystem/tools/http-interfaces/)的一部分得到支持，但要进行跨域请求，[`--jsonp`](http://docs.mongodb.org/manual/reference/mongod/#cmdoption-mongod--jsonp)否则您将遇到[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)问题，因为您发出请求的 IP 地址和端口不匹配 mongoDB 运行的 IP 地址和端口。

使用（以及您可能拥有的任何其他选项）启动**mongoDB 。**`mongod.exe --rest --jsonp`

下面的示例页面可以通过 Web 服务器（例如[Apache HTTP Server](http://httpd.apache.org/)）提供，也可以简单地保存在本地并作为*文件*加载到浏览器中。该请求是关于一个名为*andyb*的 dbCollection 的信息，我首先在 mongoDB 中创建了它：

```
db.createCollection('andyb'); 
```

**HTML**

```
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>mongoDB AJAX demo</title>
  <script type='text/javascript' src='http://code.jquery.com/jquery-1.9.1.js'></script>
  <script type='text/javascript'>//<![CDATA[
  $(function(){
    $.ajax({
      url: 'http://localhost:28017/local/andyb',
      type: 'get',
      dataType: 'jsonp',
      jsonp: 'jsonp', // mongod is expecting the parameter name to be called "jsonp"
      success: function (data) {
        console.log('success', data);
      },
      error: function (XMLHttpRequest, textStatus, errorThrown) {
        console.log('error', errorThrown);
      }
    });
  });//]]>
  </script>
</head>
<body>
</body>
</html> 
```

许多浏览器现在支持[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)，这是一种促进跨域资源的替代（更现代）方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-03T23:42:28.043

可以通过使用延迟对象来修改前面的答案（请参阅这个很好的指南：“[如何从异步调用返回响应？](https://stackoverflow.com/questions/14220321/how-to-return-the-response-from-an-ajax-call)）：

```
<!doctype html>
<meta charset="utf-8">
<title>mongoDB AJAX demo</title>
<script src="http://code.jquery.com/jquery-latest.min.js" ></script>
<script>    
    $(function(){ 
    // add rest = true and jsonp = true to /etc/mongodb.conf, 
    // then restart mongodb
         $.ajax({
                url: "http://localhost:28017/local/startup_log/",
                type: 'get',
                dataType: 'jsonp',
                jsonp: 'jsonp', // mongodb is expecting that                                                                                     
            })
            .done(function(data) {
                d=JSON.stringify(data,undefined,1);
                $("code").text(d).css("color","green");
            })
            .fail(function(request,status,error) {
                $("code").text("get failed: "+error).css("color","red");
            })
            .always(function() {
                console.log("finished")
            })

  });
</script>
<body>
  <pre>
    <code>
    </code>
  </pre> 
```

无论如何，在这两种情况下，`error:`and`fail()`处理仅在未提供端口时才有效。例如：

```
url:"localhost/asdasdasd" 
```

导致错误处理；尽管

```
url:"localhost:28017/asdasdasd" 
```

在控制台中产生 404 日志，如下所示：

```
GET http://localhost:28017/?jsonp=jQuery110207253803350031376_1383522587177&_=1383522587178 404 (OK) 
```

# java - 通过 JSON 的多部分请求没有得到响应？

> ID：16164612
> 
> 赞同：0
> 
> 时间：2013-04-23T08:33:41.360
> 
> 标签：java, javascript, json

我在java中面临的问题是，当我通过多部分的JSON发出请求时，我无法从服务器获得响应。

这是javascript的reuest块：

```
$.ajaxFileUpload({ url: "/iview",
                  secureuri:false,
                 fileElementsId:fileIds,
                 dataType:entity.config.dataType?entity.config.dataType:"text",
                 data:{appmode:entity.config.appmode,   
                 json:requestObject,"__RequestType":"ajax"},
                 success: function (data, status){
                  for(var ent in fileIds){
                                    entityObject[ent].object = document.getElementById(fileIds[ent]);
                                    entityObject[ent].object.id = fileIds[ent];
                                }
                                requestResponse(data);
                            },
                            error: function (data, status, e){
                                Cyberoam.removeOverLay();
                                Cyberoam.messageBox({message:reportlabels.ConnectionLostMsg,autoClose:true});
                            },timeout:30*60*1000
                        }
                    ); 
```

下面是发送响应的 servlet 代码：

```
PrintWriter out =response.getWriter();
response.setContentType("text/plain");                
out.println(new String(("status").toString().getBytes("UTF-8")));
out.close(); 
```

所以请帮助获得JSON多部分请求的响应？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:39:52.027

你明白这是做什么的吗？

```
out.println(new String(("status").toString().getBytes("UTF-8"))); 
```

让我们重写它，以便我们可以查看不同的部分。

```
String s1 = "status";
String s2 = s1.toString();
byte[] bytes = s2.getBytes("UTF-8");
String s2 = new String(bytes);
out.println(s2); 
```

这就是正在发生的事情：

*   您有一个包含“状态”的字符串，然后您调用`toString()`它。那没有任何作用。
*   然后将字符串转换为字节数组。字节数组将包含以 UTF-8 编码的字符串内容。
*   然后将字节解释回字符串。您没有指定字符编码，因此使用系统的默认字符编码，可能是也可能不是 UTF-8。
*   然后将结果（可能包含也可能不包含“状态”，具体取决于系统的默认字符编码）打印到`out`.

这很可能不会做你想要的。你可以写：

```
out.println("status"); 
```

如果那是你想要的。

找出应该从 Java 代码发送的确切响应，并编写代码以正确格式发送响应。

# xcode - 在 UIWebView 中处理大型 excel 文件

> ID：16164614
> 
> 赞同：3
> 
> 时间：2013-04-23T08:33:48.297
> 
> 标签：xcode, ipad, excel, uiwebview

我有一个 iPad 应用程序，它使用 下载 excel 文件`NSURLConnection`，然后将下载的文件呈现在`UIWebView`.

该实现适用于较小大小的文件，但随着我处理大约 5 MB 的 excel 文件，它开始变得越来越困难。

我正在第三代 iPad 上进行测试，它有 1 GB 的 RAM。下载的文件写入`NSCachesDirectory`文件夹中。

我也尝试通过使用该方法来增加缓存大小`setSharedURLCache`，但这并没有帮助。

有什么解决办法吗？

# spring - @PreAuthorize 与 hasPermission() 执行代码两次

> ID：16164615
> 
> 赞同：2
> 
> 时间：2013-04-23T08:33:50.940
> 
> 标签：spring, spring-security, aop, pre-authentication

我想使用 @PreAuthorize Spring 注释来控制我的应用程序中的访问。

问题是，我有很多条件不是取决于请求参数，而是取决于数据库实体。

**概述：**

我有一个`Route`实体，它有`User owner`字段。`Route`仅当您是所有者时才能删除。

我写了我的控制器方法：

```
@RequestMapping(value = "/route/remove/{id}", method = RequestMethod.GET)
@PreAuthorize("hasPermission(#id, 'RouteRemove')")
  public String removeRoute(@PathVariable("id") Integer id, ModelMap model) {

  Route route = routeBO.getById(id);

  if(null == route)
    return "forward:/errors/404";

  // ... remove route here.
  // routeBO.remove(id);
} 
```

我的`RouteRemove`权限定义为：

```
@Component
public class RouteRemovePermission implements Permission {

    @Autowired
    private RouteBO routeBO;

    @Override
    public boolean isAllowed(Authentication authentication, Object targetDomainObject) {
        if(!(targetDomainObject instanceof Integer))
            return false;

        Route route = routeBO.getById((Integer) targetDomainObject);

        if(route == null)
            return false;

        User user = AthenticationUtil.getUser();

        return null != user && user.equals(route.getOwner());
    }

} 
```

如您所见，我必须评估`routeBO.getById()`两次。

**问题：**

是否可以只评估此代码一次？

*我当然试过：*

```
@RequestMapping(value = "/route/remove/{id}", method = RequestMethod.GET)
public String removeRoute(@PathVariable("id") Integer id, ModelMap model) {

Route route = routeBO.getById(id);

if(null == route)
  return "forward:/errors/404";

return removeRoute(route, model);
}

@PreAuthorize("hasPermission(#id, 'RouteRemove')")
public String removeRoute(Route id, ModelMap model) {

    return "route/display";
} 
```

但之前没有调用权限方法`removeRoute(Route id, ModelMap model)`。也许我的配置不正确？

mvc-调度程序-servlet.xml

```
<sec:global-method-security secured-annotations="enabled" pre-post-annotations="enabled">
  <sec:expression-handler ref="expressionHandler"/>
</sec:global-method-security> 
```

安全.xml

```
<beans:bean id="expressionHandler" class="org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler">
    <beans:property name="permissionEvaluator" ref="permissionEvaluator"/>
</beans:bean>

<beans:bean id="permissionEvaluator" class="pl.wsiadamy.common.security.BasePermissionEvaluator">
  <beans:constructor-arg index="0">
        <beans:map key-type="java.lang.String"
             value-type="pl.wsiadamy.common.security.Permission">
            <beans:entry key="RouteView" value-ref="routeViewPermission" />
            <beans:entry key="RouteRemove" value-ref="routeRemovePermission" />
        </beans:map>
    </beans:constructor-arg>
</beans:bean>
<beans:bean id="routeViewPermission" class="pl.wsiadamy.common.security.permission.RouteViewPermission" />
<beans:bean id="routeRemovePermission" class="pl.wsiadamy.common.security.permission.RouteRemovePermission" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-08T14:06:45.190

我建议您将带有安全注释的 removeRoute 方法分解为一个单独的服务类，例如：

```
@Service
public class RouteService {
    @PreAuthorize("hasPermission(#route, 'RouteRemove')")
    public void removeRoute(Route route) {
        // remove route here
    }
} 
```

然后你在你的网络控制器中使用它：

```
@Autowired RouteService routeService;

@RequestMapping(value = "/route/remove/{id}", method = RequestMethod.GET)
public String removeRoute(@PathVariable("id") Integer id, ModelMap model) {
    Route route = routeBO.getById(id);
    if(null == route)
        return "forward:/errors/404";
    routeService.removeRoute(route);
    return "route/display";
} 
```

# sql - 创建选择查询时如何使用 hashbytes()

> ID：16164616
> 
> 赞同：0
> 
> 时间：2013-04-23T08:33:56.980
> 
> 标签：sql, sql-server, select

我想将 Password 从**varchar**转换为**binary**。

我有这样的查询，

```
SELECT 'INSERT INTO Table2(Username,password)values('+
IsNull(''''+wl.UserName+'''', 'NULL')+','+
     HASHBYTES('MD5',ISNULL(wl.Password,'NULL'))+')' 
```

但是当我执行上面的代码时出现错误，

```
 The data types nvarchar and varbinary are incompatible in the add operator. 
```

我需要你的帮助。我的查询是正确的。为什么会这样显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T09:13:14.787

您可以使用此查询。

```
SELECT 'INSERT INTO Table2(Username,password)values('+
IsNull(''''+wl.UserName+'''', 'NULL')+','+
      isnull('0x' + cast('' as xml).value('xs:hexBinary(sql:column("password") )', 'varchar(max)'),'NULL') + ')'
from (select username, hashbytes('md5',password) as password from wl) wl 
```

参考：[从十六进制字符串转换为 varbinary，反之亦然](http://blogs.msdn.com/b/sqltips/archive/2008/07/02/converting-from-hex-string-to-varbinary-and-vice-versa.aspx)

# javascript - 使用 CasperJS、PhantomJS 和回发进行抓取尝试

> ID：16164619
> 
> 赞同：2
> 
> 时间：2013-04-23T08:34:03.160
> 
> 标签：javascript, asp.net, phantomjs, casperjs

我正在尝试抓取使用 .aspx 文件或 ASP.net 的站点。有单选按钮，在每次点击时执行回发。

我现在知道 ASP.net 中的回发只是一个 POST 调用，但是有谁知道在 CasperJS 或 PhantomJS 中设置这个 POST 涉及什么？

我想它是这样的，但是我错过了复制回调的 POST。任何人都必须这样做并且可以提供一些见解，我们将不胜感激。

```
casper.start('target.aspx',function() {
    this.capture('Step1.png');
    this.test.assertExists('#ctl00_cphMainContent_ucUnifiedSearch_rdoOrg', 'PASS');
    this.click('input[name="ctl00$cphMainContent$ucUnifiedSearch$rdoSearchBy"][value="rdoOrg"]');    
});

casper.run(function() {
    this.echo('finished');
    this.capture('Step2.png');  
}); 
```

具体的目标输入标签和回发是：

```
<input id="ctl00_cphMainContent_ucUnifiedSearch_rdoOrg" type="radio" name="ctl00$cphMainContent$ucUnifiedSearch$rdoSearchBy" value="rdoOrg" onclick="javascript:setTimeout('__doPostBack(\'ctl00$cphMainContent$ucUnifiedSearch$rdoOrg\',\'\')', 0)"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-09T12:55:16.867

正如您所说，该页面对该页面进行 POST 调用。这是通过 javascript 完成的，casperjs 不会将其作为到下一页的过渡。因此，最后一步 ( `run`) 不会等待页面重新加载。您需要自己等待页面转换。

您可以通过等待仅存在于重新加载页面中的特定字段来执行此操作。在你的情况下，这将是

```
casper.waitForSelector('#ctl00_cphMainContent_ucUnifiedSearch_txtFirm'); 
```

所以生成的脚本是

```
casper.start('http://www.adviserinfo.sec.gov/IAPD/Content/Search/iapd_Search.aspx', function() {
    this.capture('Step1.png');
    this.click('input[name="ctl00$cphMainContent$ucUnifiedSearch$rdoSearchBy"][value="rdoOrg"]');    
});

casper.waitForSelector('#ctl00_cphMainContent_ucUnifiedSearch_txtFirm');

casper.run(function() {
    this.echo('finished');
    this.capture('Step2.png');  
}); 
```

# c - 如何将 IEEE 754 单精度二进制浮点数转换为十进制数？

> ID：16164620
> 
> 赞同：1
> 
> 时间：2013-04-23T08:34:05.163
> 
> 标签：c, binary, ieee-754

> 我正在开发一个需要将 32 位数字转换为十进制数的程序。

我从输入中得到的数字是一个 32 位数字，表示为浮点数。第一位是符号，接下来的 8 位是指数，其他 23 位是尾数。我正在用 C 语言编写程序。在输入中，我将该数字作为一个`char[]`数组获取，然后创建一个新`int[]`数组，在其中存储符号、指数和尾数。但是，当我尝试将尾数存储为某种数据类型时，我遇到了尾数问题，因为我需要将尾数用作数字，而不是数组：`formula=sign*(1+0.mantissa)*2^(exponent-127)`。

这是我用来存储尾数的代码，但程序仍然给我错误的结果：

```
double oMantissa=0;
int counter=0;
for(counter=0;counter<23;counter++)
{
    if(mantissa[counter]==1)
    {
        oMantissa+=mantissa[counter]*pow(10,-counter);
    }
} 
```

`mantissa[]`是一个`int`数组，我已经从`char`数组中转换了尾数。当我从 中获取值时`formula`，它必须是二进制数，并且我必须将其转换为十进制，因此我将获取该数字的值。你能帮我存储尾数的 23 位吗？而且，我不能使用`strtoul`将 32 位数字直接转换为二进制的函数。我必须使用`formula`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T03:47:42.253

考虑到所有的公式和样本编号以及一个计算器，以下代码的哪一部分很难正确？

```
#include <stdio.h>
#include <limits.h>

#if UINT_MAX >= 0xFFFFFFFF
typedef unsigned uint32;
#else
typedef unsigned long uint32;
#endif

#define C_ASSERT(expr) extern char CAssertExtern[(expr)?1:-1]

// Ensure uint32 is exactly 32-bit
C_ASSERT(sizeof(uint32) * CHAR_BIT == 32);

// Ensure float has the same number of bits as uint32, 32
C_ASSERT(sizeof(uint32) == sizeof(float));

double Ieee754SingleDigits2DoubleCheat(const char s[32])
{
  uint32 v;
  float f;
  unsigned i;
  char *p1 = (char*)&v, *p2 = (char*)&f;

  // Collect binary digits into an integer variable
  v = 0;
  for (i = 0; i < 32; i++)
    v = (v << 1) + (s[i] - '0');

  // Copy the bits from the integer variable to a float variable
  for (i = 0; i < sizeof(f); i++)
    *p2++ = *p1++;

  return f;
}

double Ieee754SingleDigits2DoubleNoCheat(const char s[32])
{
  double f;
  int sign, exp;
  uint32 mant;
  int i;

  // Do you really need strto*() here?
  sign = s[0] - '0';

  // Do you really need strto*() or pow() here?
  exp = 0;
  for (i = 1; i <= 8; i++)
    exp = exp * 2 + (s[i] - '0');

  // Remove the exponent bias
  exp -= 127;

  // Should really check for +/-Infinity and NaNs here

  if (exp > -127)
  {
    // Normal(ized) numbers
    mant = 1; // The implicit "1."
    // Account for "1." being in bit position 23 instead of bit position 0
    exp -= 23;
  }
  else
  {
    // Subnormal numbers
    mant = 0; // No implicit "1."
    exp = -126; // See your IEEE-54 formulas
    // Account for ".1" being in bit position 22 instead of bit position -1
    exp -= 23;
  }

  // Or do you really need strto*() or pow() here?
  for (i = 9; i <= 31; i++)
    mant = mant * 2 + (s[i] - '0');

  f = mant;

  // Do you really need pow() here?
  while (exp > 0)
    f *= 2, exp--;

  // Or here?
  while (exp < 0)
    f /= 2, exp++;

  if (sign)
    f = -f;

  return f;
}

int main(void)
{
  printf("%+g\n", Ieee754SingleDigits2DoubleCheat("110000101100010010000000000000000"));
  printf("%+g\n", Ieee754SingleDigits2DoubleNoCheat("010000101100010010000000000000000"));
  printf("%+g\n", Ieee754SingleDigits2DoubleCheat("000000000100000000000000000000000"));
  printf("%+g\n", Ieee754SingleDigits2DoubleNoCheat("100000000100000000000000000000000"));
  printf("%+g\n", Ieee754SingleDigits2DoubleCheat("000000000000000000000000000000000"));
  printf("%+g\n", Ieee754SingleDigits2DoubleNoCheat("000000000000000000000000000000000"));
  return 0;
} 
```

输出（[ideone](http://ideone.com/seYW5R)）：

```
-98.25
+98.25
+5.87747e-39
-5.87747e-39
+0
+0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-30T14:54:55.053

不久前，我有机会编写了一段类似的代码，您和其他人可能会觉得有用。它将表示浮点数的字符串作为程序的第一个参数，并将字符串转换为其**IEEE-754 单精度浮点**表示及其等效整数值。看看，如果您有任何问题，请告诉我。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>
#include <errno.h>

#if defined(__LP64__) || defined(_LP64)
# define BUILD_64   1
#endif

/* constants for word and double-word size */
#define WDSZ 64
#define DWSZ 128

inline int getmsb (unsigned long x);
char *fmt_binstr (unsigned long n, unsigned char sz, unsigned char szs, char sep);
char *binstr (unsigned long n);
char *fpfrc_bin (float fvalue);
void show_fltmem (float f);
void show_ieee754str (char *s);
void show_ieee754 (float f);
float xstrtof (char *str);
char *form_ieee754SPstr (int sign, char *exp, char *dec, char *frac);

int main (int argc, char** argv) {

    if (argc < 2) {
        fprintf (stderr, "error: insufficient input. Usage: %s float\n", argv[0]);
        return 1;
    }

    char *dp = strchr (argv[1], '.');   /* pointer to decimal point */
    int dec = atoi (argv[1]);           /* integer of decimal part  */
    int frc = (dp) ? atoi (dp + 1) : 0; /* integer of fraction part */

    /* output string input values  */
    printf ("\nString Values:\n");
    printf (" string   : %s\n whole    : %d\n fraction : %d\n\n", argv[1], dec, frc);

    float fvalue = xstrtof (argv[1]);
    float ffrc = fvalue - dec;
    int signbit = (fvalue >= 0) ? 0 : 1;

    /* output float input values   */
    printf ("Float Values:\n");
    printf (" decimal  : %d\n fraction : %f\n\n", dec, ffrc);

    char *fstring = fpfrc_bin (fvalue);         /* fraction part in binary  */
    char *bs = binstr ((unsigned long) dec);    /* decimal part in binary   */

    /* output binary values decimal part/fraction part */
    printf ("Binary Values:\n");
    printf (" decimal  : %s\n fraction : %s\n sign bit : %d\n\n", bs, fstring, signbit);

    /* quick hack of exp bias, biased value, conversion to binary   */
    int bias = (int) strlen (bs) - 1;
    int biasexp = 127+bias;
    char *binexp = binstr ((unsigned long) biasexp);

    /* output summary of biased IEEE-754 exponent */
    printf ("Normalization for biased exponent:\n");
    printf ("\n %s.%s  =>  %s.%s%s\n\n", bs, fstring, "1", (bs+1), fstring);
    printf ("     exponent bias: %d\n unbiased exponent: 127\n", bias);
    printf (" __________________+____\n\n");
    printf ("   biased exponent: %3d\n   binary exponent: %s\n\n", biasexp, binexp);

    /* output summary of IEEE-754 mantissa */
    printf ("Conversion to 'hidden bit' format to form mantissa:\n\n");
    printf (" %s.%s%s  =>  %s%s\n\n", "1", (bs+1), fstring, (bs+1), fstring);

    /* form IEEE-754 binary representation from values computed */
    char *ieee754str = form_ieee754SPstr (signbit, binexp, bs, fstring);

    /* output formatted complete IEEE-754 binary - from computed values above */
    printf ("IEEE-754 Single Precision Floating Point Representation (caclulated value)\n\n");
    show_ieee754str (ieee754str);

    /* output formatted complete IEEE-754 binary - from float value in memory */
    printf ("IEEE-754 Single Precision Floating Point Representation (memory value)\n\n");
    show_ieee754 (fvalue);

    /* output float, binary and integer equivalent */
    show_fltmem (fvalue);

    if (bs) free (bs);
    if (binexp) free (binexp);
    if (ieee754str) free (ieee754str);

    return 0;
}

/** single-precision float in memory
*  output the float, equivalent unsigned int, and
*  binary representation of the number in memory
*/

void show_fltmem (float f)
{
    unsigned int i = *(unsigned int *)&f;

    printf ("\nRepresentations of float value in memory:\n\n");
    printf ("    The float value entered : %f\n\n", f);
    printf ("    binary value in memory  : %s\n\n", fmt_binstr (i, 32, 8, '-'));
    printf ("    bits as unsigned int    : %u\n\n", i);
}

/** most significant bit.
*  return the 0-based most significant bit for any
*  unsigned value using the bit-scan-right assembly
*  directive.
*/
inline int getmsb (unsigned long x)
{
#ifdef BUILD_64
    asm ("bsrq %0, %0" : "=r" (x) : "0" (x));
#else
    asm ("bsr %0, %0" : "=r" (x) : "0" (x));
#endif
    return x;
}

/** returns pointer to formatted binary representation of 'n' zero padded to 'sz'.
*  returns pointer to string contianing formatted binary representation of
*  unsigned 64-bit (or less ) value zero padded to 'sz' digits with char
*  'sep' placed every 'szs' digits. (e.g. 10001010 -> 1000-1010).
*/
char *fmt_binstr (unsigned long n, unsigned char sz, unsigned char szs, char sep) {

    static char s[DWSZ + 1] = {0};
    char *p = s + DWSZ;
    unsigned char i;

    for (i = 0; i < sz; i++) {
        p--;
        if (i > 0 && szs > 0 && i % szs == 0)
            *p-- = sep;
        *p = (n >> i & 1) ? '1' : '0';
    }

    return p;
}

/** returns an allocated string containing unpadded binary
*  representation of the integer value 'n'. This value must
*  be assigned to a pointer and freed to prevent leaks.
*/
char *binstr (unsigned long n)
{
    unsigned char msb = getmsb (n);
    char *s = calloc (msb + 2, sizeof *s);
    char *p = s + msb;
    unsigned char i;

    for (i = 0; i < msb+1; i++) {
        *p-- = (n >> i & 1) ? '1' : '0';
    }

    return s;
}

/** return string containing binary representation of fraction
*  The function takes a float as an argument and computes the
*  binary representation of the fractional part of the float,
*  On success, the function returns a null-terminated string
*  containing the binary value, or NULL otherwise. MAXD of 24
*  (23 + null-term) for Single-Precision mantissa, 53
*  (52 + null-term) for Double-Precision mantissa.
*/
char *fpfrc_bin (float fvalue)
{
    float fv = fvalue - (int)fvalue;
    int MAXD = 24;
    char *fvs = calloc (MAXD, sizeof *fvs);
    if (!fvs) {
        fprintf (stderr, "%s()_error: allocation failed.\n", __func__);
        return NULL;
    }
    char *p = fvs;
    unsigned char it = 0;

    while (fv > 0 && it < MAXD)
    {
        fv = fv * 2.0;
        *p++ = ((int)fv) ? '1' : '0';
        fv = ((int)fv >= 1) ? fv - 1.0 : fv;
        it++;
    }

    return fvs;
}

/** formatted output of ieee-754 representation of float from binary string.
*/
void show_ieee754str (char *s)
{
    printf (" ");
    while (*s)
        printf (" %c", *s++);
    printf ("\n");
    printf (" |- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -|\n");
    printf (" |s|      exp      |                  mantissa                   |\n\n");
}

/** formatted output of ieee-754 representation of float from stored value.
*/
void show_ieee754 (float f)
{
    printf ("  ");
    int i = 32;
    while (i) {
        i--;
        printf ("%d ", ((*(int *)&f >> i) & 0x1));
    }
    printf ("\n");
    printf (" |- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -|\n");
    printf (" |s|      exp      |                  mantissa                   |\n\n");
}

/** string to float with error checking. */
float xstrtof (char *str)
{
    char *endptr = NULL;
    errno = 0;

    float val = strtof (str, &endptr);

    /* Check for various possible errors */
    if ((errno == ERANGE && (val == HUGE_VALF || val == HUGE_VALL)) ||
        (errno != 0 && val == 0)) {
        perror ("strtof");
        exit (EXIT_FAILURE);
    }

    if (endptr == str) {
        fprintf (stderr, "No digits were found\n");
        exit (EXIT_FAILURE);
    }

    return val;
}

/** form IEEE-754 binary representation from computed  values for the
*  sign bit, biased exponent binary string, decimal binary string, and
*  fractional binary string, forming the 23-bit mantissa from the decimal
*  and fractional strings, filling with '0' as needed. An allocated
*  string containing the IEEE-754 Single-Precision representation is
*  returned.
*/

char *form_ieee754SPstr (int sign, char *exp, char *dec, char *frac)
{
    char *str = calloc (33, sizeof *str);
    char *p = str + 1;
    char *sp = dec + 1;                         /* leading 1 - hidden bit   */
    size_t fsl = strlen (frac);                 /* length of fractional str */
    size_t manbits = fsl + strlen (sp);         /* available mantissa bits  */
    size_t mdiff = 23 - manbits;                /* diff from required 23    */

    *str = (sign == 0) ? '0' : '1';             /* set sign bit in string   */

    memcpy (p, exp, 8);                         /* set biased exponent      */
    p += 8;

    while (*sp) { *p = *sp++; p++; };           /* mantissa - decimal bits  */

    if (manbits < 23)                           /* test < 23 bits available */
    {
        memcpy (p, frac, fsl);                  /* copy fractional bits     */
        p += fsl;                               /* increment pointer        */
        register size_t it = 0;
        if (mdiff > 0)                          /* fill remaining mantissa  */
            for (it = 0; it < mdiff; it++)
            {
                *p = '0';
                p++;
            }
    }
    else
    {
        memcpy (p, frac, 23);                   /* fill mantissa w/23 bits  */
    }

    return str;
} 
```

**示例使用/输出**

```
$ ./bin/ieee754cvt 123.456

String Values:
 string   : 123.456
 whole    : 123
 fraction : 456

Float Values:
 decimal  : 123
 fraction : 0.456001

Binary Values:
 decimal  : 1111011
 fraction : 01110100101111001
 sign bit : 0

Normalization for biased exponent:

 1111011.01110100101111001  =>  1.11101101110100101111001

     exponent bias: 6
 unbiased exponent: 127
 __________________+____

   biased exponent: 133
   binary exponent: 10000101

Conversion to 'hidden bit' format to form mantissa:

 1.11101101110100101111001  =>  11101101110100101111001

IEEE-754 Single Precision Floating Point Representation (caclulated value)

  0 1 0 0 0 0 1 0 1 1 1 1 0 1 1 0 1 1 1 0 1 0 0 1 0 1 1 1 1 0 0 1
 |- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -|
 |s|      exp      |                  mantissa                   |

IEEE-754 Single Precision Floating Point Representation (memory value)

  0 1 0 0 0 0 1 0 1 1 1 1 0 1 1 0 1 1 1 0 1 0 0 1 0 1 1 1 1 0 0 1
 |- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -|
 |s|      exp      |                  mantissa                   |

Representations of float value in memory:

    The float value entered : 123.456001

    binary value in memory  : 01000010-11110110-11101001-01111001

    bits as unsigned int    : 1123477881 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-30T13:59:01.103

在网上搜索并找不到类似的函数后，我写了这些浮点转换函数。

```
//NOTE memcpy is a more efficient way to do this
//These instructions are presented for reference only
//I Zackery Sobin created these functions
//and I release them into the public domain
//there is no warranty
//they might not work properly
//certain things like NAN or INFINITY might not be handled correctly

#include "math.h" 

float charArray2float(charArray *S)
    {
        unsigned int uintS = charArray2lluint(S, 4);
        unsigned int sign     = (uintS & 0x80000000); //01111111 10000000 00000000 00000000
        unsigned int exponent = (uintS & 0x7F800000); //01111111 10000000 00000000 00000000
        unsigned int mantessa = (uintS & 0x007FFFFF); //00000000 01111111 11111111 11111111
        float normalizedExponent = (float) ((signed char) ((exponent>>23) - 127));
        float normalizedMantessa = (float) 1 + (float) mantessa / pow((float)2,(float)23);
        float theVar = normalizedMantessa * pow((float)2,(float)normalizedExponent);
        if (sign != 0) theVar = theVar * (float) (-1);
        if (fabs(theVar) < pow((float) 10, (float) -38)) theVar = 0;
        return theVar;
    }

long long int charArray2lluint(char *S, int length)
    {
    int x;
    unsigned long long int sum =0;
    for (x = 0; x < length; x++)
            {
        if (isBigEndian){
            sum = sum + ((unsigned long long int) ((unsigned char) S[x]) << ((length-1)-x) * 8);
            }
        else{
            sum = sum + ((unsigned long long int) ((unsigned char) S[length-x-1]) << ((length-1)-x) * 8);
            }
        }
    return sum;
    }

void float_2charArray(char *outputArray, float testVariable1) {    //long int is the same size as regular intz
    int o = 0;
    int x;
    char byteNum[8];
    unsigned int    sign = 0;
    float           mantessa = 0;
    int             exp = 0;
    unsigned int    theResult;
    if (testVariable1 ==0){theResult = 0;}
    else{   if (testVariable1 < 0) {
                sign =  0x80000000;
                testVariable1 = testVariable1 * -1.0;
                }
            int watchdog = 0;
            while (1){
                watchdog++;
                if (watchdog > 512) {   
                    ErrorCode = 6;  //This is a global variable used to see if there is a bug in this function
                    break;
                    }
                mantessa = testVariable1 / powf(2,exp);
                if      (mantessa >= 1 && mantessa < 2) {break;}
                else if (mantessa >= 2.0)               {exp = exp + 1;}
                else if (mantessa < 1   )               {exp = exp - 1;}
                }
            unsigned int fixedExponent =   ((exp+127)<<23);
            unsigned int fixedMantessa = (float) (mantessa -1) * pow((float)2,(float)23);
            theResult = sign + fixedExponent + fixedMantessa;
            }
    unsigned_int_2charArray(byteNum, theResult); 
    if (!isBigEndian)     for (x = 0; x <= 7; x++)    {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);
    else if (isBigEndian) for (x = 7; x >= 0; x--)    {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);
}

void double_2charArray(char *outputArray, double testVariable2) {    //long int is the same size as regular int
    int o = 0;
    int x;
    char byteNum[16];
    unsigned long long int sign = 0;
    double mantessa = 0;
    long long int exp = 0;
    unsigned long long int    theResult;

    if (testVariable2 ==0){theResult = 0;theResult = 0;}
    else{   if (testVariable2 < 0) {
                sign =  0x8000000000000000;
                testVariable2 = testVariable2 * -1.0;
                }
            long long int watchdog = 0;
            while (1){
                watchdog++;
                if (watchdog > 512) {                      
                    FlighboardErrorCode = 7;
                    break;
                    }
                mantessa = testVariable2 / powf(2,exp);
                if      (mantessa >= 1 && mantessa < 2) {break;}
                else if (mantessa >= 2.0)               {exp = exp + 1;}
                else if (mantessa < 1   )               {exp = exp - 1;}
                }
            unsigned long long int fixedExponent =   ((exp+1023)<<52);
            unsigned long long int fixedMantessa = (double) (mantessa -1) * pow((double)2,(double)52);
            theResult = sign | (fixedExponent + fixedMantessa);  //Fixme is this quite right?
            }
    unsigned_long_long_int_2charArray(byteNum, theResult); 
    if (!isBigEndian)     for (x = 0; x <= 15; x++)    {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);
    else if (isBigEndian) for (x = 15; x >= 0; x--)    {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);    
    }

void unsigned_long_long_int_2charArray(char *outputArray, unsigned long long int X) {    //long int is the same size as regular int
    int o = 0;
    int x;
    char byteNum[8];
    byteNum[0] = (X & 0x00000000000000FF);
    byteNum[1] = (X & 0x000000000000FF00) >> 8;
    byteNum[2] = (X & 0x0000000000FF0000) >> 16;
    byteNum[3] = (X & 0x00000000FF000000) >> 24;
    byteNum[4] = (X & 0x000000FF00000000) >> 32;
    byteNum[5] = (X & 0x0000FF0000000000) >> 40;
    byteNum[6] = (X & 0x00FF000000000000) >> 48;
    byteNum[7] = (X & 0xFF00000000000000) >> 56;
    if (!isBigEndian)     for (x = 0; x <= 7; x++)    {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);
    else if (isBigEndian) for (x = 7; x >= 0; x--)    {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);
}

void long_long_int_2charArray(char *outputArray, long long int X) {    //long int is the same size as regular int
    int o = 0;
    int x;
    char byteNum[8];
    byteNum[0] = (X & 0x00000000000000FF);
    byteNum[1] = (X & 0x000000000000FF00) >> 8;
    byteNum[2] = (X & 0x0000000000FF0000) >> 16;
    byteNum[3] = (X & 0x00000000FF000000) >> 24;
    byteNum[4] = (X & 0x000000FF00000000) >> 32;
    byteNum[5] = (X & 0x0000FF0000000000) >> 40;
    byteNum[6] = (X & 0x00FF000000000000) >> 48;
    byteNum[7] = (X & 0xFF00000000000000) >> 56;
    if (!isBigEndian)     for (x = 0; x <= 7; x++)    {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);
    else if (isBigEndian) for (x = 7; x >= 0; x--)    {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);
}

void unsigned_int_2charArray(char *outputArray, unsigned int X) {    //long int is the same size as regular int
    int o = 0;
    int x;
    char byteNum[4];
    byteNum[0] = (X & 0x000000FF);
    byteNum[1] = (X & 0x0000FF00) >> 8;
    byteNum[2] = (X & 0x00FF0000) >> 16;
    byteNum[3] = (X & 0xFF000000) >> 24;
    if (!isBigEndian)     for (x = 0; x <= 3; x++)    {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);
    else if (isBigEndian) for (x = 3; x >= 0; x--)    {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);
}

void int_2charArray(char *outputArray, int X) {    //long int is the same size as regular int
    int o = 0;
    int x;
    char byteNum[4];
    byteNum[0] = (X & 0x000000FF);
    byteNum[1] = (X & 0x0000FF00) >> 8;
    byteNum[2] = (X & 0x00FF0000) >> 16;
    byteNum[3] = (X & 0xFF000000) >> 24;
    if (!isBigEndian)     for (x = 0; x <= 3; x++)    {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);
    else if (isBigEndian) for (x = 3; x >= 0; x--)    {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);
}

void unsigned_short_int_2charArray(char *outputArray, unsigned short int X)   {
    int o = 0;
    int x;
    char byteNum[2];
    byteNum[0] = (X & 0x00FF);
    byteNum[1] = (X & 0xFF00) >> 8;
    if (!isBigEndian)     for (x = 0; x <= 1; x++)    {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);
    else if (isBigEndian) for (x = 1; x >= 0; x--)    {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);
}

void short_int_2charArray(char *outputArray, short int X)   {
    int o = 0;
    int x;
    char byteNum[2];
    byteNum[0] = (X & 0x00FF);
    byteNum[1] = (X & 0xFF00) >> 8;
    if (!isBigEndian)     for (x = 0; x <= 1; x++) {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);
    else if (isBigEndian) for (x = 1; x >= 0; x--) {outputArray[o]=byteNum[x]; o++;}  // datagram.append(byteNum[x]);
}

void unsigned_char_2charArray(char *outputArray, unsigned char X)   {
    outputArray[0] = X;
}

void char_2charArray(char *outputArray, char X)   {
     outputArray[0] = X;   
} 
```

# git - vim syntax highlighting for git commit messages - custom commentchar

> ID：16164624
> 
> 赞同：17
> 
> 时间：2013-04-23T08:34:09.170
> 
> 标签：git, vim, comments, syntax-highlighting

As mentioned [in this answer](https://stackoverflow.com/a/14931661/835945), since Git 1.8.2 you can use `core.commentchar` config value to change commit message comments to something else than the default `#` (hashmark or hashsign).

That is a life-saver e.g. if your commit message policy wants you to start commit message with ticket number:

```
#123 Fixed array indices 
```

Sad part is that this breaks Vim syntax highlighting.

How can you bring the beauty back?

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-23T09:11:36.780

您应该尝试运行`:verbose syntax`. 活动语法文件可能是`$VIMRUNTIME\syntax\gitcommit.vim`（可能在您的[github 版本](https://github.com/tpope/vim-git/blob/master/syntax/gitcommit.vim)`.vim`中）。

它会告诉您哪个语法行将触发格式化为注释。

您可能会看到类似的内容：

```
 gitcommitComment xxx match /^#.*/
     links to Comment 
```

或者

```
 syn match   gitcommitComment   "^#.*" 
```

这意味着它匹配以 . 开头的每一行`#`。

您也许可以对其进行修改，以便`#`第一行的 a 不被视为注释。我不知道`syntax`格式足以给你一个完整的解决方案。

```
 \%^   match the beginning of file
 \%1l  match line 1
 \%>1l match below line 1 
```

因此，您可能会尝试修改 gitComment 模式，使其在 git 提交的第 1 行不起作用。

（我尝试了一些东西，但没有设法只排除第一行评论！似乎还有`diffComment`一些事情搞砸了，因为 gitcommit 包含 diff 格式`syn include @gitcommitDiff syntax/diff.vim`））

有关详细信息，请参阅`:help syntax`和`:help pattern`。

另一个关于语法高亮的好资源：[Learn Vim the Hard Way，第 46 章](http://learnvimscriptthehardway.stevelosh.com/chapters/46.html)。

# javascript - How to exclude elements inside a child-element from a selection without using children()?

> ID：16164630
> 
> 赞同：1
> 
> 时间：2013-04-23T08:34:45.420
> 
> 标签：javascript, jquery, selector, parent-child

I have an element like so:

```
<div id="foo">
  <a href="#" class="some">click me</a>
  <div id="bar">
     <a href="#" class="some">click me too</a>
  </div>
</div> 
```

and I need to select the `a` elements that are not inside `bar`. Problem is I can't use `children()`, because my `foo` is much more complex than above.

**Question:**
Is there a way to select "some" elements from a `foo` and explicitly excluding "some" elements from `bar`?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T08:39:37.867

如果锚元素可能并不总是您的直接子元素，则`foo`可以使用该`filter()`方法。

```
var anchors = $("#foo a").filter(function(){
    return !$("#bar").find(this).length;
}); 
```

**工作示例** [http://jsfiddle.net/v63tC/](http://jsfiddle.net/v63tC/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T08:43:20.677

您可以使用[.filter()](http://api.jquery.com/filter/)和[$.contains()](http://api.jquery.com/jQuery.contains/)来解决这个问题

```
var $bar = $('#bar');
var items = $('#foo a.some').filter(function() {
    return !$.contains($bar[0], this)
}) 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/TvLLk/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T08:37:34.923

可能带有`>`直接子符号：

```
$('#foo > a') 
```

你可以省略一些元素`.not()`：

```
$("#foo a").not('#bar a').length; 
```

### [小提琴](http://jsfiddle.net/3NSLb/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T08:41:40.543

既然您提到您的`#foo`元素比示例复杂得多，那么假设您需要选择的不仅仅是直接后代是否安全？如果是这样的话，我建议如下：

```
$('#foo a.some').filter(function() {
    return $(this).parents('#bar').length === 0;
}); 
```

这会选择中的*所有* `<a>`元素`#foo`，然后将它们过滤掉，以便只保留那些没有祖先的`id`元素`bar`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T08:36:51.190

你可以这样做（假设变量`foo`是你的`#foo`）

```
var a = foo.find('> a'); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-23T08:37:19.480

您可以使用[子选择器](http://api.jquery.com/child-selector/)来完成您的第一个任务（`<a>`从 获取所有元素`foo`）：

```
$('#foo > a'). ... 
```

# javascript - Data is not display after visiting a page twice

> ID：16164631
> 
> 赞同：1
> 
> 时间：2013-04-23T08:34:51.563
> 
> 标签：javascript, durandal

Hi I am building a SPA application using Durandal , knockout and renderjs and I seem to have found a problem when going from one page to another.

This is what my current model looks like:

```
define(['services/logger', 'services/dataService', 'durandal/plugins/router'],
function (logger, dataService, router) {
    var allModulesObservableCollection = ko.observableArray();
    var isInitialized = false;
    var activeSaIdParameter = "";

    var vm = {
        //bindable
        title: ko.observable(''),
        dataLoading: ko.observable(false),
        hasErrors: ko.observable(false),
        errorMessage: ko.observable(''),

        courseName: ko.observable(''),
        allModules: allModulesObservableCollection,

        //operations
        refreshData: refreshData,
        showActiveModules: showActiveModules,
        activate: activate,
    };

    return vm;

    function activate(context) {
        logger.log('All Modules View Activated', null, 'allModules', true);
        if (!isInitialized) {
            activeSaIdParameter = context.activeSaId;
            isInitialized = true;
            fetchModulesData(context.activeSaId);
            return fetchHeaderData(context.activeSaId);
        } else {
            if (context.activeSaId != activeSaIdParameter) {
                activeSaIdParameter = context.activeSaId;
                fetchModulesData(context.activeSaId);
                return fetchHeaderData(context.activeSaId);
            }
        }
    }

    function fetchModulesData(activeSaId) {
        vm.dataLoading(true);
        vm.hasErrors(false);
        return dataService.getAllModulesInCourse(activeSaId)
            .then(fetchModulesCompleted)
            .fail(fetchDataFailed);

        function fetchModulesCompleted(data) {
            allModulesObservableCollection(data);
            debugger;
            vm.dataLoading(false);
        }
    }

    function showActiveModules() {
        var url = '#/activeModules/' + activeSaIdParameter;
        router.navigateTo(url);
    }   
}); 
```

The first time around the data gets displayed correctly and everything works fine.But after going to another page and then trying to come back to this one , it's like the browser completly ignores the javascript code.

ShowActiveModules() is responsible for taking the user to it's sibbling page.

While debugging I noticed that after commming back to this page the browser does not even run this code anymore.I have to compleetly refresh the page for it to get the data and display it.

Can anyone tell me what I am doing wrong?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T10:40:25.113

它不会再次运行该文件，因为 RequireJS 只读取该文件一次。

乍一看，您的“激活”功能应该会再次被调用。**您是否尝试过仅**在“激活”功能上设置断点？

# selenium - Play with subprojects and integration tests

> ID：16164634
> 
> 赞同：1
> 
> 时间：2013-04-23T08:35:02.263
> 
> 标签：selenium, playframework, playframework-2.0, integration-testing, fluent

I execute a minimal integration test in my play project like this:

```
@Test
public void test() {
    Logger.info("start integration test");
    running(testServer(3333, fakeApplication(inMemoryDatabase())), FIREFOX, new Callback<TestBrowser>() {
        public void invoke(TestBrowser browser) {
            Logger.info("invoke test browser");
            browser.goTo("http://localhost:3333/linklist");
            assertThat(browser.pageSource()).contains("Some string in my page");
        }
    });
} 
```

I have split the project into subprojects (`main->frontend->common` and `main->backend->common`). The integration test runs in the main project.

**Edited**

In the test run it gets until the `browser.goTo("http://localhost:3333/linklist");` and stops after 45 sec.

Firefox opens and nothing is happening. But I can put myself the url `http://localhost:3333/linklist` and like this it *goTo* the page.

Looks like the `browser` instance is not the same as the one which opens.

Here the error message:

```
org.openqa.selenium.firefox.NotConnectedException: Unable to connect to host 127.0.0.1 on port 7055 after 45000 ms. Firefox console output:
    *** LOG addons.manager: Application has been upgraded
    *** LOG addons.xpi: startup
    *** LOG addons.xpi: Ignoring file entry whose name is not a valid add-on ID: /tmp/anonymous8443545555667681718webdriver-profile/extensions/webdriver-staging
    *** LOG addons.xpi: checkForChanges
    *** LOG addons.xpi-utils: Opening database
    *** LOG addons.xpi-utils: Creating database schema
    *** LOG addons.xpi: New add-on fxdriver@googlecode.com installed in app-profile
    *** LOG addons.xpi: New add-on langpack-en-ZA@firefox.mozilla.org installed in app-global
    *** LOG addons.xpi: New add-on {972ce4c6-7e08-4474-a285-3208198ce6fd} installed in app-global
    *** LOG addons.xpi: New add-on langpack-en-GB@firefox.mozilla.org installed in app-global
    *** LOG addons.xpi: New add-on globalmenu@ubuntu.com installed in app-global
    *** LOG addons.xpi: New add-on langpack-de@firefox.mozilla.org installed in app-global
    *** LOG addons.xpi: New add-on ubufox@ubuntu.com installed in app-system-share
    *** LOG addons.xpi: Updating database with changes to installed add-ons
    *** LOG addons.xpi-utils: Updating add-on states
    *** LOG addons.xpi-utils: Writing add-ons list
    *** LOG addons.manager: shutdown
    *** LOG addons.xpi: shutdown
    *** LOG addons.xpi-utils: shutdown
    *** LOG addons.xpi-utils: Database closed
    *** LOG addons.xpi: startup
    *** LOG addons.xpi: Ignoring file entry whose name is not a valid add-on ID: /tmp/anonymous8443545555667681718webdriver-profile/extensions/webdriver-staging
    *** LOG addons.xpi: checkForChanges
    *** LOG addons.xpi: No changes found

        at org.openqa.selenium.firefox.internal.NewProfileExtensionConnection.start(NewProfileExtensionConnection.java:109)
        at org.openqa.selenium.firefox.FirefoxDriver.startClient(FirefoxDriver.java:245)
        at org.openqa.selenium.remote.RemoteWebDriver.<init>(RemoteWebDriver.java:109)
        at org.openqa.selenium.firefox.FirefoxDriver.<init>(FirefoxDriver.java:183)
        at org.openqa.selenium.firefox.FirefoxDriver.<init>(FirefoxDriver.java:178)
        at org.openqa.selenium.firefox.FirefoxDriver.<init>(FirefoxDriver.java:174)
        at org.openqa.selenium.firefox.FirefoxDriver.<init>(FirefoxDriver.java:92)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
        at java.lang.Class.newInstance0(Class.java:374)
        at java.lang.Class.newInstance(Class.java:327)
        at play.api.test.WebDriverFactory$.apply(Selenium.scala:95)
        at play.api.test.WebDriverFactory.apply(Selenium.scala)
        at play.test.TestBrowser.<init>(TestBrowser.java:24)
        at play.test.Helpers.testBrowser(Helpers.java:467)
        at play.test.Helpers.testBrowser(Helpers.java:459)
        at play.test.Helpers.running(Helpers.java:427)
        at frontend.IntegrationTest.test(IntegrationTest.java:27)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
        at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
        at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
        at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
        at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
        at org.junit.runners.Suite.runChild(Suite.java:128)
        at org.junit.runners.Suite.runChild(Suite.java:24)
        at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
        at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
        at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
        at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
        at org.junit.runner.JUnitCore.run(JUnitCore.java:136)
        at com.novocode.junit.JUnitRunner.run(JUnitRunner.java:84)
        at sbt.ForkMain$Run.runTests(ForkMain.java:155)
        at sbt.ForkMain$Run.run(ForkMain.java:169)
        at sbt.ForkMain.main(ForkMain.java:84)
    [error] Test frontend.IntegrationTest.test failed: org.openqa.selenium.WebDriverException: Failed to connect to binary FirefoxBinary(/usr/bin/firefox) on port 7055; process output follows: 
    [error] *** LOG addons.manager: Application has been upgraded
    [error] *** LOG addons.xpi: startup
    [error] *** LOG addons.xpi: Ignoring file entry whose name is not a valid add-on ID: /tmp/anonymous8443545555667681718webdriver-profile/extensions/webdriver-staging
    [error] *** LOG addons.xpi: checkForChanges
    [error] *** LOG addons.xpi-utils: Opening database
    [error] *** LOG addons.xpi-utils: Creating database schema
    [error] *** LOG addons.xpi: New add-on fxdriver@googlecode.com installed in app-profile
    [error] *** LOG addons.xpi: New add-on langpack-en-ZA@firefox.mozilla.org installed in app-global
    [error] *** LOG addons.xpi: New add-on {972ce4c6-7e08-4474-a285-3208198ce6fd} installed in app-global
    [error] *** LOG addons.xpi: New add-on langpack-en-GB@firefox.mozilla.org installed in app-global
    [error] *** LOG addons.xpi: New add-on globalmenu@ubuntu.com installed in app-global
    [error] *** LOG addons.xpi: New add-on langpack-de@firefox.mozilla.org installed in app-global
    [error] *** LOG addons.xpi: New add-on ubufox@ubuntu.com installed in app-system-share
    [error] *** LOG addons.xpi: Updating database with changes to installed add-ons
    [error] *** LOG addons.xpi-utils: Updating add-on states
    [error] *** LOG addons.xpi-utils: Writing add-ons list
    [error] *** LOG addons.manager: shutdown
    [error] *** LOG addons.xpi: shutdown
    [error] *** LOG addons.xpi-utils: shutdown
    [error] *** LOG addons.xpi-utils: Database closed
    [error] *** LOG addons.xpi: startup
    [error] *** LOG addons.xpi: Ignoring file entry whose name is not a valid add-on ID: /tmp/anonymous8443545555667681718webdriver-profile/extensions/webdriver-staging
    [error] *** LOG addons.xpi: checkForChanges
    [error] *** LOG addons.xpi: No changes found
    [error] 
    [error] Build info: version: '2.25.0', revision: '17482', time: '2012-07-18 22:18:01'
    [error] System info: os.name: 'Linux', os.arch: 'amd64', os.version: '3.5.0-28-generic', java.version: '1.7.0_21'
    [error] Driver info: driver.version: FirefoxDriver
    [error]     at play.test.Helpers.running(Helpers.java:430)
    [error]     at frontend.IntegrationTest.test(IntegrationTest.java:27)
    [error]     ...
    [error] Caused by: org.openqa.selenium.WebDriverException: Failed to connect to binary FirefoxBinary(/usr/bin/firefox) on port 7055; process output follows: 
    [error] *** LOG addons.manager: Application has been upgraded
    [error] *** LOG addons.xpi: startup
    [error] *** LOG addons.xpi: Ignoring file entry whose name is not a valid add-on ID: /tmp/anonymous8443545555667681718webdriver-profile/extensions/webdriver-staging
    [error] *** LOG addons.xpi: checkForChanges
    [error] *** LOG addons.xpi-utils: Opening database
    [error] *** LOG addons.xpi-utils: Creating database schema
    [error] *** LOG addons.xpi: New add-on fxdriver@googlecode.com installed in app-profile
    [error] *** LOG addons.xpi: New add-on langpack-en-ZA@firefox.mozilla.org installed in app-global
    [error] *** LOG addons.xpi: New add-on {972ce4c6-7e08-4474-a285-3208198ce6fd} installed in app-global
    [error] *** LOG addons.xpi: New add-on langpack-en-GB@firefox.mozilla.org installed in app-global
    [error] *** LOG addons.xpi: New add-on globalmenu@ubuntu.com installed in app-global
    [error] *** LOG addons.xpi: New add-on langpack-de@firefox.mozilla.org installed in app-global
    [error] *** LOG addons.xpi: New add-on ubufox@ubuntu.com installed in app-system-share
    [error] *** LOG addons.xpi: Updating database with changes to installed add-ons
    [error] *** LOG addons.xpi-utils: Updating add-on states
    [error] *** LOG addons.xpi-utils: Writing add-ons list
    [error] *** LOG addons.manager: shutdown
    [error] *** LOG addons.xpi: shutdown
    [error] *** LOG addons.xpi-utils: shutdown
    [error] *** LOG addons.xpi-utils: Database closed
    [error] *** LOG addons.xpi: startup
    [error] *** LOG addons.xpi: Ignoring file entry whose name is not a valid add-on ID: /tmp/anonymous8443545555667681718webdriver-profile/extensions/webdriver-staging
    [error] *** LOG addons.xpi: checkForChanges
    [error] *** LOG addons.xpi: No changes found
    [error] 
    [error] Build info: version: '2.25.0', revision: '17482', time: '2012-07-18 22:18:01'
    [error] System info: os.name: 'Linux', os.arch: 'amd64', os.version: '3.5.0-28-generic', java.version: '1.7.0_21'
    [error] Driver info: driver.version: FirefoxDriver
    [error]     at org.openqa.selenium.firefox.internal.NewProfileExtensionConnection.start(NewProfileExtensionConnection.java:121)
    [error]     at org.openqa.selenium.firefox.FirefoxDriver.startClient(FirefoxDriver.java:245)
    [error]     at org.openqa.selenium.remote.RemoteWebDriver.<init>(RemoteWebDriver.java:109)
    [error]     at org.openqa.selenium.firefox.FirefoxDriver.<init>(FirefoxDriver.java:183)
    [error]     at org.openqa.selenium.firefox.FirefoxDriver.<init>(FirefoxDriver.java:178)
    [error]     at org.openqa.selenium.firefox.FirefoxDriver.<init>(FirefoxDriver.java:174)
    [error]     at org.openqa.selenium.firefox.FirefoxDriver.<init>(FirefoxDriver.java:92)
    [error]     at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    [error]     at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    [error]     at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    [error]     at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    [error]     at java.lang.Class.newInstance0(Class.java:374)
    [error]     at java.lang.Class.newInstance(Class.java:327)
    [error]     at play.api.test.WebDriverFactory$.apply(Selenium.scala:95)
    [error]     at play.api.test.WebDriverFactory.apply(Selenium.scala)
    [error]     at play.test.TestBrowser.<init>(TestBrowser.java:24)
    [error]     at play.test.Helpers.testBrowser(Helpers.java:467)
    [error]     at play.test.Helpers.testBrowser(Helpers.java:459)
    [error]     at play.test.Helpers.running(Helpers.java:427)
    [error]     ... 32 more
    [error] Caused by: org.openqa.selenium.firefox.NotConnectedException: Unable to connect to host 127.0.0.1 on port 7055 after 45000 ms. Firefox console output:
    [error] *** LOG addons.manager: Application has been upgraded
    [error] *** LOG addons.xpi: startup
    [error] *** LOG addons.xpi: Ignoring file entry whose name is not a valid add-on ID: /tmp/anonymous8443545555667681718webdriver-profile/extensions/webdriver-staging
    [error] *** LOG addons.xpi: checkForChanges
    [error] *** LOG addons.xpi-utils: Opening database
    [error] *** LOG addons.xpi-utils: Creating database schema
    [error] *** LOG addons.xpi: New add-on fxdriver@googlecode.com installed in app-profile
    [error] *** LOG addons.xpi: New add-on langpack-en-ZA@firefox.mozilla.org installed in app-global
    [error] *** LOG addons.xpi: New add-on {972ce4c6-7e08-4474-a285-3208198ce6fd} installed in app-global
    [error] *** LOG addons.xpi: New add-on langpack-en-GB@firefox.mozilla.org installed in app-global
    [error] *** LOG addons.xpi: New add-on globalmenu@ubuntu.com installed in app-global
    [error] *** LOG addons.xpi: New add-on langpack-de@firefox.mozilla.org installed in app-global
    [error] *** LOG addons.xpi: New add-on ubufox@ubuntu.com installed in app-system-share
    [error] *** LOG addons.xpi: Updating database with changes to installed add-ons
    [error] *** LOG addons.xpi-utils: Updating add-on states
    [error] *** LOG addons.xpi-utils: Writing add-ons list
    [error] *** LOG addons.manager: shutdown
    [error] *** LOG addons.xpi: shutdown
    [error] *** LOG addons.xpi-utils: shutdown
    [error] *** LOG addons.xpi-utils: Database closed
    [error] *** LOG addons.xpi: startup
    [error] *** LOG addons.xpi: Ignoring file entry whose name is not a valid add-on ID: /tmp/anonymous8443545555667681718webdriver-profile/extensions/webdriver-staging
    [error] *** LOG addons.xpi: checkForChanges
    [error] *** LOG addons.xpi: No changes found
    [error]     at org.openqa.selenium.firefox.internal.NewProfileExtensionConnection.start(NewProfileExtensionConnection.java:109)
    [error]     ... 50 more
    [info] frontend.IntegrationTest
    [info] x frontend.IntegrationTest.test
    [info] 
    [info] 
    [info] Total for test frontend.IntegrationTest
    [info] Finished in 0.01 seconds
    [info] 1 tests, 1 failures, 0 errors
    [error] Failed: : Total 1, Failed 1, Errors 0, Passed 0, Skipped 0
    [error] Failed tests:
    [error]     frontend.IntegrationTest
    [error] (myapp/test:test-only) Tests unsuccessful
    [error] Total time: 58 s, completed May 3, 2013 4:09:49 PM 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-05T13:00:04.163

我发现了问题：

*   首先我尝试使用 HTMLUNIT，但这不适用于 javascript，所以我将其更改为 FIREFOX
*   然后我遇到了我的Firefox版本（20）是新的问题，所以我降级到版本15

现在我的集成测试工作正常！

# c++ - Initial directory is not working for CFileDialog

> ID：16164637
> 
> 赞同：7
> 
> 时间：2013-04-23T08:35:15.330
> 
> 标签：c++, mfc, cfiledialog

I am using CFileDialog, I have set the initial path like below , as shown in the code. It's not working . Correct me if I made a mistake.

```
 CFileDialog* filedlg = new CFileDialog(TRUE,(LPCTSTR)NULL ,  (LPCTSTR)NULL , OFN_HIDEREADONLY| OFN_ENABLESIZING , (LPCTSTR)NULL , FromHandle (hImgDlg) ,0 , FALSE  );

   filedlg ->m_ofn.lpstrInitialDir = "C:\\" ;

   if ( filedlg ->DoModal() == IDOK )
   {
       /***  do somthing here *****/
   } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-04-28T16:21:51.933

如果您设置文件名位置，您可以让对话框打开到特定位置。如果您确实需要打开文件夹位置或者您有使用的默认文件名，我只会使用它。

```
CFileDialog* filedlg = new CFileDialog(TRUE, (LPCTSTR)NULL,  (LPCTSTR)_T("C:\\MyFolder\\DefaultFileName.ext"), OFN_HIDEREADONLY | OFN_ENABLESIZING, (LPCTSTR)NULL, FromHandle (hImgDlg), 0, FALSE); 
```

或者您可以使用 Windows 功能`GetModuleFileName`：

```
CString csAppFolder;
TCHAR szPath[MAX_PATH]; 

// form the path to where we want to store the file
if (GetModuleFileName(NULL, szPath, MAX_PATH))
{
    PathRemoveFileSpec(szPath);
    csAppFolder = szPath;
}

CFileDialog* filedlg = new CFileDialog(TRUE, (LPCTSTR)NULL, (LPCTSTR)(csAppFolder + _T("\\DefaultFileName.ext")), OFN_HIDEREADONLY | OFN_ENABLESIZING, (LPCTSTR)NULL, FromHandle (hImgDlg), 0, FALSE); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-23T10:10:05.410

如果您看到[`OPENFILENAME`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646839%28v=vs.100%29.aspx)结构的参考，您将看到`lpstrInitialDir`它声明的字段：

> 如果与应用程序第一次使用或对话框`lpstrInitialDir`时传递的值相同，则用户最近选择的路径将用作初始目录。`Open``Save As`

这意味着该`lpstrInitialDir`字段实际上只能在您第一次在程序中使用对话框时使用。其余时间它将使用用户选择的最后一个目录。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-02-17T10:28:33.217

两个选项： 1\. 老式对话框样式，指定 OFN::lpstrInitialDir

```
CFileLatinDialog dlg (TRUE, "", "" /*lpszFileName */,
   OFN_PATHMUSTEXIST | OFN_FILEMUSTEXIST | OFN_HIDEREADONLY,
   "All Files(*.*)|*.*||", this, 0,
   FALSE /*bVistaStyle*/);
dlg.m_ofn.lpstrInitialDir = "C:\\Models\\"; 
```

2.  Vista 风格对话框，指定 lpszFileName 参数

```
CFileLatinDialog dlg (TRUE, "", "C:\\Models\\" /*lpszFileName */,
   OFN_PATHMUSTEXIST | OFN_FILEMUSTEXIST | OFN_HIDEREADONLY,
   "所有文件(*.*)|*.*||", this);

```

# c# - Is it possible to design a C# class that when querying it through reflections will mark itself as positive IsValueType and positive IsClass?

> ID：16164639
> 
> 赞同：9
> 
> 时间：2013-04-23T08:35:18.077
> 
> 标签：c#, .net, reflection

Is it possible to design a C# class that when querying it through reflections will mark itself as positive IsValueType and positive IsClass?

Or are they actually mutually exclusive markings?

I know that,

Most primitive types will return (including enums & structs):
**IsValueType=true, IsClass=false.**

String or any class - abstracts too.. return:
**IsValueType=false, IsClass=true.**

Interfaces returns:
**IsValueType=false, IsClass=false**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T08:49:38.440

> 是否可以设计一个 C# 类，当通过反射查询它时会将其自身标记为正 IsValueType 和正 IsClass？

让我们看一下这些实现：

```
protected virtual bool IsValueTypeImpl()
{
      return this.IsSubclassOf((Type) RuntimeType.ValueType);
}

public bool IsClass
{
  [__DynamicallyInvokable] get
  {
    if ((this.GetAttributeFlagsImpl() & TypeAttributes.ClassSemanticsMask) == TypeAttributes.NotPublic)
      return !this.IsValueType;
    else
      return false;
  }
} 
```

如您所见，`IsValueTypeImpl()`（由`IsValueType`属性调用）**依赖于继承**并且`IsClass` **依赖于** `IsValueType`（！）。

接下来，[这个 ValueType 的描述](http://msdn.microsoft.com/en-us/library/system.valuetype.aspx)表明**不能直接从 ValueType 继承**。

所以，答案是**否定**的，你不能同时创建`IsClass`类型`IsValueType`

# unit-testing - 如何填充 HttpWebRequest

> ID：16164640
> 
> 赞同：2
> 
> 时间：2013-04-23T08:35:20.023
> 
> 标签：unit-testing, mstest, tfsbuild, microsoft-fakes

我在尝试填充 HttpWebRequest 时遇到问题。如果您只是添加系统程序集的伪造程序集，它不会立即工作。但是，如果您更改 fakes 文件并添加它可以工作的特定命名空间。

```
<Fakes xmlns="http://schemas.microsoft.com/fakes/2011/">
  <Assembly Name="System" Version="4.0.0.0"/>
  <ShimGeneration>
    <Clear/>
    <Add FullName="System.Net.WebRequest!"/>
    <Add FullName="System.Net.HttpWebRequest!"/>
    <Add FullName="System.Net.HttpWebResponse!"/>
  </ShimGeneration>
</Fakes> 
```

问题是这只适用于本地。尝试解析 ShimHttpWebRequest 时，Team Foundation Server 上的自动构建会引发错误。看起来自动构建忽略了假文件，因为当我在构建服务器上使用 VS 手动构建它时，它可以工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-27T14:55:25.750

转到程序集参考并添加 System.Net 假程序集。双击 System.Net.Fake 文件并在 System.Net.Fake 文件中添加以下条目

```
<Fakes xmlns="http://schemas.microsoft.com/fakes/2011/" Diagnostic="true">
<Assembly Name="System" Version="4.0.0.0"/>
<StubGeneration>
  <Clear/>
</StubGeneration>
<ShimGeneration>
   <Clear/>
   <Add FullName="System!"/>
   <Add FullName="System.Net!"/>
   <Add FullName="System.Net.WebRequest!"/>
   <Add FullName="System.Net.HttpWebRequest!"/>
   <Add FullName="System.Net.HttpWebResponse!"/>
 </ShimGeneration>
 </Fakes> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-11-12T15:54:31.220

我有同样的问题。尝试提交到项目主目录中的 build-server 目录“FakesAssemblies”。

# caroufredsel - 如何在 carouFredSel 中显示可变宽度的图像？

> ID：16164648
> 
> 赞同：0
> 
> 时间：2013-04-23T08:35:53.903
> 
> 标签：caroufredsel

当我们在 css 肖像照片中设置 img 宽度时会拉伸。当我们不设置 img 宽度时 carouFredSel 在当前图像旁边显示其他图像的部分。我们如何在固定宽度的轮播中只显示一张（人像）照片？

----js--------

```
$('#carousel').carouFredSel({
        width: '100%',

        items: {
            visible: 3,
            minimum: 1,
            start: 0,
            width: '100%',
            align:'center'
        },
        scroll: {
            items: 1,
            duration: 800,
            timeoutDuration: 3000
        },
        prev: '#prev',
        next: '#next',
        pagination: {
            container: '#pager',
            deviation: 0
        },
        auto: {
            pauseOnHover: true
        }
    }); 
```

--------css------------

```
#carousel img {
display: block;
float: left;
/*width: 978px;*/
height: 652px;
background: white;
text-align: center; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:06:55.887

希望我理解正确。以下内容应使图像居中而不调整包含元素的大小

```
 $("#carousel").carouFredSel({
    width: "auto",
    height: "variable"  
}) 
```

而以下内容会将包含元素的大小调整为图像的宽度

```
 $("#carousel").carouFredSel({
    width: "variable",
    height: "variable"  
}) 
```

# c++ - SFINAE 和定义顺序

> ID：16164650
> 
> 赞同：3
> 
> 时间：2013-04-23T08:35:58.397
> 
> 标签：c++, c++11, sfinae

考虑这个简单的 SFINAE 测试来确定一个类型是否可以作为参数`std::begin`

```
#include <utility>

    template <class T> constexpr auto
std_begin_callable (T const*) -> decltype (std::begin (std::declval <T>()), bool ()) 
{ return true; }

    template <class> constexpr bool
std_begin_callable (...) 
{ return false; }

#include <array>

static_assert (std_begin_callable <std::array <int, 3>> (0), "failed");

int main () {} 
```

请注意，定义特`array`化 for 的标头包含*在*SFINAE 函数之后。断言失败。现在，如果我移动之前，它的工作原理。（gcc 4.8.0 20130411，clang 版本 3.2）`std::begin`*`#include <array>`*

 *我不明白为什么。作为模板的 SFINAE 函数，在包含定义他们测试的函数的标头之后，它们不应该在需要时在静态断言中实例化吗？

问题是我的 SFINAE 在标头中，我必须确保它包含*在*任何其他容器标头之后（此问题未专门链接到`array`标头）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T00:31:02.970

正如**[Xeo](https://stackoverflow.com/users/500104/xeo)所说**，要使其工作，您必须`#include <iterator>`引入适当的定义`begin`。更准确地说，这有效：

```
#include <iterator>
#include <utility>

template <class T> constexpr auto
std_begin_callable (T const*) -> decltype (std::begin (std::declval <T>()), bool ()) 
{ return true; }

template <class> constexpr bool
std_begin_callable (...) 
{ return false; }

#include <array>

static_assert (std_begin_callable <std::array <int, 3>> (0), "failed");

int main () {} 
```

现在，让我们看看为什么不包含`<iterator>`编译但没有给出预期结果的原始代码（除非你向上移动`#include <array>`）。

包含`<utility>`间接意味着包含`<initializer_list>`which 定义`std::begin(std::initializer_list<T>)`。因此，在此翻译单元中，名称`std::begin`是可见的。

但是，当您调用`std_begin_callable`第一个重载时，SFINAEd 消失了，因为可见`std::begin`不能采用`std::array`.

现在，如果您完全删除`<iterator>`and的包含`<utility>`（保留`<array>`在 之后`std_begin_callable`），那么编译将失败，因为编译器将不再看到`std::begin`or的任何重载`std::declval`：

```
template <class T> constexpr auto
std_begin_callable (T const*) -> decltype (std::begin (std::declval <T>()), bool ()) 
{ return true; } // error: begin/declval is not a member of std

template <class> constexpr bool
std_begin_callable (...) 
{ return false; }

#include <array>

static_assert (std_begin_callable <std::array <int, 3>> (0), "failed");

int main () {} 
```

最后，您可以使用以下方法复制/简化以前的错误行为：

```
namespace std {

  void begin();

  template <typename T>
  T&& declval();

}

template <class T> constexpr auto
std_begin_callable (T const*) -> decltype (std::begin (std::declval <T>()), bool ()) 
{ return true; } // No compiler error here, just SFINAE.

template <class> constexpr bool
std_begin_callable (...) 
{ return false; }

#include <array>

static_assert (std_begin_callable <std::array <int, 3>> (0), "failed");

int main () {} 
```

**更新：**

从评论（此处和 OP 中）中，我想不可能以您想要的方式解决头文件顺序问题。那么，让我建议一种基于 ADL 的解决方法，它接近于解决方案，并且可能（但可能不是）对您的用例来说足够好：

```
// <your_header_file>
#include <iterator>
#include <utility>

namespace detail {

    using std::begin;

    template <typename T, typename = decltype(begin(*((T*)0)))>
    constexpr std::true_type std_begin_callable(int) { return std::true_type(); }

    template <typename>
    constexpr std::false_type std_begin_callable(long) { return std::false_type(); };

};

template <typename T>
constexpr auto std_begin_callable() ->
  decltype(detail::std_begin_callable<typename std::remove_reference<T>::type>(0)) {
  return detail::std_begin_callable<typename std::remove_reference<T>::type>(0);
}
// </your_header_file>   

// <a_supposedly_std_header_file>
namespace std {
    struct foo { int begin() /* const */; }; 
    struct bar;
    int begin(/*const*/ bar&);

    template <typename T> struct goo;

    template <typename T>
    int begin(/*const*/ goo<T>&);
}
// </a_supposedly_std_header_file>

// <a_3rd_party_header_file>
namespace ns {

    struct foo { int begin() /*const*/; };
    struct bar;
    int begin(/*const*/ bar&);

    template <typename T> struct goo;

    template <typename T>
    int begin(/*const*/ goo<T>&);

}
// </a_3rd_party_header_file>

//<some_tests>
static_assert ( std_begin_callable</*const*/ std::foo>(), "failed");
static_assert ( std_begin_callable</*const*/ std::bar>(), "failed");
static_assert ( std_begin_callable</*const*/ std::goo<int>>(), "failed");

static_assert ( std_begin_callable</*const*/ ns::foo>(), "failed");
static_assert ( std_begin_callable</*const*/ ns::bar>(), "failed");
static_assert ( std_begin_callable</*const*/ ns::goo<int>>(), "failed");
//</some_tests>

int main () {} 
```

它似乎有效，但我还没有完全测试。我建议您在代码中尝试使用/不使用注释掉`const`的几种组合。

我使用`*((T*)0)`而不是`std::declval<T>()`因为一个常量问题。要看到它，放回去，`declval`然后尝试`static_assert`离开非。`const ns::foo``ns::foo::begin``const`*

# android - Android NDK 返回 C++ 指针适用于模拟器但不适用于设备

> ID：16164651
> 
> 赞同：0
> 
> 时间：2013-04-23T08:36:07.617
> 
> 标签：android, c++, android-ndk, garbage-collection, java-native-interface

所以我试图在我的 NDK 调用之间保留一个 C++ 类的实例，即下面的新 NetPoco 指针不起作用。

在模拟器中一切正常，但在设备上似乎陷入错误循环。我怀疑当程序从 jsonCreate 返回时，GC 会丢弃我的指针对象，因此以后无法在 jsonParse 中使用它，我该如何解决这个问题？

（请注意，自从代码在设备上运行以来，唯一改变的是：将 NetPoco 的实例化从 parse 移动到 create，即创建一个持久指针。）

错误循环显示在代码下方，错误似乎来自：

```
for(int i = 0; i < ref->storeRefs.size();i++) 
```

但我不确定它确实如此，似乎 storeRefs 没有保留在 ref 中......

```
long jsonCreate(JNIEnv* aEnv, jobject aObj, jstring str){
    const char * natStr = aEnv->GetStringUTFChars(str,0);
    return (jlong)new NetPoco(natStr);
}

bool jsonParse(JNIEnv* aEnv, jobject aObj, jlong pointer){

    //JSON FROM NETWORK:
    StoreRefListComplexType *ref;
    int iterations = 1;
    for (int i = 0; i < iterations; i++) {

        ref = ((NetPoco*)pointer)->getStoreRefListComplexType();
        if (i < iterations - 1) delete ref;
    }
    //delete netHelper;

    //Callback to populate ArrayList in java:
    jclass cls = aEnv->FindClass("com/example/jsonpoco/MainActivity");
    jmethodID methodid = aEnv->GetMethodID(cls, "add", "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;DD)V");
    std::list<StoreRefComplexType>::iterator it = ref->storeRefs.begin();
    for(int i = 0; i < ref->storeRefs.size();i++){
        jstring storeNo = aEnv->NewStringUTF(it->getStoreNo().c_str());
        jstring storeName = aEnv->NewStringUTF(it->getStoreName().c_str());
        jstring storeUrl = aEnv->NewStringUTF(it->getStoreUrl().c_str());
        aEnv->CallVoidMethod(aObj,methodid, storeNo, storeName, storeUrl, it->getStoreLocation()->getLatitude(), it->getStoreLocation()->getLongitude());
        std::advance(it, 1);
    }
    //delete ref;
    return ((jboolean)((NetPoco*)pointer)->usingCached);
} 
```

> 04-23 10:29:31.928: D/dalvikvm(21469): 试图加载 lib /data/app-lib/com.example.jsonpoco-2/libJsonPoco.so 0x417a76b8
> 
> 04-23 10:29:31.936: D/dalvikvm(21469): 添加共享库 /data/app-lib/com.example.jsonpoco-2/libJsonPoco.so 0x417a76b8
> 
> 04-23 10:29:31.967: I/dalvikvm(21469): TRACE STARTED: '/storage/emulated/legacy/jsonjavanc_profiling.trace' 8192KB
> 
> 04-23 10:29:31.983: D/dalvikvm(21469): +++ 活动分析器计数现在 1
> 
> 04-23 10:29:32.404: A/libc(21469): 致命信号 11 (SIGSEGV) 在 0x00000004 (code=1), 线程 21469 (xample.jsonpoco)
> 
> 04-23 10:29:33.803: D/dalvikvm(21497): 试图加载 lib /data/app-lib/com.example.jsonpoco-2/libJsonPoco.so 0x4179efd8
> 
> 04-23 10:29:33.811: D/dalvikvm(21497): 添加共享库 /data/app-lib/com.example.jsonpoco-2/libJsonPoco.so 0x4179efd8
> 
> 04-23 10:29:33.850: I/dalvikvm(21497): TRACE STARTED: '/storage/emulated/legacy/jsonjavanc_profiling.trace' 8192KB
> 
> 04-23 10:29:33.865: D/dalvikvm(21497): +++ 活动分析器计数现在 1
> 
> 04-23 10:29:34.295: A/libc(21497): 致命信号 11 (SIGSEGV) 在 0x00000004 (code=1), 线程 21497 (xample.jsonpoco)
> 
> 04-23 10:29:34.779: D/dalvikvm(21512): 试图加载 lib /data/app-lib/com.example.jsonpoco-2/libJsonPoco.so 0x417a0668
> 
> 04-23 10:29:34.779: D/dalvikvm(21512): 添加共享库 /data/app-lib/com.example.jsonpoco-2/libJsonPoco.so 0x417a0668
> 
> 04-23 10:29:34.819: I/dalvikvm(21512): TRACE STARTED: '/storage/emulated/legacy/jsonjavanc_profiling.trace' 8192KB
> 
> 04-23 10:29:34.834: D/dalvikvm(21512): +++ 活动分析器计数现在 1
> 
> 04-23 10:29:35.264: A/libc(21512): 致命信号 11 (SIGSEGV) 在 0x00000004 (code=1), 线程 21512 (xample.jsonpoco)

NDK-STACK 结果：

Exjobbs-MacBook-Pro:android-ndk-r8d exjobb$ ./ndk-stack -sym /Users/exjobb/code/eclipse/NetPocoCache/libs/ -dump /Users/exjobb/log.txt ***** ******崩溃转储：******* ***** 构建指纹：'google/yakju/maguro:4.2.2/JDQ39/573038:user/release-keys' pid: 8624, tid: 8624, name: xample.jsonpoco >>> com.example.jsonpoco << < 信号 11 (SIGSEGV)，代码 1 (SEGV_MAPERR)，故障地址 00000004 堆栈帧 #00 pc 00062ff8 /data/app-lib/com.example.jsonpoco-1/libJsonPoco.so (jsonParse+104) 堆栈帧 #01 pc 00040da1 /system/lib/libdvm.so 故障转储完成***

 **************崩溃转储：******* ***** 构建指纹：'google/yakju/maguro:4.2.2/JDQ39/573038:user/release-keys' pid: 8639, tid: 8639, name: xample.jsonpoco >>> com.example.jsonpoco << < 信号 11 (SIGSEGV)，代码 1 (SEGV_MAPERR)，故障地址 00000004 堆栈帧 #00 pc 00062ff8 /data/app-lib/com.example.jsonpoco-1/libJsonPoco.so (jsonParse+104) 堆栈帧 #01 pc 00040da1 /system/lib/libdvm.so 故障转储完成*****

 ****************崩溃转储：******* ***** 构建指纹：'google/yakju/maguro:4.2.2/JDQ39/573038:user/release-keys' pid: 8653, tid: 8653, name: xample.jsonpoco >>> com.example.jsonpoco << < 信号 11 (SIGSEGV)，代码 1 (SEGV_MAPERR)，故障地址 00000004 堆栈帧 #00 pc 00062ff8 /data/app-lib/com.example.jsonpoco-1/libJsonPoco.so (jsonParse+104) 堆栈帧 #01 pc 00040da1 /system/lib/libdvm.so 故障转储完成*****

 ****************崩溃转储：******* ***** 构建指纹：'google/yakju/maguro:4.2.2/JDQ39/573038:user/release-keys' pid: 8667, tid: 8667, name: xample.jsonpoco >>> com.example.jsonpoco << < 信号 11 (SIGSEGV)，代码 1 (SEGV_MAPERR)，故障地址 00000004 堆栈帧 #00 pc 00062ff8 /data/app-lib/com.example.jsonpoco-1/libJsonPoco.so (jsonParse+104) 堆栈帧 #01 pc 00040da1 /system/lib/libdvm.so 故障转储完成*****

 ****************崩溃转储：******* ***** 构建指纹：'google/yakju/maguro:4.2.2/JDQ39/573038:user/release-keys' pid: 8681, tid: 8681, name: xample.jsonpoco >>> com.example.jsonpoco << < 信号 11 (SIGSEGV)，代码 1 (SEGV_MAPERR)，故障地址 00000004 堆栈帧 #00 pc 00062ff8 /data/app-lib/com.example.jsonpoco-1/libJsonPoco.so (jsonParse+104) 堆栈帧 #01 pc 00040da1 /system/lib/libdvm.so 故障转储完成*****

 *******更新：** 所以我一直在减少代码，但仍然会崩溃，现在代码减少到了：

```
bool jsonParse(JNIEnv* aEnv, jobject aObj, jlong pointer){

//JSON FROM NETWORK:
StoreRefListComplexType *ref;
ref = ((NetPoco*)pointer)->getStoreRefListComplexType();
jclass cls = aEnv->FindClass("com/example/jsonpoco/MainActivity");
jmethodID methodid = aEnv->GetMethodID(cls, "add", "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;DD)V");
std::list<StoreRefComplexType>::iterator it;// = ref->storeRefs.begin();
printf(ref->storeRefs.size()); 
```

崩溃的原因似乎取决于使用 wifi 或 3g，3g 有效！当我确定时会进一步更新。您的回答使我的代码变得更好！***********************

# php - 调用函数 php joomla 不起作用

> ID：16164652
> 
> 赞同：0
> 
> 时间：2013-04-23T08:36:11.147
> 
> 标签：php, function, joomla, wsod

我写了一个与 joomla 数据库集成的简单 php 页面。我写了两个函数并调用了它们。

如果函数中的代码被写为非函数（在代码本身上）它可以完美地工作。但！当代码运行并从页面调用时，整个屏幕变白。

代码很简单……第一个函数获取用户的 id 并返回表中数字的总和。第二个函数获取用户的用户名并返回它的 ID 号。为了确保这些功能正常工作，我向他们发送了特定的值（第一个函数为 24，第二个函数为 'admin'）。

编码：

```
<?php
    defined('_JEXEC') or die('Restricted access');
    $items = $params->get('items', 10);
    $db =& JFactory::getDBO();

    function get_sum($uid)
    {
        $sum = 0;
        $query = "SELECT orderpayment_amount 
            FROM #__j2store_orders 
            WHERE user_id = '$uid' 
            ORDER BY id DESC";
        $db->setQuery( $query, 0 , $items );
        $rows = $db->loadObjectList();
        foreach($rows as $row)
        {
            $sum = $sum + $row->orderpayment_amount;
        }
        return "$sum";
    }

    function getTalId($u)
    { 
        $query = "SELECT id 
                  FROM #__users 
                  WHERE username = '$u' 
                  ORDER BY id DESC";
        $db->setQuery( $query, 0 , $items );
        $rows = $db->loadObjectList();
        foreach($rows as $row)
        {
            return $row->id;
        }
    }

    echo get_sum(42);
    echo getTalId('admin');
?> 
```

我被这个问题困了两天。我会很感激任何帮助。谢谢一个头。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T09:49:11.337

您正在经历的是白屏死机。

很可能您已关闭错误报告（建议用于生产） t 出现错误，但未显示在屏幕上。您可以：

*   更改错误报告（系统 > 全局配置 > 服务器 > 错误报告：开发）
*   检查您的服务器错误日志。

至于为什么会发生这种情况，我想说您无权访问函数内部的 $db 变量（请参阅[此答案](https://stackoverflow.com/questions/2531221/giving-my-function-access-to-outside-variable)）。

如果代码在 Jooomla MVC 类模型中，`$db = $this->getDbo()`会做类似的事情。

我鼓励你使用类而不是函数，你会得到一些额外的东西，比如自动加载

# c# - 有没有机会将此原生 iOS API 调用“包装”到异步/等待中？

> ID：16164662
> 
> 赞同：3
> 
> 时间：2013-04-23T08:36:38.467
> 
> 标签：c#, xamarin.ios, async-await

考虑这个 iOS 6 API 调用：

```
eventStore.RequestAccess(EKEntityType.Event, (granted, error) => {
if(granted)
{
    events = this.GetLocalCalendarEvents(eventStore);
}}); 
```

我有一些代码可以访问日历并读取事件。在 iOS5 上，这只是工作，但在 iOS6 上，我必须先请求访问权限，如果获得访问权限，然后开始阅读。我想知道我是否可以以某种方式将其包装成 async/await 的组合来隐藏丑陋的委托。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T12:02:24.780

您可以使用`TaskCompletionSource`：

```
public Task<bool> DoSomethingAsync()
{
   var taskSource = new TaskCompletionSource<bool>();

   //Call some asynchronous Apple API
   NSSomeAppleApi.DoSomething(error =>
   {
      if (error != null)
         taskSource.SetException(new Exception(error.LocalizationDescription));
      else
         taskSource.SetResult(true);
   });

   return taskSource.Task;
} 
```

# android - android other activity click back key to listview,tab下listview项不能点击

> ID：16164663
> 
> 赞同：3
> 
> 时间：2013-04-23T08:36:38.700
> 
> 标签：android, listview, click, android-tabhost, back

我有一个tabhost，

选项卡 A 将连接 A 活动，

A 活动的布局有一个 Edittext、按钮和一个列表视图。

listview 是从 baseadapter 定制的。列表视图包括一个文本视图，没有按钮或图像......等。

当我进入程序时，listview项是可以点击的，

它将连接B subActivity。

但是当我点击返回键时，（返回A活动）

列表视图的项目不起作用，它必须向上或向下拖动，

该项目将变为点击正确。

我搜索了一些文学作品。

我曾尝试添加

```
 android:focusable="false"
    android:focusableInTouchMode="false"
    android:clickable="false"

    or

    descendantFocusability="blocksDescendants" 
```

在我的 listview 、 linearlayout 或 textview 中。

但问题是存在的。

如何解决问题？非常感谢您。

我的A布局如下：

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:tools="http://schemas.android.com/tools"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@color/bgColor"
        tools:context=".MainActivity" >

        <LinearLayout
            android:id="@+id/linearLayout1"
            android:layout_width="match_parent"
            android:layout_height="70dp"
            android:layout_alignParentLeft="true"
            android:layout_alignParentTop="true"
            android:focusable="true"
            android:focusableInTouchMode="true"
            android:gravity="center"
            android:orientation="horizontal" >

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:layout_gravity="center"
                android:layout_marginTop="4dp"
                android:layout_weight="1"
                android:gravity="center" >

                <EditText
                    android:id="@+id/drugText"
                    android:layout_width="224dp"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:ems="10"
                    android:gravity="center_vertical|center"
                    android:hint="@string/searchHint1"
                    android:textSize="18sp" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:layout_gravity="center"
                android:layout_weight="3"
                android:gravity="left" >

                <Button
                    android:id="@+id/query"
                    style="@style/ButtonText"
                    android:layout_width="70dp"
                    android:layout_height="48dp"
                    android:layout_gravity="center"
                    android:layout_marginTop="10dp"
                    android:background="@drawable/blue_btn"
                    android:text="@string/search"
                    android:textSize="20sp" />
            </LinearLayout>
        </LinearLayout>

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_alignParentLeft="true"
           android:layout_below="@+id/linearLayout1" >

            <ListView
                android:id="@+id/drugList"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:clickable="true" />
        </LinearLayout>

    </RelativeLayout> 
```

我的列表视图项目布局如下：

```
 <LinearLayout 
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical" >

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:background="@drawable/color_listview_border"
            android:gravity="center"
            android:minHeight="60dp" >

            <TextView
                android:id="@+id/drugNameTV"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="TextView"
                android:textSize="20sp" />
        </LinearLayout>

    </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T04:51:24.140

只需调用 adapter.notifyDataSetChanged(); 在 onResume 函数中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:46:03.843

You could store the listview state when you go to B subActivity. After come back to A subActivity you need to restore the listview state.

# java - 在 List 中查找子字符串并返回索引号

> ID：16164668
> 
> 赞同：0
> 
> 时间：2013-04-23T08:37:05.293
> 
> 标签：java, arrays, list, substring

我有一个列表，字符串如下：

```
String One
String Two
String Three 
```

现在我想获取子字符串“一”的索引号。我怎样才能得到这个？如果我将它转换为数组，我只能做到这一点，然后：

```
public static int findInArray(Object[] arr, String searchName) {
int i;
for (i=0; i<arr.length; i++ ) { 
    String test = arr[i].toString();
    if (test.contains(searchName)) {
        //System.out.println("Substring found in:"+i);
        break;
    }
}
return i;
} 
```

有没有办法在不将其转换为数组的情况下搜索子字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:40:22.493

*列表已包含索引*

```
 for(int i=0;i<list.size();++i){
     if (list.get(i).contains("searchString")) {
         System.out.println("Substring found in:"+i);
     }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:46:06.300

```
public static int find(List<String> list, String searchString) {
    for(int i=0 ; i < list.size() ; ++i){
        if (list.get(i).contains(searchString)) {
            return i;
        }
    }
    return -1;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-23T08:51:02.180

试试这个方法，你可以得到它的索引，或者返回-1表示没有找到。

```
public static int findInList(List<String> list, String searchName) {
    for(String str : list){
        if(str.indexOf(searchName) > -1){
          //System.out.println("Substring found in:"+i);
              return list.indexOf(str);
        }
    }
    return -1;
} 
```

# jquery - 使用 jQuery 最小化/最大化 div

> ID：16164672
> 
> 赞同：11
> 
> 时间：2013-04-23T08:37:13.943
> 
> 标签：jquery, html, minimize

我基本上想最小化一些 div 的。我不想使用“-”和“+”，而是想使用一些符号（来自 font-awesome）来最小化和最大化 div。

我关于这个的问题；如何在这段代码中插入图标​​的类？我尝试用 .attr 替换 .html 部分，但没有成功。

```
<script>
  $(".btn-minimize").click(function(){
    if($(this).html() == "-"){
      $(this).html("+");
    }
    else{
      $(this).html("-");
    }
    $(".widget-content").slideToggle();
  });
</script> 
```

非常感谢。

更新：

非常感谢您到目前为止的帮助。但是兄弟部分并不适合我，因为`.widget-content`它不是按钮之一。

总结一下；当我想最小化一个小部件并按下按钮时，所有具有该类的小部件都会`.widget-content`最小化。

**这是我的一段 HTML**

```
<!--widget-1-2-->
   <section class="widget span3">
      <!--front-->
      <div id="front" class="widget-1-2 flip">
         <div class="widget-header">
            <h2>Monthly Statistics</h2>
            <div class="btn-group pull-right">
               <button id="btn-front" class="btn"><i class="icon-cogs icon-white" alt="settings"></i></button>
               <button class="btn btn-minimize"><i class="icon-chevron-up icon-white" alt="minimize"></i></button>
               <button class="btn btn-close"><i class="icon-remove icon-white" alt="close"></i></button>
            </div>
         </div>
      <div class="widget-content"><p>Dit is de voorkant.</p></div>
   </div><!--/front-->
</section> 
```

**JavaScript 部分：**

```
<script>
   $(".icon-chevron-up").click(function(){
       $(this).toggleClass("icon-chevron-down");
       $(".widget-content").slideToggle();
    });
</script> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-23T08:41:36.417

假设您`.btn-minimize`在 CSS 中给出减号图标。您还提供`.btn-minimize.btn-plus`加号图标。然后您的 javascript 可以如下所示：

```
$(".btn-minimize").click(function(){
    $(this).toggleClass('btn-plus');
    $(".widget-content").slideToggle();
}); 
```

这是关于 JSFiddle 的示例：http: [//jsfiddle.net/uzmjq/](http://jsfiddle.net/uzmjq/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:43:40.760

您可以使用 CSS 将符号/图标应用为背景图像，然后只需有一个单独的 CSS 类，其中包含其他图标，然后只需在元素中切换此类。

**CSS**

```
.btn-minimize {
  background-image: url("/path/to/icon");
}

.maximize {
  background-image: url("/path/to/another/icon");
} 
```

**jQuery**

```
$(".btn-minimize").click(function() {
  $(this).toggleClass("maximize");
  $(".widget-content").slideToggle();
}); 
```

# antlr - 在 ANTLR C# 目标中禁用异常

> ID：16164677
> 
> 赞同：0
> 
> 时间：2013-04-23T08:37:22.470
> 
> 标签：antlr

是否有可能禁用从 ANTLR C# 目标引发的异常？或者它们是否需要解析器可以正常工作？如果可以以某种方式禁用异常会很好，因为它们会导致性能不佳，并且每次调试时都禁用 antlr 异常很烦人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T13:10:23.620

不能禁用这些例外。此外，不会为有效的输入序列引发异常，以最大限度地减少与异常相关的运行时开销。

C# 目标不仅是*所有*ANTLR 3 目标中最快的，而且在广泛的长期测试下，错误恢复所需的异常/处理机制从未成为性能瓶颈。

# php - php file_put_contents("nombre.rtf",$rtf); 不显示像ñ，ó，í这样的字符

> ID：16164686
> 
> 赞同：0
> 
> 时间：2013-04-23T08:37:47.633
> 
> 标签：php, special-characters, rtf

我的问题是：我正在尝试阅读 *. php 中的 RTF 将值添加到我在 mysql 中的数据库中，一切都很顺利，直到我打开生成的文件并且我看到没有特殊字符让我很好。这是我的代码，抱歉，这是我的第一篇文章，我不知道如何正确设置它：

```
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title></title>
    </head>
    <body>

<?php
ini_set("default_charset", "utf-8");
mysql_query("SET NAMES 'utf8'");

// Read rtf
$plantilla = file_get_contents('plantilla_titulo.rtf');

// Agregamos los escapes necesarios
$plantilla = addslashes($plantilla);
$plantilla = str_replace('\r','\\r',$plantilla);
$plantilla = str_replace('\t','\\t',$plantilla);

// Data in php to rtf
$nombre = $_POST["nombre"];
$curso = $_POST["curso"];
$fechahoy = date("d-m-Y", time());

//Here I Replace who  shows me for special characters, 
//but it doesn't works, now show me characters like " or +- ...
$plantilla = str_replace("\'d3",'Ó',$plantilla);
$plantilla = str_replace("\'f1",'ñ',$plantilla);
$plantilla = str_replace("\'f3",'ó',$plantilla);
$plantilla = str_replace("\'ed",'í',$plantilla);
$plantilla=utf8_encode($plantilla);

// Procces rtf
eval( '$rtf = <<<EOF_RTF
' . $plantilla . '
EOF_RTF;
' );

//Here i do a var_dump($rtf); and show me special characters. 

// Save rtf
file_put_contents("$nombre-$fechahoy.rtf",$rtf);

echo "<a href=\"$nombre-$fechahoy.rtf\">download</a>";

?>

    </body>
</html> 
```

我做了一个手动“调试”，我的问题就在这行，因为我正在做 var_dump($rtf); 把它给我看吧……希望你能帮助我，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-10T18:53:07.087

首先，`decode`，然后`replace`。

```
$plantilla = utf8_decode($plantilla);
$plantilla = str_replace("\'e1",'á',$plantilla);
$plantilla = str_replace("\'c1",'Á',$plantilla);
$plantilla = str_replace("\'e9",'é',$plantilla);
$plantilla = str_replace("\'c9",'É',$plantilla); 
etc...
// Save rtf, here decode again
$rtf = utf8_decode($rtf);

file_put_contents("$nombre-$fechahoy.rtf",$rtf); 
```

# binding - 剑道复选框检查绑定。无法绑定到复选框数组

> ID：16164687
> 
> 赞同：1
> 
> 时间：2013-04-23T08:37:52.660
> 
> 标签：binding, checkbox, kendo-ui

我有一个复选框数组，我想将它用作一个数组，例如在一组选项中设置单个 iitems 并检索该组的值。对于单个复选框，我可以设置它并获取点击事件，作为一个数组我什么也得不到。

**HTML 代码：**

```
 <div class="k-group" id="chkbox-options">
    <label>
        Red
        <input type="checkbox" id="chk1" value="Red" data-bind="checked: colors" />
        Green
        <input type="checkbox" id="chk2" value="Green" data-bind="checked: colors" />
        Blue
        <input type="checkbox" id="chk3" value="Blue"  data-bind="checked: colors" />
    </label>
    </div> 
```

**Javascript代码：**

```
 <script  type="text/javascript">
        var colordata = null;
        $(document).ready(function () {
            colordata = kendo.observable({
                colors: ["Blue"]
            });
            kendo.bind($("chkbox-options"), colordata);
            $("#dump-values").click(function () {
                kendoConsole.log(colordata.colors.toString());
            });
            $("#chk1").click(function () {
                kendoConsole.log("click chk1");
                if (this.checked) {
                    kendoConsole.log("click chk1 true");
                }
            });
         });
    </script> 
```

我可以在单个复选框上获取单击事件，而我无法`kendo.observable`在字段 var colordata 中设置复选框的值。

我在剑道文档中看到了一个类似的例子，但我无法让它工作。

谢谢你的帮助

马可

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:26:09.397

几点： 1\. 在 kendo.bind 中缺少 div id chkbox-options 2\. 您需要在可观察对象的更改事件中读取更改的颜色。更改发生在单击事件之后，因此在单击事件中您总是会看到旧数据。

我已经纠正了你的 jsFiddle：http: [//jsfiddle.net/whizkid747/rPjjJ/4/](http://jsfiddle.net/whizkid747/rPjjJ/4/)

```
var colordata = null;
        $(document).ready(function () {
            colordata = kendo.observable({
                colors: ["Blue"]
            });
            kendo.bind($("#chkbox-options"), colordata);

            colordata.bind("change", function(e) {
                var selectedColors = '';

                $.each(colordata.colors, function(key, value){
                    selectedColors = selectedColors + " " + value;
                });
                if(colordata.colors.length == 0){
                    console.log('no colors selected');
                }else{
                console.log('selected colors:' + selectedColors);  
                }
            });            
         }); 
```

# javascript - Displaying details for master record using Javascript or jQuery in MVC4

> ID：16164688
> 
> 赞同：0
> 
> 时间：2013-04-23T08:37:59.140
> 
> 标签：javascript, jquery, asp.net-mvc-4, partial-views

I am trying to build a page with list of users. The goal is, that when you click "Details" link in the row, I would like to render partial view in the page using javascript or jQuery, So I dont need to reload the page. I have found many solutions (for example [this](https://stackoverflow.com/questions/1570127/render-partial-view-using-jquery-in-asp-net-mvc)), but I cant get it working, since I know next to nothing about javascript at the moment so I dont know how to connect what i found to code I have.

This is my partial view (i am not sure if it is correct as I wasnt able to even try to render it so far):

```
@model AdminDMS.Models.User

<h2>Details</h2>

<fieldset>
    <legend>User</legend>

    <div class="display-label">
         @Html.DisplayNameFor(model => model.Guid)
    </div>
    <div class="display-field">
        @Html.DisplayFor(model => model.Guid)
    </div>

    <div class="display-label">
         @Html.DisplayNameFor(model => model.TrusteeType)
    </div>
    <div class="display-field">
        @Html.DisplayFor(model => model.TrusteeType)
    </div>

    <div class="display-label">
         @Html.DisplayNameFor(model => model.Username)
    </div>
    <div class="display-field">
        @Html.DisplayFor(model => model.Username)
    </div>

    <div class="display-label">
         @Html.DisplayNameFor(model => model.Email)
    </div>
    <div class="display-field">
        @Html.DisplayFor(model => model.Email)
    </div>

    <div class="display-label">
         @Html.DisplayNameFor(model => model.LastLogin)
    </div>
    <div class="display-field">
        @Html.DisplayFor(model => model.LastLogin)
    </div>

    <div class="display-label">
         @Html.DisplayNameFor(model => model.PasswordChanged)
    </div>
    <div class="display-field">
        @Html.DisplayFor(model => model.PasswordChanged)
    </div>

    <div class="display-label">
         @Html.DisplayNameFor(model => model.IsUsingTempPassword)
    </div>
    <div class="display-field">
        @Html.DisplayFor(model => model.IsUsingTempPassword)
    </div>
</fieldset>` 
```

I am using async controller, these are my Details async actions:

```
 public void DetailsAsync(Guid guid)
    {
        if (userList == null || DateTime.Now > lastUpdate.AddMinutes(5))
        {
            AsyncManager.OutstandingOperations.Increment();
            client.GetUsersAsync();
            lastUpdate = DateTime.Now;
            AsyncManager.Parameters["guid"] = guid;
        }
    }

    public ActionResult DetailsCompleted(IEnumerable<AdminDMS.Models.User> users)
    {
        if (userList == null || !userList.Equals(users))
            userList = users.ToList<AdminDMS.Models.User>();
        return PartialView("Details", users.Single(user => user.Guid == (Guid)AsyncManager.Parameters["guid"]));
    } 
```

And this is the view:

```
@model List<AdminDMS.Models.User>

@{
    ViewBag.Title = "Users";
}

<h2>Users</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
<table>
    <tr>
        <th>
            Guid
        </th>
        <th>
            Username
        </th>
        <th>
            Email
        </th>
        <th>
            TrusteeType
        </th>
        <th>
            Last Login
        </th>
        <th>
            Last Password Change
        </th>
        <th>
            Temporary Password
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Guid)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Username)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Email)
        </td>
         <td>
            @Html.DisplayFor(modelItem => item.TrusteeType)
        </td>
         <td>
            @Html.DisplayFor(modelItem => item.LastLogin)
        </td>
         <td>
            @Html.DisplayFor(modelItem => item.PasswordChanged)
        </td>
         <td>
            @Html.DisplayFor(modelItem => item.IsUsingTempPassword)
        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new { item.Guid }) |
            @*@Html.ActionLink("Details", "Details", new { item.Guid })*@ |
            @Html.ActionLink("Delete", "Delete", new { item.Guid })
        </td>
    </tr>
}

</table>

<div class="detailsDiv">

</div> 
```

I would like to replace that commented out action link with something, that will render the partial view in "detailsDiv" div that is left empty at the end.

Thanks in advance

UPDATE:

My controller now has this action

```
public PartialViewResult Details(Guid guid)
        {
            AdminDMS.Models.User user = null;
            UserService.User serviceUser = client.GetUsers().Single(u => u.Guid == guid);
            user = new AdminDMS.Models.User(serviceUser.Guid, serviceUser.TrusteeType, serviceUser.Username, serviceUser.Email, serviceUser.LastLogin, serviceUser.PasswordChanged, serviceUser.IsUsingTempPassword);
            return PartialView("_detailsPartial", user);
        } 
```

_detailsPartial is the detail view (that hasnt changed at all)

this is the current call to controller in view:

```
@Ajax.ActionLink("Details", "Details", item, new AjaxOptions { UpdateTargetId = "detailsDiv", InsertionMode = InsertionMode.Replace}) 
```

This is the div I want to update:

```
<div id="detailsDiv">

</div> 
```

There is nothing else in the view after this div.

Current result is that the link will open new page in the window and renders partial view (with item details as content)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T10:40:28.370

我总是用它来用 ajax 渲染局部视图，这很有效，如果你有任何其他问题，那就是别的 :)

```
@Ajax.ActionLink("blabla", "DetailsCompleted", new { Users= "add users here" }, new AjaxOptions { UpdateTargetId = "detailsDiv"}) 
```

编辑：控制器动作

```
public PartialViewResult yourpartialname("data here")
{
    "get your data
    return PartialView(data);
} 
```

编辑2：

你可以这样做：

```
@Ajax.ActionLink("Details", "Details", new {item = item.Guid}, new AjaxOptions {      UpdateTargetId = "detailsDiv", InsertionMode = InsertionMode.Replace}) 
```

我知道这会起作用，但我不知道这是否有很大的不同（我也不是专业人士:)），我不知道这是否有很大的不同，但你可以将你的部分视图结果更改为此：

```
public PartialViewResult DetailsPartial(Guid item)
    {
        AdminDMS.Models.User user = null;
        UserService.User serviceUser = client.GetUsers().Single(u => u.Guid == guid);
        user = new AdminDMS.Models.User(serviceUser.Guid, serviceUser.TrusteeType, serviceUser.Username, serviceUser.Email, serviceUser.LastLogin, serviceUser.PasswordChanged, serviceUser.IsUsingTempPassword);
        return PartialView(user);
    } 
```

其中 DetailsPartial 是您的局部视图的名称您可以试试这个，我会这样做，否则我看不出您的代码有任何问题

最后编辑

```
</footer>
@Scripts.Render("~/bundles/jquery")
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.js")" type="text/javascript"></script>
@RenderSection("scripts", required: false)
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:45:24.010

我想最适合用于呈现页面的一部分的是 AJAX。 [http://en.wikipedia.org/wiki/Ajax_(programming)](http://en.wikipedia.org/wiki/Ajax_(programming)) 老实说，我不是 Asp.net 的专家，但我想有一个工具包可以解决问题。[http://www.asp.net/ajaxlibrary/AjaxControlToolkitSampleSite/](http://www.asp.net/ajaxlibrary/AjaxControlToolkitSampleSite/)

# xcode - CorePlot 1.2 - pod install 没有响应

> ID：16164693
> 
> 赞同：2
> 
> 时间：2013-04-23T08:38:37.513
> 
> 标签：xcode, core-plot, cocoapods

我刚刚添加

```
pod 'CorePlot',         '~> 1.2' 
```

到我的 Podfile，现在正在尝试

```
$ pod install 
```

> 解决 `./Podfile' 的依赖关系
> 更新规范存储库
> 
> Cocoapods 0.18.1 可用。
> 
> 解决目标“默认”的依赖项（iOS 6.0）
> 下载依赖
> 项安装 CorePlot（1.2）

它被挂在那里没有任何反应。

我能做些什么 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T13:47:37.973

这个源库将近 200 兆字节。这可能取决于您的互联网连接，但我想如果您给它足够的时间，这将完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-03T05:41:55.887

如果你想看看它在做什么尝试

```
$ pod install --verbose 
```

# ruby-on-rails - 完全卸载 Rails

> ID：16164697
> 
> 赞同：41
> 
> 时间：2013-04-23T08:38:47.500
> 
> 标签：ruby-on-rails

我正在尝试**完全**卸载 Rails ，但我无法掌握它。

这是我尝试过的：

```
$ gem update
rails 4.0.0.beta1 installed

$ rails -v
Rails 4.0.0.beta1

$ gem uninstall rails -v 4.0.0.beta1 
```

但仍然：

```
$ rails -v
Rails 4.0.0.beta1 
```

我怎样才能完全删除 rails 版本？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-10-15T17:28:46.003

# 最终解决方案

只需卸载**railties -v 4.0.0**，一切都很好。

```
$ which rails
~/software/bin/rails
$ rails -v
Rails 4.0.0
$ gem list | grep rails
rails (4.0.0, 3.2.13, 3.2.9, 3.2.6)
$ gem uninstall rails -v 4.0.0

You have requested to uninstall the gem:
        rails-4.0.0
figaro-0.7.0 depends on [rails (< 5, >= 3)]
.....
.....
Continue with Uninstall? [Yn]  y
Successfully uninstalled rails-4.0.0
$ gem list | grep rails
rails (3.2.13, 3.2.9, 3.2.6)
$ rails  -v
Rails 4.0.0
$ gem uninstall railties -v 4.0.0

You have requested to uninstall the gem:
        railties-4.0.0
coffee-rails-4.0.0 depends on [railties (< 5.0, >= 4.0.0.beta)]
....
....
If you remove this gems, one or more dependencies will not be met.
Continue with Uninstall? [Yn]  y
Successfully uninstalled railties-4.0.0
$ rails -v
Rails 3.2.13 
```

看！rails版本恢复正常！！

## 原因在这里：

```
$ tail `which rails`
  str = ARGV.first
  str = str.dup.force_encoding("BINARY") if str.respond_to? :force_encoding
  if str =~ /\A_(.*)_\z/
    version = $1
    ARGV.shift
  end
end

gem 'railties', version
load Gem.bin_path('railties', 'rails', version) 
```

* * *

# 早点尝试

好吧，我做了我在互联网上找到的一切，但没有任何效果。我只是删除了gem文件夹，安装了rails 3.2.12，它就可以工作了......安装了
所有**31个gem**

```
# rm -rf /usr/local/lib/ruby/gems/
# gem list

*** LOCAL GEMS ***
# gem cleanup
Cleaning up installed gems...
Clean Up Complete
# gem update --system
# gem install rails -v 3.2.12
Fetching: i18n-0.6.5.gem (100%)
Successfully installed i18n-0.6.5
Fetching: multi_json-1.8.2.gem (100%)
Successfully installed multi_json-1.8.2
Fetching: activesupport-3.2.12.gem (100%)
Successfully installed activesupport-3.2.12
Fetching: builder-3.0.4.gem (100%)
Successfully installed builder-3.0.4
Fetching: activemodel-3.2.12.gem (100%)
Successfully installed activemodel-3.2.12
Fetching: rack-1.4.5.gem (100%)
Successfully installed rack-1.4.5
Fetching: rack-cache-1.2.gem (100%)
Successfully installed rack-cache-1.2
Fetching: rack-test-0.6.2.gem (100%)
Successfully installed rack-test-0.6.2
Fetching: journey-1.0.4.gem (100%)
Successfully installed journey-1.0.4
Fetching: hike-1.2.3.gem (100%)
Successfully installed hike-1.2.3
Fetching: tilt-1.4.1.gem (100%)
Successfully installed tilt-1.4.1
Fetching: sprockets-2.2.2.gem (100%)
Successfully installed sprockets-2.2.2
Fetching: erubis-2.7.0.gem (100%)
Successfully installed erubis-2.7.0
Fetching: actionpack-3.2.12.gem (100%)
Successfully installed actionpack-3.2.12
Fetching: arel-3.0.2.gem (100%)
Successfully installed arel-3.0.2
Fetching: tzinfo-0.3.38.gem (100%)
Successfully installed tzinfo-0.3.38
Fetching: activerecord-3.2.12.gem (100%)
Successfully installed activerecord-3.2.12
Fetching: activeresource-3.2.12.gem (100%)
Successfully installed activeresource-3.2.12
Fetching: mime-types-1.25.gem (100%)
Successfully installed mime-types-1.25
Fetching: polyglot-0.3.3.gem (100%)
Successfully installed polyglot-0.3.3
Fetching: treetop-1.4.15.gem (100%)
Successfully installed treetop-1.4.15
Fetching: mail-2.4.4.gem (100%)
Successfully installed mail-2.4.4
Fetching: actionmailer-3.2.12.gem (100%)
Successfully installed actionmailer-3.2.12
Fetching: rake-10.1.0.gem (100%)
Successfully installed rake-10.1.0
Fetching: rack-ssl-1.3.3.gem (100%)
Successfully installed rack-ssl-1.3.3
Fetching: thor-0.18.1.gem (100%)
Successfully installed thor-0.18.1
Fetching: json-1.8.0.gem (100%)
Building native extensions.  This could take a while...
Successfully installed json-1.8.0
Fetching: rdoc-3.12.2.gem (100%)
Depending on your version of ruby, you may need to install ruby rdoc/ri data:

<= 1.8.6 : unsupported
 = 1.8.7 : gem install rdoc-data; rdoc-data --install
 = 1.9.1 : gem install rdoc-data; rdoc-data --install
>= 1.9.2 : nothing to do! Yay!
Successfully installed rdoc-3.12.2
Fetching: railties-3.2.12.gem (100%)
Successfully installed railties-3.2.12
Fetching: bundler-1.3.5.gem (100%)
Successfully installed bundler-1.3.5
Fetching: rails-3.2.12.gem (100%)
Successfully installed rails-3.2.12
... rdoc stuff  ...
31 gems installed 
```

# 这里有一些奇怪的东西

我已经安装了 rails 3.2.13 ( )，只`$ sudo gem uninstall rails -v 4.0.0`安装了**15 个 gem**：`$ sudo gem cleanup``$ sudo gem install rails -v 3.2.13`

 **```
$ sudo gem install rails -v 3.2.13
Fetching: i18n-0.6.1.gem (100%)
Fetching: activesupport-3.2.13.gem (100%)
Fetching: builder-3.0.4.gem (100%)
Fetching: activemodel-3.2.13.gem (100%)
Fetching: rack-1.4.5.gem (100%)
Fetching: sprockets-2.2.2.gem (100%)
Fetching: actionpack-3.2.13.gem (100%)
Fetching: arel-3.0.2.gem (100%)
Fetching: tzinfo-0.3.38.gem (100%)
Fetching: activerecord-3.2.13.gem (100%)
Fetching: activeresource-3.2.13.gem (100%)
Fetching: actionmailer-3.2.13.gem (100%)
Fetching: rdoc-3.12.2.gem (100%)
Depending on your version of ruby, you may need to install ruby rdoc/ri data:

<= 1.8.6 : unsupported
 = 1.8.7 : gem install rdoc-data; rdoc-data --install
 = 1.9.1 : gem install rdoc-data; rdoc-data --install
>= 1.9.2 : nothing to do! Yay!
Fetching: railties-3.2.13.gem (100%)
Successfully installed i18n-0.6.1
Successfully installed activesupport-3.2.13
Successfully installed builder-3.0.4
Successfully installed activemodel-3.2.13
Successfully installed rack-1.4.5
Successfully installed sprockets-2.2.2
Successfully installed actionpack-3.2.13
Successfully installed arel-3.0.2
Successfully installed tzinfo-0.3.38
Successfully installed activerecord-3.2.13
Successfully installed activeresource-3.2.13
Successfully installed actionmailer-3.2.13
Successfully installed rdoc-3.12.2
Successfully installed railties-3.2.13
Successfully installed rails-3.2.13
15 gems installed
... rdoc stuff ... 
```

并且`rails -v`：

```
$ rails -v
/usr/local/lib/ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs': Could not find minitest (~> 4.2) amongst [actionmailer-4.0.0, actionmailer-3.2.13, actionpack-4.0.0, actionpack-3.2.13, activemodel-4.0.0, activemodel-3.2.13, activerecord-4.0.0, activerecord-3.2.13, activerecord-deprecated_finders-1.0.3, activeresource-4.0.0, activeresource-3.2.13, activesupport-4.0.0, activesupport-3.2.13, addressable-2.3.3, arel-4.0.0, arel-3.0.2, atomic-1.1.14, bcrypt-ruby-3.0.1, better_errors-0.8.0, bigdecimal-1.2.1, binding_of_caller-0.7.1, bootstrap-sass-2.3.1.0, builder-3.2.2, builder-3.0.4, bundler-1.3.5, cancan-1.6.9, capybara-2.0.3, childprocess-0.3.9, coderay-1.0.9, coffee-rails-4.0.0, coffee-script-2.2.0, coffee-script-source-1.6.3, countries-0.9.2, cucumber-1.2.3, cucumber-rails-1.3.1, currencies-0.4.0, database_cleaner-1.0.0.RC1, debug_inspector-0.0.2, devise-2.2.3, diff-lcs-1.2.2, email_spec-1.4.0, erubis-2.7.0, execjs-2.0.2, factory_girl-4.2.0, factory_girl_rails-4.2.1, ffi-1.6.0, figaro-0.6.3, gherkin-2.11.6, hike-1.2.3, httpclient-2.3.3, httpi-2.0.2, i18n-0.6.5, i18n-0.6.1, io-console-0.4.2, jbuilder-1.5.1, journey-1.0.4, jquery-rails-3.0.4, json-1.8.0, launchy-2.2.0, libv8-3.16.14.3, mail-2.5.4, mime-types-1.25, minitest-5.0.8, multi_json-1.8.1, mysql2-0.3.13, nokogiri-1.5.9, orm_adapter-0.4.0, polyglot-0.3.3, quiet_assets-1.0.2, rack-1.5.2, rack-1.4.5, rack-cache-1.2, rack-ssl-1.3.3, rack-test-0.6.2, rails-3.2.13, rails-observers-0.1.2, railties-4.0.0, railties-3.2.13, rake-10.1.0, rdoc-4.0.1, rdoc-3.12.2, recurly-2.1.8, ref-1.0.5, rolify-3.2.0, rspec-core-2.13.1, rspec-expectations-2.13.0, rspec-mocks-2.13.0, rspec-rails-2.13.0, rubyzip-0.9.9, sass-3.2.12, sass-rails-4.0.0, sdoc-0.3.20, selenium-webdriver-2.31.0, simple_form-2.1.0, sprockets-2.10.0, sprockets-2.2.2, sprockets-rails-2.0.0, therubyracer-0.12.0, thor-0.18.1, thread_safe-0.1.3, tilt-1.4.1, treetop-1.4.15, turbolinks-1.3.0, tzinfo-1.1.0, tzinfo-0.3.38, uglifier-2.2.1, warden-1.2.1, websocket-1.0.7, xpath-1.0.0] (Gem::LoadError)
    from /usr/local/lib/ruby/1.9.1/rubygems/specification.rb:777:in `block in activate_dependencies'
    from /usr/local/lib/ruby/1.9.1/rubygems/specification.rb:766:in `each'
    from /usr/local/lib/ruby/1.9.1/rubygems/specification.rb:766:in `activate_dependencies'
    from /usr/local/lib/ruby/1.9.1/rubygems/specification.rb:750:in `activate'
    from /usr/local/lib/ruby/1.9.1/rubygems/specification.rb:780:in `block in activate_dependencies'
    from /usr/local/lib/ruby/1.9.1/rubygems/specification.rb:766:in `each'
    from /usr/local/lib/ruby/1.9.1/rubygems/specification.rb:766:in `activate_dependencies'
    from /usr/local/lib/ruby/1.9.1/rubygems/specification.rb:750:in `activate'
    from /usr/local/lib/ruby/1.9.1/rubygems.rb:1232:in `gem'
    from /usr/local/bin/rails:22:in `<main>' 
```

Rails 4.0.0 无法通过完全卸载删除，这是一个错误吗？

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2016-07-27T08:37:03.710

从系统中完全移除导轨的 2 个步骤

1) `gem uninstall rails`
2)`gem uninstall railties`

选择要卸载的版本。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-06-05T14:28:13.167

万一其他人来了，我发现我也必须卸载`railties`。

```
gem uninstall railties 
```

`/~user`从您的下方检查您可能安装过 rails 的所有目录

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-23T09:34:13.633

如果您使用的是 rvm，则可以通过删除 $HOME 中的 .gem 目录来卸载所有 gem

> rm -rf ~/.gem

或仅卸载 rails：

> gem 卸载 -a 导轨

或者如果您使用 sudo 安装：

> sudo gem 卸载 -a rails

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-23T08:53:16.873

您尚未指定要卸载哪个 gem，请尝试`gem uninstall rails`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-23T09:17:57.540

```
sudo gem uninstall rails -v 4.0.0.beta1 
```

它应该有帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-06-24T05:37:12.797

我还必须卸载 Railties，一切正常。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-23T11:55:48.683

首先你应该了解**rails**的位置是什么。输入您的控制台（bash、zsh 等）

```
which rails 
```

如果它位于您的主文件夹中，例如：

```
/home/your_name/.rvm/gems/ruby-1.9.3-p392/bin/rails 
```

然后，您应该使用本地 gem 将其删除：

```
gem uninstall rails 
```

否则，您可能必须使用*sudo*：

```
sudo gem uninstall rails 
```

**注意**：您可以按以下方式检查您的 Rails 版本：

当地的：

```
gem list rails 
```

全球的：

```
sudo gem list rails 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-08-02T08:18:32.750

您只需尝试此命令。它将有助于卸载所有导轨“gem uninstall railties”我认为这是完全卸载所有导轨的唯一方法**

# javascript - 简单地从数组中删除空值 - javascript

> ID：16164699
> 
> 赞同：0
> 
> 时间：2013-04-23T08:39:00.517
> 
> 标签：javascript

我查看了以前的 Q/A 并没有找到太多帮助。主要是因为我不明白编码的内容。

我只是想删除数组中的任何空值。

我的简单方法 - 那行不通！

我的代码是 -

```
var colors = [a, b, c, d, e, f];
var newArray = [];
for (var i = 0; i < colors.length; i++) {
  if (colors[i] !== 'undefined' || colors[i] !== null || colors[i] !== "") {
    newArray.push(colors[i]);
  }
}
console.log(newArray.length); // == 6 
console.log(newArray) //== yellow,blue,red,,, 
```

我会认为我的 if 语句将过滤所有具有值的元素并推送到我的新数组。我真的需要 newArray 长度等于 3 并且只保留 vales，`""`newArray 中不应该有空字符串。

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T08:45:46.933

使用 && 代替 ||：

```
var colors = ["yellow", "","red", "blue", "", ""];
var newArray = [];
for (var i = 0; i < colors.length; i++) {
  if (colors[i] !== undefined && colors[i] !== null && colors[i] !== "") {
    newArray.push(colors[i]);
  }
 }
console.log(newArray.length); // == 3 
console.log(newArray) //== yellow,blue,red,,, 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T08:54:57.463

使用 && 代替 ||：

```
var colors = ["yellow", "","red", "blue", "", ""];
var newArray = [];
for (var i = 0; i < colors.length; i++) {
  if (colors[i] !== undefined && colors[i] !== null && colors[i] !== "") {
    newArray.push(colors[i]);
  }
 }
console.log(newArray.length); // == 3 
console.log(newArray) //== yellow,blue,red,,, 
```

对于您的用例，您还可以使用

```
for (var i = 0; i < colors.length; i++) {
  if (colors[i]) {
    newArray.push(colors[i]);
  }
 } 
```

这将过滤掉任何虚假值。虚假值包括

```
false
0
""
null
undefined
NaN 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T09:02:18.977

您可以简单地使用 colors[i] 进行存在检查，

```
var colors = ["yellow", "","red", "blue", "", "", true, 1];
var newArray = [];
for (var i = 0; i < colors.length; i++) {
    if (typeof colors[i] == 'string' && colors[i]) {
        newArray.push(colors[i]);
    }
}
console.log(newArray) //["yellow", "red", "blue"] 
```

相关资源[javascript类型转换](http://jibbering.com/faq/notes/type-conversion/)

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T09:31:44.920

如果“假”值很重要，那么：

```
var colors = [0,1,'a',,'',null,undefined,false,true];
    colors = colors.filter(function(e){
        return (e===undefined||e===null||e==='')?false:~e;
    }); 
```

别的：

```
var colors = [0,1,'a',,'',null,undefined,false,true];
        colors = colors.filter(function(e){return e;}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-01T15:00:25.087

```
var colors = ["yellow", null, "blue", "red", undefined, 0, ""];

// es5:
var newArray = colors.filter(function(e){return !!e;});

// es6:
var newArray = colors.filter((e)=>!!e);

console.log(newArray.length); // ==> 3
console.log(newArray) // ==> ["yellow","blue","red"] 
```

# php - 将我的动态表css php的内容居中

> ID：16164700
> 
> 赞同：0
> 
> 时间：2013-04-23T08:39:08.190
> 
> 标签：php, css, styles, echo, center

我正在尝试将动态表的内容居中。我正在使用从 jquery 库中选择的元素。我希望表格中的所有文本都位于中心。我已经尝试了所有常用的方法，但我不能将文本放在中心。我的代码是：

```
<tbody id="tbody_chosen">
<?php foreach($table as $row){
$num = $row->total_quantity - $row->available_quantity;
echo "<tr>
        <td>{$row->id}</td>
        <td>{$row->name}</td>
        <td>{$row->total_quantity}</td>
        <td>{$num}</td>
        <td>{$row->available_quantity}</td>
        <td>{$row->inOrder}</td>";
if(have_access("manager"))
    //TODO here we have to use the product's supplier ID
    echo "<td>
            <input type=\"checkbox\" name=\"selector[]\" value=\"{$row->id}\" id=\"selector-{$row->id}\"/>
            <input type=\"hidden\" name=\"selector_id[]\" id=\"selector_id-{$row->id}\" value=\"{$row->supplied_by}\" />
        </td>";
echo "</tr>";
} ?>
</tbody> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:40:29.020

把这个放在你的 tr

```
<tr style='text-align:center;'> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:47:03.087

td,th {对齐：居中；} 在你的 CSS

# java - Play Framework 2 设置表单输入类

> ID：16164703
> 
> 赞同：2
> 
> 时间：2013-04-23T08:39:15.383
> 
> 标签：java, scala, playframework-2.0

我已经阅读了[http://www.playframework.com/documentation/2.0/ScalaFormHelpers](http://www.playframework.com/documentation/2.0/ScalaFormHelpers)上的文档并搜索了解决方案，但我无法弄清楚。

我无法想象您必须创建自定义字段构造函数来设置类。

**如何使用默认字段构造函数设置字段类？**

感谢帮助！

编辑：如果有一种方法可以将其他（自定义属性，如 data-*）attr-s 设置为带有默认构造函数的元素，那就太好了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-23T08:42:11.593

它就在您链接到的文档中。

我将其更改`id`为`class`.

```
@helper.form(action = routes.Application.submit, 'class -> "my-class") {

} 
```

或者

```
@helper.inputText(myForm("username"), 'class -> "my-class", 'size -> 30) 
```

* * *

使用带连字符的符号不能开箱即用。

最简单的解决方案是创建一个像这样的符号：

```
@helper.inputText(myForm("username"), Symbol("data-m-dec") -> "4", 'size -> 30) 
```

# php - HTML下拉菜单添加自己的价值

> ID：16164704
> 
> 赞同：1
> 
> 时间：2013-04-23T08:39:17.100
> 
> 标签：php, html, forms, drop-down-menu

是否有可能有一个下拉菜单，您可以通过直接在下拉字段中输入来添加自己的值？想法是让数据库中的所有行都在此下拉菜单中列出，并有可能添加新行。用于保存所有数据的 php 文件已准备就绪。现在我的下拉菜单代码如下所示：

```
<select id="name" name="name" onChange="enableOther();" onFocus="enableOther()">
    <option> </option>
    <option>Neu</option>
    <?php
    while($row = mysql_fetch_object($ergebnis))     
{
    echo('<option>'.$row->Material.'</option>');
}
    ?>
</select> 
```

我希望有任何解决我的问题...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:53:41.220

HTML 本身不支持这一点，但是有许多 JavaScript UI 工具包提供了可编辑的组合框小部件，或者您可以尝试自己在 JS 中编写一个（本质上，使用带有自定义编码下拉列表的文本输入） .

或者，一个简单的方法是这样的：

```
<select name="name" ...>
    <option value=''>Custom (use text field)</option>
    ... etc ...
</select>
<input type='text' name='customName'> 
```

那么在服务器端，如果name的提交值为空字符串，而customName的提交值不是，则使用customName。当用户根据需要更改选择框时，您还可以添加 JavaScript 以启用/禁用 customName 字段。

**编辑：HTML5**

顺便说一句，这在 HTML5 中是可能的，但当然不是所有浏览器都支持：

```
<input list="suggestedNames" name="name">
<datalist id="suggestedNames">
  <option value="...">
  ...
</datalist> 
```

# apache - Apache三级域名配置

> ID：16164705
> 
> 赞同：1
> 
> 时间：2013-04-23T08:39:19.397
> 
> 标签：apache, symfony, rewrite

我有特定的重写，比如

```
RewriteEngine On 
RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} !-f
RewriteRule .* /app_dev.php 
```

我需要像 hello.epsilon.localhost 和 example.epsilon.localhost 这样的域名将转到 epsilon.localhost 虚拟主机（抱歉我的英语不好）

epsilon.localhost 的完整虚拟主机

```
<VirtualHost *:80>
    DocumentRoot "C:/Projects/epsilon/web"

    RewriteEngine On 
    RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} !-f
    RewriteRule .* /app_dev.php

<Directory "C:/Projects/epsilon/web">
    Options FollowSymLinks
    AllowOverride None
    Order allow,deny
    Allow from all
</Directory>

    ServerName epsilon.localhost
</VirtualHost> 
```

为 symfony 2.1 重写

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-23T14:09:34.167

我在 Windows 上使用这个[http://sourceforge.net/projects/acrylic/](http://sourceforge.net/projects/acrylic/)作为本地 DNS 服务器，这在虚拟主机配置中

```
<VirtualHost 127.0.0.1>
ServerName devsite.localhost
ServerAlias *.devsite.localhost

DocumentRoot "C:/httpdocs/devsite"
</VirtualHost> 
```

# ios - iOS 配置文件

> ID：16164706
> 
> 赞同：2
> 
> 时间：2013-04-23T08:39:33.553
> 
> 标签：ios, ipad, provisioning-profile, ios-provisioning

一年多前，我为一位客户开发了一个 iOS 应用程序，最近客户联系我说该应用程序不再加载。

配置文件已过期，他们已进入设置并删除了配置文件。该应用程序现在不再加载。

我已更新我的 iOS 开发人员资料，但我不知道如何将配置资料恢复到应用程序以使其正常工作。

更复杂的是，我不再拥有所有源代码，因此不能只重建应用程序。非常感谢任何帮助。

# css - LESS.js 编译 css 但不应用它？

> ID：16164715
> 
> 赞同：1
> 
> 时间：2013-04-23T08:40:06.400
> 
> 标签：css, compilation, less

我在标题中包含了 style.less 文件和 less.js 文件，如下所示：

```
<link rel="stylesheet/less" type="text/less" href="<?php bloginfo('template_directory'); ?>/css/style.less" media="screen">
<script src="<?php bloginfo('template_directory'); ?>/js/libs/less-1.3.3.min.js" type="text/javascript"></script> 
```

我检查了源代码，两个文件都加载得很好。在 style.less 文件中，我有几个导入的文件。当页面加载并检查控制台时，我可以看到所有导入的文件都已获取。但由于某种原因，页面没有应用样式：

[![在此处输入图像描述](https://i.stack.imgur.com/ReIWM.png)](https://i.stack.imgur.com/ReIWM.png)

我已经在本地编译了文件，没有任何问题，所以我知道代码没有问题。

还有什么我需要做的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T11:37:47.677

将类型更改为`text/css`，它应该可以工作。

# java - 拼写检查后从 SOLR 查询中提取国家、州、城市或州名

> ID：16164717
> 
> 赞同：0
> 
> 时间：2013-04-23T08:40:10.613
> 
> 标签：java, solr

我有一个企业目录列表。

如果用户搜索**“plumbing business in new york”**，则查询应返回 Solr 索引中的所有管道业务，并且**还应**运行一个子查询，该子查询将返回纽约的所有管道业务。

在 solr 中，我将使用 stopwords.txt 文件从查询中删除“in”。

用户可能会犯将“new york”拼写为“new yrok”的拼写错误。对于拼写错误，我可以使用 spellings.txt

在最后的查询中，我想获取州、国家、街道或国家的名称并运行两个查询。

1-“管道业务”，它将返回我们 SOLR 索引中的所有管道业务。2-“plumbing business new york”，删除“in”并进行拼写检查后，将返回纽约的所有水暖企业。

谁能告诉我这是如何在 SOLR 中实现的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:38:44.863

您需要做一些 NLP 并将用户的查询转换为 SOLR 查询。

例如，如果你有这个词`in`，你可能会假设它之前的所有东西都是某人正在寻找的东西，而它之后的所有东西都是他们需要找到它的地方。假设您的模式具有业务和位置字段，使用正确字段中提供的值构造 SOLR 查询很简单。

# c# - EF @@ROWCOUNT > 0 导致错误的 upsert

> ID：16164719
> 
> 赞同：1
> 
> 时间：2013-04-23T08:40:14.820
> 
> 标签：c#, asp.net, sql, database, entity-framework

我正在尝试更新数据库实体（MamConfiguration_V1）中的现有名称，称之为父

我想要

1）向它添加一个引用（导航）成员（MamConfigurationToBrowser_V1）将其称为Child

2) 我不会更改父实体中唯一属性的值。（父母名字）

我让实体从数据库中更新，

并使用相同的上下文（mMamDbEntities）

我添加了参考成员。

我不会更改它的 Name 属性。

但是我得到一个数据库错误，违反唯一性限制

```
{"Violation of UNIQUE KEY constraint 'UQ_MamConfigurations_V1'. Cannot insert duplicate key in object 'dbo.MamConfiguration_V1'. The duplicate key value is (elad_14Apr_1315).\r\nThe statement has been terminated."} 
```

我做了数据库嗅探并看到了生成的代码：

```
exec sp_executesql N'update [dbo].[MamConfiguration_V1]
set [Name] = @0, [Description] = @1, [StatusId] = @2, [Type] = @3, [UpdatedDate] = @4, [PercentageTraffic] = @5, [NumericTraffic] = @6
where ([ConfigurationId] = @7)
',N'@0 nvarchar(50),@1 nvarchar(200),@2 int,@3 int,@4 datetime2(7),@5 int,@6 int,@7 int',@0=N'elad_17Apr_1120_tmpToRemove_',@1=N'elad_22Apr_1120',@2=2,@3=0,@4='2013-04-23 11:17:25.4991650',@5=55,@6=-1,@7=32 
```

//更多命令

```
exec sp_executesql N'insert [dbo].[MamConfiguration_V1]([Name], [Description], [StatusId], [Type], [CreatedDate], [UpdatedDate], [PercentageTraffic], [NumericTraffic])
values (@0, @1, @2, @3, @4, @5, @6, @7)
select [ConfigurationId]
from [dbo].[MamConfiguration_V1]
where @@ROWCOUNT > 0 and [ConfigurationId] = scope_identity()',N'@0 nvarchar(50),@1 nvarchar(200),@2 int,@3 int,@4 datetime2(7),@5 datetime2(7),@6 int,@7 int',@0=N'elad_17Apr_1120_tmpToRemove_',@1=N'elad_22Apr_1120',@2=2,@3=0,@4='0001-01-01 00:00:00',@5='0001-01-01 00:00:00',@6=55,@7=-1 
```

我本来希望 upsert 是`@@ROWCOUNT = 0`

我究竟做错了什么？

我的代码和数据库是：

```
 public void SaveCofiguration(MamConfiguration_V1Ui itemUi)
        {
            var itemEf = mMamConfiguration_V1UiToEfConvertor.ConvertToNewEf(itemUi);

            using (var maMDBEntities = new MaMDBEntities())
            {
                IDal<MamConfiguration_V1> mamConfigurationDal = mDalFactory.GetDal<MamConfiguration_V1>(maMDBEntities);

                mamConfigurationDal.Save(itemEf);
            }
        }

         public MamConfiguration_V1 GetById(object id)
        {           
                id.ThrowIfNull("id");

                int configurationId = Convert.ToInt32(id);

                var result =
                    mMaMDBEntities.MamConfiguration_V1.SingleOrDefault(item => item.ConfigurationId == configurationId);

                return result;

        }

       public MamConfiguration_V1 Save(MamConfiguration_V1 item)
        {

                item.ThrowIfNull("item");

                var itemFromDB = GetById(item.ConfigurationId);

                if (itemFromDB != null)
                {
                    UpdateEfItem(itemFromDB, item);

                   // if (mMaMDBEntities.ObjectStateManager.GetObjectStateEntry(itemFromDB).State == EntityState.Detached)
//                    {
  //                      mMaMDBEntities.MamConfiguration_V1.AddObject(itemFromDB);
    //                }

                    // Attached object tracks modifications automatically
                    mMaMDBEntities.SaveChanges();

                    return item;
                }

       private void UpdateEfItem(MamConfiguration_V1 itemFromDb, MamConfiguration_V1 itemFromUi)
            {
                itemFromDb.UpdatedDate = DateTime.Now;

                itemFromDb.Description = itemFromUi.Description;

                itemFromDb.StatusId = itemFromUi.StatusId;

                itemFromDb.Name = itemFromUi.Name;

                itemFromDb.NumericTraffic = itemFromUi.NumericTraffic;

                itemFromDb.PercentageTraffic = itemFromUi.PercentageTraffic;

                itemFromDb.Type = itemFromUi.NumericTraffic;

                foreach (var item in itemFromDb.MamConfigurationToBrowser_V1.ToList())
                {
                    if (itemFromUi.MamConfigurationToBrowser_V1.All(b => b.BrowserVersionId != item.BrowserVersionId))
                    {
                        mMaMDBEntities.MamConfigurationToBrowser_V1.DeleteObject(item);
                    }
                }

                for (int i = 0; i < itemFromUi.MamConfigurationToBrowser_V1.Count; i++)
                {
                    var element = itemFromUi.MamConfigurationToBrowser_V1.ElementAt(i);
                    var item = itemFromDb.MamConfigurationToBrowser_V1.SingleOrDefault(b => b.BrowserVersionId == element.BrowserVersionId);
                    if (item != null)
                    {
                        // copy properties from element to item
                    }
                    else
                    {
                        element.Browser = mMaMDBEntities.Browsers.Single(browserItem =>
                            browserItem.BrowserID == element.BrowserID);

                        //element.MamConfiguration_V1 = itemFromDb;

                        //have also tried: element.MamConfiguration_V1 = null;

                        //element.MamConfiguration_V1Reference = null;

                        itemFromDb.MamConfigurationToBrowser_V1.Add(element);
                    }
                }
            } 
```

**更新：**

`mMaMDBEntities.SaveChanges();`抛出异常

这些是数据库表：

```
CREATE TABLE [dbo].[MamConfiguration_V1](
    [ConfigurationId] [int] IDENTITY(1,1) NOT NULL,
    [Name] [nvarchar](50) NOT NULL,
    [Description] [nvarchar](200) NOT NULL,
    [StatusId] [int] NOT NULL,
    [Type] [int] NOT NULL,
    [CreatedDate] [datetime2](7) NOT NULL,
    [UpdatedDate] [datetime2](7) NOT NULL,
    [PercentageTraffic] [int] NOT NULL,
    [NumericTraffic] [int] NOT NULL,
 CONSTRAINT [PK_MamConfigurations_V1] PRIMARY KEY CLUSTERED 
(
    [ConfigurationId] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [SECONDARY],
 CONSTRAINT [UQ_MamConfigurations_V1] UNIQUE NONCLUSTERED 
(
    [Name] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [SECONDARY]
) ON [SECONDARY]

GO

ALTER TABLE [dbo].[MamConfiguration_V1]  WITH CHECK ADD  CONSTRAINT [FK_MamConfiguration_V1_ConfigurationType_V1] FOREIGN KEY([StatusId])
REFERENCES [dbo].[MamConfigurationStatuses] ([StatusId])
GO

ALTER TABLE [dbo].[MamConfiguration_V1] CHECK CONSTRAINT [FK_MamConfiguration_V1_ConfigurationType_V1]
GO

ALTER TABLE [dbo].[MamConfiguration_V1] ADD  CONSTRAINT [DF_MamConfigurations_V1_CreatedDate]  DEFAULT (getdate()) FOR [CreatedDate]
GO

ALTER TABLE [dbo].[MamConfiguration_V1] ADD  CONSTRAINT [DF_MamConfigurations_V1_UpdatedDate]  DEFAULT (getdate()) FOR [UpdatedDate]
GO

CREATE TABLE [dbo].[MamConfigurationToBrowser_V1](
    [MamConfigurationId] [int] NOT NULL,
    [BrowserVersionId] [uniqueidentifier] NOT NULL,
    [IsWhiteListed] [bit] NOT NULL,
    [BrowserID] [int] NOT NULL,
    [VersionNumberLowRange] [varchar](50) NOT NULL,
    [CreatedDate] [datetime] NOT NULL,
    [UpdatedDate] [datetime] NOT NULL,
    [VersionNumberUpperRange] [varchar](50) NULL,
 CONSTRAINT [PK_MamConfigurationToBrowser_V1_1] PRIMARY KEY CLUSTERED 
(
    [BrowserVersionId] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [SECONDARY]
) ON [SECONDARY]

GO

SET ANSI_PADDING OFF
GO

ALTER TABLE [dbo].[MamConfigurationToBrowser_V1]  WITH CHECK ADD  CONSTRAINT [FK_MamConfigurationToBrowser_V1_Browsers] FOREIGN KEY([BrowserID])
REFERENCES [dbo].[Browsers] ([BrowserID])
GO

ALTER TABLE [dbo].[MamConfigurationToBrowser_V1] CHECK CONSTRAINT [FK_MamConfigurationToBrowser_V1_Browsers]
GO

ALTER TABLE [dbo].[MamConfigurationToBrowser_V1]  WITH CHECK ADD  CONSTRAINT [FK_MamConfigurationToBrowser_V1_BrowserVersion] FOREIGN KEY([MamConfigurationId])
REFERENCES [dbo].[MamConfiguration_V1] ([ConfigurationId])
GO

ALTER TABLE [dbo].[MamConfigurationToBrowser_V1] CHECK CONSTRAINT [FK_MamConfigurationToBrowser_V1_BrowserVersion]
GO

ALTER TABLE [dbo].[MamConfigurationToBrowser_V1] ADD  CONSTRAINT [DF_Browser_V1_CreatedDate]  DEFAULT (getdate()) FOR [CreatedDate]
GO

ALTER TABLE [dbo].[MamConfigurationToBrowser_V1] ADD  CONSTRAINT [DF_Browser_V1_UpdatedDate]  DEFAULT (getdate()) FOR [UpdatedDate]
GO 
```

**更新 2**

我已经尝试过@AzharKhorasany 解决方案，但出现了同样的错误：

```
for (int i = 0; i < itemFromUi.MamConfigurationToBrowser_V1.Count; i++)
            {
                var element = itemFromUi.MamConfigurationToBrowser_V1.ElementAt(i);
                var item = itemFromDb.MamConfigurationToBrowser_V1.SingleOrDefault(b => b.BrowserVersionId == element.BrowserVersionId);
                if (item != null)
                {
                    // copy properties from element to item
                }
                else
                {
                    element.Browser = mMaMDBEntities.Browsers.Single(browserItem =>
                        browserItem.BrowserID == element.BrowserID);

                    element.MamConfigurationId = itemFromDb.ConfigurationId;

                    //element.MamConfiguration_V1 = itemFromDb;

                    //have also tried: element.MamConfiguration_V1 = null;

                    //element.MamConfiguration_V1Reference = null;
                    //mMaMDBEntities.AddToMamConfigurationToBrowser_V1(itemFromUi.MamConfigurationToBrowser_V1.ElementAt(0)); // add as inserted

                    itemFromDb.MamConfigurationToBrowser_V1.Add(element);
                }
            } 
```

# objective-c - 如何将组件对齐到网格？

> ID：16164725
> 
> 赞同：0
> 
> 时间：2013-04-23T08:40:24.430
> 
> 标签：objective-c, grid, alignment

我正在开发一个应用程序，用户可以在其中将自己的控件放在视图上。现在我正在处理我希望控件与某种网格对齐的细节。

1.  如何绘制网格？
2.  如何确保控件自动与网格对齐（到最近的角落？）

提前致谢！

谁能帮忙？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T20:19:00.813

对于那些仍然对答案感兴趣的人：

我先画了横竖线：

-（无效）drawGrid {

```
for(int y=self.gridSize;y<self.templateEditView.frame.size.height;y+=self.gridSize){
    UIView *hline = [[UIView alloc] init];
    [hline setBackgroundColor:[[UIColor blackColor] colorWithAlphaComponent:0.1f]];
    hline.frame = CGRectMake(0, y, self.templateEditView.frame.size.width, 1);
    [self.templateEditView addSubview:hline];
}

for(int x=self.gridSize;x<self.templateEditView.frame.size.width;x+=self.gridSize){
    UIView *vline = [[UIView alloc] init];
    [vline setBackgroundColor:[[UIColor blackColor] colorWithAlphaComponent:0.1f]];
    vline.frame = CGRectMake(x, 0, 1, self.templateEditView.frame.size.height);
    [self.templateEditView addSubview:vline];
} 
```

}

当其中一个对象被拖放时，它们必须与网格对齐：

-(void)alignToGrid:(UIView *)control{

```
int gridSize = self.gridSize;

int oldX = (int)control.frame.origin.x;
int newX = (oldX /gridSize)*gridSize;
if(oldX%gridSize > gridSize/2){
    newX+=gridSize;
}

int oldY = (int)control.frame.origin.y;
int newY = (oldY /gridSize)*gridSize;
if(oldY%gridSize > gridSize/2){
    newY+=gridSize;
}

[UIView animateWithDuration:0.3f delay:0.0f options:UIViewAnimationOptionCurveLinear animations:^ {
    [control setFrame: CGRectMake(newX,newY,control.frame.size.width,control.frame.size.height)];
} completion:nil]; 
```

}

# sql - 如何检查过去十二个月内是否出现日期时间变量

> ID：16164728
> 
> 赞同：0
> 
> 时间：2013-04-23T08:40:29.850
> 
> 标签：sql, sql-server, sql-server-2008

我要做的是查看日期时间变量是否在过去十二个月的任何时间具有日期值。

我尝试使用 DATEDIFF 函数，但很快我发现这存在舍入问题（例如，12 月 31 日/1 月 1 日之间的比较将计为 1 个月，尽管事实上它们之间只过去了一天）

为了使这一点更准确，我可以使用 -365 天而不是 -12 个月作为参数，但这仍然会产生不考虑闰年的问题（这不是一种常见的情况，但我仍然希望避免这种情况！）

关于如何最好地解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:45:41.113

改用[DATEADD](http://msdn.microsoft.com/en-gb/library/ms186819.aspx)从今天减去一年并进行比较

```
@datetimevariable >= DATEADD(year, -1, GETDATE()) 
```

注意：除非您有未来的日期，否则您不需要比较上限 (GETDATE())。

另外，您是否想要精确到小时和分钟的一年？如果不是，请使用 this ，这对于[数据类型优先级](http://msdn.microsoft.com/en-us/library/ms190309.aspx)是安全的if `@datetimevariable`is `datetime`or `datetime2`，并且您需要 this is a WHERE 子句等

`@datetimevariable >= CAST(DATEADD(year, -1, GETDATE()) as date)`

这适用于闰年

```
SELECT DATEADD(YEAR, -1, '20120301'), DATEADD(YEAR, -1, '20120229')

2011-03-01 00:00:00.000
2011-02-28 00:00:00.000 
```

DATEDIFF 适用于特定边界：月初、年初、午夜等，这就是在这种情况下失败的原因

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:47:38.727

闰年的问题可以通过 DATEADD (datepart , number , date ) 函数来解决。您可以指定从当前日期起减去一年。

```
where myDate between DATEADD (year , -1 , GETDATE() ) and GETDATE() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:46:55.770

DATEDIFF 计算两个日期之间的分区数，很抱歉没有舍入问题，它完全按照它在锡上所说的那样做。您最好的解决方案可能是使用 DATEADD

```
WHERE MyVal BETWEEN GETDATE() AND DATEADD(YEAR, -1, GETDATE()) 
```

# python - I would like to extract the words from ":" to slash

> ID：16164731
> 
> 赞同：3
> 
> 时间：2013-04-23T08:40:33.477
> 
> 标签：python, regex, python-2.x

I have asked this question before and now i edit it because i found some lines that doesn't correspond to the format i gave before ...

* * *

here's an example of the lines:

```
data = "09:55:04.125 mta         Messages       I Doc O:SERVER (NVS:SMTP/me@domain.com) R:NVS:FAXG3.I0.0101 mid:6393"
data2= "09:55:05.045 mta         Messages       I Doc O:SERVER (NVS:SMTP/me@domain.com) R:ADMIN (NVS:SMTP.0/me@domain.fr) mid:6397" 
```

* * *

at first i have matched what's between the slash and two points but i've noticed that there's some lines like the first where the type "FAXG3.I0.0101" isn't followed by a slash

* * *

here's the regex i use:

```
exp = result = re.findall(r'[\w\.]+(?=:*)',data) # type S & D 
```

* * *

the result i want is 'SMTP','FAXG3.I0.0101' for the first line and 'SMTP','SMTP.0' for the second. can someone help correcting my regex to get that ??

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T08:44:17.930

您只需要更改正则表达式，使其也接受“。” 作为有效字符，例如：

```
import re 
data = "This is a test message I Res O:Myself (KTP:SMTP/me@domain.com) R:KTP:SMS.CLASS/+345854595 id:21"
result = re.findall(r'[\w\.]+(?=:*/)',data)
print result

['SMTP', 'SMS.CLASS'] 
```

`[\w\.]+`表示您将接受由至少一个“任何字母数字字符和下划线”（`\w`）或`.`（`\.`-它需要转义，`.`否则表示“任何字符”）组成的序列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:44:28.997

那应该工作：

```
result = re.findall(r'(?<=:)[\w.]+(?=/)',data) 
```

`:`说“和之间的一系列字母数字字符（或下划线或点）`/`”。

# php - PHP session variable not working across 2 pages

> ID：16164735
> 
> 赞同：2
> 
> 时间：2013-04-23T08:40:43.057
> 
> 标签：php, session, variables

Creating form and trying to carry variables accross two pages to a results page. I have tried $GET and $POST and it works fine from page1.php to results.php, but when I change to $SESSION the variable isn't passed or echo'd on results.php. Here's the php code for page1 which won't even work directly to results! Not sure if there is a problem with my code or possibly the server? Page 1.php:

```
<?php session_start();?>
<?php
$name = $_SESSION['name']; 
?>
<FORM action="results.php" method="post" enctype="multipart/form-data" id="questionnaire">
<input type="text" name="name" id="name" /> 
```

Results.php:

```
<?php session_start();?>

<html>           
    <body>                   
        <?php 
        $name = $_SESSION['name'];
        echo $name; ?>                               
    </body>           
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:46:24.810

请尝试执行以下代码片段

```
<?php session_start();?>
<?php
   if($_SERVER['REQUEST_METHOD']=='POST')
   {
    $name = $_POST['name'];
    $_SESSION['name']=$name;
  }
 ?>
  <FORM action="results.php" method="post" enctype="multipart/form-data" id="questionnaire">
  <input type="text" name="name" id="name" /> 
```

实际上在您的代码片段中 $_SESSION['name'] 的值没有设置。所以我已经定义了会话变量的值，并从 HTML 表单中发布了值

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T08:51:38.180

您忘记了表单中的结束标签，并且没有提交按钮

```
<FORM action="results.php" method="post" enctype="multipart/form-data" id="questionnaire">
<input type="text" name="name" id="name" />   
<input type="Submit" value="Submit">
</FORM> 
```

然后在 results.php

```
<?php session_start();?>

<html>           
    <body>                   
        <?php 

        $_SESSION['name']=$_POST['name'];
        echo  $_SESSION['name']; ?> 
        <br><br>
        <a href="page2.php">page 2</a>  

    </body>           
</html> 
```

然后我创建了这个 page2.php

```
<?php session_start();?>
<html>
    <body>
        Hi, I am still <?php echo $_SESSION['name'];?>
    </body>
</html> 
```

在我身边一切都很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:44:19.787

我认为你在这一行反转了你的变量：

```
<?php
 $name = $_SESSION['name']; 
?> 
```

你可能想做：

```
<?php
$_SESSION['name'] = $name;
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T08:45:27.267

首先，您将名称变量分配给会话变量

```
<?php session_start();?>
<?php
$_SESSION['name'] = $name;
?>
<FORM action="results.php" method="post" enctype="multipart/form-data" id="questionnaire">
<input type="text" name="name" id="name" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T08:46:37.787

结果.php：

```
<?
session_start();
$name = isset($_POST['name'])?$_POST['name']:'';

if($name){
$_SESSION['name']=$name;

}
?>
<html>           
<body>                   
    <?php echo $name; ?>                               
</body>           
</html> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-06T09:28:27.527

```
Try....
 Page 1.php : <?php session_start();
$_SESSION['name'] = isset($_POST['name']) ? $_POST['name'] : '';
 ?>
  <FORM action="results.php" method="post" enctype="multipart/form-data" id="questionnaire">
  <input type="text" name="name" id="name" />

Results.php:

<?php session_start();?>

<html>           
    <body>                   
        <?php 
        $name = $_SESSION['name'];
        echo $name; ?>                               
    </body>           
</html> 
```

# css - height: calc(100%) not working correctly in CSS

> ID：16164736
> 
> 赞同：64
> 
> 时间：2013-04-23T08:40:44.587
> 
> 标签：css

I have a div that I want to fill the whole height of the body less a set number in pixels. But I can't get `height: calc(100% - 50px)` to work.

The reason I want to do this is I have elements that have dynamic heights based on some varying criteria, e.g. height of the header changes based on different elements it can contain. A content div then needs to stretch to fill the rest of the available space available.

The div element, however, stays the height of the content - it doesn't seem as if it interprets 100% to be the height of the body element.

```
body {
  background: blue;
  height: 100%;
}

header {
  background: red;
  height: 20px;
  width: 100%;
}

h1 {
  font-size: 1.2em;
  margin: 0;
  padding: 0;
  height: 30px;
  font-weight: bold;
  background: yellow;
}

#theCalcDiv {
  background: green;
  height: calc(100% - (20px + 30px));
  display: block;
}
```

```
<header>Some nav stuff here</header>
<h1>This is the heading</h1>
<div id="theCalcDiv">This blocks needs to have a CSS calc() height of 100% - the height of the other elements.</div>
```

I would appreciate any help or pointers in the right direction.

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2013-04-23T08:56:41.383

您需要确保将 html 和 body 设置为 100%，并确保为 calc 添加供应商前缀，例如 -moz-calc、-webkit-calc。

以下 CSS 有效：

```
html,body {
    background: blue;
    height:100%;
    padding:0;
    margin:0;
}
header {
    background: red;
    height: 20px;
    width:100%
}
h1 {
    font-size:1.2em;
    margin:0;
    padding:0;
    height: 30px;
    font-weight: bold;
    background:yellow
}
#theCalcDiv {
    background:green;
    height: -moz-calc(100% - (20px + 30px));
    height: -webkit-calc(100% - (20px + 30px));
    height: calc(100% - (20px + 30px));
    display:block
} 
```

我还在 html 和 body 上将您的边距/填充设置为 0，否则添加时会有一个滚动条。

这是一个更新的小提琴

[http://jsfiddle.net/UF3mb/10/](http://jsfiddle.net/UF3mb/10/)

浏览器支持：IE9+、Firefox 16+ 和供应商前缀 Firefox 4+、Chrome 19+、Safari 6+

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2015-11-13T13:56:21.423

首先 - 使用 Firebug（或您的偏好）检查浏览器是否正在解释 css 属性。有时使用的工具会给你带来问题，所以不要再打猎了。

第二关 - 检查兼容性：[http ://caniuse.com/#feat=calc](http://caniuse.com/#feat=calc)

第三 - 几个小时前我遇到了一些问题并且刚刚解决了它。这是最小的事情，但它让我忙了 30 分钟。

这是我的 CSS 的外观

```
#someElement {
    height:calc(100%-100px);
    height:-moz-calc(100%-100px);
    height:-webkit-calc(100%-100px);
} 
```

看起来对吧？错误 下面是它的外观：

```
#someElement {
    height:calc(100% - 100px);
    height:-moz-calc(100% - 100px);
    height:-webkit-calc(100% - 100px);
} 
```

看起来一样吧？

**注意空格！！！** 检查了安卓浏览器、安卓版火狐、安卓版Chrome、Windows版Chrome和Firefox以及Internet Explorer 11。如果没有空格，它们都忽略了CSS。

希望这可以帮助某人。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2018-05-29T14:23:25.333

我正在寻找为什么 % 似乎不起作用。因此，我使用 100vh 进行了测试，而不是仅将其设置为 100%，似乎 100vh 在几乎所有浏览器/设备上都非常有效。

示例：您只想在顶部 div 滚动之前向用户显示它，就像英雄横幅模块一样。但是，页面顶部是一个高度为 68 像素的导航栏。以下对我来说根本不起作用 %

```
height: calc(100% - 68px); 
```

没有任何变化。页面保持不变。但是，当将其交换为“vh”时，效果很好！您分配的 div 块也将仅保留在查看器的设备高度上。直到他们决定向下滚动页面。

```
height: calc(100vh - 68px); 
```

更改 +/- 以包括标题在顶部的大小。如果您的导航栏高度为 120 像素，则将 68 像素更改为 120 像素。

希望这可以帮助任何无法使用正常**高度进行此工作的人： calc();**

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-23T08:49:21.997

尝试将`html`和都设置`body`为高度 100%；

```
html, body {background: blue; height:100%;} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-02-11T12:31:24.323

层次结构中的所有父元素的高度都应为 100%。只需将 max-height:100% 给元素和 max-height:calc(100% - 90px) 给直接父元素。

它在 IE 上也对我有用。

```
html,
body {
    height: 100%
}

parent-element {
    max-height: calc(100% - 90px);
}

element {
    height:100%;
} 
```

调整窗口大小或在 DOM 中加载数据时，由于 Calc 失败，IE 中的渲染失败。但是上面提到的这种方法即使在 IE 中也对我有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-23T09:23:12.133

您不需要计算任何东西，并且可能不应该：

```
<!DOCTYPE html>
<head>
<style type="text/css">
    body {background: blue; height:100%;}
    header {background: red; height: 20px; width:100%}
    h1 {font-size:1.2em; margin:0; padding:0; 
        height: 30px; font-weight: bold; background:yellow}
    .theCalcDiv {background-color:green; padding-bottom: 100%}
</style>
</head>
<body>
<header>Some nav stuff here</header>
<h1>This is the heading</h1>
<div class="theCalcDiv">This blocks needs to have a CSS calc() height of 100% - the height of the other elements.
</div> 
```

为了简洁起见，我把它们粘在一起。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-29T08:58:47.417

如果您**在 GWT 项目中设置 calc**样式，它的解析器可能不会为您解析 calc，因为它没有为我解析……[解决方案](https://groups.google.com/forum/#!topic/google-web-toolkit/TLYgNn3jAl0)是将**其包装在这样的 css 文字中**：

```
height: literal("-moz-calc(100% - (20px + 30px))");
height: literal("-webkit-calc(100% - (20px + 30px))");
height: literal("calc(100% - (20px + 30px))"); 
```

# php - Wikipedia api 计算单词的出现次数。

> ID：16164739
> 
> 赞同：0
> 
> 时间：2013-04-23T08:40:48.840
> 
> 标签：php, api, wikipedia

我需要对给定的单词实施关键短语的测量。这意味着该词的重要性，例如“example”一词不如“nuclear”一词重要。我试图实施的建议措施是一个简单的措施，它考虑了该词在 wiki 文章中出现的总数以及它在链接中出现的时间为

```
((link appearance)/(total appearances)) 
```

我可以检索“术语”的总出现次数

```
$url=http://en.wikipedia.org/w/api.php?&action=query&list=search&srlimit=50&srredirects&srprop=snippet&srnamespace=0&srsearch=term;
$page=unserialize(file_get_contents($url));
$totalhits=$page["query"]["searchinfo"]["totalhits"]; 
```

我现在需要的是一种方法来检索该单词出现在链接中的数字。提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:05:28.497

我认为您正在寻找的内容无法通过 API 合理访问。相反，您应该下载所有文章（特别是文件）的[转储，](https://meta.wikimedia.org/wiki/Data_dumps)`pages-articles`然后通过它来获取您需要的信息。

# ffmpeg - 使用 g++ compile 构建的共享库有效，并且无法使用 automake compile

> ID：16164741
> 
> 赞同：2
> 
> 时间：2013-04-23T08:40:58.430
> 
> 标签：ffmpeg, g++, shared-libraries, automake

我正在 CentOS 6.2 上构建一个共享库。共享库将构建有一些cpp文件，头文件，c共享库和ffmpeg。共享库用于转换视频。当我像这样使用 g++ 编译时：

```
g++    DataType.h    h264function.h  h264function.cpp videoconvert.h videoconvert.cpp      stdafx.h stdafx.cpp YV12toRGB.h YV12toRGB.cpp -lMPCtrl -lavcodec -lavformat -lavutil -   lhcnetsdk -lPlayCtrl -lpthread -fPIC -shared -o libtest.so 
```

它可以正常工作，并且可以将视频转换为标准h264编码。看起来用于构建库的文件是

很好。但是当我使用自动工具制作库时，它无法正常工作。这是我的 configure.in 和 Makefile.am：

生成文件.am：

```
prefix=/usr
lib_LTLIBRARIES=libhikvisiontranso.la

libhikvisiontranso_la_SOURCES=stdafx.h stdafx.cpp videoconvert.h videoconvert.cpp 
h264function.h h264function.cpp YV12toRGB.h YV12toRGB.cpp DataType.h 

libhikvisiontranso_la_LDFLAGS=-avoid-version -shared 
libhikvisiontranso_la_LIBADD=-lpthread -lMPCtrl -lhcnetsdk -lPlayCtrl -lavformat -    lavcodec -lavutil
ACLOCAL_AMFLAGS= -I m4 
```

配置.in：

```
#                                               -*- Autoconf -*-
# Process this file with autoconf to produce a configure script.

AC_PREREQ([2.63])
AC_INIT([hikvisiontranso],[1.0], [songxiawuren@gmail.com])
AM_INIT_AUTOMAKE([libhikvisiontranso.so],[1.0])
AC_CONFIG_SRCDIR([DataType.h])
AC_CONFIG_HEADERS([config.h])
AC_CONFIG_MACRO_DIR([m4])
AT_INIT
# Checks for programs.
AC_PROG_CXX
AC_PROG_CC

# Checks for libraries.

# Checks for header files.
AC_CHECK_HEADERS([inttypes.h limits.h stddef.h stdint.h stdlib.h string.h])

# Checks for typedefs, structures, and compiler characteristics.
AC_HEADER_STDBOOL
AC_C_INLINE
AC_TYPE_INT16_T
AC_TYPE_INT32_T
AC_TYPE_INT64_T
AC_TYPE_INT8_T
AC_TYPE_SIZE_T
AC_TYPE_UINT16_T
AC_TYPE_UINT32_T
AC_TYPE_UINT64_T
AC_TYPE_UINT8_T

# Checks for library functions.
AC_FUNC_MALLOC
AC_PROG_LIBTOOL
AC_CONFIG_FILES([Makefile])
AC_OUTPUT 
```

错误的输出是：

```
SDL Init

init console=1

Output #0, avi, to '/home/ningge/Desktop/HaikangDvr.avi':

Stream #0.0: Invalid Codec type -1

Height = 576; Width = 704;totalfram=90000

Segmentation fault (core dumped) 
```

右边是：

```
SDL Init

init console=1

Output #0, avi, to '/home/ningge/Desktop/HaikangDvr.avi':

Stream #0.0: Video: mpeg4, yuv420p, 704x576, q=2-31, 200 kb/s, 90k tbn, 25 tbc

Height = 576; Width = 704;totalfram=90000

CSDLInit goOut 
```

我希望有人可以帮助我找出 automake 有什么问题。

# c - 受限环境中的 FFT 分辨率

> ID：16164742
> 
> 赞同：1
> 
> 时间：2013-04-23T08:41:00.387
> 
> 标签：c, embedded, real-time, signal-processing, fft

所以我以每秒 10 公斤样本的速度从传感器采样数据。我将从这个传感器连续收集 512 个样本，然后尝试对其进行 FFT。但这是问题所在，我不得不对其进行 16 点 FFT。因此，据我了解，我将 512 个样本的帧分成 16 个的 bin，并分别对它们进行 FFT。一旦我这样做了，我只是将它们并排合并。

我的问题：

如果我的采样频率是每秒 10 公斤样本，我的 FFT 大小是 16，那么我的 bin 大小应该是 625 Hz，对吗？

其次，我在合并上述 FFT 输出时是否正确？

我将非常感谢您的回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T17:36:09.597

您还可以执行 2 层 radix-16 FFT 和位混洗，再加上 1 层 radix-2 FFT 蝶形，以产生与长度为 512 的 FFT 相同的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:19:12.603

If you collect data in 512-sample chunks but are constrained to 16-point FFT, you will have to perform the FFT 32 times for each chunk and average the results (either for each chunk or for the entire recording - your choice).

The sampling rate determines the upper limit of the frequency values you assign to the FFT results, and it doesn't matter whether you are looking at 512 samples or 16 samples at a time. Your top frequency is going to be 1/2 the sample rate = 5 kHz.

The series of frequency results will be (in Hz) ...

5000 2500 1250 625 312.5 ... and so on, depending on how many samples you pass to the FFT.

I'm not going to ask why you're restricted to 16-point FFT!

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T15:21:36.787

如果您使用 16 点 FFT，那么您将获得的分辨率较低。它将能够仅使用 8 个独特的 bin 来捕获 0-5 Sa/s 的频率。

关于你关于垃圾箱大小的问题，我不明白你为什么需要它。

我认为为了获得更好的结果，您还可以平均采样点以适合您的 16 点 FFT。

# complexity-theory - 卷积的计算复杂度

> ID：16164749
> 
> 赞同：8
> 
> 时间：2013-04-23T08:41:30.640
> 
> 标签：complexity-theory, fft, convolution

我读到一般卷积算法的计算复杂度是`O(n^2)`，而借助 FFT 是`O(n log n)`。

2-D 和 3-D 中的卷积呢？

有什么参考吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-05-12T18:39:59.710

至于二维和三维卷积和快速傅里叶变换，复杂度如下：

```
 2D                     3D 
```

* * *

```
Convolution               O(n^4)                  O(n^6) 
```

* * *

```
FFT                   O(n^2 log^2 n)           O(n^3 log^3 n) 
```

参考：[数字图像处理](https://is.muni.cz/auth/el/1433/podzim2011/PV131/um/8943284/lecture04_2008.pdf)幻灯片，幻灯片编号。34.

# redis - Redis数据库存储限制和HA

> ID：16164750
> 
> 赞同：1
> 
> 时间：2013-04-23T08:41:33.023
> 
> 标签：redis, hiredis

我想为拥有大型数据库的应用程序使用 redis 服务器。所以我想知道大数据redis服务器如何存储？？？它是否与大型数据库兼容，因为我听说 redis 是内存数据库

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T09:45:53.123

Redis 是一个内存存储。所以限制是你的盒子上可用的内存（或者你的盒子，如果你想分片你的数据）。Redis 非常高效，因为它主要依赖于 O(1) 或 O(log n) 算法，但这是以消耗内存为代价的。

如果您计划运行大型数据库，它可能不是一个好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-27T00:45:32.430

Redis 不是大数据的数据库（说是 30+GB 的数据），考虑使用 SSDB（[https://github.com/ideawu/ssdb](https://github.com/ideawu/ssdb)），适合 TB 级的数据，几乎所有 Redis 的 API。

# jquery - Joomla 模块中的 jQuery AJAX

> ID：16164751
> 
> 赞同：0
> 
> 时间：2013-04-23T08:41:34.450
> 
> 标签：jquery, ajax, joomla, joomla2.5

我已经成功地将 AJAX 添加到 Joomla 模块中（请参阅此处了解我如何将 AJAX 放入 Joomla 模块的非常不完美的[实现](https://stackoverflow.com/questions/13446333/putting-ajax-in-a-joomla-module)）

我遇到的问题是返回错误，因为当我抛出错误时，我刚刚抛出了一条 JApplication 消息，例如

```
JFactory::getApplication()->enqueueMessage('Some error message', 'error'); 
```

但是很明显，这并没有给 AJAX 任何错误的嗅觉，所以每当我提交它时，它都称它为“成功”。因此我的问题。

太多我喜欢的用户仍然没有启用 Javascript，让我很高兴只添加一个直接的 400 标头重定向（无论如何我希望向用户显示错误消息）。我仍然希望 JApplication 在禁用 javascript 时通过 PHP 将错误消息排入队列作为后备。

我还看到了将错误消息回显到页面上的方法。但是由于 Joomla 模块处理 AJAX 的方式不是特别有用，所以回调数据结果实际上是页面的完整 html 代码！所以我必须在页面上专门选择一个元素，我想如果我这样做的话——我不知道该怎么做/如果它甚至可能！

那么，为 AJAX 抛出错误消息然后检索它以便我可以将其显示给用户的最佳方法是什么（但仍然保留一个不错的非 JavaScript 后备？）谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-20T06:40:04.563

```
<script>
  jQuery(window).load(function(){
   var data = {};
   display_result_data();
  });
function display_map_result_data() {
var ajaxUrl = "modules/mod_mapcontent/submit_form.php";
 jQuery.ajax({
              type: "POST",
              url: ajaxUrl,
              data: {category: 'simple'},
              dataType    : "json",
              async       : false,
              success : function(result){
                data = result;
               }
          });
}
 </script>
<?php
/**
 * @package     Joomla.Site
 * @subpackage  mod_banners
 *
 * @copyright   Copyright (C) 2005 - 2013 Open Source Matters, Inc. All rights reserved.
 * @license     GNU General Public License version 2 or later; see LICENSE.txt
*/
  defined('_JEXEC') or die;
  $baseurl = JURI::base();
?>
 <div id="mapcontent" class="mapcontent">
   <div id="map-canvas"></div>
 </div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-12T09:36:05.683

Joomla javascript 对象为此目的具有适当的函数 renderMessages。

```
// available msg types: success, error, notice
var msg = {
    error: ['it is an error!<br />', 'it is enother error!'],
    success: ['It works!!']
};
Joomla.renderMessages( msg ); 
```

![结果](https://i.stack.imgur.com/LLnPc.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T10:14:46.180

模块不能完全控制应用程序的输出，还涉及到组件和插件。

您需要一些可以输出消息队列并关闭应用程序的东西。

*   单独的组件
*   将位于模块文件夹中并连接到应用程序的[独立应用程序](http://docs.joomla.org/How_to_access_session_variables_set_by_an_external_script)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-26T06:49:40.493

Joomla 开发人员一直在改变过去非常有用的东西，使它们更难使用。其中之一是消息队列。目前，您只能阅读它。

因此，如果您可以在消息队列中设置消息，然后使用您的 AJAX 响应将其移动到对 AJAX 更友好的位置进行显示 - 您将被设置。正确的？这样，它就在队列中等待在下一页加载时显示，并且如果用户成功发出 AJAX 请求（表明他们启用了 JS），则消息将通过 AJAX 响应移动到客户端。

首先，您需要一个安装/启用反射的服务器。据我所知，它内置于 PHP 5.3 及更高版本。您可以在 PHP 5.2 和之前的一些版本中获得它。因为我的解决方案需要它，所以我假设您拥有它。

此函数需要部分错误消息进行搜索。因此，您需要计划错误输出，以便在消息队列中找到它。您可以假设您的消息是队列中唯一的消息，但我不会。当 h 函数找到消息时，它会抓取它，将其从消息队列中清除，并返回完整的消息。

```
function getMessage($error) {
  $app=JFactory::getApplication();
  $appReflection = new ReflectionClass(get_class($app));
  $_messageQueue = $appReflection->getProperty('_messageQueue');
  $_messageQueue->setAccessible(true);
  $messages = $_messageQueue->getValue($app);
  foreach($messages as $key=>$message) {
      if(preg_match('/'.preg_quote($error,'/').'/',$message['message'])) {
          $return = $message;
          unset($messages[$key]);
      }
  }
  $_messageQueue->setValue($app,$messages);
  return $return;
} 
```

使用此方法，您可以设置 ajax 响应以将消息作为单独的数据值包含在客户端 ajax 处理程序中使用。当用户关闭 JS 时，服务器上的 ajax 处理程序永远不会运行此代码，因此该消息显示为正常的系统消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-05T07:33:16.093

在您的功能中：

```
 $app = JFactory::getApplication();
    echo new JResponseJson(null, $app->enqueueMessage('Some errormessage','error'));

    //close the $app
    $app->close(); 
```

在您的 javascript 中：

```
 success: function(response) {
            var jMsgs = response.messages;  // You can stack multiple messages of the same type
            Joomla.renderMessages(jMsgs);
    } 
```

# perl - 用 perl/awk 连接虚线

> ID：16164753
> 
> 赞同：1
> 
> 时间：2013-04-23T08:41:37.277
> 
> 标签：perl, unix, join, sed, awk

我有一个带有 sql 损坏语句的大文件，例如：

```
PP3697HB @@@@0
<<<<<<Record has been deleted as per PP3697HB>>>>>>
FROM sys.xtab_ref rc,sys.xtab_sys f,sys.domp ur WHE
RE rc.milf = ur.milf  AND rc.molf = f.molf AND ur.dept = 'SWIT'AND ur
.department = 'IND' AND share = '2' AND ur.status = 'DONE' AND f.s
tatus = 'TRUE' AND rc.OPERATOR = '=' AND rc.VALUE = '261366'AND rc.r
unet IN (SELECT milf FROM sys.domp WHERE change = 'OVO' A
ND IND = 75); 
```

我需要将所有这些断线重新组合成一条线。

该行应如下所示：

```
PP3697HB @@@@0<<<<<<Record has been deleted as per PP3697HB>>>>>>FROM sys.xtab_ref rc,sys.xtab_sys f,sys.domp ur WHERE rc.milf = ur.milf  AND rc.molf = f.molf AND ur.dept = 'SWIT'AND ur.department = 'IND' AND share = '2' AND ur.status = 'DONE' AND f.status = 'TRUE' AND rc.OPERATOR = '=' AND rc.VALUE = '261366'AND rc.runet IN (SELECT milf FROM sys.domp WHERE change = 'OVO' AND IND = 75); 
```

如何在 perl/awk 中实现这一点。

可以说行的开头一定是`^PP(.*)`，sql语句的结尾一定是`(.*);$`

如果您难以理解问题，请告诉我，我会再次尝试解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:48:36.270

`tr`用于删除换行符并拆分`sed`每个 SQL 语句：

```
tr '\n' ' ' < file | sed 's/;/;\n/g' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:47:49.143

试试这个单行：

```
awk '!/;$/{printf "%s",$0}/;$/{print}' file 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T01:42:19.260

假设有其他行没有像这样拆分，并且只有指定的行需要重新加入：

```
awk '
    /^PP/ {insql=1}
    /;$/  {insql=0}
    insql {printf "%s", $0; next}
          {print}
' file 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T08:46:04.260

在 Perl 中尝试这个解决方案：

```
#!/usr/bin/perl -w    
use strict;
use warnings;
use Data::Dumper;

## The raw string
my $str = "                                                                                                                                                                                                                                  
PP3697HB @@@@0                                                                                                                                                                                                                               
<<<<<<Record has been deleted as per PP3697HB>>>>>>                                                                                                                                                                                          
FROM sys.xtab_ref rc,sys.xtab_sys f,sys.domp ur WHE                                                                                                                                                                                          
RE rc.milf = ur.milf  AND rc.molf = f.molf AND ur.dept = 'SWIT'AND ur                                                                                                                                                                        
.department = 'IND' AND share = '2' AND ur.status = 'DONE' AND f.s                                                                                                                                                                           
tatus = 'TRUE' AND rc.OPERATOR = '=' AND rc.VALUE = '261366'AND rc.r                                                                                                                                                                         
unet IN (SELECT milf FROM sys.domp WHERE change = 'OVO' A                                                                                                                                                                                    
         ND IND = 75);                                                                                                                                                                                                                       
";

## Split the given string as per new line.
my @lines = split(/\n/, $str);

## Join every element of the formed array using blank.
$str = join("", @lines);

print $str; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T08:47:43.243

Perl 解决方案：

```
perl -ne 'chomp $last unless /^PP/; print $last; $last = $_ }{ print $last' FILE.SQL 
```

# facebook-graph-api - facebook 图形 api、签到、were_here_count 和帖子

> ID：16164757
> 
> 赞同：2
> 
> 时间：2013-04-23T08:41:49.950
> 
> 标签：facebook-graph-api

你好我正在学习facebook graph api来研究如何使用地标信息来记录城市的人流量或交通流量。

我有一些关于地标和粉丝页面的问题。

1.  当我注意到一个地标或粉丝页面有一个新的签到，但是从 Graph Api Explorer 中检索到的数据没有改变，签到数量与粉丝页面上显示的结果相差很大时，facebook真的使用签到吗？柱子？

2.  什么是 was_here_count 列？它与签入列不同吗？

3.  搜索Graph API文档的时候，看到一句话

> “注意：不推荐发布 Checkin 对象，而赞成创建附有位置的帖子。”

是不是意味着当有人在地标上签到时，他/她的签到记录将被识别为一个帖子对象，这样签到列就没有意义了？

谢谢！

# php - 在mysql中的同一条语句中合并更新和插入查询

> ID：16164758
> 
> 赞同：1
> 
> 时间：2013-04-23T08:41:50.657
> 
> 标签：php, mysql

除了事务和存储过程之外，是否可以在同一语句中组合更新和插入查询。

例如：有时我想更新表 1 中的记录以及插入表 2 中的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:42:12.060

可以使用

```
multi_query 
```

[你可以在这里找到](http://php.net/manual/en/mysqli.multi-query.php)更多关于它的信息

像这样的东西

```
 $link = mysqli_connect("server", "user", "pass", "db");

 if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
 }

$testquery .= "INSERT INTO x (`agent_name`, `job_number`, `job_value`, `points_value`) SELECT agent_name, job_number, job_value, points_value FROM jobs WHERE YEAR(booked_date) = $current_year && WEEKOFYEAR(booked_date) = $weeknum;";

$testquery .= "SELECT agent_name, SUM(job_value), SUM(points_value) FROM leaderboard GROUP BY agent_name ORDER BY SUM(points_value) DESC";

mysqli_multi_query($link, $testquery) or die("MySQL Error: " . mysqli_error($link) . "<hr>\nQuery: $testquery"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T09:15:22.603

您只需键入它，mysqli 就会自动读取它。喜欢

```
@mysql_query("INSERT INTO x (`name`,`age`) VALUES ('me','21')");
@mysql_query("UPDATE y SET `status`='verified' WHERE `name`='me'"); 
```

# linux - how to prevent the process launching if it was launched before?

> ID：16164759
> 
> 赞同：0
> 
> 时间：2013-04-23T08:41:55.293
> 
> 标签：linux, launching-application, multiprocess

I have application that has a several process, including the authentication process. I need to prevent launching of authentication, if connection was established and authentication successfull. How can I implement this behavior? Platform - linux.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:51:06.640

您可以利用共享信号量和小型共享内存。我们称之为信号量`mutex`和共享内存`bool is_authenticated`。用值 1 和false`mutex`值初始化。`is_authenticated`

然后您的身份验证过程变为：

```
wait(mutex);

if (!is_authenticated)
    authenticate();
is_authenticated = true;

signal(mutex); 
```

然后，您将不得不处理身份验证过期问题。所以当会话结束时：

```
wait(mutex);

assert(is_authenticated == true);  /* if not, you have been compromised */
deauthenticate();
is_authenticated = false;

signal(mutex); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:45:52.643

您可以简单地签入您的进程，因为已经有相同的应用程序正在运行。有强大的库可以让您进行高级检查、锁定资源等等……取决于您使用的语言。

最简单的解决方案是创建一个表明程序正在运行的锁定文件（例如在 /tmp 中），并在程序的开头检查是否存在这样的文件。这种方法的缺点是您必须确保即使应用程序崩溃也会删除锁定文件。

# java - 使用java将多个值插入mysql db表时出错

> ID：16164760
> 
> 赞同：0
> 
> 时间：2013-04-23T08:41:59.373
> 
> 标签：java, mysql, jdbc

这是我的问题。我必须编写一个程序，从 Excel 文件中读取数据并将这些数据加载到数据库中的表中。该表将具有 excel 文件的名称，表的字段将是 excel 文件第一行中的数据。我已经编写了代码来读取 excel 文件并使用我想要的名称创建表。现在我必须在表中插入值，但这里出现错误。

下面的代码是我制作的整个程序。

```
import java.io.FileInputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;

import org.apache.poi.hssf.usermodel.HSSFCell;
import org.apache.poi.hssf.usermodel.HSSFRow;
import org.apache.poi.hssf.usermodel.HSSFSheet;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.commons.lang3.StringUtils;
import org.apache.poi.ss.usermodel.Cell;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

public class readexcel {

    public static void main (String[] args) throws Exception {

        Class.forName("com.mysql.jdbc.Driver");
        Connection con = (Connection) DriverManager.getConnection("jdbc:mysql://localhost:3306/kainourgia","root", "root");
        Statement  stmt = con.createStatement();
        //String filename = "C:\\Users\\myfiles\\Documents\\test6.xls";
        String fullPath = "C:\\Users\\myfiles\\Documents\\test7.xls";
        String Path = "C:\\Users\\myfiles\\Documents\\";
        String filename = "test7.xml";
        String[] parts = filename.split("\\.");
        String tablename = parts[0];

        List sheetData = new ArrayList();
        FileInputStream fis = null;
        try {
            fis = new FileInputStream(fullPath);
            HSSFWorkbook workbook = new HSSFWorkbook(fis);
            HSSFSheet sheet = workbook.getSheetAt(0);

            Iterator rows = sheet.rowIterator();
            while (rows.hasNext()) {
                HSSFRow row = (HSSFRow) rows.next();
                Iterator cells = row.cellIterator();

                List data = new ArrayList();
                   while (cells.hasNext()) {
                   HSSFCell cell = (HSSFCell) cells.next();
                   data.add(cell);
                   }
                   sheetData.add(data);
            }

                   } catch (IOException e) {
                   e.printStackTrace();
                   } finally {
                   if (fis != null) {
                   fis.close();
                   }
                   }

    showExcelData(sheetData);
    HashMap<String,Integer> tFields = new HashMap();
    tFields = parseExcelData(sheetData);
    String str = getCreateTable(con, tablename, tFields);
    str = fillTable ( con, tablename, tFields);
    }

    private static void showExcelData(List sheetData) {
//      HashMap<String, String> tableFields = new HashMap();
        for (int i=0; i<sheetData.size();i++){
          List list = (List) sheetData.get(i);
          for (int j=0; j<list.size(); j++){
              Cell cell = (Cell) list.get(j);
              if (cell.getCellType() == Cell.CELL_TYPE_NUMERIC)
              {
                  System.out.print(cell.getNumericCellValue());
              }
              else if(cell.getCellType()==Cell.CELL_TYPE_STRING)
              {
                  System.out.print(cell.getRichStringCellValue());
              }
              else if(cell.getCellType()==Cell.CELL_TYPE_BOOLEAN) {
                  System.out.print(cell.getBooleanCellValue());
              }
              if (j < list.size() - 1) 
              {
                  System.out.print(", ");
              }
          }
          System.out.println("");
        }
    }

    @SuppressWarnings({ "unchecked", "unused" })
    private static HashMap parseExcelData (List sheetData){

            HashMap<String,Integer> tableFields = new HashMap();
            List list = (List) sheetData.get(0);
            for (int j=0; j<list.size(); j++){
                Cell cell=(Cell) list.get(j);
                tableFields.put(cell.getStringCellValue(),cell.getCellType());
        }

            return tableFields;

        }

    private static String getCreateTable(Connection con, String tablename, HashMap<String, Integer> tableFields){
        Iterator iter = tableFields.keySet().iterator();
        Iterator cells = tableFields.keySet().iterator(); 
        String str="";
        String[] allFields = new String[tableFields.size()];
        int i = 0;
        while (iter.hasNext()){
            String fieldName = (String) iter.next();
            Integer fieldType=(Integer)tableFields.get(fieldName);

            switch (fieldType){
                case Cell.CELL_TYPE_NUMERIC:
                    str=fieldName + " INTEGER";
                    break;
                case Cell.CELL_TYPE_STRING:
                    str= fieldName + " VARCHAR(255)";
                    break;
                case Cell.CELL_TYPE_BOOLEAN:
                    str=fieldName + " INTEGER";
                    break;
            }
            allFields[i++]= str;
        }
        try 
        {
            Statement  stmt = con.createStatement();
//          try
//          {
//              System.out.println( "Use the database..." );
//              stmt.executeUpdate( "USE kainourgia;" );
//          }
//          catch( SQLException e )
//          {
//              System.out.println( "SQLException: " + e.getMessage() );
//              System.out.println( "SQLState:     " + e.getSQLState() );
//              System.out.println( "VendorError:  " + e.getErrorCode() );
//          }
            try
            {
                String all = org.apache.commons.lang3.StringUtils.join(allFields, ",");
                String createTableStr = "CREATE TABLE " + tablename + " (" + all + ")";

                System.out.println( "Create a new table in the database" );
                stmt.executeUpdate( createTableStr );
            }
            catch( SQLException e )
            {
                System.out.println( "SQLException: " + e.getMessage() );
                System.out.println( "SQLState:     " + e.getSQLState() );
                System.out.println( "VendorError:  " + e.getErrorCode() );
            }
        }
        catch(Exception e)
        {
        }
        return str;
    }

    private static String fillTable(Connection con, String fieldname, HashMap<String, Integer> tableFields){
        Iterator iter = tableFields.keySet().iterator();
        Iterator cells = tableFields.keySet().iterator(); 
        String str="";
        String[] tousFields = new String[tableFields.size()];
        int i = 1; 
        while (iter.hasNext()){
            String fieldName = (String) iter.next();
            Integer fieldType=(Integer)tableFields.get(fieldname);
            while (cells.hasNext()){
                String fieldName1 = (String) cells.next();
                Integer fieldType1=(Integer)tableFields.get(fieldName1);
                }
                tousFields[i++]= str;   
        }
        try
        {
            Statement  stmt = con.createStatement();
            System.out.println ( "Use the table");
            String all = org.apache.commons.lang3.StringUtils.join(tousFields, ",");
            String sql= "INSERT INTO" + fieldname + "VALUES (" +all +")";
            stmt.executeUpdate (sql);
        }
        catch( SQLException e )
        {
            System.out.println( "SQLException: " + e.getMessage());
            System.out.println( "SQLState: " + e.getSQLState() );
            System.out.println( "VendorError: " + e.getErrorCode());
        }

        return str;
    }
    private Statement createStatement() {
        return null;
    }           

} 
```

我得到的错误是这样的：

```
Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: 3
    at readexcel.fillTable(readexcel.java:183)
    at readexcel.main(readexcel.java:68) 
```

谁能帮我修一下？我必须做什么才能在每个单元格中插入值？插入值中的命令是否正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:45:07.103

您尝试访问不存在的索引`tousFields`。

您需要将其声明为：

```
String[] tousFields = new String[tableFields.size() + 1]; 
```

# matlab - Memory optimisation

> ID：16164761
> 
> 赞同：1
> 
> 时间：2013-04-23T08:42:03.733
> 
> 标签：matlab, memory-optimization

I'm just curious to know if I can reduce memory usage of Matlab by using some option. Clicking on a variable in workspace shows a long digit which may not be necessary in most of cases. e.g.,

```
[20, 25.0540913632159, 16.2750000000000, 3.08852992798468]; 
```

for me `25.054091` may be more than ok. Are there any options that Matlab just reduce numbers for internal calculation and does it make any difference.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T09:00:38.230

现代 PC 使用*浮点数*来计算非整数值。

它们有两种标准化变体：`float`和`double`，其中后者的大小是前者的两倍。

Matlab，默认情况下`double`，所有计算都使用 (complex) s。

您可以通过指定类型来强制它使用`float`（或 Matlab 调用它们`single`）：

```
a = single([20, 25.0540913632159, 16.2750000000000, 3.08852992798468]); 
```

这应该使用一半的内存，并且您会失去一些在您的应用程序中可能重要或不重要的精度。在执行此操作之前确保优化是值得的，因为执行速度甚至可能更慢（由于内置函数仅在 上运行`double`，因此需要额外的两次转换）。

# ruby-on-rails - Rails, Redis, Linux bin file error

> ID：16164764
> 
> 赞同：0
> 
> 时间：2013-04-23T08:42:07.313
> 
> 标签：ruby-on-rails, ubuntu, redis, bin

i am attempting to get redis-server running in my rails app. i am following this post [here](http://www.jimneath.org/2011/03/24/using-redis-with-ruby-on-rails.html) (the version numbers are a little outdated) but it seems from the error i am getting

```
@rob:~/Work/boogle[master]$ redis-server
bash: /usr/local/bin/redis-server: No such file or directory 
```

that the file isnt being found! as you can see its looking for it in `/usr/local/bin/` the post i am following suggested that i `cp src/redis-server src/redis-cli /usr/bin` which suggests that `/usr/local/bin/` and `/usr/bin` are different bin files is it safe to just `cp src/redis-server src/redis-cli /usr/local/bin` i am a little scared to mess with the bin files, and creating a '`redis`-ception ' by running redis-server in the home dir.

I have a bad feeling like my bin or .bashrc file is F'd, any suggestions?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T09:14:30.857

该指南要求您通过源安装 redis。

你不需要这个。

您可以简单地使用 apt 安装 redit：

```
sudo add-apt-repository ppa:rwky/redis
sudo apt-get update
sudo apt-get install redis-server 
```

# c++ - 理解 std::function 和 std::bind

> ID：16164769
> 
> 赞同：9
> 
> 时间：2013-04-23T08:42:14.233
> 
> 标签：c++, c++11, std-function, stdbind

我正在玩 std::function 和 std::bind ，我注意到一些不直观的东西，我想更好地理解它。

例如：

```
void fun()
{
}

void hun(std::string) 
{ 
}

int main()
{

   function<void(int)> g = &fun; //This fails as it should in my understanding.

   function<void(int)> f = std::bind(fun); //This works for reasons unknown to me     
   function<void(int, std::string)> h = std::bind(hun); //this doesn't work

return 0;
} 
```

如何将 a 绑定**`function<void(int)>`**到**void()**函数。然后我可以调用 f(1) 并获得 fun()。我想了解这是如何完成的。深入 Microsoft Visual Studio 2012 的实现让我迷失在无法阅读的宏的海洋中。所以这就是我在这里问这个问题的原因。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-23T08:56:37.123

如果您不使用参数占位符 ( `_1`, `_2`, ...)，则传递给从返回的函数对象的任何参数`std::bind`都将被丢弃。和：

```
std::function<void(int)> f = std::bind(fun, std::placeholders::_1); 
```

正如预期的那样，我得到了一个（又长又丑的）错误。

对于对标准语感兴趣的人：

`§20.8.9.1.2 [func.bind.bind]`

```
template<class F, class... BoundArgs>
*unspecified* bind(F&& f, BoundArgs&&... bound_args); 
```

> p3 返回：`g`具有弱结果类型 (20.8.2) 的转发调用包装器。的效果`g(u1, u2, ..., uM)`应该是`INVOKE(fd, v1, v2, ..., vN, result_of<FD cv (V1, V2, ..., VN)>::type)`，其中*cv*表示 的*cv 限定符*，`g` **绑定参数的值和类型`v1, v2, ..., vN`按以下规定确定**。
> 
> p10 绑定参数的值`v1, v2, ..., vN`及其对应的类型`V1, V2, ..., VN` **取决于`TiD`从调用派生`bind`**的类型和调用包装器的*cv* -qualifiers *cv*`g` ，如下所示：
> 
> *   如果`TiD`是`reference_wrapper<T>`，参数是`tid.get()`，它的类型`Vi`是`T&`；
> *   如果 的值为 ，`is_bind_expression<TiD>::value`则`true`参数为`tid(std::forward<Uj>(uj)...)`，其类型`Vi`为`result_of<TiD cv (Uj...)>::type`；
> *   如果 的值`j`不`is_placeholder<TiD>::value`为零，则参数为`std::forward<Uj>(uj)`且其类型`Vi`为`Uj&&`；
> *   否则，值为`tid`，其类型`Vi`为`TiD cv &`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-23T09:00:39.213

调用函数模板生成的转发调用包装器`bind`可以接受任意数量的额外参数；这些将被忽略。`bind`表达式的有效数量和最小签名`placeholder`由其构造中使用的 s 以及它们绑定到的可调用参数确定。

# javascript - func_two 不会在 javascript 中触发

> ID：16164771
> 
> 赞同：0
> 
> 时间：2013-04-23T08:42:23.330
> 
> 标签：javascript

我[这里](http://jsfiddle.net/veZ5U/)有 javascript 脚本代码。当我按原样执行代码时，它不会触发`func_two`功能。但是当我更改以下代码时`func_one`

```
 if (this.remove) {
        this.func_two;
    } 
```

对此

```
 if (this.remove) {
        this.func_two();
    } 
```

然后它确实触发了第二个功能。但我想以这种方式触发它`this.func_one`。有可能这样做吗？如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:46:44.117

当你调用一个函数时，你必须说`()`，你不能凭空决定你想让它以另一种方式工作。

看看[这个](https://stackoverflow.com/a/3246956/2182203)答案，它可能会对你有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:58:31.210

`this.func_two;`

该语句返回函数。它不调用该函数。

要调用该函数，您必须`()`在最后添加。

或者你必须这样做：

`f2=this.func_two;`
`f2();`

# c# - Why doesn't String.CompareTo account for string length?

> ID：16164778
> 
> 赞同：1
> 
> 时间：2013-04-23T08:42:44.363
> 
> 标签：c#, string, compareto

Given a ordered list:

```
var lst = new []{"1","10","2","b","ab"};
var lst2 = lst.OrderBy(c => c); 
```

Result of `lst2`:

> 1, 10, 2, ab, b

Why does `String.Compare()` not also measure on the length of the string when it compares? I would have thought that the result would be more like this:

> 1, 2, 10, b, ab

Because 10 (something(1) and somthing(0)) should be *after* 2 (something(2) and nothing)

Could anybody give a good reason for this?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-23T08:47:44.500

如果全世界都使用你的排序算法，电话簿会是什么样子？

*   安娜
*   贝尔塔
*   安娜玛丽
*   比阿特丽克斯

字符串比较基于首先比较第一个字母（最好是：字符），如果它们相等，则第二个字符等。它不是基于单词的长度。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-23T08:47:54.847

字符串是一组字符。
比较字符串时，基本上是集合比较，即比较两个字符串的第一个字符。只有当它们相同时，才会比较下一个字符等。

当通过第一个字符正确对齐无序字符串列表时，这变得很明显：

```
"1"
"10"
"2"
"b"
"ab" 
```

下单后，结果如下：

```
"1"
"10"
"2"
"ab"
"b" 
```

原因：

*   `"2"`之后会出现`"1"`，因为`'2'`> `'1'`。
*   `"2"`将出现在 之后`"10"`，因为再次`'2'`> `'1'`。不考虑 `'0'`in ，因为第一个字符的比较已经产生了明确的结果。`"10"`
*   `"ab"`会来`"2"`的，因为`'a'`>`'2'`
*   `"b"`之后会出现`"ab"`，因为`'b'`> `'a'`。不考虑`'b'`in ，因为第一个字符的比较已经产生了明确的结果。`"ab"`

如果您想让字符串中的数字按您想要的方式排序，您可能需要查看["Natural Sort"](http://www.codinghorror.com/blog/2007/12/sorting-for-humans-natural-sort-order.html)。
字符串的顺序没有意义，因此您可能必须自己构建它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:48:11.073

为什么会`10`在之后`2`？

如果您使用以下单词的*字母顺序*对单词进行排序：`x y xy`，则结果为`x xy y`。

对于数字，它与扩展的字符集完全相同。

# java - 出站星号呼叫的前导零

> ID：16164782
> 
> 赞同：2
> 
> 时间：2013-04-23T08:42:55.410
> 
> 标签：java, voip, asterisk, outbound

大家好，我是星号的新手，所以不太了解。我目前正纠结于一个进行出站呼叫的应用程序。以前由于某些配置问题，它无法正常工作，然后 ANI 显示 NULL 值。但现在它工作正常，因为我使用了 java 的 setCallerID 函数。

问题是成功地为用户生成了一个出站呼叫，例如 123，但前导零“0”附加到它并变为“0123”，我假设“0”是附加星号的国家号码根据星号中的定义，我需要的数字是'123'，我想从java代码中改变它。

我搜索了很多论坛/站点，包括[voip-info](http://www.voip-info.org/)的领先站点，但还没有成功。如果可能的话，我想通过java代码解决它。任何帮助将不胜感激。

更新：

### 笔记：

星号版本是 1.8 ，链 ss7 是 2.1

### extensions.conf

```
[gu]
exten =>007775,1,Answer(); this will answer the call
exten =>007775,2,Wait(1); will wait for 1 second
exten =>007775,3,NoOp(Call from ${CALLERID(all)})
exten =>007775,4,AGI(agi://localhost:4573/com.digitania.ivr.gu.domain.ServiceImplDelegate?uniqueId=${UNIQUEID}&isOutbound=${isOutbound}&msisdn=${MSISDN})
exten =>007775,5,Hangup(); end the call 
```

### 我的java代码

```
private static final String PARAM_MSISDN = "MSISDN";
private static final String PARAM_ISOUTBOUND = "isOutbound";
private static final String EXTENSION = "007775";
private static final String CALLER_ID = "7775";
public static int callCount = 0;
public void call(String msisdn, CallListener listener) {
    try {

        {

            OriginateAction originateAction = new OriginateAction();

            originateAction.setChannel((new StringBuilder("SS7/").append(msisdn).toString())); 

            originateAction.setContext("gu");
            originateAction.setPriority(new Integer(1));
            originateAction.setExten(EXTENSION);
            originateAction.setCallerId(CALLER_ID);
            originateAction.setVariable(PARAM_MSISDN, msisdn);
            originateAction.setVariable(PARAM_ISOUTBOUND, "true");
            ManagerResponse originateResponse = managerConnection
                    .sendAction(originateAction, 30000L);
            System.out.println((new StringBuilder("RESPONSE: \n")).append(
                    originateResponse.getResponse()).toString());
            System.out.println(originateResponse.getMessage());

        }
    } catch (TimeoutException e) {
        listener.callTimeOutException();
    } catch (Exception e) {
        e.printStackTrace();
    }
    callCount++;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-22T20:49:25.513

我使用 libss7 已经有一段时间了，但是您是否尝试过在 chan_dahdi.conf 中查看这些选项？

*   ss7_call_nai
*   ss7_calling_nai
*   ss7_international前缀
*   ss7_national前缀
*   ss7_subscriberprefix
*   ss7_unknownprefix
*   网络指标

与他们一起玩（并与您的提供商交谈）应该可以让您发送正确的号码。

希望能帮助到你。

# python - Django Flatpages url 加载相同的模板

> ID：16164784
> 
> 赞同：0
> 
> 时间：2013-04-23T08:43:03.837
> 
> 标签：python, django

我已经基于[http://linfiniti.com/2011/01/bending-django-flatpages-to-your-will/扩展了 FlatPages 应用程序](http://linfiniti.com/2011/01/bending-django-flatpages-to-your-will/)

我正在尝试为 flatpages 实现包罗万象的 url 模式。

这是主应用程序下 url.py 上的模式

```
urlpatterns = patterns('',
    (r'^admin/doc/', include('django.contrib.admindocs.urls')),
    (r'^admin/', include(admin.site.urls)),
    (r'^.*/$', include('app.modules.cms.urls')),
) 
```

这个模式在扩展的平面模块上

```
urlpatterns = patterns('app.modules.cms.views',
    (r'^(?P<url>.*)$', 'flatpage'),
) 
```

当我尝试查看通过管理员创建的不同页面时。它们都显示相同的模板。在使用 django 工具栏进行检查时，我注意到 url 没有被传递给 flatpages 视图函数，

```
View Function                   args    kwargs
app.modules.cms.views.flatpage  None    url= 
```

我是否使用了错误的正则表达式模式，或者我需要更多的东西才能使其工作。

/谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T09:26:20.103

[Django 文档](https://docs.djangoproject.com/en/dev/ref/contrib/flatpages/)似乎建议这样做......

```
urlpatterns = patterns('',
    (r'^admin/doc/', include('django.contrib.admindocs.urls')),
    (r'^admin/', include(admin.site.urls)),
    (r'^(?P<url>.*)$', 'app.modules.cms.views.flatpage'),
) 
```

......虽然它可能会这样工作......

```
urlpatterns = patterns('',
    (r'^admin/doc/', include('django.contrib.admindocs.urls')),
    (r'^admin/', include(admin.site.urls)),
    (r'^/', include('app.modules.cms.urls')),
) 
```

# maven - 如何在 maven pmd 插件中包含捆绑的规则集

> ID：16164786
> 
> 赞同：1
> 
> 时间：2013-04-23T08:43:06.860
> 
> 标签：maven, pmd

我有一个自定义规则集定义，它引用捆绑规则集中的一堆规则。但是，我在解决 maven pmd 插件中的这些捆绑规则集时遇到了问题。[这](https://stackoverflow.com/questions/8389612/maven-pmd-plugin-uses-only-the-bundled-rulesets)是一个相关的问题，该问题有一个快速的'n'dirty 解决方案。但是，我想知道这个问题是否有一个干净的解决方案（因为我认为这是一个相当常见的用例，或者？）。在下文中，我将描述迄今为止我尝试过的尝试：

```
<build>
    <pluginManagement>
        <plugins>

...
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-pmd-plugin</artifactId>
                <version>${maven-pmd-plugin.version}</version>
                <configuration>
                    <linkXref>true</linkXref>
                    <rulesets>
                        <ruleset>my_pmd_ruleset.xml</ruleset>
                    </rulesets>
                    <failsOnError>false</failsOnError>
                    <source>${java.source.version}</source>
                    <target>${java.source.version}</target>
                </configuration>
            </plugin>
        </plugins>
    </pluginManagement>
</build> 
```

1.  我在父 pom 的构建/插件管理部分以及报告部分中使用我的自定义规则集（和 Java 1.6）定义了 maven pmd 插件（版本 3.0.1）。我收到以下许多警告：

    ```
     [WARNING] Failure executing PMD: Unable to find referenced rule UnusedModifier; 
     perhaps the rule name is mispelled? 
    ```

2.  我试图参考所有使用的捆绑规则集：

    ```
    <build>
    <pluginManagement>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-pmd-plugin</artifactId>
                <version>${maven-pmd-plugin.version}</version>
                <configuration>
                    <linkXref>true</linkXref>
                    <rulesets>
                        <ruleset>rulesets/java/coupling.xml</ruleset>
                        <ruleset>rulesets/java/design.xml</ruleset>
                        <ruleset>rulesets/java/controversial.xml</ruleset>
                        <ruleset>rulesets/java/codesize.xml</ruleset>
                        <ruleset>rulesets/java/clone.xml</ruleset>
                        <ruleset>rulesets/java/braces.xml</ruleset>
                        <ruleset>rulesets/java/basic.xml</ruleset>
                        <ruleset>rulesets/java/finalizers.xml</ruleset>
                        <ruleset>rulesets/java/imports.xml</ruleset>
                        <ruleset>rulesets/java/unit.xml</ruleset>
                        <ruleset>rulesets/java/logging-jakarta-commons.xml</ruleset>
                        <ruleset>rulesets/java/logging-java.xml</ruleset>
                        <ruleset>rulesets/java/migrating.xml</ruleset>
                        <ruleset>rulesets/java/naming.xml</ruleset>
                        <ruleset>rulesets/java/optimizations.xml</ruleset>
                        <ruleset>rulesets/java/strictexception.xml</ruleset>
                        <ruleset>rulesets/java/strings.xml</ruleset>
                        <ruleset>rulesets/java/sunsecure.xml</ruleset>
                        <ruleset>rulesets/java/typeresolution.xml</ruleset>
                        <ruleset>rulesets/java/unusedcode.xml</ruleset>
                        <ruleset>my_pmd_ruleset.xml</ruleset>
                    </rulesets>
                    <failsOnError>false</failsOnError>
                    <source>${java.source.version}</source>
                    <target>${java.source.version}</target>
                </configuration>
            </plugin>
        </plugins>
    </pluginManagement>
    </build> 
    ```

我总是收到以下错误：

```
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-pmd-plugin:3.0.1:pmd (pmd) on project my_project: An error has occurred in PMD Report report generation. Could not find resource 'rulesets/java/unit.xml' 
```

maven pmd 插件依赖于 pmd，所以捆绑的规则集应该是类路径的一部分，或者？[Maven pmd 插件手册](http://maven.apache.org/plugins/maven-pmd-plugin/examples/usingRuleSets.html)说捆绑的规则集应该用相对路径定义，而自定义规则集应该用绝对路径定义。但是，我认为它也可以通过相对路径读取我的自定义规则集，因为它是类路径的一部分。我还尝试了其他事情，例如，在 maven pmd 插件中显式附加依赖项定义 pmd。但是，到目前为止没有任何成功：\

# jquery - can you use backbone listenTo with jquery objects?

> ID：16164796
> 
> 赞同：19
> 
> 时间：2013-04-23T08:43:37.053
> 
> 标签：jquery, events, backbone.js

Such as those returned by `$("#mystuff")` etc?

For example, can:

```
$('#div').on(event, callback) 
```

be re-written as:

```
view.listenTo($('#div'), event, callback) 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-23T08:43:37.053

不，事实证明你不能。

> 你已经有了 jQuery。

根据[tgriesser](https://github.com/documentcloud/backbone/issues/1935)

> 抱歉，`listenTo`仅适用于`Backbone.Events`混入的对象，因此它适用于`Backbone.View`、`Backbone.Collection`或`Backbone.Model`，但不适用于 jQuery 对象。

当。

[有些人](http://ricostacruz.com/backbone-patterns/#event_handlers_outside_views)还建议创建主干视图而不是使用 jquery 事件。

# jquery - jQuery hide by clicking outside of div

> ID：16164799
> 
> 赞同：3
> 
> 时间：2013-04-23T08:43:41.987
> 
> 标签：jquery, html, css

Hello,

I'm trying to make a JavaScript dynamic display of an image.

Here’s my code:

```
<div class="info_image_click" style="display: none;">
    <img src="slike/info_slika_click.jpg" />
</div><!--kraj info_image_click-->

<a href="javascript:void(null);">
    <div class="info_image" style="margin: 0px auto;">
        <img src="slike/info_slika.jpg"/>
    </div>
</a><!-- info slika -->

<script>
    $('.info_image').click(function () {
        $('.info_image_click').show();
    });
</script> 
```

When someone clicks on "info_image" (that's the small picture) it opens the "info_image_click" (that's the large picture). I don't know how users can hide the "info_image_click" by clicking outside container in which he is. Sorry about my english :)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T08:47:56.690

尝试这个：

```
$('.info_image').click(function (e) {

    // Used to stop the event bubbling..
    e.stopPropagation()
    $('.info_image_click').show();
});

// Hide the "info_image_click" by clicking outside container
$(document).click(function () {
    $('.info_image_click').hide();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:45:56.920

尝试使用

```
$(document).not('. info_image_click').click(function() {
    // Do your hiding stuff here.
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T08:46:42.613

添加正文点击：

```
<script>
 $('.info_image').click(function () {
            $('.info_image_click').show();
            $("body").click(function () {
                $("info_image_click').hide();
            });
        });
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T08:48:17.357

如果可能尝试改变你的`DOM`，那么没有必要`jQuery`也

```
<a href="your large image"><img src="your small image"></a> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T08:54:08.473

如果您要做的是让您的图像成为模态图像（即，在图像被隐藏之前，下面的页面处于非活动状态），您可以创建一个相同大小的不可见叠加层（不透明度非常小，通常为 0.01）您的页面，并覆盖它，并且在您的页面（通常为 0）和“模态”区域（即在这种情况下为 info_image_click 图像）之间有一个 z-index（“垂直”位置） )，它可以是任何大于 0 的值。

然后设置覆盖单击事件，以便在单击覆盖时隐藏图像和覆盖。

通过这样做，您可以确保当用户单击窗口时，如果它在图像内部，则不会发生任何事情（因为图像具有更高的 z-index 它将获得未分配的点击事件），如果它在外部图像，叠加层（而不是页面，因为它的 z-index 较低）将获得点击事件并执行您想要的操作（隐藏图像和叠加层，从而返回主页）。

如果您想让用户知道图像是模态的，您可以将叠加层设置为高于 0.01 的不透明度。

我将如何在 jQuery 中执行此操作的快速草稿：

```
showWindowModal: function(windowSelector) {
    $("<div></div>")
        .addClass("overlay")
        .appendTo($("#main"))
        .css({
            width: $("#main").outerWidth(),
            height: $("#main").outerheight()
        })
        .click(function() {
            $(windowSelector).remove();
            $("#main > div.overlay").remove();
        });
    $(windowSelector).addClass("modal").show();
} 
```

CSS类：

```
#main > div.overlay
{
    position: absolute;
    background: white;
    z-index: 100;
    opacity: 0.5;
    filter:alpha(opacity=50); /* For IE8 and earlier */
}

.modal
{
    z-index: 1000;
} 
```

# android - 如何在两个图像之间滑动和切换？

> ID：16164801
> 
> 赞同：1
> 
> 时间：2013-04-23T08:43:53.693
> 
> 标签：android, image, swipe

在顶部，我有本地车牌图像，里面有编辑文本。

我需要向左或向右滑动并将本地车牌图像切换到全局车牌（新）图像以输入较少的限制值。

以下所有其他信息应保持不变。

请推荐我如何在Android中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T09:49:34.610

您可以使用gestureoverlayview来处理触摸和滑动检测请参考这个网站

[http://developer.android.com/reference/android/gesture/GestureOverlayView.html](http://developer.android.com/reference/android/gesture/GestureOverlayView.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T09:02:40.867

使用[ViewSwitcher](http://samplecodez.com/android/viewswitcher.php)

```
<RelativeLayout
android:background="#0000FF"
android:layout_width="fill_parent"
android:layout_height="fill_parent"  >

<ImageView 
        android:id="@+id/img1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:src="@drawable/smile" />

<TextView
    android:text="Loading..."
    android:layout_height="wrap_content"
    android:layout_width="wrap_content"
    android:textSize="20dp"
    android:textColor="#FFFFFF"
    android:layout_centerHorizontal="true"
    android:layout_below="@+id/progressbar" />

</RelativeLayout>

<RelativeLayout
android:background="#FFFF00"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<TextView
        android:text="Finished!"
        android:layout_height="wrap_content"
        android:layout_width="wrap_content"
        android:textSize="20dp"
        android:textColor="#000000"
        android:layout_marginTop="10dp"
        android:layout_centerHorizontal="true" />

<ImageView 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/img1"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="50dp"
        android:src="@drawable/smile" />

</RelativeLayout> 
```

# c# - 视图模型的属性未在 HttpPost 上设置

> ID：16164802
> 
> 赞同：1
> 
> 时间：2013-04-23T08:43:54.370
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, razor, asp.net-mvc-viewmodel

我的视图模型代码：

```
public class Step2ViewModel : MultiStepBaseViewModel
{
    public IList<LayoutDetail> LayoutConfig { get; set; }
} 
```

我的查看代码：

```
@model eliteemail.Web.Mvc.Areas.Emails.ViewModels.Step2ViewModel
@{
    ViewBag.Title = "Layout";
    Layout = "~/Views/Shared/_HomeLayout.cshtml";
}

@using (Html.BeginForm())
{

    @Html.ValidationSummary(true)

    for (int i = 0; i < @Model.LayoutConfig.Count(); i++)
    {
    <div class="grid_3 tcenter">
        <div class="divhighlight">
            <div style="width: 165px; margin: 6px auto 4px auto;" class="f16 bold tcenter" id="helptrigger1">@Model.LayoutConfig[i].LayoutTitle</div>
            <a class="fancybox" rel="layouts" href="@Model.LayoutConfig[i].LayoutImgPrev" title="1 Column">
                <img src="@Model.LayoutConfig[i].LayoutImg" alt="1 Column" width="189" height="227" vspace="5" />
            </a>
            <div style="width:189px; margin:auto">
                <input type="submit" class="button gobutton" style="margin-right: 40px; width: 165px;" value="Select" name="@Model.LayoutConfig[i].LayoutID,@Model.LayoutConfig[i].LayoutTitle"/>
            </div>
        </div>
    </div>
    } 
} 
```

我的控制器代码：

```
public ActionResult Step2()
{
    Step2BusinessLogic step2BusinessLogic = new Step2BusinessLogic();
    Step2ViewModel step2ViewModel = step2BusinessLogic.CreateStep2ViewModel();
    return View(step2ViewModel);
}

[HttpPost]
public ActionResult Step2(Step2ViewModel step2ViewModel)
{
    ....
} 
```

我的业务逻辑类代码：

```
public class Step2BusinessLogic
{
    public Step2ViewModel CreateStep2ViewModel(string Id)
    {
        Step2ViewModel step2ViewModel = new Step2ViewModel();
        step2ViewModel.MultiStepId = new Guid(Id);
        step2ViewModel.LayoutConfig = GetLayout();
        return createEmailStep2ViewModel;
    }

    public List<LayoutDetail> GetLayout()
    {
        List<LayoutDetail> layoutList = new List<LayoutDetail>();

        LayoutDetail layout1 = new LayoutDetail();
        layout1.LayoutID = 1;
        layout1.LayoutTitle = "1 Column";
        layout1.LayoutImg = "~/img/create/layout/layout-1.png";
        layout1.LayoutImgPrev = "img/create/layout/layout-1-preview.png";
        layoutList.Add(layout1);

        LayoutDetail layout2 = new LayoutDetail();
        layout2.LayoutID = 2;
        layout2.LayoutTitle = "1:2 Column";
        layout2.LayoutImg = "~/img/create/layout/layout-2.png";
        layout2.LayoutImgPrev = "img/create/layout/layout-2-preview.png";
        layoutList.Add(layout2);

        .........(12 Items)

        return layoutList;
    }
}

public class LayoutDetail
{
    public int LayoutID { get; set; }

    public string LayoutTitle { get; set; }

    public string LayoutImg { get; set; }

    public string LayoutImgPrev { get; set; }
} 
```

问题是当我从 提交时`Step2View.cshtml`，然后

```
public ActionResult Step2(Step2ViewModel step2ViewModel) 
```

正在调用但未设置的属性`step2ViewModel`并`ModelState.IsValid`返回 false。我想避免这两种情况。请提供任何帮助，因为我对 MVC 很陌生。

我搜索了几个链接，但无法理解场景。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:53:26.963

问题是您在发帖时没有提交任何内容。除了按钮之外，您没有任何表单元素。如果您有表单元素，那么数据将被传回。尝试 `@Html.HiddenFor(o=>o.LayoutID)`在您的视图中添加一个，然后再次发布。表单将回发隐藏元素或表单字段，但不会像您那样只显示字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:52:42.103

不要`foreach`在集合对象上使用循环，因为模型绑定器无法使用它。改用 a `for-loop`。在您的代码中，将每次出现的替换为`@item`，`@Model.LayoutConfig[i]`请参阅下面的更新代码：

```
for(var i=0;i<@Model.LayoutConfig.Count();i++)
{
    <div class="grid_3 tcenter">
        <div class="divhighlight">
            <div style="width: 165px; margin: 6px auto 4px auto;" class="f16 bold tcenter" id="helptrigger1">@Model.LayoutConfig[i].LayoutTitle</div>
            <a class="fancybox" rel="layouts" href="@Model.LayoutConfig[i].LayoutImgPrev" title="1 Column">
                <img src=@Model.LayoutConfig[i].LayoutImg" alt="1 Column" width="189" height="227" vspace="5" />
            </a>
            <div style="width:189px; margin:auto">
                <input type="submit" class="button gobutton" style="margin-right: 40px; width: 165px;" value="Select" name="@Model.LayoutConfig[i].LayoutID, @Model.LayoutConfig[i].LayoutTitle"/>
            </div>
        </div>
    </div>
} 
```

# javascript - CSS中的最小/最大绝对位置

> ID：16164803
> 
> 赞同：17
> 
> 时间：2013-04-23T08:44:00.757
> 
> 标签：javascript, jquery, css, html

限制绝对定位元素位置的最佳方法是什么，最好是在纯 CSS 中？

我知道以下是不可能的，但我想我正在寻找的东西看起来像：

```
.stickyElement{
   bottom-max:auto;      
   bottom-min:0px;
   top-max: auto;
   top-min: 100px;
 } 
```

这将允许一个元素移动到距离其包含的定位元素的顶部不小于 100px 的位置。

一个示例（也是我最初的）用例是一个菜单，它作为页面的一部分滚动，但在到达视口顶部时停止滚动。（粘性菜单？）可以在此页面上看到一个示例：http: [//spektrummedia.com/startups](http://spektrummedia.com/startups)

我完全希望如果不使用一些 Javascript，这是不可能的，但我想我会把它放在那里。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-23T15:34:21.030

## 位置：粘性

近年来，W3C一直在[讨论](http://www.google.com/#q=site:w3.org+position+sticky)这个问题。一种建议是增加财产的`sticky`价值。`position`

```
.content {
    position: -webkit-sticky;
    position:    -moz-sticky;
    position:     -ms-sticky;
    position:      -o-sticky;
    position:         sticky;
    top: 10px;
} 
```

Chrome 23.0.1247.0 及更高版本目前支持此功能，作为实验性功能。要启用它，`about:flags`请输入 URL 地址并按 Enter。然后搜索“experimental WebKit features”并在启用和禁用之间切换。

在[html5rocks](http://updates.html5rocks.com/2012/08/Stick-your-landings-position-sticky-lands-in-WebKit)网站上，有一个工作[演示](http://html5-demos.appspot.com/static/css/sticky.html)。

严格来说，这是一种粘性内容的实现，而不是限制一个元素相对于另一个元素的最小或最大位置的通用方式。但是，粘性内容可能是您所描述的行为类型的唯一实际应用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-24T07:56:35.317

由于不使用 JavaScript 就无法为所有主要浏览器构建它，因此我使用 jQuery 制作了自己的解决方案：

分配`position:relative`给您**的置顶菜单**。当它通过滚动到达浏览器窗口的顶部时，位置将**变为**`positon:fixed`。

还要提供您**的置顶菜单** `top:0`，以确保它贴在浏览器窗口的顶部。

在这里您可以找到一个有效的[JSFiddle 示例](http://jsfiddle.net/muffls/mhxQ8/3/)。

* * *

**HTML**

```
<header>I'm the Header</header>
<div class="sticky-top-menu">
  <nav>
    <a href="#">Page 1</a>
    <a href="#">Page 2</a>
  </nav>
</div>
<div class="content">
  <p>Some content...</p>
</div> 
```

**jQuery**

```
$(window).scroll(function () {
    var headerTop = $("header").offset().top + $("header").outerHeight();

    if ($(window).scrollTop() > headerTop) {
        //when the header reaches the top of the window change position to fixed
        $(".sticky-top-menu").css("position", "fixed");
    } else {
        //put position back to relative
        $(".sticky-top-menu").css("position", "relative");
    }
}); 
```

**CSS**

```
.sticky-top-menu {
    position:relative;
    top: 0px;
    width: 100%;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-15T21:23:12.330

定义正文 0X 0Y 和浏览器窗口 0X 0Y 之间距离的媒体查询表达式将允许元素在页面滚动后变得粘滞

据我所知，没有提出过这样的表达式，并且任何浏览器都不支持，但它是一个有用的表达式，可以动态配置粘性元素，例如在页面滚动到头部后粘性的菜单栏，而不使用JavaScript 的。

```
.this element {
  position: absolute;
  top: 200px;
}

@media (max-scroll: 200px 0) {
  .this.element {
    position:fixed;
    top: 0;
  }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T14:09:16.960

据我所知，没有办法限制使用绝对定位仅使用 CSS 定位的元素。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-04T20:52:00.497

我知道这篇文章很旧，我可能有点晚了，但是对于仍然想知道如何做到这一点的人，我建议检查`clamp()`CSS 中的方法，你可以这样做：

`top: clamp(30px, 10vw, 50px);`

这会将最小值设置为 30px，理想值设置为 10vw，最大值设置为 50px。

# sql - 用另一个表中的值替换表列中的值

> ID：16164804
> 
> 赞同：3
> 
> 时间：2013-04-23T08:44:05.567
> 
> 标签：sql, jet

我需要使用 SQL 通过 Microsoft JET DB 引擎将一些表迁移到 Microsoft Access 数据库中的新模式。实际上，主表中有一个 ID 列用作其他几个表中的外键。我需要将此 ID 列更改为自动编号列。不幸的是，没有办法通过 Microsoft JET 做到这一点。

我想出的解决方案是创建一个新列，它是一个自动编号列。然后，我需要去其他表，用新的自动编号 ID 替换原来的外键 ID，像这样；

主表

```
New ID   Old ID   Other column
1        7        bla
2        21       bla
3        18       bla 
```

链接表

```
PT_ID  Data
7      bla
7      bla
18     bla
21     bla 
```

用新 ID 替换链接表中的值的正确 SQL 语句是什么？（即 7 变为 1，21 变为 2，18 变为 3）如果这是 Microsoft JET 语法，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T09:01:44.267

我设法弄清楚了。这就是我想出的

```
UPDATE [LinkedTable], [PrimaryTable]
SET [LinkedTable].[PT_ID] = [PrimaryTable].[NewID]
WHERE [LinkedTable].PT_ID] = [PrimaryTable].[OldID] 
```

当你看到它在你喜欢之前布置的时候看起来真的很基本：-/

# c++ - Which Qt to download?

> ID：16164805
> 
> 赞同：11
> 
> 时间：2013-04-23T08:44:07.163
> 
> 标签：c++, qt, opencv

I am new to C++ and have been working with MS VISUAL STUDIO 2010 Express. However, I am in need to shift to Qt as my university recommends. Unfortunately, the qt.nokia.com is redirecting to another site [http://qt.digia.com/](http://qt.digia.com/).

Since everything in that site is not free, I found the following link called "[Qt Open Source Version](http://qt-project.org/downloads)". Is this is the site to download Qt?

When I go there, I can see various options, which means number of downloads. I have windows 7 ultimate and got visual studio 2010 express installed in my machine. But, this site got number of windows downloads. I prefer the one which claims to come with the Qt IDE (Qt Creator??). If you need further more information, I will be using this Qt GUI C++ applications with OpenCV.

I have already installed OpenCV and it works with VS so if you can, please tell me how to set it up with Qt as well.

Please help me to download the correct version of Qt. Thanks

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T08:54:57.673

回答这类问题总是既困难又危险！

我知道你有过 VS 的经验，但我会建议你选择 MinGW。

![在此处输入图像描述](https://i.stack.imgur.com/aapoO.png)

[下载链接](http://qt-project.org/downloads)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:50:33.693

qt-project 是获取开源 Qt 的正确位置。

有用于 VS2012 的 Qt 5.0 的预构建二进制文件，但如果您想将 Qt 4.8 与 VS2012 一起使用，您需要自己编译它，因为 VS2012 没有预构建的二进制文件（还没有？）。编译 Qt 并不难，只需打开 VS2012 的命令提示符，运行`configure --help`即可了解如何自定义 Qt 构建。然后`configure`使用适当的参数运行，然后`nmake`.

如果您决定使用 Qt Creator 作为 IDE，欢迎您这样做 - Qt Creator 可以使用不同的编译器编译项目，包括 VS2012 编译器。但是为了调试使用 VS2012 编译器编译的项目，您需要使用 VS2012 或安装[Windows 调试工具](http://msdn.microsoft.com/en-us/windows/hardware/gg463009)（Qt Creator 将找到并使用它来调试 VS2012 生成的可执行文件）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:53:23.163

[http://qt-project.org/downloads](http://qt-project.org/downloads)

**Qt 5.0**

根据您的操作系统从下面的列表中选择文件，以获得适用于您计算机的最新 Qt 5.0。二进制包包括*Qt 5.0.2 库*和*Qt Creator 2.7.0*

适用于 Windows 32 位的 Qt 5.0.2（VS 2010，485 MB）

# jquery - jQuery 显示/隐藏关闭其他元素

> ID：16164806
> 
> 赞同：0
> 
> 时间：2013-04-23T08:44:08.460
> 
> 标签：jquery, toggle

我有一个 jQuery 项目，它需要使用带有切换的显示/隐藏功能。我在页面上有多个元素在单击链接时隐藏并显示，但我希望显示的每个元素都关闭任何其他元素。

我尝试使用：

```
 jQuery(".toggle").click(function()
  { 
    $('.active').not(this).toggleClass('active').next('.hidden').slideToggle(300);
    $(this).toggleClass('active').next().slideToggle("fast");   
  }); 
```

这种方法的问题是所有元素都需要放在一起才能使用“.next”，我的元素位于页面的不同部分。无论如何我可以确保如果用户单击链接以显示一个元素，则另一个先前打开的元素被关闭？

非常感谢

# continuous-integration - TFS 2012：从 2010 升级后从不开始构建连续/滚动

> ID：16164814
> 
> 赞同：0
> 
> 时间：2013-04-23T08:44:20.947
> 
> 标签：continuous-integration, tfsbuild

有了在 TFS 2010 上运行良好的构建定义，并且在对 2012 年进行了一些模板编辑之后，我现在有了构建定义，在 2012 年使用我的构建控制器设置（也从 2010 年升级到 2012 年）运行良好——但只有在手动启动时。

当我将它们设置为连续或滚动时（它们是这样设置的，但我将其更改为并返回只是为了查看该更新是否改变了任何内容），即使相关文件夹（活动文件夹）中有很多签入，也没有任何反应。定义也被启用，而不是设置为暂停或禁用。

他们为什么不启动，如何让他们再次自动工作？

更新：

构建控制器上没有任何内容。队列为空。此外，我刚刚使用默认模板创建了一个虚拟的构建定义（只是为了确保它不是自定义模板），在这里签入活动文件夹时也没有任何反应（活动意味着我在构建定义工作区）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T09:08:15.413

构建是否正在排队？如果是这样，请检查选择执行构建的用户的权限，也许有一个权限阻止它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T12:08:01.707

回到管理员那里后，他们似乎在 TFS 服务器上安装了一些破坏事件机制的工具。工具已移除，问题已修复，现在他们将不得不搜索不会破坏构建事件的工具（邮件通知）。

谢谢！

# sql - 插入到其他服务器上的数据库时的实体框架性能问题

> ID：16164819
> 
> 赞同：0
> 
> 时间：2013-04-23T08:44:36.277
> 
> 标签：sql, performance, entity-framework, entity-framework-5

我们已经完成了使用 Entity Framework 5 的应用程序，并对特定表执行大约 1000 次插入/秒。

现在客户端已请求应用程序与数据库不在同一台服务器上。当我们在这种情况下部署应用程序时，插入记录所需的时间增加了 4 倍。

我们已经完成了性能日志，并将性能损失缩小到执行插入。

使用“在线”实体框架处理远程数据库和处理大量数据（100.000+ 行）是否存在已知问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T09:42:01.013

在加载大量记录时，我发现 EF 存在两个性能问题。

1) 插入是逐记录执行的（在打开 SQL 探查器的情况下调用 db.SaveChanges() 时可以看到这一点。

2) 即使在 SaveChanges() 之前，DbSet.Add() 调用也会随着记录的进行而变得越来越慢。关闭更改跟踪会有所帮助，但作用不大。

我使用 SqlBulkCopy 进行大容量插入。SqlBulkCopy 为所有记录发出一次插入。对于第二个问题，我使用简单的集合来整理数据，而不是添加到 DbSets。

SqlBulkCopy 需要一些额外的任务 - 需要知道表架构，所以我将其从 EF 元数据中提取出来。验证有点弱（不存在），因此您需要针对缓冲区集合实现它。

**评论后的补充：**

当然，我知道您想知道为什么 EF + Network = 慢。

以上就是说我们的经验是EF+10万条记录=慢，不管部署拓扑如何。所以，我的猜测是您看到的性能差异与 EF 无关

这可能是由于 SQL Server 上启用的协议（通过 Sql Server 配置管理器） - 如果您在服务器上启用了**共享内存**，您可能希望与数据库位于同一服务器上的应用程序运行速度比单独运行的快服务器，因为第二种情况必须通过 TCP/IP 进行通信。

您可以尝试禁用共享内存并查看它对同一服务器性能的影响。

我们似乎从未有过这种影响，我很想看到这个问题的最终解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T09:42:18.813

您是否看过这个[问题](https://stackoverflow.com/questions/12751258/batch-update-delete-ef5)，特别是 Ladislav Mrnka 的回答？

# html - Two background patterns for a wrapper div

> ID：16164823
> 
> 赞同：0
> 
> 时间：2013-04-23T08:44:58.730
> 
> 标签：html, css

I wanted to know is it possible to have two background patterns for a wrapper div. For example -

```
<div id="wrapper">
Hello
</div>

#wrapper {
  background:url(../images/pattren.png) repeat-x; 
} 
```

Is it possible to have this `pattern.png` repeat only till 50% of the div and have another pattren like `pattren_flipped.png` for another 50%? Is it possible to do it without having another two divs inside?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T09:03:10.717

你可以这样做：

HTML：

```
<div id="wrapper">
    <div class="inner">
        Hello
    </div>
</div> 
```

CSS：

```
#wrapper { height: 800px; position: relative; width: 500px; z-index: 2; }
.inner { position: relative; z-index: 2; }

#wrapper:before {
    background:url("http://css-tricks.com/images/Treehouse_600x500_02.jpg") repeat-x;
    content: "";
    position: absolute;
    top: 0;
    right: 50%;
    bottom: 0;
    left: 0;
}
#wrapper:after{
    background:url("http://css-tricks.com/images/ads/wufoo-600x600-red.png") repeat-x;
    content: "";
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 50%;
} 
```

[小提琴](http://jsfiddle.net/79rAA/)

理想情况下，内部 div 不是必需的，它可能不是，但如果没有它，我无法在背景图像上方的包装器内获取文本

编辑：内部 div 根本没有必要，看看 dfsq 的回答（不敢相信我没想到！）

不幸的是，这仅适用于[IE8+](http://caniuse.com/#feat=css-gencontent)，因此如果您需要与旧版本的 IE 兼容，您可能会遇到一些问题，除了上述之外，我认为没有另一种（大部分）跨浏览器方式可以做到这一点

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T08:58:38.820

如果重复，您不能强制图案仅填充 50% 的宽度或高度。但也许您可以使用伪选择器`before`来模拟这种行为：`after`

```
#wrapper:before, #wrapper:after {
    position: absolute;
    top: 0;
    width: 50%;
    height: 100%;
    content: '';
    z-index: -1;
}
#wrapper:before {
    left: 0;
    background: url(pattern1.png) repeat-x 0 0;
}
#wrapper:after {
    right: 0;
    background: url(pattern2.png) repeat-x 0 0;
} 
```

[http://jsfiddle.net/dfsq/PwSD4/](http://jsfiddle.net/dfsq/PwSD4/)

# java - 如何解决：密码的明文存储

> ID：16164825
> 
> 赞同：2
> 
> 时间：2013-04-23T08:45:04.063
> 
> 标签：java, jdbc, security, veracode

我已将我的 JAVA EAR 提交给 Veracode 安全工具，并在以下代码中遇到密码明文存储问题：

```
ApplicationProperties   app = new ApplicationProperties(fileProp);
String sqlServerPassword = app.getAppProperty("sqlServerPassword");  
con = DriverManager.getConnection(sqlServerConnectString, sqlServerUserID, sqlServerPassword); 
```

在属性文件中，我存储了这个密码的值。
有人请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T09:03:30.353

既然您说您有一个企业应用程序（EAR），那么您将把它部署到一个应用程序服务器上。在企业应用程序中处理数据库连接的正常方式是让服务器将连接池作为资源来管理。然后，您的应用程序可以使用 JNDI 查找连接池并获得连接。

当您在服务器上配置连接池时，应用程序永远不需要知道其所有托管服务器端的详细信息（例如数据库服务器、用户名或密码）。安全性来自服务器上的内置访问控制机制。

阅读应用程序服务器的文档，可能会有具体说明告诉您如何将连接池配置为 JNDI 资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:34:35.190

如果您的应用程序依赖 SQL 身份验证，则必须在配置文件中保护凭据。在将连接字符串存储到配置文件之前，使用受保护的配置提供程序对连接字符串进行加密。

看看下面的文章：

[http://scribblejava.wordpress.com/2010/03/23/encrypt-username-and-password-for-jndi-in-tomcat-server-xml/](http://scribblejava.wordpress.com/2010/03/23/encrypt-username-and-password-for-jndi-in-tomcat-server-xml/)

法比奥@fcerullo

# c - Strange behavior for 'free' in C

> ID：16164826
> 
> 赞同：1
> 
> 时间：2013-04-23T08:45:03.963
> 
> 标签：c, memory-management, free, calloc

I was writing a code to check if two functions I wrote to allocate and deallocate memory worked. The two functions were essentially

```
int createBaseName(char ***imageName, char **groupName, char *name)
{
    *imageName = calloc(BASELINEC, sizeof(char *)); //This is a 2D array (array of str)
    *groupName = calloc(MINILINE, sizeof(char)); // This is a 1D array (just an str)

    sprintf(*groupName, "%s_BGr.fbi", name);
    for(bb = 0; bb < BASELINEC; bb++) {
       (*imageName)[bb]  = (char *)calloc(MINILINE, sizeof(char));
        if (bb < 9)
           sprintf((*imageName)[bb], "%s_BIm_00%d.fbi", name, bb+1);
        else if (bb < 99) 
           sprintf((*imageName)[bb], "%s_BIm_0%d.fbi", name, bb+1);
        else
           sprintf((*imageName)[bb], "%s_BIm_%d.fbi", name, bb+1);
   }
   return 0;
} 
```

and

```
int freeBaseName(char **imageName, char *groupName)
{
   int  bb;

   for(bb = 0; bb < BASELINEC; bb++)
      free(imageName[bb]);

   free(imageName);
   free(groupName);

   return 0;
} 
```

In the program I wrote to check these two functions, I accidentally called `createBaseName` and `freeBaseName` one after the other, and *then* I was attempting to print out `imageName` and `groupName`. This resulted in `groupName` printing just fine, and about a 120 of 400 names of `imageName` printing fine before it segfaulted.

**QUESTION:** Why wasn't the `free`-ing of the memory working? Or does it take time to free the memory?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:48:29.523

`free()`函数仅将内存块标记为“空闲”。这意味着，在任何时候，它都可以被其他功能使用。它不会清理内存，因为它应该由下次获取此内存块的程序处理。

您实际所做的是**未定义的行为**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T09:20:42.380

当你`free`有记忆时，你只是失去了对它的控制。您释放内存用于任何其他用途。它不会立即被其他函数或变量覆盖或占用。但它可以在任何未知时间被其他函数或变量使用。在此之前，您将能够访问内存。但是由于无法确定其他人何时使用它，因此**行为**是**undefined**。

*   如果您想确保使用相同的变量无法访问内存，请将它们设置为**`NULL`**after `free`ing。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T08:48:47.623

`free`将内存标记为可重用。在`free`您有责任不再尝试使用内存之后。释放后内存可能仍然完好无损，因此您的`groupName`打印正常。然而，它也可能被重新分配，因此在`imageName`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T08:51:09.460

释放内存时，指针仍然指向已分配的内存，其内容可能（也可能不会）被其他数据覆盖。这就是为什么它有时会起作用的原因。*未定义的行为*往往是未定义的。

# sorting - d3v2 - Dom sorting does not work in Safari

> ID：16164831
> 
> 赞同：1
> 
> 时间：2013-04-23T08:45:17.403
> 
> 标签：sorting, safari, d3.js

I'm having some trouble using the dom sorting in Safari, it basically does not move the dom items. The ordering works in Chrome and Firefox, my only issue is on Safari. This is the code i am using:

```
var hovered = d3.select(this)[0][0]['__data__']['properties']['name'];
g.selectAll("path").sort(function(a, b) {
  return (a.properties.name == hovered ? 1 : 0);;
}); 
```

I am using this because later in the code i am doing some scaling on the hovered path, and if its not last in the dom tree it appears behind the paths that are after it.

Any help on the matter would be great.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:42:36.933

问题是您没有为[Array.sort](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/sort)实现有效的比较器。*如果 a 应该在b*之前，比较器需要返回小于零的数字，如果*a*应该在b 之后*，则需要返回大于零**的*数字，如果您不关心*a*和*b*的相对顺序，则需要返回零。

 ***如果要将悬停的名称移到前面，则需要以下内容：

```
function order(a, b) {
  return (a.properties.name == hovered) - (b.properties.name == hovered);
} 
```

排序在 Safari 和 Firefox 中起作用的原因是它们使用[稳定](https://stackoverflow.com/questions/3026281/array-sort-sorting-stability-in-different-browsers)的排序算法，当比较器返回 0 时保留顺序。但是，这种行为不受 ECMAScript 标准的保证，因此您应该实现适当的比较器而不是依赖此特定于浏览器的行为。（如果你真的需要稳定的排序，你可以将它构建到你的比较器中，但是你需要缓存之前的顺序。）

话虽如此，在悬停时将特定节点移动到前面会更快，而不是对所有元素进行排序：

```
path.on("mouseover", function() {
  this.parentNode.appendChild(this);
}); 
```

如果您发现自己经常这样做，您甚至可以定义一个[moveToFront方法。](https://groups.google.com/d/msg/d3-js/eUEJWSSWDRY/EMmufH2KP8MJ)***

# geolocation - Using collective.geo.behaviour and dexterity cause site failure

> ID：16164832
> 
> 赞同：1
> 
> 时间：2013-04-23T08:45:19.857
> 
> 标签：geolocation, plone, zope, dexterity

I have a strange problem when I attempt to use collective.geo.behavior with my dexterity content type (named profilmembre). I used the filesystem way to create content type (not TTW).

Without collective.geo.behavior I can create profilmembre inside Plone site's root or as any folder child. That's right.

With collective.geo.behavior behaviour I can create profilmembre inside Plone site's root but if create this content-type inside a classic Folder my plone site crashed with (in browser):

`ValueError('No object with id "" exists.',) (Also, the following error occurred while attempting to render the standard error message, please see the event log for full details: No object with id "" exists.)`

This message doesn't appear only for content view but for entire site (which is broken)

To restore, I need making "Clear and rebuild" in portal_catalog. Permitting me seeing memberprofil and folder content while I created memberprofil once again

(projet on github : [https://github.com/tristanlt/iuem.cargo](https://github.com/tristanlt/iuem.cargo) )

Here is the debug trace after content creation :

```
 Module zope.contentprovider.tales, line 77, in __call__
  Module zope.viewlet.manager, line 112, in update
  Module zope.viewlet.manager, line 118, in _updateViewlets
  Module plone.app.layout.viewlets.common, line 187, in update
  Module Products.CMFPlone.browser.navigation, line 183, in topLevelTabs
  Module Products.CMFPlone.CatalogTool, line 428, in searchResults
  Module Products.ZCatalog.ZCatalog, line 604, in searchResults
  Module Products.ZCatalog.Catalog, line 907, in searchResults
  Module Products.ZCatalog.Catalog, line 656, in search
  Module Products.ZCatalog.Catalog, line 676, in sortResults
  Module plone.app.folder.nogopip, line 104, in documentToKeyMap
  Module plone.folder.ordered, line 102, in getObjectPosition
  Module plone.folder.default, line 128, in getObjectPosition
ValueError: No object with id "" exists. 
```

Thank you very much.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T16:12:52.050

我认为这个提交解决了你的问题：

*   [https://github.com/collective/collective.geo.geographer/commit/d950d7ade1d348e77e66dfa1217c53bf2dea20f0](https://github.com/collective/collective.geo.geographer/commit/d950d7ade1d348e77e66dfa1217c53bf2dea20f0)

使用 Dexterity，GeoreferencingAnnotator 的上下文由 Acquisition 包装。现在我已经用 Acquisition.aq_base 展开了上下文

# redmine - How to fetch issues for a date range

> ID：16164833
> 
> 赞同：2
> 
> 时间：2013-04-23T08:45:22.857
> 
> 标签：redmine

Using the REST API is it possible to returns all issues created after a given date(for eg:2013-03-13)

I tried `GET /issues.json?created_on>2013-03-13`. But the result displays all the issues. Is it possible to get Issue after a given date.

Is it also possible to get issue after a given date with time for eg: `GET /issues.json?created_on>2013-03-13 11:45:36 +0530`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T09:37:30.850

**Fast solution**

```
GET /issues.json?set_filter=1&f[]=created_on&op[created_on]=%3E%3D&v[created_on][]=2013-04-23 
```

for example

```
http://www.redmine.org/projects/redmine/issues.json?set_filter=1&f[]=created_on&op[created_on]=%3E%3D&v[created_on][]=2013-04-23 
```

**How to find the matching filter**

Browse the issues list with your favorite browser and set some filters in the UI (there is a `Add filter` select box right above the issue listing). Then click `apply` and wait until the page loaded. Now inspect the current URL. In the URL replace `[...]/issues?[...]` with `[...]/issues.json?[...]`, and you have your json output.

Unfortunately I can't find a filter for times. But it should be easy to develop a redmine plugin (or patch for the redmine core) to implement such a filter.

**Further investigation**

The `Issues#index` controller action actually builds a Query object from your parameters. You can read about creating that query in the [queries_helper.rb#L184](https://github.com/redmine/redmine/blob/master/app/helpers/queries_helper.rb#L184)

# html - Spec for handling of HTML entities in a[href]

> ID：16164835
> 
> 赞同：2
> 
> 时间：2013-04-23T08:45:25.127
> 
> 标签：html, browser, specifications

I'm looking for a spec on handling HTML entities in the `href` attribute of `<a>` tags. So far, no luck (I might be searching for something too specific).

### In detail:

The [bug](https://github.com/MatthewMueller/cheerio/issues/194) I'm trying to fix is part of the [cheerio](https://github.com/MatthewMueller/cheerio) project.

Some entities don't require a semicolon at the end. One of them is `&curren`. Anyway, this leads to problems when a source links to `/test/example.jsp?item=123&currentSize=S&currentQty=1`.

Browsers (at least Chrome) [handle this](http://bit.ly/11HVN1w) nicely. I still haven't figured out why though.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T11:48:49.117

关于 HTML 4.01（包括 HTML 4.01），请参阅@Quentin 的回答。

对于 XHTML 的任何风格，包括 XHTML 序列化`&currentSize=`中的 HTML5，都包含格式正确的错误，因此文档的任何显示都被中止（当文档作为真正的 XHTML 处理时）。

[在 HTML 序列化中的 HTML5 中，有一些用于解析字符引用](http://www.w3.org/TR/html5/syntax.html#consume-a-character-reference)的棘手的临时规则。它们暗示在文本内容中，`&currentSize=`将被解析为好像它是被写入的`&curr;entSize=`，即`¤entSize=`. 但是在属性值中，如 中`<a href="...">`，则在某些条件下，无法识别引用，因为它没有以分号结尾。

具体来说，这里描述的条件是：“如果字符引用作为属性的一部分被使用，并且最后匹配的字符不是“;” (U+003B) 字符，并且下一个字符是“=” (U+003D) 字符或在 ASCII 数字、大写 ASCII 字母或小写 ASCII 字母范围内，然后，由于历史原因，所有字符在 U+0026 AMPERSAND 字符 (&) 之后匹配的字符必须未被使用，并且不返回任何内容。” 因此 no`&foobar=`将在属性值中被识别，即使`foobar`是已定义的名称

原因是作者在属性值中广泛编写了没有转义的 URL，`&`浏览器已经适应了这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T08:51:00.000

> 我可能正在寻找一些过于具体的东西。

你是。它们的处理方式与其他任何地方相同（定义为包含 CDATA 的元素除外）。

我找不到任何*具体*和*明确*的说明在 HTML 中评估字符引用的位置，但[属性](http://www.w3.org/TR/html4/intro/sgmltut.html#h-3.2.2)部分暗示它：

> 所有属性值都使用双引号（ASCII 十进制 34）或单引号（ASCII 十进制 39）分隔。当值由双引号分隔时，可以在属性值中包含单引号，反之亦然。作者还可以使用数字字符引用来表示双引号 ( `&#34;`) 和单引号 ( `&#39;`)。对于双引号，作者也可以使用字符实体引用`&quot;`。

[HTML 5 改变了规则](http://www.w3.org/TR/html5/syntax.html#character-references)：

> 必须是一个以“;”结尾的 (U+003B) 字符。

…以及相同的变体。

但是，一些浏览器仍然支持旧标准，当实体后跟非名称字符时，分号是可选的。这方面的标准是您必须支付的 ISO SGML 规范，但[HTML 4.0 说](http://www.w3.org/TR/WD-html40-970708/charset.html#entities)：

> 注意：在 SGML 中，可以去掉最后的“;” 在某些情况下，在数字或命名字符引用之后（例如，在换行符处或直接在标记之前）。在其他情况下，它可能不会被消除（例如，在单词中间）。我们强烈建议使用“;” 在所有情况下，以避免需要此字符存在的用户代理出现问题。

简而言之，为了向后兼容和清晰，**如果您想在属性`&`的 URL 中包含一个字符`href`，那么只需将其表示为`&amp;`**. 这在任何地方都有效。

# sql-server - Advice on searching for availability in MSSql using VB

> ID：16164837
> 
> 赞同：1
> 
> 时间：2013-04-23T08:45:25.560
> 
> 标签：sql-server, vb.net

I would appreciate a little advice on the most appropriate method for managing bookings.

I am adding to an existing program, written in VB with an MSSql DB.

I am currently using win forms as the GUI, utilising a DataGridView to display the data with a Month control.

My current DB schema is:

```
bikeDetail (bikeID (PK), bikeName, bikeColour, bikeStyle, bikeNotes)

bikeMovements (bikeMovementID (PK), bikeID, customerID, bikeMovementType, bikeMovementDate, bikeMovementAMPM, bikeMovementNotes).

customer (customerID, ..., ...) 
```

The idea is that each time a bike is taken in or out, a record is made in the bikeMovements database. This may not be the easiest way of saving this data, but it should hopefully mean the database won't get bloated with lots of repeated data.

My problem is that I am struggling to work out the best way to search through the bikeMovements table in order to find out if bikes are in or out, and are hence available to book out. Using the calendar tool I am able to select a range of dates.

So far, I have been able to work out if a bike is available on a certain date by using a sql query, but not for the range of dates.

Current sql query:

```
 SELECT * FROM tb_bikeMovements as bm, tb_bikeDetail as bd
    WHERE bm.bikeMovementDate < '" + startDate + "'
    and bm.bikeID = bd.bikeID
    and bm.bikeMovementType = 1 
```

This returns the bikes that are available from that day onward. (bikeMovementType 1 is the bike coming back in, and hence is available).

I would appreciate any advice on either a better sql query for bringing back availability, or a better way to setup the DB that would make querying it simpler.

Example dates:

bike 1 goes out on 22 April, and is booked back in for 24 April (available from 25 April)
bike 2 goes out on 22 April, and is booked back in for 28 April (available from 29 April)
bike 3 goes out on 26 April, and is booked back in for 27 April (available from 28 April)
bike 4 is available from 22 April onward.

What bikes are available for 25 - 29 April? (should be bike 1 and 4\. Catching bike 1 is easy, bike 3 is the fly in the ointment as it goes out and back in within the selected date range!).

I am thinking that the easiest way would be to change my DB schema so that a record is created for every day that a bike is booked out for. This will make it a lot easier to search for availability, but will make the table way more bloated (2 records for each bike hire currently, in and out), with a record for every day the bike is out. To be fair though, we are not yet sure how many days these bikes will be rented for, and this would have an impact on my decision.

Any advice will be gratefully received!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T09:25:16.913

如果我理解正确，那么如果在要求的日期范围内有运动记录（出或入），则自行车不可用（归还后的第二天可用），如果最后的运动记录已出，则自行车也不可用

查询

```
select distinct bikeid from bikemovements where bikeMovementDate between '25 April 2013' and '29 April 2013' 
```

会给在 4 月 25 日至 29 日之间进出的自行车

所以我们可以通过使用“不在”来查找可用的自行车来否定这一点

```
select * from bikeDetail where bikeid not in (
  select distinct bikeid from bikemovements where bikeMovementDate between '25 April 2013' and '29 April 2013'
) 
```

但我想我们也应该检查一下自行车是否已经预订完毕并且还没有进来

这将获得每辆自行车的最后运动日（直到开始日期）

```
 select bikeid bid, max(bikemovementdate) bmd from bikemovements
  where bikemovementdate < '25 April 2013' 
  group by bikeid) lastmove 
```

并查找运动记录，我们可以

```
select * from bikemovements join 
(
  select bikeid, max(bikemovementdate) bmd from bikemovements
  where bikemovementdate < '25 April 2013' 
  group by bikeid
) lastmove 
on lastmove.bikeid=bikemovements.bikeid and 
   lastmove.bmd=bikemovements.bikemovementdate 
```

只找到最后移动为 out 的那些

```
select bikemovements.bikeid from bikemovements join 
(
  select bikeid, max(bikemovementdate) bmd from bikemovements
  where bikemovementdate < '25 April 2013' 
  group by bikeid) lastmove 
on lastmove.bikeid=bikemovements.bikeid and 
   lastmove.bmd=bikemovements.bikemovementdate
where bikeMovementType = 'out' 
```

所以把它们放在一起，我们可以有一些类似的东西

```
select * from bikeDetail where bikeid not in (
select distinct bikeid from bikemovements 
  where bikeMovementDate between '25 April 2013' and '28 April 2013'
  ) 
and bikeid not in ( 

select bikemovements.bikeid from bikemovements join 
(
  select bikeid, max(bikemovementdate) bmd from bikemovements 
  where bikemovementdate < '25 April 2013' 
  group by bikeid
) lastmove 
 on lastmove.bikeid=bikemovements.bikeid and 
   lastmove.bmd=bikemovements.bikemovementdate
 where bikeMovementType = 'out'
) 
```

[sql小提琴](http://sqlfiddle.com/#!6/ba19d/11/0)

# tsql - Get all trees from set of rows data (with specific id) in tsql

> ID：16164840
> 
> 赞同：6
> 
> 时间：2013-04-23T08:45:29.917
> 
> 标签：tsql, tree, recursive-query

My data is in table with 2 field, Id & ParentId. I store data with this structure(similar image in follow). How can I get all path from leaf to root that include Id = 6 ? (Result sample is in follow)

```
--Data structure is as follow :
--  1
-- /
--2 <- 3       9
-- \    \    / 
--  4 <- 5  7  8
--    \  /  /  /
--      6 - - -
--   /    \
--  10  <- 11
-- /
--12

--Data In Table Is :
--Id    ParentId
--1     null
--2     1
--3     2
--4     2
--5     3
--5     4
--6     4
--6     5
--6     7
--6     8
--7     9
--8     null
--9     null
--10    6
--11    6
--11    10
--12    10

--Result for all trees that include "Id = 6":
--12 > 10 > 6 > 4 > 2 > 1
--12 > 10 > 6 > 5 > 4 > 2 > 1
--12 > 10 > 6 > 5 > 3 > 2 > 1
--12 > 10 > 6 > 7 > 9
--12 > 10 > 6 > 8
--11 > 10 > 6 > 4 > 2 > 1
--11 > 10 > 6 > 5 > 4 > 2 > 1
--11 > 10 > 6 > 5 > 3 > 2 > 1
--11 > 10 > 6 > 7 > 9
--11 > 10 > 6 > 8
--11 > 6 > 4 > 2 > 1
--11 > 6 > 5 > 4 > 2 > 1
--11 > 6 > 5 > 3 > 2 > 1
--11 > 6 > 7 > 9
--11 > 6 > 8 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T11:13:55.690

你的表说 4 有自己作为父母，但没有其他任何东西，但你有一行表明 12 > 10 > 6 > 5 > 4 > 2 > 1 所以我不能用那个设置产生相同的结果。

我的 sqlfiddle 在这里：[http ://sqlfiddle.com/#!6/873b9/3](http://sqlfiddle.com/#!6/873b9/3)

假设 4 有 2 作为父代码，我的代码如下所示（排序可能有点不同，但它的 SQL 所以没关系）：

```
WITH records as
(
  SELECT
  leaf.Id
  ,leaf.ParentId
  ,case when NOT EXISTS(SELECT * FROM recTest where ParentId = leaf.Id) then 1 else 0 end as isLeaf
  FROM recTest as leaf
)
,hierarchy as
(
  SELECT Id
  ,NULL as ParentId
  ,cast(Id as varchar(100)) as chain
  ,isLeaf
  FROM records
  where ParentId IS NULL
  UNION ALL
  SELECT r.Id
  ,r.ParentId
  ,cast(cast(r.Id as varchar(100)) + ' > ' + h.chain as varchar(100)) as chain
  ,r.isLeaf
  FROM records as r
    INNER JOIN hierarchy as h
      ON r.ParentId = h.Id
)
SELECT
h.chain
FROM hierarchy as h
WHERE isLeaf = 1
AND h.chain like '%6%'
OPTION (MAXRECURSION 0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T09:50:04.670

对于像[这个示例表这样](https://stackoverflow.com/questions/6802539/hierarchical-tree-database-for-directories-in-filesystem/6802879#6802879)的表，请检查以下查询：

```
with AllPossiblePath as(
SELECT distinct [descendant] leaf
   ,(
        SELECT cast(f.dirname as nvarchar(64) )+'/' 
        FROM filesystem f JOIN tree_path t 
        ON t.ancestor = f.id 
        WHERE t.descendant=t1.descendant for xml path('') 
    ) possiblePath
  FROM [db1].[dbo].[tree_path] t1
  where [descendant] not in(
  SELECT TOP 1000 ancestor
  FROM [db1].[dbo].[tree_path] 
  where ancestor!=[descendant])
  )

select * from AllPossiblePath where possiblePath like '%Dir2%' 
```

希望这有帮助！

# rascal - Why are static type errors in this example code only reported at run-time by Rascal?

> ID：16164843
> 
> 赞同：1
> 
> 时间：2013-04-23T08:45:31.463
> 
> 标签：rascal

According to the [Rascal documentation](http://tutor.rascal-mpl.org/Rascal/Concepts/StaticTyping/StaticTyping.html), the language is statically typed. However the type errors are only reported on runtime.

For example, when I create this module, I expect a type error because I am assigning a real to an int variable:

```
module Example

void example() {
  int x = 1.0;
  println(x);
} 
```

When I import the module on the REPL, and finally run the function:

```
rascal>import Example;
ok
rascal>example()
|project://Test/src/Example.rsc|(39,7,<4,6>,<4,13>): Expected int, but got real
☞ Advice 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T09:00:54.940

文档比 Rascal 的计划提前运行。Rascal 有一个可以静态检查的类型系统，但类型检查器尚未集成。

目前解释器正在运行时检查类型。请注意，它报告的错误消息仅包含“静态类型”。解释器同时对代码进行抽象解释和具体解释（运行）。这使我们能够快速发展语言，因为每个结构的解释代码和类型检查都紧密结合在一起。

当我们引入类型检查阶段时，我们希望使用类型和解析名称来加快解释器的速度，并再次简化解释器的代码，当然也可以更快地将错误传递给程序员。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:45:31.463

Rascal 确实有一个静态类型检查器，它是用 Rascal 本身编写的。它涵盖了大部分语言（目前唯一不支持的功能是关键字参数）。要使用它，右键单击在 Eclipse 中打开的 Rascal 文件（使用 Rascal 插件），选择“Experimental”，然后选择“Run static checker”。正如菜单名称所暗示的，这是实验性的，所以如果您发现问题，请告诉我们。

# iphone - iTunes Lookup API, get iPhone 5 app screenshots

> ID：16164847
> 
> 赞同：3
> 
> 时间：2013-04-23T08:45:41.933
> 
> 标签：iphone, api, app-store, itunes, screenshot

I use **iTunes API lookup** to get app data by App ID this way:
[http://itunes.apple.com/lookup?id=543891460&lang=ru](http://itunes.apple.com/lookup?id=543891460&lang=ru)

Even if app is designed for **iPhone5**, in JSON I get **3.5 inch** screenshots (under **screenshotUrls** array).
Is there any way to get **4 inch**. screenshots?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-23T14:57:56.197

可以使用非官方的 iTunes Connect API 访问所有屏幕截图：

`https://itunesconnect.apple.com//WebObjects/iTunesConnect.woa/ra/apps/version/[app_id]`

它包含原始格式的所有分辨率的所有现有屏幕截图。

不幸的是，我还没有找到一种将语言与 iTunes Transporter 使用的语言进行映射的方法。

有一个拉取请求，将此功能添加到`deliver`：[https ://github.com/KrauseFx/deliver/pull/113/files](https://github.com/KrauseFx/deliver/pull/113/files)

更新：语言代码到语言的映射可以在这里找到：[https ://github.com/KrauseFx/deliver/blob/master/lib/assets/DeliverLanguageMapping.json](https://github.com/KrauseFx/deliver/blob/master/lib/assets/DeliverLanguageMapping.json)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-04T09:10:11.340

再检查一遍。

几个小时后，Apple 似乎就推出了新的 4 英寸屏幕截图。

屏幕截图现在在文件名中也有像素大小。好吧，有点：它似乎不是 100% 正确的（还没有？）。可能的值是：

*   xxx.xxxxxxxxx。**1136x1136-75** .jpg (4" iPhone)
*   xxx.xxxxxxxxx。**320x480-75** .jpg (3.5" iPhone)
*   xxx.xxxxxxxxx。**480x480-75** .jpg (iPad)

# java - Relate one node to another node

> ID：16164853
> 
> 赞同：-3
> 
> 时间：2013-04-23T08:45:50.347
> 
> 标签：java, data-structures

Is the following code:

```
class FamilyMember{
   String name;
   String type;
}

class Family{
   FamilyMember father;
   FamilyMemeber mother;
   List<FamilyMember> children;
} 
```

will produces the following relationship:  

```
 +------------------+      +------------------+  
 |     Father       |------|     Mother       |  
 +------------------+  ^   +------------------+  
                       |                  
                       |                  
                       |                  
                       |                  
                       |                    
                 --------------       
                 |            |                   
                 |            |                   
                 |            |                   
                 |            |                   
 +------------------+       +------------------+  
 |     Son          |       |    Daughter      |  
 +------------------+       +------------------+ 
```

Since the Number of children are different in different family, therefore every family have its own family structure.

I want to make the **class** which can shows the above relationship with variable number of children.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T08:50:31.960

```
class FamilyMember{
   String name;
   String type;
}

class Family{
   FamilyMember father;
   FamilyMemeber mother;
   List<FamilyMember> children;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:56:26.943

您只需要一个具有父/子关系的简单树。树中的每个节点都是一个人。

不要忘记这一点；

1.  两个孩子可能只共享一个共同的父母，而不是两者。例如，一个男人可以和不同的女人生两个孩子，反之亦然。
2.  所有的父母本身都是隐含的孩子。
3.  每个孩子将有*两个*父母，而不是正常的*一个*。

具有以下数据的类就足够了；

```
public class Person {

  boolean female;
  Person father;
  Person mother;
  List<Person> children;

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T09:07:00.177

```
class Parent
{
    String name;
    String gender;
}

class Family
{
    Map<Set<Parent, Parent>, String> child;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T08:54:44.507

为什么不创建一个名为 Family 的类？可以有多个（n）个孩子和1个或0个（悲伤的世界：/）父亲和母亲。

您还可以将每个孩子与特定的母亲和父亲联系起来。

实际上我宁愿选择一个有性别的类 Person 并且所有其他类都应该从它继承。由于每个人都有很多东西，比如名字和东西，从长远来看，这应该更容易处理......

# javascript - 如何解决 ExtJS 4.1 Combobox pageSize 的 bug？

> ID：16164862
> 
> 赞同：4
> 
> 时间：2013-04-23T08:46:12.460
> 
> 标签：javascript, extjs, extjs4.1

我们有一个 ExtJS v4.1 组合框，我们已经将它绑定到一个商店并设置它的 pageSize 配置如下：

```
var myStore = Ext.create('Ext.data.Store', {
    model: 'User',
    remoteFilter: true,
    remotePaging: true,
    autoLoad: true
    proxy: {
        type: 'ajax',
        url: '/users.json',
        reader: {
            type: 'json',
            root: 'users'
        }
    },
    pageSize: 50,                  //   <= store pageSize
});

Ext.create('Ext.form.ComboBox', {
    fieldLabel: 'Choose',
    store: myStore,
    queryMode: 'remote',
    displayField: 'Name',
    valueField: 'Id',
    pageSize: 20                   //   <= combobo pageSize
}); 
```

正如[文档所说](http://docs.sencha.com/extjs/4.1.3/#!/api/Ext.form.field.ComboBox)，组合框的`pageSize`属性应该用于过滤发送到服务器的 ajax 查询`queryMode='remote'`。但我们看到的是相反的，它只是用于在组合框底部显示一个分页工具栏（文档的第一条评论是这样说的）。

但是在这种特定情况下，我们真正需要的是覆盖`pageSize`store 的属性，并使组合框的`pageSize`属性用于过滤 ajax 请求。

我们如何在组合框中实现/扩展这样的功能？我们如何`pageSize`在组合框中覆盖商店的属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-07T08:45:22.023

尽管有文档，comboBox 中的 pageSize 实际上是一个真/假值。

在 javascript 中，如果为 0，则分页工具栏关闭，否则打开。

这是共享存储，还是仅用于组合框？

如果共享，那么您将需要保存商店的页面大小，在必要时为组合更改它，然后再次将其重新设置：

```
 {
                xtype: 'combobox',
                width: 350,
                store: new MyStore(),
                fieldLabel: 'Label',
                pageSize: 2,
                listeners:{
                    beforequery:function(queryEvent){
                        var combo = queryEvent.combo;
                        var store = combo.getStore();
                        var oldPageSize = store.pageSize;
                        store.on('load', function(){
                            this.pageSize = oldPageSize;
                        });
                        store.pageSize = combo.pageSize;
                    }
                }
            } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-12T16:11:47.680

另一种实现此功能的方法是在实例化时将参数/配置添加到存储中。这是我的做法

```
store: new Ext.create('MyStore',{pageSize:20}),
pageSize: true 
```

# prolog - "Squares" Logic Riddle Solution in Prolog

> ID：16164869
> 
> 赞同：3
> 
> 时间：2013-04-23T08:46:39.333
> 
> 标签：prolog, logic, puzzle

"Squares"

**Input**:

Board size m × n (m, n ∈ {1,...,32}), list of triples `(i, j, k)`, where i ∈ {1,...,m}, j ∈ {1,...,n}, k ∈ {0,...,(n-2)·(m-2)}) describing fields with numbers.

**Output**:

List of triples `(i, j, d)` showing solved riddle. Triple `(i, j, d)` describes square with opposite vertices at coordinates `(i, j)` and `(i+d, j+d)`.

**Example:**

**Input:**

> 7. 7\. [(3,3,0), (3,5,0), (4,4,1), (5,1,0), (6,6,3)].

**Output**:

```
[(1,1,2), (1,5,2), (2,2,4), (5,1,2), (4,4,3)] 
```

**Image:**

![Example](https://i.stack.imgur.com/rbpy6.jpg)

**Explanation:**

> I have to find placement for x squares(x = fields with numbers). On the circuit of the each square, exactly at one of his corners should be only one digit equal to amount of digits inside the square. Sides of squares can't cover each other, same as corners. Square lines are "filling fields" so (0,0,1) square fills 4 fields and have 0 fields inside.

I need a little help coding solution to this riddle in Prolog. Could someone direct me in the right direction? What predicates, rules I should use.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T00:16:04.383

由于 Naimads 的生命值得拯救（！），这里有一些更具指导性的帮助。

程序员倾向于以自底向上（从“较低”级别的功能开始，构建完整的应用程序）或自顶向下（从提供输入/输出的高级“外壳”功能开始，但将解决方案处理存根以供以后细化）。

无论哪种方式，我都可以推荐一种受到 Ruby 编程社区支持的 Prolog 编程方法： [测试驱动开发](http://en.wikipedia.org/wiki/Test-driven_development)。

让我们挑选几个功能要求，一个高一个低，并讨论一下这种理念如何提供帮助。

Prolog 中的高级谓词是一个接受所有输入和输出参数并在语义上定义问题的谓词。请注意，我们可以写下这样的谓词，而无需关心解决方案过程将如何实现：

```
/* squaresRiddle/4 takes inputs of Height and Width of a "board" with
   a list of (nonnegative) integers located at cells of the board, and
   produces a corresponding list of squares having one corner at each
   of those locations "boxing in" exactly the specified counts of them
   in their interiors.  No edges can overlap nor corners coincide.  */
squaresRiddle(Height,Width,BoxedCountList, OutputSquaresList). 
```

到目前为止，我们刚刚提出了这个问题。注释给出了有用的进展（在高层次上清楚地定义了输入和输出），此时的代码只保证传递任何参数的“成功”。所以这个代码的“测试”：

```
?= squaresRiddle(7,7,ListIn,ListOut). 
```

除了自由变量，不会产生任何东西。

接下来让我们考虑一下应该如何表示输入列表和输出列表。在问题中，建议使用整数的三元组作为这些列表的条目。我建议改用命名函子，因为这些输入三元组的语义（给出带有计数的单元格的 x,y 坐标）与输出三元组的语义（给出左上角的 x,y 坐标）略有不同和正方形的“范围”（高度和宽度））。特别注意，输出方块可以由与相应输入项中的角不同的角来描述，尽管输入项中的角需要是输出方块的四个角之一。

`BoxedCountList = [box(3,3,0),box(3,5,0),box(4,4,1),box(5,1,0),box(6,6,3)]`因此，如果这些构造通过简单的仿函数名称来区分，例如vs. ，它往往会使代码更具可读性`OutputSquaresList = [sqr(1,1,2), sqr(1,5,2), sqr(2,2,4), sqr(5,1,2), sqr(4,4,3)]`。

让我们稍微思考一下解决方案的搜索将如何进行。输出项与输入项是一一对应的，因此列表最终将具有相等的长度。然而，选择第 k 个输出项不仅取决于第 k 个输入项，还取决于*所有*输入项（因为我们计算了输出方格内部有多少）和前面的输出项（因为我们不允许满足和重叠的边缘）。

有几种方法可以管理符合此要求的决策流程，而选择一种方法并使其发挥作用似乎是本练习的关键。如果您熟悉[差异列表](http://www.cs.washington.edu/education/courses/cse341/10wi/clpr/difference_lists.clpr)或[累加器](http://people.sju.edu/~jhodgson/ai/accums.html)，那么您就可以先行一步。

现在让我们切换到讨论一些较低级别的功能。给定一个输入`box`，可能有许多`sqr`与之对应的输出。给定输出的正“范围”，`X,Y`输入的坐标可以与输出正方形的四个角中的任何一个相交。虽然需要更多检查来验证解决方案，但这方面似乎是开始测试的好地方：

```
/* check that coordinates X,Y are indeed a corner of candidate square */
hasCorner(sqr(SX,SY,Extent),X,Y) :-
    (SX is X ; SX is X + Extent),
    (SY is Y ; SY is Y + Extent). 
```

我们将如何利用这个测试？好吧，我们可以生成所有可能的正方形（可能将我们限制在适合我们“板”的高度和宽度的那些），然后检查是否有任何需要的角。这可能是相当低效的。更好的方法（就效率而言）将使用角来生成可能的正方形（通过从角延伸到`Extent`四个方向中的任何一个），这取决于电路板尺寸的参数。这种“优化”的实现留给读者作为练习。

# javascript - 在 Flash 上下文中阻止/禁用 Internet Explorer 中的 F5-/CTRL-R

> ID：16164871
> 
> 赞同：0
> 
> 时间：2013-04-23T08:46:40.520
> 
> 标签：javascript, flash, internet-explorer

我试图在显示 Flash 应用程序时阻止Internet Explorer 中的*F5*和*CTRL-R*。它通过使用 Javascript *onkeydown* -event ( [http://msdn.microsoft.com/en-us/library/ie/ms536938(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/ms536938(v=vs.85).aspx) ) 工作。但此刻我单击 Flash 应用程序中的某个位置，它不再起作用。

即使在 Flash 上下文中，是否有机会阻止/禁用这些键，也许不使用外部库？

不幸的是*onbeforeunload*事件（[http://msdn.microsoft.com/en-us/library/ie/ms536907(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/ms536907(v=vs.85).aspx)）不适合我，因为我必须通过代码重新加载页面.

提前致谢。

# ckeditor - CKEDITOR - 识别选定的 html

> ID：16164877
> 
> 赞同：0
> 
> 时间：2013-04-23T08:47:03.163
> 
> 标签：ckeditor, selection, client-side, server-side, offset

我发现了 CKEDITOR 选择对象的一些有用属性（通过`editor.getSelection()`）：

```
e.getSelection().getRanges()[0].startOffset
e.getSelection().getRanges()[0].endOffset 
```

这将返回所选文本的开始和结束位置 - 但仅与 startContainer（元素）和 endContainer（元素）有关。我想获得相对于整个文档或其他东西的绝对位置来识别所选的 html（开始或结束元素的一些实习生 id？）。我想在服务器端读取这个属性并在那里修改选定的 html。是否有一些通用方法可以将有关所选文本位置的信息从客户端移动到服务器端？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T20:15:51.327

如果我理解正确，您想根据光标所在的位置或在提交/ajax 调用期间选择的位置来识别特定节点或多个节点服务器端。而且您已经知道获取当前选择的节点的咒语。

我建议在提交到服务器之前，手动标记元素。在提交之前向目标受害者添加自定义属性或类，然后使用该标签来识别节点服务器端。

例如`[`是选择的开始，`]`是结束，您的数据是：

```
<p>foo</p><p>[bar</p><p>baz]</p> 
```

在提交之前，获取并用 JS 标记元素，使其看起来像

```
<p>foo</p><p class="chosen">bar</p><p class="chosen">baz</p> 
```

然后您可以使用任何您喜欢的 XML/HTML 武器来查找标记的元素`chosen`（如果您使用的是 C#，我推荐使用 CSQuery）。然后只需删除标签并命令节点进行投标。对于多个节点，只需标记多个节点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T08:15:34.813

该计算强烈反对 CKEDITOR 的原则。但我认为，我发现了最好的解决方案——它几乎和 Nenotlep 建议的一样：

```
var bookmarks = e.getSelection().createBookmarks(true);
var startId = bookmarks[0].startNode;
var endId = bookmarks[0].endNode; 
```

这将插入到代码中的不可见书签（ID 为 startId 和 endId 的跨度），然后我可以在服务器端处理它。现在我必须解决多选问题和标签交叉问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-27T12:06:13.257

我找到了一个很好的优雅的解决方案：

textselector.js（标记选择 - 将书签插入 CKEDITOR）

```
 function selectText(irtId, startIdSelectionId, endIdSelectionId) {
    var editor = CKEDITOR.instances[irtId];
    if (editor.getSelection().getRanges()[0].collapsed) {
        document.getElementById(startIdSelectionId).value = "";
        document.getElementById(endIdSelectionId).value = "";
    } else {
        var bookmarks = editor.getSelection().createBookmarks(true);
        var startId = bookmarks[0].startNode;
        var endId = bookmarks[0].endNode;
        document.getElementById(startIdSelectionId).value = startId;
        document.getElementById(endIdSelectionId).value = endId;
    }
    return true;
} 
```

服务器端的操作（识别冲突 - 标记交叉，必要时修复元素 - 分为 2 部分和插入跨度）：

```
/**
 * prida span na oznacene html osestreni nezadoucich pripadu: prazdny
 * select, kolize s jinym spanem
 */
public void spanSelectedHtml() {
    // parsovani celeho dokumentu
    Document doc = Jsoup.parse(value);
    // osetreni chybovych stavu
    // - prazdny select
    if (startIdSelection.isEmpty() || endIdSelection.isEmpty()) {
        return;
    }
    // nalezeni znacek
    Element es = doc.getElementById(startIdSelection);
    Element ee = doc.getElementById(endIdSelection);
    // - konflikt s jinou znackou
    // bude doplneno

    // oprava okoli znacek v pripade nutnosti
    repairIfNecessary(es, ee);
    // vytvoreni span tagu s nalezitymi atributy
    Element span = doc.createElement("span");
    span.attr("property", clicked.getUrl());
    span.attr("class", clicked.getStyleClass());
    // nahrazeni prvni znacky span tagem
    es.replaceWith(span);
    // pripojeni vsech nasledujicich uzlu az do koncove znacky
    while (span.nextSibling() != ee) {
        span.appendChild(span.nextSibling());
    }
    // odstraneni koncove znacky
    ee.remove();
    // aktualizace hodnoty textove komponenty
    value = doc.toString();
}

/**
 * oprava okoli elementu v pripade nutnosti - pri zjisteni unikatniho rodice
 *
 * @param e1 prvni element
 * @param e2 druhy element
 */
private void repairIfNecessary(Element e1, Element e2) {
    while (hasUniqueParent(e1, e2)) { // unikatni rodice e1?
        repairElement(e1);
    }
    while (hasUniqueParent(e2, e1)) { // unikatni rodice e2?
        repairElement(e2);
    }
}

/**
 * oprava okoli elementu: rozdeleni na dve casti a vymazani rodice,
 * zachovani atributu
 *
 * @param e element s okolim na opravu
 */
private void repairElement(Element e) {
    // "problemovy rodic", ktereho je treba rozdelit
    Element p = e.parent();
    // 1\. cast - pred znackou
    if (e.previousSibling() != null) { // osetreni null
        Element n = p.clone().empty(); // vkladany element musi byt formalne stejny
        p.prependChild(n); // umisteni elementu na zacatek - jako 1\. dite
        while (n.nextSibling() != e) { // dokud se nedostanu ke znacce, pridavam uzly
            n.appendChild(n.nextSibling());
        }
    }
    // 2\. cast - za znackou
    if (e.nextSibling() != null) { // osetreni null
        Element n = p.clone().empty(); // vkladany element musi byt formalne stejny
        p.appendChild(n); // umisteni elementu na konec - jako posledni dite
        while (n.previousSibling() != e) { // dokud se nedostanu ke znacce, pridavam uzly
            n.prependChild(n.previousSibling());
        }
    }
    p.unwrap(); // vymazani puvodniho "problemoveho rodice"
}

/**
 * ma testovaci element rodice, ktereho kontrolni element nema?
 *
 * @param e testovaci element
 * @param c kontrolni element
 * @return testovaci element ma unikatniho rodice (takoveho, ktery kontrolni
 * element nema)
 */
private boolean hasUniqueParent(Element e, Element c) {
    if (e.parents().isEmpty() || c.parents().isEmpty()) { // test na null
        return false;
    }
    for (Element pe : e.parents()) {
        if (!c.parents().contains(pe)) {
            return true; // unikatni rodic
        }
    }
    return false; // bez unikatniho rodice
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T10:07:13.207

现在我必须解决这个问题： - 如果有人想选择（* = 选择边框）这个：`<b>some te*xt </b> aaa <i>bb*b</i>`

... JS 把这个书签：

```
<b>some te
<span id="cke_bm_69S" style="display: none;">&nbsp;</span>
xt</b> 
aaa 
<i>bb
<span id="cke_bm_69S" style="display: none;">&nbsp;</span>
b</i> 
```

...我必须做这样的事情：

```
<b>some te
</b><span property="..."><b>xt</b>
aaa 
<i>bb</i></span><i>b</i> 
```

我的解决方案（尚未测试）：选择一个 id="cke_bm_69S" 的节点，确保标签交叉问题，如果有一些则使用 before() 和 after() 方法插入 html。但是恐怕会有临时未关闭的标签，我不知道是否可以。

# ios - NSOperation 使用 GCD，确保所有在同一个线程上

> ID：16164879
> 
> 赞同：0
> 
> 时间：2013-04-23T08:47:11.570
> 
> 标签：ios, objective-c, multithreading, grand-central-dispatch, nsoperation

我有一个 'concurrent' `NSOperation`，在它工作期间它使用一些内部使用 GCD 的控制器类。当这些控制器类带着它们的完成块返回时，完成块在另一个线程上。

我知道我可以将当​​前线程存储在操作启动方法中并运行`performSelectorOnThread:`，但理想情况下，我想将完成包装在 GCD 块中并分派到操作开始时的同一个线程上。这甚至可以使用 GCD，因为我只能指定一个队列来调度。

将这项工作带回操作开始的同一线程的最佳方法是什么？除了我已经建议的...除非这是最好的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T08:27:10.700

我认为这真的不可能/不可取。从 iOS 4 开始， NSOperation 使用 GCD ，并且由于 GCD 正在管理我的线程 - 我认为我不应该保留对它们的引用。

我确实找到了一些在特定线程上执行代码块的实用方法。请参阅 [Mike Ash 的 Practical Blocks](http://www.mikeash.com/pyblog/friday-qa-2009-08-14-practical-blocks.html)或[这篇文章](http://objcolumnist.com/2011/05/03/performing-a-block-of-code-on-a-given-thread/)做类似的事情。

因为我的目标是将我的核心数据调用保持在同一个线程上，所以我选择升级我的代码以使用 NSPrivateQueueConcurrencyType 的父/子托管对象上下文，然后在托管对象上下文上使用 performBlock: 以确保我的所有回调核心数据正确执行了单独的线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:50:10.567

操作完成后，必须在主线程上完成 UI 更新或任何其他相关事情。以下链接可能对您有关 CGD 有用。

[http://www.raywenderlich.com/4295/multithreading-and-grand-central-dispatch-on-ios-for-beginners-tutorial](http://www.raywenderlich.com/4295/multithreading-and-grand-central-dispatch-on-ios-for-beginners-tutorial)

# javascript - jquery可以用来修改html字符串吗？

> ID：16164886
> 
> 赞同：1
> 
> 时间：2013-04-23T08:47:32.060
> 
> 标签：javascript, jquery

例如，我有这样一段 html：

```
var html = '<p>Title</p><b>edit me</b><i>remove me</i>'; 
```

我想更改其中的标题，但不想为此使用正则表达式或字符串替换函数，因为如果标题与标签名称匹配，则 html 可能已损坏。

我现在尝试为此采用 jQuery，因为它看起来很有能力，但实际上事情并不那么容易。这是代码：

```
$( $(html)[0] ).text('New title');
console.log(html); // --> prints out original html with old title 
```

如果可能的话，知道如何使这段代码工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T08:50:57.820

```
html = $('<div/>').html(html).find('p').text('New title').end().html(); 
```

[http://jsfiddle.net/bEUHN/](http://jsfiddle.net/bEUHN/)

注意：使用创建的 jQuery 对象中有 3 个包装元素`$(html)`，用于选择`p`您应该使用`filter`方法的元素。

```
$(html).filter('p').text('New title'); 
```

# oauth-2.0 - 如何在 Mule CE 上实现基于 Oauth2 两足令牌的安全性？

> ID：16164890
> 
> 赞同：0
> 
> 时间：2013-04-23T08:47:42.603
> 
> 标签：oauth-2.0, mule

我正在研究 Mule CE，需要使用 Oauth2 实现基于令牌的安全性（最好）。我已经配置了授权服务器，并且确实在日志文件中看到了默认映射，但是当我在“/oauth/token”上发送消息时没有任何反应。

当在 Tomcat 上部署为独立的 Spring Web 服务应用程序时，OAuth2 的类似配置与 Spring/Tomcat 配合良好。

这是我的骡子配置：

```
<mule xmlns:mulexml="http://www.mulesoft.org/schema/mule/xml"
    xmlns:https="http://www.mulesoft.org/schema/mule/https" xmlns:jersey="http://www.mulesoft.org/schema/mule/jersey"
    xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core"
    xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:vm="http://www.mulesource.org/schema/mule/vm/2.0"
    xmlns:spring="http://www.springframework.org/schema/beans" version="CE-3.3.1"
    xmlns:mule-ss="http://www.mulesoft.org/schema/mule/spring-security"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:context="http://www.springframework.org/schema/context" xmlns:ss="http://www.springframework.org/schema/security"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:oauth="http://www.springframework.org/schema/security/oauth2"
    xmlns:pattern="http://www.mulesoft.org/schema/mule/pattern" xmlns:util="http://www.springframework.org/schema/util"
    xsi:schemaLocation="
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd 
http://www.mulesoft.org/schema/mule/xml http://www.mulesoft.org/schema/mule/xml/current/mule-xml.xsd 
http://www.mulesoft.org/schema/mule/xml 
http://www.mulesoft.org/schema/mule/xml/3.3/mule-xml.xsd
http://www.mulesoft.org/schema/mule/http 
http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd 
http://www.springframework.org/schema/beans 
http://www.springframework.org/schema/beans/spring-beans-current.xsd 
http://www.mulesoft.org/schema/mule/core 
http://www.mulesoft.org/schema/mule/core/current/mule.xsd 
http://www.mulesoft.org/schema/mule/https 
http://www.mulesoft.org/schema/mule/https/current/mule-https.xsd
http://www.mulesoft.org/schema/mule/jersey 
http://www.mulesoft.org/schema/mule/jersey/current/mule-jersey.xsd 
http://www.mulesoft.org/schema/mule/spring-security 
http://www.mulesoft.org/schema/mule/spring-security/3.3/mule-spring-security.xsd
http://www.springframework.org/schema/security/oauth2 
http://www.springframework.org/schema/security/spring-security-oauth2-1.0.xsd
http://www.springframework.org/schema/security 
http://www.springframework.org/schema/security/spring-security-3.1.xsd
http://www.springframework.org/schema/mvc
http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd
http://www.mulesoft.org/schema/mule/pattern 
http://www.mulesoft.org/schema/mule/pattern/3.3/mule-pattern.xsd
http://www.springframework.org/schema/context
http://www.springframework.org/schema/context/spring-context-3.0.xsd
http://www.springframework.org/schema/util 
http://www.springframework.org/schema/util/spring-util.xsd ">

    <mule-ss:security-manager>
        <mule-ss:delegate-security-provider
            name="memory-provider" delegate-ref="authenticationManager" />
    </mule-ss:security-manager>
    <spring:beans>
        <ss:authentication-manager alias="authenticationManager">
            <ss:authentication-provider ref="myAuthenticationProvider" />
        </ss:authentication-manager>
        <oauth:client-details-service id="clientDetailsService">
            <oauth:client client-id="admin"
                authorized-grant-types="password,authorization_code,refresh_token,implicit,client_credentials"
                authorities="ROLE_USER, ROLE_TRUSTED_CLIENT" scope="read,write,trust"
                access-token-validity="60" />
        </oauth:client-details-service>
        <oauth:authorization-server
            client-details-service-ref="clientDetailsService" token-services-ref="tokenServices">
            <oauth:authorization-code />
            <oauth:implicit />
            <oauth:refresh-token />
            <oauth:client-credentials />
            <oauth:password />
        </oauth:authorization-server>
    </spring:beans>

    <spring:beans>

        <mvc:annotation-driven />
        <spring:bean id="myAuthenticationProvider"
            class="com.sachin.tech.security.MyUserAuthenticationProvider" />

        <spring:bean id="oauthAuthenticationEntryPoint"
            class="org.springframework.security.oauth2.provider.error.OAuth2AuthenticationEntryPoint">
            <spring:property name="realmName" value="myCustomerAppRealm" />
        </spring:bean>

        <spring:bean id="oauth2AccessDeniedHandler"
            class="org.springframework.security.web.access.AccessDeniedHandlerImpl" />

        <spring:bean id="clientCredentialsTokenEndpointFilter"
            class="org.springframework.security.oauth2.provider.client.ClientCredentialsTokenEndpointFilter">
            <spring:property name="authenticationManager" ref="authenticationManager" />
        </spring:bean>

        <spring:bean id="tokenStore"
            class="org.springframework.security.oauth2.provider.token.InMemoryTokenStore" />

        <spring:bean id="tokenServices"
            class="org.springframework.security.oauth2.provider.token.DefaultTokenServices">
            <spring:property name="tokenStore" ref="tokenStore" />
            <spring:property name="supportRefreshToken" value="true" />
            <spring:property name="accessTokenValiditySeconds"
                value="60" />
        </spring:bean>

    </spring:beans>

    <flow name="wsauthentication_2" doc:name="wsauthentication_2">
        <http:inbound-endpoint exchange-pattern="request-response"
            host="localhost" port="8098" doc:name="MyHTTPInbound2_2"
            doc:description="wsauthentication_2 Desc">
        </http:inbound-endpoint>
        <echo-component doc:name="Echo" />
    </flow>

</mule> 
```

映射在日志中似乎很好：

```
13:48:01,789 DEBUG FrameworkEndpointHandlerMapping:125 - Looking for request mappings in application context: org.mule.config.spring.MuleApplicationContext@7fe3a7ec: startup date [Tue Apr 23 13:47:56 IST 2013]; root of context hierarchy
13:48:01,836  INFO FrameworkEndpointHandlerMapping:197 - Mapped "{[/oauth/error],methods=[],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public org.springframework.web.servlet.ModelAndView org.springframework.security.oauth2.provider.endpoint.WhitelabelApprovalEndpoint.handleError(javax.servlet.http.HttpServletRequest)
13:48:01,836  INFO FrameworkEndpointHandlerMapping:197 - Mapped "{[/oauth/confirm_access],methods=[],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public org.springframework.web.servlet.ModelAndView org.springframework.security.oauth2.provider.endpoint.WhitelabelApprovalEndpoint.getAccessConfirmation(java.util.Map<java.lang.String, java.lang.Object>) throws java.lang.Exception
13:48:01,851  INFO FrameworkEndpointHandlerMapping:197 - Mapped "{[/oauth/authorize],methods=[],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public org.springframework.web.servlet.ModelAndView org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.authorize(java.util.Map<java.lang.String, java.lang.Object>,java.lang.String,java.util.Map<java.lang.String, java.lang.String>,org.springframework.web.bind.support.SessionStatus,java.security.Principal)
13:48:01,851  INFO FrameworkEndpointHandlerMapping:197 - Mapped "{[/oauth/authorize],methods=[POST],params=[user_oauth_approval],headers=[],consumes=[],produces=[],custom=[]}" onto public org.springframework.web.servlet.View org.springframework.security.oauth2.provider.endpoint.AuthorizationEndpoint.approveOrDeny(java.util.Map<java.lang.String, java.lang.String>,java.util.Map<java.lang.String, ?>,org.springframework.web.bind.support.SessionStatus,java.security.Principal)
13:48:01,851  INFO FrameworkEndpointHandlerMapping:197 - Mapped "{[/oauth/token],methods=[],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public org.springframework.http.ResponseEntity<org.springframework.security.oauth2.common.OAuth2AccessToken> org.springframework.security.oauth2.provider.endpoint.TokenEndpoint.getAccessToken(java.security.Principal,java.lang.String,java.util.Map<java.lang.String, java.lang.String>) 
```

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T16:30:43.253

我不认为 Sprint OAuth 实际上可以在Java Web 容器**之外工作。**

对于 Mule EE，您可以使用[Enterprise Security 包中的 OAuth2 提供程序](http://www.mulesoft.org/documentation/display/current/Creating+an+OAuth+2.0a+Web+Service+Provider)。

对于 Mule CE，您可以尝试运行嵌入式 Jetty 容器并在其后面使用 Mule 的 Servlet 端点。这应该提供一个 Spring OAuth 可以工作的环境。请参阅随 Mule 发行版提供的 Bookstore 示例以获取灵感。

# ios - IOS - 在后台执行有限长度的任务

> ID：16164897
> 
> 赞同：2
> 
> 时间：2013-04-23T08:47:51.613
> 
> 标签：ios, objective-c, sync, background-process, multitasking

我正在编写一个同步数据的 iOS 应用程序。当应用程序在后台时，我也需要运行同步服务。所以我在上传数据的地方写了这段代码。

```
 - (void)startAsyncUpload {
UIApplication *thisApplication = [UIApplication sharedApplication];

if([thisApplication respondsToSelector:@selector(beginBackgroundTaskWithExpirationHandler:)]) {
    bgTaskIdentifier_ = [thisApplication beginBackgroundTaskWithExpirationHandler:^(void)
                         {
                             [thisApplication endBackgroundTask:bgTaskIdentifier_];
                             bgTaskIdentifier_ = UIBackgroundTaskInvalid;
                         }];
}

[self multipartUpload];} 
```

它工作正常并在后台运行。但是我这里有个问题。我正在上传一个视频文件，当我的后台时间到期时，调用了处理程序并结束了任务。现在，当我再次来到前台时，上传恢复了，很好。但是现在当我再次进入后台时，它并没有恢复后台任务。

我知道为什么，主要是因为我之前结束了任务。但是有没有办法再次恢复任务，比如再次注册任务以进行后台运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T10:04:10.513

你确定你是第二次调用 beginBackgroundTaskWithExpirationHandler: 吗？

为 bgTaskIdentifier 创建一个 ivar/property，为 BOOL isUploading 创建一个。然后你可以写一个这样的方法

```
- (void)resumeOrStartAsyncLoad 
{
   if(!self.isUploading) 
   {
      [self multipartUpload];
      self.isUploading = TRUE;
   }

   if(self.isUploading && self.bgTaskIdentifier == UIBackgroundTaskInvalid) 
   {
      UIApplication *thisApplication = [UIApplication sharedApplication];
      self.bgTaskIdentifier = [thisApplication beginBackgroundTaskWithExpirationHandler:^(void) {
         [thisApplication endBackgroundTask:bgTaskIdentifier_];
         bgTaskIdentifier_ = UIBackgroundTaskInvalid;
      }];
   }
} 
```

# java - Java中的默认访问修饰符是什么？

> ID：16164902
> 
> 赞同：144
> 
> 时间：2013-04-23T08:48:01.433
> 
> 标签：java, access-modifiers

如果我没有明确说明方法或实例变量的默认访问修饰符是什么？

例如：

```
package flight.booking;

public class FlightLog
{
    private SpecificFlight flight;

    FlightLog(SpecificFlight flight)
    {
        this.flight = flight;
    }
} 
```

此构造函数的访问修饰符是受保护还是封装？同一个包中的其他类，也就是`flight.booking`，可以调用这个构造函数吗？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2013-04-23T08:52:26.073

来自 Java[文档](http://docs.oracle.com/javase/tutorial/java/javaOO/accesscontrol.html)

> 如果一个类没有修饰符（默认值，也称为包私有），则它仅在其自己的包中可见（包被命名为相关类的组 - 您将在后面的课程中了解它们。）

在 中`member level`，您也可以`no modifier`像使用顶级类一样使用 public 修饰符或 (package-private)，并且具有相同的含义。

你可以在这里阅读全文（[我最近写]的）：

*[http://codeinventions.blogspot.com/2014/09/default-access-modifier-in-java-or-no.html](http://codeinventions.blogspot.com/2014/09/default-access-modifier-in-java-or-no.html)*

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2015-07-14T17:18:27.053

从文档：

```
Access Levels
Modifier        Class    Package    Subclass    World
-----------------------------------------------------
public           Y        Y          Y           Y
protected        Y        Y          Y           N
(Default)        Y        Y          N           N
private          Y        N          N           N 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2013-12-23T23:00:10.553

这取决于上下文。

当它在一个类中时：

```
class example1 {

    int a = 10; // This is package-private (visible within package)

    void method1() // This is package-private as well.
    {
        -----
    }
} 
```

当它在界面中时：

```
interface example2 {

    int b = 10; // This is public and static.
    void method2(); // This is public and abstract
} 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2013-04-23T08:50:55.513

默认访问修饰符是 package-private - 仅在同一个包中可见

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2014-01-02T04:45:45.323

这是一个代码示例，应该可以为您总结一下...除了以下内容之外，还展示了您如何无法访问另一个包中的默认值，还有一件事。

如果子类在另一个包中，则默认在子类中是不可访问的，但如果子类在同一个包中，则它是可访问的。

```
package main;

public class ClassA {
    private int privateVar;
    public int publicVar;
    int defaultVar;
}

package main;

public class ClassB {
    public static void main(String[] args) {
        ClassA a = new ClassA();
        int v1 = a.publicVar;   // Works
        int v2 = a.defaultVar;  // Works
        int v3 = a.privateVar;  // Doesn't work

    }
}

package other;

public class ClassC {
    public static void main(String[] args) {
        ClassA a = new ClassA();
        int v1 = a.publicVar;   // Works
        int v2 = a.defaultVar;  // Doesn't work
        int v3 = a.privateVar;  // Doesn't work
    }
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-04-23T08:52:43.780

默认修饰符是`package`. 只有同一包中的代码才能调用此构造函数。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-10-21T11:13:02.143

是的，它在同一个包中可见。不允许该软件包之外的任何内容访问它。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-04-23T09:26:52.787

Default 访问修饰符是**包私有的**（即 DEFAULT），它只在同一个包中**可见**。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-04-23T09:03:05.863

您的构造函数的访问修饰符将是**package-private(default)**。正如您已将类声明为 public，它将在任何地方可见，但构造函数不会。您的构造函数将仅在其包中可见。

```
package flight.booking;

public class FlightLog // Public access modifier
{
    private SpecificFlight flight;

    FlightLog(SpecificFlight flight) // Default access modifier
    {
        this.flight = flight;
    }
} 
```

当您不在类中编写任何构造函数时，编译器会生成一个具有该类相同访问修饰符的默认构造函数。对于以下示例，编译器将生成一个带有**公共**访问修饰符（与类相同）的默认构造函数。

```
package flight.booking;

public class FlightLog // Public access modifier
{
    private SpecificFlight flight;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-04-21T04:59:48.860

不，您不能调用其他包的默认访问级别。但是您可以在包内访问。点击[此链接](http://vhariprasath.blogspot.in/2014/04/modifiers-in-java.html)了解更多详情。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-04-21T05:38:06.680

默认访问修饰符 - 如果一个类没有修饰符（默认值，也称为包私有），则它仅在其自己的包中可见（包是相关类的命名组）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-04-23T08:50:23.407

> 此构造函数的访问修饰符是受保护还是封装？

我认为你的构造函数访问修饰符隐含地是你的类的访问修饰符。由于您的类具有公共访问权限，因此构造函数将隐式具有公共访问权限

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-08-17T10:26:13.710

从一本名为*OCA Java SE 7 Programmer I*的书中：

> 未使用任何显式访问修饰符定义的类成员使用包可访问性（也称为默认可访问性）定义。具有包访问权限的成员只能被同一个包中定义的类和接口访问。

# facebook - /page_id/feed 在将提要发布到公共页面时出现错误 403

> ID：16164908
> 
> 赞同：0
> 
> 时间：2013-04-23T08:48:15.093
> 
> 标签：facebook, facebook-graph-api

根据最新的 Facebook 更新发布到另一个用户的 (B) 墙上，不允许使用 feed。根据我的研究，解决方法是如果会话 user_id (A) 与要更新墙的会话 (B) 不同，则使用“TO”参数。我试过了，它工作正常。唯一的问题是帖子是私密的，A 的朋友看不到。

当我使用 page_id 发布到公共页面时，相同的“TO”不起作用。我尝试使用 /page_id/feed 使用页面访问令牌，该令牌有效，但它代表页面发布到页面上。我想代表用户 (A) 在 B 的墙上发帖，这是一个公共页面。这是行不通的。

我也尝试过使用 app_id ，即使那不起作用。

总而言之，[https:](https://graph.facebook.com/) //graph.facebook.com/ {page_id}/feed?access_token={page_access_token}... 有效，但代表页面本身在页面上发布。我需要代表会话用户发布。

谢谢。

# php - domDocument 提取数据

> ID：16164915
> 
> 赞同：0
> 
> 时间：2013-04-23T08:48:32.683
> 
> 标签：php, domdocument

我有一个非常简单的 domDocumet 代码，但它有一个我无法解决的错误：

```
 function getTagXML($mensaje, $tagname){

          $dom = new domDocument('1.0', 'UTF-8');
          libxml_use_internal_errors(true);
          // load the html into the object ***/
          $dom->loadHTML($mensaje);

          //discard white space
          $dom->preserveWhiteSpace = false;
          $nodeList= $dom->getElementsByTagName($tagname); // here u use your desired tag     
          $node = $nodeList->item(0);

          $item = trim($node->nodeValue);
          libxml_clear_errors();

          return $item;
 } 
```

我得到了错误：

```
Notice: Trying to get property of non-object in line 82: 
```

第 82 行：

```
$item = trim($node->nodeValue); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T10:33:02.847

错误消息意味着 that`$nodeList`不是对象，这意味着`$dom->getElementsByTagName($tagname)`返回`NULL`.

根据[您的其他问题](https://stackoverflow.com/questions/16166296/domdocument-tag-not-found)，我假设发生这种情况是因为您的 XML 文档格式错误，即它缺少根节点。

# jquery - jQuery 移动呼叫页面

> ID：16164920
> 
> 赞同：0
> 
> 时间：2013-04-23T08:48:51.233
> 
> 标签：jquery, html, jquery-mobile

如何通过重新加载/刷新页面来调用页面？

逻辑：如果用户登录成功，页面将被移动到使用 HTML5 存储作为数据的管理员页面。

前任 ：`sessionStorage.setItem('MyID','12345');`

如果成功登录，字符串 12345 将被带到管理员页面。但是制作12345的过程是从登录表单中衍生出来的。

要读取我使用的数据：`sessionStorage.getItem('MyID')`在管理员页面上。

我遇到的问题是当jQuery mobile制作翻页时，管理员页面无法读取数据，尽管我必须在数据读取功能块中输入：`$(document).ready(function())`

但是如果我刷新/重新加载管理员页面，手动数据然后正确读取

我用了 ：

```
function callAdmin(){
   $.mobile.changePage("admin.html");
} 
```

如何使用刷新页面或重新加载页面进行调用页面？或者有没有其他方法可以将结果数据发送到管理员页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T08:53:56.167

您的主要问题是准备好文件。这是一个常见的 jQuery Mobile 问题，您无需刷新页面即可读取 sessionStorage。

您需要做的是使用正确的 jQuery Mobile 页面事件。文档就绪应该只与基本的 jQuery 一起使用。对于 jQuery Mobile，它通常会在页面成功加载到 DOM 之前触发。

如果您想了解更多关于此的信息，请阅读我的其他答案：**[jQuery Mobile: document ready vs page events](https://stackoverflow.com/a/14469041/1848600)**

**在jQuery**中学习的第一件事是调用**$(document).ready()**函数中的代码，以便在加载 DOM 后立即执行所有内容。但是，在**jQuery Mobile**中，Ajax 用于在您导航时将每个页面的内容加载到 DOM 中。因为这个**$(document).ready()**将在您的第一页加载之前触发，并且用于页面操作的每个代码都将在页面刷新后执行。这可能是一个非常微妙的错误。在某些系统上，它可能看起来工作正常，但在其他系统上，它可能会导致出现不稳定、难以重复的怪异现象。

经典的 jQuery 语法：

```
$(document).ready() { 

}); 
```

为了解决这个问题（相信我，这是个问题）**jQuery Mobile**开发人员创建了页面事件。简而言之，页面事件是在页面执行的特定点触发的事件。其中一个页面事件是**pageinit**事件，我们可以这样使用它：

```
$(document).on('pageinit', function(){

}); 
```

我们可以更进一步，使用页面 id 代替文档选择器。假设我们有一个带有 id **index**的 jQuery Mobile 页面：

```
<div data-role="page" id="index">
    <div data-theme="a" data-role="header">
        <h3>
            First Page
        </h3>
        <a href="#second" class="ui-btn-right">Next</a>
    </div>

    <div data-role="content">
        <a href="#" data-role="button" id="test-button">Test button</a>
    </div>

    <div data-theme="a" data-role="footer" data-position="fixed">

    </div>
</div> 
```

要执行仅可用于索引页面的代码，我们可以使用以下语法：

```
$('#index').on('pageinit') {

}); 
```

# c# - Read txt file from line to line to list?

> ID：16164923
> 
> 赞同：-6
> 
> 时间：2013-04-23T08:48:56.293
> 
> 标签：c#, .net, text-files

need some function that will return List with lines of txt file (ex. from 10 line to 25 line). Any solutions? All my tries met with failure.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-23T08:51:04.580

You can use LINQ and [File.ReadLines](http://msdn.microsoft.com/en-us/library/dd383503.aspx) which enumerates over file lines (internally it uses [StreamReader](http://msdn.microsoft.com/en-us/library/system.io.streamreader.aspx)):

```
List<string> lines = File.ReadLines(path).ToList(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-23T08:51:37.513

You could do:

```
List<string> fileLines = new List<string>();

using (var reader = new StreamReader(fileName))
{
    string line;
    while ((line = r.ReadLine()) != null)
    {
       fileLines.Add(line);
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-23T08:55:04.193

```
// Retrieve 10 lines from Somefile.txt, starting from line 1
string filePath = "C:\\Somefile.txt";
int startLine = 1;
int lineCount = 10;
var fileLines = System.IO.File.ReadAllLines(filePath)
                .Skip((startLine-1))
                .Take(lineCount); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T08:56:44.680

```
List<string> lines = File.ReadLines().ToList();
for(int i = 0; i < lines.Count; i++){
if( i >= startline && i <= endline) LinesFromStartToEnd.Add( lines[i] );// same string list
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T09:14:01.943

If your file isn't too large you can do it with linq:

```
int start = 10;
int end = 25;    
List<string> lines = File.ReadLines(path).Skip(start - 1).Take(end - start + 1).ToList(); 
```

# php - DB2 连接失败 php

> ID：16164924
> 
> 赞同：0
> 
> 时间：2013-04-23T08:49:03.893
> 
> 标签：php, db2

我正在尝试通过 PHP 连接到远程 DB2。但是有一些问题。我已经安装了 IBM 应用程序开发者客户端。

phpinfo() 输出：

```
    IBM DB2, Cloudscape and Apache Derby support    enabled
        Module release  1.9.4
        Module revision $Revision: 327944 $
        Binary data mode (ibm_db2.binmode)  DB2_BINARY 

```

然后，我有一个看起来像这样的 php 文件：

```
    $database = 'MyDB';
        $user = 'db2inst1';
        $password = 'mypassword';
        $hostname = '1.1.1.1';
        $port = 50000;

        $conn_string = "DRIVER={IBM DB2 ODBC  DRIVER};DATABASE=$database;PORT=$port;HOSTNAME=$hostname;".
        "PROTOCOL=TCPIP;UID=$user;PWD=$password;";

        $conn = db2_connect($conn_string, '', '');
        if ($conn) {
            echo "connection to $database succeeded";
        } else {
            echo "connection to $database failed";
            echo db2_conn_errormsg();
        } 

```

并试图执行这个文件，我有“连接到 MyDB 失败”，并且没有来自 db2_conn_errormsg() 的可见响应，这实际上让我感到困惑

不幸的是，我无法直接访问带有数据库的远程服务器。但是几个月前，当我使用其他客户端时，我成功地连接到了这个数据库。但是那个时候我不需要安装 IBM ADCL。这就是为什么我可以猜测问题出在这一边。但即使是这样，我也无法修复它。

抱歉，如果我在 stackoverflow 上重复了一些问题，但不幸的是，我发现的所有答案对我来说都没用。

我正在使用 Apache 2.2 和 PHP 5.4。希望你能帮忙。

感谢您的回复！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T10:11:11.450

你确定你有连接到服务器吗？端口、服务器、防火墙规则、用户名、密码、数据库名称是否正确？

您收到的 SQL 代码是什么。尝试从 PHP 获取 SQL 代码，“连接到 xx 失败”是您自己的代码，因此无法帮助您。

您是否安装了应用程序开发客户端？您使用的是哪个 DB2 版本？ADCL 是旧的，用于 DB2 8。从 DB2 9.7 开始，客户端有不同的名称，我认为您需要 IBM 数据服务器客户端才能编译 php 模块。有关更多信息，请查看此网站：[http ://www-01.ibm.com/support/docview.wss?uid=swg27016878](http://www-01.ibm.com/support/docview.wss?uid=swg27016878)

我认为您必须使用 db2 客户端对数据库服务器（节点）和本地计算机中的数据库进行编目。您的 PHP 代码似乎使用了 ODBC 驱动程序，并且必须在本地进行配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T13:00:23.417

您的连接字符串看起来像一个 ODBC 连接，其中 PHP 中的 db2_connect 函数需要：-

```
DATABASE=database;HOSTNAME=hostname;PORT=port;PROTOCOL=TCPIP;UID=username;PWD=password; 
```

它在[PHP 网页上。](http://php.net/manual/en/function.db2-connect.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-30T00:31:46.120

我从来没有让 ibm_db2 或 pdo_ibm 在遥控器上工作。如果 DB2 和 Apache 在同一台机器上（如 iSeries），它们就可以工作，但如果主机连接到远程 DB2 就不行。

如果您阅读每个的 Doctrine2 PHP 驱动程序，您会发现如果主机不是“localhost”或“127.0.0.1”，它们会重定向到 ODBC。

这段代码对我有用

```
<?php
if (!$db = odbc_connect ( "AS400", $user, $password) )
    echo 'error!';

$result = odbc_exec($db, "select count(*) from $table");
while (odbc_fetch_row($result)) {
    var_dump($result);
    print_r($result);
    echo "\n";
    echo odbc_result($result, 1)."\n";
}

odbc_close($db); 
```

AS400 是 ODBC 中定义的 DSN 名称。

# exponent - 使用带 bc 的小数指数

> ID：16164925
> 
> 赞同：20
> 
> 时间：2013-04-23T08:49:06.840
> 
> 标签：exponent, sqrt, bc

[bc](https://en.wikipedia.org/wiki/Bc_%28programming_language%29)，一个Linux命令行计算器，精通计算

```
3^2
9 
```

即使是负指数也不会混淆它：

```
3^-2
0.11111 
```

然而遇到它却失败了

```
9^0.5
Runtime warning (func=(main), adr=8): non-zero scale in exponent 
```

怎么可能 bc 不能处理这个？

错误信息是什么意思？

* * *

是的，我已经阅读[了这个](https://www.linuxquestions.org/questions/programming-9/bc-and-exponents-containing-decimals-and-fractions-755260/)以及那里给出的解决方案：

```
e(0.5*l(9))
2.99999999999999999998 
```

是的，这不好，因为精度损失和

> 计算器应该解决表达式。你不应该让计算器的生活更轻松，它应该是相反的......

* * *

此*功能*旨在鼓励用户编写自己的函数。使其成为一个独特的计算器，需要*用户定义的函数*来计算平方根。

为切线或余切线编写函数并没有真正打扰我，因为它看起来很简单给定`s(x)`和`c(x)`。但在我看来，通过用户定义的函数计算平方根有点过分了。

如果那里有 Python，为什么有人使用 bc？速度？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2017-08-28T08:40:48.570

在 bc 中，b 必须是 a ^ b 中的整数。但是，您可以像这样将自己的函数添加到 bc：

创建一个文件 ~/.bcrc，向其中添加以下函数：

```
define pow(a, b) {
    if (scale(b) == 0) {
        return a ^ b;
    }
    return e(b*l(a));
} 
```

然后您可以按如下方式启动 bc：

```
bc ~/.bcrc -l 
```

所以你可以使用函数 pow 来做这样的计算。

[在这里](https://github.com/idealvin/bc)查看更多，您可以为 bc 添加更多功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T09:05:51.630

bc 是“数学扩展”未提供的非常基本且更复杂的功能，必须在语言本身中实现：它拥有您需要做的一切；特别是“权力”是一个常见的例子，即使在[wikipedia](http://en.wikipedia.org/wiki/Bc_programming_language#A_.27Power.27_function_in_POSIX_bc)上也是如此。

但是您可能也有兴趣在SO 上阅读例如[这个答案。](https://stackoverflow.com/questions/2882706/how-can-i-write-a-power-function-myself)

# c# - 对于格式为 HH\mm 的时间部分，将字符串解析为 DateTime 始终为 00:00

> ID：16164927
> 
> 赞同：0
> 
> 时间：2013-04-23T08:49:09.370
> 
> 标签：c#, .net, parsing, datetime, datetime-parsing

我正在使用此函数从*XML解析日期和时间：*

```
DateTime.ParseExact(timeEndString, "yyyyMMddHHmm", CultureInfo.InvariantCulture); 
```

除非时间是 00:00，否则一切正常。在这种情况下，我只会得到没有时间的约会。有什么方法可以防止在解析日期时间时省略 0000 时间？

UPD：感谢有用的评论。我发现问题出在代码的完全不同的部分，但不在解析部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T09:02:03.367

如果您的意思是 XML 日期值可以有 2 种格式，您可以尝试以下操作：

```
try
{
    //...
    DateTime.ParseExact(timeEndString, "yyyyMMddHHmm", CultureInfo.InvariantCulture);
}
catch (Exception)
{
    //...
    DateTime.ParseExact(timeEndString, "yyyyMMdd", CultureInfo.InvariantCulture);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T08:56:50.780

只需包含额外的代码逻辑来检查结果长度。如果它太短，您可能会认为零被剥离，那么您只需将零添加进去。

# objective-c - 如何使用 ARC 将块实例化为实例变量？

> ID：16164928
> 
> 赞同：2
> 
> 时间：2013-04-23T08:49:11.783
> 
> 标签：objective-c, objective-c-blocks

做这样的事情要做什么？

```
void (^)(void) *someBlock = ^{
  //some code
}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T09:06:04.730

德米特里的回答完全正确。将块语法视为 C 函数声明：

```
// C function -> <return type> <function name> (<arguments>)
void someFunction(void) 
{
  // do something
}

// block -> <return type> (^<block variable name>) (<arguments>)
void (^someBlock)(void) = ^{
    // do something
}; 
```

另一个例子：

```
// C function
int sum (int a, int b)
{
    return a + b;
}

// block
int (^sum)(int, int) = ^(int a, int b) {
    return a + b;
}; 
```

因此，只需将块语法视为 C 函数声明：首先是返回类型`int`，然后是块变量的名称，`(^sum)`然后是参数类型列表`(int, int)`。

但是，如果您的应用程序中经常需要某种类型的块，请使用 typedef：

```
typedef int (^MySumBlock)(int, int); 
```

现在您可以创建以下`MySumBlock`类型的变量：

```
MySumBlock debugSumBlock = ^(int a, int b) {
    NSLog(@"Adding %i and %i", a, b);
    return a + b;
};

MySumBlock normalSumBlock = ^(int a, int b) {
    return a + b;
}; 
```

希望有帮助:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T08:53:28.297

只是块语法

```
void (^someBlock)(void) = ^{
     //some code
}; 
```

# ole - ABAP OLE - 打开受密码保护的 Excel 工作簿

> ID：16164930
> 
> 赞同：3
> 
> 时间：2013-04-23T08:49:16.727
> 
> 标签：ole, abap

我正在尝试使用 SAP ABAP OLE OBJECT 打开受密码保护的 excel 文件，如下所示：

```
DATA: lt_excel_line(4096) OCCURS 10 WITH HEADER LINE.
DATA: app       TYPE ole2_object,
      workbook  TYPE ole2_object,
      worksheet TYPE ole2_object.

CREATE OBJECT app 'EXCEL.APPLICATION'.
SET PROPERTY OF app 'VISIBLE' = 0.

CALL METHOD OF app 'WORKBOOKS' = workbook.

CALL METHOD OF workbook 'OPEN'
  EXPORTING
  #1 = '<filename>'
  #5 = '<password>'. 
```

文件名和密码绝对正确，下面的 VBA 代码按要求打开文件没问题：

```
Dim wb1 As Workbook
Set wb1 = Workbooks.Open Filename:="<filename>", Password:="<password>") 
```

但是 ABAP 代码总是返回 sy-subrc = 2。有人知道会发生什么吗？或者我还能尝试什么？感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T09:56:32.720

I think the problem is with the parameters being positional only (just a guess), as the SAP GUI automation does not support parameter names. There are 3 parameters between `Filename` and `Password`, so you numbered them correctly, but I guess the SAP GUI automation controller does not see it that way.

I replicated your problem and got it working as follows:

```
CALL METHOD OF workbook 'OPEN' = document
  EXPORTING
  #1 = '<filename>'
  #2 = 0              "UpdateLinks
  #3 = 0              "ReadOnly
  #4 = 1              "Format
  #5 = '<password>'. 
```

Here I am explicitly passing the parameters `UpdateLinks`, `ReadOnly` and `Format`.

I tested it first in VBA. It seems `Format` (#4) must be set to true. I don't know what that does.

Remember to set the document handle as a return from this call as I do here, otherwise you don't have a reference to it!

# arduino - Arduino UNO 模拟读取总是返回 1023

> ID：16164933
> 
> 赞同：1
> 
> 时间：2013-04-23T08:49:30.870
> 
> 标签：arduino, atmel

所以我的问题正如标题所说：Arduino UNO analogRead 总是返回 1023。

但是当我在 Arduino Mega 2650 中烧写相同的草图时，一切都像魅力一样。

我曾尝试更改 UNO 上的 Atmel 芯片，尝试了其中的 3 个（ATMEGA328P-PU），但没有任何变化。

我正在尝试计算来自霍尔效应传感器的信号并将计数显示在 7 段显示器上。

这是代码：

```
#include "SevSeg.h"

SevSeg sevseg;
volatile int rpmcount;

void setup() {
  Serial.begin(9600);
  pinMode(2,INPUT_PULLUP);
  rpmcount = 0;
  sevseg.Begin(1,3,4,5,6,7,8,9,10,11,12,13);
}
int border=15;

void loop() {
  int tmp=0;
  tmp = analogRead(0);
  if(!digitalRead(2))rpmcount=0;
  Serial.println(tmp,DEC);
  if(tmp<=border && res >border){   
    rpmcount++;
    if(rpmcount>9999)rpmcount=0;
  } 

  res=tmp;
  sevseg.NewNum(rpmcount,(byte) 0);
  sevseg.PrintOutput();
} 
```

任何帮助将非常感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T07:59:47.157

这听起来好像你在 ADC 引脚上启用了内部上拉电阻。

通用清单：

*   ACSR 中的 ACD 位为 0（比较器使能）
*   ADMUX 中的 MUX 位设置正确
*   选择了正确的 AREF
*   ADC 引脚设置为输入
*   内部上拉电阻被取消选择

# android - 电子商务 Android 未显示在分析中

> ID：16164937
> 
> 赞同：5
> 
> 时间：2013-04-23T08:49:36.717
> 
> 标签：android, google-analytics, e-commerce

在阅读了所有线程之后，我仍然没有弄清楚为什么我的 Android 应用程序没有将电子商务值发送到分析。（或者可能确实如此，但未显示）我确实在 GA 中激活了电子商务，我使用 v2 并在 orderComplete 上添加了以下代码：

```
GoogleAnalytics ga = GoogleAnalytics.getInstance(ctx); 

Transaction cardTransaction = new Transaction.Builder(
  String.valueOf(order.getOrderId()),                   // (String) Transaction Id, should be unique. 
  orderTotal                                            // (long) Order total (in micros)
  .setAffiliation(cardName)                             // (String) Affiliation
  .setTotalTaxInMicros(0)                               // (long) Total tax (in micros)
  .setShippingCostInMicros(0)                           // (long) Total shipping cost (in micros)
  .setCurrencyCode("EUR")                               // (String) Setting the correct currency
  .build();

cardTransaction.addItem(new Item.Builder(
  caption,                                              // (String) Product SKU (stock-keeping unit)
  productName,                                          // (String) Product name
  price,                                                // (long) Product price (in micros)
  quantity)                                             // (long) Product quantity
  .setProductCategory(productCategorie)                     // (String) Product category 
  .build());

Tracker tracker = ga.getTracker(R.string.googleAnalyticsKey);

tracker.sendTransaction(cardTransaction); // Send the transaction.
GAServiceManager.getInstance().dispatch(); 
```

我记录了所有值，它们是正确的并且格式正确。

谁能解释我在哪里犯了错误？

# c# - 如何使用 c# 在 winform 中获取 USB 列表？

> ID：16164939
> 
> 赞同：0
> 
> 时间：2013-04-23T08:49:42.330
> 
> 标签：c#, winforms, usb, usb-drive

我已尝试使用此代码将 USB 设备连接到计算机。这是代码：

```
 foreach (DriveInfo drive in DriveInfo.GetDrives())
 {
     if (drive.DriveType == DriveType.Removable)
     {
        cmbUSB.Items.Add(drive.Name);
     }
 } 
```

cmbusb 是一个组合框..我在这里得到这个：

```
 E:/
 G:/ 
```

但没有获得设备名称，例如：

```
 E:/Insforia 
```

像这样的东西，我怎么能得到这个？有可能得到这个吗？请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T08:53:39.077

要获取 E:/ 的 DeviceName，请尝试此操作。

```
DriveInfo driveInfo = new DriveInfo("E"); 
if(driveInfo.IsReady) 
{ 
    string deviceName = driveInfo.VolumeLabel; 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T08:53:19.453

我相信您正在寻找[VolumeLabel](http://msdn.microsoft.com/en-us/library/system.io.driveinfo.volumelabel.aspx)，请尝试：

> 标签长度由操作系统决定。例如，NTFS 允许卷标最长为 32 个字符。请注意，null 是有效的 VolumeLabel。

```
foreach (DriveInfo drive in DriveInfo.GetDrives())
 {
     if (drive.DriveType == DriveType.Removable)
     {
        if (drive.IsReady)
                 cmbUSB.Items.Add(drive.Name + "-" + drive.VolumeLabel);
                                                     //^^^^^^^^^^^^^^^^
                                                     //here   
     }
 } 
```

# go - Project Euler 16 - 帮助解决它

> ID：16164944
> 
> 赞同：3
> 
> 时间：2013-04-23T08:50:06.357
> 
> 标签：go

我正在解决[Project Euler 问题 16](http://projecteuler.net/problem=16 "欧拉计划：第 16 题")，我最终得到了一个可以在逻辑上解决它的代码，但由于我认为它溢出或其他原因而无法处理？我尝试用 int64 代替 int，但它只打印 0,0。如果我将电源更改为低于 30 的任何值，它可以工作，但高于 30 它不起作用，谁能指出我的错误？我相信它无法计算 2^1000。

```
// PE_16 project main.go
package main

import (
    "fmt"
)

func power(x, y int) int {
    var pow int
    var final int
    final = 1
    for pow = 1; pow <= y; pow++ {
        final = final * x
    }
    return final
}

func main() {
    var stp int
    var sumfdigits int
    var u, t, h, th, tth, l int
    stp = power(2,1000)
    fmt.Println(stp)
    u = stp / 1 % 10
    t = stp / 10 % 10
    h = stp / 100 % 10
    th = stp / 1000 % 10
    tth = stp / 10000 % 10
    l = stp / 100000 % 10
    sumfdigits = u + t + h + th + tth + l
    fmt.Println(sumfdigits)
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-23T08:59:54.383

您解决此问题的方法需要大小高达 1000 位的精确整数数学。但是您使用`int`的是 32 位或 64 位。[math/big.Int](http://golang.org/pkg/math/big/#Int)可以处理这样的任务。我故意不提供现成的解决方案，`big.Int`因为我假设您的目标是自己学习，我相信这是 Project Euler 的意图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T18:38:22.740

正如@jnml 所指出的，`int`s 不够大；如果你想在 Go 中计算 2^1000，`big.Int`这里 s 是一个不错的选择。请注意，它`math/big`提供了[Exp()](http://golang.org/pkg/math/big/#Int.Exp)方法，该方法比将`power`函数转换为`big.Int`s 更容易使用。

大约一年前，我解决了一些 Project Euler 问题，在 Go 中完成这些问题以了解该语言。我不喜欢需要`big.Int`s 的那些，它们在 Go 中不太容易使用。对于这个，我“作弊”并在一行 Ruby 中做到了：

*删除是因为我记得展示一个可行的解决方案被认为是不好的形式，即使是用不同的语言。*

无论如何，我的 Ruby 示例展示了我从 Go 的 s 中学到的另一件事：有时[将它们转换为字符串](http://golang.org/pkg/math/big/#Int.String)并使用该字符串比使用它本身`big.Int`更容易。这个问题让我印象深刻，就是其中之一。`big.Int`

将我的 Ruby 算法转换为 Go，我只`big.Int`在一行上使用 s，然后很容易使用字符串并在几行代码中得到答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T19:17:25.173

你不需要使用`math/big`. 下面是一个小学生数学加倍十进制数的方法作为提示！

`xs`以最低有效的第一顺序保存十进制数字。传入一个指向数字 ( `pxs`) 的指针，因为切片可能需要变得更大。

```
func double(pxs *[]int) {
    xs := *pxs
    carry := 0
    for i, x := range xs {
        n := x*2 + carry
        if n >= 10 {
            carry = 1
            n -= 10
        } else {
            carry = 0
        }
        xs[i] = n
    }
    if carry != 0 {
        *pxs = append(xs, carry)
    }
} 
```

# java - 调试HashMap显示递归entrySet？它是什么？

> ID：16164949
> 
> 赞同：4
> 
> 时间：2013-04-23T08:50:19.203
> 
> 标签：java, hashmap

我正在使用`HashMap<String,Serializable>`并且在调试时我递归地看到以下内容。这意味着什么？为什么会这样？

![在此处输入图像描述](https://i.stack.imgur.com/RmE1A.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T09:00:04.447

`HashMap$EntrySet``this$0`是一个内部类，它有一个显式引用，调用`HashMap`. 并且有一个引用它`HashMap`的字段。`private transient Set<Map.Entry<K,V>> entrySet`所以，只是通常的循环引用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-23T08:55:06.540

该`HashMap`实例有一个`entrySet`类型为 的字段`HashMap$EntrySet`。由于`EntrySet`该类是 的内部类`HashMap`，因此它具有对包含实例 ( `this$0`) 的隐式引用。

这是正常的，并且是`EntrySet`实例访问包含`HashMap`实例所必需的。

# datetime - 将日期时间分成 JSF2 中的 2 个字段

> ID：16164953
> 
> 赞同：0
> 
> 时间：2013-04-23T08:50:28.367
> 
> 标签：datetime, jsf-2, frontend

我正在使用 JSF2 为我的应用程序实现前端

我有 2 个字段：

*   日期 (d/m/yyyy)
*   时间 (h:mm)

托管 bean 中的相同字段“生日”的 2 个文本字段在这里

我为视图编写了这段代码：

```
<h:inputText value="#{bean.birthday}">
    <f:convertDateTime pattern="d/M/yyyy" />
</h:inputText>
<h:inputText value="#{bean.birthday}">
    <f:convertDateTime pattern="h:mm" />
</h:inputText> 
```

这当然不起作用，因为该字段设置了两次，一次用于日期，另一次用于时间，这会清除第一次的信息

如果这里使用了任何模式，请帮忙

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T11:59:24.270

您可以在服务器上使用并`bean.birthdayDate`智能*合并*它们...`bean.birthdayTime`

 *您也可以使用 primefaces *calendar + time* [Calendar - Time](http://primefaces.org/showcase/ui/calendarTime.jsf)或一些 jquery 插件*

# php - 提交时未存储PHP表单数据？

> ID：16164963
> 
> 赞同：-1
> 
> 时间：2013-04-23T08:50:44.677
> 
> 标签：php, mysql, forms

我正在开发一个同义词/别名管理器数据库，用户可以在其中存储他们认为正确的关联。假设用户输入“rabbit”并且没有找到同义词或别名。然后，用户决定将“rabbit”与“bunny”相关联并将其存储到数据库中。任何时候任何其他用户键入“bunny”，都会出现“rabbit”的结果。但是，我正在尝试实现一个轮询系统，询问用户他们是否认为关联是正确的。如果他们认为“兔子”适合“兔子”，那么他们投票赞成，否则反对。这就是我卡住的地方。一旦我加载民意调查并按下提交，一切都消失了，没有任何东西被发送到数据库。代码如下：

```
$query = "SELECT * from searchtestdb where engname in ( SELECT synonyms.synonym  FROM words  LEFT JOIN synonyms ON synonyms.word_id = words.word_id WHERE word LIKE '%$searchBox%') "; // Query for animals in db
        $query = mysql_query($query);

        if(mysql_num_rows($query) == 0)
        {
            echo "<h2>Aliases: </h2>";
            echo "Sorry, but we can not find an alias to match your query.";
            echo "<br> ";

        }
        else        
        {
            echo "<h2> Results using Alias: </h2>";
            while($result = mysql_fetch_array($query)) 
            {
                $query2 = "SELECT * from searchtestdb where engname LIKE '%".$result['engname']."%';";
                $result2 = mysql_query($query2);
                while($row = mysql_fetch_array($result2)) 
                {
                    print "<h4>Latin Name: </h4> ";
                    echo $row["latname"];
                    echo "<br> "; 
                    print"<h4>English Name:</h4> ";
                    echo $row["engname"];
                    echo "<br>"; 
                    print "<h4> Species: </h4> ";
                    echo $row["spectype"];
                    print "<h4>Characteristics: </h4> ";
                    echo $row["charc1"];
                    echo "<br>"; 
                    echo $row["charc2"];
                    echo "<br>"; 
                    echo $row["charc3"];
                    echo "<br>"; 

                }

            }
            $self = $_SERVER['PHP_SELF'];
            print "<form method='post' action='$self' >\n";
            print "<h4>Alias Association Correct? : </h4>";
            print "<p>" . 
                  "<input type='radio' name='vote' id='vote' value='1' /> \n" .
                  "Yes" .
                  "<input type='radio' name='vote' id='vote' value='2' /> \n" .
                  "No" .
                  "</p> \n" .
                  "<p>" .
                  "<input type='submit'name='submitVote' value='Submit' />" .
                  "\n </p> \n" .
                  "</form> \n" .
                  $vote=htmlentities($_POST['vote']);
                  echo $vote;

            mysql_connect(----------------------) or die(mysql_error()); 
            mysql_select_db("-----------") or die(mysql_error());       

            if($vote == 1)
            { 
                mysql_query("INSERT INTO items(yes, uNo, word_id) VALUES ('0', '0', bunny');");
                mysql_query("UPDATE items SET yes=yes+1 WHERE word_id='bunny';"); 
                echo 'Thanks for voting Yes!'; 
            } 
            if($vote == 2)
            {   mysql_query("INSERT INTO items(word_id) VALUES ('".$result['engname']."'') ");
                mysql_query("UPDATE items SET uNo=Uno+1 WHERE word_id='".$result['engname']."'");
                echo "changos";
            }

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T10:05:02.997

简而言之，我犯了一个小错误：

```
$self = $_SERVER['PHP_SELF']; 
```

应该

```
$self = $_SERVER['POST']; 
```

不管怎么说，还是要谢谢你。

# android - Android 和 Google Drive 实时 API

> ID：16164966
> 
> 赞同：0
> 
> 时间：2013-04-23T08:50:52.847
> 
> 标签：android, google-drive-api

在 Google Drive 上有一个 30MB 的 palin 文本文件。
是否可以使用 Google Drive 实时 API 在文件末尾添加一行（无需将其下载到设备，然后将其上传回 GDrive）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T11:05:12.690

我们目前不允许对文件内容进行差异更新。您需要下载文件，添加一行并重新上传。

# php - PHP Composer 找不到任何类

> ID：16164971
> 
> 赞同：0
> 
> 时间：2013-04-23T08:51:00.597
> 
> 标签：php, permissions, file-permissions, composer-php, windows-server-2012

我们有一台在 AWS 上运行 Windows Server 2012 的服务器。我们使用 composer 来管理包，并`composer [install/update]`在主管理员帐户上运行命令。我们以用户身份运行我们的脚本`web`。

一切正常，但我正在处理的新脚本找不到任何类。事实证明，composer 包文件夹，只有管理员用户设置的权限，web 用户没有读取文件夹的权限。

这以前从来都不是问题，作曲家应该应用这样的权限吗？有没有办法配置作曲家以允许我们的`web`用户对包拥有 R/W 权限？

每次都必须手动设置权限似乎是一种黑客/解决方法。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T09:14:24.480

使用权限管理，您通常有两个选项，或者您以正确的用户 (web) 身份运行命令，以便文件归它所有并且您没有问题，或者您必须在默认情况下不可读时修复文件权限. 我真的没有办法解决这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-01T09:04:30.690

如果有人仍然感兴趣，问题已在此处修复[https://github.com/composer/composer/issues/1714#issuecomment-19693312](https://github.com/composer/composer/issues/1714#issuecomment-19693312)，运行`composer self-update`将解决问题。

# linux - Brother QL-720NW，使用 CUPS 和 Ubuntu 打印标签

> ID：16164974
> 
> 赞同：8
> 
> 时间：2013-04-23T08:51:03.320
> 
> 标签：linux, ubuntu, ubuntu-12.10, cups

我正在尝试让我的 Brother QL-720NW 标签打印机在 Ubuntu 服务器上工作。我将简要描述到目前为止的过程，以及我遇到的问题。

首先我从 Brothers 网站安装了 CUPS 和[LPR 以及 cupswrapper 驱动程序](http://welcome.solutions.brother.com/bsc/public_s/id/linux/en/index.html)，现在我的 QL-720NW 出现在 CUPS 网络界面中。我设置了默认介质尺寸以适合我的标签（29x90mm）。我在 QL-720NW 上单击“测试打印页面”，它显示*“正在向打印机发送数据”。*几秒钟，然后消失并将状态更改为*Idle, Accepting Jobs, Not Shared, Server Default*。但是我的打印机什么也没做，甚至连 LED 灯都没有闪烁。

我的 cups/error_log 看起来像这样。我搜索了*AddProfile failed*错误，发现有人暗示这是 Ubuntu 12.10 中的一个错误，但我也读到 Arch 用户也有同样的错误，所以我不确定。根据这个站点，[Uknown 指令 SystemGroup 错误只是一个无害的错误。](https://bugs.launchpad.net/ubuntu/+source/cups/+bug/1088448)

```
E [23/Apr/2013:12:20:47 +0200] Unknown directive SystemGroup on line 18 of /etc/cups/cupsd.conf.
W [23/Apr/2013:12:20:47 +0200] AddProfile failed: org.freedesktop.DBus.Error.UnknownMethod:No such interface `org.freedesktop.ColorManager' on object at path /org/freedesktop/ColorManager/devices/cups_QL_720NW 
```

当我尝试使用**lp test.txt打印测试页或文本文件后运行****lpstat -tl**时，它说它正在向打印机发送数据。但是打印机什么也不做。

 **```
# lpstat -tl
scheduler is running
system default destination: QL-720NW
device for QL-720NW: usb://Brother/QL-720NW?serial=000K2Z658058
QL-720NW accepting requests since Tue 23 Apr 2013 12:45:56 PM CEST
printer QL-720NW is idle.  enabled since Tue 23 Apr 2013 12:45:56 PM CEST
    Sending data to printer. 
```

那么，有没有人有任何建议从这里去哪里？是否有任何其他日志文件可以让我知道什么是错误的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-31T07:27:42.427

我能够让**64 位 Ubuntu**与官方**QL-720NW**驱动程序一起使用他们的解决方法：

> [http://welcome.solutions.brother.com/bsc/public_s/id/linux/en/faq_prn.html#f00081](http://welcome.solutions.brother.com/bsc/public_s/id/linux/en/faq_prn.html#f00081)

```
apt-get install cups cups-bsd
apt-get install ia32-libs
dpkg -i --force-architecture ql720nwlpr-1.0.1-1.i386.deb
dpkg -i --force-architecture ql720nwcupswrapper-1.0.1-1.i386.deb
cp /usr/lib/cups/filter/brlpdwrapper* /usr/lib64/cups/filter
cp /usr/lib/cups/filter/brlpdwrapper* /usr/lib64/cups/filter 
```

我的 Linux 发行版（uname -a）：

> Linux 3.2.0-40-virtual #64-Ubuntu SMP Mon Mar 25 21:42:18 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-21T18:08:26.227

我终于把它打印在我的 Ubuntu 系统上。问题似乎是兄弟的驱动程序不兼容 64 位，而我使用的是 64 位版本的 Ubuntu。

在从@sampi 得知他让它在 Debian 上工作之后，我首先尝试了 Debian。安装驱动程序时，我收到一条错误消息，我在 Ubuntu 上没有收到，提示 32/64 位问题。因此，在安装 ia32-libs 软件包后，它可以在 Debian 上运行。然后我尝试在我的服务器上安装 32 位版本的 Ubuntu，现在打印机确实可以工作了。

但我只能让打印机通过 wifi 工作（在 Debian 和 Ubuntu 上）。USB电缆没有成功，但这对我来说不是问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-27T10:27:59.060

自 9 月以来，我一直在 Debian 上使用 QL-720NW。首先使用 QL-580N 驱动程序，然后在发布后使​​用 QL-720NW 驱动程序。在购买打印机之前，我确实联系了兄弟支持，他们得到了非常有帮助的回复，告诉我该打印机可以作为网络打印机使用旧产品的驱动程序，但不能通过 USB。

鉴于您没有明确声明您需要通过 USB 打印，我建议您尝试将打印机连接到您的网络并重新配置杯子以使用该连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-12T14:17:25.547

FWIW：在 Debian 测试中，我刚刚安装了 Brother 站点的驱动程序（两者都是 1.0.1 版）和通过 USB 打印的 QL-720nw，没有任何问题。我什至不需要强制任何东西（我已经安装了 multiarch 来支持其他愚蠢的 32 位软件），也没有使用任何解决方法。我还没有尝试在网络上使用它。**

# sql - 多个 n:m 子句

> ID：16164977
> 
> 赞同：1
> 
> 时间：2013-04-23T08:51:05.560
> 
> 标签：sql, group-by, having-clause

我正在尝试寻找具有特定规格的产品。由于规格的复杂组合，我有另一个表是：m 与另一个表的关系。

```
product
id | other data ...
---+---------------
1  | bike
2  | bus
3  | car

product_spec
product_id | spec_id
-----------+---------------
1          | 1
1          | 2
1          | 3
2          | 1
2          | 3
2          | 4
3          | 2
3          | 4 
```

现在我需要找到具有特定规格的产品。**如果我有一个产品**必须具备的规格列表，这会很好地工作：

```
SELECT p.id FROM product p, product_spec s
WHERE p.id = s.product_id AND s.spec_id IN (1, 2, 3)
GROUP BY p.id HAVING COUNT(p.id) = 3 
```

（其中 3 是产品必须具有的规格数量）给出产品 1

```
SELECT p.id FROM product p, product_spec s
WHERE p.id = s.product_id AND s.spec_id IN (1, 3)
GROUP BY p.id HAVING COUNT(p.id) = 2 
```

给出产品 1 和 2。到目前为止一切顺利。现在麻烦来了：

如果我想获得所有具有规格 1**且**具有规格 2 或 4 的**产品怎么办？**

```
SELECT p.id FROM product p, product_spec s
WHERE p.id = s.product_id AND
    (s.spec_id = 1 OR s.spec_id IN (2, 4))
GROUP BY p.id HAVING COUNT(p.id) = 2 
```

（显然）返回产品 1 和 3，但错误地返回 3，因为它确实同时具有规范 2 和 4，但没有 1。

我正在考虑提供不同的规范子句值（如规范组 1 = 1、规范组 2 = 2（规范组 3 = 4 等）），将它们加起来并使用`HAVING SUM(extra_field) = 3`，但我没有成功。

**那么，如何进行这样的查询呢？**我是否必须求助于多个查询（如果，最好的方法是什么）？

我正在使用 MySQL，但我认为问题不限于单个系统。

以下是重新创建这些测试表的语句：

```
CREATE TABLE product (
  id int(11) unsigned NOT NULL AUTO_INCREMENT,
  title varchar(20) NOT NULL,
  PRIMARY KEY (id)
);
INSERT INTO product (id, title) VALUES (1, 'bike'), (2, 'bus'), (3, 'car');
CREATE TABLE product_spec (
  product_id int(10) unsigned NOT NULL,
  spec_id int(10) unsigned NOT NULL,
  PRIMARY KEY (product_id,spec_id)
);
INSERT INTO product_spec (product_id, spec_id) VALUES (1, 1), (1, 2), (1, 3), (2, 1), (2, 3), (3, 2), (3, 4); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T11:41:59.050

您可以使用 SUM+CASE 计算各个“类别”的总和，并使用组合的 HAVING 查询：

```
SELECT p.id 
FROM 
  product p, 
  product_spec s
WHERE p.id = s.product_id 
GROUP BY p.id 
HAVING 
  SUM(case when s.spec_id = 1 then 1 else 0 end) > 0 and 
  SUM(case when s.spec_id in (2,4) then 1 else 0 end) > 0 
```

# hibernate - 文档类型正确吗？

> ID：16164980
> 
> 赞同：1
> 
> 时间：2013-04-23T08:51:11.420
> 
> 标签：hibernate, jakarta-ee, doctype

我正在尝试做这个网站的例子：http: [//www.compilr.org/struts-2-and-hibernate-4-application/1343/](http://www.compilr.org/struts-2-and-hibernate-4-application/1343/)

但是当我执行应用程序时，我可以在 Eclipse 控制台上看到这个错误： Initial SessionFactory creation failed.org.hibernate.service.classloading.spi.ClassLoadingException: Specified JDBC Driver com.mysql.jdbc.Driver class not found

但我认为正确的代码是下一个：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-configuration PUBLIC
"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
  <session-factory>
   <property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property>
   <property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property>
   <property name="hibernate.connection.url">jdbc:mysql://localhost/test</property>
   <property name="hibernate.connection.username">root</property>
   <property name="hibernate.connection.password">root</property>
<mapping resource="entity/Login.hbm.xml"/>
  </session-factory> 
```

任何人都可以帮我一把吗？

感谢来自巴塞罗那 - 西班牙

# python - django 添加到类别设计

> ID：16164981
> 
> 赞同：0
> 
> 时间：2013-04-23T08:51:20.080
> 
> 标签：python, django

我有以下型号：

```
# models.py
class Pizza(models.Model):
    name = models.CharField(max_length=50)
    shop = models.CharField(max_length=50)

class Topping(models.Model):
    name = models.CharField(max_length=50)
    pizza = models.ManyToManyField(Pizza) 
```

以简单的观点

```
# views.py
from django.shortcuts import render

def pizza_view(request):
    pizzas=Pizza.objects.all()
    return render(request, 'pizzas.html', {'pizzas':pizzas}) 
```

和一个简单的模板

```
# pizzas.html

...
    <table>
  {% for pizza in pizzas %}
    <tr>
      <td>{{pizza.name}}</td>
      <td>{{pizza.price}}</td>
      <td>{{pizza.rating}}</td>
    </tr>
  {% endfor %}
     <table> 
```

现在，我希望能够在此视图中为比萨饼添加浇头。Djangoish 的设计方式是什么？我是否将整个表格打包成一个表单并为每一行添加一个 ModelChoiceField 和一个提交按钮，还是使用多个表单？我想知道，如何以正确的方式设计这个，也许你知道一些有帮助的链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T10:21:49.560

可能任何初学者教程都涉及到这个主题。django 站点上也有很好的文档：

[https://docs.djangoproject.com/en/dev/intro/tutorial01/](https://docs.djangoproject.com/en/dev/intro/tutorial01/)

[https://docs.djangoproject.com/en/dev/ref/models/fields/](https://docs.djangoproject.com/en/dev/ref/models/fields/)

# c++ - 如何要求boost刷新时钟

> ID：16164983
> 
> 赞同：1
> 
> 时间：2013-04-23T08:51:27.273
> 
> 标签：c++, date, boost, time, timezone

我正在编写一个对当地时间非常敏感的软件。我正在使用 boost::posix_time 来获取计算机的本地时间。但是，我注意到如果我们在执行过程中更改时间和时区，本地时间就会完全错误。这是我写的一个小测试程序：

```
#include <boost/date_time/posix_time/posix_time.hpp>
#include <stdio.h>

int main(int argc, char* argv[])
{
  while(1)
  {
    std::cout << "It's : " << boost::posix_time::to_simple_string(
      boost::posix_time::second_clock::local_time()) << std::endl;
    sleep(1);
  }

  return 0;
} 
```

然后我启动应用程序，时间正确：

```
./testDate 
It's : 2013-Apr-22 10:35:22 
```

然后我在执行过程中更改了时间和时区，时间完全错了！

```
 rm /etc/localtime  ; ln -s /usr/share/zoneinfo/Europe/Belfast  /etc/localtime ; date -s 10:35:00

It's : 2013-Apr-22 10:35:16
It's : 2013-Apr-22 10:35:17  <-- Time changed here
It's : 2013-Apr-22 04:35:00
It's : 2013-Apr-22 04:35:01 
```

但是如果我手动重新启动应用程序，时间又是正确的！我想知道是否有办法告诉 boost 从系统时钟刷新日期时间？我猜它在启动时读取一次并将时间存储在内存中。我如何检测到时区或时间已更改，我必须告诉 boost 更新时间？通过定期询问时间来检查时间是否与我上次获得时间的时间有显着差异？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-07T22:47:15.637

我怀疑这个功能被故意排除在提升之外，因为它需要对这种特定于应用程序的添加造成不必要的性能损失（或者更糟糕的是，可能会使 API 杂乱无章地使用很少需要的功能）。我同意其他人的观点，即应该在用户应用程序中检测时间变化。

# tomcat - 匿名 tomcat 停止/杀死

> ID：16164984
> 
> 赞同：0
> 
> 时间：2013-04-23T08:51:29.900
> 
> 标签：tomcat, process, kill

我的 tomcat 被一些用户停止，他们使用“kill”命令来终止进程，而不是`shutdown.sh`. 那么，如何防止和跟踪（记录）这个。就像，用户不应该能够终止使用的进程，`kill`除非他有身份验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T09:09:22.130

仅当流氓用户有权访问 Tomcat 服务器正在使用的帐户（或其他用户是超级用户，但这是另一回事）时，才能杀死 Tomcat。

您需要做的是使用 sysadmin 工具而不是 Tomcat 来解决问题。只是不要向其他人提供 Tomcat 用户帐户详细信息。

注意：其他用户仍然可以通过向关闭端口发送关闭命令来优雅地关闭 Tomcat，但我认为这与这个问题无关。

# r - 时间序列图范围

> ID：16164989
> 
> 赞同：3
> 
> 时间：2013-04-23T08:51:44.953
> 
> 标签：r, plot, xts

您好正在绘制一个 xts 对象： ![在此处输入图像描述](https://i.stack.imgur.com/OGSQG.png)

我想将 xlim 延长到 2 月 30 日，因为我想添加来自 Arima 模型的预测：

```
par(mfrow=c(1,1))
pred <- predict(try2, n.ahead = 1,se.fit=T)
lim_sup <- pred$pred + 1.96 * pred$se
lim_inf <- pred$pred - 1.96 * pred$se
plot(heat["1996-02-01 00:00/1996-02-16 04:00"],type="l",main="Cross Validation")
points(exp(pred$pred),col="blue",lwd=2)
points(exp(lim_sup),lwd=2,col="green")
points(exp(lim_inf),lwd=2,col="green") 
```

但我看不到情节中的任何线条。你能给我一些建议吗？

热时间序列看起来像这样

```
 HC.f
1996-02-01 00:00:00 1437.000
1996-02-01 01:00:00 1441.600
1996-02-01 02:00:00 1489.300
1996-02-01 03:00:00 1501.300
1996-02-01 04:00:00 1568.400
1996-02-01 05:00:00 1629.400 
```

而一小时步长的预测：

```
pred$pred
Time Series:
Start = 3002 
End  = 3002 
Frequency = 1 
[1] 7.480588 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T10:50:45.773

在绘图之前合并您的实际和预测对象。然后，您将在整个所需时间段内拥有一个时间序列。

```
library(xts)
set.seed(21)
x <- xts(rnorm(10),Sys.Date()-10:1)
y <- xts(rnorm(3),Sys.Date()+0:2)
z <- merge(x,y)
plot(z[,1], ylim=range(z,na.rm=TRUE))
lines(z[,2],col='red') 
```

# r - 匹配来自 r 中长度不等的数据帧的数据

> ID：16164990
> 
> 赞同：4
> 
> 时间：2013-04-23T08:51:48.593
> 
> 标签：r, match

这看起来应该很简单。R 中有 2 个长度不等的数据帧。一个只是较大数据集的随机子集。因此，它们具有完全相同的数据和完全相同的 UniqueID。我想做的是在较大的数据集中放置一个指标，例如 0 或 1，表示该行位于较小的数据集中。

我可以使用`which(long$UniqID %in% short$UniqID)`，但我似乎无法弄清楚如何将此指标匹配回长数据集

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T08:56:40.543

制作了相同的样本数据。

```
long<-data.frame(UniqID=sample(letters[1:20],20))
short<-data.frame(UniqID=sample(letters[1:20],10)) 
```

您可以使用`%in%`without`which()`获取值 TRUE 和 FALSE，然后`as.numeric()`将它们转换为 0 和 1。

```
long$sh<-as.numeric(long$UniqID %in% short$UniqID) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-23T09:34:26.620

我将使用@AnandaMahto 的数据来说明另一种使用方式`duplicated`，如果您有`unique`ID 也可以。

### 案例 1：具有唯一 id 列

```
set.seed(1)
df1 <- data.frame(ID = 1:10, A = rnorm(10), B = rnorm(10))
df2 <- df1[sample(10, 4), ]
transform(df1, indicator = 1 * duplicated(rbind(df2, df1)[, "ID", 
            drop=FALSE])[-seq_len(nrow(df2))]) 
```

### 案例 2：没有唯一的 id 列

```
set.seed(1)
df1 <- data.frame(A = rnorm(10), B = rnorm(10))
df2 <- df1[sample(10, 4), ]
transform(df1, indicator = 1 * duplicated(rbind(df2, df1))[-seq_len(nrow(df2))]) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-23T09:14:16.977

到目前为止的答案都很好。但是，有人提出了一个问题，“如果没有“UniqID”列怎么办？

在这一点上，也许`merge`可以提供帮助：

下面是一个使用ID`merge`和`%in%`可用 ID 的示例：

```
set.seed(1)
df1 <- data.frame(ID = 1:10, A = rnorm(10), B = rnorm(10))
df2 <- df1[sample(10, 4), ]

temp <- merge(df1, df2, by = "ID")$ID
df1$matches <- as.integer(df1$ID %in% temp) 
```

并且，一个 ID 不可用的类似示例。

```
set.seed(1)
df1_NoID <- data.frame(A = rnorm(10), B = rnorm(10))
df2_NoID <- df1_NoID[sample(10, 4), ]

temp <- merge(df1_NoID, df2_NoID, by = "row.names")$Row.names
df1_NoID$matches <- as.integer(rownames(df1_NoID) %in% temp) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-23T08:56:33.233

您可以直接将逻辑向量用作新列：

```
long$Indicator <- 1*(long$UniqID %in% short$UniqID) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T09:03:40.003

看看这是否能让你开始：

```
long <- data.frame(UniqID=sample(1:100)) #creating a long data frame
short <- data.frame(UniqID=long[sample(1:100, 30), ]) #creating a short one with the same ids.

long$indicator <- long$UniqID %in% short$UniqID #creating an indicator column in long.
> head(long)
  UniqID indicator
1     87      TRUE
2     15      TRUE
3    100      TRUE
4     40     FALSE
5     89     FALSE
6     21     FALSE 
```

# android - 如果项目包含子包，如何在 Manifest 中声明 GCMIntentService 的名称？

> ID：16164991
> 
> 赞同：3
> 
> 时间：2013-04-23T08:51:49.550
> 
> 标签：android, google-cloud-messaging, android-c2dm

我已经参与了一个 GCM 项目，该项目能够在注册后从 Google 服务器接收和发送消息。

这个项目只包含一个包（com.example.gcm），所有的类（GCMIntentService ...）都在这个包中声明。下面的代码描述了我的清单文件

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="YOUR PACKAGE NAME"
android:versionCode="1"
android:versionName="1.0" >
....
<receiver
        android:name="com.google.android.gcm.GCMBroadcastReceiver"
        android:permission="com.google.android.c2dm.permission.SEND" >
        <intent-filter>
            <action android:name="com.google.android.c2dm.intent.RECEIVE" />
            <action android:name="com.google.android.c2dm.intent.REGISTRATION" />

            <category android:name="YOUR PACKAGE NAME" />
        </intent-filter>
    </receiver>

    <service android:name=".GCMIntentService" /> 
```

现在我正在尝试将此 GCM 项目集成到我的主项目中，该项目至少包含 4 个子包。我采用了与 Manfiest 相同的配置，我得到了类似的东西

```
 ....
<receiver
        android:name="com.google.android.gcm.GCMBroadcastReceiver"
        android:permission="com.google.android.c2dm.permission.SEND" >
        <intent-filter>
            <action android:name="com.google.android.c2dm.intent.RECEIVE" />
            <action android:name="com.google.android.c2dm.intent.REGISTRATION" />

            <category android:name="YOUR PACKAGE NAME" />
        </intent-filter>
    </receiver>

    <service android:name=".notification.GCMIntentService" /> 
```

在 logcat 中，我得到了 GCM IntentService class: **YOUR PACKAGE NAME.GCMIntentService**这是不正确的，因为该类位于子包中。

如果我更改服务的名称并输入包的全名，我会得到这个：

> 无法启动服务 Intent { act=com.google.android.c2dm.intent.REGISTRATION cat=[ xxx ] flg=0x10 cmp=xxxx (has extras) }：未找到

我已经阅读了很多帖子，但没有任何帮助。

> 有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T11:05:30.503

想想，这应该会帮助你[http://dexxtr.com/post/28188228252/rename-or-change-package-of-gcmintentservice-class](http://dexxtr.com/post/28188228252/rename-or-change-package-of-gcmintentservice-class)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-14T13:29:44.400

You should define your own Receiver class, Then add it to your **AndroidManifest.xml**

```
public class GCMReceiver extends GCMBroadcastReceiver { 
    @Override
    protected String getGCMIntentServiceClassName(Context context) { 
        return "com.example.gcm.GCMService"; 
    } 
} 
```

# asp.net-mvc-3 - 在 ASP.Net MVC 3 Razor 网站上使用 NodaTime 进行日期时间转换。如何？

> ID：16164994
> 
> 赞同：1
> 
> 时间：2013-04-23T08:51:51.990
> 
> 标签：asp.net-mvc-3, datetime, razor, nodatime

我将日期/时间存储在伦敦时区（不是 UTC）的数据库中。我需要的是检索此日期/时间，将其转换为 UTC 并考虑用户的时区（他们在注册到站点时定义 - 即：en-GB、en-US 等）显示。

我的第一个问题与 MVC 结构更相关，因为我对此完全陌生（我是一名 WebForms 开发人员）——我应该把这个转换代码/类/帮助器放在哪里？模型？视图模型？

第二个问题是转换本身——我玩过 NodaTime 测试项目，但找不到进行这种转换的正确方法。

任何帮助深表感谢。

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T20:36:20.983

Jon Skeet 可能需要纠正我，因为我假设这在[nodatime](/questions/tagged/nodatime "显示标记为“nodatime”的问题")中是正确的：

```
// Timezone data provider (inject with DI)
IDateTimeZoneProvider timeZoneProvider = DateTimeZoneProviders.Tzdb;

// London Timezone (can keep this as a singleton, since it'll be used often)
var londonTimeZone = timeZoneProvider["Europe/London"];

// Get your date/time from the database and map it as being local to London timezone
var yourDateFromDb = new DateTime(2013, 01, 23, 21, 00, 00); // This is what you'll get back from your database (although you may get back a DateTimeOffset)
ZoneLocalMapping zonedDbDateTime = londonTimeZone.AtLeniently(LocalDateTime.FromDateTime(yourDateFromDb)); <-- This is your date time with the correct offset (taking into account DST etc.)

// Map the London zoned date/time to the users local date/time
var usersTimezoneId = "Europe/Paris"; // <-- Store this value in users profile/db
var usersTimezone = timeZoneProvider[usersTimezoneId];
var usersZonedDateTime = zonedDbDateTime.WithZone(usersTimezone);

Assert.That(usersZonedDateTime.Hour == 22); 
```

您可能应该知道，在时区转换（秋季时钟更改）期间，您可能会获得 zonedDbDateTime 的 2 个可能日期。这里的代码只是获取第一个或最早的日期/时间。

编辑：更新的代码片段与 Jon Skeet 建议的更改

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T09:02:09.440

你可以写一些这样的扩展方法：

```
public static DateTime ConvertToUtc(this DateTime d)
{
    //do conversin and return it
} 
```

只要您在页面顶部包含 ConvertToUtc 的命名空间，您就可以像 @Model.MyDate.ConvertToUtc() 一样从您希望的任何视图中调用它。并进行转换，请参阅此页面

[使用 C# 将 DateTime 从 UTC 转换为用户提供的时区](https://stackoverflow.com/questions/11623472/convert-datetime-from-utc-to-a-user-provided-time-zone-with-c-sharp)

[http://www.dotnetcurry.com/ShowArticle.aspx?ID=593](http://www.dotnetcurry.com/ShowArticle.aspx?ID=593)

[如何在 ASP.NET 中使用时区？](https://stackoverflow.com/questions/832986/how-to-work-with-timezone-in-asp-net)

# python - 字符串的 Python 检查列表项

> ID：16164999
> 
> 赞同：0
> 
> 时间：2013-04-23T08:51:58.127
> 
> 标签：python

例如，问题如下：

```
lst = ['2456', '1871', '187']

d = {
    '1871': '1',
    '2456': '0',
}

for i in lst:
    if any(i in x for x in d.keys()):
        print i

% python test.py
2456
1871
187 
```

所以，我需要从字典“d”的键中包含的列表“lst”中获取所有元素，没有子字符串匹配，因为如果我执行“print d[i]”，我会得到一个错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T08:53:20.603

```
>>> lst = ['2456', '1871', '187']
>>> d = {
    '1871': '1',
    '2456': '0',
}
>>> [x for x in lst if x in d]
['2456', '1871'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T08:58:09.887

这条线应该做的工作：

```
 l=[e for e in d if e in lst] 
```

使用您的数据：

```
In [5]: l=[e for e in d if e in lst]

In [6]: l
Out[7]: ['2456', '1871'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:57:04.920

```
>>> for i in li:
    if i in d:
        print "{0} => {1}".format(i,d[i])

2456 => 0
1871 => 1 
```

在列表理解中：

```
>>> [i for i in li if i in d]
['2456', '1871'] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T08:53:30.033

使用[`sets`](http://docs.python.org/3.3/library/stdtypes.html#set)：

```
lst = ['2456', '1871', '187']
d = {'1871': '1', '2456': '0'}

print(set(lst) & set(d.keys())) # prints '{'2456', '1871'}' 
```