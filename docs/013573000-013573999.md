# StackOverflow 问答 13573000-13573999

# c# - 为什么使用 new 关键字时不需要括号？

> ID：13573000
> 
> 赞同：2
> 
> 时间：2012-11-26T20:54:13.950
> 
> 标签：c#

如果我想获取某个目录中所有文件的列表，我可以输入如下内容：

```
var files = (new DirectoryInfo(@"C:\Temp")).GetFiles(); 
```

但是，以下内容也有效（注意“new”关键字之前缺少括号）：

```
var files = new DirectoryInfo(@"C:\Temp").GetFiles(); 
```

为什么允许这种情况发生？像这样的陈述：

```
2 + 4 * 3   and   (2 + 4) * 3 
```

由于括号，将分别解析为 14 和 18。

看起来我的代码示例类似于在 DirectoryInfo 对象的静态版本上调用“.GetFiles()”方法（因为缺少“new”关键字），其中括号与“new”关键字结合明确说明我正在使用 DirectoryInfo 对象的一个​​实例。

IE：

```
2   +  4               * 3
new    DirectoryInfo()   .GetFiles() 
```

与：

```
(2   +  4              ) * 3
(new    DirectoryInfo())   .GetFiles() 
```

是否有一个简单的解释来解释为什么会这样？C# 词法分析器处理这两种情况（带/不带括号）不是更多的工作吗？我的比喻有问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-26T21:06:55.937

> **注意：**这个答案有很多相互等价的表达方式。我没有将它们保持内联或将它们分成两行，而是采用了一种简写形式`<==>`来表示“相当于”。所以
> 
> ```
> foo   <==>   bar 
> ```
> 
> 应理解为“表达式`foo`等价于表达式`bar`”。

你说的是*优先级*。`*`比二元运算符具有更高的优先级`+`，因此它更紧密地“绑定其操作数”。所以：

```
 x * y + z   <==>   (x * y) + z 
```

两者`new`和“点”部分都是*主要*表达式，它们具有相同的优先级。当两种形式具有相同的优先级时，就会涉及*关联性*。C# 规范在操作符方面实际上并不是很清楚`new`，但`.`操作符是二元运算符，所有二元运算符都被认为是*左关联的*。换句话说：

```
x.y.z   <==>   (x.y).z 
```

再举一个例子，`*`并且`/`具有相同的优先级，所以：

```
x * y / z   <==>   (x * y) / z
x / y * z   <==>   (x / y) * z 
```

所以：

```
new DirectoryInfo(x).GetFiles()   <==>   (new DirectoryInfo()).GetFiles() 
```

所有这些都与评估顺序有些不同，评估顺序*总是*从左到右。例如，在表达式`x + y * z`中，较高的优先级`*`意味着：

```
x + y * z   <==>   x + (y * z) 
```

...但它仍然`x`是首先评估的，然后是`y`，然后`z`是 ，然后是乘法，最后是加法。像往常一样，[Eric Lippert 在这个主题上写得非常好](http://blogs.msdn.com/b/ericlippert/archive/2008/05/23/precedence-vs-associativity-vs-order.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-26T21:02:02.260

请参阅 MSDN 上有关优先级的文章： [7.2.1](https://web.archive.org/web/20170207042906/https://msdn.microsoft.com/en-us/library/aa691323(v=vs.71).aspx)

由于所有非赋值二元运算符都是左结合的，因此同等先例`new`和`.`运算符是从左到右计算的。

因此，在给定的表达式中，对象在其方法被调用之前被实例化。此外--`new`具有同等优先级，因此它在获取类型标识符之前会使用类型标识符（从左到右）`.`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-26T20:57:59.093

调用静态方法的语法 is`DirectoryInfo.GetFiles()`和 not `DirectoryInfo(...).GetFiles()`，所以我不确定这两种解释之间如何存在冲突。

无论哪种方式，您使用数字表达式的示例都将首先乘以 3，因为乘法的优先级高于加法或减法。括号所做的只是允许您覆盖默认优先级。

即使调用静态方法的语法相同，在您询问的情况下，默认优先级仍然会导致它在没有括号的情况下按预期工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-26T20:59:18.440

您不能`new`返回值，因此编译器知道将 new 与初始化类型一起放入，并在新实例上运行该方法。

```
(new A()).Foo() // Makes sense! sort of...
new (A().Foo()) // Makes absolute no sense.

(1 + 4) * 10 // Makes sense
1 + (4 * 10) // Also makes sense 
```

数字和 C# 关键字之间的事物如何协同工作的逻辑有所不同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-26T20:58:59.303

您的类比适用于数学中的运算顺序。但是在语法上使用 new 表示编译器为类的“新”实例做好准备。括号与否，您可以使用关键字 new 获得该类的新实例。

# django - django-tastypie 与 django-taggit

> ID：13573004
> 
> 赞同：2
> 
> 时间：2012-11-26T20:54:26.440
> 
> 标签：django, tastypie, django-taggit

我正在使用[django-taggit](http://django-taggit.readthedocs.org/en/latest/)进行标记。我有同一个对象的 django-tastypie REST 资源。

在公开 REST 资源时，它不会获取标签字段（例如，等效于 model.tags.all()）。

有什么特别需要做的吗？

我想对对象模型执行 GET 和 POST 操作并检索和插入标签。

有人可以指出示例设置以返回标签对象吗？我在[这里](https://github.com/toastdriven/django-tastypie/blob/master/tests/related_resource/api/resources.py)提到了要点，但是无法理解在查询模型时如何检索关联的标签。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T00:16:25.337

首先制作一个`TagResource`：

```
from taggit.models import Tag

class TagResource(ModelResource):
    class Meta:
        queryset = Tag.objects.all() 
```

然后在获得标签的资源中：

```
class FooResource(ModelResource):

    tags = fields.ToManyField(TagResource, 'tags', # if your tag field is 'tags'
                              full = True)

    class Meta:
        queryset = Foo.objects.all() 
```

它应该工作。

**更新**

为了过滤标签，您必须通过过滤它`TagResource`，假设您的 api 名称是`v1`， url 是：

`/api/v1/tag/?slug=anytagyouwant&format=json`

上面的网址是这样的：“`anytagyouwant`存在吗？”

for '获取所有有`anytagyouwant`标签的 foo'

`/api/v1/foo/?tags__slug=anytagyouwant&format=json`

请注意，为了能够过滤某些字段，您必须在资源中声明它，`FooResource`例如：

```
from tastypie.resources import ModelResource, ALL, ALL_WITH_RELATIONS

class FooResource(ModelResource):

    tags = fields.ToManyField(TagResource, 'tags', # if your tag field is 'tags'
                              full = True)

    class Meta:
        queryset = Foo.objects.all()
        filtering = dict(
            tags = ALL,
            # or 
            tags = ALL_WITH_RELATIONS,
        ) 
```

# wordpress - WordPress NextGEN Gallery 水印功能不起作用

> ID：13573005
> 
> 赞同：2
> 
> 时间：2012-11-26T20:54:29.643
> 
> 标签：wordpress, nextgen-gallery

我已经尝试了几个小时才能让 NextGEN Gallery 水印功能正常工作，但没有成功。文本水印会起作用，但图像水印不会。

我在谷歌上做了很多阅读，主要是我需要

*   使用水印的绝对 URL；
*   有；`allow_url_fopen= On`_ `php.ini`和
*   将水印应用于图像

我已经完成了所有这些，但仍然没有运气。

有没有人遇到过同样的问题并解决了？如果是这样，怎么做？这真让我抓狂。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T10:17:45.567

在不知疲倦地寻找解决方案后，我决定将图像托管在不同的服务器上，水印立即起作用！有问题的服务器是心脏互联网，所以我会与他们联系并询问为什么它不工作！

如果其他人遇到此问题，请尝试将图像托管在不同的服务器上，这为我解决了问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T17:26:23.017

更改字体和大小对我有用。

# windows - GetIpAddrTable 返回的适配器列表与 GetAdaptersAddresses 不同

> ID：13573007
> 
> 赞同：2
> 
> 时间：2012-11-26T20:54:33.640
> 
> 标签：windows, winapi, networking

## 返回不同的适配器列表

我想知道为什么`GetIpAddrTable`会返回比`GetAdaptersAddresses`. 候选原因如下（根据答案更新）。

## 候选人原因

*   *IPv6 适配器*：这些只会出现在`GetAdaptersAddresses`. 在此示例中，我有一个适配器的情况，该适配器具有 IPv4 和 IPv6 的链路本地 IP 地址，它没有显示在 GetIpAddrTable 的输出中。

## 背景

我正在调查`GetIpAddrTable`运行 Windows 7 64 位家庭高级版（版本：6.1.7601 Service Pack 1 Build 7601）的特定戴尔笔记本电脑上的功能问题。有问题的系统无法通过 检测某些网络适配器`GetIpAddrTable`。诊断结果如下。

谁能解释为什么我会从这两个函数中看到如此截然不同的结果？我们已经使用`GetIpAddrTable`了将近两年，没有任何问题。

## 文件检查

的[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365949%28v=vs.85%29.aspx)表明`GetIpAddrTable`链接状态检测可能会导致 XP 出现问题，但它没有给出适配器根本不显示的任何原因。*似乎*不包括虚拟适配器，但我们的设备不是虚拟适配器（它是基于 USB 的以太网）。

> 在 Windows Server 2008 和 Windows Vista 上，GetIpAddrTable 函数返回的 IPv4 地址不受本地计算机上 TCP/IP 堆栈的媒体感知功能的影响。GetIpAddrTable 函数只返回有效的 IPv4 地址。

在我在这个系统上进行的测试中，我们有一个有效的连接，但它仅由 报告`GetAdaptersAddresses`，而不是`GetIpAddrTable`。我怀疑 Windows 认为适配器无效，但我不确定要测试什么来确认这个理论。数据包流入和流出设备，只是在 IPv4 地址映射表中不可见。

## 实施细节

*   我们使用[Belcarra USBLAN 以太网小工具驱动程序](http://www.belcarra.com/p/usblan.html)（为我们公司定制）
*   我们希望我们的设备通过 DHCP 注册主机和设备
*   驱动提供DHCP
*   我们的第一个主机适配器是 169.254.142.9
*   我们的第一个设备适配器是 169.254.142.10
*   流向我们设备的流量不会在外部路由（本地链接）

## GetIpAddrTable 结果

通常我们希望看到两个或三个网络适配器，而不是环回适配器。也许这个列表中存在 127.0.0.1 是问题的一部分——在正常工作的机器上通常不会观察到它。

*   *适配器 1：软件环回接口 1*
*   *适配器 2：英特尔(R) 迅驰(R) Wireless-N 1030*

## GetAdaptersAddresses 结果

我已经按照返回的顺序列出了此函数返回的适配器。*强调*第一次调用的匹配适配器。ipconfig 输出中唯一不存在的适配器以**粗体显示**。

*   适配器 1：USBLAN 适配器
*   适配器 2：Microsoft 虚拟 WiFi 微型端口适配器
*   适配器 3：蓝牙设备（个人局域网）
*   *适配器 4：Intel(R) Centrino(R) Wireless-N 1030*
*   适配器 5：Realtek PCIe GBE 系列控制器
*   ***适配器 6：软件环回接口 1***
*   适配器 7：Microsoft ISATAP 适配器
*   适配器 8：Microsoft ISATAP 适配器 #2
*   适配器 9：Teredo 隧道伪接口
*   适配器 10：Microsoft ISATAP 适配器 #3
*   适配器 11：Microsoft ISATAP 适配器 #4
*   适配器 12：Microsoft ISATAP 适配器 #5

## ipconfig /all 结果

请注意，软件环回适配器是唯一不存在的——这表明 ipconfig 在内部使用第二个函数或类似接口。

*   适配器 1：USBLAN 适配器
*   适配器 2：Microsoft 虚拟 WiFi 微型端口适配器
*   适配器 3：蓝牙设备（个人局域网）
*   *适配器 4：Intel(R) Centrino(R) Wireless-N 1030*
*   适配器 5：Realtek PCIe GBE 系列控制器
*   适配器 6：Microsoft ISATAP 适配器
*   适配器 7：Microsoft ISATAP 适配器 #2
*   适配器 8：Teredo 隧道伪接口
*   适配器 9：Microsoft ISATAP 适配器 #3
*   适配器 10：Microsoft ISATAP 适配器 #4
*   适配器 11：Microsoft ISATAP 适配器 #5

## 交叉引用结果

除了软件环回接口之外，该命令似乎`ipconfig /all`返回了相同的数据。`GetAdaptersAddresses`我目前正在考虑切换我们的库以`GetAdaptersAddresses`解决此问题，但我担心为什么`GetIpAddrTable`没有返回预期结果。提前感谢您的任何意见！

## 相关问题

*   [从 GetAdaptersAddresses() 获取 IP_ADDRESS_STRING？](https://stackoverflow.com/questions/3989446/get-an-ip-address-string-from-getadaptersaddresses)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:33:33.983

`GetIpAddrTable()`只返回 IPv4 接口。

`GetAdaptersAddresses()`返回 IPv4 和/或 IPv6 适配器，单个适配器可以分配多个 IP 地址。

你在比较苹果和橙子，想知道为什么苹果比橙子少。

# c# - 在 C# 中加载程序集时出现 FileNotFoundException

> ID：13573008
> 
> 赞同：1
> 
> 时间：2012-11-26T20:54:37.837
> 
> 标签：c#, .net, internalsvisibleto

在 C# 中，我有一个程序集 (AssemblyA)，其内部对同一解决方案中的另一个程序集 (AssemblyB) 可见，我已经使用

```
[assembly: InternalsVisibleTo(AssemblyB, PublicKey=1234566.......)] 
```

但是，AssemblyA 被打包到我们的安装程序中，而 AssemblyB 仍然是我们不希望我们的客户访问的内部库。程序集 B 是否需要在场才能正确加载程序集 A？目前我收到一个 FileNotFoundException ，说明没有找到程序集或其依赖项之一，我想知道是否是这种情况。

如果确实如此，有没有办法在没有装配 B 存在的情况下使模块加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:17:16.873

AssemblyA 的事实`InternalsVisibleTo(AssemblyB)`并不意味着 AssemblyA 依赖于 AssemblyB 或需要它运行时才能加载。

如果您正在`FileNotFoundException`尝试加载 AssemblyA，那是因为另一个原因。

如果您发布异常的堆栈跟踪，以及更多显示您正在做什么的代码，这可能会帮助这里的人解决异常。

此外，您可以使用诸如`fuslgvw.exe`.NET 附带的 Fusion Log Viewer ( ) 之类的工具来查看 .NET 程序集绑定失败，并准确找出丢失的 .dll 以及预期存在的位置。

# http - 如何使用 Socket.io 获取请求的 HTTP 标头？

> ID：13573016
> 
> 赞同：7
> 
> 时间：2012-11-26T20:55:30.220
> 
> 标签：http, express, socket.io

我有一个在 Nginx 后面运行的 Express 应用程序，所以当我尝试获取用户的 IP 时，我总是得到`127.0.0.1`而不是真实的，这是由 Nginx 在`X-Real-IP`标题中设置的。我如何得到这个标题？有没有办法*通过*对象获得它`socket`？

代码基本上是这样的：

```
io.sockets.on( 'connection', function( socket ) {

    var ip = /* ??? */;

    /* do something with the IP…

       … some stuff …

     */
}); 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-26T20:58:56.043

在 NGINX 或其他代理后面运行时获取 IP：

```
var ip = req.header('x-forwarded-for') || req.connection.remoteAddress; 
```

或用于 Socket.IO

```
client.handshake.headers['x-forwarded-for'] || client.handshake.address.address; 
```

来自：[http ://www.hacksparrow.com/node-js-get-ip-address.html](http://www.hacksparrow.com/node-js-get-ip-address.html)

# java - 如何在 Java2D 中旋转矩形

> ID：13573022
> 
> 赞同：2
> 
> 时间：2012-11-26T20:56:09.517
> 
> 标签：java, java-2d

我想在一个方法中旋转一个矩形，但不明白怎么做，尝试如下：

```
private void setBoundaryRotate(Rectangle b, int radio) {
        AffineTransform transform = new AffineTransform();
        transform.rotate(Math.toRadians(45), b.getX() + b.width/2, b.getY() + b.height/2);} 
```

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:00:00.933

您需要在对象[`transform()`](http://docs.oracle.com/javase/7/docs/api/java/awt/geom/AffineTransform.html#transform%28double%5B%5D,%20int,%20double%5B%5D,%20int,%20int%29)上调用该方法`transform`，并在数组中传递矩形的坐标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T01:20:21.037

这有点主观，这完全取决于您想要实现的目标。

以下代码使用 a`AffineTransform`来旋转矩形，但为了这样做，我需要获取 a`PathIterator`并将其添加回`Path2D`

```
public class SpinBox {

    public static void main(String[] args) {
        new SpinBox();
    }

    public SpinBox() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new SpinPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class SpinPane extends JPanel {

        private Rectangle box = new Rectangle(0, 0, 100, 100);
        private float angle = 0;

        public SpinPane() {
            Timer timer = new Timer(1000/60, new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    angle += 1;
                    repaint();
                }
            });
            timer.setRepeats(true);
            timer.start();
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(200, 200);
        }

        @Override
        protected void paintComponent(Graphics g) {

            super.paintComponent(g);

            int width = getWidth() - 1;
            int height = getHeight() - 1;

            int x = (width - box.width) / 2;
            int y = (height - box.height) / 2;

            Graphics2D g2d = (Graphics2D) g.create();
            AffineTransform at = new AffineTransform();
            at.rotate(Math.toRadians(angle), box.x + (box.width / 2), box.y + (box.height / 2));
            PathIterator pi = box.getPathIterator(at);
            Path2D path = new Path2D.Float();
            path.append(pi, true);
            g2d.translate(x, y);
            g2d.draw(path);
            g2d.dispose();

        }

    }

} 
```

# codeigniter-2 - 使用 tank auth 和 Codeigniter 在会话到期时注销用户

> ID：13573024
> 
> 赞同：1
> 
> 时间：2012-11-26T20:56:18.447
> 
> 标签：codeigniter-2, session-timeout, tankauth

我使用 tank_auth 对用户进行身份验证并将用户登录到使用 Codeigniter 开发的应用程序。我注意到，当会话在默认期限后到期时，用户仍保持登录状态。在 tank_auth 的 login() 函数中，

```
if ($this->tank_auth->is_logged_in()) 
```

一开始的检查总是返回true。

我想在会话到期时注销用户。请你能指出我正确的方向来实现这个吗？

谢谢！米兹

# java - 如何在单个方法中找到三个数字的 GCD

> ID：13573026
> 
> 赞同：0
> 
> 时间：2012-11-26T20:56:21.893
> 
> 标签：java, int, greatest-common-divisor

我必须确保 3 个数字之间的 GCD 不大于 1。

这是我到目前为止的方法代码：

```
private int greatestCommonFactor(int a, int b, int c)
{
    for(int n = 0; n <= number; n++)
    {
        if()
    }

    return 1;
} 
```

当`return 1`我开始在实验室工作时，它就已经在那里了。如何确保 GCD 不超过 1？并返回所有三个整数？

如果它有助于弄清楚需要做什么，这是代码的其余部分：

```
import static java.lang.System.*;

public class Triples
{
 private int number;

public Triples()
{
    this(0);
}

public Triples(int num)
{
    number = num;
}

public void setNum(int num)
{
    number = num;
}

private int greatestCommonFactor(int a, int b, int c)
{
    for(int n = 0; n <= number; n++)
    {
        if()
    }

    return 1;
}

public String toString()
{
    String output="";
    int max = number;
    for(a = 1; a <= max; a++)
    {
        for(b = a +1; b <= max; b++)
        {
            for(c = b + 1; c <= max; c++)
            {
                if(Math.pow(a, 2)+ Math.pow(b, 2)== Math.pow(c, 2))
                {
                    if((a%2==1 && b%2==0)|| (a%2==0 && b%2==1))
                }
            }
        }
    }

    return output+"\n";
}
} 
```

**更新**

这是我为同一个实验室编写的新代码：

```
import static java.lang.System.*;

public class Triples
{
 private int number;

public Triples()
{
    this(0);
}

public Triples(int num)
{
    number = num;
}

public void setNum(int num)
{
    number = num;
}

private int greatestCommonFactor(int a, int b, int c)
{
    for(int n = 0; n <= number; n++)
    {
    int max = number;
    for(a = 1; a <= max; a++)
    {
        a = n;
        for(b = a +1; b <= max; b++)
        {
            b =n;
            for(c = b + 1; c <= max; c++)
            {
                c = n;
                if(Math.pow(a, 2)+ Math.pow(b, 2)== Math.pow(c, 2))
                {
                    if((a%2==1 && b%2==0)|| (a%2==0 && b%2==1))
                    {
                        if(a%2<=1 && b%2<=1 && c%2<=1)
                        {
                            return 1;
                        }
                    }
                }
            }
        }
    }
    }

    return 1;
}

public String toString()
{
    String output="";
    output = greatestCommonFactor(a, b, c);

    return output+"\n";
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T21:01:45.567

您可以使用[欧几里得算法](http://en.wikipedia.org/wiki/Greatest_common_divisor#Using_Euclid.27s_algorithm)来计算 和 的`a`GCD `b`。调用结果`d`。那么`a`,`b`和`c`的 GCD 是`c`和的 GCD `d`; 为此，您可以再次使用欧几里得算法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T21:02:26.987

如果您不关心效率，这是一种蛮力方法：

```
private int greatestCommonFactor(int a, int b, int c)
{
    limit = Math.min(a, b);
    limit = Math.min(limit, c);
    for(int n = limit; n >= 2; n--)
    {
        if ( (a % n == 0) && (b % n == 0) && (c % n == 0) ) {
            return n;
        }
    }

    return 1;
} 
```

**解释：**

*   您只需检查最少的`(a, b, c)`. 任何大于此的数字绝对不会是所有 3 的 GCD。
*   您需要开始循环`n = limit`而不是`n = 0`倒数。
*   一旦我们遇到一个对 产生零余数的数字`(a, b, c)`，那一定是 GCD。
*   如果在循环中找不到任何内容，则 GCD 默认为 1。

# iphone - iOS - UIScrollView 不更新其内容，并且某些 UIView 在重新加载后消失

> ID：13573028
> 
> 赞同：7
> 
> 时间：2012-11-26T20:56:34.057
> 
> 标签：iphone, objective-c, ios, cocoa-touch, uiview

我有`UITableViewController`inside`UIScrollView`作为`UIView`它的标题。 `UIScrollView`用于显示图像的幻灯片：

```
UITableView
 -UITableViewHeaderView
   -UIView
      -UIScrollView
        -UIImageView
          ...
      -UIPageControl 
```

每个图像都有一个带有标题和描述的子视图：

```
UIImageView
  -UIView
    -UILabel
    -UILabel 
```

当我需要更新我`tableView`的委托方法时，它会在 a`tableView`和调用`addImages`方法中重新加载数据：

```
- (void)eventsUpdated
{
    if ([self respondsToSelector:@selector(setRefreshControl:)])
        [self.refreshControl endRefreshing];

    [self.tableView reloadData];
    [self addImages];
} 
```

这是我添加图像的方法：

```
- (void)addImages
[self.scrollView.subviews makeObjectsPerformSelector:@selector(removeFromSuperview)];

    for (int i = 0; i < images.count; i++) {
        CGRect frame;
        frame.origin.x = self.scrollView.frame.size.width * i;
        frame.origin.y = 0;
        frame.size = self.scrollView.frame.size;

        UIImageView *subview = [self createImageViewForEvent:[images objectAtIndex:i] inFrame:frame];
        subview.frame = frame;
        [self.scrollView addSubview:subview];
    }

    self.scrollView.contentSize = CGSizeMake(scrollView.frame.size.width*images.count, scrollView.frame.size.height);
    pageControll.currentPage = 0;
    pageControll.numberOfPages = images.count;

}

- (UIImageView *)createImageViewForEvent:(Event *)event inFrame:(CGRect)frame
{
    UIImage *image;

    NSString *imageName = [event.imageName lastPathComponent];
    NSString *bundleFilePath = [[NSBundle mainBundle] pathForResource:[imageName stringByDeletingPathExtension] ofType:[imageName pathExtension]];

    image = [UIImage imageWithContentsOfFile:bundleFilePath];

    UIImageView *output = [[UIImageView alloc] initWithImage:image];
    output.frame = frame;

    UIView *descriptionView = [[UIView alloc] initWithFrame:CGRectMake(0, frame.size.height*0.7, frame.size.width, frame.size.height*0.3)];

    descriptionView.backgroundColor = [UIColor colorWithRed:0 green:0 blue:0 alpha:0.5];
    descriptionView.alpha = 1.0;

    UILabel *header = [[UILabel alloc] initWithFrame:CGRectMake(10, 5, frame.size.width-20, 12)];
    header.textColor = [UIColor colorWithRed:210/256.0 green:217/256.0 blue:231/256.0 alpha:1.0];
    header.font = [UIFont fontWithName:@"Helvetica" size:17];
    header.backgroundColor = [UIColor clearColor];
    header.lineBreakMode = UILineBreakModeTailTruncation;
    header.numberOfLines = 1;

    UILabel *description = [[UILabel alloc] initWithFrame:CGRectMake(10, 22, frame.size.width-20, 28)];
    description.textColor = [UIColor colorWithRed:255/256.0 green:255/256.0 blue:255/256.0 alpha:1.0];
    description.font = [UIFont fontWithName:@"Helvetica" size:12];
    description.backgroundColor = [UIColor clearColor];
    description.lineBreakMode = UILineBreakModeTailTruncation;
    description.numberOfLines = 2;

    header.text = event.title;
    [descriptionView addSubview:header];

    description.text = event.shortDesription;
    [descriptionView addSubview:description];

    [output addSubview:descriptionView];

    return output;
} 
```

首次启动后一切正常，但如果我尝试重新加载`tableView`并再次调用`addImages`，所有 UILabel 都会消失，只有`UIImageView`并且`UIView`可见。

**升级版：**

我注意到的是，我的 UILabel 会在一段时间后出现，大约在 30 秒后。我以前从未经历过类似的事情

**更新 2：**

重新加载`tableView`and后`scrollview`，`scrollView's`内容不会立即更新，只有在我开始滚动之后

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T19:00:58.910

我从您发布的代码中复制了一个示例项目，并且在标签或任何其他组件上都没有发现任何令人耳目一新的问题。这使我认为问题不在于您发布的代码，而在于其他地方。

通常当你看到这样的延迟时，那是因为一些不应该并行运行的代码正在并行运行。

我建议您检查如何以及何时执行对`eventsUpdated`. 您必须确保在主线程上执行调用，并且仅在事件数组完成更新后执行。要检查这一点，您可以添加以下行`eventsUpdated`：

`NSLog(@"Current: %@, main: %@", [NSThread currentThread], [NSThread mainThread]);`

请发布日志！:-)

我建议您还将调用方法中的代码添加到您的问题中`eventsUpdated`，因为它也可能有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T12:35:13.200

At first, never do something like

```
 [scrollView.subviews makeObjectsPerformSelector:@selector(removeFromSuperview)]; 
```

Scroll view has some internal views (scroll indicators, for example), so you're removing them which may dealloc them and cause strange crashes any time later.

As for your problem - try calling bringSubviewToFront: of your UIImageView to get your labels infront of everything else

# .net - 有没有一种安全的方法可以将 Collection 转换为 F# 中的序列？

> ID：13573029
> 
> 赞同：6
> 
> 时间：2012-11-26T20:56:39.457
> 
> 标签：.net, f#, functional-programming

大家下午好！

因此，我一直在尝试将 .NET 集合转换为功能数据结构的方法。我能得到的最好的结果就是先把它转换成一个序列，然后再转换成我想要的任何东西。

问题是这似乎破坏了类型推断，这显然是不安全的。

例子：

```
let a = new System.DirectoryServices.DirectorySearcher("<query>") in
let entries = a.FindAll ()
let entries_list = 
     let (entries_seq : seq<obj>) = Seq.cast entries_list in
     Seq.toList entries_Seq
in
entries_list (* list of AD objects found from query, has type obj *) 
```

为了对条目列表做任何有用的事情，我必须这样做：

```
entries_list :?> SearchResult 
```

尝试将其概括为 seq<'a> 失败，因为编译器仍然要求我静态键入它的枚举数（这是有道理的）。

有没有办法避免这种情况？我开始认为这是以功能方式使用 .NET 数据结构的限制。

对不起，如果这是一个新手问题；总的来说，我对 F# 和函数式编程很熟悉（并且很喜欢它！）。干杯!

*   卡洛斯。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-26T21:53:06.493

正如丹尼尔所说，您通常不需要使用`Seq.cast`，因为大多数集合已经实现了通用`seq<'t>`接口。但是，在 .NET 2.0 中引入泛型之前构建了几种 .NET 集合类型，它们仅实现非泛型`IEnumerable`接口。F# 编译器实际上在`for`循环中有一些称为“可枚举提取”的特殊逻辑，以使处理这些类型的集合更容易一些。因此，如果您只处理这些集合类型中的一种（例如，您正在使用`DirectoryServices.SearchResultCollections`很多），那么简单地创建一个简单的辅助函数可能是有意义的：

```
let typedSearchResults (s:SearchResultCollection) =
    seq { for result in s -> result } 
```

然后您可以使用它来代替`Seq.cast`这个特定的集合类型。

如果您在同一个项目中使用许多不同的旧式集合，那么您可以使用一些花哨的 F# 功能来制作通用`Seq.cast`替代方案：

```
module Seq =
    let inline inferCast s = 
        // constrain ^t to have an Item indexed property (which we don't actually invoke)
        let _ = fun x -> (^t : (member Item : int -> ^v with get) (x, 0))
        let e = (^t : (member GetEnumerator : unit -> ^e) s)
        seq { while (^e : (member MoveNext : unit -> bool) e) do
                yield (^e : (member Current : obj) e) :?> ^v } 
```

现在您可以使用`Seq.inferCast`代替`Seq.cast`，并且将为您推断出正确的项目类型。不过，在您的情况下，这可能有点矫枉过正。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T21:08:29.473

大多数 .NET 集合都实现`IEnumerable<T>`（与 F# 中的别名一样`seq<'T>`），但有时您会遇到一个仅实现非泛型接口的集合`IEnumerable`。`SearchResultCollection`就是这样一种类型。您可以使用`Seq.cast`将这些集合转换为`seq<'T>`，从而可以将它们与`Seq`模块中的函数一起使用。

```
open System.DirectoryServices

use searcher = new DirectorySearcher("<query>")
let entries = searcher.FindAll() |> Seq.cast<SearchResult>
let entries_list = Seq.toList entries 
```

# java - 在 Java 中使用多线程的并发问题

> ID：13573031
> 
> 赞同：0
> 
> 时间：2012-11-26T20:56:42.357
> 
> 标签：java, multithreading, sockets

我用 Java 编写了服务器和客户端的代码。客户端能够从服务器下载文件，服务器也应该能够同时向客户端提供文件。为此，我在 Server 中使用了多线程。

它对一个客户端来说工作得很好，但是在为每个客户端使用线程时，它似乎在我的代码中无法正常工作。

由于文件未正确下载，已损坏并且针对不同客户端的大小不同。

从客户端接受后，我正在创建一个新线程来为它提供服务器的文件代码 -

```
public static void send(String pathname) throws IOException, NoSuchAlgorithmException, NoSuchPaddingException
{

    try
    {
    System.out.println("....");

    byte[] buf = new byte[1024];
    OutputStream os = sock.getOutputStream();
    //PrintWriter writer = new PrintWriter(os);
    System.out.println("...11.");

    BufferedOutputStream out = new BufferedOutputStream(os, 1024);
    int i=0;

    System.out.println("hi1");
    File fp = new File(pathname);
    System.out.println("hi2");
    RandomAccessFile ra = new RandomAccessFile(fp,"r");
    System.out.println("hi3");
    long bytecount=1024;
    ////////////////

    while((i=ra.read(buf, 0, 1024)) != -1)
    {

    System.out.println("hi");

        bytecount += 1024;
        System.out.println("hi6");
        out.write(buf, 0, i);
        System.out.println("hi7");
        out.flush();
    }
    System.out.println("bye");
    //os.flush();
    //out.close();
    ra.close();
    //sock.close();
    }
    catch(IOException ex)
    {

    }
    } 
```

用于文件接收的客户端代码是

```
 public void run() {
        try{
            byte[] b = new byte[1024];
            int len = 0;
            long  bytcount = 1024;

            File fp = new File(path);
            RandomAccessFile ra=new RandomAccessFile(fp,"rw");
            ra.seek(0);
            InputStream is = sock.getInputStream();
            BufferedReader reader=new BufferedReader(new InputStreamReader(is));
            while ((len = is.read(b, 0, 1024)) != -1) {
                  bytcount = bytcount + 1024;

                  //decrypt

                  ra.write(b, 0, len);

            }
            //is.close();
            //ra.close();
            //sock.close();

        }
            catch(IOException ex){
            ex.printStackTrace();
            }

//        throw new UnsupportedOperationException("Not supported yet.");
    }

} 
```

我不知道这里出了什么问题。请提前帮助很多很多thanx

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:31:55.133

`send`是静态的，这表明您只有一个名为 的套接字，`sock`否则以下内容将无法编译。

```
 public static void send(String pathname) throws IOException, NoSuchAlgorithmException, NoSuchPaddingException
{

    try
    {
    System.out.println("....");

    byte[] buf = new byte[1024];
    OutputStream os = sock.getOutputStream();
    //PrintWriter writer = new PrintWriter(os);
    System.out.println("...11."); 
```

如果是这种情况，很难看出向 >1 个客户的交付如何可靠。您肯定需要每个客户端一个套接字来执行并发交付吗？需要更多代码才能确定这一点，但看起来套接字处理的设计可能需要修改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T21:01:26.797

您的第一个问题是您在服务器上使用 OutputStream 并在客户端使用 Reader。客户端应该使用 InputStreams，而不是 Readers。

# c# - 首次启动 C# 应用程序时如何将数据输入 SQL Server

> ID：13573041
> 
> 赞同：0
> 
> 时间：2012-11-26T20:57:06.177
> 
> 标签：c#, data-transfer, sql-server-2008-express

我使用 SQL Server 2008 Express 创建了一个 C# 程序。

为了 C# 应用程序正确运行，最初必须在数据库表中存在一些数据。

我想在 C# 应用程序第一次执行时将此数据传输到表中。

但是我不想从我的 C# 代码中读取这个 SQL 数据（记录数据）（我不想从硬编码的 C# 代码中加载这个数据）。

SQL Server 如何存储其记录数据，如何将初始数据传输到数据库中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:01:51.023

我会尽量不依赖现有的数据库来让您的应用程序工作。您将自己耦合到数据库，这可能不是一个好主意。你认为也许你可以从你的应用程序中执行一个存储过程来填写你所依赖的表吗？这样您的数据库创建代码就不会存在于您的应用程序中。然而，这仍然意味着您的应用程序依赖于数据库才能正常运行。

我会推荐两个计划之一，后者是更清洁的。

计划一

*   创建一个 SQL 脚本，该脚本将创建并插入应用程序工作所需的所有数据，并将其放置在存储过程中
*   当您的应用程序第一次启动时，它会检查配置文件以查看程序之前是否运行过，如果没有，则执行存储过程以创建所需的数据
*   更改一个外部配置文件（可能受密码保护），该文件将指示存储过程是否已经运行，可能只是一个简单的布尔值
*   应用程序每次后续运行时，它都会检查它是否之前运行过，如果有，则不会执行存储的过程

计划 2

*   创建一个 SQL 脚本，该脚本将创建并插入应用程序工作所需的所有数据，并将其放置在存储过程中
*   使用安装程序通过自定义操作部署您的应用程序以创建数据库，[此处解释](http://msdn.microsoft.com/en-us/library/49b92ztk%28vs.71%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:10:16.717

您肯定需要在某处至少部分硬编码 SQL 插入/创建脚本。在位于应用程序目录中的 SQL 脚本中（不推荐，因为用户可能会篡改它）或在应用程序的资源中（更安全一点，因为用户需要对 EXE 或 DLL 进行十六进制编辑）。

试过这个？[http://social.msdn.microsoft.com/Forums/en/adodotnetdataproviders/thread/43e8bc3a-1132-453b-b950-09427e970f31](http://social.msdn.microsoft.com/Forums/en/adodotnetdataproviders/thread/43e8bc3a-1132-453b-b950-09427e970f31)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T22:13:20.443

我认为您的问题很简单，您想在运行程序之前填写表格。简单地说，您可以打开 sql server managment studio 并连接您的实例名称，然后展开数据库列表并找到您创建的数据库。展开它并在表树中找到您要向其添加数据的表。右键单击它并做编辑

[Redgate](http://www.red-gate.com/products/sql-development/sql-data-generator/)也有一个产品来填充表格，叫做数据生成器，它可以用来填充你的表格有这么多的数据

# fancybox - 我无法在花哨的框中运行无右键单击按钮

> ID：13573042
> 
> 赞同：2
> 
> 时间：2012-11-26T20:57:18.217
> 
> 标签：fancybox

我无法使用另一个脚本运行花式框助手，特别是没有右键单击按钮，即让花式框显示否。图像。脚本像这样运行..

```
 <script type="text/javascript">
        $(document).ready(function() {
    $('.fancybox').fancybox({
      prevEffect : 'fade',
      nextEffect : 'fade',
      afterLoad : function() {
       this.title = 'Image ' + (this.index + 1) + ' of ' + this.group.length +          (this.title ? ' - ' + this.title : '');
      },
      helpers: {
       title: {
        type: 'inside'
       },
       thumbs: {
        width   : 50,
        height  : 50
          }
      }
     });
    });
    $(".fancybox")
        .attr('rel', 'images')
        .fancybox({
        beforeShow: function () {
            /* Disable right click */
            $.fancybox.wrap.bind("contextmenu", function (e) {
                    return false; 
            });
        }
    });    
</script> 
```

当我运行这个脚本时，只有没有。图像显示并且没有右键单击不起作用。请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-04T22:55:32.690

如果我将代码放在 Ready 函数中，我发现禁用右键单击是有效的

```
 $(document).ready(function () {
      $('.fancybox-thumbs').fancybox({
            prevEffect: 'none',
            nextEffect: 'none',

            closeBtn: true,
            arrows: false,
            nextClick: true,

            padding: 10,

            beforeShow: function () {
                 /* Disable right click */
                 $.fancybox.wrap.bind("contextmenu", function (e) {
                 return false;
                 });
                },

                afterLoad: function () {
                  var alt = this.element.find('img').attr('alt');

                  this.inner.find('img').attr('alt', alt);

                  this.title = alt;
                },

            helpers: {
                title: {
                    type: 'inside'
                },
                thumbs: {
                    width: 50,
                    height: 50
                }

            }
        });

    }); 
```

# jquery - 动画和 Chrome 的 jQuery 问题

> ID：13573048
> 
> 赞同：0
> 
> 时间：2012-11-26T20:57:35.207
> 
> 标签：jquery, google-chrome

这是 jQuery 的另一个线程和 Chrome 中的位置：D。我读了一些，但我无法找到解决方案。

```
function sliderCarousel(){

var count = $('#liste2').children().length; // Numbers of Elements in the Slider
var jump = $('#liste2 li:first').outerWidth(true); // Width of a single Element, including Margin(!)
var resultWidth = count * jump; // Width of all Elements in the Slider.
$('#liste2').width(resultWidth); // Sets the width of the ul to the calculated. Because the slider should work with a various number of Elements
                                 // you cant set a default width.
var unseenElementsNumber = Math.round((-1)*(resultWidth - $('#ein').width())/jump) - 1; // calculates the number of Sliderelements, which are hidden
var unseenElementsWidth = unseenElementsNumber * jump; // calculates the widht of unseen elements

    if(unseenElementsNumber >= 0)
    {
        $('#go').click(function() //rotate left
        {
            if(parseInt($('#liste2').css("left").replace("px","")) + 80 <= 0) // needed to prevent "overscrolling"
            {   
                $('#liste2').animate({
                "left": "+="+jump+"",
                }, 500 ); // speed of rotation
            }
        });

        $('#back').click(function() // rotate right
        {
            if(parseInt($('#liste2').css("left").replace("px","")) - 80 >= unseenElementsWidth) // needed to prevent "overscrolling"
            {   
                $('#liste2').animate({
                "left": "-="+jump+"",
                }, 500 ); // speed of rotation
            }
        });

        $('#start').click(function() //Return to start
        {
            $('#liste2').animate({
                "left": "0px",
                }, 500 ); // speed of rotation
        });
    } 
```

}

所以这是我的代码。它适用于 FF，但不适用于 Chrome。有任何想法吗？

# z3 - Z3中的skolemization

> ID：13573050
> 
> 赞同：3
> 
> 时间：2012-11-26T20:57:47.540
> 
> 标签：z3, smt, theorem-proving

我正在尝试使用[Skolemization](http://en.wikipedia.org/wiki/Skolem_normal_form)删除我的理论中的存在量词。这意味着我用存在量词范围内的普遍量化变量参数化的函数替换存在量词。

[在这里](https://stackoverflow.com/questions/7179777/z3-extracting-existential-model-values)，我找到了如何在 Z3 中执行此操作的说明，但我仍然无法执行此操作。假设有以下两个函数：

```
(define-fun f1 ((t Int)) Bool (= t 3))
(define-fun f2 () Bool (exists ((t Int)) (f1 t))) 
```

我相信这`f2`应该是正确的，因为存在一个`t`这样的整数`(f1 t)`是正确的，即`t=3`。我通过为存在量化公式引入一个常数来应用 Skolemization：

```
(define-const c Int) 
```

然后将存在量词的公式改写为：

```
(define-fun f2 () Bool (f1 c)) 
```

这不起作用，也就是说，常数`c`没有值 3。我怀疑这是因为我们没有对常数给出解释`c`，因为如果我们添加`(assert (= c 3))`它可以正常工作，但这会消除存在主义的整个想法量词。有没有一种方法可以让我给出一个不太明确的解释，`c`这样才能奏效？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-26T21:34:18.877

所以，我认为你实际上是正确的，这是我使用自动（通过 Z3 的 SNF 策略）和手动（通过添加常数 c）skolemization 的脚本，它在模型中为 skolem 常数提供了预期的值 3（ smt-lib 脚本：[http](http://rise4fun.com/Z3/YJy2) ://rise4fun.com/Z3/YJy2 ）：

```
(define-fun f1 ((t Int)) Bool (= t 3))
(define-fun f2 () Bool (exists ((t Int)) (f1 t)))
(declare-const c Int)
(define-fun f2a () Bool (f1 c))

(push)
(assert f2)
(check-sat) ; sat
(get-model) ; model gives t!0 = 3 (automatic skolemization in Z3)
(pop)

(push)
(assert f2a)
(check-sat) ; sat
(get-model) ; model gives c = 3 after manual skolemization
(pop) 
```

另外，请注意 Z3 内置了 Skolem 范式 (SNF) 转换策略，这是 z3py 中的一个示例（脚本链接：[http](http://rise4fun.com/Z3Py/ZY2D) ://rise4fun.com/Z3Py/ZY2D ）：

```
s = Solver()

f1 = Function('f1', IntSort(), BoolSort())
t = Int('t')
f2 = Exists(t, f1(t))
f1p = ForAll(t, f1(t) == (t == 3)) # expanded define-fun macro (define-fun f1 ((t Int)) Bool (= t 3))

s.add(f1p)
s.add(f2)

print f1p
print f2

print s.check()
print s.model() # model has skolem constant = 3

g = Goal()
g.add(f1p)
g.add(f2)
t = Tactic('snf') # use tactic to convert to SNF
res = t(g)
print res.as_expr()
s = Solver()
s.add( res.as_expr() )
print s.check()
print s.model() # model has skolem constant = 3 
```

# c++ - 从文件输入 CGAL 类

> ID：13573051
> 
> 赞同：1
> 
> 时间：2012-11-26T20:57:55.997
> 
> 标签：c++, input, cgal

有没有一种简单的方法可以使用 CGAL 从同一个文件中读取 2D 中的点和线段？

这个文件的格式应该是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:06:44.880

在 CGAL`operator<<`中，内核对象和流是重载的。该格式显然没有记录，但对于更简单的类型来说很明显。

```
#include <CGAL/basic.h>
#include <CGAL/Simple_cartesian.h>

typedef CGAL::Simple_cartesian<double> K;

int main()
{
  K::Point_2 p;
  std::stringstream ss;
  ss << "2.05 3.05";

  ss >> p; // read from a stream
  std::cout << p << std::endl; // write to a stream

  K::Segment_2 s;
  ss.clear();
  ss << "2.3 4.2 4.2 2.3";
  ss >> s; // read a segment from a stream
  std::cout << s << std::endl; // write a segment to a stream
  return 0;
} 
```

查看代码 a`CGAL::Polygon_2`期望输入如下：

```
"4 0 0 0 1 1 1 1 0" 
```

其中第一个数字是后面的点数，然后是点数。

# matlab - 脑筋急转弯 - 使用移动平均线的过滤算法

> ID：13573052
> 
> 赞同：6
> 
> 时间：2012-11-26T20:57:56.683
> 
> 标签：matlab, filter, indexing, find, octave

我在 Matlab 中有一个 86400 风速 (WS) 值的 1 秒数据集，需要帮助来过滤它。它需要一定程度的聪明才智。

如果平均 WS 超过：

*   25m/s，600s 时间间隔
*   28m/s，30s 时间间隔
*   在 3 秒的时间间隔内 30m/s

如果满足这些参数中的任何一个，则 WS 被视为“无效”，直到平均 WS 在 300 秒的时间间隔内保持在 22m/s 以下。

这是我对 600 秒的要求。我对“数据集”中包含的数据进行了 600 和 300 秒的移动平均。我过滤了从平均 25m/s 的第一次出现到下一次出现低于 22m/s 的值的间隔作为“NaN”。过滤后，我将再做 600 秒的平均，带有 NaN 标记的值的间隔将保留为 NaN。

IE

```
Rolling600avg(:,1) = tsmovavg(dataset(:,2), 's', 600, 1);

Rolling300avg(:,1) = tsmovavg(dataset(:,2), 's', 300, 1);

a = find(Rolling600avg(:,2)>25)

b = find(Rolling300avg(:,2)<22)

dataset(a:b(a:find(b==1)),2)==NaN; %?? Not sure 
```

这需要巧妙地使用“查找”和一些索引。有人可以帮我吗？28m/s 和 30m/s 过滤器将遵循相同的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:28:06.770

如果我遵循您的问题，一种方法是使用 for 循环来确定 NaN 应该在哪里开始和结束。

```
m = [19 19 19 19 28 28 19 19 28 28 17 17 17 19 29 18 18 29 18 29]; %Example data
a = find(m>25);
b = find(m<22); 
m2 = m;
% Use a loop to isolate segments that should be NaNs;
for ii = 1:length(a)
     firstNull = a(ii) 
     lastNull  = b( find(b>firstNull,1) )-1 % THIS TRIES TO FIND A VALUE IN B GREATER THAN A(II)
     % IF THERE IS NO SUCH VALUE THEN NANS SHOULD FILL TO THE END OF THE VECTOR
     if isempty(lastNull), 
         lastNull=length(m); 
     end 
     m2(firstNull:lastNull) = NaN
end 
```

请注意，这仅在 tsmovavg 返回与传递给它的向量相同长度的向量时才有效。如果没有，那就更棘手了，需要进行一些修改。

可能有一些方法可以避免 for 循环，但这是一个非常直接的解决方案。

# ios - iOS从视图控制器关闭popovercontroller

> ID：13573055
> 
> 赞同：0
> 
> 时间：2012-11-26T20:58:06.367
> 
> 标签：ios, uiviewcontroller, uipopovercontroller

我正在研究 SO，并认为我已经知道如何做到这一点，但我的测试失败了。我试图从它启动/包含的视图控制器中关闭一个弹出控制器（我对 poc 和 vc 的关系仍然有点模糊）。

在我的 viewcontroller .h 我有这个：

```
@interface OAI_vcOperatingRooms : UIViewController {

    OAI_ColorManager* colorManager;
    OAI_FileManager* fileManager;

    UIPopoverController* myPopOverController;

}

@property (nonatomic, weak) UIPopoverController* myPopOverController;

- (void) closeVC : (id) sender; 
```

并在 .m 文件中

```
UIButton* btnClose = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    [btnClose addTarget:self 
               action:@selector(closeVC:)
     forControlEvents:UIControlEventTouchDown];
    [btnClose setTitle:@"Close" forState:UIControlStateNormal];
    btnClose.frame = CGRectMake(10.0, 210.0, 160.0, 40.0);

    [self.view addSubview:btnClose];

- (void) closeVC : (id) sender {

    [myPopOverController dismissPopoverAnimated:YES];
} 
```

在调用popovercontroller的uiview中，我引用了viewcontroller并添加了这个：

```
//operating rooms
        controller2 = [[OAI_vcOperatingRooms alloc] initWithNibName:@"OAI_vcOperatingRooms" bundle:nil];
        popoverController2 = [[UIPopoverController alloc] initWithContentViewController:controller2];

        controller2.myPopOverController = popoverController2; 
```

没有错误，但当我点击关闭按钮时没有任何反应。是否可以从 VC 中引用 POC？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:28:18.910

我相信 ott 的评论是针对某事的 - 尝试使用`strong`属性而不是属性`weak`。属性很可能在最后一次`weak`使用后立即被 ARC 设置为 nil。除非您将其设置为 early，否则属性将在其父对象（在本例中为您的子类）的生命`strong`周期内一直存在。`UIViewController``nil`

注意：您可能不需要`UIPopoverController *myPopOverController;`在您的界面中，因为 Xcode 会自动生成`_myPopOverController`作为支持变量。

# mongodb - 将一个属性的值更新为同一文档中另一个属性的值

> ID：13573069
> 
> 赞同：0
> 
> 时间：2012-11-26T20:59:04.517
> 
> 标签：mongodb, mongodb-.net-driver

我们如何在 MongoDb 中复制以下 sql 查询？

```
update Person set Alias = Name; 
```

表的`Person`列`Alias, Name`

我希望查询影响多行。如果更新查询不支持 upserts 也没关系，我只需要更新而不是插入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T00:37:02.163

不幸的是，该功能在 MongoDB 中不可用。您将需要遍历文档，一次更新它们，并执行读取-更新对。

如果您希望这是并发安全的，则需要实现某种锁定；要么乐观，要么悲观。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T21:05:22.507

```
myDb.myCollection.find({}).forEach(
function (person) { 
      person.Alias = person.Name
      myDb.myCollection.save(person)
}
) 
```

# c# - 如何正确转义此字符串

> ID：13573073
> 
> 赞同：6
> 
> 时间：2012-11-26T20:59:21.087
> 
> 标签：c#, string

我有一个要发送到外部打印函数的字符串。
我需要用反斜杠填充字符串，以便正确打印。

具体来说，我需要一个可以接受这个示例输入的方法：
`This is a string\nwith a line break\ta tab\rand a carriage return.`

和输出：
`This is a string\\nwith a line break\\ta tab\\rand a carriage return.`

`Replace`我是否需要用它的反斜杠等价物暴力破解所有可能的转义字符？

尝试过：
`s.Replace("\\","\\\\")` 不起作用，因为它正在寻找反斜杠文字。

`s.Replace("\n","\\n")`显然有效，但我正在寻找的是一种通用方法。

编辑： **请不要建议蛮力方法，我理解实现这样的方法是没有问题的。我的问题是是否有更通用的方法。**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-26T21:20:30.237

```
private static string EscapeLiterals(string input)
{
    using (var writer = new StringWriter())
    {
        using (var provider = CodeDomProvider.CreateProvider("CSharp"))
        {
            provider.GenerateCodeFromExpression(new CodePrimitiveExpression(input), writer, null);
            return writer.ToString();
        }
    }
} 
```

接受输入`"\tHello\r\n\tLiterals!"`并将其转化为`"\\tHello\\r\\n\\tLiterals!"`

适用于任何输入 - 它会给你任何东西的转义序列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T06:23:41.563

这是我用于此的功能。多年来我一直在生产代码中使用它，它似乎可以抵御各种极端情况。

```
/// <summary>
/// Escapes all characters in this string whose code is less than 32 using C/C#-compatible backslash escapes.
/// </summary>
public static string CLiteralEscape(this string value)
{
    if (value == null)
        throw new ArgumentNullException("value");

    var result = new StringBuilder(value.Length + value.Length / 2);

    for (int i = 0; i < value.Length; i++)
    {
        char c = value[i];
        switch (c)
        {
            case '\0': result.Append(@"\0"); break;
            case '\a': result.Append(@"\a"); break;
            case '\b': result.Append(@"\b"); break;
            case '\t': result.Append(@"\t"); break;
            case '\n': result.Append(@"\n"); break;
            case '\v': result.Append(@"\v"); break;
            case '\f': result.Append(@"\f"); break;
            case '\r': result.Append(@"\r"); break;
            case '\\': result.Append(@"\\"); break;
            case '"': result.Append(@"\"""); break;
            default:
                if (c >= ' ')
                    result.Append(c);
                else // the character is in the 0..31 range
                    result.AppendFormat(@"\x{0:X2}", (int) c);
                break;
        }
    }

    return result.ToString();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T21:02:25.220

您可以使用多个替换来强制用可读的控制字符替换空格：

```
s = s.Replace("\n", "\\n").Replace("\r", "\\r").Replace("\t", "\\t"); 
```

但是，您不能像您想的那样简单地将反斜杠加倍，因为字符已经在内存中使用其二进制值进行了转换。所以你需要手动替换每个字符。

# c# - 当我将函数设置为运行 onselectedindexchanged 时，我的程序只是忽略了该命令

> ID：13573076
> 
> 赞同：0
> 
> 时间：2012-11-26T20:59:35.780
> 
> 标签：c#, asp.net, code-behind

我正在做一个网页。这里的目标是在您从下拉列表中选择文件时打开文件。这是我现在遇到的问题代码：

```
<asp:DropDownList ID="dropdownFiles" runat="server" Height="18px" onselectedindexchanged="File_Opener" Width="380px">
                <asp:ListItem>Please choose a file...</asp:ListItem>
</asp:DropDownList> 
```

看到“onselectedindexchanged”部分了吗？那么在代码隐藏中，我有以下功能：

```
public void File_Opener(object sender, EventArgs e)
    {
        //here's where I would open the files, but it never even hits this function!
    } 
```

出于某种原因，在下拉列表中选择某些内容甚至不会触发该功能。请解释。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:01:39.513

我认为您需要将下拉菜单设置为自动回发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:19:43.863

打开文件或对选择执行操作是一种糟糕的用户体验，为什么？？？因为我可能认为我选择了一个文件名并单击了错误的文件名。选择文件后最好有一个按钮来启动您想要执行的任何过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T21:06:46.243

使用`AutoPostBack`属性：

```
<asp:DropDownList ID="dropdownFiles" runat="server" Height="18px" onselectedindexchanged="File_Opener" Width="380px" AutoPostBack="True">
                <asp:ListItem>Please choose a file...</asp:ListItem>
</asp:DropDownList> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T22:27:28.803

幽默我：尝试在`OnSelectedIndexChanged`. 看看这是否有所作为。

# java - Hibernate 版本控制 - 管理单独的字段更新

> ID：13573086
> 
> 赞同：0
> 
> 时间：2012-11-26T21:00:28.937
> 
> 标签：java, hibernate, backend, spring-transactions, application-design

我有一个后端应用程序，该应用程序没有任何用户界面。这些操作由服务器在 UDP 和 TCP 端口上侦听的传入数据触发。

我们有 Customer 表，该表有 15 个字段。每个字段代表一些关键细节或指向其他信息的指针。例如，

```
CUSTOMER_TABLE {
 ID,
 NAME,
 DEFAULT_ADDRESS_ID,
 EMAIL_ADDRESS,
 LAST_LOGIN,
 VERSION   <--- trying to introduce
} 
```

除了 ID 之外，这些字段中的每一个都可以由不同的进程一次更新。当两个并发进程覆盖彼此的值时，我遇到了问题。所以，我介绍了 VERSION - hibernate 生成的版本字段。

现在假设服务器 1 在时间 T1 选择了版本#400 的客户模型 服务器 2 在时间 T1 选择了版本#400 的客户模型

Server1 更改 EMAIL_ADDRESS 并更新 CUSTOMER（在 T2 处），因此新版本号为 401（休眠生成）。

Server2 更改 NAME 并尝试在 T3 更新 CUSTOMER ，因为版本号比 DB 中的版本号旧，事务将失败。

由于应用程序是非用户界面应用程序，我们不能真正要求用户授权更改......我们必须优雅地处理它，以便更改通过。

我有什么办法来处理这种情况？

该应用程序具有以下结构

`Listening Port Handler -> Service Wrapped in Transaction -> DAO -> DB`

对于下一个 - 这是一个免责声明 - 我知道这是一个糟糕的设计......但不幸的是，该应用程序已经从一个非事务性应用程序以一种非常计划外的方式发展为事务性应用程序......我没有对决定“何时”修复整体设计有很大的控制权。现在的结构......

```
Listening Port Handler -> Service invoked to get the model(ModelX) -> DAO -> DB (yes you are right, the model goes out of transaction boundary ... :-( )
                       -> Invoke different independent operations, each operation wrapped in txn -> DAO -> DB
                       -> Modify Model (ModelX)
                       -> Update model(ModelX) as a separate transaction -> DAO -> DB 
```

我在第二个中会遇到问题，我无法刷新我的模型，因为如果我这样做了，我将失去对模型所做的所有更改，或者我将不得不再次重复所有步骤，这可能会导致其他成功操作开火两次（至少）

我的问题是 - 无论如何

1.  hibernate可以理解被修改的属性
2.  检查版本
3.  如果手头的版本过时，请获取新版本并在新版本上应用更改
4.  保存对象（而不是抛出异常）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:46:03.240

一种选择是使用[Hibernate](http://hibernate.org)`dynamicInsert/dynamicUpdate`的功能。不过，您将不得不摆脱版本控制。[这是Hibernate 文档](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch05.html#mapping-declaration-class)的摘录：

> 动态更新（可选 - 默认为 false）：指定 UPDATE SQL 应在运行时生成，并且只能包含值已更改的那些列。

可以在[此处](http://www.mkyong.com/hibernate/hibernate-dynamic-update-attribute-example/)找到此功能的示例。

# python - 分段错误获得一些分数

> ID：13573087
> 
> 赞同：1
> 
> 时间：2012-11-26T21:00:35.037
> 
> 标签：python, ipython

```
del_between=raw_input('Do you want to delete all the points between two points? input "N" or "Y"')
if del_between=="N" or del_between=="n":
    print "You have choosen NOT to delete all the points between two points."
if del_between=="Y" or del_between=="y" :
    print "Please click the first bad point and the last bad point to choose the range of the bad points"
    between_badpoints=ginput(n=2)
    print between_badpoints
    index_between_badpoints=[]
    for i in range(len(between_badpoints)):
         index_between_badpoints.append(int(np.interp(between_badpoints[i][0],jd2,range(len(jd2)))))
    print index_between_badpoints
    index_betweens=[]
    for i in range(sorted(index_between_badpoints)[0],sorted(index_between_badpoints)[1]+1):
         index_betweens.append(i)
    print index_betweens
    for i in index_betweens[::-1]:
         del lat[i],lon[i],time[i],yeardays[i],depth[i],temp[i] 
```

这个程序试图删除收集到的两点之间的所有点。问题是当我尝试运行这个程序时，它会显示分段错误。

当我单击选择点时，它会引发异常“分段错误”，所以我认为问题可能集中在这一行'between_badpoints = ginput（n = 2）'。但我不明白为什么它是错误的。

（我在同一个程序中使用过这个'ginput'命令并且效果很好，然后我删除了ginput变量并像这样再次使用它，它无法工作。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:23:36.667

我已经想通了。这是我第二次在这个程序中使用ginput，但我还没有创建一个新的数字。添加'fig=plt.figure()'行后，每一步都很顺利。可能是每个数字ginput 只能使用一次。

# asp.net - 在 Asp.Net 中回发后加载 DropDownList OnDemand 并展开 DropDown

> ID：13573088
> 
> 赞同：0
> 
> 时间：2012-11-26T21:00:35.513
> 
> 标签：asp.net, visual-studio-2010, web-deployment

单击时尝试填充 DropDownList (Asp.Net)。我在下面有一个示例，但我无法让 DropDownList 在加载后保持展开状态。除了使用 3rd 方控件之外，有没有人有从服务器按需加载的解决方案？

JavaScript

```
<script type="text/javascript">
    function LoadOnDemand(ddl) {
        if (ddl != "") {
            var control = document.getElementById(ddl.id);
            __doPostBack(ddl.id, "LoadOnDemand");
        }
    }
    function AfterLoadOnDemand(ddl) {
    }

</script> 
```

标记

```
<body>
    <form id="form1" runat="server">
        <div>
            <asp:Panel ID="DynamicPanel" runat="server" Width="200">
            </asp:Panel>
        </div>
    </form>
</body> 
```

代码隐藏

```
 Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    Dim target As String = Page.Request.Params.Get("__EVENTTARGET")
    Dim eventarg As String = Page.Request.Params.Get("__EVENTARGUMENT")

    Call CreateDynamicControls()

    If IsPostBack Then
        If target <> "" Then
            If eventarg = "LoadOnDemand" Then
                Dim ctrl As Control = FindControl(target)

                If ctrl IsNot Nothing Then
                    If TypeOf ctrl Is DropDownList Then
                        'Note: values would be from a database or table query. 
                        '      and some other logic. Simplified here.
                        Dim ddl As DropDownList = CType(ctrl, DropDownList)
                        ddl.Items.Clear()
                        ddl.Items.Add("one")
                        ddl.Items.Add("two")
                        ddl.Items.Add("three")

                        'remove onfocus from this control so it doen't fire again 
                        'if they click it immediatly after loading
                        ddl.Attributes.Add("onfocus", "AfterLoadOnDemand(this)")
                    End If

                    'reset the LoadOnDemand for all the other DropDownList controls
                    For Each notFocusedControl As Control In DynamicPanel.Controls
                        If TypeOf notFocusedControl Is DropDownList Then
                            Dim ddl As DropDownList = CType(notFocusedControl, DropDownList)
                            If ddl.ID <> target Then
                                ddl.Attributes.Add("onfocus", "LoadOnDemand(this)")
                            End If
                        End If
                    Next
                End If

            End If
        End If
    End If

End Sub

Protected Sub CreateDynamicControls()
    For i As Integer = 0 To 2
        Dim ddl As New DropDownList
        ddl.ID = "DropDownList" & i
        ddl.Width = 150
        ddl.Items.Add("Browse me..")
        ddl.Attributes.Add("onfocus", "LoadOnDemand(this)")
        ddl.AutoPostBack = True
        ddl.EnableViewState = True
        DynamicPanel.Controls.Add(ddl)
        DynamicPanel.Controls.Add(New LiteralControl("<br/><br/>"))
    Next
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T14:15:00.573

我发现如何扩展它的唯一方法是通过仿真。这是一个链接 ( [ExpandSelect](http://code.google.com/p/expandselect/) )，它有一个 JavaScript 函数可以做到这一点。这是另一个参考[链接](https://stackoverflow.com/questions/360431/can-i-open-a-dropdownlist-using-jquery)。

我将以下（初始宽度参数）添加到 .js 文件中。这可以防止展开的下拉菜单缩小到小于下拉菜单的初始宽度。

```
function ExpandSelect(select, maxOptionsVisible, initialWidth) {

    //code - see file
    select.style.zIndex = "1000000";

    //Added this right after the zIndex
    if (dropWidth < initialWidth) {
        select.style.width = initialWidth + 'px';
        select2.style.width = initialWidth + 'px';
    }

    //code - see file

    } 
```

# javascript - 如何为图像框创建翻转？

> ID：13573091
> 
> 赞同：1
> 
> 时间：2012-11-26T21:00:48.110
> 
> 标签：javascript, image, html, widget, rollover-effect

我有一个容器（宽 500 像素，高 800 像素）。容器使用图像作为背景，在中间我想添加一个按钮，上面写着“注册”。当用户单击注册按钮时，我想要一个弹出在同一个容器中的注册表单。

换句话说，我需要一个翻转效果，其中背景将颜色更改为其他颜色，并且使用相同的容器作为注册框。而且我需要保持转换，直到用户点击关闭按钮或类似的东西。

我怎样才能做到这一点？任何想法将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:08:16.477

您可以将 2 个容器彼此叠放并淡入/淡出顶部的一个 -[**演示**](http://jsfiddle.net/k6kKR/)

***HTML***

```
<section>
    <div id="lower">
        <button> Close </button>
    </div>

    <div id="upper">
        <button> Sign up </button>
    </div>
</section> 
```

***CSS***

```
div {
    position: absolute;
    left: 20px;
    top: 20px;
    height: 300px;
    width: 400px;
    line-height: 300px;
    text-align: center;
}

#lower { background: honeydew; }
#upper { background: beige; } 
```

***jQuery***

```
$("#upper button").on("click", function() {
    $("#upper").fadeOut(300);
});

$("#lower button").on("click", function() {
    $("#upper").fadeIn(300);
}); 
```

# linux - 无法获得这个简单的 sed 命令

> ID：13573092
> 
> 赞同：0
> 
> 时间：2012-11-26T21:00:50.153
> 
> 标签：linux, bash, shell, unix

该`sed`命令描述如下

> 删除 10,000 美元或更多的汽车。将 的输出通过管道传输`sort`到 a`sed`中来执行此操作，只要我们匹配表示记录末尾的 5 个（或更多）数字的正则表达式就退出（不要为此使用重复）：

到目前为止，命令是：

```
$ grep -iv chevy cars | sort -nk 5 
```

我必须在该命令的末尾添加另一个管道，我认为它“一旦我们匹配代表记录末尾的 5 个或更多数字的正则表达式就退出”

我尝试过类似的事情

```
$ grep -iv chevy cars | sort -nk 5 | sed "/[0-9][0-9][0-9][0-9][0-9]/ q" 
```

和其他变体`//`但没有任何作用！根据这个问题，匹配代表 5 个或更多数字的正则表达式并退出的命令是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T21:27:24.410

名义上，您应该`$`在第二个之前添加一个`/`以匹配记录末尾的 5 位数字。如果您省略`$`，则任何 5 位数字序列都会导致`sed`退出，因此如果价格之前有另一个数字（可能是 VIN），它可能会在您不打算匹配时匹配。

```
grep -iv chevy cars | sort -nk 5 | sed '/[0-9][0-9][0-9][0-9][0-9]$/q' 
```

总的来说，在正则表达式周围使用单引号更安全，除非您需要将 shell 变量替换为其中（或者除非正则表达式本身包含单引号）。您还可以指定重复：

```
grep -iv chevy cars | sort -nk 5 | sed '/[0-9]\{5,\}$/q' 
```

该`\{5,\}`部分匹配 5 个或更多数字。如果由于任何原因不起作用，您可能会发现您正在使用 GNU `sed`，并且您需要做一些事情`sed --posix`来让它在正常模式下工作。或者您可以只删除反斜杠。GNU 肯定有`sed`改变它使用的正则表达式机制的选项（就像 GNU 一样`grep`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-11T19:42:41.890

其他方式。

由于您没有发布文件示例，因此这是猜测。在这里，我正在寻找字段 5 小于 10000 的带有单词“chevy”的行。

awk '/chevy/ {if ( $5 < 10000 ) print $0} ' 汽车

我忘记了来自 grep 的标志 -i ...所以正确的是：

awk 'BEGIN{IGNORECASE=1} /chevy/ {if ( $5 < 10000 ) print $0} ' 汽车

$猫>汽车

雪佛兰 2 3 4 10000

雪佛兰 2 3 4 5000

雪佛兰 2 3 4 1000

雪佛兰 2 3 4 10000

雪佛兰 2 3 4 2000

上一页 2 3 4 1000

上一页 2 3 4 10000

$ awk 'BEGIN{IGNORECASE=1} /chevy/ {if ( $5 < 10000 ) print $0} ' 汽车

雪佛兰 2 3 4 5000

雪佛兰 2 3 4 1000

雪佛兰 2 3 4 2000

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-27T23:28:21.330

```
grep -iv chevy cars | sort -nk 5 | sed '/[0-9][0-9][0-9][0-9][0-9]$/d' 
```

# mysql - 如何从sql语句中选择精确值

> ID：13573094
> 
> 赞同：1
> 
> 时间：2012-11-26T21:00:55.660
> 
> 标签：mysql, select, exact-match

我有多个以“She”开头的记录，例如“shepherd”、“shell”、“shelf”……我想返回带有“she”的记录

```
SELECT records FROM MYTABLE WHERE records = 'She' 
```

然而，这会返回上面提到的所有数据......我怎样才能在没有其余数据的情况下只返回“她”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:08:54.727

如果您想获取带有“She”的单词的记录，则查询应该是：

```
SELECT records FROM MYTABLE WHERE records LIKE 'She %' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:13:25.093

只选择以“she”开头的那些（还将选择以“shephard”等开头的记录）：

```
 SELECT records FROM MYTABLE WHERE records LIKE 'she%' 
```

里面有“她”字的：

```
 SELECT records FROM MYTABLE 
      WHERE records LIKE 'she %' OR 
            records LIKE '% she %' OR 
            records LIKE '% she' 
```

您也许也可以使用正则表达式。

# mysql - 有没有办法将大量值间隔插入MySql？

> ID：13573102
> 
> 赞同：0
> 
> 时间：2012-11-26T21:01:49.807
> 
> 标签：mysql, wordpress, drupal, limit

我目前正在将 Drupal 博客导入 Wordpress，并且有很多页面和博客文章要导入。当我运行查询时，它说它没有足够的内存或崩溃。我可以使用 逐个运行查询`LIMIT`，但我想知道是否有一些更聪明的方法来做同样的事情。

通过运行for循环一次插入一定数量的值，或者在执行查询后执行查询的回调函数......我不确定。是否已经有“最佳实践”方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T09:07:21.637

是的，使用脚本 bigdump [http://www.ozerov.de/bigdump/](http://www.ozerov.de/bigdump/)。它执行一个 sql 文件的交错导入。我总是用它来导入比我的 phpMyAdmin 允许的更大的数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-25T09:11:51.540

如果您在脚本中使用 wordpress 'wp_insert_post' 函数，Wordpress 将缓存 $post 对象，如果创建了大量帖子，则会出现内存限制问题。

为避免此问题，`wp_suspend_cache_addition(true);` 请在脚本开头使用 :，以便 WP 停止缓存每个帖子对象

# c# - .NET 应用程序版本如何工作？

> ID：13573106
> 
> 赞同：0
> 
> 时间：2012-11-26T21:01:55.863
> 
> 标签：c#, .net, version

我在我的解决方案中设置了一个安装程序（安装程序）项目，并且有 1.0.0 版本。

我的问题是，版本控制如何工作？

每个数字是什么意思，它是如何增加的？谁能告诉我这个编号系统是如何工作的？

最后，我将如何在表单上显示版本号？

我试过了：

```
Assembly.GetExecutingAssembly().GetName().Version; 
```

但这显示的是 1.0.0.0，而不是我放入安装程序 (1.2) 的版本。

处理版本号的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T21:08:14.223

您尝试检索的版本`Assembly.GetExecutingAssembly().GetName().Version`需要在[Project Properties, Assembly Information](http://msdn.microsoft.com/en-us/library/vstudio/ts8eta17%28v=vs.100%29.aspx)中设置。

可以在[此处](http://msdn.microsoft.com/en-us/library/51ket42z%28v=vs.100%29.aspx)找到有关版本号的信息。

# java - 班级决定有问题

> ID：13573107
> 
> 赞同：0
> 
> 时间：2012-11-26T21:01:57.470
> 
> 标签：java, class

考虑一个保存和报告保龄球俱乐部保龄球运动员和球队信息的计划。每周都有一场比赛。每位球员以 4 人一组的形式进行 3 场比赛。球队根据他们在锦标赛中击败的球队数量来积累积分，并跟踪球员的平均水平。列出类和类职责。

最好的方法是什么？

这些是我到目前为止的课程：

*   `BowlerNames`创建一个数组，其中存储保龄球运动员的姓名
*   `Teams`从 BowlerNames 中的数组中获取名称并将它们放入团队中
*   `TeamScore`启动对象 TeamScore 和玩家得分
*   `Game`在比赛中记录投球手得分
*   `points`在他们的比赛中获得球员的得分并将其添加到他们的球队得分中
*   `TeamWin`启动一个 wins 对象，如果一个团队的点数大于另一个团队，它会将一个添加到 wins 对象
*   `Average`获取玩家得分对象并找到其平均值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:46:59.623

一些建议，仅仅因为你可以，并不意味着一切都必须是一个类。有些东西，例如，球队的分数是关于某人或某事的信息。那些，而不是一个类，是字段。

你什么时候需要上课？当你有一个实体、一个对象、一个你想在你的代码中表示的人时。一个人、一辆车、一件物品，这些都是类的经典例子。

你必须找到你要编写代码的不同事物之间的关系，并通过编写想到的想法来赋予它们应有的行为。例如：

*   玩家被*分组*
*   球员*平均*得分
*   团队*参加*比赛
*   团队*累积*分数
*   所有信息都由程序*管理*

您还可以提出其他几个想法，但只要您尝试学习识别它们背后的模式。行动通常代表从管理到“知道”某事的各种责任。主题通常是类，除非您在谈论一些更高级别的功能。在这些情况下，您有特定的类来管理信息。

我会在这里说一些豆子，但你似乎需要一个起点，不是为你做，而是为你应该如何解决问题提供一些启示。先接近，后解决。

`TeamScore`比较没用。顾名思义，它是 a`Team`的分数，所以实际上，它是 a`Team`的属性而不是对象本身，因为它只会保存实际的分数。你如何计算平均值以及如何添加分数取决于你，只要记住你正在编写一个小应用程序

> 用于保存和报告信息（...）

# javascript - 如何在 css/javascript 中制作随分辨率缩放的全出血背景图像？

> ID：13573108
> 
> 赞同：0
> 
> 时间：2012-11-26T21:01:59.370
> 
> 标签：javascript, jquery, css, html

> **可能重复：**
> [Firefox 中的全屏背景图像](https://stackoverflow.com/questions/9278470/full-screen-background-image-in-firefox)

看到这个： http: [//www.ingress.com/](http://www.ingress.com/)

你如何做这样的事情，在任何显示器分辨率下看起来都是正确的？在 Ingress 站点中，看起来甚至内容的大小（例如 iphone 图像）都会随着您缩小或增加分辨率/窗口大小而缩放。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T21:04:52.167

这很简单，但它是 CSS3，旧浏览器不支持。在你的 CSS 中使用[`background-size:cover`](https://developer.mozilla.org/en-US/docs/CSS/background-size)或。`background-size:contain`

[CSS-tricks 有一篇文章介绍](http://css-tricks.com/perfect-full-page-background-image/)了其他更强大的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T21:06:08.690

这就是你要找的东西：

```
<body style="background:url(image.jpeg) no-repeat center center fixed"> 
```

# icons - 带有图标的 KMZ 文件

> ID：13573111
> 
> 赞同：2
> 
> 时间：2012-11-26T21:02:17.513
> 
> 标签：icons, kml, google-earth, kmz

我正在尝试在 KMZ 文件中放置一个图标，以便用户在单击精确点时可以查看缩略图。我有以下代码 - 它正在工作，但没有显示图标/缩略图。我看过谷歌开发者，看不出有什么区别。只需要第二双眼睛就能看到它。

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
<Placemark>
<name>Evidence File</name>
<description>SAMSUNG - GT-I9000
2012:10:25 17:36:57
2797 KB
Height: 2448 Pixels
Width:  3264 Pixels
C:\Users\Steve\Desktop\FYP Cases\M2510\IMG_20121025_163656.jpg</description>
<IconStyle><scale>1.1</scale><Icon><href>C:\Users\Steve\Desktop\FYP Cases\M2510\IMG_20121025_163656.jpg</href></Icon></IconStyle>
<Point>
<coordinates>-2.6172222222222223,51.43</coordinates>
</Point>
</Placemark>
</kml> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:38:28.410

您在 KML 文件 (C:\Users\Steve...) 中对文件有绝对引用。如果图像在您的 KMZ 内，那么您应该参考相对文件位置。此外，文件路径 C:... 不是有效的 URL，如果使用绝对 URL，则应采用 http:// 或 file:// 的形式。

假设 KMZ 文件有两个条目（按此顺序）：

*   文档.kml
*   IMG_20121025_163656.jpg

doc.kml 中的 IconStyle 应该这样重写：

```
<IconStyle>
    <scale>1.1</scale>
    <Icon>
        <href>IMG_20121025_163656.jpg</href>
    </Icon>
</IconStyle> 
```

# visual-studio-2012 - 如何使用 Fakes Framework 垫片模拟/隔离 VS 2012 中的内部类？

> ID：13573112
> 
> 赞同：9
> 
> 时间：2012-11-26T21:02:16.987
> 
> 标签：visual-studio-2012, internalsvisibleto, microsoft-fakes

所以，问题是我的程序集中有一堆内部类，供我要测试的类使用。由于访问器已从 VS2012 中删除，我可以很好地使用`[InternalsVisibleTo]`并且效果很好......除非我尝试改变我的内部类，它们对 Fakes 框架不可见。我还应该注意，我正在处理的特定类是具有静态方法的静态类，并且我真的不想重构所有内容以使用接口（和使用存根），因为组织中对这种重构级别的抵制。

有没有办法让这些内部成员在 Visual Studio 2012 中的 shims 上下文中可用，而无需诉诸接口（字面意思）一切？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-26T21:35:44.170

以下页面描述了如何使内部类型对生成的 fakes 程序集可见。[http://msdn.microsoft.com/en-us/library/hh708916.aspx#bkmk_internal_types](http://msdn.microsoft.com/en-us/library/hh708916.aspx#bkmk_internal_types)

其中说：

> Fakes 代码生成器将为生成的 Fakes 程序集可见的类型生成 shim 类型和存根类型。要使填充程序集的内部类型对 Fakes 和您的测试程序集可见，请`InternalsVisibleToAttribute`向填充程序集代码添加属性，以使生成的 Fakes 程序集和测试程序集可见。

因此，您需要一个`InternalsVisibleToAttribute`授予您的测试程序集访问目标程序集内部类型的权限。换句话说：

```
[assembly: InternalsVisibleTo("TargetAssembly.Fakes")]
[assembly: InternalsVisibleTo("TestAssembly")] 
```

# sql-server - 在 SQL Server Compact 中限制结果

> ID：13573113
> 
> 赞同：1
> 
> 时间：2012-11-26T21:02:18.340
> 
> 标签：sql-server, sql-server-ce

我想从表中选择第一行之后的前 4 行。我在 MySQL 中有这个工作如下：

```
SELECT * FROM `yp_playlist` LIMIT 1, 4; 
```

我做了一些研究以查看此查询的 SQL Server 版本，并得出以下结果，但这一直导致我陷入一个错误，这让我现在一无所知。

```
SELECT id, entry 
FROM (
    SELECT id, entry, ROW_NUMBER() OVER (ORDER BY id) AS RowNum
    FROM playlist
) AS MyDerivedTable
WHERE MyDerivedTable.RowNum BETWEEN 0 AND 10 
```

这是错误：

> *解析查询时出错。[令牌行号 = 3，令牌行偏移量 = 36，错误令牌 = OVER ]*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T08:38:51.747

使用 SQL Server Compact 4.0，您可以使用；

```
SELECT * FROM [Orders] ORDER BY [Order Date] OFFSET 1 ROWS 
FETCH NEXT 4 ROWS ONLY; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:04:31.540

```
SELECT TOP 10 * 
FROM ( SELECT id, entry 
       FROM playlist 
       ORDER BY id ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T21:05:35.967

一种方法是`set rowcount`

例如

```
set rowcount 4 
```

然后订购您的数据，以便您在顶部获得所需的数据

# python - 抓取表格并将行写入 CSV

> ID：13573122
> 
> 赞同：0
> 
> 时间：2012-11-26T21:03:16.957
> 
> 标签：python, performance

我正在开展一个项目，该项目在每个 20 条记录的表中抓取大约 400,000 条记录。目前，我的脚本为页面创建了一个完整的 URL 列表，然后为每个 URL 打开页面，找到带有 BeautifulSoup 的表，并抓取每一行。当它刮取每一行时，它将该行写入 CSV：

```
def scrape_table(url):
    soup = get_soup(url)
    table = soup.find('table' , {'id' : 'BigTable'})
    for row in table.find_all('tr'):
        cells = row.find_all('td')
        if len(cells) > 0:
            name_bits = cells[0].get_text().strip().split(',')
            first_name = name_bits[0].strip()
            last_name = name_bits[1].strip()
            species = cells[1].get_text().strip()
            bunch = re.sub(u'[\xa0\xc2\s]+',' ',str(cells[5]),flags=re.UNICODE).strip()
            bunch_strings = list(BeautifulSoup(bunch).td.strings)
            weight = bunch_strings[1].strip()
            bunch_match = re.match("dob:(.*) Mother: \$(.*)",bunch_strings[2].strip())
            dob = date_format(bunch_match.groups()[0].strip())
            mother = bunch_match.groups()[1].strip()            
            row_of_data = {
                'first_name': first_name,
                'last_name' : last_name,
                'species'   : species,
                'weight'    : weight,
                'dob'       : dob,
                'mother'    : mother
            }
            data_order = ['first_name', 'last_name', 'dob', 'mother', 'weight', 'kesavan']
                csv_row(row_of_data,data_order,'elephants')
        else:
            continue

def csv_row(data,fieldorder,filename, base=__base__):
    full_path = __base__+filename+'.csv'    
    print "writing", full_path
    with open(full_path, 'a+') as csvfile:
        linewriter = csv.DictWriter(csvfile, fieldorder, delimiter='|',
                                quotechar='"', quoting=csv.QUOTE_MINIMAL)
        linewriter.writerow(data) 
```

我想知道如果我一次将每一页结果写入 CSV 而不是写入每一行，这是否会更有效。还是会使用更多的 RAM 并减慢我计算机的其余部分？其他提高效率的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:08:07.810

```
with open(full_path, 'a+') as csvfile:
    linewriter = csv.DictWriter(csvfile, fieldorder, delimiter='|',
                            quotechar='"', quoting=csv.QUOTE_MINIMAL)
    linewriter.writerow(data) 
```

是性能杀手。*它必须为每一行*构造文件名、打开文件、构造对象、将数据写入磁盘并再次关闭文件。这意味着它必须至少执行三个系统调用并等待磁盘驱动程序/控制器发出“文件关闭并成功刷新”的信号。

您应该尝试的是至少在整个过程中保持文件打开。其内存成本可以忽略不计。所以，

```
def scrape_table(url, linewriter):
    # do scraping to get data
    linewriter.writerow(data) 
```

然后用

```
with open(full_path, 'a+') as csvfile:
    linewriter = csv.DictWriter(csvfile, fieldorder, delimiter='|',
                            quotechar='"', quoting=csv.QUOTE_MINIMAL)

    for url in a_bunch_of_urls:
        scrape_table(url, linewriter) 
```

通常，使用更多 RAM 不会减慢任何速度。在 RAM 中缓存结果而不是重新计算它们可能*是*最常见的优化技术。

# python - 按值对字典进行排序

> ID：13573123
> 
> 赞同：21
> 
> 时间：2012-11-26T21:03:17.690
> 
> 标签：python, dictionary, pyqt

我有这本字典：

```
statuses = {
            'pending' : {'status_for':'all', 'position':1},
            'cancelled' : {'status_for':'all','position':2},
            'approved' : {'status_for':'owner', 'position':1},
            'rejected - owner' : {'status_for':'owner', 'position':2},
            'accepted' : {'status_for':'dev', 'position':1},
            'rejected - developer' : {'status_for':'dev', 'position':3},
            'closed' : {'status_for':'dev', 'position':5},
            } 
```

我还有一个函数可以提取任何一个或看起来像这样`status_for`的所有值并将其放入 PyQt QComboBox：`owner``dev`

```
for s in statuses:
            if statuses[s]['status_for'] == "dev" or statuses[s]['status_for'] == "all":
                cb_developer_status.addItem(s.capitalize(), s) 
```

不过，我想按`position`价值订购这些。有什么好的方法可以做到这一点，以便当我按组合框填充时，我会按照预定义的顺序进行填充？

我意识到上面的代码片段正在检查“dev”和“all”，我现在的假设是我必须遍历字典两次才能按照我希望的顺序获取两个单独的块（即。'all ' 出现在 'dev' 之前）。

我看到了[这篇文章](https://stackoverflow.com/questions/613183/python-sort-a-dictionary-by-value)，但我不确定如何将此答案转换为字典词典。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-11-26T21:09:10.750

像这样的东西会起作用吗？与您链接的帖子类似，这使用 的`key`功能`sorted`来提供自定义排序顺序。`iteritems()`返回一个`(key, value)`元组，以便传入`lambda (x, y): y['position']`，其中`y['position']`是值（您的嵌套字典，由状态键控），并且`position`是您要排序的项目。

```
In [35]: statuses = {
            'pending' : {'status_for':'all', 'position':1},
            'cancelled' : {'status_for':'all','position':2},
            'approved' : {'status_for':'owner', 'position':1},
            'rejected - owner' : {'status_for':'owner', 'position':2},
            'accepted' : {'status_for':'dev', 'position':1},
            'rejected - developer' : {'status_for':'dev', 'position':3},
            'closed' : {'status_for':'dev', 'position':5},
            }

In [44]: for s in sorted(statuses.iteritems(), key=lambda (x, y): y['position']):
   ....:     print s
   ....:
   ....:
('accepted', {'position': 1, 'status_for': 'dev'})
('approved', {'position': 1, 'status_for': 'owner'})
('pending', {'position': 1, 'status_for': 'all'})
('rejected - owner', {'position': 2, 'status_for': 'owner'})
('cancelled', {'position': 2, 'status_for': 'all'})
('rejected - developer', {'position': 3, 'status_for': 'dev'})
('closed', {'position': 5, 'status_for': 'dev'}) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-26T21:11:53.280

```
In [232]: statuses = {                                                                  
            'pending' : {'status_for':'all', 'position':1},
            'cancelled' : {'status_for':'all','position':2},
            'approved' : {'status_for':'owner', 'position':1},
            'rejected - owner' : {'status_for':'owner', 'position':2},
            'accepted' : {'status_for':'dev', 'position':1},
            'rejected - developer' : {'status_for':'dev', 'position':3},
            'closed' : {'status_for':'dev', 'position':5},
            }

In [235]: sorted(statuses,key=lambda x:statuses[x]['position'])
Out[235]: 
['accepted',
 'approved',
 'pending',
 'rejected - owner',
 'cancelled',
 'rejected - developer',
 'closed'] 
```

或使用`operator.getitem()`：

```
In [260]: from operator import *

In [261]: sorted(statuses.items(),key=lambda x:getitem(x[1],'position'))
Out[261]: 
[('accepted', {'position': 1, 'status_for': 'dev'}),
 ('approved', {'position': 1, 'status_for': 'owner'}),
 ('pending', {'position': 1, 'status_for': 'all'}),
 ('rejected - owner', {'position': 2, 'status_for': 'owner'}),
 ('cancelled', {'position': 2, 'status_for': 'all'}),
 ('rejected - developer', {'position': 3, 'status_for': 'dev'}),
 ('closed', {'position': 5, 'status_for': 'dev'})] 
```

# time - Date Mon==Sun 在这个时候出乎意料

> ID：13573124
> 
> 赞同：-1
> 
> 时间：2012-11-26T21:03:19.903
> 
> 标签：time, batch-file

我在这个时候得到 Mon==Sun 是出乎意料的。我不知道我做错了什么。我所有的 if 语句看起来都不错，所以如果有人看到了什么，请告诉我。

```
set day7=%DATE:~0,3%
set month12=%DATE:~4,2% 
set day365=%DATE:~7,2%
set year1=%DATE:~10,4%

if /f %day7%==Sun set day7=Sunday
if /f %day7%==Mon set day7=Monday
if /f %day7%==Tue set day7=Tuesday
if /f %day7%==Wed set day7=Wednesday
if /f %day7%==Thu set day7=Thursday
if /f %day7%==Fri set day7=Friday
if /f %day7%==Sat set day7=Saturday

for /f "eol=; tokens=%month12% delims=," %%i in ("January,February,March,April,May,June,July,August,September,October,November,December") do set month12=%%i 

echo Today is %day7% %month12% %day365% %year1%
GOTO redo 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T01:45:58.620

IF 命令没有`/f`选项，因此您的语法错误。

删除该`/f`选项，它应该可以工作。

# regex - 如何在 htaccess 中替换 URL 中的反斜杠

> ID：13573126
> 
> 赞同：0
> 
> 时间：2012-11-26T21:03:22.213
> 
> 标签：regex, .htaccess

我有一个如下所示的 URL：

```
http://example.com/yyy/zzz/something\'s%20List/12/blah=somethingxmore 
```

我需要这个重定向到：

```
http://example.com/yyy/zzz/something's+List/12/blah=somethingxmore 
```

到目前为止，我有：

```
RewriteCond %{THE_REQUEST} (^(/yyy/zzz/)\s|%20)
RewriteRule ^([^\s%20]+)(?:\s|%20)+([^\s%20]+)((?:\s|%20)+.*)$ $1$2+$3 [N,DPI]
RewriteRule ^([^\s%20]+)(?:\s|%20)+(.*)$ /$1+$2 [L,R=301,DPI] 
```

这允许我将 %20 替换为加号 (+) 符号，但我尝试了很多不同的 \' 替换规则，但均未成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T21:38:03.523

```
RewriteCond %{HTTP_HOST}:%{SERVER_PORT}s ^(.*):(443(s)|\d+s)$
RewriteRule ^/?(yyy/zzz/.*?)\\'s( |\%20)(.*)$ http%3://%1/$1's+$3 [R=301,L,QSA] 
```

# javascript - jQuery选择的嵌套dom元素的后序遍历

> ID：13573132
> 
> 赞同：3
> 
> 时间：2012-11-26T21:03:39.373
> 
> 标签：javascript, jquery, dom, tree-traversal

这应该是一个不错的小谜题，希望 jQuery 可以解决。这是一个[不言自明的 jsFiddle](http://jsfiddle.net/arasbm/tMkZn/5/)。请注意，我正在寻找一个通用的解决方案来根据它们在 dom 树中的位置遍历 dom 中感兴趣的元素。我提供了这个简化的案例作为示例，因此您可以针对它测试您的解决方案，并且它也更容易理解。

DOM：

```
<div class="element" value="Hi5!">
    <div class="element" value="Zero"></div>
    <div class="junk" value="no no!"></div>
    <div class="element" value="Four">
        <div class="element" value="One"></div>
        <div class="element" value="Three">
            <div class="element" value="Two"></div>
        </div>
    </div>
    <div class="element" value="Five"></div>
</div> 
```

我得到的代码以不希望的顺序打印元素：

```
$(document).ready(function(){
    console.log("ready");
    $(".element").each(function(index, item){
       console.log(index + " | ",  item.getAttribute('value'));
    });
}); 
```

当前输出：

```
ready
0 | Hi5!
1 | Zero
2 | Two
3 | One
4 | Four
5 | Three
6 | Five 
```

如何以后[序](http://en.wikipedia.org/wiki/Tree_traversal#Postorder)方式遍历和打印上面嵌套的 div 元素的值？

编辑：感谢@zshooter 提供解决方案并指出我的问题中的一个错误。这是我[更新的 jsFiddle 在后序中正确排序。](http://jsfiddle.net/arasbm/tMkZn/7/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:16:31.870

[给你](http://jsfiddle.net/pr7v9/)：

```
$(document).ready(function(){
    console.log("ready");

    $("body").children('.element').each(function(index, item) {
        visitNode(item);
    });
});

function visitNode(element) {
    $(element).children('.element').each(function(index, item) {
        visitNode(item);
    });
    console.log(element.getAttribute('value'));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-03T01:56:35.973

已经给出了答案，但我写了一个更通用的函数：

```
function applyPostOrder(selector, fn, filter)
{
    (function visit() {
        $node = jQuery(this);
        $node.children(filter).each(visit);

        if (!filter || $node.is(filter)) {
            fn(this);
        }
    }).call(jQuery(selector).get(0));
} 
```

此函数将调用`fn`找到与给定过滤器匹配的每个节点。这就是你所说的：

```
function visitItem(node)
{
    console.log(node.getAttribute('value'));
}

jQuery(function($) {
    console.log("ready");
    applyPostOrder('body', visitItem, '.element');
}); 
```

# asp.net-mvc-3 - 枚举未在果园中验证

> ID：13573135
> 
> 赞同：0
> 
> 时间：2012-11-26T21:04:03.423
> 
> 标签：asp.net-mvc-3, orchardcms

我花了几个小时试图解决这个问题，但无济于事。

我正在使用 Orchard 1.6 源和 DataAnnotations。我`strings`的装饰和`[Required]`我的一样`enum`。然而，客户端验证仅适用于我页面 ( `strings`) 上的文本框，`enum`（单选按钮列表）不会触发验证（也不会像`class="input-validation-error"`html 源代码那样显示）。

这是我的`enum`：

```
public enum Referral
    {
        [Display(Name = "Google / Google+")]
        Google,
        [Display(Name = "Bing / Yahoo / Other Search Engine")]
        OtherSearch,
        [Display(Name = "LinkedIn")]
        LinkedIn,
    }
    public class ReferralSelectorAttribute : SelectorAttribute
    {
        public override IEnumerable<SelectListItem> GetItems()
        {
            return Selector.GetItemsFromEnum<Referral>();
        }
    }
    [Required(ErrorMessage = "Please select one referral option")]
    [Display(Name = "How did you hear about us?", 
        Description = "Letting us know how you reached us helps us 
        to focus our advertising efforts and ultimately lowers costs")]
    [ReferralSelector(BulkSelectionThreshold = 8)]
    public virtual Referral? ReferralRadioButton { get; set; } 
```

我不知道为什么这没有触发。有什么想法吗？

注意：我已经尝试了几乎所有我能找到的关于这个主题的东西。我已经使用特殊的 ResourceManifest.cs 文件注册了适当的 jquery 脚本（验证、不显眼等）。我已将其纳入我的观点。我在一个特殊的 Shell.cs 文件（IOrchardShellEvents 或其他东西）中重新添加了模型验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:27:55.463

解决了！我将枚举和选择器拆分为它们自己的类，引用它们，然后不使用 web.config 来启用客户端验证，而是将 html.helper 放在视图中。

# ruby - 为什么我看到这两个几乎相同的 Ruby 正则表达式模式的结果不同，为什么一个匹配我认为它不应该匹配的结果？

> ID：13573136
> 
> 赞同：6
> 
> 时间：2012-11-26T21:04:06.287
> 
> 标签：ruby, regex, unicode, character-class

使用 Ruby 1.9.2，我在 IRB 中有以下 Ruby 代码：

```
> r1 = /^(?=.*[\d])(?=.*[\W]).{8,20}$/i
> r2 = /^(?=.*\d)(?=.*\W).{8,20}$/i
> a = ["password", "1password", "password1", "pass1word", "password 1"]
> a.each {|p| puts "r1: #{r1.match(p) ? "+" : "-"} \"#{p}\"".ljust(25) + "r2: #{r2.match(p) ? "+" : "-"} \"#{p}\""} 
```

这将产生以下输出：

```
r1: - "password"         r2: - "password"
r1: + "1password"        r2: - "1password"
r1: + "password1"        r2: - "password1"
r1: + "pass1word"        r2: - "pass1word"
r1: + "password 1"       r2: + "password 1" 
```

1.) 为什么结果不同？

2.) 为什么会`r1`在字符串 2、3 和 4 上匹配？`(?=.*[\W])`由于这些示例中没有任何非单词字符，因此前瞻性不会导致它失败吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T22:14:51.697

这是由于几个正则表达式功能和 Unicode 之间的交互作用造成的。`\W`都是非单词字符，其中包括[212A - “KELVIN SIGN” `K`（PDF 链接）](http://www.unicode.org/charts/PDF/U2100.pdf)和[017F - “LATIN SMALL LETTER LONG S” `ſ`（PDF 链接）](http://www.unicode.org/charts/PDF/U0100.pdf)。添加了这两者的`/i`小写版本，即“普通”`k`和`s`字符（[006B - “LATIN SMALL LETTER K”和 0073 “LATIN SMALL LETTER S”（PDF 链接）](http://www.unicode.org/charts/PDF/U0000.pdf)）。

因此，在某些情况下， `s`in`password`被解释为非单词字符。

请注意，这似乎仅`\W`在 位于字符类（即`[\W]`）中时发生。此外，我只能在`irb`独立脚本中重现它，它似乎按预期工作。

有关更多信息，请参阅[Ruby 错误](http://bugs.ruby-lang.org/issues/4044)。

# sql-server - 如何只返回来自 3 个连接表的查询中的最新结果

> ID：13573141
> 
> 赞同：0
> 
> 时间：2012-11-26T21:04:46.837
> 
> 标签：sql-server, sql-server-2005, inner-join

我有 3 个名为 Contracts、Bills 和 Companies 的表，我在内部加入了一个名为“ContractID”的值，该值链接了所有 3 个表。我的查询运行良好，但是我只想提取最新的结果。ContractID 字段可以从 Contract 表返回多个具有不同日期的结果，因此 DISTINCT 无法缩小范围。

当前查询如下：

```
SELECT cn.ContractID
    , cn.Vendor
    , cn.ContractDate
    , b.ContractID
    , b.TotalBill
    , b.CurrentDue
    , cm.ContractID
    , cm.CompanyID
    , cm.[Description]
FROM [Contract] cn
INNER JOIN Company cm
    ON cn.ContractID = cm.ContractID
INNER JOIN Bill b
    ON cn.ContractID = b.ContractID 
```

我正在使用 MSSQLServer 2005。有人可以帮我调整查询，使其只返回每个 ContractID 的最新 ContractDate 结果吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T21:11:25.827

如果您的查询按您想要的方式排序，您只需将 select Top 1 添加到您的查询中，这将为您提供第一行：

```
SELECT Top 1 cn.ContractID , cn.Vendor , cn.ContractDate , b.ContractID 
     , b.TotalBill, b.CurrentDue, cm.ContractID, cm.CompanyID, cm.[Description] 
  FROM [Contract] cn 
 INNER JOIN Company cm ON cn.ContractID = cm.ContractID 
 INNER JOIN Bill b ON cn.ContractID = b.ContractID 
 order by cn.ContractDate DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:16:32.150

使用[RANK() OVER](http://msdn.microsoft.com/en-us/library/ms176102%28v=sql.90%29.aspx)给每个 ContractID 一个排名，然后只选择排名为 1 的那些。例如：

```
SELECT * 
FROM
(
    SELECT      
        Contract.ContractID, 
        Contract.Vendor, 
        Contract.ContractDate, 
        Bill.ContractID, 
        Bill.TotalBill,
        Bill.CurrentDue, 
        Company.ContractID, 
        Company.CompanyID, 
        Company.Description,
        RANK() OVER (ORDER BY ContractDate DESC) as RecordRank
    FROM Contract
    INNER JOIN Company 
        ON Contract.ContractID = Bill.ContractID
    INNER JOIN Bill 
        on Company.ContractID = Bill.ContractID
) qry
WHERE RecordRank = 1 
```

# php - 如何使用 PHP 将年份添加到纪元时间

> ID：13573145
> 
> 赞同：2
> 
> 时间：2012-11-26T21:05:00.390
> 
> 标签：php, datetime, epoch

我有人类可读形式的纪元`1196110849`时间`[Mon, 26 Nov 2007 21:00:49 GMT]`。如何使用 PHP 将 5 年添加到 epochTime 并在添加 5 年后获得相应的 epochTime？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-26T21:07:03.850

```
$newEpochTime = strtotime("+5 years", $epoch); 
```

为了现代：

```
$newEpochTime = DateTime::createFromFormat('U', $epoch)
                    ->add(new DateInterval('P5Y'))
                    ->format('U'); 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-11-26T21:08:39.910

如果您使用的是 PHP 5.3 或更高版本，那么[`DateTime::add()`](http://ca1.php.net/manual/en/datetime.add.php)或使用建议的 dev-null-dweller 之类的[相对时间格式。](http://ca1.php.net/manual/en/datetime.formats.relative.php)

# python - 如何使用 python 请求执行限时响应下载？

> ID：13573146
> 
> 赞同：12
> 
> 时间：2012-11-26T21:05:07.953
> 
> 标签：python, python-requests, urllib3

用python下载大文件时，我想不仅对连接过程设置时间限制，还对下载设置时间限制。

我正在尝试使用以下 python 代码：

```
import requests

r = requests.get('http://ipv4.download.thinkbroadband.com/1GB.zip', timeout = 0.5, prefetch = False)

print r.headers['content-length']

print len(r.raw.read()) 
```

这不起作用（下载没有时间限制），正如文档中正确指出的那样：[https ://requests.readthedocs.org/en/latest/user/quickstart/#timeouts](https://requests.readthedocs.org/en/latest/user/quickstart/#timeouts)

如果可能的话，那就太好了：

```
r.raw.read(timeout = 10) 
```

问题是，如何对下载设置时间限制？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-27T20:42:52.250

答案是：不要使用请求，因为它是阻塞的。使用非阻塞网络 I/O，例如 eventlet：

```
import eventlet
from eventlet.green import urllib2
from eventlet.timeout import Timeout

url5 = 'http://ipv4.download.thinkbroadband.com/5MB.zip'
url10 = 'http://ipv4.download.thinkbroadband.com/10MB.zip'

urls = [url5, url5, url10, url10, url10, url5, url5]

def fetch(url):
    response = bytearray()
    with Timeout(60, False):
        response = urllib2.urlopen(url).read()
    return url, len(response)

pool = eventlet.GreenPool()
for url, length in pool.imap(fetch, urls):
    if (not length):
        print "%s: timeout!" % (url)
    else:
        print "%s: %s" % (url, length) 
```

产生预期的结果：

```
http://ipv4.download.thinkbroadband.com/5MB.zip: 5242880
http://ipv4.download.thinkbroadband.com/5MB.zip: 5242880
http://ipv4.download.thinkbroadband.com/10MB.zip: timeout!
http://ipv4.download.thinkbroadband.com/10MB.zip: timeout!
http://ipv4.download.thinkbroadband.com/10MB.zip: timeout!
http://ipv4.download.thinkbroadband.com/5MB.zip: 5242880
http://ipv4.download.thinkbroadband.com/5MB.zip: 5242880 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T03:46:02.093

使用 Requests 的`prefetch=False`参数时，您可以一次提取任意大小的响应块（而不是一次全部提取）。

您需要做的是告诉 Requests 不要预加载整个请求，并保留您自己的时间来记录到目前为止您已经阅读了多少，同时一次获取小块。您可以使用`r.raw.read(CHUNK_SIZE)`. 总体而言，代码将如下所示：

```
import requests
import time

CHUNK_SIZE = 2**12  # Bytes
TIME_EXPIRE = time.time() + 5  # Seconds

r = requests.get('http://ipv4.download.thinkbroadband.com/1GB.zip', prefetch=False)

data = ''
buffer = r.raw.read(CHUNK_SIZE)
while buffer:
    data += buffer
    buffer = r.raw.read(CHUNK_SIZE)

    if TIME_EXPIRE < time.time():
        # Quit after 5 seconds.
        data += buffer
        break

r.raw.release_conn()

print "Read %s bytes out of %s expected." % (len(data), r.headers['content-length']) 
```

请注意，这有时可能会比分配的 5 秒多一点，因为决赛`r.raw.read(...)`可能会滞后任意时间。但至少它不依赖于多线程或套接字超时。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-11-26T21:14:08.527

在一个线程中运行下载，如果未按时完成，您可以中止该线程。

```
import requests
import threading

URL='http://ipv4.download.thinkbroadband.com/1GB.zip'
TIMEOUT=0.5

def download(return_value):
    return_value.append(requests.get(URL))

return_value = []
download_thread = threading.Thread(target=download, args=(return_value,))
download_thread.start()
download_thread.join(TIMEOUT)

if download_thread.is_alive():
    print 'The download was not finished on time...'
else:
    print return_value[0].headers['content-length'] 
```

# html - Chrome 在 P 中包含 TABLE 是否有效？

> ID：13573157
> 
> 赞同：0
> 
> 时间：2012-11-26T21:06:31.287
> 
> 标签：html

以下代码：

```
<p>Some words

<table>
...
</table> 
```

结果在 Google Chrome 下嵌套`html > body > p > table`。我意识到有一个“缺失” `</p>`，但另一方面，至少在 HTML4 [P 中不能包含块级元素](http://www.w3.org/TR/html401/struct/text.html#edef-P)。为什么 Chrome 然后允许 TABLE 存在于 P 中？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T21:09:55.117

Chrome 不允许这样做。
如果你尝试一下，Chrome 的解析器会隐式`<p>`关闭`<table>`.

此行为是规范所要求的，并已通过 Acid2 测试进行测试。

# jquery - 页面滚动上的动画 div 位置

> ID：13573158
> 
> 赞同：0
> 
> 时间：2012-11-26T21:06:38.170
> 
> 标签：jquery, css, html, jquery-animate

我有一个当用户向下滚动页面时出现的 div（您单击它，它会将您发送回页面顶部）。目前它只是淡入淡出，但我希望它从页面的右侧滑入。

这是我当前的代码：

查询：

```
<div class="toTop">
Back to the top
</div>
<script>
  $(window).scroll(function() {
    if ($(this).scrollTop()) {
        $('.toTop').fadeIn();
    } else {
        $('.toTop').fadeOut();
    }
});
</script> 
```

CSS：

```
.toTop {
    padding: 10px;
    background: rgb(55,161,222);
    color: #fff;
    position: fixed;
    bottom: 50%;
    right: 0px;
    display: none;
    z-index:1000;
    text-transform:uppercase;
    font-weight:600;
} 
```

你也可以在这里看到我在做什么：http: [//www.samskirrow.com/client-hope](http://www.samskirrow.com/client-hope)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:14:38.607

摆脱`display:none`.

设置`right:-200px`和使用`.animate({ right: 0px })`代替`.fadeIn()`和`.animate({ right: -200px })`代替`fadeOut()`。

将您的 if 语句更改为`if ($(this).scrollTop() > 100)`. 这是因为该`scrollTop()`函数将当前滚动位置作为距顶部的像素数返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T21:16:59.663

替换`$('.toTop').fadeIn();`为`.animate({"right":"-50px"}, "slow");`

# ruby - 如何在 ruby -pg（ruby 的新 postgres 库）中使用参数化类型？

> ID：13573159
> 
> 赞同：0
> 
> 时间：2012-11-26T21:06:39.860
> 
> 标签：ruby, postgresql

文档（[http://deveiate.org/code/pg/PG/Connection.html#method-i-exec](http://deveiate.org/code/pg/PG/Connection.html#method-i-exec)）建议插入布尔值或日期等类型，我应该使用如下代码：

```
db_object.exec("INSERT INTO dan_test_1 (one) VALUES ($1)",
    { :value => "true",
      :type  => 16,
      :format => 1
     } ); 
```

（我在 pg_type 表中查找了“16”。）

但是我不断收到诸如“无法格式化（PGError）”之类的错误。

我可以插入字符串和数字，很好，但是如何处理这些其他常见类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:06:16.937

您链接到的文档实际上建议使用常见的文本格式（`'t'`对于 true，`'2012-11-26'`对于日期，...），如果需要，还可以在 SQL 中进行显式转换：

> 建议在查询中简单地添加显式转换以确保使用正确的类型，而不是指定类型 oid。

所以如果`one`是一个布尔列，你会想要这个：

```
db_object.exec("INSERT INTO dan_test_1 (one) VALUES ($1)", [ 't' ]) 
```

续集可能会帮助你，但你真的应该知道背后发生了什么。

# r - 如何在 R 中绘制以下内容？

> ID：13573162
> 
> 赞同：14
> 
> 时间：2012-11-26T21:06:47.713
> 
> 标签：r, plot

我是在 R 中绘图的新手，所以我请求你的帮助。假设我有以下矩阵。

```
mat1 <- matrix(seq(1:6), 3)
dimnames(mat1)[[2]] <- c("x", "y")
dimnames(mat1)[[1]] <- c("a", "b", "c")
mat1
  x y
a 1 4
b 2 5
c 3 6 
```

我想绘制这个，其中 x 轴包含每个行名（a，b，c），y 轴是每个行名的值（a = 1 和 4，b = 2 和 5，c = 3 和 6 ）。任何帮助，将不胜感激！

```
|     o
|   o x
| o x
| x
|_______
  a b c 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-26T21:20:57.413

这是使用基本图形的一种方法：

```
plot(c(1,3),range(mat1),type = "n",xaxt ="n")
points(1:3,mat1[,2])
points(1:3,mat1[,1],pch = "x")
axis(1,at = 1:3,labels = rownames(mat1)) 
```

![在此处输入图像描述](../Images/05b0e83febc84e7ca5547a73122d2b28.png)

*编辑以包含不同的绘图符号*

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-26T21:28:30.167

`matplot()`专为这种格式的数据而设计：

```
matplot(y = mat1, pch = c(4,1), col = "black", xaxt ="n",
        xlab = "x-axis", ylab = "y-axis")
axis(1, at = 1:nrow(mat1), labels = rownames(mat1))             ## Thanks, Joran 
```

![在此处输入图像描述](../Images/caf5dd00ebd2f813a86b22c47c75b438.png)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-27T02:19:18.260

最后，一个格子解决方案

```
library(lattice)
dfmat <- as.data.frame(mat1)
xyplot( x + y ~ factor(rownames(dfmat)), data=dfmat, pch=c(4,1), cex=2) 
```

![在此处输入图像描述](../Images/d329aa46e765d31becc94dd34c45d7f5.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-26T21:30:06.970

您可以在基本图形中执行此操作，但如果您要使用 R 的用途远不止于此，我认为值得了解该`ggplot2`软件包。请注意，`ggplot2`这只需要数据帧 - 但是，将数据保存在数据帧而不是矩阵中通常更有用。

```
d <- as.data.frame(mat1) #convert to a data frame
d$cat <- rownames(d) #add the 'cat' column
dm <- melt(d, id.vars)
dm #look at dm to get an idea of what melt is doing

require(ggplot2)
ggplot(dm, aes(x=cat, y=value, shape=variable)) #define the data the plot will use, and the 'aesthetics' (i.e., how the data are mapped to visible space)
  + geom_point() #represent the data with points 
```

![在此处输入图像描述](../Images/6ccbec756fe20fb2a38a654f315a9f2d.png)

# javascript - 使用 Javascript 或 JQuery 删除某个字符后的文本

> ID：13573166
> 
> 赞同：2
> 
> 时间：2012-11-26T21:07:03.247
> 
> 标签：javascript, jquery, replace

我正在使用一个电子商务平台，该平台在单个 div 中呈现如下购物车，我想删除购物车中商品数量之后的所有内容，从“，”开始到“购物车”的末尾.

项目的数量和总计可以是任何值，所以我需要一些不依赖于设置变量的东西。这也必须动态工作，因为可以在页面加载后将项目添加到购物车中，并且需要相应地更新。

由于我对 Javascript 和 JQuery 比较陌生，因此我非常感谢任何包含完整脚本的帮助。

**1 件商品，总计：25.19 美元 查看购物车**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T21:09:49.600

尝试

```
var text = "1 item(s), Total: $25.19 View Cart";
text = text.split(",")[0]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T21:11:46.437

使用正则表达式替换 -`/,.*/`将找到一个逗号，后跟任意数量的其他字符：

```
var text = "1 item(s), Total: $25.19 View Cart";

text = text.replace(/,.*/, ""); 
```

> *“这也必须动态工作，因为可以在页面加载后将商品添加到购物车中，并且需要相应地更新。”*

那么你需要从添加新项目的地方调用上面的代码。

# jsf-2 - jsf2 tomahawk selectOneRadio 分别渲染标签

> ID：13573178
> 
> 赞同：0
> 
> 时间：2012-11-26T21:08:16.807
> 
> 标签：jsf-2

我正在使用`Tomahawk radio control`我的设计要求。我正在测试，想问是否有人回答。

```
 <t:selectOneRadio id="myRadio" forceId="true" layout="spread" styleClass="field checkbox">
                                    <f:selectItems value="#{personBean.genders}"  />
                                </t:selectOneRadio>
                                <c:forEach items="#{personBean.genders}" varStatus="loop">
                                    <span style="width:80px;" class="checkbox"><t:radio for=":myForm:myRadio"  index="#{loop.index}" /></span>
                                </c:forEach> 
```

**生成的 HTML**

```
<span class="checkbox"><input type="radio" class="field checkbox" value="male" name="myRadio" id="myForm:j_idt35"><label for="myForm:j_idt35"> male</label></span> 
```

**问题：**

*我想在用复选框呈现的男性上使用类属性。可以单独渲染吗？*

我可以应用如下样式，但我希望 Label 单独渲染以获得更多控制。

```
.checkbox label {
    display: block;
    cursor: pointer;
    font-size: 100%;
    line-height: 150%;
    margin: -17px 0 0 18px;
    padding: 0 0 5px 0;
    color: #222;
    width: 88%
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-14T14:32:49.603

查看源代码不，它不是。

但是，您可以使用 + 对其进行样式设置：

```
input[type='checkbox'] + label {
    display: block;
    cursor: pointer;
    font-size: 100%;
    line-height: 150%;
    margin: -17px 0 0 18px;
    padding: 0 0 5px 0;
    color: #222;
    width: 88%
} 
```

如果想以不同的方式呈现它，您需要覆盖 HtmlRadioRenderer：

把这个放在`faces-config.xml`：

```
 <renderer>
    <component-family>javax.faces.SelectOne</component-family>
    <renderer-type>org.apache.myfaces.Radio</renderer-type>
    <renderer-class>your-renderer-class</renderer-class>
  </renderer> 
```

创建一个类`your-renderer-class.java`，在其中覆盖，`org.apache.myfaces.renderkit.html.ext.HtmlRadioRenderer`你就可以开始了。

阅读有关如何完成此操作的网络：[JSF 2.0：如何使用自定义渲染器覆盖基本渲染器？](https://stackoverflow.com/questions/4605401/jsf-2-0-how-to-override-base-renderers-with-custom-ones)

# angularjs - How to add a conditions to an expression in AngularJS

> ID：13573184
> 
> 赞同：2
> 
> 时间：2012-11-26T21:08:37.180
> 
> 标签：angularjs

I'm trying to do something in Angular like this:

Your search found {{ searchResults.iTotalRecords > 0 , 0 }} results.

Certainly this doesn't work but you get the idea. If my object is an integer, how can I check if the value is greater than zero or else set it to 0?

Thanks.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T21:44:38.680

Custom Angular filters are well-suited for this purpose if you only want to change the presentation of the data, without changing the underlying (real) data in your application.

Below is an example filter for your use-case. You could put any other logic in your filter.

**HTML:**

```
<p>Your search found {{searchResults.iTotalRecords | resultCountFilter}} results.</p> 
```

**Javascript:**

```
angular.module('app', []).filter('resultCountFilter', function () {
    return function (resultCount) {
        return resultCount > 0 ? resultCount : 0;          
    };
});​ 
```

Here's a JSFiddle: [http://jsfiddle.net/alexross/ZN87E/](http://jsfiddle.net/alexross/ZN87E/)

AngularJS Docs on Filters: [Understanding Angular Filters](http://docs.angularjs.org/guide/dev_guide.templates.filters "Understanding Angular Filters")

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-26T21:17:11.693

To do that you can just use a function on your $scope:

```
app.controller('MainCtrl', function($scope) {
    $scope.foo = function() {
        return $scope.searchResults.iTotalRecords > 0 ? $scope.searchResults.iTotalRecords : 0;
    };
}); 
```

And in your markup:

```
<span>{{foo()}}</span> 
```

EDIT: The 100% markup way...

```
<span ng-show="searchResults.iTotalRecords > 0">{{searchResults.iTotalRecords}}</span>
<span ng-show="searchResults.iTotalRecords <= 0">0</span> 
```

You might also want to check on [ngSwitch](http://docs.angularjs.org/api/ng.directive%3angSwitch) and [ngHide](http://docs.angularjs.org/api/ng.directive%3angHide) for more advanced cases like this.

# dataset - Report Builder Treat my DataSet like a Table

> ID：13573189
> 
> 赞同：0
> 
> 时间：2012-11-26T21:08:47.570
> 
> 标签：dataset, reportbuilder3.0

I'm swimming in ignorance here. New to Report Builder. (Using Ver. 3.0)

I have a DataSet named DemographicData. It has the following fields: EID, Department, Years, Months, Days, Gender, and BenCat.

For the purposes of this question, let's say I want to get CountRows(EID) where Gender = 'M' and similarly where it = 'F'

I've tried for two days now, and cannot get this to work. How do I treat my DataSet like a Table so I can query against it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T02:37:29.323

1.  Add a text box for you to display the daya on.
2.  Right click in the text box and add an expression.
3.  Enter the following type of expression:

    ```
    =Sum(IIf(Fields!Gender="M", 1, 0), "MyDataset") 
    ```

Similarly for `Gender ="F"`

Sorry if the synax is a little out, I don't have the app with me.

# django - 使用多授权提供者时如何获取信号发送者类型？

> ID：13573192
> 
> 赞同：1
> 
> 时间：2012-11-26T21:08:57.103
> 
> 标签：django, django-authentication, django-signals, django-socialauth

在我的应用程序中，我使用标准身份验证模块和[社交身份验证](https://github.com/omab/django-social-auth)插件。我想检测用户是通过 oauth 还是标准方法注册

我已将函数注册到 post_save 信号：

```
def create_user_profile(sender, instance, created, **kwargs):
    if created:
        key, expires = UserProfile.generate_activation_data()
        return UserProfile.objects.create(user=instance, activation_key=key, key_expires=expires)

post_save.connect(create_user_profile, sender=User) 
```

但是当用户通过 oauth 注册时，我会避免创建激活数据，而是设置一些字段表明用户是通过 oauth 注册的。

有人可以给我任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:41:24.203

添加一个在用户实例中设置标志的[管道方法，如下所示：](http://django-social-auth.readthedocs.org/en/latest/pipeline.html)

```
def created_by_social_auth(user, *args, **kwargs):
    user.by_social_auth = True 
```

您还可以检查用户是否有任何`UserSocialAuth`与以下内容相关的实例：

```
user.social_auth.count() 
```

# paypal - Paypal IPN：获取买家地址

> ID：13573193
> 
> 赞同：4
> 
> 时间：2012-11-26T21:09:01.523
> 
> 标签：paypal

我已经使用沙箱获取了 Paypal IPN 在交易后返回的信息。我遇到的问题是 IPN 没有发送买家地址信息，但我仍然可以得到他的名字和买家的姓氏。我也可以毫无问题地获取交易 ID 或购买的商品信息。我无法获得的唯一变量是所有买家地址信息，如 $_POST['address_name'] 或 $_POST['address_city']。这是我的 HTML 表单：

```
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type='hidden' value="Montant_Achat" name="amount" />
<input name="currency_code" type="hidden" value="EUR" />
<input name="shipping" type="hidden" value="0.00" />
<input name="tax" type="hidden" value="0.00" />
<input type="hidden" name="cmd" value="_s-xclick">

<input type="hidden" name="hosted_button_id" value="XXXXXXX">
<p>
<input type="hidden" name="on0" value="Durée"><span id="texteDuree">Durée : </span><select id="duree" onchange="changeCustom()" name="os0">

<option value="1 mois" id="30">1 mois €0,01 EUR</option>
<option value="3 mois" id="90">3 mois €15,00 EUR</option>
<option value="6 mois" id="180">6 mois €30,00 EUR</option>

</select>
</p>
<input name="return" type="hidden" value="factures.php" />
<input name="cancel_return" type="hidden" value="paypal_pro.php" />
<input name="notify_url" type="hidden" value="paypal/paypal_notify.php" />

<input name="item_name" type="hidden" value="Nom de votre produit" />
<input name="no_note" type="hidden" value="1" />
<input name="lc" type="hidden" value="FR" />
<input name="bn" type="hidden" value="PP-BuyNowBF" />
<input id="custom" name="custom" type="hidden" value="<?php echo $_SESSION["numUser"]; ?>||30" />

<input type="hidden" name="currency_code" value="EUR">
<input type="hidden" name="no_shipping" value="2" />
<input type='hidden' name="address_override" value="1">
<input type="image" style="height:auto;" src="https://www.paypalobjects.com/fr_FR/FR/i/btn/btn_buynowCC_LG.gif" border="0" name="submit" alt="PayPal - la solution de paiement en ligne la plus simple et la plus sécurisée !">

<img alt="" border="0" src="https://www.paypalobjects.com/fr_FR/i/scr/pixel.gif" width="1" height="1">

</form> 
```

这是我的贝宝通知文件的开始：

```
// lire le formulaire provenant du système PayPal et ajouter 'cmd'
$req = 'cmd=_notify-validate';

foreach ($_POST as $key => $value) {
$value = urlencode(stripslashes($value));
$req .= "&$key=$value";
}

// renvoyer au système PayPal pour validation
$raw_post_data = file_get_contents('php://input');
$raw_post_array = explode('&', $raw_post_data);
$myPost = array();
foreach ($raw_post_array as $keyval) {
$keyval = explode('=', $keyval);
if (count($keyval) == 2)
$myPost[$keyval[0]] = urldecode($keyval[1]);
}
$_req = 'cmd=_notify-validate';
foreach ($myPost as $key => $value) {
$value = urlencode(stripslashes($value));
$_req .= "&$key=$value";
}

// post back to PayPal system to validate
$header .= "POST /cgi-bin/webscr HTTP/1.0\r\n";
$header .= "Content-Type: application/x-www-form-urlencoded\r\n";
$header .= "Content-Length: " . strlen($req) . "\r\n\r\n";
$fp = fsockopen ('ssl://ipnpb.paypal.com', 443, $errno, $errstr, 30);

// récupération des informations de paypal
$item_name = $_POST['item_name'];
$item_number = $_POST['item_number'];
$payment_status = $_POST['payment_status'];
$payment_amount = $_POST['mc_gross'];
$payment_currency = $_POST['mc_currency'];
$txn_id = $_POST['txn_id'];
$receiver_email = $_POST['receiver_email'];
$payer_email = $_POST['payer_email'];
$custom = explode("||", $_POST['custom']);
$id_user = $custom[0];
$dureeContrat = $custom[1];

$first_name = $_POST["first_name"];
$last_name = $_POST["last_name"];
$address_city = $_POST["address_city"];
$address_country = $_POST["address_country"];
$address_country_code = $_POST["address_country_code"];
$address_name = $_POST["address_name"];
$address_state = $_POST["address_state"];
$address_street = $_POST["address_street"];
$address_zip = $_POST["address_zip"]; 
```

这是 IPN 返回的 $POST 变量：

```
Key: mc_gross

Key: protection_eligibility

Key: payer_id

Key: tax

Key: payment_date

Key: payment_status

Key: charset

Key: first_name

Key: option_selection1

Key: mc_fee

Key: notify_version

Key: custom

Key: payer_status

Key: business

Key: quantity

Key: verify_sign

Key: payer_email

Key: option_name1
Key: txn_id

Key: payment_type

Key: btn_id

Key: last_name

Key: receiver_email

Key: payment_fee

Key: shipping_discount

Key: insurance_amount

Key: receiver_id

Key: txn_type

Key: item_name

Key: discount
Key: mc_currency

Key: item_number

Key: residence_country

Key: handling_amount

Key: shipping_method

Key: transaction_subject

Key: payment_gross

Key: shipping

Key: ipn_track_id 
```

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T07:15:25.260

如果地址包含在付款信息中，PayPal 只会发送带有 IPN 通知的地址。否则，它将完全排除在外。

如果在按钮创建过程中您指定不需要运送，这将导致在 IPN 中不返回运送。另一种可能性是您的订单上不需要送货，因此买家在结账时只是选择不包括他们的送货地址，在这种情况下，PayPal 不会将其发送给您。

# objective-c - iOS 编辑 UIButton 属性

> ID：13573199
> 
> 赞同：-1
> 
> 时间：2012-11-26T21:09:16.007
> 
> 标签：objective-c, ios, uibutton

我正在研究 iOS 开发的基础知识。

到目前为止，我有一个按钮，按下时会显示一些文本。但我想做的是在按下它之后，我希望它改变按钮的文本，到目前为止，这就是我所拥有的：

```
- (void)viewDidLoad
{
[super viewDidLoad];
UIButton *button = [UIButton buttonWithType:UIButtonTypeRoundedRect];
//button.backgroundColor = [UIColor redColor];
button.titleLabel.textColor=[UIColor blackColor];
button.frame = CGRectMake(25, 100, 275, 60);
[button setTitle:@"Press this button to reveal the text!" forState:UIControlStateNormal];
[button addTarget:self action:@selector(button_method:) forControlEvents:UIControlEventTouchUpInside];

[self.view addSubview:button];
// Do any additional setup after loading the view, typically from a nib.
}

- (void)button_method:(UIButton *)sender {
NSString *test = @"I am learning Objective-C for the very first time! Also, this is my first ever variable!";
// handle button press
UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(25, 25, 275, 60)];
label.text = test;
label.numberOfLines = 0;
label.lineBreakMode = UILineBreakModeWordWrap;
//label.lineBreakMode = NSLineBreakByWordWrapping; //iOS 6 only
[self.view addSubview:label];
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
} 
```

当我尝试添加`[button setTitle:@"You pressed the button"];`到 button_method

这不起作用...为什么？我将如何让它发挥作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:23:14.220

> 当我尝试添加`[button setTitle:@"You pressed the button"];`到 button_method 时，它不起作用......为什么？

因为那个方法在`UIButton`.

> 我将如何让它发挥作用？

通过使用`UIButton` **实际响应的方法。**例如：

```
[sender setTitle:@"You pressed the button" forState:UIControlStateNormal]; 
```

请阅读相关文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T21:18:41.113

您的代码不会更改按钮的标题。但只需为您的视图添加一个标签作为子视图。这是你想要的吗？

如果要更改按钮上的文本，则需要`sender.title.text = test;`在 button_method 中执行

我还建议`NSLog(@"Button pressed");`在您的按钮按下方法中添加一个以仔细检查它是否被调用。

# macos - psql：无法连接到服务器：没有这样的文件或目录（Mac OS X）

> ID：13573204
> 
> 赞同：298
> 
> 时间：2012-11-26T21:09:53.373
> 
> 标签：macos, postgresql

重新启动我的 Mac 后，我得到了可怕的 Postgres 错误：

```
psql: could not connect to server: No such file or directory
 Is the server running locally and accepting
 connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"? 
```

发生这种情况的原因是因为我的 macbook 由于一个不相关的问题而完全死机，我不得不使用电源按钮进行硬重启。重新启动后，由于此错误，我无法启动 Postgres。

* * *

## 回答 #1

> 赞同：471
> 
> 时间：2012-11-26T21:09:53.373

警告：**如果您删除 postmaster.pid 而不确保确实没有`postgres`进程在运行您，可能会永久损坏您的数据库**。（如果 postmaster 已经退出，PostgreSQL 应该自动删除它。）。

解决方案：这解决了问题——我删除了这个文件，然后一切正常！

```
/usr/local/var/postgres/postmaster.pid 
```

--

这就是我如何弄清楚为什么需要删除它。

1.  我使用以下命令查看是否有任何 PG 进程正在运行。对我来说没有，我什至无法启动 PG 服务器：

    ```
    ps auxw | grep post 
    ```

2.  我搜索了上面错误消息中的文件 .s.PGSQL.5432。我使用了以下命令：

    ```
    sudo find / -name .s.PGSQL.5432 -ls 
    ```

    这在搜索我的整个计算机后没有显示任何内容，因此该文件不存在，但显然`psql`“想要它”或“认为它在那里”。

3.  我查看了我的服务器日志并看到以下错误：

    ```
    cat /usr/local/var/postgres/server.log 
    ```

    在服务器日志的末尾，我看到以下错误：

    ```
    FATAL:  pre-existing shared memory block (key 5432001, ID 65538) is still in use
    HINT:  If you're sure there are no old server processes still running, remove the shared memory block or just delete the file "postmaster.pid". 
    ```

4.  按照错误消息中的建议，我删除了与 server.log 相同目录中的 postmaster.pid 文件。这解决了问题，我能够重新启动。

因此，似乎我的 macbook 冻结和硬重启导致 Postgres 认为即使在重启后它的进程仍在运行。删除此文件已解决。希望这对其他人有帮助！很多人都有类似的问题，但大多数答案都与文件权限有关，而在我的情况下情况有所不同。

* * *

## 回答 #2

> 赞同：226
> 
> 时间：2017-10-27T09:30:34.320

以上都不适合我。我必须通过以下方式重新安装 Postgres：

*   使用 brew 卸载 postgresql：`brew uninstall postgresql`

*   `brew doctor`（修复这里的任何东西）

*   `brew cleanup`

*   删除所有 Postgres 文件夹：

*   `rm -r /usr/local/var/postgres`

*   `rm -r ~/Library/Application\ Support/Postgres`

*   使用 brew 重新安装 postgresql：`brew install postgresql`

*   启动服务器：`brew services start postgresql`

*   您现在应该必须创建数据库... ( `createdb`)

* * *

## 回答 #3

> 赞同：98
> 
> 时间：2015-06-15T09:12:50.037

如果您在 macOS 上并通过自制软件安装了 postgres，请尝试使用以下命令重新启动它

```
brew services restart postgresql 
```

如果您使用的是 Ubuntu，则可以使用以下任一命令重新启动它

```
sudo service postgresql restart

sudo /etc/init.d/postgresql restart 
```

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2018-07-31T10:52:22.530

也许这无关紧要，但是当您使用;升级`postgres`到主要版本时会出现类似的错误。`brew`使用`brew info postgresql`发现这有助于：

```
To migrate existing data from a previous major version of PostgreSQL run:
brew postgresql-upgrade-database 
```

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2019-09-17T12:16:30.980

这是我的方式：

```
launchctl unload ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist
rm /usr/local/var/postgres/postmaster.pid
launchctl load ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2021-01-27T04:09:32.107

以下命令帮助了我。问题在于 PostgreSQL 数据版本。升级后，它开始对我正常工作。

```
brew upgrade postgresql
brew postgresql-upgrade-database
brew services restart postgresql 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2017-12-05T01:00:55.693

如果你`postmaster.pid`走了，你不能重新启动或任何事情，这样做：

`pg_ctl -D /usr/local/var/postgres -l /usr/local/var/postgres/server.log start`

正如[这里](https://stackoverflow.com/questions/24333317/pg-error-could-not-connect-to-server-connection-refused-is-the-server-running-o)最初解释的那样

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2017-05-08T04:47:35.783

对我来说，解决方案就是重新启动我的电脑。我首先尝试使用 Brew 服务重新启动，但当它不起作用时，重新启动似乎是在研究一些更复杂的解决方案之前尝试的下一个最佳选择。之后一切正常。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2020-11-13T09:53:39.183

发生这种情况的另一类原因是 Postgres 版本更新。

您可以通过查看 postgres 日志来确认这是一个问题：

```
tail -n 10000 /usr/local/var/log/postgres.log 
```

并看到以下条目：

```
DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 13.0. 
```

在这种情况下（假设您在 Mac 上并使用`brew`），只需运行：

```
brew postgresql-upgrade-database 
```

（奇怪的是，它在运行 1 上失败并在运行 2 上工作，所以在放弃之前尝试了两次）

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2014-02-01T20:38:22.647

Hello world :)
**对我来说最好但奇怪的方法是做接下来的事情。**

**1)**下载[postgres93.app](http://postgresapp.com/)或其他版本。将此应用程序添加到 /Applications/ 文件夹中。

**2）**`.bash_profile`在文件（在我的主目录中）中 添加一行（命令）：

```
导出 PATH=/Applications/Postgres93.app/Contents/MacOS/bin/:$PATH
```

这是一个 PATH 到`psql`from `Postgres93.app`。每次启动控制台时都会运行该行（命令）。

**3)**`Postgres93.app`从`/Applications/`文件夹启动。它启动一个本地服务器（端口是“5432”，主机是“localhost”）。

**4）**在所有这些操作之后，我很高兴运行`$ createuser -SRDP user_name`其他命令并看到它有效！`Postgres93.app`可以在每次系统启动时运行。

**5）**此外，如果您想以图形方式查看数据库，则应安装`PG Commander.app`. 将您的 postgres 数据库视为漂亮的数据表的好方法

当然，它只对本地服务器有用。如果此说明对遇到此问题的其他人有所帮助，我将很高兴。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2014-03-11T08:53:50.070

这个问题有很多来源，因此有很多答案。我经历过他们中的每一个。

1) 如果您遇到某种崩溃，可能需要删除 /usr/local/var/postgres/postmaster.pid 文件，因为 postgres 可能没有正确处理它。但请确保没有进程正在运行。

2) Craig Ringer 在其他帖子中指出，Apple 捆绑 postgreSQL 会导致[pg gem 安装问题](https://stackoverflow.com/questions/14225038/postgresql-adapter-pg-could-not-connect-to-server) 设置 PATH 环境变量是一种解决方案。

3）另一种解决方案是卸载并重新安装gem。可能还需要 brew 更新。

如果你偶然发现这篇文章，如果你能查明其中一个来源，你会节省时间......

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2015-05-13T10:05:39.840

我在这里遇到了类似的问题，我解决了这个问题，如下所示。

实际上 postgres 进程已经死了，要查看 postgres 的状态运行以下命令

```
sudo /etc/init.d/postgres status 
```

它会说这个过程已经死了`只需启动这个过程

```
sudo /etc/init.d/postgres start 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2017-10-20T15:45:13.087

这发生在我的 Mac（High Sierra）死机后，我不得不手动重新启动它（按住电源按钮）。我所要做的就是彻底重启。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2020-10-05T07:00:05.023

我遇到了同样的问题`psql (PostgreSQL) 9.6.11`。

什么对我有用-

删除 postmaster.pid -- `rm /usr/local/var/postgresql@9.6/postmaster.pid`

重新启动 postgres --`brew services restart postgresql@9.6`

如果`postmaster.pid`不存在或上述过程不起作用，则运行 -

`sudo chmod 700 /usr/local/var/postgresql@9.6`

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2018-06-04T15:24:25.563

我不完全确定为什么，但我的 Postgres 安装有点搞砸了，一些文件被删除，导致错误 OP 显示。

尽管我能够运行类似的命令`brew service retart postgres`并查看正确的消息，但此错误仍然存​​在。

我浏览了 postgres 文档，发现我的文件`/usr/local/var/postgres`完全是空的。所以我运行了以下内容：

```
initdb /usr/local/var/postgres 
```

似乎使用该命令进行了一些配置。

然后它要求我运行这个：

```
postgres -D /usr/local/var/postgres 
```

这告诉我 postmaster.pid 文件已经存在。

我只需要知道 brew 是否能够获取我刚刚运行的配置，因此我对其进行了测试。

```
ls /usr/local/var/postgres 
```

那向我展示了一个 postmaster.pid 文件。然后我做`brew services stop postgresql`了，postmaster.pid 文件消失了。然后我做了`brew services start postgresql`，VIOLA，文件又出现了。

然后我继续运行我的应用程序，它确实找到了服务器，但是我的数据库似乎不见了。

虽然我知道它们可能根本不会消失——我所做的新初始化可能已经创建了一个新的 data_area，而旧的并没有被指向。我必须查看它的位置并将其重新指向或重新创建我的数据库。

希望这可以帮助！阅读 postgres 文档对我帮助很大。我讨厌阅读诸如“将其粘贴进去！”之类的答案。因为我不知道到底发生了什么以及为什么。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2021-04-18T08:17:58.163

我有同样的问题，这是由于从版本 11 升级到 13.2 后版本不兼容

检查错误日志：

```
/usr/local/var/log/postgres.log 
```

给我看了：

```
DETAIL:  The data directory was initialized by PostgreSQL version 11, which is not compatible with this version 13.2. 
```

为了修复我跑了：

```
brew postgresql-upgrade-database 
```

然后用 brew 启动 postresql：

```
brew services start postgresql 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2015-07-22T18:00:48.390

我的问题最终是我使用了 Gas Mask（Mac 的主机文件管理器），而我正在使用的主机文件中没有 localhost 条目。

我补充说：

```
127.0.0.1 localhost 
```

这解决了我的问题。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2018-12-27T11:13:37.817

我遇到过同样的问题。大多数时候，问题在于有一个剩余文件

`/usr/local/var/postgres/postmaster.pid`

这适用于大多数人，但我的情况不同 - 我尝试在过去 3 小时内搜索这个问题，通过 brew 在 OSX 上卸载 postresql，清除数据库，没有任何效果。

最后，我注意到我遇到了一个 brew 问题，每当我尝试安装任何东西时，它都会弹出：

`Error: Permission denied @ rb_sysopen - /private/tmp/github_api_....`

或安装结束时的类似内容。

我只是做了`sudo chmod -R 777 /private/tmp`，它终于奏效了！

我写下来是因为这可能是其他人的解决方案

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2018-01-26T16:54:59.650

这个错误的原因很多，所以首先找到你的日志文件并检查它是否有线索。它可能在`/usr/local/var/log/postgres.log`或`/usr/local/var/postgres/server.log`可能在其他地方。如果您使用 Homebrew 安装，您可以在`~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist`.

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2019-06-18T10:06:36.387

去`/var/log/` 运行 cat`postgres.log` 这里你会找到postgres失败的原因。如果它是智能关闭，那么您的`icu4c`版本（Unicode 的 C++ 库）可能不正确，它与`postgres`. 所以运行以下命令。

`brew upgrade` `brew cleanup` 这应该工作;）

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-03-02T05:42:09.383

我刚刚遇到了与我将机器（`ubuntu`）更新并得到以下错误相同的问题：

> 无法连接到服务器：没有这样的文件或目录服务器是否在本地运行并接受 Unix 域套接字“/var/run/postgresql/.s.PGSQL.5432”上的连接？

完成更新过程后，当我重新启动系统错误消失了。它的工作就像以前一样魅力。我猜这是在 pg 更新并且另一个进程开始时发生的。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2014-07-18T20:20:14.353

我不得不多次查找这篇文章来解决这个问题。还有另一个修复程序，它也适用于其他正在运行的程序的类似问题。

我刚刚发现您可以使用以下两个命令。

$顶部

这将显示所有当前正在运行的操作及其 pid 号。当你找到 postgres 和相关的 pid

$kill pid_number

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-05-11T17:20:16.603

@Jagdish Barabari 的回答给了我解决这个问题所需的线索。结果发现只有一个运行时安装了两个版本的 postgresql。清除所有 postgresql 文件并重新安装最新版本为我解决了这个问题。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2022-01-25T19:27:14.137

**尝试在MacOS Monterey**上启动 PostgreSQL 数据库服务器时，我也有同样的担忧。

当我运行以下命令重新启动 PostgreSQL 数据库服务器时：

```
brew services restart PostgreSQL 
```

它重新启动，但是当我尝试使用以下命令检查 PostgreSQL 数据库服务器的状态时，出现错误：

```
Name       Status     User           File
mysql      started    promisepreston ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist
nginx      started    promisepreston ~/Library/LaunchAgents/homebrew.mxcl.nginx.plist
postgresql error  256 root           ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist 
```

**这对我有用**：

首先，我使用以下命令检查了 PostgreSQL 数据库服务器的日志文件，以了解错误的原因：

```
cat /usr/local/var/log/postgres.log 
```

或者

```
nano /usr/local/var/log/postgres.log 
```

日志显示以下错误：

```
"root" execution of the PostgreSQL server is not permitted.
The server must be started under an unprivileged user ID to prevent
possible system security compromise.  See the documentation for
more information on how to properly start the server.
2022-01-25 19:01:06.051 WAT [29053] FATAL:  database files are incompatible with server
2022-01-25 19:01:06.051 WAT [29053] DETAIL:  The data directory was initialized by PostgreSQL version 13, which is not compatible with this version 14.1. 
```

**对于根执行错误**，我必须运行以下命令来修复当我`brew services`使用`sudo`命令前缀运行时弄乱我们的文件权限。替换`your-username`为您的 MacOS 用户名（在我的情况下，我的用户名是`promisepreston`：

```
# Stop postgresql
sudo brew services stop PostgreSQL

# In case service file is copied to ~/Library/LaunchAgents as well
brew services stop postgresql

# Fix permission of homebrew files
sudo chown -R your-username:admin $(brew --prefix)/* 
```

**由于数据库文件与服务器不兼容，**我必须简单地将使用版本 13 创建的现有 PostgreSQL 数据文件升级到我计算机上的最新 PostgreSQL 版本，即 14.1，方法是运行以下命令：

```
brew postgresql-upgrade-database 
```

之后，我重新启动了 PostgreSQL 数据库服务器：

```
brew services restart PostgreSQL 
```

然后使用以下命令检查状态：

```
brew services list 
```

然后我得到下面的输出，表明一切正常：

```
Name          Status  User           File
mysql         started promisepreston ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist
nginx         started promisepreston ~/Library/LaunchAgents/homebrew.mxcl.nginx.plist
postgresql    started promisepreston ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist 
```

就这样。

**参考**： [Brew Postgresql 启动但进程未运行](https://stackoverflow.com/a/67700330/10907864)

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-04-04T16:19:04.167

我从 LD_LIBRARY_PATH 中删除了 /usr/lib 并且它起作用了。我在 dockerfile postgres:alpine 工作。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2021-09-25T17:20:23.677

只是把我的解决方案放在这里，因为我有一个类似的错误

所有这些都是从命令行完成的（根本没有`sudo`代码）

1.  我确认我已经安装了 PostgreSQL `psql -V`（顺便说一句，这是一个大写的“V”）
2.  我试图连接到服务器：`psql postgres`

## 这就是我遇到这个问题的错误的地方

在对可能的修复进行了一些研究之后，我显然安装了 PostgreSQL，但我没有安装默认服务器。

我要做的是[创建一个自定义数据目录](https://dataschool.com/learn-sql/how-to-start-a-postgresql-server-on-mac-os-x/#optional-creating-a-custom-data-directory)

据我所知，创建自定义数据目录与使用默认服务器相同。

由于这是一台新机器（使用苹果 m1 芯片的 macBook pro 2021），我想找到最简单的解决方案，我相信这个自定义数据目录就是这样。解决此问题的其余步骤如下：

3.  从主目录，我创建了一个空目录`mkdir myData`
4.  从主目录，初始化一个服务器：（`initdb myData`将一堆文件扔到 myData 目录中）
5.  `pg_ctl -D myData -l logfile start`（启动服务器）
6.  `psql postgres`（连接到服务器）

所以，作为一个对 PostgreSQL 和数据库和 SQL 相当陌生的人，请注意：

*   可以“退出”与服务器的连接，使用`\q`（连接到服务器时，也可以输入“帮助”）
*   也可以“停止”服务器，以及`pg_ctl -D myData stop`

在这一点上，我现在确定我已经安装了 PostgreSQL，有一个可以启动和停止的服务器，并且能够连接到该服务器/从该服务器断开连接。

如果其中任何一个“不好”，请告诉我。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2016-05-01T07:08:51.200

超级新手警报：我刚刚学习 Web 开发，我遵循的特定教程提到我必须安装 Postgres，但实际上并没有提到我也必须***运行***它......一旦我打开 Postgres 应用程序，一切都很好，而且花花公子。

# vba - DateAdd + DLookup

> ID：13573211
> 
> 赞同：0
> 
> 时间：2012-11-26T21:10:18.057
> 
> 标签：vba, ms-access

我请求一些指导来解决我在尝试编辑数据库中的“更新后”事件时遇到的这个问题。它似乎在我的本地机器上工作正常，但是当我尝试在网络数据库中实现它时它不能正常工作（偶尔会在其中一个字段中输入随机日期，当我提供新的日期时不会删除日期身份证等）

这是我拥有的 VBA 代码：

```
Private Sub provider_surveyID_AfterUpdate()

provider_survey_dueDate = DateAdd("ww", 2, DLookup("completed_on",
 "qry_ProviderSurveyInfo", "provider_surveyID=" & provider_surveyID))
provider_survey_reminder2weeks = DateAdd("ww", 4, DLookup("completed_on", 
 "qry_ProviderSurveyInfo", "provider_surveyID=" & provider_surveyID))
provider_survey_reminder4weeks = DateAdd("ww", 6, DLookup("completed_on", 
 "qry_ProviderSurveyInfo", "provider_surveyID=" & provider_surveyID))

End Sub 
```

查询是正确的，将调查 ID 加入适当的参与者以确定在 DateAdd 函数中使用的原始“completed_on”日期。

你能看出为什么它不能像在本地那样工作 - 在输入当前未使用的 ID 时删除日期吗？另外，认为在这种情况下使用 Nz(provider_surveyID,0) 是明智的吗？我还没有实现它，因为我想让它像在我的本地一样正常工作，没有任何问题 - 我输入 ID，它填充；我输入 20（尚未使用），它使所有日期再次为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:56:34.027

Dlookups 使用起来可能很慢而且很棘手，当没有输入 Criteria 时，它也会返回随机值。我不确定您的表单是如何组合在一起的（我假设它是一个表单），这可能是部分答案：

```
Private Sub provider_surveyID_AfterUpdate()
Dim dtComplete as Date

If IsNull(provider_serveyID) then
    provider_survey_dueDate=""
    provider_survey_reminder2weeks=""
    provider_survey_reminder4weeks=""
Else
    dtComplete = DLookup("completed_on","qry_ProviderSurveyInfo", "provider_surveyID=" & provider_surveyID)
    provider_survey_dueDate=DateAdd("ww",2,dtComplete)
    provider_survey_reminder2weeks=DateAdd("ww",4,dtComplete)
    provider_survey_reminder4weeks=DateAdd("ww",6,dtComplete)
End if
End sub 
```

# sql - 存储过程中输入参数的类似运算符

> ID：13573213
> 
> 赞同：1
> 
> 时间：2012-11-26T21:10:20.543
> 
> 标签：sql, sql-server, tsql, stored-procedures

我刚刚开始将编写存储过程添加到我的 SQL 曲目​​中，我确信这是一个菜鸟问题。有人可以指出我在这种情况下如何使用`like`运算符而不是`=`运算符的正确方向吗？这样做的目的是从潜在的 5 位数字中找到前 3 个常用数字

存储过程：

```
create proc dbo.MultipleDrugs (@condition varchar(50))
as
SELECT  *, 100.0 * round(SUM(numwithanxiety) OVER (partition BY sex) / cast(TotalSexCounts AS float), 4) overAllPercentByGender
FROM (SELECT x.sex, injurylevel, SUM(sexandlevelcounts) OVER (partition BY x.sex) numByInjury, sum(sexandlevelcounts) AS numWithAnxiety, 
      100.0 * round(cast(sexandlevelcounts AS float) / SUM(sexandlevelcounts) OVER (partition BY x.sex), 4) AS percentWith, y.TotalSexCounts
      FROM (SELECT sex, injurylevel, COUNT(*) AS sexAndLevelCounts
             FROM (SELECT DISTINCT m.patid, m.sex, m.injurylevel
              FROM  members AS m INNER JOIN
               icdClm AS ic ON ic.patid = m.PATID
               --*****when I leave this operator as like and use
               --*****equals in the exec statement it works
               WHERE ic.icd LIKE @condition) t
              GROUP BY sex, injurylevel) x INNER JOIN
              (SELECT m.sex, COUNT(DISTINCT patid) TotalSexCounts
                FROM members m
                GROUP BY m.sex) y ON y.sex = x.sex
               GROUP BY x.sex, x.injuryLevel, x.sexAndLevelCounts, y.TotalSexCounts) rr
 go 
```

这运行，但我不能使用`like`运算符

```
exec dbo.MultipleDrugs  N'70700' 
```

这就是我想做的

```
exec dbo.MultipleDrugs  like '707%' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:17:15.967

```
exec dbo.MultipleDrugs N'707%' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:19:30.173

你不需要`LIKE`在你的 exec 调用中提供操作员——你已经`like`在你的 SPROC 中了。考虑一个更简单的情况：

```
create proc FindObjects @Name NVARCHAR(50)
as
    select * 
        from sys.objects
        where name like @Name 
```

然后调用这个：

```
exec FindObjects 'sys%' 
```

返回

```
sysrscols
sysrowsets
sysallocunits
sysfiles1
syspriorities
sysfgfrag 
```

等等

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T21:14:19.840

更改您的 SP，以便发生以下情况：

```
LIKE '%' + @condition + '%' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-08T11:57:50.953

你也可以在程序中这样使用。设置@SearchString='%'+ @SearchString + '%'

# linux - Linux tr 命令

> ID：13573215
> 
> 赞同：0
> 
> 时间：2012-11-26T21:10:37.680
> 
> 标签：linux, csh

我对在 c-shell 中编程比较陌生，并且我遇到了 tr 命令的问题。当我执行脚本时，我收到的错误消息是“找不到 tr 命令”。我还尝试在分配给变量的 foreach 循环中显示文件的内容。这实际上只会打印文件路径的名称或其内容吗？这是我的代码：

```
#! /bin/csh

set path = /home/students/fall2012/crn12143/ford/friend_list

foreach i ($path)
echo $i | tr '[a-z]' '[A-Z]'
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:14:03.113

您正在破坏路径，因此它无法再找到`tr`. 更改路径，如：

```
set path=(/home/students/fall2012/crn12143/ford/friend_list $path) 
```

由于您并没有真正`path`像应该使用的那样使用它，因此您应该考虑将该变量重命名为其他变量。

如果您仍想删除大部分路径，请使用`tr`命令的完整路径：

```
echo $i | /path/to/tr '[a-z]' '[A-Z]' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:16:17.860

您正在重新定义 PATH 环境变量，这不好。

您应该改为使用不同的变量名称，例如：

```
set folder = /home/students/fall2012/crn12143/ford/friend_list 
```

# excel - Excel 用户窗体数据转储到 Access 2003

> ID：13573217
> 
> 赞同：0
> 
> 时间：2012-11-26T21:10:40.757
> 
> 标签：excel, ms-access

我正在尝试为我办公室中在他们的 PC 上没有 ms-access 的人开发一个用户界面。我知道可以使用 Excel 和 UserForm 来完成，但我遇到了代码问题。我有一个用于所有相关数据字段的带有文本框的用户表单。我已经开发了一个具有相应字段的 Access 数据库。我的用户表单有命令按钮来触发数据传输。我在语言上苦苦挣扎，因为我以前从未尝试过。Excel Userform 文本框的语言格式如何将其数据转储到位于同一文件夹中的 MS 数据库中？Excel 文件名为 TONUv2.xlsm，ms-Access 数据库名为 TONU-9850.mdb

# events - symfony2 我自己的事件

> ID：13573219
> 
> 赞同：2
> 
> 时间：2012-11-26T21:10:51.173
> 
> 标签：events, symfony, dispatcher

我通过 facebook 进行了授权和身份验证，如下所示： http: [//symfony.com/doc/current/cookbook/security/custom_authentication_provider.html](http://symfony.com/doc/current/cookbook/security/custom_authentication_provider.html) 它可以工作

现在我想制作自己的事件，当用户使用 facebook 进行身份验证时，这个事件会做一些事情。例如——将用户重定向到主页。我这样做了 [http://symfony.com/doc/current/components/event_dispatcher/introduction.html](http://symfony.com/doc/current/components/event_dispatcher/introduction.html)

所以我有这个类 [http://pastebin.com/2FTndtL4](http://pastebin.com/2FTndtL4)

我不知道如何实现它，我应该将什么作为参数传递给构造函数

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:30:47.860

这真的很简单。Symfony 2 事件系统功能强大，服务标签可以胜任。

1.  将调度程序注入到要触发事件的类中。服务 ID 是`event_dispatcher`；
2.  在需要时触发事件`$this->dispatcher->dispatch('facebook.post_auth', new FilterFacebookEvent($args))`；
3.  创建一个实现的服务`EventSubscriberInterface`，定义一个静态`getSubscribedEvents()`方法。当然你想听`facebook.post_auth`事件。

所以你的静态方法看起来像：

```
static public function getSubscribedEvents()
{
    return array(
        'facebook.post_auth' => 'onPostAuthentication'
    );
}

public function onPostAuthentication(FilterFacebookEvent $event)
{
    // Do something, get the event args, etc
} 
```

最后将此服务注册为调度程序的订阅者：给它一个标签（例如`facebook.event_subscriber`），然后创建一个`RegisterFacebookEventsSubscribersPass`（参见[本教程](http://symfony.com/doc/2.0/components/dependency_injection/tags.html)）。您的编译器传递应该检索所有标记的服务，并且在循环内应该调用：

```
$dispatcher  = $container->getDefinition('event_dispatcher');
$subscribers = $container->findTaggedServiceIds('facebook.event_subscriber');

foreach($subscribers as $id => $attributes) {
    $definition->addMethodCall('addSubscriber', array(new Reference($id)));
} 
```

通过这种方式，您可以快速让订阅者（例如，用于登录）简单地标记您的服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:29:30.620

事件对象只是某种状态/数据存储。它保留的数据可用于通过订阅者和/或侦听器调度某种事件。因此，例如，如果您想将 facebook id 传递给您的侦听器 - 事件是存储它的正确方式。event 也是 dispatcher 的返回值。如果您想从侦听器/订阅者返回一些数据 - 您也可以将其存储在 Event 对象中。

# actionscript-3 - AS3 点击隐藏的蒙版区域

> ID：13573221
> 
> 赞同：4
> 
> 时间：2012-11-26T21:10:58.647
> 
> 标签：actionscript-3, flash, actionscript

我正在尝试创建一个类似于[www.faceinhole.com](http://www.faceinhole.com)的 Flash 应用程序。到目前为止，我能够通过浏览功能加载我的照片。在影片剪辑中显示它。用椭圆形遮住这个影片剪辑。添加变换控件（senocular）以调整图像大小和移动图像。

问题：每当我点击蒙面电影剪辑的可见部分时，我都可以成功地拖动我的照片。但是，当我单击蒙面影片剪辑的隐藏部分时，我无法拖动照片。

问题：有没有办法将 mouseEnabled=false 添加到遮罩的隐藏区域？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:44:45.597

将一个不可见的 (alpha=0) Sprite 放在舞台或可见部分的所有内容之上，包括图片和蒙版，然后拖动它。添加一个回调，根据拖动值更新蒙版下方的图片位置。您需要重置不可见的精灵，以便您可以继续拖动图片并限制可以拖动的距离。

# neural-network - 如何计算神经网络中输入的权重

> ID：13573223
> 
> 赞同：3
> 
> 时间：2012-11-26T21:11:05.383
> 
> 标签：neural-network

在神经网络完全训练后（假设是一个正常的前馈网络），是否有办法计算一个输入相对于最终输出的权重？请注意，我不是在谈论输入相对于一个神经元的权重（该值应在训练过程中由 NN 计算和调整）。

例如，如果我有 3 个输入 x1、x2 和 x3，并且我有一个输出 y。网络训练好后，我能知道 x1 对 y 的影响有多大吗？我想它应该通过 y 对 x1 的偏导数来计算。但是我怎么知道网络所代表的非线性函数呢？这可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T04:52:51.450

好问题...

有两种方法浮现在脑海。一种是使用“Hinton 图”进行目视检查（通过谷歌查看）。然而，另一种简单的方法是为单个输入输入一个较大的值，为其他输入输入一个较小的值（零？），然后查看它对每个输出值的作用。

还有其他更高级的方法，但这些是一个很好的开始方式。

祝你好运！如果您发现任何有趣的事情以及最适合您的计算，请告诉我们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-26T13:06:24.957

我找到了一个很好的工作：

> “如何衡量输入的重要性”，由美国北卡罗来纳州卡里市 SAS Institute Inc. 的 Warren S. Sarle 撰写 [ftp://ftp.sas.com/pub/neural/importance.html](ftp://ftp.sas.com/pub/neural/importance.html)

简要地：

*   求和权重不起作用。
*   对归一化权重求和不起作用。
*   对梯度求和效果不佳。
*   一个接一个地删除（归零或设置为平均值）输入[并重新训练] - 有效但需要很多时间。
*   将输出与输入的微小差异相加 - 效果很好！

现在简要介绍一下我更喜欢使用的最后一种方法：
对于输出函数**Y = f( X1, X2, X3)**，您可以计算：

```
 D1 = f( X1+h, X2, X3) - f( X1, X2, X3)
   D2 = f( X1, X2+h, X3) - f( X1, X2, X3)
   D3 = f( X1, X2, X3+h) - f( X1, X2, X3) 
```

所有输入值对上的这些绝对差的平均值可以很好地估计每个输入的重要性。

这就是我在 Lua Torch 中的做法

> 注 1：我采用平方差而不是绝对值。
> 注 2：我的输入矩阵是标准化的，这就是为什么我可以选择 h 的值作为 [-1..1]。

```
local samples_count = inputs:size(1)
local inputs_count = inputs:size(2)
local outputs = model:forward(inputs):clone()

local importance = torch.zeros(inputs_count)

print("Processing inputs 1 to "..tostring(inputs_count)); io.flush()
for i = 1, inputs_count do
  io.write("\rProcessing "..tostring(i)); io.flush()
  for h = -1, 1, 0.2 do
    local inputs_h = inputs:clone()
    if h ~= 0 then inputs_h[{{},{i,i}}]:add(h) end
    local outputs_h = model:forward(inputs_h)
    importance[i] = importance[i] + torch.add(outputs_h, -1, outputs):pow(2):sum()
  end -- for h
end -- for inputs_count

importance:div(samples_count)
print("\nimportance:\n", importance) 
```

# objective-c - 如何从一个 UIViewController 传递另一个值？

> ID：13573228
> 
> 赞同：-1
> 
> 时间：2012-11-26T21:11:46.327
> 
> 标签：objective-c, ios, ios6

> **可能的重复：**
> [在视图控制器之间传递数据](https://stackoverflow.com/questions/5210535/passing-data-between-view-controllers)

我有两个`UIViewController`：“MenuViewController”和“DetailViewController”。

我试图`NSString`在 MenuViewController 中将 DetailViewController 的标签文本设置为 a，但不起作用。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:01:16.810

这很简单，在导航到它之前添加`@property (retain) NSString* string;`和`DetailedViewController`设置这个属性像这样

```
DetailedViewController *dvc = [[DetailedViewController alloc] init];
[dvc setString:@"someString"];
[self pushViewController:dvc] 
```

在DetailedViewController中`ViewDidLoad`设置标签：

```
[[self label] setText:[self string]]; 
```

# highcharts - 通过外部按钮启用/禁用 CrossHaires

> ID：13573230
> 
> 赞同：1
> 
> 时间：2012-11-26T21:11:52.053
> 
> 标签：highcharts

```
 tooltip: {
        crosshairs: [{
                        dashStyle: 'dash'
                    },{
                       dashStyle: 'dash'     
                    }]
                },
....

    $("#toggleCrossHaire").click(function(){
     if(chart.tooltip.crosshaires){
      chart.tooltip.crosshaires : [false,false];
    }eles{
      chart.tooltip.crosshaires : [true,true];
    }
    }); 
```

启用或禁用和更改 Crosshairs 的 dashStyle 。到坚实和破折号。通过外部按钮？？

这个[例子](http://jsfiddle.net/E568Q/2/)以获得更多解释

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:02:23.553

You can do it the following way:

*   Get the current `dashstyle`
*   Change it according to the style you want
*   Force Highcharts to redraw

```
$("#toggle").click(function(){
    var options = chart.options;
    var dashStyle = options.tooltip.crosshairs[0].dashStyle == "Solid" ? "Dot" : "Solid";
    options.tooltip.crosshairs = [{
        dashStyle: dashStyle
    }, {
        dashStyle: dashStyle
    }]
    chart = new Highcharts.Chart(options);
}); 
```

[**demo1**](http://jsfiddle.net/c23Pc/)

Note that **the code abode works only for two crosshairs**.
If you want to do it with only one you have to create the chart and set `crosshairs` with the second disabled:

```
tooltip: {
    crosshairs: [{
        dashStyle: "Solid"
    }, false]
} 
```

// remember to change the following line, because we just want to set the first one

```
options.tooltip.crosshairs = [{
    dashStyle: dashStyle
}] 
```

[**demo2**](http://jsfiddle.net/c23Pc/1/)

# javascript - ajax 方法和 SyntaxError : Unexpected token ":"

> ID：13573233
> 
> 赞同：0
> 
> 时间：2012-11-26T21:12:07.853
> 
> 标签：javascript, jquery, google-chrome

我遇到了一个简单的脚本。我需要解析来自 web 服务的一些 xml 响应

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">

    function callws() {
        $.ajax(function(){
                type:"GET",
                contentType: 'text/xml',
                dataType:"xml",
                url:"http://thewebservice/service.action?my=parameter",
                timeout:4000,
                async:false,
                success: parseXml,         
                error: function(jqXHR, textStatus, errorThrown){
                    alert(jqXHR.textStatus);
                    }
                }); // ajax

        function parseXml(xml) {
            $(xml).find("result").each(function(){
                $("#risposta").append($(this).find("row").text() + "<br />");
                });//each
           } //function parse
    } // termine callws 
```

我不明白为什么没有任何工作！我只有来自 Chrome 控制台 SyntaxError 的错误日志：第 12 行的意外令牌“：”（contentType：'text/xml'，）我尝试使用其他参数，但第一个下方的所有行（类型：“GET”）似乎错了...恕我直言，所有脚本中的语法都可以！

建议？

维托

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T21:14:05.877

我认为您的 ajax 语法错误。第一个参数是一个普通的 ole' 对象，而不是一个函数。试试这个：

```
function callws() {
        $.ajax({
                type:"GET",
                contentType: 'text/xml',
                dataType:"xml",
                url:"http://thewebservice/service.action?my=parameter",
                timeout:4000,
                async:false,
                success: parseXml,         
                error: function(jqXHR, textStatus, errorThrown){
                    alert(jqXHR.textStatus);
                    }
                }); // ajax
 // termine callws 
```

^ 我所做的只是取出`function()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:15:12.290

```
$.ajax(function(){ 
```

应该是

```
$.ajax({ 
```

# iphone - 如何根据离当前位置最近的图钉设置地图缩放

> ID：13573234
> 
> 赞同：1
> 
> 时间：2012-11-26T21:12:10.420
> 
> 标签：iphone, ios

现在我正在根据用户当前位置设置我的区域。我现在想设置缩放级别，这样我就可以看到用户当前的位置以及通过 json 拉入的最近的 pin。

直到运行时，应用程序才会知道引脚的数量或所述引脚的位置。

这是我到目前为止所拥有的。

```
@implementation LocationsViewController

@synthesize mapView;
@synthesize locationManager;
@synthesize phone;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) 
    {
        self.title = NSLocalizedString(@"Locations", @"Locations");
        self.tabBarItem.image = [UIImage imageNamed:@"locations"];
    }
    return self;
}

- (void)dealloc
{
    [super dealloc];
    [[NSNotificationCenter defaultCenter] removeObserver:self];
}

- (void)didReceiveMemoryWarning
{
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];
    // Release any cached data, images, etc that aren't in use.
}

 #pragma mark - View lifecycle

 //Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
 - (void)viewDidLoad
{
    [super viewDidLoad];
    self.locationManager = [[CLLocationManager alloc] init];
    locationManager.delegate = self;
    locationManager.desiredAccuracy = kCLLocationAccuracyBest;
    [locationManager startUpdatingLocation];
}

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
    NSLog(@"New latitude: %f", newLocation.coordinate.latitude);
    NSLog(@"New longitude: %f", newLocation.coordinate.longitude);

    MKCoordinateRegion region;
    region.center.latitude =newLocation.coordinate.latitude;
    region.center.longitude=  newLocation.coordinate.longitude;
    region.span.longitudeDelta=0.2;
    region.span.latitudeDelta =0.2;
    [mapView setRegion:region animated:YES];
    [mapView setDelegate:self];
    //[locationManager stopUpdatingLocation];

}

-(void)viewDidDisappear:(BOOL)animated
{
    [locationManager stopUpdatingLocation];   
}

-(void)viewDidAppear:(BOOL)animated 
{
    [super viewDidAppear:animated];

    [locationManager startUpdatingLocation];

    if([self connectedToNetwork] != YES)
    {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"OH NO!" message:@"To get the latest information you need a data or wi-fi connection" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];
        [alert show];
        [alert release];
    }
    else
    {
        [mapView removeAnnotations:mapView.annotations];

        NSString *urlString = [NSString stringWithFormat:@"http://www.mywebsite.com/json.json"];

        NSURL *url = [NSURL URLWithString:urlString];

        NSData *data = [NSData dataWithContentsOfURL:url];

        NSError *error;

        NSMutableDictionary *json = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];

        for(id key in json) {
            id value = [json objectForKey:key];
            NSString *titlePin = [value valueForKey:@"address"];
            NSString *address = [value valueForKey:@"title"];
            NSString *latitude = [value valueForKey:@"latitude"];
            NSString *longitude = [value valueForKey:@"longitude"];

            NSArray* foo = [address componentsSeparatedByString: @":"];
            NSString* address2 = [foo objectAtIndex: 0];
            phone = [foo objectAtIndex: 1];

            double myLatitude = [latitude doubleValue];
            double myLongitude = [longitude doubleValue];

            MKCoordinateRegion location1;
            location1.center.latitude =myLatitude;
            location1.center.longitude= myLongitude;
            location1.span.longitudeDelta=0.1;
            location1.span.latitudeDelta =0.1;

            MapAnnotation *ann1 =[[[MapAnnotation alloc] init] autorelease];
            ann1.title=[NSString stringWithFormat:@"%@",titlePin];
            ann1.subtitle=[NSString stringWithFormat:@"%@",address2];
            ann1.phone=[NSString stringWithFormat:@"%@",phone];
            ann1.coordinate= location1.center;
            [mapView addAnnotation:ann1];
            [phone retain];

        }
     }
}

-(MKAnnotationView *) mapView:(MKMapView *)mapView2 viewForAnnotation:(id<MKAnnotation>)annotation {
    if (annotation == mapView2.userLocation) {
        return nil;
    }else{
         MKPinAnnotationView *MyPin=[[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:@"current"];
        MyPin.pinColor = MKPinAnnotationColorPurple;

        UIButton *advertButton = [UIButton buttonWithType:UIButtonTypeInfoDark];
         [advertButton setImage:[UIImage imageNamed:@"mapphone"] forState:UIControlStateNormal];
         [advertButton addTarget:self action:@selector(button:) forControlEvents:UIControlEventTouchUpInside];
         MyPin.rightCalloutAccessoryView = advertButton;

        MyPin.draggable = NO;
        MyPin.highlighted = YES;
        MyPin.animatesDrop=TRUE;
        MyPin.canShowCallout = YES;

        return MyPin;
     }
 }

 -(void)button:(id)sender {

     UIButton *button = (UIButton *)sender;

     MKPinAnnotationView *annotationView = (MKPinAnnotationView*)button.superview.superview;

     MapAnnotation *mapAnnotation = annotationView.annotation;

     UIDevice *device = [UIDevice currentDevice];
     if ([[device model] isEqualToString:@"iPhone"] ) {
         [[UIApplication sharedApplication] openURL:[NSURL URLWithString:[NSString stringWithFormat:@"tel:%@",mapAnnotation.phone]]];
     } else {
         UIAlertView *Notpermitted=[[UIAlertView alloc] initWithTitle:mapAnnotation.phone message:@"Your device doesn't support this feature." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
         [Notpermitted show];
         [Notpermitted release];
    }

}

 - (BOOL) connectedToNetwork
 {  
    Reachability *r = [Reachability reachabilityWithHostName:@"www.google.com"];
    NetworkStatus internetStatus = [r currentReachabilityStatus];
    BOOL internet;
    if ((internetStatus != ReachableViaWiFi) && (internetStatus != ReachableViaWWAN)) {
        internet = NO;
    } else {
        internet = YES;
    }
    return internet;
} 

- (void)viewDidUnload
{
    [super viewDidUnload];
    // e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    return YES;
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T05:00:07.873

我做了类似的事情，但基于两个注释，而不是用户的位置。您应该能够将 mapView.centerCoordinate 替换为 mapView.userLocation.coordinate。

在 viewForAnnotation 中：

```
 CLLocation *centerLoc = [[CLLocation alloc] initWithLatitude:mapView.centerCoordinate.latitude longitude:mapView.centerCoordinate.longitude];
   CLLocation *loc2 = [[CLLocation alloc] initWithLatitude:[annotation coordinate].latitude longitude:[annotation coordinate].longitude];
   CLLocationDistance distance = [loc2 distanceFromLocation:centerLoc];

   MKCoordinateRegion viewRegion = MKCoordinateRegionMakeWithDistance(mapView.centerCoordinate, distance*2, distance*2);
   MKCoordinateRegion adjustedRegion = [mapView regionThatFits:viewRegion];
   [mapView setRegion:adjustedRegion animated:YES]; 
```

请注意，每次添加注释时，此代码都会重新计算缩放级别。您可能需要保存距离，并且仅在新距离大于先前距离时才更改地图。

# php - 为 5.2.17 扩展 mysqli_stmt 添加 fetchAll？

> ID：13573235
> 
> 赞同：0
> 
> 时间：2012-11-26T21:12:22.647
> 
> 标签：php, mysql, mysqli

php 5.2.17

mysqliprepared statements 结果绑定到变量。

想要扩展 mysqli_stmt 以添加自定义 fetchAll 方法。

为什么？因为想停止为准备好的语句数据库结果编写相同的 while 语句，并将代码包含在 mysqli 本身中，以便自动处理所有调用。我还添加了我自己的特殊代码和过滤器。

我已经能够扩展 mysqli 类并添加自定义处理来为非准备好的语句执行此操作，但希望将其添加到准备好的语句处理中。

阅读stackoverflow和其他地方，我发现了一些扩展mysqli_stmt的例子，但没有类似于为php 5.2x添加一个fetchAll类型的自定义方法。

我不明白这是如何工作的，我对 OOP 和扩展核心 php 类有点陌生，并且希望尽可能多地解释，以便我可以学习。

我的虚拟主机有 php 5.2.17，我无法控制它，所以升级 php 不是一种选择。我创建了一个处理 PDO、mysqli 和 mysql 数据库连接的类。我现在正在尝试优化这一点，并尽可能地封装和移动到相关领域，因此我有兴趣这样做。

我了解结果类，但据我所知，获取准备好的语句的处理是通过 mysqli_stmt 类完成的，该类只有 fetch 来检索结果。我无法从这门课内得到结果，只能在外面得到。我假设由于绑定或参数和变量。我不完全了解这里的过程。

我得到的结果也绑定到变量，这些是通过 while 循环更新的。我想采用这个过程并将其放在 stmt 类中，但我不明白如何做到这一点。

感谢您提供任何帮助。我很聪明，但我很难理解这个过程，所以如果你能很好地解释它，那就太好了。

谢谢。

编辑：

我想添加到此以显示一些代码。

```
$mysqli->execute();     
$mysqli->store_result();
$mysqli->bind_result($id, $name, $age);                     

$i = 0;
While($mysqli->fetch()){            
    $array[$i]['id'] = $id;
    $array[$i]['age'] = $age;
    $array[$i]['name'] = $name;
    $i++;
}           

return $array; 
```

查看 While 语句。

现在假设我想将它放入 MYSQLI_STMT 类中，这样我就不必一遍又一遍地编写它，只需让 MYSQL_STMT 类处理它。

这将进入一个名为 FetchALL 的新方法。问题是，它不起作用。由于这个准备好的语句，当它们到达这一点时，语句和 SQL 还没有准备好。

我不了解这个过程来做这样的事情，而且我对我认为会发生什么的猜测已经结束了。

以下是我编辑的代码，不是我原创的。我忘记了我从哪里得到它以及作者是谁，但我不相信下面的代码。我确实从原始版本中更改了一些内容，并删除了与我的问题/问题无关的所有内容。

```
class my_mysqli_stmt extends mysqli_stmt{

public function __construct($link, $query) {
    parent::__construct($link, $query);
}  

public function fetchAll(){

    echo "FetchAll Method";

    while($this->fetch()){
        # Nothing happens here
        # and don't know what 
        # to insert here if it did  
    }
  }
}

class my_Mysqli extends mysqli {

    public function prepare($query) {
        return new my_Mysqli_stmt($this, $query);
    }
} 
```

上面带有 WHILE 语句的代码块将被替换为：

```
$mysqli->execute();        
$mysqli->store_result();
$mysqli->bind_result($id, $name, $age);     

$mysqli->fetchAll();   <--  This would replace the WHILE loop. 
```

当然，这是行不通的。也许它不打算以这种方式工作，但如果可以这样做，这样就不需要while循环并且所有记录都通过一次调用返回，那就太好了。

在代码中查看这一点，似乎这个概念对我来说是草率的想法，但是将所有代码封装在一个地方会很棒。

也许做类似的事情：

```
$mysqli->fetchAll($id, $name, $age); 
```

并返回绑定参数？我不知道我现在很困惑。

好的，重看这个。。

每次 Fetch 循环发生时，参数都会使用从数据库中检索到的行中的相关数据自动更新。

这里会发生或应该发生的是，当 FetchAll 被调用时，它会返回一个包含所有绑定参数和数据的关联数组，以便在此之后立即返回该数组，因为它是在 MYSQLI_STMT 类中创建的，然后返回到 FetchAll 最初被调用从。

砰！Presto Chango 和检索到的所有记录都在一个关联数组中，可供使用。看，全部封装。问题是.. 怎么样？无法让它工作。

感谢您阅读这个问题的坟墓。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T12:58:44.253

这是很有可能的。
您唯一需要做的就是*切换到**PDO**。*

PDO 确实拥有 mysqli 所需的一切以及更多：`fetchAll`开箱即用，`bindValue`(!!!), `bind-in-execute`, `fetchColumn`...

如果你注定要使用 mysqli，那么你无能为力。有一个内置函数`fetch_all()`可以让您获得关联数组或枚举数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T12:49:12.077

我认为这是不可能的（我正在运行 PHP 5.4.4），因为无法访问绑定变量。

即使有，也很难隐含地告诉哪个绑定变量应该分配给每个返回的值`fetch()`

我尝试重载该`bind_result()`函数（见下文），但由于变量作为参考传递而遇到了麻烦。

```
public function bind_result() {
    $this->bound_variables = func_get_args();

    // The next line won't work in < 5.3
    call_user_func("parent::bind_result", $this->bound_variables);
} 
```

所以我收到以下错误：`Warning: Parameter 1 to mysqli_stmt::bind_result() expected to be a reference, value given...`

我也尝试添加`fetchAll`作为`my_Mysqli`而不是`my_mysqli_stmt`类的一部分，但同样，它失败了，因为我们无法将绑定变量作为引用，只能作为值。

```
class my_Mysqli extends mysqli {

    public function prepare($query) {
        return new my_Mysqli_stmt($this, $query);
    }

    private $bound_vars;

    public function fetchAll($statement) {

        $args = func_get_args();
        $first = true;
        // Even though we try using 'by reference' here, the arguments themselves
        // are passed in 'by value' by default (because we haven't specified them
        // in the function definition)
        foreach($args as &$a) {
            if ($first) { continue; $first = false; }
            $this->bound_vars[] = $a;
        }

        while($statement->fetch()){
            // This doesn't work, because we haven't got references back to
            // the original variables
            printf ("%s (%s)\n", $this->bound_vars[0], $this->bound_vars[1]);
        }
    }
}
$mysqli = new my_Mysqli();
$stmt = $mysqli->prepare($query);
$stmt->execute();
$stmt->bind_result($id, $age, $name);
$mysqli->fetchAll($stmt, $id, $age, $name); 
```

# sql - SQL方言翻译桥？

> ID：13573237
> 
> 赞同：1
> 
> 时间：2012-11-26T21:12:25.620
> 
> 标签：sql, database, translation

我想知道是否有任何透明的解决方案可以让我连接到表现得像一个数据库的服务器，然后一旦执行查询，这样的服务器就会连接到一些预定义的第三方 SQL 服务器（它使用不同的协议，例如，从 MySQL 到 Oracle），将 SQL 查询翻译成第三方服务器的方言，执行并返回翻译结果。换句话说：

1.  用户连接到“网桥”并使用例如 Oracle 的协议调用简单的 DML 查询
2.  “桥”连接到某个预定义的服务器，将查询转换为 MySQL 的 SQL 方言并运行它，然后将结果转换为 Oracle 的协议消息并发送回用户

有没有提供这种功能的项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:05:46.713

当然，IBM 至少有一个产品，他们的[Federation Server](http://www-01.ibm.com/software/data/infosphere/federation-server/)。当然，它是企业级的，这对于您的特定情况可能有点过分（尽管它看起来几乎可以在[任何硬件](http://www-01.ibm.com/support/docview.wss?uid=swg27024461)上运行）。

# sql - 我如何每 24 小时缓存一个变量？

> ID：13573239
> 
> 赞同：0
> 
> 时间：2012-11-26T21:12:29.930
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一个性能糟糕的查询：

```
select COUNT(distinct accession_id) count,MONTH(received_date) month,YEAR(received_date) year
into #tmpCounts
from F_ACCESSION_DAILY
where CLIENT_ID not in (select clientid from SalesDWH..TestPractices)
group by MONTH(received_date),YEAR(received_date) 
```

我不想等待这个查询，而是想创建一个变量或一个视图或任何其他我可以存储在服务器上的东西，并让服务器每 24 小时自动计算一次。

我想然后能够做一个`select * from #tmpCounts`

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:32:19.190

除了您的性能问题和尝试每天一次预构建的替代方法...您要处理多少条记录以处理此查询。

此外，我会更改查询，因为 IN ( SUBSELECT ) 总是很糟糕。我将更改为客户端表的 LEFT-JOIN 并测试是否为 NULL

```
select 
      YEAR(FAD.received_date) year,
      MONTH(FAD.received_date) month,
      COUNT(distinct FAD.accession_id) count
   from 
      F_ACCESSION_DAILY FAD
         LEFT JOIN SalesDWH..TestPractices TP
            on FAD.Client_ID = TP.ClientID
   where 
      TP.CLIENT_ID IS NULL
   group by 
      YEAR(FAD.received_date),
      MONTH(FAD.received_date) 
```

我还将确保在收到日期的 ACCESSION 表上有一个索引，在其 ClientID 上有你的 TestPractices 表

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:23:17.157

我不知道这是否满足您的需要，但我会创建一个表来存储它，使用 SQL Server 代理创建一个仅截断表的作业，运行您上面提到的查询并插入行。从那时起，您可以通过这种方式查询表以获取这些结果。

顺便说一句，截断和加载表的最简单方法可能是运行一个非常简单的 SSIS 包。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T14:38:49.960

考虑创建索引视图，而不是创建缓存表。有一些限制，但您可能无需太多额外的处理或代码就可以显着提高性能。

以下是一些基本信息：

[http://beyondrelational.com/quiz/sqlserver/tsql/2011/questions/advantage-and-disadvantage-of-using-indexed-view-in-sql-server.aspx](http://beyondrelational.com/quiz/sqlserver/tsql/2011/questions/advantage-and-disadvantage-of-using-indexed-view-in-sql-server.aspx)

# android - 无法在 Android 版本 17 上为 webview 设置 cookie

> ID：13573241
> 
> 赞同：0
> 
> 时间：2012-11-26T21:12:51.273
> 
> 标签：android, android-webview

我使用以下代码检查 Andriod 版本并相应地设置域。

```
domain = "domain.com";
int androidVersion = android.os.Build.VERSION.SDK_INT;
Log.d(TAG, "Android version" +androidVersion);
if(androidVersion >= 14){
    Log.d(TAG, "version is greater than 14");
    domain = ".domain.com";
} 
```

并设置cookie。我使用以下代码：

```
CookieManager cookieManager = CookieManager.getInstance();
if(!cookie.equals("")){
    cookieManager.setCookie(domain, cookie);
}
try{
    CookieSyncManager.getInstance().sync();
}catch(IllegalStateException e){
    e.printStackTrace();
} 
```

此代码在低于 17 的版本上运行良好。当我检查刚刚在 javascript 上设置的 cookie 时。我在 android 版本 17 上看不到它。任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:24:57.073

setCookie 的第一个参数应该是一个完整的 URL，例如“http://domain.com/”。此外，如果您使用的是 WebView，则 cookie 不会立即生效。您可以尝试将其与 CookieSyncManager 同步。

[http://developer.android.com/reference/android/webkit/CookieSyncManager.html](http://developer.android.com/reference/android/webkit/CookieSyncManager.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T08:12:22.643

希望对你有帮助 ？？这是我在我的应用程序中写的，它会起作用。

```
Cookie sessionCookie = LoginWebView.cookie;
CookieSyncManager.createInstance(webview.this);
CookieManager cookieManager = CookieManager.getInstance();
if (sessionCookie != null) {
    cookieManager.removeSessionCookie();
    String cookieString = sessionCookie.getName();
    Log.v(TAG, "sync cookies: " + cookieString);
    cookieManager.setCookie(domain, cookieString);
    CookieSyncManager.getInstance().sync();

} 
```

# c# - 如何将异常抛出到下一个捕获？

> ID：13573244
> 
> 赞同：25
> 
> 时间：2012-11-26T21:13:00.513
> 
> 标签：c#, exception, exception-handling

![在此处输入图像描述](../Images/16714fada9b561982a07f16767eacf03.png)

我想在下一次捕获时抛出异常，（我附上了图片）

有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2015-12-30T23:29:29.403

`C# 6.0`救援！

```
try
{
}
catch (Exception ex) when (tried < 5)
{
} 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-11-26T21:15:50.260

你不能，并且试图这样做表明你的`catch`块中有太多的逻辑，或者你应该重构你的方法只做*一*件事。如果你不能重新设计它，你将不得不嵌套你的`try`块：

```
try
{
    try
    {
        ...
    }
    catch (Advantage.Data.Provider.AdsException)
    {
        if (...)
        {
            throw; // Throws to the *containing* catch block
        }
    }
}
catch (Exception e)
{
    ...
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-11-26T21:20:22.237

一种可能性是嵌套 try/catch 子句：

```
try
{
    try
    {
        /* ... */
    }
    catch(Advantage.Data.Provider.AdsException ex)
    {
        /* specific handling */
        throw;
    }
}
catch(Exception ex)
{
    /* common handling */
} 
```

还有另一种方法 - 仅使用您的一般 catch 语句并自己检查异常类型：

```
try
{
    /* ... */
}
catch(Exception ex)
{
    if(ex is Advantage.Data.Provider.AdsException)
    {
        /* specific handling */
    }

    /* common handling */
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T22:47:34.277

这个答案的灵感来自[Honza Brestan 的回答](https://stackoverflow.com/a/13573349/1336654)：

```
}
catch (Exception e)
{
  bool isAdsExc = e is Advantage.Data.Provider.AdsException;

  if (isAdsExc)
  {
    tried++;
    System.Threading.Thread.Sleep(1000);
  }

  if (tried > 5 || !isAdsExc)
  {
    txn.Rollback();
    log.Error(" ...
    ...
  }
}
finally
{ 
```

`try`将两个块相互嵌套在一起很丑。

如果您需要使用 的属性`AdsException`，请使用强制转换`as`而不是`is`.

# c# - NHibernate - 获得一对多

> ID：13573247
> 
> 赞同：0
> 
> 时间：2012-11-26T21:13:11.367
> 
> 标签：c#, nhibernate

想知道是否有人可以指出我正确的方向..

我的 sqlserver 数据库中目前有以下 3 个表

参数 ParameterId ParameterName

ParameterValue ParameterValueId ParameterValue

ParameterParameterValue ParameterId ParameterValueId

我试图在 Parameter 域对象也将获取所有 ParameterValue 对象的位置获取它（我猜 Parameter 与 ParameterValue 具有一对多关系，因为参数可以有多个值）但我'我无处可去-我实现的 msot 是获取第一个值，而不是全部 :(

如果有人愿意提供帮助或任何我可以发布一些代码和/或我正在使用的映射的东西 - 一如既往，非常感谢任何帮助:)

参数映射

```
<?xml version="1.0" encoding="utf-8" ?>
    <hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" 
               namespace="StockMarketAdvisorDatabaseAccess.Domain" 
               assembly="StockMarketAdvisorDatabaseAccess">
<class name="Parameter" table="Parameter">
        <id name="ParameterId">
            <column name="ParameterId" sql-type="int" not-null="true" />
            <generator class="identity" />
        </id>
        <property name="ParameterName" />
        <bag name="ParameterValues" table="ParameterParameterValue" cascade="none">
            <key column="ParameterValueId" />
            <one-to-many class="ParameterValue" />
        </bag>
    </class>
</hibernate-mapping> 
```

ParameterValue 的映射

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" 
                   namespace="StockMarketAdvisorDatabaseAccess.Domain" 
                   assembly="StockMarketAdvisorDatabaseAccess">
    <class name="ParameterValue" table="ParameterValue">
        <id name="ParameterValueId">
            <column name="ParameterValueId" sql-type="int" not-null="true" />
            <generator class="identity" />
        </id>
        <property name="Value" column="ParameterValue"/>
     </class>
</hibernate-mapping> 
```

再次感谢，刚开始使用 nHibernate，所以仍在努力解决它！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:52:59.520

您的问题是您描述的是一件事（1-many），但您的表结构是另一件事（many-many）

如果每个参数需要多个值，则应将表结构简化为：

> 参数
> -------------
> * ParameterId
> ParameterName
> 
> ParameterValue
> --------
> * ParameterValueId
> ParameterId
> ParameterValue

然后您的映射可以使用一对多映射：

```
<class name="Parameter" table="Parameter">
    <id name="ParameterId">
        <column name="ParameterId" sql-type="int" not-null="true" />
        <generator class="identity" />
    </id>
    <property name="ParameterName" />
    <bag name="ParameterValues" table="ParameterValue" cascade="none">
        <key column="ParameterId" />
        <one-to-many class="ParameterValue" />
    </bag>
</class> 
```

# windows - 在 .NET 或 Win32 中快速播放短音

> ID：13573250
> 
> 赞同：0
> 
> 时间：2012-11-26T21:13:27.157
> 
> 标签：windows, audio, real-time

我需要在我的应用程序中每秒播放 60 次以上的短声音。触发模式事先不知道，所以我无法制作一个包含 60 次重复相同声音的大文件。声音需要异步播放。

每次您要求异步播放声音时，C#`SoundPlayer`和 Win32似乎都会启动一个单独的线程。`PlaySound()`我不希望创建这么多线程的开销，所以我不能使用这些选项。此外，如果在前一个触发器仍在播放时再次触发声音，则声音应重新启动或重叠播放，而不是排队等待稍后播放。

是否有任何预烘焙的 .NET 或 Win32 工具可以做到这一点？现在我在想我需要一个使用手动线程和事件构建的较低级别的解决方案。

# ruby-on-rails - etc/bash.bashrc：第 2 行：GREP_OPTIONS：找不到命令

> ID：13573251
> 
> 赞同：0
> 
> 时间：2012-11-26T21:13:39.837
> 
> 标签：ruby-on-rails, linux, bash, shell, ubuntu

当我在我的 Ubuntu 12 服务器上运行命令时，我收到以下警告...

```
etc/bash.bashrc: line 2: GREP_OPTIONS: command not found 
```

我可能通过卸载各种 Rails 部件搞砸了一些事情。我怎样才能解决这个问题？这是针对 root 用户的。谢谢。

我的 bashrc 文件的开头有以下内容......

> 输入 rvm >/dev/null 2>/dev/null || 回声 ${PATH} | GREP_OPTIONS \grep "" > /dev/null || 导出 PATH="${PATH}:"

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:34:00.197

您似乎`rvm`已从系统中卸载，因为它找不到`$rvm_path_bin`. 我建议从`/etc/bash.bashrc`.

# c++ - 多生产者/消费者表现

> ID：13573252
> 
> 赞同：2
> 
> 时间：2012-11-26T21:13:44.407
> 
> 标签：c++, multithreading, performance, boost

我编写了一个 SharedQueue，旨在与多个生产者/消费者一起工作。

```
class SharedQueue : public boost::noncopyable
{
public:
  SharedQueue(size_t size) : m_size(size){};
  ~SharedQueue(){};

  int count() const {return m_container.size();};
  void enqueue(int item);
  bool enqueue(int item, int millisecondsTimeout);

private:
  const size_t m_size;
  boost::mutex m_mutex;
  boost::condition_variable m_buffEmpty;
  boost::condition_variable m_buffFull;

  std::queue<int> m_container;
};

void SharedQueue::enqueue(int item)
{
  {
    boost::mutex::scoped_lock lock(m_mutex);
    while(!(m_container.size() < m_size)) 
    {
      std::cout << "Queue is full" << std::endl;
      m_buffFull.wait(lock);
    }
    m_container.push(item);
  }
  m_buffEmpty.notify_one();
}

int SharedQueue::dequeue()
{
  int tmp = 0;
  {
    boost::mutex::scoped_lock lock(m_mutex);

    if(m_container.size() == 0) 
    {
      std::cout << "Queue is empty" << std::endl;
      m_buffEmpty.wait(lock);
    }

    tmp = m_container.front();
    m_container.pop();
  }

  m_buffFull.notify_one();
  return tmp;
}

SharedQueue Sq(1000);

void producer()
{
  int i = 0;
  while(true)
  {
    Sq.enqueue(++i);
  }
}

void consumer()
{
  while(true)
  {
    std::cout  << "Poping: " << Sq.dequeue() << std::endl;
  }
}

int main()
{

  boost::thread Producer(producer);
  boost::thread Producer1(producer);
  boost::thread Producer2(producer);
  boost::thread Producer3(producer);
  boost::thread Producer4(producer);

  boost::thread Consumer(consumer);

  Producer.join();
  Producer1.join();
  Producer2.join();
  Producer3.join();
  Producer4.join();

  Consumer.join(); 

  return 0;
} 
```

如您所见，我使用 boost::condition_variable。有没有办法让性能更好？也许我应该考虑任何其他同步方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:52:50.833

在不是综合测试的真实场景中，我认为您的实现已经足够好。

但是，如果您期望每秒进行10 ^(6次或更多操作，并且您正在为 Windows 进行开发，那么您的解决方案并不是那么好。)

1.  在 Windows 上，当您使用多线程类时，Boost 传统上非常糟糕。对于互斥体，CriticalSection 对象通常要快得多。对于 cond.vars，boost 的作者正在重新发明轮子，而不是使用[正确的 Win32 API](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683469%28v=vs.85%29.aspx)。

2.  在 Windows 上，我希望称为“I/O 完成端口”的本地多生产者/消费者队列对象比任何可能的用户模式实现更有效数倍。它的主要目标是 I/O，但是调用[PostQueuedCompletionStatus API](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365458%28v=vs.85%29.aspx)将您想要的任何内容发布到队列中是完全可以的。唯一的缺点——队列没有上限，所以你必须自己限制队列大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:32:05.240

这不是您问题的直接答案，但它可能是一个不错的选择。

根据您想要提高性能的程度，看看[Disruptor Pattern](https://stackoverflow.com/questions/6559308/how-does-lmaxs-disruptor-pattern-work)可能是值得的：[http ://www.2robots.com/2011/08/13/ac-disruptor/](http://www.2robots.com/2011/08/13/a-c-disruptor/)

# ios - NSMutableArray 移除 objectAtIndex NSRangeException IOS

> ID：13573254
> 
> 赞同：1
> 
> 时间：2012-11-26T21:13:49.930
> 
> 标签：ios, cocos2d-iphone, nsmutablearray, nsrangeexception

当我`NSRangeException`尝试`removeObjectAt:0`. 我不知道这怎么可能。

```
-(void)removePoints:(ccTime *)tm
{

    NSLog(@"naughty %@",_naughtytoucharray);
    if ([_naughtytoucharray count]>0)
    {
        [_naughtytoucharray removeObjectAtIndex:0];
    }
} 
```

在日志上显示：

`[4195:c07] naughty ( "{124, 98}", "{123, 98}", "{135, 97}", "{124, 98}", "{148, 94}", "{135, 97}", "{157, 93}", "{148, 94}", "{162, 92}", "{157, 93}", "{164, 92}", "{162, 92}" )`

然后我收到以下错误： `*** Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[__NSArrayM objectAtIndex:]: index 11 beyond bounds [0 .. 10]'`

当我设置断点时，我看到所有对象都是`0x0`

![在此处输入图像描述](../Images/63ba0dd10139d4ff3c06290b44bf9a01.png)

`NSMutableArray`分配初始化`init`填入`ccTouchesMoved`

```
-(void) ccTouchesMoved:(NSSet *)touches withEvent:(UIEvent *)event  {

    if (isSelected) {

        UITouch *touch = [ touches anyObject];
        CGPoint new_location = [touch locationInView: [touch view]];
        new_location = [[CCDirector sharedDirector] convertToGL:new_location];

        CGPoint oldTouchLocation = [touch previousLocationInView:touch.view];
        oldTouchLocation = [[CCDirector sharedDirector] convertToGL:oldTouchLocation];
        oldTouchLocation = [self convertToNodeSpace:oldTouchLocation];

        // add my touches to the naughty touch array
        [_naughtytoucharray addObject:NSStringFromCGPoint(new_location)];
        [_naughtytoucharray addObject:NSStringFromCGPoint(oldTouchLocation)];

    }
} 
```

知道为什么我不能删除数组的第一项吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T21:32:34.033

那不是你的错误来自哪里。它抱怨的方法是`objectAtIndex:`, not `removeObjectAtIndex:`，导致错误的索引是十一，而不是零。

在您的代码中寻找一个地方，您假设在读取数组时至少有 12 个对象。只有 11 个，它们的索引是 0 到 10。

# php - 如何迭代一个位值？

> ID：13573255
> 
> 赞同：5
> 
> 时间：2012-11-26T21:13:51.163
> 
> 标签：php, bitboard

我想通过位板系统构建一个棋盘。从 12 个位板开始，我想显示一个表格（棋盘），在循环/迭代期间必须绘制一块。

我如何遍历所有位值？我在想类似的东西： for(i=0;i<64;i++) draw table / build array / draw empty square

这些是我开始游戏的价值观：

```
 function init_game($whitePlayer,$blackPlayer)
{
    $WhitePawns     = '0000000000000000000000000000000000000000000000001111111100000000';
    $WhiteKnights   = '0000000000000000000000000000000000000000000000000000000001000010';
    $WhiteBishops   = '0000000000000000000000000000000000000000000000000000000000100100';
    $WhiteRooks     = '0000000000000000000000000000000000000000000000000000000010000001';
    $WhiteQueens    = '0000000000000000000000000000000000000000000000000000000000010000';
    $WhiteKing      = '0000000000000000000000000000000000000000000000000000000000001000';

    $BlackPawns     = '0000000011111111000000000000000000000000000000000000000000000000';
    $BlackKnights   = '0100001000000000000000000000000000000000000000000000000001000010';
    $BlackBishops   = '0010010000000000000000000000000000000000000000000000000000100100';
    $BlackRooks     = '1000000100000000000000000000000000000000000000000000000000000000';
    $BlackQueens    = '0000100000000000000000000000000000000000000000000000000000000000';
    $BlackKing      = '0001000000000000000000000000000000000000000000000000000000000000';

    $WhitePieces = $WhitePawns|$WhiteKnights|$WhiteBishops|$WhiteRooks|$WhiteQueens|$WhiteKing;
    $BlackPieces = $BlackPawns|$BlackKnights|$BlackBishops|$BlackRooks|$BlackQueens|$BlackKing;
} 
```

有人问我：为什么要使用bitboard？答：关于位板

位板，通常用于国际象棋、跳棋和黑白棋等棋盘游戏，是位集数据结构的一种特殊形式，其中每个位代表一个游戏位置或状态，旨在优化速度和/或内存或磁盘在大规模计算中的使用。同一个位板上的位在游戏规则中相互关联，当放在一起时通常会形成一个游戏位置。其他位板通常用作掩码来转换或回答有关位置的查询。“游戏”可以是任何类似游戏的系统，其中信息以结构化形式紧密包装，“规则”影响各个单元或部分如何关联。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:40:55.653

首先你必须检查你的 PHP 版本是否支持 64 位整数，否则你会得到奇怪的结果。

赶紧跑：

```
echo PHP_INT_MAX; 
```

如果结果是`9223372036854775807`那么它应该工作。

您正在使用字符串，我`$string | $string`想当您按照上面的方式进行操作时，它将被转换为以 10 为底的整数，因此结果不会是您想要的。自 PHP 5.4 起，您可以使用`0b000`符号，对于较低的 PHP 版本，您需要将其保持为十六进制或以 10 为基数的格式。如果您将值存储在 DB 或类似的地方，并且您将收到字符串形式的值，或者您只想将其保留为上述格式，那么您必须先使用`intVal($value, 2)`它来正确转换它。

要迭代值，您可以使用`for`循环（如您所建议的那样）：

```
$value = intVal($WhitePieces,2);
for ($i = 0 ; $i < 64 ; ++$i) {
    if ((pow(2,$i) & $value)) {
        // draw piece
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:13:06.160

你没有位值，你有字符串。并且字符串应该是难于或的。

你怎么循环？使用数组和 foreach。

您如何使用 64 位值？使用 PHP 5.4 和二进制数字格式：0b00001111 => 16 - 或者将整数值表示为十六进制或十进制，这对于不会改变的游戏设置例程来说应该是完全可以的，因为这些规则是众所周知的几个世纪。

请记住，您必须使用 64 位系统来执行您的代码，否则 PHP 将无法支持 64 位整数，并且将它们视为浮点值，或者将它们缩短为 32 位值，具体取决于您实际执行的操作。

由于这一切，我建议不要在解决方案中使用位域。编写更像汇编程序的程序似乎是一个好主意，但是您不是在编写汇编程序，并且与其他任何方法相比，可能会以非最佳性能为这种方法付费。

# mongodb - mongodb：如何在 map/reduce 之后避免 value.*

> ID：13573258
> 
> 赞同：1
> 
> 时间：2012-11-26T21:14:05.920
> 
> 标签：mongodb, format

在使用 mongoDB 使用 mapreduce 之后，我担心结果具有“二维”而不是平面文档。

即文件看起来像 {id:..., value:{test:123}}

相反，我更喜欢这种格式： {...,test:123}

如何为结果/输出集合选择这种风格？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T00:28:17.747

MongoDB map/reduce 作业的输出集合将始终具有顶级结构

```
{_id: <something>, value: <something> } 
```

也就是说，它将始终是具有两个键的文档。如果你想让“值”是一个单一的值，你可以通过控制你的 emit() 和 reduce() 函数来做到这一点。

这是一个 emit() 函数，它将为“value”发出单个值：

```
emit() { this.date, 1 } 
```

这是一个 reduce() 函数，它将为“value”返回一个值：

```
reduce() {
  var count = 0;

  values.forEach(function(v) {
    count += v;
  });

  return count;
}; 
```

请记住：emit() 发出的文档的“形状”***必须***与 reduce() 返回的相同。

如果这样做，输出集合中的文档将如下所示：

```
{ _id: ISODate("2012-11-27T00:27:41.103Z"), value: 99 } 
```

# go - 将 [] 字符串转换为 [] 字节

> ID：13573269
> 
> 赞同：26
> 
> 时间：2012-11-26T21:14:51.447
> 
> 标签：go

我希望在 GO 中将字符串数组转换为字节数组，以便将其写入磁盘。将字符串数组 ( ) 编码和解码为`[]string`字节数组 ( `[]byte`) 的最佳解决方案是什么？

我正在考虑对字符串数组进行两次迭代，第一次是获取字节数组所需的实际大小，第二次是`[]byte(str)`为每个元素写入长度和实际字符串 ()。

解决方案必须能够以其他方式转换它；从一个`[]byte`到一个`[]string`。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-27T00:08:04.307

让我们暂时忽略这是 Go 的事实。您需要的第一件事是编组`[]string`到的序列化格式。

这里有很多选择。您可以自己构建或使用库。我将假设您不想构建自己的并跳转到支持的序列化格式。

在所有示例中，data 是`[]string`您正在读取/写入的文件，而 fp 是您正在读取/写入的文件。错误被忽略，检查函数的返回来处理错误。

## 采空区

Gob 是一种仅限二进制格式。随着字符串数量的增加，它应该相对节省空间。

```
enc := gob.NewEncoder(fp)
enc.Encode(data) 
```

阅读也很简单

```
var data []string
dec := gob.NewDecoder(fp)
dec.Decode(&data) 
```

Gob 简单明了。但是，该格式仅适用于其他 Go 代码。

## json

接下来是json。Json 是一种几乎无处不在的格式。这种格式同样易于使用。

```
enc := json.NewEncoder(fp)
enc.Encode(data) 
```

对于阅读：

```
var data []string
dec := json.NewDecoder(fp)
dec.Decode(&data) 
```

## XML

XML 是另一种常见的格式。但是，它具有相当高的开销并且不那么容易使用。虽然您可以对 gob 和 json 执行相同的操作，但正确的 xml 需要一个根标记。在这种情况下，我们使用根标签“Strings”，每个字符串都包裹在一个“S”标签中。

```
type Strings struct {
    S []string
}

enc := xml.NewEncoder(fp)
enc.Encode(Strings{data})

var x Strings
dec := xml.NewDecoder(fp)
dec.Decode(&x)
data := x.S 
```

## CSV

CSV 不同于其他的。您有两种选择，使用一条记录 n 行或 n 记录 1 行。以下示例使用 n 条记录。如果我用一张唱片会很无聊。它看起来太像其他人了。CSV 只能保存字符串。

```
enc := csv.NewWriter(fp)
for _, v := range data {
    enc.Write([]string{v})
}
enc.Flush() 
```

读书：

```
var err error
var data string
dec := csv.NewReader(fp)
for err == nil {        // reading ends when an error is reached (perhaps io.EOF)
    var s []string

    s, err = dec.Read()
    if len(s) > 0 {
        data = append(data, s[0])
    }
} 
```

* * *

您使用哪种格式是一个偏好问题。还有许多其他可能的编码我没有提到。例如，有一个名为 bencode 的外部库。我个人不喜欢bencode，但它确实有效。它与 bittorrent 元数据文件使用的编码相同。

如果您想制作自己的编码，encoding/binary 是一个不错的起点。这将允许您制作最紧凑的文件，但我认为这不值得付出努力。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-26T21:47:44.490

gob 包将为您执行此操作[http://godoc.org/encoding/gob](http://godoc.org/encoding/gob)

[使用http://play.golang.org/p/e0FEZm-qiS](http://play.golang.org/p/e0FEZm-qiS)玩的示例

相同的源代码如下。

```
package main

import (
    "bytes"
    "encoding/gob"
    "fmt"
)

func main() {
    // store to byte array
    strs := []string{"foo", "bar"}
    buf := &bytes.Buffer{}
    gob.NewEncoder(buf).Encode(strs)
    bs := buf.Bytes()
    fmt.Printf("%q", bs)

    // Decode it back
    strs2 := []string{}
    gob.NewDecoder(buf).Decode(&strs2)
    fmt.Printf("%v", strs2)
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-16T11:34:43.407

为了说明问题，先转换`[]string`为`[]byte`再转换`[]byte`回`[]string`，这是一个简单的解决方案：

```
package main

import (
    "encoding/binary"
    "fmt"
)

const maxInt32 = 1<<(32-1) - 1

func writeLen(b []byte, l int) []byte {
    if 0 > l || l > maxInt32 {
        panic("writeLen: invalid length")
    }
    var lb [4]byte
    binary.BigEndian.PutUint32(lb[:], uint32(l))
    return append(b, lb[:]...)
}

func readLen(b []byte) ([]byte, int) {
    if len(b) < 4 {
        panic("readLen: invalid length")
    }
    l := binary.BigEndian.Uint32(b)
    if l > maxInt32 {
        panic("readLen: invalid length")
    }
    return b[4:], int(l)
}

func Decode(b []byte) []string {
    b, ls := readLen(b)
    s := make([]string, ls)
    for i := range s {
        b, ls = readLen(b)
        s[i] = string(b[:ls])
        b = b[ls:]
    }
    return s
}

func Encode(s []string) []byte {
    var b []byte
    b = writeLen(b, len(s))
    for _, ss := range s {
        b = writeLen(b, len(ss))
        b = append(b, ss...)
    }
    return b
}

func codecEqual(s []string) bool {
    return fmt.Sprint(s) == fmt.Sprint(Decode(Encode(s)))
}

func main() {
    var s []string
    fmt.Println("equal", codecEqual(s))
    s = []string{"", "a", "bc"}
    e := Encode(s)
    d := Decode(e)
    fmt.Println("s", len(s), s)
    fmt.Println("e", len(e), e)
    fmt.Println("d", len(d), d)
    fmt.Println("equal", codecEqual(s))
} 
```

输出：

```
equal true
s 3 [ a bc]
e 19 [0 0 0 3 0 0 0 0 0 0 0 1 97 0 0 0 2 98 99]
d 3 [ a bc]
equal true 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-26T21:21:42.157

我建议使用[PutUvarint](http://golang.org/pkg/encoding/binary/#PutUvarint)和 [Uvarint](http://golang.org/pkg/encoding/binary/#Uvarint)来存储/检索`len(s)`并使用`[]byte(str)`传递`str`给一些`io.Writer`. 使用已知的字符串长度`Uvarint`，可以`buf := make([]byte, n)`将 传递`buf`给 some `io.Reader`。

在整个内容前面加上字符串数组的长度，并对其所有项目重复上述操作。读回整个内容是再次首先阅读外部长度并重复 n 次阅读的项目。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-14T20:34:09.893

转换`[]string`为`[]byte`

```
var str = []string{"str1","str2"}
var x = []byte{}

for i:=0; i<len(str); i++{
    b := []byte(str[i])
    for j:=0; j<len(b); j++{
        x = append(x,b[j])
    }
} 
```

转换`[]byte`为`string`

```
str := ""
var x = []byte{'c','a','t'}
for i := 0; i < len(x); i++ {
    str += string(x[i])
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-02-10T05:35:20.530

使用字符串包可以轻松完成。首先，您需要将字符串切片转换为字符串。

```
func Join(elems []string, sep string) string 
```

您需要传递字符串切片和分隔字符串中的元素所需的分隔符。（例如：空格或逗号）

然后您可以通过类型转换轻松地将字符串转换为字节切片。

```
package main

import (
    "fmt"
    "strings"
)

    func main() {
    //Slice of Strings
    sliceStr := []string{"a","b","c","d"}
    fmt.Println(sliceStr) //prints [a b c d]

    //Converting slice of String to String
    str := strings.Join(sliceStr,"")
    fmt.Println(str)  // prints abcd

    //Converting String to slice of Bytes
    sliceByte := []byte(str) //prints [97 98 99 100]
    fmt.Println(sliceByte)

    //Converting slice of bytes a String
    str2 := string(sliceByte)
    fmt.Println(str2) // prints abcd

    //Converting string to a slice of Strings
    sliceStr2 := strings.Split(str2,"")
    fmt.Println(sliceStr2) //prints [a b c d]
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-29T20:01:10.053

你可以这样做：

```
var lines = []string
var ctx = []byte{}
for _, s := range lines {
    ctx = append(ctx, []byte(s)...)
} 
```

# python - 索引 Python 中的类似条目

> ID：13573270
> 
> 赞同：0
> 
> 时间：2012-11-26T21:14:52.850
> 
> 标签：python, parsing

[我有一列数据（由于gspread](http://burnash.github.com/gspread/userguide.html#getting-the-entire-row-or-column)很容易从 Google Docs 导入），我想智能地对齐。我将条目提取到字典中。输入可以包括电子邮件、推特句柄或博客 URL。例如：

`mike.j@gmail.com
@mikej45
j.mike@world.eu
_http://tumblr.com/mikej45`

现在，“哑”版本是：

```
def NomineeCount(spreadsheet):
    worksheet = spreadsheet.sheet1
    nominees = worksheet.col_values(6) # F = 6
    unique_nominees = {}
    for c in nominees:
        pattern = re.compile(r'\s+')
        c = re.sub(pattern, '', c)
        if unique_nominees.has_key(c) == True: # If we already have the name
            unique_nominees[c] += 1
        else:
            unique_nominees[c] = 1

        # Print out the alphabetical list of nominees with leading vote count
        for w in sorted(unique_nominees.keys()):
        print string.rjust(str(unique_nominees[w]), 2)+ "  " + w

        return nominees 
```

在 if 过程中添加一些智能的有效（-ish）方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:25:42.390

您可以尝试使用 defaultdict：

```
from collections import defaultdict
unique_nominees = defaultdict(lambda: 0)
unique_nominees[c] += 1 
```

# php - 在php中获取jpg图像的iptc元数据

> ID：13573272
> 
> 赞同：5
> 
> 时间：2012-11-26T21:14:59.137
> 
> 标签：php, metadata, iptc

我正在尝试使用 php 从 jpg 图像（http://pepeliana.com/images/DSC4008.jpg）中获取一些 iptc 元数据。引用图像的标题元数据设置为“测试”。我已经阅读了 php 手册以及似乎可以完成这项工作的两个函数 - iptcparse() 和 exif_read_data()。这两个功能都在 php.ini 中启用。但是对于我的生活，我无法弄清楚为什么这两个函数都没有返回所需的数据。这是我尝试过的示例代码，我还应该提到，我还在几个具有 Title iptc 元数据的图像上尝试了此代码（因此排除了图像损坏或元数据设置不正确的可能性）：

```
<?php 
$size = getimagesize ('DSC4008.jpg', $info);       
 if(is_array($info)) {   
    $iptc = iptcparse($info["APP13"]);
    foreach (array_keys($iptc) as $s) {             
        $c = count ($iptc[$s]);
        for ($i=0; $i <$c; $i++)
        {
            echo $s.' = '.$iptc[$s][$i].'<br>';
        }
    }                 
}
 ?> 
```

还：

```
<?php
$exif = exif_read_data('DSC4008.jpg', 0, true);
echo $exif['WINXP']['Title'];
?> 
```

如您所见，这很简单，但是，我无法返回我想要的东西。显然，我一定错过了一些明显简单的东西，不是吗？请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:43:53.400

您已将图像的 ImageDescription 设置为“测试”，
这将起作用：

```
$exif = exif_read_data('1.jpg','IFD0',true);
echo $exif["IFD0"]["ImageDescription"]; 
```

回声

```
Testing 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-09-06T12:37:27.003

我有类似的问题并为此创建了自己的[库](https://ibudasov.github.io/php7-iptc-manager/)

首先——你需要用[Composer安装它](https://getcomposer.org)

```
composer require ibudasov/php7-iptc-manager 
```

然后

```
// import the Manager class
use iBudasov\Iptc\Manager;

// ... and instantiate it!
$manager = Manager::create();

$manager->loadFile('./DSC4008.jpg');

$title = $manager->getTag(Tag::OBJECT_NAME); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-06-19T13:04:25.800

尝试这个：

```
$size = getimagesize( 'DSC4008.jpg', $iptch );

$iptc = isset( $iptch['APP13'] ) ? iptcparse( $iptch['APP13'] ) : false;
$name = isset( $iptc['2#005'] ) ? $iptc['2#005'][0] : 'Undefined'; 
```

# java - 广度优先搜索并打印出 Kevin Bacon 路径，重新访问访问过的节点？

> ID：13573274
> 
> 赞同：0
> 
> 时间：2012-11-26T21:15:07.467
> 
> 标签：java, shortest-path, breadth-first-search

我在尝试查找 Kevin Bacon 号码的程序中实施广度优先搜索时遇到了一些麻烦。我创建了一个临时哈希集来存储访问过的节点，但是尽管我从反馈到队列中的列表中删除了节点，但程序仍在重新访问节点。

演员和电影的信息存储在 HashMap(String, HashSet(String)) 中 - 所以如果你把演员作为键，你会得到他们演过的电影，如果你把电影作为键，你会得到在其中表演过的演员。下面附上我的代码和 System.out.prints 打印的内容。谢谢您的帮助！

```
public List<String> findBaconPath (String actor) throws IllegalArgumentException {
    ArrayList<String> list = new ArrayList<String>();
    HashSet<String> visited = new HashSet<String>();
    visited.add(actor);
    LinkedList<String> bfs = new LinkedList<String>();
    bfs.add(actor);
    while (!bfs.isEmpty()){
        String curr = bfs.remove(); //The current actor we are looking at.
        visited.add(curr);
        HashSet<String> mov = myMovies.get(curr);
        Iterator<String> it = mov.iterator();
        while (it.hasNext()){
            String next = it.next(); //The next movie in the iterator.
            visited.add(next);
            HashSet<String> coStars = myMovies.get(next);
            coStars.removeAll(visited);
            if (coStars.contains("Bacon, Kevin")){
                list.add(curr);
                list.add(next);
                list.add("Bacon, Kevin");
                System.out.println(list.toString());
                return list;
            }
            else {
                list.add(curr);
                list.add(next);
                System.out.println("This is what is in visited: "+visited.toString());
                System.out.println("This is what is in coStars pre removal. "+ coStars.toString());
                coStars.removeAll(visited);
                System.out.println("This is what is in coStars post removal. "+ coStars.toString());
                Iterator<String> cos = coStars.iterator();
                while (cos.hasNext()){
                    bfs.add(cos.next());
                }
            }
        }

    }
    return list;
} 
```

*   这是访问的内容：[D，电影 7]
*   这就是 coStars 预移除的内容。[D、A、B、C]
*   这就是 coStars 删除后的内容。[A、B、C]
*   这是访问的内容：[D，电影 7，电影 2]
*   这就是 coStars 预移除的内容。[D、E、A、B]
*   这就是 coStars 删除后的内容。[E、A、B]
*   这是访问的内容：[D，A，电影 7，电影 2]
*   这就是 coStars 预移除的内容。[A、B、C]
*   这就是 coStars 删除后的内容。[乙，丙]
*   这是访问的内容：[D，A，电影 7，电影 2]
*   这就是 coStars 预移除的内容。[E、A、B]
*   这就是 coStars 删除后的内容。[E, B]
*   这是访问的内容：[D，A，电影 7，电影 2，电影 1]
*   这就是 coStars 预移除的内容。[A、B、C]
*   这就是 coStars 删除后的内容。[乙，丙]
*   [D，电影 7，D，电影 2，A，电影 7，A，电影 2，A，电影 1，A，电影 0，培根，凯文]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:30:48.550

如果您更好地区分访问列表中的电影和演员而不是混合它们，这可能会有所帮助。就像是：

```
[(Movie1, Actor1, Actor2), (Movie2, Actor1, Actor2, Actor3)] 
```

然后，当您执行 removeAll 时，您始终可以按电影标题识别“已访问”中的条目。

此外，每个循环都会调用 removeAll 两次。在 'if (coStars.contains("Bacon, Kevin")){' 之前一次，在您打印 'post删除' 之前再一次。

顺便说一句，这是答案吗？电影 7、电影 2、电影 1、电影 0

# symfony - Symfony2 上 @PreAuthorize 和 @Secure 之间的区别？

> ID：13573280
> 
> 赞同：2
> 
> 时间：2012-11-26T21:15:27.140
> 
> 标签：symfony

使用捆绑包 [JMSSecurityExtraBundle](http://jmsyst.com/bundles/JMSSecurityExtraBundle/master/annotations#secure)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T21:24:50.703

**[@PreAuthorize](https://github.com/schmittjoh/JMSSecurityExtraBundle/blob/master/Annotation/PreAuthorize.php) ,**

它允许您添加自己的表达方法，

```
@PreAuthorize("myMethod('class', 'perm')") 
```

例如，当使用 ACL 权限时，您可以添加类似的内容，

```
@PreAuthorize("isGranted('myObject', 'CREATE')") 
```

**[@安全](https://github.com/schmittjoh/JMSSecurityExtraBundle/blob/master/Annotation/Secure.php)，**

它只允许您定义允许谁调用基于用户角色的方法。

```
@Secure(roles="ROLE_XXXX") 
```

# java - 程序运行时如何播放背景音乐？在java中

> ID：13573281
> 
> 赞同：1
> 
> 时间：2012-11-26T21:15:38.417
> 
> 标签：java, audio, package

我正在做一个纸牌游戏，它几乎完成了。我想做的最后一件事是播放一些背景音乐。现在如果我将文件复制到默认包中并制作一个游戏的jar文件，音乐会在所有计算机上播放吗？目前，在我的电脑上，它通过为文件提供特定路径（如`"C:\\samp.wav";`. 但我担心如果我制作一个 jar 文件并在另一台 PC 上运行它，它将无法正常工作。我想会有一个`FileNotFoundException`。我是对还是错？

对于卡片的图像，我正在使用这一行：

```
jLabel1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/1.jpg"))); 
```

我已经插入到我的默认包中的那些图片。我想对音乐文件做同样的事情，但是怎么做呢？我正在使用 NetBeans。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:21:44.513

您应该在应用程序 jar 中包含 wav 文件。这样您就不必管理用户文件系统中的文件副本（请记住，例如，在 UNIX、Mac 等中，您无法通过 访问硬盘驱动器`C:/...`）。

例如，如果您将 wav 文件放在 app jar ( `app.jar/samp.wav`) 的根目录中：

```
InputStream is = getClass().getClassLoader().getResourceAsStream("samp.wav"); 
```

或者，如果您在应用程序 jar 根目录 ( `app.jar/sounds/samp.wav`) 中有一个“声音”目录：

```
InputStream is = getClass().getClassLoader().getResourceAsStream("sounds/samp.wav"); 
```

查看[这篇文章](https://stackoverflow.com/questions/2416935/how-to-play-wav-files-with-java)以获取有关使用 Java 播放 wav 文件的更多信息（尽管对于您的问题，我认为您已经解决了这个问题）。考虑在单独的线程中播放它。另请查看此网站以获取有关在 Java 中管理媒体文件[的示例。](http://www.jsresources.org/examples/audio_playing_recording.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T04:47:35.593

```
import javax.swing.*;
import sun.audio.*;
import java.awt.event.*;
import java.io.*;
public class Sound {
public static void main(String[] args)
{
JFrame frame = new JFrame();
frame.setSize(200,200);
JButton button = new JButton("Click me");
frame.add(button);
button.addActionListener(new AL());
frame.setVisible(true);
}
public static class AL implements ActionListener{
public final void actionPerformed(ActionEvent e){
music();
}
}
public static void music(){
AudioPlayer MGP = AudioPlayer.player;
AudioStream BGM;
AudioData MD;
ContinuousAudioDataStream loop = null;
try{
BGM = new AudioStream(new FileInputStream("C:\\test\\ha.wav"));
MD = BGM.getData();
loop = new ContinuousAudioDataStream(MD);
}catch(IOException error){
System.out.print("file not found");
}
MGP.start(loop);
}
} 
```

# domain-driven-design - 域服务中的容错和状态管理

> ID：13573286
> 
> 赞同：2
> 
> 时间：2012-11-26T21:15:57.153
> 
> 标签：domain-driven-design

在我的领域中，服务用于协调涉及多个聚合和/或其他服务的更高级别的行为。以订单管理系统为例，在取消订单时需要执行以下步骤：

1.  将订单状态更改为“已取消”
2.  撤销任何待处理的信用卡交易
3.  添加包含订单取消原因说明的审核条目
4.  将订单更改持久保存到数据存储
5.  引发 OrderCanceledEvent（作为消息）

对此进行编码非常简单，除了我必须实现一些额外的问题：

*   如果订单未处于“可取消”状态，我将无法执行任何操作
*   如果当前用户无权取消订单，我将无法执行任何操作
*   如果我无法撤销信用卡交易，那么整个操作将失败，订单应保持其原始状态
*   未能添加审计条目不会中止操作
*   未能坚持订单应中止操作，订单应保持其原始状态

仅当步骤 1、2 和 4 成功时，操作才会成功。因此，我无法将这些步骤实现为事件处理程序。

抛开使用中的持久性机制的任何问题（它就是这样），你能帮助我了解如何最好地实现我的服务，以便它正确处理验证、错误和管理订单的状态吗？

（我应该注意我没有使用事件溯源，所以不要让 OrderCanceledEvent 丢给你。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:53:38.260

使用事件处理程序解决此问题的一种方法是使用[saga](http://kellabyte.com/2012/05/30/clarifying-the-saga-pattern/)。工作流程如下：

*   收到`CancelOrder`命令后，`OrderCancellationSaga`启动a，将订单置于`Cancelling`状态。
*   从支付网关确认退款后，传奇完成，订单进入取消状态并保持不变。此时，在同一事务中，`OrderCancelled`会引发事件。
*   如果与支付网关的交互失败或被拒绝，则可以将订单恢复到先前的状态或置于某种错误状态。

在这种情况下，审计可以在任何阶段进行。此外，在开始 saga 之前或作为开始 saga 的第一步，应首先验证权限以及是否可以取消订单。

带有 C# 和[NServiceBus](http://nservicebus.com/)传奇的粗略示例：

```
class OrderOrderCancellationSaga : Saga<OrderCancellationSagaData>
  ,IAmStartedBy<CancelOrderCommand>,
  ,IHandle<PaymentGatewayInteractionFailedEvent> 
{

  public OrderService OrderService { get; set; }
  public PaymentGateway PaymentGateway { get; set; }

 // correlate saga messages by order ID  
 public override void ConfigureHowToFindSaga()
 {
      ConfigureMapping<PaymentGatewayInteractionFailedEvent>(x => x.OrderId, x =>x.OrderId);
      ConfigureMapping<RefundCompletedEvent>(x => x.OrderId, x => x.OrderId);
 }

  // start cancellation process
  public void Handle(CancelOrderCommand message) 
  {
     // check if cancellation is authorized and valid
     // ....

     // can save prior state here, if needed

     this.Data.OrderId = message.OrderId;
     this.Data.State = "Cancelling";    

     this.Bus.Send(new RefundOrderCommand(...));
  }

  public void Handle(RefundCompletedEvent message)
  { 
     this.Data.State = "Cancelled"; 
     this.OrderService.CompleteCancellation(...);                 
     MarkAsComplete();
  }

  // this handler can be hosted on a different endpoint.
  public void Handle(RefundOrderCommand message)
  { 
     try
     {
        this.PaymentGateway.Refund(...
     }
     catch(Exception ex)
     {
        this.Bus.Reply(new PaymentGatewayInteractionFailedEventmessage(...));
     }
  }

  // this handler can be used to revert whole operation.
  public void Handle(PaymentGatewayInteractionFailedEvent message)
  {
     // or revert to prior state.
     this.Data.Status = "Cancellation Failed";

     // call any application services needed.

     // finishes saga, deleting state
     MarkAsComplete();
  }

} 
```

# d - 如何在没有 D 运行时编译 D 应用程序？

> ID：13573289
> 
> 赞同：7
> 
> 时间：2012-11-26T21:16:08.323
> 
> 标签：d, dmd, druntime

我一直试图永远解决这个问题，它开始让我烦恼。我了解 D 运行时库。它是什么，它做什么。我也明白你可以在没有它的情况下编译一个 D 应用程序。就像 XoMB 所做的那样。好吧，XoMB 定义了它自己的运行时，但在某些情况下，如果你不需要它，你就不需要编写自己的运行时。我知道我正在使用的 DigitalMars D 编译器 (dmd) 在运行时在幕后做了很多事情，比如根据程序所需的内容发出对某些事情的引用。而且，每个程序的东西。所以你必须自己定义这些。我决定尝试一下，试着自己弄清楚，然后走得很远。我的意思是让链接器吐出越来越少的错误。对于测试，我只想编译一个完整的准系统应用程序，只是为了让事情在没有运行时的情况下工作。或者尽可能少的运行时间。这是我的单一源文件。

```
module main;

void _main()
{
    int a = 2 + 3;
} 
```

我编译： dmd -c main.d -defaultlib=

然后链接：link main.obj

这是我得到的错误： OPTLINK : 警告 23: No Stack & OPTLINK: Warning 134: No Start Address

您可以看到我尝试将chainng main 连接到_main 以摆脱无起始地址错误，但无论如何，没有帮助。我需要做什么来消除这最后两个错误？如果我能让它工作，我想我可以查看我需要实现什么来让更多功能工作。但是，如果有人愿意帮助我解决这个问题，那将不胜感激！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-26T21:31:36.287

```
module main;
extern(C) __gshared void* _Dmodule_ref;
extern(C) int main() {
    int a = 2 + 3;
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T22:19:46.937

```
ldc -nodefaultlib -noruntime 
```

我已经成功了。但是您仍然需要添加：

```
extern(C) __gshared void* _Dmodule_ref;
extern(C) int main() {} 
```

请注意，虽然运行时是可选的，但许多功能都需要它。您将缺少数组切片、（动态数组？）、GC 和许多其他方法。如果您不小心使用了其中一项功能，您将收到大量关于它如何找不到一些晦涩的符号名称的警告。

# javascript - 将 js 注入头部（在脚本中包含完整代码）

> ID：13573290
> 
> 赞同：5
> 
> 时间：2012-11-26T21:16:10.730
> 
> 标签：javascript, html, web, header

我想将脚本添加到站点的头部，以便目标 html 的头部看起来像这样`<head><script type="text/javascript">*some code...*</script></head>`。

* * *

使用此脚本可以完美运行：

```
var head = document.getElementsByTagName('head')[0],
    script = document.createElement('script');

script.src = 'http://www.example.com/example.js';    
head.appendChild(script); 
```

* * *

但我不想在源代码中使用任何链接。

所以我试图添加一些这样的代码：

```
 function addJS(jsCode) {
    var styleElement = document.createElement('script');

    styleElement.type = 'text/javascript';

       (scriptElement.javascript) {
        scriptElement.javascript.jsText = jsCode
        scriptElement.appendChild(document.createTextNode(jsCode))

    document.getElementsByTagName('head')[0].appendChild(scriptElement);
}

var jsCode = '';
jsCode += 'code';
jsCode += 'some more code'; 
```

* * *

但我失败了。该脚本不起作用。

如何在这样的任何 html 网站的头部添加一个元素？如果有人可以帮助我，那就太好了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-26T21:32:03.713

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:36:16.047

使用 jQuery

```
 var head = document.getElementsByTagName('head')[0],
        script = document.createElement('script');

    $(script).attr('type' , 'text/javascript');    
    head.appendChild(script);
    $(script).append("alert('Hello')"); 
```

# javascript - twitter Bootstrap 中是否有用于开发条形图的 API

> ID：13573292
> 
> 赞同：11
> 
> 时间：2012-11-26T21:16:21.707
> 
> 标签：javascript, twitter-bootstrap

我搜索了几个网站，但找不到任何显示如何使用 Twitter Bootstrap 框架创建图表的 API 示例。

任何人都可以建议在 Twitter Bootstrap 中使用正确的 API 来开发条形图吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-26T21:20:21.767

Twitter Bootstrap 不提供图表功能，但您可以使用许多其他图表库。

首先，我建议使用[Highcharts](http://highcharts.com) - 它非常灵活，提供多种图表类型，并且维护/支持得很好（如果您需要的话）。

其他可用的图表库：

*   [jqplot](http://www.jqplot.com)
*   [EXTJS](http://www.sencha.com/products/extjs/)
*   [谷歌图表](https://developers.google.com/chart/)

# git - 为什么 git pre-receive 钩子可以显示最近的文件更改但不能区分它？

> ID：13573293
> 
> 赞同：2
> 
> 时间：2012-11-26T21:16:30.417
> 
> 标签：git, diff

在尝试编写一个拒绝对某些类型的文件进行某些类型的更改的预接收挂钩时，我很难理解为什么在该脚本中以下内容是合法的：

```
git show <new_commit>:<file> 
```

如本[示例](https://stackoverflow.com/a/2570098/317110)中使用的那样（在使用带有 --name-only 的 diff 梳理出受影响的文件之后），但不是

```
git diff <old_commit> <new_commit> -- <file> 
```

我更喜欢后者，这样我只拒绝引入的更改而不是文件中已经存在的模式，但是当从这个脚本执行时，它会生成错误：“未知的修订或路径不在工作树中”。

我怀疑这与[事件的顺序有关](https://stackoverflow.com/a/3618036/317110)，因为两者都在我的裸仓库的命令行中工作，但想了解区别。

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2012-11-30T15:48:14.180

正如[您链接的答案所](https://stackoverflow.com/a/3618036/317110)指出的那样，当`pre-receive`执行钩子时，还没有收到任何文件，只有哪些 refs 应该被更新（关于这个和其他钩子的详细信息可以在[githooks(5) 手册页](http://www.kernel.org/pub/software/scm/git/docs/githooks.html)上找到）。

由于没有可以与旧数据进行比较的数据，因此无法创建差异。

# c# - GetPrivateProfileString 没有修剪？

> ID：13573296
> 
> 赞同：2
> 
> 时间：2012-11-26T21:16:37.750
> 
> 标签：c#, string, dllimport, ini

由于这个应用程序已经发展了多年，仍然有一些 INI 文件。我有一个使用 GetPrivateProfileString 读取条目的类。

在类的顶部，我们看到：

```
 [DllImport("kernel32")]
    private static extern int GetPrivateProfileString(string section,
        string key, string def, StringBuilder retVal,
        int size, string filePath); 
```

看起来有一个公共方法看起来像这样：

```
 public string IniReadValue(string Section, string Key)
    {
        // If string greater than 254 characters (255th spot is null-terminator),
        // string will be truncated.
        const int capacity = 255;
        StringBuilder temp = new StringBuilder(capacity);
        int i = GetPrivateProfileString(Section, Key, "", temp,
                                        capacity, this.m_Path);
        return temp.ToString();
    } 
```

我最近注意到 GetPrivateProfileString 修剪它的数据。因此，如果我的 INI 文件有这样的条目：

SomeData= 注意这句话前后的三个空格。

它会像这样检索它（注意它被修剪到左右 - 忽略引号）：

“注意这句话前后的三个空格。”

我不希望它修剪。这是我无法控制的吗？INI 文件不能在等号后有空格（例如 SomeData=）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:42:55.663

正如评论中所指出的，这就是 API 的工作方式。如果你能忍受，你至少可以通过使用这个库/包装器（包括源代码，只有一个文件）来保存一些 DllImport 工作：

[阅读器](http://www.mentalis.org/soft/class.qpx?id=6)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T09:47:05.553

您可以使用引号来表达您的内容，当将内容读入字符串时，您可以轻松解析出您想要的内容。像这样：key =“内容”

您可以在函数 IniReadValue 中添加一些代码。

或者您可以使用 base64 字符串放置/获取消息，如下所示： some-key = your-content-in-base64-string 并且许多字符问题不会是您的问题。但是这种方式不利于阅读。

# internet-explorer - 有没有办法在 IE 开发者工具中测试 CSS :hover ？

> ID：13573302
> 
> 赞同：39
> 
> 时间：2012-11-26T21:17:00.463
> 
> 标签：internet-explorer, ie-developer-tools, mousehover

在 Chromes 开发工具中，您可以选择一个元素并启用悬停状态。有没有办法可以在 Internet Explorer 开发工具中完成？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-08-01T21:05:30.610

当你问这个问题时，我不确定你使用的是什么版本的 IE。

仅供大家参考，我可以使用**IE 9**中的以下步骤序列通过 HTML 选项卡查看悬停样式：

1.  打开开发者工具
2.  将鼠标悬停在您想要查看其悬停 CSS 的元素上，*同时让开发人员窗口保持焦点*。
3.  当您的鼠标仍在元素上方时按 F5
4.  Ctrl + B 并单击元素

您现在可以查看**悬停 CSS**。

编辑（2015 年 1 月）：

在**IE 11**中，单击出现在 DOM Explorer 样式窗格右上角的蓝色大“a:”图标，然后选中“悬停”复选框。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-07-11T06:35:34.673

在 IE11 中，单击出现在 DOM Explorer 样式窗格右上角的蓝色大“a:”图标，然后选中“悬停”复选框。 ![Internet Explorer 11 F12 开发人员工具的屏幕截图，其中：突出显示](../Images/cbf9021f161156cb0814c424ec6cd0b0.png)

如果看不到“a:”，请先在 DOM Explorer 的左侧窗格中选择一个元素或 HTML 标记。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T11:49:47.340

我在 IE 开发人员工具中也找不到 CSS :hover 状态。所以我最终从一个书签中使用了 Firebug Lite。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-18T09:26:00.630

老雷的建议奏效了。当您打开开发人员工具时，请确保它处于焦点状态，以便它可以接收快捷命令 - 当您单击页面的滚动条或页面时，它会聚焦浏览器窗口并将所有快捷命令发送到页面. 为避免错误，请执行以下操作：

1.  找到你需要的元素
2.  打开开发者工具
3.  聚焦开发者工具的窗口
4.  悬停你想要的元素
5.  按 F5 不移动鼠标
6.  Ctrl+B 并单击元素

此致。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-10-24T06:18:23.470

对于那些在 Google 上找到它的人，我创建了一个跨浏览器工具，让您只需移动鼠标即可可视化 HTML/CSS 布局。您可以轻松查看处于悬停状态的元素。

[HTML 框可视化工具 - GitHub](https://github.com/ghmcadams/boxvis)

# iphone - UIImagePickerController 用于多个按钮

> ID：13573306
> 
> 赞同：3
> 
> 时间：2012-11-26T21:17:12.533
> 
> 标签：iphone, objective-c, xcode, ios-simulator

我有 4 个 UIButtons 和 4 个 UIImgeViews，每个按钮都应该使用 UIImagePickerController 更改其 UIImageView 的图像。按钮 #1 应该改变 imageview #1 等等。一切都应该不同。仅使用第一个按钮和 imageview 即可正常工作，但我不确定如何将其应用于所有 4 个按钮。

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{

UIImage *image1 = [info objectForKey:UIImagePickerControllerOriginalImage];

NSData *data = UIImagePNGRepresentation(image1);
NSString *myGrabbedImage = @"myGrabbedImage.png";
NSArray *path = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentDirectory = [path objectAtIndex:0];
NSString *fullPathToFile = [documentDirectory stringByAppendingPathComponent:myGrabbedImage];

[data writeToFile:fullPathToFile atomically:YES];
[[self firstImageView]setImage:image1];

[self dismissViewControllerAnimated:YES completion:nil];

} 
```

我知道这只会将图片设置为第一个 imageView 但我怎样才能为所有 4 做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:58:16.990

按下按钮的代码可以留下一个值来说明正在处理哪个按钮：

```
- (void) buttonPressed:(id)sender {
      imageViewBeingEdited = sender.imageView;
      // display image picker here
} 
```

然后

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info {
    imageViewBeingEdited.image = [info objectForKey:UIImagePickerControllerOriginalImage];
    ...
} 
```

# redis - 在 Redis 中存储定时列表

> ID：13573310
> 
> 赞同：1
> 
> 时间：2012-11-26T21:17:44.133
> 
> 标签：redis

我有一堆需要存储在 Redis 列表中的 ID。这是直截了当的。ID 只是无符号整数。几个小时后，我需要一个 ID 才能在列表中过期。目前我没有看到这样做的方法，因为您只能在整个键上设置到期时间，而不是列表中的元素。

使用 Redis 有哪些解决方案/解决方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T03:04:20.050

ID 是唯一的吗？如果是这样，那么您可以使用 a[`SORTED SET`](http://redis.io/topics/data-types)而不是 a `LIST`（在这种情况下无论如何都会更好，无论我要描述的黑客如何）。

然后，使用 Unix 时间作为每个项目的*分数*。这些项目仍然不会自动删除，但是您可以运行一些不时删除旧项目的工作程序（用于[`ZRANGEBYSCORE`](http://redis.io/commands/zrangebyscore)对某些范围进行排序），无论如何，在您的客户端代码中，您可以检查您提取的项目的分数并验证它没有（逻辑上）过期。

# html - 动画填充模式不起作用

> ID：13573312
> 
> 赞同：8
> 
> 时间：2012-11-26T21:17:48.357
> 
> 标签：html, css, css-animations

我试图让一个标题飞入，然后当你悬停它时，它应该会摇晃（都带有 css3 动画）。它以我想要的方式飞行，也会震动，但是在我将鼠标从元素中移除后，即使我设置了 `-animation-fill-mode: forwards ; 当我查看 chromedevtools 时，该元素永远不会改变它的边距（即使动画有效..）。我可以解决这个问题吗？

另外，有没有办法防止第一个动画在摇动动画之后再次发生？

飞行动画：

```
#name {
margin:40px 2% 40px 0;

-webkit-animation:flyin 1.5s;
-webkit-animation-fill-mode: forwards;
-webkit-animation-timing-function: ease-in-out;
-webkit-animation-delay: 1800ms;
}

@-webkit-keyframes flyin {

from{margin-right: 2%;}
30% {margin-right: 12%;}
50% {margin-right: 9%;}
60% {margin-right: 10%;}
to {margin-right: 10%;}
} 
```

摇动动画：

```
#name:hover {
        **margin-right: 10%; //i also have to set this?! or it starts at 2%**
        -webkit-animation:shake 0.7s;
        -webkit-animation-fill-mode: forwards;
        -webkit-transform-origin:50% 50%; 
        -webkit-animation-iteration-count: infinite; 
        -webkit-animation-timing-function: linear;

    }

    @-webkit-keyframes shake { 
0% { -webkit-transform: translate(2px, 1px) rotate(0deg); } 
10% { -webkit-transform: translate(-1px, -2px) rotate(-1deg); } 
20% { -webkit-transform: translate(-3px, 0px) rotate(1deg); } 
30% { -webkit-transform: translate(0px, 2px) rotate(0deg); } 
40% { -webkit-transform: translate(1px, -1px) rotate(1deg); } 
50% { -webkit-transform: translate(-1px, 2px) rotate(-1deg); } 
60% { -webkit-transform: translate(-3px, 1px) rotate(0deg); } 
70% { -webkit-transform: translate(2px, 1px) rotate(-1deg); } 
80% { -webkit-transform: translate(-1px, -1px) rotate(1deg); } 
90% { -webkit-transform: translate(2px, 2px) rotate(0deg); } 
100% { -webkit-transform: translate(2px, 1px) rotate(0deg); } 
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-26T22:05:44.307

设置`animation-fill-mode: forwards`意味着动画完成执行后，动画将保持最终属性，直到被移除。当鼠标停止悬停时，该`-webkit-animation`属性返回到它的默认值（空白），这意味着`shake`动画被移除，一切都恢复到原来的样子。要使动画保持其最终属性，您必须将`shake`动画应用于元素。（换句话说，`animation-fill-mode`只有在应用动画时才有效。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-11-19T16:59:24.833

要让动画在鼠标离开元素时保持在其状态，您需要将所有动画属性添加到处于**正常状态**的元素，**而不是** `:hover`，加上：

`animation-play-state: paused`

仅`:hover`添加时：

`animation-play-state: running`

# node.js - 在 node.js 服务器上使用 supertest/superagent 读取响应输出缓冲区/流

> ID：13573315
> 
> 赞同：21
> 
> 时间：2012-11-26T21:18:00.193
> 
> 标签：node.js, zip, mocha.js, superagent, supertest

我正在尝试编写一个测试来检查 API 路由是否输出具有正确内容的 ZIP 文件。

我正在使用 mocha 和 supertest 进行测试，我想实际读取输出流/缓冲区，读取 zip 文件内容并查看内容是否正确。

有什么想法我应该怎么做？当我尝试阅读`res.body`时，它只是一个空对象。

```
 request(app)
    .get( "/api/v1/orders/download?id[]=1&id=2" )
    .set( "Authorization", authData )
    .expect( 200 )
    .expect( 'Content-Type', /application\/zip/ )
    .end( function (err, res) {
      if (err) return done( err );

      console.log( 'body:', res.body )

      // Write the temp HTML file to filesystem using utf-8 encoding
      var zip = new AdmZip( res.body );
      var zipEntries = zip.getEntries();

      console.log( 'zipentries:', zipEntries );

      zipEntries.forEach(function(zipEntry) {
        console.log(zipEntry.toString()); // outputs zip entries information
      });

      done();
    }); 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-10T20:48:37.543

扩展@Beau 的答案，以下内容可用于将任何二进制响应内容作为缓冲区获取，您可以在以下位置进一步检查`request.end()`：

```
function binaryParser(res, callback) {
    res.setEncoding('binary');
    res.data = '';
    res.on('data', function (chunk) {
        res.data += chunk;
    });
    res.on('end', function () {
        callback(null, new Buffer(res.data, 'binary'));
    });
}

// example mocha test
it('my test', function(done) {
    request(app)
        .get('/path/to/image.png')
        .expect(200)
        .expect('Content-Type', 'image.png')
        .buffer()
        .parse(binaryParser)
        .end(function(err, res) {
            if (err) return done(err);

            // binary response data is in res.body as a buffer
            assert.ok(Buffer.isBuffer(res.body));
            console.log("res=", res.body);

            done();
        });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T20:20:38.417

我想你会想要为 application/zip 创建自己的解析器并使用它来获取实际的响应数据；例如，JSON 解析器在[这里](https://github.com/visionmedia/superagent/blob/master/lib/node/parsers/json.js)。一旦你得到它，你可以通过将它传递给 request.parse 来使用它；所以你的测试会变成：

```
request(app)
  .get( "/api/v1/orders/download?id[]=1&id=2" )
  .set( "Authorization", authData )
  .expect( 200 )
  .expect( 'Content-Type', /application\/zip/ )
  .parse( function (res, fn) {
    res.data = '';
    res.on( 'data', function (chunk) { res.data += chunk; } );
    res.on( 'end', function () {
      try {
        fn( null, new AdmZip( res.data ) );
      } catch ( err ) {
        fn( err );
      }
    });
  })
  .end( function (err, res) {
    if (err) return done( err );

    console.log( 'body:', res.body )

    // Write the temp HTML file to filesystem using utf-8 encoding
    var zipEntries = res.body.getEntries();

    console.log( 'zipentries:', zipEntries );

    zipEntries.forEach(function(zipEntry) {
      console.log(zipEntry.toString()); // outputs zip entries information
    });

    done();
  }); 
```

为了找到这个问题的答案，我主要依靠检查 superagent 测试套件。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-08-06T08:35:54.923

如在请求上使用超测试设置[测试二进制响应中](https://stackoverflow.com/questions/59576617/testing-binary-response-with-supertest)`.responseType('blob')`所述，将导致`req.body`成为缓冲区。

[https://visionmedia.github.io/superagent/#binary](https://visionmedia.github.io/superagent/#binary)

```
it('test', async () => {
  await request(app)
    .get('/api/some-zip')
    .responseType('blob')
    .expect(200)
    .expect('Content-Type', /application\/zip/)
    .expect(( res) => {
      const zipEntries = new AdmZip(res.body).getEntries().map(e => e.entryName);
      expect(zipEntries).toEqual(expect.arrayContaining(['zipfile1.pdf', 'zipfile2.pdf']));
  });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-21T10:04:59.833

我刚刚遇到了同样的情况，我需要编写一个测试来检查 zip 文件的内容。我就是这样做的。

```
 it('test', async function () {
        let data = '';
        const res = await request(app)
            .get('/api/some-zip')
            .parse((res, callback) => {
                res.setEncoding('binary');
                res.on('data', function (chunk) {
                    data += chunk;
                });
                res.on('end', function () {
                    callback(null, Buffer.from(data, 'binary'));
                });
            })
        const zip = new AdmZip(res.body)
        const zipEntries = zip.getEntries();

        expect(zipEntries[0].name).to.equal('zipfile1.pdf');
        expect(zipEntries[1].name).to.equal('zipfile2.pdf');
    }); 
```

我使用了 async/await 语法

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-14T09:35:11.883

现有的答案对我不起作用。我最终做的是：

```
// parses response.body buffer into a data object
const parsePDF = response => {
  return new Promise((resolve, reject) => {
    // code that parses response.body as buffer
    // and calls resolve(data); when done
    // or reject(err); on error
  })
};

const binaryParser = require('superagent-binary-parser');

// test snippet
request(app)
    .get('/some/api/returning/pdf')
    .expect(200)
    .expect('content-type', 'application/pdf')
    .parse(binaryParser)
    .buffer()
    .then(parsePDF)
    .then((pdf) => {
      chai.expect(pdf.pages.length).to.be.equal(5);
    }) 
```

# asp.net - 如何使用带有查询字符串的 URL 重写

> ID：13573317
> 
> 赞同：1
> 
> 时间：2012-11-26T21:18:16.783
> 
> 标签：asp.net

我正在尝试使用查询字符串创建 URL 重写，但我的问题是当我尝试使用查询字符串时 URL 重写不起作用。当我在没有查询字符串的情况下使用它时，URL 重写工作正常。我已经在网上搜索并完全按照他们所说的做了，但我仍然遇到错误。因此，让我向您展示第一个没有查询字符串的方法：

这就是我在 Global.asax 文件中的内容：

```
protected void Application_Start(object sender, EventArgs e) 
    {
        // Code that runs on application startup

      RegisterRoutes(RouteTable.Routes);

    }

    public static void RegisterRoutes(RouteCollection routeCollection)
    {
        routeCollection.MapPageRoute("RouteForCustomer", "MyTest", "~/Users/MyOldPage.aspx");
    } 
```

如果我运行上面的代码，一切正常。所以我现在尝试在 URL 中传递查询字符串，而我所做的到目前为止还不起作用：

```
protected void Application_Start(object sender, EventArgs e) 
    {
        // Code that runs on application startup

      RegisterRoutes(RouteTable.Routes);

    }

    public static void RegisterRoutes(RouteCollection routeCollection)
    {
        routeCollection.MapPageRoute("RouteForCustomer", "MyTest/{My_ID}", "~/Users/MyOldPage.aspx");
    } 
```

MyOldPage.aspx 背后的代码我有这段代码，但不确定是否有必要，但这是我在研究时在网上看到的：

```
protected void Page_Load(object sender, EventArgs e)
    {
        string myquerystring = Page.RouteData.Values["My_ID"] as string; 
```

# javascript - 如何从 Windows Azure 服务器脚本中插入的项目中获取自动生成的 ID？

> ID：13573319
> 
> 赞同：1
> 
> 时间：2012-11-26T21:18:20.973
> 
> 标签：javascript, azure, azure-storage, azure-mobile-services

我有一个表格，“计划”有几列和一个插入时自动生成的 ID 列。当我在插入服务器脚本中工作时，我怎么知道 ID？。我正在开发 Windows azure 移动服务。

```
function insert(item, user, request) {
    //I want to know the ID of the new item to be inserted.
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:39:31.040

id 仅在项目插入数据库时​​生成，并作为新属性添加到`item`参数中。您可以通过在插入操作中指定对脚本的回调来获得它：

```
function insert(item, user, request) {
    request.execute({
        success: function() {
            var id = item.id;
            console.log("The new item's id is: ", id);
            request.respond();
        }
    });
} 
```

# sql - 创建视图时使用 count on

> ID：13573322
> 
> 赞同：0
> 
> 时间：2012-11-26T21:18:38.040
> 
> 标签：sql, join, oracle11g

我认为需要包括自愿参加活动的成员人数。我收到一个错误“不是单组组功能”。知道如何解决这个问题吗？

```
CREATE VIEW atbyrd.events__view AS
SELECT e.name, e."DATE", b."LIMIT",b.allocated_amount, COUNT(em.member_id), e.comments
FROM events e INNER JOIN budgets b ON b.event_id = e.id
INNER JOIN event_members em ON em.event_id  = e.id; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:20:30.917

```
SELECT e.name, 
       e."DATE", 
       b."LIMIT",
       b.allocated_amount, 
       (select COUNT(member_id) from event_members) as mem_count, 
       e.comments
FROM events e
INNER JOIN budgets b ON b.event_id = e.id
INNER JOIN event_members em ON em.event_id  = e.id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:26:31.647

您可以使用[分析功能`count()`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions039.htm#SQLRF00624)

```
SELECT e.name
     , e."DATE"
     , b."LIMIT"
     , b.allocated_amount
     , COUNT(em.member_id) over ( partition by em.event_id )
     , e.comments
  FROM events e 
 INNER JOIN budgets b 
    ON b.event_id = e.id
 INNER JOIN event_members em 
    ON em.event_id  = e.id; 
```

简单地说，这会计算每个成员的数量，`event_id`但由于它不是聚合函数，因此不需要 GROUP BY。您每收到相同的价值`event_id`。

# php - 选择插入我的 youtube 视频的位置

> ID：13573325
> 
> 赞同：0
> 
> 时间：2012-11-26T21:18:42.127
> 
> 标签：php, javascript, jquery, html, youtube-api

我有几周前在 Stack 上找到的这段代码。

```
 <script type="text/javascript">
 $(document).ready(function() {
// I added the video size here in case you wanted to modify it more easily
var vidWidth = 300; // 425;
var vidHeight = 200; // 344;
     var obj = '<object width="' + vidWidth + '" height="' + vidHeight + '">' + '<param name="movie" value="http://www.youtube.com/v/[vid]&hl=en&fs=1">' + '</param><param name="allowFullScreen" value="true"></param><param ' + 'name="allowscriptaccess" value="always"></param><em' + 'bed src="http://www.youtube.com/v/[vid]&hl=en&fs=1" ' + 'type="application/x-shockwave-flash" allowscriptaccess="always" ' + 'allowfullscreen="true" width="' + vidWidth + '" ' + 'height="' + vidHeight + '"></embed></object> ';

$('.posthold:contains("youtube.com/watch")').each(function() {
    var that = $(this);
    var vid = that.html().match(/v=([\w\-]+)/g); // end up with v=oHg5SJYRHA0

     that.html(function(i, h) {
        return h.replace(/(http:\/\/www.youtube.com\/watch\?v=+\S+\S?)/g, '');
    });

    if (vid.length) {
        $.each(vid, function(i) {
            that.append(obj.replace(/\[vid\]/g, this.replace('v=', '')));
        });
    }
});
 });
 </script> 
```

它非常适合嵌入来自 url 的视频。但是我有一个小问题，我一直在尝试解决，但我一直在破坏代码。

基本上我有以下 div 设置

```
<div class="grid_10 alpha omega posthold" >
<div class="clearfix">
  <div class="grid_2 alpha">
    <img src="/images/no-image/logo_default.jpg" width="100" height="100" />
    </a></div>
  <div class="grid_8 omega">
    <h1>Some Name Here</h1>
    <p>Some Comment here</p>

  </div>
</div>

 </div> 
```

我试图让视频直接出现在结束段落标签之后，它在这里说一些评论。用户输入视频作为帖子的一部分。我将帖子存储在数据库中，当我将帖子拉出时，我将 url 从 youtube 交换到嵌入代码。这是一个重复的 div，因此可能有很多视频出现的实例。这甚至可能吗。视频出现在最后一个结束 div 标记之后的那一刻。

# python - 使用 google DFP API python 客户端时的奇怪问题

> ID：13573327
> 
> 赞同：1
> 
> 时间：2012-11-26T21:18:46.963
> 
> 标签：python, if-statement, try-catch

看看这段代码

```
order_service = client.GetService('OrderService', version='v201208')
creative_service = client.GetService('CreativeService', version='v201208')
with open('/tmp/urls.txt', 'w') as f:
    for i in range(0, 3929, 100):
        print 'ORDER BY ID LIMIT 100 OFFSET '+str(i)
        creatives = creative_service.getCreativesByStatement({'query':'ORDER BY ID LIMIT 100 OFFSET '+str(i)})
        try:
            for creative in creatives[0]['results']:
                try:
                    for var in creative['creativeTemplateVariableValues']:
                        if var['uniqueName'] == 'DetailsPageURL':                           
                            print var['value']
                            f.write(creative['advertiserId']+','+var['value']+"\n")
                exception:
                    pass
        except:
            raise
            pass 
```

当偏移量为 200 时的第二次迭代，将抱怨`for creative in creatives[0]['results']`结果 keyerror，但如果我将 try/except 语句更改为`if creative.has_key('creativeTemplateVariableValues'):`如下所示，则可以解决问题：

```
order_service = client.GetService('OrderService', version='v201208')
creative_service = client.GetService('CreativeService', version='v201208')
with open('/tmp/urls.txt', 'w') as f:
    for i in range(0, 3929, 100):
        print 'ORDER BY ID LIMIT 100 OFFSET '+str(i)
        creatives = creative_service.getCreativesByStatement({'query':'ORDER BY ID LIMIT 100 OFFSET '+str(i)})
        try:
            print creatives[0]['results']
        except:
            print creatives
        #creatives = creative_service.getCreativesByStatement({'query':'ORDER BY ID LIMIT 10 OFFSET 200'})
        try:
            for creative in creatives[0]['results']:
                if creative.has_key('creativeTemplateVariableValues'):
                    for var in creative['creativeTemplateVariableValues']:
                        if var['uniqueName'] == 'DetailsPageURL':
                            print var['value']
                            f.write(creative['advertiserId']+','+var['value']+"\n")
        except:
            raise
            pass 
```

为什么？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T22:36:30.280

字段“creativeTemplateVariableValues”是“TemplateCreative”类型的广告素材，因此如果您的网络上有其他不是 TemplateCreative 的广告素材，它将没有该字段并引发您所看到的关键错误。您可以像以前一样进行 has_key 检查，或者另一种方法是进行类型检查：

```
if creative['Creative_Type'] == 'ImageCreative':
  for var in creative['creativeTemplateVariableValues']:
    ... 
```

如果您只关心 TemplateCreatives，我建议您使用针对该特定广告素材类型的语句过滤器。请参阅 get_creatives_by_statement 示例 (http://code.google.com/p/google-api-ads-python/source/browse/trunk/examples/adspygoogle/dfp/v201208/get_creatives_by_statement.py)

有关 DFP API 和相关客户端库的未来问题，请发布到 DFP API 论坛：[https ://groups.google.com/forum/#!forum/google-doubleclick-for-publishers-api](https://groups.google.com/forum/#!forum/google-doubleclick-for-publishers-api)

# c++ - 错误 C2783 无法推断模板参数

> ID：13573331
> 
> 赞同：6
> 
> 时间：2012-11-26T21:19:01.307
> 
> 标签：c++, templates

我被这个错误困住了。**我也找到了一种解决方法，但这有点扼杀了锻炼的全部目的。**

我正在尝试创建一个函数，它需要两个指向同一个容器的迭代器。我会找到它们之间的元素之和。我为像vector这样的顺序容器创建了通用函数，效果很好。我为关联容器重载了相同的函数。这是给出错误的那个。

```
map<string,double> myMap;
myMap["B"]=1.0;
myMap["C"]=2.0;
myMap["S"]=3.0;
myMap["G"]=4.0;
myMap["P"]=5.0;

map<string,double>::const_iterator iter1=myMap.begin();
map<string,double>::const_iterator iter2=myMap.end();

cout<<"\nSum of map using the iterator specified range is: "<<Sum(iter1,iter2)<<"\n"; 
//Above line giving error. Intellisense is saying: Sum, Error: no instance of overloaded function "Sum" matches the argument list.

//function to calculate the sum is listed below (It appears in a header file with <map> header included):
template <typename T1,typename T2>
double Sum(const typename std::map<T1,T2>::const_iterator& input_begin,const typename std::map<T1,T2>::const_iterator& input_end)
{
double finalSum=0;
typename std::map<T1,T2>::const_iterator iter=input_begin;

for(iter; iter!=input_end; ++iter)
{
    finalSum=finalSum+ (iter)->second;
}

return finalSum;
} 
```

编译错误为：1>c:\documents and settings\ABC\my documents\visual studio 2010\projects\demo.cpp(41): error C2783: 'double Sum(const std::map::const_iterator &,const std ::map::const_iterator &)' : 无法推导出 'T1' 的模板参数

**解决方法：**

如果调用 Sum(iter1,iter2) 替换为 Sum < string,double > (iter1,iter2)，则编译正常。

我是否首先尝试按照 C++ 标准做一些不可能的事情？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-26T21:30:00.340

错误其实很明显，在下面的模板中：

```
template <typename T1,typename T2>
double Sum(const typename std::map<T1,T2>::const_iterator& input_begin,
           const typename std::map<T1,T2>::const_iterator& input_end) 
```

类型`T1`和`T2`不能从调用地点的参数推导出来。这在标准中是这样定义的，如果您考虑一下（在一般情况下），这是有道理的。

考虑一下，而不是`std::map<>::const_iterator`你有`sometemplate<T>::nested_type`，并且调用地点的论点是一个`int`. 如果编译器必须推断类型，它必须实例化宇宙`sometemplate`中所有可能的类型`T`（无限集），并找出其中嵌套类型`nested_type`是 typedef to的类型`int`。

正如有人在评论中指出的那样，您可以更改模板，以便无需在地图的键和值类型上进行模板化，而是只需使用迭代器。

* * *

**委托提取价值**

`Sum`这是提供可以同时处理顺序容器和关联容器的单一实现的解决方法。

```
namespace detail {
template <typename T> T valueOf( T const & t ) { return t; }
template <typename K, typename V>
V valueOf( std::pair<const K, V> const & p ) {
   return p.second;
}
}
template <typename Iterator>
double Sum( Iterator begin, Iterator end ) {
  double result = 0;
  for (; begin != end; ++begin) {
     result += detail::valueOf(*begin);
  }
  return result;
} 
```

我还没有测试过代码，但应该这样做。这可能比在`Sum`模板上使用 SFINAE 简单得多。

# assembly - 汇编文件中的 Eclipse CDT 宏感知

> ID：13573332
> 
> 赞同：6
> 
> 时间：2012-11-26T21:19:07.763
> 
> 标签：assembly, macros, eclipse-cdt, code-completion

目前，我正在将 Eclipse（3.5.x 和 3.7.x）与 CDT 插件一起用于几个项目，这些项目除了包含 .c 和 .h 文件之外，还包含带有 x86（或 IA64）汇编代码的 .S 文件。

问题是，在 .S 文件中使用了很多预处理器宏。这些宏通常在 .S 文件中包含的 .h 文件中定义。一个人为的例子可能是

```
#define FOO(regA, regB) \
    mov regA, %ax \
    mov %ax, regB 
```

作为 header1.h 的一部分

那么 foo.S 可能包含

```
#include "header1.h"
...
FOO(%bx, %cx)
... 
```

现在缺少的是当编辑 foo.S 以使用 F3 跳转到 header1.h 中的 FOO 定义或（显然与此相关的）查看宏扩展的预览时的可能性。

我可以从 .c（或 .h）文件中执行此操作，但不能从 .S 文件中执行此操作。有没有办法为 .S 文件启用此功能？

# ruby-on-rails - 如果我有两个 `after_create` 语句，我如何确保一个在另一个之前运行？

> ID：13573333
> 
> 赞同：0
> 
> 时间：2012-11-26T21:19:13.420
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我`after_create`在同一个模型上有两个回调，第二个取决于一个属性（比如`client.score`）不是零。在第一个中，它运行一个计算并将有问题的属性设置为某个非零值。

但似乎即使我在我的模型文件中将它们紧挨着放在一起，如下所示：

```
after_create :callback1
after_create :callback2 
```

无论何时`callback2`运行，它仍然`client.score`为零。

如何强制第二个在第一个之后运行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T21:23:29.707

你可以做这样的事情

```
def some_action
    callback1
    callback2
end

after_create :some_action 
```

但是，根据[文档](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html)，您的代码示例也应该没问题

> [回调](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html)通常按照定义的顺序运行，但定义为模型上的方法的回调除外，这些方法最后调用。

# javascript - 使输入文本字段保持焦点并且在我单击其他内容时不会丢失（焦点始终位于 id="input_message" 的输入上）？

> ID：13573338
> 
> 赞同：0
> 
> 时间：2012-11-26T21:19:31.477
> 
> 标签：javascript, html, css

我在一个文本字段（输入消息）和发送按钮上方制作了简单的网络聊天、气泡（消​​息）。当我单击其他内容时，如何使输入文本字段保持焦点而不丢失（焦点始终位于 id="input_message" 的输入上）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-26T21:25:37.970

```
var el = document.getElementById('input_message');

el.focus();

el.onblur = function () {
    setTimeout(function () {
        el.focus();
    });
}; 
```

这是小提琴：http: [//jsfiddle.net/MwaNM/](http://jsfiddle.net/MwaNM/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-26T21:51:41.580

这是一个肮脏的黑客。

```
<input type="text" id="input_message" />
<script type="text/javascript">
    with (document.getElementById('input_message')) {
        onblur = function(e) {
            var elm = e.target;
            setTimeout(function(){elm.focus()});
        }
        onkeydown = function(e) {
            var key = e.which || e.keyCode;
            if (key == 9) e.preventDefault();
            // code for tab is 9
        }
    }
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-29T13:53:52.977

```
var inputElement = document.getElementById("input_message");
    inputElement.focus();
    inputElement.addEventListener("blur", function(event){
        inputElement.focus();
    }); 
```

[http://jsfiddle.net/653w1mpv/](http://jsfiddle.net/653w1mpv/)

# xslt - 在 XSLT 中使用布尔值格式化字符串

> ID：13573340
> 
> 赞同：1
> 
> 时间：2012-11-26T21:19:43.560
> 
> 标签：xslt, boolean, comma

我有几个信息条目，我想用逗号分隔。但是，每个条目都可以为空，如果第一个出现的条目为空，则不应出现逗号。例如：

如果我们有四个 XSLT 参数：姓名、电话号码、地址、职业

我们有

*   姓名：约翰
*   电话号码：111-111-1111
*   地址：想象中的街道
*   职业：贝克

那么最终的字符串应该是：

*John, 111-111-1111, Imaginary street, Baker*

如果名称和电话号码参数为空或 null，则最终字符串应为：

*想象中的街道，贝克*

如果只有电话号码为空或为空，则最终字符串应为：

*约翰，想象中的街道，贝克*

在像 C# 这样的语言中，我会编写如下代码：

```
foreach (EntryObject entry in entryList)
{
    if (firstEntry == true && entry.Type != EntryType.Age && entry.Type != EntryType.Sex)
    {
        finalString += entry.ValueString;
        firstEntry = false;
    }
    else if (firstEntry == false && entry.Type != EntryType.Age && entry.Type != EntryType.Sex)
    { 
        finalString += ", " + entry.ValueString;
    }
}
return finalString; 
```

但是，我听说 XSLT 中的变量是不可变的。我应该如何在 XSLT 中解决这个问题？

编辑： xml 条目看起来像这样：

```
<AddressBook>
    <PersonalInfo>
        <Age>33</Age>
        <Sex>Male</Sex>
        <Name>John</Name>
        <PhoneNumber></PhoneNumber>
        <Address>Imaginary Street</Address>
        <Occupation>Baker</Occupation>
    </PersonalInfo>
</AddressBook> 
```

请注意，某些条目可能是空的，我只会使用姓名、电话号码、地址和职业。年龄和性别应该被忽略。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:31:32.227

使用仅匹配非空元素（`string-length(.)>0`或简单地`string(.)`）的 XPath 条件，然后使用该`position()`函数检查元素是否是第一个元素。输入 XML：

```
<root>
  <item>
    <name>John</name>
    <phoneNumber>111-111-1111</phoneNumber>
    <address>Imaginary street</address>
    <occupation>Baker</occupation>
  </item>
  <item>
    <name>Jane</name>
    <address>Another street</address>
    <occupation>Decorator</occupation>
  </item>
  <item>
    <address>Unknown</address>
  </item>
</root> 
```

XSLT：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:template match="item">
    <textItem>
      <xsl:for-each select="*[string(.)]">
        <xsl:if test="position()>1">
          <xsl:text>,</xsl:text>
        </xsl:if>
        <xsl:value-of select="."/>
      </xsl:for-each>
    </textItem>
  </xsl:template>

  <xsl:template match="text()">
  </xsl:template>

  <xsl:template match="root">
    <root>
      <xsl:apply-templates/>
    </root>
  </xsl:template>

</xsl:stylesheet> 
```

其中第一个模板是实际执行工作的模板，`<xsl:template match="text()">`删除包含在不匹配元素中的文本（默认情况下，XSLT 处理器会将此类文本复制到输出）并`<xsl:template match="root">`生成输出文档的根元素。

结果：

```
<root>
  <textItem>John,111-111-1111,Imaginary street,Baker</textItem>
  <textItem>Jane,Another street,Decorator</textItem>
  <textItem>Unknown</textItem>
</root> 
```

如果您只对某些字段感兴趣，您只需使用联合运算符 ( `|`) 选择它们 - 例如，如果您只想要上面示例中的电话、地址和职业，请将 XSLT 修改为：

```
 <xsl:template match="item">
    <textItem>
      <xsl:for-each select="(phoneNumber|address|occupation)[string(.)]">
        <xsl:if test="position()>1">
          <xsl:text>,</xsl:text>
        </xsl:if>
        <xsl:value-of select="."/>
      </xsl:for-each>
    </textItem>
  </xsl:template>

  <xsl:template match="text()">
  </xsl:template>

  <xsl:template match="root">
    <root>
      <xsl:apply-templates/>
    </root>
  </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T04:59:03.877

**这是一个接受“黑名单”元素名称列表作为参数的通用解决方案：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>
 <xsl:strip-space elements="*"/>

 <xsl:param name="pIgnoreThese" select="' Age Sex '"/>

 <xsl:template match="PersonalInfo">
  <xsl:apply-templates select=
   "*[normalize-space()
    and
      not(contains($pIgnoreThese, concat(' ', name(), ' ')))
     ]"/>
   <xsl:text>&#xA;</xsl:text>
 </xsl:template>

 <xsl:template match="PersonalInfo/*">
  <xsl:if test="position() >1">, </xsl:if>
  <xsl:value-of select="."/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<AddressBook>
        <PersonalInfo>
            <Age>33</Age>
            <Sex>Male</Sex>
            <Name>John</Name>
            <PhoneNumber>111-111-1111</PhoneNumber>
            <Address>Imaginary Street</Address>
            <Occupation>Baker</Occupation>
        </PersonalInfo>
        <PersonalInfo>
            <Age>33</Age>
            <Sex>Male</Sex>
            <Name></Name>
            <PhoneNumber></PhoneNumber>
            <Address>Imaginary Street</Address>
            <Occupation>Baker</Occupation>
        </PersonalInfo>
        <PersonalInfo>
            <Age>33</Age>
            <Sex>Male</Sex>
            <Name>John</Name>
            <PhoneNumber></PhoneNumber>
            <Address>Imaginary Street</Address>
            <Occupation>Baker</Occupation>
        </PersonalInfo>
</AddressBook> 
```

**产生了想要的正确结果**：

```
John, 111-111-1111, Imaginary Street, Baker
Imaginary Street, Baker
John, Imaginary Street, Baker 
```

# git - 从一个 git repo 部署 2 个站点

> ID：13573342
> 
> 赞同：0
> 
> 时间：2012-11-26T21:19:47.913
> 
> 标签：git, deployment, repository

我有 2 个站点（登台和直播）。我想要一个中央 git 存储库，我们从中推送和部署两个站点。

我还需要捕获临时站点和实时站点（插件安装、主题、扩展等）上发生的代码更改。我需要最好的结构的想法。

显然，我们的团队需要在本地保存中央仓库的工作副本。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T21:30:09.897

我们使用的是两个分支`master`和`production`. 通常开发`master`是在登台时签出的。

一旦一切正常，我们将生产重置为掌握并强制推送。`production`然后我们在签出的地方进行直播。执行所有这些操作的脚本会在执行所有操作之前验证现场没有未推送的更改。

对于需要在其中完成的修补程序，`production`我们有一个挑选策略：需要`master`立即挑选需要进行的更改。

值得注意的是，我们根本不合并。我们做到了，但这并没有成功。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T15:08:28.853

您可以将 Capistrano 与多阶段部署一起使用来处理您想要的。正在部署的 repo 几乎可以驻留在应用服务器环境可以访问的任何地方。

例如，在最近的一个项目中，我们使用了一个私有 GitHub 存储库作为部署存储库。我们在应用服务器上设置 SSH 密钥以通过 GitHub 进行身份验证，并且可以根据我们从本地工作站发出的 Capistrano 命令部署到暂存或生产环境。我们的本地 Capistrano 实例将远程（通过 SSH）告诉应用服务器从 Github 上的相应分支签出并获取最新的内容到它自己的本地 repo，将最新的代码复制到新目录，然后检查任务清单（配置修改、资产编译、数据库迁移等）。成功部署后，Capistrano 会告诉服务器切换到最新代码。任何打嗝，它都会简单地回滚部署。

部署命令很简单：`cap deploy`或`cap production deploy`

[您可以在此处](https://github.com/capistrano/capistrano)阅读有关它的更多信息，并在[此处](https://github.com/capistrano/capistrano/wiki/2.x-Multistage-Extension)阅读有关多级设置的信息。

# c# - 如何动态找到我的网址？HttpClient C#

> ID：13573343
> 
> 赞同：0
> 
> 时间：2012-11-26T21:19:54.790
> 
> 标签：c#

```
HttpClient client = new HttpClient(); 
client.BaseAddress = new Uri("http://localhost:60792"); 
```

而不是 localhost:60792 我如何在启动时动态找到它？将我指向正确的方向就足够了。但是，如果您有答案，请告诉我。

# 更新感谢您的提示。我的最终答案是

```
String baseURL = string.Format(
      (
        System.Web.HttpContext.Current.Request.Url.Port != 80) ? "{0}://{1}:{2}" : "{0}://{1}",
        System.Web.HttpContext.Current.Request.Url.Scheme,
        System.Web.HttpContext.Current.Request.Url.Host,
        System.Web.HttpContext.Current.Request.Url.Port
); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T21:24:08.967

`string url = HttpContext.Current.Request.Url.AbsoluteUri;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-04T05:50:48.023

在 Visual Studio 2019 的新更新之后，@webNoob 的答案将给出一个错误

`'HttpContext' does not contain a definition for 'Current' and no accessible extension method 'Current' accepting a first argument of type 'HttpContext' could be found (are you missing a using directive or an assembly reference?)`

所以即使你使用`System.web`，`System.Net.Http`你也会得到同样的错误。

您仍然可以使用以下内容作为修复：

用于获取字符串的查询

1.  用于获取查询 `var url1 = HttpContext.Request.Query.Keys;`

2.  获取路径 `var url2 = HttpContext.Request.Path.Value;`

# android - 表格布局未显示

> ID：13573345
> 
> 赞同：0
> 
> 时间：2012-11-26T21:20:08.100
> 
> 标签：android, dynamic, for-loop, tablelayout

我正在使用 java 代码开发动态表格布局

第一行在 xml 中

```
<TableLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"

            android:stretchColumns="*"
            android:id="@+id/TableMain" >

            <TableRow
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_margin="2dip"
                android:background="#000000" >

                <LinearLayout
        android:id="@+id/lTable11"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:orientation="horizontal" >

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="fill_parent"
                    android:layout_margin="1dip"
                    android:layout_weight="2"
                    android:background="#C0C0C0"
                    android:text="Grade" 
                    android:gravity="right"
                    android:padding="5dp" />

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="fill_parent"
                    android:layout_margin="1dip"
                    android:layout_weight="2"
                    android:background="#C0C0C0"
                    android:text="Hourse"
                    android:gravity="right" 
                    android:padding="5dp" />

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="fill_parent"
                    android:layout_margin="1dip"
                    android:layout_weight="6"
                    android:background="#C0C0C0"
                    android:text="Subject Name"
                    android:gravity="right"
                    android:padding="5dp" 
                      />

                    </LinearLayout>

            </TableRow>
        </TableLayout> 
```

剩余的行在 java 部分中，它在 xml 中具有相同的属性

```
TextView tvRowGrades[]=new TextView[gotSubName.length];
    TextView tvRowHourse[]=new TextView[gotSubName.length];
    TextView tvRowSubName[]=new TextView[gotSubName.length];

    TableRow row[]=new TableRow[gotGradeItem.length];
    LinearLayout LRow[]=new LinearLayout[gotGradeItem.length];
    tableMain=(TableLayout)findViewById(R.id.TableMain);

    for(int i=0;i<gotHourse.length;i++){
        row[i]=new TableRow(this);
        TableRow.LayoutParams lRow=new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
        lRow.setMargins(2, 2, 2, 2);
        row[i].setLayoutParams(lRow);
        row[i].setBackgroundColor(Color.BLACK);

        LinearLayout.LayoutParams lpLRow=new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT,LinearLayout.LayoutParams.WRAP_CONTENT);
        LRow[i]=new LinearLayout(this);
        LRow[i].setLayoutParams(lpLRow);
        LRow[i].setGravity(Gravity.CENTER);
        LRow[i].setOrientation(LinearLayout.HORIZONTAL);

        tvRowGrades[i]=new TextView(this);
        tvRowGrades[i].setText(gotGradeItem[i]);
        android.widget.LinearLayout.LayoutParams lpTvOther=new android.widget.LinearLayout.LayoutParams(android.widget.LinearLayout.LayoutParams.WRAP_CONTENT, android.widget.LinearLayout.LayoutParams.FILL_PARENT, 2);
        lpTvOther.setMargins(1, 1, 1, 1);
        tvRowGrades[i].setPadding(5, 5, 5, 5);
        tvRowGrades[i].setGravity(Gravity.RIGHT);
        tvRowGrades[i].setLayoutParams(lpTvOther);
        LRow[i].addView(tvRowGrades[i]);

        tvRowHourse[i]=new TextView(this);
        tvRowHourse[i].setText(gotHourse[i]+"");
        tvRowHourse[i].setPadding(5, 5, 5, 5);
        tvRowHourse[i].setGravity(Gravity.RIGHT);
        tvRowHourse[i].setLayoutParams(lpTvOther);
        LRow[i].addView(tvRowHourse[i]);

        tvRowSubName[i]=new TextView(this);
        tvRowSubName[i].setText(gotSubName[i]);
        android.widget.LinearLayout.LayoutParams lpTvSubName=new android.widget.LinearLayout.LayoutParams(android.widget.LinearLayout.LayoutParams.WRAP_CONTENT, android.widget.LinearLayout.LayoutParams.FILL_PARENT, 6);
        lpTvSubName.setMargins(1, 1, 1, 1);
        tvRowSubName[i].setPadding(5, 5, 5, 5);
        tvRowSubName[i].setGravity(Gravity.RIGHT);
        tvRowSubName[i].setLayoutParams(lpTvSubName);
        LRow[i].addView(tvRowSubName[i]);

        row[i].addView(LRow[i]);
        tableMain.addView(row[i]);
    } 
```

当我运行应用程序时，表格没有显示，我想解决这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T21:22:38.593

将`TableRow`宽度更改为 match_parent

```
 <TableRow
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_margin="2dip"
            android:background="#000000" > 
```

问题是你的行的宽度是由它的内容定义的`wrap_content`（`LinearLayout`

您也可以删除`LinearLayout`并将`TextView`项目直接放在`TableRow`扩展`LinearLayout`中。

对于您在代码中添加的其他行，您还应该更改`LayoutParams`：

```
 TableRow.LayoutParams lRow=new TableRow.LayoutParams(TableRow.LayoutParams.MATCH_PARENT, TableRow.LayoutParams.WRAP_CONTENT); 
```

# java - AWT - printDialog(aset) 与 printDialog()

> ID：13573350
> 
> 赞同：0
> 
> 时间：2012-11-26T21:20:23.320
> 
> 标签：java, printing, awt

当用户点击 OK 时`PrintDialog`- 此代码有效

```
PrintRequestAttributeSet aset = new HashPrintRequestAttributeSet();
if (pjob.printDialog(aset)) {
   try {
       pjob.print(aset);     
   } 
```

当用户点击 OK 时`PrintDialog`- 此代码不起作用

```
if (pjob.printDialog()) {
   try {
       pjob.print();     
   } 
```

但是对于第一个，它似乎永远不会进入 print 方法

```
 public int print(Graphics g, PageFormat format, int index) throws PrinterException {
    System.out.println("Print\n");
    etc... 
```

打印永远不会显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:05:52.387

这使用本机打印机对话框

```
if (pjob.printDialog()) {
   try {
      pjob.print();     
} 
```

这个使用跨平台打印机对话框

```
PrintRequestAttributeSet aset = new HashPrintRequestAttributeSet();
if (pjob.printDialog(aset)) {
   try {
      pjob.print(aset);     
   } 
```

我认为代码永远不会进入 print 方法的地方是错误的。我正在寻找错误的类来测试代码。

# sql - sql server 触发器帮助 - 同表更新

> ID：13573352
> 
> 赞同：0
> 
> 时间：2012-11-26T21:20:27.883
> 
> 标签：sql, sql-server-2008, triggers

我之前发布了一个类似的问题 - 但似乎无法得到足够长的回复！对不起，如果我不应该再次发布！

这是使用 SQL Server 2008。我有一个名为 invoice 的表；

```
create table INVOICE(
INVOICE_ID numeric(5) PRIMARY KEY IDENTITY,
INVOICE_STATUS varchar(25) not null,
TRADER_STATUS varchar (25)) 
```

我想在输入插入时创建触发器；并且 invoice_status = 'pending' - trader_status 更新（触发）为'open'。输入插入时；并且 invoice_status = 'overdue' - 将 trader_status 更新（触发）为 'blocked'。

我拥有的触发代码；

```
CREATE TRIGGER [dbo].[test] on [dbo].[invoice]
FOR INSERT, UPDATE
AS 
BEGIN

SET NOCOUNT ON;
declare @invoice_status varchar(25)
select @invoice_status = (select invoice_status from  inserted WHERE invoice_status = 'PENDING')
insert into invoice (trader_status) values ('OPEN')

select @invoice_status = (select invoice_status from  inserted WHERE invoice_status = 'OVERDUE')
insert into invoice (trader_status) values ('BLOCKED')

 END
 GO 
```

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:41:02.767

```
create trigger [dbo].[test] on [dbo].[invoice]
for insert
as
begin

update Invoice
  set Trader_Status = 'OPEN'
  where Invoice_Id in ( select Invoice_Id from inserted where Invoice_Status = 'PENDING' )

update Invoice
  set Trader_Status = 'BLOCKED'
  where Invoice_Id in ( select Invoice_Id from inserted where Invoice_Status = 'OVERDUE' )

end 
```

请注意，这将处理由单个语句插入的多个行。

# c - 分段错误问题。尝试在 C 中实现双向链表 FIFO 队列

> ID：13573357
> 
> 赞同：4
> 
> 时间：2012-11-26T21:20:50.573
> 
> 标签：c, pointers, segmentation-fault, malloc

我在使用此代码时遇到问题。我是 C 新手，据我所知，我正确使用了 malloc 操作。

```
#include "fifo.h"
#include <stdlib.h>

/* add a new element to a fifo */
void Enqueue( fifo* queue, int customerId)
{
   //allocate memory for the element being added
   //initialize fifo_element
   fifo_element *temp;
   temp = (fifo_element*)malloc(sizeof(fifo_element));
   temp->customerId = customerId;
   temp->prev = NULL;
   temp->next = NULL;

   //if the queue is empty, add the element to the start
   if(&queue->head == NULL){
      queue->head = queue->tail = temp;
      return;
   }
   else{
      queue->tail->next = temp;
      temp->prev = queue->tail;
      queue->tail = temp;
      return;      
   }   
} 
```

如果没有分段错误，我将无法执行此操作：

```
queue->tail->next = temp; 
```

我似乎无法提出不使用这行代码的解决方案或变通方法。谁能帮助解释为什么这行代码不起作用？提前致谢。

此外，这里是 fifo 和 fifo_element 结构：

```
struct fifo_element
{
   int customerId;
   fifo_element *next;
   fifo_element *prev;
};

struct fifo
{
   fifo_element *head;
   fifo_element *tail;
}; 
```

这是我排队时的电话：

```
Enqueue( &f, i ); //f is of type fifo 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T21:25:26.560

```
if(&queue->head == NULL){ 
```

在这一行中，您`head`检查`fifo`. 这可能不是你想要的。相反，您想检查指针的值是否有效：

```
if(queue->head == NULL){ 
```

另请记住，您必须使用正确的值启动 fifo：

```
fifo f;
f.head = 0;
f.tail = 0;
Enqueue( &f, 1 ); 
```

你应该检查 malloc 是否真的返回一个有效的地址：

```
temp = (fifo_element*)malloc(sizeof(fifo_element));
if(temp == NULL){
     /* insufficient memory, print error message, return error, etc */
} else {
     /* your code */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:24:37.523

我最好的猜测是

```
queue->tail 
```

没有实例化。

# winapi - Hooks 与原始输入 API

> ID：13573358
> 
> 赞同：1
> 
> 时间：2012-11-26T21:20:53.453
> 
> 标签：winapi, hook

我目前通过使用钩子（用于获取按键和鼠标点击）创建了我的应用程序的某些区域，但当时我并不完全了解原始输入 API。将挂钩系统更改为原始输入 API 有什么意义吗？使用 Raw Input API 而不是 hooks 有哪些优点/缺点，反之亦然？有详细解答吗？

# python - Python模块问题

> ID：13573359
> 
> 赞同：2
> 
> 时间：2012-11-26T21:20:55.197
> 
> 标签：python, linux, mysql-python, bluehost

我在 Bluehost 上有一个共享托管环境。我正在运行带有一些已安装模块的python（+ django）的自定义安装。一切都在工作，直到昨天在服务器上进行了更改（我假设）这给了我这个 django 错误：

```
...文件“/****/****/.local/lib/python/django/utils/importlib.py”，第 35 行，在 import_module
    __import__（名称）

文件“/****/****/.local/lib/python/django/db/backends/mysql/base.py”，第 14 行，在
    raise ImproperlyConfigured("加载 MySQLdb 模块时出错：%s" % e)

配置不当：加载 MySQLdb 模块时出错：libmysqlclient_r.so.16：无法打开共享对象文件：没有这样的文件或目录

```

当然，Bluehost 支持并没有太大帮助。他们建议 1) 我使用默认的 python 安装，因为它已经安装了 MySQLdb。或者 2）我以某种方式从我的 python 导入安装在默认 python 上的 MySQLdb 包（不知道这是否可以完成）。我担心如果我使用默认安装，我将无权安装我的其他软件包。

有没有人知道如何在尽可能少的基础设施更改的情况下恢复工作状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:43:54.950

我认为您升级了操作系统安装，这反过来又升级`libmysqlclient`并破坏了本机扩展。您可以做的是`libmysqlclient16`再次重新安装（如何安装取决于您的特定操作系统），这应该可以解决您的问题。

其他方法是卸载`MySQLdb`模块并重新安装它，强制 python 针对较新的库编译它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T19:03:09.927

你是对的。Bluehost 升级了 MySQL。这是我所做的：1）删除“MySQL-python-1.2.3”目录中的“build”目录2）删除egg 3）再次构建模块“python setup.py build”4）再次安装模块“python setup.py 安装 --prefix=$HOME/.local”

对我来说，这个故事的精神是在重新安装模块时删除旧的东西

# c# - 如何在运行时判断我的进程是 CPU 绑定还是 I/O 绑定

> ID：13573368
> 
> 赞同：2
> 
> 时间：2012-11-26T21:21:44.403
> 
> 标签：c#, networking, .net-4.0, io, compression

我有一个程序，我通过 TCP 链接发送数据。我正在使用异步读写磁盘和网络。如果我将[DeflateStream](http://msdn.microsoft.com/en-us/library/4yy62ycx%28v=vs.100%29.aspx)放在中间（所以我在写入网络链接之前进行压缩，并在收到数据并将其写入磁盘时解压缩）我在压缩方面受 CPU 限制。这导致我的最大传输速率约为`300 KB/s`. 但是，如果我删除压缩步骤，我现在将 I/O 绑定到磁盘，我得到的传输速率为`40,000 KB/s`.

在严格的 LAN 条件下，我的 I/O 上限将始终超过 300 KB/s，但是如果我的程序在 Internet 上运行，我的网络 IO 限制可能会低于 300 KB/s。

我想检测我是否受 I/O 限制并且我的网络/磁盘链接是限制因素，或者我是否受 CPU 限制并且压缩行为是最让我慢下来的。如何检测我的程序在运行时是否受到 CPU 或 I/O 的限制，以便切换协议并获得最佳传输速率？

```
private static void SendFile(string filename, NetworkStream stream, int sendBufferSize)
{
    using (var fs = new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.ReadWrite, 4096, FileOptions.Asynchronous | FileOptions.SequentialScan))
    using (var ds = new DeflateStream(stream, CompressionMode.Compress))
    {
        StreamUtilities.CopyAsync(fs, ds, sendBufferSize);
    }
}

public static void CopyAsync(Stream sourceStream, Stream destStream, int bufferSize = 4096)
{
    Byte[] bufferA = new Byte[bufferSize];
    Byte[] bufferB = new Byte[bufferSize];

    IAsyncResult writeResult = null;
    IAsyncResult readResult = null;

    bool readBufferA = false;
    int read;

    readResult = sourceStream.BeginRead(bufferA, 0, bufferA.Length, null, null);
    //Complete last read
    while ((read = sourceStream.EndRead(readResult)) > 0)
    {
        if (readBufferA)
        {
            PerformOperations(sourceStream, destStream, bufferA, bufferB, ref readResult, ref writeResult, read);
        }
        else
        {
            PerformOperations(sourceStream, destStream, bufferB, bufferA, ref readResult, ref writeResult, read);
        }

        //Flip the bit on the next buffer
        readBufferA = !readBufferA;
    }
    if (writeResult != null)
        destStream.EndWrite(writeResult);
}

private static void PerformOperations(Stream sourceStream, Stream destStream, Byte[] readBuffer, Byte[] writeBuffer, ref IAsyncResult readResult, ref IAsyncResult writeResult, int bytesToWrite)
{
    //Start next read
    readResult = sourceStream.BeginRead(readBuffer, 0, readBuffer.Length, null, null);

    //End previous write
    if (writeResult != null)
        destStream.EndWrite(writeResult);
    writeResult = destStream.BeginWrite(writeBuffer, 0, bytesToWrite, null, null);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-26T21:25:29.500

一种选择是将这两个方面分离到生产者/消费者队列中：您的压缩器将块写入队列，然后由仅执行 ​​IO 的线程使用。

那样：

*   您可以在 IO 发生时进行压缩，而无需进入异步 IO
*   您可以检测您是否受 CPU 限制（队列通常为空，或短暂地有 1 个块）或 IO 限制（随着压缩速度超过发送速度，队列逐渐变大）
*   通过一些工作，您可以多线程压缩；您需要跟踪块顺序，但这应该是可行的。

# c# - UI 进度条错误 C#

> ID：13573373
> 
> 赞同：1
> 
> 时间：2012-11-26T21:22:05.587
> 
> 标签：c#, winforms, progress-bar, backgroundworker

我有一个进度条的错误，我不知道如何处理它。

我有一个从 0 到 100 的 for 循环（或循环），只报告他的进度，然后休眠 100 毫秒：

```
private void backgroundWorker_DoWork(object sender, DoWorkEventArgs e)
{
    for (int i = 0; i <= 100; i++)
    {
        backgroundWorker.ReportProgress(i);
        Thread.Sleep(100);
    }
} 
```

在 progresschanged 事件处理方法中，除了一些其他的东西之外，还有两个“if”：

```
if (matchProgressBar.Value == 50)
{
    OnHalfTime(); //listBox1.Add("Halftime!");
}
if (matchProgressBar.Value == 100)
{
    OnFullTime(); //listBox1.Add("Full time!");
} 
```

两个“未知”的方法是向 listBox 添加一行。在第一种情况下：“中场休息！”；在第二个中：“全职！”。在这两行之后有相同的“Thread.Sleep(5000);” //你知道，只是因为你需要在中场休息:) //

但问题是 listBox1 已经更新，但 GUI 在进度条更新之前休眠了 5 秒。（所以程序在 49% 和 99% 处停留 5 秒。）

问题：我可以做些什么来解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:43:34.537

你真的不应该`Sleep()`在 UI 线程中调用。考虑重新安排事情，以便您暂停然后恢复您的后台线程，如果这是意图的话。

要强制更新进度条，请调用`Invalidate()`和`Update()`。例子：

```
matchProgressBar.Invalidate();
matchProgressBar.Update(); 
```

**编辑（澄清@Servy评论）：**

为了清楚起见，我在上面提供了两种选择。解决问题的首选方法是删除`Sleep()`UI 线程中的 ，而是让后台线程负责在适当的时间“暂停”。第二种选择，在调用 UI 线程之前使用`Invalidate()`和调用，可能会在这个特定实例中工作，但实际上是一个 hack，并且从维护的角度来看并不能很好地支持（即，容易因未来的代码更改而中断），并且还有其他不受欢迎的属性。如果可能，请使用第一种方法。`Update()``Sleep()`

# javascript - XmlHttpRequest 被 Access-Control-Allow-Origin 拒绝，即使来源完全匹配

> ID：13573379
> 
> 赞同：5
> 
> 时间：2012-11-26T21:23:04.490
> 
> 标签：javascript, http, cors

命脉：

Chrome 版本 23.0.1271.64 Mac OS X 10.8.2

情况：

我在[https://api.myapi.com/](https://api.myapi.com/)上公开了一个 Web 服务……我想允许 JavaScript 应用程序与这个 API 交互。 [CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)感觉显然是最合适的（jsonp 和朋友是可怕的、可怕的黑客）。

我可以在我的开发人员工具中看到正在发送预检请求：

```
Request URL: https://api.myapi.com/someapi
Request Method: OPTIONS
Status Code: 200 OK

Request Headers

Accept: */*
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Access-Control-Request-Headers: origin, authorization, accept
Access-Control-Request-Method: GET
Connection: keep-alive
Host: api.myapi.com
Origin: http://prototypes.mycompany.com
Referer: http://prototypes.mycompany.com/somepage.html
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11

Response Headers

Access-Control-Allow-Headers: Accept,Authorization,Content-Length,Content-Type,Cookie
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,HEAD,OPTIONS
Access-Control-Allow-Origin: http://prototypes.mycompany.com
Access-Control-Allow-Credentials: true
Connection: close 
```

这看起来很棒，特别是响应`Access-Control-Allow-Origin`标头似乎与请求`Origin`标头精确匹配。

紧接着，实际的请求被尝试：

```
Request URL: https://api.myapi.com/someapi

Request Headers

Accept: application/json, text/javascript, */*; q=0.01
Authorization: <custom authentication scheme, removed>
Origin: http://prototypes.mycompany.com
Referer: http://prototypes.mycompany.com/somepage.html
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11 
```

然后它显示为“已取消”并发出以下错误：

> XMLHttpRequest 无法加载[https://api.myapi.com/someapi](https://api.myapi.com/someapi)。Access-Control-Allow-Origin 不允许来源[http://prototypes.mycompany.com 。](http://prototypes.mycompany.com)

我最初是从`*`允许的来源开始的，但是由于完全相同的问题而失败了。

我已经在 iOS 5 的 Mobile Safari 和 Firefox 上复制了这个问题。在 Firefox 中，这种行为更加令人困惑：服务器响应 200 OK，然后响应 6-7KB 的数据（这是我所期望的）。客户端日志说它得到了 200 OK 和约 300 字节的数据（没有响应标头，根本没有响应......），然后触发“错误”处理程序。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:13:56.370

问题解决了！我不得不打破`gdb`它来弄清楚...

代理服务器将其自己的 CORS 标头插入到请求中。因此，HTTP 会话多次指定了标头。安全检查正在检查第一个标头“*”，并导致请求失败。请求失败打印出*最后一个*标头值，看起来是正确的。

不是很有帮助，WebKit！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T00:53:18.533

想法：

*   我注意到你`Origin`的`Access-Control-Allow-Headers`. 我不认为他们是必要的，但你有`Content-Length`，我也不认为这是必要的。

*   您正在使用`Authorization`，您认为您应该使用[凭据](https://developer.mozilla.org/en-US/docs/HTTP_access_control#Requests_with_credentials)吗？（显然有时你应该包括`Access-Control-Allow-Credentials: true`在响应中。）

（这些几乎不值得一个“答案”，但愚蠢的评论不允许换行。）

# c# - 通过 C# 使用 ado.net 将值插入 SQL Server 数据库

> ID：13573380
> 
> 赞同：18
> 
> 时间：2012-11-26T21:23:06.047
> 
> 标签：c#, sql, sql-server, ado.net, executenonquery

我创建了一个简单的程序来将值插入表中`[regist]`，但我不断收到错误

> *')' 附近的语法不正确*

上`cmd.ExecuteNonQuery();`：

```
 private void button1_Click(object sender, EventArgs e)
 {
      SqlConnection cn = new SqlConnection("Data Source=DELL-PC;initial catalog=AdventureWorks2008R2 ; User ID=sa;Password=sqlpass;Integrated Security=SSPI;");

      SqlCommand cmd = new SqlCommand("INSERT INTO dbo.regist (" + " FirstName, Lastname, Username, Password, Age, Gender,Contact, " + ") VALUES (" + " @textBox1.Text, @textBox2.Text, @textBox3.Text, @textBox4.Text, @comboBox1.Text,@comboBox2.Text,@textBox7.Text" + ")", cn);

      cn.Open();
      cmd.ExecuteNonQuery();
      cn.Close();
} 
```

我对此很陌生，我真的很困惑。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-11-26T21:55:41.047

正如我在评论中所说 - 您应该**始终**在查询中使用参数 -**永远不要**自己将您的 ​​SQL 语句连接在一起。

另外：我建议将单击事件处理程序与实际代码分开以插入数据。

所以我会将您的代码重写为

在您网页的代码隐藏文件 ( `yourpage.aspx.cs`)

```
private void button1_Click(object sender, EventArgs e)
{
      string connectionString = "Data Source=DELL-PC;initial catalog=AdventureWorks2008R2 ; User ID=sa;Password=sqlpass;Integrated Security=SSPI;";

      InsertData(connectionString,
                 textBox1.Text.Trim(),  -- first name
                 textBox2.Text.Trim(),  -- last name
                 textBox3.Text.Trim(),  -- user name
                 textBox4.Text.Trim(),  -- password
                 Convert.ToInt32(comboBox1.Text),  -- age
                 comboBox2.Text.Trim(), -- gender
                 textBox7.Text.Trim() );  -- contact
} 
```

在其他一些代码（例如 a `databaselayer.cs`）中：

```
private void InsertData(string connectionString, string firstName, string lastname, string username, string password
                        int Age, string gender, string contact)
{
    // define INSERT query with parameters
    string query = "INSERT INTO dbo.regist (FirstName, Lastname, Username, Password, Age, Gender,Contact) " + 
                   "VALUES (@FirstName, @Lastname, @Username, @Password, @Age, @Gender, @Contact) ";

    // create connection and command
    using(SqlConnection cn = new SqlConnection(connectionString))
    using(SqlCommand cmd = new SqlCommand(query, cn))
    {
        // define parameters and their values
        cmd.Parameters.Add("@FirstName", SqlDbType.VarChar, 50).Value = firstName;
        cmd.Parameters.Add("@Lastname", SqlDbType.VarChar, 50).Value = lastName;
        cmd.Parameters.Add("@Username", SqlDbType.VarChar, 50).Value = userName;
        cmd.Parameters.Add("@Password", SqlDbType.VarChar, 50).Value = password;
        cmd.Parameters.Add("@Age", SqlDbType.Int).Value = age;
        cmd.Parameters.Add("@Gender", SqlDbType.VarChar, 50).Value = gender;
        cmd.Parameters.Add("@Contact", SqlDbType.VarChar, 50).Value = contact;

        // open connection, execute INSERT, close connection
        cn.Open();
        cmd.ExecuteNonQuery();
        cn.Close();
    }
} 
```

像这样的代码：

*   不易受到 SQL 注入攻击
*   在 SQL Server 上执行得更好（因为查询被一次解析为执行计划，然后被缓存并稍后重用）
*   将事件处理程序（代码隐藏文件）与您的实际数据库代码（将事物放在它们所属的位置）分离 - 帮助避免“超重”代码隐藏与大量意大利面条代码，从处理 UI 事件到数据库访问 -**不是**一个好设计！）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-26T21:24:46.520

去掉逗号

```
... Gender,Contact, " + ") VALUES ...
                  ^-----------------here 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-11-24T12:28:56.927

以下代码适用于“**通过 C# 使用 ado.net 将值插入 SQL Server 数据库**”

```
// Your Connection string
string connectionString = "Data Source=DELL-PC;initial catalog=AdventureWorks2008R2 ; User ID=sa;Password=sqlpass;Integrated Security=SSPI;";

// Collecting Values
string firstName="Name",
    lastName="LastName",
    userName="UserName",
    password="123",
    gender="Male",
    contact="Contact";
int age=26; 

// Query to be executed
string query = "Insert Into dbo.regist (FirstName, Lastname, Username, Password, Age, Gender,Contact) " + 
                   "VALUES (@FN, @LN, @UN, @Pass, @Age, @Gender, @Contact) ";

    // instance connection and command
    using(SqlConnection cn = new SqlConnection(connectionString))
    using(SqlCommand cmd = new SqlCommand(query, cn))
    {
        // add parameters and their values
        cmd.Parameters.Add("@FN", System.Data.SqlDbType.NVarChar, 100).Value = firstName;
        cmd.Parameters.Add("@LN", System.Data.SqlDbType.NVarChar, 100).Value = lastName;
        cmd.Parameters.Add("@UN", System.Data.SqlDbType.NVarChar, 100).Value = userName;
        cmd.Parameters.Add("@Pass", System.Data.SqlDbType.NVarChar, 100).Value = password;
        cmd.Parameters.Add("@Age", System.Data.SqlDbType.Int).Value = age;
        cmd.Parameters.Add("@Gender", System.Data.SqlDbType.NVarChar, 100).Value = gender;
        cmd.Parameters.Add("@Contact", System.Data.SqlDbType.NVarChar, 100).Value = contact;

        // open connection, execute command and close connection
        cn.Open();
        cmd.ExecuteNonQuery();
        cn.Close();
    } 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-06-25T05:39:18.823

```
private void button1_Click(object sender, EventArgs e)
{
    SqlConnection con = new SqlConnection();
    con.ConnectionString = "data source=CHANCHAL\SQLEXPRESS;initial catalog=AssetManager;user id=GIPL-PC\GIPL;password=";
    con.Open();
    SqlDataAdapter ad = new SqlDataAdapter("select * from detail1", con);
    SqlCommandBuilder cmdbl = new SqlCommandBuilder(ad);
    DataSet ds = new DataSet("detail1");
    ad.Fill(ds, "detail1");
    DataRow row = ds.Tables["detail1"].NewRow();
    row["Name"] = textBox1.Text;
    row["address"] =textBox2.Text;
    ds.Tables["detail1"].Rows.Add(row);
    ad.Update(ds, "detail1");
    con.Close();
    MessageBox.Show("insert secussfully"); 
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-11-26T21:52:06.180

您应该删除最后一个逗号，并且正如 nrodic 所说，您的命令不正确。

你应该像这样改变它：

```
SqlCommand cmd = new SqlCommand("INSERT INTO dbo.regist (" + " FirstName, Lastname, Username, Password, Age, Gender,Contact " + ") VALUES (" + " textBox1.Text, textBox2.Text, textBox3.Text, textBox4.Text, comboBox1.Text,comboBox2.Text,textBox7.Text" + ")", cn); 
```

# c# - 如何将任意 json 对象发布到 webapi

> ID：13573384
> 
> 赞同：31
> 
> 时间：2012-11-26T21:23:20.487
> 
> 标签：c#, json, mongodb, asp.net-web-api

我如何/是否可以将 json 对象传递给 webapi 控制器（POST）并且*没有*将其映射到的类，而是将其作为任意内容处理？

因此，如果我像这样从客户那里传递信息：

```
 createRecord: function (model, data, callback, callbackParams) {
        var request = jQuery.ajax({
            type: "POST", // default = GET,
            url: '/api/' + model + '/',
            data: data,
            contentType: 'application/json',
            success: function (msg) {
                $('#results').text(msg);
                if (callback) // only fire a callback if it has been specified
                    callback(msg, callbackParams);
            },
            error: function (jqXHR, textStatus) {
                alert('Request failed: ' + textStatus);
            }
        });
    } 
```

和数据是这样的：

```
{ "_id" : ObjectId("5069f825cd4c1d590cddf206"), "firstName" : "John", "lastName" : "Smith", "city" : "Vancouver", "country" : "Canada" } 
```

我的控制器将能够解析它吗？下次数据可能与该签名不匹配（例如：

```
{ "_id" : ObjectId("5069f825cd4c1d56677xz6"), "company" : "Acme" } 
```

在我的控制器中，我尝试过：

```
public HttpResponseMessage Post([FromBody]JObject value) 
```

和：

```
public HttpResponseMessage Post([FromBody]string value) 
```

并且（因为这实际上是使用 mongo db）：

```
public HttpResponseMessage Post([FromBody]BsonDocument value) 
```

但看起来对象映射器想要映射到字符串以外的东西......

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-26T22:09:26.143

你可以让你的 post 方法接受一个 HttpRequestMessage 来绕过模型绑定逻辑，你可以直接读取请求的内容：

```
 public HttpResponseMessage Post(HttpRequestMessage req)
    {
        var data = req.Content.ReadAsStringAsync().Result; // using .Result here for simplicity...
        ...

    } 
```

顺便说一句，JObject 中的操作不起作用的原因是因为 'ObjectId("...")' 在您的数据中用作“_id”的值...

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-01-24T02:45:36.277

我们通过 jquery 传递 json 对象，并在动态对象中解析它。它工作正常。这是示例代码：

```
ajaxPost:

...
Content-Type: application/json,
data: {
          "name": "Jack", 
          "age": "12"
      }
... 
```

网络API：

```
[HttpPost]
public string DoJson2(dynamic data)
{
    string name = data.name;
    int age = data.age;

    return name;
} 
```

关于stackoverflow的类似问题： [WebAPI Multiple Put/Post parameters](https://stackoverflow.com/questions/14407458/webapi-multiple-put-post-parameters/14492994#14492994)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-26T22:17:09.333

在您的输入中，`"_id": ObjectId("5069f825cd4c1d590cddf206")`是什么破坏了服务器上的 JSON 实现。删除`ObjectId`和使用`"_id" : "5069f825cd4c1d590cddf206"`作品与`JObject`以及`Dictionary<string, object>`

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2013-02-20T01:46:21.593

这很简单，您只需要将 Accept Header 放入“application/json”。

# sql - 在更新任何旧数据时插入多对多表

> ID：13573389
> 
> 赞同：0
> 
> 时间：2012-11-26T21:23:34.037
> 
> 标签：sql, sql-server, many-to-many

我有 3 个表形成多对多关系，如下图所示。

![在此处输入图像描述](../Images/f092a01dccd556b2d710a079c1e2ee7f.png)

如何`UsersByCompanies`使用以下规则在公司编号 1 和用户编号 2 之间保存表中的条目：

*   当我们在用户和公司之间创建新条目时，`IsEnabled`属性 in`UsersByCompanies`必须设置为 1，并且任何其他行`Companies.CompanyCode = 1`的属性`Users.IDNumber = 2`必须`IsEnabled`设置为 0。
*   新行中的`DateCreated`属性必须具有当前日期。

到目前为止，我已经想出了这个，但它有错误：

```
 IF (NOT EXISTS((select IDNumber from dbo.tb_Users where ((IDNumber)) = 1234)))
    --the user was not registered 
    insert into dbo.tbUsers(IDNumber, Name, LastName, department)
    values (1234, 'John','Smith','A')
    go

    insert into dbo.tb_UsersByCompanies (IDNumber,  CompanyCode, DateCreated, IsEnabled)  
    values (1234, 2, getdate(), 1) 
    go

    print 'New Client'

 ELSE 
    update dbo.tbUsers 
    set IDNumber = 1234, Name = 'John', LastName= 'Smith'
    where ((IDNumber)) = 1234
    go

IF (EXISTS((select IDNumber, CompanyCode from dbo.tb_UsersByCompanies 
            where (IDNumber)= 1234 and CompanyCode = 2 and IsEnabled = 1 )))

    --The user is already registered in the company
    print 'The user is already registered and active in the company'

ELSE
    IF(EXISTS((select IDNumber, CompanyCode from dbo.tb_UsersByCompanies 
               where (IDNumber)= 1234 and  IsEnabled = 1 )))
     --the user is active in another company
     update dbo.tb_UsersByCompanies 
     set IsEnabled = 0 
     where ((IDNumber)) = 1234 and IsEnabled = 1 

     insert into dbo.tb_UsersByCompanies (IDNumber,  CompanyCode, DateCreated, IsEnabled)  
     values (1234, 2, getdate(), 1) 

     print 'The Client is active in another company'

  ELSE 
     --if it enters here the user was already registered but not linked to a company
     insert into dbo.tb_UsersByCompanies (IDNumber,  CompanyCode, DateCreated, IsEnabled)  
     values (1234, 2, getdate(), 1)

     print 'the user was already registered but not linked to a company' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:08:08.173

```
IF NOT EXISTS(select * from dbo.tb_Users where IDNumber = 1234)
    --the user was not registered 
    insert into dbo.tbUsers(IDNumber, Name, LastName, department)
    values (1234, 'John','Smith','A')
 ELSE 
    update dbo.tbUsers 
    set IDNumber = 1234, Name = 'John', LastName= 'Smith'
    where ((IDNumber)) = 1234

  -- now user is valid and existing
  -- update all entries for user which are not company 2
update dbo.tb_UsersByCompanies set IsEnabled = 0 
where  IDNumber= 1234 and CompanyCode <> 2

-- insert if not existsing 
if not Exists (Select * from dbo.tb_UsersByCompanies where  IDNumber= 1234 and CompanyCode =2)
    insert into dbo.tb_UsersByCompanies (IDNumber,  CompanyCode, DateCreated, IsEnabled)
    Values
    (1234,2,GETDATE(),2) 
```

# objective-c - 如何为 MKAnnotationViews 设置多个图像？

> ID：13573391
> 
> 赞同：0
> 
> 时间：2012-11-26T21:23:41.533
> 
> 标签：objective-c, image, mkmapview, mkannotationview

我正在开发一个使用 MapKit 类 Mkannotation 和 MKAnnotationView 的应用程序（当然都是子类）。

我的问题是，如何在我的地图上放置多个 FGAnnotationViews（大约 5 个），它们都有不同的图像？

我知道我可以创建 5 个不同的新类并初始化一个匹配，但我想，也许有一种方法可以在

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation 
```

函数，比如

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation {
MKAnnotationView *annView = nil;

if (annotation == myRestaurantAnnotation) {

    FGAnnotationView *fgAnnView = (FGAnnotationView*)[self.mapView dequeueReusableAnnotationViewWithIdentifier:@"Location"];
    fgAnnView = [[FGAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:@"Location"];
}
return annView;
} 
```

任何人？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:16:50.530

您快到了。尝试这个

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation {
    MKAnnotationView *annView = nil;

    FGAnnotationView *fgAnnView = (FGAnnotationView*)[self.mapView dequeueReusableAnnotationViewWithIdentifier:@"Location"];

    if (annotation == myRestaurantAnnotation) {
        fgAnnView.image = //MAGIC GOES HERE//;
    } else if (annotation == myBankAnnotation) {
        fgAnnView.image = //MAGIC GOES HERE//;
    }
    return fgAnnView;
} 
```

如果您让地图绘制用户的位置，您应该检查注释的类并确保它不是 MKUserLocation。如果是，那么你返回 nil。如果您有每个注释类的多个实例，则可以使用该类来确定要设置的图像，而不是匹配对象本身，如下所示：

```
if ([annotation isKindOfClass:[MKUserLocation class]]) {
    return nil;
} else if ([annotation isKindOfClass:[FGRestaurantAnnotation class]]) {
    fgAnnView.image = //YOUR IMAGE CODE//
} 
```

# android - 我需要从图像创建布局

> ID：13573393
> 
> 赞同：1
> 
> 时间：2012-11-26T21:23:50.023
> 
> 标签：android, android-layout

我有下面的图片，我想创建类似的布局，我需要代替矩形来放置 EditText 视图。但我不知道哪种方式是实现这种布局的最佳方式，我应该制作线条的背景还是制作相对布局并尝试对齐？

因此，如果有人对此类布局有经验，请告诉我该怎么做。

提前致谢。

![在此处输入图像描述](../Images/87d0865d3d1a8bc8116aa7bf46879d54.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:30:55.110

查看该图像，您似乎正试图将大量 EditText 塞进一个屏幕中。这是一个非常不寻常的布局......除非您的应用程序有一个非常非常具体的用例，其中另一个布局是不可接受的，我建议您尝试使用 Android 中更“标准”的布局之一，因为这很可能增强可用性。

但是，如果您认为这确实是您所需要的，那么我会看看 GridLayout，其中最右边的组件是可扩展的，并且包含一个 LinearLayout 或类似的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T11:21:57.660

这种布局制作起来相对简单，要让它在大量的 Android 设备上工作还需要做很多工作。例如：

```
<?xml version="1.0" encoding="utf-8"?>
<com.luksprog.ds.views.RelativeLayoutExtension xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >  

    <EditText
        android:id="@+id/et10"
        android:layout_width="30dp"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_centerVertical="true"
        android:text="X" />

    <EditText
        android:id="@+id/et9"
        android:layout_width="30dp"
        android:layout_height="wrap_content"
        android:layout_above="@id/et10"
        android:layout_marginBottom="25dp"
        android:layout_toLeftOf="@id/et10"
        android:text="9" />

    <EditText
        android:id="@+id/et8"
        android:layout_width="30dp"
        android:layout_height="wrap_content"
        android:layout_below="@id/et10"
        android:layout_marginTop="25dp"
        android:layout_toLeftOf="@id/et10"
        android:text="8" />

    <EditText
        android:id="@+id/et7"
        android:layout_width="30dp"
        android:layout_height="wrap_content"
        android:layout_centerVertical="true"
        android:layout_marginLeft="40dp"
        android:layout_toLeftOf="@id/et9"
        android:text="7" />

    <LinearLayout
        android:id="@+id/et65wrapper"
        android:layout_width="40dp"
        android:layout_height="wrap_content"
        android:layout_centerVertical="true"
        android:layout_toLeftOf="@id/et7"
        android:orientation="vertical"
        android:paddingLeft="10dp" >

        <EditText
            android:id="@+id/et6"
            android:layout_width="30dp"
            android:layout_height="wrap_content"
            android:layout_marginBottom="5dp"
            android:text="6" />

        <EditText
            android:id="@+id/et5"
            android:layout_width="30dp"
            android:layout_height="wrap_content"
            android:layout_marginTop="5dp"
            android:text="5" />
    </LinearLayout>

    <LinearLayout
        android:id="@+id/et43wrapper"
        android:layout_width="40dp"
        android:layout_height="wrap_content"
        android:layout_centerVertical="true"
        android:layout_toLeftOf="@id/et65wrapper"
        android:orientation="vertical"
        android:paddingLeft="10dp" >

        <EditText
            android:id="@+id/et4"
            android:layout_width="30dp"
            android:layout_height="wrap_content"

            android:layout_marginBottom="5dp"
            android:text="4" />

        <EditText
            android:id="@+id/et3"
            android:layout_width="30dp"
            android:layout_height="wrap_content"
            android:layout_marginTop="5dp"
            android:text="3" />
    </LinearLayout>

    <LinearLayout
        android:id="@+id/et21wrapper"
        android:layout_width="40dp"
        android:layout_height="wrap_content"
        android:layout_centerVertical="true"
        android:layout_toLeftOf="@id/et43wrapper"
        android:orientation="vertical"
        android:paddingLeft="10dp" >

        <EditText
            android:id="@+id/et2"
            android:layout_width="30dp"
            android:layout_height="wrap_content"
            android:layout_marginBottom="5dp"
            android:text="2" />

        <EditText
            android:id="@+id/et1"
            android:layout_width="30dp"
            android:layout_height="wrap_content"
            android:layout_marginTop="5dp"
            android:text="1" />
    </LinearLayout>

</com.luksprog.ds.views.RelativeLayoutExtension> 
```

这`RelativeLayoutExtension`是一个扩展`RelativeLayout`类的类，如下所示：

```
public class RelativeLayoutExtension extends RelativeLayout {

    private LinearLayout mFirstLinear;
    private LinearLayout mSecondLinear;
    private LinearLayout mLastLinear;

    private EditText mUpperEditText;
    private EditText mLowerEditText;
    private Paint mPaint;

    public RelativeLayoutExtension(Context context, AttributeSet attrs) {
        super(context, attrs);
        mPaint = new Paint();
        mPaint.setColor(Color.RED);
        mPaint.setStrokeWidth(2.0f);
    }

    @Override
    protected void onFinishInflate() {
        super.onFinishInflate();
        mFirstLinear = (LinearLayout) findViewById(R.id.et21wrapper);
        mSecondLinear = (LinearLayout) findViewById(R.id.et43wrapper);
        mLastLinear = (LinearLayout) findViewById(R.id.et65wrapper);
        mUpperEditText = (EditText) findViewById(R.id.et9);
        mLowerEditText = (EditText) findViewById(R.id.et8);
    }

    @Override
    protected void dispatchDraw(Canvas canvas) {
        super.dispatchDraw(canvas);
        final int leftFirst = mFirstLinear.getLeft();
        final int topFirst = mFirstLinear.getTop();
        final int middleFirst = (mFirstLinear.getBottom() - mFirstLinear
                .getTop()) / 2;
        final int lastRight = mLastLinear.getRight();
        canvas.drawLine(leftFirst, topFirst + middleFirst, lastRight, topFirst
                + middleFirst, mPaint);

        final int rightFirst = mFirstLinear.getRight();
        final int bottomFirst = mFirstLinear.getBottom();
        canvas.drawLine(rightFirst, topFirst, rightFirst, bottomFirst, mPaint);

        final int rightSecond = mSecondLinear.getRight();
        canvas.drawLine(rightSecond, topFirst, rightSecond, bottomFirst, mPaint);

        final int leftUpperEdit = mUpperEditText.getLeft();
        final int topUpperEdit = mUpperEditText.getTop();
        final int middleUpperEdit = (mUpperEditText.getBottom() - mUpperEditText
                .getTop()) / 2;
        canvas.drawLine(lastRight, topFirst + middleFirst, leftUpperEdit,
                topUpperEdit + middleUpperEdit, mPaint);

        final int leftLowerEdit = mLowerEditText.getLeft();
        final int topLowerEdit = mLowerEditText.getTop();
        final int middleLowerEdit = (mLowerEditText.getBottom() - mLowerEditText
                .getTop()) / 2;
        canvas.drawLine(lastRight, topFirst + middleFirst, leftLowerEdit, topLowerEdit
                + middleLowerEdit, mPaint);
    }

} 
```

线条不是很居中，这只是一个例子。如果您计划在知道其尺寸的单个设备上使用此布局，则该布局将起作用，因为您只需要在代码之外计算尺寸一次。如果您将此计划为一般布局，事情会变得非常难看，因为您需要进行大量计算才能正确定位视图并绘制线条，因此您可能需要重新考虑您的方法。此外，我希望你想在大屏幕设备上使用这种布局，因为`EditTexts`在纵向智能手机上塞满 6 个空格并不能很好地工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T07:39:31.643

您可以使用标准布局创建它。主要布局是 FrameLayout。背景是带有一些线条（或显示线条的形状）的图像。活动布局是一个显示所有矩形的 RelativeLayout。

# java - 如何录制流

> ID：13573395
> 
> 赞同：2
> 
> 时间：2012-11-26T21:24:03.660
> 
> 标签：java

我需要记录一个数据流，因为它从我的应用程序传递到另一个应用程序（都在我的控制之下）。

我想这样做来记录发送和接收的字节以进行集成测试。

我可以做这样的事情：

```
void inputStreamToOutputStream(final InputStream inputStream, final OutputStream out) {
    Thread t = new Thread(new Runnable() {

        public void run() {
            try {
                int d;
                while ((d = inputStream.read()) != -1) {
                    out.write(d);
                    savedFile.write(d);
                }
            } catch (IOException ex) {
            }
        }
    });
    t.start();
} 
```

但感觉应该已经有一个图书馆可以做到这一点。我可以看到 Apache IOUtils 有一种`copy`方法可以将两个流绑定在一起：

```
IOUtils.copy(in, out); 
```

但这并不能让我“记录”发送的字节。在我自己动手之前，任何人都可以推荐一个已经这样做的像样的图书馆吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T21:29:25.143

使用来自 Apache Commons IO 的[TeeOutputStream](http://commons.apache.org/io/apidocs/org/apache/commons/io/output/TeeOutputStream.html) / [TeeInputStream](http://commons.apache.org/io/apidocs/org/apache/commons/io/input/TeeInputStream.html)，您可以写入您的输出以及您的`savedInFile`and `savedOutFile`：

```
OutputStream teeOutput = new TeeOutputStream(out, savedOutFile);
InputStream teeInput = new TeeInputStream(input, savedInFile) 
```

然后您可以将 tee 发送到执行读/写的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T21:40:32.080

正如前面提到的答案，您可以使用[CommonsIO](http://commons.apache.org/io/apidocs/org/apache/commons/io/output/TeeOutputStream.html)的 TeeOutputStream，但您仍然需要正确缓冲输入流。您包含的代码很接近，但您只是将读出的字节数写入两个流，*而不是*字节本身。

尝试这样的事情：

```
void inputStreamToOutputStream(final InputStream inputStream, final OutputStream out) {
    Thread t = new Thread(new Runnable() {

        public void run() {
            try {
                TeeOutputStream tos = new TeeOutputStream (out,savedFile);
                byte [] buf = byte[1024];
                int d;
                while ((d = inputStream.read(buf,0,buf.length)) != -1) {
                    tos.write(buf,0,d);
                }
            } catch (IOException ex) {
            }
        }
    });
    t.start();
} 
```

# signalr - SignalR IE9 跨域请求不起作用

> ID：13573397
> 
> 赞同：2
> 
> 时间：2012-11-26T21:24:10.927
> 
> 标签：signalr, signalr-hub

我正在使用 SignalR 制作应用程序。

集线器放置在一台运行带有 IIS 8 的 Windows Server 2012 的服务器上。 [http://mentor.cloudapp.net/mass/rexona/previa/signalr/hubs](http://mentor.cloudapp.net/mass/rexona/previa/signalr/hubs)。

客户在这里： http://massdeveloperstage.com/Rexona/Site/colombia/Previa/Match?matchId= [6F318A29-3400-444B-95D9-7EC41A7AD2D4](http://massdeveloperstage.com/Rexona/Site/colombia/Previa/Match?matchId=6F318A29-3400-444B-95D9-7EC41A7AD2D4)

Signalr 设置如下所示：

```
var match;
    $(document).ready(function () {
        $.connection.hub.loging = true;
        match = $.connection.match;

    match.client.addMessage = function (message) {
        var vm = {
            avatar: message.ProfileImageLocation,
            content: message.Text,
            user: message.UserScreenName,
            obj: JSON.stringify(message)
        };
         alert(vm.obj);
   }
  $.connection.hub.url = 'http://mentor.cloudapp.net/mass/rexona/previa/signalr';

    $.connection.hub.start().done(function () {
        match.server.addToGroup("97-987-PP");
    }).fail(function () {
          //alert("fail!");
    }); 
```

一切都在 Chrome、FF、Opera 和 IE10 中完美运行，但是当使用 IE9 访问时，应用程序失败。

我在连接设置中遗漏了什么吗？我是否需要在服务器上启用其他功能才能使用 IE9？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:39:28.120

我认为您正在尝试在那里进行 CORS（跨站点原始共享）。它与 IE9 的工作方式不太一样，请查看此处[以](http://bugs.jquery.com/ticket/12097)获取详细讨论，并查看[microsoft page](http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx)了解确切的限制。它是使用 XDomainRequest 自定义对象而不是 XMLHttpRequest 完成的，并且...

1.  必须使用 HTTP 或 HTTPS 协议访问目标 URL
2.  必须仅使用 HTTP 方法 GET 和 POST 访问目标 URL
3.  不得将自定义标头添加到请求中
4.  请求的 Content-Type 标头仅支持 text/plain（不支持 soap、json 或编码数据类型！）
5.  不会随请求发送任何身份验证或 cookie
6.  针对 Intranet URL 的请求只能从 Intranet 区域发出
7.  请求必须针对与托管页面相同的方案

编辑：我自己实际上从未使用过 SignalR，这个答案通常基于 CORS。根据@stricq 的评论，IE 需要启用长轮询才能与 SignalR 一起使用，如此[处](http://www.widecodes.com/CNVVeWPgqq/signalr-group-notification-does-not-work-on-ie9-unless-start-transport-longpolling-.html)所述。

# signalr - 导出 TypeScript 模块会导致接口不被拾取

> ID：13573398
> 
> 赞同：3
> 
> 时间：2012-11-26T21:24:15.293
> 
> 标签：signalr, typescript

我一起使用 TypeScript 和 SignalR，并尝试为生成的 SignalR 类定义静态类型。如果我做这样的事情，它会起作用：

```
///<reference path="../Scripts/jquery-1.8.d.ts" />
///<reference path="../Scripts/signalr-1.0.d.ts" />

interface SignalR {
    roomHub: Service.RoomHub;
}

module Service {
        export var roomHub = $.connection.roomHub;
        export interface RoomHub { }
} 
```

当然`$.connection`是类型`SignalR`，它在文件“signalr-1.0.d.ts”中定义，并在上面的文件中扩展。

但是，我需要能够`Service`从其他文件中引用模块，所以我需要在模块和接口中添加“export”关键字，即：

```
///<reference path="../Scripts/jquery-1.8.d.ts" />
///<reference path="../Scripts/signalr-1.0.d.ts" />

export interface SignalR {
    roomHub: Service.RoomHub;
}

export module Service {
    // Error here: "The property 'roomHub' does not exist on type SignalR."
    export var roomHub = $.connection.roomHub;
    export interface RoomHub { }
} 
```

但是，当我这样做时，我在 下得到一条红色的波浪线`$.connection.roomHub`，编译器返回错误“SignalR 类型上不存在属性 'roomHub'。”

我当然不了解有关 TypeScript 的所有内容，但这对我来说似乎不正确。我遇到了编译器错误吗？还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T22:39:27.467

我能够想出一个解决方法。我将接口提取到一个单独的文件中：

```
// File: ISignalR.ts
interface SignalR {
    roomHub: RoomHub;
}

interface RoomHub {
} 
```

然后我在我的服务文件中引用了该文件

```
///<reference path="../Scripts/jquery-1.8.d.ts" />
///<reference path="../Scripts/signalr-1.0.d.ts" />
///<reference path="ISignalR.ts" />

export module Service {
    export var roomHub = $.connection.roomHub;
} 
```

这很有效，很奇怪。我不确定这是编译器错误，还是我继续误解的东西，但它显然与一些与 AMD 模块支持相关的细微语义变化有关。我很想听听比我更了解 TypeScript 和/或 RequireJS 模块的人的更多解释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T11:47:00.600

连接 SignalR 的方法不止一种，并且使用`createHubProxy`对`invoke`TypeScript 更友好：

```
export class FrameworkHub {

    private connection: HubConnection;
    private proxy: HubProxy;

    Init(): void {
        this.Connected = false;
        this.connection = $.hubConnection();
        this.connection.logging = true;
        // Binding with createHubProxy means you can use a string name, so no need to add dynamic properties to the hub
        this.proxy = this.connection.createHubProxy("MyHubName"); 
        this.wireEventListeners();
        this.initializeConnection();
    }

    // Binding with proxy.on means you can use a string name for the function, so no need to add dynamic properties to the hub.
    wireEventListeners(): void {
        this.proxy.on("HandleFrameworkMessage", (message: IFrameworkMessage) => {
            console.log("HandleFrameworkMessage: " + message.AccountID + " - " + message.ArmID);
            // Do something to handle the message here.
        });
    }

    initializeConnection(): void {
        //console.log("Framework Hub initializeConnection");
        var that = this;
        //Again, using invoke means passing a string argument.
        this.connection.start().done(() => {
            that.proxy.invoke("Connect", this.AccountID, this.ArmID).done((response:FrameworkHubResponse) => {
                //console.log("FHR: " + response.Success + " - " + response.Message);
                if (response.Success) {
                    // Do something.
                }
                else {
                    // Try again. Would be better with some kind of exponential back-off.
                    setTimeout(that.initializeConnection, 500);
                }
            });
        });
    }
} 
```

这是一个从真实代码中截取的稍微粗略的示例，但我发现它是使用 SignalR 的最佳 TS 方式。这种连接的文档在这里：[https](https://github.com/SignalR/SignalR/wiki/SignalR-JS-Client-Hubs-%28No-Proxy%29) ://github.com/SignalR/SignalR/wiki/SignalR-JS-Client-Hubs-%28No-Proxy%29 - 请注意，因为文档并不总是跟上最近的变化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-26T22:02:44.220

如果`SignalR`对象有实际成员，您想改用`declare module`语法。`interface`声明只描述类型的成员（而不是描述现存的对象）。

```
///<reference path="../Scripts/jquery-1.8.d.ts" />
///<reference path="../Scripts/signalr-1.0.d.ts" />

declare module SignalR {
    var roomHub: Service.RoomHub;
}

export module Service {
    // Good now
    export var roomHub = $.connection.roomHub;
    export interface RoomHub { }
} 
```

# visual-c++ - C ++程序计算数字的出现

> ID：13573410
> 
> 赞同：1
> 
> 时间：2012-11-26T21:25:03.813
> 
> 标签：visual-c++

我正在尝试编写一个 C++ 程序，该程序输入 1 到 100 之间的五个数字，然后程序输出每个数字出现的次数。这是我到目前为止的内容，但我不断收到未解决的错误消息。

```
#include <iostream>
using namespace std;

void fillArray(int a[], int& size, int& numberUsed)
{
int i, hist[1000]; 

cout << "Enter 5 integers between 1 and 100" << endl;

for (i=0; i<size; i++)
{
cin >> a[i]; 
if(a[i] > 100)
{
i--; 
cout << "Num too big! 100 is max!" << endl;
}

}
numberUsed = i;

for (i=0; i<1000; i++)
hist[i] = 0;

for (i=0; i<numberUsed; i++)
{
hist[a[i]]++;
}

for (i=0; i<1000; i++)
if(hist[i])
cout << i << " occurs " << hist[i] << " times!" << endl;

} 
```

错误消息显示以下“错误 LNK2019：*函数 _* _tmainCRTStartup 中引用的未解析的外部符号主”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T21:31:20.030

您必须添加 main() 函数才能链接它。

# ios - 带附件的电子邮件编辑器 iOS Phonegap

> ID：13573412
> 
> 赞同：2
> 
> 时间：2012-11-26T21:25:28.603
> 
> 标签：ios, email, cordova, attachment

我正在尝试通过在[此处](https://github.com/phonegap/phonegap-plugins/tree/master/iOS/EmailComposerWithAttachments)`emailcomposerwithattachment`找到的插件附加 PDF 。

问题是当电子邮件编写器出现时，它显示附加了 PDF，但是发送后，当我检查电子邮件时，文件不存在。

这是我调用它的代码，我已经检查以确保文件路径设置正确并且看起来是（使用在应用程序其他地方的子浏览器中工作的相同文件）。

有什么建议么？另外，我正在使用cordova 2.1.0

这是我调用插件的代码：

```
var strPath = window.location.href; 
var path = encodeURI(strPath.substr(0,strPath.lastIndexOf('/')) + URL); 
window.plugins.emailComposer.showEmailComposer(subject,body,[],[],[],true,[path]); 
```

这是 EmailComposer 代码：

```
- (void) showEmailComposer:(NSMutableArray*)arguments withDict:(NSMutableDictionary*)options {
    NSDictionary *parameters = [NSDictionary dictionaryWithObjectsAndKeys:
                                [options valueForKey:@"toRecipients"], @"toRecipients",
                                [options valueForKey:@"ccRecipients"], @"ccRecipients",
                                [options valueForKey:@"bccRecipients"], @"bccRecipients",
                                [options valueForKey:@"subject"], @"subject",
                                [options valueForKey:@"body"], @"body",
                                [options valueForKey:@"bIsHTML"], @"bIsHTML",
                                [options valueForKey:@"attachments"], @"attachments",
                                nil];
    [self showEmailComposerWithParameters:parameters];
}

-(void) showEmailComposerWithParameters:(NSDictionary*)parameters {

    MFMailComposeViewController *mailComposer = [[MFMailComposeViewController alloc] init];
    mailComposer.mailComposeDelegate = self;

    // set subject
    @try {
        NSString* subject = [parameters objectForKey:@"subject"];
        if (subject) {
            [mailComposer setSubject:subject];
        }
    }
    @catch (NSException *exception) {
        NSLog(@"EmailComposer - Cannot set subject; error: %@", exception);
    }

    // set body
    @try {
        NSString* body = [parameters objectForKey:@"body"];
        BOOL isHTML = [[parameters objectForKey:@"bIsHTML"] boolValue];
        if(body) {
            [mailComposer setMessageBody:body isHTML:isHTML];
        }
    }
    @catch (NSException *exception) {
        NSLog(@"EmailComposer - Cannot set body; error: %@", exception);
    }

    // Set recipients
    @try {
        NSArray* toRecipientsArray = [parameters objectForKey:@"toRecipients"];
        if(toRecipientsArray) {
            [mailComposer setToRecipients:toRecipientsArray];
        }
    }
    @catch (NSException *exception) {
        NSLog(@"EmailComposer - Cannot set TO recipients; error: %@", exception);
    }

    @try {
        NSArray* ccRecipientsArray = [parameters objectForKey:@"ccRecipients"];
        if(ccRecipientsArray) {
            [mailComposer setCcRecipients:ccRecipientsArray];
        }
    }
    @catch (NSException *exception) {
        NSLog(@"EmailComposer - Cannot set CC recipients; error: %@", exception);
    }

    @try {
        NSArray* bccRecipientsArray = [parameters objectForKey:@"bccRecipients"];
        if(bccRecipientsArray) {
            [mailComposer setBccRecipients:bccRecipientsArray];
        }
    }
    @catch (NSException *exception) {
        NSLog(@"EmailComposer - Cannot set BCC recipients; error: %@", exception);
    }

    @try {
        int counter = 1;
        NSArray *attachmentPaths = [parameters objectForKey:@"attachments"];
        if (attachmentPaths) {
            for (NSString* path in attachmentPaths) {
                @try {
                    NSLog(@"setting the path: %@", path);
                    if ([path hasSuffix:@".pdf"]) {
                        NSData *data = [[NSFileManager defaultManager] contentsAtPath:path];
                        [mailComposer addAttachmentData:data mimeType:@"application/pdf" fileName:[NSString stringWithFormat:@"attachment%d.pdf", counter]];
                    } else {
                        // supposed image
                        UIImage *image = [UIImage imageWithContentsOfFile:path];
                        NSData *data = UIImagePNGRepresentation(image);
                        [mailComposer addAttachmentData:data mimeType:@"image/png" fileName:[NSString stringWithFormat:@"attachment%d.png", counter]];
                    }
                    counter++;
                }
                @catch (NSException *exception) {
                    NSLog(@"Cannot attach file at path %@; error: %@", path, exception);
                }
            }
        }
    }
    @catch (NSException *exception) {
        NSLog(@"EmailComposer - Cannot set attachments; error: %@", exception);
    }

    if (mailComposer != nil) {
        [self.viewController presentModalViewController:mailComposer animated:YES];
    } else {
        [self returnWithCode:RETURN_CODE_EMAIL_NOTSENT];
    }
    [mailComposer release];
} 
```

# jquery - IE（w jQuery）中的疯狂未指定错误警告..但重新加载时消失

> ID：13573416
> 
> 赞同：0
> 
> 时间：2012-11-26T21:25:38.833
> 
> 标签：jquery, internet-explorer-7, unspecified

除了我使用的是 IE8 以及在 IE8 浏览器模式和 IE8 文档模式下，不知道要提供什么，一切都很好。但是，当我处于 IE7 浏览器模式（使用 ie7 doc mod）或使用 IE7 文档模式的 IE8 模式时，我收到一个愚蠢的错误，指出“未指定的错误”

奇怪的是，当我重新加载页面时，它消失了，所有其他尾随 JS 工作得很好......所以我觉得我没有太多需要解决的问题。

未缩小版的 jQuery 链接起来，IE 的“惊人”调试给了我第 2321 行，即

```
ret = elem.getAttribute( name ); 
```

只是好奇其他人是否曾经有过类似的情况。

我将尝试找出首次页面加载 / IE7 / elem.getAttribute / jQuery 的问题；但这可能有点宽泛……甚至具有讽刺意味的是太具体了。

# apache-commons-fileupload - Apache Commons FileUpload 只保存文件的一部分

> ID：13573417
> 
> 赞同：0
> 
> 时间：2012-11-26T21:25:39.903
> 
> 标签：apache-commons-fileupload, gwtupload

我正在使用 gwt 小部件 gwtupload.client.Uploader，并且我正在尝试使用 fileupload 流 api 将文件保存到数据库中的 blob 列中。问题是，如果文件大于 3k，则只能保存 3k（以及 3.25K）。谢谢您的帮助。这是代码：

```
try {
    ServletFileUpload upload = new ServletFileUpload();
    upload.setProgressListener(listener);
    FileItemIterator iter = upload.getItemIterator(request);
    InputStream stream = null;
    while (iter.hasNext()) {
        FileItemStream item = iter.next();
        String name = item.getFieldName();
        stream = item.openStream();
        Object o = getThreadLocalRequest().getSession().getAttribute(PortailServiceIMPL.FICHIER_SESSION_STORE_KEY);
        if (o != null && o instanceof Fichier) {
            uploadService.sauvegarder((Fichier) o, stream);
            listener.update(listener.getContentLength(),
                    listener.getContentLength(), 0);
        } else {
            throw new RuntimeException(
                    "Impossible de recuperer le fichier de la session.");
        }
    }
    if (stream != null) {
        stream.close();
    }
} catch (SizeLimitExceededException e) {
    RuntimeException ex = new UploadSizeLimitException(
            e.getPermittedSize(), e.getActualSize());
    listener.setException(ex);
    throw ex;
} catch (UploadSizeLimitException e) {
    listener.setException(e);
    throw e;
} catch (UploadCanceledException e) {
    listener.setException(e);
    throw e;
} catch (UploadTimeoutException e) {
    listener.setException(e);
    throw e;
} catch (Exception e) {
    logger.error("UPLOAD-SERVLET (" + request.getSession().getId()
            + ") Unexpected Exception -> " + e.getMessage() + "\n"
            + stackTraceToString(e));
    e.printStackTrace();
    RuntimeException ex = new UploadException(e);
    listener.setException(ex);
    throw ex;
} 
```

保存文件的 lina 是：

```
uploadService.sauvegarder((Fichier) o, stream); 
```

在到达保存 InputStream 的代码之前有 4 种方法（未触及 InputStream）：

```
public void storeBlob(long id, InputStream pInputStream) throws Exception {
    try {

        java.sql.Connection conn = //get the connection;

        PreparedStatement ps = conn.prepareStatement(SQL_STORE);

        ps.setBinaryStream(1, pInputStream, pInputStream.available());
        ps.setLong(2, id);

        ps.executeUpdate();

        ps.close();

        em.getTransaction().commit();
    } catch (Throwable t) {
        em.getTransaction().rollback();
        throw new Exception(t);
    }

} 
```

如果我使用 FileItemFactory 它可以工作，但这不是我想要的：

```
FileItemFactory factory = new DiskFileItemFactory();
ServletFileUpload upload = new ServletFileUpload(factory);
List<FileItem> uploadedItems = upload.parseRequest(request);
    for (FileItem item : uploadedItems) {
        InputStream stream = item.getInputStream(); 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T19:35:53.607

经过一些工作，我解决了它。

在 storeBlob 方法中，我不能使用 pInputStream.available()。所以，这是我使用的线路：

```
ps.setBinaryStream(1, pInputStream); 
```

# php - 简单的 html dom 解析器 - 设置下拉值

> ID：13573418
> 
> 赞同：0
> 
> 时间：2012-11-26T21:25:41.073
> 
> 标签：php, parsing, dom

我有以下 html 标记：

```
<select id=gender>
    <option value=''>Please select</option>
    <option value='m'>male</option>
    <option value='f'>female</option>
</select> 
```

我想使用简单的 html dom 解析器设置值 - 这是我的代码 - 这不起作用：

```
$combo = $el->find("#gender",0);
$combo->value = "m"; 
```

我也试过`$combo->setAttribute('value', 'm');`没有成功

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:28:00.000

`<select>`没有`value`属性。您需要做的是找到您想要选择的选项（例如，类似`#gender/option[value='m']`）并在其`selected`上设置属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:28:04.520

为了将选中的选项设置出来`<select>`，你需要设置`selected`对应的`<option>`：

```
<select id=gender>
    <option value=''>Please select</option>
    <option value='m' selected>male</option>
    <option value='f'>female</option>
</select> 
```

# php - 无法在 wamp 中使用伪造的 sendmail 发送电子邮件

> ID：13573421
> 
> 赞同：3
> 
> 时间：2012-11-26T21:25:57.850
> 
> 标签：php, sendmail

我已经这样做了几个小时，但无法让它工作，教程中的许多评论说它就像一个魅力，但我不能真正做到这一点。

我已经完成了这里的所有步骤[http://blog.techwheels.net/send-email-from-localhost-wamp-server-using-sendmail/](http://blog.techwheels.net/send-email-from-localhost-wamp-server-using-sendmail/)并阅读了所有其他用户遇到的问题的评论，并使用了回复的解决方案。

我在 apache 错误日志上看到的是这个

```
[Tue Nov 27 05:19:47 2012] [notice] Parent: Created child process 4120
[Tue Nov 27 05:19:47 2012] [warn] Init: Session Cache is not configured [hint: SSLSessionCache]
[Tue Nov 27 05:19:48 2012] [notice] Child 4120: Child process is running
[Tue Nov 27 05:19:48 2012] [notice] Child 4120: Acquired the start mutex.
[Tue Nov 27 05:19:48 2012] [notice] Child 4120: Starting 64 worker threads.
[Tue Nov 27 05:19:48 2012] [notice] Child 4120: Starting thread to listen on port 80.
[Tue Nov 27 05:19:48 2012] [notice] Child 4120: Starting thread to listen on port 80. 
```

我也在我的另一台计算机上尝试过它，它具有相同的错误日志。我已经禁用了我的防火墙，并且严格按照教程中的步骤进行操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T10:57:15.630

抱歉之前的回答。感谢大家提出改进我的答案的建议。这是我的答案： phpmailer 有一个名为 class.phpmailer.php 的文件。然后在`function smtpmailer($to, $from, $from_name, $subject, $body)`代码中如下：

```
global $error;
$mail = new PHPMailer(); 
$mail->IsSMTP(); 
$mail->SMTPDebug = 0; 
$mail->SMTPAuth = true;  
$mail->SMTPSecure = 'ssl'; 
$mail->Host = 'smtp.gmail.com';
$mail->Port = 465; 
$mail->Username = 'gmailusername';  
$mail->Password = 'gmailpassword';           
$mail->SetFrom($from, $from_name);
$mail->Subject = $subject;
    $mail->IsHTML(True);
    $mail->Body=$body;
//$mail->Body = $body;
$mail->AddAddress($to);
if(!$mail->Send()) {
    $error = 'Mail error: '.$mail->ErrorInfo; 
    return false;
} else {
    $error = 'Message sent!';
    return true;
} 
```

然后只需在您想要的任何位置调用该函数： `smtpmailer($to, $from, $headers, $subject, $message);`

哦，在此之前确保启用 php_openssl 扩展。

我希望我的这个答案是有帮助的。:)

# c# - C#/WPF - 将 CornerRadius 添加到 ToggleButton

> ID：13573423
> 
> 赞同：1
> 
> 时间：2012-11-26T21:26:15.813
> 
> 标签：c#, wpf, xaml, cornerradius

我想使用我的 CornerRadius 属性创建一个带圆角的 ToggleButton。正如您在下面的代码中看到的，我已经向我的 xaml ToggleButton 添加了一个cornerRadius 属性来传递一个半径值。但是我找不到在 c# 中使用这个值来创建一个带圆角的 ToggleButton 的方法。

C＃

```
public static readonly DependencyProperty CornerRadiusProperty =
    DependencyProperty.Register("CornerRadius", typeof(int), typeof(MyToggleButton), 
    new PropertyMetadata(0)); //Default CornerRadius = 0

public int CornerRadius
{
   get { return (int)GetValue(CornerRadiusProperty); }
   set { SetValue(CornerRadiusProperty, value); }
} 
```

XAML

```
<custom:MyToggleButton Height="25" Content="Test" CornerRadius="15" /> 
```

那么如何使用我的属性“CornerRadius”创建一个带圆角的切换按钮？如果有人可以帮助我，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:30:45.947

我不会仅仅为了使它圆润而创建一个新控件——这就是模板的用途，这就是使 WPF 如此出色的原因！您可以简单地为`ToggleButton`.

如果您坚持继承自己的控件，则需要为其定义一个新的默认样式，该样式还将包括一个控件模板，该模板将具有使用您的`CornerRadius`属性的边框。您可以将新模板[基于`ToggleButton`](http://msdn.microsoft.com/en-us/library/ff468212.aspx).

# jquery - DropDownChoice 不显示选中的值

> ID：13573428
> 
> 赞同：0
> 
> 时间：2012-11-26T21:26:32.230
> 
> 标签：jquery, wicket, dropdownchoice

我有一个 DropDownChoice 框，它在 load() 上加载值列表，但是当我从列表中选择一个值时，所选值不会显示在框中，即使 getModelObject() 似乎确实检索并返回了正确的值（我选择的值）。只是框不显示而已。我使用 Wicket 6.3.0，使用码头服务器 6.1.26 和 FireFox 17.0、JQuery Mobile 1.2.0、JQuery 1.8.3 进行本地测试。有什么建议或想法吗？

这是检票口代码：

```
MetaProfile profile = null;
...
IModel<List<String>> oxeNodeModel = null;
oxeNodeModel = new LoadableDetachableModel<List<String>>() {
           private static final long serialVersionUID = 1L;
            @Override
            protected List<String> load() {
                    try {
                            List<String> names = getOXENodeList(); 
                            //load the OXE node list

                            if (names == null)
                                   return Collections.emptyList();
                            else {
                                    return names;
                            }

                    }catch (Exception e) {
                                  return Collections.emptyList();
                    }
            }
    };

    oxeNodeBox = new DropDownChoice("oxeNode",
            new PropertyModel<String>(profile, "oxeNodeName"), oxeNodeModel);

    oxeNodeBox.setEnabled(true);
    oxeNodeBox.setOutputMarkupId(true);
    add(oxeNodeBox); 
```

html模板是：

```
<tr id="oxeNodeRow" name="oxeNodeRow" style="display:none"> 
    <td align="right" nowrap class="fieldLabel"><label for="oxeNode" wicket:id="oxeNodeLabel" class="requiredLabel">OXE Node</label></td> 
    <td colspan="-1"><select id="oxeNode" name="oxeNode" wicket:id="oxeNode"> 
          <option selected>OXENode</option> </select>
    </td> 
</tr> 
```

我在同一个表单上有一堆 DropDownChoice 框有同样的问题。但是，表单的第一个 DropDownChoice 没有问题，即，一旦我从列表中进行选择，它就会显示选定的值。它的检票口代码和 html 标记如下。希望眼睛更敏锐的人能够发现可能引发问题的差异：

```
 profileTypeBox = new DropDownChoice<MetaProfileType>("type",
        new PropertyModel<MetaProfileType>(profile, "type"),
        Arrays.asList(MetaProfileType.values()),
        new IChoiceRenderer<MetaProfileType>() {
            private static final long serialVersionUID = 1L;
            @Override
            public Object getDisplayValue(MetaProfileType object) {
                return object.name();
            }
            @Override
            public String getIdValue(MetaProfileType object, int index) {
                return object.name();
            }
        }
    );
    profileTypeBox.setOutputMarkupId(true);
    add(profileTypeBox); 
```

html:

```
 <td colspan="-1"> <select id="profileType" name="profileType" wicket:id="type">
              <option>default</option>
            </select> </td> 
```

顺便说一句，我在这里也包括了 html 标头，以防万一它可能是问题，因为在我从旧的 css 标头（已注释掉）切换到标准的 jquery mobile 后出现了问题，包括：

```
 <html xmlns:wicket="http://wicket.apache.org/">
     <head>

      <!-- meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

     <link rel="stylesheet" type="text/css" href="css/custom.css" media="only screen and (max-width: 480px)"/>
     <link rel="stylesheet" type="text/css" href="css/default.css" media="only screen and (min-width: 1025px)"/>
     <link rel="stylesheet" type="text/css" href="css/portrait.css"
      media="all and (max-device-width: 1024px) and (orientation:portrait)"/>
     <link rel="stylesheet" type="text/css" href="css/landscape.css"
      media="all and (max-device-width: 1024px) and (orientation:landscape)"/>
     <meta name="viewport" content="user-scalable=no, width=device-width"/>
     <link rel="stylesheet" href="css/iphone-style-checkboxes.css" type="text/css"/>
     <script type="text/javascript" src="js/iphone-style-checkboxes.js"></script-->

     <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
     <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />  
     <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>  
     <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js">    </script>        

     </head> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T04:15:35.470

这似乎是一个 HTML 问题。

第一步：删除 colspan="-1"。那是无效的 HTML：[http ://www.w3.org/wiki/HTML/Elements/td](http://www.w3.org/wiki/HTML/Elements/td)

# java - jvm崩溃..没有足够的可用内存？(1.6)

> ID：13573430
> 
> 赞同：4
> 
> 时间：2012-11-26T21:26:48.223
> 
> 标签：java, jvm

我从崩溃日志中得到了这个..看起来当时可用内存超低（1020k），是不是内存太少造成的？

我有 10g RAM，我的 GC 设置是： `-Xmx5g -XX:NewRatio=3 -XX:CMSInitiatingOccupancyFraction=70 -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:+UseAdaptiveSizePolicy -XX:MaxGCPauseMillis=700`.

有人可以给我一些提示吗？谢谢！

```
# A fatal error has been detected by the Java Runtime Environment:
#
#  SIGSEGV (0xb) at pc=0x00007f220198ce10, pid=26470, tid=1154627904
#
# JRE version: 6.0_24-b07
# Java VM: Java HotSpot(TM) 64-Bit Server VM (19.1-b02 mixed mode linux-amd64 compressed oops)
# Problematic frame:
# J  com.twitter.typeahead.server.topic.TopicTypeAheadController$2.onSuccess(Lcom/twitter/typeahead/common/MetastoreResult;)V
#
# If you would like to submit a bug report, please visit:
#   http://java.sun.com/webapps/bugreport/crash.jsp
#

Current thread (0x00007f21f2ce0800):  JavaThread "New I/O client worker #1-18" [_thread_in_Java, id=26628, stack(0x0000000044c23000,0x0000000044d24000)]

siginfo:si_signo=SIGSEGV: si_errno=0, si_code=2 (SEGV_ACCERR), si_addr=0x00007f2200e4616a

Registers:
RAX=0x00000006bae61950, RBX=0x00000007fafe2be0, RCX=0x0000000000000000, RDX=0x00000006bbe2d580
RSP=0x0000000044d22180, RBP=0x00000006bae61950, RSI=0x00000006bae61950, RDI=0x00007f220198ccf0
R8 =0x00000000d77c5ab0, R9 =0x00000006bbd0a190, R10=0x00000000035df16a, R11=0x00007f21fd867000
R12=0x0000000000000000, R13=0x0000000044d22180, R14=0x0000000000000001, R15=0x00007f21f2ce0800
RIP=0x00007f220198ce10, EFL=0x0000000000010207, CSGSFS=0x0000000000000033, ERR=0x0000000000000006
  TRAPNO=0x000000000000000e

Register to memory mapping:

RAX=0x00000006bae61950

[error occurred during error reporting (printing registers, top of stack, instructions near pc), id 0xb]

Stack: [0x0000000044c23000,0x0000000044d24000],  sp=0x0000000044d22180,  free space=1020k
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:10:24.620

I don't think you are running out of memory. This is an error for a segfault in the JVM.

Try reading these stackoverflow posts. They should point you in the right direction:

[Java VM: reproducable SIGSEGV on both 1.6.0_17 and 1.6.0_18, how to report?](https://stackoverflow.com/questions/2299250/java-vm-reproducable-sigsegv-on-both-1-6-0-17-and-1-6-0-18-how-to-report)

[how to debug SIGSEGV in jvm GCTaskThread](https://stackoverflow.com/questions/4645870/how-to-debug-sigsegv-in-jvm-gctaskthread)

Well unless the JVM has a bug where it is hitting a segfault or a buffer overrun without first crashing on not enough stack memory remaining, try setting -Xss (the per thread stack size) to a higher value.

# javascript - 未在具有父滚动 div 的选择元素上触发滚动

> ID：13573431
> 
> 赞同：1
> 
> 时间：2012-11-26T21:26:56.297
> 
> 标签：javascript, jquery, css

因此，尽管我试图在网上找到一些东西来回答这个问题，但我没有运气。我一直在尝试创建一种“主要”的 css 方法来将水平滚动添加到选择列表中。

但是，如果我在可滚动容器内有一个选择，其中容器高度小于选择的高度（触发外部容器上的垂直滚动），那么***滚动***行为要么*不稳定*（在正常选择的情况下）或者在 IE 或 Chrome 中*根本没有*（在向选择添加`multiple="multiple"`属性的情况下）。但是，它似乎在 FireFox 中运行正常

**问题：**是否有任何 css/html 结构解决方法？任何替代的 jQuery/js 解决方法？

[http://jsfiddle.net/Qn6TH/3/](http://jsfiddle.net/Qn6TH/3/)

```
div.ScrollableSelect { overflow: auto; }
#availableCodes { width: 600px; height: 1715px; }

<div class="ScrollableSelect" style="width: 300px; height: 300px">
    <select id="availableCodes" multiple="multiple">
    </select>
</div> 
```

# java - 带有换行符的字符串中的 JAVA 最长模式匹配

> ID：13573432
> 
> 赞同：0
> 
> 时间：2012-11-26T21:26:58.090
> 
> 标签：java, regex, pattern-matching, line-breaks

如何匹配具有换行符的字符串中的模式？例如

```
requisition({"title":"my json",
             "items" : [{ "A": "a",
                          "B": "b"}
                       ]
            }) 
```

我只想抓住这个

```
{"title":"my json",
             "items" : [{ "A": "a",
                          "B": "b"}
                       ]
} 
```

我尝试了类似的东西

```
String pattern = ".*(\\{.*\\}).*";
Pattern r = Pattern.compile(pattern, Pattern.DOTALL); 
```

但没有成功。有什么建议吗？

只是为了更清楚。这是我的[输入](http://api.flickr.com/services/feeds/photos_public.gne?format=json)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:46:45.007

将单个 JSON 对象作为输入的问题很简单：您的第一个`.*`是贪婪的。所以它会消耗所有东西，直到最后一个`{`仍然跟着 a `}`。如果你不`.*`贪心（或忽略它），你应该得到完整的 JSON 对象：

```
String pattern = ".*?(\\{.*\\}).*"; 
```

但是您可以（并且应该）完全省略开头和结尾的重复：

```
String pattern = "\\{.*\\}"; 
```

然后你甚至不需要捕捉任何东西。请注意，这必须与`find`而不是一起使用`matches`。

但是，您的输入有多个 JSON 对象。这就是您遇到正则表达式问题的地方。一些引擎支持允许正确嵌套括号的结构（检查哪些实际上属于一起）。但是这些正则表达式很容易变得丑陋且不可维护。

你最好手动遍历字符串，并保持当前嵌套级别的计数。每当您回到顶层时，您只需切断一个子字符串（从相应的左括号到您当前的位置）。

# jquery - 如何在 d3 中重新渲染 SVG？

> ID：13573433
> 
> 赞同：2
> 
> 时间：2012-11-26T21:27:06.727
> 
> 标签：jquery, svg, hyperlink, d3.js, calendar

我正在调整位于此处的 d3 示例日历：http: [//bl.ocks.org/4063318](http://bl.ocks.org/4063318)

![在此处输入图像描述](../Images/117451ce8cdb8865585305a70e97608f.png)

我正在努力让日历中的每一天都被超链接。

为此，我在每个“矩形”周围添加了一个锚标记，如下所示：

```
var rect = svg.selectAll(".day")
  .data(function(d) { return d3.time.days(new Date(d, 0, 1), new Date(d + 1, 0, 1)); })
  .enter()
  .append("a")                                   //my new line of code
  .attr("xlink:href", "http://stackoverflow.com") //my new line of code
  .append("rect")
  .attr("class", "day")
  .attr("width", cellSize)
  .attr("height", cellSize)
  .attr("x", function(d) { return week(d) * cellSize; })
  .attr("y", function(d) { return day(d) * cellSize; })
  .datum(format); 
```

这会将每个矩形链接到该网站。但是，我希望链接依赖于数据。所以，而不是上面的行：

```
 .attr("xlink:href", "http://stackoverflow.com") //my new line of code 
```

我用：

```
 .attr("class", "rectAnchor") 
```

我这样做是为了选择 rectAnchor，然后访问他们的 rect 子节点，然后在以下代码中设置 xlink:href 属性，如下所示：

```
d3.csv("dji.csv", function(error, csv) {
  var data = d3.nest()
    .key(function(d) { return d.Date; })
    .rollup(function(d) { return (d[0].Close - d[0].Open) / d[0].Open; })
    .map(csv);

  rect.filter(function(d) { return d in data; })
      .attr("class", function(d) { return "day " + color(data[d]); })
      .attr("dyanmiclinktext", function(d) { return data[d]; })  //my new line of code
      .select("title")
      .text(function(d) { return d + ": " + percent(data[d]); });

  $(".rectAnchor")                                       //my new line
  .attr("xlink:href", function(){                             //my new line
     return "http:/127.0.0.1/subdir/" + $(this).children("rect").attr("dynamiclinktext"); //my new line
  });

}); 
```

现在，当我这样做时，没有可用的超链接，另外两件不受欢迎的事情发生了：首先，锚标记内的链接说 xlink:href"URL" 而不是 href:"URL" 。其次，如果我将 .attr("xlink:href", function(){ 行更改为 .attr("href", function(){ ，它仍然不起作用。所以，我想知道，这是因为svg 已经被渲染，我需要用这些新的和改进的锚标签重新渲染它？或者我还缺少什么？任何帮助表示感谢。谢谢！

***附录：***

```
 $(".rectAnchor").attr("xlink:href", "http:/127.0.0.1/subdir/" + $(this).children("rect").attr("finer")); 
```

生成：

```
<a class="rectAnchor" xlink:href="http:/127.0.0.1/subdir/undefined">
<rect class="day" width="17" height="17" x="170" y="51" finer="group1" fill="#aec7e8">
<title>2012-03-13: group1</title>
</rect>
</a> 
```

（注意 undefined 和 'xlink:href' 而不仅仅是 'href'）

```
 $(".rectAnchor").attr("xlink:href", function(d) { return "http:/127.0.0.1/subdir/" + $(this).children("rect").attr("finer");}); 
```

生成：

```
 <a class="rectAnchor" xlink:href="http:/127.0.0.1/subdir/group2">
 <rect class="day" width="17" height="17" x="153" y="34" finer="group2" fill="#aec7e8">
 <title>2012-03-05: group2</title>
 </rect>
 </a> 
```

在显示的 svg 中都没有超链接（即鼠标指针没有区别，单击没有任何作用。）在 2 种情况下，我还将 'xlink:href' 更改为 'href'。这与上面的输出相同，但缺少“xlink：”。然而，和以前一样，没有任何东西是超链接的。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T00:36:37.510

在您使用的地方`$(".rectAnchor")`，您现在处于 jQuery 世界——而不是 d3 世界。

jQuery 中的`attr()`函数不适用于函数，例如 d3 的`attr()`.

你只需要：

```
$(".rectAnchor").attr(
  "xlink:href",
  "http:/127.0.0.1/subdir/" + $(this).children("rect").attr("dynamiclinktext")
); 
```

假设没有其他问题，这应该有效。

**编辑：**

实际上，我没有注意到`$(".rectAnchor")`产生多个元素。你需要混合你之前的尝试和我上面的建议：

```
$(".rectAnchor").each(function(i, element) {
    var $el = $(element);// $(this) would work too
    $el.attr("xlink:href", "http://127.0.0.1/subdir/" + $el.children("rect").attr("dynamiclinktext"));
}); 
```

请注意，`http:/127...`您实际需要`http://127....`的位置（即您缺少斜线）。

最后，您确定用`<a>`标签包装 SVG 元素实际上可以使它们成为链接吗？可能会，但我从未尝试过。如果您不确定，您应该尝试使用手动生成的 SVG（即没有 javascript）作为独立测试（例如在 jsFiddle 中）。

# ruby-on-rails-3 - rmagick 宝石警告

> ID：13573436
> 
> 赞同：6
> 
> 时间：2012-11-26T21:27:14.930
> 
> 标签：ruby-on-rails-3, rmagick

由于我安装了 rmagick gem，因此在每个 rails 或 rake 命令之后都会收到以下警告列表：

```
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:44: warning: already initialized constant PercentGeometry
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:45: warning: already initialized constant AspectGeometry
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:46: warning: already initialized constant LessGeometry
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:47: warning: already initialized constant GreaterGeometry
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:48: warning: already initialized constant AreaGeometry
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:49: warning: already initialized constant MinimumGeometry
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:52: warning: already initialized constant FLAGS
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:53: warning: already initialized constant RFLAGS
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:92: warning: already initialized constant W
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:93: warning: already initialized constant H
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:94: warning: already initialized constant X
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:95: warning: already initialized constant Y
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:96: warning: already initialized constant RE
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:147: warning: already initialized constant ALIGN_TYPE_NAMES
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:152: warning: already initialized constant ANCHOR_TYPE_NAMES
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:157: warning: already initialized constant DECORATION_TYPE_NAMES
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:163: warning: already initialized constant FONT_WEIGHT_NAMES
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:170: warning: already initialized constant GRAVITY_NAMES
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:181: warning: already initialized constant PAINT_METHOD_NAMES
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:188: warning: already initialized constant STRETCH_TYPE_NAMES
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:200: warning: already initialized constant STYLE_TYPE_NAMES
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:673: warning: already initialized constant Model_Version
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:674: warning: already initialized constant Destination
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:675: warning: already initialized constant File_Format
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:676: warning: already initialized constant File_Format_Version
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:677: warning: already initialized constant Service_Identifier
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:678: warning: already initialized constant Envelope_Number
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:679: warning: already initialized constant Product_ID
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:680: warning: already initialized constant Envelope_Priority
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:681: warning: already initialized constant Date_Sent
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:682: warning: already initialized constant Time_Sent
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:683: warning: already initialized constant Coded_Character_Set
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:684: warning: already initialized constant UNO
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:685: warning: already initialized constant Unique_Name_of_Object
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:686: warning: already initialized constant ARM_Identifier
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:687: warning: already initialized constant ARM_Version
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:691: warning: already initialized constant Record_Version
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:692: warning: already initialized constant Object_Type_Reference
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:693: warning: already initialized constant Object_Name
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:694: warning: already initialized constant Title
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:695: warning: already initialized constant Edit_Status
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:696: warning: already initialized constant Editorial_Update
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:697: warning: already initialized constant Urgency
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:698: warning: already initialized constant Subject_Reference
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:699: warning: already initialized constant Category
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:700: warning: already initialized constant Supplemental_Category
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:701: warning: already initialized constant Fixture_Identifier
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:702: warning: already initialized constant Keywords
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:703: warning: already initialized constant Content_Location_Code
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:704: warning: already initialized constant Content_Location_Name
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:705: warning: already initialized constant Release_Date
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:706: warning: already initialized constant Release_Time
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:707: warning: already initialized constant Expiration_Date
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:708: warning: already initialized constant Expiration_Time
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:709: warning: already initialized constant Special_Instructions
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:710: warning: already initialized constant Action_Advised
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:711: warning: already initialized constant Reference_Service
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:712: warning: already initialized constant Reference_Date
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:713: warning: already initialized constant Reference_Number
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:714: warning: already initialized constant Date_Created
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:715: warning: already initialized constant Time_Created
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:716: warning: already initialized constant Digital_Creation_Date
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:717: warning: already initialized constant Digital_Creation_Time
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:718: warning: already initialized constant Originating_Program
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:719: warning: already initialized constant Program_Version
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:720: warning: already initialized constant Object_Cycle
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:721: warning: already initialized constant By_Line
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:722: warning: already initialized constant Author
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:723: warning: already initialized constant By_Line_Title
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:724: warning: already initialized constant Author_Position
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:725: warning: already initialized constant City
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:726: warning: already initialized constant Sub_Location
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:727: warning: already initialized constant Province
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:728: warning: already initialized constant State
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:729: warning: already initialized constant Country_Primary_Location_Code
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:730: warning: already initialized constant Country_Primary_Location_Name
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:731: warning: already initialized constant Original_Transmission_Reference
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:732: warning: already initialized constant Headline
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:733: warning: already initialized constant Credit
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:734: warning: already initialized constant Source
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:735: warning: already initialized constant Copyright_Notice
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:736: warning: already initialized constant Contact
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:737: warning: already initialized constant Abstract
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:738: warning: already initialized constant Caption
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:739: warning: already initialized constant Editor
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:740: warning: already initialized constant Caption_Writer
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:741: warning: already initialized constant Rasterized_Caption
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:742: warning: already initialized constant Image_Type
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:743: warning: already initialized constant Image_Orientation
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:744: warning: already initialized constant Language_Identifier
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:745: warning: already initialized constant Audio_Type
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:746: warning: already initialized constant Audio_Sampling_Rate
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:747: warning: already initialized constant Audio_Sampling_Resolution
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:748: warning: already initialized constant Audio_Duration
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:749: warning: already initialized constant Audio_Outcue
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:750: warning: already initialized constant ObjectData_Preview_File_Format
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:751: warning: already initialized constant ObjectData_Preview_File_Format_Version
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:752: warning: already initialized constant ObjectData_Preview_Data
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:756: warning: already initialized constant Size_Mode
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:757: warning: already initialized constant Max_Subfile_Size
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:758: warning: already initialized constant ObjectData_Size_Announced
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:759: warning: already initialized constant Maximum_ObjectData_Size
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:763: warning: already initialized constant Subfile
/Users/joel/.rvm/gems/ruby-1.9.2-p290/gems/rmagick-2.13.1/lib/RMagick.rb:767: warning: already initialized constant Confirmed_ObjectData_Size 
```

有这方面的线索吗？

更新

我的宝石文件：

```
 gem "rmagick", "~> 2.13.1"
 gem 'link_thumbnailer' 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2014-04-03T15:49:12.577

`rmagick`您可以将`Gemfile`相应的行替换为：

```
gem 'rmagick', require: false 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-11T23:15:52.870

重新初始化常量的原因很可能是因为`rmagick`gem 被加载了两次：一次是`link_thumbnailer`（在您的 Gemfile 中）的依赖项，一次是因为您将 'rmagick' 明确列为 Gemfile 要求。

尝试`rmagick`从您的 Gemfile 中删除该条目，只要您正在使用它就会被加载`link_thumbnailer`

# javascript - 在动态创建的 html 中嵌入 javascript 对象

> ID：13573439
> 
> 赞同：0
> 
> 时间：2012-11-26T21:27:27.520
> 
> 标签：javascript, jquery

我有一个接收项目数组的 js 函数。该函数本身使用对 jquery html 函数的调用来动态创建 html 内容。问题是我不记得如何在附加的 html 中正确嵌入数组。例如，

```
var ErrorsNotifier = {
   init: function(items) {
        var template = '<div id="message">'; 
        template += '<div id="id">some message.<br /><br />'; 
        template += '<div class="errorsList">error desc</div></div>'; 
        template += '<a href="#" class="goback" onclick="ErrorsNotifier.Back("+items+");"></a>'; 
        template += '<a href="#" class="proceed" onclick="ErrorsNotifier.Next();"></a>'; 
        template += '<input type="image" src="someimage" alt="" class="" onclick="window.open("someurl");"/></div>'; 
        $("#content").html(template);
   }
} 
```

html会渲染到body之后，点击anchor标签返回如下错误——`Uncaught SyntaxError: Unexpected identifier`

检查浏览器中的锚标记将显示以下内容

```
a href="#" class="goback" onclick="ErrorsNotifier.Back([object Object]);" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:32:30.763

尝试

```
var ErrorsNotifier = {
   init: function(items) {
       ...
       var $template = $(template);
       $template.find('a.goback').on('click', function(){ErrorsNotifier.Back(items);});
       $("#content").empty().append($template);
   }
} 
```

注意我曾经`.on()`附加事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T21:40:40.290

```
var ErrorsNotifier = {
 init: function(items) {
    var template = '<a href="#" class="goback" onclick="ErrorsNotifier.Back(\''+items+'\');">Link</a>';
    $("#content").html(template);
   },
 Back: function(x){ alert(x); }
}; 
```

检查这个

# c# - 跨域的 NetTcpBinding

> ID：13573440
> 
> 赞同：1
> 
> 时间：2012-11-26T21:27:39.827
> 
> 标签：c#, wcf, cross-domain, nettcpbinding

我对这一切都很陌生，所以我什至不知道我应该问什么问题。

*   我在域 A 上有 WCF 服务。
*   它将从域 B 调用。
*   域 B 不受域 A 的信任。

我很确定我的 clientCredentialType 不能是“windows”。

我如何让他们交谈并相互验证？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:06:05.087

您是正确的，带有 Windows 身份验证的 Net Tcp 绑定在互不信任的域之间不起作用。

您至少有 2 个选择：

*   邮件标题中的用户名和密码
*   预装的证书

# android - 持久化数据结构的输入

> ID：13573442
> 
> 赞同：0
> 
> 时间：2012-11-26T21:28:03.870
> 
> 标签：android, web-services, arraylist, xml-serialization

我有一个读取 XML 文件并向用户提供一些信息的 android 应用程序。数据结构是一个简单的ArrayList。用户浏览列表，他们可能会进行更改，也可能不会仅根据情况进行更改。完成后，他们保存。

最终我们想要 RDBMS 上的数据，但他们可能在那一刻没有数据连接，所以我需要持久化它。即使他们确实有数据连接，我知道我已经将数据结构序列化到了 sd 卡上，我可能会感到很自在。

所以第一步是我将它保持在二进制状态（它是一个非常小的数据对象）还是将它序列化为 XML，这是我最初的想法。这样，它就可以以 xml 形式上传到 Web 服务。

如果我将其序列化为 XML，是否有任何我可以阅读的库/示例。我使用 SAX 来解析它，但我认为必须有类似简单的重载才能将其转储出来？？？？

伪代码：

```
ArrayList<MyOb>;
MyObj.Serialize("doc.xml"); 
```

如果我将它保持在二进制状态，当用户确实有数据连接并且是时候上传时，我需要考虑哪些步骤。

TIA JB

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T19:02:30.223

您可以使用一个很棒的库**JAXB（用于 XML 绑定的 Java 架构**）

**JAVA Beans <---> XML 数据**

[JAXB 基础教程](http://www.mkyong.com/java/jaxb-hello-world-example/)

下面是一些示例代码，让您体验一下

```
@XmlRootElement
public class Customer {

    String name;
    int age;
    int id;

    public String getName() {
        return name;
    }

    @XmlElement
    public void setName(String name) {
        this.name = name;
    }

    public int getAge() {
        return age;
    }

    @XmlElement
    public void setAge(int age) {
        this.age = age;
    }

    public int getId() {
        return id;
    }

    @XmlAttribute
    public void setId(int id) {
        this.id = id;
    }

} 
```

使用此代码形成的 XML：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<customer id="100">
    <age>29</age>
    <name>mkyong</name>
</customer> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:38:16.297

我打算将数据作为 xml 保存在 sdcard 上。这是我能辨别的最好的方法。

# c++ - 无法在 windows xp 上编译 rsa.h

> ID：13573445
> 
> 赞同：2
> 
> 时间：2012-11-26T21:28:11.000
> 
> 标签：c++, windows, openssl, rsa, codeblocks

我遇到过 openssl 的惊喜。我已经在我的 Windows XP 上安装了 openssl 库，并尝试在 C++ 上编译简单的示例：

```
#include <openssl\rsa.h>
#include <stdio.h>
int main(int argc, char** argv)
{
    RSA* rsa;
    unsigned char* input_string;
    unsigned char* encrypt_string;
    unsigned char* decrypt_string;

    if ( RSA_generate_key_ex( rsa, 1024, NULL, NULL) ) {
        printf( " I'm using RSA lib!\n" ) ;
    } ;

    return 0;
} 
```

我还配置了“包含”文件夹的路径，但是...

```
C:\Programming\C++_Projects\main.o:main.cpp|| undefined reference to `RSA_generate_key_ex'|
||=== Build finished: 1 errors, 0 warnings ===| 
```

我正在使用代码块，谷歌无法帮助我。我很难过。你可以帮帮我吗？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:32:51.453

您必须告诉编译器链接到 openssl 库。

在 CodeBlocks 中，您的项目设置中肯定有一个标签库（或类似的东西），您可以在其中添加 openssl 库。

# css - 如何在响应式布局中使用 CSS Sprite？

> ID：13573449
> 
> 赞同：2
> 
> 时间：2012-11-26T21:28:28.023
> 
> 标签：css, responsive-design, sprite

围绕我的问题有几个问题，但没有一个答案与我正在尝试做的事情有关。我通过使用锚标记上的类来为我的网站徽标使用精灵。问题是我必须定义像素高度和宽度，这会阻止徽标响应。

这是HTML：

```
<a href="<?php echo get_option('home'); ?>/" class="logo-sprite"></a> 
```

这是CSS：

```
a.logo-sprite {
    background: url('image_here.jpg') 0 0;
    display: block;
    width: 450px;
    height: 130px;
}

a.logo-sprite:hover {
    background: url('image_here2.jpg') 0 -140px;
} 
```

有什么想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T21:31:16.613

这是正确的。由于精灵，根据定义仅适用于固定尺寸（它们毕竟是图像），它们不能“流畅”地用于流体/响应式布局。

只要您不断调整媒体查询中的每个“级别”，它们就可以用于响应式布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T21:41:28.757

好吧，我有个主意。

您可以使用该`background-size`属性将精灵“锁定”到位并停止显示比您想要的更多/更少。这是一个基本的例子：

```
background-position: 0px 0px;
background-repeat: no-repeat;
background-size: 190% 140%; 
```

这里唯一的问题是图像的大小与`Div`s 和锚点等元素不同，因此高度不会动态缩放。我相信实现这一目标的唯一方法是使用 JavaScript，但我可能错了。

下面是一个粗略的例子，说明你如何开始这样的事情：http: [//jsfiddle.net/VW2dW/16/](http://jsfiddle.net/VW2dW/16/) 如果你调整浏览器的大小，你会注意到它成功地水平缩放但不是垂直缩放，这是一个问题。

# mysql - SQL 注入预防

> ID：13573458
> 
> 赞同：4
> 
> 时间：2012-11-26T21:28:53.743
> 
> 标签：mysql, sql, asp-classic, sql-injection

我目前正在处理一个遗留的 ASP 项目，其中安全性现在已成为一个大问题。它不仅是不安全的加密方法（md5），而且我担心 SQL 注入问题。我还不太擅长注射，我只尝试了我所知道的基础知识。我找到了“保护”任何用户输入的功能，但我想知道它是否真的在做任何事情来防止注入攻击。这是功能：

```
function sqlfix(input)
    if not isnull(input) and input <> "" then
        input = replace(input, ";", "&#59;")
        input = replace(input, "'", "&#39;")
        input = replace(input, """", "&#34;")
        input = replace(input, "(", "&#40;")
        input = replace(input, ")", "&#41;")
        input = replace(input, "|", "&#124;")
        input = replace(input, "<", "&#60;")
        input = replace(input, ">", "&#62;")
        input = replace(input , "'", "''")
        'input = Server.HTMLEncode(input)
        'input = Server.UrlEncode(input)
        sqlfix = input
    else
        sqlfix = ""
    end if
end function 
```

我记得很多年前我第一次使用 mysql_* 函数启动 PHP 时做过类似的事情，但现在我已经转向 PDO 和参数绑定。但是我不知道这对于 ASP 应用程序有多安全。感谢您的任何意见。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T21:36:33.263

不要陷入字符串插值陷阱！它不安全。

即使在 ASP Classic 中，您也可以使用真正的 SQL 查询参数。

我不是 ASP 程序员，但我发现这个博客有一个清晰的示例，说明使用 ADODB.Command 对象进行参数化 SQL 查询，并在执行之前将值绑定到参数。

[http://securestate.blogspot.com/2008/09/classic-asp-sql-injection-prevention_30.html](http://securestate.blogspot.com/2008/09/classic-asp-sql-injection-prevention_30.html)

另请参阅此 SO question，了解更多使用命名参数的示例：

[参数化查询中的 ASP 经典命名参数：必须声明标量变量](https://stackoverflow.com/questions/1092512/asp-classic-named-parameter-in-paramaterized-query-must-declare-the-scalar-vari)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T21:41:02.617

这与 ASP Classic 中的 PDO 最接近...

```
with createobject("adodb.command")
    .activeConnection = application("connectionstring")
    .commandText = "select * from sometable where id=?"
    set rs = .execute( ,array(123))
end with 
```

[如何在经典 asp 中创建一个准备好的语句来防止 sql 注入？](https://stackoverflow.com/questions/8538979/how-can-i-make-a-prepared-statement-in-classic-asp-that-prevents-sql-injection)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T21:36:48.330

线

```
input = replace(input , "'", "''") 
```

正在做大部分工作。我为安全站点所做的是为每种数据类型提供了几个不同的功能

```
fn_validstring replacing single quotes
fn_validnumber testing isnumeric 
fn_validint leveraging fn_validnumber and rounding
fn_bool 
etc ... 
```

无论如何，用存储过程替换动态并删除除执行之外的所有权限都可以保护环境。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T21:32:03.370

PDO 和预处理语句是防止 SQL 注入的最佳方法。像上面的代码那样手写 SQL 清理代码要危险得多，因为你很容易错过很多东西。

使用准备好的语句将使 SQL 语句安全。

# lucene - 指定字段时Lucene不给出结果

> ID：13573459
> 
> 赞同：0
> 
> 时间：2012-11-26T21:28:57.893
> 
> 标签：lucene, field, pylucene

我有一个数据库，我使用 lucene 的字段按部分（由文档中的标记指定）在 Lucene（使用 Pylucene）中建立了索引。这个索引似乎工作正常。我可以使用简单的整个文档的默认字段搜索它并获得合理的结果。

问题是，当我使用特定部分（不是默认部分）搜索它时，我希望得到一定数量的结果（由 指定`IndexSearcher.search(query, results)`），但它可能只是什么都不返回。所以我的问题是：我怎样才能让它返回一个包含我指定的结果数量的排名列表？

我指定该字段的唯一位置是在 QueryParser 中，通过调用：

```
QueryParser(Version.LUCENE_CURRENT, field, StandardAnalyzer) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:20:42.353

我会使用[Luke](http://code.google.com/p/luke/)来验证索引（这是我在修改索引策略时经常做的事情）。

# jquery - Javascript 在 active_admin 中不起作用

> ID：13573461
> 
> 赞同：0
> 
> 时间：2012-11-26T21:29:23.413
> 
> 标签：jquery, ruby-on-rails, coffeescript, activeadmin

所以我正在为 ActiveAdmin 表单构建一组 Markdown 助手。到目前为止，我只有斜体字。

```
#form.html.erb
# ... some form code
    <%= link_to "i", "#", :class => "btn", :id => "italics_button" %>
    <%= f.input :body %>
# ... rest of form omitted 
```

这给了我一个 ID 为“italics_button”的按钮和一个 ID 为 post_body 的 textarea。到目前为止，一切都很好。

现在我有一个咖啡脚本文件来处理将选定文本包装在给定标签中。

```
#posts.js.coffee
wrapText = (elementID, openTag, closeTag) ->
  textArea = $("##{elementID}") #select the text area
  len = textArea.val().length #total length of the text area
  start = textArea[0].selectionStart # start of the selected text
  end = textArea[0].selectionEnd # end of the selected text
  selectedText = textArea.val().substring(start, end) # The selected Text
  replacement = openTag + selectedText + closeTag # string with the selected text wrapped in the bbcode
  textArea.val(textArea.val().substring(0,start) + replacement + textArea.val().substring(end, len)) # perform the replacement

$('#italics_button').click (event) ->
  event.preventDefault()
  wrapText('post_body', '*', '*') 
```

我相当有信心这段代码是可以的，因为我从几个月前的一个项目中把它撕下来了，我在一个普通的非 AA 表单上做了同样的事情。

我更新了初始化程序以引入自定义 javascript：

```
# active_admin.rb
# rest of file omitted
config.register_javascript 'posts.js.coffee' 
```

最后，我可以在 Active Admin 的 New Post 页面上看到，包含并编译了 javascript 文件。

但是，javascript 事件似乎没有被调用。当我单击#italics_button 时，页面尝试跟随指向“#”的链接，并且 javascript 不运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:27:29.277

这将在浏览器看到它后立即执行：

```
$('#italics_button').click (event) ->
  event.preventDefault()
  wrapText('post_body', '*', '*') 
```

你的 CoffeeScript 可能会被加载到页面的元素中，所以当你没有回调时，DOM 中`<head>`可能不会有任何内容。`#italics_button``$('#italics_button').click(...)`

您可以尝试通常的“文档准备就绪时运行方法”：

```
$ ->
  $('#italics_button').click (event) ->
    event.preventDefault()
    wrapText('post_body', '*', '*') 
```

或者您可以使用“实时”处理程序：

```
$(document).on('click', '#italics_button', (event) ->
    event.preventDefault()
    wrapText('post_body', '*', '*')
) 
```

`#italics_button`如果在服务器将页面发送到浏览器之后动态添加，后者将很有用。

# jquery - 使用 jquery.chained.js ， this.form.submit() ，选择框

> ID：13573462
> 
> 赞同：0
> 
> 时间：2012-11-26T21:29:23.337
> 
> 标签：jquery, drop-down-menu, chained

我是 jquery 的初学者，在组合 jquery.chained.js 并让选择框相互连接以在更改时提交时遇到问题。

我有：

> $(文档).ready(函数(){
> 
> $("#filter_category").chainedTo("#filter_type");
> 
> });

```
<form id="filter_form" name="filter_form" method="get" action="">
<select name="filter_type" id="filter_type" onchange="this.form.submit()"> 
<select name="filter_category" id="filter_category" onchange="this.form.submit()">
</form> 
```

但是，页面只是自动提交表单，我怀疑它与 $(document).ready(function() 部分有关，但是，我对 jquery 的技能非常有限，无法弄清楚阻止这种情况发生的方法。

任何帮助都会很棒。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T21:54:13.777

我发现这段代码似乎有效，这是最好的方法吗？

```
$(function () {
$("#filter_category").live("change keyup", function () {
    $("#filter_form").submit();
});
}); 
```

# android - 强制使用 ActionBarSherlock 的应用程序使用 Theme 而不是 Theme.Holo

> ID：13573466
> 
> 赞同：3
> 
> 时间：2012-11-26T21:29:48.450
> 
> 标签：android, actionbarsherlock, android-4.0-ice-cream-sandwich, android-theme

我有一个最初为 Android 2.3 设计的应用程序。现在我正在添加一个带有 ActionBarSherlock 的 ActionBar，一切都很好，除了我的 Nexus 7 运行 4.2，它现在使用 Holo 主题作为按钮和 EditTexts。之前我的主题是从 Theme.Light 继承的，现在它是从 Theme.Sherlock 继承的。我希望它即使在较新的设备上也能使用旧主题。我怀疑这是由 values-v14 文件夹中的以下行引起的：

```
<style name="Sherlock.__Theme" parent="android:Theme.Holo"> 
```

所以我尝试删除那个文件夹和 v11 文件夹，看看它是否能解决问题，但后来 ActionBar 完全消失了。

然后我尝试像这样覆盖 EditText 的样式：

```
<style name="AppTheme" parent="Theme.Sherlock">
    <item name="@android:attr/editTextStyle">@android:style/Widget.EditText</item>
</style> 
```

那应该使小部件不使用 Widget.Holo 主题并使用常规主题，但它不起作用。

如何让 Android 4.0+ 设备在使用 ABS 时使用原始主题而不是 Holo 主题？

下面我发布了一些使用 ABS 的示例应用程序的代码，该示例应用程序当前显示以 Holo 为主题的 EditText，但应该显示常规的 EditText：

MainActivity.java：

```
import android.os.Bundle;

import com.actionbarsherlock.app.SherlockActivity;
import com.actionbarsherlock.view.Menu;

public class MainActivity extends SherlockActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getSupportMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

活动主.xml：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="@string/hello_world"
        tools:context=".MainActivity" />
    <EditText 
        android:layout_height="match_parent"
        android:layout_width="match_parent"/>

</RelativeLayout> 
```

样式.xml：

```
<resources xmlns:android="http://schemas.android.com/apk/res/android">

    <style name="AppTheme" parent="Theme.Sherlock">
        <item name="@android:attr/editTextStyle">@android:style/Widget.EditText</item>
    </style>

</resources> 
```

此外，manifest 中的主题是 AppTheme，ABS 被添加为库项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T00:03:42.007

这不会是由 ActionBarSherlock 引起的`EditText`，`Button`主题是由您正在运行的平台定义的，在本例中为 4.2。 `EditTexts`并且`Buttons`还可能根据 UI 皮肤（TouchWiz、Sense、MotoBlur 等）看起来不同。

我建议将 Holo 主题保留在支持它的设备上，因为用户会熟悉它，并且在 3.x+ 上使用 2.x 主题会显得格格不入。

此外，需要其中一个`Sherlock`主题才能`ActionBarSherlock` [根据文档](http://actionbarsherlock.com/theming.html)使用：

> 为了使自定义操作栏实现正常运行，您的应用程序必须使用 Theme.Sherlock、Theme.Sherlock.Light 或 Theme.Sherlock.Light.DarkActionBar，或者您的自定义主题必须使用上述其中之一作为其父级。

如果您真的想要 2.x 寻找`Buttons`和其他`Widgets`我相信您需要从 2.x 复制所有样式/可绘制对象，然后在 Sherlock 派生主题之一中覆盖它们。你可以看看 Chris Versieux 对 HoloEverywhere 所做的事情，[然后](https://github.com/ChristopheVersieux/HoloEverywhere)尝试做相反的事情，让一切看起来像 2.x，不过我强烈建议不要这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T01:43:00.477

我的修复不起作用的原因是因为 Widget.EditText 的背景属性使用的是 ?attr 语法，这意味着它使用的是当前主题的背景，即 Holo。因此，我基本上查看了 Android 源代码，并将使用此语法的两个属性改回了我认为应该是 Holo 之前的主题样式（即将背景设置为白色）。

# objective-c - 在 iOS 上计算电池寿命

> ID：13573469
> 
> 赞同：-1
> 
> 时间：2012-11-26T21:30:01.573
> 
> 标签：objective-c, ios, battery

> **可能重复：**
> [iphone：计算电池寿命](https://stackoverflow.com/questions/1469549/iphone-calculating-battery-life)

我想知道是否可以在 iOS 上计算电池寿命。所以，我可以使用我的设备多长时间，直到它是电池百分比的 0%。谢谢你们！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:48:32.110

简而言之，你不能。至少没有任何准确性。

或者，真的，你不能，除非用户继续做他们*现在*正在做的事情，而不会对网络、信号强度、环境光等进行任何改变......同样，接收推送通知和/或接听电话通话会影响电池寿命。媒体播放也是如此，包括——甚至——媒体中使用的编码格式。

# javascript - 输入值内的Javascript代码

> ID：13573472
> 
> 赞同：-1
> 
> 时间：2012-11-26T21:30:21.587
> 
> 标签：javascript, html, geolocation

我使用 Maxminds GEOIP 工具并在正文之后调用它：

```
<script type="text/javascript" src="http://j.maxmind.com/app/geoip.js"></script> 
```

要打印出城市和州，我只需将其粘贴到 HTML 文档中：

```
<script>document.write(geoip_city());</script>
<script>document.write(geoip_region());</script> 
```

我想在我可以提交和分配给变量的隐藏输入中传递这些值。我想要的是这个，但显然语法是这样的：

```
<input type="hidden" name="city" value="<script>document.write(geoip_city());</script>" /> 
```

我已经尝试在这里搜索但找不到答案，有人可以帮忙吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T21:37:27.473

我会写这个（使用[jQuery](http://jquery.com)）为：

```
var geo_city   = geoip_city();
var geo_region = geoip_region();

$(document).ready(function(){

     $("#city").val(geo_city);

});

<input type="hidden" id="city" name="city" value="" /> 
```

此代码将获取变量`geo_city`并将其放入具有 ID 城市的隐藏文本字段中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T21:45:49.290

我建议向您希望由 geoip 服务填充的元素添加一个类，例如明显的`geoip`类名，并使用 geoip 函数的映射来根据隐藏`input`元素的名称填充隐藏元素的值，例如 (未经测试，并且不幸的是，没有公共 API，无法测试）：

```
var geoipMap {
    'city' : geoip_city(),
    'region' : geoip_region(),
    'country' : geoip_country() // and so on...
};

var inputs = document.getElementsByTagName('input'),
    geoipInputs = [];

for (var i = 0, len = inputs.length; i < len; i++) {
    if (inputs[i].className.indexOf('geoip') !== -1) {
        geoipInputs.push(inputs[i]);
    }
}

for (var i = 0, len = geoipInputs; i < len; i++) {
    geoipInputs[i].value = geoipMap[geoipInputs[i].name];
} 
```

# php - PHP 脚本过早终止

> ID：13573474
> 
> 赞同：-1
> 
> 时间：2012-11-26T21:30:33.123
> 
> 标签：php, html, mysql

我正在尝试编写一个非常基本的 PHP 脚本来从数据库中获取一些信息并将其输出到表中。这是我写的代码：

```
<html>
<head>
    <title>FamInfo from dbCAN</title>
    <meta name="description" content="Test PHP page">
    <link rel="stylesheet" type="text/css" href="style.css" media="screen" />
</head>
<body>
    <h1>FamInfo from dbCAN</h1>
    <table align="center" border="1" cellpadding="5">
    <th>Family ID</th><th>Signature Domain</th><th>class</th><th>note</th><th>activity</th>
        <?php
            include '/vars.php'; // fixed, no change
            $conn = mysql_connect($hostname,$username,$password);
            $db_selected = mysql_select_db($db,$conn);
            $result = mysql_query("select * from FamInfo",$conn);
            while ($row = mysql_fetch_array($result)) 
            {
                echo '<tr>'; // terminates here, at the second quote
                    echo "<td>" . $row["FamID"] . "</td>";
                    echo "<td>" . $row["SigDomain"] . "</td>";
                    echo "<td>" . $row["class"] . "</td>";
                    echo "<td>" . $row["note"] . "</td>";
                    echo "<td>" . $row["activity"] . "</td>";
                echo '</tr><br>';
            }
            mysql_close($conn);
        ?>
    </table>
</body> 
```

出于某种原因，PHP 似乎终止于我尝试回显表格行的行，这意味着我没有得到我需要的值。这是输出的图像：![对时髦的突出显示感到抱歉](../Images/e7f5494e18edf38df3fdd396bc162a6a.png)

有谁知道为什么会发生这种情况，或者潜在的解决方案是什么？谢谢您的意见！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:34:58.480

您没有以`include '/vars.php'`分号结束语句。您还应该将标题行括在行标记中，`<tr></tr>`.

也不需要`<br>`在表格行之间有标签。

你也可能有错误`/vars.php`。你检查过错误日志吗？您也可以发布该代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:51:31.563

好吧，您的 PHP 代码似乎没有被执行，而是被呈现为文本。有几个原因：

1) 如果您的文件是 .html 文件，您需要在 apache 配置中启用 php 解析，以使其支持 html 文件中的 php 解析。这是假设您使用 apache 作为您的网络服务器。如果没有的话，有办法通过 html 文件启用 PHP 解析。对于 Apache，检查您的 .htaccess、httpd.conf 或您定义了 mimetype 的任何其他位置并添加：

```
AddHandler application/x-httpd-php .html 
```

2) 如果您有一个 .php 文件并看到此文件，您需要确保在您的环境中启用了 PHP。

3）如果一切都很好并且您看到了这个，那么问题可能是某个地方的未关闭的php标签（？>），很可能是vars.php文件，它正在扔掉东西。

如果这些建议都没有意义，那么我很茫然，但是如果您提供更多信息，我可以进一步为您提供帮助。

# performance - 查找 JMeter 的登录密码参数名称

> ID：13573479
> 
> 赞同：0
> 
> 时间：2012-11-26T21:31:08.730
> 
> 标签：performance, http, login, web, jmeter

这可能听起来微不足道，但您如何找到登录参数的名称？

我正在尝试自学如何使用 JMeter 并编写一个登录到 say...www.amazon.com 的脚本（只是一个例子）。在 HTTP 请求中我如何知道我需要添加的名称（即在附图中我如何知道参数名称是用户名（不是 usr 或用户等...）和密码（不是 pass 或 pswrd 等... )![JMeter HHTP 请求](../Images/7c32468b5a893743790f0b217e5307b0.png)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-27T20:21:41.887

正如 Andrey Botalov 在评论中所说，查看 HTML 源代码或（更好）在 Chrome 或 Firebug 中检查元素。

# xna - XNA MediaPlayer 加载音乐时序

> ID：13573480
> 
> 赞同：4
> 
> 时间：2012-11-26T21:31:14.453
> 
> 标签：xna, loading, playback

我在加载内容函数中使用以下代码加载音乐：

```
song = Content.Load<Song>("music/game");
MediaPlayer.IsRepeating = false;
MediaPlayer.Play(song); 
```

没什么奇怪的，但是我游戏中的每一轮都是 2 分钟，应该与音乐同步（即 2 分钟），但音乐提前 2-4 秒结束。如果它总是在同一时间，这不会是一个问题。

我的猜测是它与加载时间有关？有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:33:15.137

您可以做的一件事是移动`Content.Load<Song>`to Load 方法并检查它是否正在更新中播放，如果没有，则播放。例如，

```
public void LoadContent(ConentManager content)
{
    song = content.Load<Song>("music/game");
    gameSongStartedPlaying = false; // this variable to hold if you have starting playing this song already
    MediaPlayer.IsRepeating = false;
}

public void Update(GameTime gameTime)
{
    if(MediaPlayer.State == MediaState.Stopped && !gameSongStartedPlaying)
    {
        MediaPlayer.Play(song);
        gameSongStartedPlaying = true;
    }
} 
```

这应该在 Update 方法的第一次通过时开始播放歌曲，而不是在歌曲正在“播放”而之后所有资源`Content.Load<Song>`仍在加载的加载阶段（这将是您的歌曲提前完成的原因）。

# javascript - 在另一个网站的 HTML 页面中使用 Google 脚本作为 Java 脚本

> ID：13573481
> 
> 赞同：2
> 
> 时间：2012-11-26T21:31:15.267
> 
> 标签：javascript, google-apps-script

我是使用 Google Script 的新手，但它似乎是我期待使用的 Google Doc、Calendar 和 Mail 软件的迷人界面！

我们小组有一个网站，我想用访问 Google Docs 的动态 Javascript 组件来美化它。我希望做的是在 Google Script 中创建函数并在我们网站的 HTML 中调用它们。

因此，我制作了一个具有两个功能的 Google 脚本页面：

```
function getName(EMT_ID) {
// ...
};

function getStrikes(EMT_ID) {
// ...
}; 
```

这些从我们使用的 Google 电子表格中获取数据。我不会包含详细信息，因为当通过 Google Script 测试环境访问它们时，它们本身就可以正常工作。

然后我将其发布为“Web App”，以便我可以从其他平台访问这些功能。

现在，在我们的另一个网页上，我添加了这段代码（删除了确切的标题）

```
<script src="https://script.google.com/macros/s/AKfy[...]65K0/exec"></script>

<script>
function strikes()
{
var EMT_ID = document.getElementById('USC ID').value
document.getElementByID('output').InnerHTML = getName(EMT_ID) + ' has ' + getStrikes(EMT_ID) + '     strikes.'
}
</script>

<input type="text" id="USC ID">
<input type="button" onclick='strikes()' value='Check Strikes'>
<p>Output here:</p><p id="output"></p> 
```

我希望这将允许我从 Google Script 页面访问 Javascript 函数。是这样吗？如果不是 - 我应该怎么做。

此致

- - 编辑

添加详细信息 - 网页似乎根本没有响应按下按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T01:56:36.300

Google Apps Script functions are not directly callable from external javascript in the way that you've tried. When you published your script as a web app, you were provide a URL that the app was accessible at, via HTML. It didn't expose the functions of your script.

You do have some options, though.

1.  You can create HTML within your google script using the [HTML Service](https://developers.google.com/apps-script/html_service?hl=en), and THAT html can utilize your apps-script functions indirectly via templated HTML or directly like this:

    ```
    <script>
      google.script.run.doSomething();
    </script> 
    ```

2.  You can use the [Content Service](https://developers.google.com/apps-script/content_service) to have your Apps Script provide feeds (RSS, JSON, JSONP).

3.  Your published service can be written using the [UI Service](https://developers.google.com/apps-script/uiapp), with full access to your other apps script functions, forms, charts, etc.

There are variations on the above themes as well - this list isn't exhaustive.

# c - 在 C 中重新启动循环的函数的位置

> ID：13573484
> 
> 赞同：0
> 
> 时间：2012-11-26T21:31:21.297
> 
> 标签：c, loops, while-loop, boolean

我用我从网上编辑的代码和我输入的 switch 语句组合了一个简单的货币转换器程序。当我在 Visual Studio 中运行该程序时：

```
printf("Would you like to make another conversion? y/n\n");
fflush(stdin);
scanf("%c",&marker); 
```

将等待输入，然后返回到 while 语句的开头或退出控制台窗口。现在，如果我在 Mac 上运行这是 Xcode “你想进行另一次转换...”，但不等待输入，它只是直接返回到 while 循环。

我是否将 printf("Would you like...etc 部分放在正确的位置？或者有没有更好的方法让循环在接受用户输入后再次运行？我需要用 'bool 做任何事情吗？ ' 声明。我们在课堂上还没有走那么远。

完整代码如下所示：

```
#include <stdio.h>

int main ()
{
int choice;
float money;
float total;
char marker='y';

printf("\n\nCURRENCY CONVERSION\n");
printf("***Rates correct as of 26 NOV 12***\n");
printf("------------------------------------\n");
printf("1\. Australian Dollar (AUD) 1.533=1 GBP\n");
printf("2\. Euro (EUR) 1.235=1 GBP\n");
printf("3\. Indian Rupee (INR) 89.494=1 GBP\n");
printf("4\. Japanese Yen (JPY) 131.473=1 GBP\n");
printf("5\. US Dollar (USD) 1.602=1 GBP\n");
printf("Enter the number for the currency to convert...");

while(marker!='n')
{
    printf("\n\nWhat would you like to convert your money to? (1-5): ");
    scanf("%d",&choice);

    printf("\n\nHow much money do you want to convert? (GBP): ");
    scanf("%f",&money);

    switch(choice) {
        case 1:
            total = money * 1.533;
            printf("\n\nYou will have %.2f Australian Dollars \n\n", total);
            break;
        case 2:
            total = money * 1.235;
            printf("\n\nYou will have %.2f Euros \n\n", total);
            break;
        case 3:
            total = money * 89.494;
            printf("\n\nYou will have %.2f Indian Rupees \n\n",total);
            break;
        case 4:
            total = money * 131.473;
            printf("\n\nYou will have %.2f Japanese Yen \n\n", total);
            break;
        case 5:
            total = money * 1.602;
            printf("\n\nYou will have %.2f US Dollars \n\n", total);
            break;
        default:
            printf("You did not choose a correct option\n");
    }

    printf("Would you like to make another conversion? y/n\n");
    fflush(stdin);
    scanf("%c",&marker);
}
return 0;
} 
```

非常感谢收到的任何意见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:48:48.467

这与循环无关。这是关于您对 scanf 的调用。

发生的事情是标准输入被缓冲了。如果缓冲区中没有足够的待处理数据，scanf 只会导致程序停止并等待输入。当你这样做时：

```
scanf("%f", &f); 
```

...然后程序将停止，直到您键入一行文本。假设您键入：

```
1\n 
```

1 被读入变量 f...*但换行符保留在 buffer 中*。

这意味着您致电：

```
scanf("%c", &c); 
```

...将立即返回，因为缓冲区中有足够的数据来完成调用。程序只有在缓冲区用完时才会停止并等待更多数据。

Windows 不会像这样进行缓冲，这就是为什么您没有观察那里的行为。

对此有大约一百万种解决方案，从改变标准输入的缓冲方式到使用像 ncurses 这样的基于文本的 UI 库。鉴于默认情况下 stdin 是行缓冲的——一次读取一行数据，以换行符终止——最简单的方法就是确保每次调用都`scanf()`使用完整的文本行。这意味着每次调用 scanf 时缓冲区都是空的。例如：

```
scanf("%f\n", &f); 
```

...和：

```
scanf("%c\n", &c); 
```

*请注意*，如果用户输入的输入与此格式字符串不匹配，例如`1 2`第一个或`ab`第二个，scanf 将使变量保持未初始化状态。所以你绝对必须检查返回参数。

```
if (scanf("%f\n", &f") != 1)
    error("Oh noes!"); 
```

否则你的程序会非常糟糕，非常错误。

顺便说一句：你没有在这个程序中做过，但你知道，`scanf("%s")`不应该使用它。为了任何东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T21:38:31.957

您的问题很可能`scanf("%c", &marker);`是读取先前输入留下的换行符。

请注意，这会`fflush(stdin)`调用未定义的行为。C标准说[`fflush()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/fflush.html)：

> 如果流指向一个输出流或更新流，其中没有输入最近的操作，`fflush()`则应导致该流的任何未写入数据写入文件。

如果该操作清除了 Visual Studio 或 Windows 中的输入队列，那么您刚刚了解到一个平台上的标准扩展并不总是适用于其他平台。特别是，`fflush(stdin)`不会清除等待读取的排队字符。

请注意，您可以通过将错误输入打印为错误消息的一部分来帮助您的调试工作。

* * *

您还应该测试每个`scanf()`调用：

```
if (scanf("%c", &marker) != 1)
    ...EOF or other problem...

if (scanf("%f", money) != 1)
    ...EOF or maybe a letter instead of a number... 
```

从风格上讲，最好在开关的标签`break;`后面加上一个代码。`default:`

此外，您应该真正避免在菜单和 case 语句中打印的字符串中重复转换率。货币名称也是如此。也许您还没有涉及数组和结构，但从长远来看，这是一个问题的根源（如果只是因为速率发生变化而浪费了重新编译；但是允许从文件或网站中读取它们是另一个主要练习）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T21:37:59.773

您可以执行无限循环（例如 while(true){} ），并且在您的 switch 语句中有一个选择 'n' 的案例，它会中断循环（例如，break;）

此外，案例 1 、案例 2 等...我会将它们扫描为字符而不是整数。（例如案例'1'：，案例'2'：，等等......）

我不确定我刚才所说的是否可行，但这是我最初的想法。希望能帮助到你 ：）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T21:48:09.437

如果您不想处理刷新缓冲区，可以定义 a`char buffer[1024]`并使用`fgets`with `sscanf`：

```
printf("\n\nWhat would you like to convert your money to? (1-5): ");
fgets(buffer, sizeof(buffer), stdin);
sscanf(buffer, "%d", &choice); 
```

while 循环可以包含您的菜单：

```
while (1) {
  printf("\n\nCURRENCY CONVERSION\n");
  printf("***Rates correct as of 26 NOV 12***\n");

  /* ... */

  printf("Would you like to make another conversion? y/n\n");
  fgets(buffer, sizeof(buffer), stdin);
  sscanf(buffer, "%c", &marker);
  if (marker == '\n')
    break;
} 
```

# html - 查找替换很多标签，但是url不一样？有什么办法吗？

> ID：13573488
> 
> 赞同：0
> 
> 时间：2012-11-26T21:31:51.167
> 
> 标签：html, replace

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T19:59:32.993

**以下将在每个锚标记都在其自己的行上的假设下工作。**

例子：

```
<a href="myref">asdf</a>
<div>
</div>
<a href="myref2">asdf2</a> 
```

[Notepad++](http://notepad-plus-plus.org/)有一个正则表达式查找和替换功能，可以满足您的需要。

1.  将所有`</a>`标签替换为空
2.  使用正则表达式查找所有`<a href="anything">`内容并替换为任何内容。

下图显示了我为第 2 步所做的操作。您可以看到我使用了`<a .*>`. 为了使其正常工作，每行应该只有一个`>`字符。否则，正则表达式将进行尽可能长的匹配，可能包括一堆其他标签。这就是为什么我说该程序仅适用于在自己的行上的锚标记。

![步骤 2 查找和替换](../Images/6efb191430782bcb4d2b1d8eebb65a5d.png)

如果您看不到图像（同样，这仅适用：

1.  从 Notepad++ 菜单：**搜索 > 替换**
2.  选择**正则表达式**
3.  在**查找什么**框中，输入`<a .*>`
4.  点击**全部替换**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T01:03:59.743

也许这是一个使用 JavaScript 和 jQuery 的解决方案。也可以对其进行调整以仅获取不以 . 开头的链接的值`http`。根据问题中的链接，我不太确定这是否相关。

```
// get all links within the document
​var links = $('a');

// simply get all link texts
var x = links.text();​​​​​​

// or just get all links that are like 'kl1j23l123l12j3' as they don't start with 'http'
var x = links.filter('[href^=http]').text(); 
```

这是一个演示：http: [//jsfiddle.net/rg3ET/](http://jsfiddle.net/rg3ET/)

`x`您当然可以循环遍历它们并将它们单独输出，而不是将它们一起应用到一个变量（“ ”）中。

# graphviz - Graphviz：如何使 HTML 表格单元格的样式变为粗体？

> ID：13573492
> 
> 赞同：2
> 
> 时间：2012-11-26T21:32:06.313
> 
> 标签：graphviz

我希望下面的点代码使标题变粗，但由于`<b>`某种原因，该标签似乎在这种情况下不起作用。

```
digraph G {
    node [shape=plaintext]

    a [label=<<table border="0" cellborder="1" cellspacing="0">
                           <tr><td><b>title</b></td></tr>
                           <tr><td>row 1</td></tr>
                           <tr><td>row 2</td></tr>
              </table>>];
} 
```

有什么可行的选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:51:54.160

这个确切的图表确实有效。您肯定需要更新 graphviz。

这是 2.28 的输出：

![粗体图形标题](../Images/38f4630f6963d5f0afc2ba4364420740.png)

# silverlight-5.0 - ESRI ArcGIS 客户端匹配映射到 WKID (Silverlight)

> ID：13573495
> 
> 赞同：1
> 
> 时间：2012-11-26T21:32:18.550
> 
> 标签：silverlight-5.0, arcgis, esri

我在[http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer](http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer)使用地图服务，它给了我一张世界地图。

我有一个形状文件（.prj），如下所示：

PROJCS["UTM:10N",GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["CLARKE 1866",6378206.4,294.9786982]],PRIMEM["GREENWICH",0.0],UNIT["Degree",0.01344532925199 ],PROJECTION["Transverse_Mercator"],PARAMETER["Central_Meridian",-123.0],PARAMETER["Latitude_Of_Origin",0.0],PARAMETER["Scale_Factor",0.9996],PARAMETER["False_Easting",500000.0],PARAMETER["False_Northing ",0.0],UNIT["米",1.0]]

与形状文件相关的位置位于加拿大西部 (UTM:10N)。研究似乎表明这是 WKID 26710。

如果我创建地图图层并将 SpatialReference 设置为 26710，则不会显示地图。如果我将 SpatialReference 设置为 102100，我会得到一张地图，但我的点在法国东部。这告诉我我的参考已关闭。

我正在处理形状文件，但我不创建或拥有它们。您将如何让他们在加拿大正确定位自己？似乎答案是“获得正确的空间参考”，但我所做的所有搜索都表明那是 26710。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T04:10:37.493

您使用的地图服务仅绘制 102100 投影中提供的几何图形。如果您有权访问 ArcGIS Geometry 服务器，则可以将数据点从源投影转换为地图服务所需的数据点。请参阅[http://resources.esri.com/help/9.3/arcgisserver/apis/rest/project.html](http://resources.esri.com/help/9.3/arcgisserver/apis/rest/project.html)

例如，如果您有一个点，其 26710 wkid 中的坐标为 (491800, 5456280)，您可以执行类似的操作

[http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Geometry/GeometryServer/project?inSR=26710&outSR=102100&geometries=%7B%22geometryType%22%3A%22esriGeometryPoint%22%2C%22geometries%22%3A%5B %7B%22x%22%3A491800%2C%22y%22%3A5456280%7D%5D%7D&f=pjson](http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Geometry/GeometryServer/project?inSR=26710&outSR=102100&geometries=%7B%22geometryType%22%3A%22esriGeometryPoint%22%2C%22geometries%22%3A%5B%7B%22x%22%3A491800%2C%22y%22%3A5456280%7D%5D%7D&f=pjson)

该结果中的 x 和 y 坐标应显示在您链接的地图服务上温哥华附近的某个地方。

# ios - 从单例设置/检索数据

> ID：13573499
> 
> 赞同：0
> 
> 时间：2012-11-26T21:32:35.507
> 
> 标签：ios, singleton

Apple 拒绝了我们的应用程序站点，认为选项卡之间的页面加载时间太长。在我只是调用 webview 来显示通过 CMS 管理的内容之前。现在我们已经实现了 JSON，我正在尝试使用单例设计模式预加载 5 个选项卡的数据。正如我在示例中看到的那样，我似乎无法设置单例值。上代码：

头文件.h

```
#import <UIKit/UIKit.h>

@interface FirstViewController : UIViewController {
    NSString *someProperty;
    ...
}

@property (nonatomic, retain) NSString *someProperty;

+ (id)sharedManager;

@property (strong, nonatomic) NSString* tab3data;

@end 
```

实现.m

```
//Create a seperate thread to download JSON thread
#define kBgQueue dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0) //1

//Set JSON URL
#define GWDiOSURL [NSURL URLWithString:@"http://m.web.org/cms_mapper.php"]

#import "FirstViewController.h"

@interface FirstViewController ()

@end

@implementation FirstViewController
@synthesize someProperty;

- (id)init {
    if (self = [super init]) {
        someProperty = @"Default Property Value";
    }
    return self;
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        self.title = NSLocalizedString(@"First", @"First");
        self.tabBarItem.image = [UIImage imageNamed:@"first"];
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    FirstViewController *sharedManager = [FirstViewController sharedManager];

    NSLog(@"Toll%@",sharedManager);
    // Do any additional setup after loading the view, typically from a nib.
    //Get JSON and load into 'data'
    dispatch_async(kBgQueue, ^{
        NSData* data = [NSData dataWithContentsOfURL:GWDiOSURL];
        [self performSelectorOnMainThread:@selector(fetchedData:) withObject:data waitUntilDone:YES];
    });

}

//Begin JSON Data Parsing and loading
- (void)fetchedData:(NSData *)responseData {
    //parse out the json data
    NSError* error;

    //Parse JSON
    NSDictionary* json = [NSJSONSerialization
                          JSONObjectWithData:responseData

                          options:kNilOptions
                          error:&error];

    // Load JSON into a dictionary
    NSDictionary *tabData = [json objectForKey:@"mapper"];

    // Get Tab3 data from dictionary
    NSDictionary *tab3 = [tabData objectForKey:@"#tab3_content"];

    // Load Tab3 data into a string from dictionary
    NSString *html = [NSString stringWithFormat:@"%@",tab3];

    // Verify content via counsel
    //NSLog(@"Second Data:%@",html);

    // Load content into webView
    [webView loadHTMLString:html baseURL:nil];

[FirstViewController sharedManager].someProperty = @"asdf";

}

+ (id)sharedManager {
    static FirstViewController *sharedMyManager = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        sharedMyManager = [[self alloc] init];
    });
    return sharedMyManager;

} 
```

我需要将 html 的值设置为单例。跟随线

```
[FirstViewController sharedManager].someProperty = @"asdf"; 
```

产生此错误

```
Propery 'someProperty' not found on object of type 'id'. 
```

几天来，我一直试图让整个过程正常工作。我很欣赏这种洞察力。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T21:48:10.653

好吧，您的类方法 sharedManager 返回一个 id。尝试在 sharedManager 中返回 FirstViewController*。

+ (FirstViewController *)sharedManager;

# ios - 我是否需要 Apple MFi 认证才能编写通过 USB 与 Made for iPod 车载收音机通信的应用程序？

> ID：13573500
> 
> 赞同：2
> 
> 时间：2012-11-26T21:32:45.637
> 
> 标签：ios, mfi

我的车载收音机是为 iPod 设计的，可以显示曲目信息，可以向前和向后跳跃、暂停、播放等。

当收音机控制时，iTunes Match 内容不会出现。我可以构建一个无需 MFi 认证就可以将此信息传输到无线电的应用程序吗？我不确定 ExternalAccessory.framework 和 MFi 程序要求之间的相关性。

值得一提的是，Pandora 的 iOS 应用程序通过 USB 将曲目信息发送到我的车载收音机，但其他 iOS 音乐应用程序却没有。我试图弄清楚这是否是开发人员的缺点，或者 Pandora 是否经过 MFi 认证。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T21:39:26.917

根据我在[MFi Program Enrollment：常见问题解答](http://mfi.apple.com/faqs)中阅读的内容，答案似乎是否定的，您不需要加入 MFi：

> **我想开发一个与 MFi 配件通信的 iOS 应用程序。我需要加入 MFi 计划吗？**
> 
> 不需要。iOS 应用程序开发人员不需要加入 MFi 计划。应用程序开发人员所需的一切都在 iOS SDK 中提供的外部附件框架中。要访问 iOS SDK，请加入 iOS 开发者计划：[https](https://developer.apple.com/programs/ios/) ://developer.apple.com/programs/ios/ 。

现在获取汽车收音机的规格以开发匹配的应用程序将完全是另一回事。

# android - 另一个 r 无法解析为在文档元素之后解析 xml 垃圾的变量/错误

> ID：13573502
> 
> 赞同：1
> 
> 时间：2012-11-26T21:32:57.690
> 
> 标签：android, xml, eclipse, defined

我知道这被问了很多，但是我在文档元素问题之后解析 xml junk 时出错，然后在寻找问题后我得到 10 r can not be defined 错误，我认为这一切都是由第一个错误引起的。但即使我删除了问题段落并单击清除错误红色 x 仍然存在于空白区域。错误从底部的 textview 行开始。

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"
android:padding="25dp" >

<EditText
    android:id="@+id/etCommands"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:hint="Type a Command"
    android:password="true" />

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:weightSum="100" >

<Button
    android:id="@+id/bResults"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="20"
    android:text="Try Command" />

<ToggleButton
    android:id="@+id/tbPassword"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="80"
    android:checked="true"
    android:paddingBottom="10dp"
    android:text="ToggleButton" />
</LinearLayout>

<TextView
 android:text="invalid"
 android:id="@+id/tvResults"
 android:gravity="center"
 android:layout_width="fill_parent"
 android:layout_height="wrap_content"  />   
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T21:35:35.717

```
<LinearLayout
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="horizontal"
android:weightSum="100" /> 
```

应该

```
<LinearLayout
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="horizontal"
android:weightSum="100" > 
```

`/`请注意标签末尾的no 。最后`/`是“请立即关闭此标签”的 xml。就目前而言，您的 xml 无效，带有两个打开的 LinearLayout 标签，但关闭了 LinearLayout 3 次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T21:37:03.440

`xml`当您不提供完整文件时，很难知道问题出在哪里。您可能忘记关闭您的一件`LinearLayout`物品。

编辑：

只需从您的声明中删除该`/`字符：`LinearLayout`

```
<LinearLayout
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="horizontal"
android:weightSum="100" > 
```

# facebook-graph-api - 将操作链接重定向到画布应用程序而不会出现错误警报

> ID：13573504
> 
> 赞同：1
> 
> 时间：2012-11-26T21:33:10.483
> 
> 标签：facebook-graph-api, actionlink

我正在将[操作链接](https://developers.facebook.com/docs/technical-guides/opengraph/action-links/)集成到我的应用程序中，并且在将用户重定向到 Facebook 之外时，根据规范，我收到了“抱歉，出错了”错误。该规范表明这是将用户重定向到 Facebook 之外的症状。因此，如果这意味着用户不会看到该错误，我很乐意将它作为我的页面上的应用程序。

如果我重定向到 Facebook 页面，是否可以绕过警报？

# eclipse - OS X Eclipse 切换工作区需要两次点击

> ID：13573505
> 
> 赞同：1
> 
> 时间：2012-11-26T21:33:11.360
> 
> 标签：eclipse, macos

我的 MacBook Air 有一个奇怪的问题。当我想在 Eclipse 中切换工作区并转到 File-> Switch Workspace 并选择最近的一个。我的第一次点击很少“接受”，因此必须重复该过程两次才能进行切换。如果我一直在工作区做一些工作，尤其如此。如果我只是打开一个并立即切换，它通常可以正常工作。

是否有其他人遇到这种情况和/或知道是否有什么可做的？

[编辑]

玩了一下似乎是当我在全屏模式下使用 Eclipse 时。

我在 OS X 10.8.2 上使用 Eclipse 4.2.1

# python - 在不更改原始列表的情况下创建新列表

> ID：13573507
> 
> 赞同：13
> 
> 时间：2012-11-26T21:33:25.977
> 
> 标签：python, list, sorting

我有一个清单：

```
 L=[2,0,4,5] 
```

我想在不改变 L 本身的情况下创建一个新列表：

```
 K= [0,2,4,5] 
```

但是当我尝试时：

```
 K=L.sort()
       print(K) 
```

它什么也不打印，如果我尝试：

```
 print(L) 
```

它出来了：[0,2,4,5]

为什么 K 不是 =[0,2,4,5]？以及如何制作一个新列表 [0,2,4,5] 并且不更改 L？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-26T21:34:34.293

以下将制作一个排序副本`L`并将其分配给`K`：

```
K = sorted(L) 
```

[`sorted()`](http://docs.python.org/2/library/functions.html#sorted)是一个内置函数。

`K = L.sort()`不起作用的原因是对列表*进行了适当*`sort()`的排序，然后返回。这就是为什么最终被修改并最终成为.*`None``L``K``None`*

 *这是您可以使用的方法`sort()`：

```
K = L[:] # make a copy
K.sort() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-26T21:34:28.097

您需要使用内置函数`sorted`：`sorted(L)`*

# jquery - 链接到另一个页面时保留的弹出通知

> ID：13573508
> 
> 赞同：0
> 
> 时间：2012-11-26T21:33:38.410
> 
> 标签：jquery, notifications, popup

[在](http://needim.github.com/noty/)_ _ **_** _ html页面之间链接时浏览器？我尝试将提到的 JQuery 弹出窗口添加到指向另一个页面的链接，但显然，当我单击该链接时，通知会在它完全显示之前消失。

例如：

```
<!--page1.html-->

<script type="text/javascript">
function generate(type) {
  var n = noty({
    text: type,
    type: type,
    dismissQueue: false,
    layout: 'topCenter',
    theme: 'defaultTheme'
  });
}

$(document).ready(function() {

$('#link').click(function() {
    generate('Your language choice was set');       
} );

</script>

<a href="page2.html" id="link">link to another page</a> 
```

单击该链接应该会导致该通知栏在浏览器顶部弹出，但由于它链接到 page2.html，因此在该栏加载之前它将消失，因为 page2.html 已经加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T21:38:55.447

当用户单击页面上的链接时，您可以使用 javascript 和 ajax 请求更改页面的内容，而不是使用静态链接的页面。

通常，导航到新页面会破坏前一页面的 DOM 内容（例如那个弹出窗口）。我想从技术上讲，您可以将该信息存储在 cookie 中，该 cookie 尝试根据先前的状态在每个页面上重新创建弹出窗口，但这似乎比 ajax 选项复杂。

# text - Android 2.3.3 中的 Andengine setText 意外行为

> ID：13573509
> 
> 赞同：1
> 
> 时间：2012-11-26T21:33:44.590
> 
> 标签：text, andengine, android-version

我有这个代码：

```
score = new Text(20, 50, font, "0123456789.()abcdefghijklmnopqrstuvwxyz", vbom); 
```

score.setText(""); 场景.attachChild（分数）；

我在互联网上读到，在开始使用文本时，需要列出所有将使用的字符。

在我的 Galaxy S2 (android 4.0.3) 中，这段代码可以正常工作，但在我妻子的 Galaxy S2 (android 2.3.3) 中，场景中的结果是这样的：

```
0123456789.()nabcdefghijklmnopqrstuvwxyz 
```

是安卓版本的问题？或者我做错了什么？

编辑：

还有一条线索，如果我使用`score.setText("a");`而`score.setText("");` 不是输出是“a”

奇怪的行为...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T18:17:45.597

The Text class in AndEngine is picky. If you want to change the text after you create the object you have to specify the length of the string in the constructor (notice the `.length()`):

```
Text score = new Text(20, 50, font, "test", "test".length(), vbom); 
```

If you use it like this:

```
Text score = new Text(20, 50, font, "test", vbom); 
```

Then I think the text will not change, even after using `setText("foo");`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-23T15:08:41.483

为避免游戏延迟，您应该使用

```
mFont.prepareLetters("0123456789".toCharArray()); 
```

它将分配内存并加载字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T08:40:56.667

这是一个典型的问题。我在游戏中遇到了同样的问题。A 会建议您仅隐藏文本（或将其分离并在以后需要时附加）。

# javascript - asp.net 中的本地化警报消息

> ID：13573510
> 
> 赞同：0
> 
> 时间：2012-11-26T21:33:50.663
> 
> 标签：javascript, asp.net

我有一个本地化资源表，其中包含 resourceType、cultureCode、resourceKey、resourceValue 列。

```
resourceType | cultureCode | resourceKey | resourceValue
Alert        | en-US       | Hello       | Hello
Alert        | es-ES       | Hello       | Hola 
```

我需要创建一个警报消息，根据用户来自（美国或西班牙）的位置进行翻译。我刚在想

```
alert('<asp:Localize runat="server" id="locText" meta:resourcekey="Alert">Hello</asp:Localize>'); 
```

这看起来对吗？

# nhibernate - Fluent NHibernate - 级联所有删除孤儿在删除时不做任何事情

> ID：13573511
> 
> 赞同：4
> 
> 时间：2012-11-26T21:33:56.830
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping, fluent-nhibernate-mapping

我有两个简单的类，它们相互引用为下面定义的一对多关系：

```
public class Project
{
    public virtual int Id { get; set; }
    public virtual string Name { get; set; }
    public virtual IList<Document> Documents { get; set; }
}

public class Document
{
    public virtual int Id { get; set; }
    public string FileName { get; set; }
} 
```

我的映射定义为：

```
public class ProjectMapping : ClassMap<Project>
{
    public ProjectMapping()
    {
        Table("Projects");
        Id(x => x.Id).Column("Project_Id").GeneratedBy.TriggerIdentity();
        HasMany(x => x.Documents)
            .Table("Documents")
            .KeyColumn("Document_Project_Id")
            .Cascade.AllDeleteOrphan()
            .Not.KeyNullable();
        Map(x => x.Name).Column("Project_Name");
    }
}

public class DocumentMapping : ClassMap<Document>
{
    public DocumentMapping()
    {
        Table("Documents");
        Id(x => x.Id).Column("Document_Id").GeneratedBy.TriggerIdentity();
        Map(x => x.FileName).Column("Document_File_Name");
    }
} 
```

一切似乎都工作正常，添加/更新文档并调用 session.Save(project) 反映了我的数据库中的正确更改，但是如果我要从与项目关联的文档列表中删除文档并调用 session.Save(项目）删除的文档永远不会从数据库中删除。

任何想法为什么除了删除之外其他所有东西都可以工作？

**编辑：** 我的 MVC 4 项目是使用 Fluent NHibernate 设置的，如下所示：

```
public class SessionFactoryHelper
{
    public static ISessionFactory CreateSessionFactory()
    {
        var c = Fluently.Configure();
        try
        {
            //Replace connectionstring and default schema
            c.Database(OdbcConfiguration.MyDialect.
                ConnectionString(x =>
                x.FromConnectionStringWithKey("DBConnect"))
                .Driver<NHibernate.Driver.OdbcDriver>()
                .Dialect<NHibernate.Dialect.Oracle10gDialect>())
                .ExposeConfiguration(cfg => cfg.SetProperty("current_session_context_class", "web"));
            c.Mappings(m => m.FluentMappings.AddFromAssemblyOf<Project>());
            c.Mappings(m => m.FluentMappings.AddFromAssemblyOf<Document>());
        }
        catch (Exception ex)
        {
            Log.WriteLine(ex.ToString());
        }
        return c.BuildSessionFactory();
    }
}

public class MvcApplication : System.Web.HttpApplication
{
    public static ISessionFactory SessionFactory { get; private set; }

    protected void Application_Start()
    {
        AreaRegistration.RegisterAllAreas();

        WebApiConfig.Register(GlobalConfiguration.Configuration);
        FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
        RouteConfig.RegisterRoutes(RouteTable.Routes);
        BundleConfig.RegisterBundles(BundleTable.Bundles);
        AuthConfig.RegisterAuth();

        SessionFactory = SessionFactoryHelper.CreateSessionFactory();
    }

    protected void Application_BeginRequest(object sender, EventArgs e)
    {
        var session = SessionFactory.OpenSession();
        CurrentSessionContext.Bind(session);
    }

    protected void Application_EndRequest(object sender, EventArgs e)
    {
        var session = CurrentSessionContext.Unbind(SessionFactory);
        session.Dispose();
    }
} 
```

我的存储库定义如下：

```
public class Repository<T> : IRepository<T>
{
    public virtual ISession Session
    {
        get { return MvcApplication.SessionFactory.GetCurrentSession(); }
    }

    public T FindById(int iId)
    {
        return Session.Get<T>(iId);
    }

    public void Save(T obj)
    {
        using (var transaction = Session.BeginTransaction())
        {
            try
            {
                Session.Save(obj);
                transaction.Commit();
            }
            catch (Exception ex)
            {
                transaction.Rollback();

                Log.WriteLine(ex.ToString());
            }
        }
    }

    public T SaveOrUpdate(T obj)
    {
        using (var transaction = Session.BeginTransaction())
        {
            try
            {
                Session.SaveOrUpdate(obj);
                transaction.Commit();
            }
            catch (Exception ex)
            {
                transaction.Rollback();

                Log.WriteLine(ex.ToString());
            }
        }

        return obj;
    }

    public T Update(T obj)
    {
        using (var transaction = Session.BeginTransaction())
        {
            try
            {
                Session.Update(obj);
                transaction.Commit();
            }
            catch (Exception ex)
            {
                transaction.Rollback();

                Log.WriteLine(ex.ToString());
            }
        }

        return obj;
    }
} 
```

我在我的 ProjectsController 中定义了 2 个操作，如下所示：

```
private IRepository<Project> repository;

public ProjectsController()
{
    repository = new Repository<Project>();
}

public ActionResult Edit(int iId)
{
    Project project = repository.FindById(iId);

    if (project == null)
        return HttpNotFound();

    return View(project);
}

[HttpPost]
public ActionResult Edit(Project project)
{
    project = repository.Update(project);

    return View(project);
} 
```

如果我要在我的第一个操作中删除一个文档（没有 HttpPost）：

```
project.Documents.RemoveAt(0);
repository.Update(project); 
```

从数据库中删除正确的行。但是，如果我要在具有 HttpPost 属性的操作中执行相同的操作，则永远不会删除该行。

另外我应该注意，如果我在具有 HttpPost 属性的操作中向 project.Documents 添加一个文档，repository.Update(project) 会成功地将具有正确外键引用的行添加到项目中。这仅在我删除文档时失败。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:32:02.573

您是否尝试过添加`.Inverse`到您的`HasMany`映射？

另外，我对`Not.KeyNullable`. 我认为这里没有必要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T07:22:43.543

级联设置似乎是正确的。提到的问题可能在其他地方：

> 但是，如果我要从与项目相关的文档列表中删除文档

我怀疑是会话刷新模式，或者缺少对`Project`先前分离的更新父实体的显式调用。保证：

首先，那个`Flush()`被调用了。如果该`project`实例仍保留在*Session 中，*则可以更改刷新的默认行为。（例如`session.FlushMode = FlushMode.Never;`或`Commit`没有交易......）

```
// 1) checking the explicit Flush()
project.Documents.Remove(doc);
Session.Flush(); // this will delete that orphan 
```

第二个可能是*驱逐`project`实例*，需要显式更新调用

```
// 2) updating evicted project instance
project.Documents.Remove(doc);
Session.Update(project);
//Session.Flush(); // Session session.FlushMode = FlushMode.Auto 
```

在这种情况下，设置*inverse将**（仅）*有助于减少一次使用 UPDATE 语句访问数据库，重置对 的引用`doc.Project = null`，然后执行 DELETE。

# c# - 向/从 XML 读取/写入枚举

> ID：13573513
> 
> 赞同：2
> 
> 时间：2012-11-26T21:34:00.953
> 
> 标签：c#, xml, enums, xmlreader, xmlwriter

我正在用 XmlWriter 编写一个枚举值，它在 xml 中看起来像这样：

```
<Tile>Plain</Tile>

writer.WriteValue(tile.ID.ToString()); // ID's type is the enum 
```

平原是枚举值之一。现在，当我尝试阅读此内容时，尽管它不起作用。

```
(TileID)reader.ReadElementContentAs(typeof(TileID), null); 
```

当我的 reader.Name == "Tile" 时我会这样做，这应该可以工作，尽管它显然无法将字符串转换为我的枚举。有什么方法可以修复写作，所以我不必做 .ToString() （因为如果我没有收到错误：“TileID 不能转换为字符串”。）或修复阅读？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T21:45:35.940

我建议使用`Enum.TryParse`

```
var enumStr = reader.ReadString();
TitleID id;
if (!Enum.TryParse<TitleID>(enumStr, out id)
{
    // whatever you need to do when the XML isn't in the expected format
    //  such as throwing an exception or setting the ID to a default value
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T21:39:57.750

您可能必须使用`Enum.Parse`. 我最近把这个放在一起工作的一个项目：

```
public static T ParseTo<T>(string value) {
    return (T)Enum.Parse(typeof(T), value);
} 
```

它只是使铸件更清洁。我不需要任何错误检查，因为我们有非常严格的 XML 生成测试。你可能想添加一些。

为您使用：

```
var idString = reader.ReadString();
TileID tileId = StaticClassYouPutItIn.ParseTo<TileID>(idString); 
```

# performance - SQL Server 2008 空间查询。如果它们彼此相交，如何对多边形进行分组？

> ID：13573515
> 
> 赞同：3
> 
> 时间：2012-11-26T21:34:15.307
> 
> 标签：performance, sql-server-2008, group-by, spatial-query, sqlgeography

在我的表中有一个存储多边形的几何字段。

彼此相交的多边形必须连接并形成一个多边形（见下文）

[![图片](../Images/e464818358213a22e925f8228a593b01.png)](https://i.stack.imgur.com/1IAkj.png)
[（来源：[location-world.com](http://debug.location-world.com/dynamicv2/union.png)）]

结果无法计算，但必须在飞行中执行。我已经用光标完成了，但它需要太多时间。

有没有办法在不使用游标的情况下执行任务？我正在使用 Sql Server 2008 R2。

我附上了使用游标的源代码。

```
DECLARE @Results TABLE (ResultId INT, Shape GEOMETRY)
DECLARE @ExistingIds TABLE (Id VARCHAR(50))
DECLARE @Id VARCHAR(50), @Shape GEOMETRY

DECLARE ViasCursor CURSOR FOR
SELECT ID, shape
FROM [dbo].[layer.2502]

OPEN ViasCursor
FETCH ViasCursor INTO @Id, @Shape
DECLARE @ResultId INT = 0
WHILE ( @@FETCH_STATUS = 0 ) 
    BEGIN
        IF NOT EXISTS ( SELECT Id FROM @ExistingIds WHERE Id = @Id )
            BEGIN
                DECLARE @Geo GEOMETRY = NULL

                SELECT  @Geo = COALESCE(@Geo.STUnion(Shape), Shape)
                WHERE   [Shape].STIntersects(@Shape) = 1

                INSERT  INTO @ExistingIds ( Id )
                SELECT  [Id]
                FROM    [dbo].[layer.2502]
                WHERE   [Shape].STIntersects(@Shape) = 1

                DECLARE @ExistingId INT = NULL
                SELECT @ExistingId = [ResultId] 
                FROM @Results
                WHERE Shape.STIntersects(@Geo) = 1

                IF @ExistingId IS NOT NULL
                    UPDATE @Results SET [Shape] = [Shape].STUnion(@Geo) 
                    WHERE ResultId = @ExistingId
                ELSE
                    BEGIN
                        INSERT INTO @Results ( [ResultId], [Shape] ) 
                        VALUES  ( @ResultId, @Geo )
                        SET @ResultId = @ResultId + 1
                    END
            END
        FETCH ViasCursor INTO @Id, @Shape
    END 
CLOSE ViasCursor
DEALLOCATE ViasCursor
SELECT * FROM @Results 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T15:16:24.957

如果没有要测试的模式和数据，很难为此创建一个可行的解决方案，但这里有一些建议。
在这个问题中，他们对空间数据进行分组，但包含而不是相交：[如何按 STWithin 对 SQL Server 几何数据进行分组？](https://stackoverflow.com/questions/8472457/how-can-i-group-sql-server-geometry-data-by-stwithin)
在这个问题中，他们在几何列上使用 STUnion：[联合 SQL Server 表中的所有几何，如 Postgres 中的 GeomUnion](https://stackoverflow.com/questions/3293190/union-all-geometry-in-a-sql-server-table-like-geomunion-in-postgres)
如果结合这些方法，您可能会想出一些可行的方法。

但是：我没有测试过性能，我的海报在上一个链接中确实警告过它......

我希望它至少可以有所启发。

# c# - 接口和异步方法

> ID：13573516
> 
> 赞同：52
> 
> 时间：2012-11-26T21:34:18.227
> 
> 标签：c#, interface, async-await

我有一个应用程序。此应用程序使用接口来访问数据库。这个接口可以被很多类实现。例如，一个使用 EF 4.4，但其他类可以使用更高效的 EF5。将来我可能会使用 EF6，因为它使用异步方法。在此示例中，所有方法都使用 EF，但也许其他选项可以使用其他方式。

应用程序编码一次，使用接口，并根据配置文件，使用一个实现或另一个，所以我只需要在一个地方修改代码，构造函数，在类的实例化中添加新选项分配给接口。

目前类的所有方法都不是`async`，但是将来如果我使用EF6我想使用异步方法，所以我不知道使用EF6并实现接口的类是否可以使用`async`方法。

对于 EF6 的异步方法，我会使用 async/awiat 模式，因此在我的类的方法中我需要使用 async 属性。这让我`await`在调用 EF6 的异步方法时可以使用关键字。

但是这个类可以实现第一次用于同步方法的接口吗？

有没有什么方法可以在主应用程序中使用许多实现而不需要修改代码？一些实现将使用异步方法，而其他实现将是同步的。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-11-26T21:47:17.267

`async`不是签名的一部分，所以你实际上不需要关心实现接口的方法是否是`async`，你只需要关心属性的类型，返回类型，名称方法和可访问性。

*真正的*区别在于您的`async`方法将需要返回 a`Task`或 a `Task<T>`，而非异步方法最有可能当前直接返回`void`或某种类型`T`。

如果您想“面向未来”您的应用程序，一种选择是确保您的所有接口都返回`Task`，或者`Task<T>`对于您的 EF4/EF5 实现，您将结果包装在一个已完成的任务中，即使它们是同步执行的。

`Task.FromResult`已在 .NET 4.5 中添加，但如果您没有它，您可以轻松编写自己的代码：

```
public static Task<T> FromResult<T>(T result)
{
    var tcs = new TaskCompletionSource<T>();
    tcs.SetResult(result);
    return tcs.Task;
} 
```

您还可以编写一个`CompletedTask`简单地返回已完成任务的方法：（出于效率原因，它缓存单个任务。）

```
private static Task _completedTask;
public static Task CompletedTask()
{
    return _completedTask ?? initCompletedTask();
}

private static Task initCompletedTask()
{
    var tcs = new TaskCompletionSource<object>();
    tcs.SetResult(null);
    _completedTask = tcs.Task;
    return _completedTask;
} 
```

这两种方法将简化让您的所有方法返回某种类型的过程`Task`，尽管这样做会使您的代码有点混乱，直到您能够使用 C# 5.0 来获得`await`结果。

# android - Android Socket 线程在处理器上添加非常高的负载

> ID：13573521
> 
> 赞同：0
> 
> 时间：2012-11-26T21:34:37.833
> 
> 标签：android, multithreading, sockets, processor

我正在我的 Galaxy S3 上调试我的应用程序，每当我监控处理过程时.. 我注意到应用程序处理的负载非常高。应用程序处理有时会达到 80%，这非常高

这是代码：

```
package com.example.socketclient;

import android.app.Activity;
import android.os.Bundle;

import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

import java.io.BufferedReader;
import java.io.BufferedWriter; 
import java.io.IOException; 
import java.io.OutputStreamWriter; 
import java.io.InputStreamReader;
import java.io.PrintWriter; 
import java.net.InetAddress; 
import java.net.Socket; 
import java.net.UnknownHostException; 
import android.util.Log; 

public class SocketCode extends Activity {
    private boolean connected = false;
    //private Handler handler = new Handler();
    public TextView txt;
    int doit=0;
    protected SocketCore Conn;
    public Button b;
    public EditText TextToSend;
    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_socket_code);
        b = (Button)findViewById(R.id.button1);
        txt = (TextView)findViewById(R.id.textView1);
        TextToSend = (EditText)findViewById(R.id.editText1);
        //Conn = new SocketCore(this,txt);
        b.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                 Log.e("ErrorButton","Button Pressed Before Toggle"+doit);  
             doit=1;
             Log.e("ErrorButton","Button Pressed "+doit);
            }
        }); 

        Thread cThread = new Thread(new ClientThread());
        cThread.start();

    }
    public class ClientThread implements Runnable {
        Socket socket ;
String finall="",text;
PrintWriter out = null;
BufferedReader in = null;

        public void run() {
            try {
                InetAddress serverAddr = InetAddress.getByName("192.168.0.150");
                Log.d("ClientActivity", "C: Connecting...");
                socket= new Socket(serverAddr,4444);
                connected = true;

                while (connected) {
                    try {

                      if(doit==1)
                      {
                          Log.e("ErrorButton","If");

                          out = new PrintWriter( new BufferedWriter( new OutputStreamWriter(socket.getOutputStream())),true); 
                        in = new BufferedReader(new InputStreamReader(socket.getInputStream()));                

                        out.println(TextToSend.getText().toString());
                       finall="";
                        while ((text = in.readLine()) != null) {
                            finall += text;
                            Log.e("Test","Final: "+finall);
                          if(text=="quit")
                          {
                              socket.close();
                          }
                      Log.e("ClientActivity", "After Read "+doit+" "+finall);

                       break;
                      } 

                      doit=0;

                      Log.e("ClientActivity", "Out Of IF "+doit);
                    runOnUiThread(new Runnable() {
                        public void run() {
                            txt.setText(finall);
                        }
                    });

                      }     

                    } catch (Exception e) {
                        Log.e("ClientActivity", "S: Error", e);
                    }

                }
                socket.close();
                txt.setText("Closed Socket");
                Log.d("ClientActivity", "C: Closed.");
            } catch (Exception e) {
                Log.e("ClientActivity", "C: Error", e);
                connected = false;
            }
        }

        public void ClientHandler(String Send)
        {
            try{
                PrintWriter out = new PrintWriter(new BufferedWriter(new OutputStreamWriter(socket
                       .getOutputStream())), true);
           out.println(Send);
            BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            finall = in.readLine();

            txt.setText(finall);
            }
            catch(IOException e)
            {txt.setText("Exception");}
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:41:57.680

CPU 这样做是因为您正在运行一个不间断的循环，该循环不断地将可运行对象提供给 UI 线程，因此 CPU 保持在非常高的负载下。相反，我建议您考虑使用推送策略而不是轮询策略，例如 GCM（Google Cloud Messaging），当您的服务器将新数据推送到设备上时，您的应用程序会唤醒。如果这不是一个可能的解决方案，我会将轮询速率限制为较低的速率并将其限制为每分钟几次（或更少），在 run() 中定期使用 Thread.sleep() 以避免淹没 UI 线程可运行的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T18:24:37.943

使用 Thread.Sleep(200) 修复；

```
while (connected) {
                    try {
                        Thread.sleep(200);
                        Log.e("ErrorButton","If");
                      if(doit==1)
                      { 
```

# javascript - jQuery：使用来自 Object Literal 的信息克隆 HTML

> ID：13573523
> 
> 赞同：1
> 
> 时间：2012-11-26T21:34:45.090
> 
> 标签：javascript, jquery, object

我有以下 HTML，我想在 div 容器 (.container) 中重复 5 次。

```
<div class="block">
   <div class="name">Name</div>
   <div class="content>Content</div>
</div> 
```

我有以下对象文字：

```
var main_content = {
    "content_1": {
        "name": "Joe",
        "position": "Baker"
    },
    "content_2": {
        "name": "Jane",
        "position": "Waitress"
    }
     "content_3", etc
} 
```

我想克隆顶部的 HTML 并为每个块，将名称和内容更改为其各自的对象文字项。所以我希望 HTML 的输出如下所示。我怎样才能做到这一点？

```
<div class="block">
   <div class="name">Joe</div>
   <div class="position>Baker</div>
</div>
<div class="block">
   <div class="name">Jane</div>
   <div class="position>Waitress</div>
</div>
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:41:31.750

使用 jQuery 应该相对容易。这对你有用吗？

```
for(var i in main_content)
{
    var name = main_content[i].name,
    position = main_content[i].position,

    template = $('<div class="block">\
                      <div class="name">'+name+'</div>\
                      <div class="position">'+position+'</div>\
                  </div>');

    template.appendTo($('.container'));
} 
```

请在此处查看有效的 jsFiddle 演示 > [http://jsfiddle.net/jLPkS/](http://jsfiddle.net/jLPkS/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:53:11.440

不要在循环中附加到 DOM：

```
var block, resultHtml = '';
for(block in main_content){
  resultHtml += '<div class="block"><div class="name">' + main_content[block].name + '</div><div class="position">' + main_content[block].position + '</div></div>'
}
$('your-selector').append(resultHtml); 
```

# c# - 自动添加/修改使用

> ID：13573524
> 
> 赞同：3
> 
> 时间：2012-11-26T21:34:49.187
> 
> 标签：c#, visual-studio-2010, plugins, namespaces

1.  有没有办法根据项目范围内的新文件夹结构自动设置类的命名空间，以便重构的文件夹和文件符合默认约定

> 命名空间 project.folder.subfolder

在 Visual Studio 2010 中？

1.  在重组项目并更改命名空间后，是否可以使用新命名空间在项目范围内自动调整 using 代码行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:39:50.673

[ReSharper使用](http://www.jetbrains.com/resharper/)[调整命名空间](http://www.jetbrains.com/resharper/webhelp/Refactorings__Adjust_Namespaces.html)功能很好地处理了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T21:40:21.127

在 Visual Studio 本身中，我不知道。

Resharper 插件具有“调整命名空间”功能，该功能将通过解决方案并将命名空间与文件夹结构相匹配。这也将解决参考重新映射。

# ruby-on-rails - 如何使用 Capybara 2.0 测试页面标题？

> ID：13573525
> 
> 赞同：19
> 
> 时间：2012-11-26T21:34:49.500
> 
> 标签：ruby-on-rails, rspec, capybara

尝试测试该页面包含`<title>My Title</title>`：

```
# spec/features/reports_spec.rb
require 'spec_helper'

feature "Archive Management" do
  subject { page }

  describe "Index Page" do
    before(:all) { 10.times { FactoryGirl.create(:randomreport) } }
    after(:all) { Report.delete_all }

    describe "when no search terms present" do
      before { visit reports_path }

      it { should have_selector('title', text: 'My Title') } # <= Fails w/Capybara 2.0
      it { should have_selector('title') }                   # <= passes
      it { should have_text('My Title') }                    # <= passes
      it { should have_selector('h2', text: "Welcome") }     # <= passes
    end
  end
end 
```

错误信息：

```
 Failure/Error: it { should have_selector('title', text: base_title) }
 Capybara::ExpectationNotMet:
   expected to find css "title" with text "My Title" but there were no matches. Also found "", which matched the selector but not all filters. 
```

我知道我忽略了痛苦的显而易见但无法弄清楚它是什么？`<title>`标签不再被视为“选择器”吗？！？或者...？！？

**编辑（调试器信息）**：

如果我按照@shioyama 的巧妙建议下拉到调试器中，很明显 page.body 包含`<title>My Title</title>`. 包含`<h2>Welcome to My Title Project</h2>`和传递的同一个 page.body！

它似乎找到了`<title>`...`</title>`标签，但不在`My Title`其中。但它确实`My Title`稍后会在页面内`<a href=\"/\" class=\"brand\">My Title</a>`和/或内找到`<h2>Welcome to The My Title Project</h2>`：

```
(rdb:1) p page
#<Capybara::Session>
(rdb:1) p page.body
"<!DOCTYPE html>\n<html>\n<head>\n<title>My Title</title>\n
<meta content='research, report, technology' name='keywords'>\n<meta 
content='Some Project' name='description'>\n<link href=\"/assets/application.css\"
...
</head>\n<body>\n<header class='navbar navbar-fixed-top 
navbar-inverse'>\n<div class='navbar-inner'>\n<div class='container'>\n
<a href=\"/\" class=\"brand\">My Title</a>\n<div class='pull-right'>\n
<ul class='nav'>\n<li><a href=\"/about\">About</a></li>\n<li><a href=\"/help\">Help</a>
</li>\n</ul>\n<form accept-charset=\"UTF-8\" action=\"/reports\" 
class=\"navbar-search\" method=\"get\"><div style=\"margin:0;padding:0;display:inline\">
<input name=\"utf8\" type=\"hidden\" value=\"&#x2713;\" /></div>\n
<input class=\"search-query\" id=\"query\" name=\"query\" 
placeholder=\"Search\" type=\"text\" />\n</form>\n\n</div>\n</div>\n</div>\n</header>\n\n
<div class='container'>\n<div class='hero-unit center'>\n<h1>My Title</h1>\n
<h2>Welcome to The My Title Project</h2>\n<p>Lorem ipsum dolor sit amet, consectetur 
adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
... 
```

我还能在调试器中尝试什么来找出为什么 have_selector?('title', text: ...) 失败了？

**那么，在 Capybara 2.0 中测试标题的正确方法是什么？**

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-07T01:49:16.577

当我升级到 Capybara 2.0 时，我遇到了同样的问题，并通过使用以下自定义 RSpec 匹配器设法解决了这些问题[`Capybara.string`](http://rubydoc.info/github/jnicklas/capybara/master/Capybara#string-class_method)：

**规范/支持/实用程序.rb**

```
RSpec::Matchers::define :have_title do |text|
  match do |page|
    Capybara.string(page.body).has_selector?('title', text: text)
  end
end 
```

现在，在一个规范文件中`subject { page }`，我可以使用：

```
it { should have_title("My Title") }
it { should_not have_title("My Title") } 
```

顺便说一句，关于这个问题的对话对我得到这个答案非常有帮助，所以谢谢！

### 更新1：

如果您不想创建自定义 RSpec 匹配器，感谢用户[dimuch提供的](https://stackoverflow.com/users/1416723/dimuch)[StackOverflow 答案](https://stackoverflow.com/a/14921891/567863)，我现在知道您可以直接调用(aliased ) 来测试不可见的 DOM 元素：`have_selector`[`page.source`](http://rubydoc.info/github/jnicklas/capybara/master/Capybara/Session#source-instance_method)`page.body`

```
it "should show the correct title" do
  page.source.should have_selector('title', text: 'My Title')
end 
```

或在哪里`subject { page }`：

```
its(:source) { should have_selector('title', text: 'My Title') } 
```

## 更新 2：

从 Capybara 2.1 开始，有内置的`have_title`/`has_title?`匹配器，在这个答案中不需要自定义 RSpec 匹配器。此外，`its(:source) { ... }`更新 1 中描述的测试似乎在 Capybara 2.1 下被破坏了；我已经确认`have_title`/`has_title?`按预期工作，因此如果您打算升级，最好使用以下语法：

什么时候`subject { page }`：

```
it { should have_title("My Title") }
it { should_not have_title("My Title") } 
```

在/块中使用`expect`语法时：`it``scenario`

```
expect(page).to have_title("My Title")
expect(page).to_not have_title("My Title") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-01T00:40:56.827

Capybara 2.1 更改了对查询标题元素的支持。因此，使用 have selector in 以这种方式查询 html 文档头部的标题元素将失败“page.should have_selector('title', :text => 'Some text')。据我了解首选方法在 capybara 2.1 中，新 API 是使用“page.should have_title('Some text')”来查询 title 元素应该可以工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-09-14T16:07:11.317

我在将 capybara 从 1.x 版本升级到 > 2.0 时遇到了同样的问题

问题是 Capybara 忽略了匹配器中的不可见文本。解决此问题的最简单方法是使用`:visible => false`查找器上的选项。

例如

`it { should have_selector('title', text: 'My Title', visible: false) }`

另一个（全局）选项是设置：

`Capybara.ignore_hidden_elements = false`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-13T16:04:49.357

我只有在使用“shared_examples_for”时才遇到这个问题，可能是因为其他变化。我还注意到，当我放置

```
<title>My Title</title>
```

在页面正文中（它不属于并且不会呈现的地方），测试通过了。不是什么好事！

这有效：

```
it{should have_title("My Title")}
```

（水豚 2.1.0，launchy 2.3.0，nokogiri 1.5.9，rspec 2.13）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-26T23:08:15.277

我在这里看到两个可能的问题：

1.  `<title>`标签存在于页面上，但文本位于页面的`My Title`其他位置，而不是标签内。这可以解释为什么其他测试通过了：`<title>`页面上有一个标签所以`have_selector('title')`通过了，页面`My Title`上有文本所以`have_text(base_title)`通过了。
2.  该`<title>`标签包含文本`My Title`以及其他内容，这也可以解释您看到的结果：`<title>`页面上有一个标签所以`have_selector('title')`通过，并且有文本`My Title`所以`have_text(base_title)`也通过，但是`text`选项`have_selector`是严格的，因此它将如果它找到一个不完全相等的字符串，则失败`My Title`。

您可以使用 xpath 选择器检查这两种可能性中的后者：`should have_xpath("//title[contains(.,'#{base_title}')]")`. 如果通过了，那么您的标题文本周围可能有一些空格或换行符，它们`have_selector`会出错（我认为它忽略了这些，但我可能是错的）。

希望有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-15T14:50:30.267

我知道这已经有一个公认的答案，但是对于它的价值，您可以用更少的代码行执行以下操作：

```
title = first("head title").native.text
expect(title).to == "What you expect it to match" 
```

这允许访问本机驱动程序元素；此外，由于 Capybara 2.0 忽略了不可见的文本（除了浏览器之外，标题是不可见的），您需要这个（或类似的解决方法）来满足这种情况。（见[https://github.com/jnicklas/capybara/issues/863](https://github.com/jnicklas/capybara/issues/863)）

# php - 使用 Mod_Rewrite 删除 URI 段。代码点火器

> ID：13573527
> 
> 赞同：0
> 
> 时间：2012-11-26T21:34:54.557
> 
> 标签：php, apache, codeigniter, mod-rewrite

是否可以使用 mod-rewrite 在 codeigniter 中删除 2 个 uri 段并仍然保持功能？

我不想使用 codeigniter 路由，因为它们似乎不是我需要的。

我有一个长网址：[http ://site.com/product/details/3/royal-blue-choir-stole](http://site.com/product/details/3/royal-blue-choir-stole)

我想使用 mod-rewrite 更改为：[http ://site.com/royal-blue-choir-stole](http://site.com/royal-blue-choir-stole)

是否可以保留功能但重新编写 URL，类似于开源 CMS 系统的做法？

我当前的 htaccess 文件只有从 url 中删除 index.php 的代码：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule .* index.php/$0 [PT,L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:05:53.147

尝试这样的事情......

```
RewriteRule ^(.*)$ index.php?product/details/$0 [PT,L] 
```

# php - 如果连接缓慢，对 Microsoft Translator API 的 PHP 服务器端请求会引发丑陋的超时错误

> ID：13573531
> 
> 赞同：1
> 
> 时间：2012-11-26T21:35:11.517
> 
> 标签：php, api, language-translation, microsoft-translator

我有一个使用 PHP 到 Bing 的服务器端调用，将输入结果从一种语言存储为英语。如果连接速度很慢，该函数将超时并抛出一个时间超过 30 秒的丑陋 PHP 错误。有没有办法在 10 秒后停止翻译功能尝试并向用户抛出我写的自定义错误，而不是抛出系统错误？

脚本中调用的 PHP 代码：

```
//Translate product description from native language to english with Bing (Microsoft) API
if ($_POST['Translate_Code'] != 'en' ){//do not translate if already in english
require_once('./classes/Az1/BingTranslate.php');
$gt = new Az1_BingTranslateWrapper();
$lang_trans = $_POST['Translate_Code'];
/* Translate from "Native Language" to "English" */
$eng_description = $gt->translate($description, $lang_trans, "en");
} else{//language is english
    $eng_description= $description;
} 
```

必应翻译类相关：

```
class Az1_AccessTokenAuthentication {
/*
 * Get the access token.
 *
 * @param string $grantType    Grant type.
 * @param string $scopeUrl     Application Scope URL.
 * @param string $clientID     Application client ID.
 * @param string $clientSecret Application client ID.
 * @param string $authUrl      Oauth Url.
 *
 * @return string.
 */
function getTokens($grantType, $scopeUrl, $clientID, $clientSecret, $authUrl){
    try {
        //Initialize the Curl Session.
        $ch = curl_init();
        //Create the request Array.
        $paramArr = array (
             'grant_type'    => $grantType,
             'scope'         => $scopeUrl,
             'client_id'     => $clientID,
             'client_secret' => $clientSecret
        );
        //Create an Http Query.//
        $paramArr = http_build_query($paramArr);
        //Set the Curl URL.
        curl_setopt($ch, CURLOPT_URL, $authUrl);
        //Set HTTP POST Request.
        curl_setopt($ch, CURLOPT_POST, TRUE);
        //Set data to POST in HTTP "POST" Operation.
        curl_setopt($ch, CURLOPT_POSTFIELDS, $paramArr);
        //CURLOPT_RETURNTRANSFER- TRUE to return the transfer as a string of the return value of curl_exec().
        curl_setopt ($ch, CURLOPT_RETURNTRANSFER, TRUE);
        //CURLOPT_SSL_VERIFYPEER- Set FALSE to stop cURL from verifying the peer's certificate.
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
        //Execute the  cURL session.
        $strResponse = curl_exec($ch);
        //Get the Error Code returned by Curl.
        $curlErrno = curl_errno($ch);
        if($curlErrno){
            $curlError = curl_error($ch);
            throw new Exception($curlError);
        }
        //Close the Curl Session.
        curl_close($ch);
        //Decode the returned JSON string.
        $objResponse = json_decode($strResponse);
        if ($objResponse->error){
            throw new Exception($objResponse->error_description);
        }
        return $objResponse->access_token;
    } catch (Exception $e) {
        echo "Exception-".$e->getMessage();
    }
}
}

/*
* Class:HTTPTranslator
* 
* Processing the translator request.
*/
class Az1_HTTPTranslator {
/*
 * Create and execute the HTTP CURL request.
 *
 * @param string $url        HTTP Url.
 * @param string $authHeader Authorization Header string.
 * @param string $postData   Data to post.
 *
 * @return string.
 *
 */
function curlRequest($url, $authHeader, $postData=''){
    //Initialize the Curl Session.
    $ch = curl_init();
    //Set the Curl url.
    curl_setopt ($ch, CURLOPT_URL, $url);
    //Set the HTTP HEADER Fields.
    curl_setopt ($ch, CURLOPT_HTTPHEADER, array($authHeader,"Content-Type: text/xml"));
    //CURLOPT_RETURNTRANSFER- TRUE to return the transfer as a string of the return value of curl_exec().
    curl_setopt ($ch, CURLOPT_RETURNTRANSFER, TRUE);
    //CURLOPT_SSL_VERIFYPEER- Set FALSE to stop cURL from verifying the peer's certificate.
    curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, False);
    if($postData) {
        //Set HTTP POST Request.
        curl_setopt($ch, CURLOPT_POST, TRUE);
        //Set data to POST in HTTP "POST" Operation.
        curl_setopt($ch, CURLOPT_POSTFIELDS, $postData);
    }
    //Execute the  cURL session.
    $curlResponse = curl_exec($ch);
    //Get the Error Code returned by Curl.
    $curlErrno = curl_errno($ch);
    if ($curlErrno) {
        $curlError = curl_error($ch);
        throw new Exception($curlError);
    }
    //Close a cURL session.
    curl_close($ch);
    return $curlResponse;
}
}

class Az1_BingTranslateWrapper{
protected $_clientID = "####"; //Client ID of the application
protected $_clientSecret = "####";//Client Secret key of the application   
protected $_authUrl = "https://datamarket.accesscontrol.windows.net/v2/OAuth2-13/";//OAuth Url
protected $_scopeUrl = "http://api.microsofttranslator.com";//Application Scope Url
protected $_grantType = "client_credentials";//Application grant type
protected $_accessToken = "";//Id generated from Microsoft
protected $_authHeader = "";//Takes access token created for input in Url
protected $_detectMethodUrl = "";//Forms Url for translation
protected $_strResponse = "";//translation of supplied text

public function translate($text, $lang_from, $lang_to){

//Create the AccessTokenAuthentication object.
$authObj      = new Az1_AccessTokenAuthentication();
//Get the Access token.
$this->_accessToken  = $authObj->getTokens($this->_grantType,$this->_scopeUrl,$this->_clientID,$this->_clientSecret,$this->_authUrl);
//Create the authorization Header string.
$this->_authHeader = "Authorization: Bearer ". $this->_accessToken;

//Create the Translator Object.
$translatorObj = new Az1_HTTPTranslator();

//HTTP Detect Method URL.
$this->_detectMethodUrl = "http://api.microsofttranslator.com/V2/Http.svc/Translate?text=".urlencode($text)."&from=".$lang_from."&to=".$lang_to;
//Ask for response as JSON
//Call the curlRequest.
$this->_strResponse = $translatorObj->curlRequest($this->_detectMethodUrl, $this->_authHeader);
//Remove XML formatting
$str_start = strrpos($this->_strResponse,'/">')+3;
$this->_strResponse = substr($this->_strResponse,$str_start,strlen($this->_strResponse)-$str_start-9);
return $this->_strResponse;
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:29:19.913

好的，您正在使用 cURL - 只需将其设置`CURLOPT_TIMEOUT`为小于您的 max_execution_time 的值，然后在该超时时抛出异常。然后处理它......简单的peasy :-)

应该注意的是，值以`CURLOPT_TIMEOUT`秒为单位，但也有`CURLOPT_TIMEOUT_MS`以毫秒为单位的值。

此外，还有许多[其他选项](http://php.net/manual/en/function.curl-setopt.php)可以处理超时和连接速度、dns 分辨率和整体带宽。您可能还想利用这些

# c++ - 为指针后面的对象创建比较器的通用方法

> ID：13573532
> 
> 赞同：2
> 
> 时间：2012-11-26T21:35:26.203
> 
> 标签：c++, sorting, pointers, compare, functor

我使用数据结构，并且对这些数据结构进行了很多排序。这些数据结构持有指向对象的指针，而不是直接指向对象本身。现在我可以编写一个简单的比较函子或函数来告诉排序算法如何对指针进行排序：

```
struct Object_ptr_comparer {
    bool operator()(const Object* first, const Object* second) {
        return *first < *second;
    }
}; 
```

并使用例如`std::sort`：

```
Object_ptr_comparer comp;
std::sort(data_str.begin(), data_str.end(), comp); 
```

这个解决方案的唯一问题是我必须为任何类型的类编写额外的指针比较器仿函数。是的，我可以使用继承和多态性来只编写某个根类的比较器，但我不想这样做。有没有其他聪明的方法来做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-26T21:37:07.010

模板呢？

```
struct ptr_comparer {
    template<typename T>
    bool operator()(const T* first, const T* second) {
        return *first < *second;
    }
}; 
```

像这样使用：

```
std::sort(data_str.begin(), data_str.end(), ptr_comparer()); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-26T21:37:25.210

这就是模板的用途！

```
struct ptr_comparer {
    template<class Object>
    bool operator()(const Object* first, const Object* second) const {
        return std::less<Object>()(*first, *second);
    }
};

std::sort(data_str.begin(), data_str.end(), ptr_comparer()); 
```

由于我已经模板化了操作符而不是直接专门化比较器，编译器可以推导出类型，所以我们不必直接放入类型。

我使用`std::less`而不是`operator<`，因为它安全地将指针与指针（如`char**`）进行比较，而不是依赖于未定义的行为。 `std::less`fall back on `operator<`，因此它不会增加调用代码的任何复杂性，并且应该没有缺点。

[我确定这个编译](http://ideone.com/EZGyi6)

# http - HTTP“会话”重建如何工作？

> ID：13573537
> 
> 赞同：2
> 
> 时间：2012-11-26T21:35:45.217
> 
> 标签：http, network-programming, sniffing

我在网上找到了这个工具：[http ://www.unleashnetworks.com/products/unsniff.html](http://www.unleashnetworks.com/products/unsniff.html)

这是如何运作的？他们是否假设会话的所有 HTTP 流量都发生在同一个 TCP 会话中，然后只是将所有这些数据聚集在一起？这是一个安全的假设吗？

我的印象是，当我加载一个页面时，可能会为单个页面加载（图像、视频、flash 等等）运行多个 TCP 会话。

当我考虑打开两个同时加载页面的浏览器选项卡时，这似乎变得复杂了。我如何区分一个 http“会话”和另一个？如果他们点击同一页面，尤其如此，对吧？

就此而言，浏览器如何知道传入的哪些数据属于哪个选项卡？它是否跟踪属于单个选项卡的 TCP 会话？

编辑：

当上面提到 HTTP 会话时，我指的是加载页面所需的所有相关 HTTP 事务。

通过 TCP 会话，我实际上是指握手的 SYN -> FIN 数据包生命周期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:05:21.840

尽管它可能不可见，但 HTTP 会话跟踪器正在从客户端作为参数或 e cookie（标头）传递到服务器

您可能需要阅读有关[HTTP 会话令牌的信息](http://en.wikipedia.org/wiki/Session_%28computer_science%29)

会话令牌是从服务器生成并发送到客户端以标识当前交互会话的唯一标识符。客户端通常将令牌存储并作为 HTTP cookie 发送和/或将其作为 GET 或 POST 查询中的参数发送。使用会话令牌的原因是客户端只需要处理标识符——所有会话数据都存储在与该标识符链接的服务器上（通常在数据库中，客户端无法直接访问该数据库）。一些编程语言在命名其 HTTP cookie 时使用的名称示例包括 JSESSIONID (JSP)、PHPSESSID (PHP) 和 ASPSESSIONID (ASP)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:11:17.677

我不熟悉您链接到的“Unsniff”应用程序，但我之前使用过一些数据包嗅探器（我最喜欢的是[Wireshark](http://www.wireshark.org/ "线鲨")）。通常，您可以根据会话连接到的主机来区分会话。因此，例如，如果您打开了 2 个选项卡，其中一个打开到 www.google.com，另一个是 www.facebook.com，则数据包嗅探器应该能够告诉您哪个会话指向哪个主机（或至少给你一个 IP 地址，然后你可以用它来查找主机。请参阅：[反向查找](http://en.wikipedia.org/wiki/Reverse_DNS_lookup)）。

大多数情况下，多个 HTTP 会话将对一台主机开放。当您加载站点的各种资源（CSS 文件、图像、javascript 等）时就是这种情况。这些资源中的每一个都将显示为一个单独的 HTTP 会话（当然，除非连接是[持久](http://en.wikipedia.org/wiki/HTTP_persistent_connection)的……但是您的嗅探器应该能够将它们分开）。在这种情况下，您（或嗅探器）将需要通过查看 HTTP 数据包中的实际数据来确定下载的内容。

# android - 如何将 Fragment/ViewPager 选项卡转换为全屏

> ID：13573539
> 
> 赞同：2
> 
> 时间：2012-11-26T21:35:46.180
> 
> 标签：android, android-fragments, android-tabs

基本上，我要问的内容与打开屏幕上的 Twitter 应用程序 Plume 中的功能相同。在小屏幕（手机）上，您可以来回滑动三个选项卡。我有这个确切的设置。在平板电脑上它看起来很糟糕，因为有太多的空白。在 Plume 中，他们只是在屏幕上加载了所有三个选项卡——没有滑动，它们都显示出来，每个都占据屏幕的 1/3。更好地利用空间。你怎么做到这一点？

这是我的代码：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.fragment_layout);

    mSectionsPagerAdapter = new SectionsPagerAdapter(
            getSupportFragmentManager());

    final ActionBar actionBar = getActionBar();
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

    mViewPager = (ViewPager) findViewById(R.id.viewpager);
    mViewPager.setAdapter(mSectionsPagerAdapter);
    mViewPager.setOffscreenPageLimit(3);

    mViewPager
            .setOnPageChangeListener(new ViewPager.SimpleOnPageChangeListener() {
                @Override
                public void onPageSelected(int position) {
                    actionBar.setSelectedNavigationItem(position);

                }
            });

    for (int i = 0; i < mSectionsPagerAdapter.getCount(); i++) {
        actionBar.addTab(actionBar.newTab()
                .setText(mSectionsPagerAdapter.getPageTitle(i))
                .setTabListener(this));
    }

    catName = getSharedPreferences("catName", Context.MODE_PRIVATE);
    itemName = getSharedPreferences("itemName", Context.MODE_PRIVATE);

    mViewPager.setCurrentItem(1);

}

public void onTabUnselected(ActionBar.Tab tab,
        FragmentTransaction fragmentTransaction) {

}

@Override
public void onSaveInstanceState(Bundle savedInstanceState) {
    super.onSaveInstanceState(savedInstanceState);
}

@Override
public void onRestoreInstanceState(Bundle savedInstanceState) {
    super.onRestoreInstanceState(savedInstanceState);

}

public void onTabSelected(ActionBar.Tab tab, FragmentTransaction ft) {
    mViewPager.setCurrentItem(tab.getPosition());
}

public void onTabReselected(ActionBar.Tab tab,
        FragmentTransaction fragmentTransaction) {
}

public class SectionsPagerAdapter extends FragmentPagerAdapter {

    public SectionsPagerAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public Fragment getItem(int position) {
        Fragment f = null;
        switch (position) {
        case 0: {
            f = new MasterFrag();
            Bundle args = new Bundle();

            f.setArguments(args);
            break;
        }
        case 1: {
            f = new FeaturedFrag();
            Bundle args = new Bundle();

            f.setArguments(args);
            break;
        }

        case 2: {
            f = new TopFrag();
            Bundle args = new Bundle();

            f.setArguments(args);
            break;
        }

        default:
            throw new IllegalArgumentException("not this many fragments: "
                    + position);
        }

        return f;

    }

    @Override
    public int getCount() {
        return 3;
    }

    @Override
    public CharSequence getPageTitle(int position) {
        switch (position) {
        case 0:
            return getString(R.string.mastercattab1).toUpperCase(Locale.ENGLISH);
        case 1:
            return getString(R.string.mastercattab2).toUpperCase(Locale.ENGLISH);
        case 2:
            return getString(R.string.mastercattab3).toUpperCase(Locale.ENGLISH);

        }
        return null;
    }
} 
```

**这是我的 XML 片段布局：**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TabHost
        android:id="@android:id/tabhost"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:orientation="vertical" >

            <TabWidget
                android:id="@android:id/tabs"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_weight="0"
                android:orientation="horizontal" />

            <FrameLayout
                android:id="@android:id/tabcontent"
                android:layout_width="0dp"
                android:layout_height="0dp"
                android:layout_weight="0" />

            <android.support.v4.view.ViewPager
                android:id="@+id/viewpager"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight="1" />
        </LinearLayout>
    </TabHost>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T01:02:14.647

有了您最近的答案和有效的 xml 布局以及下面的代码，我认为这似乎很简单！:)

编辑：所以想法是您有两种 XML 布局，一种用于中小型屏幕（您的第一篇文章中的 xml），另一种用于平板电脑、大型和 xlarge（您的工作答案中的 xml）。

理论上，您可以像这样在两者之间切换：

```
public class YourClassName extends FragmentActivity {

    static boolean isTablet = false;
    static ActionBar actionBar = null;

public void onCreate(Bundle savedInstanceState) {
    actionBar = getActionBar();

    if ((getResources().getConfiguration().screenLayout & Configuration.SCREENLAYOUT_SIZE_MASK) >= Configuration.SCREENLAYOUT_SIZE_LARGE) {     
        setContentView(R.layout.single_pane_fragment_layout);
        isTablet = true;
    } else {
        setContentView(R.layout.viewpager_fragment_layout);
    }
... 
```

然后，您可以尝试在片段活动中的 onTabSelected 中调用以下代码，但您可能希望在 onCreateView 下的片段中调用它。注意我将变量设为静态。

例子：

```
if (YourClassName.actionBar != null && YourClassName.actionBar.isShowing() && YourClassName.isTablet) {
    YourClassName.actionBar.removeAllTabs();
} 
```

这里还有关于 ActionBar.hide() 和 .removeAllTabs() 的更多信息：http: [//developer.android.com/reference/android/app/ActionBar.html#hide%28%29](http://developer.android.com/reference/android/app/ActionBar.html#hide%28%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T20:01:22.497

我只是以谷歌网站上的这段代码为例：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:orientation="horizontal"
  android:layout_width="match_parent"
  android:layout_height="match_parent"
  android:id="@+id/frags">
    <!-- "Fragment A" -->
  <fragment class="com.example.android.TitlesFragment"
            android:id="@+id/list_frag"
            android:layout_width="@dimen/titles_size"
            android:layout_height="match_parent"/>
    <!-- "Fragment B" -->
  <fragment class="com.example.android.DetailsFragment"
            android:id="@+id/details_frag"
            android:layout_width="match_parent"
            android:layout_height="match_parent" />
</LinearLayout> 
```

然后我不得不添加`ViewPager`上面的两个片段。

# node.js - 如何在快递中动态呈现/加载页面？

> ID：13573540
> 
> 赞同：4
> 
> 时间：2012-11-26T21:35:51.057
> 
> 标签：node.js, dynamic, express, socket.io, real-time

我需要使用 express (>3.0) 框架在 nodejs (v1.8.15) 中动态加载/渲染页面的一部分。通常，我想创建一个单页应用程序。

我在页面顶部有一个带有链接的菜单。单击链接将更改下面的内容，就像在 AJAX 页面加载中一样。

例如：

```
>home|login|signup|chat
..content for home.. 
```

如果我按“注册”链接：

```
home|login|>signup|chat
..content for signup.. 
```

在快递中，我在服务器上有路由：

```
var express = require('express');
var app = express();

app.get('/signup', function(req, res) {
    // render signup.jade
    res.render('signup');
}
app.post('/signup', function(req, res) {
    // .. work with information
    if (ok) res.send('ok', 200); else res.send(error, 200);
} 
```

读完后[，](http://blog.nodejitsu.com/single-page-apps-with-nodejs)我发现我应该使用 socket.io。我很了解套接字，因此很容易将有关“单击链接”的数据从客户端发送到服务器。

**Q1：如何像我在 express 中写的那样动态渲染/加载页面？**

是的，我可以使用 AJAX 进行页面加载，但它适用`.post`于 express 方法吗？我应该如何组织我的想法来创建这样一个网站？

顺便说一句，我读过[Derby](http://derbyjs.com/)和[SocketStream](http://socketstream.org/)，但我不明白。

**Q2：我可以在我的目标中使用 Derby 或 SocketStream（网站功能：登录、注册、聊天）吗？如何？**

如果 SocketStream 是我需要的，那将非常糟糕，因为 Heroku 不能使用它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-27T08:30:36.190

Q1) 这其实很简单，不需要 Socket.io、Derby 什么的。你可以通过ajax用任何方法调用任何expess路由，使用jQuery让ajax变得非常简单。在您的示例中，假设您的容器 HTML 文件有一个 id 为“容器”的 div，这是您希望 ajax 加载的内容所在的位置：

```
$.ajax({ url: 'http://yoursite.com/signup'
     , type: 'GET'
     , dataType: 'html'
    })
.done(function(data) {
  $('#container').html(data);
})
.fail(function() {
  console.log("Something went wrong!");
}); 
```

Express 支持所有 HTTP 动词（GET、POST、PUT 等）。对于动态加载页面，请使用 GET，然后当用户输入一些登录信息时，您可以将其发布到 Express 路由，该路由会告诉您它是否有效，然后您使用 jQuery 相应地修改 DOM。

Q2) 如 Q1 所述，无需使用 Derby 或 SocketStream。简单的旧 jQuery + 基本 Express 将带您到您想要的地方！

# ios - 在ios上编译opencv2.4.3后出错

> ID：13573542
> 
> 赞同：3
> 
> 时间：2012-11-26T21:36:12.847
> 
> 标签：ios, xcode, opencv, xcode4.5

在使用来自官方 opencv.org 的框架 2.4.3 后，在 xcode for iOS 上编译应用程序时，我一直面临以下问题。有什么线索吗？

```
ld: warning: directory not found for option '-F/Users/Anas/Downloads/ocr-text-extraction-master  /n/trunk/StaticImagesFaceDetectionSample/../../ocv.build/ios'
Undefined symbols for architecture armv7:
"std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >::compare(char const*) const", referenced from:
  cv::CascadeClassifier::Data::read(cv::FileNode const&) in opencv2(cascadedetect.o)
 ...
 ...

 ...

 cv::Exception::formatMessage() in opencv2(system.o)
 ld: symbol(s) not found for architecture armv7
 clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T09:20:21.420

你在使用 OpenCV 提供的通用 iOS 框架吗？

如果没有，我强烈建议您使用它：[OpenCV for iOS](http://sourceforge.net/projects/opencvlibrary/files/opencv-ios/2.4.3/opencv2.framework.zip/download)。只需下载它，将其放入您的 iOS 项目并添加导入即可。

您还可以在每个 C++ 兼容源文件 ( , ) 中添加此内容`myApp-Prefix.pch`以导入 OpenCV ：`.mm``.cpp`

```
#ifdef __cplusplus
  #import <opencv2/opencv.hpp>
#endif 
```

**编辑**

还要确保将`opencv2.framework`其添加到您正在构建的目标中。要将其添加到目标，请在选中时打开 Xcode (Utilities) 中的右侧菜单`opencv2.framework`。文件检查器中有一个名为“目标成员资格”的下拉菜单。如果您选择它，它会将框架添加到目标。

**编辑 2**

要确保的另一件事是导入正确的标头以使用`cv::CascadeClassifier`：

```
#import <opencv2/imgproc/imgproc_c.h>
#import <opencv2/objdetect/objdetect.hpp> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-28T06:23:11.540

这个问题有一个非常简单的解决方案，也让我绊倒了好几个小时。解决方法是确保 View Controller 或任何使用 Open CV 库的 iOS 视图是**.MM**文件而不是 .M 文件。这将导致文件被视为 C++ 文件（这会导致以下预编译头指令启动，并且所有链接器错误都将消失。

```
#ifdef __cplusplus
  #import <opencv2/opencv.hpp>
#endif 
```

# windows-8 - 如何在 Windows 8 中显示数据网格？

> ID：13573549
> 
> 赞同：0
> 
> 时间：2012-11-26T21:36:43.323
> 
> 标签：windows-8

在 Windows 8 中显示数据网格的最简单方法是什么？

例如：

```
NAME  SURNAME BIRTHDATE
John  Nime    17NOV04
Mary  Kalas   28NOV06
Dinio Fransen 17NOV04 
```

数据网格不需要可编辑，只需显示数据即可。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T09:43:02.650

这家伙在[这里](http://blogs.msdn.com/b/mikezh/archive/2012/07/26/windows-8-metro-app-how-to-get-a-data-grid-like-ui-for-a-collection-of-items.aspx)做过类似的事情。

但在做任何事情之前，请查看关于 SO的[这个问题的答案。](https://stackoverflow.com/questions/12228119/create-a-table-datagrid-in-windows-8-metro-apps-c-xaml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T07:25:25.110

Windows 8 应用程序中没有数据网格，但有 Grid View 或 List View 控件。

# python - 谁能帮助我的拼写检查代码？

> ID：13573552
> 
> 赞同：-5
> 
> 时间：2012-11-26T21:36:48.387
> 
> 标签：python, python-2.7

这就是我所拥有的，评论描述了我想要做什么

在文本文件中放置了一些单词，其中一些单词拼写错误，并且测试文本文件也将用于拼写检查。

例如 >>> spellCheck("test1.txt") {'exercsie': 1, 'finished': 1}

```
from string import ascii_uppercase, ascii_lowercase
def spellCheck(textFileName):

    # Use the open method to open the words file.
    # Read the list of words into a list named wordsList
    # Close the file

    file=open("words.txt","r")
    wordsList = file.readlines()
    file.close()

    # Open the file whos name was provided as the textFileName variable
    # Read the text from the file into a list called wordsToCheck
    # Close the file

    file=open(textFileName, "r")
    wordsToCheck = file.readlines()
    file.close()

    for i in range(0,len(wordsList)): wordsList[i]=wordsList[i].replace("\n","")
    for i in range(0,len(wordsToCheck)): wordsToCheck[i]=wordsToCheck[i].replace("\n","")

    # The next line creates the dictionary
    # This dictionary will have the word that has been spelt wrong as the key and the number of times it has been spelt wrong as the value
    spellingErrors = dict(wordsList)

    # Loop through the wordsToCheck list
    # Change the current word into lower case
    # If the current word does not exist in the wordsList then
            # Check if the word already exists in the spellingErrors dictionary
                    # If it does not exist than add it to the dictionary with the initial value of 1.
                    # If it does exist in the dictionary then increase the value by 1

    # Return the dictionary
    char_low = ascii_lowercase
    char_up = ascii_uppercase
    for char in wordsToCheck[0]:
       if char in wordsToCheck[0] in char_up:
            result.append(char_low)
    for i in wordsToCheck[0]:
       if wordsToCheck[0] not in wordsList:
            if wordsToCheck[0] in dict(wordsList):
                    dict(wordsList) + 1
            elif wordsToCheck[0] not in dict(wordsList):
                    dict(wordsList) + wordsToCheck[0]
                    dict(wordsList) + 1
    return dict(wordsList) 
```

我的代码返回错误

Traceback（最近一次调用最后）：文件“”，第 1 行，在 spellCheck("test1.txt") 文件“J:\python\SpellCheck(1).py”，第 36 行，在 spellCheck spellingErrors = dict(wordsList) ValueError：字典更新序列元素 #0 的长度为 5；2 是必需的

那么任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-26T22:00:37.227

我应用了[PEP-8](http://www.python.org/dev/peps/pep-0008/)并重写了 unpythonic 代码。

```
import collections

def spell_check(text_file_name):
    # dictionary for word counting
    spelling_errors = collections.defaultdict(int)

    # put all possible words in a set
    with open("words.txt") as words_file:
        word_pool = {word.strip().lower() for word in words_file}

    # check words
    with open(text_file_name) as text_file:
        for word in (word.strip().lower() for word in text_file):
            if not word in word_pool:
                spelling_errors[word] += 1

    return spelling_errors 
```

您可能想了解[with 语句](http://www.python.org/dev/peps/pep-0343/)和[defaultdict](http://docs.python.org/2/library/collections.html#collections.defaultdict)。

带有`ascii_uppercase`和`ascii_lowercase`尖叫的代码：[阅读教程](http://docs.python.org/2/tutorial/index.html)并学习基础知识。该代码是“我不知道自己在做什么，但无论如何我都会这样做”的集合。

**关于您的旧代码的更多解释**：

你用

```
char_low = ascii_lowercase 
```

没有必要，`char_low`因为您从不操纵该值。就用原版吧`ascii_lowercase`。然后是您的代码的以下部分：

```
for char in wordsToCheck[0]:
    if char in wordsToCheck[0] in char_up:
        result.append(char_low) 
```

我不太确定你想在这里做什么。您似乎想将列表中的单词转换为小写。事实上，如果该代码可以运行（它不会运行），您将为`result`列表中单词的每个大写字符附加整个小写字母。不过，您不会`result`在后面的代码中使用，因此不会造成任何伤害。很容易`print wordsToCheck[0]`在循环之前添加 a 或`print char`在循环中添加 a 以查看那里发生了什么。

代码的最后一部分只是一团糟。您只访问每个列表中的第一个单词 - 可能是因为您不知道该列表的外观。*那是通过反复试验*进行编码。*尝试通过知识*进行编码。

你真的不知道 a做什么`dict`以及如何使用它。我可以在这里解释它，但是您可能想先阅读 www.python.org 上的这个精彩教程，尤其[是处理字典的章节](http://docs.python.org/2/tutorial/datastructures.html#dictionaries)。如果您研究了这些解释但仍然不理解，请随时提出有关此的新问题。

我使用 a`defaultdict`而不是标准字典，因为它使这里的生活更轻松。如果您将我的代码的一部分定义`spelling errors`为`dict`

```
if not word in word_pool:
    if not word in spelling_errors:
        spelling_errors[word] = 1
    else:
        spelling_errors[word] += 1 
```

顺便说一句，我编写的代码为我运行没有任何问题。我得到一个字典，其中缺少的单词（小写）作为键，该单词的计数作为相应的值。

# python - 损坏的图像 - Google App Engine

> ID：13573556
> 
> 赞同：1
> 
> 时间：2012-11-26T21:37:13.213
> 
> 标签：python, image, forms, google-app-engine

首先，我意识到这是一个相当常见的问题，我查看了许多其他类似的 StackOverflow 问题，但没有一个答案能解决问题。

基本上，一旦用户提交图像->它们被发布为空白图像-当我单击图像的 src 时，我会进入一个空白页面。我的代码有什么问题？

这是来自各种文件的我的代码片段的混搭

```
<div class="card-image"><img src="/image?img_id={{card.key()}}"></img>

class Card(db.Model):
    image = db.BlobProperty(required = True)

class Image(MainHandler):
    def get(self):
        card = db.get(self.request.get('img_id'))
        if card.image:
            self.response.headers['Content-Type'] = 'image/png'
            self.response.out.write(card.image)
        else:
            self.response.out.write('No image')
 class Gallery(MainHandler):
       image = db.Blob(images.resize(self.request.get('image'), 32, 32))
       #later in the code, a Card is constructed. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:17:31.810

你的代码对我来说看起来不错。您确定您的模型包含图像数据吗？

第二。有一种更好、更快、更便宜的方式可以为您的图像提供服务。Google 可以使用 App Engine 的高性能图像服务系统为您提供图像，几乎是免费的，并且具有运行时大小。要使用它，您必须使用 blobstore 并使用 get_serving_url。

以下是服务网址的示例：

[https://lh6.ggpht.com/1HjICy6ju1e2GIg83L0qdliUBmPHUgKV8FP3QGK8Qf2pHVBfwkpO_V38ifAPm-9m20q_3ueZzdRCYQNyDE3pmA695iaLunjE=s0](https://lh6.ggpht.com/1HjICy6ju1e2GIg83L0qdliUBmPHUgKV8FP3QGK8Qf2pHVBfwkpO_V38ifAPm-9m20q_3ueZzdRCYQNyDE3pmA695iaLunjE=s0)

**更新**

如果您是 blobstore 的新手，我的建议是开始从 blobstore 上传和提供图像。请参阅文档中的代码示例。

完成此工作后，您可以优化和使用 get_serving_url。您只需获取此服务 url 一次并保存在数据存储中，因此您可以在 html img 标记中使用 in。

下面是获取 blobstore blob 的服务 url 的代码示例，其中 blob 引用保存在数据存储中：

```
class Dynamic(db.Model):                                                                        # key : name
    name = db.StringProperty() 
    blob_ref = blobstore.BlobReferenceProperty()
    serving_url = db.LinkProperty()

dyn= Dynamic.get_by_key_name(key_name)
try :                                                                               # get url with size = 0, do not save it
    dyn.serving_url = images.get_serving_url(dyn.blob_ref, size=None, secure_url=True)
except DeadlineExceededError : 
    try :             # sometimes this request fails, retry. This always works fine
        dyn.serving_url = images.get_serving_url(dyn.blob_ref, size=None, secure_url=True)
    except DeadlineExceededError :
        logging.error('Image API get_serving_url deadline error after retry' %(dyn.key().name()))                        
                return None
    dyn.put() 
```

# css - 当我将 css 应用到单选按钮时，它不起作用

> ID：13573561
> 
> 赞同：0
> 
> 时间：2012-11-26T21:37:33.993
> 
> 标签：css, html

CSS：

```
input[type='radio'] {

    position: absolute;
    left: 42.5em;
    top: 29.5em;    

}

input[type='radio'][value='no'] {

    position: absolute;
    left: 46.4em;
    top: 29.5em;    
} 
```

HTML：

```
<input type="radio" name="relocate" value="yes" />Yes<br>
<input type="radio" name="relocate" value="no" />No 
```

当我将样式应用于单选按钮时，它不起作用，它不会切换，它会卡住。CSS HTML

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:08:39.750

你的问题是`position:absolute;`，因为一个元素的定位是相对于第一个父元素的位置不是静态的。由于您在此示例中没有任何父定位，因此`input`相对于`html`块定位。

# c++ - 如何让 Emacs 用我的代码缩进我的 // 注释？

> ID：13573564
> 
> 赞同：11
> 
> 时间：2012-11-26T21:37:49.240
> 
> 标签：c++, c, emacs

我对 Emacs 不太了解，但经过一番谷歌搜索后，我`.emacs`将文件编辑为如下：

```
(setq c-default-style "bsd" c-basic-offset 4) 
```

我的目标是使用 4 间隔制表符获得 Allman 风格的缩进。它按预期工作，但现在我的`//`评论没有缩进我的代码。在我更改它之前，当我输入 时`//`，它会自动缩进以与函数中的其余代码保持一致。如何让 Emacs 自动缩进`//`评论？

我试过添加`c-indent-comments-syntactically-p 1`到上面的`.emacs`文件中，但这并没有改变它......

例如：

```
int main()
{
    // I'd like this line to be auto-indented to match the block
    for (int i = 0; i < 10; ++i)
    {
        // And this line to be auto-indented to match the block
        doStuff();
    }
} 
```

目前，`TAB`不会缩进我的`//`评论，也不会自动缩进。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-26T21:47:11.103

您可以通过将点放在相关行上并按 来检查和更改当前缩进的值`C-c C-o`。根据自己的喜好调整相关符号。

这不会是永久性的。`c-set-offset`使用您的函数的直接调用`.emacs`来进行全局更改。

简单的例子：

```
int main() {
  // 
} 
```

这是我的默认缩进。将光标移动到第 2 行后，我看到相关符号是`comment-intro`.

使用：

```
(c-set-offset 'comment-intro 6) 
```

我得到：

```
int main() {
        //
} 
```

偏移量跨符号累积：

```
int main() {
        //
  {
          //
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:54:47.850

点击 TAB 仍然会缩进您的评论行，对吗？那么你缺少的是触发自动缩进的双斜杠的自动识别。这是由（c-electric-slash）实现的。首先确保斜杠仍然绑定到该命令：（ `C-h k /`关于击键斜杠的帮助）。然后，假设出现了 c-electric-slash 的文档，请阅读它以了解它在什么条件下被禁止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-04T08:58:20.790

如果您想将您的评论放在代码范围的相同对齐上，只需将以下行添加到您的**~/.emacs**文件中：

```
(c-set-offset 'comment-intro 0) 
```

# html - 无法让 PIE 为 IE8 中的边界半径工作

> ID：13573568
> 
> 赞同：2
> 
> 时间：2012-11-26T21:38:02.870
> 
> 标签：html, css, internet-explorer, css3pie

我的 CSS 中有这个：

```
.myAwesomeElement {
    position: relative;
    z-index: 0;
    zoom: 1;
    border: 1px solid #999;
    -webkit-border-radius: 10px;
       -moz-border-radius: 10px;
            border-radius: 10px;
    background: #6699CC;
    behavior: url(PIE.htc);
} 
```

我的 HTML 中有这个

```
 <input type="button" class="myAwesomeElement" value="#myAwesomeElement" onClick=""> 
```

该`PIE.htc`文件位于 HTML 文件所在的根目录中。

当我在 IE8 中查看它时，按钮会显示，但它没有圆角边缘。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:43:27.323

CSS 中的文件路径是相对于样式表的，而不是根目录。

尝试：

```
behavior: url(/PIE.htc); 
```

# jquery - 构建一个没有 $ 美元符号的自定义 jQuery

> ID：13573570
> 
> 赞同：4
> 
> 时间：2012-11-26T21:38:07.107
> 
> 标签：jquery

我有一个 javascript 库，可以在不同类型的网站上运行，例如 wordpress 或 magento。js库动态加载jQuery并调用noConflict分配给脚本元素的onereadystatechange()中的另一个变量命名空间。但是，如果该站点还在我的 js 库之前加载了 Prototype js，则可能会发生 Prototype 和 jQuery 之间的冲突。

在调用 onereadystatechange 回调之前，可能会解析页面并调用 Prototype 函数。如果该 Prototype 函数使用任何“$”，它会导致该函数失败，因为该美元符号“$”仍然是 jQuery，而不是 Prototype（在调用 jQuery.noConflict() 之前）。

我可以构建一个自定义 jQuery 根本不使用“$”，因此由于上述原因不需要再次加载 Prototype 吗？

**编辑1：**

这是我的 js 库 (mylib.js) 将在网站上使用的过程，以及 jQuery 如何与该网站的 Prototype 发生冲突。

onepage.html 来自其他网站

```
<head>
  <script src="prototype.js" type="text/javascript"></script>
  <script src="mylib.js" type="text/javascript"></script>
</head> 
```

mylib.js

```
1\. If jQuery is not defined, create a script element with jQuery src and insert to header.
2\. In the script element, attach event onreadystatechange.
  element.attachEvent('onreadystatechange', function () {
  if (elem.readyState == 'loaded' || elem.readyState == 'complete') {
      callback();
    }
  });
3\. in callback(), I called noConflict().
   var callback = function() {
     return function() {
        if (window['jQuery'] && hasJQueryReqVersion()) {
           window.myJQ = jQuery.noConflict(true);
        }
     }
   }(); 
```

问题是在调用 callback() 之前，可能会调用 Prototype 并且它会意外使用已被 jQuery 覆盖的 '$'。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T21:40:40.857

您可以控制加载库的顺序。首先加载 jQuery 库（通过在您的脚本节点中添加该脚本节点，并在允许其他脚本加载之前`<head>`立即调用。`$.noConflict()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T21:42:13.837

首先加载 jQuery 并`$.noConflict()`立即调用。

您还可以设置 jQuery 以完全避免`$`使用类似的东西

```
var JQry = jQuery.noConflict(); 
```

# android - 如何在 Android 中调用 Activity

> ID：13573572
> 
> 赞同：0
> 
> 时间：2012-11-26T21:38:10.343
> 
> 标签：android

我有以下情况。我的应用程序中有 2 个包。com.example.package1; org.otherexample.package2；

我在清单中声明如下：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
   package="com.example.package1"
   android:versionCode="1"
   android:versionName="1.0" >
   <activity android:name=".ActivityfromPackage1"/>
   <activity android:name="org.otherexample.package2.ActivityFromPackage2"/>

</manifest> 
```

这是清单，现在我想从 ActivityFromPackage1 ActivityFromPackage2 调用我已经这样做了：

```
import org.otherexample.package2.ActivityFromPackage2
..........
Intent intent = new Intent(this,ActivityFromPackage2.class);
startActivity(intent); 
```

我收到以下错误：

```
Unable to start Activity com.example.package1/org.otherexample.package2.ActivityFromPackage2:
JavaLang nullpointer exception 
```

如何调用活动？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:55:03.200

我怀疑您在此处发布的内容之外的内容是您问题的根源。我只是做了一个示例项目来测试它。

这是我在清单中的两个活动声明：

```
 <activity
            android:name="com.example.packagetesting.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name="com.example.anotherpackage.AnotherActivity"
            android:label="@string/title_activity_another" >
        </activity> 
```

这是 MainActivity 的相关位：

```
import com.example.anotherpackage.AnotherActivity;
...
Intent i = new Intent(this, AnotherActivity.class);
startActivity(i); 
```

请注意，在我的第二个活动中，我必须从主包中导入 R：

```
import com.example.packagetesting.R; 
```

但是在这样做之后，一切都会编译并正确运行。

另请注意在我的日志文件中显示：

```
Starting: Intent { cmp=com.example.packagetesting/com.example.anotherpackage.AnotherActivity } 
```

即使 AnotherActivity 仅在`com.example.anotherpackage`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T21:50:02.520

我认为您可能需要稍微修改清单，尝试使其看起来更像这样

```
 <activity android:name=".ActivityFromP2">
  <intent-filter>
    <action android:name="package2.intent.action.Launch" />
    <category android:name="android.intent.category.DEFAULT" />
  </intent-filter>
</activity> 
```

这个问题很有用

[从不同的包启动活动](https://stackoverflow.com/questions/2741857/launch-activities-from-different-package)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T05:28:56.330

我刚刚检查了你的代码。它在我的应用程序中工作。

显现：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.firstapp.tempp.testapp"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <uses-permission android:name="android.permission.READ_CALENDAR" />
    <uses-permission android:name="com.android.alarm.permission.SET_ALARM" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:name="org.pac.abcs.TestActivity" >
        </activity>
    </application>

</manifest> 
```

Java 代码：

```
btn.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View arg0) {

                startActivity(new Intent(MainActivity.this, TestActivity.class));
            }
        }); 
```

所以它不是包装声明的问题。只是一个疑问，您是否在第二个活动（ActivityFromPackage2）或 com.example.package1.R 中导入了 android.R？您将需要导入 com.example.package1.R。

# powershell-2.0 - 我可以使用什么脚本在任何机器上安装 powershell？

> ID：13573573
> 
> 赞同：0
> 
> 时间：2012-11-26T21:38:13.497
> 
> 标签：powershell-2.0, powershell-remoting

我可以使用什么脚本在任何机器上安装 powershell？因为我在网络中有一些 xp 机器并想在这些机器上远程安装，

Windows 7，默认情况下

另外，我怎样才能在网络中的任何机器上远程运行任何脚本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T14:56:48.917

如果您使用的是 WSUS 或 SCCM，您可以（并且应该）通过这些机制将其推出。否则，您必须像安装任何其他 Windows 更新或软件一样安装它。

请注意，PowerShell 2.0 需要 XP SP3，而 PowerShell 3.0 根本不会安装在 XP 上。

# javascript - Javascript：大整数的 toString(36)

> ID：13573577
> 
> 赞同：8
> 
> 时间：2012-11-26T21:38:30.083
> 
> 标签：javascript, integer, largenumber, radix

`15955067621307336078.toString(36);`在 Javascript 中返回`'3d7vzfy5k2as8'`，因为无法表示大整数（正确答案是`'3d7vzfy5k29ou'`）。

有人有一个聪明的函数，可以将大整数作为字符串并将其转换为基数 36？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-26T21:53:15.483

使用[这个 BigInt 类](http://www.leemon.com/crypto/BigInt.js)，它允许将任意大的整数转换为 2 到 95 之间的任意基数。使用该`bigInt2str()`方法执行转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-07T03:06:41.003

对于任何好奇的人，今天我们使用[https://github.com/MikeMcl/bignumber.js](https://github.com/MikeMcl/bignumber.js)代替。

# java - 如何在java中加载合成器样式

> ID：13573579
> 
> 赞同：1
> 
> 时间：2012-11-26T21:38:53.420
> 
> 标签：java, xml, load, styles, synth

我正在尝试合成器风格，我遇到了以下问题，经过相当多的研究，我还没有找到答案。我有以下 xml 文件

```
<?xml version="1.0" encoding="UTF-8"?>
<synth>
    <style id="button">
        <state>
            <color value="blue" type="BACKGROUND"/>
            <color value="yellow" type="FOREGROUND"/>
        </state>
    </style>
    <bind style="button" type="region" key="Button"/>
</synth> 
```

以及以下 java 代码将该 xml 文件加载为 SynthLookAndFeel 对象

```
private void initializeStyle() {
    SynthLookAndFeel laf = new SynthLookAndFeel();
    try {
        laf.load(this.getClass().getResourceAsStream("Style.xml"), this.getClass());
        UIManager.setLookAndFeel(laf);
    } catch (ParseException | UnsupportedLookAndFeelException e) {
        e.printStackTrace();
    }
} 
```

当我尝试运行此代码时，出现以下异常

```
Exception in thread "AWT-EventQueue-0" java.lang.IllegalArgumentException: You must supply an InputStream, StyleFactory and Class or URL 
```

任何有关如何解决此问题的建议都非常受欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:53:29.630

[您可以在Advanced Synth](http://www.ibm.com/developerworks/java/library/j-synth/)中找到一个很好的示例。

您可以在示例中看到：

```
SynthLookAndFeel synth = new SynthLookAndFeel();
synth.load(SynthFrame.class.getResourceAsStream("demo.xml"), SynthFrame.class);
UIManager.setLookAndFeel(synth); 
```

并且`demo.xml`生活在 与类`demo.synth`相同的包中，`SynthFrame`该 XML 包含一些图像：

```
<imageIcon id="check_off" path="images/checkbox_off.png"/> 
```

住在哪`checkbox_off.png`里`demo.synth.images`。

我希望这可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T14:33:57.793

主要课程：

> SynthLookAndFeel lookAndFeel = new SynthLookAndFeel(); lookAndFeel.load(TestRApp.class.getResourceAsStream(synthFile), TestRApp.class); UIManager.setLookAndFeel(lookAndFeel);

synth.xml 文件

```
<style id="panelStyle">
    <imagePainter method="panelBackground" path="images/main-bg.png" sourceInsets="0 0 0 0" stretch="true"/>
</style>
<bind style="panelStyle" type="region" key="Panel"/> 
```

# mongodb - 随机分区MongoDB数据库

> ID：13573582
> 
> 赞同：0
> 
> 时间：2012-11-26T21:38:59.133
> 
> 标签：mongodb, pymongo

所以我有一个 mongodb 数据库，想随机分区。

我的意思是数据库的大小为 $s$ 并且我希望将其拆分以便我有 $frac{s}{2}$ 来训练我的分类器和 $frac{s}{2}$ 来测试它的准确性。~~ 交叉折叠验证。我怎样才能做到这一点？我正在考虑为每个条目分配一个整数，然后只选择一个随机抽样就给出一个从 0 到 1000 的范围。问题是我不知道它何时更新以及何时插入。因此，如果它是一个新条目，我只会增加要插入的值。所以我想用 getLastError 来检查一下？

我觉得有更好的方法来做到这一点......

有什么建议么？

谢谢，

# android - Android：安排剩余事件

> ID：13573583
> 
> 赞同：1
> 
> 时间：2012-11-26T21:39:11.747
> 
> 标签：android, timer, calendar, timertask

为了实现提醒，我需要设置一个备忘录，例如：“从今天开始，显示一个备忘录，每个星期五，一个星期是和一个否”所以，我想我可以确定每个备忘录，下一个日期是什么我必须展示它。然后将此日期传递给这样的计时器：

```
 Timer timer = new Timer();

 timer.schedule(new TimerTask() {

                public void run() {
                    //show my memo    
                     });

                }}, date); // 
```

假设现在是星期一 26/11/2012 我如何确定第一个星期五发生的时间（根据上述备忘录？

我不确定这种机制是否足够好，如果有人可以建议我另一种方法，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T21:50:58.480

Timer 不是一个很好的类。你应该看看 AlarmManager 并使用它来安排你的事件。

您可以使用 AlarmManager.set() 设置特定的警报，使用 AlarmManager.setInexactRepeating() 设置在准确性方面具有一定灵活性的重复警报，使用 setRepeating() 设置精确的重复警报。

在所有情况下，您都设置了一个在警报触发时启动的 PendingIntent，并且您的应用程序应该准备好正确处理该意图。

请记住，当 PendingIntent 被触发时，您不一定需要采取行动：您只需检查条件是否正确（例如，您可以添加一些关于此时是否应通知用户的逻辑）。

有关 AlarmManager 和 PendingIntent 的更多信息：

[http://developer.android.com/reference/android/app/AlarmManager.html](http://developer.android.com/reference/android/app/AlarmManager.html)

[http://developer.android.com/reference/android/app/PendingIntent.html](http://developer.android.com/reference/android/app/PendingIntent.html)

另外，请记住，您必须将广播接收器添加到“启动序列完成”事件，以便您可以在设备重新启动后重新安装警报，因为警报不会在重新启动后持续存在。

# infopath - 计算数字签名的数量？

> ID：13573587
> 
> 赞同：2
> 
> 时间：2012-11-26T21:39:33.297
> 
> 标签：infopath, infopath2010, electronic-signature

我有一个允许多个签名的表格。如果签名少于 3 个，我希望表格计算签名数量并显示文本（作为警告）。

如何才能做到这一点？我认为解决方案将是某种 VB 代码。

我找到[了这篇文章](http://social.msdn.microsoft.com/Forums/en-US/sharepointcustomizationlegacy/thread/295b44a7-c4fa-41cf-bf18-5e99abd52376)，但似乎只是一个关于签名的布尔值。我也尝试在说按钮上添加规则，但“条件”似乎非常有限。我可以选择签名控件，但是如果有任何签名或没有签名，诸如“不存在”或“空白”之类的东西似乎并没有被恰当地拾取。我找不到任何正确检测签名的条件。

请注意，这是在网络上填写的。我的表单设置的详细信息：

*   InfoPath 2010 推送到 Sharepoint 站点
*   创建的部分启用了数字签名
*   使用“所有签名都是独立的”选项

我确实尝试`sum()`过签名控制，但它返回了 NaN

根据[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.infopath.semitrust.signatures.count%28v=office.15%29.aspx)，我尝试了一些 VBcode，但无法使语法正常工作。我试过像`<signature_control_name>.Count`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T17:13:12.027

在您的数据源中，您应该有两个签名组，一个嵌套在另一个中。所有签名都存储为最内层组中的节点作为签名节点。

如果您使用的是脚本/托管代码，您应该能够抓取内部节点，然后计算其中的签名节点数。

我不确定仅使用 IP 规则的方法，因为在应用签名之前没有实际的节点（IP 不会验证规则并让您保存它）。

# javascript - $.getJSON 函数传递参数

> ID：13573600
> 
> 赞同：4
> 
> 时间：2012-11-26T21:40:36.827
> 
> 标签：javascript, jquery

我有一个关于 JavaScript 的快速问题：

我有以下代码行显示了一个示例，它工作正常。您可以访问传递的数据，没有问题。

```
$.getJSON(jsonUrl,function(passeddata){
  alert("it worked ");
}); 
```

下一个代码示例不起作用并失败并出现以下错误：

> 未捕获的类型错误：对象引用错误：未定义传递的数据没有方法“替换”jq.html:177（匿名函数）

```
$.getJSON(jsonUrl, something(passeddata));

function something(passeddata)
{
var jasondata = passeddata;
alert("it worked ");                
} 
```

有人可以解释这个问题吗？我知道这可能很明显，但我无法找到答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T21:43:29.997

在第一种情况下，您将传递一个函数`getJSON`，当 JSON 的 HTTP 请求返回时执行该函数。

在第二种情况下，您将立即调用该函数并将其返回值传递给`getJSON`.

不要自己打电话，`()`带走：`$.getJSON(jsonUrl, something);`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-26T21:43:31.390

尝试更改第二个实例以将回调传递给 getJSON 方法。传递的数据还不存在，所以你只需给出函数名称：

```
$.getJSON(jsonUrl, something);

function something(passeddata)
{
var jasondata = passeddata;
alert("it worked ");                
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-26T21:43:45.330

```
$.getJSON(jsonUrl, something);

function something(passeddata)
{
var jasondata = passeddata;
alert("it worked ");                
} 
```

这是应该的。使用第二个参数，您只需告诉一个指向应该执行的函数的指针。在您的代码中，函数立即执行

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-26T21:44:04.400

您将“something(passeddata)”的结果作为第二个参数传递给 getJSON 函数调用

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-26T21:44:11.060

您不希望`something(passeddata)`调用函数并将其返回值用作回调。你想要的只是这样：

```
$.getJSON(jsonUrl, something); 
```

请注意，参数名称在用作参数时无关紧要，因此您仍然可以`passeddata`在函数本身中使用。

# apache-camel - Camel - 使用自定义 jmsOperations：无法转换为 org.apache.camel.component.jms.JmsConfiguration$CamelJmsTemplate

> ID：13573603
> 
> 赞同：0
> 
> 时间：2012-11-26T21:40:47.343
> 
> 标签：apache-camel, spring-jms

我想使用自定义 jmsOperations，当我尝试获得类转换异常时：无法转换为 org.apache.camel.component.jms。**JmsConfiguration$CamelJmsTemplate**

配置：

```
<bean id="jmsErf" class="org.apache.camel.component.jms.JmsComponent">
    <property name="jmsOperations" ref="myJmsTemplate" />   
    <property name="preserveMessageQos" value="true"/>
    <property name="explicitQosEnabled" value="false"/>
    <property name="testConnectionOnStartup" value="true"/>
    <!--property name="useMessageIDAsCorrelationID" value="true" / WARNING! Do not use this as we need to copy only in the beginning not everywhere -->
    <property name="transactionManager" ref="jpaTransactionManager" />
    <property name="transacted" value="true" />
</bean>

<bean name="myJmsTemplate" class="blabla.MyJmsTemplate">
<property name="connectionFactory">
    <bean class="jms.MQConnectionFactory">
        <property name="queueManagerName" value="${Queue.My.manager}" />
        <property name="throwOnInvalidMessageProperty" value="false" />
    </bean>
</property>
</bean> 
```

我创建的示例类

```
MyJmsTemplate extends org.springframework.jms.core.JmsTemplate implements
        org.springframework.jms.core.JmsOperations { .. no code :) 
```

为什么我要尝试 jmsOperations：我只需要维护原始的 JMSPriority。是的，我确实尝试过preserveQoS explicitQoS [启用等的各种组合。它要么将所有优先级设置为4；要么将所有优先级设置为4。或尽管设置了 eg=6 优先级]，但优先级仍然为零。通过创建我自己的 jmsOperations 并显式传输 JMSPriority 值。

异常跟踪：

> 原因：org.apache.camel.FailedToCreateProducerException：无法为端点创建生产者：端点 [jmsErf://queue:MQDEV.MYQ.ERROR]。原因：java.lang.ClassCastException: blabla.MyJmsTemplate 无法在 org.apache.camel.component.jms.JmsProducer.testConnectionOnStartup(JmsProducer.java:458) 处转换​​为 org.apache.camel.component.jms.JmsConfiguration$CamelJmsTemplate org.apache.camel.component.jms.JmsProducer.doStart(JmsProducer.java:469) 在 org.apache.camel.support.ServiceSupport.start(ServiceSupport.java:60) 在 org.apache.camel.util.ServiceHelper。 startService(ServiceHelper.java:62) at org.apache.camel.impl.ProducerCache.doGetProducer(ProducerCache.java:387) ... 115 更多原因：java.lang.ClassCastException: bla.MyJmsTemplate 无法转换为 org. apache.camel.component.jms。

谁能指出我在骆驼中的 jmsOptions 用法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T07:27:16.507

你用什么骆驼版本？

如果您想自己映射到 JMS 消息/从 JMS 消息映射，您应该使用自定义 messageConverter。

如果设置 preserveMessageQos=true，则应该保留 JMSPriority。

# ruby-on-rails - 使用 kaminari 进行分页 + 查询字符串排序会导致奇怪的链接

> ID：13573610
> 
> 赞同：2
> 
> 时间：2012-11-26T21:41:18.467
> 
> 标签：ruby-on-rails, kaminari

**简单来说**

使用查询字符串参数过滤对象列表时，Kaminari 分页助手中的链接错误。

**背景**

我有一个`LearningObjects#index`支持基本排序的操作，我通过 Kaminari 实现了我的自我和分页。

排序是使用执行 GET 请求的正常形式完成的。

控制器：

```
class LearningObjectsController < AdministrationController
  respond_to :json, :html
  load_and_authorize_resource

  # GET /learning_objects
  # GET /learning_objects.json
  def index
    # Searching
    if LearningObject.has_search_params(params)
      @learning_objects = LearningObject.search(params)
    end

    # Pagination
    @learning_objects = @learning_objects.page(params[:page]).per(params[:per])
    respond_with @learning_objects, serializer: LearningObjectPageSerializer, total_records: @learning_objects.total_count
  end

  # other actions...#
end 
```

风景

```
%h1= t("actions.learning_object.index")

.well
  %h4= t("actions.filter")
  = form_tag(learning_objects_path, method: :get, class: "form-search") do
    = select_tag :subject_id, 
      options_from_collection_for_select(@subjects, "id", "name", params[:subject_id].to_i), 
      prompt: t("activerecord.models.subject")
    = select_tag :stage_id,
      options_from_collection_for_select(@stages, "id", "name", params[:stage_id].to_i), 
      prompt: t("activerecord.models.stage")
    = text_field_tag :free_text, params[:free_text], placeholder: t("actions.write_something")
    = submit_tag t("actions.filter"), class: :btn
  = link_to t("actions.clear"), learning_objects_path, class: :btn

%p= t("actions.learning_object.show_number", count: @learning_objects.total_count, total: @total)
= paginate @learning_objects
= table_for @learning_objects do |t|
  = t.data actions: :all do
    =t.cell(:name) {|l| link_to l, l}
    =t.cell(:downloads) {|l| "#{l.downloads} #{t("misc.times", count: l.downloads)}"}
    =t.cell(:language)
    =t.cell(:active) {|l| tag("i", class: l.active ? "icon-ok" : "") }

= link_to t("actions.learning_object.new"), new_learning_object_path 
```

**问题**

当表单用于过滤 LearningObjects 时，Kaminari 生成的分页链接变得很奇怪。

例如，如果地址如下所示：`http://localhost:3000/learning_objects?utf8=%E2%9C%93&subject_id=&stage_id=&free_text=obj&commit=Filtrera`

然后分页链接如下所示：`http://localhost:3000/subjects//learning_objects?commit=Filtrera&free_text=obj&page=2&stage_id=&utf8=%E2%9C%93`

我希望分页链接看起来像这样：`http://localhost:3000/learning_objects?utf8=%E2%9C%93&subject_id=&stage_id=&free_text=obj&commit=Filtrera&page=2`

**问题**

当搜索词出现在查询字符串中时，为什么 Kaminari 会生成这些格式错误的嵌套链接？

# java - 将arraylist导入并打印到JSP

> ID：13573614
> 
> 赞同：3
> 
> 时间：2012-11-26T21:41:32.953
> 
> 标签：java, jsp, arraylist

我有一个简单的 jsp 页面（page.jsp）和一个简单的 java 类（classWithArray），其中包含一个 arraylist（列表）。

如何从 jsp 访问数组列表，例如在表格中显示它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:44:43.767

使用 JSTL 的`forEach`标签来迭代`ArrayList`JSP 中的集合（在这种情况下特别是），请查看这篇[文章](https://stackoverflow.com/questions/102964/jstl-collection-iteration)以获取更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:46:33.010

**您可以使用来自JSTL**`c:forEach`的标记来迭代 ArrayList 下面是迭代 peopleList 列表的示例代码。

 **```
<c:forEach var="person" items="${people.peopleList}">
        <tr>
          <td>${person.name}</td>
        </tr>
      </c:forEach> 
```

使用页面标签在您的 JSP 页面中导入 java.util.List 使用

```
<%@ page import="java.util.List" %> 
```**

# kendo-ui - KendoUI Tabstrip 根据 url 打开一个标签

> ID：13573628
> 
> 赞同：1
> 
> 时间：2012-11-26T21:42:47.350
> 
> 标签：kendo-ui

是否有一些内置功能可以根据 url 打开标签页（kendoUI TabStrip）？还是我必须编写一些自定义函数来读取 url 并在此基础上做一些工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T00:10:20.317

检查这是否是您要查找的内容：

HTML：

```
<div id="tabstrip">
    <ul>
        <li class="k-state-active">Page 1</li>
        <li>Page 2</li>
        <li>Page 3</li>
    </ul>
</div> 
```

JavaScript：

```
$(document).ready(function () {
    $("#tabstrip").kendoTabStrip({
        contentUrls:[
            "page1.html",
            "page2.html",
            "page3.html"
        ]
    });
}); 
```

它创建了 3 个选项卡`kendoTabStrip`，每个选项卡的内容是`page1.html`,`page2.html`和`page3.html`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T03:52:21.663

我认为您必须解析 URL，然后调用选项卡条上的[activateTab()](http://docs.kendoui.com/api/web/tabstrip#activatetab)函数以打开所需的选项卡。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T13:53:15.890

如果要在呈现状态下设置活动选项卡的解决方案（页面加载时不使用Js）

如果您使用模板系统（例如 groovy for play framework 1.x），您可以编写如下内容：

```
<ul>
  <li class="#{if params.get('ref') == 'application'}k-state-active#{/if}">Application</li>
  <li class="#{if params.get('ref') == 'payment'}k-state-active#{/if}">Payment</li>
</ul>
<div>
  content for tab application
</div>
<div>
  content for tab payment
</div> 
```

**注意：** params.get('ref') 表示请求的获取参数，名称为：'ref'

如果您使用以下网址打开此页面：someting.dev/dashboard?ref=payment

您将获得付款选项卡作为活动

# android - 动态命名的 WebView

> ID：13573629
> 
> 赞同：1
> 
> 时间：2012-11-26T21:42:50.960
> 
> 标签：android, webview

我正在尝试根据页码使 webviews 自动显示资产 driectory 中的页面。我想在第一页上制作 webView1，在第二页上制作 webView2，等等，而不是 webView。有什么方法可以动态生成 webView 名称，所以我可以将其称为 {"Webview"+pageNr}？

```
public static final String ARG_SECTION_NUMBER = "section_number";

        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container,
                Bundle savedInstanceState) {
            Bundle args = getArguments();
            String pageNr=Integer.toString(args.getInt(ARG_SECTION_NUMBER));
            WebView webView = new WebView(getActivity());
            switch (args.getInt(ARG_SECTION_NUMBER)) {
                case 0: webView.loadUrl("file:///android_asset/welcome.htm");
                case 1: webView.loadUrl("file:///android_asset/basic.htm");
            }
            return webView;
        } 
```

# jquery - 如何更改呈现警报的文本？

> ID：13573631
> 
> 赞同：0
> 
> 时间：2012-11-26T21:42:59.297
> 
> 标签：jquery, alert

我是新手，但也许有人可以帮助我。我正在一个网站上呈现类似这样的警报：“已成功选择运输选项。” 并且：“错误：使用的折扣码无效或过期。” 现在我必须将这些弹出警报翻译成其他语言。有没有办法用jquery做到这一点？

这些消息呈现在我商店的购物车中。这是该网站的链接：

[http://grootaartseuronics.businesscatalyst.com/index.html](http://grootaartseuronics.businesscatalyst.com/index.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T21:48:48.597

试试这样的！

' test1 = Browser("myBrowser").Dialog("Windows Internet Explorer").Static("alertbox").GetROProperty("text") '</p>

（myBrowser --- 示例浏览器标题。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T21:54:16.053

如果使用的系统不提供某种本地化系统，您必须检查源文件并手动更改警报文本。
请参阅此处以了解警报在 JavaScript 中的工作方式：[http](http://www.w3schools.com/jsref/met_win_alert.asp)
://www.w3schools.com/jsref/met_win_alert.asp 查找发生这种情况的特定行的快速方法是使用[文件搜索工具](http://www.mythicsoft.com/page.aspx?type=agentransack&page=home)并使用它来查找被警告的文本​​。
如果系统使用某种脚本语言，如 PHP，您最终可能会修改变量内容。

# google-apps-script - 列表框未打开处理程序

> ID：13573632
> 
> 赞同：0
> 
> 时间：2012-11-26T21:43:01.840
> 
> 标签：google-apps-script

我正在尝试以列表框格式创建一个菜单，用户可以在其中选择一个选项，然后显示另一个 uiapp 以及他们选择的信息。我在这里遇到一个问题，当我打开谷歌时给我一个错误，说遇到错误。发生预期错误。我认为这与 setId 部分有关，如果我删除其中一个 setId，则不会发生错误。这甚至可能吗？

```
 function doGet(e) {
 var app = UiApp.createApplication().setTitle("Services"); 
 var dropDownList = app.createListBox().setName('list').setId('list');
 var infoLabel = app.createLabel('Scroll around to select the service   desired').setId('infoLabel');
 var panel = app.createVerticalPanel();
 //addItem fills the list  
 dropDownList.addItem("Option 1").setId("add");
 dropDownList.addItem("Option 2");
 panel.add(dropDownList);
 panel.add(infoLabel);
 app.add(panel);
 var info = app.getElementById("add");
 var handler2 = app.createServerHandler('display2');
 info.addClickHandler(handler2);

 app.add(dropDownList);
 app.add(infoLabel);
 var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
 spreadsheet.show(app);
}

 function display2(e) {
 var app = UiApp.createApplication();
  var html = app.add(app.createHTML("<p><p><b>You have selected this option</b>  </p>")).setHeight(220).setWidth(220);

 var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
 spreadsheet.show(app);
 return app;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:23:19.483

您是将其部署为 Web 应用程序还是电子表格中的脚本？

如果您将其部署为 Web 应用程序，`SpreadsheetApp.getActiveSpreadsheet()`则将无法使用 - 将其替换为`SpreadsheetApp.openById(id)`id 是您的电子表格 ID，当您在浏览器中打开文件时，您将在 URL 中找到该 ID。

如果您想通过菜单项或简单按钮将其部署在电子表格中，则可以按原样工作。

我能够复制粘贴您的代码并让列表框部分正常工作 -

[https://docs.google.com/spreadsheet/ccc?key=0AkJNj_IM2wiPdHRYQThlaGVVSk04R052ZGNqclhEZWc#gid=0](https://docs.google.com/spreadsheet/ccc?key=0AkJNj_IM2wiPdHRYQThlaGVVSk04R052ZGNqclhEZWc#gid=0)

* * *

**更新 -**

我现在明白你要做什么了。有几件事 - 您要确保通过`handler.addCallbackElement(myWidget)`否则添加回调元素，您将无法读取元素的值。第二件事是您不需要在下拉列表中的每个选项上都有服务器处理程序。只要有一个处理程序，每次更改都会触发它，您将能够获得您选择的选项。

我已经清理了下面的代码，并更新了电子表格以使用此代码。

```
function showUI() {
  var app = UiApp.createApplication().setTitle("GeekSquad Services"); 

  var infoLabel = app.createLabel('Scroll around to select the service desired');

  var dropDownList = app.createListBox().setName('list').setId('list');
  dropDownList.addItem("Option 1");
  dropDownList.addItem("Option 2");
  //you can add as many options here manually or dynamically

  var handler = app.createServerHandler('dropDownCallback')
  handler.addCallbackElement(dropDownList);
  dropDownList.addClickHandler(handler);

  var panel = app.createVerticalPanel();  
  panel.add(dropDownList);
  panel.add(infoLabel);
  app.add(panel);

  var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  spreadsheet.show(app);
}

function dropDownCallback(e) {
  var app = UiApp.createApplication();
  var html = app.add(app.createHTML("<b>You have selected this option</b> " + e.parameter.list));

  var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  spreadsheet.show(app);
} 
```

**更新 #2 -**

如果您想分叉并创建不同的应用程序实例，那很容易（尽管不清楚为什么不只是更改面板）。

```
 function dropDownCallback(e) {
      if(e.parameter.list === 'Option 1'){
        var app = UiApp.createApplication();
        var html = app.add(app.createHTML("Here for option!"));

        var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
        spreadsheet.show(app);
      }
      else if (e.parameter.list ==== 'Option 2'){
        //create and show other App here or whatever else
      }
      //refactor this better to not repeat code. 
    } 
```

# c++ - VS10/12 中的 Matlab Shared C/C++ lib 抛出很多异常

> ID：13573639
> 
> 赞同：7
> 
> 时间：2012-11-26T21:43:32.353
> 
> 标签：c++, matlab, exception, shared-libraries

我的**matlab c/c++ 共享库**出现运行时问题。库导出并且应用程序被**正确编译和链接**。但是在运行时脚本似乎有很多错误。我的应用程序的控制台窗口（显示 matlab 输出）中没有显示错误。但是**调试器在运行时显示了很多未捕获的异常**。但是脚本似乎运行并且应用程序正确终止。

一些事情要知道：

*   基于 Win8 Pro x64 构建
*   Visual Studio 2012（项目设置为VS 2010，安装正确）
*   Matlab R2012b（32Bit）（64Bit版本也安装了，不过这里没用，据我所知）
*   MCR R2012b win32/64 已安装
*   Matlab 中使用的编译器 Compiler 是VS2010 的一种（用GUI-compiler 编译）

好吧，这是我要导出到共享库的 m 文件：

```
% Create video input object. 
vid = videoinput('winvideo', 1, 'YUY2_320x240')

% Set video input object properties for this application.
set(vid,'TriggerRepeat',Inf);
vid.FrameGrabInterval = 3;

% Set value of a video source object property.
vid_src = getselectedsource(vid);
set(vid_src,'Tag','motion detection setup');
set(vid,'ReturnedColorSpace','rgb');

% Create a figure window.
figure; 
% wiener filter neighbourhood
wienerFilter = [5 5];
% Start acquiring frames.
start(vid)

% Calculate difference image and display it.
while(vid.FramesAcquired<=200) % Stop after 200 frames
    data = getdata(vid,2);

    first_img = wiener2(rgb2gray(data(:,:,:,1)), wienerFilter);
    second_img = wiener2(rgb2gray(data(:,:,:,2)), wienerFilter);

    bw_img = im2bw(first_img);

    diff_im = imabsdiff(first_img,second_img);

    subplot(1,3,1), imshow(first_img);
    subplot(1,3,2), imshow(second_img);
    subplot(1,3,3), imshow(diff_im);

end

stop(vid)

delete(vid)
close(gcf) 
```

如果您的计算机上有网络摄像头，则脚本应该可以正常运行！

现在主要的 C++ 文件：

```
#include "stdafx.h"
#include "MatlabCompilerSample.h"

#pragma comment(lib, "MatlabCompilerSample.lib")

int _tmain(int argc, _TCHAR* argv[])
{
    /* Call the MCR and library initialization functions */
    if( !mclInitializeApplication(NULL,0) )
    {
        const char* message = mclGetLastErrorMessage();
        printf_s(message);
        fprintf(stderr, "Could not initialize the application.\n");
        exit(1);
    }

    if (!MatlabCompilerSampleInitialize())
    {
        fprintf(stderr,"Could not initialize the library.\n");
        exit(1);
    }

    /* Call the implementation function */
    WebcamSample();

    /* Call the library termination function */
    MatlabCompilerSampleTerminate();

    mclTerminateApplication();
    return 0;
} 
```

到现在还好看吗？加载一堆 dll 后，混乱开始了。查看抛出的异常和废话：

```
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'C:\Windows\WinSxS\x86_microsoft.vc90.mfcloc_1fc8b3b9a1e18e3b_9.0.30729.6161_none_49768ef57548175e\MFC90DEU.DLL'. Module was built without symbols.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: std::runtime_error at memory location 0x003DF4A0.
SetThrowSegvLongjmpSEHFilter(): filter function installed
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: xsd_binder::MalformedDocumentError at memory location 0x003D6210.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: xsd_binder::MalformedDocumentError at memory location 0x003D5A4C.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: xsd_binder::MalformedDocumentError at memory location 0x003D6210. 
```

好吧，这会持续一段时间，然后：

```
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'C:\Windows\SysWOW64\profapi.dll'. Cannot find or open the PDB file.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: boost::thread_interrupted at memory location 0x060EFD98.
The thread 0x2478 has exited with code 0 (0x0).
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: xsd_binder::MalformedDocumentError at memory location 0x003DE000.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: xsd_binder::MalformedDocumentError at memory location 0x003DD83C.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: xsd_binder::MalformedDocumentError at memory location 0x003DE000. 
```

那不是全部...

```
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: xsd_binder::MalformedDocumentError at memory location 0x003DD0B4.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: xsd_binder::MalformedDocumentError at memory location 0x003DDEA0.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: boost::thread_interrupted at memory location 0x061EF980.
The thread 0x282c has exited with code 0 (0x0).
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: xsd_binder::MalformedDocumentError at memory location 0x003DE328.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: xsd_binder::MalformedDocumentError at memory location 0x003DDB64.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: xsd_binder::MalformedDocumentError at memory location 0x003DE328. 
```

...

```
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: xsd_binder::MalformedDocumentError at memory location 0x003DE1C8.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: boost::thread_interrupted at memory location 0x061EFC14.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: boost::thread_interrupted at memory location 0x060EFDEC.
The thread 0x32a4 has exited with code 0 (0x0).
The thread 0x350c has exited with code 0 (0x0).
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: boost::thread_interrupted at memory location 0x060EFC1C.
The thread 0xfd8 has exited with code 0 (0x0).
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: boost::thread_interrupted at memory location 0x05FEFC7C.
The thread 0x2144 has exited with code 0 (0x0).
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\sys\java\jre\win32\jre\bin\client\jvm.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'C:\Windows\SysWOW64\winmm.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'C:\Windows\SysWOW64\msvcr71.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'C:\Windows\SysWOW64\winmmbase.dll'. Cannot find or open the PDB file.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: std::runtime_error at memory location 0x0771F404.
SetThrowSegvLongjmpSEHFilter(): filter function installed
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'C:\Windows\SysWOW64\NapiNSP.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'C:\Windows\SysWOW64\pnrpnsp.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'C:\Windows\SysWOW64\nlaapi.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'C:\Windows\SysWOW64\mswsock.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'C:\Windows\SysWOW64\dnsapi.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'C:\Windows\SysWOW64\winrnr.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'C:\Program Files (x86)\Common Files\Microsoft Shared\Ink\tiptsf.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'C:\Windows\SysWOW64\cfgmgr32.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\sys\java\jre\win32\jre\bin\verify.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\sys\java\jre\win32\jre\bin\java.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\sys\java\jre\win32\jre\bin\hpi.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\sys\java\jre\win32\jre\bin\zip.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\sys\java\jre\win32\jre\bin\fontmanager.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\sys\java\jre\win32\jre\bin\awt.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'C:\Windows\SysWOW64\apphelp.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\bin\win32\nativejmi.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\bin\win32\nativeservices.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\bin\win32\nativejava.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\sys\java\jre\win32\jre\bin\net.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\sys\java\jre\win32\jre\bin\nio.dll'. Cannot find or open the PDB file.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: std::runtime_error at memory location 0x0771F284.
SetThrowSegvLongjmpSEHFilter(): filter function installed
First-chance exception at 0x76AB4B32 (KernelBase.dll) in MatlabCompilerCPPExample.exe: 0x000006BA: Der RPC-Server ist nicht verfügbar.
The thread 0x37b0 has exited with code 0 (0x0).
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: CryptoPP::AES_PHM_Decryption::InvalidCiphertextOrKey at memory location 0x0771C1B8.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: CryptoPP::AES_PHM_Decryption::InvalidCiphertextOrKey at memory location 0x0771C988.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: tfFailedException at memory location 0x077189E7.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: tfFailedException at memory location 0x0771B82C.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: tfFailedException at memory location 0x07717E57.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: tfFailedException at memory location 0x0771ACA0.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\bin\win32\libmwbuiltins.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\bin\win32\mlint.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'C:\Windows\SysWOW64\version.dll'. Cannot find or open the PDB file.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: tfFailedException at memory location 0x07717E57.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: tfFailedException at memory location 0x0771ACA0.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\bin\win32\libmwmathelem.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\bin\win32\libmwmathxps.dll'. Cannot find or open the PDB file.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: varflowFailedException at memory location 0x0771BCD7.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: varflowFailedException at memory location 0x0771BD82.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\bin\win32\hgbuiltins.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\bin\win32\nativemvm.dll'. Cannot find or open the PDB file.
'MatlabCompilerCPPExample.exe' (Win32): Loaded 'N:\Programme\MATLAB\2012b (32Bit)\bin\win32\nativehg.dll'. Cannot find or open the PDB file.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: CryptoPP::AES_PHM_Decryption::InvalidCiphertextOrKey at memory location 0x07716AC0.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: tfFailedException at memory location 0x07714C0F.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: tfFailedException at memory location 0x07717A5C.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: CryptoPP::AES_PHM_Decryption::InvalidCiphertextOrKey at memory location 0x07717628.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: tfFailedException at memory location 0x0771367F.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: tfFailedExceptionNoUCB at memory location 0x077137EC.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: tfFailedException at memory location 0x07715940.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: tfFailedException at memory location 0x077162C7.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: tfFailedException at memory location 0x07719110.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: varflowFailedException at memory location 0x07719773.
First-chance exception at 0x76AB4B32 in MatlabCompilerCPPExample.exe: Microsoft C++ exception: varflowFailedException at memory location 0x077197EE. 
```

整个文件有 6000 行...如果有必要我会发布它！毕竟它在这里停止了：

```
First-chance exception at 0x76AB4B32 (KernelBase.dll) in MatlabCompilerCPPExample.exe: 0xA1A01DB2 (parameters: 0x1FD09FE6, 0x1FD08200, 0x00000000).
The program '[3324] MatlabCompilerCPPExample.exe' has exited with code 0 (0x0). 
```

**我会很高兴每一个提示，提前谢谢！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:17:08.047

这些都是第一次机会例外，并不意味着有问题。我在以前的工作中经常看到它们，而 Matlab 倾向于产生很多异常，但这都不是真正的问题。

[http://blogs.msdn.com/b/davidklinems/archive/2005/07/12/438061.aspx](http://blogs.msdn.com/b/davidklinems/archive/2005/07/12/438061.aspx)

> 第一次机会异常是否意味着我的代码存在问题？首次机会异常消息通常并不意味着代码中存在问题。对于优雅地处理异常的应用程序/组件，第一次机会异常消息让开发人员知道遇到并处理了异常情况。

# php - 您可以在一个数据库连接上使用 mysqli->prepare 的多个查询吗？

> ID：13573641
> 
> 赞同：1
> 
> 时间：2012-11-26T21:43:35.210
> 
> 标签：php, mysqli

我想对多个查询使用单个数据库连接，但使用 prepare 和 bind_param。我怎样才能做到这一点？我在文档中找不到它。

编辑：我想要两个完全不同的查询。

```
$db = getConnection();
$query = "INSERT INTO talks(title, body, topic) VALUES(?, ?, ?)";
$stmt = $db->prepare($query);
$stmt->bind_param('sss', $title , $body, $topic);
$stmt->execute();
$stmt->close();

$query = "SELECT * WHERE title=?";
$stmt = $db->prepare($query);
$stmt->bind_param("s", $title);
$stmt->execute();
$stmt->bind_result($i, $t, $b, $to);
$stmt->fetch();
$id = $i;
$stmt->close(); 
```

它告诉我 $stmt 不是第二个对象

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:46:50.397

只需准备第二个查询，就像您对第一个查询所做的那样。

```
$conn = new mysqli(....);
$stmt = $conn->prepare(....);
//Do stuff with $stmt

$stmt = $conn->prepare(...different...); //$stmt is overridden with the new query.
//Do stuff with the new $stmt. 
```

# plsql - PL/SQL Oracle：在插入前触发器中访问新值

> ID：13573648
> 
> 赞同：1
> 
> 时间：2012-11-26T21:43:58.050
> 
> 标签：plsql, triggers, oracle11g

面临以下错误：

```
[Error] PLS-00049 (12: 11): PLS-00049: bad bind variable 'NEW.OPTION_D' 
```

我正在尝试执行以下操作：

```
create or replace trigger check_option_for_stage
before insert on lot_option
for each row
when (new.stage_id > 0 and new.option_id > 0)
declare 
not_existing_option exception;
num_count number;
begin
    select count(*) into num_count 
    from option_cost os
    where :new.option_id = os.option_id and :new.stage_id = os.stage_id;
    if num_count = 1 then
        DBMS_OUTPUT.PUT_LINE('The option can be applied to the lot at the current stage');
    ELSE
        raise not_existing_option;    
    end if;
exception
    when not_existing_option then
        DBMS_OUTPUT.PUT_LINE('The option is not available on this stage, therefore rejected');
    when others then
        DBMS_OUTPUT.PUT_LINE('Oops!, something went wrong, it needs your attention!');
end;
/ 
```

我为什么要面对这个？为什么它是一个糟糕的绑定变量？我知道我应该能够通过键入来访问新值`:new.whateverthecolumnname`

我正在使用 Oracle 11g。

我正在玩的桌子的定义

```
SQL> desc option_cost
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 COST                                      NOT NULL NUMBER
 OPTION_ID                                 NOT NULL NUMBER(38)
 STAGE_ID                                  NOT NULL NUMBER(38)

SQL> desc lot_option;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 LOT_ID                                    NOT NULL NUMBER(38)
 OPTION_ID                                 NOT NULL NUMBER(38)
 COST                                      NOT NULL NUMBER
 DATE_CREATED                                       DATE
 STAGE_ID                                  NOT NULL NUMBER(38) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T21:50:43.827

是列`option_id`（`id`末尾有一个）还是只是`option_d`（没有`i`）？ `option_id`似乎更有意义。假设`option_id`是正确的，您的`SELECT`陈述中有一个错字，您缺少`i`in `id`。你想要类似的东西

```
select count(*) 
  into count 
  from option_cost oc
 where :new.option_id = oc.option_id 
   and :new.stage_id = oc.stage_id; 
```

当然，既然`count`是保留字，那么声明一个名为 的局部变量并不是一个好主意`count`。`l_count`例如，命名该变量或使用其他命名约定来标识局部变量并避免使用保留字会更有意义。

# c++ - 无锁矢量

> ID：13573651
> 
> 赞同：-3
> 
> 时间：2012-11-26T21:44:12.977
> 
> 标签：c++, multithreading

我最近对无锁编程很感兴趣，并尝试编写一个固定大小的无锁向量（[github](https://github.com/sanjoy/eelish)链接）。虽然它*有效*，但如果我的逻辑看起来有问题或可疑，我很想从更有经验的人那里得到一些反馈。

在测试无锁数据结构时，是否有任何标准技术特别有用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T21:46:13.023

`std::vector`是无锁的。一般来说，任何好的向量实现都是无锁的，因为向量的粒度太低，锁无法使用。

# php - 四舍五入到最接近的十分之一？

> ID：13573652
> 
> 赞同：-9
> 
> 时间：2012-11-26T21:44:26.247
> 
> 标签：php, rounding

> **可能重复：**
> [在 PHP 中向上舍入到最接近的 50,000](https://stackoverflow.com/questions/12745332/round-up-to-the-nearest-50-000-in-php)

我有这个，52.52，我希望它变成 52.5。我将如何在 PHP 中做到这一点？我试过 round() 但没有用。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-26T21:47:04.657

```
round($num, 1); 
```

应该将 $num 舍入到最接近的十分之一（第二个参数指定精度，或者它应该舍入到的小数点后的位数）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:46:58.970

尝试

```
$x = number_format('52.52', 1) 
```

[文档在这里](http://php.net/manual/en/function.number-format.php)

# html - CSS 边距恐怖；边距在父元素外添加空间

> ID：13573653
> 
> 赞同：187
> 
> 时间：2012-11-26T21:44:28.690
> 
> 标签：html, css, overflow, margin

我的 CSS 边距不符合我想要或期望的方式。我似乎我的页眉边距顶部会影响它周围的 div-tags。

**这是我想要和期望的：** ![我想要的是....](../Images/4d73c10eb15ae53879fea966d657412c.png)

**...但这就是我最终的结果：** ![我得到什么...](../Images/5191568ed0de4dbe4fd35594f8d1aa32.png)

**来源：**

```
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Margin test</title>

<style type="text/css">
body {
    margin:0;
}
#page {
    margin:0;
    background:#FF9;
}
#page_container {
    margin:0 20px;
}
h1 {
    margin:50px 0 0 0;
}
</style>

</head>

<body>

<div id="page">
    <div id="page_container">
        <header id="branding" role="banner">
            <hgroup>
                <h1 id="site-title"><span><a href="#" title="Title" rel="home">Title</a></span></h1>
                <h2 id="site-description">Description</h2>
            </hgroup>
        </header>
    </div>
</div> 
```

在这个例子中我夸大了边距。h1-tag 上的默认浏览器边距要小一些，在我的情况下，我使用*Twitter Bootstrap，使用 Normalizer.css*将默认边距设置为 10px。没那么重要，重点是；我不能，不应该，*不想*改变 h1-tag 上的边距。

我想这与我的另一个问题相似；*[为什么这种 CSS margin-top 样式不起作用？](https://stackoverflow.com/q/9519841/266642)*. 问题是我该如何解决这个特定问题？

我已经阅读[了一些](https://stackoverflow.com/q/7742720/266642)关于类似问题的主题，但没有找到任何真正的答案和解决方案。我知道添加`padding:1px;`或`border:1px;`解决问题。但这只会增加新的问题，因为我不想在我的 div 标签上添加填充或边框。

必须有更好的最佳实践解决方案吗？这一定很常见。

* * *

## 回答 #1

> 赞同：251
> 
> 时间：2012-11-26T21:49:28.433

添加`overflow:auto`到您的`#page`div。

**[jsFiddle 示例](http://jsfiddle.net/j08691/464jW/)**

并在您使用时查看[折叠边距。](http://www.w3.org/TR/CSS2/box.html#collapsing-margins)

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2017-02-06T14:09:15.053

添加以下任一规则：

```
float: left/right;
position: absolute;
display: inline-block;
overflow: auto/scroll/hidden;
clear: left/right/both; 
```

这是由`collapsing margins`. [在此处](https://www.sitepoint.com/web-foundations/collapsing-margins/)查看有关此行为的文章。

根据这篇文章：

> W3C 规范定义折叠边距如下：
> 
> “在本规范中，折叠边距表示两个或多个框（可能彼此相邻或嵌套）的相邻边距（没有非空内容、填充或边界区域或间隙分隔它们）组合形成一个边距。”</p>

对于父子元素也是如此。

所有答案都包括一种可能的解决方案：

> 在其他情况下，元素的边距没有折叠：
> 
> *   浮动元素
> *   绝对定位元素
> *   行内块元素
> *   溢出设置为可见以外的任何元素（它们不会与子元素一起折叠边距。）
> *   清除的元素（它们不会用其父块的底部边距折叠顶部边距。）
> *   根元素

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-11-26T21:51:13.030

问题是父母没有考虑孩子的身高。添加`display:inline-block;`为我做了。

**完整的 CSS**

```
#page {
    margin:0;
    background:#FF9;
    display:inline-block;
    width:100%;
} 
```

[见小提琴](http://jsfiddle.net/M3Mu6/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-10-30T01:45:08.577

只需添加`border-top: 1px solid transparent;`到您的`#page`元素。

[来自 w3.org](https://www.w3.org/TR/CSS2/box.html#collapsing-margins)

> 两个边距相邻当且仅当：
> - 没有行框、没有间隙、没有填充和没有边框将它们分开

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-05-03T09:32:13.043

添加以下规则：

```
overflow: hidden; 
```

这是由于边距塌陷造成的。[在此处](https://teamtreehouse.com/community/why-there-is-a-white-space-above-header)查看有关此行为的文章。

根据这篇文章：

> 如果父元素没有任何顶部填充或小于其第一个子元素的顶部边距，则元素的渲染方式使父元素看起来具有子元素的边距。因此，这可能发生在满足这些条件的页面上的任何位置，但它往往在页面顶部最为明显。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-11-26T22:15:34.573

其他答案中的解决方案对我不起作用。透明边框、inline-block 等，都会引起其他问题。相反，我将以下 css 添加到我的祖先元素中：

```
parent::after{
  content: "";
  display: inline-block;
  clear: both;
} 
```

根据您的情况，这可能会导致其自身的问题，因为它在最后一个子元素之后添加了额外的空间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-03T11:52:36.893

```
#page {
overflow: hidden;
margin:0;
background:#FF9;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-05-15T02:02:55.270

我为 XenForo 2.1 制作样式时的方法，但它应该对您有用：（请将这些 LESS 变量替换为您的实际值。此外，小边距的绝对值应与前后伪的高度相同元素。）

```
// The following two lines are to avoid top & bottom fieldset borders run out of the block body.
// (Do not tweak the CSS overflow settings, otherwise the editor menu won't be float above the block border.)
&:before {content: "\a0"; display: block; width: auto; margin-bottom: floor(-1 * @xf-lineHeightDefault * @xf-fontSizeSmall - @xf-borderSizeMinorFeature);}
&:after {content: "\a0"; display: block; width: auto; margin-top: floor(-1 * @xf-lineHeightDefault * @xf-fontSizeSmall - @xf-borderSizeMinorFeature);} 
```

# jsf - ui:repeat 与 c:forEach 中的复合组件使用 ajax 调用

> ID：13573659
> 
> 赞同：2
> 
> 时间：2012-11-26T21:44:47.167
> 
> 标签：jsf, classcastexception, composite-component, uirepeat

我有一个复合组件，它表示将存储在列表中的项目。我想使用 显示这些项目`<ui:repeat>`，但在进行 ajax 调用时遇到问题。问题是对于`<f:ajax>`渲染属性，我想通过

```
#{cc.clientId} 
```

但是，当我将它与 一起使用时，这会引发错误`<ui:repeat>`，因为本文档[https://rogerkeays.com/jsf-c-foreach-vs-ui-repeat](https://rogerkeays.com/jsf-c-foreach-vs-ui-repeat)中解释了原因。

```
<cc:implementation>
    <div id="#{cc.clientId}">
          <h:form>
                <h:commandLink styleClass="btn btn-info" value="Click me">
                    <f:ajax execute="@form"
                            render=":#{cc.clientId}"/>
                </h:commandLink>
            </h:form>
    </div>
</cc:implementation> 
```

有没有办法让上述组件工作`<ui:repeat>`（例如，有没有可以替换`<f:ajax>`标签处理程序的组件，或者我们坚持`<c:forEach>`构建）？

```
<ui:repeat id="myComponent" value="#{backingBean.myComponentItem}" var="item" varStatus="itemIndex">
    <components:exampleComponent id="myComponent"/>
</ui:repeat> 
```

所以我开始使用`<c:forEach>`而不是`<ui:repeat>`，并且我能够在 的渲染属性中使用我的组件的 id `<f:ajax>`。但是这次当我进行分页时，如果列表的大小减小，我的页面中就会开始出现空组件。为了解决这个问题，我开始通过 ajax 调用进行分页，这解决了空组件问题。

只是我以为一切都解决了我遇到了另一个问题：假设我有一个列出 10 个组件的页面，然后我转到另一个页面，从那个页面我又来到了组件显示页面，但是由于某种原因，这次我说我从数据库中仅检索了 3 个项目，我只想通过我的组件显示这 3 个项目，但没有别的。不幸的是，在这种情况下，3 个项目正确显示，但页面也包含 7 个空组件。为了克服这一点，我需要再次重定向到此页面。所以我就在这一点上放弃了。除此之外，当页面上的组件数量发生变化时，我最终也得到了以下异常。

```
java.lang.ClassCastException: [Ljava.lang.Object; cannot be cast to com.sun.faces.application.view.StateHolderSaver 
```

我尝试使用帖子[Jsf Error : java.lang.ClassCastException](https://stackoverflow.com/questions/5694350/jsf-error-java-lang-classcastexception)中解释的建议，但它对我不起作用，我开始收到另一个类似于上述异常的错误。

```
<context-param>
    <param-name>javax.faces.FULL_STATE_SAVING_VIEW_IDS</param-name>
    <param-value>/pagename.xhtml</param-value>
</context-param> 
```

因此，经过这些冗长的解释后，我只想了解创建支持 ajax 的复合组件的最佳方法是什么，他们完全负责自己的状态并独立于其他组件，并且可以在页面中显示更多不止一次，并且组件的数量在页面生命周期中可能会有所不同（通过分页、导航等）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T18:23:47.777

So far the best solution I came up with is, to check number of components in the page and when that number changes through an ajax call or because of a navigation from another page, redirect to the destination page one more time, this refreshes the empty components in the page without creating much disturbance to users. If you come up with any better solution please let us know.

# .net - 如何使用大字节数组？

> ID：13573661
> 
> 赞同：0
> 
> 时间：2012-11-26T21:45:01.153
> 
> 标签：.net, c#-4.0, bytearray, ienumerable

我有一个大字节数组，我将它分成 1000 个字节的多字节数组并处理它们。我正在使用 IEnumerable，我可以使用 foreach 循环，但我想知道我正在使用的 IEnumerable 中的数组数量。我可以获得总数，但不知道我正在处理的字节数组数量，所以谁能帮我弄清楚如何实现这一点？如果您需要更多详细信息，请告诉我。

```
 public static IEnumerable<byte[]> SplitSourceBytes(byte[] SrcBytes, int size)
    {
        int srcLenght = SrcBytes.Length;
        byte[] source = null;

        int i = 0;
        for (; srcLenght > (i + 1) * size; i++)
        {
            source = new byte[size];
            Array.Copy(SrcBytes, i * size, source, 0, size);
            yield return source;
        }

        int sourceLeft = srcLenght - i * size;
        if (sourceLeft > 0)
        {
            source = new byte[sourceLeft];
            Array.Copy(SrcBytes, i * size, source, 0, sourceLeft);
            yield return source;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:35:03.413

您不需要创建新的字节数组；您可以使用`ArraySegment<byte>`枚举来“拆分”您的大数组，而不会产生新字节数组分配的损失。

```
public static IEnumerable<ArraySegment<byte>> SplitSourceBytes(byte[] SrcBytes, int size)
{
    int srcLength = SrcBytes.Length;
    int alreadyReturned = 0;
    while (alreadyReturned < srcLength)
    {
        int count = Math.Min(srcLength - alreadyReturned, size);
        yield return new ArraySegment<byte>(SrcBytes, alreadyReturned, count);
        alreadyReturned += count;
    }
} 
```

要使用它，代码将类似于以下代码：

```
foreach (var segment in SplitSourceBytes(bytes, 1000)) {
    int maxAttempts = 3;
    int attempts = 0;
    bool dataSent = false;
    while (!dataSent && attempts < maxAttempts)
    {
        try
        {
            serverStream.Write(segment.Array, segment.Offset, segment.Count);
            dataSent = true;
        }
        catch (Exception ex)
        {
            // Error, try to retransmit
            attempts++;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:03:19.643

这可能适用于您需要的东西

```
 private Dictionary<int,byte[]> SplitByteArray(byte[] SrcBytes, int size)
        {
            var result = new Dictionary<int, byte[]>();
            if (SrcBytes.Length > size)
            {
                int position = SrcBytes.Length;
                int index = 0;
                for (int i = 0; i < SrcBytes.Length; i += size)
                {
                    int length = Math.Min(size, position);
                    byte[] buffer = new byte[length];
                    Buffer.BlockCopy(SrcBytes, i, buffer, 0, length);
                    result.Add(index, buffer);
                    position -= size;
                    index++;
                }
            }
            else
            {
                result.Add(0, SrcBytes);
            }
            return result;
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T22:49:14.997

您可以将数组放在提供计数功能的列表中。

```
public static IEnumerable<byte[]> SplitSourceBytes(byte[] SrcBytes, int size)
    {
        List<byte[]> Resultset = new List<byte[]>();

        int srcLenght = SrcBytes.Length;
        byte[] source = null;

        int i = 0;
        for (; srcLenght > (i + 1) * size; i++)
        {
            Debug.WriteLine(string.Format("Working on byte array {0}.", Resultset.Count + 1); 
            source = new byte[size];
            Array.Copy(SrcBytes, i * size, source, 0, size);
            Resultset.Add(source);
        }

        int sourceLeft = srcLenght - i * size;
        if (sourceLeft > 0)
        {
            source = new byte[sourceLeft];
            Array.Copy(SrcBytes, i * size, source, 0, sourceLeft);
            Resultset.Add(source);
        }
        return Resultset;
    } 
```

# objective-c - 动画只运行一次？

> ID：13573665
> 
> 赞同：-2
> 
> 时间：2012-11-26T21:45:20.960
> 
> 标签：objective-c, ios, core-animation

问题是动画只运行一次然后不能再重复。我需要在某个地方再添加一个 NSTimer 吗？

有什么我想念的吗？寻求帮助和建议。非常感谢 ！

这是代码。

首先，在 ViewController.h & ViewController.m

* * *

```
@interface ViewController : UIViewController {
    GameView* gameView;
} 
```

* * *

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    if(gameView == nil) {
        gameView = [[GameView alloc] initWithFrame:CGRectMake(0, 0, 320, 480)];
        gameView.backgroundColor = [UIColor clearColor];
    }

    [self.view addSubview:gameView];

    [[AppEngine sharedInstance] addSnow:CGPointMake((random() % 320),(random() % -20))];
    [[AppEngine sharedInstance] addSnow:CGPointMake((random() % 320),(random() % -20))];
    [[AppEngine sharedInstance] addSnow:CGPointMake((random() % 320),(random() % -20))];
    [[AppEngine sharedInstance] addSnow:CGPointMake((random() % 320),(random() % -20))];
    [[AppEngine sharedInstance] addSnow:CGPointMake((random() % 320),(random() % -20))];
} 
```

在 GameView.h 和 .m

* * *

```
@interface GameView : UIView <UIAccelerometerDelegate>{
    CADisplayLink* displayLink;
} 

-(void) timeStep; 
```

* * *

```
- (id)initWithFrame:(CGRect)frame {

    self = [super initWithFrame:frame];
    if (self) {
        displayLink = [CADisplayLink displayLinkWithTarget:self selector:@selector(timeStep)];
        [displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
    }
    return self;
}

-(void) timeStep {
    [[AppEngine sharedInstance] timeStep];
    [self setNeedsDisplay];
}

- (void)drawRect:(CGRect)rect {

    [[UIImage imageNamed:@"Christmas.jpg"] drawInRect:CGRectMake(0,0,320,480)]; // set the background image

    CGContextRef context = UIGraphicsGetCurrentContext();

    for(MySnow* snowObject in [AppEngine sharedInstance].snowObjectArray)

    {
        CGContextSaveGState(context);

        CGContextTranslateCTM(context, snowObject.x, snowObject.y);

        NSString *imagePath = [NSString stringWithFormat:@"snowflake0%d.png",snowObject.type];

        [[UIImage imageNamed: imagePath] drawInRect:CGRectMake(-16,-16,32,32)];

        CGContextRestoreGState(context);
    }
} 
```

* * *

三、在雪中.h&m

* * *

```
@interface MySnow : NSObject
{
    float x,y;
    float vx, vy;
    float rotSpeed;
    float rotation;
    int type;
    }

@property (nonatomic) float x,y;
@property (nonatomic) float vx, vy, rotSpeed,rotation;
@property (nonatomic) int type;

-(id) initWithStartPoint:(CGPoint) startPoint withType:(int) type;
-(void) timeStep; 
```

* * *

```
@implementation MySnow
@synthesize x,y,vx,vy,rotation,rotSpeed,type;

-(id) initWithStartPoint:(CGPoint) startPoint withType:(int) _type {
    self = [super init];
    if(self) {

    x = startPoint.x;
        y = startPoint.y;
        vx = RANDOM_FLOAT() * 1 + 0.1;
        vy = RANDOM_FLOAT() * 2 + 0.1;
        type = _type;
    }
    return self;
}

-(void) timeStep {
    y += vy;
} 
```

* * *

## 最后，在 AppEngine.h & m

```
@interface AppEngine : NSObject {
    NSMutableArray* snowObjectArray;
    float ax, ay;
}

@property (readonly) NSMutableArray* snowObjectArray;
@property (nonatomic) float ax,ay;

+(AppEngine*) sharedInstance;
+(void) destoryInstance;
-(void) timeStep;
-(void) addSnow:(CGPoint) point; 
```

* * *

```
static AppEngine* _sharedEngine;

@implementation AppEngine
@synthesize snowObjectArray;
@synthesize ax,ay;
+(AppEngine*) sharedInstance {
    if(_sharedEngine == nil)
        _sharedEngine = [[AppEngine alloc] init];
    return _sharedEngine;
}

+(void) destoryInstance {
    if(_sharedEngine != nil) {
        _sharedEngine = nil;
    }
}

-(id) init {
    self = [super init];
    if(self) {
        snowObjectArray = [[NSMutableArray alloc] init];
    }
    return self;
}

-(void) addSnow:(CGPoint) point {
    int type = (arc4random() % 9) + 1;  // random snow image 01 to 09
    MySnow* snowObject = [[MySnow alloc] initWithStartPoint:point withType:type];
    [snowObjectArray addObject:snowObject];
}

-(void) timeStep {
    NSMutableArray* removeArray = [NSMutableArray array];
    for(MySnow* item in snowObjectArray) {
        [item timeStep];
        if(item.y > 400 || item.y < -100)
        [removeArray addObject:item];
    }
   [snowObjectArray removeObjectsInArray:removeArray];
 [removeArray removeAllObjects];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T01:50:04.383

这是你的代码吗？你能解释一下它是如何开始动画的吗？

在我看来，AppEngine 的 timeStep 方法的代码一旦到达某个边界，就会专门删除 snowObjectsArray 中的每个项目。但是，如果这是您的代码，您为什么不了解它的作用？

编辑：好的，这是来自讲座。

如果您希望动画继续播放，我会这样做：

从您的 viewDidLoad 方法中取出最后一段代码（创建和添加雪对象的代码）并将其放在单独的方法中。让 viewDidLoad 调用该方法。让我们调用方法 makeItSnow。

然后，在 AppEngine timeStep 方法结束时，如果 snowObjectArray 中的对象计数降至 0，则调用 makeItSnow。

这种方法会使一组雪花从顶部开始，落下并消失，然后另一组雪花开始。如果您想要连续不断的雪花流，则更改 timeStep 方法以计算它删除的雪花对象的数量，并在方法结束时将那么多雪花添加回数组。这将导致您的程序在每个雪花消失时添加一个新的雪花。

另一种方法是向 AppEngine 添加一个重复计时器，并让该计时器创建另一个雪花。这将继续定期添加雪花。

# iphone - iPhone：已删除的 PNG 文件继续加载到 ImageView

> ID：13573666
> 
> 赞同：0
> 
> 时间：2012-11-26T21:45:25.530
> 
> 标签：iphone, ios, xcode, cocoa-touch

我有以下代码行将 png 文件加载到`UIImageView`：

```
UIImageView *backgroundImageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"Background.png"]]; 
```

问题是，我早就从项目中删除了“Background.png”，它仍在加载中！我试过清理，构建，从手机上删除应用程序，重启手机，删除项目文件夹中的构建文件夹，删除派生数据，它仍在加载！有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:16:41.657

我知道这听起来很邋遢，但我以前也遇到过类似的问题，而且，就个人而言，我只是将代码更改为

```
UIImageView *backgroundImageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"NewBackground.png"]]; 
```

忘记它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:52:05.127

似乎问题在于旧目标的文件夹仍在我的项目文件夹中（即使在我很久以前删除了目标之后）。我删除了文件夹，从手机上删除了应用程序，清理并重建了它，它工作了。

# python - 小数树桩程序

> ID：13573672
> 
> 赞同：0
> 
> 时间：2012-11-26T21:45:53.907
> 
> 标签：python, decimal

```
Battery_Initial = raw_input("Enter Current Capacity:"))

if Battery_Initial < 0:
    print 'Battery Reading Malfunction'

elif Battery_Initial > 80:
    print 'Battery Reading Malfunction' 
```

到目前为止，这是我的程序。我想知道是否有一种方法只允许输入，例如 0.5、1.0、1.5，基本上在 0.5 的间隔上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:47:51.280

您需要使用`float()`而不是`int()`，因为`int()`期望十进制输入不是浮点数。

```
Battery_Initial = float(raw_input("Enter Current Capacity:")) 
```

**输出：**

```
$ python so27.py
Enter Current Capacity:0.5

$ python so27.py
Enter Current Capacity:81.1
Battery Reading Malfunction

$ python so27.py
Enter Current Capacity:-1.2
Battery Reading Malfunction

$ python so27.py
Enter Current Capacity:-1
Battery Reading Malfunction 
```

使用这样的东西：

```
In [271]: [i/float(2) for i in range(1,10)]
Out[271]: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5] 
```

**用法：**

```
if  Battery_Initial in (i/float(2) for i in range(1,10)):
        #do something here 
```

或如@Joran Beasley 建议的那样：

```
if  Battery_Initial % 0.5 ==0:
    #do something here 
```

# php - 您如何转换 crypt() 哈希以用作文件名？

> ID：13573673
> 
> 赞同：1
> 
> 时间：2012-11-26T21:46:02.143
> 
> 标签：php, hash

我正在使用 crypt() ，它在特定情况下使用带有 12 个字符 salt 的 md5 哈希。

这是从 php.net，crypt 文档修改的字符串 crypt() 返回的示例。

```
$1$rasmusle$rISCgZzpwk3UhDidwX/in0 
```

这是也包括编码类型的盐。

```
$1$rasmusle$ 
```

这里是编码类型。（在这种情况下为 MD5）

```
$1$ 
```

最后是哈希值。

```
rISCgZzpwk3UhDidwX/in0 
```

您不能在文件名中使用正斜杠，因为这将被解释为文件夹。

我是否应该简单地删除所有正斜杠，并且 crypt() 使用的字符集是否存在其他问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T21:54:08.790

看起来您想阻止/允许特定用户访问图像。如果是这种情况，我会执行以下操作：

1.  将图像存储在文档根目录之外。这确保不能简单地直接请求图像。
2.  将图像原始名称存储在数据库中，并将[`sha1_file()`](http://php.net/manual/en/function.sha1-file.php)哈希存储在同一记录中。如果您的服务器上没有重复图像，这会增加好处。尽管图像很小，但它可以防止系统混乱。
3.  当有人请求“私人”图像时，他们将通过 PHP 文件请求它，该文件将检查用户是否有权访问该文件，如果有，则提供该文件（来自数据库）。

使用上述方法，您将最大程度地控制谁可以请求图像，您的用户会为此感谢您。

*Note: that you cannot simply store all images in the same folder, because all filesystems have [limits as to how many files can be stored in a single directory](https://stackoverflow.com/questions/466521/how-many-files-in-a-directory-is-too-many)*

A simple example of a PHP script that serves an image would look something like the following:

```
<?php

// always set the header and change it according to the type of the image
header("Content-type: image/jpeg");
echo file_get_contents('/path/to/the/image.jpg'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:48:31.117

/$1$/ - 是一种用于创建哈希的算法

您可以只使用`md5` `md5_file`/`sha1` `sha1_file`函数来创建哈希而不需要额外的信息。除非你想同时使用不同的算法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T21:48:38.340

在你的哈希上运行一个 URLEncode 方法，它应该用 %2F 替换所有的 '/' ...我知道这不是一个完美的修复，因为我认为像 apache 服务器这样的东西仍然会阻止任何带有 '%2F 的 Web 请求' 在网址中。只是我在这件事上的 2 美分

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-26T21:49:54.120

**始终**规范化用户提供的数据，包括文件名，除非您想通过上传名称包含的文件`NULL`来欺骗 PHP。指定允许的字符（即 A-Za-z0-9 并将所有其他字符转换为下划线。或使用 sha1/md5 从文件名创建哈希并以该名称存储文件。

**编辑**

这将用下划线替换除 AZ、az、0-9 之外的所有字符`_`：

```
$normalizedName = preg_replace('/[^A-Za-z0-9]/', '_', $userProvidedName); 
```

# iphone - 通用应用程序/可翻转/带标签栏控制器和拆分视图

> ID：13573674
> 
> 赞同：1
> 
> 时间：2012-11-26T21:46:04.783
> 
> 标签：iphone, uitabbarcontroller, ipad, universal

我正在尝试开发具有以下功能的应用程序框架目标是开发一个通用的屏幕流程，该流程以类似于天气应用程序的 uiview 开始，并在翻转时加载基于 uitabbar 控制器的视图。对于 iPad 的标签栏项目，应该附有拆分视图。

通用应用程序 - 有一个窗口和切换视图控制器（UI 视图控制器）基于设备 - 在 iPhone 上像往常一样切换主窗口 - iphone 的切换视图控制器有 2 个视图控制器，例如 settingsVC 和 systemVC - 默认情况下它加载设置 VC并且 - 单击按钮后，它会翻转到 systemVC（类似于天气应用程序） - systemVC 在其视图中添加了一个标签栏控制 - 这部分工作正常

在 iPad 上 - 我有一个带有 2 个 VC 的类似可翻转屏幕 - 现在在 systemVC 上有一个 uiview - 我正在使用 IB 和插座向其子视图添加一个 tabbarcontroller

问题是 uitabbar 的一半隐藏在屏幕下方。我尝试更改 IB 的值似乎有效。

只是想知道，如果我在正确的轨道上，什么可能是错的。

我将非常感谢任何提示或疑虑。

谢谢和美好的一天！

湿婆

# objective-c - IOS 中的圆形进度条

> ID：13573676
> 
> 赞同：57
> 
> 时间：2012-11-26T21:46:08.270
> 
> 标签：objective-c, cocoa-touch, ios5, ios4, ios6

我想创建一个圆形进度条，如下所示：

![圆形进度条](../Images/43fa78b76c0d8c209443cba39bf3ad9d.png)

我如何使用 Objective-C 和 Cocoa 来做到这一点？

我是如何开始创建 UIView 并编辑 drawRect 的，但我有点迷失了。任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-11-27T20:51:00.650

基本概念是利用`UIBezierPath`课程来发挥自己的优势。您可以绘制弧线，从而达到您所追求的效果。我只有半个小时左右的时间来解决这个问题，但我的尝试在下面。

非常简陋，它只是在路径上使用笔画，但我们开始了。您可以根据您的确切需要更改/修改它，但是执行弧倒计时的逻辑将非常相似。

在视图类中：

```
@interface TestView () {
    CGFloat startAngle;
    CGFloat endAngle;
}

@end

@implementation TestView

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        self.backgroundColor = [UIColor whiteColor];

        // Determine our start and stop angles for the arc (in radians)
        startAngle = M_PI * 1.5;
        endAngle = startAngle + (M_PI * 2);

    }
    return self;
}

- (void)drawRect:(CGRect)rect
{
    // Display our percentage as a string
    NSString* textContent = [NSString stringWithFormat:@"%d", self.percent];

    UIBezierPath* bezierPath = [UIBezierPath bezierPath];

    // Create our arc, with the correct angles
    [bezierPath addArcWithCenter:CGPointMake(rect.size.width / 2, rect.size.height / 2) 
                          radius:130 
                      startAngle:startAngle
                        endAngle:(endAngle - startAngle) * (_percent / 100.0) + startAngle
                       clockwise:YES];

    // Set the display for the path, and stroke it
    bezierPath.lineWidth = 20;
    [[UIColor redColor] setStroke];
    [bezierPath stroke];

    // Text Drawing
    CGRect textRect = CGRectMake((rect.size.width / 2.0) - 71/2.0, (rect.size.height / 2.0) - 45/2.0, 71, 45);
    [[UIColor blackColor] setFill];
    [textContent drawInRect: textRect withFont: [UIFont fontWithName: @"Helvetica-Bold" size: 42.5] lineBreakMode: NSLineBreakByWordWrapping alignment: NSTextAlignmentCenter];
} 
```

对于视图控制器：

```
@interface ViewController () {    
    TestView* m_testView;
    NSTimer* m_timer;
}

@end

- (void)viewDidLoad
{
    // Init our view
    [super viewDidLoad];
    m_testView = [[TestView alloc] initWithFrame:self.view.bounds];
    m_testView.percent = 100;
    [self.view addSubview:m_testView];
}

- (void)viewDidAppear:(BOOL)animated
{
    // Kick off a timer to count it down
    m_timer = [NSTimer scheduledTimerWithTimeInterval:0.1 target:self selector:@selector(decrementSpin) userInfo:nil repeats:YES];
}

- (void)decrementSpin
{
    // If we can decrement our percentage, do so, and redraw the view
    if (m_testView.percent > 0) {
        m_testView.percent = m_testView.percent - 1;
        [m_testView setNeedsDisplay];
    }
    else {
       [m_timer invalidate];
       m_timer = nil;
    }
} 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-07-22T16:44:24.073

我的魔术数字示例（为了更好地理解）：

```
 CAShapeLayer *circle = [CAShapeLayer layer];
  circle.path = [UIBezierPath bezierPathWithArcCenter:CGPointMake(29, 29) radius:27 startAngle:-M_PI_2 endAngle:2 * M_PI - M_PI_2 clockwise:YES].CGPath;
  circle.fillColor = [UIColor clearColor].CGColor;
  circle.strokeColor = [UIColor greenColor].CGColor;
  circle.lineWidth = 4;

  CABasicAnimation *animation = [CABasicAnimation animationWithKeyPath:@"strokeEnd"];
  animation.duration = 10;
  animation.removedOnCompletion = NO;
  animation.fromValue = @(0);
  animation.toValue = @(1);
  animation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionLinear];
  [circle addAnimation:animation forKey:@"drawCircleAnimation"];

  [imageCircle.layer.sublayers makeObjectsPerformSelector:@selector(removeFromSuperlayer)];
  [imageCircle.layer addSublayer:circle]; 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-06-12T22:37:03.953

我已经为 iOS 实现了一个简单的库。它基于 UILabel 类，因此您可以在进度条中显示您想要的任何内容，但您也可以将其留空。

初始化后，您只有一行代码来设置进度：

`[_myProgressLabel setProgress:(50/100))];`

该库被命名为[KAProgressLabel](http://alexiscreuzot.com/KAProgressLabel/)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-07-23T14:34:04.220

你可以查看我的 lib [MBCircularProgressBar](http://github.com/matibot/MBCircularProgressBar)

[![](../Images/359f17a64e109fd1b3417cbb332dea28.png)](https://i.stack.imgur.com/aPGh3.png)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2015-01-28T11:53:56.720

对于**Swift**使用这个，

```
let circle = UIView(frame: CGRectMake(0,0, 100, 100))

circle.layoutIfNeeded()

let centerPoint = CGPoint (x: circle.bounds.width / 2, y: circle.bounds.width / 2)
let circleRadius : CGFloat = circle.bounds.width / 2 * 0.83

var circlePath = UIBezierPath(arcCenter: centerPoint, radius: circleRadius, startAngle: CGFloat(-0.5 * M_PI), endAngle: CGFloat(1.5 * M_PI), clockwise: true    )

let progressCircle = CAShapeLayer()
progressCircle.path = circlePath.CGPath
progressCircle.strokeColor = UIColor.greenColor().CGColor
progressCircle.fillColor = UIColor.clearColor().CGColor
progressCircle.lineWidth = 1.5
progressCircle.strokeStart = 0
progressCircle.strokeEnd = 0.22

circle.layer.addSublayer(progressCircle)

self.view.addSubview(circle) 
```

参考：见[这里](http://notebookheavy.com/2014/07/30/ios-7-style-progress-meter-in-swift/ "此代码参考")。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2017-01-12T06:51:53.773

**Swift 3 使用这个，**

CAShapeLayer with Animation : 继续 Zaid Pathan ans。

```
 let circle = UIView(frame: CGRect(x: 100, y: 100, width: 100, height: 100))

    circle.layoutIfNeeded()

    var progressCircle = CAShapeLayer()

    let centerPoint = CGPoint (x: circle.bounds.width / 2, y: circle.bounds.width / 2)
    let circleRadius : CGFloat = circle.bounds.width / 2 * 0.83

    let circlePath = UIBezierPath(arcCenter: centerPoint, radius: circleRadius, startAngle: CGFloat(-0.5 * M_PI), endAngle: CGFloat(1.5 * M_PI), clockwise: true    )

    progressCircle = CAShapeLayer ()
    progressCircle.path = circlePath.cgPath
    progressCircle.strokeColor = UIColor.green.cgColor
    progressCircle.fillColor = UIColor.clear.cgColor
    progressCircle.lineWidth = 2.5
    progressCircle.strokeStart = 0
    progressCircle.strokeEnd = 1.0
     circle.layer.addSublayer(progressCircle)

    let animation = CABasicAnimation(keyPath: "strokeEnd")
    animation.fromValue = 0
    animation.toValue = 1.0
    animation.duration = 5.0
    animation.fillMode = kCAFillModeForwards
    animation.isRemovedOnCompletion = false
     progressCircle.add(animation, forKey: "ani")

    self.view.addSubview(circle) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-02-29T07:44:17.253

这是一个**Swift**示例，说明如何制作一个简单的、不封闭的（为长数字留出空间）带有圆角和动画的圆形进度条。

[open_circular_progress_bar.jpg](https://i.stack.imgur.com/uwPNH.jpg)

```
func drawBackRingFittingInsideView(lineWidth: CGFloat, lineColor: UIColor) {

    let halfSize:CGFloat = min( bounds.size.width/2, bounds.size.height/2)

    let desiredLineWidth:CGFloat = lineWidth

    let circle = CGFloat(Double.pi * 2)

    let startAngle = CGFloat(circle * 0.1)

    let endAngle = circle – startAngle

    let circlePath = UIBezierPath(

        arcCenter: CGPoint(x:halfSize, y:halfSize),

        radius: CGFloat( halfSize – (desiredLineWidth/2) ),

        startAngle: startAngle,

        endAngle: endAngle,

        clockwise: true)

    let shapeBackLayer = CAShapeLayer()

        shapeBackLayer.path = circlePath.cgPath

        shapeBackLayer.fillColor = UIColor.clear.cgColor

        shapeBackLayer.strokeColor = lineColor.cgColor

        shapeBackLayer.lineWidth = desiredLineWidth

        shapeBackLayer.lineCap = .round

    layer.addSublayer(shapeBackLayer)

} 
```

以及动画功能。

```
 func animateCircle(duration: TimeInterval) {

    let animation = CABasicAnimation(keyPath: “strokeEnd”)

    animation.duration = duration

    animation.fromValue = 0

    animation.toValue = 1

    animation.timingFunction = CAMediaTimingFunction(name: CAMediaTimingFunctionName.linear)        

    shapeLayer.strokeEnd = 1.0

    shapeLayer.add(animation, forKey: “animateCircle”)

} 
```

有一个很好的[博客](https://tripexbud.com/circular-progress-view-for-the-ios-apps/)例子。

# asp.net-mvc-3 - 在 IIS 7 中部署 MVC 应用程序

> ID：13573678
> 
> 赞同：0
> 
> 时间：2012-11-26T21:46:12.997
> 
> 标签：asp.net-mvc-3, deployment, iis-7

我已经制作了一个 MVC 3 应用程序，并且正在运行 Windows Server 2008 r2。我正在尝试部署它，当我加载文件并导航到 url 时，它只会显示我项目的文件目录。任何建议都会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:18:18.463

在某些情况下，它可能来自 IIS 7 无法识别扩展名较少的 url。我不是 100% 确定这是否是这里的问题，但肯定需要检查。

看看你们的系统上是否有这个更新：

[http://support.microsoft.com/kb/980368](http://support.microsoft.com/kb/980368)

技术细节可在：http: [//blogs.msdn.com/b/tmarq/archive/2010/04/01/asp-net-4-0-enables-routing-of-extensionless-urls-without-impacting -静态请求.aspx](http://blogs.msdn.com/b/tmarq/archive/2010/04/01/asp-net-4-0-enables-routing-of-extensionless-urls-without-impacting-static-requests.aspx)

# neo4j - 不同的服务器 neo4j 数据库和我的代码

> ID：13573681
> 
> 赞同：2
> 
> 时间：2012-11-26T21:46:29.200
> 
> 标签：neo4j

我想为我的网站使用 neo4j 图形数据库。我的网站和我的 neo4j 数据库不在同一台服务器上。如何从另一台服务器访问 neo4j 数据库？谁能帮我？

当我尝试像这样连接时，

```
GraphClient client = new GraphClient(new Uri("http://localhost:7474/db/data")); 
```

它工作正常，但是当我尝试像这样连接时，

```
GraphClient client = new GraphClient(new Uri("http://xx.xx.xxx.xxx:7474/db/data")); 
```

它无法连接。问题是什么？我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:49:49.090

Neo4J 默认配置为仅接受来自 127.0.0.1 的传入连接。

编辑您的`conf/neo4j-server.properties`文件，并确保您具有以下设置：

```
#allow any client to connect
org.neo4j.server.webserver.address=0.0.0.0 
```

有关详细信息，请参阅[http://docs.neo4j.org/chunked/milestone/server-configuration.html#_important_server_configurations_parameters](http://docs.neo4j.org/chunked/milestone/server-configuration.html#_important_server_configurations_parameters)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T09:42:39.360

您可以在 EC2 教程截屏视频中找到此示例设置的视频：[https ://vimeo.com/54142111](https://vimeo.com/54142111)

# c# - ViewModel 是否应该具有绑定到模型上的 DependencyProperties 的传递 DependencyProperties？

> ID：13573696
> 
> 赞同：5
> 
> 时间：2012-11-26T21:47:16.220
> 
> 标签：c#, wpf, mvvm

我是 WPF/MVVM 的新手，我发现的示例似乎并未涵盖我面临的问题。

我有一个用于管理相当复杂的业务配置对象的屏幕。在 MVVM 中，我认为这意味着我应该具有以下内容：

1.  逻辑接近于零的 XAML 视图
2.  具有屏幕逻辑的 ViewModel 类
3.  我平时的业务课都是填补Model的角色，拥有所有的业务逻辑

在我的情况下，有一些业务规则说更改我的业务类的 fieldA 可能会产生各种副作用，例如更改 fieldB 的值，或填充整个子对象列表。

我可能是错的，但我认为我应该将这些规则封装在业务类中，因为这些规则实际上与屏幕无关，而是与实体有关。

自然，这些副作用需要立即回到屏幕上。

因此，从用户的角度来看，他可能会编辑 fieldA，并在 View 上看到 fieldB 更新。

我了解如何将数据从 View 绑定到 ViewModel。

但就我而言，我似乎需要两层数据绑定：一层在 View 和 ViewModel 之间，另一层在 ViewModel 和 Model 之间。

鉴于我两次遇到基本相同的问题，我认为应该应用一种解决方案。所以我把我的模型类变成了一个DependencyObject，我把它的属性变成了DependencyProperties。

以 fieldA 为例，它会出现在所有三层中：

1.  View 作为数据绑定到 ViewModel.FieldA 的可视化组件，例如 text="{Binding FieldA, Mode=TwoWay}"
2.  ViewModel 作为 DependencyProperty “向上”绑定到视图，“向下”绑定到模型
3.  模型作为 DependencyProperty

我不希望通过跳过第 2 部分来直接将我的 View XAML 耦合到业务对象，这对我来说似乎不是一个干净的模式应用程序。也许这是被误导了。

我基本上似乎在我的 ViewModel 中需要一个“传递 DependencyProperty”。

我的问题：

*   这是正确的一般方法还是我认为这一切都错了？
*   是否有使用这种传递方法的示例？
*   有人可以给出一个代码示例，说明在 ViewModel 和 Model FieldA DependencyProperties 之间创建传递绑定的正确方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:10:29.620

我自己也在为这个问题苦苦挣扎，我想在 MVVM 方面这是一个非常常见的问题。我的回答是避免污染域，`DependencyObject`或者`INotifyPropertyChanged`因为它在某种程度上否定了使用 ViewModel 的有效性。

ViewModel 的目标是以与特定视图相关的方式公开模型。当虚拟机本质上需要公开整个域对象时，它会变得混乱。我将这些称为“编辑器”视图模型。这些是从域对象传递属性的最诱人的方法。在这些情况下，我为 VM 提供对域对象（组合）的引用，并通过 getter 和 setter。如果 UI 需要刷新或显示验证错误，ViewModel 会采用`INotifyPropertyChanged`而`IDataErrorInfo`不是向 UI 发出信号。`DependencyProperty`如果域引发验证错误，则 VM 会捕获它并将其准备到视图的数据错误信息详细信息中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T02:52:12.197

我同意史蒂夫的观点，你应该避免在你的模型/域类中使用`DependencyObject`和`DependencyProperty`，并且视图模型类应该采用`INotifyPropertyChanged`和`IDataErrorInfo`用于绑定目的。

我会在您的视图模型类中添加这一点，我会避免使用`DependencyProperty`您需要在 xaml 逻辑中使用的属性，例如`DataTrigger`s。

为了处理在模型层类中触发的更改，我还将引用视图模型类中的模型/域对象，并通过 getter 和 setter 传递给模型/域类，就像史蒂夫提到的那样。我要补充一点，模型/域类需要引发视图模型类需要订阅的事件，以便`OnPropertyChanged()`可以根据业务中发生的更改在视图模型类中调用一个或多个属性逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T06:25:22.510

首先，我不建议对视图模型或模型使用依赖属性 (DP)。DP 是在设计时考虑了 UI 概念的属性，例如优先规则、`DataContext`支持、默认值等。您不需要在视图模型中使用这些概念，因此您应该使用这些概念`INotifyPropertyChanged`。

拥有一个只是传递到模型层的视图模型根本**没有任何价值**。所以不要这样做！你不应该仅仅因为你认为你应该在你的代码中添加层、结构或概念。简单是您应该始终争取的东西。

因此，如果您可以实现模型层，`INotifyPropertyChanged`只需将其绑定到您的视图。

但是......在某些情况下，您可能无法`INotifyPropertyChanged`在您的模型中实现。例如，它可能是从 Web 服务生成的。在这种情况下，您将需要一个执行传递功能的视图模型，但还需要通过`INotifyPropertyChanged`.

# php - 使用 POST 变量而不专门调用它们

> ID：13573699
> 
> 赞同：2
> 
> 时间：2012-11-26T21:47:21.513
> 
> 标签：php

所有，我有一个包含一些文本输入、复选框、选择框和文本区域的表单。我想使用 PHP 使用提交按钮将表单提交到页面进行处理。

那部分很好，但我想做的基本上是将结果放入一个数组中，这样我就可以做一个 foreach 循环来处理结果。

基本上我正在尝试创建一个动态表单以提交到我的后端处理脚本，并且不想在 post 值中硬编码，如下所示：

```
$var1 = $_POST['var1'];
echo $var1;
$var2 = $_POST['var2'];
echo $var2; 
```

有谁知道如何去做这样的事情或给出任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:53:03.843

如果您的 POST 中除了这些生成的元素之外没有其他数据，请执行

```
foreach( $_POST as $key => $val ) {
    // do your job 
} 
```

并处理你所拥有的。如果您想将生成的条目与预定义的条目混合，您可能希望将这些生成的条目放在嵌套数组中：

```
<input ... name="generated[fieldname]" /> 
```

然后你迭代

```
foreach( $_POST['generated'] as $key => $val ) {
  // do your job
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:53:31.813

只需使用数组表示法：

```
<input name="vars[]" value="" /> 
```

然后你会有这样的东西`$_POST`：

```
Array ('vars' => Array(
     0 => 'val1'
     1 => 'val2'
   )
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T21:52:16.113

```
foreach ($_POST as $param_name => $param_val) {
    echo "Param: $param_name; Value: $param_val";
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-26T22:07:14.553

实际上，$_POST 变量是一个数组。您只需要使用简单的 foreach 循环来提取数组值。就是这样。

我希望这个例子对你有所帮助。

```
foreach($_POST as $field_name => $val)
{   
  $asig = "\$".$field_name."='".addslashes($val)."';"; 
  eval($asig); 
} 
```

运行此脚本后，所有 POST 值都将放入一个与字段名称同名的变量中。

# javascript - 禁用锚标记

> ID：13573700
> 
> 赞同：1
> 
> 时间：2012-11-26T21:47:25.877
> 
> 标签：javascript, jquery

我将如何在更改 url 的页面上放置链接，但在不使用哈希状态的情况下不更改页面？

我想放置更改 url 的链接并滚动到页面的相应部分。我不想使用哈希，因为它们只是跳转到该部分而不是滚动，而且我认为哈希在 url 中看起来不太好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T21:49:14.830

看看[HTML5 推送状态](http://spoiledmilk.com/blog/html5-changing-the-browser-url-without-refreshing-page/)

据我所知，没有其他办法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T21:49:19.730

你试过 jQuery ScrollTo 插件吗？[http://archive.plugins.jquery.com/project/ScrollTo](http://archive.plugins.jquery.com/project/ScrollTo)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T21:52:09.600

浏览器现在具有安全功能，可确保位置栏中显示的 URL 与实际显示的内容相匹配。如果不同时更改页面，则无法更改位置。

但是，您可以在任意位置滚动页面，而无需更改 URL。要滚动到特定元素，请获取其位置并使用`.animate()`：

```
$('body').animate({scrollTop: $('#element').position().top}); 
```

`.on('click',...)`​将此与用于取消 URL 更改的处理程序结合起来`e.preventDefault()`，您就可以开始了。

```
$('a[href^=#]').on('click', function(e) { // apply to all hash links
    var el = $(this).attr('href');        // get the href
    e.preventDefault();                   // cancel default click action
    $('body').animate({
        scrollTop: $(el).position().top   // scroll to the href ID instead
    });
});​ 
```

[http://jsfiddle.net/mblase75/WFKUE/](http://jsfiddle.net/mblase75/WFKUE/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T21:49:26.717

HTML5 浏览器历史（又名 PushState）是现代方法

[https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)

它在浏览器中得到相当广泛的支持

[http://caniuse.com/history](http://caniuse.com/history)

# php - Preg_replace 期间的正则表达式

> ID：13573702
> 
> 赞同：1
> 
> 时间：2012-11-26T21:47:39.947
> 
> 标签：php, preg-replace, str-replace

我已经环顾了一段时间，我花了很多时间反复试验，但仍然无法把事情做好：/

我想要做的是采用像 url 这样的字符串：

`www.something.com/something.html?user=1&page=1`

并从`"&page=1"`字符串中删除。这个字符串后面可能有另一个`&variable`，`"&page=*"`所以我希望它只删除`"&page=*"`.

我一直在尝试的是： `$url = preg_replace("/&page=\.{*}&?/","",$url);`

换句话说：`"&page=" + anynumber + till end of number or next "&"`

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T21:53:13.197

```
preg_replace('/&page=[^&#]*/', '', $url) 
```

这匹配`&page=`后跟 0 个或多个（`*`即位）不是`&`或的字符`#`。`[...]`代表一组字符；`[^...]`反转集合。

换句话说，它将匹配`&page=`直到下一个`&`或`#`（或字符串结尾）之后的所有内容。

# c# - 如何以编程方式添加 UpdatePanel 及其触发器？

> ID：13573703
> 
> 赞同：0
> 
> 时间：2012-11-26T21:47:40.917
> 
> 标签：c#, asp.net, ajax

我在 Page_Init 中添加了可变数量的更新面板。

我的母版页中已经有一个脚本管理器。

问题是当我尝试添加触发器时：

```
AsyncPostBackTrigger trig2 = new AsyncPostBackTrigger();

trig2.ControlID = ddl22.UniqueID;

trig2.EventName = "SelectedIndexChanged";

up2.Triggers.Add(trig2); 
```

其中 ddl22 是 DropDownList，该事件似乎永远不会触发 UpdatePanel。

在 UpdatePanel 中，我有另一个 DropDownList ，当触发发生时我想要更改的数据。

有趣的是，在母版页中我有一个计时器。这个计时器应该只触发主控中的 UpdatePanel，但它似乎触发了我所有的更新面板。但是，即使它触发了子页面中的更新面板，第二个 DropDownList 也不会更改其数据。

数据被数据绑定到 page_init 中 UpdatePanel 中的 DropDownList。它绑定到一个 objectdatasource，该 objectdatasource 使用第一个 DropDownList 中的选定项作为参数来确定它应该绑定哪些数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T05:11:19.803

你`AutoPostBack="True"`为你的下拉列表设置了吗？我怀疑这是问题所在。

还将您的更新面板模式设置为有条件的`UpdateMode="Conditional"`，这样我就不会影响其他更新面板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T05:06:26.083

试试这个，

在源代码中，

```
 <asp:UpdatePanel ID="up2" runat="server" UpdateMode="Conditional">
  <ContentTemplate>
  <asp:DropDownList ID="ddl1" runat="server" AutoPostBack="True" OnSelectedIndexChanged="ddl1_SelectedIndexChanged"></asp:DropDownList>    
  <asp:DropDownList ID="ddl2" runat="server" AutoPostBack="True" OnSelectedIndexChanged="ddl2_SelectedIndexChanged"></asp:DropDownList>
  </ContentTemplate>
  <Triggers>
      <asp:PostBackTrigger ControlID="ddl2" />
  </Triggers>
  </asp:UpdatePanel> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T05:15:52.583

您可以手动调用 UpdatePanel 进行刷新，而无需在 postBack 事件上指定触发器。首先，`set the UpdateMode property to 'Conditional'`然后您可以从后面的代码中调用更新面板上的更新，例如

```
MyUpdatePanel.Update(); 
```

# asp.net-mvc - 在服务器上部署的 Asp.Net Mvc 4 网站抛出错误“无法加载类型'System.Web.WebPages.DisplayModes'”

> ID：13573707
> 
> 赞同：1
> 
> 时间：2012-11-26T21:47:50.580
> 
> 标签：asp.net-mvc, visual-studio, asp.net-mvc-4, web-deployment

从过去的 6 个小时开始，我一直在努力解决这个问题，但仍然无法解决这个问题。当我在共享主机的服务器上部署一个 Asp.Net Mvc 4 项目时，我遇到了这个异常。我得到了这个问题。

我用谷歌搜索发现这可能是与 System.Web.Mvc 和 System.Web.WebPages 的版本差异有关的问题。我验证了所有 dll 的版本号，尝试使用 nuget 重新安装，但仍然收到相同的消息。

认为这可能只是与我的项目有关的问题，我创建了一个新的 Asp.Net Mvc 4 Internet 应用程序并将其部署在服务器上，繁荣......得到了同样的信息。

我花了几个小时卸载所有旧版本的 Asp.Mvc，修复 Visual Studio 2010，使用 Web Platform Installer 再次安装 Mvc 4，但没有任何帮助，仍然收到相同的消息。

有人可以帮忙吗，我只是卡住了。

这是错误消息

```
Could not load type 'System.Web.WebPages.DisplayModes' from assembly 'System.Web.WebPages, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.

Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.TypeLoadException: Could not load type 'System.Web.WebPages.DisplayModes' from assembly 'System.Web.WebPages, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace: 

[TypeLoadException: Could not load type 'System.Web.WebPages.DisplayModes' from assembly 'System.Web.WebPages, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.]
   System.Web.Mvc.VirtualPathProviderViewEngine.GetPath(ControllerContext controllerContext, String[] locations, String[] areaLocations, String locationsPropertyName, String name, String controllerName, String cacheKeyPrefix, Boolean useCache, String[]& searchedLocations) +0
   System.Web.Mvc.VirtualPathProviderViewEngine.FindView(ControllerContext controllerContext, String viewName, String masterName, Boolean useCache) +198
   System.Web.Mvc.<>c__DisplayClassc.<FindView>b__a(IViewEngine e) +43
   System.Web.Mvc.ViewEngineCollection.Find(Func`2 lookup, Boolean trackSearchedPaths) +177
   System.Web.Mvc.ViewEngineCollection.Find(Func`2 cacheLocator, Func`2 locator) +23
   System.Web.Mvc.ViewResult.FindView(ControllerContext context) +144
   System.Web.Mvc.ViewResultBase.ExecuteResult(ControllerContext context) +151
   System.Web.Mvc.<>c__DisplayClass1c.<InvokeActionResultWithFilters>b__19() +33
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation) +846308
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult) +265
   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +846608
   System.Web.Mvc.Controller.ExecuteCore() +159
   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +335
   System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__5() +62
   System.Web.Mvc.Async.<>c__DisplayClass1.<MakeVoidDelegate>b__0() +20
   System.Web.Mvc.<>c__DisplayClasse.<EndProcessRequest>b__d() +54
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +469
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +375

   Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

这是我用谷歌搜索并找到解决问题的链接：

[http://tkntips.blogspot.in/2012/05/could-not-load-type-systemwebwebpagesdi.html](http://tkntips.blogspot.in/2012/05/could-not-load-type-systemwebwebpagesdi.html)

解决方案不是那么清楚。没有为我工作。

# ruby - Git 使用脚本（红宝石？）拉多个本地存储库

> ID：13573708
> 
> 赞同：1
> 
> 时间：2012-11-26T21:47:56.820
> 
> 标签：ruby, macos, git, github, repository

我从 github 克隆了大约 30 个 git 存储库，用于 web/ruby/javascript 开发。是否可以使用脚本批量更新所有这些？

我的一切都井井有条（文件夹结构）：

```
- Workspace
  - Android
  - Chrome
  - GitClones
    - Bootstrap
    ~ etc...30 some repositories
  - iPhone
  - osx
  - WebDev 
```

我有一个 ruby​​ 脚本来克隆存储库`octokit`，但是对于如何在下的所有存储库中执行 git pull（覆盖/重新定位本地）有什么建议`GitClones`吗？

通常，每当我要使用该存储库时，我都会拉一下，但我要去一个只有有时才可以使用互联网连接的地方。所以我想在有互联网的时候更新我能做的一切。

谢谢！（运行 osx 10.8.2）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T22:24:33.387

如果您必须在 Ruby 中执行此操作，这里有一个快速而肮脏的脚本：

```
#!/usr/bin/env ruby

Dir.entries('./').select do |entry|
  next if %w{. .. ,,}.include? entry
  if File.directory? File.join('./', entry)
    cmd = "cd #{entry} && git pull"
    `#{cmd}`
  end
end 
```

不要忘记 chmod +x 你复制到的文件并确保它在你的 GitClones 目录中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-26T22:12:30.723

当然可以，但是当 shell 足够时为什么要使用 ruby​​ 呢？

```
function update_all() {
  for dir in GitClones/*; do 
    cd "$dir" && git pull
  done
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T22:59:46.277

根据口味更改 glob 的开头。这做了两件有用的事情：

1.  只有 git pull 包含 .git subdir
2.  它跳过点 (.) 目录，因为没有人拥有以点开头的 git repos。

享受

```
# Assumes run from Workspace
Dir['GitClones/[^.]*'].select {|e| File.directory? e }.each do |e|
  Dir.chdir(e) { `git pull` } if File.exist? File.join(e, '.git')
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-28T12:28:54.953

修改以提供更好的输出并且与操作系统无关。这个清理本地更改，并更新代码。

```
#!/usr/bin/env ruby

require 'pp'

# no stdout buffering
STDOUT.sync = true

# checks for windows/unix for chaining commands
OS_COMMAND_CHAIN = RUBY_PLATFORM =~ /mswin|mingw|cygwin/ ? "&" : ";"

Dir.entries('.').select do |entry|
  next if %w{. .. ,,}.include? entry
  if File.directory? File.join('.', entry)
    if File.directory? File.join('.', entry, '.git')
      full_path = "#{Dir.pwd}/#{entry}"
      git_dir = "--git-dir=#{full_path}/.git --work-tree=#{full_path}"
      puts "\nUPDATING '#{full_path}' \n\n"
      puts `git #{git_dir} clean -f #{OS_COMMAND_CHAIN} git #{git_dir} checkout . #{OS_COMMAND_CHAIN} git #{git_dir} pull` 
    end
  end
end 
```

# windows - CGI DLL（Delphi内置）物理路径

> ID：13573712
> 
> 赞同：3
> 
> 时间：2012-11-26T21:48:04.657
> 
> 标签：windows, delphi, winapi

我在 Windows 2008 服务器上部署了一个使用 Delphi 2007 构建的 CGI DLL。在内部我需要使用当前的 DLL 路径。

通常我可以使用`GetModuleFileName`or `GetModuleName`，但在服务器上它们都返回：

```
\\?\c:\my\correct\path 
```

为什么是前 4 个字符？它看起来像一个网络路径？有什么办法可以排除前 4 个字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:57:02.263

相关[文档](http://msdn.microsoft.com/en-gb/library/windows/desktop/aa365247.aspx)是这样的：

> **最大路径长度限制**
> 
> 在 Windows API（以下段落中讨论的一些例外情况）中，路径的最大长度为`MAX_PATH`，定义为 260 个字符。本地路径按以下顺序构造：驱动器号、冒号、反斜杠、由反斜杠分隔的名称组件和终止空字符。例如，驱动器 D 上的最大路径是“D:\some 256-character path string”，其中“”表示当前系统代码页的不可见终止空字符。（字符 < > 在此处用于视觉清晰，不能作为有效路径字符串的一部分。）
> 
> **注意** Windows API 中的文件 I/O 函数将“/”转换为“\”作为将名称转换为 NT 样式名称的一部分，除非使用“\\?\”前缀，如以下部分所述。
> 
> Windows API 有许多函数也有 Unicode 版本，以允许最大总路径长度为 32,767 个字符的扩展长度路径。这种类型的路径由由反斜杠分隔的组件组成，每个组件都达到 GetVolumeInformation 函数的 lpMaximumComponentLength 参数中返回的值（该值通常为 255 个字符）。要指定扩展长度的路径，请使用“\\?\”前缀。例如，“\\?\D:\非常长的路径”。
> 
> **注意** 最大路径 32,767 个字符是近似值，因为系统在运行时可能会将“\\?\”前缀扩展为更长的字符串，并且此扩展适用于总长度。
> 
> “\\?\”前缀也可用于根据通用命名约定 (UNC) 构建的路径。要使用 UNC 指定此类路径，请使用“\\?\UNC\”前缀。例如，“\\?\UNC\server\share”，其中“server”是计算机的名称，“share”是共享文件夹的名称。这些前缀不用作路径本身的一部分。它们表明路径应该以最少的修改传递给系统，这意味着您不能使用正斜杠来表示路径分隔符，或者使用句点来表示当前目录，或者使用双点来表示父目录。因为您不能将“\\?\”前缀与相对路径一起使用，所以相对路径始终限于`MAX_PATH`字符总数。

只要您调用的是 Unicode 版本的 Windows API 函数，就不需要去掉`"\\?\"`前缀。因为你得到的路径是有效的路径。

正如我们在评论中发现的那样，您正在调用 API 函数的 ANSI 版本。当你这样做时，`"\\?\"`前缀无效。所以，坚持使用 Unicode API 函数，一切都很好！

# javascript - textarea.val() 值改变但不显示在页面上

> ID：13573722
> 
> 赞同：1
> 
> 时间：2012-11-26T21:48:43.053
> 
> 标签：javascript, jquery, html

我有一个像这样的文本区域，

```
<textarea id="txtaFilter" cols="45" rows="5"></textarea> 
```

和以下脚本，

```
$(document).ready(function () {
    $(".selector").bind('change', function () {
        var value = $(this).val();
        $("#txtaFilter").val($("#txtaFilter").val() + value);
        $(this).children('option:eq(0)').prop('selected', true);
    });
}); 
```

其中“.selector”是应用于两个下拉列表的类。

当我在下拉列表中选择一个值时，它似乎什么也没做，但是在查看 chrome 中的调试器后，它正在更改该值而不是显示它。

有人知道为什么是这样吗？.val() 属性有什么特别之处吗？

* * *

## 问题方案：

当我删除 $(this).siblings("#txtaFilter") 时，我忘记了页面上有多个“#txtaFilter”，所以它访问的是隐藏的而不是可见的。对此感到抱歉，我想我在这个问题上也错了：/

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T21:56:21.200

您可以使用`val`方法：

```
$("#txtaFilter").val(function(i, oldVal){
   return oldVal + value
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T21:54:25.443

用于[`.val()`](http://api.jquery.com/val/)获取文本区域的文本。

```
$(document).ready(function () {
    $(".selector").bind('change', function () {
        var value = $(this).val();
        var txtaFilter = $("#txtaFilter");
        txtaFilter.val(txtaFilter.val()+value);
        $(this).children('option:eq(0)').attr('selected', true);
    });
}); 
```

# windows-8 - 选择 Windows 运行时组件与可移植代码库

> ID：13573727
> 
> 赞同：6
> 
> 时间：2012-11-26T21:48:54.317
> 
> 标签：windows-8, windows-runtime, windows-phone-8, portable-class-library

在 Windows Phone 8 和 Windows 8 之间共享代码时，开发人员的两个核心选项是 1) Windows 运行时组件和 2) 门户类库。

[Windows 运行时组件](http://msdn.microsoft.com/en-us/library/windows/apps/hh441572.aspx)使用 WinRT，并且可以投影到所有受支持的语言中。在不同平台上使用时，它们需要单独项目（二进制文件）中的链接文件。但是，它们共享 90% 的可用 WinRT API。

[可移植类库](http://msdn.microsoft.com/en-us/library/gg597391.aspx)是 BCL 的一个子集（有时是重要子集），具有跨平台的二进制兼容性。它们可用于 WinRT 应用程序，也可用于 Silverlight、Xbox 等其他项目类型。

**当开发人员选择“共享策略”时，哪种项目类型是在 Windows Phone 8 和 Windows 8 之间共享代码的最佳技术？**谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T14:03:52.257

这取决于您需要什么形式的共享：

**1) 如果您有一个通用的 C++ 业务逻辑层**，您可以使用 Windows 运行时 (WinRT) 组件将其公开给 Windows Phone 和 Windows Store 应用程序（这是 Windows Phone 的唯一用例，因为您无法编写 WP8 应用程序使用 JavaScript 或使用 .NET 来创作 WinRT 组件）。

但是，您必须构建两个单独的 WinRT 组件，一个用于电话，一个用于 Windows 应用商店。应该可以使用预处理器指令 ( `#if`) 共享 WinRT 互操作层的 C++/CX 代码以标记平台特定代码。

**2) C#/VB 中的业务逻辑仅依赖于可移植类库中可用的 .NET API。**然后，您可以使用可移植类库 (PCL) 来包含该逻辑。基本上，如果您*可以*将库构建到 PCL DLL 中，那么这应该可以工作。然后，您可以在 Windows Phone 和 Windows Store 应用程序中以二进制形式引用此 PCL。

然而，正如 Martin 所说，在使用 3rd 方库时需要小心，因为这些库也需要为 PCL 构建。一些第三方库已经以 PCL 形式提供（例如 JSON.NET）。

**3) 您希望共享具有 PCL 不支持的平台 API 依赖项（或 3rd 方库依赖项）的代码。**然后您需要创建单独的 DLL 库，每个平台一个。您可以使用链接的 C#/VB 源文件来避免代码重复，并使用构建标志（`#if`再次）来允许在目标平台之间进行小的代码更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T08:28:52.807

如果要在 Windows Phone 8 和 Windows 8 之间共享代码，则不能使用 Windows 运行时组件，因为 Windows 8 使用的组件不同，Windows Phone 8 使用的组件也不同，它们不可互换。
我会为一些简单的通用库选择可移植类库，或者通过链接和#if WP8 编译指令进行代码共享 - 这只是工作并且比可移植库更强大。
还要记住，大多数外部库（如 MVVM Light）不能在 Portable Libs 中引用，因此如果要使用它们，则必须通过文件引用使用代码共享。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T18:07:29.460

有关如何有效使用可移植类库在平台之间共享代码的一些指导，请参阅此博客文章：[如何使可移植类库为您工作](http://blogs.msdn.com/b/dsplaisted/archive/2012/08/27/how-to-make-portable-class-libraries-work-for-you.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-24T15:25:27.853

> 此问题不再与在支持共享项目的 Visual Studio 2013 Update 2 中引入 Windows Phone 8.1 通用应用程序相关。

等一下，就我而言，即使在 Visual Studio 2013 Update 4 中，这个问题仍然很重要，因为那里有两种类型的项目：

**类库（通用应用程序的便携式）- PCL**

和

**Windows 运行时组件（通用应用程序的便携版）-WinMD**

我只能看到它们之间的一大区别：WinMD 仅使用 WinRT，而 PCL 也可以与 .Net 和 Silverlight 一起使用。但我也想知道更多关于哪个以及何时更好地选择。

# asp.net-mvc - 多个领域的 OData 搜索

> ID：13573728
> 
> 赞同：1
> 
> 时间：2012-11-26T21:49:02.123
> 
> 标签：asp.net-mvc, odata

我有一个像这样的 OData 搜索：

```
$.getJSON("/api/job/GetJobs?$orderby=JobDate desc&$top=10&$skip=" + skip + "" 
```

有没有一种方法可以搜索多个字段，即我想包含一个过滤器字段或为每个字段发送多个过滤器。

如果我只能发送一个过滤器，我是否应该创建一个 NotMapped 属性，它是我想要搜索和过滤的所有属性的字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T01:18:43.623

是的你可以。

**搜索具有多个条件的字段**：

```
http://yoiur_domain.com/api/job/GetJobs?$filter=(field1 eq 'something' OR field1 eq 'another thing') 
```

**搜索多个字段**：

```
http://yoiur_domain.com/api/job/GetJobs?$filter=(field1 eq 'something' OR field2 eq 'another thing') 
```

# javascript - 使用 video.js 的完整视频背景

> ID：13573730
> 
> 赞同：6
> 
> 时间：2012-11-26T21:49:08.947
> 
> 标签：javascript, jquery, html, css, ajax

我正在尝试制作一个全屏视频背景，即使在调整窗口大小时也始终显示全尺寸。

这是网站： [http ://webkunst.comeze.com/test/](http://webkunst.comeze.com/test/)

这是我遇到的问题：

在宽屏上显示如下： [http ://webkunst.comeze.com/test/wide.png](http://webkunst.comeze.com/test/wide.png)

在垂直屏幕上显示如下： [http ://webkunst.comeze.com/test/vertical.png](http://webkunst.comeze.com/test/vertical.png)

如您所见，它总是在视频中添加一些黑条，而不是将视频大小调整为全屏。

这是我的标记：

```
 <div id="full-background">
                <video class="video-js vjs-fullscreen"  autoplay preload="auto"  poster="http://video-js.zencoder.com/oceans-clip.png" data-setup="{}">
                    <source src="video/1.mp4" type='video/mp4' />
                </video>
            </div> 
```

用这个CSS：

```
#full-background {
  z-index: -999;
  min-height: 100%;
  min-width: 1024px;
  width: 100%;
  height: 100%;
  position: fixed;
  top: 0;
  left: 0;
}

.video-js.vjs-fullscreen {
  position: fixed;
  overflow: hidden;
  z-index: 1000;
  left: 0;
  top: 0;
  bottom: 0;
  right: 0;
  width: 100% !important;
  height: 100% !important;
  _position: absolute;
  /* IE6 Full-window (underscore hack) */

} 
```

我正在使用 video.js 插件：http: [//videojs.com/](http://videojs.com/)

任何想法以及如何使视频全尺寸而不在侧面或顶部/底部显示黑条？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T17:57:18.410

你试过[BigVideo.JS](http://dfcb.github.com/BigVideo.js/)吗？它使用 Video.JS 作为核心并在其之上构建。它只需要jQuery。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:06:44.553

似乎您只能在此处指定默认视频宽度和高度：

[http://videojs.com/tag-builder/](http://videojs.com/tag-builder/)

但是**您不能**拉伸视频本身以填充不同的屏幕分辨率，它始终保持纵横比。

但是您可以指定颜色而不是黑条：

```
.vjs-default-skin .vjs-play-progress { background: #900; } 
```

或皮肤：

```
<video class="video-js my-custom-skin" ...> 
```

来源：[https ://github.com/zencoder/video-js/blob/master/docs/skins.md](https://github.com/zencoder/video-js/blob/master/docs/skins.md)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T23:37:44.720

You could use media queries to apply different CSS Classes depending upon the aspect ratio?

I'm using a widescreen laptop and can get the video to be full screen by using the following.

```
.video-js .vjs-tech {
width: 100% !important;
}

video {
    width:100%;
} 
```

For a portrait screen I can get it to fill the height by using the following.

```
.video-js .vjs-tech {
height:100% !important
}

video {
width:auto !important;
} 
```

So you could use the media queries like `@media screen and (device-aspect-ratio: 16/9)` to apply the different dimensions.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-08T11:20:30.017

使用对象拟合。不要忘记为父 div 设置高度。

```
 .video-js {
    width: 100%;
    height: 100%;
  }
  .video-js .vjs-tech {
    object-fit: cover;
  } 
```

# c# - ReactiveExtensions Observable FromAsync 调用两次函数

> ID：13573732
> 
> 赞同：4
> 
> 时间：2012-11-26T21:49:14.130
> 
> 标签：c#, task, system.reactive

好的，试图理解 Rx，有点迷失在这里。

FromAsyncPattern 现在已被弃用，所以我从[这里](http://blogs.msdn.com/b/rxteam/archive/2012/03/12/reactive-extensions-v2-0-beta-available-now.aspx)（使用 Rx 点亮任务部分）举了一个例子，它起作用了，我只是做了一些更改，不使用 await 只是等待可观察和订阅.....

我不明白的是为什么函数 SumSquareRoots 被称为两次？

```
 var res = Observable.FromAsync(ct => SumSquareRoots(x, ct))
                                      .Timeout(TimeSpan.FromSeconds(5));

            res.Subscribe(y => Console.WriteLine(y));

            res.Wait();

class Program
{
    static void Main(string[] args)
    {
        Samples();
    }

    static void Samples()
    {
        var x = 100000000;

        try
        {
            var res = Observable.FromAsync(ct => SumSquareRoots(x, ct))
                                      .Timeout(TimeSpan.FromSeconds(5));

            res.Subscribe(y => Console.WriteLine(y));

            res.Wait();
        }
        catch (TimeoutException)
        {
            Console.WriteLine("Timed out :-(");
        }
    }

    static Task<double> SumSquareRoots(long count, CancellationToken ct)
    {
        return Task.Run(() =>
        {
            var res = 0.0;
            Console.WriteLine("Why I'm called twice");
            for (long i = 0; i < count; i++)
            {
                res += Math.Sqrt(i);

                if (i % 10000 == 0 && ct.IsCancellationRequested)
                {
                    Console.WriteLine("Noticed cancellation!");
                    ct.ThrowIfCancellationRequested();
                }
            }

            return res;
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-26T22:30:30.177

这是两次调用 SumSquareRoots 的原因是因为您订阅了两次：

```
// Subscribes to res
res.Subscribe(y => Console.WriteLine(y));

// Also Subscribes to res, since it *must* produce a result, even
// if that result is then discarded (i.e. Wait doesn't return IObservable)
res.Wait(); 
```

`Subscribe`是`foreach`Rx 的 - 就像如果你两次，你最终可能会做 2 倍的工作，多个`foreach`s意味着工作的倍数。要撤消此操作，您可以使用不会丢弃结果的阻塞调用：`IEnumerable``Subscribe`

```
Console.WriteLine(res.First()); 
```

或者，您可以使用`Publish`“冻结”结果并将其回放给 > 1 个订阅者（有点像您`ToArray`在 LINQ 中使用的方式）：

```
res = res.Publish();
res.Connect();

// Both subscriptions get the same result, SumSquareRoots is only called once
res.Subscribe(Console.WriteLine);
res.Wait(); 
```

您可以遵循的一般规则是，任何*不*返回`IObservable<T>`或`Task<T>`将导致 Subscription(*) 的Rx 方法

* *- 技术上不正确。但是如果你这样想，你的大脑会感觉更好。*

# magento - 从 Magento 模板中删除 h1 标签

> ID：13573741
> 
> 赞同：2
> 
> 时间：2012-11-26T21:49:28.277
> 
> 标签：magento

我已经用图片替换了我网站上的标题标签，但模板仍然在 h1 标签中显示标题文本。我需要去哪里从所有网页中删除此标签？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:14:51.547

转到您的管理员，然后`System -> Configuration`。

在左侧栏中，转到`Advanced -> Developer`

现在在左上角选择您正在处理的商店视图。

在 下`Debug`，打开`Template Path Hints`。

现在刷新站点以查看您需要编辑的确切文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:27:17.047

尝试清除缓存（如果有）

您可能没有从正确的模板中删除它，因此请尝试在管理员中打开模板提示

请参阅[如何打开模板路径提示](https://support.sweettoothrewards.com/entries/21255937-how-do-i-turn-on-template-path-hints)

# android - Android 可点击的自定义操作提供程序

> ID：13573742
> 
> 赞同：2
> 
> 时间：2012-11-26T21:49:32.943
> 
> 标签：android, actionbarsherlock

我正在使用 ActionBarSherlock 并创建一个自定义 ActionProvider。单击自定义操作提供程序时，我设法使最顶部的 LinearLayout 可单击并在其上设置自定义选择器。

问题在于，与带有图标的简单菜单项相比，自定义操作提供程序不使用选择器从上到下完全突出显示操作栏。顶部和底部的几个像素没有被突出显示。

![在此处输入图像描述](../Images/2cfa989f4aa74bba196c718ad9f63252.png)

可能有一个优雅的解决方案可以使整个自定义操作提供程序表现得像一个带有图标的简单可点击菜单项。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:30:53.777

我想到了。[我没有使用 Action Provider，而是将actionLayout](https://stackoverflow.com/questions/7980293/how-do-i-get-action-buttons-with-custom-layouts-to-be-styled-like-standard-actio)用于菜单项并使其可点击，如本文所示。

# php - 在实体中创建一个在调用它时进行延迟加载的方法

> ID：13573744
> 
> 赞同：3
> 
> 时间：2012-11-26T21:49:37.187
> 
> 标签：php, symfony, service, redis, lazy-loading

我使用作为服务加载的 Redis 将追随者注入实体。所以我有一个像 User 这样的实体，它有一个像 getFollowers 这样的方法。我不想将服务与实体混合，所以我制作了一个订阅 Doctrine 中的 postLoad 事件的侦听器。

问题是仅当我调用 getFollowers 方法时如何调用服务。

我的代码...

事件监听器：

```
public function postLoad(LifecycleEventArgs $eventArgs)
{

    $redisService = get the service loaded with DIC in constructor. 

    if ($eventArgs->getEntity() instanceof User) {
        $user = $eventArgs->getEntity();

        $user->setFollowers($redisService->getFollowers($user));

    }

} 
```

用户实体：

```
public function setFollowers(Array $followers) {
    $this->followers = $followers
} 
```

我的问题是，在每次加载类用户时，都会调用并加载 RedisService，我只想在 $user->getFollowers 上调用该服务

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T08:58:43.903

终于我得到了答案...

在我的监听器 postLoad 中，我为对象的属性分配了一个闭包：

```
$socialGraph = $this->socialGraph;
$getFollowers = function() use ($socialGraph, $user) {
    return $socialGraph->getFollowers($user->getId());
};

$user->setFans($getFollowers); 
```

现在，在我的对象中，可以将方法调用到属性中：

```
public function getFans()
{
    return call_user_func($this->fans);

 // another way
    return $this->fans->__invoke();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T21:59:41.587

将其包装为单例。类似的东西？

```
if (is_callable($this->_lazyLoad)) {
    $this->_lazyLoad = $this->_lazyLoad($this);
}

return $this->_lazyLoad; 
```

# php - 验证 unicode textarea 的最小长度

> ID：13573750
> 
> 赞同：2
> 
> 时间：2012-11-26T21:49:55.527
> 
> 标签：php, regex, unicode

我必须验证在表单的 textarea 字段中输入的俄语文本 (utf8)。字符数（无空格，无空行）应至少为 500。文本应使用正则表达式检查，并且可以有很多行。

我试过了：

```
#^.{500}.*# 
```

这确实以某种方式限制了。但是，这种模式似乎不尊重 unicode。260 个俄语字符足以通过检查。我无法弄清楚如何：

1.  检查 unicode 字符
2.  不计算空格
3.  不计算空行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:00:55.767

您需要该`u`标志来激活函数中的 UTF-8 感知`preg_`：

```
$regex = '#^.{500}.*#u'; 
```

如果你只是想看看它是否有 500 个字符长，你可以使用`mb_strlen:`

```
mb_internal_encoding("UTF-8");
$input_without_whitespace = preg_replace( '/[\x{0009}\x{000B}\x{000C}\x{0020}\x{00A0}\x{FEFF}\x{200C}\x{200D}]/u', "", $input );
if( mb_strlen( $input_without_whitespace ) > 500 ) {

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:09:04.923

好的，首先`.`默认匹配字节，因为输入字符串被解释为 ASCII。使用 Unicode 模式会改变（正如 Esailija 正确指出的那样），以便`.`正确匹配（Unicode）字符：

```
#^.{500}#u 
```

您不需要尾随`.*`，因为不需要匹配 PHP 中的完整字符串。请注意，如果前 500 个字符内有换行符，则这不匹配，因为`.`不匹配换行符（您也应该添加`s`修饰符来更改它）。

对于从计数中排除空格的第二个要求，您可以执行以下操作：

```
#^(?:\s*\S){500}#u 
```

该子组匹配尽可能多的空格字符，然后匹配一个非空格字符。并且必须一起匹配 500 次。因此，根据需要，每个非空白字符只能重复一次。

请注意，在所有情况下都不需要`s`修饰符，因为我们不使用`.`.

不过，有一个警告，[本文](http://www.regular-expressions.info/unicode.html)对此进行了解释。对于 Unicode，一些字符由多个代码点组成。例如，`à`可以写为一个字符`a`后跟另一个代码点（`U+0300`或```），它是一个组合标记。因此，虽然有两个不同的 Unicode 代码点，但它们仍然只有一个字符。但是，`.`匹配代码点（因为它不区分组合标记和“独立字符”）。我想这不会影响您的情况，因为西里尔文不使用重音符号。但这是值得注意的。如果它与您相关，您可能想要研究更高级的解决方案，如 Ωmega 的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T22:18:28.097

使用正则表达式模式

```
/(?>\s*+\P{M}\p{M}*){500}/u 
```

# symfony - 如何制作带有可选依赖项的 Symfony 2 捆绑包？

> ID：13573752
> 
> 赞同：1
> 
> 时间：2012-11-26T21:50:04.537
> 
> 标签：symfony, symfony-2.1, composer-php

假设你的包使用了一些 RESTful 服务并且可以与两个不同的 PHP HTTP 客户端一起工作： guzzle [/](https://github.com/guzzle/guzzle) guzzle以及[kriswallsmith/Buzz](https://github.com/kriswallsmith/Buzz)。因为它使用适配器和接口。

如何将此依赖项定义为可选？你会做这样的事情吗，例如在编译器传递中？

```
if(!is_file('/path/to/guzzle') && !is_file('/path/to/buzz')) {
    throw new \RuntimeException('You need to install guzzle or Buzz browser.');
} 
```

这是为捆绑包定义可选依赖项的正确方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:49:21.660

首先，您不会像上面那样做，主要是因为检查文件是否存在于某个路径将不起作用。如果用户将它们安装在其他地方（无论出于何种原因）并设法获得正确的命名空间怎么办？

我的第一个问题是您为什么希望用户选择。有什么区别吗？用户是否甚至能够决定使用哪个客户端。例如，当我使用资产时，我当然必须决定要使用哪些过滤器，因为它们对发生的事情有很大的影响（例如，如果我有 scss 文件，那么更少的过滤器是无用的）。

还有其他问题，例如用户必须自己管理依赖项。有时这是值得的，有时则不值得。

现在，如果您决定让用户选择，我会选择一个配置选项，用户可以通过字符串 guzzle 或字符串蜂鸣。也许有一个默认值。

在您的包中，您尝试根据此配置创建对象。你可以用 try catch 块包围它来捕捉丢失的依赖项或查看某个类是否可用。如前所述，您不会测试某个文件的存在，而是使用 php 函数测试某个类的存在`class_exists`。你的测试应该在你真正想要使用的一个或多个类上。

# opengl - 函数中引用的未解析外部符号 _gluLookAt@72

> ID：13573757
> 
> 赞同：1
> 
> 时间：2012-11-26T21:50:29.133
> 
> 标签：opengl, glu

我正在使用 glu 库制作程序，但是当我编译时出现此错误：

```
1>opengl_3.obj : error LNK2019: unresolved external symbol _gluLookAt@72 referenced in function "public: void __thiscall OpenGLContext::setupScene(void)" (?setupScene@OpenGLContext@@QAEXXZ) 
```

我包含了 GL/glu.h 并检查了 lib 和 dll 是否存在。（默认情况下）我正在使用 Visual Studio 2012。

知道这个错误来自哪里吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:52:48.040

你没有链接到glu。将 glu 添加到程序应链接的库中。更详细的描述可以在[这里](https://stackoverflow.com/questions/1114914/add-library-to-visual-studio-2008-c-project)找到。

# format - Access 2010 格式属性日期/时间长日期

> ID：13573761
> 
> 赞同：1
> 
> 时间：2012-11-26T21:50:45.940
> 
> 标签：format, ms-access-2010

当您将表格中日期/时间字段的格式属性设置为长日期时，切换到数据表视图，然后在日期/时间字段内单击，格式不会再像在旧版本的 Access 中那样消失。由于看不到原始数据，因此无法编辑日期。这是我所拥有的： 日期值：11/26/2012 长日期格式：2012 年 11 月 26 日星期一 字段接收焦点：2012 年 11 月 26 日星期一

当您在数据表视图中时，选择字段（单击内部），格式保持不变。在 Access 2003（在 Win XP 下）中，格式消失并显示值 11/26/2012。我今天刚刚验证了这一点。对于文本和数字字段，当字段获得焦点时，格式就会消失。

当您添加除午夜 (00:00) 以外的时间组件时，它会按预期工作： 日期值：2012 年 11 月 26 日 01:00 长日期格式：2012 年 11 月 26 日，星期一 字段接收焦点：2012 年 11 月 26 日01:00

这似乎是某种错误，除非我在这里遗漏了一些东西。可能与日期选择器控件有关（我打开和关闭它，行为没有变化）。

Access 2010 在 Win 7 下运行，Access 2003 在 Win XP 下运行。

任何人都可以确认这种行为和/或就如何处理这个问题提供更多指导吗？

谢谢，

# mysql - 添加总行

> ID：13573765
> 
> 赞同：1
> 
> 时间：2012-11-26T21:51:21.957
> 
> 标签：mysql

我有一个疑问；

```
select ProductID,  name, (unitPrice*quantity) As 'Stock Equity'
from tproduct
group by productID with rollup
; 
```

我希望这返回一组行，最后一个是总计的计算，而不是重复最后一个结果？

谁能告诉我为什么以及如何克服这个问题？

这是目前的查询结果；

```
ProductID    Name           Stock Equity
1            cannon 600 D   3360
2            cannon 550 D   1000
3            cannon 500 D   750
4            cannon 5D      5000
5            cannon 650 D   9000
6            Nikon D5100    1000
7            Nikon D3200    420
8            Nikon D7000    2700
9            Nikon D800     6030
10           Nikon D90      4770
null         Nikon D90      4770 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:55:20.937

您可以使用`UNION ALL`：

```
select ProductID,  name, (unitPrice*quantity) As 'Stock Equity'
from tproduct
union all
select 'total', 'total', sum(unitPrice*quantity)
from tproduct 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/56d73/4)

或者你可以使用这样的东西：

```
select case when ProductID is null then 'total' else ProductId end Productid,  
  case when ProductID is null then 'total' else name end name, 
  sum(unitPrice*quantity) As 'Stock Equity'
from tproduct
group by ProductID with rollup 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/56d73/6)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T21:53:00.643

```
select ProductID,  
       name, 
       (unitPrice*quantity) As 'Stock Equity',
       (select sum(unitPrice*quantity) from tproduct) As total
from tproduct
group by productID 
```

# java - Java 序列化和传输内部类

> ID：13573770
> 
> 赞同：1
> 
> 时间：2012-11-26T21:51:53.143
> 
> 标签：java, class, serializable

所以我有一个程序（这是一个简单的聊天客户端），我试图从服务器发送一个更新的客户端。为此，我使用了 serializable 关键字。现有的客户端可以从这种对象传输中加载和执行代码，这样就很好了。我的问题是该程序具有一些内部类。现在，我这样做的方式是创建一个包含更新所需的所有类文件的数组，然后遍历它并一次发送一个。我的问题是发送它们的顺序会影响执行。如果我先发送内部类，则代码可以工作，并且客户端会更新，但只要使用其中一个内部类，就会引发“ClassDefNotFound”异常。或者，如果我最后发送内部类，代码根本不起作用，

```
private static final Class[] clientUpdates = 
{EntryPanel.EnterSendListener.class, EntryPanel.ButtonSendListener.class,   
EntryPanel.class, MessagePanel.class, GUIClient.ClientThread.class, GUIClient.class,  
UpdateClientMessage.class}; 
```

是我的数组，其中任何有路径的东西都是内部类。最后一个元素是在发送新客户端时运行启动新客户端的方法的元素。

```
for(Class c : clientUpdates)
            {
                String name = c.getName();
                InputStream is = c.getClassLoader().getResourceAsStream(
                        name.replaceAll("\\.", "/") + ".class");

                ByteArrayOutputStream os = new ByteArrayOutputStream();
                byte[] buff = new byte[1024];
                int i = is.read(buff);

                while(i != -1)
                    {
                        os.write(buff, 0, i);
                        i = is.read(buff);
                    }

                byte[] bs = os.toByteArray();

                NewMessageType m = new NewMessageType(name, bs);
                queue.put(m);
            }
            queue.put(new UpdateClientMessage("localhost", port)); 
```

是我用来发送类定义的代码。NewMessageType 是一个类，旨在包含一个类的原始字节数据并将其传输，以便在另一端读取。把东西放在队列上只是简单地传输它们。

我将是第一个承认我在网络方面并不出色的人，并且可序列化不是我的强项。但是，我真的可以在这里得到一些帮助。这将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T12:03:56.437

顺便说一句，我解决了这个问题。问题与内部类无关，而是与循环依赖关系（即两个类都需要定义另一个类）有关。为了删除这些，我添加了一些抽象类，依赖项中的一个类引用，另一个继承。这样，我只要先发摘要，就没有问题。

# d3.js - 在 D3 中添加图表图例

> ID：13573771
> 
> 赞同：43
> 
> 时间：2012-11-26T21:51:54.910
> 
> 标签：d3.js, legend

我无法在我的 d3js 图表中添加图表图例。这是我目前的方法：

```
var legend = svg.append("g")
  .attr("class", "legend")
  .attr("x", w - 65)
  .attr("y", 25)
  .attr("height", 100)
  .attr("width", 100);

legend.append("rect")
  .attr("x", w - 65)
  .attr("y", 25)
  .attr("width", 10)
  .attr("height", 10)
  .style("fill", function(d) { return color_hash[dataset.indexOf(d)][1] });

legend.append("text")
  .attr("x", w - 65)
  .attr("y", 25)
  .text(function(d) { return color_hash[dataset.indexOf(d)][0] + ": " + d; }); 
```

然后我正在尝试为`.legend`课程设置样式：

```
.legend {
            padding: 5px;
            font: 10px sans-serif;
            background: yellow;
            box-shadow: 2px 2px 1px #888;
        } 
```

但我运气不太好。

是否有人熟悉向图表添加图例以提供最佳方式？我在网上找不到很多资源。

这是我的整个图表：http: [//jsbin.com/ewiwag/2/edit](http://jsbin.com/ewiwag/2/edit)

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-11-27T00:48:46.237

您需要将数据绑定到构成图例的节点（矩形和文本元素）。

目前，您在尝试设置矩形样式时会出现错误：

```
Uncaught TypeError: Cannot read property '1' of undefined 
```

原因：没有绑定数据

```
legend.append("rect")
      /*...*/
      .style("fill", function(d) { 
         // d <---- is undefined
         return color_hash[dataset.indexOf(d)][1] 
      }); 
```

请注意，D3 专注于数据转换并对选择进行操作。所以，先选择一组节点，然后绑定数据

```
legend.selectAll('rect')
      .data(dataset)
      .enter() 
```

使用 输入选择后`enter`，您可以添加节点并动态应用属性。请注意，为避免在其他矩形之上创建矩形，在设置`y`属性时传递`i`计数器并将其乘以整数。

```
 /*.....*/
      .append("rect")
      .attr("x", w - 65)
      .attr("y", function(d, i){ return i *  20;})
      .attr("width", 10)
      .attr("height", 10)
      .style("fill", function(d) { 
         var color = color_hash[dataset.indexOf(d)][1];
         return color;
      }); 
```

这是固定示例：http: [//jsbin.com/ubafur/3](http://jsbin.com/ubafur/3)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-27T00:53:33.330

好的，这是一种方法：http: [//jsbin.com/isuris/1/edit](http://jsbin.com/isuris/1/edit)

抱歉，必须进行太多更改才能解释这一切。看看你能不能弄明白。如果您有任何问题，请在评论中提问，我会修改答案。

```
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <script type="text/javascript" src="http://mbostock.github.com/d3/d3.js"></script>
    <style type="text/css">

      .axis path,
      .axis line {
        fill: none;
        stroke: black;
        shape-rendering: crispEdges;
      }

      .axis text {
        font-family: sans-serif;
        font-size: 11px;
      }

      .y1 {
        fill: white;
        stroke: orange;
        stroke-width: 1.5px;
      }

      .y2 {
        fill: white;
        stroke: red;
        stroke-width: 1.5px;
      }

      .y3 {
        fill: white;
        stroke: steelblue;
        stroke-width: 1.5px;
      }

      .line {
        fill: none;
        stroke-width: 1.5px;
      }

      div.tooltip {
              position: absolute;
              text-align: center;
              width: 50px;
              height: 10px;
              padding: 5px;
              font: 10px sans-serif;
              background: whiteSmoke;
              border: solid 1px #aaa;
              pointer-events: none;
              box-shadow: 2px 2px 1px #888;
            }

            .legend {
              padding: 5px;
              font: 10px sans-serif;
              background: yellow;
              box-shadow: 2px 2px 1px #888;
            }

            .title {
              font: 13px sans-serif;
            }

    </style>
  </head>
  <body>
    <script type="text/javascript">

    //Width and height
    var w = 500;
    var h = 300;
    var padding = 50;

    var now = d3.time.hour.utc(new Date);
    var dataset = [ [ ],[ ] ];
    dataset[0].push({x: d3.time.hour.utc.offset(now, -5), y: 0});
    dataset[0].push({x: d3.time.hour.utc.offset(now, -4), y: 0});
    dataset[0].push({x: d3.time.hour.utc.offset(now, -3), y: 2});
    dataset[0].push({x: d3.time.hour.utc.offset(now, -2), y: 0});
    dataset[0].push({x: d3.time.hour.utc.offset(now, -1), y: 0});
    dataset[0].push({x: now, y: 0});

    dataset[1].push({x: d3.time.hour.utc.offset(now, -5), y: 3});
    dataset[1].push({x: d3.time.hour.utc.offset(now, -4), y: 1});
    dataset[1].push({x: d3.time.hour.utc.offset(now, -3), y: 3});
    dataset[1].push({x: d3.time.hour.utc.offset(now, -2), y: 1});
    dataset[1].push({x: d3.time.hour.utc.offset(now, -1), y: 5});
    dataset[1].push({x: now, y: 1});

    var color_hash = {  0 : ["apple", "green"],
              1 : ["mango", "orange"],
              2 : ["cherry", "red"]
            }                      

    // Define axis ranges & scales        
    var yExtents = d3.extent(d3.merge(dataset), function (d) { return d.y; });
    var xExtents = d3.extent(d3.merge(dataset), function (d) { return d.x; });

  var xScale = d3.time.scale()
         .domain([xExtents[0], xExtents[1]])
         .range([padding, w - padding * 2]);

  var yScale = d3.scale.linear()
         .domain([0, yExtents[1]])
         .range([h - padding, padding]);

  // Create SVG element
  var svg = d3.select("body")
      .append("svg")
      .attr("width", w)
      .attr("height", h);

  // Define lines
  var line = d3.svg.line()
         .x(function(d) { return x(d.x); })
         .y(function(d) { return y(d.y1, d.y2, d.y3); });

  var pathContainers = svg.selectAll('g.line')
  .data(dataset);

  pathContainers.enter().append('g')
  .attr('class', 'line')
  .attr("style", function(d) {
    return "stroke: " + color_hash[dataset.indexOf(d)][1]; 
  });

  pathContainers.selectAll('path')
  .data(function (d) { return [d]; }) // continues the data from the pathContainer
  .enter().append('path')
    .attr('d', d3.svg.line()
      .x(function (d) { return xScale(d.x); })
      .y(function (d) { return yScale(d.y); })
    );

  // add circles
  pathContainers.selectAll('circle')
  .data(function (d) { return d; })
  .enter().append('circle')
  .attr('cx', function (d) { return xScale(d.x); })
  .attr('cy', function (d) { return yScale(d.y); })
  .attr('r', 3); 

    //Define X axis
  var xAxis = d3.svg.axis()
          .scale(xScale)
          .orient("bottom")
          .ticks(5);

  //Define Y axis
  var yAxis = d3.svg.axis()
          .scale(yScale)
          .orient("left")
          .ticks(5);

  //Add X axis
  svg.append("g")
  .attr("class", "axis")
  .attr("transform", "translate(0," + (h - padding) + ")")
  .call(xAxis);

  //Add Y axis
  svg.append("g")
  .attr("class", "axis")
  .attr("transform", "translate(" + padding + ",0)")
  .call(yAxis);

  // Add title    
  svg.append("svg:text")
       .attr("class", "title")
     .attr("x", 20)
     .attr("y", 20)
     .text("Fruit Sold Per Hour");

  // add legend   
  var legend = svg.append("g")
    .attr("class", "legend")
    .attr("x", w - 65)
    .attr("y", 25)
    .attr("height", 100)
    .attr("width", 100);

  legend.selectAll('g').data(dataset)
      .enter()
      .append('g')
      .each(function(d, i) {
        var g = d3.select(this);
        g.append("rect")
          .attr("x", w - 65)
          .attr("y", i*25)
          .attr("width", 10)
          .attr("height", 10)
          .style("fill", color_hash[String(i)][1]);

        g.append("text")
          .attr("x", w - 50)
          .attr("y", i * 25 + 8)
          .attr("height",30)
          .attr("width",100)
          .style("fill", color_hash[String(i)][1])
          .text(color_hash[String(i)][0]);

      });
    </script>
  </body>
</html> 
```

# windows-phone-7 - 为图像 WinPhone 创建动画

> ID：13573772
> 
> 赞同：0
> 
> 时间：2012-11-26T21:52:02.530
> 
> 标签：windows-phone-7, animation

如何在 WinPhone 中为 Image 创建动画？我创建了 UniformGrid，它有 20 张图像。如何执行以下操作：按下图像时 - 播放动画？

**我的项目控制：**

```
 <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Image x:Name="imgSquare"
                           Source="{Binding Path=Square.ImagePath, Converter={StaticResource PathWP}}"                          
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"
                           Width="110" 
                           Height="110" 
                           Stretch="Fill">

                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="MouseLeftButtonDown">
                                <commandbinding:MvxEventToCommand Command="{Binding Path=DataContext.ClickCommand, ElementName=ImageList}" CommandParameter="{Binding}"/>
                            </i:EventTrigger>                            
                        </i:Interaction.Triggers>

                        <i:Interaction.Behaviors>
                            <behaviors:ImageBehavior SelectedSquareModel="{Binding}"/>
                        </i:Interaction.Behaviors>

                    </Image>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl> 
```

**我打算使用 Behavior 播放动画：**

```
<i:Interaction.Behaviors>
     <behaviors:ImageBehavior SelectedSquareModel="{Binding}"/>
</i:Interaction.Behaviors> 
```

**请告诉我如何创建动画并将其连接到图像？**

*对不起我的英语不好*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T09:35:53.467

尝试搜索“ [windows phone 中的动画](http://www.bing.com/search?q=animations%20in%20windows%20phone&form=MOZSBR&pc=MOZI)”

您会发现很多很棒的教程，其中大多数使用 Blend 和 Behaviors，例如： http: [//www.jeffblankenburg.com/2010/10/29/31-days-of-windows-phone-day-29-animations/](http://www.jeffblankenburg.com/2010/10/29/31-days-of-windows-phone-day-29-animations/)

[对于在代码中完成的按钮按下动画，请参阅http://www.youtube.com/watch?v=5k8SG82e1Rc](http://www.youtube.com/watch?v=5k8SG82e1Rc)的中间几分钟- 尽管源代码是 ruby​​ ！

# jquery - Rails 自动加载 ajax 内容

> ID：13573774
> 
> 赞同：0
> 
> 时间：2012-11-26T21:52:07.667
> 
> 标签：jquery, ruby-on-rails, ajax

我有两个模型：

```
class Phase < ActiveRecord::Base
  default_scope order('created_at DESC')

  attr_accessible :created_at, :date_due, :name, :project_id, :status

  belongs_to :project
end

class Project < ActiveRecord::Base
  attr_accessible :created_at, :name, :status, :company_id

  has_many :phases, :dependent => :destroy
end 
```

在我的 project#show 视图中，我使用设置为 :remote => true 的链接一次将单个 phase#show 视图加载到 div 中。

**project#show 运行它来查找阶段：**

```
<% phases = Phase.where(:project_id => @project.id) %>
<% phases.each do |p| %>
  <div class="phase">
    <h3><%= link_to p.name, p, :class => "show_phase_link", :remote => true %></h3>
    <h5>Ends <%= p.date_due.strftime("%B %d, %Y") %></h5>
  </div>
<% end %> 
```

**然后一些jquery将数据加载到一个div中**

```
$('body').delegate("a.show_phase_link", "click", function() {
  $.ajax({
    url: $(this).attr("href"),
    cache: false,
    success: function(data){
      //display phase
      $("#phase_content").html(data);
    }
  });
}) 
```

问题是当你进入页面时，div 开始为空。我需要自动加载状态 ==“0”的第一个阶段，但似乎找不到如何开始处理这个阶段。

谢谢！！！

# html - 我可以在 HTML5 本地（离线）存储中存储超过 5 MB 吗？

> ID：13573775
> 
> 赞同：5
> 
> 时间：2012-11-26T21:52:08.750
> 
> 标签：html, storage, local-storage, offline

我可以在 HTML5 本地（离线）存储中存储超过 5 MB 吗？我参考了以下来源，

1.  [http://diveintohtml5.info/storage.html](http://diveintohtml5.info/storage.html)
2.  [http://htmlui.com/blog/2011-08-23-5-obscure-facts-about-html5-localstorage.html](http://htmlui.com/blog/2011-08-23-5-obscure-facts-about-html5-localstorage.html)

他们说不。但他们已经有一年多了，而且 Chrome 和 safari 的更新版本从那时起就已经发布了。

我只关心 chrome 和 safari。我的网络应用程序预计可以在平板电脑和笔记本电脑上运行。非常感谢一个明确的答案！

# java - Hibernate 和 PostgreSQL - 检查传入 setParameterList 的集合是否为空

> ID：13573781
> 
> 赞同：1
> 
> 时间：2012-11-26T21:52:32.123
> 
> 标签：java, sql, database, hibernate, postgresql

我正在构建一个查询，我想将集合作为参数传递：

```
List<String> items = new LinkedList();
//adding optional items
Query query = s.getNamedQuery("myQueryName").setParameterList("item", items); 
```

我的查询如下所示：

```
SELECT i from Item i
//... not important things
WHERE ( i.name in (:item) ) 
```

但我想让它成为可选的，所以项目列表可能是空的。但是当它为空时，我得到一个异常：

```
org.hibernate.hql.internal.ast.QuerySyntaxException: unexpected end of subtree 
```

所以我尝试使用一些功能，例如：

```
SELECT i from Item i
//... not important things
WHERE ( (:item) is null or i.name in (:item) )

SELECT i from Item i
//... not important things
WHERE ( (:item) is empty or i.name in (:item) )

SELECT i from Item i
//... not important things
WHERE ( size(:item)=0 or i.name in (:item) ) 
```

但它似乎都不起作用。如何解决此问题并仅在列表不为空时检查项目名称是否在列表中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:25:52.070

您可以将一个值添加到您知道永远不会返回 true 的列表中。例如，假设您有一个整数列表，并且您想查看列表中是否包含 ID。您可以将“-1”添加到列表中，它应该按照您想要的方式工作。对于您的字符串示例，只需添加一个永远不会出现的随机字符串。

就像是：

```
List<String> items = new LinkedList();
items.add("**BLAHBLAH_YO_MAMMA_SO_SLEAZY_SHE_ALWAYS_RETURN_TRUE**");
//add optional items
Query query = s.getNamedQuery("myQueryName").setParameterList("item", items); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T21:59:56.323

也就是说，恕我直言，SQL 中的一个设计问题，当然也存在于 HQL 中，因为它直接转换为 SQL。

在 HQL 中没有简单的解决方案来处理这个问题。最简单、最有效的做法是在生成和执行查询之前检查列表。

在许多情况下，您只需要执行以下操作：

```
if (items.isEmpty()) {
    return Collections.emptyList();
} 
```

在您的情况下，我将使用条件查询（或用于动态构建查询的另一个 API），并动态构建查询：

```
Criteria c = session.createCriteria(Item.class, i);
...
if (!items.isEmpty()) {
    c.add(Restrictions.in("i.name", items));
}
return c.list(); 
```

# mysql - MySql 中的 WHERE AND 语句

> ID：13573782
> 
> 赞同：0
> 
> 时间：2012-11-26T21:52:45.060
> 
> 标签：mysql

我正在使用以下 MySQL 语句来获取 ID 跨表匹配的 Drupal 帖子：

```
SELECT node.nid,node_revisions.nid,url_alias.nid, 1, FROM_UNIXTIME(node.created), node_revisions.body, node_revisions.title, node_revisions.teaser, url_alias.slug, FROM_UNIXTIME(node.changed), if(node.type='blog', 'post', 'page')
FROM node, node_revisions, url_alias 
WHERE (node.type='blog' OR node.type='page') 
AND (node.nid=node_revisions.nid) 
AND (node.nid=url_alias.nid)
LIMIT 10; 
```

（请注意，我已经对 url_alias 进行了一些修改，如果有人试图复制它）

我必须使用两个 AND 语句，因为出于某种原因，这不起作用：

```
...
WHERE ...
AND (node.nid=node_revisions.nid=url_alias.nid)
... 
```

为什么我不能在一个 AND 语句中比较所有 ID？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T21:59:49.137

SQL 不是那样工作的。MySQL 只接受单对二进制比较。大多数编程语言的行为都如您所愿，但 SQL 不是编程语言。显式编写连接将有助于查询的可读性，并且可能是您尝试做的工作的一种解决方法。查询可以这样重写：

```
SELECT nid, 1, FROM_UNIXTIME(node.created), node_revisions.body, node_revisions.title,
    node_revisions.teaser, url_alias.slug, FROM_UNIXTIME(node.changed),
    if(node.type='blog', 'post', 'page')
FROM node
    JOIN node_revisions USING (nid)
    LEFT JOIN url_alias USING (nid)
WHERE node.type IN ('blog','page')
LIMIT 10 
```

我还将 select 中的三`nid`列更改为一，因为 将始终相同，将 post 类型条件设为`IN`子句，因为这样可以更好地优化，并`JOIN`使用`url_aliases`a`LEFT JOIN`以防节点没有别名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T21:58:30.067

SQL 中的 = 比较器是二进制的。a=b=c 在任何情况下都是不允许的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T22:03:48.810

我想说您提供的语法可以用几种方式解释。

您正在驾驶的直观的人类方式，您可以在其中编写等效的

```
(node.nid=node_revisions.nid) AND (node_revisions.nid=url_alias.nid) 
```

计算机解释它的方式可能只是从左到右处理操作：

```
(node.nid=node_revisions.nid)=url_alias.nid 
```

也就是说，要分析 url_alias.nid 是否等于前面相等的真/假（或在这种情况下为真正的 0/1）结果。这不是微不足道的，布尔运算的结果通常被视为变量并以这种方式直接比较。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-26T22:06:19.887

在编程语言中（尽管 SQL 不是一种），比较返回一个布尔值，并且不带括号的多重计算是按照符号的顺序进行的，然后从左到右。所以如果是 PHP

`$a == $b == 3`将编译成
`($a == $b) == 3`哪个将编译成
`true == 3`或`false == 3`相应地

# c# - 组合框不显示所选项目

> ID：13573783
> 
> 赞同：1
> 
> 时间：2012-11-26T21:52:45.697
> 
> 标签：c#, wpf, combobox

在代码中：

```
private ObservableCollection<State> allStates = new ObservableCollection<State>(); 
```

//State 是一个有很多属性的类，其中一个是 int 'Index' 和 int 'OneArrow'

```
public MainWindow()
{
...

this.MyComboBox.ItemsSource = allStates;
this.MyComboBox.DisplayMemberPath = "Index";
this.MyComboBox.SelectedValuePath = "Index";

this.DataContext = MyState;
} 
```

在xml中：

```
<ComboBox Name="MyComboBox" 
Width="60" Height="20" 
IsEnabled="False" 
SelectedValue="{Binding Path=OneArrow, UpdateSourceTrigger=PropertyChanged}"/> 
```

绑定工作正常，很好，但我还有另一个问题。组合框不显示所选项目。我的意思是在下拉列表中突出显示正确的项目，但是当隐藏下拉列表时，什么都不会显示。

![在此处输入图像描述](../Images/f62917050e6d20bb7519b39c8846795a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:30:55.580

如果没有看到你所有的课程，很难猜测出了什么问题。这是我对您的代码外观的解释。

xml:

```
<Window x:Class="WpfApplication4.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525" Name="UI">
    <Grid >
        <ComboBox ItemsSource="{Binding ElementName=UI, Path=AllStates}" 
                  DisplayMemberPath="Index"
                  SelectedValuePath="Index"
                  SelectedValue="{Binding ElementName=UI, Path=OneArrow}"
                  Height="21" HorizontalAlignment="Left" Margin="80,82,0,0" Name="comboBox1" VerticalAlignment="Top" Width="152" />
    </Grid>
</Window> 
```

代码背后：

```
 /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
            AllStates.Add(new State { Index = 1 });
            AllStates.Add(new State { Index = 2 });
            AllStates.Add(new State { Index = 3 });
            AllStates.Add(new State { Index = 4 });
        }

        private ObservableCollection<State> allStates = new ObservableCollection<State>();
        public ObservableCollection<State> AllStates 
        {
            get { return allStates; }
            set { allStates = value; }
        }

        private int oneArrow;
        public int OneArrow
        {
            get { return oneArrow; }
            set { oneArrow = value; }
        }

    }

    public class State : INotifyPropertyChanged
    {
        private int index;
        public int Index
        {
            get { return index; }
            set { index = value; NotifyPropertyChanged("Index"); }
        }

        public event PropertyChangedEventHandler PropertyChanged;
        public void NotifyPropertyChanged(string property)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(property));
            }
        }
    } 
```

这似乎工作正常，但就像我说的那样，我不知道你的 State 类是什么样子或者 OneArrow 位于哪里（mainform 或 State）

# oracle - 过程在 dblink 中挂起查询表

> ID：13573785
> 
> 赞同：2
> 
> 时间：2012-11-26T21:52:49.927
> 
> 标签：oracle, shell, unix, sqlplus, dblink

我正在尝试从 shell 脚本调用一个过程，该过程使用远程数据库的数据将大量插入到我的数据库中。所以，我在这里做的是通过 dblink 查询表并将该信息插入我的本地表中。

当我直接从数据库 IDE（如 Quest Toad 或 Oracle SQL Developer）执行此操作时，该过程运行时间不到 3 分钟。当我在 sqlplus 命令行中运行该过程时，也会在不到 3 分钟内运行。但是当我使用 shell 脚本调用该过程时，unix 中的进程挂起，在 oracle 服务器中产生一个高使用率的网络事件，并且数据库会话永远不会结束。

所以，这里的事情是我有另一个以与此相同的方式运行的程序，只有这会在我在 ksh 脚本中执行时引起问题。

下面，我使用两种方法从 ksh 脚本中的 sqlplus 调用该过程：

原脚本：

```
#!/usr/bin/ksh

PROFILE=/home/user/config/my_profile.sh
. ${PROFILE}
yesterday=$(TZ=GMT+24 date "+%d/%m/%Y")
echo "Establishing a DB connection"
/home/oraclei/product/11.1.0/bin/sqlplus<<END_OF_SQL
$USER/$PASSWD
execute MY_PROCEDURE@DB('$yesterday');
exit;
END_OF_SQL 
```

选择：

```
#!/usr/bin/ksh

PROFILE=/home/user/config/my_profile.sh
. ${PROFILE}
echo "Establishing a DB connection"
yesterday=$(TZ=GMT+24 date "+%d/%m/%Y")
/home/oraclei/product/11.1.0/bin/sqlplus $USER/$PASSWD @/home/user/dblink_load/scripts/sql/load.sql $yesterday 
```

以及它使用的 sql 脚本

```
exec MYSCHEMA.MY_PROCEDURE('&1');
quit; 
```

过程中的查询是这样的：

```
insert into MYSCHEMA.mytable
(id, date, stat1, stat2, stat3)
(select
    id, date, max(stat1), avg(stat2), avg(stat3)
from
    tableA@dblink table1,
    tableB@dblink table2,
    tableC@dblink table3
where
    table1.date >= parameter and
    table1.id = table2.id and
    table2.id = table3.id
group by
    table1.id,
    table1.date); 
```

# php - Joomla 1.5 在 Joomla 之外访问模板

> ID：13573787
> 
> 赞同：0
> 
> 时间：2012-11-26T21:52:51.660
> 
> 标签：php, joomla

我正在尝试在 Joomla 之外访问和构建一个页面。我最关心的是菜单。它开始加载，但我在`mosLoadModules`调用时遇到了多个错误。有没有办法加载这些或让页面访问这些功能？

```
$directory = '/var/www'; // path to Joomla installation

define( '_JEXEC', 1 );
define( 'JPATH_BASE', $directory);
define( 'DS', '/' );

require_once ( JPATH_BASE .DS . 'configuration.php' );
require_once ( JPATH_BASE .DS.'includes'.DS.'defines.php' );
require_once ( JPATH_BASE .DS.'includes'.DS.'framework.php' );

require_once ( JPATH_BASE .DS.'libraries'.DS.'joomla'.DS.'factory.php' );
$mainframe =& JFactory::getApplication('site');

$mosConfig_live_site = 'mysitesdomain.com'; 
```

# php - 保留输入到文本区域的换行符

> ID：13573792
> 
> 赞同：1
> 
> 时间：2012-11-26T21:53:07.417
> 
> 标签：php, html, database, newline

> **可能重复：**
> [为什么输入的关键字没有存储在数据库中？](https://stackoverflow.com/questions/2816262/why-entered-key-word-is-not-store-in-database)

我正在编写一个简单的页面，用户可以在其中将有关网站的推荐输入到 textarea 框中。这将存储在我的数据库中名为 testimonials 的表中，该表位于“testimonial”下，其类型为 text(1000)

当我尝试检索推荐并呈现它们和无序列表时，换行符被忽略。

例如：

我讨厌这个网站。

它有很多错误。

将打印为

*   我讨厌这个网站。它有很多错误

如何保留用户输入的换行符？

编辑：我应该提一下，当我在 phyMyAdmin 中查看推荐时，该推荐在数据库中使用换行符正确存储

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:55:58.073

由于浏览器不会呈现`\n`，您需要使用一个名为[nl2br()](http://php.net/manual/en/function.nl2br.php)的函数来替换新行`<br/>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T21:56:41.270

在您使用您的内容调用`nl2br()`后立即调用。`htmlspecialchars()`

例如它应该是这样的：

```
echo nl2br(htmlspecialchars($content)); 
```

另一种解决方案是使用保留空格的 CSS 格式化内容，如内部`<pre>`标签。

# web-services - ServiceStack Web Service with Basic Authentication and SetCredentials

> ID：13573793
> 
> 赞同：6
> 
> 时间：2012-11-26T21:53:07.713
> 
> 标签：web-services, authentication, authorization, servicestack, basic-authentication

Right now I'm playing with [ServiceStack](https://github.com/ServiceStack/ServiceStack) and its [Authentication and authorization](https://github.com/ServiceStack/ServiceStack/wiki/Authentication-and-authorization) support.

Working on the `CustomAuthenticationMvc` (the Web Service `Host` app) from the [Use Cases project](https://github.com/ServiceStack/ServiceStack.UseCases#readme) and while trying to understand how the authentication works, I did this:

```
public class AppHost : AppHostBase
{
    public AppHost() : base("Basic Authentication Example",
                                                        typeof(AppHost).Assembly) { }

    public override void Configure(Container container)
    {
        // register storage for user sessions 
        container.Register<ICacheClient>(new MemoryCacheClient());
        container.Register<ISessionFactory>(c => new SessionFactory(
                                            c.Resolve<ICacheClient>()));

        //Register AuthFeature with custom user session and Basic auth provider
        Plugins.Add(new AuthFeature(
            () => new CustomUserSession(),
            new AuthProvider[] { new BasicAuthProvider() }
        ) );

        var userRep = new InMemoryAuthRepository();
        container.Register<IUserAuthRepository>(userRep);

        //Add a user for testing purposes
        string hash;
        string salt;
        new SaltedHash().GetHashAndSaltString("test", out hash, out salt);
        userRep.CreateUserAuth(new UserAuth
        {
            Id = 1,
            DisplayName = "DisplayName",
            Email = "as@if.com",
            UserName = "john",
            FirstName = "FirstName",
            LastName = "LastName",
            PasswordHash = hash,
            Salt = salt,
        }, "test");
    }
} 
```

The service implementation is the famous Hello World one with the `[Authenticate]` attribute applied right above the Request DTO...

```
[Authenticate]
[Route("/hello")]
[Route("/hello/{Name}")]
public class HelloRequest : IReturn<HelloResponse>
{
    public string Name { get; set; }
}

public class HelloResponse
{
    public string Result { get; set; }
}

public class HelloService : IService<HelloRequest>
{
    public object Execute(HelloRequest request)
    {
        return new HelloResponse
        {
            Result = "Hello, " + request.Name
        };
    }
} 
```

Using a Console Application as a `Client`, I have this code:

```
static void Main(string[] args)
{   
    // The host ASP.NET MVC is working OK! When I visit this URL I see the
    // metadata page.
    const string BaseUrl = "http://localhost:8088/api";

    var restClient = new JsonServiceClient(BaseUrl);

    restClient.SetCredentials("john", "test");

    HelloResponse response = restClient.Get<HelloResponse>("/hello/Leniel");

    Console.WriteLine(response.Result);
} 
```

The problem here is that I don't think the `restClient.SetCredentials("john", "test");` is working as I would expect because the webservice call `restClient.Get<HelloResponse>("/hello/Leniel");` is throwing an exception. I see that I'm being redirected to the login page... I thought that setting the credentials it'd be alright to call the web service. It's not the case here.

What am I doing wrong? I plan to call this web service from a MonoTouch iOS app where the user will type his username and password in a simple dialog window, but before doing this I'd like to get it working in this simple console app.

**EDIT 1**

I tried this code to send the auth request (as seen on this [thread](https://groups.google.com/forum/?fromgroups=#!topic/servicestack/3I2k4BkQUMI)):

```
var authResponse = restClient.Send<AuthResponse>(new Auth
{
    UserName = "john", 
    Password = "test",
    RememberMe = true, 
}); 
```

but an exception is thrown:

> Type definitions should start with a '{', expecting serialized type 'AuthResponse', got string starting with:
> 
> ```
> <head> 
> ```

Looks like I have a miss-configured service because it keeps redirecting me to the default ASP.NET MVC `Login` page (see the Fiddler screenshot below). I also changed the `AuthFeature` registration passing `null` to `HtmlRedirect`.

```
//Register AuthFeature with custom user session and Basic auth provider
Plugins.Add(new AuthFeature(
    () => new CustomUserSession(),
    new AuthProvider[] { new BasicAuthProvider() }
) {  HtmlRedirect = null }); 
```

**EDIT 2**

Playing with [Fiddler](http://www.fiddler2.com/) I tried adding an Authorization request header as described [here](https://stackoverflow.com/a/4952255/114029):

![enter image description here](../Images/89a1d2f8865f5c74aa802e3fc70c5d91.png)

Looking at the Auth inspector in Fiddler I can see this:

```
Authorization Header is present: Basic am9objp0ZXN0
Decoded Username:Password= john:test 
```

Now, why am I getting the 401 unauthorized status? Shouldn't it just work given that I set up a user in memory for testing purpose?

How can I pass the request header in my sample console app?

If I do in the console app:

```
restClient.AlwaysSendBasicAuthHeader = true; 
```

I get the 401 unauthorized response...

**EDIT 3**

With the help of desunit's answer and code additions, I managed to get the Console App authentication working with the following code:

```
class Program
{
    const string BaseUrl = "http://localhost:8088/api";

    static void Main(string[] args)
    {
        var restClient = new JsonServiceClient(BaseUrl);

        restClient.SetCredentials("john", "test");

        restClient.AlwaysSendBasicAuthHeader = true;

        HelloResponse response = restClient.Get<HelloResponse>("/hello/Leniel");

        Console.WriteLine(response.Result);
    }
}

//Response DTO
//Follows naming convention
public class HelloResponse
{
    public string Result { get; set; }
} 
```

I'd like to know the following now: In a Console App should I always send the Basic Auth Header? If I remove that line, the authentication just fails and I do not get the `HelloResponse.`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T09:48:48.060

The problem is not related to ServiceStack itself but to how ASP.NET web handles 401 error code. You can workaround it with custom `IHttpModule` which suppresses redirect to Login form. More details about that problem could be read [here](http://haacked.com/archive/2011/10/04/prevent-forms-authentication-login-page-redirect-when-you-donrsquot-want.aspx).

Since it's quite common problem [we have updated](https://github.com/ServiceStack/ServiceStack.UseCases/commit/d3c135f458fe3ac285f70ea3b42f93cbe0794692) `CustomAuthenticationMvc` project to demonstrate possible solution.

# database - 网站后端用户活动日志和 HIPAA 合规性

> ID：13573796
> 
> 赞同：-1
> 
> 时间：2012-11-26T21:53:14.330
> 
> 标签：database, logging, content-management-system, backend, hipaa

有人可以告诉我我应该将网站用户活动日志保存在数据库中以满足 HIPAA 合规性所需的时间长度吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T20:58:54.690

免责声明：我不是律师，我支持 Josh Berke 的评论。

六个月通常是我所听到的最低限度的讨论，但是当谈到 HIPAA 合规性时，没有太安全的事情。如果没有技术限制，请尽可能长时间地保留审计跟踪。

# c# - 在 WPF 窗口之间发送数据

> ID：13573799
> 
> 赞同：3
> 
> 时间：2012-11-26T21:53:26.057
> 
> 标签：c#, wpf, forms

所以我一直在环顾四周，并没有找到使用 WPF`Window`的解决方案。

所以我想做的是将两个滑块的值从一个 WPF`Window`发送到另一个。这应该如何`Window`在同一个项目中使用两个 WPF 来完成？是否可以使用引用从同一解决方案中的另一个项目中做到这一点？

我一直在使用 Windows 窗体，并且可以让它在那里轻松工作，但它不能与 WPF 一起工作`Window`。

[编辑] 需要做的是非常基本的。我们有一个名为 Project 的菜单项目`Startup`，`MainWindow.xaml`其中不包含任何需要提及的代码。虽然，我们希望从菜单中能够使用 2 个滑块，1 个用于设置将要参与的玩家数量，另一个用于设置游戏应该持续的小时数。我们已经通过设置这样的玩家数量从游戏本身解决了这个问题：

```
private void slider1_ValueChanged(object sender, RoutedPropertyChangedEventArgs<double> e)  // Change move-army-strenght
{
    movearmy = Convert.ToInt32(slider1.Value);
    lblresult3.Content = "" + movearmy;
    if (menuphase == 1) { players = Convert.ToInt32(slider1.Value); }
} 
```

这将检查它是否是`menuphase`一个，然后从中获取玩家数量。虽然，我们想从 发送这个值`Menu`，而不是在游戏中！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T01:50:52.793

对于您的要求来说，这可能有点过头了，但是在表单、窗口等之间发送带有数据的消息的一种可扩展方式是使用[Mediator Design Pattern](http://www.dofactory.com/Patterns/PatternMediator.aspx)。Marlon Grech 为[WPF Mediator](http://marlongrech.wordpress.com/2008/03/20/more-than-just-mvc-for-wpf/)撰写了一篇出色的文章和示例项目。

这种模式适用于发送各种消息，只要没有太多订阅者在寻找消息。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-01-19T09:04:32.563

OP在编辑中写道：

> [解决方案]
> 
> ```
> public partial class SelectionWindow : Window
> {
>     WpfApplication1.GameWindow newForm2;
> 
>     public SelectionWindow()
>     { InitializeComponent(); }
> 
>     private void continue_Click(object sender, RoutedEventArgs e)
>     {
>         if (Convert.ToInt32(slider1.Value) > 1)
>         {
>             Worldmap.Properties.Settings.Default.value1 = Convert.ToInt32(slider1.Value);
>             Worldmap.Properties.Settings.Default.value2 = Convert.ToInt32(slider2.Value);
>             Worldmap.Properties.Settings.Default.Save();
>             newForm2 = new WpfApplication1.GameWindow();
>             newForm2.Show();
>             Close();
>         }
>     }
> 
>     private void slider1_ValueChanged_1(object sender, RoutedPropertyChangedEventArgs<double> e)
>     { playerresult.Content = Convert.ToInt32(slider1.Value); }
> 
>     private void slider2_ValueChanged_1(object sender, RoutedPropertyChangedEventArgs<double> e)
>     { timeresult.Content = Convert.ToInt32(slider2.Value); }
> } 
> ```

# c - Libexif 未定义的引用错误

> ID：13573802
> 
> 赞同：1
> 
> 时间：2012-11-26T21:53:38.960
> 
> 标签：c, linux, libexif

我有一个程序使用这里找到的 libexif C 库[http://libexif.sourceforge.net/](http://libexif.sourceforge.net/)

我安装了库，它位于 /usr/include/libexif

我将这些包含在程序的顶部

```
#include <libexif/exif-data.h>
#include <libexif/exif-content.h>
#include <libexif/exif-entry.h> 
```

我的编译语句：

```
`gcc -o test test.c` 
```

当我编译我得到这些错误

```
/tmp/ccUUWpcw.o: In function `show_tag':
test.c:(.text+0x91): undefined reference to `exif_content_get_entry'
test.c:(.text+0xc0): undefined reference to `exif_entry_get_value'
test.c:(.text+0xef): undefined reference to `exif_tag_get_name_in_ifd'
/tmp/ccUUWpcw.o: In function `main':
test.c:(.text+0x179): undefined reference to `exif_data_new_from_file'
test.c:(.text+0x1cd): undefined reference to `exif_data_unref'
collect2: ld returned 1 exit status 
```

该程序认为可以很好地读取包含的文件，但由于某种原因不知道这些功能。我安装库时所做的只是解压缩它，./configure, make && make install

我需要在其他地方引用这个库或类似的东西吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T21:56:38.677

是的，您需要链接库：

```
gcc test.c -o test -lexif 
```

# javascript - Jquery调用函数的问题

> ID：13573803
> 
> 赞同：-1
> 
> 时间：2012-11-26T21:53:49.110
> 
> 标签：javascript, jquery, html, forms

所以我正在尝试创建一个函数，设置/删除字段中的水印，我已经开始工作了，其中输入的 html 元素如下所示：

```
<input type="text" name="pollName" id="pollName" value="DD-MM-YYYY" onfocus="javascript: watermark(this,true,'DD-MM-YYYY')" onblur="javascript: watermark(this,false,'DD-MM-YYYY')" > 
```

然而，这很长，我正在尝试将代码移动到 javascript，我打算在其中使用此代码：

```
function watermark(dom,isFocus,watermark)
{
    if(isFocus)
    {
        if(dom.value === watermark)
        {
            dom.value = "";
        }
    }
    else if(!isFocus)
    {
        if(dom.value === '')
        {
            dom.value = watermark;
        }
    }
}

document.ready(function(){
    $('#addOption').click(addOption);
    $('.dateSelector').focusin(watermark(this,1,'DD-MM-YYYY'));
    $('.dateSelector').focusout(watermark(this,0,'DD-MM-YYYY'));
}); 
```

这是有问题的HTML。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>SPS: Create a new poll</title>
<link href="styles/stylePollCreator.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
<script type="text/javascript" src="js/jsPollCretor.js"></script>

</head>

<body>

        <div id="pollSetup">
            <form action="" method="post">
                <label for="pollName:">Poll name</label>
                <input type="text" name="pollName" id="pollName" />
                <br />
                <label for="startDate">Start date: </label>
                <br />
                <input type="text" id="startDate" name="startDate" class="dateSelector" value="DD-MM-YYYY"/>
                <label for="endDate">End date: </label>
                <input type="text" id="endDate" name="endDate" class="dateSelector" value="DD-MM-YYYY"/>
                <br />
                <div id="pollOptions">
                </div>
                <input id="submitNewPoll" value="Create poll" type="submit" />
            </form>
            <button id="addOption">Add option</button>
        </div>
    </body>
</html> 
```

addOption 函数工作正常，但是水印函数似乎在站点首次加载时调用一次，然后不再调用：/

感谢您的时间 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:58:40.803

`focusin`并`focusout`期望参数函数，并且您在技术上传递`undefined`，因为 watermark 没有返回任何内容。换句话说，您传递的是 的结果`watermark`，而不是`watermark`其本身。

所以，你想这样做：

```
$('.dateSelector').focusin(function(){watermark(this,1,'DD-MM-YYYY')}); 
```

**编辑：**

我同意上面的评论，您应该使用占位符属性。因此，您的输入将如下所示：

```
<input type="text" name="pollName" id="pollName" placeholder="DD-MM-YYYY"> 
```

请记住，这是一个 HTML5 属性，因此对于旧浏览器，您必须使用 polyfill，但如果您[搜索占位符 polyfill](https://www.google.com/search?q=placeholder+polyfill)，您会找到一百万个可以使用的 polyfill。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:01:03.987

> 但是，水印功能似乎在网站首次加载时调用一次

是的，这就是你正在做的

```
$('.dateSelector').focusin(watermark(this,1,'DD-MM-YYYY'));
$('.dateSelector').focusout(watermark(this,0,'DD-MM-YYYY')); 
```

这相当于

```
watermark(this,1,'DD-MM-YYYY');
$('.dateSelector').focusin(undefined);
watermark(this,0,'DD-MM-YYYY');
$('.dateSelector').focusout(undefined); 
```

将函数传递给事件注册：

```
$('.dateSelector').focusin(function(e) {
    watermark(this,1,'DD-MM-YYYY');
}).focusout(function(e) {
    watermark(this,0,'DD-MM-YYYY');
}); 
```

但是，正如@MattBall 已经评论的那样，`placeholder`如果您需要支持较旧的浏览器，您应该只使用该属性并填充它（使用现有库）：

```
<input type="text" name="pollName" id="pollName" placeholder="DD-MM-YYYY"> 
```

# r - 将原始数据转换为 R 日期/时间类

> ID：13573814
> 
> 赞同：1
> 
> 时间：2012-11-26T21:54:55.210
> 
> 标签：r, date, datetime, posixct

我已经成功地抓取了一堆我现在想在 R 中操作的表。我是 R 的新手，但这似乎是一个很好的解决方法。

我目前将数据存储在以条形分隔的 CSV 中，如下所示：

```
FIRST|LAST|9812036311|string-string|1999-07-06 00:00:00|2000-07-06 00:00:00|12345|1999-07-27 00:00:00|2,518.50 
```

我可以阅读它：

```
j <- read.table('my_data.csv', header = FALSE, sep = "|") 
```

但是......如何将这些日期列转换为 R 可以读取的日期？

我需要先定义一个框架吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:56:55.527

[按照此处](https://stackoverflow.com/questions/3554572/read-csv-with-dates-and-numbers-with-r-statistical-software)`colclasses`的建议进行结帐，以帮助 R 了解它应该在 CSV 的每一列中预期的数据类型。还要查看处理日期格式的[lubridate包。](http://cran.r-project.org/web/packages/lubridate/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:07:13.887

要像您一样转换日期时间字符串，我建议使用***结构***函数，如下所示：

```
> # begin with date-time values stored as character vectors ("strings"):

> w
   [1] "2000-07-06 00:00:00"

> typeof(w)
   [1] "character"

> class(w)
   [1] "character"

> # use structure to convert them
> w = structure(w, class=c("POSIXt, POSIXct"))

> # verify that they are indeed R-recognizable date-time objects:
> w
   [1] "2000-07-06 00:00:00"
   attr(,"class")
   [1] "POSIXt, POSIXct" 
```

w/r/t the mechanics: R functions are vectorized, so you can just pass in a column of dates and bind the result to the same column, like so:

```
> j$day
    [1] 1353967580 1353967581 1353967583 1353967584 1353967585 1353967586 
    [7] 1353967587 1353967588 1353967589 1353967590

> j$day = structure(day, class=c("POSIXt", "POSIXct"))

> day
   [1] "2012-11-26 14:06:20 PST" "2012-11-26 14:06:21 PST" "2012-11-26 14:06:22 PST"
   [4] "2012-11-26 14:06:23 PST" "2012-11-26 14:06:24 PST" "2012-11-26 14:06:25 PST"
   [7] "2012-11-26 14:06:26 PST" "2012-11-26 14:06:28 PST" "2012-11-26 14:06:29 PST"
   [10] "2012-11-26 14:06:30 PST" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T16:23:54.003

It turns out I just needed `as.Date` -- as a sanity check, I created a new column with the modified date.

```
j$better.date <- as.Date(j$original.date, format="%Y-%d-%m") 
```

# google-apps-script - 将粗体文本转换为蓝色

> ID：13573815
> 
> 赞同：2
> 
> 时间：2012-11-26T21:54:56.247
> 
> 标签：google-apps-script, google-docs

我创建了很多 Google Docs 文档，我必须手动设置粗体和蓝色文本的格式。将部分文本格式化为粗体很容易，因为有一个快捷方式 (Ctrl+B)，但很难着色（您需要单击 2 次）。如果我单击菜单中的按钮（由 Google Apps 脚本创建）并将所有粗体文本格式化为蓝色（保留粗体）会怎样。

* * *

一个例子：如果我们有“ **Hello wo** rld”，我想将“ **Hello wo** ”部分染成蓝色。

谢谢 :D

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T05:04:16.190

虽然您确实无法使用自定义菜单执行此操作，但您可以通过创建一个独立的应用程序脚本并在您将元素设置为粗体后通过文档 ID 在您的文档上运行该脚本来执行此操作。以下代码打开一个文档，获取文本格式更改的索引，遍历这些索引以查看它是否更改为粗体，然后将以下部分着色为蓝色。此代码将帮助您入门，但您需要使用它来消除边缘情况。

```
function boldToBlue() {
  // replace with your doc ID
  var doc = DocumentApp.openById('1vfxetEhzOTXm_r9f-GanM4mSTwSkWrRsrgVsCy5laKU');
  var docText = doc.editAsText();
  var idc = docText.getTextAttributeIndices(); // gets text indicies where formatting changes

  // loop through formatting changes. If changes -> bold, make next section also blue
  for (var i = 0; i < idc.length-1; i++) {
    if (docText.isBold(idc[i])) {
      docText.setForegroundColor(idc[i], idc[i+1]-1, '#00FFFF');
    }
  }
} 
```

我通过您的问题文本运行代码作为示例：

前： ![图像前](../Images/c1d26e1f162a44f983767adbac336938.png)

后： ![后像](../Images/2085ee5299273b548b1cc2446eb7cb3e.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T03:12:27.917

自定义菜单目前在 Google 文档中不可用。[您可以在此处](http://code.google.com/p/google-apps-script-issues/issues/entry?template=Feature%20request%20from%20user)提交功能请求。

# asp.net - ASP.NET VB - Submit.Click 不工作

> ID：13573818
> 
> 赞同：1
> 
> 时间：2012-11-26T21:55:03.807
> 
> 标签：asp.net, vb.net

我对asp.net 很陌生，对于我的生活，我似乎无法获得提交按钮来调用相关的vb 代码。谁能指出我正确的方向？我几乎把所有东西都去掉了，只显示一个消息框，但什么也没有，没有错误，没有警告。非常感谢这里的任何帮助。

注册.aspx

```
<%@ Page Title="" Language="vb" AutoEventWireup="false" MasterPageFile="~/anonymous/anonymous.Master" CodeBehind="register.aspx.vb" Inherits="mynamespace.register" %>
<asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
    <form id="register" method="post">
    <asp:Label ID="EmailLabel" runat="server" AssociatedControlID="Email">E-mail:</asp:Label>
    <asp:TextBox ID="email" runat="server" CssClass="textEntry"></asp:TextBox><br />

    <asp:Button ID="submit" runat="server" Text="Create Account"/>
    </form>         
</asp:Content> 
```

注册.aspx.vb

```
Imports System.Web.Configuration
Imports System.Data.SqlClient

Public Class register
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    End Sub

    Private Sub submit_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles submit.Click
        MsgBox("submit clicked!!", 65600, "New Message")
    End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:58:25.987

在与 的行设置断点，`MsgBox`您会看到它被击中。您不能在 ASP.NET 中使用消息框，因为它将显示在服务器上而不是客户端上。

出于演示目的，您可以注册客户端`alert`：

```
Private Sub submit_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles submit.Click
    ClientScript.RegisterStartupScript(this.GetType(), "msgBox", "alert('submit clicked! Now at the client again');", true);
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:00:14.847

我在这里看到两个问题。

首先是你不应该在你的内容中使用表单标签。作为母版页的一部分，您的页面上已经有一个表单，在这里使用单独的表单意味着您没有创建正确的回发...诸如视图状态之类的内容未正确提交，因此 asp.net 运行时不会不知道触发点击事件处理程序。

第二个是 MsgBox() 函数在 web 表单中不会像你期望的那样工作（真的：根本不会工作）。对于asp.net中的这种调试，你需要做一些不同的事情，比如记录到一个文件或者设置一个断点。

# java - 休眠预测以在列表中找到最大值

> ID：13573825
> 
> 赞同：0
> 
> 时间：2012-11-26T21:55:45.757
> 
> 标签：java, hibernate

我已经为此苦苦挣扎了一段时间，所以我希望有人能给我一些指导。我有两张桌子：

```
WardTransactions:
    +-----------+
    | Field     |
    +-----------+
    | Id        |
    | VisitId   |
    | Event     |
    | EventTime |
    +-----------+

Visits:
    +---------------+
    | Field         |
    +---------------+
    | Id            |
    | VisitNumber   |
    +---------------+ 
```

每次访问可以有许多 WardTransactions。我正在尝试使用 Hibernate Criteria/Projections 来查找特定访问的最新 WardTransaction。例如：

```
public WardTransaction findLast(Visit visit) {
    DetachedCriteria maxQuery = DetachedCriteria.forClass( WardTransaction.class );
    maxQuery.setProjection( Projections.max( "id" ) );
    Criteria query = getSession().createCriteria( WardTransaction.class )
        .createAlias("visit", "visit")
        .add(Restrictions.eq("visit.id", visit.getId()))
        .add(Property.forName( "id" ).eq( maxQuery ));
    return (WardTransaction) query.uniqueResult();
} 
```

这是行不通的。通过查看生成的查询，它似乎正在使用 Max WardTransaction.Id 而不是具有所需访问记录的最大值进行内部连接。那就是（修改以使其更清晰）：

```
select
        a.Id,
        a.VisitId,
        a.Event,
        a.EventTime,
        b.Id,
        b.VisitNumber,
    from
        WardTransactions a 
    inner join
        Visits b 
            on a.VisitId=b.Id 
    where
        b.Id='22' 
        and a.Id = (
            select
                max(a.Id) as y0_ 
            from
                WardTransactions a
        ) 
```

我尝试了其他方法，但都没有找到我正在寻找的解决方案。任何建议，指导表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:34:23.537

```
String hql = "select w from WardTransaction w where w.visit = :visit order by w.id desc";
WardTransaction last = session.createQuery(hql)
                              .setParameter("visit", visit);
                              .setMaxResults(1)
                              .uniqueResult(); 
```

你当然可以对 Criteria 做同样的事情，但是 HQL 更具可读性，恕我直言。

# java - 重用一小段代码的最简单方法

> ID：13573830
> 
> 赞同：2
> 
> 时间：2012-11-26T21:55:59.943
> 
> 标签：java, methods, formatting

我有一段这样的代码：

```
 while (scanFile.hasNextLine()) 
            {
                String currentLine = scanFile.nextLine();
                if (currentLine.isEmpty())
                {
                    System.out.println();
                    continue;
                }
                String[] allWordsInCurrentLine = currentLine.split(" "); 
```

然后，我想使用三种不同的方法来操作正在扫描的文件。

第一种方法单独扫描代码的每一行并逐行打印出某种形式的输出（pigLatin）（因此“while”循环的每次迭代都会给出一行输出。
第二种方法首先扫描所有文本，然后将各种信息存储在不同的数组和变量中。然后用户可以搜索这些信息（因此在给出任何输出之前必须满足整个“while”循环）。然后我有第三种方法，它与第一种方法类似。

我试图找到重用这部分代码的最有效方法。最初，我尝试只在上面代码的底行下方进行方法调用，并在其顶部有一个 for 循环，所以如果 a==0，调用第一个方法，然后通过 while 循环第二次，a 将递增并且将调用第二种方法，依此类推，如下所示：

```
for(String currentWordInCurrentLine : allWordsInCurrentLine)
{
    if (i==0)
        pigLatin(currentWordInCurrentLine);         // Part 1
    if (i==1)
        searchForWord(currentWordInCurrentLine, currentLine);   // Part 2
    if (i==2)
        brailleTranslator();
} 
```

这有一些问题，尤其是它看起来很糟糕的事实。有人建议我尝试接口，但它们比我的位置高一点（我的课程只有几周时间）。有没有人有任何其他建议？

编辑： pigLatin 方法调用使用上述（尽管看起来很可怕）方式可以正常工作。但是，我不能这样调用下一个方法，因为它需要运行整个“while”循环才能运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:19:45.647

我会将您想要的功能与您的三个不同进程包装在他们自己的自定义可调用类中，然后将它们传递给上面的代码。在这种情况下，共享代码将如下所示：

```
public class FileHandlerManager {

    public static void processFile(File file, List<FileHandler> handlers) {

        // ... Setup your scanFile from your file... leaving this out.

        while (scanFile.hasNextLine()) {

            String currentLine = scanFile.nextLine();

            String[] allWordsInCurrentLine = currentLine.split(" ");

            for (FileHandler handler : handlers) {
                handler.handle(allWordsInCurrentLine);
            }
        }
    }
} 
```

然后，您可以共享该 while 循环的功能`FileHandler`。什么是`FileHandler`? 我会很简单地定义它，如下所示：

```
public interface FileHandler {
    public void handle(String[] allWordsInCurrentLine);
} 
```

您的第一个可能如下所示：

```
public class PigLatinFileHandler implements FileHandler {
    public void handle(String[] allWordsInCurrentLine) {
        // Do your piglatin code.
    }
} 
```

最后，要运行它，你会做这样的事情

```
public static void main(String[] args) {

    IndexingFileHandler indexHandler = new IndexingFileHandler();

    List<FileHandler> handlers = new LinkedList<FileHandler>();
    handlers.add(new PigLatinFileHandler());
    handlers.add(indexHandler);
    handlers.add(new SimilarToPigLatinFileHandler());

    FileHandlerManager.processFile(file, handlers);

    // Note now you have a reference to indexHandler; so if you wanted to save
    // any state while processing the words you can, and use it here.
} 
```

**编辑**

我只想指出，有一种“更简单”、更少面向对象的方式；您可以有一个方法获取一个文件并返回一个 String[][]，它是文件行的二维数组，按这些行中的单词排列。然后您可以将该数组传递给您的处理程序。

然而，这种方法的缺点是它会破坏大文件（您必须一次将整个内容加载到内存中）并且在读取整个文件之前您不会得到任何输出。我的回答的一个（也许不是显而易见的）优势是您“流式传输”文件；您使用所有处理程序处理一行，然后丢弃该行，允许 java 重用该内存。这段代码可以让你处理一个 10 GB 的文件，同时只使用等于该文件中最长行长度的 java 内存（加上 IndexHandler 正在保存的任何状态）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:30:32.643

一种可能性是将您的逻辑放入这样的基类中：

```
public class Base {
  public void run() {
    while(...) {
      consume(word);
    }
  }
  protected void consume(string word){
  }
} 
```

然后您可以为每个作业创建一个类：

```
public PigLatin extends Base {
  protected void consume(string word) {
    // do piggy stuff..
  }
} 
```

您可以像这样运行所有内容：

```
...
Base l1 = new PigLatin();
l1.run();

Base l2 = new WordSearch();
l2.run();
... 
```

在您的情况下，这样做看起来不合理，它可能会使您的代码复杂化。但我认为这是一个很好的锻炼。

The disadvantage of this solution is that you have to iterate through your file every time you call `run()`. You usually do this if you want to separate different runs. If you're sure those runs don't interfere with each other, then Cory Kendall's solution is the way to go.

# c - 模拟交叉口的线程锁

> ID：13573831
> 
> 赞同：5
> 
> 时间：2012-11-26T21:56:06.730
> 
> 标签：c, multithreading, pthreads

我正在尝试使用线程和互斥锁来模拟交叉点。

我有过海峡，左转，右转的功能。现在，我有一个接近十字路口的功能。这会产生一个随机的方向和转弯。每个线程共享即将到来的交叉点。

我已经为各个方向的所有汽车定义了所有锁。

采取海峡两岸功能。它有一个 switch 语句，只打印什么车当时正在做什么。现在，我只是不知道该锁定什么功能。如果汽车是朝北的方向，我会锁定东西方向，并且与汽车朝南的方向相同吗？

这是我的锁，它只是调用一个函数来锁定或解锁

```
#define NUMCARS 30

#define lock_NW(CAR) lock(CAR, NW_mutex)
#define lock_NE(CAR) lock(CAR, NE_mutex)
#define lock_SW(CAR) lock(CAR, SW_mutex)
#define lock_SE(CAR) lock(CAR, SE_mutex)

#define unlock_NW(CAR) unlock(CAR, NW_mutex)
#define unlock_NE(CAR) unlock(CAR, NE_mutex)
#define unlock_SW(CAR) unlock(CAR, SW_mutex)
#define unlock_SE(CAR) unlock(CAR, SE_mutex) 
```

这是主要的

```
int main(int argc, char **argv){
/* Initial variables*/
int index, tid;
unsigned int carids[NUMCARS];
pthread_t carthreads[NUMCARS];

/* Start up a thread for each car*/ 
for(index = 0; index <NUMCARS; index++){
carids[index] = index;
tid = pthread_create(&carthreads[index], NULL, approachintersection,  (void*)&carids[index]);
}

/* Wait for every car thread to finish */
for(index = 0; index <NUMCARS; index++){
pthread_join(carthreads[index], NULL);
}
printf("Done\n");
return 1;
} 
```

这是调用函数的接近交叉点

```
static void * approachintersection(void* arg){
unsigned int * carnumberptr;
unsigned int carnumber;
orientation_t cardir = (orientation_t)random()%4;
unsigned long turn = random()%3;

carnumberptr = (unsigned int*) arg;
carnumber = (unsigned int) *carnumberptr;

if(turn==LEFT){
turnleft(cardir, carnumber);
} else if(turn==RIGHT){
turnright(cardir, carnumber);
} else {//straight
gostraight(cardir, carnumber);
}

return (void*)carnumberptr;
} 
```

现在，这是我要锁定适当方向的海峡功能。

```
 /*
  cardirection - The direction the car is pointing.  If it is pointing NORTH,
  it is starting from the South-Eastern corner of the intersection
  and "going straight" means it wants to move SOUTH to NORTH.

  valid options: NORTH, SOUTH, EAST, WEST

 carnumber -    The car identifier
*/

static void gostraight(orientation_t cardirection, unsigned int carnumber){

switch(cardirection){
case NORTH:
printf("Car %d, Moving South-North\n", carnumber);
break;
case SOUTH:
printf("Car %d, Moving North-South\n", carnumber);
break;
case EAST:
printf("Car %d, Moving West-East\n", carnumber);
break;
case WEST:
printf("Car %d, Moving East-West\n", carnumber);
break;
}
} 
```

所以，如果接近的汽车从南指向北，那么这辆车就是 SE 车，我会用 lock_SE(CAR) 锁定箱体东、西打印功能？防止其他线程进入和打印？所以我会锁定解锁打印语句？

还是我会锁定整个 switch 语句？

** 编辑：这会是这样做的方法吗？**

```
static void turnleft(orientation_t cardirection, unsigned int carnumber){

int CAR;
CAR = carnumber;

  switch(cardirection){
  case NORTH:
  lock_SE(CAR)
  printf("Car %d, Moving South-West\n", carnumber);
  unlock_SE(CAR)
  break;
  case SOUTH:
  lock_NW(CAR)
  printf("Car %d, Moving North-East\n", carnumber);
  unlock_NW(CAR)
  break;
  case EAST:
  lock_SW(CAR)
  printf("Car %d, Moving West-North\n", carnumber);
  unlock_SW(CAR)
  break;
  case WEST:
  lock_NE(CAR)
  printf("Car %d, Moving East-South\n", carnumber);
  unlock_NE(CAR)
  break;
  } 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T21:04:18.917

这不是一个容易的问题。我将尝试展示两种解决方案。

第一个明显的：整个交集的一个互斥锁，在`turnleft, turnright, gostraight`add的开头`lock(car, intersection_mutex);`，就在每个函数结束之前释放所说的互斥锁。这一次只能让一辆车通过十字路口。这样做的好处是易于理解并且不会导致死锁。缺点是一次只能有一辆车进入，但众所周知，两辆行驶在不相交路径的汽车可以毫无问题地进入。这是一个示例`go_straight()`（其他人遵循相同的方法）：

```
static void gostraight(orientation_t cardirection, unsigned int carnumber){
    pthread_mutex_lock(&intersection_mutex);
    switch(cardirection){
        case NORTH:
            printf("Car %d, Moving South-North\n", carnumber);
            break;
        case SOUTH:
            printf("Car %d, Moving North-South\n", carnumber);
            break;
        case EAST:
            printf("Car %d, Moving West-East\n", carnumber);
            break;
        case WEST:
            printf("Car %d, Moving East-West\n", carnumber);
            break;
        }
    }
    pthread_mutex_unlock(&intersection_mutex);
} 
```

为了一次让不止一辆汽车进入，我们需要一种细粒度的方法。细粒度方法的问题在于它更难实现和正确。两者都`go_straight`需要`turn_left`锁定两个互斥锁（您可能会争辩说左转需要三个......）。因此，如果您不能同时获得两个互斥锁，则需要退出。将其转化为驾驶规则：

```
you must not enter the intersection before you can exit it. 
```

因此，要直行，我们必须首先获得离您最近的互斥体，然后才能退出路径中的下一个互斥体。如果我们不能同时获得两者，我们必须释放我们锁定的那个。如果我们不释放它，我们将死锁。

为此，我将添加两个辅助函数：

```
static void lock_two(pthread_mutex_t *a, pthread_mutex_t *b) {
    while(1) { 
        pthread_mutex_lock(a);
        if(pthread_mutex_trylock(b) == 0) 
            break;
        else
        /* We must release the previously taken mutex so we don't dead lock the intersection */
            pthread_mutex_unlock(a);                            
        pthread_yield(); /* so we don't spin over lock/try-lock failed */
    }
}
static void unlock_two(pthread_mutex_t *a, pthread_mutex_t *b) {
    pthread_mutex_unlock(a);
    pthread_mutex_unlock(b);
} 
```

这是我的直接版本：

```
static void gostraight(orientation_t cardirection, unsigned int carnumber){  
    switch(cardirection){
        case NORTH:
            lock_two(&SE_mutex, &NE_mutex); 
            printf("Car %d, Moving South-North\n", carnumber);
            unlock_two(&SE_mutex, &NE_mutex); 
            break;
        case SOUTH:
            lock_two(&NW_mutex, &SW_mutex); 
            printf("Car %d, Moving North-South\n", carnumber);
            unlock_two(&NW_mutex, &SW_mutex); 
            break;
        case EAST:
            lock_two(&SW_mutex, &SE_mutex); 
            printf("Car %d, Moving West-East\n", carnumber);
            unlock_two(&SW_mutex, &SE_mutex); 
       break;
       case WEST:
            lock_two(&NE_mutex, &NW_mutex); 
            printf("Car %d, Moving East-West\n", carnumber);
            unlock_two(&NE_mutex, &NW_mutex); 
            break;
    }
} 
```

`turn_left`然后将需要遵循相同的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T20:33:28.967

那么这样的事情将适用于直行功能： -

```
static void gostraight(orientation_t cardirection, unsigned int carnumber){
  int CAR;
  cAR = carnumber;

  switch(cardirection){
    case NORTH:
      lock_SE(CAR);
      lock_NE(CAR);
      printf("Car %d, Moving South-North\n", carnumber);
      unlock_NE(CAR);
      unlock_SE(CAR);
      break;
    case SOUTH:
      lock_NW(CAR);
      lock_SW(CAR);
      printf("Car %d, Moving North-South\n", carnumber);
      unlock_SW(CAR);
      unlock_NW(CAR);
      break;
    case EAST:
      lock_SE(CAR);
      lock_SW(CAR);
      printf("Car %d, Moving West-East\n", carnumber);
      unlock_SE(CAR);
      unlock_SW(CAR);
      break;
    case WEST:
      lock_NE(CAR);
      lock_NW(CAR);
      printf("Car %d, Moving East-West\n", carnumber);
      unlock_NW(CAR);
      unlock_NE(CAR);
      break;
  }
} 
```

对于左转，（仅举一个例子）：-

```
switch(cardirection) {
  case NORTH:
    lock_SE(CAR);
    lock_NE(CAR);
    lock_NW(CAR);
    printf("Car %d, Moving South-West\n", carnumber);
    unlock_NW(CAR);
    unlock_NE(CAR);
    unlock_SE(CAR);
    break;
} 
```

对于右转（又是一个例子）：-

```
switch(cardirection) {
  case EAST:
    lock_SW(CAR);
    printf("Car %d, Moving East-South\n", carnumber);
    unlock_SW(CAR);
    break;
} 
```

请注意，为了避免死锁，我总是以 SE、NE、NW、SW 的任意顺序锁定它们。

为什么这行得通？例如，乘坐一辆想要直行向南的汽车和另一辆向北行驶并左转向西的汽车。那么如果左转车先到，它会依次锁定SE、NE和NW，而直行车将无法锁定NW。但是，向东行驶并右转向南的汽车将能够锁定 SW。

因此，该方案将起作用。它不会出现死锁，因为每个函数都以给定的顺序获取锁。因此，永远不会有循环的线程链竞争角点。基本上，如果线程 1 正在等待线程 2 释放锁，那么这意味着线程 2 不需要线程 1 已经获得的任何锁。因此不会出现死锁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T20:14:30.523

我不太确定我理解你需要做什么，但我会尝试解释我的推理。我将从设计开始，因为我想这就是您的问题所在。

你假设一个普通的十字路口，两条路，没有灯，没有标志。任何一辆车都可以从北、南、东、西四个不同方向到达交叉口，每辆车在通过交叉口时可以选择三个不同方向之一。这样，您`4 * 3 = 12`就必须考虑不同的路段，所有路段都不同。

如果汽车在某个时刻穿过某条路径上的交叉路口，它会在 0 个或多个，理论上最多 11 个不同的路段阻塞交通（实际上，至少有两个路段保持空闲，因此限制为 9 个）。这些你必须阻止。顺便说一句，如果你为 12 个不同的部分拍一张照片，它会有所帮助。

如果您想使用互斥锁，则每个部分都需要一个（不一定是汽车）。假设一个右手，左前右的驾驶场景，一辆从南方来的打算直行的汽车会阻塞：

*   一辆从东边直行的汽车；
*   一辆来自东方的汽车向左行驶；
*   一辆从东边驶来的汽车向右行驶；
*   一辆从西边直行的汽车；
*   一辆从西边来的汽车向左行驶；
*   一辆从北方来的汽车向左行驶；

所有其他部分对其他车辆免费。您可以为每个到达/方向对创建此块列表。[您必须指定两辆从相反方向左转的汽车如何相互通过，即从北向左转的汽车是否会阻挡从南向左转的汽车，或者它们是否可以相互通过]

代表每辆车（阅读：线程）阻塞这么多互斥锁（每个部分一个）会带来一个问题：死锁。为了在这里解决这个问题，我建议您为整个交叉点创建一个额外的“主”互斥锁。一辆车到了，

1.  它试图阻止主互斥锁；如果不成功，它会阻塞。
2.  然后它会尝试阻止它需要的每个部分互斥体；如果不成功，释放所有成功锁定的互斥体，解锁主互斥体，等待，然后从1开始重试。
3.  如果它成功阻止了所有需要的部分互斥锁，则解锁主互斥锁，并通过交叉路口（花费时间）。

过了路口后，车

1.  试图阻止主互斥锁；如果不成功，它会阻塞。
2.  它解锁所有获得的部分互斥锁。
3.  它再次解锁主互斥锁。
4.  继续朝着新的方向前进。

[编辑澄清，pthread 互斥体允许尝试锁定和退出] 主互斥体总是很快释放，仅用于查看汽车是否可以获得所有必要的部分互斥体。无论哪种方式，主互斥锁都会在此之后立即释放。

如果没有主互斥锁，您只能通过使用严格的获取互斥锁的顺序来避免死锁。这将使交叉路口局部化：如果两辆车同时到达，一个方向/转弯组合总是会胜过另一辆车。主互斥体避免了这种情况。

# facebook - Facebook like 按钮不显示在 IE 中，仅适用于一个特定页面

> ID：13573835
> 
> 赞同：0
> 
> 时间：2012-11-26T21:56:17.130
> 
> 标签：facebook, facebook-like

我正在为一个在他的页面上有一个赞按钮的客户管理一个页面。奇怪的是它在 IE 中不显示，而在其他浏览器中显示。我使用 facebook 的 iframe 代码：

```
<iframe src="http://www.facebook.com/plugins/like.php?href=URLOFPAGE&amp;send=false&amp;layout=button_count&amp;width=150&amp;show_faces=true&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21&amp;" scrolling="no" frameborder="0" style="border:none; overflow:auto; width:150px; height:21px;" allowTransparency="true"></iframe> 
```

当我使用我自己的 facebook 页面的 url 时，like 按钮可以工作（即使在 IE 中），但是当我使用我的客户端的 url 时它不会。有什么问题？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:49:23.337

尝试检查客户 URL 的长度。我之前发现 URL 太长了。如果他们没有声明一个唯一的 URL（例如 facebook.com/TheClientsName），那么首先这样做，它应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:52:39.197

我找到了解决方案。喜欢按钮没有显示的问题是因为“国家限制”。转到您的页面 -> 管理权限并删除所有国家/地区限制。

现在点赞按钮将显示在所有电脑、手机、平板电脑等上。

# objective-c - 列出包含指定文件 obj c 的目录

> ID：13573837
> 
> 赞同：0
> 
> 时间：2012-11-26T21:56:37.020
> 
> 标签：objective-c, nsfilemanager

我的情况是这样的。我有一个目录 /testdir ，其中包含不同深度的子文件夹。在某些子文件夹中有一个名为 testfile.txt 的文件，其中一些没有。以 URL 形式返回哪些包含此文件的最简单方法是什么？我目前正在使用 NSFileManager

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T04:08:25.030

```
- (void)exproreDirectory:(NSString*)directory
{
    NSError* error = nil;
    NSArray* contents = [[NSFileManager defaultManager] contentsOfDirectoryAtPath:directory error:&error];

    for (NSString* fileItemName in contents)
    {        
        NSString* fileItemPath = [directory stringByAppendingPathComponent:fileItemName];

        NSDictionary* attributes = [[NSFileManager defaultManager] attributesOfItemAtPath:fileItemPath error:&error];

        if ([[attributes fileType] isEqualToString:NSFileTypeDirectory])
        {
            [self exproreDirectory:fileItemPath];
        }
        else if ([[attributes fileType] isEqualToString:NSFileTypeRegular])
        {
            if ([[fileItemPath lastPathComponent] isEqualToString:@"testfile.txt"])
            {
                // found it
            }
        }
    }
} 
```

# c# - 将 C# 与 Matlab 集成

> ID：13573838
> 
> 赞同：1
> 
> 时间：2012-11-26T21:56:37.537
> 
> 标签：c#, matlab, image-processing

我正在尝试将 Matlab 与 C# 集成我做了一个小程序。在图像上应用平均过滤器
，但在这行代码上出现错误

```
Bitmap Array2Image(MWNumericArray num)
    {
        **double[,] array = (double[,])num.ToArray();**...... return bmp;
    } 
```

错误： *混合模式程序集是针对运行时版本“v2.0.50727”构建的，如果没有其他配置信息，则无法在 4.0 运行时中加载。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:58:43.367

看这里; [在 .NET 4.0 项目中引用 .NET 2.0 混合模式程序集需要哪些“附加配置”？](https://stackoverflow.com/questions/2455654/what-additional-configuration-is-necessary-to-reference-a-net-2-0-mixed-mode)

为了使用 CLR 2.0 混合模式程序集，您需要修改 App.Config 文件以包含：

```
<?xml version="1.0"?>
<configuration>
  <startup useLegacyV2RuntimeActivationPolicy="true">
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
  </startup>
</configuration> 
```

关键是 useLegacyV2RuntimeActivationPolicy 标志。这会导致 CLR 使用最新版本 (4.0) 来加载您的混合模式程序集。没有这个，它就行不通。

请注意，这只对混合模式 (C++/CLI) 程序集很重要。您可以加载所有托管的 CLR 2 程序集，而无需在 app.config 中指定它。

# javascript - 确定客户是否使用支持触控的笔记本电脑/台式机的有效方法？

> ID：13573842
> 
> 赞同：2
> 
> 时间：2012-11-26T21:56:53.277
> 
> 标签：javascript, html, css, windows-8, touch

随着新的支持触控的全尺寸 PC 的数量不断增加，有哪些有效的方法可以确定用户是否正在使用这些支持触控的设备之一进行浏览？最好是一种可以检测任何支持触摸的设备（Android、iPad、Windows RT、Windows 8）的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:02:11.973

使用 javascript，这是非常普遍的：

```
if('ontouchstart' in document) {
    // touch events detected
} 
```

每周都会推出新的触摸设备，因此如果您想要最好的检测，使用最新的 Modernizr 可能更安全。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T22:06:26.923

我在之前的项目中使用了以下代码：

```
var is_touch = 'ontouchstart' in document.documentElement;

if(is_touch){
    // Touch capable.

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T22:18:15.553

[Modernizr](http://modernizr.com/docs/#touch)项目有检查触摸功能的方法，但指出没有一种完全可靠的检查方法，因为一些桌面浏览器谎称它们的支持，而一些移动浏览器不支持触摸事件。

各种浏览器的测试结果都[在这里](http://www.browserscope.org/user/tests/table/agt1YS1wcm9maWxlcnINCxIEVGVzdBjGxLICDA)。

# java - 尝试使用 Parse 中的对象在 Android 中填充 ListView

> ID：13573847
> 
> 赞同：3
> 
> 时间：2012-11-26T21:57:01.903
> 
> 标签：java, android, parse-platform

我对 android 非常陌生，对 Parse 非常陌生。我创建了一个名为 StudentInformation 的类，其中包括姓名、地址、电话等列。我想创建一个列表视图，其中包含添加到该班级的所有学生的姓名。

我该怎么做呢？我已经到了可以吐出所有条目的 objectID 的程度，但不知道如何提取名称并将其仅添加到 ListView。

这是代码片段：

```
 //Set up the listview
    studentListView = (ListView)findViewById(R.id.listViewStudents);
    //Create and populate an ArrayList of objects from parse
    ParseQuery query = new ParseQuery("StudentInformation");
    final ArrayList<Object> studentList = new ArrayList<Object>();
    query.findInBackground(new FindCallback() {
        public void done(List<ParseObject> objects, ParseException e) {
            if (e == null) {
                Toast.makeText(getApplicationContext(), objects.toString(), Toast.LENGTH_LONG).show();
                for(int i = 0;i < objects.size(); i++){
                    objects.get(i);
                    studentList.add("name".toString());
                }
            } else {
                Toast.makeText(getApplicationContext(), "Error", Toast.LENGTH_LONG).show();
            }
        }
    });

    //studentList.addAll(Arrays.asList(students));
    listAdapter = new ArrayAdapter<Object>(this,android.R.layout.simple_list_item_1,studentList);
    studentListView.setAdapter(listAdapter);
} 
```

我把吐司留在了我在 public void done.... 方法中吐出 objectID 的地方。

一如既往，我们将不胜感激任何帮助。

应该提到（可能），不会抛出任何错误，在 toast 消失后列表视图永远不会被填充。

不知道这是否会对任何人有所帮助，但我从下面的两个帖子中获取了一些信息，并提出了这个：

```
 //Set up the listview
    studentList = new ArrayList<String>();
    //Create and populate an ArrayList of objects from parse
    listAdapter = new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1);
    studentListView = (ListView)findViewById(R.id.listViewStudents);
    studentListView.setAdapter(listAdapter);
    final ParseQuery query = new ParseQuery("StudentInformation");
    query.findInBackground(new FindCallback() {
        public void done(List<ParseObject> objects, ParseException e) {
            if (e == null) {
                //Toast.makeText(getApplicationContext(), objects.toString(), Toast.LENGTH_LONG).show();
                for (int i = 0; i < objects.size(); i++) {
                    Object object = objects.get(i);
                    String name = ((ParseObject) object).getString("name").toString();
                    listAdapter.add(name);
               }
            } else {
                Toast.makeText(getApplicationContext(), "Error", Toast.LENGTH_LONG).show();
            }
        }
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T02:41:56.093

您在这里有 2 个问题：1）您的 listAdapter 包含列表中显示的数据。您需要在运行查询之前创建它并让您的查询直接将值添加到 listAdapter。然后，您需要在完成填充后调用 listAdapter.notifyDataSetChanged()，以便使用新数据重新绘制列表。2) 将值添加到 studentList 的函数是添加“name”.toString()。您可能想调用 studentList.add(objects.get(i));

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T01:44:03.640

```
public void parseRetrieveAll(View view) throws ParseException {
 findViewById(R.id.listView1);
 ParseQuery query = new ParseQuery("TestObject");
 query.orderByDescending("foo");
 query.findInBackground(new FindCallback() {
 public void done(List<ParseObject> categories, ParseException e) {
    if (e == null) {
       for (int i = 0; i < categories.size(); i++) {
       String c = categories.get(i).getString("foo");
       foos.add(c); 
    } 
} else {
     Toast.makeText(getApplicationContext(), "Error",
    Toast.LENGTH_LONG).show();
    }
    } 
});
ListView lv = (ListView) findViewById(R.id.listView1);
ArrayAdapter<String> arrayAdapter = new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1, foos);
lv.setAdapter(arrayAdapter);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T03:35:42.277

可能这个教程会帮助你。[检查](http://www.androidhive.info/2012/01/android-json-parsing-tutorial/)一次..

并检查这个[如何从 Json 填充列表视图](https://stackoverflow.com/questions/6277154/populate-listview-from-json)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-09T01:48:22.020

```
Here is What I did:
* "foo" is the column name in my  "TestObject", which is my ParseObject
1: Inside the For Loop I added each value to a ListArray<String>
String c = categories.get(i).getString("foo");
foos.add(c);

2\. Once Completed I Added the String Array to my ListView
ListView lv = (ListView) findViewById(R.id.listView1);
ArrayAdapter<String> arrayAdapter = new ArrayAdapter<String>(this,
android.R.layout.simple_list_item_1, foos);
lv.setAdapter(arrayAdapter);
3\.  After that It worked.  Make sure that you declare the ArrayList<String> in your class.

Example:
ArrayList<String> foos = new ArrayList<String>(); 
```

# r - 无法安装跳跃包，dyn.load 中的错误（文件，DLLpath = DLLpath，...）[Mac OSX]

> ID：13573848
> 
> 赞同：3
> 
> 时间：2012-11-26T21:57:12.450
> 
> 标签：r

我正在尝试为 R 安装跳跃包，但我一直遇到一个奇怪的错误。谷歌搜索似乎没有发现任何有用的东西。我尝试在其他计算机上安装并确认它可以工作。

```
> install.packages("leaps")
Installing package(s) into ‘/usr/local/Cellar/r/2.15.2/R.framework/Versions/2.15/Resources/library’
(as ‘lib’ is unspecified)
trying URL 'http://ftp.ussg.iu.edu/CRAN/src/contrib/leaps_2.9.tar.gz'
Content type 'application/x-gzip' length 26847 bytes (26 Kb)
opened URL
==================================================
downloaded 26 Kb

* installing *source* package ‘leaps’ ...
** libs
/usr/local/bin/gfortran   -fPIC   -c leaps.f -o leaps.o
/usr/local/bin/gfortran   -fPIC   -c leapshdr.f -o leapshdr.o
cc -dynamiclib -Wl,-headerpad_max_install_names -undefined dynamic_lookup -single_module -multiply_defined suppress -L/usr/local/lib -o leaps.so leaps.o leapshdr.o -L/usr/local/Cellar/gfortran/4.2.4-5666.3/lib/gcc/i686-apple-darwin11/4.2.1/x86_64 -L/usr/local/Cellar/gfortran/4.2.4-5666.3/lib/gcc/i686-apple-darwin11/4.2.1 -L/usr/local/Cellar/gfortran/4.2.4-5666.3/lib/gcc -L/usr/local/Cellar/gfortran/4.2.4-5666.3/lib -lgfortran -F/usr/local/Cellar/r/2.15.2/R.framework/.. -framework R -Wl,-framework -Wl,CoreFoundation
installing to /usr/local/Cellar/r/2.15.2/R.framework/Versions/2.15/Resources/library/leaps/libs
** R
** preparing package for lazy loading
** help
*** installing help indices
** building package indices
** testing if installed package can be loaded
Error in dyn.load(file, DLLpath = DLLpath, ...) : 
  unable to load shared object '/usr/local/Cellar/r/2.15.2/R.framework/Versions/2.15/Resources/library/leaps/libs/leaps.so':
  dlopen(/usr/local/Cellar/r/2.15.2/R.framework/Versions/2.15/Resources/library/leaps/libs/leaps.so, 6): Symbol not found: __gfortran_transfer_character_write
  Referenced from: /usr/local/Cellar/r/2.15.2/R.framework/Versions/2.15/Resources/library/leaps/libs/leaps.so
  Expected in: flat namespace
 in /usr/local/Cellar/r/2.15.2/R.framework/Versions/2.15/Resources/library/leaps/libs/leaps.so
Error: loading failed
Execution halted
ERROR: loading failed
* removing ‘/usr/local/Cellar/r/2.15.2/R.framework/Versions/2.15/Resources/library/leaps’
Warning in install.packages :
  installation of package ‘leaps’ had non-zero exit status

The downloaded source packages are in
    ‘/private/var/folders/ts/f_f4vqnx02d5pzbt6zqp5wt00000gn/T/Rtmp3tg6VV/downloaded_packages’ 
```

我尝试从不同的镜像安装并​​从源安装。如果相关，这是 sessionInfo() 的输出：

```
> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: x86_64-apple-darwin12.2.0 (64-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
[1] tools_2.15.2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-05T14:31:15.500

看看[https://github.com/hadley/devtools/issues/373](https://github.com/hadley/devtools/issues/373)上的讨论。问题似乎与`Rcpp`包裹有关。

# iphone - 如何在帮助类中触发委托方法

> ID：13573849
> 
> 赞同：0
> 
> 时间：2012-11-26T21:57:15.677
> 
> 标签：iphone, objective-c, xcode, delegates

好的，伙计们。这可能有点新手，但我很难弄清楚如何在我拥有的 helperclass 中触发 NSURLConnection 委托。

问题如下：

我有一个 ViewController 将执行登录到 Web 服务。我从我的角度设置了“连接”对象。

在连接类中，我设置了一个请求对象（NSMutableURLRequest *request）

然后我设置连接。

```
NSURLConnection *connection=[[NSURLConnection alloc] initWithRequest:request delegate:self];
if (connection) {

    [UIApplication sharedApplication].networkActivityIndicatorVisible = YES;
    dataWebService = [NSMutableData data];
    [connection start];
} else {
    // Inform the user that the connection failed.
} 
```

线索是，当我在视图控制器内的 ViewController 类（放置所有委托）中执行此操作时，委托会自动触发，我可以登录到 Web 服务。

如何从“连接类”中的视图控制器调用这些委托？

```
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
- (void)connectionDidFinishLoading:(NSURLConnection *)connection 
```

我需要这个，因为我将使用这个连接类从其他视图执行其他任务。在我拥有的每一个视图中都写这些代表有点矫枉过正。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:24:13.833

你可能会说把 NSURLConnection 和它的委托方法放在你需要的地方有点过头了，但它绝对是最干净的解决方案。

使用委托时，您应该有 1 个发送者（在本例中为 NSURLConnection）和 1 个接收者（在本例中为 ViewController）。您想要做的是不断更改该接收器或拥有多个接收器，我不完全确定。你可以做。如果您想重用 NSURLConnection （从而保留 1 个接收器），您可以简单地将其委托更改为当时需要它的任何类。这可能很难跟踪。如果您只想将 1 个连接的结果传递给其他类（多个接收器），您可以实现一次委托方法并使用 NSNotifications 将结果发送到注册为观察者的每个类。但是通知不能返回值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T00:50:20.260

您可以在连接类中有一个方法，例如 downloadFromURL:sender:，您可以从任何类调用该方法。当你调用它时，你提供 URL 并提供 self 作为 sender 参数。连接类将有一个属性，比如发送对象，您可以将其设置为发送者：

```
-(void)downloadFromURL:(NSURL *) url sender:(id) sender {
    _receivedData = [[NSMutableData alloc] init];
    sendingObject = sender;
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL: url cachePolicy: NSURLCacheStorageAllowedInMemoryOnly timeoutInterval: 30.0];
    [NSURLConnection connectionWithRequest:request delegate:self];
} 
```

在这个类中实现所有的委托方法，在 connectionDidFinishLoading: 方法中，你可以这样做：

```
-(void) connectionDidFinishLoading:(NSURLConnection *)connection {
    [sendingObject performSelector:@selector(resultFromDownloader:) withObject:_receivedData];
} 
```

这将允许您处理数据（在 resultFromDownloader 中：）但是您需要在任何调用此方法的类中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T03:19:12.570

完全避开代表怎么样？在 iOS5 或更高版本中，您可以运行连接并在一个块中处理响应，如下所示：

```
[NSURLConnection sendAsynchronousRequest:request 
                                   queue:[NSOperationQueue mainQueue]
                       completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
        // handle response, data and error here
    }]; 
```

使用这种方法，你可以让一个类回答一个 NSURLConnection，另一个类用一个块来运行它。或者，您可以创建一个类来创建连接并使用作为参数传递的块来运行它。

# html - HTML 中的 SVG - 根据页面宽度重新调整路径大小

> ID：13573850
> 
> 赞同：7
> 
> 时间：2012-11-26T21:57:28.303
> 
> 标签：html, svg

我的文档中有一个 SVG 元素，它通过 css 具有 100% 的宽度。这只会重新调整 svg 元素的大小；它不会调整路径的大小。这是我的路径代码：

```
<path id="quadcurveABC" d="M 0 300 q 300 0 500 -100 l 0 100 z" stroke="black" stroke-width="2" fill="black" /> 
```

我需要将 x 分量`M`与屏幕左侧对齐，但我也需要将 500 与`q 300 0 500 -100`屏幕右侧对齐。我将如何做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-27T05:04:31.940

给你的 SVG 元素一个[`viewBox`属性](http://www.w3.org/TR/SVG/coords.html#ViewBoxAttribute)来指定要显示的内容：

```
<svg … viewBox="0 200 500 100"> 
```

基本上就是说，*“这张图片的内容是 500 单位宽和 100 单位高，从 0x,200y 开始；请务必保持可见”*

在行动中看到：

## [http://jsfiddle.net/jGnST/](http://jsfiddle.net/jGnST/)

[当 CSS 指定的纵横比与 viewBox 的纵横比不匹配时，请阅读该[`preserveAspectRatio`属性以了解有关如何进一步控制图像的裁剪、缩放和对齐的更多详细信息。](http://www.w3.org/TR/SVG/coords.html#PreserveAspectRatioAttribute)]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:30:57.583

确保您的 svg 根元素具有与封闭的 html 元素相同大小的视口。

# grails - 使用 SpringSecurityCore 引导程序

> ID：13573852
> 
> 赞同：2
> 
> 时间：2012-11-26T21:57:36.497
> 
> 标签：grails, groovy, spring-security

最近刚开始在 Groovy 中编程并且已经卡住了。我正在尝试创建可用于在我的引导程序中登录的用户，我已经看过许多教程，尽管复制和粘贴代码，我还是遇到了许多错误。我现在已经开始编写似乎可以运行但用户根本不存在的代码。

我究竟做错了什么？

```
import grails.timesecurity.*
import timetracker2.*

class BootStrap {
    def springSecurityService

    def init = { servletContext ->

        def examples = [
            'rob' : [username: 'rob', password: 'password']
        ]

        def userRole = Authority.findByAuthority("ROLE_USER") ?: new Authority(authority: "ROLE_USER").save()
        def adminRole = Authority.findByAuthority("ROLE_ADMIN") ?: new Authority(authority: "ROLE_ADMIN").save()

        if(!Person.count())
        {
            userRole = new Authority(authority: 'ROLE_USER').save()

            //String password = springSecurityService.encodePassword('password')

            def user = new Person(
                username: "Rob",
                password: springSecurityService.encodePassword("Password"),
                enabled: true
                )
            PersonAuthority.create user, userRole
            //def user = new Person['Rob', password, enabled: true].save()
        }       
    }

    def destroy = {}
} 
```

能帮上忙的都是传奇！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T22:12:59.743

您不调用`save()`Person 实例。但是，一旦解决了这个问题，您将无法登录，因为您正在关注旧教程或博客文章，并且您正在显式编码密码。但是生成的 Person 类已经这样做了，所以它将被双重编码。为了进一步混淆，您正在使用 ROLE_USER 创建第二个权限。

尝试这个：

```
def userRole = Authority.findByAuthority("ROLE_USER") ?: new Authority(authority: "ROLE_USER").save()
def adminRole = Authority.findByAuthority("ROLE_ADMIN") ?: new Authority(authority: "ROLE_ADMIN").save()

if (!Person.count()) {

   def user = new Person(
      username: "Rob",
      password: "Password",
      enabled: true).save()

   PersonAuthority.create user, userRole
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:10:40.073

首先，我打赌你需要打电话`save()`给你的新`Person`. 之后，确保您的`Person`对象正在验证。

# c# - 为什么在 Windows Phone 7 中无法播放此音频？

> ID：13573854
> 
> 赞同：0
> 
> 时间：2012-11-26T21:57:43.527
> 
> 标签：c#, windows-phone-7, audio, invalidoperationexception, soundeffect

我正在尝试在我的 Silverlight for Windows Phone 7 应用程序中播放音频。我有一个 MP3 音频文件，其构建操作设置为资源。要播放声音，我使用：

```
SoundEffectInstance sfi = null;
...
        Stream source = Application.GetResourceStream(new Uri("/Bird Calls;component/Crow.mp3", UriKind.Relative)).Stream;
        Microsoft.Xna.Framework.Audio.SoundEffect effect = SoundEffect.FromStream(source);
        sfi = effect.CreateInstance();
        sfi.Play(); 
```

此代码在 SoundEffect.FromStream 方法中引发 InvalidOperationException。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T04:26:30.667

SoundEffect 无法播放 mp3 文件。如果你想播放 mp3 文件，你应该像这样使用 MediaPlayer

```
private Song song;

string musicUrl = string.Format("/Bird Calls;component/Crow.mp3");
song = Song.FromUri("name", new Uri(musicUrl, UriKind.Relative));
FrameworkDispatcher.Update();
MediaPlayer.IsRepeating = true;
MediaPlayer.Play(song); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T23:05:59.877

我自己想通了。此问题的解决方案是使用 .wav 文件而不是 .mp3 文件。

# java - 流和进程的防御性副本

> ID：13573857
> 
> 赞同：0
> 
> 时间：2012-11-26T21:58:06.150
> 
> 标签：java, process, reference, stream, defensive-copy

我正在`Process proc`运行，如果发生错误，我需要销毁并重新创建它。
这是因为通过标准输入向无法解决的进程发送命令时出现问题。
我的解决方法是重置我建立的“连接”（stdin、stdout、stderr）并从新进程中获取新流。当进程结束时，我正在使用线程进行观察。如果发生错误，我会通过退出命令关闭进程并中断导致它最终关闭流的线程。
主线程已经在建立一个新的连接。在重建连接后发送命令时，IOException 状态流已关闭。
有没有办法可以复制旧流以稍后关闭它？我已经尝试过用另一个阅读器包装它，但没有成功。我不确定通过 getXXXStream() 获取进程的流并关闭它们是否足够，因为这不会关闭上面的读者。另外我担心，我可以抓住新进程并关闭它的流。
我不希望它阻止。
**编辑：** 正如我的第一条评论所述，我立即关闭了流，但问题`Process`仍然存在。如果我要等待 1000 毫秒来关闭它并使用新的重新分配 proc，`Process`我的线程将使用新的线程运行（例如调用`exitValue()`）。

这是我的主题：

```
private class ProcEndWatcherThread extends Thread
{
    private BufferedReader out, err;
    private PrintWriter wr;

    public ProcEndWatcherThread(BufferedReader out, BufferedReader err,  `PrintWriter wr)`
    {
        this.out = out;
        this.err = err;
        this.wr = wr;

        //this.out = new BufferedReader(out);
        //this.err = new BufferedReader(err);
        //this.wr = new PrintWriter(wr);
    }
    @Override
    public void run()
    {
        boolean closed = false;
        try
        {
            isRunning = true;
            proc.waitFor();
            closed = true;
        }
        catch (InterruptedException e)
        {
            Thread.currentThread().interrupt();
        }
        finally
        {
            if(!closed)
                proc.destroy();         

            try {
                out.close();
                err.close();
            } catch (IOException e) {
                log.throwing("ProcEndWatcherThread", "run", e);
            }
            wr.close();
            isRunning = false;
            log.info("Exitvalue: " + proc.exitValue());
        }
    }
} 
```

建立我的连接的方法（连接+重新连接）：

```
private void initCon() throws RException, IOException
{
            proc = new ProcessBuilder(pathAndArgs).start();
            System.out.println(proc.toString());
            errRd = new BufferedReader(new InputStreamReader(
                    proc.getErrorStream()));
            outRd = new BufferedReader(new InputStreamReader(
                    proc.getInputStream()));
            BufferedWriter inWr = new BufferedWriter(new

OutputStreamWriter(new BufferedOutputStream(
                        proc.getOutputStream())));
            pWr = new PrintWriter(inWr);

            procEndWatcherThread = new ProcEndWatcherThread(outRd, errRd, pWr);
            procEndWatcherThread.start();
... some initializing
} 
```

# jquery-ui-dialog - 从按钮调用时，Jquery UI 对话框/模态表单消失

> ID：13573858
> 
> 赞同：1
> 
> 时间：2012-11-26T21:58:12.840
> 
> 标签：jquery-ui-dialog

好的，这是我的问题，我直接从 Jquery UI 站点复制了 jquery UI 模式/对话框代码，并且该示例运行良好。模态弹出一个表格，整个事情完美无缺。当我尝试从表单中调用相同的对话框（尝试添加新记录）时，对话框会在屏幕上闪烁，然后被隐藏。如果我从表单中删除调用对话框的按钮并将其放置在它之前或之后再次正常工作。驾驶。我。疯狂的。

下面的代码：

```
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>jQuery UI Dialog - Modal form</title>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.1/themes/base/jquery-ui.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.js"></script>
    <script src="/resources/demos/external/jquery.bgiframe-2.1.2.js"></script>
    <script src="http://code.jquery.com/ui/1.9.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="/resources/demos/style.css" />
    <style>
        body { font-size: 62.5%; }
        label, input { display:block; }
        input.text { margin-bottom:12px; width:95%; padding: .4em; }
        fieldset { padding:0; border:0; margin-top:25px; }
        h1 { font-size: 1.2em; margin: .6em 0; }
        div#users-contain { width: 350px; margin: 20px 0; }
        div#users-contain table { margin: 1em 0; border-collapse: collapse; width: 100%; }
        div#users-contain table td, div#users-contain table th { border: 1px solid #eee; padding: .6em 10px; text-align: left; }
        .ui-dialog .ui-state-error { padding: .3em; }
        .validateTips { border: 1px solid transparent; padding: 0.3em; }
    </style>
    <script>
    $(function() {
        var name = $( "#name" ),
            email = $( "#email" ),
            password = $( "#password" ),
            allFields = $( [] ).add( name ).add( email ).add( password ),
            tips = $( ".validateTips" );

        function updateTips( t ) {
            tips
                .text( t )
                .addClass( "ui-state-highlight" );
            setTimeout(function() {
                tips.removeClass( "ui-state-highlight", 1500 );
            }, 500 );
        }

        function checkLength( o, n, min, max ) {
            if ( o.val().length > max || o.val().length < min ) {
                o.addClass( "ui-state-error" );
                updateTips( "Length of " + n + " must be between " +
                    min + " and " + max + "." );
                return false;
            } else {
                return true;
            }
        }

        function checkRegexp( o, regexp, n ) {
            if ( !( regexp.test( o.val() ) ) ) {
                o.addClass( "ui-state-error" );
                updateTips( n );
                return false;
            } else {
                return true;
            }
        }

        $( "#dialog-form" ).dialog({
            autoOpen: false,
            height: 300,
            width: 350,
            modal: true,
            buttons: {
                "Create an account": function() {
                    var bValid = true;
                    allFields.removeClass( "ui-state-error" );

                    bValid = bValid && checkLength( name, "username", 3, 16 );
                    bValid = bValid && checkLength( email, "email", 6, 80 );
                    bValid = bValid && checkLength( password, "password", 5, 16 );

                    bValid = bValid && checkRegexp( name, /^[a-z]([0-9a-z_])+$/i, "Username may consist of a-z, 0-9, underscores, begin with a letter." );
                    // From jquery.validate.js (by joern), contributed by Scott Gonzalez: http://projects.scottsplayground.com/email_address_validation/
                    bValid = bValid && checkRegexp( email, /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i, "eg. ui@jquery.com" );
                    bValid = bValid && checkRegexp( password, /^([0-9a-zA-Z])+$/, "Password field only allow : a-z 0-9" );

                    if ( bValid ) {
                        $( "#users tbody" ).append( "<tr>" +
                            "<td>" + name.val() + "</td>" + 
                            "<td>" + email.val() + "</td>" + 
                            "<td>" + password.val() + "</td>" +
                        "</tr>" ); 
                        $( this ).dialog( "close" );
                    }
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function() {
                allFields.val( "" ).removeClass( "ui-state-error" );
            }
        });

        $( "#create-user" )
            .button()
            .click(function() {
                $( "#dialog-form" ).dialog( "open" );
            });
    });
    </script>
</head>
<body>

<div id="dialog-form" title="Create new user">
    <p class="validateTips">All form fields are required.</p>

    <form>
    <fieldset>
        <label for="name">Name</label>
        <input type="text" name="name" id="name" class="text ui-widget-content ui-corner-all" />
        <label for="email">Email</label>
        <input type="text" name="email" id="email" value="" class="text ui-widget-content ui-corner-all" />
        <label for="password">Password</label>
        <input type="password" name="password" id="password" value="" class="text ui-widget-content ui-corner-all" />
    </fieldset>
    </form>
</div>

<div id="users-contain" class="ui-widget">
    <h1>Existing Users:</h1>
    <table id="users" class="ui-widget ui-widget-content">
        <thead>
            <tr class="ui-widget-header ">
                <th>Name</th>
                <th>Email</th>
                <th>Password</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>John Doe</td>
                <td>john.doe@example.com</td>
                <td>johndoe1</td>
            </tr>
        </tbody>
    </table>
</div>

<form id="myform">
    <button id="create-user">Create new user</button>
</form>    

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:14:09.527

有趣的。如果您使用输入而不是按钮，它可以正常工作。

```
<form id="myform">
    <input value="Create new user" id="create-user" />
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T08:41:07.127

在里面写你的 jquery 代码`function pageLoad() {}`而不是`$(function() {});`. 希望这对你有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T22:19:13.713

除了 webNoob 的回答之外，问题在于按钮周围的标签。`<Form>`构造需要一个`<input>`按钮（type="button" 或 type="submit"）。

# java - 尝试在 Java 中创建 FileReader 时出现 FileNotFoundException

> ID：13573862
> 
> 赞同：1
> 
> 时间：2012-11-26T21:58:27.650
> 
> 标签：java, filenotfoundexception

```
import java.io.*;

public class Roi {

    public static void main( String[] args) {
        FileReader fReader = new FileReader("input.csv");

    }
} 
```

我有上面的代码，我正在尝试为 csv 文件创建 FileReader，但我不断收到 FileNotFoundException。我刚刚安装了 Eclipse，所以我没有设置任何特殊路径或任何东西，但是如果我将输入文件保存在项目目录中，这不应该工作吗？

我已经尝试将输入文件放在项目目录、project\src 目录和 project\bin 目录中，但似乎都不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:00:23.813

将文件放在文件夹/项目中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:02:37.210

如果你进入菜单 Run -> Run Configurations 然后选择 Arguments 选项卡，你会在底部附近找到一个用于运行的目录的设置。将此设置为 input.csv 所在的任何位置。

（UI 描述假定为 Eclipse Juno，但对于旧版本应该类似）

# linux - 为什么这个 awk 命令不起作用

> ID：13573869
> 
> 赞同：-1
> 
> 时间：2012-11-26T21:58:50.660
> 
> 标签：linux, bash, shell, unix, awk

所以问题是：

使用 awk 按顺序显示文件中的所有行，仅显示数量和产品名称。产品名称是第一个字段，数量是第二个字段。数据文件是“库存”

清点内容：

```
Strawberry Jam,300,4

Raspberry Jam,1216,7

Blueberry Jam,96,195

Strawberry Compote,49,621

Raspberry Compote,1937,624

Blueberry Compote,200,625

Frozen Strawberries,130,1941

Straw Hats,16,2047 
```

我的命令是

```
awk '$2 $1' inventory 
```

那应该有效吗？我也试过喜欢

```
awk '{print $2 $1}' inventory
awk '$2, $1' inventory 
```

以及很多变体，但没有一个有效！任何人都可以帮助找出原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:13:07.853

那是一个`csv` *（逗号分隔值）*文件，因此`field separator`需要指定为`,`使用该`-F`选项。

```
$ awk -F, '{print $2,$1}' inventory

300 Strawberry Jam
1216 Raspberry Jam
96 Blueberry Jam
49 Strawberry Compote
1937 Raspberry Compote
200 Blueberry Compote
130 Frozen Strawberries
16 Straw Hats 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:14:23.117

开始了：

```
awk 'BEGIN{FS=OFS=","} {print $2, $1}' inventory 
```

# matlab - 使用 MATLAB 的符号工具箱简化表达式的系数

> ID：13573872
> 
> 赞同：0
> 
> 时间：2012-11-26T21:59:04.920
> 
> 标签：matlab, symbols, symbolic-math

假设我有以下 MATLAB 代码。

```
syms a b c1 c2

c1 = a + b + pi*b
c2 = a + b + 0.5*b 
```

然后 c1 被评估为`a + b + pi*b`， c2 被评估为`a + (3*b)/2`

但是，我需要 MATLAB 来计算 a 和 b 系数的双精度值，而不仅仅是符号数。

我该怎么做呢？例如，我希望 c1 被评估为`a + 4.1416*b`，而 c2 被评估为`a+ 1.5*b`

还假设我对做 c1*c2、c1*5 之类的算术感兴趣，我希望将 a 和 b 的系数评估为双精度数字，而不是像分数这样的抽象符号表达式。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T10:15:25.647

符号表达式不能包含精确的“双精度”数字，但您可以获得浮点数：

```
c1 = a + b + vpa(pi)*b 
```

或者

```
c2 = vpa(a + b + 0.5*b) 
```

某些计算，如`solve`or `int`，仍会在内部切换为精确数字，但您的结果应始终具有浮点形式。

您可以使用以下方法更改计算中使用的精度`digits`：

```
digits(16) % double doesn't have more either 
```

# java - 列表 作为 GET 方法的输入

> ID：13573874
> 
> 赞同：0
> 
> 时间：2012-11-26T21:59:10.003
> 
> 标签：java, string, list, jersey

我有一个 REST 服务。GET 方法的输入类型是`List<String>`：

```
@GET
@Consumes({MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON})
public List<myObject> getData(List<String> IDs) {
    ....
} 
```

我尝试使用 curl 测试此方法。我使用了很多不同的数据组合：

```
curl -X GET --data-binary '{"IDs":["TestString1","TestString2"]}' -H "Content-Type: application/json" http://localhost:8080/myModule/rs/getData -v
                          '{"TestString1","TestString2"}'
                          '["TestString1","TestString2"]'
                           so on 
```

但我总是得到回应：

```
Can not deserialize instance of java.util.ArrayList out of START_OBJECT token
or
Can not deserialize instance of java.util.ArrayList out of VALUE_STRING token 
```

是否可以将输入设置为`List<String>`？我的 curl 请求不正确吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T22:15:24.463

看起来您正在[发送 POST 请求](http://curl.haxx.se/docs/manpage.html#--data-binary)：

> --data-binary <数据>
> 
> (HTTP) 这 完全按照指定的方式**发布**数据，没有任何额外的处理。

由于[`-X`设置了自定义请求类型](http://curl.haxx.se/docs/manpage.html#-X)，我猜它没有检测到它需要对数据进行 URL 编码：

> -X, --request <命令>
> 
> (HTTP) 指定与 HTTP 服务器通信时使用的**自定义请求方法。**将使用指定的请求而不是其他使用的方法（默认为 GET）。阅读 HTTP 1.1 规范以获取详细信息和解释。常见的附加 HTTP 请求包括 PUT 和 DELETE，但 WebDAV 等相关技术提供 PROPFIND、COPY、MOVE 等。

所以尝试使用[`-G`](http://curl.haxx.se/docs/manpage.html#-G)：

> -G，--得到
> 
> 使用时，此选项将使所有使用 -d、--data 或 --data-binary 指定的数据在 HTTP GET 请求中使用，而不是在其他情况下使用的 POST 请求中使用。数据将附加到带有“？”的 URL 分隔器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:47:20.923

我找到了解决方案:)

方法签名应该是

```
@GET
@Consumes({MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON})
public List<myObject> getData(@QueryParam("myParamName") List<String> IDs) {
    ....
} 
```

卷曲请求

```
curl -X GET -H "Content-Type: application/json" http://localhost:8080/myModule/rs/getData?myParamName={dfsf,ddsfdss,sdfsf} -v 
```

有用 ：）

# windows-8 - 如何在没有额外转换器和属性的情况下绑定到 XAML 集合中的最新元素

> ID：13573881
> 
> 赞同：0
> 
> 时间：2012-11-26T21:59:52.050
> 
> 标签：windows-8, microsoft-metro

我需要绑定到集合中的第一个和最后一个元素。首先是一项简单的任务 = {Binding Items[0]} 但最后一个是另一回事 - 我尝试过 Items[Items.Count-1] 但没有运气。

项目 - 列表

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T07:19:29.170

事实证明，您只能使用绝对索引器值，例如 Items[2]。唯一的解决方案是自定义绑定（转换器、附加属性等）

# paypal - 贝宝自适应支付

> ID：13573882
> 
> 赞同：0
> 
> 时间：2012-11-26T21:59:54.157
> 
> 标签：paypal, paypal-adaptive-payments

我想向两个收货人付款，即买家以 100 的价格购买商品，收货人 1 得到 90，收货人 2 得到 10。我正在使用链式付款方式。我在接收者 1 的帐户中获得 100，这没问题，但我无法获得接收者 2 的付款。接收者的帐户 ID 已设置，但此处未给出。我做错了什么？谢谢

```
<?php
require_once('../includes/config.php');
require_once('../includes/paypal.class.php');

$PayPalConfig = array(
                      'Sandbox' => $sandbox,
                      'DeveloperAccountEmail' => $developer_account_email,
                      'ApplicationID' => $application_id,
                      'DeviceID' => $device_id,
                      'IPAddress' => $_SERVER['REMOTE_ADDR'],
                      'APIUsername' => $api_username,
                      'APIPassword' => $api_password,
                      'APISignature' => $api_signature,
                      'APISubject' => $api_subject
                    );

$PayPal = new PayPal_Adaptive($PayPalConfig);

$PayRequestFields = array(
                        'ActionType' => 'PAY_PRIMARY',                              
                        'CancelURL' => $domain.'cancel.php',                        
                        'CurrencyCode' => 'USD',                                
                        'FeesPayer' => 'EACHRECEIVER',                                  
                        'IPNNotificationURL' => '',                         
                        'Memo' => '',                                       
                        'Pin' => '',                                        
                        'PreapprovalKey' => '',                              
                        'ReturnURL' => $domain.'return.php',                                    
                        'ReverseAllParallelPaymentsOnError' => '',          
                        'SenderEmail' => '',                                
                        'TrackingID' => ''                                  
                        );

$ClientDetailsFields = array(
                        'CustomerID' => '',                                 
                        'CustomerType' => '',                               
                        'GeoLocation' => '',                                
                        'Model' => '',                                      
                        'PartnerName' => ''                                 
                        );

$FundingTypes = array('ECHECK', 'BALANCE', 'CREDITCARD');                   

$Receivers = array();
$Receiver = array(
                'Amount' => '100.00',                                           
                'Email' => 'receiver1accountid',                                                
                'InvoiceID' => '',                                          
                'PaymentType' => 'GOODS',                                       
                'PaymentSubType' => '',                                     
                'Phone' => array('CountryCode' => '', 'PhoneNumber' => '', 'Extension' => ''), 
                'Primary' => 'true'                                             
                );
array_push($Receivers,$Receiver);

$Receiver = array(
                'Amount' => '10.00',                                            
                'Email' => 'receiver2accountid',                                                
                'InvoiceID' => '',                                          
                'PaymentType' => 'GOODS',                                       
                'PaymentSubType' => '',                                     
                'Phone' => array('CountryCode' => '', 'PhoneNumber' => '', 'Extension' => ''), 
                'Primary' => 'false'                                                
                );
array_push($Receivers,$Receiver);

$SenderIdentifierFields = array(
                                'UseCredentials' => ''                      
                                );

$AccountIdentifierFields = array(
                                'Email' => '',                              
                                'Phone' => array('CountryCode' => '', 'PhoneNumber' => '', 'Extension' => '')                               
                                );

$PayPalRequestData = array(
                    'PayRequestFields' => $PayRequestFields, 
                    'ClientDetailsFields' => $ClientDetailsFields, 
                    'FundingTypes' => $FundingTypes, 
                    'Receivers' => $Receivers, 
                    'SenderIdentifierFields' => $SenderIdentifierFields, 
                    'AccountIdentifierFields' => $AccountIdentifierFields
                    );

$PayPalResult = $PayPal->Pay($PayPalRequestData);

if(!$PayPalResult)
    {
        $errors = array('Errors'=>$PayPalResult['Errors']);

echo '<pre />';
print_r($errors);
exit();
    }
    else
    {

        header('Location: '.$PayPalResult['RedirectURL']);

$ExecutePaymentFields = array(
                            'PayKey' => $PayPalResult['PayKey'],                                
                            'FundingPlanID' => ''                           
                            );

$PayPalRequestData = array('ExecutePaymentFields' => $ExecutePaymentFields);

$PayPalResult = $PayPal->ExecutePayment($PayPalRequestData);
if(!$PayPalResult)
    {
        $errors = array('Errors'=>$PayPalResult['Errors']);

echo '<pre />';
print_r($errors);
exit();
    }
    else
    {

echo '<pre />';
print_r($PayPalResult);
}
}

?> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T06:53:30.307

您的问题是使用 PAY_PRIMARY 而不仅仅是 PAY。根据 PayPal 的文档...

> 仅对于链式付款，指定此值以延迟向辅助接收方付款；只处理对主要收款人的付款。

你真的需要推迟它，或者你只是在分裂之后？看起来你正试图同时触发它们，所以真的不需要延迟。

在您的情况下，您可以像您一样简单地设置主要和次要接收者，然后使用 PAY 而不是 PAY_PRIMARY 的 ActionType 调用 Pay。这仍会将其拆分为链式付款（买家在结账时只能看到主要收款人），但次要收款人会像您预期的那样同时收到付款。

根据我的理解，我已经调整了您的代码以执行您想要的操作...

```
<?php
require_once('../includes/config.php');
require_once('../includes/paypal.class.php');

$PayPalConfig = array(
                      'Sandbox' => $sandbox,
                      'DeveloperAccountEmail' => $developer_account_email,
                      'ApplicationID' => $application_id,
                      'DeviceID' => $device_id,
                      'IPAddress' => $_SERVER['REMOTE_ADDR'],
                      'APIUsername' => $api_username,
                      'APIPassword' => $api_password,
                      'APISignature' => $api_signature,
                      'APISubject' => $api_subject
                    );

$PayPal = new PayPal_Adaptive($PayPalConfig);

$PayRequestFields = array(
                        'ActionType' => 'PAY',                              
                        'CancelURL' => $domain.'cancel.php',                        
                        'CurrencyCode' => 'USD',                                
                        'FeesPayer' => 'EACHRECEIVER',                                  
                        'IPNNotificationURL' => '',                         
                        'Memo' => '',                                       
                        'Pin' => '',                                        
                        'PreapprovalKey' => '',                              
                        'ReturnURL' => $domain.'return.php',                                    
                        'ReverseAllParallelPaymentsOnError' => '',          
                        'SenderEmail' => '',                                
                        'TrackingID' => ''                                  
                        );

$ClientDetailsFields = array(
                        'CustomerID' => '',                                 
                        'CustomerType' => '',                               
                        'GeoLocation' => '',                                
                        'Model' => '',                                      
                        'PartnerName' => ''                                 
                        );

$FundingTypes = array('ECHECK', 'BALANCE', 'CREDITCARD');                   

$Receivers = array();
$Receiver = array(
                'Amount' => '100.00',                                           
                'Email' => 'receiver1accountid',                                                
                'InvoiceID' => '',                                          
                'PaymentType' => 'GOODS',                                       
                'PaymentSubType' => '',                                     
                'Phone' => array('CountryCode' => '', 'PhoneNumber' => '', 'Extension' => ''), 
                'Primary' => 'true'                                             
                );
array_push($Receivers,$Receiver);

$Receiver = array(
                'Amount' => '10.00',                                            
                'Email' => 'receiver2accountid',                                                
                'InvoiceID' => '',                                          
                'PaymentType' => 'GOODS',                                       
                'PaymentSubType' => '',                                     
                'Phone' => array('CountryCode' => '', 'PhoneNumber' => '', 'Extension' => ''), 
                'Primary' => 'false'                                                
                );
array_push($Receivers,$Receiver);

$SenderIdentifierFields = array(
                                'UseCredentials' => ''                      
                                );

$AccountIdentifierFields = array(
                                'Email' => '',                              
                                'Phone' => array('CountryCode' => '', 'PhoneNumber' => '', 'Extension' => '')                               
                                );

$PayPalRequestData = array(
                    'PayRequestFields' => $PayRequestFields, 
                    'ClientDetailsFields' => $ClientDetailsFields, 
                    'FundingTypes' => $FundingTypes, 
                    'Receivers' => $Receivers, 
                    'SenderIdentifierFields' => $SenderIdentifierFields, 
                    'AccountIdentifierFields' => $AccountIdentifierFields
                    );

$PayPalResult = $PayPal->Pay($PayPalRequestData);

if($PayPal->APICallSuccessful($PayPalResult['Ack']))
{
    // Redirect to PayPal so user can complete payment.
    header('Location: '.$PayPalResult['RedirectURL']);
}
else
{
    // Error    
    echo '<pre />';
    print_r($PayPalResult['Errors']);
    exit();
}
?> 
```

同样，您无需担心在这种情况下使用 ExecutePayment。它只会将用户重定向到他们完成付款的 PayPal，然后他们将像现在一样返回到您的 RedirectURL，但同时会触发二次付款。

如果您确实出于某种原因确实想延迟二次付款（大多数人最终会在触发二次付款之前等待一天/一周/等），那么请告诉我，我可以为您提供帮助。

另一个提示：如果您使用的[是我的库的最新版本，](http://www.angelleye.com/download-angell-eye-php-class-library-for-paypal/)其中包含一个新功能 PayWithOptions，它将允许您在组合中包含 SetPaymentOptions()，这样您就可以提供有关付款的更多详细信息而无需设置额外的调用靠自己。我建议使用这个。一切都将设置相同，但它带有一些您可以设置的附加参数，这些参数对不同的项目很有用。

# c# - 检索系统日期

> ID：13573885
> 
> 赞同：1
> 
> 时间：2012-11-26T21:59:58.380
> 
> 标签：c#, datetime

我需要使用 C# 检索当前系统日期，而不是实际日期，然后使用循环减去 3 个月来获得前 3 个月。我以为你可以这样做：

```
DateTime currMonth = DateTime.Now.AddMonths(-3); 
```

我的印象是 DateTime.Now 实际上给了你当前的系统日期，但根据测试我的代码的人说它没有得到日期。

任何见解或资源都会很棒！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-26T22:01:30.587

`DateTime.Now`为您提供*本地*系统日期/时间，因此：

*   这取决于系统时钟
*   这取决于系统时区

*听起来*这就是你所追求的。目前尚不清楚“它没有得到日期”是什么意思，但它看起来对我来说是正确的，假设上述两个都是你想要的。为了更清楚地表明您只需要日期，我建议使用[`DateTime.Today`](http://msdn.microsoft.com/en-us/library/system.datetime.today.aspx)虽然，它相当于`DateTime.Now.Date`.

# python - 无法在 pyinstaller 中链接所有文件

> ID：13573892
> 
> 赞同：3
> 
> 时间：2012-11-26T22:00:23.813
> 
> 标签：python, windows, distribution, paramiko, pyinstaller

抱歉，我知道这可能是一个菜鸟问题，但我对 Python 相当熟悉，但对任何类型的分发方法都不熟悉。我正在尝试为我制作的连接到 SSH 服务器并上传一些文件的 python 程序打包/创建一个 exe。我在 Ubuntu 中开发，但我打算将它提供给使用 windows 的朋友。

好的，我们开始吧。

我正在使用模块：os、sys、platform、tkMessageBox、webbrowser、re、Tkinter、tkFileDialog 和 paramiko

在名为 App 的目录中，我有以下文件：text1.txt、text2.txt、text3.txt、app.py、script.sh 和所有模块

运行后`python pyinstaller.py app.py`这是我的规范文件的样子

```
# -*- mode: python -*-  
a = Analysis(['app.py'],  
             pathex=['C:\\Users\\Ben\\pyinstaller\\pyinstaller-2.0'],  
             hiddenimports=[],  
             hookspath=None)  
pyz = PYZ(a.pure)  
exe = EXE(pyz,  
          a.scripts,  
          exclude_binaries=1,  
          name=os.path.join('build\\pyi.win32\\app', 'app.exe'),  
          debug=False,  
          strip=None,  
          upx=True,  
          console=False )  
coll = COLLECT(exe,  
               a.binaries,  
               a.zipfiles,  
               a.datas,  
               strip=None,  
               upx=True,  
               name=os.path.join('dist', 'app'))  
app = BUNDLE(coll,  
             name=os.path.join('dist', 'app.app')) 
```

我只是想知道如何让我的所有文件链接到 exe 中。因为它运行 gui，但没有任何功能起作用。我应该在最后压缩所有文件并分发吗？我对整个分发事务很陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T19:04:22.750

尝试在 a.scripts, 行之后添加此行

```
Tree('your\\path\\here'), 
```

我知道如果创建单个文件可执行文件它会起作用。虽然不确定其他人。确保路径是包含所有文本文件的文件夹的路径，而不是文本文件本身的路径。

# jquery - 单击其他 attr('href') 时的 JQuery TAB

> ID：13573894
> 
> 赞同：1
> 
> 时间：2012-11-26T22:00:43.887
> 
> 标签：jquery, tabs, click

我的 jquery 脚本中有这段代码：

```
 $('.content-box ul.content-box-tabs li a ').click( // When a tab is clicked...

 function () { 
 $(this).parent().siblings().find("a").removeClass('current'); // Remove "current" class from all tabs      
 $(this).addClass('current'); // Add class "current" to clicked tab
 var currentTab = $(this).attr('href'); // Set variable "currentTab" to the value of href of clicked tab
 $(currentTab).siblings().hide(); // Hide all content divs
 $(currentTab).show(); // Show the content div with the id equal to the id of clicked tab
 return this;
  }
 ); 
```

并且此代码可能会查看 php：

```
<div class="content-box-header">

<h3>Content box</h3>

   <ul class="content-box-tabs">
     <li><a href="#tab1" id="tab1">Table</a></li> <!-- href must be unique and match the id of target div -->
     <li><a href="<?php echo site_url('examples/country_management')?>" id="tab2">Countries</a></li>
     <li><a href="<?php echo site_url('examples/channel_management')?>" id="tab3">Channels</a></li>
     <li><a href="<?php echo site_url('examples/programs_management/')?>" id="tab4" class="default-tab">Programs</a></li>
  </ul>

  <div class="clear"></div> 
```

现在。我需要在 .attr('href') 或 .prop('href') 中使用其他属性，而不是 href，而是 id、title...仅在加载过程中有效。如果我使用其他属性 href 我的选项卡链接目录是正确的选项卡不起作用。

你能帮助我吗。对不起我的英语不好。谢谢。

# objective-c - 使用 Interface Builder 硬编码 UITableView ：有可能吗？

> ID：13573895
> 
> 赞同：2
> 
> 时间：2012-11-26T22:00:46.827
> 
> 标签：objective-c, ios, xcode, uitableview, interface-builder

有时，我想创建非常简单的 UITableViews。例如，我想创建一个看起来像这样的视图：http: [//blogs.remobjects.com/wp-content/uploads/2011/10/DatePicker-in-action.png](http://blogs.remobjects.com/wp-content/uploads/2011/10/DatePicker-in-action.png)

在这种情况下，我觉得最好在 InterfaceBuilder 中硬编码我的 UITableViewCell，而不是在我的 tableview 事件中动态创建它们。这样，我就不会用太多代码污染我的班级。

问题是 Interface Builder 不允许我将 UITableViewCell 放在 UITableView 中。那么，有没有办法存档我想做的事情，或者这只是我应该避免做的不好的做法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T22:08:05.787

你当然可以这样做！只需使用情节提要，选择带有静态单元格的表格视图，然后根据您的需要创建单元格。以您喜欢的方式为它们设置样式，并用您想要的数据预先填充它们。

是的，在 Interface Builder 中尽可能多地减少类的代码是非常好的做法！

# sql - 全文搜索查询的问题

> ID：13573907
> 
> 赞同：0
> 
> 时间：2012-11-26T22:01:47.617
> 
> 标签：sql, join, full-text-search

我在尝试运行此全文搜索查询时遇到问题。我需要对两个表进行全文搜索。如果任何一个表中有任何条款，我需要从第一个表中返回记录。

```
select R.* from Request R 
    inner join Patients P on R.PatientID = P.PatientID
    inner join containstable(Request,(*),@keywords)AS KEY_TBL 
    ON R.RequestID = KEY_TBL.[Key] 
    full outer join 
    (select R.* from Request R 
    inner join Patients P on R.PatientID = P.PatientID
    inner join containstable(Patients,(*),@keywords) AS KEY_TBL2 
    ON P.PatientID = KEY_TBL2.[Key]) as b on R.RequestID = b.RequestID 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T18:49:45.150

我所需要的只是一个联合而不是一个完整的外部连接。

```
select R.* from Request R 
    inner join Patients P on R.PatientID = P.PatientID
    inner join containstable(Request,(*),@keywords)AS KEY_TBL 
    ON R.RequestID = KEY_TBL.[Key] 
    UNION
    select R.* from Request R 
    inner join Patients P on R.PatientID = P.PatientID
    inner join containstable(Patients,(*),@keywords) AS KEY_TBL2 
    ON P.PatientID = KEY_TBL2.[Key] 
```

# java - Android JSONObject - 我如何循环通过一个平面 JSON 对象来获取每个键和值

> ID：13573913
> 
> 赞同：111
> 
> 时间：2012-11-26T22:02:33.480
> 
> 标签：java, android, json

```
{
  "key1": "value1",
  "key2": "value2",
  "key3": "value3"
} 
```

在事先不知道键或值的情况下，如何获取每个项目的键和值？

* * *

## 回答 #1

> 赞同：326
> 
> 时间：2012-11-26T22:06:29.450

使用[`keys()`](http://developer.android.com/reference/org/json/JSONObject.html#keys%28%29)迭代器迭代所有属性，并[`get()`](http://developer.android.com/reference/org/json/JSONObject.html#get%28java.lang.String%29)为每个属性调用。

```
Iterator<String> iter = json.keys();
while (iter.hasNext()) {
    String key = iter.next();
    try {
        Object value = json.get(key);
    } catch (JSONException e) {
        // Something went wrong!
    }
} 
```

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2013-08-24T19:01:16.157

Short version of Franci's answer:

```
for(Iterator<String> iter = json.keys();iter.hasNext();) {
    String key = iter.next();
    ...
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-02-04T01:20:37.667

You'll need to use an `Iterator` to loop through the keys to get their values.

Here's a Kotlin implementation, you will realised that the way I got the string is using `optString()`, which is expecting a String or a nullable value.

```
val keys = jsonObject.keys()
while (keys.hasNext()) {
    val key = keys.next()
    val value = targetJson.optString(key)        
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-26T22:07:27.003

你应该使用`keys()`or`names()`方法。 `keys()`会给你一个包含对象中所有字符串属性名称的迭代器，同时`names()`会给你一个包含所有关键字符串名称的数组。

您可以在此处获取 JSONObject 文档

[http://developer.android.com/reference/org/json/JSONObject.html](http://developer.android.com/reference/org/json/JSONObject.html)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-11-26T22:06:38.643

看看 JSONObject 参考：

[http://www.json.org/javadoc/org/json/JSONObject.html](http://www.json.org/javadoc/org/json/JSONObject.html)

在不实际使用该对象的情况下，看起来使用返回 Iterator 的 getNames() 或 keys() 是可行的方法。

# css - 等间距的 div。多行

> ID：13573914
> 
> 赞同：1
> 
> 时间：2012-11-26T22:02:34.777
> 
> 标签：css

我在页面上显示了一个视频缩略图列表。当然它们不适合一行，所以使用了多行，我希望它们间隔相等（在其他情况下布局看起来很糟糕）。我当前的标记是

```
.thumbs {
 width: 76%;
 float: left;
 margin: 0px 1em;
 text-align: justify;
 background-color: #DEE;
}

.thumb {
 display: inline-block;
 text-align: left;
} 
```

标记是：

```
 <div class="thumbs">
                <div class="thumb">
                    <img src="http://placehold.it/160x120">
                    <div class="title">Test</div>
                </div>
                <div class="thumb">
                    <img src="http://placehold.it/160x120">
                    <div class="title">Test</div>
                </div>
                <!-- and so forth... -->
            </div> 
```

在 JsFiddle 中相同：http: [//jsfiddle.net/cPm9f/](http://jsfiddle.net/cPm9f/)

除了最后一行，一切都很好：我希望它与前一行一样，但空间不同:(我不能使用表格或只是填充一堆不可见的存根元素，因为这是响应式设计的基础，所以数量显示的列将取决于设备屏幕的宽度。

任何想法如何使最后一行空间与前一行空间相等？

**UPD：** cimmanon 认为我想要的应该以不同的方式实现。如果是，那怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T01:45:42.797

您的问题是对“文本对齐：对齐”的解释。最后一行通常是不合理的，因为如果最后一行很短，字母就需要有一个荒谬的间距。

解决方法：

```
text-align: justify;
text-align-last: justify; 
```

但据我所知`text-align-last`，只有 IE **[EDIT: 和 Mozilla with `-moz-text-align-last`]**支持，所以让我们为其他人伪造另一行合理的文本：

```
.thumbs:after { display: inline-block; width: 100%; content: ""; } 
```

[http://jsfiddle.net/TWgDh/](http://jsfiddle.net/TWgDh/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:05:27.210

```
.thumb:last-child {
    float:right;
}
​ 
```

? :)

[http://jsfiddle.net/cPm9f/1/](http://jsfiddle.net/cPm9f/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T22:15:27.663

如上所述，您可以使用它，但请注意， IE9 以下的任何 IE 浏览器都不支持[last-child](https://developer.mozilla.org/en-US/docs/CSS/%3alast-child) CSS 伪类。我不知道你打算支持什么，但值得知道。然而，在早期版本的 IE 中， [first-child](https://developer.mozilla.org/en-US/docs/CSS/%3afirst-child)伪类有*一些支持。*

# vb.net - 在我的 winform 标签中使用自定义字体

> ID：13573916
> 
> 赞同：4
> 
> 时间：2012-11-26T22:02:42.860
> 
> 标签：vb.net, visual-studio-2010

我想知道是否可以为我的表单标签使用自定义字体而不将其安装在用户机器上？我想使用我有权使用的字体显示文本，但它没有安装在潜在的用户机器上。

有什么解决方案吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-26T22:05:40.243

这是摘录（使用[PrivateFontCollection](http://msdn.microsoft.com/en-us/library/system.drawing.text.privatefontcollection.aspx)）：

```
Dim pfc As New PrivateFontCollection()
pfc.AddFontFile("C:\Path To\PALETX3.ttf")
label1.Font = New Font(pfc.Families(0), 16, FontStyle.Regular) 
```

从这里转换：[加载并使用自定义字体而不安装它](http://www.codeproject.com/Articles/107377/Load-And-Use-Custom-Font-Without-Installing-It)。

另请检查：[Embedding/deploying custom font in .NET app](https://stackoverflow.com/questions/3007805/embedding-deploying-custom-font-in-net-app)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-15T12:33:37.720

在代码顶部添加此代码

```
Imports System.Drawing.Text 
```

在 Form1_Load() 上添加此代码以更改 Labell1.Font

```
Dim customfont As PrivateFontCollection = New PrivateFontCollection
customfont.AddFontFile("C:\maven.ttf")
Label1.Font = New Font(customfont.Families(0), 10) 
```

在 Visual Basic 2010 企业版上测试

# sql-server - Excel 中 OLAP SSAS 多维数据集数据透视表的替代方法

> ID：13573919
> 
> 赞同：8
> 
> 时间：2012-11-26T22:03:02.773
> 
> 标签：sql-server, excel, mdx, pivot-table

我正在使用 Excel 2007 数据透视表访问 2005 SQL Server 上的 OLAP SSAS 多维数据集，并发现刷新某些表需要超过 10 分钟。我的同事似乎认为这是一个可悲的现实，但我想知道是否有其他我应该研究的替代方案。

我曾经有过的一些想法：

显然，如果我可以升级服务器硬件我会，但我只是一个没有这种权力的分析师，所以我不认为硬件改进是一个很好的选择。迁移到更新的 SQL 服务器也是如此，我想这也会加快进程。

更新到更新版本的 excel 会加快这个过程吗？

我遇到了这个： http: [//olappivottableextend.codeplex.com/](http://olappivottableextend.codeplex.com/)，它让我可以访问 MDX，这显然是低效的（听起来像 VBA 的宏记录器对我来说），所以会改变 MDX（我知道一点点，它为数据透视表提供的查询似乎并不复杂）是一种选择吗？

在excel之外运行MDX是一种选择吗？我可以编写查询，但我想它不会像数据透视表那么简单。

看起来 OLAP 多维数据集在很多方面都是一个很好的解决方案，这些是一些处理大量信息的大型数据透视表，但是如果有一种合理的方法可以加快整个过程，我很想了解更多关于它的信息.

谢谢你的想法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-28T14:06:17.537

访问 SSAS 多维数据集的方法有很多，但这取决于您要实现的目标。

Excel 往往被企业使用，因为

*   它已经安装
*   这是一个熟悉的商业工具
*   便于使用
*   无需开发人员干预

Excel 访问多维数据集的其他替代方法包括

*   SQL Server Analysis Services (management studio) 通过多维数据集浏览器或 mdx 直接
*   SQL Server 报告服务
*   利用 AdomdConnection 进行定制开发（例如 c#）
*   通过 OpenQuery 的 SQL Server（管理工作室）

如果到目前为止您一直在使用 Excel 来访问多维数据集，那么您可能会认为其他工具都不能完全满足您的需求，并且您最终会坚持使用它。

假设 Excel 是适合您的工具，那么您应该继续了解它为什么慢。可能性列表（不包括硬件/软件）很长，但这里有一些；

*   可能是网络/数据库/磁盘资源上的外部争用（对您的项目而言）。数据量可能会随着时间的推移而累积。
*   多维数据集可能未分区。
*   您提出的问题可能会变得更加复杂。
*   多维数据集聚合可能无法满足您的需求。
*   多维数据集分区可能丢失
*   立方体结构可能效率低下，因为它支持多对多关系
*   用户/查询量可能增加

为了尝试解决这个问题，我会

*   评估您在多维数据集中所需的数据（并可能将多维数据集限制为滚动的 x 月窗口）
*   记录您的查询并应用基于使用的优化
*   通过 SQL Server Profiler 监控多维数据集使用情况
*   检查立方体设计的结构
*   尝试使用其他工具（通过网络和多维数据集本地）进行类似查询，以确定问题所在
*   如果您确定 Excel 是周点[Excel、多维数据集公式、Analysis Services、性能、网络延迟和连接字符串](http://www.ssas-info.com/analysis-services-articles/53-excel/2296-excel-cube-formulas-analysis-services-performance-network-latency-and-connection-strings)或[Excel、多维数据集公式、分析服务、性能、网络延迟和连接字符串](http://blogs.msdn.com/b/sqlcat/archive/2013/10/23/sqlcat-com-ebook-downloads.aspx)（即SQLCAT's Guide to BI and Analytics 第 57 页）

# android - 将进度对话框保持在顶部

> ID：13573923
> 
> 赞同：2
> 
> 时间：2012-11-26T22:03:24.247
> 
> 标签：android, progressdialog

我有一个带有进度对话框的应用程序（`pd = new ProgressDialog(ActivityName.this); ... pd.show();`由- 如果我改变屏幕方向，对话框会重新出现）。

有没有办法让对话框保持在顶部（即禁用对话框外的点击）？

注意：在模拟器中，点击按预期被禁用，在真实手机（SGII，A4.0.4）上，点击进度对话框的周围关闭对话框......

代码：

```
mProgressDialog = new ProgressDialog(DownloaderActivity.this); 
mProgressDialog.setMessage(DownloaderActivity.this.getString(R.string.downloadin‌​gfile));      
mProgressDialog.setIndeterminate(false); 
mProgressDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);   
mProgressDialog.show(); … mProgressDialog.dismiss(); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-26T22:24:05.697

将 setCanceledOnTouchOutside() 方法设置为 false。 [看看android API](http://developer.android.com/reference/android/app/Dialog.html#setCanceledOnTouchOutside%28boolean%29)

如果你已经这样做了，但它仍然无法正常工作，那可能是安卓系统的一个错误。解决此问题的一种方法是使用 onCancelListener ，以便在取消对话框时，侦听器中的代码检查进度是否完成。如果没有，它可以重新启动对话框。

# javascript - 用 iFrame 替换所有对象标签 - 第一次替换后停止 - Javascript

> ID：13573924
> 
> 赞同：1
> 
> 时间：2012-11-26T22:03:27.040
> 
> 标签：javascript, jquery, windows-8, replacewith

尝试编写用 iFrame 替换所有 YouTube 对象标签的 Javascript 代码。相反，我编写的函数将替换 first `<object>`，然后停止并丢弃之后的所有内容 said `<object>`。

如果我使用不同的元素，例如换行符`<br>`，它将成功替换所有`<object>`标签，`<br>`并且不会丢失任何内容。

```
function editVideoObjects(htmlContent) {

        // Index all the objects and add ID tags
        var objectTags = htmlContent.querySelectorAll("object");
        var numberOfObjects = objectTags.length;

        for (var r = 0; r < numberOfObjects; r += 1) {
            objectTags[r].setAttribute("id", "video" + r)
        }

        for (var j = 0; j < numberOfObjects; j += 1) {
            var currentObject = htmlContent.getElementById("video" + j);

            var videoEmbed = currentObject.querySelector("embed");
            if (videoEmbed != null) {
                var videoSrc = videoEmbed.getAttribute("src");
                //Script specific for YouTube videos.
                if (videoSrc.split(".")[1] == "youtube") {
                    var newSrc = videoSrc.replace("/v/", "/embed/");
                    var iFrame = document.createElement("iframe");
                    iFrame.setAttribute("src", newSrc);
                    iFrame.setAttribute("height", currentObject.getAttribute("height"));
                    iFrame.setAttribute("width", currentObject.getAttribute("width"));
                    iFrame.setAttribute("frameborder", "0");
                    iFrame.setAttribute("allowfullscreen");
                    iFrame.setAttribute("id", "iFrameVideo" + j);
                    $(currentObject, htmlContent).replaceWith(iFrame);
                    }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:33:08.283

找到了解决方案！我将函数保存为外部文件，以便`<head>`在调用相应文章时附加到主 DOM 中，而不是嵌套在主 Javascript 文件中。

```
function itemInvoked(e) {
        var currentArticle = articlesList.getAt(e.detail.itemIndex);
        WinJS.Utilities.setInnerHTMLUnsafe(articlecontent, currentArticle.content);
        var videoScript = document.createElement("script");
        videoScript.type = "text/javascript";
        videoScript.src = "/js/videoEditScript.js"
        document.getElementsByTagName("head")[0].appendChild(videoScript);
        articlelist.style.display = "none";
        articlecontent.style.display = "";
        mainTitle.innerHTML = currentArticle.title; 
        WinJS.UI.Animation.enterPage(articlecontent);
    } 
```

# jquery - jQuery文本调整大小问题

> ID：13573925
> 
> 赞同：1
> 
> 时间：2012-11-26T22:03:34.543
> 
> 标签：jquery, css

我正在尝试遍历一些文本范围，并根据这样做所需的最小字体大小调整文本大小以适应其包含的 div。

```
<div id="preview">        
        <div id="test">
            <section class="slide">
                <span>Lorem ipsum dolor sit amet, consectetur adipiscing elit.<br />
                Nam in mauris a magna elementum ornare vel at velit.<br />
                Nulla facilisi.<br />
                Sed eu odio id urna fermentum imperdiet eget sit amet enim.</span>
            </section>

            <section class="slide">
                <span>Cras cursus ante et tortor placerat sodales.<br />
                Curabitur libero quam, cursus sit amet feugiat id, elementum at lectus.<br />
                Integer volutpat aliquet massa at adipiscing.<br />
                Vivamus purus leo</span>
            </section>
         </div><!--/ #test -->
    </div><!--/ #preview --> 
```

到目前为止，我必须这样做的 jquery 是

```
var fontSizeArray = [];

$('#test > .slide').children('span').each(function () {
    var currentFontSize = parseInt($(this).css('font-size'));
    do {
        currentFontSize = currentFontSize + 1;
        $(this).css('font-size', currentFontSize);            
    } while ($(this).width() < $('#test').width());
    fontSizeArray.push(currentFontSize);
});

var smallest = Math.min.apply( null, fontSizeArray );      

$('#test > .slide').children('span').each(function () {
    $(this).css('font-size', smallest);
});​ 
```

我创建了一个小提琴来更好地说明这一点。

[http://jsfiddle.net/H7nrY/4/](http://jsfiddle.net/H7nrY/4/)

基本上所有文本都应该调整大小以适应 div #test

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:36:33.530

在循环之后添加一个条件，检查你是否走得太远：

```
if ($(this).width() > $("#test").width()) {
   currentFontSize--;
} 
```

[http://jsfiddle.net/H7nrY/5/](http://jsfiddle.net/H7nrY/5/)

# jquery-mobile - 如何删除jquery Mobile Un-grouped，Multiple collapsibles之间的额外空格

> ID：13573929
> 
> 赞同：1
> 
> 时间：2012-11-26T22:03:47.370
> 
> 标签：jquery-mobile

如何摆脱下面每个可折叠之间的额外空间？（请参见下面的图片链接） - 我正在尝试节省屏幕空间并需要将它们堆叠在一起。

注意：我的每个可折叠（例如电子邮件、Une、Resold）都是独立的，可以随意打开或关闭（非手风琴类型）。

[https://dl.dropbox.com/u/58096637/jqm_collapsible2.jpg](https://dl.dropbox.com/u/58096637/jqm_collapsible2.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T15:49:12.047

[这是](http://jsfiddle.net/Gajotres/WPpfZ/)给你的一个例子：

这是使用的 jQuery 代码：

```
// Remove space between collapsible elements
$('div[data-role="collapsible"]').addClass('new-class');
// Remove rounded corners
$('div[data-role="collapsible"] h3 a').removeClass('ui-corner-bottom ui-corner-top ui-btn-up-c').addClass('ui-btn-up-c-custom');
// Fix borders so collapsible elements can overlap properly
$('div:last-child[data-role="collapsible"] h3 a').addClass('ui-btn-up-c-custom-last'); 
```

# java - 使方法最终，如果我们真的想强制执行

> ID：13573933
> 
> 赞同：0
> 
> 时间：2012-11-26T22:04:06.683
> 
> 标签：java, oop, design-patterns

我仍然首先阅读工厂模式。我们有一个 PizzaStore 示例，并试图本地化我们的 PizzaStore 类，以让加盟商自由地拥有自己的区域风格。

为此，我们将 PizzaStore 类更改为抽象类，并将工厂对象移动到“abstract createPizza(String type);” 方法。没关系，我明白为什么了。

如果你看图片，我在句子下划线。这是什么意思 ？“**如果我们真的想强制执行**，我们可以让方法最终化吗？”

![在此处输入图像描述](../Images/9ebfae0c457a3ba985e8b315521f375b.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T22:06:56.163

关键是子类应该实现`createPizza`，但合同要求**不要**覆盖`orderPizza`，只需调用它。可以通过将方法设为 final 来强制执行此策略。

当您为继承设计一个类时，您通常必须注意与该类应该如何扩展有关的所有细节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T22:08:08.457

如果您使方法最终继承该方法的类不能覆盖它。这确保了 PizzaStore 中的实现被所有子类使用。

来源：[http ://docs.oracle.com/javase/tutorial/java/IandI/final.html](http://docs.oracle.com/javase/tutorial/java/IandI/final.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T22:06:08.877

将方法声明为`final`可防止子类覆盖它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-26T22:06:16.820

如果您将 orderPizza 方法设为**final**，则不能`override`在您的**子类**中，但您仍然可以访问它们。标有 final 的方法不能在您的子类中被覆盖。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-26T22:06:30.950

最终方法不能被覆盖，因此任何继承类都具有相同的方法，它们被强制具有相同的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-26T22:07:35.257

这意味着`ChicagoStylePizzaStore`不允许覆盖 orderPizza()。

java final 关键字：`final orderPizza()`
强制子类不能覆盖该方法。

然后芝加哥类必须从 PizzaStorre() 调用 orderPizza()，而不是从自己的同名方法调用。

# php - 在 Pods / Wordpress 中保存新的 pod 项目/记录后，如何将用户重定向到详细信息页面？

> ID：13573934
> 
> 赞同：1
> 
> 时间：2012-11-26T22:04:11.797
> 
> 标签：php, wordpress, redirect, hook, podscms

保存新的 pod 项目后，我想将用户重定向到新创建记录的详细信息页面。我怎样才能做到这一点？

我尝试使用 post_save 挂钩，但没有奏效。我使用了以下代码：

```
function redirect_to_detail($data, $is_new_item) {
  $pod_type = $data['params']['pod'];
  $id = $data['params']['id'];
  wp_redirect( home_url() . "/{$pod_type}/{$id}" ); exit;
}

add_filter('pods_api_post_save_pod_item', 'redirect_to_detail', 10, 2); 
```

pod 项目是由这样的短代码创建的：

```
[pods name="egitim" form="1" fields="name, salon" label="Kaydet"] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T22:32:46.357

试试这个：

`[pods name="egitim" form="1" fields="name, salon" label="Kaydet" thank_you="/egitim/X_ID_X/"]`

# vb.net - 在 My.Settings 字符串中编码变量并动态解析

> ID：13573938
> 
> 赞同：1
> 
> 时间：2012-11-26T22:04:39.010
> 
> 标签：vb.net, variables, my.settings

我希望能够获取如下字符串并放入 MySettings 并让应用程序动态解析表达式。那可能吗？

* * *

名称：ClientName
类型：字符串
范围：应用程序
值：MyData(i).FirstName & " " & MyData(i).LastName

* * *

Dim name As String = My.Settings.ClientName

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:15:57.427

如果只使用简单的 String 类，这是不可能做到的。您要么必须创建一个方法来解析它，要么创建自己的对象类型来进行解析。无论哪种方式，它都需要您编写代码来解析该数据。

如果您在解析数据方面需要一些帮助，请使用上面的示例，解析起来很简单。

```
Dim s As String = "First Last"
Dim names() As String = s.Split(" "c)

Dim firstName As String = names(0)
Dim lastName As String = names(1) 
```

我也不确定您的 MyData 对象是什么。您可以在该对象中放置一个解析例程，以自动解析名称并根据需要设置属性。它甚至可以是构造函数的一部分。

```
Public Sub DoWhateverINeedToDo()
    Dim md As New MyData(My.Settings.ClientName)

    Console.WriteLine("First Name: " & md.FirstName)
    Console.WriteLine("Last Name: " & md.LastName)
End Sub

Public Class MyData

    Public Property FirstName As String
    Public Property LastName As String

    Public Sub New(ByVal fullName As String)
        Dim names() As String = fullName.Split(" "c)

        Me.FirstName = names(0)
        Me.LastName = names(1)
    End Sub

End Class 
```

# vim - 我希望 Vim 在缓冲区方面能够像 Photoshop 一样保存和关闭？

> ID：13573942
> 
> 赞同：2
> 
> 时间：2012-11-26T22:04:49.300
> 
> 标签：vim

这是我对 Vim 的问题：你将它打开了几天。您已准备好关闭 vim。您不一定要保存所有文件......您想跳过任何没有修改更改的文件，并且您希望留下（或被询问）您想对未修改更改的剩余缓冲区做什么…</p>

对于用过Photoshop的人来说，这很熟悉……你用了一个星期，当你关闭Photoshop时，它真的是在试图关闭应用程序，并跳过所有没有触及的文件，让你选择你喜欢的东西想要处理剩余的文件，然后自行关闭。

似乎每次我关闭 Vim 时，我都必须经历这种马戏团`:qa`，然后运行到一个文件中，运行`:bd!`，然后`:qa`再次运行，运行到一个我想要的文件`:w`，这只是一个巨大的痛苦。必须有更好的方法来做到这一点。

如果还不是很明显……我`:set hidden`在我的`.vimrc`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T09:15:17.397

怎么样

```
:confirm qa 
```

它会询问您对于每个修改过的文件是保存还是放弃它（或所有剩余的）。当您通过窗口标题中的 X 关闭 GVIM 时，这与 GVIM 表现出的行为相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:12:21.080

`:xa!`能解决你的问题吗？

```
:xa[ll]!    Write all changed buffers, even the ones that are readonly,
        and exit Vim.  If there are buffers without a file name or
        which cannot be written for another reason, Vim will not quit. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T19:07:05.460

我能够找到插件 BufOnly，然后在 StackOverflow 上其他人的帮助下，得到了一个令我满意的答案：

[https://stackoverflow.com/a/14690570/240287](https://stackoverflow.com/a/14690570/240287)

# unit-testing - 无法在 64 位操作系统中使用 NativeConsole.Instance 写入gallio.echo 控制台

> ID：13573945
> 
> 赞同：1
> 
> 时间：2012-11-26T22:04:56.123
> 
> 标签：unit-testing, 64-bit, mbunit, gallio

使用 Windows 7 32 位，我能够使用 Gallio.Runtime.ConsoleSupport.NativeConsole.Instance.WriteLine("") 将文本输出到 Gallio.Echo 运行器。但我在 Windows 7 64 位中失败了。有没有办法实现它？我正在使用 Gallio 捆绑包 3.4.14。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T20:48:14.600

你可以试试：

```
Gallio.Framework.DiagnosticLog.WriteLine("message"); 
```

我没有在 Windows 7 中测试过，只是在 Vista 中测试过。

您可能会发现以下答案也很有用：[https ://stackoverflow.com/a/9775222/13441](https://stackoverflow.com/a/9775222/13441)

# c# - c# - 逐行处理大文件 - 优化

> ID：13573948
> 
> 赞同：0
> 
> 时间：2012-11-26T22:05:07.957
> 
> 标签：c#, multithreading, file-processing

因此，我目前正在尝试研究在 c# 中处理大文件的最佳方法。我们目前有一个包含 1000 万多行数据的大文件。最初，我的客户说该文件将包含数万行，因此我们之前将每一行写入一个新文件，并由我们的接口引擎提取以进行处理。然而，现在我们看到这些文件比预期的要大得多，处理需要一个周末。我正在尝试优化我们的逻辑，并正在研究实现它的最佳方法。我试图让多个线程从单个文件中读取，但磁盘 I/O 的机械瓶颈并没有提供太大的改进空间。下一个方法是读取每一行并在单独的线程上处理每一行（或一组行）。这将给我们一些优化，因为每行的处理可以同时完成。我知道有些人在处理非常大的文件方面有丰富的经验，并希望得到一些关于我的方法的反馈，或者可能得到一些替代方法来解决这个问题。

任何想法和意见表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:17:27.830

> 然而，现在我们看到这些文件比预期的要大得多，处理需要一个周末

读取具有 1000 万行的文件不需要一个周末或类似的时间，因此任何优化工作都应该集中在处理从文件读取的数据而不是文件 I/O 上。

你没有说你正在做什么处理，但是，例如，如果你正在更新一个数据库，你可以通过将更新批处理到事务中来实现显着的性能改进——比如每 10,000 行一个事务。

鉴于它需要整个周末，它不太可能受 CPU 限制，所以我不确定多线程是第一个探索的途径。

如果您需要更多帮助，请提供更多有关您对数据的处理方式的信息。

# c# - 在 Visual C# 中循环单选按钮检查

> ID：13573955
> 
> 赞同：3
> 
> 时间：2012-11-26T22:05:46.253
> 
> 标签：c#, winforms, visual-studio-2010

我是 C# 的新手，试图制作一个本质上是一个包含 30 个问题的调查的程序，这些问题通过选择五个单选按钮（非常不同意、不同意...非常同意等）中的一个来回答。

我已经设置了一个小“块”代码，它将检查哪个单选按钮检查了问题并将一个值分配给一个数组（见下文）。

```
namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

    }

    private void buttonScore_Click(object sender, EventArgs e)
    {
        this.textBoxScoreOutput.Text = " ";

        int[] score = new int[2]; // Declares the integer of score and sets it to a value of zero

        // Question 1

        if (radioButtonSD1.Checked == true) // If Strongly Disagree checked give score a value of 1
            score[0] = 1;
        else if (radioButtonD1.Checked == true) // If Disagree checked give score a value of 2
            score[0] = 2;
        else if (radioButtonNS1.Checked == true) // If Not Sure checked give score a value of 3
            score[0] = 3;
        else if (radioButtonA1.Checked == true) // If Agree checked give score a value of 4
            score[0] = 4;
        else if (radioButtonSA1.Checked == true) // If Strongly Agree is checked give score a value of 5
            score[0] = 5;

        // Question 2

        if (radioButtonSD2.Checked == true) // If Strongly Disagree checked give score a value of 1
            score[1] = 1;
        else if (radioButtonD2.Checked == true) // If Disagree checked give score a value of 2
            score[1] = 2;
        else if (radioButtonNS2.Checked == true) // If Not Sure checked give score a value of 3
            score[1] = 3;
        else if (radioButtonA2.Checked == true) // If Agree checked give score a value of 4
            score[1] = 4;
        else if (radioButtonSA2.Checked == true) // If Strongly Agree is checked give score a value of 5
            score[1] = 5;

        // Output values in array to text box

        this.textBoxScoreOutput.Text = "Array: ";

        foreach (int i in score)
        {
            this.textBoxScoreOutput.Text += "[" + i.ToString() + "] ";
        }

        int sum = score.Sum();
        this.textBoxScoreOutput.Text += "The Sum of the array is: " + sum.ToString();
    }

}
} 
```

因此，这是检查 30 个问题中的前两个问题，并且完全按照我的需要和认为的方式工作。

我想知道我是否可以只循环这些“块”中的一个并让它检查所有 30 个问题。我已经搜索和搜索，但找不到我正在寻找的确切内容（我也知道我可能也没有寻找正确的东西）。

我只是想避免在我的程序中有三十个这样的“块”。我觉得其中的 30 个会变得一团糟。这可能吗？

![](../Images/d3ff2e2b96cb5ce2e9c7ee3268ae97a2.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T03:10:38.580

首先创建一个封装单个问题逻辑的 UserControl：

*   问题文本
*   选择的选项

一旦你有一个问题工作，你可以将任意数量的用户控件放到一个表单上，配置问题文本，然后只需要循环通过一组用户控件来获得你的答案。最好将答案作为[枚举](http://www.dotnetperls.com/enum)返回。

有很多方法可以实现这一点，例如生成控件的代码，或将选择绑定回 ViewModel 类，但用户控件是一个很好的开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:17:30.560

这是我大致的做法：

```
var resultList = new List<KeyValuePair<string, int>>();

foreach (var control in this.Controls)
{
    if (control is GroupBox)
    {
         GroupBox gb = (GroupBox)control;
         foreach (Control controll in gb.Controls)
         {
             if (controll is RadioButton)
             {
                RadioButton rb = new RadioButton();
                rb = (RadioButton)controll;
                //rb will allow you to access all of the RadioButton's properties and act accordingly.    
                if (rb.Checked)
                {
                    int score;
                    if (rb.Name.Contains("ButtonSD"))
                        score = 1;
                    if (rb.Name.Contains("ButtonD"))
                        score = 2;
                    //So on...
                    resultList.Add(new KeyValuePair<string, int>(gb.Name, score));

                }
             }
         }
    }
} 
```

度过了艰难的一天，所以也许有人可以想出更好的东西，但如果你不想重新组织整个事情，这可能会奏效。

# recursion - 一个布尔递归函数，用于判断一个数字是否在整数中出现偶数次

> ID：13573959
> 
> 赞同：1
> 
> 时间：2012-11-26T22:06:07.940
> 
> 标签：recursion

该函数获取一个整数和一个数字，如果数字在整数中出现偶数次，则返回 true，否则返回 false。

例如：

如果`digit=1`和`num=1125` 函数应该返回`true`。

如果`digit=1`和`num=1234` 函数应该返回`false`。

```
bool isEven(int num, int dig)
{
    bool even;

    if (num < 10)
        even = false;
    else
    {
        even = isEven(num/10,dig); 
```

这是我到目前为止所得到的，我被困住了......这是家庭作业，所以请不要写答案，而是提示我并帮助我自己完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:13:33.810

要设置递归，您需要弄清楚两件事：

1.  **基本情况。**您可以直接处理的简单案例有哪些？例如，你能轻松处理个位数的数字吗？
2.  **将所有其他情况减少到基本情况的规则。**例如，你能砍掉最后一位数，然后以某种方式将剩余部分数的解转换为完整数的解吗？

我可以从您的代码中看到您在这两点上都取得了一些进展。然而，两者都不完整。一方面，您永远不会在代码中使用目标数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:15:37.990

表达式 num%10 将为您提供数字的最后一位，这应该会有所帮助。

您的基本情况不正确，因为单个数字可以有偶数个匹配项（零是偶数）。您的递归案例也需要工作，因为您需要反转每个匹配的答案。

# ruby - 在 `Rack::Session::Cookie` 上使用 `Rack::Session::Pool`

> ID：13573968
> 
> 赞同：15
> 
> 时间：2012-11-26T22:06:31.290
> 
> 标签：ruby, session, cookies, rack, pool

[Rack::Session::Pool](http://www.rubydoc.info/github/rack/rack/Rack/Session/Pool)和[Rack::Session::Cookie](http://www.rubydoc.info/github/rack/rack/Rack/Session/Cookie)有哪些不同的用例？

据我了解（如果我错了，请纠正我）：

*   `Cookie`将*所有*会话键值对直接存储在 cookie 中（编组）
*   `Pool`仅在 cookie 中存储一个 id，并在其中维护会话哈希的其余部分`@pool`

那么：选择一个而不是另一个的含义/原因是什么？什么`@pool`？为什么`Pool`需要从 暴露不同的公共接口`Cookie`？为什么文档如此缺乏？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-26T22:25:42.540

你是对的，`Session::Cookie`在 cookie 中编组和存储会话。

`Session::Pool`而是将会话保存在内存中。

`Pool`有一些优点：

```
- faster, no marshaling needed 
- you can keep any objects with it(read ones that can not be marshaled) 
```

但是，当您重新启动应用程序时，所有会话都将丢失。

`Cookie`相反，您将以编组的价格获得重新启动的持久会话。

替代方案 - [Session::Memcache](http://www.rubydoc.info/github/rack/rack/Rack/Session/Memcache) , [Session::Mongo](https://github.com/migrs/rack-session-mongo)

# jquery - fancybox 中的文件输入

> ID：13573971
> 
> 赞同：2
> 
> 时间：2012-11-26T22:06:34.753
> 
> 标签：jquery, fancybox, fancybox-2

`input type="file"`我有一个包含文件输入 ( )的幻想框弹出窗口。在fancybox 2 之前，`form`当fancybox 显示时，fancybox 的内容保留在DOM 中的元素内。现在我已经切换到 fancybox 2，这不再是这种情况了；fancybox 内容从它们在 DOM 中的位置分离并重新定位到`form`. 因此，当`form`提交时，文件输入中选择的文件不会随请求一起上传。

我不太清楚以前版本的fancybox是否有意支持将fancybox内容留在DOM中的位置，或者这只是它的工作方式而不一定是有意解决我遇到的问题类型有。

无论如何，有没有办法可以确保fancybox 2 将fancybox 的内容保留在`form`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:20:18.567

即使您要使用 FORM 元素包装 <body> 标记的全部内容，也不应该信任第三方插件的行为将其内容插入其中。

许多插件会在其他所有内容*之后*插入其必要的内容，类似于（或完全相同）...

`$('body').append(...)`

显然，在这种情况下，您`form`将没有任何花哨的内容。

对您来说不幸的是，这可能会导致一些不合时宜的重新排列，但您应该将整个内容包含`form`在fancybox 内容页面本身中。这不仅应该解决问题，而且是一个更*安全*的解决方案。

# php - PHP 扩展文件要求

> ID：13573973
> 
> 赞同：0
> 
> 时间：2012-11-26T22:06:37.943
> 
> 标签：php, parent-child, parent, require

我有一个需要帮助的问题。

目前正在为自己开发一个新项目，我正试图从一个良好的基础开始。

我已经构建了以下文件结构（相关部分）：

*   班级/
*   类/class.filename.php
*   类/class.etc.php
*   功能/
*   func/func.filename.php
*   函数/func.etc.php
*   配置/config.php
*   索引.php

在我的配置文件中，所有类和函数都包含在 require_once 函数中（我在 func 和类中循环所有文件和目录）。在文件夹类中，firePHP 的文件位于我包含然后在 config.php 中设置的文件。

在我的 config.php 和 index.php 中，我可以完美地调用这个日志函数，但是当我在 func.filename.php 或 class.filename.php 之一中使用它时，它会出错。子 (func/class) 没有看到 config.php 中包含的其他函数。

希望有人可以帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:10:23.880

您的 func.filename.php 文件需要“require_once”包含日志功能的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:24:03.220

另一个可能对您有用的解决方案（因为您有这种结构）是将所有需要的文件放入`config.php`（包含在 中`require_once(<file>)`）。这似乎有效。然后，当其他文件需要其他文件的任何其他功能时，只需`require_once('config.php')`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T22:26:47.300

最好只在需要时包含您需要的内容。当您手头的脚本可能只需要 2 或 3 个时，为什么还要花时间加载 50 个不同的类/函数/片段？删除不必要的包含语句可以显着提高脚本的*性能*。

1.  将[`__autoload()`](http://ca1.php.net/manual/en/function.autoload.php)函数用于类。简直太棒了。
2.  链接`include_once()`或`require_once()`通过您的各种文件，以便获取给定作业所需的一个文件自动获取其自己的依赖项。

# ruby-on-rails - 如何比较 Float 和 Nil 以返回有效答案？

> ID：13573979
> 
> 赞同：1
> 
> 时间：2012-11-26T22:06:49.513
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有这样的事情：

```
 good_attrs = %w(firm_size priority_level)       

    good_attrs.each do |attr|
      if (score.send(attr) > max.send(attr))
        max.send("#{attr}=", score.send(attr))
      end
    end 
```

但是，发生的情况是，有时它可能会遇到`Max`如下所示的记录：

```
#<Max:0x007fe01024b240> {
                           :id => 2,
                      :user_id => 1,
                    :firm_size => 101.0,
               :priority_level => nil,
                   :created_at => Fri, 23 Nov 2012 01:55:53 UTC +00:00,
                   :updated_at => Fri, 23 Nov 2012 01:58:16 UTC +00:00
} 
```

即`max.priority_level`= `nil`。

那么如何修改我的初始值`if statement`以处理`nil`评估双方的案例？即如果一个`score`或`max`属性为零。理想情况下，我希望它被视为`0`并相应地进行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:18:10.943

你不能`nil`和一个比较`Float`。

在您的情况下，您可以利用以下事实`nil.to_f == 0.0`：

```
good_attrs = %w(firm_size priority_level)       

good_attrs.each do |attr|
  if score.send(attr).to_f > max.send(attr).to_f
    max.send("#{attr}=", score.send(attr))
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:10:50.843

您可以重载 attr_reader for`priority_level`和`firm_size`in`Max`

```
def priority_level
  read_attribute(:priority_level).nil? ? 0 : super
end 
```

您也可以在`after_initialize`块中设置默认值

```
after_initialize do
  self.priority_level = 0 if self.priority_level.nil?
end 
```

# android-intent - 编写 android 应用程序的步骤

> ID：13573984
> 
> 赞同：0
> 
> 时间：2012-11-26T22:07:16.083
> 
> 标签：android-intent

所以我是一个从头开始工作的初级程序员。

我有一些使用darkbasic编程的基本知识。（用于游戏）。

我阅读的越来越多，但我最终想制作安卓应用程序。

所以我的问题是哪些学习步骤可以帮助我进行 android 应用程序开发？

就像我是从 C 或 C++ 开始，然后转到 java 等等，还是有其他的行动方案可以采取？

你可以直接学习java/C++并开始制作应用程序吗？

任何帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:30:31.437

您的问题范围有点广，但这里有一个 5000 英尺的概述。

虽然您最终会用 Java 编写您的 Android 应用程序，但您的应用程序的结构将与常规 Java 程序有点不同。如果您不熟悉基本的 Java 概念，您应该从编写相当多的常规 Java 开始，以熟悉面向对象的编程。Android 使用线程和事件，因此这些也是您在开始 Android 开发之前可以开始使用的概念。准备就绪后，开始浏览随 SDK 分发的 Android 示例，以了解 Android 开发环境。根据你想开发的游戏类型，会有很多库，所以你不必重新开发轮子，但我会确保你在开始之前对 Java 和 Android 有一个扎实的了解在任何更大的事情上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:13:12.563

尝试使用像 libGDX 这样的成熟引擎。这可能会帮助您快速站起来，同时也可以帮助您专注于游戏内容。如果您有兴趣从头开始创建引擎，您可以随时从那里向上移动。

您可以在此处找到 libGDX 的起始材料：http: [//libgdx.badlogicgames.com/documentation.html](http://libgdx.badlogicgames.com/documentation.html)

# c# - 从代码隐藏更新进度条

> ID：13573985
> 
> 赞同：3
> 
> 时间：2012-11-26T22:07:16.180
> 
> 标签：c#, asp.net, progress-bar

`submit()`我的一个网页上有一个非常长的函数，它完全在服务器上运行，我想向客户端显示一个进度条来显示进度。

`20%`只要我可以向他们展示一些东西，我可以每隔一段时间更新一次。

这甚至可能吗？也许某种控制`runat="server"`？我有点迷失在这里的想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T22:13:30.073

这是*可能*的，但在基于 Web 的环境中比在基于桌面的环境中更难做到。

您要做的就是向服务器提交请求，让服务器启动异步任务，然后将响应发送回客户端。然后，客户端将需要定期轮询服务器（可能/理想情况下使用 AJAX）以获取更新。服务器将希望在长时间运行的任务主体中设置一个 Session 值（或使用其他存储状态的方法），该值可由客户端的轮询方法访问。

它很讨厌，很乱，而且效率低下，所以如果有很多用户执行它，你就不想这样做。

[这](http://code.msdn.microsoft.com/CSASPNETBackgroundWorker-dda8d7b6/view/SourceCode)是 Microsoft 的示例实现。请注意，此示例使用了`UpdatePanel`对象、ASP 计时器等，这使得代码编写起来相当简单（而且仍然不是那么漂亮），但这些组件相当“繁重”。使用显式 AJAX 调用、创建 Web 方法而不是执行完整的回发等将大大提高性能。正如我所说，即使在最好的情况下，这也是一场性能噩梦。如果您有很多用户或者这是一个执行非常频繁的操作，请不要这样做。如果它只是供一小部分管理员用户偶尔使用，那么这可能不是问题，而且从用户的角度来看它*确实*增加了很多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:19:43.130

我会看看.net 4.5 的异步和等待。

[在 ASP.NET MVC 4 中使用异步方法](http://www.asp.net/mvc/tutorials/mvc-4/using-asynchronous-methods-in-aspnet-mvc-4)——（MVC 示例我知道对不起）

[然后使用进度条查看此示例](http://msdn.microsoft.com/en-us/magazine/hh708746.aspx)

# jquery - slideToggle 上的 jQuery clearInterval

> ID：13573987
> 
> 赞同：1
> 
> 时间：2012-11-26T22:07:19.770
> 
> 标签：jquery, hover, setinterval, slidetoggle, clearinterval

我有一个 div，当悬停在上面时，slideToggles 一个`<p>`标签变得可见，然后我激活一个 setInterval 来为可见`<p>`标签设置动画，当用户不再将鼠标悬停在 div 上时，`<p>`标签会像它应该的那样隐藏，但动画仍然继续运行. 当你的用户不再悬停时，我已经尝试了我能想到的一切来停止动画，但我是 jQuery 新手，但我没有成功。

这是向您展示我所拥有的小提琴，[http://jsfiddle.net/Yokocapolo/g7AyV/](http://jsfiddle.net/Yokocapolo/g7AyV/)

我希望`<p>`标签在不再悬停时返回开始，并在用户将鼠标悬停在 div 上时重新开始动画。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:20:23.900

在脚本末尾添加此事件：

```
$('#portRibbon').mouseout(function(){
    $('#text3').animate({duration:0});
}); 
```

检查这个例子：http: [//jsfiddle.net/saidbakr/g7AyV/1/](http://jsfiddle.net/saidbakr/g7AyV/1/)

来自[Jquery Api](http://api.jquery.com/animate/)：

> **补充笔记：**
> 
> *所有 jQuery 效果，包括 .animate()，都可以通过设置 jQuery.fx.off = true 来全局关闭，这有效地将持续时间设置为 0。有关更多信息，请参阅 jQuery.fx.off。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:11:33.690

您正在使用设置为零的间隔来运行动画？

动画每秒会运行数千次，搞砸你的浏览器，根本不需要间隔函数，但它可能应该更像这样：

```
var timer;

$('#portRibbon').on({
    mouseenter: function() {
        $('#text3').stop(true,true).css('top', '0px');
        $('#portDescription').slideDown(500, function() {
            $('#text3').animate({
                'top': '-35px'
            }, 6000).delay(1000).animate({
                'top': '0px'
            });
        });
    },
    mouseleave: function() {
        $('#portDescription').slideUp(500);
    }
}); 
```

​<a href="http://jsfiddle.net/g7AyV/2/" rel="nofollow"> **FIDDLE**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T23:25:27.707

我设法通过添加`span`on hover 然后将其删除来让它工作`mouseleave`。

我将`span`和 文本节点存储为变量，然后使用将其`append()`附加到`p`标签。当用户离开时，我曾经`remove()`删除变量 on `mouseleave`。

要查看它的工作原理，请单击小提琴。[http://jsfiddle.net/Yokocapolo/g7AyV/7/](http://jsfiddle.net/Yokocapolo/g7AyV/7/)

再次感谢那些回答我问题的人。

# facebook - 为 heroku facebook 应用程序设置本地开发环境

> ID：13573989
> 
> 赞同：1
> 
> 时间：2012-11-26T22:07:26.960
> 
> 标签：facebook, heroku, local, environment

我在画布上安装了我的应用程序，但对于如何在本地进行测试有些茫然。我正在 nodeJs 之上构建我的应用程序来尝试一下。我有一个尚未部署到 heroku 的开发应用程序，所以我都准备好了，保存一些细节以供跟进。我知道我的计算机 IP 地址，但我不确定这是否是我需要的。如何找到正确的 IP。类似： 0.0.0.124:5000 是给出的例子。总结一下我需要知道的：

A）如何找到正确的本地 IP B）如何以及在哪里配置 apache 服务器（我有来自 heroku 的代码，只需要知道它进入什么文件以及在哪里找到它）。C) 如何导出端口 80 D) 了解我是否需要访问本地 dsl 路由器管理区域以设置静态 IP 或使用动态 IP

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T05:53:52.383

From the Heroku documentation:

[https://devcenter.heroku.com/articles/facebook#1-creating-a-development-facebook-app](https://devcenter.heroku.com/articles/facebook#1-creating-a-development-facebook-app)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T01:42:22.350

您需要回调 URL 的 IP 地址吗？如果是这样，我建议您注册一个动态 DNS 服务，这样即使您的家庭 IP 地址发生变化，您的家庭 Internet 连接也具有一致的域名。

您还需要将适当的端口从您的家庭路由器转发到您的开发机器。

# linux - 在 Linux 上创建自定义 SNMP OID

> ID：13573994
> 
> 赞同：3
> 
> 时间：2012-11-26T22:08:03.307
> 
> 标签：linux, snmp, raspberry-pi

我已经为树莓派构建了一个原型板，并且我想创建一个可以与之交谈的自定义 snmp OID，这将给我来自我的设备的反馈。

我可以从我的设备中取回值，但我不确定从哪里开始创建自定义 OID、注册它然后更新它。

有没有人有任何好的起点，教程，示例代码等。

干杯卢克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T03:07:58.647

官方渠道是通过此链接注册“私人企业号”：

[http://pen.iana.org/pen/PenApplication.page](http://pen.iana.org/pen/PenApplication.page)

在批准过程之后，您将收到一个 OID，您可以进一步分支并创建 OID 的整个子树。

也就是说，作为个人，您可以使用任何有效的 OID 进行测试。

“您应该使用哪些 OID？” 以下 Apache 目录服务文章中的部分是有用的阅读：

[http://directory.apache.org/apacheds/1.5/31-add-your-first-elements-to-the-schema.html](http://directory.apache.org/apacheds/1.5/31-add-your-first-elements-to-the-schema.html)

一个相关问题提到了对 OID 的 UUID 方法：

[SNMP：创建自定义 OID](https://stackoverflow.com/questions/3458138/snmp-create-custom-oid)

# android - 如何将 ListView 放入片段中

> ID：13573997
> 
> 赞同：0
> 
> 时间：2012-11-26T22:08:09.163
> 
> 标签：android, listview, fragment

我有一个很好的 ListView，但现在我添加了片段，现在我的代码在 onCreateMenu 中不起作用......

如何让我的 ListView 回来？

所以这是我的代码：

```
@Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View myFragmentView;
        Bundle b = getArguments();
        int Nr = b.getInt(ARG_SECTION_NUMBER);
        if (Nr == 0) {
            myFragmentView = inflater.inflate(R.layout.layoutexample, container, false);
        } else {
            myFragmentView = inflater.inflate(R.layout.another_layout_example, container, false);
        }
        return myFragmentView;
    } 
```

我不明白，把我的代码放在哪里（例如，如果我想要一个 ListView）！

我可以使用类似于充气机的东西吗？

请帮助，作为一个初学者我只了解一半的信息，谷歌开发者给我...

这是我的列表视图：

```
public class Home extends ListActivity {
ListView listView;
static final String[] Liste = {"a", "b", "c"};

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setTitle("CalcPlus");

    listView = getListView();

    listView.setAdapter(new ArrayAdapter<String>(this, R.layout.list_item, R.id.text, Liste) {
        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            View view = super.getView(position, convertView, parent);

            String item = getItem(position);

            TextView subTitleView = (TextView) view.findViewById(R.id.subtitle);
            subTitleView.setText("Subtitle of " + item);

            return view;
        }
    });
}
} 
```

那是list_item：

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"
android:padding="10dp" >

<TextView
    android:id="@+id/text"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text=""
    android:textAllCaps="false"
    android:textSize="22dp"
    android:textStyle="bold" />

<TextView
    android:id="@+id/subtitle"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text=""
    android:textAllCaps="false"
    android:textSize="16dp"
    android:textStyle="normal" />

</LinearLayout> 
```

* * *

这是 example.xml（它们看起来都一样）：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <ListView
        android:id="@+id/listView1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true" >
    </ListView>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:26:04.570

放大视图后，您可以添加：

```
ListView listView = myFragmentView.findViewById(android.R.id.list);
listView.setAdapter(....); 
```

编辑：我不知道您为 ListView 设置的 id。替换`android.R.id.list`为`R.id.listView1`

# php - 将新年插入日历以实现双月计划

> ID：13573998
> 
> 赞同：-1
> 
> 时间：2012-11-26T22:08:17.363
> 
> 标签：php, date

> **可能重复：**
> [如何在 php 中回显本月的 1 日和 15 日](https://stackoverflow.com/questions/13571203/how-to-echo-1st-and-15th-of-the-month-in-php)

能够打印出 2012 年 12 月 1 日和 2012 年 12 月 15 日，但不能让它继续到 2013 年 1 月 1 日和 2013 年 1 月 15 日 7 日等：

```
for($i=1;$i<=12;$i++){
 date('M 1, Y', strtotime($i . "/1/" . date("Y")));
 date('M 15, Y', strtotime($i . "/15/" . date("Y")));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:39:05.087

date("Y") - 将输出当前年份，这就是它不会超过 2012 年 1 月 1 日的原因。

所以选择之一是

```
$currentYear = date('Y');
for ($year = $currentYear; $year < $currentYear + 3; $year++)
{
    for($i=1;$i<=12;$i++){
       date('M 1, Y', strtotime($i . "/1/" . $year));
       date('M 15, Y', strtotime($i . "/15/" . $year));
    }     
} 
```

这将持续到 2012 年、2013 年、2014 年。