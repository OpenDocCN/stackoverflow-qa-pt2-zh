# StackOverflow 问答 13166000-13166999

# go - Go 中来自客户端和服务器的 RPC

> ID：13166004
> 
> 赞同：4
> 
> 时间：2012-10-31T19:15:53.650
> 
> 标签：go, rpc

`net/rpc`是否真的可以使用Go中的包从服务器到客户端进行 RPC 调用？如果没有，是否有更好的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-01T19:43:51.260

我目前正在使用 thrift ( [thrift4go](https://github.com/pomack/thrift4go) ) 来实现 server->client 和 client->server RPC 功能。默认情况下，thrift 只执行客户端-> 服务器调用，就像 net/rpc 一样。由于我还需要服务器->客户端通信，所以我做了一些研究，发现了[bidi-thrift](http://joelpm.com/2009/04/03/thrift-bidirectional-async-rpc.html)。Bidi-thrift 解释了如何连接 java 服务器 + java 客户端以进行双向 thrift 通信。

# bidi-thrift 的作用及其局限性。

TCP 连接具有传入和传出通信线路（RC 和 TX）。bidi-thrift 的想法是拆分 RS 和 TX，并将它们提供给客户端应用程序和服务器应用程序上的服务器（处理器）和客户端（远程）。我发现这在 Go 中很难做到。此外，这种方式不可能有“响应”（响应行正在使用中）。因此，服务中的所有方法都必须是“oneway void”。（即开即忘，呼叫没有结果）。

# 解决方案

我改变了bidi-thrift的想法，让客户端打开两个到服务器的连接，A和B。第一个连接（A）用于执行客户端->服务器通信（客户端像往常一样进行调用）。第二个连接（B）被“劫持”，并连接到客户端上的服务器（处理器），同时连接到服务器上的客户端（远程）。我已经将它与 Go 服务器和 Java 客户端一起使用。它工作得很好。它快速可靠（就像普通的节俭一样）。

一些来源.. B 连接（服务器-> 客户端）设置如下：

## 转到服务器

```
// factories
framedTransportFactory := thrift.NewTFramedTransportFactory(thrift.NewTTransportFactory())
protocolFactory := thrift.NewTBinaryProtocolFactoryDefault()

// create socket listener
addr, err := net.ResolveTCPAddr("tcp", "127.0.0.1:9091")
if err != nil {
    log.Print("Error resolving address: ", err.Error(), "\n")
    return
}
serverTransport, err := thrift.NewTServerSocketAddr(addr)
if err != nil {
    log.Print("Error creating server socket: ", err.Error(), "\n")
    return
}

// Start the server to listen for connections
log.Print("Starting the server for B communication (server->client) on ", addr, "\n")
err = serverTransport.Listen()
if err != nil {
    log.Print("Error during B server: ", err.Error(), "\n")
    return //err
}

// Accept new connections and handle those
for {
    transport, err := serverTransport.Accept()
    if err != nil {
        return //err
    }
    if transport != nil {
        // Each transport is handled in a goroutine so the server is availiable again.
        go func() {
            useTransport := framedTransportFactory.GetTransport(transport)
            client := worldclient.NewWorldClientClientFactory(useTransport, protocolFactory)

            // Thats it!
            // Lets do something with the connction
            result, err := client.Hello()
            if err != nil {
                log.Printf("Errror when calling Hello on client: %s\n", err)
            }

            // client.CallSomething()
        }()
    }
} 
```

## Java 客户端

```
// preparations for B connection
TTransportFactory transportFactory = new TTransportFactory();
TProtocolFactory protocolFactory = new TBinaryProtocol.Factory();
YourServiceProcessor processor = new YourService.Processor<YourServiceProcessor>(new YourServiceProcessor(this));

/* Create thrift connection for B calls (server -> client) */
try {
    // create the transport
    final TTransport transport = new TSocket("127.0.0.1", 9091);

    // open the transport
    transport.open();

    // add framing to the transport layer
    final TTransport framedTransport = new TFramedTransport(transportFactory.getTransport(transport));

    // connect framed transports to protocols
    final TProtocol protocol = protocolFactory.getProtocol(framedTransport);

    // let the processor handle the requests in new Thread
    new Thread() {
        public void run() {
            try {
                while (processor.process(protocol, protocol)) {}
            } catch (TException e) {
                e.printStackTrace();
            } catch (NullPointerException e) {
                e.printStackTrace();
            }
        }
    }.start();
} catch(Exception e) {
    e.printStackTrace();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-28T14:05:08.010

我遇到了实现它的[rpc2 。](https://github.com/cenkalti/rpc2)一个例子：

服务器.go

```
// server.go
package main

import (
 "net"
 "github.com/cenkalti/rpc2"
 "fmt"
)

type Args struct{ A, B int }
type Reply int

func main(){
     srv := rpc2.NewServer()
     srv.Handle("add", func(client *rpc2.Client, args *Args, reply *Reply) error{
    // Reversed call (server to client)
    var rep Reply
    client.Call("mult", Args{2, 3}, &rep)
    fmt.Println("mult result:", rep)

    *reply = Reply(args.A + args.B)
    return nil
 })

 lis, _ := net.Listen("tcp", "127.0.0.1:5000")
 srv.Accept(lis)
} 
```

客户端.go

```
// client.go
package main

import (
 "fmt"
 "github.com/cenkalti/rpc2"
 "net"
)

type Args struct{ A, B int }
type Reply int

func main(){
     conn, _ := net.Dial("tcp", "127.0.0.1:5000")

     clt := rpc2.NewClient(conn)
     clt.Handle("mult", func(client *rpc2.Client, args *Args, reply *Reply) error {
    *reply = Reply(args.A * args.B)
    return nil
   })
   go clt.Run()

    var rep Reply
    clt.Call("add", Args{5, 2}, &rep)
    fmt.Println("add result:", rep)
   } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T19:27:07.667

RPC 是一种（远程）服务。每当某些计算机请求远程服务时，它就充当客户端，要求服务器提供服务。在这个“定义”中，服务器调用客户端 RPC 的概念没有明确定义的含义。

# jquery - 选择器细化 -> 每个非空输入

> ID：13166005
> 
> 赞同：0
> 
> 时间：2012-10-31T19:15:54.783
> 
> 标签：jquery

可以使用一些帮助，似乎应该有一个更干净的方式来写出来。

我想选择#endowment div 中的每个文本输入，即不为空。另外，我正在写一个名为“dyn_hidden”的 div，我想在每个输入中附加一个值。因此，在每次模糊时，我都会删除所有内容，然后将每个内容添加回去。有没有更好的方法呢？

谢谢！

```
jQuery("#endowment input[type='text']").blur( function() {

    // Empty out dyn_hidden div
    jQuery('#dyn_hidden').html('');

    jQuery("#endowment input[type='text']").each(function() {
        if(jQuery(this).val() !== "") { 
            end_fund      = '<input type="hidden" name="fund[]" value="'+jQuery(this).attr('title')+'">';                                                                                                                  
            end_amount    = '<input type="hidden" name="amount[]" value="'+jQuery(this).val()+'">';
            jQuery('#dyn_hidden').append(end_fund, end_amount);
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:50:23.623

首先，当 DOM 加载时，您可以将所有隐藏的输入插入到您的 div 中。因此，当调用输入模糊时，您只需更改与该特定值相对应的隐藏输入。

您可以使用 HTML 5 属性来存储该特定文本框的信息。

像这样的东西..您还可以消除页面上重复ID的可能性..

```
jQuery(function() {
    // Insert all the input corresponding to the textboxes initially
    jQuery("#endowment input[type='text']").each(function(i) { // Use i in each as iterator to store the data-attribute
        // Store the value of the textbox in the data-id attribute
        // Add the data-attribute to the textbox that stores the index
        // of corresponding textbox
        $(this).attr('data-id', i);
        var end_fund = '<input type="hidden" name="fund[]" data-param="title-' + i + '" value="' + jQuery(this).attr('title') + '">';
        var end_amount = '<input type="hidden" name="amount[]" data-param="value-' + i + '" value="">';
        jQuery('#dyn_hidden').append(end_fund, end_amount);
    });

    // Blur function of text box
    jQuery("#endowment input[type='text']").blur(function() {
        // Just change the value of corresponding input field..
        if (this.value !== "") {
            var $index = $(this).data('id');
            // Find the hidden input with data-param= "value + $index  inside
            // the #dyn_hidden  div  
            // And then set the value to it...
            $('#dyn_hidden input[data-param="value-' + $index + '"]').val(this.value);
        }
    });
});​ 
```

**[代码](http://jsfiddle.net/sushanth009/UzSVj/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T19:20:16.133

你可以像[在这个问题中发现的那样做这样的事情](https://stackoverflow.com/questions/1299424/selecting-empty-text-input-using-jquery)

```
 $('#button').click(function() {

    var emptyTextBoxes = $('input:text').filter(function() { return this.value == ""; });
    var string = "The blank textbox ids are - \n";

    emptyTextBoxes.each(function() {
      string += "\n" + this.id;
    });
    alert(string);
  }); 
```

# scala - Scala 解析器组合器：如何反转匹配？

> ID：13166008
> 
> 赞同：5
> 
> 时间：2012-10-31T19:15:59.840
> 
> 标签：scala, parser-combinators

是否可以使用 Scala 解析器组合器反转匹配？我正在尝试使用*不*以一组关键字开头的解析器匹配行。我可以使用烦人的零宽度负前瞻正则表达式（例如`"(?!h1|h2).*"`）来做到这一点，但我宁愿使用 Scala 解析器来做到这一点。我能想到的最好的是：

```
def keyword = "h1." | "h2."
def alwaysfails = "(?=a)b".r
def linenotstartingwithkeyword = keyword ~! alwaysfails | ".*".r 
```

这个想法是我用的~！禁止回溯到所有匹配的正则表达式，然后继续使用不匹配的正则表达式 "(?=a)b".r。（顺便说一句，是否有一个总是失败的预定义解析器？）这样，如果找到关键字，则不会匹配该行，但如果关键字不匹配，则会匹配该行。

我想知道是否有更好的方法来做到这一点。有没有？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T22:08:14.043

你可以[`not`](http://www.scala-lang.org/api/2.10.3/index.html#scala.util.parsing.combinator.Parsers)在这里使用：

```
import scala.util.parsing.combinator._

object MyParser extends RegexParsers {
  val keyword = "h1." | "h2."
  val lineNotStartingWithKeyword = not(keyword) ~> ".*".r

  def apply(s: String) = parseAll(lineNotStartingWithKeyword, s)
} 
```

现在：

```
scala> MyParser("h1\. test")
res0: MyParser.ParseResult[String] = 
[1.1] failure: Expected failure

h1\. test
^

scala> MyParser("h1 test")
res1: MyParser.ParseResult[String] = [1.8] parsed: h1 test 
```

请注意，还有一个`failure`方法 on `Parsers`，因此您也可以使用`keyword ~! failure("keyword!")`. 但`not`无论如何，要好得多。

# forms - 表单提交动画 gif

> ID：13166012
> 
> 赞同：0
> 
> 时间：2012-10-31T19:16:11.763
> 
> 标签：forms, submit, animated-gif

我有一个输入类型为 image 的表单，如下所示。

```
<input type="image" id="submit" src="red_btn.png"> 
```

单击此图像以提交表单后，我将图像更改为动画 gif 以显示微调器

```
$('form').submit(function(e){
 //e.preventDefault();
 $('#submit').attr("src", "loading.gif");
 }); 
```

但是，没有动画。但是当我阻止表单提交时，gif 动画。

这是FF 16

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T19:18:52.007

似乎页面正在转换到提交页面，所以你真的不想在那个时候向用户显示任何东西。如果您正在进行 ajax 调用，那么是的，微调器是合适的。但是对于标准表单提交，我认为浏览器已经在加载新页面，所以这个页面即将被刷新。

# regex - 如何匹配 IPv4 地址

> ID：13166016
> 
> 赞同：2
> 
> 时间：2012-10-31T19:16:48.673
> 
> 标签：regex, posix, ip-address

我正在尝试让我的正则表达式匹配以下内容：

```
169.254.0.0-169.254.254.255 
```

谁能帮助我如何实现这一目标。

到目前为止，我有这个：

```
169\.254\.([1-9]{1,2}|[1-9]{1,2}[1-4]) 
```

但它也会选择 169.254.255.1，这不应该是匹配项之一。

请帮忙！

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T20:06:08.150

这是我用于一般 IP 验证的正则表达式：

```
(([0-9](?!\d)|[1-9][0-9](?!\d)|1[0-9]{2}(?!\d)|2[0-4][0-9](?!\d)|25[0-5](?!\d))[.]?){4} 
```

分解：

```
1.`[0-9](?!\d)`       -> Any Number 0 through 9 (The `(?!\d)` makes sure it only grabs stand alone digits)
2.`|[1-9][0-9](?!\d)` -> Or any number 10-99 (The `(?!\d)` makes sure it only grabs double digit entries)
3.`|1[0-9]{2}`        -> Or any number 100-199
4.`|2[0-4][0-9]`      -> Or any number 200-249
5.`|25[0-5]`          -> Or any number 250-255
6.`[.]?`              -> With or without a `.`
7.`{4}`               -> Lines 1-6 exactly 4 times 
```

这还没有让我的 IP 地址验证失败。

对于您的具体情况，应该这样做：

```
(169\.254\.)((([0-9](?!\d)|[1-9][0-9](?!\d)|1[0-9]{2}|2[0-4][0-9]|25[0-4])[.])(([0-9](?!\d)|[1-9][0-9](?!\d)|1[0-9]{2}|2[0-4][0-9]|25[0-5]))) 
```

这很长，因为我无法弄清楚如何在不让 169.254.255.1 失败的情况下检查 169.254.(0-254).255

编辑：由于评论而修复

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T19:21:11.373

正则表达式`([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-4])`匹配 0-254。

有关更多讨论，请参见此[页面](http://www.regular-expressions.info/numericranges.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T22:24:33.720

我写了一篇文章，为通用 URI 的所有组件提供正则表达式（如 [RFC3986 中所定义：统一资源标识符（URI）：通用语法](https://www.rfc-editor.org/rfc/rfc3986)）

请参阅：[正则表达式 URI 验证](http://jmrware.com/articles/2009/uri_regexp/URI_regex.html)

通用 URI 的组成部分之一是 IPv4 地址。这是该文章中的自由间距模式 Python 版本：

```
re_python_rfc3986_IPv4address = re.compile(r""" ^
    # RFC-3986 URI component:  IPv4address
    (?: (?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?) \.){3}  # (dec-octet "."){3}
        (?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)         # dec-octet "."
    $ """, re.VERBOSE) 
```

以及未注释的 JavaScript 版本：

```
var re_js_rfc3986_IPv4address = /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/; 
```

# c# - 会自动调用基类构造函数吗？

> ID：13166019
> 
> 赞同：126
> 
> 时间：2012-10-31T19:16:58.177
> 
> 标签：c#, constructor, base-class

```
class Person
{
    public int age;
    public Person()
    {
        age = 1;
    }
}

class Customer : Person
{
    public Customer()
    {
        age += 1;
    }
}

Customer customer = new Customer(); 
```

客户的年龄会是 2 岁吗？似乎无论如何都会调用基类的构造函数。如果是这样，为什么我们`base`有时需要在最后调用？

```
public Customer() : base()
{
    .............
} 
```

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2012-10-31T19:20:48.833

这就是 C# 的工作方式。类型层次结构中每种类型的构造函数将按照 Most Base -> Most Derived 的顺序调用。

因此，在您的特定实例中，它调用`Person()`, 然后`Customer()`在构造函数中命令。有时需要使用`base`构造函数的原因是当前类型以下的构造函数需要附加参数时。例如：

```
public class Base
{
     public int SomeNumber { get; set; }

     public Base(int someNumber)
     {
         SomeNumber = someNumber;
     }
}

public class AlwaysThreeDerived : Base
{
    public AlwaysThreeDerived()
       : base(3)
    {
    }
} 
```

为了构造一个`AlwaysThreeDerived`对象，它有一个无参数的构造函数。但是，`Base`类型没有。因此，为了创建无参数构造函数，您需要向基本构造函数提供一个参数，您可以通过`base`实现来完成。

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2012-10-31T19:18:01.527

是的，将自动调用基类构造函数。`base()`当有没有参数的构造函数时，您不需要添加显式调用。

您可以通过在构建后打印出客户的年龄来轻松测试这一点（[链接到带有演示的 ideone](http://ideone.com/9lTuYH)）。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-10-31T19:21:34.950

如果您没有默认的无参数构造函数，则需要调用带参数的构造函数：

```
class Person
{
    public Person(string random)
    {

    }
}

class Customer : Person
{
    public Customer(string random) : base (random)
    {

    }
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-05-02T14:46:48.943

使用您的示例，答案是：**YES**。将为您调用基本构造函数，您不需要添加一个。

**如果您向基类添加了带参数的构造函数，并且没有添加显式默认构造函数，则仅需要在派生类中使用“base(...)”调用。**

如果您中断或中断从派生类到基构造函数的隐含构造函数调用链，则只需要进行该 base(...) 调用。当您向基类添加非默认构造函数时，就会发生这种情况。

在使用基类和派生类的 c# 中，对基类的构造函数的某些调用必须始终从派生类进行，要么由运行时*隐式调用，要么**显式调用*由你。大多数情况下，运行时会在您创建派生类对象时为您调用基类默认构造函数，因此您不需要调用“base()”。默认情况下，派生类在实例化时将始终隐式调用基类默认构造函数。这就是为什么在大多数情况下，您不需要将“base()”添加到派生类的构造函数中。基类总是首先通过调用基类中的默认构造函数从派生类实例化，除非您更改其构造函数（见下文）。C# 不关心它是默认构造函数还是带参数的非默认构造函数。创建派生类对象时，必须在基类中调用一个。

这就是为什么您可以省略派生类构造函数中的“base()”调用和所有类中的显式默认构造函数作为隐式调用的原因。

隐式基类构造函数调用仅在以下情况之一为真时为真并且为您生成。如果为真，则不需要在派生类中调用“base(...)”：

1.  您的基类没有定义明确的构造函数
2.  您的基类只定义了一个显式的默认构造函数
3.  您的基类具有一个或多个使用参数定义的非默认构造函数，并且定义了显式默认构造函数。

当您突然添加一个带有参数且没有默认构造函数的非默认构造函数时，它会破坏默认隐藏的默认构造函数链创建和调用，您必须添加“base()”。在具有非默认构造函数的基类中，您现在必须使用“base(...)”从派生类显式调用该构造函数，或者在基类中显式添加默认构造函数。如果是后者，您可以避免“base()”调用。它被隐式调用。

让我们测试一下......

```
// IMPLIED CONSTRUCTOR CALL TO THE BASE CLASS CALL WORKS NATURALLY HERE
class MyBaseClass0
{
// a default constructor added for you
}
class DerivedClass0 : MyBaseClass0
{
// an implied call to the base constructor is done for you
}

// THIS WORKS!!!
class MyBaseClass1
{
// a default constructor added for you
}
class DerivedClass1 : MyBaseClass1
{
    public DerivedClass1()
    {
      // Here the derived class default constructor is 
      // created explicitly but an implied call to the
      // base constructor is done for you
    }
}

// AND THIS WORKS!!!
class MyBaseClass2
{
// a default constructor added for you
}
class DerivedClass2 : MyBaseClass2
{
    public DerivedClass2() : base()
    {
    // "base()" is still optional here as implied call
    // to the base constructor is done for you
    }
}

// AND THIS WORKS!!!
class MyBaseClass3
{
// a default constructor added for you
}
class DerivedClass3 : MyBaseClass3
{
    public DerivedClass3(int x)// base not needed
    {
    // an implied call to the base constructor is still done for you
    }
}

// BECAUSE WE ADDED A NON-DEFAULT CONSTRUCTOR WITH
// NO EXPLICIT DEFAULT CONSTRUCTOR WE MUST USE "BASE(...)"

class MyBaseClass4
{
    // need explicit default constructor or must use "base()" now

    // non-default constructor added which breaks implicit call
    public MyBaseClass4(string y)
    {

    }
}
class DerivedClass4 : MyBaseClass4
{
    public DerivedClass4(int x) : base("hello")
    {
       // The implicit call to the default constructor is broken now
       // because we added a non-default constructor to base class.
       // Adding a "base()" call we have fulfilled the requirement
       // that some base constructor be called in the Base Class.
    }
}

// The IMPLIED default constructor call now works again
// because we added an explicit default constructor beside
// the non-default one we added. "base()" is not needed again.

class MyBaseClass5
{
    public MyBaseClass5()
    {
    }

    public MyBaseClass5(string y)
    {
    }
}
class DerivedClass5 : MyBaseClass5
{
    public DerivedClass5(string x)
    {
    }
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-05-14T17:35:13.003

**`base()`**默认情况下会调用它，但它可以用于其他目的，例如：

1.  base()` 方法用于将值传递给父类构造或
2.  调用父类的无参数构造函数。

例如：

**情况 1：如果父级具有参数化构造函数但没有默认或无参数构造函数。**

```
 class Person
 {

    private string FirstName;
    private string LastName;
    private string EmailAddress;
    private DateTime DateOfBirth;

    public Person(string firstName, string lastName, string emailAddress, DateTime dateOfBirth)
    {
        FirstName = firstName;
        LastName = lastName;
        EmailAddress = emailAddress;
        DateOfBirth = dateOfBirth;

    }
    }
class Employee : Person
{
    private double Salary { get; set; } = 0;

    public Employee(string firstName, string lastName, string emailAddress, DateTime dateOfBirth,double salary)
        :base(firstName,lastName,emailAddress,dateOfBirth)// used to pass value to parent constructor and it is mandatory if parent doesn't have the no-argument constructor.
    {
        Salary = salary;
    }
} 
```

**情况 2：当父级具有多个构造函数以及默认构造函数时。**

```
class Person
{

    private string FirstName;
    private string LastName;
    private string EmailAddress;
    private DateTime DateOfBirth;

    public Person()
    {
        // some important intialization's to be done  

    }

    public Person(string firstName, string lastName, string emailAddress, DateTime dateOfBirth)
    {
        FirstName = firstName;
        LastName = lastName;
        EmailAddress = emailAddress;
        DateOfBirth = dateOfBirth;

    }
    }
class PermanentEmployee : Person
{
    public double HRA { get; set; }
    public double DA { get; set; }
    public double Tax { get; set; }
    public double NetPay { get; set; }
    public double TotalPay { get; set; }

    public PermanentEmployee(double hRA, double dA, double tax, double netPay, double totalPay) : base();
    {
        HRA = hRA;
        DA = dA;
        Tax = tax;
        NetPay = netPay;
        TotalPay = totalPay;
    }
} 
```

在这里，我们通过 base() 手动调用无参数构造函数来执行一些 intilizations 但不传递任何值。

希望这会帮助你。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-14T08:06:55.020

我没有太多要补充的，但我发现我需要调用 MyConstructor() : base() 在 1 种情况下没有参数。我有一个基类，它以我有一个 RegisterProperties() 虚函数的方式实现 INotifyPropertyChanged。当我覆盖它时，它在基本构造函数中被调用。所以我最终不得不在最近派生的子类中调用它，因为在识别覆盖的虚拟之前显然调用了基础。除非我这样做，否则我的财产不会通知。整个基类如下。

我在它下面直接添加了一个 DatabaseTraits 子类。如果没有空的 base() 调用，我的属性不会调用 OnPropertyChanged()。

```
[DataContract]
public abstract class DataModelBase : INotifyPropertyChanged, IDataErrorInfo {

    #region Properties

    [IgnoreDataMember]
    public object Self {
        get { return this; }
        //only here to trigger change
        set { OnPropertyChanged("Self"); }
    }

    #endregion Properties

    #region Members

    [IgnoreDataMember]
    public Dispatcher Dispatcher { get; set; }

    [DataMember]
    private Dictionary<object, string> _properties = new Dictionary<object, string>();

    #endregion Members

    #region Initialization

    public DataModelBase() {
        if(Application.Current != null) Dispatcher = Application.Current.Dispatcher;
        _properties.Clear();
        RegisterProperties();
    }

    #endregion Initialization

    #region Abstract Methods

    /// <summary>
    /// This method must be defined
    /// </summar
    protected abstract void RegisterProperties();

    #endregion Abstract Methods

    #region Behavior

    protected virtual void OnPropertyChanged(string propertyName) {
        PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
    }

    protected bool RegisterProperty<T>(ref T property, string propertyName) {
        //causes problems in design mode
        //if (property == null) throw new Exception("DataModelBase.RegisterProperty<T> : ref T property cannot be null.");
        if (_properties.ContainsKey(property)) return false;

        _properties.Add(property, propertyName);

        return true;
    }

    protected string GetPropertyName<T>(ref T property) {
        if (_properties.ContainsKey(property))
            return _properties[property];

        return string.Empty;
    }

    protected bool SetProperty<T>(ref T property, T value) {
        //if (EqualityComparer<T>.Default.Equals(property, value)) return false;
        property = value;
        OnPropertyChanged(GetPropertyName(ref property));
        OnPropertyChanged("Self");

        return true;
    }

    [OnDeserialized]
    public void AfterSerialization(StreamingContext context) {
        if (Application.Current != null) Dispatcher = Application.Current.Dispatcher;
        //---for some reason this member is not allocated after serialization
        if (_properties == null) _properties = new Dictionary<object, string>();
        _properties.Clear();
        RegisterProperties();
    }

    #endregion Behavior

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    #endregion INotifyPropertyChanged Members

    #region IDataErrorInfo Members

    string IDataErrorInfo.Error {
        get { throw new NotImplementedException(); }
    }

    string IDataErrorInfo.this[string propertyName] {
        get { throw new NotImplementedException(); }
    }

    #endregion IDataErrorInfo Members

} //End class DataModelBaseclass DataModelBase

/*I decided to add an example subclass*/
    [DataContract]
public abstract class DatabaseTraits : DataModelBase {
    #region Properties
    private long _id = -1;
    [DataMember]
    public long Id {
        get { return _id; }
        set { SetProperty(ref _id, value); }
    }
    private bool _isLocked = false;
    [DataMember]
    public bool IsLocked {
        get { return _isLocked; }
        set { SetProperty(ref _isLocked, value); }
    }

    private string _lockedBy = string.Empty;
    [DataMember]
    public string LockedBy {
        get { return _lockedBy; }
        set { SetProperty(ref _lockedBy, value); }
    }

    private DateTime _lockDate = new DateTime(0);
    [DataMember]
    public DateTime LockDate {
        get { return _lockDate; }
        set { SetProperty(ref _lockDate, value); }
    }

    private bool _isDeleted = false;
    [DataMember]
    public bool IsDeleted {
        get { return _isDeleted; }
        set { SetProperty(ref _isDeleted, value); }
    }
    #endregion Properties

    #region Initialization
    public DatabaseTraits() : base() {
        /*makes sure my overriden RegisterProperties() is called.*/
    }
    protected override void RegisterProperties() {
        RegisterProperty(ref _id, "Id");
        RegisterProperty(ref _isLocked, "IsLocked");
        RegisterProperty(ref _lockedBy, "LockedBy");
        RegisterProperty(ref _lockDate, "LockDate");
        RegisterProperty(ref _isDeleted, "IsDeleted");
    }
    #endregion Initialization

    #region Methods
    public void Copy(DatabaseTraits that) {
        Id = that.Id;
        IsLocked = that.IsLocked;
        LockedBy = that.LockedBy;
        LockDate = that.LockDate;
        IsDeleted = that.IsDeleted;
    }
    #endregion Methods
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-02T05:52:14.350

### 使用 NUnit 或 xUnit 测试私有方法的最简单方法

我可以建议下一个：

1.  让他们受到保护
2.  创建私有模拟类，
3.  从我们要测试的类派生它
4.  添加调用基本方法的新公共方法。

```
public class Car
{
    protected void StartEngine() {}

    protected void StartMoving() {}

    public void Drive()
    {
        StartEngine();
        StartMoving();
    }
}

public class TestClass
{
    [Test]
    public void Test1()
    {
        var mock = new MockCar();
        mock.StartEngine();
        mock.StartMoving();
    }

    private class MockCar : Car
    {
        public new void StartEngine()
        {
            base.StartEngine();
        }

        public new void StartMoving()
        {
            base.StartMoving();
        }
    }
} 
```

# asp.net-mvc - 更新 EF ICollection 属性

> ID：13166025
> 
> 赞同：1
> 
> 时间：2012-10-31T19:17:41.297
> 
> 标签：asp.net-mvc, entity-framework, one-to-many

如何在 EF 中更新 ICollection 属性？

我收到此错误消息；

“不能将类型'int'隐式转换为' `System.Collections.Generic.ICollection<MySolution.Domain.UserProfile>`'”

我的实体：

```
public class Department
{
    public virtual int Id { get; set; }
    public virtual string DepartmentTitle { get; set; }
    public virtual ICollection<UserProfile> UserProfiles { get; set; }

}

public class UserProfile
{
    public virtual int UserId { get; set; }
    public virtual string UserName { get; set; }
    public virtual string FirstName { get; set; }
    public virtual string LastName { get; set; }

} 
```

代码;

```
 var userProfile = _db.UserProfiles.Single(d => d.UserName == "SomeUserName");

    var department = _db.Departments.Single(d => d.Id == variableDepartmentID);
    department.UserProfiles = uProfile.UserId;
    _db.UpdateDepartment(department);
    _db.Save(); 
```

# javascript - 从 node.js 向客户端 js 发送数据的最佳方式

> ID：13166030
> 
> 赞同：2
> 
> 时间：2012-10-31T19:18:08.547
> 
> 标签：javascript, node.js, express

将一些数据（理想情况下以 json 对象的形式）从 node.js 服务器发送到客户端的 javascript 的最佳方式是什么。我想了几个选择，但在我看来，它们似乎都不是很合适。我正在寻找第二种意见或其他一些建议。

1.  让服务器在标签中输出一些代码`<script>`以设置全局变量。

    我以前用过这个，但我不喜欢它的想法，主要是因为它具有 XSS 的潜力，而且我认为这是不好的做法，即使发送的数据不是由用户定义的。

2.  设置一个 cookie，其中包含数据。

    这个选项稍微好一点，但由于每次页面加载时数据可能会发生变化（至少在我的设置中），它并不真正适合，因为在我看来，cookie 不应该是这种易变的。

3.  让客户端 javascript 在页面加载时向服务器发出 ajax 请求以请求 json 文件。

    这也有效，但它增加了很多不必要的开销。每页 2 个请求似乎没有必要。

**背景：**

我有一个带有 2 个模板的站点：注销用户的索引和主要内容模板。

我的服务器端是基于 node.js、express.js、jade 等构建的。

我将 history.pushState 用于我的所有链接，并将 crossroads.js 用于客户端的页面路由。我希望能够发送加载的模板和用户的 id / 如果他们登录到客户端 javascript，因此它可以相应地处理页面更改。注销的用户可以查看内容页面，而无需编辑权限，单击某些链接应该会将他们带回索引模板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:10:36.500

只需将一次性数据包含在`<script`> 标记中，类型为“text/template”或“application/json”，并确保它们具有 ID。使用 jQuery 或标准 DOM 方法访问它们的内容。对于较短的数据位，您可以`data-*`在关键元素上使用属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T02:13:17.863

`<script>`标记方法很好。如果您担心其他脚本访问数据，那么不要设置全局变量，而是在您的客户端 js 代码中编写一个可以接受数据的函数。

因此，而不是生成：

```
<script>
  data = { foo : "bar" }
</script> 
```

生成这样的东西：

```
<script>
  setData({ foo : "bar" });
</script> 
```

显然，我认为我不需要告诉您您生成的任何数据都应该由适当的 JSON 序列化程序序列化以避免语法错误等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T19:24:59.710

除了 Ajax，您可以使用[Socket.io](http://socket.io)或[Now](http://nowjs.com)（实现 socket.io）来实现 websockets。这些不仅允许您轻松地在客户端和服务器之间来回传递数据，还允许客户端调用服务器上的函数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-28T19:07:22.417

一种方法是使用隐藏段落来保存分隔字符串。

我喜欢用不可能嵌入到我的数据元素中的字符来分隔我的字符串。

我最喜欢的分隔符是：

```
char delim = (char) 1;  // the SOH character of the ASCII character map 
```

脚本标记不是一个好的选择，因为分隔符太多，并且其中一个分隔符很可能嵌入到您的数据元素之一中。

使用 JSON 也有同样的问题：分隔符太多。

一个隐藏的 HTML 段落元素得到了我的投票。

服务器端：

在包含列和值的`div`带有`id="hiddenStrings" style="visibility:hidden"`地方的段落内

```
 p id="delimitedColumnNames"> @Model._ticket.GetDelimitedColumns() /p
    p id="delimitedCoulmnValues"> @Model._ticket.GetDelimitedValues() /p 
```

客户端：

```
// The leading character is the delimiter.
var delimiter = document.getElementById("delimitedColumnNames").innerHTML.substr(0,1);
var delimited = document.getElementById("delimitedColumnNames").innerHTML.substr(1);
var ticketCols = delimited.split(delimiter);

var delimiter = document.getElementById("delimitedCoulmnValues").innerHTML.substr(0,1);
var delimited = document.getElementById("delimitedCoulmnValues").innerHTML.substr(1);
var ticketValues = delimited.split(delimiter); 
```

# c# - ORA-01008: 并非所有变量都与空值绑定

> ID：13166035
> 
> 赞同：2
> 
> 时间：2012-10-31T19:18:26.803
> 
> 标签：c#, oracle

我正在创建一个查询，我似乎无法超越`Not all variables bound`Oracle 中的错误

据我所知，一切看起来都是正确的。我错过了什么？

为了保护无辜者，代码有点模糊......

```
OracleCommand execCmd = new OracleCommand();

OracleParameter outParam =
        new OracleParameter("ID", OracleType.Int32);
outParam.Value = DBNull.Value;
outParam.Direction = System.Data.ParameterDirection.Output;
execCmd.CommandText = "insert into o " +
        "(A, B, " +
        "C, D, E, " +
        "F, G, H, I, " +
        "J, K) " +
        "VALUES (:A, :B, :C, :D, :E, " +
        ":F, :G, :H, :I, :J, :K) " +
        "RETURNING O_ID INTO :ID";
execCmd.Parameters.AddWithValue("A", og.N);
execCmd.Parameters.AddWithValue("B", DBNull.Value);
execCmd.Parameters.AddWithValue("C", DBNull.Value);
execCmd.Parameters.AddWithValue("D", og.A);
execCmd.Parameters.AddWithValue("E",
    og.A1 + " " + og.A2 + " " + og.A3 +
    " " + og.C);
execCmd.Parameters.AddWithValue("F", DBNull.Value);
execCmd.Parameters.AddWithValue("G", DBNull.Value);
execCmd.Parameters.AddWithValue("H", og.Cs);
execCmd.Parameters.AddWithValue("I", ss);
execCmd.Parameters.AddWithValue("J", DBNull.Value);
execCmd.Parameters.AddWithValue("K", "N");
execCmd.Parameters.Add(outParam);
conn.executeCommand(execCmd, trx); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-01T13:22:03.520

我最终能够解决这个问题。原来我的一个字符串实际上是空的，并且这个版本`OracleCommand`（标记为已弃用）中存在一个错误，导致它删除空参数。我的解决方案是在执行之前运行修复功能。

此外，正如其他人所说，订单确实很重要。所以，这也必须是正确的。

这对我有用，在执行之前调用它：

```
private void PopulateNullParameters(OracleCommand cmd)
{
    foreach (OracleParameter p in cmd.Parameters)
    {
        if (p.Value == null)
        {
            p.Value = DBNull.Value;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T19:32:24.457

在最后一行中，您似乎缺少 ID 参数：

```
"RETURNING ORGANIZATION_ID INTO :ID"; 
```

此外，基于[这个 SO question](https://stackoverflow.com/questions/1422032/oracle-ora-01008-not-all-variables-bound-error-w-parameters)，看来 OracleCommand 对象按位置绑定参数，因此如果您的参数无序，您可能需要查看使用[BindByName](http://oradim.blogspot.com/2007/08/odpnet-tip-bind-variables-and.html)属性：

```
using(OracleCommand cmd = con.CreateCommand()) {
    ...
    cmd.BindByName = true;
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T00:22:47.123

尝试在参数名称前加上`:`冒号

例如

```
 execCmd.Parameters.AddWithValue(":NAME", org.Name);
  execCmd.Parameters.AddWithValue(":EDP", DBNull.Value);
  execCmd.Parameters.AddWithValue(":EDD", DBNull.Value);
  execCmd.Parameters.AddWithValue(":ACRONYM", org.Acronym);    
  .... 
```

# jquery - 传递给 Ajax 请求的参数将其空格替换为加号

> ID：13166036
> 
> 赞同：1
> 
> 时间：2012-10-31T19:18:35.117
> 
> 标签：jquery

我正在从 jQuery 发出 Ajax 请求。由于某种原因，当 facetValue 之间有空格时，它被编码为加号。对于获取混合动力汽车作为混合动力+汽车发送，因此我的返回值什么都没有。知道发生了什么吗？

* * *

```
function fetchResults(facetname,facetValue){
  $.ajax({url:"usageSearch.jsp",
    data:{searchquery:querystring,facetValue:facetValue,facetname:facetname},
    success:function(result){
      var usages=$.parseJSON(result);           
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T19:21:40.437

我会说您的请求是通过 GET 尝试使用 POST 发送的：

```
$.ajax({url:"usageSearch.jsp",
    type : 'POST',
    data:{searchquery:querystring,facetValue:facetValue,facetname:facetname},
    success:function(result){
      var usages=$.parseJSON(result);           
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T19:22:07.417

正在对数据进行 url 编码，这是正常程序。您必须在使用它之前对其进行解码。在 PHP 中可以这样做：

```
$decoded_data = urldecode( $rawdata ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T19:22:09.067

尝试：

```
url:escape("usageSearch.jsp"), 
```

和

```
data:{searchquery:escape(querystring),facetValue:escape(facetValue),facetname:escape(facetname)} 
```

# powerbuilder - Powerbuilder 32 位应用程序 Windows 7 ODBC ASA 8.0

> ID：13166037
> 
> 赞同：1
> 
> 时间：2012-10-31T19:18:36.793
> 
> 标签：powerbuilder, sybase-asa, powerbuilder-build-deploy

我有一个使用 ASA 8.0 和 ODBC 连接的 32 位 Powerbuilder 9.0 应用程序，在 windows XP 下一切正常，但在 windows 7 下它失败了，我尝试了各种注册表设置组合来尝试让它工作，但无济于事，我已经阅读了许多关于不同 windows\system 或 wow64 文件夹中不同 odbc32.exe 的文章，但我似乎从来没有正确地击中头部。我正在使用 Inno 来构建安装文件。我对此感到有点绝望，以至于使用不同的数据库

谢谢

科林

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T10:28:54.803

如果您的操作系统是 Win7 64b，并且如果数据源是由 32b 应用程序设置的，那么这些设置可能会映射到注册表的`Wow6432Node`分支中。代表*Windows on Windows64*。完整路径将是.`HKLM\software``Wow64`*`HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\ODBC\ODBC.INI\`*

 *因此，64b 数据源管理工具不能直接看到 ODBC32。相反，您必须搜索`%SystemRoot%\SysWOW64\odbcad32.exe`.

32b 应用程序应该仍然可以访问 32b 数据源。*

# c# - 为什么是 `ICollection` 类型的`IDictionary.Values` 属性？

> ID：13166044
> 
> 赞同：2
> 
> 时间：2012-10-31T19:19:24.773
> 
> 标签：c#, dictionary, ienumerable, icollection

我试图弄清楚为什么该`IDictioary<TKey, TValue>.Values`属性是 type`ICollection<TValue>`而不是`IEnumerable<TValue>`. 该`Values`属性的 .NET 实现显式地实现了接口属性，然后将该`Values`属性公开为类型`Dictionary<TKey, TValue>.ValueCollection`，当您尝试从中添加或删除值时，该类型会引发异常。

这似乎是一个完整的黑客。由于字典的性质，创建一个允许您获取字典中值的集合并从中添加/删除值的实现是否有意义？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T19:20:50.063

这允许您在字典接口上使用`Count`属性和方法。`Contains()`

你是对的; 这是一个丑陋的黑客。
理想的解决方案是使用新的（到 .Net 4.5）[`IReadOnlyCollection<T>`接口](http://msdn.microsoft.com/en-us/library/hh881542.aspx)。

# android - 在 ScrollView 内的子项上具有权重属性的 LinearLayout

> ID：13166046
> 
> 赞同：2
> 
> 时间：2012-10-31T19:19:32.293
> 
> 标签：android, layout, scrollview, android-linearlayout

关于 ScrollViews 的常见问题似乎是如何使用 fillViewport 让 ScrollView 伸展到整个屏幕。我的问题是相似的，但反过来:)

我有一个包含多个元素的 LinearLayout。除了一个元素外，所有元素都有固定的高度，特别的是一个应该拉伸以填充剩余空间的 ImageView。这很好用:)

现在我想将 LinearLayout 放入 ScrollView，因为我的一些元素应该在运行时展开（例如，单击展开 TextView 的“更多”图标）。在未展开的版本中，我希望所有元素都适合屏幕，就好像 ScrollView 不存在一样。

不幸的是，当将 ScrollView 包裹在 LinearLayout 周围时，ImageView 被缩放到 maxSize 并且屏幕不适合屏幕。您对如何实现我的目标有任何想法吗？

我在一个示例应用程序中重现了该问题与您分享：

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:fillViewport="true" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <ImageView
            android:layout_width="fill_parent"
            android:layout_height="0px"
            android:layout_weight="1"
            android:background="#ffff0000"
            android:scaleType="fitCenter"
            android:src="@drawable/background" />

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="80dp"
        android:background="#ff00ff00"
        android:text="element 2"
        tools:context=".MainActivity" />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="80dp"
            android:background="#ff00ff00"
            android:text="element 1"
            tools:context=".MainActivity" />
    </LinearLayout>

</ScrollView> 
```

以下是两个版本的截图：

![ScrollView 内的屏幕截图（注意滚动条和元素 1 上的裁剪）](../Images/794c18c73575984f872b520f5b2219f5.png) ![没有 ScrollView 的截图](../Images/bd67e766a7fdda081554020deced4b5f.png)

上面的一个是带有 ScrollView 的布局（注意滚动条和元素 1 的裁剪），下面的一个没有。

**更新：**图像视图中图像的原始高度大于屏幕。所以它应该被缩小（这就是为什么它有 weight 1 和 scaleType 集）。

**解决方案：以下代码为我解决了问题（基于 Luksprog 答案）**

Main Activity（摘录，布局的变化是通过点击 ImageView 引起的）：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    scrollView = (ScrollView) findViewById(R.id.scroller);
    frame = (FrameLayout) findViewById(R.id.frame);
    layout = (LinearLayout) findViewById(R.id.layout);

    final ImageView image = (ImageView) findViewById(R.id.image);
    image.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            ImageView image = (ImageView) findViewById(R.id.image);
            frame.removeView(layout);
            scrollView.addView(layout);
            image.getLayoutParams().height = image.getHeight();
        }
    });

} 
```

布局 XML 文件

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/frame"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
     >

    <ScrollView 
        android:id="@+id/scroller"
        android:layout_height="fill_parent"
        android:layout_width="fill_parent"
        android:fillViewport="true"
        >

    </ScrollView>

    <LinearLayout
        android:id="@+id/layout"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <ImageView
            android:id="@+id/image"
            android:layout_width="fill_parent"
            android:layout_height="0px"
            android:layout_weight="1"
            android:background="#ffff0000"
            android:scaleType="fitCenter"
            android:src="@drawable/background" />

        <TextView
            android:id="@+id/text1"
            android:layout_width="fill_parent"
            android:layout_height="80dp"
            android:background="#ff00ff00"
            android:text="element 2"
            tools:context=".MainActivity" />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="80dp"
            android:background="#ff00ff00"
            android:text="element 1"
            tools:context=".MainActivity" />
        <TextView
            android:layout_width="fill_parent"
            android:layout_weight="0.1"
            android:layout_height="0px"
            android:background="#ff00ff00"
            android:text="element 3"
            tools:context=".MainActivity" />
    </LinearLayout>

</FrameLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T10:18:00.123

正如我在评论中所说，我不知道您尝试做的事情在 xml 级别是否可行。一种选择是修改您当前的布局并添加一个根目录`FrameLayout`，您最初将在`ScrollView`其上添加`LinearLayout`. 在此位置，`ImageView`由于用户没有修改布局，因此将按照您的意愿行事。当您需要在布局中显示更多内容时，您`LinearLayout`将从视图层次结构中分离（with `removeView`）并将其附加到`ScrollView`（with `addView`）。当用户返回初始布局时，您将反转这一点。

这将使`ImageView`在进行视图切换时具有不同的高度，因此您希望获得高度`ImageView`并在进行切换时重新设置它。要获得高度，您可以在侦听器中执行此操作或使用`post`in 方法`onCreate`（因为此时尚未布置视图）。另外，请记住用户可以转动手机，我不知道这是否会影响您的布局，但请考虑一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:19:26.837

首先，我尝试运行您的代码，但对我没有任何问题。尽管图像已缩放到我预期的 ScreenHeight-160dp 高度，但滚动视图没有显示，因为您为此图像视图使用了权重 1。

我建议您删除重量并将高度作为包装内容。在这种情况下，Imageview 将只包含图像。当它变大时，如果所有屏幕内容的总高度超过屏幕高度，则自动使用滚动视图。

# sql-server - 在函数内执行 WITH 语句

> ID：13166048
> 
> 赞同：7
> 
> 时间：2012-10-31T19:19:50.483
> 
> 标签：sql-server, tsql, function

我有以下代码：

```
WITH OrderedOrders AS
(

SELECT *,  ROW_NUMBER() OVER (ORDER BY item) AS RowNumber
 from  dbo.fnSplit('1:2:3:5', ':')  
)

 select * from OrderedOrders where rownumber =2 
```

我需要在函数中运行此代码，但是我无法使语法正确。现在是这样的：

```
CREATE FUNCTION [dbo].[FN_INDICE_SPLIT]
    (@sInputList VARCHAR(8000),@sDelimiter VARCHAR(8000),@INDICE INT)

RETURN TABLE 

;WITH OrderedOrders AS
( 
SELECT *,  ROW_NUMBER() OVER (ORDER BY item) AS RowNumber
 from  dbo.fnSplit(@sDelimiter, @INDICE)  
)
select ITEM from OrderedOrders where RowNumber=@INDICE 
```

如果我尝试执行这个，它会给我这个错误：

```
Msg 156, Level 15, State 1, Procedure FN_INDICE_SPLIT, Line 4
Incorrect syntax near the keyword 'RETURN'. 
```

我尝试以多种方式做到这一点，但我不断收到语法错误，我不知道出了什么问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T19:22:26.480

表值函数中的 WITH 之前不需要分号。特别是考虑到您甚至不能在 TVF 中使用多语句，因此没有理由存在语句分隔符。

正确的形式是`CREATE FUNCTION (...) RETURNS TABLE AS RETURN <statement>`

```
CREATE FUNCTION [dbo].[FN_INDICE_SPLIT]
    (@sInputList VARCHAR(8000),@sDelimiter VARCHAR(8000),@INDICE INT)
RETURNS TABLE 
AS RETURN
WITH OrderedOrders AS
( 
SELECT *,  ROW_NUMBER() OVER (ORDER BY item) AS RowNumber
 from  dbo.fnSplit(@sDelimiter, @INDICE)  
)
select ITEM from OrderedOrders where RowNumber=@INDICE
GO 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T19:24:10.637

您应该使用 RETURN* *S* *

```
RETURNS TABLE 
```

# objective-c - 如何在 iOS 上开始使用 ARM？

> ID：13166055
> 
> 赞同：2
> 
> 时间：2012-10-31T19:20:22.757
> 
> 标签：objective-c, ios, c, arm

只是好奇如何开始了解 iOS 下的 ARM。任何帮助都会非常好。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-31T22:10:43.643

在我看来，最好的开始方式是

1.  编写一小段 C 代码（后来的 Objective-C）
2.  看对应的汇编代码
3.  找出足以理解汇编代码的内容
4.  重复！

为此，您可以使用 Xcode：

1.  创建一个新的 iOS 项目（单视图应用程序很好）
2.  添加一个C文件scratchpad.c
3.  在项目构建设置中，将“生成调试符号”设置为“否”
4.  确保目标是 iOS 设备，而不是模拟器
5.  打开scratchpad.c并打开助手编辑器
6.  将助手编辑器设置为Assembly并选择“Release”

# 示例 1

将以下函数添加到暂存器.c：

```
void do_nothing(void)
{
    return;
} 
```

如果您现在在助手编辑器中刷新程序集，您应该会看到很多以点（指令）开头的行，然后是

```
_do_nothing:
@ BB#0:
    bx  lr 
```

让我们暂时忽略这些指令，看看这三行。通过在互联网上进行一些搜索，您会发现这些行是：

1.  标签（以下划线为前缀的函数名称）。
2.  只是编译器发出的注释。
3.  返回声明。`b`方法分支，暂时忽略（`x`它与指令集之间的切换有关），并且`lr`是链接寄存器，调用者存储返回地址。

# 示例 2

让我们稍微加强一下并将代码更改为：

```
extern void do_nothing(void);

void do_nothing_twice(void)
{
    do_nothing();
    do_nothing();
} 
```

保存并刷新程序集后，您将获得以下代码：

```
_do_nothing_twice:
@ BB#0:
    push    {r7, lr}
    mov r7, sp
    blx _do_nothing
    pop.w   {r7, lr}
    b.w _do_nothing 
```

同样，通过在互联网上进行一些搜索，您会发现每一行的含义。需要做更多的工作，因为打了两个电话：第一个电话需要返回给我们，所以我们需要改变`lr`. 这是由`blx`指令完成的，它不仅跳转到`_do_nothing`，而且将下一条指令的地址（返回地址）存储在 中`lr`。

因为我们改变了返回地址，所以我们必须将它存储在某个地方，所以它被压入堆栈。第二个跳转有一个`.w`后缀，但现在让我们忽略它。为什么函数看起来不像这样？

```
_do_nothing_twice:
@ BB#0:
    push    {lr}
    blx _do_nothing
    pop.w   {lr}
    b.w _do_nothing 
```

这也可以，但在 iOS 中，约定是将帧指针存储在`r7`. 帧指针指向堆栈中我们存储前一个帧指针和前一个返回地址的位置。

所以代码的作用是：首先，它压入堆栈，`r7`然后`lr`它`r7`指向新的堆栈帧（位于堆栈顶部，并`sp`指向堆栈顶部），然后它分支第一次，然后它恢复`r7`，`lr`最后它第二次分支。`bx lr`不需要最后的A ，因为被调用的函数将返回到`lr`，它指向我们的调用者。

# 示例 3

让我们看最后一个例子：

```
void swap(int *x, int *y)
{
    int temp = *x;
    *x = *y;
    *y = temp;
} 
```

汇编代码是：

```
_swap:
@ BB#0:
    ldr r2, [r0]
    ldr r3, [r1]
    str r3, [r0]
    str r2, [r1]
    bx  lr 
```

通过一些搜索，您将了解到参数和返回值存储在寄存器`r0`-`r3`中，并且我们可以自由地使用它们进行计算。代码的作用很简单：它将`r0`and`r1`指向的值加载到`r2`and中`r3`，然后以交换的顺序将它们存储回来，然后分支回来。

# 等等

就是这样：编写小片段，获取足够的信息以大致了解每一行中发生的事情，然后重复。希望有帮助！

# c++ - 正确播种随机数生成器（Mersenne twister）c ++

> ID：13166058
> 
> 赞同：3
> 
> 时间：2012-10-31T19:20:36.507
> 
> 标签：c++, random, srand

除了是个垃圾程序员之外，我的行话还不够格。我会尽力解释我自己。[我已经使用randomlib](http://randomlib.sourceforge.net/html/index.html)实现了一个 Merssene twister 随机数生成器。诚然，我对 Visual 8 C++ 的随机数生成器的工作原理不太熟悉，但我发现我可以在其中播种一次`srand(time(NULL))`，`main()`并且可以安全地`rand()`在其他类中使用。我拥有的 Merssene twister 需要创建一个对象，然后为该对象播种。

```
#include <RandomLib/Random.hpp>
RandomLib::Random r;        // create random number object
r.Reseed();                 // seed with a "unique" seed
float d = r.FloatN();   // a random in [0,1] rounded to the nearest double 
```

如果我想在一个类中生成一个随机数，我该如何做到这一点而不必每次都定义一个对象。我只是担心如果我使用计算机时钟，我每次运行都会使用相同的种子（每秒只会改变一次）。

我解释得对吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:26:21.957

Random 对象本质上是您需要保留的状态信息。您可以使用所有常规技术：您可以将其作为全局变量或将其作为参数传递。如果特定类需要随机数，您可以将`Random`对象保留为类成员，以为该类提供随机性。

* * *

C++`<random>`库的相似之处在于它需要构建一个对象作为随机性/RNG 状态的来源。这是一个很好的设计，因为它允许程序控制对状态的访问，例如，保证多线程的良好行为。C++`<random>`库甚至包括 mersenne twister 算法。

这是一个示例，显示将 RNG 状态保存为类成员（使用`std::mt19937`代替`Random`）

```
#include <random> // for mt19937
#include <algorithm> // for std::shuffle
#include <vector>

struct Deck {
    std::vector<Cards> m_cards;
    std::mt19937 eng; // save RNG state as class member so we don't have to keep creating one

    void shuffle() {
        std::shuffle(std::begin(m_cards), std::end(m_cards), eng);
    }
};

int main() {
    Deck d;
    d.shuffle();
    d.shuffle(); // this reuses the RNG state as it was at the end of the first shuffle, no reseeding
} 
```

# php - 将mysql查询限制为1个结果？

> ID：13166060
> 
> 赞同：2
> 
> 时间：2012-10-31T19:20:47.850
> 
> 标签：php, mysql, search

我有从 mysql 查询运行的搜索脚本。如果他们的 display_name 或 location 与查询类似，它将从数据库中提取匹配的用户。当我搜索用户显示名称时，每个用户只得到一个结果，如下所示：

搜索 'Tom' = 2 个结果为 tom = 1.tom davies 和 2.tom smith。

无论出于何种原因，如果我搜索位置，即曼彻斯特，它会复制每个用户的结果，例如：

汤姆·戴维斯 汤姆·戴维斯 汤姆·戴维斯 汤姆·戴维斯 汤姆·史密斯 汤姆·史密斯 汤姆·史密斯 汤姆·史密斯

有人可以解释我如何阻止它这样做。我只希望它为每个匹配搜索查询的用户显示一个结果，而不是多次显示同一个用户。我确定这与从 ptb_users 和 ptb_profiles 中全选有关，但我需要包含 ptb_users 中的“帐户类型”和“帐户状态”。

谢谢

```
<?php
//PHP CODE STARTS HERE

if(isset($_GET['submit'])){

// Change the fields below as per the requirements
$db_host="localhost";
$db_username="root";
$db_password="";
$db_name="database";
$db_tb_atr_name="display_name";

//Now we are going to write a script that will do search task
// leave the below fields as it is except while loop, which will display results on screen

mysql_connect("$db_host","$db_username","$db_password");
mysql_select_db("$db_name");

$query=mysql_real_escape_string($_GET['query']);

$query_for_result=mysql_query("SELECT *
                        FROM ptb_users, ptb_profiles
                        WHERE ptb_users.account_type = \"User\" AND ptb_users.account_status = \"Active\" AND ptb_profiles.user_id = ptb_users.id AND display_name like '%".$query."%' 
        OR location LIKE '%".$query."%' OR age LIKE '%".$query."%'");
echo "<div class=\"results\">";
while($data_fetch=mysql_fetch_array($query_for_result))
{
    echo "<div class=\"spacing\"><a href=\"profile.php?id={$data_fetch['user_id']}\">";
    echo substr($data_fetch[$db_tb_atr_name], 0,160);
    echo "</a></div>";

}

mysql_close();
}

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T19:23:09.317

使用 LIMIT 子句

```
"SELECT * FROM ptb_users, ptb_profiles
WHERE ptb_users.account_type = \"User\" AND ptb_users.account_status = \"Active\" AND 
ptb_profiles.user_id = ptb_users.id AND display_name like '%".$query."%' 
        OR location LIKE '%".$query."%' OR age LIKE '%".$query."%' LIMIT 1" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T19:29:01.150

看起来您应该加入 ptb_users 和 ptb_profiles？例如

```
SELECT * 
FROM ptb_users AS u
INNER JOIN ptb_profiles AS p ON u.id = p.user_id
WHERE u.account_type = \"User\"
    AND u.account_status = \"Active\"
    AND u.display_name like '%".$query."%' 
    OR p.location LIKE '%".$query."%'
    OR u.age LIKE '%".$query."%'
GROUP BY u.display_name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T19:33:03.190

什么查询...基本上您可以使用 distinct 或 group by...

```
"SELECT * FROM ptb_users, ptb_profiles WHERE ptb_users.account_type = \"User\" 
AND ptb_users.account_status = \"Active\" AND ptb_profiles.user_id = ptb_users.id 
AND display_name like '%".$query."%' OR location LIKE '%".$query."%' 
OR age LIKE '%".$query."%' GROUP BY display_name" 
```

分组方式：[http ://www.tizag.com/mysqlTutorial/mysqlgroupby.php](http://www.tizag.com/mysqlTutorial/mysqlgroupby.php)

区别：[http ://www.w3schools.com/sql/sql_distinct.asp](http://www.w3schools.com/sql/sql_distinct.asp)

您还可以使用 LIMIT 来限制返回的行数，例如在查询末尾添加 LIMIT 10 将只允许最多返回 10 行。

# sql - 基于动态标准的多次计数

> ID：13166063
> 
> 赞同：2
> 
> 时间：2012-10-31T19:20:54.363
> 
> 标签：sql, ms-access

我有两个数据库，我想比较一个案例出现的次数。

选项卡1：

```
ID     Sequence
A2D    1
A2D    2
A2D    3
A3D    1 
```

选项卡2：

```
ID     Sequence
A2D    1
A2D    2
A3D    1
A3D    2 
```

现在，对于这个例子，我试图得到这个结果：

```
ID     Table1       Table2
A2D    3            2
A3D    1            2 
```

我已经尝试了这些代码但没有成功：

```
SELECT R1.ID as ID, COUNT(R1.ID) as Table1, 
COUNT(R2.ID) as Table2
FROM TAB1 AS R1, TAB2 AS R2
WHERE R1.ID = R2.ID
GROUP BY R1.ID 
```

这个给了我错误的计数值...

此外，这只是崩溃：

```
select 
    ( 
     select count(*) as Table1
     from TAB1
     where ID = R1.ID
    ),(
      select count(*) as Table2
      from TAB2
      where ID= R1.ID
     )
FROM TAB1 AS R1 
```

正如你所看到的，我试图让我的标准动态化。我发现的大多数示例都包括基本的硬编码标准。但就我而言，我希望查询查看我的第一个表 ID，计算它出现的时间量，对具有相同 ID 的第二个表执行此操作，然后转到下一个 ID。

如果我的问题缺乏信息或令人困惑，请直接问我，我会尽力更准确。

提前致谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:22:59.763

在这里，我使用 UNION ALL 作为子查询

```
SELECT ID, SUM(T1) AS Table1, SUM(T2) AS Table2
FROM
    (SELECT ID, COUNT(ID) AS T1,         0 AS T2 FROM TAB1 GROUP BY ID
     UNION ALL
     SELECT ID,         0 AS T1, COUNT(ID) AS T2 FROM TAB2 GROUP BY ID)
GROUP BY ID
HAVING SUM(T1)>0 AND SUM(T2)>0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:30:14.463

不知道我是否理解你的问题，但你可以尝试这样的事情：

```
SELECT DISTINCT t.ID, 
       (SELECT COUNT(ID) FROM R1 WHERE ID = t.ID) AS table1,
       (SELECT COUNT(ID) FROM R2 WHERE ID = t.ID) AS table2
FROM table1 t 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:35:22.383

我使用了不同的方法，但不幸的是我必须使用两个查询，我仍然不知道它们是否可以组合在一起。第一个仅用于对两个表进行求和，并结合结果：

```
SELECT "Tab1" AS [Table], Tab1.ID, Count(*) AS Total
FROM Tab1
GROUP BY "Tab1", Tab1.ID
UNION SELECT "Tab2" AS [Table], Tab2.ID, Count(*) AS Total
FROM Tab2
GROUP BY "Tab2", Tab2.ID 
```

并且，由于 Access 支持 Pivot 查询，您可以使用它：

```
TRANSFORM Sum(qrySums.[Total]) AS Total
SELECT qrySums.[ID]
FROM qrySums
GROUP BY qrySums.[ID]
PIVOT qrySums.[Table]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T20:59:32.187

为了获得所需的结果，我将其分解为两个子查询（R1SQ 和 R2SQ）和一个主 UNION 查询 - R1R2，它使用内部、左和右连接来包含所有行条目，包括那些没有出现在两个表中的行：

**R1SQ**

```
SELECT R1.Builder, Count(R1.Builder) AS Table1
FROM R1
GROUP BY R1.Builder; 
```

**R2SQ**

```
SELECT R2.Builder_E, Count(R2.Builder_E) AS Table2
FROM R2
GROUP BY R2.Builder_E; 
```

**R1R2**

```
SELECT R1SQ.Builder, R1SQ.Table1, R2SQ.Table2
FROM R1SQ INNER JOIN R2SQ ON R1SQ.Builder = R2SQ.Builder_E
UNION
SELECT R1SQ.Builder, R1SQ.Table1, 0 AS Table2
FROM R1SQ LEFT JOIN R2SQ ON R1SQ.Builder = R2SQ.Builder_E
WHERE (((R2SQ.Builder_E) Is Null))
UNION
SELECT R2SQ.Builder_E, 0 AS Table1, R2SQ.Table2
FROM R1SQ RIGHT JOIN R2SQ ON R1SQ.Builder = R2SQ.Builder_E
WHERE (((R1SQ.Builder) Is Null))
ORDER BY R1SQ.Builder; 
```

# assembly - 如何在没有来自 c 库的 printf 的情况下在汇编级编程中打印整数？

> ID：13166064
> 
> 赞同：25
> 
> 时间：2012-10-31T19:20:54.010
> 
> 标签：assembly, x86, integer, output, nasm

谁能告诉我以十进制格式在寄存器中显示值的*纯汇编*代码？请不要建议使用 printf hack，然后使用 gcc 编译。

描述：

好吧，我对 NASM 进行了一些研究和一些实验，并认为我可以使用 c 库中的 printf 函数来打印一个整数。我通过使用 GCC 编译器编译目标文件来做到这一点，并且一切正常。

但是，我想要实现的是以十进制形式打印存储在任何寄存器中的值。

我做了一些研究，发现 DOS 命令行的中断向量 021h 可以显示字符串和字符，而 2 或 9 在 ah 寄存器中，数据在 dx 中。

结论：

我发现的所有示例都没有显示如何在不使用 C 库的 printf 的情况下以十进制形式显示寄存器的内容值。有谁知道如何在装配中做到这一点？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-31T19:53:19.213

您需要编写一个二进制到十进制的转换例程，然后使用十进制数字生成“数字字符”进行打印。

您必须假设某处某处会在您选择的输出设备上打印一个字符。调用这个子程序“print_character”；假设它采用 EAX 中的字符代码并保留所有寄存器。（如果您没有这样的子例程，那么您还有一个额外的问题，应该是另一个问题的基础）。

如果您在寄存器（例如 EAX）中有一个数字的二进制代码（例如，0-9 的值），您可以通过添加“零”字符的 ASCII 代码将该值转换为该数字的字符到登记册。这很简单：

```
 add     eax, 0x30    ; convert digit in EAX to corresponding character digit 
```

然后您可以调用 print_character 来打印数字字符代码。

要输出任意值，您需要选择数字并打印它们。

从根本上说，挑选数字需要使用 10 的幂。最容易使用 10 的幂，例如 10 本身。想象一下，我们有一个除以 10 的例程，它在 EAX 中取一个值，并在 EDX 中产生一个商，在 EAX 中产生一个余数。我把它作为一个练习让你弄清楚如何实施这样的例程。

然后一个具有正确想法的简单例程是为该值可能具有的所有数字生成一个数字。一个 32 位寄存器将值存储到 40 亿，因此您可能会打印 10 位数字。所以：

```
 mov    eax, valuetoprint
         mov    ecx, 10        ;  digit count to produce
loop:    call   dividebyten
         add    eax, 0x30
         call   printcharacter
         mov    eax, edx
         dec    ecx
         jne    loop 
```

这有效......但以相反的顺序打印数字。哎呀！好吧，我们可以利用下推堆栈来存储产生的数字，然后以相反的顺序将它们弹出：

```
 mov    eax, valuetoprint
         mov    ecx, 10        ;  digit count to generate
loop1:   call   dividebyten
         add    eax, 0x30
         push   eax
         mov    eax, edx
         dec    ecx
         jne    loop1
         mov    ecx, 10        ;  digit count to print
loop2:   pop    eax
         call   printcharacter
         dec    ecx
         jne    loop2 
```

留给读者作为练习：抑制前导零。此外，由于我们将数字字符写入内存，而不是将它们写入堆栈，我们可以将它们写入缓冲区，然后打印缓冲区内容。也留给读者作为练习。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-09-19T13:33:42.460

**您需要手动将二进制整数转换为 ASCII 十进制数字的字符串/数组。** ASCII 数字由`'0'`(0x30) 到`'9'`(0x39) 范围内的 1 字节整数表示。 [http://www.asciitable.com/](http://www.asciitable.com/)

对于像十六进制这样的 2 次方基数，请参阅[如何将二进制整数转换为十六进制字符串？](https://stackoverflow.com/questions/53823756/how-to-convert-a-number-to-hex) 在二进制和 2 次方基数之间进行转换可以进行更多优化和简化，因为每组位分别映射到十六进制/八进制数字。

* * *

大多数操作系统/环境没有接受整数并将它们转换为十进制的系统调用。在将字节发送到操作系统之前，您必须自己执行此操作，或者自己将它们复制到视频内存，或者在视频内存中绘制相应的字体字形......

到目前为止，最有效的方法是进行一次执行整个字符串的单个系统调用，因为写入 8 个字节的系统调用与写入 1 个字节的成本基本相同。

这意味着我们需要一个缓冲区，但这根本不会增加我们的复杂性。2^32-1 只有 4294967295，只有 10 位十进制数字。我们的缓冲区不需要很大，所以我们可以使用堆栈。

**通常的算法产生数字 LSD-first（Least Significant Digit first）。由于打印顺序是 MSD 优先的，我们可以从缓冲区的末尾开始并向后工作**。对于其他地方的打印或复制，只需跟踪它的开始位置，而不必费心将其置于固定缓冲区的开头。无需使用 push/pop 来反转任何内容，只需首先将其向后生成即可。

```
char *itoa_end(unsigned long val, char *p_end) {
  const unsigned base = 10;
  char *p = p_end;
  do {
    *--p = (val % base) + '0';
    val /= base;
  } while(val);                  // runs at least once to print '0' for val=0.

  // write(1, p,  p_end-p);
  return p;  // let the caller know where the leading digit is
} 
```

gcc/clang 做得很好，[使用魔法常数乘数](https://stackoverflow.com/questions/41183935/why-does-gcc-use-multiplication-by-a-strange-number-in-implementing-integer-divi)而不是`div`有效地除以 10。（用于 asm 输出的[Godbolt 编译器资源管理器）。](https://gcc.godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,source:%27unsigned+long+mod10(unsigned+long+a+)+%7Breturn+a%2510%3B%7D%0A%0Achar+*itoa_end(unsigned+long+val,+char+*p_end)+%7B%0A++const+unsigned+base+%3D+10%3B%0A++char+*p+%3D+p_end%3B%0A++do+%7B%0A++++*--p+%3D+(val+%25+base)+%2B+!%270!%27%3B%0A++++val+/%3D+base%3B%0A++%7D+while(val)%3B%0A%0A++//+write(1,+p,++p_end-p)%3B%0A%0A++return+p%3B++//+let+the+caller+know+where+the+leading+digit+is%0A%7D%0A%27),l:%275%27,n:%270%27,o:%27C%2B%2B+source+%231%27,t:%270%27)),k:50,l:%274%27,n:%270%27,o:%27%27,s:0,t:%270%27),(g:!((h:compiler,i:(compiler:g72,filters:(b:%270%27,commentOnly:%270%27,directives:%270%27,intel:%270%27),options:%27-xc++-std%3Dgnu11+-O3+-Wall+-march%3Dsandybridge+-fverbose-asm+-funroll-loops%27,source:1),l:%275%27,n:%270%27,o:%27x86-64+gcc+7.2+(Editor+%231,+Compiler+%231)%27,t:%270%27)),k:50,l:%274%27,n:%270%27,o:%27%27,s:0,t:%270%27)),l:%272%27,n:%270%27,o:%27%27,t:%270%27)),version:4)

这个[代码审查问答](https://codereview.stackexchange.com/questions/142842/integer-to-ascii-algorithm-x86-assembly)有一个非常高效的 NASM 版本，它将字符串累积到一个 8 字节的寄存器而不是内存中，准备好存储您希望字符串开始的位置而无需额外复制。

* * *

### 处理有符号整数：

对无符号绝对值使用此算法。( `if(val<0) val=-val;`)。如果原始输入是否定`'-'`的，请在完成后将 a 放在最后。例如，`-10`使用 运行它`10`，产生 2 个 ASCII 字节。然后将 a 存储`'-'`在前面，作为字符串的第三个字节。

* * *

这是一个简单的注释 NASM 版本，`div`对 32 位无符号整数和 Linux`write`系统调用使用（慢但更短的代码）。 只需将寄存器更改为**而**`ecx`不是`rcx`. 但是`add rsp,24`会变成`add esp, 20`因为`push ecx`只有 4 个字节，而不是 8 个。（您还应该`esi`为通常的 32 位调用约定保存/恢复，除非您将其变成宏或仅供内部使用的函数。）

系统调用部分特定于 64 位 Linux。将其替换为适合您系统的任何内容，例如调用 VDSO 页面以在 32 位 Linux 上进行高效的系统调用，或`int 0x80`直接用于低效的系统调用。请参阅[Unix/Linux 上 32 位和 64 位系统调用的调用约定](https://stackoverflow.com/questions/2535989/what-are-the-calling-conventions-for-unix-linux-system-calls-on-x86-64)。或者查看[rkhb 对另一个问题的回答](https://stackoverflow.com/questions/28524535/add-2-numbers-and-print-the-result-using-assembly-x86/28524951#28524951)`int 0x80`，了解以相同方式工作的32 位版本。

**如果您只需要字符串而不打印它**，`rsi`则在离开循环后指向第一个数字。您可以将它从 tmp 缓冲区复制到您实际需要它的任何位置的开头。或者，如果您直接将它生成到最终目的地（例如，传递一个指针 arg），您可以用前导零填充，直到到达您为它留下的空间的前面。除非您总是用零填充到固定宽度，否则没有简单的方法可以在开始之前找出它将是多少位数。

```
ALIGN 16
; void print_uint32(uint32_t edi)
; x86-64 System V calling convention.  Clobbers RSI, RCX, RDX, RAX.
; optimized for simplicity and compactness, not speed (DIV is slow)
global print_uint32
print_uint32:
    mov    eax, edi              ; function arg

    mov    ecx, 0xa              ; base 10
    push   rcx                   ; ASCII newline '\n' = 0xa = base
    mov    rsi, rsp
    sub    rsp, 16               ; not needed on 64-bit Linux, the red-zone is big enough.  Change the LEA below if you remove this.

;;; rsi is pointing at '\n' on the stack, with 16B of "allocated" space below that.
.toascii_digit:                ; do {
    xor    edx, edx
    div    ecx                   ; edx=remainder = low digit = 0..9\.  eax/=10
                                 ;; DIV IS SLOW.  use a multiplicative inverse if performance is relevant.
    add    edx, '0'
    dec    rsi                 ; store digits in MSD-first printing order, working backwards from the end of the string
    mov    [rsi], dl

    test   eax,eax             ; } while(x);
    jnz  .toascii_digit
;;; rsi points to the first digit

    mov    eax, 1               ; __NR_write from /usr/include/asm/unistd_64.h
    mov    edi, 1               ; fd = STDOUT_FILENO
    ; pointer already in RSI    ; buf = last digit stored = most significant
    lea    edx, [rsp+16 + 1]    ; yes, it's safe to truncate pointers before subtracting to find length.
    sub    edx, esi             ; RDX = length = end-start, including the \n
    syscall                     ; write(1, string /*RSI*/,  digits + 1)

    add  rsp, 24                ; (in 32-bit: add esp,20) undo the push and the buffer reservation
    ret 
```

**公共区域。** 随意将其复制/粘贴到您正在处理的任何内容中。如果它坏了，你可以保留两块。（如果性能很重要，请参阅下面的链接；您需要乘法逆而不是`div`。）

这是在循环倒数到 0（包括 0）时调用它的代码。把它放在同一个文件中很方便。

```
ALIGN 16
global _start
_start:
    mov    ebx, 100
.repeat:
    lea    edi, [rbx + 0]      ; put +whatever constant you want here.
    call   print_uint32
    dec    ebx
    jge   .repeat

    xor    edi, edi
    mov    eax, 231
    syscall                             ; sys_exit_group(0) 
```

组装和链接

```
yasm -felf64 -Worphan-labels -gdwarf2 print-integer.asm &&
ld -o print-integer print-integer.o

./print_integer
100
99
...
1
0 
```

用于`strace`查看该程序进行的唯一系统调用是`write()`和`exit()`。[（另请参阅x86](/questions/tagged/x86 "显示标记为“x86”的问题")标签 wiki底部的 gdb / 调试提示，以及那里的其他链接。）

* * *

**相关**：

*   **With`printf`** -[如何在汇编 NASM 中打印一个数字？](https://stackoverflow.com/questions/8194141/how-to-print-a-number-in-assembly-nasm/32853546#32853546)有 x86-64 和 i386 答案。

*   [NASM 程序集将输入转换为整数？](https://stackoverflow.com/questions/19309749/nasm-assembly-convert-input-to-integer/49548057#49548057)是另一个方向，**string->int**。

*   [使用 AT&T 语法将整数打印为字符串，使用 Linux 系统调用而不是 printf](https://stackoverflow.com/questions/45835456/printing-an-integer-as-a-string-with-att-syntax-with-linux-system-calls-instea/45851398#45851398) -相同事物的**AT&T 版本**（但用于 64 位整数）。有关性能的更多评论，以及`div`使用`mul`.

*   [添加 2 个数字并使用与此非常相似的 Assembly x86](https://stackoverflow.com/questions/28524535/add-2-numbers-and-print-the-result-using-assembly-x86/28524951#28524951) 32 位版本打印结果。

*   此[代码审查问答](https://codereview.stackexchange.com/questions/142842/integer-to-ascii-algorithm-x86-assembly)使用乘法逆运算，并将字符串累积到 8 字节寄存器而不是内存中，准备好存储您希望字符串开始的位置而无需额外复制。

*   [如何将二进制整数转换为十六进制字符串？](https://stackoverflow.com/questions/53823756/how-to-convert-a-number-to-hex)- 2 次方基地是特殊的。答案包括标量循环（分支和查表）和 SIMD（SSE2、SSSE3、AVX2 和 AVX512，这非常棒。）

*   [如何打印整数非常快](https://pvk.ca/Blog/2017/12/22/appnexus-common-framework-its-out-also-how-to-print-integers-faster/)的博客文章比较了 C 中的一些策略。例如`x % 100`创建更多的 ILP（指令级并行），以及查找表或更简单的乘法逆（只需要在有限的范围内工作，就像在[这个答案](https://stackoverflow.com/questions/5558492/divide-by-10-using-bit-shifts/5558614#5558614)）将 0..99 余数分解为 2 位小数。
    例如，`(x * 103) >> 10`使用一个`imul r,r,imm8`/`shr r,10`如另一个答案所示。可能以某种方式将其折叠到余数计算本身。

*   [https://tia.mat.br/posts/2014/06/23/integer_to_string_conversion.html](https://tia.mat.br/posts/2014/06/23/integer_to_string_conversion.html)类似的文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T19:49:35.577

我想您想将值打印到标准输出？如果是这种情况
，您必须使用[系统调用](http://en.wikipedia.org/wiki/System_call)来执行此操作。系统调用取决于操作系统。

例如 Linux： [Linux 系统调用表](http://docs.cs.up.ac.za/programming/asm/derick_tut/syscalls.html)

本[教程](http://docs.cs.up.ac.za/programming/asm/derick_tut/)中的 hello world 程序可能会给您一些见解。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-11T13:31:05.880

无法发表评论，所以我以这种方式发布回复。@Ira Baxter，完美答案我只想补充一点，您不需要在发布时将寄存器 cx 设置为值 10 进行除以 10。只需将 ax 中的数字除以“ax==0”

```
loop1: call dividebyten
       ...
       cmp ax,0
       jnz loop1 
```

您还必须存储原始号码中有多少位数。

```
 mov cx,0
loop1: call dividebyten
       inc cx 
```

无论如何，你 Ira Baxter 帮助了我，只有几种方法可以优化代码:)

这不仅与优化有关，还与格式化有关。当您要打印数字 54 时，您要打印 54 而不是 0000000054 :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-19T03:22:44.420

1 -9 是 1 -9。在那之后，一定有一些我也不知道的转换。假设您在 AX (EAX) 中有一个 41H，并且您想在不进行一些服务调用的情况下打印 65，而不是“A”。我认为您需要打印 6 和 5 的字符表示，无论它是什么。必须有一个可以添加的常数才能到达那里。您需要一个模数运算符（但是您在汇编中这样做）并循环所有数字。

不确定，但这是我的猜测。

# objective-c - 在 MapView 上获取 MKCircleView 半径的所有位置坐标

> ID：13166066
> 
> 赞同：1
> 
> 时间：2012-10-31T19:21:10.613
> 
> 标签：objective-c, ios

当用户点击地图时，我有一个`MapView`绘制圆形叠加层的地方`MKCircleView`，它工作正常，但现在我需要获取半径的所有位置坐标（纬度/经度）以存储以供以后用于重新填充地图叠加层。如何获得半径上的所有位置，以便再次显示圆圈？

只存储中心点和半径不是一个选项，因为我必须将这些点同步到服务器

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T19:35:41.927

存储中心点和半径。任何圆的边界内和边界上都有无数个点。如果您需要使用服务器上的数据绘制圆，请使用圆心和半径以及绘图库具有的任何圆/椭圆函数，或者，如果需要，使用圆心和半径以及基本三角函数在圆上生成点以绘制一个多边形。或者，如果您只是将数据反馈到您的应用程序，请使用该类的`+circleWithCenterCoordinate:radius:`方法创建您的 MKCircle 对象。

# java - 从 Wikipedia XML 转储中提取表

> ID：13166068
> 
> 赞同：1
> 
> 时间：2012-10-31T19:21:11.433
> 
> 标签：java, xml-parsing, extract, wikipedia, large-data

我想解析 XML Wikipedia 转储并从中提取所有不同类型的表（不仅仅是信息框）

我正在使用[wikixmlj](http://code.google.com/p/wikixmlj/)解析转储，但问题是解析维基百科转储中不同类型的表（拆分单元格表、合并单元格表、带有颜色代码的表）。

我能够解析 XML 文章，直到找到标记为表格的项目，但是在将表格解析为对象时我没有遵循的标准，而且似乎有许多类型的表格有很多排列。

是否有一些关于表类型的文档化标准要遵循，以便我可以在我要创建的运行时对象中涵盖这些标准，或者有什么方法可以解决这个问题？

笔记：

这些是一些示例，可以帮助您了解我的意思：

> [http://en.wikipedia.org/wiki/List_of_Presidents_of_the_United_States](http://en.wikipedia.org/wiki/List_of_Presidents_of_the_United_States) 见 Andrew Jackson 行（一些行被合并和拆分）
> 
> [http://en.wikipedia.org/wiki/List_of_pharaohs](http://en.wikipedia.org/wiki/List_of_pharaohs)
> 
> [http://en.wikipedia.org/wiki/Open_Handset_Alliance](http://en.wikipedia.org/wiki/Open_Handset_Alliance)
> 
> [http://en.wikipedia.org/wiki/Comparison_of_web_server_software](http://en.wikipedia.org/wiki/Comparison_of_web_server_software) 有时标题位于顶部和底部

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T18:02:50.697

好的，如果您只对表格本身感兴趣，则需要执行以下操作

1-下载维基百科转储（所有转储）

2-将转储中的表提取到单独的文件或一组文件中：使用正则表达式`\{\|[\s|\S]+?\n\|-?\}`

3-使用库[gwtwiki](http://code.google.com/p/gwtwiki/)为转储构建模型，然后仅将表文件转换为 html：

-将[这个类](http://code.google.com/p/gwtwiki/source/browse/trunk/info.bliki.wiki/bliki-pdf/src/test/java/info/bliki/api/creator/HTMLConstants.java?r=5766)和[这个类](http://pastie.org/5397397)添加到项目中

-添加gwtwiki和其他必要的库

* * *

您现在拥有包含出现在整个维基百科转储中的表格的 html 文件，并且表格是 html 格式，因此很容易操作（请注意，如果您想通过代码操作任何文件以将其写入 unicode 文件，因为表中某些字符的编码）

# sql - 索引结构可最大限度地提高任何索引列组合的速度

> ID：13166071
> 
> 赞同：4
> 
> 时间：2012-10-31T19:21:26.540
> 
> 标签：sql, sql-server, indexing

我有一个包含大约五个可能的索引列的数据库，所有这些列都以不同的方式有用。我们称它们为 System、Source、Heat、Time 和 Row。一起使用 System 和 Row 将生成一个唯一键，如果按 System-Row 排序，数据库还将针对五个索引变量的任意组合进行排序（按照我上面列出的顺序）。

我的问题是我使用这些列的所有组合：有时我想将每个系统行加入下一个系统（行 + 1），有时我想通过系统源热进行 GROUP 或 WHERE，有时我想查看 System-Source WHERE Time is in a specific window 的所有条目等。

基本上，我想要一个索引结构，其功能类似于这五个索引的每个可能的排列（当然，以正确的顺序），而不是实际进行每个排列（尽管如果有必要我愿意这样做）。我正在做统计/分析，而不是传统的数据库工作，因此索引的大小和创建/更新它的速度不是问题；我只关心加快我的即兴查询，因为我倾向于思考它们，运行它们，等待 5-10 分钟，然后再也不使用它们。因此，我主要关心的是将“等待 5-10 分钟”减少到更像“等待 1-2 分钟”。

我的排序数据看起来像这样：

```
Sys So H Ti R
1   1  0 .1 1
1   1  1 .2 2
1   1  1 .3 3
1   1  2 .3 4
1   2  0 .5 5
1   2  0 .6 6
1   2  1 .8 7
1   2  2 .8 8 
```

编辑：它可能会简化一些事情，系统实际上总是需要作为第一列包含在内，以使其他 4 列中的任何一个按排序顺序排列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:43:14.460

如果您**只**关心 SELECT 速度而不关心 INSERT，那么您可以将所有组合具体化为 INDEXED 视图。您只需要原始表的 24 倍的存储空间，制作一张表和 23 个 INDEXED VIEW，每个 5 列。

例如

```
create table data (
    id int identity primary key clustered,
    sys int,
    so int,
    h float,
    ti datetime,
    r int);
GO
create view dbo.data_v1 with schemabinding as
    select sys, so, h, ti, r
    from dbo.data;
GO
create unique clustered index cix_data_v1 on data_v1(sys, h, ti, r, so)
GO
create view dbo.data_v2 with schemabinding as
    select sys, so, h, ti, r
    from dbo.data;
GO
create unique clustered index cix_data_v2 on data_v2(sys, ti, r, so, h)
GO

-- and so on and so forth, keeping "sys" anchored at the front 
```

但是请注意
[问：为什么查询优化器没有拾取我的索引视图以用于查询计划？](http://msdn.microsoft.com/en-us/library/dd171921%28v=sql.100%29.aspx)（在链接文章中搜索）

* * *

如果空间是一个问题，那么下一个最好的办法是在 4 列中的每一列上创建单独的索引，以系统开头，即 (sys,ti)、(sys,r) 等。如果有帮助，这些可以一起使用查询，否则它将恢复为全表扫描。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:47:48.867

很抱歉花了一段时间才回到这个问题上，我不得不在其他几个星期内工作。无论如何，在尝试了一堆事情之后（包括这里建议的所有内容，甚至是蛮力的“为每个排列创建索引”方法），我还没有找到任何可以显着提高性能的索引方法。

但是，我找到了一个替代的非索引解决方案：只选择我感兴趣的行和列到中间表中，然后使用它们而不是完整的表（所以我使用大约 5 百万行 6 列代替30 百万行 35 列）。最初的选择和表创建有点慢，但是之后的步骤要快得多，即使我只运行一次，我实际上也节省了时间（考虑到我改变事物的频率，通常不止一次）。

我怀疑这种巨大改进的原因对于大多数 SQL 用户来说是显而易见的（可能与页面文件大小有关），如果是这样，我深表歉意。我唯一的借口是，我是一名统计学家，试图自学如何做到这一点，虽然我很擅长（最终）完成我想做的事情，但我对它的机制的理解是*如何*的done 非常接近“这是一个神奇的黑匣子，别担心”。

# java - 使用java检查注册表项中是否存在特定键？

> ID：13166075
> 
> 赞同：1
> 
> 时间：2012-10-31T19:21:36.697
> 
> 标签：java, registry

如何使用 java 验证注册表项中是否存在特定键？
使用 java（运行时）。

# forms - 地理地图选择器

> ID：13166076
> 
> 赞同：3
> 
> 时间：2012-10-31T19:21:38.360
> 
> 标签：forms, api, maps, geo

我正在开发一个基于用户选择的位置/区域提供服务的应用程序。

一种方法是只给他/她一个国家的下拉列表。

我想知道是否可以为用户提供交互式地图，用户可以在其中单击/选择特定国家/地区。

# c++ - 重载算术中的移动语义和传递右值引用

> ID：13166079
> 
> 赞同：12
> 
> 时间：2012-10-31T19:21:45.857
> 
> 标签：c++, c++11, rvalue-reference, move-semantics

我正在用 C++ 编写一个小型数值分析库。我一直在尝试使用包括移动语义在内的最新 C++11 特性来实现。我理解以下帖子中的讨论和最佳答案：[C++11 rvalues and move semantics chaos (return statement)](https://stackoverflow.com/questions/4986673/c11-rvalues-and-move-semantics-confusion)，但有一种情况我仍在尝试解决。

我有一个类，叫做它`T`，它完全配备了重载运算符。我也有复制和移动构造函数。

```
T (const T &) { /*initialization via copy*/; }
T (T &&) { /*initialization via move*/; } 
```

我的客户端代码大量使用运算符，因此我试图确保复杂的算术表达式从移动语义中获得最大收益。考虑以下：

```
T a, b, c, d, e;
T f = a + b * c - d / e; 
```

如果没有移动语义，我的操作员每次都使用复制构造函数创建一个新的局部变量，因此总共有 4 个副本。我希望通过移动语义我可以将其减少到 2 个副本加上一些移动。在带括号的版本中：

```
T f = a + (b * c) - (d / e); 
```

每个`(b * c)`并且`(d / e)`必须以通常的方式使用副本创建临时对象，但是如果我可以利用其中一个临时对象来仅通过移动来累积剩余的结果，那就太好了。

使用 g++ 编译器，我已经能够做到这一点，但我怀疑我的技术可能不安全，我想完全理解为什么。

这是加法运算符的示例实现：

```
T operator+ (T const& x) const
{
    T result(*this);
    // logic to perform addition here using result as the target
    return std::move(result);
}
T operator+ (T&& x) const
{
    // logic to perform addition here using x as the target
    return std::move(x);
} 
```

如果没有对 的调用`std::move`，则只会`const &`调用每个运算符的版本。但是当`std::move`如上所述使用时，随后的算术（在最里面的表达式之后）是使用`&&`每个运算符的版本执行的。

我知道 RVO 可以被抑制，但在计算量非常大的现实问题上，似乎收益略高于 RVO 的缺乏。也就是说，经过数百万次计算，当我包含`std::move`. 虽然老实说，没有它就足够快了。我真的只是想完全理解这里的语义。

有没有好心的 C++ 大师愿意花时间以简单的方式解释我在这里使用 std::move 是否以及为什么是一件坏事？提前谢谢了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T19:55:36.693

您应该更喜欢将运算符重载为自由函数以获得完整的类型对称性（可以在左侧和右侧应用相同的转换）。这使得问题中遗漏的内容更加明显。将您的运营商重述为您提供的免费功能：

```
T operator+( T const &, T const & );
T operator+( T const &, T&& ); 
```

但是你没有提供一个版本来处理左侧是一个临时的：

```
T operator+( T&&, T const& ); 
```

当两个参数都是右值时，为了避免代码中的歧义，您需要提供另一个重载：

```
T operator+( T&&, T&& ); 
```

常见的建议是实现`+=`为修改当前对象的成员方法，然后编写`operator+`为修改接口中适当对象的转发器。

我并没有真正考虑这么多，但可能有一个替代使用`T`（没有 r/lvalue 引用），但我担心它不会减少您需要提供的重载数量以`operator+`在所有情况下提高效率。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-02T21:59:47.203

建立在其他人所说的基础上：

*   调用`std::move`in`T::operator+( T const & )`是不必要的，可能会阻止 RVO。
*   最好提供一个`operator+`代表`T::operator+=( T const & )`.

我还想补充一点，可以使用完美转发来减少所需的非成员`operator+`重载的数量：

```
template< typename L, typename R >
typename std::enable_if<
  std::is_convertible< L, T >::value &&
  std::is_convertible< R, T >::value,
  T >::type operator+( L && l, R && r )
{
  T result( std::forward< L >( l ) );
  result += r;
  return result;
} 
```

对于某些运算符，这个“通用”版本就足够了，但由于加法通常是可交换的，我们可能希望检测右侧操作数何时是右值并修改它，而不是移动/复制左侧操作数。这需要一个用于左值右手操作数的版本：

```
template< typename L, typename R >
typename std::enable_if<
  std::is_convertible< L, T >::value &&
  std::is_convertible< R, T >::value &&
  std::is_lvalue_reference< R&& >::value,
  T >::type operator+( L && l, R && r )
{
  T result( std::forward< L >( l ) );
  result += r;
  return result;
} 
```

另一个用于右值的右手操作数：

```
template< typename L, typename R >
typename std::enable_if<
  std::is_convertible< L, T >::value &&
  std::is_convertible< R, T >::value &&
  std::is_rvalue_reference< R&& >::value,
  T >::type operator+( L && l, R && r )
{
  T result( std::move( r ) );
  result += l;
  return result;
} 
```

最后，您可能还对[Boris Kolpackov](http://codesynthesis.com/~boris/blog/2012/06/26/efficient-argument-passing-cxx11-part2/)和[Sumant Tambe](http://cpptruths.blogspot.ca/2012/10/c11-idioms-2012-silicon-valley-code-camp.html)提出的技术以及 Scott Meyers对该想法的[回应感兴趣。](http://scottmeyers.blogspot.ca/2012/10/parameter-types-in-constructors.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-31T22:54:50.123

我同意 David Rodríguez 的观点，即使用非成员`operator+`函数会是一个更好的设计，但我将把它放在一边，专注于你的问题。

我很惊讶您在编写时看到性能下降

```
T operator+(const T&)
{
  T result(*this);
  return result;
} 
```

代替

```
T operator+(const T&)
{
  T result(*this);
  return std::move(result);
} 
```

因为在前一种情况下，编译器应该能够使用 RVO`result`在内存中构造函数的返回值。在后一种情况下，编译器需要移动`result`到函数的返回值中，因此会产生移动的额外成本。

一般来说，这种事情的规则是，假设你有一个函数返回一个对象（即，不是引用）：

*   如果您要返回本地对象或按值参数，请不要应用`std::move`它。这允许编译器执行 RVO，这比复制或移动便宜。
*   如果您要返回右值引用类型的参数，`std::move`请对其应用。这会将参数转换为右值，从而允许编译器从中移动。如果只返回参数，编译器必须执行一个复制到返回值。
*   如果您要返回一个通用引用的参数（即，`&&`可能是右值引用或左值引用的推导类型的“”参数），`std::forward`请应用它。没有它，编译器必须执行复制到返回值。有了它，如果引用绑定到右值，编译器就可以执行移动。

# wcf - 带有无扩展服务的 WCF 和 Autofac

> ID：13166084
> 
> 赞同：1
> 
> 时间：2012-10-31T19:22:11.807
> 
> 标签：wcf, autofac

我有一段时间试图让它发挥作用。

我希望 Autofac 管理我的 WCF 服务并使用无扩展服务。

任何想法为什么这不起作用？

```
namespace SAIF.Services.WCF.Host
{
    using System;
    using System.ServiceModel.Activation;
    using System.Web;
    using System.Web.Routing;
    using Autofac;
    using Autofac.Integration.Wcf;
    using SAIF.Core.Domain;
    using SAIF.Core.Domain.Model;
    using SAIF.Repositories;
    using SAIF.Services.WCF.Core;
    using SAIF.Services.WCF.Services;

    public class Global : HttpApplication
    {
        protected void Application_Start(object sender, EventArgs e)
        {
            // Create Routes
            var factory = new AutofacServiceHostFactory();
            RouteTable.Routes.Add(new ServiceRoute("FileService", factory, typeof(SAIF.Services.WCF.Core.IFileService)));
            RouteTable.Routes.Add(new ServiceRoute("WebContext", factory, typeof(SAIF.Services.WCF.Core.IWebContextService)));

            // Autofac Config
            var builder = new ContainerBuilder();

            builder.Register(x => new EFUnitOfWork())
                .As<EFUnitOfWork>()
                .As<IUnitOfWork>();

            builder.RegisterGeneric(typeof(Repository<>))
                .As(typeof(IRepository<>));

            builder.Register(x => new FileService())
                .As<IFileService>();

            builder.Register(x => new WebContextService(x.Resolve<IRepository<WebContextItem>>(), x.Resolve<IUnitOfWork>()))
                .As<IWebContextService>();

            AutofacHostFactory.Container = builder.Build();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:25:30.733

~~I'm not sure if the Application_Start method of the Global.asax gets called by WAS in IIS.~~

[This SO answer](https://stackoverflow.com/questions/2453353/what-is-the-global-asax-application-start-equivalent-when-using-was-in-iis7) seems to be similar to what you are looking for and links to [this blog post](http://consultingblogs.emc.com/matthall/archive/2009/08/18/castle-windsor-and-non-http-protocol-wcf-services.aspx)

Implement an AppInitialize method and put it in the [App_Code](http://msdn.microsoft.com/en-us/library/t990ks23(VS.80).aspx) folder.

```
public class InitialiseService
{
   /// <summary>
   /// AppInitialize method to register the IOC container.
   /// </summary>
   public static void AppInitialize()
   {
       // Create Routes
       var factory = new AutofacServiceHostFactory();
       RouteTable.Routes.Add(new ServiceRoute("FileService", factory, typeof(SAIF.Services.WCF.Core.IFileService)));
       RouteTable.Routes.Add(new ServiceRoute("WebContext", factory, typeof(SAIF.Services.WCF.Core.IWebContextService)));

       // Autofac Config
       var builder = new ContainerBuilder();

       //...the rest of your code...
   }
} 
```

[Another SO answer](https://stackoverflow.com/questions/2921802/serviceroute-webservicehostfactory-kills-wsdl-generation-how-to-create-extens) talks about using **ServiceHostFactory** rather than **WebServiceHostFactory**.

Can you try using that instead of the AutofacServiceHostFactory?

***Update***

This is an old question/answer but I have since tried following the instructions on Autofac documentation

see [https://code.google.com/p/autofac/wiki/WcfIntegration#WAS_Hosting_Extensionless_Services](https://code.google.com/p/autofac/wiki/WcfIntegration#WAS_Hosting_Extensionless_Services)

A key part to *extensionless* routing in is adding the UrlRoutingModule

# python - python中的字符串比较但不是Levenshtein距离（我认为）

> ID：13166089
> 
> 赞同：4
> 
> 时间：2012-10-31T19:22:43.097
> 
> 标签：python, compare, using, levenshtein-distance

我在我正在阅读的一篇论文中发现了一个粗略的字符串比较，如下所示：

他们使用的方程式如下（摘自论文，稍作改动以使其更通用和可读）由于作者的描述不是很清楚（使用示例），我试图用自己的话解释更多作者）

例如对于 2 个序列 ABCDE 和 BCEFA，有两个可能的图

图 1) 将 B 与 BC 与 C 和 E 与 E 连接起来

图 2) 将 A 与 A 连接起来

当我连接其他三个（图 1）时，我无法将 A 与 A 连接起来，因为那将是交叉线（想象你在 BB、CC 和 EE 之间画线）；也就是说，AA 上墨的线将穿过连接 BB、CC 和 EE 的线。所以这两个序列产生了两个可能的图；一个有 3 个连接（BB、CC 和 EE），另一个只有一个（AA），然后我计算分数 d，如下式所示。

> 因此，为了定义两个五弦之间的相似度，我们计算它们之间的距离 d。对齐两个五串，我们寻找它们字符之间的所有身份，无论这些身份可能位于何处。如果每个身份都由两个五字符串之间的链接表示，我们为这对定义一个图。我们将此图的任何部分称为配置。
> 
> 接下来，我们保留所有没有字符交叉配对的配置（含义在我上面的示例中进行了解释，即相同字符之间没有交叉链接，只保留那些图形）。然后将这些中的每一个作为与图相关的字符数 p、相应对的移动 Δi 和每个五串的连接字符之间的间隙 δij 的函数进行评估。选择最小值作为特征，称为距离 d：d Min(50 – 10p + ΣΔi + Σδij) 虽然非常粗略，但该度量通常与定性眼睛引导估计非常吻合。例如，和之间的距离`abcde`是`abcfg` 20，而`abcde`和之间的距离`abfcg`是 23 =(50 – 30 + 1 +2)。

我对如何去做这件事感到困惑。任何可以帮助我的建议将不胜感激。

我尝试了 Levenshtein 以及蛋白质序列比较中使用的简单序列比对 论文的链接是： http: [//peds.oxfordjournals.org/content/16/2/103.long](http://peds.oxfordjournals.org/content/16/2/103.long)

我找不到关于第一作者 Alain Figureau 的任何信息以及我给 MA Soto 的电子邮件尚未得到答复（截至今天）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:07:46.560

好吧，这绝对不是 Levenshtein：

```
>>> from nltk import metrics
>>> metrics.distance.edit_distance('abcde','abcfg')
2
>>> metrics.distance.edit_distance('abcde','abfcg')
3
>>> help(metrics.distance.edit_distance)
Help on function edit_distance in module nltk.metrics.distance:

edit_distance(s1, s2)
    Calculate the Levenshtein edit-distance between two strings.
    The edit distance is the number of characters that need to be
    substituted, inserted, or deleted, to transform s1 into s2\.  For
    example, transforming "rain" to "shine" requires three steps,
    consisting of two substitutions and one insertion:
    "rain" -> "sain" -> "shin" -> "shine".  These operations could have
    been done in other orders, but at least three steps are needed.

    @param s1, s2: The strings to be analysed
    @type s1: C{string}
    @type s2: C{string}
    @rtype C{int} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T12:18:00.973

在您引用的文本块之后，引用了同一作者以前的一篇论文：[蛋白质的二级结构和三维模式识别](http://www.sciencedirect.com/science/article/pii/S0022519399910160)。如果没有对距离的解释，我认为值得研究一下（我不在工作，所以我无法访问完整的文档）。

否则，您也可以尝试直接联系作者：Alain Figureau 似乎是一位老派的法国研究员，没有任何联系（没有网页，没有电子邮件，没有“社交网络”，..）所以我建议尝试联系 MA Soto，他的电子邮件在论文末尾给出。我想他们会给你你正在寻找的答案：实验的过程必须非常清楚才能重复，这是研究中科学方法的一部分。

# java - 为什么这两个实例不是 `equal()`？

> ID：13166091
> 
> 赞同：3
> 
> 时间：2012-10-31T19:22:59.247
> 
> 标签：java, equals, equality

> **可能重复：**
> [为什么 .equals 方法在两个相同的值对象上失败？](https://stackoverflow.com/questions/6877947/why-equals-method-is-failing-on-two-same-value-objects)

这真的很简单，但我显然在这里遗漏了一些非常重要的东西。

```
Cat cat1 = new Cat("bob");
Cat cat2 = new Cat("bob");
System.out.println(cat1 == cat2); 
//false since these references point to diferent objects
System.out.println(cat1.equals(cat2));
//returns false also?? 
```

`Cat`只是一个只有名称的简单类。

这里发生了什么，如何`equals()`工作？我的印象是它比较了对象的所有字段。似乎情况并非如此。

我需要为我的所有课程覆盖它吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T19:24:36.220

是的。

`java.lang.Object``equals()`提供了和的非常基本的实现`hashCode()`。特别是，他们不会到处考虑实例的类型，这会 (1) 非常缓慢，并且 (2) 存在比较您出于各种原因不想在平等比较。

如果您希望 equals() 和 hashCode() 实际上对比较值相等有用（而不是引用相等`==`），您需要在自己的类型中实现两者。

`equals()`请注意，仅实现;是不够的。虽然从技术上讲这会“起作用”，但它有可能导致各种怪异。简单的经验法则是：*两者都不是或两者都不是，但绝不是只有一个*。他们必须在相同的领域工作；如果`equals()`说两个实例相等，则调用`hashCode()`两者*必须*返回相同的值（另见[`hashCode()`合同](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Object.html#hashCode%28%29)）。

`toString()`用代码覆盖以提供对相关对象的有意义的描述通常也是一个好主意。虽然不是严格需要，但您只需要在调试器中对此进行一次尝试即可实现该值。（感谢@JonTaylor 提到这个非常有用的相关花絮。）

它是 .NET 调用它`GetHashCode()`，而 Java 仅用`hashCode()`作函数名......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T19:24:28.353

你需要`equals`在你的`Cat`类中覆盖。默认 equals 比较引用上的对象。

```
class Cat {
private String name;

public Cat(String name) {
    this.name = name;
}

@Override
public boolean equals(Object obj) {
    if (obj == null)
        return false;
    if (!(obj instanceof Cat))
        return false;
    Cat c = (Cat) obj;
    return this.name == null ? false : this.name.equals(c.name);
}

@Override
public int hashCode() {
    return this.name == null ? 31 : this.name.hashCode();
}

@Override
public String toString() {
    return "Cat Name :" + name;
}
} 
```

* * *

参考

*   [等于](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#equals%28java.lang.Object%29)
*   [哈希码](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#hashCode%28%29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T19:28:29.487

java.lang.object 提供的`equals()`比较简单来说就是对象的唯一标识符，虽然不完全准确你可以认为它是一个内存位置，所以只有把一个对象和它自己比较才成立（即两个引用内存中的同一个对象）

您需要在 Cat 类中实现自己的 equals() 方法：

```
class Cat
{  
   String name;

   @Override
   public boolean equals(Cat other)
   {
      if (this.name.equals(other.name))
          return true;
      return false;
   }
} 
```

覆盖`hashCode()`也是明智的，除非这只是家庭作业或其他东西的一个非常基本的应用程序。也`toString()`可以用于覆盖。

[http://docs.oracle.com/javase/tutorial/java/IandI/objectclass.html](http://docs.oracle.com/javase/tutorial/java/IandI/objectclass.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T19:32:00.743

那是因为`==` 比较引用并`java.lang.Object.equals()`转换为`this==o`因此返回与`==`您的情况相同

在上述情况下，您使用 new 运算符创建两个不同的对象，因此都返回 false。

如果您想`.equals()`按预期工作，请覆盖`equals()`您的`Cat`班级。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T19:33:14.593

来自[[Java 文档]](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Object.html#equals%28java.lang.Object%29)

> Object 类的 equals 方法实现了对象上最有区别的可能等价关系；也就是说，对于任何非空引用值 x 和 y，***当且仅当 x 和 y 引用同一个对象***（x == y 的值为 true）时，此方法才返回 true。

在不覆盖 equals() 方法的情况下，对象是不同的因此

```
 System.out.println(cat1.equals(cat2)); // is false 
```

# c - 在c中构建vlan头

> ID：13166094
> 
> 赞同：2
> 
> 时间：2012-10-31T19:23:08.973
> 
> 标签：c, network-programming, ethernet

我需要建立一个 vlan 标头。我有构建 eh 标头（结构 ether_header）的代码，它工作正常。

```
/* Ethernet header */
memcpy(eh->ether_shost,src_mac_.data(), 6);
memcpy(eh->ether_dhost,socketAddress.sll_addr , 6);

/* Ethertype field */
eh->ether_type = htons(ETH_P_IP); 
```

我没有找到 vlan_eth_header 的结构，所以我创建了自己的结构并像这样填充它：

```
struct vlan_ethhdr {
  u_int8_t  ether_dhost[ETH_ALEN];  /* destination eth addr */
  u_int8_t  ether_shost[ETH_ALEN];  /* source ether addr    */
  u_int16_t          h_vlan_proto;
  u_int16_t          h_vlan_TCI;
  u_int16_t ether_type;
 };

    /* Ethernet header */
    memcpy(eh->ether_shost,src_mac_.data(), 6);
    memcpy(eh->ether_dhost,socketAddress.sll_addr , 6);
        eh->h_vlan_proto = htons(0x8100);
        eh->h_vlan_TCI = htons(VLAN_ID);
    /* Ethertype field */
    eh->ether_type = htons(ETH_P_IP); 
```

看来我做错了。似乎Wireshak甚至没有识别数据包（旧代码发送tcp数据包并正确发送它们）。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:52:24.580

[http://wiki.wireshark.org/VLAN](http://wiki.wireshark.org/VLAN)

*   DstMAC [6 字节]
*   SrcMAC [6 字节]
*   类型 [2 字节]
*   *   0x8100
*   VLANTag [4 字节]
*   *   优先级 [0..2 位]
*   *   *   0
*   *   CFI [3 位]
*   *   *   0
*   *   ID [4..15 位]
*   *   以太网类型 [16..31]
*   *   *   0x0800 (IP)

我的猜测是您没有正确设置 VLAN_ID。

首先，您应该通过在 byte[] 缓冲区中创建一些测试数据包来避免任何结构填充问题，这样您就可以确保一切正确。然后您可以放心地调试您的结构和 htons 字节排序，因为您知道正确的值应该是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T08:51:58.900

我构建 VLAN 的代码是正确的。它最初对我不起作用，因为我现在忘记将数据包的大小更改为更大。请注意，TCI 不仅是 VID，它还包含优先级和 CFI。在我的情况下，它们都为零，所以我不需要为 TCI 使用掩码和填充。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T19:27:18.947

你确定你的结构是正确包装的吗？编译器默认添加一些填充。它可以很容易地被禁用。

例如，使用 GCC：

```
#pragma pack(push)
#pragma pack(0)
struct vlan_ethhdr {
  u_int8_t  ether_dhost[ETH_ALEN];  /* destination eth addr */
  u_int8_t  ether_shost[ETH_ALEN];  /* source ether addr    */
  u_int16_t          h_vlan_proto;
  u_int16_t          h_vlan_TCI;
  u_int16_t ether_type;
 };
#pragma pack(pop) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T10:56:20.553

802.1Q 4字节的VLAN标签一般被认为是`0x8100+pri+cfi+vlan`. 将 vlan 标签描述为（不包括 8100，但包括数据有效负载的 etype）
的 wireshark 方式有些独特。 但是，无论哪种方式，整体数据包格式和长度都是正确的。`pri+cfi+vlan+etype`

# fortran - 不能在 FORTRAN 子程序中使用 SUNDIALS-KINSOL？

> ID：13166097
> 
> 赞同：1
> 
> 时间：2012-10-31T19:23:19.990
> 
> 标签：fortran

感谢您查看此问题。

**问题：** 段。*在生成正确*的计算结果*后*，从包含 KINSOL 求解过程的 f90 子程序返回时出错。相同的求解过程在主程序中没有问题。

 ***环境：** linux、gcc、日晷静态库

**如何启动问题：**

获取随附的 REDUCED 测试代码

```
module moduleNonlinearSolve
  integer,save::nEq
contains
  subroutine solveNonlinear(u)
    double precision::u(*)
    integer iout(15),ier
    double precision rout(2),koefScal(nEq)
    koefScal(:)=1d0
    call fnvinits(3,nEq,ier)
    call fkinmalloc(iout,rout,ier)
    call fkinspgmr(50,10,ier)
    call fkinsol(u,1,koefScal,koefScal,ier)
    call fkinfree()
    do i=1,nEq
      write(*,*),i,u(i)
    end do
  end subroutine
end module

subroutine fkfun(u,fval,ier)
  use moduleNonlinearSolve
  double precision::u(*)
  double precision::fval(*)
  integer::ier
  forall(i=2:nEq-1)
    fval(i)=-u(i-1)+2d0*u(i)-u(i+1)-1d0
  end forall
  fval(1)=u(1)+2d0*u(1)-u(2)-1d0
  fval(nEq)=-u(nEq-1)+2d0*u(nEq)+u(nEq)-1d0
  ier=0
end subroutine

program test
  use moduleNonLinearSolve
  double precision u(10)
  nEq=size(u)
  u(:)=10d0
  call solveNonlinear(u)
end program`` 
```

编译

```
$ gfortran -c -Wall -g test.f90
$ gfortran -Wall -g -o test test.o -lsundials_fkinsol -lsundials_fnvecserial -lsundials_kinsol -lsundials_nvecserial -llapack -lblas 
```

跑

```
$ ./test 
```

**注意：如果将所有 SUNDIALS 程序放在主程序中，它将完美运行。**

非常感谢您的任何意见。

绵至

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T12:42:40.407

根据[KINSOL](https://computation.llnl.gov/casc/sundials/documentation/kin_guide.pdf)文档， 的第一个参数`fkinmalloc`必须与 type 的整数类型`C`相同`long int`。在您的情况下，`long int`长度为 8 个字节，但您传入的是一个由 4 个字节整数组成的数组。这将导致`fkinmalloc`尝试写入超出数组的范围，并写入其他内存。这通常会导致内存损坏，其症状就像您所观察到的一样：在稍后的某个随机点崩溃，例如从函数返回时。您应该能够通过 valgrind 运行程序来确认这一点，这可能会报告大小为 8 的无效写入。无论如何，替换

```
integer :: iout(15) 
```

和

```
integer*8 :: iout(15) 
```

应该解决问题。*

# dos - 如何在不按 Enter 的情况下从批处理脚本中的控制台返回单个字符？

> ID：13166100
> 
> 赞同：3
> 
> 时间：2012-10-31T19:23:43.033
> 
> 标签：dos, batch-file

我想从批处理脚本中读取/返回单个字符，而不必按回车键，就像`getChar()`在 C/C++ 中一样。我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T19:28:51.507

使用[选择](http://www.computerhope.com/choicehl.htm)命令

[从这个网站](http://www.infionline.net/~wtnewton/batch/batchfaq.html)借来的例子

```
 @echo off
   :menu
   cls
   echo.
   echo       A - Text for item A
   echo       B - Text for item B
   echo       C - End
   echo.
   choice /c:ABC > nul
   if errorlevel 3 goto end
   if errorlevel 2 goto B
   if errorlevel 1 goto A
   echo Error... choice not installed
   goto end
   :A
   echo Commands for item A
   pause
   goto menu
   :B
   echo Commands for item B
   pause
   goto menu
   :end 
```

# ios - 发送 vCard 更新

> ID：13166102
> 
> 赞同：2
> 
> 时间：2012-10-31T19:23:47.650
> 
> 标签：ios, xmpp, vcf-vcard, xmppframework

我目前正在使用适用于 iOS 的 XMPPFramework，我的想法是让用户根据 vCards 创建自己的个人资料。我制作了一个屏幕，他们可以在其中输入一些信息，例如出生日期、名字/姓氏等。完成后，他们按下“保存”按钮。

我想做的是让订阅此用户的每个人都知道他的 vCard 已更改，但我不知道该怎么做。我已经尝试发送一个 vcard-temp:x:update 节，但消息没有到达我正在测试的其他设备上。

有谁知道我该怎么做以及可以使用哪种方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T15:01:40.317

你无法知道 vCard 的变化，

您只能通过 XEP 了解照片更新：0153

此 xep 使用存在将照片发送到那里。

# r - 制作一个堆叠条形图，每个类别有 3 个条形图

> ID：13166104
> 
> 赞同：1
> 
> 时间：2012-10-31T19:24:00.917
> 
> 标签：r

我有以下数据集：

```
 Marker   Method NAtype        Ratio
1     CSF1PO      GEL     -9 3.623417e-01
2     CSF1PO      GEL     -1 4.713273e-02
3     CSF1PO      GEL     NA 0.000000e+00
4     CSF1PO MegaBACE     -9 1.417205e-02
5     CSF1PO MegaBACE     -1 8.312974e-03
6     CSF1PO MegaBACE     NA 5.405026e-06
7     CSF1PO      ABI     -9 4.714592e-02
8     CSF1PO      ABI     -1 1.989925e-03
9     CSF1PO      ABI     NA 4.174494e-05
10  D10S1248      GEL     -9 9.999201e-01
11  D10S1248      GEL     -1 7.098303e-05
12  D10S1248      GEL     NA 0.000000e+00
13  D10S1248 MegaBACE     -9 6.562637e-01
14  D10S1248 MegaBACE     -1 2.518769e-03
15  D10S1248 MegaBACE     NA 1.081005e-05
16  D10S1248      ABI     -9 7.138484e-03
17  D10S1248      ABI     -1 1.029723e-03
18  D10S1248      ABI     NA 1.391498e-05 
```

我想用这些数据制作一个堆积条形图。我不精通 ggplot2，也不知道如何为每个类别创建 3 个条形图。

例如，第一列有我的类别，这些是我图表 x 轴上的名称。对于每个类别（“CSF1PO”和“D10S1248”），我想要 3 个条形图（第 2 列中的“GEL”、“MegaBACE”、“ABI”）。每个条应分为 3 个子集（第 3 列中的“-9”、“-1”、“NA”）。第四列（比率）有我的价值观。

我想要类似的东西

```
ggplot(data, aes(x=Marker, y=Ratio, fill=NAtype)) + geom_bar(stat="identity") + facet_grid(~Method) 
```

但每个类别的条并排，而不是分开的网格。有人可以帮忙吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:06:27.703

`ggplot2`不允许您在同一个图中同时包含`stack`和`dodge`作为位置。但是你可以通过使用来实现你想要的`facet_wrap`。使用您的数据查看此示例：

```
ggplot(df, aes(Method, Ratio, fill = Method)) + 
geom_bar(stat = "identity", postion = "dodge") + facet_wrap(~Marker) 
```

![在此处输入图像描述](../Images/de17478132c95b5d3fda38c6d9be6cd7.png)

# c# - 当您没有类的源代码时，是否可以对对象进行 .NET 二进制序列化？

> ID：13166105
> 
> 赞同：26
> 
> 时间：2012-10-31T19:24:01.593
> 
> 标签：c#, .net, serialization, binary, binary-serialization

我正在使用`BinaryFormatter`C# 中的某些对象进行二进制序列化。但是，有些对象包含我通过 DLL 访问的类并且没有源代码，因此我无法使用`Serializable`属性标记它们。有没有一种直接的方法来序列化它们？我有一个解决方法，其中涉及获取类`NoSource`并创建一个新类`SerializableNoSource`，构造函数为其获取一个`NoSource`对象并从中提取我需要的所有信息，但这很hacky。有没有更好的选择？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-20T14:21:03.107

您可以创建一个*序列化代理*。

想象一下，我们在引用的程序集中定义了一个我们无法控制的类，如下所示：

```
public class Person
{
    public string Name { get; set; }
    public int Age { get; set; }
    public DriversLicense License;
}

// An instance of this type will be part of the object graph and will need to be 
// serialized also.
public class DriversLicense
{
    public string Number { get; set; }
} 
```

为了序列化这个对象，您需要为对象图中的每种类型定义一个序列化代理。

要创建序列化代理，您只需创建一个实现[`ISerializationSurrogate`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iserializationsurrogate.aspx)接口的类型：

```
public class PersonSurrogate : ISerializationSurrogate
{
    /// <summary>
    /// Manually add objects to the <see cref="SerializationInfo"/> store.
    /// </summary>
    public void GetObjectData(object obj, SerializationInfo info, StreamingContext context)
    {
        Person person = (Person) obj;
        info.AddValue("Name", person.Name);
        info.AddValue("Age", person.Age);
        info.AddValue("License", person.License);
    }

    /// <summary>
    /// Retrieves objects from the <see cref="SerializationInfo"/> store.
    /// </summary>
    /// <returns></returns>
    public object SetObjectData(object obj, SerializationInfo info, StreamingContext context, ISurrogateSelector selector)
    {
        Person person = (Person)obj;
        person.Name = info.GetString("Name");
        person.Age = info.GetInt32("Age");
        person.License = (DriversLicense) info.GetValue("License", typeof(DriversLicense));
        return person;
    }
}

public class DriversLicenseSurrogate : ISerializationSurrogate
{
    /// <summary>
    /// Manually add objects to the <see cref="SerializationInfo"/> store.
    /// </summary>
    public void GetObjectData(object obj, SerializationInfo info, StreamingContext context)
    {
        DriversLicense license = (DriversLicense)obj;
        info.AddValue("Number", license.Number);
    }

    /// <summary>
    /// Retrieves objects from the <see cref="SerializationInfo"/> store.
    /// </summary>
    /// <returns></returns>
    public object SetObjectData(object obj, SerializationInfo info, StreamingContext context, ISurrogateSelector selector)
    {
        DriversLicense license = (DriversLicense)obj;
        license.Number = info.GetString("Number");
        return license;
    }
} 
```

然后，您需要`IFormatter`通过定义和初始化 a`SurrogateSelector`并将其分配给您的`IFormatter`.

```
private static void SerializePerson(Person person)
{
    if (person == null)
        throw new ArgumentNullException("person");

    using (var memoryStream = new MemoryStream())
    {
        //Configure our surrogate selectors.
        var surrogateSelector = new SurrogateSelector();
        surrogateSelector.AddSurrogate(typeof (Person), new StreamingContext(StreamingContextStates.All),
                                       new PersonSurrogate());
        surrogateSelector.AddSurrogate(typeof (DriversLicense), new StreamingContext(StreamingContextStates.All),
                                       new DriversLicenseSurrogate());

        //Serialize the object
        IFormatter formatter = new BinaryFormatter();
        formatter.SurrogateSelector = surrogateSelector;
        formatter.Serialize(memoryStream, person);

        //Return to the beginning of the stream
        memoryStream.Seek(0, SeekOrigin.Begin);

        //Deserialize the object
        Person deserializedPerson = (Person) formatter.Deserialize(memoryStream);
    }
} 
```

使用序列化代理绝非简单，当您尝试序列化的类型具有需要序列化的私有和受保护字段时，实际上会变得非常冗长。

但由于您已经手动序列化所需的值，我认为这不是问题。使用代理是处理这种情况的一种更统一的方式，应该让你感觉更舒服。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:04:01.933

您也许可以使用[Mono.Cecil](https://github.com/jbevain/cecil)将其添加`[SerializableAttribute]`到类中，但如果有其他方法可以实现所需的结果，我不会这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:13:21.297

我同意@Servy，如果类的作者没有预料到它会被序列化，你不应该尝试直接序列化它。因此，从架构的角度来看，您正在做正确的事情。为了使您当前的方法不那么“hacky”，请考虑为包含对不可序列化对象的引用的类实现[ISerializable 。](http://msdn.microsoft.com/en-us/library/wf4375ks.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T23:23:09.093

新建一个类，继承现有的没有序列化属性的类，实现ISerializable接口。

如果该类是密封的，那么您可以使用 Json.NET，然后将其转换为二进制，反之亦然（很糟糕，如果没有其他方法可以帮助，请使用它:)）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-10T11:50:14.123

我知道这是一个老问题，但我最近发现需要序列化/反序列化 DTO，出于性能原因，我们无法控制其二进制格式的源代码。设法找到了相当多的替代二进制序列化程序，例如 ZeroFormatter 和 Protobuf，但它们都需要用属性装饰 DTO 或定义模式。

这使我走上了创建自己的二进制序列化程序的道路，它可以快速替代二进制格式的 JSON 序列化程序，您可能会发现它很有用：[https ://github.com/zachsaw/Binaron.Serializer](https://github.com/zachsaw/Binaron.Serializer)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-10-31T19:45:22.740

我认为更简洁的方法是实现 ISerializable 接口并管理自己的序列化和反向过程。在 MSDN 我们可以找到：

> 编译后无法将序列化添加到类中......

# c# - HttpContext.Current.User.Identity.IsAuthenticated 在登录控件 LoggedIn 事件中为假

> ID：13166107
> 
> 赞同：2
> 
> 时间：2012-10-31T19:24:16.043
> 
> 标签：c#, asp.net, .net, c#-4.0, asp.net-4.0

我对为什么 HttpContext.Current.User.Identity.IsAuthenticated 在登录控件的 LoggedIn 事件中返回 false 感到生气？

我输入了正确的用户名和密码，因此我进入了登录事件，但 IsAuthenticated 是错误的！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T19:38:41.030

这是因为自从用户登录后页面还没有回传。整个 User 对象还没有填写，这是一个已知的行为。

请参阅这篇内容丰富的博客文章：

[http://forums.asp.net/t/982749.aspx](http://forums.asp.net/t/982749.aspx)

上述链接也归功于此相关的 SO QA： [Get UserID from ASP.Net Login control LoggedIn event](https://stackoverflow.com/questions/1599698/get-userid-from-asp-net-login-control-loggedin-event)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T19:52:49.910

`Application_AuthenticateRequest`发生在页面生命周期的早期阶段。

如果您遇到`LoggedIn`事件，您可以假设用户已经通过身份验证。

如果你想要一个登录用户的用户名，你可以像这样得到它 -

```
protected void LoginUser_LoggedIn(object sender, EventArgs e)
{
    var usernameTextBox = (TextBox)LoginUser.FindControl("UserName");
    string username = usernameTextBox.Text;

    MembershipUser user = Membership.GetUser(username);
    Guid userId = (Guid)user.ProviderUserKey;
} 
```

# c# - 即使使用 WaitForExit()，进程也没有完成

> ID：13166109
> 
> 赞同：1
> 
> 时间：2012-10-31T19:24:18.773
> 
> 标签：c#, process, waitforexit

我有一个启动进程的方法。该过程是一个 ruby​​ 脚本，它查询外部源并返回打印到文本文件“output.txt”并放置在目录中的内容。

在执行期间，我运行如下所示的方法：

```
p.StartInfo.FileName = @"blah directory";
p.StartInfo.WindowStyle = ProcessWindowStyle.Normal;
p.Start();
p.WaitForExit(); 
```

然后在我的另一种方法中，我说：

```
processmethod();
StreamReader sr = new StreamReader ("output.txt"); 
```

由于某种原因，ruby 脚本没有完成，因为它没有创建 output.txt 文件。我知道这不是 ruby​​ 脚本的问题，因为如果我手动执行它，它就可以正常工作。

我猜它的某种时间问题。奇怪的是，直到昨天，这一直运行良好，没有对代码的那个区域进行任何更改。我在某处看到“waitforexit”也锁定了线程，所以我不确定如果没有他的进程实际上首先完成，这是如何到达流读取器的。

当代码移动到流读取器行时，该过程似乎也简单地终止，因为窗口关闭并且我仍然没有输出文件

# ruby - ruby 正则表达式替换方程

> ID：13166112
> 
> 赞同：5
> 
> 时间：2012-10-31T19:24:33.660
> 
> 标签：ruby, regex, gsub

我有一些 mathjax 格式的 HTML 文本：

```
text = "an inline \\( f(x) = \frac{a}{b} \\) equation, a display equation \\[ F = m a \\] \n and another inline \\(y = x\\)" 
```

（注意：方程式由单斜杠分隔，例如`\(`not `\\(`，额外`\`的只是转义第一个用于 ruby​​ 文本）。

我想获得将其替换为的输出，例如由 latex.codecogs 创建的图像，例如

```
desired_output = "an inline <img src="http://latex.codecogs.com/png.latex?f(x) = \frac{a}{b}\inline"/> equation, a display equation <img src="http://latex.codecogs.com/png.latex?F = m a"/> \n and another inline <img src="http://latex.codecogs.com/png.latex?y = x\inline"/> " 
```

使用红宝石。我尝试：

```
desired = text.gsub("(\\[)(.*?)(\\])", "<img src=\"http://latex.codecogs.com/png.latex?\2\" />") 
desired = desired.gsub("(\\()(.*?)(\\))", "<img src=\"http://latex.codecogs.com/png.latex?\2\\inline\")
desired 
```

但这不成功，只返回原始输入。我错过了什么？如何适当地构建此查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:10:46.687

尝试：

```
desired = text.gsub(/\\\[\s*(.*?)\s*\\\]/, "<img src=\"http://latex.codecogs.com/png.latex?\\1\"/>") 
desired = desired.gsub(/\\\(\s*(.*?)\s*\\\)/, "<img src=\"http://latex.codecogs.com/png.latex?\\1\inline\"/>")
desired 
```

必须发生的重要变化：

*   第一个参数`gsub`应该是一个正则表达式（正如安东尼提到的）
*   如果第二个参数是双引号字符串，则后面的引用必须像`\\2`（而不是 just `\2`）（参见[rdoc](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-gsub)）
*   第一个参数没有转义`\`

还有一些其他小的格式化内容（空格等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T19:47:13.870

不确定您的正则表达式是否正确 - 但在 Ruby 中，正则表达式由 分隔`//`，请尝试如下：

```
desired = text.gsub(/(\\[)(.*?)(\\])/, "<img src=\"http://latex.codecogs.com/png.latex?\2\" />") 
```

您正在尝试进行字符串替换，当然 gsub 没有找到包含的字符串`(\\[)(.*?)(\\])`

# actionscript-3 - ActionScript 3 的“move”关键字：它存在吗？

> ID：13166116
> 
> 赞同：3
> 
> 时间：2012-10-31T19:24:38.747
> 
> 标签：actionscript-3, flash, keyword, move

我在 Flash 中编程，我注意到每次我使用“移动”这个词时，它都会亮起蓝色，就好像它是一个关键字一样。我找不到任何关于它的文档，所以我一直在避免使用这个词来表示任何功能。有内置的“移动”功能吗？它是其他东西的关键字吗？它有什么作用？

编辑：我将 Flash CS 5.5 用于 IDE。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T19:45:37.997

根据[文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/statements.html)，ActionScript 3中没有`move`关键字。我会检查您的编辑器的语法突出显示设置并确保将其设置为 AS3。它也不是 AS2 中的关键字，至少根据[这本书](http://openbook.galileodesign.de/actionscript/actionscript_1_05_002.htm#t2t36)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T19:51:22.380

这是一个关于[Flex AS3](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/effects/Move.html)`Move`类的文档。

# c# - 列表中的碰撞检测

> ID：13166119
> 
> 赞同：4
> 
> 时间：2012-10-31T19:24:44.283
> 
> 标签：c#, list, xna, collision

我有一个精灵管理类和另外两个类，一个是玩家类，另一个是敌人类。两者都是我的精灵管理器的子类。我已经想出了如何为玩家和敌人类进行碰撞检测。但是，由于我的敌人是在一个列表中实例化的，所以我无法弄清楚当他们遇到敌人时如何检查他们的碰撞检测。我想过复制我的列表，但我将如何正确更新它们？我看到了一个为两个列表创建嵌套 foreach 循环然后比较对象的示例，但我不确定这是否正确。有没有一种简单的方法来比较列表中的两个项目？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T19:32:56.853

简而言之，是的。考虑一下，一旦您将一个敌人与其他所有敌人进行比较，就不再需要进行比较。您可以通过这种方式最大限度地减少检查次数

示例（伪代码）：

```
for (int i=0; i < list.length; i++){
    // compare list[i] to everything subsequent enemy
    // we don't have to compare to enemies < i, because we've already
    // compared those to all other enemies
    for (int j=i+1; j < list.length; j++){
        checkcollision(list[i], list[j])
    }
} 
```

请注意——不要尝试在这些循环中从列表中删除敌人，因为您不想在迭代时更改列表的状态（`foreach`如果您尝试修改列表，实际上会抛出异常当你迭代时）。相反，将其保存在另一个列表中*或*反向迭代。

# c# - 来自程序集“myAssembly”的“MyNamespace.MyType”类型中的 System.TypeLoadException 方法“GetX”没有实现

> ID：13166122
> 
> 赞同：1
> 
> 时间：2012-10-31T19:25:04.603
> 
> 标签：c#, .net, exception, reflection, .net-assembly

每当我在动态加载的程序集上调用 assembly.GetExportedTypes() 方法时，都会收到 System.TypeLoadException。我已经完成了我的作业，并查看了所有的融合日志，但没有任何意义。我什至打开了目标程序集/DLL 文件并找到了 GetX() 方法实现，所以我不确定到底发生了什么。它不会缓存在 GAC 中，也不会像使用探测应用配置元素一样加载旧版本。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T23:54:28.667

事实证明，问题是将同一个程序集加载到多个应用程序域中，这会导致各种运行时错误，更多信息[在这里](http://msdn.microsoft.com/en-us/library/dd153782.aspx)

# java - 在 Java hdfs 中读取文件

> ID：13166123
> 
> 赞同：1
> 
> 时间：2012-10-31T19:25:08.633
> 
> 标签：java, linux, hadoop, solaris, hdfs

我在集群上运行程序时遇到问题，并决定在函数 map 和 reduce 中读取 hdfs 文件。如何逐行读取hdfs文件并刻录读取ArrayList中的行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T04:49:49.483

只是一个演示代码片段：</p>

```
Path path = new Path(filePath);
FileSystem fs = path.getFileSystem(context.getConfiguration()); // context of mapper or reducer
FSDataInputStream fdsis = fs.open(path);
BufferedReader br = new BufferedReader(new InputStreamReader(fdsis));
String line = "";
ArrayList<String> lines = new ArrayList<String>();
while ((line = br.readLine()) != null) {
    lines.add(line);
}
br.close(); 
```

# ruby-on-rails - 为 Post 设置 published_at 的虚拟属性

> ID：13166127
> 
> 赞同：2
> 
> 时间：2012-10-31T19:26:17.510
> 
> 标签：ruby-on-rails

我有一个带有名为“published_at”的日期时间字段的帖子模型。在我的表单上，我有一个名为“publish_now”的属性的复选框（见下文）。当用户选中我的虚拟属性的复选框时，我希望将“published_at”设置为 Time.now()：publish_now。

```
<input class="boolean optional" id="post_publish_now" name="post[publish_now]" type="checkbox" value="1" /> 
```

这是我在控制器中的创建和更新方法：

```
def create
  @post = Post.new(params[:post])
  if current_user
    @post.author_id == current_user.id
  end

  respond_to do |format|
    if @post.save
      format.html { redirect_to @post, notice: 'Post was successfully created.' }
      format.json { render json: @post, status: :created, location: @post }
    else
      format.html { render action: "new" }
      format.json { render json: @post.errors, status: :unprocessable_entity }
    end
  end
end

def update
  @post = Post.find(params[:id])

  respond_to do |format|
    if @post.update_attributes(params[:post])
      format.html { redirect_to @post, notice: 'Post was successfully updated.' }
      format.json { head :no_content }
    else
      format.html { render action: "edit" }
      format.json { render json: @post.errors, status: :unprocessable_entity }
    end
  end
end 
```

这是我的模型：

```
class Post < ActiveRecord::Base
  belongs_to :author, class_name: "User", foreign_key: "author_id"

  attr_accessible :author_id, :content, :published_at, :title, :publish_now

  validates_presence_of :content, :title

  def publish_now
    !published_at.nil?
  end

  def publish_now=(value)
    if value == "1" && published_at.nil?
      published_at = Time.now()
    end 
  end
end 
```

这是我根据虚拟属性上的 railscast 应该如何工作的最佳猜测，但它并没有为 published_at 保存值。问题可能出在哪里的任何建议？

更新：（表单视图）

```
<%= simple_form_for(@post) do |f| %>
  <%= f.input :title %>
  <%= f.input :content, input_html: { cols: 100, rows: 10, class: "
    span5" } %>
  <% if @post.published_now == false %>
    <%= f.input :publish_now, as: :boolean %>
  <% end %>
  <%= f.submit %>
<% end %> 
```

更新示例日志：

```
Started POST "/posts" for 127.0.0.1 at 2012-10-31 14:14:49 -0500
Processing by PostsController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"zlZ3s18VXwEvONIkk1CZAYESAEAxPP1OKcUtiyEuZgA=", "post"=>{"title"=>"big big love a doodle", "content"=>"aksdfj;skjf;kasjdf; lkj af;lk ;askdfj ;lk ;laf; ksd ;f", "publish_now"=>"1"}, "commit"=>"Create Post"}
  User Load (0.8ms)  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
   (0.2ms)  BEGIN
  SQL (0.7ms)  INSERT INTO "posts" ("author_id", "content", "created_at", "published_at", "title", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["author_id", nil], ["content", "aksdfj;skjf;kasjdf; lkj af;lk ;askdfj ;lk ;laf; ksd ;f"], ["created_at", Wed, 31 Oct 2012 14:14:49 CDT -05:00], ["published_at", nil], ["title", "big big love a doodle"], ["updated_at", Wed, 31 Oct 2012 14:14:49 CDT -05:00]]
   (0.4ms)  COMMIT
Redirected to http://localhost:3000/posts/5
Completed 302 Found in 18ms (ActiveRecord: 2.1ms) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T19:51:00.897

错误在这一行

```
published_at = Time.now() 
```

它应该是

```
self.published_at = Time.now() 
```

括号也是可选的。如果你给某个东西赋值，那么 Ruby 会假设它是一个局部变量，除非你明确地提供对象，只有这样 Ruby 才能知道它实际上是你想要调用的方法（published_at= 方法）。这是 Ruby 中常见的问题。

您的代码中发生的情况是创建了一个新的局部变量 published_at。有关更多信息，请参阅“在类中使用访问器”中的[http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_expressions.html 。](http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_expressions.html)

但是，当读取这样的属性时，您不需要为 self 加上前缀，因为在您分配之前，Ruby 不会假定某个东西是局部变量。所以在published_at=...之前，Ruby会把published_at当作一个方法调用，在你做publish_at=...之后（前面没有self），它会把published_at当作一个局部变量。只有这样，您才必须使用 self.published_at 来实际调用该方法，而不是读取局部变量。对于属性写入器（以 = 结尾），您始终需要使用对象作为前缀。您也可以使用属性哈希，这样您就不需要自己添加前缀：

```
attributes["published_at"] = whatever 
```

# jquery - 幻灯片动画在 Firefox 中运行良好，但在 chrome 中卡顿

> ID：13166128
> 
> 赞同：1
> 
> 时间：2012-10-31T19:26:19.213
> 
> 标签：jquery, ajax, html, css, animation

我正在构建一个网站，当您单击位于页面左侧、顶部或右侧的另一个 div 的按钮时，如果将中心 div 推出屏幕。

左侧、顶部和右侧 div 将使用 jquery ajax 加载，并使用 css3 进行动画处理。

这是我正在谈论的页面：

[http://www.uvm.edu/~areid/homesite/index.html](http://www.uvm.edu/~areid/homesite/index.html)

尝试在 Chrome 和 Firefox 中单击左眼。您会看到动画在 Firefox 中很流畅，但在 chrome 中会卡顿。

有谁知道为什么会发生这种情况？

我还想知道是否有人知道我可以如何加快网站速度/使过渡看起来更顺畅。

感谢你们可能有的任何帮助

最好的，

凯蒂

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T19:34:56.753

我可以清楚地看到 Chrome 的抖动。

如果您在浏览器中执行许多其他操作，CSS3 动画不一定能顺利运行。它们运行的​​流畅程度取决于您同时尝试做的其他事情以及浏览器中的内部实现如何处理它。

根据我对使用精美 CSS3 过渡的 CSS3 幻灯片的经验，让它们顺利运行的最佳方法是不要在您希望动画顺利运行的同时对您的代码做实质性的事情。这里有一些方法可以最大限度地提高顺利运行的机会：

1.  预加载动画期间可能需要的资源。
2.  在动画运行期间不要踢任何 javascript 函数。
3.  避免在动画期间加载图像。
4.  对于想要在动画之后运行的东西，通过动画的完成功能触发它们的操作（所以它们在动画完成之前不会启动）。
5.  如果您希望在动画完成后构建并准备好某些东西，请在开始动画之前先构建它，并在开始动画之前将其隐藏并准备就绪。
6.  不要在动画期间修改 DOM（除了动画特别需要的内容）。

更具体地说，在您的页面中，我看到幻灯片过渡时出现抖动，但在滑动的同时，我看到浏览器试图加载幻灯片期间显示的新内容。新内容的加载和显示很可能会导致幻灯片过渡的抖动。我建议您要么等到幻灯片完成后开始加载新内容，要么在开始幻灯片之前预加载新内容。我发现即使浏览器只是通过网络加载图像，某些浏览器在 CSS3 转换中也会出现抖动。

# facebook-like - 不能通过 Facebook URL“喜欢”画布应用，只能通过源 URL

> ID：13166130
> 
> 赞同：1
> 
> 时间：2012-10-31T19:26:41.893
> 
> 标签：facebook-like, facebook-canvas

相当简单的问题，但似乎找不到任何答案。

在画布应用程序中，我希望用户能够喜欢直接链接到应用程序的页面 (http://apps.facebook.com/crunchd/profile/545998365)，而不是源 URL (http:// facebook.crunchd.com/profile/545998365）。

第一个链接不起作用，点赞框出现然后很快消失，而第二个链接正常。它不是样式，因为它正在使用[http://developers.facebook.com/docs/reference/plugins/like/进行测试](http://developers.facebook.com/docs/reference/plugins/like/)

正如 linter 测试的那样，所有 og 标签都设置正确。

有什么建议么？

# django - 当我编辑模型并重新制作数据库时，为什么我的管理页面看起来像这样？

> ID：13166131
> 
> 赞同：1
> 
> 时间：2012-10-31T19:27:02.973
> 
> 标签：django, django-admin

![愚蠢的管理员](../Images/35935c04de09c1c2bb0eb580fa6bfe6b.png)

我可以访问 localhost/blog 和 localhost/comic ，但不能访问 localhost/blog/BlogPost 或 localhost/comic/ComicPost，从而阻止我添加帖子。有没有办法解决这个问题？

# c++ - gluLookAt 是如何工作的？

> ID：13166135
> 
> 赞同：6
> 
> 时间：2012-10-31T19:27:25.813
> 
> 标签：c++, opengl, glulookat

据我了解，

```
gluLookAt(
        eye_x, eye_y, eye_z,
        center_x, center_y, center_z,   
        up_x, up_y, up_z
    ); 
```

相当于：

```
glRotatef(B, 0.0, 0.0, 1.0);
glRotatef(A, wx, wy, wz);
glTranslatef(-eye_x, -eye_y, -eye_z); 
```

但是当我打印出`ModelView`矩阵时，调用`glTranslatef()`似乎无法正常工作。这是代码片段：

```
#include <stdlib.h>
#include <stdio.h>
#include <GL/glut.h>

#include <iomanip>
#include <iostream>
#include <string>

using namespace std;

static const int Rx = 0;
static const int Ry = 1;
static const int Rz = 2;

static const int Ux = 4;
static const int Uy = 5;
static const int Uz = 6;

static const int Ax = 8;
static const int Ay = 9;
static const int Az = 10;

static const int Tx = 12;
static const int Ty = 13;
static const int Tz = 14;

void init() {
    glClearColor(0.0, 0.0, 0.0, 0.0);
    glEnable(GL_DEPTH_TEST);
    glShadeModel(GL_SMOOTH);
    glEnable(GL_LIGHTING);
    glEnable(GL_LIGHT0);
    GLfloat lmodel_ambient[] = { 0.8, 0.0, 0.0, 0.0 };
    glLightModelfv(GL_LIGHT_MODEL_AMBIENT, lmodel_ambient);
}

void displayModelviewMatrix(float MV[16]) {
    int SPACING = 12;
    cout << left;
    cout << "\tMODELVIEW MATRIX\n";
    cout << "--------------------------------------------------" << endl;
    cout << setw(SPACING) << "R" << setw(SPACING) << "U" << setw(SPACING) << "A" << setw(SPACING) << "T" << endl;   
    cout << "--------------------------------------------------" << endl;
    cout << setw(SPACING) << MV[Rx] << setw(SPACING) << MV[Ux] << setw(SPACING) << MV[Ax]  << setw(SPACING) << MV[Tx] << endl;
    cout << setw(SPACING) << MV[Ry] << setw(SPACING) << MV[Uy] << setw(SPACING) << MV[Ay]  << setw(SPACING) << MV[Ty] << endl;
    cout << setw(SPACING) << MV[Rz] << setw(SPACING) << MV[Uz] << setw(SPACING) << MV[Az] << setw(SPACING)  << MV[Tz] << endl;
    cout << setw(SPACING) << MV[3] << setw(SPACING) << MV[7] << setw(SPACING) << MV[11] << setw(SPACING) << MV[15] << endl;
    cout << "--------------------------------------------------" << endl;
    cout << endl;
}

void reshape(int w, int h) {
    float ratio = static_cast<float>(w)/h;
    glViewport(0, 0, w, h);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(45.0, ratio, 1.0, 425.0);
}

void draw() {
    float m[16];
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glGetFloatv(GL_MODELVIEW_MATRIX, m);
    gluLookAt(
        300.0f, 0.0f, 0.0f,
        0.0f, 0.0f, 0.0f,
        0.0f, 1.0f, 0.0f
    );
    glColor3f(1.0, 0.0, 0.0);
    glutSolidCube(100.0);
    glGetFloatv(GL_MODELVIEW_MATRIX, m);
    displayModelviewMatrix(m);
    glutSwapBuffers();
}

int main(int argc, char** argv) {
    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB | GLUT_DEPTH);
    glutInitWindowSize(400, 400);
    glutInitWindowPosition(100, 100);
    glutCreateWindow("Demo");
    glutReshapeFunc(reshape);
    glutDisplayFunc(draw);
    init();
    glutMainLoop();
    return 0;
} 
```

无论我对向量使用什么值：`eye`或者
`300, 0, 0`平移 向量是相同的，这没有任何意义，因为代码的顺序是倒序的，所以应该先运行，然后是 2 次旋转。另外，旋转矩阵完全独立于平移列（在 ModelView 矩阵中），那么什么会导致这种奇怪的行为呢？这是眼睛矢量的输出是
`0, 300, 0`
`0, 0, 300`
`glTranslatef``(0.0f, 300.0f, 0.0f)`

```
 MODELVIEW MATRIX
--------------------------------------------------
R           U           A           T
--------------------------------------------------
0           0           0           0
0           0           0           0
0           1           0           -300
0           0           0           1
-------------------------------------------------- 
```

我希望`T`专栏是`(0, -300, 0)`！那么有人可以帮我解释一下吗？

`gluLookAt`来自[http://www.mesa3d.org](http://www.mesa3d.org)的实现

```
void GLAPIENTRY
gluLookAt(GLdouble eyex, GLdouble eyey, GLdouble eyez, GLdouble centerx,
      GLdouble centery, GLdouble centerz, GLdouble upx, GLdouble upy,
      GLdouble upz)
{
    float forward[3], side[3], up[3];
    GLfloat m[4][4];

    forward[0] = centerx - eyex;
    forward[1] = centery - eyey;
    forward[2] = centerz - eyez;

    up[0] = upx;
    up[1] = upy;
    up[2] = upz;

    normalize(forward);

    /* Side = forward x up */
    cross(forward, up, side);
    normalize(side);

    /* Recompute up as: up = side x forward */
    cross(side, forward, up);

    __gluMakeIdentityf(&m[0][0]);
    m[0][0] = side[0];
    m[1][0] = side[1];
    m[2][0] = side[2];

    m[0][1] = up[0];
    m[1][1] = up[1];
    m[2][1] = up[2];

    m[0][2] = -forward[0];
    m[1][2] = -forward[1];
    m[2][2] = -forward[2];

    glMultMatrixf(&m[0][0]);
    glTranslated(-eyex, -eyey, -eyez);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T23:04:56.073

如果我们让一个旋转和平移矩阵像你的模型视图矩阵

```
Rxx Rxy Rxz Tx 
Ryx Ryy Ryz Ty 
Rzx Rzy Rzz Tz 
 0   0   0   1 
```

作用于任意向量

```
x
y
z
1 
```

我们得到

```
Rxx x + Rxy y + Rxz z  +  Tx 
Ryx x + Ryy y + Ryz z  +  Ty
Rzx x + Rzy y + Rzz z  +  Tz
1 
```

（我正在写东西，所以向量乘以左边的矩阵）。

这表明矩阵的平移分量在进行旋转*后*给出了要应用的平移。这就是为什么它们与您的 (-eye_x, -eye_y, -eye_z) 向量不同的原因，因为正如您指出的那样，平移是在旋转之前完成的。

平移总是沿 -z 方向的原因是因为在视图框架中 -z 方向指向中心。由于您的中心始终距眼睛 300 个单位，因此您的所有眼睛位置都将中心置于视图框架中的 (0, 0, -300)。因此，因为中心在我们进行任何翻译之前从原点开始，所以为它提供正确坐标的翻译必须是 (0, 0, -300)。

此外，您可能已经注意到这一点，但您显示的模型视图矩阵是病态的，因为您的向上向量指向视图方向（从眼睛到中心）。这就解释了为什么它有两行完整的零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T08:32:15.123

“我对如何在这段代码中使用前向、向上和侧向向量执行旋转感到非常困惑……”我认为您应该对“UVN 相机”有所了解。有一些关于坐标在两个坐标系之间转换的理论.在上面的例子中，两个坐标是世界坐标和相机坐标。结果是：x![在此处输入图像描述](../Images/fa37fe4f90e29504521ae8fa6d385dbb.png)

N - 从目标到相机的向量。在某些 3D 文献中也称为“查看”矢量。该向量对应于 -Z 轴。

V - 直立时，这是从你的头到天空的矢量。如果您正在编写飞行模拟器并且飞机反转，则该矢量很可能指向地面。该向量对应于 Y 轴。

U - 这个向量从相机指向它的“右侧”。它对应于 X 轴。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-08T15:54:19.513

@Andon M. Coleman - 上面的图表行主要怎么样？具有行或列主矩阵是关于 2D 结构在 1D 内存中的内存表示，与上面的 4x4 变换矩阵图无关。

如果向量 U、V、N 如您所建议的那样写成列，那么您将拥有相机空间到世界空间的转换。

但是，矩阵的输入是世界空间位置，输出是相机空间位置，因此矩阵是世界空间到相机空间的转换。

U,V,N 转置的原因是因为这是您建议的矩阵的逆矩阵，并且通过使用正交矩阵的属性，它们的逆矩阵也是它的转置。也就是说，我们将 U,V,N 向量写入行以获得世界空间到相机空间的转换，并将 U,V,N 写入列以获得相机空间到世界空间的转换。

此外，选择与右侧的世界位置相乘是因为该图使用了列向量。如果我们使用行向量，我们会留下乘法。它与我们如何将矩阵存储在内存中无关，而是与我们如何将两个矩阵相乘，也就是说，在将向量与 4x4 矩阵相乘之前，我们是否将其转换为 1X4 或 4X1 矩阵。

总之，上图没问题，只是从一个空间到另一个空间的转换，请不要把这件事和讲内存布局混为一谈，这是一个编程细节。

# ios - 笔尖到故事板

> ID：13166136
> 
> 赞同：0
> 
> 时间：2012-10-31T19:27:26.963
> 
> 标签：ios, storyboard, nib

我正在使用 Apple 的应用程序计算器，但我需要将其放入`storyboard`不在`xib`文件中。有人可以指导我如何更改它吗？

苹果应用程序的代码如下：

```
- (void) applicationDidFinishLaunching:(UIApplication *)application {    

   // Override point for customization after application launch
   CalcViewController *_calcViewController = [[CalcViewController alloc]        initWithNibName:@"CalcView" bundle:[NSBundle mainBundle]];
   self.calcViewController = _calcViewController;
   [window addSubview:[calcViewCont``roller view]];
   [window makeKeyAndVisible];
} 
```

`storyboard`我想将其放入的称为`SecondViewController`.

有人可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T03:29:47.653

在 Project Navigator 中单击您的项目名称，然后选择您的应用程序 Target，现在将您的故事板名称添加为 Main Storyboard，确保 Main Interface 为空白。

现在`applicationDidFinishLaunching`只需删除该方法中的所有内容。

# oop - OOP：setter 应该是私有的吗？

> ID：13166139
> 
> 赞同：2
> 
> 时间：2012-10-31T19:27:39.537
> 
> 标签：oop, class, setter

在类中编写 getter/setter 时，*setter*是否应该是**私有**方法？

必须编写另一种方法来设置变量似乎有点多余，但似乎这可能允许更可维护的代码结构。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T19:32:53.600

Setter 是一种假设允许修改对象的内部状态而不直接暴露该对象的方法。我们稍后可以在 setter 中包含验证或其他逻辑。

如果您的二传手是私人的，那么您就错过了重点。这就像在你的房子里有一扇门总是关闭的，甚至不允许打开。同样在类中，您可以直接访问该字段，为什么要在那里使用 setter？

当然，真正的问题是：我们应该有二传手吗？如今，典型的类包含一堆字段、自动生成的 getter/setter 并且没有逻辑。这几乎不是一堂课。它只是一种访问元素的笨拙方式的结构。但这不是你所要求的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T20:21:38.003

一般来说，我不建议任何成员进行“私人”访问，也许是“受保护”。通常，您或其他程序员可能在后代类中需要它。

**长无聊的描述性答案**

现在，对于访问器（“getter & setter”），它还取决于编程语言上属性的语法和实现。

例如，C++ 或 Java，我认为没有“真正的属性”，而访问器可能需要与属性具有相同的范围。（除非使用属性模板）。

C# & Delphi (Lazarus) 实现了属性，但是，我不喜欢 C# 声明访问器的方式。

在某些情况下，您可能希望某个属性不公开，可能是“受保护”或“包保护”，以及它的访问者，与该属性具有相同的访问权限。

我只是在 Object Pascal 中编写一些代码。大多数“公共”属性及其访问者“受保护”，但是，想要将该代码迁移到 C++ 或 Java，因此，我也将访问者设为“公共”。

**快速简短的回答**

与属性相同的访问权限，但取决于属性的语法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T19:35:49.200

如果目的是允许从外部对象操纵它们，它们应该是公开的。这就是 POJO 实现的重点。(http://en.wikipedia.org/wiki/Plain_Old_Java_Object)

如果您希望实现一些其他模式，也许查看 Java Access Modifiers 上的文档应该是您的第一站（http://docs.oracle.com/javase/tutorial/java/javaOO/accesscontrol.html）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-31T19:48:45.303

通常您希望 setter/getter 是公开的，因为这就是它们的用途：授予对数据的访问权限，您不想让其他人直接访问，因为您不希望他们弄乱您的实现相关细节 - 这就是封装是关于。

但是，在某些情况下，您可能希望仅对同一类的实例限制对数据的访问，但您仍然希望出于任何原因（簿记、锁定等）保留对数据访问的一些控制 - 即具有私有（或受保护）setter/getter 的情况是有意义的（从代码重用和安全 POV 来看）。但是，您不能依靠编译器来发现您做错了什么。

# scala - Scala 超类构造函数中的“参数过多”错误，但 REPL 中没有

> ID：13166140
> 
> 赞同：1
> 
> 时间：2012-10-31T19:27:40.273
> 
> 标签：scala, constructor, compiler-errors

我正在编写一个类，它使用一些自定义构造函数逻辑扩展了 Scala 的不可变映射。作为一个简单的例子，假设我想要一个整数映射到初始化为的字符串`1 -> "one", 2 -> "two"`。在 REPL 中，我可以编写以下内容。

```
scala> import collection.immutable.HashMap
import collection.immutable.HashMap

scala> HashMap[Int, String](1->"one", 2->"two")
res0: scala.collection.immutable.HashMap[Int,String] = Map(1 -> one, 2 -> two) 
```

在我的程序中，我想使用相同的构造函数调用，但是当我尝试将它放在类定义行中时，我得到一个“构造函数的参数太多”错误。

```
scala> class MyMap extends HashMap[Int, String](1->"1", 2->"2")
<console>:8: error: too many arguments for constructor HashMap: ()scala.collection.immutable.HashMap[Int,String]
   class MyMap extends HashMap[Int, String](1->"1", 2->"2")
               ^ 
```

鉴于调用超类构造函数的方法是在类定义中，我认为`HashMap`在 REPL 中创建 a 的任何表达式也应该在定义中起作用，但是我在这里缺少一些微妙之处。

（我认为在`HashMap`这里扩展具体类而不是特征是正确的做法，因为我想使用默认的地图实现。扩展`HashMap`是我在 Java 中所做的，但我不能 100% 确定扩展具体集合classes 是最 Scalaesque 的操作方式。）

因为我想`MyMap`是不可变的，所以我需要在构造函数时指定初始值。`apply`我可以尝试在伴随对象的函数内部进行初始化，如下所示：

```
class MyMap extends HashMap[Int, String]

object MyMap {
  def apply() = new MyMap ++ List(1 -> "one", 2 -> "two")
} 
```

但`MyMap()`返回一个不可变的映射而不是一个`MyMap`.

初始化的正确方法是`MyMap`什么？

* * *

这个[关于使用具体类型实现 Map 的](https://stackoverflow.com/questions/7004577/scala-implementing-map-with-concrete-types)链接是相关的。

* * *

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T19:41:08.980

你在这里得到一个错误，因为当你写的时候你`Map()`没有调用`Map`. 相反，您调用它的伴随对象的 apply 方法（或更准确地说，它的超类之一的 apply 方法。请参阅 om-nom-noms 注释）：

```
scala> Map(1 -> "one")
res0: scala.collection.immutable.Map[Int,String] = Map(1 -> one)

scala> Map.apply(1 -> "one")
res1: scala.collection.immutable.Map[Int,String] = Map(1 -> one) 
```

如果您想拥有自己的`Map`实现，则需要创建自己的实现。我想出的最简单的事情是：

```
object MyMap {
  def apply(ts: (Int, String)*): MyMap[Int, String] = new MyMap(ts.toMap)
  def apply(): MyMap[Int, String] = apply(1 -> "one", 2 -> "two")
}

class MyMap[A, B] private(t: Map[Int, B]) extends Map[Int, B]  {
  private val internalMap = t
  def +[B1 >: B](kv: (Int, B1)) = new MyMap(internalMap + kv)
  def -(key: Int) = new MyMap(internalMap - key)
  def get(key: Int) = internalMap.get(key)
  def iterator = internalMap.iterator
}

scala> MyMap()
res1: MyMap[Int,String] = Map(1 -> one, 2 -> two) 
```

# html - html css3解析错误

> ID：13166141
> 
> 赞同：-1
> 
> 时间：2012-10-31T19:27:43.730
> 
> 标签：html, css

嘿伙计们，我正在帮助一个人为他创建一个网站。他的分辨率为 1920x1080，而我的分辨率为 1024x768，他说表格被拉长了很多，以及发布部分的问题。很难解释这个问题我的意思是你可以看看这里的网站[http://www.fvforumtest.forumotion.com](http://www.fvforumtest.forumotion.com) 他有两张他发给我的照片

[http://i.imgur.com/TDgme.png](http://i.imgur.com/TDgme.png) 和 [http://i.imgur.com/brGkm.png](http://i.imgur.com/brGkm.png)

我不确定是什么导致了这些混乱，因为我在显示器上看到一切都很好。我们检查了它是否是跨浏览器效率问题，但不是。他在所有浏览器上都看到了上述问题，而我在我的浏览器上看到的很好。

您可以登录为

Acct: tester2
Pass: testingaccount

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T19:43:56.820

***问题 1 - 背景图像拉伸*** 我想他的抱怨是您在最初只有 800 像素宽的图像上*使用background-size:100% 100%的事实。*因此，在 1920 像素宽分辨率下，这将拉伸到 1920 像素（1728 像素）的近 90% - 因此出现拉伸现象。

要解决这个问题，要么首先使图形变大，要么修改图形，使其不需要拉伸到整个宽度。

***问题 2 - 消息文本被截断*** 我会说这是因为你绝对定位*了笑脸框*，它的宽度是 22%。80% (#textarea_content) + 22% (#smiley-box) 不是 100%，所以肯定会发生重叠。

***问题 3 - 隐藏的滚动条*** 很难说。您是否尝试过设置滚动条的样式（例如自定义颜色等）？这可能是问题所在。如果是这种情况，请从滚动条中删除所有样式，并在必要时减慢构建速度。我敢肯定，您只需要稍微调整一下样式即可使其正常工作。

# .net - 当.net中的RAM用完时，是否有强制程序使用页面文件虚拟内存？

> ID：13166144
> 
> 赞同：2
> 
> 时间：2012-10-31T19:28:02.183
> 
> 标签：.net, out-of-memory

```
struct SomeStruct
{
   //some fields, store ~3kb
}

List<SomeStruct> lst = new List<SomeStruct>();

for (int i = 0; i < int.MaxValue; i++)
   lst.Add(new SomeStruct(/*...*/)); //somewhere we get OutOfMemory exception 
```

所以...我希望它使用虚拟内存并继续工作，而不是异常

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T19:31:17.703

我很确定你不能那样做。虚拟内存背后的想法是程序*无法区分*。如果您遇到 OutOfMemory 异常，则意味着操作系统已告诉您“您无法再获得”，包括虚拟内存。

如果有的话，您将需要摆弄操作系统中的设置以及它如何处理虚拟内存。

# ruby-on-rails - 使用 Cucumber 和 Capybara 集成测试 Backbone.js 应用程序

> ID：13166147
> 
> 赞同：4
> 
> 时间：2012-10-31T19:28:15.047
> 
> 标签：ruby-on-rails, backbone.js, cucumber, capybara

我正在尝试使用 Cucumber、capybara、capybara-webkit、selenium-webdriver、rspec 和 jasmine 测试在 Rails 3.2.8 之上运行的 Backbone 应用程序。我使用 eco 作为主干模板的模板引擎。

我的问题是当我使用 @javascript 标签运行场景时，无论是使用 capybara-webkit 还是 selenium，显示的页面都不包含所有模型属性数据。

这是场景：

```
@javascript
Scenario : first scenario
     Given There is Model with "name" as name and "What is it about ?" as associated questions
     When I want to fill the questionnaire
     Then I should be on the SPA form
     And I should see "name"
     And I should see "What is it about?" 
```

场景在“我应该看到'它是关于什么的？'”步骤中失败，页面没有显示问题，但它显示了“名称”我在我的主干代码中使用 console.log 和我可以看到模型的所有属性都是正确的。此外，它可以在没有问题的情况下正常工作

模板如下所示：'show.jst.eco'

```
<p class="text-info"><%= @model.name %></p>

<form id="quidget-form" class="form-vertical">
  <% for question in @model.questions: %>
    <div class="issue_field">
      <label class="string optional control-label"><%= question.question.question_text %></label>
      <div class="control-group text">
        <textarea class="text answer" name="question-<%= question.question.id %>" id="question_<%= question.question.id %>" data-question="<%= question.question.question_text %>" rows="3">
        </textarea>
      </div>
    </div>
  <% end %>

  <div class="controls">
    <input type="submit" value="Additional Informations" id="quidget-step-one" class="btn btn-success"> 
```

显示文本区域，但不显示上面带有问题文本的标签

任何想法 ？我想看到这个通过，所以我可以用更多的步骤测试更复杂的逻辑。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-30T21:57:22.277

我也一直在对这类事情进行一些研究。其中大部分都集中在 Ember.js 而不是 Backbone，但 Pamela Fox 刚刚写了一篇关于为 Coursera 测试 Backbone.js 前端的博客文章，它可能会有所帮助[http://blog.pamelafox.org/2013/06/testing -backbone-frontends.html](http://blog.pamelafox.org/2013/06/testing-backbone-frontends.html)另外，您是否尝试过以与通用 Rails 应用程序相同的方式使用 capybara 进行测试`:js => true`？可能值得一试。

# iphone - UIImageView 在 XIB 中使用哪个 UIImage 方法？

> ID：13166149
> 
> 赞同：0
> 
> 时间：2012-10-31T19:28:16.513
> 
> 标签：iphone, ios, uiimageview, uiimage, interface-builder

据我所知，`UIImageView`XIB 中的 s 不使用`+imageNamed`. 我也试过`+imageWithContentsOfFile`了，但这也不是骰子。

**Interface Builder XIB 使用哪种 UIImage 方法在`ImageView`s 中加载图像？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T06:00:18.503

请参阅下面给出的链接，它可能会对您有所帮助。很可能第三个答案会帮助你，

[如何以编程方式更改 UIImageView 中显示的图像？](https://stackoverflow.com/questions/706240/how-can-i-change-the-image-displayed-in-an-uiimageview-programmatically)

当您在 XIB 中设置图像时，应触发最后一种方法

```
 [YOURCONTROLLER.imageToDisplay setImage:[UIImage imageNamed:value]]; 
```

# mysql - Emacs SQLi模式在SQL发送中有不平衡的引号

> ID：13166154
> 
> 赞同：2
> 
> 时间：2012-10-31T19:28:33.987
> 
> 标签：mysql, emacs, sql-mode

这里有趣的问题。当尝试在 Emacs SQLi 模式缓冲区中发送任何合理数量的信息时，结果通常是不平衡的引号和无法解释的随机语句。但是，当我一次运行一点 SQL 文件时，一切都按预期工作。

通常缓冲区执行失败的结果是 SQL 缓冲区，如下所示：

```
mysql> mysql> mysql> mysql> Query OK, 0 rows affected, 1 warning (0.00 sec)

mysql>     ->     ->     ->     ->     ->     ->     ->     ->     '>     '>
'>     '>    '>     '>     '>     '>     '>     '>     '>     '>     '>
'>     '>    '>     '>     '>     '>     '>     '> 
```

显然，事后手动关闭报价会导致更多错误。

我确保简化了 SQL 文件，因此其中没有 MySQL 主义，以防它们混淆模式，但问题仍然存在。

通过一些调查，它似乎切断了第 100-130 行（也许是 128？）之间的任何查询。

**tl;dr - Emacs SQLi 模式在以少量 SQL 发送 SQL 时有效，但在发送超过 128 行时会出错。**

我在这里错过了什么吗？

# symfony - Symfony2 获取表单中的项目类型

> ID：13166156
> 
> 赞同：4
> 
> 时间：2012-10-31T19:28:50.103
> 
> 标签：symfony, symfony-2.1

我有一个表单，并且需要 bindrequest 中的字段类型，getType 方法不能正常工作：

```
$peticion = $this->getRequest();
        if ($peticion->getMethod() == 'POST') 
        {
            $form->bindRequest($peticion);

            if ($form->isValid()) {

             foreach($form as $key => $per)
                       $per->getType(); // i want the type of item [text,checkbox,etc] the method getType() dont work
 }} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-31T22:26:56.470

用这个：

```
foreach($form as $key => $per) {
    $per->getConfig()->getType()->getName();
} 
```

# java - java如何从JPANEL（子表单）中设置JFRAME（父表单）中的标签文本

> ID：13166166
> 
> 赞同：1
> 
> 时间：2012-10-31T19:29:55.580
> 
> 标签：java, swing, constructor, jframe, jpanel

我认为这更好。为什么标签文本没有改变？主类是NewJFrame形式

```
public class NewJFrame extends javax.swing.JFrame {
        public NewJFrame() {
            initComponents();
            NewJPanel jpanel = new NewJPanel();
            anotherPanel.add(jpanel);
         //there is also a label in this frame outside of the anotherPanel
        }
    } 
```

这是一个JPanel 表单。我将此 jpanel 添加到 NewJFrame (anotherPanel)

```
public class NewJPanel extends javax.swing.JPanel {
        public NewJFrame newJFrame;
            public NewJPanel() {
                initComponents();
                this.setSize(200, 200);
        //there is a button here
            }
   private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {
                this.newJFrame = newJFrame;
      newJFrame.jLabel1.setText("Need To change the text from here"); // this is not working, text is not changing
            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T19:33:27.423

您的问题是，在您的 JPanel 代码中，您正在创建一个新的 JFrame 对象，该对象与正在显示的 JFrame 完全不同，这里：

```
public NewJPanel() {
 NewJFrame newfr = NewJFrame();  // *** here *** 
```

因此调用 NewJFrame 方法或设置其字段对可视化 GUI 没有明显影响。

要解决这个问题，您必须在对要更改行为的类的可行引用上调用方法，这里是 NewJFrame 类。因此，您必须将此类的引用传递给您的 NewJPanel 类，可能在其构造函数中，以便 NewJPanel 类可以调用实际显示的 NewJFrame 对象上的方法。

例如：

```
public class NewJPanel extends javax.swing.JPanel {  
  private NewJFrame newJFrame;

  // pass in the current displayed NewJFrame reference when calling this constructor
  public NewJPanel(NewJFrame newJFrame) {
    this.newJFrame = newJFrame;
    newJFrame.setMyLabelText("qqqqqq");
  }          
} 
```

然后在 NewJFrame 类中，传递`this`对可视化 JFrame 对象的引用：

```
public NewJFrame() {
  NewJPanel pane= new NewJPanel(this); 
```

这里的底线是甚至不要将这些人视为 JFrames 或 JPanels。只需将它们视为需要相互通信的类的对象，这通常通过公共方法完成。GUI 和非 GUI 程序没有什么不同。

# javascript - 当页面完全滚动到顶部时隐藏转到顶部按钮

> ID：13166168
> 
> 赞同：0
> 
> 时间：2012-10-31T19:30:04.143
> 
> 标签：javascript, jquery, scroll

我的 wordpress 主题主页上有一个按钮，用于转到页面顶部。我想在页面完全滚动到顶部时隐藏它。这是我的代码：

```
(function($) {

var version = '@VERSION',

    defaults = {

      exclude: [],

      excludeWithin:[],

      offset: 0,

      direction: 'top', // one of 'top' or 'left'

      scrollElement: null, // jQuery set of elements you wish to scroll (for $.smoothScroll).

                          //  if null (default), $('html, body').firstScrollable() is used.

      scrollTarget: null, // only use if you want to override default behavior

      beforeScroll: function() {},  // fn(opts) function to be called before scrolling occurs. "this" is the element(s) being scrolled

      afterScroll: function() {},   // fn(opts) function to be called after scrolling occurs. "this" is the triggering element

      easing: 'swing',

      speed: 600,

      autoCoefficent: 2 // coefficient for "auto" speed

    },

    getScrollable = function(opts) {

      var scrollable = [],

          scrolled = false,

          dir = opts.dir && opts.dir == 'left' ? 'scrollLeft' : 'scrollTop';

      this.each(function() {

        if (this == document || this == window) { return; }

        var el = $(this);

        if ( el[dir]() > 0 ) {

          scrollable.push(this);

        } else {

          // if scroll(Top|Left) === 0, nudge the element 1px and see if it moves

          el[dir](1);

          scrolled = el[dir]() > 0;

          if ( scrolled ) {

            scrollable.push(this);

          }

          // then put it back, of course

          el[dir](0);

        }

      });

      // If no scrollable elements, fall back to <body>,

      // if it's in the jQuery collection

      // (doing this because Safari sets scrollTop async,

      // so can't set it to 1 and immediately get the value.)

      if (!scrollable.length) {

        this.each(function(index) {

          if (this.nodeName === 'BODY') {

            scrollable = [this];

          }

        });

      }

      // Use the first scrollable element if we're calling firstScrollable()

      if ( opts.el === 'first' && scrollable.length > 1 ) {

        scrollable = [ scrollable[0] ];

      }

      return scrollable;

    },

    isTouch = 'ontouchend' in document;

$.fn.extend({

  scrollable: function(dir) {

    var scrl = getScrollable.call(this, {dir: dir});

    return this.pushStack(scrl);

  },

  firstScrollable: function(dir) {

    var scrl = getScrollable.call(this, {el: 'first', dir: dir});

    return this.pushStack(scrl);

  },

  smoothScroll: function(options) {

    options = options || {};

    var opts = $.extend({}, $.fn.smoothScroll.defaults, options),

        locationPath = $.smoothScroll.filterPath(location.pathname);

    this

    .unbind('click.smoothscroll')

    .bind('click.smoothscroll', function(event) {

      var link = this,

          $link = $(this),

          exclude = opts.exclude,

          excludeWithin = opts.excludeWithin,

          elCounter = 0, ewlCounter = 0,

          include = true,

          clickOpts = {},

          hostMatch = ((location.hostname === link.hostname) || !link.hostname),

          pathMatch = opts.scrollTarget || ( $.smoothScroll.filterPath(link.pathname) || locationPath ) === locationPath,

          thisHash = escapeSelector(link.hash);

      if ( !opts.scrollTarget && (!hostMatch || !pathMatch || !thisHash) ) {

        include = false;

      } else {

        while (include && elCounter < exclude.length) {

          if ($link.is(escapeSelector(exclude[elCounter++]))) {

            include = false;

          }

        }

        while ( include && ewlCounter < excludeWithin.length ) {

          if ($link.closest(excludeWithin[ewlCounter++]).length) {

            include = false;

          }

        }

      }

      if ( include ) {

        event.preventDefault();

        $.extend( clickOpts, opts, {

          scrollTarget: opts.scrollTarget || thisHash,

          link: link

        });

        $.smoothScroll( clickOpts );

      }

    });

    return this;

  }

});

$.smoothScroll = function(options, px) {

  var opts, $scroller, scrollTargetOffset, speed,

      scrollerOffset = 0,

      offPos = 'offset',

      scrollDir = 'scrollTop',

      aniProps = {},

      aniOpts = {},

      scrollprops = [];

  if ( typeof options === 'number') {

    opts = $.fn.smoothScroll.defaults;

    scrollTargetOffset = options;

  } else {

    opts = $.extend({}, $.fn.smoothScroll.defaults, options || {});

    if (opts.scrollElement) {

      offPos = 'position';

      if (opts.scrollElement.css('position') == 'static') {

        opts.scrollElement.css('position', 'relative');

      }

    }

    scrollTargetOffset = px ||

                        ( $(opts.scrollTarget)[offPos]() &&

                        $(opts.scrollTarget)[offPos]()[opts.direction] ) ||

                        0;

  }

  opts = $.extend({link: null}, opts);

  scrollDir = opts.direction == 'left' ? 'scrollLeft' : scrollDir;

  if ( opts.scrollElement ) {

    $scroller = opts.scrollElement;

    scrollerOffset = $scroller[scrollDir]();

  } else {

    $scroller = $('html, body').firstScrollable();

  }

  aniProps[scrollDir] = scrollTargetOffset + scrollerOffset + opts.offset;

  opts.beforeScroll.call($scroller, opts);

  speed = opts.speed;

  // automatically calculate the speed of the scroll based on distance / coefficient

  if (speed === 'auto') {

    // if aniProps[scrollDir] == 0 then we'll use scrollTop() value instead

    speed = aniProps[scrollDir] || $scroller.scrollTop();

    // divide the speed by the coefficient

    speed = speed / opts.autoCoefficent;

  }

  aniOpts = {

    duration: speed,

    easing: opts.easing,

    complete: function() {

      opts.afterScroll.call(opts.link, opts);

    }

  };

  if (opts.step) {

    aniOpts.step = opts.step;

  }

  if ($scroller.length) {

    $scroller.stop().animate(aniProps, aniOpts);

  } else {

    opts.afterScroll.call(opts.link, opts);

  }

};

$.smoothScroll.version = version;

$.smoothScroll.filterPath = function(string) {

  return string

    .replace(/^\//,'')

    .replace(/(index|default).[a-zA-Z]{3,4}$/,'')

    .replace(/\/$/,'');

};

// default options

$.fn.smoothScroll.defaults = defaults;

function escapeSelector (str) {

  return str.replace(/(:|\.)/g,'\\$1');

}

})(jQuery); 
```

您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:43:35.353

I'm guessing this is based on user events so something like this to cover mousescroll and scroll

```
 $(window).bind( "mousewheel DOMMouseScroll scroll", function(e){
 if (document.body.scrollTop == 0) {
    // do this
 }

 }) 
```

# actionscript-3 - 使两个列表相同

> ID：13166170
> 
> 赞同：0
> 
> 时间：2012-10-31T19:30:08.993
> 
> 标签：actionscript-3, flash, flex4, flash-builder, mxml

我的 Flex 项目的主课中有一个列表 (mx:List)。

我有另一个类处理其他事情，但需要有这个相同的列表，列表的所有功能和列表的副本需要能够对大师班做与大师班完全相同的事情'自己的列表（例如单击操作和更改操作）。

有没有一种简单的方法来引用大师班的列表并告诉我的对话类只显示大师班的列表？

到目前为止，我尝试重新创建列表及其所有功能，但事实证明这很困难，因为大师班列表与自身的交织程度。我还尝试了一种简单的方法，只是使用 FlexGlobals 将列表设置为等于主类列表，但这不起作用。

# java - Do-Nothing 适配器访问器方法

> ID：13166172
> 
> 赞同：1
> 
> 时间：2012-10-31T19:30:16.127
> 
> 标签：java

我已经四处寻找这个特定问题的帮助，也许我的措辞是错误的，如果是这样，一个链接将是完美的！

这是问题所在：

我有一个界面如下：

```
Product get(String prodCode); 
```

我还有一个实现接口的抽象类，它具有以下内容：

```
public Product get(String prodCode) { //Do nothing } 
```

但是，为了满足编译器的要求，我必须返回一些东西（null 或 Product）。我的理解是它不应该返回这些东西，因为它不再“什么都不做”。我不确定如何在什么都不做的同时满足编译器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T19:40:38.367

Based on the information from your comment, I would say that you could do either one of the following:

1.  Return `null`.
2.  Return a default `Product` object which has no functionality.

Returning `null` would be the simplest, but you would want to make sure that calling code protects itself from `NullPointerException`'s that could result from attempting to interact with the returned result.

If you were to do the second, a `static final` object would probably be ideal to return.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T19:31:33.657

我不知道您的 DoNothingProduct 实现会是什么样子，但是您可以为 Product 设置一个无参数的默认构造函数，该构造函数将返回一个设置了默认字段的不可变对象。

# php - 将 JQuery 函数插入 php

> ID：13166173
> 
> 赞同：1
> 
> 时间：2012-10-31T19:30:24.970
> 
> 标签：php, jquery, wordpress

我正在尝试在我的 php 页面中使用一些 jQuery 函数，这些函数用于 wordpress 插件。我已经使用下面的代码导入了 jquery api，但是我不确定如何编写函数。

```
 <?php
    echo "Custom Book Settings Page";
    echo '<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>'; 
```

这会产生语法错误

```
 <?php   
     $("#form1").submit(function() { $.post("customBook-index.php"); return false; alert ("submit form 1"); });
 ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T19:46:57.340

正如其他人所说，您不能在 PHP 中使用 JavaScipt（或其任何库）。但是，您当然可以使用 PHP 打印出将在适当时间运行的 JavaScript。

```
<?php echo "<script type='text/javascript'>
  $(document).ready(function(){   
     $('#form1').submit(function() {
        $.post('customBook-index.php');
        return false;
        alert ('submit form 1');
     });
  });
</script>";
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T19:38:22.657

你为什么不只使用没有标签的语法？

```
 $("#form1").submit(function() { $.post("customBook-index.php"); return false; alert ("submit form 1"); }); 
```

如果您必须让 php 编写语句，那么您忘记了 echo

```
 <?php   
 echo '$("#form1").submit(function() { $.post("customBook-index.php"); return false; alert ("submit form 1"); });';
  ?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T19:39:12.817

你不能在你的 PHP 中使用这样的 jQuery。JQuery 是一个 JavaScript 库。它本质上是为您预先编写并以易于使用的方式抽象的代码。当您调用时，`$('#myElementId)`您调用的是 JavaScript 函数（或函数集）的抽象。

在 PHP 中使用 jQuery 是行不通的，因为 PHP 解释器无法理解它。这就像用中文向（单语）英语的人发出指令。此外，PHP 和 JavaScript 之间存在显着差异，因为 PHP 是在 Web 服务器上执行的，而 JavaScript 是在客户端机器上执行的。对于任何 Web 程序员来说，这是一个重要的概念。

简而言之，您要么需要将 JS 函数写入`<script>`页面上的标签，以便导航器将其解析为 JavaScript，要么确定您尝试执行的 PHP 等效项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T19:44:19.970

```
 // turn off php
?>   
$("#form1").submit(function() { 
    $.post("customBook-index.php");
    return false; 
    alert ("submit form 1"); 
});
<?php 
```

# jquery - 使用本地/会话存储保存 .addClass()

> ID：13166175
> 
> 赞同：2
> 
> 时间：2012-10-31T19:30:54.053
> 
> 标签：jquery, html, session, storage, local

对于一个学校项目，我需要制作一个电影院的预订系统，这样人们就可以选择他们想坐的座位。

一个要求是，如果有人预订了椅子，那么 ele 应该不能再预订了。

我的想法是在您单击页面底部的“购买门票”时为选定的椅子添加一个课程，但是我如何保存这些课程，我的教授说我应该使用 HTML 5 存储，但他们拒绝帮助我更远。

这是我现在已经拥有的一部分：

```
<script>
 var total = 0;
 var countBlauw = 0;
 var countOranje = 0;
 var countRood = 0;
 $(document).ready(function(){
     $(".blauw").toggle(function () {
       $(this).removeClass("blauw").addClass("select");
 countBlauw++;
 total+=7.5;
 calculateTotal();
 }, function() { 
       $(this).removeClass("select").addClass("blauw");
 countBlauw--;
       total-=7.5;
 calculateTotal();
     });
 $(".oranje").toggle(function () {
       $(this).removeClass("oranje").addClass("select");
 countOranje++;
 total+=10;
 calculateTotal();
 }, function() {
       $(this).removeClass("select").addClass("oranje");
 countOranje--;
       total-=10;
 calculateTotal();
     });
 $(".rood").toggle(function () {
       $(this).removeClass("rood").addClass("select");
 countRood++;
       total+=15;
 calculateTotal();
 }, function() {
       $(this).removeClass("select").addClass("rood");
 countRood--;
       total-=15;
 calculateTotal();
     });
 });
 </script> 
        <script>
        function calculateTotal()
        {
            var divobj = document.getElementById('totalPrice');
            divobj.style.display='block';
            divobj.innerHTML = "Prijs €"+total+"<br /> Aantal blauwe stoelen: "+countBlauw+"<br /> Aantal oranje stoelen: "+countOranje+"<br /> Aantal rode stoelen: "+countRood;

        }
        </script> 

        <table style="empty-cells: hide; border-collapse:separate; border-spacing:2px; border-style:solid;" border="0">
          <tr>
            <td class="leeg"></td>
            <td class="leeg"></td>
            <td class="blauw">&nbsp;</td>
            <td class="blauw">&nbsp;</td>
            <td class="blauw">&nbsp;</td>
            <td class="blauw">&nbsp;</td>
            <td class="blauw">&nbsp;</td>
            <td class="blauw">&nbsp;</td>
            <td class="blauw">&nbsp;</td>
            <td class="blauw">&nbsp;</td>
            <td class="leeg"></td>
            <td class="leeg"></td>
          </tr>
            And so forth.

        <script>
 $(window).load( function() {
  document.getElementById('totalPrice').innerHTML = "Prijs €"+total+"<br /> Aantal blauwe stoelen: "+countBlauw+"<br /> Aantal oranje stoelen: "+countOranje+"<br /> Aantal rode stoelen: "+countRood;
 });
 </script>
        <div id="totalPrice"></div> 
```

是否可以将使用 .addClass() 添加的类保存到本地或会话存储中？这应该只是一个模拟，所以另一台计算机（或使用其他浏览器）上的某人是否可以预订同一个座位并不重要。

有人可以给我一些建议吗？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:59:22.863

`localStorage`只能存储字符串值，因此有助于使用 JSON 保存数组：

```
function loadTakenSeats() {
    takenSeatsString = localStorage.takenSeats;
    return takenSeatsString
        ? JSON.parse(takenSeatsString)
        : [];
}

function saveTakenSeats(takenSeats) {
    localStorage.takenSeats = JSON.stringify(takenSeats);
} 
```

当一个座位被占用或释放时，你可以从保存的数组中添加或删除它的 id：

```
function takeSeat(seat) {
    $(seat).addClass('taken');
    var takenSeats = loadTakenSeats();
    takenSeats.push(seat.id);
    saveTakenSeats(takenSeats);
}

function untakeSeat(seat) {
    $(seat).removeClass('taken');
    var takenSeats = loadTakenSeats();
    takenSeats.splice(takenSeats.indexOf(seat.id),1);
    saveTakenSeats(takenSeats);
} 
```

当页面加载时，您将从存储中恢复按钮的状态：

```
 $.each(loadTakenSeats(), function(i, seat){
        $('#'+seat).addClass('taken');
  }); 
```

请注意，此代码不是特别健壮，更好的实现将确保避免存储数组中的重复值，将更改按钮样式与将其添加`id`到存储等分开。

我已经上传[了一个完整的例子](http://codepen.io/millimoose/pen/eunHr)来试用。

# javascript - jQuery：仅当页面上当前没有运行 AJAX 时才提交表单

> ID：13166176
> 
> 赞同：4
> 
> 时间：2012-10-31T19:30:54.613
> 
> 标签：javascript, jquery, ajax

当城市输入字段模糊时，我会通过 ajax 请求获取 somne​​thing，并将其设置为与城市字段相同形式的隐藏字段的值。

```
$('input#city').on('blur', function() {
    $.ajax({
        url: 'get/something?param=val',
        success: function(response) {
            $('input:hidden[name="something"]').val(response);
        }
    });
}); 
```

如果用户在模糊城市字段后立即提交表单，有时由于延迟，隐藏字段不会填充，因为另一端的 SQL 花费的时间太长。

这两个字段所在的表单也是通过 ajax 提交的：

```
$('form#find-users').on('submit', function() {
    if(NO_AJAX_CURRENTLY_RUNNING_ON_PAGE) {
        // do stuff
    }
}); 
```

**如何检测页面上是否没有运行ajax？**这将确保在处理表单之前完成城市 ajax 并填充隐藏字段。

## 编辑

实际上不会，它只会阻止表单提交。但是，如果我能检测到这一点，那么我可以使用 setInterval 并继续尝试运行该代码，直到它运行为止，因为 ajax 已完成。理想情况下，jQuery 中会有一些东西等到其他 ajax 完成然后提交。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-31T19:41:31.080

使用 jQuery 的[Ajax 事件](http://docs.jquery.com/Ajax_Events)。只要您的所有 Ajax 调用都是使用 jQuery 生成的，您就可以知道是否有任何 Ajax 调用未完成。

```
$(document).ready(function() {
    var ajaxBusy = false;

    $(document).ajaxStart( function() { 
        ajaxBusy = true; 
    }).ajaxStop( function() {
        ajaxBusy = false;
    });
}); 
```

**编辑：**

这样就回答了您关于“我如何知道是否有任何 Ajax 调用正在运行”的直接问题。

或者，您可以在运行模糊处理程序时禁用表单的提交按钮，然后在完成后重新启用它。

```
$('input#city').on('blur', function() {
    var submit = $(this).closest('form').find(':submit:enabled');
    submit.prop('disabled', true);
    $.ajax('get/something?param=val').done(function(response) {
        $('input:hidden[name="something"]').val(response);
    }).always(function() {
        submit.prop('disabled', false);
    });
}); 
```

**编辑2：**

所以现在我们想要延迟表单提交，直到所有当前的 Ajax 调用都完成。我们让人们点击提交按钮，但如果有未决的 Ajax 调用，我们不会立即执行任何操作。

我们可以使用[Deferred](http://api.jquery.com/category/deferred-object/)对象来帮助我们解决这个问题。

```
$(document).ready(function() {
    var ajaxDefer = $.Deferred().resolve();

    $(document).ajaxStart( function() { 
        ajaxDefer = $.Deferred(); 
    }).ajaxStop( function() {
        ajaxDefer.resolve();
    });

    $('form#find-users').on('submit', function() {
        ajaxDefer.always(function() {
            // Code here will always be executed as soon as there are no 
            // Ajax calls running.
            // this points to the deferred object (ajaxDefer), so use the closure
            // to carry over any variables you need.
        });
    });
}); 
```

1.  当我们刚刚开始时，我们将`ajaxDefer`对象设置为已解决状态。这意味着使用附加的任何功能`.always()`都将立即执行。

2.  当第一个 Ajax 调用开始时，我们将旧`ajaxDefer`对象替换为尚未解析的新对象。使用附加的任何新功能`ajaxDefer.always()`将推迟到以后。

3.  当最后一个 Ajax 调用完成时，我们调用`ajaxDefer.resolve()`，这会导致执行任何未执行的延迟函数。现在我们回到初始状态，任何新附加的函数都将立即执行。

4.  当有人尝试提交表单时，创建一个匿名函数来完成这项工作并将其附加到`ajaxDefer`. 它会在适当的时候被执行，这取决于是否有任何未完成的 Ajax 请求。注意你的关闭。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-13T23:30:28.863

使用它来检查 AJAX 调用当前是否正在使用 JQuery 进行：

```
if ($.active == 0) {
  ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T19:33:25.373

您可以在全局命名空间中放置一个变量，也许命名`ajaxLock`并在 AJAX 启动时将其打开，在响应到来时将其关闭。然后在允许提交之前检查它。

就像是

```
var ajaxLock = 1;
$('input#city').on('blur', function() {
$.ajax({
    url: 'get/something?param=val',
    success: function(response) {
        $('input:hidden[name="something"]').val(response);
        ajaxLock = 0;
    }
    });
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-31T19:36:13.473

使用您建议的锁定变量：

```
$('input#city').on('blur', function() {
    window.AJAX_CURRENTLY_RUNNING_ON_PAGE = true;
    $.ajax({
        url: 'get/something?param=val',
        success: function(response) {
            $('input:hidden[name="something"]').val(response);
        },
        complete: function() { window.AJAX_CURRENTLY_RUNNING_ON_PAGE = false; }
    });
});

$('form#find-users').on('submit', function() {
    if(window.AJAX_CURRENTLY_RUNNING_ON_PAGE) {
        return;
    }
    //dostuff
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T19:38:19.250

在这种情况下我可以做的是使用像块 ui 这样的插件或禁用表单提交按钮，原因是你需要在设计中进行交互，你可以锁定表单提交，但最好给出一个消息或模态变灰

# android - 下载文件进度对话框

> ID：13166179
> 
> 赞同：1
> 
> 时间：2012-10-31T19:31:08.260
> 
> 标签：android, sdk

我想执行文件下载并显示一个对话框。但是当我尝试显示对话框时出现错误，有什么帮助吗？

问题在`showDialog(DIALOG_DOWNLOAD_PROGRESS);`

这是错误消息： Activity 类型的方法 showDialog(int) 已弃用

这是我的代码：

```
public class download extends Activity {

public static final int DIALOG_DOWNLOAD_PROGRESS = 0;
private Button startBtn;
private ProgressDialog mProgressDialog;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    startBtn = (Button)findViewById(R.id.startBtn);
    startBtn.setOnClickListener(new OnClickListener(){
        public void onClick(View v) {
            startDownload();
        }
    });
}

private void startDownload() {
    String url = "http://practicalbuddhist.com/wp-content/uploads/2012/03/Synapses-Image-for-March-17-2010-Blog-Entry.jpg";
    new DownloadFileAsync().execute(url);
}
@Override
protected Dialog onCreateDialog(int id) {
    switch (id) {
    case DIALOG_DOWNLOAD_PROGRESS:
        mProgressDialog = new ProgressDialog(this);
        mProgressDialog.setMessage("Running Download Test...");
        mProgressDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        mProgressDialog.setCancelable(false);
        mProgressDialog.show();
        return mProgressDialog;
    default:
        return null;
    }
} 
```

类 DownloadFileAsync 扩展 AsyncTask {

```
@SuppressWarnings("deprecation")
@Override
protected void onPreExecute() {
    super.onPreExecute();
    showDialog(DIALOG_DOWNLOAD_PROGRESS);

}

@Override
protected String doInBackground(String... aurl) {
    int count;

try {

URL url = new URL(aurl[0]);
URLConnection conexion = url.openConnection();
conexion.connect();

int lenghtOfFile = conexion.getContentLength();
Log.d("ANDRO_ASYNC", "Lenght of file: " + lenghtOfFile);

InputStream input = new BufferedInputStream(url.openStream());
OutputStream output = new FileOutputStream("/sdcard/Downloadtest.jpg");

byte data[] = new byte[1024];

long total = 0;

    while ((count = input.read(data)) != -1) {
        total += count;
        publishProgress(""+(int)((total*100)/lenghtOfFile));
        output.write(data, 0, count);
    }

    output.flush();
    output.close();
    input.close();
} catch (Exception e) {}
return null;

}
protected void onProgressUpdate(String... progress) {
     Log.d("ANDRO_ASYNC",progress[0]);
     mProgressDialog.setProgress(Integer.parseInt(progress[0]));
}

@SuppressWarnings("deprecation")
@Override
protected void onPostExecute(String unused) {
    dismissDialog(DIALOG_DOWNLOAD_PROGRESS);
} 
```

} }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T19:50:35.547

您还可以使用未弃用的 ProgressDialog 和 show() 方法来代替使用 showDialog。在 AsyncTask 中声明你的对话框：

```
class DownloadFileAsync extends AsyncTask<String, String, String> {

private ProgressDialog pDialog;

    @Override
    protected void onPreExecute()
    {
        super.onPreExecute();
        pDialog = new ProgressDialog(context);
        pDialog.setMessage("Please wait...");
        pDialog.setIndeterminate(false);
        pDialog.setCancelable(true);
        pDialog.show();
    }
} 
```

并在 onPostExecute() 使用

```
pDialog.dismiss(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T19:35:19.707

> 这是错误消息： Activity 类型的方法 showDialog(int) 已弃用

这是一个警告，而不是错误。您可以升级到使用 Fragments 或忽略它。

# asp.net-mvc - 在 ASP.NET MVC 4 中强制同步执行异步操作

> ID：13166180
> 
> 赞同：6
> 
> 时间：2012-10-31T19:31:14.987
> 
> 标签：asp.net-mvc, asp.net-mvc-4

由于 MVC 4 不支持异步子操作（通过`Html.Action`），我正在寻找一种强制同步执行子操作的方法。解决此限制的一个简单方法是为我的所有控制器操作提供同步版本：

```
public class FooAsyncController : Controller {
    public async Task<ActionResult> IndexAsync() {
        var model = await service.GetFoo().ConfigureAwait(false);
        return View(model);
    }   
}

public class FooSyncController : FooAsyncController {
    public ActionResult Index() {
        return IndexAsync().Result; // blocking call
    }   
} 
```

但是，由于我们允许对所有控制器操作进行子操作请求，因此对每个控制器执行此操作是一个真正的 PITA。

框架中是否有任何可扩展点，我们可以检查动作的返回值，如果它返回 a`Task<T>`并且我们正在处理子动作，则强制同步调用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T14:56:23.700

在浏览 ASP.NET MVC 源代码几个小时后，我能想到的最佳解决方案（除了创建每个控制器操作的同步版本之外）是手动调用`Controller.HandleUnknownAction`.

我对这段代码不是特别满意，我希望它可以改进，但它*确实*有效。

这个想法是故意请求一个无效的动作（以“_”为前缀），它将调用`HandleUnknownAction`控制器上的方法。在这里，我们寻找匹配的异步操作（首先从 中删除下划线`actionName`）并调用该`AsyncActionDescriptor.BeginExecute`方法。通过立即调用该`EndExecute`方法，我们有效地**同步**执行了动作描述符。

```
public ActionResult Index()
{
    return View();
}

public async Task<ActionResult> Widget(int page = 10)
{
    var content = await new HttpClient().GetStringAsync("http://www.foo.com")
        .ConfigureAwait(false);
    ViewBag.Page = page;
    return View(model: content);
}

protected override void HandleUnknownAction(string actionName)
{
    if (actionName.StartsWith("_"))
    {
        var asyncActionName = actionName.Substring(1, actionName.Length - 1);
        RouteData.Values["action"] = asyncActionName;

        var controllerDescriptor = new ReflectedAsyncControllerDescriptor(this.GetType());
        var actionDescriptor = controllerDescriptor.FindAction(ControllerContext, asyncActionName)
            as AsyncActionDescriptor;

        if (actionDescriptor != null)
        {
            AsyncCallback endDelegate = delegate(IAsyncResult asyncResult)
            {

            };

            IAsyncResult ar = actionDescriptor.BeginExecute(ControllerContext, RouteData.Values, endDelegate, null);
            var actionResult = actionDescriptor.EndExecute(ar) as ActionResult;

            if (actionResult != null)
            {
                actionResult.ExecuteResult(ControllerContext);
            }
        }
    }
    else
    {
        base.HandleUnknownAction(actionName);
    }
} 
```

**风景**

```
<h2>Index</h2>

@Html.Action("_widget", new { page = 5 }) <!-- note the underscore prefix --> 
```

我几乎可以肯定通过覆盖有更好的方法`Controller.BeginExecute`。默认实现如下所示。这个想法是`Controller.EndExecuteCore`立即执行，尽管到目前为止我还没有取得任何成功。

```
protected virtual IAsyncResult BeginExecute(RequestContext requestContext, AsyncCallback callback, object state)
{
    if (DisableAsyncSupport)
    {
        // For backwards compat, we can disallow async support and just chain to the sync Execute() function.
        Action action = () =>
        {
            Execute(requestContext);
        };

        return AsyncResultWrapper.BeginSynchronous(callback, state, action, _executeTag);
    }
    else
    {
        if (requestContext == null)
        {
            throw new ArgumentNullException("requestContext");
        }

        // Support Asynchronous behavior. 
        // Execute/ExecuteCore are no longer called.

        VerifyExecuteCalledOnce();
        Initialize(requestContext);
        return AsyncResultWrapper.Begin(callback, state, BeginExecuteCore, EndExecuteCore, _executeTag);
    }
} 
```

# java - 你能告诉我使用 ScheduleThreadPoolExecutor 的正确语法吗？

> ID：13166182
> 
> 赞同：0
> 
> 时间：2012-10-31T19:31:29.823
> 
> 标签：java, swing

为了这; 我希望“Continuous”按钮开始 rollthedice()，并希望“Stop”按钮停止它，但是当我再次点击“Continuous”按钮时，我希望它再次来回启动 rollthedice()

```
scheduler = new ScheduledThreadPoolExecutor(1);

ScheduledFuture now = null;

Runnable runner = new Runnable(){
    public void run()
    {
        rollthedice();
    }
};

if(e.getSource()==continuous)
{

    now = scheduler.scheduleAtFixedRate(runner, 0, 500, TimeUnit.MILLISECONDS);
}
if(e.getSource()==stop)
{

    now.cancel(true);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:39:31.253

你缺少的是这个分配给`ScheduledFuture` `now`

```
now = scheduler.scheduleAtFixedRate(runner, 0, 500,
                TimeUnit.MILLISECONDS); 
```

然后你可以打电话`now.cancel(true);`

只需移动到类级别的声明下方，即您可以移动到您的`actionPerformed`方法上方。之后它工作正常。

```
ScheduledThreadPoolExecutor scheduler = new ScheduledThreadPoolExecutor(1);
ScheduledFuture<?> now = null; 
```

# excel - 是否可以指定我想要自动递增的内容？

> ID：13166185
> 
> 赞同：1
> 
> 时间：2012-10-31T19:31:39.507
> 
> 标签：excel, auto-increment, vba

我有一个格式为“mm/dd/yyyy hh:mm:ss”的单元格。我想自动增加分钟，但是当我只选择那个单元格后手动自动增加时，它会增加*一天。*为了让它增加一分钟，我必须手动复制下面的单元格，添加一分钟，选择两者，然后增加。是否可以在 VBA 中指定当我使用

```
Selection.AutoFill 
```

功能并且只选择了一个单元格？事实上，录制宏给了我

```
Selection.AutoFill Destination:=Range("BU2:BU3"), Type:=xlFillDefault 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T19:43:34.800

在 Excel 中，日期和时间的存储方式与其他语言不同。

来自[http://www.cpearson.com/excel/datetime.htm](http://www.cpearson.com/excel/datetime.htm)

> Excel 将日期和时间存储为一个数字，表示自 1900 年 1 月 0 日以来的天数，加上 24 小时日的小数部分：ddddd.tttttt
> 
> 这称为序列日期或序列日期时间。

如果要按分钟递增，则应添加一天中等于一分钟的部分

```
Minutes in a day = 1440

1 / 1440 = 0.00069444 
```

将您的自动增量功能设置为**0.00069444**，它应该按照您的预期工作。

# spring-integration - 如何使用 Spring AMQP/Spring 集成通过程序确认消息

> ID：13166186
> 
> 赞同：4
> 
> 时间：2012-10-31T19:31:46.013
> 
> 标签：spring-integration, spring-amqp

1）服务器向客户端发送消息。

2) 入站通道适配器配置为等待来自消费者的“手动”确认模式操作

3）“TaskBundlereceiver”bean 正在实现“ChannelAwareMessageListener”，在实现方法中，我正在执行消息确认。

我没有看到“TaskBundlereceiver”被执行。我错过了什么吗？

以下是我已解释的步骤的配置详细信息。

感谢您的投入。

```
 @Override
    public void onMessage(org.springframework.amqp.core.Message message, Channel channel) throws Exception 
    {
        logger.debug("In onMessage method of the channel aware listener. message =["+message.getBody().toString()+"]");
        channel.basicAck(message.getMessageProperties().getDeliveryTag(), true);
    } 
```

XML配置：

```
 <!-- Channel that receives the task bundle from the server for execution -->
    <int:channel id="fromKServerChannel"/>

    <int-amqp:inbound-channel-adapter id="taskBundleReceiverAdapter"
                                      channel="fromKServerChannel"
                                      error-channel="taskBundleErrorChannel"
                                      acknowledge-mode="MANUAL"
                                      expose-listener-channel="true"
                                      queue-names="kanga_task_queue"
                                      connection-factory="connectionFactory"
                                      concurrent-consumers="20"/>

    <int:chain input-channel="fromKServerChannel" output-channel="nullChannel">
        <int:service-activator ref="taskBundleReceiver" method="onMessage"/>
        <int:service-activator ref="taskBundleExecutor" method="executeBundle"/>
    </int:chain> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T19:50:52.547

它不是那样工作的；侦听器是适配器，而不是通过服务激活器调用的服务。适配器目前不支持将通道传递给客户端进行手动确认。Expose-listener-channel 属性是在使用事务时使用的，因此下栈兔子模板可以参与事务。

为什么要手动确认？AUTO（默认）表示当线程正常返回时，容器会自动完成ack；如果您的服务引发异常，则消息将被取消。

所以，这就是控制ack的方法。

如果您真的想使用 MANUAL acks，则必须使用 a`<rabbit:listener-container/>`直接调用您的 taskBundleReceiver。然后它可以使用消息传递网关向执行者发送消息。

# asp.net-mvc - Web API，异步文件上传在本地工作，而不是在服务器上

> ID：13166188
> 
> 赞同：2
> 
> 时间：2012-10-31T19:31:50.293
> 
> 标签：asp.net-mvc, asp.net-web-api

使用以下教程：[http](http://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-2) ://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-2 ，我使用以下控制器作为基础我实现的文件上传调用：

```
public Task<HttpResponseMessage> PostFormData()
{
    // Check if the request contains multipart/form-data.
    if (!Request.Content.IsMimeMultipartContent())
    {
        throw new HttpResponseException(HttpStatusCode.UnsupportedMediaType);
    }

    string root = HttpContext.Current.Server.MapPath("~/App_Data");
    var provider = new MultipartFormDataStreamProvider(root);

    // Read the form data and return an async task.
    var task = Request.Content.ReadAsMultipartAsync(provider).
        ContinueWith<HttpResponseMessage>(t =>
        {
            if (t.IsFaulted || t.IsCanceled)
            {
                Request.CreateErrorResponse(HttpStatusCode.InternalServerError, t.Exception);
            }

            // A whole lotta logic to save the file, process it, etc.
        });

    return task;
} 
```

为了节省空间，我没有包含我编写的大部分逻辑，因为错误发生在 ContinueWith 的第一行，

```
 if (t.IsFaulted || t.IsCanceled) 
```

如果我从 VS2010 在本地运行它，上述两个布尔值都是错误的，并且代码运行良好 - 所有这些，甚至是我注释掉的额外几十行。当我将它部署到运行 IIS7 的服务器时，t.IsFaulted*始终*为真。我从未在 C# 中使用过异步调用，并且只在 Web API 中完成了一些简单的控制器……有什么我必须安装/配置/等的吗？在生产服务器上使其工作？

更困难的是，所有发生的异常都留在该任务中（即不会被 ELMAH 捕获），所以我不知道如何调试正在发生的事情；IIS 也没有记录事件查看器中发生的任何错误……所以我不知道到底发生了什么。关于如何使这个调试过程更容易的任何提示？

# android - 使用 MySQL 表进行手机聊天

> ID：13166192
> 
> 赞同：-1
> 
> 时间：2012-10-31T19:32:08.530
> 
> 标签：android, mysql, ios, messaging

我想知道是否有可能在这样的移动应用程序中实现聊天：

*   包含四列的表：SenderID、ReceiverID、Message、Time
*   发送时，应用程序发布到添加一行的 php 页面
*   接收器电话应用程序不断调用从表中加载的另一个 php 页面

我想知道这是否会长期有效？例如，如果我有足够大的服务器，它是否允许 100,000 人同时接收消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:04:55.617

可以像这样发送和存储您的数据，可能不是一次针对 100,000 个用户，而是针对其中许多用户。

我看到的主要问题是潜在的接收者一直在轮询服务器。这是对服务器时间和客户端电池电量的浪费。像 NickT 所说的那样使用[Google Cloud Messaging](https://developer.android.com/guide/google/gcm/index.html)会更好。

GCM 的想法是，当您的服务器收到消息时，您的服务器将消息发送给 Google，Google 找到收件人，然后 Google 将消息传递到收件人的手机。接收者手机上的应用会收到一条新消息通知。

# java - 为什么 getElementsByTagNameNS 在 java 中是空的？

> ID：13166195
> 
> 赞同：10
> 
> 时间：2012-10-31T19:32:14.207
> 
> 标签：java, xml

我想从 tag2 中获取值，我得到了一个 xml：

```
String xml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>" +
            "<ns1:schema xmlns:ns1='http://example.com'>" +
                "<ns1:tag1>" +
                "    <ns1:tag2>value</ns1:tag2>" +
                "</ns1:tag1>" +
            "</ns1:schema>"; 
```

然后将其解析为一个文档，并希望通过 tagnameNS 获取元素。但是当我运行这个时，节点列表是空的，为什么？

```
DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
        docBuilderFactory.setNamespaceAware(true);
        DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();
        Document doc = docBuilder.parse(new InputSource(new StringReader(xml))); 

        NodeList nl = doc.getElementsByTagNameNS("http://example.com", "tag2");

        String a = nl.item(0).getNodeValue(); 
```

仍然不适用于 URI。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-31T20:35:40.263

`getElementsByTagNameNS`正在返回结果。问题是您当前调用了错误的方法来从结果元素中获取文本内容。你需要打电话`getTextContext()`而不是`getNodeValue()`

```
String a = nl.item(0).getTextContent(); 
```

**DomDemo**

下面是一个完整的代码示例。

```
package forum13166195;

import java.io.StringReader;
import javax.xml.parsers.*;
import org.w3c.dom.*;
import org.xml.sax.InputSource;

public class DomDemo {

    public static void main(String[] args) throws Exception{
        String xml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>"
                   + "<ns1:schema xmlns:ns1='http://example.com'>"
                       + "<ns1:tag1>"
                           + "<ns1:tag2>value</ns1:tag2>"
                       + "</ns1:tag1>"
                   + "</ns1:schema>";

        DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
        docBuilderFactory.setNamespaceAware(true);
        DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();
        Document doc = docBuilder.parse(new InputSource(new StringReader(xml))); 

        NodeList nl = doc.getElementsByTagNameNS("http://example.com", "tag2");

        String a = nl.item(0).getTextContent();
        System.out.println(a);
    }

} 
```

**输出**

```
value 
```

* * *

**替代方法**

您还可以使用`javax.xml.xpath`API（包含在 Java SE 5 及更高版本中）从 XML 文档中查询值。这些 API 提供了比`getElementsByTagNameNS`.

**XPathDemo**

```
package forum13166195;

import java.io.StringReader;
import java.util.Iterator;
import javax.xml.namespace.NamespaceContext;
import javax.xml.xpath.*;

import org.xml.sax.InputSource;

public class XPathDemo {

    public static void main(String[] args) throws Exception{
        String xml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>"
                   + "<ns1:schema xmlns:ns1='http://example.com'>"
                       + "<ns1:tag1>"
                           + "<ns1:tag2>value</ns1:tag2>"
                       + "</ns1:tag1>"
                   + "</ns1:schema>";

        XPath xpath = XPathFactory.newInstance().newXPath();
        xpath.setNamespaceContext(new NamespaceContext() {

            public String getNamespaceURI(String arg0) {
                if("a".equals(arg0)) {
                    return "http://example.com";
                }
                return null;
            }

            public String getPrefix(String arg0) {
                return null;
            }

            public Iterator getPrefixes(String arg0) {
                return null;
            }

        });

        InputSource inputSource = new InputSource(new StringReader(xml));
        String result = (String) xpath.evaluate("/a:schema/a:tag1/a:tag2", inputSource, XPathConstants.STRING);
        System.out.println(result);
    }

} 
```

**输出**

```
value 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-11-08T01:22:13.710

```
 Try this :

  DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
  docBuilderFactory.setNamespaceAware(true);
  DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();
  Document doc = docBuilder.parse(new InputSource(new StringReader(xml)));      
  NodeList nodeList = doc.getElementsByTagNameNS("*", "tag2");
  String a = nodeList.item(0).getTextContent();
  System.out.println(a); 
```

**输出**

```
value 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T19:34:03.503

您需要传递命名空间 URL；不是您在 XML 中创建的本地别名。

# objective-c - 用户点击空格后将 UITextField 键盘从数字切换为字母

> ID：13166200
> 
> 赞同：0
> 
> 时间：2012-10-31T19:32:25.310
> 
> 标签：objective-c, uitextfield

我希望我的键盘在用户点击空格后从 UIKeyboardTypeNumbersAndPunctuation 模式更改为普通文本模式。

所以他可以很容易地输入诸如“34 loops”之类的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T19:43:18.590

好的，您无法获得直接输入通知，但我能想到一个解决方案。

实现以下委托方法：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string 
```

正如其名称所述，替换字符串将包含要替换文本字段中现有字符串的字符串。你可以做的是检查这个字符串的最后一个字符，如果它确实是一个空格，然后改变键盘类型：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    char lastCharacter = [string characterAtIndex:[string length] - 1]; //Get the last input character in the ext field.
    if(lastCharacter == ' ')
    {
        //The last character is a space, so...
        textField.keyboardType = UIKeyboardTypeDefault;
        [textField resignFirstResponder];
        [textField becomeFirstResponder];
    }
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:10:53.860

Leonneas 给出的答案大多回答了简单的情况，但需要考虑的问题很多。如果用户键入`34`，然后是空格，然后删除，会发生什么？当用户将插入符号从末尾移动`loops`到数字部分的某个位置时会发生什么？

这一切都开始变得越来越难以涵盖每个案例。但更重要的是，随着键盘开始在他们身上改变，它开始让用户感到厌烦。这使得仅输入文本变得非常困难。我从来没有见过一个应用程序按照你的建议去做，这是有充分理由的。

让用户像习惯一样使用普通键盘。每个人都知道如何在字母和数字之间切换。让键盘自动更改将是不寻常且令人困惑的。

# xml - Django：双重转义 XML 实体

> ID：13166201
> 
> 赞同：0
> 
> 时间：2012-10-31T19:32:30.947
> 
> 标签：xml, django, escaping

遇到一些极端情况：当数据中存在与号或类似符号时，我与之通信的 API 会崩溃，即使 Django 在呈现 XML 模板时正在转义数据。我从 API 所有者那里得到的响应是：

```
As weird as it sounds, I think you need to double escape it. Try: &amp;amp; 
```

明智地，Django 并没有真正让这变得容易。`|escape|escape`无论`autoescape`是打开还是关闭，尝试都不会做我想要的。我确定我可以编写一个自定义过滤器来执行此操作，但我担心这会导致其他问题。有没有一种简单的方法可以使用标准模板过滤器来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T20:47:27.170

如果应用两次，Django force_escape 过滤器应该可以工作。

# ios - 按 Home 键返回应用程序 /Cordova

> ID：13166216
> 
> 赞同：0
> 
> 时间：2012-10-31T19:33:30.880
> 
> 标签：ios, xcode, cordova, phonegap-plugins

我使用 ChildBrowser 和 cordova - 最新版本。当我在我的应用程序中打开 ChildBrowser 并按下 iPhone 的主页按钮时，应用程序正在后台运行。

当我再次单击我的应用程序时，我的最后一个操作窗口当然会出现。在这种情况下 ChildBrowser 再次出现。当然，当我使用 ChildBrowser 时，有一个网站必须对用户进行身份验证。默认情况下，出于安全考虑，用户将在一天左右后注销。

当我返回我的应用程序时，我如何首先检查用户是否在 ChildBrowser 再次出现之前仍然经过身份验证？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T00:08:26.663

对不起，这是我问题的答案。

RTFD！:)

[http://docs.phonegap.com/en/1.0.0/phonegap_events_events.md.html#resume](http://docs.phonegap.com/en/1.0.0/phonegap_events_events.md.html#resume)

# java - 让迭代器在 Java 中运行

> ID：13166218
> 
> 赞同：-1
> 
> 时间：2012-10-31T19:33:33.687
> 
> 标签：java

我有以下代码示例，我很确定第一个块应该放在 main() 中，但是我应该在哪里放置第二个块以使这个迭代器示例工作？

```
List<String> myList= new ArrayList<String> ( ); 
```

我在哪里放置这个？我需要创建第二个班级吗？

```
static void printAll(ArrayList myList)
{
    Iterator it = myList.iterator();
} 
```

然后是这个典型的迭代器模式……这与第二个代码块有什么关系吗？

```
static void printAll(ArrayList myList)
{
    Iterator it = myList.iterator();
    Object temp;
    while( it.hasNext() )
    {
        temp = it.next();
        System.out.println( temp );
    }
    return;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:37:44.623

目前尚不清楚您想要实现什么，如果您询问如何将`ArrayList`（main 中的局部变量）传递给该`printAll`方法，请执行以下操作：

```
public class XYZ {
  static void printAll(ArrayList myList)
  {
    Iterator it = myList.iterator();
    Object temp;
    while(it.hasNext() )
    {
      temp = it.next();
      System.out.println( temp );
    }
    return;
  }

  public static void main(String...args){

    List<String> myList= new ArrayList<String> ( );
    myList.add("Hello");
    myList.add("World");
    printAll(myList);//passing myList to printAll
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T19:51:00.873

您尝试使用交互器是否有原因？

[假设您使用的是Java 5](http://www.cs.indiana.edu/classes/jett/sstamm/#_forin)，您可以这样做。

```
List<String> myList= new ArrayList<String> ( );
// set up list... etc.

for(String currentString : myList) {
 System.out.println(currentString);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T19:57:53.570

迭代器仅在您需要在遍历集合时删除某些元素（使用`Iterator.remove()`方法）时才有用。否则，只需使用 for-each 循环。

# mysql - 具有多个类的 RowMapper

> ID：13166220
> 
> 赞同：1
> 
> 时间：2012-10-31T19:33:36.593
> 
> 标签：mysql, spring-mvc, jdbctemplate, spring-data

我定义了两个服务：

```
Class cars
 model, year, mileage

Class driver
 name, age, licExpDate 
```

我已经在他们自己的服务中对每个查询进行了查询，即与汽车相关的`car`查询和与司机相关的查询`driver`。此外，我`RowMapper`在每项服务中都有

```
class CarRowMapper implements RowMapper<Car>{
    @Override
    public Car mapRow(ResultSet rs, int rowNum) throws SQLException {
        Car car = new Car();
                car.setModel(rs.getString("model"));
        return car;
    }       
} 
```

**问题** 现在我需要导出一些数据，我需要为此编写一个查询，该查询将涉及两个`car`和`driver`一个查询中的列：

例如：

```
SELECT A.CAR B.NAME FROM CAR A, DRIVER B WHERE A.ID = B.ID 
```

所以，现在我如何在我的 RowMapper 中有多个类，以便我可以编写这样的方法：

```
public List<Cars> carsWithDrivers() {
  String query "...";
  return service.getJdbcTemplate().query(query, Row_mapper_here?));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-09T11:29:01.773

假设您将要使用的实现 RowMapper 的类是 MapCarWithDriver。现在在其中，将覆盖一个 mapRow(ResultSet, int rowNum) 方法。这将为执行查询的结果集的每一行调用。因此，现在您可以通过以下方式创建自己的 Driver 对象

`Driver driver1 = new Driver();`
`driver1.setName(rset.getString("NAME");`
`Car car1= new Car(driver1);`
`car1.setModel(rset.getString("CAR");`

# jquery - 改变 边打字边生活

> ID：13166225
> 
> 赞同：1
> 
> 时间：2012-10-31T19:34:00.677
> 
> 标签：jquery, html, font-face

我正在在线创建一个字体测试器。我需要人们在文本输入中键入并以所需字体获取他们的文本，我正在使用字体进行更改。我将使用 addClass() 更改字体。

**HTML**

```
<p id="viewer"></p>
<input type="text" name="texto" id="texto" value="123" />​ 
```

**jQuery**

```
$('.texto').change( function(){    
    var str = $('.texto').val();
    $("p").text(str);
});​ 
```

这是[jsFiddle](http://jsfiddle.net/coffee3k/VeGCy/1/)

另外，有什么东西可以保护字体不被下载吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T19:37:30.203

更改`$('.texto')`为`$('#texto')`

**完整代码：**

```
$('#texto').change( function(){    
    var str = $(this).val();
    $("#viewer").text(str);
}); 
```

**演示：http:** [//jsfiddle.net/VeGCy/3/](http://jsfiddle.net/VeGCy/3/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T19:38:59.610

> 另外，有什么东西可以保护字体不被下载吗？

不幸的是，没有。一种解决方法是使用诸如 Cufon 或 Sifr 之类的东西来通过 Flash 转换您的文本。

如果您担心许可问题，您也可能对[www.google.com/webfonts感兴趣。](http://www.google.com/webfonts)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T19:41:05.050

您需要使用`#`而不是`.`. `#`是 id 选择器。`.`是类选择器。

您也可以考虑使用`keydown()`而不是`change()`这样文本将实时更新，而不仅仅是当他们点击远离`input`.

[http://jsfiddle.net/VeGCy/9/](http://jsfiddle.net/VeGCy/9/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-01T16:27:40.453

我注意到我`#viewer`在使用`keydown`. 我通过使用该`keyup`方法解决了这个问题

**完整代码：**

```
$('#texto').keyup(function(){
  var str = $(this).val();
  $("p").text(str);
}); 
```

**演示：http:** [//jsfiddle.net/VeGCy/9/](http://jsfiddle.net/VeGCy/9/)

# javascript - JavaScript - 获取列表选项的长度

> ID：13166229
> 
> 赞同：13
> 
> 时间：2012-10-31T19:34:17.510
> 
> 标签：javascript, html, drop-down-menu

有没有办法在选择下拉 HTML 输入标记中获取列表选项的长度？列表动态变化，我需要计算下拉列表中的选项总数。总选项是动态生成的，所以我需要一种方法来计算 html 选择标签中的选项标签数量。我还需要在纯 JS 中执行此操作，因为我正在使用的应用程序不允许我使用 JQuery。（请不要与我争论，除非在纯 JS 中绝对没有办法做到这一点。）

只需与 Internet Explorer 兼容。

我认为这与访问 DOM 有关，但我不确定语法将如何发挥作用。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-10-31T19:36:49.553

由于您没有指定可以使用 jQuery，请尝试以下操作：

**HTML：**

```
<select id="test">
  <option>1</option>
  <option>2</option>
  <option>3</option>
  <option>4</option>
</select>​ 
```

**JavaScript：**

`​document.getElementById("test").options.length`

**[例子](http://jsfiddle.net/wYJ3K/)**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T19:36:07.947

从选择输入中选择选项，然后用长度计算它们

```
$("#input1 option").length 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-30T09:40:19.807

我使用 JQuery 做到了这一点

```
$(document).ready(function() {
    $("button").click(function(){
      var optionLength = $("#user option").length;

           alert("length of options is : "+optionLength);
    });
});
```

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Get length of list Options</title>
</head>
  <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>

<body>
<select id="user" multiple="" size="5" class="form-control" id="participants" name="participants" style="height: 98px !important;">
  <option value="1">S RAJ</option>
  <option value="2"> SHARMA</option>
  <option value="3">SINGH</option>
  <option value="4"> ROY</option>
  <option value="5">VERMA</option>
  <select>
    <button type="button">Get Users</button>
</body>
</html>
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-11T10:08:48.480

```
<select id="lister-sort-by-options" name="sort" class="lister-sort-by">
    <option value="0" selected="selected">
      Movies
    </option>
    <option value="1">
      TV Shows
    </option>
    <option value="2">
      Morning Shows
    </option>
    <option value="3">
      Moonlight
    </option>
    <option value="4">
      Music
    </option>
</select> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-22T11:17:42.983

试试[这个](https://www.w3schools.com/jsref/prop_select_length.asp)：

在 HTML 文件中：

```
<select id="mySelect">
  <option>Apple</option>
  <option>Pear</option>
  <option>Banana</option>
  <option>Orange</option>
</select> 
```

在 JavaScript 文件中：

```
document.getElementById("mySelect").length; 
```

# iphone - iOS 6 上的 RemoteIO 和录制 AAC

> ID：13166230
> 
> 赞同：2
> 
> 时间：2012-10-31T19:34:19.233
> 
> 标签：iphone, ios6, core-audio, audio-recording, remoteio

有人使用 RemoteIO 在 iOS 6 上录制 AAC 音频吗？我注意到，当我这样做时，它会在中断时终止媒体服务器，并且我的中断回调永远不会在 iOS 6.0 上调用。

此外，由于媒体服务器出现故障，因此恢复起来有点困难。

有其他人看到这个或解决它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T18:42:47.320

问题解决了。使用软件编解码器：

```
// specify codec
UInt32 codec    = kAppleSoftwareAudioCodecManufacturer;
int codecSize   = sizeof(codec);
status          = ExtAudioFileSetProperty(recorderState.audioFile,
                                          kExtAudioFileProperty_CodecManufacturer,
                                          codecSize,
                                          &codec); 
```

在我使用 kAppleHardwareAudioCodecManufacturer 之前......显然硬件编解码器无法处理中断。希望其他人觉得这很有用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T07:55:57.800

我有个类似的问题。我正在尝试使用 remoteio 录制 AAC 音频，原因与您在此处描述的几乎相同：

[http://lists.apple.com/archives/coreaudio-api/2012/Oct/msg00135.html](http://lists.apple.com/archives/coreaudio-api/2012/Oct/msg00135.html)

我目前的问题甚至不是中断。如果我处置了我的音频单元并将我的音频会话设置为在移动到后台时处于非活动状态，当我在应用程序重新加载时尝试重新激活我的会话时，媒体服务器仍然会被杀死。

我即将死去的基本流程是： - 设置一个活动的音频会话进行录制 - 设置音频单元和文件以准备用户按下“录制”按钮 - 用户后台应用程序，以拆除我的所有内容处置我的音频单元并停用我的会话，但此时我没有清理我的 extaudiofile - 我打开语音备忘录，然后立即关闭它 - 重新打开我的应用程序并点击记录。- 当我尝试将会话设置为活动时，mediaserverd 死了。切换到软件编解码器并没有解决它！

If you have learned any more about this craziness I would love to hear what you figured out.

Thanks.

# java - 从 TypeReference 转换 上课 没有强制转换（Java）

> ID：13166233
> 
> 赞同：5
> 
> 时间：2012-10-31T19:34:35.980
> 
> 标签：java, generics, casting, jackson

我想在 Java 中从一个`TypeReference<E>`对象转到一个对象，*而不*使用强制转换。由于我的代码使用**Jackson**的方式，我需要使用对象，并且我需要对象，因为我想使用它来将类型推断到我的应用程序中的其他泛型类之一中。`Class<E>`*`TypeReference`**`Class`***

 ***我知道这`TypeReference.getType()`将返回一个[java.lang.reflect.Type](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Type.html)对象。基本上，如果我能找到一种无需强制转换即可使用代码的方法 from `Type`to `Class`，那么我就找到了我的问题。

**Javadoc 参考资料：**

*   [http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html)
*   [http://jackson.codehaus.org/1.9.4/javadoc/org/codehaus/jackson/type/TypeReference.html](http://jackson.codehaus.org/1.9.4/javadoc/org/codehaus/jackson/type/TypeReference.html)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-01T00:03:44.980

你不能转换它：这是一个非常基本的 Java 问题——TypeReference 和 Class 不是从同一个基类派生的，所以它违反了语言定义。

但是，如果我猜对了您想要实现的目标，您可以使用以下方法转换原始（类型擦除）类`JavaType`：

```
JavaType type = mapper.getTypeFactory().constructType(ref);
Class<?> cls = type.getRawClass(); 
```

您可以`JavaType`使用`TypeReference`、`Class`甚至只是基本的 JDK来构建`Type`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T21:04:29.793

如果没有铸造，我看不到任何解决方案。但是，这是一种具有通用转换的解决方案。也许这也有帮助：

```
public class Converter {
    public static <T> Class<T> convert(TypeReference<T> ref) {
        return (Class<T>)((ParameterizedType) ref.getType()).getRawType();
    }
} 
```

然而，这是一种框架方法。签名是完全类型保存的，它转换为一个包含所有“超级类型令牌”信息的类，Neal Gafter 在他的[博客条目](http://gafter.blogspot.de/2006/12/super-type-tokens.html)中提到，它传递了 TypeReference 的想法。这样可以使您的业务代码保持干净并输入保存。

然后用法会（在这里你看不到演员表......;-）：

```
Class<List<String>> typ = Converter.convert(new TypeReference<List<String>>() {});
System.out.println(typ); 
```

带输出（当然，即使代码显示字符串，实例也会被擦除...）：

```
interface java.util.List 
```***

# c# - C# RegistryKey.GetValue 不返回空行

> ID：13166234
> 
> 赞同：0
> 
> 时间：2012-10-31T19:34:41.930
> 
> 标签：c#, winapi, registry

所以我正在编写一些代码并使用`RegistryKey.GetValue`，我似乎无法让它返回正确的字符串数组。我会使用 RegSaveKeyEx，除非我需要在我正在创建的 reg 文件中更改密钥的保存位置。

我正在查询的 MultiString 有两行`:`和一个空行。Regedit 为`hex(7):3a,00,00,00,00,00`所述值的 reg 文件导出提供。这是对的。3a 将是`:`，然后是一个空值，两个空值用于空行，最后两个空值表示值的结束。我的代码是给`hex(7):3a,00,00,00`，这将是`:`多字符串上的 a 和双空 EOL 字符。当导入回注册表时`hex(7):3a,00,00,00`只有一个`:`，空行丢失。

如果我导入`hex(7):3a,00,00,00,00,00`然后在 regedit 中查看值，我会看到`:`一个空行。这是正确的，这就是我希望我的代码执行的操作。

当我`RegistryKey.GetValue`在 C# 4.0 中查询这个值时，我得到的 a`string[]`只有一个元素，`:`.

对于其他 MultiString 值，我得到一个包含每一行元素的数组，正如我所期望的那样。

`RegistryKey.GetValue`不会为空行返回任何内容。它不返回空值，数组中的空白字符串，什么都没有。

在除空行之外的所有内容上，它都返回与 regedit 导出完全相同的结果。需要改变什么让它返回一个包含空行的数组？

如果有帮助，这是我的代码：

```
private static string RegMultiStringExtraction(RegistryKey UsersSubKey, string Key)
    {
        string[] InputStrs = (string[])UsersSubKey.GetValue(Key, Environment.NewLine, RegistryValueOptions.DoNotExpandEnvironmentNames);
        StringBuilder sb = new StringBuilder();
        foreach (string str in InputStrs)
        {
            char[] Values = str.ToCharArray();
            foreach (char letter in Values)
            {
                int ValueInt = Convert.ToInt32(letter);
                sb.Append(ValueInt.ToString("x"));
                sb.Append(",00,");
                if (Values.Length == 0)
                {
                    if (sb.Length == 0)
                    {
                        sb.Append("00,");
                    }
                    else if (sb.Length > 1)
                    {
                        sb.Append(",00,");
                    }
                }
            }
            sb.Append("00,00,");
        }

        string Value = ('"' + Key.ToString() + @"""=" + "hex(7):" + sb.ToString().TrimEnd(','));
        return Value;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T19:49:50.497

双空终止字符串不能包含空行。尝试包含空行意味着包含两个连续的空值，这被解释为终止而不是空行。Raymond Chen比我更雄辩地[讨论了这个怪癖。](http://blogs.msdn.com/b/oldnewthing/archive/2009/10/08/9904646.aspx)

也许您可以保存`REG_SZ`并`Environment.NewLine`用作分隔符。

# ruby-on-rails-3 - 使用 Minitest+Guard+Spork，每次运行都会重新加载所有测试套件和支持文件

> ID：13166238
> 
> 赞同：5
> 
> 时间：2012-10-31T19:35:12.720
> 
> 标签：ruby-on-rails-3, guard, spork, minitest

我遇到了一个问题，我的测试设置中的所有内容，包括 Spork 的 prefork 块，在每次运行时都被重新加载和调用。即使这是一个新项目，即使这是一个新项目，测试也需要 5-8 秒才能启动，即使这是一个新项目，我什至还有 SSD。

在我意识到一切都在重新加载之前，我使用 Jo Liss[在这里](http://www.opinionatedprogrammer.com/2011/02/profiling-spork-for-faster-start-up-time/)描述的技术对其进行了概要分析，并且我已经包括了那些悬挂要求，但显然这并没有帮助，因为无论如何它都在重新加载。然而，就在那时我注意到了这一点：

> 加载套件测试，测试/控制器，测试/控制器/管理，测试/工厂，测试/功能/管理，测试/助手，测试/助手/管理，测试/集成，测试/模型，测试/支持

我不明白为什么它会重新加载所有内容。这是我第一次尝试设置 minitest+spork+guard（我应该刚刚使用 rspec，叹息）所以我希望这是愚蠢的。我将所有内容都包括在内，希望有人遇到过它或可以轻松发现我错过的内容。提前致谢！

我的文件包括：

> **test_helper.rb**

```
require 'spork'
Spork.prefork do
  #MiniTest::Rails.override_testunit!
  ENV["RAILS_ENV"] = "test"
  require File.expand_path('../../config/environment', __FILE__)
  require 'guard'
  require 'guard/interactors/readline'
  require 'guard/ui'
  require 'guard/interactors/coolline'
  require 'guard/interactor'
  require 'guard/dsl'
  require 'guard/notifiers/rb_notifu'
  require 'guard/notifier'
  require 'guard/minitest/notifier'
  require 'guard/minitest/runners/default_runner'
  Dir[File.expand_path('test/support/*.rb')].each { |file| require file }
  require "mocha"
  Spork.trap_method(Rails::Application, :reload_routes!)
  Spork.trap_method(Rails::Application::RoutesReloader, :reload!)
end 
```

> **保护文件**

```
guard 'bundler' do
  watch('Gemfile')
  # Uncomment next line if Gemfile contain `gemspec' command
  # watch(/^.+\.gemspec/)
end
guard 'spork', :wait => 65, :test_unit => false, :minitest => true, :minitest_env => { 'RAILS_ENV' => 'test' }, :bundler => true do
  watch('config/application.rb')
  watch('config/environment.rb')
  watch(%r{^config/environments/.+\.rb$})
  watch(%r{^config/initializers/.+\.rb$})
  watch('Gemfile')
  watch('Gemfile.lock')
  watch('test/test_helper.rb') { "test" }
end

guard 'minitest' do
  watch(%r|^test/test_helper\.rb|)         { "test" }
  watch(%r|^test/support/(.*)\.rb|)         { "test" }
  watch(%r{^test/.+_test\.rb$})
  watch(%r|^app/models/(.*)\.rb|)          {|m| ["test/models/#{m[1]}_test.rb", "test/integration/#{m[1]}_test.rb"] }
  watch(%r|^app/controllers/(.*)\.rb|)     {|m| ["test/controllers/#{m[1]}_test.rb", "test/integration/#{m[1]}_test.rb"] }
  watch(%r|^app/views/(.*)\.html|)         {|m| "test/integration/#{m[1]}_test.rb" }
  watch(%r|^app/objects/(.*)\.rb|)         {|m| "test/objects/#{m[1]}_object_test.rb" }
end

guard 'livereload' do
  watch(%r{app/.+\.(erb|haml)})
  watch(%r{app/helpers/.+\.rb})
  watch(%r{(public/|app/assets).+\.(css|js|html)})
  watch(%r{(app/assets/.+\.css)\.scss}) { |m| m[1] }
  watch(%r{(app/assets/.+\.js)\.coffee}) { |m| m[1] }
  watch(%r{config/locales/.+\.yml})
end 
```

> **支持/minitest.rb**

```
#require "minitest/autorun"
require "minitest/rails"
require "minitest/spec"
require "minitest/pride"
require "minitest/rails/shoulda"
require "minitest/autorun"
require "capybara/rails"

class RequestSpec < MiniTest::Spec
  include Rails.application.routes.url_helpers
  include Capybara::DSL
  include Rails.application.routes.url_helpers
end

MiniTest::Spec.register_spec_type /integration$/i, RequestSpec
#MiniTest::Spec.register_spec_type /object$/, MiniTest::Spec

class MiniTest::Rails::Controller
  include Devise::TestHelpers
end 
```

> **支持/转.rb**

```
require 'turn'
require 'turn/autorun'
require 'turn/colorize'
require 'turn/reporter'
require 'turn/reporters/pretty_reporter'
Turn.config do |c|
  c.natural = true
  c.ansi = true
  c.format = :pretty
end 
```

> **宝石文件**

```
source 'https://rubygems.org'

# core
gem 'rails', '3.2.8'
gem 'thin'

# infrastructure
gem 'heroku'
gem 'foreman', :groups => [:development, :test]

# application monitoring
gem 'airbrake'
gem 'newrelic_rpm'

# view engine
gem 'haml', '>= 3.1.7'
gem 'haml-rails', '>= 0.3.5'
gem 'redcarpet' # markdown

# data persistence
gem 'mongoid', '>= 3.0.5'
gem 'redis'
gem 'redis-store'
gem 'redis-rails'

# email
gem 'sendgrid'
gem 'mailcatcher', :group => [:development]

# authentication and authorization
gem 'devise', '>= 2.1.2'
gem 'omniauth', '>= 1.0'
#gem 'authority'
gem 'cancan'
gem 'rolify', '>= 3.2.0'

# view helpers
gem 'bootstrap-generators', '~> 2.1', :group => [:development]
gem 'jquery-rails'
gem 'simple_form', '>= 2.0.2'
gem 'rails3-jquery-autocomplete'

# file attachments
gem 'rmagick'
gem 'fog'
gem 'carrierwave'
gem 'carrierwave-mongoid', :require => 'carrierwave/mongoid'

# url helpers
gem 'mongoid_slug'

# console tools
gem 'ansi',             :groups => [:development, :test]
gem 'rack-livereload',  :groups => [:development]
gem 'pry-rails',        :groups => [:development]
gem 'growl',            :groups => [:development, :test]
gem 'turn',             :groups => [:test]
gem 'awesome_print'
gem 'progress_bar',     :groups => [:test]

# supporting libraries
gem 'bson_ext'
gem 'nokogiri',                  :group => :test
gem 'ruby_parser', '>= 2.3.1',   :group => :test
gem 'rb-fsevent', '~> 0.9.1',    :group => :development

# assets
gem 'less-rails',                 :group => :assets
gem 'therubyracer', '>= 0.10.2',  :group => :assets
gem 'uglifier', '>= 1.0.3',       :group => :assets

# guard
gem 'guard',                     :group => :development
gem 'guard-livereload',          :group => :development
gem 'guard-spork',               :group => :development
gem 'guard-minitest',            :group => :development
gem 'guard-bundler',             :group => :development

# minitest
gem 'spork-minitest',           :group => :test
gem 'minitest-rails',           :group => :test
gem 'minitest-rails-shoulda',   :group => :test,  :git => 'git://github.com/rawongithub/minitest-rails-shoulda.git' 
gem 'capybara_minitest_spec',   :group => :test

# mocking
gem 'mocha', :group => :test

# http testing
gem 'vcr',      :group => :test
gem 'webmock',  :group => :test

# factories
gem 'factory_girl_rails' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T20:34:59.920

看来，Spork 和 Minitest 实际上并没有按预期工作。为了解决这个问题，必须进行以下更改：

在 Guardfile 内部，`:drb => true`必须将其添加到 minitest：

```
guard 'minitest', :drb => true do
  #...
end 
```

但是，仅此一项就会破坏guard/minitest/spork，因为它试图强制为其`-r -e`提供当前不支持的选项。您将遇到以下错误：

```
Running: test/models/business_test.rb
Running tests with args ["-r", "/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/guard-minitest-0.5.0/lib/guard/minitest/runners/default_runner.rb", "-e", "::GUARD_NOTIFY=true", "test/test_helper.rb", "./test/models/business_test.rb"]...
Exception encountered: #<LoadError: cannot load such file -- -r>
backtrace:
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in require'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/spork-minitest-0.0.3/lib/spork/test_framework/minitest.rb:13:in `block in run_tests'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/spork-minitest-0.0.3/lib/spork/test_framework/minitest.rb:12:in `each'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/spork-minitest-0.0.3/lib/spork/test_framework/minitest.rb:12:in `run_tests'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/spork-0.9.2/lib/spork/run_strategy/forking.rb:13:in `block in run'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/spork-0.9.2/lib/spork/forker.rb:21:in `block in initialize'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/spork-0.9.2/lib/spork/forker.rb:18:in `fork'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/spork-0.9.2/lib/spork/forker.rb:18:in `initialize'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/spork-0.9.2/lib/spork/run_strategy/forking.rb:9:in `new'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/spork-0.9.2/lib/spork/run_strategy/forking.rb:9:in `run'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/spork-0.9.2/lib/spork/server.rb:48:in `run'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/1.9.1/drb/drb.rb:1548:in `perform_without_block'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/1.9.1/drb/drb.rb:1508:in `perform'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/1.9.1/drb/drb.rb:1586:in `block (2 levels) in main_loop'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/1.9.1/drb/drb.rb:1582:in `loop'
/Users/chance/.rbenv/versions/1.9.3-p125/lib/ruby/1.9.1/drb/drb.rb:1582:in `block in main_loop'
Done. 
```

幸运的是，有一个[spork-minitest 的 pull request 可以修复它](https://github.com/semaperepelitsa/spork-minitest/pull/5)。

一旦 gem 被指向 repo，加载时间就大大缩短了。它的速度远不及 node.js 和 mocha，但至少比 rspec 快。

# objective-c - 带有包含 NSManagedObjectID 的 NSPredicate 的 NSFetchRequest 是否可以安全地跨线程边界传递？

> ID：13166240
> 
> 赞同：2
> 
> 时间：2012-10-31T19:35:18.747
> 
> 标签：objective-c, ios, multithreading, core-data

如果我`NSFetchRequest`像这样在主线程上创建了一个：

```
NSManagedObject *bar = ...;
NSFetchRequest *fetchRequest = [NSFetchRequest fetchRequestWithEntityName:@"Foo"];
[fetchRequest setPredicate:[NSPredicate predicateWithFormat:@"SELF.bar == %@",
                            [bar objectID]]]; 
```

将包含 a的 a 传递给这样`NSFetchRequest`的后台线程是否安全？`NSPredicate``NSManagedObjectID`

```
NSManagedObject *bar = nil;
NSFetchRequest *fetchRequest = [NSFetchRequest fetchRequestWithEntityName:@"Foo"];
[fetchRequest setPredicate:[NSPredicate predicateWithFormat:@"SELF.bar == %@",
                            [bar objectID]]];

NSPersistentStoreCoordinator *persistentStoreCoordinator = ...;
[[NSBlockOperation blockOperationWithBlock:^{
    NSManagedObjectContext *managedObjectContext = [NSManagedObjectContext new];
    [managedObjectContext setPersistentStoreCoordinator:persistentStoreCoordinator];
    NSArray *foos = [managedObjectContext executeFetchRequest:fetchRequest
                                                        error:NULL];
}] start]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:35:18.747

[我在iOS 5](http://developer.apple.com/library/mac/#releasenotes/DataManagement/RN-CoreData/_index.html#//apple_ref/doc/uid/TP40010637-CH1-DontLinkElementID_1)的 CoreData 发行说明中找到了一些示例代码，几乎可以做到这一点，所以看起来还不错。

```
NSFetchRequest *fr = [NSFetchRequest fetchRequestWithEntityName:@"Entity"];
__block NSUInteger rCount = 0;

[context performBlockAndWait:^() {
    NSError *error;
    rCount = [context countForFetchRequest:fr error:&error];
    if (rCount == NSNotFound) {
        // Handle the error.
    }
}];

NSLog(@"Retrieved %d items", (int)rCount); 
```

# c# - 使用鼠标滚轮 XNA 制作图像比例

> ID：13166244
> 
> 赞同：2
> 
> 时间：2012-10-31T19:35:34.543
> 
> 标签：c#, .net, xna, xna-4.0

如果相应地向上或向下滚动鼠标滚轮，我有一个图像我想增加或减小大小。如果图像达到设定的最大尺寸，它不会变大，反之亦然，如果使图像变小。我遇到的问题是，一旦您达到图像的最大尺寸并继续向上滚动然后向下滚动，图像不会立即变小，直到您向下滚动与向上滚动相同的次数，同时将图像置于最大尺寸并再次反转以使图像更小。ScrollWheelValue 是只读属性，因此无法重置。我试图添加一些逻辑，如果滚轮向上滚动并且图像的最大尺寸减去 120，因为 120 是鼠标每次滚动增加的值。谁能帮我解决这个问题？非常感谢

原始代码：

```
 float scale = ms.ScrollWheelValue / 120;

        scaleFactor = scale * scaleChange;

        if (scaleFactor > MAX_SCALE)
        {
            scaleFactor = MAX_SCALE;

        }

        else if (scaleFactor < MIN_SCALE)
        {
            scaleFactor = MIN_SCALE;

        } 
```

新代码：

```
 if (scaleFactor > MAX_SCALE)
        {
            scaleFactor = MAX_SCALE;
            float newScale = ms.ScrollWheelValue / 120;
            if (newScale > scale)
            {
                scaleCount = scaleCount - 120;
            }
            if (newScale < scale)
            {
                scaleCount = scaleCount + 120;
            }

        }

        else if (scaleFactor < MIN_SCALE)
        {
            scaleFactor = MIN_SCALE;
            float newScale = ms.ScrollWheelValue / 120;
            if (newScale > scale)
            {
                scaleCount = scaleCount - 120;
            }
            if (newScale < scale)
            {
                scaleCount = scaleCount + 120;
            }

        }

        else
        {
            scale = ms.ScrollWheelValue / 120 + scaleCount;

            scaleFactor = scale * scaleChange;
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T19:55:29.940

如果您阅读： [MSDN MouseState 滚轮值](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.input.mousestate.scrollwheelvalue.aspx)

你会看到它从游戏开始就保持一个运行值。所以你想要做的是检查它与先前值的变化并做相应的事情。

你是如何设置它的，你似乎并不关心实际值，只关心自他们上次滚动滚轮以来的差异。

在更新循环之外声明这些：

```
float prevWheelValue;
float currWheelValue; 
```

然后在您的更新中：

```
prevWheelValue = currWheelValue;
currWheelValue = ms.ScrollWheelValue; 
```

现在您的检查可以简单地是如果 prevWheelValue > < 或 == 到 currWheelValue 并将值限制在您想要的边界。

[数学助手.Clamp](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.mathhelper.clamp.aspx)

# django - lighttpd + mod_fastcgi + django

> ID：13166251
> 
> 赞同：1
> 
> 时间：2012-10-31T19:36:17.417
> 
> 标签：django, fastcgi, lighttpd, mod-fastcgi

我无法将我的 django 应用程序部署到使用 lighttpd 的服务器（我是 root 用户。）

这是我的`lighttpd.conf`：

```
server.modules = (
#       "mod_access",                                                                                                                                                                
#       "mod_alias",                                                                                                                                                                 
#               "mod_compress",                                                                                                                                                      
#       "mod_redirect",                                                                                                                                                              
        "mod_status",
        #"mod_rewrite",                                                                                                                                                              
        #       "mod_fastcgi",                                                                                                                                                       
#       "mod_accesslog",                                                                                                                                                             
)

status.status-url          = "/server-status"
status.config-url          = "/server-config"

$HTTP["host"] == "myurl.com" {
server.document-root = "/var/www/myurl"
server.errorlog = "/var/log/lighttpd/myurl/error.log"
accesslog.filename = "var/log/lighttpd/nixcraft/access.log"
server.error-handler-404 = "/e404.html"

fastcgi.server = (
    "/myurl/nonorientable.fcgi" => (
        "main" => (
            # Use host / port instead of socket for TCP fastcgi                                                                                                                      
            # "host" => "127.0.0.1",                                                                                                                                                 
            # "port" => 3033,                                                                                                                                                        
            "socket" => "/tmp/myurl.sock",
            "check-local" => "disable",
        )
    ),
)
}

server.pid-file             = "/var/run/lighttpd.pid"
server.username             = "www-data"
server.groupname            = "www-data"

index-file.names            = ( "index.php", "index.html",
                                "index.htm", "default.htm")

url.access-deny             = ( "~", ".inc" )

static-file.exclude-extensions = ( ".php", ".pl", ".fcgi" )

## Use ipv6 if available                                                                                                                                                             
#include_shell "/usr/share/lighttpd/use-ipv6.pl"                                                                                                                                     

dir-listing.encoding        = "utf-8"
server.dir-listing          = "enable"

compress.cache-dir          = "/var/cache/lighttpd/compress/"
compress.filetype           = ( "application/x-javascript", "text/css", "text/html", "text/plain" )

include_shell "/usr/share/lighttpd/create-mime.assign.pl"
include_shell "/usr/share/lighttpd/include-conf-enabled.pl"

server.modules += ( "mod_auth" )
auth.debug = 2
auth.backend = "plain"
auth.backend.plain.userfile = "/etc/lighttpd/.lighttpdpassword"

auth.require = ( "/" =>
("method" => "basic",
 "realm" => "",
 "require" => "user=john")) 
```

然后我在我的服务器上运行它（从文件夹`/var/www/myurl`）： `sudo python manage.py runfcgi daemonize=false socket=/tmp/myurl.sock maxrequests=1`

此时，当我尝试加载 myurl.com 时，我得到的只是目录列表：我的 django 应用程序未执行。我认为问题在于`mod_fastcgi`我的 conf 中有注释，它实际上出现在 myurl.com/server-config 上。如果我取消注释，lighttpd 会抱怨我试图加载同一个模块两次并退出，所以我的猜测是它是默认导入的。

我在 ubuntu 12.04 上使用 django1.4（最新稳定版）和 lighttpd 1.4.28，但我非常卡住。我遵循了官方文档（https://docs.djangoproject.com/en/1.4/howto/deployment/fastcgi/）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:32:13.077

看起来您缺少文档中给出的重写指令：

```
url.rewrite-once = (
    "^(/media.*)$" => "$1",
    "^/favicon\.ico$" => "/media/favicon.ico",
    "^(/.*)$" => "/mysite.fcgi$1",
) 
```

更新：您需要将`fastcgi.server`部分从更改为`/myurl/nonorientable.fcgi`以`/mysite.fcgi`使其与上面的重写相匹配。

# c - 为 ARM 编译时出现 GCC 错误

> ID：13166252
> 
> 赞同：3
> 
> 时间：2012-10-31T19:36:30.060
> 
> 标签：c, gcc, linker, embedded, arm

尝试使用为 ARM Cortex-M4 编译一些代码时出现以下错误

```
gcc -mcpu=cortex-m4 arm.c  

`-mcpu=' is deprecated. Use `-mtune=' or '-march=' instead.
arm.c:1: error: bad value (cortex-m4) for -mtune= switch 
```

我在关注[GCC 4.7.1 ARM options](http://gcc.gnu.org/onlinedocs/gcc-4.7.1/gcc/ARM-Options.html)。不确定我是否遗漏了一些关键选项。任何将 GCC 用于 ARM 的启动程序也将非常有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-01T08:43:38.947

正如starblue 在评论中暗示的那样，该错误是因为您使用的是为编译 x86 CPU 而构建的本机编译器，而不是用于编译到 ARM 的交叉编译器。

GCC 在任何给定的编译器二进制文件中仅支持单一通用架构类型——因此，尽管 GCC 的同一个副本可以为 32 位和 64 位 x86 机器编译，但您不能同时编译到 x86 和 ARM GCC 的副本——你需要一个 ARM 特定的 GCC。

（正如 auselen 建议的那样，即使您只是将它用作设置的起点，获得一个预建的也可以为您节省大量工作。您需要拥有 GCC、binutils 和一个 C 库至少，这些都是独立的开源项目，预建版本已经完成了组合工作。我会推荐[Sourcery CodeBench Lite](https://sourcery.mentor.com/sgpp/lite/arm/portal/subscription3053)，因为这是我公司生产的，我认为这是一个相当不错的项目.)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-14T18:20:05.337

就像其他人已经指出的那样，您正在为您的主机使用编译器，并且您需要一个编译器来为您的目标处理器生成代码（交叉编译器）。就像@Brooks 建议的那样，您可以使用预先构建的工具链，但如果您想推出自己的交叉编译器、libc 和 binutils，有一个不错的工具叫做[Crosstool-NG](http://crosstool-ng.org/). 它极大地简化了构建一个为特定处理器生成代码而优化的交叉编译器的过程，因此您不会被一个通用的预构建工具链所束缚，它通常为一系列兼容的处理器构建代码（例如，您可以调整工具链以适应为您的特定目标生成 ASM，或为特定于您的处理器的硬件 FPU 生成浮点代码，而不是仅使用大多数预构建工具链默认的软件浮点例程）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T18:49:56.463

正如错误消息所说， -mcpu 已弃用，您应该使用所述的其他选项。然而，“*弃用*”仅仅意味着它的使用可能不会继续得到支持；它仍然可以工作。

ARM Cortex-M4 是 ARM Architecture V7E-M，所以你应该使用`-march=armv7-m`（文档没有具体列出`armv7e-m`，但自文档上次更新以来可能已经添加。`E`本质上是 M3 和 M4 之间的区别 - DSP 指令，因此编译器不会生成利用这些指令的代码。使用 ARM 的 Cortex-M DSP 库可能是使用这些指令来使您的应用程序受益的最佳方式。如果您的部件具有 FPU，则需要其他选项来启用代码一代。

# c# - MVC3 DropDownList - 修改在 SelectedIndexChanged 上的表单中显示的数据？

> ID：13166253
> 
> 赞同：0
> 
> 时间：2012-10-31T19:36:46.380
> 
> 标签：c#, jquery, asp.net-mvc, asp.net-mvc-3

我的模型中有两个 DropDownList 元素。

```
[DisplayName("Site")]
public List<KeyValuePair<int, string>> Site { get; set; }
public int SelectedSiteID { get; set; }
<%= Html.DropDownListFor(model => model.SelectedSiteID, new SelectList(Model.Site, "Key", "Value"))%>

[DisplayName("Data Center")]
public List<KeyValuePair<int, string>> DataCenter { get; set; }
public int SelectedDataCenterID { get; set; }
<%= Html.DropDownListFor(model => model.SelectedDataCenterID, new SelectList(Model.DataCenter, "Key", "Value"))%> 
```

当用户对第一个选择进行更改时，我试图在我的第二个 DropDownList 中修改 ListItem 的集合。

我认为这可以通过以下方式实现，但我想确认这是一种很好的做法：

*   使用 jQuery，绑定到第一个 DropDownList 的更改事件。
*   响应更改事件时——使用新选择的值向服务器发送 AJAX 请求。
*   服务器将以 JSON 响应，该 JSON 表示第二个 DropDownList 的 ListItem 对象集合。
*   使用 jQuery，我修改了第二个 DropDownList 的选择，使其包含返回的 JSON 元素。

这一切似乎有点……非 MVC3y，如果你愿意的话。这是实现我所要求的标准方式，还是有更清晰的方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:07:31.613

我认为在这种情况下最好使用 Jquery。

最好的办法是将 firstDropdown 框绑定到 Jquery 中的 OnChange 事件，然后使用 $.ajax 从控制器中的 JSONresult 加载数据。加载该数据后，将数据加载到 secondDropdown 中。

如果您需要一些代码帮助，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:13:38.700

我使用 jQuery Cascade Select 插件为我做这件事。它很容易插入，不需要你重新发明轮子。 [http://code.google.com/p/jquery-cascade/](http://code.google.com/p/jquery-cascade/)

# objective-c - 多个 UITextfields 返回 Null IOS

> ID：13166254
> 
> 赞同：0
> 
> 时间：2012-10-31T19:36:49.137
> 
> 标签：objective-c, ios, uitextfield

我在表单视图上有多个文本字段。我想在用户单击按钮时附加它们。但其中只有一个返回文本字段中的值，其余的返回 null。

。H

```
@property (nonatomic, strong) IBOutlet UITextField *textMonth;
@property (nonatomic, strong) IBOutlet UITextField *textDay;
@property (nonatomic, strong) IBOutlet UITextField *textYear;
@property (nonatomic, strong) IBOutlet UITextField *textMeetingName; 
```

.m

```
@synthesize textDay=_textDay;
@synthesize textMonth=_textMonth;
@synthesize textYear=_textYear;
@synthesize textMeetingName=_textMeetingName;

- (BOOL)disablesAutomaticKeyboardDismissal {
    return NO;
}
//this dismiss keyboard on ios
- (BOOL)textFieldShouldReturn:(UITextField *)textField {

        [_textMonth resignFirstResponder];
        [_textDay resignFirstResponder];
        [_textYear resignFirstResponder];
        [_textMeetingName resignFirstResponder];

    return YES;
}
//submit create folder request to dropbox
- (IBAction)sendCreateFolderRequest:(id)sender{

    if ([_textMonth.text intValue]>12 ||[_textMonth.text intValue]<1 ) {
        //alertview choose a number between 1 and 12
        [self popUpAlertview:@"Please choose a month between 1 and 12"];
    }
    else if ([_textDay.text intValue]>31 || [_textDay.text intValue]<1){
        //alert view choose a number between 1 and 31
        [self popUpAlertview:@"Please choose a day between 1 and 31"];
    }
    else if ([_textYear.text intValue]<0){
        //alert view please enter a correct year
        [self popUpAlertview:@"Please enter a correct year"];
    }
    else if ([_textMeetingName.text length]<=1){
        //alert view meeting name is too short please enter a longer name
         [self popUpAlertview:@"Name is too short. Please enter a longer name"];
    }
    else{

        NSString *sendFolderName=[NSString stringWithFormat:@"/Up2Date/%@.%@.%@.%@",_textMonth.text,textDay.text,textYear.text,textMeetingName.text];

        NSLog(@"Send folder name %@",sendFolderName);

    }

} 
```

输入是`11,12,13,asdaad` 输出是`Send folder name /Up2Date/11.(null).(null).(null)`

奇怪的是，如果字段值错误（例如 11、45、20），我的 if else 方法会捕获它，它会按我的预期弹出警报视图。

那么似乎是什么问题？也许我不应该一次性辞去他们的第一响应者？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T19:39:15.557

改变

```
NSString *sendFolderName=[NSString stringWithFormat:@"/Up2Date/%@.%@.%@.%@",_textMonth.text,textDay.text,textYear.text,textMeetingName.text]; 
```

到

```
NSString *sendFolderName=[NSString stringWithFormat:@"/Up2Date/%@.%@.%@.%@",_textMonth.text,_textDay.text,_textYear.text,_textMeetingName.text]; 
```

你忘了加下划线。

# object - PDO 获取选定列的名称作为对象

> ID：13166256
> 
> 赞同：1
> 
> 时间：2012-10-31T19:36:50.213
> 
> 标签：object, pdo, fetch

如何将选定的数据提取到对象并使用 PDO 检索选定的列名称？现在，我正在循环中获取成员对象，并通过从“获取数组”访问它来手动将每一列添加到对象中。有没有办法自动获取已选择的列名？

```
$sql = "SELECT member.name, member.email FROM member WHERE id = :id";
$param = array(':id' => $id);

$stmt = $this->m_db->select($sql, $param);

$ret = new MemberArray();

while ($f = $stmt->fetch()) {
    $member = new Member($f['name'], $f['email']);
    $ret->add($member);
}
return $ret; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T19:57:15.820

我在[PDOStatement::bindColumn](http://php.net/manual/en/pdostatement.bindcolumn.php)和[PDO::FETCH_OBJ中找到了解决方案](http://php.net/manual/en/pdostatement.fetch.php)

# html - 带有非 HTML5 脚手架的 Grails 2

> ID：13166257
> 
> 赞同：0
> 
> 时间：2012-10-31T19:37:10.667
> 
> 标签：html, grails, grails-2.0

我正在开发一个 Grails 2 应用程序，它具有基于 HTML 5 的脚手架。对于非 HTML 5 浏览器，gsp 标签会生成非 HTML 5 还是在这种情况下我们不能使用 Grails 2？或者有没有办法禁用 HTML 5？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:14:20.033

无论如何都会呈现 HTML5。确定在每个浏览器中做什么并不是真正的 Grails 工作。你有几个选择：

1.  [使用Modernizr](http://modernizr.com/)之类的东西，以便您的 HTML5 可以在旧版浏览器中运行
2.  [安装 Grails 模板](http://grails.org/doc/latest/ref/Command%20Line/install-templates.html)并将所有 HTML5 替换为其他内容。

显然，＃1将是首选。

# javascript - 地理位置，使用 for 和 javascript 循环

> ID：13166261
> 
> 赞同：0
> 
> 时间：2012-10-31T19:37:38.680
> 
> 标签：javascript, arrays, for-loop, geolocation

我正在为移动网站开发地理定位工具，到目前为止我得到了这个：

来自[这里](http://dev.opera.com/articles/view/how-to-use-the-w3c-geolocation-api/)的**地理位置验证**：

```
if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
} else {
    console.log('Geolocation not enabled in your browser.');
} 
```

来自 Caspar 的答案[的](https://stackoverflow.com/questions/5260423/torad-javascript-function-throwing-error)toRad **()**函数：

```
if (typeof(Number.prototype.toRad) === "undefined") {
    Number.prototype.toRad = function() {
        return this * Math.PI / 180;
    }
} 
```

以及第一个链接中的**successFunction() 、** [Movable Type Scripts](http://www.movable-type.co.uk/scripts/latlong.html)和其他一些修改：

```
function successFunction(position) {

    var lat1 = position.coords.latitude;
    var lon1 = position.coords.longitude;

    function calcdist(nLoja,nLat,nLong) {
        this.loja = nLoja;
        this.lat = nLat;
        this.long = nLong;
    }

    aLocal = new Array(3)
    aLocal[0] = new calcdist("leblon",-22.982279,-43.217792);
    aLocal[1] = new calcdist("ipanema",-22.98376,-43.212138);
    aLocal[2] = new calcdist("barra",-22.999118,-43.357867);

    var i = 0;
    //for (var i = 0; i < 4; i++){

        lat2 = aLocal[i].lat;
        lon2 = aLocal[i].long;

        var R = 6371;
        var dLat = (lat2-lat1).toRad();
        var dLon = (lon2-lon1).toRad();
        var lat1 = lat1.toRad();
        var lat2 = lat2.toRad();

        var a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.sin(dLon/2) * Math.sin(dLon/2) * Math.cos(lat1) * Math.cos(lat2); 
        var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
        var d = R * c;

        var thediv = document.getElementById('locationinfo');
            thediv.innerHTML = '<p>Distance user-' + aLocal[i].loja + ': ' + d + '</p>';

    //}
} 
```

这在我的桌面和我的 iphone 上工作得很好。当我注释该`i=0;`行并立即取消注释该`for()`语句（以及右括号）时，问题就来了。Chrome 的控制台返回一个错误：

```
Uncaught TypeError: Cannot read property 'lat' of undefined 
```

对于这一行：

```
lat2 = aLocal[i].lat; 
```

循环的原因是我想计算 x 次来检查哪个商店离用户更近（通过获取用户和每个商店之间的最小距离）。但我似乎无法找出为什么它不允许循环。

提前非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T19:43:24.683

您的循环条件`i<4`如此，但`i`您`0, 1, 2, 3`只有数组索引`0, 1, 2`

你不能超过数组的长度，所以改变循环条件直到数组的长度使用`i < aLocal.length`

```
for(i = 0; i < aLocal.length; i++) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T19:42:44.950

`aLocal`有三个要素。您的循环从 0 变为 3，因此是 4 个元素。

```
for (var $i = 0; $i < aLocal.length; $i++) {
    //...
} 
```

# php - 如何在结帐页面中复制标题？

> ID：13166265
> 
> 赞同：2
> 
> 时间：2012-10-31T19:37:58.490
> 
> 标签：php, wordpress, woocommerce

我的主题中有三个标题，我使用覆盖默认模板的模板以我的主题为商店设置主题。

我的 header.php 中有这个

标题 1：对于我的主页（不是商店）

标题 2：对于我网站的所有页面（非商店）

表头 3：对于店铺（产品类别、单品、存档产品）

但是，当我购买任何产品时，我会转到任何结帐页面（注册、购物车、我的帐户等），标题 2 会出现。

简化的 header.php 代码：

```
if(!is_woocommerce()) {
   <!--Header Wordpress-->
   if(is_home);
      Home site header (Header 1)
   } else {
      All site header (except Home) (Header 2)
   <!--End Header Wordpress-->
} else { // Woocommerce conditional
   Shop header (Header 3)
} 
```

如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T19:51:29.003

购物车和结帐是带有短代码的标准页面，不包含在其他 Woo 模板中，即`is_woocommerce()`不会为它们返回 true。所以也许使用

```
if ( is_page( 'checkout-page-slug' ) || is_page( 'other_shop_page' ) ) { 
```

而是针对他们。

**编辑：**

替换`checkout-page-slug`或`other_shop_page`使用您想要定位的页面的[slug以具有商店标题：](http://codex.wordpress.org/Glossary#Slug)

```
if ( ! is_woocommerce() ) {
    if ( is_home() ) {
        // Home site header (Header 1)
    } elseif( is_page( 'checkout-page-slug' ) || is_page( 'other_shop_page' ) ) {
        // Shop header
    } else {
       // All site header (except Home) (Header 2)
    }
} else { // Woocommerce conditional
    // Shop header
} 
```

# c# - 如何使用 C# 可靠地确定安装了 SQL Server 2008 的哪些组件？

> ID：13166278
> 
> 赞同：4
> 
> 时间：2012-10-31T19:39:00.883
> 
> 标签：c#, sql-server, installation, components, smo

我想使用 C# 以编程方式实现以下目标。

SQL Server 2008 中安装的查询组件，例如

1.  升级工具
2.  调试符号
3.  复制支持
4.  在线图书
5.  开发工具

我曾尝试使用 SQL Server 的 SMO API 尝试查询信息集合以及配置集合，但找不到上述三点中的任何一点。

我需要能够以编程方式确定哪些 SQL Server 2008 组件已安装，哪些未安装，就像 SQL Server 安装设置首先检查安装了哪些组件一样。

一种方法是查询 SQL Server 安装日志文件，但如果 SQL Server 完全不存在或有人删除了该日志文件，则无济于事。

我需要可靠地确定已安装的 SQL Server 组件

请帮忙。

谢谢

史蒂夫

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T23:00:29.833

您最好的选择可能是通过 WMI 查询 Win32_Product。您可以使用[WMI Code Creator v1.0](http://www.microsoft.com/en-us/download/details.aspx?id=8572)来帮助您创建适当的查询。您还可以查看[WQL（用于 WMI 的 SQL）](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394606%28v=vs.85%29.aspx)以获取有关支持的查询语法和[ManagementObjectSearcher 类](http://msdn.microsoft.com/en-us/library/system.management.managementobjectsearcher.aspx)的信息。

这样的事情应该可以解决问题：

```
using System;
using System.Management;
using System.Windows.Forms;

namespace WMISample
{
    public class MyWMIQuery
    {
        public static void Main()
        {
            try
            {
                ManagementObjectSearcher searcher = 
                    new ManagementObjectSearcher("root\\CIMV2", 
                    "SELECT * FROM Win32_Product WHERE Name LIKE '%SQL%'"); 

                foreach (ManagementObject queryObj in searcher.Get())
                {
                    Console.WriteLine("-----------------------------------");
                    Console.WriteLine("Win32_Product instance");
                    Console.WriteLine("-----------------------------------");
                    Console.WriteLine("InstallDate: {0}", queryObj["InstallDate"]);
                    Console.WriteLine("InstallLocation: {0}", queryObj["InstallLocation"]);
                    Console.WriteLine("Name: {0}", queryObj["Name"]);
                    Console.WriteLine("SKUNumber: {0}", queryObj["SKUNumber"]);
                    Console.WriteLine("Vendor: {0}", queryObj["Vendor"]);
                    Console.WriteLine("Version: {0}", queryObj["Version"]);
                }
            }
            catch (ManagementException e)
            {
                MessageBox.Show("An error occurred while querying for WMI data: " + e.Message);
            }
        }
    }
} 
```

1.  升级工具以升级顾问结束
2.  调试符号由某些应用程序按需从符号服务器中提取，并且不会显示在 Win32_Products 中。
3.  通过对 Win32_Products 的普通 WMI 查询似乎无法检测到复制支持
4.  Books Online 以 Books Online 结尾（英文）
5.  开发工具以 BI Development Studio 结束

您可以通过运行 SQL Server 安装发现报告了解已安装的功能（**需要管理员权限**）：

1.  转到开始菜单
2.  单击所有程序
3.  单击 Microsoft SQL 服务器
4.  单击配置工具
5.  单击 SQL Server 安装中心
6.  单击工具部分链接
7.  单击已安装的 SQL Server 功能发现报告

您还可以通过运行从命令行创建报告`setup.exe /ACTION=RUNDISCOVERY /Q`（`C:\Program Files\Microsoft SQL Server\100\Setup Bootstrap\SQLServer2008R2`在 SQL Server 2008 R2 的情况下）。报告文件通常位于 中`C:\Program Files\Microsoft SQL Server\100\Setup Bootstrap\Log\YYYYMMDD_HHmmSS`，其中 YYYYMMDD_HHmmSS 是报告运行的日期和时间。SqlDiscoveryReport.xml 可能是对以编程方式使用最有用的一种。请注意，这些位置可能会有所不同，具体取决于用户在初始设置期间选择的安装位置和 SQL Server 的版本。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-22T20:24:16.247

避免使用 Win_32 产品，请参见[此处](http://sdmsoftware.com/wmi/why-win32_product-is-bad-news/)。

改为使用`CreateObject("WindowsInstaller.Installer")`。

# ios - OpenGL ES 2.0 点光源着色器

> ID：13166280
> 
> 赞同：1
> 
> 时间：2012-10-31T19:39:12.143
> 
> 标签：ios, opengl-es, glkit

我目前正在尝试编写一个应该在 OpenGL ES 2.0 中包含一个简单点光源的着色器，但它不是很有效。

我构建了自己的小型场景图，每个对象（目前只有框）可以有自己的平移/旋转/缩放，渲染效果很好。每个盒子都分配了自己的模型视图和法线矩阵，它们都使用相同的投影矩阵。

对于每个对象，我将矩阵和灯光位置作为统一传递给着色器。

如果物体不旋转，灯光效果很好，但一旦物体旋转，灯光似乎会随着物体旋转，而不是停留在同一位置。

这是一些代码。首先创建矩阵：

```
GLKMatrix4 projectionMatrix = GLKMatrix4MakePerspective(GLKMathDegreesToRadians(65.0f), aspect, 0.1f, 100.0f);
GLKMatrix4 modelViewMatrix = GLKMatrix4MakeTranslation(0.0f, 0.0f, 0.0f); 
```

每个节点计算一个自己的包含平移/旋转/缩放的变换矩阵，并将其与 modelViewMatrix 相乘：

```
modelViewMatrix = GLKMatrix4Multiply(modelViewMatrix, transformation); 
```

这个矩阵被传递给着色器，在对象被渲染后，旧矩阵被恢复。

正常矩阵计算如下：

```
GLKMatrix3InvertAndTranspose(GLKMatrix4GetMatrix3(modelViewMatrix), NULL); 
```

顶点着色器：

```
attribute vec4 Position;
attribute vec2 TexCoordIn;
attribute vec3 Normal;

uniform mat4 modelViewProjectionMatrix;
uniform mat4 modelViewMatrix;
uniform mat3 normalMatrix;

uniform vec3 lightPosition;

varying vec2 TexCoordOut;
varying vec3 n, PointToLight;

void main(void) {
    gl_Position =  modelViewProjectionMatrix * Position;
    n = normalMatrix * Normal;

    PointToLight = ((modelViewMatrix * vec4(lightPosition,1.0)) - (modelViewMatrix * Position)).xyz;

    // Pass texCoord
    TexCoordOut = TexCoordIn;
} 
```

片段着色器：

```
varying lowp vec2 TexCoordOut;
varying highp vec3 n, PointToLight;

uniform sampler2D Texture;

void main(void) {
    gl_FragColor = texture2D(Texture, TexCoordOut);

    highp vec3 nn = normalize(n);
    highp vec3 L = normalize(PointToLight);

    lowp float NdotL = clamp(dot(n, L), -0.8, 1.0);
    gl_FragColor *= (NdotL+1.)/2.;
} 
```

我猜 PointToLight 计算错误，但我不知道出了什么问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T22:21:35.587

我终于弄清楚出了什么问题。

无需将 lightPosition 与 modelViewMatrix 相乘，我只需将其与 viewMatrix 相乘，它仅包含相机的变换，而不包含框的变换：

```
PointToLight = ((viewMatrix * vec4(lightPosition,1.0)) - (viewMatrix * modelMatrix * Position)).xyz; 
```

现在它工作正常。

# matlab - Execution of an external program in MATLAB - succeeds only when using &(ampersand), but then does not wait for completion

> ID：13166283
> 
> 赞同：2
> 
> 时间：2012-10-31T19:39:18.760
> 
> 标签：matlab, system, command-prompt

I am attempting to execute an external program from Matlab:

```
cmdstr = sprintf('"%s\\myEXECUTABLE" "%s" -options',fullEXEpath, fullInputFilePath);
[status, res] = system(cmdstr); 
```

I receive "status = 1", partial program output in "res" (though no error message) and no output files.

BUT, executing exactly the same command with & (ampersand):

```
cmdstr = sprintf('"%s\\myEXECUTABLE" "%s" -options &',fullEXEpath, fullInputFilePath);
[status, res] = system(cmdstr); 
```

Meaning in the background via a dos command window, works just fine (status equals 0 and output files are created).

I have seen somewhere it might be that the antivirus is blocking the program from executing via Matlab, but I cannot disable it since I am an endpoint user.

Using "**&**" causes my GUI to open a command window and run in the background, while immediately resuming Matlab code.

I can live with the command window opening, but not with Matlab resuming right away, as I use the output files in my MATLAB code, which are not necessarily ready.

Is there a way to verify the external program has ended? I tried simply:

```
while (status)  %waiting for system to return status = 0
    disp 'waiting...';
end 
```

but it seems to still return with "status = 0" before completion...

Or rather - is there a way to avoid the &?

Any answer will be much appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T19:05:26.243

作为调试方法，可以使用 system(cmdstr,'-echo')

由于错误消息无处可去，因此您将看不到它们。（matlab 只返回输出，可能不包含错误流）

我是否正确，您正在使用该命令调用 GUI 程序？根据 matlab 文档：

> & 字符具有特殊含义。对于控制台程序，这会导致控制台打开。省略此字符会导致控制台程序以图标方式运行。对于 GUI 程序，附加此字符会导致应用程序在后台运行。MATLAB 继续处理。

因此控制台程序（无头程序）不允许 Matlab 在执行时继续。

# c# - EventSource's response has a MIME type ("text/html") that is not "text/event-stream"

> ID：13166284
> 
> 赞同：0
> 
> 时间：2012-10-31T19:39:20.297
> 
> 标签：c#, javascript, asp.net-mvc, mime-types

When I try to hook up the EventSource to my controller it keeps saying:

> EventSource's response has a MIME type ("text/html") that is not "text/event-stream". Aborting the connection.

I made the following class to help with the handling and preparation of a response. In this class I believe I set the responseType accordingly to `text/event-stream`.

```
public class ServerSentEventResult : ActionResult
{
    public delegate string GetContent();
    public GetContent Content { get; set; }
    public int Version { get; set; }

    public override void ExecuteResult(ControllerContext context)
    {
        if (context == null)
        {
            throw new ArgumentNullException("context");
        }

        if (this.Content != null)
        {
            HttpResponseBase response = context.HttpContext.Response;
            response.ContentType = "text/event-stream"; response.BufferOutput = false; response.Charset = null;
            string[] newStrings = context.HttpContext.Request.Headers.GetValues("Last-Event-ID");
            if (newStrings == null || newStrings[0] != this.Version.ToString())
            {
                try
                {
                    response.Write("retry:250\n");
                    response.Write(string.Format("id:{0}\n", this.Version));
                    response.Write(string.Format("data:{0}\n\n", this.Content()));
                    response.End();
                }
                catch (HttpException e) { }
            }
            else
            {
                response.Write(String.Empty);
            }
        }
    }
} 
```

Could someone please help me out on this one? Thousand times thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T07:41:31.350

Sorry for the late answer.

What I did in my code is prepare my whole response in a string builder and then write it and flush it at once (not 3 writes with an end)

```
var sb = new StringBuilder(); 
sb.Append("retry: 1\n");
sb.AppendFormat("id: {0}\n", this.Version);
sb.AppendFormat("id: {0}\n\n", this.Content());
Response.ContentType = "text/event-stream";
Response.Write(sb.ToString());
Response.Flush(); 
```

on another note, my code is in an MVC controller, so I don't create the response myself (I use this.Response) meaning my header may contains more data than just the ContentType.

# iphone - 尝试使用 didSelectAnnotationView 和 didDeselectAnnotationView 对子视图进行动画处理

> ID：13166289
> 
> 赞同：2
> 
> 时间：2012-10-31T19:39:35.150
> 
> 标签：iphone, ios, mkmapview, mkannotation, uiviewanimation

我在 MKMapView 上设置了多个注释。我不想在单击图钉时使用地图注释标注，而是希望将子视图 ( `self.detailView`) 动画化到屏幕底部，并在未选择任何内容时将其移回。当用户选择了一个图钉，然后选择了另一个图钉时，我希望我的视图在屏幕外显示动画，然后立即在屏幕上显示动画（当然，与新选择的注释对应的不同信息）。

没有想太多，我尝试了似乎很容易做的事情 - 选择注释时，`self.detailView`在屏幕上设置动画，当取消选择时，在屏幕外设置动画`self.detailView`：

```
- (void)mapView:(MKMapView *)mapView didSelectAnnotationView:(MKAnnotationView *)view
{
    NSLog( @"selected annotation view" );

    [UIView animateWithDuration:0.2f
                          delay:0.0f
                        options:UIViewAnimationOptionCurveEaseInOut | UIViewAnimationOptionAllowUserInteraction
                      animations:^{
                          [self.detailView setFrame:CGRectMake(0, 307, 320, 60)];       
                      }
                      completion:^(BOOL finished){                

                      }];
}

- (void)mapView:(MKMapView *)mapView didDeselectAnnotationView:(MKAnnotationView *)view
{
    NSLog( @"deselected annotation view" );

    [UIView animateWithDuration:0.2f
                          delay:0.0f
                        options:UIViewAnimationOptionCurveEaseInOut | UIViewAnimationOptionAllowUserInteraction
                      animations:^{
                          [self.detailView setFrame:CGRectMake(0, 367, 320, 60)];       
                      }
                      completion:^(BOOL finished){

                      }];

} 
```

This works fine when no pin is selected and the user selects a pin, and when a pin is selected and the user deselects it by clicking on empty space. 当然，当一个 pin 已经被选中时，问题就出现了：如果用户随后点击另一个 pin，`didDeselectAnnotationView`并`didSelectAnnotationView`快速连续触发，两个动画会尝试同时运行，结果效果无法正常工作. 通常我会通过将第二个动画放在第一个动画的完成块中来将动画链接在一起，但由于它们是在单独的方法中，我显然不能在这里这样做。

有人对我如何解决这个问题有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T02:09:49.283

可能有更好的方法来做你想做的事，但我会先回答你的具体问题。

在你的控制器中实现公共方法来控制动画关闭和再次打开的视图：

```
- (void)showInfoView:(MyInfoClass*)theInfo;
- (void)hideInfoView; 
```

在`showInfoView`您设置一个显示/显示的标志并在屏幕上对其进行动画处理 - 在一个块中执行此代码并立即调用它只是为了让它像这样工作......

```
dispatch_block_t showBlock = ^
{
    self.isShowing = YES;
    /* show code goes here */
};
showBlock(); 
```

在`hideInfoView`您关闭动画并取消设置动画完成块中的标志。

现在在`showInfoView`调用之前`showBlock`检查标志以确保它尚未显示 - 如果是，则不要立即执行块，而是将其添加到被`NSMutableArray`调用的末尾`toShowBlocks`。然后在`hideInfoView`取消设置标志之前检查`toShowBlocks`数组是否为空，如果不是，则删除并调用第一项（使用数组作为 FIFO 队列），如下所示......

```
dispatch_block_t nextShowBlock = [toShowBlocks objectAtIndex:0];
[toShowBlocks removeObjectAtIndex:0];
nextShowBlock(); 
```

然后，您只需在选择/取消选择引脚时调用您的显示和隐藏方法，这将为您处理。这至少应该让你走上正确的道路。

也许更好的方法：

上面有一些问题，如果用户疯狂地按下图钉，动画视图可能会被隐藏并显示很多，导致在用户获得最后一个动画之前出现冗长的动画队列。此外，当用户平移和缩放地图时，视图不会像注释那样跟随地图。因此，您最好为信息视图使用自定义注释。这是一个真正的痛苦，因为`MKAnnotation`视图的行为不像常规`UIView`的 s，这会导致各种问题。`MKAnnotation`但是，我在此答案中描述了一种将s 用作自定义标注的方法： [https](https://stackoverflow.com/a/8649951/461492) ://stackoverflow.com/a/8649951/461492 。

# ios - 在 tabbarcontroller 上添加按钮

> ID：13166290
> 
> 赞同：1
> 
> 时间：2012-10-31T19:39:41.243
> 
> 标签：ios, xcode, interface-builder, uitabbarcontroller, uitabbar

是否可以使用界面生成器在标签栏控制器上添加按钮？

我试图在界面构建器中执行此操作，但每次我在选项卡栏上添加按钮时，它都会用按钮填满屏幕的其余部分，而不是仅仅将按钮放在选项卡栏上。

类似于 Instagram 中的相机。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T00:46:16.477

这就是我解决问题的方法：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    UIImage *buttonImage = [UIImage imageNamed:@"cameraTabBarItem.png"];
    UIImage *highlightImage = [UIImage imageNamed:@"cameraTabBarItem.png"];
    UIButton* button = [UIButton buttonWithType:UIButtonTypeCustom];
    button.frame = CGRectMake(0.0, 0.0, buttonImage.size.width, buttonImage.size.height);
    [button setBackgroundImage:buttonImage forState:UIControlStateNormal];
    [button setBackgroundImage:highlightImage forState:UIControlStateHighlighted];
    CGFloat heightDifference = buttonImage.size.height - self.tabBarController.tabBar.frame.size.height;
    if (heightDifference < 0)
        button.center = self.tabBarController.tabBar.center;
    else
    {
        CGPoint center = self.tabBarController.tabBar.center;
        center.y = center.y - heightDifference/2.0;
        button.center = center;
    }
    [button addTarget:self action:@selector(share:) forControlEvents:UIControlEventTouchUpInside];
    [self.tabBarController.view addSubview:button];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T00:54:48.377

您可能需要将按钮添加为 App Delegate 窗口的子视图：

```
[self.window addSubview:myButton]; 
```

# google-chrome-extension - 关于 chrome.tabs.executeScript(id,details, callback)

> ID：13166293
> 
> 赞同：35
> 
> 时间：2012-10-31T19:39:56.703
> 
> 标签：google-chrome-extension

这个函数有一个回调，如`function(array of any result) {...};`

但我不知道结果是什么意思。

例如，

```
chrome.tabs..executeScript(null,
   {code:"var x = 10"},
   function(){}); 
```

如何返回`x`回调？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-11-01T08:18:22.360

脚本的结果是被评估的最后一个表达式。因此，在您的示例中，您可以使用：

```
chrome.tabs.executeScript( null, {code:"var x = 10; x"},
   function(results){ console.log(results); } ); 
```

这会将*[10]*记录到扩展程序的控制台。

*results*实际上是一个值数组，因为如果页面有多个帧，您可以指定脚本应该注入其中的每个帧并获取所有注入的结果。请参阅[executeScript](https://developer.chrome.com/extensions/tabs.html#method-executeScript)的规范。如果您不指定*allFrames: true*，则*结果*将始终是单元素数组。

# .net - error message " 'y' is not declared." in vb.net

> ID：13166297
> 
> 赞同：4
> 
> 时间：2012-10-31T19:40:34.653
> 
> 标签：.net, wpf, vb.net

I'm having a weird problem. I have some code in Visual Studio 2012 express edition in a WPF app written with VisualBasic.Net.

```
Private Sub txtColProvGenCompany_TextChanged(sender As Object, e As TextChangedEventArgs) Handles txtColProvGenCompany.TextChanged

    ProvNewEditing()
End Sub 
```

But when I try to run the application it says that it can't build because the `y` from `txtConProvGenCompan***y***.TextChanged`. The error message is

> `y` is not declared. it may be inaccessible due to its protection level

and shows only that character underlined in my code.

any ideas?

# iphone - Search String into NSArray based on charcters order?

> ID：13166301
> 
> 赞同：0
> 
> 时间：2012-10-31T19:40:52.397
> 
> 标签：iphone, ios, ipad, nsstring, nsmutablearray

My Problem Scenario is like this. I have an NSMutableArray ( Every Object is Nsstring). I have a UItextField ( as Client said) for Search.

I want know how to Search String into NSMutableArray like this

if I type A into textfield only those Content come from NSMutableArray which start From A. if I type AB into TextField only those Content Comes from NSMutableArray which is started from AB.. .... I am Trying NSRange Concept I like share Mycode

~

```
 for (int i=0; i<[[localTotalArrayForAwailable objectForKey:@"PUNCH"] count]; i++)
{

    NSString *drinkNamePuch= [[[localTotalArrayForAwailable objectForKey:@"PUNCH"]  objectAtIndex:i] drinkNames];

    NSRange titleResultsRange = [drinkNamePuch rangeOfString:searchText options:( NSCaseInsensitiveSearch)];

    if (titleResultsRange.length>0)
    {
        [searchArraypuch addObject:[[localTotalArrayForAwailable objectForKey:@"PUNCH"]  objectAtIndex:i]];
        [copyListOfItems setValue:searchArraypuch forKey:@"PUNCH"];
    }
} 
```

~

Based on this code search not working proper as i need.

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:58:13.463

如果您试图`searchText`从一开始就找到与您匹配的所有字符串，那么您应该检查：

```
if ( titleresultsRange.location == 0 ) 
```

除此之外，我不确定什么是“无法正常工作”，您需要更好地解释您的预期结果是什么，以及您的实际结果是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T19:59:10.313

做这个;

```
NSPredicate* predicate = [NSPredicate predicateWithFormat:@"SELF BEGINSWITH[cd] %@", searchText];
NSArray* filteredStrings = [[localTotalArrayForAwailable objectForKey:@"PUNCH"]  filteredArrayUsingPredicate:predicate]; 
```

在filteredStrings 中，你得到了所有以searchText 开头的字符串。

您可能会发现[Predicate Programming Guide](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Predicates/Articles/pSyntax.html)很有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:11:52.647

您可以使用 NSArray/NSMutableArray 提供的这些方法：

1.  在[NSArray](http://developer.apple.com/library/ios/#documentation/cocoa/reference/foundation/Classes/NSArray_Class/NSArray.html)中，请参阅“在数组中查找对象”部分以了解以“indexesOfObjects...”开头的过滤方法，例如[indexOfObjectsPassingTest：](http://developer.apple.com/library/ios/documentation/cocoa/reference/foundation/Classes/NSArray_Class/NSArray.html#//apple_ref/occ/instm/NSArray/indexesOfObjectsPassingTest%3a)

2.  在[NSArray](http://developer.apple.com/library/ios/#documentation/cocoa/reference/foundation/Classes/NSArray_Class/NSArray.html)中，请参阅“Deriving New Arrays”部分以了解有关方法[filteredArrayUsingPredicate 的内容：](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/NSArray.html#//apple_ref/occ/instm/NSArray/filteredArrayUsingPredicate%3a)

3.  在[NSMutableArray](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html)中有一个方法[filterUsingPredicate：](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html#//apple_ref/occ/instm/NSMutableArray/filterUsingPredicate%3a)

为了缩小结果范围，您可以继续将过滤连续应用于过滤后的数组或索引集。

* * *

[indexOfObjectsPassingTest](http://developer.apple.com/library/ios/documentation/cocoa/reference/foundation/Classes/NSArray_Class/NSArray.html#//apple_ref/occ/instm/NSArray/indexesOfObjectsPassingTest%3a)示例：使用[块](http://developer.apple.com/library/ios/documentation/cocoa/Conceptual/Blocks/Articles/00_Introduction.html)：

```
NSArray *strings = [NSArray arrayWithObjects:@"A", @"a", @"aB", @"AbC", @"Bag", @"Babc", @"baCK", @"", @"dba", nil];
NSString *searchString = @"Ab";

BOOL (^startsWithPredicate)(id, NSUInteger, BOOL*) = ^BOOL (id obj, NSUInteger idx, BOOL *stop) {
    NSString *string = (NSString *) obj;
    NSRange range = [string rangeOfString:searchString options:NSCaseInsensitiveSearch];
    return (range.location == 0);
};

NSIndexSet *indexSet = [strings indexesOfObjectsPassingTest:startsWithPredicate];
NSLog(@"Strings found: %@", [strings objectsAtIndexes:indexSet]); 
```

输出：

```
Strings found: (
    aB,
    AbC
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-01T06:00:31.480

试试这个逻辑....它正在工作

```
 NSMutableArray *arr = [[NSMutableArray alloc]initWithObjects:@"aa",@"bbb",@"bb",@"cc",@"dd",@"ee",@"ff",@"gg",@"hh",@"ii", nil];
NSMutableArray *arrNew = [[NSMutableArray alloc]init];
NSString *strSearch = @"cccc";
int k = strSearch.length;
for (int i=0; i<[arr count]; i++) {
    for (int j=0; j<k; j++) {
        if (k<=[[arr objectAtIndex:i] length]) {
            if ([strSearch characterAtIndex:j] != [[arr objectAtIndex:i]characterAtIndex:j]) {
                break;
            }
            else if(j == k-1){
                [arrNew addObject:[arr objectAtIndex:i]];
            }
        }
    }
}
NSLog(@"%@",[arrNew description]); 
```

# java - 使用 split() 在 Java 中查找特定行

> ID：13166307
> 
> 赞同：2
> 
> 时间：2012-10-31T19:41:19.267
> 
> 标签：java, string, split, newline, substring

我有一个包含如下文本行的文件：

[一种]

这是一条线。

这是另一条线。

[乙]

第三行。

...

等等。我想将此文件读入 Java 并查找仅包含 [A] 等的行以供进一步参考。我试过：

```
Resources res = getResources();
InputStream in_s = res.openRawResource(R.raw.texts);
byte[] b = new byte[in_s.available()];
in_s.read(b);
String textstring = new String(b);
String[] textarr = textstring.split("[\\r\\n]+"); 
```

进而：

```
int lineB = 0;
for (int i=0; i<textarr.length; i++) {
    if textarr[i].substring(0, 3) == "[B]") lineB = i;
 } 
```

之后，线仍然为零。首先，我认为这与处理新行的方式有关（我使用的是 Windows），但我对 substring(0,3) 也没有运气。我希望这给我 lineB = 3，任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:50:24.067

像这样使用[String#startsWith](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#startsWith%28java.lang.String%29)：

```
int lineB = 0;
for (int i=0; i<textarr.length; i++) {
    if (textarr[i].startsWith("[B]"))
       lineB = i;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T19:48:33.200

尝试[String.contains(CharSequence s)](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#contains%28java.lang.CharSequence%29)或[String.startsWith(String prefix)](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#startsWith%28java.lang.String%29)

编辑：哦，试试[BufferedReader](http://docs.oracle.com/javase/7/docs/api/java/io/BufferedReader.html)：

```
BufferedReader in = new BufferedReader(new FileReader("foo.in"));
String line = "";
while ((line = in.readLine()) != null)
        if(line.startsWith("whatever")) ... 
```

# .net - 使用 excel 和 Visual Studio 2010 时出现“类未注册”错误

> ID：13166308
> 
> 赞同：1
> 
> 时间：2012-10-31T19:41:20.783
> 
> 标签：.net, vb.net, visual-studio-2010, excel, excel-interop

您好，我正在尝试将数据从 Excel 导入到 Visual Basic 变量，但我遇到了一个奇怪的错误。我确实添加了对 microsoft excel com 库的引用。

```
Imports Microsoft.Office.Interop.Excel

Module Module1

Sub Main()
    ExtraerCostos()
End Sub

Public Sub ExtraerCostos()

    Dim numero As String
    Dim aux As String
    Dim costos(20) As Double
    Dim cant As Integer  

    Dim excelApp As New Microsoft.Office.Interop.Excel.Application
    Dim workbook As New Microsoft.Office.Interop.Excel.Workbook ' The error points to this line 
    Dim sheet As New Microsoft.Office.Interop.Excel.Worksheet

    excelApp = CreateObject("Excel.Application")
    excelApp.Visible = True
    workbook = excelApp.Workbooks.Open("C:\workbook.xls")
    sheet = workbook.Worksheets("Factura Detallada")

     'Irrelevant code
    numero = "111111111"
    cant = 12

    While numero.Length = 9
        cant = cant + 1
    End While

    For i = 12 To cant

        numero = sheet.Cells(i, 1).text
        For j = 3 To 22
            aux = sheet.Cells(i, j).text
            If aux = "-" Then
                costos(j - 2) = 0
            Else : costos(j - 2) = Convert.ToDouble(aux)

            End If
            Console.WriteLine(costos(j - 2))
        Next

    Next

End Sub
End Module 
```

由于以下错误，检索具有 CLSID {00020819-0000-0000-C000-000000000046} 的组件的 COM 类工厂失败：80040154 类未注册（HRESULT 异常：0x80040154 (REGDB_E_CLASSNOTREG)）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T20:44:47.420

您不能以这种方式创建工作簿或工作表。您必须使用 Workbooks.Open 或 Workbooks.Add 方法（您在 ExtraerCostos 的第 10 行执行此操作）

采用

将工作簿变暗为 Excel.Workbook

并且已经好了

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:07:35.310

...您将其声明为新工作簿，但未将其设置为值...试试这个：

```
Dim workbook As Microsoft.Office.Interop.Excel.Workbook = Nothing 
```

希望这可以帮助

# vb.net - 增加窗体内的空间

> ID：13166309
> 
> 赞同：0
> 
> 时间：2012-10-31T19:41:28.377
> 
> 标签：vb.net, winforms

我正在尝试根据从我的数据库中读取的内容，用新的控件和数据填充我的 windows 窗体。表单的左侧是一个静态面板，不需要调整大小，但我需要在右侧创建多个标签，这需要更多空间。我添加了 vscroll 控件，但无法增加表单右侧的大小。![在此处输入图像描述](../Images/9f48ae2b737501260988fd4101bebe8f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:08:07.023

要使用滚动条将需要一个半低级的实现，您需要始终通过重新定位元素来更新视图，计算与总视图相关的滚动条，哪些元素是可见的等等。

在这种情况下，更好的解决方案可能是在`Panel`停靠的右侧添加一个控件（例如 Fill），然后将`AutoScroll`属性设置为`True`.

这样，您将所有“低级”内容留给`Panel`控件，您可以将所需的元素添加和定位到 Panel 的`Controls`集合中。

# ruby-on-rails - 使用 Rails 3 和 Facebook 登录构建 API 后端

> ID：13166310
> 
> 赞同：0
> 
> 时间：2012-10-31T19:41:30.050
> 
> 标签：ruby-on-rails, facebook, security, facebook-graph-api, facebook-javascript-sdk

我有一个简单的应用程序，它需要在 Rails 3 中内置的 facebook 注册/登录，它可以完全按照我的意愿工作。同时，我有几个要求让它表现得像一个 API，网络应用程序是一个社交媒体工具，人们可以将内容发布到他们自己的社交网络上。我正在转换系统以提供以下问题的解决方案：

*   拥有自己的登录系统的第三方网站
*   他们想要制作一个按钮——通过 X 服务发布——一旦用户按下按钮，他就会看到我自己的 fb 应用程序的 Facebook 权限对话框，一旦他授权，内容就会被发布

到目前为止，虽然 webapp 是一个独立的网站，但这真的很容易做到——他们会去我的 webapp，用 facebook 登录并发布他们想要的任何内容，但是，我发现很难想出一个解决方案不存在任何安全问题。这就是我的想法：

*   我提供了一个 JS SDK，它：
    *   第 3 方在他们的网站上安装 -> 一种特殊方法与按钮相关联
    *   按下按钮后，用户将被重定向到 FB（将 de redirect_ui 设置为当前页面）
    *   每当 FB 重定向回来时捕获参数（一旦用户授予权限）
    *   通过Facebook等推送内容
    *   第 3 方提供了一个回调，该回调将在内容发布后立即运行（我向他们发送 FB_ID 和访问令牌）
    *   第 3 方现在可以调用我的所有 API，因为他们将在我获得权限后立即发送我发送的 FB_ID 和访问令牌

这行得通吗？我可以轻松地追回 FB 重定向吗？有什么安全问题吗？

提前致谢，泽

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:57:51.133

我的系统做了一些非常相似的事情。我向 3rd 方网站提供 API，并代表他们的用户调用 Facebook。

我采用的方法是将我的系统实现为 oauth 提供者。这样，当用户在第 3 方网站上登录时，他会看到我的登录页面，在点击或通过重定向时，会将他重定向到 Facebook oauth 流。

第 3 方-->我的网站--> Facebook

但是，在您的情况下，这可能有点矫枉过正。

# ruby - Nil can't be coerced into Fixnum

> ID：13166312
> 
> 赞同：0
> 
> 时间：2012-10-31T19:41:39.620
> 
> 标签：ruby, ruby-1.9, fixnum

I have the following function:

```
def valid_credit_card?(number)
    digits = number.scan(/./).map(&:to_i)
    check = digits.pop

    sum = digits.reverse.each_slice(2).map do |x, y|
        [(x * 2).divmod(10), y]
    end.flatten.inject(:+)

    (10 - sum % 10) == check
end 
```

But for some reason I keep getting the following error message: `nil can't be coerced into Fixnum`

And for some reason I can't figure out why the error is being thrown. Any ideas why this might be happening?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T19:54:56.703

`digits`当元素数量为奇数时，您的方法会失败。在这种情况下，当您调用`each_slice(2)`最后一次迭代时，`x`将是 的最后一个元素，`digits`并且`y`将是`nil`. 因此，当您进入`inject(:+)`阶段时，数组的最后一个元素是`nil`，并且当解释器遇到类似`2 + nil`.

为什么不对输入的位数添加初始检查？就像是：

```
return false unless digits.length == 16 
```

# c# - Decimals resolving as files in ASP.Net MVC route on IIS7

> ID：13166313
> 
> 赞同：1
> 
> 时间：2012-10-31T19:41:46.457
> 
> 标签：c#, asp.net-mvc, iis-7

I'm having a problem where my the final decimal in my url string is being resolved to a file instead of being read as a decimal.

This is only happening on our production servers on II7.0 (so the wildcard map for aspnet_isapi.dll doesn't apply) and then only one of two production nodes. The nodes are separated by a load balancer.

The url looks like:

```
http://innerwebz_node_1/12345/123.4 
```

If I put in the url into the first node it works, on the second node it dies.

We've tried:

[Routing on IIS6 With Decimal In Route](https://stackoverflow.com/questions/7530827/routing-on-iis6-with-decimal-in-route)

[System.Web.Routing only working with a .aspx file extension](https://stackoverflow.com/questions/11018420/system-web-routing-only-working-with-a-aspx-file-extension)

The code base and configuration are identical except for node-specific settings.

Have you encountered anything like this? Any clues or options to solve this would be helpful.

# java - 如何在 Java 中使用运行时对象打开多个文件？

> ID：13166314
> 
> 赞同：0
> 
> 时间：2012-10-31T19:41:50.580
> 
> 标签：java, file, runtime

我使用 Runtime.getRuntime().exec(String cmd) 函数打开办公文件（docx、xlsx）。同时，我将这些文件的元数据存储在数据库中。为了保持完整性，我在元数据中使用标志锁定文件，以便其他用户不能同时修改文件。这意味着必须在用户关闭文件（例如关闭外部进程）后自动重置标志。

这是打开文件的片段：

```
File file = new File("c:/test.docx");
Process process = null;
if(file.getName().endsWith("docx")) {
    process = Runtime.getRuntime().exec("c:/msoffice/WINWORD.EXE "+file.getAbsolutePath());
} else if(file.getName().endsWith("xlsx")) {
    process = Runtime.getRuntime().exec("c:/msoffice/EXCEL.EXE "+file.getAbsolutePath());
}
if(process!=null) {
    new ProcessExitListener(file, process);
} 
```

这是我的监听器，它一直等到用户关闭文件（最后通过在元数据中设置标志来解锁文件）：

```
private class ProcessExitListener extends Thread {

    private File file;
    private Process process;

    public ProcessExitListener(File file, Process process) throws IOException {
        this.setName("File-Thread ["+process.toString()+"]");
        this.file = file;
        this.process = process;
        this.start();
    }

    @Override
    public void run() {
        try {
            process.waitFor();
            database.unlock(file);
        } catch (InterruptedException ex) {
            // print exception
        }
    }
} 
```

这适用于不同的文件类型，例如，如果我同时打开 1 个 docx 和 1 个 xlsx 文件。但是当打开 2 个 docx 文件时，其中一个进程在初始化后立即退出。

任何想法为什么？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:45:44.467

> 但是当打开 2 个 docx 文件时，其中一个进程在初始化后就存在。

可能是因为`winword.exe`进程发现它已经有一个实例在运行，所以它没有在内存中保留两个实例，而是要求第一个实例打开第二个文档。不知道从 GUI 角度看它的外观如何，但是查看任务管理器，尝试从 Windows 资源管理器中打开两个 Word 文档。第二个文件不会导致第二个`winword.exe`进程启动。

我可以在 Ubuntu Linux 上重现完全相同的行为。当我跑的时候：

```
$ geany foo.txt 
```

并且[geany](http://www.geany.org/)编辑器尚未运行，控制台挂起，直到我关闭编辑器。但是，如果我打开另一个终端并调用：

```
$ geany bar.txt 
```

这会立即返回，并且`bar.txt`只是作为现有进程中的另一个选项卡打开。

# java - 对象何时有资格进行垃圾收集

> ID：13166316
> 
> 赞同：0
> 
> 时间：2012-10-31T19:42:09.143
> 
> 标签：java, garbage-collection

给我的一个方法，问它什么时候有资格进行垃圾收集，我的意思是在哪一行。我相信两者`o`都有`oa`资格进行垃圾收集。因为，它们被设置为`null`. 请纠正我，如果我错了。但是，问题是，它什么时候有资格获得`gc`，我的意思是在哪一行。?

```
public Object m() {
        Object o = new Float(3.14F);
        Object[] oa = new Object[1];
        oa[0] = o; /* Line 5 */
        o = null; /* Line 6 */
        oa[0] = null; /* Line 7 */
        return o; /* Line 8 */
    } 
```

请任何人解释。?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T19:47:48.310

让我们看一下代码：

```
1)  o = new Float();  
2)  oa = new Object[];  
    at this point we have 2 objects.  
3) oa[0] = o;  
    at this point oa[0] holds the reference of o.  
4)  o = null;  
    o is still being referenced by oa[0]  
5)  oa[0] = null  
    o now has zero references.  
6)  return o;  
     o is null. 
```

第 7 行是 GC 资格发生的地方`o`。 `oa`在函数退出之前没有资格进行 GC。

一般来说，一个对象只有在没有引用时才有资格进行 GC。处理 a 时要非常小心，`String`因为有一个特殊的地方叫做字符串池。所以下面的代码：

```
void foo()  
{  
   String s = "foo";   
   s=null;  
   return s;  
} 
```

在任何时候都`s`不能保证在函数中符合条件。

**来自评论的问题**

> 一个问题，你说..oa 在函数退出之前没有资格进行 GC。但是，在返回 o 之前，oa 设置为 null 并且它也无处引用

回答：

> oa 未设置为空。设置为 null 的是 oa[0] 处的对象（oa 的第一个索引）。如果该行是 oa = null 那将是正确的，并且不管 oa 中唯一的项目是否为 null，实际上并不会使包装器（在本例中为数组）为 null。类似于拥有一个 List 并清空其所有元素不会使 List 为空。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T19:50:59.863

允许 Java 进行某些优化，因此仅考虑局部效应的优化 JIT 可以简化此代码以

```
public Object m() {
    //Object o =                    // o does not participate in any externally visible side-effect
    new Float(3.14F);               // Available for collection as soon as ctor finishes.
    //Object[] oa = new Object[1];  // Array ctors are known not to have side-effects, and oa does not participate in a side-effect or result that is visible outside the method.
    //oa[0] = o; /* Line 5 */       // Side-effect not visible.
    // o = null; /* Line 6 */       // Side-effect not visible.
    //oa[0] = null; /* Line 7 */
    //return o; /* Line 8 */        // Eliminated by inlining.
    return null;                    // Type-analysis proves that this method can only return null.
} 
```

不要假设局部变量的赋值`null`实际上发生在长期存在的方法调用中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T19:45:24.893

当不再存在对该对象的引用时，垃圾收集是*合格的，但重要的是要注意 GC 不能保证在那时运行，因此从技术上讲可以分配内存。*

oa[0] 引用对象，因此当您在第 7 行将其设置为 null 时，不再存在对该对象的引用，因此它符合 GC 条件。

正如评论所指出的，数组本身 oa 仍然存在，直到方法完成执行，即在第 8 行执行之后。它在方法 m() 的生命周期中是本地的，因此当 m() 从执行返回时，它将符合 GC 条件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T11:16:59.737

> 请纠正我，如果我错了。但是，问题是，它什么时候有资格获得 gc，我的意思是在哪一行。?

这个问题是荒谬的或基于过度简化的垃圾收集模型。垃圾收集器在运行时对可用表示进行操作，这意味着从包括寄存器、堆栈和全局变量在内的全局根跟踪可达性。与高级源代码没有对应关系，因此询问行号是没有意义的。实际上，编译器会在 GC 运行之前将您的代码弄得面目全非。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-31T19:46:05.330

AFAIK，Java 使用 Mark-And-Sweep 算法。GC 反复在堆上的单独线程中运行。

如果某个引用变量（或对象）超出范围，则将其标记为删除并在适当时清除（或覆盖）。

此外，每当变量设置为 null 时，即当~~引用计数~~对象变得*无法*被静态引用和其他线程访问时，即当它的引用不再存在时，它会再次标记为删除。

代码中的第 7 行将标记为删除。

# angularjs - 使用 AngularJS 创建一个 n 级深度的无序列表

> ID：13166319
> 
> 赞同：1
> 
> 时间：2012-10-31T19:42:23.637
> 
> 标签：angularjs

在浏览一些 AngularJS 示例时，我看到重复和创建结构是多么容易。但是，我无法弄清楚如何执行以下操作。

假设我们有一个像

```
 {
    "Asia": {
            "India": {
                    "Bangalore": {},
                    "Mumbai": {},
                    "New Delhi": {}
            },
            "China": {
                    "Beijing": {},
                    "Shanghai": {}
            }
    },
    "Europe": {
            "France": {
                    "Paris": {}
            },
            "Germany": {
                    "Berlin": {}
            }
    }
    } 
```

我想要做的是 - 将此 JSON 结构转换为无序列表 -**这种结构的深度未知，并且可能更深。**如何使用 Angular JS 动态执行重复？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T23:31:50.583

您的 JSON 结构不佳，您使用属性名称来承载数据。

你真正想要的是这样的：

```
$scope.continents = [
   { 
      name: 'Asia',
      countries: [
         {
            name: 'India',
            cities: [
               'Bangalore',
               'Mumbai',
               'New Delhi'
            ]
         },
         {
            name: 'China',
            cities: [
               'Beijing',
               'Shanghai'
            ]
         },
      ]
   },
   { 
      name: 'Europe',
      countries: [
         {
            name: 'France',
            cities: [
               'Peris'
            ]
         },
         {
            name: 'Germany',
            cities: [
               'Berlin'
            ]
         },
      ]
   }
]; 
```

也就是说......听起来你想要做的是创建某种递归树指令。这有点棘手。您需要稍微标准化您的结构，以便递归地检查它。然后你必须创建两个指令。一个用于列表，一个用于项目：

这是[我的意思的一个例子](http://plnkr.co/edit/6maXLm)......

```
function Item(name, items) {
  this.name = name;
  this.items = items || [];
}

app.controller('MainCtrl', function($scope) {
  $scope.items = [
    new Item('test'),
    new Item('foo', [
        new Item('foo-1'),
        new Item('foo-2', [
            new Item('foo-2-1'),
            new Item('foo-2-2')
          ])
      ]),
    new Item('whatever')
    ];
});

app.directive('tree', function() {
  return {
    template: '<ul><tree-node ng-repeat="item in items"></tree-node></ul>',
    restrict: 'E',
    replace: true,
    scope: {
      items: '=items'
    }
  };
});

app.directive('treeNode', function($compile) {
  return { 
    restrict: 'E',
    template: '<li>{{item.name}}</li>',
    link: function(scope, elm, attrs) {
      //MAGIC HERE!!!: this will do the work of inserting the next set of nodes.
      if (scope.item.items.length > 0) {
        var children = $compile('<tree items="item.items"></tree>')(scope);
        elm.append(children);
      }
    }
  };
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-15T04:02:20.087

如果有人对“最省力”的方式感兴趣而无需创建指令（不是你不应该这样做，而是提供一个变体），这里有一个简单的例子：

[http://jsbin.com/hokupe/1/edit](http://jsbin.com/hokupe/1/edit)

这里还有一篇博客文章和一个 10-15 分钟的视频，介绍它是如何工作的：

[http://gurustop.net/blog/2014/07/15/angularjs-using-templates-ng-include-create-infinite-tree/](http://gurustop.net/blog/2014/07/15/angularjs-using-templates-ng-include-create-infinite-tree/)

示例代码：

```
 <script type="text/ng-template" id="treeLevel.html">
    <ul>
      <li ng-repeat="item in items">
        <input type="checkbox"
          name="itemSelection"
          ng-model="item._Selected" />
        {{item.text}}
        <div ng-include=" 'treeLevel.html'"
            onload="items = item.children">
        </div>
      </li>
    </ul>
  </script>
  <div ng-include=" 'treeLevel.html' "
       onload="items = sourceItems">
  </div> 
```

# java - htmlunit Socks Proxy not working with HTTPS

> ID：13166327
> 
> 赞同：0
> 
> 时间：2012-10-31T19:43:16.417
> 
> 标签：java, proxy, htmlunit, socks

I'm having a similar issue as [Is it possible to use HTTPS proxy in HTMLunit?](https://stackoverflow.com/questions/11689087/is-it-possible-to-use-https-proxy-in-htmlunit) , but I'm using httpunit version 2.10\. The previous post was around the time of the 2.10 release ([changelog](http://htmlunit.sourceforge.net/changes-report.html#a2.10 "changelog"), so I don't know if anything has changed since then.

Specifically, this code:

```
WebClient webClient = new WebClient(BrowserVersion.FIREFOX_3_6);
ProxyConfig proxyConfig = new ProxyConfig("localhost",8080);
proxyConfig.setSocksProxy(true);
webClient.setProxyConfig(proxy);
webClient.addRequestHeader("referer", "http://www.google.com");
webClient.setThrowExceptionOnScriptError(false);
webClient.setCssEnabled(false);
webClient.setJavaScriptEnabled(false);
HtmlPage page = webClient.getPage("https://somewebsite"); 
```

This should *not* work if I have no proxy running on 8080, but it does connect, just not through the proxy. In contrast, this crashes, like it should, when the proxy is not running:

```
HtmlPage page = webClient.getPage("http://somewebsite"); //not https 
```

Is this still a deficiency in htmlunit? Is there a good workaround or hack to get socks proxy working with https?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T02:19:15.300

这是 2.10 版中存在的错误，现在已在 2.11 版中修复

# c# - 如何使用 vim 构建或编译 VS2010/XNA4 项目？

> ID：13166329
> 
> 赞同：1
> 
> 时间：2012-10-31T19:43:17.730
> 
> 标签：c#, visual-studio-2010, vim

我玩过几个不同的插件来让 C# 在 vi​​m 中编译，即[Visual_studio.vim](http://www.plan10.com/vim/visual-studio/doc/1.2/)、 [vim-csharp](https://github.com/xandox/vim-csharp)和[vim-csharp](https://github.com/OrangeT/vim-csharp)，但唯一甚至开始编译的是 OrangeT 的[vim-csharp](https://github.com/OrangeT/vim-csharp)，但是当我在 XNA 解决方案上工作，未找到所有 XNA 参考：

```
The type or namespace name 'Xna' does not exist in the namespace 'Microsoft' (are you missing an assembly reference?) 
```

我可以做些什么来更好地使用 vim 使用 C#/XNA 吗？

如果相关：`Windows7x64bit VisualStudio2010 XNA4 Python2.7x64bit gVim73`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T20:04:05.343

@Reacher Gilt 有正确的想法，所以我想给他答案，但我的最终解决方案是使用`msbuild.exe`我`PATH`在某个时候添加到我的解决方案，并将其与[此解决方案](http://www.kevinberridge.com/2008/09/vim-c-compiling.html)结合以制作 build.bat 文件并`:make`由此而来。

1.  在我`*.sln`的文件夹中，我编写了一个`build.bat`文件，如下所示：`msbuild.exe "C:\path\to\*.sln"`
2.  `set makeprg=build.bat`
3.  **或者** `let &makeprg='"C:\path with spaces\build.bat"'` ，如果文件路径中有空格。这`let`不是`set`撇号，然后是路径周围的双引号，以及空格字符之前没有斜杠。
4.  `set errorformat=\ %#%f(%l\\\,%c):\ %m` 格式化错误消息。
5.  `:make`在该目录内的文件上
6.  `:cl`列出所有错误。

编辑：我不知道为什么，但把`&makeprg`你的 vimrc 似乎没有做任何事情。希望有人可以向我解释。您必须“手动”输入：`yy`切换到当前文件`<C-R>0<Bksp><CR>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T19:48:36.033

您使用的是 Windows，因此您始终可以选择使用 msbuild 在命令行上进行构建。我确定您在 vim 中可以运行一个宏来指定相对于当前缓冲区路径的项目。

命令行看起来像

```
C:\Windows\Microsoft.NET\Framework\(version)\msbuild.exe "project file path" 
```

这应该在构建时引入您的项目引用，这样您就可以避免这些错误。

# actionscript-3 - How to resolve a URLinto an IP (v4), port in ActionScript3?

> ID：13166335
> 
> 赞同：0
> 
> 时间：2012-10-31T19:43:43.250
> 
> 标签：actionscript-3, url, ip, resolver

I look for something alike `boost::asio::ip::tcp::resolver resolver` that would take a url like `google.com` in and return a list of IP adresses and ports pairs mapped to that URL. How to do such thing in ActionScript3?

# css - 有没有办法预先定义 SASS 观看的目录？

> ID：13166339
> 
> 赞同：1
> 
> 时间：2012-10-31T19:44:06.063
> 
> 标签：css, sass

我最近开始在我的 Web 开发中使用 SASS。到目前为止，我发现它是一个非常有用的实用程序，但是我遇到了一个小的可用性问题。

我正在处理的这个网站在多个位置都有 SASS 文件，例如`/css`在`/blog/css`.

目前，为了保持 sass 监视两个目录，我需要创建两个不同的终端选项卡并`sass --watch css/:css/`在一个和`sass --watch blog/css/:blog/css/`另一个上运行。

如果我能制作一个文件或以下格式的东西，那就太棒了：

```
css/:css/
blog/css/:blog/css/ 
```

然后只需将此配置文件传递给 sass 并让它监视两个位置。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:35:14.450

您可以使用[foreman](http://blog.daviddollar.org/2011/05/06/introducing-foreman.html)运行多个进程：

```
gem install foreman 
```

在根目录中创建一个`Procfile`并添加以下内容：

```
sass:  sass --watch css/:css/
sass: sass --watch blog/css/:blog/css/ 
```

要同时开始使用：

```
foreman start 
```

# text - how do i create a text on path?

> ID：13166340
> 
> 赞同：1
> 
> 时间：2012-10-31T19:44:06.103
> 
> 标签：text, background

i really want to know how to create texts in a background using corel draw 4, for example on some currencies and certificates, you may have, "Bank of Ghana, Bank of Ghana", written plenty in a wavy style with small sized fonts in the background or if its a school, you have the name of the school written plenty but small small font size in the background. Any help please??

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-02T06:32:55.457

如何根据示例在路径上创建文本

1.  绘制路径
2.  键入文本

例子 ![在此处输入图像描述](../Images/11dd8b8ae784bc03e6d2f8f11dd2d469.png)

3.  选择路径和分机

4.  单击菜单中的文本，然后单击使文本适合路径

例子 ![在此处输入图像描述](../Images/52b04cef2f98340d59f957f1ed2b4e21.png)

完成 ![在此处输入图像描述](../Images/cedbf2824d5704243ed217845ed559bb.png) 如果您觉得我的回答有帮助，请标记它，以便其他人可以从中受益。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-23T08:16:46.707

您可以沿开放对象（如线条）或封闭对象（如方形或圆形）的路径添加任何文本。

1.  绘制任何路径（圆、方、线）
2.  键入文本

[键入文本](https://i.stack.imgur.com/VNpek.jpg)

3.  使用挑选工具，选择一条路径。

[选择路径](https://i.stack.imgur.com/Cg0FW.jpg)

4.  单击文本 使文本适合路径。

[文本-​​> 适合路径](https://i.stack.imgur.com/6bqRF.jpg)

5.  您还可以通过单击这些图标来编辑适合路径的文本。

[编辑设置](https://i.stack.imgur.com/4BBwk.jpg)

# objective-c - 从 AVAssetWriter 读取实时 H.264 输出时数据损坏

> ID：13166341
> 
> 赞同：5
> 
> 时间：2012-10-31T19:44:08.393
> 
> 标签：objective-c, nsdata, grand-central-dispatch, h.264, avassetwriter

我正在使用一些技巧来尝试在将 AVAssetWriter 写入磁盘时读取它的原始输出。当我通过连接它们重新组装各个文件时，生成的文件与 AVAssetWriter 的输出文件的字节数完全相同。但是，重新组装的文件将无法在 QuickTime 中播放或被 FFmpeg 解析，因为存在数据损坏。这里和那里的几个字节已更改，导致生成的文件无法使用。我假设这发生在每次读取的 EOF 边界上，但这不是一致的损坏。

我计划最终使用与此类似的代码从编码器中解析出单个 H.264 NAL 单元，将它们打包并通过 RTP 发送，但是如果我不能信任从磁盘读取的数据，我可能不得不使用另一种解决方案.

此数据损坏是否有解释/修复？您是否找到了有关如何解析 NAL 单元以通过 RTP 打包的任何其他资源/链接？

完整代码在这里：[AVAppleEncoder.m](https://github.com/chrisballinger/FFmpeg-iOS-Encoder/blob/master/AVAppleEncoder.m)

```
// Modified from
// http://www.davidhamrick.com/2011/10/13/Monitoring-Files-With-GCD-Being-Edited-With-A-Text-Editor.html
- (void)watchOutputFileHandle
{
    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
    int fildes = open([[movieURL path] UTF8String], O_EVTONLY);

    source = dispatch_source_create(DISPATCH_SOURCE_TYPE_VNODE,fildes,
                                                              DISPATCH_VNODE_DELETE | DISPATCH_VNODE_WRITE | DISPATCH_VNODE_EXTEND | DISPATCH_VNODE_ATTRIB | DISPATCH_VNODE_LINK | DISPATCH_VNODE_RENAME | DISPATCH_VNODE_REVOKE,
                                                              queue);
    dispatch_source_set_event_handler(source, ^
                                      {
                                          unsigned long flags = dispatch_source_get_data(source);
                                          if(flags & DISPATCH_VNODE_DELETE)
                                          {
                                              dispatch_source_cancel(source);
                                              //[blockSelf watchStyleSheet:path];
                                          }
                                          if(flags & DISPATCH_VNODE_EXTEND)
                                          {
                                              //NSLog(@"File size changed");
                                              NSError *error = nil;
                                              NSFileHandle *fileHandle = [NSFileHandle fileHandleForReadingFromURL:movieURL error:&error];
                                              if (error) {
                                                  [self showError:error];
                                              }
                                              [fileHandle seekToFileOffset:fileOffset];
                                              NSData *newData = [fileHandle readDataToEndOfFile];
                                              if ([newData length] > 0) {
                                                  NSLog(@"newData (%lld): %d bytes", fileOffset, [newData length]);
                                                  NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
                                                  NSString *basePath = ([paths count] > 0) ? [paths objectAtIndex:0] : nil;
                                                  NSString *movieName = [NSString stringWithFormat:@"%d.%lld.%d.mp4", fileNumber, fileOffset, [newData length]];
                                                  NSString *path = [NSString stringWithFormat:@"%@/%@", basePath, movieName];
                                                  [newData writeToFile:path atomically:NO];
                                                  fileNumber++;
                                                  fileOffset = [fileHandle offsetInFile];
                                              }
                                          }
                                      });
    dispatch_source_set_cancel_handler(source, ^(void) 
                                       {
                                           close(fildes);
                                       });
    dispatch_resume(source);
} 
```

以下是我发现的一些类似问题，但不完全回答我的问题：

*   [从 iOS AVAssetWriter 生成的原始 H264 mdat 中获取 PTS](https://stackoverflow.com/questions/11087676/get-pts-from-raw-h264-mdat-generated-by-ios-avassetwriter)
*   [从 iPhone 流式传输视频](https://stackoverflow.com/questions/3444791/streaming-video-from-an-iphone)
*   [从 quicktime MOV 文件中解析 h.264 NAL 单元](https://stackoverflow.com/questions/11717538/parsing-h-264-nal-units-from-a-quicktime-mov-file)
*   [从 iPhone 到另一台设备（浏览器或 iPhone）的实时音频/视频流](https://stackoverflow.com/questions/5719538/realtime-audio-video-streaming-from-iphone-to-another-device-browser-or-iphone?lq=1)

当我最终弄清楚这一点时，我将发布一个开源库来帮助将来尝试这样做的人。

谢谢！

**更新：** EOF 边界不会发生损坏。似乎文件的某些部分在`finishWriting`被调用后被重写。第一个文件被分块为 4KB，因此更改的区域不在 EOF 边界附近。`movieFragmentInterval`启用时，它似乎在新的“moov”元素附近也已损坏。

![损坏的文件](../Images/bab867da743d3dc03f6a726bc5b8f2d2.png) 左边是正确的文件，右边是损坏的文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T20:36:02.563

在 iOS 上读取正在主动录制的 MOV 文件时，您必须检查提到的 4 个字节是否有更改，并重新写入这四个字节，然后检查文件中的附加数据，并发送附加数据。然后完成后，将文件截断为写入的文件大小。

显然，这取决于您将文件发送到哪里。我使用发送（偏移量，字节数）到接收器。所以我发送“附加数据”、“更多附加数据”、...、(24,4) 处的新数据、“更多附加数据”。

通常，iOS 仅在文件即将关闭时（也就是在最后一次媒体写入之后）写入 4 字节（数据部分的大小）记录。（参见“Quicktime atom”的信息）。不幸的是，这也意味着 MOV 文件在录制完成之前是不可播放的（并且电影描述符写在文件的末尾）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T01:18:30.680

我最终放弃了“边写边读”的方法，转而采用手动分块方法，`finishWriting`在后台线程上每 5 秒调用一次。[使用此处最初描述](https://stackoverflow.com/questions/3444791/streaming-video-from-an-iphone?lq=1#comment7593528_3484950)的方法，我能够丢弃可忽略不计的帧数：

```
- (void) segmentRecording:(NSTimer*)timer {
    AVAssetWriter *tempAssetWriter = self.assetWriter;
    AVAssetWriterInput *tempAudioEncoder = self.audioEncoder;
    AVAssetWriterInput *tempVideoEncoder = self.videoEncoder;
    self.assetWriter = queuedAssetWriter;
    self.audioEncoder = queuedAudioEncoder;
    self.videoEncoder = queuedVideoEncoder;
    //NSLog(@"Switching encoders");

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0), ^{
        [tempAudioEncoder markAsFinished];
        [tempVideoEncoder markAsFinished];
        if (tempAssetWriter.status == AVAssetWriterStatusWriting) {
            if(![tempAssetWriter finishWriting]) {
                [self showError:[tempAssetWriter error]];
            }
        }
        if (self.readyToRecordAudio && self.readyToRecordVideo) {
            NSError *error = nil;
            self.queuedAssetWriter = [[AVAssetWriter alloc] initWithURL:[self newMovieURL] fileType:(NSString *)kUTTypeMPEG4 error:&error];
            if (error) {
                [self showError:error];
            }
            self.queuedVideoEncoder = [self setupVideoEncoderWithAssetWriter:self.queuedAssetWriter formatDescription:videoFormatDescription bitsPerSecond:videoBPS];
            self.queuedAudioEncoder = [self setupAudioEncoderWithAssetWriter:self.queuedAssetWriter formatDescription:audioFormatDescription bitsPerSecond:audioBPS];
            //NSLog(@"Encoder switch finished");

        }
    });
} 
```

完整源代码：[https ://github.com/chrisballinger/FFmpeg-iOS-Encoder/blob/master/AVSegmentingAppleEncoder.m](https://github.com/chrisballinger/FFmpeg-iOS-Encoder/blob/master/AVSegmentingAppleEncoder.m)

# .net - 使用 MATLAB 通过 .net 从 SQL 读取一行

> ID：13166346
> 
> 赞同：2
> 
> 时间：2012-10-31T19:44:20.877
> 
> 标签：.net, sql, matlab

我正在尝试使用 MATLAB 通过 .net 从 SQL 表中读取特定行。我正在使用以下代码

```
import System.Data.SqlClient.*   
import DataTable.*  
NET.addAssembly('System.Data');  
sqlconn = System.Data.SqlClient.SqlConnection();  
sqlcmd = sqlconn.CreateCommand();      
conn = SqlConnection('Data Source=B39Q5M1;Initial Catalog=AIR;integrated  
i=1;  
list = [];  
conn.Open();  
q = SqlCommand(sqlstring, conn);   
r = q.ExecuteReader();  
while (r.read())  
r.GetString(0)  
end  
end 
```

但这会从行中获取单个元素。至少在这种情况下，我有一个解决方法来获取每个元素并将其设为数组。但更大的问题是我不知道表值是否是 int/string。在这种情况下，我不能盲目地使用 Getstring，因为如果值是 int 而不是 string，它会给我一个错误。请让我知道是否有任何方法可以获取完整的行。或者有什么解决方法吗？我在网站上搜索了很多，但所有示例都使用 GetString(0)。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:42:54.543

你能像这样格式化它吗：http: [//support.winhost.com/KB/a647/how-to-query-an-sql-database-with-net-sql-data-provider.aspx](http://support.winhost.com/KB/a647/how-to-query-an-sql-database-with-net-sql-data-provider.aspx)

应该有一种更简单的方法来构建您要使用的 SQL 语句。

[http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx](http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx) 这是 C# 的数据表库，所有的 get 和 table 命令都在这里，你绝对可以从数据库中检索数据它是 String 还是 Int。

看起来 GETROWTYPE() 是一种可以为您获取类型的方法，也许您可​​以使用它来确定是否需要使用 GetString ，直到您弄清楚要如何解决主要问题。

# validation - 在 XSLT Ant 任务中使用 Saxon 时有没有办法禁用验证？

> ID：13166349
> 
> 赞同：3
> 
> 时间：2012-10-31T19:44:39.097
> 
> 标签：validation, xslt, ant

我正在通过 Ant 的 XSLT 任务运行一些 XSL 转换。我使用 Saxon 9HE 作为处理引擎。我有一种情况，输入 XML 文件都使用相同的 DTD，但声明它位于不同的位置。有些声明它在当前目录中，有些在文件夹中，有些则引用 URL。这是蚂蚁脚本：

```
<?xml version="1.0" encoding="UTF-8"?>

<project name="PubXML2EHeader" default="transform">
    <property name="data.dir.input" value="./InputXML"/>
    <property name="data.dir.output" value="./converted-xml"/>
    <property name="xslt.processor.location" value="D:\\saxon9he.jar"/>
    <property name="xslt.processor.factory" value="net.sf.saxon.TransformerFactoryImpl"/>

    <path id="saxon9.classpath" location="${xslt.processor.location}"/>

    <target name="clean">
        <delete dir="${data.dir.output}" includes="*.xml" failonerror="no"/>
    </target>

    <target name="transform" depends="clean">
        <xslt destdir="${data.dir.output}"
              extension=".xml"
              failOnTransformationError="false"
              processor="trax"
              style="Transform.xsl"
              useImplicitFileset="false"
              classpathref="saxon9.classpath"
        >
            <outputproperty name="method" value="xml"/>
            <outputproperty name="indent" value="yes"/>
            <fileset dir="${data.dir.input}" includes="**/*.xml" excludes="Transform.xml"/>
            <factory name="${xslt.processor.factory}"/>
        </xslt>
    </target>

</project> 
```

当我运行这个 Ant 脚本时，我得到如下错误：

> [xslt]：致命错误！XML 解析器处理文件报告的 I/O 错误：/D:/annurev.biophys.093008.131228.xml： http: [//www.atypon.com/DTD/nlm-dtd/archivearticle.dtd](http://www.atypon.com/DTD/nlm-dtd/archivearticle.dtd)原因：java.io.FileNotFoundException： [http://www.atypon.com/DTD/nlm-dtd/archivearticle.dtd](http://www.atypon.com/DTD/nlm-dtd/archivearticle.dtd)

我认为这是因为撒克逊人无法访问 DTD（在这种情况下实际上是防火墙问题）。我不认为我关心验证输入，这就是我认为这里发生的事情，我想跳过它。是否可以向 XSLT Ant 任务添加一个属性来阻止 Saxon 尝试读取 DTD？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T21:47:54.107

您将“阅读 DTD”与验证混淆了。XSLT 处理器总是要求解析器读取文档的外部 DTD，无论它是否正在验证。这是因为 DTD 不仅用于验证，还用于验证。它也用于实体引用的扩展。

处理此问题的常用方法是将 DTD 引用重定向到可以访问它的某个副本，通常使用目录。这涉及在底层 XML 解析器上设置 EntityResolver。

网上有很多关于如何使用 Saxon 设置目录解析器的信息，通常来自命令行：例如，请参见此处： http: [//www.sagehill.net/docbookxsl/UseCatalog.html](http://www.sagehill.net/docbookxsl/UseCatalog.html)

建议通常是设置 -x、-y 和 -r 选项，但实际上，如果您只需要重定向源文档中的 DTD 引用，则只有 -x 相关（-y 影响样式表，-r 影响 document()功能）。在 Ant 中，设置 -x 选项的等价物是使用 factory 元素的属性 child 来设置配置属性`<attribute name="http://saxon.sf.net/feature/sourceParserClass" value="org.apache.xml.resolver.tools.ResolvingXMLReader"/>`。

这仍然留下了我觉得棘手的部分，这实际上是创建您的目录文件。

# java - 在 Eclipse 中使用 FileUtils

> ID：13166350
> 
> 赞同：26
> 
> 时间：2012-10-31T19:44:40.860
> 
> 标签：java, ant, jar, fileutils

尝试使用时`FileUtils`出现“无法解决”错误。

![在此处输入图像描述](../Images/61518cb9909ac17035e07471abf853fb.png)

那么，如何安装`FileUtils`库才能在 Eclipse 中使用它呢？我看到它是一个 Ant 实用程序，但我不确定需要安装多少个 jar。

![在此处输入图像描述](../Images/c2f497205e35de041aa7659a25656b6c.png)

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-10-31T19:48:02.270

打开项目的属性---> Java Build Path ---> Libraries tab ---> Add External Jars

将允许您添加罐子。

您需要[从这里下载 commonsIO](http://commons.apache.org/io/)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-05-10T11:06:28.727

现在 selenium 支持以下代码：

```
FileHandler.copy(src, dest); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-06-25T05:49:51.317

```
<!-- https://mvnrepository.com/artifact/org.apache.directory.studio/org.apache.commons.io -->
<dependency>
    <groupId>org.apache.directory.studio</groupId>
    <artifactId>org.apache.commons.io</artifactId>
    <version>2.4</version>
</dependency> 
```

在 pom.xml 文件中添加上述依赖项

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-28T20:41:39.477

我遇到了上述问题。我已经解决了如下。它对我来说工作正常。

1.  在导航到 [org.apache.commons.io.FileUtils] [ [http://www.java2s.com/Code/Jar/o/Downloadorgapachecommonsiojar.htm](http://www.java2s.com/Code/Jar/o/Downloadorgapachecommonsiojar.htm) ]时下载“org.apache.commons.io.jar”文件

2.  将下载的 zip 文件解压到指定文件夹。

3.  使用下面的导航更新项目属性右键单击项目>选择属性>选择Java构建路径>单击库选项卡>单击添加外部类文件夹按钮>选择为org.apache.commons.io.FileUtils提取zip文件的文件夹.zip 文件。

4.  现在访问文件实用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-24T05:11:38.647

`FileUtils`是 apache`org.apache.commons.io`包中的类，您需要下载`org.apache.commons.io.jar`然后`jar`在类路径中配置该文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-06-30T05:07:22.653

对于硒自动化用户

1.  [从http://www.java2s.com/Code/Jar/o/Downloadorgapachecommonsiojar.htm](http://www.java2s.com/Code/Jar/o/Downloadorgapachecommonsiojar.htm)下载库文件
2.  提炼
3.  右键单击资源管理器中的项目名称>>构建路径>>配置构建路径

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-27T09:23:56.543

而不是使用 FileUtils.copyfile(src,trg); 在 Selenium java FileHandler.copy(src, dest) 中使用以下内容；

# sql - SQL（访问）：每个“ID”有多个值 - 存储为 TRUE，除非有任何 FALSE

> ID：13166352
> 
> 赞同：3
> 
> 时间：2012-10-31T19:44:59.643
> 
> 标签：sql, ms-access

下午好！我最近遇到了一个问题，希望能在您的帮助下得到解决。我们的系统 [遗憾地] 在 Access (2007) 上运行。我在 SQL 方面有不错的经验，并选择将这种方法用于大多数查询而不是设计视图。但是，这是我最近遇到的问题：

一个表（当然有自己的主键）包含 ParticipantID 和 Records。由于在不同位置有事件，此表可能包含每个人的多条记录。有了这些信息，我们可以跟踪每条记录是否已经在我们的系统中，因为位置属于我们的大“伞”（内部）。为了让它看起来简单，它看起来像这样，忽略主键，因为我们只关心参与者 ID。

```
参与者 ID 内部
1 -1
1 -1
2 0
3 -1
3 -1
3 0
4 -1
4 0

```

我想能够说如果参与者的任何记录不是内部的（例如 = 0），那么在此查询的结果中，将其存储为 0。因此，结果表看起来像：

```
参与者 ID 内部
1 -1
2 0
3 0
4 0

```

这有意义吗？先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T19:49:35.010

您可以使用最大：

```
SELECT internal.ParticipantID, Max(internal.Internal) AS MaxOfInternal
FROM internal
GROUP BY internal.ParticipantID; 
```

我使用查询设计窗口构建了上述内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T19:54:13.140

如果值 Internal 只能是 0 和 -1，则以下可能会有所帮助

```
Select ParticipantID,max(internal) from thetable
Group by ParticipantID 
```

# jquery - JQuery Ajax-Call 类型：“POST”被服务器接收为“GET”

> ID：13166358
> 
> 赞同：3
> 
> 时间：2012-10-31T19:45:28.023
> 
> 标签：jquery, ajax, post, types

我的第一次服务器通信体验遇到了麻烦，希望得到帮助。

按照教程，我为网络服务器（跨域）创建了一个 ajax 调用。一切都很顺利，直到我尝试将类型从“GET”切换到“POST”：JQuery 仍然发送 get-requests（firebug-confirmed，服务器 r_print() 测试了 $_POST 和 $_GET）。

所以对我来说最大的问题是：我如何教 $.ajax 发送 POST？（是的，GET 可能会做，但这段代码不是我想要它做的，这会伤害我的感受）

我用一个简单的 HTML 表单检查了 PHP 端，该表单发送了一个带有预期结果的帖子。

我也添加了这一行：

```
 jQuery.ajaxSetup({ jsonp: null, jsonpCallback: null}); 
```

在没有积极结果的类似答案中提出。

**服务器代码 (PHP) 仅包含以下内容：**

```
echo("alert('".print_r($_POST)." -- + -- ".print_r($_GET)+"');"); 
```

**jQuery端：**

```
function executeRequest() {
$.ajax({
    type: "POST",
    url: "http://server/script",
    data:  ({ username: "test" }),
    dataType: "jsonp",
    jsonp: "jsonCallback",
    contentType: "application/json",
    jsonCallback: "jsonCallback",
});
 }
function jsonCallback(data) {
alert(data.username);
 } 
```

执行请求（）；

每一个帮助或提示 - 无论是关于改进我的搜索模式以及具体问题 - 都非常受欢迎:)

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T19:49:00.447

删除“jsonp”和“jsonCallback.”行。如果要使用回调，请按照 $.ajax 文档将 .done() 函数添加到 $.ajax：

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T19:46:10.743

JSONP 插入一个脚本标签，该标签从不同的域执行 Javascript，并且只支持 GET 请求，因为无论您想使用什么，都无法使用插入 DOM 的脚本标签进行 POST。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T19:46:21.273

JSONP 通过创建`<script>`标签来工作。
发送 JSONP POST 基本上是不可能的。

# cakephp - 从数组循环创建多个用户

> ID：13166362
> 
> 赞同：1
> 
> 时间：2012-10-31T19:45:42.227
> 
> 标签：cakephp, cakephp-1.3

如何从不同控制器中的数组创建多个新用户，比如在一个循环中？

我有一个问题，尝试在表单提交中创建多个用户失败，但创建一个新用户按设计工作。看来问题可能出在保存新用户然后将新的 user_id 带回 return 语句时。虽然新的 id 回来了，但后续用户（2nd、3rd 等）都获得了相同的 id 值，并且看起来后续的 $this->save 调用修改了第一个创建的用户而不是创建 add'l 的用户。任何新用户都不会出现在数据库中。（同样，只有在创建多个新用户时才会出现问题。）

我的一个小线索是，如果我在 importPublicLDAPUser() 函数 (user.php) 中的 var_dump($user) 就在`$user = $this->save(array('User' => array(`...`)));`之后，那么对于第一个元素，我会看到“修改”和“创建”，而我只看到其余的“修改”。这使我相信缺少一个步骤，例如在创建下一个用户之前需要保存或提交用户（？？）。

我之前尝试将其更改为`$user = $this->User->save(array('group_id' => 3, ...`并添加“create”：`$this->User->create();`但这些会产生错误“调用非对象上的成员函数 save()”和“调用非对象上的成员函数 create()”。

我的应用程序管理文档。每个文档可以有许多作者，因此它具有以下控制器：文档、文档类型、用户、组和作者。

输入新文档时，表单允许选择多个用户来创建“作者”记录。除了本地用户表之外，它还搜索我们的 LDAP 服务器（都通过自动建议）并允许输入文本字段。因此，作者选自

*   现有的用户表
*   通过 LDAP 助手
*   自由文本输入。

此结果是两个数组：$Authors（来自本地用户表）和 $badAuthors（LDAP 和文本输入），然后应用程序会在提交表单时尝试将其添加到本地用户表中。

如果满足以下条件，该表格就可以正常工作：

1.  从本地用户表中添加一个或多个作者；
2.  从 LDAP 添加单个作者（成功在用户表中创建新条目），以及零个或多个本地用户
3.  从文本输入添加单个作者（也成功），以及零个或多个本地用户

但是，如果添加了两个或更多非本地用户（$badAuthors 有多个元素），则表单将失败。“失败”意味着作者或用户保存例程失败，因此它跳过文档提交`$this->Docu->commit();`，我通过 ajaxResponse 吐出一个错误。因此，应用程序按设计工作，但一次只能输入一个新用户条目，即使表单设计为允许作者/坏作者大于 1。

我不明白的是，为什么当我遍历糟糕的作者时，如果 $badAuthors 有多个元素，为什么它不能正确添加用户。

当用户输入每个名称（通过 ajax 助手等针对用户表和 LDAP 进行检查）然后选择时，将构建一个 author_name_list 数组。进而：

```
foreach($this->params['form']['author_name_list'] as $author_name){
    $user_id = $this->Docu->User->field('id',array('User.name' => $author_name));
    if($user_id){
        $Authors['Author'][]=array(
            'docu_id'=>$this->Docu->id
            ,'user_id'=>$user_id
            );
    }else{
        $badAuthors[] = array('name'=>$author_name);
    }
 } 
```

所以 $badAuthors 现在是那些在 LDAP 中找到或手动输入的。

所以现在我尝试创建/保存所有 badAuthors ...

文档控制器（docu_controller.php）：

```
if(count($badAuthors)){
foreach($badAuthors as $key => $author){

    $this->Memo->User->create();  // ** <-- this was missing!! **

        if($ldap_author = $this->Docu->User->importPublicLDAPUser($author['name'])){
    unset($badAuthors[$key]);
    $Authors['Author'] []= array(
        'docu_id'=>$this->Docu->id
        ,'user_id'=>$ldap_author['User']['id']
        ,'precedence' => $author['precedence']
    );
    } elseif ($new_author = $this->Docu->User->newReadonlyUser($author['name'])) {
    unset($badAuthors[$key]);
    $Authors['Author'] []= array(
        'docu_id'=>$this->Docu->id
        ,'user_id'=>$new_author['User']['id']
        ,'precedence' => $author['precedence']
    );
    }
}
}

if(!count($badAuthors)){
    $authors_saved = true;
    foreach($Authors['Author'] as $author_arr){
       $this->Docu->Author->create();
       if(!$this->Docu->Author->save(array('Author' => $author_arr))){
            $authors_saved = false;
            break;
       }
    }
} 
```

用户模型（user.php）

```
function afterSave($created) {
    if (!$created) {
        $parent = $this->parentNode();
        $parent = $this->node($parent);
        $node = $this->node();
        $aro = $node[0];
        $aro['Aro']['parent_id'] = $parent[0]['Aro']['id'];
        $this->Aro->save($aro);
    }
}

function importPublicLDAPUser($cn){
    App::import('Vendor','adLDAP',array('file'=>'adLDAP.php'));
    $oLDAP = new adLDAP(Configure::read('LDAP_options.email'));
    $oLDAP->authenticate(NULL, NULL);

    $filter = '(&(cn='.$oLDAP->ldap_escape($cn).'))';

    $ldap_res = @$oLDAP->search($filter, array('cn', 'uid','profitcenter'),1);

    if(isset($ldap_res['count']) && ($ldap_res['count'] > 0)){//found it
    $user = $this->save(array('User' => array(
        'group_id' => 3,
        'name' => $ldap_res[0]['cn'][0],
        'username' => $ldap_res[0]['uid'][0],
        'grpnum' => pc2grpnum($ldap_res[0]['profitcenter'][0])
        )));                               

    if($user){
        $user['User']['id'] = $this->id;
    }
        return ($user ? $user : false);
    }else{
        return false;
    }
} 
```

有什么建议么？谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T19:36:38.013

事实证明，在我的 docu_controller.php 中，我错过了一个 create() 调用。似乎没有创建，当另一个控制器执行 commit() 时，仍然可以保存/创建对象。所以在添加 create() 之前，在提交之前，在以后的循环迭代中，我仍然在修改原始对象，而不是任何新对象。通过在控制器中添加一个 create，方法函数中的 save 作用于每个循环迭代的新用户。

在控制器中：

```
if(count($badAuthors)){
    foreach($badAuthors as $key => $author){
        $this->Memo->User->create();
            if($ldap_author = $this->Memo->User->importPublicLDAPUser($author['name'])){ 
```

在方法中：

```
function importPublicLDAPUser($cn){
    ....
    $user = $this->save(array('User' => array(... 
```

# php - 在 div 或自定义位置显示查询？

> ID：13166365
> 
> 赞同：0
> 
> 时间：2012-10-31T19:45:55.640
> 
> 标签：php, mysql, pdo

我怎么能在我的页面顶部有我的数据库连接信息，但查询与代码分开但仍然相关，以便我可以打印或回显在我可以放置在我网站上的任何位置的 Div 中显示检索到的图像？

```
<?php
$db = new PDO('mysql:host=host;dbname=dbname;charset=UTF-8', 'username', 'password');
$q = "SELECT badge1 FROM user_badges WHERE username='{$_SESSION['username']}' LIMIT 1";
$r = mysql_query($q);
$row = mysql_fetch_assoc($r);
$badge1 = $row['badge1'];

if($badge1 == "unlocked") {
 print "image if user has unlocked the badge";
  } else {
 print "image if user hasn't unlocked the badge";
}

?> 
```

我想将上述**if**和**else**语句放在一个 div 中，这样我就可以将查询中打印的图像放置在我网站上的任何位置。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:49:21.243

有几种方法。这是一个例子：

```
<?php
$db = new PDO('mysql:host=host;dbname=dbname;charset=UTF-8', 'username', 'password');
$q = "SELECT badge1 FROM user_badges WHERE username='{$_SESSION['username']}' LIMIT 1";
$r = mysql_query($q);
$row = mysql_fetch_assoc($r);
$badge1 = $row['badge1'];
?> 

//Break out of PHP and add any HTML elements you want

<div id="whatever">

<?php
if($badge1 == "unlocked") {
    print "image if user has unlocked the badge";
} else {
    print "image if user hasn't unlocked the badge";
}
?>
</div> 
```

ps 检查您的 PDO。混杂着旧`MySQL_`物

# ruby-on-rails - 在 Rails 3 中使用多个数据库会影响性能吗？

> ID：13166373
> 
> 赞同：0
> 
> 时间：2012-10-31T19:46:24.557
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

我目前正在使用具有行限制的heroku数据库的客户端，并且我们有一个记录活动的大表，因此在尝试了一些解决方案后，我发现我可以为单个模型使用不同的连接。

会不会对性能影响很大？我想我将使用 postgres 仅使用此表创建一个微型实例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:57:51.100

根据您的其他要求，这似乎可以很好地用于 Heroku 的 Postgres“跟随”功能，该功能创建一个只读实例来隐藏您的主数据库。更多信息：[Heroku Postgres 关注](https://devcenter.heroku.com/articles/heroku-postgresql#follow)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:45:44.107

不，拥有多个数据库连接不应影响性能。每个工作进程可能会使用更多的内存，但可能不足以引起关注。

我建立第二个数据库连接的方式是在 database.yml 中使用另一个节。除了开发和生产部分之外，您还可以在使用它的模型中引用“other_db”连接。如果您最终让多个模型使用另一个连接，您可能希望创建一个从 ActiveRecord::Base 继承的“超类”模型，并且只有建立连接行，并让实际模型继承自该模型。这样你就不会一直重复建立连接线。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-01T06:12:49.850

我认为如果您要为应用程序处理大量数据和多个租户，那么拥有多个数据库是一个好主意。我在我的 database.yml 中使用不同的部分。所以使用建立连接我将指向这个部分。所以这些特定模型将指向本节。我们也可以避免数据重复。

考虑我们有多个租户，每个租户都有不同的数据库。但是每个租户都有一些它使用的公共数据。所以对于这些模型，我们可以使用不同的数据库。这样所有租户都会从这个数据库中获取数据。因此我们可以避免数据重复也。

# java - 在Java中将短数组转换为有符号字节数组

> ID：13166375
> 
> 赞同：-1
> 
> 时间：2012-10-31T19:46:41.303
> 
> 标签：java, arrays, collections, byte, primitive

作为输入，我得到一个`short`像 {20、250、12、255} 这样的数组。
我需要将其转换为 byte[] {20,-6,12,-1}
我尝试使用 ByteBuffer：

```
 short[] data = {20, 250, 12, 255};     
    ByteBuffer dbuf = ByteBuffer.allocate(data.length*2);
    dbuf.asShortBuffer().put(data);
    byte[] array = dbuf.array(); 
```

但输出格式为：{0,20,0,-6,0,12,0,-1}
如何获得像 {20,-6,12,-1} 这样的有符号字节数组？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T19:50:33.483

只需简单地使用已签名的 byte[] 即可，因为 java 中的 byte 已被签名。如果您想要这样的输出，则无需转换为short。

* * *

如果您不能，以下只是转换机制。

循环遍历数组并进行向下转换。

```
 short[] data = { 20, 250, 12, 255 };
    byte[] bytes = new byte[data.length];
    int count = 0;
    for (short i : data) {
        bytes[count++] = (byte)i;
    }
    System.out.println(Arrays.toString(bytes)); 
```

输出：

```
[20, -6, 12, -1] 
```

# c# - OData Linq 到查询字符串

> ID：13166379
> 
> 赞同：12
> 
> 时间：2012-10-31T19:47:16.277
> 
> 标签：c#, linq, odata

我正在使用具有 OData 查询支持的 Web API (nighties)，虽然我知道 WCF 库使您能够查询 WCF RIA 服务 URL，但我正在寻找的是一种生成 Odata 查询字符串的轻量级方式像 LinqPad 一样，但更通用。

例如，如果我们知道服务返回特定类型的“ProductDTO”，我希望能够执行以下操作：

```
(from p in ODataSource<ProductDTO>
 where p.Name == "hi"
 select new {p.Model, Name}).ToODataQuery(); 
```

这将返回适当的 $filter 和 $select 命令作为可以附加到 URL 的字符串。

任何人都知道任何可以做这样的事情的图书馆吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-04-11T12:59:47.020

另一种可能性是在这里使用[Simple.OData.Client](https://github.com/object/Simple.OData.Client)作为大纲：[Can this library is used to generate the request url only?](https://github.com/object/Simple.OData.Client/issues/99) .

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-10-25T06:26:23.393

你可以试试这个：[https ://github.com/ubergeoff/HollowPoint.Azure](https://github.com/ubergeoff/HollowPoint.Azure)

```
ODataSource.Query()
.Where(t => t.Age >= 16 && t.Age < 33)
.ToODataString(); 
```

将输出 OData 查询文本：

```
((Age ge 16) and (Age lt 33)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-07T04:19:22.690

我没有使用它，但正在研究一个类似的主题，这看起来应该提供您正在寻找的功能： [https ://bitbucket.org/jjrdk/linq2rest/wiki/Home](https://bitbucket.org/jjrdk/linq2rest/wiki/Home)

这是一篇文章，展示了将其用作 oData 客户端： [http ://blog.petegoo.com/index.php/2012/03/11/creating-a-net-queryable-client-for-asp-net-web- api-odata-服务/](http://blog.petegoo.com/index.php/2012/03/11/creating-a-net-queryable-client-for-asp-net-web-api-odata-services/)

基于 wiki（而不是基于 linq2rest 的任何经验），它似乎是双向的 - LINQ 表达式到查询字符串，以及查询字符串到 LINQ 表达式。

# excel - 将字符串放入 Excel 电子表格时，它会使用科学记数法或四舍五入

> ID：13166380
> 
> 赞同：0
> 
> 时间：2012-10-31T19:47:21.440
> 
> 标签：excel, vb6

我正在将一个字符串放入excel。字符串通常只有数字，但可以包含字母字符或连字符等。

当我不设置数字格式或这样设置时（其中 xlSheet(0) 是 Excel.Worksheet）

```
xlSheet(0).Columns("N:N").EntireColumn.Columns.NumberFormat = "@" 
```

它以科学计数法输出。

当我使用此代码时：

```
xlSheet(0).Columns("N:N").EntireColumn.Columns.NumberFormat = "0" 
```

它将数字四舍五入到最接近的 100,000，这样最后五位数字不应该是 0。

应该是：1539648751235678942 但是是：1539648751235600000

带有连字符或字母的单元格不受影响并且工作正常。

任何帮助将不胜感激。

编辑：

我添加这样的数据：

我循环并放入`xlSheet(0).Cells(i, 14) = rs!value_number`

rs 是我的 ADODB.Recordset

EDIT2：Herbert Sitz 通过在文本前添加撇号得到它！谢谢大家。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T19:57:18.270

我认为问题在于您尝试输入的数字不能完全由 Excel 容纳。由于数字在内部存储的方式，Excel 对其显示/表示的数字有限制。在 Excel 的情况下，数字被限制为 15 位精度（请参阅[http://office.microsoft.com/en-us/excel-help/excel-specifications-and-limits-HP010073849.aspx](http://office.microsoft.com/en-us/excel-help/excel-specifications-and-limits-HP010073849.aspx)），这不足以代表您的数字。

您可以将数字输入为字符串（“152..42”），所有数字都会显示出来，但您将无法使用它执行精确的数学运算。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:06:04.863

对于数字，Excel 只能处理 15 位有效数字。

如果要存储超过 15 位长度的数字而不丢失数据，则必须将数据存储为文本。

Doing what you've been doing will resolve the issue:

You can do either of the following to add your numbers as text:

```
xlSheet(0).Cells(i, 14).Numberformat = "@"
xlSheet(0).Cells(i, 14) = rs!value_number 
```

Or

```
xlSheet(0).Cells(i, 14) = "'" & rs!value_number 
```

# java - 将字符串解析为双精度 - java

> ID：13166386
> 
> 赞同：2
> 
> 时间：2012-10-31T19:47:56.340
> 
> 标签：java, string, parsing, double, bank

对于一个项目，我有一个类似于银行的程序。“银行”读入一个文件，其中包含如下所示的帐户：
Miller
William
00001
891692 06 <----需要转换为双精度
的字符串 最后一个字符串必须转换为双精度，以便程序可以对其进行加减法等计算。
而且我必须以货币格式打印出来，即 $891692.06

到目前为止我有这个：

```
 public class Account {
      private String firstName, lastName;
      private int accountID;
      private String currentBalance; 

      private static int maxAccountID;

      public Account(String fN, String lN, int acct, String bal) {
         firstName = fN; lastName = lN;
         accountID = acct;
         currentBalance = bal;
         if(accountID > Account.maxAccountID)
            Account.maxAccountID = accountID;
      }     

  public double getBalance(){
        String [] s = currentBalance.split(" ");
        String balStr = "$"+s[0]+"."+s[1];
            double currentBalance = Double.parseDouble(balStr);
         return currentBalance;
      }
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-31T19:52:04.153

如果您的字符串表示`double`使用空格`' '`而不是小数点，您可以通过用点替换空格来修复它，如下所示：

```
String currentBalanceStr = "891692 06";
double currentBalanceDbl = Double.parseDouble(currentBalanceStr.replaceAll(" ",".")); 
```

[链接到ideone。](http://ideone.com/IYsn7d)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T20:09:42.783

`Double`用于余额计算不是一个好主意，使用 更有意义，因为`BigDecimal`它更精确。

您还可以使用以下类添加货币：

```
Locale enUSLocale =
    new Locale.Builder().setLanguage("en").setRegion("US").build();

Currency currencyInstance = Currency.getInstance(enUSLocale);

System.out.println(
    "Symbol for US Dollar, en-US locale: " +
    currencyInstance.getSymbol(enUSLocale)); 
```

请通过[此链接](http://docs.oracle.com/javase/tutorial/i18n/format/numberFormat.html)了解更多详细信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-24T10:51:12.833

好像你在做一些货币计算，所以总是使用 BigDecimal

```
BigDecimal balStr = new BigDecimal(String.replaceAll(" ","."); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T19:49:40.563

```
String s="891692 06";
Double.parseDouble(s.replace(" ", ".")); would do the trick 
```

您可以使用API 中的[NumberFormatClass](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/NumberFormat.html)来获取货币信息。

# javascript - 如何确定html div元素是否已完成加载

> ID：13166387
> 
> 赞同：1
> 
> 时间：2012-10-31T19:47:57.480
> 
> 标签：javascript, jquery, modal-dialog

单击 jsp (1.jsp) 中的加载按钮时，另一个 jsp(2.jsp) 会加载到原始 jsp(1.jsp) 的 div 元素中。这个加载的 div jsp 有一些大的数据表和 html 元素，需要一些时间来配置（几秒钟）。在此期间，向用户显示加载对话框或等待屏幕会很有用，因为 jsp 尚未完全准备好。我尝试使用 jquery modal 以及 jquery show/hide 如下

```
 $("#loadpage").show();       
   $("#divElement").load("2.jsp");               
   $("#loadpage").hide(); 
```

但问题是在 2.jsp 完全加载之前调用了 hide()。如何保持加载 gif 直到 2.jsp 完全加载？？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T19:50:14.370

只需使用加载函数的回调函数即可

```
 $("#divElement").load("2.jsp", function () {
     $("#loadpage").hide();
 }); 
```

> 回调函数 如果提供了“完成”回调，则在后处理和 HTML 插入完成后执行。回调会为 jQuery 集合中的每个元素触发一次，并依次设置为每个 DOM 元素。

有关更多信息，您可以查看[加载的 JQuery 文档](http://api.jquery.com/load/)

**编辑**（评论后）：如果要检查错误，可以通过以下方式实现该功能：

```
function(response, status, xhr) {
    if (status == "error") {
        // Do something on error
    } else {
        $("#loadpage").hide();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T19:50:11.110

您可以在负载中传递一个函数。一旦 2.jsp 下载完成，它将被调用。

```
 $("#divElement").load("2.jsp", function(){

         // content is loaded
  }); 
```

# asp.net - 将非英语字符串放入 CouchBase JSON 文档时出现乱码

> ID：13166391
> 
> 赞同：2
> 
> 时间：2012-10-31T19:48:31.453
> 
> 标签：asp.net, json, serialization, couchbase

我正在尝试将 .NET 序列化 JSON 文档插入到 CouchBase，但会出现非英文字符的乱码。

我试着说：

```
name = " الفورية مترجم نصوص مجاني إلى " 
```

但我得到：

```
"name": " ״§„ˆ״±״© …״×״±״¬… †״µˆ״µ …״¬״§† ״¥„‰ ", 
```

在 CouchBase 管理页面中查看它时。

有什么解决办法吗？

我正在使用 ASP.NET 4.5 和最新的 CouchBase API 和 CouchBase 2.0 beta。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T16:35:23.150

还注意到[http://www.couchbase.com/forums/thread/gibrish-non-english-characters-using-c-client-and-coucbase-2-0-beta](http://www.couchbase.com/forums/thread/gibrish-non-english-characters-using-c-client-and-coucbase-2-0-beta)，但复制到这里以供参考：

嗨伊丹姆

.NET 客户端使用 UTF-8 存储字符串。您是否正确看到来自客户端的数据，或者管理控制台中的字符串是否混淆？

此外，您可以尝试使用 Newtonsoft.JSON 进行 Json 序列化的新扩展方法。在 .NET Couchbase Client Beta 中，您会发现 Couchbase.Extensions 具有以下类：

```
public static class CouchbaseClientExtensions
{
    public static bool StoreJson(this CouchbaseClient client, StoreMode storeMode, string key, object value)
    {
        var json = JsonConvert.SerializeObject(value);
        return client.Store(storeMode, key, json);
    }

    public static T GetJson<T>(this CouchbaseClient client, string key) where T : class
    {
        var json = client.Get<string>(key);
        return json == null ? null : JsonConvert.DeserializeObject<T>(json);
    }
} 
```

您正在使用的扩展中的 Encoding.Default.GetBytes 似乎有可能在这里出错......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T02:38:16.243

虽然我不熟悉 Couchbase 存储系统，但您肯定会遇到文本编码问题。我会检查您的 JSON 序列化程序是否正在序列化为 UTF-8 编码，并确保您在 Couchbase 端指定 UTF-8 编码。检查它们的 API 和存储类型以确保它们是基于 UTF-8 的。

# c++ - QBitArray 移位

> ID：13166393
> 
> 赞同：1
> 
> 时间：2012-10-31T19:48:33.953
> 
> 标签：c++, qt, bit-manipulation, bit-shift

如何在 QT 中移动 QBitArray？

例如，我有*0010000*我想向左移动，所以我会得到*0100000*。[QT 的](http://harmattan-dev.nokia.com/docs/library/html/qt4/qbitarray.html)有关 QBitArray的文档中没有此功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T19:55:14.090

QBitArray 的目的是将它用于任意大小的位掩码，而不是用于算术运算。您不能移动 QBitArray。如果你认为你需要改变一个 QBitArray，那么你很可能是在滥用这个类而不是使用它。

# python - 填写文本类型的输入并使用python按提交

> ID：13166395
> 
> 赞同：15
> 
> 时间：2012-10-31T19:48:38.893
> 
> 标签：python, html, python-2.7, beautifulsoup

我有这个html：

```
<input type="text" class="txtSearch">
<input type="submit" value="Search" class="sbtSearch"> 
```

我需要的是在文本字段中写入，然后单击使用 python 提交。输入标签不在**Form**内。我怎么能那样做？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-31T20:56:06.190

您不必实际填充字段并“单击”提交。您可以模拟提交并获得所需的结果。

在 Firefox 中与 firebug 一起使用[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)和 urllib。使用 firebug 观察网络流量，并从提交正在执行的 HTTP POST 中获取 post 参数。创建一个 dict 并对其进行 url 编码。将它与您的 url 请求一起传递。

例如：

```
from BeautifulSoup import BeautifulSoup
import urllib

post_params = {
    param1 : val1,
    param2 : val2,
    param3 : val3
        }
post_args = urllib.urlencode(post_params)

url = 'http://www.website.com/'
fp = urllib.urlopen(url, post_args)
soup = BeautifulSoup(fp) 
```

该参数`vals`将根据您尝试提交的内容而更改。在您的代码中进行适当的调整。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-31T21:04:12.707

Here's a selenium solution if you actually need to populate the fields. You would typically only need this for testing purposes, though.

```
from selenium import webdriver

webpage = r"https://www.yourwebsite.com/" # edit me
searchterm = "Hurricane Sandy" # edit me

driver = webdriver.Chrome()
driver.get(webpage)

sbox = driver.find_element_by_class_name("txtSearch")
sbox.send_keys(searchterm)

submit = driver.find_element_by_class_name("sbtSearch")
submit.click() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-04-17T14:32:32.313

**UPDATED** 2019 answer. This code also takes care of the `HTTP 403 Forbidden` errors.

```
import urllib.request as urlRequest
import urllib.parse as urlParse

url = "https://yoururl.com"
values = {"name": "value"}

# pretend to be a chrome 47 browser on a windows 10 machine
headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.106 Safari/537.36"}

# encode values for the url
params = urlParse.urlencode(values).encode("utf-8")

# create the url
targetUrl = urlRequest.Request(url=url, data=params, headers=headers)

# open the url
x  = urlRequest.urlopen(targetUrl)

# read the response
respone = x.read()
print(respone) 
```

# iphone - EKCalendarChooser 进入“编辑日历”模式，而不是选择模式。有小费吗？

> ID：13166396
> 
> 赞同：0
> 
> 时间：2012-10-31T19:48:40.107
> 
> 标签：iphone, ipad, ios5, ios6, ekeventkit

在“EKCalendarChooserSelectionStyleSingle”模式下使用 EKCalendarChooser，我得到了它，但它总是出现“编辑日历”模式。这不能让我选择一个，只能编辑/重命名/删除日历。

关于我可以尝试什么的任何提示？我已经尝试将“setEditing”设置为 NO/YES 没有区别，打开/关闭完成/取消按钮，我正在尝试这一切，但继续获得编辑模式。

感谢您的任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-30T14:34:31.643

您根本不能调用“setEditing”，然后您将获得选择模式。我确实遇到了同样的陷阱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-11T10:34:00.093

```
EKCalendarChooser *calendarList = [[EKCalendarChooser alloc] initWithSelectionStyle:EKCalendarChooserSelectionStyleSingle displayStyle:EKCalendarChooserDisplayAllCalendars entityType:EKEntityTypeEvent eventStore:ekEventStore];
calendarList.delegate = self;
calendarList.showsDoneButton = YES;
calendarList.editing = YES; <============================(Remove this line) 
```

# java - 使用 2D 图形在 Java 中绘制随机点

> ID：13166399
> 
> 赞同：3
> 
> 时间：2012-10-31T19:48:46.233
> 
> 标签：java, graphic

我是 java Graphics 的初学者，我一直在尝试在 JFrame 上绘制随机点，但不知道为什么当我编译时 Frame 上什么都没有，对我来说逻辑很好+没有错误。有人可以帮我这里有什么问题吗

```
public class parent extends JPanel {    

    public void PaintComponent (Graphics g)     
    {
        super.paintComponent(g);
        Graphics2D g2d  = (Graphics2D) g;
        g2d.setColor(Color.blue);
        Dimension size = getSize();
        Insets  insets= getInsets();
        int w =  size.width - insets.left - insets.right;
        int h =  size.height - insets.top - insets.bottom;
        Random r = new Random();

        for (int i=0; i<1000; i++) {
           int x = Math.abs(r.nextInt()) % w;
           int y = Math.abs(r.nextInt()) % h;
           g2d.drawLine(x, y, x, y);
        }
    }

    public static void main(String[] args) 
    {
        JFrame frame = new JFrame("Points");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add(new parent());
        frame.setSize(250, 200);
        frame.setVisible(true);
     }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T19:54:08.573

是这样`PaintComponent`还是应该这样`paintComponent`？我想我知道 Java 开发人员会选择哪一个。

请注意，这是一个`@Override`在注释中会在 Eclipse 中捕获的完美错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:01:01.140

从您的代码中，您正在使用 DrawLine 从 (x, y) 绘制到 (x, y)。这将是一个像素。你已经设置了蓝色。因此，无论颜色如何，它都不会很明显。

但除此之外，您的循环根据随机数 R 计算 X 和 Y 值，但 R 永远不会重新计算为新的随机数（您在循环之前设置一次，并且永远不会重置它）。因此，它将一遍又一遍地重新绘制同一点 1,000 次。

如果你把随机数计算放在循环中，让它在你的随机点周围画一个半径为 5-10 像素的圆，它会更明显。然后你应该在实现你的目标的路上。

# install4j - 如何根据 Windows 批处理命令错误级别让 install4j 安装程序失败

> ID：13166400
> 
> 赞同：0
> 
> 时间：2012-10-31T19:48:54.287
> 
> 标签：install4j

作为我的安装程序的一部分，我有一个运行 sql 的 Windows 批处理 cmd *.cmd 文件。当 sql 失败时，此脚本返回正确的非零返回码。我无法让我的 install4j 安装程序识别返回码。

我尝试了两件事：

1.  我尝试简单地将“运行批处理文件”操作中的失败策略设置为“失败时退出”，但这不起作用。
2.  我尝试在变量（sqlReturnCode）中设置返回码的值并在后续操作中检查该变量，但没有成功。

当我检查安装日志时，我看到来自 stderr 的 SQL 错误被重定向到日志，但无论它是成功还是失败，我都会看到：

[INFO] com.install4j.runtime.beans.actions.misc.RunExecutableAction [ID 72]：变量已更改：**sqlReturnCode=0** [class java.lang.Integer]

它总是将该变量设置为零。我没有选中“显示控制台窗口”选项。这是一个已知的错误？我该如何解决/解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T15:04:11.573

这最终成为正在执行的 cmd 脚本的问题。正在设置 ERRORLEVEL enivonrmental 变量，但未调用“exit /b %ERRORLEVEL%”。

Install4j 依赖于使用 exit 命令设置的正确错误级别。

# java - 面板内绘制的图像似乎有错误的 x,y 偏移

> ID：13166402
> 
> 赞同：0
> 
> 时间：2012-10-31T19:49:14.923
> 
> 标签：java, swing, jmenubar

所以，我有一个带有菜单、工具栏和面板的 JFrame。我在面板中加载图像，但出于某种奇怪的原因（至少对我而言），它们没有正确显示在面板中。有时它们从工具栏下方开始，有时在上方。此外，图像在底部被切割。该代码是可以编译和测试的完整示例中的一个干净示例。提前致谢。

包含框架的类：

```
 import java.awt.BorderLayout;
    import java.awt.Color;
    import java.awt.Dimension;
    import java.awt.FileDialog;

    import java.awt.Toolkit;
    import java.awt.event.ActionEvent;
    import java.awt.event.ActionListener;
    import java.awt.image.BufferedImage;
    import java.io.BufferedInputStream;
    import java.io.File;
    import java.io.FileInputStream;
    import java.io.IOException;
    import java.util.zip.ZipInputStream;

    import javax.imageio.ImageIO;
    import javax.swing.BorderFactory;
    import javax.swing.JButton;
    import javax.swing.JFileChooser;
    import javax.swing.JFrame;
    import javax.swing.JMenu;
    import javax.swing.JMenuBar;
    import javax.swing.JMenuItem;
    import javax.swing.JPanel;
    import javax.swing.JToolBar;
    import javax.swing.border.BevelBorder;
    import javax.swing.border.Border;
    public class SSCE extends JFrame {
        private JComicPanel panel;
        private JToolBar toolbar;
        private JButton buttonZoom;
        private JButton buttonPrev;
        private JButton buttonNext;
        private JMenuBar menuBar;

        private Dimension dim;
        private BufferedImage img;
        private int currentPage;
        private JFrame parentFrame;

                public SSCE(){

                    super("JComic");
                    BorderLayout layout = new BorderLayout();
                    setLayout(layout);

                    dim = Toolkit.getDefaultToolkit().getScreenSize();

                    setSize((int)(dim.width /2.5),dim.height);

                    this.setPreferredSize(new Dimension((int) (dim.width /2.5),dim.height));

                    createToolbar();
                    createPanel();

                    add(toolbar,BorderLayout.NORTH);    

                    add(panel,BorderLayout.CENTER);

                    createMenu();
                    add(menuBar);
                    setJMenuBar(menuBar);
                    panel.setVisible(true);
                    img = null;
                    pack();
                    parentFrame = this;

                }

                private void createPanel(){
                    Border raisedbevel, loweredbevel;
                    raisedbevel = BorderFactory.createRaisedBevelBorder();
                    loweredbevel = BorderFactory.createLoweredBevelBorder();
                    panel = new JComicPanel(img);
                    panel.setBorder(BorderFactory.createCompoundBorder(raisedbevel,loweredbevel));

                }
                private void createToolbar(){
                    toolbar = new JToolBar();
                    toolbar.setPreferredSize(new Dimension(dim.width,45));  
                    toolbar.setFloatable(false);
                    buttonZoom = new JButton("+");

                    toolbar.add(buttonZoom);
                    buttonPrev = new JButton("<-");
                    toolbar.add(buttonPrev);
                    buttonNext = new JButton("->");
                    toolbar.add(buttonNext);
                    toolbar.setBackground(Color.RED);

                }
                private void createMenu(){
                    JMenu menuFile,menuJComic;
                    JMenuItem fileOpen; 
                    JMenuItem quitJComic,aboutJComic;

                    menuBar = new JMenuBar();
                    menuJComic = new JMenu("JComic");
                    aboutJComic = new JMenuItem("About JComic...");
                    menuJComic.add(aboutJComic);
                    quitJComic = new JMenuItem("Quit");
                    quitJComic.addActionListener(
                            new ActionListener(){
                                public void actionPerformed(ActionEvent e) {
                                    System.exit(0);
                                }
                            }
                            );
                    menuJComic.add(quitJComic);

                    menuBar.add(menuJComic);

                    menuFile = new JMenu("File");

                    fileOpen = new JMenuItem("Open...");
                    fileOpen.addActionListener(
                            new ActionListener(){
                                public void actionPerformed(ActionEvent e) {
                                    try {

                                        img = ImageIO.read(new File("superman.jpg"));
                                        currentPage = 1;

                                        int offset = menuBar.getHeight() + toolbar.getHeight();
                                        panel.setImage(img,parentFrame,offset);

                                    }
                                    catch (IOException e1) {
                                        System.out.println(e1.getMessage());
                                    }

                                }
                            }
                            );

                    menuFile.add(fileOpen);
                    menuBar.add(menuFile);

                }

        /**
         * @param args
         */
        @SuppressWarnings("deprecation")
        public static void main(String[] args) {
            // TODO Auto-generated method stub
            SSCE f = new SSCE();
            f.show();

        }

    } 
```

面板类

```
 import java.awt.Color;
    import java.awt.Dimension;
    import java.awt.Graphics;
    import java.awt.Graphics2D;
    import java.awt.Image;
    import java.awt.RenderingHints;
    import java.awt.event.ComponentAdapter;
    import java.awt.event.ComponentEvent;
    import java.awt.image.BufferedImage;
    import java.io.File;

    import javax.imageio.ImageIO;
    import javax.swing.JFrame;
    import javax.swing.JPanel;

    public class JComicPanel extends JPanel{
        private BufferedImage img;
        private int offset;
        private final float scaling = 0.5f;
        public JComicPanel(BufferedImage img){
            super();
            this.img = img;
            addComponentListener(new ComponentAdapter() {
                @Override
                public void componentResized(ComponentEvent e)
                {
                    repaint();
                }
            });

        }

         public void setImage(BufferedImage img,JFrame parentFrame,int offset){

             try{

                 int w = img.getWidth();
                 int h = img.getHeight();
                 int newW = (int)(w * scaling);
                 int newH = (int)(h * scaling);
                 BufferedImage dimg =  new BufferedImage(newW, newH, img.getType());  
                 Graphics2D g = dimg.createGraphics();  
                 g.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);  
                 g.drawImage(img, 0, 0, newW, newH, 0, 0, w, h, null);  
                 this.img = img;
                 System.out.printf("dim %d x %d",newW,newH);

                 this.setSize(new Dimension(newW,newH+offset));

                 parentFrame.pack();
             }
             catch(Exception e){
             }

         }

         public Dimension getPreferredSize(){

             return new Dimension(img.getWidth(),img.getHeight());
         }

        public void paintComponent(Graphics g){

               // Draw our Image object.
               super.paintComponent(g);
               g.drawImage(img,0,0,getSize().width,getSize().height, this); // at location 50,10
               System.out.println("painting 2");
              }

    } 
```

图片 superman.jpg 可以在这里找到[http://i50.tinypic.com/2yxnc3n.jpg](http://i50.tinypic.com/2yxnc3n.jpg)。如您所见，图像位于工具栏下方，但在我的完整代码中，它也在上方。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T22:11:48.853

让我们从这里开始...

```
public void setImage(BufferedImage img,JFrame parentFrame,int offset){
    try{
        // You're scaling the incoming image, which means you no longer
        // have a reference to the original image should you want to 
        // change that scale...
        // You're previous code...

        // Don't do this.  The parent container's layout manager will simple
        // override it, so it's useless...
        this.setSize(newW,newH);
        repaint();

        // This is a bad idea (personally)...
        parentFrame.setSize(newW,newH+offset);
    } catch(Exception e){
    }
 } 
```

以这种方式调用`setSize`将暂时允许组件采用您设置的大小。如果你在它之后调用`invalidate()`，组件实际上会被重新调整大小以满足布局管理器的要求。

更大的问题是您正在设置父框架的大小，但您不知道框架的其他组件的布局要求，例如工具栏、菜单栏和框架（例如）

这是在不考虑原始图像比例的情况下绘制图像

```
g.drawImage(img,0,0,getSize().width,getSize().height, this); 
```

正如建议的那样，在缩放图像后，将图像简单地设置为 JLabel 的图标可能会更容易，该 JLabel 已使用`BorderLayout`

您假设面板的大小是正确的，但它不会因为面板的布局管理器将接管。

这是多余的，因为 Swing 会在调整组件大小时自动重新绘制组件。

```
addComponentListener(new ComponentAdapter() {
    @Override
    public void componentResized(ComponentEvent e)
    {
        repaint();
    }
}); 
```

最好的办法是将图像窗格拖放到滚动窗格中，或者重新缩放图像以动态适应窗格的大小。

例如...

**可扩展页面**

![在此处输入图像描述](../Images/b24d879c4cdf3a0a0c076cdf76115da8.png)![在此处输入图像描述](../Images/cbc864b0ce660db26ef8b7893b7f43ea.png)

```
public class ComicPage {

    public static void main(String[] args) {
        new ComicPage();
    }

    public ComicPage() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                try {
                    BufferedImage page = ImageIO.read(getClass().getResource("/1346.gif"));
                    ComicPagePane comicPagePane = new ComicPagePane();
                    comicPagePane.setComicPage(page);

                    JFrame frame = new JFrame();
                    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                    frame.setLayout(new BorderLayout());
                    frame.add(comicPagePane);
                    frame.setSize(200, 200);
                    frame.setLocationRelativeTo(null);
                    frame.setVisible(true);
                } catch (Exception exp) {
                    exp.printStackTrace();
                }
            }
        });
    }

    public class ComicPagePane extends JPanel {

        private BufferedImage comicPage;
        private Image scaledInstance;

        public void setComicPage(BufferedImage page) {
            if (page != comicPage) {
                comicPage = page;
                scaledInstance = null;
                repaint();
            }
        }

        @Override
        public void invalidate() {
            scaledInstance = null;
            super.invalidate(); 
        }

        public BufferedImage getComicPage() {
            return comicPage;
        }

        public double getScaleFactor(int iMasterSize, int iTargetSize) {
            return (double) iTargetSize / (double) iMasterSize;
        }

        public double getScaleFactorToFit(BufferedImage img) {
            double dScale = 1d;

            double dScaleWidth = getScaleFactor(img.getWidth(), getWidth());
            double dScaleHeight = getScaleFactor(img.getHeight(), getHeight());

            dScale = Math.min(dScaleHeight, dScaleWidth);

            return dScale;
        }

        protected Image getScaledInstance(BufferedImage master) {
            if (scaledInstance == null) {
                double scaleFactor = getScaleFactorToFit(master);
                System.out.println("scaleFactor = " + NumberFormat.getNumberInstance().format(scaleFactor));

                // This is not the best scaling alorithm
                scaledInstance = master.getScaledInstance(
                        (int) Math.round(master.getWidth() * scaleFactor),
                        (int) Math.round(master.getHeight() * scaleFactor), Image.SCALE_SMOOTH);
            }
            return scaledInstance;
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);

            BufferedImage comicPage = getComicPage();
            if (comicPage != null) {
                Graphics2D g2d = (Graphics2D) g.create();

                int width = getWidth();
                int height = getHeight();

                // Normally, I would put this into a background worker as this
                // operation can be expensive....
                Image scaledInstance = getScaledInstance(comicPage);

                int x = (width - scaledInstance.getWidth(this)) / 2;
                int y = (height - scaledInstance.getHeight(this)) / 2;
                g2d.drawImage(scaledInstance, x, y, this);
                g2d.dispose();
            }
        }
    }
} 
```

**可滚动页面**

![在此处输入图像描述](../Images/e1f7ea8d9df3c192411312f4f746a2ad.png)

```
public class ScrollableComicPage {

    public static void main(String[] args) {
        new ScrollableComicPage();
    }

    public ScrollableComicPage() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                try {
                    BufferedImage page = ImageIO.read(getClass().getResource("/1346.gif"));
                    ComicPagePage comicPagePane = new ComicPagePage();
                    comicPagePane.setComicPage(page);

                    JFrame frame = new JFrame();
                    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                    frame.setLayout(new BorderLayout());
                    frame.add(new JScrollPane(comicPagePane));
                    frame.pack();
                    frame.setLocationRelativeTo(null);
                    frame.setVisible(true);
                } catch (Exception exp) {
                    exp.printStackTrace();
                }
            }
        });
    }

    public class ComicPagePage extends JPanel {

        private BufferedImage comicPage;

        @Override
        public Dimension getPreferredSize() {
            return comicPage != null ? new Dimension(comicPage.getWidth(), comicPage.getHeight()) : new Dimension(0, 0);
        }

        public void setComicPage(BufferedImage page) {
            if (page != comicPage) {

                comicPage = page;
                invalidate();
                repaint();
            }
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            if (comicPage != null) {
                Graphics2D g2d = (Graphics2D) g.create();
                g2d.drawImage(comicPage, 0, 0, this);
                g2d.dispose();
            }
        }
    }
} 
```

您可以阅读[Java：维护 JPanel 背景图像](https://stackoverflow.com/questions/11959758/java-maintaining-aspect-ratio-of-jpanel-background-image/11959928#11959928)的纵横比以获取有关缩放技术的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-01T10:57:24.883

技术原因是您暂时将 menuBar 添加到 contentPane 的中心，即与之前添加的面板相同的逻辑位置：

```
add(panel, BorderLayout.CENTER);
// following line is wrong - must be removed!!! 
add(menuBar); // no constraint == BorderLayout.CENTER
setJMenuBar(menuBar); 
```

这样做会使面板脱离 LayoutManager 的控制，但不会脱离面板 - 最终效果是它没有约束。

作为一个 menuBar（它需要添加到 rootPane 的 layeredPane，而不是 contentPane - 这就是它有自己的专用方法 setJMenuBar 的原因）并不特殊，中心的任何其他任意组件都会发生同样的混乱。

除此之外，我建议您清理代码：

*   删除*所有*setXXSize （[某些原因](https://stackoverflow.com/q/7229226/203657)）
*   决定框架是否应该以其首选（使用 pack）或任意固定大小（使用 setSize）出现。在大多数情况下，前者是正确的做法，后者有其用例——但两者都做没有意义
*   组件默认可见

# c# - httpwebrequest 编码错误

> ID：13166405
> 
> 赞同：0
> 
> 时间：2012-10-31T19:49:19.723
> 
> 标签：c#, httpwebrequest

我有时在我的 httpwebrequests 上遇到一个奇怪的错误。

我得到的错误：

```
ArgumentException was unhandled by user code
'' is not a supported encoding name. 
```

我正在运行的代码：

```
 try
        {
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);

            request.Timeout = 3000;
            request.ReadWriteTimeout = 3000;
            request.Proxy = new WebProxy(p.ToString(), true);

            response = (HttpWebResponse)request.GetResponse();
            Encoding responseEncoding = Encoding.GetEncoding(response.CharacterSet);
            using (StreamReader sr = new StreamReader(response.GetResponseStream(), responseEncoding))
            {
                if (response.StatusCode == HttpStatusCode.OK)
                {
                    // do stuff
                }
            }

        }
        catch (WebException wexc1)
        {
            if (wexc1.Status == WebExceptionStatus.ProtocolError)
            {
                return false;
            }

        }
        finally
        {
            if (response != null)
                response.Close();
        } 
```

它不会一直发生，就像 500 个请求中的 1 个一样。感觉就像代码无法确定实际编码..但我将如何处理呢？

该错误当前使应用程序崩溃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:04:53.283

您是否明确设置了请求的编码？就像是

```
Response.Charset = "windows-1252"; 
```

在 WebRequest 访问的页面中？如果 Web 服务器没有明确设置 CharacterSet，则它并不总是一致的。

您还可以检查 CharacterSet 为空的情况并替换为默认值，可能是“windows-1252”或任何适合您的 Web 服务器的编码。例子：

```
string charset = response.CharacterSet; 
if charset == "")
{
    charset = "windows-1252";
}
Encoding responseEncoding = Encoding.GetEncoding(charset); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:05:00.593

我假设在该行中引发了异常：

```
Encoding responseEncoding = Encoding.GetEncoding(response.CharacterSet); 
```

作为一个快速建议，我建议设置`Encoding.UTF8`或`response.ContentEncoding`作为流的编码，而不是依赖`response.CharacterSet()`.

CharacterSet 是 WebName（例如`Encoding.UTF8.WebName`），而不是编码的专有名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-07T21:30:51.310

对我来说，它有效

```
 private string GetHtmlFromResponse(HttpWebResponse response)
    {
        string sFicha = null;
        using (Stream s = response.GetResponseStream())
        {
            Encoding eCodificacion = Encoding.GetEncoding(response.CharacterSet);
            StreamReader sr = new StreamReader(s, eCodificacion);
            sFicha = sr.ReadToEnd();
            sr.Close();
        }

        return sFicha;
    } 
```

我正在下载一个西班牙语页面，字符 á、é、í、ó、ú、ñ 丢失了。使用此代码，我得到了正确的文本。

# django - Django 无法自动保存 DateTimeFields

> ID：13166412
> 
> 赞同：3
> 
> 时间：2012-10-31T19:49:45.470
> 
> 标签：django, django-models, django-admin

嗨，我有一个这样的模型：

```
from datetime import datetime

class Project(models.Model):
    created = models.DateTimeField(editable=False)
    updated = models.DateTimeField(editable=False)
    product = models.ForeignKey('tool.product')
    module = models.ForeignKey('tool.module')
    model = models.ForeignKey('tool.model')
    zipcode = models.IntegerField(max_length=5)

    def save(self, **kwargs):
        if not self.id:
            self.created = datetime.now()
        self.updated = datetime.now()
        super(Project, self).save()

    def __unicode__(self):
        return self.id 
```

但是，当我尝试保存项目时，我得到：

```
coercing to Unicode: need string or buffer, long found 
```

并从运行服务器：

```
RuntimeWarning: DateTimeField received a naive datetime (2012-10-31 14:45:36.611622) while time zone support is active. 
```

我不确定到底是什么问题，但我假设它与`timezone`妨碍保存`DateTimeField`.

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T19:55:18.937

首先 DateTimeField 支持这样的自动更新：

```
created = models.DateTimeField(editable=False, auto_now_add=True) # Only on creation
updated = models.DateTimeField(editable=False, auto_now=True)     # On every save 
```

其次，您获得的 RuntimeWarning 意味着您已在 settings.py 时区感知日期时间对象中启用，例如您将看到以下内容：

```
USE_TZ = True 
```

当你这样做时，你必须以不同的方式对待 datetime 对象，你必须显式地传递一个`tzinfo`值。

```
# install the `pytz` module through pip or whatnot
from pytz import timezone
import datetime
from django.utils.timezone import utc

now = datetime.datetime.utcnow().replace(tzinfo=utc)

# To show the time in Greece
athens = timezone('Europe/Athens')
print now.astimezone(athens) 
```

有关更多信息，请参阅[django 文档](https://docs.djangoproject.com/en/dev/topics/i18n/timezones/)和[pytz 文档](http://pytz.sourceforge.net/)。

关于`coercing to Unicode:`错误，请尝试这样做：

```
def __unicode__(self):
    return unicode(self.id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-04T06:22:53.487

我`now`在创建时所做的存储是使用`default`DateTimeField 的属性和[Django 的 now() 包装器](https://docs.djangoproject.com/en/1.6/ref/utils/#django.utils.timezone.now)，如下所示：

```
from django.utils import timezone

ctime = models.DateTimeField(default=timezone.now) 
```

请注意，此日期是 UTC 时区，如果您需要设置其他时区，请使用`timezone.now`调用[localtime()的 lambda](https://docs.djangoproject.com/en/1.6/ref/utils/#django.utils.timezone.localtime)

# jquery - jQuery .each() 方法在 Firefox 中不起作用

> ID：13166414
> 
> 赞同：6
> 
> 时间：2012-10-31T19:49:58.947
> 
> 标签：jquery, firefox, each

我有一个 each 方法，我正在利用它来启动一个`<td>`与其存在的相关的工具提示。在 IE、Chrome、Safari 中一切都很好，但 Firefox 完全缺少 each 方法，并且只启动 DOM 中的最后一个工具提示。

是什么赋予了？

[http://jsfiddle.net/yus5b/](http://jsfiddle.net/yus5b/)

HTML：

```
<div class="stage">
    <div class="dealFinder">
      <h2 class="title">Deal Finder in Your Area</h2>
      <table cellpadding="5">
          <tr>
          <td class="text">
              <p class="makeModel"><a href="#">2012 Land Rover Range Rover Evoque</a><br>in Oak Lawn</p>
            <a class="youSave" href="#" onclick="return false"> You Save at Least $14,810</a>
            <div class="tooltip">
              <div class="inner">
                <b>2012 Land Rover Range Rover Evoque</b>
                <span>Your Price $19,330</span>
                <p>The National Average is <b>$21,500</b></p>
              </div>
            </div>
          </td>
            <td class="pic">
              <a href="#"><img src="http://placehold.it/113x75" /></a>
          </td>
        </tr>
        <tr>
          <td class="text">
            <p class="makeModel"><a href="#">2012 Land Rover Range Rover Evoque</a><br>in Oak Lawn</p>
            <a class="youSave" href="#" onclick="return false"> You Save at Least $14,810</a>
            <div class="tooltip">
              <div class="inner">
                <b>2012 Land Rover Range Rover Evoque</b>
                <span><small>Your Price</small> $19,330</span>
                <p>The National Average is <b>$21,500</b></p>
              </div>
            </div>
          </td>
          <td class="pic">
            <a href="#"><img src="http://placehold.it/113x75" /></a>
          </td>
        </tr>
      </table>
    </div><!-- .dealFinder -->
</div>​ 
```

jQuery：

```
$(document).ready(function() {
    // Tooltip
    $('.tooltip').hide();
    $('.text').each(function(e) {
      var self = this;
      var tooltip = $(self).find('.tooltip');
      var youSave = $(self).find('.youSave');
      $(youSave).mouseenter(function(e) {
        $(self).find(tooltip).fadeIn("slow");
      });
      $(youSave).mouseleave(function(e) {
        $(self).find(tooltip).fadeOut("fast");
      });
    });
});​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T19:55:25.483

实际上几乎永远不需要每个函数迭代元素只是为了将它们绑定到事件处理程序：

```
$(document).ready(function() {
    $('.tooltip').hide();
    $('.youSave', '.text').on('mouseenter mouseleave', function() {
        $(this).next('.tooltip').fadeToggle('slow');
    });
});​ 
```

[**小提琴**](http://jsfiddle.net/yus5b/4/)

剩下的只是将工具提示放在按钮顶部的位置问题，应该可以用一点 CSS 修复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:02:59.460

首先它写得很奇怪。尝试 ：

```
$('.text .youSave').mouseenter(function(){
   var item = $(this);
   var tooltip = $('.tooltip', item.parent()).fadeIn();
});

//the same way for mouseleave 
```

并给出工具提示显示：默认情况下没有为什么用 js 更改它？

我看到了问题。工具提示淡入您的鼠标所在的位置以及触发事件 mouseleave。易于修复。工具提示必须是 .youSave 子元素：

```
 <a class="youSave" href="#" onclick="return false"><span> You Save at Least $14,810<span>
<div class="tooltip">
                  <div class="inner">
                    <b>2012 Land Rover Range Rover Evoque</b>
                    <span>Your Price $19,330</span>
                    <p>The Web2Carz National Average is <b>$21,500</b></p>
                  </div>
</a> 
```

然后是JS：

```
$('.text .youSave').mouseenter(function(){
   var item = $(this);
   var tooltip = $('.tooltip', item).fadeIn();
}); 
```

# java - Java GUI 指定文本字段的宽度

> ID：13166416
> 
> 赞同：1
> 
> 时间：2012-10-31T19:50:06.497
> 
> 标签：java, swing, user-interface, jtextfield

我有一个 BorderLayout，在 North、West 和 Center 组件中都有布局。这是我的问题：我的 Center 组件中有一个 textField，它扩展了它的父布局的整个宽度。

它看起来像这样......

```
===============================================================================
|                                                                             |
|                                NORTH                                        |
===============================================================================
|    WEST     |                  CENTER                                       |
|             | textField: __________________________________________________ | 
```

我想这样做，以便 textField 不会扩展整个布局，但具有固定大小并在中心组件内居中。

我试过设置preferredSize，但没有运气。下面的代码...

```
 rText = new JTextField("1000"); 
  rText.setPreferredSize(new Dimension(20, 10)); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T19:52:40.133

要将 JTextField 居中，将其放入自己的 JPanel 中，该 JPanel 使用默认的 FlowLayout 并使用容器添加（我认为）BorderLayout。为了给 JTextField 一个合适的宽度，在构造它时给它一个列大小。**不要**设置它的 preferredSize，因为它在不同的平台上表现不佳。IE，

```
rText = new JTextField("1000", 10); 
```

# java - IllegalMoniterStateException

> ID：13166417
> 
> 赞同：0
> 
> 时间：2012-10-31T19:50:07.277
> 
> 标签：java, multithreading, thread-safety

每当我调用 wait() 和 notify() 或 notifyAll() 时，我都会收到非法监视器状态异常。javadoc说如果我的线程“试图在对象的监视器上等待或通知其他线程在对象的监视器上等待而不拥有指定的监视器”，我应该得到那个异常。

但是，这是我在上面调用这些方法的代码示例。

```
//note that doSomething will be called by a thread from another class, not this one
public void doSomething(){
    while(objectsCurrentlyDoingSomething() >= thisClass'sCapacity){
         synchronized(objectLock){ //objectLock is created at top of class like this:
             wait(2000);           //private static final Object objectLock = new Object();
         }
    }

    //rest of code
} 
```

然后稍后我通过说如果对象完成，减少当前使用的对象数量和 notify() 来释放一个持有该锁的线程。

```
....object finished......
synchronized(objectLock){
    notify();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T19:54:38.067

您需要调用等待，并在 objectLock 上通知。

例如

`objectLock.wait()`

它你只是调用`wait()`你正在调用它`this`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T19:55:49.317

正如 z5h 所指出的，您对 wait() 和 notify() 的调用应该在 objectLock 对象上进行：

```
//note that doSomething will be called by a thread from another class, not this one
public void doSomething(){
    while(objectsCurrentlyDoingSomething() >= thisClass'sCapacity){
         synchronized(objectLock){ //objectLock is created at top of class like this:
             objectLock.wait(2000);           //private static final Object objectLock = new Object();
         }
    }

    //rest of code
} 
```

和

```
....object finished......
synchronized(objectLock){
    objectLock.notify();
} 
```

# css - css-tricks.com 媒体查询不起作用

> ID：13166418
> 
> 赞同：0
> 
> 时间：2012-10-31T19:50:09.170
> 
> 标签：css, media-queries

是否有一些使用媒体查询的新标准。或者我应该说，应该做出一些新的考虑。

[CSS 技巧文章](http://css-tricks.com/snippets/css/media-queries-for-standard-devices/)似乎效果不佳，因为“智能手机领域”似乎劫持了一切。

我直接使用的代码（除了打印屏幕应该是什么：

```
/* Smartphones (portrait and landscape) ----------- */
@media only screen 
and (min-device-width : 320px) 
and (max-device-width : 480px) {
.size:after{ content: "smartphone portrait and landscape";}
body{background-color:#111; color:#fff;}
}

/* Smartphones (landscape) ----------- */
@media only screen 
and (min-width : 321px) {
.size:after{ content: "smartphone landscape";}
body{background-color:#222; color:#fff;}
}

/* Smartphones (portrait) ----------- */
@media only screen 
and (max-width : 320px) {
.size:after{ content: "smartphones portrait";}
body{background-color:#333; color:#fff;}
}

/* iPads (portrait and landscape) ----------- */
@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) {
.size:after{ content: "ipad protrait and landscape";}
body{background-color:#444; color:#fff;}
}

/* iPads (landscape) ----------- */
@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) 
and (orientation : landscape) {
.size:after{ content: "ipad landscape";}
body{background-color:#555; color:#fff;}
}

/* iPads (portrait) ----------- */
@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) 
and (orientation : portrait) {
.size:after{ content: "iPads portrait";}
body{background-color:#666; color:#000;}
}

/* Desktops and laptops ----------- */
@media only screen 
and (min-width : 1224px) {
.size:after{ content: "desktops and laptops";}
body{background-color:#777; color:#000;}
}

/* Large screens ----------- */
@media only screen 
and (min-width : 1824px) {
.size:after{ content: "largscreens";}
body{background-color:#888; color:#000;}
}

/* iPhone 4 ----------- */
@media
only screen and (-webkit-min-device-pixel-ratio : 1.5),
only screen and (min-device-pixel-ratio : 1.5) {
.size:after{ content: "iPhone 4";}
body{background-color:#999; color:#000;}
} 
```

测试：www2.iscotest.com/screen.php

是否只有宽屏、桌面 (1024)、ipad 横向、ipad 纵向、移动纵向和移动横向的工作标准集。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:00:22.657

您的链接未显示，您是否添加了 css 元信息？

```
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:22:18.733

只需使用 min-width 和 max-width

# android - 需要应用程序等到进程完成然后继续

> ID：13166421
> 
> 赞同：2
> 
> 时间：2012-10-31T19:50:20.277
> 
> 标签：android, for-loop, sms, wait

我在这里阅读了很多关于这个问题的帖子，但我似乎无法让我的代码等到它找到联系人姓名后再继续并加载我的下一个活动。如果是短短信，它可以正常工作，但如果是特别长的短信，它会崩溃。请任何帮助。

**这是下面建议的新代码**问题仍然相同

```
 new LoaderAsyncTask().execute();

    }

public class LoaderAsyncTask extends AsyncTask<Void, Void, Void> {
    // Variables to pass data between doInBackground() and onPostExevute() here

    protected Void doInBackground(Void... params) {

         Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI,
                    Uri.encode(smsSender));
                Cursor cursor = ((Context) contexts).getContentResolver().query(uri,
                    new String[] { PhoneLookup.DISPLAY_NAME, PhoneLookup._ID },
                    null, null, null);
                contactId = "";
                name="unknown";
                if (cursor.moveToFirst()) {
                    do {
                    contactId = cursor.getString(cursor.getColumnIndex(PhoneLookup._ID));
                    name = cursor.getString(cursor.getColumnIndex(PhoneLookup.DISPLAY_NAME));

                    } while (cursor.moveToNext());
                }

        return null;
    }

    protected void onPostExecute(Void result) {
         ////////////////////////////////////
        // start a new task before dying

        intents.setClass((Context) contexts, SendSMSActivity.class);
        intents.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);

        // pass Serializable object
        intents.putExtra("PhoneNumber", smsSender);
        intents.putExtra("smsBody", smsBody);
        intents.putExtra("SmsMessageId", SmsMessageId);
        intents.putExtra("contactId", contactId);
        intents.putExtra("SenderName", name);
        // start UI
        ((Context) contexts).startActivity(intents);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:26:45.713

One solution would be to start an AsyncTask to get your Contact name. Then call `startActivity()` in the AsyncTask's `onPostExecute()` method, which runs back on the main UI thread. So in essence, you kick off an AsyncTask, let it get the contact name asynchronously, then call `startActivity()` only when it finishes.

Here's a nice tutorial: [http://www.vogella.com/articles/AndroidPerformance/article.html](http://www.vogella.com/articles/AndroidPerformance/article.html)

And the AsyncTask documentation: [http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

Scroll down to "Using AsyncTask" in this guide: [http://developer.android.com/guide/components/processes-and-threads.html#Threads](http://developer.android.com/guide/components/processes-and-threads.html#Threads)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T23:17:19.150

使用这样的东西：

```
public class ActivityA extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {

        new LoaderAsyncTask().execute();
    }

}

public class LoaderAsyncTask extends AsyncTask<Void, Void, Void> {
    // Variables to pass data between doInBackground() and onPostExevute() here

    @Override
    protected Integer doInBackground(Void... params) {

        // yoyr loader stuff here

        return null;
    }

    @Override
    protected void onPostExecute(Void result) {
        // update UI or call ActivityB here

         ////////////////////////////////////
        // start a new task before dying
        Intent = ... // not shown in your code
        intent.setClass(context, SendSMSActivity.class);
        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);

        // pass Serializable object
        intent.putExtra("PhoneNumber", smsSender);
        intent.putExtra("smsBody", smsBody);
        intent.putExtra("SmsMessageId", SmsMessageId);
        intent.putExtra("contactId", contactId);
        intent.putExtra("SenderName", name);
        // start UI
        context.startActivity(intent);
    }
} 
```

[查看 AsyncTask 文档以获取 http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)中该类的更详细说明

# java - 复制/传递 WebDriver 的实例如何工作，是否危险？

> ID：13166436
> 
> 赞同：7
> 
> 时间：2012-10-31T19:51:04.847
> 
> 标签：java, selenium, webdriver

几个月来，我一直在一个开发 Selenium WebDriver 基础架构的团队中工作，而我们从测试用例和页面对象访问驱动程序对象的方式让我很烦恼。

我们的测试用例创建一个新的 WebDriver 实例并打开浏览器。这个新实例存储在测试用例类中。

然后，测试用例实例化一个页面对象。与[Selenium 的 Page Object Pattern](http://code.google.com/p/selenium/wiki/PageObjects)一起，这些页面对象将 WebDriver 作为其构造函数中的参数（尽管我注意到在我们的版本中它不是最终的）。各种页面对象方法使用在页面对象的构造函数中设置的驱动程序来完成它们的工作。如果页面对象方法导航到新页面对象，则将 WebDriver 传递给它。就像在 Selenium 的例子中一样：

```
public class LoginPage {
    private final WebDriver driver;

    public LoginPage(WebDriver driver) {
        this.driver = driver;

        // Check that we're on the right page.
        if (!"Login".equals(driver.getTitle())) {
            // Alternatively, we could navigate to the login page, perhaps logging out first
            throw new IllegalStateException("This is not the login page");
        }
    }

    // Conceptually, the login page offers the user the service of being able to "log into"
    // the application using a user name and password. 
    public HomePage loginAs(String username, String password) {
        // This is the only place in the test code that "knows" how to enter these details
        driver.findElement(By.id("username")).sendKeys(username);
        driver.findElement(By.id("passwd")).sendKeys(password);
        driver.findElement(By.id("login")).submit();

        // Return a new page object representing the destination. Should the login page ever
        // go somewhere else (for example, a legal disclaimer) then changing the method signature
        // for this method will mean that all tests that rely on this behaviour won't compile.
        return new HomePage(driver);
    }
} 
```

这使得 WebDriver 实例看起来是唯一且重要的，就像必须从页面对象传递到页面对象的火炬一样。代码的风格让我认为我总是必须确保我使用的驱动程序实例与上次操作中使用的驱动程序实例相同。

但是，如果页面上有多个页面对象，并且页面对象方法不会返回您计划接下来使用的页面对象，这种“火炬传递”会变得复杂或不可能。当屏幕上有两个页面对象并且需要在它们之间交替时，如何在同一个 WebDriver 实例上进行操作，而无需切换到新页面或创建新页面对象？

所有这些困惑让我相信实际上没有必要传递火炬，甚至可能发生（所有这些页面对象都存储对同一个 WebDriver 实例的引用吗？），但是我不知道为什么在Selenium 给出的描述。

那么，我需要担心“传递火炬”吗？或者，任何页面对象在使用其 WebDriver 实例化后是否会正常运行，即使其他页面对象在此期间使用它们自己版本的同一 WebDriver 执行操作？

因为我们不会在任何给定时间为每个 JVM 使用多个 WebDriver，所以将 WebDriver 设置为一个可供所有人访问的单例会更容易/更好吗？然后我们根本不需要在构造函数中传递 WebDriver。提前感谢您的任何意见。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-01T06:12:07.137

最好将 webdriver 标记为整个框架的单例。我目前一直在使用这种模式，它工作正常。
**注意：处理并行执行时应小心。**

@CodeEnthusiastic 例如拿一个类`GeneralLibrary`，在其中创建一个`WebDriver`.

将页面对象模型中的类扩展`GeneralLibrary`为超类

# php - PHP - 用于将某些 HTML 标签列入白名单的插件或库

> ID：13166438
> 
> 赞同：0
> 
> 时间：2012-10-31T19:51:12.257
> 
> 标签：php, html, mysql, database, forms

我正在运行一个其他访问者可以发布的博客。我想允许某些 HTML 标签，如标题、换行符或链接。我可以为此使用什么好的或最好的插件软件？

此外，最好的做法是保存原始数据，然后在需要在博客中显示时将其列入白名单。或者我应该在将数据保存到数据库之前将其列入白名单，以便保存干净吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:53:50.597

内置功能[`strip_tags`](http://us2.php.net/manual/en/function.strip-tags.php)已经具有非常好的白名单功能。

至于存储，这是一个判断调用，但我建议将所有内容存储在其原始状态和编码仅用于显示。如果您认为您可能不小心忘记在显示器上进行剥离/编码，这只是一个问题。

# datetime - RavenDB 查询日期时间，集合偏移量中的值

> ID：13166439
> 
> 赞同：6
> 
> 时间：2012-10-31T19:51:15.017
> 
> 标签：datetime, ravendb

我正在尝试在 Datetime 上查询 RavenDB，该 Datetime 被集合中的条目所抵消。如下所示，我有一个 AppointmentReminder 对象，其中包含许多 AppointmentReminderJobs。我想查询 AppointmentReminders 应在哪里运行 AppointmentReminderJob。

我的模型如下：

```
public class AppointmentReminder
{
    public int Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string Email { get; set; }
    public string Phone { get; set; }
    public DateTime AppointmentDateTime { get; set; }
    public ReminderStatus ReminderStatus { get; set; }
    public List<AppointmentReminderJob> AppointmentReminderJobs { get; set; }
 }

public class AppointmentReminderJob
{
    public JobStatus JobStatus { get; set; }
    public int DaysPrior { get; set; }
} 
```

我的控制器并尝试检索具有当前要运行的作业的 AppointmentReminders 列表（我知道此 Where 子句不完整，但我试图简化它但没有运气）：

```
public ActionResult GetJobsQueuedListCurrent()
    {
        var jobsqueuedlist = RavenSession.Query<AppointmentReminder>()
            .Where(appointmentreminder => appointmentreminder.AppointmentReminderJobs.Any(x => appointmentreminder.AppointmentDateTime < DateTime.Now.AddDays(x.DaysPrior)))
            .OrderBy(appointmentreminder => appointmentreminder.AppointmentDateTime)
            .Take(20)
            .ToList();

        return View("List", jobsqueuedlist);

    } 
```

调用上述代码会产生以下响应：

```
variable 'x' of type 'ProjectName.Models.AppointmentReminderJob' referenced from scope '', but it is not defined 
```

我正在尝试像这样设置索引：

```
public class JobsQueuedListCurrent : AbstractIndexCreationTask<AppointmentReminder, JobsQueuedListCurrent.IndexResult>
{
    public class IndexResult
    {
        public int Id { get; set; }
        public DateTime JobDateTime { get; set; }
    }

    public JobsQueuedListCurrent()
    {

        Map = appointmentreminders => from appointmentreminder in appointmentreminders
                                      from job in appointmentreminder.AppointmentReminderJobs
                                      select new 
                                      { 
                                          Id = appointmentreminder.Id, 
                                          JobDateTime = appointmentreminder.AppointmentDateTime.AddDays(job.DaysPrior)
                                      };
        Store(x => x.Id, FieldStorage.Yes);
        Store(x => x.JobDateTime, FieldStorage.Yes);
    }
} 
```

现在，我正在使用以下方法查询并获得预期结果：

```
var jobsqueuedlist = RavenSession.Query<JobsQueuedListCurrent.IndexResult, JobsQueuedListCurrent>()
            .Where(x=>x.JobDateTime >= DateTime.Now)
            .As<AppointmentReminder>()
            .Take(20)
            .ToList();

        return View("List", jobsqueuedlist); 
```

我关于此的最后一个问题是，我的地图/索引肯定会导致同一文档 ID 的多个条目（约会提醒），但我的结果列表仅包含文档的 1 个实例。我对它的工作方式感到满意，我只是不确定我是否应该在我的代码中执行减少或做其他事情，或者只是让 Raven 处理它，就像它正在做的那样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-01T08:00:34.743

您不能创建这样的查询。这将要求 RavenDB 在查询期间执行计算，这是不允许的。RavenDB 只允许查询索引中的数据。

你*可以*做什么它在索引中设置计算，然后在*那个*上查询。

# c# - 如何删除字符串中的每个第二个字符？

> ID：13166443
> 
> 赞同：3
> 
> 时间：2012-10-31T19:51:42.897
> 
> 标签：c#, .net, performance, linq

如何删除字符串中的每个第二个字符？

例如：

```
3030313535333635  -> 00155365
3030303336313435  -> 00036145
3032323437353530  -> 02247550 
```

字符串总是 16 个字符长，结果总是 8 个字符长 - 被删除的字符总是 '3' - 不要问为什么 - 我没有想到这个疯狂的源数据。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-31T19:54:28.060

试试这个从字符串中获取每个其他字符： -

```
 var s = string.Join<char>("", str.Where((ch, index) => (index % 2) != 0)); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-31T19:55:06.647

```
String input = "3030313535333635";
String result = "";
for(int i = 1; i < 16; i +=2 )
{
    result += input[i];
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-31T19:58:55.880

你可以使用这个著名的类[`System.Runtime.Remoting.Metadata.W3cXsd2001.SoapHexBinary`](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.metadata.w3cxsd2001.soaphexbinary.aspx):)

```
string str = "3030313535333635";
var hex = System.Runtime.Remoting.Metadata.W3cXsd2001.SoapHexBinary.Parse(str);
var newstr = Encoding.ASCII.GetString(hex.Value); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-31T20:04:39.197

使用 a`StringBuilder`创建字符串将节省资源

```
string input = "3030313535333635";
var sb = new StringBuilder(8); // Specify capacity = 8
for (int i = 1; i < 16; i += 2) {
    sb.Append(input[i]);
}
string result = sb.ToString(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-31T19:59:05.040

Java 语言代码

```
String input= "3030313535333635"
String output="";

for(int i=1;i<input.length();i=i+2)
{
    output+=input.charAt(i).toString();
}
System.out.println(output); 
```

# linux - Grails 路径未保存

> ID：13166444
> 
> 赞同：3
> 
> 时间：2012-10-31T19:51:50.697
> 
> 标签：linux, grails

我已经在 Linux 上安装了 Grails 并设置了我的 Grails_HOME 和 JAVA_Home 路径，例如：

```
[Hbrock@Harrison-Oracle ~]$ export JAVA_HOME=/usr/lib/jvm/java-1.6.0
[Hbrock@Harrison-Oracle ~]$ export PATH="$PATH:$JAVA_HOME/bin"
[Hbrock@Harrison-Oracle ~]$ export GRAILS_HOME=/home/Hbrock/Grails/grails-2.2.0.RC1
[Hbrock@Harrison-Oracle ~]$ export  PATH="$PATH:$GRAILS_HOME/bin"
[Hbrock@Harrison-Oracle ~]$ javac -version
javac 1.6.0_24
[Hbrock@Harrison-Oracle ~]$ grails -version
Grails version: 2.2.0.RC1 
```

但它似乎并没有拯救这个。我下次打开终端寡妇并尝试运行 grails 时这是错误的：

```
[Hbrock@Harrison-Oracle ~]$ grails -version
bash: grails: command not found
[Hbrock@Harrison-Oracle ~]$ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T20:17:09.370

您只为当前终端会话设置了这些路径。您需要将这些命令添加到 shell 的启动文件中。由于您正在运行某种 linux，它可能是

```
~/.bashrc 
```

执行`ls -a`并查找该文件（或类似文件），然后添加您在命令行中输入的所有命令。然后，每次启动 shell/终端时，它们都会被设置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T06:57:43.770

打开当前用户的 env 文件并添加所有内容。

例如：如果您使用的是 Ubuntu，则步骤如下：

1.  打开终端

2.  通过`vi ~/.bashrc` 或 打开 bashrc 文件`gedit ~/.bashrc`

3.  转到最后一行
4.  添加

    `export JAVA_HOME=/usr/lib/jvm/java-1.6.0`
    `export GRAILS_HOME=/home/Hbrock/Grails/grails-2.2.0.RC1`
    `export PATH="$JAVA_HOME/bin:$GRAILS_HOME/bin:$PATH"`

5.  保存文件

6.  运行资源 ~/.bashrc 它将刷新当前终端环境，或者您可以关闭当前终端并打开一个新的

注：我写过

```
export PATH="$JAVA_HOME/bin:$GRAILS_HOME/bin:$PATH" 
```

代替
`export PATH="$PATH:$JAVA_HOME/bin:$GRAILS_HOME/bin"`

因为，如果有人安装了多个 java，则将使用 $PATH 中的第一个文件夹。

希望它会清除您的所有步骤

# android - SQLITE DB 按字符串格式的日期字段排序查询

> ID：13166445
> 
> 赞同：2
> 
> 时间：2012-10-31T19:51:51.533
> 
> 标签：android, sqlite, date, sql-order-by

我有一个带有字符串字段的 SQLITE DB，其中包含以下格式的日期：“01.01.2012”。我想要的是在查询中按此字符串格式的日期对日期进行排序。我试过这个没有成功：

```
SELECT * FROM fahrer, fahrzeuge, nutzungsarten, fahrtenbuch WHERE fahrtenbuch.nutzungsart_id = nutzungsarten._id AND fahrtenbuch.fahrzeuge_id = fahrzeuge._id AND fahrtenbuch.fahrer_id = fahrer._id ORDER BY strftime ('%d.%m.%Y', fahrtenbuch.startdatum) 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:05:47.220

列中的值`startdatum`不是 SQLite 可识别的格式，因此不能将其用作`strftime`. （即使它有效，结果也不会正确排序，因为该日期格式不是以最重要的字段年份开头。）

您可以尝试提取日期字段，以便排序与`yyyy-mm-dd`顺序相同：

```
SELECT ...
ORDER BY substr(startdatum, 7, 4),
         substr(startdatum, 4, 2),
         substr(startdatum, 1, 2) 
```

但我建议首先将这些值转换[为受支持的格式](http://www.sqlite.org/lang_datefunc.html)。

# php - 在 PHP 项目中组织/扩展类

> ID：13166449
> 
> 赞同：1
> 
> 时间：2012-10-31T19:52:05.813
> 
> 标签：php, oop, class, extend

我正在开发一个带有几个简单类的 PHP 项目。我正在努力使我的类更复杂，但我也想开始使用类来管理用户、配置设置、显示等其他事情。我很难弄清楚如何“组织”它们. 比如我应该如何扩展这些类？

我有以下课程：

```
//main application settings, constants, etc.
Class Config {
}

//add/edit/delete/check permissions of users
Class Users extends Config {
}

//displays the pages
Class Display extends Config {
}

//main application
Class Analysis extends Config {
}

//specific methods for this type of analysis
Class Standard extends Analysis {
}

//specific methods for this type of analysis
Class Consolidated extends Analysis {
} 
```

我遇到的问题是我希望能够从所有其他类（Display、Analysis、Standard 和 Consolidated）访问 Users 和 Config 类。我该怎么做？我是否正确扩展课程？我觉得显示和分析应该扩展用户，但对我来说似乎不合适。感谢您提供的任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:56:55.877

在我的项目中，我的用户和配置类是[单例类](http://en.wikipedia.org/wiki/Singleton_pattern)，它允许我通过一个简单的方法调用轻松地将实例拉入任何其他类。

```
Class User{
    private static $_instance;

    private function __construct(){
    }

    public function getInstance(){
        if( !self::$_instance ){
            self::$_instance = new User();
        }

        return self::$_instance;
    }
} 
```

然后在我需要访问该用户对象的任何地方

```
$user = User::getInstance(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:11:01.810

你可以试试

```
trait Config {
}

// Common to Display
abstract class Display {
    function __construct(Users $user);
}

// Common to analysis
abstract class Analysis {

    function __construct(Users $user);
}

// add/edit/delete/check permissions of users
class Users {
    use Config ;
}

// Mobile Display
class Mobile extends Display {
}

// Web Display
class Web extends Display {
}

// specific methods for this type of analysis
class Standard extends Analysis {
}

// specific methods for this type of analysis
class Consolidated extends Analysis {
}

// main application
class Main {
    use Config ;
    public function setDisplay(Display $display);
    public function setAnalysis(Analysis $analysis);
}

$user = new Users("Jeff");
$main = new Main();
$main->setDisplay(new Mobile($user));
$main->setAnalysis(new Standard($user)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T19:57:24.070

将它们保存在单独的文件中，然后使用自动加载。避免使 OOP 变得疯狂的趋势。请记住，类可以作为属性引用，而不仅仅是在扩展方法中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T20:36:02.090

作为一般经验法则，您可以使用“ [is-a](http://en.wikipedia.org/wiki/Is-a) ”原则来组织您的类层次结构。根据您的描述，它看起来像：

*   `Standard`并且`Consolidated`是（在某种意义上），所以它看起来是一个很好的层次结构候选者*。*`Analysis`
*   `User`并且`Display`需要访问这些`Config`值，但它们似乎在概念上没有关联，也没有共同的行为，所以看起来组合比继承更适合这里。

关于*is-a*原则，您通常会认识到，当您的子类继承的行为不属于它时，它不适合。因此，例如，如果您的`Config`类有一个`saveValuesToDB()`它肯定看起来像是不`User`应该关心的东西（即配置值如何存储在数据库中）。您可以通过搜索*继承与组合*来找到有关该主题的大量信息，并且是模式社区中经常出现的主题。[您可以在此处](http://ootips.org/books.html)找到一些关于 OO 设计和模式的好书列表。

高温高压

# php - .append() 与数据库

> ID：13166455
> 
> 赞同：0
> 
> 时间：2012-10-31T19:52:47.350
> 
> 标签：php, jquery, database, json

我正在尝试从我的数据库中检索信息，并将其输出到我的页面。我能够对其进行硬核，因此要准确显示我想要做的事情位于此处：

我在 javascript 中没有任何控制台错误，但是一旦单击它，我就无法将数据附加到列表中。

HTML & JS：

```
<!doctype html><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../img/sd.ico" />
<link rel="stylesheet" type="text/css" href="style.css">
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>  
</head>
<body>
<div id="body">
<div id="header"><h1><a href="#">Bookmarks</a></h1></div><!-- header -->
<iframe id="iFrame" name="iFrame"></iframe>
<div id="links"><ul id="accordion">

<li><div class="bookmarkTitle"><p><h4>CareerResources</h4></p></div></li><ul id="CareerResources">

</ul><li><div class="bookmarkTitle"><p><h4>CSS</h4></p></div></li><ul id="CSS">

</ul><li><div class="bookmarkTitle"><p><h4>JS</h4></p></div></li><ul id="JS">

</ul><li><div class="bookmarkTitle"><p><h4>JS: Jquery</h4></p></div></li><ul id="JS: jQuery">

</ul></div><!-- links end -->
</div><!-- body end -->
<script type="text/javascript">
$(document).ready(function(){       
    $("#accordion > li").click(function(e){
        var catName=$(e.target).text();
        $.getJSON("get.php?catName=" + catName, function(data){ 
            if (data.data){ 
                $.each(data.data,function(index,value){ 
                    var url = value.URL; 
                    var title = value.title; 
                    var desc = value.desc; 
                    alert(catName);
                    $("#"+catName).append('<a href="'+url+'" target="iFrame"><div class="bookmark"><p><h3>'+title+'</h3><br />'+desc+'</p></div></a>'); 
                }); 
            } 
        });
    }); 
}); 
</script>
</body>
</html> 
```

PHP：

```
// retval: 0 - login ok, 1 - login failed, 2 - internal error
$json = array("retval" => 2, "data" => NULL, "debug" => "");

$catName=mysql_real_escape_string($_REQUEST['catName']);

$sql="SELECT * FROM linktb WHERE catName='$catName'";

$json['debug'] .= "SQL query was: ".$sql."\n";
$result=mysql_query($sql);
if (!$result) {
    $json['debug'] .= "SQL query failed\n";
    $json['debug'] .= "Other output: ". ob_get_contents();
    ob_end_clean();
    die(json_encode($json));
}
$count=mysql_num_rows($result);

if($count > 0){ 
$json['retval'] = 0; 
$json['data'] = array(); 
while ($row = mysql_fetch_assoc($result)){ 
$json['data'][] = $row; 
} 
} else { 
$json['retval'] = 1; 
}

$json['debug'] .= "Other output: ". ob_get_contents();
ob_end_clean();
echo json_encode($json); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T19:57:07.570

`var catID=e.target.text();`应该`var catID=$(e.target).text();`是`.text()`一个jQuery方法。

如果要遍历返回的数据，则必须在成功函数中进行。同样从您的 php 脚本中，您只从数据库中输出一行。

```
if($count > 0){ 
    $json['retval'] = 0; 
    $json['data'] = array(); 
    while ($row = mysql_fetch_assoc($result)){ 
        $json['data'][] = $row; 
    } 
} 
else { 
    $json['retval'] = 1; 
} 
```

```
$.getJSON("get.php?catID=" + catID, function(data){ 
    if (data.data){ 
        $.each(data.data,function(index,value){ 
            var url = value.URL; 
            var title = value.title; 
            var desc = value.desc; 
            $("#"+catID).appendText('<a href="'+url+'" target="iFrame"><div class="bookmark"><p><h3>'+title+'</h3><br />'+desc+'</p></div></a>'); 
        }); 
    } 
}); 
```

# c# - 按索引获取对象数组的单个值

> ID：13166458
> 
> 赞同：0
> 
> 时间：2012-10-31T19:52:53.847
> 
> 标签：c#, arrays, iteration

我在这里遗漏了一些明显的东西，我想我需要一个新的视角。

我正在传递对象 [] 类型的参数。我想提取数组中的元素并将其值分配给另一个变量，因为我正在循环另一个列表：

```
private void PopulateValues(List<SqlParameters> parameters, object[] parameterValues) {
   int index = 0;
   foreach(var parameter in parameters) {
      parameter.Value = parameterValues[index];
      index++;
   } 
```

尽我所能，将 parameter.Value 设置为对象数组，而不是位置 i 处的对象值。

我在这里想念什么？除了通过索引/位置之外，还有其他方法可以获取对象数组中的对象值吗？

好的..这正是我正在做的。

```
protected SqlCommand CreateStoredProcedureCommand(string storedProcedureName, object[] parameterValues)
    {
        SqlCommand cmd = new SqlCommand(storedProcedureName, Connection)
                             {CommandTimeout = _commandTimeout, CommandType = CommandType.StoredProcedure};

        SqlCommandBuilder.DeriveParameters(cmd);
        int index = 0;

        foreach(SqlParameter parameter in cmd.Parameters)
        {
            if (parameter.Direction == ParameterDirection.Input || parameter.Direction == ParameterDirection.InputOutput)
            {
                parameter.Value = parameterValues[index]
                index++;
            }
        }

        return cmd;
    } 
```

看起来这*应该*可行，所以我想我会回去调查我实际传递的内容。也许我正在传递一个数组数组或做其他奇怪的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:17:45.673

找到了。我在做一些奇怪的事情。

我以这种方式将 parameterValues 作为列表发送：

```
CreateStoredProcedureCommand("spName", pContext.SqlParameters.Select(b=>b.Value).ToList()) 
```

将其更改为 ToArray() 并且它有效。

# apache - 缺少 401 的“WWW-Authenticate”标头

> ID：13166461
> 
> 赞同：1
> 
> 时间：2012-10-31T19:53:13.257
> 
> 标签：apache, .htaccess, .htpasswd

我有一个受 .htaccess 中的 std AuthUserFile-directive 保护的项目。

一切都很简单，在另一台服务器上已经很好了。这是我的内容`.htaccess`：

`.htaccess`: _

```
AuthName "Adminbereich"
AuthType Basic
AuthUserFile /srv/www/passwords/.htpasswd-office

<Files *.php>
require valid-user
</Files> 
```

被`.htpasswd-office`访问。如果我打电话`http://user:pass@host/`，我会进来。如果我只是打电话`http://host/`，我会立即收到这条消息......

```
Authorization Required

This server could not verify that you are authorized to access the document requested. Either you supplied the wrong credentials (e.g., bad password), or your browser doesn't understand how to supply the credentials required. 
```

...没有任何登录框显示。这可能是什么原因？

这是此处的示例标头：`http://www.pagetutor.com/keeper/mystash/secretstuff.html`

```
HTTP/1.1 401 Authorization Required
Date: Thu, 01 Nov 2012 21:38:27 GMT
Server: Apache/2.2.22 (Unix) mod_ssl/2.2.22 OpenSSL/0.9.8e-fips-rhel5 mod_bwlimited/1.4
WWW-Authenticate: Basic realm="My Secret Area"
Accept-Ranges: bytes
Content-Length: 343
Content-Type: text/html 
```

这是我的标题：

```
HTTP/1.1 401 Authorization Required
Date: Thu, 01 Nov 2012 21:36:41 GMT
Server: Apache/2.2.20 (Ubuntu)
Vary: Accept-Encoding
Content-Type: text/html; charset=iso-8859-1 
```

魔法`WWW-Authenticate: Basic realm="..."`不见了，我不知道为什么......

我使用标准的 ubuntu (11.10) apache (2.2.20) 没有任何修改...

# java - 如何在没有路径的情况下访问 ModelAttribute 值

> ID：13166462
> 
> 赞同：0
> 
> 时间：2012-10-31T19:53:15.137
> 
> 标签：java, jstl, modelattribute

我的控制器中有一个`@ModelAttribute` `someString`。如何访问我的 JSP 中的值？我试过这个：

```
<form:input path=""/> 
```

但它不起作用

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T16:45:48.487

你试过用jsp形式定义吗？像这样的东西..？

```
<form:form id="form" action="${formAction}" method="post" modelAttribute="someString" enctype="multipart/form-data"> 
```

# associations - 单表继承（STI）问题

> ID：13166467
> 
> 赞同：0
> 
> 时间：2012-10-31T19:53:40.557
> 
> 标签：associations, ruby-on-rails-3.2, polymorphic-associations

我是 Rails 新手，在我的数据库中指定几个实体和关系时遇到了一些问题。

让我们假设以下实体。

## 赛车实体

迁移文件如下所示：

```
class CreateRacers < ActiveRecord::Migration
    def self.up
        create_table :racers, options: "ENGINE=InnoDB" do |t|
        t.string :email, limit: 60, null: false
        end
        add_index :racers, :email, unique: true
        execute "ALTER TABLE racers MODIFY id INT UNSIGNED AUTO_INCREMENT;"
    end

    def self.down
        drop_table :racers
    end
end 
```

模型文件如下所示：

```
class Racer < ActiveRecord::Base
    attr_accessible :email
    validates_uniqueness_of :email

    before_save { |racer| racer.email = email.downcase }

    # Email validation
    VALID_EMAIL_REGEX = /([\w+.]+)@[a-z\d\-.]+\.[a-z]+\z/i
    validates :email, presence: true, length: {maximum: 60}, format: { with: VALID_EMAIL_REGEX }

    has_many :tracks, dependent: :delete_all
end 
```

## 追踪实体

迁移文件如下所示：

```
class CreateTracks < ActiveRecord::Migration
    def self.up
        create_table :tracks, options: "ENGINE=InnoDB" do |t|
            t.column :user_id, 'integer unsigned', null: false
            t.string :description, limit: 250, null: false
            t.string :image, null: true
        end
        execute "ALTER TABLE tracks MODIFY id INT UNSIGNED AUTO_INCREMENT;"
        add_foreign_key :tracks, :racers
    end

    def self.down
        remove_foreign_key :tracks, :racers
        drop_table :tracks
    end
end 
```

模型文件如下所示：

```
class Track < ActiveRecord::Base
    attr_accessible :description, :image

    validates :description, presence: true, length: {maximum: 250}

    belongs_to :racer
    validates_presence_of :racer_id
    has_many :stops, dependent: :delete_all
end 
```

## 停止实体

迁移文件如下所示：

```
class CreateStops < ActiveRecord::Migration
    def self.up
        create_table :stops, options: "ENGINE=InnoDB" do |t|
            t.column :track_id, 'integer unsigned', null: false
            t.column :coordinates, :point, null: false
            t.string :name, limit: 30, null: true
            t.column :sequence_order, 'integer unsigned', null: false
        end
        execute "ALTER TABLE stops MODIFY id INT UNSIGNED AUTO_INCREMENT;"
        add_foreign_key :stops, :tracks
    end

    def self.down
        remove_foreign_key :stops, :tracks
        drop_table :stops
    end
end 
```

模型文件如下所示：

```
class Stop < ActiveRecord::Base
    attr_accessible :coordinates, :name, :sequence_order

    validates :name, presence: true, length: {maximum: 30}
    validates :coordinates, presence: true
    validates :spot_sequence_order, presence: true

    belongs_to :track
    validates_presence_of :track_id
    has_one :challenge, dependent: :delete_all
end 
```

## Challenge、Puzzle、Quiz、QuizOption 实体（问题出在哪里）

已在*Stop*实体**has_one**挑战上方看到，我希望该*挑战*除其他外是*Quiz*或*Puzzle*。*挑战* **belongs_to** a *Stop*。_ 到目前为止，我有以下迁移：

```
class CreatePuzzles < ActiveRecord::Migration
    def self.up
        create_table :puzzles, options: "ENGINE=InnoDB" do |t|
            t.string :image_path, null: false
            t.int :ver_split, null: false, default: 4
            t.int :hor_split, null: false, default: 4
        end
        execute "ALTER TABLE puzzlies MODIFY id INT UNSIGNED AUTO_INCREMENT;"
    end

    def self.down
        drop_table :quizzes
    end
end 
```

```
class CreateQuizzes < ActiveRecord::Migration
    def self.up
        create_table :quizzes, options: "ENGINE=InnoDB" do |t|
            t.string :question, null: false
        end
        execute "ALTER TABLE quizzes MODIFY id INT UNSIGNED AUTO_INCREMENT;"
    end

    def self.down
        drop_table :quizzes
    end
end 
```

以及以下型号

```
class Puzzle < ActiveRecord::Base
    attr_accessor :image_path, :ver_split, hor_split

    validates :image_path, presence: true, allow_blank: false
    validates :ver_split, allow_blank: false
    validates :hor_split, allow_blank: false

    belongs_to :stop
end 
```

```
class Quiz < ActiveRecord::Base
    attr_accessor :question

    validates :question, presence: true, length: { maximum: 255 }, allow_blank: false

    belongs_to :spot
    has_many :quiz_options
end 
```

*测验*有几个答案，其中一个或多个是正确的。

```
class CreateQuizOptions < ActiveRecord::Migration
    def self.up
        create_table :quiz_options do |t|
            t.column :quiz_id, 'integer unsigned', null: false
            t.string :option, null: false
            t.boolean :is_correct, null: false, default: false
        end
        add_foreign_key :quiz_options, :quizzes
        execute "ALTER TABLE quiz_options MODIFY id INT UNSIGNED AUTO_INCREMENT;"
    end

    def self.down
        remove_foreign_key :quiz_options, :quizzes
        drop_table :quiz_options
    end
end 
```

```
class QuizOption < ActiveRecord::Base
    attr_accessor :option, :is_correct

    validates :option, presence: true, length: { maximum: 255 }
    validates_inclusion_of :is_correct, in: [true,false]

    belongs_to :quiz
    validates_presence_of :quiz_id
end 
```

## 问题

我应该如何指定我的迁移、模型和控制器来实现这个目标？

我找到了几个 STI 和多态关联的例子，但我不知道要应用哪个以及如何将它们应用于这种情况。

首先，我尝试使用 STI 并在*Challenge*表中声明所有必要的字段，然后*Quiz* and *Puzzle*模型继承自*Challenge*模型。问题是我不知道把**has_many :quiz_options**放在哪里。

然后我尝试使用[此处](http://railscasts.com/episodes/154-polymorphic-association)和[此处](http://terenceponce.github.com/blog/2012/03/02/polymorphic-associations-in-rails-32/)解释的多态关联，但老实说，我无法理解如何使其适应这种特定情况。

提前致谢。

***编辑***：我忘了说我正在使用 MySQL。我也有一些宝石来管理空间数据类型（rgeo、activerecord-mysql2spatial-adapter）和foreign_keys（foreigner）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T01:01:32.457

好的，我想我通过应用单表继承解决了我自己的问题。

结果并不漂亮，但它有效，由于缺乏关于其他解决方案的适当信息，我现在会坚持下去。

所以让我们回到我的例子。

**Racer**、**Track**和**Stop**实体保持原样，没有变化。

**挑战**迁移将如下所示：

```
class CreateChallenges < ActiveRecord::Migration
    def self.up
        create_table :challenges, options: "ENGINE=InnoDB" do |t|
            t.column :stop_id, 'integer unsigned', null: false
            t.string :type
            # Common attributes to all challenges
            t.string :description, null: false
            # Puzzle attributes
            t.string :image_path
            t.int :vert_split
            t.int :hor_split
            # Quiz attributes
            t.string :question
        end
        add_foreign_key :challenges, :stops
        execute "ALTER TABLE quizzes MODIFY id INT UNSIGNED AUTO_INCREMENT;"
    end

    def self.down
        remove_foreign_key :challenges, :stops
        drop_table :quizzes
    end
end 
```

在这个表中，我刚刚添加了所有必要的字段来指定**Quizzes**和**Puzzles**。

现在模型将如下所示：

```
class Challenge < ActiveRecord::Base
    validates_presence_of :spot_id, :description

    attr_accessible :description, :image_path

    # Validate description attribute
    validates :description, length: { maximum: 255 }, allow_blank: false
    # Validates image type
    VALID_IMAGE_TYPE_REGEX = /^[\/]?([\w]+[\/])*([\w]+\.(png|jpg))$/
    validates :image_path, length: { maximum: 255 }, allow_blank: true, format: { with: VALID_IMAGE_TYPE_REGEX }

    # Validates type attribute
    validates_inclusion_of :type, in: %w( Quiz Puzzle )

    # Associations
    belongs_to :stop
    has_many :quiz_options
end 
```

```
class Puzzle < Challenge
    validates_presence_of :image_path
    attr_accessor :image_path, :ver_split, hor_split

    validates :image_path, allow_blank: false
    validates :ver_split, allow_blank: false
    validates :hor_split, allow_blank: false
end 
```

```
class Quiz < Challenge
    validates_presence_of :question
    attr_accessor :question

    validates :question, length: { maximum: 255 }, allow_blank: false
end 
```

现在完成所有工作，**QuizOption**迁移和模型将如下所示：

```
class CreateQuizOptions < ActiveRecord::Migration
    def self.up
        create_table :quiz_options do |t|
            t.column :challenge_id, 'integer unsigned', null: false
            t.string :option, null: false
            t.boolean :is_correct, null: false, default: false
        end
        add_foreign_key :quiz_options, :challenges
        execute "ALTER TABLE quiz_options MODIFY id INT UNSIGNED AUTO_INCREMENT;"
    end

    def self.down
        remove_foreign_key :quiz_options, :challenges
        drop_table :quiz_options
    end
end 
```

```
class QuizOption < ActiveRecord::Base
    validates_presence_of :challenge_id, :option
    attr_accessor :option, :is_correct

    validates :option, length: { maximum: 255 }
    validates_inclusion_of :is_correct, in: [true,false]

    belongs_to :challenge
end 
```

这样一切都按我的意愿工作。

# class - Flash Actionscript AS2 - 从类中访问时间轴上定义的实例变量

> ID：13166468
> 
> 赞同：1
> 
> 时间：2012-10-31T19:53:47.467
> 
> 标签：class, actionscript-2, instance

我可能会遗漏一些东西。我认为这将是一个常见问题，但几天来在网络上进行的广泛搜索并没有找到我需要的答案。我希望制作一个独立的电影剪辑，无论放置在哪里都可以使用。但是，从扩展影片剪辑的类中访问影片剪辑中定义的实例似乎很困难。

虽然我在 Flash Actionscript 2 (AS2) 中进行编码，但我想知道 AS3 是否存在同样的问题。

在以下场景中，如何访问实例“圈子”？

主时间轴上的影片剪辑具有实例名称“square”。Square.as 中定义的类 Square 扩展了该影片剪辑。在影片剪辑内部，另一个影片剪辑放置在第一帧上，实例名称为“circle”。在第一帧上还声明了一个变量`var myName:String = "my name"`。以下代码无法编译：

```
class Square extends MovieClip {
      function Square() {
          trace("Square.constructor, circle: " + circle);
          trace(" --- myName: " + myName);
      }
} 
```

编译器错误：（ `There is no property with name 'circle'.`与 myName 相同）。

添加`this.`参考没有帮助。显然，编译器正在类定义中寻找变量。

使用`_level0.square.circle`有效，但这需要类知道它自己的实例路径。虽然`_level0.square.myName`不会产生编译器错误，但它给出的值为`undefined`.

在构造函数以外的方法中引用这些变量会导致相同的编译器错误。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T19:48:22.643

我找到了解决问题的方法，使用`eval(this).`

```
class Square extends MovieClip {
    var base:MovieClip;

    function Square() {
        base = eval(this);
        trace("Square.constructor, circle: " + base.circle);
        trace(" --- myName: " + base.myName);
        onPress = procPress;
    }

    function procPress() {
        trace("procPress: " + base.circle);
        trace("procPress: " + base.myName);
    }
} 
```

没有编译器错误。在构造函数中，`base.myName`仍然是`undefined`（可以理解的）。`procPress`在单击调用的函数中，`base.myName`具有正确的值。

# java - 在 Eclipse 中使用 Java 的 MySQL 语法错误

> ID：13166471
> 
> 赞同：0
> 
> 时间：2012-10-31T19:53:54.170
> 
> 标签：java, mysql, sql, database

我在 Java 中为 sql 准备了以下语句：

com.mysql.jdbc.JDBC4PreparedStatement@6e56103e：

```
INSERT INTO `game` (Id , GameStart ,Name, Lenght, MapVersion, Mode)VALUES(2502591,'2000-03-02 02:02:02','5x5 aptb wdw','00:55:48','DotA v6.75b.w3x','aptb ')ON DUPLICATE KEY UPDATE `Id`=VALUES(Id),`GameStart` = VALUES(GameStart),`Name`=VALUES(Name),`Lenght`=VALUES(Lenght),`MapVersion`=VALUES(MapVersion),`Mode`=VALUES(Mode). 
```

当我在 Eclipse 中执行它时，出现以下错误：

```
com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '?,?,?,?,?,?)ON DUPLICATE KEY UPDATE `Id`=VALUES(Id),`GameStart` = VALUES(GameSta' at line 1. 
```

但同时当我在 SQLyog 中执行相同的查询时，我没有收到错误。行已更新。有什么问题？提前致谢

代码：

```
 Class.forName("com.mysql.jdbc.Driver");
    Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/dota","root","root");
    PreparedStatement updateGame = null;
    String updatingGame = "INSERT INTO `game` (Id , GameStart ,Name, Lenght, MapVersion, Mode)" +
                "VALUES(?,?,?,?,?,?)" +
                "ON DUPLICATE KEY UPDATE " +
                "`Id`=VALUES(Id),"+
                "`GameStart` = VALUES(GameStart)," +
                "`Name`=VALUES(Name)," +
                "`Lenght`=VALUES(Lenght)," +
                "`MapVersion`=VALUES(MapVersion)," +
                "`Mode`=VALUES(Mode)";
    con.setAutoCommit(false);
    updateGame=con.prepareStatement(updatingGame);
                updateGame.setInt(1, game.Id);
                Timestamp timestamp = new Timestamp(100,2,2,2,2,2,2);
                updateGame.setTimestamp(2,timestamp);
                updateGame.setString(3, game.GameName);
                updateGame.setTime(4, (Time) game.Time);
                updateGame.setString(5, game.MapVersion);
                updateGame.setString(6, game.Mode);
                updateGame.executeUpdate(updatingGame); 
```

然后：

```
updateGame.executeUpdate(updatingGame); 
```

我收到一个错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:01:24.247

首先，如果您使用的是 a`preparedStatement`您必须这样做

```
String query="Insert into tablename (col1, col2) values(?,?)";
PreparedStatement stmnt = //get the statement
stmnt.setString(1, "col1val");
stmnt.setString(2, "col2val"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:05:57.313

您正在主键上插入重复值。

按照@chaitanya10 的建议，使用`PreparedStatement`

您对面向对象的了解程度如何？正如我所看到的，您没有使用正确的封装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T20:26:01.230

发现我的错误。我应该只使用`executeUpdate()`而不是`executeUpdate(updatingGame)`;，因为如果我将它与参数一起使用，我将覆盖变白的值

```
updateGame.setInt(1, game.Id);
Timestamp timestamp = new Timestamp(100,2,2,2,2,2,2);
updateGame.setTimestamp(2,timestamp);
updateGame.setString(3, game.GameName);
updateGame.setTime(4, (Time) game.Time);
updateGame.setString(5, game.MapVersion);
updateGame.setString(6, game.Mode); 
```

# extjs - Extjs 模态窗口聚焦回控件

> ID：13166472
> 
> 赞同：7
> 
> 时间：2012-10-31T19:53:57.007
> 
> 标签：extjs, extjs4

我展示了一个带有一些输入控件的模式窗口。当我按下“tab”键时，它会在控件中导航。

如果我继续按“选项卡”，在某些时候它会将控件集中在此窗口后面，我什至可以输入此控件。

我正在使用 ExtJs 4.1

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T10:46:39.710

**做了一些解决方法，为我工作，检查一下，请告诉我。**

```
/* ***For activation of Tab Key only to the active panel****/

Ext.EventManager.on(Ext.getBody(), 'keydown', focusListenerLogin, Ext.getBody());
Ext.EventManager.on(Ext.getBody(), 'keyup', focusListenerLogin, Ext.getBody());
Ext.EventManager.on(Ext.getBody(), 'keypress', focusListenerLogin, Ext.getBody());
Ext.EventManager.on(Ext.getBody(), 'focusin', focusListenerLogin, Ext.getBody());

/***Here the Function is defined.***/

function focusListenerLogin(e) {

if(typeof Ext.WindowManager.getActive() !== 'undefined' && Ext.WindowManager.getActive() !== null) {
    var activeWinId = Ext.WindowManager.getActive().getId ();
    var obj = Ext.getCmp(activeWinId);
    var id = typeof obj.focusEl !=='undefined' ? obj.focusEl.id : obj.id;
    window.prevFocus;

    var dom = activeWinId;
    var components = [];
    Ext.Array.each(Ext.get(dom).query('*'), function(dom) {
      var cmp = Ext.getCmp(dom.id);
      if(cmp && cmp.isVisible()) {
      if (cmp && cmp.btnEl && cmp.btnEl.focusable())
        components.push(cmp.btnEl);
      else if(cmp && cmp.inputEl && cmp.inputEl.focusable())
        components.push(cmp.inputEl);
      }
    });

    if (typeof obj != 'undefined' && obj.isVisible() && obj.el.id === activeWinId && (typeof e.keyCode!== 'undefined' ? e.keyCode === 9 : true) ) {
        var focused = document.activeElement;

     if (!focused || focused === document.body){ focused = null;}
        else if (document.querySelector) focused = document.querySelector(":focus");

     if( typeof window.prevFocus !=='undefined' && window.prevFocus !== null && focused !== window.prevFocus && components.length>0 && window.prevFocus.id === components[components.length-1].id) {

         Ext.getCmp(id).focus();
         window.prevFocus = document.activeElement; 
         }
     else if(components.length==0 ) {

         Ext.getCmp(id).focus(); 
         window.prevFocus = document.activeElement; 
     }
     else
     window.prevFocus = focused !== null ? focused : window.prevFocus;
    }
    return false;
}

} 
```

**逻辑是**

1.  如果焦点从窗口组件的最后一个元素出去，那么它将被重新分配给第一个元素。

2.  如果窗口没有任何可聚焦元素，则焦点将仅保留在窗口上。

**如果这段代码对您有帮助，请告诉我。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-01T06:15:18.637

这是 Extjs 中著名的错误。检查这个： [http](http://www.sencha.com/forum/showthread.php?214072-4.1.0-Modal-Window-Bad-Focus-Behavior) ://www.sencha.com/forum/showthread.php?214072-4.1.0-Modal-Window-Bad-Focus-Behavior 。

# firefox - Firefox Addon SDK 中 page-mod 和 context-menu 之间的通信

> ID：13166475
> 
> 赞同：5
> 
> 时间：2012-10-31T19:54:10.860
> 
> 标签：firefox, contextmenu, firefox-addon-sdk, add-on, postmessage

通过该`context-menu`模块，我检测到用户单击了我的自定义上下文菜单项“标记”的 DOM 元素：

```
var menu = require("context-menu").Item({
  label: "Mark",
  contentScriptFile: data.url("context.js"),
  onMessage: function (node) {
    //Send the node to page-mod
  }
}); 
```

`context.js`：

```
self.on("click", function (node, data) {
    self.postMessage(node);
}); 
```

现在我想将此节点引用发送到一个`page-mod`模块，在该模块中，每个注入 pagemod 的 contentScript 的页面都会知道我单击的节点（并在每个选项卡中用红色边框标记 HTML 元素）。

我知道无法通过将消息发送到 pagemod `postMessage()`，那么如何使这些模块进行通信？有没有优雅的`worker`解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-17T02:03:30.577

这是不可能的，postMessage 部分正在 JSON 化您的消息，因此消息中的节点被忽略。您将通过将有关节点的数据发送到插件上下文（使用 postMessage）来实现您的目标。

# java - 用java检查格式

> ID：13166477
> 
> 赞同：0
> 
> 时间：2012-10-31T19:54:13.310
> 
> 标签：java, string, format

我有一组特定的数据，这些数据具有非常确定的间距。我想知道是否无论如何都要用Java扫描那个文件，检查前面有两个空格的任何行并将其存储在一个数组中。我不确定如何检查线条以查看线条是否以两个空格开头而不是其他任何内容。如果是这样，我想将该字符串存储在一个数组中，就像我之前所说的那样。欢迎任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T19:57:11.220

1.  从文件中读入一行

2.  检查该行的前两个字符是否有空格

3.  如果有两个空格，请使用 a`StringTokenizer`将字符串拆分为单词，并将其存储在数组中，或者您想要这样做...

# c# - Visual Studio 2010 中的错误/奇怪的 For-Loop 行为？

> ID：13166480
> 
> 赞同：1
> 
> 时间：2012-10-31T19:54:32.800
> 
> 标签：c#, visual-studio-2010, debugging

当我的应用程序现在触发 IndexOutOfRanage 异常时，我感到很震惊。我打开了*Debugger Locals 窗格*，发现我的整数越过了它的边界？基本上我的代码中有这样的东西：

```
string folder = Extender.GetSetting<string>("textFolder");
string mlink = folder + "\\" + filename + ".txt";
if(File.Exists(mlink))
{
    string fContent = File.ReadAllText(mlink);
    rtbLearnGuide.Text = fContent;
    string[] strings = fContent.Split(' ');
    for (int i = 0; i < strings.Length; i++, words.Enqueue(strings[i]));
} 
```

这里的问题是我达到了 的长度`strings[]`，我在下面附上了一张图片。

![奇怪的 For 循环行为](../Images/6268253476a6c1bb928b926fc058d127.png)

更奇怪的是，我第二次未能重现这种行为。

**注意：**我今天早些时候经历了类似的事情，`this.CreateGraphics();`我的代码类似于：

```
var dc = this.CreateGraphics();//and some other stuff 
```

*结果是即使在尝试重新运行 4 次之后它也无法绘制它，然后我回到代码并明确定义 dc，瞧，它正在工作。然后我把它改回var，它还在工作：/？*

可能有什么问题？

**编辑：**

我刚刚发现更改顺序有效。例如：

```
for (int i = 0; i < strings.Length; words.Enqueue(strings[i]), i++); 
```

**不会触发**任何错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T19:59:34.687

要回答问题的第一部分，您在 for 循环的测试条件*之前执行 Enqueue。*所以

```
for (int i = 0; i < strings.Length; i++, words.Enqueue(strings[i])); 
```

应该：

```
for (int i = 0; i < strings.Length; i++) words.Enqueue(strings[i]); 
```

基本上，“增量”部分将始终在“测试”部分之前执行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-31T19:59:23.057

逻辑地格式化你的 for 循环，你不会有那个错误。

```
for (int i = 0; i < strings.Length; i++)
    words.Enqueue(strings[i]); 
```

在您的代码中，“i”在超出条件（strings.Length）之后递增，然后您在越界“i”上运行 word.Enqueue。

您的循环（在伪代码中）：

```
i = 0
Loop_Label:
IF i >= strings.Length THEN GoTo End_Label
... where the for loop body should go ...
i = i + 1
words.Enqueue strings[i]
GoTo Loop_Label
End_Label: 
```

# vb.net - 在 VB.NET 中通过 FTP 上传整个目录

> ID：13166481
> 
> 赞同：0
> 
> 时间：2012-10-31T19:54:35.987
> 
> 标签：vb.net, upload, ftp-client

我已经成功地能够将单个文件上传到 FTP：

```
My.Computer.Network.UploadFile 
```

有没有办法上传整个目录，例如：

```
My.Computer.Network.UploadFolder 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T19:58:03.260

从未在 VB.NET 中使用过 FTP，但似乎没有直接的方法可以做到这一点。

[以下是人们对如何做到这一点的看法](http://social.msdn.microsoft.com/Forums/en-US/vblanguage/thread/87abfbc9-5d98-4dc4-8975-a2b07e499325)：

1.  遍历本地目录
2.  在 FTP 服务器中创建相同的目录结构。
3.  上传每个本地目录中的文件。

另[请参阅此处了解已回答的相同问题 (C#)](https://stackoverflow.com/questions/2252000/upload-a-folder-by-ftp)。它确认没有内置方法。您将不得不编写一些代码或使用 3rd 方库。

# list - 如何创建用于打印的 SharePoint 列表项的自定义视图

> ID：13166486
> 
> 赞同：1
> 
> 时间：2012-10-31T19:54:58.863
> 
> 标签：list, sharepoint, printing

我整天都在网上搜索我认为很简单的东西。我在[这里](http://planetparker.com/blog/Lists/Posts/Post.aspx?ID=55)找到了一种对我有用的解决方案，但有几个问题。

似乎该解决方案仅适用于在添加 CEWP 之前在列表中创建的项目。否则，它只会显示表单，但不会显示为新项目输入的数据。我认为这与计算字段有关，但老实说，我对 SharePoint 太陌生了，无法确定。

此解决方案不理想的另一件事是，它仍会打印站点的标题。我的 Internet Explorer 也只在第一页上打印，第二页是空白的。在 chrome 中工作正常，所以目前这没什么大不了的，因为它可能是我的电脑本身造成的。

我看到很多人在网上寻找打印表单和当前列表项数据的解决方案，但总是遇到死胡同。我希望功能区中有一个打印按钮，但在这一点上，我完全满足于一个空白页面，其中填充了来自我列表中单个项目的列表数据的表单。任何帮助都将不胜感激，因为我对此已经束手无策了。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T12:05:58.873

基本上，您需要单独为 PRINT 编写一个特殊的 CSS 文件，您将在其中隐藏所有不需要的元素。

```
<LINK REL="stylesheet" TYPE="text/css" MEDIA="print" HREF="foo.css"> 
```

在这个 foo.css 中，您可以编写类来隐藏所需的东西。如下所示，您可以通过说隐藏功能区

```
#RibbonContainer
{
display:none;
} 
```

左侧导航：

```
#s4-leftpanel
{
display:none;
} 
```

# xml - 如何使用解构绑定将 XML 转换为特定的 s 表达式树？

> ID：13166488
> 
> 赞同：1
> 
> 时间：2012-10-31T19:55:09.130
> 
> 标签：xml, emacs, elisp

我面前有一个任务，我有一个 XML 文档，我需要以系统的方式将它转换为另一个 XML 文档 - 将标签 Foo 更改为标签 Bar，将所有带有`name="frob"`属性的 Qux 标签更改为 Frob 标签，等等. 我对如何使用 XSLT 一无所知，但我对自己说——嘿，如果我必须对基于树的数据进行一系列转换，那听起来像是 Lisp 擅长的事情！

所以我有一大块 XML - 例如：

```
<Object>
    <field name="id">100520</field>
    <field name="type_id">77</field>
    <field name="has_extras"></field>
    <field name="author_id">7</field>
    <field name="summary">To Sir Duke, with love</field>
</Object> 
```

我啜饮`xml-parse tag`并得到：

```
(Object nil "\n        "
     (field
     ((name . "id"))
     "100520")
    "\n        "
    (field
     ((name . "type_id"))
     "77")
    "\n        "
    (field
     ((name . "has_extras")))
    "\n        "
    (field
     ((name . "author_id"))
     "7")
    "\n        "
    (field
     ((name . "summary"))
     "To Sir Duke, with love")
    "\n    ") 
```

我无法弄清楚如何处理那棵树以使其成为我想要的形状。`assoc`我目前的 尝试很脆弱 - 注重`cxr`功能。CL`destructuring-bind`似乎是我想要的，但我不知道如何应用它。我正在尝试将上述结构转换为：

```
(Object
  (id "100520")
  (type_id "77")
  (has_extras "")
  (author_id "7")
  (summary "To Sir Duke, with love")) 
```

*   `destructuring-bind`实际上是我需要的工具吗？
*   如果是这样，我应该如何应用它来从我的数据的一种形状到另一种形状？
*   如果没有，什么*是*正确的工具？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T23:21:04.103

确实，这`destructuring-bind`并不能胜任这项工作，但在 Emacs 24 中，您可以使用`pcase`模式匹配宏非常简洁地完成这项工作，如下所示：

```
(require 'cl)                ;; for `mapcan'
(require 'pcase)

(defun xslt-in-elisp (xml)
  (pcase xml
    (`(Object . ,rest)
     `(Object . ,(mapcan #'xslt-in-elisp rest)))

    (`(field ((name . ,name)))
     `((,(intern name) "")))

    (`(field ((name . ,name)) ,value)
     `((,(intern name) ,value)))

    (_ nil)))

(xslt-in-elisp
 '(Object nil "\n        "
          (field ((name . "id")) "100520")
          "\n        "
          (field
           ((name . "type_id"))
           "77")
          "\n        "
          (field
           ((name . "has_extras")))
          "\n        "
          (field
           ((name . "author_id"))
           "7")
          "\n        "
          (field
           ((name . "summary"))
           "To Sir Duke, with love")
          "\n    ")) 
```

评估为：

```
(Object
 (id "100520")
 (type_id "77")
 (has_extras "")
 (author_id "7")
 (summary "To Sir Duke, with love")) 
```

工作原理：取一个值进行模式匹配，并按顺序尝试`pcase`一系列子句。`(PATTERN VALUE)`您可以使用 查找详细信息`M-x describe-function pcase`，但基本上模式看起来就像您希望它们匹配的内容，使用反引号语法指定哪些部分是要绑定的模式匹配变量以及哪些部分匹配为文字符号。所以，第一条规则

```
`(Object . ,rest) 
```

匹配任何`Object`作为第一个符号的列表，并将变量绑定`rest`到任何剩余的元素。规则

```
`(field ((name . ,name))` 
```

匹配`field`带有名称但没有内容的标签的 S-exp（如`has_extras`示例中所示）。等等。最后一条规则，`_`，返回`nil`与这些规则不匹配的任何内容。每个规则的右侧可以是任何 Lisp 表达式。对于这种转换，使用反引号和取消引号最有用，它的好处是模板看起来就像它们匹配的规则。

唯一稍微棘手的部分是如何累积 的子节点的转换值`(Object ...)`。如果我们过去`mapcar`对它们进行迭代，我们最终会得到不需要`nil`的 s，其中最初是一串空白和其他垃圾。解决方案是让`field`标签的规则返回一个单元素列表，并使用`mapcan`from`cl`包将这些单元素列表连接在一起。垃圾元素`nil`和空格字符串正好匹配`_`规则，所以它们被转换为空列表并从结果中消失。

我将转换器编写为递归函数，但为了稳健性，您可以轻松地将其拆分为仅与 sexps 匹配的顶级转换`(Object ...)`器，以及仅与 sexps 匹配的单独转换`(field ... )`器。

# c# - 绑定源不更新

> ID：13166490
> 
> 赞同：1
> 
> 时间：2012-10-31T19:55:13.963
> 
> 标签：c#, mvvm, windows-phone, windows-phone-8

遵循 MVVM 模式。每次 TextBox 中的 Text 更改时，我都需要 TextBox 来触发 viewModel 上的属性设置器。问题是 ViewModel 上的 setter 永远不会被调用。这就是我所拥有的：

**查看 (.cs)**

```
public partial class AddShowView : PhoneApplicationPage
{
    public AddShowView()
    {
        InitializeComponent();
    }

    private void PhoneApplicationPage_Loaded_1(object sender, RoutedEventArgs e)
    {
        DataContext = new AddShowViewModel(this.NavigationService);
    }

    private void SearchTextBox_TextChanged_1(object sender, TextChangedEventArgs e)
    {
        var textBox = (TextBox)sender;
        var binding = textBox.GetBindingExpression(TextBox.TextProperty);
        binding.UpdateSource();
    }
} 
```

**查看 (.xaml)，仅相关部分**

```
<TextBox Grid.Row="0" HorizontalAlignment="Stretch" VerticalAlignment="Center" Text="{Binding SearchText, UpdateSourceTrigger=Explicit}" TextChanged="SearchTextBox_TextChanged_1" /> 
```

**视图模型**

```
public class AddShowViewModel : PageViewModel
{
    #region Commands

    public RelayCommand SearchCommand { get; private set; }

    #endregion

    #region Public Properties

    private string searchText = string.Empty;
    public string SearchText
    {
        get { return searchText; }
        set
        {
            searchText = value;
            SearchCommand.RaiseCanExecuteChanged();
        }
    }

    #endregion

    public AddShowViewModel(NavigationService navigation) : base(navigation)
    {
        SearchCommand = new RelayCommand(() => MessageBox.Show("Clicked!"), () => !string.IsNullOrEmpty(SearchText));
    }
} 
```

从源到目标的绑定有效，我已经仔细检查过，所以 DataContext 设置正确。我不知道我哪里出错了。感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:01:36.507

您需要将绑定模式设置为 TwoWay，否则它只会从您的 ViewModel 中读取值，而不是更新它。

```
Text="{Binding SearchText, Mode=TwoWay, UpdateSourceTrigger=Explicit}" 
```

# php - PHP使用正则表达式循环查询mysql输出excel文件

> ID：13166492
> 
> 赞同：2
> 
> 时间：2012-10-31T19:55:21.873
> 
> 标签：php, mysql, regex

我在这里做错了什么。我希望我们最初得到的数组被转置。然后正则表达式分解其中一个列，以便我们可以查询数据库中的另一个表以用正确的标题替换该列标题。正则表达式是否正确？转置是否正确？

这将得到我们想要的查询

```
exportMysqlToCsv($tablename,$tokenmain, $id);
function exportMysqlToCsv($tablename,$tokenmain, $id, $filename = 'Results.csv'){
      $sql_query = "select * from $tablename where $tokenmain";

// Gets the data from the database

$result = mysql_query($sql_query);

$f = fopen('php://temp', 'wt');
$first = true;

$temp = mysql_fetch_array($result); 
```

我希望这可以转换我们刚刚得到的数组。不确定这里

```
array_unshift($temp, null);
$transposed_array = call_user_func_array('array_map', $temp); 
```

然后我们循环遍历 transposed-array 并替换我们收到的列标题（例如 111X2222X3333）并将它们拆分以查询我们想要替换它们的标题并将其输出到 excel 文件。这是我非常困惑的地方。

```
for ($i = 0; $i < $count; $i++) {
if ($transposed_array[$i][0])//starts with a number
{
    $sid = regexp /^[0-9]*/

    $gid = regexp /X[0-9]*X/
    //remove first and last character from $gid
    $gid = str_replace("X", "", $gid)

    $qid = regexp /[0-9]*$/

    $question_text = mysql_query("select question from lime_questions where sid =           ".$sid." and gid = ".$gid." and qid = ".$qid." limit 1");
    $transposed_array[$i][5] = $question_test
} 
```

这应该将数组输出到 csv 文件

```
while ($row = mysql_fetch_assoc($result))
{
         if ($first)
     {
            fputcsv($f, array_keys($row));
            $first = false;
     }
fputcsv($f, $row);

} // end while 
```

//恢复正常处理

```
$size = ftell($f);
rewind($f);
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Content-Length: $size"); 
```

// 以适当的 mime 类型输出到浏览器，您可以选择 ;)

```
header("Content-type: text/x-csv");
header("Content-type: text/csv");
header("Content-type: application/csv");
header("Content-Disposition: attachment; filename=$filename");

fpassthru($f);

exit; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:29:11.327

不确定您想要实现什么，因为以下不是有效的 PHP 表达式

```
 $sid = regexp /^[0-9]*/
  $gid = regexp /X[0-9]*X/
  $qid = regexp /[0-9]*$/ 
```

但是形成你的评论

> 我希望这个循环拆分我们从第一个数组收到的列标题。列标题的示例是 111X222X3333。我想使用正则表达式将它们分开，所以每个都是自己的属性，例如 sid =111 gid=222 和 qid=3333

所有你需要的是

```
$string = "111X222X3333" ;
list($sid,$gid,$qid) = explode("X", $string); 
```

# asp.net-mvc - 与 ASP.NET MVC 和 TFS 的持续集成

> ID：13166496
> 
> 赞同：3
> 
> 时间：2012-10-31T19:55:26.867
> 
> 标签：asp.net-mvc, tfs

我有一个 ASP.NET MVC 3 应用程序。此应用程序托管在 TFS 中。我已经设置了一个构建服务器。当签入发生时，我的代码被编译并放在我的测试服务器上的一个文件夹中。放置文件夹是 IIS 应用程序文件夹。目标是当用户访问时`http://[myTestServer]/MyProject`，他们应该看到应用程序的最新编译版本。为了尝试做到这一点，我将文件放入`//[myTestServer]/c$/inetpub/www/myProject/`. 然而，我得到的比我预想的要多。

我注意到构建服务器放置了一堆程序集并创建了 2 个目录：_PublishedWebsites 和日志。_PublishedWebsites 包含两个目录：MyProjectName 和 MyProjectName_Package。据我所知，MyProjectName 包含我想要放入 //[myTestServer]/c$/inetpub/www/myProject/ 的文件。我究竟做错了什么？

如何设置它，以便当用户访问 http://[myTestServer]/MyProject 时，他们会看到应用程序的最新编译版本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:34:16.740

查看 Microsoft 的[Web Deploy](http://www.iis.net/downloads/microsoft/web-deploy)，用于将 Web 应用程序和网站部署到 IIS 服务器。

本教程详细描述了如何为 Web 部署配置 TFS：

*   [为 Web 部署配置 Team Foundation Server](http://www.asp.net/web-forms/tutorials/deployment/configuring-team-foundation-server-for-web-deployment/configuring-team-foundation-server-for-web-deployment)
    *   [在 TFS 中创建团队项目](http://www.asp.net/web-forms/tutorials/deployment/configuring-team-foundation-server-for-web-deployment/creating-a-team-project-in-tfs)
    *   [将内容添加到源代码管理](http://www.asp.net/web-forms/tutorials/deployment/configuring-team-foundation-server-for-web-deployment/adding-content-to-source-control)
    *   [为 Web 部署配置 TFS 构建服务器](http://www.asp.net/web-forms/tutorials/deployment/configuring-team-foundation-server-for-web-deployment/configuring-a-tfs-build-server-for-web-deployment)
    *   [创建支持部署的构建定义](http://www.asp.net/web-forms/tutorials/deployment/configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment)
    *   [部署特定构建](http://www.asp.net/web-forms/tutorials/deployment/configuring-team-foundation-server-for-web-deployment/deploying-a-specific-build)
    *   [为 Team Build 部署配置权限](http://www.asp.net/web-forms/tutorials/deployment/configuring-team-foundation-server-for-web-deployment/configuring-permissions-for-team-build-deployment)

# php - 在动态查询 SQL 时使用 PHP 将标头硬编码为 excel 文件

> ID：13166502
> 
> 赞同：1
> 
> 时间：2012-10-31T19:55:51.843
> 
> 标签：php, mysql, phpexcel

我有这个**PHPExcel**代码：

```
/** Error reporting */
error_reporting(E_ALL);
date_default_timezone_set('Europe/London');

/** Include PHPExcel */
require_once '../Classes/PHPExcel.php';
    $objPHPExcel = new PHPExcel();
    //$objPHPExcel->setActiveSheetIndex(0)
               // ->setCellValue('A1', 'Hello')
               // ->setCellValue('A2', 'world!')

$row = 2; 
while($row_data = mysql_fetch_assoc($result)) {
    $col = 1;
    foreach($row_data as $key=>$value) {
$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col, $row, $value);
$col++;
    }
        $row++;
    }

// Rename worksheet
$objPHPExcel->getActiveSheet()->setTitle('Results');

// Set active sheet index to the first sheet, so Excel opens this as the first sheet
$objPHPExcel->setActiveSheetIndex(0);

// Redirect output to a client’s web browser (Excel5)
header('Content-Type: application/vnd.ms-excel');
header('Content-Disposition: attachment;filename="Output.xls"');
header('Cache-Control: max-age=0');
$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');
$objWriter->save('php://output');
exit; 
```

基本上我是在动态查询数据库并将其放入一个 excel 文件中。

我只想在一些标题中硬编码。所以对于 A1，我想在“Hello”和 A2 中硬编码：“World！” 查询数据库并将数据从 B 列开始

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T19:59:28.883

```
$objPHPExcel = new PHPExcel();
$objPHPExcel->setActiveSheetIndex(0)
            ->setCellValue('A1', 'Hello')
            ->setCellValue('A2', 'world!');

$col = 1; 
while($row_data = mysql_fetch_assoc($result)) {
    $row = 1;
    foreach($row_data as $value) {
        $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col, $row, $value);
        $row++;
    }
    $col++;
} 
```

请注意，Excel5 有 256 列的限制，因此如果您有超过 255 条数据记录，如果您要保存为该格式，则额外的列将从保存的工作簿中删除。

# node.js - 在 Meteor 中上传图片，上传空文件

> ID：13166503
> 
> 赞同：4
> 
> 时间：2012-10-31T19:55:58.510
> 
> 标签：node.js, meteor, fs

我正在研究流星框架并尝试使用链接中的代码在我的一个应用程序中上传图像

[https://gist.github.com/3922137](https://gist.github.com/3922137)

一切正常，除了它将空文件上传到我的 app 公用文件夹中。

我检查了控制台，在我选择要上传的文件后，它在那里显示 503 错误

这是控制台截图 [http://img40.imageshack.us/img40/2956/consolewl.jpg](http://img40.imageshack.us/img40/2956/consolewl.jpg)

它不断循环，并且错误数量不断添加到控​​制台中

我在 windows 上使用流星。

有没有人设法在 Windows 平台上的流星中上传文件？如果可以，请分享对您有用的代码。

谢谢阿曼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:34:59.097

您获得 503 的原因是，当公用文件夹中的任何内容发生更改时，流星会重新加载。因为您的上传内容正在那里，所以服务器正在重置。更改您的代码不要将其保存到公共位置，而是将其保存在其他地方，您应该会看到错误消失。

# git - Git：带有修改的工作树和索引的 git checkout

> ID：13166505
> 
> 赞同：5
> 
> 时间：2012-10-31T19:56:07.517
> 
> 标签：git

我希望`git checkout <commit>`将工作树和索引都刷新到`<commit>`版本。但是，在某些情况下，它将保留工作树和索引中的当前更改。例如：

```
git branch br1
git branch br2
git checkout br1
<make change M1 to file foo>
git add foo
<make change M2 to file foo>
git checkout br2 
```

现在，在分支中所做的所有工作树/索引更改`br1`都保留在分支中`br2`，因为`git status`on`br2`不会给出干净的消息。我猜这是因为文件头`br1`和`br2`原来有相同版本的文件`foo`，Git 可以自动检测到这一点。

问题：

*   Git 什么时候决定不刷新工作树和索引？还有其他极端案例吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T20:02:03.573

该`git checkout`命令实际上有两种不同的（常见的）操作模式。

1.  如果你运行`git checkout <branch>`，那么你将切换到分支`<branch>`。对工作树的所有更改都将被保留——这是通过将未提交的更改合并到目标分支来实现的，因此它可能会失败。索引中的更改将被隐藏。

2.  如果你运行，那么 git 将通过从当前提交中获取它们来`git checkout <path>`清除索引和工作副本中的更改。`<path>`

因此，目的`git checkout <branch>`是为了以防您决定所做的更改实际上属于不同的分支。

# hadoop - 如何解决 cdh3 中不同版本的 cloudera 不兼容版本

> ID：13166507
> 
> 赞同：0
> 
> 时间：2012-10-31T19:56:11.267
> 
> 标签：hadoop, cloudera

我在集群中有以下错误：

```
2012-10-31 21:15:49,414 ERROR org.apache.hadoop.hdfs.server.datanode.DataNode: java.io.IOException: Incompatible build versions: namenode BV = 318bc781117fa276ae81a3d111f5eeba0020634f; datanode BV = 217a3767c48ad11d4632e19a22897677268c40c4
    at org.apache.hadoop.hdfs.server.datanode.DataNode.handshake(DataNode.java:587) 
```

我的主人有：

```
Subversion file:///data/1/tmp/nightly_2012-02-16_09-46-24_3/hadoop-0.20-0.20.2+923.195-1~maverick -r 217a3767c48ad11d4632e19a22897677268c40c4 
```

所有的奴隶都有：

```
Subversion file:///data/1/tmp/nightly_2012-03-20_13-13-48_3/hadoop-0.20-0.20.2+923.197-1~maverick -r 318bc781117fa276ae81a3d111f5eeba0020634f 
```

如何将母校降级到 b195？我如何指出要安装的内部版本号？

一般来说，我在存储库中有以下内容：

```
cat  /etc/apt/sources.list.d/cloudera.list 
deb http://archive.cloudera.com/debian maverick-cdh3u3 contrib
deb-src http://archive.cloudera.com/debian maverick-cdh3u3 contrib 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T08:51:55.133

总而言之，这有点hacky，但我做了以下事情来获得安装的“img”。

在我拥有所需版本号的机器上，我复制了所有 hadoop .deb 文件

```
/var/cache/apt/archives/ 

hadoop-0.20_0.20.2+923.197-1~maverick-cdh3_all.deb
hadoop-0.20-jobtracker_0.20.2+923.197-1~maverick-cdh3_all.deb
hadoop-0.20-namenode_0.20.2+923.197-1~maverick-cdh3_all.deb
hadoop-0.20-native_0.20.2+923.197-1~maverick-cdh3_amd64.deb
hadoop-0.20-secondarynamenode_0.20.2+923.197-1~maverick-cdh3_all.deb
hadoop-hbase_0.90.4+49.137-1~maverick-cdh3_all.deb
hadoop-hbase-master_0.90.4+49.137-1~maverick-cdh3_all.deb
hadoop-zookeeper_3.3.4+19.3-1~maverick-cdh3_all.deb
hadoop-zookeeper-server_3.3.4+19.3-1~maverick-cdh3_all.deb 
```

然后我只需为所有软件包运行 dpkg -i ，因此我可以“安装”适当的版本

# ios - 子类化 UISplitViewController 时出现奇怪的错误

> ID：13166508
> 
> 赞同：0
> 
> 时间：2012-10-31T19:56:13.633
> 
> 标签：ios, uisplitviewcontroller

当我继承 UISplitViewController 并设置它的 viewControllers 属性时，一切都很好。但是，一旦我将这一行添加到我的子类中，主视图控制器就会增长到详细视图的大小并与我的详细视图重叠。

```
@property (nonatomic,retain) MMMasterViewController* masterViewController; 
```

有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T20:08:10.910

所以我改变了我的财产的名称，它奏效了。

为什么？

它很可能是覆盖 UISplitViewController 的私有属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T20:45:07.307

详细信息视图的私有属性名称似乎是`detailViewController`. 我使用了该名称，并且我的详细信息视图移到了主视图下。

似乎最好避免在子类中使用这些属性名称中的任何一个。

# excel - Excel VBA 用于从特定单元格开始选择整列

> ID：13166510
> 
> 赞同：9
> 
> 时间：2012-10-31T19:56:19.143
> 
> 标签：excel, vba

如何选择特定单元格后的整列？

例如，我想选择之后的整个列，`C24`以便包括`C24, C25, ...`

我使用以下代码段没有成功：

```
ActiveSheet.Range("C24", ActiveSheet.Range("C24").End(xlDown)).Select 
```

有人可以纠正我的错误吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-31T20:03:02.300

您只需将两个引用包装在 a 中`Range`：

```
Range(ActiveSheet.Range("C24"), ActiveSheet.Range("C24").End(xlDown)).Select 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-31T20:12:54.160

即使存在内容低于 C24 的单元格，也可以使用以下方法：

```
With ActiveSheet
.Range(.Range("C24"), .Range("C" & .Rows.Count)).Select
End With 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T16:57:29.457

我不知道您是否想要一个公式，或者是否有任何方法可以工作，但是如果您选择要启动的单元格并按住 ctrl+shift+向下箭头，它将选择该单元格及其下方的所有内容。

# google-maps - 谷歌地图引擎和谷歌地图静态 API

> ID：13166512
> 
> 赞同：1
> 
> 时间：2012-10-31T19:56:22.587
> 
> 标签：google-maps, google-maps-api-3

我正在创建一个使用图块显示地图的应用程序。我正在寻找一种方法来显示使用此应用程序在我的 Google 地图引擎帐户上创建的内容。我发现 Google Maps Static API 确实可以工作，但没有找到任何关于这是否适用于 Google Maps Engine 内容的信息。是否可以使用静态 API 显示 GME 内容？

# php - 如何从嵌入在 JS 代码中的 PHP 变量的 PHP 文件中输出 Javascript？

> ID：13166513
> 
> 赞同：3
> 
> 时间：2012-10-31T19:56:21.580
> 
> 标签：php, javascript

我想将 JS 代码片段从 PHP 文件中移出并移到它们自己的文件中，以使代码更清洁且更易于维护。例如，我有这个功能：

```
function load_script($fieldname)
{
  return
  'var help = function () {alert(' . '"EDITOR HELP:\n\n' . 
                                     'blah blah.\n\n' . 
                                     'more blah blah.\n\n' . 
                                     ');}' . "\n" .
  'var options = { handler: help, title: "Editor help" };' . "\n" .
  'var converter = Markdown.getSanitizingConverter();' . "\n" .
  'var editor = new Markdown.Editor(converter, "-'.$fieldname.'", options);' . "\n" .
  'editor.run();' . "\n";
} 
```

注意`$fieldname`PHP 变量。

这个想法是将 JS 部分存储在 .js 文件中。然后我将它作为纯文本读入，以便在 return 语句中输出。换句话说，是这样的：

```
function load_script($fieldname)
{
  $output = file_get_contents("load_script.js");
  return $output;
} 
```

显然问题是这不会`$fieldname`用相应的值代替。

我目前对此的想法是`$output`通过字符串替换来运行：

```
function load_script($fieldname)
{
  $output = file_get_contents("load_script.js");
  $output = str_replace("some_unique_identifier", $fieldname, $output);
  return $output;
} 
```

有更好的方法吗？

编辑：

我应该在这背后添加一些动机：

首先，给出的示例很难看，除了最简单的 JS 片段外，很难维护。犯错的空间很大。

其次，当您以这种方式混淆时，编辑器在检查语法和突出显示方面并不是很有帮助。

第三，让 JS 在自己的文件中运行可以更轻松地运行在整个站点上运行的缩小脚本（因此您不必手动维护缩小）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:04:22.743

您可以使用模板引擎来执行此操作（例如 Smarty）。只需使用 PHP 变量所在的模板变量编写 JS 文件，然后通过 PHP 加载它们。

你甚至可以推出你自己的简单的。就像是：

```
// in JS file:
function myFunc() {
    alert("hello %s");
}

// in PHP file:
<?PHP
    //... code to open JS file and load into string....
    echo sprintf($contentsOfJSFile, "John Doe");
?>

RESULTING OUTPUT: 

function myFunc() {
    alert("hello John Doe");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:06:10.607

正如有人已经提到的，JS 文件就像 HTML，而 HTML 又就像 PHP 文件。所以像这样创建你的javascript文件

```
<?php
//my_script.php
?>

<script>
 var foo = "<?= $bar ?>";
</script> 
```

然后，在你的 php 中：

```
$bar = 'some value';
include('my_script.php'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:01:18.237

不幸的是，不是真的，或者至少不是开箱即用的。有一些聪明的解决方案，比如 Backbone，它可能会让你的任务更容易或更理智，但也可能需要重写。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T20:02:04.057

简而言之，输出js和输出html是一样的。您可以嵌入 php 变量，但就转义引号和文字与引用而言，您必须遵守相同的规则。它很快就会变得丑陋和乏味。

我做什么取决于JS和变量的数量。有时我为我所有的 js 制作字符串，然后将它们粘在一起，比如

```
$js_function_pt1 = "var help = function() { ..."
$js_function_pt2 = "..."

return $js_function_pt1 + $fieldname + $js_function_pt2 + .... 
```

如果你可以在你的 js 中保留所有单引号，你就有一点额外的奢侈，因为你可以将你的 js 输出用双引号括起来，然后来自 php 的变量引用将被解释为变量并被评估。

```
$output = " var help = function() { alert('blah blah $fieldname') } " 
```

# ios - iOS 在推送新视图时携带数据

> ID：13166515
> 
> 赞同：0
> 
> 时间：2012-10-31T19:56:44.433
> 
> 标签：ios, tableview, pushviewcontroller, nsobject

我有一个解析 XML 并存储在 NSObject（“调用”）中的应用程序。然后我在数据中显示表格，如下所示：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
Call *currentCall = [[xmlParser calls] objectAtIndex:indexPath.row];

static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell==nil) {
    cell = [[UITableViewCell alloc]initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];

}

cell.textLabel.text = currentCall.call_name;
cell.detailTextLabel.text = currentCall.location;
cell.accessoryType = UIButtonTypeRoundedRect;

return cell;
} 
```

我的问题是，当我推送到详细视图控制器时，如何设置 didSelectRowAtIndexPAth 方法以访问所有对象属性？我曾经使用这种方式，它有效，但我确信这不是最有效的方式。谢谢您的帮助。

老办法：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
NSLog(@"indexPath = %d", indexPath.row);

Call *currentCall = [[xmlParser calls] objectAtIndex:indexPath.row / 2];

self.currentCallTypeDetail = currentCall.currentCallType;
self.unitsDetail = currentCall.units;
self.locationDetail = currentCall.location;
self.countyDetail = currentCall.county;
self.stationDetail = currentCall.station;
self.fullcallnumberDetail = currentCall.fullcallnumber;
self.latitude = currentCall.latitude;
self.longitude = currentCall.longitude;
self.callTypeDetail = currentCall.callType;
self.callNumberDetail = currentCall.callnumber;
self.timeDetail = currentCall.time;

[tableView deselectRowAtIndexPath:indexPath animated:YES];

UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle: nil];
CallTypeDetailController *vc = [storyboard instantiateViewControllerWithIdentifier:@"calltypedetail"];

[vc setCurrentCallTypeDetail:self.currentCallTypeDetail];
[vc setUnitsDetail:self.unitsDetail];
[vc setLocationDetail:self.locationDetail];
[vc setCountyDetail:self.countyDetail];
[vc setStationDetail:self.stationDetail];
[vc setFullcallnumberDetail:self.fullcallnumberDetail];
[vc setCallTypeDetail:self.callTypeDetail];
[vc setCallNumberDetail:self.callNumberDetail];
[vc setTimeDetail:self.timeDetail];
[vc setLatitude:self.latitude];
[vc setLongitude:self.longitude];

[self.navigationController pushViewController:vc animated:YES];

NSLog(@"Selected Call = %@", self.currentCallTypeDetail);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:28:41.513

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
NSLog(@"indexPath = %d", indexPath.row);

Call *currentCall = [[xmlParser calls] objectAtIndex:indexPath.row / 2];

[tableView deselectRowAtIndexPath:indexPath animated:YES];

UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle: nil];
CallTypeDetailController *vc = [storyboard instantiateViewControllerWithIdentifier:@"calltypedetail"];

[vc setCurrentCall:currentCall];

[self.navigationController pushViewController:vc animated:YES];

NSLog(@"Selected Call = %@", self.currentCallTypeDetail);
} 
```

# html - HTML 选择选项元素

> ID：13166519
> 
> 赞同：0
> 
> 时间：2012-10-31T19:57:10.507
> 
> 标签：html, spring, spring-mvc, listboxitem

我有一个从数据库中检索的颜色列表，该列表包含颜色代码，例如#FFEBCD、#FFFFFF 等，我想将列表中每个选项的背景颜色设置为其背景颜色。有人可以告诉我这是否可能，我怎样才能让每个列表项使用颜色代码来反映它们的颜色。下面是代码。我想真正将颜色显示为列表项的背景。

```
 <li>
        <form:label for="eyeColorId" path="eyeColorId">Select Eye Color</form:label>        
        <form:select path="eyeColorId" id="eyeColorId">
        <form:options items = "${eyeColor.eyeColorList}" itemValue="colorCode" itemLabel="colorDesc" style="background-color: ${colorCode}"/>
        </form:select>          
        <form:errors path="eyeColorId" id="errors"/>
    </li> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:46:54.923

由于每个选项都需要有不同的样式，因此您只需要遍历列表的元素并使用[`<form:option>`标签为每个元素生成一个选项](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/htmlsingle/spring-framework-reference.html#spring-form.tld.option)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:12:08.083

`option`原则上，您可以像任何其他元素一样设置元素的样式。在实践中，特别是在较旧的浏览器中存在一些限制，并且有一些奇怪的地方。在现代浏览器中，着色在某种意义上是有效的，正如您通过测试所看到的那样

```
<select>
<option style="background: red">option
<option style="background: green">other option
</select> 
```

颜色并不完全按照您想要的方式工作，因为专注于一个选项会改变它的渲染。此外，如果可能出现任何颜色或多种颜色，您会使用什么颜色作为文本颜色来创建足够的对比度？

因此，更好的方法是使用一组复选框或单选按钮（取决于选择的类型）并将彩色框关联为颜色样本，例如

```
<style>
.colorbox {
  display: inline-block;
  width: 1em;
  height: 1em;
  border: solid 1px black;
}
</style>
<fieldset>
<input type=radio name=color value="#FFEBCD" id=FFEBCD>
  <label for=FFEBCD><span class=colorbox style="background: #FFEBCD">&nbsp;
    </span>blanche dalmond</label><br>
<input type=radio name=color value="#FFFFFF" id=FFFFFF>
   <label for=FFFFFF><span class=colorbox style="background: #FFFFFF">&nbsp;
    </span>white</label>
</fieldset> 
```

还有另一种可能性，在您可以依赖所有拥有现代浏览器的用户的奢侈情况下，您甚至可以使用 HTML5 方式：

```
<input type=color name=color list=colors>
<datalist id=colors>
  <option value="#FFEBCD" label="blanche dalmond">
  <option value="#FFFFFF" label="white">
</datalist> 
```

然而，这在不支持的浏览器上会降级：变成一个简单的文本输入框，用户需要知道或猜测他必须输入像#FFEBCD 这样的十六进制代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T04:31:46.573

尝试这个。

```
 <li>
        <form:label for="eyeColorId" path="eyeColorId">Select Eye Color</form:label>        
        <form:select path="eyeColorId" id="eyeColorId">
        <c:forEach items = "${eyeColor.eyeColorList}" var = "color">
        <form:option style="background-color: ${color}"/>
        </c:forEach>
        </form:select>          
        <form:errors path="eyeColorId" id="errors"/>
    </li> 
```

# html - 如何让cfspreadsheet呈现html

> ID：13166522
> 
> 赞同：3
> 
> 时间：2012-10-31T19:57:11.660
> 
> 标签：html, coldfusion, coldfusion-9, cfspreadsheet

我正在尝试使用 cfspreadsheet 创建一个 excel 文件。在其中一列中，我有 html 代码，但由于某种原因，在 excel 文件中，html 没有被呈现，它只是纯文本。例如。`<b>blabla</b>`而不是加粗。

你知道有什么解决办法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-17T17:57:01.403

原因是`cfspreadsheet`基于[不支持 html 内容](http://apache-poi.1045710.n5.nabble.com/Display-parsed-HTML-content-td4298794.html)的 POI 。

正如[user1450455 提到](https://stackoverflow.com/questions/13166522/how-to-get-cfspreadsheet-to-render-html#13912431)的，您可以使用任何内置格式化函数（例如 SpreadsheetFormatCell）来格式化*整个单元格。*

```
 sheet = spreadSheetNew();
  spreadSheetFormatCell( sheet, {bold=true} , 1, 1 );
  spreadSheetSetCellValue( sheet, "blablah", 1, 1 ); 
```

如果您希望创建[具有多种格式的单元格](http://apache-poi.1045710.n5.nabble.com/Can-POI-Excel-change-cell-font-color-partially-td2856775.html)（即加粗某些字符但不加粗其他字符），这只能通过创建[RichTextString](http://poi.apache.org/apidocs/org/apache/poi/ss/usermodel/RichTextString.html)使用底层 POI 库来实现。所以它需要低得多的代码。

```
<cfscript>
    sheet     = spreadSheetNew();
    workbook  = sheet.getWorkBook();
    helper    = workbook.getCreationHelper();
    richText  = helper.createRichTextString("ColdFusion");

    // make first few characters bold ie "Cold"
    firstFont = workbook.createFont();
    firstFont.setBoldweight( firstFont.BOLDWEIGHT_BOLD );
    richText.applyFont( 0, 4, firstFont );

    // make next characters red ie "Fusion"
    secondFont = workbook.createFont();
    secondFont.setColor( secondFont.COLOR_RED );
    richText.applyFont( 4, 10, secondFont );

    // create cell via CF and apply formats
    // note, in POI indexes are base 0
    spreadSheetSetCellValue( sheet, "", 2, 1);
    cellA2 = workbook.getSheetAt(0).getRow(1).getCell(0);
    cellA2.setCellValue( richText );
</cfscript> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T10:33:43.330

您可以使用电子表格格式化功能，例如`SpreadsheetFormatRow`or`SpreadsheetFormatrows`或`SpreadsheetFormatColumns`。

# c# - 我想不出一个好的设计来处理对阻塞资源的多次调用

> ID：13166523
> 
> 赞同：1
> 
> 时间：2012-10-31T19:57:13.487
> 
> 标签：c#, .net, winforms, software-design

我正在尝试用最佳方法将多个类处理为使用阻塞资源的方法。

**目标**：

允许对使用`DataReader`. 当第一次调用正在进行时，保持其余调用（如果存在）保持直到方法结束。

当这个方法完成它的执行时，我需要丢弃在第一次执行过程中累积的每个请求，只允许最后一个请求执行。

具体来说，我正在处理一个对象中的重复事件触发，该`Windows.Forms`对象调用`DataReader`未完成执行的 a 并且它后面的下一个调用引发异常。

设计这部分的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T20:06:14.357

所以你有一个事件处理程序，它会随着时间的推移反复触发。如果先前触发的处理程序仍在运行，您希望它什么也不做。这很简单，只需添加一个布尔值“isRunning”作为实例字段，如果是真的什么也不做。请注意正确同步对变量的访问：

```
private int isRunning = 0;//there is no bool overload for `Interlocked.Exchange`
private void button1_Click(object sender, EventArgs e)
{
    if (Interlocked.Exchange(ref isRunning, 1) == 0)
    {
        //do stuff

        isRunning = 0;
    }
    else
    {
        //another handler is already in progress; 
        //possibly display message to user, or do nothing, or whatever
    }
} 
```

如果您不希望跳过后续事件处理程序，而只是希望它们等待并确保一次只有一个执行查询，那么您可以使用`lock`：

```
private object key = new object();
private void button1_Click(object sender, EventArgs e)
{
    lock (key)
    {
        //do stuff
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:04:21.357

在 Java 中，您将标记该方法`synchronized`，一切都会好起来的。

在 C# 中，您需要做更多的工作。有关一些选项，请参阅[此问题](https://stackoverflow.com/questions/541194/c-sharp-version-of-javas-synchronized-keyword)。接受的答案对我来说似乎不是最好的答案。首先尝试使用`lock`关键字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:27:01.470

> 如果`R1`在处理请求时收到请求`R2`，`R3`并按`R4`该顺序接收，`R2`则应`R3`丢弃该请求，并`R4`应在处理完成*后进行* `R`处理。

伪代码如下所示：

**接收请求线程**

```
if current_request is null
    assign to current_request
else
    assign to next_request 
```

**处理请求线程：**

```
while true
    if current_request is not null
        process it
        set current_request = next_request, next_request = null 
```

更改`next_request`并`current_request`应使用相同的`lock`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T12:55:21.307

最好使用 Reactive Extension 完成，只需使用 Throttle 事件触发器

# jquery - 禁用 onload javascript 弹出功能

> ID：13166529
> 
> 赞同：0
> 
> 时间：2012-10-31T19:57:24.057
> 
> 标签：jquery, event-handling, onload-event

如果将请求加载到 iframe 中，我需要禁用动态 onload 弹出窗口。我认为使用事件监听器可能是最好的方法，但我不熟悉这个对象。

在这种情况下，最好的用法是什么。

谢谢

# jquery - 在 FadeIn/FadeOut 之后返回 null 的元素

> ID：13166531
> 
> 赞同：0
> 
> 时间：2012-10-31T19:57:47.543
> 
> 标签：jquery, fade

我正在使用 jquery 淡入一个元素：

```
$("#bookcase_container").fadeOut( function(){
  $("#bookcase_container").html("<canvas id='shelf_canvas'></canvas>").fadeIn();
});
loadCanvasEditor(); 
```

然后在画布编辑器中，我尝试像这样设置画布元素的高度：

```
function loadCanvasEditor(){
  document.getElementById("shelf_canvas").height = "900px";
} 
```

但是我收到一个错误，指出shelf_canvas 为空。我也尝试过使用纯 jquery，但没有得到任何结果（没有错误消息或更改的分辨率）：

```
$("#shelf_canvas").height(900); 
```

我也尝试使用 .ready() 和 onload 用于shelf_canvas 以及$(document)，但仍然没有结果。如果我不使用淡出/淡入，这段代码可以正常工作。可能出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T08:36:27.007

`fadeOut`您使用的动画是异步操作。`loadCanvasEditor`因此，当您尝试调用函数时，无法访问动画完成后插入 DOM 的 HTML 。如果将此调用合并到回调中，则应按预期工作：

```
$("#bookcase_container").fadeOut( function(){

  $("#bookcase_container").html("<canvas id='shelf_canvas'></canvas>").fadeIn();
  loadCanvasEditor();

}); 
```

*额外的可能性*：使用`promise`jQuery-animations 公开的界面（在具有大量元素的更复杂的情况下有用）：

```
$("#bookcase_container").fadeOut( function(){

  $("#bookcase_container").html("<canvas id='shelf_canvas'></canvas>").fadeIn();

}).promise().done(function(){

   loadCanvasEditor();

}); 
```

请参阅该方法**[的演示小提琴](http://jsfiddle.net/TnLm5/1/)**。

页面上提供了**[有关这两种情况的文档](http://api.jquery.com/fadeOut/#callback-function)**`.fadeIn()`

# java - 如何使用 gcj 单独编译文件？

> ID：13166532
> 
> 赞同：2
> 
> 时间：2012-10-31T19:57:48.857
> 
> 标签：java, compiler-construction, gcj

我使用 gcj（Cygwin 版本）编译 2 个 java 文件

$ gcj --version gcj (GCC) 3.4.4 (cygming special, gdc 0.12, using dmd 0.125) 版权所有 (C) 2004 Free Software Foundation, Inc. 这是免费软件；查看复制条件的来源。没有保修；甚至不考虑适销性或特定用途的适用性。

这是我的 2 个 java 文件：

$ cat MyClass.java

```
public class MyClass {  
   public MyClass() {  
      System.out.println("Hello, MyClass");  
   }  
} 
```

$猫HelloWorld.java

```
public class HelloWorld {  
   public static void main(String[] args) {  
      MyClass myclass = new MyClass();  
      System.out.println("Hello, World");  
   }   
} 
```

我可以在 HelloWorld 中执行代码

```
$ gcj.exe -o hello --main=HelloWorld --classpath=. HelloWorld.java MyClass.java 
```

我想单独编译它们

```
gcj.exe -C MyClass.java 
```

然后

```
gcj.exe  --main=HelloWorld --classpath=. HelloWorld.java 
```

问题是我得到

```
/tmp/ccKwa7F4.o: In function '_ZN10HelloWorld4mainEP6JArrayIPN4java4lang6StringEE':  
/home/lucm/HelloWorld.java:3: undefined reference to `MyClass::class$'  
/home/lucm/HelloWorld.java:3: undefined reference to `MyClass::MyClass()'  
collect2: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-01T19:21:26.203

编译为.o 时，链接模型基本上是类C 的。您必须编译所有文件。因此，您要做的是将每个编译为 .o 并链接结果：

```
gcj -c MyClass.java
gcj -c HelloWorld.java
gcj --main=HelloWorld MyClass.o HelloWorld.o 
```

当引入二进制兼容性 ABI 时，此规则在 gcj 的更高版本中有一些例外。以上是使其工作的最基本方法。

# python - 替换 Python AST 树的一部分

> ID：13166537
> 
> 赞同：2
> 
> 时间：2012-10-31T19:57:54.183
> 
> 标签：python, abstract-syntax-tree, genetic

我是使用 AST 的新手，但我接到了一个“从头开始的遗传编程”任务，据我所知，AST 似乎是操纵树的方法。

我需要做的是用另一棵树的一个分支替换树的一个分支（在遗传编程术语中-“交叉”）。

谁能建议如何最好地解决这个问题？正如我所说，我是 AST 的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T16:14:25.063

[Ayende Rahien](http://ayende.com/blog)的Book [DSLs in Boo: Domain-Specific Languages in .NET](http://www.manning.com/rahien/)详细解释了 AST 操作。他使用[Boo](http://boo.codehaus.org/)语言来解释它是如何工作的，但 AST 树操作描述非常通用。

# javascript - Javascript/HTML 灰色广播列表？

> ID：13166539
> 
> 赞同：2
> 
> 时间：2012-10-31T19:58:00.550
> 
> 标签：javascript, input, radio

有没有办法可以将 html 单选列表输入“变灰”？我知道我实际上可以改变颜色。但我想这样做，这样单选按钮列表也不能切换。我还希望它在此状态下“突出显示”或切换到特定的广播列表。

因此，例如这个广播列表：

```
 <input type="radio" name="group2" value="Water"> Water<br />
 <input type="radio" name="group2" value="Lemonade"> Lemonade<br />
 <input type="radio" name="group2" value="Juice"> Juice<br /> 
```

我希望用户不能单击/更改收音机列表。我希望单选按钮与“果汁”选项相关联。

这只需要与 Internet Explorer 兼容。

我不能使用 JQuery！请不要粘贴 JQuery，因为它对我没有帮助！

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T19:59:50.503

只需将“禁用”属性应用于您想要禁用的元素并将“选中”为默认值。

```
<input type="radio" name="group2" value="Water" disabled> Water
<input type="radio" name="group2" value="Water"> Lemonade
<input type="radio" name="group2" value="Water" checked> Juice 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T19:59:38.207

只需使用“禁用”属性禁用它。

给它一个“id”以更容易地获取它：

```
document.getElementById("radioButtonX").disabled = true; 
```

（当然，如何获得对 DOM 节点的引用并不重要。）您可以通过将属性设置为`false`. 当您禁用它时，您还必须设置`true`您希望选择的任何其他按钮的“已检查”属性（为 ）。

如果你想用 HTML 来做，你可以使用属性：

```
<input type=radio name=whatever value=xyz disabled=disabled> <!-- or just "disabled" with no value --> 
```

# eclipse - 从 BeanShell 断言脚本调用 Jmeter 函数

> ID：13166543
> 
> 赞同：1
> 
> 时间：2012-10-31T19:58:17.707
> 
> 标签：eclipse, jmeter, jmeter-plugins

我正在尝试在 Eclipse 中运行 jmeter 测试套件。
在我的测试套件中，我使用 BeanShellAssertion 来计算 csv 文件中的行数。
我有一个自定义的 jmeter 函数可以这样做。
BeanShellAssertion 的脚本是：

```
String str = "${__CustomFunction("Path to the CSV file")}";
int i = Integer.parseInt(str);
if(i ==0)
{
   Failure = true;
   FailureMessage = "Failed!";
}
return i; 
```

当我在本地机器上使用 jmeter 运行该测试套件时，它运行良好。
只有当我尝试使用 eclipse 运行它时，（使用 jmeter maven 插件）我才看到以下错误：

> jmeter.util.BeanShellInterpreter：调用 bsh 方法时出错：eval 源文件：内联评估：``String str = "${__CustomFunction("FilePath")}"; 整数 i = 整数。. . ''：类型化变量声明：方法调用 Integer.parseInt

我想知道在使用 eclipse 执行 jmeter 函数时是否还有其他方法可以调用它，因为我确信该函数是正确的，正如我之前提到的，当在我的本地机器上使用 jmeter 运行测试套件时它可以正常工作。

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T15:19:13.083

您确定您的自定义函数 jar 对 Maven 插件可见吗？

当你从 JMeter 运行它时，它可以工作，我想你在 lib/ext 中有一个 jar。

所以你需要让这个 jar 可用于 jmeter maven 插件。

# linux - 如何杀死zsh中的所有后台进程？

> ID：13166544
> 
> 赞同：15
> 
> 时间：2012-10-31T19:58:19.610
> 
> 标签：linux, background, zsh, jobs

如标题 - 如何杀死 zsh 中的所有后台进程？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-31T20:52:16.253

```
alias killbg='kill ${${(v)jobstates##*:*:}%=*}' 
```

. 它是 zsh，不需要外部工具。

如果你想杀死工作编号 N：

```
function killjob()
{
    emulate -L zsh
    for jobnum in $@ ; do
        kill ${${jobstates[$jobnum]##*:*:}%=*}
    done
}
killjob N 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-08-08T16:08:16.580

应该将[`builtin`](http://zsh.sourceforge.net/Doc/Release/Shell-Builtin-Commands.html)zsh 内置命令与其他[`kill`](http://zsh.sourceforge.net/Doc/Release/Shell-Builtin-Commands.html)zsh 内置命令一起使用：

```
builtin kill %1 
```

as[`kill`](https://github.com/karelzak/util-linux/blob/master/misc-utils/kill.c)也是一个独立的二进制**文件**，来自**不支持作业**( ) 的[`util-linux`](https://en.wikipedia.org/wiki/Util-linux)包（[上游](https://git.kernel.org/pub/scm/utils/util-linux/util-linux.git/tree/)、[镜像](https://github.com/karelzak/util-linux)）。`/usr/bin/kill`**`kill: cannot find process "%1"`**

 **使用关键字`builtin`来避免名称冲突或内置（如果它被禁用）[`enable`](http://zsh.sourceforge.net/Doc/Release/Shell-Builtin-Commands.html)。`kill`

* * *

在 shell 中有一个禁用和启用内置命令（即 shell 自己的命令，例如`cd`and `kill`）的概念，在[zsh](/questions/tagged/zsh "显示标记为“zsh”的问题")中，您可以启用（禁用的）`kill`内置命令：

```
enable kill 
```

* * *

`disable`检查内置是否被禁用（并`enable`查看启用的）的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-12-08T12:51:01.450

对@Zxy 的回复稍作调整……

在我的系统上，我发现挂起的作业没有被默认的终止信号正确终止。我实际上必须将其更改`kill -KILL`为让`suspended`后台工作正常结束。

```
alias killbg='kill -KILL ${${(v)jobstates##*:*:}%=*}' 
```

请特别注意围绕此的单引号。如果切换到双引号，则需要转义每个“$”。请注意，您不能使用 a`function`来包装此命令，因为该函数将增加`$jobstates`数组，从而导致该函数尝试杀死自己...必须使用别名。

上面的`killjob`脚本有点多余，因为你可以这样做：

```
kill %1 
```

更少的击键，它已经内置到`zsh`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-01T10:53:57.537

这适用于 ZSH 和 Bash：

```
: '
killjobs - Run kill on all jobs in a Bash or ZSH shell, allowing one to optionally pass in kill parameters

Usage: killjobs [zsh-kill-options | bash-kill-options]

With no options, it sends `SIGTERM` to all jobs.
'
killjobs () {

    local kill_list="$(jobs)"
    if [ -n "$kill_list" ]; then
        # this runs the shell builtin kill, not unix kill, otherwise jobspecs cannot be killed
        # the `$@` list must not be quoted to allow one to pass any number parameters into the kill
        # the kill list must not be quoted to allow the shell builtin kill to recognise them as jobspec parameters
        kill $@ $(sed --regexp-extended --quiet 's/\[([[:digit:]]+)\].*/%\1/gp' <<< "$kill_list" | tr '\n' ' ')
    else
        return 0
    fi

} 
```

@zyx 答案对我不起作用。

更多信息在这里：[https ://gist.github.com/CMCDragonkai/6084a504b6a7fee270670fc8f5887eb4](https://gist.github.com/CMCDragonkai/6084a504b6a7fee270670fc8f5887eb4)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T19:58:48.363

```
alias killbg='for job in \`jobs -l | egrep -o "([0-9][0-9]+)"`; 
```**

# javascript - Jquery 不会将事件绑定到 ajax 添加的 dom

> ID：13166546
> 
> 赞同：1
> 
> 时间：2012-10-31T19:58:39.377
> 
> 标签：javascript, jquery, html, ajax, dom

我有一个 ajax 函数，可以加载 4 个复选框的内容，如下所示：

```
$.ajax({
url : some url..,
dataType : 'json',
success : function(data) {
    buildCheckboxes(data);
    },
error : function(data) {
            do something...
    }
}); 
```

构建复选框方法执行以下操作：

```
function updateNotificationMethods(items) {
    var html = [];
    $.each(items, function(i, item) {
        htmlBuilder = [];
        htmlBuilder.push("<input type='checkbox' class='checkbox-class' name='somename' value='");
        htmlBuilder.push(item.id);
        htmlBuilder.push("'");
        htmlBuilder.push("/>&nbsp;");
        htmlBuilder.push(item.name);
        htmlBuilder.push("<br/><br/>")
        html.push(htmlBuilder.join(''));
    });
    $("#div").html(html.join(''));
} 
```

我还有一个事件绑定器，应该在复选框值更改时触发：

```
$(".checkbox-class").change(function() {
alert("change");
 }); 
```

如果我在源代码中有复选框 html（即静态），而不是我在这里的设置，它可以工作，我从服务器动态加载数据。

我能做些什么来及时进行绑定吗？

和平！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T20:00:47.803

这是因为当您绑定处理程序时该元素不存在。

试试这个：

```
$( document ).on( 'change', '.checkbox-class', function() {
    alert("change");
}); 
```

或者，如果您使用的是旧版本的 jQuery（小于 1.7）...

```
$( '.checkbox-class' ).live( function() {
    alert("change");
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T20:00:00.643

绑定事件时复选框不可用。 [jsfiddle](http://jsfiddle.net/AL59x/2/)

假设在绑定事件时存在 id 为 div 的元素。

```
$("#div").on("change",".checkbox-class",function() {
     alert("change");
 }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:27:19.673

这段代码：

```
$(".checkbox-class").change(function() {
alert("change");
}); 
```

**不要建立一个连续的和持续的规则**，相反，这段代码将一个事件管理器（在本例中是更改事件）附加到执行时存在的每个匹配的 DOM 对象。
如果您愿意，可以在每次将复选框添加到 DOM 时重新执行此代码（或类似且窄的代码）。

# javascript - 搜索蜘蛛是否会抓取已被 js 删除的元素？

> ID：13166548
> 
> 赞同：0
> 
> 时间：2012-10-31T19:58:51.177
> 
> 标签：javascript, seo, web-crawler

我正在使用 jQuery 的`remove()` Look in firebug 从 dom 中删除一些元素，我可以看到这些元素已被删除，但查看它们所在页面的源代码。我的问题是机器人如何解释这一点。当他们爬行时，他们基本上会看到我在查看源代码时看到的内容，还是 Firebug 显示的已删除元素的视图更准确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:02:37.510

例如，GoogleBot 确实会执行 JavaScript，但并不总是与抓取您的网站同时进行（它将 JS 存储在一个队列中，并在资源可用时执行它）。不要指望 JavaScript 删除不应访问的页面元素。机器人和人类始终可以查看您的源代码，而 JavaScript 不会更改源代码。

# lucene - 有 Go 的 Lucene 包吗？

> ID：13166549
> 
> 赞同：0
> 
> 时间：2012-10-31T19:58:52.340
> 
> 标签：lucene, go

鉴于 Go 的命名相当无害，Google 搜索这样的包只会为我搜索 Go 的 Lucene 包产生一个可辨别的结果：[this one with no commits](http://code.google.com/p/golucene/)。

有人知道 Go 的任何 Lucene 端口吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T20:27:41.747

我认为这个 Go SOLR 库看起来更有前途。

[https://github.com/rtt/Go-Solr/](https://github.com/rtt/Go-Solr/)

看起来有点偏瘦，但可能会让你到达某个地方。

或者，与 Elasticsearch 类似的故事：

[https://github.com/dustin/go-elasticsearch](https://github.com/dustin/go-elasticsearch)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-04-21T01:17:53.803

[go, bleve](https://github.com/blevesearch/bleve)还有另一个文本索引库

这些功能与 lucene 非常相似。

# 索引

```
message := struct{
    Id   string
    From string
    Body string
}{
    Id:   "example",
    From: "marty.schoch@gmail.com",
    Body: "bleve indexing is easy",
}

mapping := bleve.NewIndexMapping()
index, err := bleve.New("example.bleve", mapping)
if err != nil {
    panic(err)
}
index.Index(message.Id, message) 
```

# 查询

```
index, _ := bleve.Open("example.bleve")
query := bleve.NewQueryStringQuery("bleve")
searchRequest := bleve.NewSearchRequest(query)
searchResult, _ := index.Search(searchRequest) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-02T15:32:39.663

您还可以查看[Apache Lucy](http://lucy.apache.org/)，它是 Lucene 的“松散 C”端口。

# python - 在 Windows 中设置默认 pylint config.rc 文件

> ID：13166550
> 
> 赞同：9
> 
> 时间：2012-10-31T19:58:52.567
> 
> 标签：python, windows, pylint

我在 Windows 下使用 Pylint，它没有读取我的 pylint-config.rc 文件。有没有办法在 Windows 中为 Python 设置一个默认的 .rc 文件，这样我就不必继续在命令行中输入它了？谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-01T08:48:57.203

我手头没有要测试的 Windows 框，但代码用于`os.path.expanduser('~')`查找当前用户的主目录，并在该目录中查找文件调用`.pylintrc`。

根据[python 文档](http://docs.python.org/3/library/os.path.html?highlight=expanduser#os.path.expanduser)，在 Windows 上，`expanduser`如果设置了 HOME 和 USERPROFILE，则使用 HOMEPATH 和 HOMEDRIVE 的组合。所以我的建议是在 Python 交互式会话中检查以下脚本输出的内容：

```
import os
print os.path.expanduser('~') 
```

并将配置文件放在该文件`.pylintrc`夹中。

或者，如果您想在每个项目的基础上使用不同的配置文件，您应该知道如果当前工作目录中有一个名为`pylintrc`（没有前导点）的文件，那么 Pylint 将使用这个文件。如果当前工作目录中有文件被调用`__init__.py`，Pylint 会在父目录中查找，直到没有该文件，然后再查找`pylintrc`配置文件。这样做是为了让您可以与源代码一起维护每个项目的配置文件，并从源代码树中的任何目录启动 Pylint。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-04-25T13:12:48.350

由于不允许从 Windows 文件资源管理器创建以点开头的文件，因此您可以使用以下命令创建模板：

```
pylint --generate-rcfile > .pylintrc 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-31T19:59:24.813

有两种可能的方法来做到这一点。一种方法是编辑文件`C:\Python\Scripts\pylint.bat`更改行

```
python "%~dpn0" %* 
```

到

```
python "%~dpn0" %* --rcfile="C:\path\to\pylint.rc" 
```

另一种方法是去添加一个环境变量。通过转到`Start->Control Panel->System`然后转到`Advanced`选项卡并单击来执行此操作`Environment Variables`。然后单击`New`并创建一个名为 PYLINTRC 的变量，其值为`C:\path\to\pylint.rc`。

# c++ - 在 llvm 上编写一个简单的清理着陆板

> ID：13166552
> 
> 赞同：12
> 
> 时间：2012-10-31T19:58:55.093
> 
> 标签：c++, exception-handling, llvm

我创建了一个基本函数`Foo1`，它通过调用调用另一个函数`Bar2`。unwind cleanup 基本块中的第一条指令必须是着陆台：

```
void bar2()
{ 
  throw;
}
llvm::Function* Bar2Fn = llvm::Function::Create( voidSig , &bar2);
engine->addGlobalMapping( Bar2Fn, (void*)&bar2 );
llvm::InvokeInst* inv = builder.CreateInvoke( Bar2Fn , continueBlock, unwindBlock, llvmArgValues , "invoke");
builder.CreateBr(continueBlock);
builder.SetInsertPoint(unwindBlock);
llvm::LandingPadInst* landPadInst = builder.CreateLandingPad(...);
//add some cleanup code? where?? 
```

老实说，我不知道我需要在参数之间放置什么才能获得一个基本的着陆台，该着陆台调用当前堆栈对象`CreateLandingPad`的自定义清理代码。可能会通过调用自己抛出的 c++ 函数来抛出（或重新抛出现有异常）`Foo1``Bar2`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T15:00:48.907

我承认我在这里没有什么经验，但是您看过异常演示代码示例吗？它似乎包含您希望找到的那种序列。

基本上，您首先将个性设置为在 C++ 中的行为：

```
llvm::Function *personality = module.getFunction("__gxx_personality_v0"); 
```

然后，您创建具有该个性的着陆板并定义其类型：

```
llvm::LandingPadInst *caughtResult = 
  builder.CreateLandingPad(ourCaughtResultType,
                           personality,
                           numExceptionsToCatch,
                           "landingPad"); 
```

设置要捕获的类型：

```
for (unsigned i = 0; i < numExceptionsToCatch; ++i) {
  // Set up type infos to be caught
  caughtResult->addClause(module.getGlobalVariable(
                          ourTypeInfoNames[exceptionTypesToCatch[i]]));
} 
```

并表示它是一个清理处理程序：

```
caughtResult->setCleanup(true); 
```

就是这样，我相信；现在你可以得到异常本身：

```
llvm::Value *unwindException = builder.CreateExtractValue(caughtResult, 0); 
```

从中获取这些代码段的[ExceptionDemo.cpp文件包含更完整的序列；](https://llvm.org/viewvc/llvm-project/llvm/trunk/examples/ExceptionDemo/ExceptionDemo.cpp?view=markup&sortby=file)具体来说，它展示了如何检查捕获的异常的类型根，并在匹配某些内容时分支到特定块 - 您的清理代码：

```
llvm::Value *retTypeInfoIndex = builder.CreateExtractValue(caughtResult, 1);

// FIXME: Redundant storage which, beyond utilizing value of
//        caughtResultStore for unwindException storage, may be alleviated
//        altogether with a block rearrangement
builder.CreateStore(caughtResult, caughtResultStorage);
builder.CreateStore(unwindException, exceptionStorage);
builder.CreateStore(ourExceptionThrownState, exceptionCaughtFlag);

// Retrieve exception_class member from thrown exception
// (_Unwind_Exception instance). This member tells us whether or not
// the exception is foreign.
llvm::Value *unwindExceptionClass =
  builder.CreateLoad(builder.CreateStructGEP(
           builder.CreatePointerCast(unwindException,
                                     ourUnwindExceptionType->getPointerTo()),
                                             0));

// Branch to the externalExceptionBlock if the exception is foreign or
// to a catch router if not. Either way the finally block will be run.
builder.CreateCondBr(builder.CreateICmpEQ(unwindExceptionClass,
                          llvm::ConstantInt::get(builder.getInt64Ty(),
                                                 ourBaseExceptionClass)),
                     exceptionRouteBlock,
                     externalExceptionBlock); 
```

[最后，在介绍新异常处理机制的博客文章中](http://blog.llvm.org/2011/11/llvm-30-exception-handling-redesign.html)提供了一个附加示例以及说明。

# objective-c - URL 在 Chrome 中返回有效数据/页面，但在 Safari 中不返回（或更重要的是，当通过 Objective C 调用时）

> ID：13166553
> 
> 赞同：0
> 
> 时间：2012-10-31T19:58:55.993
> 
> 标签：objective-c, web-services, google-chrome, safari

我有一个内部可访问的 url，您将无法访问这可能会使这变得困难，但我想看看是否有人有任何明显的我遗漏的东西。url 稍作修改，但所有组件仍然存在。

[http://subdomain.domain.com:9999/Command?auth=1a11111a1111a1a1111a111aa1a1aa11&email=email11@email.com¶meter=123](http://subdomain.domain.com:9999/Command?auth=1a11111a1111a1a1111a111aa1a1aa11&email=email11@email.com&parameter=123)

我正在使用以下方法调用网址：

```
[NSURLConnection sendSynchronousRequest:urlRequest 
                      returningResponse:&response 
                                  error:&requestError]; 
```

我对像@这样的特殊字符使用了编码，但都无济于事。任何建议，将不胜感激。仅在 url 栏中输入时，它在 Chrome 中有效，但如果在 url 栏中输入 Safari，则无效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:30:51.847

我决定在 Safari 上查看源代码并看到我在那里寻找的信息，这导致我返回代码并查看为什么没有正确提取数据。

我需要进一步研究处理 Web 服务调用的代码，结果发现代码被设置为仅处理 JSON，而我正在寻找的数据被剥离，因为它是 XML。

我已经记录了这一点，主要是为了以防它可能对其他人有所帮助，因为他们可以查看。

# c# - 以编程方式隐藏 Crystal Report 中的文本/行

> ID：13166565
> 
> 赞同：6
> 
> 时间：2012-10-31T19:59:38.267
> 
> 标签：c#, crystal-reports

我有一个 Crystal Report，在使用[`CrystalReportViewer`](http://msdn.microsoft.com/en-us/library/aa665753%28v=vs.71%29.aspx).

我有一些静态文本项和线段，我想根据业务逻辑中的条件以编程方式显示和隐藏它们。有没有办法可以将一堆这些项目组合在一起并将它们隐藏为一个组？

目前，我的另一个选择是拥有两个相同的单独报告，除了这些表面上的差异。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T20:05:04.370

无论如何，请不要创建两个单独的报告:)

在报表设计视图中，您应该能够创建详细信息部分的子部分（假设您正在讨论详细信息部分），右键单击详细信息部分并选择“在下面插入部分”。

您现在应该有“详细信息 a”和“详细信息 b”部分。您可以将文本放在“详细信息 b”部分，并对其应用条件抑制公式。

要有条件地抑制“详细信息 b”部分，请在设计视图中右键单击它，选择“格式部分...”，单击“抑制”复选框旁边的按钮，然后在此处添加公式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:06:19.427

执行以下步骤：

1-将必填字段添加到报告画布

2-右键单击该字段

3-选择格式字段菜单选项

4-在格式编辑器对话框的通用选项卡上，按条件格式按钮 [x+2] 按钮以显示字符串选项

5-在公式工作室中输入以下公式：

```
 if {Tablename.Fieldname}= True then Totext(CurrentFieldValue)

else Totext((CurrentFieldValue)) + " Outstanding" 
```

6-按 [保存并关闭] 按钮

7-按“格式编辑器”对话框的“确定”按钮

# sql - sql如何为noob编写复杂的查询？

> ID：13166566
> 
> 赞同：3
> 
> 时间：2012-10-31T19:59:39.140
> 
> 标签：sql, database

这是我的桌子

```
 Student (sname, sid, gpa, level, deptno) 
 Course (cno, cname, deptno, units) 
 Dept (dname, deptno) 
 Takes (sid, cno) 
```

编写一个 SQL 查询，返回在系外上过的课程比在系内上过更多课程的学生的姓名（即 snames）。您可以假设数据库中的所有学生至少在系内上过一门课程。

我不是在为这个问题寻找任何解决方案，但仍然欢迎任何答案。但我更希望人们能告诉我如何生成编写这样一个复杂查询的步骤..

我的回答是

```
 Select S.sname
 From Student S, Course C, Dept D, Takes T
 Where T.cno=C.cno and D.deptno=C.deptno and S.sid = T.sid
 Having COUNT(S.deptno=C.deptno) > COUNT( S.deptno != C.deptno) 
```

我不确定我是否可以以这种方式使用 HAVING 后的计数。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:02:34.507

尽管从未上过 DB / SQL 课程，但我经常处理中等复杂的 SQL 查询，并且发现生成查询的最佳方法是一次处理一个。例如，首先要获取学生名单。然后，他们在部门内外采取的类数，最后，比较查询中的两个值并返回您需要的最终结果集。，

tl;博士：婴儿步骤

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T20:08:46.870

有人认为这是硬件，但这是标准解决方案：

```
 SELECT S.sname from Student S
 WHERE (SELECT COUNT (*) 
 FROM Takes T, Course C
 WHERE S.sid = T.sid AND T.cno = C.cno AND C.deptno = S.deptno)
 < (SELECT COUNT(*)
 FROM Takes T2, Course C2
 WHERE S.sid = T2.sid AND T2.cno = C2.cno AND C2.deptno != S.deptno) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T20:17:27.093

您的第一次尝试，更正：

```
 SELECT S.sname
 FROM Student S, Course C, Dept D, Takes T
 WHERE T.cno = C.cno AND D.deptno = C.deptno AND S.sid = T.sid
 GROUP BY S.sid
 HAVING COUNT(CASE WHEN S.deptno =  C.deptno THEN 1 ELSE NULL END) 
      < COUNT(CASE WHEN S.deptno <> C.deptno THEN 1 ELSE NULL END) ; 
```

并转换为 SQL-92 语法：

```
 SELECT S.sname
 FROM Student S 
   JOIN Takes T   ON S.sid = T.sid
   JOIN Course C  ON T.cno = C.cno
   JOIN Dept D    ON D.deptno = C.deptno
 GROUP BY S.sid        
        , S.sname                  --- this is not needed in SQL-2003
                                   --- but still required by most DBMS     
 HAVING 
        COUNT(CASE WHEN S.deptno =  C.deptno THEN 1 END) 
      < COUNT(CASE WHEN S.deptno <> C.deptno THEN 1 END) ;

                                   --- the ELSE NULL is not needed either
                                   --- it's the implied default 
```

# linear-algebra - ATLAS 调优是如何工作的？

> ID：13166567
> 
> 赞同：2
> 
> 时间：2012-10-31T19:59:47.240
> 
> 标签：linear-algebra, atlas

众所周知，ATLAS 使用矩阵计算算法的“分块”或“平铺”版本，这大大提高了性能。

ATLAS 似乎也有一些[架构默认值](http://math-atlas.sourceforge.net/faq.html#WhyDef)，这些默认值是手动计算的。并且可以进行搜索以确定`NB`（`#define`我认为代表块数的宏）的其他值。

但它是如何工作的？数值是如何确定的？算法是否只是以不同的值（蒙特卡洛风格）运行多次，直到找到某种最优值？

这也是一个假设。假设您将一个阻塞的 ATLAS 算法复制到 C++ 模板中，并且有一个 128 位的有理类型。您能否`NB`以某种方式从算法`NB`的双重版本中的 ATLAS 调整值推导出算法的理性版本？

# windows-8 - Windows phone 8 SDK - 此计算机不支持硬件虚拟化，这意味着 Windows Phone Emulator 8.0 无法在此 PC 上运行

> ID：13166573
> 
> 赞同：7
> 
> 时间：2012-10-31T20:00:01.153
> 
> 标签：windows-8, virtualbox, windows-phone-8

> **可能重复：**
> [无法创建虚拟机](https://stackoverflow.com/questions/13148828/unable-to-create-the-virtual-machine)

安装 WP8 SDK 时出现警告：“此计算机不支持硬件虚拟化，这意味着 Windows Phone Emulator 8.0 无法在此 PC 上运行。”

环境：Windows 8 Enterprise 64，在 VirtualBox VM 上，4G RAM。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T04:59:40.967

这个问题是你不能在一个盒子里面有一个盒子，并且期望每个盒子里都有相同的硬币，也就是说你不能在虚拟机中运行虚拟机并且让它们都使用硬件虚拟化扩展来加速处理，我看起来不像您在虚拟机中运行，这是您的问题。要使用虚拟电话，您必须在基本电脑或另一台兼容 Windows 8 的电脑上安装 Windows 8。由于其编码方式，这是使用该软件的唯一方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:12:21.790

您必须在裸机而不是虚拟机上运行 Windows 8 实例，才能在 WP8 模拟器上测试 WP8 应用程序。
我在这里描述了 WP8 开发的更多要求：
[https ://stackoverflow.com/a/13145586/574062](https://stackoverflow.com/a/13145586/574062)

# ruby-on-rails - 如何为一个视图设置不同的控制器/操作

> ID：13166587
> 
> 赞同：1
> 
> 时间：2012-10-31T20:01:12.667
> 
> 标签：ruby-on-rails, ruby, model-view-controller

拥有一个单一视图的最佳方法是什么（我有一个带有不同部分的html页面（），有点像一页上的迷你页面）并且不同的部分通过那个视图调用不同的控制器和操作？因为在布局中只有一个 <%= yield %> 是可以接受的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T20:13:24.917

您可以考虑使用[partials](http://guides.rubyonrails.org/layouts_and_rendering.html#using-partials)，其中每个部分都分配给一个控制器。在 erb 或 haml 模板中，您可以调用这些部分。例如：

```
<div id="content">
  <%= render "content/articles" %>
  <%= render "news/list" %>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:08:42.887

您可以对视图的不同部分进行部分处理，但我看不出如何为一个请求获得不同的控制器/操作，也不知道为什么这样做是有意义的，除非您的不同部分可以在客户端上独立刷新通过 ajax，在这种情况下，您可以使用不同的控制器/动作来呈现不同的部分。

# java - 为什么我必须将 TextField 声明为 public，而不是 Label

> ID：13166588
> 
> 赞同：6
> 
> 时间：2012-10-31T20:01:16.150
> 
> 标签：java, javafx

我是编程新手；放轻松。:)

我有一个简单的程序（用于学习目的），除非我公开两个 TextField 对象，否则它不会编译。我收到一个错误（ava.lang.IllegalAccessException：类 javafx.fxml.FXMLLoader$ValueElement 无法访问带有修饰符“private”的 firstjavafxprogram.SampleController 类的成员）。而且我无法弄清楚为什么这两个必须公开，但标签可以是私有的。希望我正确发布我的代码：

```
package firstjavafxprogram;

import java.net.URL;
import java.util.ResourceBundle;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.fxml.Initializable;
import javafx.scene.control.Label;
import javafx.scene.control.TextField;

public class SampleController implements Initializable {

    @FXML
    private Label label;
    public TextField txtVolts;
    public TextField txtAmps;

    @FXML
    private void handleButtonAction(ActionEvent event) {
        String labelMessage = getTheMessage();
        label.setText(labelMessage);
    }

    @Override
    public void initialize(URL url, ResourceBundle rb) {
        // TODO
    }  

   @FXML
    private String getTheMessage(){
        String enteredVolts = txtVolts.getText();
        int volts = Integer.parseInt(enteredVolts);

        String enteredAmps = txtAmps.getText();
        int amps = Integer.parseInt(enteredAmps);

        int watts = volts * amps;
        String msgString = "Watts: " + Integer.toString(watts);

        return msgString;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T21:09:51.810

## 改变

```
@FXML
private Label label;
public TextField txtVolts;
public TextField txtAmps; 
```

## 到

```
@FXML
private Label label;
@FXML
private TextField txtVolts;
@FXML
private TextField txtAmps; 
```

按照这个[例子](http://docs.oracle.com/javafx/2/fxml_get_started/FXMLTableViewController.java.html)。

# sql - 将存储的事件转换为单个记录

> ID：13166590
> 
> 赞同：2
> 
> 时间：2012-10-31T20:01:18.580
> 
> 标签：sql, algorithm, parsing

我目前正在开发一个项目，该项目需要使用存储在 SQL 数据库中的数据，格式如下所示。

我需要做的，并且很难找到可以帮助的工具，是获取这些数据并创建一个多列单记录，以 ID 和事件日期为键。虽然我在网上找到了一些关于事件驱动处理程序的信息，但问题是，虽然我的标签上写着“事件”，但真正存储的是称为“事件”的单独数据，这些数据通常是单独的条目，但并非总是如此，同时进入并参与整个事件条目。如果这看起来有点令人困惑，我很抱歉，但我正在使用一个我无法控制更改的系统，我只需要对数据做出有用的理解。

这是存储在数据库中的内容的运行示例，我需要将其转换为单个记录；

```
ID      Event           Event Result  Event Result Value            Event Date      Entered By
909909  Status Change       No          no                          10/25/12 23:10  Doe, John
909909  Disposition         Remuni      Remains in place            10/25/12 23:10  Doe, John
909909  Event duration      15mins      15mins                      10/25/12 23:10  Doe, John
909909  Event end time      23:25       23:25                       10/25/12 23:10  Doe, John
909909  Event start time    23:10       23:10                       10/25/12 23:10  Doe, John
909909  Event type          Iniqrs      Initial System activation   10/25/12 23:10  Doe, John 
```

进入以下单条记录；

```
ID      Event Start Event End   Moved               Action Taken                Entered By
909909  23:10       23:25       Remains in place    Initial System activation   Doe, John 
```

提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:52:25.733

虽然我同意 Bailey S. 的观点，即 Postgres 是“世界上最好的数据库引擎”，但我也看到您使用的是 SQL Server。

**您需要的 MSSQL 函数称为“Pivot”函数，您可以在[此处](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)找到文档。**

最初设置可能有点棘手，但它是完全可行的，并且会给你你正在寻找的结果。

* * *

或者，有一种称为“自连接”的技术，它看起来像这样：

```
SELECT
    [T1].[ID],
    [StatusChange].[EventResultValue] AS 'StatusChange',
    [Disposition].[EventResultValue] AS 'Disposition',
    ...
FROM
    (
        SELECT DISTINCT
            [EventsTable].[ID]
        FROM
            [EventsTable]
    ) AS [T1] LEFT OUTER JOIN
    [EventsTable] AS [StatusChange] ON [T1].[ID] = [StatusChange].[ID] AND [StatusChange].[Event] = 'Status Change' LEFT OUTER JOIN
    [EventsTable] AS [Disposition] ON [T1].[ID] = [Disposition].[ID] AND [Disposition].[Event] = 'Disposition' LEFT OUTER JOIN
    ... 
```

**一点警告：**
如果您使用此技术，它将在每次在`FROM`子句中列出时调用该表。如果您需要几列或者表有大量记录，则可能会降低性能。

* * *

另一种选择是一起使用 group & case 语句：

```
SELECT
    [ID],
    MAX(CASE WHEN [Event] = 'Status Change' THEN [EventResult] ELSE NULL END) AS [Event Start],
    MAX(CASE WHEN [Event] = 'Disposition' THEN [EventResult] ELSE NULL END) AS [Event End]
    ...
FROM
    [EventsTable]
GROUP BY
    [ID] 
```

**更大的警告：**
如果您使用此技术，则保证每个`[ID]`. 如果您有多个相同类型的事件（即任何给定 ID 的事件开始时间可能出现两次，则**不要使用它**，因为其中一些记录将不会返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:31:27.410

对于这样的场景，我喜欢使用一个技巧。这个想法是您希望将数据分组到一个 id。如果`MAX()`与 a 结合使用，`CASE`则基本上可以从该组中所需的行中选择一个值，并将其转换为结果集中的列。
这是查询：

```
select
  id,
  max(case when Event = 'Event start time' then [Event Result Value]
    else null end) as [Event Start],
  max(case when Event = 'Event end time' then [Event Result Value]
    else null end) as [Event End],
  max(case when Event = 'Disposition' then [Event Result Value]
    else null end) as [Moved],
  max(case when Event = 'Event type' then [Event Result Value]
    else null end) as [Action Taken],
  max([Entered By]) as [Entered By]
from Table1
group by id, [Event Date] 
```

[**在这里，**](http://sqlfiddle.com/#!3/7b284/3)您可以看到它正在发挥作用。

请记住，这假设了某些约束。即，对于每个`id, [Event Date]`组合，只有：

*   一个唯一的 [输入者] 值
*   一行事件 = '事件开始时间'
*   一行事件 = '事件结束时间'
*   一行 Event = 'Disposition'
*   一行 Event = 'Event Type'

**注意：** 此查询按 分组`Event Date`。这意味着具有相同日期但不同时间的记录将被视为单独组的一部分。如果您有两组时间戳为同一天但两个不同时间的记录，这将按需要工作。另一方面，如果记录的时间戳稍有偏差，您可能会因为将记录从其预期组中排除而被烧毁。您只需要确保您的组具有一致的时间戳。

# facebook - 通过非确切名称公开搜索 facebook 用户

> ID：13166594
> 
> 赞同：1
> 
> 时间：2012-10-31T20:01:28.337
> 
> 标签：facebook, facebook-graph-api

我想根据用户名对所有 facebook 用户进行公开搜索，但我希望搜索不要使用确切的名称。例如，如果用户搜索“John Ada”，则结果“John Adam”也会被检索到。之后，结果需要按mutual_friend_count 排序。

我设法用以下 FQL 部分做到了这一点：

```
SELECT uid,name, pic_square, profile_url , mutual_friend_count FROM user WHERE contains("Name Surename")
order by mutual_friend_count desc 
```

但它只返回确切的名称，如果名称缺少像我之前的示例那样的字母，则不会检索用户。

我试图弄乱偏移和限制，但也没有成功。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:55:22.307

Facebook 搜索算法似乎已针对查找全名进行了优化。部分名称似乎永远不会像全名那样返回尽可能多的结果。根据我的经验，Facebook 知道如何扩展常见变体的名称。搜索“John Adams”将返回“John Adams”、“Johnny Adams”和“John Addams”

您正在打的另一场战斗是 Facebook 过滤算法。Facebook 首先找到符合您查询的所有匹配项，*然后*过滤它们以供您的用户查看。

您可以尝试添加`AND NOT is_blocked`到您的`WHERE`声明中。这应该在过滤算法之前过滤掉您不可见的任何内容。

# python - 如何使用 GitPython 拉取远程存储库？

> ID：13166595
> 
> 赞同：25
> 
> 时间：2012-10-31T20:01:32.287
> 
> 标签：python, git, gitpython

我正在尝试找到使用 gitPython 提取 git 存储库的方法。到目前为止，这是我从[此处](http://gitpython.readthedocs.org/en/latest/tutorial.html#handling-remotes)的官方文档中获取的内容。

```
test_remote = repo.create_remote('test', 'git@server:repo.git')
repo.delete_remote(test_remote) # create and delete remotes
origin = repo.remotes.origin    # get default remote by name
origin.refs                     # local remote references
o = origin.rename('new_origin') # rename remotes
o.fetch()                       # fetch, pull and push from and to the remote
o.pull()
o.push() 
```

事实是我想访问 repo.remotes.origin 来做一个 pull withouth 重命名它的起源 (origin.rename) 我怎么能做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-10-31T20:16:23.563

我通过直接获取 repo 名称来管理它：

```
 repo = git.Repo('repo_path')
 o = repo.remotes.origin
 o.pull() 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2018-02-08T09:27:24.357

希望你正在寻找这个：

```
import git
g = git.Git('git-repo')
g.pull('origin','branch-name') 
```

拉取给定存储库和分支的最新提交。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-11-24T09:00:29.847

正如公认的答案所说，可以使用`repo.remotes.origin.pull()`，但缺点是它将真正的错误消息隐藏在它自己的通用错误中。例如，当 DNS 解析不起作用时，会`repo.remotes.origin.pull()`显示以下错误消息：

```
git.exc.GitCommandError: 'Error when fetching: fatal: Could not read from remote repository.
' returned with exit code 2 
```

另一方面，在 GitPython中[使用 git 命令](https://gitpython.readthedocs.io/en/stable/tutorial.html#using-git-directly)`repo.git.pull()`显示了真正的错误：

```
git.exc.GitCommandError: 'git pull' returned with exit code 1
stderr: 'ssh: Could not resolve hostname github.com: Name or service not known
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.' 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-09-22T10:27:17.240

[上面](https://stackoverflow.com/a/48681912/11284684)[Akhil Singhal](https://stackoverflow.com/users/9310437/akhil-singhal)的回答中的git.Git 模块仍然有效，但已[重命名](https://gitpython.readthedocs.io/en/stable/changes.html?highlight=Git%20has%20been%20moved%20to%20cmd#git)为[git.cmd.Git](https://gitpython.readthedocs.io/en/stable/reference.html?highlight=Cmd#module-git.cmd)，例如：

```
import git 
# pull from remote origin to the current working dir:
git.cmd.Git().pull('https://github.com/User/repo','master') 
```

# java - 在 Spring Data JPA 中使用 Java 配置和审计

> ID：13166599
> 
> 赞同：3
> 
> 时间：2012-10-31T20:01:59.983
> 
> 标签：java, spring, spring-data, spring-data-jpa

Java 配置是[在 Spring Data 的 1.2.0 版本中引入的](http://blog.springsource.org/2012/10/15/spring-data-release-train-arrived/)，但我不知道 java 配置`<jpa:auditing>`应该是什么样子。我在文档中找不到任何示例，也没有通过查看 Spring Data JPA Source 弄清楚。

我怀疑不可能翻译`<jpa:auditing>`成 java 配置，但由于我找不到可能缺少的功能的 Jira，我不确定。如果我将 Spring Data JPA 与审计一起使用，有谁知道我是否还必须使用 XML 配置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:22:33.290

编辑：此功能从 Spring Data 的 1.5 M1 版本开始可用。有关详细信息，请参阅Alex Blomskøld 创建的[票证。](https://jira.springsource.org/browse/DATAJPA-265)

我们在 1.2.0 中引入的 JavaConfig 方法目前不支持激活审计。无论如何，我们都计划对审计基础设施进行全面检修，您是否介意针对 Spring Data JPA 提出投诉以捕捉故事的这方面？

# jquery - 单击嵌套 div 时，div 返回父 ID。如何在不带父母身份证的情况下退回孩子身份证？

> ID：13166602
> 
> 赞同：0
> 
> 时间：2012-10-31T20:02:05.833
> 
> 标签：jquery

我有类似这样的代码：

```
<div id="content">
    <div id="child1"></div>
    <div id="child2"></div>
</div> 
```

我正在使用 jQuery 点击事件

```
$('#child1').click(function(){
var page = "value1";

    $('#content').hide();
    $('#content').load('includes/'+ page +'.php', function () {
        $('#content').fadeIn(speed);
    });
    return false;
}); 
```

但是，当单击加载的#content ID 中的任何内容时，div 子级将返回父级 ID。如何在忽略父母的情况下选择子 ID？

实际的 HTML 更复杂，因此页面上子项的值不会简单地是#content#child1，有没有办法让 JS 忽略 #content 并看到 #child1？

如果我使用类似的代码

```
$('div').click(function(){
    alert($(this).attr("id"));
    return false;
}); 
```

单击“#child1”或为“#content”时返回的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:18:44.977

我可能读错了，但你已经完全覆盖了`#content`. 加载命令完成后，`#child1`和`#child2`div 不再存在。

即使您加载的数据包含一个`#child1`div，它也不是您最初将 click 事件附加到的 DOM 节点。那个旧节点不见了，取而代之的是你加载的数据，事件处理程序也不见了。

`#child1.click()`如果您想在旧的子节点被删除后继续监听事件，您有两种选择：

*   加载完成后重新绑定事件
*   `#content`在节点上使用事件委托

事件委托允许您绑定一个侦听器`#content`，当事件从子元素冒泡时将触发该侦听器：

```
$('#content').on('click', '#child1', function(evt) {
    // event handler here
    // this points to the element clicked ('#child1')
}); 
```

`#child1`即使您已经用全新的 HTML 替换了节点，这也将有效地保持您的点击处理程序处于活动状态。

# objective-c - NSData 到 NSString 的转换

> ID：13166604
> 
> 赞同：1
> 
> 时间：2012-10-31T20:02:13.637
> 
> 标签：objective-c, nsstring, nsdata

我发现这种方法可以将 NSData 转换为 NSString 对象。

```
NSData *data = //some data
NSString *string = [NSString stringWithFormat:@"%@", data]; 
```

数据将如何被解码？应用了吗`NSUTF8StringEncoding`？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T20:06:17.757

这**不是**推荐的方法。而是使用：

```
NSString *newString = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding]; 
```

这将确保您具有指定的数据编码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T20:05:33.790

在这种情况下，该`stringWithFormat:`方法将向`NSData`对象发送`description`消息，获取结果，并将其用于新创建的字符串的内容。本质上，结果与

```
NSString *string = [data description]; 
```

根据[`NSData`的 文件](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSData_Class/Reference/Reference.html),`description`返回

> 一个 NSString 对象，它以 NSData 属性列表格式包含接收者内容的十六进制表示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:10:30.260

你可能应该使用`NSString *string = [[NSString alloc] initWithData: data encoding:SomeFormOfEncoding];`

[您可以在此处](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)查看方法详细信息。

编码的形式可以在[这里](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/doc/c_ref/NSStringEncoding)看到。

# php - 将字符串作为文件从 javascript 发布到 PHP

> ID：13166609
> 
> 赞同：0
> 
> 时间：2012-10-31T20:02:47.423
> 
> 标签：php, javascript, jquery, ajax, file-upload

我有一个大约 50M 的地图，我需要将它发送到我的服务器以便操作并返回处理结果。问题是我的服务器只有 4MB，所以我试图将这些数据转换为“文件”并上传。

我已经尝试通过执行以下操作将 Content-Type 更改为“form-urlencoded”：

`var obj = {};`

 ````
obj.contentType = 'application/x-www-form-urlencoded';
obj.url = 'testsStamps.php';
obj.data = {'test':large_data};
obj.dataType = 'text';
obj.complete = function(jqXHR,textStatus){
    console.log(jqXHR,textStatus);
};
obj.beforeSend = function(xhr){
    xhr.overrideMimeType("application/x-www-form-urlencoded; charset=UTF-8");
    console.log(xhr);
};
$.ajax(obj).done(function(msg){$('#anchor').text(msg);}); 
````  `但是在服务器端没有定义“$_FILES['test']”。

除此之外，“.htaccess”设置了“php_value post_max_size 100M”和“upload_max_filesize 100M”。另外，“ini_set（'memory_limit'，'250000M'）”。`

# emacs - 在 emacs 中自定义底部工具栏

> ID：13166610
> 
> 赞同：1
> 
> 时间：2012-10-31T20:02:54.890
> 
> 标签：emacs, elisp

如何在 emacs 中自定义底部工具栏？我希望它类似于随心所欲主题中的工具栏。

![随心所欲主题](../Images/8cc972a4ec8968a7b2d5f0788c2ae667.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:41:35.770

此工具栏在 emacs 术语中称为模式行。您可以使用变量自定义模型行，该变量`mode-line-format`是您可以插入模型行变量的列表。[您可以在此处](http://www.hollenback.net/index.php/EmacsModeLine)和[此处](http://www.gnu.org/savannah-checkouts/gnu/emacs/manual/html_node/elisp/Mode-Line-Top.html)找到一些关于要使用哪些模式行变量的非常好的教程和文档。

应该可以使用`mode-line-format`. 您可以随时查看 color-theme-library.el 以了解您的颜色主题是如何定制的。

例如让你的模式行打印一个问候语：

```
(setq-default mode-line-format
  (list " "
        "Hello Mode-Line!"
        " "
        )
) 
```

# jquery - 我如何使用 jquery 在 asp.net treeview 中检查叶节点的开/关

> ID：13166611
> 
> 赞同：2
> 
> 时间：2012-10-31T20:02:53.370
> 
> 标签：jquery, asp.net, treeview

我有一个树视图，其中有几个节点及其根节点下的子节点。我为每个节点启用了复选框。我需要的是当用户检查父节点时，应该检查该节点下的所有子节点（类似于取消选中）。我想使用 JQuery 来实现这一点。

任何帮助是极大的赞赏。

感谢您分享您的时间和智慧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T20:10:36.710

您可以尝试以下操作，取自[asteranup 的](http://forums.asp.net/members/asteranup.aspx) [回答](http://forums.asp.net/post/4381160.aspx)：

```
<form id="form1" runat="server">
    <asp:TreeView ID="LinksTreeView" Font-Name="Arial" ForeColor="Blue" InitialExpandDepth="2"
        ShowCheckBoxes="Parent,Leaf" runat="server">
        <LevelStyles>
            <asp:TreeNodeStyle ChildNodesPadding="10" Font-Bold="true" Font-Size="12pt" ForeColor="DarkGreen" />
            <asp:TreeNodeStyle ChildNodesPadding="5" Font-Bold="true" Font-Size="10pt" />
            <asp:TreeNodeStyle ChildNodesPadding="5" Font-Underline="true" Font-Size="10pt" />
            <asp:TreeNodeStyle ChildNodesPadding="10" Font-Size="8pt" />
        </LevelStyles>
        <Nodes>
            <asp:TreeNode Text="Table of Contents" SelectAction="None">
                <asp:TreeNode Text="Chapter One">
                    <asp:TreeNode Text="Section 1.0">
                        <asp:TreeNode Text="Topic 1.0.1" />
                        <asp:TreeNode Text="Topic 1.0.2" />
                        <asp:TreeNode Text="Topic 1.0.3" />
                    </asp:TreeNode>
                    <asp:TreeNode Text="Section 1.1">
                        <asp:TreeNode Text="Topic 1.1.1" />
                        <asp:TreeNode Text="Topic 1.1.2" />
                        <asp:TreeNode Text="Topic 1.1.3" />
                        <asp:TreeNode Text="Topic 1.1.4" />
                    </asp:TreeNode>
                </asp:TreeNode>
                <asp:TreeNode Text="Chapter Two">
                    <asp:TreeNode Text="Section 2.0">
                        <asp:TreeNode Text="Topic 2.0.1" />
                        <asp:TreeNode Text="Topic 2.0.2" />
                    </asp:TreeNode>
                </asp:TreeNode>
            </asp:TreeNode>
            <asp:TreeNode Text="Appendix A" />
            <asp:TreeNode Text="Appendix B" />
            <asp:TreeNode Text="Appendix C" />
        </Nodes>
    </asp:TreeView>
  </form> 
```

**Javascript**：

```
$(document).ready(function() {
    ("div[id $= LinksTreeView] input[type=checkbox]").click(function() {           
        $(this).closest("table").next("div").find("input[type=checkbox]").attr("checked", this.checked);
    });
}); 
```

# perl - Perl mechanize Find all links 数组循环问题

> ID：13166614
> 
> 赞同：1
> 
> 时间：2012-10-31T20:03:11.357
> 
> 标签：perl, web-crawler, www-mechanize

我目前正在尝试**使用 WWW::Mechanize 创建一个 Perl webspider。**

我要做的是**创建一个网络蜘蛛，它将抓取整个网站**的 URL（由用户输入）并从网站上的每个页面中提取所有链接。

**但是我有一个问题，如何爬取整个站点以获取每个链接，而没有重复** 到目前为止我所做的事情（无论如何我都遇到了麻烦）：

```
foreach (@nonduplicates) {   #array contain urls like www.tree.com/contact-us, www.tree.com/varieties....
$mech->get($_);
my @list = $mech->find_all_links(url_abs_regex => qr/^\Q$urlToSpider\E/);  #find all links on this page that starts with http://www.tree.com

#NOW THIS IS WHAT I WANT IT TO DO AFTER THE ABOVE (IN PSEUDOCODE), BUT CANT GET WORKING
#foreach (@list) {
#if $_ is already in @nonduplicates
#then do nothing because that link has already been found
#} else {
#append the link to the end of @nonduplicates so that if it has not been crawled for links already, it will be 
```

**我怎么能做到以上？**

**我这样做是为了尝试爬取整个站点以获取站点上每个 URL 的完整列表，而不会重复。**

如果您认为这不是实现相同结果的最佳/最简单方法，我愿意接受想法。

**非常感谢您的帮助，谢谢。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:21:04.327

创建一个散列来跟踪您以前看过哪些链接，并将任何未见过的链接放入其中`@nonduplicates`进行处理：

```
$| = 1;
my $scanned = 0;

my @nonduplicates = ( $urlToSpider ); # Add the first link to the queue.
my %link_tracker = map { $_ => 1 } @nonduplicates; # Keep track of what links we've found already.

while (my $queued_link = pop @nonduplicates) {
    $mech->get($queued_link);
    my @list = $mech->find_all_links(url_abs_regex => qr/^\Q$urlToSpider\E/);

    for my $new_link (@list) {
        # Add the link to the queue unless we already encountered it.
        # Increment so we don't add it again.
        push @nonduplicates, $new_link->url_abs() unless $link_tracker{$new_link->url_abs()}++;
    }
    printf "\rPages scanned: [%d] Unique Links: [%s] Queued: [%s]", ++$scanned, scalar keys %link_tracker, scalar @nonduplicates;
}
use Data::Dumper;
print Dumper(\%link_tracker); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:11:52.470

```
use List::MoreUtils qw/uniq/;
...

my @list = $mech->find_all_links(...);

my @unique_urls = uniq( map { $_->url } @list ); 
```

现在`@unique_urls`包含来自`@list`.

# vb.net - VB.net - MenuStrip 的派生类

> ID：13166617
> 
> 赞同：1
> 
> 时间：2012-10-31T20:03:24.977
> 
> 标签：vb.net, derived-class

我想要做的是制作一个自定义的 MenuStrip 控件，其中已经附加了几个项目（主菜单、注销、退出等）。会有一些方法来处理被点击的项目。我认为从长远来看，这会为我节省一些冗余代码，我也可能会学到一些东西。

最终产品基本上是一个自定义的 MenuStrip 控件，我可以将它放在我的表单上，并且已经具有其中项目的功能。

所以我的问题是，这可以做到吗？我是新手，但如果可以做到并且实际上是一个好主意，那么我想试一试。

错误比比皆是，但这就是我的想法......

```
Public Class MenuStripCustom
    Inherits MenuStrip

    Add MenuItem(MainMenuToolStripMenuItem)
    MainMenuToolStripMenuItem.Text = Main Menu

        Protected Sub MainMenuNav(e As System.EventArgs) _
            Handles MyBase.MainMenuToolStripMenuItem.Click
        MainMenu.Visible = True
        Me.Close()
    End Sub

End Class 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T09:31:06.373

是的，可以做到没有问题。只需创建一个新的用户控件，并使其继承自 MenuStrip。然后为名为“UserControl1”的用户控件输入类似于下面的代码。

```
Public Class UserControl1
    Inherits MenuStrip

    Private WithEvents NavToolStrip As New ToolStripMenuItem("Nav")

    Sub New()

        ' This call is required by the designer.
        InitializeComponent()

        ' Add any initialization after the InitializeComponent() call.
        Dim tsi As New ToolStripMenuItem
        Me.Items.Add(NavToolStrip)
    End Sub

    Private Sub NavToolStrip_Click(sender As Object, e As EventArgs) Handles NavToolStrip.Click
        MsgBox("Nav clicked")
    End Sub
End Class 
```

编译代码，然后您将能够将“UserControl1”从您的工具箱拖到您的表单上。

# yii - 限制电子邮件域 - vaidation yii

> ID：13166618
> 
> 赞同：0
> 
> 时间：2012-10-31T20:03:25.037
> 
> 标签：yii

我有表格`email`字段，`signup`

我想用数据库验证电子邮件域，例如

```
Email adress is : example@work.com  or etc@etc.com 
```

现在我想验证`work.com`or`etc.com`是否在 db 中列出，如果没有，那么它不应该是 vaidat.!

谁能帮我这个 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T20:23:27.660

代码：

```
public function validate($attributes = null, $clearErrors = true) {
    parent::validate($attributes, $clearErrors);
    if (!$this->hasErrors('email')) {
        $a = explode('@', $this->email);
        if (isset($a[1])) {
            $record = AllowedDomains::model()->findByAttributes(array('domain'=>$a[1]));
            if ($record === null) {
                $this->addError('email', "This domain isn't allowed");
            }
        }
    }
    return !$this->hasErrors();
} 
```

笔记：

*   将此代码放入模型中
*   email - 保存电子邮件地址的字段
*   AllowedDomains - 包含允许域的表的 CActiveRecord
*   域 - 替换为正确的数据库字段
*   不要忘记在 rules() 函数中添加电子邮件验证器。这将过滤掉无效的电子邮件地址，如果出现问题，上述代码将不会运行

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:13:33.700

您可以通过在模型的规则部分添加自定义 yii 验证器来完成此操作。这是一些示例代码：

```
public $email; // This is the field where the email is stored

/**
 * @return array validation rules for model attributes.
 */
public function rules()
{
    return array(
       array('email', 'checkDomain'),
    );
} 
```

之后，您可以添加自定义验证功能

```
public function checkDomain($attribute,$params)
{
    $sEmailDomain = substr(strrchr($this->email, "@"), 1);

    // Check if the domain exists
    ...
    // If the domain exists, add the error
    $this->addError('email', 'Domain already exists in the database');
} 
```

更多信息可以在这里找到：[http ://www.yiiframework.com/wiki/168/create-your-own-validation-rule/](http://www.yiiframework.com/wiki/168/create-your-own-validation-rule/)

# linux - 为什么这些参数解析错误？

> ID：13166619
> 
> 赞同：0
> 
> 时间：2012-10-31T20:03:32.910
> 
> 标签：linux, bash, ubuntu, centos

我想编写一个脚本，它需要`-c`并且`-f`每个都需要一个选项。

当我在下面运行我的脚本时，我得到了一些意想不到的错误：

```
$ ./user.sh -c
./user.sh: option requires an argument -- c

Usage: user.sh -c username -f filename
   -c username
   -f SSH public key

$ ./user.sh -c gg
Error: You have not given a filename. 
```

在第一种情况下，我会喜欢它说我错过了选项，`-c`而在第二种情况下，我会喜欢它说我错过了`-f`。

**问题**

我该如何处理这样的错误，我做错了什么？

**用户.sh**

```
#!/bin/bash                                                                                             

usage () {
    echo "Usage: user.sh -c username -f filename"
    echo "   -c username"
    echo "   -f SSH public key"
    echo ""
}

if ! [ "$*"  ]; then
    usage
    exit 1
fi

while getopts "c:f:" opt; do
    case $opt in
        c) user=$OPTARG;;
        f) filename=$OPTARG;;
        \?)
            echo
            usage
            exit 1;;
        *) echo "Internal error: Unknown option.";;
    esac
done

if ! [ $filename ]; then
    echo "Error: You have not given a filename."
    exit 1
fi

if ! [ $user ]; then
    echo "Error: You have not given an username."
    exit 1
fi 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T20:06:07.850

`c:`上面写着“选项`-c`后面必须跟用户名”。

错误消息显示“`-c`选项后面没有用户名”。

当然，它没有提到“用户名”，但那是因为它不知道选项后面是什么`-c`。

`getopts`内置无法处理强制选项；您必须通过检查是否确实通过了强制选项来为自己编写代码。如果同一个选项被指定了两次也不用担心；如果重要，您的代码必须处理它。（很容易让最后一个指定的值生效。）

现代风格是避免在强制参数之前使用选项字母。我并不完全赞成改变；这意味着参数的顺序变得至关重要，而使用选项字母来指示后面的内容并不重要。没有选项字母，你会写：`./user.sh username filename`，但有选项字母，你可以写其中任何一个并期望它工作：

```
./user.sh -c username -f filename
./user.sh -f filename -c username 
```

请注意，您也有责任担心额外的争论。您通常会使用：

```
shift $(($OPTIND - 1)) 
```

删除已处理的参数，然后您可以执行以下操作：

```
case "$#" in
(0) : No extra arguments - OK;;
(*) echo "$0: Too many arguments" >&2; exit 1;;
esac 
```

以及该主题的变体。请注意，错误报告被发送到标准错误，而不是标准输出——`>&2`重定向将标准输出（文件描述符 1）发送到标准错误（文件描述符 2）。

为避免歧义，我会对您的使用函数进行一些不同的编码：

```
usage()
{
    {
    echo "Usage: user.sh -c username -f filename"
    echo "   -c username    Name of user to connect as"
    echo "   -f filename    SSH public key file"
    echo ""
    } >&2
} 
```

内部大括号执行 I/O 重定向，而不启动子外壳。当您需要将多个回显命令发送到同一个地方时，这可能很有用。我还提供了一些不同的详细信息，这样用户就不会误以为“SSH 公钥”是遵循`-f`. 如果有任何纯选项标志，它们后面会跟着空格：

```
 echo "   -V             Print version information and exit" 
```

# android - 使用 Progressbar showDialog 下载文件 - 错误

> ID：13166622
> 
> 赞同：1
> 
> 时间：2012-10-31T20:03:50.370
> 
> 标签：android, download, android-progressbar, showdialog

我不断收到此错误消息，告诉我禁止显示进度条的 showdialog 代码。

现在我能做些什么来解决这个问题，我也不想使用任何其他方式。我正在尝试学习 showdialog 以供下载

这是我的代码

```
public class download extends Activity {

public static final int DIALOG_DOWNLOAD_PROGRESS = 0;
private Button startBtn;
private ProgressDialog mProgressDialog;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    startBtn = (Button)findViewById(R.id.startBtn);
    startBtn.setOnClickListener(new OnClickListener(){
        public void onClick(View v) {
            startDownload();
        }
    });
}

private void startDownload() {
    String url = "http://practicalbuddhist.com/wp-content/uploads/2012/03/Synapses-Image-for-March-17-2010-Blog-Entry.jpg";
    new DownloadFileAsync().execute(url);
}
@Override
protected Dialog onCreateDialog(int id) {
    switch (id) {
    case DIALOG_DOWNLOAD_PROGRESS:
        mProgressDialog = new ProgressDialog(this);
        mProgressDialog.setMessage("Running Download Test...");
        mProgressDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        mProgressDialog.setCancelable(false);
        mProgressDialog.show();
        return mProgressDialog;
    default:
        return null;
    }
}

class DownloadFileAsync extends AsyncTask<String, String, String> {

@SuppressWarnings("deprecation")
@Override
protected void onPreExecute() {
    super.onPreExecute();
    showDialog(DIALOG_DOWNLOAD_PROGRESS);

}

@Override
protected String doInBackground(String... aurl) {
    int count;

try {

URL url = new URL(aurl[0]);
URLConnection conexion = url.openConnection();
conexion.connect();

int lenghtOfFile = conexion.getContentLength();
Log.d("ANDRO_ASYNC", "Lenght of file: " + lenghtOfFile);

InputStream input = new BufferedInputStream(url.openStream());
OutputStream output = new FileOutputStream("/sdcard/Downloadtest.jpg");

byte data[] = new byte[1024];

long total = 0;

    while ((count = input.read(data)) != -1) {
        total += count;
        publishProgress(""+(int)((total*100)/lenghtOfFile));
        output.write(data, 0, count);
    }

    output.flush();
    output.close();
    input.close();
} catch (Exception e) {}
return null;

}
protected void onProgressUpdate(String... progress) {
     Log.d("ANDRO_ASYNC",progress[0]);
     mProgressDialog.setProgress(Integer.parseInt(progress[0]));
}

@SuppressWarnings("deprecation")
@Override
protected void onPostExecute(String unused) {
    dismissDialog(DIALOG_DOWNLOAD_PROGRESS);
} 
```

} }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:07:01.773

直接使用 Dialog 类方法而不是 Activity 辅助方法。

在[http://developer.android.com/guide/topics/ui/dialogs.html](http://developer.android.com/guide/topics/ui/dialogs.html)的对话框 API 指南中，他们明确表示不要使用 ProgressDialog，而是使用带有 ProgressBar 的自定义布局。

另一方面，您可以只使用 DownloadManager 异步下载文件。检查[https://github.com/commonsguy/cw-android/blob/master/Internet/Download/src/com/commonsware/android/download/DownloadDemo.java](https://github.com/commonsguy/cw-android/blob/master/Internet/Download/src/com/commonsware/android/download/DownloadDemo.java)以获得一个简单的例子，即使有通知。

如果您仍然想要此方法，请查看[http://www.androidhive.info/2012/04/android-downloading-file-by-showing-progress-bar/](http://www.androidhive.info/2012/04/android-downloading-file-by-showing-progress-bar/)以获取使用 ProgressDialog- 的简单示例

# visual-studio-2010 - 使用 Visual Studio XML IntelliSense 进行 URL 重写 2.0 时出错：无法打开文件 XML\Schema\DotNetConfig.xsd

> ID：13166627
> 
> 赞同：0
> 
> 时间：2012-10-31T20:04:05.277
> 
> 标签：visual-studio-2010, url-rewriting

我已经下载了用于 URL Rewrite 2.0 的 Visual Studio XML IntelliSense 并尝试通过命令提示符安装它，但它不起作用……它显示

> 无法打开文件 XML\Schema\DotNetConfig.xsd 确保脚本在提升的命令提示符下运行

这是我到目前为止所做的......

1.  改为`%VS90COMNTOOLS%`_`%VS100COMNTOOLS%`
2.  以管理员`cscript UpdateSchemaCache.js`身份运行

但没有任何工作。我有VS2010版本。

我已按照此链接上的说明进行操作，但不确定我在这里做错了什么： [http ://ruslany.net/2010/04/visual-studio-xml-intellisense-for-url-rewrite-2-0/](http://ruslany.net/2010/04/visual-studio-xml-intellisense-for-url-rewrite-2-0/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-29T06:42:19.353

打开 UpdateSchemaCache.js 进行编辑并将其更改为`%VS90COMNTOOLS%`

```
 var vs9CommonTools = shell.ExpandEnvironmentStrings( "%VS90COMNTOOLS%"); 
```

如果你使用 V2010 ->`%VS100COMNTOOLS%`

如果你使用 V2012 ->`%VS110COMNTOOLS%`

然后转到错误索引

```
if ( targetXml.load( dotNetSchemaFile ) == 0 )
{
    WScript.Echo("Failed to open file " + dotNetSchemaFile + ". Make sure that the script is run in the elevated command prompt.");
    WScript.Quit(1);
} 
```

您 `dotNetSchemaFile`丢失了，只有您收到此错误。代码检查无效位置的文件，因此您将更改路径

***旧路径***

> var dotNetSchemaDir = vs9CommonTools.substring( 0, vs9CommonTools.indexOf( "Common7\Tools" ) ) + "Xml\Schemas\";

**新路径**

> var dotNetSchemaDir = "C:\Program Files\Microsoft Visual Studio 11.0\Xml\Schemas\1033\";

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-30T16:44:13.993

打开 UpdateSchemaCache.js 进行编辑并将其更改`%VS90COMNTOOLS%`为此`%VS100COMNTOOLS%`

# windows - Windows 应用商店应用着色器模型 4_0_level_9_3 和 VPOS

> ID：13166631
> 
> 赞同：7
> 
> 时间：2012-10-31T20:04:23.973
> 
> 标签：windows, windows-phone-8, windows-8, hlsl

为了为 Windows 应用商店应用程序（和 Windows Phone 8）构建着色器模型 4_0_level_9_3，您需要使用 vs_4_0_level_9_3 和 ps_4_0_level_9_3。虽然使用为 DirectX 10 及更高版本设计的 HLSL 语法听起来不错，但我无法使用 DirectX 9 的 VPOS 语义或在像素着色器中使用 DirectX 10 及更高版本的 SV_POSITION，所以除了制作另一个用于在剪辑空间中输出顶点位置的语义？

PS：4_0_level_9_3 上的一些着色器吐出“内部错误：level9 和 d3d10 着色器之间的 blob 内容不匹配”，我不知道这是怎么回事。可能与我认为的驱动程序有些不一致（我使用的是 Nvidia GTX 560 TI），如果您只使用发布标志编译着色器（如优化级别 3 并避免流量控制），我认为它会消失。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-30T23:21:53.787

正如您所说，您最好的选择是将这些值作为辅助语义传递（即同时传递“POSITION”和“SV_POSITION”值）。请注意，如果将 SV_POSITION 放在顶点着色器的输出声明的末尾，则可以在像素着色器的输入声明中省略它。

关于内部错误，这通常是由于声明了纹理或其他着色器输入，这些输入在一个通道中优化，但在另一个通道中没有。禁用优化通常可以解决该问题，但您也应该能够通过消除未使用的（包括通过消除死代码）输入声明来修复它，并确保避免减少到无操作的复杂代码。

# highcharts - HighStock：根据需要异步加载系列数据

> ID：13166632
> 
> 赞同：6
> 
> 时间：2012-10-31T20:04:30.813
> 
> 标签：highcharts, highstock

我想在 HighChart 中显示多年的历史股票数据。多年来的 json 数据大小是 5mb，为什么我想避免一次加载。特别是因为大多数用户只需要最后 6 个月。

我想最初获取前 6 个月。如果用户及时缩小或“向后移动”，我想加载整个数据。有人有这个食谱吗？起点是什么？是否有任何我可以收听的 HighChart 事件，以便在用户缩小或移动时得到通知？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T20:50:07.327

您正在寻找**[`xAxis.events.setExtremes`](http://api.highcharts.com/highstock#xAxis.events.setExtremes)**事件。

您需要将它与[`Series.addPoint(Object options, [Boolean redraw], [Boolean shift], [Mixed animation])`](http://api.highcharts.com/highstock#Series.addPoint%28%29)循环内部结合，其中 redraw 选项为 false，并[`Chart.redraw()`](http://api.highcharts.com/highstock#Chart.redraw%28%29)在循环所有新添加的点后显式调用。

您可能还需要查看@ **[`navigator.series`](http://api.highcharts.com/highstock#navigator.series)**，因为您的导航器系列可能需要与实际系列不同

# uitableview - 自定义 UITableView 单元格到详细视图

> ID：13166636
> 
> 赞同：0
> 
> 时间：2012-10-31T20:05:00.647
> 
> 标签：uitableview, cells, sections

[我想做什么的图片](http://i.imgur.com/9InFZ.png)

这是我想做的事情，但是在自定义的 uitableviewcell（图像、标题/副标题 [如果需要，可以通过标签完成]）和多个部分中。上图是我通过情节提要完成的（静态单元格）

*   它将有至少 100 多个自定义单元格（有冠军图像、名称和标题）
*   然后它会导致一个详细视图，其中包含关于所说的信息（图像、知识、技能等......）
*   有多个部分（AZ 并且其中有不同数量的自定义单元格）

希望有人能帮我解决这个问题，因为我想完成这件事，而这让我困扰了几天。如果有人可以引导我学习教程或制作一个教程，那就太棒了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T17:25:35.923

您必须将其恢复为基础，但是图像中的 tableviewcell 可以通过标准的 uitableviewcell 来实现。首先将 UItabelviewCell 样式更改为图片设置的字幕

```
cell.imageView.image = [UIImage imageNamed:@"imageName"]; 
```

正文是：

```
cell.textLabel.text = @"maintext"; 
```

详细文字是：

```
cell.detailTextLabel.text = @"detailText"; 
```

但是要回答您的 detailView 部分，您需要实现 UINavigationController。互联网上有很多教程可以开始这个，但本质上，您将 UINavigationController 与 tableViewController 作为 ROOT 控制器。当您点击单元格时，它将推送下一个视图。导航也会自动有一个后退按钮。

[这是一个uinavigationcontroller教程的例子](http://www.iosdevnotes.com/2011/03/uinavigationcontroller-tutorial/)

# jvectormap - 将图例添加到 jVectorMap

> ID：13166638
> 
> 赞同：3
> 
> 时间：2012-10-31T20:05:02.780
> 
> 标签：jvectormap

我正在更新我们的应用程序以使用 jVectorMap 而不是 Flash。有些地图需要不同国家/地区的颜色。这很容易创建。

```
<div id="world-map-color" style="width: 900px; height: 600px;"></div>
<script>
    var myData = {
                  "AF": 36.63,
                  "RU": 11.58,
                  "US": 158.97
                 };

    $('#world-map-color').vectorMap({
        backgroundColor: "#FFFFFF",
        regionStyle: {
            initial: { fill: "#7C96A1" },
            hover: { fill: "#A0D1DC" }
        },
        series: {
            regions: [{
                values: myData,
                scale: ['#B0ADF7', '#0D0885'],
                normalizeFunction: 'polynomial'
            }]
        }
    });
</script> 
```

生成的地图：

![彩色地图](../Images/37b2b11ffddc953426aedd7394211e46.png)

但是，我想添加某种图例/键来说明颜色的比例。类似于以下内容：

![示例传奇](../Images/c7024f01689fb40f1a49fa742419a037.png)

此外，该示例图例（来自 Flash）允许用户使用顶部的箭头更改颜色的缩放比例。因此，如果这也是可能的，那就太好了。

有谁知道这些中的任何部分是否可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T23:04:41.687

要实现的最基本的事情就是生成五颜六色的刻度。为此，请参阅我最近回答的类似[问题。](https://stackoverflow.com/questions/13147104/create-a-scale-key-for-jvectormap-region-colors/13168628#13168628)

# c++ - 从静态库函数访问文本数据文件

> ID：13166645
> 
> 赞同：1
> 
> 时间：2012-10-31T20:05:44.620
> 
> 标签：c++, c, fortran, fortran77, fortran95

如何启用静态库以提取 ascii 数据文件中可用的数据？

我正在尝试将模型作为库添加到模拟中，其中包含从数据文件中读取数据的函数。我能够从实际完整模拟之外的主程序编译和运行函数，但是一旦我将函数作为库放在主机上进行模拟，数据就不再被读取。

由于数据路径因用户而异，因此我无法提供 ascii 数据文件的绝对数据路径。有没有办法使用 objcopy 将数据文件制作成库中的目标代码，或者如何最好地访问静态库中的数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T22:24:42.707

有几种解决方案可以在编译时打开位置未知的文件。提示用户输入文件名，包括目录。使用环境变量来指定包含文件的目录... Fortran 2003 有一个内在的获取环境变量的值。从命令行参数中获取信息...... Fortran 2003 有一个用于此目的的内在函数。使用所有这些，将文件名构造为字符串变量，并将该变量提供给 OPEN 语句的 FILE 关键字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:09:21.573

我不知道您为什么将 Fortran 标签遮蔽，但在 Fortran 中您：

告诉代码使用字符串打开您想要的文件

从中读取

并关闭它

主程序或库之间没有区别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:42:57.393

如果您有类似的功能，请说：

```
void read_data_from_files() { ... } 
```

您需要在 DLL 中将其更改为更像：

```
DataObject read_data_from_file(const char* file_path) { ... } 
```

然后适当地调用它。

你需要设计`DataObject`.

# sql - 连接 3 个表时遇到问题

> ID：13166647
> 
> 赞同：2
> 
> 时间：2012-10-31T20:05:47.963
> 
> 标签：sql, sql-server

我是编写 SQL 查询的新手，一直在尝试从 3 个不同的表中提取信息并将其链接在一起。

数据驻留在 Microsoft SQL Server 中。

这是我当前的查询（这不是我想要的方式）：

```
SELECT h.jhhold, h.jhjob, h.jhpart, h.jhrev, h.jhcust, h.jhextd, o.jadesc, h.jhpqty, o.jaoqty, o.jacqty, o.japo, o.javend 
FROM Jhead AS h
LEFT JOIN jjops AS o ON h.jhjob = o.jajob 
LEFT JOIN hpodt AS p ON h.jhjob = p.hdjob 
WHERE h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty < o.jaoqty AND japcmp = 0 
ORDER BY h.jhjob 
```

解释我想要做什么。我有一个作业标题表**Jhead**、一个作业详细信息表**jjops**和一个采购订单详细信息表**hpodt**。我相信工作编号是 jhead 表中的主键。

这是我的问题：一旦我添加了第二个左连接，我就会得到很多额外的重复信息行。

我尝试使用 GROUP BY jhead.jhjob 但收到以下错误：

“列 'jhead.jhhold' 在选择列表中无效，因为它既不包含在聚合函数中，也不包含在 GROUP BY 子句中。”</p>

所以我研究了错误，其中一种解决方案是让我的 GROUP BY 看起来像这样： GROUP BY jhead.jhjob、jhead.jhhold、jhead.jhpart、jhead.jhrev、jhead.jhcust、jhead.jhextd

但是当我输入 jhead.jhextd 时，我得到了这个错误：“text、ntext 和 image 数据类型无法比较或排序，除非使用 IS NULL 或 LIKE 运算符。”</p>

现在已经撞到了一堵砖墙。我确实看到您可以将类型更改为 NVARCHAR。我真的不想按描述字段进行排序，因为它是独一无二的，并且可能对服务器造成很大负担。有一个更好的方法吗？

**使用示例数据进行编辑：** 我删除了额外的字段以简化查询并过滤了 1 个工作编号的结果。

只有 1 个左连接： ![只有 1 个左连接](../Images/b96ca3c5b0536ce6f5780295f8f88037.png)

使用两个左连接： ![第二](../Images/f1c24ac045b04ed4f157ba100466575e.png)

如您所见，ERP 软件在 1 个 PO# 下有多个工作，我只对显示具有匹配工作编号的行感兴趣。 ![第三](../Images/8ec6ffb602bb43e2bd471b9be752882a.png)

**查询已更新**

```
SELECT h.jhhold, h.jhjob, h.jhrev, o.jadesc, h.jhpqty, o.jaoqty, o.jacqty, o.japo, o.javend, p.hdprcd, p.hdrecd
FROM Jhead AS h
LEFT JOIN jjops AS o ON h.jhjob = o.jajob 
LEFT JOIN hpodt AS p ON h.jhjob = p.hdjob 
WHERE h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty < o.jaoqty AND japcmp = 0 AND p.hdjob = h.jhjob AND p.hdpo = o.japo
ORDER BY h.jhjob 
```

这越来越接近我想要的了。现在的问题是，当每行实际上应该不同时，我的 jacksc 字段正在复制第一个结果。

![4](../Images/47c9c8c5a772554242243464ead8a353.png)

我过滤后只显示一份工作。它们应该只有一列。

**获得额外的行，但拥有我需要的所有数据**

```
SELECT h.jhhold, h.jhjob, h.jhrev, o.jadesc, h.jhpqty, o.jaoqty, o.jacqty, o.japo, o.javend, p.hdprcd, p.hdrecd, p.hdseq 
FROM Jhead AS h 
LEFT JOIN jjops AS o ON h.jhjob = o.jajob 
LEFT JOIN hpodt AS p ON h.jhjob = p.hdjob 
WHERE (h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty < o.jaoqty AND japcmp = 0 AND p.hdjob = h.jhjob AND p.hdpo = o.japo AND p.hdseq = o.jaseq AND o.jaopr != 'PT') 
  OR (h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty < o.jaoqty AND japcmp = 0 AND o.japo = 0 AND o.jaopr != 'PT')
ORDER BY h.jhjob, o.jaseq 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:55:27.920

I *guess* you want to show detailed information about the `jhead` and `jjops` tables, but just want to show some aggregate information found on the `hpodt` table.

If that's the case, you should do something like this:

```
SELECT
    h.jhhold, h.jhjob, h.jhpart, h.jhrev, h.jhcust, h.jhextd,
    o.jadesc, h.jhpqty, o.jaoqty, o.jacqty, o.japo, o.javend,
    (SELECT COUNT(*) FROM hpodt p WHERE p.jhjob = h.hdjob) AS po_line_count,
    CASE WHEN EXISTS (SELECT * FROM hpodt p WHERE p.jhjob = h.hdjob)
        THEN 'found it'
        ELSE 'not found'
    END AS info_on_hpodt
FROM
    Jhead AS h
    LEFT JOIN jjops AS o ON h.jhjob = o.jajob 
WHERE
    h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty < o.jaoqty AND japcmp = 0 
ORDER BY
    h.jhjob 
```

It isn't clear to me which specific information you want from the `hpodt` table, but I guess this strategy of using a sub-query will work by just adding other criteria to its `WHERE` clause.

Another option would be using [window functions](http://msdn.microsoft.com/en-us/library/ms189461.aspx), but the sub-query approach is simpler.

# html - 如何使列的宽度（包含带空格的文本）适合其在 HTML 表中的内容？

> ID：13166650
> 
> 赞同：2
> 
> 时间：2012-10-31T20:05:58.960
> 
> 标签：html, css, html-table

我最近试图弄清楚如何使单元格/列适合其内容的宽度。我在 stackoverflow 上发现了一个问题，该问题似乎完全符合我的要求：[如何使列的宽度适合其在 HTML 表中的内容？](https://stackoverflow.com/questions/8305140/how-to-make-width-of-a-column-fit-to-its-contents-in-html-table)

我的问题是当我在单元格的内容中添加一个空格时，它添加了一个返回并将下一个单词撞到一行。

所以这段代码：

```
<div style="max-width:700px;">
<table border="1">

    <tr><td width="1px">Papua New Guinea:</td><td >Goroka</td></tr>
    <tr><td colSpan="2">this is a loooooooooooooooong text</td></tr>
</table> 
```

生成此表：

[http://cl‍.ly/image/2F0V1J3V2u22](http://cl‍.ly/image/2F0V1J3V2u22)

相反，这就是我想要的：

[http://cl‍.ly/image/2m0a0m0t0L0v](http://cl‍.ly/image/2m0a0m0t0L0v)

我意识到放入`&nbsp;`而不是空格可以解决这个问题。我的问题是，这是在邮件通讯模板中使用的，并且该单元格中的文本是动态的。有时有空格，有时没有。例如昨天它说玻利维亚，今天是巴布亚新几内亚，这是我注意到问题的时候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:08:20.640

你试过了吗

```
td {
    white-space: nowrap;
} 
```

[http://jsfiddle.net/QkNqk/](http://jsfiddle.net/QkNqk/)

你也可以使用

```
td {
    white-space: pre;
} 
```

让源代码中的换行符创建中断。所以只要你没有换行符，文本就会停留在一行

# c# - 无法确定类型：NHibernate.Mapping.Column(PATRF_ID)

> ID：13166651
> 
> 赞同：1
> 
> 时间：2012-10-31T20:06:02.317
> 
> 标签：c#, visual-studio-2010, nhibernate, oracle10g

它给了我NHibernate的上述错误。我正在使用 VS 2010、C#、Oracle 10g。我尝试搜索谷歌，stackoverflow，但没有运气。以下文件给了我错误。

例外`Could not determine type for: .....PatRegisterReferral, ...., Version=1.0.0.0, Culture=neutral, PublicKeyToken=null, for columns: NHibernate.Mapping.Column(PATRF_ID)`

NHibernate 映射为`PatRegisterReferral`

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="...." assembly="...">
  <class name=".......PatRegisterReferral, ....." table="......">
    <id name="Id" column="PATRF_ID" unsaved-value="0">
      <generator class="sequence" >
       <param name="sequence">PATRF_SEQ</param>
      </generator>
    </id>    
   <timestamp name="ModifyDate" column="MODIFY_DATE" generated="always" />
   <property name="CreateDate" column="CREATE_DATE" update="false" />
   <property name="CreateBy" column="CREATE_BY" update="false" />
   <property name="ModifyBy" column="MODIFY_BY" update="false" />
   <property name="EffDate" column="EFF_DATE" />
   <property name="ExpDate" column="EXP_DATE" />
   <many-to-one name="PatReferralStatus" class="PatReferralStatus">
    <column name="PATRS_CODE"></column>
   </many-to-one>      
 </class>
</hibernate-mapping> 
```

`PatRegisterReferral`班级：

```
 public class PatRegisterReferral
 {

    private PatReferralStatus _patReferralStatus = null;

    public override int GetHashCode()
    {
        System.Text.StringBuilder sb = new System.Text.StringBuilder();
        sb.Append(this.GetType().FullName);
        sb.Append(EffDate);
        sb.Append(ExpDate);            
        if (PatReferralStatus.Id != null) sb.Append(PatReferralStatus.Id);            
        return sb.ToString().GetHashCode();
    }

    public virtual DateTime EffDate { get; set; }
    public virtual DateTime? ExpDate { get; set; }
    public virtual string CreateBy { get; set; }
    public virtual DateTime CreateDate { get; set; }
    public virtual string ModifyBy { get; set; }
    public virtual DateTime ModifyDate { get; set; }

    public virtual PatReferralStatus PatReferralStatus
    {
        get { return _patReferralStatus; }
        set { _patReferralStatus = value; }
    }
} 
```

NHibernate 映射为`PatReferralStatus`

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="...." assembly="....">
 <class name="...., ...." table="...." mutable="false" batch-size="10" lazy="false">
  <id name="Id" column="PATRS_CODE" unsaved-value="0">
   <generator class="assigned"></generator>
  </id>
  <timestamp name="ModifyDate" column="MODIFY_DATE" generated="always" />
  <property name="Descrip" column="DESCRIP" />
  <property name="DescripFr" column="DESCRIP_FR" />
  <property name="EffDate" column="EFF_DATE" />
  <property name="ExpDate" column="EXP_DATE" />
  <property name="CreateBy" column="CREATE_BY" />
  <property name="CreateDate" column="CREATE_DATE" />
  <property name="ModifyBy" column="MODIFY_BY" />
  <bag name ="PatRegisterReferrals" lazy="true" cascade="all-delete-orphan" inverse="true">
   <key column="PATRS_CODE"></key>
   <one-to-many class="PatRegisterReferral"></one-to-many>      
  </bag>    
 </class>
</hibernate-mapping> 
```

类定义`PatReferralStatus`

```
public class PatReferralStatus
{
    private IList<PatRegisterReferral> _patRegisterReferrals = null;

    public override int GetHashCode()
    {
        System.Text.StringBuilder sb = new System.Text.StringBuilder();
        sb.Append(this.GetType().FullName);
        sb.Append(Descrip);
        sb.Append(DescripFr);
        sb.Append(EffDate);
        sb.Append(ExpDate);
        return sb.ToString().GetHashCode();
    }

    public virtual string Descrip { get; set; }
    public virtual string DescripFr { get; set; }
    public virtual DateTime EffDate { get; set; }
    public virtual DateTime? ExpDate { get; set; }
    public virtual string CreateBy { get; set; }
    public virtual DateTime CreateDate { get; set; }
    public virtual string ModifyBy { get; set; }
    public virtual DateTime ModifyDate { get; set; }

    public virtual IList<PatRegisterReferral> PatRegisterReferrals
    {
        get { return _patRegisterReferrals; }
        set { _patRegisterReferrals = value; }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T17:06:52.763

经过两天的努力，我找到了解决方案。ID 是在基类中定义的。基类使用泛型。`<T>`我在派生类中定义了错误的类型。很抱歉人们耽误了你的时间。傻我..

# design-patterns - 如何抽象出这段代码，这样我就不会破坏 DRY 原则

> ID：13166652
> 
> 赞同：3
> 
> 时间：2012-10-31T20:06:02.440
> 
> 标签：design-patterns, architecture, abstract

我有两种方法可以从 CSV 中提取数据

```
private Car processCar (String [] row) {
    Car c = new Car();
    c.setCarId(Integer.parseInt(row[CSVColumns.carid.index]));
    ....
    return c;
}

private Driver processDriver(String[] row) {
    Driver d = new Driver(row[CSVColumns.name.index]);
    sys.setAge(row[CSVColumns.age.index]);
    ...
    return d;
} 
```

现在，在从数据库中提取数据时，我需要再次使用这两种方法，但是只需稍作改动

```
private Car processCar (ResultSet rs) {
    Car c = new Car();
    c.setCarId(rs.getInt("Id"));
    ....
    return c;
}

private Driver processDriver(ResultSet) {
    Driver d = new Driver(rs.getString("Name));
    sys.setAge(rs.getString("Age"));
    .....
    return d;
} 
```

有没有办法简化这一点，这样我就不必重复自己了？此外，每种方法都包含很多 getter/setter，所以我不想复制粘贴的东西并进行更改......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:19:48.400

一种选择是编写一个方法，该方法接受一个结果集并转换为返回一个字符串数组。根据您的数据库库，这可能主要是内置的。所以您创建类似

```
String[] ResultSetToStrings(ResultSet aResultSet) 
```

然后你的电话看起来像

```
processCar(["1994","Ford","Probe","etc"]); 
```

或者

```
processCar(ResultSetToStrings(aResultSet)); 
```

并且您丢弃了代码的 ResultSet 版本。

这可能会导致一些效率损失（可能可以忽略不计 - 转换为 CSV 所花费的时间和一些额外的字符串操作）。还要确保您的 CSV 以正确的顺序出现（可能需要在 SQL 查询中明确说明列名和顺序，或者在转换例程中查阅 CSVColumns 对象）并处理多行、空格、逗号等内容在字段值等中

反过来也可能有效 - 将您的 String[] 更改为结果集。事实上，同样取决于您的数据库驱动程序，这可能是内置的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:21:43.557

# 抽象数据源和使用通用接口

这个想法是有一个通用适配器，可以将`ResultSet`CSV 或 CSV 转换为一致接口后面的通用内容：

```
interface CarDataSource {

    getCarId();
    //...

} 
```

和两个实现：

```
class CsvDataSource implements CarDataSource {

    private final String[] row;

    public CsvDataSource(String[] row) {
        this.row = row;
    }

    public int getCarId() {
        return Integer.parseInt(row[CSVColumns.carid.index]);
    }

    //...

}

class ResultSetDataSource implements CarDataSource {

    private final ResultSet rs;

    public ResultSetDataSource(ResultSet rs) {
        this.rs = rs;
    }

    public int getCarId() {
        return Integer.parseInt(rs.getString("Name));
    }

    //...

} 
```

这就是你使用它的方式：

```
private Car processCar(CarDataSource s) {
    Car c = new Car();
    c.setCarId(s.getCarId());
    ....
    return c;
} 
```

提供`new CsvDataSource()`或`new ResultSetDataSource()`。

# 具有两种实现的抽象工厂：

非常相似的方法，创建和抽象工厂：

```
interface CarFactory {

    Car create();

} 
```

有两种实现：

```
class CsvCarFactory implements CarFactory {

    private final String[] row;

    public CsvDataSource(String[] row) {
        this.row = row;
    }

    public Car create() {
        Car c = new Car();
        c.setCarId(Integer.parseInt(row[CSVColumns.carid.index]));
        //...
        return c;
    }

}

class ResultSetCarFactory implements CarDataSource {

    private final ResultSet rs;

    public ResultSetCarFactory(ResultSet rs) {
        this.rs = rs;
    }

    public Car create() {
        Car c = new Car();
        c.setCarId(rs.getInt("Id"));
        //...
        return c;
    }

    //...

} 
```

# 组合

我不喜欢上述任何一种方法，因为它们引入了很多样板文件而没有增加太多价值。但第一种方法是有希望的，一旦你减少它。

只有一个`processCar()`作为`String[]`论据。但是，如果您有`ResultSet`，只需将其首先转换为`String[]`，将列提取到数组中的后续项目中：

```
public String[] toStringArray(ResultSet rs) 
```

另一个方向的翻译，即`ResultSet`基本格式也是可能的，但`ResultSet`单独实现要困难得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:23:35.973

另一种可以简化程序方面的方法：

```
private Car processCar (String [] row) {
    return new Car(Integer.parseInt(row[CSVColumns.carid.index]));
}

private Driver processDriver(String[] row) {
     return new Driver(row[CSVColumns.name.index], row[CSVColumns.age.index]);
} 
```

尽管您通常会通过使用比字符串更独特的类型来使您的生活更轻松，但允许它们与字符串表示形式相互转换。然后，您的解析器可以支持从 CSV 输入创建这些特殊类型。因此，添加类型安全也可以在很大程度上消除冗余并使其更易于维护。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T20:28:25.730

一种解决方案可能是使用`Adapter`接口。

```
 interface ParamAdapter {
    int getCarID();
    //...
} 
```

```
 class ResultSetParamAdapter implements ParamAdapter {

    private final ResultSet rs;

    public ResultSetParamAdapter(ResultSet rs) {
       this.rs = rs;
    }

    public int getCarID() {
        return rs.getInt("Id");
    }

    //...
} 
```

```
 class StringArrayParamAdapter implements ParamAdapter {

    private String[] array;

    public ResultSetParamAdapter(String[] array) {
       this.array = array;
    }

    public int getCarID() {
        return Integer.parseInt(array[CSVColumns.carid.index]);
    }

    //...
} 
```

这三个点是您可能需要的其他方法。

# windows-runtime - WinRT 与 xsd.exe 生成的序列化/无权访问 System.Xml.XmlNode

> ID：13166659
> 
> 赞同：1
> 
> 时间：2012-10-31T20:06:10.370
> 
> 标签：windows-runtime, xmlserializer, xsd.exe, xmlnode

我有通过 xsd.exe (xsd.exe someschema.xsd /classes) 生成的类。其中一个节点被声明为一个元素：

```
<xs:element name="containsxmlelementsbeneath"/> 
```

正如（虚构的）名称所暗示的那样，它看起来像这样：

```
<containsxmlelementsbeneath>
  <somemore>
    ...
  </somemore>
</containsxmlelementsbeneath> 
```

当它被反序列化时，我在调试器中看到它的类型

```
System.Xml.XmlNode[] 
```

我可以在即时窗口中强制它

```
?((System.Xml.XmlNode[])elem.containsxmlelementsbeneath)[0].InnerXml 
```

我没有 IntelliSense，当我在我的代码中尝试该片段时，这是有道理的——该类似乎已从 WinRT 配置文件中删除——如果你需要的只是 Windows.Data.Xml.Dom.IXmlNode，这很好——但不在这个案例。

我怎样才能去获取该元素的字符串表示形式？有没有办法“修复” xsd.exe 生成的输出，使其使用 Windows.Data.Xml.Dom 进行序列化？（在我看来不像）

我是否遇到了他们没有想到的边缘案例？

更新 - 尝试了以下（我知道，滥用动态）：

```
dynamic x = elem.containsxmlelementsbeneath;
string s = x[0].InnerXml; 
```

这会产生“API 'System.Xml.XmlNode[]' 不能在当前平台上使用。”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:06:40.423

我与另一位开发人员进行了（更长的）聊天 - 经过一些试验和错误，我们想出了一个解决方案：

```
<xs:element ref="containsxmlelementsbeneath"/>

<xs:element name="containsxmlelementsbeneath">
</xs:element> 
```

这为我们创建了一个空类（通过 xsd.exe）

```
[System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "4.0.30319.17929")]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.Xml.Serialization.XmlTypeAttribute(AnonymousType = true)]
[System.Xml.Serialization.XmlRootAttribute(Namespace = "", IsNullable = false)]
public partial class containsxmlelementsbeneath
{
} 
```

这必须像这样修改：

```
[System.Xml.Serialization.XmlRootAttribute(Namespace = "", IsNullable = false)]
public partial class containsxmlelementsbeneath : IXmlSerializable
{
    [XmlIgnore]
    public string Text { get; set; }

    public System.Xml.Schema.XmlSchema GetSchema()
    {
        throw new System.NotImplementedException();
    }

    public void ReadXml(System.Xml.XmlReader reader)
    {
        Text = reader.ReadInnerXml();
    }

    public void WriteXml(System.Xml.XmlWriter writer)
    {
        throw new System.NotImplementedException();
    }
} 
```

请注意，必须删除除 XmlRoot 之外的所有属性，否则会出现反射异常（只能为 containsxmlelementsbeneath 类型指定 XmlRoot 属性。请使用 XmlSchemaProviderAttribute 指定架构类型。）

最终结果：这个节点及其所有子节点作为一个普通的旧字符串。不再有不可访问的 XmlNode 或 XmlElement ...

# java - Java重命名旧目录或将其删除以创建新目录

> ID：13166664
> 
> 赞同：1
> 
> 时间：2012-10-31T20:06:23.767
> 
> 标签：java, directory

我正在处理的面板有问题，我正在处理的是每当从一个软件版本升级到另一个版本时，Windows 机器上的旧开始菜单组仍然显示。我试图看看我是否可以先删除旧目录然后创建新目录，但所发生的只是旧目录仍然存在。不太确定如何去做，我只需要开始菜单组中的一个目录来显示我删除或重命名旧的天气。

这是我到目前为止删除旧系统变量的内容。这是我正在做的事情，我知道它并不完美，但我们将不胜感激。如果您需要解释，我很乐意遵守。谢谢

```
 if ( PrioGlobals.UPGRADE ){
        oldm_txtGrpName.setText(PrioGlobals.StartMenuFolder);
    }

if ( PrioGlobals.UPGRADE ){   
           String oldShortCutPath = PrioGlobals.cre.getShorcutDirectory();
           String oldStartMenuGroupFolderPath = oldShortCutPath + File.separator + BrandStrings.WIN_FOLDER_NAME + 
        File.separator +oldm_txtGrpName.getText(); 

           File oldStartmenu = new File(oldStartMenuGroupFolderPath);
           if (oldStartmenu.exists())
           {
               oldStartmenu.delete();
           }
           else
               oldStartmenu.delete();
           } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:32:20.583

如果我正确阅读了您的代码，`oldStartmenu`是目录吗？在这种情况下，`oldStartmenu.delete()`可能会因为目录不为空而失败（请参阅[File delete](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/File.html#delete%28%29)）在这种情况下，您需要递归地删除目录及其所有文件。

在这一点上，我建议包括 commons-io [FileUtils](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html)并使用目录实用程序之一，例如[forceDelete](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html#forceDelete%28java.io.File%29)或[deleteDirectory](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html#deleteDirectory%28java.io.File%29)

[更新]

将 commons-io 库添加到项目后，您将

```
// import FileUtils
import org.apache.commons.io.FileUtils;

// ...

if (oldStartmenu.exists())
{
    FileUtils.deleteDirectory(oldStartmenu);
} 
```

# wix - 将 EXE 安装程序包装在 WIX msi 中

> ID：13166665
> 
> 赞同：1
> 
> 时间：2012-10-31T20:06:24.470
> 
> 标签：wix, installation, reportviewer

我发现[这篇文章](http://antipatterns.blogspot.com/2012/03/wix-project-to-wrap-exe-installer.html)展示了如何在使用 WIX 安装程序完成安装时调用 EXE 安装程序。不幸的是，它并不适合我：安装完成后 EXE 没有启动。有没有人有一个工作的例子？除非瑞恩先生的例子有什么容易改变的地方吗？任何投入将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:18:49.647

您可以使用 WIX v3.6 Bundle 概念来处理这个问题。你可以在这里阅读更多关于它的信息 [http://wix.sourceforge.net/manual-wix3/authoring_bundle_intro.htm](http://wix.sourceforge.net/manual-wix3/authoring_bundle_intro.htm)

基本上，您将 WIX MSI 和 EXE 打包成一个 WIX 捆绑包，然后可以将其安装到目标机器上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T09:27:09.050

我还想保留 MSI 的 UI，所以我添加了这段代码来启动硬件密钥的 exe 安装程序。我知道这违反了 MSI 最佳实践，但这是我唯一打算打破的。希望这可以帮助。

```
<Property Id="WixShellExecTarget" Value="[#myapplication.exe]" />
<CustomAction Id="LaunchApplication" BinaryKey="WixCA" DllEntry="WixShellExec" Impersonate="yes" /> 
```

然后我通过单击按钮运行自定义操作。或者您可以安排它在`InstallFinalize`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T14:25:16.637

瑞安先生在这里 :)

如果这是有用的：

这是我制作的 WiX 项目，用于使用 GPO（组策略）安装 Report Viewer 2010

[http://www.natureireland.com/Downloads/StackOverflow/oRV2010Installer.rar](http://www.natureireland.com/Downloads/StackOverflow/oRV2010Installer.rar)

注意：我使用的是 WiX 版本：**Windows Installer XML v3.5**

问候

肖恩

# ruby - 如何使用 nokogiri 从 URL 列表中抓取数据并将数据保存到 CSV

> ID：13166666
> 
> 赞同：1
> 
> 时间：2012-10-31T20:06:26.230
> 
> 标签：ruby, csv, nokogiri

我有一个名为 bontyurls.csv 的文件，如下所示：

```
http://bontrager.com/model/11383
http://bontrager.com/model/01740
http://bontrager.com/model/09595 
```

我希望我的脚本读取该文件，然后吐出这样的文件：bonty_test_urls_results.csv

```
url,model_names
http://bontrager.com/model/11383,"Road TLR Conversion Kit"
http://bontrager.com/model/01740,"404 File Not Found"
http://bontrager.com/model/09595,"RXL Road" 
```

这是我到目前为止所得到的：

```
# based on code from here: http://www.andrewsturges.com/2011/09/how-to-harvest-web-data-using-ruby-and.html

require 'nokogiri'
require 'open-uri'
require 'csv'

@urls = Array.new
@model_names = Array.new

urls = CSV.read("bontyurls.csv")
(0..urls.length - 1).each do |index|
  puts urls[index][0]
  doc = Nokogiri::HTML(open(urls[index][0]))
  doc.xpath('//h1').each do |model_name|
    @model_name << model_name.content
  end
end

# write results to file  
CSV.open("bonty_test_urls_results.csv", "wb") do |row|
  row << ["url", "model_names"]
  (0..@urls.length - 1).each do |index|
    row << [
      @urls[index], 
      @model_names[index]]
  end
end 
```

该代码不起作用。我收到此错误：

```
$ ruby bonty_test_urls.rb 
http://bontrager.com/model/00310
bonty_test_urls.rb:15:in `block (2 levels) in <main>': undefined method `<<' for nil:NilClass (NoMethodError)
    from /home/simon/.rvm/gems/ruby-1.9.3-p194/gems/nokogiri-1.5.5/lib/nokogiri/xml/node_set.rb:239:in `block in each'
    from /home/simon/.rvm/gems/ruby-1.9.3-p194/gems/nokogiri-1.5.5/lib/nokogiri/xml/node_set.rb:238:in `upto'
    from /home/simon/.rvm/gems/ruby-1.9.3-p194/gems/nokogiri-1.5.5/lib/nokogiri/xml/node_set.rb:238:in `each'
    from bonty_test_urls.rb:14:in `block in <main>'
    from bonty_test_urls.rb:11:in `each'
    from bonty_test_urls.rb:11:in `<main>' 
```

这是一些至少返回 model_name 的代码。我只是无法让它在更大的脚本中工作：

```
require 'open-uri'
require 'nokogiri'

doc = Nokogiri::HTML(open("http://bontrager.com/model/09124"))
doc.xpath('//h1').each do |node|
  puts node.text
end 
```

另外，我还没有弄清楚如何处理返回 404 的 URL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T00:02:20.153

这就是我的做法：

```
require 'csv'
require 'nokogiri'
require 'open-uri'

CSV_OPTIONS = {
  :write_headers => true,
  :headers => %w[url model_names]
}

CSV.open('bonty_test_urls_results.csv', 'wb', CSV_OPTIONS) do |csv|
  csv_doc = File.foreach('bontyurls.csv') do |url|
    url.chomp!
    begin
      doc = Nokogiri.HTML(open(url))
      h1 = doc.at('h1').text.strip
      h1 = doc.at('title').text.strip.sub(/^Bontrager: /i, '') if (h1.empty?)
      csv << [url, h1]
    rescue OpenURI::HTTPError => e
      csv << [url, e.message]
    end
  end
end 
```

这会生成一个 CSV 文件，如：

```
url,model_names
http://bontrager.com/model/11383,Road TLR Conversion Kit (Model #11383)
http://bontrager.com/model/01740,404 File Not Found
http://bontrager.com/model/09595,RXL Road (Model #09595) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T01:30:30.763

您声明了@model_names，但尝试推入@model_name，这就是它为nil 的原因。

# javascript - jQuery $.ajax 没有做任何事情

> ID：13166667
> 
> 赞同：0
> 
> 时间：2012-10-31T20:06:27.230
> 
> 标签：javascript, jquery

我有一个似乎没有做任何事情的 jQuery AJAX 请求。

我在 Chrome 调试器的网络选项卡上看不到任何操作，

错误/成功回调没有在函数内部被调用，并且服务器端似乎没有任何事情发生。

问题是，这并没有发生在我的主要本地域上： http: [//dev.sitename.com](http://dev.sitename.com)

它只发生在我的内页上，例如：[http ://dev.sitename.com/about](http://dev.sitename.com/about)

我的猜测是有一些 .htaccess 规则正在破坏进程，但我没有看到任何网络活动，那么它怎么可能呢？

这是我的代码：

```
$.ajax({
    url: 'ajax.php?cachekiller=' + (new Date()).getTime(),
    data: {
        action: 'doLogin'
    },
    success: function() {
    // Not being called
    },
    error: function() {
    // Not being called either
    }
}); 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T20:35:13.353

试试这个：

```
$.ajax({
  url: 'ajax.php',
  cache: false,
  data: {
      action: 'doLogin'
  },
  success: function(data) {
      console.log(data);
  },
  error: function() {
      console.log('error');
  }
}); 
```

并在 ajax.php 脚本中：

```
header("Pragma: no-cache");
header("Cache-Control: must-revalidate");
header("Cache-Control: no-cache");
header("Cache-Control: no-store");
header("Expires: 0"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T20:15:40.877

尝试将 cachekiller 放在数据参数上

```
$.ajax({
    url: 'ajax.php',
    data: {
        cachekiller: (new Date()).getTime(),
        action: 'doLogin'
    },
    success: function() {
    // Not being called
    },
    error: function() {
    // Not being called either
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T20:30:13.170

好的，一切似乎都很好，这里有一些你可以检查的东西

1.  （可能看起来很离谱）你是否包含了 jQuery.js
2.  确保在任何其他 js 文件之前包含 jQuery.js
3.  `/`在类似之前放一个，`url`并确保您已将其放在`ajax.php`服务器的根目录中
4.  如评论中所述，检查 firebug 控制台（firefox）或 chrome 开发人员工具中的任何 js 错误

> ```
> $.ajax({
>         url: '/ajax.php',
>         cache:false,
>         data: {
>             action: 'doLogin'
>         },
>         success: function() {
>         // Not being called
>         },
>         error: function() {
>         // Not being called either
>         }
>     }); 
> ```

你不需要使用 ajax 方法的 cachekiller 使用`cache:false`prop

# windows - 谁可以写入分配的地址？

> ID：13166670
> 
> 赞同：0
> 
> 时间：2012-10-31T20:06:36.553
> 
> 标签：windows, winapi

我在 Delphi 中使用 VirtualAllocEx 在外部进程中保留内存，如下所示：

```
var
 p : pointer;
begin
 p := VirtualAllocEx(Process, nil, SizeOf(Integer), MEM_COMMIT or MEM_RESERVE, PAGE_EXECUTE_READWRITE);
end; 
```

ProcessHandle 之前已经打开`PROCESS_ALL_ACCESS`过。

之后，我的程序将一个简单的整数值写入分配的地址，如下所示：

```
WriteProcessMemory(Process, p, @MyInteger, SizeOf(Integer), BytesWritten); 
```

由于地址存储在`p`- 我可以保存地址以将其用于另一个应用程序。另一个应用程序必须再次打开外部进程才能访问/写入外部进程中的地址。

我现在的问题是：谁/什么可以在外国进程中读/写这个地址？

每个进程都允许写吗？每个进程都允许读取吗？只有具有管理员权限的进程才有读/写权限吗？

感谢您的回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T20:31:42.363

任何拥有授予读写访问权限的进程句柄的人都可以读取或写入内存。请参阅： [PROCESS_VM_READ](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684880%28v=vs.85%29.aspx)和[PROCESS_VM_WRITE](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684880%28v=vs.85%29.aspx)。因此，最终，这取决于您如何获得进程的句柄以及该进程的 DACL。

如果您创建了进程或启用了 SeDebugPrivilege，您通常可以获得所有访问权限。当您调用 时[`OpenProcess`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684320%28v=vs.85%29.aspx)，您必须指定您想要的访问类型，它会根据进程的安全描述符检查该请求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T20:16:33.810

如果没记错的话，Windows 会将其归类为调试。

无论如何，您都可以调试自己的进程。

如果您被授予（并启用），您可以调试其他用户的进程`SeDebugPrivilege`。

请注意，将 SeDebugPrivilege 授予帐户基本上也使该帐户成为管理员帐户- 即，如果已授予 SeDebugPrivilege，则使用该帐户的人基本上可以做他们想做的任何事情，并为他们自己选择任何其他权限。Ergo：除非您真的需要，否则不要授予它（除非您正在做诸如调试系统服务进程之类的事情，否则您可能不会这样做）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T20:15:18.720

默认情况下，任何具有兼容完整性级别的东西都可以使用`ReadProcessMemory`和`WriteProcessMemory`。这意味着完整性级别大于或等于目标进程的完整性级别。

# vb.net - vb.net 应用程序来跟踪 webbrowser 弹出窗口

> ID：13166671
> 
> 赞同：0
> 
> 时间：2012-10-31T20:06:42.540
> 
> 标签：vb.net

我的表单上有一个 webbrowser 控件，当我导航到某个页面时，它会打开一个弹出窗口，在当前默认的窗口浏览器中打开该页面，在本例中为 IE。我想访问此页面的源代码。我不想关闭它，我只想抓取 html。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T18:20:15.040

编辑：

解决方案：

eWebbrowser.vb：

```
Imports System
Imports System.Text
Imports System.Windows.Forms
Imports System.ComponentModel
Imports System.Collections.Generic
Imports System.Runtime.InteropServices
Imports System.Security.Permissions

<PermissionSet(SecurityAction.Demand, Name:="FullTrust")> _
<System.Runtime.InteropServices.ComVisibleAttribute(True)> _
Public Class eWebbrowser
    Inherits System.Windows.Forms.WebBrowser

#Region " COM Imports Etc..."
    <StructLayout(LayoutKind.Sequential)> _
Public Structure OLECMDTEXT
        Public cmdtextf As UInt32
        Public cwActual As UInt32
        Public cwBuf As UInt32
        Public rgwz As Char
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Public Structure OLECMD
        Public cmdID As Long
        Public cmdf As UInt64
    End Structure
    ' Interop - IOleCommandTarget (See MSDN - http://support.microsoft.com/?kbid=311288)
    <ComImport(), Guid("b722bccb-4e68-101b-a2bc-00aa00404770"), _
    InterfaceType(ComInterfaceType.InterfaceIsIUnknown)> _
    Public Interface IOleCommandTarget
        Sub QueryStatus(ByRef pguidCmdGroup As Guid, ByVal cCmds As UInt32, _
            <MarshalAs(UnmanagedType.LPArray, SizeParamIndex:=1)> ByVal prgCmds As OLECMD, _
            ByRef pCmdText As OLECMDTEXT)

        Sub Exec(ByRef pguidCmdGroup As Guid, ByVal nCmdId As Long, _
            ByVal nCmdExecOpt As Long, ByRef pvaIn As Object, _
            ByRef pvaOut As Object)
    End Interface

    Private cmdGUID As New Guid(&HED016940, -17061, _
  &H11CF, &HBA, &H4E, &H0, &HC0, &H4F, &HD7, &H8, &H16)

#Region " Commands Enumeration "
    'There are a ton of ole commands, we are only using a couple, msdn research will
    'allow you to figure out which ones you want to use.
    Enum oCommands As Long
        Options
        Find = 1
        ViewSource = 2
        '////////////////////////////////////////
        ID_FILE_SAVEAS = 32771
        ID_FILE_PAGESETUP = 32772
        ID_FILE_IMPORTEXPORT = 32774
        ID_FILE_PRINTPREVIEW = 32776
        ID_FILE_NEWIE = 32779
        ID_FILE_NEWMAIL = 32780
        PID_FILE_NEWINTERNETCALL = 32781
        ID_FILE_ADDTRUST = 32782
        ID_FILE_ADDLOCAL = 32783
        DLCTL_BGSOUNDS = &H40
        DLCTL_DLIMAGES = &H10
        DLCTL_DOWNLOADONLY = &H800
        DLCTL_FORCEOFFLINE = &H10000000
        DLCTL_NO_BEHAVIORS = &H800
        DLCTL_NO_CLIENTPULL = &H20000000
        DLCTL_NO_DLACTIVEXCTLS = &H400
        DLCTL_NO_FRAMEDOWNLOAD = &H1000
        DLCTL_NO_JAVA = &H100
        DLCTL_NO_METACHARSET = &H10000
        DLCTL_NO_RUNACTIVEXCTLS = &H200
        DLCTL_NO_SCRIPTS = &H80
        'DLCTL_OFFLINE DLCTL_OFFLINEIFNOTCONNECTED
        DLCTL_OFFLINEIFNOTCONNECTED = &H80000000
        DLCTL_PRAGMA_NO_CACHE = &H4000
        DLCTL_RESYNCHRONIZE = &H2000
        DLCTL_SILENT = &H40000000
        DLCTL_URL_ENCODING_DISABLE_UTF8 = &H20000
        DLCTL_URL_ENCODING_ENABLE_UTF8 = &H40000
        DLCTL_VIDEOS = &H20
    End Enum

#End Region

#End Region

    'Just a little easier way to get at it.
    Public ReadOnly Property CurrentURL() As String
        Get
            Return Me.Document.Url.ToString
        End Get
    End Property

    Public Sub New()
        MyBase.New()
    End Sub

#Region " Dialogs "

    Public Sub ShowOpen()
        Dim cdlOpen As New OpenFileDialog
        Try
            cdlOpen.Filter = "HTML Files (*.htm)|*.htm|HTML Files (*.html)|*.html|TextFiles" & _
                "(*.txt)|*.txt|Gif Files (*.gif)|*.gif|JPEG Files (*.jpg)|*.jpeg|" & _
                "PNG Files (*.png)|*.png|Art Files (*.art)|*.art|AU Fles (*.au)|*.au|" & _
                "AIFF Files (*.aif|*.aiff|XBM Files (*.xbm)|*.xbm|All Files (*.*)|*.*"

            cdlOpen.Title = " Open File "
            cdlOpen.ShowDialog()

            If cdlOpen.FileName > Nothing Then
                Me.Navigate(cdlOpen.FileName)
            End If
        Catch ex As Exception
            Throw New Exception(ex.Message.ToString)
        End Try
    End Sub

    Public Sub ShowSource()
        Dim cmdt As IOleCommandTarget
        Dim o As Object = Nothing
        Dim oIE As Object = Nothing
        Try
            cmdt = CType(Me.Document.DomDocument, IOleCommandTarget)
            cmdt.Exec(cmdGUID, oCommands.ViewSource, 1, o, o)

        Catch ex As Exception
            Throw New Exception(ex.Message.ToString, ex.InnerException)
        Finally
            cmdt = Nothing
        End Try
    End Sub

    Public Sub ShowFindDialog()
        Dim cmdt As IOleCommandTarget
        Dim o As Object = Nothing
        Dim oIE As Object = Nothing
        Try
            cmdt = CType(Me.Document.DomDocument, IOleCommandTarget)
            cmdt.Exec(cmdGUID, oCommands.Find, 0, o, o)

        Catch ex As Exception
            Throw New Exception(ex.Message.ToString, ex.InnerException)
        Finally
            cmdt = Nothing
        End Try
    End Sub

    Public Sub AddToFavorites(Optional ByVal strURL As String = "", Optional ByVal strTitle As String = "")
        Dim oHelper As Object = Nothing
        Try
            oHelper = New ShellUIHelper
            oHelper.AddFavorite(Me.Document.Url.ToString, Me.DocumentTitle.ToString)
        Catch ex As Exception
            Throw New Exception(ex.Message.ToString)
        End Try
        If oHelper IsNot Nothing AndAlso Marshal.IsComObject(oHelper) Then
            Marshal.ReleaseComObject(oHelper)
        End If
    End Sub

    Public Sub ShowOrganizeFavorites()
        'Organize Favorites
        Dim helper As Object = Nothing
        Try
            helper = New ShellUIHelper()
            helper.ShowBrowserUI("OrganizeFavorites", 0)
        Finally
            If helper IsNot Nothing AndAlso Marshal.IsComObject(helper) Then
                Marshal.ReleaseComObject(helper)
            End If
        End Try
    End Sub

    Public Sub SendToDesktop()
        'Shortcut to desktop
        Dim helper As Object = Nothing
        Try
            helper = New ShellUIHelper()
            helper.AddDesktopComponent(Me.Document.Url.ToString, "website")
        Finally
            If helper IsNot Nothing AndAlso Marshal.IsComObject(helper) Then
                Marshal.ReleaseComObject(helper)
            End If
        End Try
    End Sub

    ''' <summary>
    ''' This Will launch the internet option dialog.
    ''' </summary>
    ''' <remarks></remarks>
    Public Sub ShowInternetOptions()
        Shell("rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,0", vbNormalFocus)
    End Sub

    Public Sub ShowPrivacyReport()
        Shell("rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,2", vbNormalFocus)
    End Sub

#End Region

#Region " Extended "

    <ComImport(), _
        Guid("34A715A0-6587-11D0-924A-0020AFC7AC4D"), _
        InterfaceTypeAttribute(ComInterfaceType.InterfaceIsIDispatch), _
        TypeLibType(TypeLibTypeFlags.FHidden)> _
        Public Interface DWebBrowserEvents2

        <DispId(250)> _
        Sub BeforeNavigate2(<[In](), MarshalAs(UnmanagedType.IDispatch)> ByVal pDisp As Object, _
        <InAttribute(), MarshalAs(UnmanagedType.BStr)> ByRef URL As String, _
        <InAttribute()> ByRef flags As Object, _
        <InAttribute(), MarshalAs(UnmanagedType.BStr)> ByRef targetFrameName As String, _
        <InAttribute()> ByRef postdata As Object, _
        <InAttribute(), MarshalAs(UnmanagedType.BStr)> ByRef headers As String, _
        <InAttribute(), OutAttribute()> ByRef cancel As Boolean)

        'Note: Postdata is a SafeArray but for some reason, if I do a proper declaration, the event will not be raised:
        '<[In](), MarshalAs(UnmanagedType.SafeArray, safearraysubtype:=VarEnum.VT_UI1)> ByRef postdata() As Byte, _

        <DispId(273)> _
        Sub NewWindow3(<InAttribute(), MarshalAs(UnmanagedType.IDispatch)> ByVal pDisp As Object, _
        <InAttribute(), OutAttribute()> ByRef cancel As Boolean, _
        <InAttribute()> ByRef Flags As Object, _
        <InAttribute(), MarshalAs(UnmanagedType.BStr)> ByRef UrlContext As String, _
        <InAttribute(), MarshalAs(UnmanagedType.BStr)> ByRef Url As String)

    End Interface

    Public Enum NWMF
        NWMF_UNLOADING = &H1&
        NWMF_USERINITED = &H2&
        NWMF_FIRST_USERINITED = &H4&
        NWMF_OVERRIDEKEY = &H8&
        NWMF_SHOWHELP = &H10&
        NWMF_HTMLDIALOG = &H20&
        NWMF_FROMPROXY = &H40&
    End Enum

    Private cookie As AxHost.ConnectionPointCookie
    Private wevents As WebBrowserExtendedEvents

    'This method will be called to give you a chance to create your own event sink
    Protected Overrides Sub CreateSink()
        'MAKE SURE TO CALL THE BASE or the normal events won't fire
        MyBase.CreateSink()
        wevents = New WebBrowserExtendedEvents(Me)
        cookie = New AxHost.ConnectionPointCookie(Me.ActiveXInstance, wevents, GetType(DWebBrowserEvents2))
    End Sub

    Protected Overrides Sub DetachSink()
        If Not cookie Is Nothing Then
            cookie.Disconnect()
            cookie = Nothing
        End If
        MyBase.DetachSink()
    End Sub

    'This new event will fire when the page is navigating
    Public Delegate Sub WebBrowserNavigatingExtendedEventHandler(ByVal sender As Object, ByVal e As WebBrowserNavigatingExtendedEventArgs)
    Public Event NavigatingExtended As WebBrowserNavigatingExtendedEventHandler

    'This event will fire when a new window is about to be opened
    Public Delegate Sub WebBrowserNewWindowExtendedEventHandler(ByVal sender As Object, ByVal e As WebBrowserNewWindowExtendedEventArgs)
    Public Event NewWindowExtended As WebBrowserNewWindowExtendedEventHandler

    Protected Friend Sub OnNavigatingExtended(ByVal Url As String, ByVal Frame As String, ByVal Postdata As Byte(), ByVal Headers As String, ByRef Cancel As Boolean)
        Dim e As WebBrowserNavigatingExtendedEventArgs = New WebBrowserNavigatingExtendedEventArgs(Url, Frame, Postdata, Headers)
        RaiseEvent NavigatingExtended(Me, e)
        Cancel = e.Cancel
    End Sub

    Protected Friend Sub OnNewWindowExtended(ByVal Url As String, ByRef Cancel As Boolean, ByVal Flags As NWMF, ByVal UrlContext As String)
        Dim e As WebBrowserNewWindowExtendedEventArgs = New WebBrowserNewWindowExtendedEventArgs(Url, UrlContext, Flags)
        RaiseEvent NewWindowExtended(Me, e)
        Cancel = e.Cancel
    End Sub

    Public Overloads Sub Navigate2(ByVal URL As String)
        MyBase.Navigate(URL)
    End Sub

#End Region

#Region " Extended Event Classes "
    'This class will capture events from the WebBrowser
    Friend Class WebBrowserExtendedEvents
        Inherits System.Runtime.InteropServices.StandardOleMarshalObject
        Implements DWebBrowserEvents2

        Private m_Browser As eWebbrowser

        Public Sub New(ByVal browser As eWebbrowser)
            m_Browser = browser
        End Sub

        'Implement whichever events you wish
        Public Sub BeforeNavigate2(ByVal pDisp As Object, ByRef URL As String, ByRef flags As Object, ByRef targetFrameName As String, ByRef postData As Object, ByRef headers As String, ByRef cancel As Boolean) Implements DWebBrowserEvents2.BeforeNavigate2
            m_Browser.OnNavigatingExtended(URL, targetFrameName, CType(postData, Byte()), headers, cancel)
        End Sub

        Public Sub NewWindow3(ByVal pDisp As Object, ByRef Cancel As Boolean, ByRef Flags As Object, ByRef UrlContext As String, ByRef Url As String) Implements DWebBrowserEvents2.NewWindow3
            m_Browser.OnNewWindowExtended(Url, Cancel, CType(Flags, NWMF), UrlContext)
        End Sub
    End Class

    Public Class WebBrowserNewWindowExtendedEventArgs
        Inherits CancelEventArgs

        Private m_Url As String
        Private m_UrlContext As String
        Private m_Flags As NWMF

        Public ReadOnly Property Url() As String
            Get
                Return m_Url
            End Get
        End Property

        Public ReadOnly Property UrlContext() As String
            Get
                Return m_UrlContext
            End Get
        End Property

        Public ReadOnly Property Flags() As NWMF
            Get
                Return m_Flags
            End Get
        End Property

        Public Sub New(ByVal url As String, ByVal urlcontext As String, ByVal flags As NWMF)
            m_Url = url
            m_UrlContext = urlcontext
            m_Flags = flags
        End Sub

    End Class

    'First define a new EventArgs class to contain the newly exposed data
    Public Class WebBrowserNavigatingExtendedEventArgs
        Inherits CancelEventArgs

        Private m_Url As String
        Private m_Frame As String
        Private m_Postdata() As Byte
        Private m_Headers As String

        Public ReadOnly Property Url() As String
            Get
                Return m_Url
            End Get
        End Property

        Public ReadOnly Property Frame() As String
            Get
                Return m_Frame
            End Get
        End Property

        Public ReadOnly Property Headers() As String
            Get
                Return m_Headers
            End Get
        End Property

        Public ReadOnly Property Postdata() As String
            Get
                Return PostdataToString(m_Postdata)
            End Get
        End Property

        Public ReadOnly Property PostdataByte() As Byte()
            Get
                Return m_Postdata
            End Get
        End Property

        Public Sub New(ByVal url As String, ByVal frame As String, ByVal postdata As Byte(), ByVal headers As String)
            m_Url = url
            m_Frame = frame
            m_Postdata = postdata
            m_Headers = headers
        End Sub

        Private Function PostdataToString(ByVal p() As Byte) As String
            'not sexy but it works...
            Dim tabpd() As Byte, bstop As Boolean = False, stmp As String = "", i As Integer = 0
            tabpd = p
            If tabpd Is Nothing OrElse tabpd.Length = 0 Then
                Return ""
            Else
                For i = 0 To tabpd.Length - 1
                    stmp += ChrW(tabpd(i))
                Next
                stmp = Replace(stmp, ChrW(13), "")
                stmp = Replace(stmp, ChrW(10), "")
                stmp = Replace(stmp, ChrW(0), "")
            End If
            If stmp = Nothing Then
                Return ""
            Else
                Return stmp
            End If
        End Function

    End Class
#End Region

    <ComImport(), Guid("64AB4BB7-111E-11D1-8F79-00C04FC2FBE1")> _
    Public Class ShellUIHelper
        '
    End Class

End Class 
```

表单加载：

```
Public WithEvents wb As eWebbrowser
Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    Dim brws As New eWebbrowser
    wb = brws
End Sub 
```

事件：

```
Private Sub wb_NewWindow(ByVal sender As Object, ByVal e As System.ComponentModel.CancelEventArgs) Handles wb.NewWindow
    e.Cancel = True
End Sub 
```

新事件：

```
 Private Sub wb_NewWindowExtended(ByVal sender As Object, ByVal e As eWebbrowser.WebBrowserNewWindowExtendedEventArgs) Handles wb.NewWindowExtended
        e.Cancel = True
        Dim url As String = e.Url
msgbox(url) //This Is The Url!!
    End Sub 
```

# parsing - 如何在不假设 Monad 的情况下为解析器实现 Applicative 实例？

> ID：13166673
> 
> 赞同：10
> 
> 时间：2012-10-31T20:07:06.627
> 
> 标签：parsing, haskell, applicative

我不知道如何`Applicative`为这个解析器实现一个实例：

```
newtype Parser m s a = Parser { getParser :: [s] -> m ([s], a) } 
```

不假设`Monad m`。我预计只需要假设`Applicative m`，因为`Functor`实例只需要假设`Functor m`。我终于结束了：

```
instance Functor m => Functor (Parser m s) where
  fmap f (Parser g) = Parser (fmap (fmap f) . g)

instance Monad m => Applicative (Parser m s) where
  pure a = Parser (\xs -> pure (xs, a))

  Parser f <*> Parser x = Parser h
    where
      h xs = f xs >>= \(ys, f') -> 
        x ys >>= \(zs, x') ->
        pure (zs, f' x') 
```

我该怎么做呢？我尝试手动替换`>>=`，但总是在试图减少 a 时陷入困境`join`——这也需要`Monad`.

我也咨询了[Parsec](http://hackage.haskell.org/packages/archive/parsec/3.1.3/doc/html/src/Text-Parsec-Prim.html#ParsecT)，但即使这样也没有多大帮助：

```
instance Applicative.Applicative (ParsecT s u m) where
    pure = return
    (<*>) = ap 
```

我问这个问题的原因纯粹是为了自学。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-31T20:13:01.700

这是不可能的。看看你的内部`newtype`：

```
getParser :: [s] -> m ([s], a) 
```

大概，您想传递给in`[s]`的输入。这正是 和 之间的区别：`y``x <*> y``Monad m``Applicative m`

*   在`Monad`您可以使用一个计算的输出作为另一个计算的输入。
*   在`Applicative`中，你不能。

如果你做了一个有趣的把戏，这是可能的：

```
Parser x <*> Parser y = Parser $
    \s -> (\(_, xv) (s', yv) -> (s', xv yv)) <$> x s <*> y s 
```

但是，这几乎肯定不是您想要的定义，因为它是并行解析`x`的`y`。

## 修复

1.  你`ParserT`可以`Applicative`很容易地：

    ```
    newtype ParserT m s a = ParserT { runParser :: [s] -> m ([s], a) }
    -- or, equvalently
    newtype ParserT m s a = ParserT (StateT [s] m a)

    instance Monad m => Applicative (ParserT m s) where
        ... 
    ```

    请注意，只要您不定义实例，`ParserT m s`它就*不是*实例。`Monad``Monad`

2.  您可以将剩余字符移出解析器：

    ```
    newtype ParserT m s a = ParserT { runParser :: [s] -> ([s], m a) }

    instance Applicative m => Applicative (ParserT m s) where
        ParserT x <*> ParserT y = ParserT $ \s ->
            let (s', x') = x s
                (s'', y') = y s'
            in x' <*> y'
        ... 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-01T11:14:01.053

旨在尽可能使用 Applicative 的满分——它更干净。

标题：**您的解析器可以保持 Applicative，但您可能的解析集合需要存储在 Monad 中。**内部结构：使用单子。外部结构：适用。

你`m ([s],a)`用来表示一堆可能的解析。当您解析下一个输入时，您希望它依赖于已解析的内容，但您正在使用它是`m`因为可能解析的可能少于或多于一个；你想做`\([s],a) -> ...`一个新的`m ([s],a)`. 该过程称为绑定和使用`>>=`或等效，因此您的容器绝对是 Monad，无法逃脱。

为你的容器使用一个 monad 并没有那么糟糕——毕竟它只是一个你保存一些东西的容器。在内部使用 monad 和成为 monad 是有区别的。您的解析器可以在内部使用 monad 时适用。

请参阅[应用解析相对于单子解析有什么好处？](https://stackoverflow.com/questions/7861903/what-are-the-benefits-of-applicative-parsing-over-monadic-parsing).

如果您的解析器是适用的，那么它们会更简单，因此理论上您可以在组合它们时进行一些优化，方法是保留有关它们所做工作的*静态信息而不是保留它们的**实现*。例如，

```
string "Hello World!" <|> string "Hello Mum!"
== (++) <$> string "Hello " <*> (string "World" <|> string "Mum!") 
```

第二个版本比第一个更好，因为它没有回溯。

如果你做很多这样的事情，就像在运行之前编译一个正则表达式，创建一个图形（有限状态自动机）并尽可能地简化它并消除整个低效回溯的负载。

# php - DHL, Soap, PHP - 不懂

> ID：13166676
> 
> 赞同：0
> 
> 时间：2012-10-31T20:07:45.520
> 
> 标签：php, soap, soapui

我必须使用 PHP 向 DHL 承运人服务发出 SOAP 请求以生成批次标签。不知何故，我无法理解它是如何工作的。我写了这段代码：

```
<?php 

require_once('lib/Zend/Soap/Client.php');
require_once('lib/Zend/Soap/Client/Common.php');

$client = new Zend_Soap_Client('http://test-intraship.dhl.com/ws/1_0/ISService/DE.wsdl',  
                        array(  
                                'soap_version'=>SOAP_1_1  
                                ,'encoding' => 'UTF-8'  
                                ,'compression' => SOAP_COMPRESSION_ACCEPT | SOAP_COMPRESSION_DEFLATE  
                                ,'location'=>'https://test-intraship.dhl.com/intraship.57/jsp/Login_WS.jsp' 

                        )  
                );  

$location = 'https://test-intraship.dhl.com/intraship.57/jsp/Login_WS.jsp'; 

$request = '
<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:cis="http://dhl.de/webservice/cisbase" xmlns:de="http://de.ws.intraship">
<soap:Header><cis:Authentification><cis:user>magento</cis:user><cis:signature>m1a2$!</cis:signature><cis:accountNumber>5000000000</cis:accountNumber><cis:type>0</cis:type></cis:Authentification>
</soap:Header>
<soap:Body><de:CreateShipmentDDRequest>
<cis:Version>
<cis:majorRelease>1</cis:majorRelease>
<cis:minorRelease>0</cis:minorRelease></cis:Version><ShipmentOrder><SequenceNumber>1</SequenceNumber><Shipment><ShipmentDetails><ProductCode>EPN</ProductCode><ShipmentDate>2012-10-03</ShipmentDate><DeclaredValueOfGoods>10.2</DeclaredValueOfGoods><DeclaredValueOfGoodsCurrency>EUR</DeclaredValueOfGoodsCurrency><cis:EKP>5000000000</cis:EKP><Attendance><cis:partnerID>01</cis:partnerID></Attendance><CustomerReference>Auftrag 12883884</CustomerReference><ShipmentItem><WeightInKG>12</WeightInKG><LengthInCM>1</LengthInCM><WidthInCM>1</WidthInCM><HeightInCM>10</HeightInCM><PackageType>PK</PackageType></ShipmentItem><Service><ShipmentServiceGroupIdent><ReturnReceipt>false</ReturnReceipt></ShipmentServiceGroupIdent></Service><Service><ShipmentServiceGroupIdent><Personally>false</Personally></ShipmentServiceGroupIdent></Service><Service><ServiceGroupDHLPaket><Multipack>False</Multipack></ServiceGroupDHLPaket></Service><BankData><cis:accountOwner>DHL.de</cis:accountOwner><cis:accountNumber>1234567891</cis:accountNumber><cis:bankCode>87050000</cis:bankCode><cis:bankName>Sparkasse Chemnitz</cis:bankName><cis:iban>DE34870500001234567891</cis:iban><cis:note>Notiz Bank</cis:note><cis:bic>CHEKDE81XXX</cis:bic></BankData></ShipmentDetails><Shipper><Company><cis:Person><cis:firstname></cis:firstname><cis:lastname>Deutsche Post IT BRIEF GmbH</cis:lastname></cis:Person></Company><Address><cis:streetName>Heinrich-Brüning-Str.</cis:streetName><cis:streetNumber>7</cis:streetNumber><cis:Zip><cis:germany>53113</cis:germany></cis:Zip><cis:city>Bonn</cis:city><cis:Origin><cis:countryISOCode>DE</cis:countryISOCode></cis:Origin></Address><Communication><cis:phone>3935644</cis:phone><cis:email>dhl@dhl.com</cis:email><cis:contactPerson>IT Systeme Marketing  Vertrieb</cis:contactPerson></Communication></Shipper><Receiver><Company><cis:Company><cis:name1>DHL Vertriebs GmbH Co. OHG</cis:name1></cis:Company></Company><Address><cis:streetName>Neue Poststr.</cis:streetName><cis:streetNumber>1</cis:streetNumber><cis:Zip><cis:other>08496</cis:other></cis:Zip><cis:city>Neumark</cis:city><cis:Origin><cis:countryISOCode>DE</cis:countryISOCode></cis:Origin></Address><Communication><cis:phone>3935655</cis:phone><cis:email>dhl@dhl.com</cis:email><cis:contactPerson>CIS 1J4</cis:contactPerson></Communication></Receiver><ExportDocument><InvoiceType>proforma</InvoiceType><InvoiceDate>2012-10-03</InvoiceDate><InvoiceNumber>444444</InvoiceNumber><ExportType>1</ExportType><ExportTypeDescription>für Sonstiges</ExportTypeDescription><CommodityCode>8888888</CommodityCode><TermsOfTrade>CIP</TermsOfTrade><Amount>2000</Amount><Description>777777</Description><CountryCodeOrigin>DE</CountryCodeOrigin><AdditionalFee>3.12</AdditionalFee><CustomsValue>2.23</CustomsValue><CustomsCurrency>EUR</CustomsCurrency><PermitNumber>666666</PermitNumber><AttestationNumber>?</AttestationNumber><ExportDocPosition><Description>Harddisk</Description><CountryCodeOrigin>DE</CountryCodeOrigin><CommodityCode>123456</CommodityCode><Amount>200</Amount><NetWeightInKG>1</NetWeightInKG><GrossWeightInKG>1.2</GrossWeightInKG><CustomsValue>200</CustomsValue><CustomsCurrency>EUR</CustomsCurrency></ExportDocPosition></ExportDocument></Shipment><LabelResponseType>URL</LabelResponseType></ShipmentOrder></de:CreateShipmentDDRequest></soap:Body></soap:Envelope>
';

$clientCommon = new Zend_Soap_Client_Common($client, 'http://test-intraship.dhl.com/ws/1_0/ISService/DE.wsdl',  
                        array(  
                                'soap_version'=>SOAP_1_1  
                                ,'encoding' => 'UTF-8'  
                                ,'compression' => SOAP_COMPRESSION_ACCEPT | SOAP_COMPRESSION_DEFLATE  
                                ,'location'=>'https://test-intraship.dhl.com/intraship.57/jsp/Login_WS.jsp' 

                        ));  
    $response =  $client->_doRequest($clientCommon, trim($request), $location, 'createShipmentDD', SOAP_1_1);  

    print_r($response);

?> 
```

XML 代码是从 DHL 测试工具中复制的，访问数据是标准测试数据，实际上应该始终有效。但我总是变成“错误的登录数据”——消息。为什么会这样？

我试图用 SoapUI 程序找出一些东西，但我似乎不明白所有这些东西是如何工作的。

你能给我一些帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T19:01:42.993

您尝试将 SOAP 请求发送到 ( `https://test-intraship.dhl.com/intraship.57/jsp/Login_WS.jsp`) 的 URL 未用作 Web 服务端点 - 它是用于将您的客户登录到 DHL Intraship 客户门户的单点登录 URL（您可以在那里手动提交包裹数据） .

Web 服务的端点是`http://test-intraship.dhl.com/ws/1_0/de/ISService`（来源：[https](https://entwickler.dhl.de/group/ep/webservices/intraship/quick-start) ://entwickler.dhl.de/group/ep/webservices/intraship/quick-start ）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T10:51:55.553

您可能需要 DHL 提供的更多信息

[https://test-intraship.dhl.com/intraship.57/jsp/Login_WS.jsp](https://test-intraship.dhl.com/intraship.57/jsp/Login_WS.jsp)

要登录此 URL，您需要用户名和密码，此信息不是您在 soap:Header 节点中传递的 cis:Authentification 部分。

您需要在新的“Zend_Soap_Client_Common”对象中设置这个新的用户名和密码。

# ruby-on-rails - 如何使用 Ruby 表单选择帮助器方法在下拉菜单中拥有一个不是选项的默认选择值

> ID：13166677
> 
> 赞同：0
> 
> 时间：2012-10-31T20:07:52.023
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, form-helpers, html-select

好的，所以我正在从事一个外包的项目，现在我可以在它投入生产之前加入并修复所有内容。我目前正在尝试修改创建选择表单字段的行。我阅读了在 ruby​​ 中使用的一些不同的表单辅助方法，以及该方法的一些可用选项。

我的问题是我似乎无法弄清楚如何在不显示在下拉选项中的情况下在选择元素内显示默认值。这就是这条线目前的样子。

```
<%= select :profile, :sexual_interest, SEXUAL_INTEREST_ARRAY, {:prompt => 'sexuality'}, {:class => 'selectFull'} %> 
```

我尝试使用：default => 'sexuality' 更改一些选项，然后尝试：disabled => 'sexuality'。但我似乎只能从选择元素中完全删除该选项，或者将其作为下拉列表中的第一个值并显示为默认值。

如果您只是在使用 ruby​​ 表单助手设置选择字段的默认值时遇到问题，请参考这篇文章[为选项字段选择默认值](https://stackoverflow.com/questions/623458/rails-select-helper-default-selected-value-how)

如果有人能给我一些关于如何解决这个问题的见解，我将不胜感激。任何想法都会有所帮助，感谢阅读。

-艾伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:19:35.220

在 HTML 中不可能做到这一点，因此您必须使用另一种方法。

**可能的解决方案**

假设你有：

```
<select name="selectBox" id="selectBox">
    <option value="default">default</option>
    <option value="option1">option1</option>
    <option value="option2">option2</option>
    <option value="option3">option3</option>
    <option value="option4">option4</option>    
</select> 
```

然后您的 javascript 将如下所示：

```
$("#selectBox").change(function(){
   $("#selectBox option[value='default']").remove();
}​); 
```

[jsFiddle](http://jsfiddle.net/felipeclopes/WMPJV/)上的例子​</p>

**选择器**

```
$('#selectBox option[value="SEL1"]') 
```

对于索引：

```
$('#selectBox  option:eq(1)') 
```

对于已知文本：

```
$('#selectBox option:contains("Selection 1")') 
```

希望对你有帮助！

# javascript - Rails 使用 Jquery 编辑操作

> ID：13166681
> 
> 赞同：0
> 
> 时间：2012-10-31T20:08:18.317
> 
> 标签：javascript, jquery, ruby-on-rails

我试图允许管理员在当前页面中编辑用户，例如列出所有用户的索引页面/操作。因此，当他们单击编辑时，我如何让他们在不转到另一个视图的情况下编辑字段？我确定这是用 jquery 完成的，我只是不熟悉如何完成这个。有人可以指出我正确的方向、教程、宝石或其他吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:19:12.813

你可以从这个[railscast](http://railscasts.com/episodes/136-jquery)开始。支付 9.9 美元来获得专业订阅可能是值得的，因为有更多可用的截屏视频可以满足您的需求，例如[http://railscasts.com/episodes/136-jquery-ajax-revised](http://railscasts.com/episodes/136-jquery-ajax-revised)。如果我没记错的话，优秀的免费在线[Michael Hartl 教程以 jQuery/ajax 集成结束。](http://ruby.railstutorial.org/)

# java - 将 Java 字符串解析为 GMT 日期

> ID：13166683
> 
> 赞同：5
> 
> 时间：2012-10-31T20:08:21.610
> 
> 标签：java

我正在尝试使用 GMT 解析表示日期的字符串，但它会在我的 PC（太平洋）上的时区打印出来。当我运行以下命令时，我得到以下输出。关于如何让解析解析并返回 GMT 日期的任何想法？如果您看下面，我正在使用 format.setTimeZone(TimeZone.getTimeZone("GMT")); 但它没有产生预期的结果。

以下代码的输出：

**2012 年 10 月 29 日星期一 05:57:00 PDT**

```
 package javaapplication1;

    import java.text.ParseException;
    import java.text.SimpleDateFormat;
    import java.util.TimeZone;

    public class JavaApplication1 {

        public static void main(String[] args) throws ParseException {
            SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZ");
            format.setTimeZone(TimeZone.getTimeZone("GMT"));
            System.out.println(format.parse("2012-10-29T12:57:00-0000"));
        }
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T20:16:10.520

您正在使用`format.setTimeZone(TimeZone.getTimeZone("GMT"));`格式化程序，该格式化程序用于将字符串格式化为日期，即

```
 Date date = format.parse("2012-10-29T12:57:00-0000"); 
```

被解析处理`2012-10-29T12:57:00-0000`是一个`GMT`值，**但是您正在打印`date`，它在打印中使用本地时区，因此您注意到了差异。**

如果您想在 中打印日期`GMT`，请使用：

```
 String formattedDate = format.format(date); 
```

并打印`formattedDate`. **这将是`GMT`。**

```
 System.out.println(formattedDate); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:11:38.030

### 完整的工作示例

```
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Locale;
import java.util.TimeZone;

public class Main
{
    public static void main(String[] args)
    {
        final SimpleDateFormat sdf = new SimpleDateFormat("dd-MM-yyyy hh:mm:ss z", Locale.ENGLISH);
        sdf.setTimeZone(TimeZone.getTimeZone("UTC"));
        System.out.println(sdf.format(new Date())); 
        // ^^^ note printing the results of sdf.format() 
        //     not a raw `Date`
    }
} 
```

结果：`31-10-2012 08:32:01 UTC` **注意我实际打印的内容！**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:14:39.603

```
System.out.println(format.parse("2012-10-29T12:57:00-0000")); 
```

将日期解析为 GMT 并返回一个 Date 对象。然后将其打印出来（使用默认的 toString() 方法）。这仅使用您计算机的设置。所以你应该使用：

```
Date parsedDate=format.parse("2012-10-29T12:57:00-0000");
System.out.println(format.format(parsedDate)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-25T16:24:59.843

试试这个，

```
public static String converterGMTToLocal(String datahora_gmt)
{
    try {
        SimpleDateFormat fmt = new SimpleDateFormat("YYYY-MM-dd HH:mm");
        Calendar cal = Calendar.getInstance();
        cal.setTime(fmt.parse(datahora_gmt));
        cal.add(Calendar.HOUR, -3);

        return fmt.format(cal.getTime());

    } catch (ParseException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
        return e.getMessage();
    }
} 
```

更改项目的值...进行适当的更改

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-04T10:12:07.693

## java.time

我建议您使用现代 Java 日期和时间 API java.time 进行日期和时间工作。我更喜欢使用以下格式化程序进行解析。

```
private static final DateTimeFormatter PARSER = new DateTimeFormatterBuilder()
        .append(DateTimeFormatter.ISO_LOCAL_DATE_TIME)
        .appendPattern("xx")
        .toFormatter(Locale.ROOT); 
```

解析为 an`OffsetDateTime`以保留字符串 ( `-0000`) 的偏移量。

```
 String gmtString = "2012-10-29T12:57:00-0000";
    OffsetDateTime gmtDateTime = OffsetDateTime.parse(gmtString, PARSER);
    System.out.println(gmtDateTime); 
```

输出是：

> 2012-10-29T12:57Z

输出中的尾随`Z`表示 UTC 或与 UTC 的偏移量 0，出于我们的目的，我们可以将其视为等同于 GMT。如果我们愿意，我们还可以在打印之前使用相同（或不同）的格式化程序重新格式化：

```
 System.out.println(gmtDateTime.format(PARSER)); 
```

> 2012-10-29T12:57:00+0000

在这种情况下，您可能希望将格式化程序命名为`PARSER`.

## 偏移量 -0000 不合法

我想知道你从哪里得到那个字符串，因为它遵循标准 ISO 8601 格式，除了 ISO 8601 不允许`-0000`作为偏移量。偏移量零必须以、`Z`或`+00:00`给出。对我们来说幸运的是，Java 在这一点上是宽容的，并且接受为等价于.`+0000``+00``-0000``+0000`

## 链接

*   [Oracle 教程：日期时间](https://docs.oracle.com/javase/tutorial/datetime/)解释如何使用 java.time。
*   问题：[UTC 和 GMT 有什么区别？](https://stackoverflow.com/questions/48942916/what-is-the-difference-between-utc-and-gmt)
*   [维基百科文章：ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)

# qt - 使 QWidget 的一部分可拖动

> ID：13166686
> 
> 赞同：0
> 
> 时间：2012-10-31T20:08:40.213
> 
> 标签：qt, user-interface, drag-and-drop, draggable

我有一个 USB 设备可以

*   沿线性轴“移动”，
*   停在一个目标上，
*   报告其位置，
*   报告其目标，
*   由主机应用程序设置其目标。

现在我想创建一个可以用来指示位置和目标的小部件，但我还希望目标指示器可以用鼠标拖动。到目前为止，我完成的是指示部分，如下所示：

![在此处输入图像描述](../Images/f763e1bc13588f556ac3cd1f2564d5ec.png)

黑色实心三角形是位置；目标指示灯为绿色。

我想要的是能够拖动目标指示器。完成此操作时，设备的目标应使用当前目标指标的值进行更新。我是 gui 编程的新手（直到现在我只处理 USB 的东西；这是我的第一个自定义小部件），我不知道如何实现这一点。

将目标指示器作为小部件的一部分保留是个好主意，还是应该是某种子项？我很确定这种工作有一些共同的模式，但我不知道找到它们的正确关键字。谷歌搜索“QWidget drag”之类的东西只会让我找到拖放功能，这并不是我所需要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:18:47.873

我认为您不应该打扰子小部件。在您的主 QWidget 中，您只需要覆盖三个虚拟保护函数：

`QWidget::mousePressEvent`-- 这应该检查用户是否点击了目标指示器，如果是，则将 bool "clickedOnIndicator" 设置为 true（并接受鼠标事件）；否则设置bool为false，忽略鼠标事件，调用默认实现

`QWidget::mouseMoveEvent`-- 首先检查是否`clickedOnIndicator`为真；如果是，将指标移动到新位置并发出信号`YourWidget::indicatorMoved(int)`，否则调用默认实现

`QWidget::paintEvent`-- 在正确的位置绘制指示器（并执行您在绘制事件中所做的任何其他事情）

# uiscrollview - UIScroll View 在添加项目时不会滚动

> ID：13166693
> 
> 赞同：0
> 
> 时间：2012-10-31T20:09:13.683
> 
> 标签：uiscrollview, xcode4.3, xcode-storyboard

我有一个 UIScrollView，当我运行我的应用程序时，滚动视图工作正常。当我在滚动视图中添加两个按钮时，一个在底部，另一个在顶部，滚动的能力就消失了。我还没有对按钮调用任何操作。我只是想看看一个滚动视图在起作用

不知道为什么会这样。

这是我的代码。

。H

```
@interface ViewController : UIViewController {
IBOutlet UIScrollView *theScroller;
}

@end 
```

.m

```
@implementation ViewController

- (void)viewDidLoad
{
[theScroller setScrollEnabled:YES];
[theScroller setContentSize:CGSizeMake(320, 900)];
[super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T04:19:34.430

更改以下修改：

**。H**

```
 @interface ViewController : UIViewController
{

   IBOutlet UIScrollView *theScroller;

}

@property(nonatomic,retain)IBOutlet UIScrollView *theScroller; // Add this Line 
```

. **米**

```
**#import "ViewController.h"
@interface ViewController ()
@end
@implementation ViewController
@synthesize theScroller;  // Add this Line

- (void)viewDidLoad

{
    [super viewDidLoad];

    [theScroller setScrollEnabled:YES];
    [theScroller setContentSize:CGSizeMake(320, 900)];
    [super viewDidLoad];

} 
```

**在您的 XIB 中；**

1.  正确设置委托和链接

![在此处输入图像描述](../Images/2be99ba7cc56234b3ed8c386399cc6b2.png)

# java - 休眠 (HQL)

> ID：13166694
> 
> 赞同：1
> 
> 时间：2012-10-31T20:09:17.660
> 
> 标签：java, hibernate, netbeans, hql

我正在使用 NetBeans，当我编写 HQL 查询时，我看到了一些奇怪的结果，当我在 HQL 编辑器中进行查询时，像这样`from User`，它返回我所期望的，但如果我写：`select a.name from User a`，它什么也不返回，只是类型列 name 处的名称`query(Char Char Byte Byte)`，尽管它表示记录数。有人见过这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:13:02.910

当您使用 HQL as`select a.name from User a`时，它应该返回`String[]`假设`a.name`是 String 类型。请相应地更新结果检索/迭代并打印输出。它应该工作。

# cmake - CMake使用copy_if_different递归复制文件

> ID：13166695
> 
> 赞同：2
> 
> 时间：2012-10-31T20:09:23.507
> 
> 标签：cmake

我是 CMake 的新手。我已经编译了我的项目。我有这样的结构

项目

*   SRC

    1.  测试
        此文件夹的 .cpp（所有源文件）和 CMakeLists.txt（创建静态库）
    2.  此文件夹的示例
        .cpp（所有源文件）和 CMakeLists.txt（创建静态库）
*   包括

    1.  测试
        .h（所有头文件）
    2.  示例
        .h（所有头文件）
*   建造

    1.  CMakeLists.txt（主 CMakelist 文件）
*   库

    1.  测试（包含生成的文件）
    2.  示例（包含生成的文件）

问题是我如何复制所有静态文件，即。从测试和示例文件夹中递归地将它们放在二进制结构之外的不同文件夹中？

我的主要 CMakeLists.txt 文件：

```
PROJECT(copythefiles)

SET(CMAKE_CURRENT_BINARY_DIR ".")

add_subdirectory(/src/test /lib/test) # I am specifying the location where the files are to be generated
add_subdirectory(/src/example /lib/example)

ADD_CUSTOM_TARGET( a ALL COMMAND ${CMAKE_COMMAND} -E echo "\{X}" > ${CMAKE_CURRENT_BINARY_DIR}/lib/test/libtest.a )

ADD_CUSTOM_COMMAND(TARGET a POST_BUILD
    COMMAND ${CMAKE_COMMAND} -E copy_if_different
        ${CMAKE_CURRENT_BINARY_DIR}/lib/test/libtest.a
        ${CMAKE_CURRENT_BINARY_DIR}/lib/libtest.a ) 
```

这会复制文件。但我有大约 20 个项目，我想递归地做。

谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T21:42:52.850

将顶级 CMakeLists.txt 文件放在项目的根目录中是正常的。如果您将 CMakeLists.txt 从“/build”移到根目录，那么您应该能够调用`add_subdirectory`而无需为每种情况指定二进制路径。

`add_subdirectory`假设您移动了 CMakeLists 文件，那么您可以在调用之前插入它：

```
function(MoveLib TheTarget)
  add_custom_command(TARGET ${TheTarget} POST_BUILD
                     COMMAND ${CMAKE_COMMAND} -E
                         copy $<TARGET_FILE:${TheTarget}> ${CMAKE_SOURCE_DIR}/lib)
endfunction()

execute_process(COMMAND ${CMAKE_COMMAND} -E make_directory ${CMAKE_SOURCE_DIR}/lib) 
```

然后，这允许您`MoveLib(my_test)`在库的 CMakeLists.txt 文件中添加例如相关库`my_test`的名称。

然后所有库的副本将在“/lib”中结束。如果您不是真的想要副本，那么您应该看看该[`ARCHIVE_OUTPUT_DIRECTORY`](http://www.cmake.org/cmake/help/v2.8.9/cmake.html#prop_tgt%3aARCHIVE_OUTPUT_DIRECTORY)属性。如果您只是添加

```
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_SOURCE_DIR}/lib) 
```

那么你所有的静态库都将在“/lib”中结束。不过，这里有几件事需要注意。

共享库不在`ARCHIVE_OUTPUT_DIRECTORY`. 共享库的详细信息在文档中`ARCHIVE_OUTPUT_DIRECTORY`。

此外，一些生成器（例如 MSVC）将每个配置的子目录附加到指定目录，因此您最终会得到“/lib/Debug”、“/lib/Release”等。您可以通过设置配置来规避这种情况-to all 的特定版本`CMAKE_ARCHIVE_OUTPUT_DIRECTORY`指向`${CMAKE_SOURCE_DIR}/lib`：

```
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_DEBUG ${CMAKE_SOURCE_DIR}/lib)
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_RELEASE ${CMAKE_SOURCE_DIR}/lib) 
```

# date - 宇宙本机日期格式

> ID：13166696
> 
> 赞同：2
> 
> 时间：2012-10-31T20:09:29.097
> 
> 标签：date, timestamp, universe

我正在优化我们拥有的一些使用 UniObjects 的 UniVerse 数据访问代码。经过一些实验，似乎使用 UniSession.OConv 调用来解析某些东西，例如十进制数（大多数我们有 MR4 或 MR2 或 MR2$）和日期（几乎都是 D2/）非常慢（我认为它可能回调服务器以解析它）。

我已经为 MR*[$] 代码构建了一个解析器，但我想知道它们存储的日期，所以我可以为 D2/构建一个解析器。通常它们似乎存储为 5 位数字。我认为这可能是自我们的 UniVerse 服务器在 HP-UX 上运行以来的 Unix 纪元以来的天数，但是在找到“15766”作为最后修改日期并将其乘以 86400（每天的秒数）之后，我得到了 2013 年 3 月 2 日这作为最后修改日期没有意义，因为据我所知，这仍然是在未来。

有谁知道这些日期数字的时基是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T23:19:48.667

它存储为天数。只需在 0 上进行转换，您将获得开始日期。

**编辑：**

正如 Los 所指出的，UniVerse（和 UniData）中使用的 Epoch 是**31st Dec 1967**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-17T22:39:50.633

在 Universe 和任何其他 Pick 数据库中，日期和时间存储为单独的值。

内部日期是 1967 年 12 月 31 日之前和之后的天数，即第 0 天。

内部时间是午夜后的秒数。它可以存储为小数，但通常不是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-28T15:38:47.697

在 TCL 中有一个`CDT`命令（代表转换日期）将日期从人类可读转换为数字，反之亦然：

```
CDT 9/28/2017 
 * Result: 18169  

CDT 18169     
 * Result: 09/28/2017 
```

# data-structures - 将非重叠范围映射到值的数据结构？

> ID：13166697
> 
> 赞同：2
> 
> 时间：2012-10-31T20:09:39.410
> 
> 标签：data-structures, complexity-theory, binary-search-tree

我需要一个数据结构，它将非重叠范围（例如`8..15`，`16..19`）映射到指向结构的指针。

我需要能够查找该范围内的任何元素并检索该指针。例如：

```
structure[8..15] = 0x12345678;
structure[16..19] = 0xdeadbeef;

structure[7]; // => NULL
structure[12]; // => 0x12345678
structure[18]; // => 0xdeadbeef 
```

我目前正在考虑使用二叉搜索树。由于范围永远不会重叠，我可以在对数时间内相对轻松地搜索索引。

但是，我想知道是否有任何数据结构更适合这种情况。我需要能够有效地插入、删除和查找。在 BST 中，所有这些操作都是 O(log n)，但我想知道是否有任何更快的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T14:23:02.643

如果您想要比 O(log n) 更快的东西，请使用[Van Emde Boas tree](http://en.wikipedia.org/wiki/Van_Emde_Boas_tree)。

应该像使用二叉搜索树一样使用它：使用每个范围的开始作为键，范围的结束 - 作为值的一部分（与指针一起），映射到该键。时间复杂度是 O(log log M)，其中 M 是键的范围（INT_MAX，如果任何整数值都可以作为范围的开始）。

在某些情况下，Van Emde Boas 树的内存开销很大。如果这不可接受，请使用 Beni 解释的简单 trie 或[Y-fast trie](http://en.wikipedia.org/wiki/Y-fast_trie)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-01T00:26:35.743

我不认为你可以做得更好。

非重叠范围等同于一系列交替的起点/终点。所以查找只是“找到最大元素≤ x”，然后是 O(1) 检查它是开始还是结束。即有序地图。

通常的疑点——二叉树、B 树、各种尝试——本质上都是 O(log n)。在实践中最好的是调整问题，这取决于对范围的了解。它们是稀疏的还是密集的？它们的大小相似还是差异很大？数据有多大（适合缓存/内存/磁盘）？你插入/删除很多还是查找占主导地位？访问是随机的还是具有高局部性？

适用于许多方案的一种权衡是拆分范围，在多个位置复制相同的指针。这可能会以插入/删除和内存使用为代价来加快查找速度。一个极端的应用程序只是一个按点索引的平面数组，其中查找是 O(1)，但插入是 O(范围大小)；这需要一个多级结构：一个由 k 个统一子范围组成的数组，如果完全被一个范围覆盖，则指向值，否则指向子数组。嘿，我刚刚描述了一个尝试！查找是 log(maxint)/log(k)，如果 k 是 2 的幂（例如 256），则非常快；插入和内存是 k*log(n)。
但请记住，浪费内存会损害缓存性能，因此任何此类“优化”实际上可能会适得其反，即使对于查找也是如此。

# c# - 使用 asp.net 错误 26 从主机更新数据库

> ID：13166704
> 
> 赞同：0
> 
> 时间：2012-10-31T20:09:58.463
> 
> 标签：c#, asp.net, sql, sql-server, connection-string

所以基本上我有一个 POS 系统，它有自己的数据库，我的网站托管在一个共享的 1and1.com 托管公司服务器上，该服务器还包含一个需要数据库设计的数据库。我的目标是只上传那些活跃的产品。

我从 POS 数据库更新网站数据库的解决方案是在网站上有一个特殊的管理页面，输入 POS 数据库的连接字符串。admin.aspx.cs 调用一个存储过程，该过程从 POS 数据库中获取所有特定数据并将它们插入到网站数据库中。

在充当网站+数据库的同事机器上进行测试时，这一切都可以完美运行。但是在 1and1.com 主机上加载时，它会返回错误 26。

SqlException was unhandled 建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）

连接字符串如下 Server=IP_ADDRESS_OF_POS\SQLEXPRESS;Database=CentricDatabase;User ID=centric;Password=XXXXXXXXX

有谁知道为什么这在主机上不起作用？但在同事机器上工作？

谢谢

# scala - 如何使用 Scala + JUnit runner + Maven 运行测试组？

> ID：13166707
> 
> 赞同：1
> 
> 时间：2012-10-31T20:10:10.447
> 
> 标签：scala, maven, maven-surefire-plugin

我正在尝试支持在 Maven 命令行上运行标签/测试组。我认为我的 .scala 文件中有正确的语法设置（见下文），但我不确定如何在命令行上实际执行。Web 上的示例大多使用 Java。

我希望能够做一些事情，比如`mvn clean test -Dtags:SlowTest,DbTest`运行所有标记为“slow”和“db”的测试。

我已经看到了 Surefire pom.xml 示例，但我不确定如何在我的测试代码本身中标记 Surefire 组。

想法？

```
import org.junit.experimental.categories.Category
import org.scalatest.FunSuite
import org.junit.runner.RunWith
import org.scalatest.junit.JUnitRunner
import org.scalatest.Tag

class SlowTest extends Tag("com.mycompany.tags.SlowTest")
class DbTest extends Tag("com.mycompany.tags.DbTest")

@RunWith(classOf[JUnitRunner])
@Category(Array(classOf[SlowTest], classOf[DbTest]))
class FunSuiteTest extends FunSuite with DemoHelpers {
  test("DemoTest1") { 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:44:40.700

如果您使用的是，[`scalatest-maven-plugin`](http://www.scalatest.org/user_guide/using_the_scalatest_maven_plugin)您应该能够执行以下操作：

```
mvn -DtagsToInclude=SlowTest,DbTest clean test 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-02T08:23:18.797

我可能会建议，如果您想在 Scala 中进行一些测试，为什么不尝试使用

> 斯卡拉测试

它很好且易于使用。

# sql - 如何在 Hive/SQL 的 where/have 子句中使用 min()（以避免子查询）

> ID：13166708
> 
> 赞同：1
> 
> 时间：2012-10-31T20:10:14.687
> 
> 标签：sql, hive, hiveql

我有一个大的事件表。每个用户我想在最早的 B 类事件之前计算 A 类事件的发生。

我正在寻找一个优雅的查询。使用了 Hive，所以我不能做子查询

```
Timestamp Type User 
...        A    X
...        A    X
...        B    X
...        A    X
...        A    X

...        A    Y
...        A    Y
...        A    Y
...        B    Y
...        A    Y 
```

想要的结果：

```
User Count_Type_A 
X    2
Y    3 
```

我无法通过以下方式获得“截止”时间戳：

```
Select User, min(Timestamp) 
Where Type=B 
Group BY User; 
```

但是，我如何在下一个查询中使用该信息，我想在其中执行以下操作：

```
SELECT User, count(Timestamp) 
WHERE Type=A AND Timestamp<min(User.Timestamp_Type_B) 
GROUP BY User; 
```

到目前为止，我唯一的想法是首先确定截止时间戳，然后与所有 A 类事件进行连接，然后从结果表中进行选择，但这感觉不对，而且看起来很难看。

我还在考虑这可能是 Hive 的错误类型的问题/分析，我应该考虑手写 map-reduce 或 pig 来代替。

请指出正确的方向来帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:59:12.513

**第一次更新：**

针对 Cilvic 对此答案的第一条评论，我已根据[https://issues.apache.org/jira/browse/HIVE-556](https://issues.apache.org/jira/browse/HIVE-556)中的评论中建议的解决方法将查询调整为以下内容：

```
SELECT [User], COUNT([Timestamp]) AS [Before_First_B_Count]
FROM [Dataset] main
CROSS JOIN (SELECT [User], min([Timestamp]) [First_B_TS] FROM [Dataset]
    WHERE [Type] = 'B'
    GROUP BY [User]) sub 
WHERE main.[Type] = 'A'
AND (sub.[User] = main.[User]) 
AND (main.[Timestamp] < sub.[First_B_TS])
GROUP BY main.[User] 
```

**原来的：**

试一试：

```
SELECT [User], COUNT([Timestamp]) AS [Before_First_B_Count]
FROM [Dataset] main
JOIN (SELECT [User], min([Timestamp]) [First_B_TS] FROM [Dataset]
    WHERE [Type] = 'B'
    GROUP BY [User]) sub 
        ON (sub.[User] = main.[User]) AND (main.[Timestamp] < sub.[First_B_TS])
WHERE main.[Type] = 'A'
GROUP BY main.[User] 
```

我尽力遵循 hive 语法。如果您有任何问题，请告诉我。我想知道您为什么希望/需要避免子查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T15:01:09.053

一般来说，我+1 coge.soft 的解决方案。再次供大家参考：

```
SELECT [User], COUNT([Timestamp]) AS [Before_First_B_Count]
FROM [Dataset] main
JOIN (SELECT [User], min([Timestamp]) [First_B_TS] FROM [Dataset]
    WHERE [Type] = 'B'
    GROUP BY [User]) sub 
        ON (sub.[User] = main.[User]) AND (main.[Timestamp] < sub.[First_B_TS])
WHERE main.[Type] = 'A'
GROUP BY main.[User] 
```

但是，有几点需要注意：

1.  当没有 B 事件时会发生什么？假设您想要计算每个用户的所有 A 事件，在这种情况下，解决方案中指定的内部联接将不起作用，因为子表中没有该用户的条目。为此，您需要更改为左外连接。

2.  该解决方案还执行 2 次数据传递 - 一次填充子表，另一次将子表与主表连接。根据您对性能和效率的概念，您可以通过单次数据传递来完成此操作。您可以使用 Hive 的功能[分发按用户分发数据，并编写一个自定义减速器，使用](https://cwiki.apache.org/Hive/languagemanual-sortby.html#LanguageManualSortBy-SyntaxofClusterByandDistributeBy)[Hive 的转换功能](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Transform)以您喜欢的语言进行计数计算。

# svn - 颠覆控制matlab

> ID：13166712
> 
> 赞同：2
> 
> 时间：2012-10-31T20:10:37.157
> 
> 标签：svn, matlab

目前我正在开发一个与 matlab 集成的 Subversion 控制 (SVN) 项目。

我想从一个项目下的 URL 获取 svn 存储库中的文件夹列表，但对于不同的模块。

我试过这样：

```
 % to read all modules from excel 

data = xlsread(modules.xlsx)

for i= 1:length(data)

    module_name = cell2mat(data(i,1));
    sys = module_name;

    % to get list of folders under each module

    !svn list https://xxxx.collab.net/svn/repos/sys/branches/pro/

end 
```

我的问题是如何在 URL 中更改“sys”，以便我可以访问所有模块。目前它仅适用于一个模块（如果我替换'sys'= module1）

先感谢您

问候 bstar

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:44:34.957

而不是 URL 地址写：

```
['https://xxxx.collab.net/svn/repos/' module_name '/branches/pro/'] 
```

（module_name 需要是一个字符串才能工作）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T09:20:21.613

```
svnCmd = '!svn list https://xxxx.collab.net/svn/repos/sys/branches/pro/'; 
evalc(strrep(svnCmd, 'sys', sys)) ' 
```

# c - 试图编写一个整数比较方法但它不起作用

> ID：13166713
> 
> 赞同：0
> 
> 时间：2012-10-31T20:10:41.187
> 
> 标签：c, arrays, loops, int

我有一个整数数组，我试图找出哪一个是最高的，并将一个新的整数设置为最高的值。我对C很陌生，我真的刚开始学习它。

我正在做的事情可能存在某种逻辑问题，但我还没有发现它。所以...

```
int my_array[4];
int highest_int = 0;
int i;

for (i = 0; i < 4; i++) {
    if (my_array[i] > my_array[i++]) {
        if (my_array[i] > highest_int) {
            highest_int = my_array[i];
        }
    }
    else {
        if (my_array[i++] > highest_int) {
            highest_int = my_array[i++]
        }
    }
} 
```

所以我循环遍历我的数组 4 次（4 个元素），然后查看迭代值和下一个迭代值，如果迭代值最高，我检查它是否也高于当前“最高整数”的当前值，如果是我将当前最高整数设置为新的最高值。如果迭代值之后的值更高，我会做同样的事情，但用那个值代替。

这就是我写这篇文章时的想法，但是当我输入 4 个值时，它总是会出现数组中的第 3 个值。无论我将这些值设置为什么。

谁能告诉我为什么？

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T20:14:19.710

为什么你`i`在循环内递增？为什么需要 else 部分？

这是一个简单的方法：

```
int my_array[4];
int highest_int = my_array[0];
int i;

for (i = 1; i < 4; i++) {
        if (my_array[i] > highest_int) {
            highest_int = my_array[i];
        }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T20:15:15.627

你让这种方式变得比实际更复杂:) 此外，你写`i++`的地方太多了；每次`i++`执行时，您都会跳过一个数组条目，这可能不是您想要的。

此外，无需与之前的值进行比较。只需与您迄今为止看到的最高值进行比较即可。

这是一个固定版本，只是删除代码，没有任何改变或添加：

```
int my_array[4];
int highest_int = 0;
int i;

for (i = 0; i < 4; i++) {
    if (my_array[i] > highest_int) {
        highest_int = my_array[i];
    }
} 
```

请注意，如果数组中的所有数字都是负数，这会错误地报告 0。如果`highest_int = INT_MIN`您需要正确处理这些问题，或者使用`unsigned int`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T20:16:21.940

如果您试图找到最大的数字，这里是代码：

```
int my_array[4];
int highest_int = my_array[0]; 
//Before entering the loop, assuming the first number to  highest
int i;

for (i = 1; i < 4; i++) {
    if (my_array[i] > highest_int) {  //Compare every number with highest number
        highest_int = my_array[i];
    }  
}

//Now we have the highest number
printf("Highest Number: %d",highest_int); 
```

# c - Linux C：未使用的文件描述符会发生什么？

> ID：13166717
> 
> 赞同：1
> 
> 时间：2012-10-31T20:10:55.400
> 
> 标签：c, linux, file-descriptor

（很抱歉最近没有照顾我的接受 - 我一有时间就会这样做；只是想问这个问题，现在它发生了）

考虑以下 C 程序：

```
int main(void) {
  write(3, "aaaaaa\n", 7);
  write(2, "bbbbbb\n", 7);
  write(1, "cccccc\n", 7);
  return 0;
} 
```

`bash`我像这样从 shell构建并运行它：

```
$ gcc -o wtest wtest.c
$ ./wtest 3>/dev/stdout
aaaaaa
bbbbbb
cccccc 
```

我看到它的方式，在这种情况下，由于 fd 3 到的 shell 重定向`stdout`，该文件描述符现在被“使用”（不确定“打开”，因为没有打开文件，至少在 C 代码中) - 所以我们将`cccccc`字符串输出到终端，正如预期的那样。

如果我不使用重定向，那么输出是这样的：

```
$ ./wtest 
aaaaaa
bbbbbb 
```

现在 fd 3 没有被重定向 - 所以`cccccc`字符串也没有像预期的那样输出。

我的问题是 - 这些`cccccc`字节发生了什么？他们是否以同样的方式消失，就好像我将 fd 3 重定向到`/dev/null`？（如：

```
$ ./wtest 3>/dev/null 
```

)

此外，假设在特定情况下我想“隐藏” fd 3 输出：重定向“ `3>/dev/null`”与根本不处理 shell 中的 fd 3 之间是否存在性能差异（就流数据而言；也就是说，如果 fd 3 输出一个非常长的字节流，那么在 " " 情况下写入的每个字节是否会有指令惩罚`3>/dev/null`，而不是不寻址 fd 3)？

非常感谢您的任何答案，
干杯！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T20:16:34.677

> 我的问题是 - 那些 cccccc 字节发生了什么？

没有什么。您未能捕获 的返回码`write`，它应该告诉您有一个错误，并且`errno`应该告诉您错误是什么

您似乎对持久性的概念也有疑问，“字节”仍然位于编译器从一开始就放置它们的字符串文字中。`write`将字节复制到流中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:24:48.317

詹斯是对的。如果您在两种情况下都在 strace 下运行您的程序，您会看到当您重定向时，写入工作 - 因为 shell 在分叉您的可执行文件之前代表您调用 pipe()。

当您查看没有重定向的 strace 时：

```
write(3, "aaaaaa\n", 7)                 = -1 EBADF (Bad file descriptor)
write(2, "bbbbbb\n", 7bbbbbb)                 = 7
write(1, "cccccc\n", 7cccccc)                 = 7 
```

这让我们想起了最佳实践 - 始终检查您的返回值。

# ruby-on-rails - 我如何在路线中限制我的rails应用程序中特定MountableEngine的访问

> ID：13166718
> 
> 赞同：1
> 
> 时间：2012-10-31T20:10:57.527
> 
> 标签：ruby-on-rails, devise, authorization, cancan

我只想为具有管理员角色的用户授予对 /samurai （可安装引擎）的访问权限：

我怎样才能做到这一点？

我的路线

```
authenticate do
   mount Resque::Server.new, :at => "/resque"
   mount Samurai::Engine => "/samurai"

 scope "/admin" do
  resources :customers, :images,:categories, :groups,:redirects, :projects, :specs, :indices,:glossaries, :invoices, :users, :products

  resources :comments do
    member do
      post 'approve'
      post 'moderate'
      post 'disapprove'
    end
  end
end 
```

PS = 我正在使用 CanCan 和 Devise

* * *

更新

我真的是 Ruby 的新手，我已经通过这种方式解决了我的问题！

1) 在 config/initializers 创建一个文件；

2）在该文件中，我将该代码放在下面；

```
Samurai::ApplicationController.class_eval do
  before_filter :restrict_access

  private

  def restrict_access
    user = current_user
    head :unauthorized unless user.role_id == 1
  end

end 
```

那有多糟糕？

# java - Primefaces 中的视觉“忙碌”指示

> ID：13166721
> 
> 赞同：2
> 
> 时间：2012-10-31T20:11:04.140
> 
> 标签：java, jsf, jsf-2, primefaces

我有一个基于 Primefaces 的应用程序，其中有一些冗长的操作。

当执行这样的操作时，我想以某种方式表明这一点（比如显示一个沙漏或一条消息，它出现在屏幕的中心）。

在 Primefaces/JSF 中最简单的方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-31T21:43:29.667

我建议使用`<p:blockUI>`. 这是一个例子：

```
<h:form>
    <p:panel id="content" >
        ...
        <p:commandButton id="longOperation" value="Process" />
    </p:panel>
    <p:blockUI block="content" trigger="longOperation">  
        <p>Here you can customize what appears as the overlay over the blocked content.</p>
        <p:graphicImage value="/images/ajax-loader.gif"/>  
    </p:blockUI>
</h:form> 
```

查看[http://www.primefaces.org/showcase/ui/blockUI.jsf](http://www.primefaces.org/showcase/ui/blockUI.jsf)了解更多信息。

# php - PHP REST API 客户端验证

> ID：13166724
> 
> 赞同：2
> 
> 时间：2012-10-31T20:11:35.513
> 
> 标签：php, api, rest, authentication, verification

我正在努力在 PHP 上构建基于 API 的体系结构。

我想确保尝试使用不同 API 密钥使用我的 API 的客户端是授权客户端。例如，API 密钥“ABCD1234”分配给域“example.com”。如果域“fraud.com”尝试使用此 API 密钥，他们应该无法使用该 API。如何在 API 端实现此检查？

根据我到目前为止所看到的，客户很容易将引荐来源标头传递给“伪造”它的真实身份。

另外我还依稀记得 Google Maps 刚推出 API 时，他们实现了类似的技术，只有授权的 URL 才能使用相应的 API Key。所以这似乎不是不可能的。

任何帮助/方向将不胜感激。

谢谢，

-安全

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:36:05.593

在服务器到服务器的场景中，您对域几乎无能为力，因为不一定涉及任何域。它只是源自某个 IP 的传入 (HTTP) 请求。该 IP 不一定必须绑定到 DNS 系统中的任何主机条目。您能做的最好的事情就是要求您的客户注册允许的 IP 地址。由于各种原因，反向 DNS 解决方案不可行，尤其是因为它们需要客户端正确设置反向 DNS，这可能不切实际。

如果用例是浏览器端的，您可以使用 Google Maps 方法，在这种方法中，您需要客户端包含来自服务器的脚本，该脚本会检查当前页面在浏览器中的位置。尽管如此，即使这也不是完全的脾气证明，就像任何客户端一样。检查 HTTP Referer 服务器端也是一种选择，但也很容易被任何真正想要的人破坏。结合起来，它可以使它变得足够困难，因此大多数滥用者都会被吓倒。

# c# - 从 CodeBehind 访问 DataTemplate 中的 XAML 控件？

> ID：13166726
> 
> 赞同：2
> 
> 时间：2012-10-31T20:11:42.717
> 
> 标签：c#, wpf, wpf-controls, datatemplate

我有一个无法在代码隐藏中访问的控件，我相信这是因为它是在 DataTempalte 中定义的。

整体控制是幻灯片放映轮播。每张幻灯片都可以是 Image 或 MediaElement（视频），其内容在 ItemSource 绑定中定义。旋转木马上有一个计时器，可以从一张幻灯片切换到下一张幻灯片。每次幻灯片更改时，我都会触发一个事件来实现该效果。

当我用视频点击幻灯片时，我想停止幻灯片计时器（完成此操作）并开始播放视频，这是我遇到问题的地方。我无法从我的代码隐藏中访问该`MediaPlayer`元素。`Name`我在这一点上的假设是因为它是一个 DataTemplate。

这个假设正确吗？如果是这样，我如何从代码隐藏中访问此控件，或者（更重要的是）在幻灯片出现时开始播放？

```
<ctrl:AutoScrollCarousel ...>
    <ctrl:AutoScrollCarousel.ItemsPanel>
        <ItemsPanelTemplate>
            <StackPanel Orientation="Horizontal" />
        </ItemsPanelTemplate>
    </ctrl:AutoScrollCarousel.ItemsPanel>
    <ctrl:AutoScrollCarousel.ItemTemplate>
        <DataTemplate>
            <Border x:Name="Border" VerticalAlignment="Center"
                    Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType={x:Type UserControl},Mode=FindAncestor}}">
                <Grid Background="White">
                    ...
                    <Image Source="{Binding ContentImage}" Grid.Row="1" Grid.Column="1" Stretch="UniformToFill"
                            HorizontalAlignment="Center"
                            Visibility="{Binding ContentImage, Converter={StaticResource VisibilityConverter}}" />

                    <MediaElement Name="MediaPlayer" Source="{Binding ContentVideo}" Grid.Row="1" Grid.Column="1" Stretch="UniformToFill" LoadedBehavior="Play"
                                    Visibility="{Binding ContentVideo, Converter={StaticResource VisibilityConverter}}" MediaEnded="MediaPlayer_MediaEnded" />

                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Title}" Foreground="Black"
                                FontFamily="Segoe UI" FontWeight="Light" HorizontalAlignment="Left" FontSize="75" Margin="0" VerticalAlignment="Center" />

                    <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding ContentHeadline}" Foreground="Black"
                                FontFamily="Segoe UI" FontWeight="Light" HorizontalAlignment="Left" FontSize="50" VerticalAlignment="Center"
                                TextWrapping="Wrap">
                    </TextBlock>
                </Grid>
            </Border>
        </DataTemplate>
    </ctrl:AutoScrollCarousel.ItemTemplate>
</ctrl:AutoScrollCarousel> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T22:18:32.353

WPF 提供了一种简单直接的方法来访问从 DataTemplates 生成的命名元素。MSDN 文章[How to: Find DataTemplate-Generated Elements](http://msdn.microsoft.com/en-us/library/bb613579.aspx)对此进行了解释。

假设您的 AutoScrollCarousel 是从 ItemsControl 派生的，您将获得 ContentPresenter，它是这样一个项目的容器：

```
AutoScrollCarousel carousel = ...
object item = ...
var contentPresenter =
    carousel.ItemContainerGenerator.ContainerFromItem(item) as ContentPresenter; 
```

从 ContentPresenter 中，您将通过[FindName](http://msdn.microsoft.com/en-us/library/system.windows.frameworktemplate.findname.aspx)方法获得 DataTemplate 中的命名元素：

```
var dataTemplate = contentPresenter.ContentTemplate;
var mediaPlayer = dataTemplate.FindName("MediaPlayer", contentPresenter) as MediaElement; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T20:40:40.403

我通常建议不要从代码中触摸 UIElements ......但 MediaElement 是一个特例......也许你应该将整个模板包装在一个用户控件中（也许使用一些自定义的 DepProps），这将使你更好地控制整个事物。

编辑：另一种方法是创建具有几个属性（例如 IsPlaying）的行为并从那里操作媒体元素。然后，您可以在 DataTemplate 的 XAML 中使用此行为，而无需隐藏代码或用户控件。

# jsf - 丢失在复合组件中提交的输入

> ID：13166728
> 
> 赞同：1
> 
> 时间：2012-10-31T20:12:04.137
> 
> 标签：jsf, primefaces, submit, composite-component

我在提交复合组件时遇到问题。

我的大多数复合组件都包含输入组件和“提交”按钮。当我试图将按钮仍然放在同一个 h:form 但不在同一个复合组件中时，提交的值似乎在某个地方“丢失”了。而且，例如，我的验证器被调用原始值。

例子 ：

```
<composite:interface>
  <composite:attribute name="titreContext" required="true"/>
</composite:interface>
<composite:implementation>

    <p:outputPanel id="selectionTitreDetailsPanel" styleClass="selectionTitreDetails">
    <p:outputPanel id="selectionTitreDetailsPanelInner" rendered="#{not empty cc.attrs.titreContext.selected}">

    <p:panelGrid columns="2" id="panelId">
      <h:outputText id="idLabel" value="Id :"/>
      <h:outputText id="id" value="#{cc.attrs.titreContext.selected.titeluid}"/>
      <p:tooltip for="id" value="Identifiant unique"/>
    </p:panelGrid>

    <p:panelGrid columns="2" id="titelePanel">
        <p:outputLabel for="selectTitele" value="Titre :"/>
        <p:selectOneMenu id="selectTitele" value="#{cc.attrs.titreContext.selected.titele}" effect="fold" styleClass="fullWidth">
            <f:selectItems value="#{constants.getTitelesForTypman(cc.attrs.titreContext.selected.titele.typman)}" var="titele" itemLabel="#{titele.titelelil}" itemValue="#{titele}" styleClass="fullWidth"/>
                <p:column styleClass="fullWidth">#{titele.titelelil}</p:column>
        </p:selectOneMenu>      
    </p:panelGrid>

    [...]
    <p:commandButton id="confirmerModifications" icon="small_edit" type="submit" value="Confirmer les modifications" 
                    action="#{elutersEditionContext.confirmeModifsSelection}" process="mandatsTerritorial" 
                    update="mandatsTerritorial #{cc.attrs.notifUpdates}"/>

</composite:implementation> 
```

作品。

但是将 p:commandButton 从组合中取出：

```
<h:form>
<mylib:mycomponent /*parameters *//>
<p:commandButton /*parameters*/ />
</h:form> 
```

不起作用。当我调试我的验证器时，我可以看到修改后的值甚至没有提交。getLocalValue、getSubmittedValue 和 getValue 均未更改。

复合组件声明中是否有用于纠正这种情况的语法？顺便说一句：当我将组件编写为复合组件而不是自定义组件时，在支持 bean 中检索 #{asen} 就可以了。

提前致谢。

我在用 ：

*   PrimeFaces 3.4.1
*   CODI 1.0.5
*   OpenWebBeans 1.1.6
*   我的脸 2.1.9
*   雄猫 7.0.32

（更新）这个非常奇怪的问题是由 h:form 嵌套引起的。

很奇怪，因为 h:form 嵌套并没有扰乱第一级复合组件的处理，而是在嵌套复合中造成了这种奇怪的“输入丢失”。

嵌套看起来像这样：

```
<h:form>
...
    <p:tabView ...>
        <p:tab>
        <h:form>
            <my:composite ....>
        </h:form>
    </p:tabView>
</h:form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T02:00:39.650

您在 的`process`属性中使用了相对客户端 ID `<p:commandButton>`：

```
<p:commandButton ... process="mandatsTerritorial" /> 
```

相对客户端 ID 相对于父[`NamingContainer`](http://docs.oracle.com/javaee/6/api/javax/faces/component/NamingContainer.html)组件。它将作为组件的*直接*子项进行搜索`NamingContainer`。如果孩子本身是 a `NamingContainer`，则不会搜索其孩子。

复合组件本身实际上也是`NamingContainer`组件。*如果按钮被放置在组合中，那么*它将作为`<cc:implementation>`. 在您的特定情况下，只有带有的组件`id="mandatsTerritorial"`将在表单提交时被处理，包括它的所有子组件（请注意，该组件在到目前为止发布的代码中无处可见，但我想您为了简洁而省略了它）。

如果按钮放置在 中`<h:form>`，那么这将作为 的*直接*子项进行搜索`<h:form>`。然而，由于这显然被放置在复合材料中（如前所述，它是另一个`NamingContainer`组件），因此找不到它，因此基本上不会处理任何内容。您需要修复`process`指向正确的客户端 ID。例如

```
<h:form>
    <mylib:mycomponent id="mycomponent" />
    <p:commandButton ... process="@this mycomponent:mandatsTerritorial" />
</h:form> 
```

这样，它将处理自己（必须调用该操作！）以及在组合`id="mandatsTerritorial"`内部的组件 with 。`<cc:implementation>``id="mycomponent"`

作为一个完全不同的替代方案，在这个特定的结构中工作得很好，就是`process`完全删除该属性。它默认为`@form`已经处理*整个*表单。

* * *

**根据您的问题更新进行更新：嵌套表单在 HTML 中无效**。**使用 JSF`<h:form>`表示不会改变这一点。您仍然会在 HTML 中使用嵌套表单。浏览器行为未指定将哪些数据提交给服务器。确保您也没有嵌套`<h:form>`在 JSF 中。**

# web-services - SharePoint People.asmx Web 服务返回 -1

> ID：13166738
> 
> 赞同：1
> 
> 时间：2012-10-31T20:13:18.737
> 
> 标签：web-services, sharepoint

当我查询我的 Web 服务以查找用户时，如果该用户不属于该网站的 SharePoint 组，则 ID 为 -1。

但是，用户可以通过组权限访问该站点。因此，我的 Web 服务调用无法将用户添加到列表中的“人员”框中，即使 SharePoint 本身可以添加它。

我的 Web 服务调用如下：

```
String searchText = "[My User's Login Name, Spelled Exactly as it appears in SharePoint.]";
String maxresults = "100";
String pType = "All";

String body = "<?xml version=\"1.0\"?>"
            + "<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" " 
            + "    xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" "
            + "    xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">"
            + "<soap:Body>"
            + "    <SearchPrincipals " 
            + "      xmlns=\"http://schemas.microsoft.com/sharepoint/soap/\">"
            + "      <searchText>" + searchText + "</searchText>"
            + "      <maxResults>" + maxResults + "</maxResults>"
            + "      <principalType>" + pType + "</principalType>"
            + "    </SearchPrincipals>"
            + "  </soap:Body>"
            + "</soap:Envelope>"; 
```

我从 Web 服务调用中得到以下响应：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope 
  xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
  xmlns:xsd="http://www.w3.org/2001/XMLSchema">

  <soap:Body>
    <SearchPrincipalsResponse xmlns="http://schemas.microsoft.com/sharepoint/soap/">
      <SearchPrincipalsResult>
        <PrincipalInfo>
          <AccountName>[User's Account Name]</AccountName>
          <UserInfoID>-1</UserInfoID> <------------  NOTE THE -1 HERE -----------------
          <DisplayName>[User's full name, exactly as I sent it in]</DisplayName>
          <Email>...</Email>
          <Department>...</Department>
          <Title>...</Title>
          <IsResolved>true</IsResolved>
          <PrincipalType>User</PrincipalType>
        </PrincipalInfo>
      </SearchPrincipalsResult>
    </SearchPrincipalsResponse>
  </soap:Body>
</soap:Envelope> 
```

如果我使用此信息通过 Web 服务将用户添加到“人员”框，则条目变为“-1;#My User Name”，它当然找不到，因此 List.asmx Web 服务返回错误的`0x81020054 : The user does not exist or is not unique.`

当我直接将用户添加到站点内的组时，他们的 ID 解析得很好，一切正常。我将它们从组中删除，它再次返回到 -1。

关于始终返回有效 ID 的任何想法和/或建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T12:06:28.520

我可以看到您正在使用 SearchPrincipals 方法。而是尝试使用 ResolvePrincipals 方法。

此处的文档：http: [//msdn.microsoft.com/en-us/library/people.people.resolveprincipals (v=office.12).aspx](http://msdn.microsoft.com/en-us/library/people.people.resolveprincipals(v=office.12).aspx)

该方法有一个 bool 参数，您可以在其中指定如果用户不属于该站点，则应该添加它，这样即使用户不属于该站点，您也将始终确保始终获取 ID地点。

```
PeopleWebService.People pe = new PeopleWebService.People(); //People.asmx web service 
string[] users = new string[] { "youruser" };
PeopleWebService.PrincipalInfo[] pInfo = pe.ResolvePrincipals(users, PeopleWebService.SPPrincipalType.User, true); //third param is true
string userID = pInfo[0].UserInfoID.ToString(); 
```

# ios - UITableView 的单元格分隔符在滚动后消失

> ID：13166744
> 
> 赞同：2
> 
> 时间：2012-10-31T20:13:47.793
> 
> 标签：ios, uitableview

我有一个 UITableView 配置为“UITableViewStylePlain”，其分隔符样式为 UITableViewCellSeparatorStyleSingleLine。单元格具有背景颜色。

问题是，当您滚动 tableview 时，一旦某些单元格从屏幕上消失并被带回来，分隔符就不再可见。

这些单元格已注册：

```
[tableView registerNib:nib forCellReuseIdentifier:cellIdentifier]; 
```

单元格代码：

```
- (void)customizeMyTable
{
    [self.tableView setDataSource:self];
    [self.tableView setDelegate:self];
    self.tableView.separatorStyle = UITableViewCellSeparatorStyleSingleLine;

    NSString *cellIdentifier = [MyTableViewCell cellIdentifier];
    UINib *nib = [UINib nibWithNibName:cellIdentifier bundle:nil];

    [self.tableView registerNib:nib forCellReuseIdentifier:cellIdentifier];
    self.tableView.rowHeight = 50;
}

- (UITableViewCell *)tableView:(UITableView *)aTableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    MyTableViewCell *cell = (MyTableViewCell*)[tableView dequeueReusableCellWithIdentifier:cellID];

    [cell configure:someDataForThisRow];

    return cell;
}

- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{
    cell.backgroundColor = [UIColor lightGrayColor];
} 
```

有人遇到过这个问题吗？这似乎只发生在 iOS 5 上，而不是 iOS 6 Tableviews。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-15T21:54:59.953

如果您在自定义单元格中实现了**layoutSubviews**，并且您不小心忘记**调用相应的超级方法**，您将看不到分隔线。

也许您应该检查一下是否忘记在其他方法中调用 super 。

```
- (void)layoutSubviews
{
    [super layoutSubviews]; //<-THIS LINE YOU NEED

    //own code continues here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-12T02:11:23.680

我必须将分隔符插入设置为 0 才能解决问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-03T07:01:53.200

通过将分隔符插入值设置为 0，我的问题也得到了解决。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-08-10T22:33:48.653

如果您动态构建 UITableViewCell 的内容，请确保将子视图添加到 contentView 而不是自身：

`contentView.addSubview(subView)`

代替

`self.addSubview(subView)`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-27T07:10:07.920

我在 swif 中遇到了同样的问题。就我而言，我发现通过单击“按视图层次结构调试”按钮，滚动时新出现的单元格与其他单元格有一点重叠。这就是分隔线消失的原因。所以解决方案非常简单，在 cellForRowAtIndexPath clipsToBounds = true 中设置单元格返回，这样它就不会超出您分配的高度并与另一个单元格的分隔线重叠。

```
public func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
    let cellView = tableView.dequeueReusableCell(withIdentifier: cellReuseId, for: indexPath)
    cellView.clipsToBounds = true //Add this line
    return cellView
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-23T13:05:48.843

如果它对您来说很烦人，那么制作一个自定义单元格并将分隔符放入其中，并通过 For Obj.C 从单元格中删除默认分隔符： [self.tableView setSeparatorStyle:UITableViewCellSeparatorStyleNone];

否则，当您在真实设备上进行测试时，您应该没问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-12-28T05:05:13.210

它与LED屏幕分辨率有关，由于实际设备的分辨率非常高，显示器很难在屏幕上渲染那些微小的线条。它可以在实际设备上正常工作。有人告诉我不要在意它。所以如果问题只出在模拟器上，你就可以了。

# vb.net - 如何使这个 if 语句更优雅？

> ID：13166746
> 
> 赞同：1
> 
> 时间：2012-10-31T20:14:08.503
> 
> 标签：vb.net, if-statement, sqldatareader

如果`x`等于，`1`那么我们需要`SqlDataReader`from`GetDataReader1`方法。否则，我们需要`SqlDataReader`从`GetDataReader2`. 这是唯一的区别。除此之外，所有需要的代码（它说在这里做东西）都将被复制。我怎样才能使它更优雅，这样我就不必在两个 using 语句中重复所有逻辑？

**更新：**在简化这篇文章的代码时，我错过了一个额外的因素。GetDataReader1 采用 2 个参数，GetDataReader2 采用 3 个参数。如果我创建一个 GetDataReader 函数并将`If`语句移到那里，我是否会被迫传入 GetDataReader1 方法当前不需要的额外参数？

```
Dim value1, value2, value3 As String

If x = 1 Then
    Using myDataReader As SqlDataReader = GetDataReader1(value1, value2)
        myDataReader.Read()
        If myDataReader.HasRows Then
            'do stuff here
        End If
     End Using
 Else
     Using myDataReader As SqlDataReader = GetDataReader2(value1, value2, value3)
         myDataReader.Read()
         If myDataReader.HasRows Then
             'do stuff here
         End If
     End Using
 End If 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T20:16:27.977

传入`x`to`GetDataReader`并让它**决定**返回什么。

```
Using myDataReader As SqlDataReader = GetDataReader(x)
    myDataReader.Read()
    If myDataReader.HasRows Then
        'do stuff here
    End If
End Using 
```

这会将您推`If`到`GetDataReader`不应该有太多重复的地方。

* * *

更新 - 关于问题的更新。

您仍然可以使用相同的机制 - 将决定推送给方法 - 您只需传入所有可能需要的参数，除了`x`：

```
Using myDataReader As SqlDataReader = GetDataReader(x, value1, value2, value3) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:20:21.940

将用于确定要使用哪个 SqlDataReader 的逻辑移到它自己的函数中并传递它`x`。

```
 Using myDataReader As SqlDataReader = GetDataReader(x)
         myDataReader.Read()
         If myDataReader.HasRows Then
             'do stuff here
         End If
     End Using

 Private Function GetDataReader(ByVal x As Integer) As SqlDataReader
     If x = 1 Then
        Return GetDataReader1()
     Else
        Return GetDataReader2()
     End If
 End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:47:06.023

您不需要在 Using 语句中创建读取器。之前创建它们

```
Dim value1, value2, value3 As String
Dim myDataReader As SqlDataReader

If x = 1 Then
    myDataReader = GetDataReader1(value1, value2)
Else
    myDataReader = GetDataReader2(value1, value2, value3)
End If
Using myDataReader
    If myDataReader.Read() Then
        'do stuff here
    End If
End Using 
```

# iphone - 故事板是否迫使您编写丑陋的代码？

> ID：13166747
> 
> 赞同：9
> 
> 时间：2012-10-31T20:14:11.350
> 
> 标签：iphone, ios, storyboard, segue

我一直在用 xib 文件开发一切，因为我们需要支持 iOS4。

现在我们终于只支持 iOS5 和 iOS6 了，所以我决定试试 storyboards，所以一切都很好，很简单，但我发现自己做了很多这样的代码：

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

    if ([segue.identifier isEqualToString:@"AddPlayer"]) { //Ugly

        UINavigationController * navigationController = segue.destinationViewController;
        PlayerDetailViewController * playerDetailsViewController = [navigationController viewControllers][0]; //Super Ugly
        playerDetailsViewController.delegate = self;
    }
} 
```

我不了解你们，但我发现这段代码非常丑陋且容易出错。

有没有更好的使用 Storyboard 的方法？我应该回到 xib 文件吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T20:38:38.860

在我工作的最后一个应用程序中，我经常使用 Storyboards，是的，我同意样板代码在一段时间后变得非常烦人，但据我所知，使用`prepareForSegue`是使用 segue 时传递参数的唯一方法。 **您不能从 Storyboard 本身为自定义视图控制器分配属性/委托。**

*   如果我只针对 iOS 5 和 6，我会重新使用 XIB 吗？**这取决于**.

如果我必须构建一个中小型应用程序（没有太多的视图并且它们之间没有太多的交叉导航），我肯定会使用 Storyboards。但是当你有很多视图和它们之间的很多来回导航时，保持故事板的整洁就变得很复杂，感觉就像你在强迫自己使用实际上不是最好的东西。

另一方面，我觉得 Storyboard 让从头开始时更容易了解应用程序的流程和总体外观，您甚至可以使用它们来创建看起来像真实事物的模型。

因此，从本质上讲，它归结为您在启动项目时的需求。

**编辑：**

另一件需要考虑的事情：如果您使用 SVN/Git 或任何其他 VCS 与团队合作，Storyboard 文件冲突是个彻头彻尾的**婊子**。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-01T19:53:01.157

我同意这是一个丑陋的代码，为了使我的视野更加顺畅，我创建了一个宏：

```
#define WhenSegueIdentifierDo(segueIdentifier, block) if([segue.identifier isEqualToString:segueIdentifier]) block(); 
```

在我的**prepareForSegue**中：

```
WhenSegueIdentifierDo(kModalVC1ToVC2, ^
{
    //code
});

WhenSegueIdentifierDo(kModalVC1ToVC3, ^
{
    //code
}); 
```

我还使用常量而不是硬编码的字符串（尽管我不能在情节提要上使用它们）来保持它更漂亮。我还使用了一个约定：**k** +**转换类型**+**原始视图控制器名称**+**到**+**目标视图控制器名称**。

你也可以使用

```
navigationController.topViewController 
```

代替

```
[navigationController viewControllers][0]; 
```

只是我的2美分...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T20:33:27.657

这就是野兽的本性。使用 Cocoa 约定的 Objective-C 产生 - （希望）自我记录，尽管是冗长的代码。看看你的例子，我确定你的意图没有问题。

现在，如果你想让它更漂亮，你可以将所有这些封装到一个宏中，这样它就会被压缩成一行。虽然看起来可能更漂亮，但它肯定会在维护野兽时增加不必要的复杂性。最终用户不会关心代码有多漂亮——除非它阻止添加新功能。

至于讨论故事板……它们肯定是不同的，但现在已经使用了六个月，我很欣赏将我所有的笔尖放在一个集中的地方，而不是花时间寻找单个文件。对我来说，通过视觉布局查找东西要容易得多，然后解析驼峰式文件名。这就是我。

我的建议，给他们时间。几个月后，如果您发现它们阻碍了您的工作流程，那么一定要回到单个笔尖。他们哪儿也不去。至少有一段时间。

只是我的两分钱。祝你好运！

# c# - 使用给定的 hDC 在图像顶部添加空格

> ID：13166752
> 
> 赞同：0
> 
> 时间：2012-10-31T20:14:39.927
> 
> 标签：c#, image, image-processing, gdi+, kofax

**布局：**

我正在使用第三方控件来扫描文档。我在扫描图像时发生了一个事件（主要用于为图像添加注释）。该事件只为我提供了一个名为**.PAhDC**的属性。此属性是在将图像写入文件之前存储图像的 DC 的句柄。因此，我可以在将图像写入文件之前对其进行更改。

**预期结果：**

我想简单地在图像的最顶部添加一条 1/4 英寸（比如说 100 像素）的空白线。如果我的原始图像是 200x200 (WxH)，那么我的新最终图像需要是 200x300。

**问题和其他想法：**

我如何只知道它的 DC 句柄来更改现有图像？我正在考虑做类似以下的事情......

1.  创建一个新的 DC。
2.  创建一个比原始图像高 100 像素的新位图。
3.  在新 DC 中使用该新位图。
4.  将原始图像复制到新位图（距离顶部 100 像素作为起点）。
5.  然后使用 SelectObject 之类的东西将原始 hDC 中的旧位图替换为新的位图，然后销毁旧的位图对象。

注意：我想尽可能使用 MANAGED CODE 来做到这一点。使用 SelectObject() 是我能想到的唯一方法，但它当然是非托管代码......：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:05:47.780

当然，您可以在托管代码中执行此操作。所有 P/Invoke 声明都可以从任何体面的搜索引擎中轻松获得。

*   创建新 DC 时，请确保它是与原始 DC 兼容的 DC
*   创建新位图时，请确保它与 DC 兼容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T15:11:50.303

您不能不与位图所有者和 DC 合作。

DeviceContext 纯粹是底层 DIB/位图的视口，没有大小或尺寸的概念（超出剪辑区域） 虽然您可以创建新位图并将其选择到 DC 中，但应用程序很可能会忽略您已经完成并使用了它创建的 DIB。这样做的最终结果将是 GDI 对象泄漏并且底层图像没有变化。

要按照您的要求进行操作，您将需要与其他代码充分合作，并添加一个允许您替换基础数据的方法。

# python - 递归函数python，无法打印输出

> ID：13166754
> 
> 赞同：0
> 
> 时间：2012-10-31T20:14:47.363
> 
> 标签：python, printing, recursion

我刚开始用 python 编程，我遇到了一个关于递归的问题。

该程序似乎可以编译，但是没有显示打印输出。

这是程序：

```
print 'type s word'
s = raw_input()
print 'enter a number'
n = raw_input()

def print_n(s, n):

 if n<=0:
  return 
 print s
 print_n(s, n-1) 
```

我得到的输出是：

```
xxxx@xxxx-Satellite-L600:~/Desktop$ python 5exp3.py
type s string
hello
add the number of recursions
4
xxxx@xxxx-Satellite-L600:~/Desktop$ 
```

出了什么问题，我怎样才能让程序显示输出？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T20:23:22.887

您发布的代码定义了该函数`print_n`，但从不调用它。在函数定义之后放置一个`print_n(s, n)`.

执行此操作后，您会发现由于`n`当前是字符串（`raw_input`返回字符串）这一事实而导致的一些错误。用于`int(a_string)`将字符串转换为整数。像这样调用你的函数将解决问题

```
print_n(s, int(n)) 
```

或者做

```
n = int(raw_input()) 
```

完整代码：

```
s = raw_input('type a word: ')
n = int(raw_input('enter a number: '))

def print_n(s, n):
    if n <= 0:
        return 
    print s
    print_n(s, n-1)

print_n(s, n) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T20:17:11.320

尝试`n = raw_input()`->`n = int(raw_input())`

# c - 无论如何要检查 str 函数的成功吗？

> ID：13166760
> 
> 赞同：3
> 
> 时间：2012-10-31T20:15:24.370
> 
> 标签：c, string, strcpy, strcat

我正在查看有关[strcpy()](http://www.cplusplus.com/reference/clibrary/cstring/strcpy/)和[strcat()](http://www.cplusplus.com/reference/clibrary/cstring/strcat/)的手册。似乎没有办法评估函数调用的“成功”。（即返回值永远不会是`NULL`），对吗？

只是假设如果您遵循这些函数的输入规则，那么输出将是有效的？只是想确保我没有遗漏任何东西……</p>

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T20:17:36.017

这些函数不能以任何明确定义的方式失败。它们要么成功，要么出现严重错误（例如缺少 0 个字符或输出缓冲区太小），并且任何事情都可能发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:18:49.893

因为我不认为这样的功能真的有办法知道什么是“成功”。例如，strcpy 实际上只是 memcpy。所以就 C 而言，它只是从一个内存位置获取数据并将其复制到另一个内存位置。它不知道数据应该是什么样子，或者以您期望的方式格式化。我想你知道是否成功的唯一真正方法是你是否最终得到一个段错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T20:18:59.847

只要您没有调用未定义的行为，这些函数就可以保证工作。特别是，需要分配您正在写入的内存。除了让你的程序崩溃之外，他们真的没有办法失败。

通常，因为很难判断将写入多少字节，所以不鼓励使用这些函数。如果可以，请使用[strncpy](https://en.cppreference.com/w/c/string/byte/strncpy)和[strncat 。](https://en.cppreference.com/w/c/string/byte/strncat)

# ruby-on-rails-3 - Rails - 与 API 的关联

> ID：13166761
> 
> 赞同：1
> 
> 时间：2012-10-31T20:15:26.257
> 
> 标签：ruby-on-rails-3, associations

我正在使用 Rails 中的 API 并碰壁。我错过了一些我想象的愚蠢的东西，但我看不到它。

[https://gist.github.com/3989396](https://gist.github.com/3989396)

我无法获取 item.json 中传递的关联来创建关联。我认为 Rails 会连接这些。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:48:31.007

帐户的关系需要像这样固定：

项目.rb：

```
belongs_to :expense_account, class_name: "Account"
belongs_to :income_account, class_name: "Account" 
```

帐户.rb：

```
has_many :items, inverse_of: :expense_account
has_many :items, inverse_of: :income_account 
```

# java - 将所有用户的私人主题更改为 Liferay 中的 Social Office

> ID：13166763
> 
> 赞同：1
> 
> 时间：2012-10-31T20:15:38.863
> 
> 标签：java, liferay, liferay-6, liferay-theme

我已经设法使用 LDAP 从 Active Directory 导入了大约 600 个用户，并且我正在尝试将每个用户的默认私人主题设置为 Social Office 主题。有没有办法选择每个用户并为他们分配社交办公室用户角色？这是执行此操作的正确方法还是我需要删除所有用户并重新导入它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T07:24:18.283

在导入时，您可以使用`void com.liferay.portal.service.LayoutLocalServiceUtil.importLayouts(long userId, long groupId, boolean privateLayout, Map<String, String[]> parameterMap, File file);`更新每个用户的 privateLayout，或者如果您想更新 publicPage 布局，则传递参数 privateLayout=false 以供参考：检查 com.liferay.portal.service.LayoutLocalServiceUtil()

# c - 在 C 中声明私有结构

> ID：13166769
> 
> 赞同：3
> 
> 时间：2012-10-31T20:15:48.553
> 
> 标签：c, struct, private

是否可以声明仅在使用该结构的 .c 文件中可见的结构类型？我知道通过将**静态**放在外部数据对象前面，您可以将变量的链接更改为内部。但是是否可以将**static**放在新**结构**类型的声明之前，如下所示？

```
static struct log{
            ...;
            ...;
};
typedef struct log log; 
```

如果无法将结构类型（例如上面的**log**）设置为“私有”，是否意味着即使其他源文件不知道该结构的名称（在我的示例中为**log** ）的存在，如果他们命名一些变量**日志**（假设我将链接所有目标文件），仍然可能发生意外的名称冲突？

**编辑**：我不熟悉编译器/链接器的工作方式。如果有一个全局变量名**log**，并且包含全局变量的文件链接到定义结构**log**的唯一源文件，那么链接时不会引起任何混淆，一个**日志**是变量名，而另一个**日志**是类型名称吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-31T20:20:27.127

不可以。唯一的方法`struct`是只在使用它的文件中提供它的定义——不要把它放在一个通用的头文件中。如果它只在一个源文件中使用，那么只需在该源文件中定义它，但如果它在多个源文件中使用，你有一个棘手的问题：你可以在每个源文件中定义它，但这很脆弱，因为你有当您进行任何更改时，请记住更改它的每个实例；或者，您可以在私有头文件中定义它，并确保只有那些源文件包含私有头文件。

不同源文件中的名称冲突是可以的，只要它们不尝试以任何方式相互交互。如果您在一个文件中有一个`struct log`定义，而在另一个文件中有不同的定义`struct log`，则永远不要将一个传递`log`给另一个。在 C 中，结构名称不会成为目标文件中任何符号名称的一部分——特别是，没有函数名称的名称修饰以包含参数类型（就像 C++ 那样），因为函数重载在 C 中是非法的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T20:22:53.087

No.`static`是一种存储类型；将其应用于变量声明之外的类型是没有意义的。

如果您不想`struct log`在头文件中定义，则不必。只需将 typedef 编写为：

```
typedef struct log log; 
```

就足够了，只要你只处理`log *`指针。但是，您将需要结构的完整定义来声明 a `log`（或 take `sizeof(log)`），因为结构的大小取决于它包含的内容。

关于名称冲突，请记住结构和类型**不是**由链接器管理的。链接器只关心全局可见的符号，例如函数和变量。话虽如此，您可能应该为您的类型名称应用前缀（例如，`mylib_log_t`）以避免混淆，特别是因为`log`它是标准库中的数学函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:28:41.203

你有理由写这个：

```
static int a; 
```

因为它阻止**链接器**将它与`a`其他地方定义的结合起来。**链接器**
与s无关，因此不用担心放入不同的c文件。 只要它在不同的c文件中，就不会有名称混淆。**`struct`** 

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-27T18:08:26.050

这一般是不可能的。但我可以想到一个可能适用于某些编译器的 hack。

这很难做到的原因是因为 C 编译器需要知道结构是什么样的，以便生成对以结构实例作为参数的函数的调用。

因此，假设您定义了一个具有以下标头的库：

```
struct foo {
    int32_t a, b;
};

foo make_foo(int arg);

foo do_something(foo p1, foo p2); 
```

然后编译一个调用 的程序`do_something`，你的编译器通常需要知道 foo 的结构是什么样的，以便它可以将它作为参数传递。编译器可以在这里做各种奇怪的事情，比如通过寄存器传递结构的一部分，通过堆栈传递一部分，所以它*真的*需要知道结构是什么样的。

但是，我相信在某些编译器中，可以指示结构应该完全通过堆栈传递。例如，`regparm(0)`如果您将 i386 作为目标架构 ( [docs](https://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html) )，则 function 属性应该适用于 GCC。

在这种情况下，应该可以执行以下操作：创建头文件的“公共版本”，然后在该文件中，而不是布置完整的结构，而是创建它的未*分化*版本：

```
struct foo {
    uint8_t contents[SIZE_OF_STRUCT_FOO];
} 
```

当您以通常的方式定义结构时，返回的`SIZE_OF_STRUCT_FOO`内容在哪里。`sizeof(struct foo)`然后，您基本上是在说“foo”是一个带有`SIZE_OF_STRUCT_FOO`字节的结构。然后，只要调用约定以相同的方式处理这两个结构，它就应该可以工作。**

# android - 平板电脑上看不到菜单

> ID：13166771
> 
> 赞同：0
> 
> 时间：2012-10-31T20:15:51.390
> 
> 标签：android

在浏览互联网数小时后，我仍然无法在我的应用程序上显示菜单。我有一个 viewflipper，里面有几个滚动视图，它们也有几个布局。整个应用程序运行良好，我可以毫无问题地从滚动视图滑动到滚动视图。

在我连接三星 Galaxy Tab 玩之前，我在模拟器中运行该应用程序。如果我按下菜单按钮，就会显示子菜单，并且我可以在菜单项触摸时运行功能。

在平板电脑上，菜单没有显示在任何地方。

这是我的菜单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

    <item
        android:id="@+id/KPNsites"
        android:icon="@drawable/ic_menu_name"
        android:title="KPN Sites"/>
    <item
        android:id="@+id/VDFsites"
        android:icon="@drawable/ic_menu_name"
        android:title="Vodafone sites"/>

</menu> 
```

在我的活动中，我有以下代码：

```
@Override
    public boolean onCreateOptionsMenu(Menu my_menu) {

        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.menu, my_menu);
        return super.onCreateOptionsMenu(my_menu);
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {

        switch (item.getItemId()) {

        case R.id.KPNsites:

            getKPNsiteInfo();
            return true;

        case R.id.VDFsites:

            getVodafoneSiteInfo();
            return true;

        default:
            return super.onOptionsItemSelected(item);
        }
    } 
```

当我在平板电脑上运行应用程序时，顶部只有一个小栏，里面只有 te app-name。我怀疑菜单应该在那个栏上可见？

我还应该做什么/做了什么（不同的）？

rg，埃里克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T20:19:36.900

如果您的平板电脑运行的是 Android 3.0 或更高版本，您应该在清单文件中将 targetSdkVersion 更改为 <= 10。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:24:22.207

您可能需要考虑使用[ActionBarSherlock](http://actionbarsherlock.com/)，这将使您的应用在任何 Android 版本上都具有统一和现代的外观。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T20:27:27.490

试试这个例子：

[菜单示例](http://vimaltuts.com/android-tutorial-for-beginners/android-action-bar-tab-menu-example)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T21:45:34.223

好吧，暂时放弃了。每次尝试都会弄乱我已经得到的东西。

为了解决问题，我在布局上放置了按钮。

可能与下一个项目一起工作。（但在我完成所有布局之前从它开始）

谢谢您的帮助！

rg，埃里克

# sql-server - 如何控制 localhost 指向哪个 SQL Server 实例

> ID：13166772
> 
> 赞同：19
> 
> 时间：2012-10-31T20:15:53.700
> 
> 标签：sql-server, configuration

我的 PC 上有 2 个 SQL Server 实例，一个是 SQL Server 2008 R2，另一个是 SQL Server 2012。

如果我`LOCALHOST`在连接到 SQL Server 时使用，它会转到 SQL Server 2008 R2 实例。

我希望它指向 SQL Server 2012 实例。

有谁知道我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-11T23:18:03.180

使用别名非常简单： 1\. 转到 SQL Server 配置。2\. 点击 Aliases 并设置 localhost => localhost\name 你的实例 3\. 在 64 位别名下做同样的事情

如果您有多个实例 localhost 可能会感到困惑，因此请转到协议为您命名实例并将 IP 地址更改为 127.0.0.1，即 localhost

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:23:22.117

您应该指定 sql server 实例名称，例如，如果实例名称是 sql2012

```
localhost\sql2012 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-31T21:58:55.877

you will need to uninstall / reinstall in order to do this. I wish it was easier to modify an instance.

# asp.net - ASP.NET 自定义 asp:label 视图状态

> ID：13166773
> 
> 赞同：0
> 
> 时间：2012-10-31T20:15:55.067
> 
> 标签：asp.net, custom-controls, viewstate

我为一个项目创建了一个新类。下面是一个非常简化的版本。

```
public class CustomLabel : Label
{
    public string ItemId { get; set; }

    protected override void Render(HtmlTextWriter writer)
    {
        if (!Page.IsPostBack)
            LoadText();
        base.Render(writer);
    }

    protected void LoadText()
    {
        this.Text = "This is a test";
    }
} 
```

我遇到的问题是 Text 属性不会在回发中持续存在。即使我通过 ascx 页面上的标记手动启用视图状态。自定义标签标签可以没有视图状态吗？我不想在不必要的每个页面加载上加载文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:40:57.207

将`LoadText();`方法调用移动到 OnPreRender 方法

# javascript - 是否有用于控制多个第三方视频服务的 Javascript 包装库，例如。YouTube、Vimeo 等

> ID：13166779
> 
> 赞同：-2
> 
> 时间：2012-10-31T20:16:20.447
> 
> 标签：javascript, youtube, wrapper, vimeo

过去，我使用 YouTube 和 Vimeo Javascript API 来控制视频。一个例子是当用户离开幻灯片时暂停在幻灯片中播放的视频。

如果用户在滑块中仅限于一种类型的视频，那么结合该服务 API 来控制视频也不错。但是，当 YouTube 和 Vimeo 甚至其他都被允许时，轮流使用每个 API 来控制各自的视频很快就会变得笨拙。

是否有一个 Javascript 包装库可以抽象每个服务 API 的细节以创建一个通用接口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:42:30.253

AFAIK 没有库来抽象玩家的细节。有诸如 OSM (http://mediafront.org/osmplayer/) 之类的项目将提供自己的播放器，这些播放器链接到各种类型的媒体（youtube、vimeo 等）。

# c++ - 如何将二进制字符串转换为整数字符串

> ID：13166785
> 
> 赞同：2
> 
> 时间：2012-10-31T20:16:28.530
> 
> 标签：c++, c

> **可能重复：**
> [将 1 和 0 的字符串转换为二进制值](https://stackoverflow.com/questions/117844/converting-string-of-1s-and-0s-into-binary-value)

假设我有一个包含 1024 个字符（代表 0 和 1）的字符串。我想将它表示为以十进制为基数的数字（也作为字符串）。棘手的部分是我必须在没有第三部分库的情况下在 C/C++ 中完成。有什么线索吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T20:35:06.260

可能有更有效的方法，但我有一个十进制数字数组，并在其上实现一个“左移”函数，该函数从最低有效数字开始，将它们加倍并延续到下一个数字。

然后，只需一次读取一位二进制数据并“左移”十进制数组并根据需要在二进制数字中“或”运算。

只需遍历十进制数字即可打印出答案。

```
void outputAsDecimal(char *binary)
{
   char digits[1000]; // arbitrary size for now

   for (int i=0; i< 1000; ++i)
     digits[i] = 0;

   while (*binary != 0)
   {

   // shift the digits, with carry
     int carry = 0;

     for (int i = 0; i< 1000; ++i)
     {
       int d = digits[i] *2 + carry;
       carry = d > 9;
       digits[i] = d % 10;
     }

   // or in the new bit
     if (*binary++ == '1') 
       digits[0] |= 1;
   }

    // output with leading zeroes!
    for (int i = 999; i >=0; --i)
    {
      putchar(digits[i] + '0'); // convert to ascii
    }
} 
```

看到它在这里运行：http: [//ideone.com/CibAfw](http://ideone.com/CibAfw)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:46:02.193

编辑：啊哈！我刚刚注意到 1024 的要求。这使它变得更加复杂，但想法保持不变。您需要 int number[32] （或 long number[16]，你有什么），而不是只有一个 int number。

边界的数学很烦人，但并非不可能。如果您无法弄清楚，请告诉我。

这对我有用。大于 (int) 中提供的分解和支持值作为练习留给读者...

```
#include <stdio.h> // only to print - not needed in computation
int main(int argc, char *argv[]) {
  printf("Converting: %s\n", argv[1]);
  int number = 0x0;
  char * binaryString = argv[1];
  int index = 0;
  int asciiZero = '0';
  char curr = binaryString[index];
  while(curr != '\0') {
    number = (number << 1) | (curr - asciiZero);
    index++;
    curr = binaryString[index];
  }

  printf("As number: %d\n", number);

  int MAX_DIGITS = 10; //adjust accordingly...
  char buffer[MAX_DIGITS];
  index = 0;
  while(number > 0) {
    buffer[index] = ((char) number % 10) + asciiZero;
    index++;
    number = number / 10;
  }
  buffer[index] = '\0';

  printf("As string: %s\n", buffer);
 } 
```

如果您想支持的不仅仅是提供给您的原语，您可以创建一个包含多个 ints/longs/etc 的结构。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-31T20:34:50.287

您不能将 1024 位数字表示为十进制。您可以获得的最接近的是浮点近似值。

编辑：

一个念头产生。将数字放在堆栈中并以这种方式计数。不过，仍然必须弄清楚如何将它们加在一起。如果你想这样做，你将不得不实现你自己的 BigInt 库，据我所知，没有一种“微不足道”的方式。

这样的事情是一个很好的起点：

[http://gmplib.org/](http://gmplib.org/)

# reporting-services - Excel的SSRS报告格式

> ID：13166803
> 
> 赞同：2
> 
> 时间：2012-10-31T20:17:47.460
> 
> 标签：reporting-services

我正在编写一份 SSRS 报告，我的客户希望报告标题包含报告所依据的标准（实际上，这是报告变量，例如日期）。

我尝试使用文本框来执行此操作，但似乎无法将文本框定位为在导出到 excel 时不会出现疯狂的单元格合并。

我还尝试使用报告正文中的表格来执行此操作，但将变量添加到报告的每一行。

我没有看到 position 属性，就好像我只是在一个 web 表单中工作一样，但是不知道该怎么做。有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:53:50.370

不幸的是，当导出到 Excel 时，单元格合并已成为现实，这就是报表渲染引擎试图保持与原始报表设计保持一致的方式。减少这种情况的最佳方法是确保报表元素的边缘尽可能相互对齐，以便渲染器可以对齐报表而无需合并单元格。

您在报表标题中放置文本框以显示所选报表参数的值是一种常用的好方法，因此请继续尝试布局以使其正确对齐。

如果您可以更详细地描述导出报告时发生的情况，我可能会提供更多建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-15T14:07:41.507

在我的报告中，我在报告末尾添加了一个额外的表格，并在 tablix 之前分配了一个分页符。在大型单单元格表中，我使用带引号的文本、内置字段和参数值编写句子，以列出所有参数信息。我将 Tablix 的名称标记为“参数”，因此当下载报告时，所有参数数据都以一种很好的、​​非侵入性的格式随之而来。当故障排除报告时，这已被证明非常有价值。

这是一个例子：

=Globals!ReportName + " 由 " + User!UserID + " on " + FormatDateTime(Globals!ExecutionTime, DateFormat.ShortDate) + "运行。" + vbcrlf + "参数：" + "程序 ("+Parameters!BusinessEntityID.Label+ "), 可交付状态代码 (" + Join(Parameters!DeliverableStatusCode.Label, ", ") + "), 科学区 (" + Parameters!ScienceAreaID.Label + "), 推力区 (" + Parameters!ThrustAreaID.Label + "), Center (" + Parameters!CenterID.Label + ") " + IIF(Parameters!TaskActiveFrom.Value is Nothing, "", ", Tasks Active between "+ FormatDateTime(Parameters!TaskActiveFrom.Label, DateFormat.ShortDate) + " and " + FormatDateTime(Parameters!TaskActiveTo.Label, DateFormat.ShortDate)) +IIF(Parameters!TaskStartFrom.值为 Nothing，“”，“，在“+ FormatDateTime(Parameters!TaskStartFrom.Label, DateFormat.ShortDate) +” 和“+ FormatDateTime(Parameters!TaskStartTo.Label, Dateformat.ShortDate)) + IIF(Parameters!DeliverablePlannedFrom .Value is NOTHING, "", ", Deliverable Due Date between " + FormatDateTime(Parameters!DeliverablePlannedFrom.Label, Dateformat.ShortDate) + " and " + FormatDateTime(Parameters!DeliverablePlannedTo.Label, Dateformat.ShortDate)) + IIF(Parameters !DeliverableExtendedFrom.Value is Nothing, "", ", Deliverable Revised Due Date between " + FormatDateTime(Parameters!DeliverableExtendedFrom.Label, Dateformat.ShortDate) + " 和 " + FormatDateTime(Parameters!DeliverableExtendedTo.Label, Dateformat.ShortDate)) + IIF（参数！PublicationReceivedDateFrom.Value 为 NOTHING，""，"，在 " + FormatDateTime(Parameters!PublicationReceivedDateFrom.Label, Dateformat.ShortDate) + " 和 " + FormatDateTime(Parameters!PublicationReceivedDateFrom.Label, Dateformat.ShortDate)) 之间的出版物接收日期

# c++ - 包含字符串时的错误（在 C++ 中）

> ID：13166805
> 
> 赞同：1
> 
> 时间：2012-10-31T20:18:04.937
> 
> 标签：c++, include, compiler-errors

当我添加字符串库 ( `#include <string>`) 时，编译时出现大约 100 个错误。Windows.h 已经包含在内，所以我不知道问题出在哪里。

任何帮助，将不胜感激。

下面列出了错误。

```
Error   105 error C1003: error count exceeds 100; stopping compilation  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cstdio   39  1   STablUpd
Error   99  error C2054: expected '(' to follow 'using' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cstdio   36  1   STablUpd
Error   101 error C2054: expected '(' to follow 'using' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cstdio   38  1   STablUpd
Error   5   error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    28  1   STablUpd
Error   8   error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    29  1   STablUpd
Error   12  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    30  1   STablUpd
Error   16  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    31  1   STablUpd
Error   20  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    32  1   STablUpd
Error   24  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    33  1   STablUpd
Error   28  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    34  1   STablUpd
Error   32  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    35  1   STablUpd
Error   35  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    37  1   STablUpd
Error   38  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    38  1   STablUpd
Error   42  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    39  1   STablUpd
Error   46  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    40  1   STablUpd
Error   50  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    41  1   STablUpd
Error   54  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    42  1   STablUpd
Error   58  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    43  1   STablUpd
Error   62  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    44  1   STablUpd
Error   65  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    46  1   STablUpd
Error   67  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    48  1   STablUpd
Error   70  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    49  1   STablUpd
Error   74  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    50  1   STablUpd
Error   78  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    51  1   STablUpd
Error   82  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    52  1   STablUpd
Error   86  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    53  1   STablUpd
Error   90  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    54  1   STablUpd
Error   94  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    55  1   STablUpd
Error   97  error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    57  1   STablUpd
Error   103 error C2059: syntax error : ';' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cstdio   39  1   STablUpd
Error   64  error C2061: syntax error : identifier 'abs'    C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    46  1   STablUpd
Error   66  error C2061: syntax error : identifier 'acos'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    48  1   STablUpd
Error   4   error C2061: syntax error : identifier 'acosf'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    28  1   STablUpd
Error   34  error C2061: syntax error : identifier 'acosl'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    37  1   STablUpd
Error   68  error C2061: syntax error : identifier 'asin'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    48  1   STablUpd
Error   6   error C2061: syntax error : identifier 'asinf'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    28  1   STablUpd
Error   36  error C2061: syntax error : identifier 'asinl'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    37  1   STablUpd
Error   69  error C2061: syntax error : identifier 'atan'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    49  1   STablUpd
Error   71  error C2061: syntax error : identifier 'atan2'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    49  1   STablUpd
Error   9   error C2061: syntax error : identifier 'atan2f' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    29  1   STablUpd
Error   39  error C2061: syntax error : identifier 'atan2l' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    38  1   STablUpd
Error   7   error C2061: syntax error : identifier 'atanf'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    29  1   STablUpd
Error   37  error C2061: syntax error : identifier 'atanl'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    38  1   STablUpd
Error   72  error C2061: syntax error : identifier 'ceil'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    49  1   STablUpd
Error   10  error C2061: syntax error : identifier 'ceilf'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    29  1   STablUpd
Error   40  error C2061: syntax error : identifier 'ceill'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    38  1   STablUpd
Error   102 error C2061: syntax error : identifier 'clearerr'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cstdio   39  1   STablUpd
Error   73  error C2061: syntax error : identifier 'cos'    C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    50  1   STablUpd
Error   11  error C2061: syntax error : identifier 'cosf'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    30  1   STablUpd
Error   75  error C2061: syntax error : identifier 'cosh'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    50  1   STablUpd
Error   13  error C2061: syntax error : identifier 'coshf'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    30  1   STablUpd
Error   43  error C2061: syntax error : identifier 'coshl'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    39  1   STablUpd
Error   41  error C2061: syntax error : identifier 'cosl'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    39  1   STablUpd
Error   76  error C2061: syntax error : identifier 'exp'    C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    50  1   STablUpd
Error   14  error C2061: syntax error : identifier 'expf'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    30  1   STablUpd
Error   44  error C2061: syntax error : identifier 'expl'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    39  1   STablUpd
Error   77  error C2061: syntax error : identifier 'fabs'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    51  1   STablUpd
Error   15  error C2061: syntax error : identifier 'fabsf'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    31  1   STablUpd
Error   45  error C2061: syntax error : identifier 'fabsl'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    40  1   STablUpd
Error   104 error C2061: syntax error : identifier 'fclose' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cstdio   39  1   STablUpd
Error   79  error C2061: syntax error : identifier 'floor'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    51  1   STablUpd
Error   17  error C2061: syntax error : identifier 'floorf' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    31  1   STablUpd
Error   47  error C2061: syntax error : identifier 'floorl' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    40  1   STablUpd
Error   80  error C2061: syntax error : identifier 'fmod'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    51  1   STablUpd
Error   18  error C2061: syntax error : identifier 'fmodf'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    31  1   STablUpd
Error   48  error C2061: syntax error : identifier 'fmodl'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    40  1   STablUpd
Error   81  error C2061: syntax error : identifier 'frexp'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    52  1   STablUpd
Error   19  error C2061: syntax error : identifier 'frexpf' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    32  1   STablUpd
Error   49  error C2061: syntax error : identifier 'frexpl' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    41  1   STablUpd
Error   96  error C2061: syntax error : identifier 'hypot'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    57  1   STablUpd
Error   98  error C2061: syntax error : identifier 'hypotf' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    57  1   STablUpd
Error   83  error C2061: syntax error : identifier 'ldexp'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    52  1   STablUpd
Error   21  error C2061: syntax error : identifier 'ldexpf' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    32  1   STablUpd
Error   51  error C2061: syntax error : identifier 'ldexpl' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    41  1   STablUpd
Error   84  error C2061: syntax error : identifier 'log'    C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    52  1   STablUpd
Error   85  error C2061: syntax error : identifier 'log10'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    53  1   STablUpd
Error   23  error C2061: syntax error : identifier 'log10f' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    33  1   STablUpd
Error   53  error C2061: syntax error : identifier 'log10l' C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    42  1   STablUpd
Error   22  error C2061: syntax error : identifier 'logf'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    32  1   STablUpd
Error   52  error C2061: syntax error : identifier 'logl'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    41  1   STablUpd
Error   87  error C2061: syntax error : identifier 'modf'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    53  1   STablUpd
Error   25  error C2061: syntax error : identifier 'modff'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    33  1   STablUpd
Error   55  error C2061: syntax error : identifier 'modfl'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    42  1   STablUpd
Error   88  error C2061: syntax error : identifier 'pow'    C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    53  1   STablUpd
Error   26  error C2061: syntax error : identifier 'powf'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    33  1   STablUpd
Error   56  error C2061: syntax error : identifier 'powl'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    42  1   STablUpd
Error   89  error C2061: syntax error : identifier 'sin'    C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    54  1   STablUpd
Error   27  error C2061: syntax error : identifier 'sinf'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    34  1   STablUpd
Error   91  error C2061: syntax error : identifier 'sinh'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    54  1   STablUpd
Error   29  error C2061: syntax error : identifier 'sinhf'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    34  1   STablUpd
Error   59  error C2061: syntax error : identifier 'sinhl'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    43  1   STablUpd
Error   57  error C2061: syntax error : identifier 'sinl'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    43  1   STablUpd
Error   92  error C2061: syntax error : identifier 'sqrt'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    54  1   STablUpd
Error   30  error C2061: syntax error : identifier 'sqrtf'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    34  1   STablUpd
Error   60  error C2061: syntax error : identifier 'sqrtl'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    43  1   STablUpd
Error   93  error C2061: syntax error : identifier 'tan'    C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    55  1   STablUpd
Error   31  error C2061: syntax error : identifier 'tanf'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    35  1   STablUpd
Error   95  error C2061: syntax error : identifier 'tanh'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    55  1   STablUpd
Error   33  error C2061: syntax error : identifier 'tanhf'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    35  1   STablUpd
Error   63  error C2061: syntax error : identifier 'tanhl'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    44  1   STablUpd
Error   61  error C2061: syntax error : identifier 'tanl'   C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cmath    44  1   STablUpd
Error   100 error C2061: syntax error : identifier 'using'  C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\cstdio   38  1   STablUpd 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-11-07T14:21:28.170

对于仍在寻找此内容的任何人：

“解决方案是右键单击每个 C 代码和 Properties>C/C++>Advanced>Compile As 并检查 Compile as C++ Code(/TP)”

来源：[堆栈溢出](https://stackoverflow.com/questions/9514475/compiling-error-in-c-project-with-c-and-c-codes):)

# .htaccess - Htaccess url重写无法正常工作

> ID：13166807
> 
> 赞同：1
> 
> 时间：2012-10-31T20:18:14.217
> 
> 标签：.htaccess, url, redirect

我有 url 重写的问题，这是我到目前为止的问题：

```
 Options +FollowSymlinks
        RewriteEngine on
        RewriteRule \.(gif|png|jpg|css|js)$|^index\.php$ - [L]
        RewriteRule ^users/(.+)$ /profile.php?userid=$1 [NC]
        RewriteRule ^(.+)/(.+)$ /main.php?region=$1&place=$2 [NC] 
```

基本上，如果 url 是 mysite.com/users/username，我希望它使用 profile.php，然后其他任何事情，去 main.php。

但是，使用该代码并没有按预期发生，它始终使用 main.php。无论如何，您是否可以在 htaccess 中使用 if 和 elses 或类似的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:13:32.940

您缺少`L`第二条和第三条规则中的标志。有这样的代码：

```
RewriteRule \.(gif|png|jpg|css|js)$|^index\.php$ - [L]
RewriteRule ^users/(.+)$ /profile.php?userid=$1 [NC,L,QSA]
RewriteRule ^(.+)/(.+)$ /main.php?region=$1&place=$2 [NC,L,QSA] 
```

# c# - 如何调用角色提供者的自定义方法？

> ID：13166813
> 
> 赞同：3
> 
> 时间：2012-10-31T20:18:43.840
> 
> 标签：c#, roleprovider

好的，我已经创建了自定义角色提供程序并将其添加到 web.config。这是我的角色提供者代码的一部分：

```
public class MyCustomRoleProvider : RoleProvider
{
    public override bool IsUserInRole(string username, string roleName)
    {
        return true;
    }

    public string MyCustomFunction()
    {
        return "its my custom string";
    }
} 
```

当我需要在我的应用程序中使用角色提供者时，我会这样称呼它：

```
var truth = Roles.IsUserInRole("myUsername", "myFakeRole"); 
```

好的，太好了！它调用我的自定义代码（我可以从调试中看出）并且每次都返回 true。为什么我不能对我的自定义角色提供程序进行以下调用？

```
var no_compile = Roles.MyCustomFunction(); 
```

如何使我的自定义角色提供程序的所有公共成员都可以访问？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:27:05.693

I do not really know what is the problem, but you should be able to do

```
var no_compile = _Roles.MyCustomFunction(); 
```

If `_Roles` defines a new `MyCustomRoleProvider` since the function is public

**Example**

```
MyCustomRoleProvider _Roles = new MyCustomRoleProvider();
var no_compile = _Roles.MyCustomFunction(); 
```

**Notice that**: You can not call `MyCustomRoleProvider.MyCustomFunction()` directly because it is not a `public static string`.

**Notice that**: `System.Web.Security.Roles` is a class which contains the same function name of your class `IsUserInRole(string username, string roleName)` but the function is not the same in both classes. So, you can not access `Roles.MyCustomFunction()` because the class `System.Web.Security.Roles` does not contain a definition for `MyCustomFunction()` and that's because you did not define a new function in the class

*   `MyCustomRoleProvider` and `System.Web.Security.Roles` are TWO different classes which have different functions

![System.Web.Security.Roles contains a definition for IsUserInRole(string username, string roleName) (+1 overload)](../Images/02db48d550e5e145ce058e85149b3aa0.png)

**Notice that**: You can not modify or add functions to `System.Web.Security.Roles` as it is write-protected

![System.Web.Security.Roles is write protected](../Images/478096d04205ab78a5266a90b07e71eb.png)

Thanks,
I hope you find this helpful :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:23:08.503

原因是这`Roles.IsUserInRole`是一个*静态方法*，它有一个实现来选择当前`RoleProvider`并执行它的`IsUserInRole` *实例*方法。内部使用的类型不是`MyCustomRoleProvider`类型，而是`RoleProvider`. 这实际上是这个问题：

```
public class BaseClass
{
    public virtual void Foo() { }
}

public class DerivedClass
{
    public virtual void Foo() { }

    public void MoreFoo() { }
}

BaseClass instance = new DerivedClass();
instance.MoreFoo(); // Doesn't compile 
```

该类，即使它是派生版本，由于它被用作基类型，不知道您在自定义提供程序中的实现。

为了使其可访问，您可以创建自己的静态实现，在内部可以执行您希望它执行的所有调用：

```
public static class Roles
{
    protected static Lazy<MyCustomProvider> _provider = new Lazy<MyCustomProvider>(() => System.Web.Security.Roles.Provider);

    public static MyCustomProvider Provider { get { return _provider.Value; } }

    public static IsUserInRole(string userName, string roleName)
    {
        return _provider.Value.IsUserInRole(userName, roleName);
    }

    public static MyCustomFunction()
    {
        return _provider.Value.MyCustomFunction();
    }
} 
```

# jsf - Primefaces：数据表应用补丁

> ID：13166818
> 
> 赞同：0
> 
> 时间：2012-10-31T20:18:58.820
> 
> 标签：jsf, jsf-2, datatable, primefaces

如何将补丁应用到我的 PrimeFaces 数据表。这是我要应用的补丁：[http ://code.google.com/p/primefaces/issues/detail?id=3608](http://code.google.com/p/primefaces/issues/detail?id=3608)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:52:03.833

您可以在此处找到 PF 来源：[http](http://code.google.com/p/primefaces/source/checkout) ://code.google.com/p/primefaces/source/checkout 。查看源代码并应用您的补丁文件（使用[patch](http://linux.die.net/man/1/patch)。如果您不熟悉补丁，您可能会发现此快速指南很有用：[The Ten Minute Guide to diff and patch](http://jungels.net/articles/diff-patch-ten-minutes.html)）。最后在您的项目中构建并包含生成的 jar。

# database - DELETE 语句与 REFERENCE 约束“FK_EntityAEntityB”冲突

> ID：13166823
> 
> 赞同：1
> 
> 时间：2012-10-31T20:19:06.940
> 
> 标签：database, entity-framework, database-design

我看到了有关该主题的答案，但与我的不完全一样。

我在设计器中使用 EF1 创建了一个数据库模式。我在 2 个表（**EntityA**和**EntityB**）之间添加了关系**一或零到多。**接下来，我将一条记录添加到表 EntityA 中，并将一条记录添加到 EntityB 中，该记录具有 EntityA 记录的 id。正如我在设计模式（在 MS SMS 中）看到的字段 EntityA_id（在表 EntityB 中）设置为 ALLOW NULL，我试图删除表 EntityA 中的记录。

 ****我预计该记录将被删除，并且表 EntityB 中的字段 EntityA_id 将自动设置为 NULL。不幸的是，我遇到了异常：**DELETE 语句与 REFERENCE 约束“FK_EntityAEntityB”冲突**

如果将具有外键的字段设置为 ALLOW NULL，为什么会抛出异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T05:19:12.533

> 如果将具有外键的字段设置为 ALLOW NULL，为什么会抛出异常？

引发异常的原因是您尝试执行的操作会影响**整个 row**，而不仅仅是可为空的列。将子表中的列设置为允许`null`规定该列允许没有值。除非 RDBMS 明确规定，否则可为空的列与引用完整性约束（如外键）无关；这意味着无论设置了任何特定于列的规则，外键规则仍然会生效。外键规则规定，如果父行在子表中有子行，则不能删除它。这样做将呈现所有子记录孤儿。我们现在不想让任何人成为孤儿吧？

外键向您保证的是，不会在子表中的外键列中插入/删除任何值，而不引用父表的键列中的有效值，如下所示相反，不能删除任何父行（除非`ON DELETE`子句已指定），如果相关表中有任何子行。

[MSSQL（我假设您正在使用）中空外键列](http://msdn.microsoft.com/en-us/library/aa933117%28v=SQL.80%29.aspx)的规则规定外键列允许包含空值。这就是你可能需要做的事情才能实现这一目标。将列值设置为`NULL`，然后尝试删除。

[与此无关，您可能对此](http://support.microsoft.com/kb/241717)感兴趣****

# php - 查找用户喜欢/关注的 Facebook 和 Twitter 的状态

> ID：13166831
> 
> 赞同：2
> 
> 时间：2012-10-31T20:19:42.950
> 
> 标签：php, facebook, twitter

对于我们网站上的比赛，我希望人们喜欢我们在 Facebook 上的页面或在 Twitter 上关注我们。有没有办法让我从我的网站检查所述互动的状态？

# jquery - jgestures 两次触发

> ID：13166832
> 
> 赞同：0
> 
> 时间：2012-10-31T20:19:45.427
> 
> 标签：jquery, touch, jgestures

我正在为我的 wordpress 主题中的灯箱使用 jgestures

在触摸设备上，我想用滑动手势导航到下一个或上一个图像

当我使用 swipeleftdown 作为事件时，该函数被调用两次，当我使用 3 个事件时，就像在我的示例中一样，该函数被调用六次

我希望该函数只被调用一次

```
jQuery('#lightboxcontainer').bind('swipeleftdown swipeleftup swipeleft', function(){
    if(jQuery(".arrowNext").attr("href")){
        showNextImage();
    }
}); 
```

# apache-flex - flex mobile：如何使用 skinClass 和 softKeyboardType？

> ID：13166836
> 
> 赞同：0
> 
> 时间：2012-10-31T20:20:09.923
> 
> 标签：apache-flex, flex4.5, flex4.6, flex-mobile

我的 flex 4.6 移动应用程序使用自定义的 skinClass。问题是当使用不同于默认的 skinClass 时，softKeyboardType 似乎不再起作用。

知道如何将两者结合起来吗？

```
<s:TextInput id="login_txt" skinClass="skins.TextInputSkin" softKeyboardType="email"/> 
```

（其中 skins.TextIputSKin 是我自己的皮肤：我需要保留它）

似乎这个问题非常相似：[Flex Mobile textInput in scroller text lag](https://stackoverflow.com/questions/9335337/flex-mobile-textinput-in-scroller-text-lag)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:07:24.337

没有看到你的代码；不可能给你完整的指导。

[但是，如果您使用的是StageText](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/text/StageText.html)，则只能设置 softKeyboardType 。根据文档，这是在 AIR 3 中引入的。默认的[Flex 4.5 TextInput 外观](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/skins/mobile/TextInputSkin.html)不使用 StageText；但默认的[Flex 4.6 TextInput 皮肤](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/skins/mobile/StageTextInputSkin.html)可以。

我不知道您的自定义皮肤使用什么。如果您从头开始构建皮肤类，则必须重新编写它以使用 StageText。如果您正在扩展或修改 Flex 4.5 皮肤；那么你必须重新设计它才能使用 StageText。如果您正在扩展或修改 Flex 4.6 皮肤；那么 softKeyboardType 应该可以工作。

# c - 在 C 中实现 AES 时的奇怪行为（将 char 转换为 bin）

> ID：13166837
> 
> 赞同：0
> 
> 时间：2012-10-31T20:20:17.320
> 
> 标签：c, aes

我在 C 中实现高级加密标准 (AES)。在 subBytes() 步骤中，我在从 char 转换为二进制时遇到了一些问题。

使用代码：

```
void subBytes(unsigned char* state) {
    int i=0;
    for(; i<=127; i++) {

        printf("%d",getBitState(state, i));

        if(i%32==0){printf("\n");}
        else if(i%8==0) {printf(",");}
    }
    printf("\n");
}

int getBitState(unsigned char* state, int i) {

    int bytePosition = i/8;
    int bitPosition = i%8;
    unsigned char byteValue = state[bytePosition];

    return  (byteValue >> (8-bitPosition)) & 1;
} 
```

如果状态矩阵是：

```
50,   67,   246,   168,   
136,   90,   48,   141,   
49,   49,   152,   162,   
224,   55,   7,   52, 
```

输出是：

```
00110010,01000010,11110110,10101000

10001000,01011010,00110000,10001100

00110000,00110000,10011000,10100010

11100000,00110110,00000110,0011010 
```

因此，如您所见，一些值可以很好地从 char 转换为 binary，但其他值则没有。例如，值 67 转换为 01000010 (66)。我看到的唯一模式是奇数转换为偶数二进制数。

谁能发现我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:24:43.603

8-bitPosition 永远不能为零，但您需要它才能获得最低位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:31:59.163

您的 getBitState 函数可以简化为以下内容：

```
int getBitState(unsigned char* state, int i)
{
    return !!((0x80 >> (i & 7)) & state[i >> 3]);
} 
```

双键将任何非零值转换为 1。

或者，由于这是密码学并且速度是一个问题，请使用宏：

```
#define GETBITSTATE(state, i) (!!((0x80 >> (i & 7)) & state[i >> 3])) 
```

[这是一个ideone。](http://ideone.com/N0g4Z6)

# javascript - 在ajax函数中使用变量

> ID：13166840
> 
> 赞同：0
> 
> 时间：2012-10-31T20:20:29.363
> 
> 标签：javascript, ajax

我只想使用函数外部的变量，但我不确定我必须为此做什么......

行是否`var myRequest = a;`足以在函数中使用此变量？

因为我看到了这样一个例子：`var myRequest = e.which;`

我问这个是因为我的请求没有得到成功的结果。

我认为它没有像我预期的那样工作，因为`ajaxFunction(3)`工作与写入`send.php?goto=3`浏览器的地址栏不同。

您可以看到以下代码：

```
function ajaxFunction(a)
{
    var ajaxRequest;
    try {
        ajaxRequest = new XMLHttpRequest();
    } catch (e) {
        try {
            ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
        } catch (e) {
            try {
                ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
            } catch (e) {
                alert("Your browser broke!");
                return false;
            }
        }
    }
    ajaxRequest.open("GET", "send.php?goto=" + a, true);
    ajaxRequest.send(); 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:42:34.633

如果要在函数外部使用变量，则必须使用全局范围变量，例如（使用 jQuery ajax）

```
var globalA = null;

$(document).ready(function(){
    var localA1 = null;
    $.ajax({
       "url":"http://someurl.com/",
       "type":"POST",
       "dataType":"json",
       "success":function(incomingData){
           var localA2 = incomingData //localA2 only useable inside this function
           localA1 = incomingData; //localA1 being set here still can only be used here as code within the "ready" function has already been executed and will see it as null
           globalA = incomingData; //Now any further code should use globalA as it now contains useable data
           doSomethingWithData();
       },
       "error":function(xhr,msg) {
           alert("Ajax Error:"+msg);
       }
    });
    alert(localA1); //Will give alertbox with null in it as localA1 has not been set.
});

function doSometingWithData() {
    alert(globalA); //You can now use the data in whatever function makes reference to globalA
} 
```

当然，在这个例子中，您可以直接将数据传递到`doSomethingWithData()`那里并在那里进行处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:15:12.037

您可以查看`$.globalEval`用于在 AJAX 成功函数中全局实例化变量的 jQuery。

```
$.ajax({
  url: "send.php",
  success: function (data) {
    $.getScript("somescript.js", function(data) {
      $.globalEval("var something = new Whatever;");
    });
}); 
```

如果您发现需要在 ajax 调用中加载外部 JS 文件并使其资产全局可用，则 $.getScript 部分是一个有用的小片段。然后，您可以使用`$.globalEval`在 AJAX 函数中实例化一个变量。

[$.globalEval 的文档](http://api.jquery.com/jQuery.globalEval/)

[jQuery AJAX 文档](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-31T20:25:34.183

You don't a function wrapper for setting a value to a variable.

```
var myRequest = a; 
```

That is good enough.

**After thought revision**

in a very basic way a variable can be created on its own like a place holder.

var myRequest;

when you get to the function (say you have a series of functions.

You could do something like this.

function(myRequest=a);

if the function has more than one argument it can look like this.

function(myRequest=a,myConcern=b); as you have it stated in the

var arg1 = 1;
var arg2 = 2;
var arg3 = 3;

ajaxRequest.open(arg1,arg2,arg3);

I hope this is helpful and yes, some more info would help (like the poster below stated).

# dataframe - 熊猫数据框与一系列相乘

> ID：13166842
> 
> 赞同：40
> 
> 时间：2012-10-31T20:20:44.700
> 
> 标签：dataframe, pandas, multiplication

将 Pandas 的所有列乘以`DataFrame`存储在 a 中的列向量的最佳方法是`Series`什么？我曾经在 Matlab 中使用`repmat()`，这在 Pandas 中不存在。我可以使用`np.tile()`，但是每次来回转换数据结构看起来很难看。

谢谢。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-11-09T21:01:11.110

有什么问题

```
result = dataframe.mul(series, axis=0) 
```

?

[https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.mul.html#pandas.DataFrame.mul](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.mul.html#pandas.DataFrame.mul)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-04T06:52:40.570

这可以通过 DataFrame 方法非常简单地完成`apply`。

```
In[1]: import pandas as pd; import numpy as np

In[2]: df = pd.DataFrame(np.arange(40.).reshape((8, 5)), columns=list('abcde')); df
Out[2]: 
        a   b   c   d   e
    0   0   1   2   3   4
    1   5   6   7   8   9
    2  10  11  12  13  14
    3  15  16  17  18  19
    4  20  21  22  23  24
    5  25  26  27  28  29
    6  30  31  32  33  34
    7  35  36  37  38  39

In[3]: ser = pd.Series(np.arange(8) * 10); ser
Out[3]: 
    0     0
    1    10
    2    20
    3    30
    4    40
    5    50
    6    60
    7    70 
```

现在我们有了我们的`DataFrame`并且`Series`我们需要一个函数来传递给`apply`.

```
In[4]: func = lambda x: np.asarray(x) * np.asarray(ser) 
```

我们可以把它传给`df.apply`我们，我们很高兴

```
In[5]: df.apply(func)
Out[5]:
          a     b     c     d     e
    0     0     0     0     0     0
    1    50    60    70    80    90
    2   200   220   240   260   280
    3   450   480   510   540   570
    4   800   840   880   920   960
    5  1250  1300  1350  1400  1450
    6  1800  1860  1920  1980  2040
    7  2450  2520  2590  2660  2730 
```

`df.apply`默认情况下按列执行，但它也可以通过`axis=1`作为参数传递给`apply`.

```
In[6]: ser2 = pd.Series(np.arange(5) *5); ser2
Out[6]: 
    0     0
    1     5
    2    10
    3    15
    4    20

In[7]: func2 = lambda x: np.asarray(x) * np.asarray(ser2)

In[8]: df.apply(func2, axis=1)
Out[8]: 
       a    b    c    d    e
    0  0    5   20   45   80
    1  0   30   70  120  180
    2  0   55  120  195  280
    3  0   80  170  270  380
    4  0  105  220  345  480
    5  0  130  270  420  580
    6  0  155  320  495  680
    7  0  180  370  570  780 
```

这可以通过在内部定义匿名函数来更简洁地完成`apply`

```
In[9]: df.apply(lambda x: np.asarray(x) * np.asarray(ser))
Out[9]: 
          a     b     c     d     e
    0     0     0     0     0     0
    1    50    60    70    80    90
    2   200   220   240   260   280
    3   450   480   510   540   570
    4   800   840   880   920   960
    5  1250  1300  1350  1400  1450
    6  1800  1860  1920  1980  2040
    7  2450  2520  2590  2660  2730

In[10]: df.apply(lambda x: np.asarray(x) * np.asarray(ser2), axis=1)
Out[10]:
       a    b    c    d    e
    0  0    5   20   45   80
    1  0   30   70  120  180
    2  0   55  120  195  280
    3  0   80  170  270  380
    4  0  105  220  345  480
    5  0  130  270  420  580
    6  0  155  320  495  680
    7  0  180  370  570  780 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T21:28:37.680

为什么不创建自己的数据框平铺功能：

```
def tile_df(df, n, m):
    dfn = df.T
    for _ in range(1, m):
        dfn = dfn.append(df.T, ignore_index=True)
    dfm = dfn.T
    for _ in range(1, n):
        dfm = dfm.append(dfn.T, ignore_index=True)
    return dfm 
```

### 例子：

```
df = pandas.DataFrame([[1,2],[3,4]])
tile_df(df, 2, 3)
#    0  1  2  3  4  5
# 0  1  2  1  2  1  2
# 1  3  4  3  4  3  4
# 2  1  2  1  2  1  2
# 3  3  4  3  4  3  4 
```

**但是**，[文档](http://pandas.pydata.org/pandas-docs/dev/dsintro.html#dataframe-interoperability-with-numpy-functions)指出：*“DataFrame 并非旨在替代 ndarray，因为它的索引语义在某些地方与矩阵完全不同。”* 这大概应该被解释为*“如果你正在做很多矩阵的东西，请使用 numpy”*。

# jquery - 显示/隐藏 div jQuery

> ID：13166843
> 
> 赞同：1
> 
> 时间：2012-10-31T20:20:53.133
> 
> 标签：jquery, html

我想在一个页面上有 4-8 个“隐藏”的 div。然后还有 2 个按钮，一个“加号”和一个“删除”。当我单击“加号”按钮时，它会显示第一个 div，如果我再次单击“加号”按钮，它会显示 div nr 2。如果我使用“删除”它会删除 div。

我必须使用条件语句还是有任何简单的解决方案？

```
 $(document).ready(function() {
 $('#show').click(function () {
    $("#hiddencontent").fadeIn("slow");
  });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T20:28:20.047

您可能可以尝试类似

```
$("div:hidden").first().show(); 
```

和

```
$("div:visible").last().hide(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T20:25:12.480

以下代码将显示第一个不显示的 div。

```
 $(document).ready(function() {   
        $('#show').click(function () {       
            $("div").filter(function() { 
                 return $(this).css("display") == "none" 
            }).first().show();
        }); 
```

隐藏最后显示的 div。

```
 $('#remove').click(function () {  
            $("div").filter(function() { 
                 return $(this).css("display") !== "none" 
            }).last().hide();
        });
    }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T20:30:25.340

为您的 div 提供一个通用类以便于选择，然后您可以这样做：

```
var $divs = $(".hideShow").hide(); // cache a reference to the relevant divs,
                                   // and start with them hidden
$("#show").click(function() {
    $divs.filter(":hidden").first().fadeIn();
});
$("#hide").click(function() {
    $divs.not(":hidden").last().fadeOut();
});​ 
```

演示：http: [//jsfiddle.net/ua9ef/2/](http://jsfiddle.net/ua9ef/2/)

选择[`:hidden`器](http://api.jquery.com/hidden-selector/)允许您只操作隐藏的，或者只操作[`.not()`](http://api.jquery.com/not/)隐藏的。（或者当然你可以使用[`:visible`选择器](http://api.jquery.com/visible-selector/)......）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T20:26:18.320

`ID`是独一无二的，您不能一遍又一遍地重复使用它们，请更改`id="hiddencontent"`为`class="hiddencontent"`然后按照以下说明进行操作。

[**演示 jsFiddle**](http://jsfiddle.net/seSFP/)

```
$(document).ready(function() {
    var index = 0;
    $('#show').click(function () {
        $('div').eq(index).fadeIn('slow');
        if(index < $('div').length){
            index++;
        }else{
            alert('There is no more hidden content!');
        }
    });
    $('#remove').click(function(){
        $('div').eq(index -1).remove();
    });
});​ 
```

jQuery`.eq()`有一个`zero based index`. 我们在 click 函数之外设置了一个变量，但在 click 的范围内仍然可用，并且我们按顺序切换 hiddencontent。当我们单击时，它将更改索引`0 > 1 > 2 > 3`等。我们检查索引是否小于与类匹配的当前元素数，`hiddencontent`如果通过，我们将索引迭代到下一个整数。

remove 函数不需要更改迭代器，因为它只想删除最后一个索引项（据我所知，根据您的情况）。

这应该做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T20:30:37.457

[http://jsfiddle.net/z9s8T/](http://jsfiddle.net/z9s8T/)

CSS

```
div{
    display:none;
}
div.show{
    display:block;
}
​ 
```

HTML

```
<button id="show">show</button>
<button id="hide">hide</button>

<div>1</div>
<div>2</div>
<div>3</div>
<div>4</div> 
```

JS

```
$(function(){
    $('#show').click(function(){
        $('div:not(.show):eq(0)').addClass('show');
    });
    $('#hide').click(function(){
        $('div.show:last').removeClass('show');
    }); 
});​ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-31T20:31:27.067

这是一个简单的[小提琴](http://jsfiddle.net/Bx8sg/)`.hidden`，对将被隐藏、显示和再次隐藏的元素使用 (bad name) 类。然后我使用`:hidden`and`:visible`选择器。

```
$("#add").click(function() {
    $(".hidden:hidden").first().show();
});

$("#remove").click(function() {
    $(".hidden:visible").last().hide();
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-31T20:42:29.407

检查这个

```
var index = -1;
var max = $('.container > div').length;
$('#show').on('click', function() {
    if (index + 1 > max) {
        // Do Nothing
    } else {
        if (index < max - 1) {
            index++;
            $('.container > div:eq(' + index + ')').show();
        }

    }
});

$('#hide').on('click', function() {
    if (index == -1) {
        index = 0;
    }
    else {
        if ($('.container > div:eq(' + index + ')').is(':visible')) {
            $('.container > div:eq(' + index + ')').hide();
            index--;
        }
    }
});​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/5uNmx/1/)**

# wpf - WPF：无法在用户控件中创建所有控件的实例

> ID：13166844
> 
> 赞同：0
> 
> 时间：2012-10-31T20:21:20.600
> 
> 标签：wpf, custom-controls

我在我的 WPF 应用程序中使用自定义控件。此自定义控件包括逻辑和资源字典。在我的应用程序中，我有登录窗口和主窗口。应用程序首先加载登录窗口

```
<Application x:Class="Dest.App"
             ....
             StartupUri="Login.xaml">
</Application> 
```

我在主窗口中使用的自定义控件

```
<time:Calendar CloseAppointment="OnDeleteAppointment" AddAppointment="OnAddAppointment" Appointments="{Binding Path=Model}" /> 
```

同样在 MainWindow 我从程序集中加载资源字典

```
<ResourceDictionary>
  <ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="pack://application:,,,/WpfCalendar;component/Dictionary.xaml"/>
  </ResourceDictionary.MergedDictionaries>
</ResourceDictionary> 
```

Visual Studio 加载自定义控件没有任何异常。但是当我加载应用程序并成功登录时，登录视图的视图模型会调用主窗口

```
 MainWindow mainWindow = new MainWindow();
 mainWindow.Show(); 
```

主窗口的构造函数

```
public MainWindow()
{
   InitializeComponent();    
   m_MainViewModel = new MainViewModel();
   this.DataContext = m_MainViewModel;
} 
```

我收到一个例外

[例外](http://oi48.tinypic.com/11ljskh.jpg)

异常详情

> 在 D:\development\Dental Soft\LotusScheduler\WpfScheduler\WpfCalendar\Logic\Calendar.cs: WpfCalendar.Logic.Calendar.OnAppointmentsChanged(DependencyPropertyChangedEventArgs e) 中的 D:\development 中的 WpfCalendar.Logic.Calendar.FilterAppointments() 中的第 122 行\Dental Soft\LotusScheduler\WpfScheduler\WpfCalendar\Logic\Calendar.cs：D:\development\Dental Soft\LotusScheduler\WpfScheduler\WpfCalendar\Logic\ 中 WpfCalendar.Logic.Calendar.OnAppointmentsChanged(DependencyObject d, DependencyPropertyChangedEventArgs e) 的第 109 行Calendar.cs：System.Windows.DependencyObject.OnPropertyChanged(DependencyPropertyChangedEventArgs e) 处 System.Windows.FrameworkElement.OnPropertyChanged(DependencyPropertyChangedEventArgs e) 处 System.Windows.DependencyObject 处的第 100 行。NotifyPropertyChange(DependencyPropertyChangedEventArgs args) 在 System.Windows.DependencyObject.UpdateEffectiveValue(EntryIndex entryIndex, DependencyProperty dp, PropertyMetadata 元数据, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType) 在 System.Windows.DependencyObject.InvalidateProperty(DependencyProperty dp, Boolean preserveCurrentValue) at System.Windows.Data.BindingExpressionBase.Invalidate(Boolean isASubPropertyChange) 在 System.Windows.Data.BindingExpression.TransferValue(Object newValue, Boolean isASubPropertyChange) 在 System.Windows.Data.BindingExpression.Activate(Object item) 在 System System.Windows.Data 处的 .Windows.Data.BindingExpression.AttachToContext（AttachAttempt 尝试）。BindingExpression.MS.Internal.Data.IDataBindEngineClient.AttachToContext(Boolean lastChance) 在 MS.Internal.Data.DataBindEngine.Task.Run(Boolean lastChance) 在 MS.Internal.Data.DataBindEngine.Run(Object arg) 在 MS.Internal。 Data.DataBindEngine.OnLayoutUpdated(Object sender, EventArgs e) 在 System.Windows.ContextLayoutManager.fireLayoutUpdateEvent() 在 System.Windows.ContextLayoutManager.UpdateLayout() 在 System.Windows.ContextLayoutManager.UpdateLayoutCallback(Object arg) 在 System.Windows.Media .MediaContext.InvokeOnRenderCallback.DoWork() 在 System.Windows.Media.MediaContext.FireInvokeOnRenderCallbacks() 在 System.Windows.Media.MediaContext.RenderMessageHandlerCore(Object resizedCompositionTarget) 在 System.Windows.Media.MediaContext.RenderMessageHandler(Object resizedCompositionTarget) 在 System .Windows.媒体。MediaContext.Resize(ICompositionTarget resizedCompositionTarget) 在 System.Windows.Interop.HwndTarget.OnResize() 在 System.Windows.Interop.HwndTarget.HandleMessage(WindowMessage msg, IntPtr wparam, IntPtr lparam) 在 System.Windows.Interop.HwndSource.HwndTargetFilterMessage( IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&handled) 在 MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&handled) 在 MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o ) 在 System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs) 在 MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler) 在系统。 Windows.Threading.Dispatcher。MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam) 在 MS.Win32.UnsafeNativeMethods.CallWindowProc(IntPtr wndProc, IntPtr hWnd, Int32 msg, IntPtr wParam, IntPtr lParam) 在 MS.Win32.HwndSubclass.DefWndProcWrapper(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam) 在 MS.Win32.UnsafeNativeMethods.CallWindowProc(IntPtr wndProc, IntPtr hWnd, Int32 , IntPtr wParam, IntPtr lParam) 在 MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam) 在 MS.Win32.UnsafeNativeMethods.SetWindowPos(HandleRef hWnd, HandleRef hWndInsertAfter, Int32 x, Int32 y, Int32 cx，Int32 cy，Int32 标志）在 System.Windows.Window.SetupInitialState（双请求顶部，双请求左，双请求宽度，双请求高度）在 System.Windows.Window.CreateSourceWindow（布尔 duringShow）在 System.Windows.Window.CreateSourceWindowDuringShow() 在 System.Windows.Window.SafeCreateWindowDuringShow() 在 System.Windows.Window.ShowHelper( Object booleanBox) at System.Windows.Window.Show() at ViewModel.LoginingViewModel.Login(Object parameter) in D:\development\Dental Soft\Lotus\AMS\Dentist\ViewModel\LoginingViewModel.cs：ViewModel.LoginingViewModel 的第 162 行D:\development\Dental Soft\Lotus\AMS\Dentist\ViewModel\LoginingViewModel.cs 中的 .b__0（对象参数）：D:\development\Dental Soft\Lotus\ 中 ViewModel.CommonCommand.Execute（对象参数）的第 115 行AMS\Dentist\Commands\CommonCommand.cs：MS.Internal.Commands.CommandHelpers 的第 59 行。CriticalExecuteCommandSource(ICommandSource commandSource, Boolean userInitiated) at System.Windows.Controls.Primitives.ButtonBase.OnClick() at System.Windows.Controls.Button.OnClick() at System.Windows.Controls.Primitives.ButtonBase.OnMouseLeftButtonUp(MouseButtonEventArgs e)在 System.Windows.UIElement.OnMouseLeftButtonUpThunk(Object sender, MouseButtonEventArgs e) 在 System.Windows.Input.MouseButtonEventArgs.InvokeEventHandler(Delegate genericHandler, Object genericTarget) 在 System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target) 在 System. Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs) 在 System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised) 在 System.Windows.UIElement。ReRaiseEventAs(DependencyObject sender, RoutedEventArgs args, RoutedEvent newEvent) 在 System.Windows.UIElement.OnMouseUpThunk(Object sender, MouseButtonEventArgs e) 在 System.Windows.Input.MouseButtonEventArgs.InvokeEventHandler(Delegate genericHandler, Object genericTarget) 在 System.Windows.RoutedEventArgs。 InvokeHandler（委托处理程序，对象目标）在 System.Windows.RoutedEventHandlerInfo.InvokeHandler（对象目标，RoutedEventArgs routedEventArgs）在 System.Windows.EventRoute.InvokeHandlersImpl（对象源，RoutedEventArgs 参数，布尔 reRaised）在 System.Windows.UIElement.RaiseEventImpl（ System.Windows.UIElement.RaiseEvent(RoutedEventArgs args, Boolean trust) 在 System.Windows.UIElement.RaiseTrustedEvent(RoutedEventArgs args) 在 System.Windows.Input 的 DependencyObject 发送方，RoutedEventArgs args)。InputManager.ProcessStagingArea() 在 System.Windows.Input.InputManager.ProcessInput(InputEventArgs 输入) 在 System.Windows.Input.InputProviderSite.ReportInput(InputReport inputReport) 在 System.Windows.Interop.HwndMouseInputProvider.ReportInput(IntPtr hwnd, InputMode 模式, Int32 时间戳，RawMouseActions 操作，Int32 x，Int32 y，Int32 轮）在 System.Windows.Interop.HwndMouseInputProvider.FilterMessage（IntPtr hwnd，WindowMessage msg，IntPtr wParam，IntPtr lParam，Boolean& 处理）在 System.Windows.Interop.HwndSource。 InputFilterMessage（IntPtr hwnd，Int32 msg，IntPtr wParam，IntPtr lParam，Boolean& 处理）在 MS.Win32.HwndWrapper.WndProc（IntPtr hwnd，Int32 msg，IntPtr wParam，IntPtr lParam，Boolean& 处理）在 MS.Win32.HwndSubclass.DispatcherCallbackOperation（ System.Windows.Threading 中的对象 o)。ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs) at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler) at System.Windows.Threading.Dispatcher.LegacyInvokeImpl( DispatcherPriority 优先级、TimeSpan 超时、委托方法、对象参数、Int32 numArgs) 在 MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam) 在 MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG& msg) 在系统.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame) 在 System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame) 在 System.Windows.Threading.Dispatcher.Run() 在 System.Windows.Application.RunDispatcher(对象忽略)在 System.Windows.Application。RunInternal(Window window) at System.Windows.Application.Run(Window window) at System.Windows.Application.Run() at Dentist.App.Main() in D:\development\Dental Soft\Lotus\AMS\Dentist\ obj\x86\Debug\App.g.cs：Microsoft 的 System.AppDomain._nExecuteAssembly(RuntimeAssembly 程序集，String[] args) 处的第 0 行 System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)。 VisualStudio.HostingProcess.HostProc.RunUsersAssembly() 在 System.Threading.ThreadHelper.ThreadStart_Context(Object state) 在 System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) 在 System.Threading.ExecutionContext.Run （ExecutionContext executionContext、ContextCallback 回调、对象状态、布尔值 preserveSyncCtx）在 System.System.Threading.ThreadHelper.ThreadStart() 处的 Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)

带有问题控件的资源字典的一部分

```
<Border BorderBrush="#A5BFE1" BorderThickness="0,1,1,1" Background="White" Grid.Column="1" Grid.Row="0" >
    <TextBlock x:Name="DayHeader" HorizontalAlignment="Center" VerticalAlignment="Center">
    <TextBlock.ToolTip>
        <ToolTip>
            <StackPanel>
                <TextBlock FontWeight="Bold" Text="{x:Static Properties:Resources.CalendarSelectedDayTitle}" />
                <TextBlock Text="{x:Static Properties:Resources.CalendarSelectedDayDescription}" />
            </StackPanel>
        </ToolTip>
    </TextBlock.ToolTip>
        </TextBlock>
</Border>
<time:Scroll x:Name="scrollViewer" CustomVerticalOffset="640.0" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="60" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <time:TimeRibbon Grid.Column="0"></time:TimeRibbon>
        <time:SchedulerDay Grid.Column="1" x:Name="Day"></time:SchedulerDay>
    </Grid>
</time:Scroll> 
```

Calendar 控件的构造函数（抛出异常）

```
public Calendar()
{
    DefaultStyleKeyProperty.OverrideMetadata(typeof(Calendar), new FrameworkPropertyMetadata(typeof(Calendar)));

    CommandManager.RegisterClassCommandBinding(typeof(Calendar), 
        new CommandBinding(NextDay, new ExecutedRoutedEventHandler(OnExecutedNextDay), 
            new CanExecuteRoutedEventHandler(OnCanExecuteNextDay)));

    CommandManager.RegisterClassCommandBinding(typeof(Calendar),
        new CommandBinding(PreviousDay, new ExecutedRoutedEventHandler(OnExecutedPreviousDay),
            new CanExecuteRoutedEventHandler(OnCanExecutePreviousDay)));
} 
```

但是，当在 app.xaml 中设置第一个窗口 MainWindow，而不是 LoginWindow 时，一切正常，没有任何异常！

请告知问题的原因可能是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T20:32:46.443

在您的 FilterAppointments 类构造函数中发生异常（根据您的屏幕截图）。您正在根据您的 controltemplate 执行一些操作，但此时尚未分配模板。您应该重写 OnApplyTemplate() 并将该代码移到那里。

# ruby-on-rails-3 - 用于循环视图的 Rails

> ID：13166847
> 
> 赞同：6
> 
> 时间：2012-10-31T20:21:38.580
> 
> 标签：ruby-on-rails-3

我有以下代码：

```
<tbody>
   <%= Item.each do |item|=%>
   <tr>
      <th><%= item.rev =%></th>      <=========
      <th><%= item.name =%></th>
   </tr>
   <%= end =%>
</tbody> 
```

但是，我在指示的行上遇到语法错误。数据库中有数据（测试用例）。不知道我做错了什么。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-31T20:24:58.020

你的等号是错误的。尝试如下：

```
<tbody>
   <% Item.each do |item|%>
   <tr>
      <th><%= item.rev %></th>     
      <th><%= item.name %></th>
   </tr>
   <% end %>
</tbody> 
```

<%= 应该只用于需要评估的表达式。

为了帮助理解嵌入式 ruby​​，请参阅此链接 [http://www.ruby-doc.org/docs/ProgrammingRuby/html/web.html](http://www.ruby-doc.org/docs/ProgrammingRuby/html/web.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:53:44.547

erb 标签的表达式
现在是 <% #code %> 如果我们也想打印该标签，那么我们应用 <%= #code %>
即只使用一个'=' 符号并且在左侧也是如此。
同样在每个迭代器中，没有任何内容可以打印，因此该行中没有'='符号，与包含'end'的标签的情况类似。

因此你的代码应该看起来像

> `<tbody>`
>      <% Item.每个都做 |item| %>
>           `<tr>`
>                `<th>`<%= item.rev %> `</th>`
>                `<th>`<%= item.name %> `</th>`
>           `</tr>`
>      <% end %>
> `</tbody>`

# c# - 为模拟令牌调用 DuplicateTokenEx 后仍然出现重复令牌错误

> ID：13166848
> 
> 赞同：2
> 
> 时间：2012-10-31T20:21:38.830
> 
> 标签：c#, impersonation

我试图`Sytem.IntPtr`从服务调用中返回一个，以便客户端可以使用模拟来调用一些代码。如果不从 WCF 服务传回令牌，我的模拟代码可以正常工作。我不确定为什么这不起作用。我收到以下错误：

> “用于模拟的令牌无效 - 无法复制。”

这是我的代码，*除非*我尝试将令牌从服务传递回 WinForm C# 客户端然后模拟。

```
[DllImport("advapi32.dll", EntryPoint = "DuplicateTokenEx")]
public extern static bool DuplicateTokenEx(IntPtr ExistingTokenHandle, uint dwDesiredAccess, ref SECURITY_ATTRIBUTES lpThreadAttributes, int TokenType, int ImpersonationLevel, ref IntPtr DuplicateTokenHandle);

private IntPtr tokenHandle = new IntPtr(0);
private IntPtr dupeTokenHandle = new IntPtr(0);

[StructLayout(LayoutKind.Sequential)]
public struct SECURITY_ATTRIBUTES
{
    public int Length;
    public IntPtr lpSecurityDescriptor;
    public bool bInheritHandle;
}

public enum SecurityImpersonationLevel
{
    SecurityAnonymous = 0,
    SecurityIdentification = 1,
    SecurityImpersonation = 2,
    SecurityDelegation = 3
}

public enum TokenType
{
    TokenPrimary = 1,
    TokenImpersonation = 2
}

private const int MAXIMUM_ALLOWED = 0x2000000;

[PermissionSetAttribute(SecurityAction.Demand, Name = "FullTrust")]
public System.IntPtr GetWindowsUserToken(string UserName, string Password, string DomainName)
{

    IntPtr tokenHandle = new IntPtr(0);
    IntPtr dupTokenHandle = new IntPtr(0);

    const int LOGON32_PROVIDER_DEFAULT = 0;
    //This parameter causes LogonUser to create a primary token.
    const int LOGON32_LOGON_INTERACTIVE = 2;

    //Initialize the token handle            
    tokenHandle = IntPtr.Zero;

    //Call LogonUser to obtain a handle to an access token for credentials supplied.
    bool returnValue = LogonUser(UserName, DomainName, Password, LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT, ref tokenHandle);        

    //Make sure a token was returned; if no populate the ResultCode and throw an exception:
    int ResultCode = 0;
    if (false == returnValue)
    {
        ResultCode = Marshal.GetLastWin32Error();
        throw new System.ComponentModel.Win32Exception(ResultCode, "API call to LogonUser failed with error code : " + ResultCode);
    }

    SECURITY_ATTRIBUTES sa = new SECURITY_ATTRIBUTES();
    sa.bInheritHandle = true;
    sa.Length = Marshal.SizeOf(sa);
    sa.lpSecurityDescriptor = (IntPtr)0;

    bool dupReturnValue = DuplicateTokenEx(tokenHandle, MAXIMUM_ALLOWED, ref sa, (int)SecurityImpersonationLevel.SecurityDelegation, (int)TokenType.TokenImpersonation, ref dupTokenHandle);

    int ResultCodeDup = 0;
    if (false == dupReturnValue)
    {
        ResultCodeDup = Marshal.GetLastWin32Error();
        throw new System.ComponentModel.Win32Exception(ResultCode, "API call to DuplicateToken failed with error code : " + ResultCode);
    }

    //Return the user token
    return dupTokenHandle;

} 
```

知道我是否没有`DuplicateTokenEx`正确使用调用吗？根据我[在这里](http://msdn.microsoft.com/en-us/library/windows/desktop/aa446617%28v=vs.85%29.aspx)阅读的 MSDN 文档，我应该能够创建一个对委托有效的令牌，并在远程系统的上下文中使用。当使用“SecurityDelegation”时，服务器进程可以在远程系统上模拟客户端的安全上下文。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-11-17T19:21:45.817

您正在使用 TokenAccessLevels.MaximumAllowed 值，就好像它是允许的最大权限一样，这意味着：好像它会给您所有权限......

...但事实并非如此。

TokanAccesslevels.MaximumAllowed 的值为 0x02000000，这是枚举可以随时增长到的最大值，作为未来实现的参考。

请参阅[此页面](http://referencesource.microsoft.com/#mscorlib/system/security/principal/tokenaccesslevels.cs,97f98278efdac974)以了解枚举的实际实现。

要使您的代码正常工作，您需要通过按位操作一一设置所需的访问级别。

如果您将 MAXIMUM_ALLOWED 替换为

```
(uint)(TokenAccessLevels.Query | TokenAccessLevels.Duplicate | TokenAccessLevels.Impersonate) 
```

在 DuplicateTokenEx 函数的 PInvoke 调用中。

我知道你不再有问题了，但这可以帮助其他人，毕竟，你可能会再次遇到同样的问题...... ;)

# java - 基于文本文件的触发事件

> ID：13166850
> 
> 赞同：1
> 
> 时间：2012-10-31T20:21:44.897
> 
> 标签：java, multithreading, time, observer-pattern, simulator

我有一个包含事件记录的文本文件，每个事件都有一个时间戳。我想创建一个实时模拟文件数据的引擎。最终我的项目将使用实时数据，但我正在尝试创建一个测试框架。

换句话说：

1.  `Simulator`线
    *   读取文件，在时间戳发生时创建事件
2.  `Worker`线
    *   流程数据（这是我们去生产时会保留的代码）
3.  事件切换/`Notifier`线程？？？（见下文）

我试图弄清楚如何最好地实施`Simulator`. 一次读取一行，然后在该事件发生之前休眠几毫秒，这对我来说似乎是错误的。有些事件相隔不到 10 毫秒。我想做的是有一个事件队列，这样当事件相距很远时我就可以领先，这样当它们彼此靠近时我要做的处理最少。

也许`Simulator`真的应该是 2 个线程，一个读取文件并将事件放入队列，另一个处理它们并将事件触发到工作线程（见上文，`Notifier`线程）。这听起来合理吗？下面是一些代码，概述了我的想法。我在正确的轨道上吗？这里不包括读取文件并创建`MyEvent`s 的线程。

```
public class Notifier implements Runnable {
    private long firstStartTime;
    private long realStartTime;
    private Worker theWorker;

    public void run() {
        while(true) {
            if (eventQueue.peek().getTriggerTime() - this.firstStartTime >=
                    System.currentTimeMillis() - this.realStartTime) {
                GlobalQueue.getInstance().offer(eventQueue.poll());
                theWorker.notify();
            }
        }
    }
}

public class GlobalQueue implements Queue<MyEvent> {
    private Queue<MyEvent> myQueue;
    private static GlobalQueue _instance = new GlobalQueue();
    private GlobalQueue() {
        myQueue = new LinkedList<MyEvent>();
    }
    public static getInstance() { return _instance; }
}

public class Worker implements Observer, Runnable {
    public void run() {
        while(true) {
            if(events.peek() != null) {
                 MyEvent event = GlobalQueue.getInstance().poll();
                 // handle the event
            }
            wait();
        }
    }
} 
```

你怎么看？好，或者你会做出重大的设计改变？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:01:15.203

使用 Timer 最重要的是有一个 TimerTask 能够在涉及到它时触发您的事件：

```
public class EventFirer extends TimerTask {
    private final MyEvent event;

    public EventFirer(MyEvent event) {
        this.event = event;
    }

    public void run() {
        event.fire();
    }
} 
```

现在您只需将所有 EventFirers 放入 Timer 中：

```
public Timer fillTimer(List<Date> firingTimes) {
    Timer timer = new Timer();
    for (Date whenToFire: firingTimes) {
        timer.schedule(new EventFirer(new MyEvent()), whenToFire);
    }
    return timer;
} 
```

然后让 Timer 完成其余的工作......事实上 Timer 将成为 Simulator 线程。当然在内部它有它的线程。但是我不知道它的时间是否足够准确，可以满足您的需要。我只在第二次或多或少无关紧要的情况下使用它。而且我认为它会计算到下一个事件之前的睡眠时间。因此，它应该与您的解决方案一样准确。

# shopify - 已支付订单的 Webhook 数据

> ID：13166853
> 
> 赞同：0
> 
> 时间：2012-10-31T20:21:59.023
> 
> 标签：shopify

一个客户最近请求了一些基于注册到付费订单的网关属性的奇特处理。当我接收、验证和检查订单的 JSON 时，我正在记录 gateway 属性，发现它有时为零。

当我在 Webhook 之后使用 API 检查订单时，网关属性存在并且与 Shop admin 中呈现的属性相匹配。

有没有解释为什么网关有时可以为零？这使我无法处理客户请求的处理。

作为示例..我正在过滤传入的网关收据...

2012-11-02T03:02:56+00:00 应用程序 [web.1]：网关：eway
2012-11-02T03:59:08+00:00 应用程序 [web.1]：网关：

可以看出......有时它在那里......有时它不是......这使得逻辑尴尬......这里有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T04:58:39.650

会不会是网关在后台做一些处理？它将解释为什么该值在 web 挂钩中不可用*（它不是响应的一部分）*，但在几秒钟后在管理员中和通过 API 可用。

如果不是这样，那么可能是网络钩子本身有问题。

# email - 发送合法的商业电子邮件，避免被列入黑名单或标记为垃圾邮件

> ID：13166863
> 
> 赞同：5
> 
> 时间：2012-10-31T20:22:51.403
> 
> 标签：email, spam

### 首先

在这个世界上，有很多人通过电子邮件*合法*和*合法地*联系人们以发送商业通讯，也有很多为这些人工作的开发人员被要求只有一小部分合法和合法的信息被丢弃通过 Gmail 等电子邮件服务器。

此外，我已经知道垃圾邮件发送者与诚实的电子邮件发送者是一场猫与老鼠的竞赛，并且在不断发展。

### 那说

我想问一下，除了我已经知道的那些之外，是否有任何有用的技术可以让大型电子邮件地址数据库的所有者（所有这些都经过选择同意）以编程方式向他们发送广告，避免被列入黑名单或被丢弃在第一时间

### 一些有用的技巧

例如

*   在代码中实现[Hashcash 。](https://en.wikipedia.org/wiki/Hashcash)这**大大**减慢了消息发送的速度（因此这可能需要一些云资源和最重要的异步处理），但至少证明了大约 1 秒的 CPU 时间已经“非常适合”（让我这么说）来编写电子邮件
*   以最严格的方式实施和执行[发件人策略框架。](https://en.wikipedia.org/wiki/Sender_Policy_Framework)这（如果在接收方实施）确保来自特定域的所有电子邮件仅来自域所有者控制下的邮件服务器。但是 AFAIK 虽然一些服务器使用违反 SPF 作为拒绝邮件的借口，但这些服务器并没有将 SPF 的完全满足视为垃圾邮件概率较低（因为注册一个垃圾邮件发送者每天可以购买和配置很多的域非常便宜)
*   通过明确指定文本中的单词，在文本中明确提及**退出**`unsubscribe`程序，因为某些过滤器将该词视为合法
*   实施[DKIM](https://en.wikipedia.org/wiki/Dkim)签名，因为我发现很大一部分未经 DKIM 签名的邮件被 Gmail 确定性地标记为垃圾邮件。DKIM 不提供比 SPF 更多的保证，但可以中继 DKIM 签名的邮件

还有什么技巧可以推荐吗？我了解该主题将来可能会发展

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T20:34:08.597

我可以想到两个第三方服务，它们将负责发送大量电子邮件所需的腿部工作，并消除防止被归类为垃圾邮件的负担。

[Amazon Simple Email Service](http://aws.amazon.com/ses/) (SES) 允许您使用 Web 服务发送大量电子邮件。他们已经实施了 DKIM，您可以在他们的沙盒期结束后开始向大众发送。

您还可以使用[Mail Chimp 之](http://mailchimp.com)类的服务。他们提供 API，专门用于发送大量电子邮件。请参阅他们关于[可交付性](http://mailchimp.com/about/deliverability/)的页面。

# php - Instagram API 的 Ajax 分页尝试修复错误

> ID：13166868
> 
> 赞同：4
> 
> 时间：2012-10-31T20:23:11.380
> 
> 标签：php, jquery, ajax, pagination, instagram

我正在尝试修复 Instagram API 的 Ajax 分页

仅显示 20 张照片。“加载更多”按钮不起作用。

在控制台中：

```
Uncaught ReferenceError: maxid is not defined 
```

这是 index.php：

```
 <script>
 $(document).ready(function() {
 $('#more').click(function() {
 var max_id = $(this).data('nextid');

 $.ajax({
 type: 'GET',
 url: 'ajax.php',
 data: {
 max_id: maxid
 },
 dataType: 'json',
 cache: false,
 success: function(data) {
 // Output data
 $.each(data.images, function(i, src) {
 $('#photos').append('<li><img src="' + src + '"></li>');
 });

 // Store new maxid
 $('#more').data('maxid', data.next_id);
 }
 });
 });
 });
</script>

<?php

 require_once 'instagram.class.php';

$instagram = new Instagram(array(
  'apiKey' => '*****',
  'apiSecret' => '*****',
  'apiCallback' => '******'

));

// Receive OAuth code parameter
$code = $_GET['code'];

if (true === isset($code)) {

$data = $instagram->getOAuthToken($code);

$instagram->setAccessToken($data);

$media = $instagram->getUserMedia();

}
?>

<ul id="photos">

<?php foreach( $media->data as $data ): ?>
<li><img src="<?php echo $data->images->thumbnail->url ?>"></li>
<?php endforeach; ?>

<?php echo "<br><button id=\"more\" data-maxid=\"{$media->pagination->next_max_id}\">Load more ...</button>"; ?> 
```

ajax.php：

```
require_once 'instagram.class.php';
$instagram = new Instagram(array(
  'apiKey' => '****',
  'apiSecret' => '*****',
  'apiCallback' => '*******'

));

// Receive OAuth code parameter
$code = $_GET['code'];

if (true === isset($code)) {

$data = $instagram->getOAuthToken($code);

 // Initialize class for public requests
 $instagram->setAccessToken($data);

$media = $instagram->getUserMedia();

 // Receive AJAX request and create call object
 $maxID = $_GET['next_max_id'];

 $clientID = $instagram->getApiKey();

 $call = new stdClass;
 $call->pagination->next_max_id = $maxID;
 $call->pagination->next_url = "https://api.instagram.com/v1/users/self/media/recent?client_id={$clientID}&max_id={$maxID}";

 // Receive new data
 $media = $instagram->pagination($call);

 // Collect everything for json output
 $images = array();
 foreach ($media->data as $data) {
 $images[] = $data->images->thumbnail->url;
  }
 echo json_encode(array(
 'next_id' => $media->pagination->next_max_id,
'max_id' => $media->pagination->max_id,
 'images' => $images
 )); 
```

我正在使用[https://github.com/cosenary/Instagram-PHP-API](https://github.com/cosenary/Instagram-PHP-API)

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:28:08.600

How can it be clearer than:

```
Uncaught ReferenceError: maxid is not defined 
```

`maxid` is not defined in your code. What is defined is `max_id` in this line:

```
var max_id = $(this).data('nextid'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:29:52.367

只有 2 个位置`maxid`：

这里：

> $.ajax({
> ...
> max_id: maxid
> },

和这里：

> // 存储新的 maxid
> $('#more').data('maxid', data.next_id);

当您用您定义的`max_id`（感谢@mathieu）替换这些事件时，它应该被修复。

在`ajax.php`你有一行：

> $maxID = $_GET['next_max_id'];

这与您上面的调用不对应，您有一个`max_id`. 好像你混了一些`next/max/id`。如果您查看代码并清理这些 id，它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:59:20.513

看起来像

```
.data('nextid'); 
```

是一个粗心的错误，因为它在您的 DOM 中不存在。除非它在其他地方并且您还没有发布它。

你的意思是有

```
.data('maxid'); 
```

?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-11T10:09:48.800

您需要通过`event`单击传递参数并获取`data`from `event.target`。
将第一行代码更改为：

```
$('#more').click(function( event ) {
var max_id = $(event.target).data('nextid'); 
```

# jquery - Internet Explorer：悬停样式卡在 jQuery 可排序元素上

> ID：13166877
> 
> 赞同：4
> 
> 时间：2012-10-31T20:23:36.363
> 
> 标签：jquery, css, internet-explorer, jquery-ui-sortable

所以我有一个带有 jquery-sortable LI 的 UL。每个 LI 都有一个与之关联的 :Hover CSS 样式。当我将 LI 拖离 UL 并松开时，问题就出现了，悬停效果仍然适用于 IE9（chrome 工作正常）。

HTML

```
<ul id="test">
<li>test</li>
<li>test 2</li>
</ul>​ 
```

CSS

```
#test li:hover{
background-color:Yellow;}​ 
```

Javascript

```
$("#test").sortable();​ 
```

见小提琴：http: [//jsfiddle.net/hBhZD/2/](http://jsfiddle.net/hBhZD/2/)

我看到了以下 SO 问题： [IE9 not remove :hover style on DOM change](https://stackoverflow.com/questions/12388416/ie9-not-removing-hover-style-on-dom-change)。这似乎与我遇到的问题相同，但如果可能的话，我想避免使用 jQuery 来强制更改样式。

有人知道如何用 CSS 解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T01:27:44.067

使用`helper`选项在拖动时克隆对象；这样做会强制 IE8 在释放对象后重新绘制对象，从而重置悬停状态。

```
$("#test").sortable({
    helper: 'clone'
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T20:14:22.127

根据我的研究和我发现的基于 CSS 的答案的缺乏，似乎纯 CSS 无法克服这个 IE 错误（如果有人发现了其他问题，请证明我错了！）。这是我使用的基于 jQuery 的解决方法（如果您想知道的话）：

```
function toggleTabHover(tabName, hoverStatus) {
    var element = $('#'+tabName);

    if (element.hasClass('selectedTab')) {
        return;
    }

    if (hoverStatus === "on") {
        element.addClass('tabHoverOn');
        element.removeClass('tabHoverOff');
    }
    else {
        element.addClass('tabHoverOff');
        element.removeClass('tabHoverOn');
    }
} 
```

您传入要悬停的选项卡名称以及要切换到的“开”/“关”状态。selectedTab 类用于已单击的选项卡（我不希望将悬停影响应用于活动选项卡）。

# objective-c - 目标 C：表格视图滚动仅在键盘打开时有效

> ID：13166878
> 
> 赞同：2
> 
> 时间：2012-10-31T20:23:38.190
> 
> 标签：objective-c, scroll, uitextfield, uitableview

我的 TableView 中有两个文本字段。When one is selected for editing, the Textfield is moving to the center of the screen. 这就是我所做的：

```
-(void)textFieldDidBeginEditing:(UITextField *)textField
{
    if(textField == self.nameTextField) {
        [self.tableView scrollToRowAtIndexPath:[NSIndexPath indexPathForRow:0  inSection:0] atScrollPosition:UITableViewScrollPositionMiddle animated:YES];
    }
    else if(textField == self.passwordTextField) {
        [self.tableView scrollToRowAtIndexPath:[NSIndexPath indexPathForRow:1 inSection:0] atScrollPosition:UITableViewScrollPositionMiddle animated:YES];
    }
} 
```

一切正常，但只有在键盘打开时。如果我第一次单击文本字段或键盘已关闭，则不会发生滚动。

谁能告诉我为什么或者你有其他解决方案吗？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T10:28:13.980

尝试 textFieldShouldReturn 方法，它会在键盘按下时被调用。以下逻辑适用于我，将此方法添加到您的代码中：

-(BOOL)textFieldShouldReturn:(UITextField *)textField {

```
[textField resignFirstResponder];
[self.tableView setScrollEnabled:YES];
[self.tableView setContentOffset:CGPointZero animated:NO];
return YES; 
```

}

希望这对您有所帮助。

# sql - 无法登录以使用 ODBC 驱动程序

> ID：13166882
> 
> 赞同：0
> 
> 时间：2012-10-31T20:24:01.957
> 
> 标签：sql, sql-server, sql-server-2000

我正在尝试为 SQL Server 2000 设置 ODBC 驱动程序，但我做错了什么。我得到的错误是`sqlstate 28000`and `error 18456 failed login`。

以下是我采取的步骤：

*   在计算机管理下创建用户名
*   然后在企业管理器中，我通过转到`security->login new login`
*   从那里我浏览到我在计算机管理中创建的用户，并选择了 windows nt 并授予访问权限
*   然后转到数据库并滚动并为其授予几个数据库的读写权限。默认数据库设置为 master。到目前为止，一切似乎都很好。

然后我转到 ODBC 管理器，然后是 SysDSN，然后添加并选择 SQL Server。从这里我命名 DSN，选择同时具有 Windows 用户名和 SQL Server 的服务器，然后单击下一步。

然后我点击 SQL Server 身份验证并输入用户名和密码，并检查以确保它至少是正确的 20 次，然后我得到`18456 error`.

我错过了一步，发生了什么？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:17:37.887

您已设置 Windows 用户，而不是 SQL 用户，因此在您的连接中使用 Windows 身份验证，而不是 SQL 用户。

这将使用您登录到 Windows 的任何内容来连接到 SQL Server。这是“可信”身份验证，这意味着您不必记住无数个密码，它会使用您当前的密码。

如果我怀疑这不是您想要的，那么您应该在 SQL Server 上创建一个 SQL 用户，而不是 Windows 用户。在这种情况下，您只需在 SQL Server 中创建用户名和密码，而不是在计算机管理中。

默认情况下，SQL 用户的创建通常被禁用，因此您可能需要更改服务器配置以允许它。

我始终建议使用 Windows 用户而不是 SQL 用户，但如果您不在 Active Directory 环境中，那么 SQL 用户就可以了。

# java - 数组的浅拷贝，为什么不能简单地做 newArr = oldArr？

> ID：13166884
> 
> 赞同：6
> 
> 时间：2012-10-31T20:24:08.867
> 
> 标签：java, deep-copy, shallow-copy

假设我有一个整数数组，“orig”

我想浅拷贝它，所以我不能这样做：

```
int[] shallow = orig; 
```

我的教授说，对于原语，浅拷贝和深拷贝本质上是相同的，因为我们必须复制数组的每个索引。但是设置整个数组等于另一个数组做同样的事情，对吧？

我对对象数组有类似的问题

这是我的意识形态

```
Book[] objArr2 = objArr1; 
```

但有人告诉我，我必须复制每个数组索引，比如

```
//for loop
objArr2[i] = objArr1[i]; 
```

对于浅拷贝，将数组与另一个数组相等并单独复制每个数组索引之间真的有什么区别吗？（我知道深度意味着您必须创建全新的对象）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-31T20:34:32.517

> 我想浅拷贝它，所以我不能这样做：
> 
> int[] 浅= orig;

那不是真正的浅拷贝。副本是与原始项目相似但不是原始项目的离散实体。在您的示例中，您实际上拥有的是两个指向同一个对象的引用。创建副本时，您应该有两个结果对象：原始对象和副本。

在这里，您所做的任何修改`shallow`都会发生，`orig`因为它们都指向同一个对象。

当您正在比较的对象具有对其中其他对象的引用时，“浅薄”就会发挥作用。例如，如果您有一个整数数组并创建了一个副本，那么您现在有两个数组都包含相同的整数值：

```
Original Array

[0]
[1]
[2]
[3]

After copying:

[0] <--- Original  [0]
[1]                [1]
[3]                [2]
[4]      Copy ---> [3] 
```

但是，如果你有一个由对象组成的数组（比如说`objArr1`and `objArr2`）呢？当你做一个浅拷贝时，你现在有两个新的数组对象，但是两个数组之间的每个对应条目都指向同一个对象（因为对象本身没有被复制；只是引用有）。

```
Original Array:

[0:]----> [object 0]
[1:]----> [object 1]
[2:]----> [object 2]
[3:]----> [object 3] 
```

复制后（注意相应的位置如何指向相同的实例）：

```
Original -> [0:]----> [object 0] <----[:0] <- Copy
            [1:]----> [object 1] <----[:1]
            [2:]----> [object 2] <----[:2]
            [3:]----> [object 3] <----[:3] 
```

现在，如果您`objArr1`通过替换条目或删除条目进行修改，同样的事情**不会**发生在`objArr2`. **但是**，如果您在 处修改对象`objArr1[0]`，也会反映在 中`objArr2[0]`，因为这些位置指向*同一个*对象。所以在这种情况下，即使容器对象本身是不同的，它们所包含的是对同一对象的引用。

当您进行深度复制时，您将创建两个新数组，其中每个对应位置指向不同的实例。所以基本上你一直在复制对象。

> 我的教授说，对于原语，浅拷贝和深拷贝本质上是相同的，因为我们必须复制数组的每个索引。

要做出的重要区别是，当您复制一个基元数组时，您正在完全复制这些值。每次你得到一个**新**的原语。然而，当你有一个对象数组时，你*真正*拥有的是一个对对象的引用数组。因此，当您创建副本时，您所做的就是创建一个**新**数组，其中包含原始数组中引用的副本。但是，这些引用的新副本仍然指向相同的对应对象。这就是所谓的浅拷贝。如果您对数组进行深度复制，那么每个单独位置所引用的对象也将被复制。所以你会看到这样的东西：

```
Original -> [0:]----> [object 0] Copy -> [0:]----> [copy of object 0]
            [1:]----> [object 1]         [1:]----> [copy of object 1]
            [2:]----> [object 2]         [2:]----> [copy of object 2]
            [3:]----> [object 3]         [3:]----> [copy of object 3] 
```

> 但是设置整个数组等于另一个数组做同样的事情，对吧？

不，不是的。您在这里所做的只是创建对现有数组的新引用：

```
arr1 -> [0, 1, 2, 3, 4] 
```

现在假设你做到了`arr2 = arr1`。你所拥有的是：

```
arr1 -> [0, 1, 2, 3, 4] <- arr2 
```

所以这里`arr1`, 和`arr2`都指向同一个数组。因此，您使用的任何修改`arr1`都将在您访问数组时反映出来，`arr2`因为您正在查看同一个数组。制作副本时不会发生这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:33:17.053

这里的问题是您需要将数组视为对象。您存储的`objArr1`是一个引用数组开头的内存地址。因此，例如，如果`objArr1`数组存储在地址 0x1234578 则实际的值`objArr1`是 0x1234578 当你说

```
objArr2 = objArr1; 
```

你说的值`objArr2`应该等于0x1234578。现在，如果您更改存储在 0x1234578 的数组的元素之一，那么无论您引用它`objArr1[1]`还是使用`objArr2[1]`该值都将是相同的。如果您尝试更改其中一个，情况也是如此：您对其中一个所做的任何事情都会反映在另一个上，因为它们指向同一个地方。例如下面的代码将是真的

```
objArr2 = objArr1;
objArr2[0] = 5;
objArr1[0] = 6;
System.out.println(objArr2[0]); //prints "6" 
```

有时这种行为很有用，但不会产生副本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T21:14:18.750

### 对于基元

考虑以下示例：

```
public class Example {

    //this class just uses the reference as you suggest
    public static class ArrayEater {

        private final int[] food;

        public ArrayEater(final int[] food) {
            this.food = food; // references same array, does not crate copy
        }

        public void eat() {
            for (int index = 0; index < food.length; index++) {
                final int bite = food[index];
                if (bite == 0) {
                    System.out.println("No food at position " + index);
                } else {
                    System.out.println("Eating " + bite + " from position " + index);
                }
                food[index] = 0;
            }
        }
    }

    //this class makes an actual copy
    public static class ArrayCopyThenEatEater {

        private final int[] food;

        public ArrayCopyThenEatEater(final int[] food) {
            this.food = new int[food.length]; // creates new array
            for (int index = 0; index < food.length; index++) { //copies over the values
                this.food[index] = food[index];
            }
        }

        public void eat() {
            for (int index = 0; index < food.length; index++) {
                final int bite = food[index];
                if (bite == 0) {
                    System.out.println("No food at position " + index);
                } else {
                    System.out.println("Eating " + bite + " from position " + index);
                }
                food[index] = 0;
            }
        }
    }

    public static void main(String[] args) {

        int[] originalArray = {1,3,6,9};
        ArrayEater eater = new ArrayEater(originalArray);
        eater.eat(); 
        eater.eat(); 
        for (int index = 0; index < originalArray.length; index++) {
            System.out.println("Original array has value of " + originalArray[index] + " at position " + index);
        }

        originalArray = new int[]{1,3,6,9};
        ArrayCopyThenEatEater copyEater = new ArrayCopyThenEatEater(originalArray);
        copyEater.eat(); 
        copyEater.eat(); 
        for (int index = 0; index < originalArray.length; index++) {
            System.out.println("Original array has value of " + originalArray[index] + " at position " + index);
        }
    }

} 
```

如果你看一下 main 方法，你会看到 an`originalArray`被创建并传递给了两个“食者”。其中一个食者只是按照您的建议引用 originalArray，另一个食者创建了一个实际的副本（就像您的教授试图说的那样，对于原始人来说，这个副本既浅又深）。

运行它会创建以下输出：

```
Eating 1 from position 0
Eating 3 from position 1
Eating 6 from position 2
Eating 9 from position 3
No food at position 0
No food at position 1
No food at position 2
No food at position 3
Original array has value of 0 at position 0  <-- here we see that the eater ate the original!!
Original array has value of 0 at position 1
Original array has value of 0 at position 2
Original array has value of 0 at position 3
Eating 1 from position 0
Eating 3 from position 1
Eating 6 from position 2
Eating 9 from position 3
No food at position 0
No food at position 1
No food at position 2
No food at position 3
Original array has value of 1 at position 0 <-- here we see that the eater did not eat the original!!
Original array has value of 3 at position 1
Original array has value of 6 at position 2
Original array has value of 9 at position 3 
```

查看上面的内容，您可以看到您的方法导致原始数组的内容被覆盖，而您的教授建议的复制方法不会更改原始数组。

* * *

### 对于非原始人

在这里，我们有一个`Food`已经被吃掉或者没有被吃掉的类。我们有 3 个吃者，参考副本、浅副本和深副本各一个：

```
public class Example {

    public static class Food implements Cloneable {
        private boolean eaten = false;
        public void eat() {
            eaten = true;
        }
        public boolean isEaten() {
            return eaten;
        }
        public Food clone() {
            try {
                return (Food) super.clone();
            } catch (CloneNotSupportedException e) {
                return null; //we won't get here
            }
        }
    }

    public static class ReferenceEater {

        private final Food[] food;

        public ReferenceEater(final Food[] food) {
            this.food = food; // references same array, does not crate copy
        }

        public void eat() {
            for (int index = 0; index < food.length; index++) {
                final Food bite = food[index];
                if (bite.isEaten()) {
                    System.out.println("No food at position " + index);
                } else {
                    System.out.println("Eating from position " + index);
                    bite.eat();
                }
            }
        }
    }

    public static class ShallowEater {

        private final Food[] food;

        public ShallowEater(final Food[] food) {
            this.food = new Food[food.length]; // creates new array
            for (int index = 0; index < food.length; index++) {
                this.food[index] = food[index]; //shallow copy still references same elements!
            }
        }

        public void eat() {
            for (int index = 0; index < food.length; index++) {
                final Food bite = food[index];
                if (bite.isEaten()) {
                    System.out.println("No food at position " + index);
                } else {
                    System.out.println("Eating from position " + index);
                    bite.eat();
                }
            }
        }
    }

    public static class DeepEater {

        private final Food[] food;

        public DeepEater(final Food[] food) {
            this.food = new Food[food.length]; // creates new array
            for (int index = 0; index < food.length; index++) {
                this.food[index] = food[index].clone(); //deep copy also copies the elements!
            }
        }

        public void eat() {
            for (int index = 0; index < food.length; index++) {
                final Food bite = food[index];
                if (bite.isEaten()) {
                    System.out.println("No food at position " + index);
                } else {
                    System.out.println("Eating from position " + index);
                    bite.eat();
                }
            }
        }
    }

    public static void main(String[] args) {

        Food[] originalArray = {new Food(), new Food(), new Food()};
        ReferenceEater referenceEater = new ReferenceEater(originalArray);
        referenceEater.eat(); 
        referenceEater.eat(); 
        for (int index = 0; index < originalArray.length; index++) {
            System.out.println("Food at position " + index + " has been eaten?  " + originalArray[index].isEaten());
        }

        originalArray = new Food[]{new Food(), new Food(), new Food()};
        ShallowEater shallowEater = new ShallowEater(originalArray);
        shallowEater.eat(); 
        shallowEater.eat(); 
        for (int index = 0; index < originalArray.length; index++) {
            System.out.println("Food at position " + index + " has been eaten?  " + originalArray[index].isEaten());
        }

        originalArray = new Food[]{new Food(), new Food(), new Food()};
        DeepEater deepEater = new DeepEater(originalArray);
        deepEater.eat(); 
        deepEater.eat(); 
        for (int index = 0; index < originalArray.length; index++) {
            System.out.println("Food at position " + index + " has been eaten?  " + originalArray[index].isEaten());
        }
    }

} 
```

请注意，深拷贝还复制了数组的各个元素。

现在看看输出：

```
Eating from position 0
Eating from position 1
Eating from position 2
No food at position 0
No food at position 1
No food at position 2
Food at position 0 has been eaten?  true
Food at position 1 has been eaten?  true
Food at position 2 has been eaten?  true
Eating from position 0
Eating from position 1
Eating from position 2
No food at position 0
No food at position 1
No food at position 2
Food at position 0 has been eaten?  true
Food at position 1 has been eaten?  true
Food at position 2 has been eaten?  true
Eating from position 0
Eating from position 1
Eating from position 2
No food at position 0
No food at position 1
No food at position 2
Food at position 0 has been eaten?  false
Food at position 1 has been eaten?  false
Food at position 2 has been eaten?  false 
```

在这里，我们看到，与原语一样，引用副本导致原件再次被吃掉。但是看一下浅拷贝，我们得到的和上面的图元的深/浅拷贝是一样的，这次食物已经在原来的状态下被吃掉了（与原语不同！）。这是因为虽然我们创建了一个新数组，但我们传入了对相同 Food 实例的引用。最后，通过深度副本，我们看到原始数组食物项没有被吃掉，因为食者吃了这些食物的克隆。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T20:28:15.273

您的示例使用数组，所以我将坚持使用它们作为示例。数组实际上只是“分区”的内存块（基于类型）。类似 int[] a 的值是该数组的起始内存地址。当您执行 int[] a = someOtherArray 时，您正在为其分配另一个内存位置的地址，而不是它们存储的值。因此，您必须逐个元素地分配存储在每个位置的值。

# tomcat - 应用程序上下文 url 在 tomcat 中部署后给出 404

> ID：13166886
> 
> 赞同：0
> 
> 时间：2012-10-31T20:24:09.157
> 
> 标签：tomcat, deployment, http-status-code-404

我在 eclipse for dev 中的 tomcat 7.0.36 上部署了一个应用程序。当我对应用程序进行更改时，Tomcat 被配置为热重新部署。此应用程序使用 JPA 和 Hibernate 作为提供程序和 MySQL 5。但是，一旦我构建了一个战争并部署到一个独立的 tomcat，应用程序就会得到：

```
java.sql.SQLException: Access denied for user 'root'@'localhost' (using password: YES) 
```

在尝试使用 persistence.xml 文件中定义的相同凭据连接到同一数据库时。

另一个问题是，在具有不同凭据的另一台机器上，连接成功，除了在访问应用程序上下文 url 时，我不断得到一个`404`. 首先，我认为这可能是与 tomcat 相关的问题，所以我尝试部署到 jetty 7 ......结果相同。

我将文件的标题更改`web.xml`为 Servlet 3.0 而不是 2.5，但这确实解决了问题。

# android - 秒表不工作

> ID：13166890
> 
> 赞同：0
> 
> 时间：2012-10-31T20:24:36.187
> 
> 标签：android

我可以看到日期和时间的线程正在运行。但是秒表没有线程。可能是什么问题呢？

公共类 MainActivity 扩展 Activity {

```
private Button Start, Reset, Stop;
private EditText stop_watch, lblDate, lblTime;

public MainActivity() {

}

private final UpdateClockThread ucThread = new UpdateClockThread();
private final StopwatchThread swThread = new StopwatchThread();

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    Start = (Button)findViewById(R.id.button1);
    Stop = (Button)findViewById(R.id.button3);
    Reset = (Button)findViewById(R.id.button2);
    stop_watch = (EditText)findViewById(R.id.editText3);
    lblTime = (EditText)findViewById(R.id.editText2);
    lblDate = (EditText)findViewById(R.id.editText1);

    init();

    Start.setOnClickListener(new View.OnClickListener()
    {
        public void onClick(View v)
        {
            startactionPerformed();
        }
    });

    Stop.setOnClickListener(new View.OnClickListener()
    {
        public void onClick(View v)
        {
            stopactionPerformed();
        }
    });

    Reset.setOnClickListener(new View.OnClickListener()
    {
        public void onClick(View v)
        {
            resetactionPerformed();
        }
    });

}

public void init() {
swThread.setDaemon(true);
ucThread.setDaemon(true);
swThread.start(); // this doesent seem to wrk..
ucThread.start();
}

/** Listens to the Start/Stop/Resume button. */

void startactionPerformed() {
    swThread.go();
}

void stopactionPerformed() {
    swThread.noGo();
}

void resetactionPerformed() {
    swThread.reset();
}

/** A thread that updates the current date & time. */
private class UpdateClockThread extends Thread {
/** The actual work of the thread. */
    public void run() {
        while (true) {
            MainActivity.this.runOnUiThread(new Runnable() {
                public void run() {
                    Calendar now = Calendar.getInstance();
                    String month = Integer.toString(now.get(Calendar.MONTH)+1);
                    String date = Integer.toString(now.get(Calendar.DAY_OF_MONTH));
                    String year = Integer.toString(now.get(Calendar.YEAR));
                    String hour = Integer.toString(now.get(Calendar.HOUR));
                    if (hour.equals("0")) hour = "12";
                    String minute = Integer.toString(now.get(Calendar.MINUTE));
                    if (minute.length() == 1) minute = "0" + minute;
                    String second = Integer.toString(now.get(Calendar.SECOND));
                    if (second.length() == 1) second = "0" + second;
                    String ampm = now.get(Calendar.AM_PM) == Calendar.AM ? "AM" : "PM";
                    lblDate.setText(month + "/" + date + "/" + year);
                    lblTime.setText(hour + ":" + minute + ":" + second + " " + ampm);
                }
            });

            try {
                sleep(500);
            } catch (InterruptedException e) {} 
        }
    }
}

/** A thread that keeps track of the stop watch & updates
 * the display accordingly.
*/
class StopwatchThread extends Thread {
    /** Whether or not stop watch is running. */
    private boolean going = false;
    /** Stores elapsed milliseconds of previous runs. */
    private long prevElapsed = 0;
    /** Stores beginning time of this run. */
    private Date startDate = new Date();

    /** Returns elapsed time in milliseconds.
     *@return The elapsed time
     */
    private long elapsedTime() {
        return prevElapsed + (going ? new Date().getTime() - startDate.getTime() : 0);
    }
    /** Changes the number of elapsed milliseconds into a string.
     *@param time Number of elapsed milliseconds
     *@return The elapsed time as a string.
     */
    private String msToString(long time) {
        String ms, sec, min;
        if (time % 10 >= 5) //round to nearest hundredth
            time += 5;
        ms = Long.toString(time % 1000);
        while (ms.length() < 3)
            ms = "0" + ms;
        ms = ms.substring(0, ms.length() - 1);
    time /= 1000;
    sec = Long.toString(time % 60);
    if (sec.length() == 1) sec = "0" + sec;
    time /= 60;
    min = Long.toString(time);
    stop_watch.setText(min);
    return min + ":" + sec + "." + ms;
}

    /** Called when the stop watch is to go.
    */
    public void go() {
        startDate = new Date();
        going = true;
    }
    /** Called when the stop watch is to stop.
     */
    public void noGo() {
        prevElapsed = elapsedTime();
        going = false;
    }
    /** Resets the stop watch.
     */
    public void reset() {
        going = false;
        prevElapsed = 0;
    }
    /** Adds a lap to the list.
     */

    /** Main code of the thread.
     */

    public void run() {

        MainActivity.this.runOnUiThread(new Runnable() {
            public void run() {
                stop_watch.setText(msToString(elapsedTime()));          
            }
        });
        yield();
    }
} 
```

}

我可以看到日期和时间的线程正在运行。但是秒表没有线程。可能是什么问题呢？

我如何启动秒表线程..请帮助..

我的程序中有两个守护线程..但日志显示只有一个处于活动状态..即使我终止了活动线程。秒表仍然不工作。我尝试了很多。但我无法弄清楚问题出在哪里..

DalvikVM[本地主机:8633]

线程 [<1> main]（正在运行）

线程 [<8> 活页夹线程 #2]（正在运行）

线程 [<7> 活页夹线程 #1]（正在运行）

守护线程 [<10> Thread-10]（运行中）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:38:31.660

问题在于您的 StopwatchThread 的`run()`方法。

它在 UI 线程上运行单个任务（调用`stop_watch.setText()`），然后停止。您没有任何类型的循环，即使您定义了一个看起来很有希望的“进行”变量。

添加一个类似于 UpdateClockThread 中的 while 循环，我想您会发现它按预期工作。

# javascript - pdf 中的单选按钮值（javascript 计算）

> ID：13166896
> 
> 赞同：0
> 
> 时间：2012-10-31T20:24:55.897
> 
> 标签：javascript, pdf

我有一个正在 Adob​​e Pro 中创建的表单。

“总计”字段由选择的各种单选按钮确定。

我的第一步是给每个单选按钮一个值。

我的一组单选按钮称为“选项”-单选按钮 1：“15”单选按钮 2：“25”

我可以使用什么 javascript 将所选单选按钮的值（15 或 25）放入我的“Grandtotal”字段中？

我尝试了以下方法：

```
var option1 = this.getField("Options");
var option2 = this.getField("Options");

var total = this.getField("Grandtotal").value;
event.value = option1 or option2 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:35:41.193

我不知道在 PDF 中使用 Javascript，但是我在网上找到的，看起来你应该使用这样的东西：

```
var option1 = this.getField("Options1");  // Get first radio button
var option2 = this.getField("Options2");  // Get second radio button
var total = this.getField("Grandtotal");  // Get grand total textbox

if (option1.checked) {
    total.value = option1.value;
} else if (option2.checked) {
    total.value = option2.value;
} 
```

现在，我不确定您所说的 是什么意思`my set of radio buttons is called "Options"`，因为这意味着检索单选按钮字段可能会有所不同。

# javascript - Hashtag ajax 无法始终如一地工作

> ID：13166898
> 
> 赞同：0
> 
> 时间：2012-10-31T20:24:59.507
> 
> 标签：javascript, html, ajax

我正在关注[这个](http://css-tricks.com/examples/DynamicPage/)页面来制作一个 ajax 网站。这相当简单，但我遇到的问题是链接，它们只是

```
 <a href="link.html">Link</a> 
```

倾向于忽略主题标签更改并直接转到导致重新加载的 link.html 页面，而不是使用 ajax 来更新内容。

当我点击后退按钮时，ajax 部分工作，然后当我从那里单击链接时它工作 - 知道第一次登陆页面时导致这种行为的原因是什么吗？

我正在使用来自 jQuery UI 的导航器菜单，如果您需要更多信息，请告诉我，我会尽快发布。

谢谢您的帮助！

这是控制 ajax 行为的 dynamic.js 文件：

```
$(function() {

    var newHash      = "",
        $mainContent = $("#main-content"),
        $pageWrap    = $("#page-wrap"),
        baseHeight   = 0,
        $el;

    $pageWrap.height($pageWrap.height());
    baseHeight = $pageWrap.height() - $mainContent.height();

    $("nav").delegate("a", "click", function() {
        window.location.hash = $(this).attr("href");
        return false;
    });

    $(window).bind('hashchange', function(){

        newHash = window.location.hash.substring(1);

        if (newHash) {
            $mainContent
                .find("#guts")
                .fadeOut(200, function() {
                    $mainContent.hide().load(newHash + " #guts", function() {
                        $mainContent.fadeIn(200, function() {
                            $pageWrap.animate({
                                height: baseHeight + $mainContent.height() + "px"
                            });
                        });
                        $("nav a").removeClass("current");
                        $("nav a[href='"+newHash+"']").addClass("current");
                    });
                });
        };

    });

    $(window).trigger('hashchange');

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:48:48.687

在将点击事件分配给链接时，您是否尝试过使用 preventDefault() ？

```
$("nav").delegate("a", "click", function(e) {
        e.preventDefault();
        window.location.hash = $(this).attr("href");
        return false;
    }); 
```

return false 应该做的工作，但只是为了确定

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:01:45.693

当我查看页面的源代码时，您拥有执行此操作的代码：

```
$( "#menu" ).menu({

}); 
```

在其中，你有：

```
location.href = link.attr( "href" ); 
```

我有一种感觉，因为除了您的`hashchange`处理之外，它还在执行它，它被调用并覆盖（以任何方式）AJAX 加载内容。如果您删除/评论该行，它可能会起作用，但请确保您的网站在进行此更改后仍然可以正常运行。

# silverlight - Silverlight OOB 应用程序仍然可以从网站运行吗

> ID：13166907
> 
> 赞同：0
> 
> 时间：2012-10-31T20:25:50.177
> 
> 标签：silverlight, silverlight-4.0, silverlight-5.0, silverlight-oob

大家好 stackoverflow，我创建了一个用 Silverlight 5 (vb) 设计和编写的小型应用程序。我选择为应用程序使用浏览器外设置 (oob)，因为我不想将整个页面仅用于小型计算器应用程序。我的问题是：我是否仍然可以从在线网站附加和运行 oob 应用程序，而无需用户下载它才能使用它？部署到服务器的过程是什么？我假设一旦部署到服务器，来自网页的链接将启用应用程序的运行？我是这个领域的新手，所以任何建议都将不胜感激。亲切的问候威尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:25:55.347

是的当然。OOB 模式只是增加了一些安全权限（并且可以作为桌面应用程序安装），但它仍然会从 Web 源下载。

# java - Common Iterator 错误的解释

> ID：13166908
> 
> 赞同：2
> 
> 时间：2012-10-31T20:25:50.937
> 
> 标签：java, collections, iterator

```
import java.io.*;
import javax.swing.JOptionPane;
import java.util.*;

public class lesson {
     static void printAll(ArrayList<String> names, int len)
      {
         Iterator it = names.iterator();
         while( it.hasNext() )
         {
         if( ((String)it.next()).length() == len)
         System.out.println( it.next() );
         }
      }
    public static void main(String[] args) throws IOException {
        ArrayList<String> names = new ArrayList<String>();
        names.add("Jan");
        names.add("Ivan");
        names.add("Tom");
        names.add("George");
        printAll(names,3);
    }
} 
```

为什么输出 Ivan, George 不应该只打印长度为 3 的名称（即 Jan 和 Tom）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T20:26:57.617

```
if( ((String)it.next()).length() == len)
         System.out.println( it.next() );
         } 
```

`it.next()`将迭代器推进到一个元素。你正在做`it.next()`两次。

`if( ((String)it.next()).length() == len)`前进一次，现在迭代器指向 next()

将其更改为如下所示：

```
 it.next() prints next() element in iterator.
      {
       //Get once.
        String nextName = (String)it.next();
         if( nextName .length() == len)
         System.out.println(nextName  );
       } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T20:28:30.703

帮自己一个忙，学习使用*增强的 for*循环，它可以防止你犯下你所犯的错误：

```
 static void printAll(ArrayList<String> names, int len)
 {
     for (String name : names) {
       if (name.length() == len)
         System.out.println( name );
     }
 } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T20:27:35.303

你调用 iterator.next() 两次，第二次调用会提前。按照以下方法，将其存储在变量中并进行检查

```
 Iterator it = names.iterator();
   String next =(String)it.next(); 
         while( it.hasNext() )
         {
         if( (next).length() == len)
         System.out.println( next );
         } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-31T20:28:52.107

更改以下内容以避免两次`it.next()`调用，因为它比较一个元素的长度和可用性并尝试打印另一个元素。

```
 while( it.hasNext() )
     {
       if( ((String)it.next()).length() == len)
       System.out.println( it.next() );
     } 
```

到

```
 while( it.hasNext() )
     {
       String element = (String)it.next();
       if(element.length() == len)
          System.out.println( element);
     } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-31T20:28:55.070

如果您想要两次值，则将其存储在某个变量中。如果您调用它两次，那么您的迭代器将继续前进，这就是为什么在打印时它会为您提供该结果

```
while( it.hasNext() )
     {
       String str = it.next();
        if( (str.length() == len)
          System.out.println(str);
     } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-31T20:34:22.680

呼吁`it.next()`

1.  返回集合中的当前元素。
2.  **并**推进迭代器的位置。

你在循环体中调用`next()`了两次。您应该确保只调用一次：

```
for (Iterator<String> it = names.iterator(); it.hasNext();) {
    String name = it.next();
    if (name.length() == len) {
        System.out.println(name);
    }
} 
```

或使用*增强的 for 循环*：

```
for (String name : names) {
    if (name.length() == len) {
        System.out.println(name);
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-31T20:32:25.490

这应该做你想要的。仅打印 ArrayList 中每个字符串的 3 个字符：

```
import java.io.*;
import javax.swing.JOptionPane;
import java.util.*;

public class lesson {
 static void printAll(ArrayList<String> names, int len)
  {
     for (String s : names)
     if (s.length() == len)
     {
     System.out.println(s);
     }
  }
  public static void main(String[] args) throws IOException {
    ArrayList<String> names = new ArrayList<String>();
    names.add("Jan")
    names.add("Ivan");
    names.add("Tom");
    names.add("George");
    printAll(names,3);
   }
} 
```

# javascript - Javascript - Cannot set property 'backgroundColor'

> ID：13166909
> 
> 赞同：8
> 
> 时间：2012-10-31T20:26:03.137
> 
> 标签：javascript, jquery, undefined

I'm trying to make a website, but I'm having a problem. When I run it in Chrome I get: "Cannot set property 'backgroundColor' of undefined". I don't understand why I'm getting this. My var is not an array (just an id). I've been googling it for 2 hours but nothing helps me.

Here's my HTML code:

```
 $(document).ready
    (
	function()
	{
		$("#go").bind("click", remonte)
    }
    );

    function remonte(){	
	$("#menu").animate({marginTop: "-460"}, 500);
	$("#ar").animate({marginTop: "120"}, 500);
	$("#reste").animate({height: "500", marginTop: "-50"},400);
	$("#go").remove();	
	setTimeout(charge, 510); 	
    }

    function charge(){
        $('#reste').load("about.html",'',montreNouveauContenu);
        $("#surmenu").style.backgroundColor="transparent"; //HERE
        $("#menu_jaune").animate({width: "900"}, 500);
    }

    function montreNouveauContenu() {  
	$('#content').show('normal');  
    }  
    function suppr(){
	$("#dev").remove();
	$("#reste").remove();
	$("#content").remove();
	$("#bandeau_graphisme").animate({height: "255"},500);
    }
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr">
	<head>
		<title>Folio</title>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
		<link rel="stylesheet" type="text/css" href="style.css"/>
		<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
		<script type="text/javascript" src="anim2.js"></script>		 
	</head>
	<body>
		<div id="tout">
			<img id="menu_jaune" src="https://dummyimage.com/150x200/000/fff" alt="le menu"/></td>
			<div id="bandeau_graphisme">
				<img id="dev" src="https://dummyimage.com/150x200/000/fff" alt="image de couverture du site"/>
			</div>
			<div id="surmenu">
				<div id="menu">
					<img id="ar" src="https://dummyimage.com/150x200/000/fff" alt="ar"/>
				</div>
			</div>
			<div id="go">
				<p id="wtf">HERE WE GO! Click Here</p>
			</div>
			<div id="reste">
			</div>
		</div>
	</body>
</html>
```

Thank you in advance.

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-31T20:27:17.103

It's because a jQuery object doesn't have a `style` property.

```
 // ---------v----???
$("#surmenu").style.backgroundColor="transparent"; //HERE 
```

* * *

It should be like this:

```
$("#surmenu").css("backgroundColor", "transparent"); 
```

* * *

If you wanted to use the DOM API, you could do a traditional DOM selection:

```
document.getElementById("surmenu").style.backgroundColor="transparent"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T20:27:20.857

This is a jQuery object, not an element, so it has no `style` property. You want this:

```
$("#surmenu")[0].style.backgroundColor="transparent"; //HERE 
```

or this ...

```
$("#surmenu").get(0).style.backgroundColor="transparent"; //HERE 
```

or this ...

```
$("#surmenu").css( 'background-color', 'transparent' ); //HERE 
```

# jquery - 覆盖现有功能 Jquery

> ID：13166910
> 
> 赞同：0
> 
> 时间：2012-10-31T20:26:13.527
> 
> 标签：jquery

我正在从服务器动态获取 html。当用户加载某些 html 时，我想覆盖 listview 过滤的功能，如下所示：

```
 $("#myList").listview('option', 'filterCallback', function (text, searchValue) {
    //console.log(text);  
    $("li[data-groupoptions]").removeClass('override-ui-screen-hidden');
    $("li[data-groupoptions*="+searchValue.toLowerCase()+"]").addClass('override-ui-screen-hidden');
    return text.toLowerCase().indexOf( searchValue ) === -1;
});​ 
```

问题是当我将此代码注入我的 javascript 时，它会破坏我所有的 javascript。我在这里有语法问题，或者我没有正确地调用它或其他东西。

我想将此代码添加到我已有的此功能中

```
 function loadA() {

        ClearDescendant().success(function () {
            loadPage("apls", "alData", "alHeader", "alFooter");

         //ADD IT HERE????

        });
    } 
```

我如何简单地让这段代码可以运行“以防万一”页面上有一个带有“mylist”的列表视图的html，有时“loadA（）”不返回一个ID为“mylist”的列表视图，但代码是除此之外只是打破。我不确定如何调用或将此代码放在哪里，以便在从其中包含“myList”的“loadPage()”返回 html 时可用

代码在这里工作正常 [http://jsfiddle.net/DCkDp/25/](http://jsfiddle.net/DCkDp/25/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:13:35.050

当您将 listview 声明放在负载处理程序函数中时，它是否会中断：

```
$("#myList").load( function() { 

     // insert listview override here.

}); 
```

# php - SELECTing from MySQL based on Previous Refined MySQL Query

> ID：13166911
> 
> 赞同：1
> 
> 时间：2012-10-31T20:26:13.563
> 
> 标签：php, mysql

真的不想问这个，因为我确信它很简单，但是：

我有一个用户数据库，其中包括邮政编码（邮政编码）和出生日期的字段。

访问者可以按年龄和到他们自己位置的距离来搜索用户。为此，我必须选择所有用户，然后计算他们的年龄，然后计算他们的距离，如下所示：

```
$result = queryMysql("SELECT user FROM table WHERE user !='$user' ORDER BY joindate DESC ");
$num = mysql_num_rows($result);

for ($j = 0 ; $j < $num ; ++$j)
{
$row = mysql_fetch_row($result);
if ($row[0] == $user) continue;

$query = "SELECT * FROM table WHERE user='$row[0]'";
$res=mysql_query($query);
$users=mysql_fetch_assoc($res);

//Get Date of Birth and Calculate Age
$dob = $users['age'];
$age = ...

//Get Profile's Postcode and Calculate Distance 
$profilepc = $views['postcode'];
$distance = ...

if(($distance <200) AND ($age >18 AND <30)) {

} 
```

到目前为止，没有问题。但是，然后我想运行另一个查询（用于分页），仅选择那些符合访问者设置的年龄和距离参数的用户，我可以在上面的 IF 语句中回显，但我不知道如何包含在新查询。

那么，我如何将第一个查询的结果放入某个东西（一个数组？），然后使用第一个查询中的 user_id（它们是唯一的）来只选择我的分页所需的用户？就像是：

```
SELECT * FROM $table WHERE user_id=(filtered user_id's) ORDER BY joindate DESC 
```

我希望这是有道理的。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T20:27:27.257

使用`IN`代替`=`

```
SELECT * FROM $table
WHERE user_id IN (select user_id from other_table where some_condition) 
ORDER BY joindate DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:32:01.387

您可以为您的子句使用子查询`IN`，或者如果您已经有一个 ID 的 PHP 数组：

```
// assuming your array of IDs is
$user_ids = array(1, 2, 3, 4);

// use implode() to create a comma separated list for use in your IN clause
$query = "SELECT * FROM {$table}
WHERE user_id IN (" . implode(',', $user_ids) . ") 
ORDER BY joindate DESC;" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T21:06:10.830

如果你可以用 SQL 做一些事情，那么它是最好和最快的选择。下面的查询将选择所有用户，但年龄（以年为单位）超过 30 岁的用户除外。

我无法为距离编写 SQL，因为我不知道您的数据，因此不知道如何计算它。但是我添加了一些可以添加的地方。

“limit”子句将获取数据库中从 10 到 20 的记录。

```
 SELECT 
       * 
    FROM 
       table
    WHERE 
       user != $user
       and (
           (year(now()) - year(table.birthday))  > 30
           or (some match to calculate distance)
        )
    limit 10, 20 
```

如果您需要来自另一个表的更多数据，您可以像这样将它们连接在一起。

```
 SELECT 
       * 
    FROM 
       table
       another_table
    WHERE 
       another_table.user = table.user
       table.user != $user
       and (
           (year(now()) - year(table.birthday))  > 30
           or (some match to calculate distance)
        )
    limit 10, 20 
```

与在数据库中选择相比，以任何语言制作多个选择和循环数据都比较慢。

# python - Linear Interpolation using numpy.interp

> ID：13166914
> 
> 赞同：10
> 
> 时间：2012-10-31T20:26:22.200
> 
> 标签：python, numpy, interpolation, linear-interpolation

I have a 1 dimensional array A of floats that is mostly good but a few of the values are missing. Missing data is replace with nan(not a number). I have to replace the missing values in the array by linear interpolation from the nearby good values. So, for example:

```
F7(np.array([10.,20.,nan,40.,50.,nan,30.])) 
```

should return

```
np.array([10.,20.,30.,40.,50.,40.,30.]). 
```

What's the best of way of doing this using Python?

Any help would be much appreciated

Thanks

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-31T20:34:01.800

你可以使用[`scipy.interpolate.interp1d`](http://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp1d.html)：

```
>>> from scipy.interpolate import interp1d
>>> import numpy as np
>>> x = np.array([10., 20., np.nan, 40., 50., np.nan, 30.])
>>> not_nan = np.logical_not(np.isnan(x))
>>> indices = np.arange(len(x))
>>> interp = interp1d(indices[not_nan], x[not_nan])
>>> interp(indices)
array([ 10.,  20.,  30.,  40.,  50.,  40.,  30.]) 
```

**编辑**：我花了一段时间才弄清楚是如何`np.interp`工作的，但这也可以完成这项工作：

```
>>> np.interp(indices, indices[not_nan], x[not_nan])
array([ 10.,  20.,  30.,  40.,  50.,  40.,  30.]) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-31T20:39:56.347

我会去`pandas`。使用oneliner的简约方法：

```
from pandas import *
a=np.array([10.,20.,nan,40.,50.,nan,30.])
Series(a).interpolate()   

Out[219]:
0    10
1    20
2    30
3    40
4    50
5    40
6    30 
```

或者，如果您想将其保留为数组：

```
Series(a).interpolate().values

Out[221]:
array([ 10.,  20.,  30.,  40.,  50.,  40.,  30.]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-24T20:22:15.533

每次要插入数据时，不要在 Series 中创建新的 Series 对象或新项目，请使用[RedBlackPy](https://intuitionengineeringteam.github.io/RedBlackPy/)。请参见下面的代码示例：

```
import redblackpy as rb

# we do not include missing data
index = [0,1,3,4,6]
data = [10,20,40,50,30]
# create Series object
series = rb.Series(index=index, values=data, dtype='float32',
                   interpolate='linear')

# Now you have access at any key using linear interpolation
# Interpolation does not creates new items in Series
print(series[2]) # prints 30
print(series[5]) # prints 40
# print Series and see that keys 2 and 5 do not exist in series
print(series) 
```

最后的输出如下：

```
Series object Untitled
0: 10.0
1: 20.0
3: 40.0
4: 50.0
6: 30.0 
```

# cassandra - Inserting some number values into column family with composite column fails

> ID：13166915
> 
> 赞同：1
> 
> 时间：2012-10-31T20:26:39.287
> 
> 标签：cassandra, astyanax

I face a problem inserting some number values into column family with composite column (Cassandra 1.1.6 using Astyanax 1.0.6 client).

```
AnnotatedCompositeSerializer<DailyPersonal> dailyPersonalSerializer
            = new AnnotatedCompositeSerializer<DailyPersonal>(DailyPersonal.class);
    ColumnFamily<Long, DailyPersonal> CF_DAILY_PERSONAL
            = new ColumnFamily<Long, DailyPersonal>("daily_personal",
            LongSerializer.get(), dailyPersonalSerializer);

    DailyPersonal dailyPersonalSteps = new DailyPersonal(new LocalDate(2012, 1, 1).toDate(), 12348L, "steps");
    DailyPersonal dailyPersonalDistance = new DailyPersonal(new LocalDate(2012, 1, 1).toDate(), 12348L, "distance");

    MutationBatch m = keyspace.prepareMutationBatch();
    m.withRow(CF_DAILY_PERSONAL, 1L)
            .putColumn(dailyPersonalSteps, 333, null)
    ;
    m.withRow(CF_DAILY_PERSONAL, 1L)
            .putColumn(dailyPersonalDistance, 444, null)
    ; 
```

DailyPersonal is defined as:

```
public class DailyPersonal {
@Component(ordinal = 0)
private Date logDate;

@Component(ordinal = 1)
private Long userId;

@Component(ordinal = 2)
private String field;
...
} 
```

Column family definition:

```
CREATE TABLE daily_personal (
  program_id bigint,
  log_date timestamp,
  user_id bigint,
  distance int,
  steps int,
  PRIMARY KEY (program_id, log_date, user_id)
); 
```

The problem arises during inserting some values: i.e. 444 fails, while 333 works fine. I can't figure the dependency, but looks like it fails for a lot of values [0; 1500]. Error message looks like:

```
com.netflix.astyanax.connectionpool.exceptions.BadRequestException: BadRequestException: [host=127.0.0.1(127.0.0.1):9160, latency=19(40), attempts=1] InvalidRequestException(why:(String didn't validate.) [demodb][daily_personal][2012-01-01 00:00:00+0300:12348:distance] failed validation) 
```

I do not see any obvious reasons why it fails. Could someone tell if my code is correct or there any environment/libraries issue?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T20:28:53.900

我刚刚遇到了同样的问题。对于不是复合列的动态列，如果您对数据使用正确的 MutationBatch putColumn 方法，则将使用正确的验证器。但是，对于复合列，无论您选择哪种 MutationBatch putColumn 方法，都将使用列族的默认验证类。

在我看来，这并不一致。但是，有两种解决方法。第一种是简单地将列族中的默认验证类设置为将存储在复合列中的数据类型。根据您发布的输出，我假设它当前是 UTF8Type 并且您正在尝试存储整数。

第二种解决方法是将默认验证类设置为 BytesType。这将允许存储任何数据类型，并且是我的首选解决方案。此解决方案还使您能够在同一行中拥有多个复合列，以存储不同的值类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T09:57:11.807

请查看 github 上的以下 wiki 页面，以获取有关如何将 CQL3 与 astyanax 一起使用的示例。 [https://github.com/Netflix/astyanax/wiki/Cql-and-cql3](https://github.com/Netflix/astyanax/wiki/Cql-and-cql3)。

# powershell - source control plugin for PowerShell Plus

> ID：13166916
> 
> 赞同：2
> 
> 时间：2012-10-31T20:26:43.403
> 
> 标签：powershell, version-control

Propably this is not the right place to ask for this, but here it goes:

I have installed Powershell Plus and I would like to integrate TFS source control to it.

Does anyone know which plugin should I install or what should I do to get it integrated with the TFS source control?

# c# - 使用 DST 从 UTC 转换为美国山区时间

> ID：13166931
> 
> 赞同：9
> 
> 时间：2012-10-31T20:27:44.513
> 
> 标签：c#, timezone

我一直在寻找如何从 UTC 转换为山区时间，我成功地找到了以下每个人都说考虑到 DST 的函数。每当它从 UTC 转换为 Mountain 时，偏移量始终为 -7（当前应该为 -6）。除了它似乎不是。任何人都可以为我阐明这一点，或者让其考虑 DST 的方法吗？

```
DateTime utcTime = new DateTime(createdDate.Ticks, DateTimeKind.Utc);
DateTime mountainTime = TimeZoneInfo.ConvertTimeBySystemTimeZoneId(utcTime, "US Mountain Standard Time"); 
```

谢谢，德曼

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-31T20:35:27.947

看起来 .NET 中有两个区域（至少在我的 Windows 8 安装中）是山区时间。

您正在使用“美国山地标准时间”，但它不遵守 DST（它适用于亚利桑那州）——而普通的“山地标准时间”*确实*遵守 DST。所以你只需要摆脱“美国”部分，它就会起作用：

```
using System;

class Test
{
    static void Main()
    {
        DateTime octoberUtc = new DateTime(2012, 10, 1, 0, 0, 0, DateTimeKind.Utc);
        DateTime decemberUtc = new DateTime(2012, 12, 1, 0, 0, 0, DateTimeKind.Utc);
        ConvertToMountainTime(octoberUtc);
        ConvertToMountainTime(decemberUtc);
    }

    static void ConvertToMountainTime(DateTime utc)
    {
        DateTime mountain = TimeZoneInfo.ConvertTimeBySystemTimeZoneId
            (utc, "Mountain Standard Time");

        Console.WriteLine("{0} (UTC) = {1} Mountain time", utc, mountain);
    }
} 
```

输出（英国文化）：

```
01/10/2012 00:00:00 (UTC) = 30/09/2012 18:00:00 Mountain time
01/12/2012 00:00:00 (UTC) = 30/11/2012 17:00:00 Mountain time 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:31:54.353

山区标准时间仍然是-7。与流行的看法相反，我们不会改变我们的时间，而是我们的时**区**。我们当前的时区实际上是山区夏令时。弄清楚时区信息是……令人不快

# python - 为什么我得到一个（看似）正确拆分的字符串的 IndexError？

> ID：13166940
> 
> 赞同：1
> 
> 时间：2012-10-31T20:28:36.987
> 
> 标签：python, indexing, split, urllib2

我目前有一个脚本应该获取并返回 Bit.ly 链接的点击次数。我首先从 Bitly url 收集和读取数据，这似乎是正确的。

```
 bitly_data = "https://api-ssl.bitly.com/v3/link/clicks?access_token=ACCESS_TOKEN&link=http://bit.ly/"+link
    src = urllib2.urlopen(bitly_data)
    src = src.read() 
```

When `link`is something such as `TY8lnd`,`src`是一个看起来像的字符串

> {“status_code”：200，“data”：{“units”：-1，“tz_offset”：-4，“unit”：“day”，“link_clicks”：535}，“status_txt”：“OK”}

我现在想解析这个字符串以获取 . 之后的数值`link_clicks`。我认为最好的方法是进行两次拆分。

```
 src=src.split('clicks": ')
    src = str(src[1])
    clicks = src.split('}, "status')
    clicks = clicks[0] 
```

当我运行它时，clicks 最终会等于正确的数字，并且仅此而已。但是，终端为 line 返回一个 IndexError `src = str(src[1])`。我试图摆脱，`str()`但这没有效果。尽管最终值已得到纠正，但如果能理解为什么我会收到此错误，将不胜感激。

这是完整的追溯：

```
Traceback (most recent call last):
  File "/Library/Python/2.7/site-packages/Flask-0.9-py2.7.egg/flask/app.py", line 1701, in __call__
    return self.wsgi_app(environ, start_response)
  File "/Library/Python/2.7/site-packages/Flask-0.9-py2.7.egg/flask/app.py", line 1689, in wsgi_app
    response = self.make_response(self.handle_exception(e))
  File "/Library/Python/2.7/site-packages/Flask-0.9-py2.7.egg/flask/app.py", line 1687, in wsgi_app
    response = self.full_dispatch_request()
  File "/Library/Python/2.7/site-packages/Flask-0.9-py2.7.egg/flask/app.py", line 1360, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/Library/Python/2.7/site-packages/Flask-0.9-py2.7.egg/flask/app.py", line 1358, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Library/Python/2.7/site-packages/Flask-0.9-py2.7.egg/flask/app.py", line 1344, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
  File "/Users/Zach/Dropbox/bitly/bit.py", line 35, in settings
    src = str(src[1])
IndexError: list index out of range 
```

先感谢您。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T20:30:10.103

此响应是 json，因此，解码 json 而不是尝试解析字符串。

```
>>> import json
>>> resp = '{"status_code": 200, "data": {"units": -1, "tz_offset": -4, "unit": "day", "link_clicks": 535}, "status_txt": "OK"}'
>>> resp_object = json.loads(resp)
>>> resp_object and resp_object.get('data', {}).get('link_clicks', 0) or 0
535 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T20:37:43.143

`src`看起来像它的JSON。为什么不用`json`模块直接读取呢？

无论出于何种原因，如果您不想使用`json`，请继续阅读：

该错误是由于您假设您拆分的子字符串存在于您拆分的字符串中，即`'clicks": '`确实是`src`. 如果不是这种情况（因为我怀疑它不是在引发错误时），则`split`返回一个列表，其中只有一个元素，并且该元素是`src`.

如果您更喜欢在这种情况下，那`src[1]`应该在调用后给您一个空字符串`src = src.split('clicks": ')`，那么您最好使用`str.partition`：

```
In [5]: somestr = 'prefixclicks: "suffix'

In [6]: somestr.partition('clicks: "')
Out[6]: ('prefix', 'clicks: "', 'suffix')

In [7]: somestr.partition('clicks: "')[-1]
Out[7]: 'suffix'

In [8]: somestr = 'prefixsuffix'

In [9]: somestr.partition('clicks: "')
Out[9]: ('prefixsuffix', '', '')

In [10]: somestr.partition('clicks: "')[-1]
Out[10]: '' 
```

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:34:51.230

你可以试试这个来找出 的值`link_clicks`，使用`ast.literal_eval()`：

```
In [14]: import ast

In [15]: src=`{"status_code": 200, "data": {"units": -1, "tz_offset": -4, "unit": "day", "link_clicks": 535}, "status_txt": "OK"}`

In [16]: d=ast.literal_eval(src)

In [17]: d["data"]["link_clicks"]
Out[17]: 535 
```

# .net - 对象数据源

> ID：13166941
> 
> 赞同：1
> 
> 时间：2012-10-31T20:28:37.940
> 
> 标签：.net, accordion, objectdatasource

好人我提前为我的基本英语道歉。我的问题如下我在手风琴内放置了一个gridview，在另一个手风琴内。每个人都关联到一个对象数据源。现在，每个对象数据源都有一个用于编写 e.InputParameters 的 onselecting 事件。问题是我要编写的参数之一是在包含对象数据源的项目的数据项中。

obselected函数的args是：ByVal sender As Object, ByVal e As System.Web.UI.WebControls.ObjectDataSourceSelectingEventArgs

第一个是没有命名容器的 ObjectDataSourceView。而且我无法从 ObjectDataSourceSelectingEventArgs 中获得对 de dataitem 的任何引用。

所以，我的问题是如何将对象数据源的引用、包含它的项目或与该特定项目相关联的数据项获取到我的“onselecting”函数中。

提前致谢。

VB是

```
Imports System.Data.SqlClient

Public Class WebForm2
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    End Sub

    Protected Sub Page_lala(ByVal sender As Object, ByVal e As EventArgs) Handles Me.InitComplete
        Accordion1.DataSourceID = ObjectDataSource1.UniqueID
        Accordion1.DataBind()
    End Sub

    Protected Sub Accordion1_OnItemCommand(ByVal sender As Object, ByVal e As AjaxControlToolkit.AccordionCommandEventArgs) Handles Accordion1.ItemCommand
        Dim Accordion2 As Control = e.Container.FindControl("Accordion2")
        Dim objectDataSource As Control = e.Container.FindControl("ObjectDataSource2")
        If Accordion1 IsNot Nothing And objectDataSource IsNot Nothing Then
            AddHandler DirectCast(objectDataSource, ObjectDataSource).Selecting, AddressOf ObjectDataSource2_selecting
            AddHandler DirectCast(Accordion2, AjaxControlToolkit.Accordion).ItemCommand, AddressOf Accordion2_ItemCommand
            DirectCast(Accordion2, AjaxControlToolkit.Accordion).DataSourceID = DirectCast(objectDataSource, ObjectDataSource).ID
            DirectCast(Accordion2, AjaxControlToolkit.Accordion).DataBind()
        End If
    End Sub

    Protected Sub ObjectDataSource2_selecting(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.ObjectDataSourceSelectingEventArgs)
        Dim parameters(0) As SqlParameter
        Dim dsv As ObjectDataSourceView = DirectCast(sender, ObjectDataSourceView)
        parameters(0) = New SqlParameter("@cliente", "30697269610")
        e.InputParameters("param") = parameters
    End Sub

    Protected Sub ObjectDataSource3_selecting(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.ObjectDataSourceSelectingEventArgs)
        Dim parameters(0) As SqlParameter
        Dim dsv As ObjectDataSourceView = DirectCast(sender, ObjectDataSourceView)
        parameters(0) = New SqlParameter("@documento", "FC0030-00040199")
        e.InputParameters("param") = parameters
    End Sub

    Protected Sub Accordion2_ItemCommand(ByVal sender As Object, ByVal e As AjaxControlToolkit.AccordionCommandEventArgs) 'Handles Accordion2.ItemCommand
        Dim gridview As Control = e.Container.FindControl("gridviewAplicaciones")
        Dim objectDataSource As Control = e.Container.FindControl("ObjectDataSource3")
        If gridview IsNot Nothing And objectDataSource IsNot Nothing Then
            AddHandler DirectCast(objectDataSource, ObjectDataSource).Selecting, AddressOf ObjectDataSource3_selecting
            DirectCast(gridview, GridView).DataSourceID = DirectCast(objectDataSource, ObjectDataSource).ID
            DirectCast(gridview, GridView).DataBind()
        End If
    End Sub

End Class 
```

asp是

```
<%@ Page Language="vb" AutoEventWireup="false" CodeBehind="WebForm2.aspx.vb" Inherits="WebApplication4.WebForm2" %>

<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="asp" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:UpdatePanel ID="UpdatePanel1" runat="server">
        <ContentTemplate>
        <asp:ScriptManager ID="ScriptManager1" runat="server" >
        </asp:ScriptManager>
            <asp:Accordion id="Accordion1" runat="server" 
             SelectedIndex="-1" RequireOpenedPane="false"  ClientIDMode="Static">
            <HeaderTemplate><%# Container.DataItem("CUSTNMBR")%> / <%# Container.DataItem("CUSTNAME")%></HeaderTemplate>
            <ContentTemplate>
                <asp:LinkButton runat="server" ID="LinkButton1" Text="ver mas 1"></asp:LinkButton>
                <asp:Accordion id="Accordion2" runat="server" OnItemCommand="Accordion2_ItemCommand"
                 SelectedIndex="-1" RequireOpenedPane="false">
                    <HeaderTemplate><%# Container.DataItem("DOCNUMBR")%></HeaderTemplate>
                    <ContentTemplate>
                    <asp:LinkButton runat="server" ID="LinkButton2" Text="Ver mas2" 
                    ></asp:LinkButton>
                    <asp:GridView runat="server" ID="gridviewAplicaciones" AutoGenerateColumns="true">
                    </asp:GridView>
                    <asp:ObjectDataSource ID="ObjectDataSource3" runat="server"
                        SelectMethod="ExecuteDataset" TypeName="WebApplication4.DbHelper">
                        <SelectParameters>
                            <asp:Parameter DefaultValue="multiconex_aplicaciones" Name="nombreSP" 
                                Type="String"  />
                            <asp:Parameter Name="param" Type="Object" />
                        </SelectParameters>
                        </asp:ObjectDataSource>
                    </ContentTemplate>

                </asp:Accordion>
                <asp:ObjectDataSource ID="ObjectDataSource2" runat="server"
                     SelectMethod="ExecuteDataset" TypeName="WebApplication4.DbHelper" >
                        <SelectParameters>
                            <asp:Parameter DefaultValue="multiconex_aging" Name="nombreSP" 
                                Type="String" />
                            <asp:Parameter Name="param" Type="Object"  />
                        </SelectParameters>
                     </asp:ObjectDataSource>
                </ContentTemplate>

            </asp:Accordion>
           <asp:ObjectDataSource ID="ObjectDataSource1" runat="server"
                SelectMethod="ExecuteDataset" TypeName="WebApplication4.DbHelper">
                <SelectParameters>
                    <asp:Parameter DefaultValue="multiconex_rm00101" Name="nombreSP" 
                        Type="String" />
                    <asp:Parameter Name="param" Type="Object" />
                </SelectParameters>
           </asp:ObjectDataSource>
        </ContentTemplate>
        </asp:UpdatePanel>
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T17:02:25.300

经过大量尝试后，我没有得到对数据对象的引用，所以我在过滤器表达式中传递了数据项，并在 onselecting 函数结束时将其设为空白。

VB是

```
Imports System.Data.SqlClient

Public Class WebForm2
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    End Sub

    Protected Sub Page_lala(ByVal sender As Object, ByVal e As EventArgs) Handles Me.InitComplete
        Accordion1.DataSourceID = ObjectDataSource1.UniqueID
        Accordion1.DataBind()
    End Sub

    Protected Sub Accordion1_OnItemCommand(ByVal sender As Object, ByVal e As AjaxControlToolkit.AccordionCommandEventArgs) Handles Accordion1.ItemCommand
        Dim Accordion2 As Control = e.Container.FindControl("Accordion2")
        Dim objectDataSource As Control = e.Container.FindControl("ObjectDataSource2")
        If Accordion1 IsNot Nothing And objectDataSource IsNot Nothing Then
            AddHandler DirectCast(objectDataSource, ObjectDataSource).Selecting, AddressOf ObjectDataSource2_selecting
            AddHandler DirectCast(Accordion2, AjaxControlToolkit.Accordion).ItemCommand, AddressOf Accordion2_ItemCommand
            DirectCast(Accordion2, AjaxControlToolkit.Accordion).DataSourceID = DirectCast(objectDataSource, ObjectDataSource).ID
            'DirectCast(Accordion2, AjaxControlToolkit.Accordion).DataBind()
        End If
    End Sub

    Protected Sub ObjectDataSource2_selecting(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.ObjectDataSourceSelectingEventArgs)
        Dim parameters(0) As SqlParameter
        Dim dsv As ObjectDataSourceView = DirectCast(sender, ObjectDataSourceView)
        parameters(0) = New SqlParameter("@cliente", Trim(dsv.FilterExpression))
        e.InputParameters("param") = parameters
        dsv.FilterExpression = ""
    End Sub

    Protected Sub ObjectDataSource3_selecting(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.ObjectDataSourceSelectingEventArgs)
        Dim parameters(0) As SqlParameter
        Dim dsv As ObjectDataSourceView = DirectCast(sender, ObjectDataSourceView)
        parameters(0) = New SqlParameter("@documento", Trim(dsv.FilterExpression))
        e.InputParameters("param") = parameters
        dsv.FilterExpression = ""
    End Sub

    Protected Sub Accordion2_ItemCommand(ByVal sender As Object, ByVal e As AjaxControlToolkit.AccordionCommandEventArgs) 'Handles Accordion2.ItemCommand
        Dim gridview As Control = e.Container.FindControl("gridviewAplicaciones")
        Dim objectDataSource As Control = e.Container.FindControl("ObjectDataSource3")
        If gridview IsNot Nothing And objectDataSource IsNot Nothing Then
            AddHandler DirectCast(objectDataSource, ObjectDataSource).Selecting, AddressOf ObjectDataSource3_selecting
            DirectCast(gridview, GridView).DataSourceID = DirectCast(objectDataSource, ObjectDataSource).ID
            'DirectCast(gridview, GridView).DataBind()
        End If
    End Sub

End Class 
```

而aspx是

```
<%@ Page Language="vb" AutoEventWireup="false" CodeBehind="WebForm2.aspx.vb" Inherits="WebApplication4.WebForm2" %>

<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="asp" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:ScriptManager ID="ScriptManager1" runat="server" >
        </asp:ScriptManager>
            <asp:Accordion id="Accordion1" runat="server" 
             SelectedIndex="-1" RequireOpenedPane="false"  ClientIDMode="Static">
            <HeaderTemplate><%# Container.DataItem("CUSTNMBR")%> / <%# Container.DataItem("CUSTNAME")%></HeaderTemplate>
            <ContentTemplate>
                <asp:LinkButton runat="server" ID="LinkButton1" Text="ver mas 1"></asp:LinkButton>
                <asp:Accordion id="Accordion2" runat="server" OnItemCommand="Accordion2_ItemCommand"
                 SelectedIndex="-1" RequireOpenedPane="false">
                    <HeaderTemplate><%# Container.DataItem("DOCNUMBR")%></HeaderTemplate>
                    <ContentTemplate>
                    <asp:LinkButton runat="server" ID="LinkButton2" Text="Ver mas2" 
                    ></asp:LinkButton>
                    <asp:GridView runat="server" ID="gridviewAplicaciones" AutoGenerateColumns="true">
                    </asp:GridView>
                    <asp:ObjectDataSource ID="ObjectDataSource3" runat="server" FilterExpression='<%# Container.DataItem("DOCNUMBR") %>'
                        SelectMethod="ExecuteDataset" TypeName="WebApplication4.DbHelper"  >
                        <SelectParameters>
                            <asp:Parameter DefaultValue="multiconex_aplicaciones" Name="nombreSP" 
                                Type="String"  />
                            <asp:Parameter Name="param" Type="Object" />
                        </SelectParameters>
                        </asp:ObjectDataSource>
                    </ContentTemplate>

                </asp:Accordion>
                <asp:ObjectDataSource ID="ObjectDataSource2" runat="server" FilterExpression='<%# Container.DataItem("CUSTNMBR") %>'
                     SelectMethod="ExecuteDataset" TypeName="WebApplication4.DbHelper" >
                        <SelectParameters>
                            <asp:Parameter DefaultValue="multiconex_aging" Name="nombreSP" 
                                Type="String" />
                            <asp:Parameter Name="param" Type="Object"  />
                        </SelectParameters>
                     </asp:ObjectDataSource>
                </ContentTemplate>
            </asp:Accordion>
           <asp:ObjectDataSource ID="ObjectDataSource1" runat="server"
                SelectMethod="ExecuteDataset" TypeName="WebApplication4.DbHelper">
                <SelectParameters>
                    <asp:Parameter DefaultValue="multiconex_rm00101" Name="nombreSP" 
                        Type="String" />
                    <asp:Parameter Name="param" Type="Object" />
                </SelectParameters>
           </asp:ObjectDataSource>
    </div>
    </form>
</body>
</html> 
```

# xmpp - Connection failure when using strophe with ejabberd bosh to connect to jid account on localhost

> ID：13166950
> 
> 赞同：3
> 
> 时间：2012-10-31T20:29:00.767
> 
> 标签：xmpp, ejabberd, strophe

I have installed ejabberd on my machine and its running fine.

```
localhost:5280/admin

localhost:5280/http-bind 
```

It is also displaying "ejabberd mod_http_bind An implementation of XMPP over BOSH (XEP-0206)" I guess it's working fine.

When I try to create a connection with Strophe I get the connection status as `CONNFAIL`.

My code goes as follow :

```
var conn = new Strophe.Connection('http://localhost:5280/http-bind');
conn.connect(data.jid, data.password, function (status) {

// jid=user@localhost

if(status===Strophe.Status.CONNECTING){

alert('connecting...!!');

}

if(status===Strophe.Status.AUTHFAIL){

alert('auth failure...!!');

}

if(status===Strophe.Status.CONNFAIL){

alert('connection falied !!');

}} 
```

I keep getting `CONNFAIL`.

I have also added proxypass for`http://localhost:5280/http-bind` in apache httpd.conf file.

I am not able to figure out what is the problem.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T05:33:25.703

要调试 ejabberd 是否真的在接收您的 Bosh 请求，请重新启动 ejabberd `{log_level, 5}`（在您的`/etc/ejabberd/ejabberd.cfg`文件中设置它）。然后，当您使用 strophe 连接到 ejabberd 时，请通过执行`tail -f /var/log/ejabberd/ejabberd.log`. 如果您没有看到任何内容，则意味着您的请求在代理上下文中的某处失败。如果您确实看到了什么，请使用相关日志更新您的问题，以便我们更好地帮助您。

或者，您可以`log_level`通过 ejabberd 调试 shell 即时更新：

```
$ sudo ejabberdctl debug
....
Eshell V5.8.5  (abort with ^G)
(ejabberd@localhost)1> ejabberd_loglevel:set(5).
{module,ejabberd_logger}
(ejabberd@localhost)2> 
```

**注意：**`ejabberd.cfg`我假设和的标准安装路径`ejabberd.log`。如果您有备用安装前缀，请相应地更新路径。

# php - 从谷歌 api 货币转换器用 php 解析 json

> ID：13166953
> 
> 赞同：0
> 
> 时间：2012-10-31T20:29:16.057
> 
> 标签：php, json

我正在尝试连接 Google API 货币转换器。由于它返回无效的 json 响应，我不得不更改格式。但现在我被困在如何获取信息上。任何帮助将不胜感激。这是我的代码：

```
$amount = '100';
$from = 'USD';
$to = 'MXN';

// Make param to be sent in API
$string = $amount.$from."=?".$to;

// Call Google API
$google_url = "http://www.google.com/ig/calculator?hl=en&q=".$string;

// Get and Store API results into a variable
$result = file_get_contents($google_url);
$result = explode('"', $result);

$fromParts = explode(' ',  $result[1]);
$toParts = explode(' ',  $result[3]);

$return = array(
    'from' => array(
        'code' => $from,
        'amount' => cleanAmount($fromParts[0])
    ),
    'to' => array(
        'code' => $to,
        'amount' => cleanAmount($toParts[0])
    )
);

$json = json_encode($return);
//echo json_encode($return); 
```

我得到的回应是这样的：

```
{"from":{"code":"USD","amount":100},"to":{"code":"MXN","amount":1304.80167}} 
```

我正在尝试提取 to->amount，但我得到一个空的结果。

```
$obj = json_decode($json);
print $obj->{'to'}; 
```

这是我得到的错误：

```
Catchable fatal error: Object of class stdClass could not be converted to string in /home/olympust/public_html/lista-traslados-mexico.php on line 101 
```

有人知道如何从响应中获取变量吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:33:02.813

你正在尝试`echo`一个对象。您可以执行以下任一操作：

```
echo $obj->to->amount; // prints the value 
```

或者

```
print_r($obj->to); // prints the object 
```

# python - 如何在 Python 中渲染 3D 表面

> ID：13166954
> 
> 赞同：2
> 
> 时间：2012-10-31T20:29:16.277
> 
> 标签：python

我目前有一个工作 python 代码，它生成一个圆形的颜色图的 2D 动画。此颜色图旨在表示心脏的激活水平。
下一步是获取此 2D 颜色图并生成 3D 表面。我想知道在 Python 中最好和最简单的方法是什么（请记住，解决方案必须是免费的解决方案）。我使用过 Matplotlib 并查看了 3D 表面渲染，但是我发现它达不到标准，因此我正在寻找另一种解决方案。任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T21:49:37.653

也可以试试更专注于 3D 可视化的 Mayavi。
文档：[http](http://docs.enthought.com/mayavi/mayavi/mlab.html)
://docs.enthought.com/mayavi/mayavi/mlab.html 安装：[http ://docs.enthought.com/mayavi/mayavi/installation.html](http://docs.enthought.com/mayavi/mayavi/installation.html)

要获得更详细的答案，您必须详细说明您在 Matplotlib 中尝试过的内容以及缺少的内容。

# ninject - Using Ninject and Fluent API for mapping between Entity and DTO

> ID：13166955
> 
> 赞同：0
> 
> 时间：2012-10-31T20:29:16.753
> 
> 标签：ninject, fluent-interface

I want to be able to do something like:

```
FluentMapper m = new FluentMapper();
//some test data
ProjectDTO dto = new ProjectDTO() {...A List of Properties...};
Project entity = new Project();
List<ProjectDTO> listOfDTOs = new List<ProjectDTO>(){dto};
List<Project> listOfEntities = new List<Project>(){entity};
//Mapping from DTO to entity
m.Map<ProjectDTO>(dto).To<Project>(entity);
m.Map<ProjectDTO>(listOfDTOs).To<Project>(listOfEntities);
//and vice versa
m.Map<Project>(entity).To<ProjectDTO>(dto);
m.Map<Project>(listOfEntities).To<ProjectDTO>(listOfDTOs); 
```

i.e. basically using the same Method Map(item or a list of items).To(item or list of items) I can map between Entity or a list of Entities to a DTO or a list of DTOs. And if there are no mapping defined between ProjectDTO and Project it will throw an exception. If doing a list is way more complex, I'm cool with just looping them through manually.

I'm not sure how I could use Ninject to give me the correct Mapper base on the the **From** type and **To** type. I was thinking of using a factory to build mapper base on the two types, but not sure how that can be done either.

Currently I'm using a mapper per entity/DTO pair, but it becomes clunky when I need to use more than one mapper in a class, where I've to inject multiple mappers into. Our Mapper class is like this (which I'm comfortable changing to whatever that will work).

```
public class ProjectMapper<E, D> : IEntityDTOMapper<Project, ProjectDTO>
    where E : Project
    where D : ProjectDTO
{
    public ProjectDTO Map(Project entity)
    {
        return new ProjectDTO()
        {
            ... Mapping properties...
        };
    }

    public List<ProjectDTO> Map(List<Project> entities)
    {
        List<ProjectDTO> dtos = new List<ProjectDTO>();
        foreach (Project entity in entities)
        {
            dtos.Add(Map(entity));
        }
        return dtos;
    }

    public Project Map(ProjectDTO dto)
    {
        return new Project()
        {
            ... Mapping properties...
        };
    }

    public List<Project> Map(List<ProjectDTO> dtos)
    {
        List<Project> entities = new List<Project>();
        foreach (ProjectDTO dto in dtos)
        {
            entities.Add(Map(dto));
        }
        return entities;
    } 
```

I've thought about using AutoMapper, but it seems like an overkill and I also want to learn some advanced Ninject techniques.

Thank You.

# android - 如何在android中为自定义组件设置默认值？

> ID：13166958
> 
> 赞同：0
> 
> 时间：2012-10-31T20:29:22.233
> 
> 标签：android

我有一个扩展 TextView 的自定义组件。在构造函数中，我将 textSize 设置为 14。

在布局文件中，我尝试将 textSize 显式设置为 20，但该属性的值没有效果。

解决这个问题的正确方法是什么？

谢谢

代码

```
public class MyTextView extends TextView {
    public MyTextView(Context context) {
        super(context);
        setTextSize(TypedValue.COMPLEX_UNIT_SP, 14);
    }
} 
```

布局

```
<package.MyTextView
     android:text="@string/hello"
     android:textSize="20sp" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:31:48.507

如果您以编程方式设置 textSize，则 xml 中的属性将完全没有效果！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:36:33.283

检查从构造函数中的 XML 布局获得的属性。如果在此处定义了 textSize，请不要设置默认的 textSize。有关更多信息，请参阅查看[文档](http://developer.android.com/reference/android/view/View.html)。

# tridion - Has anyone used Count Items power tool extension with Tridion 2011?

> ID：13166960
> 
> 赞同：1
> 
> 时间：2012-10-31T20:29:33.697
> 
> 标签：tridion, tridion-2011

I configured the count items power tool extension by creating a custom page @CME(/Powertools/countitems.asp). But,it is throwing an error message when i tried to execute the page. I am using Tridion 2011 GA version.Below is the error message which is not very clear in order to troubleshoot the issue. Please wait while the items are counted. An error occurred on the server when processing the URL.

do i need to do make any other changes in order to make it work? Please advice.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:30:22.913

替代选项：您可以尝试使用此处提到的 PowerShell 脚本

[http://amarchuk.blogspot.com/2012/11/powershell-script-to-gather-some.html](http://amarchuk.blogspot.com/2012/11/powershell-script-to-gather-some.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T20:58:24.163

好像您安装了 2011 年之前的 PowerTool(s)。有一个专门用于 SDL Tridion 2011 及更高版本的新 PowerTool 项目。

看看这个网址：[http ://code.google.com/p/tridion-2011-power-tools/](http://code.google.com/p/tridion-2011-power-tools/)

有可用的安装程序。

顺便说一句，旧的 PowerTools*应该可以*工作。但是为了让我们帮助您，我们需要您收到的真正错误。查看 CMS 上的 Windows 事件日志以获取详细的错误消息。

# arrays - 如何将一组未知数量的参数传递给 MATLAB 中的函数？

> ID：13166961
> 
> 赞同：6
> 
> 时间：2012-10-31T20:29:39.560
> 
> 标签：arrays, function, matlab, arguments

当您有一个接受可变数量参数的函数（如 ndgrid）时，如何将任意参数列表传递给该函数？

例如，我想让它有时我将两个向量传递给 ndgrid 并得到两个矩阵，即

```
[X1,X2] = ndgrid(x1,x2); 
```

但其他时候我可能有更多的 X，所以我想要

```
[X1,X2,X3,X4] = ndgrid(x1,x2,x3,x4) 
```

1.  有什么结构可以用来存储未知数量的参数列表，然后将该列表提供给函数吗？和，
2.  当您不知道会有多少输出时，有没有办法从函数中检索所有输出？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T22:27:41.303

要将可变数量的输入传递给现有函数，请使用带扩展的元胞数组，如下所示：

```
x = 1:10;
y = randn(size(x));
plotArguments = {'color' 'red' 'linestyle' '-'};
plot(x, y, plotArguments{:}); 
```

或者

```
plotArguments = {1:10 randn(1,10)  'color' 'red' 'linestyle' '-'};
plot(plotArguments{:}); 
```

您可以使用相同的技巧来接收多个输出。唯一困难的部分是记住正确的符号。

```
numArgumentsToAccept = 2;
[results{1:numArgumentsToAccept }] = max(randn(100,1)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T20:37:01.793

使用`varargin`, `nargin`,您可以`varargout`轻松`nargout`定义可变参数/输出函数。有关 varargin 页面，请参阅随附的 MATLAB 文档链接。其他链接在底部：

[http://www.mathworks.com/help/matlab/ref/varargin.html](http://www.mathworks.com/help/matlab/ref/varargin.html)

编辑：顺便说一句，不要自吹自擂，但它似乎就像我在“quick-and-dirty”评论中所建议的那样实施呵呵

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T15:25:24.253

将所有参数作为输出返回的函数：

```
function varargout = ndgrid(varargin)    
    varargout = varargin;
return 
```

# .htaccess - 使用 .htaccess “忽略”文件

> ID：13166962
> 
> 赞同：0
> 
> 时间：2012-10-31T20:29:41.170
> 
> 标签：.htaccess

是否可以忽略目录中的所有实际文件`RewriteRules`？我的意思是，我正在创建 page.php 处理的“平面链接”或“永久链接”（http://example.com/not/an/actual/file/path/）。这仅在我“忽略”所有其他文件时才有效`RewriteCond`。不是为我的 .htaccess 文件中的目录中的每个真实文件创建一个，而是`RewriteCond`有办法告诉它检查是否有实际文件显示，如果没有，让 page.php 处理它？

```
RewriteCond %{REQUEST_URI} !^/index\.php$
RewriteCond %{REQUEST_URI} !^/somefile\.php$
RewriteCond %{REQUEST_URI} !^/someotherfile\.php$
RewriteCond %{REQUEST_URI} !^/page\.php$
RewriteRule ^([^/]*)$ /page.php?p=$1 [L] [NC] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:40:21.603

是的，很有可能。在现有代码之前添加这些行：

```
## If the request is for a valid directory
RewriteCond %{REQUEST_FILENAME} -d [OR]
## If the request is for a valid file
RewriteCond %{REQUEST_FILENAME} -f [OR]
## If the request is for a valid link
RewriteCond %{REQUEST_FILENAME} -l
## don't do anything
RewriteRule ^ - [L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:43:48.170

`-f`以下指示仅当请求的文件 ( ) 或文件夹 ( ) 在磁盘上`-d`不存在 ( )时才应执行重定向：`!`

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]*)$ /page.php?p=$1 [L,NC] 
```

# sql - 如何使用 SSIS 派生列转换为 NULL 日期分配默认值？

> ID：13166968
> 
> 赞同：4
> 
> 时间：2012-10-31T20:30:11.190
> 
> 标签：sql, ssis, expression

在我的 SQL 2008 SSIS 环境中，我有来自 CSV 文件的数据，我需要修复空日期。

来自 CSV 的数据如下所示：

```
01011990
01011990
01011990
01011990
01011990 
```

在我的临时表中，我有一列定义为：

```
[SHIPPED DATE] date NOT NULL 
```

首先，我通过将列推入派生转换来修复日期值，该派生转换具有：

> (DT_DBDATE)(SUBSTRING([发货日期],1,2) + "/" + SUBSTRING([发货日期],3,2) + "/" + SUBSTRING([发货日期],5,4))

上述转换使我的字符串日期从 CSV 导入到我的 SQL 数据库中的日期列中。

这个的输出是：

```
1990-01-01
1990-01-01
1990-01-01
1990-01-01
1990-01-01 
```

**`Next`**，我想处理 NULL 日期，以便我可以忠实于我的数据库中的“NOT NULL”定义。我想要做的是为 NULL 日期分配一个默认值，但我收到如下错误消息：

> CSV 到 SQL 的错误 [派生列 [24817]]：数据类型“DT_WSTR”和“DT_DBDATE”与条件运算符不兼容。操作数类型不能隐式转换为条件操作的兼容类型。要执行此操作，需要使用强制转换运算符显式强制转换一个或两个操作数。

我的 CSV 列是 WSTR，我在 SQL DB 中的目标是“日期”列。

我尝试使用的转换是： ISNULL([SHIPPED_DATE]) ？“1900-01-01”：[发货日期]

由于上述消息，它不想工作。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-31T20:38:48.290

改变你的表达方式，如下所示。三元运算符有两个部分。

**`Part 2`**你有它`[SHIPPED_DATE]`，它是类型，`DT_DBDATE`因为你已经在派生列转换中转换了这个值。

但是，**`Part 1`**被简单地分配为 text `"1900-01-01"`。您需要`DT_DBDATE`在该字符串值之前添加 ( ) 以将其类型转换为日期格式，以便三元运算符上指定的两个值具有相同的数据类型。

### 从

```
 ISNULL([SHIPPED_DATE]) ? "1900-01-01" : [SHIPPED_DATE] 
```

### 到

```
 ISNULL([SHIPPED_DATE]) ? (DT_DBDATE)"1900-01-01" : [SHIPPED_DATE] 
```

# java - Java 使用 Scanner 作为构造函数的参数

> ID：13166971
> 
> 赞同：4
> 
> 时间：2012-10-31T20:30:14.763
> 
> 标签：java, constructor, java.util.scanner

这是一个学校作业的问题，这就是我这样做的原因。

无论如何，我在 main 方法中使用 Stdin 制作了一个扫描仪（Scanner stdin = new Scanner(System.in); 是行），从程序运行时指定的 txt 读取数据。此 Scanner 主要按预期工作，但是我需要在以 Scanner 作为参数的自定义类中使用它：

```
 public PhDCandidate(Scanner stdin)
    { 

    name = stdin.nextLine();
    System.out.println(name); //THIS NEVER RUNS
    preliminaryExams = new Exam[getNumberOfExams()];

    for(int i = 0; i <= getNumberOfExams(); i++)
    {
        preliminaryExams[i] = new Exam(stdin.nextLine(), stdin.nextDouble());
    }
    System.out.print("alfkj");
   } 
```

此时，任何对 Scanner 的调用都将结束程序，不会引发异常或错误。只有调用 .next() 有效。我可以让程序工作，但它会很老套，我真的不明白发生了什么。我怀疑我错过了一个非常简单的概念，但我迷路了。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T20:39:26.380

请确保`Scanner stdin`在调用构造函数之前没有关闭并重新初始化，因为我怀疑这是问题所在，即如果您正在执行以下操作：

```
 Scanner stdin = new Scanner(System.in);
        .........
        stdin.close(); //This will close your input stream(System.in) as well  

        .....
        .....

        stdin = new Scanner(System.in);
        PhDCandidate phDCandidate = new PhDCandidate(stdin); 
```

`stdin`构造函数内部不会读取任何内容，因为输入流`System.in`已经关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:33:36.957

你的代码对我来说很好。在 main 中创建扫描仪后，将其作为参数传递。

```
 public Test(Scanner stdin)
        { 
System.out.println("enter something");
        name = stdin.nextLine();
        System.out.println(name); //THIS NEVER RUNS

        System.out.print("alfkj");
       }
    public  static void main(String...args)throws SQLException {
        new Test(new Scanner(System.in));
}

output: enter something
        xyzabc
        alfkj 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T20:37:09.680

在您的 PhDCandidate 类中添加一个 set Name 方法。这样，您可以在 main 方法中创建一个 PhDCandidate 对象并打印名称或从 main 执行任何操作。

```
public static void main(String[] args) {

    PhDCandidate c = new PhDCandidate();
    c.setName(stdin.nextLine());
} 
```

# c - 与 MPI_FILE_OPEN 一起使用的 MPI 感知 mkstemp(3)？

> ID：13166972
> 
> 赞同：3
> 
> 时间：2012-10-31T20:30:19.117
> 
> 标签：c, mpi, mkstemp

我想在 MPI 应用程序中生成一个唯一的文件名。

阅读`MPI_FILE_OPEN`规范 2.2 版中的“对实现者的建议”表明`uriPrefix:foo/bar/baz`除了通常的文件名之外的文件名`foo/bar/baz`也是可能的。就像文件名一样`baz/PASSWORD=SECRET`。MPI 实现有望使用这些附加信息做正确的事情。

这些额外的文件名元素将对`mkstemp(3)`. 在前一种情况下，`uriPrefix`可以指示文件应该存放在哪里。在后一种情况下，`bazXXXXXX/PASSWORD=SECRET`将搞砸`mkstemp(3)`的模板约定。

有没有人有关于如何安全结合`mkstemp(3)`的建议`MPI_FILE_OPEN`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T17:06:26.110

`MPI_FILE_OPEN` is a collective operation. It is intended to be called by all MPI ranks with the same file name and the name should also point to a location on a shared filesystem. Otherwise it makes no sense. `mkstemp(3)` would generate different names if called in different ranks. Also it creates the file and returns its file descriptor. Probably not what you want if you'd like to use MPI parallel IO.

If you'd really want to create a unique file, then you could probably do something like this:

```
int rank;
char name[PATH_MAX] = "/path/to/shared/directory/prefixXXXXXX";
MPI_File fh;

MPI_Comm_rank(MPI_COMM_WORLD, &rank);

// Create the temporary file in rank 0 only
if (rank == 0)
{
   int fd = mkstemp(name);
   // Close the handle - we don't need it
   close(fd);
   // <----- Decorate name here
}
// Broadcast the file name to all other ranks
MPI_Bcast(name, PATH_MAX, MPI_CHAR, 0, MPI_COMM_WORLD);

// Now open the file for MPI parallel IO
MPI_File_open(MPI_COMM_WORLD, name, MPI_MODE_RDWR, MPI_INFO_NULL, &fh); 
```

Once you've got the name from `mkstemp(3)`, at the point marked as `Decorate name here` you can perform additional decorations of the name, e.g. append `/PASSWORD=SECRET` to it or prefix it with `fstype:`. You could also do it after the broadcast, if you need to put some process-specific decorations.

# django-models - 在 Django/Python 2.7 中用 getter 覆盖模型字段？

> ID：13166977
> 
> 赞同：1
> 
> 时间：2012-10-31T20:30:49.647
> 
> 标签：django-models, python-2.7

给定一个 Django 模型，例如：

```
class Grouping(models.Model):
    title           = models.CharField(max_length=1024,null=True,blank=True)
    slug            = models.CharField(max_length=200,null=True,editable=False) 
```

如何将 getter 功能添加到像这样的字段`slug`？在这里，我想在返回之前修改 slug，而不必修改使用 slug 的每个地方。

我知道[https://code.djangoproject.com/ticket/3148](https://code.djangoproject.com/ticket/3148)

# c# - 如何可靠地检查是否使用 C# 启用了 Windows 更新？

> ID：13166978
> 
> 赞同：3
> 
> 时间：2012-10-31T20:30:52.693
> 
> 标签：c#, com, windows-update

我试图检查是否启用了 Windows 更新。我在 Windows 7 x64 Ultimate 上添加了对 c:\windows\system32\wuapi.dll 的引用并编写了这段代码

```
using WUApiLib;
public Boolean IsWindowsUpdateEnabled()
{
    var updates = new AutomaticUpdatesClass();
    return updates.ServiceEnabled;
} 
```

代码无法构建。我收到以下错误：

> 错误 1 ​​类型“WUApiLib.AutomaticUpdatesClass”没有定义构造函数
> 错误 2 无法嵌入互操作类型“WUApiLib.AutomaticUpdatesClass”。请改用适用的接口。
> 错误 3“WUApiLib.AutomaticUpdatesClass”不包含“ServiceEnabled”的定义，并且找不到接受“WUApiLib.AutomaticUpdatesClass”类型的第一个参数的扩展方法“ServiceEnabled”（您是否缺少 using 指令或程序集引用？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:02:33.230

In your Visual Studio project References list, find the WUApiLib reference and change its "Embed Interop Types" to "False".

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T20:45:51.807

也许您可以查询注册表以查看？

```
public string Read(string KeyName)
{
    // Opening the registry key
    RegistryKey rk = baseRegistryKey ;
    // Open a subKey as read-only
    RegistryKey sk1 = rk.OpenSubKey(subKey);
    // If the RegistrySubKey doesn't exist -> (null)
    if ( sk1 == null )
    {
        return null;
    }
    else
    {
        try 
        {
            // If the RegistryKey exists I get its value
            // or null is returned.
            return (string)sk1.GetValue(KeyName.ToUpper());
        }
        catch (Exception e)
        {
            // AAAAAAAAAAARGH, an error!
            ShowErrorMessage(e, "Reading registry " + KeyName.ToUpper());
            return null;
        }
    }
} 
```

[来源](http://www.codeproject.com/Articles/3389/Read-write-and-delete-from-registry-with-C)

以及要查看的位置：

[http://www.windowsnetworking.com/articles_tutorials/Registry-Keys-Tweaking-Windows-Update-Part1.html](http://www.windowsnetworking.com/articles_tutorials/Registry-Keys-Tweaking-Windows-Update-Part1.html)

> HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU ...
> 
> 这些键中的第一个是 AUOptions 键。此 DWORD 值可以指定为 2、3、4 或 5。值 2 表示代理应在下载更新之前通知用户。值 3 表示将自动下载更新并通知用户安装。值 4 表示应根据计划自动下载和安装更新。要使此选项起作用，还必须设置 ScheduledInstallDay 和 ScheduledInstallTime 键。稍后我将更多地讨论这些键。最后，值 5 表示需要自动更新，但可以由最终用户配置。

等等。

虽然如果设置是由组策略完成的，可能会有所不同。

更多信息在这里：http: [//support.microsoft.com/kb/328010](http://support.microsoft.com/kb/328010)

# ruby - 将 RSpec 配置为对所有请求规范使用 Capybara.javascript_driver

> ID：13166980
> 
> 赞同：8
> 
> 时间：2012-10-31T20:31:01.440
> 
> 标签：ruby, rspec, capybara, acceptance-testing

是否可以全局配置 RSpec 以对所有请求规范使用 Capybara 的（默认或自定义）JavaScript 驱动程序？我们有时会忘记手动添加`js: true`到每个请求规范，这有点烦人。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-31T20:37:07.153

在 spec_helper.rb 中，设置以下内容：

```
 config.before(:each) do
    if example.metadata[:type] == :request
      Capybara.current_driver = :selenium # or equivalent javascript driver you are using
    else
      Capybara.use_default_driver # presumed to be :rack_test
    end
  end 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-10T21:49:03.477

对于更高版本的 capybara 和 rspec，检查 type 是否为“feature”很重要

```
config.before(:each) do
  if [:request, :feature].include? example.metadata[:type]
    Capybara.current_driver = :poltergeist # or equivalent javascript driver you are using
  else
    Capybara.use_default_driver # presumed to be :rack_test
  end
end 
```

或对于 RSpec 3（传递`example`到块中）

```
config.before(:each) do |example|
  if [:request, :feature].include? example.metadata[:type]
    Capybara.current_driver = :poltergeist # or equivalent javascript driver you are using
  else
    Capybara.use_default_driver # presumed to be :rack_test
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-12T19:42:30.673

如果您想一次运行所有测试用例，请参阅此解决方案。

[Rspec+Capybara 可选更改 JS 驱动](https://stackoverflow.com/questions/18501574/rspeccapybara-optionally-change-js-driver/20638548#20638548)

# c# - 指定 COM 对象从位置运行

> ID：13166982
> 
> 赞同：-1
> 
> 时间：2012-10-31T20:31:09.203
> 
> 标签：c#, c++, dll, com-object

我一直在扯我的头发。我有一个我编写的 C++ OPOS 驱动程序。我用 C# 编写了一个虚拟密码键盘。它有效，一切都很好。

不过，给我的一个要求是 C# 驱动程序必须与调用程序一起出现。这需要一段时间才能弄清楚，因为我们期望它必须是 OPOS 驱动程序所在的位置。让我觉得我在设置它时做错了什么。

我知道这很模糊，并且需要更多信息，但我不知道从哪里开始，或者您需要哪些信息来帮助您解决这方面的问题。我会经常检查并回答任何问题....啊，我讨厌这样含糊不清..请不要发火:)我会根据需要进行编辑。

编辑

很抱歉没有很好地表达这一点。当我写这篇文章时，我发生了很多事情。我自己重新阅读它并在想“NEWB！” 哈。

好吧，如此低落和肮脏。问题不在于 COM 驱动程序，而在于 C# 虚拟键盘。总结一下我要说的是为什么我的 C# 虚拟 pinpad dll 必须与我的可执行文件位于同一位置，而不是与我注册的 UPOS 驱动程序位于同一位置？

所以要详细说明。驱动程序有效（前提是我不会再搞砸了）。正如所指出的，任何程序都必须注册它才能使用它。一切都很好。我们将与此 UPOS 驱动程序相关的所有必要文件放在同一个文件夹中。有一次，我们有一个内置在 UPOS 驱动程序中的 C++ 虚拟密码键盘，但为了简单起见，我决定只制作一个 COM 可见的 C# 虚拟密码键盘会更快、更容易。在大多数情况下，它是。这很好，因为如果我进行任何图形更改，我可以替换 VPP.dll 并且生活很好。然后我在电脑上安装了这组驱动，当我试图打开VPP时它会崩溃。出于绝望，我开始复制VPP。dll到不同的位置，发现当我把它放在与执行程序相同的位置时，它就会开始工作。这不是我想要的。我希望能够将它与我的其他驱动程序放在同一目录中。（因环境而异，但通常位于“程序文件”文件夹中）这让我回到了上面总结的问题。令人难以置信的是，我的 UPOS 驱动程序是发出 COM 调用的驱动程序。当我进行安装时，我的安装部分是将 VPP.dll 放入 Program Files 文件夹并在其上运行 regasm（这表示它是成功的）。因此，它必须与正在执行的程序一起使用，这让我感到难以置信。哦，它需要位于集中位置的另一个原因是我们在不同的位置安装了一些不同的程序（确切地说是 4 个）。人为错误就是我不想将 VPP.dll 复制到每台计算机上可能的 4 个位置。（最终将达到 500 左右）

所以现在我澄清了，（实际上问了一个问题……对此感到抱歉），我们有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:49:55.753

因此，您有一个实现 OPOS 接口的 DLL（.net 程序集）。OPOS 接口按规范是一个 COM 对象（OPOS 代表 POS 的 Ole）。

我怀疑这是您的要求：使用您的驱动程序的应用程序，无论是本机的还是托管的，都必须能够通过 CoCreateInstance 实例化您的对象。为此，您的设备必须在 Windows 注册表中注册。请参阅下面的示例以了解如何执行此操作：

*   [http://msdn.microsoft.com/en-us/library/c3fd4a20(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/c3fd4a20(v=vs.100).aspx)
*   [http://msdn.microsoft.com/en-us/library/w29wacsy.aspx](http://msdn.microsoft.com/en-us/library/w29wacsy.aspx)

注意：您应该知道，称为 UPOS（通用 POS）的新标准已经开发出来，并且 Microsoft“.NET for POS”已经支持它，它也向后兼容 OPOS。

**编辑（在问题中进行编辑之后）：**
因此，您的 VPP 似乎是一个 COM 对象，并且您有程序以某种方式注册它，即它可以从任何不是当前目录的文件夹中进行 CoCreatable。我怀疑它的注册有问题。确保您的 COM 对象有一个 Porgram ID 和一个唯一的 CLSID。签出注册​​表中`HKCR\CLSID\<your object class id&>`的`HKCR\<your object progid>`. 将 UPOS 和应用程序放在一边一分钟。只需确保一个简单的 JavaScript 文件 (xxx.js) 行：`var x = new ActiveXObject(<your prog id>)`在从任何文件夹执行脚本时都可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T14:29:27.167

这种问题是 Windows（或 CLR，不清楚）定位依赖 DLL 的方式的自然结果。COM 服务器的注册只提供实现该服务器的 DLL 的路径。它不会影响依赖 DLL 的搜索路径。

如果这是本机（非 .NET）DLL，则 Windows 搜索：

*   加载 EXE 的目录
*   （可选）调用 SetDllDirectory() 指定的目录
*   Windows系统目录，默认为c:\windows\system32
*   16位遗留系统目录，默认为c:\windows\system
*   Windows 目录，默认为 c:\windows
*   进程的默认工作目录
*   PATH 环境变量中列出的目录

如果这是一个 .NET DLL，则 CLR 搜索：

*   海关总署
*   加载 EXE 的目录
*   `<probing>`（可选）由app.exe.config 文件中的元素指定的探测路径。

很明显，如果相关的 DLL 位于 EXE 目录中，您将没有问题。如果您想在其他地方使用它，那将是一个非常讨厌的东西。从上面的列表中选择一个。

# jquery - 选择一个选择菜单项并使用 JQuery 提交

> ID：13166984
> 
> 赞同：0
> 
> 时间：2012-10-31T20:31:26.200
> 
> 标签：jquery, select, drop-down-menu, translate

我正在创建一个包含多种语言的下拉列表，旨在替代丑陋的谷歌翻译下拉列表。

我的目标是允许用户从下拉列表中选择一个项目，将谷歌翻译菜单所选项目的值更改为单击的项目的值。（如果这没有意义，请继续阅读，它会的！）

然后我的问题是提交翻译选择菜单。

你可以在这里看到一个演示：http: [//bajdesign.com/test](http://bajdesign.com/test)

如您所见，当您按语言时，会出现下拉菜单，当您选择一个项目时，您会看到该项目出现在左侧的谷歌翻译下拉列表中。我需要能够提交此翻译选择菜单，但我不确定如何提交。

我的 JQuery 是

```
$("#language li a").on("click", function(){
    var thisClass = $(this).attr("class");
    $(".goog-te-combo").val(thisClass);
}); 
```

因为选择菜单不包含在表单中，所以我不能使用 JQuery`submit()`那么最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:47:30.467

如何使用**Ajax 请求**...

```
$("#language li a").on("click", function(e){
    e.preventDefault();
    var thisClass = $(this).attr("class");
    $(".goog-te-combo").val(thisClass);

    $.ajax({
       type : 'POST',
       url : 'yoururl',
       dataType : 'html',
       data : {"lang" : $(this).attr("class") },
       success : function(result) {
         // Populate your page here
      }
    })
}); 
```

**编辑**

如果那是表格，那么您可以提交

```
$("#language li a").on("click", function(e){
        e.preventDefault();
        var thisClass = $(this).attr("class");
        $(".goog-te-combo").val(thisClass).submit();
}); 
```

# objective-c - XCode - 在情节提要中堆叠 UI 元素是不好的做法？

> ID：13166987
> 
> 赞同：0
> 
> 时间：2012-10-31T20:31:35.513
> 
> 标签：objective-c, ios, xcode, storyboard

我有一个关于使用 Storyboard IB 的问题。很多时候，当我在情节提要上构建界面时，我会将一些 UI 元素堆叠在一起。我只是有选择地显示和隐藏它们以提供一个干净的界面。例如，我会在一些 uitexboxes 上放置一个pickerview。这是不好的做法吗？我认为这不是一件坏事，因为如果我以编程方式构建界面，我可能会做同样的事情，有时使用所见即所得的构建器看起来很难看。我刚刚让开发人员看了我的故事板，当我在一些 UITexboxes 上使用 UIPickerView 和 UiDatePicker 时，他基本上是“wtf”。

谢谢！艾伦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-03-17T11:54:04.047

每个人都有自己的编程风格。我认为这没有绝对正确的方法，但坚持这些指导方针肯定会让你的生活更轻松。

还应用通用规则使您的代码/IB 更具可读性。

IMO，如果您正在做一个平均大小的应用程序，堆叠不是最好的事情。同样以编程方式保留它们也不是最好的解决方案。我建议将 UI 项分隔在不同的类 IB 中，并将它们视为跨应用程序的可重用组件。通过这样做，你可以让你的记忆不那么忙碌，你的故事板也会变得更轻松。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:40:04.023

这真的取决于你是什么类型的人。如果您希望事情保持清洁，请以编程方式进行，如果您希望事情更容易，只需将它们堆叠起来。我只堆叠了一些东西，我将在下面给出我的理由。

有一个缺点。如果您正在创建所有元素并简单地将它们堆叠起来，那么您将在很大程度上依赖于可可约束。现在，起初一切似乎都可以正常工作，但如果 Apple 推出另一款具有不同分辨率的设备会怎样。事情现在可能看起来一团糟。

当您自己对元素进行编码时，您会更加了解约束并可以创建公式来根据屏幕大小对其进行调整。你有幸使用 iOS，设备数量有限。也就是说，如果你突然开始为 Android 开发，你可能会发现自己卡住了。

另一件事，如果你做堆栈，一定要使用自动引用计数（ARC）。很可能你是，但如果你不是，那么在情节提要上创建元素将立即被带入内存，而不是等到它们被称为“隐藏”。如果您从隐藏项目开始，ARC 可以确定您并不真的希望将事物带入内存。

无论如何，目前这真的取决于你。我个人觉得堆叠一些物品非常实用，但我确实喜欢看看我在做什么。祝你好运。

# ios - 在 UIWebView 中编辑同步 ajax 请求的响应

> ID：13166988
> 
> 赞同：1
> 
> 时间：2012-10-31T20:31:36.800
> 
> 标签：ios, ajax, cordova, uiwebview, xmlhttprequest

我知道这是一个长镜头。如果可能的话，它可能会在 PhoneGap 中得到支持，但是是否可以拦截由运行在 a 上的 JS 代码（在 html 文件中）执行的同步 AJAX 请求`UIWebView`，执行一些本机调用并编辑响应？类似于 PhoneGap 所做的，但同步而不是异步（而不是必须将异步 PhoneGap 回调链接到“死亡金字塔”或使用[Promises](https://github.com/stackp/promisejs)）。

也许以某种方式使用`NSURLProtocol`/ `NSURCLCache`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:59:33.990

我有完全相同的需求：我想在 Objective-c 中捕获 AJAX 请求并将一些缓存的响应返回给 javascript 处理程序。我设法使用 NSURLProtocol 让它工作，你可以在这里看到完整的实现：

[如何使用 NSURLProtocol 模拟 AJAX 调用？](https://stackoverflow.com/questions/15224071/how-to-mock-ajax-call-with-nsurlprotocol/15234787#15234787)

# sql - PostgreSQL 中的逻辑条件

> ID：13166996
> 
> 赞同：-2
> 
> 时间：2012-10-31T20:31:59.927
> 
> 标签：sql, postgresql, relational-division

我想知道每一位导演过 20 多部电影并参与过他导演的每一部电影的男导演的名字。如果他演了一部电影，但没有导演，那没关系，我仍然想要他的名字；如果他导演了任何电影但没有出演，我不再想要他了。

```
SELECT p.firstname, 
    p.lastname 
FROM person p 
WHERE p.gender = 'M' AND
(
    SELECT COUNT(*)
    FROM filmparticipation fpd 
    WHERE p.personid = fpd.personid AND
        fpd.parttype = 'director' AND
        (
            SELECT COUNT(*) 
            FROM filmparticipation c 
            WHERE c.personid = fpd.personid AND
                c.filmid = fpd.filmid AND
                c.parttype = 'cast'
        ) > 0
) >= 20; 
```

这只是我的多次尝试之一。作为一个附带问题，为什么它不起作用？我确保我正在检查正确的导演电影 ID 到演员电影 ID 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:58:27.330

可能看起来像这样：

```
SELECT p.firstname, p.lastname 
FROM   person p
JOIN  (
   SELECT fd.personid
   FROM   filmparticipation fd
   LEFT   JOIN filmparticipation fc USING (personid, filmid)
   WHERE  fd.parttype = 'director'
   AND    fc.parttype = 'cast'
   GROUP  BY fd.personid
   HAVING count(*) > 20  -- 21+ movies directed (NULL not counted)
   AND    NOT bool_or(fc.personid IS NULL) -- no movie directed but not cast
   ) AS fp USING (personid)
WHERE  p.gender = 'M'; 
```

在子查询中，我[`LEFT [OUTER] JOIN`](http://www.postgresql.org/docs/current/interactive/sql-select.html#SQL-FROM)在同一部电影的同一个人导演和演员的所有行中 - 他只导演了其余的地方`NULL`。这就是 a 的`LEFT JOIN`作用。这假设同一个人只能在同一部电影中以同一角色出现*一次（UNIQUE 或 PK 约束！）。*

Grouping by`personid`必须导致超过 20 行，并且没有一个转换`personid`可以是`NULL`. `JOIN`到 person 表并限制为男性，你就完成了。

有很多方法可以解决它，*这*应该是最快的一种。