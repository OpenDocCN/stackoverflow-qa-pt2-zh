# StackOverflow 问答 15168000-15168999

# c# - 将 Moq 用于存储库接口方法？

> ID：15168001
> 
> 赞同：1
> 
> 时间：2013-03-01T22:35:05.873
> 
> 标签：c#, moq

我的存储库界面上有以下方法：

```
IQueryable<T> GetQuery<T>(Expression<Func<T, bool>> predicate) where T : class; 
```

我有一个要在单元测试中使用以下构造函数的类：

```
public MyClass(IUnitOfWork unitOfWork) 
```

在`IUnitOfWork`Interface 上有一个暴露的 Repository 属性：

```
Repository Repository { get; } 
```

所以我正在尝试`MyClass.DoSomething()`像这样对方法进行单元测试：

```
[TestInitialize]
public void Setup()
{

    accounts = new List<Account>()
    {
        new Account()
            {
               Id = 123
            }
    };
} 
```

接下来我有`Arrange`失败的单元测试部分：

```
//Arrange
var repositoryMock = new Mock<IUnitOfWork>();
repositoryMock.Setup(x => x.Repository.GetQuery<Account>(y => y.Id == 123))
                           .Returns(accounts.AsQueryable()); //This setup always fails
var myClass = new MyClass(repositoryMock.Object); //don't even get here 
```

我得到的例外是：

> **System.NotSupportedException：非虚拟（在 VB 中可覆盖）成员上的设置无效：x => x.Repository.GetQuery(y => y.Id == 123)**

我`Setup`在模拟上尝试了其他变体：

```
repositoryMock.Setup(x => x.Repository.GetQuery<Account>()).Returns((Account a) => accounts.AsQueryable().Where(z => z.Id == 123)); 
```

和

```
repositoryMock.Setup(x => x.Repository.GetQuery<Account>(y => y.Id == 123)).Returns((Account a) => accounts.AsQueryable().Where(z => z == a)); 
```

但没有成功；我每次都得到相同的异常。当我运行单元测试时，它们总是抛出相同的异常。由于我使用的是要模拟的接口，为什么会出现此异常以及如何正确执行此操作？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:41:07.587

而不是你当前的设置试试这个：

```
//Arrange
var repositoryMock = new Mock<IUnitOfWork>();
repositoryMock.Setup(x => x.Repository.GetQuery<Account>(
        It.IsAny<Expression<Func<T, bool>>>());
    .Returns(accounts.AsQueryable()); // This should not fail any more
var myClass = new MyClass(repositoryMock.Object); 
```

实际上，您不需要传递任何具体的 lambda，因为您正在以任何方式返回您的列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:40:59.187

您显示的 Repository 属性不是接口类型。这是一些具体的课程。正如错误消息告诉您的那样，您不能定义对非虚拟方法的期望。因此，如果您希望能够模拟它，您应该做的是使用抽象：

```
IRepository Repository { get; } 
```

# model-view-controller - kogrid javascript库运行时异常

> ID：15168003
> 
> 赞同：0
> 
> 时间：2013-03-01T22:35:25.997
> 
> 标签：model-view-controller, knockout.js, kogrid

我刚刚通过 NUget 安装了 kogrid 我正在使用[此处提供的简单网格示例](http://ericmbarnard.github.com/KoGrid/#/examples)

但是当我运行我的 mvc 应用程序时，它只会在 kogrid.js 文件中引发以下异常

Microsoft Jscript 运行时错误：对象不支持属性或方法“peek”

# python - Hadoop Streaming 破坏了 Python 生成的 Avro

> ID：15168007
> 
> 赞同：0
> 
> 时间：2013-03-01T22:35:36.637
> 
> 标签：python, hadoop, mapreduce, avro

我有一个相当简单的脚本，它以 JSON 格式获取 Twitter 数据并将其转换为 Avro 文件。

```
from avro import schema, datafile, io
import json, sys
from types import *

def main():
    if len(sys.argv) < 2:
        print "Usage: cat input.json | python2.7 JSONtoAvro.py output"
        return

    s = schema.parse(open("tweet.avsc").read())
    f = open(sys.argv[1], 'wb')

    writer = datafile.DataFileWriter(f, io.DatumWriter(), s, codec = 'deflate')

    failed = 0

    for line in sys.stdin:
        line = line.strip()

    try:
        data = json.loads(line)
    except ValueError as detail:
        continue

    try:
        writer.append(data)
    except io.AvroTypeException as detail:
        print line
        failed += 1

writer.close()

print str(failed) + " failed in schema"

if __name__ == '__main__':
    main() 
```

从那里，我使用它来提供一个基本的 Hadoop Streaming 脚本（也在 Python 中），它只是提取推文的某些元素。但是，当我这样做时，脚本的输入似乎是损坏的 JSON。通常 JSON 会在推文正文或用户定义的描述中间出现一些错误的 \u 失败。

这是我用来调用 Hadoop Streaming 的 bash 脚本：

```
jars=/usr/lib/hadoop/lib/avro-1.7.1.cloudera.2.jar,/usr/lib/hive/lib/avro-mapred-1.7.1.cloudera.2.jar

hadoop jar /usr/lib/hadoop-mapreduce/hadoop-streaming.jar \
    -files $jars,$HOME/sandbox/hadoop/streaming/map/tweetMapper.py,$HOME/sandbox/hadoop/streaming/data/keywords.txt,$HOME/sandbox/hadoop/streaming/data/follow-r3.txt \
     -libjars $jars \
     -input /user/ahanna/avrotest/avrotest.json.avro \
     -output output \
     -mapper "tweetMapper.py -a" \
     -reducer org.apache.hadoop.mapred.lib.IdentityReducer \
     -inputformat org.apache.avro.mapred.AvroAsTextInputFormat \
     -numReduceTasks 1 
```

我正在拉扯我的头发试图解决这个问题。任何建议都会非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-18T19:33:39.210

不确定您是否仍在寻找答案。\u 似乎是 unicode 字符。尝试类似的东西

```
 resp = json.dumps(line) 
   data = json.loads(resp) 
```

如果是导致错误的 unicode 表示，则转储将解决它。

# html - 更改缩略图大小

> ID：15168009
> 
> 赞同：0
> 
> 时间：2013-03-01T22:35:41.463
> 
> 标签：html, thumbnails

这是我要更改的屏幕截图： ![在此处输入图像描述](../Images/d270f3d6d8b2b03188b6a1f3eeaee19c.png)

这是我猜想更改的代码片段：

```
<div id="gallery" class="lbGallery" style="width: 680px">
        <ul>
          <div align="center">
            <div align="center">&nbsp;</div>
          </div>
          <div align="left">
            <div>&nbsp;<a href="http://pacificrollers.com/images/lightbox/kwokwah1.jpg" title=""><img alt="" title="" src="http://pacificrollers.com/images/lightbox/kwokwah1.jpg" border="0" height="200%" width="273%" /></a><br />
            </div>
          </div>
          <p align="center"></p>
          <p align="center"></p>
          <p align="center"></p>
          <p align="center"></p>
          <p align="center">&nbsp;</p>
          <p align="center"></p>
          <p align="center">&nbsp;</p>
          <p align="center"></p>
          <p align="center">&nbsp;</p>
          <p align="center"></p>
          <p align="center">&nbsp;</p>
          <p align="center"></p>
          <p align="center">&nbsp;</p>
          <p align="center"></p>
          <p align="center"></p>
          <p align="center"></p>
          <p align="center">
          <p align="center">&nbsp;</p>
          </p>
          <p align="center"><a href="http://pacificrollers.com/images/lightbox/kwokwah2.jpg" title=""><img alt="" title="" src="http://pacificrollers.com/images/lightbox/kwokwah2.jpg" border="0" height="2483" width="1755" /></a>
          <p align="center">&nbsp;</p>
          </p>
          <p align="center"></p>
          <p align="center">&nbsp;</p>
          <p align="center"></p>
          <p align="center">&nbsp;</p>
          <p align="center"></p>
          <p align="center"></p>
          <p align="center"></p>
          <p align="center"></p>
          <p align="center"></p>
          <p align="center"></p>
          <div align="center">&nbsp;</div>
          <p align="center"></p>
          <div align="center"></div>
        </ul>
      </div> 
```

但是，我不确定如何更改缩略图大小。我在谷歌上搜索，仍然很难找到一致的方法来改变它。我怀疑我需要更改`<img>`标签内容，但不完全确定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:38:30.253

更改元素的`width`和`height`属性`<img />`。

...但是没有任何借口`<p align="center">`，看到你的 HTML 让我觉得我回到了 1999 年。

*更新：*

查看屏幕截图，网页中的两个图像在屏幕上具有相同的尺寸，尽管具有不同的属性值。它们的大小可能由样式表指定。`img`在任何引用的 CSS 或块中查找并考虑删除这些规则或使用带有关键字的属性在`<style>`本地覆盖它们。`style=""``!important`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:40:11.513

`<p align="center"><a href="http://pacificrollers.com/images/lightbox/kwokwah2.jpg" title=""><img alt="" title="" src="http://pacificrollers.com/images/lightbox/kwokwah2.jpg" border="0" height="2483" width="1755" /></a>`

这让您将`height`and设置`width`为非常大的值。你能试着把它们变小吗？

**注意**：这不会生成真正的缩略图，它仍会加载整个图像，但只是将其缩小。如果您想要一个实际的缩​​略图，那么您将需要创建某种程序化方式来缩小图像并提供缩略图大小的图像。

很多很多s也有很多担心`<p align="center">&nbsp;</p>`。您可能希望使用 CSS 对其进行样式设置，而不是对这些换行符进行硬编码。

# excel - 使用 Open XML SDK 保护 Excel 文件密码

> ID：15168011
> 
> 赞同：1
> 
> 时间：2013-03-01T22:35:55.950
> 
> 标签：excel, passwords, openxml, protection

我正在使用 Open XML SDK 创建 excel 文件。

我想用密码保护他们。

您是否知道使用 Open XML SDK 使用密码保护 excel 文件？

我知道保护它们的“com”对象方式，但是它不适合我的应用程序。我需要使用 Open XML SDK 或其他方式来保护文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T20:33:24.813

可以通过打开 xml 创建用于保护工作簿或工作表的 excel 密码。

以下代码示例是文森特的建议（[http://spreadsheetlight.com/about/](http://spreadsheetlight.com/about/)）（[https://stackoverflow.com/users/12984/vincent-tan](https://stackoverflow.com/users/12984/vincent-tan)）（再次感谢他：）

```
 using (SpreadsheetDocument spreadSheet = SpreadsheetDocument.Open(docname,true))
        {
            foreach (var worksheet in spreadSheet.WorkbookPart.WorksheetParts)
           {
                worksheet.Worksheet.Append(new SheetProtection(){ Password = “CC”});
               // add this in case it still doesn’t work. This makes sure the data is saved.
               //worksheet.Worksheet.Save();
           }
        } 
```

如果你有图表或其他东西

以下代码示例是文森特的建议（[http://spreadsheetlight.com/about/](http://spreadsheetlight.com/about/)）（[https://stackoverflow.com/users/12984/vincent-tan](https://stackoverflow.com/users/12984/vincent-tan)）（再次感谢他：）

```
bool bFound;
OpenXmlElement oxe;
SheetProtection prot;
using (SpreadsheetDocument spreadSheet = SpreadsheetDocument.Open("OtoPark.xlsx", true))
{
    foreach (var worksheet in spreadSheet.WorkbookPart.WorksheetParts)
    {
        prot = new SheetProtection();
        prot.Password = "CC";
        // these are the "default" Excel settings when you do a normal protect
        prot.Sheet = true;
        prot.Objects = true;
        prot.Scenarios = true;

        // Open up Excel and do a password protect yourself and use the
        // Productivity Tool to see the property values of the resulting Excel file.
        // Consider not using the Password property and use:
        //prot.AlgorithmName = "SHA-512";
        //prot.HashValue = "somehashvaluebythealgorithm";
        //prot.SaltValue = "somesalt";
        //prot.SpinCount = 100000;

        bFound = false;
        oxe = worksheet.Worksheet.FirstChild;
        foreach (var child in worksheet.Worksheet.ChildElements)
        {
            // start with SheetData because it's a required child element
            if (child is SheetData || child is SheetCalculationProperties)
            {
                oxe = child;
                bFound = true;
            }
        }

        if (bFound)
        {
            worksheet.Worksheet.InsertAfter(prot, oxe);
        }
        else
        {
            worksheet.Worksheet.PrependChild(prot);
        }

        worksheet.Worksheet.Save();
    }
} 
```

这些方法可以保护任何用户无法意外更改数据。但是，如果您不希望任何不知道密码的用户查看数据，那么您可以使用以下库：

[http://dotnetzip.codeplex.com/](http://dotnetzip.codeplex.com/)

您有一个受密码保护的压缩文件，其中包含使用 dotnetzip 库的 excel.xlsx 文件。

一个例子：

```
public void RNCreateZipFile(string ExcelDocName,string PassWord, string ZipDocName)
{
    // create a zip
    using (var zip = new ZipFile())
    {
        zip.Password = PassWord;
        zip.AddFile(ExcelDocName, "");
        zip.Save(ZipDocName);
    }
} 
```

# python - 从 Ubuntu 10.10 升级到 12.04 后，multiprocessing.map 和 joblib 都只使用 1 个 cpu

> ID：15168014
> 
> 赞同：6
> 
> 时间：2013-03-01T22:36:22.963
> 
> 标签：python, multiprocessing, ubuntu-12.04

我有一些完美运行的 python 代码，它使用了多处理模块并以 100% 的速度在我的机器上加载了所有 8 个 CPU。

在我从 Ubuntu 10.10 升级到 12.04 之后（最明显的事情，也许我做了其他事情破坏了一切），它停止了工作。经过大量调试，我发现即使在最简单的用例中，两个模块也只使用 1 个 CPU：

```
from pylab import *
import multiprocessing as mp
from joblib import Parallel, delayed

def f(i):
    # Slow calculation
    x = 1
    for j in range(100000): x = cos(x)
    print i, x

if __name__ == '__main__':
    # Try to multiprocess with multiprocessing
    mp.Pool(processes=8).map(f, range(100))
    # Try to multiprocess with joblib
    Parallel(n_jobs=8)(delayed(f)(i) for i in range(100)) 
```

我需要使用系统中的所有 8 个 CPU。关于我应该看什么来解决这个问题的任何想法？

编辑：

正如 ali_m 在此处的评论中以及在 [我导入 numpy 后为什么多处理只使用单个内核的答案中所指出的那样？](https://stackoverflow.com/questions/15639779/what-determines-whether-different-python-processes-are-assigned-to-the-same-or-d)问题与`numpy`弄乱 cpu 亲和力有关。打电话

```
os.system('taskset -p 0xffffffff %d' % os.getpid()) 
```

在我做任何多处理之前为我解决了这个问题。

# java - 如何动态加载 R.styleable 资源？

> ID：15168018
> 
> 赞同：5
> 
> 时间：2013-03-01T22:36:37.067
> 
> 标签：java, android, facebook-android-sdk, android-resources

我正在尝试将 Facebook Android SDK 导出为 JAR 以在我的项目中使用。

这需要动态加载所有资源。

例如，我必须进行类似这样的更改：

```
//findViewById(R.id.com_facebook_login_activity_progress_bar).setVisibility(View.VISIBLE);
int viewID = getResources().getIdentifier("com_facebook_login_activity_progress_bar", "id", getPackageName());
findViewById(viewID).setVisibility(View.VISIBLE); 
```

注释行显示了原始内容，下面的 2 行显示了我为动态加载相同资源所做的更改。

Facebook SDK 声明了一个 R.styleable 资源，我不知道如何动态加载它。这是原始代码：

```
private void parseAttributes(AttributeSet attrs) {
    TypedArray a = getContext().obtainStyledAttributes(attrs, R.styleable.com_facebook_profile_picture_view);
    setPresetSize(a.getInt(R.styleable.com_facebook_profile_picture_view_preset_size, CUSTOM));
    isCropped = a.getBoolean(R.styleable.com_facebook_profile_picture_view_is_cropped, IS_CROPPED_DEFAULT_VALUE);
    a.recycle();
} 
```

然后在 attrs.xml 中声明如下：

```
 <declare-styleable name="com_facebook_profile_picture_view">
        <attr name="preset_size">
            <!-- Keep in sync with constants in ProfilePictureView -->
            <enum name="small" value="-2" />
            <enum name="normal" value="-3" />
            <enum name="large" value="-4" />
        </attr>
        <attr name="is_cropped" format="boolean" />
    </declare-styleable> 
```

如何动态加载此资源（例如替换 R.styleable 参考）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T23:10:11.320

我在这里回答这个问题，以防有人专门尝试将 Facebook SDK 导出为 jar。

我使用了这个问题的答案中描述的函数： [Accessing <declare-styleable> resources programatically](https://stackoverflow.com/questions/13816596/accessing-declare-styleable-resources-programatically)

```
private void parseAttributes(AttributeSet attrs) {
    int attrArray[] = StyleableHelper.getResourceDeclareStyleableIntArray(getContext(), "com_facebook_profile_picture_view");
    //TypedArray a = getContext().obtainStyledAttributes(attrs, R.styleable.com_facebook_profile_picture_view);
    TypedArray a = getContext().obtainStyledAttributes(attrs, attrArray);

    setPresetSize(a.getInt(0, CUSTOM));
    isCropped = a.getBoolean(1, IS_CROPPED_DEFAULT_VALUE);
    //setPresetSize(a.getInt(R.styleable.com_facebook_profile_picture_view_preset_size, CUSTOM));
    //isCropped = a.getBoolean(R.styleable.com_facebook_profile_picture_view_is_cropped, IS_CROPPED_DEFAULT_VALUE);
    a.recycle();
} 
```

# javascript - 如何保护 EmberJS 或任何 Javascript MVC 框架？

> ID：15168019
> 
> 赞同：11
> 
> 时间：2013-03-01T22:36:43.450
> 
> 标签：javascript, security, model-view-controller, ember.js

我期待开始`Ember.js`在现实生活项目中使用，但作为来自 Java 背景的人，我总是关心安全性。

当我对我的 Java 开发人员说，我开始使用 JavaScript MVC 时，他们开始说它不够安全，因为 JavaScript 是关于客户端的，总有办法破解你的 JavaScript 代码，并且知道你的后门服务和 API。

那么有没有什么好的做法可以帮助防止这种攻击，或者至少试图降低它的有效性？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-03-01T22:46:04.063

> 总有一种方法可以破解您的 javascript 代码，并了解您的服务和 API 的后门。

对于已经暴露在 Web 上的服务和 API，JavaScript 几乎没有出现新问题。您的服务器/服务不应该盲目地信任来自网络的请求，因此使用 javascript 不会改变您的安全状态，但它可以让人们误以为他们控制了用户代理，从而产生了一种错误的安全感。

客户端/服务器安全的基本规则还是一样的：**不要信任用户代理**；将服务器和客户端放置在[信任边界](https://www.owasp.org/index.php/Trust_Boundary_Violation)的不同侧。

> 信任边界可以被认为是通过程序绘制的线。一方面，数据不受信任。另一方面，假设数据是可信的。验证逻辑的目的是让数据安全地跨越信任边界——从不信任转移到信任。

验证服务器从客户端接收到的所有内容，并且由于 XSS 漏洞很常见并且允许客户端访问发送给客户端的信息，因此尽可能少地向客户端发送敏感信息。

当您确实需要将数据从服务器到客户端并返回时，您可以使用多种技术。

1.  对数据进行加密签名，以便服务器可以验证它没有被篡改。
2.  将数据存储在边表中，并且只发送一个不透明的、不可猜测的标识符。

当您确实需要向客户端发送敏感数据时，您还有多种策略：

1.  将数据存储在仅 HTTP cookie 中，这些 cookie 附加到请求但 JavaScript 无法读取
2.  将您的客户划分为不同来源的 iframe，并将敏感信息隔离在经过特别仔细审查的 iframe 中，并且具有最少的多余功能。

* * *

# 签约

签名解决了验证您从不受信任的来源收到的数据是否是您之前验证的数据的问题。它不能解决窃听（因为您需要加密）或决定不返回数据或决定替换使用相同密钥签名的不同数据的客户端的问题。

[Django](https://docs.djangoproject.com/en/dev/topics/signing/)文档很好地解释了“传递”数据的加密签名，该文档还概述了如何使用它们的 API。

> Web 应用程序安全的黄金法则是永远不要信任来自不受信任来源的数据。有时通过不受信任的介质传递数据可能很有用。在知道任何篡改都会被检测到的情况下，加密签名的值可以通过不受信任的安全通道传递。
> 
> Django 提供了一个用于签名值的低级 API 和一个用于设置和读取签名 cookie 的高级 API，这是 Web 应用程序中最常见的签名用途之一。
> 
> 您可能还会发现签名对以下内容很有用：
> 
> 1.  生成“恢复我的帐户”URL 以发送给丢失密码的用户。
> 2.  确保存储在隐藏表单字段中的数据未被篡改。
> 3.  生成一次性秘密 URL 以允许临时访问受保护的资源，例如用户付费的可下载文件。

* * *

# 不透明的标识符

不透明的标识符和边表解决了与签名相同的问题，但需要服务器端存储，并且要求存储数据的机器可以访问与接收回标识符的机器相同的数据库。

通过查看此图，可以轻松理解带有不透明、不可猜测的标识符的边表

```
 Server DB Table

+--------------------+---------------------+
| Opaque Primary Key | Sensitive Info      |
+--------------------+---------------------+
| ZXu4288a37b29AA084 | The king is a fink! |
| ...                | ...                 |
+--------------------+---------------------+ 
```

您使用[随机或安全的伪随机数生成器生成](http://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator)密钥并将密钥发送给客户端。

如果客户端有密钥，他们只知道他们拥有一个随机数，并且可能与他们从您那里收到的其他随机数相同，但无法从中获取内容。

如果他们篡改（发回不同的密钥），那么那将不会出现在您的表中（可能性非常高），因此您将检测到篡改。

如果您向同一个行为不端的客户端发送多个密钥，它们当然可以用一个替换另一个。

* * *

# [仅 HTTP cookie](https://www.owasp.org/index.php/HttpOnly)

当您发送一个不希望它意外泄漏给其他用户代理的每个用户代理秘密时，仅 HTTP cookie 是一个不错的选择。

> 如果 HttpOnly 标志（可选）包含在 HTTP 响应标头中，则无法通过客户端脚本访问 cookie（同样，如果浏览器支持此标志）。因此，即使存在跨站点脚本 (XSS) 漏洞，并且用户意外访问了利用此漏洞的链接，浏览器（主要是 Internet Explorer）也不会将 cookie 泄露给第三方。

现代浏览器广泛支持 HttpOnly cookie。

* * *

# 隔离的 iframe

将您的应用程序划分为多个 iframe 是当前允许富客户端操作敏感数据同时将意外泄漏风险降至最低的最佳方式。

基本思想是在一个较大的程序中包含小程序（安全内核），以便您的安全敏感代码可以比整个程序更仔细地审查。这与[qmail 的合作可疑进程的](http://hillside.net/plop/2004/papers/mhafiz1/PLoP2004_mhafiz1_0.pdf)工作方式相同。

> 安全模式：分区 [VM02]
> 
> # 问题
> 
> 系统某一部分的安全故障允许系统的另一部分被利用。
> 
> # 解决方案
> 
> 将每个部分放在一个单独的安全域中。即使一个部分的安全性受到损害，其他部分仍然是安全的。

[“HTML5 方式的跨框架通信”](http://stevehanov.ca/blog/index.php?id=109)解释了 iframe 如何进行通信。由于它们在不同的域上，安全敏感的 iframe 知道其他域上的代码只能通过这些狭窄的通道与其通信。

> HTML 允许您在元素中将一个网页嵌入到另一个网页中。它们基本上保持分离。容器网站只允许与其 Web 服务器通信，而 iframe 只允许与其源服务器通信。此外，由于它们具有不同的来源，浏览器不允许两个框架之间的任何接触。这包括函数调用和变量访问。
> 
> 但是如果你想在两个独立的窗口之间获取一些数据呢？例如，zwibbler 文档在转换为字符串时可能是兆字节长。我希望包含网页能够在需要时获取该字符串的副本，以便保存它。此外，它应该能够访问用户生成的已保存 PDF、PNG 或 SVG 图像。HTML5 提供了一种在同一窗口的不同框架之间进行通信的受限方式，称为 window.postMessage()。

现在，安全敏感框架可以使用标准验证技术来审查来自（可能受到损害的）不太敏感框架的数据。

您可以让一大群程序员高效地工作以生成出色的应用程序，而一小群程序员则致力于确保正确处理敏感数据。

一些缺点：

1.  启动应用程序更复杂，因为没有单一的“加载”事件。
2.  iframe 通信需要传递需要解析的字符串，所以对安全敏感的帧仍然需要使用安全的解析方法（没有`eval`来自 postMessage 的字符串。）
3.  iframe 是矩形的，所以如果安全敏感的框架需要呈现 UI，那么它可能不容易整齐地融入更大的应用程序的 UI。

# python - 从另一个模块访问对象

> ID：15168024
> 
> 赞同：8
> 
> 时间：2013-03-01T22:37:15.390
> 
> 标签：python, object, scope

我是一个非常缺乏经验的程序员，我创建一个游戏（使用 Python 3.3）作为学习练习。我目前有一个主模块和一个战斗模块。

游戏中的人由“Person”类的实例表示，并在主模块中创建。但是，战斗模块显然需要访问这些对象。此外，我稍后可能会创建更多模块，这些模块也需要访问这些对象。

如何允许其他模块从 main.py 访问 Persons？

就目前而言， main.py 有

```
import combat 
```

在顶部; 添加

```
import main 
```

战斗.py 似乎没有帮助。

我应该在一个单独的模块（common.py？）中实例化我的对象并将它们导入到需要访问它们的每个模块中吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-01T22:43:53.913

是的，您绝对应该考虑到这一点。您尝试的是模块之间的循环导入，这可能会带来很大的问题。如果`combat`imports`main`和`main`imports `combat`，那么你可能会得到一个异常，因为在开始执行导入`main`时还没有完成执行。`combat`假设`main`是您的启动脚本，它可能只是实例化一个类或从另一个模块调用一个方法。也避免使用全局变量。即使现在看起来它们不会成为问题，但以后可能会在后面咬你。

也就是说，您可以像这样引用模块的成员：

```
import common
x = common.some_method_in_common()
y = common.SomeClass() 
```

或者

```
from common import SomeClass
y = SomeClass() 
```

就个人而言，我通常避免在没有使用模块名称限定的情况下引用来自另一个模块的方法，但这也是合法的：

```
from common import some_method_in_common
x = some_method_in_common() 
```

我通常`from ... import ...`用于类，我通常将第一种形式用于方法。（是的，这有时意味着除了导入模块本身之外，我还从模块导入了特定的类。）但这只是我个人的约定。

*强烈*建议不要使用另一种语法是

```
from common import *
y = SomeClass() 
```

这会将 common 的每个成员导入当前范围，但不以下划线 ( `_`) 开头。我不鼓励它的原因是因为它使理解名称的来源并且使破坏事情变得太容易了。考虑这对导入：

```
from common import *
from some_other_module import *
y = SomeClass() 
```

来自哪个模块`SomeClass`？除了去看看这两个模块之外，没有别的办法。更糟糕的是，如果**两个**模块都定义`SomeClass`或`SomeClass`稍后添加到`some_other_module`?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:46:30.217

if you have imported main module in `combat` module by using `import main`, then you should use main.*(stuff that are implemented in main module) to access classes and methods in there.

example:

```
import main

person = main.Person() 
```

also you can use `from main import *` or `import Person` to avoid main.* in the previous.

There are some rules for importing modules as described in [http://effbot.org/zone/import-confusion.htm](http://effbot.org/zone/import-confusion.htm) :

1.  `import X` imports the module X, and creates a reference to that module in the current namespace. Or in other words, after you’ve run this statement, you can use `X.name` to refer to things defined in module X.
2.  `from X import *` imports the module X, and creates references in the current namespace to all public objects defined by that module (that is, everything that doesn’t have a name starting with “_”). Or in other words, after you’ve run this statement, you can simply use a plain name to refer to things defined in module X. But X itself is not defined, so `X.name` doesn’t work. And if name was already defined, it is replaced by the new version. And if name in X is changed to point to some other object, your module won’t notice.
3.  `from X import a, b, c` imports the module X, and creates references in the current namespace to the given objects. Or in other words, you can now use `a` and `b` and `c` in your program.
4.  Finally, `X = __import__(‘X’)` works like `import X`, with the difference that you

    1) pass the module name as a string, and

    2) explicitly assign it to a variable in your current namespace.

# c# - ImageResizer - 如果图像小于请求的大小，则不重新保存图像

> ID：15168040
> 
> 赞同：1
> 
> 时间：2013-03-01T22:38:39.973
> 
> 标签：c#, asp.net-mvc, imageresizer

好的，我正在尝试在我的网络应用程序中使用[ImageResizer 组件。](http://imageresizing.net/)我有以下代码：

```
var versions = new Dictionary<string, string>();
//Define the versions to generate
versions.Add("_001", "maxwidth=300&maxheight=300&format=jpg");
versions.Add("_002", "maxwidth=600&maxheight=600&format=jpg");
versions.Add("_003", "maxwidth=1920&maxheight=1080&format=jpg&process=no"); // I expect it not to resave the image if original is smaller

string uploadFolder = "...my folder path...";
if (!Directory.Exists(uploadFolder))
    Directory.CreateDirectory(uploadFolder);

//Generate each version
foreach (string suffix in versions.Keys)
{
    //Generate a filename (GUIDs are best).
    string fileName = Path.Combine(uploadFolder, DEFAULT_IMAGE_NAME + suffix);

    //Let the image builder add the correct extension based on the output file type
    fileName = ImageBuilder.Current.Build(file, fileName, new ResizeSettings(versions[suffix]), false, true);
}

file.SaveAs(uploadFolder + DEFAULT_IMAGE_NAME + "_000.jpg"); 
```

如您所知，我正在保存一个图像 + 原始图像的 3 个版本。但是，如果需要调整大小，我只希望重新编码和重新保存图像。因此，如果我上传 1000x1000 图像，我希望 main_000.jpg 和 main_003.jpg 是相同的。但是，情况并非如此（ImageResizer 也会调整该图像的大小，并且通常保存的文件大小大于 main_000.jpg）。

我尝试添加 process=no 作为参数，但它不起作用。任何人都知道是否支持这种情况以及我需要添加哪个参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:01:01.137

```
//it may need to be improved
    Dictionary<string, SavingSettings> SaveVersions = new Dictionary<string, SavingSettings>();
    public void page_load(object sender, EventArgs e) {
        //set versions:
        SaveVersions.Add("xxl", new SavingSettings("xxl", new ImageResizer.ResizeSettings())); //original size
        SaveVersions.Add("600px", new SavingSettings("600px", new ImageResizer.ResizeSettings(600, 600, ImageResizer.FitMode.Max, "jpg"))); //big
        SaveVersions.Add("80px", new SavingSettings("80px", new ImageResizer.ResizeSettings(80, 80, ImageResizer.FitMode.Max, "jpg"))); //80 px thumb
        SaveVersions.Add("260w", new SavingSettings("260w", new ImageResizer.ResizeSettings(260, 0, ImageResizer.FitMode.Max, "jpg"))); //260 px width thumb

    }

    public void SaveIt(string SourceFile,string TargetFileName) {
        using(System.Drawing.Bitmap bmp = ImageResizer.ImageBuilder.Current.LoadImage(SourceFile, new ImageResizer.ResizeSettings())) {
            foreach(System.Collections.Generic.KeyValuePair<string, SavingSettings> k in SaveVersions) {
                string TargetFilePath = Server.MapPath("../img/" + k.Value.VersionName + "/" + TargetFileName + ".jpg");
                string TargetFolder = Server.MapPath("../img/" + k.Value.VersionName);
                if(!System.IO.Directory.Exists(TargetFolder)) System.IO.Directory.CreateDirectory(TargetFolder);
                if(bmp.Width > k.Value.ResizeSetting.Width || bmp.Height > k.Value.ResizeSetting.Height) {
                    //you may need to resize
                    ImageResizer.ImageBuilder.Current.Build(bmp, TargetFilePath, k.Value.ResizeSetting, false);
                } else {
                    //just copy it
                    //or in your example you can save uploaded file
                    System.IO.File.Copy(SourceFile, TargetFilePath);
                }
            }
        }
    }

    struct SavingSettings {
        public string VersionName;
        public ImageResizer.ResizeSettings ResizeSetting;
        public SavingSettings(string VersionName, ImageResizer.ResizeSettings ResizeSetting) {
            this.VersionName = VersionName;
            this.ResizeSetting = ResizeSetting;
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:58:43.673

## 您需要使用 URL API 而不是托管 API 来执行动态图像大小调整。

只需摆脱预调整大小的代码，并将上传文件保存到磁盘（但是，请确保清理文件名或使用 GUID）。

然后，像这样使用 URL API：

```
<img src="/uploads/original.jpg?maxwidth=300&maxheight=300&format=jpg" /> 
```

# c# - 如何在 AX 查询服务中格式化日期时间比较值

> ID：15168047
> 
> 赞同：3
> 
> 时间：2013-03-01T22:39:04.593
> 
> 标签：c#, web-services, axapta, dynamics-ax-2012

我正在使用 Dynamics AX 2012 R2 查询服务，需要对 CustTable 的 modifiedDateTime 字段进行过滤（设置范围）。我正在创建一个 QueryDataRangeMetadata 对象并设置它的属性。我可以正确过滤整数值，但不能过滤 DateTimes。

我能够弄清楚比较运算符实际上嵌入了该值。我已经用整数字段对此进行了测试，它确实适用，但我无法弄清楚如何格式化 DateTime 值以便正确评估它。下面的代码不起作用。该范围被简单地忽略并返回 CustTable 中的所有记录。

```
 public static void RangeTest()
    {
        var client = new QueryServiceClient();

        var dataSource = new QueryDataSourceMetadata
        {
            Table = "CustTable",
            Name = "CustTable",
            HasRelations = false,
            Enabled = true,
            DynamicFieldList = true // get all fields
        };

        var range = new QueryDataRangeMetadata
        {
            TableName = "CustTable",
            FieldName = "modifiedDateTime",
            Value = ">2013-02-05T21:17:33Z", // <-- ISSUE: notice the operator with the value!
            Enabled = true
        };

        dataSource.Ranges = new QueryRangeMetadata[] { range };

        var sort = new QueryDataOrderByMetadata
                       {
                           DataSource = "CustTable",
                           FieldName = "modifiedDateTime",
                           SortOrder = SortOrder.Ascending
                       };

        var query = new QueryMetadata
        {
            QueryType = QueryType.Join,
            DataSources = new[] { dataSource },
            OrderByFields = new QueryOrderByMetadata[] { sort }
        };

        Paging paging = null;
        var dataSet = client.ExecuteQuery(query, ref paging);

        Console.WriteLine(dataSet.Tables[0].Rows.Count);
    } 
```

我也尝试了这些格式变化，但没有成功：

```
Value = ">2013-02-05 21:17:33"

Value = ">2013-02-05T9:17:33"

Value = ">'2013-02-05T9:17:33'"

Value = ">2013-02-05T21:17:33Z" 
```

任何人都知道在这种情况下 DateTime 的格式应该是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:57:05.303

在迭代了一堆 DateTime 格式变化之后，我刚刚从 UI 复制并粘贴了一个值，你猜怎么着？有效。这是片段：

```
 var range = new QueryDataRangeMetadata
        {
            TableName = "CustTable",
            FieldName = "modifiedDateTime",
            Value = ">2/5/2013 9:17:33 PM",
            Enabled = true
        }; 
```

所以格式似乎是：`comparison_operatorMM/DD/YYYY hh:mm:ss AM`

我在美国，格式是月优先。我想其他语言环境必须采用不同的格式，例如第一天。

# grails - 如何从 grails 过滤器中删除常见逻辑？

> ID：15168048
> 
> 赞同：3
> 
> 时间：2013-03-01T22:39:07.853
> 
> 标签：grails, grails-filters

这是专门关于 grails 1.3.7 应用程序的，但希望答案也适用于较新的版本。下面的代码是所需内容的简化版本。accountService 正在被注入。下面的代码片段完成了它应该做的事情，但显然是重复的代码。这是位于 grails-app/conf 中的 UserFilter 类

如何从过滤器中提取通用逻辑并保持重定向和检查会话的能力？我尝试将一个方法提取到过滤器类中，传入会话和闪存，但重定向仍然给我带来问题。

```
def filters = {
  // ... other filters ...
  adminAllCheck(controller: 'administration', action: '*') {
    before = {
      if(!session.isAdmin) {
        if(accountService.isAdmin()) {
          session.isAdmin = true
        } else {
          flash.message = 'Non admin'
          redirect(controller: 'home', action: 'index')
          return false
        }
      }
      true
    }
  }
  userListCheck(controller: 'user', action: 'list') {
    before = {
      if(!session.isAdmin) {
        if(accountService.isAdmin()) {
          session.isAdmin = true
        } else {
          flash.message = 'Non admin'
          redirect(controller: 'home', action: 'index')
          return false
        }
      }
      true
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T23:22:49.710

创建辅助方法的一种方法是在`filters`闭包之外创建它，并将实例传入。传入是行不通的，`this`因为那不是闭包而是`UserFilters`实例。而是传入闭包`delegate`，这是添加`render`and`redirect`方法的地方，其中属性类似于`params`and`controllerName`是：

```
class UserFilters {
   def filters = {
      // ... other filters ...
      adminAllCheck(controller: 'administration', action: '*') {
         before = {
            doAdminCheck(delegate)
         }
      }
      userListCheck(controller: 'user', action: 'list') {
         before = {
            doAdminCheck(delegate)
         }
      }
   }

   private boolean doAdminCheck(filters) {
      if (!filters.session.isAdmin) {
         if (accountService.isAdmin()) {
            filters.session.isAdmin = true
         }
         else {
            filters.flash.message = 'Non admin'
            filters.redirect(controller: 'home', action: 'index')
            return false
         }
      }
      true
   }
} 
```

您还可以使用and参数中的`|`字符来跨控制器执行通用工作。它不能直接在这里工作，因为您用于管理控制器并且仅适用于用户控制器中的操作，但您可以对此进行显式控制器/操作名称检查：`controller``action``*``list`

```
adminCheck(controller: 'administration|user', action: '*') {
   if (controllerName == 'user' && actionName != 'list') {
      return true
   }
   // common logic here
} 
```

您还可以将逻辑移到服务中，然后将其重新注入。混合这样的层并在服务中包含 HTTP 逻辑通常不是一个好主意，但这会将逻辑保留在一个地方。您可以对委托使用相同的技巧，或者只传递会话/请求/响应/等。如所须。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:07:19.860

您可以`Closure`在您的代码（控制器？）中声明 a 之后可能会调用它。

样本 ：

```
private def ensureSessionAdmin = {
  if(!session.isAdmin) {
    if(accountService.isAdmin()) {
      session.isAdmin = true
    } else {
      flash.message = 'Non admin'
      redirect(controller: 'home', action: 'index')
      return false
    }
  }
  true
}
def filters = {
  // ... other filters ...
  adminAllCheck(controller: 'administration', action: '*') {
    before = ensureSessionAdmin
  }
  userListCheck(controller: 'user', action: 'list') {
    before = ensureSessionAdmin
  }
} 
```

# linux - 一次运行所有基本命令，然后在它们全部完成后依次运行

> ID：15168051
> 
> 赞同：1
> 
> 时间：2013-03-01T22:39:34.613
> 
> 标签：linux, bash, parallel-processing, command

我将如何运行如下几个命令，以便在完成所有后台命令后执行（清理）最后一行？

```
echo "oyoy 1" > file1 &
echo "yoyoyo 2" > file2 &
rm -f file1 file2 
```

当然，回显命令对我来说是不同的，并且需要很长时间才能完成（我可以手动删除文件或使用我知道的另一个脚本，但我想知道如何在一个脚本中完成此操作..）

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:41:39.503

从[文档](http://unixhelp.ed.ac.uk/CGI/man-cgi?wait)

```
 wait [n ...]
      Wait  for each specified process and return its termination sta-
      tus.  Each n may be a process ID or a job  specification;  if  a
      job  spec  is  given,  all  processes in that job's pipeline are
      waited for.  If n is not given, all currently active child  pro-
      cesses  are  waited  for,  and  the return status is zero.  If n
      specifies a non-existent process or job, the  return  status  is
      127\.   Otherwise,  the  return  status is the exit status of the
      last process or job waited for. 
```

所以你可以像这样等待后台进程完成：

```
echo "oyoy 1" > file1 &
echo "yoyoyo 2" > file2 &
wait
rm -f file1 file2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T23:22:09.833

或者，如果您正在运行一堆东西，并且您只需要等待几个进程完成，您可以存储一个 pid 列表，然后只等待那些。

```
echo "This is going to take forever" > file1 &
mypids=$!
echo "I don't care when this finishes" > tmpfile &
echo "This is going to take forever also" >file2 &
mypids="$mypids $!"
wait $mypids 
```

# cuda - 通过减少计算 CUDA 中位数

> ID：15168052
> 
> 赞同：1
> 
> 时间：2013-03-01T22:39:35.297
> 
> 标签：cuda, median-of-medians

我可能正在做一些非常愚蠢的事情，但我似乎无法使这种减少工作（可能已经有一个库可以做到这一点，但这是为了自学，所以请多多包涵）。我试图通过采用中位数方法来找到整数条目数组的中位数，我在下面进行了编码：

```
__global__ void gpuMedOdd(int *entries, int *med) {
        extern __shared__ int sdata[];

        int tid = threadIdx.x;
        int i = blockIdx.x * blockDim.x + threadIdx.x;

        sdata[tid] = entries[i];
        __syncthreads();

        for(int s = blockDim.x / 3; s > 0; s /= 3) {
                if(tid < s) {
                        int list[3];
                        list[0] = sdata[tid], list[1] = sdata[tid + s], list[2] = sdata[tid + 2 * s];
                        if(list[1] < list[0])
                                swapGpu(list[1], list[0]);
                        if(list[2] < list[0])
                                swapGpu(list[2], list[0]);
                        if(list[2] < list[1])
                                swapGpu(list[2], list[1]);

                        sdata[tid] = list[1];
                }

                __syncthreads();
        }

        *med = sdata[0];
} 
```

我将此内核函数调用为：

```
gpuMedOdd<<<9, numEntries / 9>>>(d_entries, d_med); 
```

然后我将 d_med 中的值复制到 med 中并打印出该值。不幸的是，无论输入如何，该值始终为 0。我究竟做错了什么？

编辑：我忘了提，swapGpu(a, b) 定义如下：

```
__device__ inline void swapGpu(int a, int b) {
        int dum = a;
        a = b;
        b = dum;
} 
```

Edit2：如下所示，这是完整的代码。

```
#include <iostream>
#include <fstream>
#include <cstdlib>

#define checkCudaErrors(err) __checkCudaErrors(err, __FILE__, __LINE__)
#define getLastCudaError(msg) __getLastCudaError(msg, __FILE__, __LINE__)

inline void __checkCudaErrors(cudaError err, const char *file, const int line) {
        if(cudaSuccess != err) {
                std::cout << file << "(" << line << ") : CUDA Runtime API error " << (int) err << ": " << cudaGetErrorString(err) << std::endl;
                exit(3);
        }
}

inline void __getLastCudaError(const char *errorMsg, const char *file, const int line) {
        cudaError_t err = cudaGetLastError();
        if(cudaSuccess != err) {
                std::cout << file << "(" << line << ") : getLastCudaError() CUDA error : " << errorMsg << " : (" << (int) err << ") " << cudaGetErrorString(err) << std::endl;
                exit(3);
        }
}

int cpuMin(int *entries, int numEntries) {
        int minVal = entries[0];

        for(int i = 1; i < numEntries; i++)
                if(entries[i] < minVal)
                        minVal = entries[i];

        return minVal;
}

int cpuMax(int *entries, int numEntries) {
        int maxVal = entries[0];

        for(int i = 1; i < numEntries; i++)
                if(entries[i] > maxVal)
                        maxVal = entries[i];

        return maxVal;
}

inline void swap(int a, int b) {
        int dum = a;
        a = b;
        b = dum;
}

__device__ inline void swapGpu(int a, int b) {
        int dum = a;
        a = b;
        b = dum;
}

__global__ void gpuMedOdd(int *entries, int *med, int numEntries) {
        extern __shared__ int sdata[];

        int tid = threadIdx.x;
        int i = blockIdx.x * (blockDim.x * 3) + threadIdx.x;

        if(i + 2 * blockDim.x < numEntries) {
                int list[3];
                list[0] = entries[i], list[1] = entries[i + blockDim.x], list[2] = entries[i + 2 * blockDim.x];
                if(list[1] < list[0])
                        swapGpu(list[1], list[0]);
                if(list[2] < list[0])
                        swapGpu(list[2], list[0]);
                if(list[2] < list[1])
                        swapGpu(list[2], list[1]);

                sdata[tid] = list[1];
        }

        __syncthreads();

        for(int s = blockDim.x / 3; s > 0; s /= 3) {
                if(tid < s && tid + 2 * s < blockDim.x) {
                        int list[3];
                        list[0] = sdata[tid], list[1] = sdata[tid + s], list[2] = sdata[tid + 2 * s];
                        if(list[1] < list[0])
                                swapGpu(list[1], list[0]);
                        if(list[2] < list[0])
                                swapGpu(list[2], list[0]);
                        if(list[2] < list[1])
                                swapGpu(list[2], list[1]);

                        sdata[tid] = list[1];
                }

                __syncthreads();
        }

        *med = sdata[0];
}

__global__ void gpuMin(int *entries, int *min, int numEntries) {
        extern __shared__ int sdata[];

        int tid = threadIdx.x;
        int i = blockIdx.x * (blockDim.x * 2) + threadIdx.x;

        if(i + blockDim.x < numEntries)
                sdata[tid] = (entries[i] < entries[i + blockDim.x]) ? entries[i] : entries[i + blockDim.x];
        __syncthreads();

        for(int s = blockDim.x / 2; s > 0; s >>= 1) {
                if(tid < s)
                        sdata[tid] = (sdata[tid] < sdata[tid + s]) ? sdata[tid] : sdata[tid + s];

                __syncthreads();
        }

        *min = sdata[0];
}

__global__ void gpuMax(int *entries, int *max, int numEntries) {
        extern __shared__ int sdata[];

        int tid = threadIdx.x;
        int i = blockIdx.x * (blockDim.x * 2) + threadIdx.x;

        if(i + blockDim.x < numEntries)
                sdata[tid] = (entries[i] > entries[i + blockDim.x]) ? entries[i] : entries[i + blockDim.x];
        __syncthreads();

        for(int s = blockDim.x / 2; s > 0; s >>= 1) {
                if(tid < s)
                        sdata[tid] = (sdata[tid] > sdata[tid + s]) ? sdata[tid] : sdata[tid + s];

            __syncthreads();
    }

    *max = sdata[0];
}

int partition(int *entries, int left, int right, int pivotIdx) {
        int i, storeIdx = left, pivot = entries[pivotIdx];

        swap(entries[pivotIdx], entries[right]);

        for(i = left; i < right; i++)
                if(entries[i] < pivot) {
                        swap(entries[i], entries[storeIdx]);
                        storeIdx++;
                }

        return storeIdx;
}

int cpuSelect(int *entries, int left, int right, int k) {
        if(left == right)
                return entries[left];

        int pivotIdx = ((left + right) >> 2) + 1, pivotNewIdx, pivotDist;

        pivotNewIdx = partition(entries, left, right, pivotIdx);

        pivotDist = pivotNewIdx - left + 1;

        if(pivotDist == k)
                return entries[pivotNewIdx];

        else if(k < pivotDist)
                return cpuSelect(entries, left, pivotNewIdx - 1, k);

        else
                return cpuSelect(entries, pivotNewIdx + 1, right, k - pivotDist);
}

int main(int argc, char *argv[]) {
        if(argc != 3) {
                std::cout << "ERROR: Incorrect number of input arguments" << std::endl;
                std::cout << "Proper usage: " << argv[0] << " fileName numEntries" << std::endl;
                exit(1);
        }

        std::ifstream inp(argv[1]);

        if(!inp.is_open()) {
                std::cout << "ERROR: File I/O error" << std::endl;
                std::cout << "Could not find file " << argv[1] << std::endl;
                exit(2);
        }

        int numEntries = atoi(argv[2]), i = 0;

        int *entries = new int[numEntries];

        while(inp >> entries[i] && i < numEntries)
                i++;

        if(i < numEntries) {
                std::cout << "ERROR: File I/O error" << std::endl;
                std::cout << "Command-line input suggested " << numEntries << " entries, but only found " << i << " entries" << std::endl;
                exit(2);
        }

        if(inp >> i) {
                std::cout << "ERROR: File I/O error" << std::endl;
                std::cout << "Command-line input suggested " << numEntries << " entries, but file contains more entries" << std::endl;
                exit(2);
        }

        int min, max;
        int *d_entries, *d_min, *d_max;

        checkCudaErrors(cudaMalloc(&d_entries, sizeof(int) * numEntries));
        checkCudaErrors(cudaMalloc(&d_min, sizeof(int)));
        checkCudaErrors(cudaMalloc(&d_max, sizeof(int)));

        checkCudaErrors(cudaMemcpy(d_entries, entries, sizeof(int) * numEntries, cudaMemcpyHostToDevice));

        gpuMin<<<16, numEntries / 16, numEntries / 16 * sizeof(int)>>>(d_entries, d_min, numEntries);
        getLastCudaError("kernel launch failure");
        gpuMax<<<16, numEntries / 16, numEntries / 16 * sizeof(int)>>>(d_entries, d_max, numEntries);
        getLastCudaError("kernel launch failure");

        checkCudaErrors(cudaMemcpy(&min, d_min, sizeof(int), cudaMemcpyDeviceToHost));
        checkCudaErrors(cudaMemcpy(&max, d_max, sizeof(int), cudaMemcpyDeviceToHost));

        std::cout << "The minimum value is: " << min << std::endl;
        std::cout << "The maximum value is: " << max << std::endl;

        if(numEntries % 2) {
                int med, *d_med;
                checkCudaErrors(cudaMalloc(&d_med, sizeof(int)));

                gpuMedOdd<<<16, numEntries / 16, 16 * sizeof(int)>>>(d_entries, d_med, numEntries);
                getLastCudaError("kernel launch failure");

                checkCudaErrors(cudaMemcpy(&med, d_med, sizeof(int), cudaMemcpyDeviceToHost));

                std::cout << "The median value is: " << med << std::endl;
        }
        else {
                int *d_med;
                cudaMalloc(&d_med, sizeof(int));
                gpuMedOdd<<<16, numEntries / 16>>>(d_entries, d_med, numEntries);
        }

        min = cpuMin(entries, numEntries);

        max = cpuMax(entries, numEntries);

        if(numEntries % 2) {
                int median = cpuSelect(entries, 0, numEntries - 1, (numEntries - 1) / 2 + 1);
                std::cout << "The median value is: " << median << std::endl;
        }

        else {
                int med2 = cpuSelect(entries, 0, numEntries - 1, numEntries / 2);
                int med1 = cpuSelect(entries, 0, numEntries - 1, numEntries / 2 + 1);

                float median = 0.5 * (med1 + med2);
                std::cout << "The median value is: " << median << std::endl;
        }

        std::cout << "The minimum value is: " << min << std::endl;
        std::cout << "The maximum value is: " << max << std::endl;

        exit(0);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:20:28.537

跳出来的一件事是您的共享内存大小未设置。也就是说，你声明你的共享内存是

```
extern __shared__ int sdata[]; 
```

但是当您调用内核时，您的启动参数是

```
gpuMedOdd<<<9, numEntries / 9>>>(...) 
```

如果您将`__shared__`内存设置为`extern`，那么它期望将共享内存的字节数作为第三个内核启动参数。你应该有

```
gpuMedOdd<<<9, numEntries / 9, smem_in_bytes>>>(...) 
```

其中`smem_in_bytes`是内核共享内存的大小。如果您不指定大小，它将默认为 0。因此，在您当前的代码中，您的`__shared__`内存数组`sdata`将是 0 字节长。

编辑：这里是 CUDA 编程指南相关部分的链接：http: [//docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#execution-configuration](http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#execution-configuration)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T02:19:16.643

我在您的代码中看到的一个问题是您的启动参数似乎颠倒了：

```
gpuMedOdd<<<16, numEntries / 16, 16 * sizeof(int)>>>(d_entries, d_med, numEntries); 
```

我想你打算：

```
gpuMedOdd<<< numEntries/16, 16, 16 * sizeof(int)>>>(d_entries, d_med, numEntries); 
```

第一个启动参数是每个网格的块数。第二个启动参数是每个块的线程数。在这里，我假设您希望每个块启动 16 个线程。如果实际上您的意图是启动固定数量的块（16）并让每个块的线程根据输入大小而变化，那么我认为这不是典型的良好 cuda 编码，如果您的输入大小得到它会爆炸太大，因为您将超过每个块的最大线程数限制。此外，由于您的共享内存分配是固定的（64 字节），我假设您打算每个块有固定数量的线程。

我的另一个建议是，您应该解析返回的错误代码，而不仅仅是报告“CUDA 运行时错误”。看看我已经提到的[示例链接。](https://stackoverflow.com/questions/14038589/what-is-the-canonical-way-to-check-for-errors-using-the-cuda-runtime-api)

# spring-el - 用于 ThymeLeaf 的自定义 SpEL 函数

> ID：15168053
> 
> 赞同：2
> 
> 时间：2013-03-01T22:39:46.580
> 
> 标签：spring-el, thymeleaf

ThymeLeaf newb 问题在这里：我想注册一个自定义 SpEL 实用程序对象以提供一些自定义格式。[Spring EL 文档](http://static.springsource.org/spring/docs/3.0.x/reference/expressions.html#expressions-ref-functions)说我应该使用StandardEvaluationContext.registerFunction() 来执行此操作，这很好，但我希望它可用于我的 ThymeLeaf 模板中的所有 SpEL 函数。我认为这是在 servlet 上下文 XML 中完成的，但我不知道如何去做，也找不到解释如何去做的 ThymeLeaf 文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-06T21:55:04.430

`StandardEvaluationContext.registerFunction()`用于为方法分配标识符，然后使用它从您的 SpEL 表达式中调用该方法。但是 Spring EL 还允许您在上下文中的任何对象上调用方法。因此，如果您只需要使一些辅助对象方法可以访问您的 SpringEL 表达式以调用，那么您只需将该辅助类的一个实例放入评估上下文即可。

# android - Android 开发按钮

> ID：15168054
> 
> 赞同：0
> 
> 时间：2013-03-01T22:39:53.887
> 
> 标签：android, button

我正在学习制作 android 应用程序，但我的 hello world 程序按钮有问题。这是我的代码：

```
 package com.Norwood.helloandroid; import android.app.Activity;
import android.os.Bundle;
import android.widget.TextView;
import android.view.View;
import android.widget.Toast;

public class MainActivity extends Activity {
   /** Called when the activity is first created. */
    @Override
   public void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       TextView tv = new TextView(this);
       tv.setText("Hello, Android.");
       setContentView(tv);
   }
   public void onclick01(View View)  
   {  
       Toast.makeText(this, "Will change in 1.2", Toast.LENGTH_SHORT).show();  
   }  

   public void onclick02(View View)  
   {  
       Toast.makeText(this, "Will change in 1.2", Toast.LENGTH_SHORT).show();  
   }  
} 
```

还有我的 XML 文件：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="@string/hello_world"
        android:textSize="60sp" />

    <Button
        android:id="@+id/Button01"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:minHeight="92sp"
        android:onClick="onclick01"
        android:text="@string/ChangeCoulour"
        android:textSize="22sp" />

    <Button
        android:id="@+id/Button02"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentBottom="true"
        android:minHeight="92sp"
        android:onClick="onclick02"
        android:text="@string/Change_Text_Colour"
        android:textSize="22sp" />

</RelativeLayout> 
```

但是当我在模拟器和我的 android 上运行该应用程序时，按钮不会显示。它们显示在 XML 文件的图形布局中。

感谢科林 N。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T22:42:40.113

尝试：

```
setContentView(R.layout.yourXml) 
```

您不能按照自己的方式进行操作，因为您必须先将视图设置为 xml。在onCreate之后有setContentview就行了

```
 TextView tv = new TextView(this);
       tv.setText("Hello, Android.");
       setContentView(tv);//wrong 
```

**回复评论：** 像这样：

```
public class MainActivity extends Activity {
   /** Called when the activity is first created. */
    @Override
   public void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       setContentView(R.layout.YOUR_XML_FILE_NAME);
       TextView tv = new TextView(this);
       tv.setText("Hello, Android.");

   } 
```

# bash - 将 execFile 用于 Bash 脚本有多安全？

> ID：15168071
> 
> 赞同：0
> 
> 时间：2013-03-01T22:41:20.237
> 
> 标签：bash, node.js, child-process

我有一个 node.js 应用程序，它使用 child_process.execFile 命令运行命令行实用程序。

我担心用户可能会在本地运行命令（`rm / -rf`想到一个恐怖的场景）。

将 execFile 用于 Bash 脚本的安全性如何？确保我传递给 execFile 的标志被托管服务器的 unix 框转义的任何提示？

# 编辑

更准确地说，我更想知道发送到文件的参数是否可以解释为命令并执行。

另一个问题是 bash 脚本本身，这在技术上超出了这个问题的范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:46:15.970

`child_process.execFile`将使用节点进程的用户 ID 执行命令，因此它可以执行用户可以执行的任何操作，包括删除所有服务器文件。

正如您的问题所暗示的那样，让用户传递命令并不是一个好主意。

您可以考虑通过使用在沙箱中运行脚本`chroot`，并限制命令和驻留在可用文件系统上的内容，但这可能会很快完成。

您传递的命令将通过某种风格直接执行`exec`，因此除非您尝试执行的是脚本，否则不需要以任何方式对其进行转义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:11:28.567

`child_process.execFile`只要用户不指定命令名称，单独使用是完全安全的。

它不会在 shell 中运行命令（就像`child_process.exec`那样），所以不需要转义任何东西。

# c# - 什么是语句的不可到达终点（unreachable endpoint）？

> ID：15168072
> 
> 赞同：4
> 
> 时间：2013-03-01T22:41:24.320
> 
> 标签：c#

灵感来自这个问题的答案
[是 C# 中 switch 的空情况与下一个非空情况相结合吗？](https://stackoverflow.com/questions/15164318/is-empty-case-of-switch-in-c-sharp-combined-with-the-next-non-empty-one/15165445#15165445)

该术语的**唯一**出现出现在 C# 语言规范的 §6.5 中

> *   如果`D`有一个非空返回类型并且主体`F`是一个语句块，当每个参数`F`被赋予相应参数的类型时`D`，主体`F`是一个有效的语句块（wrt §8.2），具有***不可到达的结束***每个 return 语句指定一个表达式的***点***`D`，该表达式可隐式转换为 的返回类型。

在规范的后面我们可以看到

> *   ### 8.1 端点和可达性
>     
>     每个语句都有一个*终点*。直观地说，语句的结束点是紧接在语句之后的位置。复合语句（包含嵌入语句的语句）的执行规则指定当控制到达嵌入语句的终点时所采取的动作。例如，当控制到达块中语句的终点时，控制将转移到块中的下一条语句。
>     ...

我们可能对此有所了解。但是，我搜索了一下，发现没有直接解释***non-reachable endpoint***。因为 Stack Overflow 是一个问答网站，我认为如果有一个更简单、更直观的解释，可以很容易地搜索和理解这个术语，对程序员尤其是非英语母语的程序员会有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:34:32.703

本的回答很好地说明了这一点。更准确地说，端点：

*   休息
*   继续
*   去
*   返回
*   扔

语句不可访问。这些语句中的每一个都在“结束之前”将控制权转移到其他地方，因此语句的“结束点”永远不会被击中。将其与以下语句进行比较：

*   Console.WriteLine();
*   我++；

依此类推，将控制权转移到下一条语句。

循环提出了一个有趣的挑战：

```
while(x) { M(); } 
```

这基本上与以下内容相同：

```
BEGIN: 
if (!x) goto END;
{ M(); }
goto BEGIN;
END: ; 
```

所以端点是可达的。但

```
while(true) { M(); } 
```

可以优化为：

```
BEGIN: 
{ M(); }
goto BEGIN; 
```

由于现在没有办法“走到尽头”，所以这条语句被认为有一个无法到达的终点。这要么永远循环，要么 M() 永远不会返回，或者 M() 抛出；无论哪种方式，都不会到达语句的终点。

确定可达性的确切规则比这个草图要复杂一些，但这让你对它们有所了解。（我想给人们一个挑战，看看他们是否掌握了可达性：编写一个程序，它有一个可达的 goto 语句，但相应的标记语句是不可达的。棘手！）

这些规则用于许多地方。立即想到的三个：首先，开关部分不能有可到达的端点。其次，非 void 的方法（或 lambda 或属性 getter 等）不得具有可到达的端点。第三，如果一个方法有一个可到达的端点并且它有一个out参数，那么这个参数必须明确地分配在端点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:04:31.223

简而言之，当且仅当语句在没有执行分支的情况下完成（控制转移）时才到达端点。

因此，当退出块的分支是

1.  无条件的，或
2.  存在于所有可能的执行路径中。

# javascript - 数据未存储在本地存储中

> ID：15168077
> 
> 赞同：-1
> 
> 时间：2013-03-01T22:41:46.770
> 
> 标签：javascript, local-storage

为什么没有存储字段的`<select name="hr">`数据？如果我只使用本地存储脚本创建一个新页面`<select name="hr">`，它可以完美运行，但嵌入了此代码，它不会保存该字段。

```
<head>
<script>
document.getElementById("hr").onchange = function() {
    localStorage['hr'] = document.getElementById("hr").value;
}
window.onload= function(){
    if(localStorage['hr'])
        document.getElementById("hr").value = localStorage['hr'];
}
</script>
<script>
var musicsrc = 'alarmtone.mp3'
function sivamtime() {
    now=new Date();
    hour=now.getHours();
    min=now.getMinutes();
    sec=now.getSeconds();

if (min<=9) {
    min="0"+min;
 }
if (sec<=9) {
    sec="0"+sec;
 }
if (hour>12) {
    hour=hour-12;
    add="pm";
 }
else {
    hour=hour;
    add="am";
 }
if (hour==12) {
    add="pm";
 }
if (hour==00) {
    hour="12";
 }

  document.hours.clock.value = (hour<=9) ? "0"+hour : hour;
  document.minutes.clock.value = min;
  document.seconds.clock.value = sec;
  document.ampm.clock.value= add;
 setTimeout("sivamtime()", 1000);

}

playit=false
function playmusic(){
musicwin=window.open("","","width=100,height=100")
musicwin.document.write('<embed src=\"'+musicsrc+'\" hidden="true" border="0" width="20" height="20" autostart="true" loop="true">')
musicwin.document.close()
}

function soundcheck(cbox){
playit=cbox.checked
}

function alarm() {

    hrs = document.arlm.hr.value;
    min = document.arlm.mts.value;
    apm = document.arlm.am_pm.value;

 if ((document.hours.clock.value == hrs) &&
    (document.minutes.clock.value == min) &&
    (document.ampm.clock.value == apm)) {
     if (playit)
     playmusic()
     return false}

setTimeout("alarm()", 1000);}

</script>
</head>
<body onLoad="sivamtime()">
<table border="0" align="center" bgcolor="#c0c0c0" cellspacing="0" cellpadding="2" width="136">
    <tr>
        <td colspan="4">
            <font size="1" face="verdana, arial, helvetica, ms sans serif">
                <b>Current Time</b>
            </font>
        </td>
    </tr>
    <tr>
        <td>
            <form name="hours">
                <p><input type="text" size="2" name="clock"></p>
            </form>
        </td>
        <td>
            <form name="minutes">
                <p><input type="text" size="2" name="clock" /></p>
            </form>
        </td>
        <td>
            <form name="seconds">
                <p><input type="text" size="2" name="clock" /></p>
            </form>
        </td>
        <td>
            <form name="ampm">
                <p><input type="text" size="2" name="clock" /></p>
            </form>
        </td>
    </tr>
</table>

<table border="0" align="center" bgcolor="#c0c0c0" cellspacing="0" cellpadding="2" width="136">
    <tr>
        <td colspan="3">
            <form name="arlm">
                <font size="1" face="verdana, arial, helvetica, ms sans serif">
                    <b>Alarm Time</b>
                </font>
        </td>

    </tr>  
    <tr align="center">
        <td>
            <font size="1" face="verdana, arial, helvetica, ms sans serif">
                Hour 
            </font>
        </td>

        <td>
            <font size="1" face="verdana, arial, helvetica, ms sans serif">
                Minute
            </font>
        </td>

        <td>
            <font size="1" face="verdana, arial, helvetica, ms sans serif">
                am/pm
            </font>
        </td>
    </tr>

    <tr align="center">
        <td>
            <select id="hr" name="hr" onFocus="select()">
                <option value="01">01</option>
                ...
                <option value="12">12</option>
            </select>
        </td>

        <td>
            <select name="mts" onFocus="select()">
                <option value="00">00</option>
                ...
                <option value="59">59</option>
            </select>
        </td>

        <td>
            <select name="am_pm" onFocus="select()">
                <option value="am">AM</option>
                <option value="pm">PM</option>
            </select>
        </td>
    </tr>

    <tr align="left">
        <td colspan="3">
            <input type="checkbox" name="C1" value="ON" onClick="soundcheck(this)">
                <font size="1" face="verdana, arial, helvetica, ms sans serif">Use music alert?</font>
        </td>
    </tr>

    <tr>
        <td align="center" colspan="3">
            <input type="button" size="2" value="Set Alarm" onClick="alarm()" />
        </td>
    </tr>

    <tr>
        <td align="center" colspan="3">
            <input type="button" size="2" value="Reset" onClick="reset()" />
        </td>
    </tr>

</table>
</form>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:54:38.137

```
document.getElementById("hr").onchange = function() {
    localStorage['hr'] = document.getElementById("hr").value;
} 
```

这是试图在没有准备好的情况下从 DOM 中获取元素。在尝试访问元素的“onchange”属性之前，您需要等待 DOM 加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:02:54.920

除了添加 onchange 处理程序时 DOM 尚未准备好之外，localStorage 的使用似乎是错误的。

代替：

```
localStorage['hr'] = document.getElementById("hr").value; 
```

应该：

```
localStorage.setItem('hr', document.getElementById("hr").value); 
```

代替：

```
if(localStorage['hr']) 
```

应该：

```
if(localStorage.getItem('hr')) 
```

等等...

在这里您可以找到更多相关信息：[https ://developer.mozilla.org/en-US/docs/DOM/Storage#Storage](https://developer.mozilla.org/en-US/docs/DOM/Storage#Storage)

# c# - 如何使用 linq 查询 sysobjects？

> ID：15168084
> 
> 赞同：0
> 
> 时间：2013-03-01T22:42:25.743
> 
> 标签：c#, .net, linq, entity-framework, entity-framework-5

与以下 SQL 语句等效的 LINQ 是什么？我正在使用实体框架 5，首先是数据库。

```
SELECT Name 
FROM SysObjects 
WHERE xtype='U' AND Name LIKE 'D[_]%' 
ORDER BY Name ASC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:53:07.137

您可以使用 LINQ 执行此操作，但前提是您将 SysObjects 映射到您的类，否则任何其他方式都不可能。

例如：

```
public class SysObject
{
    public int SomeUniqueId { get; set; }
    public string Name { get; set; }
} 
```

映射文件将是这样的（我使用 Code First 方法，因为您没有说明如何使用 EF）

```
public class SysObjectMap : EntityTypeConfiguration<SysObject>
{
    HasKey(p => p.SomeUniqueId);

    Property(p => p.Name).IsRequired();

    ToTable("SysObjects"); // If there is Schema pass it as a 2nd argument
    Property(p => p.Name).HasColumnName("name");
} 
```

您需要在上下文类中注册此映射。当然，如果您使用的是 Database First 方法，上述方法可能会让您感到困惑，因为 Visual Studio 生成的代码会大不相同。

更新：在数据库优先方法的情况下，我相信您将能够看到系统表。当然，您可以随时打开生成的 EDMX 和实现类并自己添加映射。另一种方法是创建一个包裹 SysObjects 的视图。然后使用模型设计器添加视图。

# ruby - 如何使用 RSpec::Core::RakeTask 创建 RSpec Rake 任务？

> ID：15168086
> 
> 赞同：5
> 
> 时间：2013-03-01T22:42:31.030
> 
> 标签：ruby, rspec, rake

如何使用 RSpec::Core::RakeTask 初始化 RSpec Rake 任务？

```
需要'rspec/core/rake_task'

RSpec::Core::RakeTask.new 做 |t|
  # 我在这里放什么？
结尾

```

[在http://rubydoc.info/github/rspec/rspec-core/RSpec/Core/RakeTask#initialize-instance_method](http://rubydoc.info/github/rspec/rspec-core/RSpec/Core/RakeTask#initialize-instance_method)记录的初始化函数 没有很好的记录；它只是说：

```
- (RakeTask) 初始化(*args, &task_block)

RakeTask 的新实例

```

我应该为 *args 和 &task_block 放什么？

我正在追随已经开始使用 RSpec 和 Rake 为 PHP 项目构建一些 ruby​​ 自动化的人的脚步。我习惯在没有 Rake 的情况下使用 RSpec，所以对语法不熟悉。

谢谢，-凯文

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-10T14:51:54.170

这是我的 Rakefile 的示例：

```
require 'rspec/core/rake_task'

task :default => [:spec]

desc "Run the specs."
RSpec::Core::RakeTask.new do |t|
  t.pattern = "spec.rb"
end

desc "Run the specs whenever a relevant file changes."
task :watch do
  system "watchr watch.rb"
end 
```

这允许从 Rake 运行 spec.rb 文件中定义的规范

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-11-21T14:22:23.103

这就是我的 rakefile 的样子

```
gem 'rspec', '~>3'
require 'rspec/core/rake_task'

task :default => :spec

desc "run tests for this app"
RSpec::Core::RakeTask.new do |task|
  test_dir = Rake.application.original_dir
  task.pattern = "#{test_dir}/*_spec.rb"
  task.rspec_opts = [ "-I#{test_dir}", "-I#{test_dir}/source", '-f documentation', '-r ./rspec_config']
  task.verbose = false
end 
```

你可以从你的测试目录中'rake'，它将运行所有名为 [something]_spec.rb 的测试——它应该可以跨不同的测试目录（例如不同的项目）工作；如果您在单独的目录中有源代码（例如，在上面的代码中，一个名为“/source”的子目录会选择它们。显然，您可以将该源目录更改为您想要的。

这是我使用的 rspec_config 文件 - 您可以在此处添加自己的设置：

```
RSpec.configure do |c|
  c.fail_fast = true
  c.color = true
end 
```

# css - CSS问题 - 将跨度与另一个对齐

> ID：15168089
> 
> 赞同：0
> 
> 时间：2013-03-01T22:42:43.247
> 
> 标签：css, alignment, html

我正在使用应该给左侧边框的指针图像发出错误消息。[你可以在这里](http://jsfiddle.net/dshFk/2/)看到一个例子。

我目前的CSS是：

```
span.arrow {
    background-color:white;
    background: url('http://i45.tinypic.com/201d0n.png') no-repeat left center;
    height:17px;
    display:inline-block;
}
span.error {
    display:inline-block;
    padding-right:2px;
    background-color:white;
    margin-left:10px;
    height:15px;
    font-size:small;
    border-top:1px solid #99182c;
    border-right:1px solid #99182c;
    border-bottom:1px solid #99182c;
    box-shadow:5px 5px 10px #888888;
    position:relative;
    top:-2px;
} 
```

和 html 来显示错误：

```
<span class='arrow'>
    <span class='error'>
        Errormessage.
    </span>
</span> 
```

现在首先，代码看起来有点乱。就像必须将跨度定位到两个像素有点奇怪。尽管如此，它似乎在 Chrome、FF 和 Opera 中有效，但在 IE9 中无效。

如果不清楚：框应该与三角形图像完全对齐。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:46:08.377

```
span.error {
    display:inline-block;
    padding-right:2px;
    background-color:white;
    margin-left:10px;
    line-height: 17px;
    font-size:small;
    border-top:1px solid #99182c;
    border-right:1px solid #99182c;
    border-bottom:1px solid #99182c;
    box-shadow:5px 5px 10px #888888;
    position:relative;
    top:-2px;
} 
```

通常，如果您使 line-height 与您的内容区域高度匹配，则文本将垂直对齐。

[http://jsfiddle.net/dshFk/3/](http://jsfiddle.net/dshFk/3/)

我在 IE 中查看，它看起来不错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:13:41.353

```
span.arrow {
    background: url('http://i45.tinypic.com/201d0n.png') no-repeat left center transparent;
    line-height:17px;
    padding-left:10px;
    display:inline-block;
}
span.error {
    padding-right:2px;
    background-color:white;
    line-height:15px;
    font-size:small;
    border-top:1px solid #99182c;
    border-right:1px solid #99182c;
    border-bottom:1px solid #99182c;
    display:block;
} 
```

# r - 展平/非规范化 R 聚合函数的结果

> ID：15168090
> 
> 赞同：5
> 
> 时间：2013-03-01T22:42:53.617
> 
> 标签：r, aggregate, plyr, reshape

我对 R 相当陌生，我正在尝试对`aggregate`数据帧、每个主题和我的数据集中的每个指标执行一些时间序列整形。这很好用，但我发现结果不是很容易使用的格式。我希望能够将结果转换回与原始数据框相同的格式。

以 iris 数据集为例：

```
# Split into two data frames, one for metrics, the other for grouping
iris_species = subset(iris, select=Species)
iris_metrics = subset(iris, select=-Species)
# Compute diff for each metric with respect to its species
iris_diff = aggregate(iris_metrics, iris_species, diff) 
```

我只是`diff`用来说明我有一个塑造时间序列的函数，所以我得到一个可能不同长度的时间序列，绝对不是一个聚合值（例如平均值）。

我想转换结果，这似乎是一个矩阵，其中列出了值单元格到原始的“平面”数据框。

我主要对如何使用来自 的结果来管理这个问题感到好奇`aggregate`，但我会接受在`plyr`or中执行所有操作的解决方案`reshape`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T00:15:26.460

在这种情况下，我能想到的最佳解决方案是`data.table`：

```
require(data.table)
dt <- data.table(iris, key="Species")
dt.out <- dt[, lapply(.SD, diff), by=Species] 
```

如果你想要一个`plyr`解决方案，那么这个想法基本上是一样的。拆分`Species`并应用于`diff`每一列。

```
require(plyr)
ddply(iris, .(Species), function(x) do.call(cbind, lapply(x[,1:4], diff))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T09:51:38.973

这是我理解为您的问题：使用您当前的使用方法`aggregate`，您会得到`matrix`“Sepal.Length”、“Sepal.Width”等的结果。

```
> str(iris_diff)
'data.frame':   3 obs. of  5 variables:
 $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 2 3
 $ Sepal.Length: num [1:3, 1:49] -0.2 -0.6 -0.5 -0.2 0.5 ...
 $ Sepal.Width : num [1:3, 1:49] -0.5 0 -0.6 0.2 -0.1 0.3 -0.1 -0.8 -0.1 0.5 ...
 $ Petal.Length: num [1:3, 1:49] 0 -0.2 -0.9 -0.1 0.4 ...
 $ Petal.Width : num [1:3, 1:49] 0 0.1 -0.6 0 0 0.2 0 -0.2 -0.3 0 ... 
```

但是，在您的控制台中，它显示为197列的*样子。*`data.frame`

您想将“iris_diff”转换为`data.frame`具有 197 列的 a。以下是如何使用现有输出来做到这一点（我从@James 那里学到的一个技巧，[这里](https://stackoverflow.com/a/14759569/1270695)是 SO）：

```
do.call(data.frame, iris_diff) 
```

以下是我们查看该操作时输出的前几行`str`：

```
> str(do.call(data.frame, iris_diff))
'data.frame':   3 obs. of  197 variables:
 $ Species        : Factor w/ 3 levels "setosa","versicolor",..: 1 2 3
 $ Sepal.Length.1 : num  -0.2 -0.6 -0.5
 $ Sepal.Length.2 : num  -0.2 0.5 1.3
 $ Sepal.Length.3 : num  -0.1 -1.4 -0.8
 $ Sepal.Length.4 : num  0.4 1 0.2
 $ Sepal.Length.5 : num  0.4 -0.8 1.1
 $ Sepal.Length.6 : num  -0.8 0.6 -2.7
 $ Sepal.Length.7 : num  0.4 -1.4 2.4
 $ Sepal.Length.8 : num  -0.6 1.7 -0.6
 $ Sepal.Length.9 : num  0.5 -1.4 0.5
 $ Sepal.Length.10: num  0.5 -0.2 -0.7 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T23:34:07.827

您可能知道，`aggregate`一次只处理一列。期望单个值，如果返回长度不同于 1 的向量，则会发生奇怪的事情。

您可以将其拆分`by`以获取数据（行数少于 in `iris`）并将其重新组合在一起：

```
b <- by(iris_metrics, iris_species, FUN=function(x) diff(as.matrix(x)))
do.call(rbind, lapply(names(b), function(x) data.frame(Species=x, b[[x]]))) 
```

`diff(as.matrix)`使用它，因为这可以满足您对矩阵的要求（但不适用于数据帧）。关键是该函数返回的行数与每个`Species`in 中的行数不同`iris`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-02T02:12:59.447

如果你想返回某种与输入向量长度相同的一阶差分向量，你应该使用 ave 和一个匿名函数。由于`diff`返回不同长度的向量，因此您需要使用 NA （或您选择的标记）对其进行扩展。

```
iris_diff = lapply(iris_metrics, 
        function(xx) ave(xx, iris_species, FUN=function(x) c(NA, diff(x) ) )  )
str(iris_diff)
#--------------
List of 4
 $ Sepal.Length: num [1:150] NA -0.2 -0.2 -0.1 0.4 ...
 $ Sepal.Width : num [1:150] NA -0.5 0.2 -0.1 0.5 0.3 -0.5 0 -0.5 0.2 ...
 $ Petal.Length: num [1:150] NA 0 -0.1 0.2 -0.1 ...
 $ Petal.Width : num [1:150] NA 0 0 0 0 0.2 -0.1 -0.1 0 -0.1 ... 
```

如果您希望将其作为数据框，只需环绕`data.frame`它即可。包含原始分组向量是个好主意：

```
iris_diff <- data.frame( Species= iris_species, iris_diff)
str(iris_diff)
#------
'data.frame':   150 obs. of  5 variables:
 $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ Sepal.Length: num  NA -0.2 -0.2 -0.1 0.4 ...
 $ Sepal.Width : num  NA -0.5 0.2 -0.1 0.5 0.3 -0.5 0 -0.5 0.2 ...
 $ Petal.Length: num  NA 0 -0.1 0.2 -0.1 ...
 $ Petal.Width : num  NA 0 0 0 0 0.2 -0.1 -0.1 0 -0.1 ... 
```

# php - mod_rewrite 子目录正在触发错误

> ID：15168093
> 
> 赞同：0
> 
> 时间：2013-03-01T22:43:17.923
> 
> 标签：php, .htaccess, mod-rewrite

我正在使用 MAMP（我知道）在本地操场上尝试 mod_rewrite，根据 stackoverflow 上的答案，我使用的规则似乎很好，但我一直收到 404 页面，甚至尝试查看 apache 服务器日志，并且即使重写规则包含它，它似乎也缺少文件扩展名。

这是我的规则：

```
Options +FollowSymLinks  
Options +Indexes  
RewriteEngine On 
RewriteRule ^test/([0-9]+)/$ public/test.php?id=$1 [NC,L] 
```

Apache 日志条目：

```
[Sat Mar 02 00:24:02 2013] [error] [client 127.0.0.1] File does not exist: /Applications/MAMP/htdocs/site/public/test 
```

我已经通过将相同的 htaccess 文件放在子目录中验证它的工作原理，而不是根目录，奇怪的是，它可以工作。

该问题似乎与缺少 .php 的事实有关（基于 apache 日志）。

# java - 为什么我的回文不起作用？

> ID：15168094
> 
> 赞同：0
> 
> 时间：2013-03-01T22:43:20.610
> 
> 标签：java

我是一名有抱负的 Java 用户，正在上大学课程，但我遇到了问题。我的教授。告诉我们编写一个检测基于 5 位数字的回文的 java 程序。我写了一些东西，但它不会按我计划的方式工作。请问我能得到一些帮助吗？使用 netbeans IDE。

```
package palindrome;

import javax.swing.JOptionPane;

public class Palindrome {

    public static void main(String[] args) {

        String stringNumber;
        int number;
        String stringPal;
        int palindrome;

        stringNumber = JOptionPane
                .showInputDialog("Please, if you will, enter a five digit palindrome: ");
        number = Integer.parseInt(stringNumber);

        if (number < 10000 && number > 99999) {
            System.out
                    .println("Your number is invalid, please enter a FIVE digit number: ");
        } else if (number % 10 == number % 100) {
            System.out.println("your number: " + number + "is a palindrome");
        } else {
            System.out.println("You FAIL loser");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-01T22:46:16.887

您的回文逻辑不正确。您检查除以 10 时的余数是否等于除以 100 时的余数 - 当且仅当十位数中有 0 时才会出现这种情况。这不是[回文](http://en.wikipedia.org/wiki/Palindrome)的定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:50:25.820

我不明白，数字 % 10 == 数字 % 100 如何暗示回文，但它所做的只是将最后 2 位数字的值与最后 1 位数字的值进行比较。

我的建议是将输入作为一个`string`或`char`数组并将字符串的最后一个元素与第一个元素进行比较，然后继续直到你到达中间

这是一些伪代码：

```
isPalindrome = true;

for i=0 to stringLength

    if(input[i] != input[length - i - 1])
        isPalindrome = false; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:19:23.637

正如已经指出的那样，您的回文逻辑是错误的。

您需要检查的是反转时字符串/数字是否相同。

因此，假设您要检查 a 字符串是否为回文，将其反转并检查它是否与原始字符串相同。

您应该尝试完成此模板：

```
boolean isPalindrome(String s){

   String reverseString = reverseString(s);

   if(reverseString.equals(s)){
        return true;
   }

   return false;
}

String reverse(String s){
  //add code to reverse String. (and optionally check if it is Integer, if it is a requirement)
} 
```

您现在可以谷歌如何反转字符串。

PS：你可能想看看`StringBuilder`类。

# c - recvfrom() 中的 addrlen 字段是做什么用的？

> ID：15168095
> 
> 赞同：3
> 
> 时间：2013-03-01T22:43:23.400
> 
> 标签：c, sockets, udp, recv

我在我的程序中使用 recvfrom 从我在 src_addr 中指定的服务器获取 DGRAM 数据。但是，我不确定为什么需要初始化并传入 addrlen。

我阅读了手册页，但我并没有真正理解它的含义。

> 如果 src_addr 不为 NULL，且底层协议提供源地址，则填写此源地址。当 src_addr 为 NULL 时，不填写；在这种情况下，不使用 addrlen，也应该为 NULL。参数 addrlen 是一个 value-result 参数，调用者应该在调用之前将其初始化为与 src_addr 关联的缓冲区的大小，并在返回时修改以指示源地址的实际大小。如果提供的缓冲区太小，返回的地址会被截断；在这种情况下，addrlen 将返回一个大于提供给调用的值。

我猜这与 src_addr 是 ipv4 或 ipv6 有关。它是否正确？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-01T23:02:19.003

也许您的身边有误解。谈论：

```
ssize_t recvfrom(int sockfd, void *buf, size_t len, int flags, 
                 struct sockaddr *src_addr, socklen_t *addrlen); 
```

`src_addr`不是用来交你想听的地址，而是你提供的一个存储位置，用来获取实际交出*的***源***地址*。

 **因此，如果您`src_addr`因为对地址根本不感兴趣而设置为 NULL，那么您不必关心它，`addrlen`因为它无论如何都不会被使用。

另一方面，如果你想知道源地址，你不仅要提供一个存储位置，还要告诉你提供的存储位置有多大。这就是为什么您应该初始化`*addr_len`为您分配的缓冲区大小的原因。

调用后，指向的值`addrlen`将通知您分配用于存储源地址的空间中有多少（如果有）实际填充了数据。

## 关于尺寸

struct sockaddr 和来回传递大小的整个麻烦与这样一个事实有关，即使它们在网络套接字中使用最频繁，也应该是一个更普遍的概念。

以 unix 域套接字为例，因为它们是通过文件系统实现的，它们需要一个与基于 IP 的网络已知的完全不同的寻址方案。这里使用的 sockaddr 类型是：

```
struct sockaddr_un {
  sa_family_t sun_family;               /* AF_UNIX */
  sun_path[UNIX_PATH_MAX];  /* pathname */
}; 
```

将此与基于 IP 的网络中使用的结构进行比较：

```
struct sockaddr_in {
  sa_family_t    sin_family; /* address family: AF_INET */
  in_port_t      sin_port;   /* port in network byte order */
  struct in_addr sin_addr;   /* internet address */
}; 
```

应该清楚两者没有太多共同点。

插座的设计能够适应这两种情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T22:50:19.543

```
ssize_t recvfrom(int socket, void *buffer, size_t length, int flags,
         struct sockaddr *address, socklen_t *address_len);` 
```

参数指定结构的`address_len`长度，`address`即从指示的起始地址开始使用的字节数`address`（内存位置的起始地址 + 保存该值的起始地址的字节数）

结构定义在`/usr/include/bits/socket.h`

```
/* Structure describing a generic socket address.  */
struct sockaddr
{
    __SOCKADDR_COMMON (sa_);    /* Common data: address family and length.      */  
    char sa_data[14];       /* Address data.  */
}; 
```

因此，该`sa_data`字段保存其长度由`address_len`参数指示的地址数据（数据的起始地址）。

> ...每当一个函数说它需要一个 struct sockaddr* 时，您可以轻松安全地将 struct sockaddr_in*、struct sockaddr_in6* 或 struct sockadd_storage* 转换为该类型。

因此，如手册页和问题评论中的@WhozCraig 所示，当方法返回时，此字段将更新为实际大小。

**更多信息**

*   [接收来自](http://pubs.opengroup.org/onlinepubs/7908799/xns/recvfrom.html)
*   [Beej 的网络编程指南 - struct sockaddr 和 pals](http://www.retran.com/beej/sockaddr_inman.html)**

# symfony - 如何在 Symfony2 中覆盖 Bundle 时声明服务？

> ID：15168098
> 
> 赞同：1
> 
> 时间：2013-03-01T22:43:44.570
> 
> 标签：symfony, dependency-injection

我正在扩展 Symfony2 Bundle (FosUserBundle)。在我的扩展包中，我想声明一些新服务，但是尽管我的正确`DependencyInjection/SomethingExtension.php`并且`services.yml`服务不可访问。

未调用扩展，因此`services.yml`未加载。

有谁知道如何实现这样的服务声明？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T14:52:22.193

您可以通过在您的 Bundle 代码中覆盖 getContainerExtension 来确保调用扩展类（不管任何命名问题）。

```
namespace Cerad\Bundle\AccountBundle;

use Symfony\Component\HttpKernel\Bundle\Bundle;

use Cerad\Bundle\AccountBundle\DependencyInjection\AccountExtension;

class CeradAccountBundle extends Bundle
{
    public function getContainerExtension()
    {
        return new AccountExtension();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T02:16:25.223

首先，您已经在 AppKernal.php 中启用了您的包。希望你做到了:)

下一个，

> 您需要创建一个新的“扩展”类来处理该过程。这个类应该存在于你的包的 DependencyInjection 目录中，并且它的名字应该通过用 Extension 替换 Bundle 类名的 Bundle 后缀来构造。例如，AcmeHelloBundle 的 Extension 类将被称为 AcmeHelloExtension

SRC：[Doc](http://symfony.com/doc/current/cookbook/bundles/extension.html#creating-an-extension-class) 所以，它应该看起来像

```
public function load(array $configs, ContainerBuilder $container)
{
    $configuration = new Configuration();
    $config = $this->processConfiguration($configuration, $configs);

    $loader = new Loader\YamlFileLoader($container, new FileLocator(__DIR__.'/../Resources/config'));
    $loader->load('services.yml');
} 
```

最后，用这个命令行工具调试服务是否加载。

> 命令行`php app/console container:debug`显示服务列表。

# c++ - Windows Phone 8 手动应用程序退出 c++

> ID：15168106
> 
> 赞同：0
> 
> 时间：2013-03-01T22:44:24.000
> 
> 标签：c++, windows-phone-8, c++-cx

我正在为 Windows Phone 8 编写一个没有 XAML 的 C++ DirectX 应用程序。我遇到了困难。在认证要求中提到：

> “验证应用程序是否正确关闭，或者允许用户通过菜单或对话框确认关闭应用程序。”

当用户在主屏幕上按下返回按钮时，我会显示是-否对话框。当用户按下是时，我应该如何让应用退出？

在本主题中有一些解决方案，但它们似乎仅适用于 XAML。 [http://social.msdn.microsoft.com/Forums/en-US/wpdevelop/thread/fddf8f6-e691-4df6-92c7-ed3dc97bddc0/](http://social.msdn.microsoft.com/Forums/en-US/wpdevelop/thread/fdedf8f6-e691-4df6-92c7-ed3dc97bddc0/)

我应该如何关闭应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:59:31.950

查看那个 MSDN 论坛链接，似乎 C++/DirectX 中的后退按键逻辑与 C#/XAML 的工作方式相同。

即，如果您`command->Handled = true;`在返回键按下处理程序中设置处理标志，应用程序框架将不会关闭应用程序。

如果您不设置标志，则应用程序框架将关闭应用程序。

# javascript - JavaScript / jQuery - 侦听选定的下拉选项

> ID：15168109
> 
> 赞同：1
> 
> 时间：2013-03-01T22:44:36.503
> 
> 标签：javascript, jquery

我目前在 JS 文件中有以下代码，这是读取生成的具有团队名称的链接列表。单击链接时，相关文本框将填充每个团队的正确信息。

我现在已放入下拉列表，如下所示，并且想做完全相同的事情，但使用文本框，所以当您从下拉列表中选择一个选项时，它会获取该团队的数据。

使用链接时，我正在使用 a.teamLink 并在单击其中一个时进行监听，任何人都可以想到我将如何为下拉列表项执行此操作吗？这是下拉列表的生成代码以及下面的相关代码。

欢迎任何帮助！

生成的下拉列表 HTML 示例：

```
<div id="teamDropDownDiv">
    <select id="teamList" style="width: 160px;">
        option id="1362174068837" class="teamDropDown">Liverpool</option>
    </select>
</div> 
```

生成的链接 HTML 示例：

```
<a id="1362174068837" href="#" class="teamLink">Liverpool</a> 
```

JavaScript 监听每个链接：

```
Team.initTeamsLink = function(){
  $("a.teamLink").live("click", function(e){
    e.preventDefault();
    var teamId = ($(this)[0]).getAttribute('id');

    $.get('/show/team/'+teamId, function(response){
      if(response.retStatus === 'success'){
        var teamData = response.teamData;
        $('#teamId').val(teamData.key);
        $('#teamName').val(teamData.name);
      } else if(response.retStatus === 'failure'){

      }
    });  
  });
 }; 
```

HTML 的下拉列表 JADE 模板

```
div#teamDropDownDiv
    -if(teamsList.length > 0){
        select#teamList(style='width: 160px;')
            option
                -each team in teamsList
                    option.teamDropDown(id="#{team.key}") #{team.name}
    -}else{
        No teams till now..
    -} 
```

HTML 的链接列表 JADE 模板

```
div#teamListDiv
  -if(teamsList.length > 0){
    -each team in teamsList
      a.teamLink(id="#{team.key}", href="#") #{team.name}
      br
  -}else{
    h3 No teams till now..
  -}

 Team.initTeamsDD = function(){
  $("teamList").live("change", function(e){
    e.preventDefault();
    var teamId = $(this).val();

    $.get('/show/team/'+teamId, function(response){
      if(response.retStatus === 'success'){
        var teamData = response.teamData;
        $('#teamId').val(teamData.key);
        $('#teamName').val(teamData.name);
      } else if(response.retStatus === 'failure'){

      }
    });  
  });
 }; 
```

显示团队功能

```
 /**
    * Get Meta data of a Team
    * Send back all the details of a Team
    */
  app.get('/show/team/:key', function(req, res){
    util.log('Serving request for url [GET] ' + req.route.path);
    Team.findByKey(req.params.key, function(err, teamData){
      if(!err && teamData){
        teamData = teamData;
        res.json({
          'retStatus' : 'success',
          'teamData' : teamData
        });
      } else {
        util.log('Error in fetching Team by key : ' + req.params.key);
        res.json({
          'retStatus' : 'failure',
          'msg' : 'Error in fetching Team by key ' + req.params.key
        });
      }
    });
  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:55:25.670

也许这有效：

选项元素需要将团队 ID 作为值：

```
<div id="teamDropDownDiv">
    <select id="teamList" style="width: 160px;">
        <option id="1362174068837" class="teamDropDown" value="1362174068837">Liverpool</option>
    </select>
</div> 
```

所以模板应该是这样的：

```
div#teamDropDownDiv
    -if(teamsList.length > 0){
        select#teamList(style='width: 160px;')
            option
                -each team in teamsList
                    option.teamDropDown(id="#{team.key}",value="#{team.key}") #{team.name}
    -}else{
        No teams till now..
    -} 
```

并添加一个监听器来改变 select 的事件，并从 value 属性中获取选中的团队 ID：

```
$("#teamList").change(function(e){
    e.preventDefault();
    var teamId = $(this).val()
... 
```

# nant - NAnt property::exists() 具有新定义的属性？

> ID：15168112
> 
> 赞同：4
> 
> 时间：2013-03-01T22:44:50.640
> 
> 标签：nant

在 NAnt 0.92 中，我定义了一个属性，并在检查它是否存在后立即进行。它不存在......但它存在于一个被调用的目标中。这是错误还是功能？！？我在文档中搜索，但找不到提及它。

```
<target name="test">
  <property name="testprop" value="test value" />

  <echo message="property value = ${testprop}" />

  <if test="${property::exists(testprop)}">
     <echo message="property exists, as it should!" />
  </if>

  <if test="${not property::exists(testprop)}">
     <echo message="property doesn't exists... WTF?" />
  </if>

  <call target="test2" />
</target>

<target name="test2">
  <echo message="property value in sub-target = ${testprop}" />
</target> 
```

输出：

测试：

```
 [echo] property value = test value
 [echo] property doesn't exists... WTF? 
```

测试2：

```
 [echo] property value in sub-target = test value 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T09:44:34.680

在您对`property::exists`. 就是这样：

```
<if test="${not property::exists('testprop')}">
  <echo message="property doesn't exists... WTF?" />
  <!-- don't swear -->
</if> 
```

**更新：**您的示例中发生了什么？在您对 function 的调用中，未引用的属性`testprop`将替换为它的值`property::exists`。所以你实际上是在探测属性`test value`（顺便说一句，它不是有效的属性名称）。看一下这个：

```
<target name="test">
  <property name="test.value" value="foo" />
  <property name="testprop" value="test.value" />
  <echo message="property value = ${testprop}" />
  <if test="${property::exists(testprop)}">
    <echo message="property exists, as it should!" />
  </if>
  <if test="${not property::exists(testprop)}">
    <echo message="property doesn't exists... WTF?" />
  </if>
</target> 
```

输出：

```
 [echo] property value = test.value
 [echo] property exists, as it should! 
```

# css - CSS Element positioning

> ID：15168114
> 
> 赞同：0
> 
> 时间：2013-03-01T22:45:07.080
> 
> 标签：css, positioning, html

I freely admit right up front that I am not blessed with even a speck of design ability. Nonetheless, I find myself hacking through CSS for a simple website. I've run into a problem and for the life of me I can't figure out the issue. The basics...

I have a `<div>` that contains the entire page and sets the boundaries. The width is set at 1200px. After a other elements I have a links bar that spans the width of the page. This is in a `<div>` with the id "pinkbar". The "pinkbar" has a width set to 100%, which would be 100% of the 1200px containing division. I created small padding on the left and larger padding on the right to properly position elements within the bar. I need to add one element to the left, a simple text telephone number, and then several links to the right. I put the telephone # in it's own `<div>` with the id of "pinkphone", and floated that `<div>` to the left. Worked perfectly. Now I start to add the links. I created a `<div>` named "pinktest" for the first link, added a border and the text link inside of the division and floated it to the right. And that is where thinks stopped playing nicely. The link division, "pinktest", floats to right about 50px beyond the border of it's containing division, and about 100px to the right beyond that border if you factor in the padding. I've played and tinkered with this to the best of my limited ability and have found no love at all. If someone can offer a suggestion as to how to make this work please do. I still need to add four more links, all floated right, along with the "pinktest" one. Relevant code below:

The CSS:

```
#pinkbar{
    background-image: url(../visual/pinkMenuBar.jpg);
    background-repeat: no-repeat;
    padding-top: 0px;
    padding-left: 30px;
    padding-right: 100px;
    margin-top: 0px;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    height: 25px;
}

#pinkphone{
    padding-top: 3px;
    padding-left: 0px;
    padding-right: 0px;
    padding-bottom: 0px;
    margin-top: 0px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 0px;
    float: left;
    width: auto;
    height:25px;
}

#pinktest{
    padding-top: 3px;
    padding-left: 4px;
    padding-right: 0px;
    padding-bottom: 0px;
    margin-top: 0px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 0px;
    border-left-width: 1px;
    border-left-style: solid;
    border-left-color: grey;
    float: right;
    width: auto;
    height:25px;
} 
```

The HTML:

```
<div id="pinkbar">
    <div id="pinkphone">
        <span class="cambria3black">Tel: 416 450 4460</span>
    </div>
    <div id="pinktest">
        <span class="cambria3black">
            <a href="testimonials.html">Testimonials</a>
        </span>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:54:00.833

这是我认为您可能正在寻找的简化示例：

HTML：

```
<nav>
    <ul class="links">
        <li>Link 1</li>
        <li>Link 2</li>
    </ul>
    <ul class="info">
        <li>Telephone Number</li>
        <li>Link 3</li>
    </ul>
</nav> 
```

CSS：

```
nav {
    padding: 1em;
}

.links {
    float: left;
}

.info {
    float: right;
}

nav li {
    display: inline;
    padding: 1em;
} 
```

您可以根据需要添加任意数量的链接。

[演示](http://jsfiddle.net/pstvF/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:13:45.690

浮动元素将尽可能向左或向右移动。通常这意味着一直到包含元素的左侧或右侧。

[CSS W3schools](http://www.w3schools.com/css/css_float.asp)

所以实际上，pinktest div 是在pinkbar 分区内。您应该将 pinktest 的 css 更改为：

```
float: left; 
```

因为 pinkbar div 正在使用 100% 的页面，所以 pinktest 会尽可能地正确。现在它将尽可能向左移动，即。粉红电话旁边。

# django - custom filter - needs two arguments

> ID：15168117
> 
> 赞同：2
> 
> 时间：2013-03-01T22:45:26.097
> 
> 标签：django, django-models, django-templates

In the project manage app I'm working on it should be possible to edit/delete a ticket if you are the owner of (i.e. the creator of) the ticket and/or the admin of the project the ticket belongs to.

In the template for showing a project I want to use a custom filter to determine this, used as seen here:

```
{% if ticket|owner_or_admin:user %}
    <p>
        <a href="{% url ticket_edit project.id %}">Edit</a>
        <a id="delete_link" href="{% url ticket_delete ticket.id %}">Delete</a>
    </p>
{% endif %} 
```

Below is a try of creating this custom filter, but this throws an error ('owner_or_admin requires 2 arguments, 1 provided'):

```
@register.filter(name='owner_or_admin')
def ownership(ticket, project, user):
    if ticket.user == user:
        return true;    
    else:
        if project.added_by_user == user:
            return true
    return false 
```

**models:**

```
class Project(models.Model):
    ... fields ...
    added_by_user = models.ForeignKey(User)

class Ticket(models.Model):
    ... fields ...
    user = models.ForeignKey(User) 
```

So, how do I provide two arguments? Is the custom filter correct otherwise?

Thanks in advance!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T23:06:05.753

[根据文档](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#writing-custom-template-filters)，您不能将多个参数传递给模板过滤器，但您可以使用两个过滤器。

模板：

```
{% if ticket|owner:user or project|admin:user %}
    <!-- blah -->
{% endif %} 
```

过滤器：

```
@register.filter(name='owner')
def ownership(ticket, user):
    return ticket.user == user

@register.filter(name='admin')
def adminship(project, user):
    return project.added_by_user == user 
```

（编辑：另外，过滤器代码中的布尔值应该大写）

# iphone - plist won't delete programmatically

> ID：15168119
> 
> 赞同：0
> 
> 时间：2013-03-01T22:45:34.803
> 
> 标签：iphone, ios, objective-c, xcode

I am attempting to create a 'start over' function in an iPhone application, but I cannot get a plist file to delete with the following code

```
- (IBAction)startOver:(id)sender {
    NSFileManager *fileManager = [NSFileManager defaultManager];
    [fileManager removeItemAtPath:@"data.plist" error:NULL];

    UIViewController *controller = [self.storyboard instantiateViewControllerWithIdentifier:@"welcome"];
    [self presentViewController:controller animated:YES completion:nil];
} 
```

Can anybody see why?

Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:55:14.210

假设您保存`data.plist`在`Documents`目录中，然后执行以下操作：

```
- (NSString *)getFilePath {
    NSArray *files = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    return [[files objectAtIndex:0] stringByAppendingPathComponent:@"data.plist"];
}

- (IBAction)startOver:(id)sender {
    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSString *path = [self getFilePath];
    [fileManager removeItemAtPath:path error:NULL];

    UIViewController *controller = [self.storyboard instantiateViewControllerWithIdentifier:@"welcome"];
    [self presentViewController:controller animated:YES completion:nil];
} 
```

# javascript - How are strings physically stored in Javascript

> ID：15168125
> 
> 赞同：7
> 
> 时间：2013-03-01T22:46:11.320
> 
> 标签：javascript

What I am looking for is how strings are physically treated in Javascript. Best example I can think of for what I mean is that in the Java api it describes the storage of strings as:

`String str = "abc";" is equivalent to: "char data[] = {'a', 'b', 'c'};`

To me this says it uses an array object and stores each character as its own object to be used/accessed later (I am usually wrong on these things!)...

How does Javascript do this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T22:56:56.700

字符串是JavaScript 中的[`String`对象](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String)。该`String`对象可以使用`[]`符号从字符串中获取字符（`"abc"[0]`返回`'a'`）。您也可以使用该`String.prototype.charAt`功能来实现相同的结果。

> **侧节点：** `var a = 'abc'`和`var b = new String('abc')`不一样。第一种情况称为原始字符串，`String`并由 JavaScript 解析器转换为对象。这导致其他数据类型，调用`typeof(a)`给你`string`但`typeof(b)`给你`object`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-11T11:32:51.147

字符串在 javascript 中以与其他语言存储相同的格式存储。假设 var word = "test" 比 at word 将是一个字符数组，而 't' 将出现在第 0 个位置，依此类推。

采用“word.length”的最后一次迭代将返回未定义。在其他语言中，它返回为 '\0'。

# ruby-on-rails - Bash 配置文件搞砸了？

> ID：15168131
> 
> 赞同：0
> 
> 时间：2013-03-01T22:46:44.097
> 
> 标签：ruby-on-rails, bash, terminal, .bash-profile

当尝试使用 railsinstaller.org 安装 Ruby on Rails 时，他们在我卸载它后有点搞砸了我的系统，现在我的终端每次启动新终端时都会打印：

```
Last login: Fri Mar  1 15:01:45 on console
-bash: /etc/profile.d/sm.sh: No such file or directory
-bash: /etc/profile.d/rvm.sh: No such file or directory 
```

我检查了我的`.bash_profile`，它没有引用任何类似的东西。关于发生了什么以及如何解决它的任何想法？

顺便说一句，我正在运行 Mac OS X...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:00:39.067

通常，shell 在启动过程中会获取很多文件，这些是我想到的常见位置：

```
~/.bashrc
~/.profile
/etc/profile
/etc/profile.d/* 
```

# mysql - Writing a complex case statement in Sequel?

> ID：15168132
> 
> 赞同：6
> 
> 时间：2013-03-01T22:46:45.550
> 
> 标签：mysql, sql, ruby, sequel

I have a fairly complex `case` statement that works in MySQL:

```
SELECT # rest of code omitted
CASE WHEN code = 'a' THEN 'x'
  WHEN code IN ('m', 'n') THEN 'y'
  WHEN class IN ('p', 'q') AND amount < 0 THEN 'z'
  ELSE NULL END AS status
FROM # rest of code omitted 
```

However, all attempts to write this in Sequel have failed. I am using this as a template:

```
Sequel.case([[:c, 1], [:d, 2]], 0) # (CASE WHEN "c" THEN 1 WHEN "d" THEN 2 ELSE 0 END) 
```

(from [Jeremy Evans' Github](https://github.com/jeremyevans/sequel/blob/master/doc/sql.rdoc))

My best guess would be:

```
dataset.select( # rest of code omitted...
[[(:code => 'a'), 'x'],
[(:code => 'b'), 'y'],
[(:class => ['p', 'q'], :amount < 0), 'z']].case(nil).as(:status)) 
```

Any ideas?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T02:04:30.003

After having a play with this, I have concluded that although the sequel gem aims to be be "simple, flexible and powerful", its syntax gets quite convoluted when things get a bit tricky.

Here is my best attempt at your query:

```
DB[:testtable].select( 
  Sequel.case([
  [{code: 'a'}, 'x'],
  [{code: ['m', 'n']}, 'y'], 
  [{class: ['p', 'q'], (Sequel.expr(:amount) > 0) => true}, 'z']], 
  nil).
  as(:status)
) 
```

This produces the following (almost correct) SQL:

```
SELECT (
CASE WHEN (`code` = 'a') THEN 'x' 
WHEN (`code` IN ('m', 'n')) THEN 'y' 
WHEN ((`class` IN ('p', 'q')) AND ((`amount` > 0) IS TRUE)) THEN 'z' 
ELSE NULL END) AS `status` FROM `testtable` 
```

I could not figure out how to use the inequality operator within a case statement. Maybe you'll have more luck with that.

My suggestion is that you just write the query in SQL, it will be significantly easier to read, and more maintainable.

# php - preg_match 格式化结果

> ID：15168133
> 
> 赞同：0
> 
> 时间：2013-03-01T22:46:48.143
> 
> 标签：php

我正在尝试更改一个小脚本，但我不确定其中的一部分

基本上，我有一些用于 preg_match 模式的数据，如下所示：

```
 'pattern' => '(13)(\\d{2})(\\d{2})',
  'format' => '($1) $2 $3' 
```

该模式对我来说很有意义，我不确定我如何使用“格式”来格式化 preg_match 的输出

所以代码片段看起来像这样：

```
$number = 131166;

if(preg_match($pattern,$number,$match)){
//format the number based on the "format" here
} 
```

我正在寻找的输出是 (13) 11 66

$match 按预期返回了 3 个项目，我只是不确定如何使用 $1 $2 $3 来表示 $match 数组中的第一项、第二项、第三项

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:50:33.550

使用[`preg_replace`](http://www.php.net/manual/en/function.preg-replace.php)代替`preg_match`：

```
$result = preg_replace('/(13)(\\d{2})(\\d{2})/', '(\\1) \\2 \\3', $number);
// if $number is 131166 $result now is (13) 11 66 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:50:54.020

您应该使用[`preg_replace`](http://php.net/preg-replace)而不是`preg_match`：

```
$pattern = '/(13)(\\d{2})(\\d{2})/';
$format = '($1) $2 $3';
$number = 131166;

$newNumber = preg_replace($pattern, $format, $number));

echo $newNumber; // '(13) 11 66' 
```

# parsing - ActionScript Parser written in ActionScript?

> ID：15168134
> 
> 赞同：0
> 
> 时间：2013-03-01T22:46:53.410
> 
> 标签：parsing, actionscript

I Know that there are several similar questions about ActionScript parsers, where I think the most appropriated answer is FlexPMD ([http://sourceforge.net/adobe/flexpmd/home/Home/](http://sourceforge.net/adobe/flexpmd/home/Home/)). Sadly, this answer does not completely work for me, because I need the parser written in ActionScript, which allows me to manipulate the source code (eg. wrap all functions of source code).

In order to achieve my goal, I also read about meta-programing for AS3, but it seems to be limited for my purpose.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-01T18:07:10.900

我还没有尝试过，但我遇到了这个，这看起来可能是您正在寻找的：

[https://code.google.com/p/as3-commons/source/browse/trunk/as3-commons-asblocks/](https://code.google.com/p/as3-commons/source/browse/trunk/as3-commons-asblocks/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-04T13:11:22.557

我已经完成了[vegascriptparser](https://github.com/hydroper/vegascriptparser)，它解析了一种近乎方言（[VegaScript](https://github.com/vegascript/vegascript-reference)）。其他部分，vegascriptparser-bytecode 和 vegascriptparser-semantic，可能会在参考后完成。

还有自述文件上的有趣示例：

```
import vegascriptparser.*
import vegascriptparser.ast.*

const source = <![CDATA[
    trace(<{test ? 'x' : 'v'}/>)
    x?.v()
]]>.toString()

const program = Parser.quick(source).parse() 
```

变成：

```
Program {
    directives: [
    ↪  ExpressionStatement { CallExpression {
            base: Identifier,
            args: [ ConditionalExpression, ],
        }}
    ↪  ExpressionStatement { OptionalExpression {
            base: Identifier,
            sub: CallExpression, 
        }]} 
```

# jquery - How do I alter the jQuery UI Sortable (connected lists) demo such that only one list is actually sortable?

> ID：15168136
> 
> 赞同：1
> 
> 时间：2013-03-01T22:47:08.687
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable

Here is the demo I am referring to:
[http://jqueryui.com/sortable/#connect-lists](http://jqueryui.com/sortable/#connect-lists)

As is, both lists are sortable, and you can drag elements from one list to another.

How do I make the list on the left (#sortable1) **not** sortable (such that you can't rearrange the elements) while retaining the ability to drag elements from #sortable1 to #sortable2? (#sortable2 must remain sortable)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T16:39:39.163

自己修好了。

HTML：

```
<ul class="left">
    <li class="item">Drag Me</li>
    <li class="item">Over</li>
    <li class="item">There --></li>
</ul>

<ul class="right">
    <li class="built">1</li>
    <li class="built">2</li>
    <li class="built">3</li>
</ul> 
```

CSS：

```
ul {
    width: auto;
    height: 500px;
    padding: 0;
    margin: 0 100px 0 0;
    list-style-type: none;
    float: left;
    background-color: blue;
}

.left li {
    width: 100px;
    height: 100px;
    background-color: red;
    border: 1px solid;
}

.right li {
    width: 100px;
    height: 100px;
    background-color: yellow;
    border: 1px solid;
} 
```

JAVASCRIPT：

```
$(function() {

    $( ".item" ).draggable({
        helper: "clone",
        revert: "invalid",
        stack: ".item"
    });

    $( ".right" ).droppable({
        accept: ".item",
        drop: function(event, ui) {
            buildItem( ui.draggable );
        }
    }).sortable().disableSelection();

    function buildItem( $item ) {
        $item.clone().toggleClass( "item" ).appendTo( ".right" );
    }

}); 
```

这是一个演示： http:
[//jsfiddle.net/8mBSK/](http://jsfiddle.net/8mBSK/)
如果您有任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:56:41.597

尝试这样的事情：

HTML：

```
<ul id="sortable1" class="connectedSortable">
  <li class="ui-state-default">Item 1</li>
  <li class="ui-state-default">Item 2</li>
  <li class="ui-state-default">Item 3</li>
  <li class="ui-state-default">Item 4</li>
  <li class="ui-state-default">Item 5</li>
</ul>

<ul id="sortable2" class="connectedSortable">
  <li class="ui-state-highlight">Item 1</li>
  <li class="ui-state-highlight">Item 2</li>
  <li class="ui-state-highlight">Item 3</li>
  <li class="ui-state-highlight">Item 4</li>
  <li class="ui-state-highlight">Item 5</li>
</ul> 
```

JAVASCRIPT：

```
$(function() {
    $( "#sortable1" ).sortable({
        cancel: ".ui-state-default",
        connectWith: ".connectedSortable"
    }).disableSelection();

    $( "#sortable2" ).sortable({
        connectWith: ".connectedSortable"
    }).disableSelection();
}); 
```

演示：http: [//jsfiddle.net/dirtyd77/5e7X7/5/](http://jsfiddle.net/dirtyd77/5e7X7/5/)

# php - search two different MySQL tables with different fields

> ID：15168138
> 
> 赞同：1
> 
> 时间：2013-03-01T22:47:16.703
> 
> 标签：php, mysql, join, union

I found help at this topic: [Search different column names in different tables in MySQL](https://stackoverflow.com/questions/9375571/search-different-column-names-in-different-tables-in-mysql) but they are only referencing two fields per table in that topic and I wasn't able to generate an answer from my searches.

**EDIT :** I have also found this thread: [Combine two tables that have no common fields](https://stackoverflow.com/questions/1198124/combine-two-tables-that-have-no-common-fields) which gives a little more helpful information, but I am still not able to figure out how to combine these properly

I have never had the need to create a `JOIN` or `UNION` query, so this is all pretty new to me. So forgive me if there is an easy solution to this.

I need to run a query that will search through two different database tables that have completely different fields.

Here are the two queries I am trying to combine into one:

```
"SELECT * FROM seekers 
    WHERE (first_name LIKE '%".$q."%') 
        OR (last_name LIKE '%".$q."%') 
        OR (username LIKE '%".$q."%') 
        OR (school LIKE '%".$q."%') 
        OR (major LIKE '%".$q."%') 
        OR (employer LIKE '%".$q."%') 
        OR (position LIKE '%".$q."%') 
        OR (background LIKE '%".$q."%') 
        OR (interests LIKE '%".$q."%') 
        OR (skills LIKE '%".$q."%')
    ORDER BY id DESC"

"SELECT * FROM companies 
    WHERE (company_name LIKE '%".$q."%') 
        OR (username LIKE '%".$q."%') 
        OR (industry LIKE '%".$q."%') 
        OR (slogan LIKE '%".$q."%')
        OR (location LIKE '%".$q."%') 
    ORDER BY id" 
```

After the query, I want to get all the fields into an array and display the data accordingly.

I guess the major problem I am having with this is deciding how I should go about combining the tables? Do I want to use a `JOIN` (inner or outer) or do I want to use a `UNION`?

I have tried to create a `VIEW` by doing this: `$this->mysqli->query("CREATE VIEW userTable AS (SELECT * FROM seekers) UNION ALL (SELECT * FROM companies)");` but that didn't work, I'm guessing because the tables have far different fields.

**EDIT :** After trying some of the answers below, I have come up with this query:

```
SELECT first_name, last_name, username, school, major, employer, position, background, interests, skills 
    FROM seekers 
        WHERE (first_name LIKE '%".$q."%') 
        OR (last_name LIKE '%".$q."%') 
        OR (username LIKE '%".$q."%') 
        OR (school LIKE '%".$q."%') 
        OR (major LIKE '%".$q."%') 
        OR (employer LIKE '%".$q."%') 
        OR (position LIKE '%".$q."%') 
        OR (background LIKE '%".$q."%') 
        OR (interests LIKE '%".$q."%') 
        OR (skills LIKE '%".$q."%')
    UNION ALL 
        SELECT company_name, username, industry, slogan, location, NULL, NULL, NULL, NULL, NULL 
            WHERE (company_name LIKE '%".$q."%') 
                OR (username LIKE '%".$q."%') 
                OR (industry LIKE '%".$q."%') 
                OR (slogan LIKE '%".$q."%') 
                OR (location LIKE '%".$q."%') 
```

I removed the `ORDER BY` clause because I was getting an error saying "Incorrect use of UNION and ORDER BY", so after removing the `ORDER BY` I get this error: "Query Failed: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'WHERE (company_name LIKE '%0%') OR (username LIKE '%0%') OR (industry LIKE '%0%')' at line 1"

Why is `$q` becoming 0 in the query after the union?

**EDIT #2 :** Here is a `JOIN` query I put together that actually returns data, but it doesn't return the correct data. I don't know if this will help answer the question, but I thought I would put it here anyway.

```
"SELECT * FROM seekers t1 LEFT JOIN companies t2 ON t1.id = t2.id WHERE (t1.first_name LIKE '%".$q."%') OR (t1.last_name LIKE '%".$q."%') OR (t1.username LIKE '%".$q."%') OR (t1.school LIKE '%".$q."%') OR (t1.major LIKE '%".$q."%') OR (t1.employer LIKE '%".$q."%') OR (t1.position LIKE '%".$q."%') OR (t1.background LIKE '%".$q."%') OR (t1.interests LIKE '%".$q."%') OR (t1.skills LIKE '%".$q."%') OR (t2.company_name LIKE '%".$q."%') OR (t2.username LIKE '%".$q."%') OR (t2.industry LIKE '%".$q."%') OR (t2.slogan LIKE '%".$q."%') OR (t2.location LIKE '%".$q."%')" 
```

sorry for the formatting on the last query, SO messed it up when pasting.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:07:32.833

您可以尝试使用 UNION，但为每个列名指定一个别名。确保它们的顺序相同。请参见下面的示例：

```
SELECT first_name col1, last_name col2 etc etc FROM seekers 
    WHERE (first_name LIKE '%".$q."%') 
        OR (last_name LIKE '%".$q."%') 
        OR (username LIKE '%".$q."%') 
        OR (school LIKE '%".$q."%') 
        OR (major LIKE '%".$q."%') 
        OR (employer LIKE '%".$q."%') 
        OR (position LIKE '%".$q."%') 
        OR (background LIKE '%".$q."%') 
        OR (interests LIKE '%".$q."%') 
        OR (skills LIKE '%".$q."%')
    ORDER BY id DESC
UNION
SELECT company_name col1, username col2, etc etc FROM companies 
    WHERE (company_name LIKE '%".$q."%') 
        OR (username LIKE '%".$q."%') 
        OR (industry LIKE '%".$q."%') 
        OR (slogan LIKE '%".$q."%')
        OR (location LIKE '%".$q."%') 
    ORDER BY id 
```

这会将同一结果集中的列匹配在一起。即，first_name 和 company_name 将显示在 col1 中，依此类推。

笔记

1.  使用 UNION，您需要在两个查询中选择相同数量的列。
2.  您需要匹配数据类型
3.  如果您需要伪造列，请使用 null

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:04:38.240

当您使用 UNION 时，您需要确保每个 SELECT 中的字段数相等。所以在你上面的例子中你不应该使用'Select *' - 做这样的事情：

选择 t1.field1, t1.field2, t1.field3, t1.field4, t1.field5, t1.field6
From .....
Where .....

联盟

选择 t2.field1, t2.field2, t2.field3, t2.field4, '', ''
From .....
Where .....

如果每个 Select 中的字段数不同，请添加一些空白以使其均匀。

# haskell - Haskell: Calling a function multiple times within the same line

> ID：15168140
> 
> 赞同：0
> 
> 时间：2013-03-01T22:47:24.750
> 
> 标签：haskell

If I have a function like the following

```
f x = if g x /= Nothing then g x else False 
```

will `g` be called twice in `f` or does Haskell 'cache' the result of `g x` after the first instance for possible later use in the same line? I'm trying to optimise some code and I don't know if functions in the style of the one above are twice as computationally expensive as I want them to be.

Thanks in advance.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-01T23:08:03.480

Haskell 实现不记忆函数调用。

Haskell 编译器（如 GHC）确实[会进行常见的子表达式消除](https://stackoverflow.com/questions/15084162/does-haskell-optimizer-utilize-memoization-for-repeated-function-calls-in-a-scop/15085255#15085255)，但存在一些限制。

如有疑问，请分享结果。

```
f x = if g' /= Nothing then g' else False
    where g' = g x 
```

但是你有一个类型错误，因为 g' 不能同时是布尔值和可能。

但最好写成：

```
f x = case g x of
          Nothing -> ..
          Just _  -> .. 
```

仅在一个分支中计算和共享结果。

# xcode - xcode textfield to NSURL path

> ID：15168145
> 
> 赞同：0
> 
> 时间：2013-03-01T22:47:58.103
> 
> 标签：xcode, nsurlconnection

I am trying to get a URL from my user in a TextField and then process the result. Presently an exception is being thrown with the following `-[UITextField length]: unrecognized selector sent to instance` in the NSURLRequest below when I supply `URLWithString: (NSString *)self.urlNameInput]`.

myViewController.h

```
@class myViewController;
@interface myViewController : UIViewController <UITextFieldDelegate, NSURLConnectionDataDelegate, NSURLConnectionDelegate>
{
    NSMutableData *receivedData;
}
@property (weak, nonatomic) IBOutlet UITextField *urlNameInput;
@property (nonatomic, retain) IBOutlet UINavigationController *navigationController;
@end 
```

myViewController.m

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField {
    if (textField == self.urlNameInput) {
        [textField resignFirstResponder];
        NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL URLWithString: (NSString *)self.urlNameInput] cachePolicy:NSURLRequestUseProtocolCachePolicy
                                              timeoutInterval:60.0];
        // create the connection with the request
        // and start loading the data

        NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
        if (theConnection) {
            // Create the NSMutableData to hold the received data.
            // receivedData is an instance variable declared elsewhere.
            receivedData = [NSMutableData data] ;
        } else {
            // Inform the user that the connection failed.
            NSLog(@"Their is an error with that URL.");
        }

    }
    return YES;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T22:58:52.940

我认为您的错误是，您将 UITextField 传递给期望 NSString 的方法。改变

```
NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL URLWithString: (NSString *)self.urlNameInput] cachePolicy:NSURLRequestUseProtocolCachePolicy
                                          timeoutInterval:60.0]; 
```

至

```
NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL URLWithString:self.urlNameInput.text] cachePolicy:NSURLRequestUseProtocolCachePolicy
                                          timeoutInterval:60.0]; 
```

# android - USB Host Mode - device access permission granted but not remembered

> ID：15168148
> 
> 赞同：19
> 
> 时间：2013-03-01T22:48:18.780
> 
> 标签：android, usb, host

I have a USB Host Mode application that works perfectly. I plug in the device, Android pops up the **Allow the app APPNAME to access the USB device?** permission request window, I check the **Use by default for this USB device** tick box and tap **OK**, then up comes my app and it communicates with the USB device perfectly.

BUT...

Then I unplug the device and plug it back in. Android pops up the **Allow the app APPNAME to access the USB device?** dialog again. WTH? I've already told Android to do this by default, so why is it asking me again?

This happens both with Icecream Sandwich 4.0.3 and Jellybean 4.1.

Ideally I want Android to remember I've granted permission for this particular USB device even after I've rebooted the Android device.

So why isn't Android remembering that I've granted permission?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-10T13:20:28.937

这是[USB设备访问弹出抑制的dup？](https://stackoverflow.com/questions/12388914/usb-device-access-pop-up-supression). 基本上答案是在 USB_DEVICE_ATTACHED 上使用意图过滤器并避开 RequestPermission USB 主机模式 API 调用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T08:52:33.377

[我在这里](https://android.stackexchange.com/questions/39851/how-to-stop-android-asking-for-permission-before-permitting-access-to-usb-device/41090#41090)回答了这个问题，尽管我认为其他 SE 站点之间的重复是允许的。

回答*为什么*，正如您在所述线程中所推测的那样；因为对于您的硬件，每次连接时都会获得不同的标识符，例如 /dev/bus/usb/001/、/dev/bus/usb/002/ 等等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-01-10T10:01:59.193

Android 只是不记得我对我的设备的授权但幸运的是，我找到了原因：我在 device_filter.xml 中使用了十六进制值。将其更改为**十进制值**后，一切正常。我的 Android 可以记住我的许可证。

# php - echo css styling

> ID：15168149
> 
> 赞同：-2
> 
> 时间：2013-03-01T22:48:19.263
> 
> 标签：php, css

I have this echo, however I'm unsure how I'd style the echo with for instance a tag. I'd appreciate some examples.

```
echo $lastpireps['landingrate']; 
```

Additionally, is there anyway of styling this echo through a css file?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:49:50.240

你可以这样做：

```
<div class="foo"><?php echo $lastpireps['landingrate']; ?></div> 
```

或这个：

```
echo '<div class="foo">' . $lastpireps['landingrate'] . '</div>'; 
```

`.foo`然后像往常一样在你的CSS中设置样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:52:38.183

有成千上万种方法。这是一个。

如果您处于 php 代码的块/循环中

`echo "<div class='myclass'>".$lastpireps['landingrate']."</div>";`

在 CSS 中

`.myclass {}`

# delegates - How to Save an Expression Tree as the Main Entry Point to a New Executable Disk File?

> ID：15168150
> 
> 赞同：6
> 
> 时间：2013-03-01T22:48:19.247
> 
> 标签：delegates, dynamic-assemblies

I'm trying to export an expression tree to a PE assembly as the main entry point. I've acquired a Lambda Expression through building an expression tree, for example:

```
using System.Linq;
using System;

// 1\. use expression trees to create a block expression (not shown)

// 2\. create a lambda expression: 
LambdaExpression exprLambda = Expression.Lambda(exprBlock, new ParameterExpression[0]);

MethodBuilder mbuilder = null;
// 3\. ??? Somehow get a method builder instance that works ??? 

// 4\. Compile the lambda using the MethodBuilder instance. 
exprLambda.CompileToMethod(mbuilder);

// 5\. ??? Somehow get an AssemblyBuilder instance to .Save(..) this to disk.  ??? 
```

Steps 3 and 5 are what I'm missing.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-01T23:20:44.200

而不是仅仅使用`Expression.Compile`，使用[`Expression.CompileToMethod(MethodBuilder)`](http://msdn.microsoft.com/en-us/library/dd728224.aspx)。

简短但完整的示例，它在磁盘上创建可执行文件，表达式树作为在入口点执行的代码：

```
using System;
using System.Reflection;
using System.Reflection.Emit;
using System.Linq.Expressions;

class Program
{
    static void Main()
    {
        var asmName = new AssemblyName("Foo");
        var asmBuilder = AssemblyBuilder.DefineDynamicAssembly
            (asmName, AssemblyBuilderAccess.RunAndSave);
        var moduleBuilder = asmBuilder.DefineDynamicModule("Foo", "Foo.exe");

        var typeBuilder = moduleBuilder.DefineType("Program", TypeAttributes.Public);
        var methodBuilder = typeBuilder.DefineMethod("Main",
            MethodAttributes.Static, typeof(void), new[] { typeof(string) });

        Expression<Action> action = () => Console.WriteLine("Executed!");

        action.CompileToMethod(methodBuilder);

        typeBuilder.CreateType();
        asmBuilder.SetEntryPoint(methodBuilder);
        asmBuilder.Save("Foo.exe");
    }
} 
```

# objective-c - 使用重要位置管理器的应用程序在设备上意外关闭，但在模拟器上却没有

> ID：15168153
> 
> 赞同：2
> 
> 时间：2013-03-01T22:48:34.453
> 
> 标签：objective-c, ios6, location

我希望有一个人可以帮助我。我正在 xcode 4.5.2 上开发 iOS 6 应用程序，该应用程序使用显着变化的位置服务，它检测本地化使用反向地理编码并使用网络将国家代码、adminArea、subAdminArea、locality 和 sublocality 上传到在线数据库服务。在 iphone 模拟器上它工作正常，但在 iOS 设备上它直接无缘无故关闭。如果我停用我的应用程序的定位服务，它运行正常，但是当它有权使用这些服务时，它会在一秒钟内关闭。

这是代码：

```
 #import "searchViewController.h"
    #import <CoreLocation/CoreLocation.h>
    #import "resultViewController.h"

    @interface searchViewController () <UIPickerViewDataSource, UIPickerViewDelegate, CLLocationManagerDelegate, NSXMLParserDelegate>
    @property (weak, nonatomic) IBOutlet UITextView *errorSearchTextView;
    - (IBAction)searchButton:(id)sender;
    @property (weak, nonatomic) IBOutlet UIPickerView *bloodTypePicker;

    @end

    @implementation searchViewController

    @synthesize bloodType,locationManager,geocoder, webData, xmlParser, soapResults, localizacion, usuarios, correos, coincidencias;

- (void)viewDidLoad
{
    [super viewDidLoad];
    bloodType = [[NSArray alloc] initWithObjects:@"A+", @"A-", @"B+", @"B-", @"O+", @"O-", @"AB+", @"AB-", nil];
    [self startLocating];//here is where i start the location monitoring
    // Do any additional setup after loading the view.
} 
```

//这是启动位置管理器的方法。

```
- (void) startLocating
{
    if ([CLLocationManager locationServicesEnabled])//si los servicios de localizacion estan activados.
    {
        if (nil == locationManager) {
            locationManager = [[CLLocationManager alloc] init];
            locationManager.delegate = self;
            [locationManager startMonitoringSignificantLocationChanges];
        }
    } else
    {
        self.errorSearchTextView.text = NSLocalizedString(@"location services are not available, app will not work properly, please activate these and restart the app.", @"localization not available");
    }
} 
```

//这些是收到位置更新时调用的方法。

```
-(void) locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations
{
    CLLocation *location = [locations lastObject];
    [self geocoder:location];
    localizacion = 0;
}

//metodo para el geocoder
-(void) geocoder:(CLLocation *)location
{
    if (!geocoder) geocoder = [[CLGeocoder alloc] init];
    [geocoder reverseGeocodeLocation:location  completionHandler:^(NSArray *placemarks, NSError *error) {
        if ([placemarks count]>0)
        {
            NSString *usuario = [[NSUserDefaults standardUserDefaults] stringForKey:@"usuario"];
            CLPlacemark *place = [placemarks objectAtIndex:0];
            NSURL *url = [NSURL URLWithString:@"here goes the web service url"];
            NSMutableString *soapMessage = [[NSMutableString alloc] init];
            [soapMessage appendString:@"<soapenv:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:urn=\"urn:localizacionWSDL\">"
             "<soapenv:Header/>"
             "<soapenv:Body>"
                "<urn:actualiza soapenv:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\">"
             "<username xsi:type=\"xsd:string\">"];
            [soapMessage appendString:usuario];
            [soapMessage appendString:@"</username>"
             "<latitude xsi:type=\"xsd:string\">"];
            [soapMessage appendString:[NSString stringWithFormat:@"%f",location.coordinate.latitude] ];
            [soapMessage appendString:@"</latitude>"
             "<longitude xsi:type=\"xsd:string\">"];
            [soapMessage appendString:[NSString stringWithFormat:@"%f",location.coordinate.longitude]];
            [soapMessage appendString:@"</longitude>"
             "<countryCode xsi:type=\"xsd:string\">"];
            [soapMessage appendString:place.ISOcountryCode];
            [soapMessage appendString:@"</countryCode>"
             "<adminArea xsi:type=\"xsd:string\">"];
            [soapMessage appendString:place.administrativeArea];
            [soapMessage appendString:@"</adminArea>"
             "<subAdminArea xsi:type=\"xsd:string\">"];
            [soapMessage appendString:place.subAdministrativeArea];
            [soapMessage appendString:@"</subAdminArea>"
             "<locality xsi:type=\"xsd:string\">"];
            [soapMessage appendString:place.locality];
            [soapMessage appendString:@"</locality>"
             "<subLocality xsi:type=\"xsd:string\">"];
            [soapMessage appendString:place.subLocality];
            [soapMessage appendString:@"</subLocality>"
             "</urn:actualiza>"
             "</soapenv:Body>"
             "</soapenv:Envelope>"];
            NSMutableURLRequest *theResquest = [NSMutableURLRequest requestWithURL:url];
            NSString *messageLength = [NSString stringWithFormat:@"%d", [soapMessage length]];
            [theResquest addValue:@"text/xml; charset=utf-8" forHTTPHeaderField:@"Content-Type"];
            [theResquest addValue:@"urn:LoginAction" forHTTPHeaderField:@"SOAPAction"];
            [theResquest addValue:messageLength forHTTPHeaderField:@"Content-Length"];
            [theResquest setHTTPMethod:@"POST"];
            [theResquest setHTTPBody:[soapMessage dataUsingEncoding:NSUTF8StringEncoding]];
            webData = [NSMutableData data];
            localizacion = 0;
            NSURLConnection *theConnection = [[NSURLConnection alloc] initWithRequest:theResquest delegate:self];
            if (theConnection) {
                self.errorSearchTextView.text = NSLocalizedString(@"BloodyHelp is updating your data.", @"updating location");
            } else {
                self.errorSearchTextView.text = NSLocalizedString(@"Conection error.\n", @"connection error updating");
            }
        }
    }];
} 
```

我真的不知道该怎么办。因为在模拟器中一切正常。PD 我是 objetive-c 的新程序员

编辑：添加崩溃报告

```
Incident Identifier: C14368BA-39ED-454F-930C-1D2CB94FB299
CrashReporter Key:   1eeb5e6ac17a73185e6d73aeb7aa4da7e7edab94
Hardware Model:      iPad3,3
Process:         XXXX [2221]
Path:            /var/mobile/Applications/901983D5-A1AA-4642-A858-9E211D0AA09E/xxxx.app/xxxx
Identifier:      xxxxxx
Version:         ??? (???)
Code Type:       ARM (Native)
Parent Process:  launchd [1]

Date/Time:       2013-03-01 11:35:58.829 -0600
OS Version:      iOS 6.1.2 (10B146)
Report Version:  104

Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x0000000000000000, 0x0000000000000000
Crashed Thread:  0

Last Exception Backtrace:
(0x3302629e 0x3aebf97a 0x330261c0 0x32ff576e 0x6fba8 0x3b2d711a 0x3b2d64b2 0x3b2db1b8 0x32ff9f36 0x32f6ceb8 0x32f6cd44 0x36b1f2e6 0x34e822fc 0x6d7ea 0x3b2f6b1c)

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   libsystem_kernel.dylib          0x3b3bd350 0x3b3ac000 + 70480
1   libsystem_c.dylib               0x3b33411e 0x3b305000 + 192798
2   libsystem_c.dylib               0x3b37096e 0x3b305000 + 440686
3   libc++abi.dylib                 0x3a90ed4a 0x3a90b000 + 15690
4   libc++abi.dylib                 0x3a90bff4 0x3a90b000 + 4084
5   libobjc.A.dylib                 0x3aebfa74 0x3aeb7000 + 35444
6   libc++abi.dylib                 0x3a90c078 0x3a90b000 + 4216
7   libc++abi.dylib                 0x3a90c110 0x3a90b000 + 4368
8   libc++abi.dylib                 0x3a90d50e 0x3a90b000 + 9486
9   libobjc.A.dylib                 0x3aebf9ba 0x3aeb7000 + 35258
10  CoreFoundation                  0x330261c0 0x32f64000 + 795072
11  CoreFoundation                  0x32ff576e 0x32f64000 + 595822
12  appname                     0x0006fba8 0x6c000 + 15272
13  libdispatch.dylib               0x3b2d711c 0x3b2d5000 + 8476
14  libdispatch.dylib               0x3b2d64b4 0x3b2d5000 + 5300
15  libdispatch.dylib               0x3b2db1b8 0x3b2d5000 + 25016
16  CoreFoundation                  0x32ff9f36 0x32f64000 + 614198
17  CoreFoundation                  0x32f6ceb8 0x32f64000 + 36536
18  CoreFoundation                  0x32f6cd44 0x32f64000 + 36164
19  GraphicsServices                0x36b1f2e6 0x36b1a000 + 21222
20  UIKit                           0x34e822fc 0x34e2b000 + 357116
21  appname                     0x0006d7ea 0x6c000 + 6122
22  libdyld.dylib                   0x3b2f6b1c 0x3b2f5000 + 6940

Thread 1 name:  Dispatch queue: com.apple.libdispatch-manager
Thread 1:
0   libsystem_kernel.dylib          0x3b3ad648 0x3b3ac000 + 5704
1   libdispatch.dylib               0x3b2dd974 0x3b2d5000 + 35188
2   libdispatch.dylib               0x3b2dd654 0x3b2d5000 + 34388

Thread 2 name:  WebThread
Thread 2:
0   libsystem_kernel.dylib          0x3b3aceb4 0x3b3ac000 + 3764
1   libsystem_kernel.dylib          0x3b3ad048 0x3b3ac000 + 4168
2   CoreFoundation                  0x32ffb040 0x32f64000 + 618560
3   CoreFoundation                  0x32ff9d9e 0x32f64000 + 613790
4   CoreFoundation                  0x32f6ceb8 0x32f64000 + 36536
5   CoreFoundation                  0x32f6cd44 0x32f64000 + 36164
6   WebCore                         0x38f52500 0x38f48000 + 42240
7   libsystem_c.dylib               0x3b31630e 0x3b305000 + 70414
8   libsystem_c.dylib               0x3b3161d4 0x3b305000 + 70100

Thread 3:
0   libsystem_kernel.dylib          0x3b3bdd98 0x3b3ac000 + 73112
1   libsystem_c.dylib               0x3b30bcf6 0x3b305000 + 27894
2   libsystem_c.dylib               0x3b30ba12 0x3b305000 + 27154
3   libsystem_c.dylib               0x3b30b8a0 0x3b305000 + 26784

Thread 4:
0   libsystem_kernel.dylib          0x3b3bdd98 0x3b3ac000 + 73112
1   libsystem_c.dylib               0x3b30bcf6 0x3b305000 + 27894
2   libsystem_c.dylib               0x3b30ba12 0x3b305000 + 27154
3   libsystem_c.dylib               0x3b30b8a0 0x3b305000 + 26784

Thread 5 name:  com.apple.NSURLConnectionLoader
Thread 5:
0   libsystem_kernel.dylib          0x3b3aceb4 0x3b3ac000 + 3764
1   libsystem_kernel.dylib          0x3b3ad048 0x3b3ac000 + 4168
2   CoreFoundation                  0x32ffb040 0x32f64000 + 618560
3   CoreFoundation                  0x32ff9d9e 0x32f64000 + 613790
4   CoreFoundation                  0x32f6ceb8 0x32f64000 + 36536
5   CoreFoundation                  0x32f6cd44 0x32f64000 + 36164
6   Foundation                      0x338b93d0 0x3388c000 + 185296
7   Foundation                      0x3393ce80 0x3388c000 + 724608
8   libsystem_c.dylib               0x3b31630e 0x3b305000 + 70414
9   libsystem_c.dylib               0x3b3161d4 0x3b305000 + 70100

Thread 6:
0   libsystem_kernel.dylib          0x3b3bdd98 0x3b3ac000 + 73112
1   libsystem_c.dylib               0x3b30bcf6 0x3b305000 + 27894
2   libsystem_c.dylib               0x3b30ba12 0x3b305000 + 27154
3   libsystem_c.dylib               0x3b30b8a0 0x3b305000 + 26784

Thread 7 name:  com.apple.CFSocket.private
Thread 7:
0   libsystem_kernel.dylib          0x3b3bd594 0x3b3ac000 + 71060
1   CoreFoundation                  0x32fff1f2 0x32f64000 + 635378
2   libsystem_c.dylib               0x3b31630e 0x3b305000 + 70414
3   libsystem_c.dylib               0x3b3161d4 0x3b305000 + 70100

Thread 8:
0   libsystem_kernel.dylib          0x3b3bdd98 0x3b3ac000 + 73112
1   libsystem_c.dylib               0x3b30bcf6 0x3b305000 + 27894
2   libsystem_c.dylib               0x3b30ba12 0x3b305000 + 27154
3   libsystem_c.dylib               0x3b30b8a0 0x3b305000 + 26784

Thread 0 crashed with ARM Thread State (32-bit):
    r0: 0x00000000    r1: 0x00000000      r2: 0x00000000      r3: 0x3ceb1534
    r4: 0x00000006    r5: 0x3ceb1b88      r6: 0x1f0e3e24      r7: 0x2fd93c74
    r8: 0x1f0e3e00    r9: 0x00000300     r10: 0x38ac0a46     r11: 0x38ac0ce8
    ip: 0x00000148    sp: 0x2fd93c68      lr: 0x3b334123      pc: 0x3b3bd350
  cpsr: 0x00000010

Binary Images: 
```

还有更多，但是太长了。够了吗？

编辑我把控制台拿出来：

```
Mar  1 22:08:26 iPad-de-xxx locationd[45] <Notice>: client 'com.appname' starting significant location changes
Mar  1 22:08:26 iPad-de-xxx awdd[3079] <Error>: libMobileGestalt copySystemVersionDictionaryValue: Could not lookup ReleaseType from system version dictionary
Mar  1 22:08:26 iPad-de-xxx awdd[3079] <Error>: CoreLocation: CLClient is deprecated. Will be obsolete soon.
Mar  1 22:08:49 iPad-de-xxx awdd[3080] <Error>: libMobileGestalt copySystemVersionDictionaryValue: Could not lookup ReleaseType from system version dictionary
Mar  1 22:08:49 iPad-de-xxx awdd[3080] <Error>: CoreLocation: CLClient is deprecated. Will be obsolete soon.
Mar  1 22:08:52 iPad-de-xxx appname copy[3078] <Error>: *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFString appendString:]: nil argument'
    *** First throw call stack:
    (0x330262a3 0x3aebf97f 0x330261c5 0x32ff5773 0xfb85 0x3b2d711f 0x3b2d64b7 0x3b2db1bd 0x32ff9f3b 0x32f6cebd 0x32f6cd49 0x36b1f2eb 0x34e82301 0xd7c7 0x3b2f6b20)
Mar  1 22:08:52 iPad-de-xxxx ReportCrash[3082] <Notice>: Formulating crash report for process BloodyHelp copy[3078]
Mar  1 22:08:52 iPad-de-xxxxx com.apple.launchd[1] (UIKitApplication:com.appname[0x9e96][3078]) <Warning>: (UIKitApplication:com.appname[0x9e96]) Job appears to have crashed: Abort trap: 6
Mar  1 22:08:52 iPad-de-xxxxbackboardd[26] <Warning>: Application 'UIKitApplication:com.appname[0x9e96]' exited abnormally with signal 6: Abort trap: 6
Mar  1 22:08:52 iPad-de-Shimon ReportCrash[3082] <Error>: libMobileGestalt copySystemVersionDictionaryValue: Could not lookup ReleaseType from system version dictionary
Mar  1 22:08:52 iPad-de-xxx ReportCrash[3082] <Notice>: Saved crashreport to /var/mobile/Library/Logs/CrashReporter/appname copy_2013-03-01-220852_iPad-de-xxxx plist using uid: 0 gid: 0, synthetic_euid: 501 egid: 0

*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFString appendString:]: nil argument' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T08:04:41.967

我终于解决了这个问题，崩溃日志和控制台输出是找到错误的确切点并解决它的点，问题不在于定位服务，问题是在进行 gocoding 之后，子管理区域为空，我试图附加到一个字符串，因为它的值是 nil 它抛出一个异常并关闭。

解决方案是创建这个

```
 NSString *subAdminArea = [NSString StringWithFormat:@"%d",place.subAdministrativeArea]; 
```

所以如果 place.subAdministrativeArea 的值为 nil 它是一个“”字符串。

建议：要解决问题，请将设备连接到 xcode 并在您看到控制台输出时发生错误（您可以将“控制台标志”与 NSLog 一起放置以了解错误在哪里。

谢谢！！

# .htaccess - 带有 mod-rewrite 的假子域

> ID：15168154
> 
> 赞同：0
> 
> 时间：2013-03-01T22:48:38.983
> 
> 标签：.htaccess, mod-rewrite

很抱歉问这个...我已经看到了各种答案，但我找不到可以帮助我的答案（可能是因为我对这个过程很陌生）

继承人的问题。我想伪造一个子域，以便人们去，`sub.domain.co.uk`但服务器读取它，`domain.co.uk/?event=sub`然后他们可以添加其他婴儿车，比如`sub.domain.co.uk/Login`导致`domain.co.uk/?event=sub&url=Login`等等

我到目前为止的代码是这样的：

```
RewriteCond %{REQUEST_URI}  !\.(php|html?|jpg|gif)$
RewriteRule ^(.*)([^/])$ http://%{HTTP_HOST}/$1$2/ [L,R=301]

# Rewrite event / url / action1 / action 2 etc.
RewriteCond %{HTTP_HOST} ^(.*)\.domain\.co\.uk$ [NC]
RewriteRule ^/$ /index.php?event=%1 [QSA,L,NC]
RewriteRule ^([^/]*)/$ /index.php?event=%1&url=$1 [QSA,L,NC]
RewriteRule ^([^/]*)/([^/]*)/$ /index.php?event=%1&url=$1&action1=$2 [QSA,L,NC]
RewriteRule ^([^/]*)/([^/]*)/([^/]*)/$ /index.php?event=%1&url=$1&action1=$2&action2=$3 [QSA,L,NC] 
```

几乎就在那里......它得到了url，action1和action2但没有事件！..如果我`/`关闭它看起来像这样`RewriteRule ^$ index.php?event=%1 [QSA,L,NC]`然后我得到事件但是它试图加载下一个命令所以

```
sub.domain.co.uk 
```

负载

```
domain.co.uk/?event=sub&url= 
```

这是一个错误，因为当我加载 action2 时，它 404 在我身上！有人帮它把我逼疯了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T13:13:40.327

对，这是我所做的一个肮脏的修复。我的 .htaccess 现在是这样的：

```
# Rewrite event / url / action1 / action 2 etc.
RewriteCond %{HTTP_HOST} ^(.*)\.domain\.co\.uk$ [NC]
RewriteRule ^/$ /index.php [QSA,L,NC]
RewriteRule ^([^/]*)/$ /index.php?url=$1 [QSA,L,NC]
RewriteRule ^([^/]*)/([^/]*)/$ /index.php?url=$1&action1=$2 [QSA,L,NC]
RewriteRule ^([^/]*)/([^/]*)/([^/]*)/$ /index.php?url=$1&action1=$2&action2=$3 [QSA,L,NC] 
```

在php中我有这个：

```
$sub = explode ( '.' , $_SERVER['HTTP_HOST'] );
$event = $sub[0] == 'www' || $sub[0] == 'domain' ? false : $sub[0] ; 
```

现在我可以查看 $event var 是否已加载...

如果有人有更清洁的方式，我会全神贯注，但这对我有用 HUZZAR

# objective-c - UIWebView 内容不能由用户调整大小

> ID：15168155
> 
> 赞同：0
> 
> 时间：2013-03-01T22:48:50.043
> 
> 标签：objective-c, user-interface, uiwebview

我对这个小问题感到震惊，只是想不出办法。我的歉意和感激。

描述：

针对 iPhone 的具有全屏 UIWebView 的 UIView 使用`viewDidLoad`方法以编程方式加载网页。将应用程序运行到模拟器中时会显示 UIWebView，网页已加载，但不允许捏合。因此，我可以在页面上移动，但不能使用多手势调整大小。

细节：

```
- (void)viewDidLoad {

   NSString *urlAddress = @"http://www.someurl.it";

   NSURL *url = [NSURL URLWithString:urlAddress];

   NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];

   [webView loadRequest:requestObj];

   webView.userInteractionEnabled=YES;
   webView.autoresizingMask=YES;
   webView.multipleTouchEnabled=YES;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T00:01:35.217

只需将这行代码与您为 webview 设置的其他属性一起插入：

`webView.scalesPageToFit = YES;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:16:10.867

因为设置适当的属性以允许[UIWebView](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebView_Class/Reference/Reference.html)解释捏到缩放事件被调用`scalesPageToFit`。设置 an`autoresizingMask`是对 UIView 中的自动旋转布局机制的提示，即视图应放置在给定设备的新坐标空间中的何处。

# javascript - chrome/firefox浏览器作用域处理的差异

> ID：15168156
> 
> 赞同：3
> 
> 时间：2013-03-01T22:48:51.473
> 
> 标签：javascript, google-chrome, dom, cross-browser, scope

这会在 chrome 中提醒 x，但不会在 Firefox（Chrome 25.0/FF 11.0）上提醒：

```
var x="hi.", b;
(b = document.createElement("button")).innerHTML = "click me";
b.setAttribute("onclick", "alert(x)"); // Doesn't work on FF, but works on Chrome
document.body.appendChild(b); 
```

它在我使用 DOM（b.onclick，如下面的代码）时都适用，但在使用字符串形式的属性时返回“x not defined”错误，就像上面的代码一样。

```
var x="hi.", b;
(b = document.createElement("button")).innerHTML = "click me";
b.onclick = function(){alert(x)}; // Works on FF/Chrome
document.body.appendChild(b); 
```

导致这种情况的两种浏览器之间有什么区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:55:11.943

这应该适用于 FF 和 Chrome，但不适用于 IE，您需要实际传递变量吗？

```
var x="hi.", b;
(b = document.createElement("button")).innerHTML = "click me";
b.setAttribute("onclick", "alert('"+x+"')");
document.body.appendChild(b); 
```

据我所知，在（旧版本的）IE 中，您不能使用 setAttribute 设置内联 javascript。

[**FIDDLE**](http://jsfiddle.net/adeneo/zZtVt/)（在 FF 19 和最新的 Chrome 中测试）

# c# - 具有 2 个不同阅读器的阅读流

> ID：15168158
> 
> 赞同：1
> 
> 时间：2013-03-01T22:49:07.577
> 
> 标签：c#, stream, filestream, streamreader, fixed-width

我有一个文本文件，其中包含我要解析的固定长度表。但是，文件的开头是有关何时生成此表的一般信息（IE 时间、数据等）。

要阅读此内容，我尝试制作一个`FileStream`，然后使用`StreamReader`. 我从文档的顶部解析出我需要的内容，然后当我完成后，将流的位置设置为结构化数据的第一行。

然后我将 a 附加`TextFieldParser`到流（使用固定长度表的适当设置），然后尝试读取文件。在第一行，它失败了，在`ErrorLine`属性中，它列出了表格第三行的后半部分。我穿过它，它在第一行阅读，但该`ErrorLine`属性表明并非如此。

调试时，我发现如果`StreamReader.ReadLine()`在将 附加`TextFieldParser`到流后尝试使用我的方法，前 2 行显示正常。但是，当我阅读第三行时，它会返回一行，该行从第三行的前半部分开始（并在文本所在的位置停止`ErrorLine`）附加了文档中很晚的部分。如果我在附加之前尝试这个`TextFieldParser`，它会读取所有 3 行。

我觉得这与我将 2 个读者绑定到同一个流有关。我不确定如何使用结构化部分和非结构化部分来阅读此内容，而不仅仅是自己标记这些行。我可以做到这一点，但我认为我不是第一个想要以一种方式读取流的一部分，而以另一种方式读取流的后半部分的人。

为什么会这样跳过，你将如何阅读不同格式的文本文件？

例子：

```
Date: 3/1/2013
Time: 3:00 PM
Sensor:  Awesome Thing

Seconds   X        Y          Value
0         5.1      2.8        55
30        4.9      2.5        33
60        5.0      5.3        44 
```

为这个简化示例量身定制的代码：

```
Boolean setupInfo = true;
DataTable result = new DataTable();
String[] fields;
Double[] dFields;

FileStream stream = File.Open(filePath,FileMode.Open);

StreamReader reader = new StreamReader(stream);

String tempLine;

for(int j = 1; j <= 7; j++)
{
   result.Columns.Add(("Column" + j));
}

//Parse the unstructured part
while(setupInfo)
{
   tempLine = reader.ReadLine();
   if( tempLine.StartsWith("Date:  "))
   {
       result.Rows.Add(tempLine);
   }
   else if (tempLine.StartsWith("Time:  "))
   {
       result.Rows.Add(tempLine);
   }
   else if (tempLine.StartsWith("Seconds")
   {
      //break out of this loop because the 
      //next line to be read is the unstructured part
      setupInfo =  false;
   }
}

//Parse the structured part
TextFieldParser parser = new TextFieldParser(stream);
parser.TextFieldType = FieldType.FixedWidth;
parser.HasFieldsEnclosedInQuotes = false;
parser.SetFieldWidths(10, 10, 10, 10);

while (!parser.EndOfData)
{
   if (reader.Peek() == '*')
   {
       break;
   }
   else
   {
       fields = parser.ReadFields();

       if (parseStrings(fields, out dFields))
       {
           result.Rows.Add(dFields);
       }
   }
}
return result; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T23:31:07.340

它跳过的原因是正在`StreamReader`从 中读取数据块`FileStream`，而不是逐个字符地读取。例如，`StreamReader`可能会从 中读取 4 KB `FileStream`，然后根据需要解析出这些行以响应`ReadLine()`调用。因此，当您将 附加`TextFieldParser`到 时`FileStream`，它将从当前文件位置读取 - 这是它`StreamReader`离开的位置。

解决方案应该很简单：只需连接`TextFieldParser`到`StreamReader`：

```
TextFieldParser parser = new TextFieldParser(reader); 
```

请参阅[TextFieldParser（TextReader 阅读器）](http://msdn.microsoft.com/en-us/library/ms128084.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T23:07:16.430

一般来说，大多数流都在消耗——也就是说，一旦读取，它就不再可用了。您可以通过编写一个从 Stream 派生的中间类来分叉到多个流，或者引发事件、重新发布到其他流等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:28:12.063

在您的情况下，您不需要`StreamReader`. 最好的选择是使用[File.ReadLines](http://msdn.microsoft.com/en-us/library/dd383503.aspx)方法检查文件内容。它不会加载整个文件内容，只会加载行，直到您找到所需的所有内容：

```
foreach (string line in File.ReadLines(filePath))
{
    if( line.StartsWith("Date:  "))
    {
        result.Rows.Add(line);
    }
    else if (line.StartsWith("Time:  "))
    {
        result.Rows.Add(line);
    }
    else if (line.StartsWith("Seconds"))
    {
       break;
    }
} 
```

**编辑**

您可以使用 LINQ 更简单地做到这一点：

```
var d = from line in File.ReadLines(filePath) where line.Contains("Date:  ") select line;
result.Rows.Add(d); 
```

# model-view-controller - MVC - 在视图中显示文件列表

> ID：15168159
> 
> 赞同：0
> 
> 时间：2013-03-01T22:49:08.260
> 
> 标签：model-view-controller, asp.net-mvc-4

我有以下 MVC 代码：

```
@model ExchangeSite.Entities.BicycleSellerListing

    <fieldset>
    <legend>Images</legend>

        <div>
            <div class="imagelabel">
                Image #1
            </div>

            <div>
                <input type="file" name="[0].files" id="files_0" style="width:275px"/>
            </div>

            <div class="imagelabel">
                Image #2
            </div>

            <div>
                <input type="file" name="[1].files" id="files_1" style="width:275px"/>
            </div>

            <div class="imagelabel">
                Image #3
            </div>

            <div>
                <input type="file" name="[2].files" id="files_2" style="width:275px"/>
            </div>
        </div>
    </fieldset> 
```

这是我的模型/实体，或者至少是其中的一部分：

```
public class BicycleSellerListing
{
    [HiddenInput(DisplayValue=false)]
    public int BicycleSellerListingId { get; set; }

    public virtual ICollection<BicycleImage> ImageList { get; set; }
} 
```

当调用关联的控制器时，我会从我们的数据库中检索用户已经上传到系统的文件（最多三个）。我不知道如何在上面显示的 MVC 视图中显示这些文件的名称。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:55:23.583

您可以将文件列表放入您的模型中（`MyList`在下面的示例中），然后在您的视图中，您可以使用剃刀`foreach`遍历您的列表并重复 html。像这样的东西（注意你也可以从项目中提取 ID）：

```
<fieldset>
<legend>Images</legend>

    <div>
    @foreach (var item in Model.MyList) {    
        <div class="imagelabel">
                Image #1
            </div>

            <div>
                <div>@item.FileName</div>
            </div>
          }     
    </div>
</fieldset> 
```

**更新：**用 div 替换了输入元素。

# android - 如果 Activity 布局更改，则在配置更改后恢复 Fragment 状态

> ID：15168164
> 
> 赞同：2
> 
> 时间：2013-03-01T22:49:31.520
> 
> 标签：android, android-layout, android-fragments, android-configchanges

我的活动有一个纵向的单窗格布局和横向的两窗格布局，使用片段。我希望系统在方向更改后恢复所有视图，但我不知道从哪里开始。

考虑到两个方向的布局不同（但相似），这是否可能？

如果有人实现了这个（或至少尝试过），请分享你的经验。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-02T11:48:09.850

也许我知道问题出在哪里。希望我的回答可以帮助想要解决此类问题的人。如果您的 Activity 中有 Fragment，请在 AndroidManifest.xml 中配置该 Activity

```
android:configChanges="keyboardHidden|orientation|screenSize" 
```

然后，您想在`onConfigurationChanged`触发时更改 Activity 的布局。一旦 Activity 为新布局充气或使用`setContentView(R.layout.new_layout);`，该片段将消失，但是，该片段仍在运行并从视图中消失。

所以问题是fragment附加到了之前的布局，你需要做什么：

```
FragmentManager fm = getSupportFragmentManager();
FragmentTransaction transaction = fm.beginTransaction();
if (fm.findFragmentById(R.id.pane_list) == null) {
    // instantiate fragment and add to view
    mFragment = new ItemFragment();
    transaction.add(R.id.pane_list, mFragment );
} else {
    // fragment already exists, we re-attahced it
    mFragment = fm.findFragmentById(R.id.pane_list);
    transaction.detach(mFragment);
    transaction.attach(mFragment);
}
transaction.commit(); 
```

从旧布局分离并附加到新布局后，问题解决了。如果有任何错误，请纠正我:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-19T14:17:01.143

我敦促您在其**onCreate**方法中使用带有**setRetainInstance(true)的 Fragment。**这使得片段在 Activity 配置更改时保留其成员变量。请阅读此博客文章，其中解释了您需要的信息： [http ://www.androiddesignpatterns.com/2013/04/retaining-objects-across-config-changes.html](http://www.androiddesignpatterns.com/2013/04/retaining-objects-across-config-changes.html)

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T23:00:35.567

```
@Override
    public void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        outState.putInt("curChoice", mCurCheckPosition);
    } 
```

您以后可以像这样使用它：

```
@Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
    if (savedInstanceState != null) {
            // Restore last state for checked position.
            mCurCheckPosition = savedInstanceState.getInt("curChoice", 0);
        }
} 
```**

# jquery - jQuery 不会添加 CSS，只有在 HTML 已经定义的情况下才更改 CSS

> ID：15168168
> 
> 赞同：1
> 
> 时间：2013-03-01T22:49:56.710
> 
> 标签：jquery, css

长期阅读，第一次海报！=)

我在使用 jQuery 时遇到问题。我正在尝试为每个 li 添加一个样式，但是，除非 li 已经具有内联定义的特定样式，否则 jQuery 似乎什么都不做。这是一个很好的解决方法，但违背了我的代码的目标。

这是我在 codepen 上遇到的问题的示例。我分叉了另一个人的代码，试图让 jQuery 添加动画延迟，而不是在 HTML 中硬编码。我相信效果和风格只适用于 Chrome。

[http://codepen.io/LetsBeNew/pen/qIuah](http://codepen.io/LetsBeNew/pen/qIuah)

如您所见，我有前几个带有内联样式的 li 元素。jQuery 正确地更改了这些，但不会将样式添加到其他 li 元素。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:55:48.367

我在 jquery 中看不到任何会在您的示例中操纵 css 的内容...在该说明中，.css 应该可以正常工作： http: [//api.jquery.com/css/](http://api.jquery.com/css/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:30:46.527

我认为问题在于`LI`没有内联样式的 s 在`$(document).ready()`函数执行之前完成动画（或至少开始动画）。与其他 codepen 事物相比：

[http://codepen.io/anon/pen/padfb](http://codepen.io/anon/pen/padfb)

所有的`LI`s 都获得了边框宽度和增加的动画延迟到 10 秒。除了`coral`具有非常小的延迟（在这种情况下为零）的类之外。在您的情况下，每个`LI`没有内联样式值的延迟默认为零，这导致它在文档就绪函数有机会更改值之前开始动画。

在我上面链接的代码笔中，我输入了可以用来查看效果的数字。它们`play1`位于 HTML 源代码（coral LI）和`play2`CSS 源代码（LI 规则属性的最后一个）中。

# python - 一个人可以使用 Cython 编写一个库 API（一种可以在 Python 之外访问的 API）吗？

> ID：15168170
> 
> 赞同：2
> 
> 时间：2013-03-01T22:50:04.317
> 
> 标签：python, c++, c, api, cython

我知道 Cython 的目的是创建 Python 扩展模块，但是用 Cython 制作的编译库可以由非 Python 程序加载吗？如果不是，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T17:13:11.410

我怀疑您是否可以*直接*在非 python 程序上加载它们；查看由最简单的 Cython 脚本生成的 C 代码，很明显您需要所有 Python 脚手架才能使其工作。也就是说，您可以间接地做到这一点，例如从 C++ 中。在 C++ 中，我使用boost.python[嵌入](http://www.boost.org/doc/libs/1_53_0/libs/python/doc/index.html)[Python](http://www.boost.org/doc/libs/1_53_0/libs/python/doc/v2/exec.html)解释器并加载我的一些模块和脚本。这可能看起来很复杂，但允许您快速使用您已经从 C++ 用 Python 编写的任何扩展，前提是您构建了适当的粘合代码（请参阅[boost.python wiki](http://wiki.python.org/moin/boost.python/extract)）。

这种方法的缺点是你实际上是在加载一个完整的 Python 解释器，只是为了能够使用一些扩展。这对我来说不是问题，因为我已经有了 python 扩展并且正在我的应用程序中嵌入 Python 以提供基本的脚本能力，但我不会使用这种方法来编写新的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-29T18:23:04.470

您可以通过两种[机制使](http://cython.readthedocs.io/en/latest/src/userguide/external_C_code.html#using-cython-declarations-from-c) `cdef`'ed Cython 结构在外部可用：

1.  [使用`cdef public`声明](http://cython.readthedocs.io/en/latest/src/userguide/external_C_code.html#public-declarations)——和/或也
2.  [使用`api`关键字。](http://cython.readthedocs.io/en/latest/src/userguide/external_C_code.html#c-api-declarations)

这是来自上述页面的两种机制的示例之一：

```
cdef public struct Vehicle:
    int speed
    float power

cdef api void activate(Vehicle *v):
    if v.speed >= 88 and v.power >= 1.21:
        print "Time travel achieved" 
```

这些方法中的每一个都将指示 Cython 编译器生成一个头文件（“.h”），然后您可以将其与您的正交 C/C++ 项目集成。

声明产生一个`cdef public`名为`modulename.h`;的文件。使用此文件中的结构将要求您链接已编译的 Cython 扩展模块。

声明（如果您愿意，`api`可以与 同时使用）产生一个文件；使用基于 - 的标头的代码不需要链接到扩展模块 - 但它*需要*调用'd 函数，然后才能使用任何 API 代码（NumPy 的 Cython 倾向用户会[发现熟悉](https://github.com/cython/cython/blob/9286f3d46c230d2f823728eb3ad3b2a892556e83/Cython/Includes/numpy/__init__.pxd#L994-L1012)的策略）。`cdef public``modulename_api.h``api`*`cdef``import_modulename()`*

 *以我个人的经验，只要结构布局与消费代码很好地吻合，并且您愿意在手动管理 GIL您的 C/C++ 代码以使事情正常进行。*

# jquery - jQuery扩展不适用于多个实例

> ID：15168172
> 
> 赞同：1
> 
> 时间：2013-03-01T22:50:04.773
> 
> 标签：jquery, html, css, mobile

我把这个小提琴放在这里： [//jsfiddle.net/4wBK4/](http://jsfiddle.net/4wBK4/)

发生的情况是，如果您只使用一个`cardFlip`HTML 块（它是绿色的），它会按预期工作。你点击`switch`里面的元素，它就会产生效果。

但是，一旦我在页面上有两个这样的 - 就像小提琴中的情况一样，直到你删除其中一个 - 就没有任何效果了。

但我不明白。我认为我做得对，每个实例都应该触发自己的事件——但我想我误解了 CSS 动画是如何应用于元素的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:33:58.967

After doing some fiddling (pun intended), and also seeing this ([jquery plugin multiple instance not working](https://stackoverflow.com/questions/8550108/jquery-plugin-multiple-instance-not-working)) question, I realized my error:

The problem is the `.on()` event. I changed it from `$(document).on({...},'.context')` to this: `$(this).parents('.context').on({...})`

# iphone - 教程/示例：如何将数据从 ViewController 传递到另一个 XCODE

> ID：15168174
> 
> 赞同：-1
> 
> 时间：2013-03-01T22:50:13.443
> 
> 标签：iphone, xcode, ipad, uitableview, uiviewcontroller

如何将数据从 UIiewcontroller 传递到在另一个 viewcontroller 中分组的 uitableview。（反之亦然）

对此的任何示例和教程将不胜感激。我尝试过使用保留@property 从跨Viewcontrollers 设置的字符串中使用if 语句，然后将其设置为UILabel 的文本。我不工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:33:50.820

我不知道如何做反之亦然的部分，但使用它来将数据传输到另一个视图控制器：（我将假装我想将一个名为“hello”的字符串传递给第二个视图控制器）

（我现在将第一个视图控制器称为 FirstVC，我将调用第二个视图控制器为 SecondVC）

1.  在 storybord 中，单击 segue 并在实用程序部分中打开 Attributes 并查找标识符框

![属性](../Images/6a7e0bc6dd4f3051f02ad37eaea50618.png) ![转场](../Images/9a7efc324ea46053fc140d72d141c793.png)

**，然后输入“Segue”**

2.在第二个视图controller.h文件中，声明一个属性并合成它（在FirstViewController和Second中）：

```
@property (nonatomic, retain) NSString *hello; 
```

3.在 FirstViewCONtroller 中添加以下代码：

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender identifiers:(NSArray *)identifiers {
    if ([segue.identifier isEqualToString:@"Segue"]) {
         SecondViewController *secondVC = [segue destinationViewController];
         secondVC.hello = self.hello;
    }
} 
```

# java - 在服务器错误中运行 .jar 应用程序

> ID：15168183
> 
> 赞同：0
> 
> 时间：2013-03-01T22:50:34.550
> 
> 标签：java, jar

我试图在centos5上的tomcat6中部署一个应用程序，但问题是应用程序无法启动我在“usr/local/tomcat/logs/catalina.out”中有一个登录，关于启动应用程序的最后几行是

```
Mar 1, 2013 10:24:54 PM org.apache.catalina.core.NamingContextListener
addResource
WARNING: Failed to register in JMX: javax.naming.NamingException:
Could not load resource factory class [Root exception is
java.lang.ClassNotFoundException:
org.apache.tomcat.jdbc.pool.DataSourceFactory]
Mar 1, 2013 10:24:54 PM org.apache.catalina.core.StandardContext start
SEVERE: Error listenerStart
Mar 1, 2013 10:24:54 PM org.apache.catalina.core.StandardContext start
SEVERE: Context [] startup failed due to previous errors 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:56:08.950

我用谷歌搜索

```
Root exception is java.lang.ClassNotFoundException:
org.apache.tomcat.jdbc.pool.DataSourceFactory 
```

并得到了这个，这听起来很有希望：[java.lang.ClassNotFoundException: org.apache.tomcat.jdbc.pool DataSourceFactory](https://stackoverflow.com/questions/5723830/java-lang-classnotfoundexception-org-apache-tomcat-jdbc-pool-datasourcefactory)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:02:23.943

验证在您的 tomcat 安装文件夹中是否有一个包含文件 tomcat-dbcp.jar 的 lib 文件夹

在你的 context.xml 文件中，你应该有这样的东西：

```
<Context path="/YourApp"> 
 <Resource username="dbUser" url="jdbc:mysql://localhost:3306/dbName" 
     type="javax.sql.DataSource" removeAbandonedTimeout="120" removeAbandoned="true" 
     password="******" name="jdbc/dbName" 
     driverClassName="com.mysql.jdbc.Driver" autoReconnect="true" auth="Container"/> 
 </Context> 
```

# java - 如何添加到具有两个已定义泛型的列表中？

> ID：15168184
> 
> 赞同：1
> 
> 时间：2013-03-01T22:50:52.517
> 
> 标签：java, list

我在像这样定义的列表上执行 add() 时遇到问题

```
private final List<TraitGroup <? extends TRAIT_Able>> traitGroups; 
```

理想情况下，我想简单地`traitGroups.add(TYPE);`

但是尽我所能，我就是无法完全正确地使用泛型。

根据要求，Trait_Able 接口和 TraitGroup 类如下...

## TRAIT_Able

```
public interface TRAIT_Able {
String getNAME();
String toString();
} 
```

## 特质组

```
@SuppressWarnings("unchecked")
public class TraitGroup <T extends TRAIT_Able>{
private final List <AbstractTrait<T>> abstractTraits;

public TraitGroup() {
    abstractTraits = new LinkedList<AbstractTrait<T>>();
}

public AbstractTrait<T>[] toArray() {
    AbstractTrait<T>[] abstractTrait = new AbstractTrait[this.abstractTraits.size()];
    for (int i =0; i < abstractTrait.length; i ++)
        abstractTrait[i] = this.abstractTraits.get(i); 
    return abstractTrait;
}

public void add(AbstractTrait<T>... source) 
{
    boolean wasFound;
    for (AbstractTrait<T> abstractTrait : source) 
    {
        wasFound = false;
        for (AbstractTrait<T> trait : this.abstractTraits) 
        {
            if (abstractTrait.equals(trait))
            {
                wasFound = true;
                trait.add(abstractTrait);
                break;
            }
        }
        if (!wasFound)
            this.abstractTraits.add(abstractTrait);
    }
}

public String toString() {
    StringBuilder sb = new StringBuilder();
    sb.append(  "Trait group: " +
                " Size: " + this.abstractTraits.size() + "\n");

    return sb.toString();
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:07:47.443

无界通配符的问题在于它不代表`any`类型，它代表`unknown`类型。本质上，您的声明用简单的英语读作：

> 接受某些扩展 TRAIT_able 的**未知**类型的 TraitGroup 列表。

并不是

> 接受**任何**扩展 TRAIT_able 的类型的 TraitGroup 列表。

一个重要的区别。并且由于类型未知，编译器将拒绝任何添加到列表的尝试（因为您已要求进行编译时检查，但编译器无法确保您尝试添加到列表的类型实际上对其有效）。本质上，您正在尝试定义对象的异构集合，因此您不妨声明您的列表：

```
private final List<TraitGroup <TRAIT_Able>> traitGroups; 
```

# html - 内箱阴影区

> ID：15168186
> 
> 赞同：0
> 
> 时间：2013-03-01T22:51:00.773
> 
> 标签：html, css

需要帮助将我在优秀浏览器中工作的一些 css 转换为现在可用于 Internet Explorer。这就是我现在所拥有的

```
.headerLoginFooter
{   
    background-color:#f5f5f5; 
    padding:7px 10px 7px 10px; 
    margin:20px 0 0 0; 
    -moz-box-shadow:inset 0 8px 6px -6px #c4c4c4; 
    -webkit-box-shadow:inset 0 8px 6px -6px #c4c4c4; 
    box-shadow:inset 0 8px 6px -6px #c4c4c4;
} 
```

最后的三个属性在该 div 的登录框的页脚部分产生向内发光，如下所示

![在此处输入图像描述](../Images/75fc4d68d2174b76e68777f4ced5a089.png)

[我能够在CSS Tricks](http://css-tricks.com/snippets/css/css-box-shadow/)中获取此样式的代码，但我需要使其与 Internet Explorer 兼容。我的第一个问题是我只有一个 mac，所以我没有 Internet Explorer 来轻松测试我的代码。我的第二个问题是我没有像他在他的代码中那样转换上面的代码。有人可以按照链接中的指南帮助我将上述代码转换为适用于 Internet Explorer。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:02:48.573

IE对许多 CSS3 功能*非常*有问题，尤其是旧版本。

我建议在你的 CSS 样式表中使用[CSSpie](http://css3pie.com/)。[之前已在此处](https://stackoverflow.com/a/12698269/215170)回答了此问题。

有些事情可以阻止 box-shadow 在 IE 中工作：（如果它们应用于同一个元素）

*   圆角 /`border-radius`
*   `overflow:hidden`
*   `background-color`
*   背景渐变

为了克服这个问题，我通常在我想用盒子阴影设置样式的容器中嵌套一个容器。

```
<style>
.boxShadow {
 behavior: url(PIE.htc);
 -webkit-box-shadow: inset 0 8px 6px -6px #c4c4c4;  
 -moz-box-shadow: inset 0 8px 6px -6px #c4c4c4;  
 box-shadow: inset 0 8px 6px -6px #c4c4c4; 
overflow:visible;
}
.otherStyles{
background-color:#f5f5f5;
border-radius:0px;/*or other value*/
/*gradients can be placed here too.*/
}
</style>
<div class="boxShadow">
  <div class="otherStyles">
     ...content...
  </div>
</div> 
```

# rss - 通过 RSS 从帖子中仅获取一个段落

> ID：15168187
> 
> 赞同：0
> 
> 时间：2013-03-01T22:51:06.203
> 
> 标签：rss, mailchimp

我用谷歌搜索和搜索试图找到相关的东西，但没有运气。

我正在为客户设置“每日提示”活动，我必须使用 RSS 来完成。

更详细地说，我使用 MailChimp 并创建了一个 RSS 驱动的活动。在网站博客的另一边，每天都有预定的帖子。

我正在尝试找到一种方法，仅将每个帖子的第一段提供给 MailChimp 并将其包含在电子邮件中。

所以结构最终是这样的：帖子标题帖子的第一段阅读更多链接

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T04:48:56.973

我认为这不可能直接在 Mailchimp 中实现，但是如果你有特定的提要，你可以尝试**[FeedsAPI](http://www.feedsapi.org)**，如果它不是那么受欢迎的提要，即使它不是那么受欢迎的提要也是完美的，因为他们可以为这样的情况创建特定的提取模式，但它是付费的服务。

# session - 如何使用 angular.js 从浏览器将变量存储在会话中？

> ID：15168188
> 
> 赞同：0
> 
> 时间：2013-03-01T22:51:17.483
> 
> 标签：session, angularjs

我需要使用 angular.js 在浏览器上为我的会话对象添加一个键。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:54:18.733

无法从客户端更改您的会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-23T17:27:47.513

如果您的意思是更改客户端会话`window.sessionStorage`，那么只需使用对象广告键值。

否则，如果您想更改服务器端会话，则需要一些工作。我假设你使用一些 MVC 框架。首先在控制器中创建一个操作，该操作的逻辑应该将通过参数传递的键值添加到您的会话中。将动作映射到某个路径。在客户端，您应该创建使 $http.post 调用该操作路径并将值作为数据的服务。

安全提示：除非您在服务器端进行了一些安全检查，否则请不要参数化密钥名称。这样恶意用户将无法修改您会话中的敏感键值。

# c# - c# asp.net debug.writeline 写在哪里？

> ID：15168194
> 
> 赞同：2
> 
> 时间：2013-03-01T22:52:00.440
> 
> 标签：c#, visual-studio-2012

c# 和 .net 的新手，在 Visual Studio 2012 中工作。我希望能够将值显示到输出窗口以进行调试。我对监视窗口非常熟悉，但这不符合我目前的需求。

我最近的努力是从 msdn 网站上获取了确切的样本。

```
 Debug.Listeners.Add(new TextWriterTraceListener(Console.Out));
   Debug.AutoFlush = true;
   Debug.Indent();
   Debug.WriteLine("Entering Main");
   Console.WriteLine("Hello World.");
   Debug.WriteLine("Exiting Main"); 
   Debug.Unindent(); 
```

此示例可在[http://msdn.microsoft.com/en-us/library/system.diagnostics.debug%28v=vs.71%29.aspx找到](http://msdn.microsoft.com/en-us/library/system.diagnostics.debug%28v=vs.71%29.aspx)

我在上面代码之后的下一行添加了一个断点。当我到达断点时，我没有显示任何错误，并且我的输出窗口没有任何预期的内容。我确实有 using System.Diagnostics 集。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T22:59:34.947

如 MSDN 中所述，System.Diagnostics.Debug 将其消息写入所有订阅的 TraceListeners ( [http://msdn.microsoft.com/en-us/library/system.diagnostics.tracelistener.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.tracelistener.aspx) )。请注意，您应该`#define TRACE`在编译程序时添加 /d:TRACE。您可以像这样在配置文件中设置您的侦听器。

```
<configuration>
  <system.diagnostics>
    <trace autoflush="false" indentsize="4">
      <listeners>
        <add name="myListener" type="System.Diagnostics.TextWriterTraceListener" initializeData="TextWriterOutput.log" />
        <remove name="Default" />
      </listeners>
    </trace>
  </system.diagnostics>
</configuration> 
```

# jquery - Jquery - 由条形码阅读器填充的文本事件

> ID：15168195
> 
> 赞同：1
> 
> 时间：2013-03-01T22:52:05.237
> 
> 标签：jquery, textbox, barcode-scanner

我有一个重点文本框，用户将使用条形码阅读器设备来填充解密数据。如何在文本出现在 TextBox 后立即调用函数而不必先失去焦点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:01:53.463

缺少一些细节，但这里是：

根据[您的评论](https://stackoverflow.com/questions/15168195/jquery-event-on-text-filled-by-a-barcode-reader/15168293#comment21362952_15168195)，我认为设备在阅读代码并将其插入文本框中时会模拟打字。您可以使用`keyup`,`change`和来捕捉它`keydown`：

```
$('.txt').on('keyup keydown change',function(){
    //code to run
} 
```

如果上述方法不起作用，那么我真的想不出别的了。如果它只是简单地插入文本，那么它必须至少触发一个事件。

* * *

回复[您的第二条评论](https://stackoverflow.com/questions/15168195/jquery-event-on-text-filled-by-a-barcode-reader/15168293#comment21363177_15168293)：

如果使用 JavaScript 更改了值，那么您应该使用更改值的函数来运行处理更改的代码，或者将两种方法链接到同一个函数，例如：

```
function iChangeTheValue(){
    $('.txt').val('0231231212321');
    changedText();
}

$('.txt').on('keyup keydown change',function(){
    changedText();
}

function changedText(){
    //code
} 
```

关于自动填充部分：如果它使用 html 属性破坏了代码，您可以禁用它`autocomplete="off"`。否则，请阅读[本文](https://stackoverflow.com/a/11710295/1344955)。

# html - Stickyfooter 额外的空白

> ID：15168199
> 
> 赞同：1
> 
> 时间：2013-03-01T22:52:17.497
> 
> 标签：html, css

我已采用此处找到的方法向我客户的网站添加粘性页脚。

[http://www.cssstickyfooter.com/html-code.html](http://www.cssstickyfooter.com/html-code.html)

它工作得非常好，除了一个例子，我们有一个很长的内容列表要过滤，这会导致页面显着缩小并在页脚下留下很多空白。

这可以通过访问[http://johnnycupcakes.myshopify.com/?col=all](http://johnnycupcakes.myshopify.com/?col=all)并按 Gender-> Girls 过滤来实现。您会在页脚下看到大量空白，而我终其一生都无法弄清楚如何摆脱它。我试过弄乱我能找到的每个包装 div 的高度，但都不够用。

提前感谢任何提示/建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:59:06.163

![这是你的问题](../Images/54aeb717791f1784a8f1f46567629f42.png)

在 Firefox 3d 视图中看到。您的后端正在生成一堆空白图像。

# c# - 我需要帮助来检索答案陈述

> ID：15168200
> 
> 赞同：-1
> 
> 时间：2013-03-01T22:52:36.220
> 
> 标签：c#

```
namespace ThetwelveLabors1
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("Welcome to Mythology 101 class, today i will ask you about 10 of the 12 labors of Hercules.");
            Console.WriteLine("what was the first labor of Hercules?");
            Console.ReadLine();            
        }    
     }            
 } 
```

这是我当前的代码。我正在尝试插入位置以允许用户输入。一旦一个问题被正确回答，程序应该问下一个问题，依此类推10个问题，然后有一个退出条件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:56:50.987

```
Console.WriteLine("What is your favorite color?");
string answer = Console.ReadLine(); 
```

`answer`将包含用户输入的任何内容。

这会给你一个问题的答案。

所以你可以做一个大的“ `if/else`”声明或一个`switch`.

如果要关闭程序，例如：

```
Console.WriteLine("Type exit to close the program");
string answer = Console.ReadLine();

if(answer.ToLower() == "exit")
     Environment.Exit(0); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T22:58:47.193

如果我是你，首先我会实现一个包含每个问题的数组：

`String Questions[] = {"What was the first labor of Hercules"?,... }; // etc etc`

`String Answers[] = {"The right answer", "The right answer"};`

然后一个[for each 循环](http://msdn.microsoft.com/en-gb/library/ttw7t8t6%28v=vs.80%29.aspx)，循环通过每个问题。在 foreach 循环内部，一个 while 循环在答案不正确时循环。

如果用户通过 a 输入的值`Console.Readline()`等于`Answers`数组中的对应值，则用户猜对了，您可以将某个布尔值设置为 true，从而结束 while 循环，程序进入下一个问题。

当 foreach 循环结束时，程序将终止。

注意我没有给你一些有用的代码，因为你需要自己解决这个问题。如果您有任何问题，您可以随时提出另一个问题，但请尽力实现这一点:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:00:59.567

尝试这个

```
 static void Main(string[] args)
    {
        Console.WriteLine("Welcome to Mythology 101 class, today i will ask you about 10 of the 12 labors of Hercules.");
        Console.WriteLine("what was the first labor of Hercules?");
        while (Console.ReadLine() != "Killing some lion")
        {
            Console.WriteLine("nope");
        }

        Console.WriteLine("Correct!");
        Console.WriteLine();

        Console.WriteLine("What was the second labor of Herclules?");
    } 
```

# windows-server - Windows Server 2012 上的 Team Foundation Server 2010

> ID：15168202
> 
> 赞同：2
> 
> 时间：2013-03-01T22:52:39.470
> 
> 标签：windows-server, windows-server-2012

我们将从 Windows Server 2003 迁移到 Windows Server 2012。我的问题是我们是否可以在新服务器上使用 Team Foundation Server 2010，或者我们是否需要更新到 TFS 2012？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:03:07.123

看来 Sharepoint Foundation 2010 不支持 Windows Server 2012，我相信 SQL 2012 不能与 TFS 2010 一起使用，但如果你可以不使用 Sharepoint 并且可以使用 SQL 2008 R2（或之前的版本），你应该没问题.

看看：http: [//msdn.microsoft.com/en-us/library/vstudio/dd578592.aspx](http://msdn.microsoft.com/en-us/library/vstudio/dd578592.aspx)

注意它在哪里说：

由于 Team Foundation Server 使用标准配置安装 SharePoint Foundation 2010，因此无法在 Windows Server 2012 上使用它。如果要在 Windows Server 2012 上安装 Team Foundation Server，请使用高级配置并跳过安装 SharePoint Foundation 2010。

关于 SQL 2012，看看这个：http: [//blogs.msdn.com/b/bharry/archive/2013/01/11/tfs-2010-will-not-support-sql-2012.aspx](http://blogs.msdn.com/b/bharry/archive/2013/01/11/tfs-2010-will-not-support-sql-2012.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-24T15:04:40.690

我无法在 Windows Server 2012 上运行 TFS 2010，因为 TFS 似乎无法识别 IIS 6.0 兼容模式。看：

[在 Windows Server 2012 中安装 TFS 2010 时出错](https://stackoverflow.com/questions/15206380/error-installing-tfs-2010-in-windows-server-2012)

和

[Windows Server 2012 R2 上 TFS 2010 的应用程序层配置失败](https://stackoverflow.com/questions/22040827/application-tier-configuration-failed-for-tfs-2010-on-windows-server-2012-r2)

Magol 和 Adam（或其他任何人），您成功运行了吗？

# javascript - 在 Couchdb 中组合 JavaScript 对象

> ID：15168210
> 
> 赞同：4
> 
> 时间：2013-03-01T22:53:25.433
> 
> 标签：javascript, json, couchdb

我有这个**Couchdb**视图，它没有达到我的预期。它不添加`code`,`balance`和`session`to `params`：

```
function(doc) {
    var params = doc.initial_url_params; //This is an object with many properties
    params["code"] = doc.code;
    params["balance"] = doc.balance;
    params["session"] = doc.session.session_id;
    emit(doc.code, params);
} 
```

另一方面，这个其他实现可以解决问题：

```
function(doc) {
    var params = {};
    params["code"] = doc.code;
    params["balance"] = doc.balance;
    params["session"] = doc.session.session_id;
    for (prop in doc.initial_url_params) {
        params[prop] = doc.initial_url_params[prop];
    }
    emit(doc.code, params);
} 
```

谁能告诉我为什么这两个实现不等价？我是在用 Javascript 做一些愚蠢的事情，还是 Couchdb 的 Javascript 实现的一些特定限制？

为清楚起见。这是一个示例 json 文档：

```
{
   "_id": "207112eaaad136dca7b0b7b1c6356dc4",
   "_rev": "3-e02de1f2f269642df98ab19ee023569b",
   "session_loaded": true,
   "balance": 20.48,
   "code": "05428",
   "initial_url_params": {
       "page_id": "212"
   },
   "session": {
       "session_id": "207112eaaad136dca7b0b7b1c6356dc4",
       "init": true
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:20:34.040

您的 2 个样本的不同之处在于，它`initial_url_params`是一个已定义对象的属性，在传递给您的函数之前`doc`可能已被[冻结。](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/freeze)因此，您无法向其中添加新属性，但您仍然可以读取和迭代这些属性以构建新的（解冻的）对象。

[根据 OP 的链接线程](http://grokbase.com/t/couchdb/user/08cjddzrwd/adding-attributes-to-a-document-in-the-view)，这似乎是这种情况。

* * *

在 JavaScript 中，对象是通过引用传递的，因此如果要向`doc`对象添加属性，则对其进行操作的所有其他函数也将能够看到这些非标准属性并可能破坏一些映射函数。

这是上面段落的一个普通 JS 示例：

```
var doc = { foo: true };
function a(doc) { doc.bar = 1; }
function b(doc) { console.log(doc); }
a(doc);
b(doc); // outputs: { foo: true, bar: 1 } 
```

[**Demo**](http://jsfiddle.net/9HThb/) - 在上面的例子中，`b`期望只看到最初定义的属性`doc`，但是`a`已经修改了它，因为对象是通过引用传递的。这是一个过于简单的表示，但是当一个函数试图将对象的属性映射到其他逻辑时，您可以看到这可能会导致什么。

# svn - TortoiseSVN - 添加文件夹

> ID：15168212
> 
> 赞同：3
> 
> 时间：2013-03-01T22:53:42.453
> 
> 标签：svn, tortoisesvn

我想使用 TortoiseSVN 向 SVN 项目添加一个新文件夹。这是正确的方法吗？

1) 结帐 - 这会将项目下载到我的计算机上（如果我更改/删除某些内容 - 这不会影响 svn 文件吗？）

2）拖动文件夹，右键单击，添加-这会将文件夹添加到svn。

这就是全部吗？

谢谢！我不想搞砸任何事情，对不起这种问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T23:00:24.960

是的，我认为您的想法基本上是正确的。但为了清楚起见，步骤是：

1.  签出工作副本 (WC)
2.  在您的 WC 中，创建一个新文件夹（使用您的操作系统提供的任何方式；`mkdir`、“新文件夹”等）
3.  右键单击文件夹，然后从 Subversion 菜单中选择“添加”
4.  提交到存储库

# java - 创建一个简单的字符串解析器，类似于交互式 Shell

> ID：15168214
> 
> 赞同：1
> 
> 时间：2013-03-01T22:53:55.063
> 
> 标签：java

我想基于控制台制作一个简单的交互式 shell，我可以在其中编写诸如`login`,`help`等命令。

我首先想到了使用 Enums，但后来我不知道如何在没有大量 if-else 语句的情况下巧妙地实现它们，所以我决定使用数组方法并想出了这个：

```
public class Parser {
    private static String[] opts = new String[] {"opt0", "opt1", "opt2", "opt3" ... }

    public void parse(String text) {
        for(int i = 0; i < opts.length; i++) {
            if(text.matches(opts[i]) {
                switch(i) {
                    case 0:
                        // Do something

                    case 1:
                        // Do something-something

                    case 2:
                        // Do something else
                }

             return;
            }
        }
    }
} 
```

但我最终发现这可能是做这种事情的最基本的方法，如果我想改变选项的顺序会出现问题。我怎样才能制作一个更简单的解析器？这样它会起作用，但它也会说问题。该程序的使用纯粹是教育性的，不用于任何严肃的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:44:33.943

一种简单的方法是让 a`HashMap`的键等于命令文本，值是处理此命令的类的实例。假设命令处理程序类不接受参数（但您可以轻松扩展它），您可以只使用一个`Runnable`实例。

示例代码：

```
Runnable helpHandler = new Runnable() {
    public void run(){
       // handle the command
    } 
}

// Define all your command handlers

HashMap<String, Runnable> commandsMap = new HashMap<>(); // Java 7 syntax

commandsMap.put("help",helpHandler);
// Add all your command handlers instances

String cmd; // read the user input
Runnable handler;
if((handler = commandsMap.get(cmd)) != null) {
  handler.run();
} 
```

您可以通过实现自己的接口并将其子类化来轻松扩展此方法以接受参数。`variable arguments`如果您知道数据类型，则最好使用，例如`void execute(String ... args)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:09:13.843

想到的一种解决方案实际上是使用设计模式。您可以使用来自用户的输入作为[工厂类](http://en.wikipedia.org/wiki/Factory_method_pattern)的鉴别器。

这个工厂类将根据输入生成一个带有“执行”方法的对象。这称为[命令对象。](http://en.wikipedia.org/wiki/Command_pattern)

然后你可以简单地调用从工厂返回的对象的方法。

不需要 switch 语句。如果对象为空，那么您就知道用户输入了一个无效选项，并且它将决策逻辑从您的输入解析器中抽象出来。

希望这会有所帮助:)

# python - 如何在 Tkinter 中对齐 PanedWindows？

> ID：15168220
> 
> 赞同：0
> 
> 时间：2013-03-01T22:54:55.927
> 
> 标签：python, python-2.7, tkinter

我是 Tkinter 的新手，并且发现它有点难以掌握。这段代码的重点是使用等式（时间 =（速度 - 初始速度）/加速度）计算时间，但我需要用户输入变量。

这是我到目前为止所拥有的。这会很棒，除了标签不与文本小部件对齐的事实。有什么简单的方法可以做我需要的吗？

```
 def timF():
        timPanel = Toplevel()
        timPanel.wm_title("Time")

        timCont = PanedWindow(timPanel, orient=VERTICAL)
        timCont.pack(fill=BOTH, expand=1)

        # Top Paned Window and contents #
        timTopCont = PanedWindow(timCont, orient=HORIZONTAL)
        timCont.add(timTopCont)

        # Velocity label
        timFVelL = Label(timTopCont, text="Velocity")
        timTopCont.add(timFVelL)

        # Initial Velocity label
        timFiveL = Label(timTopCont, text="Initial Velocity")
        timTopCont.add(timFiveL)

        # Acceleration label
        timFaccL = Label(timTopCont, text="Acceleration")
        timTopCont.add(timFaccL)

        # Bottom Paned Window and contents #
        timBotCont = PanedWindow(timCont, orient=HORIZONTAL)
        timCont.add(timBotCont)

        # Velocity entry
        timFVelE = Entry(timBotCont)

        timBotCont.add(timFVelE)
        # Initial Velocity entry
        timFiveE = Entry(timBotCont)

        timBotCont.add(timFiveE)
        # Acceleration entry
        timFAccE = Entry(timBotCont)

        timBotCont.add(timFAccE) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T23:14:26.337

只需用于[`grid()`](http://effbot.org/tkinterbook/grid.htm)放置小部件，而不是`pack()`. 如果您知道要放置每个小部件的布局的具体行和列，这是最简单的方法：

```
timFVelL.grid(row=0, column=0)
timFVelE.grid(row=0, column=1)
timFiveL.grid(row=1, column=0)
timFiveE.grid(row=1, column=1)
# ... 
```

# ruby-on-rails - 在 html 属性中发布数据时引用破坏

> ID：15168227
> 
> 赞同：4
> 
> 时间：2013-03-01T22:55:36.627
> 
> 标签：ruby-on-rails, json, jquery, html, html-escape

我想将一些数据作为 html 属性发布。假设有一个 rails 变量

```
@fields = [{:name => "id", :type => :integer}] 
```

我想在页面中发布与 jquery 的 .data() 一起使用。所以在 .html.erb 我有

```
<%= form_tag( {:action => 'whatever'}, {... , :"data-fields" => h(@fields.to_json)}) %> 
```

但是在渲染时，字符串中的引号`[{"name":"id","type":"integer"}]`会混淆其他属性，因为 Rails form_tag 使用双引号将整个 json 字符串括在双引号中。如何发布带有字符串的 json 作为 Rails 的属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T13:23:25.337

你试过`escape_javascript`吗？虽然它有[缺点](https://stackoverflow.com/questions/2715994/rails-escape-javascript-creates-invalid-json-by-escaping-single-quotes)，但它并不完全用于转义 JSON，而且我不确定转义的引号是否适用于 HTML 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:03:26.900

您是否尝试过以下操作？

```
<%= form_tag { :action => "whatever" }, { :data => { :fields => h(@fields.to_json) } } %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:47:16.893

以下是我回避问题的方法：

在表单标签中，我做了`:"data-fields" => @fields.to_json.gsub('"',"'")`.

这会产生这种 HTML：

```
"data-fields"="[{'name':'id','type':'integer'}]" 
```

然后，在 JS 中，我像这样检索它：

```
$.parseJSON($('form').data('fields').replace(/'/g,'"')) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T13:03:35.697

经过一些试验和错误，这是可行的。

服务器端：

```
<% @fields = [{:name => "id", :type => :integer}] %>
<%= form_tag( '/posts/new', {id:'example',:data => { :fields=>@fields}}) %> 
```

生成的 HTML：

```
<form accept-charset="UTF-8" action="/posts/new" data-fields="[{&quot;name&quot;:&quot;id&quot;,&quot;type&quot;:&quot;integer&quot;}]" id="example" method="post"> 
```

带有 JQuery 数据方法的 Javascript

```
fields = $('#example').attr('data-fields') 
```

*我正在使用 rails 2.3.8 和 jquery-rails 2.2.1*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-11T17:56:46.250

[railscasts](http://railscasts.com/episodes/409-active-model-serializers)有一集使用序列化程序解决您的情况。关键是序列化程序用 $quot; 替换了双引号。serialuzer 还使您能够选择要序列化和包含关联的属性。

# memory-management - 堆栈如何工作？

> ID：15168232
> 
> 赞同：1
> 
> 时间：2013-03-01T22:56:07.063
> 
> 标签：memory-management, stack, heap-memory

我有几个关于堆栈的问题。我不了解堆栈的一件事是“弹出”和“推送”的想法。假设我有整数 a 和 b，堆栈上的 a 高于 b。据我了解，要访问 b，必须将 a 从堆栈中弹出才能访问 b。那么“a”从堆栈中弹出时存储在哪里。

此外，如果堆栈内存比堆内存更有效地访问，为什么堆内存的结构不像堆栈？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:00:20.693

我不是专家，但你可以把它想象成[河内塔之](http://en.wikipedia.org/wiki/Tower_of_Hanoi)谜。要访问较低的磁盘，您可以“弹出”它上面的磁盘并将它们放在其他地方 - 在这种情况下，在其他堆栈上，但在编程的情况下，它可能只是一个简单的变量或指针或任何东西。当你得到你需要的项目时，其他的可以放回堆栈或完全移动到其他地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:05:58.300

`a`存储在您决定存储它的任何位置。:-) 您需要提供一个变量，`a`当您删除它时将值存储在堆栈顶部（），然后删除下一项（`b`）并将其存储在不同的变量中以使用它，然后推送第一个值 ( `a`) 返回堆栈。

想象一下坐在你左边柜台上的一堆脏盘子。你拿起一个来洗它（从“脏”堆里拿出来），洗干净，擦干，然后把它放在你右边干净的堆顶上（推它）。

如果您想从任一堆栈的顶部到达第二个盘子，则必须移动最上面的一个才能到达它。所以你把它捡起来（弹出），暂时放在某个地方，拿起下一个盘子（弹出它）并把它放在某个地方，然后把你取出的第一个放回堆上（把它推回堆栈上）。

如果你不能用盘子来描绘它，请使用一副真正的扑克牌（或棒球卡，或一叠纸——任何你可以整齐堆放（“堆叠”）的东西），然后把它放在你左手的桌子上。然后执行我上一段中的步骤，将单词“plate”替换为“card”并实际执行这些步骤。

所以要访问`b`，你声明一个要存储的变量`a`，弹出`a`并将其保存在该变量中，弹出`b`到它自己的变量中，然后推`a`回堆栈。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T23:07:28.753

> 那么“a”从堆栈中弹出时存储在哪里。

这取决于。它转到正在读取堆栈的程序决定的地方。它可以存储值，忽略它，打印它，任何东西。

> 此外，如果堆栈内存比堆内存更有效地访问，为什么堆内存的结构不像堆栈？

访问堆栈并不比访问堆更有效，这取决于使用情况。程序的流程变得越来越深，就像堆栈一样。在主流语言中，局部变量、参数和返回地址存储在堆栈结构中，因为这种结构更容易实现我们所说的函数堆栈帧的语义。一个函数可以非常有效地访问它自己的堆栈帧，但不一定是它的调用函数的堆栈帧，即整个堆栈。

另一方面，如果以这种方式实现堆，它将是低效的，因为希望堆能够访问并可能删除任何地方的项目，而不仅仅是从其顶部/底部。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-01T23:11:17.803

让我们以您的案例为例。

你有一个堆栈，上面有*n 个*元素，最后一个是**a**，**b**在下面。

*pop*操作返回弹出的值，所以如果你想访问从顶部开始的第二个**b**，你可以这样做：

```
var temp = stack.pop()
var b = stack.pop()
stack.push(temp) 
```

但是，堆栈很少会以这种方式使用。它是一个 LIFO 队列，当像 LIFO 队列一样访问时效果最好。

看来您宁愿需要一个基于随机索引访问的集合。该集合可能会存储在堆上。希望它澄清了堆栈弹出/推送。

# php - 在 MySQL 中存储分层网络数据以供 PHP 使用

> ID：15168239
> 
> 赞同：2
> 
> 时间：2013-03-01T22:56:47.437
> 
> 标签：php, mysql

我正在开发一个将 IPv4 网络存储在数据库中的项目，该网络在一个列中存储为无符号整数，在另一列中存储位掩码长度 (cidr)。每个网络都由用户“拥有”（指向“用户”表的无符号整数）。子网也以分层方式排列，例如

```
1.0.0.0/16 - 归用户“A”所有
 1.0.1.0/24 - 由用户“B”拥有
 1.0.2.0/24 - 由用户“C”拥有
  1.0.2.0/26 - 由用户“D”拥有
 1.0.3.0/24 - 归用户“E”所有

```

ETC

现在棘手的一点来了，因为每个用户都应该能够查看/编辑他们下的所有子网，所以上面的用户“A”可以访问所有显示的子网，用户 C 可以访问 1.0.2.0/24 和 1.0.2.0/26 等等上。树中的级别数是可变的，并且仅受位掩码的最大长度限制，因此理论上您可以：

```
1.0.0.0/8
 1.0.0.0/9
  1.0.0.0/10
   1.0.0.0/11
......

```

一直到 1.0.0.0/32，每个连续的“所有者”都能够访问它们下的所有子网。

关于将其存储在 MySQL 中的最佳方式的任何建议？以及确定特定用户是否应该有权访问特定网络的最佳方法，使用 PHP。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:11:04.520

如果您将“所有者”IP 地址存储为位掩码（4 列？）并将 CIDR 存储在单独的列中会怎样。然后要找出谁“拥有”特定地址，您将构建一个从 ip 部分到 CIDR 长度的掩码，并执行“选择（checked_ip & stored_ip）”。

# api - 我可以通过 Foursquare API 中的“Here now”字段订购场地结果吗？

> ID：15168241
> 
> 赞同：0
> 
> 时间：2013-03-01T22:56:51.160
> 
> 标签：api, foursquare

我`m using search method of Foursquare API. I`想按“这里”字段订购场地结果 可以吗？

我正在使用这种 API 方法：

[https://api.foursquare.com/v2/venues/search](https://api.foursquare.com/v2/venues/search)

问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T01:56:26.187

没有办法让 Foursquare 预先订购返回给您，但您始终可以在获得数据后对其进行排序。

# ios - 写入应用程序文档目录中的目录错误

> ID：15168243
> 
> 赞同：0
> 
> 时间：2013-03-01T22:56:53.593
> 
> 标签：ios, nsfilemanager

我必须在这里遗漏一些明显的东西，但我似乎找不到答案。基本上，我曾经有将文件写入应用程序文档目录的代码。该代码看起来像

```
- (NSString *)applicationDocumentsDirectory {
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    return documentsDirectory;
} 
```

// 在另一个方法中实际编写代码

```
NSString *manifestPath = @"manifest.txt";
[manifestData writeToFile:manifestPath options:NSDataWritingAtomic error:&error]; 
```

所以这很好用。现在我想在文档目录中创建一个新文件夹并写入该文件夹。所以要创建我的新文件夹，我这样做：

```
NSFileManager *fileManager = [NSFileManager defaultManager];

BOOL isDir;
NSString *directoryPath = [[self applicationDocumentsDirectory] stringByAppendingPathComponent:@"testDir"];
NSError *error = nil;
if (![fileManager fileExistsAtPath:directoryPath isDirectory:&isDir]) {
    if (!isDir) {
        [fileManager createDirectoryAtPath:directoryPath withIntermediateDirectories:NO attributes:nil error:&error];
    }
} 
```

那部分工作正常。

不起作用的部分是当我想创建新的 manifestPath 以转到该目录并写入该目录时。我试过了

```
NSString *manifestPath = [[[self applicationDocumentsDirectory] stringByAppendingPathComponent:directoryPath] stringByAppendingPathComponent:@"manifest.txt"]]; 
```

或者

```
NSString *manifestPath = [[self applicationDocumentsDirectory] stringByAppendingPathComponent:[NSString stringWithFormat:@"%@/manifest.txt", directoryPath]; 
```

我是否遗漏了路径或目录的工作方式？我不断收到 Cocoa 错误 4。当我打印出路径时，我的路径看起来也正确。(iOS模拟器目录/testDir/manifest.txt)

我在这里错过了什么吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:03:30.920

看起来您一直在将文档目录路径附加到自身。在您的示例`directoryPath`中已经有文档目录路径。做吧`[directoryPath stringByAppendingPathComponent:@"manifest.txt"]`。

# java - JDOM SAXBuilder - 为特定标签假定 CDATA

> ID：15168245
> 
> 赞同：1
> 
> 时间：2013-03-01T22:56:58.330
> 
> 标签：java, xml, cdata, jdom

我正在使用 org.jdom.input.SAXBuilder 将输入流（XML 文件）解析为 JDOM 文档。

```
SAXBuilder builder = new SAXBuilder(JavaScriptParser.class.getName());
org.jdom.Document document = builder.build(stream); 
```

我的 XML 流中有特定的标签，其标签内的内容必须被视为 CDATA。

例子：

```
<text><![CDATA[ Any text... ]]></text>
<javascript><![CDATA[ function doSomething(){} ]]></javascript> 
```

目前上面的例子将被解析。我这两天一直在尝试做的是尝试扩展 org.apache.xerces.impl.XMLScanner，以便以下示例解析与上面相同。

例子：

```
<text>Any text...</text>
<javascript>function doSomething(){}</javascript> 
```

以下是我目前拥有的。`scanCDATASection()`是从父实现复制的，仅`fEntityScanner.scanData("</javascript>", fStringBuffer)`更改了行以查找我的结束标记而不是双右括号。我很难确定问题出在哪里，但我认为`EntityScanner.scanData("</javascript>")`它无法正常工作，因为我从未进入“if”语句。或者我要向`scanCDATASection()`inside 注入调用的方式`scanContent()`会导致问题。我不得不想象有一种更清洁、更直接的方法来完成这项任务。我没有定制 XML Parser 的经验，并且在我们的应用程序中每次使用 SAXParser 都使用默认设置。任何建议/提示将不胜感激。

```
public class JavaScriptScanner extends org.apache.xerces.impl.XMLNSDocumentScannerImpl
{
    private final XMLStringBuffer fStringBuffer = new XMLStringBuffer();

    public JavaScriptScanner()
    {
        super();
    }

    @Override
    protected int scanContent() throws IOException, XNIException 
    {
        if ("javascript".equals(fCurrentElement.rawname))
        {
            scanCDATASection();
            setScannerState(SCANNER_STATE_CONTENT);
        }

        return super.scanContent();
    }

    protected boolean scanCDATASection() throws IOException, XNIException 
    {
        // call handler
        if (fDocumentHandler != null) {
            fDocumentHandler.startCDATA(null);
        }

        while (true) {
            fStringBuffer.clear();
            if (!fEntityScanner.scanData("</javascript>", fStringBuffer) || 
                    fStringBuffer.toString().contains("</javascript")) {
                if (fDocumentHandler != null && fStringBuffer.length > 0) {
                    fDocumentHandler.characters(fStringBuffer, null);
                }
                int brackets = 0;
                while (fEntityScanner.skipChar(']')) {
                    brackets++;
                }
                if (fDocumentHandler != null && brackets > 0) {
                    fStringBuffer.clear();
                    if (brackets > XMLEntityManager.DEFAULT_BUFFER_SIZE) {
                        // Handle large sequences of ']'
                        int chunks = brackets / XMLEntityManager.DEFAULT_BUFFER_SIZE;
                        int remainder = brackets % XMLEntityManager.DEFAULT_BUFFER_SIZE;
                        for (int i = 0; i < XMLEntityManager.DEFAULT_BUFFER_SIZE; i++) {
                            fStringBuffer.append(']');
                        }
                        for (int i = 0; i < chunks; i++) {
                            fDocumentHandler.characters(fStringBuffer, null);
                        }
                        if (remainder != 0) {
                            fStringBuffer.length = remainder;
                            fDocumentHandler.characters(fStringBuffer, null);
                        }
                    }
                    else {
                        for (int i = 0; i < brackets; i++) {
                            fStringBuffer.append(']');
                        }
                       fDocumentHandler.characters(fStringBuffer, null);
                    }
                }
                if (fEntityScanner.skipChar('>')) {
                    break;
                }
                if (fDocumentHandler != null) {
                    fStringBuffer.clear();
                    fStringBuffer.append("]]");
                    fDocumentHandler.characters(fStringBuffer, null);
                }
            }
            else {
                if (fDocumentHandler != null) {
                    fDocumentHandler.characters(fStringBuffer, null);
                }
                int c = fEntityScanner.peekChar();
                if (c != -1 && isInvalidLiteral(c)) {
                    if (XMLChar.isHighSurrogate(c)) {
                        fStringBuffer.clear();
                        scanSurrogates(fStringBuffer);
                        if (fDocumentHandler != null) {
                            fDocumentHandler.characters(fStringBuffer, null);
                        }
                    }
                    else {
                        reportFatalError("InvalidCharInCDSect",
                                        new Object[]{Integer.toString(c,16)});
                        fEntityScanner.scanChar();
                    }
                }
            }
        }
        fMarkupDepth--;

        // call handler
        if (fDocumentHandler != null) {
            fDocumentHandler.endCDATA(null);
        }

        return true;
    }
} 
```

# wpf - 在 WPF 中使用 TreeView

> ID：15168246
> 
> 赞同：0
> 
> 时间：2013-03-01T22:57:02.017
> 
> 标签：wpf, treeview

我试图在 WPF 中显示一个简单的树结构，它正在工作，但它在树的顶层显示所有级别的节点。我在结构中总共有 9 个节点，但只有一个应该显示在根级别。在那下面应该是两个节点，在那些节点下面，等等。在每个节点下，它确实显示了正确的子节点，但此外它还在顶部显示了所有节点。这是我的对象（如果重要，这些是 EF db 对象）：

```
 public class ProductGroup
{
    public int ProductGroupId { get; set; }
    public ProductGroup Parent { get; set; }
    public string Description { get; set; }

    private ProductGroup() //not used, but needed to prevent EF error
    {
        Description = string.Empty;
    }
    public ProductGroup(string description)
    {
        Description = description;
    }
    public virtual ICollection<ProductGroup> Children { get; set; }

    public void Add(ProductGroup newItem)
    {
        newItem.Parent = this;
        if (Children == null)
            Children = new Collection<ProductGroup>();
        Children.Add(newItem);
    }
    public int Count
    {
        get { return Children.Count; }
    }
} 
```

这是xaml：

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:ConfiguratorDB="clr-namespace:ConfiguratorDB;assembly=ConfiguratorDB" mc:Ignorable="d" x:Class="ConfiguratorDBTest.Window2"
    xmlns:local="clr-namespace:ConfiguratorDB;assembly=ConfiguratorDB"
Title="Window2" Height="417" Width="712" Loaded="Window_Loaded_1">
<Window.Resources>
    <CollectionViewSource x:Key="productGroupViewSource" d:DesignSource="{d:DesignInstance {x:Type ConfiguratorDB:ProductGroup}, CreateList=True}"/>
</Window.Resources>
<Grid DataContext="{StaticResource productGroupViewSource}">
    <DataGrid x:Name="productGroupDataGrid" AutoGenerateColumns="False" EnableRowVirtualization="True" ItemsSource="{Binding}" Margin="23,36,346,151" RowDetailsVisibilityMode="VisibleWhenSelected">
        <DataGrid.Columns>
            <DataGridTextColumn x:Name="descriptionColumn" Binding="{Binding Description}" Header="Description" Width="SizeToHeader"/>
            <DataGridTextColumn x:Name="productGroupIdColumn" Binding="{Binding ProductGroupId}" Header="Product Group Id" Width="SizeToHeader"/>
        </DataGrid.Columns>
    </DataGrid>
    <TreeView x:Name="productGroupTreeView" ItemsSource="{Binding}" Margin="396,38,73,111">
        <TreeView.Resources>
            <HierarchicalDataTemplate DataType="{x:Type local:ProductGroup}" ItemsSource="{Binding Children}">
                <TextBlock Text="{Binding Path=Description}" />
            </HierarchicalDataTemplate>
        </TreeView.Resources>
    </TreeView>
</Grid> 
```

这是输出的样子。不应显示任何重复项： ![输出图片](../Images/a12ce460e6e9f5724b872b3aa88c6a23.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:53:50.273

通过根据节点是否为根节点过滤 CollectionViewSource，我能够正确显示树视图。基本上，您只希望返回根。子级将由分层数据模板处理。以下是我添加到窗口代码隐藏中的代码行：

```
productGroupViewSource.Filter += productGroupViewSource_Filter;

void productGroupViewSource_Filter(object sender, FilterEventArgs e)
{
    var node = (ProductGroup) e.Item;
    e.Accepted = node.Parent == null;
} 
```

# python - 如何区分组引用和后面的数字？

> ID：15168249
> 
> 赞同：4
> 
> 时间：2013-03-01T22:57:18.037
> 
> 标签：python, regex

我正在尝试替换字符串中特定数字的所有出现。例如，假设我想用另一个替换给定数字的特定实例：

```
>>> number1 = 33
>>> number2 = 1
>>> re.sub('(foo)%i' % number1, '\\1%i' % number2, 'foo33')
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
  File "/home/david_clymer/Development/VistaShare/ot_git/lib/python2.4/sre.py", line 142, in sub
    return _compile(pattern, 0).sub(repl, string, count)
  File "/home/david_clymer/Development/VistaShare/ot_git/lib/python2.4/sre.py", line 260, in filter
    return sre_parse.expand_template(template, match)
  File "/home/david_clymer/Development/VistaShare/ot_git/lib/python2.4/sre_parse.py", line 784, in expand_template
    raise error, "invalid group reference"
sre_constants.error: invalid group reference
>>> re.sub('(foo)%i' % number1, '\\1 %i' % number2, 'foo33')
'foo 1' 
```

如何防止组参考与以下数字混为一谈？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T23:08:48.223

```
import re

number1 = 33
number2 = 1
print re.sub('(foo)%i' % number1, '\g<1>%i' % number2, 'foo33') 
```

> `re.sub(pattern, repl, string, count=0, flags=0)`
> 
> 除了如上所述的字符转义和反向引用之外，`\g<name>`将使用由名为 name 的组匹配的子字符串，如`(?P<name>...)`语法所定义。`\g<number>`使用对应的组号；`\g<2>`因此等价于`\2`，但在诸如`\g<2>0`. `\20`将被解释为对第 20 组的引用，而不是对后跟文字字符“0”的第 2 组的引用。反向引用`\g<0>` 替换了 RE 匹配的整个子字符串。
> 
> [http://docs.python.org/2/library/re.html#module-re](http://docs.python.org/2/library/re.html#module-re)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:04:09.503

可以使用以下方法引用显然命名的组`\g<name>`：

```
>>> re.sub('(?P<prefix>foo)%i' % number1, '\\g<prefix>%i' % number2, 'foo33')
'foo1' 
```

python 文档`re.sub()`实际上解释了这一点。去图：[http ://docs.python.org/2/library/re.html](http://docs.python.org/2/library/re.html)

# c# - 如何检查List是否 .Sort 实际上对某些东西进行了排序？

> ID：15168252
> 
> 赞同：4
> 
> 时间：2013-03-01T22:57:43.697
> 
> 标签：c#, .net, sorting

考虑以下代码：

```
class Employee : IComparable<Employee>
{
    public string Name { get; set; }

    public int CompareTo(Employee other)
    {
        return string.Compare(this.Name, other.Name);
    }
}

void DoStuff()
{
    var e1 = new Employee() { Name = "Frank" };
    var e2 = new Employee() { Name = "Rizzo" };

    var lst = new List<Employee>() { e1, e2 };
    lst.Sort();
} 
```

我怎么知道 Sort 方法是否真的重新排列了任何东西？额外的问题：如果重新排列，有多少东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T23:04:31.307

取自[http://msdn.microsoft.com/en-us/library/bb348567.aspx](http://msdn.microsoft.com/en-us/library/bb348567.aspx)不过，您必须先复制一份列表，然后再对其进行排序以进行比较。

```
List<Pet> pets1 = new List<Pet> { pet1, pet2 };
List<Pet> pets2 = new List<Pet> { pet1, pet2 };

bool equal = pets1.SequenceEqual(pets2); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T23:11:29.547

既然你已经实现了自己的比较器，为什么不跟踪它被调用的次数呢？

```
// naive, not thread safe, not exactly going to tell you much
static int compared = 0;
public int CompareTo(Employee other)
{
    compared++;
    return string.Compare(this.Name, other.Name);
} 
```

作为另一种方法，为什么不切换到排序输入而不是每次都对整个列表进行排序呢？

```
public void AddEmployee(Employee item)
{
    // keep in mind this may not always be faster than List<T>.Sort
    // but it should be.
    if (employees.Count > 1)
    {
        var index = employees.BinarySearch(item);
        if (index < 0)
        {
            employees.Insert(~index, item);
        }
    }
    else employees.Add(item);
} 
```

或者，使用排序集合，如[`SortedList<K,T>`](http://msdn.microsoft.com/en-us/library/ms132319.aspx).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-01T23:08:47.873

这听起来可能不是最好的解决方案，但为什么不记录结果`string.Compare`

```
public int CompareTo(Employee other)
{
    int result = string.Compare(this.Name, other.Name);

    Debug.WriteLine("Result of Compare of {0} and {1} is {2}", 
        this.Name, other.Name, result);

    return result;
} 
```

# php - mysqli_stmt_fetch()。条目存在，但没有打印任何内容

> ID：15168253
> 
> 赞同：0
> 
> 时间：2013-03-01T22:57:49.320
> 
> 标签：php

我在做一些可笑的愚蠢的事情吗？一切正常，直到你好（2）

而 (mysqli_stmt_fetch($selectCust)) 不会执行。我一步一步地经历了一切，条目出现在数据库中。如果条目是原始的，则 if 语句将正确执行。

我最初在 mysql 中完成了整个表单，并且效果很好。我只是无法让 fetch 与准备好的语句一起工作，所以我确定这不是逻辑错误。

```
Creating prepared statements and binding params
$insertCust = mysqli_prepare($mysqli, 
"INSERT INTO `mp434`.`CUSTOMERS` (
`CUST_ID`,
`NAME` ,
`EMAIL` ,
`PASSWORD` ,
`ADDRESS`
)
VALUES (
?, ?, ?, ?, ?
)");

mysqli_stmt_bind_param($insertCust, 'sssss', $null, $name, $email, $password, $address);

$selectCust = mysqli_prepare($mysqli, 
"SELECT *
FROM `CUSTOMERS`
WHERE `NAME` LIKE ?
AND `EMAIL` LIKE ?
AND `PASSWORD` LIKE ?
AND `ADDRESS` LIKE ?");

mysqli_stmt_bind_param($selectCust, 'ssss', $name, $email, $password, $address);

//Find num Rows to see if cust is preexisting
mysqli_stmt_execute($selectCust);
mysqli_stmt_store_result($selectCust);
$numRows = mysqli_stmt_num_rows($selectCust);
mysqli_stmt_close($selectCust);

//if preExisting gives Cust ID
//if not fetches custId 

if ($numRows == 0)
{
mysqli_stmt_execute($insertCust);
mysqli_stmt_store_result($insertCust);
$custID = mysqli_stmt_insert_id($insertCust);
mysqli_stmt_close($insertCust);
}
else
{
print "hello1";
mysqli_stmt_execute($selectCust);
mysqli_stmt_bind_result($selectCust, $a,$b,$c,$d,$e);
print "hello You2";
while (mysqli_stmt_fetch($selectCust))
    {
        print "hello You3";
        print "results are: $custID $b $c $d $e <br>";
    }

mysqli_stmt_close($selectCust);
}
echo $custID;
echo $numRows; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:23:19.420

检查返回值`mysqli_stmt_execute`以查看执行查询是否出错。

但是我认为问题在于您已经运行了此查询并且从那时起在再次运行之前没有绑定参数。

# ruby-on-rails - Capistrano ssh 用户无法写入文件

> ID：15168256
> 
> 赞同：0
> 
> 时间：2013-03-01T22:58:02.760
> 
> 标签：ruby-on-rails, ruby, deployment, capistrano, vps

我正在尝试让 capistrano 将我的 rails 应用程序部署到 vps。

我登录到 vps，添加了一个新的“部署者”用户，并通过以下方式给了他 sudo 权限：

```
adduser deployer 
```

并在 visudo

```
deployer    ALL=(ALL:ALL) ALL 
```

我安装了 rvm、ruby、postgres、postfix 和 nginx。全部使用 apt-get，最新版本的 ruby​​ 和 rvm。在我的 gem 文件中，我正在使用：

```
gem 'unicorn'

# Deploy with Capistrano
gem 'capistrano'
gem 'rvm-capistrano', '>= 1.3.0.rc11' 
```

根据 capistrano github 自述文件，尝试运行 cap deploy:setup 时，我遇到了一堆 rvm 错误，但通过在我的 deploy.rb 文件中使用以下内容在 cap deploy:setup 上重新安装 rvm 来修复它们：

```
set :rvm_ruby_string, 'ruby-1.9.3-p392' # use the same ruby as used locally for deployment
set :rvm_install_ruby_params, '--1.9'      # for jruby/rbx default to 1.9 mode
set :rvm_install_pkgs, %w[libyaml openssl] # package list from https://rvm.io/packages
set :rvm_install_ruby_params, '--with-opt-dir=/usr/local/rvm/usr' # package support

before 'deploy:setup', 'rvm:install_rvm'   # install RVM
before 'deploy:setup', 'rvm:install_pkgs'  # install RVM packages before Ruby
before 'deploy:setup', 'rvm:install_ruby'  # install Ruby and create gemset, or:
before 'deploy:setup', 'rvm:create_gemset' # only create gemset
before 'deploy:setup', 'rvm:import_gemset' # import gemset from file 
```

当我运行 cap deploy:cold 时，它运行良好，直到它给出错误的结尾：

```
failed: "rvm_path=$HOME/.rvm/ $HOME/.rvm/bin/rvm-shell 'ruby-1.9.3-p392' -c 'cd /home/deployer/apps/blog/releases/20130301223924 && bundle install --gemfile /home/deployer/apps/blog/releases/20130301223924/Gemfile --path /home/deployer/apps/blog/shared/bundle --deployment --quiet --without development test'" on 198.211.127.46 
```

因此，我使用以下命令将我的“部署者”用户添加到“rvm”组中：

```
sudo usermod -G rvm deployer 
```

运行 cap deploy:cold 后，得到错误：

```
 ** [out :: 198.211.127.46] cannot create directory `/home/deployer/apps/blog/releases/20130301223718'
 ** [out :: 198.211.127.46] : Permission denied 
```

任何见解将不胜感激。我快到了。

这是我的 deploy.rb 文件：

```
require "bundler/capistrano"
require "rvm/capistrano"

server "198.211.127.46", :web, :app, :db, primary: true

set :port, 46000
set :application, "blog"
set :user, "deployer"
set :deploy_to, "/home/#{user}/apps/#{application}"
set :deploy_via, :remote_cache
set :use_sudo, true
set :keep_releases, 5

set :scm, "git"
set :repository, "git@bitbucket.org:myusername/#{application}.git"
set :branch, "master"

default_run_options[:pty] = true
ssh_options[:forward_agent] = true

######
set :rvm_ruby_string, 'ruby-1.9.3-p392' # use the same ruby as used locally for deployment
set :rvm_install_ruby_params, '--1.9'      # for jruby/rbx default to 1.9 mode
set :rvm_install_pkgs, %w[libyaml openssl] # package list from https://rvm.io/packages
set :rvm_install_ruby_params, '--with-opt-dir=/usr/local/rvm/usr' # package support

before 'deploy:setup', 'rvm:install_rvm'   # install RVM
before 'deploy:setup', 'rvm:install_pkgs'  # install RVM packages before Ruby
before 'deploy:setup', 'rvm:install_ruby'  # install Ruby and create gemset, or:
before 'deploy:setup', 'rvm:create_gemset' # only create gemset
before 'deploy:setup', 'rvm:import_gemset' # import gemset from file
########

after "deploy", "deploy:cleanup" # keep only the last 5 releases

namespace :deploy do
  %w[start stop restart].each do |command|
    desc "#{command} unicorn server"
    task command, roles: :app, except: {no_release: true} do
      run "/etc/init.d/unicorn_#{application} #{command}"
    end
  end

  task :setup_config, roles: :app do
    sudo "ln -nfs #{current_path}/config/nginx.conf /etc/nginx/sites-enabled/#{application}"
    sudo "ln -nfs #{current_path}/config/unicorn_init.sh /etc/init.d/unicorn_#{application}"
    sudo "mkdir -p #{shared_path}/config"
    sudo "chown deployer:deployer #{shared_path}/config" # added this to get around sftp permisssions
    put File.read("config/database.example.yml"), "#{shared_path}/config/database.yml"
    puts "Now edit the config files in #{shared_path}."
  end
  after "deploy:setup", "deploy:setup_config"

  # sudo "chmod +x #{release_path}/config/unicorn_init.sh"
  task :symlink_config, roles: :app do
    run "ln -nfs #{shared_path}/config/database.yml #{release_path}/config/database.yml"
    # run "chmod +x #{release_path}/config/unicorn_init.sh"
  end
  after "deploy:finalize_update", "deploy:symlink_config"

  desc "Make sure local git is in sync with remote."
  task :check_revision, roles: :web do
    unless `git rev-parse HEAD` == `git rev-parse origin/master`
      puts "WARNING: HEAD is not the same as origin/master"
      puts "Run `git push` to sync changes."
      exit
    end
  end
  before "deploy", "deploy:check_revision"
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-20T13:59:18.107

尝试

```
chown -R deployer /home/deployer 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T16:20:50.350

确保*所有*文件夹都归部署者所有。:)

# python - Python XML 删除一些元素及其子元素，但保留特定元素及其子元素

> ID：15168259
> 
> 赞同：2
> 
> 时间：2013-03-01T22:58:08.850
> 
> 标签：python, lxml

我有一个非常大的 .xml 文件，我正在尝试制作一个新的 .xml 文件，它只包含这个较大文件内容的一小部分。我想指定一个属性（在我的例子中，一个 itemID）并给它一些特定的值，然后它会删除所有元素，除了那些具有这些 itemID 及其子元素的元素。

我的大 .xml 文件看起来像这样：

```
<?xml version='1.0' encoding='UTF-8'?>
<api version="2">
  <currentTime>2013-02-27 17:00:18</currentTime>
  <result>
    <rowset name="assets" key="itemID" columns="itemID,locationID,typeID,quantity,flag,singleton">
      <row itemID="1008551770576" locationID="31000559" typeID="17187" quantity="1" flag="0" singleton="1" rawQuantity="-1" />
      <row itemID="1008700753886" locationID="31000559" typeID="17187" quantity="1" flag="0" singleton="1" rawQuantity="-1" />
      <row itemID="1008700756994" locationID="31000559" typeID="17184" quantity="1" flag="0" singleton="1" rawQuantity="-1" />
      <row itemID="1008701224901" locationID="31000559" typeID="17186" quantity="1" flag="0" singleton="1" rawQuantity="-1" />
      <row itemID="1004072840841" locationID="31002238" typeID="17621" quantity="1" flag="0" singleton="1" rawQuantity="-1">
        <rowset name="contents" key="itemID" columns="itemID,typeID,quantity,flag,singleton">
          <row itemID="150571923" typeID="25863" quantity="2" flag="119" singleton="0" />
          <row itemID="188435728" typeID="3388" quantity="1" flag="119" singleton="0" />
          <row itemID="210122947" typeID="3419" quantity="4" flag="119" singleton="0" />
        </rowset>
      </row>
      <row itemID="1005279202146" locationID="31002238" typeID="17621" quantity="1" flag="0" singleton="1" rawQuantity="-1">
        <rowset name="contents" key="itemID" columns="itemID,typeID,quantity,flag,singleton">
          <row itemID="1004239962001" typeID="16275" quantity="49596" flag="4" singleton="0" />
          <row itemID="1005364142068" typeID="4246" quantity="156929" flag="4" singleton="0" />
          <row itemID="1005624252854" typeID="4247" quantity="93313" flag="4" singleton="0" />
        </rowset>
      </row>
      <row itemID="1004388226389" typeID="648" quantity="1" flag="0" singleton="1" rawQuantity="-1">
        <rowset name="contents" key="itemID" columns="itemID,typeID,quantity,flag,singleton">
          <row itemID="1004388228218" typeID="31119" quantity="1" flag="92" singleton="1" rawQuantity="-1" />
          <row itemID="1004388701243" typeID="31119" quantity="1" flag="94" singleton="1" rawQuantity="-1" />
          <row itemID="1004388701485" typeID="31119" quantity="1" flag="93" singleton="1" rawQuantity="-1" />
          <row itemID="1009147502645" typeID="51" quantity="1" flag="5" singleton="1" rawQuantity="-1" />
        </rowset>
      </row>
    </rowset>
  </result>
  <cachedUntil>2013-02-27 23:00:18</cachedUntil>
</api> 
```

这个文件有大约九万行，大约 9 兆字节。

请注意如何存在 itemID，并且某些项目类型可以（但并不总是）在其中包含更多项目，并且这些子项也有自己的 itemID。我正在尝试获取一些特定的 itemID 及其子项，而忽略所有其他项。

我使用了[这个答案](https://stackoverflow.com/questions/3593204/how-to-remove-elements-from-xml-using-python/3593300#3593300)中的代码，它让我非常接近。它是完美的，只是它忽略了我使用的 itemID 的子项。

我的代码如下所示：

```
import lxml.etree as le

##Take this big .xml file and pull out just the parts we want then write those to a new .xml file##
with open(filename,'r') as f:
    doc=le.parse(f)
    for elem in doc.xpath('//*[attribute::itemID]'):
        if elem.attrib['itemID']=='1004072840841':
            elem.attrib.pop('itemID')
        else:
            parent=elem.getparent()
            parent.remove(elem)
    print(le.tostring(doc)) 
```

这是生成的打印输出的样子：

```
<api version="2">
  <currentTime>2013-03-01 21:46:52</currentTime>
  <result>
    <rowset name="assets" key="itemID" columns="itemID,locationID,typeID,quantity,flag,singleton">
      <row locationID="31002238" typeID="17621" quantity="1" flag="0" singleton="1" rawQuantity="-1">
        <rowset name="contents" key="itemID" columns="itemID,typeID,quantity,flag,singleton">
          </rowset>
      </row>
      </rowset>
  </result>
  <cachedUntil>2013-03-02 03:46:53</cachedUntil>
</api> 
```

我希望它看起来像这样：

```
<api version="2">
  <currentTime>2013-03-01 21:46:52</currentTime>
  <result>
    <rowset name="assets" key="itemID" columns="itemID,locationID,typeID,quantity,flag,singleton">
      <row locationID="31002238" typeID="17621" quantity="1" flag="0" singleton="1" rawQuantity="-1">
        <rowset name="contents" key="itemID" columns="itemID,typeID,quantity,flag,singleton">
          <row itemID="150571923" typeID="25863" quantity="2" flag="119" singleton="0" />
          <row itemID="188435728" typeID="3388" quantity="1" flag="119" singleton="0" />
          <row itemID="210122947" typeID="3419" quantity="4" flag="119" singleton="0" />
        </rowset>
      </row>
      </rowset>
  </result>
  <cachedUntil>2013-03-02 03:46:53</cachedUntil>
</api> 
```

我对代码的理解不够好，无法查看需要更改的内容才能包含我要搜索的 itemID 的子项。此外，理想情况下，我可以放入多个 itemID，它会删除除那些 itemID 及其子项之外的所有内容。这意味着它需要保留`itemID=[number]`row 属性（这样当我使用这个 xml 文件时，我可以使用 xPath 来引用特定的 itemID 及其子项。）

所以我的主要问题是如何在生成的 .xml 中包含我搜索的 itemID 的子项。我的第二个问题是关于如何同时为多个 itemID 执行此操作（以便生成的 .xml 文件将删除除那些 itemID 及其子项之外的所有内容。）

# 更新：丑陋的解决方案

我发现这`elem.attrib.pop('itemID')`部分是取出 itemID 的部分，因为我想拥有多个 itemID 并且他们的孩子仍然存在，所以我需要保留这个，所以我把那个部分拿出来了。我试图找到一种方法来跳过带有我正在搜索的 itemID 的行的子代，我想出的是用一个属性标记每个子代，然后我可以重新搜索并删除所有没有的有那个属性。我不需要 flag 属性来做我正在做的事情，所以我继续使用它来达到这个目的（因为当我尝试迭代它们时，尝试引入新属性时遇到了一个关键错误。）只是标记孩子们还不够，我还得给孩子们的孩子贴上标签。

这是我丑陋的解决方案：

```
with open(filename,'r') as f:
    doc=le.parse(f)
    for elem in doc.xpath('//*[attribute::itemID]'):
        if elem.attrib['itemID']=='1004072840841' or elem.attrib['itemID']=='1005279202146': # this or statement lets me get a resulting .xml file that has two itemIDs and their children
            elem.attrib['flag']='Keep'
            for child in elem.iterchildren():
                child.attrib['flag']='Keep'
                for c in child.iterchildren():
                    c.attrib['flag']='Keep'
        else:
            pass
    for e in doc.xpath('//*[attribute::flag]'):
        if e.attrib['flag']!='Keep':
            parent=e.getparent()
            parent.remove(e)
        else:
            pass
    print(le.tostring(doc))
    ##This part writes the pruned down .xml to a file##
    with open('test.xml', 'w') as t:
        for line in le.tostring(doc):
            t.write(line)
    t.close 
```

这个丑陋的解决方案涉及对数据的大量迭代，我怀疑它远不是完成这项工作的最有效方法，但它确实有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T10:49:19.703

目前还不是很清楚你在追求什么，但这段代码会产生你说你想要的输出：

```
from lxml import etree as ET

def filter_by_itemid(doc, idlist):
    rowset = doc.xpath("/api/result/rowset[@name='assets']")[0]
    for elem in rowset.getchildren():
        if int(elem.get("itemID")) not in idlist:
            rowset.remove(elem)
    return doc

doc = ET.parse("test.xml")
filter_by_itemid(doc, [1004072840841])

print(ET.tostring(doc)) 
```

# objective-c - 只需要纵向模式下的标签栏和横向模式下的所有视图控制器

> ID：15168260
> 
> 赞同：0
> 
> 时间：2013-03-01T22:58:16.083
> 
> 标签：objective-c, ios6, uitabbarcontroller

我正在开发一个横向模式的 iOS 应用程序，除了我需要标签栏位于右侧（垂直）。我想知道我是否可以在横向模式下显示所有 viewControllers（导航驱动的应用程序），而在纵向模式下只显示 tabbarController？

换句话说，我可以将所有 viewController 的方向设置为横向模式，并将仅 TabBarController 的方向设置为横向模式，以便我可以有效地使其显示在右侧吗？

非常感谢任何指针。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:06:54.123

这可能不是您要寻找的答案，但我强烈建议您打开 UITabBarController 和 UITabBar 标题以了解如何实现标签栏，并开始创建/子类化您自己的，而不是一起破解现有组件。您至少需要一个视图控制器、一个用于保留由选项卡表示的视图控制器的数组、一个用于显示活动视图控制器视图的视图以及一个指向活动视图控制器的指针。

编写自己的视图控制器的学习曲线要​​高得多，但相信我，这是值得的。

# forms - Chrome 如何检测信用卡字段？

> ID：15168261
> 
> 赞同：25
> 
> 时间：2013-03-01T22:58:18.500
> 
> 标签：forms, google-chrome, stripe-payments

在某些表单中，Chrome 自动填充会提示信用卡自动填充。

编辑：添加屏幕截图。这与浏览器自动完成不同。您之前不必以相同的形式输入值。

![截屏](../Images/1b8e50bc755ea234f08e122998fd1aa5.png)

我应该如何编写我的 HTML 表单，以便浏览器将它们检测为信用卡字段并触发此行为？

一个使用 Stripe 表单的例子是理想的。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2017-01-31T18:48:44.103

这个问题已经很老了，但我有一个**2019 年的更新答案**！

**您现在只需正确命名即可告诉浏览器哪些字段用于信用卡信息`<input>`。**

***以下答案来自我在这里的原始答案：[https ://stackoverflow.com/a/41965106/1696153](https://stackoverflow.com/a/41965106/1696153)***

[这是官方***当前 WHATWG HTML 标准***的链接，用于启用自动完成功能。](https://html.spec.whatwg.org/multipage/forms.html#attr-fe-autocomplete)

Google为开发对移动设备友好的 Web 应用程序编写了一个[非常好的指南。](https://developers.google.com/web/fundamentals/design-and-ui/input/forms/#recommended_input_name_and_autocomplete_attribute_values)他们有一节介绍如何命名表单上的输入以轻松使用自动填充。尽管它是为移动设备编写的，但这适用于桌面和移动设备！

# 如何在 HTML 表单上启用自动完成

以下是有关如何启用自动完成功能的一些要点：

*   **将 a`<label>`用于所有`<input>`字段**
*   **`autocomplete`**为您的标签**添加一个****属性**`<input>`并使用本[指南](https://developers.google.com/web/fundamentals/design-and-ui/input/forms/#recommended_input_name_and_autocomplete_attribute_values)进行填写。
*   **为所有标签正确命名您的`name`和`autocomplete`属性`<input>`**
*   ***示例***：

    ```
    <label for="frmNameA">Name</label>
    <input type="text" name="name" id="frmNameA"
    placeholder="Full name" required autocomplete="name">

    <label for="frmEmailA">Email</label>
    <input type="email" name="email" id="frmEmailA"
    placeholder="name@example.com" required autocomplete="email">

    <!-- note that "emailC" will not be autocompleted -->
    <label for="frmEmailC">Confirm Email</label>
    <input type="email" name="emailC" id="frmEmailC"
    placeholder="name@example.com" required autocomplete="email">

    <label for="frmPhoneNumA">Phone</label>
    <input type="tel" name="phone" id="frmPhoneNumA"
    placeholder="+1-555-555-1212" required autocomplete="tel"> 
    ```

# 如何命名您的`<input>`标签

为了触发自动完成，请确保正确命名标签中的`name`和`autocomplete`属性。`<input>`这将自动允许在表单上自动完成。确保也有一个`<label>`！也可以在[此处](https://developers.google.com/web/fundamentals/design-and-ui/input/forms/#recommended_input_name_and_autocomplete_attribute_values)找到此信息。

以下是如何命名您的输入：

*   *姓名*
    *   将这些中的任何一个用于**`name`**：`name fname mname lname`
    *   将这些中的任何一个用于**`autocomplete`**：
        *   `name`（全名）
        *   `given-name`（对于名字）
        *   `additional-name`（中间名）
        *   `family-name`（对于姓氏）
    *   例子：`<input type="text" name="fname" autocomplete="given-name">`
*   *电子邮件*
    *   将这些中的任何一个用于**`name`**：`email`
    *   将这些中的任何一个用于**`autocomplete`**：`email`
    *   例子：`<input type="text" name="email" autocomplete="email">`
*   *地址*
    *   将这些中的任何一个用于**`name`**：`address city region province state zip zip2 postal country`
    *   将这些中的任何一个用于**`autocomplete`**：
        *   对于一个地址输入：
            *   `street-address`
        *   对于两个地址输入：
            *   `address-line1`
            *   `address-line2`
        *   `address-level1`（州或省）
        *   `address-level2`（城市）
        *   `postal-code`（邮政编码）
        *   `country`
*   *电话*
    *   将这些中的任何一个用于**`name`**：`phone mobile country-code area-code exchange suffix ext`
    *   将这些中的任何一个用于**`autocomplete`**：`tel`
*   *信用卡*
    *   将这些中的任何一个用于**`name`**：`ccname cardnumber cvc ccmonth ccyear exp-date card-type`
    *   将这些中的任何一个用于**`autocomplete`**：
        *   `cc-name`
        *   `cc-number`
        *   `cc-csc`
        *   `cc-exp-month`
        *   `cc-exp-year`
        *   `cc-exp`
        *   `cc-type`
*   *用户名*
    *   将这些中的任何一个用于**`name`**：`username`
    *   将这些中的任何一个用于**`autocomplete`**：`username`
*   *密码*
    *   将这些中的任何一个用于**`name`**：`password`
    *   将这些中的任何一个用于**`autocomplete`**：
        *   `current-password`（用于登录表格）
        *   `new-password`（用于注册和密码更改表格）

# 资源

*   [当前用于自动完成的 WHATWG HTML 标准。](https://html.spec.whatwg.org/multipage/forms.html#attr-fe-autocomplete)
*   [来自 Google 的“创建惊人的表单”](https://developers.google.com/web/fundamentals/design-and-ui/input/forms/#recommended_input_name_and_autocomplete_attribute_values)。好像几乎天天更新。优秀的阅读。
*   2015 年[来自 Google 的“使用自动填充功能帮助用户更快结帐” 。](https://developers.google.com/web/updates/2015/06/checkout-faster-with-autofill)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-03T01:24:07.383

从这个答案[https://stackoverflow.com/a/9795126/292060](https://stackoverflow.com/a/9795126/292060)看来，Chrome 要么匹配字段名称上的正则表达式模式，要么表单显式使用该`x-autocompletetype`属性，如下所示（此示例使用“somename”以避免混淆名称匹配的问题）：

```
<input type="text" name="somename" x-autocompletetype="cc-number" /> 
```

实际上，您可以同时选择匹配的名称和 x-autocompletetype：

```
<input type="text" name="ccnum" x-autocompletetype="cc-number" /> 
```

您的屏幕截图中有输入框的视图源吗？这将显示它是否匹配名称或 x-autocompletetype 属性。

我链接到的答案有几个链接以获取更多信息；我没有在这里重复它们。

其他一些评论：

我知道 Chrome 会弹出一个问题是否保存信用卡信息（我没有），但我不知道它是否会弹出该问题，无论它如何检测到它。也就是说，我不确定 Chrome 是否会自动完成信用卡的单独字段以及其他字段，或者是否需要将整个内容保存为信用卡。

你的问题是如何做，而不是是否做。但是从您问题中的评论来看，我同意您可能不想自动填写信用卡字段。就我个人而言，我发现它发生时令人不安，即使知道它在我的浏览器中是本地的（我对 CVV 尤其有这种感觉，当我报告它时会遇到惊人的阻力）。但是，当客户想要使用 Chrome 时，有些帖子会让人感到沮丧，因为 Chrome 设置了信用卡，而网站却阻止了它。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-03-06T22:19:47.740

感谢[@goodeye](https://stackoverflow.com/users/292060/goodeye)引导我找到正确的答案。

要触发信用卡自动填充，

1.  必须在您的表单上启用 SSL
2.  如果启用 SSL，则标准信用卡字段名称的大多数变体都应该可以使用。

[这](https://chromium.googlesource.com/chromium/chromium/+/master/chrome/browser/autofill/autofill_regex_constants.cc.utf8)是 Chrome 用于触发检测的正则表达式的链接

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-07-30T13:45:40.540

Chrome`autocomplete`在输入中使用属性进行自动填充。如果还没有，将来可能会被其他浏览器使用。 `autocomplete`的实际用途是通过指定`autocomplete="off"`. 但是 chrome 使用相同的方式进行自动填充。

**自动填充**和**自动完成**是不同的，所以不要混淆。

**自动填充**是 chrome 用来从 chrome 浏览器的自动填充设置中存储的内容填充表单的工具。

**自动完成**是所有浏览器用来记住您之前可能以相同形式输入的内容，方法是在您键入时建议值。因此，当您`autocomplete="off"`在输入上使用时，浏览器会停止建议这些值。

回到解决方案，自动填充可`cc-number`用于卡号、`cc-name`持卡人姓名、`cc-csc`cvc 和属性`cc-exp`中的卡到期日期。`autocomplete`这是一个与 chrome 自动填充兼容的示例：

```
<div>
    <label for="frmNameCC">Name on card</label>
    <input name="ccname" id="frmNameCC" required placeholder="Full Name" autocomplete="cc-name">
</div>
<div>
    <label for="frmCCNum">Card Number</label>
    <input name="cardnumber" id="frmCCNum" required autocomplete="cc-number">
</div>
<div>
    <label for="frmCCCVC">CVC</label>
    <input name="cvc" id="frmCCCVC" required autocomplete="cc-csc">
</div>
<div>
    <label for="frmCCExp">Expiry</label>
    <input name="cc-exp" id="frmCCExp" required placeholder="MM-YYYY" autocomplete="cc-exp">
</div>
```

如果您现在在 chrome 浏览器中保存了信用卡，请尝试单击`Run code snippet`上面的按钮，您可以看到 chrome 自动填充正在运行。

来源：[https ://developers.google.com/web/updates/2015/06/checkout-faster-with-autofill](https://developers.google.com/web/updates/2015/06/checkout-faster-with-autofill)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-08-23T08:22:24.227

Chrome 还通过占位符进行扫描。

示例：`<input placeholder='dd-mm-yyyy'/>`将触发它成为信用卡字段。

# html - 为什么 `display: table` 存在？

> ID：15168265
> 
> 赞同：2
> 
> 时间：2013-03-01T22:58:31.580
> 
> 标签：html, html-table

在我的另一个问题[中，div table 中的单元格间距](https://stackoverflow.com/questions/15167943/)每个人都说表格比 div 表格更好，并且有人提到 div 表格没有 html 表格的好处。我很困惑，为什么要`display: table`介绍它，如果它很糟糕，它的意义何在？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T23:04:46.430

显示*表*在单元格间距和拉伸方面以某种方式表现。这种行为很难用其他方法重现。HTML`<table>`元素应该只用于*表格数据*（想想 Excel 电子表格）。所以一个是显示行为，另一个是语义（有意义的）标记。您可能想使用一个而不使用另一个，这就是为什么它们是两种不同的东西。

如果您有表格数据，请使用标记`<table>`并免费获取表格显示行为。如果您有一些确实不是表格数据但您想以表格的行为显示它，请在其上添加一个 CSS 表格显示行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-03T21:54:45.383

不管在任何给定情况下是否更好地使用表格或 div 的任何其他考虑，`display:table`存在的原因（以及相关的`display:table-row`and `display:table-cell`）是因为 CSS 应该能够将任意 HTML（甚至 XML）呈现为所需的布局，无需将任何样式效果硬编码到浏览器中。

标准`<table>`、、、`<tr>`等`<td>`元素应用了大量的默认样式；并且在许多方面表现与其他元素完全不同。`display:table`复制那些不同的行为。

因此，现代浏览器可以简单地`display:table`用作元素的默认样式`table`，而不必像旧浏览器那样在引擎中内置硬编码的特定于表格的渲染。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:06:37.053

是否使用一种或另一种的选择更多地基于使用表格来存储数据而不是布局。一个好的经验法则是在您实际尝试使用数据“表”时使用表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-03T22:07:21.317

底线是 HTML 标记 ( `<table>`) 应该描述内容*是*什么，而 CSS( `display:table`) 描述内容应该是什么*样子*。他们不一样。

您可以在非表格元素上使用它，`display:table`但当您想要设置实际表格的显示属性时，这是唯一合适的选择。

这是一个易于理解的示例：

```
<div class="my-tables">
    <table>...</table>
    <table>...</table>
    <table>...</table>
</div> 
```

```
.my-tables table {
    display:none; /* hide all the tables */
} 
```

你如何*展示*其中一张桌子，比如第一张？

```
.my-tables table:first-child {
    /* display:block; not quite... */
    display:table; /* There it is! */
} 
```

表格是标记表格内容的正确工具。*仅*用于布局的表格是对标签的滥用。使用`<p>`or`<fieldset>`布局同样是错误的。

# javascript - CollectionView 中的 EmberJS 和 Handlerbars 助手

> ID：15168269
> 
> 赞同：1
> 
> 时间：2013-03-01T22:58:48.073
> 
> 标签：javascript, ember.js, handlebars.js

我正在尝试使用集合视图，并在每个项目视图中使用处理程序栏助手，但我无法获得帮助函数来扩展我的路径到值。

```
Ember.CollectionView.create({content: App.AController,
    itemViewClass: App.ItemView
});
Em.Handlebars.registerHelper('editable', function (path, options) {
    options.hash.valueBinding = path;
    return Em.Handlebars.helpers.view.call(this, App.EditField, options);
});
<script type="text/x-handlebars" data-template-name="edit-field">
    {{#if isEditing}}
        {{view Ember.TextField valueBinding = "value" propagatesEvents = true}} 
    {{else}}
        {{#if value}}
            {{value}}
        {{else}}
            <span class="no-name">empty</span>
        {{/if}}
    {{/if}}
</script>
<script type="text/x-handlebars" data-template-name="item-view">
    {{view.content.name}}
    {{editable view.content.name}}
</script> 
```

[http://jsfiddle.net/epigeon/dNqsV/29/](http://jsfiddle.net/epigeon/dNqsV/29/)带有完整的代码示例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T02:52:53.337

'isEditing' 属性在视图上，但 collectionView itemView 的上下文是该视图的内容。为了在模板中引用视图的属性，您必须以“view”开始属性路径，如“view.isEditing”。

我在你的小提琴中做了那个改变，这个例子似乎像我预期的那样工作。

# sql - 一次查询中的百分比

> ID：15168271
> 
> 赞同：0
> 
> 时间：2013-03-01T22:58:56.670
> 
> 标签：sql, tsql

我试图结合这两个查询来产生一个百分比值。

```
SELECT DATEADD(dd, 0, DATEDIFF(dd, 0, regdate)) AS rdate, 
       COUNT(*) as sum 
FROM TBL where regdate > '2013-02-21' 
GROUP BY DATEADD(dd, 0, DATEDIFF(dd, 0, regdate)) 
ORDER BY rdate DESC 

SELECT DATEADD(dd, 0, DATEDIFF(dd, 0, slutdatum)) AS sdate, 
       COUNT(*) as sum 
FROM TBL 
WHERE slutdatum > '2013-02-21' 
GROUP BY DATEADD(dd, 0, DATEDIFF(dd, 0, slutdatum))       
ORDER BY sdate DESC 
```

但我真的不明白。我已经尝试如下所示，但这只会产生错误，这两个查询由它自己工作；（我可以分开运行查询并在获取值后进行数学运算，但这只会导致过度执行）。

```
SELECT (SELECT DATEADD(dd, 0, DATEDIFF(dd, 0, regdate)) AS rdate, count(*) as sum 
        FROM TBL where regdate > '2013-02-21' 
        GROUP BY DATEADD(dd, 0, DATEDIFF(dd, 0, regdate)) 
        ORDER BY rdate DESC) / (select DATEADD(dd, 0, DATEDIFF(dd, 0, slutdatum)) AS sdate,    
COUNT(*) as sum from TBL where slutdatum > '2013-02-21' 
GROUP BY DATEADD(dd, 0,    
DATEDIFF(dd, 0, slutdatum)) ORDER BY sdate DESC) * 100 from tbl 
```

如何进行一个查询，生成过去 7 天的日期和百分比两列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:48:40.007

由于您将比较**同一天发生的**事件，我们可以在该日期**加入**，但我们需要`FULL OUTER JOIN`包括只有休息或只有修复的日子。

这是更新的代码：

```
SELECT COALESCE(reg.rdate,cl.sdate) as [Date], ISNULL(reg.sum, 0) as [Registered], ISNULL(cl.sum, 0) as [Closed], 
       CASE WHEN cl.sum IS NULL THEN 0
            WHEN ISNULL(cl.sum,0) > ISNULL(reg.sum,0) THEN 100 
            ELSE CONVERT(float,cl.sum)/reg.sum*100 END as [Percentage]  
FROM 

(SELECT regdate AS rdate, COUNT(regdate) as sum 
FROM TBL where regdate > CONVERT(datetime,'20130221',112) 
GROUP BY regdate ) reg 

FULL OUTER JOIN 

(SELECT slutdatum AS sdate, COUNT(slutdatum) as sum 
FROM TBL WHERE slutdatum > CONVERT(datetime,'20130221',112)
GROUP BY slutdatum) cl

ON (reg.rdate=cl.sdate)
ORDER BY COALESCE(reg.rdate,cl.sdate); 
```

我使用测试数据创建了 SQL Fiddle，因此您可以尝试以下代码： [http](http://sqlfiddle.com/#!3/58a33/1) ://sqlfiddle.com/#!3/58a33/1 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:12:03.213

您可以像使用表格一样使用 (SELECT ...)。所以，试试 SELECT ... FROM (SELECT ...) as A, (SELECT ...) as B

现在您可以在同一个公式中使用 A 和 B 中的值。

# c++ - 将“system::string”传递给函数时出错

> ID：15168276
> 
> 赞同：1
> 
> 时间：2013-03-01T22:59:43.300
> 
> 标签：c++, string, c++-cli

我有以下函数，希望能告诉我文件夹是否存在，但是当我调用它时，我得到了这个错误 -

> 无法将参数 1 从 'System::String ^' 转换为 'std::string'

功能 -

```
#include <sys/stat.h>
#include <string>

bool directory_exists(std::string path){

    struct stat fileinfo;

    return !stat(path.c_str(), &fileinfo);

} 
```

调用（来自包含用户选择文件夹的表单的 form.h 文件） -

```
private:
    System::Void radioListFiles_CheckedChanged(System::Object^  sender, System::EventArgs^  e) {

        if(directory_exists(txtActionFolder->Text)){                
            this->btnFinish->Enabled = true;
        }

    } 
```

有人能告诉我如何解决这个问题吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:02:38.940

您正在尝试将托管的 C++/CLI 字符串 ( `System::String^`) 转换为`std::string`. 没有为此提供隐式转换。

为了使其工作，您必须自己处理[字符串转换](http://msdn.microsoft.com/en-us/library/bb384865.aspx)。

这可能看起来像：

```
std::string path = context->marshal_as<std::string>(txtActionFolder->Text));
if(directory_exists(path)) {  
     this->btnFinish->Enabled = true;
} 
```

话虽如此，在这种情况下，完全坚持使用托管 API 可能更容易：

```
if(System::IO::Directory::Exists(txtActionFolder->Text)) {  
     this->btnFinish->Enabled = true;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:03:48.580

您正在尝试将 CLR 字符串转换为 STL 字符串以将其转换为 C 字符串以将其与 POSIX 仿真函数一起使用。为什么会出现这样的并发症？由于您无论如何都在使用 C++/CLI，因此只需使用[`System::IO::Directory::Exists`](http://msdn.microsoft.com/en-us/library/system.io.directory.exists.aspx).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:03:11.450

要完成这项工作，您需要从托管类型`System::String`转换为本机类型`std::string`。这涉及到一些编组，并会产生 2 个单独的字符串实例。MSDN 为字符串的所有不同类型的封送处理提供了一个方便的表

> [http://msdn.microsoft.com/en-us/library/bb384865.aspx](http://msdn.microsoft.com/en-us/library/bb384865.aspx)

在这种特殊情况下，您可以执行以下操作

```
std::string nativeStr = msclr::interop::marshal_as<std::string>(managedStr); 
```

# erlang - jInterface可以在没有节点的情况下使用吗？

> ID：15168277
> 
> 赞同：3
> 
> 时间：2013-03-01T22:59:50.670
> 
> 标签：erlang, jinterface

Erlang 中的整个节点概念假定节点是安全的……总是。关于如何解决这个问题有很多迂回的方法，但没有真正的 Erlang 节点解决方案。

我正在构建 Java 和 Erlang 之间的节点，但存在安全问题。现在我面临着 ssl over tcp/udp。如果不需要，我不想编写自己的协议（忽略应用程序级协议）。

如果我在 Erlang 端使用 binary_to_term 和 term_to_binary，我可以使用 jInterface 来解析 Erlang tcp/udp 服务器的术语吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T00:32:11.290

当然，您可以使用该库来解码术语。顺便说一句，您可以使用[BERT（二进制 ERlang 术语）进行通信。](http://bert-rpc.org/)

# keyboard - Kinesis Advantage Keyboard VS ergoMagic 垂直键盘

> ID：15168278
> 
> 赞同：3
> 
> 时间：2013-03-01T23:00:05.390
> 
> 标签：keyboard

我的手腕真的很痛。我正在寻找一个新的键盘来尽量减少这个问题。我试图搜索 Kinesis Advantage 键盘和 ergoMagic Vertical 键盘的评论，但我找不到两者之间的任何实际比较。

Kinesis Advantage 具有真正的 3D 设计，但与真正的垂直位置键盘相比，我仍然缺乏有关它的信息。现在看来，Kinesis 优势确实看起来很舒服，但它的位置仍然非常水平，这对我来说似乎不舒服。另一方面，像 ergoMagic Comfort 这样的垂直键盘看起来也不是很好。

有人有这两种经验吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-14T02:00:39.210

我有一个带有 Ascent 配件的 Kinesis Freestyle。我使用它完全垂直，与桌子成 90 度，据我所知，这种布置是独一无二的。我的手腕受伤了。现在我没有。这就是所有要说的。这不是空洞的宣传：站起来放松一下，现在检查一下你的手的位置！看，这是他们的自然立场。分体式键盘（如 Freestyle）有助于让您的手更接近自然位置，但垂直键盘可以让您的手保持在应有的位置。高超。因为 Ascent 是可调节的，所以您可以在 7-10 天内习惯它，只需每天上一步即可。

当我带着这个怪物参加各种 Drupal 活动时，其他 Drupal 人也购买了键盘，据我所知，他们也很高兴。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T14:44:19.897

您遇到的问题是桡神经或尺神经受到挤压，这些神经从手穿过肘部的凹槽，向上延伸到手臂，越过肩膀和脖子。

夹伤可能发生在手腕、肘部、肩部或颈部。

如果手腕或肘部发生挤压，手腕上的压缩包裹/防护装置很可能会解决问题。这是一种由绷紧的弹性材料制成的手腕套，戴上时应感到适度的压力，但如果出现血流受限，请松开。拿一些在手腕垫上有支撑的东西，以便在打字时使用。我的有一个小豆袋。我发现豆袋比凝胶类型更舒适。这将纠正任何键盘上的姿势。您可以随身携带。您也可以随时佩戴它，即使您不在键盘前，您也会获得更多的治疗效果。

打字时不要使用硬质包裹物（这种包裹物有一个金属条，可以迫使您的手腕进入自然位置）。您可以在睡觉时购买硬质绷带以进行压缩，但请注意不要在睡觉时撞到您的伴侣。

要尝试的第二件事是将腕带与肘带配对。同样的事情，压缩类型。

如果两者都不能解决问题，请尝试沿着内臂肌肉寻找结。这些结可以夹住尺神经。如果你发现任何结，按摩它们。这个过程会很痛，因为在神经夹痛消退后，疼痛会瞬间*增加*。

如果您的手臂没有打结，则问题出在您的肩膀或脖子上。首先尝试调整您的座位位置。确保膝盖和肘部成 90 度角，双脚平放，最重要的是，肩膀处于自然位置，而不是像“我不知道”的表情那样抬起。背部挺直，下背部支撑良好（他们称之为腰部支撑）。你的脊椎是 S 形的（从前到后），你需要用你的姿势来支撑它。显示器的视角应与您的头部水平或以下。不在上面。

如果无法完善您的姿势，您需要去看医生，因为您的肩部或颈部受到挤压。你需要支持来解决肩部捏伤，如果是颈部捏伤，你可能需要手术。考虑这是最后的手段。手术患者通常与早在五年内避免手术的人没有区别。因此，您生活中的这些痛苦事件要么是暂时的，要么即使在手术后也会复发。

回顾：

如果夹在手腕或肘部，10 美元就可以解决您的问题，而且 10 美元您可以随时使用，无需购买多个键盘并浪费 100 美元。如果这不起作用，请寻找手臂上的结。按摩出来。

如果您的肩部或颈部受到挤压，请确保您有良好的坐姿，然后去看医生。尝试脊椎按摩师和神经专家。他们采取不同的方法，但始终认为手术是最糟糕的选择。

经验：

我不是医生，但我的尺神经有很多问题，我和医生谈过很多次。我的椎间盘也撕裂了，所以我的腿也有问题。我在使用多种补救疗法方面经验丰富，并且对使用虚假理论的吸血吸血鬼有效和有效的方法有很好的感觉。对您的健康的威胁是真实存在的。据我所知，我的左手外侧永久麻木。

更新：经过半年以上的练习，我手中的感觉又回来了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T14:36:35.550

我有三个 Kinesis Advantage 键盘。过去我手腕处有严重的肌腱炎。这些键盘拯救了我的职业生涯。舒适度，更重要的是人体工程学是无与伦比的。键的方向是直线而不是交错的。这种看似很小的修改所带来的巨大打字优势和舒适感将让我感受到，因为我无法连续几个小时打字而没有任何问题。我不能在普通键盘上这样做。这些按键是低力度的机械式按键，不会触底，因此在使用薄膜式键盘时不会出现任何震动。这些键盘的客户支持非常好。不要被成本推迟。与挽救您的职业生涯相比，成本微不足道。RSI 相关的创伤是非常真实和危险的。请不要'

在另一个重要的注意事项上，我建议良好的物理治疗和姿势（不良姿势会导致与计算机相关的手腕问题）。我在宾夕法尼亚州阿伦敦的 Suparna Damany 接受了治疗（世界级的治疗师和计算机相关创伤的作者）。这些措施与出色的键盘相结合，将治愈您的手腕。

一切顺利，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-03T10:49:00.093

我没有使用 ergoMagic，但我已经是一个快乐的 Kinesis Advantage 用户超过 7 个月了。尽管幸运的是我没有受到任何 RSI/CTS 和相关问题的困扰，但我注意到打字舒适度大幅提高，尤其是在经过数小时的编程会话之后。Advantage 的柔和曲线轮廓和键盘“井”的适当间距使手可以占据更放松和自然的位置。与具有单组按键的传统键盘不同，Advantage 上的手腕大部分保持笔直，从而使尺神经免受长期压力。我一直在使用的另一项修改（在我所有的键盘上，包括笔记本电脑上）是重新映射`CapsLock`到`Ctrl`. 我是 Emacs 的重度用户，这一步是很自然的选择。Advantage 相当昂贵（尽管仍然比 Maltron 便宜得多），但我会说它值得每一美元甚至更多。我在 Massdrop 上以 200 多美元的价格买了我的，这是一个真正的便宜货，但从那以后我对我的打字非常满意。此外，您还可以获得额外的福利，路过您办公桌的人会问“这是什么……？” :)。无论如何，这是迄今为止我用过的最好的键盘，所以我可以诚实地推荐它。

# html - 当窗口高度减小时如何防止页脚移出上方的元素

> ID：15168288
> 
> 赞同：0
> 
> 时间：2013-03-01T23:01:35.607
> 
> 标签：html, css, footer

我试图让我的页脚停止移动，因为浏览器的高度降低了其他元素。相反，我只想让它保持原样并能够向下滚动。

这是它正在发生的页面的链接：

[http://fine-grain-2.myshopify.com/cart](http://fine-grain-2.myshopify.com/cart)

这是我的页脚的 CSS：

```
footer {
    margin: 0 auto;
    padding: 0 0 1em;
    position: relative;
    text-align: center;
} 
```

这是正在发生的事情的一个例子：

好的

![在此处输入图像描述](../Images/8cdf14728ddfd04abcd5d598c1d61def.png)

坏的 ![在此处输入图像描述](../Images/6af6df9795bee6c06624f533b5b38c59.png)

我已经尝试了我所知道的一切，并查看了其他使用 firebug 的网站。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:07:46.180

没有看到 HTML 和 CSS 很难说，但如果你添加 `clear:both; width:100%;`到页脚，它看起来好像可以从屏幕截图中解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:25:26.093

您需要做的就是添加以下CSS：

```
clear:both; 
```

# neo4j - ExecutionResult result.hasNext() 需要很长时间才能返回

> ID：15168291
> 
> 赞同：0
> 
> 时间：2013-03-01T23:01:48.203
> 
> 标签：neo4j, cypher

我对 Neo4j 相当陌生。尝试迭代 ExecutionResult 结果集时遇到一个特殊错误。在以下代码片段中，最后一个 res.hasNext() 需要近 50 秒才能在最后一次迭代中返回。

我正在使用的密码查询是

```
start p=node(*) where (p.`process-workflowID`? = '" + Id + "') and (p.type? = 'process') return ID(p); 
```

我正在使用 neo4j-community-1.8.1 和 java 1.6.0_41，针对具有 226710 个节点的数据库进行测试。

有没有人知道为什么会这样？我假设查询在 engine.execute(query) 返回时完成，但如果不是这种情况，将不胜感激有人在查询实际完成时有所了解。先感谢您。

```
ExecutionResult result = engine.execute(query);
Iterator<Map<String, Object>> res =  result.iterator();
while(res.hasNext()) {
   Map<String, Object> row = res.next();
   for(Entry<String, Object> column : row.entrySet()){
                ...
   }
   long t1 = System.currentTimeMillis();
   res.hasNext(); // <--------------------------- statement in question
   long t2 = System.currentTimeMillis();
   System.out.println(t2-t1);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:53:47.950

在迭代结果集时执行查询。所以每次调用 hasNext/next 都会涉及到图上的一些操作。然而，50 秒的停顿和大约 250k 个节点的图表表明你做的事情基本上是错误的。

你可能会调查：

1.  您的查询效率非常低，您应该使用索引。最简单的方法是为您正在搜索的属性设置自动索引，请参阅[http://docs.neo4j.org/chunked/stable/auto-indexing.html](http://docs.neo4j.org/chunked/stable/auto-indexing.html)。请注意，预先存在的数据不会被重新索引！

    重建数据库后，请改用以下密码语句：

    ```
    Map<String,Object> = Collections.singletonMap("id", Id);
    executionEngine.execute("start p=node:node_auto_index('process-workflowID:{id} type:process') return ID(p)", params) 
    ```

    我不确定“process-workflowID”是否需要在 lucene 语法中额外引用。

2.  使用 jvisualvm 确保您没有遇到 gc/内存问题

3.  根据[http://docs.neo4j.org/chunked/stable/configuration-caches.html](http://docs.neo4j.org/chunked/stable/configuration-caches.html)设置映射内存并多次运行您的查询以从预热缓存中受益。

# php - 将帖子组织成 3 列

> ID：15168292
> 
> 赞同：0
> 
> 时间：2013-03-01T23:01:50.347
> 
> 标签：php, wordpress

我正在尝试将帖子组织成三列，但无法正常工作。我只想在 3 个不同的列中显示 3 个帖子。

所以

1 | 2 | 3

到目前为止我所拥有的：

```
<div id="main-wrapper">

<?php 
  $loop = new WP_Query(array('post_type' => 'camp', 'posts_per_page' => 3)); 
  if ($loop->have_posts()) ?>
    <?php while ( $loop->have_posts() ) : $loop->the_post(); ?>
    <?php   
    $custom = get_post_custom($post->ID);
    $screenshot_url = $custom["screenshot_url"][0];
    $website_url = $custom["website_url"][0];
?>

 <?php the_content(); ?>

<?php endwhile; ?>

</div> 
```

网站是[Botkai](http://www.botkai.com/camps-page/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:05:56.120

可以通过在父级内部创建另一个 DIV 轻松完成

```
<div id="main-wrapper">

<?php 
  $loop = new WP_Query(array('post_type' => 'camp', 'posts_per_page' => 3)); 
  if ($loop->have_posts()) ?>
    <?php while ( $loop->have_posts() ) : $loop->the_post(); ?>
    <div style="float: left;"> <!-- or other class that contains this CSS property, including width etc. -->
      <?php   
        $custom = get_post_custom($post->ID);
        $screenshot_url = $custom["screenshot_url"][0];
        $website_url = $custom["website_url"][0];
      ?>
    </div>

<?php endwhile; ?>

</div> 
```

# javascript - HTML5地理定位中的经纬度半径

> ID：15168299
> 
> 赞同：5
> 
> 时间：2013-03-01T23:02:21.177
> 
> 标签：javascript, geolocation

所以我做了一些环顾四周，找不到任何真正回答我想要做的事情的东西，因此我发布了！

我的总体目标本质上是让页面读取用户位置，然后根据他们所在的位置运行代码。具体来说，我有一个 facebook 签入脚本，允许用户在特定位置签入。

问题是有问题的位置有点大，所以手动输入位置的坐标是行不通的。我现在坚持的是是否有可能告诉 JS 采用硬编码的位置的经度和纬度，但在坐标周围给出一个半径（比如说 200 米），所以当用户输入坐标的 200m 半径时代码激活。

有没有人有任何想法？

到目前为止，这是我的代码。

```
 jQuery(window).ready(function(){   
        initiate_geolocation();
    });  
    function initiate_geolocation() {  
        navigator.geolocation.getCurrentPosition(handle_geolocation_query,handle_errors);  
    }  
    function handle_errors(error)  
    {  
        switch(error.code)  
        {  
            case error.PERMISSION_DENIED: alert("user did not share geolocation data");  
            break;  
            case error.POSITION_UNAVAILABLE: alert("could not detect current position");  
            break;  
            case error.TIMEOUT: alert("retrieving position timed out");  
            break;  
            default: alert("unknown error");  
            break;  
        }  
    }  
     function handle_geolocation_query(position){  
         var lat = position.coords.latitude;
         var long = position.coords.longitude;

                      //these are for testing purposes
          alert('Your latitude is '+lat+' and longitude is '+long);
          if (lat == 0 && long == 0) {alert('It works!');};
    } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-01T23:18:14.603

我要做的是使用 setInterval 创建一个轮询函数，每 1 到 10 秒执行一次，具体取决于什么对您的测试最有意义，并且只测试距离。这是一个测试两个经度/纬度之间距离的函数：

```
function CalculateDistance(lat1, long1, lat2, long2) {
    // Translate to a distance
    var distance =
      Math.sin(lat1 * Math.PI) * Math.sin(lat2 * Math.PI) +
      Math.cos(lat1 * Math.PI) * Math.cos(lat2 * Math.PI) * Math.cos(Math.abs(long1 - long2) * Math.PI);

    // Return the distance in miles
    //return Math.acos(distance) * 3958.754;

    // Return the distance in meters
    return Math.acos(distance) * 6370981.162;
} // CalculateDistance 
```

您的区间函数看起来像：

```
// The target longitude and latitude
var targetlong = 23.456;
var targetlat = 21.098;

// Start an interval every 1s
var OurInterval = setInterval(OnInterval, 1000);

// Call this on an interval
function OnInterval() {
  // Get the coordinates they are at
  var lat = position.coords.latitude;
  var long = position.coords.longitude;
  var distance = CalculateDistance(targetlat, targetlong, lat, long);

  // Is it in the right distance? (200m)
  if (distance <= 200) {
    // Stop the interval
    stopInterval(OurInterval);

    // Do something here cause they reached their destination
  }
} 
```

# java - 使用 ConcurrentHashMap 进行并行处理

> ID：15168305
> 
> 赞同：0
> 
> 时间：2013-03-01T23:02:50.310
> 
> 标签：java, concurrency, parallel-processing, hashmap

我有一个程序，我试图了解线程并行性。该程序处理抛硬币并计算正面和反面的数量（以及抛硬币的总数）。

请看以下代码：

```
import java.util.Random;
import java.util.concurrent.ConcurrentHashMap;

public class CoinFlip{

    // main
    public static void main (String[] args) {
        if (args.length != 2){
            System.out.println("CoinFlip #threads #iterations");
            return;
        }

        // check if arguments are integers
        int numberOfThreads = 0;
        long iterations = 0;

        try{
            numberOfThreads = Integer.parseInt(args[0]);
            iterations = Long.parseLong(args[1]);
        }catch(NumberFormatException e){
            System.out.println("error: I asked for numbers mate.");
            System.out.println("error: " + e);
            System.exit(1);
        }

        // ------------------------------
        // set time field
        // ------------------------------

        // create a hashmap
        ConcurrentHashMap <String, Long> universalMap = new ConcurrentHashMap <String, Long> ();

        // store count for heads, tails and iterations
        universalMap.put("HEADS", new Long(0));
        universalMap.put("TAILS", new Long(0));
        universalMap.put("ITERATIONS", new Long(0));

        long startTime = System.currentTimeMillis();

        Thread[] doFlip = new Thread[numberOfThreads];

        for (int i = 0; i < numberOfThreads; i ++){
            doFlip[i] = new Thread( new DoFlip(iterations/numberOfThreads, universalMap));
            doFlip[i].start();
        }

        for (int i = 0; i < numberOfThreads; i++){
            try{
                doFlip[i].join();
            }catch(InterruptedException e){
                System.out.println(e);
            }
        }

        // log time taken to accomplish task
        long elapsedTime = System.currentTimeMillis() - startTime;
        System.out.println("Runtime:" + elapsedTime);

        // print the output to check if the values are legal
        // iterations = heads + tails = args[1]
        System.out.println(
            universalMap.get("HEADS") + " " +
            universalMap.get("TAILS") + " " +
            universalMap.get("ITERATIONS") + "."
        );

        return;
    }

    private static class DoFlip implements Runnable{

        // local counters for heads/tails/count
        long heads = 0, tails = 0, iterations = 0;
        Random randomHT = new Random();

        // constructor values -----------------------
        long times = 0; // number of iterations
        ConcurrentHashMap <String, Long> map; // pointer to hash map

        DoFlip(long times, ConcurrentHashMap <String, Long> map){
            this.times = times;
            this.map = map;
        }

        public void run(){
            while(this.times > 0){
                int r = randomHT.nextInt(2); // 0 and 1

                if (r == 1){
                    this.heads ++;
                }else{
                    this.tails ++;
                }
                // System.out.println("Happening...");
                this.iterations ++;
                this.times --;
            }

            updateStats();
        }

        public void updateStats(){
            // read from hashmap and get the existing values
            Long nHeads = (Long)this.map.get("HEADS");
            Long nTails = (Long)this.map.get("TAILS");
            Long nIterations = (Long)this.map.get("ITERATIONS");

            // update values
            nHeads = nHeads + this.heads;
            nTails = nTails + this.tails;
            nIterations = nIterations + this.iterations;

            // push updated values to hashmap
            this.map.put("HEADS", nHeads);
            this.map.put("TAILS", nTails);
            this.map.put("ITERATIONS", nIterations);

        }
    }
} 
```

我正在使用 ConcurrentHashMap 来存储不同的计数。显然，当返回错误值时。

我写了一个 PERL 脚本来检查头部和尾部的值（总和）（每个线程单独），这似乎是合适的。我不明白为什么我从哈希图中得到不同的值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T23:17:06.037

并发散列映射为您提供关于***映射***本身而不是其值的更改可见性的保证。在这种情况下，您从地图中检索一些值，将它们保存一段时间，然后再次尝试将它们存储到地图中。不过，在读取和后续写入之间，***map 上可能发生了任意数量的操作***。

并发哈希映射中的并发只是保证，例如，如果我将一个值放入映射中，我实际上将能够在另一个线程中读取该值（也就是它将是可见的）。

您需要做的是确保访问映射的所有线程都*等待轮到它们*，可以这么说，在更新共享计数器时。为了做到这一点，你要么必须在 AtomicInteger 上使用像“addAndGet”这样的原子操作：

```
this.map.get("HEADS").addAndGet(this.heads); 
```

或者您需要手动同步读取和写入（最容易通过在地图本身上同步来完成）：

```
synchronized(this.map) {
    Long currentHeads = this.map.get("HEADS");
    this.map.put("HEADS", Long.valueOf(currentHeads.longValue() + this.heads);
} 
```

就个人而言，我更喜欢尽可能利用 SDK，因此我会使用 Atomic 数据类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T23:06:59.640

您应该使用 AtomicLongs 作为值，并且您应该只创建一次并递增它们而不是 get/put。

```
 ConcurrentHashMap <String, AtomicLong> universalMap = new ConcurrentHashMap <String, AtomicLong> ();
 ...
 universalMap.put("HEADS", new AtomicLong(0));
 universalMap.put("TAILS", new AtomicLong(0));
 universalMap.put("ITERATIONS", new AtomicLong(0));
 ...
 public void updateStats(){
        // read from hashmap and get the existing values
        this.map.get("HEADS").getAndAdd(heads);
        this.map.get("TAILS").getAndAdd(tails);
        this.map.get("ITERATIONS").getAndAdd(iterations);
 } 
```

长是不可变的。

一个例子：

```
Thread 1: get 0
Thread 2: get 0
Thread 2: put 10
Thread 3: get 10
Thread 3: put 15
Thread 1: put 5 
```

现在您的地图包含 5 而不是 20

基本上你的问题不是地图。您可以使用常规的 HashMap，因为您不修改它。当然，你必须使`map`领域`final`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-02T01:29:56.253

几件事。一个你真的不需要使用 ConcurrentHashMap。ConcurrentHashMap 仅在处理并发放置/删除时才有用。在这种情况下，就键而言，地图是相当静态的，只需使用 UnmodifiableMap 来证明这一点。

最后，如果您正在处理并发添加，您真的应该考虑使用[LongAdder](http://code.google.com/p/guava-libraries/source/browse/guava/src/com/google/common/cache/LongAdder.java?name=v13.0-rc2&r=06cbdb1ed84f235b51fec6acc740d8261357545d)。当发生许多并行添加时，它的扩展性要好得多，您无需担心计数直到结束。

```
public class HeadsTails{
    private final Map<String, LongAdder> map;
    public HeadsTails(){
       Map<String,LongAdder> local = new HashMap<String,LongAdder>();
       local.put("HEADS", new LongAdder());
       local.put("TAILS", new LongAdder());
       local.put("ITERATIONS", new LongAdder());
       map = Collections.unmodifiableMap(local);
    }
    public void count(){
        map.get("HEADS").increment();
        map.get("TAILS").increment();
    }
    public void print(){
        System.out.println(map.get("HEADS").sum());
         /// etc...
    }
} 
```

我的意思是，实际上我什至不会使用地图...

```
public class HeadsTails{
    private final LongAdder heads = new LongAdder();
    private final LongAdder tails = new LongAdder();
    private final LongAdder iterations = new LongAdder();
    private final Map<String, LongAdder> map;
    public void count(){
        heads.increment();
        tails.increment();
    }
    public void print(){
        System.out.println(iterations.sum());
    }
} 
```

# extjs - 从文件中设置 Ext.container.Container 的内容

> ID：15168311
> 
> 赞同：1
> 
> 时间：2013-03-01T23:03:05.720
> 
> 标签：extjs

```
Ext.define('MyApp.view.TopToolbar', {
    extend: 'Ext.container.Container',
    alias: 'widget.toptoolbar',
    initComponent: function() {
        Ext.applyIf(this, {
            layout: 'fit',
            cls : 'x-bottombar',
            html : 'HTML FRAGMENT'
        });
        this.callParent(arguments);
    }
}); 
```

最初这个组件包含一小段 html，但现在它会显着增加。所以我想将它移动到一个外部文件，但我在文档中找不到这样做的方法。有没有办法做到这一点？我不想在我的 js 中有一大块 html。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:31:33.183

使用`loader`组件上的配置：

[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.AbstractComponent-cfg-loader](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.AbstractComponent-cfg-loader)

[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.ComponentLoader](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.ComponentLoader)

# jquery - 从 json 查询中获取变量值

> ID：15168320
> 
> 赞同：-1
> 
> 时间：2013-03-01T23:04:01.737
> 
> 标签：jquery, json

我正在努力获取 JSON 查询的价值？

我在网上尝试了很多解决方案，但没有一个有效。我要做的就是`priceEnd`从 JSON 查询中获取值并将其显示在`itemPrice`div 中（每 2 秒左右刷新一次）。我究竟做错了什么？

```
{"priceEnd":"965.00","numberOfBids":"103"}

setInterval(function() {

///get the bid incriments
$.ajax({
    url : 'itemPrice.php?itemID=123',                         
    type: 'post',                   
    dataType:'json',                   
    success : function(data) {  
        console.log(data);
        data = $.parseJSON(data);
    }
});

var priceEnd = data.priceEnd;

$('#itemPrice').html(priceEnd);
}, 2000); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:07:14.107

当使用 JSON 的 dataType 时，解析是自动完成的，因为 ajax 是异步的，所以在成功回调中返回数据之前，您不能使用数据：

```
$.ajax({
    url : 'itemPrice.php',                         
    type: 'post',
    data: {itemID: '123'},                   
    dataType:'json',                   
    success : function(data) {  
        var priceEnd = data.priceEnd;
        $('#itemPrice').html(priceEnd);
    }
}); 
```

# javascript - EmberJS - 注册预编译的车把模板

> ID：15168323
> 
> 赞同：6
> 
> 时间：2013-03-01T23:04:18.097
> 
> 标签：javascript, ember.js, handlebars.js

对于我的 EmberJS 应用程序，我预编译了所有车把模板，因此它们被加载为直接的 Javascript 文件。

问题是这些预编译的模板没有像我想象的那样进入 Ember 容器 - 当我为我的视图指定模板时出现以下错误。

```
Uncaught Error: assertion failed: You specified the templateName "application" for <MyApp.ApplicationView:ember164>, but it did not exist. 
```

这是我的视图代码。

```
window.MyApp.ApplicationView = Ember.View.extend({
   templateName: 'application'
}); 
```

我单步执行，发现 Ember 容器中不存在视图。我需要做一些特别的事情来向容器注册预编译的模板吗？如果是这样，怎么做？

编辑：我一直在用车把 npm 包编译模板。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T23:25:23.453

查找模板`Ember.TEMPLATES`（这只是一个以模板名称为键的哈希）

所以当你的例子`ApplicationView`被执行时，它会在`Ember.TEMPLATES['application']`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T16:20:37.890

虽然 npm handlebars 编译器确实可以正确编译它们，但您仍然需要使用 Ember 注册它们才能正确加载它们。您可以执行以下操作之一：

*   使用 Ember.TEMPLATES['sometemplate'] = COMPILED TEMPLATE 手动加载它们。这行得通，但变得有点痛苦。
*   使用像 npm ember-precompile 这样的特殊编译器，它将以这样一种方式编译它们，使编译后的模板自动注册到 Ember 模板容器中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T17:38:20.087

如果您更喜欢基于 Ruby/Guard 的解决方案，请在此处查看我的要点：[https ://gist.github.com/perlun/5286391](https://gist.github.com/perlun/5286391)

从您的 Guardfile 中像这样使用它：

```
guard 'ember_handlebars',
    :input => 'app/handlebars_templates',
    :output => 'app/handlebars_compiled',
    :remove_prefix => 'app/handlebars_templates/' do
  watch(%r{app/handlebars_templates/(.+\.handlebars)})
end 
```

```

# ios - 在iOS中实现方向切换的正确方法是什么

> ID：15168324
> 
> 赞同：0
> 
> 时间：2013-03-01T23:04:25.613
> 
> 标签：ios, view, screen-orientation

我对在 iOS 应用程序中切换方向感到好奇。我所做的每个教程都只是谈论让视图自动旋转。我更喜欢横向和纵向的自定义视图。我知道如何制作横向视图控制器和纵向视图控制器。我的问题是您是否需要单独的视图控制器来处理不同的方向？如果是这样，您是否将所有代码从纵向视图控制器复制并粘贴到横向视图控制器，然后连接新视图控制器上的所有插座和操作？如果是这种情况，那么方向代码是否编写在单独的类（可能是应用程序委托）中，指示访问哪个视图控制器？每次我查看这个时，我都会看到这样的代码：

```
if (allowLandscape) {
return UIInterfaceOrientationIsLandscape(toInterfaceOrientation) || toInterfaceOrientation == UIInterfaceOrientationPortrait;
 }
 else {
 return toInterfaceOrientation == UIInterfaceOrientationPortrait;
 } 
```

在上面的代码中，toInterfaceOrientation 方法会是什么样子，上面的代码写在哪里？是在纵向/横向视图控制器的视图中加载方法还是在不同的类中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:20:59.760

如果您可以避免重复代码，那始终是最佳选择。（干燥 - 不要重复自己[http://en.wikipedia.org/wiki/Don](http://en.wikipedia.org/wiki/Don) 't_repeat_yourself）

我会尽可能地尝试使用一个可以处理两种布局的视图控制器。如果纵向和横向之间的视图确实不同，那么也许您只需要两个视图控制器。

我不确定您发布的代码。

你应该看这个：[https](https://developer.apple.com/videos/wwdc/2012/?id=236) ://developer.apple.com/videos/wwdc/2012/?id=236 他们深入研究了新的 iOS 6 轮换内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-30T13:42:06.097

您*可以*为纵向和横向视图使用单独的视图控制器，但在大多数情况下这样做并不是最好的解决方案。查看此[Apple 文档](https://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/RespondingtoDeviceOrientationChanges/RespondingtoDeviceOrientationChanges.html)以了解如何执行此操作。

最好在切换方向时简单地重新排列子视图和视图中的元素。使用自动布局来定义元素的约束。如果您的界面相当复杂，您可能必须在方向更改之前删除一些约束并添加新的约束。如果您的界面非常复杂并且需要界面元素在方向更改时完全改变它们的大小和位置，那么您很可能需要删除*所有*约束，然后为新的方向视图添加所有新约束。无论哪种情况，在添加和删除约束时，都在**willRotatetoInterfaceOrientation**视图控制器方法中进行，以获得最佳视觉效果。

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration {

    [self.view removeConstraints:self.view.constraints];

    if ((toInterfaceOrientation == UIInterfaceOrientationLandscapeLeft) || (toInterfaceOrientation == UIInterfaceOrientationLandscapeRight) ) {        
        // add landscape constraints here
    }
    else if ((toInterfaceOrientation == UIInterfaceOrientationPortrait) || (toInterfaceOrientation == UIInterfaceOrientationPortraitUpsideDown)) {
        // add portrait constraints here
    }
} 
```

使用可视格式语言以编程方式创建约束。我在 VFL 上看到的一篇好文章是Richard Turton 在 Command Shift 上撰写的[Visual Format Language](http://commandshift.co.uk/blog/2013/01/31/visual-format-language-for-autolayout/)。

# ember-data - 使用 Ember.js rc1 在函数中获取索引模型

> ID：15168325
> 
> 赞同：0
> 
> 时间：2013-03-01T23:04:30.873
> 
> 标签：ember-data

我开始学习 Ember.JS 1 周，但我不明白其中的一部分：当我使用动作（如按钮单击）时获取索引控制器的模型。

我的代码有一部分：

```
<script type="text/x-handlebars" data-template-name="index">
   <button class="btn btn-danger" {{action "addPost"}}> test</button>
</script> 
```

有我的 IndexController ：

```
App.IndexController = Ember.ArrayController.extend({
    addPost: function() {
        var po = this.controllerFor('index').get('model');
        console.log(po);
            po.createRecord({
               title: "YOLO",
               description: "Simply",
               date: "2013-03-01"
            });
    }
}); 
```

我的模型：

```
App.Post = DS.Model.extend({
    title: DS.attr('string'),
    description: DS.attr('string'),
    date: DS.attr('date')
}); 
```

因此，当我不使用 登录时`.get('model')`，我得到了 Class 回报，而当我使用它时，我得到了相同的回报。所以为什么 ？正常吗？在这两种情况下，我都有一个错误说“[Object object] has no method createRecord”。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:56:12.447

创建新记录只需要调用`createRecord`模型类本身的方法即可。

试试这个：

```
App.IndexController = Ember.ArrayController.extend({
  addPost: function() {
    var po = App.Post.createRecord({
      title: "YOLO",
      description: "Simply",
      date: "2013-03-01"
    });
  }
}); 
```

# php - 禁止路由 URL

> ID：15168332
> 
> 赞同：0
> 
> 时间：2013-03-01T23:04:53.763
> 
> 标签：php, model-view-controller, routing

我正在开发一个个人 MVC 框架，包括用于 URL 的路由器。

目前我有一个 PagesController 和一个“站点地图”视图。所以我可以去 url.com/pages/sitemap/

我还为“/info/{page}/”设置了 URL 路由。我已经为我希望在其 URL 中包含“信息”的静态页面完成了此操作。这也适用于站点地图。

然后，正如预期的那样，我也将 /sitemap/ 映射到了站点地图页面。

我只希望 /sitemap/ 成为有效资源，禁用/重定向其他 URL 的最佳方法是什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:31:18.477

这完全取决于您的路由器的实现。如果您可以在控制器中访问原始 URL，您可以比较它并在需要时发出重定向：

```
class PagesController {

    function sitemap($request) {
        if ($request->url == '/info/sitemap/')
            $this->response->redirect('/sitemap/');

        //regular processing here
    }
} 
```

## 编辑

另一种选择，如果您的规则基于正则表达式，则添加“排除”模式，这将与模式`/info/sitemap/`不匹配`/info/{page}/`。

类似的东西：

```
$router->add(array(
    'url' => '/info/(?<action>.*)/',
    'controller' => 'PagesController',
    'exclude' => '(?:sitemap)',
)); 
```

# c++ - 将两个字节变成短字节时堆损坏。C++

> ID：15168334
> 
> 赞同：1
> 
> 时间：2013-03-01T23:05:04.887
> 
> 标签：c++, pointers, memory, dealloc, heap-corruption

我正在用 C++ 开发一个程序，并在运行此代码时遇到此错误：

```
short readshort() {
    short val=0;
    (&val)[1]=data.front(); data.pop_front();
    (&val)[0]=data.front(); data.pop_front();
    return val;
} 
```

这是我得到的错误：

```
Run-Time Check Failure #2 - Stack around the variable 'val' was corrupted. 
```

我现在应该提一下，“数据”是用 std::list 数据定义的；

我想我知道问题出在哪里，但我想不出一个简单的解决方案。我认为这个错误是由存储在堆栈中的“val”引起的，而不是作为指针。当我尝试通过“val”访问数据指针时，出现此错误。

我想到的解决方案是像这样分配“val”：

```
short readshort() {
    short* val=new short;
    val[1]=data.front(); data.pop_front();
    val[0]=data.front(); data.pop_front();
    return *val;
} 
```

但是一旦我返回它，我就看不到删除“val”的方法，而不必每次都在函数之外删除它。有没有办法在 C++ 中做到这一点而不会发生内存泄漏？我之前没有看到有人使用 "(&val)[1]" 将变量类型（例如short）拆分为字节，我想知道这是因为它引起了许多问题，还是它不是一种已知的方法?

回到真正的问题，我怎样才能把这两个字节变成短（或大数据类型）？还有比我尝试过的更好的方法吗？

最后一件事，我知道 java 有一个自动垃圾收集器，可以自动清理内存泄漏。C++ 是否提供相同类型的设备？我听说过一些关于智能指针的事情，但我不知道它们是什么；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:11:24.977

这是安全和简单的：

```
int16_t readshort()
{
    union { int16_t s; char val[2]; } u;
    u.val[1]=data.front(); data.pop_front();
    u.val[0]=data.front(); data.pop_front();
    return *(int16_t*)u.val;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:11:34.103

您需要将指针转换为 char*。

```
((char *)(&val))[1]=data.front();
((char *)(&val))[0]=data.front(); 
```

我认为在你的情况下： (&val)[1]=data.front(); 您将数据写入第二个短路。结果你得到错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T23:08:36.437

`(&val)[1]=data.front()``(&val)[1]`您正在将下一个内存位置写入`val`未定义的错误。

`(&val)[i]`意味着=这很好`*(&val + i )`
`(&val)[0]`意味着= 但这是错误的，因为您的声明是这样我们只能访问 val 位置。`*(&val + 0 )``*(&val)`
`(&val)[1]``*(&val + 1 )``short val`

```
+----+----+----+---+---+----+----+----+---+----+ 
|val      |        |
+----+----+----+---+---+----+----+----+---+---+----+  
 201   202  203 204 205 206  207   208 209 210  211
  ^           ^ 
   |          |
 &val         (&val + 1) 
              its not defined. 
```

你可以像@Carl Norum 建议的那样使用tyoecase。我只是在写第二种形式来做到这一点。

```
char *ptr = (char*)&val;

ptr[0]=data.front()
ptr[1]=data.front() 
```

但是，如果您需要`val`很短并且想要访问单个字节。我想建议`union`：

```
union Data{
 short val;
 char ch1;
 char ch2;
};

union Data d; 

d.ch1 = data.front()
d.ch2 = data.front() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T23:07:32.400

`(&val)[1]`访问您没有分配的内存。Bam - 未定义的行为。你的两个例子都有同样的问题。

如果要像这样拆分字节，则需要使用`char`指针来访问各个字节：

```
short readshort() {
    short val=0;
    ((char *)&val)[1]=data.front(); data.pop_front();
    ((char *)&val)[0]=data.front(); data.pop_front();
    return val;
} 
```

不过，这段代码真的很丑。为什么不只是：

```
short readshort() {
    short val=0;
    val  = data.front() << 8; data.pop_front();
    val |= data.front() << 0; data.pop_front();
    return val;
} 
```

根据字节顺序，您可能需要交换`8`and的位置`0`。

# php - php：我的访客来自本地网络吗？

> ID：15168337
> 
> 赞同：1
> 
> 时间：2013-03-01T23:05:22.570
> 
> 标签：php, apache, networking, ip, local

我有一个带有 LAMP 服务器的小型家庭网络。我从这两个主题中知道：

[如何确定访问者的ip？](https://stackoverflow.com/questions/872386/how-to-make-sure-about-the-ip-of-the-visitor) 和 [PHP：如何检查客户端是否是本地的？](https://stackoverflow.com/questions/6999175/php-how-to-check-if-the-client-is-local)

有多种方法可以确定我的访问者的一些关于 ip 的信息。但是是否有可能使用 PHP 100% 确定我的访问者来自本地网络？我想让我的网站在我的 192.168.0.* 网络上免费可用，并且密码不受其他人的保护。而且我不关心我的本地网络中偶尔有人由于使用代理或其他原因而被迫提供额外凭据的情况。我只是想让 100% 确保外部人员会被要求输入密码。

或者换一种说法：对于我本地网络之外的潜在黑客，是否有可能欺骗 Apache 认为访问者是本地的？

通常，识别访问者 ip 的任何努力都是针对自定义网站的外观或语言，但是出于上述安全原因，是否可以使用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:10:25.843

```
<?php
/**
 * Check if a client IP is in our Server subnet
 *
 * @param string $client_ip
 * @param string $server_ip
 * @return boolean
 */
function clientInSameSubnet($client_ip=false,$server_ip=false) {
    if (!$client_ip)
        $client_ip = $_SERVER['REMOTE_ADDR'];
    if (!$server_ip)
        $server_ip = $_SERVER['SERVER_ADDR'];
    // Extract broadcast and netmask from ifconfig
    if (!($p = popen("ifconfig","r"))) return false;
    $out = "";
    while(!feof($p))
        $out .= fread($p,1024);
    fclose($p);
    // This is because the php.net comment function does not
    // allow long lines.
    $match  = "/^.*".$server_ip;
    $match .= ".*Bcast:(\d{1,3}\.\d{1,3}i\.\d{1,3}\.\d{1,3}).*";
    $match .= "Mask:(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})$/im";
    if (!preg_match($match,$out,$regs))
        return false;
    $bcast = ip2long($regs[1]);
    $smask = ip2long($regs[2]);
    $ipadr = ip2long($client_ip);
    $nmask = $bcast & $smask;
    return (($ipadr & $smask) == ($nmask & $smask));
}
?> 
```

[资源](http://php.net/manual/en/function.ip2long.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:12:00.333

如果您可以进行这样的安全设置，则取决于您的防火墙（如果有的话）。在 PHP 上没有那么多。

阅读 IP 欺骗。 [IP 地址欺骗 - 维基百科](http://en.wikipedia.org/wiki/IP_address_spoofing)

更好的方法是将该网络服务器放在托管服务提供商上，并且只允许您的外部 IP 访问。但这也不是真正的 100% 安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T01:40:20.050

这应该使用满足指令从 apache 完成。您必须确保在您的 apache.conf 中设置了 AllowOverride，然后在您的 .htaccess 中您可以执行以下操作（或者您可以将其放在虚拟主机的指令中。

```
AuthType Basic
AuthName "Private Site"
AuthUserFile /etc/httpd/conf.d/htpasswd/www.example.com
Order deny,allow
Allow from 192.168.0.0/16
Deny from all
Require valid-user
Satisfy Any 
```

他们可以绕过这个的唯一方法是如果他们以某种方式从内部网络代理。

# java - 在@Embeddable 类中使用@Embedded

> ID：15168339
> 
> 赞同：9
> 
> 时间：2013-03-01T23:05:32.153
> 
> 标签：java, spring, hibernate, jakarta-ee, jpa

我可以在休眠的@Embeddable 类中使用@Embedded。

示例：A 是不同类中的元素集合。

```
@Embeddable
class A {

    @Embedded
    B b;
}

@Embeddable
class B {

    @Embedded
    C c;
}

@Embeddable
class C {

    @Embedded
    D D;
}

@Embeddable
class D {

} 
```

这种东西在休眠中有效吗？第三层嵌套。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T23:55:36.163

是的，在 Hibernate 中嵌套 @Embedded 对象是有效的。

直接来自文档（[http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html_single/#d0e714](http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html_single/#d0e714)）：

```
@Entity
public class Person {

    @Embedded
    Address homeAddress;
}          

@Embeddable
public class Address {

    @Embedded
    Country nationality;
}            

@Embeddable
public class Country {
    ...
} 
```

（删除了额外的代码以突出嵌套@Embedded）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-01T10:54:06.430

正如约翰卡尔所说，这是可能的。为了重命名嵌套属性，您必须使用“。”指定整个链。作为分隔符。例如，如果类 D 具有属性*foo*，那么在类 A 中，您需要将其重命名为：

```
@Embedded
@AttributeOverride(name = "c.D.foo", column = @Column(name = "bar"))
B b; 
```

# android - ActionBarSherlock onTouchListener()

> ID：15168340
> 
> 赞同：0
> 
> 时间：2013-03-01T23:05:49.970
> 
> 标签：android, android-actionbar, swipe, gesture, ontouchlistener

是否有可能在 ActionbarSherlock 上收听触摸手势？我想识别操作栏上的滑动手势，以便从显示屏顶部“下拉”下拉菜单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T01:38:16.703

您可以检测整体的手势`Activity`，您可以在其中实现`onTouchEvent()`回调和使用`GestureDetector`。

只为操作栏检测触摸和手势是有问题的。

AFAIK，操作栏不会公开其视图。所以没有用于附加`OnTouchListener`到本机操作栏的 api。除非您对 ActionBar 的私有部分进行一些黑客攻击，否则它不会在那里工作。或者您可以使用操作栏中的 来创建自定义视图`OnTouchListener`，然后您可以检测自定义视图区域中的触摸。您可以将自定义视图设置为占据操作栏的整个区域。

类似的情况也成立`ActionBarSherlock`（它用于所有版本直到 Android 3.2）。但这里的情况更有利，因为它是您添加到项目中的库，您可以随意随意操作它，并且可以轻松访问它的私有部分。`ActionBarSherlock`通过向窗口内容添加一些额外的视图来模仿本机操作栏。您可以访问这些视图并附`OnTouchListener`加到它们（您可能会使用`R.id.abs__action_bar`or `R.id.abs__action_bar_container`）。

# javascript - 禁用 Aloha 编辑器侧边栏

> ID：15168342
> 
> 赞同：2
> 
> 时间：2013-03-01T23:05:55.460
> 
> 标签：javascript, aloha-editor

我想禁用[Aloha 编辑器](http://aloha-editor.org/)侧边栏。我在各个地方都看到了以下代码，这对我不起作用：

```
Aloha.settings = {
  sidebar: { disabled: true }
}; 
```

如果我在调用*后*`aloha()`添加它，则不会发生任何事情并且侧边栏仍然存在。如果我在调用元素*之前*`aloha()`添加它，我会收到以下错误：

```
Uncaught TypeError: Cannot read property 'getContents' of undefined 
```

`Aloha.ready`如果我将调用上方的代码移至`Aloha.ready`.

如果有帮助，这里是我正在加载的文件`<head>`：

```
<script src="http://cdn.aloha-editor.org/latest/lib/require.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="http://cdn.aloha-editor.org/latest/lib/aloha.js" data-aloha-plugins="common/ui, common/format, common/list, common/link, common/highlighteditables, common/horizontalruler, common/undo, common/paste"></script>
<link href="http://cdn.aloha-editor.org/latest/css/aloha.css" rel="stylesheet" type="text/css" /> 
```

（我目前正在添加[一些 CSS](http://pastebin.com/BFFZkDsL)，感觉不对。我更喜欢更好的解决方案。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-02T12:07:46.090

在调用**之前**运行 JS 进行设置`aloha.js`：

```
<script>
Aloha = {};
Aloha.settings = { sidebar: { disabled: true } };
</script>
<script src="aloha/lib/vendor/require.js"></script>
<script src="aloha/lib/aloha.js"></script> 
```

# c++ - 可以将原型 OOP 视为 C++ 中的范式吗？

> ID：15168347
> 
> 赞同：4
> 
> 时间：2013-03-01T23:06:11.890
> 
> 标签：c++, c++11, prototype, paradigms

再会，

考虑以下代码，是否可以将原型 OOP 归类为

C++？

```
#include <iostream>

template< class... Bases >
struct TestClass : public Bases...
{
    int a;
    template< class... Parents >
    TestClass< Parents... >* Create() {
        return new TestClass< Parents... >();
    }
    TestClass< Bases... >* Create() {
        return new TestClass< Bases... >();
    }
};
struct Foo {
    int fizz;
};
struct Bar {
    int buzz;
};
int main()
{
    TestClass< Foo > a;
    a.a = 10;
    a.fizz = 20;
    std::cerr << a.fizz << "\n";
    std::cerr << a.a << "\n";
    auto b = a.Create();
    b->fizz = 30;
    std::cerr << b->fizz << "\n";
    auto c = b->Create< Bar >();
    c->buzz = 357;
    std::cerr << c->buzz << "\n";
    auto d = b->Create< Foo, Bar >();
    d->fizz = 0;
    d->buzz = 1;
    std::cerr << d->fizz << "\n";
    std::cerr << d->buzz << "\n";
    return 0;
} 
```

仅供参考，我忘了管理我的记忆，对不起！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T23:13:28.017

不，我不这么认为。“原型”和“经典”OO 之间的主要区别在于原型 OO 没有类：原型本身就是一个对象。如果原型被修改，所有从它“继承”的对象都会效仿。在此示例中，情况并非如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T23:33:48.247

我不禁注意到很多困惑。

1.  成员函数模板“创建”实际上并没有

    *   与 TestClass 实例有任何关系（应该是静态的）
    *   与包含 TestClass 的*模板参数*有任何关系（应该是命名空间函数，而不是类模板的成员）
2.  非泛型`Create`方法应使用“注入”类型名称，而不是不必要地拼写模板参数

3.  没有多态使用，所以不要不必要的动态分配或原始指针（这也解决了内存清理的问题）

4.  次要问题：*尝试在示例中使用较少混淆的名称和格式*

这是我的等价物：

```
template< class... Bases >
struct TestClass : public Bases... {
    int testfield;
    TestClass Create() {
        return TestClass();
    }
};

template< class... Parents >
static TestClass< Parents... > CreateTestClass() {
    return TestClass<Parents... >();
}

struct Fizzer {
    int fizz;
};
struct Buzzer {
    int buzz;
};
int main()
{
    TestClass< Fizzer > fizzer;
    fizzer.testfield = 10;
    fizzer.fizz = 20;

    auto b = fizzer.Create();
    b.fizz = 30;

    auto c = CreateTestClass< Buzzer >();
    c.buzz = 357;

    auto d = CreateTestClass< Fizzer, Buzzer >();
    d.fizz = 0;
    d.buzz = 1;
} 
```

而且，不，我不认为这段代码是“惯用的”。我还没有看到它（尽管它可能类似于一个类似元组的类的简单实现。无论如何，这不是惯用的：惯用的是**不**编写这样的类，而是编写 std::tuple （boost 有几种口味扩展名）

# python - 为什么此 CSV 转换作为每个数组元素中的单个元素返回

> ID：15168356
> 
> 赞同：-2
> 
> 时间：2013-03-01T23:06:58.050
> 
> 标签：python, csv

到目前为止，这是我尝试过的：

```
import csv
print "Dennis"
with open('Example1.csv', 'rb') as csvfile: 
    dialect = csv.Sniffer().sniff(csvfile.read(1024))
    csvfile.seek(0)
    reader = csv.reader(csvfile, dialect)
    # ... process CSV file contents here ...
    print reader
    try:
        for row in reader:
            #print row
            print row[0],   row[1],   row[2]    #FAILS HERE
    except csv.Error as e:
        #skip

print "ended" 
```

CSV lib 似乎对转换后的数据进行了如下转换和打包。

```
['GB0002875804,ABIH RIAN TCO ORD,"191,560.00000"']
['GB0002374006,DIO ORD 28 101/108P,"440,274.00000"']
['GB00B03MLX29,ROY DUH ELL PLC,"310,437.00000"'] 
```

这就像单个元素中的多个元素和单个数组元素中的单个元素。是什么赋予了？

我希望得到如下转换。

```
[GB0002875804,ABIH RIAN TCO ORD,"191,560.00000"]
[GB0002374006,DIO ORD 28 101/108P,"440,274.00000"]
[GB00B03MLX29,ROY DUH ELL PLC,"310,437.00000"] 
```

这样我必须提取单个元素，然后提取逗号分隔值。有没有更直接的方法来转换以获得所需的转换，如我在上面的第二个数据示例中所示，没有单引号包？

非常感谢，

丹尼斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:53:03.687

您使用 csvsniffer 混淆了 csv 阅读器。结果是整行都没有被分成一个元素列表。然后，当您尝试打印（访问）不存在的`row`.

只需使用默认值并`['`从第一个元素和最后一个元素中手动删除逗号和`']`。我的代码假设没有前导或尾随空格；剥去那些他们在那里。

所以，有了这个文件：

```
$ cat /tmp/dennis.csv
['GB0002875804,ABIH RIAN TCO ORD,"191,560.00000"']
['GB0002374006,DIO ORD 28 101/108P,"440,274.00000"']
['GB00B03MLX29,ROY DUH ELL PLC,"310,437.00000"']
['GB0008762899,BG GP PC OD G0.10,"486,049.00000"']
['GB0008762899,BG GUP C ORD P0.10,"504,867.00000"']
['GB0005405286,BC HL OR D0.50 (K),"1,751,079.00000"']
['GB0009252882,GAITHNE OD P0.25,"806,535.00000"']
['GB00B16GWD56,VNE GRP,"7,254,981.00000"'] 
```

这解决了您的问题（据我了解）：

```
import csv

LoL=[]
with open('/tmp/Dennis.csv', 'rb') as csvfile:
    reader = csv.reader(csvfile)
    try:
        for row in reader:
            row[0]=row[0].replace("['","")
            row[2]=float(row[2].replace("']","").replace(',',''))
            LoL.append(row)
            print ''.join('{}[{}]:{} '.format('row',i,e) for i,e in enumerate(row))

    except (csv.Error, ValueError) as e:
        print 'something bad happened...\ndying now...\n',e

print LoL 
```

印刷：

```
row[0]:GB0002875804 row[1]:ABIH RIAN TCO ORD row[2]:191560.0 
row[0]:GB0002374006 row[1]:DIO ORD 28 101/108P row[2]:440274.0 
row[0]:GB00B03MLX29 row[1]:ROY DUH ELL PLC row[2]:310437.0 
row[0]:GB0008762899 row[1]:BG GP PC OD G0.10 row[2]:486049.0 
row[0]:GB0008762899 row[1]:BG GUP C ORD P0.10 row[2]:504867.0 
row[0]:GB0005405286 row[1]:BC HL OR D0.50 (K) row[2]:1751079.0 
row[0]:GB0009252882 row[1]:GAITHNE OD P0.25 row[2]:806535.0 
row[0]:GB00B16GWD56 row[1]:VNE GRP row[2]:7254981.0 
[['GB0002875804', 'ABIH RIAN TCO ORD', 191560.0], ['GB0002374006', 'DIO ORD 28 101/108P', 440274.0], ['GB00B03MLX29', 'ROY DUH ELL PLC', 310437.0], ['GB0008762899', 'BG GP PC OD G0.10', 486049.0], ['GB0008762899', 'BG GUP C ORD P0.10', 504867.0], ['GB0005405286', 'BC HL OR D0.50 (K)', 1751079.0], ['GB0009252882', 'GAITHNE OD P0.25', 806535.0], ['GB00B16GWD56', 'VNE GRP', 7254981.0]] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:21:33.757

你不需要遍历列吗？IE：

```
for row in reader:
          for col in row:
            print  col 
```

# java - 为什么 Hibernate 4.2 使用 jandex 和 classmate 如果它的 Maven POM 将它们定义为测试范围？

> ID：15168365
> 
> 赞同：3
> 
> 时间：2013-03-01T23:07:33.250
> 
> 标签：java, hibernate, classmate

我正在使用 Hibernate 开发一个简单的示例，在任何容器之外使用它。我正在使用 Maven，因此配置了 JBoss 存储库（请参阅[https://community.jboss.org/wiki/MavenGettingStarted-Users](https://community.jboss.org/wiki/MavenGettingStarted-Users)）并将以下依赖项添加到我的项目的 POM 中：

```
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-core</artifactId>
    <version>4.2.0.CR1</version>
</dependency>
<dependency>
    <groupId>com.h2database</groupId>
    <artifactId>h2</artifactId>
    <version>1.3.170</version>
</dependency> 
```

然后我继续配置 Hibernate 以使用这样的 H2 数据库（文件 hibernate.cfg.xml）：

```
<?xml version='1.0' encoding='utf-8'?>
<hibernate-configuration xmlns="http://www.hibernate.org/xsd/hibernate-configuration">
    <session-factory>
        <property name="hibernate.connection.driver_class">org.h2.Driver</property>
        <property name="hibernate.connection.url">jdbc:h2:mem:db1;DB_CLOSE_DELAY=-1;MVCC=TRUE</property>
        <property name="hibernate.connection.username">sa</property>
        <property name="hibernate.connection.password"></property>

        <property name="hibernate.connection.pool_size">1</property>
        <property name="hibernate.dialect">org.hibernate.dialect.H2Dialect</property>
        <property name="hibernate.cache.provider_class">org.hibernate.cache.internal.NoCacheProvider</property>
        <property name="hibernate.show_sql">true</property>
        <property name="hibernate.hbm2ddl.auto">update</property>
    </session-factory>
</hibernate-configuration> 
```

最后，我为一个简单的联系人类创建了一个 POJO，如下所示：

```
@Entity
public class Contact {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    @Basic
    private String name;

    @Basic
    private String email;

    /* Getters and setters omitted for brevity. */
} 
```

最后，我创建了一个获取会话工厂、会话并最终持久化实体的类。代码如下：

```
 ServiceRegistry registry = new ServiceRegistryBuilder().configure().buildServiceRegistry();
    MetadataSources sources = new MetadataSources(registry);
    sources.addAnnotatedClass(Contact.class);
    Metadata metadata = sources.buildMetadata();
    sessionFactory = metadata.buildSessionFactory();

    Contact contact = new Contact();
    /* Set some attributes. */

    Session session = sessionFactory.openSession();
    session.save(contact);
    session.close(); 
```

当我运行此代码时，这就是我得到的：

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/jboss/jandex/Indexer
    at org.hibernate.metamodel.source.annotations.AnnotationMetadataSourceProcessorImpl.prepare(AnnotationMetadataSourceProcessorImpl.java:78)
    at org.hibernate.metamodel.source.internal.MetadataImpl.prepare(MetadataImpl.java:177)
    at org.hibernate.metamodel.source.internal.MetadataImpl.<init>(MetadataImpl.java:162)
    at org.hibernate.metamodel.source.internal.MetadataBuilderImpl.buildMetadata(MetadataBuilderImpl.java:83)
    at org.hibernate.metamodel.MetadataSources.buildMetadata(MetadataSources.java:112) 
```

调查`org.hibernate/hibernate-core`我添加到项目中的依赖项的 POM，我可以看到它依赖于`org.jboss/jandex 1.0.3.Final`. 满足这种依赖性，我现在得到了一个`NoClassDefFoundError: com/fasterxml/classmate/TypeResolver`. 回到 Hibernate 的 POM，它依赖于`com.fasterxml/classmate 0.5.4`. 在我的项目中也满足了这种依赖关系，我终于能够在没有任何`NoClassDefFoundError`s 的情况下执行代码。

在 Hibernate 的 POM 中，jandex 和 classmate 都被定义为`test`依赖项，这就是为什么 Maven 的传递依赖解析功能不会将它们自动添加到我的项目中的原因。但是，为什么在我运行简单代码时需要它们？我究竟做错了什么？

在此先感谢您的任何指点。- 维托

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-02T03:32:29.457

主要的 Hibernate 功能不需要 Jandex 和 Classmate。然而，它们是元数据生成所必需的（[参考](http://lists.jboss.org/pipermail/hibernate-issues/2012-January/037123.html)）。为了不破坏不使用元数据生成的人，他们将依赖项添加为测试依赖项。如果您正在使用元数据生成，则需要获取这些依赖项。

# jakarta-mail - 基于电子邮件启动 BPM 应用程序

> ID：15168370
> 
> 赞同：0
> 
> 时间：2013-03-01T23:07:51.323
> 
> 标签：jakarta-mail, jnotify

我正在寻找可以为我的业务流程管理 (BPM) 应用程序侦听外部事件（即电子邮件）的工具/框架。我知道那里有很多 ESB 工具，它可能很有用，但我正在寻找 ESB 以外的工具/框架。例如： http: [//jnotify.sourceforge.net/](http://jnotify.sourceforge.net/) 或 Java 邮件 API [http://www.oracle.com/technetwork/java/javamail/index-138643.html](http://www.oracle.com/technetwork/java/javamail/index-138643.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T13:06:59.547

我建议使用提供规则和事件 API 的 Jboss Drools。使用它们可以管理各种类型的事件，并根据定义的规则调用业务流程

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T02:26:59.713

您当然可以编写一个程序，使用 JavaMail 来监视某种类型的电子邮件，然后执行一些操作，但听起来您正在寻找更“即插即用”的东西。

# batch-file - 创建映射驱动器，然后将内容复制到

> ID：15168373
> 
> 赞同：0
> 
> 时间：2013-03-01T23:08:11.157
> 
> 标签：batch-file

我在 .bat 文件中遇到了一个命令问题。我正在为第一个可用设备创建映射驱动器。然后我想将该网络共享中的一个文件夹复制到 C:\temp 中的某个位置。这是我目前所在的位置。

```
net use * \\SomeComputer\exp\Reinstaller_PROD\TunerReinstPROD
copy \*.TunerReinstPROD  "C:\\temp%~p1" 
```

我试图将内容复制到 C:\temp。我错过了什么？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T00:12:05.277

该`net use`命令不会直接更改工作，因此除非直接工作已设置为`\\SomeComputer\exp\Reinstaller_PROD\TunerReinstPROD`复制命令，否则将`*.TurnerReinstPROD`在错误的位置查找。

做这样的事情：（我正在将工作目录更改为新映射的驱动器。）

```
@echo off
for /f "tokens=1,2" %%A in ('net use * \\SomeComputer\exp\Reinstaller_PROD\TunerReinstPROD') do if "%%A"=="Drive" pushd %%B
copy *.TunerReinstPROD "C:\Temp%~p1"
popd 
```

`xcopy`但是，如果您使用or`robocopy`命令，您甚至不需要映射驱动器。

```
@echo off
xcopy \\SomeComputer\exp\Reinstaller_PROD\TunerReinstPROD\*.TunerReinstPROD "C:\Temp%~p1" 
```

# jquery - jquery 可调整大小：动态 minHeight

> ID：15168377
> 
> 赞同：1
> 
> 时间：2013-03-01T23:08:42.527
> 
> 标签：jquery, html, css, jquery-ui-resizable

我怎样才能有一个`minHeight`基于内部容器的动态？我有：

```
<div id="outer-div" >
    <div id="inner-div"></div>
</div> 
```

然后在 jQuery 上：

```
$( "#outer-div" ).resizable({
    containment: "#another-outer-div",
    minWidth: 200,
    minHeight: $('#inner-div').height(),
    resize: function(event, ui) {
        ui.size.width += (ui.size.width - ui.originalSize.width);
        $(this).position({
            of: $("#another-outer-div"),
            my: "center center",
            at: "center center"
        })
    }
}); 
```

以上`minHeight`不工作，但希望你明白我想做什么；可调整大小的高度`div`不应小于`div`具有内容的内部。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-24T06:39:50.360

我认为这就是您要搜索的内容：

```
$("#outer-div").resizable({
    containment: "#another-outer-div",
    minWidth: 200,
    start: function(event,ui) {
        $("#outer-div").css({
            minHeight: $('#inner-div').outerHeight()
        });
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:15:58.173

我从来没有弄乱 ui-resizable 但这是我设置最小高度的方式，以便内容延伸到底部。

```
adjustedHeight = (the equation for min-height);
$(".stretchClass").css({'min-height':(adjustedHeight+'px')}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-09T13:38:00.140

我意识到这已经很老了，但是在初始化期间，您只能为 minHeight 和 minWidth 分配一个整数。您不能使用查询。正确的方法是修改“start”-Handler 中的 minHeight 或 minWidth 选项，如下所示：

```
$( "#outer-div" ).resizable({
    containment: "#another-outer-div",
    minWidth: 200,
    minHeight: $('#inner-div').height(),
    start: function(event,ui) {
        var myMinHeight = $('#inner-div').height();
        $( "#outer-div" ).resizable( "option", "minHeight", myMinHeight );
    },
    resize: function(event, ui) {
        ui.size.width += (ui.size.width - ui.originalSize.width);
        $(this).position({
            of: $("#another-outer-div"),
            my: "center center",
            at: "center center"
        })
    }
}); 
```

# c++ - 静态数组，允许可变大小？

> ID：15168385
> 
> 赞同：-2
> 
> 时间：2013-03-01T23:09:25.493
> 
> 标签：c++

我有这样的功能

```
void foo(int i)
{
   ...
   uint8_t buf[i];
   ...
}

```

而且我不明白为什么编译器没有抱怨......我正在使用

```
g++ -c -g -墙
```

编译

有任何想法吗？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:11:31.933

它是一个[GCC 编译器扩展](http://gcc.gnu.org/onlinedocs/gcc/Variable-Length.html)。标准允许符合标准的实现，因为它不会破坏任何格式良好的代码（只要它发出诊断）。当然，它不是便携式的，因此不推荐使用。

使用该`-pedantic`选项，您将收到以下警告：

```
warning: ISO C++ forbids variable length array ‘buf’ [-Wvla] 
```

# c# - 将 XML 序列化为文件导致畸形？

> ID：15168386
> 
> 赞同：0
> 
> 时间：2013-03-01T23:09:29.803
> 
> 标签：c#, xml, serialization, xml-serialization

我正在尝试序列化 XML 并创建一个文件。我正在从使用 xsd.exe 从 XSD 自动生成的对象进行序列化。该文件处理并创建得很好。但是，每当我针对验证工具运行它时，我都会收到错误**Content Not Allowed In Prolog**

我的猜测是在 xml 声明之前有一些格式错误的字符，但我看不到它们，也看不到那里的任何字节。这是我序列化和创建 XML 文档的代码：

```
XmlSerializer ser = new XmlSerializer(typeof(ContinuityOfCareRecord));
            XmlWriterSettings settings = new XmlWriterSettings()
            {
                Encoding = Encoding.UTF8,
                ConformanceLevel = ConformanceLevel.Document,
                OmitXmlDeclaration = false,
                Indent = true,
                NewLineChars = "\n",
                CloseOutput = true,
                NewLineHandling = NewLineHandling.Replace,
                CheckCharacters = true
            };
using (XmlWriter myWriter = XmlWriter.Create(ms, settings))
            {
                myWriter.Flush();
                //myWriter.WriteProcessingInstruction("xml-stylesheet", "type=\"text/xsl\" href=\"ccr.xsl\"");
                ser.Serialize(myWriter, myCCR);
            } 
```

看起来很简单，但是如果输出 XML 文件的开头有格式错误的字符，我该如何删除这些字符？

XML 文档的**开头**是这样的：

`<?xml version="1.0" encoding="utf-8"?> <ContinuityOfCareRecord xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="urn:astm-org:CCR"> <CCRDocumentObjectID>testccr</CCRDocumentObjectID> <Language>`

看起来是正确的，但验证器就是不喜欢它。我整天都在办公桌上敲着头，所以任何示例代码都会非常有帮助！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:45:54.020

看起来像 BOM 字符的问题，以这种方式编写代码可以帮助：

```
using (XmlTextWriter myWriter = new XmlTextWriter(ms, new System.Text.UTF8Encoding(false)))
        {
            myWriter.Flush();
            //myWriter.WriteProcessingInstruction("xml-stylesheet", "type=\"text/xsl\" href=\"ccr.xsl\"");
            ser.Serialize(myWriter, myCCR);
        } 
```

这将删除 BOM 字符，并且文件将在没有 BOM 的情况下以 UTF-8 编码。

# c# - 跨 AppDomain 异步方法调用

> ID：15168390
> 
> 赞同：6
> 
> 时间：2013-03-01T23:09:57.163
> 
> 标签：c#, appdomain, async-await

从主 AppDomain，我试图调用在不同 AppDomain 中实例化的类型中定义的异步方法。

例如，以下类型`MyClass`继承自`MarshalByRefObject`并在新的 AppDomain 中实例化：

```
public class MyClass : MarshalByRefObject
{
  public async Task<string> FooAsync()
  {
     await Task.Delay(1000);
     return "Foo";
  }
} 
```

在主 AppDomain 中，我创建了一个新的 AppDomain 并在此 AppDomain 中创建了 MyClass 的一个实例，然后我调用了 async 方法。

```
var appDomain = AppDomain.CreateDomain("MyDomain");
var myClass = (MyClass)appDomain.CreateInstanceAndUnwrap(typeof(MyClass).Assembly.FullName, typeof(MyClass).FullName);
await myClass.FooAsync(); // BAM ! 
```

当然，`SerializationException`当我尝试进行调用时，我得到了一个，因为`Task`类型不继承自`MarshalByRefObject`，也不是可序列化的。

我怎么能解决这个问题？我真的很希望能够从另一个 AppDomain 中实例化的类型调用/等待异步方法......有没有办法？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-09-10T06:49:34.410

我知道这个问题已有 7 年历史，但如果有人觉得这有帮助：

如今，一个简单的解决方案可能是调用同步方法`Task.Run`并等待该`Task.Run`方法。

而不是：

```
await RemoteObject.MethodAsync(); //Still throws a SerializationException. 
```

利用：

```
await Task.Run(RemoteObject.Method); //If the method has no parameters.
await Task.Run(()=>RemoteObject.Method(parameter)); // If it does. 
```

您可以获取方法的返回值（如果它不是 void，并且它的返回类型可以跨 AppDomains）：

```
var result = await Task.Run(RemoteObject.GetDefaultValue); // If the method has no parameters.
var result = await Task.Run(()=>RemoteObject.GetValue(parameter)); // If it does. 
```

`Task.Run``Task.Run<returnType>`当委托具有非 void 返回类型时将隐式变为（委托本身将变为 a`Func`而不是 a `Action`）。如果您使用方括号创建 lambda 表达式，那么您必须手动返回该方法的结果以暗示它是 a`Func`而不是 a `Action`：

```
var result = await Task.Run(()=>{ return RemoteObject.GetValue(parameter); }); 
```

# javascript - 对话框完全加载时的事件

> ID：15168391
> 
> 赞同：0
> 
> 时间：2013-03-01T23:10:06.723
> 
> 标签：javascript, jquery

加载对话框后，我正在尝试将 jscrollpane 添加到对话框中。我尝试使用`dialogopen`and`dialogfocus`事件，但似乎这些触发太早了。是否有一个我可以订阅的事件告诉我对话框已完全加载并显示并且可以安全地调用 jscrollpane？现在我只是添加了一个半秒的超时时间，但这看起来很笨拙，并向用户显示了一个半秒的损坏对话框。

任何其他解决方案也将受到欢迎。

```
$("#diagBox").load($(this).attr('href'), function() {
        $dialog.imagesLoaded(function() {

            $dialog.dialog('open');
            $dialog.dialog("option", "position", "center");
            setTimeout(function(){
                $('input, textarea').placeholder();
                $('.scroller').jScrollPane();
                positionElements();
            },500);

        });
    }); 
```

# cakephp - Cakephp - 在视图和控制器中可访问的一个变量

> ID：15168392
> 
> 赞同：5
> 
> 时间：2013-03-01T23:10:08.707
> 
> 标签：cakephp, variables, global

我想定义一个可以`AppController`在默认布局中使用的数组。

我怎样才能在 CakePHP 中做到这一点？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-02T03:37:44.613

```
$this->set('arr', array('one', 'two'));

// Accessible in controller as 
$this->viewVars['arr'];

// Accessible in view/layout as
echo $arr; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T07:24:03.327

如果您在 AppController beforeRender() 函数中设置任何变量，并设置该变量，那么您可以在视图文件的任何位置轻松访问该变量

```
function beforeRender() {
    parent::beforeRender();
    $sample_arr = array("abc","xyz");
    $this->set('sample_arr',$sample_arr);
} 
```

在您的布局文件中，只需像这样打印该数组

```
print_r($sample_arr); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:12:47.317

从这里：

[cakephp设置函数](http://book.cakephp.org/2.0/en/controllers.html)

```
// First you pass data from the controller:

$this->set('color', 'pink');

// Then, in the view, you can utilize the data:
?>

You have selected <?php echo $color; ?> icing for the cake. 
```

所以对于你的情况：

```
$arr = array('stuff', 'more stuff');

$this->set('arr', $arr);

// then in the layout
print_r($arr); 
```

# asp.net-mvc - DataContext 与 DbContext 的实现？

> ID：15168395
> 
> 赞同：0
> 
> 时间：2013-03-01T23:10:14.347
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4

我正在尝试使用以下代码中的连接字符串删除和创建我的数据库：

```
// NOT WORKING: private ProjectDataSource _dataSource;
private DataContext _dataSource;

public void Initialize ()
{
// NOT WORKING: _dataSource = new ProjectDataSource(connectionString);
_dataSource = new DataContext(connectionString); 
_datasource.DeleteDatabase();
_datasource.CreateDatabase();
} 
```

如果我使用一个`DataContext`对象它可以工作，但是如果我使用我的实现`DbContext`，它不会。我使用 ProjectDataSource 得到“无法解析符号 DeleteDatabase”。这是`ProjectDataSource`：

```
public class ProjectDataSource : DbContext, IProjectDataSource
    {

        public ProjectDataSource() : base("DefaultConnection")
        {

        }

        public ProjectDataSource(string connectionString) : base("connectionString")
            {

            }

        public DbSet<Item> Items { get; set; }

        void IProjectDataSource.Save()
        {
            SaveChanges();
        }

        IQueryable<Item> IProjectDataSource.Items
        {
            get { return Items; }
        }

    } 
```

让这个工作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:15:01.543

您可以有一个将连接字符串作为参数的构造函数：

```
public ProjectDataSource(string connectionString) : base(connectionString)
{
} 
```

进而：

```
public void Initialize ()
{
    _dataSource = new ProjectDataSource(connectionString);
    _datasource.Database.Delete();
    _datasource.Database.Create();
} 
```

# wpf - WPF 用户控件数据绑定性能

> ID：15168402
> 
> 赞同：1
> 
> 时间：2013-03-01T23:11:24.970
> 
> 标签：wpf, data-binding, wpf-controls, dependency-properties

我希望有人可以帮助我解决这个问题：

我创建了一个 WPF 用户控件（称为 MainControl），它使用了几个其他用户控件（UserControlA 和 UserControlB）。这 2 个用户控件绑定到在我的 MainControl.xaml.cs 类中创建的依赖属性（MainControlDependencyProperty1 到 3）。那些 DP（在许多情况下）从 ViewModel 绑定到 DP。以下代码说明了这一点：

```
<StackPanel>

    <doesntmatter:UserControlA
        Property1="{Binding Path=MainControlProperty1, RelativeSource={RelativeSource AncestorType={x:Type views:MainControl}, Mode=FindAncestor}, Mode=OneWay}"
        Property2="{Binding Path=MainControlProperty2, RelativeSource={RelativeSource AncestorType={x:Type views:MainControl}, Mode=FindAncestor}, Mode=TwoWay}"
    />

    <doesntmatter:UserControlB
        Property2="{Binding Path=MainControlProperty2, RelativeSource={RelativeSource AncestorType={x:Type views:MainControl}, Mode=FindAncestor}, Mode=TwoWay}"
        Property3="{Binding Path=MainControlProperty3, RelativeSource={RelativeSource AncestorType={x:Type views:MainControl}, Mode=FindAncestor}, Mode=TwoWay}"
    />

</StackPanel> 
```

这样做我有一个独立的控件，可以在我的应用程序的几个不同部分中重用。我只是将它拖到 AXML 中，绑定正确的 DP 并且生活很好（我没有在上面存储任何数据）。UserControlsA 和 B 在其他几个地方也与 MainControl 分开使用。一切正常，但我想提高性能，所以我有几个问题：

1 – 将 UserControlsA 和 B 绑定到我的 MainControl 是否正确？我希望它完全独立于我的 ViewModel。我知道 DP 是在 WPF 中进行数据绑定的首选方法，但我不确定我是否以最好的方式（也是最快的方式）执行此操作。我做了一次，然后按照食谱做了……</p>

2 – 在某些情况下，我希望根本不使用 UserControlB。我使它不可见，但是当 ViewModel 中的 DP 更新时，控件中的绑定和其他所有内容仍在执行。是否有一种简单而轻松的方法来禁用 DP 或整个控件，以便我可以消除开销？（this.Disable=true；不要这样做）。我希望 UserControlB DP 表现得像不存在一样……</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T12:18:15.100

1) 是的，它是在 VisualTree 中将元素绑定在一起的正确方法。这是直接来自 Microsoft 的示例。如果你谷歌 ListView 你可以找到一个 MSDN 链接到这个：

```
<Style TargetType="ListViewItem">
    <!-- ListBox has a property called GridView and GridView is futhermore a class that has a property called Columns -->
    <!-- Within this setter you search your way up the visual tree till you find the colums of GridView. Then you bind those columns to yours -->
    <Setter Property="Columns" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListView}}, Path=GridView.Columns}"
    ...
</Style> 
```

在此示例中，称为 ListViewItems 的 ListView 的内部控件（稍后会显示填充了数据并分隔在不同列中的行）沿可视树向上绑定以找出用户设置的列。

2）如果您不想使用它并且不想在折叠时更新绑定，那么为什么要努力初始化它。控件的折叠状态意味着它不可见，但如果您希望在某个特定时间点显示控件，仍会收到更新。更新是指与数据、宽度和高度以及其他必要信息的绑定。

只需不要在开始时初始化控件，而是在需要时将其新初始化的实例注入 StackPanel。它叫`UI Virtualization`. 它经常在 ListBoxes 中使用。即使您可能有 10 000 项数据，ListBox 也只会初始化 14 个 ListBoxItems 控件，因为它们对您是可见的。稍后当您开始滚动时，ListBox 将破坏或加载更多/更少。

*PS：如果您想提高性能，请先使用性能分析器测量应用程序的行为。也许你不需要改进任何东西。或者，您可能需要购买一台新电脑。谁知道呢，探查器会。:PP*

# html - Firefox 中 CSS 之前的 HTML 加载

> ID：15168406
> 
> 赞同：0
> 
> 时间：2013-03-01T23:11:29.803
> 
> 标签：html, css, wordpress

我[的网站的](http://www.campfireinc.org/)Html 在 Firefox 中的 CSS 之前加载一瞬间。是因为我使用@import 吗？

我正在使用[带有子主题的 Foundation 3 Wordpress 主题](http://320press.com/wp-foundation/)。

谢谢你的帮助。

```
@import url("../wp-foundation/style.css");

@import url("css/nav.css"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:21:17.050

是的！

> 使用 @import 时，浏览器无法并行下载样式表，并在网页加载期间添加延迟。IE 中的 @import 行为类似于页面底部的 a。

[[1]](http://www.quora.com/Cascading-Style-Sheets/Why-is-the-import-CSS-method-so-slow)

所以直接链接。

# jakarta-ee - 在eclipse上设置JBoss应用服务器

> ID：15168411
> 
> 赞同：2
> 
> 时间：2013-03-01T23:11:45.587
> 
> 标签：jakarta-ee, jboss, application-server

我正在尝试在 Eclipse 中设置 jboss 应用程序服务器，但我遇到了一些问题。我在 Eclipse 中只安装了 jboss 工具。所以，我的问题的第一部分是单独的 jboss 工具是否足以设置服务器，或者我需要额外的安装。

我尝试过的是：*Window-> Show view-> View servers*。然后我点击*“新服务器向导”*并出现一个窗口。我选择*JBoss AS 7.1*（来自 JBoss 社区），然后单击*“下一步”*。这一点我不能过来，因为它需要填写*Home Directory*字段。我没有在那里指定什么，默认错误消息是：“主目录不存在或缺少所需的文件或文件夹：modules\org\jboss\as\server\main”。我应该下载并安装JBoss AS，然后指定安装目录吗？我的印象是它只能通过安装 JBoss Tools 来管理。到目前为止，我已按照以下说明进行操作：

[http://www.wi.uni-muenster.de/pi/lehre/ss11/eai/tutorials/tutorial_jboss_setup.html](http://www.wi.uni-muenster.de/pi/lehre/ss11/eai/tutorials/tutorial_jboss_setup.html)

和

[http://www.adichatz.org/joomla/index.php?option=com_content&view=article&id=36](http://www.adichatz.org/joomla/index.php?option=com_content&view=article&id=36)

任何其他具有完整和说明性说明的网站？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T23:14:16.300

Q：我应该下载安装JBoss AS，然后指定安装目录吗？

答：是的:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:19:37.207

是的，您需要安装 JBoss。也许这个链接可以帮助您[使用 JBoss Tools 从 Eclipse 启动 JBoss AS](https://docs.jboss.org/author/display/AS7/Starting+JBoss+AS+from+Eclipse+with+JBoss+Tools)。在文档的开头，它说“

> 为了在 Eclipse 中使用 JBoss AS，您必须首先为您的操作系统安装 JBoss AS，如在 Linux、Unix 或 Mac OS X 上安装和启动 JBoss AS 或在 Windows 上安装和启动 JBoss AS 中所述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-27T07:59:37.413

我有 Eclipse Indigo (3.7)，在那里我遇到了这个问题“modules\org\jboss\as\server\main”，但我找到了一个解决方法（只有在你的机器上也有最新的 Eclipse 版本时才有效）。

1.  注意 Indigo 中的当前工作区
2.  关闭靛蓝
3.  打开 Luna（即 Eclipse 4.4.1）
4.  给同一个工作空间
5.  设置 JBoss 服务器
6.  关闭月神
7.  打开 Indigo，您应该会在 Indigo 中看到相同的服务器 :)

# d3.js - 返回选定值 D3.js 的平均值/平均值

> ID：15168412
> 
> 赞同：3
> 
> 时间：2013-03-01T23:11:58.067
> 
> 标签：d3.js

我有这个 json 数组，它是使用 PHP 从 mySQL 数据库以这种格式返回的：

```
 [{"dateTimeTaken":"2013-02-28 05:04:16","reading":"10.7","parameterType":"Flouride"},
 {"dateTimeTaken":"2013-02-28 05:04:21","reading":"10.5","parameterType":"Flouride"},
 {"dateTimeTaken":"2013-02-28 05:04:26","reading":"15.1","parameterType":"pH"},
 {"dateTimeTaken":"2013-02-28 05:04:31","reading":"4.4","parameterType":"Temperature"}... 
```

我有两个下拉列表 - 用户将在其中选择 a）“parameterType”，然后 b）“月”。我想返回所选参数类型在所选月份内每一天的平均/平均读数。

不知道我如何在 D3 中做到这一点 - 但认为它可能类似于：

*   按参数类型和所选值的月份过滤数据
*   返回意思是“阅读”
*   相应地更新图表

不知道我是否完全不合时宜 - 或者我怎么能做到这一点？

**更新：**

```
 d3.select("#parameterType").on("change", function() { filterData(); });

    d3.select("#dateTimeTaken").on("change", function() { filterData(); });

    function filterData()
    {
        var selectedParameter = document.getElementById("parameterType").value;
        var selectedMonth = document.getElementById("dateTimeTaken").value;

        var selectedData = data.filter(function(d) 
        {
            return d.parameterType == selectedParameter &&
                    d.dateTimeTaken.getMonth() == (selectedMonth-1);
        });

        console.log(selectedData);//RETURNING EMPTY ARRAY?

        mean = d3.mean(selectedData,function(d) { return d.reading})

        //UPDATE GRAPH
        x.domain(d3.extent(data, function(d) { return d.dateTimeTaken; }));
        y.domain(d3.extent(data, function(d) { return d.reading; }));

        svg.select("path.line")
            .attr("d", line(data));

        svg.select(".x.axis")
            .transition()
            .duration(750)
            .ease("linear")
            .call(xAxis);

        svg.select(".y.axis")
            .transition()
            .duration(750)
            .ease("linear")
            .call(yAxis);   
    }
    });
    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T04:40:20.820

您正在寻找的是标准的 javascript Array.filter 方法：

请参阅[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter)

对于每个“重绘”，您将创建一个过滤子集：

```
 var selectedData = data.filter(function(d) {
    return d.parameterType == selectedParameter &&
           +d.dateTimeTaken.slice(5,7) == selectedMonth;
  }) 
```

并且平均值可以很容易地计算出来

```
mean = d3.mean(selectedData,function(d) { return +d.reading}) 
```

请注意，通过在变量前面加上加号 (+) 会尝试转换为数值。

但是此时您可能会意识到使用字符串格式的日期非常不方便。您可能会做的是在任何过滤之前进行一些预处理：

```
var dateFmt = d3.time.format("%Y-%m-%d %H:%M:%S");

data.forEach(function(d) {
  d.reading = +d.reading;  // convert to number
  d.dateTimeTaken = dateFmt.parse(d.dateTimeTaken);  // convert to javascript date
}); 
```

在这里，我使用 d3.time.format 功能将字符串日期转换为 javascript 日期（请参阅[https://github.com/mbostock/d3/wiki/Time-Formatting](https://github.com/mbostock/d3/wiki/Time-Formatting)）

在这种情况下，您的过滤器（见上文）会略有不同：

```
 var selectedData = data.filter(function(d) {
    return d.parameterType == selectedParameter &&
           +d.dateTimeTaken.getMonth() == (selectedMonth-1);
  }) 
```

请注意，因为 getMonth() 一月为 0，十二月为 11，所以我必须从 selectedMonth 中减去一个才能得到正确的比较。

# facebook - 发送 tp @Facebook.com 帐户的超链接更改为损坏的 fbsbx.com 重定向链接

> ID：15168415
> 
> 赞同：2
> 
> 时间：2013-03-01T23:12:07.593
> 
> 标签：facebook, hyperlink, message

发送到@Facebook.com 地址的电子邮件中的几乎所有超链接都被 fbsbx.com 重定向链接破坏。如果您将该链接中的 fbsbx.com 更改为 Facebook.com，则该链接有效，因此与该域有关。例如，当我通过电子邮件向自己发送此链接时：[http](http://news.cnet.com/8301-17938_105-57504786-1/the-weird-world-where-3d-printing-and-art-collide/) ://news.cnet.com/8301-17938_105-57504786-1/the-weird-world-where-3d-printing-and-art-collide/ 当我点击时它作为传入的 Facebook 消息变成了： http: [//fbsbx.com/l.php?u=http%3A%2F%2Fnews.cnet.com%2F8301-17938_105-57504786-1%2Fthe-weird-world-where -3d-printing-and-art-collide%2F&h=rAQEQCCGn&s=1](http://fbsbx.com/l.php?u=http%3A%2F%2Fnews.cnet.com%2F8301-17938_105-57504786-1%2Fthe-weird-world-where-3d-printing-and-art-collide%2F&h=rAQEQCCGn&s=1) 这只是将我带到“未找到”页面。

到目前为止，我还没有找到解决方法。

这对我来说尤其是个问题，因为我的紧急应用程序允许人们通过 Facebook 消息通知他们的朋友或他们的紧急情况。这些 Facebook 消息包含指向实时会话的链接，但 Facebook 正在破坏这些链接。我们以@Facebook.com 电子邮件的形式发送链接。消息通过，但链接已断开。解决这个问题对我的应用程序至关重要。

# php - JSON - 使用 JS 在 Json 中搜索字符串的值

> ID：15168421
> 
> 赞同：0
> 
> 时间：2013-03-01T23:12:29.087
> 
> 标签：php, javascript, json, cookies

我需要一种简单的方法来使用 javascript 搜索我的 Json 字符串。

这是创建我的 Json 字符串的 PHP：

```
<?php
$allnames = array();
$res = mysql_query("SELECT first,last FROM `tbl_names`");
while ($row = mysql_fetch_array($res)){
  $allnames[$i++] = $row['first'].':'.$row['last'];
}

echo $jsonstring = json_encode($allnames);
/* 
["john:smith","tony:stark","bruce:banner","clark:kent"]
*/
?> 
```

我打算把它`$jsonstring`放到一个 cookie 中，这样我就可以在几个不同的页面上引用它，这样我就不用再做任何未来的查询了。我正在使用来自以下网址的 jquery cookie 插件：[https ://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

```
<script type="text/javascript" src="jquery.cookie.js"></script>
<script language="javascript" type="text/javascript">
$(document).ready(function(){
   $.cookie("allNames", JSON.stringify(<?=$jsonstring;?>))
});
</script> 
```

到现在为止还挺好！cookie存在，数据保存，在浏览器中可以看到。

我现在对搜索该 cookie 的值很感兴趣，以查找这些名称中的任何一个。如果我找到一个，我将有选择执行，这取决于我的页面。

我想做的是从页面上的文本框中执行 onkeyup 事件：

```
<input type="text" name="lastname" id="lastname" />
<script language="javascript" type="text/javascript">
$(document).ready(function(){

  $("#lastname").keyup(function() {
    // search the "allNames" cookie value for lastname
     var allNames = $.cookie("allNames"); // gets cookie
     var lastname = $(this).val();

     // this is not seeming to work:
     if( allNames.text().search('stark') != -1){
        alert("that name exists");
     }else{
    alert("name does not exist");   
     }

  });

});
</script> 
```

我确信这是一项简单的任务，我只是没有掌握。也许 json 也不是保存 cookie 数据的最佳方式。

但是我将如何搜索 cookie 的值？或者有人可以提出更好的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:21:32.337

这是我的做法：

首先创建 JSON 并存储在 cookie 中：

```
<?php
    $allnames = array();
    $res = mysql_query("SELECT first,last FROM `tbl_names`");

    while ($row = mysql_fetch_array($res)){
        $allnames[$row['last']] = $row['first'];
    }

    setcookie("allNames", json_encode($allnames), time()+(3600*24*10)); //10 days
?> 
```

然后得到它：

```
$(function(){
    $("#lastname").on('keyup', function() {
        var allNames = JSON.parse($.cookie("allNames")); // gets cookie
        var lastname = this.value.trim();

        if (lastname in allNames) {
            alert("that name exists");
        }else{
            alert("name does not exist");
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:47:15.423

你的调用`if( allNames.text().search('stark') != -1){` 是错误的，`allNames`没有`text()` 方法，你应该在控制台上收到一个错误，说“对象没有方法'文本'”

它应该只是

```
if( allNames.search('stark') != -1){ 
```

但是，这会产生误报的问题：假设有一个名字与姓氏相同，或者有一个姓氏是另一个名字的子字符串。

如果您只是搜索姓氏，则应按照 adeneo 的建议改进结构，以姓氏为键的映射，或者您需要比仅使用 更加小心`indexOf`，如下所示

```
 var lastNames = JSON.decode(allNames).map(function(name){
     return name.split(":")[1];
 });

 // Note that this is not String.indexOf, it's Array.indexOf so it doesn't
 // suffer from the false positives from matching substrings
 if (lastNames.indexOf(lastName) > -1) {
      // Found it
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-08T00:46:40.147

对于 cookie 部分，如果您使用的是 HTML5，我建议您使用本地存储 API [http://www.w3schools.com/html/html5_webstorage.asp](http://www.w3schools.com/html/html5_webstorage.asp)，因为您不想在所有的 cookie 中发送大量数据时间。

# openssl - 寻找 DTLS 非阻塞程序示例 (C/C++)

> ID：15168423
> 
> 赞同：6
> 
> 时间：2013-03-01T23:12:44.647
> 
> 标签：openssl, dtls

我正在学习使用 SSL 和 UDP。经过一番广泛的搜索，我找不到很多示例程序来测试和学习。事实上，我发现的唯一一个就是这个。

[http://openssl.6102.n7.nabble.com/DTLS-examples-td2143.html](http://openssl.6102.n7.nabble.com/DTLS-examples-td2143.html)

然而，尽管作者声称它是非阻塞的，但在阅读了代码后，我认为这不是我们通常所说的，因为它根本没有使用 select() 或 poll()。想在这里得到一些帮助，非常感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-22T12:32:06.607

这是我找到的代码示例

[dtls 样本](https://web.archive.org/web/20150814081716/http://sctp.fh-muenster.de/dtls-samples.html)

希望这可以帮助。

# java - JAVA中的正则表达式模式匹配错误（字符串）

> ID：15168432
> 
> 赞同：-1
> 
> 时间：2013-03-01T23:13:20.837
> 
> 标签：java, regex

正则表达式模式：

```
Pattern BASIC_GRAMMAR = Pattern.compile("^((NONTERMINALASSIGNMENT|TERMINALASSIGNMENT)[NONTERMINAL|TERMINAL|PIPE]+)+$"); 
```

传递的字符串不应该是：

```
NONTERMINALASSIGNMENTNONTERMINALTERMINALNONTERMINALASSIGNMENTTERMINALPIPETERMINALERROR 
```

最后有“错误”，不应该通过检查，但确实如此。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:27:31.887

正确模式：

```
Pattern BASIC_GRAMMAR = Pattern.compile("^((NONTERMINALASSIGNMENT|TERMINALASSIGNMENT)(NONTERMINAL|TERMINAL|PIPE)+)+$"); 
```

谢谢大家的关注。

# java - Java：删除从“（”开始并以“）”结尾的部分字符串

> ID：15168434
> 
> 赞同：2
> 
> 时间：2013-03-01T23:13:30.917
> 
> 标签：java, regex, string

给定字符串`"Hello World (27348)"`.

您将如何`"Hello World"`通过专门删除以正则表达式开头`"("`和结尾的部分字符串来转换它`")"`？

```
string.replaceAll("???", ""); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-01T23:16:00.597

我不知道为什么需要使用正则表达式：

```
string.substring(0, string.indexOf("(")); 
```

如果您*必须*使用正则表达式：

```
string.replaceAll("\\(.*?\\)", "") 
```

后者的不同之处在于它删除了括号之间（包括）之间的所有内容，而前者删除了之后的所有内容，`(`即使 之后有字符也是如此`)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:15:26.500

像这样的东西？

```
"Hello World (27348)".replaceAll("\\(.*?\\)", "") 
```

您必须转义括号，因为它们是正则表达式世界中的元字符。要将它们视为普通字符，您应该使用反斜杠转义 `em。

# javascript - 倒数计时器，直到出现链接

> ID：15168435
> 
> 赞同：1
> 
> 时间：2013-03-01T23:13:37.063
> 
> 标签：javascript, countdown

我正在尝试制作一个倒数计时器，它的链接在 20 分钟后出现。这是我目前所拥有的......

```
 <script type="text/javascript">

window.onload = function()
{
    countDown('my_div1', '<a href="cdtl.html">Hello 1</a>', 720);
}

function countDown(elID, output, seconds)
{
    document.getElementById(elID).innerHTML = (seconds==0) ? output : 'Time until link appears: ' + seconds;
    if(seconds==0) { return; }
    setTimeout("countDown('"+elID+"', '"+output+"', "+(seconds-1)+")", 1000);
}
</script> 
```

它有效，但这就是我想做的。如何将 20 分钟的间隔从 20:00:00 改为 720 秒？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T00:01:06.630

Shehabix 回答了您的问题，但我想建议您重写您的代码：

```
window.onload = function() {
    countDown('my_div1', '<a href="cdtl.html">Hello 1</a>', 720);
}
function countDown(elID, output, seconds) {
    var elem = document.getElementById(elID),
        start = new Date().getTime(), end = start+seconds*1000,
        timer = setInterval(function() {
            var now = new Date().getTime(), timeleft = end-now, timeparts;
            if( timeleft < 0) {
                elem.innerHTML = output;
                clearInterval(timer);
            }
            else {
                timeparts = [Math.floor(timeleft/60000),Math.floor(timeleft/1000)%60];
                if( timeparts[1] < 10) timeparts[1] = "0"+timeparts[1];
                elem.innerHTML = "Time left: "+timeparts[0]+":"+timeparts[1];
            }
        },250); // the lower this number, the more accurate the timer. 250 recommended
} 
```

这将更有效地工作，因为它使用函数而不是依赖`eval`（这是传递字符串的`setTimeout`作用）。此外，它使用增量计时来计算剩余时间 - 这是因为指定 1000 毫秒是不准确的。它依赖于立即处理的代码，但事实并非如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:21:54.103

首先 7200 秒 = 120 分钟而不是 20 分钟；

现在关于 20 分钟：XX 秒

```
var remMinutes = Math.floor(seconds / 60);
var remSeconds = seconds - (remMinutes * 60);

document.getElementById(elID).innerHTML = (seconds==0) ? output : 'Time until link appears: ' + remMinutes + "minutes and "+remSeconds+" seconds"; 
```

或者如果您希望输出为 MM:SS

然后使用这个：

```
document.getElementById(elID).innerHTML = (seconds==0) ? output : 'Time until link appears: ' + remMinutes + ":"+remSeconds; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T00:07:41.893

提醒一下，你不应该依赖这个来获得高安全性，有人可以很容易地阅读源代码并找出链接。即使你混淆了它，如果浏览器可以解码它，那么一个坚定的人也可以。

```
var twentyMins = 20 * 60; // 20 minutes * 60 seconds

window.onload = function() {
    countDown('my_div1', '<a href="cdtl.html">Hello 1</a>', twentyMins);
}

function countDown(elID, output, seconds) {
    var mins,
        secs = seconds,
        pad = function (n) {
            return n > 9 ? n : '0' + n;
        };

    // get the hours by dividing by the number of seconds in an hour
    hours = Math.floor(secs / 3600); //  60 * 60 = 3600
    // get the remaining seconds
    secs %= 3600;
    // likewise, get the number of minutes of by dividing the remaining seconds by 60
    mins = Math.floor(secs / 60);
    // again, get the remainder of seconds
    secs %= 60;

    // pad any numbers less than 9 with a leading 0
    secs = pad(secs);
    mins = pad(mins);
    hours = pad(hours);

    document.getElementById(elID).innerHTML = (seconds === 0) ? output : 'Time until link appears: ' + hours + ':' + mins + ':' + secs;

    // instead of returning, just don't call setTimout if we are done
    if (seconds !== 0) {
        seconds -= 1;
        // there is no need to pass a string to setTimout, you just pass the function name,
        // followed by the timeout in ms, followed by any params
        setTimeout(countDown, 1000, elID, output, seconds);
    }

} 
```

[jsFiddle](http://jsfiddle.net/jjjnd/3/)

**但是**`setInterval`，使用而不是重写它会是一个更好的主意`setTimeout`。这是因为定时器不可靠且[定时器延迟长度无法保证](http://ejohn.org/blog/how-javascript-timers-work/)。Doing`setTimeout(something, 1000)`可能会在`something`一秒钟后执行，或者它可能`something`会在那之后的某个时间执行。它可能只会在这里和那里只有几毫秒，但在任何相当长的时间内它都会加起来。

即使是像盒子这样简单的东西[也会`alert`停止你`setTimeout`的倒计时](http://jsfiddle.net/jjjnd/4/)！下面的代码通过重新计算每次运行时剩余的秒数每半秒更新一次计数器。我们仍然可以使用 来做到这一点`setTimeout`，但`setInterval`更适合这项工作。如果浏览器由于某种原因陷入困境，`setInterval`只会放弃一些执行，而不是试图追赶。这很好，因为它每次运行时都会重新计算剩余时间。这也意味着如果`alert`弹出一个，也没关系。

另一个不依赖`setTimeout`s 序列在每次运行时递减计数器的好理由是，在我们现代的选项卡式浏览器世界中，后台选项卡的[计时器分辨率通常会降低](http://www.nczonline.net/blog/2011/09/19/script-yielding-with-setimmediate/)，这也可能是由于[笔记本电脑的电源管理](https://www.belshe.com/2010/06/04/chrome-cranking-up-the-clock/)而发生的。通常这意味着从 4ms 到 15ms 的最小分辨率，所以在这种情况下它不应该打扰我们，但是在使用计时器时你需要知道这一点。

```
var twentyMins = 20 * 60; // 20 minutes * 60 seconds

window.onload = function() {
    countDown('my_div1', '<a href="cdtl.html">Hello 1</a>', twentyMins);
}

function countDown(elID, output, seconds) {
    "use strict";
    var timer, // timer will hold a reference to the id of our interval
        // store a reference to the element so we don't have to keep looking it up
        el = document.getElementById(elID),
        getTime = function () {
            // get the current time in ms since Unix epoch
            return (new Date()).getTime();
        },
        // we will be done counting down when we are
        // `seconds` seconds from the current time
        finishAt = getTime() + (seconds * 1000),
        pad = function (n) {
            return n > 9 ? n : '0' + n;
        },
        lastCount = -1,
        update = function () {
            var hours,
                now = getTime(),
                mins,
                // the seconds remaining is the finish time
                // minus the current time divided by 1000ms
                secs = Math.floor((finishAt - now) / 1000);

            // Since we might be running this update function more than once
            // a second, check to see if the number of seconds has changed since
            // our last run. If it hasn't there is no need to do any more calculations
            // nor update the DOM.
            if (lastCount !== secs) {

                lastCount = secs;

                // you need to make sure the current time is equal to OR GREATER THEN the finish time
                // because the interval could have actually fired sometime (shortly)
                // after the time stored in finishAt
                if (now >= finishAt) {
                    clearInterval(timer);
                    el.innerHTML =  output;
                } else {
                    // get the hours by dividing by the number of seconds in an hour
                    hours = Math.floor(secs / 3600); //  60 * 60 = 3600
                    // get the remaining seconds
                    secs %= 3600;

                    // likewise, get the number of minutes of by dividing the remaining seconds by 60
                    mins = Math.floor(secs / 60);

                    // again, get the remainder of seconds
                    secs %= 60;
                    secs = Math.floor(secs);

                    // pad any numbers less than 9 with a leading 0
                    secs = pad(secs);
                    mins = pad(mins);
                    hours = pad(hours);

                    el.innerHTML = 'Time until link appears: ' + hours + ':' + mins + ':' + secs;
                }
            }
        };

    // display the counter right away
    update();

    // start the timer, updating twice a second to try and avoid
    // having the counter seem to skip numbers
    timer = setInterval(update, 499);
} 
```

[jsFiddle](http://jsfiddle.net/jjjnd/7/)

您可能已经注意到，在我提出的两种解决方案中，我在计算不同的时间分量时都使用了[余数运算符。](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Arithmetic_Operators#.25_.28Modulus.29)我这样做是因为使用[余数运算符](http://jsperf.com/multiply-subtract-vs-remainder)比乘以将分钟作为秒然后减去要快。您可能还注意到我的代码使用了严格的等式/不等式[比较运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Comparison_Operators) `===`and`!==`而不是`==`and `!=`。这种编码风格不仅会减少[JSLint](http://www.jslint.com/) [对您的感情造成的伤害](http://www.jslint.com/lint.html)，而且速度也会稍微快一些。

在第二个更好的解决方案中，变量`lastCount`存储了上一次执行后剩余的总秒数。由于代码将每秒运行一次以上，因此查看自上次以来结果是否已更改很有用。如果没有，我们就不必再做任何工作了。我们不必计算分钟，更重要的是我们不必接触 DOM，因为[DOM 访问速度很慢](http://www.phpied.com/dom-access-optimization/)。

# c - 尝试从字符输入中读取时出现分段错误

> ID：15168436
> 
> 赞同：-2
> 
> 时间：2013-03-01T23:13:40.357
> 
> 标签：c, segmentation-fault

为什么我的 fillArray 函数代码导致我在运行它时遇到分段错误。我正在尝试从该函数中的字符输入中读取。为了帮助我解决这个问题，我将发布我的其他函数以及 fillArray 函数

```
#include <stdio.h>  /* standard header file */
#include "Assg6.h"

 void fillArray(int *array, int*count, char *buf){
*count = 0;
while(*buf){
    *(array++) = *(buf++);
    (*count)++;
 }
}

 void printArray(const int *array, int count, FILE *fpout){
int i;
for(i = 0; i <= count; i++){    
    fprintf(fpout, "%d ", *(array + i));
}
 }

int findMajority(int *array, int count, int *result){
int arrayb[count];
int i, counter, bcount = 0, ccount = 0, candidate, j;   
if(count % 2 != 0){
    int temp = *(array + count);
    for(i = 0; i <= count; i++){
        if(*(array + i) == temp){
            counter++;
        }
    }
    if(counter > (count/2)){
        *result = temp;
        return true;
    }
    else{
        count--;
    }
}
for(j=0; j <= count; j += 2){
    if(*(array + j) == *(array + j) +1){
        arrayb[bcount] = *(array + j);
        bcount++;
    }
}   
if(bcount == 1)
    candidate = arrayb[0];
    else
    findMajority(arrayb, bcount, result);

for(j=0; j <= count; j += 2){
    if(*(array + j) == candidate){
        ccount++;
    }
}
if(ccount > (count/2))
    return true;
    else
        return false;
} 
```

这是主要功能：

```
#include <stdio.h>        // standard header file 
#include <stdlib.h>       // for the exit() function 

#define LEN 80            // used in fgets() function 

int main(int argc, char *argv[])   {
  FILE *fpin, *fpout;
  int a[LEN], count, majorityExists;
  char buf[LEN];
  int candidate;

  if (argc != 3) {
  printf("Usage: Assg6 InputFileName  OutputFileName\n");
  exit(1);
  }

  if ( (fpin = fopen(argv[1], "r")) == NULL)  {
  printf("Input file %s cannot be opened\n", argv[1]);
  exit(1);
  }

  if ( (fpout = fopen(argv[2], "w")) == NULL) {
  printf("Output file %s cannot be opened\n", argv[2]);
  exit(1);
  }

  while (fgets(buf, LEN, fpin) != NULL) {  // for each line in the input file
  fillArray(a , &count, buf);
  printArray(a, count, fpout);
  majorityExists = findMajority(a, count, &candidate);
  if (majorityExists) 
      fprintf(fpout, "\thas the majority element %d\n\n", candidate);
  else
      fprintf(fpout, "\tdoes not have a majority element\n\n");
  }

  fclose(fpin);
  fclose(fpout);

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:19:39.180

1) 一定要熟悉你的调试器。这可能是 Visual Studio（在 Windows 上）、gdb（在 Linux 上），或一百万个其他替代方案中的任何一个。您的调试器是您的朋友。请至少熟悉设置断点、单步执行代码和查看变量内容的基础知识。

2）唯一重要的代码是：

a）您为数组分配空间的位置（例如`int arrayb[count];`），以及

b）您正在写入或读取该数组的所有地方。

```
 The moment you read data "off the edge" of your array ... game over. 
```

3）顺便说一句：“可变长度数组”（如“int arrayb [count]”，其中“count”是一个输入参数）可能是个坏主意。请使用一个常量来初始化数组......至少在您熟悉所有“基础知识”之前。

恕我直言...

PS：“fillArray()”*绝对*是一个很好的选择，可以用来熟悉调试器中的“单步执行”和“查看变量”:)

# python - 为什么magic.from_buffer 返回None？

> ID：15168439
> 
> 赞同：1
> 
> 时间：2013-03-01T23:13:46.443
> 
> 标签：python, python-magic

这是我打电话时得到的`magic.from_buffer`：

```
>>> import urllib2
>>> data = urllib2.urlopen('http://www.in.gov/judiciary/opinions/previous/wpd/05040501.bed.doc').read()
>>> len(data)
29696
>>> from lib import magic
>>> magic.from_buffer(data, mime=True) 
```

在这一点上，我应该得到`application/msword`，但我没有从最后一次通话中得到任何东西。我错过了什么？

这适用于我的开发机器，但在我的服务器上失败。我相当困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:57:42.897

我不确定问题的原因（可能是版本），但我已经能够通过以下方式解决它：

```
mime = magic.from_buffer(data, mime=True)
if mime == None:
    # Workaround for issue with libmagic1==5.09-2 in Ubuntu 12.04\. Fixed in libmagic 5.11-2.
    file_str = magic.from_buffer(data)
    if file_str.startswith('Composite Document File V2 Document'):
        mime = 'application/msword' 
```

不是很好，但可以完成工作，直到可以升级服务器并获得新版本的 libmagic。

# jquery - 显示：在 iPhone 上没有可点击的链接

> ID：15168441
> 
> 赞同：1
> 
> 时间：2013-03-01T23:13:51.497
> 
> 标签：jquery, wordpress, mobile

在我的网站（通过 WordPress 运行）上，我有一系列可点击的图像缩略图。当您将鼠标悬停在缩略图上时，缩略图上方会出现一个灰色框。出现的这个灰色框是一个可点击的链接，但只有80%的灰色框是可点击的。

我的问题是 iPhone 在单击此框时如何反应。当您单击 80% 区域（可单击区域）之外的任意位置时，会出现灰色框。这很棒。但是，如果您单击这 80% 区域内的任何位置，您将自动进入链接，而不是出现灰色框。这在文本形式上可能看起来有点混乱，所以我画了一张图片来展示我的问题： ![iPhone悬停问题](../Images/9e1a4457eefdb132af2cc9293de74509.png)

假设你在 iPhone 上，你会看到一个你想要点击的缩略图。如果您在 80% 区域之外单击，灰色框会正常显示。但是，如果您在这 80% 的区域（即实际链接的区域）内单击，您将被重定向到外部源，甚至看不到应该出现的灰色悬停框。这就是问题。我希望它像在计算机上一样工作，所以如果你在 iPhone 上单击缩略图上的任意位置，灰色的悬停框应该始终出现，而不是将你重定向到外部链接。因为将用户链接到 iphone 上的外部源的 80% 区域设置为`display:none`并且对用户基本上是不可见的（直到您将鼠标悬停在缩略图上）。用户不应该能够点击他们看不到的链接。

那么，无论用户单击缩略图上的哪个位置，我如何才能使单击 iPhone 时始终出现悬停灰色框？任何建议或意见都会很棒。

***更新：***

这是使灰色 div 出现的 jquery（通过`opacity`）

```
$( document ).ready( function() {
$('.entry-image').mouseover(function(){
    //show the box
    $(this).children('.thumbhover').stop().animate({opacity:1},300);
});

$('.entry-image').mouseleave(function(){
    //hide the box
    $(this).children('.thumbhover').stop().animate({opacity:0},500);
}); 
```

我还在 CSS 和 jquery 中添加`display:none`了我的 thumbhover div，`show()`因此 div 使用不显示`opacity:0`，然后当你将鼠标悬停在它们上时，它有一个块显示和一个`opacity:1`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T00:27:59.563

如果您真的想让灰色框出现，请在第一个元素上设置单击事件以使灰色框出现。然后在灰色框上再次单击以将您带到任何地方...

我做了一个演示：

[jsfiddle](http://jsfiddle.net/newe1344/tzkK7/7/)

HTML：

```
<div id="box">
   <a class="link one" href="#first">First click</a>
   <a class="link two" href="#second">Second click</a>
</div> 
```

然后你的脚本：

```
$('.one').on('click', function(evt) {
    evt.preventDefault();
    console.log('clicked');
    $('.two').css({
      'top': '0px'
    });
});

$('.two').on('click', function(evt) {
   evt.preventDefault()
   // outside link
   alert("You clicked an outside link!");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:31:23.610

似乎当 iPhone 用户触摸该框时，首先**触发**“悬停”事件（因此始终显示灰色框），然后触发“单击”事件，因此如果在 80 内，用户将被定向到链接％ 区域。问题是这两个事件是顺序和立即发生的（不像在计算机中），所以你甚至看不到灰色框，因为页面已经被重定向到一个新页面。

您是否尝试过在链接的 onclick 事件上显示灰色框？我的意思是，复制您在“悬停”事件中执行的样式过程并将其放入链接的“单击”事件中。

**更新以回答您的评论：**

您可以使用以下 Javascript 检测用户是否在移动设备上：

```
function isMobileDevices() {
    return navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i) !== null
} 
```

在这种情况下采取不同的行动。例如，这很丑陋，在“点击”事件上通过 Javascript 打开链接，而不是使用真正的`<a>`链接，但如果我们在移动设备中，只有在第二次或以上时才打开链接用户点击它。为此，您将不得不跟踪每个盒子的状态，这有点费力。

可能更好的选择是研究[触摸事件](https://developer.mozilla.org/en-US/docs/DOM/Touch_events)并相应地管理这些事件。

**更新**

查看您网站的来源，我看不到您正在使用`display:none`，正如您在问题中提到的那样。我明白`opacity:0`了，这是不同的。`display:none`在需要开始为不透明度设置动画之前，您是否尝试过真正使用？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T02:13:34.770

我修复了 iPhone 上的双击/触摸悬停问题，方法是制作可点击区域`display:none;`，然后通过 CSS 使其在悬停时再次可见。像这样。。

```
.thumbhover {display:none;}

.entry-image:hover .thumbhoverimg {display:block !important;} 
```

所以我使可点击区域不可见，然后当用户将鼠标悬停在“entry-image”div 上时再次可见。这似乎解决了 iPhone 上的悬停问题。:)

# c# - 取消关闭 C# 窗体

> ID：15168442
> 
> 赞同：2
> 
> 时间：2013-03-01T23:13:55.923
> 
> 标签：c#

我的程序有两种关闭方式，一种是右上角的“X”，另一种是“退出”按钮。现在，当满足某个条件时按下其中任何一个时，会弹出一条消息，通知用户他们尚未保存。如果他们确实保存了，则不会弹出消息并且程序会正常关闭。现在，当消息弹出时，用户会得到一个带有 Yes 和 No 按钮的 MessageBox。如果按下“是”，则程序需要保存。如果按下“否”，则程序需要取消在用户按下“X”或“退出”按钮时已启动的关闭事件。

做这个的最好方式是什么？

```
 private void Form1_FormClosing(object sender, FormClosingEventArgs e)
{
    TryClose();
}

private void TryClose()
{
    if (saved == false)
    {
        //You forgot to save
        //Turn back to program and cancel closing event
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T23:16:30.087

`FormClosingEventArgs`包括[`Cancel`](http://msdn.microsoft.com/en-us/library/system.componentmodel.canceleventargs.cancel.aspx)财产。只需设置`e.Cancel = true;`以防止表单关闭。

```
private void Form1_FormClosing(object sender, FormClosingEventArgs e)
{
    if (!saved)
        e.Cancel = true;
} 
```

* * *

根据评论进行编辑：

由于您的目标是允许使用相同的“保存方法”，因此我会将其更改为`bool`成功返回：

```
private bool SaveData()
{
     // return true if data is saved...
} 
```

然后你可以写：

```
private void Form1_FormClosing(object sender, FormClosingEventArgs e)
{
    // Cancel if we can't save
    e.Cancel = !this.SaveData();
} 
```

您的按钮处理程序等仍然可以`SaveData()`根据需要调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:17:38.617

这将满足您的需要：

```
private void Form1_FormClosing(object sender, FormClosingEventArgs e)
{
    e.Cancel = !TryClose();
}

private bool TryClose()
{
    return DialogResult.Yes == MessageBox.Show("Are you sure?", "Are you sure?", MessageBoxButtons.YesNo, MessageBoxIcon.Question);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:20:33.507

覆盖 OnFormClosing：

```
 protected override void OnFormClosing(FormClosingEventArgs e)
 {
    if (saved == true)
    {
       Environment.Exit(0);
    }
    else /* consider checking CloseReason: if (e.CloseReason != CloseReason.ApplicationExitCall) */
    {
       //You forgot to save
       e.Cancel = true;
    }
    base.OnFormClosing(e);
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T23:20:34.627

```
 private void Form1_FormClosing(object sender, FormClosingEventArgs e)
    {
        e.Cancel = !TryClose();
    }

    private bool TryClose()
    {
        if (!saved)
        {
            if (usersaidyes)
            {
                // save stuff
                return true;
            }
            else if (usersaidno)
            {
                // exit without saving
                return false;
            }
            else
            {
                // user cancelled closing
                return true;
            }
        }
        return true;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-01T23:17:08.817

使用事件 args的[`Cancel`属性，将其设置为 true 以取消。](http://msdn.microsoft.com/en-gb/library/system.componentmodel.canceleventargs.cancel.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-01T23:17:15.417

要取消关闭事件，只需将`Cancel`属性设置`true`为`FormClosingEventArgs`实例

```
if (!saved) {
  // Message box
  e.Cancel = true;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-01T23:19:21.940

您可以从退出按钮调用 Close。然后像其他人所说的那样在 Forms.FormClosing 事件中处理关闭。这将处理退出按钮单击和从“X”关闭的表单

# jquery - 显示表单域和焦点

> ID：15168443
> 
> 赞同：1
> 
> 时间：2013-03-01T23:14:02.953
> 
> 标签：jquery

有一个选择器，当我选择一个特定选项时，它会显示额外的表单字段。那时我想将焦点切换到新领域。这是我尝试过的，但似乎不起作用。我错过了什么？：

```
 $('#mySelector').change(function () {
        var st = $(this).val();
        if (st == 'a') {                
            $('#a').show(function(){
                $('#aField').focus();
            });
            $('#b').hide();
        } else if (st == 'b') {
            $('#a').hide();
            $('#b').show(function(){
                $('#bField').focus();
            });             
        } else {
            $('#a, #b').hide();
        }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:20:15.430

这行得通。您的错误在代码的其他地方。您的 HTML 中可能有错字：

```
<select id="mySelector">
    <option value=""></option>
    <option value="a">a</option>
    <option value="b">b</option>
</select>

<div id="a">
    <input type="text" value="A field" id="aField" />
</div>

<div id="b">
    <input type="text" value="B field" id="bField" />
</div> 
```

[http://jsfiddle.net/zwR4F/](http://jsfiddle.net/zwR4F/)

# php - 调用类时 __construct 出错

> ID：15168446
> 
> 赞同：0
> 
> 时间：2013-03-01T23:14:31.750
> 
> 标签：php

我有关于 PHP 的课程，当调用它时，函数`__construct($_POST)`必须是进程。

`__construct()`函数定义为：

```
// Constructor Function
function __construct($_POST){
    $this->customer       = trim($_POST['customer']);
    $this->CreateDate   = date('Y/m/d');    
} 
```

当我在类上调用任何函数时，它会被处理并插入到数据库中，但是会出现这个消息：-

```
Missing argument 1 for Draft::__construct(), called in .... 
```

我的代码有什么问题

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T23:19:32.837

我对你的意图感到困惑。

`$_POST`是一个[PHP 超全局](http://www.php.net/manualyou/en/language.variables.superglobals.php)，这意味着它在所有范围内都可用。

**如果您的意图是使用发布的数据：**

无需将其作为参数传递

**如果你传递一个你恰好调用 $_POST 的变量：**

更改变量的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:17:54.090

错了两点：

1.  您的类构造函数将超级全局变量作为参数。
2.  您可能不会将参数传递给构造对象的调用：

对于 2 号，您应该致电：

`$draft = new Draft($var);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:23:35.493

当您尝试使用保留变量时，PHP 也应该发出通知，例如 ,`$_POST`和`$_GET`“`$_COOKIE`非法偏移”。

从您的问题来看，您似乎不了解[function parameters 和 arguments 之间的区别](http://en.wikipedia.org/wiki/Parameter_%28computer_programming%29)。您已经在传递一个参数，而它应该是一个参数。

这个：

```
function __construct($_POST){
    $this->customer       = trim($_POST['customer']);
    $this->CreateDate   = date('Y/m/d');    
} 
```

应改写为：

```
function __construct($POST){
    $this->customer       = trim($POST['customer']);
    $this->CreateDate   = date('Y/m/d');    
} 
```

接着：

```
$object = new YourClass($_POST); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T23:41:57.723

```
$_post is super global variable and you are using as constructor parameter change the variable name 
function __construct($post){

    $this->customer       = trim($post['customer']);
    $this->CreateDate   = date('Y/m/d');    
}

Or Second remove $_Post in constructor parameter 

function __construct(){

        $this->customer       = trim($_POST['customer']);
        $this->CreateDate   = date('Y/m/d');    
    } 
```

# sql - 如何在vertica中进行测序？

> ID：15168447
> 
> 赞同：0
> 
> 时间：2013-03-01T23:14:56.643
> 
> 标签：sql, vertica

我有一张带有 customer_id 和 order_id 的表，我想根据 customer_id 对其进行排序。这是如何在 Vertica SQL 中完成的？

```
c_id o_id
1 1
2 3
1 4
2 5
3 6
3 7

```

我想要：

```
c_id o_id 序列
1 1 1
1 4 2
2 3 1
2 5 2
3 6 1
3 7 2

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:37:54.873

据我所知，Vertica 支持（标准）窗口函数，所以以下应该可以工作：

```
select c_id, 
       o_id,
       row_number() over (partition by c_id order by o_id) as seq
from the_table
order by c_id, o_id 
```

# ruby-on-rails - 测试 Rails 查询计数

> ID：15168450
> 
> 赞同：2
> 
> 时间：2013-03-01T23:15:15.567
> 
> 标签：ruby-on-rails, performance

我正在尝试编写一个测试以确保我们不会运行比必要更多的查询。我找到了 ActiveRecord 测试用例并试图继承它。这个测试用例有一些有用的方法，比如 assert_queries(num)。问题 - 它似乎在 3.2.12 中不起作用，并且已被弃用。

有什么地方可以访问查询日志吗？我在我的一个测试用例中打开了 pry shell，试图检查一些查询日志记录对象。没有骰子。

有点沿着这些思路 - 是否有任何工具可以在模型之外注册回调？例如，我想注册一个侦听所有对象保存方法的块。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:07:38.063

“有没有在模型之外注册回调的工具？”

ActiveRecord::Observer 应该完全按照您的意愿行事。此代码“观察”评论模型：

```
class CommentObserver < ActiveRecord::Observer
  def after_save(comment)
    Notifications.comment("admin@do.com", "New comment was posted", comment).deliver
  end
end 
```

有关更多示例和高级用法，请参阅[http://api.rubyonrails.org/classes/ActiveRecord/Observer.html](http://api.rubyonrails.org/classes/ActiveRecord/Observer.html)

# html - 正确对齐 Div

> ID：15168452
> 
> 赞同：0
> 
> 时间：2013-03-01T23:15:22.023
> 
> 标签：html, css

我目前的项目需要一些认真的 CSS 帮助。我附上了我希望我的页面看起来像的屏幕截图。我遇到的问题是将 div 正确定位在彼此上，并且让宽度/高度保持 100% 的页面。我想在不使用 Javascript 的情况下做到这一点。这是我的 HTML：

```
<body>
    <div class="wrapper">
       <div class="container_24">
            <div class="grid_16">
                <input type="text" value="Username" /><input type="text" value="Password" /><input type="button" value="Submit" /><span class="mainLink">Register</span>
            </div>
       </div>
       <div class="container_16">
            <form id="form1" runat="server">
                <asp:ContentPlaceHolder ID="Body" runat="server">

                </asp:ContentPlaceHolder>
            </form>
       </div>
       <div class="container_24"></div>
        </div>
</body> 
```

这是我的 CSS：

```
.wrapper{
  min-height: 100%;
  min-width: 100%;

  /* Set up proportionate scaling */
  width: 100%;
  height: auto;

  /* Set up positioning */
  position: fixed;
  top: 0;
  left: 0;
}
.container_16 {
  margin-left: auto;
  margin-right: auto;
  width: 960px;

    min-height: 100%;

  /* Set up proportionate scaling */
  height: auto;
  margin-top:0px;
  padding-top:0px;
    background-image:url(../images/Content_bkg.gif);
        box-shadow: 0px 0px 15px rgb(0,0,0);
    -webkit-box-shadow: 0px 0px 15px rgb(0,0,0);
}
.container_24 {
    background-image: url(../images/headerFooter_bkg.gif);
    height: 60px;
    margin: 0px;
    padding: 0px;
    border: 1px solid rgb(71, 89, 32);
    box-shadow: 0px 0px 15px rgb(0,0,0);
    -webkit-box-shadow: 0px 0px 15px rgb(0,0,0);
    position:relative;
    width:100%;
} 
```

关于我希望它看起来像什么的图像（跨越整个浏览器窗口）： ![在此处输入图像描述](../Images/3d7898b1fac7a67417b89715d65b34c6.png)

实际的： ![在此处输入图像描述](../Images/22dda827ee9b0f4d1dbde057c903835c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:23:22.057

```
html,body {
    height: 100%;
}
.container_16 {
    min-height: 100%;
} 
```

也许尝试一下。或者做一个小提琴，这样我们就可以弄乱你的代码。

**编辑**

[http://jsfiddle.net/LMFL5/4/](http://jsfiddle.net/LMFL5/4/)（除非你有两台显示器并跨越它们，因为 960 太小了，否则小提琴并不公平。将包装器宽度调整为 500 以查看它小提琴中的动作。通过这种方式，您还可以轻松地为包装器设置断点并制作半响应式站点。我不再这样做了，我使用 flex width 960 网格。

这是我做你经常谈论的事情的方式。

HTML

```
<body>
    <div class="container_24">
        <div class="wrapper">
            <div class="grid_16">
                <input type="text" value="Username" /><input type="text" value="Password" /><input type="button" value="Submit" /><span class="mainLink">Register</span>
            </div>
        </div>
   </div>
   <div class="container_16">
       <div class="wrapper">
           <form id="form1" runat="server">
            Adding some content
           </form>
       </div>
   </div>
   <div class="container_24 footer">
        <div class="wrapper">Footer</div>
   </div>
</body> 
```

CSS

```
html, body {
    height:100%;
    margin: 0;
}

.wrapper{
  width: 960px;
  margin: 0 auto;      
}
.grid_16 {
    text-align: center;
}
.container_16 {
    width: 100%;
    height: 100%;
}
.container_16 .wrapper {
     background-image:url(../images/Content_bkg.gif);
     box-shadow: 0px 0px 15px rgb(0,0,0);
    -webkit-box-shadow: 0px 0px 15px rgb(0,0,0);
    height: 100%;
}
.container_24 {
    background-image: url(../images/headerFooter_bkg.gif);
    background-color: green;
    height: 60px;
    margin: 0px;
    padding: 0px;
    border: 1px solid rgb(71, 89, 32);
    box-shadow: 0px 0px 15px rgb(0,0,0);
    -webkit-box-shadow: 0px 0px 15px rgb(0,0,0);
    position:relative;
    width:100%;
}
.container_24.footer {
    bottom: 0;
    position: fixed;
    z-index: 3;
} 
```

我为您的宽度所做的关键是制作一个通用的 960 包装器，我将其包含在每个 div 中。你所有的内容都存在于 960 空间中，但你可以让 div 跨越全屏。这个站点：http: [//960.gs/](http://960.gs/)有一个 CSS 生成器，它可以完全按照您的要求执行，并且您的大部分代码看起来都来自这个相同的类模式。在这里可以生成您需要的列数：http: [//grids.heroku.com/](http://grids.heroku.com/)

基本上，如果你想要一个全屏宽度的 div，只需包装其中一个`.content`div 就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:28:01.357

请参阅[此处](http://peterned.home.xs4all.nl/examples/csslayout1.html)了解 100% 最小高度布局

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T11:28:12.493

@Yecats 可能对你有帮助

```
 .wrapper
    {
      height: 100%;
      min-width: 100%;  
      /* Set up proportionate scaling */
      width: 100%;
      /* Set up positioning */
      position: relative;
      top: 0;
      left: 0;

    } 
```

# vb.net - 如何循环遍历富文本框中所选文本的每个字符

> ID：15168458
> 
> 赞同：2
> 
> 时间：2013-03-01T23:15:44.357
> 
> 标签：vb.net

我需要在富文本框中循环遍历所选文本的每个字符，并将字体方面（系列、大小或样式）应用于每个字符。使用字体对话框选择此方面。我不想在这段代码中引入任何其他类型的对话框（例如颜色对话框）。

到目前为止，我暂时得到了以下可能是错误的：

```
If aFontDialog.ShowDialog = Windows.Forms.DialogResult.OK Then
    If rtb.SelectionFont IsNot Nothing Then
        rtb.SelectionFont = aFontDialog.Font
        rtb.SelectionColor = aFontDialog.Color
    Else
        For index As Integer = 0 To rtb.SelectionLength - 1
           '<<????
        Next
    End If
End If 
```

**编辑**

这篇关于 CodeProject 的文章比我 [**www.codeproject.com 更好地解释了这个问题......**](http://www.codeproject.com/Articles/12062/Richer-RichTextBox-Part-1)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T14:04:38.977

对于您对丑陋方法的要求，这里是：

使选择变为粗体（同时保留任何斜体或下划线等）：

```
Dim startIndex As Integer = rtb.SelectionStart
Dim textLength As Integer = rtb.SelectionLength
For i As Integer = startIndex To startIndex + textLength - 1
  rtb.Select(i, 1)
  rtb.SelectionFont = New Font(rtb.SelectionFont, _
                               rtb.SelectionFont.Style Or FontStyle.Bold)
Next
rtb.Select(startIndex, textLength) 
```

要删除粗体，请将上面的行更改为：

```
rtb.SelectionFont = New Font(rtb.SelectionFont, _
                             rtb.SelectionFont.Style And Not FontStyle.Bold) 
```

如果处理大型文档，则会出现相当大的闪烁。在这种情况下，您需要关闭控件的绘制，直到完成格式化，请参阅[RichTextBox 语法实时高亮--禁用重绘](https://stackoverflow.com/a/3282911/719186)。

除了逐个遍历字符之外，您还可以通过 pinvoke 执行此操作。这是 Code Project 上的一个随机项目，展示了基础知识：[Richer RichTextBox (Part 1)](http://www.codeproject.com/Articles/12062/Richer-RichTextBox-Part-1)

我不相信 WPF RichTextBox 有这些限制，所以如果可能的话，这将是另一种选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T05:39:45.097

当双击富文本框区域内的字符串时，这有效......

```
 Private Sub rtb_DoubleClick(sender As Object, e As System.EventArgs) Handles rtb.DoubleClick
    If ColorDialog1.ShowDialog = Windows.Forms.DialogResult.OK Then
        If rtb.SelectionFont IsNot Nothing Then
           rtb.SelectionColor = ColorDialog1.color
        End If
    End If

    If FontDialog1.ShowDialog = Windows.Forms.DialogResult.OK Then
        rtb.SelectionFont = FontDialog1.Font
    End If
  End Sub 
```

这会将颜色和文本样式应用于您在richtextbox 区域中双击的任何字符串...。

# vba - 将多个网页中的数据提取到 Excel 中 - 使用 VBA

> ID：15168459
> 
> 赞同：1
> 
> 时间：2013-03-01T23:15:53.420
> 
> 标签：vba, excel

我是宏的新手，并试图将以下网页中的数据提取到 excel 中。以下链接中的数据跨越 7 页（大约 3500 行）。我需要这些数据到我的 excel 工作簿中。

[http://www.moneycontrol.com/stocks/hist_stock_result.php?ex=N&sc_id=RI&pno=1&hdn=daily&fdt=2000-01-01&todt=2013-03-01](http://www.moneycontrol.com/stocks/hist_stock_result.php?ex=N&sc_id=RI&pno=1&hdn=daily&fdt=2000-01-01&todt=2013-03-01)

我在 excel 中尝试过 Web 数据导入功能。但是，由于未知原因，无法做到这一点。请有人帮忙......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T07:29:31.980

以下代码对我有用。它应该从网站获取第 1-7 页并将每个页面粘贴到单独的 excel 表中。

```
Private Const URL_TEMPLATE As String = "URL;http://www.moneycontrol.com/stocks/hist_stock_result.php?sc_id=RI&pno={0}&hdn=daily&fdt=2000-01-01&todt=2013-03-01"
Private Const NUMBER_OF_PAGES As Byte = 7

Sub test()
    Dim page As Byte
    Dim queryTableObject As QueryTable
    Dim url As String

    For page = 1 To NUMBER_OF_PAGES
        url = VBA.Strings.Replace(URL_TEMPLATE, "{0}", page)
        Set queryTableObject = ActiveSheet.QueryTables.Add(Connection:=url, Destination:=ThisWorkbook.Worksheets.Add.[a1])
        queryTableObject.WebSelectionType = xlSpecifiedTables
        queryTableObject.WebTables = "3"
        queryTableObject.Refresh
    Next page

End Sub 
```

# sed - sed语言翻译脚本——提高长文本的效率

> ID：15168464
> 
> 赞同：2
> 
> 时间：2013-03-01T23:16:08.780
> 
> 标签：sed

这是我的问题。我是一名西班牙语翻译，我有一个很长的西班牙语-英语词汇表文件——50K 条目。此外，我有一个超过 1K 条目的停用词词汇表。我想从我计划翻译的文本中删除这些条目。因此，我构建了一个 sed 脚本，该脚本又从词汇表中构建了另外两个 sed 脚本，它们进行剥离，只留下未翻译的文本（因此我不必两次解决相同的问题）。这很好用，但问题是长文本需要很长时间，有时超过 15 分钟。这只是不可避免的，还是有更有效的方法来做到这一点？

这是主要脚本：

```
#!/bin/sh
before="$(date +%s)"

#wordstxt=$(wc -w < $1)
#mintime=$(expr "$wordstxt / 200" |bc -l)
#maxtime=$(expr "$wordstxt / 175" |bc -l)
#echo "Estimated time to process: between $mintime and $maxtime seconds."
sed '
s/\,/\n/g           # strip all commas
s/\?/\n/g       # strip question marks
s/\*/\n/g       # strip asterisks
s/\!/\n/g           # strip exclamation marks
s/:/\n/g            # strip colons
s/\-/\n/g           # strip hyphens
s/\./\n/g           # strip periods
s/«/\n/g            # strip left Euro-quotes
s/»/\n/g            # strip right Euro-quotes
s/”/\n/g            # strip slanted US quotes
s/\"/\n/g       # strip left quotes
s/(/\n/g            # strip left paren
s/)/\n/g            # strip right paren
s/\[/\n/g           # strip left bracket
s/\]/\n/g           # strip right bracket
s/¿/\n/g            # "¿"
s/—/\n/g        # m-dash
s/\ –\ /\n/g        # n-dash
s/…/\n/g        # strip elipsis as a single character, not three periods
s/;/\n/g            # strip semicolon
s/[0-9]/\n/g        # strip out all numbers, replace with returns
' $1 > $1.z.tmp
#echo "Punctuation eliminated."

#cp ../../Spanish\ to\ English\ projects/glossary/stoplist.txt .
sed '
s/^\ //g        # strip leading spaces
s/\ $//         # strip trailing spaces
/^$/d           # delete blank lines
s/\./\n/g       # strip periods
s/\ /\\ /g      # make spaces into literals
s/^/s\//        # begins the substitution
s/$/\/\\n\/g/   # concludes the substitution

1 s/^/#!\ \/bin\/sed\ \-f\n\ns\/\[0\-9\]\/\/g\ns\/\\\ \\\ \/\\\ \/g\ns\/\\\.\\\ \/\\n\/g\n\n/

' stoplist.txt > stoplist.sed
chmod +x stoplist.sed
echo "Eliminating stopwords."
./stoplist.sed $1.z.tmp > $1.0.tmp

sed 's/\([A-Za-z\ ]*\t\).*/\1/' SpanishGlossary.utf8 > tempgloss.2.txt
#echo "Target phrases stripped."

sort -u tempgloss.2.txt > tempgloss.3.txt

awk '{ print length(), $0 | "sort -rn" }' tempgloss.3.txt > tempgloss.4.txt
#echo "List ordered by length."

#echo "Now creating new sed script." # THIS AFFECTS THE SED SCRIPT, NOT THE OUTPUT FILE.

sed '
s/[0-9]//g      # strip out all numbers
s/^\ //g        # strip leading spaces -- all lines have them due to the sort
/^$/d           # delete blank lines
s/\//\\\//g     # make text slashes into literals
s/"/\n/g            # strip quotes
s/\t//g         # strip tabs
s/\./\n/g       # strip periods
s/'\''/\\'\''/g     # make straight apostrophes into literals
s/'\’'/\\'\’'/g     # make curly apostrophes into literals
s/\ /\\ /g      # make spaces into literals
/^.\{0,5\}$/d       # delete lines with less than five characters
s/^/s\/\\b/     # begins the substitution
s/$/\\b\/\\n\/g/    # concludes the substitution

1 s/^/#!\ \/bin\/sed\ \-f\n\ns\/\[0\-9\]\/\/g\ns\/\\\ \\\ \/\\\ \/g\ns\/\\\.\\\ \/\\n\/g\n\n/

' tempgloss.4.txt > glossy.sed

#echo "glossy.sed created."
chmod +x glossy.sed

echo "Eliminating existing entries. This may take a while."
./glossy.sed $1.0.tmp > $1.1.tmp

echo "Now cleaning up lines."
sed -e '
s/\ $//         # strip trailing spaces
s/^\ *//g       # strip any and all leading spaces
s/\ el$//g      # strip "el" from the end
s/\ la$//g      # strip "la" from the end
s/\ los//g      # strip "los" from the end
s/\ las//g      # strip "las" from the end
s/\ o$//g       # strip "o" from the end
s/\ y$//g       # strip "y" from the end
s/\ $//         # strip trailing spaces (yes, again)
' $1.1.tmp > $1.2.tmp

echo "Creating ngrams."
./ngrams 5 < $1.2.tmp > $1.3.tmp 2> /dev/null

linecount="$(wc -l < $1.3.tmp)"
#echo $linecount "lines."
if [ "$linecount" -gt "1000" ]
then
    echo "Eliminating single instances."
    sed '/^1\t/d' $1.3.tmp > $1.4.tmp
else
    echo "Fewer than 1000 entries, so keeping all."
    cp $1.3.tmp $1.4.tmp
fi

sed -e '
s/[0-9]//g      # strip out all numbers
s/^\t//g            # strip leading tab
s/^\ *//g       # strip any and all leading spaces
/^.\{0,7\}$/d       # delete lines with less than six characters
s/\ $//         # strip trailing spaces (yes, again)
#s/$/\t/            # add in the tab
' $1.4.tmp > $1.csv

echo "Looking for duplicates."
sh ./dedupe $1.csv

wordstxt=$(wc -w < $1)
#echo $wordstxt
wordslist=$(wc -w < $1.csv)
#echo $wordslist
wordspercent=$(echo "scale=4; $wordslist / $wordstxt" |bc -l)
wordspercentage=$(echo "$wordspercent * 100" |bc -l)

after="$(date +%s)"
elapsed_seconds="$(expr $after - $before)"
rate=$(echo "scale=3; $wordstxt / $elapsed_seconds" |bc -l)
echo "Created "$1.csv", with $wordspercentage% left, in" $elapsed_seconds "seconds." #, for an effective rate of" $rate "words per second."

rm tempgloss.*.txt
rm *.tmp
rm glossy.sed 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T04:12:07.713

您可以将其中的许多组合起来，以提高速度

```
s/[\,\?\*\!:\-\.]/\n/g 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T13:51:27.410

在 awk 中重写脚本，它将在几秒钟而不是几分钟内运行，并且更简洁、更简单、更清晰。sed 是在单行上进行简单替换的出色工具。对于其他任何事情，只需使用 awk。

# php - PHP中的PATH_INFO没有明显的文件

> ID：15168466
> 
> 赞同：0
> 
> 时间：2013-03-01T23:16:14.947
> 
> 标签：php, pathinfo

我有一个简单的脚本：

索引.php：

```
<?php

$path= $_SERVER['PATH_INFO'];

if($path)
  echo $path;
else
  echo "No Path Info";

?> 
```

当我像这样运行它时，`www.website.com/index.php`它可以工作。即）`www.website.com/index.php/hello`会回声`/hello`

但是，如果我去`www.website.com/hello`，当我想要的`/hello`是回显时，我会收到一个 URL not found 错误。

我如何做到这一点，这样`index.php`PATH_INFO 就可以工作了？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:19:10.623

如果您使用的是 apache Web 服务器 - 在您的 .htaccess 中写入此规则。

```
RewriteEngine on
RewriteCond $1 !^(index\.php)
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:21:11.920

您将不得不根据您使用的服务器来重写 url 设置以使用干净的 url

检查这个[http://wettone.com/code/clean-urls](http://wettone.com/code/clean-urls)

这些线上的东西

```
RewriteEngine on
RewriteCond $1 !^(index\.php)
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:24:37.667

从服务器请求网页时。服务器查看路径（即 example.com/this/is/a/path）来确定要提供哪个文件以及从哪里提供服务。

据我了解，您要做的是让您的 index.php 处理所有请求。使用*URL 重写*的方式。

假设您使用的是 apache Web 服务器，您可以使用名为 *mod_rewrite* 的东西来执行此操作。[在此处查看有关 mod_rewrite 的更多信息](http://httpd.apache.org/docs/current/rewrite/intro.html)。

对于要使用的特定规则，您可能想要使用 V_K 答案中的代码之类的东西。

# python - 获取阿拉伯语单词的词根

> ID：15168468
> 
> 赞同：0
> 
> 时间：2013-03-01T23:16:20.937
> 
> 标签：python, nlp, arabic, stemming

我有一个 Python 代码，它采用阿拉伯语单词并获取词根并删除变音符号，但我的输出有问题。例如：当输入为“العربيه”时，输出为：“عرب”，但当输入为“كاتب”时，输出为：“ب”，当输入为“يخاف”时，输出为“خف”。

这是我的代码：

```
# -*- coding=utf-8 -*-

import re
from arabic_const import *
import Tashaphyne
from Tashaphyne import *
import enum
from enum import Enum
search_type=Enum('unvoc_word','voc_word','root_word')

HARAKAT_pat = re.compile(ur"[" + u"".join([FATHATAN, DAMMATAN, KASRATAN, FATHA, DAMMA, KASRA, SUKUN, SHADDA]) + u"]")
HAMZAT_pat = re.compile(ur"[" + u"".join([WAW_HAMZA, YEH_HAMZA]) + u"]");
ALEFAT_pat = re.compile(ur"[" + u"".join([ALEF_MADDA, ALEF_HAMZA_ABOVE, ALEF_HAMZA_BELOW, HAMZA_ABOVE, HAMZA_BELOW]) + u"]");
LAMALEFAT_pat = re.compile(ur"[" + u"".join([LAM_ALEF, LAM_ALEF_HAMZA_ABOVE, LAM_ALEF_HAMZA_BELOW, LAM_ALEF_MADDA_ABOVE]) + u"]");
#--------------------------------------
def strip_tashkeel(w):
        "strip vowel from a word and return a result word"
        return HARAKAT_pat.sub('', w)

#strip tatweel from a word and return a result word
#--------------------------------------
def strip_tatweel(w):
        "strip tatweel from a word and return a result word"
        return re.sub(ur'[%s]' % TATWEEL,       '', w)

#--------------------------------------
def normalize_hamza(w):
        "strip vowel from a word and return a result word"
        w = ALEFAT_pat.sub(ALEF, w)
        return HAMZAT_pat.sub(HAMZA, w)

#--------------------------------------
def normalize_lamalef(w):
        "strip vowel from a word and return a result word"
        return LAMALEFAT_pat.sub(u'%s%s' % (LAM, ALEF), w)

#--------------------------------------
def normalize_spellerrors(w):
        "strip vowel from a word and return a result word"
        w = re.sub(ur'[%s]' % TEH_MARBUTA,      HEH, w)
        return re.sub(ur'[%s]' % ALEF_MAKSURA,  YEH, w)

def normalize_text(word,searchtype):
        word = strip_tashkeel(word)
        word = strip_tatweel(word)
        word = normalize_lamalef(word)
        word = normalize_hamza(word)
        word = normalize_spellerrors(word)
        if searchtype==search_type.root_word.index:
           ArListem=ArabicLightStemmer();
           stem=ArListem.lightStm(word);
           word=ArListem.get_root();
        print word
        return word
#--------------------------------------------- 
```

这是测试代码：

```
**from task import normalize_text
normalize_text(u'كاتب',2) 
```

输出是：ب

# laravel - Laravel Eloquent ORM 的多对多 where_in 语法

> ID：15168469
> 
> 赞同：0
> 
> 时间：2013-03-01T23:16:26.140
> 
> 标签：laravel, eloquent

我正在努力使用 Laravel 的 Eloquent ORM 进行连接查询

我有两个具有多对多关系的类

```
class Type extends Eloquent
{
    public function activities()
    {
        return $this->has_many_and_belongs_to('Activity');
    }
}
class Activity extends Eloquent
{
    public function types()
    {
        return $this->has_many_and_belongs_to('Type');
    }
} 
```

在我的数据库中，我有类型、活动和活动类型表

我正在尝试重新创建以下 SQL 查询

```
SELECT a . * 
FROM activities a
JOIN activities_types at ON a.id = at.activities_id
WHERE at.type_id
IN ( 1, 2, 4 ) 
GROUP BY a.id 
```

我只是没有掌握 ORM 语法。我试过了

$activities = Activity::types().where_in("id", $types)->get();

但我得到一个错误`"Non-static method Activity::types() should not be called statically, assuming $this from incompatible context"`

感谢您的任何指点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T11:23:51.990

关系未定义为静态方法。因此你不能像`::type()`. 此外，人际关系并没有给你你想要的东西。因为您只对活动列感兴趣，所以您可以这样做：

```
$activities = Type::where_in("id", $types)->get()->activites()->group_by('id')->get(); 
```

另一方面，我认为您可以使用 join 来处理这个问题：

```
$activites = Activity::select('activities.*')->join('activities_types','activities.id','=','activities_types.activities_id')->where_in('activities_types.type_id',$types)->group_by('activities.id')->get(); 
```

# syntax - Applescript 语法错误“预期为“else”等，但发现脚本结尾。”

> ID：15168473
> 
> 赞同：0
> 
> 时间：2013-03-01T23:17:05.843
> 
> 标签：syntax, applescript

我在applescript中遇到了这个问题：

```
display dialog "Open Which Application" buttons {"Chrome", "AppleScript", "Textedit"} 
set the button_pressed to the button returned of the result
if the button_pressed is "Chrome" then
Open application "Google Chrome"-- action for 1st button goes here
if the button_pressed is "Applescript" then
Open application "Applescript Editor"-- action for 2nd button goes here
if the button_pressed is "Textedit" then
Open application "Textedit"-- action for 3rd button goes here
end 
```

它一直说 SYNTAX ERROR: Expected "else" 等，但发现脚本结尾。

我应该怎么办

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:44:48.350

尝试：

```
display dialog "Open Which Application" buttons {"Chrome", "AppleScript", "Textedit"}
set the button_pressed to the button returned of the result
if the button_pressed is "Chrome" then tell application "Google Chrome" to activate -- action for 1st button goes here 
if the button_pressed is "Applescript" then tell application "AppleScript Editor" to activate -- action for 2nd button goes here 
if the button_pressed is "Textedit" then tell application "TextEdit" to activate -- action for 3rd button goes here end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:35:46.967

你有三个`if`陈述，但你只有`end`其中一个。

您可能想要的是`else if`：

```
display dialog "Open Which Application" buttons {"Chrome", "AppleScript", "Textedit"}
set the button_pressed to the button returned of the result
if the button_pressed is "Chrome" then
    open application "Google Chrome" -- action for 1st button goes here
else if the button_pressed is "Applescript" then
    open application "AppleScript Editor" -- action for 2nd button goes here
else if the button_pressed is "Textedit" then
    open application "TextEdit" -- action for 3rd button goes here
end if 
```

（另外，你真的应该使用`end if`，而不仅仅是`end`，AppleScript Editor 会为你解决这个问题。）

或者，您可以`end`每个：

```
display dialog "Open Which Application" buttons {"Chrome", "AppleScript", "Textedit"}
set the button_pressed to the button returned of the result
if the button_pressed is "Chrome" then
    open application "Google Chrome" -- action for 1st button goes here
end if
if the button_pressed is "Applescript" then
    open application "AppleScript Editor" -- action for 2nd button goes here
end if
if the button_pressed is "Textedit" then
    open application "TextEdit" -- action for 3rd button goes here
end if 
```

但是，这些案例显然是互斥的，因此没有理由不使用`else if`。

如果有帮助，请一一输入这些行，然后查看 AppleScript Editor 是如何缩进它们的：

```
display dialog "Open Which Application" buttons {"Chrome", "AppleScript", "Textedit"} 
set the button_pressed to the button returned of the result
if the button_pressed is "Chrome" then
    Open application "Google Chrome"-- action for 1st button goes here
    if the button_pressed is "Applescript" then
        Open application "Applescript Editor"-- action for 2nd button goes here
        if the button_pressed is "Textedit" then
            Open application "Textedit"-- action for 3rd button goes here
        end 
```

这应该很明显出了什么问题。

# c# - 无法从 SortedList 中获取枚举器

> ID：15168476
> 
> 赞同：1
> 
> 时间：2013-03-01T23:17:11.640
> 
> 标签：c#, sortedlist, enumerator

我有这个对象：

```
class Animation
    {
        //[...]
        private SortedList<int,Frame> frames = new SortedList<int,Frame>();
        private IDictionaryEnumerator frameEnumerator = null;

        //[...]

        public void someFunction() {
            frameEnumerator = frames.GetEnumerator(); //throw error
        }

        //[...]

} 
```

我在那里查看 msn 文档：http: [//msdn.microsoft.com/en-us/library/system.collections.sortedlist.getenumerator.aspx](http://msdn.microsoft.com/en-us/library/system.collections.sortedlist.getenumerator.aspx)，看起来我的代码是正确的，但 VS 说：

> 无法将 System.Collections.Generic.IEnumerator>' 转换为 'System.Collections.IDictionaryEnumerator'。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T23:19:19.970

该`IDictionaryEnumerator`类型用于较旧的非泛型集合类型。在这种情况下，您有一个强类型集合，它会改为返回`IEnumerater<KeyValuePair<int, Frame>>`. 改用该类型

```
private IEnumerator<KeyValuePair<int, Frame>> frameEnumerator = null; 
```

注意：枚举器类型`SortedList<TKey, TValue>`确实实现了`IDictionaryEnumerator`接口。如果您真的更喜欢那个，您可以使用显式强制转换来访问它

```
frameEnumerator = (IDictionaryEnumerator)frames.GetEnumerator(); 
```

不过我会避开这条路线。最好使用强类型接口并避免在代码中进行不必要的强制转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:19:52.310

尝试投

```
frameEnumerator = frames.GetEnumerator() as IDictionaryEnumerator; 
```

之后确保检查是否`frameEnumerator`为空。

# jquery - 如何使用 jQuery 滑动过渡到新页面？

> ID：15168489
> 
> 赞同：1
> 
> 时间：2013-03-01T23:18:18.553
> 
> 标签：jquery, slide, transitions

我正在尝试和这个网站做同样的事情：[http ://touchtech.co.nz/#!/](http://touchtech.co.nz/#!/)

如果你点击他们的导航菜单，它会滑到一个新页面（它不仅仅是一个图像滑块，它实际上是把你带到一个新页面）。

他们是为此的插件，还是有人知道该怎么做？

最好的，亚历克斯

ps 我知道你可以使用 jquery 移动框架来做到这一点，但我不想使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:24:23.550

这是一个 SPA（单页应用程序）。所有视图均已预加载。您在 URL 中看到的更改是 jQuery 库（如`sammy.js`或`history.js`. 我不知道您使用哪个平台进行软件开发，但如果是 ASP.NET MVC，请查看[http://www.asp.net/single-page-application](http://www.asp.net/single-page-application)以了解它是如何工作的。

# ruby-on-rails - 带有 Rails 应用程序的 Ubuntu 上的权限问题

> ID：15168490
> 
> 赞同：3
> 
> 时间：2013-03-01T23:18:34.327
> 
> 标签：ruby-on-rails, linux, apache, ubuntu, actionview

我的 Ubuntu/Apache/Passenger 服务器上的 Rails 存在权限问题。

当我查看我的 Apache`error_log`文件时，我看到：

```
ActionView::Template::Error (Permission denied - /opt/bitnami/apps/tradelogs/tmp/cache/790):
  78:
  79: <% end %>
  80:
  81: <% cache do %> 
```

当我查看我的目录时，我看到了（[因为我的乘客似乎将其用作用户](http://www.modrails.com/documentation/Users%20guide%20Apache.html#user_switching)）：

```
-rwxr-xr-x 1 bitnami daemon  154 Feb 28 04:42 config.ru
-rwxr-xr-x 1 bitnami daemon   147 Feb 28 04:42 environment.rb 
```

对于 tmp/cache 目录（缓存中没有`790`文件 - 我不确定是否要创建一个）：

```
drwxr-xr-x 6 bitnami daemon 4096 Feb 28 04:44 tmp
drwxr-xr-x 4 bitnami daemon 4096 Feb 28 05:42 tmp/cache 
```

在我的 Apache`httpd.conf`文件中，我有这个：

```
User bitnami
Group daemon

<VirtualHost *:80>
  DocumentRoot /home/bitnami/apps/tradelogs/public
  <Directory /home/bitnami/apps/tradelogs/public>
    Allow from all
    Options -MultiViews
  </Directory>
</VirtualHost> 
```

我尝试过的事情：

*   `chmod -R 775`, 755 在所有目录上
*   将`user`and`group`中的and 更改`httpd.conf`为 both `daemon`, and to both`bitnami`

谁能帮我弄清楚我的授权哪里错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:20:54.757

您是否在您之前或之后更改了权利`rake assets:precompile`

另外，您是否在更改权限后重新启动了 Web 服务？

`sudo /etc/init.d/apache2 restart`

# sharpdevelop - Foreach 循环 VB.Net 到 C# 代码转换

> ID：15168495
> 
> 赞同：3
> 
> 时间：2013-03-01T23:18:58.223
> 
> 标签：sharpdevelop, vb.net-to-c#, code-conversion

这是VB.Net中的代码

```
If Not queryItems Is Nothing Then
                For Each qItem As String In queryItems
                    qItem = qItem.ToLower()
                Next
End If 
```

它是c#中的“等效”代码（使用sharpdevelop/developerfusion/telerik的转换器/VS 2012“粘贴为c#”方法）

```
if (queryItems != null)
{
    foreach (string qItem in queryItems)
    {
        qItem = qItem.ToLower();
    }
} 
```

C# 编译器（正确如此）抱怨以下内容

```
"Cannot assign to 'qItem' because it is a 'foreach iteration variable'" 
```

我想知道为什么在 VB.Net 中允许这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:37:58.237

问题的症结似乎是这个

> 我想知道为什么在 VB.Net 中允许这种行为？

一个更好的问题可能是以下

> 为什么 C# 阻止分配给 foreach 迭代变量？

如果您查看一组 lopping 结构和语言，C# 在这里是个奇怪的球。在几乎所有其他情况下（甚至在 Java 中`foreach`），分配给循环构造的迭代变量是合法的。我知道的唯一其他情况是

*   F#：默认情况下变量是只读的，所以这只是与语言的其余部分保持一致
*   `for`Ada：不允许在语句中分配循环值

VB.Net 在这里实际上比 C# 更符合规范。

不幸的是，目前尚不清楚 C# 做出这个选择的原因。那里有很多推测性的答案，但直到埃里克或安德斯对此发表博客文章，真正的原因仍然未知

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:24:53.153

在循环中将（数组？列表？）中的每个字符串设置为小写是完全合理的。

建议：只需使用一个很好的旧“for（）”循环 -

```
// Assuming array syntax...
if (queryItems != null)
{
    for (int i=0; i < queryItems.Length; i++)
    {
        queryItems[i] = queryItems[i].ToLower();
    }
} 
```

恕我直言...

PS：我不确定 VB.Net 版本是否真的按预期工作。你知道吗？

# php - 尝试在 codeigniter 中使用 getJSON 时遇到问题

> ID：15168497
> 
> 赞同：-1
> 
> 时间：2013-03-01T23:19:07.283
> 
> 标签：php, javascript, ajax, codeigniter

我正在尝试使用 codeigniter 在我的网站中实现 AJAX 调用方法，我想使用 AJAX 的原因是我可以从数据库中获取实时更新

单击按钮可以工作并显示所有 JSON 数据，但问题是当我尝试显示它无法识别的特定数组时，它似乎在遍历每个字符。

另一个奇怪的事情是当警报被调用时，我可以看到 **我希望能够打印特定数组的 html 和 head 标签，例如数组 id”**

我为尝试解决问题所做的事情

*   我已经提醒了数据类型，发现它是一个字符串

*   我已经设法让 ajax 在常规 PHP 中工作，而不是在 codeigniter 中工作，所以他们的数据库没有问题

*   我也尝试过使用 jQuery.parseJSON 所以我可以强制它是 json 但是脚本没有运行

*   我使用了 JSONlint，显然它是一个有效的 JSON

任何帮助，将不胜感激

控制器

```
public function insertJSON()
{
    $this->load->model("values");
    $queryresults = $this->values->getDb();

    $arrays = array($queryresults);

    echo json_encode($arrays);  
} 
```

看法

```
<script type='text/javascript' language='javascript'>

  $('#getdata').click(function (data) {

      $.ajax({

          url: '<?php echo base_url().'index.php/welcome/insertJSON';?>',
          type: 'POST',
          cache: 'false',
          datatype: 'json'

      }).done(function (data) {

         alert(data);

      });

  });

</script> 
```

json_encode

```
[
[
    {
        "id": "1",
        "postcode": "NW6",
        "imgurl": "hello.jpeg",
        "from_user": "henny",
        "created_at": "2013-03-18 23:03:00"
    },
    {
        "id": "2",
        "postcode": "NW2",
        "imgurl": "test.jpeg",
        "from_user": "belly",
        "created_at": "2013-03-15 23:03:00"
    }
]
] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:24:52.990

```
$data[] = $arr; // <--- This $arr doesn't exist.

echo json_encode($data); 
```

您正在编码一个空白数组。你也没有正确地将你的数组发送到视图，你不应该只是回应它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T07:52:59.897

缺少的变量 $arr 应该是在循环之前声明的 $array 变量。这会做：

```
public function insert()
{

    $this->load->model("values");

    $queryresults = $this->values->Query();

    $array = array();

    foreach($queryresults as $row)
    {
        $array[] =  $row->postcode;
    }

    $data = array();

    $data[] = $array; // <--- The fix!

    echo json_encode($data);

    $this->load->view('answer', $data);
} 
```

在进行实际检查之前，请考虑仔细检查您的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T02:14:01.637

@Ben 是对的，`$arr`从哪里来？

```
public function insert()
{

    $this->load->model("values");

    $queryresults = $this->values->Query();

    $array = array();

    foreach($queryresults as $row)
    {
        $array[] =  $row->postcode;
    }

    echo json_encode($array);
    exit; 
//    Just echo it out, no need to load view!
//    $this->load->view('answer', $data);
} 
```

# javascript - JQuery追加循环回调函数

> ID：15168499
> 
> 赞同：1
> 
> 时间：2013-03-01T23:19:15.700
> 
> 标签：javascript, jquery, callback

第一段代码工作正常，但我想知道为什么我的第二段代码不起作用。我在控制台中没有收到任何错误，但选择下拉列表中没有显示任何内容。

**作品**

```
var select = $('<select />');
$.each(json, function(grp, lnk) {
  var group = $('<optgroup />', { label:grp });
  $.each(lnk, function(txt, val) {
    $('<option />', { value:val, text:txt }).appendTo(group);
  });
  group.appendTo(select);
}); 
```

**破碎的**

```
var select = $('<select />').append(function() {
  $.each(json, function(grp, lnk) {
    return $('<optgroup />', { label:grp }).append(function() {
      $.each(lnk, function(txt, val) {
        return $('<option />', { value:val, text:txt });
      });
    });
  });
}); 
```

**JSON** *w3.js*

```
var w3BaseUrl = 'http://www.w3schools.com/';

var w3 = {
  'HTML / CSS' : {
    'Learn HTML' : 'html/default.asp',
    'Learn HTML5' : 'html/html5_intro.asp',
    'Learn CSS' : 'css/default.asp',
    'Learn CSS3' : 'css3/default.asp',
  },
  'JavaScript' : {
    'Learn JavaScript' : 'js/default.asp',
    'Learn HTML DOM' : 'htmldom/default.asp',
    'Learn jQuery' : 'jquery/default.asp',
    'Learn AJAX' : 'ajax/default.asp',
    'Learn JSON' : 'json/default.asp',
    'Learn Google Maps' : 'googleAPI/default.asp',
  },
  'Server Side' : {
    'Learn PHP' : 'php/default.asp',
    'Learn SQL' : 'sql/default.asp',
    'Learn ASP' : 'asp/default.asp',
    'Learn ADO' : 'ado/default.asp',
    'Learn VBScript' : 'vbscript/default.asp',
  },
  'ASP.NET' : {
    'Learn ASP.NET' : 'aspnet/default.asp',
    'Learn Web Pages' : 'aspnet/webpages_intro.asp',
    'Learn Razor' : 'aspnet/razor_intro.asp',
    'Learn MVC' : 'aspnet/mvc_intro.asp',
    'Learn Web Forms' : 'aspnet/aspnet_intro.asp',
    'Learn .NET Mobile' : 'dotnetmobile/default.asp',
  },
  'XML Tutorials' : {
    'Learn XML' : 'xml/default.asp',
    'Learn DTD' : 'dtd/default.asp',
    'Learn XML' : 'DOM dom/default.asp',
    'Learn XSLT' : 'xsl/default.asp',
    'Learn XPath' : 'xpath/default.asp',
    'Learn XQuery' : 'xquery/default.asp',
    'Learn XLink' : 'xlink/default.asp',
    'Learn XPointer' : 'xlink/default.asp',
    'Learn Schema' : 'schema/default.asp',
    'Learn XSL-FO' : 'xslfo/default.asp',
    'Learn SVG' : 'svg/default.asp',
  },
  'Web Services' : {
    'Learn Web Services' : 'webservices/default.asp',
    'Learn WSDL' : 'wsdl/default.asp',
    'Learn SOAP' : 'soap/default.asp',
    'Learn RSS' : 'rss/default.asp',
    'Learn RDF' : 'rdf/default.asp',
  },
  'Web Building' : {
    'Web Building' : 'web/default.asp',
    'Web Browsers' : 'browsers/default.asp',
    'Web Certification' : 'cert/default.asp',
    'Web Hosting' : 'hosting/default.asp',
    'Web TCP/IP' : 'tcpip/default.asp',
    'Web W3C' : 'w3c/default.asp',
    'Web Quality' : 'quality/default.asp',
  },
}; 
```

**Javascript** *utils.js*

```
function setSelect(selId, json, baseUrl) {
  var select = $('<select />');
  $.each(json, function(grp, lnk) {
    var group = $('<optgroup />', { label:grp });
    $.each(lnk, function(txt, val) {
      $('<option />', { value:val, text:txt }).appendTo(group);
    });
    group.appendTo(select);
  });
  select.change(function() {
    window.open(baseUrl+select.val(),'_blank');
  });
  $(selId).replaceWith(select);
};

function setSelect2(selId, json, baseUrl) {
  var select = $('<select />').append(function() {
    $.each(json, function(grp, lnk) {
      return ($('<optgroup />', { label:grp }).append(function() {
        $.each(lnk, function(txt, val) {
          return $('<option />', { value:val, text:txt });
        )});
      )});
    )});
  });
  select.change(function() {
    window.open(baseUrl+select.val(),'_blank');
  });
  $(selId).replaceWith(select);
} 
```

**HTML**

```
<!html>
<html>
  <head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <script rel="javascript" type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script rel="javascript" type="text/javascript" src="utils.js"></script>
    <script rel="javascript" type="text/javascript" src="w3.js"></script>
    <script type="text/javascript">
      $(document).ready(function() {
        setSelect('#w3', w3, w3BaseUrl);
      });
    </script>
  </head>
  <body>
    <h1>W3Schools</h1>
    <select id="w3"></select>
   </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:28:35.890

你`return`在`$.each`回调 fns 中的 s。没有做你认为他们正在做的事情。它们不适用于方法的回调函数，它们只是通过结束该内部 fn 的当前实例来`append`充当循环中的语句。请参阅示例前一行`continue`的文档。[`$.each`](http://api.jquery.com/jQuery.each/#entry-examples)

```
var select = $('<select />').append(function() {
    var $optGroups = $();
    $.each(json, function(grp, lnk) {
        $optGroups = $optGroups.add(
            $('<optgroup />', { label:grp }).append(function() {
                var $opts = $();
                $.each(lnk, function(txt, val) {
                    $opts = $opts.add(
                        $('<option />', { value:val, text:txt })
                    );
                });
                return $opts;
            })
        );
    });
    return $optGroups;
}); 
```

# java - 性能工程：测量周转时间的结果不一致

> ID：15168509
> 
> 赞同：1
> 
> 时间：2013-03-01T23:19:40.407
> 
> 标签：java, performance

我很难措辞这个问题，因为这是我测量功能吞吐量的第一个任务。

问题是，当我针对应用服务器运行一组测试时，有时每个工作单元的平均周转时间为 27 秒。几秒钟后，我开始获得每单位工作 10 秒的周转时间（同时执行同一组测试）。有人怎么解释这个？我是唯一使用此服务器的人，因此我不能将其归咎于任何其他测试。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T23:22:36.253

JIT 可能会在几秒钟后启动，并将您的代码编译为本机代码，以便它运行得更快。也可能会产生缓存效应，其中温（CPU 和磁盘）缓存会加快运行速度。

为了在进行性能测量时获得可重复的结果，必须将任务刻录一段时间，直到指标稳定。

# clojure - How can I tell if my library is signed on Clojars?

> ID：15168512
> 
> 赞同：2
> 
> 时间：2013-03-01T23:19:55.540
> 
> 标签：clojure, code-signing

I recently deployed a library to Clojars and tried to ensure that it was signed, but can't see any evidence of that one way or the other.

Here are the steps I followed:

I already have gpg installed (Linux system), gpg-agent running and have generated public/private key pair. I also added my GPG public key to Clojars when I signed up.

I created ~/.lein/credentials.clj with:

```
{#"https://clojars.org/repo"
  {:username "midpeter444" :password "passw0rd"}} 
```

I then ran:

```
gpg --default-recipient-self -e ~/.lein/credentials.clj > ~/.lein/credentials.clj.gpg 
```

and then deleted ~/.lein/credentials.clj

In my lein project directory, I ran:

```
lein deploy clojars 
```

It prompted me twice (via gpg-agent) to enter my password, which I did and then it uploaded the jar to Clojars.

So it seemed like it worked, but when I look at my library on the Clojars site or at the library after I download it from Clojars I can't see any evidence that it is signed or whether it failed.

Do I need do anything else, like add a note in the project.clj to sign it somehow?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T00:08:29.213

*   Log in to [clojars](http://clojars.org)
*   Once at the dashboard, click on the library in question
*   Check the *promotion* section

If the jar is not signed, you'll see a message like:

> *   /home/clojars/repo/blah/blah/0.0.1/blah-0.0.1.jar is not signed.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-03T03:26:09.237

After researching it some more, lein 2 will automatically sign your jars if you have added your PGP public key to your Clojars account. If you run `lein deps :verify` it will tell you whether the library is signed.

So you can create a project that uses your published library and run this command.

Example output:

```
$ lein deps :verify
:signed [criterium "0.3.1"]
:unsigned [enlive "1.0.1"]
:signed [org.clojure/tools.macro "0.1.1"]
:signed [org.clojure/clojure "1.5.0"]
:bad-signature [thornydev/go-lightly "0.4.0"] 
```

I see that mine (go-lightly) is marked as having a bad signature, so now I need to figure out why. The Clojars site did not tell me this (or at least I don't know where to look for it), so I think using `lein deps :verify` is the better answer.

**[Update]:** The bad signature came about because I tried to redeploy a library (same version) *after* I had already promoted it, uncovering a bug in the Clojars system (currently being fixed).

If you do get a `:bad-signature`, you'll need to redeploy to Clojars (after the Clojars guys remove the bad lib). Then to check whether the signature is correct, make sure to delete that library from your local ~/.m2 repo so that the new one will be downloaded and checked for valid signature.

# c++ - ShowWindow 无效的窗口句柄

> ID：15168513
> 
> 赞同：3
> 
> 时间：2013-03-01T23:20:00.377
> 
> 标签：c++, windows, winapi, getlasterror, showwindow

我最近一直在尝试使用 C++ 中的 Windows API 创建一个窗口类。但是，每当我尝试调用 ShowWindow 时，该函数都会将最后一个错误设置为 1400 (ERROR_INVALID_WINDOW_HANDLE)。尝试了一段时间后，我偶然发现了以下示例：http: [//blogs.msdn.com/b/oldnewthing/archive/2005/04/22/410773.aspx#comments](http://blogs.msdn.com/b/oldnewthing/archive/2005/04/22/410773.aspx#comments)

即使创建一个新项目（我使用 MSVC Express 2008）并准确复制代码（我讨厌这样做），我发现，虽然代码成功创建了一个窗口，但 ShowWindow 函数仍然报告错误 1400。这是摘自在上面的链接中找到的代码：

```
int PASCAL
WinMain(HINSTANCE hinst, HINSTANCE, LPSTR, int nShowCmd)
{
 g_hinst = hinst;

 if (SUCCEEDED(CoInitialize(NULL))) {
  InitCommonControls();

  RootWindow *prw = RootWindow::Create();
  if (prw) {
   ShowWindow(prw->GetHWND(), nShowCmd);
   int error = GetLastError(); //Line added by me, error gets set to 1400.
   MSG msg;
       while (GetMessage(&msg, NULL, 0, 0)) {
    TranslateMessage(&msg);
    DispatchMessage(&msg);
   }
  }
  CoUninitialize();
 }
 return 0;
} 
```

（完整的代码可以在上面的链接中找到）

如果有人对如何将窗口句柄作为类的成员变量而不在 ShowWindow 上收到错误 1400 有任何想法，我将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T00:18:06.870

```
 ShowWindow(prw->GetHWND(), nShowCmd);
   int error = GetLastError(); 
```

这不是正确的代码。调用 GetLastError() 唯一有效的时间是 winapi 函数**失败**时。如果您在*没有*失败时使用 GetLastError()，那么您将获得一个完全随机的数字。ShowWindow() 有点特殊，因为它根本不会产生错误代码，因此使用 GetLastError()*永远不会*正确。

通用模式大致是：

```
if (!SomeWinapiFunction(...)) {
    int error = GetLastError();
    CrashAndBurn(error);
} 
```

但是请检查 MSDN 文档以查看指示错误的返回值以及 GetLastError() 是否合适。例如，它通常不在 GDI 功能上。请务必在代码的其他部分也进行更正。使用原始 api 时，正确处理错误*非常重要。*特别注意您的 RootWindow::Create() 方法没有很好的方法来指示创建窗口失败。这需要修复。例外当然是一个很好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-06T14:14:39.070

我有同样的问题。解决方案是将**DefWindowProc()**从**默认值移到****WndProc()**的末尾。

前：

```
LRESULT CALLBACK WndProc( HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam )
{
    static HBITMAP hBitMap;
    static int cxSizeBitMap;
    static int cySizeBitMap;
    static int cxClient;
    static int cyClient;
    HDC hdc;
    BITMAP bitMap;
    PAINTSTRUCT ps;
    HDC hMem;
    HINSTANCE      hInstance ;
    switch( message ) 
    {
        case WM_CREATE:
            hInstance = ((LPCREATESTRUCT) lParam)->hInstance ;
            hBitMap = LoadBitmap( hInstance, MAKEINTRESOURCE( IDB_BRICK ) );
            GetObject( hBitMap, sizeof(BITMAP), &bitMap );
            cxSizeBitMap = bitMap.bmWidth;
            cySizeBitMap = bitMap.bmHeight;
            break;
        case WM_SIZE:
          cxClient = LOWORD (lParam) ;
          cyClient = HIWORD (lParam) ;
            break;
        case WM_PAINT:
            hdc = BeginPaint( hWnd, &ps );
            hMem = CreateCompatibleDC( hdc );
            SelectObject( hMem,  hBitMap );
            for (int y = 0 ; y < cyClient ; y += cySizeBitMap)
            for (int x = 0 ; x < cxClient ; x += cxSizeBitMap)
            {
               BitBlt (hdc, x, y, cxSizeBitMap, cySizeBitMap, hMem, 0, 0, SRCCOPY) ;
            }
            DeleteDC( hMem );
            EndPaint( hWnd, &ps );
            break;
        case WM_DESTROY:
            DeleteObject( hBitMap );
            PostQuitMessage( 0 );
            break;
        default:
            // In this cast ShowWindow() will return 1400.
            DefWindowProc(hWnd, message, wParam, lParam);
    }

    return 0;
} 
```

后：

```
LRESULT CALLBACK WndProc( HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam )
{
    static HBITMAP hBitMap;
    static int cxSizeBitMap;
    static int cySizeBitMap;
    static int cxClient;
    static int cyClient;
    HDC hdc;
    BITMAP bitMap;
    PAINTSTRUCT ps;
    HDC hMem;
    HINSTANCE      hInstance ;
    switch( message ) 
    {
        case WM_CREATE:
            hInstance = ((LPCREATESTRUCT) lParam)->hInstance ;
            hBitMap = LoadBitmap( hInstance, MAKEINTRESOURCE( IDB_BRICK ) );
            GetObject( hBitMap, sizeof(BITMAP), &bitMap );
            cxSizeBitMap = bitMap.bmWidth;
            cySizeBitMap = bitMap.bmHeight;
            break;
        case WM_SIZE:
          cxClient = LOWORD (lParam) ;
          cyClient = HIWORD (lParam) ;
            break;

        case WM_PAINT:
            hdc = BeginPaint( hWnd, &ps );
            hMem = CreateCompatibleDC( hdc );

            // Было SelectObject( hdc,  hMem );
            SelectObject( hMem,  hBitMap );
            // Было BitBlt( hdc, 0, 0, cxSize, cySize, hMem, 0, 0, DIB_RGB_COLORS);
            for (int y = 0 ; y < cyClient ; y += cySizeBitMap)
            for (int x = 0 ; x < cxClient ; x += cxSizeBitMap)
            {
               BitBlt (hdc, x, y, cxSizeBitMap, cySizeBitMap, hMem, 0, 0, SRCCOPY) ;
            }

            DeleteDC( hMem );
            EndPaint( hWnd, &ps );
            break;
        case WM_DESTROY:
            DeleteObject( hBitMap );
            PostQuitMessage( 0 );
            break;
    }

    // In this case ShowWindow() will show the window.
    return DefWindowProc(hWnd, message, wParam, lParam);;
} 
```

# path - 如何在 Mac 10.8.2 中编辑 PATH 变量？

> ID：15168514
> 
> 赞同：4
> 
> 时间：2013-03-01T23:20:13.937
> 
> 标签：path, osx-mountain-lion

我在编辑我的`PATH`. 我已经看到添加到前面或后面的说明`PATH`，但我实际上想更改我的位置的顺序`PATH`，所以我真的很想访问编辑它。**

到目前为止，我一直在使用终端，因为我不知道如何访问`PATH`。

当我尝试时，`ECHO $PATH`我得到：

```
/opt/local/bin:/opt/local/sbin:/Library/Frameworks/Python.framework/Versions/2.6/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/Users/erensila/.rvm/bin 
```

但是，我似乎找不到包含所有这些信息的任何文件。

一方面，我的`.profile`主目录或其他任何地方似乎都没有。似乎包含任何 PATH 相关信息的唯一文件是我的`~/.bash_profile`，但该文件似乎只处理将 Python 和 RVM 相关位置添加到`PATH`.

如果有人可以帮助我了解如何编辑 PATH/在哪里访问它，我将不胜感激。另外，我是否应该担心我没有 .profile？那是我应该以某种方式创造的东西吗？

谢谢！

**我希望能够编辑 PATH 而不仅仅是将路径附加到开头或结尾的原因是因为 Homebrew 建议 /usr/local/bin 在 PATH 中位于 /usr/bin 之前。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T23:30:35.287

也尝试检查 /etc/paths 有很多地方可以设置/编辑路径，但据我所知，这通常是 10.8 中路径的全局来源

# ruby-on-rails - 如果更改页面，则字符串化键错误

> ID：15168517
> 
> 赞同：0
> 
> 时间：2013-03-01T23:20:24.467
> 
> 标签：ruby-on-rails

我有一个使用 javascript 在第一页上制作问答游戏的 rails 应用程序。但是，如果在玩游戏后或在游戏过程中，用户单击主页上的任何链接（与游戏无关）重定向到另一个页面（例如，指向个人资料页面的链接），那么我会收到错误消息

```
undefined method `stringify_keys' for "Quiz question..?":String 
```

在用户控制器的显示操作中（例如，如果他们单击了个人资料链接）

此外，一旦触发错误，就很难恢复应用程序。我认为导致错误的字符串正在被缓存......

有没有办法防止该错误被提出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:45:24.787

问题似乎是我在两种不同的情况下使用了相同的会话变量。在主页上，我创建了一个`session[:question]`来存储测验的问题。但是，在个人资料页面上，我还允许用户创建问题并将它们存储在 `session[:question]' 中。因此，当我从主页移动到用户个人资料页面时，触发了某些导致错误的逻辑。但是，将其中一个 session[:question] 重命名为 session[:userquestion] 解决了这个问题。

# jquery - jQuery：可以读取松散的文本但不能正确更新

> ID：15168526
> 
> 赞同：3
> 
> 时间：2013-03-01T23:20:44.587
> 
> 标签：jquery, html

所以我有表格单元格，例如：

```
<td class="right footerCell">
    $51,888,734.24
    <div class="fht-cell" style="width: 128px;"></div>
</td> 
```

我知道文本可能在 div 内，但这个标记部分是由插件生成的。有时，我想在不影响 div 的情况下更新单元格内的数量（插件用于使单元格具有特定宽度）。我目前能够匹配需要更新的文本元素，我什至可以读取正确的值，但是当我尝试更改它时，它根本没有。我正在使用这样的东西：

```
//selects one of the cells above at a specific column
var totalCell = $("div.fht-fixed-body div.fht-tfoot table.fht-table tr > td.right.footerCell:nth-child(" + childNumber + ")");

//prints out $51,888,734.24
console.log($(totalCell).contents().eq(0).text());

$(totalCell).contents().eq(0).text("VALUE HAS BEEN CHANGED FOREVER!");

//prints out $51,888,734.24 again
console.log($(totalCell).contents().eq(0).text()); 
```

这可能是非常愚蠢的事情，但我无法看到它。任何帮助表示赞赏，谢谢。

**编辑** 这是相应的[JS Fiddle](http://jsfiddle.net/Snhgn/1/)。您需要检查控制台以正确测试它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:53:58.293

jQuery 似乎不喜欢更改文本节点。希望其他人可以解释原因，但最简单的方法是创建一个新的文本节点，插入它，然后删除旧的：

```
$(totalCell).contents().eq(0).before('Changed Forever').remove(); 
```

当然，这比解决方案更像是一种解决方法，但应该足以满足您的需求，并且它会产生相同的 DOM 结构（即不将其包装在 span 标签或类似标签中）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T16:13:28.457

解决这个问题并不复杂，只需替换 jQuery 方法：

```
$(totalCell).contents().eq(0).text("VALUE HAS BEEN CHANGED FOREVER!"); 
```

和：

```
totalCell[0].childNodes[0].nodeValue = 'value has been changed forever'; 
```

[JS小提琴](http://jsfiddle.net/davidThomas/Snhgn/3/)。

或者，如果您想坚持使用“more-jQuery”方法，您可以使用：

```
totalCell.contents().eq(0).text(function(){
    return this.nodeValue = "VALUE HAS BEEN CHANGED FOREVER!";
}); 
```

[JS小提琴](http://jsfiddle.net/davidThomas/Snhgn/4/)。

虽然 jQuery 无法*轻松*处理设置 a 的值`textNode`，但*可以*简单地使用原生 JavaScript 来完成，因此在`nodeValue`上述两种方法中都使用了。与其使用复杂的选择器，不如简单地：

```
/* if you don't need to retain the jQuery methods of the selected node,
   I'd suggest using:
   $(".fht-cell").eq(0).get(0);
   omitted in this demo because I didn't know if you needed the jQuery methods */
var totalCell = $(".fht-cell").eq(0);

/* the `.get(0)` 'drops' the jQuery-wrapped node to a plain DOM node,
   allowing us to use native JavaScript traversal methods */
console.log("Before: " + totalCell.get(0).previousSibling.nodeValue);

// updating the nodeValue of the textNode:
totalCell.get(0).previousSibling.nodeValue = 'Value has been changed forever!';

console.log("After: " + totalCell.get(0).previousSibling.nodeValue); 
```

[JS小提琴](http://jsfiddle.net/davidThomas/Snhgn/5/)。

顺便说一句，鉴于以下情况：

```
var totalCell = $("td.right.footerCell").eq(0); 
```

`totalCell`*已经*是一个 jQuery 对象，你不需要用 jQuery 重新包装它，因此：

```
$(totalCell).contents().eq(0).text("VALUE HAS BEEN CHANGED FOREVER!"); 
```

与以下*内容完全相同*：

```
totalCell.contents().eq(0).text("VALUE HAS BEEN CHANGED FOREVER!"); 
```

但后者更高效/简洁，JS Perf 建议在不必要地重新包装 jQuery 对象时对性能[造成轻微（但*绝对不必要*）的影响。](http://jsperf.com/effects-of-re-wrapping-jquery-objects)

参考：

*   [`get()`](http://api.jquery.com/get/).
*   [`Node.nodeValue`](https://developer.mozilla.org/en-US/docs/DOM/node.nodevalue).

# r - 在r中按自己的功能组进行优化

> ID：15168527
> 
> 赞同：1
> 
> 时间：2013-03-01T23:20:46.660
> 
> 标签：r, optimization, plyr

我想对我自己的函数按组应用优化：

这是一个可重现的数据集：

```
data <- data.frame(ID=c(1,1,1,2,2,3,3),C=c(1,1,1,2,2,3,4),
                   Lambda=c(0.5),s=c(1:7),   
                   sigma_S=c(0.5,0.4,0.3,0.7,0.4,0.5,0.8),
                   d=c(20,30,40,50,60,70,80), 
                   sigma_B=0.3,t=5,Rec=0.5,r=0.05) 
```

我的函数定义如下（函数很琐碎，我只是想了解方法）：

```
 TestMSE <- function(LR)
  {
    d <- data
    D <- LR + d$s
    mse(d$C, D)   # mse is from the Metrics Package
   }

optimize(TestMSE,lower = 0.1, upper =1.5) 
```

我尝试使用 ddply 函数：

```
test <-  ddply(data,"ID",summarise, optimize(TestMSE,lower = 0.1, upper =1.5)) 
```

但是应用 ddply 函数，我的所有组都收到了相同的解决方案，尽管子组有所不同。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T23:49:14.297

正如@Joran 指出的那样，问题在于您的函数`TestMSE`无法从`ddply`. 因此，您应该为输入数据提供一个参数，该参数为每个组提供数据。试试这样的东西，也许？

```
TestMSE <- function(LR, d) {
    D <- LR + d$s
    mse(d$C, D)
}

require(plyr)
require(Metrics)
test <-  ddply(data,"ID", function(x) {
    unlist(optimize(TestMSE, 0.7, x, lower = 0.1, upper =1.5))
})

#   ID   minimum objective
# 1  1 0.1000519  1.876781
# 2  2 0.1000519  7.010270
# 3  3 0.1000519  9.610322 
```

啊哈，现在我明白你的要求了。可以通过以下方式完成`merge`：

```
merge(data, test, by="ID")

#   ID C Lambda s sigma_S  d sigma_B t Rec    r   minimum objective
# 1  1 1    0.5 1     0.5 20     0.3 5 0.5 0.05 0.1000519  1.876781
# 2  1 1    0.5 2     0.4 30     0.3 5 0.5 0.05 0.1000519  1.876781
# 3  1 1    0.5 3     0.3 40     0.3 5 0.5 0.05 0.1000519  1.876781
# 4  2 2    0.5 4     0.7 50     0.3 5 0.5 0.05 0.1000519  7.010270
# 5  2 2    0.5 5     0.4 60     0.3 5 0.5 0.05 0.1000519  7.010270
# 6  3 3    0.5 6     0.5 70     0.3 5 0.5 0.05 0.1000519  9.610322
# 7  3 4    0.5 7     0.8 80     0.3 5 0.5 0.05 0.1000519  9.610322 
```

# java - 快速排序随机实数

> ID：15168531
> 
> 赞同：-2
> 
> 时间：2013-03-01T23:21:07.173
> 
> 标签：java

QuickSort Random Real Numbers 使用您自己的自定义随机发生器生成一个包含 150 个数字的随机数组。1）显示未排序的数字。2）启动秒表并显示时间。3) 使用 QuickSort 对数组进行排序。4）停止秒表并显示它运行了多长时间。5）按升序显示数字。

## *这是我的随机生成器类*

```
/**
*/
  class RandomGenerator
{
  public RandomGenerator()
{
}

public double randomLong(double shift)
{
  long x = System.nanoTime();
  x ^= (x <<(int)(shift/100)); 
  x ^= (x >>>(int)(shift%10)); 
  x ^= (x << (int)Math.sqrt(shift)); 
  if ((x>0)||(x<0))
{
  return x;
 }
  else
  return(randomLong(System.nanoTime()*Math.sqrt(System.nanoTime())));
 }
} 
```

## 这是我的快速排序课程

```
 public class QuickSort
 {
 public QuickSort()
{
 }
 public double[] sort(double[] a)
{
 sort(a, 0, a.length - 1);
 return(a);
}
 private void sort(double[] a, int from, int to)
{
 if (from >= to){return; }
 int p = partition(a, from, to);
 sort(a, from, p);
 sort(a, p + 1, to);
 }
  private int partition(double[] a, int from, int to)
 {
  double pivot = a[from];
  int i = from - 1;
  int j = to + 1;
  while(i < j)
  {
     i++; while (a[i] < pivot) {i++;}
 j--; while (a[j] > pivot) {j--;}
 if(i < j)
 {
  double temp;
  temp = a[i];
  a[i] = a[j];
  a[j] = temp;
  }
    }
   return j;
   }
 } 
```

## 这是我的秒表课

```
/**
   A stopwatch accumulates time when it is running. You can 
   repeatedly start and stop the stopwatch. You can use a
   stopwatch to measure the running time of a program.
 */
     public class StopWatch
      {  
       private long elapsedTime;
       private long startTime;
       private boolean isRunning;

    /**
      Constructs a stopwatch that is in the stopped state
      and has no time accumulated.
   */
   public StopWatch()
{  
   reset();
}

 /**
  Starts the stopwatch. Time starts accumulating now.
 */
 public void start()
{  
   if (isRunning) { return; }
   isRunning = true;
   startTime = System.currentTimeMillis();
}

/**
   Stops the stopwatch. Time stops accumulating and is
   is added to the elapsed time.
*/
public void stop()
{  
   if (!isRunning) { return; }
   isRunning = false;
   long endTime = System.currentTimeMillis();
   elapsedTime = elapsedTime + endTime - startTime;
}

 /**
   Returns the total elapsed time.
   @return the total elapsed time
 */
public long getElapsedTime()
{  
   if (isRunning) 
   {  
      long endTime = System.currentTimeMillis();
      return elapsedTime + endTime - startTime;
   }
   else
   {
      return elapsedTime;
   }
}

/**
   Stops the watch and resets the elapsed time to 0.
*/
public void reset()
{  
   elapsedTime = 0;
   isRunning = false;
 } 
```

}

## 这是我的查看器类或主要方法（我真的需要帮助）

```
 public class QsortViewer
 {
 private static final int MAX_ELEMENTS=150; 
 public static void main(String[] args)
 {
  RandomGenerator RG = new RandomGenerator();
  QuickSort QS = new QuickSort();
  StopWatch SW = new StopWatch();

 double[] numbers = new double[MAX_ELEMENTS];

 for (int i = 0; i <= numbers.length-1; i++)
{
 numbers[i] = RG.randomLong(i*i*Math.sqrt(i)*Math.pow(i,i));
  }
  }
} 
```

我所有的课程都是正确的，我需要帮助的是 1）显示未排序的数字。2）启动秒表并显示时间。3) 使用 QuickSort 对数组进行排序。4）停止秒表并显示它运行了多长时间。5）按升序显示数字。现在我的主要方法已部分完成，所以我可以在完成我的主要方法方面获得一些帮助。这意味着调用正确的类并对数组进行排序并显示它们。谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T00:04:12.590

我觉得我可能在这里遗漏了一些东西，因为您似乎已经完成了所有繁重的工作，但这是我的草稿

```
public class QsortViewer{
    private static final int MAX_ELEMENTS=150; 

     public static void main(String[] args){
        RandomGenerator RG = new RandomGenerator();
        QuickSort QS = new QuickSort();
        StopWatch SW = new StopWatch();

        double[] numbers = new double[MAX_ELEMENTS];

        System.out.println("Unordered set: ");
        for (int i = 0; i <= numbers.length-1; i++){
            numbers[i] = RG.randomLong(i*i*Math.sqrt(i)*Math.pow(i,i));
            System.out.print(numbers[i]+" ");
        }

        SW.start();
        System.out.println("Start Time: "+SW.getStartTime());

        numbers = QS,sort(numbers);

        SW.stop();
        System.out.println("Elapsed Time: "+SW.getElapsedTime());

        System.out.println("Sorted Array: ");
        for (int i = 0; i <= numbers.length-1; i++){
            System.out.print(numbers[i]+" ");
        }
    }
} 
```

我调用了一个您尚未编写的名为 SW.getStartTime() 的方法，它只会返回 SW 对象中记录的开始时间的值。如果这是硬件分配或您无法编辑 SW 的东西，那么将 SW.getStartTime() 替换为 System.currentTimeMillis() 也可以。

# cookies - 跨平台客户端存储的最佳方式？

> ID：15168535
> 
> 赞同：0
> 
> 时间：2013-03-01T23:21:21.697
> 
> 标签：cookies, local-storage, client-side, indexeddb, client-side-data

我需要一种跨平台的方式来在不使用 cookie 的情况下在客户端存储数据，因为客户端保存了一个令牌，不应在每次请求时将其发送到服务器。

要求

*   必须支持旧浏览器（IE6+）
*   也必须在移动设备上工作（在网络视图中）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T03:46:42.697

如果没有 cookie，您将无法在客户端上存储数据。您可以在 URL 中传递会话 ID。作为 PHP 的一个例子：http: [//php.net/manual/en/session.idpassing.php](http://php.net/manual/en/session.idpassing.php)但这是你能得到的最好的。

我没有看到支持 IE6 的问题。使用“渐进增强”，您可以为旧手机、IE6/7 和其他垃圾提供一个非常基本的站点。然后，将更高级的东西叠加到可以处理它的设备上。我不在 IE6 中进行测试，但我 99% 的网站都在其中工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T13:05:54.973

如果您使用[JayData ItemStore API](http://jaydata.org/blog/the-itemstore-api-101)，则在检测可用的本地存储技术时有一个回退机制。优先顺序是 WebSQL、IndexedDB、HTML5 localStorage。坏消息是您需要 HTML5 浏览器。

免责声明：我是开源 JayData 库开发团队的成员

# forms - 如何在 grails 应用程序中进行正确的验证和重定向

> ID：15168536
> 
> 赞同：0
> 
> 时间：2013-03-01T23:21:22.990
> 
> 标签：forms, validation, grails

我有一个创建和保存方法如下：

```
def create () {
  def myColorInstance = new Color()
  return (colorInstance: myColorInstance]
}

def save () {
  Date someDate = params.date("somedate", "MM/dd/yyyy")
  int someInt = params.int("someInt")
  color = colorService.add(params.colorname, someDate, someInt)
  if (color.hasErrors())
    render (view: "create", model: [colorInstance: color])
  else
    redirect (action: "list")
} 
```

在我的布局页面上，我有以下内容：

```
 <g:hasErrors>
       <div class="alert alert-error">Please try submitting again</div>
 </g:hasErrors> 
```

我得到的行为是，当用户输入某些内容并且验证失败时。当他们第二次提交（再次没有输入任何内容）时，他们看到了消息`Please try submitting again`并且 url 更改为`http://localhost:8080/myapp/color/save`so，然后我的应用程序失败并显示消息：“无法将具有类 'null' 的对象'null' 转换为类 'int'。尝试' java.lang.Integer' 代替"

处理这种情况的最佳方法是什么？我希望用户在顶部看到错误消息，他们应该能够再次更正错误并尝试再次提交，它应该可以工作..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:31:22.563

您不能将 an 设置`int`为 null，这`params.int("")`可能会返回。`Integer`但是，可以为空。

```
Integer someInt = params.int("someInt") 
```

这将解决您的异常，但它返回 null 的原因与您的视图没有首先传递数据有关。

仅供参考，这是不正确的语法：

```
def create () {
  def myColorInstance = new Color()
  return (colorInstance: myColorInstance]
} 
```

应该：

```
def create () {  
  [colorInstance: new Color()]
} 
```

# data-warehouse - 数据仓库设计——如何设计事实表？

> ID：15168540
> 
> 赞同：0
> 
> 时间：2013-03-01T23:21:37.077
> 
> 标签：data-warehouse, fact-table

我是 DW 的新手，我需要为一个电子商务网站创建一个非常简单的仓库。

**维度表**

*   日期维度表（id、年、季度、月、日）
*   时间维度表（id、小时、分钟）
*   产品维度表（id、产品名称、价格、类别id）
*   产品类别维度表（id、类别名称）

**事实表**

*   每个产品的销售额（日期 ID、产品 ID、销售计数、价格总和）

此事实表适用于“6 月份售出多少产品”等问题。

但我需要回答诸如“6 月份哪个类别的产品销量最多？”之类的问题。或“星期三一天中最成功的时间是什么时候？”。

我看到两种可能性：

1.  我可以在产品事实表中添加新列（类别 ID 或时间 ID）。但是这个id会改变表的粒度
2.  我可以为类别创建另一个事实表，其中将包含有关类别的事实。但这（在我看来）是在浪费磁盘空间，不是吗？

哪种可能性是正确的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T02:02:31.807

Your sales fact table should be by order line item

You could add a degenerate dimension just for hour of the day, or add a time dimension table at the grain of hour.

Why don't you just add category name to dim_product?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T09:40:26.563

如果您在每个项目的销售额级别创建您的 Fact_table，即几乎在事务粒度上，我认为您可以将类别 ID 添加到 Fact_table 引用一个 Dim_category。这肯定会增加关于 Fact_table 的磁盘存储，但在稍后阶段，这个 Datamart 将能够回答您的任何问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-16T03:27:46.163

是的。始终以最精细的方式创建业务流程中发生的事实（如果您的源系统允许）——在这种情况下，每个产品在特定数据和时间向客户的每次销售。如果（且仅当）需要性能时，您始终可以稍后从这些细化事实创建聚合

与返工相比，磁盘空间非常便宜。

# delphi - 下载前检查jpg url是否存在（防止异常）

> ID：15168542
> 
> 赞同：-3
> 
> 时间：2013-03-01T23:21:58.420
> 
> 标签：delphi, delphi-2010

如何在下载之前检查 JPG url 是否存在，以避免异常？

```
procedure TForm1.Button1Click(Sender: TObject);
var
  FS: TFileStream;
  Url, FileName: String;
  I, C: Integer;
begin
  for I := 1 to 1000 do
  begin
    Url := 'http://www.mysite.com/images/' + IntToSTr(I) + '/Image.jpg';
    FileName := 'C:\Images\' + IntToStr(I) + '.jpg';
    FS := TFileStream.Create(FileName, fmCreate);
    try
      try
        IdHTTP1.Get(Url);
        c := IdHTTP1.ResponseCode;
        if C = 200  then
          IdHTTP1.Get(Url, FS);
      except
      end;
      Application.ProcessMessages;
    finally
      Fs.Free;
    end;
  end;
end; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-02T00:08:11.283

要回答您的主要问题，您必须检查特定 URL 是否有效的唯一方法是检查 Web 服务器并检查服务器告诉您的内容。

使用 indy，您可以使用`AIgnoreReplies`Get 和其他方法的参数来指示 TIdHTTP 实例在 Web 服务器返回状态时不要引发异常，如下所示：

```
IdHTTP1.Get(Url, FS, [404]); 
```

如果有任何不同于 200 和 400 的状态，仍然会引发异常。根据组件的各种配置，还有其他状态码可能不会引发异常，例如状态码 401 和身份验证参数等。

也就是说，我在您的代码中发现了几个问题：

*   您拥有的 try/except 块会*杀死*任何异常，无论异常可能是什么性质的**任何异常。**它对待 a`EOutOfMemory`比 a相同`EIdSocketError`，`EIdHTTPProtocolException`甚至是一个`EMayanWorldEnd`例外！
*   您下载了两次图像...碰巧您只是忽略了第一个下载的数据并使用它来*尝试*确定资源是否存在。如果你*觉得*你必须检查资源是否存在，不要`GET`对它执行命令，执行`HEAD`一个！
*   不要使用 Application.ProcessMessages，将您的代码移动到线程！
*   学习以适当的方式处理您可能获得的不同状态代码和您可能发现的其他错误。一开始很难，但如果你想让它变得健壮，这是一条路。不同的错误可能是：
    *   HTTP 状态码，例如：
        *   请求超时（减速并重试）
        *   不支持 HTTP 版本（好吧，试试其他版本）
        *   等等。
    *   网络故障
        *   互联网是不是坏掉了
        *   WebServer 是否已关闭
        *   等等。
    *   作为一般规则，让您不知道如何处理的任何其他异常......或者如果您别无选择，请吃掉它们但记录正在发生的事情并阅读日志，这样您将提高您的知识和技能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T23:32:30.953

如果您首先下载**所有互联网，**那么您可以检查您的 Exabyte 数据集合是否存在图像。

否则，您将不得不处理文件不存在的情况。

您还必须处理各种其他错误，例如超时，或者您的网络爬虫达到下载限制并被阻止。

# c++ - 为什么 iostream 哨兵对象在标准中称为“cerberos”？

> ID：15168543
> 
> 赞同：8
> 
> 时间：2013-03-01T23:22:17.763
> 
> 标签：c++, iostream, naming, naming-conventions

我想知道 of 的含义是什么，`__cerb`我发现这似乎是官方 C++ 标准文档中命名的简称。`libstdc++``g++``cerberos`

**§ 22.3.1 / 3：**

> [ 示例：iostream`operator<<`可以实现为：
> 
> ```
> template <class charT, class traits>
> basic_ostream<charT,traits>&
> operator<< (basic_ostream<charT,traits>& s, Date d) {
>                                                             //      !!!!!!!!!!
>   typename basic_ostream<charT,traits>::sentry cerberos(s); // <--- !! HERE !!
>                                                             //      !!!!!!!!!!
>   if (cerberos) {
>     ios_base::iostate err = ios_base::iostate::goodbit;
>     tm tmbuf; d.extract(tmbuf);
>     use_facet<time_put<charT,ostreambuf_iterator<charT,traits> > >(
>       s.getloc()).put(s, s, s.fill(), err, &tmbuf, ’x’);
>     s.setstate(err);            // might throw
>   }
>   return s;
> } 
> ```
> 
> —结束示例]

为什么 iostream`sentry`对象被称为`cerberos`，`cerberos`实际上是什么意思？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-01T23:41:04.807

[Cerberus 是守卫地狱之门的三头犬¹](http://en.wikipedia.org/wiki/Cerberus)，不让那些被困在里面的人越过 Styx 河。写该部分的人喜欢希腊和/或罗马神话，并认为这将是局部变量哨兵的适用名称。

至于为什么以*os*结尾，可以想象三种情况：

1.  他们完全忘记了希腊语和拉丁语名词偏角的规则，并认为这就是它的拼写方式
2.  我完全忘记了希腊语和拉丁语名词偏角的规则，并指出了一个非问题。
3.  他们将 Cerberus 和 Kerberos 的拼写混为一谈，从而产生了 Cerberos 希腊和罗马血统的 basic_stream 哨兵。

[1\. 显然 Cerberus 上的正面数量是可变的。也许这更好地表达为*“N 头狗，其中 N 大于或等于 1”。*]

# php - 如何在php中将颜色名称转换为相应的十六进制表示？

> ID：15168547
> 
> 赞同：0
> 
> 时间：2013-03-01T23:22:45.740
> 
> 标签：php, colors

我有一个变量 ($color)，它包含颜色名称、“橙色”、“红色”等的值。我不知道如何将这些值转换为十六进制，因为我需要另一个函数的十六进制值。

例如：

兑换：

```
black 
```

至：

```
#000000 
```

* * *

我还需要检查颜色是颜色名称还是十六进制值...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:28:33.503

最简单的方法是看一下：

[http://www.w3.org/TR/css3-color/#html4](http://www.w3.org/TR/css3-color/#html4)

将字符串名称和相应的十六进制值存储在数据库或数组中，并且在转换时只需从具有给定键名的数据库或数组中提取十六进制值。

# google-app-engine - 组织 Gaelyk 项目

> ID：15168551
> 
> 赞同：0
> 
> 时间：2013-03-01T23:22:54.757
> 
> 标签：google-app-engine, groovy, gaelyk

我正在使用 Groovy 和 Gaelyk 开发一个项目。我想将我的文件组织在`/src/main/WEB-INF/groovy`.

当我将所有文件放在同一个文件夹中时它可以工作，但当我将它们放入不同的文件夹时则不行。也许改变构建配置？

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T11:52:22.267

当您将`.groovy`文件放在不同的目录中时，您需要在 中包含`package`声明`.groovy`以匹配目录结构。

# ios - 为什么我的 IOS 应用程序的显示名称不符合 InfoPlist.strings 中的 en-AU 本地化？

> ID：15168554
> 
> 赞同：0
> 
> 时间：2013-03-01T23:23:03.210
> 
> 标签：ios, localization, plist

我无法获取应用程序的显示名称来识别它应该使用`en-AU`InfoPlist 文件。它总是显示普通`en`版本。

我已经创建了文件的本地化版本，并验证了显示的值来自`en`文件。（我的文件中还有瑞典语版本`sv`，它正确显示了显示名称。）

我已删除该`CFBundleName`条目，并将`LSHasLocalizedDisplayName`值设置`YES`为 Info.Plist 文件中。

我还在应用程序中包含了一个用于显示值的 Localizable.strings 文件，它们可以从适当的 en 和 en-AU 集中正确显示。只是显示名称忽略了它的`en-AU`对应名称。有什么我错过的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:45:40.037

据我所知，您只能本地化显示名称的“语言”而不是“区域设置”（可能更多来自 InfoPlist.strings）。

# caching - IIS 7 和 ASP.NET MVC 客户端缓存之间的区别

> ID：15168558
> 
> 赞同：0
> 
> 时间：2013-03-01T23:23:33.597
> 
> 标签：caching, iis-7, asp.net-mvc-4, web-config

我想在 MVC 网站上启用缓存，有几个建议 [http://www.iis.net/configreference/system.webserver/staticcontent/clientcache](http://www.iis.net/configreference/system.webserver/staticcontent/clientcache) 关于使用 IIS 管理或 Web.config 添加条目，但我是使困惑。

1） **这两个有什么区别，我可以只选择 IIS Content Expiration 而不是 Web.config 设置：**

```
<configuration>
  <system.webServer>
    <staticContent>
      <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="7.00:00:00" />
    </staticContent>
  </system.webServer>
</configuration> 
```

![IIS 内容过期](../Images/3cdb96735d1c63ef86c4c4363ff3ac32.png)

2) **什么是输出缓存，它与内容过期有何不同？**

![输出缓存](../Images/e2bc21c7c6f17aa2e57498ea56777574.png)

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-01T00:18:17.710

内容过期时，它指示浏览器缓存内容，而输出缓存时，它将内容缓存在服务器上，以便运行生成内容的频率较低的代码，并从缓存中提供先前生成的内容，从而减少服务器上的负载

# c++ - c\c++ - 以联合作为参数以满足特定要求的函数

> ID：15168563
> 
> 赞同：1
> 
> 时间：2013-03-01T23:23:54.507
> 
> 标签：c++, c, arguments, compatibility, unions

我是一个为一台设备提供功能的工程库。该设备有一些共同的操作，但不同的算法来完成这些操作。我想要一个特定操作的函数原型，而不是一堆函数原型，而不是：

```
Alg1_Foo();
Alg2_Foo();
... 
```

我要这个：

```
Foo(alg); 
```

但是我不想将 alg 作为单独的参数传递，因为即使没有它，函数也会有很多参数，它们将具有用于识别和/或授权设备的参数，in 参数，out 参数（至少其中一个)，所以我认为将 alg 添加为单独的参数会很烦人。

所以我的想法是提供这样的解决方案：

```
Foo(const SomeUnion& some_union); 
```

在哪里：

```
union SomeUnion {
  AlgId alg_id;
  alg1::SomeStruct alg1_some_struct;
  alg2::SomeStruct alg2_some_struct;

  SomeUnion(alg1::SomeStruct some_struct) { alg1_some_struct = some_struct; };
  SomeUnion(alg2::SomeStruct some_struct) { alg2_some_struct = some_struct; };
}; 
```

特定算法的结构将是这样的：

```
namespace alg1 {
  struct SomeStruct {
    static const AlgId alg_id = ALG1;
    . . .
  };
} 
```

因此，如果要执行 alg1，我们将适当的结构传递给 Foo，它可以在 C++ 中运行，比如说

```
alg1::SomeStruct a;
Foo(a); 
```

但我希望我的库保持纯 C 的可能性。当然我需要：

1.  删除引用并用指针替换它们；

2.  删除命名空间（我们仍然可以在结构的帮助下模拟它们（这个线程可能对感兴趣的人有帮助：[C 中的命名空间](https://stackoverflow.com/questions/389827/namespaces-in-c)）；

3.  将定义结构的 C++ 样式替换为 C 中的结构，并在标记命名空间中定义名称（typedef struct tagStruct {...} Struct;）；

4.  从内部结构和联合中删除函数。

但是，虽然我不明白是否有可能通过维护 C 来完成我想做的事情......你看到了吗？或者将 alg_id 作为单独的参数传递而不打扰联合和结构是否更简单（但如果可能的话，我想避免它）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T23:43:49.863

对我来说，这似乎是一个典型的案例，有人试图以“错误的方式”解决问题。

如果你对一个函数有“很多参数”，那么使用 a`struct`就可以了。但是将“您实际调用的函数”隐藏在这样的 a`struct`中，然后在 a 中有几个变体`struct`，`union`现在我们正试图将太多东西塞进一个函数中。开始拆分函数，使其只需要一个`struct`- 删除你的`union`作为参数 - 这是错误的。[我使用过与此类似的代码 - 潜入一些做错事并导致一些难以发现的错误的代码的机会，因为你传递了错误的类型`union`函数中的参数使这确实是一个糟糕的解决方案]。如果您将错误类型的结构传递给普通函数，那么编译器会告诉您。如果您填写联合的错误部分，则使用结构“正确”部分的代码将获得“奇怪”数据[很可能是未定义的行为] - 这种类型的错误很难找到。

所以，是的，拆分你的职能，移除工会！

**编辑：** 如果您希望拥有一个简单且一致的接口，那么想到的一个建议是您有一个工厂函数，您可以将其传递`alg_id`给该函数，该函数返回一个指向相关函数的函数指针。不幸的是，如果每个函数的接口是我建议的不同结构，那么您仍然有可能将数据结构和函数混淆，但它确实减少了“已​​发布函数”的数量 - 事实上，这些功能不需要在提供它们的模块[库甚至目标文件]之外完全可见。

# c# - 如何在 C# 控制台中显示扩展的 Unicode 字符？

> ID：15168565
> 
> 赞同：1
> 
> 时间：2013-03-01T23:24:15.447
> 
> 标签：c#, unicode, astral-plane

我正在尝试显示一组扑克牌，它们的 Unicode 值在 1F0A0 到 1F0DF 范围内。每当我尝试在其代码中使用超过 4 个字符的字符时，都会出现错误。是否可以在这种情况下使用这些字符？我正在使用 Visual Studio 2012。

字符 AceOfSpades = '\u1F0A0'; 输入后立即给我错误“字符文字中的字符太多”这仍然显示为 Unicode 或 UTF8 编码。如果我尝试像上面那样显示 '\u1F0A'... 使用 Unicode 它会显示 '?' 使用 UTF8，它显示 3 个字符。

我尝试了 OutputEncoding `string AceOfSpades = "\U0001F0A0";` Default, Unicode, ASCII 的所有给定选项： `??` UTF7: `+2DzcoA-` UTF8: 四个奇怪的字符 UTF32 , BigEndianUnicode: IOException `Console.OutputEncoding = System.Text.Encoding.UTF32;`尽管是一个选项，但即使它是唯一的代码行也会崩溃。UTF16 不在列表中。

如何检查我使用的 Unicode 版本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T02:51:24.833

为了使用基本多语言平面之外的字符，您需要使用`\U`，而不是对它们进行转义`\u`。这需要八个十六进制数字（老实说，这没什么意义，因为所有 Unicode 字符都可以用六个十六进制数字编写）。

但是，`char`.NET 中的类型只能表示 UTF-16 代码单元，这意味着 BMP 之外的字符需要一对`char`s（代理对）。所以你必须把它变成一个字符串。

```
string AceOfSpades = "\U0001F0A0"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:31:16.383

我将假设（直到您为清楚起见编辑您的帖子）您的符号显示不正确。如果不是这种情况，我将删除此答案。

将控制台的编码设置为 Unicode 或 UTF-8。

`Console.OutputEncoding = System.Text.Encoding.Unicode`

或者

`Console.OutputEncoding = System.Text.Encoding.UTF8`.

确保字体可以显示 Unicode/UTF-8 字符（如 Lucida Console）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-13T13:21:24.643

我在 Windows 应用程序（不是控制台）中显示 10 个来自扩展 Unicode 的埃及象形文字，如下所示：

```
string single_character = "\U00013000";//first ancient hieroglyph

//get the Unicode index
Encoding enc = new UTF32Encoding(false, true, true);
byte[] b = enc.GetBytes(single_character);
Int32 code = BitConverter.ToInt32(b, 0);

for (int i = 0; i < 10; i++)
{
   //convert from int Unicode index to display character
   string glyph = Char.ConvertFromUtf32(code); //single one

   textBox1.Text += glyph;

   code++;
 } 
```

您还需要支持这些的字体。

# php - OAuth CakePHP 插件的 open_basedir 限制错误

> ID：15168567
> 
> 赞同：0
> 
> 时间：2013-03-01T23:24:27.717
> 
> 标签：php, cakephp

我正在尝试在这里实现 OAuth CakePHP 插件：[https ://github.com/seddonmedia/cakephp-oauth-server](https://github.com/seddonmedia/cakephp-oauth-server)

一切似乎都按预期工作，直到用户接受应用程序通过 API 授权并发生以下错误：

```
Warning (2): file_exists() [function.file-exists]: open_basedir restriction in effect. File(/dev/urandom) is not within the allowed path(s): (/nfs:/tmp:/usr/local:/etc/apache2/gs-bin) [APP/Plugin/OAuth/Vendor/oauth2-php/lib/OAuth2.php, line 1064]
Warning (2): Cannot modify header information - headers already sent by (output started at /html/thirdparty/lib/Cake/Utility/Debugger.php:805) [APP/Plugin/OAuth/Vendor/oauth2-php/lib/OAuth2.php, line 945]
Warning (2): Cannot modify header information - headers already sent by (output started at /html/thirdparty/lib/Cake/Utility/Debugger.php:805) [APP/Plugin/OAuth/Vendor/oauth2-php/lib/OAuth2.php, line 946] 
```

在错误之前调用的方法如下。

当用户单击接受时，它会在帖子上发生。

公共功能授权（）{

```
if (!$this->Auth->loggedIn()) {
    $this->redirect(array('action' => 'login', '?' => $this->request->query));
}

if ($this->request->is('post')) {
    $this->validateRequest();

    $userId = $this->Auth->user('id');

    if ($this->Session->check('OAuth.logout')) {
        $this->Auth->logout();
        $this->Session->delete('OAuth.logout');
    }

    //Did they accept the form? Adjust accordingly
    $accepted = $this->request->data['accept'] == 'Yep';
    try {
        $this->OAuth->finishClientAuthorization($accepted, $userId, $this->request->data['Authorize']);
    } catch (OAuth2RedirectException $e) {
        $e->sendHttpResponse();
    }
}

// Clickjacking prevention (supported by IE8+, FF3.6.9+, Opera10.5+, Safari4+, Chrome 4.1.249.1042+)
$this->response->header('X-Frame-Options: DENY');

if ($this->Session->check('OAuth.params')) {
        $OAuthParams = $this->Session->read('OAuth.params');
        $this->Session->delete('OAuth.params');
} else {
    try {
        $OAuthParams =  $this->OAuth->getAuthorizeParams();
    } catch (Exception $e){
        $e->sendHttpResponse();
    }
}
$this->set(compact('OAuthParams')); 
```

}

不知道问题是什么......有人可以就问题所在或我如何进一步调查提供任何建议吗？

编辑：尝试根据评论编辑以下代码：

```
protected function genAccessToken() {
    $tokenLen = 40;
    //if (file_exists('/dev/urandom')) { // Get 100 bytes of random data
    if(mt_rand(0,99999999)) {
        $randomData = file_get_contents('/dev/urandom', false, null, 0, 100) . uniqid(mt_rand(), true);
    } else {
        $randomData = mt_rand() . mt_rand() . mt_rand() . mt_rand() . microtime(true) . uniqid(mt_rand(), true);
    }
    return substr(hash('sha512', $randomData), 0, $tokenLen);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:39:31.733

将函数替换为。这样你就不需要访问 /dev/urandom

```
protected function genAccessToken() {
    $tokenLen = 40;
    //if (file_exists('/dev/urandom')) { // Get 100 bytes of random data

        $randomData = mt_rand() . mt_rand() . mt_rand() . mt_rand() . microtime(true) . uniqid(mt_rand(), true);

    return substr(hash('sha512', $randomData), 0, $tokenLen);
} 
```

# wsdl - Web服务贡献ID消歧

> ID：15168569
> 
> 赞同：1
> 
> 时间：2013-03-01T23:24:48.357
> 
> 标签：wsdl, xsd

我使用一个 Web 服务 API，它可以通过一个通用类型的`Result`s 来提供某些基本信息，尤其是一个唯一的 ID。该唯一 ID 往往是——但不是必须——`UUID`由发送者定义，发送者并不总是同一个人（但 ID 在整个系统中是唯一的）。

从根本上说，API 的结果与此类似（用 Java 编写，但语言应该无关紧要），其中只有基本接口代表常见细节：

```
interface Result
{
    String getId();
}

class Result1 implements Result
{
    public String getId() { return uniqueValueForInstance; }
    public OtherType1 getField1() { /* ... */ }
    public OtherType2 getField2() { /* ... */ }
}

class Result2 implements Result
{
    public String getId() { return uniqueValueForInstance; }
    public OtherType3 getField3() { /* ... */ }
} 
```

需要注意的是，每种`Result`类型可能代表一种完全不同的信息。其中一些不能与其他`Result`s 相关，而其中一些可以，无论它们是否具有相同的类型（例如，`Result1`可能能够与 相关`Result2`，因此反之亦然，但有些`ResultX`可能存在无法相关，因为它表示不同的信息）。

我们目前正在实现一个系统，该系统接收其中一些`Result`s 并在可能的情况下将它们关联起来，从而生成一个不同的`Result`对象，该对象是它关联在一起的内容的容器：

```
class ContainerResult implements Result
{
    public String getId() { return uniqueValueForInstance; }
    public Collection<Result> getResults() { return containedResultsList; }
    public OtherType4 getField4() { /* ... */ }
}

class IdContainerResult implements Result
{
    public String getId() { return uniqueValueForInstance; }
    public Collection<String> getIds() { return containedIdsList; }
    public OtherType4 getField4() { /* ... */ }
} 
```

这是两个容器，它们呈现不同的用例。第一个，`ContainerResult`允许某人接收相关的详细信息以及实际完整的相关数据。第二个，`IdContainerResult`通过仅发送关联的 ID 来牺牲完整列表以支持带宽。进行关联的系统不一定与客户端相同，并且客户端可以接收`Result`这些 ID 将代表的 s，这旨在允许他们通过简单地接收 ID 在其系统上显示相关性。

现在，我的问题对某些人来说可能并不明显，而对其他人来说可能很明显：如果我只发送 ID 作为 的一部分`IdContainerResult`，那么如果客户`Result`没有单个 ID 存储？每个实现实际表示的数据类型`Result`在它们无法关联时会被隔离，这意味着在大多数情况下，如果不增加内存或存储负担，单个 ID 存储是不可能的。

我们提出的当前解决方案需要创建一种新类型的 ID，我们将其命名为`TypedId`，它将 XML 命名空间和 XML 名称与每个`Result`的`Result`ID 结合起来。

我对该解决方案的主要问题是，它需要维护一个可变的类型集合，这些类型在发现时会更新，或者需要所有类型的先验知识，以便 ID 可以在任何客户端的系统上正确关联。不幸的是，我想不出更好的解决方案，但目前的解决方案感觉不对。

有没有人遇到过类似的情况，他们希望将 generic`Result`与其原始类型相关联，特别是考虑到 WSDL 的限制，并以更简洁的方式解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T00:59:53.147

这是我的建议：

1.  您希望“客户知道如何最终匹配结果”。因此，在您的响应中包含一个名为“RequestType”的额外鉴别器字段，一个字符串。

2.  您希望避免“维护一个可变的类型集合，这些类型在发现时会更新，或者所有类型的先验知识，以便 ID 可以在任何客户端的系统上正确关联”。显然，每个客户端请求调用都知道 Result 将涉及到哪个处理区域。因此，您可以让客户端将“RequestType”字符串作为请求的一部分传递。只要 RequestType 是每个不同类型的客户端请求的唯一字符串，您的服务就可以处理和关联它，而无需硬编码任何知识。

3.  这是请求和响应消息的 java 类的一个可能示例（即不是实际的服务端点）：

    ```
    interface Request {
        String getId();
        String getRequestType();
        // anything else ...
    }

    interface Result {
        String getId();
        String getRequestType();
    }

    class Result1 implements Result {
        public String getId() { return uniqueValueForInstance; }
        public OtherType1 getField1() { /* ... */ }
        public OtherType2 getField2() { /* ... */ }
    }

    class Result2 implements Result {
        public String getId() { return uniqueValueForInstance; }
        public OtherType3 getField3() { /* ... */ }
    } 
    ```

4.  这是问题所在。上面的 (2) 和 (3) 没有给出完全动态的解决方案。您希望您的服务能够返回与每个不同请求相关的灵活记录结构。您有以下选择：

    4A) 在 XSD 中，将 Result 声明为单个强类型变体记录类型，并在 WSDL 中从单个服务端点和单个操作返回 Result。XSD 在声明变体记录结构时仍需要对鉴别器元素的值进行硬编码。

    4B) 在 XSD 中，为每个可能的客户端请求声明多个强类型唯一类型 Result1、Result2 等。在 WSDL 中，有多个唯一命名的操作来返回其中的每一个。这些操作可以跨一个或多个服务端点——甚至跨多个 WSDL。虽然这避免了将请求类型硬编码为特定字段*本身*，但它实际上并不是一个通用的独立于客户端的解决方案，因为您仍然通过为每个结果类型和每个操作创建唯一名称来显式硬编码以区分每个请求类型. 因此，任何明显的活力都是海市蜃楼。

    4C) 在 XSD 中，定义一个灵活的通用数据结构，该结构不是变体，但具有大量通用命名字段，能够处理所需的所有可能结果。示例字段可以是“stringField1”、“stringField2”、“integerField1”、“dateField1058”等。即使用极弱的类型并将负担放在客户端神奇地知道每个字段中的数据是什么。此选项可能非常通用，但通常被认为是糟糕的做法。它不优雅，非常难以阅读，容易出错，并且无论如何都内置了限制/假设 - 你怎么知道你有足够的通用字段包含在内？在您的情况下，（4A）可能是最好的选择。

    4D) 使用灵活的 XSD 模式设计策略 - 类型可替换性和使用“任何”元素。请参阅[http://www.xfront.com/ExtensibleContentModels.html](http://www.xfront.com/ExtensibleContentModels.html)。

    4E）针对您自己的工厂类方法使用@Produces @SomeQualifier 注释，该方法创建高级类型。这告诉 CDI 始终使用此方法来构造特定的 bean 类型和限定符。您的工厂方法可以有奇特的逻辑来决定在每次调用时构造哪个特定的低级类型。@SomeQualifier 可以有额外的参数来指导选择类型。这可能会将限定符的数量减少到只有一个。

    如果您使用 (4D)，您将拥有一个灵活的服务端点设计，可以非常有效地处理不断变化的需求。但是您的服务实现仍然需要实现灵活的行为来决定为每个请求返回哪些结果字段。事实是，如果您对不同的数据结构有逻辑要求，您的代码必须知道如何为每个单独的请求处理这些数据结构，因此必须依靠某种形式的 RequestType / 唯一操作名称来区分。完全动态处理的任何目标（不适应每个客户对结果数据的需求）都是过于雄心勃勃的。

# visual-studio-2010 - Visual Studio Express 2012 for Web 中 F# 的 IntelliSense 建议

> ID：15168572
> 
> 赞同：3
> 
> 时间：2013-03-01T23:25:00.267
> 
> 标签：visual-studio-2010, visual-studio, visual-studio-2012, f#, intellisense

在 Visual C# 2010 Express 中，如果我键入`using S`建议会自动弹出：

![在此处输入图像描述](../Images/ac76d8a496272b7e80745e47607950c1.png)

在使用 F# 的 Visual Studio Express 2012 for Web 中，如果我键入“open S”，则没有任何反应。我必须键入`ctrl-j`才能触发建议：

![在此处输入图像描述](../Images/56e4b7c6fa1c787a58b3c75c72eb507a.png)

有什么办法可以得到2012年的前行为？即不必输入`ctrj-j`建议，但它们会自动出现吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T23:27:18.933

C# 和 F# Intellisense 实现由不同的团队编写，具有不同的目标。通常，F# 体验比 C# 体验要少。对于诸如`open`它们不会自动弹出体验的项目，您必须手动调用它。没有办法改变这种行为。

# websocket - Sinatra 蒸汽助手不起作用

> ID：15168576
> 
> 赞同：0
> 
> 时间：2013-03-01T23:25:14.690
> 
> 标签：websocket, sinatra

```
require 'sinatra/base'

class Counter < Sinatra::Base
    set :server, 'thin' # 'webrick' doesn't work either
    get '/' do
        haml :index
    end

    get '/stream' do |out|
        out << 'first sentence'
            sleep 0.5
            out << 'second sentence'
            sleep 0.5

    end
    run!
end 
```

我按照 README 文件中的指南进行操作，这表明瘦服务器可以工作。但它给了我一个空页面，而 webrick 则完全用两个句子提供页面而没有流效果。

有人可以让我知道我在哪里做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T06:07:27.210

摘自[Sinatra：博客](http://www.sinatrarb.com/blog)

```
get '/stream' do
  stream do |out|
    out << "It's gonna be legen -\n"
    sleep 0.5
    out << " (wait for it) \n"
    sleep 1
    out << "- dary!\n"
  end
end 
```

通知行：2`stream do |out|`

# html - CSS 形状前面的文本

> ID：15168577
> 
> 赞同：1
> 
> 时间：2013-03-01T23:25:19.550
> 
> 标签：html, css

我试图让文本位于 CSS 形状的顶部（或前面）。它适用于`border-bottom`，但不适用于`border-top`（这是我需要它的样子）。我假设因为`border-top`设置了属性，所以它将文本推到形状下方。

不太确定如何在不使用图像的情况下使其正常工作。我可以发誓我以前看过这个，但我不记得在哪里。

这是我的小提琴：http: [//jsfiddle.net/ultraloveninja/W2SPd/](http://jsfiddle.net/ultraloveninja/W2SPd/)

```
<h1>the trap</h1> 
```

```
h1 {
    border-top: 100px solid red;
    border-left: 50px solid transparent;
    border-right: 50px solid transparent;
    height: 0;
    width: 100px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:40:18.277

只需创建一个新的伪元素`:after`，然后使用边框样式设置伪元素的样式：)

优点？您不必仅仅为样式创建新元素，或者使用没有语义意义的不必要的嵌套/包装；它不是基于图像的解决方案。缺点 - 需要浏览器支持伪元素，因此可能无法在旧版本的 IE 上运行......但这不是你应该担心的事情。

```
h1 {
    width: 100px;
    padding: 0 50px; /* To account for the left and right borders in pseudo element to ensure it lines up */
}
h1:after {
    content: " ";
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    border-top: 100px solid red;
    border-left: 50px solid transparent;
    border-right: 50px solid transparent;
    z-index: -1; /* Displays pseudo element behind text */
    width: 100px;
} 
```

在这里看小提琴 - [http://jsfiddle.net/teddyrised/W2SPd/11/](http://jsfiddle.net/teddyrised/W2SPd/11/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T23:31:14.697

您需要 2 个元素和 2 个 CSS 样式。一个用于文本，一个用于背景：

```
<h1><div>the trap</div></h1> 
```

CSS

```
h1 {
    border-top: 100px solid red;
    border-left: 50px solid transparent;
    border-right: 50px solid transparent;
    height: 0;
    width: 100px;
}
h1 div {
    position: relative;
    top: -100px;
} 
```

[http://jsfiddle.net/vPt7h/](http://jsfiddle.net/vPt7h/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-01T23:32:37.757

您可以为文本插入`span`标签并获取：

```
h1 {
    border-top: 100px solid red;
    border-left: 50px solid transparent;
    border-right: 50px solid transparent;
    height: 0;
    width: 100px;
    position:relative;
}
h1 span {
   position: absolute;
    top: -100px;
} 
```

演示[http://jsfiddle.net/W2SPd/10/](http://jsfiddle.net/W2SPd/10/)

可行的？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T23:34:57.297

这真的是一个糟糕的方式来做它。它仍然会占用比需要更多的空间，并且您正在寻找潜在的问题。是的，您可以使用其他人提供的示例，但如果是我，我会将形状制作为图像并通过 CSS 将其用作背景。

```
.myShape { background:url(/pathto/your/image.png); width:150px; height:100px; } 
```

# java - 404 - 请求资源不可用 - Spring MVC

> ID：15168581
> 
> 赞同：4
> 
> 时间：2013-03-01T23:25:41.587
> 
> 标签：java, spring, model-view-controller, spring-mvc, web

我正在尝试在我的网站中使用 Spring 框架，但在尝试设置它时遇到了麻烦。我知道很多人都提出了与我的问题类似的问题，但我无法通过我所看到的所有提示来解决我的问题。

请参阅下面的代码，它尝试使用 Spring 框架打开 .jsp 文件。

web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    id="WebApp_ID" version="2.5">

    <servlet>
  <servlet-name>springmvc</servlet-name>
  <servlet-class>
    org.springframework.web.servlet.DispatcherServlet
  </servlet-class>
  <init-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>
      /WEB-INF/spring-context.xml
    </param-value>
  </init-param>
  <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
  <servlet-name>springmvc</servlet-name>
  <url-pattern>/</url-pattern>
</servlet-mapping>

</web-app> 
```

弹簧上下文.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="http://www.springframework.org/schema/mvc 
    http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
    http://www.springframework.org/schema/beans 
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/context 
    http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <context:component-scan base-package="br.com.caelum.tarefas" />
    <mvc:annotation-driven />

    <bean
        class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="prefix" value="/WEB-INF/views/" />
        <property name="suffix" value=".jsp" />
    </bean>

</beans> 
```

OlaMundoController.java

```
package br.com.caelum.tarefas.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
public class OlaMundoController {

    @RequestMapping("/olaMundoSpring")
    public String execute() {
        System.out.println("Executando a lógica com Spring MVC");
        return "ok";
    }
} 
```

好的.jsp

```
<html>
  <body>
    <h2>Olá mundo com Spring MVC!</h2>
  </body>
</html> 
```

我的项目

![在此处输入图像描述](../Images/925dd4a3bcb6486d56d5264d3626d304.png)

我正在使用 localhost:8080/WebProjetoFinal/olaMundoSpring 进行访问。

我在这里能错过什么？

编辑：

这是我初始化我的 TomCat 服务器或尝试访问页面时的完整堆栈跟踪。（两种情况的例外情况相同）

```
SEVERE: Context initialization failed
org.springframework.beans.factory.BeanDefinitionStoreException: Failed to read candidate component class: file [C:\Users\Felipe\Desktop\apache-tomcat-7.0.37\wtpwebapps\WebProjetoFinal\WEB-INF\classes\br\com\caelum\tarefas\controller\OlaMundoController.class]; nested exception is java.lang.IncompatibleClassChangeError: class org.springframework.core.type.classreading.ClassMetadataReadingVisitor has interface org.springframework.asm.ClassVisitor as super class
    at org.springframework.context.annotation.ClassPathScanningCandidateComponentProvider.findCandidateComponents(ClassPathScanningCandidateComponentProvider.java:281)
    at org.springframework.context.annotation.ClassPathBeanDefinitionScanner.doScan(ClassPathBeanDefinitionScanner.java:242)
    at org.springframework.context.annotation.ComponentScanBeanDefinitionParser.parse(ComponentScanBeanDefinitionParser.java:84)
    at org.springframework.beans.factory.xml.NamespaceHandlerSupport.parse(NamespaceHandlerSupport.java:73)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1438)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1428)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:184)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.doRegisterBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:140)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:111)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.registerBeanDefinitions(XmlBeanDefinitionReader.java:493)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:390)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:334)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:174)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:209)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:180)
    at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:125)
    at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:94)
    at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:130)
    at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:537)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:451)
    at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:652)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:600)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:666)
    at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:519)
    at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:460)
    at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:136)
    at javax.servlet.GenericServlet.init(GenericServlet.java:160)
    at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1280)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1193)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1088)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5033)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5317)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: java.lang.IncompatibleClassChangeError: class org.springframework.core.type.classreading.ClassMetadataReadingVisitor has interface org.springframework.asm.ClassVisitor as super class
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(Unknown Source)
    at java.security.SecureClassLoader.defineClass(Unknown Source)
    at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2888)
    at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1172)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1558)
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(Unknown Source)
    at java.security.SecureClassLoader.defineClass(Unknown Source)
    at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2888)
    at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1172)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1558)
    at org.springframework.core.type.classreading.SimpleMetadataReader.<init>(SimpleMetadataReader.java:58)
    at org.springframework.core.type.classreading.SimpleMetadataReaderFactory.getMetadataReader(SimpleMetadataReaderFactory.java:80)
    at org.springframework.core.type.classreading.CachingMetadataReaderFactory.getMetadataReader(CachingMetadataReaderFactory.java:102)
    at org.springframework.context.annotation.ClassPathScanningCandidateComponentProvider.findCandidateComponents(ClassPathScanningCandidateComponentProvider.java:257)
    ... 40 more

Mar 01, 2013 10:20:50 PM org.apache.catalina.core.ApplicationContext log
SEVERE: StandardWrapper.Throwable
org.springframework.beans.factory.BeanDefinitionStoreException: Failed to read candidate component class: file [C:\Users\Felipe\Desktop\apache-tomcat-7.0.37\wtpwebapps\WebProjetoFinal\WEB-INF\classes\br\com\caelum\tarefas\controller\OlaMundoController.class]; nested exception is java.lang.IncompatibleClassChangeError: class org.springframework.core.type.classreading.ClassMetadataReadingVisitor has interface org.springframework.asm.ClassVisitor as super class
    at org.springframework.context.annotation.ClassPathScanningCandidateComponentProvider.findCandidateComponents(ClassPathScanningCandidateComponentProvider.java:281)
    at org.springframework.context.annotation.ClassPathBeanDefinitionScanner.doScan(ClassPathBeanDefinitionScanner.java:242)
    at org.springframework.context.annotation.ComponentScanBeanDefinitionParser.parse(ComponentScanBeanDefinitionParser.java:84)
    at org.springframework.beans.factory.xml.NamespaceHandlerSupport.parse(NamespaceHandlerSupport.java:73)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1438)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1428)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:184)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.doRegisterBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:140)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:111)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.registerBeanDefinitions(XmlBeanDefinitionReader.java:493)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:390)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:334)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:174)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:209)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:180)
    at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:125)
    at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:94)
    at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:130)
    at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:537)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:451)
    at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:652)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:600)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:666)
    at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:519)
    at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:460)
    at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:136)
    at javax.servlet.GenericServlet.init(GenericServlet.java:160)
    at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1280)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1193)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1088)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5033)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5317)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: java.lang.IncompatibleClassChangeError: class org.springframework.core.type.classreading.ClassMetadataReadingVisitor has interface org.springframework.asm.ClassVisitor as super class
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(Unknown Source)
    at java.security.SecureClassLoader.defineClass(Unknown Source)
    at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2888)
    at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1172)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1558)
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(Unknown Source)
    at java.security.SecureClassLoader.defineClass(Unknown Source)
    at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2888)
    at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1172)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1558)
    at org.springframework.core.type.classreading.SimpleMetadataReader.<init>(SimpleMetadataReader.java:58)
    at org.springframework.core.type.classreading.SimpleMetadataReaderFactory.getMetadataReader(SimpleMetadataReaderFactory.java:80)
    at org.springframework.core.type.classreading.CachingMetadataReaderFactory.getMetadataReader(CachingMetadataReaderFactory.java:102)
    at org.springframework.context.annotation.ClassPathScanningCandidateComponentProvider.findCandidateComponents(ClassPathScanningCandidateComponentProvider.java:257)
    ... 40 more

Mar 01, 2013 10:20:50 PM org.apache.catalina.core.StandardContext loadOnStartup
SEVERE: Servlet /WebProjetoFinal threw load() exception
java.lang.IncompatibleClassChangeError: class org.springframework.core.type.classreading.ClassMetadataReadingVisitor has interface org.springframework.asm.ClassVisitor as super class
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(Unknown Source)
    at java.security.SecureClassLoader.defineClass(Unknown Source)
    at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2888)
    at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1172)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1558)
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(Unknown Source)
    at java.security.SecureClassLoader.defineClass(Unknown Source)
    at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2888)
    at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1172)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1558)
    at org.springframework.core.type.classreading.SimpleMetadataReader.<init>(SimpleMetadataReader.java:58)
    at org.springframework.core.type.classreading.SimpleMetadataReaderFactory.getMetadataReader(SimpleMetadataReaderFactory.java:80)
    at org.springframework.core.type.classreading.CachingMetadataReaderFactory.getMetadataReader(CachingMetadataReaderFactory.java:102)
    at org.springframework.context.annotation.ClassPathScanningCandidateComponentProvider.findCandidateComponents(ClassPathScanningCandidateComponentProvider.java:257)
    at org.springframework.context.annotation.ClassPathBeanDefinitionScanner.doScan(ClassPathBeanDefinitionScanner.java:242)
    at org.springframework.context.annotation.ComponentScanBeanDefinitionParser.parse(ComponentScanBeanDefinitionParser.java:84)
    at org.springframework.beans.factory.xml.NamespaceHandlerSupport.parse(NamespaceHandlerSupport.java:73)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1438)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1428)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:184)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.doRegisterBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:140)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:111)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.registerBeanDefinitions(XmlBeanDefinitionReader.java:493)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:390)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:334)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:174)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:209)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:180)
    at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:125)
    at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:94)
    at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:130)
    at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:537)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:451)
    at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:652)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:600)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:666)
    at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:519)
    at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:460)
    at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:136)
    at javax.servlet.GenericServlet.init(GenericServlet.java:160)
    at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1280)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1193)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1088)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5033)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5317)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T00:20:14.050

我认为您的 servlet 映射实际上应该是这样的：

```
<servlet-mapping>
    <servlet-name>springmvc</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T00:22:57.620

我相信您缺少文件 springmvc-servlet.xml

此文件源自您的调度程序 servle 的名称加上“-servlet.xml”

另外，尝试将您的组件扫描和 bean 定义移动到 springmvc-servlet.xml 文件中。

1.  复制并粘贴 spring-context.xml 并将其重命名为 springmvc-servlet.xml
2.  将组件扫描移动到 springmvc-servlet.xml
3.  将 bean 定义移动到 springmvc-servlet.xml
4.  将您的 serlvet 映射映射到“*.mvc”
5.  让您的网页调用 /olaMundoSpring.mvc，这将调用调度程序 servlet

继续前进...（可选）还可以考虑使用 maven。它将使您不必在互联网上寻找 jar 文件。它将自动管理您的依赖项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-12T00:15:33.723

您的 spring-asm jar 似乎是错误的版本。试试`spring-asm-3.1.1.RELEASE.jar`。

我唯一能看到的另一件事是在 web.xml 中，将 init-param 更改为

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>
        /WEB-INF/spring-context.xml
    </param-value>
</context-param> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T04:43:35.033

试试这些

1.  删除 spring-asm-3.0.3.RELEASE.jar 看看它是否有效。

2.  如果上述建议不起作用，请从[这里](http://search.maven.org/#search%7Cga%7C1%7Ca%3a%22spring-asm%22)下载 spring-asm-3.1.4 jar 而不是 spring-asm-3.0.3.RELEASE.jar并将其添加到您的 lib

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-26T16:51:22.530

我使用的是 Spring 3.1，迁移到 Spring 3.2 时出现以下错误：

```
nested exception is java.lang.IncompatibleClassChangeError: class
org.springframework.core.type.classreading.ClassMetadataReadingVisitor has interface 
org.springframework.asm.ClassVisitor as super class 
```

**解决方案：**从 cxf 依赖项中排除 asm

```
<dependency>
    <groupId>org.apache.cxf</groupId>
    <artifactId>cxf-bundle-jaxrs</artifactId>
    <version>${cxf.version}</version>
    <exclusions>                
        <exclusion>
            <artifactId>spring-asm</artifactId>
            <groupId>org.springframework</groupId>
        </exclusion>
    </exclusions>
</dependency> 
```

同样，排除造成问题的 asm 或其他 jar

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-10T09:55:18.167

删除 spring-asm-3.0.3.RELEASE.jar 看看它是否有效。

这解决了我的问题。谢谢

# java - 符号已定义。使用 JAXB 属性解决冲突

> ID：15168583
> 
> 赞同：6
> 
> 时间：2013-03-01T23:25:56.023
> 
> 标签：java, xml, xpath, jaxb, xml-serialization

我有一个 xsd 文件（yahoo.xsd），我在其中导入另一个 xsd 文件，如下所示：

```
 <xs:import schemaLocation="stock.xsd"/>
  <xs:attribute name="lang" type="xs:NCName"/> 
```

stock.xsd 看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified" xmlns:yahoo="http://www.yahooapis.com/v1/base.rng">
<xs:import namespace="http://www.yahooapis.com/v1/base.rng" schemaLocation="yahoo.xsd"/>
<xs:element name="quote">
<xs:complexType>
  <xs:sequence>  
    <xs:element ref="Symbol"/>
  </xs:sequence>
  <xs:attribute name="symbol" use="required" type="xs:NCName"/>
</xs:complexType>
</xs:element>
<xs:element name="Symbol" type="xs:NCName"/>
</xs:schema> 
```

当我使用 xjc 进行编译时，我收到以下错误消息：

> [错误] 属性“符号”已定义。使用 <jaxb:property> 解决此冲突。

[我基本上在 SO（ JAXB 编译问题 - [错误] 属性“任何”已定义](https://stackoverflow.com/questions/13610217/jaxb-compiling-issue-error-property-any-is-already-defined)）上找到了解决方案，但我无法让它工作。我猜我的 XPath 是错误的。

这是我正在使用的绑定文件：

```
<bindings xmlns="http://java.sun.com/xml/ns/jaxb"
      xmlns:xsi="http://www.w3.org/2000/10/XMLSchema-instance"
      xmlns:xs="http://www.w3.org/2001/XMLSchema"
      version="2.1">
<bindings schemaLocation="yahoo.xsd" version="1.0" >
    <!-- rename the value element -->
        <bindings node="//xs:element[@name='quote']/xs:complexType/xs:sequence/xs:element[@ref='Symbol']">
            <property name="SymbolAttribute"/>
    </bindings>
</bindings> 
```

如果我现在使用 xjc -b 进行编译，则表示 XPath 评估结果为空目标节点。

我可能必须重命名 Symbol 定义，然后还要重命名 ref？如何自动执行此操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T09:32:41.213

让我问一下这条线：

```
<xs:element ref="Symbol"/> 
```

Symbol 是在 yahoo.xsd 中定义还是在同一个 xsd 文件中本地定义？

我会尝试推断一些事实。

我假设您有两个 XSD：`yahoo.xsd`和`some.xsd`（您的帖子中的第一个）。我有很强的信心“符号”类型是在`some.xsd`而不是在`yahoo.xsd`. 如果不是这样，我会期望一些命名空间前缀（“yahoo:Symbol”？）。

现在，您的 some.xsd 是否与此类似：

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified" xmlns:yahoo="http://www.yahooapis.com/v1/base.rng" >
    <!-- It's not important right now: -->
    <!--<xs:import namespace="http://www.yahooapis.com/v1/base.rng" schemaLocation="yahoo.xsd"/>-->

    <!-- declaration you omitted in your post, it's only example -->
    <xs:element name="Symbol">
        <xs:simpleType>
            <xs:restriction base="xs:integer">
              <xs:minInclusive value="0"/>
              <xs:maxInclusive value="100"/>
            </xs:restriction>
        </xs:simpleType>
    </xs:element>

    <xs:element name="quote">
        <xs:complexType>
          <xs:sequence>  
            <xs:element ref="Symbol"/>
          </xs:sequence>
          <xs:attribute name="symbol" use="required" type="xs:NCName"/>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

如果我说的是真的，那么你的 jaxb 绑定应该是这样的：

```
<bindings xmlns="http://java.sun.com/xml/ns/jaxb"
      xmlns:xsi="http://www.w3.org/2000/10/XMLSchema-instance"
      xmlns:xs="http://www.w3.org/2001/XMLSchema"
      version="2.1">
    <bindings schemaLocation="some.xsd"> <!-- not yahoo.xsd -->
        <bindings node="//xs:element[@name='quote']/xs:complexType/xs:sequence/xs:element[@ref='Symbol']">
            <property name="SymbolAttribute" />
        </bindings>
    </bindings>

</bindings> 
```

生成的java类将是：

```
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "", propOrder = {
    "symbolAttribute"
})
@XmlRootElement(name = "quote")
public class Quote {

    @XmlElement(name = "Symbol")
    protected int symbolAttribute;
    @XmlAttribute(name = "symbol", required = true)
    @XmlJavaTypeAdapter(CollapsedStringAdapter.class)
    @XmlSchemaType(name = "NCName")
    protected String symbol;
    .... 
```

# php - 图像位于目录中；在 MySql 中加载的图像名称。PHP 脚本不返回图像

> ID：15168589
> 
> 赞同：0
> 
> 时间：2013-03-01T23:26:44.097
> 
> 标签：php, directory, return

我一直在尝试不同的方法，以便让这个脚本在 MySql DB 中查询图像名称，然后转到目录并返回具有相同名称的图像。概念上似乎很简单，但我不断得到一堆混合结果，并且没有一个结果返回图像。

这是我尝试过的最新代码：

```
$sqlCar = mysql_query("SELECT img_nm FROM vehicles WHERE sold='n' ORDER BY year DESC");

/***************************
****
Code Returns '1'
******************************/

$dbImage = $sqlCar;
$dirImage = scandir($_SERVER['DOCUMENT_ROOT'].'/car-pics/');

    function imgCompare($dbImage){
    if ($dbImage == $dirImage[img_nm]){
        echo $dirImage[img_nm];
    } else {
        echo "Image Coming Soon";   
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:28:18.807

您没有将 $dirImage 作为参数添加到函数中。您可以通过将其添加为参数或将 global 关键字添加到函数的第一行来解决此问题，如下所示：

```
function imgCompare($dbImage){
    global $dirImage;

    if ($dbImage == $dirImage[img_nm]){
        echo $dirImage[img_nm];
    } else {
        echo "Image Coming Soon";   
    }
} 
```

另外，数据库中的 img_nm 中有哪些值？scandir 使用索引值数组。所以 $dirImage[0] 会工作，但 $dirImage['filename.jpg'] 不会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:34:36.507

mysql_query 函数不会将您要查找的值直接返回到可以直接访问的 $sqlCar 中。

你将不得不做类似的事情

```
$row = mysql_fetch_array( $sqlCar ); 
```

然后引用数组获取图片名称

```
$dbImage = $row['img_nm']; 
```

# android - 键盘“下一步”按钮颜色

> ID：15168590
> 
> 赞同：1
> 
> 时间：2013-03-01T23:26:45.167
> 
> 标签：android, android-softkeyboard

我正在尝试找出如何获取`Next`Android 键盘上按钮的颜色。它是由操作系统设置的，因为在 Kindle Fire 上它是橙色的，而在 Nexus 7 上它是蓝色的。

是否有系统调用来获取该颜色？

我想在我的应用程序的其他部分使用该颜色，使其看起来像操作系统的颜色。

Kindle Fire 键盘：

![在此处输入图像描述](../Images/89512d7dab41a14e7c26cfd959b5edbd.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T23:29:32.130

你不能。这是由输入法（例如键盘）定义的，而不是操作系统（这就是 Kindle 与 Android 不同的原因——亚马逊有自己的自定义键盘）。

这是您不应该尝试处理的事情，除非您正在编写自己的自定义键盘。

# reportbuilder3.0 - 格式化标题中的日期

> ID：15168591
> 
> 赞同：1
> 
> 时间：2013-03-01T23:26:49.283
> 
> 标签：reportbuilder3.0

我已经弄清楚如何在我的标题中获取日期（来自报告参数）：

```
[@Start] 
```

恼人的是我不能做我真正想做的“这个”

```
[@Start] to [@End] 
```

但我可以处理它；它只是意味着 3 个标题而不是一个。

但是，我似乎无法弄清楚如何格式化日期：

我得到：2011 年 11 月 13 日上午 12:00:00

我要：11月13日

我可以忍受 2011 年 11 月 13 日

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T09:27:06.980

对于后缀，我建议使用该`switch`函数：

```
=Format(Parameters!Start.Value, "MMM-dd") + 
    Switch(Format(Parameters!Start.Value, "dd") >= 11 And Format(Parameters!Start.Value, "dd") <= 13 , "th",
        Right(Format(Parameters!Start.Value, "dd"), 1) = "1", "st", 
        Right(Format(Parameters!Start.Value, "dd"), 1) = "2", "nd", 
        Right(Format(Parameters!Start.Value, "dd"), 1) = "3", "rd",
        1 = 1, "th") 
```

或者你可以让用户函数做同样的事情......

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-01T23:46:46.260

花了一段时间才发现“expr”字段可能非常复杂。

以下给了我非常接近我需要的东西：

=Format(Parameters!Start.Value, "MMM-dd") + " to " + Format(Parameters!End.Value, "MMM-dd")

# typescript - 在 TypeScript 中创建类似静态的类或模块层次结构？

> ID：15168594
> 
> 赞同：2
> 
> 时间：2013-03-01T23:27:01.583
> 
> 标签：typescript

我正在尝试为我们网站的 javascript 创建一个“全局”配置结构。我想要做的是这样的事情：

```
company.config.serviceUrl = "http://yoursite.com/servic";
company.config.serviceKey = "123456789ABCDEF"; 
```

在 C# 中（是的，我是 C# 人），这将是一个静态类`config`，在`company`具有几个静态属性的命名空间内`serviceUrl`和`serviceKey`.

知道我将如何在**TypeScript**中执行此操作吗？我设法“做到了”，但是查看生成的 javascript，我不确定`Config`公开的类是我想要的。

这是源 TypeScript：

```
module company{
    export class Config {
        serviceUrl = "";
        serviceKey = "";
    } 

    export var config = new Config();
}

company.config.serviceUrl = "http://yoursite.com/service";
company.config.serviceKey = "123456789ABCDEF"; 
```

生成的javascript：

```
var company;
(function (company) {
    var Config = (function () {
        function Config() {
            this.serviceUrl = "";
            this.serviceKey = "";
        }
        return Config;
    })();
    company.Config = Config;    
    company.config = new Config();
})(company || (company = {}));
company.config.serviceUrl = "http://yoursite.com/service";
company.config.serviceKey = "123456789ABCDEF"; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-01T23:46:30.173

你可以只使用模块：

```
module company.config {
    export var serviceUrl = 'http://...';
    export var serviceKey = '1234567890';
} 
```

或者，如果需要，您可以在类上使用静态：

```
module company {
    export class config {
        static serviceUrl = 'http://...';
        static serviceKey = '1234567890';
    }
} 
```

# ios - iPad3 上缺少图层阴影（但在模拟器中有效）

> ID：15168597
> 
> 赞同：0
> 
> 时间：2013-03-01T23:27:10.210
> 
> 标签：ios, objective-c, quartz-graphics, shadow

我使用以下代码在 UIView 后面绘制阴影

```
 self.view.layer.borderColor = [UIColor whiteColor].CGColor;
    self.view.layer.shadowColor = [UIColor blackColor].CGColor;
    self.view.layer.shadowOpacity = 1.0;
    self.view.layer.shadowRadius = 25.0;
    self.view.layer.shadowOffset = CGSizeMake(0, 3);
    self.view.clipsToBounds = NO;

    CGPathRef shadowPath = [UIBezierPath bezierPathWithRect:self.view.layer.bounds].CGPath;
    [self.view.layer setShadowPath:shadowPath]; 
```

这可以在模拟器和 iPhone5 上正常工作。但是在我的 iPad3 上：根本没有阴影。

![在此处输入图像描述](../Images/39849ab08e0fdbae7168163444b44977.png)

知道怎么来的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T22:17:57.757

我找到了解决方案。这与模拟器无关。这是关于纵向与横向方向的界限的回归。我不得不将阴影路径的设置移动到**viewDidAppear**和**didRotateFromInterfaceOrientation**方法中，以便在所有可能的启动方向上正确渲染阴影。

```
-(void)viewDidAppear:(BOOL)animated{
    CGPathRef shadowPath = [UIBezierPath bezierPathWithRect:self.view.layer.bounds].CGPath;
    [self.view.layer setShadowPath:shadowPath];
}

-(void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation {
    CGPathRef shadowPath = [UIBezierPath bezierPathWithRect:self.view.layer.bounds].CGPath;
    [self.view.layer setShadowPath:shadowPath];
} 
```

# asp.net - 从后面的代码中启用RequiredFieldValidator

> ID：15168601
> 
> 赞同：0
> 
> 时间：2013-03-01T23:27:22.380
> 
> 标签：asp.net, css, validation, requiredfieldvalidator

我正在从后面的代码中显示 requiredfieldvalidator 的错误消息，但显示设置为无或隐藏可见。我试图做 .visible = true 但它仍然是隐藏的。我怎样才能让它显示错误消息？文本框位于 GridView 内。

```
<asp:TemplateField HeaderText="SSN">
    <ItemTemplate>
    <asp:TextBox ID="txtSSN" runat="server"></asp:TextBox>
    <asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" ControlToValidate="txtSSN" />
     </ItemTemplate>
</asp:TemplateField>

TextBox txtSSN = (TextBox)r.FindControl("txtSSN");
if (txtSSN.Text == "")
        {
      RequiredFieldValidator RequiredFieldValidator1 = (RequiredFieldValidator)r.FindControl("RequiredFieldValidator1");
      RequiredFieldValidator1.Visible = true;
      RequiredFieldValidator1.Enabled = true;
      RequiredFieldValidator1.ErrorMessage = "This field is required.";
        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T23:29:16.107

将[`IsValid`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.isvalid%28v=vs.85%29.aspx)属性设置为`false`。

```
RequiredFieldValidator1.IsValid = false; 
```

您无需担心可见性，这将自动发生。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T23:32:20.670

当验证无效时验证器会显示自己，因此通过以下方式触发它[`Validator.Validate()`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.validate%28v=vs.110%29.aspx)：

```
RequiredFieldValidator1.Validate(); 
```

> 对关联的输入控件执行验证并更新 IsValid 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-27T19:31:51.277

该字段不能在网格中使用`Isvalid`。如果它在网格中使用`page.validate()`并检查`page.isvalid()`.

# css - CSS 和链接的问题

> ID：15168602
> 
> 赞同：0
> 
> 时间：2013-03-01T23:27:24.637
> 
> 标签：css, hyperlink, font-face

看来你们是对的。更改顺序已解决问题。似乎很容易解决。感谢所有评论/帮助。

* * *

我的链接和 css 有一些问题。下面是我的网站代码。我的问题是我有 5 个链接都使用同一个类。它们都正确显示并且链接工作正常，但悬停和活动在第一个时不会改变。最后三个按他们应该的方式工作。为什么是这样？到底是怎么回事？我已经全部删除并重新输入。我尝试过不同的浏览器。删除了缓存。没有什么。

HTML 代码：

```
<tr bgcolor="#FFFFFF">
    <td rowspan="2">
        <img src="images/layout/header-menu/menu_02.gif" width="57" height="51" alt=""></td>
  <td align="center" height="29"><a href="index.php" class="menu">Home</a></td>
    <td rowspan="2">
        <img src="images/layout/header-menu/menu_04.gif" width="41" height="51" alt=""></td>
  <td align="center" height="29"><a href="about.php" class="menu">About</a></td>
    <td rowspan="2">
        <img src="images/layout/header-menu/menu_06.gif" width="36" height="51" alt=""></td>
  <td align="center" height="29"><a href="products.php" class="menu">Products</a></td>
    <td rowspan="2">
        <img src="images/layout/header-menu/menu_08.gif" width="36" height="51" alt=""></td>
  <td align="center" height="29"><a href="recipes.php" class="menu">Recipes</a></td>
    <td rowspan="2">
        <img src="images/layout/header-menu/menu_10.gif" width="36" height="51" alt=""></td>
  <td align="center" height="29"><a href="contact.php" class="menu">Contact</a></td>
    <td rowspan="2">
        <img src="images/layout/header-menu/menu_12.gif" width="58" height="51" alt=""></td> 
```

CSS 代码：

```
a.menu:link {
color: #94AA45;
text-decoration: none;
font-family: TektonPro-BoldExt-FF, TektonPro-BoldExt, Geneva, Arial, Helvetica, sans-serif;
font-size: 22px;
font-weight: normal;}

a.menu:hover {
color: #713010;
text-decoration: none;
font-family: TektonPro-BoldExt-FF, TektonPro-BoldExt, Geneva, Arial, Helvetica, sans-serif;
font-size: 22px;
font-weight: normal;}

a.menu:active {
color: #F9A22E;
text-decoration: none;
font-family: TektonPro-BoldExt-FF, TektonPro-BoldExt, Geneva, Arial, Helvetica, sans-serif;
font-size: 22px;
font-weight: normal;}

a.menu:visited {
color: #94AA45;
text-decoration: none;
font-family: TektonPro-BoldExt-FF, TektonPro-BoldExt, Geneva, Arial, Helvetica, sans-serif;
font-size: 22px;
font-weight: normal;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:40:06.010

按以下顺序放置您的链接 css：

一个

一个：访问过

一：悬停

一个：活跃的

对于您的示例，此 css 应按预期工作：

```
 a.menu:link {
    color: #94AA45;
    text-decoration: none;
    font-family: TektonPro-BoldExt-FF, TektonPro-BoldExt, Geneva, Arial, Helvetica, sans-serif;
    font-size: 22px;
    font-weight: normal;}

    a.menu:visited {
    color: #94AA45;
    text-decoration: none;
    font-family: TektonPro-BoldExt-FF, TektonPro-BoldExt, Geneva, Arial, Helvetica, sans-serif;
    font-size: 22px;
    font-weight: normal;}

    a.menu:hover {
    color: #713010;
    text-decoration: none;
    font-family: TektonPro-BoldExt-FF, TektonPro-BoldExt, Geneva, Arial, Helvetica, sans-serif;
    font-size: 22px;
    font-weight: normal;}

    a.menu:active {
    color: #F9A22E;
    text-decoration: none;
    font-family: TektonPro-BoldExt-FF, TektonPro-BoldExt, Geneva, Arial, Helvetica, sans-serif;
    font-size: 22px;
    font-weight: normal;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:50:11.467

@Artur 是对的，@Guido 也是。

您绝对不想使用表格作为导航元素。

这是我对您的代码所做的：

**HTML：**

```
<div class="menu">
<td rowspan="2">
    <img src="images/layout/header-menu/menu_02.gif" width="57" height="51"
    alt="">
</td>
<td align="center" height="29"><a href="#" class="menu">Home</a>
</td>
<td rowspan="2">
    <img src="images/layout/header-menu/menu_04.gif" width="41" height="51"
    alt="">
</td>
<td align="center" height="29"><a href="#" class="menu">About</a>
</td>
<td rowspan="2">
    <img src="images/layout/header-menu/menu_06.gif" width="36" height="51"
    alt="">
</td>
<td align="center" height="29"><a href="#" class="menu">Products</a>
</td>
<td rowspan="2">
    <img src="images/layout/header-menu/menu_08.gif" width="36" height="51"
    alt="">
</td>
<td align="center" height="29"><a href="#" class="menu">Recipes</a>
</td>
<td rowspan="2">
    <img src="images/layout/header-menu/menu_10.gif" width="36" height="51"
    alt="">
</td>
<td align="center" height="29"><a href="#" class="menu">Contact</a>
</td>
<td rowspan="2">
    <img src="images/layout/header-menu/menu_12.gif" width="58" height="51"
    alt="">
</td>
</div> 
```

**CSS：**

```
 .menu a {
    color: #94AA45;
    text-decoration: none;
    font-family: TektonPro-BoldExt-FF, TektonPro-BoldExt, Geneva, Arial, Helvetica, sans-serif;
    font-size: 22px;
    font-weight: normal;
}
.menu a:visited {
    color: #94AA45;
    text-decoration: none;
    font-family: TektonPro-BoldExt-FF, TektonPro-BoldExt, Geneva, Arial, Helvetica, sans-serif;
    font-size: 22px;
    font-weight: normal;
}
.menu a:hover {
    color: #713010;
    text-decoration: none;
    font-family: TektonPro-BoldExt-FF, TektonPro-BoldExt, Geneva, Arial, Helvetica, sans-serif;
    font-size: 22px;
    font-weight: normal;
}
.menu a:active {
    color: #F9A22E;
    text-decoration: none;
    font-family: TektonPro-BoldExt-FF, TektonPro-BoldExt, Geneva, Arial, Helvetica, sans-serif;
    font-size: 22px;
    font-weight: normal;
} 
```

我也为此做了一个小提琴：

[http://jsfiddle.net/ultraloveninja/D5rUR/](http://jsfiddle.net/ultraloveninja/D5rUR/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:35:38.617

将访问设置为显示在 CSS 中的链接之后。

我记得的方式是：* *L* *o* *V* *e * *HA* *te

在我的浏览器中测试并在重新安排时工作。问题是您访问的样式与您的链接样式相同，并覆盖悬停（当您在 index.php 上时）

# html - 在画布上打印 div

> ID：15168604
> 
> 赞同：0
> 
> 时间：2013-03-01T23:27:36.173
> 
> 标签：html, canvas

在 JavaScript 中，是否可以使用 canvas 元素打印 HTML 页面的元素？例如，在 HTML5 画布上打印以下元素会很有用，以便可以操纵 div 中的各个像素：

```
<table border="1">
<tr>
<td>row 1, cell 1</td>
<td>row 1, cell 2</td>
</tr>
<tr>
<td>row 2, cell 1</td>
<td>row 2, cell 2</td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T00:05:11.623

出于安全原因，不能将“实时”html 元素写入画布。（想象一个身份窃贼编写了一个脚本，将您的银行用户+密码复制到画布并将其发送给窃贼）。

看起来 Niklas von Hertzen 正在编写一个 html 解析器。如果您可以控制要呈现的 html，则他的方法将起作用。

这种方法称为“无头”处理，因为 html 是计算出来的，但不会呈现给浏览器。

如果您需要更成熟的无头处理器，这是一个不错的选择：http: [//phantomjs.org/](http://phantomjs.org/)

# macos - 在沙盒中帮助应用程序和主应用程序之间进行通信

> ID：15168605
> 
> 赞同：2
> 
> 时间：2013-03-01T23:27:40.820
> 
> 标签：macos, cocoa, helper

我有一个状态栏应用程序，我可以从中启动一个辅助应用程序以获取首选项。所有首选项都存储在`NSUserDefaults`助手应用程序中，并`addSuiteNamed:`在主应用程序中使用。

当辅助应用程序中的首选项发生更改时，我想通知主应用程序。做这个的最好方式是什么？

我尝试过使用`NSDistributedNotificationCenter`，但这太慢而且不太可靠。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T00:56:51.150

[Realmac](https://github.com/realmacsoftware/RMSharedPreferences) Software 的 RMSharedPreferences 似乎正是我想要的。它允许在多个应用程序之间进行通信，并且非常容易设置，并且似乎比 NSDistributedNotificationCenter 更可靠。

# c# - 多语句事务中不允许 CREATE DATABASE 语句

> ID：15168616
> 
> 赞同：13
> 
> 时间：2013-03-01T23:28:41.710
> 
> 标签：c#, entity-framework

我正在尝试构建一个快速测试，每次运行时都会删除并重新创建数据库。我有以下内容：

```
[TestClass]
public class PocoTest
{
    private TransactionScope _transactionScope;
    private ProjectDataSource _dataSource; 
    private Repository _repository = new Repository();
    private const string _cstring = "Data Source=.;Initial Catalog=test_db;Trusted_Connection=True";

    [TestInitialize]
    public virtual void TestInitialize()
    {
        _dataSource = new ProjectDataSource(_cstring);
        _dataSource.Database.Delete();
        _dataSource.Database.CreateIfNotExists();
        _transactionScope = new TransactionScope();
    }
    [TestMethod]
    public void TestBasicOperations()
    {                
        var item = _repository.AddItem(new Item(){Details = "Test Item"});
        //  AddItem makes a call through the data context to add a set and then calls datacontext.SaveChanges()
    }

    [TestCleanup]
    public void TestCleanup()
    {
        // rollback
        if (_transactionScope != null)
        {
            _transactionScope.Dispose();
        }
    } 
```

但是，当我运行测试时，出现以下错误：

> 结果消息：测试方法 Project.Repository.UnitTests.PocoTest.TestBasicOperations 抛出异常：System.Data.SqlClient.SqlException：多语句事务中不允许创建数据库语句。

ProjectDataSource 在这里：

```
public class ProjectDataSource : DbContext, IProjectDataSource
{

    public ProjectDataSource() : base("DefaultConnection")
    {

    }

    public ProjectDataSource(string connectionString) : base(connectionString)
    {

    }

    public DbSet<Set> Sets { get; set; }
} 
```

存储库：

```
public class Repository : IRepository
{
    private readonly ProjectDataSource _db = new ProjectDataSource();
    public Item AddItem(Item item)
        {
            _db.Items.Add(item);
            _db.SaveChanges();
            return item;
        }
} 
```

为什么会这样？

另外 - 如果它有任何区别 - 如果我在 TestMethod 中注释掉 AddItem 行，则不会发生错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-04-08T10:56:45.137

你也可以使用`db.Database.ExecuteSqlCommand(TransactionalBehavior.DoNotEnsureTransaction, sqlCommand);`

有关详细信息，请参阅[https://stackoverflow.com/a/24344654/375114](https://stackoverflow.com/a/24344654/375114)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-11-07T22:07:15.863

**供您参考，此错误是设计使然，只要在活动事务中向Microsoft SQL Server发出***不可事务的*命令，就会发生此错误。

 **因此，解决方案是允许**Database.CreateIfNotExists()**在任何事务范围之外命中数据库。请记住，**SQL Profiler**是您的朋友。

您可以获得一个粗略[更新的命令列表，这些命令不允许在事务中运行](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc00729.1500/html/errMessageAdvRes/BABFDFIB.htm)。

注意：如果有人想知道我为什么要提供基于 Sybase 产品的列表，请记住 Microsoft SQL Server 与 Sybase 引擎共享其大部分基本基因。如需进一步阅读，请参阅[https://en.wikipedia.org/wiki/Microsoft_SQL_Server](https://en.wikipedia.org/wiki/Microsoft_SQL_Server)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-02T01:36:49.337

万一其他人遇到这个问题：

在我的 Repository 类中，我对通常标记为“dbContext”的内容有另一个定义 - ProjectDataSource。这意味着一个上下文是在我的测试类中创建的，而另一个上下文是在我的 Repository 对象中创建的。将连接字符串发送到我的 repo 类解决了这个问题：

在存储库中：

```
public class Repository : IRepository
    {
        private readonly ProjectDataSource _db;

        public Repository(string connectionString)
        {
            _db = new ProjectDataSource(connectionString);   
        }

        public Repository()
        {
            _db = new ProjectDataSource();   
        } 
```

根据我的测试：

```
private TransactionScope _transactionScope;
        private Repository _repository;
        private ProjectDataSource _dataSource; 
        private const string _connectionString = "Data Source=.;Initial Catalog=test_db;Trusted_Connection=True";

        [TestInitialize]
        public virtual void TestInitialize()
        {
            _repository = new Repository(_connectionString);
            _dataSource = new ProjectDataSource(_connectionString);
            _dataSource.Database.Delete();
            _dataSource.Database.CreateIfNotExists();
            _transactionScope = new TransactionScope();
        } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-02T09:46:03.740

您不能围绕某些 SQL 命令使用隐式提交。创建和删除数据库是一个示例 SQL 服务器将执行**AUTOCommit**

请参阅 MS SQL 帮助中的备注部分。 [http://msdn.microsoft.com/en-us/library/ms176061.aspx](http://msdn.microsoft.com/en-us/library/ms176061.aspx)

以及有关自动提交的更多信息... [http://msdn.microsoft.com/en-us/library/ms187878%28v=sql.105%29](http://msdn.microsoft.com/en-us/library/ms187878%28v=sql.105%29)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-14T07:38:14.190

试试这个代码

使用 (TransactionScope ts = new TransactionScope(TransactionScopeOption.Suppress))

{
var sqlCommand = String.Format("创建数据库 [{0}]", "TempBackupDB"); _context.Database.ExecuteSqlCommand(TransactionalBehavior.DoNotEnsureTransaction, sqlCommand);

ts.Complete();

}

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2021-03-24T11:27:43.037

您需要在包管理器控制台上运行**Update-Database**命令。**

# html - 隐藏页面源中的值但显示在页面上

> ID：15168618
> 
> 赞同：0
> 
> 时间：2013-03-01T23:28:59.517
> 
> 标签：html, obfuscation

我希望能够在页面上显示一些值，但将它们隐藏在页面源中。我很确定这是不可能的，但我想我会问。

编辑

我正在编写自己的验证系统以防止黑客/垃圾邮件发送者。我在传递数据时使用加密，但当前可以在页面源中查看原始值（因此有人可以在源上编写循环并提取数据）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:33:50.157

正式根据您的标签不包括javascript：不...

但是，可以在加载后写入 DOM，但最终可能无法实现您想要的。

你可以这样做：

```
<div id="something">

</div> 
```

然后在页面加载时在页脚中使用 javascript 注入该 div 的值：

```
<script type="text/javascript">
    document.getElementById("something").innerHTML = "This is a previously hidden value";
</script> 
```

这将在加载后将其写入 dom，而不是将其写入页面源。真正的问题是你到底想做什么？如果您想完全隐藏某些东西，那么这几乎只是一种不便。任何想钻出来的人都可以追踪到这一点。

如果您用您的真实意图更新您的问题，那么也许我们可以提供更好的解决方案。

**编辑**

根据您的编辑，您需要一个不显示原始值的验证系统。一种选择是将值存储在数据库中，并且仅将行的引用 id 传递给表单，假设这就是您的意思。您可以在服务器端进行所有处理，并最大限度地减少传递到客户端的敏感数据量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T23:39:30.203

直接的答案是否定的，这是不可能的——因为浏览器必须接收它打算显示的任何内容。

话虽如此，根据您的意图，有一些方法可以将内容显示到页面但将其隐藏在源中。

一个常见的问题是您希望从垃圾邮件机器人中隐藏但需要向您的用户显示的电子邮件 - 如果是这种情况（或类似情况），我提出了几个解决方案：

1.  **使用 HTML 字符实体来隐藏单词：**请参阅[此处](http://www.w3schools.com/html/html_entities.asp)。

2.  **使用Javascript动态生成它**

3.  **使用 HTML 编码：** [这](http://www.wbwip.com/wbw/emailencoder.html)是一个不错的工具。

4.  **使用带有 DRM 的 SilverLight 等插件：** [请参阅此处](http://msdn.microsoft.com/en-us/library/cc838192%28v=vs.95%29.aspx)。

5.  **提供图像**（注意，一些垃圾邮件机器人知道如何使用 OCR）

6.  **使用类似[reCaptcha mailhide](http://www.google.com/recaptcha/mailhide/)**

*归根结底，用户几乎肯定能够复制您试图隐藏的任何内容 - 但如果您只是试图防御垃圾邮件机器人或自动化工具，那么这些选项之一可能对您有用。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T23:37:01.053

做到这一点的方法是`<div id='fillme'>`在您的页面上有一个（或其他容器），然后在页面加载后使用 AJAX 使用信息填充它。这样，当有人单击“查看源代码”时，他们将看到加载的 html（或 php 或其他）文件的内容，而不是 javascript 运行后的最终结果。jQuery 具有出色的 AJAX 功能，您最终会得到如下代码：

```
$.ajax({
    type: 'POST',
    url: '/server/side/script.php',
    dataType: 'json',
    data: { thing: value, thing2: value },
    async: false,
    success: function(data) {
        $('#fillme').html(data);
    },
    error: function() {
        alert('oops');
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T23:32:24.280

由于页面源是浏览器生成页面上所有内容所需的所有数据，因此不可能。

当然，您可以显示图像而不是值，不能直接从源代码中读取。或者使用 html5 画布或其他东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-01T23:32:27.290

不幸的是，这个问题的简短答案是，你不能。已经提出了各种方法，但所有这些方法都很容易被规避。最后，确保没有人可以窃取您的源代码的唯一可靠的方法就是永远不要将其放到 Internet 上。

# vbscript - vbscript 上的正则表达式

> ID：15168620
> 
> 赞同：0
> 
> 时间：2013-03-01T23:29:08.850
> 
> 标签：vbscript

我有一个这样的日志文件：

```
some strings...
<FX>
another strings...
<FX>
 <TEG1>
  <TEG2>
  </TEG2>
 </TEG1>
</FX>
some strings...
<FX>
<FX>
 <TEG1>
 </TEG1>
</FX> 
```

我需要解析它并得到这个结果：

```
<FX>
 <TEG1>
  <TEG2>
  </TEG2>
 </TEG1>
</FX> 
```

和

```
<FX>
 <TEG3>
 </TEG3>
</FX> 
```

我已经写过这样的正则表达式：

```
<FX>([\s\S]+?)</FX> 
```

但它返回此匹配项：

```
<FX>
another strings...
<FX>
 <TEG1>
  <TEG2>
  </TEG2>
 </TEG1>
</FX> 
```

和

```
<FX>
<FX>
 <TEG1>
 </TEG1>
</FX> 
```

任何人都可以帮助我使用正则表达式吗？预先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T15:13:11.067

根据隐藏在“另一个字符串”后面的内容，您可能会逃脱：

```
 Dim sAll : sAll = goFS.OpenTextFile("..\data\15168620.txt").ReadAll()
  WScript.Echo sAll
  WScript.Echo "--------"
  Dim reX  : Set reX = New RegExp
  reX.Global  = True
  reX.Pattern = "<FX>[\s\S]*?(<FX>[\s\S]+?</FX>)"
  Dim oMTS : Set oMTS = reX.Execute(sAll)
  Dim oMT
  For Each oMT in oMTS
      WScript.Echo oMT.SubMatches(0)
      WScript.Echo "--------"
  Next 
```

输出：

```
some strings...
<FX>
another strings...
<FX>
 <TEG1>
  <TEG2>
  </TEG2>
 </TEG1>
</FX>
some strings...
<FX>
<FX>
 <TEG1>
 </TEG1>
</FX>

--------
<FX>
 <TEG1>
  <TEG2>
  </TEG2>
 </TEG1>
</FX>
--------
<FX>
 <TEG1>
 </TEG1>
</FX>
-------- 
```

**更新：**

我仍然希望我们可以避免行人接近：

```
 Dim sAll : sAll = goFS.OpenTextFile("..\data\15168620-2.txt").ReadAll()
  WScript.Echo sAll
  WScript.Echo "--------"
  Dim aAll : aAll = Split(sAll, "FX>")
  Dim sTry
  For Each sTry In aAll
      If "</" = Right(sTry, 2) Then
         WScript.Echo "<FX>" & sTry & "FX>"
         WScript.Echo "--------"
      End If
  Next 
```

输出：

```
some strings...
<FX>
another <FX> strings...
<FX><FX><FX><FX><FX>
<FX>
<FX>
 <TEG1>
  <TEG2>
  </TEG2>
 </TEG1>
</FX>
some strings...
<FX>
<FX>
 <TEG1>
 </TEG1>
</FX>

--------
<FX>
 <TEG1>
  <TEG2>
  </TEG2>
 </TEG1>
</FX>
--------
<FX>
 <TEG1>
 </TEG1>
</FX>
-------- 
```

**更新二：**

行人方法 - 逐行阅读，在**每个** `<FX>`上开始一个新的集合，处理/输出集合`</FX>`：

```
 Dim alLines : Set alLines = CreateObject("System.Collections.ArrayList")
  alLines.Capacity = 500
  Dim oTS     : Set oTS     = goFS.OpenTextFile("..\data\15168620-2.txt")
  Do Until oTS.AtEndOfStream
     Dim sLine : sLine = oTS.Readline()
     Select Case True
       Case "<FX>" = Left(sLine, 4)
            alLines.Clear
            alLines.Add sLine
       Case "</FX>" = Left(sLine, 5)
            alLines.Add sLine
            WScript.Echo Join(alLines.ToArray(), vbCrLf)
            WScript.Echo "--------"
       Case Else
            alLines.Add sLine
     End Select
  Loop
  oTS.Close 
```

输出：

```
<FX>
 <TEG1>
  <TEG2>
  </TEG2>
 </TEG1>
</FX>
--------
<FX>
 <TEG1>
 </TEG1>
</FX>
-------- 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T13:27:32.033

With so huge file (10 GB), `RegExp` is worthless. Here is my idea.

```
' StripInvalidXML.vbs
Option Explicit

Const ForReading = 1, ForWriting = 2, ForAppending = 8
Const TristateUseDefault = -2, TristateTrue = -1, TristateFalse = 0
Const TAG_OPEN = "<FX>", TAG_CLOSE = "</FX>"

Dim fso, fin, fout
Dim sLine, sBlock

Set fso  = CreateObject("Scripting.FileSystemObject")
Set fin  = fso.OpenTextFile("input_log.xml",  ForReading,  False)
Set fout = fso.OpenTextFile("output_log.xml", ForAppending, True)

Do Until fin.AtEndOfStream
    sLine = fin.ReadLine
    If sLine = TAG_OPEN Then
        sBlock = sLine
    Else
        sBlock = sBlock & sLine
    End If
    sBlock = sBlock & vbNewLine
    If sLine = TAG_CLOSE Then
        fout.WriteLine sBlock
    End If
Loop

fin.Close
fout.Close 
```

# hsqldb - 无法将二进制流插入 hsqldb 中的 BLOB？

> ID：15168627
> 
> 赞同：1
> 
> 时间：2013-03-01T23:29:54.187
> 
> 标签：hsqldb

我有以下 hsqldb 架构（由 SQLWorkbench 报告）：

```
DROP TABLE TEST CASCADE;
CREATE TABLE TEST
(
   NAME      VARCHAR(256),
   METADATA  VARCHAR(2048),
   DATA      BLOB
);

GRANT TRIGGER, INSERT, REFERENCES, DELETE, SELECT, UPDATE ON TEST TO DBA; 
```

接下来，我尝试使用以下准备好的语句将文件插入 DATA 字段：

```
MERGE INTO test  USING (VALUES ?, ?, ?) I (name, metadata, data)  ON (test.name=I.name)  WHEN MATCHED THEN UPDATE SET test.data = I.data, test.metadata = I.metadata  WHEN NOT MATCHED THEN INSERT (name, metadata, data) VALUES (I.name, I.metadata, I.data) 
```

这是代码：

```
String name = ...;
String metadata = ...;
InputStream data = ...;
JDBCDataSource ds = new JDBCDataSource();
ds.setDatabase("jdbc:hsqldb:file:c:/tmp/file.db");
ds.setUser("sa");
ds.setPassword("");
PreparedStatement set = ds.getConnection().prepareStatement(m_setSql);
set.setString(1, name);
set.setString(2, metadata);
set.setBinaryStream(3, data);
set.executeUpdate(); 
```

setBinaryStream 失败，因为参数类型被认为是`VARCHAR`，而不是`BLOB`。实际上，该函数`org.hsqldb.jdbc.JDBCPreparedStatement.setBinStream`具有以下语句：

```
 if (parameterTypes[parameterIndex - 1].typeCode == Types.SQL_BLOB) {
        setBlobParameter(parameterIndex, x, length);

        return;
    } 
```

对于`parameterIndex`3，它应该输入 if 语句并调用`setBlobParameter`. 但是，由于某种原因，`typeCode`返回 12，对应于`VARCHAR`，跳过 if 语句，最后引发 an并**在转换中显示不兼容数据类型**`org.hsqldb.HsqlException`的消息。

 **我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T13:02:56.150

MERGE 语句中参数值的类型未知，默认为 VARCHAR。您需要将 BLOB 参数强制转换为 BLOB。

```
MERGE INTO test  USING (VALUES ?, ?, CAST(? AS BLOB)) I (name, metadata, data)  
ON (test.name=I.name)  
WHEN MATCHED THEN UPDATE SET test.data = I.data, test.metadata = I.metadata
WHEN NOT MATCHED THEN INSERT (name, metadata, data) VALUES (I.name, I.metadata, I.data) 
```**

# ios - 如何让 NSTimer 和一些操作在后台继续工作？

> ID：15168628
> 
> 赞同：0
> 
> 时间：2013-03-01T23:30:35.117
> 
> 标签：ios, objective-c, xcode, push-notification, nstimer

我正在 4.3 模拟器和 3.2 xcode 上编写 ios 应用程序

该应用程序每分钟都会`NSTimer`检查某些网站上的新闻，如果有新闻，该应用程序会发出警报消息，并带有声音“...网站上有新内容！”

但是，如果我关闭应用程序或它进入睡眠状态，计时器会在后台停止。所以，我读过很多文章，比如 [http://www.codeproject.com/Articles/124159/Hour-21-Building-Background-Aware-Applications](http://www.codeproject.com/Articles/124159/Hour-21-Building-Background-Aware-Applications)

[应用程序进入后台时如何保持NSTimer？](https://stackoverflow.com/questions/9840911/how-keep-nstimer-when-application-entering-background)

他们都没有帮助我。我的问题：

**1）**我应该使用什么技术或技巧来制作这样的应用程序？一位好人告诉我，我只需要使用推送通知。

**2)**如果要使用推送通知，我是否必须从苹果公司获得每年 100 美元的开发人员计划并保持我的 Mac 书始终打开以创建推送通知服务器？

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:38:19.153

在后台运行只有少数获准的用途：音乐、导航、VOIP。如果您的应用程序不执行其中一项操作，它最多只能在后台运行 10 分钟，然后它将被操作系统挂起。

推送通知需要服务器。您要么自己运行它，要么使用urbanairship.com 之类的服务。推送通知就像设备上的警报一样显示。它不会唤醒您的应用，除非用户通过响应警报来唤醒您的应用。

请阅读：http: [//developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html](http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html)

如果您还没有支付 100 美元，您将无法在真实设备上运行您的应用程序。我认为模拟器无法正确模拟后台状态，因此调试后台任务将非常困难。

# javascript - 我在我的 Node.js 应用程序中使用 MongoSkin，在一段时间不活动后，它失去了与数据库的连接

> ID：15168632
> 
> 赞同：2
> 
> 时间：2013-03-01T23:30:54.747
> 
> 标签：javascript, node.js, mongodb, mlab, mongoskin

我正在构建[我的第一个 Node.js 应用程序](https://github.com/Chevex/CodeTunnel)，但遇到了[MongoDB](https://github.com/kissjs/node-mongoskin)的问题。我正在使用 MongoSkin 驱动程序。

一旦我开始我的应用程序，一切都会很好。我可以坐着玩它一个小时，它会继续工作。但是，如果我让它静置几分钟而没有任何活动，那么下一个请求将导致错误：

> 错误：连接在 EventEmitter.emit 的 Server.connect.connectionPool.on.server._serverState (X:\Code\CodeTunnel\node_modules\mongoskin\node_modules\mongodb\lib\mongodb\connection\server.js:520:35) 处关闭(events.js:126:20) 在 eventEmitter 的 connection.on._self._poolState (X:\Code\CodeTunnel\node_modules\mongoskin\node_modules\mongodb\lib\mongodb\connection\connection_pool.js:109:15)。在 Socket.EventEmitter.emit 的 Socket.closeHandler (X:\Code\CodeTunnel\node_modules\mongoskin\node_modules\mongodb\lib\mongodb\connection\connection.js:427:12) 处发出 (events.js:99:17) (events.js:96:17) 在 Socket._destroy.destroyed (net.js:358:10) 在 process.startup.processNextTick.process._tickCallback (node.js:244:9)

我已经尝试按照[mongoskin 文档](https://github.com/kissjs/node-mongoskin)`auto_reconnect=true`中的建议添加到连接字符串，但这没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-06T06:48:08.487

我最终想通了这一点。解决方案相当简单。

# [使用猫鼬](http://mongoosejs.com/)

*...或其他东西*。

除了 MongoSkin 的问题，我什么都没有，在终于花时间学习 Mongoose 之后，我还是更喜欢它。模型范式很棒，尤其是因为每个模型都有自己的持久化方法来保存对文档的更改。使用 Promise 创建流畅的查询 API 比原生 MongoDB 驱动程序提供的标准回调地狱更强大且更易于阅读。MongoSkin 仅略微缓解了回调地狱，并且仍然很难阅读更复杂的查询。

编辑：投反对票……真的吗？否决票先生，您脑子里在想什么？*“Mongoose 不是我喜欢的 ORM，所以这是一个反对意见。”* ?

# php - 使用复选框中的数据更新数组

> ID：15168634
> 
> 赞同：0
> 
> 时间：2013-03-01T23:31:05.297
> 
> 标签：php, html

我正在尝试从一个复选框将数据添加到我的数组中。勾选时复选框输出，我需要它输出 1，而未勾选时输出 0。我已经添加了代码

```
'allow_email' => ($_POST['allow_email'] == 'on') ? 1 : 0); 
```

但它不喜欢它并产生错误。有没有别的写法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:32:25.747

`'allow_email' => ($_POST['allow_email']) ? 1 : 0));`应该管用。原因是如果没有选中该框，它甚至不会出现在 POST 变量列表中，从而创建一个错误的表达式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:33:10.597

你有一个缺少的括号

```
'allow_email' => ((@$_POST['allow_email'] == 'on') ? 1 : 0); 
```

也抑制你的 POST 以防它为空

# c# - Console.WriteLine('single quote'); 有什么区别？和 Console.WriteLine("双引号");

> ID：15168635
> 
> 赞同：1
> 
> 时间：2013-03-01T23:31:06.510
> 
> 标签：c#, .net, console

为什么 Visual Studio 会抛出错误

```
Console.WriteLine('string with single quote'); 
```

而不是：

```
Console.WriteLine("string with double quote"); 
```

?

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-01T23:32:19.593

单引号 ( `'`) 用于`char`只能采用单个字符的数据类型，因此名称，排除转义值，例如`'\n'`,等，这些值在编译时`'\r'`仍然表示单个字符。`char`

双引号 ( `"`) 用于表示 UTF-16 编码的字符串（[通常](https://en.wikipedia.org/wiki/UTF-16)每个字符 2 个字节，不是`ASCII`，也不是 .NET 的默认值 - UTF-16），但不能处理所有已知字符集 ( [UTF-8](https://en.wikipedia.org/wiki/UTF-8) )。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:36:32.910

Console.WriteLine('') 将接受字符文字。因此，当您尝试传递超过 1 个字符时，它会产生错误。

而 Console.WriteLine("") 将接受一个可以包含单词的字符串。

# maven - 在 mercurial 存储库中创建 maven 存储库

> ID：15168641
> 
> 赞同：2
> 
> 时间：2013-03-01T23:31:25.407
> 
> 标签：maven, mercurial, repository, release

是否可以在 mercurial 存储库中创建一个 Maven 存储库？

几年前，我使用 wagon-svn 扩展在 SVN 的谷歌代码存储库中做了同样的事情。

```
<build>
    [...]
    <extensions>
        <extension>
            <groupId>org.jvnet.wagon-svn</groupId>
            <artifactId>wagon-svn</artifactId>
            <version>1.12</version>
        </extension>
    </extensions>
    <distributionManagement>
        <repository>
            <uniqueVersion>false</uniqueVersion>
            <id>googlecode</id>
            <url>svn:https://[...].googlecode.com/svn/repo/</url>
        </repository>
    </distributionManagement>
</build> 
```

先感谢您！

# javascript - 计算百分比余数

> ID：15168645
> 
> 赞同：0
> 
> 时间：2013-03-01T23:31:47.403
> 
> 标签：javascript, html, select, drop-down-menu

我正在尝试从 4 个下拉选择选项中自动计算剩余百分比。这是我到目前为止的代码，但我似乎无法让它工作。计算后，未开发百分比应为总百分比加减100%。例如，如果 4 个中的每一个都使用了 10%，则未开发的将是 60%。任何帮助深表感谢。

```
<html>

<head>
<title>Calculation</title>

<script language="javascript" type="text/javascript">

function calcPercentUseSum(){
var Percent1 = document.getElementsByName("SingleFamilyUsePercent");
var strUser = Percent1.options[Percent1.selectedIndex].value;
var Percent2 = document.getElementsByName("MultifamilyUsePercent");
var strUser = Percent2.options[Percent2.selectedIndex].value;
var Percent3 = document.getElementsByName("CommericalUsePercent");
var strUser = Percent3.options[Percent3.selectedIndex].value;
var Percent4 = document.getElementsByName("IndustrialUsePercent");
var strUser = Percent4.options[Percent4.selectedIndex].value;
document.getElementsByName("Undeveloped").value = Percent1
                        + Percent2
                        + Percent3
                        + Percent4;
}

</script>

</head>

<body>

<form method="post" action>

<table width="640">
  <tr>
    <td colspan="5"></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <th rowspan="3" colspan="3" valign="bottom" align="left">&nbsp;Present Use:</th>
  </tr>
  <tr>
    <td style="height: 21px">&nbsp;</td>
    <td style="height: 21px"></td>        
  </tr>
  <tr>
    <th colspan="3" align="left" style="height: 18px">&nbsp;</th>                
  </tr>
  <tr>
    <td style="height: 25px">&nbsp;</td>
    <td colspan="2" style="height: 25px">&nbsp;</td>
    <td style="height: 25px">Single Family</td>
    <td style="height: 25px"><select size="1" name="SingleFamilyUsePercent" 
     onchange="calcPercentUseSum" value="Single Family" tabindex="92">
        <option value=""></option>
        <option value="0%">0%</option>
        <option value="5%">5%</option>
        <option value="10%">10%</option>
        <option value="15%">15%</option>
        <option value="20%">20%</option>
        <option value="25%">25%</option>
        <option value="30%">30%</option>
        <option value="35%">35%</option>
        <option value="40%">40%</option>
        <option value="45%">45%</option>
        <option value="50%">50%</option>
        <option value="55%">55%</option>
        <option value="60%">60%</option>
        <option value="65%">65%</option>
        <option value="70%">70%</option>
        <option value="75%">75%</option>
        <option value="80%">80%</option>
        <option value="85%">85%</option>
        <option value="90%">90%</option>
        <option value="95%">95%</option>
        <option value="100%">100%</option>
      </select></td>                
  </tr>
  <tr>
    <td>&nbsp;&nbsp;&nbsp;</td>
    <td colspan="2">&nbsp;</td>
    <td>Multifamily</td>
    <td><select size="1" name="MultifamilyUsePercent" onchange="calcPercentUseSum"
 value="Multifamily" tabindex="93">
        <option value=""></option>
        <option value="0%">0%</option>
        <option value="5%">5%</option>
        <option value="10%">10%</option>
        <option value="15%">15%</option>
        <option value="20%">20%</option>
        <option value="25%">25%</option>
        <option value="30%">30%</option>
        <option value="35%">35%</option>
        <option value="40%">40%</option>
        <option value="45%">45%</option>
        <option value="50%">50%</option>
        <option value="55%">55%</option>
        <option value="60%">60%</option>
        <option value="65%">65%</option>
        <option value="70%">70%</option>
        <option value="75%">75%</option>
        <option value="80%">80%</option>
        <option value="85%">85%</option>
        <option value="90%">90%</option>
        <option value="95%">95%</option>
        <option value="100%">100%</option>
      </select></td>                
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td colspan="2">&nbsp;</td>
    <td>Commericial</td>
    <td><select size="1" name="CommericalUsePercent" onchange="calcPercentUseSum"  
 value="Commericial" tabindex="94">
        <option value=""></option>
        <option value="0%">0%</option>
        <option value="5%">5%</option>
        <option value="10%">10%</option>
        <option value="15%">15%</option>
        <option value="20%">20%</option>
        <option value="25%">25%</option>
        <option value="30%">30%</option>
        <option value="35%">35%</option>
        <option value="40%">40%</option>
        <option value="45%">45%</option>
        <option value="50%">50%</option>
        <option value="55%">55%</option>
        <option value="60%">60%</option>
        <option value="65%">65%</option>
        <option value="70%">70%</option>
        <option value="75%">75%</option>
        <option value="80%">80%</option>
        <option value="85%">85%</option>
        <option value="90%">90%</option>
        <option value="95%">95%</option>
        <option value="100%">100%</option>
      </select></td>        
  </tr>
  <tr>
    <td>&nbsp;&nbsp;</td>
    <td colspan="2">&nbsp;</td>
    <td>Industrial</td>
    <td><b>
    <select size="1" name="IndustrialUsePercent" onchange="calcPercentUseSum"
value="Industrial" tabindex="95" style="height: 21px">
        <option value=""></option>
        <option value="0%">0%</option>
        <option value="5%">5%</option>
        <option value="10%">10%</option>
        <option value="15%">15%</option>
        <option value="20%">20%</option>
        <option value="25%">25%</option>
        <option value="30%">30%</option>
        <option value="35%">35%</option>
        <option value="40%">40%</option>
        <option value="45%">45%</option>
        <option value="50%">50%</option>
        <option value="55%">55%</option>
        <option value="60%">60%</option>
        <option value="65%">65%</option>
        <option value="70%">70%</option>
        <option value="75%">75%</option>
        <option value="80%">80%</option>
        <option value="85%">85%</option>
        <option value="90%">90%</option>
        <option value="95%">95%</option>
        <option value="100%">100%</option>
      </select></b></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td colspan="2">&nbsp;</td>
    <td>Undeveloped</td>
    <td><input name="Undeveloped" readonly="readonly" type="text"  /></td>
  </tr>
</table><br />

<input type="submit" value="Save Form" name="tbSubmit" tabindex="253" />

</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T00:05:26.357

看看你的功能。您正在从每个`<select>`选项中获取正确的值，但随后您将结果存储在一个名为`strUser`您已 [重新] 声明 4 次的变量中。您正在覆盖该值，然后甚至不使用它。

您正在尝试求和（使用 +）实际的 HTML`<select>`元素，而不是您（尝试）提取的选定值。

将值分配给*单独*的变量，然后将它们转换为整数。我会删除`value`HTML 中属性的“%”符号，以便它们更易于使用。一旦你做到了，那么你基本上只需要做

```
var Percent1 = document.getElementsByName("SingleFamilyUsePercent")[0];
var Value1 = Percent1.options[Percent1.selectedIndex].value;
var Percent2 = document.getElementsByName("MultifamilyUsePercent")[0];
var Value2 = Percent2.options[Percent2.selectedIndex].value;
...
var Total = parseInt(Value1) + parseInt(Value2);
var Remainder = 100 - Total;

document.getElementsByName("Undeveloped")[0].value = Remainder; 
```

我把`[0]`s 放在那里是因为（我很确定）`getElementsByName`返回一个元素*列表*，而不是一个元素。真的，您应该更喜欢给您的输入`ID`属性，然后使用`getElementById`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T01:48:38.000

这是一个基于先前答案中提到的一些建议的工作示例：

[http://jsfiddle.net/wdqgF/](http://jsfiddle.net/wdqgF/)

**JavaScript**

```
calcPercentUseSum = function () {
    var Use1 = document.getElementById("SingleFamilyUsePercent"),
        Use2 = document.getElementById("MultifamilyUsePercent"),
        Use3 = document.getElementById("CommericalUsePercent"),
        Use4 = document.getElementById("IndustrialUsePercent");

    var Perc1 = Use1.options[Use1.selectedIndex].value,
        Perc2 = Use2.options[Use2.selectedIndex].value,
        Perc3 = Use3.options[Use3.selectedIndex].value,
        Perc4 = Use4.options[Use4.selectedIndex].value;

    function cleanVal(n) {
        // You do not want to call parseInt on an empty string "".
        // parseInt("") will return NaN, 
        // and NaN plus a number will return NaN. 
        // e.g., "NaN + 5 + 10 + 20" returns NaN. Avoid this.
        if (n === "") {
            return 0;
        } else {
            return parseInt(n, 10);
        }
    }

    var sumPerc = cleanVal(Perc1) + cleanVal(Perc2) + cleanVal(Perc3) + cleanVal(Perc4); 

    var Total = function () {
        if ( Perc1 === "" && Perc2 === "" && Perc3 === "" && Perc4 === "" ) {
            // To cover the scenario where the user selects item(s), 
            // but then reverts all items back to their first/empty option 
            return "";
        } else if ( sumPerc > 100 ) {
            // To cover the case where the Present Use Totals exceed 100%.
            return "0%";    
        } else {
            return (100 - sumPerc) + "%";
        }
    };

    document.getElementById("Undeveloped").value = Total();
}; 
```

注意在 each 中`<select>`，an`id`现在是如何出现的。

**来自更改的 HTML 的示例**

```
 <select size="1" name="SingleFamilyUsePercent" id="SingleFamilyUsePercent"
    onchange="calcPercentUseSum()" value="Single Family" tabindex="92">
        <option value=""></option>
        <option value="0">0%</option>
... 
```

# java - 我的 while 循环第二次显示两个打印时遇到问题

> ID：15168647
> 
> 赞同：0
> 
> 时间：2013-03-01T23:32:02.330
> 
> 标签：java, arrays, string, user-input, do-while

这就是我所拥有的：

```
import java.util.*;
import java.text.*;

public class Proj4 {
    public static void main(String[] args) {
        Scanner s = new Scanner(System.in);
        String again = "y";
        final int MAX_STUDENTS = 100;
        final int MIN_EXAM = 0;
        final int MAX_EXAM = 50;
        final int MIN_FINAL = 0;
        final int MAX_FINAL = 100;

        String[] names = new String[MAX_STUDENTS];
        int[] exams = new int[MAX_STUDENTS * 4];
        int student = 1;

        DecimalFormat df = new DecimalFormat("#0.0");

        do {
            System.out.print("Please enter the name of student " + student
                    + ": ");
            String line;
            line = s.nextLine().toUpperCase();
            names = line.split(" ");
            for (int i = 0; i < 4; i++) {
                if (i == 3) {
                    System.out.print("Please enter score for Final Exam: ");
                    exams[i] = s.nextInt();
                }

                else {
                    System.out.print("Please enter score for Exam " + (i + 1)
                            + ": ");
                    exams[i] = s.nextInt();
                    if (student == 1) {
                        if ((exams[0] < MIN_EXAM || exams[0] > MAX_EXAM)
                                || (exams[1] < MIN_EXAM || exams[1] > MAX_EXAM)
                                || (exams[2] < MIN_EXAM || exams[2] > MAX_EXAM)) {
                            System.out.println("Invalid enter 0-50 only...");
                            System.out.print("Please re-enter score: ");
                            exams[i] = s.nextInt();
                        } else if (exams[3] < MIN_FINAL || exams[3] > MAX_FINAL) {
                            System.out.println("Invalid enter 0-100 only...");
                            System.out.print("Please re-enter score: ");
                            exams[i] = s.nextInt();
                        }
                    } else if (student == 2) {
                        if ((exams[0] < MIN_EXAM || exams[0] > MAX_EXAM)
                                || (exams[1] < MIN_EXAM || exams[1] > MAX_EXAM)
                                || (exams[2] < MIN_EXAM || exams[2] > MAX_EXAM)) {
                            System.out.println("Invalid enter 0-50 only...");
                            System.out.print("Please re-enter score: ");
                            exams[i + 4] = s.nextInt();
                        } else if (exams[3] < MIN_FINAL || exams[3] > MAX_FINAL) {
                            System.out.println("Invalid enter 0-100 only...");
                            System.out.print("Please re-enter score: ");
                            exams[i + 4] = s.nextInt();
                        }
                    }
                }
            }
            System.out.print("do you wish to enter another? (y or n) ");
            again = s.next();
            if (again.equalsIgnoreCase("y"))
                student++;
        } while (again.equalsIgnoreCase("y"));

        System.out.println("***Class Results***");
        System.out
                .println(names[1]
                        + ","
                        + names[0]
                        + "   "
                        + "Exam Percentage: "
                        + ((float) (exams[0] + exams[1] + exams[2] + exams[3]) / (MAX_EXAM * 3 + MAX_FINAL))
                        * 100 + "%");
        if (student == 2)
            ;
        System.out
                .println(names[3]
                        + ","
                        + names[2]
                        + "   "
                        + "Exam Percentage: "
                        + ((float) (exams[4] + exams[5] + exams[6] + exams[7]) / (MAX_EXAM * 3 + MAX_FINAL))
                        * 100 + "%");
        if (student == 3)
            ;
        System.out
                .println(names[5]
                        + ","
                        + names[4]
                        + "   "
                        + "Exam Percentage: "
                        + ((float) (exams[8] + exams[9] + exams[10] + exams[11]) / (MAX_EXAM * 3 + MAX_FINAL))
                        * 100 + "%");
        if (student == 4)
            ;
        System.out
                .println(names[7]
                        + ","
                        + names[6]
                        + "   "
                        + "Exam Percentage: "
                        + ((float) (exams[12] + exams[13] + exams[14] + exams[15]) / (MAX_EXAM * 3 + MAX_FINAL))
                        * 100 + "%");
    }
} 
```

我的程序似乎完全按照我想要/需要的方式运行，唯一的问题是，当我允许程序再次运行时，它在同一行输出两个字符串，如下所示：

```
Please enter the name of student 2: Please enter score for Exam 1: 
```

我不知道该怎么做才能解决这个问题。我的代码中是否有一些东西只在第二次，可能是第三次和第四次出现混乱？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:35:39.093

去掉 if 后面的分号

```
if (student == 3)
            ; // <- remove it
    System.out.println(//... 
```

因为现在 Java 将其理解为

```
if (student == 3){}
System.out.println(//... 
```

* * *

改变

```
System.out.print("do you wish to enter another? (y or n) ");
again = s.next(); 
```

至

```
System.out.print("do you wish to enter another? (y or n) ");
again = s.nextLine(); 
```

`next`不会消耗新的行标记，所以当你使用`nextLine`之后`next`它只会消耗这个新的行标记并转到另一个指令。同样的规则适用`nextInt`。

* * *

要存储学生姓名数组，您可以使用二维字符串数组

```
String[][] names = new String[MAX_STUDENTS][]; 
```

并根据学号在每一行存储学生姓名

```
names[student] = line.split(" "); 
```

要获得第一个学生的名字，您必须使用此表格

```
names[0][0]; //you probably know that indexes in array starts from zero 
```

要获取所有学生的姓名，您可以遍历每一行，然后遍历列

```
for(int stId=0; stId<student; stId++){
   for(int nameNumber=0; nameNumber<names[stId].length; nameNumber++){
      // print names[stId][nameNumber]` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:39:54.773

如果您希望字符串在新行上打印，请使用 println 而不是 print，或者在字符串中包含换行符。

# php - 将自动回复编码到 phpmail

> ID：15168657
> 
> 赞同：-1
> 
> 时间：2013-03-01T23:32:28.890
> 
> 标签：php

我已经尝试了几个人的答案，没有一个有效。我有一个运行良好的 phpmail 功能，我只想为其添加一个自动回复功能，以便可以立即通知发件人已收到提交。

我的代码是这样的：

```
 <?php
        $mail_to_send_to = "contact@matejkadesign.com";
        $your_feedbackmail = "form@matejkadesign.com";

        $sendflag = $_REQUEST['sendflag'];
        if ( $sendflag == "send" )
        {
                $name = $_REQUEST['name'] ;
                $email = $_REQUEST['email'] ;
                $message = $_REQUEST['message'] ;
                $headers = "From: $your_feedbackmail" . "\r\n" . "Reply-To: $name <$email>" . "\r\n" ;
                $a = mail( $mail_to_send_to, "Contact request", $message, $headers );
                if ($a) 
                {
                    print("Message sent, thank you! You can send another");
                } else {
                    print("Message wasn't sent, please check that your email was filled in properly");
                }
        }
?> 
```

我想在自动回复中这样说：

```
Thank you for contacting us. This is an automatically generated reply confirming your submission. We will get back to you as soon as possible.

Sincerely,
John Doe 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:39:12.653

这不是你想要的，但我做了一个疯狂的猜测。当他/她使用此表单时，您想给用户发送电子邮件。使用此代码：

```
<?php

$mail_to_send_to = "contact@matejkadesign.com";
$your_feedbackmail = "form@matejkadesign.com";

$sendflag = $_REQUEST['sendflag'];

if ( $sendflag == "send" ) {
    $name = $_REQUEST['name'] ;
    $email = $_REQUEST['email'] ;
    $message = $_REQUEST['message'] ;
    $headers = "From: $your_feedbackmail" . "\r\n" . "Reply-To: $name <$email>" . "\r\n" ;
    $a = mail( $mail_to_send_to, "Contact request", $message, $headers );
    if ($a) 
    {
        print("Message sent, thank you! You can send another");
        $message_back = "Thank you for contacting us. This is an automatically generated reply confirming your submission. We will get back to you as soon as possible.";
        mail( $email, "Contact request", $message_back, $headers );
    } else {
        print("Message wasn't sent, please check that your email was filled in properly");
    }
}

?> 
```

# jquery - 旧图像交换脚本不适用于最新的 jQuery

> ID：15168661
> 
> 赞同：1
> 
> 时间：2013-03-01T23:32:38.600
> 
> 标签：jquery, image, toggle, swap

需要更新版本的帮助，这不适用于 jQuery 1.9

```
$(function(){
  $(".img-swap").live('click', function() {
    if ($(this).attr("class") == "img-swap") {
      this.src = this.src.replace("_off","_on");
    } else {
      this.src = this.src.replace("_on","_off");
    }
    $(this).toggleClass("on");
  });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:33:49.817

`Live`我相信是贬值了。改为使用`on`。页面顶部附近的 jQuery 文档中清楚地说明了这一点`live`。根据我的经验，如果从 Google 中提取，不要使用最新的 jquery，而是选择一个版本并坚持下去，这总是一个好主意。否则，当 jQuery 更新时，您的代码可能会在没有警告的情况下中断。经验之谈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:34:39.987

[http://api.jquery.com/live/](http://api.jquery.com/live/)

.live 方法已在 jQuery 版本 1.9 中删除。改用 .on() 将元素绑定到事件。您的代码如下所示：

```
$(function(){
  $(".img-swap").on('click', function() {
    if ($(this).attr("class") == "img-swap") {
      this.src = this.src.replace("_off","_on");
    } else {
      this.src = this.src.replace("_on","_off");
    }
    $(this).toggleClass("on");
  });
}); 
```

# ruby-on-rails-3 - emberjs rails 在没有模型的控制器中提交

> ID：15168673
> 
> 赞同：0
> 
> 时间：2013-03-01T23:33:53.980
> 
> 标签：ruby-on-rails-3, forms, session, controller, ember.js

我是 emberjs (1.0.0-RC1) 的新手，我在 Rails 上使用它。我想在不使用 ember 模型的情况下提交会话表单。我觉得这更好，因为我的 rails 应用程序中没有真正的会话模型。目前有效的方法如下：

```
#login_controller.js.coffee
SkillUp.LoginController = Ember.ObjectController.extend
  # Just a title to pass to the template, for fun
  title: "Login Controller"

  submit: (controller) ->
    model = @get 'model'
    model.get('transaction').commit()

#session.js.coffee
SkillUp.Session = DS.Model.extend
  email: DS.attr 'string'
  password: DS.attr 'string'

#login_route.js.coffee
SkillUp.LoginRoute = Ember.Route.extend
  setupController: (controller) ->
    controller.set 'title', "Login"

    controller.set 'content', SkillUp.Session.createRecord()

<!-- login.handlebars -->
<h2>template: {{title}}</h2>
<form>
  {{#with controller}}
    email: {{view Ember.TextField valueBinding="email"}}
    password: {{view Ember.TextField valueBinding="password" type="password"}}
    <button {{action submit}}>Submit</button>
  {{/with}}
</form> 
```

正如我所说，我的目标是删除 session.js.coffee，因为它不存在 rails 模型。

帮助将不胜感激谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T07:00:51.263

我不建议`$.ajax`直接实施。我建议保留 DS 模型。如果您使用`DS.FixtureAdapter`. 理想情况下，您应该将所有 ajax 保留在应用程序的一个层后面。您不应该`$.ajax`插入应用程序的各个部分。

编辑：仅仅因为您在后端没有 Session 模型并不意味着您不能在前端拥有一个。ember 应用程序将拥有自己的模型。不用担心 1:1 映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T02:38:17.687

您可以在控制器方法中使用 $.ajax 手动使用 jQuery 将值发布到 rails。

```
$.ajax('/sessions', {
    type: 'POST',
    data: {
        email: this.get('email'),
        password: this.get('password)
    },
    ...
}); 
```

为成功和失败添加适当的处理程序。

# spring - GORMless Grails 应用程序无法查找丢失的（和不必要的）事务管理器

> ID：15168675
> 
> 赞同：0
> 
> 时间：2013-03-01T23:34:04.733
> 
> 标签：spring, grails

我的 Grails 2.1 应用程序在启动时崩溃，当它尝试建立一个名为`ServiceParamService`. 我对它没有找到事务管理器并不感到惊讶，但我不明白它为什么要寻找一个。

在调试器中四处寻找，看起来它决定了`ServiceParamService`a `"TypeSpecifyableTransactionProxyFactoryBean"`，它本质上接受参数`target`,`proxyTargetClass`和。`transactionAttributeSource``transactionManager`

奇怪的是，该服务在另一个 Grails 应用程序中实例化得很好，该应用程序也没有定义事务管理器，并且具有相同`Config.groovy`的`BuildConfig.groovy`, 和`resources.xml`. 所以不知何故，运气不好，另一个应用程序解决了这个问题。没有扔掉新应用程序（并通过删除 90% 的旧应用程序重新开始），我如何才能弄清楚旧应用程序正在做什么来绕过这个虚假的事务管理器要求？和/或自己解决？

```
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'serviceParamService': Cannot resolve reference to bean 'transactionManager' while setting bean property 'transactionManager'; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'transactionManager' is defined
at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328)
at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:106)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1360)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1118)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
at org.codehaus.groovy.grails.commons.spring.ReloadAwareAutowireCapableBeanFactory.doCreateBean(ReloadAwareAutowireCapableBeanFactory.java:130)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322)
... 38 more
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'transactionManager' is defined
at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanDefinition(DefaultListableBeanFactory.java:553)
at org.springframework.beans.factory.support.AbstractBeanFactory.getMergedLocalBeanDefinition(AbstractBeanFactory.java:1095)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:277)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:269)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322)
... 49 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T02:47:41.723

服务默认是事务性的。添加

```
static transactional = false 
```

到您的服务类，以防止它被包装在事务代理中。

# sql - 选择总和达到某个值的排名记录

> ID：15168678
> 
> 赞同：1
> 
> 时间：2013-03-01T23:34:33.427
> 
> 标签：sql, sql-server, sql-server-2008, tsql

```
+----+--------+----------+-----------+
| ID | Number | Reason   | Timestamp |
+----+--------+-----------+----------+
|  1 | 2      | Business | date      |
|  2 | 3      | Pleasure | date      |
+----+--------+-----------+----------+ 
```

我有一张看起来像上面的桌子。我试图弄清楚如何获取其 Number 列加起来达到某个值的最新记录（按时间戳排序的表）。

所以在上面的例子中，如果我的值为 5，我会想要这 2 条记录（假设它们是最新的）。我想得到一个输出字符串，如下所示：

```
2 (Business), 3 (Pleasure) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T00:26:42.740

如果您正在查找加起来不超过 X 的最新记录，那么您需要一个累积总和。在 SQL Server 2008 中，这是使用相关子查询来处理的：

```
select t.*
from (select t.*,
             (select sum(number) from t t2 where t2.id <= t.id) as CumeSumValue
      from t
     ) t
where CumeSumValue <= X 
```

我认为`>=`需要更多的逻辑。

```
select t.*
from (select t.*,
             (select sum(number)
              from t t2
              where t2.id <= t.id
             ) as CumeSumValue
      from t
     ) t
where CumeSumValue <= X or   -- less than or equal
      ((CumeSumValue - Number < X) and (CumeSumValue > X))  -- first that is greater than
      CumeSumValue >= X 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:38:40.153

您是否尝试过使用**光标**？

这看起来像是使用游标的主要示例。

[http://msdn.microsoft.com/de-de/library/ms180169.aspx](http://msdn.microsoft.com/de-de/library/ms180169.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T20:05:13.913

首先你应该得到最新的记录

```
Select Max(ID) MAXID Into #t From t Group By Timestamp 
```

现在在 #t 所有最新记录可用。您可以加入表格以访问所有字段：

```
Select t.* from t Join #t on t.ID = #t.MAXID 
```

如果要过滤某些内容，可以使用简单的 where 子句来完成。

# php - 我一直收到购物车是空的......？

> ID：15168681
> 
> 赞同：0
> 
> 时间：2013-03-01T23:34:39.760
> 
> 标签：php, forms, paypal

我哪里错了？公司电子邮件是正确的我尝试使用商家 ID 但仍然没有乐趣.....??

```
<?php $items = unserialize($_SESSION['items']); ?>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post"> 
<input type="hidden" name="cmd" value="_cart">
<input type="hidden" name="upload" value="1">
<input type="hidden" name="no_note" value="1">  
<input type="hidden" name="business" value="cherished4ever@hotmail.co.uk">
<input type="hidden" name="currency_code" value="GBP">
<input type="hidden" name="return" value="http://www.cherished4ever.com/">   

<?php
$suffix = 1;
foreach($items as $item):
?>
<input type="hidden" name="item_name_<?php echo $suffix; ?>" value="<?php echo $item['name']; ?>"> 
<input type="hidden" name="amount_<?php echo $suffix; ?>" value="<?php echo      $item['price']; ?>"> 
<?php
$suffix++;
endforeach;
?> 
```

* * *

好的，所以我现在已经开始工作了，但是我只需要在结帐页面上显示选项名称而不是设置为隐藏输出的 item_name 值的帮助：

```
<select name="amount" style="width:150px;font:9px;margin-top:4px">
<option value="35.00">10 x 10</option>
<option value="55.00">20 x 20</option>
<option value="75.00">30 x 30</option>
</select><br> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:42:37.977

请务必记住您`session_start();`在使用该`$_SESSION`变量的每个页面的顶部。

有关更多信息，请查看：[http ://www.php.net/session_start](http://www.php.net/session_start)

# wordpress - 将表单数据发送到另一个网站表单

> ID：15168684
> 
> 赞同：0
> 
> 时间：2013-03-01T23:34:58.840
> 
> 标签：wordpress, forms

我正在尝试在我的 wordpress 安装中合并一个预订小部件，除了发送数据或它没有填充到其他网站表单上之外，我一切正常。我试图发送数据的网站是一个在线预订软件：[http ://www.directinn.com/demo/](http://www.directinn.com/demo/)

这是我做表格的方式：

```
<form name="bookingform" action="http://www.directinn.com/demo" method="get" target="_blank">       

  <input type="text" name="date1" id="Text1" class="ftxt MyDate three columns" maxlength="10" value="" placeholder="Arrival Date"/>

  <input type="text" name="date2" id="Text2" class="ftxt MyDate three columns" maxlength="10"  value="" placeholder="Departure Date" />

  <input type="submit" name="bookingformsubmit" class="book-now" value="Book Now">

  <input type="hidden" name="arrivalDay" value="" />
  <input type="hidden" name="arrivalMonth" value="" />
  <input type="hidden" name="arrivalYear" value="" />
  <input type="hidden" name="departureDay" value="" />
  <input type="hidden" name="departureMonth" value="" />
  <input type="hidden" name="departureYear" value="" />
  <input type="hidden" name="numAdults" value="1" /> 
```

任何帮助将不胜感激 ;）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:39:50.860

您拥有的代码将向接收站点提交大量查询字符串数据。

目标站点可能会实施某种类型的跨站点发布预防措施，这会导致阻塞 - 或者他们可能会完全忽略您的查询字符串参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T15:50:13.273

所以他们说如果您可以在您的页面上的表单中添加 iFrame，并且如果您将 USERNAME 例如添加到 URL，您的 USERNAME 将出现在发票上。像这样我相信：

```
http://www.directinn.com/iframefull.html/BOB 
```

I do not think you can make your own form and POST to their page. I see no indication that that is possible from the link you posted of the example.

# android - 如何使 320x480 ImageView 填满整个模拟器屏幕（大小为 320x480 mdpi）？

> ID：15168687
> 
> 赞同：1
> 
> 时间：2013-03-01T23:35:21.510
> 
> 标签：android, android-layout, android-imageview, android-drawable

我正在使用设置为 320x480 MDPI 的模拟器屏幕。我在烟花中创建了一个精确大小为 320x480 像素的背景图像，将其放在可绘制的 MDPI 文件夹中，并将其设置为一个`ImageView`，希望它能填充模拟器的整个背景。*问题*是背景仅垂直填充，但似乎在左右水平上均等地留下空白空间。

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:38:04.720

```
<ImageView android:layout_width="fill_parent"
           android:layout_height ="fill_parent" 
           android:scaleType="fillXY" /> 
```

请注意，这将导致它在 X 方向上缩放以填充空间，这会稍微扭曲图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:43:44.827

为什么你不只是在你的根视图上设置背景？

无论哪种方式，在 Android 中填充后台都是一件麻烦事。我建议阅读这个问题：[Handling different screen resolutions for background images in Android](https://stackoverflow.com/questions/3634929/handling-different-screen-resolutions-for-background-images-in-android)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:41:19.687

请不要使用 a `ImageView`，只需`android:background`在您的 xml 中设置根布局的属性。看这个例子：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/your_image_here" >
    .....
    </RelativeLayout> 
```

我希望这可以帮助你。最好的祝福

# ruby-on-rails - AngularJS 和 Rails 休息设置

> ID：15168698
> 
> 赞同：2
> 
> 时间：2013-03-01T23:36:09.783
> 
> 标签：ruby-on-rails, rest, angularjs

AngularJS 的新手。我很难让 RESTful 的东西在 angular 和 rails 之间工作。我设置了一个简单的休息服务并得到很好的帖子。绑定工作等。但是当我 $update back .. 发送到服务器的是整个 post 对象。我需要能够将其过滤到某些属性。此外，发布的内容并未包含在其中，`params[:post]`这是典型的 rails 方法。

见下文：

```
# angular
app.factory "Post", ["$resource", ($resource) ->
  $resource "/posts_api/:id", {id: "@id"}, {update: {method: "PUT"}}
]

app.controller  "PageEditCtrl",  ($scope, Post) ->
  $scope.post = Post.get(
    id: 32723
  , ->
    $scope.post.title = $scope.post.title + "!"

    $scope.post.$update({id: $scope.post.id})
  )
......

# in rails Post.rb class
attr_accessible  :title, :body, :user_id

# in rails posts_api_controller.rb
class PostsApiController < ApplicationController
  respond_to :json
  before_filter :authenticate_user!

  # **** HERE'S THE PROBLEM:::: 2 issues with updating
  # 1) angular is passing *entire post object* with attributes that are *not in attr_accesible* 
  # 2) angular is not passing the post in the typical rails fashion params[:post] ..instead just as params

  def update
    respond_with current_user.posts.update(params[:id], params) # would like to have params[:post] instead here
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T19:08:45.297

对于问题 #2，这是我设置 AngularJS 应用程序的方式：

```
railsResources =
  index:
    method: "GET"
    isArray: true
  show:
    method: "GET"
  new:
    params:
      verb: "new"
    method: "GET"
  create:
    method: "POST"
  edit:
    params: 
      verb: "edit"
    method: "GET"
  update:
    method: "PUT"
  destroy:
    params:
      command: "remove"
    method: "DELETE"

app.factory "Post", ["$resource", ($resource) ->
  $resource "/posts_api/:id/:verb", {id: "@id"}, railsResources
] 
```

这应该允许您按预期与 Rails 进行通信。

我想我记得在 Angular 文档中看到您的示例，并认为这是一个人为的示例。我认为你应该分开你的功能。当您使用资源生成的对象时，您不需要传入 id：

```
$scope.post = Post.get(id: 32723)
$scope.addBang = ->
  $scope.post.title = $scope.post.title + "!"
  $scope.post.$update() 
```

对于问题 #1，考虑 Rails 表单。如果您想避免传入受限参数，只需将它们排除在表单之外即可。但是，如果您想使用 Angular 的内置模型/资源接口，这说起来容易做起来难。

所以我建议创建一个 Rails 模型方法，它接受完整的 params[:post] 哈希并返回只有可访问方法的哈希。

通过这样做，您可以保持 DRY 并避免在模型更改时调整 JS。

编辑：或者，更好的是，正如我刚刚学到的，在将哈希传递给 AngularJS 之前，使用 Rails 模型生成哈希。

像这样：

```
post = Post.find(123)
post = { name: post.title, content: post.content } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-27T22:56:39.113

或者有已经实现了 RESTful 架构并使用 Promise的优秀[rails-resource-angular gem 。](https://github.com/FineLinePrototyping/angularjs-rails-resource)此外，post 请求将被正确包装，因此您可以使用 params[:post]。

```
angular.module('book.services', ['rails']);
angular.module('book.services').factory('Book', 
['railsResourceFactory', function (railsResourceFactory) {
    return railsResourceFactory({
        url: '/books',
        name: 'book'
    });
}]);

Book.query({ title: title }).then(function (results) {
        $scope.books = results;
        $scope.searching = false;
    }, function (error) {
        // do something about the error
        $scope.searching = false;
    });
Book.get(1234).then(function (book) {

new Book({title: "Awesomeness", author: 123}).create()
.then(function(book){
    $scope.book = book // Rails generated an ID for us, and everything else we put in our model
}) 
```

关于 attr_accessible 的东西，即使你没有使用 rails 4 ，你也可能想看看[这篇文章。](https://stackoverflow.com/questions/17371334/how-is-attr-accessible-used-in-rails-4)

因为，如果您想在发送 post 请求之前进行过滤，您将不得不编写一个 javascript 版本的 params.require().permit()。或者也许我没有很好地理解这个问题......？

# html - 为什么背景渐变不缩放？

> ID：15168699
> 
> 赞同：0
> 
> 时间：2013-03-01T23:36:20.600
> 
> 标签：html, css, gradient

我的背景中的 CSS 渐变无法缩放，我该怎么办？我打算按百分比来做一个 HTML 布局，但是 body 渐变太短了。

示例：http: [//jsfiddle.net/snGVt/](http://jsfiddle.net/snGVt/)

```
<div class="wrapper">
    <div class="box round"><img src="http://goo.gl/wv4zi" /></div>
    <div class="box round"><img src="http://goo.gl/wv4zi" /></div>
</div> 
```

```
html{
    height: 100%;
    width:100%;
}

body {
    width:100%;
    background: #0e89b6; /* Old browsers */
    background: -moz-linear-gradient(top,  #0e89b6 0%, #00142c 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#0e89b6), color-stop(100%,#00142c)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  #0e89b6 0%,#00142c 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  #0e89b6 0%,#00142c 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #0e89b6 0%,#00142c 100%); /* IE10+ */
    background: linear-gradient(to bottom,  #0e89b6 0%,#00142c 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#0e89b6', endColorstr='#00142c',GradientType=0 ); /* IE6-9 */
}

.wrapper {

    width: 60%;
    margin-left: auto;
    margin-right: auto;
}

.box{
    width: 100%;
    margin-top: 10px;
    padding: 25px;
    background-color: #fff;
}

.box > img{
    width: 100%;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:38:34.743

尝试将 html 宽度和高度样式更改为 "min-height: 100%" 和 min-width: 100%"

```
html{
   min-height: 100%;
   min-width:100%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:39:47.783

使用`background-size`.

CSS3 渐变可以认为是生成固定大小图像的函数，因此仍然需要使用 size 属性进行控制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:41:50.980

在 IE9 中，渐变边缘有一些边距。你应该设置你的`body`和`html`没有边距。那是你遇到的问题吗？

```
html,body {
    margin: 0;
} 
```

请注意，在其他浏览器中这对我来说不是问题。

# c++ - 强制特定类型的函数模板/函数重载

> ID：15168704
> 
> 赞同：1
> 
> 时间：2013-03-01T23:36:43.253
> 
> 标签：c++, templates, overloading

我有一个功能

`foo(int, int, int, int/long long/_int64/double/long double/char *, int ONLY IF previous char * - otherwise unneeded)`

问题是，由于需要字符串副本，char * 实现与值类型不同。是的，这是旧代码的接口，所以我不能使用 std::string ：/

目前，我将它作为模板，以及 char * 的函数重载，并带有额外的参数。但是，其他类型的所有操作在 char * 上也是有效的，所以如果调用者忘记了最后一个参数，函数会默默地匹配模板，从而产生错误的逻辑。

有什么方法可以强制在函数模板中使用重载/使用默认参数/允许特定类型使用不同签名（额外参数）而不默默匹配较小签名的东西？

更多：还不能访问 C++11，但我愿意看到使用它来帮助推动采用的建议。没有提升，但和上面一样

我也试过

`return_type foo(int,int,int,typename std::enable_if<!std::is_pointer<T>::value, T>::type & value2update)`

没有任何运气。然后它声称带有双 & 参数的调用无法匹配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:52:28.133

你可以让链接器帮助你。`char*`在标题中声明但不定义您的函数模板和重载：

```
template<typename T>
foo(int, int, int, T);
foo(int, int, int, char*, int); 
```

在实现文件 (.cpp/.cc) 中，实现两个：

```
template<typename T>
foo(int, int, int, T) { ... }

foo(int, int, int, char*, int) { ... } 
```

并显式实例化您想要接受的类型的版本：

```
template<>
foo(int, int, int, int);
template<>
foo(int, int, int, long long);
// etc. 
```

* * *

如果我理解正确，ScottLamb 在评论中提出了类似的建议。标题：

```
foo(int, int, int, int);
foo(int, int, int, long long);
...
foo(int, int, int, char*, int); 
```

实施文件（.cpp/.cc）：

```
namespace {
    template<typename T>
    foo_tmpl(int, int, int, T) { ... }
}

foo(int, int, int, int) { foo_tmpl(...); }
foo(int, int, int, long long) { foo_tmpl(...); }
....
foo(int, int, int, char*, int) { ... } 
```

从使用标头的人的角度来看，这是更可取的（他们可以立即看到哪些重载可用），但在实现方面需要做更多的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:43:53.667

使用`string_ref`为您捆绑这两个参数的辅助类：

```
class string_ref {
  const char *str;
  std::size_t len;
public:
  string_ref(std::string const& s)
    : str(s.c_str()), len(s.size()) {}

  string_ref(const char *c, std::size_t len)
    : str(c), len(len) {}

  const char * c_str() const { return str; }
  std::size_t size() const { return len; }
}; 
```

进而

```
foo(int, int, int, int/long long/_int64/double/long double/const char*, [int]) 
```

只需添加

```
foo(int, int, int, string_ref)
{
   foo(int, int, int, c_str(), size());
} 
```

A`string_ref`可以从 a 创建`const char*`并且`int`没有开销，并且两者都可以轻松提取以进一步传递给 C 函数。

（命名`string_ref`不是[随机](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3442.html)的。）

# string - 如何延迟 PowerShell 字符串中变量的扩展？

> ID：15168705
> 
> 赞同：10
> 
> 时间：2013-03-01T23:36:45.170
> 
> 标签：string, powershell, interpolation, variable-expansion

无论您想怎么称呼它，我都在尝试找出一种方法来获取现有字符串的内容并将它们评估为双引号字符串。例如，如果我创建以下字符串：

```
$string = 'The $animal says "meow"'
$animal = 'cat' 
```

然后，`Write-Host $string`会产生`The $animal says "meow"`. 如何重新评估 $string 以输出（或分配给新变量）`The cat says "meow"`？

* * *

多么烦人……注释的限制使得包含反引号的代码变得非常困难（如果可能的话）。这是我在下面回复 zdan 时所做的最后两条评论的未修改版本：

## ----------

实际上，经过考虑，我意识到在`The $animal says "meow"`不转义双引号的情况下期望进行插值是不合理的，因为如果它是一个以双引号开头的字符串，那么如果不转义双引号，评估就会中断。所以我想答案是，这是一个两步过程：

```
$newstring = $string -replace '"', '`"'
iex "`"$string`"" 
```

给后人的最后一条评论：我尝试了将所有这些都放在一条线上的方法，几乎​​所有你认为可行的东西一旦你将它提供给 iex 就会中断，但这个可行：

```
iex ('"' + ($string -replace '"', '`"') + '"') 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-02T15:30:37.017

可能最简单的方法是

```
$ExecutionContext.InvokeCommand.ExpandString($var) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-01T23:48:06.620

您可以使用`Invoke-Expression`重新解析字符串 - 如下所示：

```
$string = 'The $animal says `"meow`"'
$animal = 'cat'
Invoke-Expression "Write-Host `"$string`"" 
```

请注意如何在字符串中转义双引号（使用反引号）以避免混淆解析器。这包括原始字符串中的任何双引号。

另请注意，第一个命令应该是一个命令，如果您需要使用生成的字符串，只需使用 write-output 管道输出并将其分配给您以后可以使用的变量：

```
$result = Invoke-Expression "write-output `"$string`"" 
```

如您的评论中所述，如果您无法修改字符串的创建以转义双引号，则必须自己执行此操作。您还可以将其包装在一个函数中以使其看起来更清晰：

```
function Invoke-String($str) { 
    $escapedString =  $str -replace '"', '`"'
    Invoke-Expression "Write-Output `"$escapedString`""
} 
```

所以现在它看起来像这样：

```
# ~> $string = 'The $animal says "meow"'
# ~> $animal = 'cat'
# ~> Invoke-String $string
The cat says "meow" 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-03-09T00:15:00.070

您可以使用[`-f`运算符](https://ss64.com/ps/syntax-f-operator.html)。据我所知，这与调用相同[`[String]::Format`](https://msdn.microsoft.com/en-us/library/b1csw23d%28v=vs.110%29.aspx)。

```
PS C:\> $string = 'The {0} says "meow"'
PS C:\> $animal = 'cat'
PS C:\> Write-Host ($string -f $animal)
The cat says "meow" 
```

这避免了与引号剥离（由 `ExpandString`and面临`Invoke-Expression`）和任意代码执行（由 面临`Invoke-Expression`）相关的陷阱。

我已经测试过它在版本 2 及更高版本中受支持；我不完全确定它是否存在于 PowerShell 1 中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-02-20T22:25:39.900

*编辑：事实证明，字符串插值行为因 PowerShell 版本而异。[我在 GitHub 上](https://github.com/alx9r/a9Foundations)用单元测试编写了更好的`xs`( `Expand-String`) cmdlet 版本来处理这种行为。*

* * *

这个解决方案的灵感来自[这个关于在保留上下文的同时缩短对对象方法的调用的答案](https://stackoverflow.com/a/28628460/1404637)。您可以将以下函数放在某个实用程序模块中，当您从另一个模块调用它时它仍然有效：

```
function xs
{
    [CmdletBinding()]
    param
    (

        # The string containing variables that will be expanded.
        [parameter(ValueFromPipeline=$true,
                   Position=0,
                   Mandatory=$true)]
        [string]
        $String
    )
    process
    {
        $escapedString = $String -replace '"','`"'
        $code = "`$ExecutionContext.InvokeCommand.ExpandString(`"$escapedString`")"
        [scriptblock]::create($code)
    }
} 
```

然后当你需要做延迟变量扩展时，你可以这样使用它：

```
$MyString = 'The $animal says $sound.'
...
$animal = 'fox'
...
$sound = 'simper'

&($MyString | xs)
&(xs $MyString)

PS> The fox says simper.
PS> The fox says simper. 
```

`$animal`直到最后`$sound`两行才展开。这允许您设置一个`$MyString`预先和延迟扩展，直到变量具有您想要的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-06T11:56:48.350

```
Invoke-Expression "`"$string`"" 
```

# java - Java 8 闭包和类型识别

> ID：15168711
> 
> 赞同：6
> 
> 时间：2013-03-01T23:37:39.130
> 
> 标签：java, closures

我正在测试 Java 8 的新闭包特性；我想知道为什么这段代码

```
public class Test8 {
    private class A { int a;}
    private class B { int b;}    
    interface IFA { void ifa(A param); }
    interface IFB { void ifb(B param); }
    private void forceA(A expr) {  }    
    private void z(IFA fun) { System.out.println( "A"); fun.ifa( new A() ); }
    private void z(IFB fun) { System.out.println( "B"); fun.ifb( new B() ); }    

    public void run() {
        z( x -> forceA(x) );
    }
    public static void main(String args[]) {   new Test8().run(); }
} 
```

给出错误： `both method z(IFA) in Test8 and method z(IFB) in Test8 match error`在运行方法中的 z 调用

编译器是否无法检测到`forceA`调用强制 x 为 A 类型，因此正确使用的 z 是`z(IFA fun)`？

（类似的函数在 C# 中使用委托是合法的；有没有办法在 Java 8 中获得相同的结果？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T01:16:16.073

Java 8 仍在进行中。最新的规范确实允许您的代码工作。编译器实现应该很快就会赶上。

然而，这种重载并不是一种好的风格。我们有签名

```
 z( A->void )
    z( B->void ) 
```

然后当 javac 看到

```
 z( arg->{ block } ) 
```

不清楚哪个`z()`适用。必须做额外的工作（通过编译块）来选择一个。

我们并不真正关心 javac 的难度。真正的问题是，当人们看到该代码时，人们必须深入挖掘以了解`z()`所引用的代码。不太可读。

作为经验法则，避免重载具有相同数量的功能接口的方法。不同的arities都很好，消除歧义没有问题，对于人类或javac

```
 z( arg->{...} )

    z( (arg1,arg2)->{...} ) 
```

设计者（Dan Smith 等）也祝福了另一种形式的重载 - 相同的数量，相同的参数类型，但不同的返回类型

```
 z( X->R1 )
    z( X->R2 ) 
```

但我认为这也很混乱，我会避免它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T01:06:22.217

lambda 的主体不用于确定其类型。喜欢方法。我想方法参考可能有效。但是euw，超载。

# jquery - 如何在 IE8 中获取文件类型输入的文件名

> ID：15168713
> 
> 赞同：2
> 
> 时间：2013-03-01T23:37:43.097
> 
> 标签：jquery, ajax, file, internet-explorer-8, upload

所以背景是我需要创建一个文件上传控件，以非常特定的方式提交文件。大多数用户都在 IE8 上，所以我使用隐藏的 iframe 和表单帖子，但是当用户使用文件输入选择文件时，我的功能就会启动。我不知道如何在 IE8 中仅检索文件名，因为不支持文件 api。在下面的示例中，警报将输出完整地址，但这对我没有用。有任何想法吗？

```
<form>
     <input name="data" id="filesInput" onchange="handleFileSelect(this);" type="file" value=""/>
</form>

function loadFile(evt){
     alert(evt.value);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:46:31.960

evt.value 不包含完整的文件名，但有一个假路径，比如

```
C:\fakepath\video.mp4 
```

那么，您可以使用：

```
var n = evt.target.value.substring(evt.target.value.lastIndexOf('\\') + 1); 
```

现在 n 将只包含文件名。

# c# - 为什么找不到替换 .DLL？

> ID：15168715
> 
> 赞同：0
> 
> 时间：2013-03-01T23:37:54.900
> 
> 标签：c#, dll, deployment, windows-ce, typeloadexception

我对我的项目使用的辅助 DLL 进行了更改，当然构建了它，将旧版 DLL 重命名为 *.dll_old，并将新版本的 DLL 复制并粘贴到同一文件夹中。

但是，当我随后运行使用 DLL 的应用程序时，它出错了：

```
"An expected error has occurred...bla bla bla...or select Details for more information. 
```

我确实选择了详细信息，并看到：

```
TypeLoadException
File or assembly name <name of the DLL, which I just replaced>
Version=<bla>
Culture=neutral
PublicKeyToken=null, or one of its dependencies, was not found. 
```

## 更新

根据评论，我想替换 DLL 比人们预期的要多。我不知道这是否重要，我认为替换 DLL 就像替换 EXE，但可能不是：DLL 项目的 AssemblyInfo.cs 说，

```
[assembly: AssemblyVersion("1.3.*")]                // used by .NET framework only
[assembly: AssemblyFileVersion("1.3.0.308")]        // File Version - increment here
[assembly: AssemblyInformationalVersion("6.3.0")]   // Product version - set to current IEQ system 
```

...并且错误消息中的版本是“1.3.3889.27539”

我是否需要将这些行之一（如果是的话，我猜是中间行）更新为该值（1.3.3889.27539）？或者...？？？

## 更新

因此，由于 .DLL 没有强命名，我尝试简单地删除使用 DLL 的项目中的引用（对旧 .DLL），然后再次将其添加回来（相同的文件名，不同的版本）。不过，我看到更新 .DLL 不会更改上面显示的版本号 - IOW，AssemblyInfo.cs 在构建时不会更新。应该是？我需要手动更新这些 vals 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T00:15:07.170

您的 EXE 文件似乎引用了原始 DLL 中的类型。当您将其替换为您自己的版本时，引用被弄乱了。EXE 文件包含元数据表，其中包含它引用的类型、方法、属性等列表以及预期的汇编的确切版本。即使一切都一样，但版本号根本就不是一回事，也提供其他东西。这就是为什么你得到例外。

更新：是的，这是可能的。但是，它涉及创建清单文件。[有关更多信息，请查看有关Redirecting Assembly Versions](http://msdn.microsoft.com/en-us/library/7wd6ex19%28v=vs.110%29.aspx)的 MSDN 网站。另外，请记住，只能重定向强签名的程序集。未签名的程序集将被忽略。

# c - 使用 Makefile 重新定义问题

> ID：15168717
> 
> 赞同：0
> 
> 时间：2013-03-01T23:37:55.523
> 
> 标签：c, linux, makefile, definition, multiple-definition-error

**主.c：**

```
#include <stdio.h>
#include "proto.h"

int main(void)
{

    return(0);
} // end main 
```

**支持.c：**

```
#include "proto.h"

\\ only function defintions 
```

**原型.h：**

```
#ifndef proto
#define proto
double PI = 3.14159;
int LOOP_LIMIT = 90;

#endif 
```

**生成文件：**

```
main: main.o  support.o 
    gcc -lm -o main main.o support.o
main.o: main.c proto.h
    gcc -c main.c
support.o: support.c proto.h
    gcc -c support.c 
```

每当我使用上面定义的文件运行 makefile 时，我总是会遇到多重定义错误，尽管有条件编译。

我不确定这里发生了什么以及如何解决这个问题。

错误信息是：

```
multiple definition of `PI'
multiple definition of `LOOP_LIMIT' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:43:20.863

您不能在从多个编译单元包含的标头中定义变量。`PI`并以 in和 in`LOOP_LIMIT`结尾，因此您会收到链接器错误。正确的方法是在标题中声明它们：`main.o``support.o``extern`

**原型.h**

```
#ifndef proto
#define proto
extern double PI;
extern int LOOP_LIMIT;

#endif 
```

然后在一个且只有一个 .c 文件中定义它们：

**支持.c**

```
#include "proto.h"

double PI = 3.14159;
int LOOP_LIMIT = 90;

\\ only function defintions 
```

顺便说一句，看起来这些家伙可能是常量而不是变量，所以要么将它们声明并定义为`const`，要么将它们写为预处理器定义：

```
#define PI 3.14159
#define LOOP_LIMIT 90 
```

有了这些，您还可以避免链接问题。

# editor - Gvim 在系统 verilog 关键字对上折叠

> ID：15168728
> 
> 赞同：4
> 
> 时间：2013-03-01T23:38:28.027
> 
> 标签：editor, system-verilog, vim

如何在 Gvim 中启用折叠系统 verilog 关键字？例如

```
function
   Code
   ....
   ....
endfunction 
```

我希望 Gvim 创建一个从函数到最终函数的折叠。我怎么做 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T11:58:43.067

这是一个自定义折叠表达式，应该可以满足您的需求。它在每个“函数”之后的行开始折叠，并在每个“结束函数”之前的行结束，否则继承前一行的折叠级别。

```
function! VimFunctionFoldExpr()
    if getline(v:lnum-1) =~ '^\s*function'
        return '>1'
    elseif getline(v:lnum+1) =~ '^\s*endfunction'
        return '<1'
    else
        return '='
    endif
endfunction 
```

要告诉 Vim 使用这个函数，设置如下：

```
set foldmethod=expr
set foldexpr=VimFunctionFoldExpr() 
```

您可能还想调整您的 foldtext 设置，使其尊重意图级别。[这](https://stackoverflow.com/questions/5992336/indenting-fold-text)是一个关于如何做到这一点的 SE 问题。

# jquery - jQuery搜索添加锚点

> ID：15168733
> 
> 赞同：1
> 
> 时间：2013-03-01T23:39:01.950
> 
> 标签：jquery, search

我需要有关我的 jQuery 搜索脚本的帮助。我希望将锚点添加到我的搜索中。如果输入内容，它会显示在：*site.com/#search=keyword*

```
$('input#media-search').on('click', function() {
    var media = $('input#media').val();
    if ($.trim(media) != '') {
        $.post('search.php', {media: media}, function(data) {
            $('div#media-list').html(data);
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:46:58.147

添加这个。

```
location.hash = "#search=" + value; 
```

假设数据是您所在位置所需的数据。如果它的媒体，分那个。

```
$('input#media-search').on('click', function() {
   var media = $('input#media').val();
      if ($.trim(media) != '') {
        $.post('search.php', {media: media}, function(data) {
            $('div#media-list').html(data);
            location.hash = "#search=" + data;
      });
   }
}); 
```

# css - 如何在 IE 8 或更高版本中显示 div 及其内容？

> ID：15168736
> 
> 赞同：0
> 
> 时间：2013-03-01T23:39:14.227
> 
> 标签：css, internet-explorer-8

我想向后渲染一个 div，然后向前渲染其中的表格单元格。我在这里准备了一个演示：http: [//jsfiddle.net/djsvL/3/](http://jsfiddle.net/djsvL/3/)，它可以在我的浏览器（chrome）中使用。

但是，它在 IE 8 中不起作用。从我目前所见，我可以翻转 div 或单元格中的文本或图像，但我似乎无法翻转整个布局（例如，注意如何表格单元格被颠倒了）。

使用 IE8 可以实现这样的技巧`filter:fliph`吗？如果是这样，我做错了什么或者我该怎么做？

**编辑：**这是我在 IE8 中看到的截图：http: [//tinypic.com/r/2e4yw3p/6](http://tinypic.com/r/2e4yw3p/6)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-22T18:12:29.827

答案是设置背景颜色。

IE 不能很好地处理透明度，它使用黑色而不是透明，并且盒子在技术上具有透明背景。

# typescript - jquery.unobtrusive-ajax.d.ts / jquery.validate.unobtrusive.d.ts 有人吗？

> ID：15168738
> 
> 赞同：4
> 
> 时间：2013-03-01T23:39:24.883
> 
> 标签：typescript, web-essentials

我正在尝试将我的 app.js 转换为 app.ts，唯一缺少的是 jquery.unobtrusive-ajax.js 和/或 jquery.validate.unobtrusive.js 的 .d 文件。

当我使用 tsc 构建和编译时，它工作正常，但 VS2012 中的 WebEssentials 抱怨：

```
var $form = $('#myform');
$.validator.unobtrusive.parse($form); 
```

错误：

```
The property 'unobtrusive' does not exist on value of type 'Validator' 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T10:04:04.567

如果您没有类型信息，并且编译器无法推断类型，那么就会出现问题。

尽管您从命令行获取输出，但我仍然希望它会给出错误。Web Essentials 的执行力更强，这是该工具背后的理念。

如果您无法获取类型信息（检查 GitHub 上的“绝对类型”），您可以使用简化的定义来修复错误...

```
interface JQueryStatic {
    validator: any;
} 
```

如果你有一个验证器的定义，你可以使用这个技巧来声明不引人注目，这样只会丢失类型信息而不是所有验证器。

这将丢失在验证器上的输入，但会修复错误。

取自[http://www.stevefenton.co.uk/Content/Blog/Date/201301/Blog/Complex-TypeScript-Definitions-Made-Easy/](http://www.stevefenton.co.uk/Content/Blog/Date/201301/Blog/Complex-TypeScript-Definitions-Made-Easy/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-04T09:55:21.967

只是为了说明我认为 Steve 已经说过的话，如果您[从 DeveloplyTyped 下载 d.ts](https://github.com/borisyankov/DefinitelyTyped/blob/master/jquery.validation/jquery.validation.d.ts)，然后打开文件，您将看到`Validator`界面（以及其他定义）。扩展它很简单：

```
interface Validator {
    format(template: string, ...arguments: string[]): string;
    form(): bool;
    element(element: any): bool;
    resetForm(): void;
    showErrors(errors: any): void;
    numberOfInvalids(): number;
    setDefaults(defaults: ValidationOptions): void;
    addMethod(name: string, method: (value: any, element: any, ...params: any[]) => any, message?: any): void;
    addClassRules(rules: any): void;
    addClassRules(name: string, rules: any): void;

    // Just add the unobtrusive element to this (typed as `any` if you don't have time to do anything more)
    unobtrusive:any; 
} 
```

`JQuery`扩展和接口的其余工作`JQueryStatic`已经在文件的其他地方为您完成。你不会在`unobtrusive`元素上得到任何类型的好处，但至少所有其余的`Validator`代码都会被类型检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-03T06:33:11.940

我通过转换为任何解决了这个问题：

```
(<any>$.validator).unobtrusive.parse($form); 
```

我确实喜欢打字稿，但由于缺少定义文件而阻碍了它的使用。我想这是一件小事 - tsc 工作正常 - 但如果 Visual Studio 会抱怨这样简单的事情，那么这对很多人来说都是个问题。

# c# - 通过 NuGet 包更改 Global.asax？

> ID：15168739
> 
> 赞同：7
> 
> 时间：2013-03-01T23:39:26.057
> 
> 标签：c#, asp.net, visual-studio-2012, nuget, nuget-package

我正在创建一个 NuGet 包，想知道是否有办法修改目标网站的 Global.asax？我想在 Application_Start 中添加一行（如果不存在则创建 Global.asax）。这可能吗？更新将如何工作？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-01T23:42:27.520

推荐的方法是不要修改宿主应用程序的 Global.asax 文件。相反，您可以使用[`WebActivator`](https://github.com/davidebbo/WebActivator)并将单独的文件添加到项目中。以`Ninject.MVC3`NuGet 为例，它就是这样做的。

例如，当您安装 NuGet 时，您可以简单地将以下文件添加到项目中`~/App_Start/MyNuGetAppStart.cs`：

```
[assembly: WebActivator.PreApplicationStartMethod(typeof(SomeNamespace.AppStart), "Start")]

namespace SomeNamespace
{

    public static class AppStart
    {
        /// <summary>
        /// Will run when the application is starting (same as Application_Start)
        /// </summary>
        public static void Start() 
        {
            ... put your initialization code here
        }
    }
} 
```

这是在应用程序启动时添加自定义代码的一种更不显眼的方式，而不是弄乱用户可能已经调整过的 Global.asax 文件。

# c++ - 如何更改DLL中的过程名称

> ID：15168752
> 
> 赞同：1
> 
> 时间：2013-03-01T23:40:28.747
> 
> 标签：c++, dll, c++builder, cdecl

当我用我的程序在 C++ Builder 中编译 DLL 时

```
 extern "C" __declspec(dllexport) __cdecl void show_m(void)
{
 MessageBox(NULL, "MSG", "COTI DLL", MB_OK |MB_ICONINFORMATION);
} 
```

我可以在depends.exe 中看到我的程序名称是_show_m。如何删除下划线？（在 dll 中重命名过程）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:58:39.307

我想我找到了解决方案。在 C++ Builder (Code Gear 2009) 中，我将 FALSE 设置为：

Options->C++ Compiller->Output->Generate underscore on sympol names->FALSE

我想我们可以结束话题了。

# c++ - 这个三元表达式的 if else 语句是什么等价的？

> ID：15168754
> 
> 赞同：-3
> 
> 时间：2013-03-01T23:40:51.920
> 
> 标签：c++, if-statement, conditional-statements, ternary

```
bool wm(const char *s, const char *t)
{
    return *t-'*' ? *s ? (*t=='?') | (toupper(*s)==toupper(*t)) && wm(s+1,t+1) : !*t : wm(s,t+1) || *s && wm(s+1,t);
} 
```

我已经在互联网上搜索三元/if else 等价物，但这似乎很奇怪，因为它一开始就有回报。

来自 cplusplus 网站：（条件）？(if_true) : (if_false)

```
if(a > b){
    largest = a;
} else if(b > a){
    largest = b;
} else /* a == b */{
    std::cout << "Uh oh, they're the same!\n";
} 
```

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:43:43.297

它实际上是*两个*三元语句。

```
if (*t-'*' ) {
  if (*s) {
    return (*t=='?') | (toupper(*s)==toupper(*t)) && wm(s+1,t+1);
  } else {
    return !*t;
  }
} else {
  return wm(s,t+1) || *s && wm(s+1,t);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:44:14.847

开头的 return 只是返回整个语句的结果。

在你的情况下，你可以这样写：

```
bool wm(const char *s, const char *t)
{
    if(*t-'*')
    {
        if (*s)
           return (*t=='?') | (toupper(*s)==toupper(*t)) && wm(s+1,t+1);
        else
           return !*t;
    }
    else
        return wm(s,t+1) || *s && wm(s+1,t);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:44:43.670

`return`不是三元表达式的一部分。你可以这样想：

```
return (
  *t-'*' ? *s ? (*t=='?') | (toupper(*s)==toupper(*t)) && wm(s+1,t+1) : !*t : wm(s,t+1) || *s && wm(s+1,t)
); 
```

要将其复制为`if`语句，您需要将`return`语句放置在单独的分支中：

```
if (*t-'*') {
  if (*s) {
    return (*t=='?') | (toupper(*s)==toupper(*t)) && wm(s+1,t+1);
  } else {
    return !*t;
  }
} else {
  return wm(s,t+1) || *s && wm(s+1,t);
} 
```

# php - Facebook getUser() 总是返回 0 [PHP SDK 3.1.1]

> ID：15168764
> 
> 赞同：2
> 
> 时间：2013-03-01T23:41:59.903
> 
> 标签：php, facebook-php-sdk

fb.php：

```
ini_set('display_errors','On');
error_reporting(E_ALL);
require_once 'facebook/src/facebook.php';

$facebook = new Facebook( array (
    'appId'  => '****',
    'secret' => '****',
    'cookie' => true
  )
);

$user = $facebook->getUser();

if ($user) {
    var_dump($user);
  $logoutUrl = $facebook->getLogoutUrl();

  print '<a href="'.$logoutUrl.'">Logout</a>';
} 
else {
    $loginUrl = $facebook->getLoginUrl();
  print '<a href="'.$loginUrl.'">Login</a>';
} 
```

这是我的简单代码；单击链接并接受权限框后，我将被重定向到脚本，并获取以下参数：`http://mydomain.com/fb.php?state=82e166c6a85fd3b44ad655851f885b73&code=AQCMo6L5z-K5juFl3cojl80KllKQ8JE2iKMaOFSmHhHgAFd_V-BfD8YZwbiKQasNuHSbcc4St-9B2gggwEMygn223u8BVK9zXKctEui-y20rcmydx-uf65sw5v6o4XN3k9Lnvtg0jg7h1C9XGC3S1sW32X65CI6kjbe7GXHICpMsT833wDxG1voS7enq9uYm1MGrp83ceTmKvoKGyn_iYby0#_=_`

在这些问题之后，我突然发现这个链接[， getUser 变成了返回 0.(PHP 3.1.1 SDK)](http://facebook.stackoverflow.com/questions/8587098/suddenly-getuser-became-to-return-0-php-3-1-1-sdk)，但对我不起作用。

我正在使用 PHP Facebook SDK 版本 3.1.1。

¿ 有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T09:20:55.143

请重新检查您的设置，包括`appId`，`secret`并确保`Sandbox Mode`在您的应用仪表板上**禁用。**

更改网站的域后，我遇到了同样的问题。尽管我正确更改了 request_uri 参数并使用新域更新了我的应用程序设置，但错误仍然出现。然后我意识到我的Facebook APP的ID和SECRET ID已经自动更改了，没有任何警告！整个过程使用新 ID 重新开始工作。

一些专家表示，由于沙盒模式，他们也面临与您相同的问题。在 Facebook Developers Apps 页面中，确保`Sandbox Mode`已**禁用**。

另一件事是权限范围，您可以设置如下：

```
$pram = array(
           'scope' => 'user_birthday,read_stream',
           'redirect_uri' => 'http://domain.com/some_where_else/'
        )
$loginUrl = $this->facebook->getLoginUrl($pram); 
```

也许它会帮助你。谢谢。

# python - 如何获取从用户输入中输入的变量的值？

> ID：15168765
> 
> 赞同：9
> 
> 时间：2013-03-01T23:42:00.153
> 
> 标签：python, python-3.x

我正在尝试创建一个基本菜单，用于检查输入的变量是否与定义的变量匹配。如果定义了变量，则获取已定义变量的数据。

例子。

```
Item1 = "bill"
Item2 = "cows"
item3 = "abcdef"
Choose_Item = input("Select your item: ") 
```

*   我输入`Item1`
*   `Choose_Item`应该等于`"bill"`

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-01T23:47:13.347

这似乎是您正在寻找的：

```
Choose_Item = eval(input("Select your item:  ")) 
```

不过，这可能不是最好的策略，因为拼写错误或恶意用户很容易使您的代码崩溃、系统过载或做任何其他他们喜欢的讨厌的事情。对于这种特殊情况，更好的方法可能是

```
items = {'item1': 'bill', 'item2': 'cows', 'item3': 'abcdef'}
choice = input("Select your item: ")
if choice in items:
    the_choice = items[choice]
else:
    print("Uh oh, I don't know about that item") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T23:47:23.377

有两种方法可以解决这个问题。坏方法：

```
print(eval(Choose_Item)) 
```

更好的方法是使用字典

```
items = {'1':'bill','2':'cows'}
Choose_Item = input("Select your Item: ")
try:
    print(items[Choose_Item])
except KeyError:
    print('Item %s not found' % Choose_Item) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-01T23:48:06.653

`locals()[Choose_Item]`如果要选择名称是用户生成的变量，则需要使用。

不过，更传统的方法是使用字典：

```
items = {
    'Item1': 'bill',
    'Item2': 'cows',
    'Item3': 'abcdef',
} 
```

... and then the value you want is `items[Choose_Item]`.

# javascript - 如果我的 div 是 `display: none` 打印不工作。如何改变它？

> ID：15168766
> 
> 赞同：1
> 
> 时间：2013-03-01T23:42:04.440
> 
> 标签：javascript, jquery

我的 div 是`display: none`并且打印不起作用。我怎样才能改变这个？

插件：[https ://github.com/erikzaadi/jQueryPlugins/tree/master/jQuery.printElement](https://github.com/erikzaadi/jQueryPlugins/tree/master/jQuery.printElement)

**html:**

```
<a href="#" value="$('#toPrint').printElement()" id="simplePrint">Print</a>

<div id="toPrint">adgsdhashdshas</div> 
```

**CSS：**

```
#toPrint { display: none; } 
```

**jQuery：**

```
$(document).ready(function() {
    $("#simplePrint").click(function(){
        $('#toPrint').printElement();
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:45:21.340

使用打印样式并将 div 设置为 display:block 。

```
@media print
{ #toPrint { display: block; } } 
```

# visual-studio-2012 - VS 2012 Data Tier App 项目更新数据库最佳实践

> ID：15168769
> 
> 赞同：0
> 
> 时间：2013-03-01T23:42:18.497
> 
> 标签：visual-studio-2012, sql-server-2012, data-tier-applications

在 VS2012 中，我创建了一个数据库项目，一个导入的数据层应用程序 .dacpac 我从我的 SQL Server 2012 实例创建。

我的问题是，如果我正在开发，我想做的只是修改 VS 2012 中的 sql 表结构，比如我向表中添加一个新列，这是将该更改转移到数据库以构建项目的唯一方法.dacpac 然后升级数据库，在我的例子中是通过 SQL Server Management Studio。如果我正在开发开发人员数据库，非生产，我只想要一个更新脚本，我看不到如何在数据层应用程序的 db 项目中获取它。

我只是在这两个地方手动进行更改，但最终我会被打断并忘记相应地进行更改。

你怎么做呢？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-30T00:29:50.620

也许我没有在这里关注您，但您是否尝试过通过发布数据库项目进行更新？如果您右键单击数据库项目，您应该会看到“发布数据库”对话框。从那里设置目标数据库连接，然后单击发布按钮。这应该将您的更改（在本例中为您添加的列）应用到您的目标数据库。

您也可以从命令行运行它。看起来像这样

```
c:\MyCode\bin\Debug>"c:\Program Files (x86)\Microsoft SQL Server\110\DAC\bin"\sqlpackage.exe /Action:Publish /Sourcefile:MyCode.dacpac /Profile:local.publish.xml 
```

publish.xml 文件可能看起来像这样

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <IncludeCompositeObjects>True</IncludeCompositeObjects>
    <TargetDatabaseName>TargetDatabaseName</TargetDatabaseName>
    <DeployScriptFileName>TheDeployScriptName.sql</DeployScriptFileName>
    <TargetConnectionString>Data Source=localhost\SQLEXPRESS;Integrated Security=True;Pooling=False</TargetConnectionString>
    <ProfileVersionNumber>1</ProfileVersionNumber>
  </PropertyGroup>
</Project> 
```

# c - 指向 C 中的字符串的指针？

> ID：15168771
> 
> 赞同：14
> 
> 时间：2013-03-01T23:42:21.073
> 
> 标签：c, string, pointers

```
char *ptrChar; 
```

我知道这`ptrChar`是指向**char**的指针。**指向字符串**的指针的命令是什么？

**编辑：**如果它是相同的（ptr 到 char 与 ptr 到字符串）——下面的变量定义代表什么？

```
char (*ptr)[N]; 
```

我很困惑。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-01T23:45:23.823

相同的符号用于指向单个字符或空终止字符串的第一个字符：

```
char c = 'Z';
char a[] = "Hello world";

char *ptr1 = &c;
char *ptr2 = a;      // Points to the 'H' of "Hello world"
char *ptr3 = &a[0];  // Also points to the 'H' of "Hello world"
char *ptr4 = &a[6];  // Points to the 'w' of "world"
char *ptr5 = a + 6;  // Also points to the 'w' of "world" 
```

`ptr2`和中的值`ptr3`是相同的；和中的值也是`ptr4`如此`ptr5`。如果您要将某些数据视为字符串，请务必确保它以 null 结尾，并且您知道有多少空间可供您使用。许多问题是由于不了解可用空间以及不知道字符串是否正确以空值终止而引起的。

请注意，上面的所有指针都可以像数组一样被取消引用：

```
 *ptr1    == 'Z'
  ptr1[0] == 'Z'

 *ptr2    == 'H'
  ptr2[0] == 'H'
  ptr2[4] == 'o'

 *ptr4    == 'w'
  ptr4[0] == 'w'
  ptr4[4] == 'd'

  ptr5[0] ==   ptr3[6]
*(ptr5+0) == *(ptr3+6) 
```

* * *

### 迟到的问题

> 代表什么`char (*ptr)[N];`？

这是一个更复杂的野兽。它是一个指向字符数组的指针`N`。类型完全不同；它的使用方式完全不同；指向的对象的大小是完全不同的。

```
char (*ptr)[12] = &a;

(*ptr)[0] == 'H'
(*ptr)[6] == 'w'

*(*ptr + 6) == 'w' 
```

请注意，它`ptr + 1`指向未定义的区域，但指向`a`. 给定一个稍微不同的场景：

```
char b[3][12] = { "Hello world", "Farewell", "Au revoir" };

char (*pb)[12] = &b[0]; 
```

现在：

```
(*(pb+0))[0] == 'H'
(*(pb+1))[0] == 'F'
(*(pb+2))[5] == 'v' 
```

您可能不会遇到指向数组的指针，除非在相当长的一段时间内发生意外。在过去的 25 年中，我使用过几次，但数量很少，以至于我可以用一只手的手指数数（其中有几个一直在 Stack Overflow 上回答问题）。除了知道它们的存在、它们是获取数组地址的结果以及您可能不想要它之外，您实际上并不需要了解更多关于数组指针的信息。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-01T23:44:25.687

一样的。AC字符串只不过是一个字符数组，所以指向字符串的指针就是指向字符数组的指针。指向数组的指针与指向其第一个元素的指针完全相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T23:51:22.797

字符串基本上是从它指向的地方（`char *ptrChar;`）到空字符（`\0`）。实际上指向字符串的开头（char 数组），因此它是指向该字符串的指针，因此，例如，当您喜欢时

，您实际上在 char 开头后 x 次访问内存位置（也就是从哪里ptrChar 指向）。`char *ptrChar;``ptrChar[x]`

# css - CSS 可按下按钮移动所有列表元素

> ID：15168775
> 
> 赞同：1
> 
> 时间：2013-03-01T23:43:06.910
> 
> 标签：css, button, margin

所以我想创建使用 box-shadow 和 margin 的伪 3d css3 按钮，所以点击看起来像是被按下了。

```
.button {
   margin: 0 0 5px 0;
   box-shadow: 0 5px 0 #000;
}

.button:active {
   margin: 5px 0 0 0;
   box-shadow: none;
} 
```

除非我尝试在列表中使用此代码，否则它工作得非常好，例如：

```
<ul>
   <li><a href="#" class="button>Link</a></li>
   <li><a href="#" class="button>Link</a></li>
   <li><a href="#" class="button>Link</a></li>
</ul> 
```

因为在这种情况下，当我将鼠标悬停在一个列表链接上时，它会移动所有列表链接。有没有办法修复它？我宁愿坚持边距，因为相对于顶部底部的位置会影响页面上的其他元素。

这是一个小提琴：http: [//jsfiddle.net/6tpR8/](http://jsfiddle.net/6tpR8/)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-01T23:45:37.640

添加`vertical-align:top`到您的 .button 类。

[http://jsfiddle.net/6tpR8/1/](http://jsfiddle.net/6tpR8/1/)

对于添加的效果添加`transition: all .25s`使其动画（不完全支持，但在不受支持的浏览器中不会受到伤害）。

[http://jsfiddle.net/6tpR8/3/](http://jsfiddle.net/6tpR8/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:46:23.643

你可以浮动它们：

```
ul li {
    float: left;
    display: inline-block;
    margin-right: 5px;
} 
```

[http://jsfiddle.net/6tpR8/2/](http://jsfiddle.net/6tpR8/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:50:19.783

只需添加一个显示器。

显示：内联块；

如果仍然不能解决它，你需要给它一个宽度。所以它实际上知道它应该有多大。

对于 IE，您可能需要添加：border:none;

注意：几乎所有浏览器中的 box-shadow 都不相同

# html - Tumblr HTML：如何在悬停/翻转时显示照片标题？

> ID：15168778
> 
> 赞同：-1
> 
> 时间：2013-03-01T23:43:40.090
> 
> 标签：html, hover, tumblr, rollover, caption

对此全新。如果这是非常基本的，请提前道歉...

我使用的照片网格主题在您单击之前不会显示标题。

但是，如果用户翻滚或悬停在照片上，我很乐意显示标题。

这是网站：

[http://haiku-movie-review.tumblr.com/](http://haiku-movie-review.tumblr.com/)

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:49:04.603

最简单的方法是添加`title="What you want to display"`到图像中。通过滚动屏幕中间的图片，您可以在[http://xkcd.com](http://xkcd.com)上看到它的效果。

# ruby-on-rails - Rails 复杂查询建议下一个对象

> ID：15168784
> 
> 赞同：0
> 
> 时间：2013-03-01T23:44:06.700
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, named-scope, rails-models

我的模型有一个复杂的范围，为用户提供满足其参数的活跃交易。

```
scope :deal_query, lambda { |m, p| where("meal = ? and active = ? and people LIKE '%?%' and inactive_days NOT LIKE '%?%'", m, true, p, Time.zone.now.wday)} 
```

people 列被序列化并存储一个数字数组（使用 LIKE sql 语句搜索序列化列是一种技巧）。然后我将这个数据数组传递给地图！块，它将所有数据呈现在哈希中。

这是该块的精简版。（旁注，我使用 Rails 作为 API，这会返回 json）

```
Deal.deal_query(params[:meal].to_i, people).map! {|ld| {                                                                                            
:deal_id => ld.id, :title => ld.title, :description => ld.description}} 
```

在块中，我还尝试通过将人员列增加 1 来发送下一个可用交易的名称。我不想在块中运行单独的查询来检查下一个可用交易，这将非常低效，因为它缩放。

有关如何急切加载下一个可用交易的任何建议都会有所帮助。我考虑过创建另一个范围，只需将 people 列增加 1，但后来我不知道如何将它与第一个范围的数据匹配。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T01:23:15.807

为什么不将您的 LIKE 更改为：

```
where("... (people LIKE '%?%' OR people LIKE '%?%') ...", <etc>, p, p+1, <etc>) 
```

换句话说，一口气抓住两者，然后对结果做你需要做的事情。我不太清楚您的`map!`通话目标是什么以及“下一个可用交易的名称”是什么意思，但是您应该能够在那时从对象中提取您需要的任何数据拥有完整的 AR 模型。

如果您想在可扩展性方面获得更多帮助，则需要查看 DB 模式。仅从您所展示的内容来看，这感觉非常hacktastic - 可能有一种更优雅和高性能的方式来处理人员列......

# asp.net-mvc-4 - 调用保存更改时未在保存包中发送微风外键导航属性

> ID：15168792
> 
> 赞同：4
> 
> 时间：2013-03-01T23:45:14.330
> 
> 标签：asp.net-mvc-4, asp.net-web-api, breeze

我在尝试通过微风保存新子对象时遇到问题，我的模型归结为

Parent Foo 有零个或多个 bar 类型的子对象，即 Parent 有一个 ICollection 类型的属性，称为 bar，而 Bar 对象有一个 Foo 类型的属性 - 它的 parent

我可以通过 Breeze 获取、更新和插入“父”Foo 对象的新实例——这是使用 Web api 控制器，但是在创建 Bar 的新实例、设置其父 Foo（已经在缓存中）时出现约束冲突，并且调用保存更改

我有类似的代码

```
var newBar = entityManager.createEntity("Bar");
newBar.Foo = existingFoo;
entityManager.saveChanges(); 
```

我也尝试将孩子添加到父母集合中，例如existingFoo.bars.push(newBar);

并显式调用
entityManager.addEntity(newBar);

在调用保存更改之前，但错误是相同的

检查传递给控制器​​的 JObject saveBundle 我可以看到新的子栏对象，但我没有看到对父对象的任何引用

这是我认为支持的简单的一对多关系？- 我可以看到看起来正确的元数据中的关系

异常消息如下所示

“FooBarContext.Bars”中的实体参与“Foo_Bars”关系。找到 0 个相关的“Foo_Bar_Source”。

我究竟做错了什么？

## 更新 1：控制器生成的元数据：

"{\"schema\":{\"namespace\":\"BreezePlayground.Models\",\"alias\":\"Self\",\"d4p1:UseStrongSpatialTypes\":\"false\",\ "xmlns:d4p1\":\" [http://schemas.microsoft.com/ado/2009/02/edm/annotation](http://schemas.microsoft.com/ado/2009/02/edm/annotation) \",\"xmlns\":\" [http://schemas.microsoft.com/ado /2009/11/edm](http://schemas.microsoft.com/ado/2009/11/edm)\",\"cSpaceOSpaceMapping\":\"[[\\"BreezePlayground.Models.Foo\\",\\"BreezePlayground.Models.Foo\\"],[\\"BreezePlayground.Models.Bar\\" ,\\"BreezePlayground.Models.Bar\\"]]\",\"entityType\":[{\"name\":\"Foo\",\"key\":{\"propertyRef\": {\"name\":\"Id\"}},\"property\":[{\"name\":\"Id\",\"type\":\"Edm.Int32\",\ "nullable\":\"false\",\"d4p1:StoreGeneratedPattern\":\"Identity\"},{\"name\":\"Name\",\"type\":\"Edm.String \",\"fixedLength\":\"false\",\"maxLength\":\"Max\",\"unicode\":\"true\",\"nullable\":\"true\" }],\"navigationProperty\":{\"name\":\"Children\",\"relationship\":\"Self.Bar_Parent\",\"fromRole\":\"Bar_Parent_Target\",\"toRole\" :\"Bar_Parent_Source\"}},{\"name\":\"Bar\",\"key\":{\"propertyRef\":{\"name\":\"Id\"}}, \"property\":[{\"name\":\"Id\",\"type\":\"Edm.Int32\",\"nullable\":\"false\",\"d4p1: StoreGeneratedPattern\":\"Identity\"},{\"name\":\"Description\",\"type\":\"Edm.String\",\"fixedLength\":\"false\", \"maxLength\":\"Max\",\"unicode\":\"true\",\"nullable\":\"true\"}],\"navigationProperty\":{\"name\":\"Parent\",\"relationship\":\"Self.Bar_Parent\",\"fromRole\":\"Bar_Parent_Source\",\"toRole\":\ "Bar_Parent_Target\"}}],\"association\":{\"name\":\"Bar_Parent\",\"end\":[{\"role\":\"Bar_Parent_Source\",\"type \":\"Edm.Self.Bar\",\"multiplicity\":\"*\"},{\"role\":\"Bar_Parent_Target\",\"type\":\"Edm.Self .Foo\",\"multiplicity\":\"0..1\"}]},\"entityContainer\":{\"name\":\"FooBarContext\",\"entitySet\":[{ \"name\":\"Foos\",\"entityType\":\"Self.Foo\"},{\"name\":\"Bars\",\"entityType\":\"Self.Bar\"}],\"associationSet\":{\"name\":\"Bar_Parent\",\"association\":\"Self.Bar_Parent\",\"end \":[{\"role\":\"Bar_Parent_Source\",\"entitySet\":\"Bars\"},{\"role\":\"Bar_Parent_Target\",\"entitySet\":\ "Foos\"}]}}}}"

示例代码：

```
 var managerInsert = new breeze.EntityManager("/api/FooBar");
    managerInsert.fetchMetadata().then(function () {
        managerInsert.fetchEntityByKey('Foo', 1, false)
        .then(function (data) {
            var child = managerInsert.createEntity('Bar');
            child.Parent(data.entity);
            child.Description("bar desc");
            managerInsert.saveChanges().then(function () {
                return true;
            })
                .fail(function () {
                    alert('save failed');
                });
        })
        .fail(function (data) {
            alert('fail');
        });
    }); 
```

生成的请求有效载荷：

{"entities":[{"Id":-1,"Description":"bar desc","entityAspect":{"entityTypeName":"Bar:#BreezePlayground.Models","entityState":"Added"," originalValuesMap":{},"autoGeneratedKey":{"propertyName":"Id","autoGeneratedKeyType":"Identity"}}}],"saveOptions":{"allowConcurrentSaves":false}}

插入了子对象但未设置外键

我假设这与 ef 映射和生成的元数据有关？

## 更新 2：需要外键属性？

我将我的代码与新的 Breeze SPA 模板 ToDo 应用程序代码进行了比较，该代码显然有效，我在生成的元数据中发现的主要区别是 ToDo 应用程序模型公开了父对象外键。

我将它添加到我的简单 Foo Bar 模型中，并且能够保存子对象来工作 - 我的理解是 ef 使得在模型中公开外键是可选的，但似乎这是 Breeze 的要求生成正确的元数据？- 我在某处的文档中错过了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T01:14:29.897

接得好！我们确实需要更好地记录这一点，并且由于这篇文章正在更新关于这个主题的文档。

正如您所发现的，微风假定您使用的是“外键关联”而不是“独立关联”（用 EF 的说法）。

这个要求可以被绕过，但会导致大量功能损失，其原因是客户端上存在外键允许微风自动修复可能单独查询的实体之间的关系。

有关更多背景信息，请参阅以下 MSDN 文章：[foreign-keys-in-the-entity-framework](http://blogs.msdn.com/b/efdesign/archive/2009/03/16/foreign-keys-in-the-entity-framework.aspx)

# emacs24 - Emacs Prelude - 启用 Python 缩进

> ID：15168798
> 
> 赞同：0
> 
> 时间：2013-03-01T23:45:30.417
> 
> 标签：emacs24, emacs-prelude

在 ubuntu 上安装了 emacs24 并通过 curl 进行了 preude。我想启用python支持，所以我在个人目录中创建了sayth.el并添加了（需要'prelude-python）

重新启动后，虽然我仍然没有任何 python 支持，也没有缩进支持。

我应该做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T03:31:49.173

> 我在个人目录中创建了sayth.el并添加了（需要'prelude-python）

我强烈怀疑 Emacs 会知道`sayth.el`. 反而，

1.  打开 emacs 并执行`C-h v user-emacs-directory`. 这可能是`~/.emacs.d`，但检查是明智的。
2.  `prelude-modules.el`在 emacs 用户目录中检查。如果该文件不存在，则存在另一个问题。如果它在那里，
3.  `prelude-modules.el`在 emacs 中打开并取消注释包含`(require 'prelude-python)`. （如果它已经没有注释，那就是另一个问题。）
4.  保存文件，退出 emacs，然后重新启动它。

> 通过 curl 在 ubuntu 和 [prelude] 上安装了 emacs24

只是检查一下：您是否使用[Batsov 的指示](https://github.com/bbatsov/prelude#readme)安装了 Prelude ？

# php - php - 如果条件每次都失败

> ID：15168799
> 
> 赞同：2
> 
> 时间：2013-03-01T23:45:31.380
> 
> 标签：php, if-statement

我有一个简单的 php 函数。但是，无论如何，它每次都会失败。

```
function for determining tomato pic

echo "$info[2]";
function tomato()
{
    if(intval($info[2]) > 60)
        return "fresh";
    else if(intval($info[2]) < 60)
        return "rotten";
} 
```

它在页面上回显 95，但随后返回“烂”。知道这是怎么回事吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T23:51:57.857

函数不会从父作用域继承变量。有几种方法可以解决这个问题：

1：将它们作为参数传递

```
function tomato($info) {...}
tomato($info); 
```

2：如果是匿名函数，使用`use`子句

```
$tomato = function() use ($info) {...} 
```

3：（不推荐）使用`global`关键字“导入”变量

```
function tomato() {
    global $info;
    ...
} 
```

4：（非常糟糕的主意，但为了完整性而添加）使用`$GLOBALS`数组

```
function tomato() {
    // do stuff with $GLOBALS['info'][2];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:47:25.280

你必须让函数知道变量，试试

```
function tomato() {
    global $info;
    ... 
```

或者，将值作为参数传递给函数：

```
function tomato($tomatocondition) {
    if(intval($tomatocondition) > 60)
        return "fresh";
    else if(intval($tomatocondition) < 60)
        return "rotten"; 
```

并称之为...

```
echo tomato($info[2]); 
```

# regex - 方括号内字符的正则表达式

> ID：15168800
> 
> 赞同：2
> 
> 时间：2013-03-01T23:45:32.290
> 
> 标签：regex, powershell, visual-studio-2012

我正在努力在 PowerShell 中创建正则表达式。这是从 VS2012 开始的构建后事件以转换 sql，以便我的表名和列名中没有任何空格。一旦这个工作，我可以修改一个脚本，我已经用正则表达式字符串替换文件的内容。我一直在使用[本教程](http://www.computerperformance.co.uk/powershell/powershell_regex.htm#PowerShell_Regex_Replace_Text "本教程")，但是当空格位于左方括号和右方括号之间时，我似乎无法用下划线替换空格 (\s)。

这是我想如何转换 sql 的示例：

转变：

```
select * from [Existing product] where [Existing product].[Desc value] = 26 
```

到：

```
select * from [Existing_product] where [Existing_product].[Desc_value] = 26 
```

当我在 powershell ISE 中运行此脚本时：

```
#Example of PowerShell Regex Replace
$newline = '
'
$strText = 'select * from [Existing product] where [Existing product].[Desc value] = 26'
$Pattern = '(?<=\[)(\s(?<=\s))(?=\])'
$New = "_"
$newline
'SourceText: '
$strText
$newline
$strReplace = [regex]::replace($strText, $pattern, "$New")
"We will now replace $Pattern with $New :" 
$newline
$strReplace 
```

我得到这个结果：

```
PS C:\> C:\REGEX.ps1

SourceText: 
select * from [Existing product] where [Existing product].[Description value] = 26

We will now replace (?<=\[)(\s(?<=\s))(?=\]) with _ :

select * from [Existing product] where [Existing product].[Description value] = 26 
```

我希望在上面看到用下划线替换空格的字符串。

我的正则表达式目前是`(?<=\[)(\s(?<=\s))(?=\])`，但显然它只选择方括号旁边的空格。我从上面的正则表达式中遗漏了什么？

如果您有任何问题，请告诉我，感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T23:48:26.020

是的，除非您添加填充，否则它只会选择完全匹配。

也许`(?<=\[.*?)(\s(?<=\s))(?=.*?\])`已经为您解决了问题。但总的来说，您的正则表达式似乎 A) 过于复杂，并且 B) 正则表达式不是该工作恕我直言的正确工具。

我认为正则表达式一般不会起作用。像这样的字符串怎么样：

```
[a] [b] 
```

我相信这会变成

```
[a]_[b] 
```

也许`(?<=\[[^\]]*?)(\s(?<=\s))(?=[^\[]*?\])`有效，也许无效 - 无论哪种方式都是一团糟！

你真的应该考虑只提取所有`\[([^\]]*)\]`组，然后用第二步重写这些。

SQL 可能*不是常规语言*，而是上下文无关的。（参见乔姆斯基层次结构）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T00:04:39.693

这似乎有效：

```
$string = 'select * from [Existing product] where [Existing product].[Desc value] = 26'

$string -replace '(\[\S+)\s(\S+\])','$1_$2' 
```

从 [Existing_product] 中选择 *，其中 [Existing_product].[Desc_value] = 26

如果有多个嵌入式空间，情况会变得更加复杂。

```
 $string = 'select * from [Existing product one] where [Existing product one].[Desc value] = 26'

[regex]$regex = '(\[[^\]]*\])'

$regex.Matches($string) | 
%{$string = $string -replace [regex]::escape($_.value),($_.value.replace(' ','_'))}
$string 
```

从 [Existing_product_one] 中选择 *，其中 [Existing_product_one].[Desc_value] = 26

# android - KeyEvent.ACTION_UP 为 ACTION_MEDIA_BUTTON 触发了两次

> ID：15168803
> 
> 赞同：20
> 
> 时间：2013-03-01T23:45:43.447
> 
> 标签：android, broadcastreceiver, android-audiomanager

我有这个 ACTION_MEDIA_BUTTON 广播接收器，它实际上适用于 Android 2.x 和 Android 4.1，但出于某种奇怪的原因，在**Android 2.x (only)**上，我什至得到了**两次**（**单击**暂停按钮，当然）：

```
public class RemoteControlReceiver extends BroadcastReceiver {
  private static long prevEventTime = 0;

  @Override
  public void onReceive(Context ctx, Intent intent) {
    if (Intent.ACTION_MEDIA_BUTTON.equals(intent.getAction())) {
      KeyEvent event = (KeyEvent)intent.getParcelableExtra(Intent.EXTRA_KEY_EVENT);
      long curEventTime = event.getEventTime();
      if (event != null && (event.getAction() == KeyEvent.ACTION_UP) /*&& (curEventTime != prevEventTime)*/) {
        int keycode = event.getKeyCode();
        switch (keycode)
        {
          case KeyEvent.KEYCODE_MEDIA_NEXT:
            Log.i(TAG, "KEYCODE_MEDIA_NEXT"); 
            break;
          case KeyEvent.KEYCODE_HEADSETHOOK:
            Log.i(TAG, "KEYCODE_HEADSETHOOK" + " " +  curEventTime + " <> " + prevEventTime + " (" + event.getAction() + ")");
            prevEventTime = curEventTime;
            break;
          case KeyEvent.KEYCODE_MEDIA_PREVIOUS:
            Log.i(TAG, "KEYCODE_MEDIA_PREVIOUS"); 
            break;
          default:
        }
      }     
    }
  }

} 
```

为了理解其中的奥秘，我记录了每次发生此类事件的事件时间：

```
03-01 18:27:05.264: I/RemoteControlReceiver.onReceive(22377): KEYCODE_HEADSETHOOK 142304436 <> 0 (1)
03-01 18:27:05.434: I/RemoteControlReceiver.onReceive(22377): KEYCODE_HEADSETHOOK 142304436 <> 142304436 (1)

03-01 18:27:14.054: I/RemoteControlReceiver.onReceive(22377): KEYCODE_HEADSETHOOK 142313265 <> 142304436 (1)
03-01 18:27:14.074: I/RemoteControlReceiver.onReceive(22377): KEYCODE_HEADSETHOOK 142313265 <> 142313265 (1)

03-01 18:27:24.254: I/RemoteControlReceiver.onReceive(22377): KEYCODE_HEADSETHOOK 142323464 <> 142313265 (1)
03-01 18:27:24.264: I/RemoteControlReceiver.onReceive(22377): KEYCODE_HEADSETHOOK 142323464 <> 142323464 (1)

03-01 18:27:37.574: I/RemoteControlReceiver.onReceive(22377): KEYCODE_HEADSETHOOK 142336795 <> 142323464 (1)
03-01 18:27:37.614: I/RemoteControlReceiver.onReceive(22377): KEYCODE_HEADSETHOOK 142336795 <> 142336795 (1)

03-01 18:27:45.214: I/RemoteControlReceiver.onReceive(22377): KEYCODE_HEADSETHOOK 142344433 <> 142336795 (1)
03-01 18:27:45.284: I/RemoteControlReceiver.onReceive(22377): KEYCODE_HEADSETHOOK 142344433 <> 142344433 (1)

03-01 18:27:52.474: I/RemoteControlReceiver.onReceive(22377): KEYCODE_HEADSETHOOK 142351687 <> 142344433 (1)
03-01 18:27:52.504: I/RemoteControlReceiver.onReceive(22377): KEYCODE_HEADSETHOOK 142351687 <> 142351687 (1) 
```

同样，这种重复**出现在 Android 4.1 中不会发生。**它只发生在 Android 2.x 中。

知道**为什么吗？**

（虽然我可以使用相同的事件时间记录技术来过滤第二次发生，但我更愿意先了解发生了什么（我这边可能的编程错误？），然后看看是否有更好的解决方案）

* * *

**回答以下问题：（** “您如何准确注册接收器”）

首先在应用程序的清单中：

```
<receiver android:name="com.example.mylib.RemoteControlReceiver" android:enabled="true">
    <intent-filter android:priority="2147483647" >
        <action android:name="android.intent.action.MEDIA_BUTTON" />
    </intent-filter>
</receiver> 
```

然后，在我的图书馆活动中（根据[这个提示](https://stackoverflow.com/a/13553866/636571)），在 OnCreate() 中：

```
mRemoteControlReceiver = new ComponentName(this, RemoteControlReceiver.class);
mAudioManager.registerMediaButtonEventReceiver(mRemoteControlReceiver); 
```

我希望这提供了一个更完整的画面，可以帮助解开这个谜团。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-05T03:25:52.567

我注意到您在库中使用此接收器（清单中的“mylib”部分）。

如果情况确实如此，并且您的接收器由共享相同注册码的**两个应用程序注册，您将看到这些事件****两次**。

如果三个应用程序注册了该接收器，您将收到三倍的这些事件......

确保每个应用程序使用不同的（唯一的）`<receiver android:name`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-11T23:43:05.183

我遇到了这个问题，花了一段时间把头撞在墙上，然后才意识到每次按下按钮都会产生两个事件：KeyEvent.ACTION_DOWN 和 KeyEvent.ACTION_UP。所以使用媒体按钮需要两个测试：

```
if (Intent.ACTION_MEDIA_BUTTON.equals(intent.getAction())) {} 
```

和

```
if (event.getAction() == KeyEvent.ACTION_DOWN) {} 
```

因此，如果其他人因同样的错误而发现自己在这里，也许这个回复会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T13:09:24.317

为了确保它始终是第一次，您可以使用一个标志来告诉它是第一个动作。

```
boolean firstAction= false;
if (Intent.ACTION_MEDIA_BUTTON.equals(intent.getAction())) {
    firstAction= !firstAction;
    if(!firstAction)
    {
        return true;
    }

    KeyEvent event = (KeyEvent)intent.getParcelableExtra(Intent.EXTRA_KEY_EVENT);
    long curEventTime = event.getEventTime();
    if (event != null && (event.getAction() == KeyEvent.ACTION_UP) /*&& (curEventTime != prevEventTime)*/) {
        int keycode = event.getKeyCode();
        switch (keycode)
        {
          case KeyEvent.KEYCODE_MEDIA_NEXT:
            Log.i(TAG, "KEYCODE_MEDIA_NEXT"); 
            break;
          case KeyEvent.KEYCODE_HEADSETHOOK:
            Log.i(TAG, "KEYCODE_HEADSETHOOK" + " " +  curEventTime + " <> " + prevEventTime + " (" + event.getAction() + ")");
            prevEventTime = curEventTime;
            break;
          case KeyEvent.KEYCODE_MEDIA_PREVIOUS:
            Log.i(TAG, "KEYCODE_MEDIA_PREVIOUS"); 
            break;
          default:
        }
    }     
} 
```

# c# - Unity3D 中的 MovieTexture 永远无法播放

> ID：15168807
> 
> 赞同：1
> 
> 时间：2013-03-01T23:46:10.647
> 
> 标签：c#, unity3d, movie, coroutine

我正在使用 Unity WWW 对象加载 ogg theora 格式的电影文件，但我遇到了一些我无法弄清楚如何解决的奇怪问题。

为了澄清起见，我的资产文件夹中有一个名为“Movies/”的文件夹，其中包含我本地存储的所有电影文件。

下面是我的应用程序的 AC# 代码片段，它位于使用 StartCoroutine 运行的类方法中：

```
WWW www = new WWW("file://" + Application.dataPath + "/Movies/" + movieName + ".ogg");
yield return www;
m_MovieTexture = www.movie;
if (m_MovieTexture == null)
{
    DbgLog("Movie is NULL!");
    return;
}
if (m_MovieTexture.isPlaying)
{
    // Not sure how this can happen, but just in case....
    m_MovieTexture.Stop();
}
else
{
    if (www.error != null)
    {
        DbgLog("Error: " + www.error);
        return;
    }
    DbgLog("Waiting to load " + www.url);
    while (!m_MovieTexture.isReadyToPlay && !www.isDone)
    {
        yield return www;
    }
    DbgLog("Finished Loading");
    if (www.isDone && !m_MovieTexture.isReadyToPlay)
    {
        DbgLog("Weirdness!  File finished loading before movie was ready to play!");
    }
}
m_MovieTexture.Play();
DbgLog("Playing video (" + m_MovieTexture.duration + " seconds)");
while (m_MovieTexture.isPlaying)
    yield return null;
// be kind... rewind.
m_MovieTexture.Stop();
DbgLog("Finished Playing");
m_MovieTexture = null; 
```

执行上述代码时，其中的日志语句显示 www.isDone 属性返回 true，即使 m_MovieTexture.isReadyToPlay 返回 false。最初，while 循环只在 m_MovieTexture.isReadyToPlay 上等待，但该循环无休止地等待，因此添加了额外的条件，这暴露了真正发生的事情。电影的持续时间也始终为 -1，最后，尽管显式调用 m_MovieTexture.Play() 然后在 m_MovieTexture.isPlaying 为true，m_MovieTexture.isPlaying 立即返回 false，并且电影从不播放（OnGUI 方法中有代码显示 m_MovieTexture 的内容，如果有，则电影正在播放，但问题似乎出在上面的代码中，而不是OnGUI 方法）。

任何关于我在这里可能做错的想法将不胜感激。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T13:59:41.473

WWW 已经是一个非阻塞协程。因此，您可以只使用一个函数来指示您的 WWW 实例加载视频并将电影分配给您的 m_MovieTexture。然后在您的 OnGUI 或更新功能中检查

```
if(m_MovieTexture!=null && !m.isPlaying && m.isReadyToPlay) m_MovieTexture.play(); 
```

这是[MovieTexture.onIsReadyToplay](http://docs.unity3d.com/Documentation/ScriptReference/MovieTexture-isReadyToPlay.html)文档的链接。

# html - 上传大图像时 html5 崩溃

> ID：15168813
> 
> 赞同：1
> 
> 时间：2013-03-01T23:46:31.837
> 
> 标签：html, filereader

下面代码中的问题是，当我想显示 40 个大图像的缩略图时。Windows 中的 Firefox 正在崩溃，因为 cpu 使用率增加，同时加载一个又一个图像。我知道这是因为加载全尺寸的图像（大约 9000 Kb）。有没有办法只显示缩略图而不是在 html5 中加载全尺寸。 ..

dropbox.addEventListener("drop", dropUpload, false);

函数dropUpload（事件）{

noop（事件）；var dropMethod = event.dataTransfer;

```
var classicMethod = event.target;

var filesDone =0;

var dropedFiles = (dropMethod == undefined) ? classicMethod.files: dropMethod.files;
function next() {
    if (filesDone < dropedFiles.length) {
        addFileThumbnails(dropedFiles[filesDone++], next);
    }
}
// do the first one
next(); 
```

}

函数 addFileThumbnails(file,doneCallback) {

```
var li = document.createElement("li"),
div = document.createElement("div"),
img,
progressBarContainer = document.createElement("div"),
progressBar = document.createElement("div"),
tBody;
li.appendChild(div);

progressBarContainer.className = "progress-bar-container";
progressBar.className = "progress-bar";
progressBar.setAttribute("id", "proBar_" + (indexN++));
progressBarContainer.appendChild(progressBar);
li.appendChild(progressBarContainer);
var reader = new FileReader();
reader.onerror = function(event) {
    alert("couldn't read file "
            + event.target.error.code);
};
// Present file info and append it to the list of files

if (reader !== "undefined" && (/image/i).test(file.type)) {
    img = document.createElement("img");
    img.setAttribute("class", "thumb");
    img.setAttribute("id", "img_" + (indexN++));
    reader.onload = (function (img) {
        return function (evt) {
            img.src = evt.target.result;
            doneCallback();
    };

    }(img));
    var ret = reader.readAsDataURL(file);
    var canvas = document.createElement("canvas");
    ctx = canvas.getContext("2d");
    img.onload= function(){
      ctx.drawImage(img,100,100)
    }
}

reader.addEventListener("progress", function (evt) {
    if (evt.lengthComputable) {
        progressBar.style.width= (evt.loaded / evt.total) * 100 + "%";
    }

}, false);

// File uploaded
reader.addEventListener("load", function () {
    progressBarContainer.className += " uploaded";
    progressBar.innerHTML = "";
}, false);

fileInfo = "Name:" + file.name + "</br>";
fileInfo += "Size:" + parseInt(file.size / 1024, 10) + " kb</br>";
fileInfo += "Type:" + file.type;
div.setAttribute("id", "desc_" + img.id.substring(4));
div.innerHTML = fileInfo;

tBody = getTableBodyLayout(img,li);
document.getElementById("images_table").appendChild(tBody);
moveScrollbar(); 
```

}

# c++ - 使用 PUGIXML 重复保存大型 XML 文件需要大量时间

> ID：15168817
> 
> 赞同：2
> 
> 时间：2013-03-01T23:46:42.503
> 
> 标签：c++, pugixml

我有一个 65Mb XML 文件，我正在使用 PUGIXML 加载和修改它。问题是我需要保持更新并保存到磁盘，以便其他文件可以访问。我不想实现数据库，那么有没有办法让我进行修改，只保存这些修改，而不是将整个文档转储到文件中？每次保存 xml 文件时，我都会注意到大约 3-4 秒的延迟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-16T07:55:38.857

这是一个老问题。但无论如何，让我回答。pugixml 具有通过`write`接口保存数据的模式。这有效地解决了必须转储整个文件的问题，因为您可以将数据分成更小的部分并写入文件。

从[文档](http://pugixml.org/docs/manual.html#saving.writer)中：

> 这是一个具有单个函数的简单接口，在输出过程中以大块文档数据作为输入调用多次：
> 
> ```
> class xml_writer
> {
> public:
>     virtual void write(const void* data, size_t size) = 0;
> };
> 
> void xml_document::save(xml_writer& writer, const char_t* indent = "\t",
>                         unsigned int flags = format_default,
>                         xml_encoding encoding = encoding_auto) const; 
> ```
> 
> ...
> 
> write 函数是用相对较大的块调用的（大小通常是几千字节，除了最后一个可能很小的块），因此在实现中通常不需要额外的缓冲。

还有另一种方法可以解决这个问题：一次保存一个子树。同样，从[文档](http://pugixml.org/docs/manual.html#saving.subtree)中：

> 为了保存单个子树，提供了以下函数：

```
void xml_node::print(std::ostream& os, const char_t* indent = "\t", unsigned int flags = format_default, xml_encoding encoding = encoding_auto, unsigned int depth = 0) const;
void xml_node::print(std::wostream& os, const char_t* indent = "\t", unsigned int flags = format_default, unsigned int depth = 0) const;
void xml_node::print(xml_writer& writer, const char_t* indent = "\t", unsigned int flags = format_default, xml_encoding encoding = encoding_auto, unsigned int depth = 0) const; 
```

> 这些函数与相应的 xml_document::save 函数具有相同的参数和相同的含义，并允许您将子树保存到 C++ IOstream 或任何实现 xml_writer 接口的对象。

# variables - 未定义变量：第 81 行的日期

> ID：15168820
> 
> 赞同：0
> 
> 时间：2013-03-01T23:46:53.590
> 
> 标签：variables, undefined, php

我的 PHP 文件中的未定义变量错误再次出现问题。错误（日期）发生在 PHP 文件的第 81 行，我不确定为什么这个错误不会消失。该程序应该允许用户以 111.222.3.44 和 mm/dd/yyyy 格式输入 IP 地址和当前日期。有人可以在这里指出这个问题吗？

```
<html>
<head>
<title>Displaying Errors</title>
</head>
<body>

<?php
    $IP = '/^\d{3}\.\d{3}\.\d\.\d{2}$/';
    $number = '/^([0-9]{2})\/([0-9]{2})\/([0-9]{4})$/';

    if (isset($_POST["IP"])) {$IP = $_POST["IP"];}
    if (isset($_POST["date"])) {$date = $_POST["date"];}

if (preg_match('/^\d{3}\.\d{3}\.\d\.\d{2}$/' , $IP)) 
    { 
        print "Your IP address is good."; 

            if (preg_match('/^\d{2}\/\d{2}\/\d{4}$/', $date))
                { 
                    print "The date format is ok. Thank you for submitting your form<br>."; 
                }
            else if ($date = " ")
    { 
?>

        <form method="GET" method="Lab 10.php" >
        <h1></h1>
        <p>
        IP Address
        <input type="text" name="ip" value="<?php echo $_REQUEST['IP']; ?>"/><br />
        <p style="color:red;">Enter the date mm/dd/yy</p>
        <input type="text" name="date" value="

        <?php echo $_REQUEST['date']; ?>" /><br />

        <br /><br />

        <input type="submit" value="Submit" />
        </form>
        <?php 

        print "<font color=\"red\">The date is empty<br></font>";
        print "<font color=\"red\">You need to resubmit the form</font>";

    }

    else
    {

        ?><form method="GET" method="Lab 10.php" >
        <h1></h1>
        <p>
        IP Address
        <input type="text" name="IP" value="<?php echo $_REQUEST['IP']; ?>"/><br />
        <p style="color:red;">Enter the date mm/dd/yy</p>
         <input type="text" name="date" value="<?php echo $_REQUEST['date']; ?>" /><br />

        <br /><br />

        <input type="submit" value="Submit" />
        </form>
        <?php

        print "<font color=\"red\">The date format is incorrect<br></font>";
        print "<font color=\"red\">You need to resubmit the form</font>";
    }
}

else if ($IP = " ") //test if ip address is null
{
    print "<font color =\"red\">The IP Address is empty.</font><br>";

    if (preg_match('/^\d{2}\/\d{2}\/\d{4}$/', $date))
        { 
            print "The date format is ok. Thank you for submitting your form<br>."; 
        }
           else if ($date = " ")
        { 

        ?><form method="GET" method="Lab 10.php" >
        <h1></h1>
        <p>
        IP Address
        <input type="text" name="ip" value="<?php echo $_REQUEST['IP']; ?>"/><br />
        <p style="color:red;">Enter the date mm/dd/yy</p>
        <input type="text" name="date" value="<?php echo $_REQUEST['date']; ?>" /><br />

        <br /><br />

        <input type="submit" value="Submit" />
        </form>
        <?php 
        print "<font color=\"red\">The date is empty<br></font>";
        print "<font color=\"red\">You need to resubmit the form</font>";

        }

    else
        {

        ?><form method="GET" method="Lab 10.php" >
        <h1></h1>
        <p>
        IP Address
        <input type="text" name="ip" value="<?php echo $_REQUEST['IP']; ?>"/><br />
        <p style="color:red;">Enter the date mm/dd/yy</p>
        <input type="text" name="date" value="<?php echo $_REQUEST['date']; ?>" /><br />

        <br /><br />

        <input type="submit" value="Submit" />
        </form>
        <?php

        print "<font color=\"red\">The date format is incorrect<br></font>";
        print "<font color=\"red\">You need to resubmit the form</font>";
        }

}

    else //if IP is anything else but accepted
{ 
    print "<font color=\"red\">Please enter a valid IP address.</font><br>"; 

    if (preg_match('/^\d{2}\/\d{2}\/\d{4}$/', $date))
        { 
        print "The date format is ok. Thank you for submitting your form<br>."; 

        }

            else if ($date = " ")
        { 
        print "The date is empty<br>";
        print "You need to resubmit the form<br>";

        ?><form method="GET" method="Lab 10.php" >
        <h1></h1>
        <p>
        IP Address
        <input type="text" name="ip" value="<?php echo $_REQUEST['IP']; ?>"/><br />
        <p style="color:red;">Enter the date mm/dd/yy</p>
        <input type="text" name="date" value="<?php echo $_REQUEST['date']; ?>" /><br />

        <br /><br />

         <input type="submit" value="Submit" />
        </form>
        <?php 
        print "<font color=\"red\">The date is empty<br></font>";
        print "<font color=\"red\">You need to resubmit the form</font>";

        }

    else
        {
        print "The date format is incorrect<br>";
        print "You need to resubmit the form<br>";

        ?><form method="GET" method="Lab 10.php" >
        <h1></h1>
        <p>
        IP Address
         <input type="text" name="ip" value="<?php echo $_REQUEST['IP']; ?>"/><br />
        <p style="color:red;">Enter the date mm/dd/yy</p>
        <input type="text" name="date" value="<?php echo $_REQUEST['date']; ?>" /><br />

        <br /><br />

        <input type="submit" value="Submit" />
        </form>
        <?php
print "<font color=\"red\">The date format is incorrect<br></font>";
        print "<font color=\"red\">You need to resubmit the form</font>";
        }

}

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T23:51:50.060

简单的：

```
if (isset($_POST["date"])) {$date = $_POST["date"];} 
```

您只设置`$date`它是否在`$_POST`数组中，但您的表单方法是`GET`

# linux - Intel x86 与 x64 系统调用

> ID：15168822
> 
> 赞同：32
> 
> 时间：2013-03-01T23:46:58.803
> 
> 标签：linux, assembly, x86, x86-64, interrupt

我正在阅读有关 x86 和 x64 之间的装配差异。

在 x86 上，系统调用号放在 中`eax`，然后`int 80h`执行以产生软件中断。

但是在 x64 上，系统调用号放在 中`rax`，然后`syscall`被执行。

有人告诉我，这`syscall`比生成软件中断更轻、更快。

为什么在 x64 上比 x86 更快，我可以使用 x64 进行系统调用`int 80h`吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-03-02T00:22:02.273

## 一般部分

编辑：删除 Linux 无关部分

虽然并非完全错误，但将问题缩小`int 0x80`并`syscall`过度简化，因为`sysenter`至少有第三种选择。

使用 0x80 和 eax 作为系统调用号、ebx、ecx、edx、esi、edi 和 ebp 来传递参数只是实现系统调用的许多其他可能选择之一，但这些寄存器是 32 位 Linux ABI 选择的寄存器.

在仔细研究所涉及的技术之前，应该说明它们都围绕着逃离每个进程运行的特权监狱的问题。

此处提供的 x86 架构提供的另一种选择是使用调用门（参见：[http](http://en.wikipedia.org/wiki/Call_gate) ://en.wikipedia.org/wiki/Call_gate ）

所有 i386 机器上唯一存在的其他可能性是使用软件中断，它允许 ISR（*中断服务程序*或简单的*中断处理程序*）以与以前不同的特权级别运行。

（有趣的事实：一些 i386 操作系统使用无效指令异常进入内核进行系统调用，因为这实际上比`int`386 CPU 上的指令快。请参阅[OsDev syscall/sysret 和 sysenter/sysexit 指令](https://stackoverflow.com/questions/46022184/osdev-syscall-sysret-and-sysenter-sysexit-instructions-enabling)以获取可能的摘要系统调用机制。）

## 软件中断

触发中断后究竟会发生什么取决于切换到 ISR 是否需要更改权限：

（英特尔® 64 和 IA-32 架构软件开发人员手册）

> 6.4.1 中断或异常处理过程的调用和返回操作
> 
> ...
> 
> 如果处理程序的代码段与当前执行的程序或任务具有相同的特权级，则处理程序使用当前堆栈；如果处理程序以更高的特权级别执行，则处理器切换到处理程序特权级别的堆栈。
> 
> ……
> 
> 如果确实发生了堆栈切换，处理器将执行以下操作：
> 
> 1.  临时保存（内部）SS、ESP、EFLAGS、CS 和 > EIP 寄存器的当前内容。
>     
>     
> 2.  将新堆栈（即被调用的特权级别的堆栈）的段选择器和堆栈指针从 TSS 加载到 SS 和 ESP 寄存器并切换到新堆栈。
>     
>     
> 3.  将中断过程堆栈的临时保存的 SS、ESP、EFLAGS、CS 和 EIP 值推送到新堆栈上。
>     
>     
> 4.  在新堆栈上推送错误代码（如果合适）。
>     
>     
> 5.  将新代码段的段选择器和新指令指针（来自中断门或陷阱门）分别加载到 CS 和 EIP 寄存器中。
>     
>     
> 6.  如果调用是通过中断门，清除 EFLAGS 寄存器中的 IF 标志。
>     
>     
> 7.  以新的特权级别开始执行处理程序过程。

... 叹息这似乎有很多事情要做，即使我们完成了它也不会变得更好：

（摘自上述同一来源：英特尔® 64 和 IA-32 架构软件开发人员手册）

> 当从与中断过程不同的特权级别执行中断或异常处理程序的返回时，处理器执行以下操作：
> 
> 1.  执行权限检查。
>     
>     
> 2.  将 CS 和 EIP 寄存器恢复到中断或异常之前的值。
>     
>     
> 3.  恢复 EFLAGS 寄存器。
>     
>     
> 4.  将 SS 和 ESP 寄存器恢复到中断或异常之前的值，导致堆栈切换回中断过程的堆栈。
>     
>     
> 5.  恢复执行被中断的过程。

## 系统输入

您的问题中根本没有提到但 Linux 内核使用的 32 位平台上的另一个选项是`sysenter`指令。

（英特尔® 64 和 IA-32 架构软件开发人员手册第 2 卷（2A、2B 和 2C）：指令集参考，AZ）

> 说明 执行对 0 级系统过程或例程的快速调用。SYSENTER 是 SYSEXIT 的配套指令。该指令经过优化，可为从以特权级别 3 运行的用户代码到以特权级别 0 运行的操作系统或执行过程的系统调用提供最大性能。

使用此解决方案的一个缺点是，它并非存在于所有 32 位机器上，因此`int 0x80`仍必须提供该方法以防 CPU 不知道它。

> Pentium II 处理器的 IA-32 架构中引入了 SYSENTER 和 SYSEXIT 指令。这些指令在处理器上的可用性通过 CPUID 指令返回到 EDX 寄存器的 SYSENTER/SYSEXIT 存在 (SEP) 功能标志来指示。符合 SEP 标志的操作系统还必须符合处理器系列和型号，以确保实际存在 SYSENTER/SYSEXIT 指令

## 系统调用

最后一种可能性，`syscall`指令，几乎允许与`sysenter`指令相同的功能。两者的存在是因为一个 ( `systenter`) 是由 Intel 引入的，而另一个 ( `syscall`) 是由 AMD 引入的。

## 特定于 Linux

在 Linux 内核中，可以选择上述三种可能性中的任何一种来实现系统调用。

另请参阅[**Linux 系统调用权威指南**](https://blog.packagecloud.io/eng/2016/04/05/the-definitive-guide-to-linux-system-calls/)。

如上所述，该`int 0x80`方法是 3 种选择实现中唯一一种可以在任何 i386 CPU 上运行的方法，因此这是唯一一种始终可用于 32 位用户空间的方法。

(`syscall`是唯一一个始终可用于 64 位用户空间的，[也是您应该在 64 位代码中使用的唯一一个](https://stackoverflow.com/questions/46087730/what-happens-if-you-use-the-32-bit-int-0x80-linux-abi-in-64-bit-code)；x86-64 内核可以在没有 的情况下构建`CONFIG_IA32_EMULATION`，并且`int 0x80`仍然调用截断指针的 32 位 ABI到 32 位。）

为了允许在所有 3 个选项之间切换，每个进程运行都可以访问一个特殊的共享对象，该共享对象可以访问为正在运行的系统选择的系统调用实现。`linux-gate.so.1`这是您在使用等时可能已经遇到的未解析库的奇怪外观`ldd`。

(arch/x86/vdso/vdso32-setup.c)

```
 if (vdso32_syscall()) {                                                                               
        vsyscall = &vdso32_syscall_start;                                                                 
        vsyscall_len = &vdso32_syscall_end - &vdso32_syscall_start;                                       
    } else if (vdso32_sysenter()){                                                                        
        vsyscall = &vdso32_sysenter_start;                                                                
        vsyscall_len = &vdso32_sysenter_end - &vdso32_sysenter_start;                                     
    } else {                                                                                              
        vsyscall = &vdso32_int80_start;                                                                   
        vsyscall_len = &vdso32_int80_end - &vdso32_int80_start;                                           
    } 
```

要使用它，您只需将所有寄存器系统调用号加载到 eax 中，将参数加载到 ebx、ecx、edx、esi、edi 中，就像`int 0x80`系统调用实现和`call`主例程一样。

不幸的是，这并不是那么容易。为了最大限度地降低固定预定义地址的安全风险，`vdso`（*虚拟动态共享对象*）在进程中可见的位置是随机的，因此您必须首先找出正确的位置。

该地址对每个进程都是单独的，并且一旦启动就会传递给该进程。

如果您不知道，在 Linux 中启动时，每个进程都会获得指向一旦启动时传递的参数的指针，以及指向它在其堆栈上运行的环境变量的描述的指针——每个进程都以 NULL 终止。

除了这些之外，第三个所谓的精灵辅助向量块在前面提到的那些之后被传递。正确的位置被编码在其中一个带有 type-identifier 的位置`AT_SYSINFO`。

所以堆栈布局看起来像这样（地址向下增长）：

*   参数-0
*   ...
*   参数-m
*   空值
*   环境-0
*   ……
*   环境-n
*   空值
*   ...
*   辅助精灵矢量： `AT_SYSINFO`
*   ...
*   辅助精灵矢量： `AT_NULL`

## 使用示例

要找到正确的地址，您必须首先跳过所有参数和所有环境指针，然后开始扫描，`AT_SYSINFO`如下例所示：

```
#include <stdio.h>
#include <elf.h>

void putc_1 (char c) {
  __asm__ ("movl $0x04, %%eax\n"
           "movl $0x01, %%ebx\n"
           "movl $0x01, %%edx\n"
           "int $0x80"
           :: "c" (&c)
           : "eax", "ebx", "edx");
}

void putc_2 (char c, void *addr) {
  __asm__ ("movl $0x04, %%eax\n"
           "movl $0x01, %%ebx\n"
           "movl $0x01, %%edx\n"
           "call *%%esi"
           :: "c" (&c), "S" (addr)
           : "eax", "ebx", "edx");
}

int main (int argc, char *argv[]) {

  /* using int 0x80 */
  putc_1 ('1');

  /* rather nasty search for jump address */
  argv += argc + 1;     /* skip args */
  while (*argv != NULL) /* skip env */
    ++argv;            

  Elf32_auxv_t *aux = (Elf32_auxv_t*) ++argv; /* aux vector start */

  while (aux->a_type != AT_SYSINFO) {
    if (aux->a_type == AT_NULL)
      return 1;
    ++aux;
  }

  putc_2 ('2', (void*) aux->a_un.a_val);

  return 0;
} 
```

通过查看`/usr/include/asm/unistd_32.h`我系统上的以下片段，您将看到：

```
#define __NR_restart_syscall 0
#define __NR_exit            1
#define __NR_fork            2
#define __NR_read            3
#define __NR_write           4
#define __NR_open            5
#define __NR_close           6 
```

我使用的系统调用是在 eax 寄存器中传递的编号为 4（写入）的系统调用。以 filedescriptor (ebx = 1)、data-pointer (ecx = &c) 和 size (edx = 1) 作为参数，分别传入相应的寄存器。

## 长话短说

*将在任何*Intel CPU 上运行缓慢的`int 0x80`系统调用与使用（真正由 AMD 发明的）指令的（希望）更快的实现进行比较，就是将苹果与橙子进行比较。*`syscall`*

 *恕我直言：很可能`sysenter`指令而不是`int 0x80`应该在这里进行测试。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-03-02T01:20:38.080

调用内核（进行系统调用）时需要发生三件事：

1.  系统从“用户模式”进入“内核模式”（环 0）。
2.  堆栈从“用户模式”切换到“内核模式”。
3.  跳转到内核的适当部分。

显然，一旦进入内核，内核代码将需要知道您实际上希望内核做什么，因此在 EAX 中放置一些东西，并且通常在其他寄存器中放置更多东西，因为有诸如“您要打开的文件的名称”之类的东西。 "或"从文件中读取数据的缓冲区"等，等等。

不同的处理器有不同的方式来实现上述三个步骤。在 x86 中，有多种选择，但手写 asm 最流行的两种是`int 0xnn`（32 位模式）或`syscall`（64 位模式）。（还有 32 位模式`sysenter`，由英特尔引入，原因与 AMD 引入 32 位模式版本的原因相同`syscall`：作为慢速的更快替代方案`int 0x80`。32 位 glibc 使用任何可用的有效系统调用机制，仅使用`int 0x80`如果没有更好的东西，那就慢一点。）

[该`syscall`指令](https://www.felixcloutier.com/x86/syscall)的 64 位版本是在 x86-64 架构中引入的，作为进入系统调用的更快方式。它有一组寄存器（使用 x86 MSR 机制），其中包含我们希望跳转到的地址 RIP、要加载到 CS 和 SS 中的选择器值以及用于执行 Ring3 到 Ring0 的转换。它还将返回地址存储在 ECX/RCX 中。[请阅读指令集手册以了解该指令的所有细节 - 这并非完全无关紧要！]。由于处理器知道这将切换到 Ring0，它可以直接做正确的事情。

**关键点之一是`syscall`只操作寄存器；它不执行任何加载或存储。** （这就是它用保存的 RIP 覆盖 RCX 并用保存的 RFLAGS 覆盖 R11 的原因）。内存访问取决于页表，并且页表条目有一点可以使它们仅对内核有效，而不是对用户空间有效，因此*在*更改特权级别时进行内存访问可能需要等待而不是仅写入寄存器。一旦进入内核模式，内核通常会使用`swapgs`或其他方式来查找内核堆栈。（`syscall`不修改 RSP；它*在*进入内核时仍然指向用户堆栈。）

当使用 SYSRET 指令返回时，这些值是从寄存器中的预定值恢复的，所以同样很快，因为处理器只需要设置几个寄存器。处理器知道它将从 Ring0 变为 Ring3，因此可以快速做正确的事情。

（AMD CPU 支持`syscall`来自 32 位用户空间的指令；Intel CPU 不支持。x86-64 最初是 AMD64；这就是我们`syscall`在 64 位模式下使用的原因。AMD 重新设计了 64 位模式的内核端`syscall`，所以64 位`syscall`内核入口点与 64 位内核中的 32 位入口点有很大不同`syscall`。）

The `int 0x80` variant used in 32-bit mode will decide what to do based on the value in the interrupt descriptor table, which means reading from memory. There it finds the new CS and EIP/RIP values. The new CS register determines the new "ring" level - Ring0 in this case. It will then use the new CS value to look into the Task State Segment (based on the TR register) to find out which stack pointer (ESP/RSP and SS), and then finally jumps to the new address. Since this is a less direct and more generic solution it is also slower. The old EIP/RIP and CS is stored on the new stack, along with the old values of the SS and ESP/RSP.

返回时，处理器使用 IRET 指令从堆栈中读取返回地址和堆栈指针值，同时从堆栈中加载新的堆栈段和代码段值。同样，该过程是通用的，并且需要大量的内存读取。由于它是通用的，处理器还必须检查“我们是否将模式从 Ring0 更改为 Ring3，如果是，请更改这些内容”。

所以，总而言之，它更快，因为它本来就是这样工作的。

对于 32 位代码，是的，`int 0x80`如果你愿意，你绝对可以使用慢且兼容的。

For 64-bit code, `int 0x80` is slower than `syscall` and will truncate your pointers to 32-bit, so don't use it. See [What happens if you use the 32-bit int 0x80 Linux ABI in 64-bit code?](https://stackoverflow.com/questions/46087730/what-happens-if-you-use-the-32-bit-int-0x80-linux-abi-in-64-bit-code) Plus, `int 0x80` isn't available in 64-bit mode on all kernels, so it's not safe even for a `sys_exit` which doesn't take any pointer args: `CONFIG_IA32_EMULATION` can be disabled, and notably *is* disabled on Windows Subsystem for Linux.*

# c# - 如何检查动态加载的程序集和引用的程序集之间的类型？

> ID：15168826
> 
> 赞同：1
> 
> 时间：2013-03-01T23:47:17.177
> 
> 标签：c#, .net, reflection

简单地说，我正在做的是有效地为其他一些框架实现者制作一个具有一些有价值的框架特性的“形状包”。我将 Shape 包打包到一个类库中，然后继续编写测试实现。我动态加载 Shape 包 .dll 并将类型反映到程序集中。我可以创建对象、数据绑定到 DataGridViews 以及我喜欢的任何其他内容 - 但我无法通过简单的检查，例如

```
if (squareObject is Shape)
or
if (Square.IsSubclassOf(Shape)) 
```

举个例子 - 如果我有一个包含一个类的类库：

```
namespace Shapes
{
    public class Shape
    {
        public string UsefulShapeProperty { get; set; }
    }
} 
```

然后我用一个类创建一个实现库（参考 Shapes 库）：

```
namespace MyShapes
{
    public class UselessShape : Shapes.Shape
    {
        public string Description { get; set; }
    }
} 
```

最后，我创建了第三个项目，该项目引用 Shapes 库并动态加载实现库，例如 MyShapes：

```
using Shapes;
public class ShapeChecker
{
    ... (Constructor, some means to load and reflect the types from UselessShapes.dll, omitted for brevity and clarity)
    public void Report(Type typeToCheck)
    {
        if (typeToCheck.IsSubclassOf(typeof(Shapes.Shape)))
            Console.WriteLine("Rejoice, for " + typeToCheck.ToString() + " is a Shape!");
    }
} 
```

我从来没有得到“欢欣鼓舞”。我还使用了 Activator.CreateInstance 并检查了返回的对象。Activator 给了我一个 UselessShape 对象，但类型检查失败。

如何在动态加载的程序集中检查某些已知类型（如 Shape）的实现，以便我不需要 ShapeChecker 了解有关 MyShapes 包的任何特殊信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:59:19.773

好的，我认为问题在于您使用了错误的方法。

目前，您在询问 of 的类型*是否*`Shape`是 ... 的实例，`Shape`但不是。

我怀疑你想要[`Type.IsAssignableFrom`](http://msdn.microsoft.com/en-gb/library/system.type.isassignablefrom.aspx)：

```
if (typeof(Shapes.Shape).IsAssignableFrom(typeToCheck)) 
```

请注意，我在这里颠倒了目标/论点。我*想*我的方法是正确的，但我*总是*要检查......

# c++ - C 套接字发送/接收缓冲区类型

> ID：15168829
> 
> 赞同：4
> 
> 时间：2013-03-01T23:47:26.863
> 
> 标签：c++, c, sockets, unix

我正在使用 unix 套接字，当我的缓冲区为 char 类型（即发送和接收字符串）时，我可以发送（）和 ​​recv（）数据。我使用了 Beej 的套接字指南，使用的示例用于发送/接收字符串。

现在我想在一条消息中发送/接收不同类型的数据。
例如，假设在一条消息中我想发送一个整数、一个字符串、一个双精度数和一个浮点数。我该怎么做呢？更具体地说，我的消息“缓冲区”应该是什么类型的？

send 和 recv 的原型：

```
int recv (int socket, void *buffer, size_t size, int flags)
int send (int socket, void *buffer, size_t size, int flags) 
```

我对 C/C++ 和指针没有太多经验，所以这可能是一个菜鸟问题。

如果有人能引导我朝着正确的方向前进，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:49:17.353

最好的方法是将要传递的信息封装在一个结构中。然后传递结构的地址和长度。请注意，`buffer`它`void*`允许您传递包含您的信息的结构的地址。

这是`struct`我用于安全副本之*类*的工具的一小部分，

```
struct message
{
     size_t total_len;
     size_t filename_len;
     char *filename;
     size_t text_len;
     char *text;
     char *iv;
     char *salt;
     unsigned char *hmac;
}; 
```

然后在你的`send_message()`序列化中`message`再到`write``socket`

```
bool send_message(const struct message *msg, const char *ip, const char *port)
{
    ...
   connect(sockfd, (struct sockaddr *)&server_addr, sizeof(server_addr));
   // Serialize to file
   serialize(msg, "temp");

   // Transfer the file over the network
   fp = fopen("temp", "rb");
   while((n = fread(buffer, 1, MAX_BUF_LEN, fp)) != 0)
   {
       write(sockfd, buffer, n);
   }

   fclose(fp);
   remove("temp");

   close(sockfd);
} 
```

正如@vitaut 所建议的，你可以使用一个库来`serialize`，我已经将它作为一种学习体验来实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T23:52:04.247

您需要在发送方[序列化对象并在接收方反序列化。](http://en.wikipedia.org/wiki/Serialization)C++ 中有许多用于此的库，例如[Boost Serialization](http://www.boost.org/doc/libs/1_53_0/libs/serialization/doc/index.html)，或者如果您想重新发明轮子，您可以随时自己动手。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-01T23:54:36.923

除非您打算发送大量数据（数千字节）并且经常（每秒几个数据包），否则我建议您将数据转换为字符串（也称为“序列化数据”）并以这种方式传递。它有几个好处：

1.  它是可移植的——无论大小`int`或`float`或是`double`什么——或者结构中字段之间的填充是什么，它都可以工作。
2.  很容易调试（你可以只看数据并说出它是对还是错）
3.  发送/接收机器的字节顺序无关紧要。

另一方面，发送二进制数据很复杂，因为您需要担心数据字段的各个大小及其内部表示（字节顺序、`double`二进制如何表示 a、结构中数据字段的填充、不能传递指针等）。唯一的好处是二进制数据更紧凑一些。但这仅在您有很多千字节和/或每秒发送大量数据包时才重要。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-02T09:30:32.427

好吧，要回答所问的问题（“我如何发送结构？”），您只需发送一个指向该结构的指针。

```
struct foo
{
  int a;
  int b;
};

struct foo s;
s.a = 10;
s.b = 20;
send(socket,&s,sizeof(s),0); 
```

它真的很容易。现在，另一边必须相同（即，系统 A 上内存中布局的结构必须与系统 B 上布局的结构相匹配）。更好的方法是使用更具体的类型和一些函数来正确排序数据：

```
#ifndef __GNUC__
#  define __attribute__(x)
#endif

#ifdef __SunOS
#  pragma pack(1)
#endif

struct foo
{
  uint32_t a;
  uint32_t b;
} __attribute__((packed));

#ifdef __SunOS
#  pragma pack()
#endif

struct foo s

/* to send */

s.a = htonl(10);
s.b = htonl(20);
send(socket,&s,sizeof(s),0);

/* to receive */
recv(socket,&s,sizeof(s),0);
s.a = ntohl(s.a);
s.b = ntohl(s.b); 
```

当您想通过网络“可移植地”发送二进制数据时，您可以看到它开始相当快地获得系统特定，这就是人们说转换为文本或很可能使用已经编写的序列化库的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-01T23:52:45.653

这取决于它的便携性。

最简单的方法是将所有内容转换为用逗号或分号分隔的 ASCII，然后在接收端再次解析。

您还可以将其转换为[网络字节顺序](http://en.wikipedia.org/wiki/Endianness#Endianness_in_networking)并以二进制形式发送。

# jinja2 - 如何编写多行 Jinja 语句

> ID：15168831
> 
> 赞同：67
> 
> 时间：2013-03-01T23:47:32.950
> 
> 标签：jinja2

我的 Jinja 模板中有一个 if 语句，出于可读性原因，我想将它写在 multines 中。考虑案例

```
{% if (foo == 'foo' or bar == 'bar') and (fooo == 'fooo' or baar == 'baar') etc.. %} 
```

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2013-03-01T23:53:12.000

根据文档：[https](https://jinja.palletsprojects.com/en/2.10.x/templates/#line-statements) : //jinja.palletsprojects.com/en/2.10.x/templates/#line-statements 只要代码周围有括号/括号，您就可以使用多行语句。例子：

```
{% if ( (foo == 'foo' or bar == 'bar') and 
        (fooo == 'fooo' or baar == 'baar') ) %}
    <li>some text</li>
{% endif %} 
```

编辑：使用`line_statement_prefix = '#'`* 代码如下所示：

```
# if ( (foo == 'foo' or bar == 'bar') and 
       (fooo == 'fooo' or baar == 'baar') )
    <li>some text</li>
# endif 
```

*这是一个如何在 中指定的`line_statement_prefix`示例[`Environment`](https://jinja.palletsprojects.com/en/2.10.x/api/#jinja2.Environment)：

```
from jinja2 import Environment, PackageLoader, select_autoescape
env = Environment(
    loader=PackageLoader('yourapplication', 'templates'),
    autoescape=select_autoescape(['html', 'xml']),
    line_statement_prefix='#'
) 
```

或使用烧瓶：

```
from flask import Flask
app = Flask(__name__, instance_relative_config=True, static_folder='static')
app.jinja_env.filters['zip'] = zip
app.jinja_env.line_statement_prefix = '#' 
```

# email - 使用 googleapps 时通过 outlook.com 发送

> ID：15168835
> 
> 赞同：2
> 
> 时间：2013-03-01T23:47:55.213
> 
> 标签：email, gmail, google-apps, spf, outlook.com

我目前在我的域上使用谷歌应用程序进行业务。然而，我最近切换到了 Windows 手机，并想开始使用 Outlook.com 而不是 gmail 来接收我的电子邮件。我遇到的问题是 spf。有没有办法将 spf 记录添加到 google 企业应用程序，让我可以通过 outlook.com 发送电子邮件并获得通行证？我知道我可以简单地禁用谷歌应用程序，但我的业务伙伴想继续使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:22:37.397

当然！只需将两种 SPF 混合在一起：谷歌： `v=spf1 include:_spf.google.com ~all`

（参考[http://goo.gl/nySkg](http://goo.gl/nySkg)）

Outlook.com： `v=spf1 include:outlook.com -all`

（参考[http://help.outlook.com/140/cc188656.aspx](http://help.outlook.com/140/cc188656.aspx)）

要包括两者的传递： `v=spf1 include:_spf.google.com include:outlook.com ~all`

祝你好运！

# algorithm - 亚马逊面试 任何时候参加活动的最大人数

> ID：15168837
> 
> 赞同：1
> 
> 时间：2013-03-01T23:48:00.513
> 
> 标签：algorithm

假设我有一份人员名单，其中列出了他们在过去发生的事件中的到达和离开时间。

我的任务是找出在**任何时候**参加活动的**最大人数**？我没有得到查询时间。

 **ai = 人 i 的到达时间

di = 人 i 的出发时间

我有一个列表，如 (a1,d1)、(a2,d2)、(a3,d3).... (an,dn)... 它不在数据库中。

![在此处输入图像描述](../Images/f94d42533acbf9847f653096284517ee.png)

在这个问题中，我们可以看到事件的最大人数是 3。
所以在这个例子中。对于大小为 3 的问题，我们有五个解决方案。**{b,d,e}, {j,h,i}, {c,b,a}, {e,g,f}, {g,h,f}** . 我只想知道3号。

我的方法：
我。创建一个大小 = 上次出发时间 - 首次到达时间的数组。并不断增加该数组的计数。
ii. 我试图按人们的开始时间对他们进行排序。并继续跳到下一个人的开始时间。在那之后我迷路了。我该如何进行。

谢谢

@ypnos : //根据时间戳对数据进行排序。

```
int count = 0;
int max = 0
char [] arr = {a1, a2, d1, a3, a4, d3, d2, } like this..
for(int i =0; i < arr.length; i++)
{
    if(arr[i].startswith('a') ) 
    {
         count++;
    if(count > max)
    {
        max = count;
    }
    }
    else
   {
    count--;
   }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T23:58:13.713

首先，您创建一个包含到达和离开时间的排序列表。它是**两个事件的****单个**列表，每个事件都包含一个时间戳（排序键是什么）和一个布尔值（到达或离开）。

 ****新解决方案（找到最大值）：**

然后你可以遍历你的列表，记住每个条目的当前数字并相应地增加/减少它，同时如果合适的话还更新你的最大数字。

排序：O(N log N)，找到最大值。数量：O(N)

**由于问题中措辞不当而导致的旧解决方案（在时间 X 查询）：**

获得该列表后，您可以创建一个地图，其中包含时间戳作为键，并将当前时间戳的人数作为数据。要创建它，您需要浏览您的排序列表，记住每个条目的当前数字并相应地增加/减少它，同时还将元素添加到您的地图中。

现在您有了地图，您可以通过在地图中搜索查询时间戳左侧的元素轻松找到正确的数字。

对于地图，我的意思是二叉树，或者 std::map 的基础是什么。顺便提一句。std::map 为您提供了 lower_bound() 函数来执行此操作（[ref](http://www.cplusplus.com/reference/map/map/lower_bound/)）。

但是，自己实现二叉树并不难。现在对于操作的成本：每个条目 O(log N)，每个查询 O(log N)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:51:51.923

这是在数据库中吗？如果是这样，您只需选择到达时间 < 现在 < 出发时间的行。

这是一件简单的事情，但我们需要知道您使用什么数据结构来保存数据以提供特定的解决方案。

方法很简单：一个字典数组，其中每个字典由到达：值和出发：值组成。然后在任何给定时间，您迭代数组，如果：到达 < 现在 < 出发 == TRUE，则增加一个计数器。

完毕。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:55:23.833

遍历列表，测试给定时间`t`是否在当前对的到达和离开之间，如果是，则增加一个计数器。之后，您的柜台应该有正确的号码。伪代码：

```
given time T
given list of (arrival, departure) pairs L

c = 0
for each pair (A, D) in L
    if A < T and T < D
        c += 1 
```

请注意，这不是最佳解决方案...将数据存储在更适合查询的结构中将实现更有效的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T23:55:41.487

在 SQL 中？

```
SELECT count(id) FROM attendee WHERE a_time < '2013-03-01 12:12' AND (d_time > '2013-03-01 12:12' OR d_time IS NULL) 
```****

# asp.net - 如何在 MVC4 中执行此功能？

> ID：15168841
> 
> 赞同：2
> 
> 时间：2013-03-01T23:48:18.213
> 
> 标签：asp.net, ajax, asp.net-mvc, jquery

我是使用 MVC4 和 JQUERY 和 AJAX 的新手。

请观看下面的图片，其中我有一个名为 的超链接`More`。

![在此处输入图像描述](../Images/42fc1da0b434c8a7bf74a124f5f1c591.png)

该超链接应该添加另一个 input[text] 和一个单选按钮。我不知道如何实现此功能，是否必须进行 ajax 调用才能将新项目添加到`List<T>`并更新视图？还是我必须在客户端做所有事情？

我只想知道如何实现它的想法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T23:53:08.233

您可以对控制器操作使用 AJAX 调用，该操作将返回包含单行内容的局部视图。您可能会遇到几个问题。最困难的部分是为您的输入字段生成正确的名称，以便模型绑定器能够在提交表单时正确构建您的模型集合。[`naming convention`](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)你需要尊重一个具体的问题。

看看[`following article`](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)它详细解释了这一切。它还提供了一个自定义`Html.BeginCollectionItem`助手，负责为部分中的输入字段生成正确的名称，以便遵守命名约定。它使用非顺序索引名称。

# silverlight - 多个 XAP 项目的通用 png 文件

> ID：15168848
> 
> 赞同：0
> 
> 时间：2013-03-01T23:49:14.397
> 
> 标签：silverlight, windows-phone-8, xap

所以我在 Visual Studio 2012 中有 8 个不同的 Silverlight 项目，它们产生 8 个不同的 XAP 文件。每个项目都有一个包含 applicationicon.png 的“Assets”目录和一个包含更多 PNG 文件的 tiles 目录。

我只是在测试一些东西，但我想做的是让我拥有的每个不同的 XAP 项目都没有它自己需要的 PNG 文件的副本。

我该如何制作，以便所有这些项目都可以查看公共文件（例如图标）的公共目录？

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T18:07:38.507

另一种选择是创建一个公共项目而不是一个公共目录。

公共项目可以包含所有共享资产和用户控件，但它不构建自己的 XAP。在其他 XAP 项目中包含公共项目作为参考。然后，您可以使用公共项目的命名空间来引用这些公共项目。

然后所有项目都指向相同的图像文件。当您想在多个 XAP 中使用相同的用户控件时，这也很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T00:13:50.683

将文件添加到项目时，添加按钮上有一个下拉菜单，可让您链接到文件而不将其复制到项目中。这样，您就没有重复项。

[Visual Studio：添加项目/添加为链接，而不仅仅是添加](https://stackoverflow.com/questions/2593612/visual-studio-add-item-add-as-link-rather-than-just-add)

# java - JavaEE 应用程序的文档根是什么？

> ID：15168854
> 
> 赞同：3
> 
> 时间：2013-03-01T23:49:23.580
> 
> 标签：java, jakarta-ee

这是来自[Java EE6 教程](http://docs.oracle.com/javaee/6/tutorial/doc/bnadx.html)：

> Web 模块具有特定的结构。Web 模块的顶级目录是应用程序的文档根目录。文档根是 XHTML 页面、客户端类和档案以及静态 Web 资源（例如图像）的存储位置。
> 
> **文档根目录包含一个名为 WEB-INF 的子目录**，其中可以包含以下文件和目录

但是在[这里](http://www.mkyong.com/jsf2/jsf-2-0-hello-world-example/)，WEB-INF 目录似乎不是**文档根目录。**此外，当您使用 NetBeans 创建 JSF 项目时，文件夹结构将如下所示：

```
ProjectName
|
|
--src
|
|
--web
   |
   |
   --WEB-INF 
```

这意味着 web 目录又不是文档根目录？

那么哪个是正确的？

因为在 Java EE6 Tutorial 中，正文继续：

> **文档根目录包含一个名为 WEB-INF 的子目录**，其中可以包含以下文件和目录类： 包含服务器端类的目录：servlet、企业 bean 类文件、实用程序类、JavaBeanscomponents

但是根据 Netbeans 和上面的教程，服务器端类在不同的目录中？

请帮忙解决这个困惑？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T23:53:37.367

EE 规范讨论了最终战争文件的目录结构。您在问题中提出的目录结构是 IDE 如何在其项目结构中排列不同的文件。他们是两个不同的东西。

为了回答你的问题，war中的文档根目录是WEB-INF目录的父目录。不同的IDE项目结构的文件根目录不同，但大多数情况下也是WEB-INF目录的父目录。在 netbeans 的情况下，它是`web`文件夹。在标准的 Eclipse Web 项目中，它是`WebContent`目录。在 Maven 世界中，它是`src/main/webapp`目录。尽管在 IDE 中这些都是可配置的。

# c# - 将整数数组转换为枚举数组

> ID：15168855
> 
> 赞同：7
> 
> 时间：2013-03-01T23:49:29.263
> 
> 标签：c#, .net-4.0

我有一个具有 4 个值的枚举：

```
public enum DriveRates 
{ 
    driveSidereal = 0,
    driveLunar = 1, 
    driveSolar = 2, 
    driveKing = 3 
} 
```

我有一个要转换为 DriveRates 数组的值数组。但是，当我这样做时`var rates = (DriveRates[])ret;`，它`ret`是一个数字对象数组（可能是整数），它说`Unable to cast object of type 'System.Object[]' to type 'ASCOM.DeviceInterface.DriveRates[]'.`

`ret`= `{0,1,2,3}`。我应该怎么做呢。同样，我正在尝试将枚举值数组转换为枚举数组...嗯，值 :) 但我正在尝试从 type 转换`object[]`为 type `DriveRates[]`。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-01T23:52:05.863

如果它真的是一个`object[]`. 您*可以*很容易地创建一个新数组：

```
var enumArray = originalArray.Cast<DriveRates>().ToArray(); 
```

如果它*实际上是*一个`int[]`数组开始，您可以强制转换 - 尽管您必须先与 C# 编译器好好交谈：

```
using System;

class Program
{
    enum Foo
    {
        Bar = 1,
        Baz = 2
    }

    static void Main()
    {
        int[] ints = new int[] { 1, 2 };
        Foo[] foos = (Foo[]) (object) ints;
        foreach (var foo in foos)
        {
            Console.WriteLine(foo);
        }
    }
} 
```

C# 编译器不相信有从`int[]`to的转换`Foo[]`（在 C# 的规则范围内也没有）...但是 CLR 对这种转换很好，只要你能说服 C# 编译器玩沿着（通过投射到`object`第一个）很好。

当原始数组确实是一个虽然时，这*不起作用。*`object[]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:51:38.273

这是不可能的。无法在引用类型数组和值类型数组之间进行转换。您将需要手动将元素复制到新数组中

```
DriveRates[] Convert(object[] source) { 
  var dest = new DriveRates[source.Length];
  for (int i = 0; i < source.Length; i++) { 
    dest[i] = (DriveRates)source[i];
  }
  return dest;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-12T19:40:52.197

...或使用 linq，特别是如果您需要对一行中的每个元素做一些额外的事情：

```
DriveRates[] enumArray = originalArray.Select(o => (DriveRates)o).ToArray(); 
```

# c# - Windows Azure 工作者角色和 SVG

> ID：15168857
> 
> 赞同：0
> 
> 时间：2013-03-01T23:49:45.780
> 
> 标签：c#, iis, graphics, azure, svg

我想使用辅助角色在 Windows Azure 中提供图像和各种内容。我的要求之一是将 SVG 作为请求大小的 PNG 文件提供。这些 PNG 将被缓存以确保从长远来看具有最佳性能，但我确实需要将这些 SVG 尽​​快呈现在内存中。

实现这一目标的最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T10:01:42.620

试试[SVG Rendering](http://svg.codeplex.com/) Engine 开源项目。它似乎既可以生成 SVG，又可以从 SVG 生成其他文件。

# esb - ESB 基本疑问

> ID：15168864
> 
> 赞同：0
> 
> 时间：2013-03-01T23:51:10.793
> 
> 标签：esb, wso2esb

我是 ESB 的新手，我学习并尝试了代理服务，并且我能够部署我的第一个代理服务（通过代理）。

我做了几个步骤，将 wsdl 和 xsd 注册到注册表中，并使用这些详细信息来启动和运行代理。

这是部署应用程序的唯一方法还是有其他方法。

由于我有大约 50 个服务**（实际服务，使用 apache CXF 创建并部署在 apache tomcat 中）**启动并运行，我需要为此创建代理**（代理将根据输入重定向到正确的端点）。**

我应该创建什么样的代理？

我需要将所有 wsdl、xsd 一个一个注册到 wso2 服务器还是有其他方式**（例如创建存档并上传到服务器）**。

开发人员工作室中的 ESB Config 项目是什么？

[https://sites.google.com/site/samplefilesforwso2/testing.zip](https://sites.google.com/site/samplefilesforwso2/testing.zip)

请找到一个包含 2 个最简单服务的项目，我想在此服务器中部署并创建单个代理，将调用委托给此服务，如何实现？

有没有教程，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-20T06:42:53.347

在[Wso2 Developer Studio](http://wso2.com/products/developer-studio/)中，一种名为 ESB Config Project 的项目类型用于保存所有与 ESB 相关的工件，例如代理服务、端点、序列、本地条目和 Synapse 配置。要进一步参考此主题，请参阅 [1]

[1] [http://wso2.org/project/developer-studio/docs/esb_category.html](http://wso2.org/project/developer-studio/docs/esb_category.html)

# android - 如何确保没有并发的 FragmentTransaction？

> ID：15168865
> 
> 赞同：1
> 
> 时间：2013-03-01T23:51:17.600
> 
> 标签：android, android-fragments, fragmenttransaction

在我的应用程序中，我有一个`ListFragment`：

```
Fragment fragment =  new MyFragment();
FragmentManager fragmentManager = getSupportFragmentManager();
FragmentTransaction transaction = fragmentManager.beginTransaction();
transaction.replace(resId, fragment, "tag");
transaction.addToBackStack("tag");
transaction.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_OPEN);
transaction.commit(); 
```

当用户点击`Refresh`按钮时，它将刷新列表：

```
Fragment newFragment =  new MyFragment();
FragmentManager fragmentManager = getSupportFragmentManager();
FragmentTransaction transaction = fragmentManager.beginTransaction();

Fragment oldFragment = fragmentManager.findFragmentByTag(tag);
transaction.remove(oldFragment);
fragmentManager.popBackStack();

transaction.replace(resId, newFragment, "tag");
transaction.addToBackStack("tag");
transaction.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_OPEN);
transaction.commit(); 
```

所以它将从堆栈中删除旧片段并将新片段添加到其中。

问题是如果用户`Refresh`真的快速点击按钮，可能会导致覆盖问题，旧的片段不会从片段容器中删除。

我想这是一个并发问题。

如果是这样，有没有办法“锁定”事务，以便另一个事务将等到前一个事务完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T06:05:26.890

您可以在 MyFragment 类中创建一个 refreshMethod 并使用 MyFragment 的对象从 Parent 调用该方法，而不是每次用户点击刷新按钮时创建一个新的 Fragment ，如下所示：

```
Fragment fragment =  new MyFragment();
FragmentManager fragmentManager = getSupportFragmentManager();
FragmentTransaction transaction = fragmentManager.beginTransaction();
transaction.replace(resId, fragment, "tag");
transaction.addToBackStack("tag");
transaction.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_OPEN);
transaction.commit(); 
```

在刷新按钮上单击：

```
fragment.refreshList();//Create this refresh List method in you MyFragment class 
```

在您的 refreshList 方法中，您可以通知列表

```
public void refreshList(){
//update the list as per your needs
} 
```

# multithreading - UIProgressView 泄漏（WebThreadCurrentContext 和 GetContextStack）

> ID：15168868
> 
> 赞同：0
> 
> 时间：2013-03-01T23:51:34.210
> 
> 标签：multithreading, memory-leaks, ios6, uiprogressview

我正在开发一个应用程序（iPad、Xcode 4.6、iOS 6.x），它有一个模式窗口和一个在主线程上更新的 UIProgressView，一旦 UIProgressView 监视的任务完成，就会显示两个内存泄漏。如果我从代码中删除 UIProgressView 和线程调用，则不会出现泄漏。我已经使用手动创建的 UIProgressView 和 StoryBoard 中的一个进行了尝试。程序使用 ARC。

两个泄漏是 WebCore/WebThreadCurrentContext [Malloc 16 bytes] 和 UIKit/GetContextStack [Malloc 64 bytes]。

```
@interface KICreateImportFileViewController ()
...
@property (strong, nonatomic) UIProgressView *convertedRecordsProgressView;
@end

@implementation KICreateImportFileViewController
- (void)viewDidLoad
{
    [super viewDidLoad];
    ...

    // config the UIProgressView
    CGRect pFrame = CGRectMake(20, 100, 500, 9);
    self.convertedRecordsProgressView = [[UIProgressView alloc] initWithFrame:pFrame];
    self.convertedRecordsProgressView.progressViewStyle = UIProgressViewStyleDefault;
    [self.view addSubview:self.convertedRecordsProgressView];
}

- (void)viewDidAppear:(BOOL)animated
{
    // listen for a NSNotification with info regarding process from class KITestParser
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(updateProgressViewWhenNotified:)
                                                 name:@"KITestParser:Progress Updated"
                                               object:self.originalFile.testParser];

    // Begin the background process that will update the UIProgressView
    [self performSelectorInBackground:@selector(createImportFileInBackground:) withObject:nil];
}

- (void)viewWillDisappear:(BOOL)animated
{
    [[NSNotificationCenter defaultCenter] removeObserver:self];
    [super viewWillDisappear:animated];
}

#pragma mark - Notifications
-(void)updateProgressViewWhenNotified:(NSNotification *)notification
{
    NSNumber* progress = (NSNumber *)[notification.userInfo valueForKey:@"progressRatio"];
    [self updateProgressViewOnMainThread:progress];
}

#pragma mark - Private class methods
- (void)createImportFileInBackground:(id)obj
{
    // Background processes aren't automatically protected by ARC unless you wrap the function in the auto-release pool.
    @autoreleasepool {
        [self.originalFile createImportFile];
    }
}

- (void)updateProgressViewOnMainThread:(NSNumber *)progress
{
    [self performSelectorOnMainThread:@selector(updateProgressView:) withObject:progress waitUntilDone:NO];
}

- (void)updateProgressView:(NSNumber *)progress
{
    [self.convertedRecordsProgressView setProgress:[progress floatValue] animated:YES];
}

@end 
```

问题 1：从 createImportFileInBackground: 调用的所有方法是否都需要包装在 @autoreleasepool{} 中。如果是这样，这是否包括将通知发送回此类的另一个类中的方法？

问题 2：我是否遗漏了导致泄漏发生的东西？

任何帮助/建议将不胜感激。提前致谢！蒂姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:56:25.223

简单的回答：您正在使用 ARC，不用担心。

详细说明：我在我做过的每个 ARC 项目中都看到了这一点。泄漏工具将识别框架代码中的泄漏。他们真的是泄密吗？该工具是否给出误报？答：谁在乎。即使您知道它们是否是真正的泄漏，您可能拥有的最佳解决方案就是向苹果提交错误。你没有追索权，你不能采取任何行动。忘掉它。

# ios - 将 Cocos2d 集成到 UIKit App 时出现 TextureCache 错误

> ID：15168869
> 
> 赞同：1
> 
> 时间：2013-03-01T23:51:37.517
> 
> 标签：ios, uiviewcontroller, cocos2d-iphone

尝试将 Cocos2d 视图集成到 UIKit 应用程序中。我收到此错误：

```
Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Do not initialize the TextureCache before the Director' 
```

在我看来，Director 是首先被初始化的。

AppDelegate didFinishLaunching：

```
// initialize cocos2d director
    CCDirectorIOS* director = (CCDirectorIOS*)[CCDirector sharedDirector];
    director.wantsFullScreenLayout = NO;
    director.projection = kCCDirectorProjection2D;
    director.animationInterval = 1.0 / 60.0;
    director.displayStats = YES;
    [director enableRetinaDisplay:YES];

    NSArray* subviews = self.viewController.view.subviews;
    for (int i = 0; i < subviews.count; i++)
    {
        UIView* subview = [subviews objectAtIndex:i];
        if ([subview isKindOfClass:[CCGLView class]])
        {
            director.view = (CCGLView*)subview;
            break;
        }
    } 
```

视图控制器 viewDidLoad：

```
CCDirectorIOS* director = (CCDirectorIOS*)[CCDirector sharedDirector];
    if (director.runningScene == nil)
    {
        [director runWithScene:[GameLayer scene]];
    }
    [director startAnimation]; 
```

和游戏层：

```
+(id) scene {
    CCScene *scene=[CCScene node];
    CCLayer* layer=[GameLayer node];
    [scene addChild:layer];
    return scene;
}
-(id) init {
    if ((self=[super init])) {

        CCSprite *test = [CCSprite spriteWithFile:@"test.png"];
        [self addChild:test];

        CGSize size = [CCDirector sharedDirector].winSize;

        test.position = CGPointMake(size.width / 2, size.height / 2);
    }
    return self;
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T11:29:18.763

我现在看到了：在 didFinishLaunching 中，您忘记创建 CCG​​LView 实例并将其分配给 CCDirector。您的导演在没有视图的情况下运行，并且没有 OpenGL 上下文。因此无法创建纹理。

真正的问题是误导性的错误信息。

# c++ - 带有指针数组的 HDF5 结构

> ID：15168876
> 
> 赞同：6
> 
> 时间：2013-03-01T23:52:01.547
> 
> 标签：c++, dataset, allocation, hdf5

我正在尝试编写一个 HDF5 文件，其结构包含一个 int 和一个 float*

```
typedef struct s1_t {
int    a;
float *b;
} s1_t; 
```

但是，在分配 float* 并将值放入其中后，我仍然无法在 hdf5 文件中输出数据。我相信这是因为 write 函数假定复合数据类型是连续的，而动态分配的数组不会。有没有办法通过仍然使用指针数组来解决这个问题？

```
 /*
 * This example shows how to create a compound data type with an array member,
 * and write an array which has the compound data type to the file.
 */
#include "stdio.h"
#include "stdlib.h"
#include "hdf5.h"

#define FILE          "DSwith_array_member.h5"
#define DATASETNAME   "ArrayOfStructures"
#define LENGTH        10
#define RANK          1
#define ARRAY_RANK    1
#define ARRAY_DIM     3 

int
main(void)
{

    /* First structure  and dataset*/
    typedef struct s1_t {
    int    a;
    //float  b[ARRAY_DIM];
    float *b;
    } s1_t;
    s1_t       s1[LENGTH];

    hid_t      s1_tid;     /* File datatype identifier */
    hid_t      array_tid; /* Array datatype handle */
    hid_t      file, dataset, space; /* Handles */
    herr_t     status;
    hsize_t    dim[] = {LENGTH};   /* Dataspace dimensions */
    hsize_t    array_dim[] = {ARRAY_DIM};   /* Array dimensions */

    int        i, j;

    /*
     * Initialize the data
     */
    for (i = 0; i< LENGTH; i++) {
        s1[i].a = i;
        s1[i].b = (float*)calloc(ARRAY_DIM, sizeof(float));
        for (j = 0; j < ARRAY_DIM; j++) {
             s1[i].b[j] = i+j;
        }
    }

    /*
     * Create the data space.
     */
    space = H5Screate_simple(RANK, dim, NULL);

    /*
     * Create the file.
     */
    file = H5Fcreate(FILE, H5F_ACC_TRUNC, H5P_DEFAULT, H5P_DEFAULT);

    /*
     * Create the array data type. 
     */
     array_tid = H5Tarray_create(H5T_NATIVE_FLOAT, ARRAY_RANK, array_dim);

    /*
     * Create the memory data type. 
     */
    s1_tid = H5Tcreate (H5T_COMPOUND, sizeof(s1_t));
    H5Tinsert(s1_tid, "a_name", HOFFSET(s1_t, a), H5T_NATIVE_INT);
    H5Tinsert(s1_tid, "b_name", HOFFSET(s1_t, b), array_tid);

    /* 
     * Create the dataset.
     */
    dataset = H5Dcreate(file, DATASETNAME, s1_tid, space, H5P_DEFAULT, H5P_DEFAULT, H5P_DEFAULT);

    /*
     * Wtite data to the dataset; 
     */
    status = H5Dwrite(dataset, s1_tid, H5S_ALL, H5S_ALL, H5P_DEFAULT, s1);

    /*
     * Release resources
     */
    H5Tclose(s1_tid);
    H5Tclose(array_tid);
    H5Sclose(space);
    H5Dclose(dataset);
    H5Fclose(file);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-02T23:21:44.293

你说的对。将您的结构更改为

```
typedef struct s1_t {
    int   a;
    float b[ARRAY_DIM];
} s1_t; 
```

会工作，但我想你知道。

我可以看到两种解决方案：

1.  使用临时缓冲区（如上述结构的数组）进行写入。
2.  使用可变长度数组而不是数组`b_name`。

### 使用可变长度数组的示例`b_name`

```
#include "stdio.h"
#include "stdlib.h"
#include "hdf5.h"

#define FILE          "DSwith_array_member.h5"
#define DATASETNAME   "ArrayOfStructures"
#define LENGTH        10
#define RANK          1
#define ARRAY_RANK    1
#define ARRAY_DIM     3 

typedef struct s1_t {
int    a;
float *b;
} s1_t;

typedef struct s1_buffer_t {
    int   a;
    hvl_t b;
} s1_buffer_t;

int main(void)
{
    s1_t       s1[LENGTH];
    hid_t      s1_tid;                          /* File datatype identifier */
    hid_t      file, dataset, space, vlen_tid;  /* Handles */
    hsize_t    dim[] = {LENGTH};                /* Dataspace dimensions */
    int        i, j;
    s1_buffer_t s1_buffer[LENGTH];
    for (i = 0; i< LENGTH; i++) {
        s1[i].a = i;
        s1[i].b = (float*)calloc(ARRAY_DIM, sizeof(float));
        for (j = 0; j < ARRAY_DIM; j++) {
             s1[i].b[j] = i+j;
        }
    }
    space = H5Screate_simple(RANK, dim, NULL);
    file = H5Fcreate(FILE, H5F_ACC_TRUNC, H5P_DEFAULT, H5P_DEFAULT);
    vlen_tid = H5Tvlen_create(H5T_NATIVE_FLOAT);
    s1_tid = H5Tcreate(H5T_COMPOUND, sizeof(s1_buffer_t));
    H5Tinsert(s1_tid, "a_name", HOFFSET(s1_t, a), H5T_NATIVE_INT);
    H5Tinsert(s1_tid, "b_name", HOFFSET(s1_t, b), vlen_tid);
    dataset = H5Dcreate(file, DATASETNAME, s1_tid, space, H5P_DEFAULT, H5P_DEFAULT, H5P_DEFAULT);
    for (i = 0; i < LENGTH; ++i)
    {
        s1_buffer[i].a = s1[i].a;
        s1_buffer[i].b.len = ARRAY_DIM;
        s1_buffer[i].b.p = s1[i].b;
    }
    H5Dwrite(dataset, s1_tid, H5S_ALL, H5S_ALL, H5P_DEFAULT, s1_buffer);
    H5Tclose(s1_tid);
    H5Tclose(vlen_tid);
    H5Sclose(space);
    H5Dclose(dataset);
    H5Fclose(file);
    return 0;
} 
```

如您所见，您仍然需要一个临时缓冲区，但至少它只需要存储指针（`b`来自 的指针）而不是像上面的解决方案 1 那样`s1`大小的数组。`ARRAY_DIM`

# c++ - 向量上的唯一排列

> ID：15168877
> 
> 赞同：0
> 
> 时间：2013-03-01T23:52:02.500
> 
> 标签：c++, algorithm, stl, permutation

我需要在一个向量中采用 3 个元素的所有可能的唯一组合。 `std::next_permutation`有效，但它给了我很多重复。

例如

(1, 2, 3, 4, 5) 和 (1, 2, 3, 5, 4)

我采用的前 3 个元素是相等的，所以我在做多余的工作。是否有任何有效的方法来迭代独特的组合？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-02T00:12:32.823

首先，您必须计算出可以从*b*个对象中挑选出的*k*个对象组合的数量*N。*

 **## N = 乙！/ (b - k)！

接下来，您通过遍历初始列表并用所有这些组合总共填充 N 个容器来找到所有组合。**

# c# - 如何为 Winform C# 应用程序实现密码恢复

> ID：15168881
> 
> 赞同：-6
> 
> 时间：2013-03-01T23:52:18.103
> 
> 标签：c#, passwords

我有一个完全基于 Windows 的 C# 编写的 Winform 应用程序。它没有任何网络模块，我也没有注册任何网络域名。该软件已完成，但现在我需要合并另一个称为密​​码恢复的功能。我是这个东西的新手，所以请帮助我。我不想坚持下去。我只是希望如果用户忘记了密码，他所做的就是按下“忘记密码？” 登录屏幕上的超链接和密码应该在他的电子邮件帐户中通过电子邮件发送给他。如何实现此功能？请给出一个代码示例，考虑到我的电子邮件是“source@gmail.com”，目标电子邮件是“destination@gmail.com”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T00:49:50.633

正如 user1932945 所说，您永远不应该存储实际密码。相反，您应该散列他们的密码，在密码末尾添加一个随机生成的数字（您的密钥）。然后散列新密码。最后，将散列密码与密钥一起存储。然后，当他们登录时，您获取他们的密码并从存储它的任何地方获取密钥，再次将其添加到密码中，对其进行哈希处理，然后将其与您存储的哈希密码进行比较。

当他们忘记密码时，您应该通过电子邮件向他们发送重置密码的方法。当他们重置它时，您按照我已经提到的步骤来存储新密码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T00:40:11.743

您永远不应该通过电子邮件将密码发送给某人。这意味着您正在存储密码，您永远不应该这样做。相反，您应该允许用户重置他们的密码。

这样做的方法是通过电子邮件发送一个代码，该代码将触发 winform 应用程序中的密码重置。重置代码可以是 winform 应用程序根据请求生成的 guid，并存储在内存中，直到收到电子邮件。

# ruby-on-rails - Net::SMTPServerBusy 中继访问被拒绝 Mailjet

> ID：15168883
> 
> 赞同：2
> 
> 时间：2013-03-01T23:52:28.880
> 
> 标签：ruby-on-rails, email, smtp, environment-variables, mailjet

尝试从生产服务器发送 Mailjet 电子邮件时收到此错误：

```
Net::SMTPServerBusy (454 4.7.1 <email@example.com>: Relay access denied
) 
```

这是我的`config/initializers/mail.rb`文件：

```
ActionMailer::Base.delivery_method = :smtp
ActionMailer::Base.smtp_settings = {
:address        => 'in.mailjet.com',
:enable_starttls_auto => true,
:port           => 587,
:authentication => :plain,
:user_name      => ENV['MAILJET_USERNAME'],
:password       => ENV['MAILJET_PASSWORD'],
:domain         => 'example.com'
} 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T11:01:10.243

感谢您使用 Mailjet！

在继续之前，我想和你确认一件事。

正在谈论使用：

1.  **API**密钥为MAILJET_USERNAME **？**
2.  **API****机密**为MAILJET_PASSWORD ？

我们的一些用户将它们与登录名和密码混合在一起。密钥和机密可以在您的帐户中的 REST API 部分下找到。

# ruby-on-rails - 丢失宝石和捆绑器冲突的情况

> ID：15168890
> 
> 赞同：1
> 
> 时间：2013-03-01T23:53:00.160
> 
> 标签：ruby-on-rails, ruby, gem, bundler

在我的 rails 应用程序目录之外，`bundle install _a_gem_`当我的意思是`gem install _a_gem`. 已经好几个小时了。在此之后，我无法让我的环境正常工作。在我的应用程序内部运行`gem list`只给了我后来安装的_a_gem_。在我的应用程序之外运行`gem list`会为我提供我想要的 gem 列表以及我最初与该应用程序一起使用的那些。

(o) 应用程序目录外 (i) 应用程序目录内

哪个宝石

```
/Users/name/.rvm/rubies/ruby-1.9.2-p290/bin/gem   (o)
/Users/name/.rvm/rubies/ruby-1.9.2-p290/bin/gem   (i) 
```

哪个irb

```
/Users/name/.rvm/rubies/ruby-1.9.2-p290/bin/irb   (o)
/Users/name/.rvm/rubies/ruby-1.9.2-p290/bin/irb   (i)

bundle install (o)
Could not locate Gemfile 

bundle install (i)
/Users/...rubygems/dependency.rb:247:in `to_specs': Could not find bundler (>= 0) amongst [spreadsheet-0.8.2] (Gem::LoadError) 
```

gem list (o) has all gems (i) has just _a_gem_ from my rails app.

gems/bundler 命令在应用程序目录内的任何地方都可以正常工作。我尝试重新安装捆绑器但发生冲突：

（一世）

```
/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1603:in    `raise_if_conflicts': can't activate bundler-1.3.0, already activated bundler-1.0.21 (Gem::LoadError) 
```

任何帮助是极大的赞赏。谢谢你。

额外：当我`gem install bundler`尝试使用捆绑器命令时的跟踪，例如`bundle install`

```
/Users/name/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1603:in `raise_if_conflicts': can't activate bundler-1.3.0, already activated bundler-1.0.21 (Gem::LoadError)
from /Users/name/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:738:in `activate'
from /Users/name/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems.rb:1211:in `gem'
from /Users/name/.rvm/gems/ruby-1.9.2-p290/bin/bundle:18:in `<main>' 
```

更新：`gem env`目录内外的输出

[https://gist.github.com/yuric/5069049](https://gist.github.com/yuric/5069049)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T01:35:21.667

我发现这组说明对于解决捆绑程序问题非常有用：

```
# remove user-specific gems and git repos
rm -rf ~/.bundle/ ~/.gem/

# remove system-wide git repos and git checkouts
rm -rf $GEM_HOME/bundler/ $GEM_HOME/cache/bundler/

# remove project-specific settings and git repos
rm -rf .bundle/

# remove project-specific cached .gem files
rm -rf vendor/cache/

# remove the saved resolve of the Gemfile
rm -rf Gemfile.lock

# try to install one more time
bundle install 
```

这是我在 github 上遇到这些的原始页面的链接。他们通常会为我解决捆绑程序问题。

[https://github.com/carlhuda/bundler/blob/1-0-stable/ISSUES.md](https://github.com/carlhuda/bundler/blob/1-0-stable/ISSUES.md)

# facebook - 新应用注册

> ID：15168892
> 
> 赞同：0
> 
> 时间：2013-03-01T23:53:05.513
> 
> 标签：facebook

我正在尝试为 facebook 创建一个新应用程序，我正在使用我的真实帐户。但我在此页面上没有“新应用”按钮[https://developers.facebook.com/](https://developers.facebook.com/)

我试图在设置页面上设置我的公司资料，但强验证并没有让我有机会输入我的 patpal 帐户详细信息。

它说我必须输入有效的贝宝电子邮件.... 这是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T00:50:13.980

您应该能够通过[https://developers.facebook.com/apps创建一个应用程序](https://developers.facebook.com/apps)

至于贝宝电子邮件，您可以在以下网址注册贝宝：www.paypal.com

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T05:38:00.337

天啊！我做到了。

重点是创建我的页面（页面底部的链接）。之后，用于创建新应用的链接变得可见。

# scala - 具有按名称调用参数的函数文字

> ID：15168897
> 
> 赞同：10
> 
> 时间：2013-03-01T23:53:27.977
> 
> 标签：scala

如何在scala中定义一个带有名称调用参数的匿名函数？

我尝试了以下方法：

```
val fun = (x: Boolean, y: =>Int) => if(x) y else 0 
```

这适用于按值调用 y，但不适用于按名称调用。为什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-02T00:33:18.030

可以这样做，但方式略有不同：将类型与参数分开声明：

```
val fun: (Boolean, => Int) => Int = (x, y) => if (x) y else 0 
```

# android - 将 onClickListener 添加到 ListView 中的按钮时出现 NullPointerException

> ID：15168903
> 
> 赞同：1
> 
> 时间：2013-03-01T23:54:26.140
> 
> 标签：android, button, nullpointerexception

我想知道是否有人可以帮助我。我的应用程序中基本上有一个列表视图，它从 lastFM 中提取数据。该行本身链接到艺术家曲目页面，按钮链接到艺术家页面。添加. `NullPointer`_ `artistButton.setOnClickListener(this)`有人可以帮助我吗，这实际上是我需要实现的最后一个功能，我很难过。

在此先感谢所有可以提供帮助的人:)

```
public class TrackDataAdapter extends BaseAdapter implements OnClickListener  {

private static final String debugTag = "TrackDataAdapter";

private Activity activity;
private ArrayList<TrackData> data;
private static LayoutInflater inflater=null;
public ImageLoader imageLoader; 

public TrackDataAdapter (TrackActivity a, ArrayList<TrackData> d)
{
    activity = a;
    data = d;
    inflater = (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    imageLoader = new ImageLoader(activity.getApplicationContext());
}

public int getCount() {
    return data.size();
}

public Object getItem(int position) {
    return position;
}

public long getItemId(int position) {
    return position;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View vi=convertView;
    if(convertView==null)
    vi = inflater.inflate(R.layout.trackrow, null);

    TextView artistName=(TextView)vi.findViewById(R.id.artist_name);
    ImageView image=(ImageView)vi.findViewById(R.id.album_icon);
    TextView trackName=(TextView)vi.findViewById(R.id.track_name);
    Button artistButton = (Button)vi.findViewById(R.id.track_button);
    artistName.setText(data.get(position).getArtist());
    trackName.setText(data.get(position).getName());
    imageLoader.DisplayImage(data.get(position).getImageUrl(), image);
    vi.setId(position);
    vi.setOnClickListener(this);
    artistButton.setOnClickListener(this);

    return vi;
}

@Override
public void onClick(View v) {
    Log.d("OnClick", "button clicked");
    if (v instanceof Button) {
        Log.d("OnClick" , "Instance of button type");
        Intent intent = new Intent(android.content.Intent.ACTION_VIEW,
                Uri.parse(data.get(v.getId()).getArtistUrl()));
        this.activity.startActivity(intent);
    }
    else if (v instanceof View) {
        Log.d("OnClick" , "Instance of button type");
        Intent intent = new Intent(android.content.Intent.ACTION_VIEW,
                Uri.parse(data.get(v.getId()).getTrackUrl()));
        this.activity.startActivity(intent);
    }
}    
} 
```

这是我的 trackrow.xml

```
 <?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/background"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/rowselector"
    android:orientation="horizontal" >

    <RelativeLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerVertical="true"
        android:paddingLeft="4dp" >

        <ImageView
            android:id="@+id/album_icon"
            android:layout_width="32dip"
            android:layout_height="32dip"
            android:layout_alignParentLeft="true"
            android:layout_centerVertical="true"
            android:scaleType="fitXY"
            android:src="@drawable/blank" >
        </ImageView>

        <TextView
            android:id="@+id/track_name"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="4dip"
            android:layout_toRightOf="@+id/album_icon"
            android:shadowColor="@color/black"
            android:shadowDx="0"
            android:shadowDy="0"
            android:shadowRadius="0.5"
            android:textColor="#777777"
            android:textStyle="bold" >
        </TextView>

        <TextView
            android:id="@+id/artist_name"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@id/track_name"
            android:layout_marginLeft="4dip"
            android:layout_toRightOf="@+id/album_icon"
            android:text="Best Badger: " >
        </TextView>

    <Button
        android:id="@+id/track_button"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:layout_alignParentRight="true"
        android:layout_centerVertical="true"
        android:text="Artist" >
    </Button>

    </RelativeLayout>
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:57:43.803

要查看的行是这样的：

```
Button artistButton = (Button)vi.findViewById(R.id.track_button); 
```

在此行之后，artistButton 似乎为空。您尝试获取的视图是否有效 (R.id.track_button) ？

# ios - AngularJS ng-include 模板未在 Phonegap 应用程序中加载

> ID：15168908
> 
> 赞同：2
> 
> 时间：2013-03-01T23:55:34.983
> 
> 标签：ios, cordova, include, angularjs

我正在构建一个使用 AngularJS 的 iOS Phonegap 应用程序。

我有一些`ng-includes`里面的`ng-switch`东西，可以根据项目的类别改变一些列表项目的样式。

```
 <div 
            ng-repeat="i indata"
            ng-include="src='partials/card.html'""
        >
        </div> 
```

在*partials/card.html*文件中，是开关：

```
<div 
ng-switch on="i.group"
>
<div ng-switch-when="Music">
    <div ng-include="src='partials/card_details/'+i.category+'.html'"
    ></div>
</div>  
<div ng-switch-when="Film"
    ng-include="src='partials/card_details/buy.html'"></div>        
<!-- default, load group -->
<div ng-switch-default ng-include="src='partials/card_details/'+i.group+'.html'"
></div> 
```

这一切都在我的桌面浏览器上的 Chrome 中完美运行，但是当我运行我的 Phonegap 应用程序时，使用与 Chrome 中运行的页面相同的符号链接 www 文件夹，*除了*switch 语句中的部分内容外，所有内容都会加载。

我在 Xcode 控制台中没有收到任何错误，我尝试将“/”添加到*src*的开头，因为我在 Phonegap 中的根路径存在问题，但我不明白为什么*partials/card.html*加载而*不是**partials/card_details*

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T10:49:52.047

这是因为下面一行中的 ng-include 在其末尾有双引号：

```
 <div 
        ng-repeat="i indata"
        ng-include="src='partials/card.html'""
    >
    </div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-20T11:35:57.027

Try removing the _ (underscore) from the file names. I remember seeing a hint about this.

```
<div ng-include="src='partials/cardDetails/'+i.category+'.html'"></div> 
```

instead of

```
<div ng-include="src='partials/card_details/'+i.category+'.html'"></div> 
```

EDIT:

I have also discovered that ng-include is case sensitive when it comes to file names.

# ios - 后台删除和 UITableView 滚动删除行

> ID：15168913
> 
> 赞同：1
> 
> 时间：2013-03-01T23:55:56.397
> 
> 标签：ios, uitableview, core-data, background

我有一个后台 ping 到一个服务器，它会拉一些 xml 并更新我的上下文。在前端，我也可以编辑托管对象。我对它进行了压力测试，并且工作正常，没有死锁等。

当我在后台从服务器获取中删除一行时，`UITableView`当我滚动到该数据时，会发生崩溃。用于此表的数组不是空的，但在删除的行中以某种方式为空。

使用 Core Data 删除行时有什么具体方法吗？这只是从删除到保存操作的一瞬间的问题 - 如果用户在已删除行所在的位置滚动 tableview。

# ruby-on-rails - rails server 命令不起作用，并且在另一个版本的 ruby 上没有 gem

> ID：15168917
> 
> 赞同：1
> 
> 时间：2013-03-01T23:56:17.650
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, pik

我在 Windows 7 机器上运行 rails 并使用 pik 作为我的 RVM。

我目前安装了 ruby​​ 1.9.3，但我有一个需要 ruby​​ 1.9.2 的项目。

所以使用 pik，我从以下位置运行这些命令`gitbash`：

1.  `pik 192`
2.  `ruby -v`

> 红宝石 1.9.2p180 (2011-02-18) [i386-mingw32]

1.  `rails server`

> sh.exe": rails: 找不到命令

但是，当我使用 pik 193 时，我绝对可以看到服务器正在运行。在 pik 192 下运行 gem list 也不显示任何本地 gem，而 pik 193 显示了很多。

我如何在这 2 个版本之间“共享”宝石，或者是否有更好的选择，风险更小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T00:23:44.547

要跨安装共享 gem，您需要将 gem 安装在两个安装的公共位置。

默认情况下，Windows 上的 Ruby 会在 Ruby 目录中安装 gem。

您可以通过以下方式验证这一点：

```
gem env gemdir 
```

要在两个解释器的公共位置安装，您需要将`GEM_HOME`环境变量设置为特定目录，例如`C:\gems`

```
SET GEM_HOME=C:\gems
gem env gemdir 
```

您还需要将`bin`目录添加到`PATH`：

```
SET PATH=C:\gems\bin;%PATH% 
```

这将允许 gems 可执行文件可用。

但是，请注意，尽管 Ruby 1.9.2 和 1.9.3 声明它们是兼容的，但对于作为某些 gem 一部分的已编译 C 扩展，可能并非如此。

Ruby 1.9.3 引入了某些 API 级函数，这些函数在 1.9.2 中不可用，并且在 Ruby 1.9.2 中加载 1.9.3 编译的 gem 时可能会导致问题

在某些情况下，这些差异可能会导致分段错误和奇怪的应用程序崩溃。

不建议使用，因此使用风险自负。

希望有帮助。

# r - 无法在 ArcGIS 中打开通过 R 生成的大型 (3Gb) gri 栅格图层

> ID：15168919
> 
> 赞同：2
> 
> 时间：2013-03-01T23:56:43.257
> 
> 标签：r, arcgis, raster

我正在尝试使用 ArcGIS 打开带有 .grd/gri 扩展名的栅格图层地图，但 ArcGIS 一直说它是无效的栅格图层并且没有打开它。我正在尝试将其转换为 .asc 以查看 ArcMap 是否可以打开它，但我不知道该怎么做。

关于如何在 ArcMap 中打开该文件的任何其他想法？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T00:30:01.610

Arcgis 不能很好地操作 grd 文件。使用 raster 包并将其保存为您想要的任何其他地理参考格式：

```
writeRaster(raster_name, output_filename, format="ascii", overwrite=TRUE) 
```

由于您提到您的图像相当大，您可以考虑使用函数参数'datatype'来设置存储数据的最有效方式（例如，栅格的datatype='INT1U'只有0到255之间的整数值） . 如果合适的话，这可以显着减小图像的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T05:07:35.347

在 R 中，您还可以执行以下操作：

```
library(raster)
r <- raster('filename.grd')
hdr(r, 'VRT') 
```

现在在 ArcGIS 中打开 VRT（头文件）

# java - 如果我在 java 中对同一个对象调用两次 new 会发生什么？

> ID：15168922
> 
> 赞同：-1
> 
> 时间：2013-03-01T23:57:25.363
> 
> 标签：java, object

所以说我有一些像这样的测试java代码：

```
class A(){
       int a = 0;
       public A{
             a = 1;
       }
 class B(){
       A object = new A(); //Object one
       A object = new A(); //Object two 
```

我的问题是：在 A 类中，当我在对象上调用 new 运算符两次时会发生什么？它会创建一个新对象 A 并销毁旧对象吗？还是会出错？它只是重置旧对象吗？

我已经尝试了几次，并不太了解输出。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T00:00:47.650

这是第二个`A`对象。

第一个将很快被垃圾收集。

请注意，您也可以这样做

```
new A();
new A(); 
```

而不将它们存储在变量中。这是完全有效的，将被执行。

另请注意

```
A obj1 = new A();
A obj2 = obj1; 
```

不复制对象，*但*它是对同一对象的引用。显然，您也可以有 0 个引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T00:00:28.733

我不相信这会编译。

但是如果问题是当我两次调用构造函数时会发生什么，答案是你得到了这个类的两个实例：

```
class A {
    int a = 0;

    public A(int input) {
        a = input;
    }
}

class B {
    A object1 = new A(1); //Object one
    A object2 = new A(2); //Object two
    A object3 = object2;
    //object1 != object2

    public B(){
        A a = new A(3);
        a = new A(4); // a points at the last A defined

        System.out.println(object1.a); //prints 1
        System.out.println(object2.a); //prints 2
        System.out.println(object3.a); //prints 2
        System.out.println(a.a); //prints 4
    }
} 
```

此外，如果您`a = new A();`再次调用，先前的 a 实例将被标记为垃圾回收，并将 a 分配给新的 A()

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T00:15:47.617

我真的不明白您在这里要做什么，并且您的代码无法编译。我在下面创建了一个带有注释的代码的工作示例。

这回答了你的问题了吗？

```
public class Main {
    //Test method to instantiate a new B
    public static void main(String[] args) {
       B b = new B();
    }
}

class A {
      int a = 0;
        public A() {
         a =1;
        }
}

class B {

    public B() {
        A a = new A();
        //Print first object reference
        System.out.println("First object reference assigned to a: " + a.toString());

        //You cannot instantiate the same field/variable twice.
        // However, you can change the object reference as below
        a = new A();

        //Print second object reference
        System.out.println("Second object reference assigned to a: " + a.toString());

        //As you can see, the object
        // reference points at the new Instance of A when creating a
        // new instance of A and assigning the reference to field a

    }

} 
```

如果您运行它，您的输出将如下所示：

```
First object reference assigned to a: A@750159
Second object reference assigned to a: A@1abab88 
```

# templates - GCC(/Clang)：合并具有相同指令的函数（COMDAT 折叠）

> ID：15168924
> 
> 赞同：28
> 
> 时间：2013-03-01T23:57:34.390
> 
> 标签：templates, gcc, linker, clang, compiler-optimization

只是好奇，GCC 或 Clang 工具集目前是否实现了与 MSVC[相同的 COMDAT 折叠](http://msdn.microsoft.com/en-us/library/bxwfs976(v=vs.80).aspx)(ICF) 等效的功能？如果没有，有什么计划吗？除了旧的 GCC 邮件列表消息之外，我似乎找不到任何关于该主题的最新权威链接。

如果不是，这是否意味着不同类型上的模板实例化始终是生成的二进制文件中的不同函数（在它们未完全内联的情况下），即使它们是二进制兼容的，或者是否有其他机制来处理这个在其他级别？

另外，有没有人发现 ICF 在实践中最小化生成的可执行文件的大小有很大的不同？我没有任何大型 MSVC 项目可以方便地对其进行测试。（我猜它只有在你碰巧在许多不同的 vtable-layout 兼容类型上实例化模板时才真正有帮助。）

最后，两个指向不同函数的函数指针在运行时比较相等是否符合 C++11 标准？[这个链接](http://gcc.gnu.org/ml/gcc/2003-06/msg01283.html)似乎暗示它不是，但它适用于 C99。编辑：[找到有关此主题的先前问题](https://stackoverflow.com/questions/14188612/is-an-implementation-allowed-to-site-two-identical-function-definitions-at-the-s)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-02T00:15:14.213

GCC 和 Clang 都不是链接器，ICF 需要由链接器完成，或者至少需要与链接器合作。编辑：~~他们不做 ICF，所以是的，不同的实例化产生不同的代码。~~GNU`gold`链接器通过选项支持 ICF，该`--icf`选项需要使用 GCC 选项`-ffunction-sections`。

不同的函数必须有不同的地址......我不记得是否为任何获取其地址的函数禁用了 ICF，但如果不是，应该可以在组合函数之前放置大量无操作指令并使每个不同的实例化从不同的指令开始，因此它们具有不同的地址。编辑：gold 的`--icf=safe`选项仅对可以证明其地址未被占用的函数启用 ICF，因此依赖于不同地址的代码仍然可以工作。

ICF 是一种巧妙的优化，但不是必需的。通过一些努力，您可以将非依赖代码提升到非模板或具有较少参数的模板，以减少可执行文件中重复代码的数量。在我几年前做的[饮食模板](http://accu.org/index.php/conferences/accu_conference_2011/accu2011_sessions#Diet%20Templates)演讲的幻灯片中有更多信息。

# javascript - 函数声明不能 出现在条件语句中吗？

> ID：15168928
> 
> 赞同：5
> 
> 时间：2013-03-01T23:57:54.050
> 
> 标签：javascript

嗨，我是 Javascript 新手，我正在阅读 Oreilly 的 Javascript 权威指南。在声明声明部分它说：

![在此处输入图像描述](../Images/18fafd5e8db7fcb0dcd110e032768d48.png)

我做了一个简单的测试：

```
var a = 1;
while(a < 5){
    a++;
    function double(a){return a * 2 };
    console.log(double(a));
} 
```

似乎 node.js 没有给我任何错误并按预期运行。对此有何评论？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-02T00:16:10.690

这不是真的。但是，您应该记住，它们的行为可能与您预期的不同。

例如，这将起作用：

```
if( false) {
    function double(a) {return a*2;};
}
else {
    console.log(double(4));
} 
```

即使您可能认为由于`if`位于永远无法到达的内部而从未定义过该函数，但实际上该函数已提升到当前“块”的顶部（无论是包含函数还是整个`<script>`标签或文件）并且是因此可以在任何地方访问。

您*不应该*将`function`定义放在`if`块内，但没有理由不能这样做。

# php - SQLSTATE[42000] 关于 PHP/MySQL 和 CakePHP 中的 Haversine 公式

> ID：15168930
> 
> 赞同：0
> 
> 时间：2013-03-01T23:58:08.143
> 
> 标签：php, mysql, cakephp, haversine, geopoints

我只是在测试从 Google Developers 获取的 Haversine 公式：[https ://developers.google.com/maps/articles/phpsqlsearch_v3#findnearsql](https://developers.google.com/maps/articles/phpsqlsearch_v3#findnearsql)

我已将代码段放入我的代码中，它给了我一个 SQL 错误。

这是我在 CakePHP 中的模型：

```
<?php

App::uses('AppModel', 'Model');
class LocationModel extends Model {

    public $name = 'Location';

    public function getNearest()
    {
        $this->Location->query("SELECT id, ( 3959 * acos( cos( radians(37) ) * cos( radians( lat ) ) * cos( radians( long ) - radians(-122) ) + sin( radians(37) ) * sin( radians( lat ) ) ) ) AS distance FROM locations HAVING distance < 25 ORDER BY distance LIMIT 0 , 20";);
    }   
} 
```

我从字面上复制并粘贴了代码并将其放入查询函数中。我不认为这与我的数据库或其他任何东西有关，而是 SQL 中的语法错误，但我看不到它。它有什么问题？

这是错误：

```
Error: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'getNearest' at line 1 
```

# css - 绝对位置中的绝对位置

> ID：15168932
> 
> 赞同：-2
> 
> 时间：2013-03-01T23:58:19.037
> 
> 标签：css

我有一个网站要从以前的设计中更新，我注意到一些我不满意的地方。

通常我将绝对定位的元素定位在相对定位的父级中。但是在这个站点中，它在绝对定位的父级中有一个绝对定位的元素。展示位置运行良好。但我想确定这是否 100% OK。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T00:02:50.500

我看不出有什么问题。

`position: relative`表示元素将*相对*于其当前位置定位。

`position: absolute`表示该元素将使用 或 相对于第一个父*元素* `position: relative` **定位** `position: absolute`。

所以请注意这个概念的措辞：一个元素绝对定位为另一个绝对定位元素的子元素，*相*对于其父元素定位，而不是相对于其*相对定位*的祖父元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T00:01:36.403

假设您了解定位的工作原理并且您的元素按照您希望的方式定位：

**是的，你正在做的很好。**浏览器应该统一显示它，并且规范暗示它[在绝对定位部分是可以接受的。](http://www.w3.org/TR/css3-positioning/#absolute-positioning)

# r - 在 R 中将 m 数据帧转换为 1 x n*m 数据帧

> ID：15168936
> 
> 赞同：3
> 
> 时间：2013-03-01T23:59:24.407
> 
> 标签：r, dataframe, transpose

我有一个我称之为“d”的数据框，格式如下：

```
 Date   Jan  Feb  Mar  Apr  May  Jun  Jul  Aug  Sep  Oct   Nov  Dec
        1 1895 12.63 2.47 2.69 2.43 3.10 1.65 0.13 0.24 1.78 0.18  3.32 7.78
        2 1896 13.08 3.86 5.14 5.91 1.61 0.10 0.00 0.05 0.44 3.76  9.51 8.71
        3 1897  4.10 7.16 6.38 0.85 0.47 0.87 0.00 0.00 0.46 2.51  5.27 3.40
        4 1898  1.97 6.14 0.29 0.30 2.40 0.49 0.00 0.00 1.10 1.32  2.40 2.11
        5 1899  7.61 2.69 8.12 1.56 1.66 0.75 0.00 0.18 0.31 7.87 10.79 5.20
        6 1900  8.68 2.44 3.53 1.75 2.95 0.33 0.00 0.25 0.60 5.69  9.38 5.00 
```

我想改写成如下形式

```
 Date               Precip
        1 1895-01-01       12.63 
        2 1895-02-01        2.47 
        3 1895-03-01        2.69 
        4 1895-04-01        2.43

         ...

        70 1900-10-01       5.69
        71 1900-11-01       9.38 
        72 1900-12-01       5.00 
```

我能想到的唯一方法是创建一个新的数据框，其中包含从开始到结束的日期序列，然后使用 rbind 将数据框“d”的行连接到新的数据框。在不使用 for 循环的情况下，有没有更简洁的方法？感谢您的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-02T00:13:59.147

我使用`stack`和`as.Date`

```
dat.l <- data.frame(dat[,1],stack(dat[,-1]))
dat <- data.frame(Date =as.Date(paste(dat.l[,1],dat.l[,3],'01',sep='/'),format='%Y/%b/%d'),
           Precip= dat.l[,2])

          Date Precip
1  1895-01-01  12.63
2  1896-01-01  13.08
3  1897-01-01   4.10
.....

70 1898-12-01   2.11
71 1899-12-01   5.20
72 1900-12-01   5.00 
```

我注意到我的数据没有按照我在每个日期订购的顺序排列：

```
 dat[order(dat$Date),]
             Date Precip
    1  1895-01-01  12.63
    7  1895-02-01   2.47
    13 1895-03-01   2.69
    19 1895-04-01   2.43
    25 1895-05-01   3.10
    31 1895-06-01   1.65 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-02T00:07:50.600

我没有从您建议的日期策略开始的 for 循环就做到了。

```
df2 <- data.frame(Date = seq.Date(as.Date("1895-01-01"), 
                                   as.Date("1900-12-01"),
                                   by="month"),
                   Precip =c(t(data.matrix(dfrm[-1]) ) ))
head(df2)
        Date Precip
1 1895-01-01  12.63
2 1895-02-01   2.47
3 1895-03-01   2.69
4 1895-04-01   2.43
5 1895-05-01   3.10
6 1895-06-01   1.65 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-02T00:29:30.127

您可能想在这里处理时间序列对象：

```
 x <- c(12.63, 2.47, 2.69, 2.43, 3.1, 1.65, 0.13, 0.24, 1.78, 0.18, 
3.32, 7.78, 13.08, 3.86, 5.14, 5.91, 1.61, 0.1, 0, 0.05, 0.44, 
3.76, 9.51, 8.71, 4.1, 7.16, 6.38, 0.85, 0.47, 0.87, 0, 0, 0.46, 
2.51, 5.27, 3.4, 1.97, 6.14, 0.29, 0.3, 2.4, 0.49, 0, 0, 1.1, 
1.32, 2.4, 2.11, 7.61, 2.69, 8.12, 1.56, 1.66, 0.75, 0, 0.18, 
0.31, 7.87, 10.79, 5.2, 8.68, 2.44, 3.53, 1.75, 2.95, 0.33, 0, 
0.25, 0.6, 5.69, 9.38, 5)
x.ts <- ts(x, frequency=12, start=(1895))

x.ts
##        Jan   Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct   Nov   Dec
## 1895 12.63  2.47  2.69  2.43  3.10  1.65  0.13  0.24  1.78  0.18  3.32  7.78
## 1896 13.08  3.86  5.14  5.91  1.61  0.10  0.00  0.05  0.44  3.76  9.51  8.71
## 1897  4.10  7.16  6.38  0.85  0.47  0.87  0.00  0.00  0.46  2.51  5.27  3.40
## 1898  1.97  6.14  0.29  0.30  2.40  0.49  0.00  0.00  1.10  1.32  2.40  2.11
## 1899  7.61  2.69  8.12  1.56  1.66  0.75  0.00  0.18  0.31  7.87 10.79  5.20
## 1900  8.68  2.44  3.53  1.75  2.95  0.33  0.00  0.25  0.60  5.69  9.38  5.00 
```

然后`xts`将其格式化为您想要的格式（以及可以使用时间序列完成的其他事情）：

```
head(as.xts(x.ts))
##           [,1]
## Jan 1895 12.63
## Feb 1895  2.47
## Mar 1895  2.69
## Apr 1895  2.43
## May 1895  3.10
## Jun 1895  1.65 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-02T00:35:21.713

使用的解决方案`data.table`：

```
require(data.table)
dt <- data.table(dat, key="Date")
dt.out <- dt[, list(Date_01 = as.Date(paste(Date, 1:12, "01", sep="/")), 
        Precip = unlist(.SD)), by=Date][, Date := NULL]
setnames(dt.out, "Date_01", "Date") 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-02T00:06:45.260

是的，查看包`melt`中的功能`reshape2`。这实际上非常简单。在这里阅读更多：http: [//www.jstatsoft.org/v21/i12/paper](http://www.jstatsoft.org/v21/i12/paper)

你会这样做：

```
install.packages("reshape2")
library(reshape2)
melt(DF, id="Date", measured=c(2:13)) 
```

# php - 数组不存储表单中的数据

> ID：15168938
> 
> 赞同：0
> 
> 时间：2013-03-01T23:59:49.073
> 
> 标签：php, html, mysql

我正在创建一个用户设置页面，允许成员更新他们的信息。信息显示，但是一旦更改不会在数据库上更新，尽管没有产生错误并显示成功页面。我试过回显数组，它似乎是空白的，这意味着它没有解析任何新数据。

```
<?php
include ("storescripts/init.php");
protect_page();
if (empty($_POST) === false) {
$required_fields = array('mem_email','mem_first_name','mem_last_name');
foreach ($_POST as $key=>$value) {
    if (empty($value) && in_array($key, $required_fields) == true) {
        $errors[] = 'Fields marked with an asterisk are required';
        break 1;
    }
}
if (empty($errors) === true) {
    if (filter_var($_POST['mem_email'], FILTER_VALIDATE_EMAIL) === false) {
        $errors[] = 'A valid email address is required';
    } else if(user_exists($_POST['mem_email']) === 1 && $member_data['mem_email'] !== $_POST['mem_email']) {
        $errors[] = 'Sorry, the email \'' . htmlentities($_POST['mem_email']) . '\' is already in use';
    }
}
}
if (empty($_POST) === false && empty($errors) === true) {

$update_data = array(
        'mem_first_name' => $_POST['mem_first_name'],
        'mem_last_name' => $_POST['mem_last_name'],
        'mem_email' => $_POST['mem_email'],
        'allow_email' => ($_POST['allow_email']) ? 1 : 0);

        update_user($session_member_id, $update_data);
        header('Location: settings.php?success=1');
        die();
}
include ("includes/overall/head.php");
?>
<?php include ("includes/overall/template_header.php");?>
<div id="mainDivShort">
    <h1>User Settings</h1>
    <div id="divBreak"></div>
    <?php include ("includes/overall/column_left.php");?>
    <div id="middleContent">
    <?php if (isset($_GET['success']) && isset($_GET['success'])) {
            echo 'Your details have been updated';
            } else {
                if (empty($errors) === false) {
                echo output_errors($errors);
                }?>
        <form action="" method="post">
            <ul>
                <li>First Name*: <br> <input type="text"    name="mem_first_name"
                    value="<?php echo  $member_data['mem_first_name'];?>">
                </li>
                <li>Last Name*: <br> <input type="text"  name="mem_last_name"
                    value="<?php echo  $member_data['mem_last_name'];?>">
                </li>
                <li>Email*: <br> <input type="text" name="mem_email"
                    value="<?php echo $member_data['mem_email'];? >">
                </li>
                <li>
                    <input type="checkbox" name="allow_email" <? php if ($member_data['allow_email'] == 1) { echo 'checked="checked"'; } ?>> Would you like to  receive an email about news and promotions?
                </li>
                <li><input type="submit" value="Update">
                </li>
            </ul>
        </form>
        <?php }?>
    </div>
    <?php include ("includes/overall/column_right.php");?>
</div>
<?php include ("includes/overall/template_footer.php");?> 
```

还有我的 update_user 函数

```
function update_user($mem_id, $update_data) {
$update = array();
array_walk($update_data, 'array_sanitize');

foreach ($update_data as $field=>$data) {
    $update[] = '`' . $field . '` = \'' . $data . '\'';
}

mysql_query("UPDATE `members` SET " . implode(', ', $update) . " WHERE `mem_id`= $mem_id");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T00:06:01.537

您是否在 update_user 函数中收到正确的数据？

尝试这个

```
function update_user($mem_id, $update_data) {
    $update = array();
    array_walk($update_data, 'array_sanitize');

    foreach ($update_data as $field=>$data) {
        $update[] = '`' . $field . '` = \'' . $data . '\'';
    }

    $sql = "UPDATE `members` SET " . implode(', ', $update) . " WHERE `mem_id`= $mem_id";
   echo $sql; exit(); 

    //mysql_query("UPDATE `members` SET " . implode(', ', $update) . " WHERE `mem_id`= $mem_id");
    } 
```

在您的数据库中触发此 $sql 输出以检查您是否有 sql 错误或任何其他数据库错误

# android - 动态更新 TextView

> ID：15168939
> 
> 赞同：0
> 
> 时间：2013-03-01T23:59:50.570
> 
> 标签：android

我想实时更新列表视图中的 TextView。我有一个套接字连接，我正在其中收听 json 消息，我想解析/识别 json 以更新现有列表中的 5 个 TextView 之一。

```
responseid=object.getString("ResponseID");
    if(responseid!=null){
        for(int j=0;j<myList.size();j++){
            //If value match then I want to update the textView of that particular row
            if(myList.get(j).getName().equals(cid)) { 
                   //I successfully get the value of Textview of particular row of Listview now I want to update the this Textview with item variable below.
                String item = (String) myAdapter.getItem(j).getName();
                //Here i want to update Textview
                myAdapter.notifyDataSetChanged();
            }
        }    
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T02:02:29.527

```
responseid=object.getString("ResponseID");
    if(responseid!=null){
        for(int j=0;j<myList.size();j++){
            if(myList.get(j).getName().equals(cid)) { 
                String item = (String) myAdapter.getItem(j).getName();
                ((TextView)myList.get(j)).setText(item);
                myAdapter.notifyDataSetChanged();
            }
        }    
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T00:17:41.793

通过调用`String item = (String) myAdapter.getItem(j).getName();`您只需获取项目名称值。

要将值设置为将 getItem 转换为定义的类：

```
YourObjectType item = (YourObjectType)myAdapter.getItem(j);
item.setName("updatestring");
myAdapter.notifyDataSetChanged(); 
```

# ruby-on-rails - Rails jquery-fileupload gem - 找不到文件错误

> ID：15168943
> 
> 赞同：3
> 
> 时间：2013-03-02T00:00:10.370
> 
> 标签：ruby-on-rails, sprockets, jquery-file-upload

我正在尝试关注 jQuery-FileUpload 上的 Railscasts 集。我已经添加

```
gem 'jquery-fileupload-rails' 
```

的资产组中`Gemfile`，还添加了

```
//= require jquery-fileupload/basic 
```

行到`application.js`资产目录中的文件。但是，当我尝试打开网站时，会显示以下错误：

```
couldn't find file 'jquery-fileupload'
  (in root/app/assets/javascripts/application.js:15) 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-01-08T00:38:46.823

我找到了一个“解决方案”——重新启动 rails 服务器就可以了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-16T10:02:19.177

从资产组中删除它，它会正常工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T04:16:14.333

我已经解决了这个问题：

添加

```
gem 'therubyracer'
gem 'execjs' 
```

到您的 Gemfile。

`bundle install` 并 运行`rake assets:precompile --trace RAILS_ENV=production`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T00:35:47.423

这真的很奇怪，我只是尝试了一个`Gemfile`：

```
source 'https://rubygems.org'

gem 'rails', '3.2.12'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'sqlite3'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

  gem "jquery-fileupload-rails"

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer', :platforms => :ruby

  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails' 
```

在 application.js 上

```
//= require jquery
//= require jquery_ujs
//= require_tree .
//= require jquery-fileupload/basic 
```

并且工作得很好，你运行 bundle 了吗？我知道这是一个愚蠢的问题，但它可能是

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-13T10:05:07.530

我想你想将以下行添加到 application.js

```
//= require jquery-fileupload 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-10T07:08:37.647

我最近遇到了类似的事情。对我有用的是直接从 git 加载 gem

```
gem 'jquery-fileupload-rails', git: 'git://github.com/ollnixon/jquery-fileupload-rails.git' 
```

然后加载所需的 ui 样式

```
*= require jquery.fileupload-ui 
```

现在完美运行

# android - 是否有更“Android”的方式让我在网格视图中的项目保持“选定”状态？

> ID：15168944
> 
> 赞同：1
> 
> 时间：2013-03-02T00:00:18.903
> 
> 标签：android, gridview

我已经建立了一个`GridView`由一个`Adapter`包含`RelativeLayouts`顶层的`ImageView`. 直到用户点击项目`ImageView`才会显示，从而为个人创建“*选定*”效果`View`。当用户点击不同的项目时，我将所选项目隐藏在先前选择的`View`.

这很好，但我很好奇是否有更原生的 Android 方式来处理这种情况。我没有看到任何`setSelected()`（ish）方法，但也许我忽略了一些东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T00:57:26.187

的任何子类都`View`应该有一个`setSelected()`方法，其中包括`RelativeLayout`. 您应该跟踪适配器中的选定位置，然后在您的`getView()`方法中：

```
myRelativeLayout.setSelected(selectedPosition == position); 
```

如果您使用处理`state_selected`. 对于您的方法，您可以说：

```
myImageView.setVisibility(selectedPos == pos ? View.VISIBLE : View.INVISIBLE); 
```

当您注册一次点击时（在您的`OnItemSelectedListener`or`OnItemClickListener`或您正在使用的任何内容中）只需调用您的适配器的`setSelectedPosition()`方法与触摸的位置，然后调用您的适配器的`notifyDatasetChanged()`方法。

# amazon-web-services - 无法连接到 AWS

> ID：15168949
> 
> 赞同：-1
> 
> 时间：2013-03-02T00:00:52.103
> 
> 标签：amazon-web-services, amazon-s3, amazon-ec2

我有一些 AWS 的信息。当我登录时，我进入 AWS 管理控制，然后我打开 EC2。我只是想对服务器进行简单的 ssh 或 ftp，所以我可以在托管在那里的某个网站上更改一些东西。

我添加了我在 AWS 中创建的私钥并尝试通过 ssh 连接到 AWS，但它正在寻找一些公钥。我在哪里可以找到>

感谢大家的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T12:02:55.357

创建机器后，无需访问 AWS 控制台即可通过 ssh 进入实例。

1) 确保您拥有用于创建实例的 pem 文件 2) 打开终端窗口 3) SSH 进入您的实例。ssh -i you_pem_file.pem root@ip_address_of_your_ec2

如果您丢失了 pem 文件，那么您有点迷路了 :) 在这种情况下，您可以转到 EC2 AWS 控制台，从您丢失 PEM 文件的实例创建一个 AMI，创建一个新的密钥对，然后启动来自 AMI 的新实例，带有刚刚创建的密钥对。

# objective-c - 在 Objective-C 中更改所选文本的字体

> ID：15168953
> 
> 赞同：0
> 
> 时间：2013-03-02T00:01:22.180
> 
> 标签：objective-c, macos, cocoa, nstextview

我正在尝试为 Mac 应用程序（不是 iOS 应用程序）创建一个自定义的“更改字体”NSPopupButton。我可以检测到字体选择的变化：

```
long fontItemIndex = [fontPopup indexOfSelectedItem];
NSMenuItem *fontItem = [fontPopup itemAtIndex:(int)selectedFontItemIndex];
NSString *fontName = [selectedFontItem title]; 
```

鉴于此字体名称的 NSString，我似乎无法找到如何将 NSTextView 中的选定文本实际更改`textView`为这种新字体。

我只是被[官方文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSFontManager_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40004043)弄得眼花缭乱：这似乎`convertFont:toFamily:`是我所需要的。当我这样做时：

```
NSFont *font = [NSFont fontWithName:fontName size:12.0];
[textView setFont:font]; 
```

它设置文本视图中的所有文本，而不仅仅是选定的文本。但是当我这样做时：

```
NSFontManager *fontManager = [NSFontManager sharedFontManager];
[fontManager convertFont:[fontManager selectedFont] toFamily:fontName]; 
```

它没有做任何事情。我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T10:42:17.203

a 内部`NSTextView`是 a `NSTextStorage`（的子类`NSAttributedString`），您必须修改名为 的属性`NSFontAttributeName`。

首先获取要更改字体属性的范围：

```
NSRange selection = textView.selectedRange; 
```

现在将字体属性添加到选择中：

```
NSFont *font = [NSFont fontWithName:fontName size:12.0f];
[self.textView.textStorage addAttributes:@{NSFontAttributeName: font}
  range:selection]; 
```

根据您的内容，`NSPopUpButton`它应该足以作为字体名称调用`fontWithName:size:`以`title`获取刚刚选择的字体。但是，如果您已经使用的方法不起作用，您可能必须从字体系列名称中获取特定的字体。`availableMembersOfFontFamily:`on`NSFontManager`将为您提供所有可用字体的列表。您可以使用其中之一来初始化特定字体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T04:07:22.587

看一下[`setFont:range:`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSText_Class/Reference/Reference.html#//apple_ref/occ/instm/NSText/setFont%3arange%3a)方法`NSText`，超类`NSTextView`。

（当然，范围来自 上的[`selectedRanges`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSTextView_Class/Reference/Reference.html#//apple_ref/occ/instm/NSTextView/selectedRanges)属性`NSTextView`。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-25T21:52:44.383

这就是我更改文本视图中所有文本所需的全部内容。

```
[textview setFont:[NSFont fontWithName:@"Courier" size:14]]; 
```

# javascript - 如何访问用户在 Javascript 中提交的表单数据？

> ID：15168954
> 
> 赞同：1
> 
> 时间：2013-03-02T00:01:31.810
> 
> 标签：javascript, jquery, html, form-submit

我对编程比较陌生，但了解 HTML、CSS 和 Javascript（包括 jQuery）的基础知识。*由于我的绿色，如果答案既包含一个简单的解决方案，又包含解决方案为何*有效的原因，我将不胜感激。谢谢！

所以我有一个表单，有一个文本输入和一个提交按钮：

```
<form>
<input type="text">
<button type="submit">Submit</button>
</form> 
```

当用户在文本字段中输入数据并单击提交时，我如何访问这些数据？如果用户输入他们的姓名，我如何获取该信息？我不打算将它存储或写入任何地方，只是将它作为 javascript 中的变量保存，我将分配给 jQuery cookie。

那么如何访问用户提交的数据，最好只使用 Javascript（使用 jQuery）？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T00:04:14.410

您访问服务器端的数据（`$_POST['username']`例如在 PHP 中通过）。该表单将任何命名输入的数据发送到您的服务器，因此您可能必须将输入更改为：

```
<input type=text name=username> 
```

如果您想在客户端访问它（使用 JavaScript），您也可以这样做，但您必须阻止表单提交：

```
$("form").on('submit', function (e) {
    $.cookie('username', $(this).find('[name=username]').val());
    //stop form from submitting
    e.preventDefault();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T00:15:46.543

假设您有一个 html 输入标签，例如：

```
<input id="textfield" type="text"> 
```

使用 javascript，您可以将该字段的值存储在如下变量中：

```
var inputvalue = $('#textfield').val(); 
```

当然，您需要一些东西来运行脚本。

这样做的原因是文本字段是一个对象。你可能会认为它是一根长出不同树枝的树干。这些“分支”之一是其中包含的值。既然您知道 jquery，就知道`$('#textfield')`通过选择器获取元素。句号表示我们正在获取其中一个分支，而“值”表示我们想要告诉文本字段中内容的分支。

希望这可以帮助。

# jquery - jQuery 事件委托和祖先

> ID：15168957
> 
> 赞同：2
> 
> 时间：2013-03-02T00:01:55.150
> 
> 标签：jquery, jquery-selectors

我`<span>`在表格单元格中有几个元素。对于每个跨度，当用户单击它时，我正在使用事件委托来触发 ajax 请求。（捕获事件的函数绑定到表格单元格）。

问题是 ajax 调用需要包含一个表行标识符，我不确定在哪里存储这个标识符，或者如何引用和使用它。

例如，假设表中的每一行代表一个 Person，那么当用户点击该行中的一个 span 时，ajax 调用需要包含 personId。

personId 是否应该是该行的类属性（例如`<tr class='person-id-123'>...`）？或者也许是一个id（例如`<tr id='person-id-123'>...`）？以及如何在捕获点击事件的函数中引用和使用它？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T00:08:12.580

使用[HTML5 数据集属性](http://www.w3.org/TR/html5-author/global-attributes.html#embedding-custom-non-visible-data-with-the-data-%2a-attributes)

```
<tr data-person-id=123>

$(".tr-parent").on('click', 'tr', function () {
    //$(this).data('person-id') is also valid
    ajaxRequest(this.dataset.personId);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T00:59:52.547

为此，您可以使用 ID，对任何内容进行分类，因为从 jquery 我们可以获得价值。但如果你使用 Data 属性会更好。

现在在这里为您的跨度

```
<span data-person-key="47" class="spanclass">
</span> 
```

从 jquery 你可以得到这样的值。

```
$(document).on("click",".spanclass",function(){
  var personKey = $(this).data("person-key");
  $.ajax({
    url: "whatever you url is. if its asp.net then method of controller will be here.or may be php page",
    type: "POST",
    data: {Personid : personKey },
    success://whatever you want to code in success,
    error://whatever you want to code in error
  });
}); 
```

# python - Python min() 不同类型的参数

> ID：15168958
> 
> 赞同：0
> 
> 时间：2013-03-02T00:01:57.530
> 
> 标签：python

我最近很惊讶地发现你可以在 Python 中使用不同类型的参数的 min() 而不会得到 ValueError。

```
min(3, "blah") ==> 3
min(300, 'zzz') ==> 300 
```

文档对此并不清楚 - 它只是说 min() 采用“最小的参数”。它实际上是如何确定哪个元素最小的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T00:05:28.583

它通过使用通常的规则比较它们来确定这一点。如果对象具有不同的类型并且无法进行合理比较（因为它们都没有实现所需的特殊方法，或者实现不适用于另一个对象的类型），那么它们按类型给出一致的顺序；例如，所有整数都小于所有字符串。试试看：`1 < "1"`

（顺便说一下，布尔值被实现为整数的子类，并且可以与数字进行比较，因此它们`False`将按 0 和`True`1 排序。）

它以这种方式实现，因此如果您对包含各种类型的列表进行排序，类似的类型将被一起排序。但是，在 Python 3 之前的版本中，这已更改，您不能再隐式比较不同的类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T00:04:18.640

在 Python 2 中，存在对不同类型的值进行任意但可预测的比较。我认为这类似于类型名称的字典比较（ints < floats < strs < tuples ）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T00:06:01.543

根据 Python 的排序定义是正确的：

```
>>> 3 < "blah"
True
>>> 300 < 'zzz'
True 
```

[规则](http://docs.python.org/2/reference/expressions.html#not-in)是：

> 如果两者都是数字，则将它们转换为通用类型。否则，不同类型的对象总是比较不相等，并且顺序一致但任意。

# php - 设置 Cookie 过期日期

> ID：15168962
> 
> 赞同：3
> 
> 时间：2013-03-02T00:02:17.173
> 
> 标签：php, cookies

这是我使用的强制 cookie 在 90 天后过期的代码：

```
setcookie("WHMCSAffiliateID", $aff, time()+90*24*60*60); 
```

如果我希望 cookie 永远不会过期，我需要将此行更改为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T00:09:54.687

无法将 cookie 设置为永不过期。但是，如果您定期更新 cookie，那么它们可以有效地永久存在。

就个人而言，我喜欢设置 30 天的 cookie，并每隔一段时间更新一次。这样做的一种方法可能是：

```
setcookie("WHMCSAffiliateID",$add,time()+30*24*60*60);
setcookie("Renew-cookies","1",time()+10*24*60*60); 
```

然后在每次页面加载时：

```
if( isset($_COOKIE['WHMCSAffiliateID']) && !isset($_COOKIE['Renew-cookies'])) {
    setcookie("WHMCSAffiliateID",$_COOKIE['WHMCSAffiliateID'],time()+30*24*60*60);
    setcookie("Renew-cookies","1",time()+10*24*60*60);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T00:04:53.667

怎么样

```
$year = 365*86400;
setcookie("WHMCSAffiliateID", $aff, time()+100*$year); 
```

?

100年显然有点多。2年应该没问题。或者 1\. 或者 10，如果你必须绝对确定并且永远不要改变你的代码。

# android - 急切地要求用户访问

> ID：15168964
> 
> 赞同：1
> 
> 时间：2013-03-02T00:02:38.960
> 
> 标签：android, oauth, permissions

我有一个应用程序执行某些操作 [1] 导致 Android 在通知栏中弹出警告，询问用户以下内容：

> 权限请求
> xxx@gmail.com
> 
> 这些应用希望从现在开始访问您的 Google 帐户
> 
> *   应用名称
> 
> 他们正在请求许可：
> 
> *   查看和管理您的...
> 
> `No thanks`          `Allow access`

这样做的问题是它使原始操作失败，然后用户必须在单击后重试`Allow access`，这很烦人。在我实际尝试执行导致它们的操作之前，有没有办法让系统给用户这些提示？

显然，一种方法是运行有问题的操作并检查异常，但我正在寻找更好的方法。

[1]更具体地说，有一个类试图从客户经理那里获取身份验证令牌

# cuda - Cuda 错误 CUDA_ERROR_NO_BINARY_FOR_GPU

> ID：15168965
> 
> 赞同：4
> 
> 时间：2013-03-02T00:02:39.713
> 
> 标签：cuda, ptx

我有一些无法加载的 PTX 代码。我在 650M 上使用 OSX 运行它。其他 CUDA 示例在系统上运行良好，但在加载模块时，我总是收到错误 209：CUDA_ERROR_NO_BINARY_FOR_GPU

我错过了什么？

```
 .version 3.1
.target sm_20, texmode_independent
.address_size 64

    // .globl   examples_2E_mandelbrot_2F_calc_2D_mandelbrot_2D_ptx
.entry examples_2E_mandelbrot_2F_calc_2D_mandelbrot_2D_ptx(
    .param .u64 .ptr .global .align 8 examples_2E_mandelbrot_2F_calc_2D_mandelbrot_2D_ptx_param_0,
    .param .f64 examples_2E_mandelbrot_2F_calc_2D_mandelbrot_2D_ptx_param_1,
    .param .f64 examples_2E_mandelbrot_2F_calc_2D_mandelbrot_2D_ptx_param_2,
    .param .f64 examples_2E_mandelbrot_2F_calc_2D_mandelbrot_2D_ptx_param_3
)
{
    .reg .pred %p<396>;
    .reg .s16 %rc<396>;
    .reg .s16 %rs<396>;
    .reg .s32 %r<396>;
    .reg .s64 %rl<396>;
    .reg .f32 %f<396>;
    .reg .f64 %fl<396>;

    ld.param.u64    %rl0, [examples_2E_mandelbrot_2F_calc_2D_mandelbrot_2D_ptx_param_0];
    mov.b64 func_retval0, %rl0;
    ret;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T01:25:16.570

您收到错误是因为您的 PTX 包含语法错误，因此它永远不会编译。线

```
mov.b64 func_retval0, %rl0; 
```

引用一个 label `func_retval0`，但它没有在 PTX 文件中的任何地方定义。您可以通过自己尝试使用工具链编译 PTX 来检查这一点：

```
$ ptxas -arch=sm_20 own.ptx 
ptxas own.ptx, line 24; error   : Arguments mismatch for instruction 'mov'
ptxas own.ptx, line 24; error   : Unknown symbol 'func_retval0'
ptxas own.ptx, line 24; error   : Label expected for forward reference of 'func_retval0'
ptxas fatal   : Ptx assembly aborted due to errors 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-13T03:27:08.210

关于运行 ptxas 的好建议。我收到错误 209：问题原来是 __shared__ 内存被超额订阅。以前这将是编译时的警告。我有 Cuda 5.5，现在编译时没有警告——即使打开了详细信息。谢谢

# c++ - 调试断言失败！使用指针算法进行字符串操作

> ID：15168968
> 
> 赞同：0
> 
> 时间：2013-03-02T00:03:14.700
> 
> 标签：c++, pointers, c-strings

**编辑：Pastebin 链接到底部的全部代码**

在我的 CS215 课程中，我获得了一个名为 String215 的类，它是一个基本的字符串类，用于帮助理解动态内存分配和 char 数组的指针运算。

该课程以非常基本的骨架形式提供给我，其中包含原型但没有实现，以及用于测试我的实现的测试函数。我不能在这个作业中使用任何 C 字符串函数。

程序中麻烦的部分是 append 函数，它只是将参数 string215 对象附加到当前 string215 对象的末尾。

```
// Add a suffix to the end of this string.  Allocates and frees memory.
void string215::append(const string215 &suffix)
{
    char *output = new char[str_len(data)+suffix.length()+1];
    for(int x = 0; x < str_len(data); x++) {
            *output = *data;
        output++;
        data++;
    }

    for(int x = 0; x < suffix.length(); x++) {
        *output = suffix.getchar(x);
        output++;
    }
    *output = '\0';
    output -= (str_len(data)+suffix.length()+1);
    delete[] data;
    data = output;
} 
```

这部分代码在测试函数的第 13 次测试中进行测试，如下所示：

```
string215 str("testing");

...

// Test 13: test that append works in a simple case.
curr_test++;
string215 suffix("123");
str.append(suffix);
if (strcmp(str.c_str(), "testing123") != 0) {
    cerr << "Test " << curr_test << " failed." << endl;
    failed++;
} 
```

这是附加类的描述：

> 将后缀添加到此字符串的末尾。分配一个新的更大的数组；将旧内容（后跟后缀）复制到新数组；然后释放旧数组并更新指向新数组的指针。

我的程序在附加函数执行结束时中止并显示错误消息：

```
Debug Assertion Failed!

Program: [Source path]\dbgdel.cpp
Line: 52

Expression: _BLOCK_TYPE_IS_VALID(pHead->nBlockUse)

...

Abort || Retry || Ignore 
```

我相当肯定这与我非常糟糕的内存管理有关。我知道这没什么好做的，但是我已经为此苦苦挣扎了几个小时，似乎无法弄清楚。

这是该程序的 .cpp 和 .h 文件的 pastebin

string215.cpp：[http ://pastebin.com/Xh2SvDKJ](http://pastebin.com/Xh2SvDKJ)

string215.h：[http ://pastebin.com/JfAJDEVN](http://pastebin.com/JfAJDEVN)

非常感谢任何帮助！

谢谢，生浆果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T00:21:34.987

您之前正在更改`data`指针`delete[]`。您需要与`delete[]`从中获得的值完全相同`new[]`。

此外，您正在增加`output`指针`str_len(data)+suffix.length()`时间，并将其收回`str_len(data) + suffix.length() + 1`.

我会使用单独的变量进行迭代来解决这些问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T01:17:44.317

所以我认为你的问题出在这条线上

```
for(int x = 0; x < str_len(data); x++) { 
```

请注意，“数据”的大小在循环的每次迭代中都在变化。当您增加“x”时，您正在减少“数据”的长度。假设 'data' 是一个包含“hello”的字符串：在循环的第一次迭代中 x=0 和 str_len(data)=5; 在第二次迭代中 x=1 和 str_len(data)=4。因此，for 循环执行的次数是您需要的一半，并且“数据”最终不会指向数据字符串的末尾

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T00:19:30.607

你`output`精确地增加`str_len(data) + suffix.length()`时间。请注意，您不会`output`在`*output = '\0';`.

所以要回到开始，你应该使用：

```
output -= (str_len(data) + suffix.length()); 
```

顺便说一句，有些代码效率不高。例如，`getchar`使用循环而不是简单地返回`data[index]`. 您使用`getchar`in `append`，这意味着性能不是很好。

**编辑：**正如 zch 所说，您`delete[] data`在修改后使用`data`，但请注意，即使在此之前您`str_len(data)`在修改后使用`data`（在决定要跳过多少字节时），所以计算是错误的（我上面的建议也是错误的，因为`str_len(data)`现在零）。

# r - 登录网站以使用 RCurl 获取数据

> ID：15168970
> 
> 赞同：7
> 
> 时间：2013-03-02T00:03:43.530
> 
> 标签：r, login, web, rcurl

我想使用 RCurl 登录网站并从网络上获取数据（不登录无法看到数据。）

我想导出这个（例如）“ [http://www.appannie.com/app/ios/instagram/ranking/history/chart_data/?s=2010-10-06&e=2012-06-04&c=143441&f=ranks&d =iphone](http://www.appannie.com/app/ios/instagram/ranking/history/chart_data/?s=2010-10-06&e=2012-06-04&c=143441&f=ranks&d=iphone) " 在我使用 RCurl 登录后进入 R。问题是我无法使用 RCurl 登录。我以前没有尝试过，所以我主要参考[http://www.omegahat.org/RCurl/philosophy.html](http://www.omegahat.org/RCurl/philosophy.html)。

所以这就是我尝试过的。（这里，'me@gmail.com' 是我的用户 ID，'9999' 是我的密码 - 我只是编的。）

```
library(RJSONIO)
library(rjson)
library(RCurl)
appannie <- getURL("http://www.appannie.com/app/ios/instagram/ranking/history/chart_data/.json?s=2010-10-06&e=2012-06-04&c=143441&f=ranks&d=iphone, userpwd = me@gmail.com:9999", verbose = TRUE) 
```

但这给了我以下信息：

```
About to connect() to www.appannie.com port 80 (#0)
*   Trying 69.167.138.64... * connected
* Connected to www.appannie.com (69.167.138.64) port 80 (#0)
> GET /app/ios/instagram/ranking/history/chart_data/?s=2010-10-06&e=2012-06-04&c=143441&f=ranks&d=iphone HTTP/1.1
Host: www.appannie.com
Accept: */*

< HTTP/1.1 403 FORBIDDEN
< Server: nginx/1.1.19
< Date: Fri, 01 Mar 2013 23:41:32 GMT
< Content-Type: text/html; charset=utf-8
< Transfer-Encoding: chunked
< Connection: keep-alive
< Keep-Alive: timeout=10
< Vary: Accept-Encoding
< Vary: Cookie,Accept-Encoding
< 
* Connection #0 to host www.appannie.com left intact 
```

所以，我又回去阅读了这个[http://www.omegahat.org/RCurl/philosophy.html](http://www.omegahat.org/RCurl/philosophy.html)并且不知道该怎么做，所以我在看到来自 stackoverflow 的类似问题后尝试了这个。

```
getURL("http://www.appannie.com/app/ios/instagram/ranking/history/chart_data/?s=2010-10-06&e=2012-06-04&c=143441&f=ranks&d=iphone",.opts=list(userpwd=me@gmail.com:9999")) 
```

但这给了我以下输出。

```
[1] "" 
```

谁能给我一个提示？（经过一系列不同的试用，网站开始向我发送警告 =（

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-25T22:19:35.003

这是某种身份验证问题，而不是您最有可能对 RCurl 做错的任何事情。

您已连接到服务器，但您的登录名不正确、无效或无法通过 API 获得数据。

[http://en.wikipedia.org/wiki/HTTP_403](http://en.wikipedia.org/wiki/HTTP_403)

# xcode - url 手动下载，但不使用 NSURLRequest

> ID：15168971
> 
> 赞同：0
> 
> 时间：2013-03-02T00:03:51.607
> 
> 标签：xcode, url

我认为我的问题就像[这里描述](https://stackoverflow.com/questions/10782388/)的那样，但我不太明白答案。

我的应用程序要求用户输入包含`.pbn`文件的站点的 URL。但是手动工作的相同 URL 在我的应用程序的 TextField 中输入时不起作用。在我的示例`self.urlNameInput.text`中`http://www.atlantaduplicatebridgeclub.com/scorepost/2013/01/20130126ana.pbn`，该 URL 无法识别。

```
NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL URLWithString:self.urlNameInput.text] cachePolicy:NSURLRequestUseProtocolCachePolicy
                                              timeoutInterval:60.0]; 
```

根据我是否包含或排除“http://”，我会收到以下错误消息。

连接失败！错误 - 找不到具有指定主机名的服务器。[http://www.atlantaduplicatebridgeclub.com/scorepost/2013/01/20130126ana.pbn](http://www.atlantaduplicatebridgeclub.com/scorepost/2013/01/20130126ana.pbn)

连接失败！错误 - 不受支持的 URL www.atlantaduplicatebridgeclub.com/scorepost/2013/01/20130126ana.pbn

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T00:13:31.947

这似乎工作得很好：

```
NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.atlantaduplicatebridgeclub.com/scorepost/2013/01/20130126ana.pbn"]];
[NSURLConnection sendAsynchronousRequest:request queue:[NSOperationQueue mainQueue] completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
    NSString *results = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    NSLog(@"Results:%@", results);
}]; 
```

# iphone - 基于中断完成块的动画来执行单独的动画

> ID：15168972
> 
> 赞同：0
> 
> 时间：2013-03-02T00:04:02.117
> 
> 标签：iphone, ios, objective-c

我正在使用基于块的动画来模拟发牌作为游戏的介绍动画。除非用户在动画期间触发 segue，否则动画效果很好，我们执行额外的动画以获得从源视图控制器到目标视图控制器的“滑动”过渡效果。现在发生的是已经“发牌”的牌适当地滑出屏幕，如果有牌还没有发牌，它会在过渡的中间发牌，然后当目标视图控制器被按下时，牌就会消失. 这是非常丑陋的。

我试过'view.layer removeAllAnimations'，但没有帮助（我确实导入了quartzcore）。我想要做的是取消完成块中的待处理动画，并简单地执行 segue 动画。

这是“交易”代码：

```
[UIView animateWithDuration:0.20f
                  delay:0.20f
                options:UIViewAnimationOptionCurveEaseOut
             animations:^
{
 _fiveOfHearts.center = CGPointMake(90, 198);
 _fiveOfHearts.transform = fiveOfHeartsTransform;
}

             completion:^(BOOL finished)
{[UIView transitionWithView:_fiveOfHearts duration:0.20f options:UIViewAnimationOptionTransitionFlipFromRight animations:^{
     _fiveOfHearts.image = [UIImage imageNamed:@"52"];
 }completion:nil];
 [UIView animateWithDuration:0.30f
                    delay:0.0f
                  options:UIViewAnimationOptionCurveEaseOut
               animations:^
  {
   _jackOfHearts.center = CGPointMake(128, 196);
   _jackOfHearts.transform = jackfHeartsTransform;
  }
               completion:^(BOOL finished)
  {[UIView transitionWithView:_jackOfHearts duration:0.40f options:UIViewAnimationOptionTransitionFlipFromRight animations:^{
       _jackOfHearts.image = [UIImage imageNamed:@"112"];
   }completion:nil];
   [UIView animateWithDuration:0.30f
                         delay:0.0f
                       options:UIViewAnimationOptionCurveEaseOut
                    animations:^
    {
        _aceOfHearts.center = CGPointMake(162, 196);
        _aceOfHearts.transform = aceOfHeartsTransform;
    }
                    completion: ... and so on. 
```

segue 代码如下所示：

```
for (UIView *iv in src.view.subviews) {
    if (iv.tag != 99999) {
        [UIView animateWithDuration:0.5f animations:^{iv.center = CGPointMake(iv.center.x - 600, iv.center.y);}];
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T00:59:50.387

您可以添加一个全局 BOOL 说 hasUserSkippedOn 一旦用户按下继续将其设置为 YES ，然后每次您点击完成块检查 _hasUserSkipped 是否仍然是 YES 然后不再提供任何形式。通常在块上它有一个默认的结束布尔值，但我不太确定动画块是否有结束布尔值。

# c# - 在 windows phone 上使用 c# 创建和定位控件

> ID：15168973
> 
> 赞同：0
> 
> 时间：2013-03-02T00:04:02.957
> 
> 标签：c#, windows-phone-8

我正在创建一个应用程序，用户在其中填写带有多个文本框的表单。他们可以根据需要添加或删除文本框。我在添加和定位新控件时遇到问题。这是我到目前为止所拥有的：

```
TextBox textOne = new TextBox();
textOne.Text = "Lorem ipsum";
textOne.Height = 20;
textOne.Width = 50;
textOne.Margin.Left = 20; 
```

问题是我尝试将边距设置为 20 的最后一行，它说：“无法修改 'System.Windows.FrameworkElement.Margin' 的返回值，因为它不是变量”。

我没有使用正确的方法（很明显我没有）还是我只是用完全错误的方式来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T00:15:28.470

`Thickness`用对象试试：

```
textOne.Margin = new Thickness(20, 0, 0, 0); // left, top, right, bottom 
```

# python - 如何截断字典中的数据以使生成的 JSON 不超过 n 个字节？

> ID：15168974
> 
> 赞同：2
> 
> 时间：2013-03-02T00:04:05.650
> 
> 标签：python, unicode, json, micro-optimization

我有一个 python 2.7 字典，例如`{u"eat": u"糖果", u"drink": u"café"}`，我需要使用 JSON 传输它。JSON 字符串必须是常规 ASCII，并且必须少于 256 个字符。

到目前为止，我已经编写了这个代码：

```
import json

def payload_to_json(payload, max_size = 256):
    while True:
        json_string = json.dumps(payload, separators = (',', ':'))
        if len(json_string) <= max_size:
            return json_string
        max_length, found_key = 0, None
        for key, value in payload.iteritems():
            length = len(value)
            if length > max_length:
                max_length = length
                found_key = key
        if max_length == 0:
            return "" # just in case max_size is really low
        payload[found_key] = payload[found_key][:-1] # remove one char 
```

它按预期工作：

```
>>> payload = {u"eat": u"糖果", u"drink": u"café"}
>>> print payload_to_json(payload)
{"drink":"caf\u00e9","eat":"\u7cd6\u679c"}
>>> print payload_to_json(payload, max_size=41)
{"drink":"caf","eat":"\u7cd6\u679c"}
>>> print payload_to_json(payload, max_size=35)
{"drink":"ca","eat":"\u7cd6\u679c"}
>>> print payload_to_json(payload, max_size=34)
{"drink":"c","eat":"\u7cd6\u679c"}
>>> print payload_to_json(payload, max_size=30)
{"drink":"c","eat":"\u7cd6"}
>>> print payload_to_json(payload, max_size=21)
{"drink":"","eat":""}
>>> print payload_to_json(payload, max_size=20) 
```

在我看来，应该有一种方法来优化它！我真的一次剥一个角色，感觉很不对劲。

我的问题非常接近[这个](https://stackoverflow.com/questions/6777987/how-to-truncate-data-in-a-hash-so-that-the-resulting-json-isnt-longer-than-n-by)问题，除了我使用 python 2.7，而且只要源字符串包含非 ASCII unicode 字符，json 编码器就会产生相当长的 JSON 字符串。

另外，我很确定这将与 UTF-16 代理对中断......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T00:14:06.837

如果你试图让它更快（你不应该这样做，除非你知道这是你程序中的一个热点，会带来实际的性能成本），你可以先猜测要剥离的字符数，然后处理剩余部分.

首先，如果您需要去除 52 个字符，并且有 10 个键，则需要从 2 个键中分别去除 6 个字符，从其他 8 个键中分别去除 5 个字符，对吧？当然，除了你可能试图从只有 4 个字符长的东西中删除 6 个字符，这意味着你最终仍然会超出限制 2 个字符。但是您可以跟踪这些剩菜并在完成后处理它们。不太可能有足够的剩菜来通过“快速”版本进行另一次值得做的事情，因此您不妨只使用“慢速”版本。

```
def payload_to_json(payload, max_size = 256):
    json_string = json.dumps(payload, separators = (',', ':'))
    chars_to_strip = len(json_string) - max_size
    if chars_to_strip <= 0:
        return json_string
    key_count = len(payload)
    chars_per_key, extras = divmod(chars_to_strip, key_count)
    leftover = 0
    for i, key in enumerate(payload):
        to_strip = chars_per_key + (i < extras)
        orig_len = len(payload[key])
        if orig_len < to_strip:
            payload[key] = ''
            leftover += to_strip - orig_len
        else:
            payload[key] = payload[key][:-to_strip]
    if leftover:
        return slow_payload_to_json(payload, max_size)
    else:
        return json.dumps(payload, separators = (',', ':')) 
```

我不确定这*是否会*在您的用例中加快速度。对于非常小的物体和最大尺寸，如果它真的减慢了速度，我不会感到惊讶。但是对于超过最大尺寸的巨大物体，它可能会有很大帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T00:06:32.310

如何计算**每个条目的序列化大小**。

然后选择尽可能多的元素以达到所需的长度？

无论哪种方式，这听起来都是一个非常糟糕的主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T00:27:04.500

为什么不使用[链接的帖子](https://stackoverflow.com/questions/6777987/how-to-truncate-data-in-a-hash-so-that-the-resulting-json-isnt-longer-than-n-by)中的策略：测量第一个生成的 json，然后按首选顺序从值中删除适量的字符。

否则，您可以通过计数来猜测 json 使用的字符数：对于每个映射变量，这些字符`"":"",`加上整体`{}`，减去逗号。（除非你没有更复杂的嵌套列表，显然）

只要您使用`u''`符号，unicode 功能就不应该成为问题（不确定，但应该不难检查）

# azure - Azure 网站是否使用粘性 IP 负载平衡？

> ID：15168982
> 
> 赞同：2
> 
> 时间：2013-03-02T00:04:50.030
> 
> 标签：azure, web, load-balancing

我刚刚使用 Windows Azure 网站预览建立了一个网站。这样做之后，我运行 YSlow 以确保分数符合我的预期。这样做时，我收到一条消息，内容为“使用无 cookie 域”。好吧，这只是一个信息网站，我们甚至不使用会话。所以我检查了http请求，那里有一个名为“ARRAffinity”的cookie。一些快速的谷歌搜索出现了这个链接：

[http://social.msdn.microsoft.com/Forums/en-US/windowsazurewebsitespreview/thread/0ba2c2f6-d5a1-40b6-8d0d-e44b58b65753/](http://social.msdn.microsoft.com/Forums/en-US/windowsazurewebsitespreview/thread/0ba2c2f6-d5a1-40b6-8d0d-e44b58b65753/)

这是否意味着 Azure 网站始终使用粘性 IP？这有点令人震惊，因为 Web 角色使用循环行为。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-02T16:15:26.430

是的，Windows Azure 网站将使用 ARRAffinity cookie 进行粘性负载平衡。而且，它适用于免费、共享和保留模型。

我想这样做是为了更轻松地支持如果没有适当的状态服务器可能无法正常运行的自定义画廊，并且它还允许更轻松地扩展而无需担心无状态服务器。

# c# - TFS 签入按钮不起作用

> ID：15168985
> 
> 赞同：0
> 
> 时间：2013-03-02T00:05:05.703
> 
> 标签：c#, visual-studio-2010, tfs

我使用 Visual Studio 2010 为 Windows Phone 和 TFS 开发应用程序作为版本控制系统。存储库位于 **.visualstudio.com。我的项目与它集成在一起。在我对代码进行了一些更改后，我通常按下“待更改”选项卡上的“签入”按钮，然后签入发生了。一切正常。但是，一旦我对代码进行了更改，“签入”就开始保持不活动状态。同一选项卡上的“刷新”按钮没有帮助。可能的问题是什么？为什么即使在更改代码后“签入”按钮仍然不活动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T00:09:42.763

问题在于我的项目由于某种原因不在线。因此，右键单击该项目并按“Go Online”会有所帮助。很抱歉垃圾邮件，感谢这个问题和答案：[Visual Studio is not tracking changes, or check out files from source control as I edit them](https://stackoverflow.com/questions/5294509/visual-studio-isnt-tracking-changes-or-checking-out-files-from-source-control?rq=1)

# mysql - 联合两个查询并标记重复项

> ID：15168992
> 
> 赞同：0
> 
> 时间：2013-03-02T00:05:31.210
> 
> 标签：mysql, sql, join, duplicates, union

我有两张桌子。一个具有所有选项，一个具有用户选择的选项以及他们创建的一些选项，这些选项可能不在选项表中。

我需要合并数据，以便我返回一个结果集，其中包括所有选项，以及用户选项，并以某种方式标记哪些仅限用户并且与主要选项数据重叠......

例子...

**选项**

```
`COLOR`   | `ANIMAL`
---------------------
RED       | DOG
BLUE      | DOG
GREEN     | DOG
YELLOW    | CAT
PINK      | CAT
ORANGE    | CAT 
```

**用户选择的选项**

```
`COLOR` | `ANIMAL`
------------------
GREEN   | SNAKE
BLUE    | DOG
PINK    | CAT
PURPLE  | CAT 
```

**我的结果需要看起来像......**

```
`COLOR` | `ANIMAL`| `DUPLICATE_OR_NEW`
----------------------------------------
RED     | DOG     | 0
BLUE    | DOG     | 1
GREEN   | DOG     | 0
YELLOW  | CAT     | 0
PINK    | CAT     | 1
ORANGE  | CAT     | 0
PURPLE  | CAT     | 1
GREEN   | SNAKE   | 1 
```

在这种情况下，排序顺序无关紧要。我正在尝试使用 UNIONS，但我认为我需要通过将两张表连接在一起来做到这一点。到目前为止，我还没有提出解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T00:11:36.017

这可能被称为作弊，但它会起作用

```
SELECT COLOR, ANIMAL, sum(DUPLICATE_OR_NEW)
FROM
(
SELECT COLOR, ANIMAL, 1 as DUPLICATE_OR_NEW FROM options
UNION ALL
SELECT COLOR, ANIMAL, 2 as DUPLICATE_OR_NEW FROM UserSelection
) as UTable
GROUP BY  COLOR, ANIMAL

-- 1 = unchosen option
-- 2 = new user added option
-- 3 = option exsisted chosen by user 
```

见 SQL Fiddle [http://sqlfiddle.com/#!2/01c79/2](http://sqlfiddle.com/#!2/01c79/2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T00:32:40.010

解决此问题的另一种方法：

```
select color, animal, 1 as duplicate_or_new
from UserSelected
union all
select color, animal, 0 as duplicate_or_new
from options o
where not exists (select 1 from UserSelected us where us.color = o.color and us.animal = o.animal) 
```

`union all`使用/group的正确方法是：

```
 select color, animal, max(which) as duplicate_or_new
 from (select color, animal, 1 as which
       from UserSelected
       union all
       select color, animal, 0 as which
       from options
      ) t
group by color, animal 
```

以下查询创建两个单独的标志：

```
 select color, animal, max(isUser) as IsUser, max(isOption) as IsOption
 from (select color, animal, 1 as IsUser, 0 as IsOption
       from UserSelected
       union all
       select color, animal, 0 as IsUser, 1 as IsOption
       from options
      ) t
group by color, animal 
```

您可以将它们放在 case 语句中以格式化信息：

```
(case when max(isUser) = 1 and max(isOption) = 1 then 'both'
      when max(isUser) = 1 then 'user'
      when max(isOption) = 1 then 'option'
      else 'impossible'
 end) 
```