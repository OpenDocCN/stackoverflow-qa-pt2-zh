# StackOverflow 问答 16020000-16020999

# onedrive - 从 skydrive api 检索文件夹详细信息时获取 user_forbidden

> ID：16020000
> 
> 赞同：0
> 
> 时间：2013-04-15T16:16:57.460
> 
> 标签：onedrive

我面临一个问题，用户可以使用 OAuth 添加他的 Skydrive 帐户，但是当我尝试`/skydrive/me/files`使用 Skydrive Live API 获取文件夹详细信息 () 时，我收到了此响应

```
{"error": {
  "code": "user_forbidden", 
  "message": "The user's account has been disabled in SkyDrive."} 
```

我什么时候会收到这个错误？

谢谢，

阿努拉格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-14T21:09:47.203

用户的 SKyDrive 帐户由于不活动而被 Microsoft 禁用，尽管他的真实帐户仍处于活动状态。在 oauth 期间，他们不会检查 Skydrive 帐户状态。因此客户端应在 oauth 后检查帐户状态，并在帐户已被禁用时提示用户。

# joomla2.5 - InnerJoin Joomla 不工作

> ID：16020005
> 
> 赞同：-1
> 
> 时间：2013-04-15T16:17:14.823
> 
> 标签：joomla2.5, inner-join

怎么了？

```
$db = JFactory::getDbo();
$query = $db->getQuery(true);        
$query = "SELECT jml.*,grkt.*,grk.*,jml.*"
."\n , FROM #__egerak_subutama AS grk"
."\n , inner join #__users AS jml ON jml.username = grk.username"
."\n , inner join #__egerak_kenyataan AS grkt ON grkt.kategori = grk.kategori"  
."\n , where actdate <= '$currYear- ". sprintf("%02d", $currMonth) . " - " . sprintf("%02d", $currDay). " '"
."\n , AND enddate >= '$currYear-". sprintf("%02d", $currMonth) . "-" . sprintf("%02d", $currDay). "'"
."\n , AND kodunit LIKE '%$ppdlms%'"; 
```

您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 2 行 SQL=SELECT jml 的“FROM lpk_egerak_subutama AS grk , inner join lpk_users AS jml ON jml.username =”附近使用正确的语法。*，grkt。*,grk。*,jml。*, FROM lpk_egerak_subutama AS grk , 内连接 lpk_users AS jml ON jml.username = grk.username , 内连接 lpk_egerak_kenyataan AS grkt ON grkt.kategori = grk.kategori , 其中 actdate <= '2013- 04 - 15 ' , AND enddate >= '2013-04-15' 和 kodunit LIKE '%%'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:11:06.493

```
$db = JFactory::getDbo();
$query = $db->getQuery(true);        
$query = "SELECT jml.*,grkt.*,grk.*,jml.*"
."\n FROM #__egerak_subutama AS grk"
."\n inner join #__users AS jml ON jml.username = grk.username"
."\n inner join #__egerak_kenyataan AS grkt ON grkt.kategori = grk.kategori"  
."\n where actdate <= '$currYear- ". sprintf("%02d", $currMonth) . " - " . sprintf("%02d", $currDay). " '"
."\n AND enddate >= '$currYear-". sprintf("%02d", $currMonth) . "-" . sprintf("%02d", $currDay). "'"
."\n AND kodunit LIKE '%$ppdlms%'"; 
```

删除行首的所有逗号。您收到错误是因为逗号使 mysql 期望另一个项目选择不是 from 关键字。

# c - 在 C 语言中，“forgiveme”和“forgivemenot”这两个名称什么时候可以指代同一个变量？

> ID：16020006
> 
> 赞同：3
> 
> 时间：2013-04-15T16:17:20.747
> 
> 标签：c, variable-declaration

[这个](http://www.dummies.com/how-to/content/declaring-variables-in-c.html)网站说“不要给你的变量起类似的名字。例如，编译器可能会假设`forgiveme`和`forgivemenot`是同一个变量。如果是这样，可能会出现丑陋的情况。”

我从未在变量命名中读过这个问题。这种丑陋的情况最有可能发生在什么时候？他们说编译器**可能**假设它们不是同一个变量是什么意思？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-15T16:21:14.103

名称的前 31 个字符应该是唯一的

§5.2.4.1 C11 标准的翻译限制说

> 实现应能够翻译和执行至少一个程序，该程序包含以下每个限制的至少一个实例：18）
> 
> — 外部标识符中的 31 个重要初始字符（指定 0000FFFF 或更小的短标识符的每个通用字符名称被视为 6 个字符，每个 18 个字符） 实现应尽可能避免施加固定的翻译限制。

相同的限制适用于 C99，因此您的示例名称应由过去 10 多年的任何符合标准的编译器唯一标识。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-15T16:25:43.317

C（从 1999 年开始）标准在`5.2.4.1 Translation limits`：

> 实施应能够翻译和执行至少一个程序，该程序至少包含以下每个限制的一个实例：
> — 外部标识符中的 31 个有效初始字符......

然后在`6.4.2 Identifiers / 6.4.2.1 General`：

> 如 5.2.4.1 所述，实现可能会限制标识符中有效初始字符的数量；...
> 
> 任何重要字符不同的标识符都是不同的标识符。如果两个标识符仅在非重要字符上有所不同，则行为未定义。

因此，如果支持的重要字符少于支持的重要字符，则被视为相同`forgiveme`是一种很好的未定义行为。`forgivemenot``10`

`31`是`6`1989 年的 C 标准（AKA ANSI C）中的内容。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-15T16:19:55.017

很久以前，一个符号的最大长度是八个字符。您可以使用超过八个的符号，但只有前八个是重要的。

那个时间在80年代的某个地方过去了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-15T16:19:59.167

曾经有一段时间，有（有）编译器限制了变量名的长度。例如，如果有问题的编译器只允许 8 个字符的变量名，那么实际上这将是一个问题，因为两者都是`forgiveme`同`forgivemenot`一个变量`forgivem`

然而，大多数现代编译器这不是问题。如果您正在使用一个神秘的编译器，或者一个存在变量名长度问题的小型嵌入式系统编译器，那么这可能是一个问题。

# c# - Orchard - “二级缓存”的警告

> ID：16020014
> 
> 赞同：2
> 
> 时间：2013-04-15T16:17:38.887
> 
> 标签：c#, orchardcms

我在果园日志文件中反复收到以下类型的警告

```
WARN Second-level cache is enabled in a class, but no cache provider was selected. Fake cache used. 
```

当设置为警告时，这会淹没日志。所以两个问题：

何

1.  我要摆脱这个警告吗？这意味着我应该实现一些东西，但这看起来像是低级 Orchard/NHibernate 内部。如果这不能“开箱即用”
2.  如果不解决，这会导致性能问题吗？

干杯

# php - 关于 PHP 魔术方法 __get 和 __set 继承

> ID：16020019
> 
> 赞同：4
> 
> 时间：2013-04-15T16:17:57.213
> 
> 标签：php, oop, inheritance, magic-methods

**OBS：**我直接在这里编码，因为我的代码要复杂得多。

如果我编码：

```
class SuperFoo {
    public function __get($name) {
        return $this->$name;
    }
    public function __set($name, $value) {
        $this->$name = $value;
    }
}

class Foo extends SuperFoo {
    private $bar = '';
}

$foo = new Foo();
$foo->bar = "Why it doesn't work?";
var_dump($foo); 
```

结果是：

```
object(Foo) {
    ["bar":"Foo":private]=> 
        string(0) ''
} 
```

而不是：

```
object(Foo) {
    ["bar":"Foo":private]=> 
        string(20) 'Why it doesn't work?'
} 
```

为什么会这样？我不想使用数组来保存属性，因为我需要将它们声明为单独的私有成员。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T16:20:30.127

~~您的代码应该会导致致命错误，因为您正在尝试访问私有属性。即使在此之前，您也应该收到语法错误，因为您没有正确声明您的函数。因此，您“导致” var dump 永远不会发生。~~

## 编辑：

你已经编辑了你的问题。**它不起作用的原因是因为`bar`是私有的`Foo`**（`SuperFoo`无法访问它）。`protected`代替它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T16:20:13.237

[`__get($name)`](http://www.php.net/manual/en/language.oop5.overloading.php#object.get) **如果 object 具有称为的属性，则不会**调用`$name`它，但它会尝试直接使用该属性。而且您的属性是私有的，因此是错误的。

> __set() 在将数据写入不可访问的属性时运行。
> 
> __get() 用于从不可访问的属性中读取数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-17T22:51:08.527

If **Foo::bar** is **private**, **Foo** needs to override **__get** and **__set**. This is because **SuperFoo** can't access private members of **Foo**. The following code works but it's ugly:

```
class SuperFoo {
    public function __get($name) {
        return $this->$name;
    }

    public function __set($name, $value) {
        $this->$name = $value;
    }
}

class Foo extends SuperFoo {
    private $bar = '';

    public function __get($name) {
        return $this->$name;
    }

    public function __set($name, $value) {
        $this->$name = $value;
    }
} 
```

The proper solution is to modify **Foo::bar** visibility to **protected**. Now **SuperFoo** has access to **Foo::bar** so there's no need to override **__get** and **__set** in **Foo**.

```
class SuperFoo {
    public function __get($name) {
        return $this->$name;
    }

    public function __set($name, $value) {
        $this->$name = $value;
    }
}

class Foo extends SuperFoo {
    protected $bar = '';
} 
```

**[Check out the PHP Documentation on visibility](http://php.net/manual/en/language.oop5.visibility.php)**

# oracle - Oracle 原子存储过程

> ID：16020022
> 
> 赞同：2
> 
> 时间：2013-04-15T16:18:04.450
> 
> 标签：oracle, stored-procedures

我正在编写一个在 Oracle 中将刷新包含非规范化数据的表的存储过程。该程序的概要是：

```
CREATE OR REPLACE PROCEDURE loadDenormalizedTable IS
BEGIN

DELETE FROM denormalizedTable;

INSERT INTO
    denormalizedTable
    (
        data
    )
SELECT DISTINCT
    data
FROM
    normalizedTables;

END;
/ 
```

我希望所有这些都发生在事务中，以便表中始终存在数据。现在删除运行并且表是空的几分钟，直到插入完成。在没有任何停机时间的情况下处理这种类型的表刷新的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:56:14.703

By default, a procedure will execute as part of a larger transaction owned by the session. As the [documentation](http://docs.oracle.com/cd/E11882_01/appdev.112/e25519/static.htm#i7105) mentions:

> **Note:** A transaction can span multiple blocks, and a block can contain multiple transactions.

With your code as outlined, no other session will see your delete *or* insert until you commit after calling the procedure. If you just execute it from an SQL*Plus prompt for example:

```
SQL> exec loadDenormalizedTable;

PL/SQL procedure successfully completed.

SQL> 
```

... then anybody else looking at the table will still see the old data, even after both the delete and insert have completed. (Anyone else trying to execute the procedure, or insert or delete data in `denormalizedTable`, will block, but presumably you're only expecting others to be querying it). Once you issue a `commit` then everyone will see the same thing.

The only way to get the behaviour you describe is to manually end the transaction within the procedure:

```
CREATE OR REPLACE PROCEDURE loadDenormalizedTable IS
BEGIN

DELETE FROM denormalizedTable;

COMMIT WORK; -- makes the delete visible elsewhere

INSERT INTO
    denormalizedTable
    (
        data
    )
SELECT DISTINCT
    data
FROM
    normalizedTables;    
END;
/ 
```

You do not not need to `commit` in the middle of the procedure, and it's very rare that you would or should ever want to do that as it breaks the atomicity.

It's possible you're doing something that does an implicit commit without you realising it; maybe calling another procedure or function that does its own commit (one of the reasons not to do that - it can have unexpected side-effects!), or perhaps a DDL statement - which will always do an implicit commit behind the scenes, but you'd have to be doing that with dynamic SQL anyway.

One other possibility is that you aren't actually doing a `delete`, but that you are doing a `truncate`. That would be visible to everyone else immediately, without an explicit commit, as hinted at [in the documentation](http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_10007.htm). That would also be a significant departure from the outline you provided though.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:55:28.797

If Oracle partitioning option is available, the best, and most efficient way to do it is to use the partition swapping operation. This is a very common operation done in many massive data warehouses.

See some examples at:

[http://www.akadia.com/services/ora_exchange_partition.html](http://www.akadia.com/services/ora_exchange_partition.html) [http://gerardnico.com/wiki/database/oracle/partition_exchange_loading](http://gerardnico.com/wiki/database/oracle/partition_exchange_loading)

For instance you could imagine having a second table with the same exact structure as denormalizedTable. To implement your load operation:

*   truncate denormalizedTable2
*   insert your data into denormalizeTable2
*   exchange the partition of tables denormalizedTable and denormalizedTable2

It usually guarantees a minimal impact on the running application.

# jquery - 数据表中的行高

> ID：16020025
> 
> 赞同：0
> 
> 时间：2013-04-15T16:18:16.493
> 
> 标签：jquery, jquery-plugins, jquery-datatables

这可能是一个愚蠢的问题，但我有一个 jQuery 数据表，我只是想确定内部数据行的高度。如何做到这一点？

我努力了：

```
$('#myTable tr').eq(0).height(); 
```

但它返回null。我知道这个表的 rowHeight 是自动的；如何以编程方式在此特定表中找到行的高度？我只需要获取这个值，而不是改变它。

谢谢。

**编辑：**正在显示的表格的 HTML

```
<div class="dataTables_scroll">
  <div class="dataTables_scrollHead ui-state-default" style="overflow: hidden; position: relative; border: 0px; width: 100%;">
    <div class="dataTables_scrollHeadInner" style="width: 699px;">
      <table class="display dataTable" style="margin-left: 0px; width: 699px;">
        <thead>
          <tr role="row">
            <th class="ui-state-default Center" tabindex="0" rowspan="1" colspan="1" style="width: 71px;"
            aria-label="Account #">
              <div class="DataTables_sort_wrapper">Account #</div>
            </th>
            <th class="ui-state-default Center" tabindex="0" rowspan="1" colspan="1" style="width: 62px;" aria-label="CS_ID">
              <div class="DataTables_sort_wrapper">CS_ID</div>
            </th>
            <th class="ui-state-default Center" tabindex="0" rowspan="1" colspan="1" style="width: 69px;"
            aria-label="Service Code">
              <div class="DataTables_sort_wrapper">Service Code</div>
            </th>
            <th class="ui-state-default Center" tabindex="0" rowspan="1" colspan="1" style="width: 94px;"
            aria-label="Service Description">
              <div class="DataTables_sort_wrapper">Service Description</div>
            </th>
            <th class="ui-state-default Center" tabindex="0" rowspan="1" colspan="1" style="width: 130px;"
            aria-label="STAT_EFF_DATE">
              <div class="DataTables_sort_wrapper">STAT_EFF_DATE</div>
            </th>
            <th class="ui-state-default Center" tabindex="0" rowspan="1" colspan="1" style="width: 94px;"
            aria-label="Stat Description">
              <div class="DataTables_sort_wrapper">Stat Description</div>
            </th>
            <th class="ui-state-default Center" tabindex="0" rowspan="1" colspan="1" style="width: 94px;"
            aria-label="Type Description">
              <div class="DataTables_sort_wrapper">Type Description</div>
            </th>
          </tr>
        </thead>
      </table>
    </div>
  </div>
  <div class="dataTables_scrollBody" style="overflow: auto; width: 100%; height: 37px;">
    <table id="vdmPtPropServiceListTbl" class="display dataTable" style="margin-left: 0px; width: 699px;">
      <thead>
        <tr role="row" style="height: 0px;">
          <th class="ui-state-default Center" tabindex="0" rowspan="1" colspan="1"
          style="width: 71px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;"
          aria-label="Account #"></th>
          <th class="ui-state-default Center" tabindex="0" rowspan="1" colspan="1"
          style="width: 62px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;"
          aria-label="CS_ID"></th>
          <th class="ui-state-default Center" tabindex="0" rowspan="1" colspan="1"
          style="width: 69px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;"
          aria-label="Service Code"></th>
          <th class="ui-state-default Center" tabindex="0" rowspan="1" colspan="1"
          style="width: 94px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;"
          aria-label="Service Description"></th>
          <th class="ui-state-default Center" tabindex="0" rowspan="1" colspan="1"
          style="width: 130px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;"
          aria-label="STAT_EFF_DATE"></th>
          <th class="ui-state-default Center" tabindex="0" rowspan="1" colspan="1"
          style="width: 94px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;"
          aria-label="Stat Description"></th>
          <th class="ui-state-default Center" tabindex="0" rowspan="1" colspan="1"
          style="width: 94px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;"
          aria-label="Type Description"></th>
        </tr>
      </thead>
      <tbody role="alert" aria-live="polite" aria-relevant="all">
        <tr class="odd">
          <td valign="top" colspan="7" class="dataTables_empty">No data available in table</td>
        </tr>
      </tbody>
    </table>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:06:15.837

这是[JSfiddle的链接](http://jsfiddle.net/dekajp/7Zk98/5/)

```
 body {

      background:yellow;

  }
  .trclass {

      height:40px;

      font-weight:bold;

  }

<body>
    <button id="getw">Get table Height</button>
    <div>&nbsp;</div>
    <p>Sample paragraph to test height</p>
    <table id="myTable" border="1">
        <tr class="trclass">
            <td>row 1col 1</td>
            <td>row 1 col 2</td>
            <td>row 1 col 3</td>
        </tr>
        <tr style="height:40px">
            <td>row 2 col 1</td>
            <td>row 2 col 2</td>
            <td>row 2 col 3</td>
        </tr>
    </table>
</body>

 function showHeight(ele, h) {
      $("div").text("The height for the " + ele +
          " is " + h + "px.");
  }

  $("#getw").click(function () {
      showHeight("table", $('#myTable tr').eq(0).height());
  }); 
```

# xslt - 如果属性的值相同，则 XSL 组合兄弟的值

> ID：16020026
> 
> 赞同：0
> 
> 时间：2013-04-15T16:18:16.633
> 
> 标签：xslt, xslt-1.0, concat

这就是我的 XML 的样子

```
<?xml version="1.0"?>
<Nodes>
<NodeA NodeAattr="123">

<NodeB NodeBattr="456"></NodeB>

  <NodeC>
     <NodeD NodeDAttr="ValueD">
        <NodeE Name="ValueABC"> "555" </NodeE >
        <NodeE Name="ValueABC"> "666" </NodeE>
     </NodeD>
  </NodeC>
</NodeA>
</Nodes> 
```

如果 NodeE 的 Name 属性值相同，则将 NodeE 的值连接起来。我的最终输出 xml 必须看起来像

```
<NodeA NodeAattr="123">

<NodeB NodeBattr="456"></NodeB>

  <NodeC>
     <NodeD="ValueD">
        <NodeE Name="ValueABC"> "555" , "666" </NodeE >
     </NodeD>
  </NodeC>
</NodeA> 
```

请向我提供 xsl .. 我正在使用 XSLT1.0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T19:24:19.547

这应该这样做：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>
  <xsl:strip-space elements="*" />

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="NodeE">
    <xsl:copy>
      <xsl:apply-templates select="@* | text()" />
      <xsl:call-template name="NextSibling" />
    </xsl:copy>
  </xsl:template>
  <xsl:template match="NodeE[@Name = preceding-sibling::*[1][self::NodeE]/@Name]" />

  <xsl:template match="NodeE" mode="includeSib">
    <xsl:value-of select="concat(',', .)"/>
    <xsl:call-template name="NextSibling" />
  </xsl:template>

  <xsl:template name="NextSibling">
    <xsl:apply-templates
      select="following-sibling::*[1]
                                  [self::NodeE and @Name = current()/@Name]"
      mode="includeSib" />
  </xsl:template>

</xsl:stylesheet> 
```

在此输入上运行时（使用一些附加值来展示其功能）：

```
<Nodes>
  <NodeA NodeAattr="123">

    <NodeB NodeBattr="456"></NodeB>

    <NodeC>
      <NodeD NodeDAttr="ValueD">
        <NodeE Name="ValueABC"> "555" </NodeE >
        <NodeE Name="ValueABC"> "666" </NodeE>
        <NodeE Name="ValueDEF"> "555" </NodeE >
        <NodeE Name="ValueDEF"> "565" </NodeE >
        <NodeE Name="ValueDEF"> "575" </NodeE >
        <NodeE Name="ValueABC"> "595" </NodeE >
      </NodeD>
    </NodeC>
  </NodeA>
</Nodes> 
```

结果是：

```
<Nodes>
  <NodeA NodeAattr="123">
    <NodeB NodeBattr="456" />
    <NodeC>
      <NodeD NodeDAttr="ValueD">
        <NodeE Name="ValueABC"> "555" , "666" </NodeE>
        <NodeE Name="ValueDEF"> "555" , "565" , "575" </NodeE>
        <NodeE Name="ValueABC"> "595" </NodeE>
      </NodeD>
    </NodeC>
  </NodeA>
</Nodes> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T10:30:36.253

这是基于我对[问题 #825783](https://stackoverflow.com/a/15926639/825783)的回答的解决方案：

### 样式表

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" version="1.0" encoding="utf-8" indent="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:key name="kNode" match="NodeE" use="@Name"/>

  <!--
  Identity transform: copy elements and attributes from input file as is
  -->
  <xsl:template match="node() | @*">
    <xsl:copy>
      <xsl:apply-templates select="node() | @*"/>
    </xsl:copy>
  </xsl:template>

  <!--
  Use Muenchian grouping to apply unique NodeE elements.
  See http://www.jenitennison.com/xslt/grouping/muenchian.html
  -->
  <xsl:template match="NodeE[generate-id() = 
                       generate-id(key('kNode', @Name)[1])]">
    <xsl:copy>
      <xsl:apply-templates select="@*"/>
      <!--
      Apply <NodeE> elements with the same @Name attribute value as the current
      element with the "concat" mode enabled
      -->
      <xsl:apply-templates select="key('kNode', @Name)" mode="concat"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="NodeE" mode="concat">
    <xsl:value-of select="."/>
    <!-- Add comma except if this is the last node -->
    <xsl:if test="position() != last()">
      <xsl:text>, </xsl:text>
    </xsl:if>
  </xsl:template>

  <!-- Drop other <NodeE> elements -->
  <xsl:template match="NodeE"/>

</xsl:stylesheet> 
```

### 输入

使用 JLRishe 提供的输入：

```
<Nodes>
  <NodeA NodeAattr="123">

    <NodeB NodeBattr="456"></NodeB>

    <NodeC>
      <NodeD NodeDAttr="ValueD">
        <NodeE Name="ValueABC"> "555" </NodeE>
        <NodeE Name="ValueABC"> "666" </NodeE>
        <NodeE Name="ValueDEF"> "555" </NodeE>
        <NodeE Name="ValueDEF"> "565" </NodeE>
        <NodeE Name="ValueDEF"> "575" </NodeE>
        <NodeE Name="ValueABC"> "595" </NodeE>
      </NodeD>
    </NodeC>
  </NodeA>
</Nodes> 
```

### 输出

这与 JLRishe 的输出不同，因为我对需求的理解不同：

```
<?xml version="1.0" encoding="utf-8"?>
<Nodes>
  <NodeA NodeAattr="123">
    <NodeB NodeBattr="456"/>
    <NodeC>
      <NodeD NodeDAttr="ValueD">
        <NodeE Name="ValueABC"> "555" ,  "666" ,  "595" </NodeE>
        <NodeE Name="ValueDEF"> "555" ,  "565" ,  "575" </NodeE>
      </NodeD>
    </NodeC>
  </NodeA>
</Nodes> 
```

# sql-server - SQL Server 查询以查找聚集索引

> ID：16020028
> 
> 赞同：8
> 
> 时间：2013-04-15T16:18:17.730
> 
> 标签：sql-server, tsql, identity, clustered-index

是否可以编写一个查询来返回所有具有不基于标识键的聚集索引的表？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-15T16:21:36.773

这个怎么样：

```
SELECT
    TableName = t.name, 
    ClusteredIndexName = i.name,
    ColumnName = c.Name
FROM
    sys.tables t
INNER JOIN 
    sys.indexes i ON t.object_id = i.object_id
INNER JOIN 
    sys.index_columns ic ON i.index_id = ic.index_id AND i.object_id = ic.object_id
INNER JOIN 
    sys.columns c ON ic.column_id = c.column_id AND ic.object_id = c.object_id
WHERE
    i.index_id = 1  -- clustered index
    AND c.is_identity = 0
    AND EXISTS (SELECT * 
                FROM sys.columns c2 
                WHERE ic.object_id = c2.object_id AND c2.is_identity = 1) 
```

好的，此查询将列出那些具有*非*标识列的主键，但在主键约束中还有第二列**是**一`IDENTITY`列。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-15T16:40:08.067

```
SELECT  s.name AS schema_name, o.name AS object_name, i.name AS index_name
FROM    sys.indexes i
JOIN    sys.objects o ON i.object_id = o.object_id
JOIN    sys.schemas s ON o.schema_id = s.schema_id
WHERE   i.type = 1 -- Clustered index
--AND       o.is_ms_shipped = 0 -- Uncomment if you want to see only user objects
AND     NOT EXISTS (
    SELECT  * 
    FROM    sys.index_columns ic INNER JOIN sys.columns c ON c.object_id = ic.object_id AND c.column_id = ic.column_id
    WHERE   ic.object_id = i.object_id AND ic.index_id = i.index_id
    AND     c.is_identity = 1 -- Is identity column
)
ORDER BY schema_name, object_name, index_name; 
```

Sample output (AdventureWorks2008R2):

```
schema_name    object_name                 index_name
-------------- --------------------------- --------------------------------------------------------------------
HumanResources Employee                    PK_Employee_BusinessEntityID
HumanResources EmployeeDepartmentHistory   PK_EmployeeDepartmentHistory_BusinessEntityID_StartDate_DepartmentID
HumanResources EmployeePayHistory          PK_EmployeePayHistory_BusinessEntityID_RateChangeDate
Person         BusinessEntityAddress       PK_BusinessEntityAddress_BusinessEntityID_AddressID_AddressTypeID
Person         BusinessEntityContact       PK_BusinessEntityContact_BusinessEntityID_PersonID_ContactTypeID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-19T17:48:00.567

以下查询将为您提供所有用户表、列、数据类型，如果该列是集群索引的一部分，它将返回列在结壳索引中的序列/顺序，否则它将返回 NULL。

```
SELECT U.name [OWNER],O.name [TABLE_NAME],C.name [COLUMN_NAME],T.name [DATA_TYPE],C.length [DATA_LENGTH], x.keyno [Primary_Key_order]
FROM syscolumns C
inner  join sysobjects O on O.Id=C.Id and o.xtype='U' -- User Tables
inner join sysusers U on O.Uid=U.UID
inner join systypes T on C.xtype=T.xtype
left outer join (Select O.name [TABLE_NAME] , C.name [COLUMN_NAME], IK.keyno
            from syscolumns C
            inner  join sysobjects O on O.Id=C.Id and O.xtype='U' -- User Tables
            join sysindexkeys IK on O.id=IK.ID  and C.colid=IK.COLID and Indid=1 -- Only Clustered Index
            ) x 
            on x.TABLE_NAME=O.name and X.COLUMN_NAME=C.name
order by U.name 
```

# java - 用于 SMS 的 Twilio 与谷歌语音 api

> ID：16020032
> 
> 赞同：16
> 
> 时间：2013-04-15T16:18:27.977
> 
> 标签：java, android, sms, twilio, google-voice

我正在构建一个需要使用 SMS 的移动应用程序（android 等）。当用户第一次注册我的应用程序时，SMS 会简单地发送一个激活码（也许还有另一个同样简单的用法）。由于谷歌是一家受人尊敬的公司，而且谷歌语音是免费的（[API](http://code.google.com/p/google-voice-java/)），我正在考虑使用谷歌语音。但是，很多开发人员似乎都在使用 Twilio。在我发送验证码的基本用法中，使用 Twilio SMS 优于 Google Voice SMS 是否有优势（同样，Google Voice 是免费的）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-16T16:07:18.780

您链接到的 API 不是官方的 Google API，因此不能保证它会可靠地工作，或者 Google 不会在某个时候决定禁用该 API。因此，您是在为一定程度的可靠性付费，而不是依赖非官方的 Google Voice 挂钩。

有很多可用的 SMS API，Twilio 肯定是众所周知的，但还有其他的。看看我发布的另一个答案，其中列出了一些提供商。[如何以专业可​​靠的方式以编程方式发送短信？](https://stackoverflow.com/questions/10929635/how-to-send-sms-programatically-in-a-professional-and-reliable-way/10949136#10949136)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-15T19:32:37.390

Google Voice 似乎[限制](http://support.google.com/voice/answer/115116?hl=en)了可以发送的 SMS 消息的数量。他们没有详细说明限制。

> 为防止滥用，您可以从 Google Voice 发送的短信数量有限制。如果您已达到限制，您将看到一条消息，显示“您的消息未发送，因为已达到短信限制。请稍后再试或尝试发送给更少的联系人。您将不得不发送给更少的人，或者尝试稍后发送您的短信。

Twillio 也确实[限制](http://www.twilio.com/help/faq/twilio-basics/what-are-the-limits-on-outbound-calls-and-sms-messages-per-second)了 SMS 消息的数量，但这是一个记录在案的限制。

> 每个启用 Twilio SMS 的长代码（常规 10 位数字）每秒可以发送 1 条 SMS 消息，每个号码。不幸的是，我们无法调整此速率限制。如果您的应用程序需要大量外发 SMS，我们建议使用 SMS 短代码。

所以我想不同的是，一个人可能会切断你，但它是免费的。另一个不会，如果你保持在他们的限制范围内，但要花钱。

# jquery - jquery 两次点击而不是一次执行代码

> ID：16020034
> 
> 赞同：-1
> 
> 时间：2013-04-15T16:18:37.143
> 
> 标签：jquery

我找到了这个 javascript 代码，这正是我正在寻找的。这是一个带有幻灯片效果的显示/隐藏代码。

```
$(document).ready(function() {
if($('div.tab').length > 0) {
    $('div.tab').click(function() {
        if($(this).hasClass('open')) {
            $(this).removeClass('open');
            $(this).addClass('close');
            $(this).next().slideDown(300);
            return false;
        } else {
            $(this).removeClass('close');
            $(this).addClass('open');
            $(this).next().slideUp(300);
            return false;
        }
    })
} 
```

现在，我想添加一个代码，一次只显示一个 DIV，用幻灯片效果关闭打开的 DIV。所以，我添加了一些代码，它可以按照我想要的方式工作。但问题是，当打开一个 DIV 并单击另一个新 DIV 时，一切正常，但是当我单击已访问的 DIV 时，我需要单击两次而不是单击一次来执行代码。我没有js编码方面的知识，所以我在这里寻求您的帮助。

这是我的更改的代码。

```
$(document).ready(function() {
if($('div.tab').length > 0) {
    $('div.tab').click(function() {
        if($(this).hasClass('open')) {
            $(this).removeClass('open');
                  $(this).addClass('close')**.siblings('div.container').slideUp(300)**;
            $(this).next().slideDown(300);
            return false;
        } else {
            $(this).removeClass('close');
            $(this).addClass('open');
            $(this).next().slideUp(300);
            return false;
        }
    })
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T09:46:45.173

我已经成功了。我更改了一些代码，我得到了我正在寻找的东西。它现在一次显示一个选项卡，单击同一选项卡时显示/隐藏工作。也许这不是一种正确的编码方式，因为我没有 js 知识，但它对我来说非常有用。

```
$(document).ready(function() {

$('div.tab').click(function() { 
    if($(this).hasClass('open')) {
        $(this).next().slideToggle(300).siblings('div.container').slideUp(300);

    } else {

        $(this).next().slideToggle(300);

    }
}) 
```

}) [http://jsfiddle.net/9szef/1/](http://jsfiddle.net/9szef/1/)

# firefox - Firefox 20 上的 Destory 函数发出 GET 请求

> ID：16020035
> 
> 赞同：1
> 
> 时间：2013-04-15T16:18:39.970
> 
> 标签：firefox

我有一个奇怪的错误，我在标准主干模型上发出标准销毁函数，但在服务器端收到 GET 请求而不是 DELETE：

请求代码

```
var User = Backbone.Model.extend({
idAttribute: "id",
url: "/private/1.1/user/"
})

user = new User({"id":"ilya+1@test.com"})

user.destroy() 
```

我在 firebug 中将其视为正确的 DELETE 请求

```
DELETE http://localhost:8080/private/1.1/user/ 
```

但是当我启动wireshark时，在firefox 20（在linux上）上发送的实际请求是GET而不是DELETE，在chrome上这可以按预期工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T09:18:11.267

原来这是一个由 css 文件触发的 noscript 错误，去图...

一个结论是，如果网络中发生了奇怪的事情，请尝试禁用 noscript。

# python - django auto_add_now 不工作

> ID：16020037
> 
> 赞同：2
> 
> 时间：2013-04-15T16:18:43.687
> 
> 标签：python, django

我有一个模型，当我使用时会抛出错误`python manage.py syncdb`

在这一行`createdAt = models.DateTimeField(auto_add_now=True)`，错误是

```
File "/home/vaibhav/TRAC/coupon-rest-api/couponRestApi/couponRestApiApp/models.py", line 18, in tags
  createdAt = models.DateTimeField(auto_add_now=True)
File "/usr/local/lib/python2.7/dist-packages/django/db/models/fields/__init__.py", line 660, in __init__
  Field.__init__(self, verbose_name, name, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'auto_add_now' 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-15T16:21:06.367

打错字了，`auto_now_add`不正确`auto_add_now`。

# objective-c - uitextview 不适合其内容

> ID：16020043
> 
> 赞同：0
> 
> 时间：2013-04-15T16:19:05.477
> 
> 标签：objective-c, uitextview

我的应用程序中的 uitextview 有问题。

我在我的应用程序中使用了这个组件[Collapse Click](https://github.com/bennyguitar/CollapseClick) ，但是当我添加一个带有 textview 的子视图时，我遇到了一些问题。

我需要调整 uitextview 的大小，以便在打开面板时在没有滚动条的情况下看到它。

```
CGRect newTextFrame = self.taskInfoText.frame;
newTextFrame.size = self.taskInfoText.contentSize;
newTextFrame.size.height = newTextFrame.size.height;
self.taskInfoText.frame = newTextFrame;
[self.taskInfoText setContentSize:self.taskInfoText.frame.size]; 
```

使用这段代码，如果面板以纵向模式打开，则没有问题，并且文本适合 uitextview。当我以横向模式打开面板时，uitextview 内的文本不适合，直到视图控制器旋转两次。

我该如何解决？

谢谢

我设置文本视图大小的函数是这样的：

```
 -(void)resizeTextViewOnContent
{   
    CGRect newTextFrame = self.taskInfoText.frame;
    newTextFrame.size = self.taskInfoText.contentSize;
    newTextFrame.size.height = newTextFrame.size.height;
    newTextFrame.size.width = newTextFrame.size.width;
    newTextFrame.size.width = newTextFrame.size.width;
    self.taskInfoText.frame = newTextFrame;
    [self.taskInfoText setContentSize:self.taskInfoText.frame.size];
} 
```

这是调整视图容器大小的那个

```
 -(void)resizeToFitSubviews
{
    float width = 0;
    float height = 0;

    for (UIView *v in [self.view subviews])
    {
        if(v.tag != 3)
        {
            float fw = v.frame.origin.x + v.frame.size.width;
            float fh = v.frame.origin.y + v.frame.size.height;
            width =  MAX(fw, width);
            height = MAX(fh, height);
        }
    }

    CGRect orientationRect = [UtilityService getScreenBoundsForCurrentOrientation];

    [self.view setFrame:CGRectMake(self.view.frame.origin.x,
                                   self.view.frame.origin.y,
                                   orientationRect.size.width,
                                   height)];

     NSLog(@"RECT FRAME: %@", NSStringFromCGRect(self.view.frame));
} 
```

# c - 从程序集中调用 C 函数，段错误

> ID：16020048
> 
> 赞同：2
> 
> 时间：2013-04-15T16:19:32.020
> 
> 标签：c, function, pointers, assembly, nasm

我正在编写一个汇编函数来替换字符串中的字母，一个字符一个字符，如果该字符传递给一个函数（由函数指针参数给出），则返回 1。例如，如果 isVowel(c) 为特点。调用函数指针时出现段错误。我使用 ebx 作为字符串中要倒数的字符数。

使用 Linux、Nasm、x86

这是c中的汇编函数签名：

```
int strrepl(char *str, int c, int (* isinsubset) (int c) ) ; 
```

如果我错了，请纠正我，但是：

> - 字符串指针位于 ebp+8。
> - 要替换​​的字符在ebp+12 中，占用4 个字节（16 位）。
> -函数指针为ebp + 28；

调用表单组件的函数：

```
int isvowel (int c) {

   if (c == 'a' || c == 'e' || c == 'i' || c == 'o' || c == 'u') 
      return 1 ;

   if (c == 'A' || c == 'E' || c == 'I' || c == 'O' || c == 'U') 
      return 1 ;

   return 0 ;
} 
```

这是我的实现

```
mov     edx, [ebp + 28]
mov     esi, [ebp + 8]
mov     eax, [esi + 4*ebx - 4] 
```

之后 gdb 显示 eax = 0 。然后，

```
push    eax
call    edx 
```

以上产生SEGFAULT

```
add     esp, 4 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:26:05.147

> *   字符串指针位于 ebp+8。
> *   要替换的字符在 ebp+12 中，占用 4 个字节（16 位）。
> *   函数指针为ebp + 28；

按照您的约定，由于函数指针存储在字符之后，因此它的地址是`ebp + 16`而不是 28。地址是面向字节的而不是面向位的。

# string - 从 XIB 上定义的 UILabel 加载属性字符串，这不是 self.view 的一部分

> ID：16020049
> 
> 赞同：0
> 
> 时间：2013-04-15T16:19:33.927
> 
> 标签：string, uilabel, xib, nib, nsattributedstring

我想知道是否可以在 Xib 文件上定义 UILabel，并在该标签上定义具有不同字体、样式、大小等的属性字符串...

然后将该标签连接到一个属性，但没有将其加载到 self.view 上（因为我只想将属性字符串数据传递给另一个视图）

当我尝试这样做并尝试访问属性的“attributedString”变量时，它给了我一个 nil 值。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-04T18:55:14.043

我认为这段代码会对你有所帮助，这段代码允许你获取任何属性（比如标签的属性文本）并读取属性。此行中抓取的属性仅采用标签属性文本中第一个字符的属性：

```
NSDictionary *attributes = [self.label.attributedText attributesAtIndex:0 effectiveRange:NULL]; 
```

# bash - 每次访问链接时让我的 Firefox bash 脚本打印一行

> ID：16020053
> 
> 赞同：1
> 
> 时间：2013-04-15T16:19:37.520
> 
> 标签：bash, url, hyperlink, show

您好，我的 bash 脚本中有一部分代码需要帮助，我正在使用以下代码打开文本文件中的链接

```
while read line; do 
    firefox -new-tab "$line" & 2>/dev/null
    sleep 15
done < file1 
```

这确实工作得很好，但我想让脚本在每次打开新 URL 时打印一组消息，即（链接已访问）。

还有什么方法可以让我的 bash 脚本始终位于所有窗口之上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:29:52.247

添加消息就像这样简单：

```
while read line; do 
    firefox -new-tab "$line" & 2>/dev/null
    echo "Visted $line"
    sleep 15
done < file1 
```

你没有说你正在使用什么操作系统，但是，给定 bash，我假设是 Linux，所以你通常可以通过右键单击标题栏并从菜单中选择适当的项目来将终端窗口保持在顶部。不过，这确实因桌面环境而异。

# php - 参数 - 此服务的最佳实践

> ID：16020068
> 
> 赞同：3
> 
> 时间：2013-04-15T16:20:21.913
> 
> 标签：php, symfony, symfony-2.2

在阅读了很多关于 Symfony2 DIC 和语义配置的信息后，我问自己：“那么，现在我要如何才能达到我想要达到的目标！？”

# 设想

想象一下，您想创建一个非常像“管理仪表板调度程序”的服务。
这意味着我有一些我想做 CRUD 的实体。我不想做的是我项目中每个实体的*路由->动作->逻辑的组合；*那是因为，以这种方式，我必须为每个对象编写如下内容：

*   /添加/实体
*   addEntityAction
*   实体逻辑

其中“实体”当然是对象中实体的名称。

我正在构建一个服务（如调度程序），它将响应操作（添加-删除-编辑）但它是参数化的：我将在地址栏上写入类似`/add/entityA`或`/add/entityB`的内容，并且路由将引导我执行相同的操作（当然）我是否记得我的服务与实体名称。
在这一点上，我的服务应该很聪明地知道什么是 EntityClass、FormTypeClass 和对象中实体的模板文件。

我的精神混乱来了

我必须做一些初步配置，比如下面的 php 数组（这只是一个例子）

```
array(
'EntityA'=>array(
  'class'=>'BundleName/Entity/EntityA',
  'form'=>'BundleName/Form/entityAType',
  'template'=>'EntityATemplate'),
'EntityB'=>array(
  'class'=>'BundleName/Entity/EntityB',
  'form'=>'BundleName/Form/entityBType',
  'template'=>'EntityBTemplate'),
[...]
); 
```

或等效的东西。

# 但 ....

对于这种情况，考虑到只有我和我的团队会使用这个捆绑包（所以不是第三方捆绑包），最佳实践是什么？

## 第一个解决方案

`parameters.php`如果我定义了一些常量或静态成员，请使用文件

## 第二种解决方案

直接在我的服务中使用地图（如以前的数组）

## 第三个解决方案

为我的包使用语义配置，定义扩展类等等

如果我不得不说实话，我不能说什么更好。显然第一个和第三个比第二个更好。
第一个解决方案打破了 symfony2 的理念，但似乎是唯一的方法，因为第二个解决方案似乎只有在我必须触发创建一些直接由我的 DIC 处理的服务（以级联方式）或具有配置层次结构时才有用，或者用于合并多个配置文件，或者（对于第三方捆绑包可能最重要）对配置进行某种验证。文件

你怎么看？您是否看到其他一些方法可以做到这一点，或者您只是更喜欢第三种解决方案？我想知道你的意见。

编辑：显然我可以使用构建器注入或设置器注入，但我认为它进入“DIC”部分（所以，第三个解决方案）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T13:46:36.417

如果您想以 Symfony 的方式进行操作，我建议您使用配置（如果我理解正确的话）：

```
acme_foo:
    entities:
        FooEntity:
            class_type: Acme\FooBundle\Entity\Foo
            form_type: Acme\FooBundle\Form\Type\FooType
            template: AcmeFooBundle:Entity:foo.html.twig
        BarEntity:
            class_type: Acme\FooBundle\Entity\Bar
            form_type: Acme\FooBundle\Form\Type\BarType
            template: AcmeFooBundle:Entity:bar.html.twig 
```

使用`AcmeFooExtension`该类，您可以设置包含配置的容器参数。然后，您可以将其注入您的服务（这是一个事件侦听器）。当`/add/Foo`被调用时，您可以调度一个`acme_foo.entity_add`由侦听器使用的事件。

您应该记住的是，您可以放入`config.php`或`parameters.php`文件中的所有内容都可以放入应用程序配置（`config.yml`）中。

# asp.net - 将@font-face 与 ABCPDF 一起使用？或将字体转换为 PDF 的其他方式？

> ID：16020072
> 
> 赞同：5
> 
> 时间：2013-04-15T16:20:37.530
> 
> 标签：asp.net, vb.net, font-face, abcpdf

我们有一个大型应用程序成功地使用带有 HTML 样式文本的 ABCPDF.NET。我们习惯于使用未安装在 Windows 中但存储在文件系统中其他位置的文件中的字体添加文本——我们这样做是为了让每个用户都可以上传自己的字体并将它们与输出一起使用。我们使用 AddFont 调用将字体嵌入到 Doc 中，然后使用 AddText 调用在 HTML 样式文本的标记中引用该字体。

我们开始考虑使用 AddImageUrl / AddImageHTML 来获得更多的 HTML 功能。因此，字体是一个症结所在。似乎 MSHTML 和 Gecko 引擎只能看到与 Windows 相同的字体列表。

我尝试了这段代码来查看@font-face 是否可以与 Gecko 一起使用：

```
Sub Main
    dim pdf as new Doc
    with pdf.HtmlOptions
        .Engine = EngineType.Gecko
        .FontEmbed = true
        .FontSubstitute = false
        .FontProtection = false
    end with
    pdf.AddImageUrl("http://www.w3.org/2010/09/web-on-tv/slides/1009-tv-web-chaals/demos/webfonts.htm")
    pdf.Save("c:\temp\a.pdf")
End Sub 
```

但它不会。还有什么我可以做的吗？

这是 ABCpdf.NET 8.1.0.7。升级到 9 或更高版本的 8 会有所帮助吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T17:00:39.610

笔记：

从 ABCpdf 11 开始，这是可行的。字体文件必须位于可访问的 HTTP/HTTPS url 中（使用`AddImageHTML()`或`AddImageURL()`，或者，如果您希望使用`file:///`URL，则必须将 HTML 写入文件并使用`AddImageURL()`. 字体文件可以是 OpenType、TrueType、Type 1 或 WOFF网络字体。

有问题的示例代码现在可以工作，没有改变。

* * *

*上一个答案：*

WebSuperGoo 回应：

> ABCpdf 目前不支持使用@font-face 添加的字体。

所以，从 ABCpdf 的 9.0 版本开始，就是这样。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-06-18T10:05:18.837

我在 ABCpdf 上工作，我可以告诉你，它作为功能请求已被关闭。请求的人越多，它就会越快到来。:-)

# iphone - 如何激活后台应用程序以使用附近的另一台设备为 TCP/IP 流提供服务？

> ID：16020073
> 
> 赞同：1
> 
> 时间：2013-04-15T16:20:56.507
> 
> 标签：iphone, ios, bonjour

我有两个设备，一个'经理' iphone 和一个'工人' iphone，彼此靠近。

一部 iPhone 上的“工作人员”应用程序需要通过蓝牙或 WIFI 响应来自附近另一部 iPhone 上的“经理”应用程序的数据请求。

工作程序应用程序将自身发布为 Bonjour 服务。

第二部 iPhone 上的管理器应用程序通过 Bonjour 找到工作应用程序服务，并尝试建立 TCP/IP 数据连接。

但是如果工作应用程序处于后台模式，如何唤醒它以开始使用远程管理器应用程序服务 TCP/IP 流？

（我是 Bonjour 新手，但我是 iPhone 流媒体老手。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:42:15.877

Apple 不为通用服务器提供后台模式，因此如果您想发布到 App Store 并且您的应用程序不适合其他后台模式之一，那么您就不走运了。如果您不必通过 App Store，那么您可以使用多种技巧之一使您的应用程序在后台运行，例如滥用 VOIP 或媒体播放器后台模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-05T16:50:04.420

我正在使用 Apple 的核心蓝牙（蓝牙低功耗 - BTLE），因为它在后台工作。

[https://developer.apple.com/library/ios/documentation/CoreBluetooth/Reference/CoreBluetooth_Framework/_index.html#//apple_ref/doc/uid/TP40011295](https://developer.apple.com/library/ios/documentation/CoreBluetooth/Reference/CoreBluetooth_Framework/_index.html#//apple_ref/doc/uid/TP40011295) [查看苹果核心蓝牙框架参考](https://developer.apple.com/library/ios/documentation/CoreBluetooth/Reference/CoreBluetooth_Framework/_index.html#//apple_ref/doc/uid/TP40011295)

# node.js - Node.js/Express/Passport 是否有像 CanCan for Rails 这样的授权模块？

> ID：16020080
> 
> 赞同：18
> 
> 时间：2013-04-15T16:21:14.300
> 
> 标签：node.js, express, passport.js

一旦用户通过身份验证，我想要一种方法来设置用户可以查看、编辑和删除的限制。具体来说，除非他们是管理员，否则他们只能查看、编辑和删除他们拥有的文件。我已经看到了 EveryAuth 和 Ability.js 的一些示例，只是想知道使用 Passport.js 的人是否有等价物

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T06:10:30.817

可能它可以帮助您实现您想要的 [https://github.com/ForbesLindesay/connect-roles](https://github.com/ForbesLindesay/connect-roles)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-04T14:45:12.917

[https://github.com/vadimdemedes/cancan](https://github.com/vadimdemedes/cancan)是基于Rails CanCan 编写的node 包

例子：

```
const CanCan = require('cancan');

const cancan = new CanCan();
const {allow, can} = cancan;

class User {}
class Product {}

allow(User, 'view', Product);

const user = new User();
const product = new Product();

can(user, 'view', product);
//=> true

can(user, 'edit', product);
//=> false 
```

# c# - 提供对 mvc 4 中物理文件夹的访问

> ID：16020081
> 
> 赞同：0
> 
> 时间：2013-04-15T16:21:16.057
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

在我的 MVC 4 applciation 的根项目文件夹中，我有一个特殊的文件夹`Themes`，它使用 3-rd 方主题，它是脚本、css、图像、字体`*.woff`文件的列表，它们使用自己的子文件夹结构，我想公开这个文件夹内容，例如，在我的 URL 的某些特定部分下`http://MySite.com/Themes/...`，我不想为此目的使用捆绑和缩小，因为这需要我投入巨大的精力重新编译所有现有脚本，调查它们的内容等。有没有办法只打开对该文件夹的读取权限？

# python - 从virtualenv环境中的源代码tarball构建的可重定位（自包含）Python？

> ID：16020086
> 
> 赞同：7
> 
> 时间：2013-04-15T16:21:28.667
> 
> 标签：python, python-2.7, virtualenv

我查看了`virtualenv`文档，并[在 StackOverflow 找到了这个问题](https://stackoverflow.com/questions/11249901)。但是，既不回答我的问题，或者我可能遗漏了什么，所以我在问。

如何创建一个`virtualenv`包含`python`不依赖于`python`“主机”（系统范围）的环境？即我想要一个完全独立的`virtualenv`，它自己的 Python 2.7 是从源代码编译的。另一个属性很重要：因为`virtualenv`与内部不同，`chroot`必须处理不同的绝对路径。`python``virtualenv`

我认为最接近我想要的是`virtualenv --relocatable`内部有自己的 Python 安装。

我怎样才能做到这一点？

### 基本原理

我有一些较旧的 Linux 机器，它们通过包管理器提供了不同版本的 Python。管理员不允许我在盒子上构建更新的 Python，因此我需要能够将 Python 从源代码安装到我拥有的受限环境中。

### 我需要的属性：

*   `virtualenv`环境应该是*完全*独立的（包含所有库等的完整 Python）
*   `python`无论部署时的绝对路径如何，内部都应该 工作
    *   我知道这`$ENV/bin/python`似乎是这样做的，但它似乎也依赖于已`python`安装的系统范围。我想完全消除这种依赖关系，使用我自己的 Python。
*   应该表现得像 with`virtualenv --relocatable`但还需要**包含**完整的 Python 安装。

### 在这个问题的范围内可以忽略的问题：

*   架构/平台。这将只在单一架构上运行，并且`virtualenv`将为每个平台构建环境（目前只有各种 Linux 发行版）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T17:46:08.453

1.  获取python源码
2.  `./configure --prefix=/dest`
3.  `make && make install`

恭喜，你现在有了一个完全独立于系统 python in 的 python 安装`/dest`。如果这就是“可重定位”的意思，那么移动这个目录应该不是问题。

要使用此安装而不是系统 python，只需确保放在`/dest/bin`标准`PATH`位置之前。

如果这对您来说还不够，您可以使用此 python 安装设置 virtualenv...

# php - 在运行 MySQL 之前验证 PHP 中的变量？

> ID：16020089
> 
> 赞同：0
> 
> 时间：2013-04-15T16:21:35.590
> 
> 标签：php, mysql, validation, get

我知道这个问题已经被问了一百万次，但是今天（2013 年）在 SQL 语句中运行变量之前验证查询字符串的标准是什么？

例如，如果我通过 $_GET['id'] 从 url 接收到变量“id”：

```
$id = $_GET['id']; 
```

...运行前我应该做什么：

```
SELECT * FROM users WHERE id="$id" 
```

这够了吗：

```
$id = mysql_real_escape_string($_GET['id']); 
```

...对于这个具体的例子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:24:11.167

这无关紧要，因为在大多数常规情况下 id 都是整数。你必须使用：

```
$id = (int)$_GET['id']; 
```

现在的标准方法是使用参数化查询/准备语句，这些语句在 MySQLi 和 PDO 的库中表示。

对于任何手动验证，您需要明智地考虑您希望收到此变量的内容。

在这种情况下，您只需要整数，没有别的。你不需要人们通过 ID -> 发送`1 UNION SELECT ...`它仍然是一个有效的字符串，并且 mysql_real_escape_string 不会对它做任何事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:27:20.433

在这种情况下，最简单的验证就是强制转换为整数。

```
<?php

$id = (int) $_GET['id'];

$sql = "SELECT * FROM users WHERE id=$id"; 
```

然后，您不需要在 SQL 表达式中的变量周围加上引号。事实上，在某些情况下，在数字文字周围使用引号会扰乱 SQL 优化器，所以我总是很困惑为什么这么多人养成这种习惯。

如果您想进行更复杂的验证，请阅读[PHP 的过滤器扩展](http://www.php.net/manual/en/book.filter.php)。

最后，在 SQL 中使用变量的更好（更简单、更快、更安全）的方法是使用查询参数。但是 PHP 的弃用`mysql_*`函数不支持查询参数，所以你应该学习[mysqli](http://www.php.net/manual/en/book.mysqli.php)或[PDO](http://www.php.net/manual/en/book.pdo.php)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T16:28:34.967

您可能应该[`mysqli`](http://www.php.net/manual/en/book.mysqli.php)从 deprecated切换到`mysql_`可以利用[`mysql::prepare()`](http://php.net/manual/en/mysqli.prepare.php)它允许您使用占位符的位置：

```
$stmt = $mysqli->prepare("SELECT District FROM City WHERE Name=?");
$stmt->bind_param("s", $city);
$stmt->execute(); 
```

SQL 所能获得的安全性。

但是`mysql_real_escape_string()`足以防止 SQL 注入（只要将字符串括在引号中）。

# windows-phone-7 - 使用 Visual Studio 2012 创建 WP7.1 商店包

> ID：16020091
> 
> 赞同：0
> 
> 时间：2013-04-15T16:21:43.677
> 
> 标签：windows-phone-7, visual-studio-2012, app-store, windows-phone-7.1

我在 Visual Studio 2012 中开发了一个 WP7.1 应用程序，我想创建商店/应用程序包。文档说我应该有一个“项目”>“商店”>“创建应用程序包”菜单选项，但我的“项目”选项卡中没有“商店”选项。

我是否必须首先将我的项目与商店项目链接或类似的东西？因为我在属性和清单文件中搜索了该选项，但找不到。

我确定我现在完全没有注意到，但这让我发疯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:51:15.077

您指的是 Windows 应用商店包创建机制。尽管应用程序可能共享一些代码，但 Windows Phone 包的创建是不同的。

当您构建 Windows Phone 应用程序时，您会得到一个 XAP 文件（[什么是 XAP 文件？](https://stackoverflow.com/a/5190511/303696)）。每次构建解决方案时都会生成 XAP 文件。根据您使用的是**Debug**还是**Release**配置，包将位于`PROJECT_FOLDER\bin\Debug`或`PROJECT_FOLDER\bin\Release`.

提交到 Windows Phone Marketplace 时，您应该**只使用****Release**中内置的包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T17:38:52.970

只需在`Release`模式下构建您的应用程序，包将自动生成到您的项目`\bin\Release\`目录中。

它有`.xap`扩展名。

# wpf - 在 ResourceDictionary 中定义 UserControl？

> ID：16020095
> 
> 赞同：2
> 
> 时间：2013-04-15T16:21:50.600
> 
> 标签：wpf, resourcedictionary

是否可以在 ResourceDictionary 中定义 UserControl，然后将其添加到同一 XAML 文件中的组件中？就像是：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        etc.>
    <Window.Resources>
        <ResourceDictionary>
            <UserControl x:Key="MyCustomLabel">
                <Label Content="Foo"/>
                ...lots more here
            </UserControl> 
        </ResourceDictionary>        
    </Window.Resources>
    <Grid>
        <MyCustomLabel />  //This doesn't work
        <MyCustomLabel />
        <MyCustomLabel />
    </Grid>
</Window> 
```

我可以在它自己的文件中定义它，但我真的只需要它作为这个文件中的一个子组件。我会使用样式，但我不知道如何设置网格每一行内容的样式。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:57:14.180

You can achieve this with a `DataTemplate` resource and a `ContentPresenter` control. Here is an example which works analogously with your `UserControl`:

```
<Window>

    <Window.Resources>
        <DataTemplate x:Key="ButtonTemplate">
            <Button Content="{Binding}"/>
        </DataTemplate>            
    </Window.Resources>

    <StackPanel Margin="35">
        <ContentControl ContentTemplate="{StaticResource ButtonTemplate}" Content="Hallo" />
        <ContentControl ContentTemplate="{StaticResource ButtonTemplate}" Content="123" />
        <ContentControl ContentTemplate="{StaticResource ButtonTemplate}" Content="ABC" />
    </StackPanel>

</Window> 
```

The `ContentControls` render as:

![Rendered](https://i.stack.imgur.com/25wsN.png)

Just replace `Button` with your own control and it should do what you want...

# asp.net-mvc - 想要启动一个长时间运行的进程，然后直接转到将轮询数据库以报告进度的页面（MVC 4）

> ID：16020096
> 
> 赞同：0
> 
> 时间：2013-04-15T16:21:51.760
> 
> 标签：asp.net-mvc, multithreading, asp.net-mvc-4, asynchronous, process

我读过几篇文章，不清楚正确的方法。所以我的基本想法是我可以创建一个线程并运行它，然后让控制器转到另一个视图...在那个视图中我可以对控制器上另一个方法的 jquery 调用，该方法使用计时器检查每 5 秒创建了多少行...这有意义吗？

我不需要从对长时间运行的进程的调用中返回的值。我只需要它启动，下一页将报告进度...

那么我要使用新的 async/await 吗？任务？线？

我想我不需要使用 async/await 因为我对返回值不感兴趣？

编辑：

所以你说下面的代码是一件坏事，因为我的代码已经停止运行并且对httpcontext一无所知，所以永远不会发生'catch'？

```
 public ActionResult ValidateUnprocessedData()
    {
        //Check table for jobs to be started
        List<TaskInstance> taskInstancesNotStarted = InstanceExpert.GetAllTaskInstancesNotStarted();

        try
        {
            Thread thread = new Thread(() => ValidateProcesses(taskInstancesNotStarted));
            thread.Start();
        }
        catch (Exception ex)
        {
            InstanceErrorExpert.LogErrorGeneric(ex.Message);
        }

        return View("Index");
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:27:00.283

您（可能）不想在 ASP.NET 中执行长时间运行的进程，因为[它不是为它设计的](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)。

你最好使用一个实际的工作服务（例如，Azure 工作角色或 Win32 服务），将其结果放在持久存储（例如，Azure 表）中。然后您可以使用 ASP.NET 进行轮询。

# javascript - 如何从 jQuery 选择器生成的集合中提取数据？

> ID：16020101
> 
> 赞同：2
> 
> 时间：2013-04-15T16:22:06.813
> 
> 标签：javascript, jquery, html

只是一个小例子。我有 3 个链接、一个按钮和一个 div：

```
<a href="#">AAA</a>
<a href="#">BBB</a>
<a href="#">CCC</a>
<button id="getResult">Get result</button>
<div id="result"></div> 
```

现在，当按下按钮时，我想从 3 个链接中获取文本并将它们插入到结果 div 中。这是我的代码：

```
<script type="text/javascript">
    $(function() {
        $('#getResult').click(function() {
            var links = $('a');
            $.each(links, function() {
                $('#result').append('<p>' + links.html() + '</p>');
            });
        }); // end click
    }); // end ready
</script> 
```

我希望结果是

```
AAA
BBB
CCC 
```

但它是

```
AAA
AAA
AAA 
```

有谁知道为什么以及如何解决这个问题？如果你有更好的方法来做到这一点，你能告诉我吗？我对 jQuery 很陌生。感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T16:24:44.207

在您`.each`调用的函数内部，它只获取集合中*第一个*元素`links.html()`的 html 。你的意思是使用（可能）。*`$(this).html()`*

 *[http://jsfiddle.net/ExplosionPIlls/xZymh/](http://jsfiddle.net/ExplosionPIlls/xZymh/)

顺便说一句，您可以将其重写为仅使用`.html`方法本身进行附加：

```
$("a").html(function (_, html) {
    $("#result").append("<p>" + html + "</p>");
}); 
```

[http://jsfiddle.net/ExplosionPIlls/xZymh/1/](http://jsfiddle.net/ExplosionPIlls/xZymh/1/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-15T16:24:25.723

代替

```
 $.each(links, function() {
            $('#result').append('<p>' + links.html() + '</p>'); 
```

和

```
 links.each(function() {
            $('#result').append('<p>' + $(this).html() + '</p>'); 
```

或者干脆

```
$('a').each(function() {
     $('#result').append('<p>' + $(this).html() + '</p>');
}); 
```

您没有使用迭代项，您应该使用[.each](http://api.jquery.com/each/)而不是[$.each](http://api.jquery.com/jQuery.each/)来迭代 jQuery 集合。

另一种更直接的解决方案是，仅导致 DOM 的一次更改（这通常是昂贵的操作）是：

```
$('#result').html(
  $('a').map(function(){return '<p>'+this.innerHTML+'</p>'}).get().join('')
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T16:25:45.597

当有疑问时，让事情变得简单。您可以在不需要 jQuery $.each 语句的情况下执行此操作。我不是 100%，但我认为它无论如何都被错误地使用了。

而不是 $.each 试试这个

```
for (var i = 0; i < links.length; i++){
   var linkHtml = links[i].html();
   $('#result').append('<p>' + linksHtml + '</p>');  
} 
```

希望有帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T16:26:16.070

试试这个，你需要迭代链接，所以使用 links.each 在这里查看小提琴[http://jsfiddle.net/raQtf/](http://jsfiddle.net/raQtf/)

```
$(function() {
        $('#getResult').click(function() {
             var links = $('a');
            links.each(function(){
                $('#result').append('<p>' + $(this).html() + '</p>');
            });

        }); // end click
    }); // end ready 
```*

# selenium - 在表中选择回发的行

> ID：16020103
> 
> 赞同：0
> 
> 时间：2013-04-15T16:22:14.200
> 
> 标签：selenium, selenium-webdriver

我在java中使用selenium webdriver并卡在一个地方。实际上页面上有一个表格，在选择每一行时页面回发并将用户带到下一页。在HTML javascript中正在使用。页面的html看起来像这样：-

```
<td onclick="javascript:__doPostBack('ctl00$DefaultContent$WorklistCtrl$WorklistView','Select$4')" onmouseout="this.style.textDecoration='none';" onmouseover="this.style.cursor='pointer';this.style.textDecoration='underline';" style="cursor: pointer; text-decoration: none;">
  kalis, jack
</td> 
```

这是表格中的一个单元格值，当我们将鼠标悬停在该值上时，它就像一个 lick，因为其中正在使用 javascript，但我无法使用 selenium 单击它。

请帮助。在此先感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T06:48:50.837

尝试使用下面的行来单击元素。

```
 driver.findElement(By.xpath("//td[contains(.,'kalis, jack')]")).click(); 
```

# javascript - 使用 javascript 的王牌编辑器触发事件

> ID：16020105
> 
> 赞同：4
> 
> 时间：2013-04-15T16:22:18.723
> 
> 标签：javascript, ace-editor

有没有类似的

```
editor.getSession.trigger('change') 
```

我想要这个的原因是因为编辑器进出新的，所以当它重新出现时，我需要它来做正常的“改变”事情，但我不想等待用户输入？

目前我有

```
editor.getSession().on('change', function(){
    editorChangeHandler()
}) 
```

我只记得

```
 editorChangeHandler() 
```

当我需要时，但`editor.getSession.trigger('change')`要好得多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T05:13:57.057

`editor.session._emit('change')`会触发 editorChangeHandler，但虚假的更改事件会破坏撤消历史记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-15T07:25:32.957

> 我想要这个的原因是因为编辑器进出新的，所以当它重新出现时，我需要它来做正常的“改变”事情，但我不想等待用户输入？

[您可以使用underscore.js](https://underscorejs.org/)尝试替代解决方案。

改变：

```
editor.getSession().on('change', function(){
    editorChangeHandler()
}) 
```

至：

```
editor.getSession().on('change', _.debounce(function() {
    editorChangeHandler()
}, 100)) 
```

当您触发更改时，如下所示：

```
editor.setValue('my change..'); 
```

那么它的行为就像你的愿望：

```
editor.getSession.trigger('change') 
```

# c - 为什么我的教授使用 return(0);？

> ID：16020108
> 
> 赞同：1
> 
> 时间：2013-04-15T16:22:34.220
> 
> 标签：c, coding-style

在我所有的 C 实验室中，我的教授都使用`return(0);`而不是（如果我错了，请纠正我）首选的`return 0;`. C教授不应该知道良好的编程风格吗？

我想知道这是因为我的 C 教科书（C 中的问题解决和程序设计）也使用这种格式。它还在`int`and之间添加了一个换行符`main()`，我觉得这有点奇怪。

难道仅仅是因为旧版本的 C 使用了这种格式，而她（以及这本书）从未适应过吗？或者这只是非常糟糕的编程风格？还是我完全不在这儿？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:24:49.917

这纯粹是一种风格选择和用户偏好。没有真正的理由偏爱一种风格而不是另一种风格。

当然，我更喜欢`return 0;`并且不使用额外的换行符，但是这两种风格都没有技术优势或劣势。我会犹豫将一种风格称为“好”而另一种风格“坏”。

# regex - .htaccess：如果用户访问目录，则将用户重定向到特定页面

> ID：16020109
> 
> 赞同：1
> 
> 时间：2013-04-15T16:22:37.203
> 
> 标签：regex, apache, .htaccess, mod-rewrite, redirect

我目前正在努力解决我网站的一些小问题，并为 SEO 做一些准备。我按照谷歌的 SEO 优化指南找到了这句话：

> 考虑当用户删除您的部分 URL 时会发生什么 - 一些用户可能会以奇怪的方式浏览您的网站，您应该预料到这一点。例如，用户可能会放弃部分 URL，而不是使用页面上的面包屑链接，以希望找到更一般的内容。他或她可能正在访问`http:// www.brandonsbaseballcards.com/news/010/upcoming-baseballcard-shows.htm`，但随后进入`http://www.brandonsbaseballcards.com/news/010/`浏览器的地址栏，认为这将显示来自 010 的所有新闻。您的网站是否准备好在这种情况下显示内容...？

好吧，目前我的网站还没有为这种情况做好准备，并且会将用户引导到目录或 404 页面。

我在网上搜索了一下，发现[这个](https://stackoverflow.com/questions/1656103/htaccess-https-redirection-virtual-folder-access-with-exceptions)和[这个](https://stackoverflow.com/questions/10642602/htacess-redirect-directory-to-a-single-page)链接似乎朝着正确的方向发展，但我不太确定。理想情况下，我想在上传页面之前在 localhost (XAMPP) 上尝试一下。

所以我的问题是，我将如何重定向（通过 htaccess）一个用户，比如说，`http://www.example.com/baseballcards`到`http://www.example/baseballcards/all.html`？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:28:18.223

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteRule ^(baseballcards)/?$ /$1/all.html [L,NC] 
```

`/baseballcards`上述规则将在内部转发`/baseballcards/all.html`但不会更改浏览器中的 URL（外部重定向）。如果您想要外部重定向，请使用以下规则：

```
RewriteRule ^(baseballcards)/?$ /$1/all.html [R=301,L,NC] 
```

# ruby - Ruby / Mongo - 字符串无效 UTF-8 (BSON::InvalidStringEncoding)

> ID：16020112
> 
> 赞同：1
> 
> 时间：2013-04-15T16:22:45.223
> 
> 标签：ruby, mongodb, hash, utf-8

我正在存储大型对象，它是一个巨大的散列，带有嵌套的散列、数组、字符串等。这里有一个非常相似的[问题](https://stackoverflow.com/questions/7392466/recursively-convert-hash-containing-non-utf-chars-to-utf)。这给出了以下猴子补丁：

```
class Hash
  def to_utf8
    Hash[
        self.collect do |k, v|
          if (v.respond_to?(:to_utf8))
            [ k, v.to_utf8 ]
          elsif (v.respond_to?(:encoding))
            [ k, v.dup.encode('UTF-8') ]
          else
            [ k, v ]
          end
        end
    ]
  end
end 
```

这个答案很棒，但似乎没有超过 1 级深度，我不知道如何将它重构为蜘蛛通过。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:40:03.130

如果可能的话，与其解决症状，不如尝试从源头上解决问题。在您的应用程序堆栈中的某个地方，编码是倾斜的。如果你能解决这个问题，它可能是最稳定、最有效的解决方法。

否则，您将不得不遍历整个 MongoDB 文档并使用此处完成的操作来处理值（不要忘记键，它们也作为字符串存储在 MongoDB 中）：

```
if text.respond_to?(:to_utf8)
  text.to_utf8
elsif text.respond_to?(:encoding)
  text.encode('utf-8')
else
  text
end 
```

我无法帮助您了解如何遍历您的文档，因为我需要有关您的模型结构及其持久性的更多信息。

**编辑：**

我喜欢这个解决方案，而不是遍历模型树：[https](https://stackoverflow.com/a/15789340/436112) ://stackoverflow.com/a/15789340/436112 。将其视为 JSON 并对整个文档进行编码/解码，修复过程中的 UTF-8 编码问题

# matlab - 从包含错误值的矩阵创建错误图像 (MATLAB)

> ID：16020114
> 
> 赞同：1
> 
> 时间：2013-04-15T16:22:52.293
> 
> 标签：matlab, graphics, plot

这是我的问题。我正在使用matlab。我有一个 1024x768 矩阵（显然它映射了一个图像），我在每个位置存储了为特定像素计算的误差（解释起来很复杂......基本上我对每个像素进行一些计算并将这些计算的结果存储在矩阵内的对应位置）...

我需要创建一个错误很高的红色图形和错误很低的蓝色图形，可能会创建 1024x768 图像。是否可以？如果是这样，我该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:28:31.620

使用 IMAGESC 怎么样？

```
imagesc(yourmatrix) 
```

默认`jet`颜色图将为您提供所需的颜色。或者您可以将颜色图更改为其他内容。

```
colormap(redbluecmap) 
```

# c# - 实体框架使用旧数据和新数据检查唯一约束？

> ID：16020115
> 
> 赞同：0
> 
> 时间：2013-04-15T16:22:53.567
> 
> 标签：c#, entity-framework-4, constraints

我正在使用实体框架 4.0，我有一张桌子。在此表中，我在其中一个字段中有一个唯一约束。

添加新寄存器时，我执行以下操作：

1.-在现有记录中，我重新计算了唯一字段的值。该值取决于我要添加的新寄存器并更改所有寄存器中的值。

2.- 我计算新记录的唯一字段。

3.- 我添加具有唯一值的新寄存器。

在我进行保存更改的那一刻，我检查了寄存器的值，我可以看到在唯一字段中没有重复值。

但是，当我保存更改时，我得到一个唯一值的异常。这是因为我更改了现有寄存器之一的值，更改它并将该值分配给新记录。

我认为实体框架首先添加新记录以及其他记录如何仍然具有旧值，我得到了异常。EF不会先更新现有记录，然后添加新记录以确保比较正确的信息吗？

真的我猜是EF的正常行为吗？如果这是真的，我该如何解决这个问题？

谢谢。

# python - mechanize._mechanize.FormNotFoundError：没有匹配名称“q”的表单

> ID：16020117
> 
> 赞同：1
> 
> 时间：2013-04-15T16:23:01.620
> 
> 标签：python, forms, web-crawler, mechanize

任何人都可以帮我正确选择此表单吗？

试图抓取谷歌，我收到错误：mechanize._mechanize.FormNotFoundError: no form matching name 'q'

不寻常，因为我看过其他几个使用它的教程，并且： ps 我不打算通过请求来 SLAM google，只是希望使用自动选择器来不时查找学术引文 pdf。

```
<f GET http://www.google.com.tw/search application/x-www-form-urlencoded
  <HiddenControl(ie=Big5) (readonly)>
  <HiddenControl(hl=zh-TW) (readonly)>
  <HiddenControl(source=hp) (readonly)>
  <TextControl(q=)>
  <SubmitControl(btnG=Google ?j?M) (readonly)>
  <SubmitControl(btnI=?n???) (readonly)>
  <HiddenControl(gbv=1) (readonly)>>
>>> quit()

import os, subprocess
import re
import mechanize
from bs4 import BeautifulSoup
#prepare mechanize
br = mechanize.Browser()
br.set_handle_robots(False)
br.set_handle_equiv(False)
br.addheaders = [('User-agent', 'Mozilla/5.0')] 
br.open('http://www.google.com/')
br.select_form('q')
citation = ' www.stackoverflow.com '.strip() 
#citation = GOOGLE_BASE + Citation
print citation
br.open('http://www.google.com/')
br.select_form('q')
br.form['q'] = citation
br.submit()
data = br.read()
soup = BeautifulSoup(data)
print soup 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-15T17:08:40.027

您正在尝试选择一个名为 的表单`q`，该表单不存在。似乎该表单被命名`f`了。（但是，我无法在我的浏览器中验证这一点——即使禁用了 Javascript，我也只看到了一个不同的名称。）

一个简单的谷歌搜索可以这样完成：

```
import os, subprocess
import re
import mechanize
from bs4 import BeautifulSoup

#prepare mechanize
br = mechanize.Browser()
br.set_handle_robots(False)
br.set_handle_equiv(False)
br.addheaders = [('User-agent', 'Mozilla/5.0')] 
br.open('http://www.google.com/')

# do the query
br.select_form(name='f')   # Note: select the form named 'f' here
br.form['q'] = 'here goes your query' # query
data = br.submit()

# parse and output
soup = BeautifulSoup(data.read())
print soup 
```

这应该给你的想法。

**更新：如何找到正确的表单“选择器”**

要打印可用表单的名称，您可以执行以下操作：

```
for form in br.forms():
    print form.name 
```

当您使用交互式控制台时，这会派上用场。

您不必使用表格的名称，但您可以提供其他提示以选择正确的表格。例如，在某些页面上，表单根本没有名称。然后您仍然可以根据表格的编号进行选择，例如`br.select_form(nr=1)`页面上的第二个表格。详情请参阅`help(br.select_form)`。此外，`list(br.forms())`还会为您提供可以进一步检查的所有表格的列表。

另一种选择是在您常用的浏览器中手动检查页面。

# ubuntu - 如何将顶部的 ubuntustudio (xfce) 面板向下放置？

> ID：16020123
> 
> 赞同：1
> 
> 时间：2013-04-15T16:23:17.003
> 
> 标签：ubuntu, xfce

我安装了 ubuntustudio-desktop 并且对它非常满意。由于我的电脑屏幕是 12 英寸，所以我想将顶部面板放在底部，并删除底部底座——这样可以节省一些桌面空间。

我怎么能把顶部面板放在底部？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T02:03:42.950

在要移动的面板上用鼠标右键单击 - 面板 - 面板首选项... 取消勾选：锁定面板

现在可以看到，在面板的左右两侧，都出现了一个小的“把手”。因此，最左边和最右边的图标向中间移动了一点。您必须仔细观察，因为手柄几乎看不见。

将鼠标指针放在手柄上，按下鼠标左键并保持按下状态。指针现在变成了一只小手。现在您可以将面板拖动到您想要的位置。

是否要将其从面板底部移动到右侧？然后你必须将模式从水平更改为垂直。

现在把它拖到右边。

完成后，将勾选项放回：锁定面板。

单击关闭。

# java - JSR 310：时区之间的转换

> ID：16020127
> 
> 赞同：1
> 
> 时间：2013-04-15T16:23:24.553
> 
> 标签：java, timezone, java-8, jsr310

尝试使用 JSR 310 在时区之间转换毫秒日期时间值。需要处理毫秒值，才能使用旧版 API。就我而言，它介于本地和 UTC/GMT 之间，但我希望它是完全相同的代码，而与所涉及的源时区和目标时区无关。这是我的小测试程序。它被配置为在最后一次本地 DST 更改前后的几个小时内进行迭代。输出是错误的，所以我认为 UTCtoLocalMillis 是错误的，但我的测试方法也可能存在问题。我所说的错误输出的意思是，对于我的时区，应该减去小时以获得 UTC，但代码实际上增加了小时。其次，夏令时的时间点也相差一小时。

我首先获取本地时区，然后将其重置为 UTC，这样 Date().toString() 在创建输出时不会执行任何转换。

我想要的是创建一个以毫秒为单位的方法，一个源 ZoneID 和一个目标 ZoneID，并使用新的 JSR 310 API 返回转换后的毫秒数。

```
public class Test {
static int DAYS_OFFSET_TO_BE_BEFORE_DST_CHANGE = -16;

static TimeZone UTC_TZ = TimeZone.getTimeZone("UTC");

static TimeZone LOCAL_TZ = TimeZone.getDefault();

static ZoneId UTC_ID = ZoneId.of(UTC_TZ.getID());

static ZoneId LOCAL_ZONE_ID = ZoneId.of(LOCAL_TZ.getID());

static long UTCtoLocalMillis(final long utcMillis) {
    final Instant instant = Instant.ofEpochMilli(utcMillis);
    final ZonedDateTime before
        = ZonedDateTime.ofInstant(instant, UTC_ID);
    final ZonedDateTime after
        = before.withZoneSameLocal(LOCAL_ZONE_ID);
    return after.toInstant().toEpochMilli();
}

public static void main(final String[] args) {
    TimeZone.setDefault(UTC_TZ);
    System.out.println("LOCAL_TZ: " + LOCAL_TZ.getDisplayName());
    final Calendar cal = Calendar.getInstance(LOCAL_TZ);
    cal.add(Calendar.DATE, DAYS_OFFSET_TO_BE_BEFORE_DST_CHANGE);
    final Date start = cal.getTime();
    // DST Change: Sunday, 31 March 2013 01:59:59 (local time)
    final long oneHour = 3600000L;
    for (int i = 0; i < 12; i++) {
        final Date date = new Date(start.getTime() + i * oneHour);
        System.out.println("UTC: " + date + "   toLocal: "
                + new Date(UTCtoLocalMillis(date.getTime())));
    }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T09:48:48.513

> 我想要的是创建一个以毫秒为单位的方法，一个源 ZoneID 和一个目标 ZoneID，并使用新的 JSR 310 API 返回转换后的毫秒数。

您的要求似乎很混乱。时间 APIs 中一般提到的“毫秒”值是 epoch-millis，即从 1970-01-01T00:00Z 开始的毫秒数。毫秒值始终与 UTC 相关。虽然有“本地毫秒”的概念，但它从未真正使用过。特别是，java.util.Date 构造函数采用 epoch-millis。

因此，代码`new Date(UTCtoLocalMillis(date.getTime()))`基本上没有意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-09-30T22:41:00.237

# seo - 如何在面包屑中插入主页和当前页面？

> ID：16020128
> 
> 赞同：2
> 
> 时间：2013-04-15T16:23:25.477
> 
> 标签：seo, breadcrumbs

我正在为客户的网站制作面包屑，我在问自己主页是否必须在其代码中。

那么，这样做更好吗：

**通过链接到主页和当前**

```
<div itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
    <a href="http://someclient.fr/" itemprop="url">
        <span itemprop="title">Accueil</span>
    </a>
    >
</div> 
<div itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
    <a href="http://someclient.fr/annonces" itemprop="url">
        <span itemprop="title">Annonces</span>
    </a>
    > 
</div> 
<div itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
    <a href="http://someclient.fr/annonces/category" itemprop="url">
        <span itemprop="title">Categorie</span>
    </a>
</div>
<div itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
    <a href="http://someclient.fr/annonces/category/produit" itemprop="url">
        <span itemprop="title">Produit</span>
    </a>
</div> 
```

**没有指向主页和当前页面的链接**

```
<a href="http://someclient.fr/" itemprop="url">Accueil</a> >
<div itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
    <a href="http://someclient.fr/annonces" itemprop="url">
        <span itemprop="title">Annonces</span>
    </a>
    > 
</div> 
<div itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
    <a href="http://someclient.fr/annonces/category" itemprop="url">
        <span itemprop="title">Category</span>
    </a>
</div>
<a href="http://someclient.fr/annonces/category/produit" itemprop="url">Produit</a> 
```

[您可以使用 Google 结构化数据测试工具 ( http://www.google.com/webmasters/tools/richsnippets](http://www.google.com/webmasters/tools/richsnippets) )尝试此代码，您会看到我的第一个示例未呈现主页。

那么，最好的解决方案是什么？您如何为您的网站做些什么？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-04T13:10:35.230

对于 seo，最好没有那个链接，因为您将有两个链接用于主页，另一个链接用于您所在的同一页面...

# javascript - 比较 JavaScript 中的两个对象属性（codecademy 课程部分）

> ID：16020129
> 
> 赞同：-1
> 
> 时间：2013-04-15T16:23:28.253
> 
> 标签：javascript, html

我目前在 CodeAcademy 的 javascript 教程上，当我遇到这节课时，我必须创建一个函数来比较 2 人的年龄并输出老年人的年龄。如果两人年龄相同，它会然后输出年龄。

下面列出的是我想出的代码。但是，我在 CodeAcademy 的编辑器中不断收到错误消息，告诉我老年人未定义。有人可以引导我朝着正确的方向前进和/或指出我的错误吗？谢谢！

```
function Person(name, age) {
    this.name = name;
    this.age = age;
}

var olderAge = function(person1, person2) {
    if (person1.age > person2.age) {
        console.log(person1.age);
    } else if (person1.age < person2.age) {
        console.log(person2.age);
    } else {
        console.log(person1.age);
    }
};

var alice = new Person("Alice", 30);
var billy = new Person("Billy", 25);

console.log(" The older person is " + olderAge(alice, billy)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:26:21.173

`olderAge`不返回任何东西

我认为您可能希望从该功能中返回老年人。

所以，而不是（或除了）

```
console.log(person1.age); 
```

你要

```
return person1.name; 
```

* * *

或者，您可以将呼叫更改为

```
console.log(" The older person is "+ olderAge(alice, billy).name); 
```

然后你可以做

```
return person1; 
```

# iphone - 指定segue推送哪个viewController？

> ID：16020133
> 
> 赞同：0
> 
> 时间：2013-04-15T16:23:38.543
> 
> 标签：iphone, cocoa-touch, segue

当我们选择一个 segue 时，是否有任何方式以编程方式控制将哪个 viewController 推入视图？我想要做的是在`UITableViewCell`点击 a 时选择两个控制器之一，一个用于 iPhone4（960 高度），另一个用于 iPhone5（1136 高度）。

我可以手动布局/安排一个视图控制器来适应额外的高度。或者我可以添加第二个segue（使用另一个ID），然后`-tableView:didSelectRowAtIndexPath:`结合使用`-performSegueWithIdentifier:sender:`根据屏幕高度推送正确的viewController。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T18:44:53.707

最初的问题与设置为通过在 Interface Builder 中的 a`UITableViewCell`和 a之间拖动来自动触发的 segue 相关。`UIViewController`使用此方法，您只能`UIViewController`通过 segues 一对一关系访问一个。

`UIViewController`您可以通过直接从包含`UITableView`（而不是从单元格本身）连接segue，然后使用`tableView:didSelectRowAtIndexPath:`来获取选定的单元格并执行所需的segue，来解决这个问题（并按照我最初的要求进行操作） 。使用此方法，您可以根据需要设置尽可能多的 segue，通过为每个 segue 提供一个唯一标识符，您可以通过编程控制哪个（以及何时）被调用`using -performSegueWithIdentifier:sender:`

# wpf - TaskDialog 引发异常：需要版本 6 中的 comctl32.dll

> ID：16020136
> 
> 赞同：6
> 
> 时间：2013-04-15T16:23:57.180
> 
> 标签：wpf, windows-api-code-pack, taskdialog

我正在开发一个现代 WPF 应用程序。我想使用TaskDialog，但我总是遇到常见错误：

> TaskDialog 功能需要加载 comctl32.dll 的版本 6，但当前在内存中加载了不同的版本。

我尝试添加一个清单（它已经包含正确的 comctl32.dll 所需的依赖项）并将其设置为项目属性中的默认清单。

它仍然抛出这个异常：-/

我的应用程序是这样构建的：它是一个启动应用程序（普通的 Windows 应用程序，非 wpf）。它只有作为入口点的“Program.cs”。它在那里动态加载真正的应用程序（这是一个库，而不是 WPF 应用程序项目）。它调用启动应用程序的启动方法。

效果很好，但我总是得到这个例外。我想这是因为这个启动系统......但是解决它的可能解决方法是什么？

非常感谢 ：）

R

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-19T13:09:42.260

运行程序的 *.exe 版本，而不是 Visual Studio *.vshost.exe 的版本

要在 Visual Studio 中执行此操作，请禁用“调试/启用调试器/启用 Visual Studio 托管进程”中的标志

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-11T05:45:53.967

也许我的解决方案会对你有所帮助。

我的 C#“应用程序”是用作 WIX 的 CustomAction 的类库/dll。我想要一个 TaskDialog 而不是 MessageBox，但我遇到了和你一样的异常，据我所知，清单文件不适用于 C# 类库。我不得不使用多种方法来让我的代码加载正确版本的 comctl32.dll。

我刚刚开始工作，所以我的代码有点凌乱和肥胖。

**资料来源：**

1.  [http://truecheaters.com/f51/%5Bc-%5D-taskdialog-9368.html](http://truecheaters.com/f51/%5Bc-%5D-taskdialog-9368.html)
2.  [http://support.microsoft.com/kb/830033](http://support.microsoft.com/kb/830033)

**1) 包括上面第二个链接中的 EnableThemingInScope 类。**

**2）包括这个修改后的TaskDialog枚举/类：**

```
[Flags]
public enum TaskDialogButtons {
    OK = 0x0001,
    Cancel = 0x0008,
    Yes = 0x0002,
    No = 0x0004,
    Retry = 0x0010,
    Close = 0x0020
}

public enum TaskDialogIcon {
    Information = UInt16.MaxValue - 2,
    Warning = UInt16.MaxValue,
    Stop = UInt16.MaxValue - 1,
    Question = 0,
    SecurityWarning = UInt16.MaxValue - 5,
    SecurityError = UInt16.MaxValue - 6,
    SecuritySuccess = UInt16.MaxValue - 7,
    SecurityShield = UInt16.MaxValue - 3,
    SecurityShieldBlue = UInt16.MaxValue - 4,
    SecurityShieldGray = UInt16.MaxValue - 8
}

public enum TaskDialogResult {
    None,
    OK,
    Cancel,
    Yes,
    No,
    Retry,
    Close
}

public class StatusDialog {
    #region API
    [DllImport( "comctl32.dll", CharSet = CharSet.Unicode )]
    public static extern int TaskDialog( IntPtr hWndParent, IntPtr hInstance, string pszWindowTitle, string pszMainInstruction, string pszContent, int dwCommonButtons, IntPtr pszIzon, out int pnButton );
    #endregion

    #region Modal
    public static TaskDialogResult Show( IWin32Window owner, string text ) {
        return Show( owner, text, null, null, TaskDialogButtons.OK );
    }

    public static TaskDialogResult Show( IWin32Window owner, string text, string instruction ) {
        return Show( owner, text, instruction, null, TaskDialogButtons.OK, 0 );
    }

    public static TaskDialogResult Show( IWin32Window owner, string text, string instruction, string caption ) {
        return Show( owner, text, instruction, caption, TaskDialogButtons.OK, 0 );
    }

    public static TaskDialogResult Show( IWin32Window owner, string text, string instruction, string caption, TaskDialogButtons buttons ) {
        return Show( owner, text, instruction, caption, buttons, 0 );
    }

    public static TaskDialogResult Show( IWin32Window owner, string text, string instruction, string caption, TaskDialogButtons buttons, TaskDialogIcon icon ) {
        return ShowInternal( owner.Handle, text, instruction, caption, buttons, icon );
    }
    #endregion

    #region Non-Modal
    public static TaskDialogResult Show( string text ) {
        return Show( text, null, null, TaskDialogButtons.OK );
    }

    public static TaskDialogResult Show( string text, string instruction ) {
        return Show( text, instruction, null, TaskDialogButtons.OK, 0 );
    }

    public static TaskDialogResult Show( string text, string instruction, string caption ) {
        return Show( text, instruction, caption, TaskDialogButtons.OK, 0 );
    }

    public static TaskDialogResult Show( string text, string instruction, string caption, TaskDialogButtons buttons ) {
        return Show( text, instruction, caption, buttons, 0 );
    }

    public static TaskDialogResult Show( string text, string instruction, string caption, TaskDialogButtons buttons, TaskDialogIcon icon ) {
        return ShowInternal( IntPtr.Zero, text, instruction, caption, buttons, icon );
    }
    #endregion

    #region Core Implementation
    private static TaskDialogResult ShowInternal( IntPtr owner, string text, string instruction, string caption, TaskDialogButtons buttons, TaskDialogIcon icon ) {
        int p;
        using ( new EnableThemingInScope( true ) ) {
            int resss = TaskDialog( owner, IntPtr.Zero, caption, instruction, text, (int) buttons, new IntPtr( (int) icon ), out p );
            if ( resss != 0 )
                throw new InvalidOperationException( "Something weird has happened." + resss.ToString() );
        }

        switch ( p ) {
            case 1:
                return TaskDialogResult.OK;
            case 2:
                return TaskDialogResult.Cancel;
            case 4:
                return TaskDialogResult.Retry;
            case 6:
                return TaskDialogResult.Yes;
            case 7:
                return TaskDialogResult.No;
            case 8:
                return TaskDialogResult.Close;
            default:
                return TaskDialogResult.None;
        }
    }
    #endregion
} 
```

**3\. 调用它，简单地说：**

```
try {
    StatusDialog.Show( "About to test this...", "Heading I won't use.", "Dialog Title", TaskDialogButtons.OK );
} catch ( Exception e ) {
    MessageBox.Show( e.ToString(), "Error Found", MessageBoxButtons.OK );
} 
```

**4\. 结果：**

![在此处输入图像描述](https://i.stack.imgur.com/sFlJY.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-18T22:31:28.770

我发现如果您以“RequireAdministrator”权限运行，它会抛出异常，但如果权限“AsInvoker”则不会抛出异常。只是我的观察。如果您的应用程序需要管理员权限，那么我很难过

# python - 使用numpy导入数据时如何保留列名？

> ID：16020137
> 
> 赞同：6
> 
> 时间：2013-04-15T16:23:57.567
> 
> 标签：python, numpy

我正在使用 Python 中的 numpy 库将`CSV`文件数据导入`ndarray`如下：

```
data = np.genfromtxt('mydata.csv', 
                     delimiter='\,', dtype=None, names=True) 
```

结果提供以下列名称：

```
print(data.dtype.names)

('row_label',
 'MyDataColumn1_0',
 'MyDataColumn1_1') 
```

原始列名是：

```
row_label, My-Data-Column-1.0, My-Data-Column-1.1 
```

这似乎`NumPy`迫使我的列名采用 C 风格的变量名格式。然而，在很多情况下，我的 Python 脚本需要根据列名访问列，因此我需要确保列名保持不变。为此，要么`NumPy`需要保留原始列名，要么需要将列名转换为`NumPy`正在使用的格式。

*   有没有办法在导入期间保留原始列名？

*   如果没有，是否有一种简单的方法可以将列标签转换为使用的格式`NumPy`，最好使用一些`NumPy`函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T17:20:22.083

如果您设置`names=True`，则数据文件的第一行将通过此函数传递：

```
validate_names = NameValidator(excludelist=excludelist,
                               deletechars=deletechars,
                               case_sensitive=case_sensitive,
                               replace_space=replace_space) 
```

这些是您可以提供的选项：

```
excludelist : sequence, optional
    A list of names to exclude. This list is appended to the default list
    ['return','file','print']. Excluded names are appended an underscore:
    for example, `file` would become `file_`.
deletechars : str, optional
    A string combining invalid characters that must be deleted from the
    names.
defaultfmt : str, optional
    A format used to define default field names, such as "f%i" or "f_%02i".
autostrip : bool, optional
    Whether to automatically strip white spaces from the variables.
replace_space : char, optional
    Character(s) used in replacement of white spaces in the variables
    names. By default, use a '_'. 
```

也许您可以尝试提供自己`deletechars`的空字符串。但是你最好修改并传递这个：

```
defaultdeletechars = set("""~!@#$%^&*()-=+~\|]}[{';: /?.>,<""") 
```

只需从该集合中取出句号和减号，并将其传递为：

```
np.genfromtxt(..., names=True, deletechars="""~!@#$%^&*()=+~\|]}[{';: /?>,<""") 
```

这是来源： [https ://github.com/numpy/numpy/blob/master/numpy/lib/_iotools.py#l245](https://github.com/numpy/numpy/blob/master/numpy/lib/_iotools.py#l245)

# spring - 防止某些类的 AOP 代理

> ID：16020144
> 
> 赞同：2
> 
> 时间：2013-04-15T16:24:18.320
> 
> 标签：spring, proxy, spring-security, aop

可以阻止某些类的 AOP 代理吗？

例如`global-method-security`从 Spring Security 使用时。在这种情况下，我希望代理大多数带有注释的 bean。但是对于某些 bean，我已经在使用具有某些特殊语义的自定义代理。

任何想法表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T09:00:32.703

我认为没有一个简单的方法可以做到这一点。

我看到两个选项：

*   扩展`SecuredAnnotationSecurityMetadataSource`和覆盖`findAttributes()`方法。然后使用该属性禁用`secured-annotation`和启用您自己的。（更简单，但仅适用于弹簧安全）`SecuredAnnotationSecurityMetadataSource``metadata-source-ref`

*   其他（更通用的）方法是使用Spring Security 注册的 bean 定义上的`shouldSkip()`方法覆盖`AbstractAutoProxyCreator`并设置您自己`AutoproxyCreator`的方法，即. 对于这种方法，您需要注意您最终使用的是什么实现 ( ,或)`BeanFactoryPostProcessor``setBeanClassName()``AopConfigUtils.AUTO_PROXY_CREATOR_BEAN_NAME``AutoProxyCreator``InfrastructureAdvisorAutoProxyCreator``AspectJAwareAdvisorAutoProxyCreator``AnnotationAwareAspectJAutoProxyCreator`

# mysql - 如何仅将最新的 SQL 条目从一个数据库传输到另一个数据库？

> ID：16020149
> 
> 赞同：0
> 
> 时间：2013-04-15T16:24:29.027
> 
> 标签：mysql, sql, database, web

我正在运行一个开发服务器，我试图与实时网站保持同步。

我可以导出和导入最新的更改，而不是删除开发或实时 MYSQL 数据库并导入整个更新的数据库吗？

保持数据库同步以进行开发的理想工作流程是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:26:52.680

你在寻找

[http://dev.mysql.com/doc/refman/5.0/en/binary-log.html](http://dev.mysql.com/doc/refman/5.0/en/binary-log.html)

这包含所有更改，您可以在其他服务器上重播它们。除此之外还需要复制

[http://dev.mysql.com/doc/refman/5.0/en/replication-howto.html](http://dev.mysql.com/doc/refman/5.0/en/replication-howto.html)

# single-page-application - 路由器在 DurandalJS 中找不到页面

> ID：16020150
> 
> 赞同：0
> 
> 时间：2013-04-15T16:24:35.177
> 
> 标签：single-page-application, durandal

这是我的路由器配置：

```
 router.useConvention();

        router.mapRoute('error', 'viewmodels/error', "Error");

        router.mapNav('home');
        router.mapRoute('api', 'viewmodels/api', 'API Reference');
        router.mapRoute('set/:id', 'viewmodels/set', 'Set');
        router.mapRoute('folder/:id', 'viewmodels/folder', 'Folder');

        router.handleInvalidRoute = function (route, params) {
            //debugger;
            router.navigateTo('#/error');
        };

        logger.log('app has loaded :)', null, null, false);

        return router.activate('home'); 
```

我可以找到 /api 和其他页面，但是当我输入无效路由时，chrome 控制台会显示以下内容：

![在此处输入图像描述](https://i.stack.imgur.com/pBXmx.png)

就像其他页面一样，我有 error.js 和 error.html。它在 App/viewmodels/error.js 中，但我不必指定包含任何其他视图/vms 的文件夹...为什么找不到它？

编辑根据约瑟夫的建议，我激活了“错误”，我得到了这个：

![在此处输入图像描述](https://i.stack.imgur.com/a2G8r.png)

我很困惑......为什么它已经在正确的位置找到了error.js，为什么它认为它会在那个位置找到一个html文档？

我有一个传统的文件结构：

![在此处输入图像描述](https://i.stack.imgur.com/4QY3k.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T01:22:20.423

原来你的问题出在**error.js**本身。在 Google Groups 上请求您的文件后，我能够复制问题。

改变这个：

```
define(['services/dataservice'], function (dataservice) {
    var data = "error";
    return data;
}) 
```

对此：

```
define(['services/dataservice'], function (dataservice) {
    var data = "error";
    return {}
}) 
```

您正在返回一个字符串，在这种情况下，Durandal 假定您正在给定“/App/error.js”的路径中寻找视图模型。您应该返回某种对象，用于绑定您的可观察对象等。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-07-03T11:12:18.630

添加此代码： router.mapRoute('pagenotfound', 'viewmodels/pagenotfound', 'page not found', false);

# javascript - HTML5 Javascript 移动应用程序不适合较小分辨率的平板电脑

> ID：16020151
> 
> 赞同：0
> 
> 时间：2013-04-15T16:24:35.680
> 
> 标签：javascript, css, html, mobile

我正在使用 Kendo UI Mobile 框架，并且我将 min-width 属性设置为 768px。当我在分辨率较小的平板电脑上拉起页面时，会导致水平滚动。如果分辨率小于设置的宽度，我只想让页面自动缩小。过去我曾使用此元标记来解决此问题： `<meta name="viewport" content="width=device-width, height=device-height, user-scalable=no" />`

但这不起作用。

关于如何让页面自动缩放以适应设备宽度的任何帮助都会很棒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T18:40:23.707

您也可以尝试摆脱“最小宽度”CSS 属性，而只使用“宽度：100%”，这将使其适合任何浏览器大小。也有一些关于使用 ems 而不是 px 作为宽度的猜测，因为有很多不同的移动设备和浏览器，基本上不可能为每一种意外情况做好计划。不幸的是，我找不到有关使用 em 的文章的链接，但基本上，如果您去掉一些硬性下限，您可能会发现支持更多种类的设备会更容易。

还结帐[bootstrap](http://twitter.github.io/bootstrap/)。这是一个很好的响应式设计包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:41:00.773

试试这个。

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,    minimum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-touch-fullscreen" content="yes"> 
```

# security - 带有 java 沙盒的 Jython：授予更具体的权限？

> ID：16020156
> 
> 赞同：3
> 
> 时间：2013-04-15T16:24:53.717
> 
> 标签：security, jython, sandbox, policy

我使用 Jython 和 java 安全策略编写了一个用于运行受限制的 python 脚本的 python-沙箱。为了授予权限，我定义了一个这样的策略文件：

```
grant {

    permission java.io.FilePermission "Lib\\-", "read";
    permission java.lang.RuntimePermission "createClassLoader";
    permission java.lang.RuntimePermission "getProtectionDomain";

}; 
```

例如，在任何 python 脚本中导入 os.py 模块都需要从 jython.jar 的“Lib”文件夹读取的 FilePermission。

因此 jython 有权使用 eg`os.mkdir("Dir")`或`os.getpid()`，因为“os.py”模块位于 jython.jar Lib 文件夹中。

如何授予更具体的权限，例如 python 脚本有权运行`os.getpid()`但没有`os.mkdir("Dir")`？

# python - Gimp python 插件

> ID：16020158
> 
> 赞同：2
> 
> 时间：2013-04-15T16:24:57.800
> 
> 标签：python, plugins, gimp, gimpfu

今天我写了一个简短的 python 脚本，它应该重命名 gimp 图像的层列表以添加一些标志，当层是动画的一部分时使用这些标志。该脚本已集成到 Gimp 菜单中，并且 Python-Fu 控制台中提供的信息是正确的。但是，如果我在 Python-Fu 控制台或操作菜单中执行脚本，则什么也不会发生。我无法找到问题。手动将功能内容发布到控制台是可行的。

有人知道这个问题的解决方案还是在 Gimp 2.8 中遇到过同样的问题？

```
#!/usr/bin/env python
from gimpfu import *
import os

def renameAllLayers(img):
    print 'Starting ...\n'

    for layer in img.layers:
        print layer.name + '\n'
        if layer.name[-16:] is '(66ms) (replace)':
            pass
        elif layer.name[-17:] is '(200ms) (replace)':
            pass
        elif layer.name[-10:] is ' (replace)':
            layer.name = layer.name[:-10] + '(66ms) (replace)'

        print layer.name + '\n'

    print 'Finished ...\n'

register(
    proc_name=("rename_all_layers"),
    label=("Rename all layers"),
    blurb=("Rename all layers so they include all missing flags"),
    help=("Help?"),
    author=("Andreas Schickedanz"),
    date=("2013"),
    menu=("<Image>/Scripts/Layer Renamer"), 
    imagetypes=("*"),
    params=[
        (PF_IMAGE, "img", "Select an image", None),
    ],
    results=[],
    function=(renameAllLayers)
)

main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:34:01.070

在您的脚本中，您使用 比较字符串`is`，它检查对象身份，因此在这种情况下它将始终返回，因此`False`您的图层不会被重命名。

`==`改为用于比较字符串。除此之外，您的脚本运行良好。

# hibernate - 当我尝试删除时出现休眠错误

> ID：16020160
> 
> 赞同：0
> 
> 时间：2013-04-15T16:25:12.380
> 
> 标签：hibernate

我有一个数据表，其中包含我的所有对象、制造商“Fabricant”列表和两个按钮：更新和删除。

```
public class FabricantService {

private FabricantHome dao ;
Session sesion ;
List<Fabricant> list;

    public FabricantService() {
        super();
        dao = new FabricantHome();
    }

    public void ajouter(Fabricant cart) {

        sesion=HibernateUtil.getSessionFactory().getCurrentSession();
        sesion.beginTransaction();
        dao.persist(cart);
        sesion.getTransaction().commit();
              } 

    public void update(Fabricant cart) {
            sesion=HibernateUtil.getSessionFactory().getCurrentSession();
            sesion.beginTransaction();
            dao.merge(cart);
            sesion.getTransaction().commit();
    } 

   public void deletee (Fabricant cart) {
         sesion=HibernateUtil.getSessionFactory().getCurrentSession();
         sesion.beginTransaction();
         dao.delete(cart);
         sesion.getTransaction().commit();                      
}

public List<Fabricant> list(){
    sesion=HibernateUtil.getSessionFactory().getCurrentSession();
    sesion.beginTransaction();
    list=dao.findAll() ;
    return list;

    }

} 
```

更新好的，它可以在页面上重定向我以更新一个制造商。

但是当我选择删除这个时，会显示这个错误：

```
Caused by: javax.faces.el.EvaluationException: 
   org.hibernate.HibernateException: 
      Illegal attempt to associate a collection with two open sessions  
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:102)     
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
    ... 23 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:29:10.563

提交后关闭会话。

# postgresql - PSQLException：错误：tsquery 中的语法错误

> ID：16020164
> 
> 赞同：19
> 
> 时间：2013-04-15T16:25:28.387
> 
> 标签：postgresql, search, full-text-search, escaping

必须避免哪些字符以确保不会出现*PSQLException: ERROR: syntax error in tsquery ？*该文档没有说明如何转义搜索字符串：[http ://www.postgresql.org/docs/8.3/static/datatype-textsearch.html](http://www.postgresql.org/docs/8.3/static/datatype-textsearch.html)

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-04-15T16:49:05.457

# android - 提供替代资源

> ID：16020166
> 
> 赞同：2
> 
> 时间：2013-04-15T16:25:37.160
> 
> 标签：android

`values`我有我的默认文件夹`dimens.xml`。现在碰巧我需要为`mdpi`设备使用一些其他值。为了实现这一点，我必须指定替代资源，即`values-mdpi\dimens.xml`. 但是一旦我这样做，我必须定义`values-xhdpi`,`values-hdpi`等，以显示不同密度屏幕的正确尺寸。所以基本上为了定义`mdpi`设备的唯一值，我需要创建**几个**不同的文件。有没有简单的方法来定义价值，`mdpi`仅此而已？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:54:52.767

Yes, there is a solution.

If you use maven to build your application, you can make a folder with name eg. `yourproject-res` in the same place where `res` folder is. Then you can put anything you want to this folder (like `drawable` folder, `layout` folder, `drawable-mdpi` folder, `values` folder etc.). After that you need to modify your pom.xml to create second profile of your application, like:

```
 <profile>
        <id>yourprojectmdpi</id>            
        <properties>
            <package.name>.com.your.app</package.name>
            <res.directory>yourproject-res</res.directory>      
        </properties>
    </profile> 
```

And then the last step is to clean install your application with maven using `-P` parameter to point on your defined profile.

`mvn clean install -Pyourprojectmdpi`

and then

`mvn android:deploy android:run` to send apk from `target` folder to your device and run.

[Here](http://maven.apache.org/guides/introduction/introduction-to-profiles.html), [here](http://blog.akquinet.de/2011/01/14/starting-android-application-development-with-apache-maven/) and [here](http://www.manydesigns.com/en/portofino/portofino3/tutorials/using-maven-profiles-and-resource-filtering) you have a reference to maven profiles.

I hope I correctly understood your problem.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:31:26.347

我对 android 比较陌生，但我很确定如果您不为任何其他大小指定资源，则将使用默认值目录中的值。

请参阅支持多个屏幕以及如何确定正确资源的 android 文档页面。

[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html) [http://developer.android.com/guide/topics/resources/providing-resources.html#BestMatch](http://developer.android.com/guide/topics/resources/providing-resources.html#BestMatch)

# windows - 如何在 Windows 中配置 Sublime Text 2 ANT 构建脚本？

> ID：16020172
> 
> 赞同：0
> 
> 时间：2013-04-15T16:25:50.770
> 
> 标签：windows, ant, sublimetext2

我通常在工作时在 Mac 上使用 Sublime Text，这很好。但我试图在家里用我的 Windows PC 设置 Sublime Text，并在尝试运行我的构建脚本时不断出错。

这是我的项目文件：

```
{
    "folders":
    [
        {
            "path": "my-folder"
        }
    ],
    "build_systems":
    [
        {
            "name": "Ant",
            "cmd": ["ant"],
            "working_dir": "${project_path}"
        }
    ]
} 
```

这是我得到的错误：

```
[Error 2] The system cannot find the file specified
[cmd:  [u'ant']]
[dir:  D:\Users\****\Projects]
[path: C:\Program Files (x86)\NVIDIA Corporation\PhysX\Common;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\]
[Finished] 
```

好像找不到ANT？但这不是与 Sublime Text 捆绑在一起的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:30:50.500

在命令行中输入“ant”。如果它抛出一个错误，那么 ant 不在你的 PATH 中。您需要安装它（[http://ant.apache.org/manual/install.html](http://ant.apache.org/manual/install.html)），然后将其添加到您的 PATH 环境变量中。

我用的是Sublime，不知道是不是默认打包了Ant。如果是这样，只需将二进制文件的位置添加到系统 PATH。

# php - INSERT INTO 不能正常工作

> ID：16020174
> 
> 赞同：-3
> 
> 时间：2013-04-15T16:25:56.487
> 
> 标签：php, html, mysql, insert

我在插入行时出错，是关于这个坏男孩的

```
mysql_query("INSERT INTO accounts('username', 'password', 'firstname', 'lastname', 'email') 
VALUES($username, $password, $firstname, $lastname, $email)") 
or die("Could not create account! <br/>" . mysql_error()); 
```

我收到的错误如下：

> 无法创建帐户！
> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在 ''username', 'password', 'firstname', 'lastname', 'email') VALUES(test, test,' at line 1 附近使用正确的语法

我怀疑这与未正确调用变量有关？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:29:12.213

有各种各样的问题，所以我将它们总结一下：

*   `INSERT INTO t1 ('col'`-- 注意`'col'`用引号括起来。这意味着它试图插入字符串文字“col1”而不是列名。删除引号并用反引号替换它们（或什么都没有）
*   值本身不包含在引号中。你有`VALUES(test`——这在语义上意味着插入列“test”的值，这是没有意义的。您实际上需要用引号括起来。
*   我冒昧地猜测没有任何输入参数被正确转义。您应该对 PDO 或 mysqli 使用正确的参数化查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:29:15.307

我的朋友不应该引用查询中的字段。尝试这个：

```
mysql_query("INSERT INTO accounts (username, password, firstname, lastname, email) VALUES($username, $password, $firstname, $lastname, $email)") or die("Could not create account!" . mysql_error()); 
```

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T16:29:28.137

您不必`'`在查询中使用引号但反引号`

```
mysql_query("INSERT INTO `accounts` (`username`, `password`, `firstname`, `lastname`, `email`) VALUES('".$username."', '".$password."','". $firstname."', '".$lastname."', '".$email."')") or die("Could not create account! " . mysql_error()) 
```

[**插入文档**](http://dev.mysql.com/doc/refman/5.5/en/insert.html)

我还想提醒您，`mysql_`功能已被弃用，因此我建议您切换到新项目[`mysqli`](http://php.net/manual/en/book.mysqli.php)或[`PDO`](http://php.net/manual/en/book.pdo.php)进行新项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T16:32:14.123

不推荐使用 mysql_query，很快就会被弃用。可能最好使用 PDO 或 mysqli 代替。 [http://php.net/manual/en/function.mysql-query.php](http://php.net/manual/en/function.mysql-query.php)

但要回答你的问题，我相信这是因为你的列名是单引号（而不是反引号）。

您的*价值观*需要在单引号内。您可能还想在这些变量上运行 mysql_real_escape_string，以防止 SQL 注入。或者只使用 PDO 准备好的语句。 [http://php.net/manual/en/pdo.prepared-statements.php](http://php.net/manual/en/pdo.prepared-statements.php)

# html - 为什么我的收藏图标在 Chrome 中不再可用？

> ID：16020179
> 
> 赞同：-1
> 
> 时间：2013-04-15T16:26:11.917
> 
> 标签：html, google-chrome, firefox, web, cross-browser

我的 favicon 在[Chrome Canary](https://en.wikipedia.org/wiki/Google_Chrome#Release_channels_and_updates)上工作了一段时间，在我更新它之后它就停止出现了。

我在下面提供了我的代码。

```
<html>
    <head>
        <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <title>Write IT</title>
    </head>
    <body>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:28:43.203

.ico 文件的正确 MIME 类型是`image/vnd.microsoft.icon`. 由于`image/x-icon`没有标准化，它通常是浏览器的宽大处理，不检查它是否真的有效。

# coldfusion - 带有 Coldfusion 的精美上传器

> ID：16020183
> 
> 赞同：0
> 
> 时间：2013-04-15T16:26:26.297
> 
> 标签：coldfusion, fine-uploader

我在尝试将 [http://fineuploader.com/](http://fineuploader.com/) 与 Coldfusion 服务器端一起使用时遇到 500 内部服务器错误[https://github.com/Widen/fine-uploader-server/tree/master/coldfusion](https://github.com/Widen/fine-uploader-server/tree/master/coldfusion)

控制台说：
[FineUploader] 尝试在 window.console.log('<' + level + '> ' + message) 中的这一行解析 xhr 响应文本时出错 (SyntaxError: Unexpected token <);

它似乎来自服务器 CFC 中的响应消息。

```
<!--- Code provided by Pegasus Web Productions LLC - www.pegweb.com --->
<!--- get stuck use the forums http://github.com/Widen/fine-uploader --->
<!--- Tested with Adobe CF Enterprise 9.x and Fine Uploader --->
<CFCOMPONENT HINT="I do your uploads from Fine Uploader" >
<!--- function for single file submission uploads where XHR is not supported ex:->
<CFFUNCTION NAME="Upload" ACCESS="remote" OUTPUT="false" RETURNTYPE="any"     RETURNFORMAT="JSON" >
    <CFARGUMENT NAME="qqfile" TYPE="string" REQUIRED="true" />

    <CFSET var local = structNew() >
    <CFSET local.response = structNew() >
    <CFSET local.requestData = GetHttpRequestData() ><!--- get the request headers   and body --->
    <CFSET UploadDir = "/Test/file2" ><!--- set your upload directory here ex: c:\website\www\images\ --->
    <!--- check if XHR data exists --->
    <CFIF len(local.requestData.content) GT 0 >

        <CFSET local.response = UploadFileXhr(arguments.qqfile, local.requestData.content) >

        <CFELSE><!--- no XHR data so process this as standard form submission --->
            <!--- upload the file --->
            <CFFILE ACTION="upload" FILEFIELD="form.qqfile" DESTINATION="#UploadDir#" NAMECONFLICT="makeunique" >

            <!--- populate our structure with information about the image we just uploaded in case we want to use this later for CFIMAGE tags or any other processing --->
            <CFSET local.metaData = { clientFile=FILE.clientFile, clientFileExt=FILE.clientFileExt, clientFileName=FILE.clientFileName, contentSubType=FILE.contentSubType, contentType=FILE.contentType, fileSize=FILE.fileSize } />
            <!--- return the response --->
            <CFSET local.response['success'] = true >
            <CFSET local.response['type'] = 'form' >
    </CFIF>
    <CFRETURN local.response >
</CFFUNCTION>

<!--- function for browsers that support XHR ex: Almost anything but IE --->

<CFFUNCTION NAME="UploadFileXhr" ACCESS="private" OUTPUT="false" RETURNTYPE="struct" >
    <CFARGUMENT NAME="qqfile" TYPE="string" REQUIRED="true" />
    <CFARGUMENT NAME="content" TYPE="any" REQUIRED="true" />

    <CFSET var local = structNew() >
    <CFSET local.response = structNew() >
    <CFSET UploadDir = "" ><!--- set your upload directory here ex: c:\website\www\images\ --->
    <!--- write the contents of the http request to a file. The filename is passed with the qqfile variable --->
    <CFFILE ACTION="write" FILE="#UploadDir#\#arguments.qqfile#" OUTPUT="#arguments.content#" NAMECONFLICT="makeunique" >

    <!--- populate our structure with information about the image we just uploaded in case we want to use this later for CFIMAGE tags or any other processing --->
    <CFSET local.metaData = { clientFile=FILE.clientFile, clientFileExt=FILE.clientFileExt, clientFileName=FILE.clientFileName, contentSubType=FILE.contentSubType, contentType=FILE.contentType, fileSize=FILE.fileSize } />

    <!--- return custom JSON if desired--->
    <CFSET local.response['success'] = true >
    <CFSET local.response['type'] = 'xhr' >
    <CFRETURN local.response >
</CFFUNCTION> 
```

调用页面

```
 <div id="thumbnail-fine-uploader">
    </div>
    <script src="/js/jQueryv1.9.1.js">
    </script>
    <script src="/Test/file2/jquery.fineuploader-3.4.1.js">
    </script>
    <script>
        $(document).ready(function(){
            var thumbnailuploader = new qq.FineUploader({
                element: $('#thumbnail-fine-uploader')[0],
                request: {
                    endpoint: 'image-uploader.cfc?method=Upload'
                },
                multiple: false,
                validation: {
                    allowedExtensions: ['jpeg', 'jpg', 'gif', 'png'],
                    sizeLimit: 51200 // 50 kB = 50 * 1024 bytes
                },
                callbacks: {
                    onComplete: function(id, fileName, responseJSON){
                        if (responseJSON.success) {
                            $('#thumbnail-fine-uploader').append('<img src="img/success.jpg" alt="' + fileName + '">');
                        }
                    }
                }
            });
        });
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T08:52:48.350

得到它的工作，我在第二种方法中丢失了我的上传目录路径。

```
<CFSET UploadDir = "#expandpath('/test/file2')#" > 
```

谢谢您的帮助

# python-2.7 - wxPython 中的全局事件监听器

> ID：16020188
> 
> 赞同：2
> 
> 时间：2013-04-15T16:26:56.567
> 
> 标签：python-2.7, wxpython, wx.html2

我`wx.html2`的`panel`. 可悲`wx.html2`的是没有很多事件监听器（[http://wxpython.org/Phoenix/docs/html/html2.WebView.html#events-events-emitted-by-this-class](http://wxpython.org/Phoenix/docs/html/html2.WebView.html#events-events-emitted-by-this-class)）。

现在我有这个绑定到我的`panel`（`self`是`panel`）；

```
self.Bind(wx.EVT_KEY_DOWN, self.OnRightClick) 
```

..当我`panel/frame`按预期输入 blanco 时，它就起作用了。

我想知道是否有一种方法可以`wx.html2`手动添加更多事件侦听器或创建一个全局事件侦听器来侦听，无论事件发生在哪个子小部件中。

这也不起作用（`self.wv`是`wx.html`对象）；

```
self.wv.Bind(wx.EVT_KEY_DOWN, self.OnRightClick) 
```

**更新**

我现在正在我的 HTML 页面中使用 JavaScript 修复键/鼠标操作的捕获。它有效，但我更希望动作可以绑定到`wx.html2`对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-28T14:25:37.127

WebView 发出的事件很少，所有这些都可以在[WebView - wxPython (Phoenix) 2.9.5.80 文档](http://wxpython.org/Phoenix/docs/html/html2.WebView.html#events-events-emitted-by-this-class)中找到。

# jquery - 为插件 JQuery DataTables 添加按钮行

> ID：16020197
> 
> 赞同：1
> 
> 时间：2013-04-15T16:27:35.553
> 
> 标签：jquery, jquery-plugins, datatables

我正在使用插件“DataTables”，我想逐行添加图像，当用户单击时，调用另一个 url。

我按照 www.datatables.net 的示例进行操作，但出现以下错误：

DataTables 警告（表 id = 'myDataTable'）：从第 0 行的数据源请求未知参数“4”。

记录显示在屏幕上

```
<h2>Index</h2>

<script type="text/javascript">
    $(document).ready(function () {

        var oTable = $('#myDataTable').dataTable({
            "bServerSide": true,
            "sAjaxSource": "AjaxHandler",
            "bProcessing": true,
            "sPaginationType": "full_numbers",   
            "aoColumns": [
                        { "mDataProp": "ID", "bSortable": false },
                        { "mDataProp": "Nome", "sTitle": "Identificação do produto" },
                        { "mDataProp": "Address", "sTitle": "Descrição do produto" },
                        { "mDataProp": "Town" },
                        { "fnRender": function (o) {return '<a href=/Produto/Detalhar/' + o.aData[0] + '>' + 'More' + '</a>';}} 
            ],
        });
    });
</script>

<table id="myDataTable" class="display">
    <thead>
        <tr>
            <th>ID</th>
            <th>Company name</th>
            <th>Address</th>
            <th>Town</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody> 
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-11-21T15:09:26.513

我正在使用 dataTables 版本 1.10.0-dev 并且接受的解决方案对我不起作用，因为 o.aData 未定义。相反，我拥有我在 o 中返回服务器端的 json 对象的所有属性。所以这是我的解决方案：

```
$(document).ready(function () {
    var oTable = $('#myDataTable').dataTable({
        "bServerSide": true,
        "sAjaxSource": "AjaxHandler",
        "bProcessing": true,
        "sPaginationType": "full_numbers",
        "aoColumns": [
            { "mData": "ID", "bSortable": false },
            { "mData": "Nome", "sTitle": "Identificação do produto" },
            { "mData": "Address", "sTitle": "Descrição do produto" },
            { "mData": "Town" },
            {
                "mData": null,
                "bSortable": false,
                "mRender": function (o) { return '<a href=/Produto/Detalhar/' + o.Id + '>' + 'More' + '</a>'; }
            }
        ]
    });
}); 
```

我不知道这是否取决于新版本的 dataTables 或其他配置（但我的表以相同的方式配置......）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-15T16:41:38.047

我真的不知道数据表（还不够），但你应该这样尝试：{不确定 mDataProp 是否被弃用}

```
$(document).ready(function () {

        var oTable = $('#myDataTable').dataTable({
            "bServerSide": true,
            "sAjaxSource": "AjaxHandler",
            "bProcessing": true,
            "sPaginationType": "full_numbers",   
            "aoColumns": [
                        { "mData": "ID", "bSortable": false },
                        { "mData": "Nome", "sTitle": "Identificação do produto" },
                        { "mData": "Address", "sTitle": "Descrição do produto" },
                        { "mData": "Town" },
                        {   "mData": null,
                    "bSortable": false,
            "mRender": function (o) {return '<a href=/Produto/Detalhar/' + o.aData[0] + '>' + 'More' + '</a>';}
            }   
            ]
        });
    }); 
```

确保您的数据与您的列声明相符，您应该将 json 作为 ajax 响应，其中包含数据 ID、Nome、Address 和 Town。如果您的第一个数据是 id 而不是 ID，我认为您会收到一个错误。

# android - 片段不匹配数据绑定错误

> ID：16020198
> 
> 赞同：0
> 
> 时间：2013-04-15T16:27:35.793
> 
> 标签：android

我在屏幕上有 2 个片段都扩展了`ListView`..我通过片段 1 中的代码填充列表，但数据绑定到片段 2 ..两个片段都在 xml 文件中声明。提前致谢

以下是**片段 1**的代码：

```
public class Fragment1 extends ListFragment implements OnFragmentUiUpdate {
    OnFragmentSelectedListener mCallback;
    private final int fragId = 1;
    // The container Activity must implement this interface so the frag can
    // deliver messages
    ListView list;

    /*@Override public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      se generateFragmentView(0,
      getActivity()); // We need to use a different list item layout for
      devices older than Honeycomb int layout =
      android.R.layout.simple_list_item_1;Build.VERSION.SDK_INT >=
      Build.VERSION_CODES.HONEYCOMB ?
      android.R.layout.simple_list_item_activated_1 :
      android.R.layout.simple_list_item_1;

      // Create an array adapter for the list view, using the Ipsum headlines
      array 
      int layout =
          android.R.layout.simple_list_item_1;Build.VERSION.SDK_INT >=
          Build.VERSION_CODES.HONEYCOMB ?
          android.R.layout.simple_list_item_activated_1 :
          android.R.layout.simple_list_item_1;
      setListAdapter(new ArrayAdapter<String>(getActivity(), layout,
      Ipsum.Headlines)); }*/

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {

        // If activity recreated (such as from screen rotate), restore
        // the previous article selection set by onSaveInstanceState().
        // This is primarily necessary when in the two-pane layout.

        // Inflate the layout for this fragment
        View vi = inflater.inflate(R.layout.menu_1_list, container, false);

        return vi;
    }

    @Override
    public void onStart() {
        super.onStart();

        /*
         * // When in two-pane layout, set the listview to highlight the
         * selected list item // (We do this during onStart because at the point
         * the listview is available.) if
         * (getFragmentManager().findFragmentById(R.id.article_fragment) !=
         * null) { getListView().setChoiceMode(ListView.CHOICE_MODE_SINGLE); }
         */
        generateFragmentView(0, getActivity());
    }

    @Override
    public void onAttach(Activity activity) {
        super.onAttach(activity);

        // This makes sure that the container activity has implemented
        // the callback interface. If not, it throws an exception.
        try {
            mCallback = (OnFragmentSelectedListener) activity;
        } catch (ClassCastException e) {
            throw new ClassCastException(activity.toString()
                    + " must implement OnHeadlineSelectedListener");
        }
    }

    @Override
    public void onListItemClick(ListView listView, View view, int position,
            long id) {
        // Notify the parent activity of selected item
        mCallback.onFragmentSelected(listView, view, position, id, fragId);

        // Set the item as checked to be highlighted when in two-pane layout
        getListView().setItemChecked(position, true);
    }

    @Override
    public void generateFragmentView(int position, Activity mainScreen) {
        // TODO Auto-generated method stub

        DbAdapter dbAdapter = null;
        dbAdapter = new DbAdapter(mainScreen.getApplicationContext());
        List<BindObject> menu1 = null;
        dbAdapter.open();
        try {
            menu1 = (List<BindObject>) dbAdapter.selectAll(Menu1.class);
            System.out.println("menu");
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        dbAdapter.close();
        list = (ListView) mainScreen.findViewById(android.R.id.list);

        LazyAdapter adapter = new LazyAdapter(mainScreen, this,
                (List<BindObject>) menu1);
        list.setAdapter(adapter);
    }

    @Override
    public View updateFragmentView(int position, Activity activity,
            LayoutInflater inflater, List<BindObject> Data, View convertView,
            ViewGroup parent) {

        View vi = convertView;
        ViewHolder holder = null;
        if (convertView == null) {
            vi = inflater.inflate(R.layout.menu1_item, null);

            holder = new ViewHolder();

            holder.item = (TextView) vi.findViewById(R.id.item);

            vi.setTag(holder);
        } else
            holder = (ViewHolder) vi.getTag();

        Menu1 menu = (Menu1) Data.get(position);

        holder.item.setText(menu.getItem());

        return vi;

    }

    public static class ViewHolder {

        public TextView item;

    }

} 
```

以下是**片段 2**的代码：

```
public class Fragment1_1 extends ListFragment implements OnFragmentUiUpdate{
    OnFragmentSelectedListener mCallback;
    ListView   list;
    private final int fragId=2;
    // The container Activity must implement this interface so the frag can deliver messages

    /*@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // We need to use a different list item layout for devices older than Honeycomb
        int layout = android.R.layout.simple_list_item_1;Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB ?
                android.R.layout.simple_list_item_activated_1 : android.R.layout.simple_list_item_1;

        // Create an array adapter for the list view, using the Ipsum headlines array
        setListAdapter(new ArrayAdapter<String>(getActivity(), layout, Ipsum.Headlines));

    }*/

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, 
            Bundle savedInstanceState) {

        // If activity recreated (such as from screen rotate), restore
        // the previous article selection set by onSaveInstanceState().
        // This is primarily necessary when in the two-pane layout.

        // Inflate the layout for this fragment
        return inflater.inflate(R.layout.menulist, container, false);
    }

    @Override
    public void onStart() {
        super.onStart();

        // When in two-pane layout, set the listview to highlight the selected list item
        // (We do this during onStart because at the point the listview is available.)
        if (getFragmentManager().findFragmentById(R.id.article_fragment) != null) {
            getListView().setChoiceMode(ListView.CHOICE_MODE_SINGLE);
        }
    }

    @Override
    public void onAttach(Activity activity) {
        super.onAttach(activity);

        // This makes sure that the container activity has implemented
        // the callback interface. If not, it throws an exception.
        try {
            mCallback = (OnFragmentSelectedListener) activity;
        } catch (ClassCastException e) {
            throw new ClassCastException(activity.toString()
                    + " must implement OnHeadlineSelectedListener");
        }
    }

    @Override
    public void onListItemClick(ListView l, View v, int position, long id) {

        // Notify the parent activity of selected item
        mCallback.onFragmentSelected(l, v, position, id,fragId);

        // Set the item as checked to be highlighted when in two-pane layout
        getListView().setItemChecked(position, true);
    }

    public void updateArticleView(int position) {
        TextView article = (TextView) getActivity().findViewById(R.id.article);
        article.setText(Ipsum.Articles[position]);
        //mCurrentPosition = position;
    }

    @Override
    public void generateFragmentView(int position, Activity mainScreen) {
        // TODO Auto-generated method stub
        //updateArticleView( position);

        list = (ListView) mainScreen.findViewById(android.R.id.list);

        LazyAdapter adapter = new LazyAdapter(mainScreen,this, (List<BindObject>) Util.generateData());
        list.setAdapter(adapter);
    }

    @Override
    public View updateFragmentView(int position, Activity activity,LayoutInflater inflater,List<BindObject> Data, View convertView, ViewGroup parent) {
        View vi = convertView;
        ViewHolder holder = null;
        if (convertView == null) {
            vi = inflater.inflate(R.layout.menu1_1_item, null);

            holder = new ViewHolder();

            holder.item = (TextView) vi.findViewById(R.id.item);
            holder.image = (ImageView) vi.findViewById(R.id.image);

            vi.setTag(holder);
        } else
            holder = (ViewHolder) vi.getTag();

        Menu1_1 menu = (Menu1_1) Data.get(position);

        holder.item.setText(menu.getItem());
        String imagString=activity.getPackageName()+":drawable/"+"ic_launcher";
        int res = activity.getResources().getIdentifier(imagString, null, null);
        holder.image.setImageResource(res);
        return vi;

    }
    public static class ViewHolder {

        public TextView item;
        public ImageView image;

    }

} 
```

**main.xml**的代码：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#000000"
    android:orientation="horizontal" >

    <TableLayout
        android:id="@+id/tableLayout1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerInParent="true" >
        <TableRow
            android:id="@+id/tableRow1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >
        </TableRow>
        <TableRow
            android:id="@+id/tableRow1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" >
            <fragment
                android:id="@+id/Fragment1_1"
                android:name="com.example.android.fragments.Fragment1_1"
                android:layout_width="60dp"
                android:layout_height="100dp"
                android:layout_weight="0.25" />
            <fragment
                android:id="@+id/Fragment1_1_1"
                android:name="com.example.android.fragments.Fragment1_1_1"
                android:layout_width="90dp"
                android:layout_height="100dp"
                android:layout_weight="0.75" />
        </TableRow>
        <TableRow
            android:id="@+id/tableRow1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >
        </TableRow>
    </TableLayout>

    <SlidingDrawer
        android:id="@+id/SlidingDrawer"
        android:layout_width="wrap_content"
        android:layout_height="150dip"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:content="@+id/contentLayout"
        android:handle="@+id/slideButton"
        android:orientation="vertical"
        android:padding="10dip" >
        <Button
            android:id="@+id/slideButton"
            android:layout_width="50dp"
            android:layout_height="50dp"
            android:background="@drawable/ic_launcher" >
        </Button>

        <TableLayout
            android:id="@+id/contentLayout"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >
            <TableRow
                android:id="@+id/tableRow4"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical"
                android:gravity="center_vertical" >
                <ImageButton
                    android:id="@+id/feature"
                    android:layout_width="50dp"
                    android:layout_height="50dp"
                    android:layout_weight="0.2"
                    android:background="@drawable/ic_launcher"
                    android:onClick="displayFeature" />
                <ImageButton
                    android:id="@+id/feature"
                    android:layout_width="50dp"
                    android:layout_height="50dp"
                    android:layout_weight="0.2"
                    android:background="@drawable/ic_launcher"
                    android:onClick="displayFeature" />
                <ImageButton
                    android:id="@+id/feature"
                    android:layout_width="50dp"
                    android:layout_height="50dp"
                    android:layout_weight="0.2"
                    android:background="@drawable/ic_launcher"
                    android:onClick="displayFeature" />
                <ImageButton
                    android:id="@+id/feature"
                    android:layout_width="50dp"
                    android:layout_height="50dp"
                    android:layout_weight="0.2"
                    android:background="@drawable/ic_launcher"
                    android:onClick="displayFeature" />
                <ImageButton
                    android:id="@+id/feature"
                    android:layout_width="50dp"
                    android:layout_height="50dp"
                    android:layout_weight="0.2"
                    android:background="@drawable/ic_launcher"
                    android:onClick="displayFeature" />
                <ImageButton
                    android:id="@+id/feature"
                    android:layout_width="50dp"
                    android:layout_height="50dp"
                    android:layout_weight="0.2"
                    android:background="@drawable/ic_launcher"
                    android:onClick="displayFeature" />

                <TableLayout
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content" >
                    <TableRow
                        android:layout_width="fill_parent"
                        android:layout_height="wrap_content" >
                        <ImageButton
                            android:id="@+id/googlebtn"
                            android:layout_width="50dp"
                            android:layout_height="50dp"
                            android:layout_weight="0.2"
                            android:background="@drawable/ic_launcher"
                            android:onClick="displayFeature" />
                        <ImageButton
                            android:id="@+id/tweeterBtn"
                            android:layout_width="50dp"
                            android:layout_height="50dp"
                            android:layout_weight="0.2"
                            android:background="@drawable/ic_launcher"
                            android:onClick="displayFeature" />
                    </TableRow>
                    <TableRow
                        android:layout_width="fill_parent"
                        android:layout_height="wrap_content" >
                        <ImageButton
                            android:id="@+id/fb"
                            android:layout_width="50dp"
                            android:layout_height="50dp"
                            android:layout_weight="0.2"
                            android:background="@drawable/ic_launcher"
                            android:onClick="displayFeature" />
                        <ImageButton
                            android:id="@+id/fb2"
                            android:layout_width="50dp"
                            android:layout_height="50dp"
                            android:layout_weight="0.2"
                            android:background="@drawable/ic_launcher"
                            android:onClick="displayFeature" />
                    </TableRow>
                </TableLayout>
            </TableRow>
        </TableLayout>
    </SlidingDrawer>

    <fragment
        android:id="@+id/Fragment1"
        android:name="com.example.android.fragments.Fragment1"
        android:layout_width="100dp"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/tableLayout1"
        android:layout_marginTop="106dp"
        android:tag="feature" />

    <ImageButton
        android:id="@+id/menu1Btn"
        android:layout_width="20dp"
        android:layout_height="20dp"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/Fragment1"
        android:background="@drawable/ic_launcher"
        android:onClick="displayFeature" />

</RelativeLayout> 
```

* * *

Fragment1 数据与 fragent2 绑定 ...在调试时 ..fragment1 代码正常运行，但 generatefragentView() 函数数据转到 fragment2 并且 fragment1 显示空白

# database - 图片路径保存到数据库

> ID：16020199
> 
> 赞同：0
> 
> 时间：2013-04-15T16:27:39.240
> 
> 标签：database, image, upload

我有一个图片上传按钮。我想将图像保存到我的解决方案中的文件夹中并保存到数据库的路径。我使用**FileUpload1.SaveAs(Server.MapPath(imgPath));**

但我得到了错误

**找不到路径“C:\Users\indian.......\ImageStorage\DSC01420.JPG”的一部分。**

如何将图像保存到文件夹和数据库的路径并检索它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-11T04:42:19.687

```
 **LINK EACH PROGRAMS**
    -------------------------------------------------------------------------------------- 
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
</head>
<body>
<div>
            <h3> Choose File to Upload in Server </h3>          
           <form action="Recent" method="post" enctype="multipart/form-data">

            <input type="file" name="file" />
            <input type="submit" value="upload" />
            </form>          
        </div>

</body>
</html>
-------------------------------------------------------------------------------------------    
    import java.sql.*;
    import java.io.*;

    import javax.servlet.ServletException;
    import javax.servlet.annotation.MultipartConfig;
    import javax.servlet.annotation.WebServlet;
    import javax.servlet.http.HttpServlet;
    import javax.servlet.http.HttpServletRequest;
    import javax.servlet.http.HttpServletResponse;
    import javax.servlet.http.Part;
    import javax.servlet.annotation.MultipartConfig;
    import javax.servlet.annotation.WebServlet;
    import java.util.Hashtable;
    import java.util.List;

    import org.apache.commons.fileupload.FileItem;
    import org.apache.commons.fileupload.ParameterParser;
    import org.apache.commons.fileupload.disk.DiskFileItemFactory;
    import org.apache.commons.fileupload.servlet.ServletFileUpload;

    /**
     * Servlet implementation class Recent
     */
    @WebServlet("/Recent")
    @MultipartConfig
    public class Recent extends HttpServlet {
        private static final long serialVersionUID = 1L;

        /**
         * @see HttpServlet#HttpServlet()
         */
        public Recent() {
            super();
            // TODO Auto-generated constructor stub
        }

        /**
         * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
         */
        protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

            // TODO Auto-generated method stub
             Sample  s1=new Sample();
             final String UPLOAD_DIRECTORY = "/home/pradeep/Documents/pradeep/WebContent/Images";
             if(ServletFileUpload.isMultipartContent(request)){
                    try {
             List<FileItem> multiparts = new 
                                ServletFileUpload(new DiskFileItemFactory()).parseRequest(request);

                        for(FileItem item : multiparts){
                            if(!item.isFormField())
                            {
                                String name = new File(item.getName()).getName();
                                item.write( new File(UPLOAD_DIRECTORY + File.separator + name));
                                String Path= "/home/pradeep/Documents/pradeep/WebContent/Images/" +name;

                              s1.connecting(Path);

                            }
                        }

                            request.setAttribute("message", "File Uploaded Successfully");
                    } catch (Exception ex) {
                       request.setAttribute("message", "File Upload Failed due to " + ex);
                    }          

                }else{
                    request.setAttribute("message",
                                         "Sorry this Servlet only handles file upload request");
                }

                    request.getRequestDispatcher("/Result.jsp").forward(request, response);

        }

    }

    ---------------------------------------------------------------------------------------
     import java.sql.Connection;
        import java.sql.DriverManager;
        import java.sql.PreparedStatement;
        import java.sql.ResultSet;
        import java.sql.SQLException;

        import dbconnections.Connections;

        public class Sample {
            Connections con=new Connections();

            public void connecting(String Path)
            {
                Connection conn=con.Connect();

                PreparedStatement pst;
                String query="INSERT INTO Student1 (Path) values (?)";
               try {

                    pst=conn.prepareStatement(query);
                    pst.setString(1,Path);
                    pst.executeUpdate();

                } catch (SQLException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

                // TODO Auto-generated method stub
            }

        } 
```

# android - 光标 c 的空指针异常

> ID：16020201
> 
> 赞同：0
> 
> 时间：2013-04-15T16:27:46.427
> 
> 标签：android, database, eclipse

```
public abstract class AbstractIME extends InputMethodService implements 
KeyboardView.OnKeyboardActionListener, CandidateView.CandidateViewListener {
    ...
    private void clearCandidates() {
        ...
        final dbhelper helper = new dbhelper(this);
        Cursor c = helper.query();
    }
    ...
}

public class CangjieDictionary extends WordDictionary {
    private AbstractIME ime;
    ....
    private String sortWords(char[] data) {
        ....
        dbhelper dbh = new dbhelper(ime); ;
        Cursor c = dbh.query();
    }
} 
```

这里有两个类。第一个没问题，但第二个代码相同

以下是 logcat 消息为什么第二类有空指针？

```
FATAL EXCEPTION: main
  java.lang.NullPointerException
at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:98)
at com.googlecode.tcime.unofficial.dbhelper.query(dbhelper.java:50)
at com.googlecode.tcime.unofficial.CangjieDictionary.sortWords(CangjieDictionary.java:111) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T18:08:58.550

在`WordDictionary`声明一个 Context 成员并创建一个具有 Context 参数的构造函数

```
Context mContext;

public WordDictionary(Context context)
{
     mContext = context:
} 
```

然后在`CangjieDictionary`

```
public class CangjieDictionary extends WordDictionary {
private AbstractIME ime;
....
private String sortWords(char[] data) {
    ....
    dbhelper dbh = new dbhelper(mContext);
    Cursor c = dbh.query();
} 
```

}

# sakai - Sakai + 偏好工具 + 可见

> ID：16020205
> 
> 赞同：1
> 
> 时间：2013-04-15T16:27:57.890
> 
> 标签：sakai

我想改变酒井的语言。所以我需要偏好工具。如何让管理员可见？

谢谢，尼拉夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-15T04:52:01.940

使用 Admin Workspace Sites 工具，您可以将 User Preferences 工具添加到 ~admin 站点，然后管理员用户可以管理他们自己的语言。其他用户可以通过他们的 My Workspace 站点执行相同操作。

注意，如果要更改整个 Sakai 安装的语言，需要在 JAVA_OPTS 中进行设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:57:55.877

要更改 Sakai 的默认语言，请在启动 tomcat 时将其指定为命令行选项。例如将默认语言更改为法语添加：

```
-Duser.language=fr 
```

到启动选项。更多详细信息可在[Sakai i18n 常见问题解答](https://confluence.sakaiproject.org/pages/viewpage.action?pageId=31162384)中找到。目前无法使用 Web 界面更改所有 Sakai 用户的默认语言。

# delphi - DELPHI：“无效的属性元素：系统”

> ID：16020206
> 
> 赞同：0
> 
> 时间：2013-04-15T16:28:01.780
> 
> 标签：delphi, soap, delphi-2005

我正在使用 WSDL，当我尝试执行其中一种方法时出现错误

> .. 引发异常类 EPropertyConvertError 并带有消息“无效的属性元素：系统”

任何想法是什么原因造成的？

这是我正在运行的代码（cEPS_* 是代码前面定义的常量）：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  Headers : ISOAPHeaders;
  aResult: c_ExpressPSAPI.Response;
begin
  try
    FEPS_SoapService := c_ExpressPSAPI.GetExpressSoap();
    FEPS_Headers := (FEPS_SoapService as ISOAPHeaders);

    FEPS_Application := c_ExpressPSAPI.Application.Create();
    FEPS_Application.ApplicationID := cEPS_ApplicationID;
    FEPS_Application.ApplicationName := cEPS_ApplicationName;
    FEPS_Credentials := c_ExpressPSAPI.Credentials.Create();
    FEPS_Credentials.AccountID := cEPS_AccountID;
    FEPS_Credentials.AccountToken := cEPS_AccountToken;
    FEPS_Credentials.AcceptorID := cEPS_AcceptorID;
    FEPS_Credentials.NewAccountToken := '';

    aResult := c_ExpressPSAPI.Response.Create;
    aResult := FEPS_SoapService.HealthCheck(FEPS_Credentials, FEPS_Application);

  except
    on E : ERemotableException do
      ShowMessage(E.ClassName + ' error raised, with message : ' + E.FaultDetail + ' :: '
                    + E.Message);

  end;

end; 
```

这是 WSDL 代码：

```
 ExpressSoap = interface(IInvokable)
  ['{83D77575-DBDE-3A05-D048-60B2F6BCDFE6}']
    function  HealthCheck(const credentials: Credentials; const application: Application): Response; stdcall; 
```

# php - jquery map动态创建单元格

> ID：16020207
> 
> 赞同：0
> 
> 时间：2013-04-15T16:28:04.013
> 
> 标签：php, javascript, mysql, jquery

我正在制作以标准 X/Y 坐标方式组织的基本地图。在每个坐标 (x,y) 处，都有存储在数据库中的内容（每个位置的内容通过 php/mysql 数据库加载）。

在我当前的设置中，地图只是作为静态对象放置在页面中，我使用 jquery/ajax 来更新坐标的显示和数据。

我正在寻找一种方法来动态加载单击和拖动地图，它将根据需要加载单元格。（出现在您的视图中的内容——在本例中为窗口，应从服务器加载——使用相对于其周围单元格的正确坐标创建一个 div）。

截至目前，我的静态地图有这个设置：http: [//i.stack.imgur.com/LeVYO.gif](http://i.stack.imgur.com/LeVYO.gif) （链接，因为我不能发布图片）

图像逐行放置（z 索引随着每一行的下降而变化，以呈现重叠的外观）。如果要复制相同的模式，以动态创建这些单元格，您可以看到当一行在右侧伸出时，左侧有空间，容易重叠。

我还没有找到任何方法来实现这一点：1）当一个单元格（内部有多个坐标的区域）可见时，检查周围的 8 个单元格是否已经加载。2) 如果周围 8 个单元格中的 1 个未加载，则在正确位置创建单元格，并分配“中心坐标”，以便生成的数据具有参考点。3) 确保单元格可通过单击和拖动移动，以及单击（交互）下的对象的能力。4) 无法通过滚动访问单元格（滚动条）

我觉得它相当复杂，但我正在寻找最好的方法，所以任何帮助或方向都会很棒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:47:36.450

尽管我很想提供帮助，但我真的无法给出可以解决问题的答案，对此我深表歉意，但我想我可以尝试将您引向某事。

它是 HTML 5 的画布和相关功能。

看那个：

[http://www.html5canvastutorials.com/advanced/html5-canvas-mouse-coordinates/](http://www.html5canvastutorials.com/advanced/html5-canvas-mouse-coordinates/)

也许您还必须查看如何使用 HTML 5 构建 MAP

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:22:01.793

经过修补和大量谷歌搜索，快速搜索“jquery无限拖动”返回了这个结果：http: [//ianli.com/infinitedrag/](http://ianli.com/infinitedrag/)

我设法使用创建每个单元格时提供的函数调用，从数据库（ajax）收集地图数据并根据需要创建单元格。 [http://mc1.empirebattles.com/map/jquery_map.html](http://mc1.empirebattles.com/map/jquery_map.html)

我真的很喜欢它到目前为止的工作方式，除了如果我想能够点击地图下的任何东西（用于操作等），每当我释放点击以拖动地图时都会调用点击事件...... . 我试过 jquery 的 UI 双击，但似乎这个插件会在调用双击时立即控制

无论如何，如果其他人需要类似的东西，这个解决方案对我有很大帮助！

# android-intent - 应用程序中的 PDF 文件 - 不是存储卡

> ID：16020211
> 
> 赞同：0
> 
> 时间：2013-04-15T16:28:33.187
> 
> 标签：android-intent

是否可以将所需的 PDF 文件存储在 Res 文件夹中的单独文件夹下，然后阅读它们。我有代码可以从 SD 卡或手机上的任何地方读取它们，但我希望将它们包含在应用程序中。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:35:42.007

是的，很有可能。应用程序图标的工作方式也相同。您只需通过其资源调用文件。我想您正在尝试为 android 编写代码？

# ruby-on-rails - 将 rspec、zeus 和 database_cleaner 与两个不同的 active_record 数据库一起使用，以未定义的方法 `query_options' 结束 nil:NilClass 错误

> ID：16020215
> 
> 赞同：3
> 
> 时间：2013-04-15T16:28:38.800
> 
> 标签：ruby-on-rails, activerecord, zeus, database-cleaner

我想使用 zeus (0.13.3) 为 ruby​​ 2.0.0 上的 rails (3.2.11) 应用程序预加载我的 rails 环境，并使用 database_cleaner (0.9.1) 清理数据库。只要我只使用一个 mysql 数据库，它就可以正常工作。在应用程序中，我们必须使用两个不同的 mysql 数据库。 *编辑：*需要提到的是，我使用了[这里](https://stackoverflow.com/questions/8774227/why-not-use-shared-activerecord-connections-for-rspec-selenium)描述的共享连接黑客。

在不使用 zeus 的情况下运行我的规范就像预期的那样工作。但是，如果我使用它，每次测试都会在创建错误记录的那一刻失败：

```
undefined method `query_options' for nil:NilClass 
```

如何解决？

设置是这样的：

```
config/database.yml

test:
  database: app_test
  ...

test_second_db:
  database: other_test
  ... 
```

在使用第二个连接的所有模型的抽象基类中，我们做

```
models/second_db/base.rb

module SecondDB

  class Base < ActiveRecord::Base

    establish_connection "#{Rails.env}_second_db"
    self.abstract_class = true

  end

end 
```

在我的 spec_helper.rb 文件中，我设置了 database_cleaner：

```
spec/spec_helper.rb

require 'database_cleaner'

RSpec.configure do |config|
  config.use_transactional_fixtures = false

  config.before(:suite) do
    DatabaseCleaner.strategy = :transaction
    DatabaseCleaner[:active_record,{:connection => :test_second_db}].strategy = :transaction
  end

  config.before(:each) do
    DatabaseCleaner.start
    DatabaseCleaner[:active_record,{:connection => :test_second_db}].start
  end

  config.after(:each) do
    DatabaseCleaner.clean
    DatabaseCleaner[:active_record,{:connection => :test_second_db}].clean
  end

end 
```

*编辑：*

```
spec/support/shared_connection.rb

class ActiveRecord::Base
  mattr_accessor :shared_connection
  @@shared_connection = nil

  def self.connection
    @@shared_connection || retrieve_connection
  end
end 
```

规范/支持/shared_connection.rb

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T23:43:38.913

不确定这是否会解决您的问题，因为我无法对其进行测试，但您可能想尝试将其添加到您的 spec_helper 文件中。

```
ActiveRecord::ConnectionAdapters::ConnectionPool.class_eval do
        def current_connection_id
          # Thread.current.object_id
          Thread.main.object_id
        end
end 
```

在测试中运行浏览器时，这用于 Selenium。测试使用事务，浏览器是一个单独的进程，所以它看不到数据库。这可能不是问题/解决方案，但值得一试。

# ios - 使用 git 子模块/cocoapods

> ID：16020216
> 
> 赞同：18
> 
> 时间：2013-04-15T16:28:38.880
> 
> 标签：ios, github, repository, git-submodules, cocoapods

我正在开发一个项目，其中包括来自 Git 的其他存储库。

我想跟上这些存储库的最新信息。了解最新功能、错误修复等。 Qu 1) 在不收到报告的所有问题等电子邮件的情况下，在 Git 上与存储库保持同步的最佳方式是什么？

完成后，我想知道将这些包含到您的项目中的最佳方法。我知道您可以将源代码复制到项目中，但是 cocoapods/sub 模块是做什么用的？例如，使用包含的存储库的最新更改来更新项目的正确方法是什么？

与终端相比，这些方法中是否有任何 GUI？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-16T08:50:09.757

[Cocoapods](http://cocoapods.org)是在 Xcode 项目中包含其他项目的好方法。Cocoapods 项目维护了许多开源库的[*pod 规范文件列表，其中指定了下载代码的位置以及如何将它们集成到现有项目中。*](https://github.com/CocoaPods/Specs)正如您所指出的，您通常必须添加一个`git submodule`，手动将源文件添加到您的项目中，更新您的构建设置等等。Cocoapods 为您处理所有这些。

我不确定是否有办法在不通知问题的情况下跟踪 Github 项目的更新，但 Cocoapods 肯定可以告诉您是否有任何“pod”已过时。然后是一个命令将它们更新到最新版本。也就是说，通常[最好的做法](http://9elements.com/io/index.php/cocoapods-best-practices/)是将您的外部依赖项“锁定”到您知道可以正常工作的特定版本。

## 使用 Cocoapods

要开始，首先[安装 Cocoapods](http://docs.cocoapods.org/guides/installing_cocoapods.html)。然后，您只需在根项目目录（包含您的`.xcodeproj`文件的同一目录）中创建一个名为`Podfile`. 在内部，您可以指定目标操作系统和依赖项：

```
platform :ios, '5.0'

pod 'AFNetworking', '0.9.1'
pod 'OHAttributedLabel', '0.1.1' 
```

上面的示例针对 iOS 5.0，并引入了*AFNetworking*和*OHAttributedLabel*项目。

然后，在终端中，切换到您的项目目录：

```
> cd path/to/my/project 
```

并运行`pod install`。

```
> pod install 
```

这将为您检查最新版本的依赖项。它还会为您生成一个`.xcworkspace`文件。从现在开始，当您处理项目时，**您必须打开 .xcworkspace，而不是 .xcodeproj 文件**。

在您的新工作区中，您将拥有现有的 Xcode 项目和一个新`Pods`项目 - 这包含您所有的第三方库。只需像往常一样构建并运行您的应用程序，Pods 项目也将被构建并包含在内。

其他一些有用的 Cocoapods 命令：

```
> pod outdated 
```

将列出所有有可用更新的依赖项。

```
> pod search query 
```

将在所有已知的 Pod 规范中搜索“查询”。对查找新库很有用！

## 教程

*   看起来 Tutsplus 有一个很好[的 Cocoapods 入门教程](http://mobile.tutsplus.com/tutorials/iphone/streamlining-cocoa-development-with-cocoapods/)
*   Cocoapods 上有一个[免费的 NSScreencast 剧集](http://nsscreencast.com/episodes/5-cocoapods)

## 图形用户界面

恐怕我不知道 Cocoapods 的任何 GUI，但是您需要知道的终端命令确实不多。熟悉命令行是值得的，因为它是一个非常有用的开发人员工具。

也就是说，据我所知，[Appcode](http://www.jetbrains.com/objc/)（[Jetbrains 的](http://www.jetbrains.com)Objective-C 替代 IDE）计划在下一次更新中添加 Cocoapods 支持。

祝你好运！

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-12-02T08:36:48.363

James Frost 的回答很好地解释了如何使用 Cocoapods 及其相对于子模块的优势。

子模块相对于 Cocoapods 的一些重要优势是：

**子模块是子存储库**- 这不仅意味着 git 和 git GUI 隐式识别它们并且越来越多地支持轻松地使用它们，还意味着您的依赖项与它们的 git 存储库、Cocoapods 驻留在的美妙世界保持联系. 这意味着您可以在项目中协作和测试更改，您的项目通常是详细说明依赖项的灵感来源。

不幸的是，Cocoapods 不维护这个链接，处理依赖意味着从 git 克隆它，超出了 Cocoapods 的范围。 **编辑：**值得注意的是，Cocoapods 确实允许使用`path`or`local`字段在本地 pod 上工作，甚至可以构建自己的 Spec repo，但它仍然不是一个简单的过程。

**少了一个工具依赖**——正如上一个项目中提到的，子模块是 git 的一个功能，您使用 git 意味着它们可供您使用。任何软件采用 git 意味着它们最终将支持 git 的所有（重要）功能或涵盖常见用例的所有功能。Xcode 5 引入了对 git 和 GUI 的基本支持（它们是工具依赖项，这是真的，但希望只是指示信息如何呈现，git 指示它如何工作），例如 Git Tower，使子存储库的工作变得简单。

Cocoapods 已经走过了漫长的道路，每天都在努力成为一个稳定的、不可或缺的工具。然而，它还没有得到 Apple 的认可，而且 Apple 没有任何理由不发布破坏 Cocoapods 的 Xcode 更改。此外，Cocoapods 依赖于 Ruby。*此外，考虑到围绕 Cocoapods 产生了多少关注和社区，Apple 忽略它是愚蠢的。*

* * *

还值得注意的是，使用一个并不会阻止您使用另一个。这可能是一个令人头疼的问题，或者它可能是您所需要的，也许将 Cocoapods 用于小型类库或具有复杂依赖关系的库以及您将经常与之交互的库的子模块。

# certificate - 在 xcode IOS 模拟器中启用密码锁定

> ID：16020220
> 
> 赞同：4
> 
> 时间：2013-04-15T16:28:45.290
> 
> 标签：certificate, ios-simulator

我正在使用 IOS 模拟器 v6.0。设备是 iPhone（关于我的问题，所有 iPhone 设备的行为都相同）IOS 版本是 6.1

我正在尝试使用内置的 Safari 浏览器通过网络应用程序下载 p12。

下载完成后，用户会自动转到设置应用程序（据我所知，这是完成 p12 安装所必需的） - 但没有完成安装的选项。我读过启用证书导入需要密码锁。但是，我不知道如何在 iPhone IOS 模拟器中启用密码锁定。

我读过的文档说该选项应该在：设置->常规->密码锁定

除了不是。这是模拟器特定的限制吗？我能克服吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T14:41:31.167

尼尔，

是的，正如您所指出的，iOS 模拟器不是 100% 准确复制实际 iOS 设备中的操作环境——某些类型的交互依赖于专门的硬件（相机、陀螺仪、磁力计、硬件——基于加密技术等）在模拟环境中自然是不支持的。在模拟器上也禁止其他看似“纯软件”类型的交互（推送通知、iCloud 等）——这可归因于以下几件事：

1.  与物理设备不同，您无需配置 iOS 模拟器。由于 Provisioning Profiles 包含这些 Apple 服务的权利，因此 Simulator 没有（当前）方法来了解如何连接到这些服务的特定应用程序部分。
2.  模拟器没有唯一的硬件标识符，因此来自您的模拟器的连接与任何其他开发者模拟器上的连接无法区分。

最后，有一类交互不符合上述任何一个排除项，只能归因于 Apple 做出的设计决策。例如，密码锁可以由具有安全意识的 iOS 设备用户简单地启用......或者它可以由 IT 部门通过移动设备配置策略（通过 ActiveSync、MDM 服务器等）强制执行。非 IT 强制版本的密码锁定会导致模拟器内功能奇偶校验，因为仅支持最通用的密码锁定行为，从而使 MDM 用户处于冷战状态。为避免这种情况，Apple 必须赋予 Simulator 支持 .mobile 配置文件的知识，连接并定期检查 MDM 服务器（因此需要唯一的硬件标识符），并最终包含邮件。

正如你所看到的，这个相对简单的功能很快就会扩展到许多其他也需要模拟的 iOS 元素。考虑到最不可能、最极端的情况，Simulator 将成为一款功能完备的纯软件 iPhone，您可以在其中直接从 OS X 上的 iPhone 形界面接听电话和短信、查看电子邮件等……不是 Apple 的体验即使这些用户是他们的第 3 方开发人员，也希望用户拥有。

尽管有一些交互我们可以很容易地推断出它们从模拟器中省略的理由，但只有 Apple*真正*知道他们为什么选择从模拟器中排除其他交互。

所以，回到你的问题：

*这是模拟器特定的限制吗？*

是的，从 Xcode 4.6.2 开始，iOS 模拟器目前不支持此功能。

*我能克服吗？*

据我所知，没有。

但是，我确实认为您关于在模拟器中安装证书的潜在问题是您可以做的事情 - 事实上，我在我的模拟器中安装了一个自签名证书颁发机构，以进行一些基于 2 个月前的安全测试在很大程度上归功于[Charles Web 代理](http://www.charlesproxy.com/documentation/faqs/ssl-connections-from-within-iphone-applications/)的开发人员提供的一些工作。

如果您下载他们的 shell 脚本，您可以看到他们如何将自签名证书注入 Simulator 密钥库——假设您的最终目标是安装证书，您可以将类似的过程应用于您自己的证书。

**请务必备份默认密钥库；很容易意外地破坏该文件中的二进制数据并使您的模拟器对所有 SSL 连接都无用。**

**正如可能默认的那样，这不是 iOS 模拟器中受支持的操作——调整模拟器需要您自担风险。**

祝你好运，如果一切都失败了，请将您的应用程序推送到您绝对可以安装证书的设备。

# r - 如何计算列中前 4 个观察值的平均值？

> ID：16020221
> 
> 赞同：1
> 
> 时间：2013-04-15T16:28:59.200
> 
> 标签：r, max, mean

如何计算列中前 4 个观察值的平均值？

```
c(12, 13, 15, 1, 5, 9, 34, 50, 60, 50, 60, 4, 6, 8, 12) 
```

例如，在上面我会得到 (50+60+50+60)/4 = 55。我只知道如何使用分位数，但它不适用于这个。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T16:46:22.793

由于您只对前 4 个项目感兴趣，因此您可以使用`partial sort`而不是完整排序。如果你的向量很大，你可能会节省很多时间：

```
x <- c(12, 13, 15, 1, 5, 9, 34, 50, 60, 50, 60, 4, 6, 8, 12)
idx <- seq(length(x)-3, length(x))
mean(sort(x, partial=idx)[idx])
# [1] 55 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T16:32:10.490

尝试这个：

```
vec <- c(12, 13, 15, 1, 5, 9, 34, 50, 60, 50, 60, 4, 6, 8, 12)

mean(sort(vec, decreasing=TRUE)[1:4]) 
```

给

```
[1] 55 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T18:31:20.597

您可以使用订单功能。按 -x 排序以按降序给出值，并平均前 4 个：

```
x <- c(12, 13, 15, 1, 5, 9, 34, 50, 60, 50, 60, 4, 6, 8, 12)

mean(x[order(-x)][1:4])
[1] 55 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-15T17:46:15.067

只是为了表明您可以`quantile`在本练习中使用：

```
mean(quantile(x,1-(0:3)/length(x),type=1))
#[1] 55 
```

但是，其他答案显然更有效。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-15T16:32:57.413

要与众不同！另外，请在发布之前尝试自己做一些研究。

```
x <- c(12, 13, 15, 1, 5, 9, 34, 50, 60, 50, 60, 4, 6, 8, 12)    
mean(tail(sort(x), 4)) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-15T16:32:16.223

也许是这样的：

```
v <- c(12, 13, 15, 1, 5, 9, 34, 50, 60, 50, 60, 4, 6, 8, 12)
mean(head(sort(v,decreasing=T),4)) 
```

首先，您`sort`的向量使最大值位于开头。然后`head`取该向量中的 4 个第一个值，然后取其平均值。

# c - 一个理解C语言并集的小程序

> ID：16020228
> 
> 赞同：1
> 
> 时间：2013-04-15T16:29:24.923
> 
> 标签：c, gcc, floating-point, unions

```
typedef union{
    int a;  
    char b[10];
    float c;     
} Union;

int main()
{
    Union x,y={100};

    x.a=10;
    strcpy(x.b,"hello");
    x.c=21.50;

    printf("%d\t%s\t%f\n",x.a,x.b,x.c);
    printf("%d\t%s\t%f\n",y.a,y.b,y.c);
    return 0;
} 
```

我有这个程序，我可以在其中制作除“xa”和“yc”之外的所有输出。这两个输出都有些混乱。我确实知道与 int 相比，浮点数以不同的方式存储在内存中，但我仍然无法找出输出的可能原因。

任何帮助将不胜感激。

输出是

```
110792132                21.500000
100           d          0.000000 
```

# url-rewriting - 如何重定向所有请求，甚至将 index.php 重定向到另一个 php 文件（parse.php）

> ID：16020232
> 
> 赞同：0
> 
> 时间：2013-04-15T16:29:32.603
> 
> 标签：url-rewriting, nginx, php

现在我的 nginx 配置中有这个：

```
location / {
     rewrite ^(.*)$ /parse.php;
} 
```

然后再往下：

```
location ~\.php$ {
            root /var/www/site.com/public/;
            fastcgi_split_path_info ^(.+\.php)(/.+)$;

            include fastcgi_params;

            fastcgi_pass 127.0.0.1:9000;
    } 
```

如果我浏览到

> site.com/example/this

它按预期执行并转到 parse.php（$_SERVER['REQUEST_URI'] 正确设置为'/example/this'）。site.com/images/test.jpg 也是如此，它将按预期工作并将其传递给 parse.php 脚本。

但是，如果我访问“site.com/another.php”，它不会解析，而是说：

> 未指定输入文件。

知道如何让它工作吗？我删除了 try_files 子句，但仍然没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:33:51.037

好吧，如果有人想知道，这就是解决方案，只需将两个位置块合并在一起，然后添加中断；重写迫使一切都去 php 脚本。

由于某种原因，当两个块分开时，第一个位置（指定所有内容都应重写为 parse.php）被第二个位置（仅针对 php 文件）覆盖，并以某种方式将请求恢复为原始 php 文件而不是parse.php 根据重写。

```
location / {
    rewrite ^(.*)$ /parse.php break;

    root /var/www/site.com/public/;
    fastcgi_split_path_info ^(.+\.php)(/.+)$;

    include fastcgi_params;

    fastcgi_pass 127.0.0.1:9000;
} 
```

这将有效地解析给定 server{} 块对 parse.php 的每个请求。

现在您可以通过 $_SERVER['REQUEST_URI']; 确定原始请求。在您的 parse.php 脚本中，然后从那里做任何您想做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T02:11:31.120

实际上，您不需要重写规则，因为每个请求都发送到`parse.php`. 正则表达式很慢。你也可以试试这个：

```
location / {

    root /var/www/site.com/public;

    include fastcgi_params;
    fastcgi_param  SCRIPT_FILENAME  $document_root/parse.php;
    fastcgi_param  SCRIPT_NAME  parse.php;

    fastcgi_pass 127.0.0.1:9000;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-17T02:51:00.587

$uri 仅用于资产支持，图像和静态文件将直接提供，如果找到则不传递给 parse.php，否则将传递给 parse.php

```
location / {
    try_files $uri /parse.php$request_uri;
    include fastcgi_params;
    fastcgi_pass 127.0.0.1:9000;
} 
```

# jboss - jboss企业soa平台版本

> ID：16020234
> 
> 赞同：0
> 
> 时间：2013-04-15T16:29:40.017
> 
> 标签：jboss, soa, jboss-esb

JBoss 企业 SOA 平台有 2 个主要版本（4.xx 和 5.xx）。我从 redhat 网站 ( [https://access.redhat.com/site/articles/111773](https://access.redhat.com/site/articles/111773) ) 上的一篇文章中获得了这些信息。

我在 SOA 平台的下载页面上没有看到 4.2.0 之前的版本。

SOA 平台下载页面：access.redhat.com/jbossnetwork/restricted/listSoftware.html?product=soaplatform&downloadType=distributions

除此之外，我搜索了 redhat.com 上的新闻稿页面，它显示 4.2.0 作为第一个版本。 [http://www.redhat.com/about/news/press-archive/2008/2/jboss-soa](http://www.redhat.com/about/news/press-archive/2008/2/jboss-soa)

我想知道为什么JBoss Enterprise SOA Platform版本是从4.2.0开始的？

如果有4.2.0之前的版本，为什么不能从redhat.com下载页面下载？

# html - 子表和父表的边框相同

> ID：16020236
> 
> 赞同：0
> 
> 时间：2013-04-15T16:29:43.543
> 
> 标签：html, css

我有两个结构相似的表（主表和子表），它们有 3 列，子表位于主表行中。我想将这些表格显示为一个具有相同边框的表格，但对于不同的浏览器，子表格边框错位（例如 chrome），我该如何解决？

[http://jsfiddle.net/yCSnf/](http://jsfiddle.net/yCSnf/)

.html

```
<table class="main_table" cellpadding=0 cellspacing=0>
    <tr>
        <td>col1</td>
        <td>col2</td>
        <td>col3</td>
    </tr>
    <tr>
        <td>value1</td>
        <td>value2</td>
        <td>value3</td>
    </tr>
    <tr>
        <td colspan=3 class="child_table_wrap">
            <table cellpadding=0 cellspacing=0 class="child_table">
                <tr>
                    <td>child_col1</td>
                    <td>child_col2</td>
                    <td>child_col3</td>
                </tr>
                <tr>
                    <td>child_val1</td>
                    <td>child_val1</td>
                    <td>child_val1</td>
                </tr>
            </table>
        </td>
    </tr>
</table> 
```

.css

```
table {border-collapse: collapse;}
table.main_table {border: 1px solid black; border-width: 1px 0 0 1px;}
td {width: 33%; border: 1px solid black; border-width: 0 1px 1px 0;}
td.child_table_wrap {border-width: 0;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:36:35.837

更改这行 css：

```
td {width: 33%; border: 1px solid black; border-width: 0 1px 1px 0;} 
```

对此：

```
td {width: 33.334%; border: 1px solid black; border-width: 0 1px 1px 0;} 
```

**评论更新**

在这种情况下，添加一个固定宽度的容器：

```
.container {
    200px; //Or whatever.
} 
```

HTML

```
<div class="container">
    <table class="main_table" cellpadding=0 cellspacing=0>
    //...
    </table>
</div> 
```

[http://jsfiddle.net/vsDwC/1/](http://jsfiddle.net/vsDwC/1/)

# python - 如何在 Python 中控制模拟

> ID：16020242
> 
> 赞同：2
> 
> 时间：2013-04-15T16:29:58.273
> 
> 标签：python, multithreading, multiprocessing, simulation

我有一个关于 Python 和运行交互式模拟的相当高级别的问题。这是设置：

我正在将我最初在 Smalltalk (VW) 中编写的一些模拟软件移植到 Python。它是一种从图形界面交互控制的循环神经网络。除了控制模拟本身（启动、停止等）之外，该界面还允许实时操作大多数网络参数。在最初的 Smalltalk 实现中，我有两个进程以不同的优先级运行：

1.  具有更高优先级的接口本身
2.  神经网络以较低的优先级永远运行

两个进程之间的通信很简单，因为所有 Smalltalk 进程共享相同的地址空间（对象内存）。

我现在开始意识到在 Python 中复制类似的设置并不是那么简单。据我所知，线程模块不允许其线程共享地址空间。多处理模块可以，但方式相当复杂（使用队列等）。

所以我开始认为我的 Smalltalk 观点让我误入歧途，我完全从错误的角度处理了一个相对简单的问题。问题是，我不知道什么是正确的角度！你会建议我如何解决这个问题？我对 Python 相当陌生（显然）并且非常愿意学习。但我非常感谢有关如何构建问题以及我应该深入研究哪些多处理模块（如果有的话！）的建议。

谢谢，

斯特凡诺

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T15:49:14.013

我将就如何解决这个问题提出我的看法。在`multiprocessing`模块中`Pipe`，`Queue`IPC 机制确实是最好的方法；尽管您提到了增加的复杂性，但值得学习它们的工作原理。这`Pipe`是相当简单的，所以我将用它来说明。

这是代码，然后是一些解释：

```
import sys
import os
import random
import time
import multiprocessing

class computing_task(multiprocessing.Process):
    def __init__(self, name, pipe):
        # call this before anything else
        multiprocessing.Process.__init__(self)

        # then any other initialization
        self.name = name
        self.ipcPipe = pipe
        self.number1 = 0.0
        self.number2 = 0.0
        sys.stdout.write('[%s] created: %f\n' % (self.name, self.number1))

    # Do some kind of computation
    def someComputation(self):
        try:
            count = 0
            while True:
                count += 1
                self.number1 = (random.uniform(0.0, 10.0)) * self.number2
                sys.stdout.write('[%s]\t%d \t%g \t%g\n' % (self.name, count, self.number1, self.number2))

                # Send result via pipe to parent process.
                # Can send lists, whatever - anything picklable.
                self.ipcPipe.send([self.name, self.number1])

                # Get new data from parent process
                newData = self.ipcPipe.recv()
                self.number2 = newData[0]

                time.sleep(0.5)
        except KeyboardInterrupt:
            return

    def run(self):
        sys.stdout.write('[%s] started ...  process id: %s\n' 
                         % (self.name, os.getpid()))        
        self.someComputation()

        # When done, send final update to parent process and close pipe.
        self.ipcPipe.send([self.name, self.number1])
        self.ipcPipe.close()
        sys.stdout.write('[%s] task completed: %f\n' % (self.name, self.number1))

def main():
    # Create pipe
    parent_conn, child_conn = multiprocessing.Pipe()

    # Instantiate an object which contains the computation
    # (give "child process pipe" to the object so it can phone home :) )
    computeTask = computing_task('foo', child_conn)

    # Start process
    computeTask.start()

    # Continually send and receive updates to/from the child process
    try:
        while True:
            # receive data from child process
            result = parent_conn.recv()
            print "recv: ", result

            # send new data to child process
            parent_conn.send([random.uniform(0.0, 1.0)])
    except KeyboardInterrupt:
        computeTask.join()
        parent_conn.close()
        print "joined, exiting"

if (__name__ == "__main__"):
    main() 
```

我已经将要完成的计算封装在一个派生自`Process`. 在大多数情况下，这并不是绝对必要的，但可以使代码更易于理解和扩展。在主进程中，您可以使用`start()`此类实例上的方法启动计算任务（这将启动一个单独的进程来运行对象的内容）。

如您所见，我们`Pipe`在父进程中使用创建两个连接器（管道的“末端”）并将一个给子进程，而父进程持有另一个。这些连接器中的每一个都是持有端的进程之间的双向通信机制，`send()`以及`recv()`用于执行其名称所暗示的方法。在本例中，我使用管道来传输数字和文本列表，但通常您可以发送列表、元组、对象或任何可腌制的东西（即可以使用 Python 的腌制工具进行序列化）。因此，您对在进程之间来回发送的内容有一定的自由度。

所以你设置你的连接器，调用`start()`你的新进程，然后你就可以开始计算了。在这里，我们只是将两个数字相乘，但您可以看到它是在子流程中“交互地”完成的，并从父流程发送了更新。同样，父进程也会定期收到来自计算进程的新结果的通知。

请注意，连接器的`recv()`方法是阻塞的，即如果另一端还没有发送任何东西，`recv()`将等待直到有东西可以读取，并在此期间阻止其他任何事情发生。所以请注意这一点。

希望这可以帮助。同样，这是一个准系统示例，在现实生活中，您将希望进行更多错误处理，可能用于`poll()`连接对象等等，但希望这能传达主要想法并帮助您入门。

# perl - 如果一列中的重复值而不是将另一列中的值复制到上面的一行

> ID：16020243
> 
> 赞同：0
> 
> 时间：2013-04-15T16:30:05.653
> 
> 标签：perl

我正在使用一个看起来像这样的表

```
C1    C2    C3
1     a     b
2     c     d
4     e     g
4     f     h
5     x     y
...   ...   ... 
```

如果 C1 中的值相同（在本例中是 4 的两倍），则我希望将 C2 和 C3 的值粘贴到 C1 中的 4 的第一行，然后我想删除第二行的 4在 C1 中。所以最后它应该看起来像这样

```
C1    C2    C3
1     a     b
2     c     d
4     e,f   g,h
5     x     y 
```

我正在使用 perl 脚本。我正在使用while循环文件。我在其他脚本中使用过我的 %seen 或 count 之类的东西，但我不知道如何使用它们。做起来真的很简单...

这就是我的while循环目前的样子

```
 while (<$DATA>) {
    @columns = split
    $var1 = $columns[0]
    $var2 = $columns[1]
    $var3 = $columns[2];         
     } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:47:04.907

使用哈希来控制重复项。在我的示例中，我使用了散列 ( `%info`) 的散列，键为 C1 和 C2。它们中的每一个都包含一个数组引用以添加重复项。

```
use strict;
use warnings;

my %info = ();
while (<DATA>) {
    my @columns = split /\s+/;
    if( exists $info{ $columns[0] } ) {
        push @{ $info{ $columns[0] }->{C2} }, $columns[1];
        push @{ $info{ $columns[0] }->{C3} }, $columns[2];
    }
    else {
        $info{ $columns[0] } = { C2 =>[ $columns[1] ], C3 => [ $columns[2]] }
    }        
}  

foreach my $c1(sort {$a<=>$b} keys %info ) {
    print $c1, "\t", 
          join(',',@{$info{$c1}->{C2}}), "\t", 
          join(',',@{$info{$c1}->{C3}}), "\n";
} 

__DATA__
1     a     b
2     c     d
4     e     g
4     f     h
5     x     y 
```

# knockout.js - 淘汰赛：点击时绑定到值

> ID：16020244
> 
> 赞同：0
> 
> 时间：2013-04-15T16:30:11.123
> 
> 标签：knockout.js

我似乎很难通过点击绑定到一个对象，我不知道为什么。我的 HTML 片段如下：

```
 <div class="moodControlGroup">
        <label class="control-label" for="nodeHeight">Height</label>
           <div class="controls">
              <input type="text" class="query" id="nodeHeight" data-bind="value: settings.nodes.height.value" />
              <textarea class="queryExpanded funcText" data-bind="value: settings.nodes.height.funcValue"></textarea>
           </div>
           <input class="fx btn btn-primary" type="submit" value="fx" data-bind="click: function(item) { alert(JSON.stringify(item)) ; }, css: { selected: settings.nodes.height.isFunc }" />
     </div> 
```

我的问题在于底部的提交按钮。设置具有以下 JSON 结构 - 使用 ko.mapping 将其转换为淘汰对象：

```
nodes: {
                width: { isFunc: false, value: 24, funcValue: "" },
                height: { isFunc: true, value: 24, funcValue: "function(d) { return d.dy; }" }, 
}... 
```

我想要做的是单击提交按钮，并获取高度对象：

```
height: { isFunc: true, value: 24, funcValue: "function(d) { return d.dy; }" } 
```

然而，似乎我只得到空对象 {}，或者包含节点属性的稍高的对象。我如何设法定位我的点击事件以获取正确的值？最终，我希望能够切换它背后的 isFunc 值的状态，以更新一些 CSS ......但我不希望使用复选框控件。

谁能建议我可能做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:39:00.070

如果您想在点击处理程序中利用“this”值，则需要为 KO 创建一个上下文。由于您没有迭代集合（foreach），因此请尝试使用“with”绑定，例如在外部 div 中，或者如果您只想快速尝试，请在提交按钮周围放置一个包装 div 并数据绑定与那。

像这样的东西：

```
<div data-bind="with: settings.nodes.height">
    <input class="fx btn btn-primary" type="submit" value="fx" data-bind="click: function(item) { alert(JSON.stringify(item)) ; }, css: { selected: isFunc }" />
</div> 
```

我不确定你的最终代码会是什么样子，但如果你在这个块中要做的只是绑定到 settings.nodes.height，那么你很可能会想要放置 'with: 设置。最外层div上的nodes.height'。然后，您可以将所有后代绑定减少到仅高度对象内的属性。像这样：

```
<div class="moodControlGroup" data-bind="with: settings.nodes.height">
        <label class="control-label" for="nodeHeight">Height</label>
           <div class="controls">
              <input type="text" class="query" id="nodeHeight" data-bind="value: value" />
              <textarea class="queryExpanded funcText" data-bind="value: funcValue"></textarea>
           </div>
           <input class="fx btn btn-primary" type="submit" value="fx" data-bind="click: function(item) { alert(JSON.stringify(item)) ; }, css: { selected: isFunc }" />
     </div> 
```

更新：经过我们在评论中的简短讨论后，我决定将您的代码粘贴到 jsFiddle 中。

[这个小提琴](http://jsfiddle.net/LatencyMachine/REcMe/#base)在外部 div 上没有使用“with”绑定，因此根 ViewModel 是点击处理程序的“this”所绑定的（这听起来像是你不想要的）。我添加了一个“fx2”按钮，它将使用 ko.mapping.toJSON 转储“this”。正如评论中所讨论的， JSON.stringify 不会显示您的可观察属性，这些属性此时实际上是函数。

[另一个小提琴](http://jsfiddle.net/LatencyMachine/NHwqL/)在外部 div 上引入了 data-bind="with: settings.nodes.height" 。因此，单击处理程序的“this”现在指的是 settings.nodes.height 对象，我相信这就是您想要的。

# solaris - solaris 上的 prstat - 当大小超过限制时，你可以让它闪烁吗？

> ID：16020245
> 
> 赞同：1
> 
> 时间：2013-04-15T16:30:16.550
> 
> 标签：solaris

有人告诉我，当尺寸类别中的任何值超过阈值时，让 prstat 将背景从白色闪烁几次。有没有办法编辑命令并将其放在这里或者这永远不会发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:12:54.423

我并不是要刻薄，但是提出这个要求的人是不合理或不理解的。我猜“提问者”对prstat一无所知。看看这两个例子：

```
example% prstat -u root -n 5 -P 1,2 1 1

PID   USERNAME  SWAP   RSS STATE  PRI  NICE      TIME  CPU PROCESS/LWP
 306   root     3024K 1448K sleep   58    0   0:00.00 0.3% sendmail/1
 102   root     1600K  592K sleep   59    0   0:00.00 0.1% in.rdisc/1
 250   root     1000K  552K sleep   58    0   0:00.00 0.0% utmpd/1
 288   root     1720K 1032K sleep   58    0   0:00.00 0.0% sac/1
   1   root      744K  168K sleep   58    0   0:00.00 0.0% init/1
TOTAL:       25, load averages:  0.05, 0.08, 0.12

example% prstat -S rss -n 5 -vc -u root,john

 PID USERNAME USR SYS TRP TFL DFL LCK SLP LAT VCX ICX SCL SIG PROCESS/LWP
   1 root     0.0 0.0  -   -   -   -  100  -    0   0   0   0 init/1
 102 root     0.0 0.0  -   -   -   -  100  -    0   0   3   0 in.rdisc/1
 250 root     0.0 0.0  -   -   -   -  100  -    0   0   0   0 utmpd/1
1185 john    0.0 0.0  -   -   -   -  100  -    0   0   0   0 csh/1
 240 root     0.0 0.0  -   -   -   -  100  -    0   0   0   0 powerd/4
 TOTAL:       71, load averages:  0.02, 0.04, 0.08 
```

那么，您要寻找什么价值？prstat 显示了很多东西，因此您必须学习所有这些内容，然后为许多可能的输出中的每一个进行编码。

去做这个：

您需要做的是在子进程中使用在命令行中输入的参数运行 prstat，读取并解释它生成的所有内容，然后将其映射到输出并根据需要闪烁屏幕。您可以使用 ksh 或 zsh 中的协同进程或在 bash 中使用 fifos 来完成此操作。无论用户输入什么，都考虑在 -e 模式下运行 prtstat，这样您就可以全屏阅读和操作。

可以使用转义序列来闪烁屏幕，例如更改背景颜色或任何您想要的。这是基于 Windows 的终端的起点：

[ANSI 转义序列](http://en.wikipedia.org/wiki/ANSI_escape_code)

对于 Vt100 (UNIX)

[终端转义码](http://www.termsys.demon.co.uk/vtansi.htm)

# android - 如何在使用安卓相机拍照后自动将图像保存到特定文件夹或根据需要创建新文件夹

> ID：16020247
> 
> 赞同：0
> 
> 时间：2013-04-15T16:30:39.427
> 
> 标签：android, file, file-io, directory, android-camera

我目前正在尝试创建一个应用程序，当使用相机拍照时，保存图像时，它会保存到特定的文件夹位置，如果手机上当前不存在该文件夹，它会创建文件夹并保存文件到那个位置。尽管我已经尝试过，但我的代码目前不起作用。你能否看看我的代码并告诉我我需要做什么。

这是代码：

```
else if(v==camera){
        Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);

        File newDirectory = new File(Environment.getExternalStorageDirectory() + "App_Pictures/");
        String filename = new String("image1.jpeg");
        File outputFile = new File(newDirectory, filename);
        outputFile.mkdirs();

        startActivity(intent);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:44:59.960

您似乎正在尝试让外部应用程序为您拍照。如果是这种情况，您需要使用`startActivityForResult`，而不是`startActivity`，因为您想接收生成的照片。然后您将在`onActivityResult`您的活动方法中收到结果。[此处](https://stackoverflow.com/a/10407371/1663009)详细描述了此过程。

如果您确实希望自己的应用程序而不是外部应用程序来拍照，则需要使用完全不同的方法。[这是一个应用程序](https://github.com/oakes/BabaRam)，它在启动时立即开始录制视频，并将其保存到 SD 卡上的目录中，因此如果您想这样做，这可能是一个有用的起点。

# ruby-on-rails - 如何在 has_scope 中使用作为可标记的行为？

> ID：16020250
> 
> 赞同：2
> 
> 时间：2013-04-15T16:30:52.043
> 
> 标签：ruby-on-rails, acts-as-taggable-on, has-scope

我正在构建一个返回帖子列表的 API（localhost:3000/api/v1/posts）：

```
{
  "tags": [
    {
      "id": 1,
      "name": "Tag 1"
    },
    {
      "id": 2,
      "name": "Tag 2"
    },
    …
  ],
  "posts": [
    {
      "id": 1,
      "title": "Post 1",
      "body": "Lorem ipsum dolor sit amet.",
      "tag_ids": [
        1
      ]
    },
    {
      "id": 2,
      "title": "Post 2",
      "body": "Lorem ipsum dolor sit amet.",
      "tag_ids": [
        2
      ]
    },
    …
  ]
} 
```

这些帖子使用**acts-as-taggable-on** gem 进行标记。我希望能够使用**has_scope** gem (localhost:3000/api/v1/posts?tag_id=1) 根据这些标签过滤它们：

```
{
  "tags": [
    {
      "id": 1,
      "name": "Tag 1"
    }
  ],
  "posts": [
    {
      "id": 1,
      "title": "Post 1",
      "body": "Lorem ipsum dolor sit amet.",
      "tag_ids": [
        1
      ]
    }
  ]
} 
```

但我不知道如何`by_tag_id`在我的模型中设置范围，因为acts-as-taggable-on 文档仅解释了[如何](https://github.com/mbleigh/acts-as-taggable-on#finding-tagged-objects)根据标签名称查找对象（使用`tagged_with()`方法）。

预先感谢您的帮助！;-)

大卫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T14:23:41.460

对于那些感兴趣的人，我解决了这样的问题……这是我的 Post 模型：

```
class Post < ActiveRecord::Base
  attr_accessible :title, :body, :tag_list

  # Alias for acts_as_taggable_on :tags
  acts_as_taggable

  # Named scope which returns posts whose tags have a specific ID
  scope :tagged_with_id, lambda { |tag_id| joins(:taggings).where(:taggings => {:tag_id => tag_id}) }
end 
```

还有我的帖子控制器：

```
class PostsController < ApplicationController
  has_scope :tagged_with_id

  def index
    @posts = apply_scopes(Post).all

    render :json => @posts
  end
end 
```

# javascript - GAS 按日期排序多维数组

> ID：16020254
> 
> 赞同：1
> 
> 时间：2013-04-15T16:31:19.273
> 
> 标签：javascript, google-apps-script

我的脚本有时有效，有时会出错。运行调试表明我的 array.sort 可能是问题所在。这是错误：

> 很抱歉，发生服务器错误。请稍等，然后重试。

如果这是问题所在，我不确定为什么它有时会起作用，而其他情况则不起作用。

```
allData.sort(function(a,b){
  a = new Date(a[7]);
  b = new Date(b[7]);
  return a>b?-1:a<b?1:0;
}); 
```

这有什么问题吗？我数组的第 7 个位置包含日期，我想按此排序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T19:50:32.543

我相信你需要隔离你的三元运算符。

```
return a>b?-1:(a<b?1:0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:39:32.163

出于某种原因，GAS 似乎更喜欢这个：

```
allData.sort(function(a,b){return((a[7]<b[7])?-1:((a[7]>b[7])?1:0))}); 
    Logger.log(allData)
allData.reverse() 
```

现在它起作用了。不知道为什么，但这就是解决方案。

# .htaccess - 使用 .htaccess 在主页上强制 http

> ID：16020261
> 
> 赞同：0
> 
> 时间：2013-04-15T16:31:37.587
> 
> 标签：.htaccess, mod-rewrite

我正在使用 .htaccess 在某些页面上强制 https 和在其他页面上强制 http 并且它工作正常。但我需要在主页上强制 http `(example: http://website.com)`，我不知道该怎么做。我试过`RewriteCond %{REQUEST_URI} ^/index.php/?`了，但是因为我使用的 drupal 没有用。

这是我正在使用的脚本：

```
RewriteEngine on
RewriteCond %{SERVER_PORT} 80 
RewriteCond %{REQUEST_URI} ^/register/? [OR]
RewriteCond %{REQUEST_URI} ^/admin/?
RewriteRule ^(.*)$ https://website.com/$1 [R,L]

RewriteCond %{SERVER_PORT} 443
RewriteCond %{REQUEST_URI} ^/about-us/? [OR]
RewriteCond %{REQUEST_URI} ^/help/?
RewriteRule ^(.*)$ http://website.com/$1 [R,L] 
```

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T21:47:23.280

`RewriteCond %{SERVER_PORT}`首先，您可以使用代替[`RewriteCond %{HTTPS}`](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritecond)，它在检测 HTTPS 时应该更可靠。

主页有`RewriteRule`图案`^$`。所以规则是

```
RewriteCond %{HTTPS} =on
RewriteRule ^$ http://website.com [R,L] 
```

当一切按预期工作时，您可以更改`R`为`R=301`.

# wso2 - 无法在 wso2 治理注册表中添加具有 wsdl url、名称和命名空间的服务

> ID：16020264
> 
> 赞同：0
> 
> 时间：2013-04-15T16:31:49.130
> 
> 标签：wso2, wso2greg

我正在尝试在 wso2 治理注册表 4.5.3 中添加服务。当我进入 index.jsp 并尝试通过单击指向 add_edit.jsp 的添加服务并尝试提供名称、命名空间和 WSDL URL 并尝试保存来添加服务时，它给了我“无法添加工件，特殊字符不允许出现在名称字段中”。我能知道发生了什么以及我需要做什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:24:15.933

我已经添加了与您的详细信息完全相同的服务。（JDK 1.7 和 Windows 7 和 Chrome 浏览器），你能看到注册表中是否存在相同的服务。当我在注册表中有相同的服务并尝试使用相同的名称再次添加时，我可以重现它。显示的错误消息具有误导性，它将在未来的版本中修复。

![在此处输入图像描述](https://i.stack.imgur.com/WGE9L.png)

![在此处输入图像描述](https://i.stack.imgur.com/9v9l4.png)

# java - JAXB：将标记作为字符串获取

> ID：16020268
> 
> 赞同：3
> 
> 时间：2013-04-15T16:31:55.903
> 
> 标签：java, xml, jaxb

这个问题之前可能已经在 Internet 的某个黑暗的隐蔽处得到了回答，但我什至无法弄清楚如何形成一个有意义的谷歌查询来搜索它。

所以：假设我有一个（简化的）XML 文档，如下所示：

```
<root>
  <tag1>Value</tag1>
  <tag2>Word</tag2>
  <tag3>
    <something1>Foo</something1>
    <something2>Bar</something2>
    <something3>Baz</something3>
  </tag3>
</root> 
```

我知道如何在标准用例中使用 JAXB 将其解组为 Java 对象。

我不知道该怎么做是将 unmarshal`tag3`的内容批发成一个字符串。我的意思是：

```
<something1>Foo</something1>
<something2>Bar</something2>
<something3>Baz</something3> 
```

作为字符串，标签和所有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T06:20:21.957

使用注释@XmlAnyElement。我一直在寻找相同的解决方案，我希望找到一些注释来阻止解析 dom 并保持原样，但没有找到。

详情在： [使用 JAXB 提取 XML 元素的内部文本](https://stackoverflow.com/questions/5537416/using-jaxb-to-extract-inner-text-of-xml-element/5537787#5537787) 和 [http://blog.bdoughan.com/2011/04/xmlanyelement-and-non-dom-properties.html](http://blog.bdoughan.com/2011/04/xmlanyelement-and-non-dom-properties.html) 我在方法 getElement() 中添加了一个检查，否则我们可能会得到 IndexOutOfBoundsException

```
if (xml.indexOf(START_TAG) < 0) {
    return "";
} 
```

对我来说，这个解决方案的行为很奇怪。为您的 xml 的每个标签调用方法 getElement()。第一个调用是针对“Value”，第二个调用是针对“ValueWord”等。它为上一个附加了下一个标签

**更新：** 我注意到这种方法仅适用于我们要解析为字符串的标记的一次出现。无法正确解析以下示例：

```
<root>
<parent1>
    <tag1>Value</tag1>
    <tag2>Word</tag2>
    <tag3>
        <something1>Foo</something1>
        <something2>Bar</something2>
        <something3>Baz</something3>
    </tag3>
</parent1>
<parent2>
    <tag1>Value</tag1>
    <tag2>Word</tag2>
    <tag3>
        <something1>TheSecondFoo</something1>
        <something2>TheSecondBar</something2>
        <something3>TheSecondBaz</something3>
    </tag3>
</parent2> 
```

带有父标签“parent2”的“tag3”将包含来自第一个标签（Foo，Bar，Baz）而不是（TheSecondFoo，TheSecondBar，TheSecondBaz）的参数。任何建议表示赞赏。谢谢。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-15T16:37:54.727

在这种情况下，我有一个实用方法可能会派上用场。看看有没有帮助。我用你的例子做了一个示例代码：

```
public static void main(String[] args){
    String text= "<root><tag1>Value</tag1><tag2>Word</tag2><tag3><something1>Foo</something1><something2>Bar</something2><something3>Baz</something3></tag3></root>";
    System.out.println(extractTag(text, "<tag3>"));

}

public static String extractTag(String xml, String tag) {
    String value = "";
    String endTag = "</" + tag.substring(1);

    Pattern p = Pattern.compile(tag + "(.*?)" + endTag);
    Matcher m = p.matcher(xml);

    if (m.find()) {
        value = m.group(1);
    }

    return value;
} 
```

# php - Facebook setExtendedAccessToken() 和 FB.Event.subscribe('auth.login') 无限循环

> ID：16020269
> 
> 赞同：0
> 
> 时间：2013-04-15T16:31:56.067
> 
> 标签：php, javascript, facebook

我目前正在开发我的第一个 facebook 应用程序。我在将 setExtendedAccessToken() 函数与 FB.Event.subscribe('auth.login') 结合使用时遇到问题。

我的 js 代码如下所示：

```
window.fbAsyncInit = function() {

    // init the FB JS SDK
    FB.init({
      appId      : 'XXX', // App ID from the App Dashboard
      channelUrl : 'http://domain.tld/app/channel.php', // Channel File for x-domain communication
      frictionlessRequests: true,
      cookie: true, 
      xfbml: true
    });

    FB.Event.subscribe('auth.login', function(response) {
        $('#loginSpinner').show();
        $('#loginFacebook').hide();
        window.location = "http://domain.tld/app/?first_login";
    });      

}; 
```

该`auth.login`事件应仅在用户首次登录时触发。这个 PHP 代码也应该只在第一次登录时触发：

```
// triggers on first login
if (isset($_GET['first_login'])) {
    if ($me) {
        $facebook->setExtendedAccessToken();
        $friends = $facebook->api('/me/friends');
        $friends = $friends['data'];
        if (!empty($friends)) {
        //sql
        }
        $permissions = $facebook->api("/me/permissions");

        if( array_key_exists('publish_actions', $permissions['data'][0]) ) {
            $attachment = array(
                    'message' => 'XXX',
                    'name' => 'XXX - App',
                    'link' => 'http://domain.tld/app/',
                    'description' => 'XXX',
                    'picture'=> 'http://domain.tld/app/img.jpg',
                    'access_token' =>  $facebook->getAccessToken()
            );
            $facebook->api('/me/feed', 'POST', $attachment);

            //sql
        }
    }
    header('Location: http://domain.tld/app/');
    exit;
} 
```

问题是一个无限循环，它总是会调用`auth.login`，因为`setExtendedAccessToken()`会破坏当前会话，facebook 会自动将用户登录到我的应用程序。

有没有办法`auth.login`只触发一次？当我设置`setExtendedAccessToken()`为评论时

```
// $facebook->setExtendedAccessToken(); 
```

我的网站只按原样重定向用户一次。但我需要为我的应用程序扩展登录。

我之前的问题：[我的 WebApp（使用 facebook 登录）让我退出](https://stackoverflow.com/questions/15839713/my-webapp-using-facebook-login-logs-me-out)

# c# - 底层提供者在 EnlistTransaction 上失败；无法访问已处置的对象

> ID：16020270
> 
> 赞同：1
> 
> 时间：2013-04-15T16:32:03.460
> 
> 标签：c#, .net, vb.net, transactions, transactionscope

请参阅以下异常和堆栈跟踪，这似乎表明我正在尝试加入已处置的[事务](http://msdn.microsoft.com/en-us/library/a90c30fy.aspx)：

> System.Data.EntityException：基础提供程序在 EnlistTransaction 上失败。---> System.ObjectDisposedException：无法访问已处置的对象。对象名称：“交易”。在 System.Transactions.Transaction.get_TransactionInformation() 在 Oracle.DataAccess.Client.OracleConnection.EnlistTransaction(Transaction transaction) 在 System.Data.EntityClient.EntityConnection.EnlistTransaction(Transaction transaction) --- 内部异常堆栈跟踪结束---在 System.Data.EntityClient.EntityConnection.EnlistTransaction(Transaction transaction) 在 System.Data.Objects.ObjectContext.EnsureConnection() 在 System.Data.Objects.ObjectContext.ExecuteStoreCommand(String commandText, Object[] 参数) 在 Reconciliation.Models。 BillLines.BillLines.Reconciliation.Interfaces.IBillLineEntities。**清除旧组异常**()

的主体`ClearOldGroupExceptions()`完全封装在 a中*，*`TransactionScope`其选项设置为`TransactionScopeOption.Required`。

根据[文档](http://msdn.microsoft.com/en-gb/library/system.transactions.transactionscopeoption.aspx)，这应该意味着：

> 范围需要事务。如果环境事务已经存在，它会使用环境事务。否则，它会在进入范围之前创建一个**新事务。**这是默认值。

因此，我很难理解为什么由于当前事务已被处理，为什么在进入范围之前没有创建新事务。

有任何想法吗？

# c++ - 用于 RSA 数字签名验证的轻量级跨平台 C++ 库

> ID：16020273
> 
> 赞同：4
> 
> 时间：2013-04-15T16:32:14.833
> 
> 标签：c++, cryptography, windows-runtime

您能否建议任何用于验证 RSA 数字签名的轻量级跨平台 C++ 库？我想在**WinRT**、**Android**和**iOS**上使用相同的代码库。

我看过**CryptoC++**、**Botan**和**OpenSSL**，但它们似乎相当重量级，而且很难构建。

**LibTomCrypt**似乎比其他的要简单一些，但是我还不能让它在 Visual Studio 项目中编译。

有没有人设法让 LibTomCrypt 在 WinRT 上工作？还有其他轻量级库可以使用吗？

# syntax - Clojure：[_] 在函数参数列表中做了什么？

> ID：16020278
> 
> 赞同：18
> 
> 时间：2013-04-15T16:32:24.763
> 
> 标签：syntax, vector, clojure, arguments

我正在享受 clojure 的乐趣，并且想知道 _ 语法在函数参数向量中的作用。

例子：

```
(def available-processors
    (.availableProcessors (Runtime/getRuntime)))

(prn "available processors: " available-processors)

(def pool
    (Executors/newFixedThreadPool (+ 2 available-processors)))

(defn dothreads!
    [func & {thread-count :threads exec-count :times :or {thread-count 1 exec-count 1}}]
    (dotimes [t thread-count]
        (.submit pool #(dotimes [_ exec-count] (func))))) 
```

表格中的下划线是做什么的：

```
#(dotimes [_ exec-count] (func)) 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-15T17:09:21.703

我相信按照惯例，下划线在 Clojure 中用作必需但未使用的参数的占位符。正如[基思·班纳特](http://krbtech.wordpress.com/2009/03/16/same-temperature-converter-different-language-clojure/)所说：

> 在 Clojure 中，下划线习惯性地用于指示它所标识的参数随后不会使用。

您的示例与此“用法”一致，因为`dotimes`不需要作为索引器的第一个参数，但表单需要绑定。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-15T16:35:24.177

它没有什么特别之处，它只是命名你不关心的东西的约定，但它仍然是一个名称，可以像普通名称一样使用。

```
(defn hello [_] (+ 1 _))
(hello 10) 
```

**更新**

这样做：

```
(defn hello [a a]  (+ a a)) 
```

不会产生错误，因此您可以使用任意数量的 _ ;)。

注意：Scheme 或 CL 的情况并非如此......嗯，那么在 clojure 中它背后的原因是什么？？？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-10T18:32:49.490

以前的答案很好，但是由于我需要一些额外的说明，所以这是我的答案。

```
(defn blah[_] (str "the value you sent is " _) 
```

等同于

```
(defn blah[my-arg] (str "the value you sent is " my-arg) 
```

没有区别。_ 只是让查看代码的人知道该参数不打算使用的一种方式。

因此，例如，这在编程上很好：

```
(dotimes [_ 5] (println (str "I'm going to print this 5 times, and this is index # " _))) 
```

但是查看代码的人会认为您不打算使用 _。因此，为了清楚起见，最好使用“n”或“ind”或其他任何东西，而不是_。如果您不使用该值，如下所示...

```
(dotimes [_ 5] (println "I'm going to print this 5 times")) 
```

然后它将您的参数绑定到_，因为您表明您没有使用它。

最后一件事，如果绑定具有相同的名称，则最后一个获胜。所以下面会打印“4last4last4last4last”。

```
(defn will-print [_ a _ a _ a _ a] (println (str _ a _ a _ a _ a)))
(will-print 1 "a" 2 "b" 3 "c" 4 "last") 
```

所以在 println 块中，'_' 绑定到 4，'a' 绑定到 'last'。所有先前发送的值都被忽略/覆盖。

# c# - 如何在 Linq 查询中使用 .FindControl ？

> ID：16020279
> 
> 赞同：-3
> 
> 时间：2013-04-15T16:32:25.763
> 
> 标签：c#, linq, linq-to-sql

我刚开始使用 Linq to sql。我正在努力将控制变量传递到删除语句中。有人可以看看这个并指出我正确的方向吗？

```
 protected void Delete_Click(object sender, EventArgs e)
{
    NorthwindDataContext db = new NorthwindDataContext();

    foreach (GridViewRow row in GridView1.Rows)
    {
        if (((CheckBox)row.FindControl("CheckBox1")).Checked)
        {
           string prod_id = row.FindControl("lbl_id").ToString();

           Product product = (from p in db.Products 
                                  where p.ProductID == int.Parse(prod_id) // <-- I get conversion errors here!!
                                  select p).Single(); 

           db.Products.DeleteOnSubmit(product);

           db.SubmitChanges();

        }
    }

    ShowProducts();        
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:36:36.867

你的问题在那里：

```
string prod_id = row.FindControl("lbl_id").ToString(); 
```

在控件上调用 ToString() 方法将返回控件类型名称，而不是控件值。您必须将此控件转换为任何类型，然后获取其中的值。假设它是一个文本框：

```
string prod_id = ((TextBox)row.FindControl("lbl_id")).Text; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:39:03.500

这一行——

```
string prod_id = row.FindControl("lbl_id").ToString(); 
```

将控件对象类型作为字符串返回。您可能应该将 return`Control`转换为您想要的控件类型，例如：

```
string prod_id = ((TextBox)row.FindControl("lbl_id")).Text; 
```

正如其他人所说，问题不在于 Linq，而在于您对该`FindControl`方法的处理。

所以你可以进一步了解发生了什么 - 假设我们使用`TextBox`上面的控件......

```
 Product product = (from p in db.Products 
                      where p.ProductID == int.Parse(prod_id) // <-- I get conversion errors here!!
                      select p).Single(); 
```

根据当前使用情况，`FindControl("lbl_id").ToString()`返回

> “System.Windows.Forms.TextBox”

显然，这将失败`int.Parse(prod_id)`。

通过更改代码以正确地将控件转换为预期的 TextBox，然后检索 Text 属性 - 例如“1”，您现在可以将字符串“1”解析为正确的整数值。

这带来了验证您的输入的必要性。至少，您应该实施，[`int.TryParse`](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)因为您可能依赖于用户对文本框的输入。

# python - excel文件的问题。XLRDError：不支持的格式，或损坏的文件：这是什么类型的文件？

> ID：16020280
> 
> 赞同：1
> 
> 时间：2013-04-15T16:32:28.713
> 
> 标签：python, macos, excel, python-2.7, xlrd

我有一些适用于 xls 文件的代码。它适用于我扔给它的所有东西，除了这个文件，我不知道如何正确识别这个文件是什么。我从使用 Selenium 导航的网站上获取文件。此特定电子表格始终作为导致此错误的文件类型下载。

完整的错误是：

```
Traceback (most recent call last):
  File "/Users/Meir/Documents/PYTHON/IFG User Update/code/ifg_TPA_update_excel.py", line 44, in <module>
    rb = open_workbook((os.path.expanduser("~/Documents/PYTHON/Selenium test/TPA_Example.xls")),formatting_info=True)
  File "/usr/local/lib/python2.7/site-packages/xlrd/__init__.py", line 443, in open_workbook
    ragged_rows=ragged_rows,
  File "/usr/local/lib/python2.7/site-packages/xlrd/book.py", line 94, in open_workbook_xls
    biff_version = bk.getbof(XL_WORKBOOK_GLOBALS)
  File "/usr/local/lib/python2.7/site-packages/xlrd/book.py", line 1262, in getbof
    bof_error('Expected BOF record; found %r' % self.mem[savpos:savpos+8])
  File "/usr/local/lib/python2.7/site-packages/xlrd/book.py", line 1256, in bof_error
    raise XLRDError('Unsupported format, or corrupt file: ' + msg)
XLRDError: Unsupported format, or corrupt file: Expected BOF record; found '\xff\xfe<\x00S\x00T\x00' 
```

我试图打开的文件在我的 finder 中显示为 xls 文件。但是，当我打开它时，它不会以文件名作为标题打开，而是显示“Workbook1”。当我点击保存时，它会打开保存菜单，就像我点击了另存为一样，默认为“Workbook1.xlsx”。我尝试更改我的代码以将其作为 xlsx 文件打开，但随后错误提示找不到该文件。每当我尝试用谷歌搜索它时，我都不知道如何表达它以获得相关答案。

当我联系网站支持团队询问 TPA 批量操作表是哪种文件时，他们回答说：

> TPA 批量操作是比其他批量操作更旧的版本，它将于今年晚些时候重建。下载文件时，最好的办法是另存为并将其另存为旧版本的 .xls，我通常选择 Microsoft Excel 5.0/95 工作簿，并将其格式化为文本。以这种方式格式化，它应该可以毫无问题地上传。

关于如何从 Python 中打开它的任何想法？

目前，我将每个部分构建为单独的代码，一旦整理好，我将把它们组合在一起。以下是将打开文件并遇到错误的代码部分。

我的代码：

```
#!/usr/bin/env python
## Import OS and Modules
import os
import csv
import xlrd
import xlwt
import xlutils
import csv
import collections

## Define Input File from IFG
ifg_user_file = "New_PCs_to_set_up_in_marketing_database_-_4-11-2013.csv"

## Import data
data = [row for row in csv.reader(open (os.path.expanduser("~/Downloads/" + ifg_user_file),'U'))]

## Find number of rows
row_count = sum(1 for row in data)
print row_count
## Set to turn off when reaching the end of data
end_of_data = False

from xlutils.copy import copy # http://pypi.python.org/pypi/xlutils
from xlrd import open_workbook # http://pypi.python.org/pypi/xlrd
from xlwt import easyxf # http://pypi.python.org/pypi/xlwt

##################################################################################
## THE ERROR OCCURS AT THE LINE BELOW 
rb = open_workbook((os.path.expanduser("~/Documents/PYTHON/Selenium test/TPA_Example.xls")),formatting_info=True)
r_sheet = rb.sheet_by_index(0) # read only copy to introspect the file 
```

**编辑：我试图用编解码器打开它而不是打开诊断**

```
rb=codecs.open((os.path.expanduser("~/Documents/PYTHON/Selenium test/TPA_Example.xls")), 'r', encoding='utf16');
print rb;
print rb.readline();
print rb.read(20); 
```

它打印了以下结果：

```
<open file '/Users/Meir/Documents/PYTHON/Selenium test/TPA_Example.xls', mode 'rb' at 0x110fe51e0>
<STYLE>

            .excel { BORDER-RIGHT: black 1px solid; BORDER-TOP: black 1px solid; BORDER-LEFT: black 1px so 
```

看起来它是一个excel文档。不知道如何进行。**是否有通用的打开excel文档命令？**

# ios - Omniture 未捕获 iPad 应用程序数据

> ID：16020284
> 
> 赞同：1
> 
> 时间：2013-04-15T16:32:57.257
> 
> 标签：ios, tracking, adobe-analytics

我在我的 iPad 应用程序中使用 Omniture 来捕获数据。我正在使用可以从此页面下载的 ADMS 库：

[https://developer.omniture.com/en_US/gallery/app-measurement-for-ios](https://developer.omniture.com/en_US/gallery/app-measurement-for-ios)

库/下载包含可用于捕获数据的 TrackingHelper 类。在我的 AppDelegate 中，我调用以下方法：

```
 // enable omniture tracking
    [TrackingHelper configureAppMeasurement]; 
```

configureAppMeasurement 方法假设捕获生命周期指标，但它什么也不做。它只会让我成为一个独特的访客，仅此而已。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T16:28:03.103

You need to enable the AutoTracking of lifecycle metrics in TrackingHelper.m

In TrackingHelper.m there should be the 4 auto tracking options already included. Just uncomment the one you want to use. If they are not there, then include one of these options:

To enable only LifeCycle auto tracking (this should be the default option), use:

```
[measurement setAutoTrackingOptions:ADMS_AutoTrackOptionsLifecycle]; 
```

To enable LifeCycle and navigation tracking, use:

```
[measurement setAutoTrackingOptions:ADMS_AutoTrackOptionsLifecycle | ADMS_AutoTrackOptionsNavigation]; 
```

To enable only Navigation auto tracking, use:

```
[measurement setAutoTrackingOptions:ADMS_AutoTrackOptionsNavigation]; 
```

To fully disable all auto tracking, use:

```
[measurement setAutoTrackingOptions:ADMS_AutoTrackOptionsNone]; 
```

# json - 字符串中的注册页面，处理来自 JSON 的数据并响应什么？

> ID：16020289
> 
> 赞同：0
> 
> 时间：2013-04-15T16:33:02.057
> 
> 标签：json, spring, jakarta-ee

我的任务是在 Spring 中创建用户帐户。这是摘录自`index.jsp`。

提交以`/register`使用 POST 发送姓名、姓氏、登录名和电子邮件。我的任务是接收这些数据并将其发送到数据库。当数据在数据库中注册时，我必须返回状态码：“1”表示成功，“0”表示没有添加用户。

当我执行时`/register`，我有信息*"Required param GET"*。问题是什么？

```
<div id="register">
   <div class="top-bar">
      <header class="page-title">Zarządzanie projektami studenckimi</header>
   </div>
   <header class="section-title">Rejestracja</header>
   <table cellspacing="0" cellpadding="0">
      <tr> <td colspan="2" class="info" /> </tr>
      <tr>
         <td class="param">Imię:</td>
         <td class="value">
            <input type="text" id="register-firstname" />
         </td>
      </tr>
      <tr>
         <td class="param">Nazwisko:</td>
         <td class="value">
            <input type="text" id="register-surname" />
         </td>
      </tr>
      <tr>
         <td class="param">Adres email:</td>
         <td class="value">
            <input type="text" id="register-email" />
         </td>
      </tr>
      <tr>
         <td class="param">Nazwa użytkownika:</td>
         <td class="value">
            <input type="text" id="register-user" />
         </td>
      </tr>
      <tr>
         <td style="text-align: left;" />
         <td style="text-align: right;">
            <input type="button" id="register-button" value="Zarejestruj" />
         </td>
      </tr>
   </table>
</div> 
```

这是我的`logincontroller.java`代码`Spring`：

```
@RequestMapping(value = "/register", method = RequestMethod.POST)
public @ResponseBody Integer addProwadzacy(
        @RequestParam(value = "firstname", required = true) String imie,
        @RequestParam(value = "surname", required = true) String nazwisko,
        @RequestParam(value = "email", required = true) String mail,
        @RequestParam(value = "user", required = true) String login,
        Model model) {

    Date data = new Date();
    String haslo = null;
    // RandomPassword.
    Prowadzacy prowadzacy = new Prowadzacy();
    prowadzacy.setImiona(imie);
    prowadzacy.setNazwisko(nazwisko);
    prowadzacy.setEmail(mail);
    prowadzacy.setLogin(login);
    prowadzacy.setDataDodania(data);
    prowadzacy.setWaznosc(true);
    prowadzacy.setAktywowany(false);
    prowadzacy.setHaslo(Encryption.encrypt(haslo));
    loginService.addProwadzacy(prowadzacy);

    List<Prowadzacy> registerlist = loginService.validateRegister(imie,
            nazwisko, mail, login);
    if (registerlist.size() > 0) {
        return 1;
    } else {
        return 0;
    }
} 
```

# java - Mahout：“创建程序集归档作业时出错”

> ID：16020293
> 
> 赞同：2
> 
> 时间：2013-04-15T16:33:24.027
> 
> 标签：java, maven, mahout

我正在尝试在 Ubuntu 12.10 服务器上安装[Mahout](http://mahout.apache.org/)，但我遇到了构建错误，我无法弄清楚它失败的地方。

如果我在没有 -e 标志的情况下运行它的错误消息是：

```
Failed to create assembly: Error creating assembly archive job: error in opening zip file 
```

重现此错误的步骤是：

1.  签出回购：`svn co http://svn.apache.org/repos/asf/mahout/trunk`
2.  cd后备箱/
3.  `mvn install -e`

**mvn -版本输出：**

```
Apache Maven 2.2.1 (rdebian-8)
Java version: 1.7.0_17
Java home: /usr/lib/jvm/java-7-oracle/jre 
```

**mvn install -e 输出：**

```
Tests run: 689, Failures: 0, Errors: 0, Skipped: 0

[INFO] [jar:jar {execution: default-jar}]
[INFO] Building jar: /root/trunk/core/target/mahout-core-0.8-SNAPSHOT.jar
[INFO] [jar:test-jar {execution: default}]
[INFO] Building jar: /root/trunk/core/target/mahout-core-0.8-SNAPSHOT-tests.jar
[INFO] [assembly:single {execution: job}]
[INFO] Reading assembly descriptor: src/main/assembly/job.xml
[WARNING] POM for 'asm:asm:pom:3.1:compile' is invalid.

Its dependencies (if any) will NOT be available to the current build.
[INFO] ------------------------------------------------------------------------
[ERROR] BUILD ERROR
[INFO] ------------------------------------------------------------------------
[INFO] Failed to create assembly: Error creating assembly archive job: error in opening zip file

[INFO] ------------------------------------------------------------------------
[INFO] Trace
org.apache.maven.lifecycle.LifecycleExecutionException: Failed to create assembly: Error creating assembly archive job: error in opening zip file
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:719)
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalWithLifecycle(DefaultLifecycleExecutor.java:556)
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoal(DefaultLifecycleExecutor.java:535)
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandleFailures(DefaultLifecycleExecutor.java:387)
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments(DefaultLifecycleExecutor.java:348)
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute(DefaultLifecycleExecutor.java:180)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:328)
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:138)
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:362)
        at org.apache.maven.cli.compat.CompatibleMain.main(CompatibleMain.java:60)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.codehaus.classworlds.Launcher.launchEnhanced(Launcher.java:315)
        at org.codehaus.classworlds.Launcher.launch(Launcher.java:255)
        at org.codehaus.classworlds.Launcher.mainWithExitCode(Launcher.java:430)
        at org.codehaus.classworlds.Launcher.main(Launcher.java:375)
Caused by: org.apache.maven.plugin.MojoExecutionException: Failed to create assembly: Error creating assembly archive job: error in opening zip file
        at org.apache.maven.plugin.assembly.mojos.AbstractAssemblyMojo.execute(AbstractAssemblyMojo.java:495)
        at org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginManager.java:490)
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:694)
        ... 17 more
Caused by: org.apache.maven.plugin.assembly.archive.ArchiveCreationException: Error creating assembly archive job: error in opening zip file
        at org.apache.maven.plugin.assembly.archive.DefaultAssemblyArchiver.createArchive(DefaultAssemblyArchiver.java:190)
        at org.apache.maven.plugin.assembly.mojos.AbstractAssemblyMojo.execute(AbstractAssemblyMojo.java:436)
        ... 19 more
Caused by: org.codehaus.plexus.archiver.ArchiverException: error in opening zip file
        at org.codehaus.plexus.archiver.AbstractArchiver$1.hasNext(AbstractArchiver.java:472)
        at org.apache.maven.plugin.assembly.filter.ComponentsXmlArchiverFileFilter.finalizeArchiveCreation(ComponentsXmlArchiverFileFilter.java:166)
        at org.codehaus.plexus.archiver.AbstractArchiver.runArchiveFinalizers(AbstractArchiver.java:884)
        at org.codehaus.plexus.archiver.AbstractArchiver.createArchive(AbstractArchiver.java:908)
        at org.apache.maven.plugin.assembly.archive.archiver.AssemblyProxyArchiver.createArchive(AssemblyProxyArchiver.java:512)
        at org.apache.maven.plugin.assembly.archive.DefaultAssemblyArchiver.createArchive(DefaultAssemblyArchiver.java:186)
        ... 20 more
Caused by: java.util.zip.ZipException: error in opening zip file
        at java.util.zip.ZipFile.open(Native Method)
        at java.util.zip.ZipFile.<init>(ZipFile.java:214)
        at java.util.zip.ZipFile.<init>(ZipFile.java:144)
        at java.util.zip.ZipFile.<init>(ZipFile.java:158)
        at org.codehaus.plexus.components.io.resources.PlexusIoZipFileResourceCollection.getEntries(PlexusIoZipFileResourceCollection.java:53)
        at org.codehaus.plexus.components.io.resources.AbstractPlexusIoArchiveResourceCollection.getResources(AbstractPlexusIoArchiveResourceCollection.java:76)
        at org.codehaus.plexus.components.io.resources.proxy.PlexusIoProxyResourceCollection.getResources(PlexusIoProxyResourceCollection.java:89)
        at org.codehaus.plexus.archiver.AbstractArchiver$1.hasNext(AbstractArchiver.java:468)
        ... 25 more
[INFO] ------------------------------------------------------------------------ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-21T17:58:10.437

通过安装`maven`（Apache Maven 3.0.4）而不是`maven2`包并删除`~/.m2/`目录来解决问题。

# python - 从姓名中检测性别（男性或女性）

> ID：16020303
> 
> 赞同：-4
> 
> 时间：2013-04-15T16:34:15.887
> 
> 标签：python, algorithm

我正在用 python 开发一个应用程序，我想在其中检测任何名称通常是男性还是女性名称。

我对此进行了谷歌搜索，但找不到任何可以做到的算法/代码。但是我发现了一个做同样事情的网站：[http ://www.i-gender.com/](http://www.i-gender.com/)

我想在我的应用程序中使用他们的 API，但在此之前只是想知道他们如何从名字中检测性别？真的可以通过算法来做到吗？请建议一些文档/链接。

这是我正在尝试的：

```
>>> import urllib2
>>> import json
>>> req = urllib2.Request("http://www.i-gender.com/ai", "name=jhony")
>>> resp = urllib2.urlopen(req).read()
>>> decoder = json.JSONDecoder()
>>> result = decoder.decode(resp)
>>> print result['gender']
male
>>> print result['confidence']
100
>>> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:38:09.543

I'd guess they probably use a database, possibly supplemented by an algorithm to guess about names that aren't in the database.

There are quite a few names (e.g., "Pat") for which either gender is fairly common. If you look internationally, quite a few names that are generally attached to one gender in one country may be attached to the other gender in other countries, and may be relatively free of gender-attachment in still others.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T16:47:11.223

正如你想阅读的关于自然语言处理的评论中提到的，或者 sr2222 建议的神经网络。（您可能最终需要两者的组合）。如果 iGender 正在积极尝试创建一个人工智能性别预测工具，正如他们声称的那样，他们也在使用这个工具。

有很多可用的，一个简单的谷歌搜索会让你走得更远。
我会推荐 Python：NLTK 和/或 PyBrain。
NLTK 有一本（免费）书，其中一章实际上是关于姓名/性别预测的。

关于他们的 API，您是否安装了所有要求？你遇到什么问题？看看你的代码，它对我来说似乎工作正常.. ？

* * *

如果你不介意我问，你想达到什么目的？可能有更简单/更好和更可靠的选项可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T16:39:26.170

I think you would be hardpressed to find an algorithm to detect gender.

One thing you could do is create a dictionary with a name as a key, and a gender as a value.

Other things you will have to consider are names that can be for a boy or girl, and non-english names, these variables could factor into your `confidence`.

# c# - 使用 .NET 4.5 为移动设备开发

> ID：16020306
> 
> 赞同：1
> 
> 时间：2013-04-15T16:34:32.843
> 
> 标签：c#, compact-framework, barcode-scanner, vb6-migration

我们正在开始将我们的 VB6 WMS 应用程序转换为 .NET，其中一部分开发将是手持式扫描仪（例如 RF 和条形码），特别是`MC9090`.

在 Visual Studio 2008 之后，Microsoft 是否停止支持 Compact Framework？

有哪些选项可用于在此设备上进行开发？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T16:50:30.170

Microsoft，截至目前（2013 年 4 月中旬供未来读者使用），在 Studio 2008 下支持 CF 3.5。

Studio 2012 将支持大多数手持扫描仪等可能迁移到[的 Windows Embedded Handheld (WEH) 的较新版本，但将基于 Windows Phone，因此编程范式发生了很大变化。](http://www.microsoft.com/en-us/news/features/2013/jan13/01-14Handheld.aspx)

对于将在嵌入式设备中使用的 vanilla Windows Embedded Compact（WEC，过去称为“Windows CE”），[Visual Studio 2012 和 CF 3.9 将在 WEC 2013 中得到支持](http://blogs.msdn.com/b/dotnet/archive/2012/11/16/introducing-netcf-3-9-in-windows-embedded-compact-2013-a-faster-leaner-and-multi-core-runtime.aspx)，将于本季度（截至 2013 年 6 月 30 日）发布.

因此，对于当今可用的设备，CF 3.5 和 Studio 2008 是不二之选。确保 UI 和业务逻辑很好地分离是明智的，因为您可能会将代码移植到 Studio 2012 下的 Silverlight 以用于下一代设备。

# javascript - 为什么 iframe 字体大小根本不改变？

> ID：16020308
> 
> 赞同：0
> 
> 时间：2013-04-15T16:34:53.813
> 
> 标签：javascript, html, iframe

我想将 iframe 字体大小更改为 150%。我已经在 css 中设置然后结果不会改变，仍然是相同的小文本。为什么它不改变大小？

这是我的CSS代码，

```
#frame{
font-size:150%;
}

.frame {
z-index:2000;
} 
```

然后是我的html代码，

```
<div class="frame">
    <iframe id ="frame" srcdoc="<p></p>" width="930"></iframe>
</div> 
```

然后是在 iframe 中打印文本的 javascript 代码，

```
document.getElementById("frame").srcdoc += transcript; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-22T15:57:38.807

```
function changeSize(){
    var frame = document.getElementById("frame");
    var content = (frame.contentDocument || frame.contentWindow);
    content.body.style.fontSize = "150%";
} 
```

像这样将文本添加到 iFrame 后尝试调用此函数

```
document.getElementById("frame").srcdoc += transcript;
changeSize(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:36:52.997

父页面中的 CSS 不会影响 iframe 中的任何内容。事实上，iframe 几乎完全脱离了它出现的页面上的代码。

# objective-c - -[CollectionCell _setReuseIdentifier:]：无法识别的选择器发送到实例

> ID：16020312
> 
> 赞同：0
> 
> 时间：2013-04-15T16:34:54.847
> 
> 标签：objective-c, uicollectionview, uicollectionviewcell

`CollectionCell`是一个`UICollectionViewCell`子类。出于学习目的，唯一的区别是单个子视图。

没有界面生成器。全部在代码中。

对于 iOS 5，我可以这样做……</p>

```
[_collectionView registerClass:[CollectionCell class]
    forCellWithReuseIdentifier:@"CollectionCell"]; 
```

…但它在 iOS 6 中中断，我找不到任何信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:38:37.237

Your subclassed CollectionCell doesn't have the "`registerClass: forCellWithReuseIdentifier`" method.

Your "`UICollectionView`" (which uses and displays CollectionCell objects) does.

Call "`registerClass: forCellWithReuseIdentifier`" on your collection view instead of the cell.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-18T16:14:19.437

确保您的`UICollectionViewCell`类扩展`PSUICollectionViewCell`. 我也遇到了同样的问题，发现我的细胞正在延伸`PSTCollectionViewCell`。

# php - PHP + 转换数组以用于 IN 语句

> ID：16020313
> 
> 赞同：0
> 
> 时间：2013-04-15T16:35:00.297
> 
> 标签：php, sql, arrays, in-clause

假设我想向喜欢大糖果的人发送电子邮件。

当我这样做时：

```
$query1 = mysql_query("SELECT id_candy FROM `candylist` WHERE
candysize > 100") or die(mysql_error());

$result = mysql_fetch_array( $query1 );

$query2 = mysql_query("SELECT mail FROM `buyers` WHERE
candysizeinterest IN ($result)
") or die(mysql_error()); 
```

这个query2当然是问题所在。

$result 的格式不适合使用，然后出现以下明显错误：

```
**Unknown column 'Array' in 'where clause'** 
```

我需要帮助以如下方式格式化查询结果：

```
($val1, $val2, $val3....and so on) 
```

然后我将能够将它用于 IN 语句。

但我只是不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:43:52.327

尝试

```
$array = array();
while($result = mysql_fetch_array( $query1 ))
{
   $array[] = $result['id_candy'];
} 
```

然后使用[内爆](http://php.net/manual/en/function.implode.php)

```
$in_condition  = implode(',', $array); 
```

终于

```
$query2 = mysql_query("SELECT mail FROM `buyers` WHERE candysizeinterest IN ($in_condition) 
```

**注意**：请切换到 PDO 或 mysqli_*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:36:42.803

您在`$query2`放置数组而不是实际值的语法中有错误

**改变**

```
$query2 = mysql_query("SELECT mail FROM `buyers` WHERE candysizeinterest IN ($result) 
```

**到**

```
$query2 = mysql_query("SELECT `mail` FROM `buyers` WHERE `candysizeinterest` IN ('".$result['id_candy']."')"); 
```

我还想提醒您，`mysql_`功能已被弃用，因此我建议您切换到新项目[`mysqli`](http://php.net/manual/en/book.mysqli.php)或[`PDO`](http://php.net/manual/en/book.pdo.php)进行新项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T16:38:38.563

您可以使用`implode()`将数组转换为逗号分隔的字符串：

`implode(',',$result);`

您可以将其与 IN 一起使用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T16:40:11.600

要将数组转换为逗号分隔的字符串，您将使用

```
implode (",",$array) 
```

# css - SASS 中的嵌套 mixins 或函数

> ID：16020316
> 
> 赞同：26
> 
> 时间：2013-04-15T16:35:11.407
> 
> 标签：css, nested, sass, mixins

有些人知道如何在 SASS 中使用嵌套的 mixins 或函数？我有这样的事情：

```
@mixin A(){
    do something....
}

@mixin B($argu){
    @include A();
} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-15T18:04:54.403

是的，你已经做对了。您可以在第二个中调用第一个 mixin。检查这支笔[http://codepen.io/crazyrohila/pen/mvqHo](http://codepen.io/crazyrohila/pen/mvqHo)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-04-05T07:04:35.237

你可以多嵌套混合，你也可以在混合中使用占位符..

```
@mixin a {
  color: red;
}
@mixin b {
  @include a();
  padding: white;
  font-size: 10px;
}
@mixin c{
  @include b;
  padding:5;
}
div {
  @include c();
} 
```

这给出了 CSS

```
div {
  color: red;
  padding: white;
  font-size: 10px;
  padding: 5;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-09-21T20:12:57.477

如其他答案中所述，您可以在其他混入中包含混入。此外，您可以确定 mixin 的范围。

**例子**

```
.menu {
  user-select: none;

  .theme-dark & {
    color: #fff;
    background-color: #333;

    // Scoped mixin
    // Can only be seen in current block and descendants,
    // i.e., referencing it from outside current block
    // will result in an error.
    @mixin __item() {
      height: 48px;
    }

    &__item {
      @include __item();

      &_type_inverted {
        @include __item();

        color: #333;
        background-color: #fff;
      }
    }
  }
} 
```

将输出：

```
.menu {
  user-select: none;
}

.theme-dark .menu {
  color: #fff;
  background-color: #333;
}

.theme-dark .menu__item {
  height: 48px;
}

.theme-dark .menu__item_type_inverted {
  height: 48px;
  color: #333;
  background-color: #fff;
} 
```

范围混入意味着您可以在不同的范围内拥有多个名称相同的混入，而不会产生冲突。

# algorithm - 在现实世界的寻路中，A* 真的比 Dijkstra 更好吗？

> ID：16020317
> 
> 赞同：21
> 
> 时间：2013-04-15T16:35:15.503
> 
> 标签：algorithm, dijkstra, a-star

我正在开发一个寻路程序。理论上说A*优于Dijkstra。事实上，后者是前者的特例。但是，当在现实世界中进行测试时，我开始怀疑 A* 真的更好吗？

我使用了纽约市的数据，来自*[9th DIMACS Implementation Challenge - Shortest Paths](http://www.dis.uniroma1.it/challenge9/download.shtml)*，其中给出了每个节点的纬度和经度。

[应用 A* 时，我需要使用Haversine Formula](http://en.wikipedia.org/wiki/Haversine_formula)计算两点之间的球面距离，其中涉及 sin、cos、arcsin、平方根。所有这些都非常非常耗时。

结果是，

使用 Dijkstra：39.953 毫秒，扩展 256540 个节点。

使用 A*，108.475 毫秒，扩展 255135 个节点。

注意到在 A* 中，我们扩展了更少的 1405 个节点。然而，计算启发式的时间比节省的时间要多得多。

据我了解，原因是在一个非常大的实数图中，启发式的权重会非常小，它的影响可以忽略不计，而计算时间占主导地位。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-04-15T16:39:19.340

I think you're more or less missing the point of A*. It is intended to be a very performant algorithm, partially by intentionally doing more work but with cheap heuristics, and you're kind of tearing that to bits when burdening it with a heavy extremely accurate prediction heuristic.

For node selection in A* you should just use an approximation of distance. Simply using (latdiff^2)+(lngdiff^2) as the approximated distance should make your algorithm much more performant than Dijkstra, and not give much worse results in any real world scenario. Actually the results should even be exactly the same if you do calculate the travelled distance on a *selected* node properly with the Haversine. Just use a cheap algorithm for selecting potential next traversals.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-05-10T15:34:22.107

`A*`可以通过设置一些琐碎的参数来简化为 Dijkstra。在 Dijkstra 上没有改进的三种可能方式：

1.  使用的启发式是不正确的：它不是所谓的可接受的启发式。`A*`应该使用不会高估目标距离的启发式方法作为其成本函数的一部分。
2.  启发式计算成本太高。
3.  现实世界的图结构是特殊的。

对于后者，您应该尝试建立在现有研究的基础上，例如Abraham 等人的*“Highway Dimension, Shortest Paths, and Provably Efficient Algorithms”*。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-04-15T16:43:05.950

就像宇宙中的其他**事物**一样，需要权衡取舍。您可以使用 dijkstra 的算法来*精确*计算启发式，但这会破坏目的，不是吗？

A* 是一个很棒的算法，因为它让你倾向于目标，*大致*了解首先要扩展哪个方向。也就是说，您应该使启发式方法尽可能简单，因为您所需要的只是一个大方向。

事实上，不基于实际数据的更精确的几何计算并不一定能给你更好的方向。只要它们不基于数据，所有这些启发式方法都会为您提供一个同样（不）正确的方向。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-15T16:48:38.427

一般来说，A* 比 Dijkstra 的性能更高，但它实际上取决于您在 A* 中使用的启发式函数。您需要一个乐观的 h(n) 并找到最低成本路径，h(n) 应该小于真实成本。如果 h(n) >= cost，那么您最终会遇到您所描述的情况。

你能发布你的启发式函数吗？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-05-05T09:29:49.027

还要记住，这些算法的性能很大程度上取决于图的性质，这与启发式的准确性密切相关。

如果您在导航出迷宫时比较 Dijkstra 与 A*，其中每个段落对应于单个图形边缘，性能可能几乎没有差异。另一方面，如果图在“远”节点之间有许多边，则差异可能会非常显着。想象一个机器人（或人工智能控制的计算机游戏角色）在几乎开放的地形中导航，有一些障碍物。

我的观点是，尽管您使用的纽约数据集绝对是“真实世界”图的一个很好的例子，但它并不能代表所有真实世界的寻路问题。

# c++ - 在 C 中使用 Gettimeofday() 的日月年算法

> ID：16020318
> 
> 赞同：-2
> 
> 时间：2013-04-15T16:35:16.007
> 
> 标签：c++, c, algorithm, epoch

作为实验室的一部分，我需要设计一种方法来计算当前月份的日期和年份。我将使用 gettimeofday() 函数，它给出了自 1970 年 1 月 1 日以来的秒数。

我知道有些函数可以为我进行转换，但是设计要求是我创建自己的算法来将秒数转换为月日和年。我想要实现我的设计的方式是为十二个月中的每个月和相应的天数提供一个查找表。现在的逻辑让我有点困惑。

棘手的部分是处理闰年。我知道 1972 年是自 1970 年以来的第一个闰年。自该日期起每 4 年发生一次闰年。在这个作业中给我的提示是，天之后的下一个最大周期是 4 年。因此，如果我将自 1970 年以来的天数乘以 1461（4 年的天数），我知道我可以得到剩余的天数。在这一点上，我的逻辑迷路了。如果我将它除以 1461，它只会告诉我已经过去了多少个 4 年。

我想实现的表看起来像这样（我知道编码不完全正确，只是为了显示我得到了什么）：

```
struct Monthdays
{
int days;
char* Monthname[]
};

Monthdays lookupMonths[]
{
{31,"January"}
{28,"February"}
.
.
.

}; 
```

我试图弄清楚如何使用天数或一些东西来创建正确的索引来遍历这个“表”............我希望在这里问这个没问题。我一直在与逻辑或几天作斗争......

这是我现在遇到的这个问题的代码，效率很低。

```
 ExpandedTime* localTime(
                        struct timeval* tv,     // Pointer to timeval struct
                        ExpandedTime* etime     // '' '' to expandedtime strct
                        )
{
    tzset();                                    // Corrects for timezone

    int epochT = (tv->tv_sec) - timezone;       // Epoch seconds with
    int epochUT = tv->tv_usec;                  // epochtime microseconds
    int edays;                                  // Days since epochtime

    etime->et_usec = (epochUT/milli) % milli;   // Find the milliseconds

    etime->et_sec = epochT % 60;
    epochT /= 60;                               // Turn into minutes

    etime->et_min = epochT % 60;
    epochT /= 60;                               // Turn into hours

    if (localtime(&tv->tv_sec)->tm_isdst !=0)
        etime->et_hour = (epochT % 24) + daylight;      // Hours with DST correc
    else
        etime->et_hour = (epochT % 24);

    edays = epochT /= 24;                       // Turn into days

    etime->et_day = epochT;                     // Delete up to here
    etime->et_year = (epochT/365) + epochyear;  // Get the current year

    int trackyear;                              // Counter for years
    int trackdays = -1;                         // Subtracting janurary 1st
                                                // from days
   // This will determine if it is a leapyear and adjust days accordingly
    // from 1970 to current year (2013)

    for (trackyear = epochyear; trackyear < etime->et_year; trackyear++)
    {
        if (trackyear % leapy == 0)
        {
            trackdays = trackdays + 366;
        }
        else
        {
            trackdays = trackdays + 365;
        }
    }
    etime->et_day = edays - trackdays;

    int trackmonth = -1;                        // Counter for months
                                                // with offset to make
                                                // january = 0

    // This will give me the number of months for the buffer

    do
    {
        switch (trackmonth)
        {

            // Months with 31 days
            case 0:
            etime->et_day = (etime->et_day) - 31;
            break;

            case 2:
            etime->et_day = (etime->et_day) - 31;
            break;

            case 4:
            etime->et_day = (etime->et_day) - 31;
            break;

            case 6:
            etime->et_day = (etime->et_day) - 31;
            break;

            case 7:
            etime->et_day = (etime->et_day) - 31;
            break;
            case 9:
            etime->et_day = (etime->et_day) - 31;
            break;

            case 11:
            etime->et_day = (etime->et_day) - 31;
            break;

            // Months with only 30 days

            case  3:
            etime->et_day = (etime->et_day) - 30;
            break;

            case 5:
            etime->et_day = (etime->et_day) - 30;
            break;

            case 8:
            etime->et_day = (etime->et_day) - 30;
            break;

            case 10:
            etime->et_day = (etime->et_day) - 30;
            break;

            // Leap year month a.k.a Febuary

            case 1:
            if (trackyear % leapy)
            {
                etime->et_day = (etime->et_day) - 28;
            }
            else
            {
                etime->et_day = (etime->et_day) - 29;
            }

            break;

        }
        trackmonth++;

    }
    while(etime->et_day > 0);

    etime->et_mon = trackmonth - 1;
    // Reverts day offset from previous switch to
    // accurately represent the current day

    switch (etime->et_mon)
    {
            // Months with 31 days

            case 0:
            etime->et_day = (etime->et_day) + 31;
            break;

            case 2:
            etime->et_day = (etime->et_day) + 31;
            break;

            case 4:
            etime->et_day = (etime->et_day) + 31;
            break;

            case 6:
            etime->et_day = (etime->et_day) + 31;
            break;

            case 7:
            etime->et_day = (etime->et_day) + 31;
            break;

            case 9:
            etime->et_day = (etime->et_day) + 31;
            break;

            case 11:
            etime->et_day = (etime->et_day) + 31;
            break;

            // Months with only 30 days

            case  3:
            etime->et_day = (etime->et_day) + 30;
            break;

            case 5:
            etime->et_day = (etime->et_day) + 30;
            break;

            case 8:
            etime->et_day = (etime->et_day) + 30;
            break;

            case 10:
            etime->et_day = (etime->et_day) + 30;
            break;

            // Leap year month a.k.a Febuary

            case 1:
            if (trackyear % leapy)
            {
                etime->et_day = (etime->et_day) + 28;
            }
            else
            {
                etime->et_day = (etime->et_day) + 29;
            }

            break;
    }

    return etime;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:36:49.720

上网浏览一下有关如何计算儒略日（或更准确地说是儒略日数）的信息……这将解决您的问题或让您顺利上路。

除此之外，为他们做作业是不道德的……不过……我确实有一个 PayPal 帐户~lol~

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-15T16:39:29.247

```
if(year % 4 == 0 && year % 100 == 0 && year % 25 != 0) 
    this is a leap year. 
```

This was actually the hardest kind of homework i had on college... all in all, depending on how accurate this needs to be, i'll tell you to [not] look into timezones and when different zones enter daylight savings...

Sorry if the answer isn't terribly helpful, but this is the formula for leap years. If you keep going the route you're headed, you'll need to bring in the [Chinese theorem](http://en.wikipedia.org/wiki/Chinese_remainder_theorem) into this...

But if you can do `gettimeofday()` it returns the number of milliseconds since 1st January 1970\. So you can just put a little for in it that will 'waste' the seconds and simulate passage of time up until now, and run that loop until you run out of time. When you stop you should be able to see at which date you stopped ;)

# java - 如何在 Java 中检测用户的真实区域设置（语言环境）

> ID：16020321
> 
> 赞同：4
> 
> 时间：2013-04-15T16:35:26.763
> 
> 标签：java, locale, java-7

**更新：** 为了完整起见，将工作/固定代码放在这里。可以在**[此处](https://stackoverflow.com/a/8319889/1122039)**找到有关为什么会发生这种情况的详细说明。感谢用户*Perception*向我指出它。

这是代码：

```
import java.util.Locale;

/**
 * Demonstrating proper usage of Java's {@linkplain Locale} class
 * in respect to accessing user's regional settings, specifically
 * the locale configured for date/time/number formatting.
 *
 * @see Locale#getDefault(java.util.Locale.Category)
 * @see Locale#getDefault()
 */
public class DefaultLocaleChangesJava7Demo {
  private static final String NO_VALUE = "<- empty ->";
  private static final String[] ENVVAR_NAMES = {
      "java.runtime.name", "java.runtime.version", "java.vm.name", "java.vm.version",
      "os.name", "os.version", "os.arch",
      "user.language", "user.country", "user.script", "user.variant",
      "user.language.format", "user.country.format", "user.script.format" };

  public static void main(String[] args) {
    // Print out select environment variables.
    System.out.println();
    System.out.println("System Information (environment):");
    for (String name : ENVVAR_NAMES) {
      String value = System.getProperty(name);
      if (value == null || value.length() == 0) {
        value = NO_VALUE;
      }
      System.out.println("  " + name + " = " + value);
    }

    // Print out default display locale information.
    System.out.println("\nDefault Display Locale:");
    final Locale defaultLocale = Locale.getDefault();
    System.out.println(localeToString(defaultLocale, "  default."));

    // Print out default format locale information.
    System.out.println("\nDefault Format Locale:");
    final Locale formatLocale = Locale.getDefault(Locale.Category.FORMAT);
    System.out.println(localeToString(formatLocale, "  format."));
  }

  public static String localeToString(Locale locale, String prefix) {
    final StringBuffer result = new StringBuffer();

    result.append(prefix);
    result.append("locale.language = ");
    result.append(locale.getLanguage());
    result.append(" (");
    result.append(locale.getDisplayLanguage());
    result.append(")\n");

    result.append(prefix);
    result.append("locale.country = ");
    result.append(locale.getCountry());
    result.append(" (");
    result.append(locale.getDisplayCountry());
    result.append(")\n");

    result.append(prefix);
    result.append("locale.script = ");
    result.append(locale.getScript());
    result.append(" (");
    result.append(locale.getDisplayScript());
    result.append(")\n");

    result.append(prefix);
    result.append("locale.variant = ");
    result.append(locale.getVariant());
    result.append(" (");
    result.append(locale.getDisplayVariant());
    result.append(")\n");

    return result.toString();
  }
} 
```

# 原始问题

今天我注意到 Java`Locale.getDefault()`没有返回我在 Windows 7 帐户中配置的区域设置。

演示应用：

```
import java.util.Locale;

public class BadLocaleDemo {
  private static final String NO_VALUE = "<- empty ->";
  private static final String[] ENVVAR_NAMES = {
      "java.runtime.name", "java.runtime.version", "java.vm.name", "java.vm.version",
      "os.name", "os.version", "os.arch" };

  public static void main(String[] args) {
    // Print out select environment variables.
    System.out.println();
    System.out.println("System Information (environment):");
    for (String name : ENVVAR_NAMES) {
      String value = System.getProperty(name);
      if (value == null || value.length() == 0) {
        value = NO_VALUE;
      }
      System.out.println("  " + name + " = " + value);
    }

    // Print out default locale information.
    System.out.println();
    System.out.println("Default Locale:");

    final Locale defaultLocale = Locale.getDefault();
    System.out.println("  default.locale.language = " + defaultLocale.getLanguage());
    System.out.println("  default.locale.country = " + defaultLocale.getCountry());
    System.out.println("  default.locale.display.language = " + defaultLocale.getDisplayLanguage());
    System.out.println("  default.locale.display.country = " + defaultLocale.getDisplayCountry());
  }
} 
```

以及它打印出来的信息：

```
System Information (environment):
  java.runtime.name = Java(TM) SE Runtime Environment
  java.runtime.version = 1.7.0_02-b13
  java.vm.name = Java HotSpot(TM) 64-Bit Server VM
  java.vm.version = 22.0-b10
  os.name = Windows 7
  os.version = 6.1
  os.arch = amd64

Default Locale:
  default.locale.language = en
  default.locale.country = US
  default.locale.display.language = English
  default.locale.display.country = United States 
```

默认本地应`sr_RS`根据我的区域设置（工作日名称在托盘时钟上以西里尔字母表示），但 Java 正在报告`en_US`.

有谁知道如何解决这个问题？

我在 StackOverflow 上找到的相关帖子只有这两个：

*   [如何从 Java 代码中检测操作系统语言（区域设置）](https://stackoverflow.com/questions/2469435/how-to-detect-operating-system-language-locale-from-java-code)
*   [Java 中有用的环境设置列表](https://stackoverflow.com/questions/7585699/list-of-useful-environment-settings-in-java)

# database - 如何编写这个 LINQ（或 SQL）查询？

> ID：16020322
> 
> 赞同：0
> 
> 时间：2013-04-15T16:35:33.533
> 
> 标签：database, linq, tsql

我有两个这样的表：

> **消息**
> 
> ID
> 
> 标题
> 
> 语言标识

语言表：

> **语言**
> 
> ID
> 
> 姓名
> 
> 是默认值

现在使用 LanguageId 作为参数（例如 en-US），默认语言是 en-GB，我想得到这样的值：

> **消息**
> 
> *Id* *标题* *LanguageId*
> 
> 1 1 zh-CN
> 
> 2 2 zh-CN
> 
> ...剩下的美国新闻...
> 
> 10 10 zh-CN
> 
> 11 11 zh-CN
> 
> ...剩余的 en-GB 新闻，因为 en-GB 是默认的...
> 
> 20 20 FR-FR
> 
> 21 21 FR-FR
> 
> ...其余语言的其他新闻...

当前的解决方案是使用临时表和游标来获取每种语言的新闻。有没有更好的方法呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T20:41:54.030

找到正确的语言顺序是这里的关键（类似于您所拥有的）：

```
from lang in db.Languages
order by lang.LanguageId == languageId descending,
         lang.IsDefault descending,
         lang.Name 
```

然后添加连接：

```
from lang in db.Languages
join newsItem in db.NewsItems on lang.LanguageId equals newsItem.LanguageId
order by lang.LanguageId == languageId descending,
         lang.IsDefault descending,
         lang.Name
select new { newsItem.Id, newsItem.Title, lang.Name } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:48:22.223

您可以对 tsql 使用 order by 语句，如下所示。

```
ORDER BY CASE LanguageId WHEN 'en-US' THEN 0 WHEN 'en-GB' THEN 1 ELSE 2 END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T17:29:54.463

经过一些工作，我的 LINQ 查询是：

```
List<News> GetNews(string languageId)
{
    var languages = db.Languages.ToDictionary(l => l.Id, l => l.IsDefault);
    var news = db.News.Where(<filter condition>).ToList(); //(otherwise LINQ to Entities will not be able to recognize my custom function)
        news = news.OrderByDescending(n=>n.LanguageId == languageId).ThenByDescending(n=> OrderByLang(a.LanguageId, languages)).ToList();
}

private bool OrderByLang(string languageId, Dictionary<string, bool> languages)
{
                return (languages[languageId]);
} 
```

它按预期工作，但需要将整个表返回到应用层进行分页，这不是很理想。还有其他建议吗？

# javascript - 为 Windows mobile 6.1 构建网站

> ID：16020325
> 
> 赞同：0
> 
> 时间：2013-04-15T16:35:54.817
> 
> 标签：javascript, jquery, browser, web, windows-mobile

我正在为 Windows 手机 6.1 制作一个网站，并试图找出要使用的浏览器。我遇到了一种模式，即在一个浏览器上运行的某些功能在另一个浏览器上不起作用。到目前为止我已经尝试过

*   `IE 6`- 相对更好但对齐不好，打开时页面会放大
*   `Opera Mobile 10`- Javascript 按键不起作用，虽然良好的对齐和屏幕分辨率设置
*   `Mozilla Fennec`- 迄今为止最好的一个，但真的很慢。

如果我在这些手机上更新 IE/OS 来解决这个问题，有什么想法，我想避免购买新的许可证吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:35:36.347

为桌面或移动开发网站始终是所有不同浏览器的挑战。

如果您打算使用一批一个移动设备型号，您可以定义必须使用哪个浏览器。如果您不在那个位置，则必须针对不同的浏览器工作。

在 windows mobile 6.1 上，您可以依赖的唯一标准是内置的 IE6 移动浏览器。

如果你可以定义一个第三方浏览器，你可以看看 ZetaKey（基于 WebKit）。

# asp.net - VB Asp.net 将参数传递给子查询还是更好的解决方案？

> ID：16020327
> 
> 赞同：0
> 
> 时间：2013-04-15T16:36:08.023
> 
> 标签：asp.net, sql, database, visual-studio-2010, ms-access

环境：连接到 Access 数据库的 Visual Basic Asp.net

好的，为我正在处理的数据库组合一个 Select 语句，我很难过。希望你们中的一个人能想出​​一个解决方案！

```
Laying out the problem:
Table Name: CONTACTS
Field: ContactID (primary key, autonumber)
Field: UserName [this is being used to identify the user easily from Asp.net]

Table Name: APPLICANT
Field: ContactID (primary foreign)
Field: JobID (primary foreign)

Table Name: JOB
Field: JobID (primary key, autonumber)
Field: Description
Field: Class
Field: Type 
```

我需要的是 * 从 JOB 那里获得他们尚未申请的工作。当他们申请了一个工作时，它通过 APPLICANT 表中的 ContactID 和 JobID 的组合键来反映。

我可以通过两个查询在 Access 中完成此操作：

```
SELECT Applicant.JobID
FROM Contacts INNER JOIN Applicant ON Contacts.[ContactID] = Applicant.[ContactID]
WHERE (((Contacts.UserName)='Test002'));

SELECT Job.JobID, Job.Description, Job.JobType, Job.JobClass
FROM Job LEFT JOIN [Applicant Query] ON Job.[JobID] = [Applicant Query].[JobID]
WHERE ((([Applicant Query].JobID) Is Null)); 
```

其中 [Applicant Query] 当然是指第一个查询。

现在，因为 UserName 被用于识别用户，所以它必须包含在查询中，这就是困难所在。在 Visual Studio 中，我知道如何将参数传递给 Select 命令。但是，我似乎无法将参数传递给子查询。为了在我的解释中详尽无遗，“Test002”是我希望用参数替换的部分。

我希望你们知道解决这个问题的方法，或者，如果失败了，是一种完全规避问题的天才方法。提前感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:08:41.183

如何使用子查询将其组合成单个查询？它看起来像这样：

```
SELECT Job.JobID, Job.Description, Job.JobType, Job.JobClass
FROM Job 
LEFT JOIN (
  SELECT Applicant.JobID
  FROM Contacts INNER JOIN Applicant ON Contacts.[ContactID] = Applicant.[ContactID]
  WHERE ((Contacts.UserName)='Test002')) AS subqry
ON Job.[JobID] = [subqry].[JobID]
WHERE (([subqry].JobID) Is Null)); 
```

这是相同的逻辑，只是使用单个查询而不是两个查询。

# perl - 在 Perl 中捕获 BZIP2 终止

> ID：16020330
> 
> 赞同：1
> 
> 时间：2013-04-15T16:36:16.507
> 
> 标签：perl, bzip2

这是我到目前为止所拥有的：

```
#!/usr/bin/perl

use strict;
use warnings;

use IO::Compress::Bzip2 qw(bzip2 $Bzip2Error);
use File::Find;
use File::Basename;

my $directory = "/usr/www/op1/public/server";
my @list_of_files;

find sub {
        return if -d;
        my $current = basename("$File::Find::name");

        if ($current =~ /\.bz2$/i)
        {
                #print "<$current> is already compressed! Moving along!\n";
                return;
        }

        print "<$current> is being compressed!\n";
        bzip2 $File::Find::name => "$File::Find::name.bz2";

        if (!("$Bzip2Error" eq ""))
        {
                print "\n$Bzip2Error at $File::Find::name\n";
                print "Trying again to compress <$current>\n";
                bzip2 $File::Find::name => "$File::Find::name.bz2" or print "FAILURE 2!!!";
        }
}, "$directory"; 
```

基本上，如果它决定终止，则在进行 bzip 压缩时：

```
<bobsagot> is being compressed!
<arthur.bsp.bz2> is already compressed! Moving along!
<reed.bsp.bz2> is already compressed! Moving along!
<bobby.bsp.bz2> is already compressed! Moving along!
<bigjoe.bsp> is being compressed!
Terminated 
```

它会立即从失败的地方拾取并继续前进，但是我没有打印出错误，`$Bzip2Error`所以我很茫然。如何捕获 bzip2 失败的事件？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T12:07:33.727

共享主机将 perl 执行时间限制为 60 秒。失去希望 :D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T13:04:44.407

您是否在代码中犯了剪切粘贴错误？**以“ system(** ”开头的行不合适。

**脚本是否在bzip2**调用期间自行终止？

如果你写这样的代码会发生什么？

```
if ( ! bzip2 $File::Find::name => "$File::Find::name.bz2")
{
    print "\nBzip Errir is [$Bzip2Error] System Error is [$!] at $File::Find::name\n";
} 
```

# hadoop - Hadoop：Datanode进程被杀死

> ID：16020334
> 
> 赞同：19
> 
> 时间：2013-04-15T16:36:36.980
> 
> 标签：hadoop, hdfs

我目前正在使用 Hadoop-2.0.3-alpha 并且在我可以完美地使用 HDFS 之后（将文件复制到 HDFS，从外部框架获得成功，使用 webfrontend），在我的 VM 重新启动后，datanode 进程正在停止过了一会儿。namenode 进程和所有 yarn 进程都可以正常工作。我在另一个用户下的文件夹中安装了 Hadoop，因为我还安装了 Hadoop 0.2，它也运行良好。查看所有数据节点进程的日志文件，我得到以下信息：

```
2013-04-11 16:23:50,475 WARN org.apache.hadoop.util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2013-04-11 16:24:17,451 INFO org.apache.hadoop.metrics2.impl.MetricsConfig: loaded properties from hadoop-metrics2.properties
2013-04-11 16:24:23,276 INFO org.apache.hadoop.metrics2.impl.MetricsSystemImpl: Scheduled snapshot period at 10 second(s).
2013-04-11 16:24:23,279 INFO org.apache.hadoop.metrics2.impl.MetricsSystemImpl: DataNode metrics system started
2013-04-11 16:24:23,480 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Configured hostname is user-VirtualBox
2013-04-11 16:24:28,896 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Opened streaming server at /0.0.0.0:50010
2013-04-11 16:24:29,239 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Balancing bandwith is 1048576 bytes/s
2013-04-11 16:24:38,348 INFO org.mortbay.log: Logging to org.slf4j.impl.Log4jLoggerAdapter(org.mortbay.log) via org.mortbay.log.Slf4jLog
2013-04-11 16:24:44,627 INFO org.apache.hadoop.http.HttpServer: Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer$QuotingIn putFilter)
2013-04-11 16:24:45,163 INFO org.apache.hadoop.http.HttpServer: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFil ter$StaticUserFilter) to context datanode
2013-04-11 16:24:45,164 INFO org.apache.hadoop.http.HttpServer: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFil ter$StaticUserFilter) to context logs
2013-04-11 16:24:45,164 INFO org.apache.hadoop.http.HttpServer: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFil ter$StaticUserFilter) to context static
2013-04-11 16:24:45,355 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Opened info server at 0.0.0.0:50075
2013-04-11 16:24:45,508 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: dfs.webhdfs.enabled = false
2013-04-11 16:24:45,536 INFO org.apache.hadoop.http.HttpServer: Jetty bound to port 50075
2013-04-11 16:24:45,576 INFO org.mortbay.log: jetty-6.1.26
2013-04-11 16:25:18,416 INFO org.mortbay.log: Started SelectChannelConnector@0.0.0.0:50075
2013-04-11 16:25:42,670 INFO org.apache.hadoop.ipc.Server: Starting Socket Reader #1 for port 50020
2013-04-11 16:25:44,955 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Opened IPC server at /0.0.0.0:50020
2013-04-11 16:25:45,483 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Refresh request received for nameservices: null
2013-04-11 16:25:47,079 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Starting BPOfferServices for nameservices: <default>
2013-04-11 16:25:47,660 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Block pool <registering> (storage id unknown) service to localhost/127.0.0.1:8020 starting to offer service
2013-04-11 16:25:50,515 INFO org.apache.hadoop.ipc.Server: IPC Server Responder: starting
2013-04-11 16:25:50,631 INFO org.apache.hadoop.ipc.Server: IPC Server listener on 50020: starting
2013-04-11 16:26:15,068 INFO org.apache.hadoop.hdfs.server.common.Storage: Lock on /home/hadoop/workspace/hadoop_space/hadoop23/dfs/data/in_use.lock acquired by nodename 3099@user-VirtualBox
2013-04-11 16:26:15,720 FATAL org.apache.hadoop.hdfs.server.datanode.DataNode: Initialization failed for block pool Block pool BP-474150866-127.0.1.1-1365686732002 (storage id DS-317990214-127.0.1.1-50010-1365505141363) service to localhost/127.0.0.1:8020
java.io.IOException: Incompatible clusterIDs in /home/hadoop/workspace/hadoop_space/hadoop23/dfs/data: namenode clusterID = CID-1745a89c-fb08-40f0-a14d-d37d01f199c3; datanode clusterID = CID-bb3547b0-03e4-4588-ac25-f0299ff81e4f
at org.apache.hadoop.hdfs.server.datanode.DataStorage .doTransition(DataStorage.java:391)
at org.apache.hadoop.hdfs.server.datanode.DataStorage .recoverTransitionRead(DataStorage.java:191)
at org.apache.hadoop.hdfs.server.datanode.DataStorage .recoverTransitionRead(DataStorage.java:219)
at org.apache.hadoop.hdfs.server.datanode.DataNode.in itStorage(DataNode.java:850)
at org.apache.hadoop.hdfs.server.datanode.DataNode.in itBlockPool(DataNode.java:821)
at org.apache.hadoop.hdfs.server.datanode.BPOfferServ ice.verifyAndSetNamespaceInfo(BPOfferService.java: 280)
at org.apache.hadoop.hdfs.server.datanode.BPServiceAc tor.connectToNNAndHandshake(BPServiceActor.java:22 2)
at org.apache.hadoop.hdfs.server.datanode.BPServiceAc tor.run(BPServiceActor.java:664)
at java.lang.Thread.run(Thread.java:722)
2013-04-11 16:26:16,212 WARN org.apache.hadoop.hdfs.server.datanode.DataNode: Ending block pool service for: Block pool BP-474150866-127.0.1.1-1365686732002 (storage id DS-317990214-127.0.1.1-50010-1365505141363) service to localhost/127.0.0.1:8020
2013-04-11 16:26:16,276 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Removed Block pool BP-474150866-127.0.1.1-1365686732002 (storage id DS-317990214-127.0.1.1-50010-1365505141363)
2013-04-11 16:26:18,396 WARN org.apache.hadoop.hdfs.server.datanode.DataNode: Exiting Datanode
2013-04-11 16:26:18,940 INFO org.apache.hadoop.util.ExitUtil: Exiting with status 0
2013-04-11 16:26:19,668 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: SHUTDOWN_MSG:
/************************************************** **********
SHUTDOWN_MSG: Shutting down DataNode at user-VirtualBox/127.0.1.1
************************************************** **********/ 
```

有任何想法吗？可能是我在安装过程中犯了错误吗？但奇怪的是，它曾经工作过。我还不得不说，如果我以我的附加用户身份登录以执行命令`./hadoop-daemon.sh` `start namenode`并且与 datanode 相同，我需要添加 sudo。

我使用了这个安装指南：http: [//jugnu-life.blogspot.ie/2012/0...rial-023x.html](http://jugnu-life.blogspot.ie/2012/0...rial-023x.html)

顺便说一句，我使用的是 Oracle Java-7 版本。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2013-04-16T01:37:29.790

问题可能是集群建立后namenode被格式化而datanodes没有被格式化，所以slave仍然指的是旧的namenode。

我们必须在本地文件系统上为数据节点删除并重新创建文件夹 /home/hadoop/dfs/data。

*   检查您的 hdfs-site.xml 文件以查看 dfs.data.dir 指向的位置
*   并删除该文件夹
*   然后重启机器上的datanode守护进程

上述步骤应重新创建文件夹并解决问题。

如果上述说明不起作用，请分享您的配置信息。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-01-18T07:21:27.423

DataNode 因不兼容的 Clusterid 而死。解决这个问题 如果您使用的是 hadoop 2.X，那么您必须删除您在 hdfs-site.xml 中指定的文件夹中的所有内容 - “dfs.datanode.data.dir”（但不是文件夹本身）。

ClusterID 将保存在该文件夹中。删除并重新启动 dfs.sh。这应该工作！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-03-24T14:21:28.967

1.  您需要删除
    **C:\hadoop\data\dfs\datanode**和
    **C:\hadoop\data\dfs\namenode**文件夹。

如果您没有此文件夹 - 打开您的**C:\hadoop\etc\hadoop\hdfs-site.xml**文件并获取此文件夹的路径以供下次删除。对我来说，它说：

```
<property>
    <name>dfs.namenode.name.dir</name>
    <value>file:/hadoop/data/dfs/namenode</value>
</property>
<property>
    <name>dfs.datanode.data.dir</name>
    <value>file:/hadoop/data/dfs/datanode</value>
</property> 
```

2.  **运行格式名称节点的命令**
    `c:\hadoop\bin>hdfs namenode -format`

现在它应该工作了！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-10-14T22:45:04.393

我认为在不删除数据目录的情况下这样做的推荐方法是简单地更改数据节点的 VERSION 文件中的 clusterID 变量。

如果您查看您的守护进程目录，您将看到 datanode 目录示例

```
data/hadoop/daemons/datanode 
```

VERSION 文件应如下所示。

```
cat current/VERSION 
#Tue Oct 14 17:31:58 CDT 2014
storageID=DS-23bf7f3a-085c-4531-808f-801ff6d52d14
clusterID=CID-bb3547b0-03e4-4588-ac25-f0299ff81e4f
cTime=0
datanodeUuid=63154929-ae68-4149-9f75-9a6558545041
storageType=DATA_NODE
layoutVersion=-55 
```

您需要将 clusterId 更改为消息输出中的第一个值，因此在您的情况下，这将是 CID-1745a89c-fb08-40f0-a14d-d37d01f199c3 而不是 CID-bb3547b0-03e4-4588-ac25-f0299ff81e4f

更新后的版本应该像这样显示更改后的 clusterId

```
 cat current/VERSION 
    #Tue Oct 14 17:31:58 CDT 2014
    storageID=DS-23bf7f3a-085c-4531-808f-801ff6d52d14
    clusterID=CID-1745a89c-fb08-40f0-a14d-d37d01f199c3
    cTime=0
    datanodeUuid=63154929-ae68-4149-9f75-9a6558545041
    storageType=DATA_NODE
    layoutVersion=-55 
```

重新启动 hadoop，datanode 应该可以正常启动。

# c++ - 日食“crossGCC”

> ID：16020338
> 
> 赞同：5
> 
> 时间：2013-04-15T16:36:52.870
> 
> 标签：c++, gcc, cygwin, eclipse-cdt, cross-compiling

我刚刚下载了适用于 C/C++ 的 Eclipse IDE（在 Window 7 上）并尝试创建一个简单的新项目。在工具链中有“Cross GCC”、“Cygwin GCC”和“Microsoft Visual C++”。

我以前从未听说过“Cross GCC”。“Cross GCC”和“CygwinGCC”与普通的“GCC”有什么不同？

--ABS

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T16:50:04.373

如果您对 Windows 环境中的“普通 GCC”感兴趣，可能值得安装 MinGW（带有 MSYS）而不是 Cygwin。这是关于“Cygwin vs MinGW”的一个很好的讨论，所以你可以选择合适[的 Cygwin 和 MinGW 有什么区别？](https://stackoverflow.com/questions/771756/what-is-the-difference-between-cygwin-and-mingw)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-28T22:00:42.580

> 除非您在自己的操作系统上进行开发，否则您需要使用交叉编译器。编译器必须知道正确的目标平台（CPU、操作系统），否则你会遇到麻烦。如果您使用系统附带的编译器，那么编译器将不知道它正在完全编译其他东西。

例如，如果你想用你的 windows 或 mac 机器为 Raspberry Pi、Beagle-bone 或一些 arm cortex M4 嵌入式处理器等编译一些东西（假设你正在为 PC/mac 使用 Intel 处理器）你的编译器需要知道您正在为这些处理器编码或构建某些东西，并且您的编译器必须具有这些工具链定义才能编译，并且在这些情况下编译器将交叉编译。

# jquery - jquery在鼠标滚动事件上动画水平滚动

> ID：16020341
> 
> 赞同：0
> 
> 时间：2013-04-15T16:36:55.417
> 
> 标签：jquery, css, html, horizontal-scrolling, mousewheel

我一直在为 div 制作这个动画水平偏移，在`mousescroll`事件中。这是我到目前为止所做的链接，有人可以看到我做错了什么吗？

动画发生在单击动作上，鼠标滚动我需要相同的动作。 [http://jsfiddle.net/laksdesign/WvRR6/](http://jsfiddle.net/laksdesign/WvRR6/)

```
jQuery(document).ready(function($) {

    $(".scroll").click(function(event) {
        event.preventDefault();
        $('#wrapper').animate({ scrollLeft: $('#wrapper').scrollLeft() + $(this.hash).offset().left }, 800);
    });

    $('body').bind('mousewheel', function(scroll){
        if(scroll.originalEvent.wheelDelta /120 > 0) {
            scroll.preventDefault();
            $('#wrapper').animate({ scrollLeft: $('#wrapper').scrollLeft() + $(this.hash).offset().left }, 800);
        } else{

        }
    });
}); 
```

还有另一个参考是我基于 mousescroll 制作的动画是：http: [//jsfiddle.net/laksdesign/EATaU/](http://jsfiddle.net/laksdesign/EATaU/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:50:18.217

为了`mousescroll`在 jQuery 中捕获事件，您需要使用插件或一些外部函数。我建议使用插件而不是重新发明轮子。请注意，在您提供的参考中，小提琴是如何使用`mousewheel.js`文件的——这就是您需要使用的插件。

有关如何使用插件的更多信息，请参阅[此答案](https://stackoverflow.com/a/8189866/973578)

您可以使用的示例插件：

*   [**BrandonAaron.com**](https://www.google.com/search?q=brandonAaron%20mousewheel&aq=f&oq=brandonAaron%20mousewheel&aqs=chrome.0.64j0l3j60j62.6277j0&sourceid=chrome&ie=UTF-8) - 我不能链接到这个网站，所以用谷歌代替。

您可以这样使用插件：

```
// using bind
$('#my_elem').bind('mousewheel', function(event, delta) {
    console.log(delta);
}); 
```

正如用户`@Dom`在上面的评论中建议的那样，另一个广泛使用的插件是：

*   [**jQuery 鼠标滚轮**](https://raw.github.com/brandonaaron/jquery-mousewheel/master/jquery.mousewheel.js)

# c# - 特定文件夹的文件删除

> ID：16020344
> 
> 赞同：1
> 
> 时间：2013-04-15T16:37:20.400
> 
> 标签：c#, .net

```
String userName = System.Security.Principal.WindowsIdentity.GetCurrent().Name;
String dr = @"C:\Users\" + userName + @"\AppData\temp";

 DirectoryInfo dir = new DirectoryInfo(@dr);
 foreach (FileInfo file in dir.GetFiles())
 {
     file.Delete();
 }
 foreach (DirectoryInfo dire in dir.GetDirectories())
 {
     dire.Delete(true);
 } 
```

我正在使用它来删除文件夹的内容，这应该取决于计算机的用户名，并且我提供了管理员权限
，但是当任何文件没有删除时，它就会停止在该文件上工作。我希望这个过程完成

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:40:27.990

您必须在文件删除语句周围添加 try/catch 块，以便即使您遇到异常，您的循环也会继续。我建议您在调用 delete 时记录引发异常的文件列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:41:33.200

如果其中一个文件不会删除，则调用`file.Delete()`将引发异常。

如果要处理它，则必须将其包装在 try/catch 中，如下所示：

```
foreach (FileInfo file in dir.GetFiles())
{
    try
    {
        file.Delete();
    }

    catch (IOException exception)
    {
        // Here you should log the exception.Message
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T16:42:40.780

```
String userName = System.Security.Principal.WindowsIdentity.GetCurrent().Name;
String dr = @"C:\Users\" + userName + @"\AppData\temp";
DirectoryInfo dir = new DirectoryInfo(@dr);
foreach (FileInfo file in dir.GetFiles())
{
    try
    {
        file.Delete();
    }
    catch (IOException ex)
    {//Log ex.message
        continue;
    }
}
foreach (DirectoryInfo dire in dir.GetDirectories())
{
    try
    {
        dire.Delete();
    }
    catch (IOException ex)
    { //Log ex.message
        continue;
    }
} 
```

此外，我建议您最好使用[Path.Combine()](http://msdn.microsoft.com/en-us/library/system.io.path.combine.aspx)而不是连接字符串。

# jquery - jquery显示一个div，我哪里错了

> ID：16020347
> 
> 赞同：0
> 
> 时间：2013-04-15T16:37:29.043
> 
> 标签：jquery

我有下面的代码

```
 <div id="display_form">
    <script type="text/javascript">     
        $(document).ready(function () {
            $('#display_form_button').on('click', function () {
                 $('#main_content').show();
            });
        });
    </script>
    <asp:Button id="display_form_button" runat="server" Text="Create Form" CssClass="create_form_button"/>
</div> 
```

然后我有一个包含大量内容的 div，例如表格等

```
 <div id="main_content">
        tables etc
     </div> 
```

在我`display:none;`为 main_content 的 id 设置的 css 中，因此当页面加载时它不会出现。然后我希望它在我单击按钮时出现。我一直在谷歌搜索和搜索堆栈溢出有一段时间了，但似乎无法正确处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:38:55.100

You show the `#main_content`, not `#input_form`

Should be:

```
$('#input_form').show(); 
```

Also, your click event is on an element with id `#create_form_button`... so the button needs to have that ID, not class. So change that to:

```
$('#display_form_button').on('click'... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:39:31.307

The button's id is `display_form_button` yet in the jquery code you are doing `$('#create_form_button')`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T16:52:18.880

您的代码没有任何问题，如果您单击`Button`它会显示`DIV`但它会重新加载页面，所以`DIV`变成`Invisible`..

添加`Return false;`您的 JQuery 并尝试相同的操作。

```
 $(document).ready(function () {
        $('#ContentPlaceHolder1_display_form_button').on('click', function () {
            $('#main_content').show();
            return false;
        });
    }); 
```

# android - 使用 sqlite 将单词替换为字符串中的另一个单词

> ID：16020348
> 
> 赞同：2
> 
> 时间：2013-04-15T16:37:37.293
> 
> 标签：android, performance, sqlite

我想执行一个简单的查询，但需要很多时间。在我的表中，有 3 个列：

id（int）针（字符串）字（字符串）

needle 可以是任何类型的字符，并且不是英文的。

word 也是任何类型的字符，并且不是英语。

有 3000 行。

我可以通过简单的查询将针替换为单词。但是速度很慢，100字大约需要2s。我可以通过什么方式提高速度？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:39:14.417

> I can replace needle to word by simple query. but it is very slow, takes about 2s for 100 words. In what way can i improve the speed? thanks

I suggest you to wrap your update statements into one `TRANSACTION` that rapidly increase your performance(tested by myself).

At first it rapidly increase your performace and second also your dealing with database becomes much more safer.

Here is basic snippet of **pseudo-code**:

```
try {
   db.beginTransaction(); // starting transaction
   // perform updates
   db.setTransactionSuccessful(); // marks transaction successful i.e. commit()
}
finally {
   if (db != null) {
      if (db.inTransaction()) {
         db.endTransaction();
      }
      db.close();
   }
} 
```

# flyway - Flyway 在 db/migration 中找不到我的 sql 迁移

> ID：16020351
> 
> 赞同：10
> 
> 时间：2013-04-15T16:37:42.967
> 
> 标签：flyway

错误：[错误] com.googlecode.flyway.core.api.FlywayException：无法确定类路径位置的 URL：db/migration (ClassLoader: ClassRealm [plugin>com.googlecode.flyway:flyway-maven-plugin:2.1\. 1、父级：sun.misc.Launcher$AppClassLoader@43be2d65])

我遵循了快速入门，所以我还没有真正做任何复杂的事情。

**pom.xml**

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <groupId>com.cpt.migrations</groupId>
  <artifactId>cpt_migrations</artifactId>
  <version>1.0-SNAPSHOT</version>
  <packaging>jar</packaging>

  <name>cpt_migrations</name>
  <url>http://maven.apache.org</url>

  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
  </properties>

  <dependencies>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>3.8.1</version>
      <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>5.1.24</version>
    </dependency>
  </dependencies>
  <build>
      <plugins>
          <plugin>
              <groupId>com.googlecode.flyway</groupId>
              <artifactId>flyway-maven-plugin</artifactId>
              <version>2.1.1</version>
              <configuration>
                  <user>root</user>
                  <password></password>
                  <driver>com.mysql.jdbc.Driver</driver>
                  <url>jdbc:mysql://localhost:3306/cpt</url>
              </configuration>
          </plugin>
      </plugins>
  </build>
</project> 
```

而我的文件夹结构是规定的PROJECT_ROOT/src/main/resources/db/migration/V1__Base_version.sql：

当我从 PROJECT_ROOT 执行时出现错误：mvn flyway:migrate

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-15T19:00:21.863

不要忘记先调用 compile，以确保复制资源。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-10-22T12:32:10.553

就我而言，我必须明确设置

```
flyway.locations=classpath:db/migration 
```

在我的 application.properties (Spring Boot) 中让它工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-05-29T22:24:56.050

在我的情况下，这个错误是由于`db.migration`创建了带有名称的包而不是`db`->`migration`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-21T12:54:12.900

它必须编译：

```
mvn compile flyway:migrate 
```

您可以使用

```
<executions>
          <execution>
            <id>compile</id>
            <phase>compile</phase>
            <goals>
              <goal>migrate</goal>
            </goals>
          </execution>
          <execution>
            <id>clean</id>
            <phase>clean</phase>
            <goals>
              <goal>clean</goal>
            </goals>
          </execution>
        </executions> 
```

在

```
<plugin>..</plugin> 
```

然后只需要 mvn compile 来执行迁移任务

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-07-18T18:54:44.610

从目标目录所在的目录执行 mvn 命令。

# java - 指向一个hashSet java

> ID：16020357
> 
> 赞同：2
> 
> 时间：2013-04-15T16:37:57.827
> 
> 标签：java, pointers, hashset

我将如何编写一个 if 语句： if pos2[targetPos3] doesn't point to a hashset (is not a hashset) ？我试过了，但它仍然给了我一个空点异常。

```
Object[] pos2;
int targetPos3;
targetPos3 = word.charAt(2) - 'a';

if(pos2[targetPos3] != (HashSet<String>) pos2[targetPos3]){
   System.out.println("Sorry");
 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:39:56.733

试试这个：

```
if(!(pos2[targetPos3] instanceof HashSet)){
    System.out.println("Sorry");
} 
```

由于[*类型 erasure*](https://stackoverflow.com/q/339699/335858) ，无法查看它是否是`HashSet`of （或任何其他类型） 。`String`[](https://stackoverflow.com/q/339699/335858)

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:40:03.177

`instanceof`接线员会在这里为您提供帮助。它可以告诉你对象是否是 a `HashSet`，但由于[类型擦除](http://docs.oracle.com/javase/tutorial/java/generics/erasure.html)，在运行时，你将无法判断它是否是 a `HashSet<String>`，只是如果它是 a `HashSet`。

```
if (!(pos2[targetPos3] instanceof HashSet)) { 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T16:40:06.263

在 Java 中使用[**instanceof 运算符。**](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op2.html)

```
if (!(pos2[targetPos3] instanceof HashSet)) {
   // ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T16:40:44.890

`instanceof`是您要查找的运算符：

```
if(! pos2[targetPos3] instanceof HashSet){
    System.out.println("Sorry");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-15T16:41:01.007

你想用`instanceof`. 例如：

```
if(pos2[targetPos3] instanceof HashSet) {
    ...
} 
```

但是，您还需要实例化您的数组并进行边界检查。所以：

```
pos2 = new Object[desiredLength];

if((targetPos3 < pos2.length) && (pos2[targetPos3] instanceof HashSet)) {
    ...
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-15T16:41:34.043

你不做任何错误检查。

```
if(targetPos3 < pos2.length){   
   if(!(pos2[targetPos3] instanceof HashSet)){
      System.out.println("Sorry");
   }
} 
```

还要检查`word != null`.
您需要的是`instanceof`操作员来验证您是否真的有一个`HashSet`*

# html - Horizontal Top Menu and Sitemap

> ID：16020363
> 
> 赞同：0
> 
> 时间：2013-04-15T16:38:16.640
> 
> 标签：html, css

I'm trying to pick up some CSS as I try to make temporary styling for this site while they find their stylesheet: [http://faq.travelbelize.org/travel_belize](http://faq.travelbelize.org/travel_belize)

The priority is to get the menu and sitemap cleaned up (both have the class of "menu"), but I'm having trouble making them display horizontally.

I've tried:

```
.menu {
display: inline
list-style-type: none
} 
```

Do I need to be more specific with my CSS selector? I've also tried it with .menu ul li without luck. I've also played with padding, margins, display: list-item, and floats without luck.

# ruby - RubyFiddle 问题 - NameError: undefined local variable or method 'gets' for #

> ID：16020365
> 
> 赞同：0
> 
> 时间：2013-04-15T16:38:17.540
> 
> 标签：ruby, input, io, gets

```
class SqrrtProg

  def hello

    puts "Hello! Welcome to the square root program."
    puts "\n Please enter a number: "
    number = gets
    puts number

  end

  def Sqrrt

  end

end

object = SqrrtProg.new
object.hello 
```

我只是想使用'gets'来获取用户输入。我读过这可能是因为默认情况下会尝试从文件中读取信息。我尝试过 name = $stdin.gets 和 name = &stdin.gets.chomp 等......但是，我最终遇到了同样的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T13:08:23.937

我将回答我自己的问题，因为它已经解决了。从终端运行时代码很好。这个问题显然源于 RubyFiddle 的限制。希望这个问题可以帮助遇到与 RubyFiddle 环境相同的问题的人:)

# c++ - 在事先不知道实例的情况下使用函数指针

> ID：16020366
> 
> 赞同：1
> 
> 时间：2013-04-15T16:38:20.047
> 
> 标签：c++, function-pointers

以以下*为例*：（注意，该示例不起作用，但应该足以说明我要做什么）

```
class Point {
    float x, y;
public:
    float getX() const { return x; }
    float getY() const { return y; }
};

class Polygon {
    std::vector<Point> points;

    std::vector<float> get(float (Point::*func)()const) {
        std::vector<float> ret;
        for(std::vector<Point>::iterator it = points.begin(); it != points.end(); it++) {
            // call the passed function on the actual instance
            ret.push_back(it->*func());
        }
        return ret;
    }

public:
    std::vector<float> getAllX() const {
        return get(&Point::getX); // <- what to pass for getX
    }
    std::vector<float> getAllY() const {
        return get(&Point::getY); // <- what to pass for getY
    }
}; 
```

**编辑：**

问题是操作顺序；编译器需要在调用周围加上括号，如下所示：

```
(it->*func)() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:45:41.087

看起来您想使用“指向成员函数的指针”，它使用以下语法：

```
class Point {
    float x, y;
public:
    float getX() const { return x; }
    float getY() const { return y; }
};

class Polygon {
    std::vector<Point> points;

    std::vector<float> get(float (Point::*func)()) { // !!! NEW SYNTAX - POINTER TO MEMBER
        std::vector<float> ret;
        for(std::vector<Point>::iterator it = points.begin(); it != points.end(); it++) {
            // call the passed function on the actual instance
            ret.push_back((it->*func)()); // !!! ADDED PARENTHESES
        }
        return ret;
    }

public:
    std::vector<float> getAllX() const {
        return get(&Point::getX); // !!! POINTER TO MEMBER
    }
    std::vector<float> getAllY() const {
        return get(&Point::getY); // !!! POINTER TO MEMBER
    }
}; 
```

免责声明：未经测试。

此外，您可能想查看中的`<functional>`库`C++11`；这对这样的事情非常好。

这就是我个人处理这种情况的方式：

```
#include <functional>
#include <vector>
#include <algorithm>

class Point {
    float x, y;
public:
    float getX() const { return x; }
    float getY() const { return y; }
};

class Polygon {
    std::vector<Point> points;

    std::vector<float> get(std::function<float(const Point&)> func) const {
        std::vector<float> ret(points.size());
        std::transform(points.begin(), points.end(), ret.begin(), func);
        return ret;
    }

public:
    std::vector<float> getAllX() const {
        return get(std::mem_fn(&Point::getX));
    }

    std::vector<float> getAllY() const {
        return get(std::mem_fn(&Point::getY));
    }
}; 
```

免责声明：编译，但未经测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:51:58.237

在你的程序中改变了很多东西。指向成员语法的指针与指向函数语法的指针并不完全相同。

我使用了 C++ 中的 typedef 和宏来简化它

[http://www.parashift.com/c++-faq/typedef-for-ptr-to-memfn.html](http://www.parashift.com/c++-faq/typedef-for-ptr-to-memfn.html)

[http://www.parashift.com/c++-faq/macro-for-ptr-to-memfn.html](http://www.parashift.com/c++-faq/macro-for-ptr-to-memfn.html)

```
class Point {
    float x, y;
public:
    float getX() const { return x; }
    float getY() const { return y; }
};

// This typedef makes is easier to declare a pointer to a member method
typedef float (Point::*PointPtr)() const;
// This macro makes it easier to call through a member function pointer.
#define CALL_MEMBER_FN(object,ptrToMember)  ((object).*(ptrToMember))

class Polygon {
    std::vector<Point> points;

    // Made this a const function. And changed the parameter type.
    std::vector<float> get(PointPtr func) const {
        std::vector<float> ret;

        // Made this a const iterator
        for(std::vector<Point>::const_iterator it = points.begin(); it != points.end(); it++) {
            // Changed the call to use the macro
            ret.push_back(CALL_MEMBER_FN((*it), func)());
        }
        return ret;
    }

public:
    std::vector<float> getAllX() const {
        return get(&Point::getX); 
    }
    std::vector<float> getAllY() const {
        return get(&Point::getY;);
    }
}; 
```

解释了评论中的变化。

# html - HTML 文本字段和按钮看起来比指定的大

> ID：16020367
> 
> 赞同：0
> 
> 时间：2013-04-15T16:38:22.367
> 
> 标签：html, css, forms, input

我正在我自己的一个项目中实现 UI 设计，看起来我的 CSS 有很大的问题。

据我所知，我已经为输入类型指定了样式：文本，CSS 接受的按钮：

```
body input[type=text]{
    border:1px solid #208278;
    height:24px;
    padding-left: 5px;
}
body button{
    background-color: #279A8F;
    border:0px;
    color:white;
    height:24px;
}
body input[type=password]{
    border:1px solid #208278;
    height:24px;
    padding-left: 5px;
}
body input[type=submit], input[type=button]{
    background-color: #279A8F;
    border:0px;
    color:white;
    height:24px;
} 
```

在登录页面上，字段的高度似乎是 24px，而在我登录后，我看到所有字段都变大了，高度超过了 24px。我没有任何线索。有一点是在登录后，字段存在于具有一些填充和边距的容器中，但我看不出这会如何影响字段的任何原因。这个问题一直让我发疯，有人可以提供一些见解吗？

放置表单域的容器如下：

```
#container{
    width:1100px;
    margin: 0 auto;
}
#leftbar{
    float:left;
    width:200px;
    font-size:13px;
    background-color:#237971;
    color:white;
    padding:4px;
}
#rightbar{
    float:right;
    width:200px;
    font-size: 13px;
    background-color:#237971;
    color:white;
    padding:4px;
}
#middlebar{
    padding:5px;
    margin-left:3px;
    margin-right:3px;
    float:left;
    width:660px;
    border:1px solid black;
} 
```

登录页面HTML代码：

```
<html>
<head>
    <link rel=stylesheet type=text/css href="<?php echo base_url('layout/layout.css');?>" media="all">
    <title>
        My Page
    </title>

</head>
<body>
<div id=header>
    &nbsp;&nbsp;&nbsp;Welcome
</div>
<?php echo validation_errors(); ?>

<?php echo form_open('login/verify'); ?>
<table>
    <tr>
        <td align="right"><label for="email">E-Mail:</label></td>
        <td align="left"><input type="text" name="email" id="email" value="<?=set_value('email')?>"></td>
    </tr>
    <tr>
        <td align="right"><label for="password">Password:</label></td>
        <td align="left"><input type="password" name="password" id="password"></td>
    </tr>
    <tr>
        <td></td>
        <td align="left"><input type="submit" name="submit" value="Login"></td>
    </tr>
</table>
 </form>
<br/>
<a href="<?php echo base_url();?>signup/signup">Sign up</a> for a new account<br/>
</body>

</html> 
```

会员区HTML代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script src="<?php echo base_url('js/jquery-1.9.1.js'); ?>"></script>
    <script src="<?php echo base_url('js/jquery-ui/js/jquery-ui-1.10.2.custom.js'); ?>"></script>
    <link rel="stylesheet" type="text/css" href="<?php echo base_url('js/jquery-ui/css/customjqueryui/jquery-ui-1.10.2.custom.css');?>">

    </script>
    <link rel=stylesheet type=text/css href="<?php echo base_url('layout/layout.css');?>">
    <title>Welcome</title>
</head>
<body>
<div id=container>
    <div id=header>
        &nbsp;&nbsp;&nbsp;Members area
    </div>

    <div id="leftbar">
        <div class=content><a href="<?php echo base_url();?>user/home/logout">Logout</a></div></div>
    <div id="rightcontainer">
        <div id="middlebar">
            <?php echo validation_errors();?>
            <?php echo form_open_multipart('home/create/validate'); ?>
            <table>
                <tr>
                    <td align="right"><label for="fullname">full Name:</label></td>
                    <td align="left"><input type="text" name="fullname"></td>
                </tr>

<tr>
                    <td></td>
                    <td><input type="submit" name="finish" value="Finish"></td>
                </tr>
            </table>

        </div>
        <div id="rightbar"></div>
    </div>
</div>

</body>

</html> 
```

成员区域中的所有字段都显示为大于 24 像素。：（ 请帮我！

非常感谢您提前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T16:06:52.197

找出主要错误，我没有在我的 HTML 代码中使用以下语句标准化登录页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
```

# lucene - 在 Lucene 中搜索具有角色的公共和私人文档

> ID：16020369
> 
> 赞同：1
> 
> 时间：2013-04-15T16:38:36.517
> 
> 标签：lucene, umbraco, lucene.net

我目前正在尝试在 Lucene（来自 Umbraco）中构建一个搜索，它搜索公共文档和受保护的文档，这些文档只能由用户的角色看到。我遇到的问题是 Lucene 返回所有公共项目和所有受保护项目，但不是按角色。

我的原始 Lucene 搜索是：

```
+nodeTypeAlias:pdfdocument +isProtected:false (+rolesAllowed:"userrole" +isProtected:true) 
```

有没有人有任何想法？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:57:56.027

您的查询并没有真正按照您的意图进行。

`+nodeTypeAlias:pdfdocument`查询将只返回 pdfdocuments。

`+isProtected:false`查询将只返回公共文档

`(+rolesAllowed:"userrole" +isProtected:true)`查询将更喜欢但不要求匹配“用户角色”的文档，这些文档是受保护的。然而，由于上述术语阻止了受保护文档的任何匹配，我们不应该看到这一点。

或者，以不同的方式重写（您的查询不严格映射到 AND/OR 语法）：

```
nodeTypeAlias:pdfdocument AND isProtected:false AND OPTIONALLY (rolesAllowed:"userrole" AND isProtected:true) 
```

我相信您正在寻找的查询更像是：

```
+nodeTypeAlias:pdfdocument +(isProtected:false (+rolesAllowed:"userrole" +isProtected:true)) 
```

顺便说一句，这可以重写为：

```
nodeTypeAlias:pdfdocument AND (isProtected:false OR (rolesAllowed:"userrole" AND isProtected:true)) 
```

不过，这并不能真正解释您描述的行为。如果它返回所有文档，包括公共文档和受保护文档，我怀疑您需要查看该`isProtected`字段中实际存储的内容。该字段必须包含`false`才能匹配您列出的查询。它可能包含多个术语，可能同时包含`false`和`true`。

# google-chrome-extension - Chrome如何计算书签的写操作

> ID：16020374
> 
> 赞同：0
> 
> 时间：2013-04-15T16:38:43.557
> 
> 标签：google-chrome-extension, bookmarks

我正在开发一个需要创建许多书签和文件夹的 Google Chrome 扩展程序。

我的问题是，我不明白 Chrome 如何计算受`chrome.bookmarks.MAX_SUSTAINED_WRITE_OPERATIONS_PER_MINUTE`.

上周，我在一个循环中创建了大约 1000 个书签来测试该限制——所有书签都已创建，之后我也可以使用 API 删除它们。
今天我还测试了一个扩展，它从 Pinboard 同步了我所有的 ~500 个书签 - 没有任何问题。

但是现在（在开发过程中进行了一些写操作之后）我在每个写操作上都收到一个错误，告诉我已经超过了限制。即使经过约 30 分钟的等待并且没有接触 API。

所以我的问题是：谷歌如何计算这些操作/它何时阻止我的操作？为什么它没有阻止即插板扩展？

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-16T11:52:51.457

Chrome 会维护一个内存中超出配额的扩展黑名单。OP 预计此黑名单将在规定期限后被删除。这不会发生。黑名单永远不会被清除。但是它只存在于内存中，因此杀死并重新启动浏览器将清除它，并且扩展程序将再次运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T04:01:43.820

你可能被禁止了。了解 chrome.bookmarks 和 chrome.storage 涉及通过同步使用服务器端资源。当您创建大量请求时，它不仅会影响您自己的机器；它也会影响同步服务器。

因为限制是为了防止滥用/错误并帮助为所有用户提供可靠的服务，所以没有人会给你比官方文档更好的答案。施虐者会利用这些信息为自己谋取利益。我知道您并没有试图滥用同步服务，但其他人可能会这样做，这就是为什么真正的限制没有在任何地方发布的原因。

# c - execl 命令写入文件

> ID：16020375
> 
> 赞同：0
> 
> 时间：2013-04-15T16:38:48.473
> 
> 标签：c, unix, exec

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#define MAXLINE 512
main(int argc,char* argv[]){
    int k;

    for (k=0; k<argc; k++) {
        if (k%2==0) {
            if (fork()==0){
                execl("/user/bin/rev","rev",argv[k],">",argv[k],NULL);
                exit(1);
            }
        }
        else
         {
         if (fork()==0){
         execl("/usr/bin/awk","awk","-f","ouk.awk",argv[k],">",argv[k],NULL);
         exit(1);

         }
             wait(0);
    }

}
} 
```

awk 脚本

```
{ for (i=NF;i>=1;i--){ if(s){s=s" "$i} else{s=$i }}{print s;s=""}} 
```

有人可以告诉为什么这不起作用吗？我要做的是使用 awk 脚本或 rev 命令修改文件 argv[i]

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:18:44.453

要让管道 ( `>`) 工作，需要涉及外壳。OP 的代码不调用 shell，而是`awk`直接启动进程。

您可能想替换这一行：

```
execl("/usr/bin/awk","awk","-f","ouk.awk",argv[k],">",argv[k],NULL); 
```

由那些：

```
char cmd[PATHMAX] = "";
sprintf(cmd, "\"/usr/bin/awk -f out.awk %s > %s\"", argv[k], argv[k]);
execl("/bin/sh", "sh", "-c", cmd, (char *) NULL);
/* As execl() does not return if successful, getting here indicates an error! */
perror("execl() failed"); 
```

（这意味着 引用的字符串`argv[k]`不包含空格。）

有关详细信息，请参阅您的 shell 的手册页。请注意，`/bin/sh`通常链接到其他一些 shell 程序，例如`bash`.

# jquery - JQuery Mobile 列表/详细视图

> ID：16020384
> 
> 赞同：0
> 
> 时间：2013-04-15T16:39:27.357
> 
> 标签：jquery, jquery-mobile

我有一个看起来像这样的 JQuery Mobile List 视图：

```
 {
     "title": "Available Cars",
     "names": [
         {
             "name": "Ford",
             "image": "./images/ford.png",
             "flags": "./images/us.png",
             "description": "Make Average Cars",
             "detail": [
                 {
                     "Profile": "Big US company",
                     "Background": "Started some time ago"
                 }
             ]
         },
         {
             "name": "BWM",
             "image": "./images/bmw.png",
             "flags": "./images/gm.png",
             "description": "Make Great Cars",
             "detail": [
                 {
                     "Profile": "MediumGermancompany",
                     "Background": "Startedsometimeago"
                 }
             ]
         },
         {
             "name": "VW",
             "image": "./images/vw.png",
             "flags": "./images/gm.png",
             "description": "MakeGoodCars",
             "detail": [
                 {
                     "Profile": "LargeGermancompany",
                     "Background": "Startedsometimeago"
                 }
             ]
         }
     ]
 } 
```

这个 JSON 正在使用我的模板库动态呈现为适当的 HTML，该模板库根据第一级中的名称和关联图像创建一个简单的列表视图。

我想将“描述”中的数据：部分呈现为数据的详细视图。因此，当单击列表项时，它会转换到详细视图。

由于我已经拥有了所有必需的数据，因此我不需要向服务器发出进一步的请求。

我已经完成了第一部分，这是一个 jsfiddle 显示它的工作原理：

[http://jsfiddle.net/carlskii/7WK7P/30/](http://jsfiddle.net/carlskii/7WK7P/30/)

有人可以建议一种方法来做到这一点，因为在这里似乎找不到任何像样的例子！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T17:16:44.050

好吧，既然[jQuery Mobile 即将弃用嵌套列表，](http://view.jquerymobile.com/1.3.1/dist/demos/widgets/listviews/#list-nested)那么最好的选择是普通的旧导航。创建一个带有所需链接的页面（例如模板中的名称）：

```
<div data-role="page" data-url="/damyanpetev/7WK7P/36/show/light/Ford">
        TEST PAGE FOR FORD
</div> 
```

并将项目模板中的“href”也设为名称，它将导航并保留历史堆栈和所有优点:) 请参阅[AJAX NAvigation](http://view.jquerymobile.com/1.3.1/dist/demos/widgets/navigation/)的帮助。

这是我修改过的小提琴：http: [//jsfiddle.net/damyanpetev/7WK7P/36/](http://jsfiddle.net/damyanpetev/7WK7P/36/)（见下文实际演示部分）

PS：jsFiddle让我很难确定链接..所以这只会在所有框架中正确导航 - [http://fiddle.jshell.net/damyanpetev/7WK7P/36/show/light/](http://fiddle.jshell.net/damyanpetev/7WK7P/36/show/light/)

# mongodb - Meteor & mongoDB LIKE 查询

> ID：16020386
> 
> 赞同：8
> 
> 时间：2013-04-15T16:39:30.303
> 
> 标签：mongodb, meteor

我试图从用户搜索的内容中生成查询。我有一个字符串数组，我只想在 mongoDB 选择器中发送，我的问题是 /text/ 语法，它可以从 mongoDB 控制台完美运行，如下所示：

```
Items.find({ $or: [{name: /doc/}, {tags: /doc/}, {name: /test/}, {tags: /test/}] }); 
```

但我无法设法在 javascript 中编写相同的语法，我尝试了几个版本。

```
var mongoDbArr = [];
  searchArray.forEach(function(text) {
    mongoDbArr.push({name: /text/});
    mongoDbArr.push({tags: /text/});
  });
  return Items.find({ $or: mongoDbArr}); 
```

但它只搜索“文本”而不​​是变量中的内容。像这样：

```
var mongoDbArr = [];
  searchArray.forEach(function(text) {
    mongoDbArr.push({name: "/" + text + "/"});
    mongoDbArr.push({tags: "/" + text + "/"});
  });
  return Items.find({ $or: mongoDbArr}); 
```

但这并没有给我任何结果。我错过了什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-15T20:13:07.973

您必须使用 javascript 构建正则表达式：

```
var mongoDbArr = [];
searchArray.forEach(function(text) {
    mongoDbArr.push({name: new RegExp(text)});
    mongoDbArr.push({tags: new RegExp(text,"i")});
});

return Items.find({ $or: mongoDbArr}); 
```

或者使用mongodb的[正则表达式查询：](http://docs.mongodb.org/manual/reference/operator/regex/)

```
mongoDbArr.push({name: { $regex : text, $options:"i" } });
mongoDbArr.push({tags: { $regex : text, $options:"i" } }); 
```

要转义特殊字符，您可以在使用之前执行此操作`text`（来自 JQuery UI 的源代码）

```
text = text.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-15T19:05:33.543

在服务器的发布功能中试试这个：

```
return YourCollection.find({'$or' : [ 
  { 'field1':{'$regex':searchString} },
  { 'field2':{'$regex':searchString} },
  { 'field3':{'$regex':searchString} }, ]
}); 
```

# java - 通过扫描仪将 .txt 重写为数组

> ID：16020389
> 
> 赞同：0
> 
> 时间：2013-04-15T16:39:43.687
> 
> 标签：java, arrays

```
class Materials implements Runnable {
    String path;

    public Materials(String path) {
        this.path = path;
    }

    public int checkSize() throws FileNotFoundException {
        Scanner sc = new Scanner(new File(path));
        int size = 0;
            while(sc.hasNextLine()) size++;
        sc.close();
        return size;
    }

    public void run() {
    try {
        Scanner sc = new Scanner (new File(path));
        int[][] materialsTab = new int[1][checkSize()];
        int x=0, count=0;
        while(sc.hasNext()){
            count++;

            materialsTab[x][0] = sc.nextInt();
            materialsTab[x][1] = sc.nextInt();
            x++;
            System.out.println("Im working!");

            if(count%200 == 0) System.out.println("Creat " + count + " objects");
    }
    sc.close();

    } catch (FileNotFoundException e) {
        e.printStackTrace();
    }

    }
} 
```

我的问题是我必须逐个线程将 .txt 文件重写为一个数组，然后是下一个线程，但我被困在任务的第一部分。

public int checkSize() 负责计算数组的大小，因为文本文件由大约 10 000 行组成。整体看起来就像这样：

[产品编号] [重量]

所以我决定计算行数并创建一个这样的表格，一个我保存 ID 的地方，旁边是重量，因为稍后我将不得不计算一些东西。

此外，每 200 条记录必须出现在消息中。问题是，在开始这部分之后......什么也没有发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:21:25.743

代替

```
int[][] materialsTab ... 
```

考虑使用大致如下的东西：

```
List<Point> materialsTab = new ArrayList<Point>();

Point mat = new Point();
mat.x = sc.nextInt();
if (!sc.hasNext())
    break;
mat.y = sc.nextInt();
materialsTab.add(mat); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:48:36.553

如果我正确理解您的问题，请尝试更改`Runnable`to`Callable<int[]>`和`public void run()`to`public int[] call()`并`return materialsTab;`在最后添加。

# jasper-reports - Sorting report according to parameter in iReport

> ID：16020392
> 
> 赞同：0
> 
> 时间：2013-04-15T16:39:54.507
> 
> 标签：jasper-reports, ireport

I have a simple report with two fields: ID and NAME. I want to sort the detail by ID or NAME depending on a parameter selected by the user in runtime.

I've tried doing something like this:

```
<sortField name="sort" type="Variable"/>

<variable name="sort" class="java.lang.String">
    <variableExpression>
        <![CDATA[$P{ord}.equals("name") ? $F{entity}.getName() : $F{entity}.getId().toString()]]>
    </variableExpression>
</variable> 
```

EDIT 1: I'm passing the datasource as a parameter, I don't execute the sql query from JasperReports. I think I could pass the datasource alredy sorted to JasperReports, but i'd like to sort the data directly from the report.

EDIT 2: I reviewed the previous code and works fine for me.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T06:36:55.947

只需使用默认值“ID”创建一个参数“Sort_order”并在查询中添加 order by 子句。

```
 SELECT...
  FROM..
  ORDER BY $P!{Sort_order} DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-26T12:16:49.487

您可以在 SELECT 中使用 ORDER BY 子句。但是，有时由于内部化或类似的事情，您需要按 jasper 对数据进行排序。解决此问题的一种方法是选择特殊列进行排序（POSTGRESQL）：

```
SELECT 
    id, name,
    (CASE WHEN $P!{Sort_order}='id' THEN id ELSE null END) sort_id,
    (CASE WHEN $P!{Sort_order}='name' THEN name ELSE null END) sort_name
FROM
    your_table; 
```

然后你设置按列排序`sort_name`和`sort_id`

# database - 延迟到 application.conf 中定义的数据源的连接

> ID：16020396
> 
> 赞同：1
> 
> 时间：2013-04-15T16:39:57.800
> 
> 标签：database, scala, configuration, playframework, app-config

假设我有一个名为“awesome”的数据库，它位于实时服务器上，同时在登台服务器上复制以进行测试。我的网络应用程序基于使用 Scala 的 Play 2.1.1。
所以我在*application.conf*文件中定义了这些数据源：

```
db.awesome-test.driver= com.mysql.jdbc.Driver
db.awesome-test.url="jdbc:mysql://127.0.1.1/awesome"
db.awesome-test.user=mr_awesome_tester
db.awesome-test.password=justtesting

db.awesome-live.driver= com.mysql.jdbc.Driver
db.awesome-live.url="jdbc:mysql://127.0.0.1/awesome"
db.awesome-live.user=mr_awesome
db.awesome-live.password=omgthisisawesome 
```

根据我所处的环境，我想使用`DB.withConnection("awesome-test")`或`DB.withConnection("awesome-live")`。我通过配置中的另一个值来控制它；所以我例如放在`environment=awesome-live`那里，然后通过`Play.configuration`.

现在，问题是显然 play 尝试立即创建与配置中定义的每个数据源的数据库连接。A）这取决于我所处的环境。例如在登台机器上我会得到这样的东西（当然图片只是一个模型），因为无法访问实时数据库：

![](https://i.stack.imgur.com/buWMC.png)

...尽管完全没有必要尝试连接到该数据库，因为它永远不会在这种环境中使用。B）即使连接可以工作，当然当只需要两个连接中的一个时创建两个连接（实时和测试）是不可行的。

有没有办法告诉 Play 推迟/推迟数据库连接的创建，直到它真正需要它（例如，何时`DB.getConnection("...")`或`DB.withConnection("...")`某事为该数据源调用）？我在想类似的东西`db.awesome-live.deferCreation=true`。

干杯，亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T07:15:09.803

我会说你有两种方法可以做到这一点。

一切都在戏剧中解释！文档：[附加配置](http://www.playframework.com/documentation/2.1.0/ProductionConfiguration)

### 指定替代配置文件

`test.conf`

```
db.awesome.driver= com.mysql.jdbc.Driver
db.awesome.url="jdbc:mysql://127.0.1.1/awesome"
db.awesome.user=mr_awesome_tester
db.awesome.password=justtesting 
```

`live.conf`

```
db.awesome.driver= com.mysql.jdbc.Driver
db.awesome.url="jdbc:mysql://127.0.0.1/awesome"
db.awesome.user=mr_awesome
db.awesome.password=omgthisisawesome 
```

在代码中你总是使用`DB.withConnection("awesome")`.

启动应用程序

```
$ start -Dconfig.resource=test.conf 
```

或者

```
$ start -Dconfig.resource=live.conf 
```

### 覆盖特定的配置键

在您的情况下，这意味着：

```
$ start -Ddb.awesome-live.deferCreation=true 
```

# html - Images displaying incorrectly in IE8 and earlier

> ID：16020397
> 
> 赞同：1
> 
> 时间：2013-04-15T16:40:00.677
> 
> 标签：html, internet-explorer, css

For some reason images are being displayed as a thin line in IE 8 and earlier and i cannot work out why this could be. I'm using CSS to re-size the images for the homepage, the reason for me using CSS to re-size the images is because the thumnails are being generated by Wordpress.

This is what it looks like in IE...

![IE8 and below - thin images](https://i.stack.imgur.com/KlXch.png)

How it looks in Firefox and all other browsers...

![Firefox and other major browsers](https://i.stack.imgur.com/cgXfO.png)

The CSS i'm using to size the images...

```
.home .attachment-home-post-thumbnail {
    box-shadow: none;
    height: 125px;
    margin-right: 8px;
    margin-top: 8px;
    width: 140px;
} 
```

Any ideas?

# c++ - 可变参数模板和类型安全

> ID：16020403
> 
> 赞同：5
> 
> 时间：2013-04-15T16:40:11.617
> 
> 标签：c++, c++11, variadic-templates, type-safety

可变参数模板 printf 函数有多种实现。一个是这样的：

```
void printf(const char* s) {
  while (*s) {
    if (*s == '%' && *++s != '%') 
      throw std::runtime_error("invalid format string: missing arguments");
    std::cout << *s++;
  }
}

template<typename T, typename... Args>
void printf(const char* s, const T& value, const Args&... args) {
  while (*s) {
    if (*s == '%' && *++s != '%') {
      std::cout << value;
      return printf(++s, args...);
    }
    std::cout << *s++;
  }
  throw std::runtime_error("extra arguments provided to printf");
} 
```

并且到处都说这个实现是类型安全的，而普通的 C（带有可变参数 va_arg）不是。

这是为什么？类型安全是什么意思？与 C printf va_arg 相比，这种实现有什么优势？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T17:02:29.843

对于您传递给可变参数模板版本的所有参数，它们的类型在编译时是已知的。该知识保存在函数中。然后将每个对象传递给`cout`重载的`operator<<`. 对于传递的每种类型，此函数都有一个单独的重载。换句话说，如果你传递一个`int`，它就是调用`ostream::operator<<(int)`，如果你传递一个双精度，它就是调用`ostream::operator<<(double)`。同样，类型被保留。这些函数中的每一个都专门用于以适当的方式处理每种类型。这就是类型安全。

但是，有了 C `printf`，情况就不同了。该类型不保留在函数内部。它需要根据格式字符串的内容（可能是运行时值）来计算。该函数只需假设传入了正确的格式字符串以匹配参数类型。编译器不强制执行此操作。

还有另一种安全性，那就是论点的数量。如果您向 C 函数传递的参数太少`printf`，不足以匹配格式字符串，则您的行为未定义。如果你对可变参数模板做同样的事情，你会得到一个异常，虽然不是可取的，但它是一个更容易诊断的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-15T17:01:53.373

*安全*或*类型安全*意味着您可以通过查看*源代码*来判断您的程序是否正确运行。

该语句`std::cout << x`总是正确的，假设它`x`具有明确定义的值（并且不是，例如，未初始化）；您可以通过查看源代码来保证这一点。

相比之下，C 是*不安全*的：例如，以下代码可能正确也可能不正确，*具体取决于运行时输入*：

```
int main(int argc, char * argv[])
{
    if (argc == 3)
        printf(argv[1], argv[2]);
} 
```

当且仅当第一个参数是一个有效的格式字符串时，这是正确的，它恰好包含一个“ `%s`”。

换句话说，可以编写一个正确的 C 程序，但不可能仅通过检查代码来推断其正确性。该`printf`函数就是一个这样的例子。更一般地说，任何接受可变参数的函数很可能是不安全的，任何基于运行时值转换指针的函数也是如此。

# go - 编写此代码的更好的惯用方式？

> ID：16020406
> 
> 赞同：4
> 
> 时间：2013-04-15T16:40:16.650
> 
> 标签：go

玩弄 go，我把这段代码放在一起：

```
package main

import "fmt"

const N = 10

func main() {
    ch := make(chan int, N)
    done := make(chan bool)

    for i := 0; i < N; i++ {
        go (func(n int, ch chan int, done chan bool) {
            for i := 0; i < N; i++ {
                ch <- n*N + i
            }
            done <- true
        })(i, ch, done)
    }

    numDone := 0
    for numDone < N {
        select {
        case i := <-ch:
            fmt.Println(i)
        case <-done:
            numDone++
        }
    }

    for {
        select {
        case i := <-ch:
            fmt.Println(i)
        default:
            return
        }
    }
} 
```

基本上我有 N 个频道在做一些工作并在同一个频道上报告——我想知道所有频道什么时候完成。所以我有另一个`done`通道，每个工作 goroutine 都会发送一条消息（消息无关紧要），这会导致 main 将该线程计数为已完成。当计数达到 N 时，我们实际上已经完成了。

这是“好”吗？有没有更惯用的方式来做到这一点？

编辑：澄清一下，我很怀疑，因为`done`频道似乎正在做频道关闭似乎是为了做的工作，但我当然不能在任何 goroutine 中真正关闭频道，因为所有例程都共享同一个频道. 所以我`done`用来模拟一个执行某种“缓冲关闭”的通道。

编辑2：原始代码并没有真正起作用，因为有时`done`来自例程的信号在它刚刚放入的 int 之前被读取`ch`。需要一个“清理”循环。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-15T18:43:10.533

这里有一个[sync.WaitGroup](http://golang.org/pkg/sync/#WaitGroup)的惯用用法供大家学习

（[游乐场链接](http://play.golang.org/p/gm8b0syhPW)）

```
package main

import (
    "fmt"
    "sync"
)

const N = 10

func main() {
    ch := make(chan int, N)
    var wg sync.WaitGroup
    for i := 0; i < N; i++ {
        wg.Add(1)
        go func(n int) {
            defer wg.Done()
            for i := 0; i < N; i++ {
                ch <- n*N + i
            }
        }(i)
    }
    go func() {
        wg.Wait()
        close(ch)
    }()
    for i := range ch {
        fmt.Println(i)
    }
} 
```

注意两个goroutine定义中闭包的使用，注意第二条`go`语句等待所有的routine完成，然后关闭通道，所以`range`可以使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T17:08:37.817

看起来你想要一个`sync.WaitGroup`（[http://golang.org/pkg/sync/#WaitGroup](http://golang.org/pkg/sync/#WaitGroup)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T17:07:44.813

只需使用 WaitGroup！它们是内置的原语，本质上让您等待不同 goroutine 中的内容完成。

[http://golang.org/pkg/sync/#WaitGroup](http://golang.org/pkg/sync/#WaitGroup)

至于您的疑问，解决方法是通过关闭通道（永久完成）和工作（暂时）完成是不同的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-15T17:15:30.403

在第一个近似值中，代码对我来说似乎或多或少没问题。

Wrt 的细节，'ch' 应该被缓冲。'done' 通道 goroutine “accounting” 也可能被 sync.WaitGroup 替换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-15T18:43:20.523

如果你正在迭代从 goroutines 生成的值，你可以直接迭代通信通道：

```
for value := range ch {
   println(value)
} 
```

唯一需要的是，通道`ch`稍后关闭，否则循环将永远等待新值。

当`for numDone < N`与`sync.WaitGroup`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-16T23:11:48.250

我在我的一些代码中处理了同样的问题，发现[这](https://stackoverflow.com/a/15718640/1374086)是一个绰绰有余的解决方案。

答案提供了 Go 的习惯用法，用于处理所有通过单个通道发送的多个 goroutine。

# c# - 什么字符串传递给类的参数

> ID：16020409
> 
> 赞同：-2
> 
> 时间：2013-04-15T16:40:31.790
> 
> 标签：c#, asp.net, sql

我看到很多关于这个话题的讨论。尽管示例和期望的结果总是非常具体和专业。对此的任何方向表示赞赏。在我的代码中：我是动态生成的图像和图像 URL。并在面板中添加此图像控件。我想将图像 url 放在 temp() 的参数中，但我不明白我该怎么做

```
<td align="center" colspan="2" style="height: 200px; ">
     <asp:Panel ID="Panel_pic1" runat="server">
     </asp:Panel> 
</td> 
```

代码背后：

```
var lasToThirteenthUploaded = ds.Tables["title"].Rows[ds.Tables["title"].Rows.Count - 13]["id"].ToString();
int ID13 = Convert.ToInt16(lasToThirteenthUploaded);//row.Field<int>("video_id");
Image img13 = new Image();
img13.ID = "image" + ID13;
string title13 = ds.Tables["title"].Rows[ds.Tables["title"].Rows.Count - 13]["title"].ToString();//row.Field<string>("title");
img13.ImageUrl = ds.Tables["title"].Rows[ds.Tables["title"].Rows.Count - 13]["path"].ToString();// ("image_path");
Panel_pic13.Controls.Add(img13);

protected void ImageButton1_Click(object sender, ImageClickEventArgs e)
{
    if (Session["Name"] == null)
    {

    }
    else
    {
        temp();
    }
}
protected void temp()
 {

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:48:28.410

从这里传递价值

```
else
{
temp(img13.ImageUrl);
} 
```

并抓住它

```
void temp(string imageurl)
{
} 
```

你也可以使用 protected void temp(string imageurl)

# php - 使用 for 循环在表中插入项目

> ID：16020411
> 
> 赞同：0
> 
> 时间：2013-04-15T16:40:38.607
> 
> 标签：php, mysql, for-loop

我删除了一个旧的、措辞不好的问题，并重新发布以不浪费任何人的时间。

我正在尝试从两个表、房间和项目中查询内容。然后在嵌套循环中，使用前两个表中的信息在第三个表中创建一个条目。

'对于每个房间，插入所有标准项目'

```
<?php
mysql_connect("******", "****", "******") or die(mysql_error());
mysql_select_db("MaintenanceTracking") or die(mysql_error());// Check connection

//collect standard items names
$stditemdata = 'SELECT * FROM `StandardItems`';
$itemresult = mysql_query($stditemdata) or die("Couldn't execute query. ". mysql_error());
$itemarray = mysql_fetch_array( $itemresult ));

//collect room info
$roomdata = 'SELECT * FROM `Rooms`';
$roomresult = mysql_query($roomdata) or die("Couldn't execute query. ". mysql_error());

//repeat for each room
while($room = mysql_fetch_array( $roomresult )) 
{
    //repeat for each item
 for ($i = 0; $i <= count($itemarray); $i++)
   {
      mysqlquery("INSERT into Items 
      (ItemNumber, Name, LocationCode)
      VALUES 
      (NULL, $itemarray['Name'], $room['LocationCode'])");
   }
}
?> 
```

我对 php 还很陌生，必须承认语法有时让我难过……例如，众所周知，我错过了行尾的分号。

一百万提前感谢任何可以帮助我的人。

最亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:46:50.353

```
 mysqlquery("INSERT into Items 
  (ItemNumber, Name, LocationCode)
  VALUES 
  (NULL, $itemarray['Name'], $room['LocationCode'])"); 
```

它应该是

```
 mysql_query("INSERT into `Items` 
  (`ItemNumber`, `Name`, `LocationCode`)
  VALUES 
  (NULL, $itemarray['Name'], $room['LocationCode'])"); 
```

您使用**mysqlquery**而不是**mysql_query**

为避免 mysql 保留名称（fe 日期、表等）的重复，请使用此语法

```
`column_name` or `table_name` 
```

更新

哦..我想念！看，你尝试在这里写一些字符串到 DB

```
 mysql_query("INSERT into `Items` 
  (`ItemNumber`, `Name`, `LocationCode`)
  VALUES 
  (NULL, $itemarray['Name'], $room['LocationCode'])"); 
```

查询中的所有字符串都必须用引号单**'**或双**"**结束，因此您的查询应如下所示

```
 mysql_query("INSERT into `Items` 
  (`ItemNumber`, `Name`, `LocationCode`)
  VALUES 
  (NULL, \"$itemarray['Name']\", \"$room['LocationCode']\")"); 
```

（我在 " 之前使用 \ 符号来转义引号），但我建议您使用如下语法：

```
 mysql_query("INSERT into `Items` 
  (`ItemNumber`, `Name`, `LocationCode`)
  VALUES 
  (NULL, '".$itemarray['Name']."', '".$room['LocationCode']."')"); 
```

# c++ - 步入 C++ OpenCV 源码

> ID：16020415
> 
> 赞同：0
> 
> 时间：2013-04-15T16:40:55.947
> 
> 标签：c++, opencv, visual-studio-debugging, object-detection

我已经下载了 OpenCV 2.4.4 和 Visual Studio 2010。我正在从这里[Peopledetect.cpp](http://code.opencv.org/projects/opencv/repository/revisions/master/changes/samples/cpp/peopledetect.cpp)运行包中的一些示例。我能够编译和运行示例。我要做的是进入源文件，源文件主要在这里[Hog.cpp](http://code.opencv.org/projects/opencv/repository/revisions/master/changes/modules/objdetect/src/hog.cpp)。但我无法进入源文件。当我单击光标下的转到定义/关注对象时，我可以转到定义是（.hpp），它是[objectdetect.hpp](http://code.opencv.org/projects/opencv/repository/revisions/master/entry/modules/objdetect/include/opencv2/objdetect.hpp)文件，但无法转到源文件。

任何人都可以给提示

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:00:16.087

您需要使用 cmake 重建 opencv 库来为此构建 *.pdb 文件。

一旦您将您的 exe 与那些（而不是预构建库）链接起来，您就可以在调试时进入代码

# asp.net-mvc - ASP MVC3 - 选择 jQuery 自动完成值后对控制器进行第二次调用

> ID：16020420
> 
> 赞同：0
> 
> 时间：2013-04-15T16:41:04.470
> 
> 标签：asp.net-mvc, asp.net-mvc-3, jquery-ui, jquery

下面是我在 ASP MVC 视图中引用的 jQuery 版本

```
<script src="http://code.jquery.com/jquery-1.8.3.js" type="text/javascript"></script>
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js" type="text/javascript"></script> 
```

使用`autocomplete`小部件，我希望表单根据用户从`autocomplete`列表中的选择填写一个单独的文本框。在此页面上，用户将开始输入银行名称。一旦用户选择了他们需要的银行，另一个名为 的字段`Dynamics ID`需要填充适当的值。这是现在编写的 jQuery

```
$(function () {
    $("#BankNameAuto").autocomplete({
        source: '@Url.Action("GetBanks", "AgentTransmission")',
        minLength: 1,
        onComplete: function (data) {
            $.getJSON('@Url.Action("GetDynamicsId", "AgentTransmission")', data, function (result) {
                $('Dynamics').val(result);
            })
        }
    });
}); 
```

这是上面jQuery中调用的两个控制器方法

```
 //GET
    public JsonResult GetBanks(string term)
    {
        var banks = from c in db.BankListMaster.Where(n => n.BankName.Contains(term))
                        select c.BankName;

        banks = banks.Distinct();

        return Json(banks, JsonRequestBehavior.AllowGet);
    }

    //GET
    public JsonResult GetDynamicsId(string term)
    {
        var dynamics = from c in db.BankListMaster.Where(n => n.BankName.Equals(term))
                    select c.LinkRepsToDynamicsUniqueId;

        dynamics = dynamics.Distinct();

        return Json(dynamics, JsonRequestBehavior.AllowGet);
    } 
```

~~一旦用户从列表中进行了选择，我希望能够将`ID`值发送回该银行。它作为`BankListMaster`表的主键，其中`BankName`和`DynamicsId`都是字段。但是，我还是 jQuery 的新手，所以我可能无法做到这一点。~~

现在，我已经在两个控制器方法的第一行设置了一个断点。断点每次都会触发，`GetBanks`但是我根本无法`GetDynamicsId`触发。

编辑

由于我只`BankName`在第一个查询中选择了字段，因此我调整了`GetDynamicsId`使用银行名称作为参数的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:53:25.400

我通过处理“选择”事件来做类似的事情。它不是您在示例中的“onComplete”。您进行此更改的代码将是：

```
$(function () {
    $("#BankNameAuto").autocomplete({
        source: '@Url.Action("GetBanks", "AgentTransmission")',
        minLength: 1,
        select: function (event, ui) {
            $.getJSON('@Url.Action("GetDynamicsId", "AgentTransmission")', { term: ui.item.value }, function (result) {
                $('Dynamics').val(result);
            })
        }
    });
}); 
```

# database - 在 SQLite 表达式中引用命名表达式

> ID：16020422
> 
> 赞同：0
> 
> 时间：2013-04-15T16:41:12.613
> 
> 标签：database, sqlite

我想在 sqlite3 中做这样的事情，其中​​“...somelongexpression...”是我实际表达式逻辑的占位符：

```
SELECT ...somelongexpression... AS subexpr, subexpr * 2 AS twicesubexpr FROM sometable; 
```

但是，我收到“错误：没有这样的列：subexpr”。

我不能在另一个中引用一个命名列表达式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:52:29.460

这在这种形式的 SQL 中是不可能的。

您将不得不使用子查询：

```
SELECT subexpr,
       subexpr * 2 AS twicesubexpr
FROM (SELECT ...somelongexpression ... AS subexpr
      FROM sometable); 
```

# delphi - Delphi 在 localhost 中寻找可写文件夹

> ID：16020423
> 
> 赞同：-3
> 
> 时间：2013-04-15T16:41:15.623
> 
> 标签：delphi

```
SetCurrentDir(s); // S='//localhost/'
FindFirst(s+'*.*', faDirectory, searchResult);
x:=searchResult.Name;  // Result (name finded folder) 
```

1.  我正在尝试在 //127.0.0.1/ 目录中查找文件夹。此代码在 localhost 目录中工作，结果为空。

2.  如何检测检测到的文件夹是可写的还是只读的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:53:22.693

`\\127.0.0.1\`不是目录。它是本地计算机上共享的任何文件夹的基本 UNC。如何列出共享文件夹，请参阅此问题或在网上搜索示例：

[在树视图中枚举网络计算机和共享文件夹的列表？](https://stackoverflow.com/questions/11602599/enumerate-list-of-network-computers-and-shared-folders-in-a-tree-view)

# ember.js - ember.js：嵌套资源如何对应模板？

> ID：16020424
> 
> 赞同：0
> 
> 时间：2013-04-15T16:41:16.393
> 
> 标签：ember.js, ember-router

鉴于这个[小提琴](http://jsfiddle.net/3NYAm/3)（我无法使它工作，我很抱歉并且非常沮丧）：我不明白为什么，当我要求一本书的详细信息时，ember 要求的不是我的模板`books/book`，而是我的`book`模板。这是一个功能还是我做错了什么？

而且，此外，当我正确构建文件树时，询问书籍详细信息会给出：

-第一次尝试：输出：`OUTER`

- 在第二次尝试：输出：`Uncaught You can't call renderToBufferIfNeeded on a destroyed view`

我真的不明白为什么

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T18:12:25.070

首先，这里是您使用最新 ember.js 和 ember-data 的小提琴的工作版本：http: [//jsfiddle.net/va9gc/](http://jsfiddle.net/va9gc/)

ember 寻找`book`模板而不是寻找模板的原因`books/book`是因为您将其定义`book`为资源，而不是`route`. 这在这里解释：http: [//emberjs.com/guides/routing/defining-your-routes/#toc_nested-resources](http://emberjs.com/guides/routing/defining-your-routes/#toc_nested-resources)

# jquery - 通过 jquery ui 选项卡中的 url 更改活动选项卡（jquery 1.10.2）

> ID：16020425
> 
> 赞同：2
> 
> 时间：2013-04-15T16:41:17.150
> 
> 标签：jquery, jquery-ui, tabs, jquery-ui-tabs

我看过这个问题的版本，但他们被问及旧版本的 jquery 或不属于 jquery ui 1.10.2 的选项卡

**我的问题是：**
我需要添加什么 jquery 代码，以便
a) 将活动选项卡的选择器添加到 url（例如，如果 tabs-6 是活动单击选项卡，则浏览器中显示的 url 是 page2 .html#tabs-6)
b) 我可以构建链接，这些链接将根据 url 更改哪个选项卡处于活动状态（因此，如果我在“page1.html”上创建指向“page2.html#tabs-3”的链接“ #tabs-3" 将成为活动标签？

我已将网站的多个页面合并到 jquery ui 选项卡中（使用主题滚动的 jquery UI 1.10），并且我需要能够从主页上的菜单链接到各个选项卡。我对 html/css 非常有经验，但我的 jquery 知识基本上仅限于能够实现和编辑演示示例。

出于我们的目的，代码的标签块基本上是来自标签演示的库存 jquery ui。

```
<head>
<script>
$(function() {

    $( "#tabs" ).tabs();

    // Hover states on the static widgets
    $( "#dialog-link, #icons li" ).hover(
        function() {
            $( this ).addClass( "ui-state-hover" );
        },
        function() {
            $( this ).removeClass( "ui-state-hover" );
        }
    );
});
</script>
</head>
<body>
<div id="tabs">
  <ul>
    <li><a href="#tabs-1">Tab One</a></li>
    <li><a href="#tabs-2">Tab Two</a></li>
    <li><a href="#tabs-3">Tab Three</a></li>
    <li><a href="#tabs-4">Tab Four</a></li>
    <li><a href="#tabs-5">Tab Five</a></li>
    <li><a href="#tabs-6">Tab Six</a></li>
  </ul>
</div>
<div id="tabs-1">
  <p>tab 1 content</p>
</div>
<div id="tabs-2">
  <p>tab 2 content</p>
</div>
<div id="tabs-3">
  <p>tab 3 content</p>
</div>
<div id="tabs-4">
  <p>tab 4 content</p>
</div>
<div id="tabs-5">
  <p>tab 5 content</p>
</div>
<div id="tabs-6">
  <p>tab 6 content</p>
</div>
</body> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-05-02T14:54:51.490

对于（a）-我认为您必须在“选择”事件上编写一些自定义代码

[对于 (b) - 入站链接应该可以正常工作，只需使用选项卡的 div ID 作为片段（但在使用 URI 哈希标识选项卡时要](https://stackoverflow.com/questions/8624531/preventing-scroll-when-using-uri-hash-to-identify-tab)小心防止滚动）

# windows - 我可以在我的 Windows 应用程序中嵌入几乎任何字体，只要它只在应用程序执行期间安装吗？

> ID：16020426
> 
> 赞同：1
> 
> 时间：2013-04-15T16:41:17.400
> 
> 标签：windows, winapi, fonts

Windows + Office 提供的大多数字体至少具有“允许打印和预览嵌入”状态。

因此，是否允许将这些字体捆绑在 Windows 应用程序中，并让该应用程序在执行期间临时安装这些字体，而不会遇到任何法律问题？

这些字体仅用于 GUI，不用于生成任何文档。

那里也有很多免费字体，但很高兴知道 Windows 字体是否不存在任何限制，前提是它们是临时安装的 (AddFontResource)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:59:37.037

与大多数类型的软件一样，字体文件是获得许可的，而不是出售的。管理字体使用的许可证因供应商而异，但通常大多数许可证，包括那些涵盖 Microsoft 随应用程序和 Windows 提供的字体的许可证，都不允许将字体嵌入应用程序或以其他方式重新分发。因此，作为开发人员，您有责任确保您对嵌入应用程序或以其他方式重新分发的任何字体拥有所需的许可权利。

这是来自 Windows MSDN 站点。您可以在此处找到该页面[http://msdn.microsoft.com/en-us/library/ms753303.aspx](http://msdn.microsoft.com/en-us/library/ms753303.aspx)

因此，您似乎需要获得开放许可的“共享软件”样式字体。我过去使用的另一个解决方案是创建自己的字体。我使用的网站是[http://fontstruct.com/](http://fontstruct.com/)，它有一个网络工具，可以让您设置自己的字体样式，它是免费的，另外还有一些用户创建的字体具有开放许可证，您应该能够使用 - 但一定要事先检查。

# shader - 如何纠正浮点模运算的错误

> ID：16020427
> 
> 赞同：2
> 
> 时间：2013-04-15T16:41:18.287
> 
> 标签：shader, cg

某些移动 GPU 不支持积分模运算。所以我必须使用浮点精度来实现模运算。Cg标准库中fmod的实现如下。

```
float2 fmod(float2 a, float2 b)
{
  float2 c = frac(abs(a/b))*abs(b);
  return (a < 0) ? -c : c;   /* if ( a < 0 ) c = 0-c */
} 
```

通常“a/b”计算为“a * rcp(b)”。在某些情况下，fmod 由于浮点错误（例如，当 a == b 时）返回意外值。有没有轻量级的方法来克服错误？一个想法是添加像 fmod(a + bias, b) 这样的偏差，其中 0.0 < 偏差 < 1.0。但它并不坚固。非常感谢任何评论或参考指针。

提前致谢。

# c# - 使用 C# 向数据库添加数据

> ID：16020443
> 
> 赞同：1
> 
> 时间：2013-04-15T16:42:12.077
> 
> 标签：c#, ms-access, oledb

我目前正在尝试使用 C# 将数据添加到访问数据库（另存为 mdb）中，这是我当前的代码：

```
namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {

        private OleDbConnection bookConn;
        private OleDbCommand oleDbCmd = new OleDbCommand();
        private String connParam = @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\Users\Alex\Desktop\Project\example.mdb;Persist Security Info=False";

        public Form1()
        {
            bookConn = new OleDbConnection(connParam);
            InitializeComponent();
        }

        public void add()
        {
            try
            {
                bookConn.Open();
                oleDbCmd.Connection = bookConn;
                oleDbCmd.CommandText = "INSERT INTO Student (StudentID, Module) VALUES ('"+ this.textBox1.Text +"','"+ this.textBox2.Text +"');";
                oleDbCmd.CommandType = CommandType.Text;
                int temp = oleDbCmd.ExecuteNonQuery();
                if (temp > 0)
                {
                    MessageBox.Show("Added");
                }
                else
                {
                    MessageBox.Show("Failed");
                }
                bookConn.Close();
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
        }

        private void button1_Click(object sender, EventArgs e)
        {
            add();
        }

    }
} 
```

当我运行此代码时，我收到错误消息：*INSERT INTO 语句中的语法错误。*

当我与其他示例进行比较时，我无法弄清楚我做错了什么，它似乎设置正确。

任何解决此问题的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:50:29.443

`Module`是一个[保留字](http://allenbrowne.com/AppIssueBadWord.html#M)。如果可能/可行，重命名该字段。如果您必须将其保留为字段名称，请将其括在`INSERT`语句中的方括号中。

```
oleDbCmd.CommandText = "INSERT INTO Student (StudentID, [Module]) VALUES ('"+ this.textBox1.Text +"','"+ this.textBox2.Text +"');"; 
```

# c# - 将方法定义为静态会更好吗？

> ID：16020444
> 
> 赞同：1
> 
> 时间：2013-04-15T16:42:23.700
> 
> 标签：c#, static, static-methods

静态定义和使用方法而不是使用实例化类中的方法是否存在内存或性能差异？当方法不是静态的时，方法本身是否会占用类的每个实例的内存？

也许在静态方法中声明的任何变量都是非线程安全的？

```
/// <summary>
/// A class using instance methods (non-static)
/// </summary>
public class Junk
{
    public int x {get; protected set;}
    public Junk(int x = 0)
    {
        this.x = x;
    }
    public void Increment()
    {
        this.x++;
    }
} 
```

相对

```
/// <summary>
/// A class using static methods
/// </summary>
public class Junk
{
    public int x {get; protected set;}
    public Junk(int x = 0)
    {
        this.x = x;
    }
    public static void Increment(Junk thisJunk)
    {
        thisJunk.x++;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-15T16:48:05.620

没有区别。正如您的示例所示，实例方法在逻辑上只不过是第一个参数名为“this”的静态方法。唯一的区别是在实例方法中自动检查“this”是否为空；它不在静态方法中。

现在，*虚拟*方法确实会导致性能成本，因为实际调用的方法必须在运行时计算，而不是在编译时计算。这可能会使程序的运行时间增加几纳秒，并且还排除了某些优化，例如内联。

至于线程安全：变量是否安全使用是*整个程序*的属性，而不是方法是否为静态的属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T16:47:47.180

不; 实例方法不占用每个实例的任何空间。即使是虚拟方法也不这样做——所有实例都只使用一个方法表。

也就是说，有一个非常小的性能差异：实例方法将`this`引用作为隐藏参数，调用站点可能需要检查空引用。这使得调用该方法的成本略高，但差异几乎无关紧要。

尽管在您的示例中，我高度怀疑 JIT 编译器会内联该方法（无论它是否是静态的）并以任何一种方式生成相同的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T17:17:11.493

在静态方法中声明的变量绝对不是静态的。见前，[http://blogs.msdn.com/b/csharpfaq/archive/2004/05/11/why-doesn-tc-support-static-method-variables.aspx](http://blogs.msdn.com/b/csharpfaq/archive/2004/05/11/why-doesn-t-c-support-static-method-variables.aspx)。

这是一个更新的常见问题解答：http: [//msdn.microsoft.com/en-us/library/79b3xss3.aspx](http://msdn.microsoft.com/en-us/library/79b3xss3.aspx)：“C# 不支持静态局部变量（在方法范围内声明的变量）。”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T17:36:54.833

静态方法和实例方法不可互换。它们用于完全不同的情况以解决完全不同的问题。您应该使用适合您想要做的任何类型的方法。

由于您不会处于任何一种方法都适合手头任务的位置，因此两种方法之间的性能差异（如果有）是无关紧要的。你应该做在逻辑上和语义上适合你的程序的事情。

# javascript - JqG rid Checkbox 通过函数启用/禁用

> ID：16020445
> 
> 赞同：1
> 
> 时间：2013-04-15T16:42:23.900
> 
> 标签：javascript, jquery, function, jqgrid

我希望能够根据从函数传回的布尔值禁用/启用 jqGrid 复选框。我该怎么做？

*下面的代码片段*

```
 colModel: [
    { name: 'IsSystemAdmin', index: 'IsSystemAdmin', width: 50, align: "center", 
    formatter: "checkbox", 
    formatoptions: { disabled: isSystemAdmin}, editable: true }
], 
```

****请注意我调用函数的位置：formatoptions: { disabled: isSystemAdmin}, editable: true }* ***

* * *

```
var isSystemAdmin = new function(){
   //do something and return a bool value
} 
```

* * *

或者

```
function isSystemAdmin(){
  //do something and return a bool value
} 
```

* * *

显然解决了我上面的代码确实有效。只有改变：

**格式选项：{禁用：isSystemAdmin()}**

代替

**格式选项：{禁用：isSystemAdmin}**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:01:25.237

使用 .jqGrid('setSelection' 方法

```
function isSystemAdmin() { 
  jQuery("#list13").jqGrid('setSelection',"13"); 
}); 
```

# java - 如何将外部jar文件添加到maven

> ID：16020447
> 
> 赞同：0
> 
> 时间：2013-04-15T16:42:32.727
> 
> 标签：java, maven-2, m2e

如何使用 Eclipse M2 插件将外部 jar 文件添加到 Maven Web 应用程序项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:53:35.133

最正确的方法可能是将它们安装到 repo。

但是，对于替代方案，请参阅以下问题的最佳答案：

[我可以在不安装它们的情况下将 jars 添加到 maven 2 build classpath 吗？](https://stackoverflow.com/questions/364114/can-i-add-jars-to-maven-2-build-classpath-without-installing-them)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:56:59.967

You want to use mvn install:install-file. See here for the instructions in the Maven guide:

[http://maven.apache.org/guides/mini/guide-3rd-party-jars-local.html](http://maven.apache.org/guides/mini/guide-3rd-party-jars-local.html)

# c# - 所有窗口顶部的 C# 表单

> ID：16020448
> 
> 赞同：4
> 
> 时间：2013-04-15T16:42:35.610
> 
> 标签：c#, forms

我正在从 Excel 工作簿中的 VBA 代码启动 C# 制作的表单。

我希望此表单出现在所有其他窗口/应用程序（包括 Excel 工作簿）之上。

我试过组合

```
 Form1 f = new Form1();
        f.Focus();
        f.ShowDialog();
        f.Activate();
        f.Show(); 
```

但它们似乎都不起作用。有什么提示吗？

非常感谢

JB

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-15T16:44:31.643

将[TopMost](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.topmost.aspx)属性设置为`true`。

```
f.TopMost = true; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T08:07:05.443

我发现了一个棘手的方法：我最大化然后又恢复正常：

```
 Form1 f = new Form1();
        f.WindowState = FormWindowState.Maximized;
        f.Focus();
        f.Show();
        f.WindowState = FormWindowState.Normal;
        Application.Run(f); 
```

# c# - 实体框架插入空记录

> ID：16020450
> 
> 赞同：1
> 
> 时间：2013-04-15T16:42:37.573
> 
> 标签：c#, asp.net, entity-framework

我正在为我正在开发的 web 应用程序使用实体框架。该网络应用程序会跟踪场地。每个场地可以举办多种类型的活动。我有一个包含所有不同类型的事件类型 (EventTypes) 的表和另一个跟踪每个场地可以拥有的事件 (VenueEventTypes) 的表格，当我添加一个新场地时，我创建了一个包含 EventType 属性的新 VenueEventTypes 集合然后到数据库中查找事件类型并将其添加到每个 VenueEventTypes。问题是当我保存场地时，它创建的一切都很好，但是它在数据库中为 EventTypes 添加了一条空记录，但是 VenueEventType 外键指向有效的事件类型，而不是新创建的空记录。这是一些代码：

```
 public void addVenue(VEN_Venues venue)
    {
        using (var db = new VenueEntities())
        {
            var parish = from dbParish in db.VEN_Parishes
                         where dbParish.ParishID == venue.ParishID
                         select dbParish;

            venue.VEN_Parishes = parish.First();

            venue = this.processEventTypes(venue, db);
            db.VEN_Venues.AddObject(venue);
            db.SaveChanges();
        }
    }

    private VEN_Venues processEventTypes(VEN_Venues venue, VenueEntities db)
    {
        foreach (VEN_VenueEventTypes eventType in venue.VEN_VenueEventTypes)
        {
            eventType.VEN_EventTypes = new EventTypeFacade().findEventTypes(eventType.VEN_EventTypes, db);
        }
        return venue;
    } 
```

有人可以指出我的错误吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:57:58.883

看起来您实际上并未`VEN_EventType`将`venue.VEN_VenueEventTypes`.

您必须按照以下方式做一些事情：

```
venue.VEN_VenueEventTypes.Add(eventType); 
```

如果您不想要任何重复项，则必须使用附加：

```
venue.VEN_VenueEventTypes.Attach(eventType); 
```

# java - 删除字符串的最后一部分以外的所有内容？

> ID：16020451
> 
> 赞同：0
> 
> 时间：2013-04-15T16:42:37.587
> 
> 标签：java, string, url

我会用什么样的方法来做到这一点：

`http://www.site.net/files/file1.zip`

至

`file1.zip`?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-15T16:44:35.460

```
String yourString = "http://www.site.net/files/file1.zip";  
int index = yourString.lastIndexOf('/');    
String targetString = yourString.substring(index + 1);  
System.out.println(targetString);// file1.zip 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:45:58.200

```
String str = "http://www.site.net/files/file1.zip";
        str = str.substring(str.lastIndexOf("/")+1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T17:04:34.623

您可以使用正则表达式提取最后一部分：

```
@Test
public void extractFileNameFromUrl() {
    final Matcher matcher = Pattern.compile("[\\w+.]*$").matcher("http://www.site.net/files/file1.zip");
    Assert.assertEquals("file1.zip", matcher.find() ? matcher.group(0) : null);
} 
```

它只会返回“file1.zip”。包括在这里作为测试，因为我用它来验证代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T16:45:20.380

使用拆分：

```
String[] arr = "http://www.site.net/files/file1.zip".split("/"); 
```

然后：

```
String lastPart = arr[arr.length-1]; 
```

**更新：**另一种更简单的方法：

```
File file = new File("http://www.site.net/files/file1.zip");
System.out.printf("Path: [%s]%n", file.getName()); // file1.zip 
```

# reporting-services - HIdden 表达式具有无效的输入字符串

> ID：16020455
> 
> 赞同：-1
> 
> 时间：2013-04-15T16:42:46.123
> 
> 标签：reporting-services

有错误：tablix Group23 的隐藏表达式包含错误，输入字符串格式不正确

我没有创造这个，并且是该位置的新手，必须修复所有问题。
这是隐藏的表达

```
="Your screening results..." +VBCRLF+VBCRLF+"•  Your Body Weight was :" & (Fields!weight_loss.Value) & "lbs" 
+ VBCRLF+ "•  Your Body Mass Index (BMI) , which is based on your height and weight, was:" & (Fields!bmi.Value)& " " & "[Healthy Range: 18.5-24.9]"
+VBCRLF+ "•  Your waist circumference was:" & (Fields!waist.Value) & "inches." & "[Healthy Range:]" &IIF(Fields!gender.Value="M",35,40)
+ VBCRLF+ "•  To be in the healthy BMI range , your recommended weightshould be between " & (Fields!goal_wt_low.Value) & "and" &(Fields!goal_wt_high.Value) & "lbs." & "You told us that.." +VBCRLF+VBCRLF+
"• With regard to weight loss," & IIF(Fields!weight_loss.Value=1,"you are satisfied with the way you are now and have no desire to change.", IIF(Fields!weight_loss.Value=2,"•  you have considered making healthier choices."
, IIF(Fields!weight_loss.Value=3,"you have seriously considered making healthier choices and are ready to make a change.",IIF(Fields!weight_loss.Value=4,"you have started making healthier choices."
,IIF(fields!weight_loss.Value=5,"you have already made changes for a healthier lifestyle and are trying to maintain them.",IIF(Fields!weight_loss.Value=99,"you are not sure how satisfied you are with your current body weight.",nothing)))))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:19:50.413

虽然这是很多数据，但我认为问题可能很简单。我打赌其中一种数据类型不是字符串类型，也不是数据库中的 varchar/nvarchar。它基本上是在说明：“在你转换它之前，我不能添加一个带有数字的字符串。”

我猜你只需要在 Fields.(thing).Value 表达式周围添加 CSTR() 即可将它们转换为字符串。如果在此之后它仍然在轰炸，我会一次尝试一块并删除第一个表达式之后的所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T15:32:50.417

我猜想字符串值不是隐藏表达式所需的布尔响应。Hidden 有 2 个可接受的答案，True 和 False。字符串表达式永远不会评估为布尔响应。

# iphone - 使用未声明的标识符

> ID：16020456
> 
> 赞同：0
> 
> 时间：2013-04-15T16:42:46.280
> 
> 标签：iphone, ios, objective-c, audiotoolbox

我正在尝试使用[这个项目](https://github.com/hollance/AudioBufferPlayer/)，它是我正在构建的 iPhone 应用程序的 Objective-C 合成器。但是，我在`MHAudioBufferPlayer`上课时遇到了麻烦。

在[`MHAudioBufferPlayer.m`课堂](https://github.com/hollance/AudioBufferPlayer/blob/master/MHAudioBufferPlayer/MHAudioBufferPlayer.m)上，我收到一堆关于、和的`Use of undeclared identifier`错误。这是有道理的，因为这些标识符从来没有在它们前面使用下划线声明。但是，它们在类中声明时**没有**下划线。`_gain``_playing``_audioFormat``MHAudioBufferPlayer.h`

 **由于我是 Objective-C 的新手，所以我对此感到有些困惑。下划线是否表示要采取的特殊行动？它应该被翻译成`self.gain`,`self.playing`等吗？我怎样才能解决这个问题？或者这段代码只是错误的？

```
- (id)initWithSampleRate:(Float64)sampleRate channels:(UInt32)channels bitsPerChannel:(UInt32)bitsPerChannel packetsPerBuffer:(UInt32)packetsPerBuffer
{
    if ((self = [super init]))
    {
        _playing = NO;
        _playQueue = NULL;
        _gain = 1.0;

        _audioFormat.mFormatID         = kAudioFormatLinearPCM;
        _audioFormat.mSampleRate       = sampleRate;
        _audioFormat.mChannelsPerFrame = channels;
        _audioFormat.mBitsPerChannel   = bitsPerChannel;
        _audioFormat.mFramesPerPacket  = 1;  // uncompressed audio
        _audioFormat.mBytesPerFrame    = _audioFormat.mChannelsPerFrame * _audioFormat.mBitsPerChannel/8;
        _audioFormat.mBytesPerPacket   = _audioFormat.mBytesPerFrame * _audioFormat.mFramesPerPacket;
        _audioFormat.mFormatFlags      = kLinearPCMFormatFlagIsSignedInteger | kLinearPCMFormatFlagIsPacked;

        _packetsPerBuffer = packetsPerBuffer;
        _bytesPerBuffer = _packetsPerBuffer * _audioFormat.mBytesPerPacket;

        [self setUpAudio];
    }
    return self;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:51:05.687

如果您使用的是 Xcode4.4 及更高版本附带的新编译器，那么对于您的每个属性，它都会创建一个以 _(下划线) 作为前缀的自动合成。

就像，如果你创建了`@property.... playing;`

然后编译器创建`@synthesize playing=_playing;`

如果您使用的是旧版本的 Xcode，则需要手动完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T20:10:04.510

@synthesize 由 Xcode => 4.4 默认生成。*如果您没有显式创建自己的 @synthesize 语句*，则Xcode 为您创建的生成的私有实例变量 ivar 有一个前导下划线 ' '。*向该属性发送消息时必须包含前导 '* '（通常是 UI 元素作为你的 controller.m 文件的出口）。

那是

@property 文本字段；

[_textField setStringValue:@"foo"]; 如果你不写'@synthesize'。

编译器为您完成了这项工作，并通过合成 getter/setter 生成了一个私有实例变量。约定是使私有 ivar 成为前导下划线前缀的属性名称。

或者

@synthesize 文本字段；@property 文本字段；[文本字段 setStringValue:@"foo"]; 如果您确实编写了自己的“@synthesize”或者是 < Xcode 4.4。

在这里，编译器没有为您完成，您的 ivar 名称/属性名称是相同的，并且可以在没有前导“_”的情况下使用。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T17:40:57.537

根据您使用的 XCode 版本和编译器，有不同的方法。我不知道您对 OOP 有多熟悉，如果您不熟悉，我建议您阅读一些有关 setter、getter 和对象的内容，因为它是您从现在开始所做的几乎所有事情的基础。

一些例子，老派风格，将创建一个 ivar。在您的 .h 中：

```
@interface TheViewController : UIViewController{
    NSString *theString;
} 
```

有点新的风格，将在你的 .h 中创建 setter 和 getter。

```
@interface TheViewController : UIViewController

@property (nonatomic, weak) NSString *theString; 
```

在您的 .m 文件中：

```
@implementation TheViewController

@synthesize theString = _theString; 
```

可以通过 _theString 或 self.theString 访问

这样做的新方法。在您的 .h 文件中：

```
@property (nonatomic, weak) NSString *theString; 
```

编译器将按照上述方式创建所有内容。

希望对您有所帮助。**

# java - 构建 Beta 站点以镜像生产站点

> ID：16020457
> 
> 赞同：3
> 
> 时间：2013-04-15T16:42:47.167
> 
> 标签：java, architecture, beta

我想要一个平台向我的一小部分网站用户推出 Beta 功能。我不确定这样做并寻找您的建议的最佳做法是什么。

选项 1：我考虑的第一个选项是创建一个非生产环境来反映实时应用程序。然后我可以为用户提供一个新的 beta DNS，他们可以在其中试用最新的功能。这种方法的缺点是可维护性和可靠性。来自生产环境的数据需要刷新到 Beta 数据库，以确保用户体验与生产一致。由于此 Beta 环境将位于非生产基础设施中，因此由于持续构建等而更容易出现中断。

选项 2：将额外的服务器部署到生产环境，使用 beta 子域将用户引导到站点。陈旧数据在这里没有问题，因为它可以指向与现有生产环境相同的来源。不利的一面是，为了保持应用程序的稳定性和可靠性，实时生产环境的发布频率会降低，并且它是生产支持团队需要维护的额外节点。

选项 3：将 Beta 功能部署为主代码分支的一部分，并在代码中包含逻辑以向某些用户显示 Beta 功能。这种方法需要在稳定的代码中实现 Beta 更改，发布频率较低，并且在不影响现有代码库稳定性的情况下可以测试的更改类型的灵活性较低。

过去的经验对我应该如何进行有任何建议吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:49:22.713

使用选项 2)。您希望尽可能地将 beta 代码与生产代码隔离开来，这样，如果最坏的情况发生并且 beta 代码使服务器崩溃，那么 beta 用户将只能故障转移到生产服务器。

1）如果您的测试环境太不稳定，那么用户根本不会使用它。使用 3) 您冒着污染生产代码的风险。

我在这类事情上的大部分经验都来自于 Amazon AWS，在那里获得一个新的“服务器”就像获得一个新的 EC2 实例一样容易。我假设您设置新服务器的成本不会太高。

# bash - 如何使压缩文件直接用作常规文件？

> ID：16020461
> 
> 赞同：1
> 
> 时间：2013-04-15T16:43:07.857
> 
> 标签：bash, unix, compression, named-pipes, unzip

我们有一个用于基因组数据的定制压缩器，称为 CRAM，尽管它提供了卓越的压缩能力，但人们不敢使用它，因为使用生物信息学工具作为“常规”文件处理并不那么容易。我们希望允许将压缩文件用作脚本的参数、在 GUI 中打开等等，就像经典文件一样。

就像命名管道或块设备文件一样，它会在读取时自动执行解压缩命令。如果可以轻松地从系统复制到系统（到电子邮件、sftp 等），那就更好了。

我们目前的解决方案：

1.  假设我们有两个命令，cram 和 uncram（你可以在这里替换 gzip 和 gunzip），以及一个输入文件 fileX.

2.  我们压缩：

    补习班<fileX> fileX.cram

3.  我们为 cram 创建自解压存档：

    echo "uncram < fileX.cram" > fileX.cram.sex
    chmod +x fileX.cram.sex

4.  我们将其用作工具中的参数：

    我的工具 <(fileX.cram.sex)

现在它几乎很容易使用，除了“<()”符号，而且您不能立即在 GUI 中打开它。

任何想法如何使过程透明？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:03:52.470

您可以尝试为处理文件的每个命令提供一个简单的包装器：

```
$ mytool () {
>  command mytool <( "$1" )
> }
$ mytool fileX.cram.sex 
```

`command`内置命令允许您运行原始命令，而不是隐藏它的函数。

请注意，这`fileX.cram.sex`不是自解压存档；它只是一个带有硬编码输入文件的 shell 脚本。

# jquery - 使用 jQuery 自动化 Read More Div

> ID：16020462
> 
> 赞同：0
> 
> 时间：2013-04-15T16:43:09.857
> 
> 标签：jquery, css, automation

我正在研究显示第一段的推荐格式，其余段落包含在“阅读更多”显示链接后面。在此处查看实际操作：[http ://wlvrtn.com/sites/nms-site2/](http://wlvrtn.com/sites/nms-site2/)

我想做的是：与其手动将 div 包裹在 Read More 段落周围并在之后放置一个按钮链接，我想在 jQuery 中自动执行此操作。

jQuery 是否可以嗅出所有块引用中的段落数？它会在第一段之后的任何内容周围放置一个 div 标签，并在其后面加上“阅读更多”href。

我对你最好。谢谢你。

* * *

```
<section class="review">            

    <blockquote>

        <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Cras justo odio, dapibus ac facilisis in, egestas eget quam. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec ullamcorper nulla non metus auctor fringilla. Aenean lacinia bibendum nulla sed consectetur.</p>

            <!-- BEGIN READ MORE -->                
            <div class="review-continued">

            <p>Vestibulum id ligula porta felis euismod semper. Maecenas faucibus mollis interdum. Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas sed diam eget risus varius blandit sit amet non magna. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>

            <p>Donec id elit non mi porta gravida at eget metus. Curabitur blandit tempus porttitor. Nullam id dolor id nibh ultricies vehicula ut id elit. Curabitur blandit tempus porttitor.</p>

            </div>         
            <a href="#" class="read-more">Read More +</a>       
            <!-- END READ MORE -->

    </blockquote>

    <cite>– Dr. John Doe, M.D., Livermore, CA</cite>

</section> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:48:58.380

这应该这样做：

```
$('.review blockquote').each(function () {
    $('p:gt(0)', this).hide();
    var paras = this;
    $('a.read-more', this).click(function () {
        $('p:gt(0)', paras).slideToggle();
    });
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/hqN3v/)**

# ios - 我的 iPhone 应用正在使用 Facebook SDK for iOS v2.0。我的应用程序会在 2013 年 6 月损坏吗？

> ID：16020464
> 
> 赞同：5
> 
> 时间：2013-04-15T16:43:12.120
> 
> 标签：ios, facebook, facebook-ios-sdk

我在 facebook 上的应用程序有这个警报：

> 此应用使用适用于 iOS 的 Facebook SDK 的过时版本。请下载最新版本：iOS SDK 3.2.1。
> 
> 了解最新版本如何更轻松、更快速地构建出色的移动应用程序。
> 
> 我们还提供升级指南，以使该过程尽可能简单。从 SDK 2 升级到 3.1 和 3.1 到 3.2。
> 
> Facebook 也将在 2013 年 6 月停止支持 v2.0 版本的 SDK，因此建议您尽快升级到新的 SDK。

这是否意味着 iOS 版 Facebook SDK v2.0 将在 2013 年 6 月**停止工作**？或者，这是否仅仅意味着 Facebook 将停止为其提供技术支持和增强功能？

我的应用程序使用 v2.0 SDK 进行以下操作：

1.  使用 Facebook 登录
2.  获取好友列表
3.  向选定的朋友发送应用请求

由于时间和预算，我可能要到今年年底才能将我的 iPhone 应用程序升级到第 3 版。那么，这是否意味着我的 iPhone 应用程序将在 6 月份被破坏？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:51:16.250

首先，建议您阅读 Facebook SDK 发行说明。简而言之，API 发生了变化，登录机制（尤其是令牌管理）发生了变化。这意味着您的应用程序将有机会在 6 月被破坏。

但是，停止支持不等于停止服务。您可以询问 Facebook 何时停止 2.0 API 服务。第二个链接应该提供您需要的大多数编程信息。

**旁注：**我在几个小时内将我的应用从 Facebook iOS SDK 2.0 升级到 3.1。只是好奇，为什么要花这么长时间来执行更改？

希望能帮助到你。

参考 ：

1.  [Facebook iOS SDK 发行说明](https://developers.facebook.com/ios/change-log-3.x/)
2.  [从 2.0 升级到 3.x](https://developers.facebook.com/docs/tutorial/iossdk/upgrading-from-2.0-to-3.1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-26T09:57:55.853

如果您有权访问您的应用程序的代码，您可以在[此处](https://developers.facebook.com/docs/reference/ios/current/)查看类参考以获取最新版本，并查看您的代码中使用的方法等是否在此处列出，以及它们的行为方式/应该是否有任何变化使用。

如果类和方法都在那里，您不必担心。很可能，您的应用程序应该可以正常运行并且不会中断。

# javascript - 在区域外的触摸事件上关闭弹出导航模式

> ID：16020466
> 
> 赞同：1
> 
> 时间：2013-04-15T16:43:27.363
> 
> 标签：javascript, jquery, events, touch, mobile-website

我的网站是响应式的，对于狭窄的视图，导航切换到一个显示点击导航的图标。要关闭导航面板，您可以再次单击图标或导航模式之外的任何位置。这是管理导航模式之外的点击的 JS：

```
$(document).mousedown(function(e) {
    var clicked = $(e.target);
    if (clicked.is("#navigation") || clicked.parents().is("#navigation") || clicked.is("#hamburger-nav-link")) {
        return;
    } else {
        $("#hamburger-nav-link").removeClass("hamburger-nav-active");
        $("#navigation").removeClass("mobile-nav");
    }
}); 
```

在移动设备（好吧，我的 iPhone）上，当您点击图标时，它会关闭导航模式，但是当您在导航模式之外点击时，什么也没有发生。

我尝试从这个 SO 问题中实现代码以将触摸事件映射到单击事件： [JavaScript 将触摸事件映射到鼠标事件](https://stackoverflow.com/questions/1517924/javascript-mapping-touch-events-to-mouse-events)

然而，这对我不起作用。

我将代码粘贴在`$(document).mousedown()`函数下方，它们都在一个通用的 jQuery 函数中。我已经粘贴了下面的代码，所以你可以看到整个事情。该文件在每个页面末尾的结束标记之前调用。

非常感谢任何帮助，谢谢！

$（函数（）{

```
// Mobile nav
$("#hamburger-nav-link").click(function() {
    if ($("#navigation").hasClass("mobile-nav")) {
        $(this).removeClass("hamburger-nav-active");
        $("#navigation").removeClass("mobile-nav");
    }
    else {
        $(this).addClass("hamburger-nav-active");
        $("#navigation").addClass("mobile-nav");
    }

    return false;
});

// Close modal if click event is outside of it
$(document).mousedown(function(e) {
    var clicked = $(e.target);
    if (clicked.is("#navigation") || clicked.parents().is("#navigation") || clicked.is("#hamburger-nav-link")) {
        return;
    } else {
        $("#hamburger-nav-link").removeClass("hamburger-nav-active");
        $("#navigation").removeClass("mobile-nav");
    }
});

function touchHandler(event)
{
        var touches = event.changedTouches,
                first = touches[0],
                type = "";
                 switch(event.type)
        {
                case "touchstart": type = "mousedown"; break;
                case "touchmove":    type="mousemove"; break;                
                case "touchend":     type="mouseup"; break;
                default: return;
        }

                         //initMouseEvent(type, canBubble, cancelable, view, clickCount, 
        //                     screenX, screenY, clientX, clientY, ctrlKey, 
        //                     altKey, shiftKey, metaKey, button, relatedTarget);

        var simulatedEvent = document.createEvent("MouseEvent");
        simulatedEvent.initMouseEvent(type, true, true, window, 1, 
                                                            first.screenX, first.screenY, 
                                                            first.clientX, first.clientY, false, 
                                                            false, false, false, 0/*left*/, null);

                                                                                                                                                                 first.target.dispatchEvent(simulatedEvent);
        event.preventDefault();
}

function init() 
{
        document.addEventListener("touchstart", touchHandler, true);
        document.addEventListener("touchmove", touchHandler, true);
        document.addEventListener("touchend", touchHandler, true);
        document.addEventListener("touchcancel", touchHandler, true);        
}

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:42:12.770

只需将 click 和 touchend 事件绑定到文档即可使其工作。然后在单击图标时引用原始隐藏/显示功能。但是，这引入了另一个问题，即单击图标有时会双重触发，并且您会出现奇怪的行为。就像关闭然后重新打开一样。不过，我将单独解决这个问题。所以，这里是答案：

两个函数`touchHandler(event)`and`init()`和`$(document).mousedown(function(e) { ... });`function 和`$("#hamburger-nav-link").click(function() { ... });`function 替换为以下内容：

```
var navModalView = function() {
    if ($("#navigation").hasClass("mobile-nav")) {
        $("#hamburger-nav-link").removeClass("hamburger-nav-active");
        $("#navigation").removeClass("mobile-nav");
    }
    else {
        $("#hamburger-nav-link").addClass("hamburger-nav-active");
        $("#navigation").addClass("mobile-nav");
    }

    return false;
}

$(document).bind("click touchend", function(e) {
    var targetEl = $(e.target);

    if (targetEl.is("#navigation") || targetEl.parents().is("#navigation")) {
        return;
    }
    else if (targetEl.is("#hamburger-nav-link")) {
        navModalView();
        event.preventDefault();
    }
    else {
        $("#hamburger-nav-link").removeClass("hamburger-nav-active");
        $("#navigation").removeClass("mobile-nav");
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T09:51:01.627

我将它用于我的网络项目。可能这适用于移动设备。试一次:)

```
//GET ALL CLICK EVENT
$('html').click(function() {
    popmenu();
});

//Popupmenu Hide Function        
function popmenu(){
    var popmenuVisible = $(".popmenuclass").is("visible").toString();
    if (popmenuVisible=="true") {
            $(".popmenuclass").hide();
        }
} 

//IF you click on popupmenu then disable popmenu closing 
$(".popmenuclass").click(function(event){ event.stopPropagation();}); 
```

# mysql - 带条件的 LEFT JOIN

> ID：16020470
> 
> 赞同：0
> 
> 时间：2013-04-15T16:43:40.603
> 
> 标签：mysql, join, left-join

我需要加入两个表。我只想显示`users.private`= 0的匹配项

```
feeds
id     user_id
100    1
101    NULL
102    2

users
id   private
1    1
2    0 
```

我见过很多相关的问题，答案总是将 WHERE 条件改为 ON。但如果我这样做：

```
SELECT `feeds`.`id`, `feeds`.`user_id` AS `feed_user_id`, `users`.`id` AS `user_id`,  `users`.`private` 
FROM  `feeds` 
    LEFT JOIN `users` ON `feeds`.`user_id` = `users`.`id` 
        AND `users`.`private` = 0 
```

这返回

```
id     feed_user_id  user_id  private
100    1             NULL     NULL
101    NULL          NULL     NULL
102    2             2        0 
```

我想要它做的是排除第一行 id 100。（所以我想这不是真正的 LEFT JOIN -> 如果满足条件，我希望它 LEFT JOIN，否则排除）我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:53:39.503

您需要两个单独的条件子句，一个在 JOIN 上，一个在 SELECT 上，如下所示：

```
SELECT `feeds`.`id`, `feeds`.`user_id` AS `feed_user_id`, `users`.`id` AS `user_id`,  `users`.`private` 
FROM  `feeds` 
LEFT JOIN `users` ON `feeds`.`user_id` = `users`.`id` 
WHERE `users`.`private` = 0 OR `feeds`.`user_id' IS NULL 
```

您当前方法的问题在于，加入将私人用户视为不存在，而不是说“这个人存在，我应该从结果中排除这一行”。

# javascript - JSONArray 中的 JSONObject 构建问题

> ID：16020473
> 
> 赞同：0
> 
> 时间：2013-04-15T16:43:52.297
> 
> 标签：javascript, jquery, cordova

我需要将带有 JSONObject 的 JSONArray 提供给将这些参数传递给 Java 的 JavaScript 函数。

到目前为止，我尝试了什么，但没有奏效：

//错误的语法

```
var array = [[1, 1, "DescPDV1"]]; 
```

//正确的sintax，但只能作为JSONArray，而不是JSONArray中的JSONObject

```
var array = [1, 1, "DescPDV1"]; 
```

//错误的语法

```
var array = [{1, 1, "DescPDV1"}]; 
```

//错误的语法

```
var array = {1, 1, "DescPDV1"}; 
```

//错误的语法

```
var array = {{1, 1, "DescPDV1"}}; 
```

我的 JSONObject 充满了值，但没有指向它们的键，那么，没有 ["id" : "1", "blah" : "2"]...只有值 [1, ""blah"]。

我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:51:52.403

如果您的 JSONObject 没有键，则它不是对象。您需要将其表示为这样的数组数组：

```
[[1, 1, "DescPDV1"]] 
```

这是一个有效的 JSON 字符串，可以在[JSONLint确认](http://jsonlint.com)

此外，这是有效的 Javascript：

```
var array = [[1, 1, "DescPDV1"]]; 
```

可以[在 JSFiddle 确认这里](http://jsfiddle.net/ZwRbY/)

# c# - Visual Studio 编辑器可以从全大写转换为驼峰式吗？

> ID：16020476
> 
> 赞同：16
> 
> 时间：2013-04-15T16:43:59.650
> 
> 标签：c#, visual-studio, visual-studio-2012

Visual Studio 2012 中是否有可以将选定的 C# 源代码从 转换为 的命令或`SOME_NAME`插件`SomeName`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-15T16:47:08.267

我使用 resharper 7.0。它有关于命名约定的规则，所以当我有名为 SOME_NAME 的东西时，它会通知我，它会根据规则约定将其更改为名称。

它还将应用命名约定将该变量名称更改为使用它的代码。

我不知道 resharper 是否会立即为您完成所有工作。我只用它做一件事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:50:43.397

当我过去必须这样做时，我使用了以下步骤：

1.  选择文本`OME_NAME`并按`Ctrl`+ `U`（将文本转换为小写）。
2.  选择文本`_n`并键入`N`。
3.  按`Alt`+ `Shift`+ `F10`（显示智能标记）应用重命名重构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T16:47:46.393

简短的回答不，但您可以做一个宏并使用它或使用一些生产力工具作为 resharper。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T16:49:08.510

据我所知，唯一内置的大小写快捷方式是更改为全部大写或全部小写。这是 Visual Studio 2012 中案例快捷方式的 MSDN 文档：http: [//msdn.microsoft.com/en-us/library/ms165341.aspx](http://msdn.microsoft.com/en-us/library/ms165341.aspx)

# php - 从 MySQL 检索 mysqli_real_escape_string

> ID：16020480
> 
> 赞同：0
> 
> 时间：2013-04-15T16:44:12.333
> 
> 标签：php, mysql

```
// inserting into DB from form

if (!empty($_POST['Title'])) {
    $t = mysqli_real_escape_string($dbc, ($_POST['Title']));
} else {
    $errors[] = 'Please enter a Headline title';
}

// Add the news to the database:

$q = 'INSERT INTO news ( Title, Content) VALUES (?, ?)';
$stmt = mysqli_prepare($dbc, $q);
mysqli_stmt_bind_param($stmt, 'ss', $t, $c);
mysqli_stmt_execute($stmt); 
```

如果 $t 包含撇号，例如

```
We're awesome 
```

它会将其添加到数据库中

```
"we\'re awesome" 
```

稍后的：

然后我如何运行 title = $t 的查询

```
$q = "SELECT * FROM news WHERE title= '$t'"; 
```

查询失败，因为撇号有效地切断了 SQL

```
SELECT * FROM news WHERE title = ' we're awesome 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:57:47.540

You can either escape or use prepared statements, but *not both*!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:54:43.667

您再次在搜索中使用 mysqli_real_escape_string，就像使用插入一样。

```
$t = mysqli_real_escape_string($link,$t);
$q = "SELECT * FROM news WHERE title= '$t'"; 
```

而已。

# floating-point - 为什么从 0.0-1.0 区间转换时需要将 RGB 值乘以 256 而不是 255？

> ID：16020482
> 
> 赞同：1
> 
> 时间：2013-04-15T16:44:18.673
> 
> 标签：floating-point, integer, rounding

我在这个问题上读到了一种舍入技术。 [将颜色值从浮点 0..1 转换为字节 0..255](https://stackoverflow.com/questions/1914115/converting-color-value-from-float-0-1-to-byte-0-255)

您在 0 到 1 的范围内有一个浮点数，并且您希望将其映射到 0-255 的字节整数范围。因此，您将 0-1 数字乘以 255f，然后将该数字转换为一个字节。因为所有转换都只是浮动的小数部分，所以您需要一种方法来实现它，因此当它被限制时，它将达到所需的舍入结果。

我的想法是在将其转换为字节之前添加 0.5f。

但是，我在链接的那个页面上注意到了一些我不理解的新内容。相反，他将 0-1 映射到 256，这会以某种方式实现四舍五入的结果。

我测试了值以查看它是否有效并且看起来确实有效。我只是不明白为什么。有人可以给我一个证明吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T17:08:03.743

这是[Fencepost 错误](http://en.wikipedia.org/wiki/Off-by-one_error#Fencepost_error "栅栏错误")的一个特例。在您只有两种颜色（黑色和白色）的情况下，您可以看到最简单的解释。因此很容易看出您必须将区间 0-1 除以*2*。

这可以通过将间隔乘以稍小的除法数并截断结果来轻松实现。这也是随机数生成器返回值 >= 0 且 < 1.0 以轻松获得等概率值的原因。

所以在这个例子中你得到了正确的结果，value = floorf(1.9999*x)。

问题是，虽然颜色索引以数字 1 结尾，但实际上有两种颜色（0 和 1），因此间隔必须除以 2。因此，对于 256 种颜色 (0-255)，您需要除以数字 256。人们可能会注意到 0 也是一个有效值，并且必须正确映射。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-05T12:26:01.343

Simply put, if your were representing colors with the integers "0, 1, 2, 3", you'd need to pick something to be your 0.5 case. If you pick the 1, you'd get 0.0, 0.5, 0.75, 1.0\. If you pick the 2 you'd get 0.0, 0,25, 0.5, 1.0\. There's no way to make those intervals equal, but integer colors can't have a decimal. The only solution would be to have eliminated the 0.5 case entirely and used even intervals, 0.333 0.666, but they chose not to do that. So color 127/255 currently evaluates to 0.5, instead of 0.498, because it's taken as 128/256\. Unfortunately, adding 1 to the numerator and denominator would cause color 0 to be interpreted as 1/256 instead of 0/255

# c++ - 动态内存重新分配

> ID：16020487
> 
> 赞同：0
> 
> 时间：2013-04-15T16:44:47.320
> 
> 标签：c++, pointers

例如，如果您动态分配一些空间

```
 struct node*py=new struct node;
    struct node*tr=py;
    delete py; 
```

分配的内存不应该仍然保留而不被释放，因为在删除指向同一地址的原始指针之前，我确实有另一个指向同一地址的指针？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:52:19.463

不，堆管理器只是按照它的指示去做并释放内存。

如果您想根据对内存的引用次数来保留内存，请考虑使用引用计数指针，例如 C++11 shared_ptr（例如，参见[Dobbs 博士](http://www.drdobbs.com/cpp/3-most-useful-library-features-of-c0x/231300394?pgno=1)）或 boost 的[智能指针](http://www.boost.org/doc/libs/1_53_0/libs/smart_ptr/smart_ptr.htm)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-15T16:46:52.327

不，这根本不是 C++ 中内存分配的工作方式。

如果您使用 分配内存`new`，然后调用`delete`它，它将*被*删除。内存管理器无法在删除开始后取消或中止删除。C++ 倾向于完全按照你的要求去做，所以如果你真的不想释放一些内存，那么不要调用`delete`它。

如果您想要引用计数，请尝试使用`std::shared_ptr`（或者`boost::shared_ptr`，如果您还`std`没有）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-15T16:46:35.357

但是您自己说过-它只是一个指针，因此它不知道它指向什么。它只是指向一个被蒙住眼睛的地方。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-15T16:46:55.343

不，在 c/c++ 中，编译器/执行环境不会跟踪对内存的引用、新的和空闲的标记内存是否正在使用中，并且任何引用计数或其他更高阶的垃圾收集都留给您的程序。

# php - XML 中的项目符号“•”

> ID：16020488
> 
> 赞同：2
> 
> 时间：2013-04-15T16:44:51.947
> 
> 标签：php, xml, character-encoding, html-entities

与此[问题](https://stackoverflow.com/questions/2454566)类似， 我正在使用其中包含一些非法字符的 XML 产品。我严重怀疑我能否让他们解决问题，但我会尝试。与此同时，我想要一个解决方法。

问题是它包含一个子弹。它在我的源代码中呈现为“€¢”。我尝试了一些编码转换，但没有找到有效的组合。（我什至不习惯考虑我的编码类型，所以我在这里没有我的元素。）所以，我尝试了下面的方法，似乎 str_replace 无法识别“•”。（它在我的文本编辑器中呈现为高块）你可以看到我尝试了一些不同的东西的注释行。

我首先在“â€¢”上尝试了 str 替换，然后进行了调整，这是我最新的：

```
// deal with bullets in XML.
$bullet="•"; //this was copied and pasted from transliterated text.
//$data=iconv( "UTF-8", "windows-1252//TRANSLIT", $data ); //transliterate the text:
//$data=str_replace($bullet,'&#8226;',$data); // replace the bullet char
$data=str_replace($bullet,' - ',$data); // replace the bullet char
//$data=iconv( "windows-1252", "UTF-8", $data ); // return the text to utf-8 encoding. 
```

任何想法如何剥离或替换这个字符？如果有预清理 XML 的功能，那就太好了，我不必担心。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-15T20:47:23.663

# perl - 使用文本月份排序

> ID：16020490
> 
> 赞同：0
> 
> 时间：2013-04-15T16:44:52.767
> 
> 标签：perl, sed, awk

不确定实现这一目标的最佳方法。

我从 mysql 查询中将这些结果保存到文本文件中。我想首先对最旧条目的第 4 列进行排序。

`10.xxx.xxx.xxx 70:xx:xx:xx:xx:xx Wed Apr 3 17:00:52 2013 Mon Apr 15 09:42:33 2013 10.xxx.xxx.xxx 70:xx:xx:xx:xx:xx Mon Apr 8 14:01:05 2013 Mon Apr 15 09:42:33 2013 10.xxx.xxx.xxx 70:xx:xx:xx:xx:xx Fri Apr 5 13:00:56 2013 Mon Apr 15 09:42:33 2013 10.xxx.xxx.xxx 70:xx:xx:xx:xx:xx Mon Apr 8 08:00:59 2013 Mon Apr 8 08:00:59 2013 10.xxx.xxx.xxx 70:xx:xx:xx:xx:xx Thu Mar 28 14:15:12 2013 Fri Apr 5 09:00:55 2013 10.xxx.xxx.xxx 70:xx:xx:xx:xx:xx Thu Mar 28 14:15:12 2013 Fri Apr 5 07:00:53 2013`

sort -r -k10 test 似乎没有削减它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T20:47:34.973

A Perl solution using [Time::Piece](https://metacpan.org/module/Time%3a%3aPiece) (in the Perl standard library since 5.10.0) and a Schwartzian Transform.

```
#!/usr/bin/perl

use strict;
use warnings;
use 5.010;
use Time::Piece;

say map  { $_->[0] }
    sort { $a->[1] cmp $b->[1] }
    map  { [ $_, sortdate($_) ] } <DATA>;

sub sortdate {
  my $date = join ' ', (split)[2 .. 6];
  return Time::Piece->strptime($date, '%a %b %d %H:%M:%S %Y')->datetime;
}

__END__
10.xxx.xxx.xxx 70:xx:xx:xx:xx:xx Wed Apr 3 17:00:52 2013 Mon Apr 15 09:42:33 2013
10.xxx.xxx.xxx 70:xx:xx:xx:xx:xx Mon Apr 8 14:01:05 2013 Mon Apr 15 09:42:33 2013
10.xxx.xxx.xxx 70:xx:xx:xx:xx:xx Fri Apr 5 13:00:56 2013 Mon Apr 15 09:42:33 2013
10.xxx.xxx.xxx 70:xx:xx:xx:xx:xx Mon Apr 8 08:00:59 2013 Mon Apr 8 08:00:59 2013
10.xxx.xxx.xxx 70:xx:xx:xx:xx:xx Thu Mar 28 14:15:12 2013 Fri Apr 5 09:00:55 2013
10.xxx.xxx.xxx 70:xx:xx:xx:xx:xx Thu Mar 28 14:15:12 2013 Fri Apr 5 07:00:53 2013 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T17:25:29.207

```
@ECHO OFF
SETLOCAL ENABLEDELAYEDEXPANSION 
(
FOR /f "tokens=1-7*" %%a IN (sqlout.txt) DO (
SET "month="
FOR %%m IN (01 Jan 02 Feb 03 Mar 04 Apr 11 Nov 12 Dec) DO IF NOT DEFINED month (
IF %%d==%%m SET month=!prev!
SET prev=%%m
)
SET /a day=100+%%e
ECHO(%%g!month!!day!%%f*%%a %%b %%c %%d %%e %%f %%g %%h
)
)>tempfile.1

(
FOR /f "delims=" %%i IN ('sort tempfile.1') DO (
SET line=%%i
ECHO(!line:**=!
)
) >sortedoutput.txt

DEL tempfile.1 /F /Q 
```

在样本数据上，有 8 个有效列。其中，第四为月、第五日、第六次、第七年。我不知道“第四”列是“日期”是什么意思，因为每行中有两个单独的日期。

该过程只需选择第四列并查看月份编号（2 位）和月份缩写的列表。保存前一个元素以供比较下一个元素时使用更容易，因此当月份名称与 %%d 中的第四列匹配时，将`month`设置变量，这将关闭该月份的任何进一步处理。

**您可能已经注意到我没有列出所有月份**这让您有事可做。除非在列表中输入所有月份，否则它显然不起作用。

接下来我们处理第五列，并将 100 加到日期编号上，产生一个从 101 到 131 的数字。这些数字都有三个字符。

接下来我们`ECHO`出一串

*   来自第 7 列的年份，以 %%g 为单位
*   中的 2 个字符的月份编号`month`
*   3 位数的增广天数
*   从第 6 列开始的时间
*   一个星号
*   原行的每个元素

下一步是在排序后读取每一行。

*   将排序的行设置为`line`
*   回显从`line`除了部分到第一个星号的所有内容。

# javascript - Json 数据提取

> ID：16020491
> 
> 赞同：0
> 
> 时间：2013-04-15T16:44:53.790
> 
> 标签：javascript, json

我有一个网络服务，它返回这样的 json 数据..

```
{"d":"{\"RES\":[],\"STAT\":\"FAIL\",\"SID\":\"0\"}"} 
```

我怎样才能从中读取 STAT=FAIL。我用 C# 编写了服务。

我的脚本是

```
$.ajax({
    type: "POST",
    url: "http://localhost/EMRDMSService/Service.asmx/User_Login",
    data: "{lg:" + JSON.stringify(GetLogDet) + "}",
    // url: "http://localhost/EMRDMSService/Service.asmx/Permission_List",
    // data: "{userid:" + JSON.stringify(GetLogDet) + "}",

    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function (r) {          
        console.log(r.d.STAT);
    }
}); 
```

但是 rdSTAT 是`undefined`? 有人可以帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:50:57.210

正如一些评论中所说，`{"d":"{\"RES\":[],\"STAT\":\"FAIL\",\"SID\":\"0\"}"}`JSON 不正确。但是，如果您无法更新网络服务，您可以在`success`回调中尝试：

```
var d = JSON.parse(r.d);
console.log(d.STAT); 
```

**响应 OP 编辑​​的 EDIT** `r.d.STAT`将是未定义的，因为`d`它被解释为字符串，而不是对象。这就是为什么您必须解析它或更新网络服务以删除`d`.

# ios - iOS 4.3 AudioQueuePause 与主页按钮

> ID：16020494
> 
> 赞同：2
> 
> 时间：2013-04-15T16:44:59.790
> 
> 标签：ios, audioqueue

我曾经`AudioQueue`在我的游戏中播放声音。有两个声音对象： looped`music`和 non-looped `sfx`。我观察到的问题如下：

1.  已`music`启动。
2.  已`sfx`启动。
3.  `sfx`暂停（使用`AudioQueuePause`）
4.  游戏通过主页按钮进入后台。
5.  我得到`UIApplicationWillResignActiveNotification`并且`music`暂停（使用`AudioQueuePause`）。
6.  我从 iPad 菜单返回我的应用程序。
7.  我得到`UIApplicationDidBecomeActiveNotification`并且`music`未暂停（使用`AudioQueueStart`）。
8.  请注意，我没有取消暂停`sfx`。尽管如此，它恢复了，我能听到它！

当通过主页按钮进入后台时，我只能在装有 iOS 4.3 的 iPad 上重现它。如果我使用睡眠/唤醒按钮而不是主页，它会完美运行。

因此，系统似乎以某种方式恢复了所有音频队列：甚至是明确暂停的音频队列。有什么想法吗？

# sublimetext2 - 在 Sublime Text 2 中设置 PHP Codesniffer（随自制软件安装）

> ID：16020495
> 
> 赞同：1
> 
> 时间：2013-04-15T16:45:05.973
> 
> 标签：sublimetext2, codesniffer, phar

是否可以从 .phar 文件运行 PHP Codesniffer？以下文档来自[https://github.com/benmatselby/sublime-phpcs](https://github.com/benmatselby/sublime-phpcs)的 Sublime Text 2 插件，是什么意思？

> 如果您通过自制软件安装了 php-cs-fixer、phpmd 或 phpcs，请确保为 .phar 应用程序定义“*_executable_path”选项，而不是放置在 bin 文件夹中的包装脚本，因为这会导致奇怪的行为。

`sudo find / -name '*.phar'`不会在 Mac OS X Mountain Lion 上调出任何 PHP Codesniffer 文件。我已经`phpcs_executable_path = /usr/local/Cellar/php-code-sniffer/1.4.4/libexec/phpcs`在插件中设置了，但 Codesniffer 没有运行。

```
unknown-58-b0-35-73-71-82:bin scisteffan$ ls -la /usr/local/bin | grep phpcs
lrwxr-xr-x    1 scisteffan  admin       42 16 Mar 13:38 phpcs -> ../Cellar/php-code-sniffer/1.4.4/bin/phpcs

unknown-58-b0-35-73-71-82:bin scisteffan$ ls -la /usr/local/Cellar/php-code-sniffer/1.4.4/bin | grep phpcs
lrwxr-xr-x   1 scisteffan  admin   54  8 Mar 11:52 phpcs -> /usr/local/Cellar/php-code-sniffer/1.4.4/libexec/phpcs 
```

此外，如果我使用 phpcs 安装它`pear install`并将其链接到 Sublime Text 2，则它可以工作。只是无法弄清楚如何将它与`php-code-sniffer`

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-04-11T15:35:56.263

这有点晚了，但这里有一个链接，向您展示如何更轻松地做到这一点：http: [//philsturgeon.co.uk/blog/2013/08/php-static-analysis-in-sublime-text](http://philsturgeon.co.uk/blog/2013/08/php-static-analysis-in-sublime-text)

你将不得不做一些关于如何设置[Homebrew](http://brew.sh/)的谷歌搜索。这应该让你朝着正确的方向前进。

# php - 登录 fos 用户捆绑 symfony 后重定向

> ID：16020508
> 
> 赞同：1
> 
> 时间：2013-04-15T16:45:56.633
> 
> 标签：php, symfony

我有一个扩展 fos 用户包和另一个包的包。
一旦用户通过身份验证，我希望根据他的角色管理员或简单用户将他重定向到不同的视图。
我的问题是我找不到登录控制器，我将从那里进行重定向。

角色是`User`来自数据库的实体的属性。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-15T16:54:45.987

您必须添加一个实现[AuthenticationSuccessHandler 接口的](http://api.symfony.com/2.0/Symfony/Component/Security/Http/Authentication/AuthenticationSuccessHandlerInterface.html)[LoginSuccessHandler ，](http://www.reecefowell.com/2011/10/26/redirecting-on-loginlogout-in-symfony2-using-loginhandlers/)

然后，您可以在`onAuthenticationSuccess()`方法中设置重定向逻辑，如下所示，

```
namespace XXX\YourBundler\Handler;

use Symfony\Component\Security\Http\Authentication\AuthenticationSuccessHandlerInterface;
use Symfony\Component\Security\Core\Authentication\Token\TokenInterface;
use Symfony\Component\Security\Core\SecurityContext;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\RedirectResponse;
use Symfony\Component\Routing\Router;

class LoginSuccessHandler implements AuthenticationSuccessHandlerInterface
{   
    protected $router;
    protected $security;

    public function __construct(Router $router, SecurityContext $security)
    {
        $this->router   = $router;
        $this->security = $security;
    }
    public function onAuthenticationSuccess(Request $request, TokenInterface $token)
    {   
        if ($this->security->isGranted('ROLE_XXXX_1'))
        {
            $response = new RedirectResponse($this->router->generate('route_1'));           
        }
        elseif ($this->security->isGranted('ROLE_XXXX_2'))
        {
            $response = new RedirectResponse($this->router->generate('route_2'));
        }
        // ...
    } 
} 
```

您的处理程序还必须注册为服务，

```
parameters:
     security.authentication.success_handler.class: XXX\YourBundler\Handler\AuthenticationSuccessHandler

services:
    security.authentication.customized_success_handler:
        class: %security.authentication.success_handler.class%
        public: false
        arguments:  [@router, @security.context] 
```

然后，您必须将以下行添加到防火墙安全配置中，

```
 success_handler: security.authentication.customized_success_handler 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-24T12:35:12.117

您可以按如下方式覆盖 renderLogin 函数：

```
class SecurityController extends BaseController
{
/**
 * Renders the login template with the given parameters. Overwrite this function in
 * an extended controller to provide additional data for the login template.
 *
 * @param array $data
 *
 * @return \Symfony\Component\HttpFoundation\Response
 */
protected function renderLogin(array $data)
{
    $securityContext = $this->get('security.context');
    $router = $this->container->get('router');
//        if ($this->get('security.context')->getToken()->getUser() instanceof \FOS\UserBundle\Propel\User) {
//            $url = $this->container->get('router')->generate('dashboard');
//            return new RedirectResponse($url);
//        }
    if ($securityContext->isGranted('ROLE_ADMIN')) {
        return new RedirectResponse($router->generate('dashboard'), 307);
    }

    if ($securityContext->isGranted('ROLE_USER')) {
        return new RedirectResponse($router->generate('front_page_home'), 307);
    }

    $requestAttributes = $this->container->get('request')->attributes;
    if ($requestAttributes->get('_route') == 'admin_fos_user_security_login') {
        $template = sprintf('FOSUserBundle:Security:login.html.twig');
        $data['admin'] = true;
    } else {
        $template = sprintf('FOSUserBundle:Security:login.html.twig');
        $data['admin'] = false;
    }

    return $this->container->get('templating')->renderResponse($template, $data);
}

} 
```

# ios - AVFoundation - 如何将 AVCaptureMovieFileDataOutput 保存到文件？

> ID：16020511
> 
> 赞同：2
> 
> 时间：2013-04-15T16:46:16.577
> 
> 标签：ios, objective-c, avfoundation, avcapturesession, avcapturemoviefileoutput

我一直在阅读[AV Foundation Programming Guide](http://developer.apple.com/library/mac/#documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/04_MediaCapture.html)。特别是，我一直在尝试让“媒体捕获”部分中的“将所有内容放在一起”部分工作。我对教程中的代码做了一些小改动，但没有什么影响太大。我对如何从 AVCaptureMovieFileDataOutput 实际保存电影文件感到困惑。我使用以下设置捕获会话：

```
//Create session.
AVCaptureSession *session = [[AVCaptureSession alloc] init];

//Set preset to low.
if ([session canSetSessionPreset:AVCaptureSessionPresetLow]) {
    session.sessionPreset = AVCaptureSessionPresetLow;
}
else {
    // Handle the failure.
}

//Get camera device.
AVCaptureDevice *device =
[AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];

NSError *error = nil;
AVCaptureDeviceInput *input =
[AVCaptureDeviceInput deviceInputWithDevice:device error:&error];
if (!input) {
    //Handle the error appropriately.
}
[session addInput:input];

//Create output.
AVCaptureMovieFileOutput *output = [[AVCaptureMovieFileOutput alloc] init];
[session addOutput:output];

[session startRunning]; 
```

我可能只是在开发人员文档中遗漏了一些我没有看到的东西，但我还没有看到如何真正让会话创建文件。有什么建议么？非常感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-15T17:11:32.337

保留对`AVCaptureMovieFileOutput`. 那会派上用场的。

无论如何，该类有一个方法可以这样调用：

```
[[self movieFileOutput] startRecordingToOutputFileURL:url recordingDelegate:self]; 
```

其中`url`是设备上的文件 URL，例如文档目录。这允许它开始录制。您可能还需要注意，您可以通过调用来停止它`[[self movieFileOutput] stopRecording];`。您还需要实现`AVCaptureFileOutputRecordingDelegate`处理回调的方法。这些方法在录制开始和结束时调用，如下所示：

```
-(void)captureOutput:(AVCaptureFileOutput *)captureOutput 
               didStartRecordingToOutputFileAtURL:(NSURL *)fileURL 
               fromConnections:(NSArray *)connections;

-(void)captureOutput:(AVCaptureFileOutput *)captureOutput 
               didFinishRecordingToOutputFileAtURL:(NSURL *)outputFileURL 
               fromConnections:(NSArray *)connections error:(NSError *)error; 
```

您必须实现这些委托方法来处理开始和结束录制时发生的情况。在该`didFinishRecording`方法中，您可以`AVAssetURL`在将其导出为最终电影之前处理 s、轨道、合成和各种事物。真的很酷的东西。然而，它是一个相当困难的框架，有时当事情似乎倒退时令人沮丧 - 仅供参考，iOS 设备上有三种类型的方向，所以视频的旋转会让你想要拔出你的头发。

不过，我真的可以连续几天谈论功能和挫败感，所以只要有可能，请务必查阅 Apple 的文档。这应该让你走上正轨！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-04-29T22:14:54.073

希望有人会发现这很有用，这是一个将视频录制到文件中的快速代码的完整示例：

```
import Foundation
import AVFoundation
import UIKit

// Video Delegate 
class VideoDelegate : NSObject, AVCaptureFileOutputRecordingDelegate
{

    func captureOutput(captureOutput: AVCaptureFileOutput!, didFinishRecordingToOutputFileAtURL outputFileURL: NSURL!, fromConnections connections: [AnyObject]!, error: NSError!) {
    println("capture output : finish recording to \(outputFileURL)")
    }

    func captureOutput(captureOutput: AVCaptureFileOutput!, didStartRecordingToOutputFileAtURL fileURL: NSURL!, fromConnections connections: [AnyObject]!) {
        println("capture output: started recording to \(fileURL)")
    }

} 
```

之后，调用 startRecordingToOutputFileURL（假设会话是 AVCaptureSession）：

```
let videoDelegate = VideoDelegate()
let fileOutput = AVCaptureMovieFileOutput()
session.addOutput(fileOutput)
let documentsPath = NSSearchPathForDirectoriesInDomains(.DocumentDirectory, .UserDomainMask, true)[0] as! NSString
let outputPath = "\(documentsPath)/output.mov"
let outputFileUrl = NSURL(fileURLWithPath: outputPath)
fileOutput.startRecordingToOutputFileURL(outputFileUrl, recordingDelegate: videoDelegate) 
```

# php - 如何在 PHP 中检查表单输入的长度

> ID：16020513
> 
> 赞同：-2
> 
> 时间：2013-04-15T16:46:19.557
> 
> 标签：php, mysql

如何在php中检查输入长度？

PS strlen 工作，我的代码的其他部分有误，不便之处敬请见谅。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:49:12.040

哦，但是 strlen/mb_strlen 确实有效 :)

```
$name = isset($_POST['name']) ? $_POST['name'] : null;
$lengthFunction = function_exists('mb_strlen') ? 'mb_strlen' : 'strlen';
if($lengthFunction($name) > 4){
    // $name has > than 4 chars.
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T16:47:56.983

采用`strlen()`

```
if(strlen($_POST['whatever']) > 4) {
   echo 'Limit Exceeded';
} 
```

如果您使用这些条件在用户插入更多字符时抛出错误，只需使用`maxlength`属性，将为您节省一堆验证

# jquery - jQuery改变数据属性

> ID：16020521
> 
> 赞同：0
> 
> 时间：2013-04-15T16:46:44.653
> 
> 标签：jquery

我有三个简单的按钮。

```
<div class="enter-btn">Enter</div>

<div class="all-btn">All</div>

<div class="category-all">
    <div class="back-btn" data-action="">Back</div>
</div> 
```

当您单击`Enter`或时，它会为按钮`All`添加一个`data-action`值。`Back`

```
$(".enter-btn").bind("click", function() {
    $(".back-btn").attr("data-action", "search-home");
});

$(".all-btn").bind("click", function() {
    $(".back-btn").attr("data-action", "category-home");
});

$(".back-btn").bind("click", function() {
   alert($(this).data("action")); 
}); 
```

但是，如果您`Enter`先单击，则按钮`All`上的值`Back`似乎会保留第一个值，而不会获得新值。

我添加了一个简单的 jsfiddle 来显示我的问题。

[http://jsfiddle.net/uCyJx/1/](http://jsfiddle.net/uCyJx/1/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T16:48:23.660

要更改数据属性，请使用数据函数[http://api.jquery.com/jQuery.data/](http://api.jquery.com/jQuery.data/)：

```
$(".back-btn").data("action", "search-home"); 
```

# c# - ReactiveAsyncCommand.RegisterAsyncAction - 缺少完成通知？

> ID：16020522
> 
> 赞同：0
> 
> 时间：2013-04-15T16:46:48.000
> 
> 标签：c#, .net, reactiveui

我正在使用 ReactiveUI。在一个按钮上，我想调用一个网络服务。如果此调用成功，我想更新我的 UI。

使用 注册异步函数时`RegisterAsyncFunction`，您会得到一个可以订阅的 observable。这使您有机会在异步代码返回时运行代码，并且您还可以`ObserveOnDispatcher()`在 UIThread 上运行代码。

唯一的问题是 - 我的命令没有返回值。

我`RegisterAsyncAction`认为是为此目的，但我找不到任何方法知道何时完成此操作。

在这种情况下，使用 ReactiveAsyncCommand 的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T20:38:53.403

hwhoops，看起来你发现了一个错误`RegisterAsyncAction`，它应该返回`IObservable<Unit>`

同时，只需将更正后的版本复制粘贴到您的应用程序中，它只是一个扩展方法：

```
 /// <summary>
    /// RegisterAsyncAction registers an asynchronous method that runs
    /// whenever the Command's Execute method is called and doesn't return a
    /// result.
    /// </summary>
    /// <param name="calculationFunc">The function to be run in the
    /// background.</param>
    public static IObservable<Unit> RegisterAsyncAction(this IReactiveAsyncCommand This, 
        Action<object> calculationFunc,
        IScheduler scheduler = null)
    {
        return This.RegisterAsyncFunction(x => { calculationFunc(x); return Unit.Default; }, scheduler);
    } 
```

> 你也可以`ObserveOnDispatcher()`在 UIThread 上运行代码。

你实际上不需要这样做，RxUI 已经保证结果`Register*`会在 UI 线程上返回。

# jasper-reports - 错误 6632 碧玉服务器

> ID：16020532
> 
> 赞同：2
> 
> 时间：2013-04-15T16:47:25.720
> 
> 标签：jasper-reports, ireport, jasperserver

我们正在使用*iReport 5*和*JasperReports Server 5*。W 有一个基于*MySQL 存储过程*的报告，该过程在 Designer 中运行良好，但从服务器运行时抛出 6632 错误。

存储过程接受 3 个参数，我已将参数设置为服务器上的输入控件。当我们从服务器运行报告时，我们收到以下错误：

```
2013-04-16 22:20:00,968 ERROR Validator,pool-1-thread-9:493 - Invalid SQL:An error has occurred. 
Please contact your system administrator. (6632), SQL: call sp_fasb(?, ?, ?)
2013-04-16 22:20:00,968 ERROR AsyncJasperPrintAccessor,pool-1-thread-9:258 - Error during report execution
com.jaspersoft.jasperserver.api.JSSecurityException: An error has occurred. Please contact your system administrator. (6632)
at com.jaspersoft.jasperserver.api.security.validators.Validator.validateSQL(Validator.java:494)
at com.jaspersoft.jasperserver.api.engine.jasperreports.util.JRTimezoneJdbcQueryExecuter.createDatasource(JRTimezoneJdbcQueryExecuter.java:167)
at net.sf.jasperreports.engine.fill.JRFillDataset.createQueryDatasource(JRFillDataset.java:1086)
at net.sf.jasperreports.engine.fill.JRFillDataset.initDatasource(JRFillDataset.java:667)
at net.sf.jasperreports.engine.fill.JRBaseFiller.setParameters(JRBaseFiller.java:1258)
at net.sf.jasperreports.engine.fill.JRBaseFiller.fill(JRBaseFiller.java:877)
at net.sf.jasperreports.engine.fill.BaseFillHandle$ReportFiller.run(BaseFillHandle.java:120)
at com.jaspersoft.jasperserver.api.engine.jasperreports.service.impl.EngineServiceImpl$SynchronousExecutor.execute(EngineServiceImpl.java:859)
at net.sf.jasperreports.engine.fill.BaseFillHandle.startFill(BaseFillHandle.java:165)
at com.jaspersoft.jasperserver.api.engine.jasperreports.service.impl.EngineServiceImpl$AsynchronousReportFiller.fillReport(EngineServiceImpl.java:821)
at com.jaspersoft.jasperserver.api.engine.jasperreports.service.impl.EngineServiceImpl.fillReport(EngineServiceImpl.java:1622)
at com.jaspersoft.jasperserver.api.engine.jasperreports.service.impl.EngineServiceImpl$ReportFill.runReport(EngineServiceImpl.java:1005)
at com.jaspersoft.jasperserver.api.engine.jasperreports.service.impl.EngineServiceImpl$ReportRunnable.run(EngineServiceImpl.java:881)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
at java.lang.Thread.run(Thread.java:722) 
```

在以前的版本中，这被报告为需要 SQL Validation 属性的正则表达式，或者需要延长基础查询中字符数的大小，我们尝试了这两种方法都没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T09:26:40.637

此错误与 4.5 中的 SQL 注入安全相关修复有关

1.  请检查您正在运行的报告不包含在查询开始时有注释的 SQL 查询。从 4.5 开始，将不允许此类查询，因为它们会带来 SQL 注入安全风险。

2.  您能否从“jasperserver.log”中添加确切的错误日志以获取确切的错误消息。然后我们将能够通过配置安全相关的属性文件为您提供正确的解决方法

3.  作为简单的解决方法，您还可以转到 /jasperserver-pro/WEB-INF/classes/esapi/security-config.properties 文件，然后禁用 SQL 注入的安全性：-

    ```
     security.validation.sql.on=true 
    ```

    至

    ```
     security.validation.sql.on=false 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-15T01:20:29.377

使用 Jaspersoft Studio 6.1.1 并尝试获取与 Jasper Server 5.5.0 兼容的报告，我发现我所要做的就是添加 language="SQL" 作为 queryString 的属性，然后 6632 错误就停止了。我不确定为什么会丢失，但就我而言。

```
<queryString language="SQL">
    <![CDATA[call sp_fasb(?, ?, ?)]]>
</queryString> 
```

# asp.net-mvc - 在 NopCommerce 2.5 中修改页面布局

> ID：16020533
> 
> 赞同：1
> 
> 时间：2013-04-15T16:47:34.877
> 
> 标签：asp.net-mvc, nopcommerce

我正在尝试修改 NopCommerce 2.5 中某些页面的布局，例如。首先，将“关于我们”的布局从三列页面更改为两列页面，并对通过 URL 字符串（例如 www.mysite.com /c/2/computers）访问的页面布局进行一些更改。类别和制造商。

我可以使用“联系我们”和“主页”等页面来执行此操作，但我似乎无法在 VWD 中找到文件来修改它们。有谁知道去哪里可以找到它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T10:47:19.050

要更改类别页面或制造商页面的布局，您应该编辑文件

'Nop.Web\Views\Catalog\CategoryTemplate.ProductsInGridOrLines.cshtml'

或者

'Nop.Web\Views\Catalog\ManufacturerTemplate.ProductsInGridOrLines.cshtml' 分别。

# javascript - 创建新的 HTML 表单而不重置之前的输入

> ID：16020536
> 
> 赞同：0
> 
> 时间：2013-04-15T16:47:45.460
> 
> 标签：javascript, html, forms, input

我的 JavaScript 中有这两行代码，它们创建两个新的 HTML 表单，供用户在每次调用包含函数时输入数据。现在，每次创建新的 2 个表单时，都会删除以前的输入，我想我知道为什么，这与第二行以及我如何设置 innerHTML 有关。我似乎无法找到另一种方法，但是，非常感谢任何帮助！

谢谢。

```
var newForm = "<b>Checkpoint " + markerId + ":</b> Name <input type='text' id=" + markerId + "> Description <input type ='text' id=" + markerId + "desc style='width:480px;height:58px;'>     <button type='submit' value='Remove' onClick='remove_checkpoint();' /> <br />";
document.getElementById("divForms").innerHTML = document.getElementById("divForms").innerHTML  + "<br />" + newForm; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T16:50:44.750

了解诸如[createElement](https://developer.mozilla.org/en-US/docs/DOM/document.createElement)和[appendChild 之](https://developer.mozilla.org/en-US/docs/DOM/Node.appendChild)类的 DOM 方法。

```
var div = document.createElement("div");
div.innerHTML = "<b>Your code</b>";
document.getElementById("divForms").appendChild(div); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T16:51:30.353

您得到的内部 html 不包含您在该字段中键入的值（只需尝试显示源以说服自己）。我认为您正在寻找的是[jQuery append 方法](http://api.jquery.com/append/)（如果您可以使用 jQuery...）

# regex - 正则翻译，找不到什么意思

> ID：16020539
> 
> 赞同：1
> 
> 时间：2013-04-15T16:47:47.863
> 
> 标签：regex

我查看了 MSDN 和谷歌搜索，但找不到我应该如何解释这个表达式......

这是一个地址参数....

```
^[a-zA-Z\\\d/\\\\\\\\]{0,80}$ 
```

我知道任何大写/小写字母、数字都是允许的，并且最多允许 80 个字符。

我不明白这4个`\`是干什么用的。

我希望这个正则表达式允许特殊字符，因为它是表单的街道地址输入字段。例如，我希望这表示可以将 2400 Tam O'Shanter Place 或 1904 Billings-Harper Terrace 输入该字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:55:19.720

There are 5 redundant `\` characters (which are all escaped by `\`). You only need one (escaped, of course) to allow a literal `\` to be entered.

That said, this looks like a terrible way to validate street addresses:

*   It doesn't allow hyphens, which are common (eg, `101-204 Main st`) or apostrophes (eg `O'shanter`) or several other characters used in addresses
*   It's limiting the address entry to 80 characters, which seems arbitrary and possibly too short

Generally speaking, I wouldn't validate addresses, unless you actually want to do a post-office (or delivery company) lookup to validate it's a real, actual address, and even then it's fraught with problems (eg, new address that isn't in the database yet, or it includes a Suite # that is not in the database).

Payment processors will also let you validate addresses against the credit card numbers, mostly as a form of fraud protection.

What's the point of validation? If you're shipping something, the onus is on the customer (who is presumably both paying and entering this address) to validate the correct address. Until you know why it needs to be valid, and exactly what is "valid", you can't use validation.

You can maybe require non-blank, or a minimum # of characters, but even that may get you into trouble with international users (depending on scope of this app).

# windows - 为什么不能从后台线程访问 Windows GUI？

> ID：16020541
> 
> 赞同：0
> 
> 时间：2013-04-15T16:48:02.343
> 
> 标签：windows, multithreading, thread-safety

我知道在 Windows 应用程序后台线程不允许直接访问 GUI 项。我不完全明白为什么。我找到的最接近的解释是这个：

> 对 Windows 窗体控件的访问本质上不是线程安全的。如果您有两个或更多线程操作控件的状态，则可能会强制控件进入不一致的状态。其他与线程相关的错误是可能的，例如竞争条件和死锁。确保以线程安全的方式执行对控件的访问非常重要。

这是来自[这个 MS 文档](http://msdn.microsoft.com/en-us/library/ms171728.aspx)。

任何人都可以详细说明两个线程可以做什么会使窗口项进入不一致状态的具体示例吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T19:10:52.567

Winforms 和 WPF 不是线程安全的，因为 Windows 窗口不是线程安全的。通常，具有大量状态的大量代码永远不是线程安全的，要做到这一点太难了。它不仅限于 user32 和 gdi32，例如浏览器也不是线程安全的。即使微软竭尽全力使 Windows 线程安全，它在实践中仍然不能很好地工作。因为这不会自动使您的代码线程安全。如果线程不协调以确定窗口的外观，您仍然会遇到故障。一个很难解决的问题，我有伤疤来证明它。通用的解决方案是只让一个线程负责其内容。

在 Windows 中，只有 kernel32 是线程安全的。必然如此，如果不是这种情况，您将无法安全地使用线程。你在 kernel32 api 函数中看到了这一点，它们做的事情非常小，影响非常小的状态。

# zepto - zepto 用于调整窗口大小事件的 flickable.js 方法？

> ID：16020545
> 
> 赞同：0
> 
> 时间：2013-04-15T16:48:21.990
> 
> 标签：zepto, flickable

问题是一旦我设置了这个功能：

```
$('#survey').flickable({segments:num_segments}); 
```

我找不到重置、销毁或覆盖它的方法。因此，如果用户翻转平板电脑或调整其浏览器窗口的大小，则片段会以错误的宽度轻弹（在页面加载时设置）。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T14:15:42.243

我遇到了同样的问题并看到了你的问题，所以查看代码并提出了这个解决方案，它工作正常:)

```
function readDeviceOrientation() {                    
    if ($('.carousel-list')) {
      $('.carousel-list').attr('data-segment-px', $('.carousel-container').width());
      $('.carousel-list').flickable('segment', $('.carousel-list').flickable('segment'));
    }
}

window.onorientationchange = readDeviceOrientation 
```

# c# - 在 C# 中将字符串解析为 DateTime 对象

> ID：16020547
> 
> 赞同：3
> 
> 时间：2013-04-15T16:48:23.337
> 
> 标签：c#, string, parsing, c#-4.0, datetime

我正在尝试将字符串日期和时间解析为单个 .NET DateTime 对象。我有以下代码：

```
string dtObjFormat = "dd MMM YYYY HH:mm";
string mydatetimemash = e.Date + " " + e.Time; // this becomes 25 May 2013 10:30
DateTime dt;

if (DateTime.TryParseExact(mydatetimemash, dtObjFormat, CultureInfo.InvariantCulture, DateTimeStyles.None, out dt))
{
    Console.WriteLine(dt);
} else 
{
    dt = DateTime.Now;
    Console.WriteLine(dt);
} 
```

但是 TryParseExact 总是为我返回 false，这意味着 Parse 失败。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:24:39.863

您的 Y 需要小写，如下所示：

```
string dtObjFormat = "dd MMM yyyy HH:mm";
string mydatetimemash = e.Date + " " + e.Time; // this becomes 25 May 2013 10:30
DateTime dt;

if (DateTime.TryParseExact(mydatetimemash, dtObjFormat, CultureInfo.InvariantCulture, DateTimeStyles.None, out dt))
{
    Console.WriteLine(dt);
} else 
{
    dt = DateTime.Now;
    Console.WriteLine(dt);
} 
```

# java - 如何在 Eclipse 中找到 Java API 中的方法

> ID：16020551
> 
> 赞同：1
> 
> 时间：2013-04-15T16:48:34.080
> 
> 标签：java, eclipse, api, mockito

我开始使用 Mockito，但是当我调用像 when(); 这样的方法时 Eclipse 没有向我显示导入类选项，所以，我想知道 Eclipse 是否有办法搜索 jar 中的方法并知道我可以导入哪些方法。

我知道在 Delphi 中我们可以找到，键入过程或函数，IDE 会告诉你正确的单元放置......

那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T22:44:32.837

您可以将 Mockito 和 Matchers 添加到您的“内容辅助收藏夹”中，这样​​它们甚至会在您将类导入源文件之前显示出来，只要您已将 Mockito 作为库添加到您的项目中。

![Eclipse 内容辅助](https://i.stack.imgur.com/5ijG8.png)

1.  转到`Window > Preferences`并导航到`Java > Editor > Content Assist > Favorites`。
2.  单击“新建类型...”按钮并添加`org.mockito.Mockito`.
3.  对 .做同样的事情`org.mockito.Matchers`。Mockito 类实际上扩展了 Matchers 以访问其静态方法，例如`any`and `eq`，但 Eclipse 不喜欢自动显示这些方法。

要对其进行测试，请尝试在新文件中键入“wh”并按 Ctrl-Space。应该出现一个完成`when()`；使用 Enter 选择它会自动导入`Mockito.when()`到您的静态导入中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T16:51:07.507

只需手动添加`import static org.mockito.Mockito.*;`到文件的顶部。Eclipse 可以很容易地找到类，但我想它不会在类中搜索静态方法。

无需自己粘贴即可获得导入的一种方法是键入`Mockito.when`. 我相信应该有一个静态导入方法的选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T16:56:20.297

确保 Mockito jar 实际上在您的构建路径中。

when() 方法是 Mockito 对象的静态方法。我不是 100% 确定，但我认为你不能只写“when()”，因为 Eclipse 不会知道你在说什么，因为导入的东西是基于导入类的。所以通常你会做一些像 new ArrayList 这样的事情，然后 Eclipse 知道你想要导入 ArrayList，但是当你只是键入 when() 时，Eclipse 不知道你想要导入一个带有 when() 作为静态方法的类。

要以您想要的方式使用 when 您将需要在使用 Mockito 的每个单元测试的顶部执行此操作。

```
import static org.mockito.Mockito.*; 
```

[http://mockito.googlecode.com/svn/branches/1.6/javadoc/org/mockito/Mockito.html#when(T)](http://mockito.googlecode.com/svn/branches/1.6/javadoc/org/mockito/Mockito.html#when(T))

# asp.net-mvc - Asp mvc 4 成员资格和网络安全

> ID：16020557
> 
> 赞同：6
> 
> 时间：2013-04-15T16:48:41.747
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-membership, simplemembership

我需要一个关于做什么的建议。我目前正在使用 WebSecurity 方法来完成所有与帐户相关的工作。但是它不支持电子邮件唯一性验证，所以我有几个选择：

1.  编写（子类）一个新的 SimpleMembershipProvider 覆盖现有的 createuserAndAccount 方法来验证电子邮件地址。但我还必须实现登录-注销功能（就像 websecurity 一样）和其他一些功能。

2.  在数据库上添加唯一性约束并在我的代码中捕获它们。但是，这会导致我依赖于数据库。

3.  这可能有点便宜，但我可以将 WebSecurity 源代码（因为它打开）复制/粘贴到一个新类上，并修改 createUserAndAccount 方法。

还有其他选择吗？我目前的目标是选项 3，这将是最快的方式。附带说明一下，将来我也将需要角色，我不确定 WebSecurity 是否为它们提供支持。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T13:41:34.487

如果是我，我可能会采取以下方式：

首先，假设您将 SimpleMembership 与实体框架或某些数据库连接（ADO、LINQ to SQL 等）一起使用，您将拥有两个组件：`WebSecurity.*`方法调用和用于进行配置文件更改的数据库连接。就我个人而言，我会将其添加`CONSTRAINT`到数据库中以确保您的数据是纯净的，但您也可以实现一个处理此逻辑的会员服务。

首先，将它们分组到可以在控制器中引用的接口中（如下所示）：

```
public interface IMembershipService
{
    Int32 CurrentUserId { get; }
    String CurrentUserName { get; }
    Boolean IsAuthenticated { get; }

    Boolean CreateUserAndAccount(String username, String password, String emailaddress = null);
    Boolean CreateUserAndAccount(String username, string password, out String confirmationToken, String emailaddress = null);
    Boolean Login(String username, String password, Boolean persistCookie = false);
    void Logout();
} 
```

然后，您可以将服务实现为 SimpleMembership 和数据库连接的混合体。为了保持通用性，我使用了该`IRepository<T>`模式，但这可能是直接`DbContext`的 ,`ObjectContext`等。我也保持简短，所以请原谅缺少校验和和简短的实现。

```
public class MembershipService : IMembershipService
{
    protected readonly SimpleMembershipProvider membershiProvider;
    protected readonly SimpleRoleProvider roleProvider;
    protected readonly IRepository<UserProfile> profileRepository;

    public MembershipService(IRepository<UserProfile> profileRepository)
    {
        this.membershipProvider = Membership.Provider as SimpleMembershipProvider;
        this.roleProvider = Role.Provider as SimpleRoleProvider;
        this.profileRepository = userRepository;
    }

    #region IMembershipService Implementation

    public Int32 CurrentUserId
    {
        get { return WebSecurity.CurrentUserId; }
    }
    public String CurrentUserName
    {
        get { return WebSecurity.CurrentUserName; }
    }
    public Boolean IsAuthenticated
    {
        get { return WebSecurity.IsAuthenticated; }
    }

    public Boolean CreateUserAndAccount(String username, String password, String emailaddress = null)
    {
        // validate the email address is unique
        if (!this.profileRepository.Any(x => x.EmailAddress == emailaddress))
        {
            WebSecurity.CreateUserAndAccount(username, password, new
            {
                EmailAddress = emailaddress
            }, createConfirmationToken);
            return true;
        }
        else
        {
            // handle the error how you see fit
            // (maybe even exception?)
            return false;
        }
    }
    public Boolean CreateUserAndAccount(String username, String password, out String confirmationToken, String emailaddress = null, out)
    {
        // validate the email address is unique
        if (this.profileRepository.First(x => x.EmailAddress == emailaddress) == null)
        {
            confirmationToken = WebSecurity.CreateUserAndAccount(username, password, new
            {
                EmailAddress = emailaddress
            }, createConfirmationToken);
            return true;
        }
        else
        {
            // handle the error how you see fit
            // (maybe even exception?)
            confirmationToken = String.Empty;
            return false;
        }
    }
    public Boolean Login(String username, String password, Boolean persistCookie = false)
    {
        return WebSecurity.Login(username, password, persistCookie);
    }
    public void Logout()
    {
        WebSecurity.Logout();
    }

    #endregion
} 
```

现在你可以在你的控制器中引用这个接口并将逻辑放在一个地方。如果您使用的是 DI 容器，显然要注册它，但这里有一个示例实现：

```
public class AccountController: Controller
{
    private readonly IMembershipService membershipService;

    public AccountController(IMembershipService membershipService)
    {
        this.membershipService = membershipService;
    }

    /* ... */

    [HttpPost, ValidateAntiForgeryToken]
    public ActionResult Register(LoginViewModel model, String returnUrl)
    {
        if (ModelState.IsValid)
        {
            if (this.membershipService.CreateUserandAccount(model.Username, model.Password, model.EmailAddress))
            {
                this.membershipService.Login(model.Username, model.Password);
                if (!String.IsNullOrEmpty(returnUrl) && Url.IsLocalUrl(returnUrl))
                {
                    return Redirect(returnUrl);
                }
                return RedirectToRoute("Default");
            }
            else
            {
                ModelState.AddModelError("", "Unable to register.");
            }
        }
        return View(model);
    }

    /* ... */
} 
```

* * *

如果您使用的是 EntityFramework，您还可以使用[`IValidatableObject`](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.ivalidatableobject.aspx). 为了避免重复，这是另一个检查唯一条目的 SO 问题/答案：

[实体框架 IValidatableObject](https://stackoverflow.com/questions/6495157/entity-framework-ivalidatableobject-reference-dbcontext)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T22:40:27.640

使用选项一 1\. 您的自定义成员资格是否继承自 ExtendedMemberShipprovider`AccountMembershipProvider : ExtendedMembershipProvider`

1.  使用 WebSecurity 的包装器进行单元可测试性示例

    ```
     public interface IWebSecurity
                    {

                        bool Login(string userName, string password, bool rememberMe = false);
                        bool ChangePassword(string userName, string currentnPassword, string newPassword);
                        void LogOut();
                    } 
    ```

    公共类 WebSecurityWrapper : IWebSecurity

    {

    ```
     public bool Login(string userName, string password, bool rememberMe)
        {
            return WebSecurity.Login(userName, password, rememberMe);
        }

        public bool ChangePassword(string userName, string currentPassword, string newPassword)
        {
            return WebSecurity.ChangePassword(userName, currentPassword, newPassword);
        }

        public void LogOut()
        {
            WebSecurity.Logout();
        }
    } 
    ```

在这里您可以添加您的电子邮件更改任何您想要的方法

1.  在您的 web.config 中将您的会员提供者注册为默认提供者

# objective-c - 视频列表的 UIView

> ID：16020569
> 
> 赞同：0
> 
> 时间：2013-04-15T16:49:21.160
> 
> 标签：objective-c

我是目标c的初学者，如果问题太愚蠢，请原谅我：P

在这个阶段，我只想从 iphone 库中查询视频并选择视频以获取其 url。我在 UIView 中添加了一个 UITextField 和一个 UIActivityIndi​​catorView。现在我想创建一个区域来添加视频。我应该使用什么用户界面？

这是我现在的界面：

```
@interface videoProcessorViewController : UIViewController
{
    MPMediaQuery *mediaQuery;
    IBOutlet UITextField *feedBackText;
    IBOutlet UIActivityIndicatorView *activityIndicator;
    IBOutlet _____________? videoLibrary;
}
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:54:29.867

您应该使用`UITableView`，这是用于显示信息列表的标准 iOS 控件。将控制器更改为 a`UITableViewController`并将`feedBackText`字段移动到`tableHeaderView`.

这是一个很好的教程，可以帮助您入门：[http ://blog.teamtreehouse.com/introduction-to-the-ios-uitableviewcontroller](http://blog.teamtreehouse.com/introduction-to-the-ios-uitableviewcontroller)

# stored-procedures - 存储过程中的动态sql

> ID：16020572
> 
> 赞同：0
> 
> 时间：2013-04-15T16:49:31.853
> 
> 标签：stored-procedures, sql-server-2008-r2, dynamic-sql

我在创建视图时遇到了问题。我正在尝试创建一个视图，其中一个字段是表中另一个日期之前的 7 个工作日。[Live_Date] 字段由客户端提供，我需要创建日期 [ImageDeliveryDate]。

我已经删除了所有其他字段，因为它们正在工作。我在语法的某个地方有问题，但我似乎找不到。

这是我写的：

```
set @SQL = 'CREATE VIEW vw_GCS_Export
    As
    select  ''' + DATEADD(WEEKDAY,-7,''' + [Live_Date] + '+ CHAR(39) + ')' + CHAR(39) +' '' as [ImageDeliveryDate]

    from Sheet1$' 
```

任何人都可以阐明我在搞砸什么吗？我曾一度运行过它，但现在它失败了。我更改了添加下划线的字段名称，这是唯一的更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T20:40:36.497

这适用于我的 SQL Server 2008 R2 以创建包含 7 天前列的视图：

```
declare @SQL nvarchar(255)
set @SQL = N'CREATE VIEW vw_GCS_Export As
select DATEADD(WEEKDAY,-7,[Live_Date])as [ImageDeliveryDate]
from Sheet1$' 
```

但我不清楚为什么它需要是动态的，而不仅仅是通过常规的 drop/create 创建，或者所有引号的用途（包括 CHAR(39)s）。

# php - Apache RewriteMap 不工作

> ID：16020573
> 
> 赞同：1
> 
> 时间：2013-04-15T16:49:33.097
> 
> 标签：php, regex, apache, mod-rewrite, rewritemap

我正在尝试使用 apache RewriteMap 重写我的一些 URL。

我想变身

www.mywebsite.com/?p=category&id=xxxx

在

www.mywebsite.com/category/channel/program/personnality

我在 php 脚本中使用 id 从数据库中检索必要的变量。

到目前为止它不起作用，经过无数小时的研究，我想我会寻求一点帮助。

我无耻地重用了[这里提供的一些配置](http://www.linuxquestions.org/questions/linux-server-73/using-mysql-to-manage-rewrites-for-apache-793205/)

这是我的 httpd.conf

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteMap redirects prg:/var/www/redirects/redirects.php
RewriteCond ${redirects:%{HTTP_HOST}%{REQUEST_URI}} !^GOOD$
RewriteRule ^/(.*)$ ${redirects:%{HTTP_HOST}%{REQUEST_URI}} [R]
</IfModule> 
```

和我的redirects.php 脚本，可以自己正常工作

```
#!/usr/bin/php
<?php
set_time_limit (0);
$input = fopen ('php://stdin', 'r');
$output = fopen ('php://stdout', 'w');

while (1) {
$original = strtolower (trim (fgets ($input)));

$request = array();
if (preg_match("/[0-9]+/", $original, $request) == 0)
fwrite ($output, "GOOD\n");

$con = mysqli_connect("localhost","user","password","db");

if (mysqli_connect_errno($con))
{
echo "Failed to connect to MySQL: " . mysqli_connect_error();
}

$r = mysqli_query($con, "SELECT media.me_libelle, projet.pro_libelle,  personnalite.per_prenom,personnalite.per_nom FROM image, media, projet, image_personnalite,  personnalite
                              WHERE image_personnalite.per_id=personnalite.per_id and image.pro_id=projet.pro_id and projet.me_id=media.me_id  and image.img_id=".$request[0]." and image_personnalite.img_id=".$request[0]);

if ($r = mysqli_fetch_array($r))
{
$i = 0;
while (isset($r[$i]) && !empty($r[$i]))
  {
    $r[$i] = preg_replace("/\s/", "-", $r[$i]);
    $i++;
  }
$url= strtolower("www.mywebsite.com/"."category/".$r[0]."/".$r[1]."/".$r[2]."-".$r[3]);
}

mysqli_close($con);
fwrite ($output, "http://".$url."\n");
}
?> 
```

# php - 如何连续对齐从数据库中提取的不同表

> ID：16020574
> 
> 赞同：0
> 
> 时间：2013-04-15T16:49:36.650
> 
> 标签：php, css, layout

我试图在我的页面中对齐一些不同的对象，但是发生了一些事情然后不正确。网络是下一个，我不想给广告只是给你和想法：

[http://gocomunio.com/?journey=33](http://gocomunio.com/?journey=33)

代码是下一个：

```
$v = 1;
$s = 1;
while( $equipo = mysql_fetch_assoc( $sele_equipo ) )
{
    $sele_datjornada = "select * from jornada where jornada='$jornada' AND nom_equipo='{$equipo['nombre']}'";
    $sele_datjornada = mysql_query( $sele_datjornada , $link );
    $totEmp = mysql_num_rows( $sele_datjornada );

    if( $totEmp > 0 )
    {
        switch( $v )
        {
            case 1:
                echo "<TABLE CLASS='puntos_izquierda'>";
                break;
            case 2: 
                echo "<TABLE CLASS='puntos_derecha'>";
                break;
            case 3:
                echo "<TABLE CLASS='puntos_centro'>";
                $v = 0;
                break;
            }
$v++; 
```

我将它们对齐在右、左和中心，然后有 3 个箱子和一个柜台谁在提高。这是CSS代码：

```
.puntos_izquierda tr:nth-child(odd){
    width: 100%;
    background-color: #30601e;
    color: white;
    font-weight: bold;
}
.puntos_derecha tr:nth-child(odd){
    width: 100%;
    background-color: #30601e;
    color: white;
    font-weight: bold;
}
.puntos_centro tr:nth-child(odd){
    width: 100%;
    background-color: #30601e;
    color: white;
    font-weight: bold;
} 
```

我需要一种方法来将它们全部对齐而不会出现错误，我也试图使边距顶部但是当我尝试表格变得无序时。

感谢您的帮助，谢谢转发。

# jqgrid - 如何使 jqgrid 组标题在悬停时突出显示

> ID：16020576
> 
> 赞同：0
> 
> 时间：2013-04-15T16:49:47.290
> 
> 标签：jqgrid, header, hover, highlight

使用 jQuery 和 themerolled jquery-ui，我有一个 jqgrid，在几个组标题下有列。每个列标题在按预期悬停时显示突出显示颜色，但组标题在悬停时从不突出显示。悬停时jqgrid组标题可以突出显示吗？这是有问题的代码。

```
$(gridnm).jqGrid('setGroupHeaders', {
    useColSpanStyle: true, 
    groupHeaders:[
        {startColumnName: 'fld00', numberOfColumns: 4, classname: 'colheader', titleText: '<b>Incoming Totals</b>'},
        {startColumnName: 'fld04', numberOfColumns: 3, classname: 'colheader', titleText: '<b>Unanswered Totals</b>'},
        {startColumnName: 'fld07', numberOfColumns: 3, classname: 'colheader', titleText: '<b>Outgoing Totals</b>'},
        {startColumnName: 'fld10', numberOfColumns: 3, classname: 'colheader', titleText: '<b>All Totals</b>'}
    ]
}); 
```

# javascript - 正确的原型继承

> ID：16020577
> 
> 赞同：3
> 
> 时间：2013-04-15T16:49:54.433
> 
> 标签：javascript, inheritance, prototype, prototypal

所以我真的浏览了整个互联网，发现了许多在 javascript 中设置原型继承的不同方法。

他们中的一些人使用`call()`.
他们中的一些人使用这个 sytnax: `var rabbit.prototype = new Animal`。
其中一些在更改原型后更改了构造函数，有些则没有。
有些设置了一个有助于设置继承的小功能。

有人可以对此有所了解吗？有很多关于这个的帖子，但好的帖子已经有 2 年以上的历史了，它们在我心中造成了很大的混乱。
我想一劳永逸地知道如何在javascript中真正正确地设置原型继承。

要是简单点就更好了！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T17:30:21.233

在实现了几种不同的 javascript 继承方式之后，当我想为浏览器 rpg 构建一个 javascript 游戏引擎时，这最终是我所采用的：

播放器基类：

```
function Player(name, type, gender, experience, avatar){
    this.name = name;
    this.type = type;
    this.gender = gender;
    this.experience = experience;
    this.avatar = avatar;

    this.stats ={//getter, setter}
    //lots more code
} 
```

向播放器类添加方法

```
Player.prototype.decrease_life = function(decrement){} 
//note that the keyword this in the decrease_life function will 
//refer to the player that the method is called on. 
```

现在播放器类的继承：

```
function Mage(name, type, gender, exp, avatar){
    Player.apply(this, [name,type,gender,exp,avatar]); 
    //apply allows you to specify what the keyword 
    //this refers to in the Player super class.
}
Mage.prototype = new Player; 
```

最后我们创建一个播放器：

```
current_player =  new Mage(name,type,gender,0,avatar); 
```

这使我们现在可以这样做：

```
current_player.decrease_life(20); //The mage loses 20 life! 
```

或者这样做：

```
current_player.stats.get(); 
//returns the mages stats, it does that because we used apply, and 
//this.stats in the player class is referring to our mage now 
```

正如其他人所提到的，javascript 继承没有最佳实践。我发现上面最接近地模仿了您期望继承在 Java 或 C++ 中的工作方式，它们具有更典型的继承结构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T17:53:39.203

关于原型继承的重要一点是你继承自对象而不是类。所以这个想法是`tomsBankAccount`继承 off `bankAccount`，这可能会通过基于类的语言的实例化来完成。当你想要一个“类”的“实例”时，这将通过一个实现公共特性的对象来完成，它是任何想要这些特性的对象的原型。

这是一个未经测试且错误的具体示例。但这是错误的，我会谈到。

```
var bankAccount = {
    withdraw: function(amount) { this.balance -= amount },
    deposit: function(amount) { this.balance += amount }
}

var account1 = {
    balance: 50
}

account1.prototype = bankAccount
account1.deposit(100)
alert(account1.balance)  // Displays 150 
```

所以一个对象有它自己的东西，比如`balance`字段，但将通用功能委托给 bankAccount 对象。所以继承的等价物是决定一个常见的对象和原型。

实际上，上面的代码被破坏了。JavaScript 不允许您仅对任何旧对象进行原型制作，或者至少**旧**JavaScript 不允许。它强制原型只从从返回的对象中完成，`constructor functions`当你调用它们时，它们在 JavaScript 中具有特殊的语法，即`new`关键字。

您可能已经看到看起来像这样的代码（同样，未经测试）：

```
function BankAccount(balance) {
    this.balance = balance
    this.withdraw = function(amount) { this.balance -= amount }
    this.deposit = function(amount) { this.balance += amount }
}

var account1 = new BankAccount(50)
account1.deposit(100)
alert(account1.balance)  // Same result as last time 
```

您还会注意到它们以大写字母开头。基本上就是这样。`this`很奇怪——它带有对包含函数的对象的引用。所以携带`deposit`方法的对象也携带了`balance`属性，这就是为什么我们可以从方法中访问`balance`via `this`。

但是上面的代码不是惯用的 JavaScript。一旦你掌握了窍门，就会有一些事情要记住。例如，上面为每个对象构造重新分配了新方法，这显然不是很快。这可以通过将方法分配给函数构造函数的原型来解决。还有通过 JavaScript 的闭包“私有化”属性的能力。

您可能会怀疑 JavaScript 用于处理对象的类似 Java 的表示法完全具有误导性，因为它的底层如此不同……我同意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T17:07:17.693

没有真正统一的“最佳方式”来做到这一点。2 岁的“好答案”仍然是相关的（如果它们很好，我个人会丢弃任何试图模拟一个类的东西），因为 javascript（EcmaScript）已经很老了（十多年了）。

`call`用于传递什么`this`。

至于原型继承：我真的很喜欢YUI 剧院[的“crockford on javascript”](http://www.youtube.com/playlist?list=PL7664379246A246CB)。你会想看[“第三幕：发挥终极作用](http://www.youtube.com/watch?v=ya4UHuXNygM)”

设置原型的*最简单*方法是：
`objectIdentifier.prototype.methodIdentifier = function(args){ /* your code*/ }`

有许多不同的“构造模式”，其中大多数都在特定的给定情况下使用。考虑一段代码将要做什么以及使用它的*频率通常是一个好主意。*您还想查看一些流行的库，例如 JQuery，并查看它们的模式。

希望这可以帮助！

# java - Slick2d | 实体碰撞检测

> ID：16020578
> 
> 赞同：3
> 
> 时间：2013-04-15T16:49:55.833
> 
> 标签：java, slick2d

## 问题：

我知道这已经被问过很多次了，但我没有找到任何好的答案。
所以我的游戏有一些实体，现在检查碰撞的最佳方法是什么？

**链接：**

> [***游戏（完）***](https://www.dropbox.com/s/dhvf5vbqj25sgyw/game.jar)

**代码解释：**
*我有一个世界级的实体列表：*

```
List<Entity> entities = new ArrayList<Entity>();
// The list in the World class 
```

*我用这段代码更新它们（只有在视图范围内）：*

```
public void update(GameContainer gc, int delta) {
    for (int i = 0; i < entities.size(); i++) {
        entities.get(i).update(gc, delta);
    }
}
// Update entities 
```

*所以现在我想检查实体更新方法中的冲突。*

**我试过这个作为我的更新方法：**

```
@Override
public void update(GameContainer gc, int delta) {
    for (Entity entity : world.entities) {
        if (intersects(entity)) {
           // world.remove(this);
        }
    }
}
// The update method of an entitiy 
```

**这是当前的 intersects 方法：**

```
public boolean intersects(Entity entity) {
    if (entity instanceof Player) {
        // Do nothing
    } else {
        if (shape != null) {
            return this.getShape().intersects(entity.getShape());
        }
    }

    return false;
}
// The intersects method of the abstract Entity class 
```

目前 intersects 方法总是返回 true。但为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T18:36:01.010

执行此操作的经典方法是为每个实体关联一个 Shape boundingBox，然后在形状上使用 Slick2d 的“intersects”方法：

[http://www.slick2d.org/javadoc/org/newdawn/slick/geom/Shape.html#intersects(org.newdawn.slick.geom.Shape)](http://www.slick2d.org/javadoc/org/newdawn/slick/geom/Shape.html#intersects(org.newdawn.slick.geom.Shape))

我相信有一种方法可以对精灵进行逐像素检查，但是如果您不需要像素级精度，那么边界框方法会更有效。

一些代码：

在您的实体抽象类中添加：

```
private Shape boundingBox;

public Shape getBoundingBox() {
  return this.boundingBox;
} 
```

那么你的 intersects 方法是：

```
public boolean intersects(Entity entity) {
    if (this.getBoundingBox() == null) {
        return false;
    }
    return this.getBoundingBox().intersects(entity.getBoundingBox());
} 
```

然后，您需要为要检查碰撞的每个实体设置一个边界框。

# r - 将数据框列提供给 xyplot 面板函数

> ID：16020581
> 
> 赞同：8
> 
> 时间：2013-04-15T16:50:09.877
> 
> 标签：r, plot, lattice

我在数据框上使用 xyplot 并希望向面板函数提供不是 (x,y, ...) 参数的数据，而是数据框的一些附加列（例如下面示例中的 k）：

```
library(lattice)

mydata <- data.frame(xxx = 1:20,
                     yyy = rbinom(20,20,.5),
                     uuu = gl(2,10),
                     k = rnorm(20))

xyplot( formula = yyy ~ xxx | uuu, data = mydata,
        panel = function(x,y,k, ...){
                n <- x * k
                panel.xyplot(n,y,...)
                }) 
```

我知道这不起作用，因为 R 不会将此 k 列提供给面板函数。有没有一种简单的方法可以做到这一点？

（我不是想在我的实际面板函数中将 x 乘以 k。我正在调用另一个需要 k 的函数......）

非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-15T17:57:05.993

这就是有用（但有些晦涩）的`subscripts`论点的用途。从“面板”参数的描述中`?xyplot`：

> [...] 面板函数可以将“下标”作为正式参数。在任何一种情况下，传递给面板函数的“下标”参数是原始“数据”中该面板的“x”和“y”数据的索引，在考虑“子集”参数的影响之前。

换句话说，一个名为“subscripts”的正式参数将包含`data`参数中的行号，这些行号对应于当前面板中绘制的数据——正是您需要挑选出所需的`k`-values 子集的内容。

在您的情况下，请执行以下操作：

```
xyplot(yyy ~ xxx | uuu, data = mydata, K = mydata$k, pch=16, 
       panel = function(x,y,K, ..., subscripts){
                   n <- x * K[subscripts]
                   panel.xyplot(n,y,...)
               }) 
```

（请注意，此应用程序中有一个奇怪的复杂情况。由于参数的部分匹配， `xyplot()`named的参数`k`将被解释为`key`。为了防止这种情况，我命名了相关参数`K`，以便将其完整地传递给面板函数.)

# php - 无法使用 PHP ODBC 连接写入 MS SQL 数据库

> ID：16020582
> 
> 赞同：0
> 
> 时间：2013-04-15T16:50:13.507
> 
> 标签：php, sql-server-2005, insert, odbc

问题：我可以使用 odbc_exec 在 PHP 中成功使用选择查询，但是我无法执行`INSERT INTO or UPDATE`查询。

资源：Windows Server 2003：IIS 6、SQL Server 2005。

这是我的代码：

```
<?php
require('../_DSN/DSN_M.php');

$cnnOra = odbc_connect($strarrDSN['dsn'], $strarrDSN['username'], $strarrDSN['pswd']);
$res_slct = odbc_exec($cnnOra, " select * FROM person;") or die (odbc_errormsg());

odbc_result_all($res_sldr);

$sqlupd = "UPDATE person SET person_ame='Steve Woz' WHERE pk_person_ID = '32';"

$res_upd = odbc_exec($cnnora, $sqlupd) or die(odbc_errormsg());      
$res_cmt = odbc_commit($cnnora);

var_dump($res_upd);
var_dump($res_slct);
var_dump($res_cmt);

// close the connection 
odbc_close($cnnOra); 
?> 
```

SELECT 查询的输出显示并且页面上没有 errormsg 或 var_dump 结果。

这是 SELECT 查询的输出：

```
pk_person_ID fk_SSN    fk_qual1_ID fk_qual2_ID person_Name 
31           999999999 1           1           bobby buchier 
32           999999999 2           2           Frank Gifford 
```

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T14:00:08.747

我为我找到了解决方案。当我的原始代码没有时，我不确定为什么这会起作用。

我需要使用 odbc_prepare 和 odbc_exec。这是对我有用的代码：

```
$q = "UPDATE person SET person_name = 'Steve Woz' WHERE pk_person_ID = '32'"; 
$res = odbc_prepare ($cnnOra, $q) or die (odbc_errormsg()); 
$exc = odbc_execute($res) or die (odbc_errormsg()); 
```

这也适用于`INSERT INTO`查询。非常感谢@andrewsi！

# html - CSS 布局按钮/文本问题

> ID：16020584
> 
> 赞同：0
> 
> 时间：2013-04-15T16:50:15.170
> 
> 标签：html, css

我在布局时遇到问题 - 想象一下：

我有一个带有一些文本的圆形灰色框，里面有 2 个按钮。

灰色框为页面宽度（约900px），按钮为250px。

文字宽度为 300 像素。

我希望两个按钮右对齐，文本左对齐。

这是我的基本布局：

```
<div id="grey_box">

<p class="text"></p>

<div class="buttons">

<a class="button1"></a>

<a class="button2"></a>

</div>

</div> 
```

出于某种原因，文本总是出现在按钮上方，我希望它们都位于框的中心（垂直方向），灰色框的高度约为 80px。

这是我的CSS：

```
#grey_box {
    height: 80px;
    background: #f4f4f4;    
    width: 900px;
    margin: 0 0 20px 20px;
}

.text {
    float: left;
    width: 450px;
}

.buttons {
    float: right;
    margin-right: 20px; 
    width: 450px;
} 
```

下面是我想要什么的粗略概念。

![在此处输入图像描述](https://i.stack.imgur.com/srrh8.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T16:55:29.607

The issue is that your total width exceeds the container width, so the buttons jump to the next line below the paragraph. You need to factor in the border, margin, and padding when calculating width.

See this corrected **[jsFiddle example](http://jsfiddle.net/j08691/rTKkW/1/)**

```
#grey_box {
    height: 80px;
    background: #f4f4f4;
    width: 900px;
    margin: 0 0 20px 20px;
}
.text {
    float: left;
    width: 350px;
}
.buttons {
    float: right;
    margin-right: 20px;
    width: 450px;
    padding:20px;
    text-align:right;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:58:29.903

你有正确的想法，但是你的元素对于它们的容器来说太宽了。让元素在特定大小的容器中垂直居中的最简单方法是使用`display: table`属性。

[http://tinker.io/e4409/1](http://tinker.io/e4409/1)

```
#grey_box {
    height: 80px;
    background: #f4f4f4;    
    width: 900px;
    margin: 0 0 20px 20px;
    display: table;
}

.text {
    display: table-cell;
    vertical-align: middle;
    width: 450px;
}

.buttons {
    display: table-cell;
    vertical-align: middle;
    margin-right: 20px; 
    /*text-align: right;*/
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-15T16:58:20.623

那是因为您拥有的按钮 div 的宽度为 450 像素，右侧有 20 像素的边距。可用空间：900px 是不够的，因为您实际上需要 450+450+20 像素的灰色框空间。此外，按钮需要 500 像素的空间，因为它们每个都是 250 像素。尝试将灰色框的宽度增加到 1000，或者增加按钮 div 的大小并减小文本 div 的大小。

或者，您也可以使用表格，并在单独的表格单元格中设置每个表格的格式。

```
<table>
<tr>
<td align=left width=300> Text here</td>
<td align=right width=250> Button 1</td>
<td align=left width=250> Button 2</td>
</tr>
</table> 
```

# c# - 未声明“AssemblyInfoFileMask”。由于其保护级别，它可能无法访问

> ID：16020586
> 
> 赞同：3
> 
> 时间：2013-04-15T16:50:19.637
> 
> 标签：c#, azure, msbuild, workflow-foundation-4

我正在创建一个自定义构建 tfs 活动以在 azure 持续集成中使用。

我使用了此博客中的代码： [http ://www.ewaldhofman.nl/post/2010/06/01/Customize-Team-Build-2010-e28093-Part-10-Include-Version-Number-in-the -Build-Number.aspx](http://www.ewaldhofman.nl/post/2010/06/01/Customize-Team-Build-2010-e28093-Part-10-Include-Version-Number-in-the-Build-Number.aspx)

正如您在其公共下方的代码中看到的 AssemblyInfoFileMask 一样。另外请检查屏幕截图以了解我的意思，BuildDetail 它在同一个类上，并且没有在蓝色图标中显示错误。

![在此处输入图像描述](https://i.stack.imgur.com/IO8LF.png)

我也会在这里粘贴代码：

```
[BuildActivity(HostEnvironmentOption.Controller)]
    public sealed class GetAssemblyVersion : CodeActivity<string>
    {
        [RequiredArgument]
        public InArgument<string> AssemblyInfoFileMask { get; set; }

        [RequiredArgument]
        public InArgument<IBuildDetail> BuildDetail { get; set; }

        protected override string Execute(CodeActivityContext context)
        {
            // Obtain the runtime value of the input arguments
            string assemblyInfoFileMask = context.GetValue(this.AssemblyInfoFileMask);
            IBuildDetail buildDetail = context.GetValue(this.BuildDetail);

            var workspace = buildDetail.BuildDefinition.Workspace;
            var vc = buildDetail.BuildServer.TeamProjectCollection.GetService<VersionControlServer>();

            string attribute = "AssemblyFileVersion";

            // Define the regular expression to find (which is for example 'AssemblyFileVersion("1.0.0.0")' )
            Regex regex = new Regex(attribute + @"\(""\d+\.\d+\.\d+\.\d+""\)");

            // For every workspace folder (mapping)
            foreach (var folder in workspace.Mappings)
            {
                // Get all files (recursively) that apply to the file mask
                ItemSet itemSet = vc.GetItems(folder.ServerItem + "//" + assemblyInfoFileMask, RecursionType.Full);
                foreach (Item item in itemSet.Items)
                {
                    context.TrackBuildMessage(string.Format("Download {0}", item.ServerItem));

                    // Download the file
                    string localFile = Path.GetTempFileName();
                    item.DownloadFile(localFile);

                    // Read the text from the AssemblyInfo file
                    string text = File.ReadAllText(localFile);
                    // Search for the first occurrence of the version attribute
                    Match match = regex.Match(text);
                    // When found
                    if (match.Success)
                    {
                        // Retrieve the version number
                        string versionNumber = match.Value.Substring(attribute.Length + 2, match.Value.Length - attribute.Length - 4);
                        Version version = new Version(versionNumber);
                        // Increase the build number -> this will be the new version number for the build
                        Version newVersion = new Version(version.Major, version.Minor, version.Build + 1, version.Revision);

                        context.TrackBuildMessage(string.Format("Version found {0}", newVersion));

                        return newVersion.ToString();
                    }
                }
            }

            return "No version found";
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T20:13:25.813

蓝色感叹号表示您正在尝试将`Variable`/ `Argument`called的值传递`AssemblyInfoFileMask`给`Property`您的 Activity 上的a `AssemblyInfoFileMask`。

您需要自己声明一个参数或变量以传递给您的活动。

如果您希望能够`AssemblyInfoFileMask`在构建定义中设置 ，则需要将其声明为参数。

查看您的图像的此更新版本，您将看到您声明它的位置：

![论据](https://i.stack.imgur.com/UZqn4.png)

一旦你声明了一个 Argument，你需要找到`MetaData`Collection Argument 并将其添加到那里。有关更多详细信息，请参阅[此帖子](http://ericphan.net/blog/2011/5/31/adding-configurable-parameters-to-a-custom-tfs-2010-build-te.html)。

如果您不需要在构建定义中设置它（它对于所有构建都是不变的），那么只需添加 a`Variable`并将其值设置为您需要的 Pattern。

# .htaccess - 如何处理页面刷新

> ID：16020589
> 
> 赞同：2
> 
> 时间：2013-04-15T16:50:31.097
> 
> 标签：.htaccess, angularjs

使用 Angular，`html5Mode(true);`我可以让我的索引页面以`/setup`url 结尾。这很好，除非访问者按 F5 会中断，因为`/setup`目录不存在，它只是一个模拟 URL。

如何确保 Angular 映射正确路由`index.html`并由 Angular 读取，而不是服务器尝试加载索引文件`/setup`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:59:48.090

Anubhava 对我的回答——很接近。您的应用程序中很可能不仅仅是 /setup ......您可能会有多个 URL，并且根据 Anubhava 的回答，您必须`.htaccess`为每个 URL 编辑文件。这是我使用的，它将所有请求转发到索引文件，除非请求的文件/目录实际存在：

```
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_METHOD} !OPTIONS
  RewriteRule ^(.*)$ index.html [L]
</IfModule> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:54:33.730

您必须能够使用 mod_rewrite 来实现。查看 drupal 如何使用它：[http ://drupal.org/getting-started/clean-urls](http://drupal.org/getting-started/clean-urls)

我没有使用过 Angular，但 rewrite 可以将 url 更改为您需要的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T16:55:40.320

您可以禁用对 /setup URL 的直接访问。通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/+setup\s [NC]
RewriteRule ^ /index.hml [R=301,L] 
```

# javascript - 对 FileList 对象进行排序

> ID：16020593
> 
> 赞同：10
> 
> 时间：2013-04-15T16:50:39.877
> 
> 标签：javascript, html, file

我正在尝试使用新的 File API 对输入文件进行排序。它返回的列表似乎是不可变的：

```
var x = "";
var files = e.target.files; // FileList object
// Loop through the FileList and render image files as thumbnails.

files.sort();

> Uncaught TypeError: Object #<FileList> has no method 'sort' 
```

如果我想一次读取多个文件，但我希望它们按顺序到达。（`A.csv`之前处理过`B.csv`，等等）。这是可以实现的吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-15T16:51:47.253

`[].slice.call(files)`把它变成一个真正的数组，然后你就可以使用`.sort`它了。

# batch-file - 批处理/选项卡文件到 csv

> ID：16020594
> 
> 赞同：-1
> 
> 时间：2013-04-15T16:50:40.263
> 
> 标签：batch-file

我需要帮助创建一个将制表符分隔的文件转换为 csv 的批处理文件。我有 4 个单独的文件，用制表符分隔，我需要是 csv。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:44:07.307

从你提供的少量数据来看，

```
@ECHO OFF
SETLOCAL
(
FOR /f "delims=" %%i IN (tdf.txt) DO (
 SET line=%%i
 SETLOCAL enabledelayedexpansion
 ECHO(!line:    =,!
 endlocal
)
) >csv.txt 
```

这应该可以完成这项工作。

问题的关键在于将`ECHO`所有制表符（冒号后的字符）更改为逗号（后的字符串）从旧`=`文件生成新文件的行`csv.txt``tdf.txt`

# java - 无法打开连接异常：通用 JDBC 异常

> ID：16020598
> 
> 赞同：5
> 
> 时间：2013-04-15T16:50:49.717
> 
> 标签：java, jdbc, jboss, oracle11g, connection

我以为我收到了这个错误，因为我没有`ojdbc14.jar`部署 inside `<jbossas.home>/common/lib`。即使我这样做了，问题仍然存在。

**堆栈跟踪**

```
 HTTP Status 500 -

type Exception report

message

description The server encountered an internal error () that prevented it from fulfilling this request.

exception

javax.persistence.PersistenceException: org.hibernate.exception.GenericJDBCException: Cannot open connection
    org.hibernate.ejb.AbstractEntityManagerImpl.throwPersistenceException(AbstractEntityManagerImpl.java:614)
    org.hibernate.ejb.QueryImpl.getResultList(QueryImpl.java:76)
    gov.medicaid.services.impl.RegistrationServiceBean.findByUsername(RegistrationServiceBean.java:156)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)

root cause

org.hibernate.exception.GenericJDBCException: Cannot open connection
    org.hibernate.exception.SQLStateConverter.handledNonSpecificException(SQLStateConverter.java:126)
    org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:114)
    org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)
    org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:52)
    org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:449)
    org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)
    org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:161)
    org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1573)
    org.hibernate.loader.Loader.doQuery(Loader.java:696)

root cause

org.jboss.util.NestedSQLException: Unable to get managed connection for MitaDS; - nested throwable: (javax.resource.ResourceException: Unable to get managed connection for MitaDS)
    org.jboss.resource.adapter.jdbc.WrapperDataSource.getConnection(WrapperDataSource.java:95)
    org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider.getConnection(InjectedDataSourceConnectionProvider.java:46)
    org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)
    org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)
    org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:161)
    org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1573)

root cause

javax.resource.ResourceException: Unable to get managed connection for MitaDS
    org.jboss.resource.connectionmanager.BaseConnectionManager2.getManagedConnection(BaseConnectionManager2.java:441)
    org.jboss.resource.connectionmanager.TxConnectionManager.getManagedConnection(TxConnectionManager.java:381)
    org.jboss.resource.connectionmanager.BaseConnectionManager2.allocateConnection(BaseConnectionManager2.java:496)
    org.jboss.resource.connectionmanager.BaseConnectionManager2$ConnectionManagerProxy.allocateConnection(BaseConnectionManager2.java:941)
    org.jboss.resource.adapter.jdbc.WrapperDataSource.getConnection(WrapperDataSource.java:89)
    org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider.getConnection(InjectedDataSourceConnectionProvider.java:46)
    org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)
    org.jboss.ejb3.ENCPropagationInterceptor.invoke(ENCPropagationInterceptor.java:41)
    org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    org.jboss.ejb3.BlockContainerShutdownInterceptor.invoke(BlockContainerShutdownInterceptor.java:67)

root cause

org.jboss.resource.JBossResourceException: Could not create connection; - nested throwable: (java.sql.SQLException: Io exception: The Network Adapter could not establish the connection)
    org.jboss.resource.adapter.jdbc.local.LocalManagedConnectionFactory.getLocalManagedConnection(LocalManagedConnectionFactory.java:225)
    org.jboss.resource.adapter.jdbc.local.LocalManagedConnectionFactory.createManagedConnection(LocalManagedConnectionFactory.java:195)
    org.jboss.resource.connectionmanager.InternalManagedConnectionPool.createConnectionEventListener(InternalManagedConnectionPool.java:633)
    org.jboss.resource.connectionmanager.InternalManagedConnectionPool.getConnection(InternalManagedConnectionPool.java:267)
    org.jboss.resource.connectionmanager.JBossManagedConnectionPool$BasePool.getConnection(JBossManagedConnectionPool.java:622)
    org.jboss.resource.connectionmanager.BaseConnectionManager2.getManagedConnection(BaseConnectionManager2.java:404)
    org.jboss.resource.connectionmanager.TxConnectionManager.getManagedConnection(TxConnectionManager.java:381)
    org.jboss.resource.connectionmanager.BaseConnectionManager2.allocateConnection(BaseConnectionManager2.java:496)
    org.jboss.resource.connectionmanager.BaseConnectionManager2$ConnectionManagerProxy.allocateConnection(BaseConnectionManager2.java:941)
    org.jboss.resource.adapter.jdbc.WrapperDataSource.getConnection(WrapperDataSource.java:89)
    org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider.getConnection(InjectedDataSourceConnectionProvider.java:46)
    org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)
    org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)
    org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:161)
    org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1573)
    org.hibernate.loader.Loader.doQuery(Loader.java:696)
    org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)
    org.hibernate.loader.Loader.doList(Loader.java:2228)
    org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2125)
    org.hibernate.loader.Loader.list(Loader.java:2120)
    org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:401)
    org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:361)
    org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:196)
    org.hibernate.impl.SessionImpl.list(SessionImpl.java:1148)

root cause

java.sql.SQLException: Io exception: The Network Adapter could not establish the connection
    oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)
    oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:146)
    oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:255)
    oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:387)
    oracle.jdbc.driver.PhysicalConnection.<init>(PhysicalConnection.java:414)
    oracle.jdbc.driver.T4CConnection.<init>(T4CConnection.java:165)
    oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:35)
    oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:801)
    org.jboss.resource.adapter.jdbc.local.LocalManagedConnectionFactory.getLocalManagedConnection(LocalManagedConnectionFactory.java:207)
    org.jboss.resource.adapter.jdbc.local.LocalManagedConnectionFactory.createManagedConnection(LocalManagedConnectionFactory.java:195)
    org.jboss.resource.connectionmanager.InternalManagedConnectionPool.createConnectionEventListener(InternalManagedConnectionPool.java:633)
    org.jboss.resource.connectionmanager.InternalManagedConnectionPool.getConnection(InternalManagedConnectionPool.java:267)
    org.jboss.resource.connectionmanager.JBossManagedConnectionPool$BasePool.getConnection(JBossManagedConnectionPool.java:622)
    org.jboss.resource.connectionmanager.BaseConnectionManager2.getManagedConnection(BaseConnectionManager2.java:404)
    org.jboss.resource.connectionmanager.TxConnectionManager.getManagedConnection(TxConnectionManager.java:381)
    org.jboss.resource.connectionmanager.BaseConnectionManager2.allocateConnection(BaseConnectionManager2.java:496)
    org.jboss.resource.connectionmanager.BaseConnectionManager2$ConnectionManagerProxy.allocateConnection(BaseConnectionManager2.java:941)
    org.jboss.resource.adapter.jdbc.WrapperDataSource.getConnection(WrapperDataSource.java:89)
    org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider.getConnection(InjectedDataSourceConnectionProvider.java:46)
    org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)
    org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)
    org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:161)
    org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1573)
    org.hibernate.loader.Loader.doQuery(Loader.java:696)
    org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)
    org.hibernate.loader.Loader.doList(Loader.java:2228)
    org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2125)
    org.hibernate.loader.Loader.list(Loader.java:2120)
    org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:401)
    org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:361)
    org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:196)
    org.hibernate.impl.SessionImpl.list(SessionImpl.java:1148)
    org.hibernate.impl.QueryImpl.list(QueryImpl.java:102)
    org.hibernate.ejb.QueryImpl.getResultList(QueryImpl.java:67)
    gov.medicaid.services.impl.RegistrationServiceBean.findByUsername(RegistrationServiceBean.java:156)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)

note The full stack trace of the root cause is available in the JBoss Web/2.1.3.GA logs.

JBoss Web/2.1.3.GA 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-15T16:52:35.600

这里的问题是：

```
org.jboss.resource.JBossResourceException: Could not create connection; - nested throwable: (java.sql.SQLException: Io exception: The Network Adapter could not establish the connection) 
```

这通常意味着由于数据库服务器不可用或 jboss 服务器和数据库服务器之间的基础网络问题，您的数据库连接失败。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-15T18:52:06.717

问题是你如何声明你的数据库配置，jdbc，url，用户，通行证，驱动程序......因此服务器拒绝连接......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-24T07:30:10.207

请检查您的 JBoss 服务器配置文件，您可以在其中找到与“MaxConnectionPoolSize”相同的“InUSeConnectionCount”。如果发生这种情况，这意味着您的所有连接都已用完，并且当前没有可以处理您的请求的连接。请刷新您的连接池，然后重试。它肯定会工作:)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-01T17:13:25.043

通常，当您的查询准备出错时，即当您通过连接错误数据类型的字符串以编程方式构建查询时（或）数据库已关闭（或）如果查询因某些异常而执行失败，则通常会出现此问题，然后我们曾经得到 GenericJDBCException。首先尝试检查您的连接，然后验证您准备的查询是否正确。或者，如果可能，您可以在数据库客户端中运行查询。干杯...

# ruby-on-rails - ActiveRecord::Relation 命中 Array 方法而不是我的类方法

> ID：16020600
> 
> 赞同：0
> 
> 时间：2013-04-15T16:50:57.773
> 
> 标签：ruby-on-rails, scopes

在 Rails 3.2 模型中，希望创建一个“to_csv”类方法来从 ActiveRecord 范围生成 CSV 输出，如下所示：

```
class Post
   # ...
   def self.to_csv(options = {})
     CSV.generate(options) do |csv|
       scoped.each {|post| csv << record.attributes.values_at('title', 'text')}
     end
   end
end 
```

我希望我可以像这样使用它：

```
User.first.posts.to_csv 
```

但是，该方法似乎被 Array #to_csv 方法覆盖。即使我这样做：

```
User.first.posts.scoped.to_csv 
```

...并且来自*User.first.posts.scoped*的结果明确是一个 ActiveRecord::Relation，我仍然点击了 Array 方法。如果我将该方法重命名为“to_csvx”之类的名称，它会按预期工作。

我希望有人可以解释 ActiveRecord::Relation 对象如何/为什么优先命中 Array #to_csv 方法而不是 to_csv 类方法。虽然这（一个期望被 AR 范围调用的类方法）似乎是合理的，但我想知道整个想法是否存在固有问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T21:25:04.177

好的，回答我自己的问题超级蹩脚，但基于@m_x 和 Railscast 239 [http://railscasts.com/episodes/239-activerecord-relation-walkthrough](http://railscasts.com/episodes/239-activerecord-relation-walkthrough)的评论我更深入地了解 Rails 源代码......我可以看到 Relation`respond_to`尊重并`method_missing`更喜欢 Array 方法，而不是任何其他未为 Relation 明确定义的方法。

```
# from rails/active_record/relation/delegation.rb

def respond_to?(method, include_private = false)
  super || Array.method_defined?(method) ||
    @klass.respond_to?(method, include_private) ||
    arel.respond_to?(method, include_private)
end

protected

def method_missing(method, *args, &block)
  if Array.method_defined?(method)
    ::ActiveRecord::Delegation.delegate method, :to => :to_a
    to_a.send(method, *args, &block)
  elsif @klass.respond_to?(method)
    ::ActiveRecord::Delegation.delegate_to_scoped_klass(method)
    scoping { @klass.send(method, *args, &block) }
  elsif arel.respond_to?(method)
    ::ActiveRecord::Delegation.delegate method, :to => :arel
    arel.send(method, *args, &block)
  else
    super
  end
end 
```

因此，如果您将 ActiveRecord 的“作用域”类方法命名为与 Array 实例方法相同，则 Relation 将转换为 Array，并且将调用 Array 方法而不是您的类方法。

**简单的解决方案：只需选择另一个方法名称。**

# performance - 如何提高获取 UITableView 的索引部分的性能

> ID：16020608
> 
> 赞同：0
> 
> 时间：2013-04-15T16:51:32.677
> 
> 标签：performance, uitableview, mpmediaitemcollection

我正在为表格视图创建索引部分，以显示 iPod 库中的歌曲标题。为此，我使用 sectionForObject:collat​​ionStringSelector: 循环遍历歌曲查询中的所有 mediaItems。以下代码在 viewDidLoad 中执行，以获取表的节数和每个节的行数：

```
 // Go through the collection of songs and collate them into sections A-Z
        for (MPMediaItemCollection *arrayItem in itemsFromSongQuery) {
            MPMediaItem *representativeItem = [arrayItem representativeItem];   // grab the next object from the collection
            NSString *songName = [representativeItem valueForProperty: MPMediaItemPropertyTitle];
            MPMediaItemArtwork *artWork = [representativeItem valueForProperty: MPMediaItemPropertyArtwork];

            channelButtonTitles *aChannelButtonTitle = [[channelButtonTitles alloc] init];  // create an object to hold both the title and section number
            aChannelButtonTitle.channelTitle = songName;                                                               // save the song name string in this object
            aChannelButtonTitle.channelSubTitle = [representativeItem valueForProperty: MPMediaItemPropertyArtist];    // save the artists string in this object
            aChannelButtonTitle.artwork = [artWork imageWithSize:CGSizeMake(30, 30)];                                   // save the artwork UIImage object
            aChannelButtonTitle.persistentID = [representativeItem valueForProperty:MPMediaEntityPropertyPersistentID]; // save this unique number in case the user wants to play this

            // Then determine which section number it belongs to.
            // The collator will use the channelTitle property of the aChannelButtonTitle object to make this determination
            NSInteger sect = [theCollation sectionForObject:aChannelButtonTitle collationStringSelector:@selector(channelTitle)];
            aChannelButtonTitle.sectionNumber = sect;   // Save the section number that this title string should be assigned to.

            [tempTitles addObject:aChannelButtonTitle]; // Copy the channelButtonTitles object that contains the title and section number in the temp array
            [aChannelButtonTitle release];              // Release the channelButtonTitles object
        } 
```

不幸的是，对于 2000 首歌曲，这需要将近 15 秒。分配 channelButtonTitle 对象的时间和 sectionForObject:collat​​ionStringSelector: 的执行时间都可以忽略不计。

似乎大部分时间都花在了获取 valueForProperty 的行上，尽管这行：

```
MPMediaItem *representativeItem = [arrayItem representativeItem]; 
```

需要 5 秒。

如何提高创建索引部分的性能（或至少提高用户等待某事发生的时间）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T14:35:27.157

由于没有任何其他建议，我发现我可以通过将以下 2 行移动到 tableView:cellForRowAtIndexPath 中来将时间缩短一半：

```
 MPMediaItemArtwork *artWork = [representativeItem valueForProperty: MPMediaItemPropertyArtwork];
        aChannelButtonTitle.artwork = [artWork imageWithSize:CGSizeMake(30, 30)];                                   // save the artwork UIImage object
        aChannelButtonTitle.channelSubTitle = [representativeItem valueForProperty: MPMediaItemPropertyArtist];    // save the artists string in this object 
```

因此，viewDidLoad 仍然会捕获歌曲标题（用于准备索引表）和 persistentID（以启用 tableView:cellForRowAtIndexPath: 以轻松获取艺术品和字幕）。它仍然可以使用一些改进，但更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T17:07:28.373

处理这个问题的更好方法是使用 NSOperationQueue 和 NSOperation。可以在[此处](http://www.icodeblog.com/2010/03/04/iphone-coding-turbo-charging-your-apps-with-nsoperation/%22)找到与此问题相关的不错的教程。

# php - 在 SQL 中查找给定日期的最高温度

> ID：16020609
> 
> 赞同：1
> 
> 时间：2013-04-15T16:51:36.767
> 
> 标签：php, mysql, greatest-n-per-group

我的桌子：

```
hourly_weather                 electrical_readings
----------------               -----------------------
meter | time_read | temp       meter | time      | kwh
----------------               -----------------------
1       1316044800  55         1       1316136250  19.24
1       1316138400  56         1       1316044320  18.29
(...)                          (...) 
```

我想从这些数据中检索两个重要的值：

1）我想要给定一天的总KW

2）我想要那天的最高温度

我正在使用的查询需要 WAYYYY 太长时间才能运行，但我想不出另一种方法来做到这一点。就像，两个表中的 100,000 行数据需要几个小时。

```
SELECT * FROM (
SELECT * , SUM(kwh) AS sumkwh, 
           DATE( FROM_UNIXTIME( r.time_read ) ) AS datex, 
           UNIX_TIMESTAMP( DATE( FROM_UNIXTIME( r.time_read ) ) ) AS datey, 
           (
               SELECT MAX( temp )
               FROM hourly_weather hw
               WHERE hw.meter = 1
                 AND time_read >= datey
                 AND time_read < datey + 86400
           ) AS temp
FROM electrical_readings r
WHERE id = 1
GROUP BY datex
) as t1
WHERE t1.temp != ''; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:07:58.167

我认为在单独的查询中计算这两个值然后加入结果数据集会更简单。您甚至可以定义临时变量和表以使事情变得更容易：

```
# Temp variables for the dates
set @t0 = cast('2013-02-01' as date);
set @t1 = cast('2013-02-02' as date);

# Temporary table 1: Sum of KWH
create temporary table temp_sum_kw
    select 
        date(from_unixtime(timeread)) as `date`, sum(KWH) as sum_kwh
    from 
        electrical_readings
    where 
        timeread >= unix_timestamp(@t0) and timeread < unix_timestamp(date_add(@t1, interval +1 day))
    group by 
        date(from_unixtime(timeread));
alter table temp_sum_kw
    add index idx_date(`date`);

# Temporary table 2: Max temp
create temporary table temp_max_temperature
    select 
        date(from_unixtime(timeread)) as `date`, max(temp) as max_temp
    from 
        hourly_weather
    where 
        (timeread >= @t0 and timeread < date_add(@t1, interval +1 day))
        and meter = 1
    group by 
        date(from_unixtime(timeread));
alter table temp_max_temperature
    add index idx_date(`date`);

# Put it all together
select 
    m.*, t.max_temp
from
    temp_sum_kw as m
    inner join temp_max_temperature as t on m.`date` = t.`date`; 
```

`where`使用条件的原因`timeread >= @t0 and timeread < date_add(@t1, interval +1 day)`是包括直到最后一刻发生的所有事情`@t1`。

希望这可以帮助你

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T17:15:50.833

```
SELECT DATE(FROM_UNIXTIME(r.time_read)) AS datex, 
  SUM(r.kwh) AS sumkwh, MAX(hw.temp) AS temp
FROM electrical_readings r
LEFT OUTER JOIN hourly_weather hw
  ON DATE(FROM_UNIXTIME(r.time_read)) = DATE(FROM_UNIXTIME(hw.time_read)) 
  AND hw.meter = 1
WHERE r.id = 1
GROUP BY datex
HAVING temp IS NOT NULL 
```

这仍然是性能问题，因为这使用了连接表达式。因此，它必须读取两个表的*每一*行，以评估表达式，然后才能判断连接是否满足。

因此，如果您可以为两个表添加一个额外的列作为日期（没有时间）并索引这些列，那会好得多。

```
ALTER TABLE electrical_readings ADD COLUMN date_read DATE, ADD KEY (date_read);
UPDATE electrical_readings SET date_read = DATE(FROM_UNIXTIME(time_read));

ALTER TABLE hourly_weather ADD COLUMN date_read DATE, ADD KEY (date_read);
UPDATE hourly_weather SET date_read = DATE(FROM_UNIXTIME(time_read));

SELECT r.date_read, 
  SUM(r.kwh) AS sumkwh, MAX(hw.temp) AS temp
FROM electrical_readings r
LEFT OUTER JOIN hourly_weather hw
  ON r.date_read = hw.date_read 
  AND hw.meter = 1
WHERE r.id = 1
GROUP BY r.date_read
HAVING temp IS NOT NULL 
```

无论如何，添加`SELECT *`到这些查询中的任何一个都不是一个好主意，因为结果将是任意的。

* * *

回复您的评论，对不起，总和乘以 hourly_weather 中匹配的行数。

*我们可以通过在派生表*子查询中对 hourly_weather 进行聚合来弥补。

```
SELECT r.date_read, 
  SUM(r.kwh) AS sumkwh, hw.temp
FROM electrical_readings r
LEFT OUTER JOIN (
  SELECT date_read, MAX(temp) AS temp
  FROM hourly_weather
  WHERE meter = 1
  GROUP BY date_read) AS hw
    ON r.date_read = hw.date_read 
WHERE r.id = 1
GROUP BY r.date_read
HAVING temp IS NOT NULL 
```

最好在 hourly_weather 上创建一个索引：

```
ALTER TABLE hourly_weather ADD KEY (date_read, meter, temp); 
```

# sql - PL/SQL 触发器在插入后无法读取表

> ID：16020612
> 
> 赞同：0
> 
> 时间：2013-04-15T16:51:46.433
> 
> 标签：sql, database, oracle, plsql, triggers

我正在做一个小项目，复制 CVS 药房数据库。了解 PL/SQL 中的触发器后，我认为创建一个触发器是一个好主意，该触发器将在商店购买产品时更新商店的产品库存（交易）。

现在为了做到这一点，我必须在 productLine_T 上做一个 AFTER INSERT（交易中的产品正在以数量购买的表），存储 transactionID，找到新插入交易的employeeID，从员工那里获取 storeID该交易，然后允许我通过 storeID 获取相应的库存，以通过 productLine_T 中的 orderedQuantity 更新该商店的库存中的 productID。

创建此触发器后，当我尝试插入 productLine_T 时出现以下错误，如上所述：

```
Error starting at line 193 in command:
INSERT INTO productLine_T(transactionID, productID, productQuantity, productFinalPrice)
VALUES(00000006, 00000001, 2, 1.50)
Error report:
SQL Error: ORA-04091: table BSEWARDS.PRODUCTLINE_T is mutating, trigger/function may     not see it
ORA-06512: at "BSEWARDS.ONPRODUCTPURCHASED", line 10
ORA-04088: error during execution of trigger 'BSEWARDS.ONPRODUCTPURCHASED'
04091\. 00000 -  "table %s.%s is mutating, trigger/function may not see it"
*Cause:    A trigger (or a user defined plsql function that is referenced in
       this statement) attempted to look at (or modify) a table that was
       in the middle of being modified by the statement which fired it.
*Action:   Rewrite the trigger (or function) so it does not read that table. 
```

我不明白为什么触发器在插入后无法读取新值？我可以在请求时包含我的 ERD 和任何其他需要帮助的可视化表示。

**触发：**

```
 create or replace 
trigger onProductPurchased
  AFTER INSERT on productLine_T
  for each row
    declare
      transQty productLine_T.productQuantity%type;
      transID productLine_T.transactionID%type;
      prodID productLine_T.productID%type;
      empID Employee_T.employeeID%type;
      stID Store_T.storeID%type;
      --outOfStock exception;
  begin
    --store new transactionID in transID for query
    select transactionID, productID, productQuantity into transID, prodID, transQty
      FROM productLine_T
      WHERE productLine_T.transactionID = :new.transactionID;
    --find store by employee of transactionID to get inventory of store

      -- get employeeID of newly inserted transaction
      select emp.employeeID into empID FROM Employee_T emp, Transaction_T trans
        WHERE trans.transactionID = transID;

      -- get storeID from employee at store who made the transaction
      select st.storeID into stID FROM Store_T st, Employee_T emp
        WHERE emp.employeeID = empID;

      --get inventory by storeID and change inventoryQty based on productID quantity
      update Inventory_T 
        set inventoryQuantity = inventoryQuantity - :new.productQuantity
        WHERE Inventory_T.storeID = stID AND Inventory_T.storeID = prodID;
  end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T18:24:59.013

PL/SQL 中的行级触发器不能`SELECT`从它们所在的表中提取而不会导致[变异表](http://docs.oracle.com/cd/E11882_01/appdev.112/e25519/triggers.htm#LNPLS759)错误。在你的情况下，我认为你甚至不需要`SELECT`从它 - 你不能替换这个：

```
SELECT transactionID, productID, productQuantity into transID, prodID, transQty
FROM productLine_T
WHERE productLine_T.transactionID = :new.transactionID; 
```

有了这个：

```
transID  := :new.transactionID;
prodID   := :new.productID;
transQty := :new.productQuantity; 
```

您遇到的第二个问题是触发器中的两个查询都引用了多个表，但您没有指定任何连接条件，这意味着您将获得两个表的[笛卡尔积](http://en.wikipedia.org/wiki/Cartesian_product)。您实际上并不关心员工，您只关心商店，因此您最好将两个查询替换为一个仅获取您需要的查询：

```
SELECT st.storeID INTO stID
FROM Transaction_T trans
INNER JOIN Employee_T emp ON (emp.employeeID = trans.employeeID)
INNER JOIN Store_T st ON (st.storeID = emp.storeID)
WHERE trans.transactionID = transID; 
```

我在这里对您的架构进行了一些猜测，但它可能足够接近让您到达那里。请注意使用 ANSI 连接语法，它将连接条件（在`ON`子句中）与过滤谓词（在`WHERE`子句中）巧妙地分开。

还值得注意的是，有些人认为使用`SELECT ... INTO ...`语句是不好的形式，因为如果您有零行或多行，则会引发异常。最好将查询放入游标中，然后仅从中获取一次。这样您就知道您只会得到一条记录，并且您可以通过检查[`%NOTFOUND`](http://docs.oracle.com/cd/B19306_01/appdev.102/b14261/cursor_attributes.htm)游标属性轻松防止零记录。

# jquery - jQuery Datatable 按日期和文本排序

> ID：16020616
> 
> 赞同：1
> 
> 时间：2013-04-15T16:51:56.080
> 
> 标签：jquery, jquery-datatables, date-sorting

我有一个相当简单的 jQuery 数据表，它由几列组成，我有一列包含主题、截止日期和简要说明。

![截屏](https://i.stack.imgur.com/GwLzp.png) 我想做的是仅按截止日期对列进行排序，而忽略其余部分。如果我只有日期，这很好用，但是一旦我添加了添加文本，它就不再正确排序。

下面是一段 jQuery 代码：

```
$(document).ready(function() {

        $('#casesDataTable').dataTable(
        {
            "sPaginationType": "full_numbers",
            "aLengthMenu": [[25, 50, 100, -1], [25, 50, 100, "All"]],
            "iDisplayLength": 100,
            "aaSorting": [[1, "desc"]]
        });
   }); 
```

这是一段没有 CSS 的 HTML 代码：

```
<tr>
    <th id="subject" style="width:40%;">
        Subject & Due Date
        <span class="DataTables_sort_icon css_right ui-icon ui-icon-triangle-1-n"></span>
    </th>

    <th id="modified" style="width:10%;">
        Last Modified
        <span class="DataTables_sort_icon css_right ui-icon ui-icon-triangle-1-n"></span>
    </th>

</tr> 
```

```
<td class="center subject">
    <span style="display: none;">9/26/2011</span>
        <div class="padding">
            tester 3
        </div>
        <div class="padding duedate">
        <p>9/26/2011 - Mauris nulla mauris, ornare quis accumsan vitae, consectetur non sapien. In congue dui in sem cursus eleifend. Ut non suscipit augue. Praesent euismod auctor felis, eget pharetra justo euismod a. </p>
        </div>
</td>

<td class="center sorting_1">
     2/9/2011
</td> 
```

```
<td class="center subject">
    <span style="display: none;">4/30/2013</span>
        <div class="padding">
            tester 1
        </div>
        <div class="padding duedate">
            <p>4/30/2013 - Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque adipiscing rutrum lacinia. Donec ullamcorper ligula eu purus semper semper. Sed in est et nibh condimentum semper quis ultricies u...</p>
        </div>
</td>

<td class="center sorting_1">
    4/15/2013
</td> 
```

```
 <td class="center subject">
    <span style="display: none;">5/16/2012</span>
                <div class="padding">
                    tester 2
                </div>
                <div class="padding duedate">
                <p>5/16/2012 - Nullam viverra, urna a tempus scelerisque, odio purus ultricies nibh, mollis pellentesque justo est quis augue. Quisque nec odio libero, tempus viverra leo.</p>
                </div>
    </td>

    <td class="center sorting_1">
         2/9/2012
    </td> 
```

```
 <td class="center subject">
    <span style="display: none;">5/16/2010</span>
                <div class="padding">
                    tester 4
                </div>
                <div class="padding duedate">
                <p>5/16/2010 - In vulputate rutrum elit nec mattis. Integer ullamcorper vestibulum sapien adipiscing gravida. Nullam quis ante diam, vel luctus elit. Quisque id adipiscing erat. ?</p>
                </div>
    </td>

    <td class="center sorting_1">
         2/9/2010
    </td> 
```

当我运行此脚本并按“上次修改时间”排序时，它工作正常，但如果我按“主题和截止日期”排序，它会搞砸，当我试图让它按隐藏的截止日期排序时跨越每个 .

任何人都知道如何做到这一点，或者可以看到我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:57:30.617

I had a similar problem and found the solution the other day.

For any column, you can specify an iDataSort parameter which specifies the alternative column to sort by. You can combine this with an extra column that you just have the date in, but hide that column using bVisible = false.

See the column help at [http://datatables.net/usage/columns](http://datatables.net/usage/columns)

# c - C中多图的任何好的实现？

> ID：16020620
> 
> 赞同：3
> 
> 时间：2013-04-15T16:52:15.080
> 
> 标签：c, multimap

我正在尝试将一些 Delphi 代码移植到 C 库中，但它的中心结构是基于多映射的。由于没有任何类型的泛型，也没有对动态数组的语言级支持，在 C 中构建我自己的多重映射会非常痛苦。但我认为有人已经在某个地方编写了一些。我在哪里可以找到 C 的良好多映射实现？

（另外，为了澄清，这里的“multimap”标签注释说“一种类似于地图但允许重复键的结构。”我对此有点困惑，因为这不是我熟悉的多地图容器。我需要的是“类似于地图的结构，但允许每个（唯一）键有多个值。”换句话说，`multimap<x, y> = map<x, list<y>>`。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T18:39:23.010

虽然不是直接的多图库，[但 uthash](http://troydhanson.github.io/uthash/userguide.html "乌萨什")在 C 中实现了一个简单的关联数组，并且只是一个头文件，因此它具有相当的可移植性和低环境开销。

使用 utash，您可以简单地创建一个多级关联数组，将子关联数组视为集合。uthash 文档提供了一个创建和使用多级关联数组的[简单示例。](http://troydhanson.github.io/uthash/userguide.html#multilevel "utash 中的多级关联数组")

# php - Zend_Test_PHPUnit_ControllerTestCase 中的 assertHeader 不起作用？

> ID：16020629
> 
> 赞同：1
> 
> 时间：2013-04-15T16:52:54.727
> 
> 标签：php, unit-testing, zend-framework, phpunit

我开始为 zend 框架中的应用程序编写一些单元测试。环顾四周，我来到了 PHPunit，然后来到了 Zend_Test（它又扩展了 PHPunit）。

所以我选择用 Zend_Test 编写测试，因为它给了我一些 zend 框架特定的断言......

一切都很好，直到我不得不在测试中检查响应头......我的直觉是使用`$this->assertHeader($headerNameToCheckIfItExists)`断言。不幸的是它**失败了**。所以我开始寻找它失败的原因......我检查了我的应用程序是否在响应中设置了标头（并且它设置正确），然后我检查`curl`了原始响应 Http 标头。响应中似乎存在应用程序设置的标头！

*那么问题是什么？*

问题是在 zend 应用程序中，可以使用`$this->setHeader($headerName, $headerValue)`方法和方法设置标头`$this->setRawHeader($headerNameAndHeaderValue)`。还有`$this->getHeaders()`和`$this->getRawHeaders()`分别将标头作为键值对数组或纯字符串数组获取。（查看源代码，我发现有 2 个不同的标头数组 - 一个带有键值元素，另一个带有纯字符串元素）

在我的应用程序中，我使用了`$this->setRawHeader($headerNameAndHeaderValue)`并且`$this->assertHeader($headerNameToCheckIfItExists)`失败了。如果我使用`$this->setHeader($headerName, $headerValue)`不会`$this->assertHeader($headerNameToCheckIfItExists)`失败...

因此，似乎只通过查看来`$this->assertHeader($headerNameToCheckIfItExists)`检查`$headerNameToCheckIfItExists`标题名称是否存在`$this->getResponse()->getHeaders()`！

请，如果有人对这篇文章的这个“缺点”答案有所了解。

我所做的解决方法是`$this->assertHeader($headerNameToCheckIfItExists)`在我的测试用例文件中重载：

```
public function assertHeader($header, $message='') {
    $all_headers = array();
    foreach ($this->getResponse()->getRawHeaders() as $str) {
        $components = explode(":", $str);
        $all_headers[] = array('name' => $components[0],
                'value' => trim($components[1]),
                'replace' => false);
    }
    $all_headers = array_merge($all_headers, $this->getResponse()->getHeaders());

    foreach ($all_headers as $h) 
        if ($h['name'] == $header)
            return $this->assertTrue(true, $message);

    $this->fail('no header with name: '.$header);    
} 
```

我的zend框架版本：

```
zf show version
Zend Framework Version: 1.10.6 
```

# asp.net - Sharepoint 2010 页面类型

> ID：16020631
> 
> 赞同：1
> 
> 时间：2013-04-15T16:53:15.620
> 
> 标签：asp.net, sharepoint

我一直在互联网上试图以直接的方式搜索这个问题的基本答案。

SP 2010 有哪些类型的页面？据我了解，有两种类型：应用程序页面和网站页面。然后将站点页面进一步分类为发布页面和 Web 部件页面。那是对的吗？

有人可以向我指出互联网上的可靠资源，该资源可以提供不同类型页面的宏观视图，而无需深入了解每个页面的复杂性吗？因为我已经做 SP 2010 很长时间了，但这个基本概念仍然让我感到震惊，因为我不完全理解这些不同页面类型的 WHY 部分。难道我们不能只使用简单的 ASPX 结构并为我们想做的任何事情编写我们自己的代码吗？例如，像平常一样创建用于在 Internet 上发布的 ASPX 页面，就像制作 ASP.NET 页面一样，然后根据需要添加 Web 部件等等。

为什么需要将这些不同的页面类型作为框架的一部分？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T20:23:08.450

*“我们不能只使用简单的 ASPX 结构并为我们想做的任何事情编写我们自己的代码吗？”*

MSDN 上有一个页面提供有关 ASD.NET 开发人员的 SharePoint 的信息：http: [//msdn.microsoft.com/en-us/library/ee536974%28v=office.14%29.aspx](http://msdn.microsoft.com/en-us/library/ee536974%28v=office.14%29.aspx)还有一个关于“页面”：http: [//msdn.microsoft.com/en-us/library/ff512772%28v=office.14%29.aspx](http://msdn.microsoft.com/en-us/library/ff512772%28v=office.14%29.aspx)

这应该回答你的问题。它还给出了站点页面和应用程序页面之间的区别以及区别是什么以及进一步的划分。

如果您在“下滑道”上单击更高，您会发现更多信息。

您仍然可以通过打开 aspx 页面来调整“发布页面”，例如在其中放置一个新的 webpart 区域并对其进行自定义，然后将其保存为新的页面布局以供最终用户使用，然后他们可以将 webpart 放入其中。

# html - 页脚不合适

> ID：16020636
> 
> 赞同：0
> 
> 时间：2013-04-15T16:53:22.817
> 
> 标签：html, css, footer, sticky-footer

我知道这里可能有一百万篇关于不合适的页脚的帖子。我已经阅读了它们并经历了所有这些建议并尝试了它们！

**没用！**

我想知道这是否是因为我有一个 PHP 页脚......我不知道这是否有任何区别！无论如何，这里是代码：

```
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>bla bla</title>
<link rel="icon" href="favicon1.ico" type="image/x-icon">

<link rel="stylesheet" href="css/style.css">

<script src="js/main.js"></script>
</head>
<body>
<?php include_once("template_top.php"); ?>
<div id="pagecorpo">

contents  

</div>
<?php include_once("template_down.php"); ?>
</body>
</html> 
```

这是我的“template_down.php”的代码：

```
<div id="pagedown">

<span><a href="#">Om porjektet</a></span>
- <span><a href="#">Hjälp</a></span>
- <span><a href="#">Kontakter</a></span>
- <span><a href="#">Privacy policy</a></span>
</div>
<div id="pagedown2">Brand of the website :: 2013</div> 
```

这里是 CSS：

```
body {
    width:1000px;
    height: 100%;
    margin:auto;
    background:#282828;
}

a img {
    border:none;
}

#pagecorpo {
    height:420px;
}

#pagedown {
    width:100%;
    background-color:#87b640;
    height:20px;
}

#pagedown2 {
    width:100%;
    background-color:#fff;
    height:20px;
} 
```

**注意：**我知道我应该有 100% 高度的#pagecorpo，但我已经尝试过了，还有一个带有“clear:both;”的页脚包装器 它真的没有用。因此，这是原始代码。

该页面具有加载动态内容的 javascript 内容（根据用户的交互更改大小）。我希望页脚始终保持在底部...

那么该怎么办？

# perl - 用于修改和转发消息的 Perl smtp 服务器

> ID：16020638
> 
> 赞同：-3
> 
> 时间：2013-04-15T16:53:28.290
> 
> 标签：perl, smtp, message, forward

我需要创建一个用作 smtp 服务器的 perl 脚本。当它收听一封电子邮件时，它应该更改其正文，然后将其重新发送到其他一些电子邮件服务器（MS Exchange 之一）

有没有一种简单的方法可以做到这一点？我应该使用哪些 perl 模块？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:26:39.573

您可以使用以下模块来完成您的任务。

**Net::Server::Mail**接收邮件，检查`DATA`回调作为您可以处理收到的电子邮件的地方。然后您可能应该将它与一些 SMTP 客户端模块（例如**Email::Sender**）混合以发送邮件。

也许您选择采用异步方式并尝试**AnyEvent::SMTP**，它将服务器和客户端组合在一个模块中。

# c++ - 编译器何时不必将函数标记为 inline 为 inline

> ID：16020643
> 
> 赞同：3
> 
> 时间：2013-04-15T16:53:44.620
> 
> 标签：c++, performance, inline

编译器何时不必将标记为 inline 的函数标记为 inline？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T16:58:21.167

最明显的是，当您使用指向函数的指针时，它不能内联函数。如果您传递指针并且（可能稍后）决定通过指针调用函数，编译器必须生成函数的非内联版本。当然，如果直接调用函数，编译器可能仍然内联它。而且编译器也可以随意不内联函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T16:58:39.923

使用`inline`关键字只是对编译器的提示，您建议在使用的地方将其扩展为内联。然而，在预测 L1 和 L2 缓存以及分支预测管道等高级 CPU 功能可能对性能产生影响时，编译器比您以往任何时候都聪明得多。如果编译器决定内联函数会使代码**变慢**或**变大**到无法接受的程度，它就不会内联它。或者，如果它只是因为语法依赖而不能，例如其他代码使用函数指针进行回调，或者在动态/静态代码库中将函数导出到外部。

有关更多解释，请参见[此处。](http://www.parashift.com/c++-faq/inline-and-perf.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T17:36:12.737

如果问题是编译器无法以任何方式内联函数，那么有几个答案。

定义后，一个函数是递归的，其递归级别取决于参数而不是尾递归，那么它不能被内联（在编译时不可能知道函数会有多少次迭代）。通常，不显示尾递归的递归函数不会被内联（即使在编译器可以推断出递归步骤数的情况下）。

在看不到指针初始化的上下文中通过指针使用时。

如果问题不是什么时候保证不被内联，而是什么东西可以让编译器避免内联，还有一些其他的。例如，函数的复杂性和大小，它是否有循环，它已经在执行的内联级别（f 调用 g 调用 h 调用 i...所有这些都可能被内联，但编译器倾向于放弃如果通话次数足够多）.... 还有其他的。您可以尝试从您的编译器供应商那里了解他们运行什么类型的启发式方法来确定何时内联。

# wordpress - 如何将 Javascript 添加到 Wordpress 中的每个非管理页面？

> ID：16020644
> 
> 赞同：2
> 
> 时间：2013-04-15T16:53:44.580
> 
> 标签：wordpress

我有一个插件，我以前只需要在内容页面上加载 Javascript。换句话说，代码`add_filter('the_content', 'insert_js');`就足够了。现在我希望将 Javascript 插入到不是管理页面或搜索结果页面的每个页面中，我想知道是否有一个快捷过滤器名称，或者我是否必须列出所有过滤器。我也只希望将 Javascript 添加到页面一次。如果我必须添加几`add_filter()`行，那很好，但我仍然不确定它们需要是什么。我查阅了插件 API/过滤器参考文档（[http://codex.wordpress.org/Plugin_API/Filter_Reference](http://codex.wordpress.org/Plugin_API/Filter_Reference)），这似乎模棱两可。我也尝试使用**the_category**除其他外无济于事。我还试图弄清楚如何让 Javascript 加载到主页上。我包含的 Javascript 不是静态的，需要根据运行时已知的一些 WP 特定属性（如 URL）生成。任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T19:36:27.707

除了@itskawsar的回答；您可以将函数包装`wp_enqueue_script()`在条件中，以确保它们仅在非管理页面上加载：

```
<?php
function my_scripts_method() {
    if (!is_admin()) {
        wp_enqueue_script(
        'custom-script', // handle
        get_template_directory_uri() . '/js/custom_script.js', // src
        array( 'jquery' ) // dependencies   
        );
    }
}

add_action( 'wp_enqueue_scripts', 'my_scripts_method' );
?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-15T17:50:32.047

用于`add_action`将脚本添加到特定挂钩。一般`wp_head`用于在head部分`wp_footer`添加脚本，在页脚部分添加脚本。检查以下代码：

```
<?php

function add_this_script_footer(){ ?>
    <script type="text/javascript">
        [YOUR JS CODE HERE]
    </script>
<?php } 

add_action('wp_footer', 'add_this_script_footer'); ?> 
```

或者您可以使用`wp_enqueue_script()`添加外部脚本，如下所示：

```
<?php
function my_scripts_method() {
  wp_enqueue_script(
    'custom-script', // handle
    get_template_directory_uri() . '/js/custom_script.js', // src
    array( 'jquery' ) // dependencies
  );
}

add_action( 'wp_enqueue_scripts', 'my_scripts_method' );
?> 
```

`wp_enqueue_scripts`您可以在[http://codex.wordpress.org/Function_Reference/wp_enqueue_script](http://codex.wordpress.org/Function_Reference/wp_enqueue_script)上找到更多详细信息

# c++ - 网格中的最佳路径

> ID：16020645
> 
> 赞同：7
> 
> 时间：2013-04-15T16:53:50.560
> 
> 标签：c++, algorithm, maze

我有一个最佳路径问题要解决。给定一个填充有可步行瓷砖和不可步行瓷砖的 nxn 网格，我必须通过最短路径从 A 点到达 B 点。诀窍是一些可步行的瓷砖包含点。当我达到目标时，要成为一个有效的解决方案，我必须有一定数量的积分。瓷砖上有可变数量的点（或没有），我需要最短的路径才能到达目标，但在途中也至少收集了 M 个点。

我尝试的是 A* 算法，它找到 2 个点之间的最短路径，并尝试对其进行自定义，使其不仅在达到目标时具有停止条件，而且还具有必要的点。它不像我做的那样工作，因为我挡住了路径。

如果您对如何解决此问题或其他更适合的算法有任何建议，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T17:26:39.990

当您处于深度层时，您可以将层添加到图表中`X`-> 您至少收集了`X`点。在图形上从上层添加适当的边，到当前图块的点数`+N`所在的层。`N`

您的图形是无限的，但是您可以在遍历某些边时动态地将层数添加到顶点句柄。由于它是无限的，您无法判断完成是否可达，但您可以检查基础图上的路径是否存在以及是否至少存在一个点。

您应该将完成放置在级别上`>M`。

如果您需要一些说明，请询问=）

**编辑**

正如@Pyrce 所说，如果您打算使用 A* [http://en.wikipedia.org/wiki/Consistent_heuristic ，您还应该提供一致的启发式](http://en.wikipedia.org/wiki/Consistent_heuristic)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T17:29:45.947

如果您仍然遇到这个问题，因为其他答案/评论只能给您一个部分答案 - 这是问题空间的一个裂缝。

您实际上可以使用 A* 进行一些修改来捕获（大部分）无序的 M 点路径。您唯一需要更改的是启发式和终止标准。

首先，您需要更改启发式方法以考虑通过 M 点的路径。启发式必须是可接受且一致的，因此它必须等于小于或等于真实路径成本的值，并且它只能随着您接近目标而减少（必须是单调递增的）。

您可以将您现在采用的路径视为您必须完成的 M 个子路径，每个子路径都充当正常路径。因此，对于单点图（只有一个终止空间），您可以使用标准启发式方法，如欧几里得距离。这是一个贪婪的估计，表明直线路径是最佳的，并且在理想情况下您无法做得更好（这是可以接受的）。

对于不止一条路径，贪婪方法同样表示，点之间的畅通直线路径是您可以走的最快路径。它仍然是一个一致的启发式方法，因为你不能走得更远，仍然有更好的分数。困难的部分是选择 M 点的哪个排序是最快的，没有障碍，以保持可接受的启发式。您可以在图中找到 M 点的最佳选择，其中所有图块都可以通过宽度首先搜索从当前图块到每个 M 个点、到每个 M-1 个剩余点的欧几里得距离，...，到终止方。此操作的成本很高，因为您需要为到达的每个正方形执行此操作 - 但您可以使用动态编程或搜索缓存将所需的摊销计算降低到每步 O(M)。

现在，一旦您拥有 M 点路径，这将是最快的无障碍物，您可以使用该路径中每个点与您当前位置之间的欧几里得距离作为启发式方法。这是一个贪婪的运动估计，所以它总是可以接受的（你不能超过估计的成本）并且它是一致的，因为你不能离开下一个贪婪的最佳点并降低你的成本，因为从当前图块中选择一个不同的贪婪点将不予受理。

最后，您的终止标准需要更改为达到 M 个点，其中最后一个点是终止图块。这模仿了行走的 M 个图，而无需构造 M！可能的图表走。所提供的启发式将让 A* 在不改变底层算法的情况下发挥它的魔力，并且应该尽可能有效，同时保持对通用网格的启发式所需的约束。

# algorithm - 在数组中查找最近的索引号小于给定索引处的数字

> ID：16020647
> 
> 赞同：3
> 
> 时间：2013-04-15T16:53:57.410
> 
> 标签：algorithm, optimization, complexity-theory

这是一个算法优化问题。

我有一个整数数组`A`，想要构建一个数组`B`，其中包含元素的`B[i]`索引，使得 ( )`j``A[j]``B[i] = j`

```
1\. j > i
2\. A[j] < A[i]
3\. j is minimum of all possible j's. 
```

例如，如果`A`是：

```
 A = [1,5,6,4,3,1,2] 
```

然后`B`将是（从 0 开始索引）

```
 B = [-1,3,3,4,5,-1,-1] 
```

`B[0] = -1`因为没有数字小于`1`索引大于`0`。 `B[1] = 3`因为`A[3]`是最靠近索引`1`的元素`A`，其中包含小于 的数字`A[1]=5`。等等。

我知道解决方案`O(n*log(n))`使用二叉搜索树的复杂解决方案。我怎样才能提高复杂性`O(n)`或证明它是不可能的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T17:57:31.713

除非我误解了这个问题，否则您可以通过简单的从左到右扫描来解决它，保留一堆您尚未遇到较小元素的索引。（出于显而易见的原因，与堆栈上的索引对应的值必须是单调非递减的。）

对于输入列表中的每个值，当该值小于堆栈顶部索引（如果有）对应的值时，将输出列表的相应元素设置为当前输入值的索引并弹出堆栈。

下面的 Python 小程序说明了：

```
def ind(a):
  b = [-1] * len(a)
  stack = []
  for i in range(len(a)):
    v = a[i]
    while stack and a[stack[-1]] > v:
      j = stack.pop()
      b[j] = i
    stack.append(i)
  return b 
```

证明它是`O(n)`： for 循环显然是执行`n`次数。while 循环的主体（总共）最多执行`n`一次，因为每个元素只能执行一次。或者，换句话说，每个元素最多被推送和弹出一次。

# c# - CSV Helper 解析器抛出 IOException。无法从传输连接读取数据

> ID：16020648
> 
> 赞同：4
> 
> 时间：2013-04-15T16:54:04.730
> 
> 标签：c#, csv, azure

我在我的 c# 项目中使用 CSVHelper 并将一个大的 csv 数据文件（大约 2000 条记录）读入内存。

[https://github.com/JoshClose/CsvHelper](https://github.com/JoshClose/CsvHelper)

如果记录低于 500，它工作正常，它总是在不同的阶段抛出 IOException，这取决于网络或数字是否上升。我目前部署到Azure云平台，所以从blob存储读取到服务器，应该不是网络问题。

```
CsvHelper.CsvParserException: A parsing error occurred.

Row: '995' (1 based)
 ---> System.IO.IOException: Unable to read data from the transport connection: An existing connection was forcibly closed by the remote host. ---> System.Net.Sockets.SocketException: An existing connection was forcibly closed by the remote host
   at System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)
   --- End of inner exception stack trace ---
   at System.Net.ConnectStream.Read(Byte[] buffer, Int32 offset, Int32 size)
   at System.IO.StreamReader.ReadBuffer(Char[] userBuffer, Int32 userOffset, Int32 desiredChars, Boolean& readToUserBuffer)
   at System.IO.StreamReader.Read(Char[] buffer, Int32 index, Int32 count)
   at CsvHelper.CsvParser.GetChar(Int32& fieldStartPosition, Int32& rawFieldStartPosition, String& field, Boolean prevCharWasDelimiter, Int32& recordPosition, Int32& fieldLength, Boolean isPeek) in c:\Projects\CsvHelper\src\CsvHelper\CsvParser.cs:line 445
   at CsvHelper.CsvParser.ReadLine() in c:\Projects\CsvHelper\src\CsvHelper\CsvParser.cs:line 247
   at CsvHelper.CsvParser.Read() in c:\Projects\CsvHelper\src\CsvHelper\CsvParser.cs:line 108
   --- End of inner exception stack trace ---
   at CsvHelper.CsvParser.Read() in c:\Projects\CsvHelper\src\CsvHelper\CsvParser.cs:line 136
   at CsvHelper.CsvReader.Read() in c:\Projects\CsvHelper\src\CsvHelper\CsvReader.cs:line 173 
```

它抛出 while (csv.read())

```
 var wc = new WebClient();

            using (var sourceStream = wc.OpenRead(fileUrl))
            {

                using (var csv = new CsvReader(new StreamReader(sourceStream)))
                {

                    while (csv.Read())
                    {
                        try
                        {

//some reading operation
}
 catch (Exception ex)
                        {
                            _logger.Error(ex);
                        }
                    }
                    _logger.InfoFormat("Finished {0} reading data #{1}");

                }
            } 
```

在哪里设置流式阅读器超时值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-11T10:30:35.393

使用云资源（无论是 Azure 还是任何其他云资源）时，不应直接读取文件。充其量你应该实现重试逻辑以确保你绕过任何瞬态错误（阅读关于瞬态错误[here](http://blogs.msdn.com/b/agile/archive/2013/05/22/dealing-with-windows-azure-storage-transient-faults.aspx)，[here](http://msdn.microsoft.com/en-us/library/windowsazure/hh851746.aspx)和[there](http://www.windowsazure.com/en-us/documentation/articles/best-practices-troubleshooting/)或者只是在互联网上搜索术语“Transient Error”）。

在您的情况下，我建议您将调用包装在[CloudBlockBlob.DownloadToStream](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.blob.cloudblockblob.downloadtostream%28v=azure.10%29.aspx)方法周围。因此，您仍然可以使用 Stream 来解析文件，但您还将在 .NET Azure Blob API 库的安全性背后工作，该库代表您处理所有暂时性错误。

您的代码将如下所示：

```
// get the CloudblockBlob object
using(MemoryStream blobStream = new MemoryStream())
{
    blobObject.DownloadToStream(blobStream);
    using (var csv = new CsvReader(new StreamReader(blobStream)))
    {
        while (csv.Read())
        {
            try
            {
             //some reading operation
            }
            catch (Exception ex)
            {
                _logger.Error(ex);
            }
        }
        _logger.InfoFormat("Finished {0} reading data #{1}");
    }
} 
```

# ios - twitter rest api - 发布带有用户提及的状态

> ID：16020649
> 
> 赞同：1
> 
> 时间：2013-04-15T16:54:10.077
> 
> 标签：ios, twitter

使用twitter的rest api，特别是方法：

```
https://dev.twitter.com/docs/api/1/post/statuses/update 
```

我正在尝试发布一条包含用户提及（@[screenname]）的推文。但是，除非我对其进行编码，否则 Twitter 似乎不允许我发布任何 @ 符号。我尝试了几种编码技术，但似乎都没有为我提供 twitter 正在寻找的合适编码。

至于问题，“@”应该用什么代替，这样推特才能让我正确传递消息？我正在通过 iphone 应用程序发布命令，出于多种原因，我不能使用 ios 6 新的社交集成，也不能使用 twitter 的 ios api 包装器。

编辑：我尝试过的编码技术 -

*   stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding
*   [如何对字符串进行 URL 编码](https://stackoverflow.com/questions/8088473/url-encode-a-nsstring)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T09:54:55.790

看来我必须使用以下方法专门对 @ 进行百分比编码：

```
bodyString = [bodyString stringByReplacingOccurrencesOfString:@"@" withString:@"%40"]; 
```

希望它会在未来对某人有所帮助。

# c# - Windows 应用商店应用程序 MediaCapture 模拟器崩溃

> ID：16020651
> 
> 赞同：1
> 
> 时间：2013-04-15T16:54:16.863
> 
> 标签：c#, windows-8, windows-store-apps

我在我的应用程序中使用以下函数使用 MediaCapture 类捕获照片并将其复制到剪贴板：

```
 async private void UseCamera()
        {
        var _ImageFormat = ImageEncodingProperties.CreatePng();
        var _fileStream = new InMemoryRandomAccessStream();

        try
        {
            await _mediaCapture.InitializeAsync();
        }

        catch (Exception e)
        {
            new Windows.UI.Popups.MessageDialog(e.Message).ShowAsync();
        }

        try
        {
            await _mediaCapture.CapturePhotoToStreamAsync(_ImageFormat, _fileStream);
        }

        catch (Exception e)
        {
            new Windows.UI.Popups.MessageDialog(e.Message).ShowAsync();
        }

        var _streamRef = Windows.Storage.Streams.RandomAccessStreamReference.CreateFromStream(_fileStream);
        _dataPackage.SetBitmap(_streamRef);

        Clipboard.SetContent(_dataPackage);
        Clipboard.Flush();

    } 
```

该应用程序在我的本地计算机上运行良好。但是当我尝试在模拟器上运行它时，我得到了这个错误：

“在 SensorGridCamera.exe 中发生了“System.UnauthorizedAccessException”类型的异常，但未在用户代码中处理

附加信息：访问被拒绝。（来自 HRESULT 的异常：0x80070005 (E_ACCESSDENIED)）”

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:05:59.580

听起来这是一个权限问题，以管理员身份运行应该修复它。将应用程序清单添加到您的项目中。然后更改`<requestedExecutionLevel level="asInvoker" uiAccess="false" />`为`<requestedExecutionLevel level="requireAdministrator" uiAccess="false" />` 这将强制您的应用程序在运行时请求以管理员身份运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T19:58:27.723

好的，所以我找到了这个对我有用的东西：

诀窍是在 await _mediaCapture.InitializeAsync(); 中传递一个 MediaCaptureInitializationSettings 对象；方法作为参数，在你这样做之前，将对象的 PhotoCaptureSource 属性设置为 VideoPreview，瞧！

```
 MediaCaptureInitializationSettings _cameraSettings1 = new MediaCaptureInitializationSettings();
            _cameraSettings1.PhotoCaptureSource = PhotoCaptureSource.VideoPreview;
            await _mediaCapture.InitializeAsync(_cameraSettings1); 
```

希望能帮助到你。干杯:)

# google-apps-script - Attach a pdf from google drive to an email using google apps script

> ID：16020666
> 
> 赞同：1
> 
> 时间：2013-04-15T16:54:59.547
> 
> 标签：google-apps-script, email-attachments

I'm using a custom created google apps script to send out some emails. I have a PDF in my google drive that I am trying to attach to an email but it is not working. I keep on getting the error "Document is missing (perhaps it was deleted?)"

Here is my full code...

```
 function sendDetails(e) {
var itemURL = 'https://docs.google.com/file/d/0Bw7JWLKeRBKASUFldGM1RTRIaFE/edit';
var docName = DocumentApp.openByUrl(itemURL).getName();
} 
```

Note that the above PDF is a publicly accessible PDF file that anyone can get to. I know it exists but it's not allowing me to access it. All that I am trying to do is take the file and attach it to an email. There is obviously more to my code than the about but I trimmed down just to that to try to narrow the error and no such luck. Any help would be greatly appreciated.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T17:25:53.993

DocumentApp 处理 Google Documents - Google 的类似 WordPad 的编辑器。由于有问题的文件是 PDF，因此 DocumentApp 无法使用它。

相反，您应该使用[DriveApp](https://developers.google.com/apps-script/reference/drive/drive-app)。此外，由于没有通过 URL 打开文件的 DriveApp 方法，因此您需要使用[DriveApp.getFileById()](https://developers.google.com/apps-script/reference/drive/drive-app#getFileById(String))。（ID`"0Bw7JWLKeRBKASUFldGM1RTRIaFE"`在您的示例中。）

# c - 匹配 Lex 中至少包含一个大写和小写字母的字符串，

> ID：16020667
> 
> 赞同：0
> 
> 时间：2013-04-15T16:55:00.183
> 
> 标签：c, regex, lex

我正在尝试匹配包含至少一个大写和至少一个小写字母的 4 到 8 个混合大小写字母的字符串。我试过 [a-zA-z]{4,8} 但它匹配像 abba 和 CREEEDD 这样只包含小写或大写字母的字符串。这是可以在 Lex 中完成的，还是我需要以不同的方式完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:14:54.370

这需要`&`正则表达式中的 (and) 操作，那么下面的代码就可以完成这项工作：

```
((([a-zA-Z]*([a-z][a-zA-Z]*[A-Z])|([A-Z][a-zA-Z]*[a-z]))[a-zA-Z]*)&([a-zA-Z]{4,8}) 
```

但该操作不存在。当然，您可以在混合大小写中列举小写或大写位置的所有可能性，但这将构成一个巨大的表达式。

过滤所有 4 到 8 个字符的字符串以不同方式检查是否存在小写和大写是否可行？也许您可以将第二个正则表达式应用于前者的结果。

作为旁注：理论上没有反对该`&`操作的反对意见，因为确定性有限自动机在交集下是封闭的，尽管状态的数量可能会爆炸。它可能需要对非确定性有限自动机的常用解释器进行重大修改。

哦，如果有人觉得有挑战要有所作为，那么也不要忘记补充。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T17:17:13.387

您需要一个包含零个或多个混合大小写字母的字符串，后跟一个大写字母、零个或多个混合大小写字母、一个小写字母和零个或多个混合大小写字母，或类似的模式，小写字母在大写字母之前案子。

但是，这很混乱。所以，我们可以尝试简化。第一个字符可能是大写的，所以我们需要它后跟零个或多个混合大小写字母，一个小写字母，以及零个或多个混合大小写字母。或者第一个字符可能是小写的，所以我们需要它后面跟着零个或多个混合大小写字母，一个大写字母，再有零个或多个混合大小写字母。

```
[a-z][a-zA-Z]*[A-Z][a-zA-Z]*|[A-Z][a-zA-Z]*[a-z][a-zA-Z]* 
```

剩余的问题是将总长度限制在 4-8 个字符的范围内（注意现在只有 8 个字母字符对于密码来说是可悲的；允许标点符号和数字以及超过 8 个字符）。识别模式后，我将在操作中实现长度验证。

或者，可能更简单，使用您现有的规则：

```
[a-zA-Z]{4,8} 
```

并在操作中应用混合大小写验证：

```
if (islower(yytext[0]) && strpbrk(yytext, "ABCDEFGHIJKLMNOPQRSTUVWXYZ") == 0)
    ...reject...
else if (isupper(yytext[0]) && strpbrk(yytext, "abcdefghijklmnopqrstuvwxyz") == 0)
    ...reject... 
```

# java - Process writing after it's finished?

> ID：16020668
> 
> 赞同：2
> 
> 时间：2013-04-15T16:55:03.090
> 
> 标签：java, process, java.util.scanner

I have a Process started like that:

```
Process process = new ProcessBuilder("sh", "-c", "mongod | tee /tmp/logfile.txt"); 
```

This process, when it's interrupted, gracefully ends, writing to the output stream "dbexit: really exiting now"

So later, I want to kill it:

```
InputStream inputStream = process.getInputStream()
Scanner scanner = new Scanner(inputStream).useDelimiter(Pattern.quote("dbexit: really exiting now"));
//pid taken from grep
Shell.runShellCommand("kill -2 " + pid).waitFor();
scanner.next() 
```

This *always* runs successfully on my machine. But almost never on CI server. scanner.next() throws:

```
java.util.NoSuchElementException: null
    at java.util.Scanner.throwFor(Scanner.java:838)
    at java.util.Scanner.next(Scanner.java:1347) 
```

So it seems like the process ended (or at least closed it's InputStream) before writing "dbexit: really exiting now". But this text is present at the end of `/tmp/logfile.txt`. Is it possible that process InputStream was closed, while it was still writing? And that it was written to the file?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:24:01.343

输入流被缓冲。您从缓冲区读取数据，这些数据是在进程被终止之前写入的。

# u2 - 寻找与 FMT 功能等效的 U2.NET Toolkit

> ID：16020670
> 
> 赞同：1
> 
> 时间：2013-04-15T16:55:17.823
> 
> 标签：u2, unidata, u2netdk

在 UniBasic 中，我可以使用带有格式规范（如“30T”）的 FMT 函数，在长字符串中的适当位置插入文本标记（想想备注/注释）。我在 U2.NET Toolkit 中看不到等效项。

我知道我可以创建一个 UniBasic 子例程，并从 C# 调用它——但我不想这样做。

重述核心问题：在一个 SQL Server 表中，我有一个文本列（任意大，不是 blob）；我希望这最终出现在 Unidata 记录中的多值字段中，每 30 个字符都有 MV 标记（即，类似于 30T 格式）。为了最大限度地减少服务器旅行，我希望它在 C# 中处理。

我已经看到了处理自动换行的各种方法，所以我可能可以做到这一点 - 但首先我想确保 Unidata 的格式化功能不会“隐藏”在 U2.NET Toolkit 的某个地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:48:25.250

只是为了将其标记为已回答，我将从上面的评论中重复：不，U2.NET Toolkit 中当前不存在 FMT 功能。

# html - 如何按内容选择列表项？

> ID：16020671
> 
> 赞同：1
> 
> 时间：2013-04-15T16:55:18.347
> 
> 标签：html, css, css-selectors

我想知道如何通过其内容为列表元素编写 CSS 规则：

```
<ul id="myList">
  <li>first item</li>
  <li>empty</li>
  <li>second item</li>
  ...
</ul> 
```

我想要一个`li`包含*empty*的规则。我可以创建 javascript 嗅探 childNodes 的 innerHTML，但我想知道是否有一个简单的 CSS 解决方案？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:00:16.430

CSS 中还没有文本选择器，CSS 不是一种编程语言，它不知道元素内部是什么，这就是 JavaScript 和 jQuery 的用武之地。

您可以改用 jQuery`:contains()`选择器（是的，我知道您想要 CSS，但这里不可能）

如果您不按`empty`字面意思使用该词并且指的是空元素，则可以使用`:empty`选择器来选择空元素

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:59:15.253

`:empty`您可以使用一个选择器。它匹配每个没有子元素（包括文本节点）的元素。

```
p:empty {
  /* p tags that are empty */
} 
```

Mozilla 文档：[https ://developer.mozilla.org/en-US/docs/CSS/:empty](https://developer.mozilla.org/en-US/docs/CSS/:empty)

> :empty 伪类表示任何没有子元素的元素。仅考虑元素节点和文本（包括空格）。注释或处理指令不会影响元素是否被视为空。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T16:59:23.097

几个月前我也问过[类似的问题。](https://stackoverflow.com/questions/13029001/adblock-plus-filter-how-to-select-element-by-its-child-contents)看来你不能检查元素的内容，所以**没有**. 继续使用 javascript。

# android - Error Canvas: trying to use a recycled bitmap when using setDrawingCacheEnabled(false)

> ID：16020672
> 
> 赞同：0
> 
> 时间：2013-04-15T16:55:18.187
> 
> 标签：android, android-widget

Im using a custom layout and at times I enable and disable the drawing cache.

The only gotcha is that I'm developing for min APIVersion 9, but anything below 14 produces the following error:

```
java.lang.RuntimeException: Canvas: trying to use a recycled bitmap android.graphics.Bitmap@41ee8a88
E/AndroidRuntime( 6954):    at android.graphics.Canvas.throwIfRecycled(Canvas.java:1026)
E/AndroidRuntime( 6954):    at android.graphics.Canvas.drawBitmap(Canvas.java:1065)
E/AndroidRuntime( 6954):    at android.view.View.draw(View.java:13620)
E/AndroidRuntime( 6954):    at android.view.ViewGroup.drawChild(ViewGroup.java:2928)
E/AndroidRuntime( 6954):    at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2797)
E/AndroidRuntime( 6954):    at android.view.View.draw(View.java:13589)
E/AndroidRuntime( 6954):    at android.view.ViewGroup.drawChild(ViewGroup.java:2928)
E/AndroidRuntime( 6954):    at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2797)
E/AndroidRuntime( 6954):    at android.view.View.draw(View.java:13710)
E/AndroidRuntime( 6954):    at android.widget.FrameLayout.draw(FrameLayout.java:467)
E/AndroidRuntime( 6954):    at android.view.View.draw(View.java:13591)
E/AndroidRuntime( 6954):    at android.view.ViewGroup.drawChild(ViewGroup.java:2928)
E/AndroidRuntime( 6954):    at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2797)
E/AndroidRuntime( 6954):    at android.view.View.draw(View.java:13589)
E/AndroidRuntime( 6954):    at android.view.ViewGroup.drawChild(ViewGroup.java:2928)
E/AndroidRuntime( 6954):    at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2797)
E/AndroidRuntime( 6954):    at android.view.View.draw(View.java:13710)
E/AndroidRuntime( 6954):    at android.widget.FrameLayout.draw(FrameLayout.java:467)
E/AndroidRuntime( 6954):    at com.android.internal.policy.impl.PhoneWindow$DecorView.draw(PhoneWindow.java:2211)
E/AndroidRuntime( 6954):    at android.view.ViewRootImpl.drawSoftware(ViewRootImpl.java:2281)
E/AndroidRuntime( 6954):    at android.view.ViewRootImpl.draw(ViewRootImpl.java:2177)
E/AndroidRuntime( 6954):    at android.view.ViewRootImpl.performDraw(ViewRootImpl.java:2045)
E/AndroidRuntime( 6954):    at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1854)
E/AndroidRuntime( 6954):    at android.view.ViewRootImpl.doTraversal(ViewRootImpl.java:989)
E/AndroidRuntime( 6954):    at android.view.ViewRootImpl$TraversalRunnable.run(ViewRootImpl.java:4351)
E/AndroidRuntime( 6954):    at android.view.Choreographer$CallbackRecord.run(Choreographer.java:749)
E/AndroidRuntime( 6954):    at android.view.Choreographer.doCallbacks(Choreographer.java:562)
E/AndroidRuntime( 6954):    at android.view.Choreographer.doFrame(Choreographer.java:532)
E/AndroidRuntime( 6954):    at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:735)
E/AndroidRuntime( 6954):    at android.os.Handler.handleCallback(Handler.java:725)
E/AndroidRuntime( 6954):    at android.os.Handler.dispatchMessage(Handler.java:92) 
```

I'm not directly using any bitmaps, I'm really not sure what the problem is. If I take out the line setting `setDrawingCacheEnabled(false)`, things work, but I'd like to keep it in for performance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T14:14:52.590

Okay I fixed the problem. I was using existing code, but I don't think it had been fully implemented to use the drawing cache. I thought that setting the drawing cache on an existing view was it, and that the view would deal with using the cache for you, but it seems like you actually need to implement it.

I added this to my custom layout and the problem has dissapeared;

```
@Override
public void draw(Canvas canvas) {
    if (cache != null && !cache.isRecycled()) {
        canvas.drawBitmap(cache, x, y, null);
    } else {
        super.draw(canvas);
    }
} 
```

# servlets - How to add header to all Jersey requests

> ID：16020676
> 
> 赞同：2
> 
> 时间：2013-04-15T16:55:21.527
> 
> 标签：servlets, http-headers, jersey

I'd like to add a `Access-Control-Allow-Origin` header to all Jersey requests in my application. Is it possible to do this via the Jersey servlet so it's application wide?

```
ServletRegistration jerseyServletRegistration =
      ctx.addServlet("JerseyServlet", new ServletContainer());
jerseyServletRegistration.setInitParameter(
      "com.sun.jersey.config.property.packages", "com.production.resource");
jerseyServletRegistration.setInitParameter(
      "com.sun.jersey.api.json.POJOMappingFeature", "true");
jerseyServletRegistration.setLoadOnStartup(1);
jerseyServletRegistration.addMapping("/api/*"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-27T07:33:40.177

```
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

import com.sun.jersey.api.client.Client;
import com.sun.jersey.api.client.ClientRequest;
import com.sun.jersey.api.client.ClientResponse;
import com.sun.jersey.api.client.filter.ClientFilter;

public final class JerseySample {

  public static void main(final String[] args) {
    final Client client = Client.create();

    client.addFilter(new ClientFilter() {

      @Override
      public ClientResponse handle(final ClientRequest request) {
        final Map<String, List<Object>> headers = request.getHeaders();

        final List<Object> valueList = new ArrayList<Object>();

        valueList.add("Sample Value");

        headers.put("Sample-Header", valueList);

        return getNext().handle(request);
      }

    });

    ...
  }

} 
```

[http://jersey.java.net/nonav/apidocs/latest/jersey/com/sun/jersey/api/client/filter/ClientFilter.html](http://jersey.java.net/nonav/apidocs/latest/jersey/com/sun/jersey/api/client/filter/ClientFilter.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-10T02:11:23.810

Jersey 2.9.9 (2019) 使用标准 JAX-RS API：

```
import javax.ws.rs.client.Client;
import javax.ws.rs.client.ClientBuilder;
import javax.ws.rs.client.ClientRequestContext;
import javax.ws.rs.client.ClientRequestFilter;
import javax.ws.rs.client.WebTarget;

    ClientRequestFilter tokenHeadersAdder = new ClientRequestFilter()
    {
        public void filter(ClientRequestContext ctx) throws IOException
        {
            final Map<String, List<Object>> headers = ctx.getHeaders();
            headers.put("X-MyKey1", Collections.singletonList("MyValue1"));
        }
    };

    Client client = ClientBuilder.newClient(clientConfig);
    client.register(tokenHeadersAdder);
    WebTarget webTarget = client.target("http://...").build(); 
```

我建议只使用一个过滤器实例并使其成为线程安全的。

Javadoc中有一条注释：

> 实现此接口的过滤器必须使用 @Provider 注释

这似乎不是真的。

# java - Gradle uploadArtifacts 指定组属性时失败

> ID：16020683
> 
> 赞同：1
> 
> 时间：2013-04-15T16:55:38.033
> 
> 标签：java, continuous-integration, gradle, nexus

我正在尝试做一个 gradle uploadArtifacts 上传到我的 nexus 服务器，当我的 build.gradle 是：

```
apply plugin: 'java'
version = "1.0"
uploadArchives {
    repositories { ivy { url "http://<server>/nexus/content/repositories/snapshots" } }
} 
```

但是，如果我指定要上传到的组，例如，如果我将 build.gradle 更改为：

```
apply plugin: 'java'
group = "test"      // <-- addition of group property
version = "1.0"
uploadArchives {
    repositories { ivy { url "http://<server>/nexus/content/repositories/snapshots" } }
} 
```

它没有说：

```
Execution failed for task ':uploadArchives'.
> Could not publish configuration 'archives'
   > java.io.IOException: Could not PUT 'http://<server>/nexus/content/repositories/snapshots/test/test-project/1.0/test-project-1.0.jar'. Received status code 400 from server: Bad Request 
```

如果我使用 --debug 运行，我得到的异常是：

```
Caused by: java.io.IOException: Could not PUT 'http://<server>/nexus/content/repositories/snapshots/test/test-project/1.0/test-project-1.0.jar'. Received status code 400 from server: Bad Request 
```

我认为在服务器上创建目录可能有问题，因为这是一个新工件，但即使我手动创建 test/test-project/1.0，上传仍然失败。（虽然没有组 ID，但它不会失败，这让我相信这不是一个联系问题）。

我的设置是：

Gradle 1.5 Gradle 构建时间：2013 年 3 月 27 日星期三下午 1:51:06 UTC Groovy：1.8.6 Ant：Apache Ant(TM) 版本 1.8.4 编译于 2012 年 5 月 22 日 Ivy：2.2.0 JVM：1.6.0_43 (Apple Inc. 20.14-b01-447) 操作系统：Mac OS X 10.7.5 x86_64

和

Sonatype Nexus™ 2.3.0-04

有没有人见过这个或知道我可能做错了什么？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T17:06:07.127

我根本不知道 gradle，但您似乎正在尝试将非快照工件发布到快照存储库：

```
version = "1.0"
url "http://<server>/nexus/content/repositories/*snapshots*" 
```

您还可以在最终 URL 中看到： `http://<server>/nexus/content/repositories/snapshots/test/test-project/1.0/test-project-1.0.jar`

# c - Point operations on an elliptic curve in a prime field in c

> ID：16020684
> 
> 赞同：1
> 
> 时间：2013-04-15T16:55:39.063
> 
> 标签：c, cryptography, geometry

I am trying to write a program to perform point operations on a elliptic curve in a prime field I am using the standard formulaes for point additions and doubling in my code and these operations are performed by functions that are called but I am getting output for certain points but not all so please help me to fix the problem that are present in this code.

```
structure point_multiply(int x, int y, int k )
{
int xk;
int yk,m;
xk=x;
yk=y;
m=1;
int xL,yL,s,e;
e=findInverse((2*yk),211);
if((((3*(xk*xk))*e)% 211)>0)
{s = (((3*(xk*xk))*e)% 211);

}
else
    s=(((3*(xk*xk))*e)% 211)+ 211;
if((((s*s)- (2*xk)) % 211)>0)
{xL=(((s*s)- (2*xk)) % 211);
}
        else
        xL=(((s*s)- (2*xk)) % 211) + 211;
        if(((-yk+ s*(xk-xL)) % 211) > 0)
        yL=(-yk+ s*(xk-xL)) % 211;
        else
        yL=(-yk+ s*(xk-xL)) % 211 + 211;
        xk=xL;
        yk=yL;
        m=m+1;

while(k>m)
{
    sn=point_addition(xk,yk,x,y);
    xk=sn.a;
    yk=sn.b;
    m++;

}
s1.a=xk;
s1.b=yk;
return s1; 
```

}

```
structure point_addition(int x1, int y1, int x2, int y2)
{
int s,xL,yL;
if((x1-x2)!=0)
{
    if ( x1 == 0 && y1 == 0 )
    {
        xL = x2;
        yL = y2;
        s7.a=xL;
        s7.b=yL;
        return s7;
    }
    if ( x2 == 0 && y2 == 0 )
    {
        xL = x1;
        yL = y1;
        s7.a=xL;
        s7.b=yL;
        return s7;
    }
    if ( y1 == -y2 )
    {
        xL = yL = 0;
        s7.a=xL;
        s7.b=yL;
        return s7;
    }
    l=findInverse((x1-x2),211);
    if ((((y1-y2)*l) % 211)>=0)
          s=((((y1-y2)*l) % 211));
    else
          s=(((y1-y2)*l) % 211) + 211;
    if ((((s*s)-(x1+x2)) % 211)>0)
          xL= (((s*s)-(x1+x2)) % 211) ;
    else
          xL= (((s*s)-(x1+x2)) % 211) + 211;
    if(((-y1+s*(x1-xL)))>=0)
          yL= ((-y1+s*(x1-xL)) % 211);
    else
          yL= ((-y1+s*(x1-xL)) % 211) + 211;
}
else

{
    xL= 0 ;
    yL= 0;

}

s7.a= xL;
s7.b= yL;

return s7 ; 
```

}

```
int findInverse(int a, int b)
{
 int x[3];
 int y[3];
 int quotient  = a / b;
 int remainder = a % b;
 x[0] = 0;
 y[0] = 1;
 x[1] = 1;
 y[1] = quotient * -1;
 int i = 2;
 for (; (b % (a%b)) != 0; i++)
 {
  a = b;
  b = remainder;
  quotient = a / b;
  remainder = a % b;
  x[i % 3] = (quotient * -1 * x[(i - 1) % 3]) + x[(i - 2) % 3];
  y[i % 3] = (quotient * -1 * y[(i - 1) % 3]) + y[(i - 2) % 3];
 }

 //x[i — 1 % 3] is inverse of a
 //y[i — 1 % 3] is inverse of b
 if(x[(i - 1) % 3]<0)
return x[(i - 1) % 3]+211;
 else
 //x[i — 1 % 3] is inverse of a
 //y[i — 1 % 3] is inverse of b
 return x[(i - 1) % 3];
  } 
```

Edited and added main c code which uses these function to perform elliptic curve cryptography

```
int main()
{
int y,z=0,x=2,i[200],j[200],h=0,g,k;
    while(x<200)
    {
        y=sqrt((x*x*x)-4);
        z=modulo(y,211);
        if(z!=0)
        {
            i[h]=x;
            j[h]=z;
            s[h].a=i[h];
            s[h].b=j[h];
            s[h+1].a=i[h];
            s[h+1].b=(211 - j[h]);
            printf("\nh=%d X= %d Y= %d \nh=%d X= %d Y= %d",h,s[h].a,s[h].b,h+1,s[h+1].a,s[h+1].b);
            h=h+2;
        }
        x++;

    }
    printf("The total no of points we have on our elliptic curve for cryptography is %d",h-1);
    x=5;
    y=11;
    printf("\n %d %d\n",x,y );
    printf("\nEnter A number between 0 and   the private key");
    scanf("%d",&k);
    s2=point_multiply(x,y,k);
   printf("\n The public key is \n %d %d \n  ",s2.a,s2.b );
   printf("Enter a RANDOM number to generate the cipher texts");
scanf("\n%d",&g);
s3= point_multiply(x,y,g);
s4=point_multiply(s2.a,s2.b,g );
label:
printf("\n Enter a number to send");
scanf("%d",&h);
s6=point_addition(s4.a,s4.b,s[h].a,s[h].b);
printf("The points to be sent are X= %d Y=%d",s[h].a,s[h].b);
printf(" \n X= %d Y=%d\n X = %d Y= %d ",s3.a,s3.b,s6.a,s6.b);
//RECIEVER
s8=point_multiply(s3.a,s3.b,k);
s9=point_addition((s8.a) ,-((s8.b)%211),s6.a,s6.b);
printf(" The decrypted points are \n %d %d",s9.a,s9.b);
        printf("\n If you have more no to send press 1 else press 0");
        scanf("\n %d", &x1);
        if(x1==1)
            goto label;
        else
            return 0; 
```

}

s1, s2, s3 etc are structures which hold a 2 integers which act as x and y co-ordinates I am getting output by entering k=3,g=4, h=5 and many other cases mostly with small numbers but not for larger numbers. What could be wrong with the code?

Further edit: I guess that normal square root method is not applicable to find square roots of a modular no?.. Please tell me how to find the modular square root of a no?

# python - Understanding ndb key class vs KeyProperty

> ID：16020686
> 
> 赞同：5
> 
> 时间：2013-04-15T16:55:42.033
> 
> 标签：python, google-app-engine, google-cloud-datastore, app-engine-ndb

I've looked through the documentation, the docs and SO questions and answers and am still struggling with understanding a small piece of this. Which should you choose and when?

This is what I've read so far (just sample):

*   [ndb documentation](https://developers.google.com/appengine/docs/python/ndb/keyclass#Introduction)
*   [movie database structure on SO](https://stackoverflow.com/questions/11711077/how-to-structure-movies-database-and-user-choices)
*   [Parent Key issues](https://stackoverflow.com/questions/10067624/how-to-query-parent-entity-from-child-entity-in-google-app-engine-python-ndb-d?rq=1)

The key class seems pretty straightforward to me. When you create an ndb entity the datastore automatically creates for you a key usually in the form of key(Kind, id) where the id is created for you .

So say you have these two models:

```
class Blah(ndb.Model):
     last_name = ndb.StringProperty()

class Blah2(ndb.Model):
     first_name = ndb.StringProperty()
     blahkey = ndb.KeyProperty() 
```

So just using the key kind and you want to make Blah1 a parent (or have several family members with the same last name)

```
lname = Blah(last_name = "Bonaparte")
l_key = lname.put() **OR**
l_key = lname.key.id() # spits out some long id 

fname_key = l_key **OR**
fname_key = ndb.Key('Blah', lname.last_name) # which is more readable.. 
```

then:

```
lname = Blah2( parent=fname_key, first_name = "Napoleon")
lname.put()

lname2 = Blah2( parent=fname_key, first_name = "Lucien")
lname2.put() 
```

So far so good (I think). Now about the KeyProperty for Blah2\. Assume Blah1 is still the same.

```
lname3 = Blah2( first_name = "Louis", blahkey = fname_key)
lname3.put() 
```

Is this correct ?

**How to query various things**

Query Last Name:

```
Blah.query() # all last names
Blah.query(last_name='Bonaparte') # That specific entity. 
```

First Name:

```
Blah2.query()
napol =   Blah2.query(first_name = "Napoleon")
bonakey = napol.key.parent().get() # returns Bonaparte's key ??

bona = bonakey.get() # I think this might be redundant 
```

this is where I get lost. How to look for Bonaparte from first name by using either key or keyproperty. I didn't add it here and perhaps should have and that is the discussion of parents, grand parents, great grand parents since Keys keep track of ancestors/parents.

How and why would you use KeyProperty vs the inherent key class. Also imagine you had 3 sensors s1, s2, s3\. Each sensor had thousands of readings but you want to keep readings associated with s1 so that you could graph say All readings for today for s1\. Which would you use? KeyProperty or the key class ? I apologize if this has been answered elsewhere but I didn't see a clear example/guide about choosing which and why/how.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-31T01:07:31.317

我认为混乱来自使用密钥。Key 不与实体内部的任何属性相关联，它只是定位单个实体的唯一标识符。它可以是数字或字符串。

幸运的是，除了这一行之外，您的所有代码看起来都不错：

```
fname_key = ndb.Key('Blah', lname.last_name) # which is more readable.. 
```

构造一个 Key 需要一个唯一的 ID，这与属性不同。也就是说，它不会将变量`lname.last_name`与属性相关联`last_name`。相反，您可以像这样创建记录：

```
lname = Blah(id = "Bonaparte")
lname.put()
lname_key = ndb.Key('Blah', "Bonaparte") 
```

保证您只有一个具有该 ID 的 Blah 实体。实际上，如果使用像 last_name 这样的字符串作为 ID，则不需要将其存储为单独的属性。将实体 ID 视为唯一的额外字符串属性。

接下来，注意不要假设 Blah.last_name 和 Blah2.first_name 在您的查询中是唯一的：

```
lname = Blah2( parent=fname_key, first_name = "Napoleon")
lname.put() 
```

如果您多次执行此操作，将会有多个 first_name 为 Napoleon 的实体（都具有相同的父键）。

继续上面的代码：

```
napol =   Blah2.query(first_name = "Napoleon")
bonakey = napol.key.parent().get() # returns Bonaparte's key ??
bona = bonakey.get() # I think this might be redundant 
```

`napol`持有一个查询，而不是一个结果。您需要调用`napol.fetch()`以获取所有带有“Napolean”的实体（或者`napol.get()`如果您确定只有一个实体）。 `bonakey`相反，它持有父实体是因为 get() 而不是 Bonaparte 的密钥。如果您将 .get() 关闭，那么`bona`将正确地拥有父级。

最后，关于传感器的问题。您可能不需要 KeyProperty 或“固有”键。如果你有这样的阅读课：

```
class Readings(ndb.Model):
    sensor = ndb.StringProperty()
    reading = ndb.IntegerProperty() 
```

然后您可以将它们全部存储在一个没有键的表中。（您可能希望包含时间戳或其他属性。）稍后，您可以使用以下查询检索：

```
s1_readings = Readings.query(Readings.sensor == 'S1').fetch() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-30T10:54:22.617

我也是 NDB 的新手，我现在仍然不了解所有内容，但我认为当您使用 Napoleon 的父级创建*Blah2*时**，**您将需要父级来查询它或不会出现。例如：

 *```
napol = Blah2.query(first_name = "Napoleon") 
```

不会得到任何东西（并且您没有为 NDB 使用正确的格式），但使用父级会做：

```
napol = Blah2.query(ancestor=fname_key).filter(Blah2.first_name == "Napoleon").get 
```

不知道这是否为您的问题提供了一些启示。*

# cmake - 使用 cmake 进行库版本控制

> ID：16020691
> 
> 赞同：0
> 
> 时间：2013-04-15T16:56:11.187
> 
> 标签：cmake

我有一个包含 4 个不同子项目的项目。要指定版本，我使用

```
SET(parent_VERSION_MAJOR 1)
SET(parent_VERSION_MINOR 0)
set(parent_VERSION_PATCH 0)
set(parent_VERSION 1.0.0) 
```

如果使用了 add_subdirectory，我可以在子项目中使用它。

Q1。我无法根据 MA​​JOR、MINOR 和 PATCH 设置 parent_VERSION。根据文档应该自动设置但是每当我尝试打印它时，它是空的，而不使用代码中的最后一行。

Q2。如果我只想从子目录构建，我会收到错误提示：

```
CMake Error at CMakeLists.txt:28 (set_target_properties):
  set_target_properties called with incorrect number of arguments. 
```

这是因为我在那里使用 parent_VERSION。

所以我知道如果不从顶层目录运行 cmake 就无法获得 parent_VERSION 但是我如何更改代码以便即使不从顶层运行它也可以构建。我读到`SET`了 INHERITED，但我认为这不是我需要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:32:55.377

这是我解决它的方法。如果有人能告诉我更好/更优雅的方式，我会很高兴。

```
if(NOT parent_VERSION)
  SET(parent_VERSION_MAJOR 1)
  SET(parent_VERSION_MINOR 0)
  SET(parent_VERSION_PATCH 0)
  SET(parent_VERSION 1.0.0)
endif(NOT parent_VERSION) 
```

# mysql - 在 DATETIME 和 TIMESTAMP 之间同步

> ID：16020695
> 
> 赞同：0
> 
> 时间：2013-04-15T16:56:24.663
> 
> 标签：mysql, sql

正如[我应该使用字段“日期时间”还是“时间戳”所明确指出的那样？](https://stackoverflow.com/questions/409286/datetime-vs-timestamp)，DATETIME 和 TIMESTAMP 字段之间的主要区别是：

1.  MySQL 中的 TIMESTAMP 一般用于跟踪记录的变化，并在每次记录发生变化时自动更新。
2.  DATETIME 表示日期（在日历中找到）和时间（可以在挂钟上观察到），而 TIMESTAMP 表示明确定义的时间点。
3.  只有 TIMESTAMP 值从当前时区转换为 UTC 进行存储，并从 UTC 转换回当前时区进行检索。

所以，我有一个包含 date_created 列和 date_modified 列的表。我将 date_created 设为 DATETIME，因此每次更新记录时都不会被覆盖，并将 date_modified 设为 TIMESTAMP，因此每次更新记录时都会更新。

如何保持两者同步？例如，在最初创建记录后，date_created 和 date_modified 列将是相同的。稍后，如果记录从未更改过，那么无论时区和夏令时如何，它们都应该保持不变，不是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:46:00.170

您列表中的第 1 点并不完全正确。`DEFAULT CURRENT_TIMESTAMP`并且`ON UPDATE CURRENT_TIMESTAMP`是可以应用于`TIMESTAMP`字段的选项（现在在 5.6`DATETIME`中也是字段）。它们不是`TIMESTAMP`. 如果您使用的是 5.6 之前的版本，您可能应该同时使用`TIMESTAMP`这两个字段。

```
CREATE TABLE my_tbl
  (date_created TIMESTAMP DEFAULT CURRENT_TIMESTAMP, 
   date_modified TIMESTAMP ON UPDATE CURRENT_TIMESTAMP) 
```

`date_created`将在创建记录时获取当前时间戳，并且在更新记录时将 date_modified 设置为当前时间戳（您可以`date_modified = date_modified`在更新中使用 a 来防止这种情况发生）。

如果您使用的是 MySQL 5.6，则可以使用`DATETIME`并获得相同的行为。

请参阅[http://dev.mysql.com/doc/refman/5.6/en/timestamp-initialization.html](http://dev.mysql.com/doc/refman/5.6/en/timestamp-initialization.html)

# php - 处理 PHP 编码的最佳实践是什么？

> ID：16020701
> 
> 赞同：0
> 
> 时间：2013-04-15T16:56:50.660
> 
> 标签：php, encoding, html-email

我有一个 html 表单，当用户填写时，信息会被处理并编码到电子邮件中。不断出现的问题是，当我的公司收到用户电子邮件时，编码会将冒号、分号、& 和逗号变成, `&#58;`，`&#59;`这使得电子邮件难以阅读。`&amp;``&#44;`

作为 PHP 和编码的新手，我不确定采用哪种方法。我应该将电子邮件转换为 html 格式还是应该一起删除编码？有人可以提供有关解决此冲突的信息/指导吗？

感谢是提前！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:07:24.413

> 我应该将电子邮件转换为 html 格式吗

这将是更好的方法，使用[html_entity_decode()](http://php.net/manual/ru/function.html-entity-decode.php)转换`&#58;`为可读字符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T17:03:25.410

如果我的理解是正确的，那么填写表格的人会输入标点符号或正在转换为 asci 的字符。要停止这种使用：

```
$yourvariable = htmlspecialchars($_POST['your input field'], ENT_QUOTES); 
```

这应该去掉大部分讨厌的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T17:05:55.860

您可以使用 HTMLEntities，它将适用的字符转换为 HTML 实体。

此外，当您想从消息中删除 html 标签时，strip_tags 也有效。

# c# - 什么可能导致本地 WCF 命名管道上的 EndpointNotFoundException？

> ID：16020706
> 
> 赞同：2
> 
> 时间：2013-04-15T16:57:26.523
> 
> 标签：c#, wcf, named-pipes

我已经设置了一个系统来让工作进程完成一些工作，并与 GUI 进程和工作进程之间的命名管道进行协调。我在这里启动工作进程：

```
this.pipeGuidString = Guid.NewGuid().ToString();
var startInfo = new ProcessStartInfo(
  "VidCoderWorker.exe",
  Process.GetCurrentProcess().Id.ToString(CultureInfo.InvariantCulture) + " " + this.pipeGuidString);
startInfo.RedirectStandardOutput = true;
startInfo.UseShellExecute = false;
startInfo.CreateNoWindow = true;
this.worker = Process.Start(startInfo);

// When the process writes out a line, its pipe server is ready and can be contacted for
// work. Reading line blocks until this happens.
this.logger.Log("Worker ready: " + this.worker.StandardOutput.ReadLine());
  bool connectionSucceeded = false;

this.logger.Log("Connecting to process " + this.worker.Id + " on pipe " + this.pipeGuidString);

var binding = new NetNamedPipeBinding
  {
    OpenTimeout = TimeSpan.FromSeconds(10),
    CloseTimeout = TimeSpan.FromSeconds(10),
    SendTimeout = TimeSpan.FromSeconds(10),
    ReceiveTimeout = TimeSpan.FromSeconds(10)
  };

this.pipeFactory = new DuplexChannelFactory<IHandBrakeEncoder>(
  this,
  binding,
  new EndpointAddress("net.pipe://localhost/" + pipeGuid + "/VidCoder"));

this.channel = this.pipeFactory.CreateChannel();
this.channel.Ping(); 
```

然后在工作进程内部：

```
host = new ServiceHost(
  typeof (HandBrakeEncoder),
  new Uri[]
    {
      new Uri("net.pipe://localhost/" + PipeGuidString)
    });

host.AddServiceEndpoint(
  typeof (IHandBrakeEncoder),
  new NetNamedPipeBinding(),
  "VidCoder");

host.Open();

encodeComplete = new ManualResetEventSlim(false);
Console.WriteLine("Service state is " + host.State + " on pipe " + PipeGuidString);
encodeComplete.Wait();

host.Close(); 
```

它适用于大多数人（包括我）100% 的时间。但是一位用户报告说，主机进程在尝试连接到工作进程时*总是*会收到 EndpointNotFoundException，即使日志表明双方的 GUID 相同并且工作进程的状态是 Opened。

我认为他的系统一定有一些不同的东西导致了失败，我想知道那可能是什么。

*   我已经尝试通过远程桌面进行连接，但它仍然适用于我。
*   我没有更改任何一个流程的强制完整性级别
*   我读[了这个答案](https://stackoverflow.com/questions/7477813/getting-endpointnotfoundexception-with-netnamedpipebinding-in-c-need-to-create)，所以我要求用户运行`net localgroup "NETWORK USERS"`，但他的组不存在
*   （编辑） Net.Pipe Listener Adapter 服务已为用户禁用，但在用户启用并启动后它仍然无法工作。

关于为什么会发生这种情况的任何其他想法？我阅读了一些有关本地与全局命名管道的内容，但由于我在本地进行通信并在本地生成进程，因此它似乎不应该成为问题。

(edit2) 用户意外地能够获得 WCF 跟踪：[http ://engy.us/misc/TracesWithNetPipeStarted.svclog](http://engy.us/misc/TracesWithNetPipeStarted.svclog)

（edit3）它显然在以管理员身份运行主机进程时有效。是不是在这种情况下，管道通信的某些部分需要这些权限？如何设置管道通道，使其永远不需要管理员？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T21:18:52.217

看看[这个 SOA question and answer](https://stackoverflow.com/a/15987095/502194)，它详细解释了一个特定会话本地的 WCF NetNamedPipeBinding 服务如何被全球发布的不相关应用程序阻止，如果后者的服务 URL 被粗心选择。

对于您描述的情况，这似乎是一个合理的解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-02T09:03:28.087

我可以确认安装 Garmin Express 会干扰命名管道。例如，尝试在 VS 中以非管理员模式运行单元测试会导致测试运行程序挂起。卸载 Garmin Express 可解决此问题。

# python - Django图像上传不起作用

> ID：16020708
> 
> 赞同：0
> 
> 时间：2013-04-15T16:57:40.773
> 
> 标签：python, django

我正在尝试通过 Django 管理站点上传图像。但它不起作用我已经安装了 PIL 包。但它显示：`<django.core.files.storage.FileSystemStorage object at 0x8a92f0c>/mcDonalds.jpg`

```
from django.core.files.storage import FileSystemStorage
projectDirPath = path.dirname(path.dirname(__file__)) 
storeImageDir = FileSystemStorage(location=projectDirPath + '/couponRestApiApp/static')
storeImage = models.ImageField(upload_to=storeImageDir) 
```

静态目录是空的..我做错了什么...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-05T08:52:35.863

尝试这个 ：`storeImage = models.ImageField(upload_to="images")`

这会将您的文件名 ex: abc.png 附加到 images/abc.png ，然后设置您要存储图像的媒体目录，例如：`yourAppDIR/static/images/....`

并设置网址：

```
url(r'^tosomeThing/(?P<path>.*)/$', 'django.views.static.serve',
     {'document_root': MEDIA_URL, 'show_indexes': False}), 
```

在设置文件中设置媒体 URL..to

```
MEDIA_URL = projectDirPath + '/couponRestApiApp/static/' 
```

当您上传任何图像时，它将存储在应用程序的图像目录中

# matlab - 递归计算多边形的面积

> ID：16020716
> 
> 赞同：2
> 
> 时间：2013-04-15T16:58:04.347
> 
> 标签：matlab

我必须计算给定'x-vector'，'y-vector'中点的坐标的任何多边形（我只知道坐标是顺时针排序的，不包括像沙漏这样的多边形）。我试着写这段代码：

```
function [areaofit] = Polygarea(xs,ys,cor,prevsum)
  if(length(xs)~=length(ys))
    disp('dimentions error!please try again');
  end
  if(nargin==2)
    cor=1;
    prevsum=0;
  end
  if(cor==length(xs)-1)
    areaofit=prevsum;
    figure(1);
    fill(xs,ys,'r');   
    title(['Area = ' num2str(areaofit)]);
  end
  if(cor~=length(xs)-1)
    mat=[xs(1) ys(1) 1;zeros(2,3)];
    for k=2:3
      mat(k,1)=xs(cor+k-1);
      mat(k,2)=ys(cor+k-1);
      mat(k,3)=1;
    end
    farea=prevsum+abs(det(mat))/2;
    Polygarea(xs,ys,cor+1,farea);
  end 
```

该函数适用于任何凸多边形，但也有适用于它的凹多边形（例如“星” ![](https://i.stack.imgur.com/kerll.png)）。我的解决方案有什么可以改进的？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:28:28.807

我认为你需要修改这一行：

```
farea=prevsum+abs(det(mat))/2; 
```

至

```
farea=prevsum+det(mat)/2; 
```

像这样，多边形中的凹面将根据它们扫过 0..2π 范围的方向来增加或减少面积。为了确保您所在地区的最终正值，应该有类似的东西`areaofit=abs(prevsum);`

# android - Android 调用 onactivityresult 来自 onitemclick

> ID：16020723
> 
> 赞同：1
> 
> 时间：2013-04-15T16:58:28.807
> 
> 标签：android

我需要使用意图将值从 1.java 的 onItemClick 方法传递到 2.Java 中的 onActivityResult

1.java

```
public void onItemClick(AdapterView<?> parent, View view, int position,long id) 
{     

    int songindex=position; 
    Intent intent2 = new Intent(this, Play.class);
    intent2.putExtra("songindex",songindex);
    setResult(100, intent2);
    startActivity(intent2);

} 
```

2.java

```
public class Play extends Activity {
MediaPlayer mp;
int currentsong=0;  
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.play);
    currentsong=getIntent().getIntExtra("songindex",-1);

}

    @Override
    protected void onActivityResult(int requestCode, int resultCode,
            Intent data) {
        // TODO Auto-generated method stub
        super.onActivityResult(requestCode, resultCode, data);
        if(resultCode==100)
        {
            //Intent intent1=getIntent();
            //currentsong=getIntent().getExtras().getInt("songindex");
            pl(currentsong);
        }
    } 
```

我的问题是意图值未从 1.java 传递到 2.java，当单击 onItemClick 时，我需要使用意图传递值并调用方法 pl(songindex)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:12:03.533

我想你误解了它`onActivityResult()`的工作原理。如果您想从额外的 in 中获取值`2.java`，请使用`getIntent().getIntExtra("songindex", -1)`in `onCreate()`（就像您实际做的那样）。可以在[此处](http://developer.android.com/reference/android/app/Activity.html)找到有关活动以及如何在它们之间传递值的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T17:16:48.037

```
protected void onActivityResult(int requestCode, int resultCode,
        Intent data) { 
```

仅在 startActivityForResult() 启动的活动完成后调用。aka 如果 2.java 调用 1.java 那么 1.java 在完成时触发 onActivityResult。

```
currentsong=getIntent().getIntExtra("songindex",-1); 
```

应该包含来自 1.java 的 songindex 的值

```
intent2.putExtra("songindex",songindex); 
```

看看这个[http://www.vogella.com/articles/AndroidIntent/article.html#overview_accessdata](http://www.vogella.com/articles/AndroidIntent/article.html#overview_accessdata)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T17:22:24.723

问题是 onActivityResult 方法是在启动新活动的活动中执行的，而不是在已启动的活动中（在您的示例中为 Play 类）。

因此，您可以在已启动的活动（Player）的 onCreate 方法中获取启动 Player 活动的 Intent 中的额外数据，并以这种方式设置属性值。

此外，您可以在已启动的活动 (Play) 中使用 setResult 方法，如果您为结果启动了 Player 活动，则将执行调用者活动 (1) 的 onActivityResult 方法。

# python - Python设置，将一个模块安装为另一个模块的子模块？

> ID：16020725
> 
> 赞同：5
> 
> 时间：2013-04-15T16:58:30.597
> 
> 标签：python, setuptools, distutils

我想创建一个包作为扩展安装到另一个 python 包的子模块中。

基本上原始模块的设置如下：

```
origmodule/
    __init__.py
    stuff.py
    ext/
        __init__.py
        # This module is empty 
```

然后将我的扩展模块安装到空的 origmodule.ext 模块中。阅读说明`distutils`尚不清楚这是否可行或受支持。最终目标是让我的扩展模块一旦安装就可以像这样导入：

`import origmodule.ext.my_extension`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T17:01:01.283

您无法使用 setuptools 执行此操作，*不*支持在另一个包中安装。

相反，您想使用[入口点](http://guide.python-distribute.org/creation.html?highlight=entry%20points#entry-points)。您`origmodule`应该寻找任何注册为特定键的入口点的东西，并且您的`extension`模块应该为该键注册自己。

您的扩展注册了一个扩展点：

```
entry_points={
    'some.opaque.string.unique.to.origmodule':
        ['my_extension = my.extension.package:some.entry.point', ]
} 
```

然后您`origmodule`可以通过询问来发现`pkg_resources`：

```
import pkg_resources

for entrypoint in pkg_resources.iter_entry_points(group='some.opaque.string.unique.to.origmodule'):
    extension = entrypoint.load() 
```

以[Babel 项目](http://babel.edgewall.org/)为例。Babel 可以从文件中提取可翻译的文本；它知道如何对 Python 源代码执行此操作，但它还支持可以从其他格式中提取此类文本的扩展。

这种提取方法可以注册为扩展点。Babel 在[写作提取方法](http://babel.edgewall.org/wiki/Documentation/messages.html#writing-extraction-methods)部分记录了这一点。然后，消息提取代码在提取文本时[加载这些入口点：](http://babel.edgewall.org/browser/trunk/babel/messages/extract.py#L259)

```
GROUP_NAME = 'babel.extractors'

# ...

for entry_point in working_set.iter_entry_points(GROUP_NAME,
                                                 method):
    func = entry_point.load(require=True)
    break 
```

[Mako 模板语言](http://docs.makotemplates.org/en/latest/)提供了这样一个插件；它注册了指向[实际实现](http://www.makotemplates.org/trac/browser/mako/ext/babelplugin.py#L13)[的入口点](http://www.makotemplates.org/trac/browser/setup.py#L52)：

```
[babel.extractors]
mako = mako.ext.babelplugin:extract 
```

```
def extract(fileobj, keywords, comment_tags, options):
    # ... 
```

# javascript - 鼠标悬停iframe时如何显示工具提示

> ID：16020727
> 
> 赞同：1
> 
> 时间：2013-04-15T16:58:45.603
> 
> 标签：javascript, jquery, iframe, telerik, tooltip

我正在使用 Telerik Radeditor，它是富文本区域，编辑器内容是 iframe，如下所示：

```
 <iframe frameborder="0" 
    src="javascript:'<html></html>';" 
    style="width: 100%; height: 100%; margin: 0px; padding: 0px;" 
    title="hello world" 
    id="contentIframe"></iframe> 
```

我的目标是`"hello world"`在用户鼠标悬停在 iframe 区域时显示工具提示。

正如你所看到的，我放了`"title" attribute`但它没有出现。

为了模仿工具提示行为，我尝试放置`overlay div`并且`title`有效，但后来我失去了鼠标控制，因为`overlay div`.

我还拼命尝试将标题放在 iframe 正文中，但随后我不得不单击 iframe 内部以使其发生，这不是解决方案。

```
var iframe_html = $(wrapper).find("iframe").contents().find("html");
$(iframe_html).prop("title", "hello my tooltip 1");
var iframe = $(wrapper).find('iframe');
$(iframe).prop("title", "hello my tooltip 2");
var iframebody = $(iframe).contents().find('body');
$(iframebody).prop("title", "hello my tooltip 3"); 
```

我正在使用`jQuery UI 1.8.16`它不附带工具提示功能，因此这不是一个选项..

谁能帮我弄清楚如何显示工具提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:53:39.133

您可以为 iframe 分配一个标题，但您将无法在 iframe 中看到它。将 frameborder 更改为“2”并将光标移动到它.. 你去......标题出现......

要查看 iframe 上的标题，您必须设置 iframe 内容的标题，而不是 iframe 本身。

就像我在下面所做的一样..

```
<iframe frameborder="0" 
    src="javascript:'<div id=\'hey\' title=\'Hello World\'>Helllo World</div>';" 
    style="width: 100%; height: 100%; margin: 0px; padding: 0px;position:relative;" 
    title="hello world" 
    id="contentIframe">
</iframe> 
```

或者.. 使用 jQuery

```
$(document).ready(function () {    
    $("#contentIframe").contents().find("body").attr('title','Hello World');    
}); 
```

[这是一个供您参考的小提琴..](http://jsfiddle.net/writetobhuwan/WdCdU/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-14T22:54:57.660

我刚刚在 w3 学校[工具提示](https://www.w3schools.com/css/css_tooltip.asp)教程（[此处](https://www.w3schools.com/css/tryit.asp?filename=trycss_tooltip_top)为 TryIt 编辑器）中向 div 添加了一个 iframe，它运行良好。出乎我的意料。

```
<!DOCTYPE html>
<html>
<style>
.tooltip {
    position: relative;
    display: inline-block;
    border-bottom: 1px dotted black;
}

.tooltip .tooltiptext {
    visibility: hidden;
    width: 120px;
    background-color: #994444;
    color: #ffffff;
    text-align: center;
    border-radius: 6px;
    padding: 5px 0;

    /* Position the tooltip */
    position: absolute;
    z-index: 1;
    bottom: 100%;
    left: 50%;
    margin-left: -60px;
}

.tooltip:hover .tooltiptext {
    visibility: visible;
}
</style>
<body style="text-align:center;">

<h2>Proof of Concept</h2>
<p>This, cobbled from the W3 schools tutorial on CSS tooltips.  I added an Iframe inside the div; one may still interact therewith, yet enjoy full tooltipitude.</p>
<p> So, move the mouse over the text below:</p>

<div class="tooltip">Hover over me
  <span class="tooltiptext">Hello World</span>
  <iframe height="600px" src="https://imgur.com/a/71J1gQZ" width="600px" ></iframe>
</div>

</body>
</html> 
```

在这里看到它：

[https://faustsstudy.blogspot.com/p/blog-page_14.html](https://faustsstudy.blogspot.com/p/blog-page_14.html)

但它需要对数据 URI 的支持。

# actionscript - Adobe Captivate - 在继续之前必须查看所有子幻灯片

> ID：16020729
> 
> 赞同：0
> 
> 时间：2013-04-15T16:58:49.717
> 
> 标签：actionscript, adobe-captivate

我正在使用 Adob​​e Captivate 创建在线学习课程。

一个缩写被分解为 6 ​​个按钮，每个按钮都有一个动作，可以将您带到各自的幻灯片。幻灯片完成后，您将被带回原件。

问题：带有缩写的原始幻灯片只有在用户访问完所有 6 张幻灯片后才应显示“继续”按钮。

有没有办法用 ActionScript 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-12T01:36:16.627

我不熟悉 ActionScript，但有一种简单的方法可以使用 Captivate 中的高级操作来执行此操作。这是我将如何处理它。首先，创建六个变量，分别为六张幻灯片中的每张创建一个变量，这样您就可以创建名为 v_slide1_viewed、v_slide2_viewed、v_slide3_viewed、v_slide4_viewed、v_slide5_viewed 和 v_slide6_viewed 的变量。将它们的默认值设置为 0（我通常在变量前面加上 v_ 以区别于内置的 Captivate 变量）。

现在在幻灯片 1 上，设置**On Enter**属性以将值 1 分配给变量 v_slide1_viewed。这意味着，当幻灯片 1 加载时，变量 'v_slide1_viewed' 将设置为 1。同样对六张幻灯片中的每一张执行此操作。

现在在缩写幻灯片上，创建一个 SmartShape（继续）按钮并取消选中“在输出中可见”，以便默认情况下不显示此按钮。现在您可以编写一个高级操作（条件）脚本，说明如果

```
v_slide1_viewed = 1 AND 
v_slide1_viewed = 2 AND 
v_slide1_viewed = 3 AND 
v_slide1_viewed = 4 AND 
v_slide1_viewed = 5 AND 
v_slide1_viewed = 6 
```

然后显示并选择智能形状 ID 或您命名该对象的任何名称。

希望这就是你要找的。

-肖恩

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-04T18:36:23.187

您可以在 Captivate 中隐藏或显示按钮。您还可以使用高级操作更改它们是否显示（您可能需要使用条件操作）。

# extjs - 如何调用 Ext JS 3.4 Window 的超类方法

> ID：16020730
> 
> 赞同：3
> 
> 时间：2013-04-15T16:58:59.160
> 
> 标签：extjs, superclass

我有一个像这样的窗口类：

```
 myWindow = Ext.extend(WindowAddItemUi, {

    initComponent: function() {

        WindowAddComponentPublic.superclass.initComponent.call(this);

    },

    close : function() {
        this.superclass().close(); //not working
        myWindow.superclass().close(); //also not working

    }

   }); 
```

我试图覆盖窗口的关闭方法并调用窗口的超级方法关闭，但它似乎不起作用。
有谁知道如何正确调用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T10:37:33.240

是的，我终于让它工作了。这是我修复它的解决方案。

```
close : function() {
 this.superclass().close.call(this); //this works
 // myWindow.superclass.close.call(this); //this also works 
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-15T17:27:54.027

```
close: function() {
    this.callParent();
} 
```

# asp.net - SQL WHERE User.Identity.Name 使用参数

> ID：16020731
> 
> 赞同：1
> 
> 时间：2013-04-15T16:59:00.577
> 
> 标签：asp.net, vb.net

我正在使用 DetailsView 仅显示我的数据库中符合我规定的 QueryString 值的标准的记录，并且等于当前的 User.Identity.Name 认证用户。

我已经做到了这一点，但我不知道我做错了什么，因为当我传递一个我知道是合乎逻辑的值并且在运行时满足上述查询字符串中的两个标准时，页面似乎仍然是空白的。

我将为您提供相关的片段，而不是发布完整的 DetailsView 代码：

SQL 选择命令：

```
SELECT * FROM [Events] WHERE ([EventID] = ?) AND (CreatedBy = @MemberName) 
```

选择参数：

```
<SelectParameters>
        <asp:QueryStringParameter DefaultValue="1" Name="EventID" QueryStringField="ID" 
                Type="Int32" />
        <asp:parameter name="MemberName" type="String" />
        </SelectParameters> 
```

最后是后面的代码，将 User.Identity.Name 与 MemberName 参数相关联：

```
Protected Sub SqlDataSource1_Selecting(sender As Object, e As SqlDataSourceSelectingEventArgs)
        e.Command.Parameters(1).Value = Me.User.Identity.Name
End Sub 
```

这里可能出了什么问题？

# java - 具有请求和会话范围的 Java Bean

> ID：16020732
> 
> 赞同：1
> 
> 时间：2013-04-15T16:59:01.530
> 
> 标签：java, jsp, servlets, scope, javabeans

我想创建一个可以将朋友添加到列表中的网络应用程序。出于这个原因，我使用 JSF 和 Java Beans，但现在我遇到了一些严重的问题。

首先我创建了一个朋友类：

```
package at.fhjoanneum.ima11.listoffriendsjsf;

import java.io.Serializable;
import javax.enterprise.context.RequestScoped;
import javax.inject.Named;

@Named("friend")
@RequestScoped
public class Friend implements Serializable{

    private String nickname;
    private String firstname;
    private String lastname;

    public Friend() {
    }

 @Override
    public boolean equals(Object obj) {
    if (obj != null && obj instanceof Friend) {
    Friend other = (Friend) obj;
    return this.getNickname().equals(other.getNickname());
    }
    return false;
    }
    // getter, setter, equals, hashcode
    } 
```

为了存储我的朋友，我创建了另一个 bean：

```
import java.io.Serializable;
import java.util.ArrayList;
import java.util.List;
import javax.enterprise.context.SessionScoped;
import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;
import javax.inject.Named;

@Named("listOfFriendsBean") @SessionScoped
public class ListOfFriendsBean implements Serializable {

    private List<Friend> listOfFriends = new ArrayList<Friend>();

    public String addFriend(Friend friend) {
        if(!listOfFriends.contains(friend)) {
            listOfFriends.add(friend);
            return "index";
        } else {
            FacesMessage msg = new FacesMessage(FacesMessage.SEVERITY_FATAL, "Your friend is already stored in the list!", null);
            FacesContext.getCurrentInstance().addMessage(null, msg);
            return "index";    
        }
    }

    public List<Friend> getListOfFriends() {
        return listOfFriends;
    } 
```

最后但并非最不重要的一点是，我创建了一个 JSF 文件（只是其中的一部分，这只是添加好友的表单。上面是存储好友的表格）：

```
<p:panel header="Add friend">
                <h:panelGrid columns="2" columnClasses="column" cellpadding="5">
                    <p:outputLabel value="Nickname" for="nickname"/>
                    <p:inputText id="nickname" required="true" value="#{friend.nickname}" />
                    <p:outputLabel value="Firstname" for="firstname"/>
                    <p:inputText id="firstname" required="true" value="#{friend.firstname}" />
                    <p:outputLabel for="lastname" value="Lastname"/>
                    <p:inputText id="lastname" required="true" value="#{friend.lastname}" />
                </h:panelGrid>
            </p:panel>

            <p:commandButton value="Add" styleClass="ui-priority-primary" ajax="false" 
                             action="#{listOfFriendsBean.addFriend(friend)}" /> 
```

当我添加第一个朋友时，一切正常，但之后我收到一个错误，即该朋友已存储在列表中，并且旧朋友的值已更改为新值。所以我确定我的网络应用程序正在使用同一个朋友实例，但我没有得到它，因为我使用了朋友类的请求范围。它不应该为每个请求创建一个新的朋友实例吗？我该如何解决这个问题？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:11:16.837

我不习惯这种用法，但`addFriend`似乎需要在此处复制 Friend 参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T17:13:00.507

我认为您应该覆盖 Friend bean 的 equals 方法：

```
 package at.fhjoanneum.ima11.listoffriendsjsf;

    import java.io.Serializable;
    import javax.enterprise.context.RequestScoped;
    import javax.inject.Named;

    @Named("friend")
    @RequestScoped
    public class Friend implements Serializable{

        private String nickname;
        private String firstname;
        private String lastname;

        public Friend() {
        }
    // getter, setter, equals, hashcode

        @Override
        public boolean equals(Object obj){
            if(obj instanceof Friend && isEqual()){
               return true;
            }
            else 
                return false; 
        }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T17:28:46.423

请检查您的 equals 方法，如果它包含正确的业务模型对象覆盖（朋友）

# python-2.7 - 以 10 为底的无效文字

> ID：16020736
> 
> 赞同：0
> 
> 时间：2013-04-15T16:59:23.813
> 
> 标签：python-2.7, casting, pandas

我有一个从 'a' 下面的 csv 构造的 df 应该是双精度的。如果我检查一个？它似乎是一个字符串。在尝试将其转换为 int(a) 时，我收到一个类型错误，我不知道为什么。

```
 ValueError: invalid literal for int() with base 10: '46.074'

  a=df["MA10"].ix[100]
   a=int(a) 

 Imported:
 df=pd.read_csv('__.csv',header=None,parse_dates=True, index_col={0},names="__".split()) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:13:11.397

使用浮动

```
In [14]: int('46.074')
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-14-f8e7b101e6bd> in <module>()
----> 1 int('46.074')

ValueError: invalid literal for int() with base 10: '46.074'

In [15]: float('46.074')
Out[15]: 46.074 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T13:05:31.017

尝试这个

```
 int(float('46.074')//1) 
```

# spring - 如果构造函数参数是继承类，则创建类反射

> ID：16020737
> 
> 赞同：0
> 
> 时间：2013-04-15T16:59:30.460
> 
> 标签：spring, reflection

**问题**：如果类构造函数包含继承类参数，如何正确创建类反射？我有：

```
interface Car {}
class SportCar implement Car{}
class CarService {
  public CarService(String str, Car car) {
     ...
  }
} 
```

但是，当我尝试这样做时：

```
Class c = Class.forName("vbspring.model.CarService");
Class[] paramTypes = {String.class, SportCar.class};
Constructor constr = c.getDeclaredConstructor(paramTypes); 
```

它抛出：**java.lang.NoSuchMethodException: vbspring.model.CarService.(java.lang.String, vbspring.model.SportCar)**

PS我的.xml文件：

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <bean id="carService" class="model.CarService">
        <constructor-arg value="Car Rental Service"/>
        <constructor-arg ref="sportCar"/>
        <property name="startCar"/>
    </bean>

    <bean id="sportCar" class="model.SportCar"/>

</beans> 
```

**编辑**：我尝试编写类似我自己的 Spring Framework 的东西。我不仅必须创建属于 Car 层次结构的类，因此我尝试编写可以创建任意类型的类的通用方法。我不能写：`Class[] paramTypes = {String.class, Car.class};`

我必须写一些通用的东西，比如：

```
paramTypes[index++] = obj.getClass(); 
```

其中 obj - 是解析器从 .xml 中提取的 SportCar 或 Car bean

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:57:53.607

错误`java.lang.NoSuchMethodException: vbspring.model.CarService.(java.lang.String, vbspring.model.SportCar)`表明您没有构造函数，例如：

```
public CarService(String, SportCar) 
```

你没有。你有：

```
public CarService(String, Car) { 
```

将您的代码更改为

```
Class c = Class.forName("vbspring.model.CarService");
Class[] paramTypes = {String.class, Car.class}; // the constructor takes Car not SportsCar
Constructor constr = c.getDeclaredConstructor(paramTypes); 
```

然后，当您调用构造函数以获取新实例时，您可以传递一个`SportsCar`实例或任何其他`Car`实例。

```
constr.newInstance("sport", new SportsCar());
// or
constr.newInstance("a jeep", new Jeep());
// or
constr.newInstance("long car", new Limousine()); 
```

假设`Jeep`和`Limousine`实施`Car`。

# java - 用 1,2...n 填充数组的最短方法

> ID：16020741
> 
> 赞同：47
> 
> 时间：2013-04-15T16:59:40.737
> 
> 标签：java, arrays

在java中有没有这么快的东西？（快速编码）

```
int [] a = {1..99}; 
```

或者我必须这样做：

```
int [] a=new int[100];
for (int i=0;i <100;++i){
a[i]=i;
} 
```

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2016-11-11T19:31:02.680

从**Java 8 开始**，这是可能的：

```
int[] a = IntStream.range(1, 100).toArray(); 
```

（并且比其他 java 8 答案短。）。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2017-04-27T17:12:12.253

如果您使用 Java 8，则另一种选择：

```
int[] array = new int[100];
Arrays.setAll(array, i -> i + 1); 
```

lambda 表达式接受单元格的索引，并返回要放入该单元格的值。在这种情况下，单元格 0 - 99 被分配值 1-100。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-09-07T10:25:36.617

Java 8 允许在一行中使用`IntStream`对象和 lambda 表达式来做到这一点：

```
int n = 10;
int[] values = new int[n];
IntStream.range(1,n+1).forEach(val -> values[val-1] = val); 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2013-04-15T17:33:50.860

出于好奇，我测试了该方法的两个版本的性能——一个使用循环，另一个使用番石榴：

```
public int[] loop() {
    int[] a = new int[100];
    for (int i = 0; i < 100; ++i) {
        a[i] = i;
    }
    return a;
}

public int[] guava() {
    Set<Integer> set = ContiguousSet.create(Range.closed(0, 99), DiscreteDomains.integers());
    int[] a = Ints.toArray(set);
    return a;
} 
```

结果如下：

```
Benchmark     Mean     Mean error          Var    Units
loop        79.913          5.671       30.447  nsec/op
guava      814.753         46.359     2034.726  nsec/op 
```

因此，该`guava()`方法的运行时间为 814 ns +/- 46ns，而该方法的运行时间为 80 ns +/- 5ns `loop()`。所以`loop()`大约快 10 倍。如果您多次调用该方法，则 800 纳秒无关紧要，如果您经常调用它，编写循环可能会更好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-15T17:11:22.833

我认为您的代码是**最短**和**最简单**的方法。您可能不需要加载额外的库来获得更多“紧凑”的代码行。**for**循环非常简单（真正的 O(n)）并且清晰**易读**，并且喜欢它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-15T17:04:38.370

根据您必须循环的大小，如果它很小，您可以执行以下操作...

```
int[] intArray = new int[] {4,5,6,7,8}; 
```

我猜你的尺寸你不想把它全部打出来所以创建一个循环并设置它是有意义的

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-15T17:06:22.787

您必须使用循环来初始化这样一个长数组。正如您所料，Java 中没有快捷方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-15T17:06:56.857

您可以使用 Guava 库，如下所示：

```
public class Test {

public static void main(String[] args) {
    //one liner
    int[] array = toArray(newLinkedList(concat(range(1, 10), range(500, 1000))));

    //more readable
    Iterable<Integer> values = concat(range(1, 10), range(500, 1000));
    List<Integer> list = newLinkedList(values);
    int[] array = toArray(list);

}

public static List<Integer> range(int min, int max) {
    List<Integer> list = newLinkedList();
    for (int i = min; i <= max; i++) {
        list.add(i);
    }

    return list;
} 
```

}

**更新**：完整示例取自这篇文章[用数字范围填充数组](https://stackoverflow.com/questions/3387373/fill-arrays-with-ranges-of-numbers)

# python - Heroku 应用程序在本地运行，但出现 H12 超时错误（使用包）

> ID：16020749
> 
> 赞同：5
> 
> 时间：2013-04-15T17:00:23.550
> 
> 标签：python, heroku, flask, gunicorn

有人问过类似的问题，但 H12 似乎是由很多事情引起的，没有一个答案适用于此。我以前用 heroku 构建了 python 应用程序，但现在我使用的是 Miguel Grinberg 的[Flask Mega-Tutorial](http://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world)的包结构，我不知道出了什么问题。

我的应用程序是带有 Heroku postgres 数据库的 python / Flask / SQLAlchemy。该应用程序完全可以在本地运行。当我推送到 Heroku 时，我得到了 H12。

这是我的应用程序结构：

```
 rootappdirectory\
      app\
        static\
        templates\
        __init__.py
        views.py
        models.py
      run.py
      [plus flask / venv files] 
```

run.py 看起来像这样：

```
import os
from flask import Flask

from app import app
app.run() 
```

app/__init__.py 看起来像这样：

```
(a bunch of imports)

app = Flask(__name__)
db = SQLAlchemy(app)

login_manager = LoginManager()
(a bunch of login_manager stuff)

from app import views, models 
```

我的档案是`web: gunicorn run:app`

我在本地和远程使用 heroku 数据库。该应用程序在我的本地机器上完美运行（在 0.0.0.0:5000 上）。但是当我推送到 heroku 并运行应用程序时，日志如下：

```
2013-04-15T06:50:27.165532+00:00 heroku[router]: at=error code=H12 desc="Request timeout" method=GET path=/favicon.ico host=floating-driftwood-6203.herokuapp.com fwd="24.6.48.240" dyno=web.1 connect=1ms service=30007ms status=503 bytes=0
2013-04-15T06:50:34.908756+00:00 app[web.1]: 2013-04-15 06:50:34 [2] [CRITICAL] WORKER TIMEOUT (pid:65)
2013-04-15T06:50:34.914436+00:00 app[web.1]: 2013-04-15 06:50:34 [2] [CRITICAL] WORKER TIMEOUT (pid:65)
2013-04-15T06:50:34.918114+00:00 app[web.1]: 2013-04-15 06:50:34 [66] [INFO] Booting worker with pid: 66
2013-04-15T06:50:35.083182+00:00 app[web.1]:  * Running on http://127.0.0.1:5000/
2013-04-15T06:51:04.216671+00:00 app[web.1]: 2013-04-15 06:51:04 [2] [CRITICAL] WORKER TIMEOUT (pid:66)
2013-04-15T06:51:04.223440+00:00 app[web.1]: 2013-04-15 06:51:04 [2] [CRITICAL] WORKER TIMEOUT (pid:66)
2013-04-15T06:51:04.229350+00:00 app[web.1]: 2013-04-15 06:51:04 [67] [INFO] Booting worker with pid: 67 
```

我玩过不同的选项——起初我遇到了一个“正在使用的连接”错误，我通过进入 debug=False 来修复它，但坦率地说，我宁愿在 debug=True 中！我的主应用程序不在根目录中这一事实似乎有问题？

提前致谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-15T22:43:47.027

问题是`run.py`毫无防备的调用`app.run`——这实际上调用`werkzeug.serving.run_simple`了一个子进程来处理传入的请求……在 gunicorn 下运行时你不想这样做（因为 gunicorn 会为你处理进程管理）。

只需在调用`if __name__ == "__main__"`之前添加一个警卫`app.run`，一切都会正常：

```
# run.py
if __name__ == "__main__":
    app.run() 
```

# oracle-call-interface - Oracle OCI 同一语句中的多个查询

> ID：16020751
> 
> 赞同：0
> 
> 时间：2013-04-15T17:00:34.317
> 
> 标签：oracle-call-interface

我正在尝试实现一个使用 OCI API 将网络服务器连接到 oracle 的驱动程序。是否可以同时发送多个查询（相同的字符串）并接收响应（多个结果集）谢谢 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-05T15:30:55.583

这种先进的概念可用于不同的数据库连接。当为用户分配不同的优先级时，也可以使用多个连接池。使用连接池可以实现不同的服务级别保证。

尝试

```
OCISessionPoolCreate 
```

# ruby-on-rails-3 - 使用 form_for 将参数附加/更新到现有表单

> ID：16020754
> 
> 赞同：1
> 
> 时间：2013-04-15T17:00:37.430
> 
> 标签：ruby-on-rails-3, twitter-bootstrap, boolean, form-for

对 Rails 相当陌生，这意味着我相信我已经掌握了大部分基础知识，但绝对仍然是艺术系的学生。

**我要完成的工作：**使用 form_for 将参数附加到现有表单。

*因此，我需要找到现有表单的 id，并使用 JobsController 将新的哈希传递给该表单，以附加几列数据。*

步骤是从 select_box 中选择作业编号，使用 text_fields/check_boxes 为该作业添加任何更改/注释，然后提交。使用的视图也是部分视图，可在视图/作业中找到。

**尽管多次尝试，**当前的问题是：**
**覆盖默认`'post'`方法 -- 尝试了以下几种组合：`method => 'put'`，`:action => update, :controller => :jobs`****

 **```
class Job < ActiveRecord::Base

attr_accessible :note, :twgid, :padd, :lnkbr, :txtwr, :datewr, :pinmiss, :headch,  :name, :nucopy, :minrend, :majrend, :lnkwr, :gmail, :hotmail, :aol, :outlook, :note, :linkwr

belongs_to :form
end

 JobsController: 

 ( scaffolded ) 

View: (jobs/_form.html.erb)

<%= form_for @job do |f| %>

   <fieldset> 
 <div class="form-horizontal">              
 <div class="control-group">
 <span class="control-label">
 <%= f.label :name, "TWGID" %></span>
 <%= f.select :name, options_from_collection_for_select(Job.all, :name, :name), :prompt =>  'Select' %>  
  </fieldset>
  <fieldset>
 <div class="control-group">
 <span class="control-label">
  <%= f.label :padd, "Add Padding?" %></span>
  <%= f.check_box :padd %>   
  <%= f.hidden_field, :updated, :value => '1' %>
  <% end %> 
```

##路线##

```
get 'signup', to: 'users#new', as: 'signup'
get 'login', to: 'sessions#new', as: 'login'
get 'logout', to: 'sessions#destroy', as: 'logout'

resources :sessions
resources :users 
resources :forms 
resources :projects
resources :jobs
root :to => 'forms#index' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T19:09:12.073

我不是 100% 确定你想做什么，但让我来看看它。

好吧，我看到的第一件事是，在第一行的 update_job 中，您尝试获取一个 Change 对象并将其放入 @change。问题是您使用的 @change.id 显然尚未设置。如果您通过参数获取 id，您将需要使用：

```
@change = Change.find(params[:id]) 
```

其次，您正在尝试更新 Job 的属性但有一个 Change 对象。这行不通。

我认为您总体上尝试做的是构建一个更新更改并且还将更新其关联（在这种情况下为作业）的表单。有关如何执行此操作的快速链接在这里：

[表单助手](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html%20Form%20Helpers)<--- 搜索嵌套属性示例

这是我建议的代码：

```
<%= form_for @change do |f| %>
  <%= f.fields_for :job do |j| %>
    Updated  : <%= j.check_box :updated %>
  <% end %>
<% end %> 
```

这会将更新的选项放入其中`params[:change][:jobs_attributes]`，当您将 params[:change] 发送到您的更新中时，`@change.update_attributes(params[:change])`它也会更新您的工作。**

# entity-framework - EF 在生产中给我错误，而不是在开发中。

> ID：16020755
> 
> 赞同：1
> 
> 时间：2013-04-15T17:00:47.507
> 
> 标签：entity-framework, entity-framework-5

我有以下由生成的 EF 模型使用的连接字符串。它在我的本地机器上正常工作，但是当我部署时，我收到以下错误。我在 SO 上查看了多次引用的 URL：http: [//blogs.teamb.com/craigstuntz/2010/08/13/38628/](http://blogs.teamb.com/craigstuntz/2010/08/13/38628/)如果它有答案，我看不到它的情况.

我在下面粘贴错误

```
 <add name="svcodecampEntitiesAllTables" connectionString="metadata=res://*/EFModel.ModelAllTables.csdl|res://*/EFModel.ModelAllTables.ssdl|res://*/EFModel.ModelAllTables.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=.;initial catalog=svcc;integrated security=True;persist security info=True;multipleactiveresultsets=True;application name=EntityFramework&quot;" providerName="System.Data.EntityClient" />

{"message":"An error has occurred.","exceptionMessage":"Unable to load the specified metadata resource.","exceptionType":"System.Data.MetadataException","stackTrace":"   at System.Data.Metadata.Edm.MetadataArtifactLoaderCompositeResource.LoadResources(String assemblyName, String resourceName, ICollection`1 uriRegistry, MetadataArtifactAssemblyResolver resolver)\r\n   at System.Data.Metadata.Edm.MetadataArtifactLoaderCompositeResource..ctor(String originalPath, String assemblyName, String resourceName, ICollection`1 uriRegistry, MetadataArtifactAssemblyResolver resolver)\r\n   at System.Data.Metadata.Edm.MetadataArtifactLoaderCompositeResource.CreateResourceLoader(String path, ExtensionCheck extensionCheck, String validExtension, ICollection`1 uriRegistry, MetadataArtifactAssemblyResolver resolver)\r\n   at System.Data.Metadata.Edm.MetadataArtifactLoader.Create(String path, ExtensionCheck extensionCheck, String validExtension, ICollection`1 uriRegistry, MetadataArtifactAssemblyResolver resolver)\r\n   at System.Data.Metadata.Edm.MetadataCache.SplitPaths(String paths)\r\n   at System.Data.Common.Utils.Memoizer`2.<>c__DisplayClass2.<Evaluate>b__0()\r\n   at System.Data.Common.Utils.Memoizer`2.Result.GetValue()\r\n   at System.Data.Common.Utils.Memoizer`2.Evaluate(TArg arg)\r\n   at System.Data.EntityClient.EntityConnection.GetMetadataWorkspace(Boolean initializeAllCollections)\r\n   at System.Data.Objects.ObjectContext.RetrieveMetadataWorkspaceFromConnection()\r\n   at System.Data.Objects.ObjectContext..ctor(EntityConnection connection, Boolean isConnectionConstructor)\r\n   at System.Data.Objects.ObjectContext..ctor(EntityConnection connection)\r\n   at System.Data.Entity.Internal.InternalConnection.CreateObjectContextFromConnectionModel()\r\n   at System.Data.Entity.Internal.LazyInternalConnection.CreateObjectContextFromConnectionModel()\r\n   at System.Data.Entity.Internal.LazyInternalContext.InitializeContext()\r\n   at System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType)\r\n   at System.Data.Entity.Internal.Linq.InternalSet`1.Initialize()\r\n   at System.Data.Entity.Internal.Linq.InternalSet`1.get_InternalContext()\r\n   at System.Data.Entity.Infrastructure.DbQuery`1.System.Linq.IQueryable.get_Provider()\r\n   at System.Linq.Queryable.Select[TSource,TResult](IQueryable`1 source, Expression`1 selector)\r\n   at WebAPI.rest.AttendeesDashboardController.Get(String userSearch, Nullable`1 presentersOnly, Nullable`1 currentCodeCampYearOnly, Nullable`1 start, Nullable`1 limit) in c:\\VCProject\\SVCodeCampWeb\\WebAPI\\rest\\AttendeesDashboardController.cs:line 97\r\n   at lambda_method(Closure , Object , Object[] )\r\n   at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)\r\n   at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)\r\n   at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()\r\n   at System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)"} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T17:06:29.657

我也有这个问题。我通过显式命名包含模型的程序集来修复它。

因此，如果您的模型在“Product.DAL.dll”中，而不是：

```
 metadata=res://*/EFModel.ModelAllTables.csdl|... 
```

放：

```
 metadata=res://Product.DAL/EFModel.ModelAllTables.csdl|... 
```

对于所有 3 个元数据资源

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-21T17:34:50.647

您必须添加对包含 edmx 图的项目的引用并更改 Nunit 项目中的连接字符串

改变

```
<add name="ContainerName" connectionString="metadata=res://*/Diagram.csdl|re..... 
```

通过元数据中 3 个位置的库名称

```
<add name="ContainerName"connectionString="metadata=res://File.Data/Diagram.csdl|res://File.Data/Diagra... 
```

“File.Data”是 File.Data.dll，由包含图表的项目生成的库

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-12T14:39:53.747

我有同样的问题并通过运行自定义工具解决。右键单击 Model.tt 文件并单击运行自定义工具并对 context.tt 文件和 Model.edmx 文件重复相同的操作。重建应用程序将起作用。

# scala - 如何以匿名函数/函数文字返回？

> ID：16020757
> 
> 赞同：0
> 
> 时间：2013-04-15T17:00:56.360
> 
> 标签：scala

我不确定如何`return`在匿名函数中使用关键字（或者我应该以不同的方式解决我的问题？）。

现在的方式，`return`实际上是指封闭函数。

```
()=>{
  if (someMethodThatReturnsBoolean()) return true
  // otherwise do stuff here
}:Boolean 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T17:10:22.620

为什么不 ？

```
() =>
  someMethodThatReturnsBoolean() || {
    //do stuff here that eventually returns a boolean
  } 
```

或者，如果您不喜欢使用操作符产生副作用，`||`您可以在以下情况下使用 plain：

```
() =>
  if (someMethodThatReturnsBoolean())
    true
  else {
    //do something here that returns boolean eventually
  } 
```

`if`只是 Scala 中的一个表达式，您应该以类似表达式的方式组织代码并`return`尽可能避免。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-15T17:19:25.913

> 现在的方式，返回实际上是指封闭函数。

这就是它应该的样子。您不能`return`用于从匿名函数返回。您必须重写代码以避免该`return`语句，如：

```
()=>{
  if (someMethodThatReturnsBoolean()) true
  else {
    // otherwise do stuff here
  }
}:Boolean 
```

# elasticsearch - Elasticsearch：包括特定的方面值

> ID：16020759
> 
> 赞同：1
> 
> 时间：2013-04-15T17:01:01.647
> 
> 标签：elasticsearch, facets

elasticsearch 提供参数以从这样的方面值中排除某些方面。

```
 "facets" : {
        "tag" : {
            "terms" : {
                "field" : "tag",
                "exclude" : ["term1", "term2"]
            }
        }
    } 
```

是否有可能包括某些方面？

我正在尝试获取用户已经选择的方面以及全局方面的计数。例如。您选择了计数为 20 的 word *science*（来自自动完成），我重新计算了 facets 以显示可能被选中的其他单词，但是由于 global facets 中的其他单词的计数超过 400 ，因此*science一词不会得到 facet 结果。*

这个任务有什么特别的解决方案吗？

感谢帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T18:28:42.207

您可以为此使用脚本。将为每个带有`term`包含当前值的输入变量的构面条目运行脚本。根据脚本的结果，条目将包含或不包含在最终方面。如果返回 false 将被排除，否则将被包含。

```
"facets" : {
    "tag" : {
        "terms" : {
            "field" : "tag",
            "script" : "term == 'aaa' ? true : false"
        }
    }
} 
```

# json - 构建 API：JSON 数组也适用于单元素数组？

> ID：16020763
> 
> 赞同：0
> 
> 时间：2013-04-15T17:01:18.830
> 
> 标签：json, api

我正在构建一个使用 JSON 进行请求/响应的 API。我还希望能够接收批量请求，即 JSON 数组。

现在，如果 JSON 请求总是包装在一个数组中，我有一个可以正常工作的解决方案：

```
[
{"id":"AAAEEF", "value":"abc"}
] 
```

作品，也

```
[
{"id":"AAAEEF", "value":"abc"},
{"id":"AAAEF1", "value":"vbc"},
] 
```

如果一个人只想请求一个 id-value 组合并因此请求

```
{"id":"AAAEEF", "value":"abc"} 
```

请求失败。

我的问题：“好的”API 是否可以强制将所有 JSON 请求包装在一个数组中，即使它们只有一个元素？

提前感谢您帮助我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:04:51.810

编写“好的”API 的关键是保持一致，并做好记录。无论您接下来做出什么选择，都由您自己决定——如果您决定有充分的理由要求对 API 的所有调用都应包装在 thisIsAContainerObject 元素中，请务必记录并释放它。

为了保持一致性，总是需要一个数组甚至可能会更好。只要在插入多个元素时抛出适当的错误。

# javascript - 揭示模块模式问题

> ID：16020764
> 
> 赞同：2
> 
> 时间：2013-04-15T17:01:23.053
> 
> 标签：javascript, design-patterns

这是我的代码：

```
var APP = {}

APP.item = function() {
    var two = function() { return "three"; }
    return {
        two: two
    };
}

console.log(APP.item.two); 
```

现在，根据我的阅读，输出不应该是“三”吗？相反，结果是未定义的。

小提琴：http: [//jsfiddle.net/mhxpz/1/](http://jsfiddle.net/mhxpz/1/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T17:05:10.143

`item`和都是`two`需要调用的函数：

```
console.log(APP.item().two()); 
```

...

**额外说明：**在您的原始代码中，该`item`位只是返回函数，而不是您希望函数返回的对象。因此，当您请求`item.two`它时，找不到`two`属性（因为它是返回对象的一部分，而不是`item`函数本身的一部分）。希望这对你有意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T17:07:21.147

结果是未定义的，因为您没有调用该`APP.item`函数（因此获取`return`值。您还需要调用该`two`函数以获取其返回值：

```
console.log( APP.item().two() );  // outputs "three" 
```

# php - 获取 PHP 文件以将文本/纯文本返回到 AJAX 调用

> ID：16020765
> 
> 赞同：0
> 
> 时间：2013-04-15T17:01:24.870
> 
> 标签：php, javascript, html, ajax

我正在开发一个简单的 HTML 表单，该表单要么检测记录是否存在（在 XML 文件中）并填充所有字段，要么检测到表单不存在并在提交时创建记录（或修改当前记录，如果它已被修改）

我现在正在处理将添加不存在的记录和/或修改现有记录的部分。

AJAX 调用 PHP 文件，在 PHP 文件中我想检查记录是否存在并相应地执行适当的操作。我希望表单的用户被告知（不是双关语）执行了哪些操作（即“添加记录”或“修改记录”）。

首先，我现在的 PHP 所做的只是返回 text `added`。我想看看我是否可以让“添加记录”正确显示在原始 HTML 文件中。

**预期：**当我单击 时`Submit`，我希望在表单下方显示消息“已添加记录”或“已修改记录”，具体取决于 PHP 文件的返回。

**错误：**现在，当我单击时`Submit`，表单会自行重置，将所有参数添加到 URL，并且我没有从 AJAX 请求中收到任何消息。

这是我的代码：

HTML页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
    <head> 
        <script type="text/javaScript">
            function checkID(val){
                if (val.value.length != 6) //Since student ID's are six digits
                    return;
                //inID = val.value;
                //if (inID.length < 6) return;

                xhr = new XMLHttpRequest();
                xhr.open('GET', 'processor.php?studentID=' + document.forms[0].elements[0].value);
                xhr.onreadystatechange = function() {
                    /**
                    if (xhr.readystate != 4 || xhr.status != 200){
                        document.getElementById("status").innerHTML = "<p> Not Done Yet</p>";
                    }
                    **/
                    if (xhr.readyState === 4 && xhr.status === 200){
                        document.getElementById("status").innerHTML = "";
                        parse(xhr.responseXML); 
                    }
                }
                xhr.send();
                document.getElementById("status").innerHTML = "<p> Not Done Yet</p>";
            }
            function parse(xml){
                if (xml == null) alert("Null!");
                var student = xml.getElementsByTagName('student');
                    if (student.length == 0) alert("No Student's Found with that ID");
                var content = student.item('0');
                    var name = content.getElementsByTagName('fullname');
                    name = name.item(0).childNodes[0].nodeValue;
                    document.forms[0].elements[1].value = name;

                    var phone = content.getElementsByTagName('phone');
                    phone = phone.item(0).childNodes[0].nodeValue;
                    document.forms[0].elements[2].value = phone;

                    var email = content.getElementsByTagName('email');
                    email = email.item(0).childNodes[0].nodeValue;
                    document.forms[0].elements[3].value = email;

            }
            function addOrModify(curr){
                xhr2 = new XHRHttpRequest();
                xhr2.open('GET', 'addOrModify.php'); //?studentID=' + document.forms[0].elements[0].value);
                xhr2.onreadystatechange = function(){
                    if (xhr2.readyState === 4 && xhr2.status === 200){
                        if (xhr.responseText == "added") {document.getElementById("status").innerHTML = "<p>Added the Record</p>"};
                    }
                }
                xhr.send();
                return false;
            }

        </script>
        <style type="text/css">
            #container {
                margin: 0 auto;
                padding: 30px;
                text-align: center;
            }
            .centerp {
                font-size: 150%;
                text-align: center;
            }
            table {
                align: center;
            }
        </style>
        <title>Student Profile</title>
    </head>

    <body>
        <p class="centerp"> Student Profiles </p>
        <div id="container">
            <form>
                <table align="center">
                    <label>
                        <tr>
                            <td>Student ID</td> 
                            <td><input type="text" name="studentID" onblur="checkID(this)"> </input></label></td>
                        </tr>
                    </label>
                    <label>
                        <tr>
                            <td>Name</td> 
                            <td><input type="text" name="name" id="name"> </input></label></td>
                        </tr>
                    </label>
                    <label>
                        <tr>
                            <td>Phone</td> 
                            <td><input type="text" name="phone"> </input></label></td>
                        </tr>
                    </label>
                    <label>
                        <tr>
                            <td>Email</td> 
                            <td><input type="text" name="email"> </input></label></td>
                        </tr>
                    </label>
                        <tr>
                            <td> <input type="submit" onclick="return addOrModify()"> </input></td></tr> </td>
                        </tr>
                        <tr>
                            <td> <div id="status">
                                </div> </td>
                        </tr>
                </table>
            </form>
        </div>
    </body>
</html> 
```

简单的 PHP 页面：

```
<?php

aOm();
function aOm(){
    header("Content-type: text/plain; charset=utf-8");
    echo "added";
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T18:29:29.480

代码中的小错别字

```
function addOrModify(curr){
                xhr2 = new XMLHttpRequest(); // xhr2 = new XHRHttpRequest();
                xhr2.open('GET', 'addOrModify.php'); //?studentID=' + document.forms[0].elements[0].value);
                xhr2.onreadystatechange = function(){
                    if (xhr2.readyState === 4 && xhr2.status === 200){
                        if (xhr2.responseText == "added") // if (xhr.responseText == "added")
                          {document.getElementById("status").innerHTML = "<p>Added the Record</p>"};
                        }

                }
                xhr2.send(); //xhr.send();
                return false;
            } 
```

那应该让它工作。虽然你的 php 代码没有错误

# asp.net - 如何停止在 Sitecore Image 字段渲染器中形成绝对 URL？

> ID：16020769
> 
> 赞同：0
> 
> 时间：2013-04-15T17:01:31.510
> 
> 标签：asp.net, sitecore

我基本上有一些绑定到转发器的项目，这些项目具有与图像字段相关联的图像：

```
<asp:Repeater runat="server" DataSource="<%# Actions %>">
    <ItemTemplate>
        <li>
            <sc:Image Field="Image"  runat="server" Item="<%# Container.DataItem as Sitecore.Data.Items.Item %>" /> 
```

现在我不认为 sitecore 默认情况下是为了放入绝对网址，而不是获取：

```
<img src="/~/media/image.ashx" /> 
```

我越来越：

```
<img src="http://<domain>/~/media/image.ashx" /> 
```

我需要相对路径而不是绝对路径，因为域可以根据页面类型在 http 和 https 之间切换，并且无论如何通过的图像都保留在 http 端。

有没有办法可以改变 sc:Image MediaUrlOptions ？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T17:22:08.700

查看您的 web.config 中的此值设置为什么。`<setting name="Media.AlwaysIncludeServerUrl" value="false" />`

你需要它是假的或空白的。

# android - Android Facebook SDK 3.0 无需显式登录的简单状态更新？

> ID：16020771
> 
> 赞同：2
> 
> 时间：2013-04-15T17:01:36.327
> 
> 标签：android, facebook, dialog, facebook-login, facebook-authentication

我想知道更新用户 Facebook 状态的最简单方法。我想简单地显示一个“分享”按钮。当用户触摸“分享”时：

1.  如果他们已经登录到 Facebook，将出现一个对话框，让他们可以选择在提交到 Facebook 之前编辑他们的帖子。

2.  如果他们尚未登录 Facebook，将提示他们登录，然后在成功登录后自动显示共享对话框。

有没有一种简单的方法可以做到这一点，还是我需要实现一个单独的 facebook 登录流程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:14:43.830

所以我认为我有一个非常干净的方法来做到这一点。我欢迎任何意见。

我正在发布我的整个 Facebook 管理器类，它可以完成登录工作并打开提要对话框：

```
public class ManagerFacebook
{
    private Activity mActivity;

    public void updateStatus(final String name, final String caption, final String description, final String link, final String urlPicture,
        final Activity activity, final ListenerShareFacebook listenerShareFacebook)
    {
        mActivity = activity;

        // start Facebook Login
        Session.openActiveSession(activity, true, new Session.StatusCallback()
        {
            // callback when session changes state
            public void call(final Session session, SessionState state, Exception exception)
            {
                if (session.isOpened())
                {
                    publishFeedDialog(name, caption, description, link, urlPicture, listenerShareFacebook);
                }

            }
        });
    }

    private void publishFeedDialog(String name, String caption, String description, String link, String urlPicture,
        final ListenerShareFacebook listenerShareFacebook)
    {
        Bundle params = new Bundle();
        params.putString("name", name);
        params.putString("caption", caption);
        params.putString("description", description);
        params.putString("link", link);
        params.putString("picture", urlPicture);

        Session session = Session.getActiveSession();

        WebDialog feedDialog = (new WebDialog.FeedDialogBuilder(mActivity, session, params)).setOnCompleteListener(new OnCompleteListener()
        {
            public void onComplete(Bundle values, FacebookException error)
            {
                if (error == null)
                {
                    // When the story is posted, echo the success
                    // and the post Id.
                    final String postId = values.getString("post_id");
                    if (postId != null)
                    {
                        listenerShareFacebook.onShareFacebookSuccess();
                    }
                    else
                    {
                        // User clicked the Cancel button
                        listenerShareFacebook.onShareFacebookFailure("Publish cancelled");
                    }
                }
                else if (error instanceof FacebookOperationCanceledException)
                {
                    // User clicked the "x" button
                    listenerShareFacebook.onShareFacebookFailure("Publish cancelled");
                }
                else
                {
                    // Generic, ex: network error
                    listenerShareFacebook.onShareFacebookFailure("Error posting story");
                }
            }

        }).build();
        feedDialog.show();
    }
} 
```

此外，上面引用的是我的 Listener 接口，因此我可以通知我的 Activity 与 Facebook 相关的内容：

```
public interface ListenerShareFacebook
{
    void onShareFacebookSuccess();

    void onShareFacebookFailure(String error);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T17:15:32.080

我真的会推荐这个：

```
Intent sharingIntent = new Intent(Intent.ACTION_SEND);
         sharingIntent.setType("text/plain");
         sharingIntent.putExtra(android.content.Intent.EXTRA_TEXT, "text");
         sharingIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, "Title");
         startActivity(Intent.createChooser(sharingIntent, "Share using")); 
```

这不使用 facebook sdk，但确实使用了 facebook 应用程序。在我看来，大多数拥有智能手机和 Facebook 的人都使用这个应用程序，并希望通过这个应用程序分享所有内容。用户也可以点击分享其他内容（推特、短信、g+、电子邮件……）

对我来说，任何 facebook sdk 的最佳替代品。（也可以附上图片）

# sapui5 - SAPUI5 中的拆分器控件

> ID：16020773
> 
> 赞同：1
> 
> 时间：2013-04-15T17:01:47.270
> 
> 标签：sapui5

我正在尝试实现 SAPUI5 拆分器按钮/控件，它接受一个标签和一个按钮，如链接中。就像添加技能时链接中一样，文本显示以及删除按钮。如果要删除文本，只需单击删除按钮，它将删除（这是链接中发生的情况）。

我也想使用 SAP 拆分器控件实现相同的功能，但我面临一些布局问题。我已经尝试了很多来解决这个问题，但没有运气。

这是我的代码

在代码中总共有三个拆分器。称为 oSplitterH 的主拆分器在其 addFirstPaneContent 中保存了 0.....n 个子子拆分器。

问题是它总是以垂直对齐方式显示拆分按钮，而不是像链接的那样水平。我还将布局更改为水平，但仍以垂直对齐方式显示。

有什么建议吗？

```
var splitterLabel = new Label({
    text : 'Splitter ',
    width: '80px'
});
    var oSplitterH = new sap.ui.commons.Splitter("splitterH");
    oSplitterH.setSplitterOrientation(sap.ui.commons.Orientation.Horizontal);
    oSplitterH.setSplitterPosition("200%%");
    oSplitterH.setMinSizeFirstPane("20%");
    oSplitterH.setMinSizeSecondPane("30%");
    oSplitterH.setWidth("200%");

        //adding Labels to both panes

    var oSplitter2 = new sap.ui.commons.Splitter("splitterH12");
    oSplitter2.setSplitterOrientation(sap.ui.commons.Orientation.Vertical);
    oSplitter2.setSplitterPosition("10%");
    oSplitter2.setMinSizeFirstPane("10%");
    oSplitter2.setMinSizeSecondPane("10%");
    oSplitter2.setWidth("20%");

    var oLabel2 = new sap.ui.commons.Label({text: "Part1"});
    oSplitter2.addFirstPaneContent(oLabel2);   

    var oLabel2 = new sap.ui.commons.Label({text: "Part2"});
    oSplitter2.addFirstPaneContent(oLabel2);   

    var oSplitter3 = new sap.ui.commons.Splitter("splitterH13");
    oSplitter3.setSplitterOrientation(sap.ui.commons.Orientation.Vertical);
    oSplitter3.setSplitterPosition("10%");
    oSplitter3.setMinSizeFirstPane("10%");
    oSplitter3.setMinSizeSecondPane("10%");
    oSplitter3.setWidth("20%");

    var oLabe123 = new sap.ui.commons.Label({text: "Part3"});
    oSplitter3.addFirstPaneContent(oLabe123);   

    var oLabe1234 = new sap.ui.commons.Label({text: "Part4"});
    oSplitter3.addFirstPaneContent(oLabe1234);   

    oSplitterH.addFirstPaneContent(oSplitter2);   
    oSplitterH.addFirstPaneContent(oSplitter3);   

    createProfileMatrix.createRow(splitterLabel, oSplitterH, null, null); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-20T11:44:36.847

以下代码可能会对您有所帮助。

索引.html

```
<!DOCTYPE HTML>
<html>
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <link rel="stylesheet" href="main.css"/>
        <script src="resources/sap-ui-core.js"
                id="sap-ui-bootstrap"
                data-sap-ui-libs="sap.ui.commons"
                data-sap-ui-theme="sap_goldreflection">
        </script>
        <!-- add sap.ui.table,sap.ui.ux3 and/or other libraries to 'data-sap-ui-libs' if required -->

        <script>
                sap.ui.localResources("sapui5samples");
                var view = sap.ui.view({id:"idlinkedIn-label1", viewName:"sapui5samples.linkedIn-label", type:sap.ui.core.mvc.ViewType.JS});
                view.placeAt("content");
        </script>

    </head>
    <body class="sapUiBody" role="application">
        <div id="content"></div>
        <div id="list"></div>
    </body>
</html> 
```

main.css

```
 .tech-area{
            border:1px solid gray;
            border-radius: 5px;
            width:500px;
            height:300px;
            left:0;
            top:50;
            position:relative;
            overflow:scroll;
        } 
```

SAPUI5 视图文件（未使用控制器文件）

```
 var oLayout;
sap.ui.jsview("sapui5samples.linkedIn-label", {

    getControllerName : function() {
        return "sapui5samples.linkedIn-label";
    },
    createContent : function(oController) {
        // create a simple SearchField with suggestion list (list expander
        // visible)
        var oSearch = new sap.ui.commons.SearchField("suggestSearch1", {
            enableListSuggest : true,
            startSuggestion : 1,
            search : function(oEvent) {
                var techName = oEvent.getParameter("query");
                addTechnology(techName);
            },
            suggest : doSuggest
        });
        // Button for adding the technology if it is not listed in the available
        // technologies
        var oButton = new sap.ui.commons.Button({
            text : "Add",
            tooltip : "Add Technology",
            press : function() {
                var tech = sap.ui.getCore().byId("suggestSearch1").getValue();
                addTechnology(tech);
            }
        });

        // create a simple horizontal layout
        var oLayout = new sap.ui.commons.layout.HorizontalLayout({
            content : [ oSearch, oButton ]
        });

        // attach it to some element in the page
        oLayout.placeAt("content");
        oLayout = new sap.ui.commons.layout.HorizontalLayout("target");
        oLayout.addStyleClass("tech-area");

        // attach it to some element in the page
        oLayout.placeAt("list");

    }
});
// Help function to handle the suggest events of the search field
var doSuggest = function(oEvent) {
    var sVal = oEvent.getParameter("value");
    var aSuggestions = filterTechnologies(sVal); // Find the technologies
    var oSearchControl = sap.ui.getCore().byId(oEvent.getParameter("id"));
    oSearchControl.suggest(sVal, aSuggestions); // Set the found suggestions on
                                                // the search control
};
var technologies = [ "Java", ".Net", "PHP", "SAPUI5", "JQuery", "HTML5", "" ];
technologies.sort();

jQuery.sap.require("jquery.sap.strings"); // Load the plugin to use
                                            // 'jQuery.sap.startsWithIgnoreCase'

// Help function to filter the technologies according to the given prefix
var filterTechnologies = function(sPrefix) {
    var aResult = [];
    for (var i = 0; i < technologies.length; i++) {
        if (!sPrefix || sPrefix.length == 0
                || jQuery.sap.startsWithIgnoreCase(technologies[i], sPrefix)) {
            aResult.push(technologies[i]);
        }
    }
    return aResult;
};
var count = 0;
var arr = [];
// function for add the item to horizontal layout
var addTechnology = function(techName) {
    var elementIndex = arr.indexOf(techName);
    // conditional statement for adding the tech to the list
    if (elementIndex === -1) {
        count++;
        // create a horizontal Splitter
        var oSplitterV = new sap.ui.commons.Splitter({
            width : "120px",
            height : "30px",
            showScrollBars : false,
            splitterBarVisible : false
        });
        oSplitterV.setSplitterOrientation(sap.ui.commons.Orientation.vertical);
        oSplitterV.setSplitterPosition("60%");
        oSplitterV.setMinSizeFirstPane("60%");
        oSplitterV.setMinSizeSecondPane("40%");
        // label with dynamic Id
        var oLabel1 = new sap.ui.commons.Label("tCount" + count, {
            text : techName,
            tooltip : techName
        });
        oSplitterV.addFirstPaneContent(oLabel1);

        var oLabel2 = new sap.ui.commons.Button({
            icon : "img/delete.png",
            press : function() {
                removeElement(techName);
                oSplitterV.destroy();
            }
        });
        oSplitterV.addSecondPaneContent(oLabel2);
        sap.ui.getCore().byId("target").addContent(oSplitterV);
        // Adding the tech to the parent array
        arr.push(techName);
        // Emptying the search box
        sap.ui.getCore().byId("suggestSearch1").setValue("");
    } else {
        sap.ui.commons.MessageBox.alert(techName
                + " is already added to the list");
    }
}
// function for removing removed element from parent array
var removeElement = function(addedTech) {
    // Find and remove item from an array
    var i = arr.indexOf(addedTech);
    if (i != -1) {
        arr.splice(i, 1);
    }
} 
```

请注意，我更关注功能而不是外观

谢谢，开发者

# python - href 给出的谷歌搜索 url 错误

> ID：16020774
> 
> 赞同：0
> 
> 时间：2013-04-15T17:01:47.730
> 
> 标签：python, html, web, beautifulsoup

谷歌搜索似乎会给出以下网址：

```
/url?q=  "URL WOULD BE HERE"    &sa=U&ei=9LFsUbPhN47qqAHSkoGoDQ&ved=0CCoQFjAA&usg=AFQjCNEZ_f4a9Lnb8v2_xH0GLQ_-H0fokw 
```

当受到 BeautifulSoup 的 html 解析时。

我通过使用`soup.findAll('a')`然后使用 ['href'] 来获取链接。

更具体地说，我使用的代码如下：

```
import urllib2
from BeautifulSoup import BeautifulSoup, SoupStrainer
import re

main_site = 'https://www.google.com/'
search = 'search?q=' 
query = 'pillows'
full_url = main_site+search+query
request = urllib2.Request(full_url, headers={'User-Agent': 'Chrome/16.0.912.77'})
main_html = urllib2.urlopen(request).read()

results = BeautifulSoup(main_html, parseOnlyThese=SoupStrainer('div', {'id': 'search'}))
try:
    for search_hit in results.findAll('li', {'class':'g'}):
        for elm in search_hit.findAll('h3',{'class':'r'}):
            for a in elm.findAll('a',{'href':re.compile('.+')}):
                print a['href']

except TypeError:
    pass 
```

此外，我注意到在其他网站上`a['href']`可能会返回类似`/dsoicjsdaoicjsdcj`链接将带您到的位置`website.com/dsoicjsdaoicjsdcj`。我知道如果是这种情况，我可以简单地将它们连接起来，但我觉得我不应该改变我解析的方式，并`a['href']`根据我正在查看的网站来处理。有没有更好的方法来获取这个链接？我需要考虑一些javascript吗？在 BeautifulSoup 中肯定有一种简单的方法来获取完整的 html`a`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T19:20:31.573

```
SoupStrainer('div', {'class': "vsc"}) 
```

执行以下操作时不返回任何原因：

```
print main_html 
```

并搜索“vsc”，没有结果

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-22T13:25:48.567

你正在寻找这个：

```
# container with needed data: title, link, etc.
for result in soup.select('.tF2Cxc'):
  link = result.select_one('.yuRUbf a')['href'] 
```

此外，在使用`requests`库时，您可以像这样轻松[传递 URL 参数：](https://docs.python-requests.org/en/master/user/quickstart/#passing-parameters-in-urls)

```
# this:
main_site = 'https://www.google.com/'
search = 'search?q=' 
query = 'pillows'
full_url = main_site+search+query

# could be translated to this:
params = {
  'q': 'minecraft',
  'gl': 'us',
  'hl': 'en',
}
html = requests.get('https://www.google.com/search', params=params) 
```

在使用`urllib`时，您可以这样做（在 python 3 中，这已移至[`urllib.parse.urlencode`](https://docs.python.org/3/library/urllib.parse.html#urllib.parse.urlencode)）：

```
# https://stackoverflow.com/a/54050957/15164646
# https://stackoverflow.com/a/2506425/15164646

url = "https://disc.gsfc.nasa.gov/SSW/#keywords="
params = {'keyword':"(GPM_3IMERGHHE)", 't1':"2019-01-02", 't2':"2019-01-03", 'bboxBbox':"3.52,32.34,16.88,42.89"}

quoted_params = urllib.parse.urlencode(params)
# 'bboxBbox=3.52%2C32.34%2C16.88%2C42.89&t2=2019-01-03&keyword=%28GPM_3IMERGHHE%29&t1=2019-01-02'

full_url = url + quoted_params
# 'https://disc.gsfc.nasa.gov/SSW/#keywords=bboxBbox=3.52%2C32.34%2C16.88%2C42.89&t2=2019-01-03&keyword=%28GPM_3IMERGHHE%29&t1=2019-01-02'

resp = urllib.urlopen(full_url).read() 
```

[在线IDE中的](https://replit.com/@DimitryZub1/Google-Scrape-Title-Description-Linkpythonbs4#bs4_results.py)代码和示例：

```
from bs4 import BeautifulSoup
import requests, lxml

headers = {
    'User-agent':
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.19582'
}

params = {
  'q': 'minecraft',
  'gl': 'us',
  'hl': 'en',
}

html = requests.get('https://www.google.com/search', headers=headers, params=params)
soup = BeautifulSoup(html.text, 'lxml')

for result in soup.select('.tF2Cxc'):
  link = result.select_one('.yuRUbf a')['href']
  print(link)

---------
'''
https://www.minecraft.net/en-us/
https://classic.minecraft.net/
https://play.google.com/store/apps/details?id=com.mojang.minecraftpe&hl=en_US&gl=US
https://en.wikipedia.org/wiki/Minecraft
''' 
```

* * *

或者，您可以使用来自 SerpApi的[Google Organic Results API](https://serpapi.com/organic-results)来实现相同的目的。这是一个带有免费计划的付费 API。

您的情况的不同之处在于您不必从头开始制作所有内容，绕过块并随着时间的推移维护解析器。

要集成以实现您的目标的代码：

```
import os
from serpapi import GoogleSearch

params = {
  "engine": "google",
  "q": "minecraft",
  "hl": "en",
  "gl": "us",
  "api_key": os.getenv("API_KEY"),
}

search = GoogleSearch(params)
results = search.get_dict()

for result in results["organic_results"]:
  print(result['link'])

---------
'''
https://www.minecraft.net/en-us/
https://classic.minecraft.net/
https://play.google.com/store/apps/details?id=com.mojang.minecraftpe&hl=en_US&gl=US
https://en.wikipedia.org/wiki/Minecraft
''' 
```

> 免责声明，我为 SerpApi 工作。

# mysql - UPDATE 和 SELECT 一个语句

> ID：16020776
> 
> 赞同：0
> 
> 时间：2013-04-15T17:02:11.357
> 
> 标签：mysql, mysql-workbench

我不确定为什么不起作用

```
UPDATE comunitat_2 
SET Poblacion_total = (SELECT SUM(poblacio2003) 
                       FROM municipi, comunitat 
                       WHERE municipi.ca_id =comunitat.ca_id 
                       GROUP BY comunitat.nom); 
```

我该如何解决？

# python - Glade / GTK + 3 / Python中的ComboBoxText - 第二次显示时消失

> ID：16020781
> 
> 赞同：1
> 
> 时间：2013-04-15T17:02:33.797
> 
> 标签：python, gtk, pygtk, glade, gtk3

我正在尝试使用 Glade (GTK+3) 和 Python 在 Ubuntu 应用程序中实现下拉列表。我可以让 ComboBoxText 显示，填充字符串。但是，当我关闭它所在的窗口然后重新打开它时，组合框不存在，只是一个完全空白的窗口。

我将有问题的 ComboBoxText 小部件添加到 Glade 的一个窗口中。然后我在我的 Python 程序中添加了这段代码：

```
def on_button_edit_clicked(self, widget):
    """ display list of events already stored, and allow deletion """   

    self.combo = self.builder.get_object('combo_box')
    self.store = Gtk.ListStore(str)

    self.store.append(['hello'])
    self.store.append(['goodbye'])
    self.combo.set_model(self.store)

    event_editor = self.builder.get_object("event_editor")
    event_editor.show() 
```

我什至尝试销毁小部件以查看是否有帮助：

```
def on_event_editor_destroy(self, widget):
    self.combo.destroy()
    self.store = Gtk.ListStore(str)
    self.combo.set_model(self.store) 
```

编辑：

从那以后，我尝试了一些替代代码，其中包括一个 CellRendererText 对象，但仍然没有运气。

这些是我的来源：我创建了一个[Gtk.ListStore()](http://python-gtk-3-tutorial.readthedocs.org/en/latest/treeview.html#Gtk.ListStore)，然后我创建了一个[Gtk.CellRendererText()](http://python-gtk-3-tutorial.readthedocs.org/en/latest/cellrenderers.html#cellrenderertext)，然后我创建了一个[Gtk.ComboBox()](http://python-gtk-3-tutorial.readthedocs.org/en/latest/combobox.html)。这与[此处](http://python-gtk-3-tutorial.readthedocs.org/en/latest/combobox.html)的示例 13.3 一致。

没有任何效果。当我第二次打开组合框窗口时，它只是一个空白窗口。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:20:04.037

我找到了解决方案。我正在使用 x 按钮关闭窗口，这一定是在破坏小部件及其关联的列表存储。相反，我现在使用一个自定义按钮，它只是隐藏窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-21T15:35:19.150

标题说，“Glade / GTK+3 / Python 中的ComboBoxText ...”然后你尝试实现一个GtkComboBox，而不是一个GtkComboBoxText。为什么要用 GtkComboBox 折磨自己。

林间空地文件（片段）

```
<object class="GtkComboBoxText" id="comboboxtextEventEditor">
    <property name="visible">True</property>
    <property name="can_focus">False</property>
    <property name="halign">end</property>
    <property name="margin_right">10</property>
    <property name="hexpand">True</property>
    <property name="entry_text_column">0</property>
    <property name="id_column">1</property>
    <signal name="changed" handler="on_changed_event_editor" swapped="no"/>
</object> 
```

注意 GtkComboBoxText 不需要 GtkListStore。现在一些类方法

```
from __future__ import print_function
from gi.repository import Gtk
import os

def TheClass(Gtk.ApplicationWindow):
    #class variable
    UI_FILE = "preference.glade"

    @staticmethod
    def get_id():
        return "windowTheClass"

    def __init__(self, app):
        """ Constructor"""
        # Initialize class variables.
        #app is an instance of a class which extends Gtk.Application
        #Hardcode to have a working example code
        self.ui_path = os.path.join("home", "useraccount", "Documents", "example")
        #self.app = app
        #self.ui_path = self.app.ui_path
        # Load ui
        self.__load_ui()
        self.__initialize_event_editor_combobox()

    def __load_ui(self):
        self.builder = Gtk.Builder()
        try:
            strUIFile = os.path.join(self.ui_path, self.UI_FILE)
            self.builder.add_from_file( strUIFile )
            del strUIFile
            self.win = self.builder.get_object( self.__class__.get_id() )
            # This is not useful until Gtk version 3.6
            #self.app.add_window(self.win)
            self.builder.connect_signals(self)
        except:
            print(self.__class__.__name__ + ".__load_ui error",  sys.exc_info()[1])

    def __initialize_event_editor_combobox(self):
        """ Populate event editor comboboxtext"""
        combobox = self.builder.get_object("comboboxtextEventEditor")
        combobox.remove_all()
        # Args [position, id, text]
        combobox.insert(0,"0", "Hello")
        combobox.insert(0,"1", "goodbye")
        combobox.set_active_id("1")
        del combobox

    def on_changed_event(self, widget, data=None):
        """ combobox value selected. Refresh combobox"""
        strSelectedEntry = widget.get_active_text()
        print(self.__class__.__name__ + ".on_changed_event", strSelectedEntry)
        #self.initialize_something_else(strSelectedEntry)
        del strSelectedEntry 
```

# c - GCC 下与 Cortex-M0 的变量对齐

> ID：16020784
> 
> 赞同：3
> 
> 时间：2013-04-15T17:02:58.783
> 
> 标签：c, gcc, linker, alignment, cortex-m

我正在尝试找到一种使用 GCC 将 32 位或 16 位键上的变量对齐的好方法。

我正在研究不支持未对齐数据访问的 Cortex-M0。我在使用时遇到了这个问题`-Os`。我使用 arm-none-eabi 版本 4.6.2。我有这个小测试用例：

```
#include "stdint.h"

typedef struct Struct_HdrPrefix{
    uint8_t Prefix;
    uint16_t Type;
}__attribute((packed))Struct_HdrPrefix;

volatile Struct_HdrPrefix test;
volatile Struct_HdrPrefix test1;

int main(void)
{
    test.Type = 0;
    while(1)
        __asm("nop");
}

void HardFault_Handler(void)
{
    while(1)
        __asm("nop");
} 
```

当我编译这个时，我得到一个非对齐的变量测试。

这是地图文件中的结果：

```
COMMON         0x20000000        0x6 ./SRC/main.o
               0x20000000                test1
               0x20000003                test 
```

所以现在我遇到了硬故障。如果我将其添加到变量中：

```
volatile Struct_HdrPrefix test __attribute((aligned (4)));
volatile Struct_HdrPrefix test1 __attribute((aligned (4))); 
```

由于`test`现在已对齐，因此按预期工作。

我不能在结构上使用 align 属性，因为这个结构也可能是另一个包装的一部分。

有没有办法告诉 GCC 或 LD 在 32 位边界上对齐打包变量？

问候

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T17:11:42.093

如果你不介意：

```
typedef struct Struct_HdrPrefix{
    uint8_t Prefix;
    uint8_t dummy; // for alignment
    uint16_t Type;
}__attribute((packed))Struct_HdrPrefix; 
```

如果您想要打包结构和对齐字段，则没有其他方法。您必须手动对齐数据。您唯一的选择是插入的位置`dummy`（以及插入的数量）。

# ruby - 为什么 datamapper 总是将默认小数舍入为整数

> ID：16020795
> 
> 赞同：0
> 
> 时间：2013-04-15T17:03:33.143
> 
> 标签：ruby, sinatra, datamapper

我将 Ruby sinatra 与 datamapper 一起使用。在我的模型中，我有一个小数属性

```
property :sim_update_interval, Decimal, :precision=>10, :scale=>2 , :default=>0.9 
```

问题是：每次创建模型的新实例时， :sim_update_interval 的默认值从不是 0.9，而是 1.0

```
puts instance.sim_update_interval 
#=> 0.1E1 
```

我尝试将默认值更改为 0.2，输出变为 0.0 似乎 datamapper 总是将默认值四舍五入为整数。我感到很困惑

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:36:17.533

事实证明，当表中有数据（行）时，rake db:migrate 不会修改现有列。我擦了桌子并做了 rake db:migrate，现在一切正常。

# jquery - jQuery UI：可拖动滚动问题

> ID：16020798
> 
> 赞同：5
> 
> 时间：2013-04-15T17:03:56.380
> 
> 标签：jquery, jquery-ui, positioning, jquery-ui-draggable, mousewheel

我正在尝试使用 jQuery UI 构建一个可拖动/可放置的文件夹文件视图，但我遇到了一个问题，我认为这归因于助手。这是我的代码：

**的HTML**

```
<body>
  <div id="topContainer">
    <span>Parent Directory 1</span>
  </div>
  <span id="topFolder" class="folder">
    <div class="drop">
    </div>
  </span>
  <hr />
  <div id="container" class="container">
    <div class="dropzone">
      <span>Parent Directory 2</span>
    </div>
    <div id="cont1" class="container">
      <div class="dropzone">
        <span>Folder 1</span>
      </div>
      <span id="folder1" class="folder">
        <div class="drop">
          <div class="drag">&nbsp;</div>
          <div class="drag">&nbsp;</div>
          <div class="drag">&nbsp;</div>
          <div class="drag">&nbsp;</div>
          <div class="drag">&nbsp;</div>
          <div class="drag">&nbsp;</div>
          <div class="drag">&nbsp;</div>
          <div class="drag">&nbsp;</div>
          <div class="drag">&nbsp;</div>
          <div class="drag">&nbsp;</div>
          <div class="drag">&nbsp;</div>
          <div class="drag">&nbsp;</div>
        </div>
      </span>
    </div>
    <div id="cont2" class="container">
      <div class="dropzone">
        <span>Folder 2</span>
      </div>
      <span id="folder2" class="folder">
        <div class="drop">
        </div>
      </span>
    </div>
    <div id="cont3" class="container">
      <div class="dropzone">
        <span>Folder 3</span>
      </div>
      <span id="folder3" class="folder">
        <div class="drop">
        </div>
      </span>
    </div>
    <span id="mainFolder" class="folder">
      <div class="drop">
        <div class="drag">&nbsp;</div>
      </div>
    </span>
  </div>
</body> 
```

**jQuery**

```
$(document).ready(function () {
  var opts = {
    helper: 'clone',
    appendTo: 'body'
    //appendTo: '#container'
  };

  $('div.drag').each(function () {
    $(this).draggable(opts);
  });

  $('.dropzone, #topContainer').droppable({
    drop: function (e, ui) {
      var clone = $(ui.draggable).clone();
      clone.draggable(opts);
      $(this).siblings('.folder').children('.drop').append(clone);
      $(this).removeClass('over');
    },
    over: function (e, ui) {
      $(this).addClass('over');
    },
    out: function (e, ui) {
      $(this).removeClass('over');
    }
  });
}); 
```

**CSS**

```
.dropzone {
    height: 300px;
    width: 100px;
    border: 1px solid black;
}
.drag {
    clear: both;
    height: 50px;
    width: 80px;
    background-color: black;
    position: relative;
    cursor: pointer;
}
#topContainer, .dropzone {
    height: 50px;
    width: 300px;
    border: 2px solid black;
    text-align: center;
}
.folder .drag {
    margin: 5px;
}
.container {
    border: 2px solid blue;
    margin: 10px;
}
.over {
    background-color: yellow;
}    
#container {
    width: 800px;
    height: 600px;
    overflow-y: scroll;
    border-color: red;
    position: relative;
} 
```

**小提琴**：[jsFiddle](http://jsfiddle.net/Hw4nP/3/)

所以这个想法是......您将其中一个黑色块拖动到所需的文件夹（父目录 1、父目录 2、文件夹 1 等）。这一切似乎都很好。

当父级（#container）或主体溢出时，不能正常工作。如果您单击要拖动的块并尝试使用鼠标滚轮滚动，则不能……或者如果您继续尝试，有时可以。（我的屏幕分辨率并不明显，但在 Fiddle 代码中，#container 元素有一个滚动条）我假设这与我将助手附加到的焦点有关。

因为我开始考虑后者，所以我开始将助手附加到不同的位置。#container 是我最感兴趣的区域，我可以在此处附加帮助程序并使滚动正常工作（取消注释 //appendTo: '#container' 并注释掉 appendTo: 'body'）。

然而，这引入了另一个问题。现在我要附加到 #container 元素，当我的块被拖到**Parent Directory 1**文件夹时看不到它，这让我相信助手有问题。

果然，如果你不使用 user **helper: 'clone'**，你可以漂亮地滚动。这不是一个选择，因为我喜欢在那里有我的克隆。所以我转向你们。我该如何解决我的问题，到底发生了什么？有人有建议吗？我很想听听。

还需要注意的是，我已经尝试为可拖动设置 zIndex 和堆栈选项，但没有成功。我假设我必须制作一个自定义帮助函数，并让它知道它当前被拖过什么......但我希望有一个更简单的修复。

如果有人有任何见解，我很想听听。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-30T16:25:35.737

这是小提琴的代码：http: [//jsfiddle.net/crowjonah/Fr7u8/3/](http://jsfiddle.net/crowjonah/Fr7u8/3/)

**HTML：**

```
<table>
<tr class="drag_me">
    <td>drag me</td>
</tr>
<tr class="drag_me">
    <td>drag me</td>
</tr>
<tr class="drag_me">
    <td>drag me</td>
</tr>
<tr class="drag_me">
    <td>drag me</td>
</tr>
</table>

<div class="upper"></div>
<div class="drop_area">
<ul>
    <li class="drop_on_me">drop here</li>
    <li class="drop_on_me">drop here</li>
    <li class="drop_on_me">drop here</li>
    <li class="drop_on_me">drop here</li>
    <li class="drop_on_me">drop here</li>
    <li class="drop_on_me">drop here</li>
    <li class="drop_on_me">drop here</li>
    <li class="drop_on_me">drop here</li>
    <li class="drop_on_me">drop here</li>
    <li class="drop_on_me">drop here</li>
</ul>
</div>
<div class="lower"></div> 
```

**jQuery：**

```
$('.drag_me').draggable({
    helper: 'clone',
    scroll: 'true',
    refreshPositions: true
});

$('.drop_on_me').droppable({
    accept: '.drag_me',
    activeClass: 'active',
    hoverClass: 'hover',
    tolerance: 'pointer'
});
$('.upper').droppable({
            over: function(event, ui){
                $('.drop_area').autoscroll({
                    direction: 'up',
                    step: 150,
                    scroll: true
                });
            },
            out: function(event, ui){
                $('.drop_area').autoscroll('destroy');
            }
        });

        $('.lower').droppable({
            over: function(event, ui){
                $('.drop_area').autoscroll({
                    direction: 'down',
                    step: 150,
                    scroll: true
                });
            },
            out: function(event, ui){
                $('.drop_area').autoscroll('destroy');
            }
        }); 
```

与此问题相关：[jQuery UI：可拖动滚动问题](https://stackoverflow.com/questions/16020798/jquery-ui-draggable-scroll-issue)

它是容器内可拖动元素的工作示例`overflow: scroll`

# c# - “不支持查询”控制器错误

> ID：16020799
> 
> 赞同：2
> 
> 时间：2013-04-15T17:04:07.757
> 
> 标签：c#, asp.net-mvc-4, odata, asp.net-web-api

我正在处理此处找到的以下答案：[Web API OData Inlinecount not working](https://stackoverflow.com/questions/15422831/web-api-odata-inlinecount-not-working/15422935)

这是我的控制器，提供了一些虚拟数据。

```
[Queryable]
public class ValuesController : ApiController
{
    // GET api/values
    public PageResult<Category> Get(ODataQueryOptions<Category> queryOptions)
    {
        var returnValue = new List<Category>()
        {
            new Category() { Id = 1, Name= "Category 1"},
            new Category() { Id = 2, Name= "Category 2"},
            new Category() { Id = 3, Name= "Category 3"},
        };

        IQueryable results = queryOptions.ApplyTo(returnValue.AsQueryable());

        return new PageResult<Category>(results as IEnumerable<Category>,
            Request.GetNextPageLink(), Request.GetInlineCount());
    }
} 
```

当我尝试通过 Fiddler 进行获取时出现以下错误：

> “控制器‘值’上的操作‘获取’，返回类型为‘System.Web.Http.OData.PageResult`1[[ODataTest_Solution.DTO.Category，ODataTest 解决方案，版本=1.0.0.0，文化=中性，PublicKeyToken=null ]]' 不支持查询。确保返回内容的类型是 IEnumerable、IQueryable 或任一接口的通用形式。"

如果我将方法更改为返回 IQueryable，它显然可以正常工作。

知道我可能做错了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T17:49:36.693

我已经尝试过您的 ValuesController，它工作得很好。

您的问题很可能是您将`[Queryable]`属性添加到此操作。如果您使用 ODataQueryOptions，则不需要使用，`[Queryable]`因为您自己应用查询而不需要操作过滤器。

# ios - 切换视图时 AVMusic 播放双倍

> ID：16020800
> 
> 赞同：0
> 
> 时间：2013-04-15T17:04:15.447
> 
> 标签：ios, objective-c, avaudioplayer

当我切换视图时，音乐继续播放背景，我的应用程序很好。但是当用户返回到初始视图时，音乐会从原始视图重新开始，因此用户会听到双倍的音乐。我已经有一些代码来检查声音是否已经在播放，但它不起作用。:(

有什么想法吗？

```
 if (audioPlayer.playing == 0 ) {
    NSURL *url = [NSURL fileURLWithPath:[NSString stringWithFormat:@"%@/CheeZeeLab.mp3", [[NSBundle mainBundle] resourcePath]]];

    NSError *error;
    audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:&error];
    audioPlayer.numberOfLoops = 0;
    audioPlayer.volume = 1;
    [audioPlayer prepareToPlay];

    [audioPlayer stop];
    if (audioPlayer == nil)
        NSLog(@"werkt niet");
    else
        [audioPlayer play];    }
else{

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:18:44.137

我敢打赌，您的问题在于您如何转换回初始视图。

如果您正在推动（或从子级向父级进行转场......即循环转场），则您正在创建父级视图控制器的新实例。

创建一个新实例会启动一个新版本的音频播放器来播放该声音。

您需要正确弹出视图以返回上一个视图控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T17:23:20.090

取决于您如何设置 AVAudioPlayer，使用手动设置器和获取器，使用属性甚至在构造函数中。你面临一些问题。

当您初始化 ViewController 时，您正在分配一个 AVAudioPlayer，如果它继续播放，它不会被释放，并且仍然保留。并且在每个属性的保留计数为 0 之前，也不会释放 ViewController。

返回主视图并尝试再次设置相同的 ViewController 后，我猜您并没有尝试将相同的实例推送到堆栈中。而是创建一个新实例并将其推入堆栈？这也使得 AVAudioPlayer。

这是因为看不到整个代码，所以有点猜测。但如果是这种情况，我认为你可以设置得更好一些。确保 ViewController 被正确地释放并释放它的所有属性，然后再创建一个新实例以推送到堆栈。

# spring - 同时存储库和 DAO

> ID：16020803
> 
> 赞同：0
> 
> 时间：2013-04-15T17:04:30.187
> 
> 标签：spring, jpa, stack-overflow

我在我的spring项目中使用了DAO，一切都很好，然后我插入了一个需要spring-data-jpa（存储库）的jqgrid，现在当我尝试使用我的DAO时，我有一个java.lang.StackOverflowError；可能是依赖问题吗？

java.lang.StackOverflowError org.eclipse.persistence.logging.DefaultSessionLog.getLevel(DefaultSessionLog.java:88) org.eclipse.persistence.logging.DefaultSessionLog.shouldLog(DefaultSessionLog.java:108) org.eclipse.persistence.internal.sessions .AbstractSession.shouldLog(AbstractSession.java:4040) org.eclipse.persistence.internal.sessions.AbstractSession.log(AbstractSession.java:4085) org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.logDebugMessage(UnitOfWorkImpl.java:5527 ) org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.registerExistingObject(UnitOfWorkImpl.java:3884) org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.registerExistingObject(UnitOfWorkImpl.java:3854) org.eclipse.persistence.mappings.ObjectReferenceMapping .buildUnitofWorkCloneForPartObject(ObjectReferenceMapping.java:95) 组织。eclipse.persistence.mappings.ObjectReferenceMapping.buildCloneForPartObject(ObjectReferenceMapping.java:69) org.eclipse.persistence.internal.indirection.NoIndirectionPolicy.cloneAttribute(NoIndirectionPolicy.java:76) org.eclipse.persistence.mappings.ForeignReferenceMapping.buildClone(ForeignReferenceMapping. java:251) org.eclipse.persistence.internal.descriptors.ObjectBuilder.populateAttributesForClone(ObjectBuilder.java:3497) org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.populateAndRegisterObject(UnitOfWorkImpl.java:3650) ....buildClone(ForeignReferenceMapping.java:251) org.eclipse.persistence.internal.descriptors.ObjectBuilder.populateAttributesForClone(ObjectBuilder.java:3497) org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.populateAndRegisterObject(UnitOfWorkImpl.java:3650) .. ..buildClone(ForeignReferenceMapping.java:251) org.eclipse.persistence.internal.descriptors.ObjectBuilder.populateAttributesForClone(ObjectBuilder.java:3497) org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.populateAndRegisterObject(UnitOfWorkImpl.java:3650) .. ..

# bash - BASH/AWK 如何在给定的文本文件中将所有日期 dd.mm.yyyy 日期替换为 dd 月 yy

> ID：16020806
> 
> 赞同：0
> 
> 时间：2013-04-15T17:04:34.900
> 
> 标签：bash, awk

如主题如何在给定的文本文件中使用 bash/awk 仅将文件中的日期以日期 dd.mm.yyyy 格式替换为日期格式 dd 月 yyyy 月份（如 02 至 2 月等）

输入文件：

```
kandal w Rosji. "Polacy są niezbyt kreatywni 12.12.2032
43.12.4521 Dramatyczne wyznanie córki gen. Jaruzelskiego
Politycy chcą,
23/32/3211 by Tusk przeprosił Benedykta XVI
Nie żyje wybitny historyk prof. Andrzej Garlicki
Polityk PiS: Śląsk należy przywrócić Polsce 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:17:56.047

您可以像这样使用 gnu awk 的 (gawk) 时间功能：

```
echo "18.11.2012" | awk -F"." '{t=mktime($3 " " $2 " " $1 " 00 00 00");
     print strftime("%d %B %Y", t)}' 
```

### 现场演示：http: [//ideone.com/Jmz77N](http://ideone.com/Jmz77N)

根据需要使用 FS 而不是 -F ：

```
awk 'BEGIN {FS="."} {t=mktime($3 " " $2 " " $1 " 00 00 00"); 
     print strftime("%d %B %Y", t)}' 
```

### 更新：（使用您的输入文件的脚本）

```
awk '{
  for(i=1; i<=NF; i++) {
     if ($i ~ /[0-9][0-9]\.[0-9][0-9]\.[1-9][0-9][0-9][0-9]/) {
        split($i, a, ".");
        t=mktime(a[3] " " a[2] " " a[1] " 00 00 00");
        if (t == -1)
           printf("%s", $i);
        else
           printf("%s", strftime("%d %B %Y", t));
     }
     else
        printf("%s", $i);
    if (i<NF)
       printf(" ");        
   } 
   printf("\n");
}' inputFile 
```

### 新演示：http: [//ideone.com/PoMsU3](http://ideone.com/PoMsU3)

# visual-studio-2010 - 如何从 citrix 访问平台以管理员身份启动 Visual Studio

> ID：16020811
> 
> 赞同：-1
> 
> 时间：2013-04-15T17:04:57.197
> 
> 标签：visual-studio-2010, citrix

我需要从 citrix 访问平台以管理员模式启动我的 VS 2010。在这里我无法访问 VS2010 快捷方式的属性。

谢谢，萨拉瓦南。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:06:55.397

右键单击要启动它的图标，然后单击“以管理员身份运行”。

如果该选项未出现，可能是您的 Citrix 管理员禁用了它？

# asp.net-mvc-3 - ASP.net MVC 3 中的帮助程序和操作链接

> ID：16020817
> 
> 赞同：1
> 
> 时间：2013-04-15T17:05:40.663
> 
> 标签：asp.net-mvc-3, razor, actionlink

因此，我创建的助手遇到了一个奇怪的问题：

```
@if (Model != null)
{
    <ul>
    @foreach (var item in Model)
    {
        <li>
           @Html.ActionLink(item.name, "Map", "Home", new { id = item.id }, null)
        </li>
    }
    </ul>
}
else
{
    <p><strong>ATTN!!</strong> We could not find any locations.</p>
} 
```

当渲染到视图中时，运行时抛出以下错误：

> CS1973：“System.Web.Mvc.HtmlHelper”没有名为“ActionLink”的适用方法，但似乎具有该名称的扩展方法。扩展方法不能动态调度。考虑强制转换动态参数或在没有扩展方法语法的情况下调用扩展方法。

这发生在我的操作链接上。

我已经看到其他部分使用动作链接，一些在动作链接周围使用 [] 其他没有。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T13:43:26.293

您必须转换`item.name`为字符串，顺便说一下，如果您不使用`htmlAttributes`参数，请保留它而不是放置`null`更清晰的代码

# asp.net-mvc - 为什么 GetResponseStream 不对来自 MVC Razor View 的数据 GET 的服务器响应执行 Cookie？

> ID：16020818
> 
> 赞同：0
> 
> 时间：2013-04-15T17:05:42.560
> 
> 标签：asp.net-mvc, razor

我在 IIS 上有一个 .net 网站，它有一个指向 MVC 应用程序的虚拟目录。我正在尝试在 RAzor 视图标题上重用 sitemaster.master。

我在 Razor 视图 _hearder_it.cshtml 上有以下代码。

我在 test.aspx 页面上做一个 StreamReader，它只有一个 sitemaster.master。req.GetResponse 确实从站点管理员（菜单栏等）返回流。但是 sitemaster.master 有 Request.Cookies 并且 cookie 从来没有值。我知道它们应该有价值，因为我已经在 mvc 应用程序之外进行了测试。cookie 改变了站点管理员的视图，这就是我需要它的原因。

//这段代码确实返回了流。

```
WebRequest req = HttpWebRequest.Create(url );
req.Method = "GET";

string source;
using (StreamReader reader = new StreamReader(req.GetResponse().GetResponseStream()))

source = reader.ReadToEnd();

Response.Write(source);  // I get HTML result back from my sitemaster.master. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:09:33.387

Cookie 在请求标头中发送，而您不会在此处将任何 cookie 添加到您的网络请求中。[这是一个可能对你有帮助的帖子](https://stackoverflow.com/questions/4158448/c-sharp-webrequest-using-cookies)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T11:46:38.527

我在 CookieContainer 中添加了 cookie。此代码运行成功。
此代码位于 Razor 视图 _header_it.cshtml 中：

```
 @{
       string userTyp3 = Request.Cookies["MY_USERTYPE"] != null ? Server.UrlDecode(Request.Cookies["MY_USERTYPE"].Value) : "";

        CookieCollection _CookieCollection2  = new CookieCollection();

        HttpWebRequest _request2 = (HttpWebRequest)WebRequest.Create("http://MySite_TEST/it/test.aspx");
        _request2.Method = "GET";
        _request2.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
        _request2.UserAgent = "Mozilla/5.0 (Windows; U; Windows NT 5.1; de; rv:1.9.2) Gecko/20100115 Firefox/3.6 (.NET CLR 3.5.30729)";
        _request2.Referer = "http://MySite_TEST/it";
        _request2.KeepAlive = true;

        //Here is auth cookie, works fine
        _request2.CookieContainer = _cookieContainer;
        _request2.CookieContainer.Add(( new Cookie ( "MY_USERTYPE", userTyp3 , "/", "MySite_TEST") )) ;
        _request2.Headers.Add(HttpRequestHeader.CacheControl, "no-cache=set-cookie");

        HttpWebResponse _response2 = (HttpWebResponse)_request2.GetResponse();
        StreamReader _reader2 = new StreamReader(_response2.GetResponseStream());
        Response.Write(_reader2.ReadToEnd());  // 

        _response2.Close();
        _reader2.Close(); 
```

}

我在此 URL 上使用了示例：

```
 http://stackoverflow.com/questions/2476092/login-website-curious-cookie-problem?rq=1] 
```

谢谢

# ios - 更改方向时如何更改 UIToolbar 中项目的宽度？

> ID：16020819
> 
> 赞同：0
> 
> 时间：2013-04-15T17:05:50.830
> 
> 标签：ios, ipad, uitoolbar

使用 xCode 4.6，我的视图顶部有一个工具栏，其中包含 2 个按钮，然后是一个文本字段，然后是另外两个按钮。

我已将按钮设置为相同大小，并且可以拖动文本字段的宽度，以便使用工具栏的整个宽度。

这在纵向看起来不错，但对于横向，我在最后一个项目之后得到了很多空白。

如何将文本字段设置为“宽度 100%”，以便它可以扩展以填满工具栏？或者当屏幕旋转时，我怎么能改变项目的宽度？

我是 xCode 的新手！所以我的大部分工作都不是以编程方式编写的。我使用的许多有用的教程都引用了不同版本的 xCode，因此可能很难遵循。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:43:39.813

您需要使用此方法设置横向图像：

```
UIBarButtonItem *barButtonItem = [[UIBarButtonItem alloc] initWithImage: landscapeImagePhone: style: target: action:] 
```

那，或者正如另一位用户所说，您可以使用（对旧设备不友好）自动布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:02:12.477

看起来您不能在工具栏上设置水平间距约束。最好的方法可能是在加载时检查方向并相应地设置宽度。当方向改变时，您还需要设置它。该代码应该放在 willAnimateRotationToInferfaceOrientation 中。

# cocos3d - Cocos3d：在单独的线程或后台线程中加载场景时崩溃：

> ID：16020821
> 
> 赞同：0
> 
> 时间：2013-04-15T17:05:56.000
> 
> 标签：cocos3d

我正在尝试在代码中加载几个大模型并显示场景。通常，加载和在屏幕上显示场景需要很长时间，因为它需要从 pod 模型中提取大量资源。所以，我想在主线程中填充第一个场景，并将其他场景留在单独的线程中。但是，当我将部分代码移动到单独的线程中时，它会崩溃。这是我的示例代码：

```
 -(void) loadFirstScene
{
CC3PODResourceNode* podRezNode = [CC3PODResourceNode nodeWithName: @"FirstModel"];
podRezNode.resource = [IntroducingPODResource resourceFromFile: @"FirstModel.pod"];
podRezNode.shouldCullBackFaces = NO;
podRezNode.location = cc3v(0.0, -10.0, 0.2);
podRezNode.isTouchEnabled = YES;
[self addChild: podRezNode];

[NSThread detachNewThreadSelector:@selector(loadScenesInThread) toTarget:self
withObject:nil];
}

// Crashing if i add the below function in separate thread or background thread
-(void) loadScenesInThread
{
CC3PODResourceNode* podRezNode = [CC3PODResourceNode nodeWithName: @"SecondModel"];
podRezNode.resource = [IntroducingPODResource resourceFromFile: @"SecondModel.pod"];

podRezNode.shouldCullBackFaces = NO;
podRezNode.location = cc3v(0.0, -10.0, -5.0);
podRezNode.isTouchEnabled = YES;
[self addChild: podRezNode];

podRezNode = [CC3PODResourceNode nodeWithName: @"ThirdModel"];
podRezNode.resource = [IntroducingPODResource resourceFromFile: @"ThirdModel.pod"];

podRezNode.shouldCullBackFaces = NO;
podRezNode.location = cc3v(0.0, -10.0, -5.0);
podRezNode.isTouchEnabled = YES;
[self addChild: podRezNode];

// .. do more
} 
```

有人可以指导我如何处理这种情况吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T18:35:01.563

您不能在与创建 OpenGL 上下文的线程不同的线程中创建或访问 OpenGL 资源。您唯一的选择是使用 cocos2d 提供的任何“异步”方法，或者加载纹理的示例。

# azure - ACS90027：多个主体使用 Active Directory 中的 OAuth 匹配“ccf87be2-5370-4232-8453-0cadd770e3fe”标识符

> ID：16020822
> 
> 赞同：1
> 
> 时间：2013-04-15T17:05:56.247
> 
> 标签：azure, azure-acs

我正在尝试使用 Azure AD 作为 OAuth 授权提供程序。我创建了一个 asp.net Web 应用程序，仅用于测试，并在 azure AD 中注册了一个应用程序。

从我创建了一个到授权端点的 Web 请求的网站，请求发送正常，并且我被要求提供凭据。填写我的用户名和密码后，我总是收到此错误：

> 处理您的请求时发生错误。
> 
> HTTP 错误代码：
> 
> 400
> 
> 信息：
> 
> ACS50000：发出令牌时出错。
> 
> 内心讯息：
> 
> ACS90027：多个主体匹配“ccf87be2-5370-4232-8453-0cadd770e3fe”标识符。
> 
> 跟踪 ID：
> 
> 0a79ca43-41c8-4e91-95ee-acb25cfd6053
> 
> 相关标识：
> 
> e1396b28-868f-4e60-9a7d-9822f3b9d753

我认为我的请求没问题，但我不知道发生了什么，我确定只有一个应用程序注册了该标识符。这是我的要求（我使用 get 进行测试）：

> https://login.windows.net/[subscriptionid]/oauth2/authorize?resource=http://localhost&client_id=ccf87be2-5370-4232-8453-0cadd770e3fe&state=Windows%20Azure%20Active%20Directory&response_type=code&scope=http://本地主机

**更新**

我下载了 cmdlet，使用 Get-MsolServicePrincipal 这是我看到的，没有重复的主体：

ExtensionData：System.Runtime.Serialization.ExtensionDataObject AccountEnabled：True 地址：{} AppPrincipalId：00000002-0000-0000-c000-000000000000 DisplayName：Microsoft.Azure.ActiveDirectory ObjectId：951bd0e5-23af-48e9-bda3-31ccce6a1a45 ServicePrincipalNames：{ [} //graph.windows.net](https://graph.windows.net) , 00000002-0000-0000-c000-000000000000, Microsoft.Azure.ActiveDirectory, 00000002-0000-0000-c00 0-000000000000/graph.windows.net...} TrustedForDelegation : False

ExtensionData：System.Runtime.Serialization.ExtensionDataObject AccountEnabled：False 地址：{} AppPrincipalId：00000010-0000-0000-c000-000000000000 DisplayName：Microsoft.Azure.GraphStore ObjectId：6b8ec6ad-5bc9-4256-b301-84825d707c5401 ServicePrincipalNames： 0000-0000-c000-000000000000，Microsoft.Azure.GraphStore，00000010-0000-0000-c000-000 000000000/graphstore.windows.net} TrustedForDelegation：真

ExtensionData：System.Runtime.Serialization.ExtensionDataObject AccountEnabled：True 地址：{} AppPrincipalId：0000000c-0000-0000-c000-000000000000 DisplayName：Microsoft.Azure.ActiveDirectoryUX ObjectId：feb2afcf-e82c-4d30-b0b8-7bd875c4bd94 ServicePrincipalNames：{0000000c 0000-0000-c000-000000000000，Microsoft.Azure.ActiveDirectoryUX，0000000c-0000-0000-c 000-000000000000/activedirectory.windowsazure.com} TrustedForDelegation：真

ExtensionData：System.Runtime.Serialization.ExtensionDataObject AccountEnabled：True 地址：{} AppPrincipalId：0000000f-0000-0000-c000-000000000000 DisplayName：Microsoft.Azure.GraphExplorer ObjectId：4eda2f9f-6f3c-4497-ae0c-8284fd50000000fPrincipalNames：{0000000000fPrincipalNames： 0000-0000-c000-000000000000，Microsoft.Azure.GraphExplorer，0000000f-0000-0000-c000-000000000000/graphexplorer.windows.net} TrustedForDelegation：真

ExtensionData：System.Runtime.Serialization.ExtensionDataObject AccountEnabled：False 地址：{} AppPrincipalId：00000013-0000-0000-c000-000000000000 DisplayName：Microsoft.Azure.Portal ObjectId：7a5289bf-60c9-4e08-aba0-cc5a9221b00001 ServicePrincipal3Names：{000000001 0000-0000-c000-000000000000，Microsoft.Azure.Portal，00000013-0000-0000-c000-0000000 00000/manage.windowsazure.net} TrustedForDelegation：真

ExtensionData：System.Runtime.Serialization.ExtensionDataObject AccountEnabled：True 地址：{Microsoft.Online.Administration.RedirectUri} AppPrincipalId：ccf87be2-5370-4232-8453-0cadd770e3fe DisplayName：Api ObjectId：570c934e-4215-4f09-a907-3bd35539080d ServicePrincipalNames：ServicePrincipalNames { [http://api.dnndev.me/](http://api.dnndev.me/) , ccf87be2-5370-4232-8453-0cadd770e3fe} TrustedForDelegation : False

ExtensionData：System.Runtime.Serialization.ExtensionDataObject AccountEnabled：True 地址：{Microsoft.Online.Administration.RedirectUri} AppPrincipalId：a51f0618-a534-4f95-955e-d1ed7802bc69 DisplayName：pruebas ObjectId：d5d4c74e-0212-49de-9bc2-928b63005 ServicePrincipalName { [http://pruebas.dnndev.me](http://pruebas.dnndev.me) , a51f0618-a534-4f95-955e-d1ed7802bc69}

谢谢！

# sql - 使用 CONCAT LIKE AND 进行 SQL 查询

> ID：16020827
> 
> 赞同：4
> 
> 时间：2013-04-15T17:06:10.987
> 
> 标签：sql, concat, sql-like

我有一个这样的查询：

```
SELECT * FROM `tbl_shop` 
WHERE
  (LOWER (CONCAT(address, name)) LIKE (LOWER ('%boston%')) AND
   LOWER (CONCAT(address, name)) LIKE (LOWER('%smoke%'))); 
```

我的问题很简单 - 有什么方法可以编写此代码而无需重复 CONCAT(address, name) 部分？

我试过

```
SELECT * FROM `tbl_shop`
WHERE 
  (LOWER (CONCAT(address, name)) LIKE (LOWER ('%boston%')) AND (LOWER('%smoke%'))); 
```

但这并没有给出任何结果。我只需要包含两个单词的所有结果。我不能使用全文，因为我正在使用 inno db 并想保留它。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T17:15:13.830

你可以做

```
SELECT b.* FROM
(
   SELECT a.*, LOWER(CONCAT(a.address, a.name)) AS field_to_check
)b 
WHERE b.field_to_check LIKE (LOWER ('%boston%')) 
 AND  b.field_to_check LIKE (LOWER('%smoke%')); 
```

但是，它只是语法糖，它不应该是性能上的差异。

# mysql - MySQL 权限，允许/禁止

> ID：16020839
> 
> 赞同：2
> 
> 时间：2013-04-15T17:06:52.677
> 
> 标签：mysql, database, privileges

我一直在使用 MySQL 数据库中的用户权限，但仍然无法获得想要的结果。

昨天，我授予权限，然后撤销，用户仍然拥有它。（相同的浏览器，仅注销）。重新启动浏览器后，它确实按预期工作。

今天，我设置了权限

```
GRANT CREATE ON `testdb`.`testtbl` TO 'ttt'@'localhost' IDENTIFIED BY 'test' 
```

我没有看到只有“testdb”，但我也看到了表“test”——我不应该看到。当我去数据库“testdb”时，我无法创建表。它说

> 用户 'ttt'@'localhost' 拒绝表 'ttbl' 的 CREATE 命令

SQL 命令：

```
CREATE TABLE `ttbl` (
  `test1` int NOT NULL,
  `test2` int NOT NULL
) COMMENT=''; 
```

我想我错过了一些特权，但我仍然无法弄清楚出了什么问题。

仅使用此命令时会出现什么问题？（不是 CREATE USER，不确定是否是强制性的）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:08:44.933

在 MySQL 中，更改权限后，**始终**运行以下命令：

```
flush privileges; 
```

它强制 MySQL 运行时主动重新加载权限表，从而清除所有其他过时的权限。它不会自动执行此操作，因为它必须主动检测对授权表的更改。

# ruby-on-rails - Rails 不会加载资产管道

> ID：16020842
> 
> 赞同：7
> 
> 时间：2013-04-15T17:07:06.983
> 
> 标签：ruby-on-rails, asset-pipeline, assets

我在开发时误跑`rake assets:precompile`了，Rails 在开发时停止加载资产。我只得到`application.js`并`application.css`加载。

应用程序.js：

```
//= require jquery
//= require jquery_ujs
//= require_tree . 
```

应用程序.css：

```
*= require_self
*= require_tree . 
```

使用 Rails 3.2.2

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T16:20:55.443

尝试从本地开发环境中删除已编译的资产：

`rm -rf public/assets`

**编辑：**

`config.assets.compress = false`此外，请确保`config.assets.debug = true`在您的`development.rb`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T07:43:34.507

tl;博士

1.  `$ rake assets:clean`
2.  重启 Rails 服务器`$ rails server -e development`
3.  清除浏览器缓存，或`ctrl+shift+r`在应用页面上执行

现在一切都应该和你跑之前一样`rake assets:precompile`

-- 结束 tl;博士 --

如果上述方法不起作用，那么详细的步骤列表：

1.  执行`$ rake assets:clean`或`$ rm -rf public/assets`删除生成的资产。
2.  在 application.rb 中，确保：
    *   `config.assets.enabled = true`（启用 Rails 的资产管道）
3.  在 development.rb 中，确保：
    *   `config.assets.compress = false`（以免压缩资产）
    *   `config.assets.debug = true`（以免将所有 css 和 js 文件合并到应用程序中。[cs|js]）
    *   `config.assets.compile = true`（或未设置 - 启用资产的运行时编译）
    *   `config.serve_static_assets = false` （或未设置）
4.  最后，重启你的 Rails 服务器`$ rails server -e development`

这应该解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T21:20:54.047

打开`config/application.rb`并设置以下内容：

`config.assets.enabled = true`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T16:20:47.173

运行会`rake assets:precompile`生成静态资源，在这些资源下`public/assets`，Rails 会直接为这些资源提供服务。为了防止这种情况，您可以：

1.  手动删除这些文件或
2.  跑`rake assets:clean`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-19T21:31:19.917

如果清理您的资产目录并确保您的配置正确，如前面的答案所示不起作用 - 您是否有可能使用页面缓存？

如果生成的页面带有`src`指向已编译文件的标签，则现在需要重新生成它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-05T11:47:24.440

万一这对任何人都有帮助-我遇到了一个问题，即在开发中都没有加载 application.js/.css （查看源代码时我仍然可以看到清单行）。

由于某种原因，我正在运行一个旧的 rails 3.2.2 应用程序，我不得不进入并在清单文件（application.js 和 application.css）中添加空白行并保存它们 - 然后资产开始正常工作。

我删除了空白行，它仍然有效，所以我假设它可能只是需要在文件上更新修改的日期戳。

# ruby-on-rails - Rails 3.2.13 识别路径返回约束的路由错误

> ID：16020843
> 
> 赞同：3
> 
> 时间：2013-04-15T17:07:10.477
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我的路线中有两条路径，相同的路径指向不同的控制器和动作

```
match '/:id' => 'users#show', :as => 'user', :constraints => UserConstraint
match '/:id' => 'customers#show', :as => 'customer' 
```

我的约束类有以下匹配项？方法

```
def self.matches?(request)
    return User.exists?(request.path_parameters[:id])
 end 
```

当我在浏览器中调用网址时，这很好用。但是，这不适用于识别路径方法。

```
Rails.application.routes.recognize_path("/trump", {:method => :get}) 
```

返回一个路由错误（没有路由匹配），而在浏览器中调用时工作，因为它被适当地路由。

存在 :id => trump 的用户。

我如何获得recognize_path 方法来返回路径详细信息？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-22T17:44:31.830

显然，这是 Rails 中的一个错误，请参阅：

[https://github.com/rails/rails/issues/8679](https://github.com/rails/rails/issues/8679)

# jboss7.x - 调用的无状态 EJB 永远不会改变

> ID：16020854
> 
> 赞同：0
> 
> 时间：2013-04-15T17:07:58.720
> 
> 标签：jboss7.x, java-ee-6, ejb-3.1

我正在编写关于 JBOSS AS 7 的 EJB 课程，但遇到了一些麻烦。我有一个简单的本地无状态 EJB：

```
@Stateless
public class CitationEJB {

    String citation ="Hello Citation";

    public String getCitation(){
        System.out.println("getting citation from :"+this.toString());
        return this.citation;
    }

    public void setCitation(String citation) {
        System.out.println("changing citation to : "+citation);
        this.citation = citation;
    }

    @PostConstruct
    public void sayHello(){
        System.out.println("Hello, I'm a new EJB");
    }
} 
```

然后我在 JSF ManagedBean 中通过 JNDI 调用 EJB：

```
@ManagedBean
@SessionScoped
public class CitationBean {

    //@EJB trying this time with JNDI
    CitationEJB ejb;

    public String getCitation() throws NamingException{
        ejb = lookupCitationEJB();
        return ejb.getCitation();
    }

    public String getCitation2() throws NamingException{
        ejb.setCitation("hello Toto");
        CitationEJB ejb = lookupCitationEJB();
        return ejb.getCitation();
    }

    private static CitationEJB lookupCitationEJB() throws NamingException {
        Hashtable jndiProperties = new Hashtable();
        jndiProperties.put(Context.URL_PKG_PREFIXES, "org.jboss.ejb.client.naming");
        Context context = new InitialContext(jndiProperties);
        String jndiName = "java:global/CitationsDyn/CitationEJB!com.citations.ejb.CitationEJB";
        //jndiName = "java:app/CitationsDyn/CitationEJB";  // Works also
        return (CitationEJB) context.lookup(jndiName);
    }
} 
```

然后我用 JSF 显示 CitationEJB.getCitation()。一切正常，除了当我发出 F5 和一个新请求时，我总是有相同的对象：当我使用 CitationEJB.setCitation("Hello toto")，然后是 F5 时，我确实有 "Hello Toto" 而不是品牌新对象。

当我使用 @EJB 注释来获取 EJB 时，我对每个请求都有一个新对象的预期行为。

所以我学到的是 EJB 是在池中挑选的，但它什么时候被销毁？我猜想 JNDI 查找不像 JSF 页面那样绑定到范围。但它是如何准确指定的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T06:24:22.700

无状态会话 Bean 的生命周期由容器管理。部署 EJB 时，将创建多个实例并将其放置在实例池中（例如，JBoss 6 默认创建 10 个实例）。该数字可以根据需求放大或缩小。EJB 通常不会在使用后销毁，而是放回池中以反复使用。

对于您想要保持状态的应用程序，Stateful Session Bean 将是正确的选择（或者如果您想在实例之间共享状态，则为 Single Session Bean）。使用有状态会话 Bean，应用程序可以通过使用 @Remove 注释方法来破坏 EJB。

# python - 使用 Python 进行内联 CSV 文件编辑

> ID：16020858
> 
> 赞同：24
> 
> 时间：2013-04-15T17:08:16.103
> 
> 标签：python, csv, file-io

我可以使用 Python 的 CSV 库或类似技术修改 CSV 文件吗？

当前我正在处理一个文件并更新第一列（名称字段）以更改格式。我的代码的简化版本如下所示：

```
with open('tmpEmployeeDatabase-out.csv', 'w') as csvOutput:
    writer = csv.writer(csvOutput, delimiter=',', quotechar='"')

    with open('tmpEmployeeDatabase.csv', 'r') as csvFile:
        reader = csv.reader(csvFile, delimiter=',', quotechar='"')

        for row in reader:
            row[0] = row[0].title()
            writer.writerow(row) 
```

哲学是有效的，但我很好奇我是否可以进行内联编辑，这样我就不会复制文件。

我已经尝试过以下操作，但这会将新记录附加到文件的末尾，而不是替换它们。

```
with open('tmpEmployeeDatabase.csv', 'r+') as csvFile:
    reader = csv.reader(csvFile, delimiter=',', quotechar='"')
    writer = csv.writer(csvFile, delimiter=',', quotechar='"')

    for row in reader:
        row[1] = row[1].title()
        writer.writerow(row) 
```

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-04-15T17:12:12.727

不，您不应尝试写入当前正在读取的文件。如果您在读取一行后继续返回，则*可以这样做，但这是不可取的，尤其是当您写回的数据多于读取的数据时。*`seek`

规范的方法是写入一个*新的临时*文件，并将其移动到您从中读取的旧文件上。

```
from tempfile import NamedTemporaryFile
import shutil
import csv

filename = 'tmpEmployeeDatabase.csv'
tempfile = NamedTemporaryFile('w+t', newline='', delete=False)

with open(filename, 'r', newline='') as csvFile, tempfile:
    reader = csv.reader(csvFile, delimiter=',', quotechar='"')
    writer = csv.writer(tempfile, delimiter=',', quotechar='"')

    for row in reader:
        row[1] = row[1].title()
        writer.writerow(row)

shutil.move(tempfile.name, filename) 
```

我在这里使用了[`tempfile`](http://docs.python.org/library/tempfile.html)和[`shutil`](http://docs.python.org/library/shutil.html)库来简化任务。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-15T17:24:18.543

没有用于*将*数据插入文件的底层系统调用。你可以覆盖，你可以追加，你可以替换。但是将数据插入中间意味着从您进行编辑的点到最后读取和重写*整个文件。*

因此，执行此操作的两种方法是 (a) 将整个文件放入内存，在那里进行编辑，然后将结果转储回磁盘，或者 (b) 打开一个临时输出文件，在其中写入结果当您读取输入文件时，然后在结束时将旧文件替换为新文件。一种方法使用更多内存，另一种方法使用更多磁盘空间。

# c++ - Eclipse CDT - 预编译头文件

> ID：16020869
> 
> 赞同：4
> 
> 时间：2013-04-15T17:08:51.670
> 
> 标签：c++, eclipse, eclipse-cdt, precompiled-headers

我正在寻找一种直接的方式来使用 Eclipse / CDT 的 C++ 项目的预编译头文件。从命令行运行时这些东西确实有效，但我正在寻找一种将其集成到 Eclipse 中的简单方法。

有什么建议么 ？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-12-30T08:01:26.607

只是为了帮助可能偶然发现这一点的其他人（因为我花了一些时间来解决这个问题）

首先要做的是使用 pch.cpp 和 pch.h 文件创建一个 PCH 文件夹（如果需要）。

pch.cpp：（这个文件是用来编译.gch的）

```
#include "pch.h" 
```

pch.h：

```
#include <iostream>
#include <string>
// more stuff that's not changing anytime soon... 
```

* * *

第二件事是创建 PCH 构建配置。

从此构建中排除所有项目源文件。（我们只需要编译pch.cpp）
选择文件/文件夹>右键单击>资源配置>从构建中排除> PCH

现在我们需要将其编译为 .gch（预编译头文件）
pch.cpp > 右键单击​​ > 属性 > C/C++ 构建 > 设置 > 工具设置
编译器 > 模式：（`${COMMAND} ${FLAGS} ${INPUTS}`删除所有输出内容）
杂项 > 标志：`-c -x c++-header -o "../src/PCH/pch.h.gch"`

现在，当您使用此配置进行构建时，它将在 pch.h 所在的位置生成 pch.h.gch。
（它也会给出一个无意义的错误，试图创建一个 exe。忽略它）

* * *

回到正常的 Release 版本，排除 pch.cpp 因为你不需要编译它。

现在是时候测试 .gch 是否在 .h 上使用了

在 pch.h 的顶部放置`#error "not using precompiled header file"`

只有在编译文件中首先包含标头时才使用 .ghc。

> “在特定编译中只能使用一个预编译头文件。”

您应该预编译最适合不同编译单元的不同头文件选择

* * *

**编译测试**

没有预编译头文件
`took 34s.189ms output src=2,143,078 bytes exe=1,346,864 bytes`

使用 -include ../src/PCH/pch.h （包含在每个编译单元中）（只有 pch.h 而不是 .gch）
`took 48s.364ms output src=2,159,431 bytes exe=1,355,298 bytes`
（这就是为什么我们在需要的地方手动#include 所以编译仍然需要大约 34 秒没有.gch）

使用 -include ../src/PCH/pch.h 和 pch.h.gch （快速编译，但使用 -include 仍然效率低下）
`took 22s.535ms output src=2,159,431 bytes exe=1,355,298 bytes`

如果 pch 的组织/使用正确（正确选择要包含它们的头文件和文件）（不是在每个文件中都使用），它应该比 22 秒快得多。（这个测试只是在一个没有考虑到 pch 的项目上完成的）

* * *

额外的加速可以使编译时间增加三倍
Project > Properties > C/C++ Build > Behavior > Enable parallel build

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-01T08:06:14.387

据我所知，目前 Eclipse CDT 不直接支持预编译头文件。我的意思是，你不能设置这样的选项：“对于这个头文件，编译它”。这同样适用于 Eclipse 项目的外部库的标头。

如您所知，您需要为标头编译设置相同的编译器标志，以使编译器将其用于其他编译单元。（至少在 GCC 的情况下）。

所以，你有几个解决方案：

*   您将在“Properties for -> C/C++ Build -> Builder Settings -> Build command”中找到的默认构建命令替换为自定义脚本，该脚本将修改 eclipse 生成的 makefile，然后调用 make。[这里](http://jdleesmiller.blogspot.fr/2009/10/amazing-ruby-precompiled-header-hack.html)提出了一个红宝石解决方案。请注意，它不允许使用多个预编译头文件。
*   您可以使用[ccache](http://ccache.samba.org/)而不是使用 GCC。它检测何时再次完成相同的编译，因此它与使用预编译头文件有点不同。

**编辑 ：**

要使 ruby​​ 脚本正常工作，您需要在与头文件相同的目录中至少有一个 .cpp 文件。否则，您将在丢失文件“subdir.mk”时收到错误消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-08T14:01:28.307

另一种方法是创建一个源文件（例如 pch.cpp），更改构建设置以创建预编译头文件。它应该包含在构建中以创建预编译头文件，然后将其排除以构建最终的可执行文件。如果头文件发生变化，需要临时重新包含。

[该网站](http://www2.warwick.ac.uk/fac/sci/systemsbiology/staff/dyer/software/pchineclipse/)提供了更多详细信息，包括为每个构建配置创建不同的预编译头文件的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-13T09:48:38.900

考虑使用[cmake](https://cmake.org/Wiki/Eclipse_CDT4_Generator)和[cotire](https://github.com/sakra/cotire)

# android - 保持数据库更新 - Android

> ID：16020872
> 
> 赞同：0
> 
> 时间：2013-04-15T17:09:05.123
> 
> 标签：android, sql

在您的帮助下，我成功创建了一个拥有自己的 MySQL 数据库的网页，然后使用 JSON Web 服务将值传递给我的 Android 应用程序。

下一阶段是将它们复制到本地 SQLite DB 中，这样手机就不需要互联网连接来查看列表。

我已经成功实现了创建表并将值插入该表的代码。问题是，我不希望它一次重写整个数据库，这是保持它最新的当前想法。

我可能删除了数据库中的内容或添加了更多内容，并希望本地数据库反映这一点。

我可以采取哪些步骤来删除 SQLite 中 MySQL DB 中不再存在的内容，并添加新内容？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:12:51.113

最好的方法是在你的数据库中有一个日期时间列，然后只获取比你上次从数据库中获取更新的帖子，在你的 android 应用程序中，你可以在你的偏好中保存一个日期时间

很抱歉，我错过了您也想删除项目，这可能不是最好的方法。您是否仅将 mySQL 用于 API？然后，您可能可以将帖子标记为已删除，插入奇怪的感觉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T17:36:35.187

您可以考虑这种方法，将您的 JSON 响应解析为数据模型的对象，然后创建包含该数据模型的内容值以与设备中的数据库一起使用。

获得内容值后，使用内容解析器处理数据库并尝试更新从 JSON 响应解析的每个数据（每个内容值），内容解析器的更新方法将返回一个整数值，告诉我们数字数据库中更新的行数，如果该数字为 0，则表示数据库中没有数据，因此只需进行插入即可。

这样，您首先搜索当前数据是否存在于数据库中，如果存在，则更新它，如果不存在，则插入它。

# android - 在android中有效地在viewpager中点击按钮播放音频

> ID：16020873
> 
> 赞同：0
> 
> 时间：2013-04-15T17:09:08.167
> 
> 标签：android, audio, android-viewpager

在我的应用程序中，我使用 viewpager 显示了大约 30 个动物图像。每个页面都有全屏图像和播放声音按钮。单击按钮将播放显示的动物声音。所以 raw 文件夹中有 30 个不同的声音文件。用户按下按钮时如何有效地播放音频？使用什么媒体播放器或声音池？以及如何有效地使用它？请给我解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:43:08.243

将歌曲文件保存在 raw 文件夹中，然后在按钮的 onClick 方法上执行歌曲播放。您可以将开关盒用于不同 ID 的按钮。

# elmah - Nancy MVC 框架的 Elmah 过滤器

> ID：16020874
> 
> 赞同：2
> 
> 时间：2013-04-15T17:09:11.210
> 
> 标签：elmah, nancy

我正在使用 Nancy MVC 和 Nancy.Elmah。目前，Nancy 中存在一个错误，该错误会为接受标头为“*”的请求引发异常。这是 Elmah 日志：

```
 System.ArgumentException
  inputString not in correct Type/SubType format Parameter name: *

  System.ArgumentException: inputString not in correct Type/SubType format
  Parameter name: *
     at Nancy.Responses.Negotiation.MediaRange.FromString(String contentType)
     at Nancy.Routing.DefaultRouteInvoker.<>c__DisplayClass5a.<>c__DisplayClass5c.<GetCompatibleHeaders>b__4f(MediaRange mr)
     at System.Linq.Enumerable.WhereSelectListIterator`2.MoveNext()
     at System.Linq.Enumerable.<SelectManyIterator>d__14`2.MoveNext()
     at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
     at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
     at Nancy.Routing.DefaultRouteInvoker.GetCompatibleHeaders(IEnumerable`1 coercedAcceptHeaders, NancyContext context, Negotiator negotiator)
     at Nancy.Routing.DefaultRouteInvoker.ProcessAsNegotiator(Object routeResult, NancyContext context)
     at Nancy.Routing.DefaultRouteInvoker.InvokeRouteWithStrategy(Object result, NancyContext context)
     at System.Dynamic.UpdateDelegates.UpdateAndExecute3[T0,T1,T2,TRet](CallSite site, T0 arg0, T1 arg1, T2 arg2)
     at CallSite.Target(Closure , CallSite , DefaultRouteInvoker , Object , NancyContext )
     at Nancy.Routing.DefaultRouteInvoker.Invoke(Route route, DynamicDictionary parameters, NancyContext context)
     at Nancy.Routing.DefaultRequestDispatcher.Dispatch(NancyContext context)
     at Nancy.NancyEngine.InvokeRequestLifeCycle(NancyContext context, IPipelines pipelines) 
```

我尝试使用以下 web.config 对其进行过滤

```
<errorFilter>
  <test>
    <or>
      <regex binding="Exception" pattern="inputString not in correct Type/SubType format Parameter name: \*" />
    </or>
  </test>
</errorFilter> 
```

但是错误并没有被过滤掉。

还尝试了 binding="BaseException.Message" 没有运气。

我想要一种方法来过滤这些消息以防止被记录。可以“纠正”我上面的过滤器配置吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T11:58:46.857

好吧，经过几个小时的跟踪和错误，我发现问题是“参数名称：*”部分不是实际异常消息的一部分。我猜日志中的消息是异常消息和参数值的串联。如图所示更改了过滤器，它的工作原理。

```
<errorFilter>
  <test>
    <regex binding="Exception.Message" pattern="inputString not in correct Type/SubType format" />
  </test>
</errorFilter> 
```

# symfony - 来自 web 服务的 symfony2 用户类

> ID：16020880
> 
> 赞同：0
> 
> 时间：2013-04-15T17:09:35.417
> 
> 标签：symfony, constructor

我正在通过网络服务设置 Symfony 用户登录。

在我的 UserProvider 中，我从 web 服务（Salesforce SOAP）中获取用户。找到用户后，我创建一个新的用户对象。

我的问题来自网络服务，用户有很多我需要存储的信息。

除了食谱提供的四个选项 - return new User($username, $password, $salt, $roles) - 我还需要大约 20 个带有 getter 和 setter 的字段。

在不重新调用 Web 服务的情况下，将这些从 UserProvider 传递给用户的最佳方法是什么？

我错过了什么吗？

任何帮助深表感谢。

邓肯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:30:01.727

`UserProvider`必须提供一个实现`UserInterface`接口的类的实例。因此，您的`User`类可以包含任意数量的字段，条件是该类实现`UserInterface`接口。

# angularjs - CSS 关键帧动画可以在 Angular 的 ng-animate 指令中使用吗？

> ID：16020883
> 
> 赞同：1
> 
> 时间：2013-04-15T17:09:56.463
> 
> 标签：angularjs, ng-animate

这是[一个简单的 Plunkr](http://plnkr.co/edit/6bV5B9?p=preview)，它可以为列表中的项目插入动画。这使用 -webkit-transform 将插入从 scale(0) 缩放到 scale(1)。将 ng-animate="'insert'" 切换为 ng-animate="'fader'" 将使用 Javascript 动画插入项目。

但是：我希望能够在这里使用 CSS 关键帧动画。列表中的最后一个条目是硬编码的，并使用“float-enter-start”类。我似乎无法让 ng-animate 正确应用这个类。似乎设置 ng-animate="''float" 应该有效，但事实并非如此。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:17:00.017

您的 CSS 动画代码不起作用的原因是因为它使用的是 CSS3-Animations 而不是过渡。目前 AngularJS ngAnimate 还不支持检测 CSS 动画属性（仅转换）。本周有人要求修复此问题，我计划在本周的星期一和星期五之间进行修复。

同时，如果您仍然希望支持它，那么您可以使用 JavaScript 动画来使其工作，而函数体内没有任何内容。你所做的只是在 CSS 动画 XXXX 毫秒后调用 done() 方法。然后在您的 CSS 代码中（因为 ngAnimate 仍将 CSS 类添加到元素中）您可以使用相同的 CSS 动画代码，但只需在设置超时内的函数主体内使用该总持续时间。

这是代码。只需包含您之前的 CSS 代码即可执行实际动画。 [https://gist.github.com/matsko/5426873](https://gist.github.com/matsko/5426873)

# php - 将第 3 方 JSON 文件解释为 PHP 表单

> ID：16020886
> 
> 赞同：0
> 
> 时间：2013-04-15T17:10:04.767
> 
> 标签：php, javascript, json

我正在尝试使用预制库来配置 SIP 电话。他们似乎使用 JSON 作为模板，而我处于陌生领域。有许多品牌/型号，有些有多个模板。我希望能够获取模板的内容并将其转换为 php 表单。我不确定如何为不同的部分名称编码。我想编写一个 PHP 函数来完成这一切，而不管使用的模板文件如何。这是我正在使用的两个模板：

```
{
  "template_data":{
    "category":[
      {
        "name":"keys",
        "subcategory":[
          {
            "name":"Soft Keys (9480i\/6755i\/6757i)",
            "item":[
              {
                "description":"Soft Keys (9480i\/6755i\/6757i)",
                "type":"loop",
                "loop_start":"1",
                "loop_end":"18",
                "data":{
                  "item":[
                    {
                      "variable":"$softkey_type",
                      "default_value":"empty",
                      "category":"keys",
                      "description":"Soft Key {$count} Type",
                      "type":"list",
                      "data":[
                        {
                          "text":"Empty",
                          "value":"empty"
                        },
                        {
                          "text":"Services",
                          "value":"services"
                        },
                        {
                          "text":"Speed Dial",
                          "value":"speeddial"
                        },
                        {
                          "text":"Line",
                          "value":"line"
                        },
                        {
                          "text":"BLF",
                          "value":"blf"
                        },
                        {
                          "text":"List",
                          "value":"list"
                        },
                        {
                          "text":"Do Not Disturb",
                          "value":"dnd"
                        },
                        {
                          "text":"XML URL",
                          "value":"xml"
                        },
                        {
                          "text":"BLF Transfer",
                          "value":"blfxfer"
                        },
                        {
                          "text":"Intercom",
                          "value":"icom"
                        },
                        {
                          "text":"Pickup",
                          "value":"pickup"
                        },
                        {
                          "text":"Flash",
                          "value":"flash"
                        },
                        {
                          "text":"Special Prefix Code",
                          "value":"spre"
                        },
                        {
                          "text":"Park",
                          "value":"park"
                        },
                        {
                          "text":"Directory",
                          "value":"directory"
                        },
                        {
                          "text":"Callers",
                          "value":"callers"
                        }
                      ]
                    },
                    {
                      "variable":"$softkey_label",
                      "default_value":"",
                      "description":"Soft Key {$count} Label",
                      "type":"input"
                    },
                    {
                      "variable":"$softkey_value",
                      "default_value":"",
                      "description":"Soft Key {$count} Value",
                      "type":"input"
                    },
                    {
                      "variable":"$softkey_states",
                      "default_value":"Any",
                      "description":"Soft Key {$count} States",
                      "type":"list",
                      "data":[
                        {
                          "text":"Any",
                          "value":"connected,idle,incoming,outgoing"
                        },
                        {
                          "text":"Connected",
                          "value":"connected"
                        },
                        {
                          "text":"Idle",
                          "value":"idle"
                        },
                        {
                          "text":"Incoming",
                          "value":"incoming"
                        },
                        {
                          "text":"Outgoing",
                          "value":"outgoing"
                        },
                        {
                          "text":"Idle or Incoming",
                          "value":"idle,incoming"
                        },
                        {
                          "text":"Connected or Outgoing",
                          "value":"connected,outgoing"
                        },
                        {
                          "text":"None (Hide Button)",
                          "value":[

                          ]
                        }
                      ]
                    },
                    {
                      "type":"break"
                    }
                  ]
                }
              }
            ]
          }
        ]
      }
    ]
  }
} 
```

这是另一个：

```
{
  "template_data":{
    "category":[
      {
        "name":"keys",
        "subcategory":[
          {
            "name":"Multi Function Keys",
            "item":[
              {
                "variable":"$key_mode_01",
                "default_value":"",
                "description":"Key 1 Mode",
                "type":"list",
                "data":[
                  {
                    "text":"Speed Dial",
                    "value":"0"
                  },
                  {
                    "text":"BLF",
                    "value":"1"
                  },
                  {
                    "text":"Presence Watcher",
                    "value":"2"
                  },
                  {
                    "text":"Eventlist BLF",
                    "value":"3"
                  }
                ]
              },
              {
                "variable":"$key_name_01",
                "default_value":"Speed Dial 1",
                "description":"Key Name",
                "type":"input"
              },
              {
                "variable":"$speed_dial_01",
                "default_value":"*01",
                "description":"Value #1",
                "type":"input"
              },
              {
                "type":"break"
              },
              {
                "variable":"$key_mode_02",
                "default_value":"",
                "description":"Key 2 Mode",
                "type":"list",
                "data":[
                  {
                    "text":"Speed Dial",
                    "value":"0"
                  },
                  {
                    "text":"BLF",
                    "value":"1"
                  },
                  {
                    "text":"Presence Watcher",
                    "value":"2"
                  },
                  {
                    "text":"Eventlist BLF",
                    "value":"3"
                  }
                ]
              },
              {
                "variable":"$key_name_02",
                "default_value":"Speed Dial 2",
                "description":"Key Name",
                "type":"input"
              },
              {
                "variable":"$speed_dial_02",
                "default_value":"*02",
                "description":"Value #2",
                "type":"input"
              },
              {
                "type":"break"
              },
              {
                "variable":"$key_mode_03",
                "default_value":"",
                "description":"Key 3 Mode",
                "type":"list",
                "data":[
                  {
                    "text":"Speed Dial",
                    "value":"0"
                  },
                  {
                    "text":"BLF",
                    "value":"1"
                  },
                  {
                    "text":"Presence Watcher",
                    "value":"2"
                  },
                  {
                    "text":"Eventlist BLF",
                    "value":"3"
                  }
                ]
              },
              {
                "variable":"$key_name_03",
                "default_value":"Speed Dial 3",
                "description":"Key Name",
                "type":"input"
              },
              {
                "variable":"$speed_dial_03",
                "default_value":"*03",
                "description":"Value #3",
                "type":"input"
              },
              {
                "type":"break"
              },
              {
                "variable":"$key_mode_04",
                "default_value":"",
                "description":"Key 4 Mode",
                "type":"list",
                "data":[
                  {
                    "text":"Speed Dial",
                    "value":"0"
                  },
                  {
                    "text":"BLF",
                    "value":"1"
                  },
                  {
                    "text":"Presence Watcher",
                    "value":"2"
                  },
                  {
                    "text":"Eventlist BLF",
                    "value":"3"
                  }
                ]
              },
              {
                "variable":"$key_name_04",
                "default_value":"Speed Dial 4",
                "description":"Key Name",
                "type":"input"
              },
              {
                "variable":"$speed_dial_04",
                "default_value":"*04",
                "description":"Value #4",
                "type":"input"
              },
              {
                "type":"break"
              },
              {
                "variable":"$key_mode_05",
                "default_value":"",
                "description":"Key 5 Mode",
                "type":"list",
                "data":[
                  {
                    "text":"Speed Dial",
                    "value":"0"
                  },
                  {
                    "text":"BLF",
                    "value":"1"
                  },
                  {
                    "text":"Presence Watcher",
                    "value":"2"
                  },
                  {
                    "text":"Eventlist BLF",
                    "value":"3"
                  }
                ]
              },
              {
                "variable":"$key_name_05",
                "default_value":"Speed Dial 5",
                "description":"Key Name",
                "type":"input"
              },
              {
                "variable":"$speed_dial_05",
                "default_value":"*05",
                "description":"Value #5",
                "type":"input"
              },
              {
                "type":"break"
              },
              {
                "variable":"$key_mode_06",
                "default_value":"",
                "description":"Key 6 Mode",
                "type":"list",
                "data":[
                  {
                    "text":"Speed Dial",
                    "value":"0"
                  },
                  {
                    "text":"BLF",
                    "value":"1"
                  },
                  {
                    "text":"Presence Watcher",
                    "value":"2"
                  },
                  {
                    "text":"Eventlist BLF",
                    "value":"3"
                  }
                ]
              },
              {
                "variable":"$key_name_06",
                "default_value":"Speed Dial 6",
                "description":"Key Name",
                "type":"input"
              },
              {
                "variable":"$speed_dial_06",
                "default_value":"*06",
                "description":"Value #6",
                "type":"input"
              },
              {
                "type":"break"
              },
              {
                "variable":"$key_mode_07",
                "default_value":"",
                "description":"Key 7 Mode",
                "type":"list",
                "data":[
                  {
                    "text":"Speed Dial",
                    "value":"0"
                  },
                  {
                    "text":"BLF",
                    "value":"1"
                  },
                  {
                    "text":"Presence Watcher",
                    "value":"2"
                  },
                  {
                    "text":"Eventlist BLF",
                    "value":"3"
                  }
                ]
              },
              {
                "variable":"$key_name_07",
                "default_value":"Speed Dial 7",
                "description":"Key Name",
                "type":"input"
              },
              {
                "variable":"$speed_dial_07",
                "default_value":"*07",
                "description":"Value #7",
                "type":"input"
              }
            ]
          }
        ]
      }
    ]
  }
} 
```

看起来这是为了做我想要的，我只是不知道如何开始。我能够从模板文件中检索数据，但从那里丢失了。我曾尝试使用 json_decode，但输出似乎并不友好。我也试过用php来获取模板的内容，然后用javascript来拆。这是一种工作，但每个文件都需要更多的静态变量，并且如果文件的提供者更改了某些内容，则可能需要更多时间进行编辑。如果有人知道解决此问题的最简单方法，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:15:37.407

我会使用 handlebars.js 来显示信息。看这里：

```
http://handlebarsjs.com/ 
```

我每天都使用它，它很简单：

```
<tr>
<td>{{clock_number}}</td>
<td style="width: 150px;">{{employee_name}}</td>
<td>{{hourly_wage}}</td>
<td><a href='employee.php?clock_number={{clock_number}}'>Edit</a></td>
</tr> 
```

非常好的免费课程，可帮助您入门：

```
https://tutsplus.com/course/30-days-to-learn-jquery/ 
```

# python - Django-tastypie 将 request.user 传递给自定义保存方法

> ID：16020890
> 
> 赞同：0
> 
> 时间：2013-04-15T17:10:26.727
> 
> 标签：python, django, tastypie

由于我的模型的自定义保存方法将 request.user 作为参数，我无法执行 POST/PUT 请求。

```
TypeError at /api/obsadmin/observation/23
save() takes at least 2 arguments (1 given) 
```

我正在使用 SessionAuthentication() 并包含 CSRF 令牌。

这是相关的模型部分：

```
def save(self, user, owner=None, *args, **kwargs):
    self.updated_by = user.id
    super(ObsModel, self).save(*args, **kwargs) 
```

和资源：

```
class ObservationResource2(ModelResource):

comments = fields.ToManyField(CommentResource2, 'comments', full=True, null=True)

class Meta:
    queryset = Observation.objects.filter(is_verified=True)
    authentication = SessionAuthentication()
    authorization = DjangoAuthorization()
    resource_name = 'observation'
    always_return_data = True 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-02-21T14:03:04.210

通过使用内置`hydrate`方法在保存之前修改数据，我刚刚实现了同样的最终目标。当前请求在方法`bundle.request`内部可用`hydrate`。[请参阅此处](http://django-tastypie.readthedocs.org/en/latest/resources.html#hydrate)的文档。

我有一个`Friend`公开的模型`FriendResource`，我想通过`user`ForeignKey 字段链接到创建的 Django 用户。

我的示例资源代码：

```
class FriendResource(ModelResource):
    class Meta:
        queryset = Friend.objects.all()
        resource_name = 'friend'
        excludes = ['slug',]
        authentication = SessionAuthentication()
        authorization = DjangoAuthorization()
        always_return_data = True

    def get_object_list(self, request):
        return super(FriendResource, self).get_object_list(request).filter(user=request.user)

    def hydrate(self, bundle):
        bundle.obj.user = bundle.request.user
        return bundle 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T18:09:38.583

您可以覆盖子类的默认`save()`方法`ModelResource`。查看[默认实现](https://github.com/toastdriven/django-tastypie/blob/v0.9.14/tastypie/resources.py#L2236-L2258)表明它`save()`是使用具有请求和要保存的对象的捆绑对象调用的。

不幸的是，如果不复制大部分代码，就没有简单的方法来更改它，因为更改 Django 模型的`save()`签名相当少见。你也许可以做这样的事情，虽然我建议仔细测试它：

```
from functools import partial

try:
    old_save = bundle.obj.save
    bundle.obj.save = partial(old_save, user=bundle.request.user)
    return super(FooResource, self).save(bundle)
finally:
    bundle.obj.save = old_save 
```

参考：

*   obj_create：[文档](http://django-tastypie.readthedocs.org/en/latest/resources.html#id11) [源](https://github.com/toastdriven/django-tastypie/blob/v0.9.14/tastypie/resources.py#L2094-L2105)
*   obj_update：[文档](http://django-tastypie.readthedocs.org/en/latest/resources.html#id12) [源](https://github.com/toastdriven/django-tastypie/blob/v0.9.14/tastypie/resources.py#L2146-L2166)
*   保存：[来源](https://github.com/toastdriven/django-tastypie/blob/v0.9.14/tastypie/resources.py#L2236-L2258)

# sql - 通过索引提高脚本速度

> ID：16020891
> 
> 赞同：0
> 
> 时间：2013-04-15T17:10:41.087
> 
> 标签：sql, sql-server, sql-server-2008-r2

我有以下脚本，以前没问题，但是由于我们的用户群现在已经扩展到近一百万成员，所以脚本现在非常缓慢。我想改进它并需要专家帮助来加快速度，可以通过编码更改、创建索引或两者兼而有之。这是代码：

```
IF @MODE = 'CREATEREQUEST'
    BEGIN
        IF NOT EXISTS (SELECT * FROM FriendRequest WHERE FromMemberID = @FromMemberID AND ToMemberID = @ToMemberID) 
        AND NOT EXISTS (SELECT * FROM MemberConnection WHERE MemberID = @FromMemberID AND ConnMemberID = @ToMemberID)
        AND NOT EXISTS (SELECT * FROM MemberConnection WHERE MemberID = @ToMemberID AND ConnMemberID = @FromMemberID)

        BEGIN
            INSERT INTO FriendRequest (
                FromMemberID,
                ToMemberID,
                RequestMsg,
                OnHold)
            VALUES (
                @FromMemberID,
                @ToMemberID,
                @RequestMsg,
                @OnHold)
        END
        BEGIN
            UPDATE Member SET FriendRequestCount = (FriendRequestCount + 1) WHERE MemberID = @ToMemberID
        END
END 
```

您能提供的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:52:03.480

您可以使用 SQL Server Management Studio 查看表上的索引。例如，如果您的 FriendRequest 表在 FriendRequestID 上有一个 PK，您将能够看到您在该字段上有一个聚集索引。每个表只能有一个聚集索引，并且表记录按该顺序存储。

您可能想尝试将非聚集索引添加到外键字段。您可以使用新建索引向导，或者像这样的语法：

```
CREATE NONCLUSTERED INDEX [IX_FromMemberID] ON [dbo].[FriendRequest] (FromMemberID)
CREATE NONCLUSTERED INDEX [IX_ToMemberID] ON [dbo].[FriendRequest] (ToMemberID) 
```

但是您应该知道，索引通常会减慢您在代码中显示的 INSERT 和 UPDATE 操作。它通常会加速可以使用索引字段的 SELECT 查询（请参阅[执行计划](http://msdn.microsoft.com/en-us/library/ms178071%28v=sql.105%29.aspx)）。

您可以尝试使用[数据库引擎优化顾问](http://msdn.microsoft.com/en-us/library/ms166575.aspx)来了解一些可能的索引及其对应用程序工作负载的影响。

索引是一个很大的主题，您可能希望一次迈出一小步。

# python - 在烧瓶中将列表从 peewee 传递到 jinja2

> ID：16020893
> 
> 赞同：0
> 
> 时间：2013-04-15T17:10:52.287
> 
> 标签：python, flask, jinja2, peewee

我正在尝试编写一个 Flask 应用程序来查询我的数据库（使用 peewee），并将结果发送到 Jinja2 进行渲染。我的观点是这样的：

```
@application.route('/maindash')
def maindash():
    sq = Selfreported.select().join(Demog).where(Demog.mrn == session['mrn']).order_by(Selfreported.reportingdate)
    series1data = ["Series 1", ([s.reportingdate, s.series] for s in sq)]
    jsonedData = json.dumps(series1data)

    return render_template('maindash.html', seriesdata=jsonedData) 
```

要将查询结果传递给 Jinja2，我知道我需要序列化数据。但是当我调用 json.dumps: TypeError: at 0x104854be0> is not JSON serializable。所以我想我实际上并没有获取数据，而是试图序列化查询对象本身？

我看过的每个 peewee 示例都使用 peewee-flask 中的 object_list 辅助函数，而不是将查询结果直接传递给 render_template。我看过 object_list，但我很难理解它——

```
def object_list(template_name, qr, var_name='object_list', **kwargs):
kwargs.update(
    page=int(request.args.get('page', 1)),
    pages=qr.count() / 20 + 1
)
kwargs[var_name] = qr.paginate(kwargs['page'])
return render_template(template_name, **kwargs) 
```

QueryResultWrapper 上是否有我应该用来获取实际数据而不是对象的方法？我看过 tuples() 和 dict()，但我无法遍历它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T22:50:01.613

没有理由在将数据传递给 Jinja 之前对其进行序列化，因为 Jinja 是用 Python 编写的，并且可以处理 Flask 可以处理的任何事情。只需传入`series1data`您的`render_template`电话并在模板中遍历它：

```
return render_template('maindash.html', seriesdata=series1data) 
```

```
{# maindash.html #}
{% for reportingdate, series in seriesdata[1] %}
    {{ reportingdate }} - {{ series }}<br>
{% endfor %} 
```

# silverlight - 切换（工具提示）禁用 Silverlight 按钮的悬停文本

> ID：16020894
> 
> 赞同：0
> 
> 时间：2013-04-15T17:10:55.183
> 
> 标签：silverlight, button

我的网格在一列中显示一个按钮。默认情况下，Silverlight 禁用禁用按钮的工具提示显示。我试图通过将按钮和工具提示对象放置在边框控件内来解决此问题。我想在禁用按钮时显示工具提示，而在启用时不显示。我试图将工具提示绑定到按钮 IsEnabled 属性，但不起作用。这是代码：

```
<Border HorizontalAlignment="Center" VerticalAlignment="Center" Background="Transparent"  >
<ToolTipService.ToolTip  >
  <ToolTip Content="Ticket Required"   Visibility="{Binding IsEnabled,     ElementName=btnEdit, Converter={StaticResource BooleanToInvisibilityConverter}}"   />
</ToolTipService.ToolTip>
<Button x:Name="btnEdit" Content="Add"   Margin="0, 0, 7, 0" Width="35" HorizontalAlignment="Right" Command="{Binding EditCommand}" CommandParameter="{Binding}"  Style="{StaticResource SquareButtonStyle}" Click="EditButtonClick" IsTabStop="True"/>
</Border> 
```

无论按钮是否启用/禁用，都会显示工具提示。我究竟做错了什么。我觉得我的绑定有问题，或者这不是这样做的方法。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T09:50:45.663

由于某种原因，元素绑定似乎在这里不起作用。绑定机制找不到您尝试绑定的按钮。如果您改为绑定到视图模型上的属性，它就会起作用。这是一个工作示例：

```
<UserControl x:Class="SilverlightApplication14.MainPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:local="clr-namespace:SilverlightApplication14"
             mc:Ignorable="d"
             d:DesignHeight="300"
             d:DesignWidth="400">

    <Grid x:Name="LayoutRoot"
          Background="White">

        <Grid.Resources>

            <local:ReverseBoolToVisibilityConverter x:Key="ReverseBoolToVisibilityConverter"></local:ReverseBoolToVisibilityConverter>

        </Grid.Resources>

        <Border HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Background="Transparent">

            <Button x:Name="btnEdit"
                    IsEnabled="{Binding IsButtonEnabled}"
                    Content="Add"
                    Margin="0, 0, 7, 0"
                    Width="35"
                    HorizontalAlignment="Right"
                    Command="{Binding EditCommand}"
                    CommandParameter="{Binding}"
                    IsTabStop="True" />

            <ToolTipService.ToolTip>
                <ToolTip Content="Ticket Required"
                         Visibility="{Binding IsButtonEnabled, Converter={StaticResource ReverseBoolToVisibilityConverter}}" />
            </ToolTipService.ToolTip>
        </Border>

        <CheckBox HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Margin="0 -50 0 0"
                  IsChecked="{Binding IsButtonEnabled, Mode=TwoWay}" Content="Is Enabled"></CheckBox>

    </Grid>
</UserControl> 
```

以及包括转换器类的代码隐藏：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Globalization;
using System.Linq;
using System.Net;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;

namespace SilverlightApplication14
{
    public partial class MainPage : UserControl, INotifyPropertyChanged
    {
        private bool _IsButtonEnabled;

        public bool IsButtonEnabled
        {
            get { return _IsButtonEnabled; }
            set
            {
                _IsButtonEnabled = value;
                OnPropertyChanged("IsButtonEnabled");
            }
        }

        public MainPage()
        {
            InitializeComponent();

            IsButtonEnabled = true;

            LayoutRoot.DataContext = this;
        }

        public event PropertyChangedEventHandler PropertyChanged;

        protected virtual void OnPropertyChanged(string propertyName)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
            }
        }
    }

    public class ReverseBoolToVisibilityConverter : IValueConverter
    {
        #region IValueConverter Members

        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            if (value != null && (bool)value)
            {
                return Visibility.Collapsed;
            }

            return Visibility.Visible;
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }

        #endregion
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-18T14:51:26.390

它不起作用的原因是每当您使用带有按钮的命令时，它的启用禁用属性都是由命令的 CanExecute 方法驱动的。

也因为它的方法你不能直接绑定 Command 的 CanExecute 方法。因此，您需要一些解决方法将 CanExecute 方法的值获取到属性中并将该属性绑定到 ToolTip 的可见性。

# javascript - 输入键按回车并转到链接

> ID：16020895
> 
> 赞同：-1
> 
> 时间：2013-04-15T17:11:03.383
> 
> 标签：javascript, jquery, html

我想要做的是，如果用户在输入文本后按键盘上的 Enter 键，那么它会转到一个链接。

仅对于前端演示，最好的方法是如何做到这一点？

这是html：

```
<form>
     <input class="login_btn" type="text" value="Password" onfocus="this.type='password';this.value=''" onblur="if(this.value == ''){this.type='text';this.value='Password';}"></input>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:15:36.240

尝试这个

```
$(".login_btn").keyup(function(e) {
    if (e.which == 13 && this.value.length > 0) { //check for empty input as well
        //Enter was pressed, now do what you need to do.
    }
}); 
```

顺便说一句：弄清楚是否按下了输入之前已经被问过很多次了。请考虑搜索:)。

# apache - 如何使用 .htaccess 进行重定向

> ID：16020897
> 
> 赞同：-1
> 
> 时间：2013-04-15T17:11:07.267
> 
> 标签：apache, .htaccess, redirect

我需要重定向所有流量，如下所示：

```
mydomain.com/a/b/c => www.mydomain.com/a/b/c 
```

应保留所有 url 信息，仅修改域。

谢谢。

山姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:13:11.790

就像是：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^mudomain.com[nc]
RewriteRule ^(.*)$ http://www.mydomain.com/$1 [r=301,nc] 
```

# php - 访问 tbl_person 详细信息时出错

> ID：16020899
> 
> 赞同：1
> 
> 时间：2013-04-15T17:11:12.730
> 
> 标签：php, codeigniter

人.php

```
<?php
class Person extends CI_Controller {

    public function index()
    {
        echo 'Hello World! person';

        $this->load->model('PersonModel');

        $this->PersonModel->get_last_ten_entries();
    }
}
?> 
```

人模型.php

```
<?php

class PersonModel extends CI_Model {

    var $title   = '';
    var $content = '';
    var $date    = '';

    function __construct()
    {
        // Call the Model constructor
        parent::__construct();
    }

    function get_last_ten_entries()
    {
        $query = $this->db->get('entries', 10);
        return $query->result();
    }

    function insert_entry()
    {
        $this->title   = $_POST['title']; // please read the below note
        $this->content = $_POST['content'];
        $this->date    = time();

        $this->db->insert('entries', $this);
    }

    function update_entry()
    {
        $this->title   = $_POST['title'];
        $this->content = $_POST['content'];
        $this->date    = time();

        $this->db->update('entries', $this, array('id' => $_POST['id']));
    }

}
?> 
```

收到此错误：

```
Fatal error: Call to a member function get() on a non-object in C:\wamp1\www\ci\CodeIgniter_2.1.3\application\models\personModel.php on line 18 
```

我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:21:32.580

CodeIgniter 设置的一个常见错误是忘记加载数据库。本文档讨论了如何做到这一点：

[http://ellislab.com/codeigniter/user-guide/database/connecting.html](http://ellislab.com/codeigniter/user-guide/database/connecting.html)

最简单的方法是将“**数据库**”添加到库数组中，以便在*application/config/autoload.php*[中找到自动加载](http://ellislab.com/codeigniter/user-guide/general/autoloader.html)

 *例子：

```
$autoload['libraries'] = array('database', 'form_validation', 'session'); 
```*

# html - 使用 ./ 从 url 中删除 index.html

> ID：16020903
> 
> 赞同：0
> 
> 时间：2013-04-15T17:11:26.923
> 
> 标签：html

我在某处读到可以在任何子目录的任何页面上添加 href="./" 以将用户发送到根 index.html 文件，但这似乎不起作用。正如标题所示，当用户单击主页链接时，我试图在 URL 中不包含 /index.html

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:13:59.917

然后只需使用：

```
<a href="/">home</a> 
```

或者

```
<a href="/index.html">home</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T17:20:20.253

如果你在 www.yoursite.com/dir/ 并且你想去你的根文件夹，你必须使用`../`而不是`./`

如果您想从 www.yoursite.com/dir/dir2/dir3/ 返回到您的根目录，您必须编写：`../../../` 最好的解决方案可能是您的根文件夹的完整路径： `www.yoursite.com/`

# css - 允许跨度溢出 twitter bootstrap 中的行

> ID：16020908
> 
> 赞同：1
> 
> 时间：2013-04-15T17:11:31.167
> 
> 标签：css, twitter-bootstrap

我正在寻找对我的侧边栏溢出背景更改的布局做一些事情。

您可以在[此处的 jsfiddle](http://jsfiddle.net/3sBkk/)中看到我目前拥有的内容。我确信我只是在我的以下 html 中写了一些乱七八糟的东西。我希望深灰色直接显示在最近的帖子图片下方，但允许侧边栏向下扩展。我不能只使用背景图像来执行此操作，因为较轻内容的长度会在其他 wordpress 模板页面上发生变化。

这是我目前拥有的代码

```
<div id="main-content-container">
    <div class="container">
        <div class="row">
            <div id="main-content" class="span9">
                <div class="row">
                    <div id="featured-article" class="span9"><img src="http://placehold.it/715x340" /></div>
                </div>
                <div id="recent-posts" class="row">
                    <div class="span9">
                        <div class="row">
                            <div class="span9">
                                <h1>Recent Posts</h1>
                            </div>
                        </div>
                        <div class="row">
                            <div class="span3"><img src="http://placehold.it/220" /></div>
                            <div class="span3"><img src="http://placehold.it/220" /></div>   
                            <div class="span3"><img src="http://placehold.it/220" /></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="sidebar" class="span3">
                <p>
                  Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent sed justo vitae quam accumsan semper. Vivamus varius orci posuere turpis congue semper vulputate eros congue. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Maecenas eleifend magna in nulla semper vestibulum. Nulla a auctor odio. Vestibulum condimentum placerat tortor ut tempus. Morbi aliquet pellentesque sapien eu pharetra. Vivamus luctus, urna id pretium congue, dui nisi vestibulum nunc, non tincidunt justo dolor eget lacus. Aliquam condimentum, urna at blandit tristique, nulla felis porta erat, congue consectetur tortor mi vitae neque.

                  Nullam pellentesque, velit in convallis sagittis, enim enim viverra elit, ac tincidunt tellus elit eget dui. Donec sit amet odio eros. Nullam vitae pretium augue. Maecenas sit amet nisi ante, quis laoreet augue. Aliquam commodo suscipit bibendum. Duis imperdiet ornare magna, non porttitor lacus faucibus eget. Aenean viverra purus quis turpis fringilla hendrerit. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Nunc suscipit molestie nunc. Donec convallis mollis dui nec accumsan. Donec posuere ipsum ut nisl ornare eget sodales metus feugiat. Aliquam viverra, nunc nec malesuada hendrerit, velit nisl placerat augue, sed feugiat nisl turpis id risus. Nunc lobortis massa vitae justo fringilla vel condimentum lectus fermentum.
                </p>
            </div>
        </div>
    </div>
</div>

<div id="extra-body-container">
    This part should fall right under the recent posts pictures and allow the sidebar to overflow on top of it.
</div> 
```

我试图在侧边栏上设置一个浮动，但没有奏效。我不确定我拥有我的 html 的方式是否允许我只修改我的 css 来执行此操作。

![我的代码得到了什么结果](https://i.stack.imgur.com/yq9x4.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T19:51:57.563

看起来（如你所说）你只是有几件事不正常

这是一个修改后的小提琴。 [http://jsfiddle.net/3sBkk/1/](http://jsfiddle.net/3sBkk/1/)

实际上，只需将您的内容移动到主包装元素中，并从中创建一行，将跨度调整为 12，并设置侧边栏的 z 顺序以确保它重叠。

我不确定如何在此处包含代码，但这是罪魁祸首。

```
 <div id="recent-posts" class="row">
                <div class="span9">
                    <div class="row">
                        <div class="span9">
                                <h1>Recent Posts</h1>
                        </div>
                    </div>
                    <div class="row">
                        <div class="span3">
                            <img src="http://placehold.it/220" />
                        </div>
                        <div class="span3">
                            <img src="http://placehold.it/220" />
                        </div>
                        <div class="span3">
                            <img src="http://placehold.it/220" />
                        </div>
                    </div>
                    <div class="row">
                       <div id="extra-body-container" class="span12">This part should fall right under the recent posts pictures and allow the sidebar to overflow on top of it.</div> 
                    </div>
                </div>
            </div> 
```

编辑：要同时实现重叠的侧边栏和 100% 的宽度，您将不得不对您的 css 进行一些修改，我不一定支持它，但它是否可能，当然，一切皆有可能。

[http://jsfiddle.net/2Yet7/](http://jsfiddle.net/2Yet7/)（抱歉它太丑了）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T20:03:38.273

extra-body-container 上方的行尝试将其设置为 margin-left: -100% 沿 w/body-bg.png 然后在 extra-body-contain 上将 margin-left 设置为 50% 并将宽度设置为 100 %

在这里查看：http: [//jsfiddle.net/3sBkk/9/show/](http://jsfiddle.net/3sBkk/9/show/)

```
<div id="main-content-container">
<div class="container">
    <div class="row">
        <div id="main-content" class="span9">
            <div class="row">
                <div id="featured-article" class="span9">
                    <img src="http://placehold.it/715x340" />
                </div>
            </div>
            <div id="recent-posts" class="row">
                <div class="span9">
                    <div class="row">
                        <div class="span9">
                                <h1>Recent Posts</h1>

                        </div>
                    </div>
                    <div class="row">
                        <div class="span3">
                            <img src="http://placehold.it/220" />
                        </div>
                        <div class="span3">
                            <img src="http://placehold.it/220" />
                        </div>
                        <div class="span3">
                            <img src="http://placehold.it/220" />
                        </div>
                    </div>
                    <div class="row" style="margin-left: -100%; background: url('../img/extra-body-bg.png') #AAAAAA repeat-x top center;">
                        <div id="extra-body-container" class="span12">This part should fall right under the recent posts pictures and allow the sidebar to overflow on top of it.</div>
                    </div>
                </div>
            </div>
        </div>
        <div id="sidebar" class="span3" style="z-index: 999;">
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent sed justo vitae quam accumsan semper. Vivamus varius orci posuere turpis congue semper vulputate eros congue. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Maecenas eleifend magna in nulla semper vestibulum. Nulla a auctor odio. Vestibulum condimentum placerat tortor ut tempus. Morbi aliquet pellentesque sapien eu pharetra. Vivamus luctus, urna id pretium congue, dui nisi vestibulum nunc, non tincidunt justo dolor eget lacus. Aliquam condimentum, urna at blandit tristique, nulla felis porta erat, congue consectetur tortor mi vitae neque. Nullam pellentesque, velit in convallis sagittis, enim enim viverra elit, ac tincidunt tellus elit eget dui. Donec sit amet odio eros. Nullam vitae pretium augue. Maecenas sit amet nisi ante, quis laoreet augue. Aliquam commodo suscipit bibendum. Duis imperdiet ornare magna, non porttitor lacus faucibus eget. Aenean viverra purus quis turpis fringilla hendrerit. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Nunc suscipit molestie nunc. Donec convallis mollis dui nec accumsan. Donec posuere ipsum ut nisl ornare eget sodales metus feugiat. Aliquam viverra, nunc nec malesuada hendrerit, velit nisl placerat augue, sed feugiat nisl turpis id risus. Nunc lobortis massa vitae justo fringilla vel condimentum lectus fermentum.</p>
        </div>
    </div>
</div> 
```

希望这有助于或至少让您朝着正确的方向前进。

# regex - 如何优化此正则表达式以匹配字符串 (1234-12345-1)

> ID：16020914
> 
> 赞同：1
> 
> 时间：2013-04-15T17:11:41.797
> 
> 标签：regex, validation, number-formatting

我有这个正则表达式示例：[http ://regexr.com?34hihsvn](http://regexr.com?34hihsvn)

我想知道是否有更优雅的编写方式，或者更优化的方式？

以下是规则：

*   仅限数字和破折号。
*   不得包含超过 10 位数字。
*   必须有两个连字符。
*   每个连字符之间必须至少有一个数字。
*   最后一个数字只能是一位数字。

我对此很陌生，因此将不胜感激任何提示或提示。

如果链接过期，要搜索的文本是

```
----------
22-22-1
22-22-22
333-333-1
333-4444-1
4444-4444-1
4444-55555-1
55555-4444-1
666666-7777777-1
88888888-88888888-1
1-1-1
88888888-88888888-22
22-333-
333-22
---------- 
```

我的正则表达式是：`\b((\d{1,4}-\d{1,5})|(\d{1,5}-\d{1,4}))-\d{1}\b`

我正在使用此站点进行测试： http: [//gskinner.com/RegExr/](http://gskinner.com/RegExr/)

感谢您的帮助，尼克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T19:07:56.890

您的正则表达式只允许最大长度为 5 的第一组和第二组数字。因此，像`1-12345678-1`or这样的有效字符串`123456-1-1`不会被匹配。

此正则表达式适用于给定的要求：

```
\b(?:\d\-\d{1,8}|\d{2}\-\d{1,7}|\d{3}\-\d{1,6}|\d{4}\-\d{1,5}|\d{5}\-\d{1,4}|\d{6}\-\d{1,3}|\d{7}\-\d{1,2}|\d{8}\-\d)\-\d\b 
```

([正则表达式](http://regexr.com?34hjr))

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T19:34:25.710

您可以将其与`m`修饰符一起使用*（打开多行模式）*：

```
^\d(?!.{12})\d*-\d+-\d$ 
```

或者这个没有`m`修饰符的：

```
\b\d(?!.{12})\d*-\d+-\d\b 
```

通过设计，这两种模式至少匹配由连字符分隔的三个数字*（因此无需在`{5,n}`某处放置量词，它没用）*。模式也被构建为更快地失败：

*   我选择以 digit 开头`\d`，这样，每行开头或字边界后面没有数字的都会立即被丢弃。另一件事，只使用一个数字，我知道剩余的字符串长度。
*   然后我用负前瞻测试字符串长度的上限，测试是否比最大长度多一个字符*（如果这个位置有 12 个字符，则字符串中至少有 13 个字符）*。此处无需使用比点元字符更具描述性的内容，目标是快速测试长度。
*   最后，我描述了字符串的结尾而不做任何特别的事情。这可能是模式中​​较慢的部分，但这并不重要，因为绝大多数不必要的位置已经被丢弃。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T19:34:25.510

这是我想出的一个正则表达式：

```
(?=\b[\d-]{3,10}-\d\b)\b\d+-\d+-\d\b 
```

这在尝试匹配之前使用前瞻来验证信息。`[\d-]`所以它会在a`dash`和 a的类中查找 3-10 个字符`digit`。然后在这之后你有实际的匹配来确认你的字符串的格式实际上是`digit(dash)digit(dash)digit`.

从您的示例字符串中，此正则表达式匹配：

```
22-22-1
333-333-1
333-4444-1
4444-4444-1
4444-55555-1
55555-4444-1
1-1-1 
```

它还匹配以下字符串：

```
22-7777777-1
1-88888888-1 
```

# objective-c - 避免关联对象键的额外静态变量

> ID：16020918
> 
> 赞同：23
> 
> 时间：2013-04-15T17:11:58.717
> 
> 标签：objective-c, objective-c-runtime, associated-object

当使用关联对象（从 iOS 4 和 OSX 10.6 开始提供的 Objective-C 运行时功能）时，有必要定义一个键用于在运行时存储和检索对象。

典型的用法是定义如下的键

```
static char const * const ObjectTagKey = "ObjectTag"; 
```

然后用就是存储对象

```
objc_setAssociatedObject(self, ObjectTagKey, newObjectTag, OBJC_ASSOCIATION_RETAIN_NONATOMIC); 
```

并检索它

```
objc_getAssociatedObject(self, ObjectTagKey); 
```

（[http://oleb.net/blog/2011/05/faking-ivars-in-objc-categories-with-associative-references/](http://oleb.net/blog/2011/05/faking-ivars-in-objc-categories-with-associative-references/)的例子）

是否有一种更简洁的方法来定义关联的对象键，而不涉及额外变量的声明？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-04-15T17:12:22.390

根据Erica Sadun（其功劳[归于 Gwynne Raskind ）的这篇](http://blog.darkrainfall.org/)[博](http://www.tuaw.com/2013/04/10/devjuice-better-objective-c-associated-objects/)文，有。

`objc_getAssociatedObject`并`objc_getAssociatedObject`需要一个密钥来存储对象。这样的键需要是一个常量`void`指针。所以最后我们只需要一个随着时间保持不变的固定地址。

事实证明，该`@selector`实现提供了我们所需要的，因为它使用固定地址。

因此，我们可以摆脱键声明并简单地使用我们属性的选择器地址。

因此，如果您在运行时关联一个属性，例如

```
@property (nonatomic, retain) id anAssociatedObject; 
```

我们可以为其 getter/setter 提供动态实现，看起来像

```
- (void)setAnAssociatedObject:(id)newAssociatedObject {
     objc_setAssociatedObject(self, @selector(anAssociatedObject), newAssociatedObject, OBJC_ASSOCIATION_RETAIN_NONATOMIC);
}

- (id)anAssociatedObject {
    return objc_getAssociatedObject(self, @selector(anAssociatedObject));
} 
```

比为每个关联对象定义一个额外的静态变量键非常简洁且绝对干净。

### 这安全吗？

由于这是依赖于实现的，一个合理的问题是：它会很容易崩溃吗？引用博客条目

> Apple 可能必须实施一个全新的 ABI 才能做到这一点

如果我们认为这些话是真的，那么它是相当安全的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-08-31T12:53:50.103

如果您需要从单个方法的范围之外访问密钥，那么一个很好的模式会导致代码更具可读性，即创建一个指针，该指针仅指向它自己在堆栈中的地址。例如：

```
static void const *MyAssocKey = &MyAssocKey; 
```

如果您*只需*要从单个方法的范围内访问，您实际上可以只使用`_cmd`，它保证是唯一的。例如：

```
objc_setAssociatedObject(obj, _cmd, associatedObj, OBJC_ASSOCIATION_RETAIN_NONATOMIC); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-16T04:16:42.947

@Gabriele Petronella 讨论的想法的一个细微变化是将字典与每个对象相关联：

```
//NSObject+ADDLAssociatedDictionary.h

#import <Foundation/Foundation.h>

@interface NSObject (ADDLAssociatedDictionary)
- (void)addl_setAssociatedObject:(id)object forKey:(id<NSCopying>)key;
- (id)addl_associatedObjectForKey:(id<NSCopying>)key;
@end

//NSObject+ADDLAssociatedDictionary.m

#import <objc/runtime.h>

@interface NSObject (ADDLAssociatedDictionaryInternal)
- (NSMutableDictionary *)addl_associatedDictionary;
@end

@implementation NSObject (ADDLAssociatedDictionary)

- (void)addl_setAssociatedObject:(id)object forKey:(id<NSCopying>)key
{
    if (object) {
        self.addl_associatedDictionary[key] = object;
    } else {
        [self.addl_associatedDictionary removeObjectForKey:key];
    }
}
- (id)addl_associatedObjectForKey:(id<NSCopying>)key
{
    return self.addl_associatedDictionary[key];
}

@end

@implementation NSObject (ADDLAssociatedDictionaryInternal)
const char addl_associatedDictionaryAssociatedObjectKey;
- (NSMutableDictionary *)addl_associatedDictionaryPrimitive
{
    return objc_getAssociatedObject(self, &addl_associatedDictionaryAssociatedObjectKey);
}
- (void)addl_setAssociatedDictionaryPrimitive:(NSMutableDictionary *)associatedDictionary
{
    objc_setAssociatedObject(self, &addl_associatedDictionaryAssociatedObjectKey, associatedDictionary, OBJC_ASSOCIATION_RETAIN_NONATOMIC);
}
- (NSMutableDictionary *)addl_generateAssociatedDictionary
{
    NSMutableDictionary *associatedDictionary = [[NSMutableDictionary alloc] init];
    [self addl_setAssociatedDictionaryPrimitive:associatedDictionary];
    return associatedDictionary;
}

- (NSMutableDictionary *)addl_associatedDictionary
{
    NSMutableDictionary *res = nil;

    @synchronized(self) {
        if (!(res = [self addl_associatedDictionaryPrimitive])) {
            res = [self addl_generateAssociatedDictionary];
        }
    }

    return res;
}
@end 
```

然后在我们类上的一些子类Derived NSObject

```
//Derived+Additions.h

#import "Derived.h"

@interface Derived (Additions)
@property (nonatomic) id anAssociatedObject;
@end

//Derived+Additions.m

#import "NSObject+ADDLAssociatedDictionary.h"

@implementation Derived (Additions)
- (void)setAnAssociatedObject:(id)anAssociatedObject
{
    [self addl_setAssociatedObject:anAssociatedObject forKey:NSStringFromSelector(@selector(anAssociatedObject))];
}
- (id)anAssociatedObject
{
    return [self addl_associatedObjectForKey:NSStringFromSelector(@selector(anAssociatedObject))];
}
@end 
```

一般来说，关联字典方法的一个好处是能够为在运行时生成的键设置对象，从而增加了灵活性，更不用说更好的语法了。

使用特定的好处

```
NSStringFromSelector(@selector(anAssociatedObject)) 
```

是[`NSStringFromSelector`](https://developer.apple.com/library/mac/documentation/cocoa/reference/foundation/miscellaneous/foundation_functions/reference/reference.html#//apple_ref/c/func/NSStringFromSelector)保证给出`NSString`选择器的表示，它将始终是可接受的字典键。因此，我们完全不必担心 ABI 的变化（尽管我认为这不是一个合理的担忧）。

# javascript - 如何创建变量的字典

> ID：16020922
> 
> 赞同：1
> 
> 时间：2013-04-15T17:12:09.957
> 
> 标签：javascript, jquery

我对使用 Javascript 创建有一个疑问，`dict`因为这不是正常的数组。我必须阅读值`textarea`（这些在表格内）。

例子：

```
<form method="GET" name="formparam" id="formparam" >
table><tr><td><label>ID</label></td><td>
<textarea class="expand" name="inputp'+v+'_id" id="inputp'+v+'_id"></textarea></td></tr>\
<tr><td><label>Type</label></td><td><select name="inputp'+v+'_type" id="inputp'+v+'_type">\
<option value="text">Text</option><option value="integer">Integer</option><option value="float">Float</option>\
<option value="list_values">List of values</option><option value="range">Range</option>\
<option value="selection_collapsed">Selection (collapsed)</option>\
<option value="selection_expanded">Selection (expanded)</option>\
<option value="subimage">Subimage selection</option>\
<option value="polygon">Polygon selection</option>\
<option value="horizontal_separator">Horizontal separator</option>\
</select></td></tr><tr><td><label> Description</label></td>\
</tr></table></form>'); 
```

我希望创建变量（字典）类似于

`var a = {"a":"wohoo", "b":"hello2", "d":"hello"};`

但我感兴趣

与

`var a={"inputp1_id" : "( the value inside the first textarea), "inputp1_type" :"type's selected"}`

如何在 dict 中添加变量和值的 textarea ？

我想使用的程序：

*   我使用循环While（或for）阅读所有文本区域......
*   我想用`id`or`name`和`textarea`值创建变量。

例子

```
<form method="GET" name="formparam" id="formparam" ><table><tr><td>
<textarea name="name" >john</textarea></td></tr>
<tr><td><label>Type</label></td><td><textarea name="surname">
 jackold</textarea></td></tr></table></form>
 for (i=1;i<3;i++)
 var a={}; 
```

我如何创建添加值的dict是textarea？最后我想要变量 a

```
a= {name:john,surname:jackold} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:20:57.643

```
var a = {};

for (var i = 0; i < document.formparam.elements.length; i++)
{
    var field = document.formparam.elements[i];
    a[field.name] = field.value;
} 
```

# java - 如何监控HttpURLConnection发送的数据大小？

> ID：16020928
> 
> 赞同：5
> 
> 时间：2013-04-15T17:12:31.927
> 
> 标签：java, post, httpurlconnection

我试图显示已经发送的数据的大小，`OutputStreamWriter`但似乎该`write`方法有点像异步，这意味着如果文件为 60M，上传速率为 200K/s，输出仅显示一行“数据已发送：61210K "（或任何大的数字）而不是应该的（每秒的小数字）

我错过了什么？

代码段：

```
Writer writer = new OutputStreamWriter(out, POST_ENCODING);
char[] buf = new char[1024];
int read = 0;
long bytes = 0;
while ((read = reader.read(buf)) >= 0) {
    bytes += read;
    if (System.currentTimeMillis() - lastMsgTimeStamp > 1000) {
        lastMsgTimeStamp = System.currentTimeMillis();
        System.out.println("Data sent: " + (bytes / 1024) + " K");
    }
    writer.write(buf, 0, read);
}
writer.flush(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T21:18:23.483

假设`reader`是`InputStreamReader`，您正在跟踪读取/发送的字符数，而不是字节数。如果您实际上没有在读/写之间处理文本，那么您可以使用标准`InputStream`/`OutputStream`来监视字节数。

另外，`lastMsgTimeStamp`没有声明，它是否被设置`System.currentTimeMillis()`在您的示例之外的某个地方？

在任何一种情况下，`OutputSteamWriter`以及`java.io.*`包的其余部分都会阻塞。所以当`write`被调用时，你的线程会停止，直到它完成。然而，有一些缓冲正在进行，由`StreamEncoder`in`OutputStreamWriter`和 return by 的`OutputStream`实现`URLConnection`。两者都没有缓冲如此大量的数据，因此您的问题可能出在其他地方。

# javascript - getJSON 函数的返回值

> ID：16020929
> 
> 赞同：1
> 
> 时间：2013-04-15T17:12:36.770
> 
> 标签：javascript, jquery, getjson

我有一个带有 jquery getJSON 的函数，我需要返回结果值（在其他地方使用它）

这是代码：

```
function getval(){
jQuery.getJSON('http://data.mtgox.com/api/1/BTCUSD/ticker?callback=?', function(data) {
    // We can't use .return because return is a JavaScript keyword.
    return data['return'].avg.value;
});
}

$(function () {
    $(document).ready(function() {
    alert (getval());
    });

}); 
```

这是行不通的:(

**我知道我可以从 getJSON 函数内部调用外部函数，其值如下：**

```
 jQuery.getJSON('http://data.mtgox.com/api/1/BTCUSD/ticker?callback=?', function(data) {
        // We can't use return because return is a JavaScript keyword.
       mysecondfunction(data['return'].avg.value);
    });
function mysecondfunction(value){
//use the value
} 
```

但是我必须从**另一个函数调用****json**函数，因为 json 返回一个动态值，我需要使用它。

 **我希望它清楚...

**非常感谢你！！**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T08:38:34.630

这是最终的解决方案：

```
function getval( callback ){
    jQuery.getJSON('http://data.mtgox.com/api/1/BTCUSD/ticker', function(data) {
        // We can't use .return because return is a JavaScript keyword.
        callback(data['return'].avg.value);
    });
}

$(function () {
        $(document).ready(function() {
        getval( function ( value ) { 
            alert( 'Do something with ' + value + ' here!' );
        } );
    });

}); 
```

谢谢大家的帮助！！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-15T17:17:00.127

您可以尝试使用一个`callback`函数：

```
function getval( callback ){
    jQuery.getJSON('http://data.mtgox.com/api/1/BTCUSD/ticker?callback=?', function(data) {
        // We can't use .return because return is a JavaScript keyword.
        callback(data['return'].avg.value);
    });
}

$(function () {
        $(document).ready(function() {
        getval( function ( value ) { alert( 'Do something with ' + value + ' here!' ) } );
    });

}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T17:15:24.893

Ajax 调用是异步的，所以你不能让`getVal()`函数返回一些东西。无论您需要对结果做什么，都必须在回调函数内部进行。

```
function getval() {
    jQuery.getJSON('http://data.mtgox.com/api/1/BTCUSD/ticker?callback=?', function(data) {
        // You have to use "data" here
        alert(data['return'].avg.value);
    });
}

$(function () {
    $(document).ready(function() {
        getval();
    });
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-10T12:01:05.213

嗨 getJSON 异步调用，所以它的返回**未定义**

所以你需要用这个 args **asnyc:false触发 ajax 调用传递**

前任：

```
 function getCountrycodeJson(obj) {
     var code="";
        $.ajax({
         async: false,
          dataType : 'json',
         url: "url",
         type : 'GET',
         success: function(data) {
         for(var i in data){ 
//here do your logic and assign value for code varable   

          }
           }
      }});

        return code;
    } 
```

这对我有用......**

# c - wchar_t 和多字节函数是 ANSI C 的一部分吗？

> ID：16020930
> 
> 赞同：3
> 
> 时间：2013-04-15T17:12:41.687
> 
> 标签：c, ansi, wchar-t, c89

`C99`并`C11`支持`wchar_t`和多字节功能。但我不确定`ANSI C`（1989）。

`wchar_t`多字节函数（`mblen`, `mbstowcs`, `mbtowc`, `wcstombs`, `wctomb`）是 ANSI C 的一部分是否正确？

我在 Kernighan 和 Ritchie 的书（C 编程语言（第 2 版））中找不到这些函数。

[http://www.amazon.com/Programming-Language-2nd-Brian-Kernighan/dp/0131103628](https://rads.stackoverflow.com/amzn/click/com/0131103628)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T17:25:07.800

该名称`wchar_t`在 C89（和 C99）标准中，但它不是语言支持的类型。它是一种`typedef`能够保存必要位数的整数类型。C89 7.1.6 [标准定义] 说：

> wchar_t
> 是一个整数类型，其值范围可以表示支持的语言环境中指定的最大扩展字符集的所有成员的不同代码；空字符的代码值应为零，并且在 5.2.1 中定义的基本字符集的每个成员的代码值应等于其在用作整数字符常量中的唯一字符时的值。

这意味着`wchar_t`只要`<stddef.h>`没有被`#include`d，某人可以在 C89 中定义为他们想要的任何东西。

在 C++ 中，这是非法的；wchar_t 是该语言中的关键字。

* * *

至于您引用的多字节函数，它们似乎是 C89 的一部分。第 7.10.7 节 [多字节字符函数] 定义了`mblen`, `mbtowc`,`wctomb`和 7.10.8 [多字节字符串函数] 定义了`mbstowcs`, 和`wcstombs`（都在 中`<stdlib.h>`）。当然请注意，因为 C89 没有这些功能`const`的`const`-qualified 版本不可用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T17:14:02.887

`wchar_t`是 ANSI C (1989) 的一部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T17:17:54.667

`wchar_t`完全符合 C89 标准。在我的版本中，`wchar_t`在 Kernighan 和 Ritchie 书中的第 A2.5.2 节中提到。

# php - str_replace() 不适用于数组

> ID：16020937
> 
> 赞同：-4
> 
> 时间：2013-04-15T17:13:12.713
> 
> 标签：php, mysql, sql

我有一个这样的数组：

```
array(46) 
{ 
[0]=> array(4) { ["category"]=> string(21) "Media/news/publishing" ["name"]=> string(20) "Cosmopolitan Armenia" ["id"]=> string(15) "146307748762264" ["created_time"]=> string(24) "2013-03-20T14:40:43+0000" } 
[1]=> array(4) { ["category"]=> string(17) "Telecommunication" ["name"]=> string(5) "Zangi" ["id"]=> string(15) "386291674718829" ["created_time"]=> string(24) "2013-03-20T11:07:46+0000" } 
[2]=> array(4) { ["category"]=> string(13) "Musician/band" ["name"]=> string(11) "Ray Charles" ["id"]=> string(12) "430894850091" ["created_time"]=> string(24) "2013-03-16T22:03:46+0000" } [3]=> array(4) { ["category"]=> string(4) "Cars" ["name"]=> string(13) "I'm In Like With You" ["id"]=> string(15) "447042531989769" ["created_time"]=> string(24) "2013-03-16T22:01:46+0000" } .......
} 
```

有谁知道为什么这个代码：

```
str_replace("'","\'",MY_ARRAY); 
```

...不取代`'`in `"I'm In Like With You"`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:23:41.187

假设您想递归地转义所有数组项......您的代码无法工作；[`str_replace()`](http://php.net/manual/en/function.str-replace.php)仅在字符串中替换。您可以使用[`array_walk()`](http://php.net/manual/en/function.array-walk.php)来有效地做到这一点：

在 php 5.3 及更高版本中（支持[匿名函数](http://php.net/manual/en/functions.anonymous.php)）：

```
array_walk($data, function(&$item, $key){
    array_walk( $item, function(&$item, $key){
        $item = str_replace("'","\'", $item);
    });
}); 
```

或使用[`foreach`循环](http://php.net/manual/en/control-structures.foreach.php)：

```
foreach( $data as &$v1){
    foreach( $v1 as &$v2){
        $v2 = str_replace("'","\'", $v2);
    }
} 
```

但是，我仍然觉得您需要它来转义 MySQL 查询的数据，您应该使用类似[`mysqli_real_escape_string`](http://php.net/manual/en/function.mysqli-real-escape-string.php),的函数[`mysql_real_escape_string`](http://php.net/manual/en/function.mysql-real-escape-string.php)，[`PDO::quote()`](http://php.net/manual/en/pdo.quote.php)或者只是[在准备好的语句中使用占位符](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers#Running_Statements_With_Parameters)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T17:23:33.893

使用`str_replace`，您需要遍历数组并对`str_replace`每个值执行 a 。

例如这样的：

```
foreach( $yourArray as $key => $value)
{
    $yourArray[ $key ]['name'] = str_replace("'", "\'", $value);
} 
```

阅读更多关于“Foreach”的信息[`here`](http://php.net/manual/en/control-structures.foreach.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T17:21:58.117

您不能直接在数组中替换。您可以将数组用作“查找此内容”和“替换为”文本，但您正在操作的内容必须是纯字符串。

您必须在数组上循环，然后对每个字符串执行替换操作：

```
foreach($array as $key => $element) {
    $array[$key] = str_replace(..., ..., $element);
} 
```

鉴于您的数组中有多个单独的字符串，您必须处理每个字符串：

```
 $array[$key]['name'] = str_replace(....,...., $element); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T17:25:54.790

你可以试试这个简单的递归函数

例子

```
$object = new stdClass();
$object->game = "GOW'4";
$object->whoami = "Peehaa'";

$array = array(
        "nice'kkk",
        "Fish" => array(
                "X" => "one'one",
                "obj" => $object
        )
);

print_r(str_replace_recursive("'", "*", $array)); 
```

输出

```
Array
(
    [0] => nice*kkk
    [Fish] => Array
        (
            [X] => one*one
            [obj] => stdClass Object
                (
                    [game] => GOW*4
                    [whoami] => Peehaa*
                )

        )

) 
```

使用的功能

```
function str_replace_recursive($search, $replace, $subject) {
    $result = null;
    if (is_array($subject)) {
        $result = array();
        foreach ( $subject as $k => $var ) {
            $result[$k] = str_replace_recursive($search, $replace, $var);
        }
    } elseif (is_object($subject)) {
        $result = clone $subject;
        foreach ( $subject as $k => $var ) {
            $result->{$k} = str_replace_recursive($search, $replace, $var);
        }
    } else {
        $result = str_replace($search, $replace, $subject);
    }

    return $result;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-15T17:27:02.963

您可以在您的内部循环`array`，然后根据`$data`需要使用

```
$array = array(array('category' => 'Media/news/publishing', 
           'name' => 'Cosmopolitan Armenia' ,
           'id' => '146307748762264',
           'created_time' => '2013-03-20T14:40:43+0000'),
 array( 
           'category' => 'Telecommunication',
           'name' => 'Zangi',
           'id' => '386291674718829',
           'created_time' => '2013-03-20T11:07:46+0000'), 
 array(  
           'category' => 'Musician/band',
           'name' => 'Ray Charles',
           'id' => '430894850091',
           'created_time' => '2013-03-16T22:03:46+0000'),
 array( 
           'category' => 'Cars' ,
           'name' => 'I'm In Like With You',
           'id' => '447042531989769',
           'created_time' => '2013-03-16T22:01:46+0000')
);

foreach($array as $arr)
{
    $data = str_replace('\'', '\\\'', $arr);
    echo $data['name'] . '<br>';
} 
```

**这将输出**

```
Cosmopolitan Armenia
Zangi
Ray Charles
I\'m In Like With You 
```

您可以根据需要更改`str_replace`功能您只需更改第二个参数

# .net - 从 AutoSys 运行 .NET 应用程序时出错

> ID：16020938
> 
> 赞同：0
> 
> 时间：2013-04-15T17:13:19.350
> 
> 标签：.net, ibm-mq, autosys

我有一个在安装了 AutoSys 和 WebSphere MQ 的 Windows Server 2008 上运行的 .NET 控制台应用程序（该应用程序用于向 WebSphere MQ 发送消息）。

我正在尝试设置一个 AutoSys 作业，它将每 10 分钟调用一次控制台应用程序。

如果我登录到服务器并使用命令行运行应用程序，则应用程序可以正常工作。

但是，如果我使用 AutoSys 运行应用程序，则会收到以下错误：

```
The type initializer for 'IBM.WMQ.MQQueueManager' threw an exception.

StackTrace =    at IBM.WMQ.MQQueueManager..ctor(String queueManagerName, Hashtable properties)
   at SendMessage.QueueJobExecutionItem.ExecuteQueueJob(QueueInfo queueInfo, CrmInfo crmInfo, LogFileInfo logFileInfo, List`1 entityList) in C:\SendMessage\QueueJobExecutionItem.cs:line 36
   at SendMessage.Program.StartLoad() in C:\SendMessage\Program.cs:line 75
   at SendMessage.Program.Main(String[] args) in C:\SendMessage\Program.cs:line 111

Error Message InnerException = The type initializer for 'IBM.WMQ.MQQueueManager' threw an exception.

InnerException StackTrace =    at IBM.WMQ.MQQueueManager..ctor(String queueManagerName, Hashtable properties)
   at SendMessage.QueueJobExecutionItem.ExecuteQueueJob(QueueInfo queueInfo, CrmInfo crmInfo, LogFileInfo logFileInfo, List`1 entityList) in C:\SendMessage\QueueJobExecutionItem.cs:line 36
   at SendMessage.Program.StartLoad() in C:\SendMessage\Program.cs:line 75
   at SendMessage.Program.Main(String[] args) in C:\SendMessage\Program.cs:line 111

InnerException Source = amqmdnet

Error Message InnerException = Exception has been thrown by the target of an invocation.

InnerException StackTrace =    at System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean& canBeCached, RuntimeMethodHandleInternal& ctor, Boolean& bNeedSecurityCheck)
   at System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache)
   at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean skipVisibilityChecks, Boolean skipCheckThis, Boolean fillCache)
   at System.Activator.CreateInstance(Type type, Boolean nonPublic)
   at System.RuntimeType.CreateInstanceImpl(BindingFlags bindingAttr, Binder binder, Object[] args, CultureInfo culture, Object[] activationAttributes)
   at System.Activator.CreateInstance(Type type, BindingFlags bindingAttr, Binder binder, Object[] args, CultureInfo culture)
   at System.RuntimeType.InvokeMember(String name, BindingFlags bindingFlags, Binder binder, Object target, Object[] providedArgs, ParameterModifier[] modifiers, CultureInfo culture, String[] namedParams)
   at IBM.WMQ.CommonServices.CreateCommonServices()
   at IBM.WMQ.CommonServices.TraceConstructor(String objectId, String sccsid)
   at IBM.WMQ.Nmqi.NmqiEnvironment..ctor(NmqiPropertyHandler nmqiPropertyHandler)
   at IBM.WMQ.Nmqi.NmqiFactory.GetInstance(NmqiPropertyHandler properties)
   at IBM.WMQ.MQQueueManager..cctor()

InnerException Source = mscorlib

Error Message InnerException = An attempt was made to load a program with an incorrect format. (Exception from HRESULT: 0x8007000B)

InnerException StackTrace =    at IBM.WMQ.MQCommonServices.xcsInitialize(UInt16 scope, UInt16 attributes, Byte[] charName, Byte[] charPrefix, xcsHPOOL& hPool)
   at IBM.WMQ.MQCommonServices.Initialize()

InnerException Source = amqmdxcs 
```

我在登录服务器并运行 AutoSys 时使用的是同一用户，因此我希望应用程序以相同的方式运行。

我想知道以前是否有人遇到过这个问题，或者我在 AutoSys 中是否可能缺少任何配置/参数等，这会使应用程序以与登录服务器时相同的方式工作。

我希望这是有道理的

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T08:26:12.270

异常显示`An attempt was made to load a program with an incorrect format.`并指向`amqmdxcs.dll`这可能是因为您的应用程序是 64 位但它正在尝试加载 32 位版本的 WMQ 库，或者您的应用程序是 32 位但正在尝试加载 64 位版本的 WMQ 库。您需要检查 AutoSys 的 bittage 并设置加载适当 WMQ 库的路径。

# javascript - Jquery fill object like array

> ID：16020939
> 
> 赞同：1
> 
> 时间：2013-04-15T17:13:24.310
> 
> 标签：javascript, jquery, object

This should be pretty easy but I'm a little confused here. I want to fill this object:

```
var obj = { 2:some1, 14:some2, three:some3, XX:some4, five:some5 }; 
```

but in the start I have this:

```
var obj = {}; 
```

I´m making a for but I don't know how to add, I was using push(), but is not working. Any help?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T17:17:45.230

You can't `.push()` into a javascript OBJECT, since it uses custom keys instead of index. The way of doing this is pretty much like this:

```
var obj = {};

for (var k = 0; k<10; k++) {
    obj['customkey'+k] = 'some'+k;
} 
```

This would return:

```
obj {
    customkey0 : 'some0',
    customkey1 : 'some1',
    customkey2 : 'some2',
    ...
} 
```

Keep in mind, an array: `['some1','some2']` is basicly like and object: `{ 0 : 'some1', 1 : 'some2' }` Where an object replaces the "index" (0,1,etc) by a STRING key. Hope this helps.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T17:15:01.800

`push()` is for use in arrays, but you're creating a object.

You can add properties to an object in a few different ways:

```
obj.one = some1; 
```

or

```
obj['one'] = some1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T17:19:43.860

I would write a simple function like this:

```
 function pushVal(obj, value) {
     var index = Object.size(obj);
     //index is modified to be a string.
     obj[index] = value;
 } 
```

Then in your code, when you want to add values to an object you can simply call:

```
 for(var i=0; i<someArray.length; i++) {
      pushVal(obj, someArray[i]);
   } 
```

For info on the size function I used, see [here](https://stackoverflow.com/questions/5223/length-of-javascript-object-ie-associative-array). Note, it is possible to use the index from the for loop, however, if you wanted to add multiple arrays to this one object, my method prevents conflicting indices.

**EDIT**

Seeing that you changed your keys in your questions example, in order to create the object, you can use the following:

```
function pushVal(obj, value, key) {
     //index is modified to be a string.
     obj[key] = value;
 }

 or 

 obj[key] = value; 
```

I'm not sure how you determine your key value, so without that information, I can't write a solution to recreate the object, (as is, they appear random).

# mysql - 有没有办法获取所有国家、州和城市的 mysql 数据？（转储文件）

> ID：16020942
> 
> 赞同：17
> 
> 时间：2013-04-15T17:13:41.353
> 
> 标签：mysql

我正在做一个项目，我需要一个国家、州和城市列表的数据库或 MySQL 表。

我需要一个免费的。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-15T17:20:26.460

这个问题在 StackOverflow 上已经回答过很多次了，但是这里有几个资源：

*   [http://www.maxmind.com/en/worldcities](http://www.maxmind.com/en/worldcities)
*   [http://dev.maxmind.com/geoip/geolite](http://dev.maxmind.com/geoip/geolite)
*   [http://www.geodatasource.com/cities-free.html](http://www.geodatasource.com/cities-free.html)
*   [http://www.geonames.org/export/](http://www.geonames.org/export/)

用于 sql 文件的 Github [https://github.com/hiiamrohit/Countries-States-Cities-database](https://github.com/hiiamrohit/Countries-States-Cities-database)

* * *

**编辑：**

用户@Juan Escobar 在编辑中建议此类数据的另一个来源是 [http://dev.mysql.com/doc/world-setup/en/index.html](http://dev.mysql.com/doc/world-setup/en/index.html) 但这只是 MySQL.com 提供的示例数据库。我不认为它打算是全面的或最新的。

该数据库来自[芬兰统计局](http://tilastokeskus.fi/tup/kvportaali/kv_tiedonlahteet_en.html)的可用数据，因此可能是当前数据的更好来源。

# drupal - Drupal 7 上的功能模块和块

> ID：16020943
> 
> 赞同：-1
> 
> 时间：2013-04-15T17:13:41.790
> 
> 标签：drupal, drupal-7, migration, drupal-blocks

我正在尝试在我的 Drupal 7 站点之一上实现功能模块以管理块。不过我有几个问题。1st，当您在源站点上创建新功能时，您是否将新创建的功能放在您的模块目录中并在源服务器和目标服务器上启用它，或者只是目标服务器？

另外，我想知道当您尝试使用测试服务器和实时服务器管理块时，当实时服务器是测试的克隆时，它是如何工作的。换句话说，我们创建了一个测试服务器，构建了我们的站点，包括内容和块，当它完成后，我们克隆测试以上线。然后我们在测试中安装 features 模块并创建一个包含我们所有自定义块的功能。当我这样做并将该功能移动到实时服务器并启用它时，它立即处于覆盖状态。功能是否仅用于将新块从一个站点移动到另一个站点，而不是用于管理两个服务器上已经存在的块？我是否应该在测试服务器上创建包含所有块的功能，然后删除实时服务器上的块，然后在实时启用该功能，这将在实时填充块。我'

谢谢

更新：好的，我在这里拉头发。同样，我有两个站点，一个源和一个目的地。目标是源的精确克隆。我想通过功能管理两个站点上的三个块。所以，在源站点上，我决定先用一个块进行测试。我首先编辑了该块，使其与目标站点上的块不同。然后，我创建了包含块和块设置的功能（顺便说一下，我使用 Features Extra 来完成此操作），然后我将该功能放在目标站点上，当我激活该功能时，该功能实际上并未被覆盖状态和我对源站点上的块所做的更改，显示在目标站点上没问题。然而，如果我现在尝试将其他两个块添加到源站点上的此功能并重新创建并将其导出到目标站点，则目标站点上的功能现在处于覆盖状态，这很好，但无论有多少有时我“恢复”该功能以将块从 dB 中取出并放入代码中，它不会脱离被覆盖的状态。我已经刷新了缓存，禁用了该功能并重新启用，并尝试恢复，但它被卡住了，我没有看到我对其他两个块所做的更改。然后我想也许是因为我一次做三个街区。然后我自己拿了第二个块并为其创建了一个功能并将其放在目标站点上，它卡在了覆盖状态。3号区块也是如此。第一个块本身很好，不会陷入覆盖状态。它只是第 2 和第 3 块。据我所知，所有三个块都是以完全相同的方式创建的，并且在角色、页面等方面没有任何不同的设置。我肯定被这个难住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T10:10:30.810

评论不允许这么多日志帖子，所以发布作为答案。

如果没有确切的问题，我不能说太多。但这就是功能的工作方式。您必须在源站点中进行更改。然后创建该更改的功能。现在在目标站点上，您必须启用该功能。如果您已经在目标站点中进行了更改，那么功能将被覆盖，您将其还原并获取更改。

正如您所说，您在功能中添加了另外两个块，但您没有更改这些块中的任何内容，因此它们已经在目标站点中。这就是为什么功能处于被覆盖状态。当您还原时它确实发生了变化，但有时它不会更改（管理员/结构/功能/）上的状态。

我不知道您的确切要求，但我认为您应该更改源站点中的*更改*，然后在功能中选择它们并在目标站点上启用。

# asp.net-mvc - ASP.NET MVC。部分视图的特定 URL

> ID：16020944
> 
> 赞同：2
> 
> 时间：2013-04-15T17:13:53.570
> 
> 标签：asp.net-mvc, url, partial-views

我是 ASP.NET MVC 的新手。所以我的问题似乎有点幼稚。无论如何，我花了几个小时搜索有关我的主题的任何信息，但没有结果。因此，我将非常感谢您的帮助。

所以这是我的问题。

在我的索引视图中，我有一个 div，我根据用户单击的链接放置不同部分视图的内容。

这是代码。索引.cshtml：

```
<div id="dynamicContent"></div>

<a href="#" onclick="@String.Format("updateContent('{0}');", Url.Action("DynamicContent", "Agent", new {name = "AboutCbsrAgent"}))">About Cbsr Agent</a>

<a href="#" onclick="@String.Format("updateContent('{0}');", Url.Action("DynamicContent", "Agent", new {name = "ApplicationAreasOfCBSR"}))">Application Areas Of CBSR</a> 
```

JavaScript：

```
function updateContent(contentUrl) {

    $.ajax({
        url: contentUrl,
        type: "GET",
        success: function (data) {
            $('#dynamicContent').html(data);
        }
    });
} 
```

控制器：

```
public class AgentController : Controller
{
    //Index action
    public ActionResult DynamicContent(string name)
    {
        return PartialView(String.Format("Partial/" + name));
    }
} 
```

所以，一切正常。当用户单击链接时，适当的局部视图正在加载到 div 中。问题是，在浏览器的地址栏中，我得到以下 URL：example.com/Agent# 无论我点击什么链接。

所以我的问题是：有没有办法为每个部分视图生成唯一的 URL？例如：`example.com/agent/partial/AboutCbsrAgent`。是否有可能使当我将此链接粘贴到浏览器的地址栏中时，将显示整个视图和 NECESSARY 部分视图？

预先感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T20:02:47.030

您可以在`AgentController`, 中为两个 URL 创建两个单独的操作，并传递要呈现的局部视图的名称。就像是：

```
public ActionResult AboutCbsrAgent() 
{
    ViewBag.MyPartialView = "AboutCbsrAgent";
    ....

    return View("Index");
} 
```

然后在你的`Index.cshtml`：

```
<div id="dynamicContent">
    @Html.Partial(ViewBag.MyPartialView)
</div> 
```

您可能需要调整路径，但您明白了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T20:09:49.937

如果您想避免`#`在您的网址中使用：

```
<a href="javascript:void(0);" onclick="@String.Format("updateContent('{0}');", Url.Action("DynamicContent", "Agent", new {name = "AboutCbsrAgent"}))">About Cbsr Agent</a> 
```

如果你知道你的用户主要是FF、Chrome、IE9<，或者你不在乎[浏览器不支持](http://caniuse.com/#search=history)，你可以使用`history.pushState`

尽管如果用户重新访问该 url（使用`pushState`） ，您仍然必须找到加载正确内容的解决方案

# dropbox - 添加了文件上的 Dropbox 网络挂钩？

> ID：16020948
> 
> 赞同：5
> 
> 时间：2013-04-15T17:14:07.890
> 
> 标签：dropbox, dropbox-api, webhooks

我的应用程序目前使用与[Dropbox API](https://www.dropbox.com/developers/core)的集成。其目的是允许客户端将某些文档放入目录中的专用文件夹中`Apps/My_App_Name/`，然后我的应用程序会定期轮询该文件夹以查看是否添加了任何内容，如果找到文档，它将自动将其移动到客户端的文档管理中我的应用程序中的区域。

目前大约有 300 名用户（并且还在增加）通过这种方式将他们的 Dropbox 帐户与我同步。我相信我在这里做的事情效率很低，但基本上我的应用程序会轮询所有 300 个帐户以查看是否添加了文件。这种情况每 10 分钟发生一次，但随着添加更多帐户以防止重叠，我不得不扩大此间隔。每次我轮询所有帐户时，通常我只会在 300 个有新文件的人中找到 1 或 2 个。

因此，我的问题是.. Dropbox API 中是否有一种方法可以仅在客户端将文件添加到该 Dropbox 文件夹时发布 Web Hook 或某种通知？然后，这可能会触发我的应用程序仅轮询该帐户并为我节省大量资源。

**附加信息：**

*   平台：ASP.NET C#
*   包装：[SharpBox](http://sharpbox.codeplex.com/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T21:21:38.260

我联系了 Dropbox，他们确认目前（2013 年 3 月 15 日）他们没有用于用户上传文件的网络挂钩或通知系统。然而，他们确实表示这是他们希望在未来添加的内容。

**2014 年 2 月 19 日更新**

好消息！Dropbox 最近发布了 WebHooks：

> 如果您有兴趣帮助我们，只需点击填写您的信息，我们将与您联系：
> 
> [https://dropboxapi.wufoo.com/forms/dropbox-webhooks-api-beta-feedback-contact-info](https://dropboxapi.wufoo.com/forms/dropbox-webhooks-api-beta-feedback-contact-info)
> 
> 快乐 Dropboxing！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-14T17:38:34.983

Dropbox 现在提供 webhook，以便您可以在添加文件时收到通知

[https://www.dropbox.com/developers/blog/90/announcing-dropbox-webhooks](https://www.dropbox.com/developers/blog/90/announcing-dropbox-webhooks)

# php - 遍历 SQL 数据，然后将查询结果发布到适当的输入字段中

> ID：16020954
> 
> 赞同：0
> 
> 时间：2013-04-15T17:14:34.187
> 
> 标签：php, jquery, sql

我在这里尝试做的是我有 5 个输入字段，每个输入字段都有自己的 Lane-1、Lane-2、Poly-1、Poly-2、Poly-3 总权重，将由数据库中的内容显示...我可以使用 5 个不同的 JS 函数和 5 个单独的 php 文件以及与该车道类型专门相关的 SQL 语句来做到这一点，但如果可能的话，我宁愿在一个结构或一个文件和一个 JS 函数中完成这一切? 有什么想法可以解决这个问题吗？我让它只适用于 SQL 语句的“else”部分，但我需要获取与其他车道类型（lead-2、poly-1 等）有关的其他数据提前谢谢！

我什至不能说我做的这些都是对的，所以请随意责备我。

HTML

```
<body onload="getLaneWeight();">
<form id="Warehouse_Worksheet" name="Warehouse_Worksheet">
<table align="center">
        <tbody>
            <tr>
                <th>
                    Lane Types
                </th>
                <th>
                    Total Weight
                </th>
            </tr>
            <tr>
                <td>
                    Lead 1
                </td>
                <td>
                    <input type="text" name="Lead-1" readonly="readonly" />
                </td>
            </tr>
            <tr>
                <td>
                    Lead 2
                </td>
                <td>
                    <input type="text" name="Lead-2" readonly="readonly" />
                </td>
            </tr>
            <tr>
                <td>
                    Poly 1
                </td>
                <td>
                    <input type="text" name="Poly-1" readonly="readonly" />
                </td>
            </tr>
            <tr>
                <td>
                    Poly 2
                </td>
                <td>
                    <input type="text" name="Poly-2" readonly="readonly" />
                </td>
            </tr>
            <tr>
                <td>
                    Poly 3
                </td>
                <td>
                    <input type="text" name="Poly-3" readonly="readonly" />
                </td>
            </tr>
        </tbody>
        </table>
  </form>
  </body> 
```

JS文件

```
//Populate Lane Type Weight Table
function getLaneWeight() {
$.ajax({
    type: 'GET',
    url: './php/getLaneWeight.php',
    data: 'lane_name=Lead-1',
    success: function (mydata) {
        document.forms['Warehouse_Worksheet'].elements['Lead-1'].value = mydata;
    },
    error: function () {

    },
    complete: function () {
        getLead2();//Call next Lane Type
    }
});
};
//Set Next Lane Weight
function getLead2() {
$.ajax({
    type: 'GET',
    url: './php/getLaneWeight.php',
    data: 'lane_name=Lead-2',
    success: function (mydata) {
        document.forms['Warehouse_Worksheet'].elements['Lead-2'].value = mydata;
        //alert(document.forms['Warehouse_Worksheet'].elements['Lead-1'].value);
    },
    error: function () {

    },
    complete: function () {
        //getPoly1();//Call next Lane Type
    }
});
}; 
```

PHP/SQL

```
if(isset ($_GET['Poly-2'])){
    $sql="SELECT SUM(weight)
        FROM bundle_lanes
        WHERE lane_name = 'Poly-3'";
}else if(isset ($_GET['Poly-1'])){
    $sql="SELECT SUM(weight)
        FROM bundle_lanes
        WHERE lane_name = 'Poly-2'";
}else if(isset ($_GET['Lead-2'])){
    $sql="SELECT SUM(weight)
        FROM bundle_lanes
        WHERE lane_name = 'Poly-1'";
}else if(isset ($_GET['Lead-1'])){
    $sql="SELECT SUM(weight)
        FROM bundle_lanes
        WHERE lane_name = 'Lead-2'";
}else{
     $sql="SELECT SUM(weight)
        FROM bundle_lanes
        WHERE lane_name = 'Lead-1'";
}

$result = mysql_query($sql) or die ('Error'.mysql_error());

while ($data = mysql_fetch_row($result)) {
    $weight = $data[0];
    echo $weight;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:40:25.377

你比创建一个像下面这样的函数

如果您的 php 代码肯定会得到您想要的数据，那么您可以立即将其插入到下面的函数中。如果您想存储所有 5 个而不是使用 for 循环和数组在 php 中存储每个名称，例如

```
 $myarray=('string1','string2');
   for($i=0;i<$myarray.length;i++){
       sqlQuery($myarray[i]);
   }
   function sqlQuery($lane_name){
       $sql
       $sql="SELECT SUM(weight)
         FROM bundle_lanes
         WHERE lane_name = '".$lane_name."'";
       $result=.......
       //check if data was stored.
       echo(<!-- new html code-->);
   } 
```

这将存储所有 5 个字段。如果您只想要其中一个，最好使用开关盒。如果您的 php 在同一个文件中，则只需使用 php 使用 echo 生成 html。您可以插入这样设置的变量 - echo("some text".$myvar."some more text"); 如果它是一个不同的文件，你需要在 javascript 中使用 ajax 来接收数据并使用开关或 if else case。例如

```
 if(response=='my response'){
    document.getElementById('my textbox').innerHTML(....);
    } 
```

我的 javascript 可能不准确，但我希望你明白

# c# - MVC 4 - 未找到给出 404 的注销控制器操作

> ID：16020955
> 
> 赞同：17
> 
> 时间：2013-04-15T17:14:35.400
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, http-status-code-404

我刚刚结束了一个大学项目，我不确定我是否已经盯着我的电脑太久并且遗漏了一些明显的东西，但是当我尝试注销用户时，我得到一个 404 不是找到 URL /Account/LogOff。

我有一个导航栏，根据用户是登录/注销显示登录/注销：

```
<div class="nav-collapse collapse">
    <ul class="nav pull-right">
        <li class="dropdown" id="dropdown-login-div">
            @if (!Request.IsAuthenticated)
            {
                <a class="dropdown-toggle" href="#" data-toggle="dropdown">Sign In <strong class="caret"></strong></a>
            }
            else
            {
                @Html.ActionLink("Log Off", "LogOff", "Account")
            }
            <div class="dropdown-menu" id="dropdown-login">
                @Html.Partial("~/Views/Account/_LoginPartial.cshtml", new ViewDataDictionary<LetLord.Models.LoginModel>())
            </div>
        </li>
    </ul>
</div> 
```

在我的帐户控制器中，Internet 模板附带的默认注销操作：

```
[HttpPost]
[ValidateAntiForgeryToken]
public ActionResult LogOff()
{
    WebSecurity.Logout();

    return View("Index");
} 
```

有人可以告诉我为什么会发生这种情况 - 在我把笔记本电脑扔到墙上之前。干杯。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-04-15T17:16:22.357

您使用链接（`<a/>`标签）注销，当用户单击它时会导致**HTTP GET请求，但您的操作仅限于服务****POST**请求（因为它用`[HttpPost]`属性装饰）。

您要么需要将链接放入表单并生成 POST 请求，要么从您的操作中删除`[HttpPost]`和`[ValidateAntiForgeryToken]`（归功于 GalacticCowboy）。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2013-04-15T20:54:44.723

由于注销会修改服务器状态，因此我不会删除 [HttpPost] 和 [ValidateAntiForgeryToken] 而是将链接（锚标记）替换为以下内容

```
@using (Html.BeginForm("Log Out", "Account", FormMethod.Post,
 new { id = "logoutForm" }))
{

    @Html.AntiForgeryToken()
    <a href="javascript:document.getElementById('logoutForm').submit()">Log Out</a>

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-18T19:10:28.087

我在旧版应用程序上遇到了这个问题。我修复它的方法是检测提供的返回 URL 何时为“/Account/LogOff”并采取相应措施。从“AccountController.cs”文件中，“登录”方法：

```
if (returnUrl == "/Account/LogOff")
    {
        return this.RedirectToLocal(null);
    }
    else
    {
        return this.RedirectToLocal(returnUrl);  
    } 
```

# sql - 将 SUM() 与 sql 中的多个表一起使用

> ID：16020958
> 
> 赞同：0
> 
> 时间：2013-04-15T17:14:44.407
> 
> 标签：sql

我正在尝试编写一个查询，该查询将使用 sum 函数将 1 列中的所有值相加，然后除以另一个表中的元组数。出于某种原因，当我自己运行总和查询时，我得到了正确的数字，但是当我在查询中使用它时，值是错误的。

这就是我试图做的，但数字是错误的。

```
select (sum(adonated) / count(p.pid)) as "Amount donated per Child"
from tsponsors s, player p; 
```

我发现问题在于总和。下面返回 650,000 当它应该返回 25000

```
select (sum(adonated)) as "Amount donated per Child"
from tsponsors s, player p; 
```

如果我从玩家 p 中移除它，它会得到正确的数量。但是我需要玩家表来获取玩家数量。

我有 3 个与此查询相关的表。player(pid, tid(fk)) team(tid) tsponsors(tid(fk), adonated, sid(fk)) 这是一个连接表

我想要得到的是捐赠给每个团队的所有金额的总和（捐赠），然后将其除以数据库计数（pid）中的玩家数量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:17:36.123

尝试

```
select sum(s.adonated) / (SELECT count(p.pid) FROM player p) 
 as "Amount donated per Child"
from tsponsors s; 
```

您的原始查询在没有任何条件的情况下连接 2 个表，这会导致交叉连接。

**更新**

```
SELECT ts.tid, SUM(ts.adonated),num_plyr
FROM tsponsors ts 
INNER JOIN 
 (
   SELECT tid, COUNT(pid) as num_plyr
   FROM player
   GROUP BY tid
)a ON (a.tid = ts.tid)
GROUP BY ts.tid,num_plyr 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T19:36:37.940

我猜您的赞助商正在向团队捐款。然后，您想知道赞助团队中每个孩子的捐款比例。

然后你需要这样的东西：

```
SELECT p.tid,(SUM(COALESCE(s.adonated,0)) / COUNT(p.pid)) AS "Amount donated per Child"
FROM player p 
LEFT OUTER JOIN tsponsors s ON s.tid=p.tid
GROUP BY p.tid 
```

如果团队没有赞助商，我还使用了 a`LEFT OUTER JOIN`来显示 0$。

# java - 将数据从 JSP 页面下载到 Excel 时如何更改为 Excel 格式？

> ID：16020959
> 
> 赞同：2
> 
> 时间：2013-04-15T17:14:47.563
> 
> 标签：java, excel, jsp, servlets

我在 servlet 中获取结果集，然后转发到 JSP 页面，在该页面中我将所有数据从结果集放到表中，然后将输出到 excel 文件。在我的 JSP 页面的顶部，我有

```
response.setContentType("application/vnd.ms-excel;");

filename="Report";
filename+=".xls";
response.addHeader("Content-Disposition","attachment; filename="+filename); 
```

问题是它在 Excel 表中下载数据，但默认为网页，所以每当我下载数据时，我必须手动将另存为类型更改为 Excel 工作簿。而且当我下载到 excel 时，它会警告我文件不是 XLS 格式，无论你是否想打开它。

每当我在 excel 中下载数据时，我有什么办法可以做，它会在另存为类型时显示 Excel 工作簿？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T09:03:26.587

```
Use response.setHeader() instead of response.addHeader()
response.setContentType("application/vnd.ms-excel");
response.setHeader("Content-Disposition", "attachment; filename=filename.xls"); 
```

# c++ - 在 C++ 中分配到右移意味着什么？

> ID：16020960
> 
> 赞同：-1
> 
> 时间：2013-04-15T17:14:53.220
> 
> 标签：c++, operators, bit-shift

我遇到了一些令人费解的代码：

```
int mask = someFunction();
mask>>=1; // What does this line do? 
```

我以前从未见过这种模式，并想了解它在做什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-15T17:15:49.583

与 相同`mask = mask >> 1`。与所有带有`=`.

# scala - 在 Scala 中使用 Future 和 Promise 取消

> ID：16020964
> 
> 赞同：11
> 
> 时间：2013-04-15T17:15:03.003
> 
> 标签：scala, promise, akka, future, cancellation

这是[我之前的问题](https://stackoverflow.com/questions/16009837/how-to-cancel-future-in-scala)的后续。

假设我有一个任务，它执行一个可*中断*的阻塞调用。我想将它作为a*运行*`Future`并使用.*`failure``Promise`*

 *我希望*取消*工作如下：

*   如果在任务完成*之前**取消*任务，我希望任务“立即”完成，如果它已经开始，则中断阻塞调用，我希望调用.*`Future``onFailure`*

**   如果在任务完成*后**取消*任务，我想得到一个状态，说明取消失败，因为任务已经完成。* 

 **是否有意义？是否可以在 Scala 中实现？有没有这种实现的例子？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-16T00:43:12.523

scala.concurrent.Future 是只读的，因此一个读者不能为其他读者搞砸事情。

看起来你应该能够实现你想要的如下：

```
def cancellableFuture[T](fun: Future[T] => T)(implicit ex: ExecutionContext): (Future[T], () => Boolean) = {
  val p = Promise[T]()
  val f = p.future
  p tryCompleteWith Future(fun(f))
  (f, () => p.tryFailure(new CancellationException))
}

val (f, cancel) = cancellableFuture( future => {
  while(!future.isCompleted) continueCalculation // isCompleted acts as our interrupted-flag

  result  // when we're done, return some result
})

val wasCancelled = cancel() // cancels the Future (sets its result to be a CancellationException conditionally) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-04-17T02:49:30.670

这是 Victor 的代码的可中断版本，根据他的评论（Victor，如果我误解了，请纠正我）。

```
object CancellableFuture extends App {

  def interruptableFuture[T](fun: () => T)(implicit ex: ExecutionContext): (Future[T], () => Boolean) = {
    val p = Promise[T]()
    val f = p.future
    val aref = new AtomicReference[Thread](null)
    p tryCompleteWith Future {
      val thread = Thread.currentThread
      aref.synchronized { aref.set(thread) }
      try fun() finally {
        val wasInterrupted = (aref.synchronized { aref getAndSet null }) ne thread
        //Deal with interrupted flag of this thread in desired
      }
    }

    (f, () => {
      aref.synchronized { Option(aref getAndSet null) foreach { _.interrupt() } }
      p.tryFailure(new CancellationException)
    })
  }

  val (f, cancel) = interruptableFuture[Int] { () =>
    val latch = new CountDownLatch(1)

    latch.await(5, TimeUnit.SECONDS)    // Blocks for 5 sec, is interruptable
    println("latch timed out")

    42  // Completed
  }

  f.onFailure { case ex => println(ex.getClass) }
  f.onSuccess { case i => println(i) }

  Thread.sleep(6000)   // Set to less than 5000 to cancel

  val wasCancelled = cancel()

  println("wasCancelled: " + wasCancelled)
} 
```

输出`Thread.sleep(6000)`是：

```
latch timed out
42
wasCancelled: false 
```

输出`Thread.sleep(1000)`是：

```
wasCancelled: true
class java.util.concurrent.CancellationException 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-16T01:20:51.487

Twitter 的期货实施取消。看看这里：

[https://github.com/twitter/util/blob/master/util-core/src/main/scala/com/twitter/util/Future.scala](https://github.com/twitter/util/blob/master/util-core/src/main/scala/com/twitter/util/Future.scala)

第 563 行显示了负责此操作的抽象方法。Scala 的期货目前不支持取消。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-05-26T01:19:10.353

您可以使用 Monix 库而不是 Future

[https://monix.io](https://monix.io)***

# mod-rewrite - 重写 URL，使查询字符串在路径中

> ID：16020967
> 
> 赞同：0
> 
> 时间：2013-04-15T17:15:12.623
> 
> 标签：mod-rewrite

我正在尝试获取以下路径：`/faculty/index.php?PID=FirstLast&type=alpha`

重写为：`/faculty/FirstLast`

我是否正确假设将以下内容放入 .htaccess 中是可以接受的？

```
# Rewrite old URLS
RewriteCond %{QUERY_STRING} ^PID=([0-9a-zA-Z]*)$
RewriteRule ^/faculty/index.php$ /faculty/%1 [R=302,L] 
```

我可以丢弃任何其他查询字符串变量。我在 .htaccess 文件级别应用这些规则。这个项目是从旧系统到 Drupal 的迁移。

## 结果：

我的 .htaccess 看起来像

```
 # Rewrite old  URLS
  RewriteCond %{QUERY_STRING} PID=([0-9a-zA-Z]*)
  RewriteRule ^faculty/ /faculty/%1/? [R=301,L]

  RewriteCond %{QUERY_STRING} vidID=([0-9]*)
  RewriteRule ^videos/ /video/id/%1/? [R=301,L] 
```

我还发现了这个很棒的工具——一个 mod_rewrite 测试器 [http://htaccess.madewithlove.be/](http://htaccess.madewithlove.be/)

都好！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:07:50.783

试试这个：

```
RewriteRule ^faculty/index.php$ /faculty/%1? [R=302,L] 
```

前导斜杠不在规则中测试的 URI 路径中，因此也不能在正则表达式中。

由于除非在规则中创建新查询，否则查询会自动附加到替换 URL（未更改地传递），因此在使用规则时尾随问号`?`会擦除现有查询字符串。

# c# - 从 Java 调用点网中实例化的异步命名管道

> ID：16020978
> 
> 赞同：2
> 
> 时间：2013-04-15T17:15:44.120
> 
> 标签：c#, java, named-pipes, asynccallback

这个问题与我在 Java-C# 通信中提出的一个更早的、更一般的问题有关，但我认为它可能足够具体，可以单独提出（如果您认为我错了，请告诉我 - 我没有将那个标记为已回答但是，一旦我找出最有效的解决方案，就会回到它，这个问题是朝着那个方向迈出的一步......）。

我正在尝试使用命名管道在 C# 和 Java 之间进行通信。我的代码基于示例（由我之前问题的响应者指出）在 - [http://v01ver-howto.blogspot.co.uk/2010/04/howto-use-named-pipes-to-通信.html](http://v01ver-howto.blogspot.co.uk/2010/04/howto-use-named-pipes-to-communicate.html)

博客示例工作正常，但是因为在我自己的代码中我希望在我的 Java 程序连接到 C# 实例化管道时发生回调，所以我必须使用**异步**管道（博客中的示例没有这样做）。所以在实例化管道时，我的代码是 -

```
 instructionPipe = new NamedPipeServerStream("InstructionPipe", PipeDirection.InOut, 4,PipeTransmissionMode.Byte,PipeOptions.Asynchronous);
 instructionPipe.BeginWaitForConnection(new AsyncCallback(instructionPipeServerConnected), new Object()); 
```

..然后我写了一个回调，称为指令PipeServerConnected，做我想要的东西得到一个连接。

在 Java 端，再次按照博客中的示例，我在 Java 端设置了管道，方法是：

```
 instructionPipeJava=new RandomAccessFile("\\\\.\\pipe\\" + "InstructionPipe","rw"); 
```

但是，如果我尝试在 Java 中将一些测试数据写入此管道 -

```
 instructionPipeJava.write("This Is Test Text".getBytes()); 
```

并运行代码，然后代码停止并且无法越过这一行。如果我不使用异步管道，那么“instructionPipeJava”将能够将此文本写入管道就好了。但是我需要使用异步管道在 c# 端使用回调。

有没有人有什么建议？也许问题是我正在使用“new RandomAccessFile(..)”在 Java 中创建管道，并且有更合适的方法来连接到异步 C# 管道？

# regex - Perl 正则表达式用“g”选项替换意外运行两次

> ID：16020979
> 
> 赞同：1
> 
> 时间：2013-04-15T17:15:46.940
> 
> 标签：regex, perl, bash

所以我有一个文件夹，里面有更多文件夹。我想告诉一个朋友，他们应该，而不是每个文件夹都包含源文件，而应该只包含每个源文件，每个源文件都包含多个功能；

即代替这个：

```
src/
    load_of_functions/
        function1.py
        function2.py
        function3.py
        function4.py
    load_more_functions/
        function5.py
        function6.py
        function7.py
    even_more_funcitons/
        function9.py
        function10.py 
```

他们应该有这个：

```
src/
    load_of_functions.py
    load_more_functions.py
    even_more_funcitons.py 
```

所以我进入了目录，做了一个小班轮，把目录的名字写进电子邮件；

```
$ ls -l | grep ^d | awk '{print $9}' | perl -pe 's/(.*)/\1.py/g' 
```

`ls -l`获取文件和所有信息 `grep ^d`以仅保留目录 `awk '{print $9}'`以仅打印第 9 列 - 即目录名称`perl -pe 's/(.*)/\1.py/g'`并将“.py”添加到每一行。

当我这样做时，我得到了这个：

```
$ ls -l | grep ^d | awk '{print $9}' | perl -pe 's/(.*)/\1.py/g'
1.py.py
10.py.py
2.py.py
3.py.py
4.py.py
5.py.py
6.py.py
7.py.py
8.py.py
9.py.py 
```

我知道我不是在解析文件，而是逐行解析，因此`g`不需要 for global。所以我把它拿出来，它工作正常。

这可以。

但是为什么当我放入时它会替换两次`g`？这对我来说毫无意义！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T17:33:37.520

`.*`匹配零个或多个字符，这意味着它可以匹配零个字符。

假设你有

```
$_ = 'abc';
s/(.*)/\1.py/g; 
```

第一次搜索匹配项时，它匹配`substr($_,0,3)`，然后`/g`导致它检查从 pos 3 或更晚开始的另一个匹配项。

第二次搜索匹配时，它匹配`substr($_,3,0)`，然后`/g`导致它检查从 pos 3 或更高位置开始的另一个匹配。

第三次搜索匹配时，它匹配`substr($_,3,0)`。但是，引擎拒绝匹配相同的子字符串（定义为具有相同的起始位置和相同的长度）两次，因此它失败了。

解决方案：

```
s/(.*)/\1.py/;    # Poor
s/^(.*)/\1.py/g;  # Poor
s/^(.*)/\1.py/;   # Ok
s/$/.py/;         # Better
$_ .= '.py';      # Best if -l was present 
```

# c# - 当外键等于主键时在视图中显示数据

> ID：16020981
> 
> 赞同：0
> 
> 时间：2013-04-15T17:15:48.673
> 
> 标签：c#, entity-framework, asp.net-mvc-4, linq-to-entities

我有两个表 General_Info 和 Quantity。General_Info 有一个主键 QuoteID，并且与 Quantity 有一对多的关系 (FK = General_InfoQuotesID)。在我的详细信息视图中，我想显示 General_Info 中的特定行以及 Quantity 中的所有数据，其中 General_Info 中的 QuoteID 等于 General_InfoQuotesID。我目前对此的尝试设置了一个详细信息视图，以显示来自 General_Info 的指定行数据，并带有一个包含数量的部分视图。我遇到的问题是，它没有显示对应于 General_Info 中给定行的数量，而是只显示曾经添加的所有额外数量，而不管它对应的 General_Info 中的行如何。

这是我的模型类：

```
public partial class General_Info
{
    public General_Info()
    {
         this.Quantities = new HashSet<Quantity>();
    }

    public int QuoteID {get; set;}
    public System.DateTime Open_Quote {get; set;}
    public string Customer_Name {get; set;}
    ...
    public virtual ICollection<Quantity> Quantities {get; set;}
}

public partial class Quantity
{
    public int QuantityID {get; set;}
    public int AdditionalQty {get; set;}
    public int General_InfoQuotesID {get; set;} //fk

    //navigation property
    public virtual General_Info General_Info {get; set;}
} 
```

然后这是我的一些控制器：

```
[HttpGet]
public ActionResult Details(int id = 0)
{

    General_Info general_info = unitOfWork.General_Info_Repository.GetByID(id);
    return View(general_info);
}

[HttpGet]
[ChildActionOnly]
public ActionResult DQuantities()
{
    IEnumerable<Quantity>quantities = unitOfWork.Quantity_Repository.Get();

    // from quantities, select additionalQty when
    // General_Info.PK == Quantities.FK
    var qtys = from q in quantities
               where q.General_Info.QuoteID == q.General_InfoQuotesID
               select q.AdditionalQty; 
```

我不认为这行是对的，但是我在尝试将 linq 语句直接加载到局部视图中后尝试了它不起作用

```
 qtys = qtys.ToList(); 

    return PartialView(qtys);
} 
```

然后在我的 DQuantities 视图中（我没有包含详细信息视图，因为它已经正常工作，而且我认为这不是问题所在）

```
@model IEnumerable<SourceMvc.Quantity>

<table>
  <tr>
    <th>
      Additional Quantities:
    </th>
  </tr> 
```

很确定这个 foreach 语句只是针对来自 IEnumerable 的实际表数据，这就是为什么它打印所有数量而不是针对我的 linq 语句拾取的数据

```
@foreach (var item in Model) {
  <tr>
    <td>
      @Html.DisplayFor(modelItem => item.AdditionalQty)
    </td>
  </tr>
}
</table> 
```

提前感谢任何可以提供帮助的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T20:15:01.127

好的，我有一个有效的答案。

在我的控制器中，我将 DQuantities 更改为：

```
 [HttpGet]
    [ChildActionOnly]
    public ActionResult DQuantities(int id = 0)
    {
        General_Info general_info = unitOfWork.General_Info_Repository.GetByID(id);

        IEnumerable<Quantity> getQuantities = unitOfWork.Quantity_Repository.Get();

        IEnumerable<Quantity> qtys = getQuantities.Where(q => q.General_InfoQuotesID == general_info.QuoteID);

        return PartialView(qtys);   
    } 
```

然后在我的部分观点中：

```
@model IEnumerable<SourceMvc.Quantity>

<table>
  <tr>
    <th>
      @Html.DisplayNameFor(model => model.AdditionalQty)
    </th>
  </tr>

  @foreach ( var item in Model)
  {
    <tr>
      <td>
        @Html.DisplayFor(modelItem => item.AdditionalQty)
      </td>
    </tr>
  }

</table> 
```

# javascript - WoW API 和 underscore.js / javascript 'Unexpected reserved word' 问题

> ID：16020986
> 
> 赞同：0
> 
> 时间：2013-04-15T17:16:05.007
> 
> 标签：javascript, underscore.js

所以基本上我从 WoW（魔兽世界）API 得到一个 JSON 响应：

```
 this.url="http://eu.battle.net/api/wow/character/"+config.realm+"/"+config.charName+"fields=achievments&jsonp=?";

            this.template = config.template.html();

            $.when(this.fetch()).then(function(response){
                console.log( response );
                self.attachTemplate( response );
            });
        },

        attachTemplate: function( data ){

            var compTemplate = _.template( this.template, data );

            console.log( compTemplate );

            this.getContainer().append( compTemplate );
        }, 
```

我的模板如下所示：

```
<h1><%=name%></h1>
<h5 style="color: black;"><strong style="color: black;"><%= class %></strong> 
```

我越来越

```
Uncaught SyntaxError: Unexpected reserved word 
```

显然我不能使用“类”这个词，因为它是一个 js 保留字。API 响应对象有一个名为 class 的字段。除了创建中间变量之外，还有其他解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:34:49.010

您可以将您的对象包装`data`在另一个对象中，以解决由下划线使用引起的冲突`with`：

```
var compTemplate = _.template( this.template, { 'wrap': data } ); 
```

或者（可能是更好的方法），是`variable`为模板指定一个名称，该名称将告诉下划线**不要**使用`with`，并将自动将所有数据放入具有您指定名称的对象中。这种方法也会使性能*稍微*好一点：

```
var compTemplate = _.template( this.template, data, { 'variable': 'wrap' } ); 
```

然后在您的模板中，您必须为所有变量引用添加前缀`wrap.`

```
<h1><%= wrap.name %></h1>
<h5 style="color: black;"><strong style="color: black;"><%= wrap.class %></strong> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-05T08:26:04.237

我编写了一个完整的 JS 库来使用 WOW API。它位于此处：[https ://github.com/eduardm/wowjsapi](https://github.com/eduardm/wowjsapi)

# c# - 绑定列表到 GridView

> ID：16020987
> 
> 赞同：8
> 
> 时间：2013-04-15T17:16:17.533
> 
> 标签：c#, asp.net, gridview, bind

我有一个信用卡对象列表。信用卡类别如下：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace Client
{
    public class CreditCard
    {
        public String A_Number;
        public String A_Name;
        public String A_Type;
        public String A_Owner_Type;
        public String Bank_City;
        public String Bank_State;
        public String Bank_ZIP;
        public String Balance;
        public String C_Username;

        public CreditCard()
        {

        }
    }
} 
```

在另一个类中，我试图将列表绑定到网格视图，如下所示：

```
protected void Page_Load(object sender, EventArgs e)
        {
            List<CreditCard> list = (List<CreditCard>)Session["list"];
            GridView_List.DataSource = list;
            GridView_List.DataBind();
        } 
```

但是，我收到以下错误：

```
The data source for GridView with id 'GridView_List' did not have any properties or attributes from which to generate columns.  Ensure that your data source has content. 
```

问题是什么？我检查了该列表是否确实包含数据，所以我不知道为什么它不起作用？如何解决这个问题？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-15T18:04:16.800

您必须为 DataBinding 使用公共属性。按如下方式更新您的课程：

```
 public class CreditCard
    {
        public String A_Number { get; set; }
        public String A_Name { get; set; }
        public String A_Type { get; set; }
        public String A_Owner_Type { get; set; }
        public String Bank_City { get; set; }
        public String Bank_State { get; set; }
        public String Bank_ZIP { get; set; }
        public String Balance { get; set; }
        public String C_Username { get; set; }

        public CreditCard() { }
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-15T17:48:05.243

您已将您定义`CreditCard`为带有字段的对象。数据绑定只能通过属性来完成。因此，您需要对所有字段执行以下操作：

```
public String A_Number { get; set; } 
```

# directx-11 - 如何从 Surface (SharpDX) 创建位图

> ID：16020988
> 
> 赞同：6
> 
> 时间：2013-04-15T17:16:21.190
> 
> 标签：directx-11, sharpdx

我是 DirectX 的新手，并尝试使用 SharpDX 使用桌面复制 API 捕获屏幕截图。

我想知道是否有任何简单的方法可以创建可以在 CPU 中使用的位图（即保存在文件中等）

我正在使用以下代码获取桌面屏幕截图：

```
var factory = new SharpDX.DXGI.Factory1();
var adapter = factory.Adapters1[0];
var output = adapter.Outputs[0];

var device = new SharpDX.Direct3D11.Device(SharpDX.Direct3D.DriverType.Hardware,
                                                       DeviceCreationFlags.BgraSupport |
                                                       DeviceCreationFlags.Debug);

var dev1 = device.QueryInterface<SharpDX.DXGI.Device1>();

var output1 = output.QueryInterface<Output1>();
var duplication = output1.DuplicateOutput(dev1);
OutputDuplicateFrameInformation frameInfo;
SharpDX.DXGI.Resource desktopResource;
duplication.AcquireNextFrame(50, out frameInfo, out desktopResource);

var desktopSurface = desktopResource.QueryInterface<Surface>(); 
```

谁能给我一些关于如何从 desktopSurface（DXGI.Surface 实例）创建位图对象的想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-30T16:27:27.813

我自己刚刚完成了这个，虽然我不会对这段代码多说！

```
public byte[] GetScreenData()
    {
        // We want to copy the texture from the back buffer so 
        // we don't hog it.
        Texture2DDescription desc = BackBuffer.Description;
        desc.CpuAccessFlags = CpuAccessFlags.Read;
        desc.Usage = ResourceUsage.Staging;
        desc.OptionFlags = ResourceOptionFlags.None;
        desc.BindFlags = BindFlags.None;

        byte[] data = null;

        using (var texture = new Texture2D(DeviceDirect3D, desc))
        {
            DeviceContextDirect3D.CopyResource(BackBuffer, texture);

            using (Surface surface = texture.QueryInterface<Surface>())
            {
                DataStream dataStream;
                var map = surface.Map(SharpDX.DXGI.MapFlags.Read, out dataStream);
                int lines = (int)(dataStream.Length / map.Pitch);
                data = new byte[surface.Description.Width * surface.Description.Height * 4];

                int dataCounter = 0;
                // width of the surface - 4 bytes per pixel.
                int actualWidth = surface.Description.Width * 4;
                for (int y = 0; y < lines; y++)
                {
                    for (int x = 0; x < map.Pitch; x++)
                    {
                        if (x < actualWidth)
                        {
                            data[dataCounter++] = dataStream.Read<byte>();
                        }
                        else
                        {
                            dataStream.Read<byte>();
                        }
                    }
                }
                dataStream.Dispose();
                surface.Unmap();
            }
        }

        return data;
    } 
```

这将为您提供一个 byte[]，然后可以使用它来生成位图。

以下是我如何保存到 png 图像。

```
 using (var stream = await file.OpenAsync( Windows.Storage.FileAccessMode.ReadWrite ))
            {
                BitmapEncoder encoder = await BitmapEncoder.CreateAsync(BitmapEncoder.PngEncoderId, stream);
                double dpi = DisplayProperties.LogicalDpi;

                encoder.SetPixelData(BitmapPixelFormat.Bgra8, BitmapAlphaMode.Straight,
                    (uint)width, (uint)height, dpi, dpi, pixelData);
                encoder.BitmapTransform.ScaledWidth = (uint)newWidth;
                encoder.BitmapTransform.ScaledHeight = (uint)newHeight;
                await encoder.FlushAsync();
                waiter.Set();
            } 
```

我知道这是不久前回答的，也许你现在已经明白了：3 但如果其他人被卡住了，我希望这会有所帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T01:01:58.350

[Desktop Duplication API](http://msdn.microsoft.com/en-us/library/windows/desktop/hh404487%28v=vs.85%29.aspx)的MSDN 页面告诉我们图像的格式：

> DXGI 通过新的 IDXGIOutputDuplication::AcquireNextFrame 方法提供包含当前桌面图像的表面。无论当前显示模式是什么，桌面图像的格式始终为**DXGI_FORMAT_B8G8R8A8_UNORM 。**

您可以使用[`Surface.Map(MapFlags, out DataStream)`](http://sharpdx.org/documentation/api/m-sharpdx-dxgi-surface-map)方法获取访问 CPU 上的数据。

代码应如下所示：

```
DataStream dataStream;
desktopSurface.Map(MapFlags.Read, out dataStream);
for(int y = 0; y < surface.Description.Width; y++) {
    for(int x = 0; x < surface.Description.Height; x++) {
        // read DXGI_FORMAT_B8G8R8A8_UNORM pixel:
        byte b = dataStream.Read<byte>();
        byte g = dataStream.Read<byte>();
        byte r = dataStream.Read<byte>();
        byte a = dataStream.Read<byte>();
        // color (r, g, b, a) and pixel position (x, y) are available
        // TODO: write to bitmap or process otherwise
    }
}
desktopSurface.Unmap(); 
```

*免责声明：我手头没有 Windows 8 安装，我只是按照文档进行操作。我希望这有效:)

# android - 在调用 onLocationChanged 之后执行以下任务（）

> ID：16020991
> 
> 赞同：0
> 
> 时间：2013-04-15T17:16:32.530
> 
> 标签：android, locationlistener

我有一个实现 LocationListener 的类

```
public class GetLocation implements LocationListener {

@Override
public void onLocationChanged(Location location) {
    Log.i("GetLocation", "Location changed: " + location.getLatitude()
            + ", " + location.getLongitude());

} 
```

在我的活动中，

```
final LocationManager locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);

    final GetLocation locationListener = new GetLocation();
locationManager.requestLocationUpdates(
            LocationManager.GPS_PROVIDER, 0, 0, locationListener);

     .....  //Check whether the location is changed

    locationManager.removeUpdates(locationListener);

    updateGPStoServer(); 
```

在 onLocationChanged() 被调用一次后，我想做一个上传任务并取消监听器，所以我问我如何等待 onLocationChanged() 然后做我的任务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:28:25.613

> 在 onLocationChanged() 被调用一次后，我想做一个上传任务并取消监听器，所以我问我如何等待 onLocationChanged() 然后做我的任务？

我认为您需要将调用移至`updateGPStoServer()`您的`Listener.onLocationChanged`方法中；这将实现您正在寻找的“等待”。（另外说明：`updateGPStoServer()`应该实现创建一个后台线程来对服务器进行更新。但你知道，对吧？:-)

此外，听起来您真的想打电话`LocationManager.requestSingleUpdate`而不是`LocationManager.requestLocationUpdates`. 这将消除调用`locationManager.removeUpdates(locationListener)`.

# xcode - 创建不同颜色的注释？

> ID：16020996
> 
> 赞同：1
> 
> 时间：2013-04-15T17:16:41.827
> 
> 标签：xcode, annotations, pins

我只是 XCode 的初级开发人员，想知道是否可以得到一些帮助。我正在尝试在地图上显示位置。我也有地图工作和基本注释。但是，例如，我希望加油站的注释是绿色的。也许是红色的购物中心。我找到了一个教程，但它变成了不同的颜色。我将如何只将某些注释设为红色而将其他注释设为绿色？（如果您不介意将其分解，我仍在努力学习）:)

谢谢！

这是我的代码。视图控制器.h：

```
 #import <UIKit/UIKit.h>
    #import <MapKit/MapKit.h>

    @interface ViewController : UIViewController <MKMapViewDelegate>

    @property (nonatomic, strong) IBOutlet MKMapView *mapView;

    @end 
```

视图控制器.m：

```
 #import "ViewController.h"
      #import "Annotation.h"

       @interface ViewController ()

       @end

       @implementation ViewController

     - (void)mapView:(MKMapView *)mapView viewForAnnotation:(id<MKAnnotation>)annotation  (MKPinAnnotationView *)view {
view.pinColor = MKPinAnnotationColorGreen;

       }

      - (void)viewDidLoad
     {
       [super viewDidLoad];
       //---------- Grocery Stores--------------

       //---------------Meijer Richmond,KY Annotation--------------
       //Annotation
       //Create a coordinate for use with the annotation
       CLLocationCoordinate2D meijerRichmondLocation;
       meijerRichmondLocation.latitude = 37.76486;
       meijerRichmondLocation.longitude = -84.29691;

       //Create annotation obj
       Annotation *meijerAnnotation = [Annotation alloc];
       meijerAnnotation.coordinate = meijerRichmondLocation;
       meijerAnnotation.title = @"Meijer Richmond";
       meijerAnnotation.subtitle = @" 2013 Lantern Ridge Dr.";

       [self.mapView addAnnotation:meijerAnnotation];
//-------------------------------------------------------

//---------------Meijer Reynold Road Lexington, KY Annotation--------------
//Annotation
//Create a coordinate for use with the annotation
CLLocationCoordinate2D meijerLex1Location;
meijerLex1Location.latitude = 37.995744;
meijerLex1Location.longitude = -84.531546;

//Create annotation obj
Annotation *meijerLex1Annotation = [Annotation alloc];
meijerLex1Annotation.coordinate = meijerLex1Location;
meijerLex1Annotation.title = @"Meijer on Reynolds Road";
meijerLex1Annotation.subtitle = @"351 Meijer Way Suite 100";

[self.mapView addAnnotation:meijerLex1Annotation];
//----------------------------------------------------------------------

//---------------Meijer Lexington, KY Annotation-------------------------------
MKPointAnnotation *meijerLex2Annotation = [[MKPointAnnotation alloc] init];
meijerLex2Annotation.title = @"Meijer on Man-O-War";
meijerLex2Annotation.subtitle = @"2155 Paul Jones Way";
meijerLex2Annotation.coordinate = CLLocationCoordinate2DMake(38.0208932,-84.420606);
[self.mapView addAnnotation:meijerLex2Annotation];

//------------ Malls ----------------

//-------------------Mall Annotation---------------------
//Mall Annotation
//Create a coordinate for use with the annotation
CLLocationCoordinate2D fayetteMallLocation;
fayetteMallLocation.latitude = 37.9909;
fayetteMallLocation.longitude = -84.5269;

//Create annotation obj
Annotation *fayetteMallAnnotation = [Annotation alloc];
fayetteMallAnnotation.coordinate = fayetteMallLocation;
fayetteMallAnnotation.title = @"Fayette Mall";
fayetteMallAnnotation.subtitle = @"Lexington's Main Shopping Center.";

//-------------------------------------------------------

[self.mapView addAnnotation:fayetteMallAnnotation];

self.mapView.delegate = self;
// Do any additional setup after loading the view, typically from a nib.
    }

     - (void)didReceiveMemoryWarning
     {
     [super didReceiveMemoryWarning];
     // Dispose of any resources that can be recreated.
     }

   @end 
```

# node.js - 僵尸等待功能的问题

> ID：16020997
> 
> 赞同：0
> 
> 时间：2013-04-15T17:16:42.400
> 
> 标签：node.js

我目前正在尝试使用[Zombie.js](http://zombie.labnotes.org/API#browser-wait-callback)实现以下代码。但是，我无法使以下代码起作用：

```
var Browser = require('zombie');

browser = new Browser();
browser.wait(3000, function() { console.log("ok"); }); 
```

因此，脚本应该等待 3 秒，然后才会显示“ok”。然而，它会立即显示出来。

我是不是误会了什么？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:44:09.270

正如文档所述：

> 等待浏览器完成加载资源和处理 JavaScript 事件。

由于您没有请求任何内容，因此无需等待，因此 Zombie 立即调用回调。这更像是一种最大超时，而不是保证等待。

# sql - 原始 SQL 是用汇编还是 C 编写的？

> ID：16020999
> 
> 赞同：6
> 
> 时间：2013-04-15T17:16:44.957
> 
> 标签：sql, assembly

我知道供应商有自己的原始 SQL 语言子集，它们是用 C（如 Postgre SQL）或 MS-SQL Server（C++）等编写的......

那么，最初的 SQL 是用 C 编写的，还是在 Assembly 中自己创建的？我真的找不到关于它的原始语言根源的明确答案（除了历史等）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-15T17:26:21.650

对 Oracle的快速[历史搜索结果如下：](http://www.dba-oracle.com/t_edb_pl_sql_features_release.htm)

> 在 70 年代后期，大约在 Ingres 在加州大学伯克利分校开始工作的时候，三个为中央情报局工作的人聚在一起，创办了一家名为 Relational Software, Inc. 的公司。
> 
> 他们的第一个产品是一个名为 Oracle 的关系数据库。创始人决定使用 C 语言进行开发。当他们决定开始移植到不同的平台时，这将变得很重要。
> 
> 他们还决定支持 SQL 作为内部数据访问语言。这也将成为其成功的一个非常重要的因素。1979 年，Relational Software 是唯一一家制作符合 SQL 的数据库的公司。如果有人问你谁编写了第一个 SQL 数据库，你现在知道答案了：Oracle。

所以答案是 C - 根据 Burleson Consulting 的说法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-15T17:24:00.767

[PL/我](http://en.wikipedia.org/wiki/PL/I)。

来自[System R 的历史和评估](http://www.cs.berkeley.edu/~brewer/cs262/SystemR.pdf)：

> 解释器程序是用 PL/I 编写的，用于在 XRM 之上执行高级 SQL（以前称为 SEQUEL）语言的语句。

[System R](http://en.wikipedia.org/wiki/IBM_System_R)的原型是在 1974-75 年开发的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-15T17:25:58.603

[http://www.tutorialspoint.com/sql/sql-databases.htm](http://www.tutorialspoint.com/sql/sql-databases.htm)

> 1979 - Oracle 2.0 版本发布，成为第一个商业关系数据库和第一个 SQL 数据库。公司更名为 Relational Software Inc. (RSI)。
> 
> 1983 - Oracle 发布 3.0 版，用 C 语言重写并在多个平台上运行。