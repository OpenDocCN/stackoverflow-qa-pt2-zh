# StackOverflow 问答 13108000-13108999

# c++ - 在奇怪的二叉树中搜索节点

> ID：13108002
> 
> 赞同：0
> 
> 时间：2012-10-28T10:20:44.423
> 
> 标签：c++, algorithm, binary-tree

我有一棵二叉树，这很奇怪：根是最大的数字，而另一个是递减的……（示例：霍夫曼树）我需要制定一个算法来搜索其中的一个键。

我尝试了很多，但我不知道该怎么做=（

请问有什么建议吗？

例如像这样![在此处输入图像描述](../Images/739ee15acbc8a8b149f7962db5ab3268.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T10:52:04.730

[您向我们展示](http://en.wikibooks.org/wiki/Data_Coding_Theory/Huffman_Coding)的图像中的树是一棵霍夫曼树。这棵树内的节点表示该**节点下键的出现次数**。节点绝对不会为您提供有关可以从该节点找到的密钥的信息。

由于您没有关于子树中键的信息，因此您必须**遍历整个树**才能找到其中的键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T10:47:44.783

您必须检查树中的每个节点。

如果性能很重要，请创建另一个映射、哈希表或二叉搜索树。在您展示的示例中，您正在搜索单个字符，如果您使用 8 位字符集，则可以只使用具有 256 个整数的数组。

# c++ - 将静态库链接到共享库？

> ID：13108004
> 
> 赞同：4
> 
> 时间：2012-10-28T10:21:26.090
> 
> 标签：c++, linux, static, g++, shared

背景：

我想将一些静态库链接到一个共享库中。原因是我希望我的应用程序使用我测试过的特定 lib 版本。我不想将静态版本作为共享库与我的应用程序一起提供。我创建了这个示例库和应用程序以尽可能简化。我想在链接期间继续将共享库链接到应用程序。

问题：

为什么我会收到下面列出的错误消息？我究竟做错了什么？也许这不是在 linux 上通常的做事方式，但有可能这样做吗？这个提升是特定的吗？

- - 图书馆

```
//example.cpp
#include <boost/thread.hpp>
void doit()
{
    boost::thread t1;
}

#build script
g++ -Wall -fPIC -I/usr/include -c example.cpp -o example.o
g++ -shared /usr/lib/libboost_thread.a /usr/lib/libboost_system.a 
    example.o -o libexample.so
#build OK. 
```

---- 示例应用

```
//main.cpp
#include <iostream>
void doit();
int main()
{
    std::cout << "main\n";
    doit();
    return 0;
};

#build script.
g++ -Wall -c main.cpp -o main.o
g++ libexample.so main.o -o main

#error message.
libexample.so: undefined reference to `boost::thread::thread()'
libexample.so: undefined reference to `boost::thread::~thread()'
collect2: ld returned 1 exit status 
```

所有源代码都位于同一目录中。Boost 安装在 /usr/lib 和 /usr/include 中。Boost 1.40 版是在 ubuntu 10.04 机器上使用 apt-get 安装的。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:26:35.837

我认为对您来说最简单的方法是使用`--whole-archive`链接器开关（关于这个主题有更多的 SO 问题，请参阅此处[如何将静态库链接到 gcc 中的动态库](https://stackoverflow.com/questions/2649735/how-to-link-static-library-into-dynamic-library-in-gcc)）。

`.so`这样做的缺点是您的共享库将从 Boost 静态库中导出所有符号，如果您在也使用 Boost（但版本不同或使用不同开关编译）的应用程序中使用您的符号，您可能会遇到奇怪的问题。

因此，您需要使用版本脚本来隐藏从库中导出的内容（请参阅[如何在共享库中隐藏导出的符号名称](https://stackoverflow.com/questions/9648655/how-to-hide-the-exported-symbols-name-within-a-shared-library)，以及链接器版本脚本的 google），只留下`doit()`可见。在您的情况下，这样的版本脚本可能如下所示：

```
{
global:
    doit*;
local:
    *;
} 
```

您还需要确保您要链接的静态库是用编译的`-fPIC`（如果您没有调整它们的构建标志，这不太可能），否则您将受到性能损失`i386`并且可能根本无法链接上`amd64`。

# mysql - 数据库速度取决于列或行（记录）？

> ID：13108008
> 
> 赞同：1
> 
> 时间：2012-10-28T10:22:28.853
> 
> 标签：mysql, database-design

我有一个学生实体，现在我想创建一个学生表和一个学生属性表，例如`dob, age, salary`. 学生属性约为120。

所以将来哪一个会更好地提高表性能和我的 MySQL 操作

选项

1.  创建一个表（student_mst），将所有学生属性作为具有良好数据类型的列

2.  或者，创建两个`student_mst, student_attributes`有关系的表（ ）并在其中添加多个学生属性记录`table - student_attributes.`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T10:51:43.077

这是两种完全不同的方法，因此这完全取决于您希望如何处理数据。仅当您选择的模型与您想要访问数据的方式不兼容时，性能才是一个问题。

如果所有学生都使用所有或大部分属性，并且有一组固定的属性，则第一种选择是自然方法。

如果学生有不同的属性集，第二个选项会很有用，并且您可能会扩展属性集。

使用第一种方法，您通常编写不同的查询来处理不同的属性。例如，获取学生列表并返回一些属性很容易。例子：

```
 select StudentId, Name, Age, Class, Grade
 from Students
 order by Age desc 
```

使用第二种方法，您通常会分别获取基本学生信息和学生属性。要获得具有某些属性的学生列表会更复杂，并且它会建立您想要获得的更多属性。例子：

```
 select s.StudentId, Name = a1.Value, Age = a2.Value, Class = a3.Value, Grade = a4.Value
 from Students s
 inner join Attributes a1 on a1.StudentId = s.StudentId
 inner join Attributes a2 on a2.StudentId = s.StudentId
 inner join Attributes a2 on a3.StudentId = s.StudentId
 inner join Attributes a3 on a4.StudentId = s.StudentId
 order by cast(a.Value as int) desc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T11:03:20.580

一般来说，关系数据库中昂贵的操作是恢复数据集的“行”。还能够按列过滤是一种语法糖，可以更好地调整最终数据集。因此，尝试优化排列行之间关系的方式，不要太在意列数，因为它不会影响搜索性能，而主要是“在线”上传输的数据量” 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T11:17:24.787

在@Guffa 的答案之上还有一些考虑

如果你确实去相关的属性表。每个学生的每个属性都会花费您一个属性 id 和一个学生 id，如果它们是整数，则说 8 个字节，因此它们的稀疏程度值得考虑。

120个属性能不能分组，可能值得一看。也许是一个属性类型 /group 和一些 1 - 1 个扩展表。

如果您只是获取一个学生及其所有属性，而不是所有具有属性的学生。

如果您计划查询的属性很少，则一个 xml 片段或序列化对象值得一看。

最后是复杂的连接查询（不想做 120 个 :)）

您可以改为旋转它们，或者您可以通过一个连接将它们作为两列返回，这将对您将它们映射到 UI 的方式产生一定的影响。

对此没有正确的答案，但如果您将架构隐藏在某些方法后面而不是在其上撒上 SQL，那么您不必在设计中一成不变。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T17:26:16.757

一般来说，你最好让表的列组成由数据的逻辑结构驱动，并依靠索引等物理设计特性来帮助你加快速度。

一个学生的一个属性是否属于你的学生表，主要是所有学生都有这个属性的问题，还是只有部分学生有这个属性的问题。如果所有学生都有该属性，则将属性保存在学生表中通常比在检索时进行连接要快。这也是合乎逻辑的方法。

另一方面，如果您具有仅与某些学生相关的属性，那么您需要分析案例以查看您是否正在处理学生的专业子集。如果确实如此，那么您需要查找“ER Specializaton”以了解如何在概念级别对其进行建模。

如果您想了解关系设计如何实现专业化案例，请查看“类表继承”。

# windows-8 - 编程工具伴侣，Windows 8 Release Preview 和 VS 2012 RC

> ID：13108010
> 
> 赞同：0
> 
> 时间：2012-10-28T10:22:44.313
> 
> 标签：windows-8, visual-studio-2012

很抱歉这个话题问题，但真的需要这个信息。我正在使用 Windows 8 Release Preview，我想安装 VS 2012 express，但我最近下载的版本与此版本的 windows 不兼容，我可以在我的计算机上安装 VS 2012 RC 吗？还是您有适用于我的 Windows 版本的建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:07:57.447

为什么不安装[Windows 8 评估](http://msdn.microsoft.com/en-us/evalcenter/jj554510.aspx)版？它可以工作 90 天。

# android - Phonegap android文本框重复实例

> ID：13108012
> 
> 赞同：2
> 
> 时间：2012-10-28T10:22:55.243
> 
> 标签：android, html, css, cordova

我遇到了一个非常奇怪的问题。

当我专注于（通过触摸）我的 phonegapp 应用程序中的文本框时，我看到 2 个文本框。

见附件： ![在此处输入图像描述](../Images/f5335bd810872895334430637c1e84e5.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T15:06:53.583

我认为最终的解决方案是隐藏android尝试输入的“真实”文本框..这解决了我的问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:01:04.497

遗憾的是，当您使用固定/绝对定位时，这是一个[已知问题。](https://code.google.com/p/android/issues/detail?id=30964)Android 试图“透明地”增强文本字段，如预测输入、语言选择等，并且在固定/绝对定位的情况下，它很难将其完全覆盖在顶部。在 Kindle Fire 上，这一点更加明显。尝试使您的布局灵活/响应！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-06T12:33:17.707

这个解决方案对我有用。问题是输入字段的“大纲”属性：

```
 input[type="text"]:not(.selectbox), input[type="number"],
 input[type="password"] {
 -webkit-user-modify: read-write-plaintext-only;
 -webkit-tap-highlight-color:rgba(0,0,0,0);
  outline-style: none;
 } 
```

**参考：**[https ://code.google.com/p/android/issues/detail?id=30964](https://code.google.com/p/android/issues/detail?id=30964)

# python - Python&PyGTK：单击按钮时停止

> ID：13108018
> 
> 赞同：4
> 
> 时间：2012-10-28T10:23:59.343
> 
> 标签：python, button, click, while-loop, pygtk

我正在编写一些应用程序，我想在单击按钮时创建while循环，如果再次单击它来停止它。这是按钮的代码：

```
self.btnThisOne = gtk.Button("This one")
self.btnThisOne.connect("clicked", self.startLoop) 
```

startLoop def 的代码是：

```
def startLoop(self):
    while self.btnThisOne?(is_clicked)?:
        #do something 
```

怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T12:08:57.593

不幸的是，您不能只在应用程序的主线程中运行不受约束的 while 循环。这将阻塞主[gtk 事件循环](http://www.gtk.org/api/2.6/glib/glib-The-Main-Event-Loop.html)，您将无法处理更多事件。您可能想要做的是产生一个线程。

您是否考虑过使用 a[`ToggleButton`](http://developer.gnome.org/gtk/2.24/GtkToggleButton.html)而不是[`GtkButton`](http://developer.gnome.org/gtk/2.24/GtkButton.html)？最接近`is_clicked`方法的是`is_active`，您会在切换按钮中找到它。

这是一个根据切换按钮的状态启动和控制线程的示例（如果需要常规按钮，请替换`triggered`为`clicked`和）：`ToggleButton``Button`

```
import gtk, gobject, threading, time

gobject.threads_init()

window = gtk.Window()
button = gtk.ToggleButton('Start Thread')

class T(threading.Thread):
    pause = threading.Event()
    stop = False

    def start(self, *args):
        super(T, self).start()

    def run(self):
        while not self.stop:
            self.pause.wait()
            gobject.idle_add(self.rungui)
            time.sleep(0.1)

    def rungui(self):
        pass # all gui interaction should happen here

thread = T()
def toggle_thread(*args):
    if not thread.is_alive():
        thread.start()
        thread.pause.set()
        button.set_label('Pause Thread')
        return

    if thread.pause.is_set():
        thread.pause.clear()
        button.set_label('Resume Thread')
    else:
        thread.pause.set()
        button.set_label('Pause Thread')

button.connect('toggled', toggle_thread, None)

window.add(button)
button.show()
window.show()
gtk.main() 
```

这个 PyGTK[常见问题解答](http://faq.pygtk.org/index.py?req=show&file=faq20.006.htp)可能会有所帮助。干杯。

# php - mod_rewrite 斜杠和 header.php 没有在 url 中包含斜杠

> ID：13108022
> 
> 赞同：-1
> 
> 时间：2012-10-28T10:24:35.967
> 
> 标签：php, .htaccess, mod-rewrite, url-rewriting, rewrite

我的**.htaccess**文件需要帮助。现在我有类似[http://www.afrogfx.com/20121028050853/Test.html](http://www.afrogfx.com/20121028050853/Test.html) 问题的链接，位于**Slash /**！！如果您单击我的链接，您会发现没有样式的链接如果删除斜杠，您将得到 404 Not Found Like That [http://www.afrogfx.com/20121028050853Test.html](http://www.afrogfx.com/20121028050853Test.html) 试试吧！ **这是我的 .htaccess**

```
 RewriteEngine On

    RewriteRule ^([a-zA-Z0-9-/]+).html$ readmore.php?url=$1
    RewriteRule ^([a-zA-Z0-9-/]+).html/$ readmore.php?url=$1 
```

**阅读更多.php**

```
 <?php
    include ('config/connect_to_mysql.php');
    $url=$_GET['url'];
    if($_GET['url'])
    {
    $url=mysql_real_escape_string($_GET['url']);
    $url=$url.'.html'; //Friendly URL 

    $sql=mysql_query("select * from posts where url='$url'");
    $count=mysql_num_rows($sql);
    $row=mysql_fetch_array($sql);
    $title=$row['title'];
    $text=$row['text'];
    }
    else
    {
    echo '404 Page.';
    }

    ?> 
```

**问题在这里**

```
 <?php
    include('styles/header.php');
    include ('styles/leftblock.php');
    include ('styles/mrnuleft.php');
    ?>

    <?php
    if($count)
    {

    echo "<h1>$title</h1><div class='text'>$text</div>";
    }
    else
    {
    echo "<h1>404 Page.</h1>";
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T21:14:38.577

您可以将所有标题链接设为绝对链接：

从：

```
<link href="styles/assets/css/bootstrap.css" rel="stylesheet"> 
```

至：

```
<link href="/styles/assets/css/bootstrap.css" rel="stylesheet"> 
```

或者您可以在`<head>`标签下方添加：

```
<base href="/"> 
```

问题是您的样式和脚本有相对链接。当浏览器尝试请求类似:`/20121028050853Test.html`的内容时，**URI Base**就是`/`. 但是当浏览器请求时`/20121028050853/Test.html`，base 变为`/20121028050853/`，浏览器将使用此 base 并将所有相对 URL 附加到此 base，因此`styles/assets/css/bootstrap.css`变为`/20121028050853/styles/assets/css/bootstrap.css`，并且您没有样式或脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T10:29:31.160

我认为问题是路径问题。当我进入带有斜杠的页面时，它包括以下内容：

`styles/assets/css/bootstrap.css`

所以它试图包含的实际上是：

[http://www.afrogfx.com/20121028050853/styles/assets/css/bootstrap.css](http://www.afrogfx.com/20121028050853/styles/assets/css/bootstrap.css)

尝试告诉它从根目录加载：

`/styles/assets/css/bootstrap.css`

# java - 尝试使用 Java 检索外键时出现一些错误

> ID：13108028
> 
> 赞同：0
> 
> 时间：2012-10-28T10:25:58.130
> 
> 标签：java, jdbc, foreign-keys, odbc

这里“path”变量具有数据库地址，“tb”是数据库中的表名。在这里我尝试从表中检索外键列和超级表

```
 Connection  con = DriverManager.getConnection("jdbc:odbc:Driver={Microsoft Access Driver (*.mdb)};Dbq="+path);
            ResultSet rs = null;
            DatabaseMetaData meta = con.getMetaData();
            rs = meta.getExportedKeys(con.getCatalog(), null, "tb");
             while (rs.next()) {
               String fkTableName = rs.getString("FKTABLE_NAME");
               String fkColumnName = rs.getString("FKCOLUMN_NAME");
               int fkSequence = rs.getInt("KEY_SEQ");
               System.out.println("getExportedKeys(): fkTableName="+fkTableName);
               System.out.println("getExportedKeys(): fkColumnName="+fkColumnName);
               System.out.println("getExportedKeys(): fkSequence="+fkSequence);
             } 
```

当我尝试运行此代码时，当我尝试使用 getExportedKeys() 函数生成 ResultSet 对象时出现以下错误。

```
java.sql.SQLException: [Microsoft][ODBC Driver Manager] Driver does not support
this function
        at sun.jdbc.odbc.JdbcOdbc.createSQLException(JdbcOdbc.java:6958)
        at sun.jdbc.odbc.JdbcOdbc.standardError(JdbcOdbc.java:7115)
        at sun.jdbc.odbc.JdbcOdbc.SQLForeignKeys(JdbcOdbc.java:3313)
        at sun.jdbc.odbc.JdbcOdbcDatabaseMetaData.getExportedKeys(JdbcOdbcDataba
seMetaData.java:3139)
        at Frm.actionPerformed(next.java:303)
        at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:17
86)
        at javax.swing.AbstractButton$ForwardActionEvents.actionPerformed(Abstra
ctButton.java:1839)
        at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel
.java:420)
        at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:258
)
        at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonL
istener.java:245)
        at java.awt.Component.processMouseEvent(Component.java:5100)
        at java.awt.Component.processEvent(Component.java:4897)
        at java.awt.Container.processEvent(Container.java:1569)
        at java.awt.Component.dispatchEventImpl(Component.java:3615)
        at java.awt.Container.dispatchEventImpl(Container.java:1627)
        at java.awt.Component.dispatchEvent(Component.java:3477)
        at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:3483
)
        at java.awt.LightweightDispatcher.processMouseEvent(Container.java:3198)

        at java.awt.LightweightDispatcher.dispatchEvent(Container.java:3128)
        at java.awt.Container.dispatchEventImpl(Container.java:1613)
        at java.awt.Window.dispatchEventImpl(Window.java:1606)
        at java.awt.Component.dispatchEvent(Component.java:3477)
        at java.awt.EventQueue.dispatchEvent(EventQueue.java:480)
        at java.awt.EventDispatchThread.pumpOneEventForHierarchy(EventDispatchTh
read.java:201)
        at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThre
ad.java:151)
        at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:145)

        at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:137)

        at java.awt.EventDispatchThread.run(EventDispatchThread.java:100) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T14:10:49.290

您使用古老的驱动程序访问 MSAccess。并非所有 JDBC 交互都受支持。您需要使用真实的数据库或不同的驱动程序。

# windows-8 - 带有必应翻译器的 WinRT 应用程序

> ID：13108030
> 
> 赞同：0
> 
> 时间：2012-10-28T10:26:10.580
> 
> 标签：windows-8, windows-runtime, bing-api, microsoft-translator

我想在我的 WinRT 应用程序中使用 bing 翻译器。在这里找到了一些示例代码：http: [//codepaste.net/hgrb91](http://codepaste.net/hgrb91)，但由于请求错误，我收到了代码 400 的错误。

我能做些什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T14:48:51.850

您是否获得了自己的`ClientID`and`ClientSecret`并将它们放入代码中？如果没有正确设置它们，您将收到错误 400。

有关如何获取它们的详细信息，请参阅此处的博客文章：http: [//blogs.msdn.com/b/translation/p/gettingstarted1.aspx](http://blogs.msdn.com/b/translation/p/gettingstarted1.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T17:41:19.233

我不时看到这种情况，答案通常与应用程序或 API 的注册问题有关。

*   访问[https://datamarket.azure.com/developer/applications](https://datamarket.azure.com/developer/applications) - 您的应用程序是否在此处列出？如果是这样，请使用此条目的客户端 ID 和客户端密码，而不是您在注册 Azure 时获得的帐户范围的客户端 ID。如果没有，请从此屏幕注册一个，并使用其客户端 ID 和客户端密码。

*   访问[https://datamarket.azure.com/account/datasets](https://datamarket.azure.com/account/datasets) -- Microsoft Translator 是否在此处列为您订阅的服务？它是活跃的吗？您的订阅中还有足够的字符吗？

# javascript - Primefaces Mobile JS 仅在第一个“页面”上加载

> ID：13108035
> 
> 赞同：1
> 
> 时间：2012-10-28T10:26:44.730
> 
> 标签：javascript, jsf, primefaces

我有一个使用 Primefaces mobile 构建的网络应用程序。总的来说，一切都很好，我可以愉快地从一个视图导航到另一个视图等。

当我尝试加载外部 JS 文件时，问题就来了。更具体地说，外部 JS / 事件侦听器仅在加载的第一个“视图”上工作。所有其他“视图”都表现得好像 JS 甚至没有被调用。

我花了几个小时来缩小范围，但我最终使用了第 3 方库“iscroll.js”（[http://cubiq.org/iscroll-4](http://cubiq.org/iscroll-4)）来隔离问题。

如果我将 iscroll.js 文件放在我的资源目录中并遵循 iscroll 文档，则在第一个视图上创建一个滚动 div，一切都按预期完美运行。如果我采用相同的 div 并将其放在任何其他视图上，我将一无所获。我可以在“视图”中来回导航，并且初始“视图”保持其“正确性”（即，当我转到另一个“视图”时它不会停止工作）。

显然我的问题是如何让它适用于所有视图？我的猜测是，这归因于我对 Primefaces Mobile 的工作原理缺乏了解，但任何可能提供帮助的 JSF、Primefaces、JS 大师都将不胜感激。

更新：基本精简代码来解释。

```
<f:view xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:pou="http://primefaces.org/ui"
    xmlns:pm="http://primefaces.org/mobile"
    contentType="text/html"
    renderKitId="PRIMEFACES_MOBILE"
    xmlns:ez="http://java.sun.com/jsf/composite/ezcomp">

<pm:page title="iConsult">

    <f:facet name="postinit"> 
        <h:outputScript name="js/iscroll.js"/>
    </f:facet>

    <script type="text/javascript">

        // Variables -----------------------------------------------------------
        var myScroll; // Scrolling lib var

        function loadScroll() {
            setTimeout(function() {
                myScroll = new iScroll('wrapper');
            }, 100);

        }
        window.addEventListener('load', loadScroll, false);
     </script>

<!-- Main View -->
    <pm:view id="main">
        <pm:header title="main page" swatch="b">
            <f:facet name="right">

            </f:facet>
        </pm:header>

        <pm:content>
           // If I place the iscroll div here it works
           // ...lots of code to do with the app
        </pm:content>

    </pm:view>

 <!-- Other View -->
    <pm:view id="view1">
        <pm:header title="view1" swatch="b">
            <f:facet name="right">

            </f:facet>
        </pm:header>

        <pm:content>
           // If I place the iscroll div here it doesn't works
           // ...lots of code to do with the app
        </pm:content>

    </pm:view>

  </pm:page>

</f:view> 
```

需要明确的是，这并不是 iscroll 独有的。我只是将它用作参考，但我尝试过的所有外部 JS 文件都是这种情况。

# linux - Tshark 和网络服务器响应时间

> ID：13108036
> 
> 赞同：0
> 
> 时间：2012-10-28T10:26:45.010
> 
> 标签：linux, shell, unix, traffic, tshark

如何通过对每个主机名使用 tshark&shell 或其他内容来获得 GET 和 HTTP/1.0 200 OK 之间的响应时间差异？你能推荐我回答这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T17:30:37.770

您可以同时扩展`wireshark`和`tshark`使用 Lua 脚本。有关详细信息，请参阅Wireshark 文档的[第 11 章。](http://www.wireshark.org/docs/wsug_html_chunked/wsluarm.html)我将首先尝试编写一个[Tap/Listener](http://wiki.wireshark.org/Lua/Taps)来检查已经预处理的 HTTP“数据包”`wireshark`以收集数据并使用 tap 的`reset`方法来执行计算和输出。

# php - 将 2 个 SQL 表加入 1 个数据数组

> ID：13108038
> 
> 赞同：0
> 
> 时间：2012-10-28T10:26:50.023
> 
> 标签：php, mysql, sql

我有两张桌子：问题，答案。

*   `questions`具有以下字段：questionId、title、category、correctAnswerID、url
*   `answers`具有以下字段：answerId、questionId、文本

我有这个功能：

```
$result = query("SELECT * FROM questions INNER JOIN answers ON questions.questionId=answers.questionId"); 
```

它返回问题 4 次，每次都有不同的答案。我想要一个包含一系列问题的数组，每个问题都会有一系列相关的答案。

每个问题都有 4 个可能的答案，每个问题都有正确的答案 ID。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T10:32:12.953

MySQL 本身无法返回这样的多维数组，只能返回一个二维数组，其中一级是行，二级是列。

您必须自己迭代结果集并构建数组。

在 PDO 中，你会做这样的事情：

```
try {
    $pdo = new PDO("mysql:host=localhost;dbname=test", "root", "");
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

    $stmt = $pdo->query("SELECT * FROM questions INNER JOIN answers ON questions.questionId=answers.questionId");

    $result = array();

    while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) {
        foreach ($row as $column => $value) {
            if ($column != "answerId") {
                $result[$row["questionId"]][$column] = $value;
            }
        }
        $result[$row["questionId"]][$row["answerId"]] = $row["text"];
    }
}
catch (PDOException $e) {
    //Todo: Error Handling Here
} 
```

这给了我以下结果（你的可能看起来不同）：

```
array (size=2)
  1 => 
    array (size=9)
      'questionId' => string '1' (length=1)
      'title' => string 'b' (length=1)
      'category' => string 'letters' (length=7)
      'correctAnswerID' => string '2' (length=1)
      'text' => string 'd' (length=1)
      1 => string 'a' (length=1)
      2 => string 'b' (length=1)
      3 => string 'c' (length=1)
      4 => string 'd' (length=1)
  2 => 
    array (size=9)
      'questionId' => string '2' (length=1)
      'title' => string 'd' (length=1)
      'category' => string 'letters' (length=7)
      'correctAnswerID' => string '8' (length=1)
      'text' => string 'd' (length=1)
      5 => string 'a' (length=1)
      6 => string 'b' (length=1)
      7 => string 'c' (length=1)
      8 => string 'd' (length=1) 
```

# php - Populate Array from database, search inside and extract strings

> ID：13108040
> 
> 赞同：0
> 
> 时间：2012-10-28T10:27:41.547
> 
> 标签：php, mysql

I am grabbing from a MySQL database some fields and putting them into an array. Here is the code:

```
$dataArray = array();

$query_url = "SELECT * FROM videos";
$query_exec = mysql_query($query_url) or die();

while($res = mysql_fetch_array($query_exec)) {
    echo $dataArray[$res['id']] = $res['video'];
    echo "<br />";      
} 
```

With this I have the printed list of youtube videos taken from my "videos" table, I am trying to get only the last shortcode of youtube, for example: Here is the youtube link: [http://www.youtube.com/watch?v=sN8grtFUQYs](http://www.youtube.com/watch?v=sN8grtFUQYs) I want to get only the: sN8grtFUQYs

How can I get them from an array that gets the data from a MySQL database automatically?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T10:35:03.813

Probably not really efficient but you could explode() it and call end() to get the last result of the array.

```
$dataArray = array();

$query_url = "SELECT * FROM videos";
$query_exec = mysql_query($query_url) or die();

while($res = mysql_fetch_array($query_exec)) {
    echo $dataArray[$res['id']] = end(explode('?v=',$res['video']));
    echo "<br />";      
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T10:32:17.640

```
$dataArray = array();

$query_url = "SELECT * FROM videos";
$query_exec = mysql_query($query_url) or die();

while($res = mysql_fetch_array($query_exec)) {
    preg_match( '/[\?\&]v=([^\?\&]+)/', $res['video'], $id );
    echo $dataArray[$res['id']] = $id[1];
    echo "<br />";      
} 
```

# php - cakephp 视图不回显

> ID：13108046
> 
> 赞同：-1
> 
> 时间：2012-10-28T10:29:30.483
> 
> 标签：php, cakephp, if-statement, views

我有一个页面，其中有一个带有回显的 if 语句，即使满足条件，回显也不会打印到屏幕上。调试时 $invoicedetails **schedule**等于**true**

这是我认为的相关信息

```
<?php

    if($invoicedetails['Invoice']['scheduled']==1)
    {
        $status = 'Scheduled';  
        $fcol = 'Black';
        $bgcol = '#EBD8E8';
        $pay = NULL;
        $dispute = NULL;
    }
    else if($invoicedetails['Invoice']['paid']==1)
    {
        $status = 'Paid';
        $fcol = 'Black';
        $bgcol = '#B9FAEA';
        $pay = NULL;
        $dispute = NULL;
    }
    else if($invoicedetails['Invoice']['sender_id']==$accountid)
    {
        $status = 'Sent';
        $fcol = 'Black';
        $bgcol = '#F8FAC0';
        $pay = NULL;
        $dispute = NULL;
    }
    else if($invoicedetails['Invoice']['receiver_id']==$accountid)
    {
        $status = 'Received';
        $fcol = 'Black';
        $bgcol = '#FAB9B9';

        $pay = $this->Html->link('Pay', array('controller' => 'Invoices','action'=>'pay_admin',$invoicedetails['Invoice']['id'] )) ;
        $dispute = $this->Html->link('Dispute', array('controller' => 'Disputes','action'=>'add_admin',$invoicedetails['Invoice']['id'] ));

    }

?>  

    <tr>
            <th>Actions: </th>
            <td>
            <?php 
            if($invoicedetails['Invoice']['scheduled']=='true'){ 
                echo $pay; 
            }
            ?> 
            <?php echo  $dispute; ?></td>
            </tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T10:44:17.143

首先，您的视图中有太多逻辑。那种东西进入你的控制器。它没有显示任何东西的原因是因为你告诉它不要。

首先你做：

```
if($invoicedetails['Invoice']['scheduled']==1) {
    // (...)
    $pay = NULL;
    $dispute = NULL;
} 
```

然后你告诉它回显那些 NULL 值：

```
if($invoicedetails['Invoice']['scheduled']=='true') { 
    echo $pay; 
}
echo  $dispute; 
```

所以是的，它正在回显那些空值。你期待看到什么？

此外，在第一次检查中，您匹配的是整数 1。在第二次检查中，您匹配的是字符串（所以不是布尔值）true。哪一个？如果它是 0/1 字段，请在 周围加上引号`true`，这样您会得到：

```
if($invoicedetails['Invoice']['scheduled'] == true) { 
```

或者（甚至更短）只是删除整个真实位：

```
if($invoicedetails['Invoice']['scheduled']) { 
```

# ruby-on-rails - Rails 和 Django 应用程序的集成

> ID：13108048
> 
> 赞同：1
> 
> 时间：2012-10-28T10:29:47.490
> 
> 标签：ruby-on-rails, django

集成多个 Web 应用程序的明智方法是什么。在这一点上，我认为他们都将在 Rails 上。Rails 引擎是要走的路还是可以通过视图/ html 被黑客入侵？

如果两个是 Rails 而一个是 Django 会怎样？

我希望这些应用程序能够共享数据，并在主 Rails 应用程序的另一个视图中显示来自一个应用程序的部分视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T11:46:00.687

它们是完全不同的框架，因此它们将无法干净地集成。您可以（尝试）共享数据库中的数据，但您将无法在另一个视图中显示一个视图 - 这没有意义。你最好在一个框架中做所有事情

# ios - iOS：我们能否在用户垂直握持 iPhone 时录制横向视频并实时显示正在录制的内容？

> ID：13108052
> 
> 赞同：1
> 
> 时间：2012-10-28T10:30:47.703
> 
> 标签：ios, video, camera

iOS：我们可以录制水平（横向）视频并在用户垂直握住 iPhone 时实时显示正在录制的内容吗？

我在想如果我们强迫用户拍摄横向（横向）电影，是否可行？

我不确定这是不是个好主意。只是想知道它的技术可行性。

# java - 转换包含嵌套 JSONString 的 JSONObject 时出现 JsonMappingException

> ID：13108053
> 
> 赞同：2
> 
> 时间：2012-10-28T10:30:48.460
> 
> 标签：java, json, facebook-graph-api, jersey, jackson

我正在尝试使用 Jersey 对 Facebook 运行批处理请求。问题是 Facebook 返回了最奇怪的结构——JSONObject 和 JSONString 的混合：

```
[
   {
      "code": 200,
      "headers": [
         {
            "name": "Access-Control-Allow-Origin",
            "value": "*"
         },
         <!-- some more headers... -->
      ],
      "body": "{\n   \"message\": \"Hello World!\",\n   \"id\": \"...\",\n   \"created_time\": \"2012-10-17T07:18:02+0000\"\n 
                   <!-- ... -->
               }"
   }
] 
```

现在，当我尝试使用杰克逊`ObjectMapper`反序列化这个烂摊子时，我得到了一个

```
JsonMappingException: Can not instantiate value of type [simple type, class package.to.Post] from JSON String; no single-String constructor/factory method (through reference chain: package.to.BatchResult["body"]) 
```

这是**我正在使用的 POJO 结构：**

```
public class BatchResult<T> {

    private T body;
    private int code;
    private List<BatchResultHeader> headers;
    // ...
}

public class BatchResultHeader {

    private String name;
    private String value;
    // ...
}

public class Post {

    private String message;
    // ...
} 
```

我像这样**发送批处理请求**。Params 包含文档中定义的批处理参数和批处理请求。还需要批量请求的 POST 调用。所以就像我说的那样，调用应该没问题，因为结果**JSON 符合预期**（见上文）：

```
Client client = Client.create();
WebResource webResource = client.resource("https://graph.facebook.com");
ClientResponse response = webResource.type("application/x-www-form-urlencoded")
            .post(ClientResponse.class, params);
String json = response.getEntity(String.class); 
```

现在我只使用`ObjectMapper`反**序列**化：

```
TypeReference<List<BatchResult<Post>>> ref = new TypeReference<List<BatchResult<Post>>>(){});
ObjectMapper mapper = new ObjectMapper();
List<BatchResult<Post>> batchResults = mapper.readValue(json, ref); 
```

* * *

**使用@JsonCreator？**

因此，当搜索此异常时，我发现了将`@JsonCreator`注释与`Post`构造函数一起使用的建议。然而，这导致了

```
java.lang.IllegalArgumentException: Argument #0 of constructor [constructor for package.to.Post, annotations: {interface org.codehaus.jackson.annotate.JsonCreator=@org.codehaus.jackson.annotate.JsonCreator()}] has no property name annotation; must have name when multiple-paramater constructor annotated as Creator 
```

对此的解决方案似乎是单独注释 POJO 的每个属性，这就是我说的重点：不，谢谢，当然不是！

所以问题仍然存在：有没有办法通过 ObjectMapper 设置反序列化这种混合？

或者我可以告诉 Jersey 过滤传入的格式化字符串并在将其发送给 Jackson 进行反序列化之前剪切所有空格？

* * *

**我不满意的解决方法：**

当我告诉我的`BatchResult`班级那`body`是 a`String`时，它可以工作并且我得到一个带有`String` `body`. 现在`ObjectMapper`再次使用它正确反序列`String` `body`化的`Post.class`类型。这是我当前的解决方案，但它看起来很混乱，我的工作不应该是迭代反序列化结果以反序列化其元素......为什么杰克逊不能自己解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-02T00:02:33.473

# 只是把身体当作一个帖子

如果您不想反序列化正文，那么您只需要为 Post 对象提供一个采用字符串类型的构造函数：

```
public class Post {
    public Post( String message ) {
      this.message = message;
    }
    private String message;
    // ...
} 
```

# 将正文解组为 Post

如果您希望使用字符串中包含的 JSON 填充 Post 对象，则可以使用 JsonDeserializer。首先，您需要定义一个读取字符串值然后解组它的反序列化器。这是一个示例实现：

```
import java.io.IOException;

import org.codehaus.jackson.JsonParser;
import org.codehaus.jackson.JsonProcessingException;
import org.codehaus.jackson.JsonToken;
import org.codehaus.jackson.ObjectCodec;
import org.codehaus.jackson.map.BeanProperty;
import org.codehaus.jackson.map.ContextualDeserializer;
import org.codehaus.jackson.map.DeserializationConfig;
import org.codehaus.jackson.map.DeserializationContext;
import org.codehaus.jackson.map.JsonDeserializer;
import org.codehaus.jackson.map.JsonMappingException;
import org.codehaus.jackson.map.ObjectMapper;
import org.codehaus.jackson.map.ObjectReader;

public class EmbeddedJsonDeserializer
  extends JsonDeserializer<Object>
  implements ContextualDeserializer<Object>
{
  Class<?> type = null;
  public EmbeddedJsonDeserializer() {
  }

  public EmbeddedJsonDeserializer( Class<?> type ) {
    this.type = type;
  }

  @Override
  public Object deserialize(JsonParser parser, DeserializationContext context)
      throws IOException, JsonProcessingException {
    JsonToken curr = parser.getCurrentToken();
    if (curr == JsonToken.VALUE_STRING) {
      if( type == null ) return parser.getText();
      ObjectCodec codec = parser.getCodec();
      if( codec == null ) {
        return new ObjectMapper().readValue(parser.getText(), type);
      }
      else if( codec instanceof ObjectMapper ) {
        return ((ObjectMapper)codec).readValue(parser.getText(), type);
      }
      else if( codec instanceof ObjectReader ) {
        return ((ObjectReader)codec).withType(type).readValue(parser.getText());
      }
      else {
        return new ObjectMapper().readValue(parser.getText(), type);
      }
    }
    throw context.mappingException(type);
  }

  public JsonDeserializer<Object> createContextual(DeserializationConfig config, BeanProperty property) throws JsonMappingException {
    return new EmbeddedJsonDeserializer(property.getType().getRawClass());
  }
} 
```

然后需要在body字段中添加@JsonDeserialize注解，指定要使用的反序列化器：

```
public class BatchResult<T> {
  @JsonDeserialize(using=EmbeddedJsonDeserializer.class)
  private T body;
  ... 
```

您现在应该能够将嵌入的 JSON 嵌入到您的 Post 对象中。

# facebook - Facebook like 用于 joomla 文章内容的社交插件

> ID：13108054
> 
> 赞同：0
> 
> 时间：2012-10-28T10:31:01.487
> 
> 标签：facebook, facebook-like, joomla2.5

我在 joomla2.5 中有一篇文章。我知道可以为每篇文章附加一个类似 facebook 的社交插件，并且还有许多可用的扩展（例如 JFBconnect），但我想知道是否可以为不同的部分附加不同的 facebook那篇文章的内容是什么？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T18:53:08.363

FB Like 使用页面的 URL，因此单个页面只能包含一个 Like 实例。在类别列表页面的情况下，您可能在一个页面上有多个喜欢，因为每个文章/项目都有一个唯一的 URL。

# android - 如何确定 MainActivity 是否从我的 Java 类中暂停？

> ID：13108056
> 
> 赞同：1
> 
> 时间：2012-10-28T10:31:21.260
> 
> 标签：android, android-sensors, android-lifecycle

我在我的应用程序中使用运动传感器检测。

我的设计是这样的：**一个类从主要活动中获取传感器服务引用**，然后实现 SensorEventListener。也就是说，MainActivity 不会监听传感器事件的变化：

```
public void onCreate(Bundle savedInstanceState) {
    // ... code
    mSensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
    mAccelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
    // The following is my java class, it does not extends any android fragment/activty
    mShakeUtil = new ShakeUtil(mSensorManager,mAccelerometer,this);
    // ..more code..
} 
```

不幸的是，我**无法重新设计**ShakeUtil，因此它既不是片段也不是活动。现在为了说明问题考虑：

*   MainActivity 即将被销毁/暂停。即屏幕旋转
*   ShakeUtil 的 onSensorChanged(SensorEvent event) 在此过程中被调用..

onSensorChanged 内部发生的一件事是对话交互，它给出了错误：

```
java.lang.IllegalStateException: Can not perform this action after onSaveInstanceState 
```

当前一个发生在 MainActivity 的 onSaveInstanceState 和 onPause 之间时。我知道如果我成功检测到 MainActivity 正在 ShakeUtil 中暂停，则可以避免这种情况。

**如何检测 MainActivity 正在暂停或从 ShakeUtil 调用 onSaveInstanceState？**

或者，如何在不使 Shakeutil 扩展活动的情况下避免此问题？

到目前为止，我已经尝试过使用标志变量，但这还不够好，我猜这些不是原子操作。我尝试使用 Activity 的 isChangingConfigurations()，但我得到一个未记录的“NoSuchMethodFound”错误。我通过在主活动中的 onPause 时调用 ShakeUtil 来取消注册传感器

# php - 从多维数组中检索值

> ID：13108057
> 
> 赞同：0
> 
> 时间：2012-10-28T10:31:27.807
> 
> 标签：php, multidimensional-array

我有很大的困难。我需要从这个多维数组中检索[title]、[url]和[abstract]值。

另外，我必须将这些值存储在 mysql 数据库中。

提前致谢！！！

```
大批
(
    [bossresponse] => 数组
        (
            [响应码] => 200
            [limitedweb] => 数组
                (
                    [开始] => 0
                    [计数] => 20
                    [总结果] => 972000
                    [结果] => 数组
                        (
                            [0] => 数组
                                (
                                    [日期] =>
                                    [点击网址] => http://www.torchlake.com/
                                    [网址] => http://www.torchlake.com/
                                    [dispurl] => www. 火炬湖.com
                                    [title] => Torch Lake , COLI Inc, Highspeed, Dial-up, Wireless ...
                                    [摘要] => 欢迎来到 COLI Inc. Chain O' Lake Internet。密歇根州北部本地 ISP，在北部提供拨号互联网接入、无线接入、网页设计和 T1 服务...
                                )

                            [1] => 数组
                                (
                                    [日期] =>
                                    [clickurl] => http://en.wikipedia.org/wiki/Torch_Lake_(Antrim_County,_Michigan)
                                    [url] => http://en.wikipedia.org/wiki/Torch_Lake_(Antrim_County,_Michigan)
                                    [dispurl] => en.wikipedia.org/wiki/ Torch_Lake _(Antrim_County,_Michigan)
                                    [title] =>火炬湖（密歇根州安特里姆县）- 维基百科，免费 ...
                                    [摘要] =>长 19 英里（31 公里）的火炬湖是密歇根州最长的湖泊，面积约为 18,770 英亩（76 平方公里），是密歇根州的第二大湖。里面有几...
                                )

```

这是生成此数组的完整代码：

```
要求（“OAuth.php”）；

       $cc_key = "";
       $cc_secret = "";
       $url = "";

       $args = 数组（）；
       $args["q"] = "汽车";
       $args["格式"] = "json";
       $args["计数"] = 20;

       $consumer = new OAuthConsumer($cc_key, $cc_secret);
       $request = OAuthRequest::from_consumer_and_token($consumer, NULL,"GET", $url, $args);
       $request->sign_request(new OAuthSignatureMethod_HMAC_SHA1(), $consumer, NULL);
       $url = sprintf("%s?%s", $url, OAuthUtil::build_http_query($args));
       $ch = curl_init();
       $headers = array($request->to_header());
       curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
       curl_setopt($ch, CURLOPT_URL, $url);
       curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
       $rsp = curl_exec($ch);
       $results = json_decode($rsp, true);

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T10:38:37.243

由于问题中提供的信息有限，我认为这就是您要尝试做的事情：

```
foreach($array['bossresponse']['limitedweb']['results'] as $result)
{
  echo $result['title'] . '<br />';
  echo $result['url'] . '<br />';
  echo $result['abstract'] . '<br />';
  echo '------';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T10:40:59.470

```
$res = $your__variable["bossresponse"]["limitedweb"]["results"];
echo $res[0]["title"]; 
```

创建一个循环来获取所有属性。转义它们并将它们存储到数据库中。

# html - HTML：如何为 Chrome 原生 PDF 阅读器指定 PDF 打开参数？

> ID：13108061
> 
> 赞同：11
> 
> 时间：2012-10-28T10:32:02.737
> 
> 标签：html, google-chrome, pdf

我在我的网站上显示一些 PDF 文档，如下所示：

```
<object id="pdfviewer1" data='b.pdf#page=1&toolbar=0&statusbar=0&messages=0&navpanes=0&scrollbar=0' 
        type='application/pdf' 
        width='500px' 
        height='350px'>
    <p>It appears you don't have a PDF plugin for this browser.</p>
</object> 
```

由于 Chrome 上的原生 PDF 阅读器，所有[openParams](http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/pdf_open_parameters.pdf)选项都被忽略，因为它们是 Adob​​e Reader 的特定选项。

是否可以为 Chrome 原生 PDF 阅读器指定 PDF 打开参数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-05T19:01:26.537

我只是引用@Robotsushi 他[在他的主题](https://stackoverflow.com/questions/7126089/how-to-specify-parameters-to-google-chrome-adobe-pdf-viewer)中写的回答来结束这个问题：

> 在检查了各种 chrome 错误报告后，我可以确认 google chrome 忽略了 adobe pdf 查看器的默认功能，并且在此答案时，无法将缩放等参数传递给 chrome 中的 pdf 查看器。我希望这可以节省其他人一些时间。

编辑：有关更新信息，请参阅[引用的答案](https://stackoverflow.com/questions/7126089/how-to-specify-parameters-to-google-chrome-adobe-pdf-viewer)。自 2017 年 12 月起，Chromium 增加了对`view`、`zoom`、和的支持`page`，后来将其纳入 Chrome。`toolbar``nameddest`

# asp.net - ASP.NET Web 服务 - 将方法限制为 HttpGet 或 HttpPost

> ID：13108063
> 
> 赞同：1
> 
> 时间：2012-10-28T10:32:10.050
> 
> 标签：asp.net, web-services, http-post, asmx, http-get

我正在尝试创建一个以不同方式响应 HttpGet 和 HttpPost 请求的 Web 服务。

我已经启用了 HttpGet ：

```
<webServices>
  <protocols>
    <add name="HttpGet"/>
  </protocols>
</webServices> 
```

我创建了 2 个函数，一个应该为 HttpPost 请求触发，另一个 - 在 HttpGet 上：

```
[WebMethod]
[HttpPost]
[ActionName("HelloWorld")]
public string HelloWorldPost()
{
    return "Hello POST World";
}

[WebMethod]
[HttpGet]
public string HelloWorld()
{
    return "Hello GET World";
} 
```

然而，HttpGet、HttpPost 和 ActionName 似乎被完全忽略了。所有对 HelloWorld 的请求（post 或 get）都会触发第二个函数。我需要以其他方式执行此操作吗？我也试图用这个来限制功能：

```
[ScriptMethod(UseHttpGet = false)] 
```

但这也没有什么不同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T14:43:31.543

我有个主意。

对于初学者，您的 Web 服务的 web.config 文件将如下所示：

```
<webServices>
  <protocols>
     <add name="HttpGet"/>
     <add name="HttpPost"/>
  </protocols>
</webServices> 
```

接下来，无论您使用哪种表单方法，都调用一个 web 方法 x。

```
[WebMethod]
public string X()
{
  //so, you detect which method is invoked by using 
  // HttpContext.Current.Request.HttpMethod
  if (HttpContext.Current.Request.HttpMethod == "POST") {
    //do something now you know it is post method
  }
  else {
    //now, it should be get method and you do something different
  }
//end of web method
} 
```

我的主要观点是您检查`HttpContext.Current.Request.HttpMethod`并根据使用的方法调用不同的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T15:49:07.660

ASP.NET Web 服务应用程序的行为与 ASP.NET MVC 不同，这符合您的预期。如 Amiram Korach 所述，在您的代码中，HttpGet/HttpPost 和 ActionName 属性都属于 MVC。当托管为 Web 服务应用程序时，这些属性将被忽略。

Web 服务应用程序中的“路由”基于方法名称（HelloWorldPost 和 HelloWorld），而不是基于 HTTP VERB。

要触发 POST 流程，您必须调用`HelloWorldPost`(service.asmx/HelloWorldPost)

# xml - XML Schema complexType（自定义数据类型）错误

> ID：13108071
> 
> 赞同：1
> 
> 时间：2012-10-28T10:33:05.470
> 
> 标签：xml, xsd

```
<xs:element name="qualificationRequired" type="ExtendedQualification"/>
    <xs:complexType name="ExtendedQualification">
        <xs:complexContent>
            <xs:extension base="qualifications">
                <xs:element name="other">
                    <xs:element name="skills" type="xs:string"/>
                    <xs:element name="languages" type="xs:string"/>
                </xs:element>
            </xs:extension>
        </xs:complexContent>
    </xs:complexType> 
    </xs:sequence>
</xs:complexType> //closes another complexType above 
```

我的验证器返回以下错误：

> 验证器错误：s4s-elt-must-match.1：“序列”的内容必须匹配（注释？，（元素|组|选择|序列|任何）*）。发现问题始于：complexType。2号线
> 
> 验证器错误 2：src-resolve：无法将名称“ExtendedQualification”解析为（n）“类型定义”组件。第 1 行

为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:02:06.933

`<xs:sequence>`不能包含一个`<xs:complexType>`作为一个孩子。你必须把它放在别处。要么将其包装在一个元素中，从而有效地使其成为嵌套类型，要么将其`<xs:schema>`作为全局类型直接放入元素中。

正如错误消息所说，您可以放入的唯一标签`<xs:sequence>`是：

*   `<xs:element>`
*   `<xs:group>`
*   `<xs:choice>`
*   `<xs:sequence>`
*   `<xs:any>`

此外，`<xs:extension>`不能将`<xs:element>`标签作为子项。您必须将它们包装在`<xs:sequence>`, `<xs:choice>`,`<xs:all>`等中，具体取决于您想要实现的目标。

最后，`<xs:element>`不能包含其他`<xs:element>`标签作为子标签。您必须将它们包装在序列/选择/全部等中，然后`<xs:complexType>`定义嵌套类型。或者将其全部移到外部以用作全局类型。

这是一个有效的文档，定义了您在上面尝试执行的操作。虽然我没有深入了解整个文档，因此可能需要根据上下文进行调整。

```
<xs:schema version="1.0"
       xmlns:xs="http://www.w3.org/2001/XMLSchema"
       elementFormDefault="qualified">
<xs:complexType name="blah">    <!-- You said there was a complexType open, I added its opening tag and gave it a placeholder name -->           
    <xs:sequence>               
        <xs:element name="qualificationRequired" type="ExtendedQualification"/>            
    </xs:sequence>
</xs:complexType>
<xs:complexType name="ExtendedQualification"> <!-- the complexType is now removed from your sequence and is a global type-->
    <xs:complexContent>
        <xs:extension base="qualifications">
            <xs:sequence> <!-- you can't have an element here, you must wrap it in a sequence, choice, all, etc. I chose sequence as it seems to be what you meant -->
                <xs:element name="other">
                    <xs:complexType> <!-- same here, an element can't contain other element tags as children. For a complex element, you need a complexType. I defined it as a nested type -->
                        <xs:sequence> <!-- even complexType can't have element tags as children, again, I used a sequenct -->
                            <xs:element name="skills" type="xs:string"/>
                            <xs:element name="languages" type="xs:string"/>
                        </xs:sequence>
                    </xs:complexType>
                </xs:element>
            </xs:sequence>
        </xs:extension>
    </xs:complexContent>
</xs:complexType> 
</xs:schema> 
```

# lyx - .lyx~ 文件有什么用？

> ID：13108075
> 
> 赞同：6
> 
> 时间：2012-10-28T10:34:15.103
> 
> 标签：lyx

Lyx 在我的普通文件附近保存的 .Lyx~ 文件是什么？它们似乎不是临时文件，因为它们被标记为#*.lyx#，并且它们不会消失。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T10:44:43.070

它们是由您的编辑器创建的文件。传统上，以波浪号结尾的文件被视为具有相同名称但没有波浪号的文件的备份。有关说明，请参阅[维基百科页面](http://en.wikipedia.org/wiki/Tilde#Backup_filenames)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-30T09:18:56.173

供以后偶然发现此页面的人（例如我）参考，[这是](https://www.mail-archive.com/lyx-users@lists.lyx.org/msg78488.html)来自 lyx 用户邮件存档的更详细的答案。

显然，这些`*.lyx~`文件用于在*保存*失败时恢复文件。这些`#*.lyx#`文件用于每隔几分钟自动备份一次文件。保存文件时会自动删除后者。前者不是。

# scala - 特化一个接受类型参数的方法

> ID：13108076
> 
> 赞同：0
> 
> 时间：2012-10-28T10:34:16.633
> 
> 标签：scala

我想编写具有通用的、可能很慢的类型参数化方法实现的代码，该方法适用于实现某个接口的所有类，但如果子类愿意，仍然允许使用更有效的实现来专门化此方法。

但是，下面的代码不太好用

```
class A(val i:Int)

class B {
    def f[T](t:T) = println(t.toString)
}

class C extends B { 
    override def f[A](a:A) = println(a.i * a.i) 
} 
```

因为它将 C 类中的 A 视为类型参数，而不是在类型参数仅为 A 的情况下覆盖函数的东西。

有没有办法在运行时不使用 match 来编写我想要的代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T10:49:37.827

你要做的是：

```
scala> class A(val i: Int)
defined class A

scala> class B { 
     |   def f[T](t: T) = println(t.toString)
     | }
defined class B

scala> class C extends B { 
     |   override def f[T <: A](a: T) = println(a.i * a.i) 
     | }
<console>:10: error: overriding method f in class B of type [T](t: T)Unit;
 method f has incompatible type
         override def f[T <: A](a: T) = println(a.i * a.i) 
```

但正如类型系统告诉你的那样，这是**错误**的。您在这里违反了[Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)。

相反，您可以做的是创建`T`类级别类型参数或抽象类型成员。然后您可以将其约束在子类中，如下所示：

```
scala> class B {
     |   type T
     |   def f(t: T) = println(t.toString)
     | }
defined class B

scala> class C extends B {
     |   type T = A
     |   override def f(a: T) = println(a.i * a.i)
     | }
defined class C

scala> (new C).f(new A(11))
121 
```

您没有提供更多信息，所以我不知道这是否适用于您的特定情况。

**编辑：**

这是一种特殊化事物的方法：使用类型类。代码：（结果比预期的要复杂。）

```
scala> :paste
// Entering paste mode (ctrl-D to finish)

case class A(i: Int)

case object B

trait F[-A] {
  def f(a: A): Unit
}

trait FLowPriorityImplicits {
  implicit object FAny extends F[Any] {
    def f(a: Any) = println(a.toString)
  }
}

trait FImplicits extends FLowPriorityImplicits {
  implicit object FA extends F[A] {
    def f(a: A) = println(a.i * a.i)
  }
}

object F extends FImplicits

def f[A](x: A)(implicit f: F[A]) = f.f(x)

// Exiting paste mode, now interpreting.

defined class A
defined module B
defined trait F
defined trait FLowPriorityImplicits
defined trait FImplicits
defined module F
f: [A](x: A)(implicit f: F[A])Unit

scala> f(B)
B

scala> f(A(2))
4 
```

# php - ajax call to php script not working

> ID：13108093
> 
> 赞同：1
> 
> 时间：2012-10-28T10:37:32.810
> 
> 标签：php, javascript, ajax

I am trying to call a PHP script using AJAX. I have put a simple echo alert in my deleteitem.php script to check whether it is getting called, but whatever I do, it does not get called. The PHP script is in the same folder as the js script that is calling it

Can someone tell me why that would be? What are the possible causes?

```
$.ajax({
    url: 'deleteitem.php?task=deleteArtwork&id='+artworkObjectID,
        type: "POST",
        dataType: "html",
        success: function(data)
        {
           //do something here
        }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T10:42:35.247

How would you know if it's calling it? Add a `javascript` alert statement to your `callback`. E.g

```
alert(data); 
```

It will show what you echoed from the `PHP` `script`, if you got everything right.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T10:42:52.517

The output of the PHP script will be placed in `data` (assuming that the request is successful).

It won't do anything until you replace the comment `//do something here` with some code that does something.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T10:44:41.650

Try something like .. passing data like below

```
 $.ajax({
                    url: "deleteitem.php",
                    type: "POST",
                     data: { 
                          'task': 'deleteArtwork', 
                          'id': artworkObjectID
                     },              
                    success: function (msg) {

                    }
                }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-28T10:49:21.830

The first thing I would be doing is checking the results of the success callback.

```
$.ajax({
    url: 'deleteitem.php?task=deleteArtwork&id='+artworkObjectID,
        type: "POST",
        dataType: "html",
        success: function(data)
        {
           alert(data); // Alert the results
        }
}); 
```

Most times (with myself anyway) when I notice things aren't being updated by ajax is usually a PHP error with my script im calling. This method will alert any errors that PHP throws on that page :)

Also, try and check your browser console and see if there are any errors from your javascript.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-28T10:50:44.783

As Amitd said, you shouldn't combine **GET** and **POST** requests. The code should look like:

```
$.ajax({
    url: 'deleteitem.php?task=deleteArtwork&id='+artworkObjectID,
        type: "GET",
        dataType: "html",
        success: function(data)
        {
           alert(data); // alert on success
        }
}); 
```

If you still don't get any response, there might be a server error, so you should put lines like this one in the .php script, at the beggining of the script:

```
error_log("script was called, processing request...");
error_log("passed artworkObjectId is: " . $_GET["artworkObjectID"]); 
```

You can then check in your .log file (it can be found in the apache log file/folder if it's running on apache server) if there are any messages.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-28T10:53:11.063

To check whether the server code is called or not, you can check passed parameters and the AJAX response in Firebug. It would be handy I guess.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-28T10:49:29.377

First of all, you're not outputting the returned data, stored in (your case) `data` Also, you're parsing along some GET variables, although your AJAX-request is POST. If you're working with variables over AJAX, i recomend using GET:

```
$.get('deleteitem.php?task=deleteArtwork&id='+artworkObjectID, function (data) {
    //On success, perhaps print the returned data:
    alert(data);
}) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-12-29T13:57:13.240

Make sure the file you has created is having valid file Type like **PHP file** or just copy paste the existing valid working php file and write you ajax code in it. It will work now. **myAjax file** shown in below image is invalid file and **material** is valid PHP file[![enter image description here](../Images/eed23694d9e2f02111a99eeafafb7fff.png)](https://i.stack.imgur.com/t8GfR.png)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-08-25T17:30:46.717

```
url: 'deleteitem.php?task=deleteArtwork&id='+artworkObjectID 
```

should be

```
url: 'deleteitem.php?task=deleteArtwork&id='.artworkObjectID, 
```

# mysql - 简单的mysql数据库

> ID：13108096
> 
> 赞同：0
> 
> 时间：2012-10-28T10:38:01.113
> 
> 标签：mysql

我正在创建一个简单的 mysql 数据库，但出现以下错误：`Parse error: syntax error, unexpected 'aasda' (T_STRING)`在线：`VALUES ("aasda", "sa", "asda", 43, "ada")");`

这是代码：

```
$con=mysql_connect("localhost","root","");

if (!$con)
{
    die ("Could not connect: " . mysql_error());
}
if (mysql_query("CREATE DATABASE my_db",$con))
  {
  echo "Database created";
  }
else
{
die("not");
}
mysql_select_db("my_db", $con);
$sql = "CREATE TABLE Users
(
username varchar(20),
firstname varchar(15),
lastname varchar(15),
age int,
emailadress varchar(20)
)";

mysql_query($sql,$con);

mysql_query("INSERT INTO Users (username, firstname, lastname, age, emailadress)
VALUES ("aasda", "sa", "asda", 43, "ada")");

mysql_close($con); 
```

我不明白我做错了什么。感谢您的帮助和耐心！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T10:39:10.100

使用单引号

```
mysql_query("INSERT INTO Users (username, firstname, lastname, age, emailadress)
             VALUES ('aasda', 'sa', 'asda', 43, 'ada')"); 
```

还有一件事，您的查询很容易受到攻击`SQL Injection`，请花时间阅读下面的文章以保护自己免受`SQLInjection`

*   [如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T10:39:32.047

```
mysql_query("INSERT INTO Users (username, firstname, lastname, age, emailadress)
VALUES ('aasda', 'sa', 'asda', 43, 'ada')"); 
```

# php - 使用 PHP 进行高效的横幅旋转

> ID：13108097
> 
> 赞同：1
> 
> 时间：2012-10-28T10:38:13.797
> 
> 标签：php, random, rotation, banner

我通过从一系列横幅中随机选择来旋转我网站上的横幅。

示例代码作为演示：

```
<?php
$banners = array(
'<iframe>...</iframe>',
'<a href="#"><img src="#.jpg" alt="" /></a>',
//and so on
);
echo $banners(rand(0, count($banners)));
?> 
```

横幅的阵列变得相当大。我关心这个数组添加到我的页面执行中的内存量。但是如果不将所有横幅都加载到内存中，我想不出更好的方法来显示随机横幅......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T10:44:13.467

创建一个数据库来存储横幅。然后，当您加载页面时，您可以使用 SQL 查询来选择随机行。

```
SELECT * FROM banners ORDER BY RAND() LIMIT 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T10:43:06.630

将横幅移动到 html 文件并将数组更改为仅包含文件名。

然后您可以按名称包含该文件，仅加载所需的横幅。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T10:51:26.043

一种不需要数组内存或数据库的方法是遵循增量图像命名约定，例如将图像命名为“banner1.jpg”、“banner2.jpg”等。然后你可以这样做：

```
$int_banners = 10;  // the number of banner images you have
$i = rand(1, $int_banners);
echo "<a href='#'><img src='banner$i.jpg' alt=''></a>";  // add an iframe too if you want 
```

如果您不能使用这样的约定，那么您可以创建一个仅包含文件名的数组（或使用 SQL 数据库来存储横幅，如其他答案中所建议的那样）。

```
$lst_banners = array("img1.jpg", "/home/img2.jpg", "/about/img3.jpg");
$int_banners = count($lst_banners);
$i = rand(0, ($int_banners - 1));
echo "<a href='#'><img src='" . $lst_banners[$i] . "' alt=''></a>"; 
```

或者更好的是，您可以使用[array_rand()](http://php.net/manual/en/function.array-rand.php)来查找文件名，如[Zlatan](https://stackoverflow.com/users/1386320/zlatan)所建议的：

```
$lst_banners = array("img1.jpg", "/home/img2.jpg", "/about/img3.jpg");
$name = array_rand($lst_banners, 1);
echo "<a href='#'><img src='$name' alt=''></a>"; 
```

# .net - WF4：验证活动的所有退出状态是否已转换到其他活动

> ID：13108099
> 
> 赞同：3
> 
> 时间：2012-10-28T10:38:30.320
> 
> 标签：.net, workflow-foundation-4, state-machine

我们正在尝试改变我们的业务流程，以便通过 WF4 实现它。我们的业务流程是这样的：

*   有许多处理程序。
*   每个处理程序都有许多输出状态。
*   处理程序被实现为活动
*   设计人员将支持这些活动的输出状态，以便
    *   我们可以很容易地看到哪些状态会导致接下来的活动
    *   我们可以在编译时验证每个活动的所有状态都与其他活动相关联。

我们如何在 WF4 中实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T05:21:45.460

也许您可以在处理程序活动中定义所需的属性（转换活动）。然后在处理程序的**CacheMetadata**覆盖中，您可以验证是否提供了它们。在处理程序活动的**Execute**方法结束时，您可以使用工作流运行时安排分配的转换活动。类似于以下内容：

```
public sealed class MyHandlerActivity : NativeActivity
{
    public MyHandlerActivity NextHandler
    {
        get;
        set;
    }

    protected override void CacheMetadata(NativeActivityMetadata metadata)
    {
        // Ensure next handler is supplied.
        if (this.NextHandler == null)
        {
            metadata.AddValidationError("Next handler is not assigned.");
            return;
        }

        // Let the workflow runtime that this activity could schedule another activity (the handler activity).
        metadata.AddChild(this.NextHandler);
    }

    protected override void Execute(NativeActivityContext context)
    {
        // TODO: Handler should do something here.

        // Schedule the next handler.
        context.ScheduleActivity(this.NextHandler);
    }
} 
```

# android - 在android中执行登录和注销

> ID：13108105
> 
> 赞同：2
> 
> 时间：2012-10-28T10:39:21.607
> 
> 标签：android

在我的应用程序中，在用户注册或登录后，要留在会话中，直到该人注销。我发现有些人在谈论为此使用 sharedPreferences ，但我真的不知道如何使用它来完成此操作！

如何使用 sharedPreferences 来管理登录/注销？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T10:41:47.790

这是一些可以帮助您的入门代码：

```
public String getStringPreference(String key) {
            return settings.getString(key,  null); 
    }

    public void setStringPreference(String key, String value) {

        settings.edit().putString(key, value).commit();

    } 
```

在您的活动或应用程序的 onCreate 中，调用此：

```
settings = getApplicationContext().getSharedPreferences(PREFS_FILE, Context.MODE_PRIVATE); 
```

在您的班级中将设置定义为：

```
SharedPreferences settings; 
```

SharedPreferences 在某种程度上类似于网页的 cookie。它们允许您使用键/值存储（基本上是“something”=“somevalue”）长时间存储小块信息；

在成功验证用户凭据后（您可能会进行某种登录活动），您会将他们的用户名和/或散列密码或令牌存储在共享首选项中。如果您调用 getStringPreference("userId") 并且它没有返回 null，那么您已登录（您需要比这更强大的东西，但这是一个开始）。

# xcode - 基于视图的 NSTableView 的模型键路径问题

> ID：13108109
> 
> 赞同：0
> 
> 时间：2012-10-28T10:40:39.693
> 
> 标签：xcode, key, nstableview, cocoa-bindings

在设置绑定以使用时，`NSTableView`我遇到了一个问题。我的数组控制器绑定到我的表控制器，它的模型键路径是我用来填充表的数组。我还设置了一个键，称为`name`.

我的表视图绑定到我的阵列控制器，并且控制器键设置为`arrangedObjects`. 最后，`NSTextField`绑定到Table Cell View，这就是问题所在。当我尝试输入我的模型键路径时，我可以输入`objectValue`，但是当我去添加时，`.name`会出现“未找到完成”工具提示。

为什么我的密钥没有被拉到 NSTableView 绑定？

我应该补充一点，我已经按照 Apple 文档的要求写了这封信，但它仍然没有通过我的密钥。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T14:06:01.723

中间 TableCellView 对象正在“破坏”您添加到 NSArrayController 的键和控件之间的链接。我不会担心的。如果您知道 keyPath 是正确的，只需输入它，即使没有自动完成。如果 Xcode 足够聪明，可以自动弥合这一差距，那就太好了，但我不认为它是一个“危险信号”，它没有。尽管自动完成没有填写密钥，但我肯定有很多案例可以正常工作。

# ios - NSDateFormatter iOS6 问题

> ID：13108110
> 
> 赞同：0
> 
> 时间：2012-10-28T10:40:44.373
> 
> 标签：ios, ios6, nsdateformatter

我已经为 UIButton press 编写了一个代码来减少日期。当前日期显示在 UILabel 文本属性中，并在按下按钮时更改为上一个日期。以下代码适用于 iOS5，但不适用于 iOS6。对于 iOS6，它给出的输出为 1999 年 12 月 31 日或 null。

```
- (IBAction)showPrevDate:(id)sender
{
   NSString *dateForDecrement = _showDateLbl.text;
   [dateFormatter setDateFormat:@"MMM d, yyyy (EEE)"];

   NSDate *dateObjectForDecrement = [dateFormatter dateFromString:dateForDecrement];

   int subtractDays = 1;

   dateAfterDecrement=[dateObjectForDecrement dateByAddingTimeInterval:-(24*60*60 * subtractDays)];

  _showDateLbl.text = [NSString stringWithFormat:@"%@", [dateFormatter stringFromDate:dateAfterDecrement]];   
} 
```

任何人都可以验证这一点，或者告诉我它是否是 iOS6 中的错误？

多谢你们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T10:50:59.770

我认为这是一个错误。我在 iOS 5 和 6 之间遇到了不同行为的相同问题。

看一下这个：

[http://openradar.appspot.com/12385667](http://openradar.appspot.com/12385667)

[http://openradar.appspot.com/12358210](http://openradar.appspot.com/12358210)

也许你喜欢其中之一。

# objective-c - 图像在 iOS 模拟器 6.0 中加载到 UIImageView，但在 5.1 中未加载

> ID：13108111
> 
> 赞同：0
> 
> 时间：2012-10-28T10:40:55.273
> 
> 标签：objective-c, ios

有人遇到过这个问题吗？

这是 ViewController.m 中的代码。我在附加到名为“imageView”的 IBOutlet 的 XIB 文件中有一个 UIImageView

```
-(void)viewDidLoad
{
    [super viewDidLoad];
    NSURL *url = [NSURL URLWithString:@"http://www.google.co.il/images/nav_logo114.png"];
    NSData *data = [NSData dataWithContentsOfURL:url];
    self.imageView = [self.imageView initWithImage:[UIImage imageWithData:data]];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T10:54:40.020

代替

```
self.imageView = [self.imageView initWithImage:[UIImage imageWithData:data]]; 
```

做这个：

```
self.imageView.image = [UIImage imageWithData:data]; 
```

不要忘记`@synthesize imageView`

# java - 为什么 @Deprecated 注释不会触发有关方法的编译器警告？

> ID：13108112
> 
> 赞同：5
> 
> 时间：2012-10-28T10:40:58.020
> 
> 标签：java, annotations

我正在尝试使用[@Deprecated 注释](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Deprecated.html)。@Deprecated 文档说：“当在非弃用代码中使用或覆盖弃用的程序元素时，编译器会发出警告”。我认为这应该触发它，但它没有。javac 版本 1.7.0_09 并使用和不使用 -Xlint 和 -deprecation 进行编译。

```
public class TestAnnotations {

   public static void main(String[] args)
   {
      TestAnnotations theApp = new TestAnnotations();
      theApp.thisIsDeprecated();
   }

   @Deprecated
   public void thisIsDeprecated()
   {
      System.out.println("doing it the old way");
   }
} 
```

编辑：根据下面 gd1 的评论，它仅在该方法在另一个类中时才有效，我添加了第二个类。它确实在调用 theOldWay() 时发出警告：

```
public class TestAnnotations {

   public static void main(String[] args)
   {
      TestAnnotations theApp = new TestAnnotations();
      theApp.thisIsDeprecated();
      OtherClass thatClass = new OtherClass();
      thatClass.theOldWay();
   }

   @Deprecated
   public void thisIsDeprecated()
   {
      System.out.println("doing it the old way");
   }
}

class OtherClass {

   @Deprecated
   void theOldWay()
   {
      System.out.println("gone out of style");
   }

} 
```

警告：

> /home/java/TestAnnotations.java:10：警告：[deprecation] OtherClass 中的 theOldWay() 已被弃用
> 
> ```
>  thatClass.theOldWay();
>              ^ 
> ```
> 
> 1 个警告

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T11:00:05.127

From the [Java Language Specification](http://docs.oracle.com/javase/specs/jls/se7/html/jls-9.html#jls-9.6.3.6):

> A Java compiler must produce a deprecation warning when a type, method, field, or constructor whose declaration is annotated with the annotation @Deprecated is used (i.e. overridden, invoked, or referenced by name), unless:
> 
> *   The use is within an entity that is itself annotated with the annotation @Deprecated; or
>     
>     
> *   The use is within an entity that is annotated to suppress the warning with the annotation @SuppressWarnings("deprecation"); or
>     
>     
> *   The use and declaration are both within the same outermost class.

Your example is an example of the last condition: you're only using the deprecated method from the same outermost class as the deprecated method.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T10:55:53.753

Deprecation Doesn't always trigger warnings. You have to manage Deprecation logic in your framework/application.

From [1.5 JavaDoc:](http://docs.oracle.com/javase/1.5.0/docs/guide/javadoc/deprecation/deprecation.html)

> NOTE: The Java Language Specification requires compilers to issue warnings when classes, methods, or fields marked with the @Deprecated annotation are used. Compilers are not required by the Java Language Specification to issue warnings when classes, methods, or fields marked with the @deprecated Javadoc tag are accessed, although the Sun compilers currently do so. However, there is no guarantee that the Sun compiler will always issue such warnings.

# python - 检测 2 个 HTML 片段是否具有相同的层次结构

> ID：13108117
> 
> 赞同：0
> 
> 时间：2012-10-28T10:41:12.580
> 
> 标签：python, html, xml, lxml

具有相同层次结构的片段示例：

```
(1)
<div>
  <span>It's a message</span>
</div>

(2)
<div>
  <span class='bold'>This is a new text</span>
</div> 
```

具有不同结构的片段示例：

```
(1)
<div>
  <span><b>It's a message</b></span>
</div>

(2)
<div>
  <span>This is a new text</span>
</div> 
```

因此，具有相似结构的片段对应于一棵分层树（相同的标签名称，相同的分层结构）。

如何仅使用 lxml 检测 2 个元素（html 片段）是否具有相同的结构？

对于一些更困难的情况（比示例），我有一个功能无法正常工作：

```
def _is_equal( el1, el2 ):      
    # input: 2 elements with possible equal structure and tag names
    # e.g. root = lxml.html.fromstring( buf )
    # el1 = root[ 0 ]
    # el2 = root[ 1 ]
    # move from top to bottom, compare elements
    result = False  

    if el1.tag == el2.tag:
        # has no children
        if len( el1 ) == len( el2 ):
            if len( el1 ) == 0:             
                return True
            else:
                # iterate one of them, for example el1
                i = 0
                for child1 in el1:
                    child2 = el2[ i ]
                    is_equal2 = _is_equal( child1, child2 )
                    if not is_equal2:
                        return False
                return True                     
        else:
            return False
    else:
        return False 
```

该代码无法检测到 2 个带有 class='tovar2' 的 div 具有相同的结构：

```
<body>

    <div class="tovar2">
        <h2 class="new">
            <a href="http://modnyedeti-krsk.ru/magazin/product/333193003">
                Куртка  д/д
            </a>
        </h2>
        <ul class="art">
            <li>
                Артикул: <span>1759</span>
            </li>
        </ul>
        <div>
            <div class="wrap" style="width:180px;"> 
                <div class="new">
                    <img src="shop_files/new-t.png" alt="">
                </div>     
                <a class="highslide" href="http://modnyedeti-krsk.ru/d/459730/d/820.jpg" onclick="return hs.expand(this)"> 
                    <img src="shop_files/fr_5.gif" style="background:url(/d/459730/d/548470803_5.jpg) 50% 50% no-repeat scroll;" alt="Куртка  д/д" height="160" width="180"> 
                </a>     
            </div>
        </div>

        <form action="" onsubmit="return addProductForm(17094601,333193003,3150.00,this,false);">
            <ul class="bott ">
                <li class="price">Цена:<br>
                    <span>
                        <b>
                            3 150
                        </b> руб.
                    </span>
                </li>
                <li class="amount">Кол-во:<br><input class="number" onclick="this.select()" value="1" name="product_amount" type="text">
                </li>
                <li class="buy"><input value="" type="submit">
                </li>
            </ul>
        </form>
    </div>

    <div class="tovar2">
        <h2 class="new">
            <a href="http://modnyedeti-krsk.ru/magazin/product/333124803">Куртка  д/д</a>
        </h2>
        <ul class="art">
            <li>
                Артикул: <span>1759</span>
            </li>
        </ul>
        <div>
            <div class="wrap" style="width:180px;"> 
                <div class="new">
                    <img src="shop_files/new-t.png" alt="">
                </div>     
                <a class="highslide" href="http://modnyedeti-krsk.ru/d/459730/d/820.jpg" onclick="return hs.expand(this)"> 
                    <img src="shop_files/fr_5.gif" style="background:url(/d/459730/d/548470803_5.jpg) 50% 50% no-repeat scroll;" alt="Куртка  д/д" height="160" width="180"> 
                </a>      
            </div>
        </div>      

        <form action="" onsubmit="return addProductForm(17094601,333124803,3150.00,this,false);">
            <ul class="bott ">
                <li class="price">Цена:<br>
                    <span>
                        <b>3 150</b> руб.
                    </span>
                </li>
                <li class="amount">Кол-во:<br><input class="number" onclick="this.select()" value="1" name="product_amount" type="text">
                </li>
                <li class="buy">
                    <input value="" type="submit">
                </li>
            </ul>
        </form>
    </div>

    </body> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T10:56:19.643

你把事情复杂了一点，你只需要`False`在事情被证明不是的时候才回来`True`。

两个元素在标签匹配、长度匹配且每个配对子元素相同时相等。

[Python 可以使用函数](http://docs.python.org/2/library/functions.html#all)测试序列中的所有元素是否`True`真的很容易，并且通过使用我们可以很好地配对元素子元素。如果任何子对*不*相等，将提前终止：[`all()`](http://docs.python.org/2/library/functions.html#all)[`zip()`](http://docs.python.org/2/library/functions.html#zip)`all()`

 *```
def _is_equal( el1, el2 ):      
    if el1.tag == el2.tag and len(el1) == len(el2):
        return all(_is_equal(c1, c2) for c1, c2 in zip(el1, el2))

    return False 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T11:02:23.730

您现有代码失败的原因是在有多个孩子的情况下， i 设置错误；您将其分配为零，然后从不增加它，因此您将 el1 的每个元素与 el2 的*第一个*元素进行比较，而不是与 el2 中与其相同位置的元素进行比较。

要修复现有代码，只需执行以下操作：

```
def _is_equal( el1, el2 ):      
    # input: 2 elements with possible equal structure and tag names
    # e.g. root = lxml.html.fromstring( buf )
    # el1 = root[ 0 ]
    # el2 = root[ 1 ]
    # move from top to bottom, compare elements
    result = False  

    if el1.tag == el2.tag:
        # has no children
        if len( el1 ) == len( el2 ):
            if len( el1 ) == 0:             
                return True
            else:
                # iterate one of them, for example el1
                for i, child1 in enumerate(el1):
                    child2 = el2[ i ]
                    is_equal2 = _is_equal( child1, child2 )
                    if not is_equal2:
                        return False
                return True                     
        else:
            return False
    else:
        return False 
```

但是，您现有的代码可以变得更加简洁。您正在测试三个条件：1）标记匹配 2）相同数量的孩子 3）所有条件都适用于每对孩子

这些中的每一个都是 Python 中的单行表达式。因此，您可以执行以下操作：

```
def _is_equal(el1, el2):
    return (el1.tag == el2.tag and
            len(el1) == len(el2) and
            all(_is_equal(c1, c2) for c1, c2 in zip(el1, el2))) 
```

请注意，由于一旦它迭代的任何一个元素`and`发生短路并`all`返回`False`，这不会进行任何不必要的额外计算。*

# android - targetSdkVersion 更新到 15 后 Android 自定义视图模糊

> ID：13108118
> 
> 赞同：2
> 
> 时间：2012-10-28T10:41:13.047
> 
> 标签：android, view, draw, android-4.0-ice-cream-sandwich

我正在开发一个带有自定义视图的应用程序。

```
public class Disegno extends View {
...
} 
```

直到最后一次更新都没问题。现在，要进入蓝牙管理，我需要将 targetSdkVersion 从 8 增加到 15。通过清单中的这个修改，当我缩放时，**绘图是模糊的！** 我正在使用多种设备测试该应用程序。只有 Android 4.0 及更高版本的设备会出现此问题。我对自定义 Rom GingerBread 的 HTC 愿望正在发挥作用！你能帮助我吗！？

看看以下图片：

！！！啊！！！我不能放任何图像，因为我是新人！！！！

[目标SDK版本 8](http://www.studioundici.it/disco/targetversion8.png)

[目标SDK版本 15](http://www.studioundici.it/disco/targetversion15.png)

# jquery - 使用 WCF 数据服务使用 OData 时出现 JSON 错误

> ID：13108127
> 
> 赞同：2
> 
> 时间：2012-10-28T10:42:33.097
> 
> 标签：jquery, json, wcf-data-services, odata

我正在使用 Visual Studio 2012。我创建了一个名为 ODataService 的空 Web 应用程序项目，并添加了一个 SQL Server Compact 4.0 本地数据库，然后添加了一个与本地数据库映射的 ADO.NET 实体数据模型。现在添加了一个使用实体模型的 WCF 数据服务。所有这些都在一个单独的项目下，即 ODataService。创建后，我可以轻松地从浏览器查询数据：

```
i.e. http://localhost:52964/EmployeeService.svc/Employees()?$filter=ID gt 3 
```

现在，我在拥有 ODataService 项目的同一解决方案下添加了一个 MVC3 应用程序。在那个 MVC3 项目中，我在 Index.cshtml 中编写了以下代码，以使用 jquery 使用 odata：

```
<script type="text/javascript">
$(document).ready(function () {
var qry = "http://localhost:52964/EmployeeService.svc/Employees?$filter=ID gt 3&$callback=callback&$format=json";
    var qry2 = "http://odata.netflix.com/v2/Catalog/Titles?$filter=ReleaseYear gt 2012&AverageRating gt 4&$callback=callback&$format=json";
    $('#loadData').click(function () {
        $('#loadingText').text('loading data...');

        $.ajax({
            dataType: "jsonp",
            url: qry,
            jsonpCallback: "callback",
            success: callback,
            error: function (jqXHR, textStatus, errorThrown) {
                debugger;
            }

        });

    });

    function callback(result) {
        debugger;
    }
}); 
```

当我使用 qry2 时，我的代码运行良好，但是当使用 qry 时，调试器在错误部分命中并显示“parsererror”-“callback was not called”。

任何形式的帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T02:03:45.673

您是否在数据服务中添加了对 JSONP 的支持？您可以查看[http://archive.msdn.microsoft.com/DataServicesJSONP](http://archive.msdn.microsoft.com/DataServicesJSONP)以获取有关如何执行此操作的说明。

一个更好的选择可能是使用 WCF 数据服务 5.1.0-rc2，它增加了对 $format/$callback 的内置支持：http: [//blogs.msdn.com/b/astoriateam/archive/2012/09 /26/wcf-data-service-5-1-0-rc2-released.aspx](http://blogs.msdn.com/b/astoriateam/archive/2012/09/26/wcf-data-service-5-1-0-rc2-released.aspx)

# iphone - PhoneGap2.1 iOS6 在恢复时崩溃 (EXC_BAD_ACCESS)

> ID：13108131
> 
> 赞同：1
> 
> 时间：2012-10-28T10:42:55.607
> 
> 标签：iphone, cordova, ios6

现象：

仅在 ios6 上发生，在 ios5 上不发生

应用程序被暂停（点击顶部的电源按钮）并立即（~1-2 秒）恢复 -> 没问题

应用程序暂停并在一段时间后恢复（1-2 分钟）-> 应用程序崩溃

它似乎与应用程序功能完全无关，因为它发生在每个屏幕上，包括仅显示照片 + 使用 facebook btn 登录的屏幕（在使用 FB 登录之前）

我会很感激这里的任何帮助

应用程序崩溃前的警告

```
Oct 21 19:40:52 Sharon-Mantins-iPhone backboardd[52] <Warning>: CoreAnimation: updates deferred for too long
Oct 21 19:40:52 Sharon-Mantins-iPhone backboardd[52] <Warning>: CoreAnimation: timed out fence 25567
Oct 21 19:40:52 Sharon-Mantins-iPhone SpringBoard[69] <Warning>: CoreAnimation: failed to receive fence reply: 10004003 
```

崩溃报告

```
Oct 21 19:40:52 Sharon-Mantins-iPhone ReportCrash[4562] <Notice>: Formulating crash report for process socialPlace[4544]
Oct 21 19:40:53 Sharon-Mantins-iPhone com.apple.launchd[1] (UIKitApplication:net.socialplace.ios[0x9fa5][4544]) <Warning>: (UIKitApplication:net.socialplace.ios[0x9fa5]) Job appears to have crashed: Segmentation fault: 11
Oct 21 19:40:53 Sharon-Mantins-iPhone backboardd[52] <Warning>: Application 'UIKitApplication:net.socialplace.ios[0x9fa5]' exited abnormally with signal 11: Segmentation fault: 11
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Not saving crash log because we have reached the limit for logs to store on disk.  Sync or otherwise clear logs from /var/mobile/Library/Logs/CrashReporter to save new logs.
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Could not save crash report to disk!
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: libMobileGestalt copySystemVersionDictionaryValue: Could not lookup ReleaseType from system version dictionary
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Incident Identifier: FB82D672-4DD9-4316-96B5-95591B4EA7C8
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: CrashReporter Key:   571a819d6942642be43b1132967c9fcdb607ff24
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Hardware Model:      iPhone4,1
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Process:         socialPlace [4544]
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Path:            /var/mobile/Applications/0F954FA6-B820-46A5-9053-DA09D9A17A39/socialPlace.app/socialPlace
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Identifier:      socialPlace
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Version:         ??? (???)
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Code Type:       ARM (Native)
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Parent Process:  launchd [1]
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Date/Time:       2012-10-21 19:40:52.242 +0200
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: OS Version:      iOS 6.0 (10A403)
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Report Version:  104
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Exception Type:  EXC_BAD_ACCESS (SIGSEGV)
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Exception Codes: KERN_INVALID_ADDRESS at 0x00000009
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Crashed Thread:  2
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 0 name:  Dispatch queue: com.apple.main-thread
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 0:
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0   libsystem_kernel.dylib         0x31a310fc 0x31a20000 + 69884
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 1   libsystem_c.dylib              0x39bb0124 0x39baf000 + 4388
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 2   WebCore                        0x35319a1c 0x3530d000 + 51740
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 3   WebCore                        0x3531a922 0x3530d000 + 55586
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 4   UIKit                          0x3736aa04 0x370fb000 + 2554372
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 5   socialPlace                    0x00114a68 0xde000 + 223848
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 6   socialPlace                    0x00114a14 0xde000 + 223764
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 7   Foundation                     0x338f08e8 0x3383f000 + 727272
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 8   CoreFoundation                 0x35e02680 0x35d6b000 + 620160
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 9   CoreFoundation                 0x35e01ee4 0x35d6b000 + 618212
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 10  CoreFoundation                 0x35e00cb2 0x35d6b000 + 613554
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 11  CoreFoundation                 0x35d73eb8 0x35d6b000 + 36536
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 12  CoreFoundation                 0x35d73d44 0x35d6b000 + 36164
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 13  GraphicsServices               0x362b02e6 0x362ab000 + 21222
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 14  UIKit                          0x371522fc 0x370fb000 + 357116
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 15  socialPlace                    0x000e06b2 0xde000 + 9906
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 16  socialPlace                    0x000e0664 0xde000 + 9828
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 1 name:  Dispatch queue: com.apple.libdispatch-manager
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 1:
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0   libsystem_kernel.dylib         0x31a21648 0x31a20000 + 5704
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 1   libdispatch.dylib              0x34b24974 0x34b1c000 + 35188
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 2   libdispatch.dylib              0x34b24654 0x34b1c000 + 34388
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 2 name:  WebThread
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 2 Crashed:
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0   WebCore                        0x353ab2c2 0x3530d000 + 647874
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 1   WebCore                        0x353ab20a 0x3530d000 + 647690
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 2   CoreFoundation                 0x35e025dc 0x35d6b000 + 619996
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 3   CoreFoundation                 0x35e0228c 0x35d6b000 + 619148
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 4   CoreFoundation                 0x35e00efc 0x35d6b000 + 614140
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 5   CoreFoundation                 0x35d73eb8 0x35d6b000 + 36536
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 6   CoreFoundation                 0x35d73d44 0x35d6b000 + 36164
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 7   WebCore                        0x35317a70 0x3530d000 + 43632
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 8   libsystem_c.dylib              0x39bc030e 0x39baf000 + 70414
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 9   libsystem_c.dylib              0x39bc01d4 0x39baf000 + 70100
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 3 name:  com.apple.NSURLConnectionLoader
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 3:
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0   libsystem_kernel.dylib         0x31a20eb4 0x31a20000 + 3764
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 1   libsystem_kernel.dylib         0x31a21048 0x31a20000 + 4168
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 2   CoreFoundation                 0x35e02040 0x35d6b000 + 618560
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 3   CoreFoundation                 0x35e00d9e 0x35d6b000 + 613790
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 4   CoreFoundation                 0x35d73eb8 0x35d6b000 + 36536
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 5   CoreFoundation                 0x35d73d44 0x35d6b000 + 36164
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 6   Foundation                     0x3386cbc8 0x3383f000 + 187336
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 7   Foundation                     0x338f0678 0x3383f000 + 726648
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 8   libsystem_c.dylib              0x39bc030e 0x39baf000 + 70414
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 9   libsystem_c.dylib              0x39bc01d4 0x39baf000 + 70100
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 4 name:  JavaScriptCore::BlockFree
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 4:
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0   libsystem_kernel.dylib         0x31a3108c 0x31a20000 + 69772
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 1   libsystem_c.dylib              0x39bb8d2a 0x39baf000 + 40234
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 2   libsystem_c.dylib              0x39bb8aa0 0x39baf000 + 39584
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 3   JavaScriptCore                 0x3a23cad0 0x3a1e1000 + 375504
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 4   JavaScriptCore                 0x3a34e55a 0x3a1e1000 + 1496410
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 5   JavaScriptCore                 0x3a360fb0 0x3a1e1000 + 1572784
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 6   libsystem_c.dylib              0x39bc030e 0x39baf000 + 70414
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 7   libsystem_c.dylib              0x39bc01d4 0x39baf000 + 70100
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 5 name:  JavaScriptCore::Marking
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 5:
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0   libsystem_kernel.dylib         0x31a3108c 0x31a20000 + 69772
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 1   libsystem_c.dylib              0x39bb8d2a 0x39baf000 + 40234
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 2   libsystem_c.dylib              0x39bc2f14 0x39baf000 + 81684
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 3   JavaScriptCore                 0x3a2e1f44 0x3a1e1000 + 1052484
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 4   JavaScriptCore                 0x3a2e1e84 0x3a1e1000 + 1052292
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 5   JavaScriptCore                 0x3a360fb0 0x3a1e1000 + 1572784
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 6   libsystem_c.dylib              0x39bc030e 0x39baf000 + 70414
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 7   libsystem_c.dylib              0x39bc01d4 0x39baf000 + 70100
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 6 name:  WebCore: CFNetwork Loader
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 6:
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0   libsystem_kernel.dylib         0x31a20eb4 0x31a20000 + 3764
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 1   libsystem_kernel.dylib         0x31a21048 0x31a20000 + 4168
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 2   CoreFoundation                 0x35e02040 0x35d6b000 + 618560
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 3   CoreFoundation                 0x35e00d9e 0x35d6b000 + 613790
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 4   CoreFoundation                 0x35d73eb8 0x35d6b000 + 36536
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 5   CoreFoundation                 0x35d73d44 0x35d6b000 + 36164
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 6   WebCore                        0x353b2f9a 0x3530d000 + 679834
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 7   JavaScriptCore                 0x3a360fb0 0x3a1e1000 + 1572784
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 8   libsystem_c.dylib              0x39bc030e 0x39baf000 + 70414
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 9   libsystem_c.dylib              0x39bc01d4 0x39baf000 + 70100
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 7 name:  com.apple.CFSocket.private
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 7:
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0   libsystem_kernel.dylib         0x31a31594 0x31a20000 + 71060
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 1   CoreFoundation                 0x35e061f2 0x35d6b000 + 635378
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 2   libsystem_c.dylib              0x39bc030e 0x39baf000 + 70414
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 3   libsystem_c.dylib              0x39bc01d4 0x39baf000 + 70100
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 8:
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0   libsystem_kernel.dylib         0x31a20eb4 0x31a20000 + 3764
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 1   libsystem_kernel.dylib         0x31a21048 0x31a20000 + 4168
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 2   CoreFoundation                 0x35e02040 0x35d6b000 + 618560
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 3   CoreFoundation                 0x35e00d9e 0x35d6b000 + 613790
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 4   CoreFoundation                 0x35d73eb8 0x35d6b000 + 36536
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 5   CoreFoundation                 0x35dd29b6 0x35d6b000 + 424374
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 6   CoreMotion                     0x33ea6ef2 0x33e75000 + 204530
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 7   libsystem_c.dylib              0x39bc030e 0x39baf000 + 70414
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 8   libsystem_c.dylib              0x39bc01d4 0x39baf000 + 70100
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 9:
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0   libsystem_kernel.dylib         0x31a31d98 0x31a20000 + 73112
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 1   libsystem_c.dylib              0x39bb5cf6 0x39baf000 + 27894
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 2   libsystem_c.dylib              0x39bb5a12 0x39baf000 + 27154
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 3   libsystem_c.dylib              0x39bb58a0 0x39baf000 + 26784
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 10:
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0   libsystem_kernel.dylib         0x31a31d98 0x31a20000 + 73112
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 1   libsystem_c.dylib              0x39bb5cf6 0x39baf000 + 27894
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 2   libsystem_c.dylib              0x39bb5a12 0x39baf000 + 27154
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 3   libsystem_c.dylib              0x39bb58a0 0x39baf000 + 26784
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 11:
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0   libsystem_kernel.dylib         0x31a31d98 0x31a20000 + 73112
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 1   libsystem_c.dylib              0x39bb5cf6 0x39baf000 + 27894
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 2   libsystem_c.dylib              0x39bb5a12 0x39baf000 + 27154
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 3   libsystem_c.dylib              0x39bb58a0 0x39baf000 + 26784
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 12:
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0   libsystem_kernel.dylib         0x31a31d98 0x31a20000 + 73112
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 1   libsystem_c.dylib              0x39bb5cf6 0x39baf000 + 27894
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 2   libsystem_c.dylib              0x39bb5a12 0x39baf000 + 27154
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 3   libsystem_c.dylib              0x39bb58a0 0x39baf000 + 26784
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 13:
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0   libsystem_kernel.dylib         0x31a31d98 0x31a20000 + 73112
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 1   libsystem_c.dylib              0x39bb5cf6 0x39baf000 + 27894
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 2   libsystem_c.dylib              0x39bb5a12 0x39baf000 + 27154
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 3   libsystem_c.dylib              0x39bb58a0 0x39baf000 + 26784
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Thread 2 crashed with ARM Thread State (32-bit):
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:     r0: 0x00000001    r1: 0x00000000      r2: 0x00000000      r3: 0x0516f1cc
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:     r4: 0x00254168    r5: 0x05da2464      r6: 0x00000000      r7: 0x0043b170
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:     r8: 0x00000000    r9: 0x00091500     r10: 0x3b8cfb40     r11: 0x1d584628
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:     ip: 0x3b7c2bc4    sp: 0x0043b130      lr: 0x353ab2c1      pc: 0x353ab2c2
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:   cpsr: 0x60000030
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:  
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: Binary Images:
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>:    0xde000 -   0x15bfff +socialPlace armv7  <a6f06e87b6cf32f7b6302e6373dccb2e> /var/mobile/Applications/0F954FA6-B820-46A5-9053-DA09D9A17A39/socialPlace.app/socialPlace
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0x2fe18000 - 0x2fe38fff  dyld armv7  <75594988728831d98e1f7c4c7b7ca29d> /usr/lib/dyld
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0x31a20000 - 0x31a36fff  libsystem_kernel.dylib armv7  <f167dacec44b3a86a8eee73400ff7a83> /usr/lib/system/libsystem_kernel.dylib
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0x31a93000 - 0x31aa1fff  AssetsLibrary armv7  <f0d1ee22421532798858b19b2240d7df> /System/Library/Frameworks/AssetsLibrary.framework/AssetsLibrary
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0x31ab1000 - 0x31ac4fff  DataDetectorsUI armv7  <072e054dc6d13fcca1ab6c241a9dc96a> /System/Library/PrivateFrameworks/DataDetectorsUI.framework/DataDetectorsUI
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0x31ad6000 - 0x31aebfff  libresolv.9.dylib armv7  <e79b59a3406f34d9b37f8085955115ce> /usr/lib/libresolv.9.dylib
Oct 21 19:40:53 Sharon-Mantins-iPhone ReportCrash[4562] <Error>: 0x31c9e000 - 0x31d63fff  CFNetwork armv7  <3e973794a4d13428bb974edcb2027139> /System/Library/Frameworks/CFNetwork.framework/CFNetwork 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T15:54:27.897

也许您正在使用网络套接字？我有一个类似的问题，因为我在服务器上禁用了 websockets 我没有看到这个问题

这是对sockets.io中错误的参考： [https ://github.com/LearnBoost/socket.io-client/pull/426](https://github.com/LearnBoost/socket.io-client/pull/426)

出于某种原因，它也无法实施此修复，并且升级到最新版本的 sockets.io 并没有解决问题。

# java - 在tomcat 7中配置hibernate 4通过JNDI Datasource连接数据库

> ID：13108136
> 
> 赞同：0
> 
> 时间：2012-10-28T10:43:21.567
> 
> 标签：java, hibernate, transactions, tomcat7, jndi

我正在使用 Tomcat7、Struts-2.3.5、hibernate-4.1.7 和 jotm-2.1.9 width microsoft sqlserver 2005 作为我的 java web 应用程序框架。当我在休眠配置中使用 jndi 数据源时，它拒绝工作。我在这个网站上读过一篇看似的帖子，[Configure hibernate to connect to database via JNDI Datasource](https://stackoverflow.com/questions/5303671/configure-hibernate-to-connect-to-database-via-jndi-datasource/13107547#comment17817603_13107547)，并没有解决问题。1、我把资源定义放在tomcat server.xml中，而不是META-INF下的context.xml中；

```
<Context docBase="C:\workspace\javaspaces\sitexa\web"
privileged="true" antiResourceLocking="false" antiJARLocking="false">
<Resource name="jdbc/sitexaDB"
auth="Container" 
type="javax.sql.DataSource"
maxActive="20" maxIdle="5" maxWait="10000"
factory="org.objectweb.jotm.datasource.DataSourceFactory"
driverClassName="com.microsoft.sqlserver.jdbc.SQLServerDriver"
url="jdbc:sqlserver://127.0.0.1:1433;databaseName=sitexa"
username="sa" password=""/>
<Resource name="UserTransaction" auth="Container"         type="javax.transaction.UserTransaction" />
 </Context> 
```

2、我把所有需要数据库连接和jta的lib都放在tomcat文件夹/lib下；

3、在web.xml中：

```
<resource-env-ref>
<description>DB Connection</description>
<resource-env-ref-name>jdbc/sitexaDB</resource-env-ref-name>
<resource-env-ref-type>javax.sql.DataSource</resource-env-ref-type>
</resource-env-ref> 
```

4、在hibernate.cfg.xml中：

```
<session-factory>

<property name="hibernate.connection.datasource">java:comp/env/jdbc/sitexaDB</property>

<property name="dialect">org.hibernate.dialect.SQLServer2005Dialect</property>
<property name="show_sql">true</property>
<property name="hbm2ddl.auto">update</property>
<property name="hibernate.max_fetch_depth">3</property>

<property name="hibernate.transaction.jta.platform">org.hibernate.service.jta.platform.internal.JOTMJtaPlatform</property>
<property name="hibernate.transaction.factory_class">org.hibernate.engine.transaction.internal.jta.JtaTransactionFactory</property>
<property name="hibernate.current_session_context_class">jta</property>
...
</session-factory> 
```

5、异常：

```
%%%% Error Creating SessionFactory %%%%
org.hibernate.service.jndi.JndiException: Unable to lookup JNDI name [java:comp/env/jdbc/sitexaDB]
at org.hibernate.service.jndi.internal.JndiServiceImpl.locate(JndiServiceImpl.java:68)
at org.hibernate.service.jdbc.connections.internal.DatasourceConnectionProviderImpl.configure(DatasourceConnectionProviderImpl.java:116)
...
Caused by: javax.naming.NamingException: This context must be accessed through a java: URL
at org.apache.naming.SelectorContext.parseName(SelectorContext.java:776)
at org.apache.naming.SelectorContext.lookup(SelectorContext.java:135)
at javax.naming.InitialContext.lookup(InitialContext.java:415)
at org.hibernate.service.jndi.internal.JndiServiceImpl.locate(JndiServiceImpl.java:65) 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2017-12-19T09:34:47.060

在服务器的 context.xml 中添加数据。

```
<ResourceLink global="jdbc/sitexaDB" name="jdbc/sitexaDB" auth="Container"
    type="javax.sql.DataSource"/>
<Resource name="jdbc/sitexaDB" global="jdbc/sitexaDB" auth="Container"
    type="javax.sql.DataSource" driverClassName="oracle.jdbc.driver.OracleDriver"
    url="jdbc:sqlserver://127.0.0.1:1433;databaseName=sitexa" username="sa" password=""/> 
```

# c# - 绑定在 Silverlight 中无法正常工作

> ID：13108137
> 
> 赞同：0
> 
> 时间：2012-10-28T10:44:10.640
> 
> 标签：c#, silverlight, binding

我在我的 Silverlight 项目中使用 DataGrid，其中包含一个自定义复选框列。我已将其`Command`属性绑定到我的 ViewModel 类的属性。现在，问题是我想通过我编写了以下代码的命令参数发送 DataGrid 的“选定项”：

```
<sdk:DataGrid AutoGenerateColumns="False" Margin="10,0,10,0" Name="dataGridOrders" ItemsSource="{Binding OrderList}" Height="190">
    <sdk:DataGrid.Columns>
        <sdk:DataGridTemplateColumn Header="Select">
            <sdk:DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                    <CheckBox>
                        <is:Interaction.Triggers>
                            <is:EventTrigger EventName="Checked">
                                <is:InvokeCommandAction Command="{Binding Source={StaticResource ExecutionTraderHomePageVM},Path=OrderSelectedCommand,Mode=TwoWay}"
                                                        CommandParameter="{Binding ElementName=dataGridOrders,Path=SelectedItem}" />
                            </is:EventTrigger>
                            <is:EventTrigger EventName="Unchecked">
                                <is:InvokeCommandAction Command="{Binding Source={StaticResource ExecutionTraderHomePageVM},Path=OrderSelectedCommand,Mode=TwoWay}"
                                                        CommandParameter="{Binding ElementName=dataGridOrders,Path=SelectedItem}" />
                            </is:EventTrigger>
                        </is:Interaction.Triggers>
                    </CheckBox> 
```

但是我总是`null`输入我的命令`Execute`方法的参数。我尝试过使用 DataGrid 的其他属性，例如等`Width`，`ActualHeight`但没有用。我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:01:43.117

这里的问题是名称范围之一。简而言之，a 内部的 XAML`DataTemplate`有自己的“名称范围”，并且在它之外看不到任何名称。特别是，它将无法找到父级`DataGrid`，因为它位于`DataTemplate`.

我不确定您为什么要监听已检查和未检查的事件并根据它们触发命令。目前尚不完全清楚您要达到的目标。相反，我将使用双向绑定将 的`IsChecked`属性绑定`CheckBox`到`bool`（行级）视图模型类中的属性，并从此`bool`属性的设置器中调用命令功能。您可以通过双向绑定将 view-model 属性绑定到`DataGrid`s`SelectedItem`属性来获取所选项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T18:18:48.210

我认为你应该像使用 EventTrigger

```
<is:EventTrigger EventName="Checked">
<is:InvokeCommandAction Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}, Path=DataContext.CheckBoxUncheckedCommand}"  CommandParameter="{Binding}"/>
                                </is:EventTrigger> 
```

# python - 将文本字符串添加到抓取的数据

> ID：13108141
> 
> 赞同：0
> 
> 时间：2012-10-28T10:44:18.487
> 
> 标签：python, xml, scrapy

我目前正在尝试使用scrapy。我正在从某个网页抓取几个链接并将它们导出到 xml 文件。问题如下，对于某些站点，链接不包含完整的 url（例如 example.com/page/abc 他们抓取的链接只是来自被抓取页面的相对路径（例如 page/abc）。现在 id 想将基本 url 添加到抓取的变量中，例如。

```
item['link'] = link.select('a/@href').extract() would become something like:
item['link'] = "http://example.com" + link.select('a/@href').extract() 
```

所以结果将是一个完整的可用网址，但上面的解决方案不起作用（注意在添加字符串时被刮掉，最好我希望scrapy自动刮掉完整的网址。

我不习惯使用 python，所以解决方案可能非常简单，但是在阅读了一些 Scrapy 之后，推荐使用 Scrapy。

有什么硬仗吗？

当前代码：

```
from scrapy.spider import BaseSpider
from scrapy.selector import HtmlXPathSelector
from tutorial.items import MyItem

class MySpider(BaseSpider):
    name = "example-com"
    allowed_domains = ["http://example.com"]
    start_urls = [
        "http://example.com/page.html",
    ]

    def parse(self, response):
        hxs = HtmlXPathSelector(response)
        links = hxs.select('//div[@class="views-field views-field-title"]')
        items = []
        for link in links:
            item = MyItem()
            item['link'] = link.select('span/a/@href').extract()
            items.append(item)
        for item in items:
            yield item 
```

**更新/附加问题**

是否也可以在 xml 文件中放入更多信息，例如抓取的项目数量、蜘蛛运行的日期以及域名和/或蜘蛛名称？我试图返回更多变量，但没有奏效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T15:18:16.797

替换这个：

```
items = []
for link in links:
    item = MyItem()
    item['link'] = link.select('span/a/@href').extract()
    items.append(item)
for item in items:
    yield item 
```

有了这个：

```
for link in links:
    item = MyItem()
    url = link.select('span/a/@href').extract()
    item['link'] = allowed_domains[0] + url
    yield item 
```

`MyItem()`在这种情况下什么是 a ？

# client-server - 并发的netty客户端设计

> ID：13108142
> 
> 赞同：4
> 
> 时间：2012-10-28T10:44:19.130
> 
> 标签：client-server, netty

感谢伟大的图书馆网络，我正在使用最新的 3.5.8 版本。我的应用程序设计如下

1.  我有一个 Web 应用程序，它接收来自最终用户的请求（MyWebApp）
2.  这个web应用修改接收到的数据，构造一个MyBean对象，连接到MyServer（建立在netty上）进行处理
3.  MyServer 执行一些业务逻辑并返回一个修改后的 MyBean 对象
4.  MyWebApp 通过 JSP 接收并移交给最终用户

MyServer 工作正常并且能够处理请求。

我观察到客户端在有并发请求时会延迟请求。尽管在几毫秒内处理了大量请求，但在某些情况下，很少有请求被延迟。延迟请求有时需要 1-4 分钟。但我观察到服务器很晚才收到这些请求，但会立即处理。所以，我只能怀疑客户端的实现。我试图实现“通道”的连接池，但请求和响应不匹配。由于这两种实现都是由我完成的，所以我可以自由地更改双方的代码。因此，我修改了服务器 messageReceived 源代码，即使在它处理了响应之后也不关闭连接。现在是客户端打开通道发出请求并在收到响应后关闭通道。

理想情况下，我想使用一个通道或通道池或任何其他实现并处理并发请求。我觉得 Netty 很容易用于服务器实现，但客户端实现不适合我这种设计。如果这可以成为 netty 库本身的一部分，那就太好了

任何想法，将不胜感激。

**我的代码在客户端如下**

```
 public class NioConnectorImpl implements ICoreConnector{

private String host;
private int port;
private static ChannelFactory channelFactory;

public NioConnectorImpl(String host, int port){
    this.host = host;
    this.port = port;
}

@Override
public MyBean processRequest(MyBean bean) {
    return (MyBean) callMyServer(bean);
}

public Object callMyServer(Object requestObject) throws RuntimeException{

    if(channelFactory==null){
        System.out.println("createFactory with 3 Boss Threads and "+Runtime.getRuntime().availableProcessors() * 2+ " Child Threads");
        channelFactory  =  new NioClientSocketChannelFactory(
                Executors.newCachedThreadPool(),
                Executors.newCachedThreadPool(),3, Runtime.getRuntime().availableProcessors() * 2);
    }

ClientBootstrap bootstrap = new ClientBootstrap(channelFactory);

    // Set up the event pipeline factory.
    bootstrap.setPipelineFactory(new MyChannelPipelineFactory(requestObject));
    //Connection timeOut for initial connection...
    bootstrap.setOption("connectTimeoutMillis", 10000);
    bootstrap.setOption("tcpNoDelay", true);
    bootstrap.setOption("keepAlive", true);

    ChannelFuture connectFuture = bootstrap.connect(new InetSocketAddress(host, port));

// Wait until the connection is made successfully.
    Channel channel = connectFuture.awaitUninterruptibly().getChannel();

    // Get the handler instance to retrieve the answer.
    MyChannelHandler handler = (MyChannelHandler) channel.getPipeline().getLast();

    Object  object = handler.getObjectBean();

    channel.close().awaitUninterruptibly();

    //bootstrap.releaseExternalResources();
    //channelFactory.releaseExternalResources();

return object;

}

@Override
public void safeReleaseResources() {
    System.out.println("Releasing External Resources::::::::::::");
    if(channelFactory!=null)
    channelFactory.releaseExternalResources();

    try {
        Thread.sleep(5000L);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

} 
```

}

**MyChannelHandler 代码**

```
 public class MyChannelHandler extends SimpleChannelUpstreamHandler{

    private static final Logger logger = Logger.getLogger(MyChannelHandler.class.getName());
    private final Object object;
    final BlockingQueue<Object> answer = new LinkedBlockingQueue<Object>();

    public MyChannelHandler(Object object) {
        this.object= object;
    }

    public Object getObjectBean() {
        boolean interrupted = false;
        for (;;) {
            try {
                Object object = answer.take();
                if (interrupted) {
                    Thread.currentThread().interrupt();
                }
                return object;
            } catch (InterruptedException e) {
                interrupted = true;
            }
        }
    }

    @Override
    public void channelConnected(ChannelHandlerContext ctx, ChannelStateEvent e) {
        sendObject(e);
    }

    @Override
    public void messageReceived(ChannelHandlerContext ctx, final MessageEvent e) {
        if (e.getMessage() != null) {
            // Offer the answer after closing the connection.
            e.getChannel().close().addListener(new ChannelFutureListener() {
                public void operationComplete(ChannelFuture future) {
                    boolean offered = answer.offer((Object) e.getMessage());
                    assert offered;
                }
            });
        }
    }

    @Override
    public void exceptionCaught(ChannelHandlerContext ctx, ExceptionEvent e) {
        logger.log(Level.WARNING,"Naga: Unexpected exception from downstream.",e.getCause());
        e.getChannel().close();
    }

    private void sendObject(ChannelStateEvent e) {
        Channel channel = e.getChannel();
       if(channel.isWritable()) channel.write(object);
    }
} 
```

**我的服务器代码**

```
 public void messageReceived(ChannelHandlerContext ctx, MessageEvent e) {

    Object object = MyServerController().handleRequest(e.getMessage(), e.getRemoteAddress().toString());

    final ChannelFuture future =  e.getChannel().write(object);
         future.addListener(new ChannelFutureListener() {
                public void operationComplete(ChannelFuture f) {
                    Channel ch = future.getChannel();
                    //ch.close(); // expect client closes the connection
                }
         });
} 
```

# php - PHP 中 mktime() 的错误输出

> ID：13108143
> 
> 赞同：0
> 
> 时间：2012-10-28T10:44:37.197
> 
> 标签：php

我正在尝试设置一个 php，它设置每年 9 月 1 日的日期。我使用 CRON 来声明每次日期是 9 月 7 日，然后 php 实际上会更新数据库中日期为 9 月 7 日之前一周的行（ist 9 月）。

现在，我在 10 月 28 日测试了下面的代码，当我回显它时，`$selectedDate`它的输出`2012-10-28`很好。但是当我将日期更改为 9 月 1 日时，它的输出``2011-12-01`显然是不正确的。它应该输出'2013-09-01，因为下一个九月日期将是2013年。然后在2013年的九月日期过去之后，年份应该更改为2014年等等。

如何获得要输出的正确日期？

下面是代码：

```
$createDate = mktime(0,0,0,09,01,date("Y"));
$selectedDate =  date('Y-m-d', ($createDate)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T10:47:45.263

那是因为`09`被解释为**八进制 9**，这是无效的。

当您通过`9`而不是`09`：

```
$createDate = mktime(0,0,0,9,1,date("Y"));
//                         ^ ^  No preceeding 0s.
$selectedDate =  date('Y-m-d', ($createDate));

var_dump($createDate, $selectedDate); 
```

# iphone - 应用在前台运行时显示与 UIRemoteNotification 相同的 UIAlertView

> ID：13108144
> 
> 赞同：1
> 
> 时间：2012-10-28T10:44:40.417
> 
> 标签：iphone, uialertview, apple-push-notifications

我知道我们可以通过以下方法处理推送通知：

```
- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo 
```

我们可以检查应用程序是否在前台运行：

```
if (application.applicationState == UIApplicationStateActive ) { ... } 
```

我们如何通过本地化显示完全相同的通知？

```
NSString *message = [[[userInfo valueForKey:@"aps"] valueForKey:@"alert"] valueForKey:@"loc-key"];
NSString *trueMessage = NSLocalizedString(message, nil);
UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"Alert"
                                                            message:trueMessage
                                                   cancelButtonItem:@"OK"
                                                   otherButtonItems:@"Show", nil];
[alertView show]; 
```

这显示了未本地化的原始文本，例如“您在 %2@ 收到来自 %1@ 的新警报”。

`loc-args`我的问题是，当应用程序在前台运行时，我们如何将 UIAlertView 也放入其中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T10:57:41.763

我想出了一个不那么简单的解决方法（假设 3 是您在所有本地化字符串中拥有的最大变量数）：

```
 // Max is 3 variables
    NSString *variableOne = @"";
    NSString *variableTwo = @"";
    NSString *variableThree = @"";

    int i = 0;
    for (NSString *eachVariable in [[[userInfo valueForKey:@"aps"] valueForKey:@"alert"] valueForKey:@"loc-args"]) {
        switch (i) {
            case 0:
                variableOne = eachVariable;
                break;
            case 1:
                variableTwo = eachVariable;
                break;
            case 2:
                variableThree = eachVariable;

            default:
                break;
        }
        i++;
    }

    NSString *message = [[[userInfo valueForKey:@"aps"] valueForKey:@"alert"] valueForKey:@"loc-key"];

    NSString *trueMessage = [NSString stringWithFormat:NSLocalizedString(message, nil), variableOne, variableTwo, variableThree];

    UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"Alert"
                                                        message:trueMessage
                                               cancelButtonItem:@"Cancel"
                                               otherButtonItems:@"Show", nil];
    [alertView show]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-17T15:05:44.327

我建议您`va_list`按照此处的说明创建一个假货：[fake va_list in ARC](https://stackoverflow.com/questions/8211996/fake-va-list-in-arc)。

这将给出一个看起来有点像这样的代码：

```
NSString *pushBody;
id alert = userInfo[@"aps"][@"alert"];
if ([alert isKindOfClass:[NSString class]]) pushBody = alert;
if ([alert isKindOfClass:[NSDictionary class]])
{
    pushBody = alert[@"loc-key"];
    if (pushBody == nil)
    {
        pushBody = alert[@"body"];
    }
    else
    {
        // Build a fake va_list from the parameters.
        NSArray *locArgs = alert[@"loc-args"];
        NSRange range = NSMakeRange(0, [locArgs count]);
        NSMutableData* fakeVaList = [NSMutableData dataWithLength: sizeof(id) * [locArgs count]];
        [locArgs getObjects:(__unsafe_unretained id *)fakeVaList.mutableBytes range:range];

        pushBody = StrLoc(pushBody, @"Remote Notif");
        pushBody = [[NSString alloc] initWithFormat:pushBody arguments:fakeVaList.mutableBytes];
    }
} 
```

告诉我这是否适合你……</p>

# mysql - MySQL 数据库 || 表问题

> ID：13108147
> 
> 赞同：0
> 
> 时间：2012-10-28T10:44:45.263
> 
> 标签：mysql

我正在尝试编写一个脚本，用户可以在其中以美元购买一定数量的积分。我希望将事务插入 MySQL。我一直面临一个：“列数与第 1 行的值计数不匹配”错误。而且我不知道我做错了什么。

我写了这个：

```
mysql_query("INSERT INTO paypal_donations VALUES (NULL, ".$account_id.", ".$char_id.", ".$price.", ".$dp.", NOW(), NOW(), 'Started', 0, 0, '', '');") or die(mysql_error()); 
```

但我不知道在 MySQL 中执行什么，因为我以前从未使用过它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T10:46:59.520

您收到错误的原因是因为您正在隐式执行查询，您的`INSERT`语句中提供的值与表中的列总数不匹配。

为了避免这种情况，您必须提供列名，例如

```
INSERT INTO tableName (col1, col2, col3)
VALUES (1,2,3) 
```

如果要在未指定列名的情况下执行查询，则值必须与总列数匹配，例如。你有一个有 4 列的表，它们都是整数，

```
INSERT INTO tableName VALUES (1,2,3,4) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T10:54:40.007

首先，您应该确保您的变量包含与 SQL 语法相关的正确值。然后，直接用双引号将这些变量放入查询中。PHP 将操纵它们的值并替换为查询字符串。例如

```
$account_id = "'Some_ID'"; // there is a single quote
mysql_query("INSERT INTO paypal_donations VALUES (NULL, $account_id, $char_id, $price, $dp, NOW(), NOW(), 'Started', 0, 0, '', '');") or die(mysql_error()); 
```

对于 INSERT SQL 命令，请使用语法：

```
INSERT INTO table_name (column1, column2, column3,...)
VALUES (value1, value2, value3,...) /*Without "..." :) */ 
```

如果存在 null_field 或 auto_increased_field，则可以通过在查询中不提及或将值设为 NULL 来忽略。

对不起，我写的英语不好。

# python - 偷看 GTK 事件；gtk.gdk.event_peek 总是返回 None

> ID：13108149
> 
> 赞同：0
> 
> 时间：2012-10-28T10:45:04.770
> 
> 标签：python, gtk, pygtk

我需要检查在执行某些非 GUI 代码期间是否按下了 Escape 键。（代码在 Python 中，但必要时可以轻松调用 C。）代码从 GUI 接收一个函数，它偶尔调用该函数来检查它是否已被中断。问题是如何实施这项检查。

通过查看文档，`gdk_event_peek`这似乎是一个很好的选择：

```
def _check_esc(self):
    event = gtk.gdk.event_peek()
    if event is None or event.type not in (gtk.gdk.KEY_PRESS, gtk.gdk.KEY_RELEASE):
        return False
    return gtk.gdk.keyval_name(event.keyval) == 'Escape' 
```

但是，这不起作用：`gtk.gdk.event_peek()`当主循环未运行时，从返回的事件始终为 None 。将其更改为`gtk.gdk.display_get_default().peek_event()`也无济于事。我假设这些事件在 X 事件队列中并且尚未移动到 GDK 事件队列中。[文档](http://developer.gnome.org/gdk/stable/GdkDisplay.html#gdk-display-peek-event)说：

> 请注意，此函数不会从窗口系统获取更多事件。它只检查已经移动到 GDK 事件队列的事件。

那么，如何将事件转移到 GDK 事件队列中呢？换句话说，什么`gtk.gdk.peek_event()`时候返回一个事件？调用`gtk.events_pending()`没有任何效果。

这是一个测试它的最小程序：

```
import gtk, gobject
import time

def code(check):
    while 1:
        time.sleep(.1)
        if check():
            print 'interrupted'
            return

def _check_esc():
    event = gtk.gdk.event_peek()
    print 'event:', event
    if event is None or event.type not in (gtk.gdk.KEY_PRESS, gtk.gdk.KEY_RELEASE):
        return False
    return gtk.gdk.keyval_name(event.keyval) == 'Escape'

def runner():
    code(_check_esc)
    gtk.main_quit()

w = gtk.Window()
w.show()
gobject.idle_add(runner)
gtk.main() 
```

运行代码时，打印的事件始终为 None，即使您按下 Escape 或移动鼠标。

我还考虑过为 Escape 安装一个处理程序，并让检查器使用`while gtk.events_pending(): gtk.main_iteration()`成语处理事件。这将导致*所有*待处理事件（包括键盘和鼠标事件）的出队和分派。效果是在代码运行时 GUI 启用了响应式，这看起来不太好，并且会严重干扰代码的执行。执行期间处理的*唯一*事件应该是用于中断它的转义键。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:32:39.863

我想出了一个`runner`满足问题中提出的标准的实现：

```
def runner():
    # _check_esc searches for Escape in our queue
    def _check_esc():
        oldpos = len(queue)
        while gtk.events_pending():
            gtk.main_iteration()
        new = itertools.islice(queue, oldpos, None)
        return any(event.type == gtk.gdk.KEY_PRESS \
                       and gtk.gdk.keyval_name(event.keyval) == 'Escape'
                   for event in new)

    queue = []
    # temporarily set the global event handler to queue
    # the events
    gtk.gdk.event_handler_set(queue.append)
    try:
        code(_check_esc)
    finally:
        # restore the handler and replay the events
        handler = gtk.main_do_event
        gtk.gdk.event_handler_set(gtk.main_do_event)
        for event in queue:
            handler(event)
    gtk.main_quit() 
```

与基于 peek 的解决方案相比，它的优势在于它可以处理按键后另一个事件到达的情况。缺点是它需要摆弄全局事件处理程序。

# node.js - Backbone.relational，实时和处理大数据

> ID：13108151
> 
> 赞同：0
> 
> 时间：2012-10-28T10:45:48.223
> 
> 标签：node.js, backbone.js, socket.io, backbone-relational

我正在使用 Backbone.js、node.js 和 socket.io 构建一个实时提要应用程序。

我`Feed`是`Update`模型的集合。显示这些，覆盖`Backbone.sync`与`socket.io`工作正常。

复杂之处在于每个`Update`都有一组与之相关的评论。当我`Update`在视图中显示每个`Feed`视图时，我想显示相关评论的摘要（评论数量和单个“最受欢迎”评论），并且还能够单击不同的视图以单独显示`Update`每个带有带有更多数据的分页评论列表。

我用模型和模型`backbone-relational`之间的关系来建模，如下：`Update``Comment`

`Feed (collection) -> Update (model) -(has many)-> Comment (model)`

我一直在关注本`backbone-relational`教程，但似乎假设我希望在我`Feed`看来一次将所有相关数据保存在内存中，因为可能有数千条评论实时更新：

[http://antoviaque.org/docs/tutorials/backbone-relational-tutorial/](http://antoviaque.org/docs/tutorials/backbone-relational-tutorial/)

我的问题是：

1.  如何在不加载所有评论数据的情况下`Update`为我的`Feed`视图中的每个评论引入摘要数据，并保持在我的`Update`视图中显示分页完整数据的能力？
2.  我正在使用`backbone.layoutmanager`渲染我的视图。我应该如何最好地打破我的观点来完成上述工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T06:03:07.777

对于第一季度：

*   我假设您使用[ioSync 之](https://github.com/logicalparadox/backbone.iobind)类的东西在 Backbone.sync 中使用 socket.io 而不是 REST API 或类似的解决方案。
*   将元数据（例如评论数）作为属性包含在`Update`. 如果您的`Update`对象本身很重，您可以使用[ioBind](https://github.com/logicalparadox/backbone.iobind)和自定义服务器端 socket.io 事件来更新计数，而不是每次都发送整个对象。
*   将属性`topComment`作为附加的一对一关系包含在`Update`. `Update`最初从服务器加载时，包括`topComment`在响应中，但不包括其他评论。
*   使用自定义 socket.io 事件延迟加载其余评论。您可能需要一个以 , , 为参数的服务器端处理程序`updateId`，`startIndex`它返回从给定索引开始的给`maxComments`定注释列表。`Update`如果结果以 JSON 格式发送到客户端，那么在客户端上执行类似这样的操作很容易：

    ```
    // Assume `model` is an instance of `Update`.
    socket.emit('get_comments_page', {
      updateId: model.get('id'),
      startIndex: 1,
      maxComments: 10
    }, function(err, data) {
      if (err) {
        alert('Unable to fetch comments: ', err);
      } else {
        model.get('messages').reset(data)
      }
    }); 
    ```

*   `Update`在获取然后尝试使用`fetchRelated`解决它们时避免为所有评论发送 ID 。我很难学会这一点：O/

*   您还可以将评论集合直接存储在视图上，而无需将其关联为`Update`

对于第二季度：

我没有任何经验，`layoutmanager`因为我使用[Backbone.Marionette](https://github.com/marionettejs/backbone.marionette)来管理我的视图。Marionette 有一个[异步扩展](https://github.com/marionettejs/backbone.marionette.async)（免责声明：我是共同维护者）。我鼓励看看 Marionette.async 如何进行延迟渲染，等待数据从服务器到达。

主要思想是使用 jquery 的 Deferred 对象，当数据从服务器返回时解析。用 deferred 扩展上面的例子：

```
var MyView = Backbone.View.extend({
  // ... normal stuff that views need ...
  initialize: function() {
    var deferred = $.Deferred();
    // Assume `model` is an instance of `Update`.
    var that = this;
    socket.emit('get_comments_page', {
      updateId: that.model.get('id'),
      startIndex: that.options.pageNumber,
      maxComments: 10
    }, function(err, data) {
      if (err) {
        alert('Unable to fetch comments: ', err);
      } else {
        that.model.get('messages').reset(data)
      }
      deferred.resolve();
    });
    this.promise = deferred.promise();
  },

  render: function() {
    var that = this;
    this.promise.done(function() {
      // Do your normal rendering code here, for instance:
      $(that.el).html(that.template(that.model.toJSON()));
    });
    return this;
  }
}); 
```

注意：上面的代码片段未按原样测试。

# git - 如何将我的 2 个提交移动到新分支？

> ID：13108152
> 
> 赞同：3
> 
> 时间：2012-10-28T10:46:03.670
> 
> 标签：git

我的 git 日志是这样的：

```
commit 7cfdafdad623d2529f9c2069549619d117f4f43ec
commit afdafdafd0165af0651c1c4670bc2cd53738c2433
commit 1235cebdd758c1314ca0002a2c11f9693f43deafb
... 
```

如何将最近的 2 次提交移动到新分支？（注：最近的在顶部）

我在想

```
git branch newbranch
git reset --soft HEAD~1
git checkout newbranch
git commit -a 
git checkout master
git reset --soft HEAD~1
git checkout newbranch
git commit -a 
```

有没有更好的办法？我认为我的方式会丢失 git 评论。我有点删除提交并重新签入。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T12:12:25.340

您可以简单地发出以下两个命令：

```
git branch new_branch_name
git reset --hard HEAD~2 
```

解释：

1.  创建一个`new_branch_name`在当前（最新）提交中调用的分支，但不要签出该分支。
2.  你还在上`old_branch`。下一步是将其指向`1235ce`. 这是使用`reset --hard`.

现在`old_branch`指向`1235ce`，并且`new_branch_name`在`7cfdaf`。

# java - 打破依赖

> ID：13108154
> 
> 赞同：0
> 
> 时间：2012-10-28T10:46:10.533
> 
> 标签：java, dependency-injection

我从来没有深入研究过Java。最近，我不得不处理一个我想调查的行为，因为我还没有完全理解它。

你能解释一下为什么主包不需要导入包b吗？虽然 aa 方法的参数是 B 类型。

此代码正常工作。

这种特殊情况可以被视为内联依赖注入吗？

```
package c;
import b.*;
public class C {
    B b=new B(); 

    public B cc(){ 
        return b; 
    }

}

package a;
import b.*; 

public class A {

    public void aa(B b) {}
}

package b; 
public class B {}

import a.A; 
import c.C; 

public class Test {

    public static void main(String[] args) {

        A a = new A(); 
        C c = new C();
        a.aa(c.cc()); 
        System.out.print("Test"); 
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T10:49:21.887

您只需要导入您在源代码中明确提及的类型。当您调用该`cc`方法时，编译器已经清楚哪种类型是返回值。导入只是为了消除对`B`完全限定类型名称的提及`b.B`。

不，这与依赖注入无关。在那个短语中，“依赖”是指一个对象对另一个对象的运行时依赖，与 Java 类型之间的编译时依赖无关。

# php - PHP 数组到 CSV

> ID：13108157
> 
> 赞同：128
> 
> 时间：2012-10-28T10:46:34.950
> 
> 标签：php, csv

我正在尝试将一系列产品转换为 CSV 文件，但似乎没有计划。CSV 文件是一长行，这是我的代码：

```
for($i=0;$i<count($prods);$i++) {
$sql = "SELECT * FROM products WHERE id = '".$prods[$i]."'";
$result = $mysqli->query($sql);
$info = $result->fetch_array(); 
}

$header = '';

for($i=0;$i<count($info);$i++)  
  {
    $row = $info[$i];

    $line = '';
    for($b=0;$b<count($row);$b++)
    { 
    $value = $row[$b];                                      
        if ( ( !isset( $value ) ) || ( $value == "" ) )
        {
            $value = "\t";
        }
        else
        {
            $value = str_replace( '"' , '""' , $value );
            $value = '"' . $value . '"' . "\t";
        }
         $line .= $value;
        }
    $data .= trim( $line ) . "\n";
}
$data = str_replace( "\r" , "" , $data );

if ( $data == "" )
{
$data = "\n(0) Records Found!\n";                        
}

header("Content-type: application/octet-stream");
header("Content-Disposition: attachment; filename=your_desired_name.xls");
header("Pragma: no-cache");
header("Expires: 0");

array_to_CSV($data);

function array_to_CSV($data)
    {
        $outstream = fopen("php://output", 'r+');
        fputcsv($outstream, $data, ',', '"');
        rewind($outstream);
        $csv = fgets($outstream);
        fclose($outstream);
        return $csv;
    } 
```

此外，标头不会强制下载。我一直在复制和粘贴输出并保存为 .csv

## 编辑

已解决的问题：

如果其他人正在寻找同样的东西，找到了一种更好的方法：

```
$num = 0;
$sql = "SELECT id, name, description FROM products";
if($result = $mysqli->query($sql)) {
     while($p = $result->fetch_array()) {
         $prod[$num]['id']          = $p['id'];
         $prod[$num]['name']        = $p['name'];
         $prod[$num]['description'] = $p['description'];
         $num++;        
    }
 }
$output = fopen("php://output",'w') or die("Can't open php://output");
header("Content-Type:application/csv"); 
header("Content-Disposition:attachment;filename=pressurecsv.csv"); 
fputcsv($output, array('id','name','description'));
foreach($prod as $product) {
    fputcsv($output, $product);
}
fclose($output) or die("Can't close php://output"); 
```

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2012-10-28T10:48:22.217

与其写出值，不如考虑使用[`fputcsv()`](http://php.net/manual/en/function.fputcsv.php).

这可能会立即解决您的问题。

**评论中的注意事项**：我应该提到这将在您的服务器上创建一个文件，因此您需要在输出之前阅读该文件的内容，如果您不想保存副本，那么您需要 ùnlink `完成后的文件

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2018-12-21T09:37:24.667

这是一个将数组导出为 csv 字符串的简单解决方案：

```
function array2csv($data, $delimiter = ',', $enclosure = '"', $escape_char = "\\")
{
    $f = fopen('php://memory', 'r+');
    foreach ($data as $item) {
        fputcsv($f, $item, $delimiter, $enclosure, $escape_char);
    }
    rewind($f);
    return stream_get_contents($f);
}

$list = array (
    array('aaa', 'bbb', 'ccc', 'dddd'),
    array('123', '456', '789'),
    array('"aaa"', '"bbb"')
);
var_dump(array2csv($list)); 
```

[参考](https://www.php.net/manual/en/function.fputcsv.php)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-28T10:51:24.177

尝试使用；

```
PHP_EOL 
```

终止 CSV 输出中的每一新行。

我假设文本是定界的，但没有移动到下一行？

这是一个 PHP 常量。它将确定您需要的正确行尾。

例如，Windows 使用“\r\n”。当我的输出没有突破到新的线路时，我用那个破坏了我的大脑。

[如何在 PHP 中编写统一的新行？](https://stackoverflow.com/questions/989628/how-to-write-unified-new-line-in-php)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-12-11T16:32:34.980

我知道这是旧的，我有一个案例我需要将数组键也包含在 CSV 中，所以我更新了 Jesse Q 的脚本来做到这一点。我使用字符串作为输出，因为 implode 无法添加新行（新行是我添加的，应该确实存在）。

请注意，这只适用于单值数组`(key, value)`。但可以轻松更新以处理多维`(key, array())`.

```
function arrayToCsv( array &$fields, $delimiter = ',', $enclosure = '"', $encloseAll = false, $nullToMysqlNull = false ) {
    $delimiter_esc = preg_quote($delimiter, '/');
    $enclosure_esc = preg_quote($enclosure, '/');

    $output = '';
    foreach ( $fields as $key => $field ) {
        if ($field === null && $nullToMysqlNull) {
            $output = '';
            continue;
        }

        // Enclose fields containing $delimiter, $enclosure or whitespace
        if ( $encloseAll || preg_match( "/(?:${delimiter_esc}|${enclosure_esc}|\s)/", $field ) ) {
            $output .= $key;
            $output .= $delimiter;
            $output .= $enclosure . str_replace($enclosure, $enclosure . $enclosure,     $field) . $enclosure;
            $output .= PHP_EOL;
        }
        else {
            $output .= $key;
            $output .= $delimiter;
            $output .= $field;
            $output .= PHP_EOL;
        }
    }

    return  $output ;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-08-08T03:16:10.390

就我而言，我的数组是多维的，可能以数组作为值。所以我创建了这个递归函数来完全分解数组：

```
function array2csv($array, &$title, &$data) {
    foreach($array as $key => $value) {      
        if(is_array($value)) {
            $title .= $key . ",";
            $data .= "" . ",";
            array2csv($value, $title, $data);
        } else {
            $title .= $key . ",";
            $data .= '"' . $value . '",';
        }
    }
} 
```

由于我的数组的各个级别不适合平面 CSV 格式，因此我使用子数组的键创建了一个空白列，作为对下一级数据的描述性“介绍”。样本输出：

```
agentid     fname           lname      empid    totals  sales   leads   dish    dishnet top200_plus top120  latino  base_packages
G-adriana   ADRIANA EUGENIA PALOMO PAIZ 886                0    19              0         0         0         0      0 
```

您可以轻松删除该“介绍”（描述性）列，但在我的情况下，我在每个子数组中都有重复的列标题，即 inbound_leads，因此在下一节之前给了我一个中断/标题。消除：

```
$title .= $key . ",";
$data .= "" . ","; 
```

在 is_array() 之后进一步压缩代码并删除额外的列。

由于我想要标题行和数据行，我将两个变量传递给函数，并在完成对函数的调用后，用 PHP_EOL 终止两者：

```
$title .= PHP_EOL;
$data .= PHP_EOL; 
```

是的，我知道我留下了一个额外的逗号，但为了简洁起见，我没有在这里处理它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-02-11T17:53:27.460

通过内置的 php 函数 fputcsv 将数据数组转换为 csv 'text/csv' 格式，处理逗号、引号等。
查看
[https://coderwall.com/p/zvzwwa/array-to-comma-separated -string-in-php](https://coderwall.com/p/zvzwwa/array-to-comma-separated-string-in-php)
[http://www.php.net/manual/en/function.fputcsv.php](http://www.php.net/manual/en/function.fputcsv.php)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-19T08:40:31.363

它对我有用。

```
 $f=fopen('php://memory','w');
 $header=array("asdf ","asdf","asd","Calasdflee","Start Time","End Time" );      
 fputcsv($f,$header);
 fputcsv($f,$header);
 fputcsv($f,$header); 
 fseek($f,0);
 header('content-type:text/csv'); 
 header('Content-Disposition: attachment; filename="' . $filename . '";');
 fpassthru($f);``` 
```

# java - 未找到 Java 类的消息正文编写器

> ID：13108161
> 
> 赞同：55
> 
> 时间：2012-10-28T10:47:40.957
> 
> 标签：java, rest, jax-rs

我是使用 JAX-RS 的新手，并编写了一个输出 json 对象的示例应用程序。但我遇到了一个例外。这是我的代码：

```
@Path("/hello")
public class HelloWorldService {

    @GET
    @Path("/query/{artist_id}")
    @Produces("application/json")
    public Data getMsg(@PathParam("artist_id") int artist_id,
                            @QueryParam("from") int from,
                            @QueryParam("to") int to) {
        Data d=new Data();
        d.setName("Mateen");
        d.setRoll(77);
        return d;

    } 
```

}

我的数据只是一个 POJO 类：

```
@XmlRootElement
public class Data {
    private int roll;
    private String name;
    public int getRoll() {
        return roll;
    }
    public void setRoll(int roll) {
        this.roll = roll;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
} 
```

我得到一个例外：

```
javax.ws.rs.WebApplicationException: 
    com.sun.jersey.api.MessageException: 
    A message body writer for Java class com.abc.data.Data, 
    and Java type class com.abc.data.Data, 
    and MIME media type application/json was not found 
```

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2012-10-28T11:48:28.470

我终于找到了我的答案。我添加了

```
<dependency>
    <groupId>com.sun.jersey</groupId>
    <artifactId>jersey-json</artifactId>
    <version>1.8</version>
</dependency> 
```

到我的 pom.xml 文件。然后我加了

```
<init-param>
    <param-name>com.sun.jersey.api.json.POJOMappingFeature</param-name>
    <param-value>true</param-value>
</init-param> 
```

到我的 web.xml 文件，一切正常。我上面的代码不需要更改。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-07-12T08:23:56.120

我添加了以下罐子，它对我有用

*   杰克逊核心asl-1.9.2.jar
*   jackson-mapper-asl-1.9.2.jar
*   杰克逊-xc-1.9.2.jar
*   杰克逊-jaxrs-1.9.2.jar

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-04-05T13:57:34.620

只是一个小小的补充。如果您不使用 web.xml 描述符文件，您可以通过编程方式启用 POJOMappingFeatire，如下所示

```
...
final ResourceConfig rc = new PackagesResourceConfig("com.test.resources");
    final Map<String, Object> config = new HashMap<String, Object>();
    config.put("com.sun.jersey.api.json.POJOMappingFeature", true);
    rc.setPropertiesAndFeatures(config);
... 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-02-12T21:58:54.447

### Maven 用户：您只需要以下 2 个依赖项。

```
<!-- For Jersey --> 
<dependency>
        <groupId>org.glassfish.jersey.containers</groupId>
        <artifactId>jersey-container-servlet-core</artifactId>
        <version>2.15</version>
</dependency>

<!-- For JSON --> 
<dependency>
        <groupId>org.glassfish.jersey.media</groupId>
        <artifactId>jersey-media-json-jackson</artifactId>
        <version>2.15</version>    
</dependency> 
```

默认情况下支持 XML 输出。所以它不需要依赖。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-05-19T20:42:10.133

在使用 Jersey 1.8 时，我在创建 JSON 对象并从客户端访问 REST API 时遇到了同样的错误。

如果您在服务器端遇到问题，请确保您已在类路径中正确包含 jersey-json.jar 并在 web.xml 中映射正确的 init-param，如其他答案中所述。

## 对于客户端

根据[Jersey 1.8 文档](https://jersey.java.net/documentation/1.18/json.html)，以下代码段显示了如何在客户端使用 POJO JSON 映射功能：

```
 ClientConfig clientConfig = new DefaultClientConfig();
 clientConfig.getFeatures().put(JSONConfiguration.FEATURE_POJO_MAPPING,Boolean.TRUE);
 Client client = Client.create(clientConfig); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-18T10:53:42.620

我遇到了同样的问题：找不到 Java 类型、java.lang.String 类和 MIME 媒体类型 application/json 的消息正文编写器

问题是类 javax.ws.rs.ext.MessageBodyWriter 取自

```
<dependency>
        <groupId>org.glassfish.jersey.media</groupId>
        <artifactId>jersey-media-json-jackson</artifactId>
        <version>2.22.2</version>
    </dependency> 
```

与来自以下的同一个班级发生碰撞：

```
 <dependency>
        <groupId>com.sun.jersey</groupId>
        <artifactId>jersey-client</artifactId>
        <version>1.19.1</version>
    </dependency> 
```

# regex - XSL：如何按需生成正则表达式模式？

> ID：13108164
> 
> 赞同：3
> 
> 时间：2012-10-28T10:47:43.307
> 
> 标签：regex, xslt

我想按需生成一个正则表达式模式，但不知何故我失败了。也许有人知道为什么并且可以提供帮助。

我想要实现的是在输出中将定义文本的元素（例如）标记为粗体

源代码：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<catalog>
    <cd>
        <strong>Empire</strong>
        <title>Empire Burlesque</title>
        <artist>Bob Dylan</artist>
    </cd>
    <cd>
        <strong>your</strong>
        <strong>heart</strong>
        <title>Hide your heart</title>
        <artist>Bonnie Tyler</artist>
    </cd>
</catalog> 
```

XSL：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="html" indent="no"/>
    <xsl:template match="/">
        <html>
            <body>
                <table border="1">
                    <xsl:for-each select="catalog/cd">
                        <tr>
                            <td>
                                <xsl:call-template name="addBold">
                                    <xsl:with-param name="text" select="title" />
<xsl:with-param name="replace"><xsl:variable name="temp"><xsl:for-each select="strong">|<xsl:value-of select="." /></xsl:for-each></xsl:variable>(<xsl:value-of select='substring-after($temp,"|")' />)</xsl:with-param>
                                </xsl:call-template>
                            </td>
                            <td>
                                <xsl:value-of select="artist" />
                            </td>
                        </tr>
                    </xsl:for-each>
                </table>
            </body>
        </html>
    </xsl:template>

    <xsl:template name="addBold">
    <xsl:param name="text" />
    <xsl:param name="replace" />
    <xsl:analyze-string select="$text" regex="$replace">

        <xsl:matching-substring>
            <b><xsl:value-of select="regex-group(1)" /></b>
        </xsl:matching-substring>

        <xsl:non-matching-substring>
            <xsl:value-of select="." />
        </xsl:non-matching-substring>

    </xsl:analyze-string>

    </xsl:template>
</xsl:stylesheet> 
```

然后该`$replace`参数将包含例如。`(your|heart)`. 但它从未在`xsl:analyze-string`元素中匹配。

如果我`$replace`用硬编码的“ `(your|heart)`”替换它总是可以正常工作..

我错过了什么重要的事情吗？就像我不能使用变量/参数作为模式？还是我需要确保它的格式正确？我在调用模板段落中所做的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:13:59.860

您需要使用属性值模板`<xsl:analyze-string select="$text" regex="{$replace}">`，即`regex`属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T11:14:08.160

您的问题是您`regex`在`xsl:analyze-string`. regex 属性接受字符串作为输入。

它目前正在评估`regex`字符串文字 "$replace" 的值（它不会匹配任何内容）。

**您需要使用[属性值模板](http://www.w3.org/TR/xslt20/#dt-attribute-value-template)才能评估变量并将其字符串值用于`regex`：**

```
<xsl:analyze-string select="$text" regex="{$replace}"> 
```

此外，您可以使用以下内容简化为替换参数创建正则表达式的表达式：

```
<xsl:with-param name="replace" select="concat('(',string-join(strong,'|'),')')"> 
```

# objective-c - 尝试运行应用程序时模拟器出错

> ID：13108166
> 
> 赞同：0
> 
> 时间：2012-10-28T10:48:03.527
> 
> 标签：objective-c, xcode, uiviewcontroller, ios-simulator, uitableview

我使用情节提要创建了应用程序。我的应用程序有一个**表格、一些按钮和标签**。

当我尝试运行我的应用程序模拟器时会产生错误：`Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[UIViewController tableView:numberOfRowsInSection:]: unrecognized selector sent to instance 0x719de00'`

`UIViewController tableView:numberOfRowsInSection:`意味着我不能将“numberOfRowsInSection”与“UIViewController”一起使用？

我尝试改用“UITableViewController”，但使用此控制器，我无法在正确的位置找到按钮和标签。

**我做错了什么？**

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T10:50:14.000

您需要将 委托`UITableView`给`UIViewController`，打开 Connections 检查器并将“ `delegate`”和“ `dataSource`”条目拖到情节提要上的主视图控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T10:51:39.333

添加 UITableView 并设置 Datasource 和 Delegate 后，我们必须使用一些 UITableview 委托方法。例如 NumberOfRowsInSection、NumberOfSection 等。请使用基本委托方法或删除 UItableView。

# devise - 设计 + 声明授权 + 角色模型 + 不同用户模型名称：未定义的方法 `current_user'

> ID：13108167
> 
> 赞同：2
> 
> 时间：2012-10-28T10:48:11.377
> 
> 标签：devise, customization, declarative-authorization

尽管我在 application_controller.rb 中设置了这个变量，但我确实有这个著名的错误：“未定义的方法 `current_user'” 声明授权：

```
class ApplicationController < ActionController::Base
  protect_from_forgery
  before_filter :set_current_user

  protected

    def set_current_user
      Authorization.current_user = current_admin_utilisateur
    end
end 
```

我正在使用一个名为“ **admin_utilisateurs** ”的表而不是“用户”。在设计中激活了：“rails generate devise admin_utilisateur”

**设计工作得很好**。

有关信息，我使用“roles_model”gem 自定义了我的用户表（admin_utilisateurs），因此我确实有一个属性roles_mask，它允许我管理不同的角色，同时提供一个用于声明性授权的role_symbols 方法。

现在的问题是我得到了这个奇怪的错误，尽管 Authorization.current_user 是由 application_controller.rb 设置的。

这是我的一个资源控制器产生错误的开始：

```
class PubResponsablesController < ApplicationController

  before_filter :authenticate_admin_utilisateur!
  filter_resource_access

  ...
end 
```

我通过谷歌搜索此错误，但没有一个结果提供有效的解决方案。有人可以帮我吗？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T21:07:56.123

好的，这是最终答案。

我修改了我的 app/controller/application_controller.rb 因为我没有在视图中使用 @current_user 实例变量：

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  # This is mandatory if you want to secure as well your app/models
  before_filter :set_current_user

  # This method is required by declarative_authorization on every controller
  #  that is using filter_resource_access (or any other declarative_auth.. mechanism)
  def current_user
    current_admin_utilisateur
  end

  protected

  def set_current_user
    Authorization.current_user = current_admin_utilisateur
  end
end 
```

正如我所说，我正在合作使用以下 gem：

**用于身份验证的gem[设计](https://github.com/plataformatec/devise)**用户模型名称是“admin_utilisateur”而不是“用户”，但它可能是：帐户、成员、组或您需要的。

**gem [role_model](https://github.com/martinrehfeld/role_model)**为我的用户模型提供一个出色的角色方法“role_symbols” *该方法 role_symbols 返回一个“Set”子类而不是“Array”，但在 Github 上快速发布后，开发人员 (martinrehfeld) 在闪电分分钟。伟大的 ！*

**gem [declarative_authorization](https://github.com/stffn/declarative_authorization)**提供基于角色的访问管理。[以下帖子](https://groups.google.com/forum/?fromgroups=#!topic/declarative_authorization/6WVXUH43Vek)确认我使用与“用户”不同的模型名称的意愿。

declarative_authorization 唯一需要的是每个控制器上的**current_user方法。**由于我在 Devise 中使用了不同的模型名称（例如 admin_utilisateur、account、member 等），因此 devise 创建的助手具有不同的名称。它不是 current_user，而是 current_admin_utilisateur（或 current_account、current_member）。所以我必须创建自己的 current_user 方法。

declarative_authorization 所需的**role_symbols**方法由 role_model gem 提供。

我希望这将有助于其他开发人员，因为我花了两天时间来理清所有这些结构如何协同工作。设计让我更了解路由问题。

我给 RoRrrr 的几分钱 ;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T14:01:12.943

好的，我设法通过修改我的 app/controller/application_controller.rb 解决了这个错误：

```
class ApplicationController < ActionController::Base
  protect_from_forgery
  before_filter :set_current_user

  def current_user
    @current_user = current_admin_utilisateur
  end

  protected

    def set_current_user
      Authorization.current_user = current_admin_utilisateur
    end
end 
```

我刚刚创建了自己的 current_user 方法，该方法创建了一个实例变量 @current_user。这个是用 current_admin_utilisateur 的值初始化的，它基于 Devise 助手和我的自定义用户模型 admin_utilisateur。（我的模型也可以称为**acount、member 或其他...**）

我将 current_user 方法放在 application_controller 中，以便它在我的应用程序的每个控制器中都可用。

现在，我遇到了另一个错误：

```
User.role_symbols doesn't return an Array of Symbols (#<RoleModel::Roles: {:developer, :admin, :coordinator, :manager, :assistant, :distributor, :exporter, :historian}>) 
```

我不明白，因为 roles_model gem 为 admin_utilisateur 模型提供了别名方法“role_symbols”。

# excel - 使用 VBA 将表单值插入 Excel 电子表格

> ID：13108171
> 
> 赞同：1
> 
> 时间：2012-10-28T10:48:47.350
> 
> 标签：我正在尝试使用vba, excel, vba

[我正在尝试使用vba](/questions/tagged/vba "显示标记为“vba”的问题")将表单值插入到我的 Excel 电子表格中，但我当前的代码正在将值插入到同一行中。

1.  由于我的表从**第 3 行**开始，我想从那里开始，并通过每次自动转移到下一行来继续。行已经设置，我不想插入新行但会覆盖当前的“空”行。
2.  当输入 202 行（可用的最大行数）时，我希望电子表格返回一个错误消息对话框。

我怎样才能实现这一目标？

**当前代码**

```
 Private Sub btnSubmit_Click()

    Dim ws As Worksheet
    Set ws = Worksheets("main")

    ' Copy the data to the database
    ws.Rows("4:4").Insert Shift:=xlDown
    ws.Range("A3").Value = cbo_deptCode.Value
    MsgBox ("Booking request has been successfully made")

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:01:03.603

请试试这个，如果您有任何问题或疑虑，请告诉我们：

```
Sub Button1_Click()
    Dim ws As Worksheet
    Dim i As Long
    Set ws = Worksheets("main")

    ' Copy the data to the database
    i = Cells(Rows.Count, 1).End(xlUp).Row + 1 'Get last empty cell in column A
    If i > 202 Then
        MsgBox "Row 203"
        Exit Sub
    End If

    Range("A" & i).Value = cbo_deptCode.Value
    MsgBox ("Booking request has been successfully made")
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T11:44:30.927

像这样的东西

```
Private Sub btnSubmit_Click()
    Dim ws As Worksheet
    Dim rng1 As Range
    Set ws = Worksheets("main")
    Set rng1 = ws.Cells(Rows.Count, "a").End(xlUp)
    If rng1.Row > 202 Then
    MsgBox "202 Rows exceeded"  
    Else
    rng1.Offset(1, 0) = cbo_deptCode.Value
    End If
End Sub 
```

# objective-c - NSTableCellView 中的 NSStepper 没有效果

> ID：13108177
> 
> 赞同：7
> 
> 时间：2012-10-28T10:49:35.180
> 
> 标签：objective-c, nstablecellview

我在基于视图的表格视图中使用常规（非子类）NSTableCellView。它具有初始图像和文本字段视图。我在视图中添加了一个 NSStepper。

文本字段绑定到 tableCellView.objectValue.quantity。步进器的值也绑定到 tableCellView.objectValue.quantity。

问题是，在运行应用程序时，当我单击步进器时，它似乎没有获得鼠标事件，既没有箭头突出显示，也没有增加或减少值。

如果我设置表格视图的双重动作，如果我双击步进器，它就会被触发，就好像它是透明的一样。

我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-01T06:35:27.690

您应该查看文档，但最简单的是您需要继承 NSTableView 并覆盖此方法以验证提议的第一响应者。正如文档所述，除非首先选择该行，否则 NSTableViews 不允许使用某些控件。即使这样，它仍然可能会丢弃一些。

```
- (BOOL)validateProposedFirstResponder:(NSResponder *)responder forEvent:(NSEvent *)event {
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-23T13:24:07.027

除了 Robert Payne 的正确答案之外，您还可以使用 Swift 向 NSTableView 添加扩展，而不是对其进行子类化。

```
extension NSTableView {
    override public func validateProposedFirstResponder(responder: NSResponder, forEvent event: NSEvent?) -> Bool {
        return true
    }
} 
```

我想强调的是 NSTableView 而不是 NSTableViewCell。

# python - 如何将 webkit 与 scrapy 一起使用

> ID：13108179
> 
> 赞同：0
> 
> 时间：2012-10-28T10:49:57.587
> 
> 标签：python, webkit, scrapy

我需要用 javascript 抓取一个网页，看起来这在[http://snipplr.com/view/66996/renderedinteractive-javascript-with-gtkwebkitjswebkit/](http://snipplr.com/view/66996/renderedinteractive-javascript-with-gtkwebkitjswebkit/) 问题中提到的示例中已解决[从 Web 代码中提取数据](https://stackoverflow.com/questions/12332847/extracting-data-from-web?lq=1,the)使用 webkit 下载器类. 我知道我需要调用 process_request 函数。我在请求中作为参数传递了什么。我查看了scrapy文档，看看我是否必须传递在scrapy中创建的请求对象，但这不起作用。

另外，我知道蜘蛛对象将作为最后一个参数传入 process_request 。那应该是哪个对象？抱歉，我是 python、scrapy 和 webkit 的新手，所以可能会问一些有明显答案的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T15:42:31.450

您无需`process_request`手动“调用”，只需声明它，引擎将使用所有正确的参数调用它。只需创建一个名为`middleware.py`（或任何您想调用的文件）并输入：

```
...
class WebkitDownloader( object ):
    def process_request( self, request, spider ):
        if not isinstance(request, FormRequest):
            webview = webkit.WebView()
            ... 
```

以及所有其余部分，然后在您的 settings.py 文件中输入：

```
DOWNLOADER_MIDDLEWARES = {
    'mybot.middleware.WebkitDownloader': 1000,
    ...
} 
```

这应该让你的中间件工作。

# symfony - 注册验证后，Silex 翻译停止工作

> ID：13108184
> 
> 赞同：8
> 
> 时间：2012-10-28T10:51:20.893
> 
> 标签：symfony, silex

我用 YAML 注册了 TranslationServiceProvider，它工作正常：

```
$app->register(new TranslationServiceProvider(), array(
    'locale_fallback' => 'ru',
));

$app['translator'] = $app->share($app->extend('translator', function($translator, $app) {
    $translator->addLoader('yaml', new YamlFileLoader());
    $translator->addResource('yaml', CONTENT_PATH . '/locales/en.yml', 'en');
    return $translator;
})); 
```

然后我像这样注册 ValidationServiceProvider ：

```
$app->register(new Silex\Provider\ValidatorServiceProvider()); 
```

当我注册验证时，翻译停止工作。所有应该翻译的字符串都不会被翻译而没有错误。我正在更改计数器中的语言环境，所以它可能与它有关：

```
$en->get('/{slug}', function (Silex\Application $app, $slug) {
    $app['locale'] = 'en'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-26T13:01:56.563

因此，所有服务（来自服务提供者）在运行时、请求之前、在创建过程中获取语言环境。而且，如果没有提供真实的语言环境，则翻译器将获得备用语言环境。

问题：您不能在运行时更改语言环境，因为语言环境是一个变量而不是作为链接呈现（如果语言环境将是对象，您可以更改语言环境）。

解决方案：根据请求订阅者更改/设置区域设置。

# php - php MYSQL中的多个AND OR语句

> ID：13108187
> 
> 赞同：0
> 
> 时间：2012-10-28T10:51:28.190
> 
> 标签：php, mysql

这似乎有什么问题。我没有得到任何明显的错误，但它根本没有做它应该做的事情。我倾向于 OR 语句存在问题，但我已将用户名放在括号中，将 id 插槽放在括号中，但都不起作用。老实说，我只是在这里发布这个，因为五个小时的时间对我来说已经足够了。希望有些东西看起来明显错误，并且不在代码中的其他地方：/

```
$fetch_userone_idslots = mysql_query("SELECT id_1, id_2, id_3, id_4, id_5, id_6 FROM users WHERE id_1 = '$battle_id' || id_2 = '$battle_id || id_3 = '$battle_id || id_4 = '$battle_id || id_5 = '$battle_id || id_6 = '$battle_id && username == '$user_logged_in'");

while ($row = mysql_fetch_array($fetch_userone_idslots)){
$useroneidslot_1 = $row['id_1'];
$useroneidslot_2 = $row['id_2'];
$useroneidslot_3 = $row['id_3'];
$useroneidslot_4 = $row['id_4'];
$useroneidslot_5 = $row['id_5'];
$useroneidslot_6 = $row['id_6'];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T10:53:32.363

您正在使用`==`MySQL 中不存在的。只使用`=`. 您可以像这样简化查询

```
SELECT id_1, id_2, id_3, id_4, id_5, id_6 FROM users
WHERE '$battle_id' in (id_1, id_2, id_3, id_4, id_5, id_6) 
and username = '$user_logged_in' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T10:52:54.903

在`MySQL`你需要使用`AND`或`OR`不使用`||`和`&&`. 还有一件事没有`==`，只能使用`=`。

```
SELECT id_1, id_2, id_3, id_4, id_5, id_6 
FROM users 
WHERE (
      id_1 = '$battle_id' OR 
      id_2 = '$battle_id' OR  
      id_3 = '$battle_id' OR 
      id_4 = '$battle_id' OR  
      id_5 = '$battle_id' OR  
      id_6 = '$battle_id'
      ) AND 
      username = '$user_logged_in' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T10:53:06.723

编辑：

`==`如果您需要方程式，请不要使用。在 SQL`==`中只是`=`. SQL与C不同，它是一种查询语言，语法不同，因为它用于不同的目的。我的建议是遵循 SQL 语法以避免类似的错误。

# ios - 横向模式下的导航控制器堆栈，但总是以纵向帧大小模态呈现视图控制器视图

> ID：13108198
> 
> 赞同：1
> 
> 时间：2012-10-28T10:52:57.100
> 
> 标签：ios

我的应用程序主要使用导航控制器堆栈，有时会模态显示一些控制器。在横向模式下，导航控制器堆栈中的控制器工作正常，但 presentViewController 或以前的 presentModalViewController 显示的其他视图控制器始终提供纵向大小的视图框架（在 iPad iOS 6.0 上始终为 768x1024） - 即使在纵向和横向之间来回旋转也是如此。

与[视图控制器处于横向模式有关，但我从纵向模式获取框架？](https://stackoverflow.com/questions/7631094/a-view-controller-is-in-landscape-mode-but-im-getting-the-frame-from-portrait)但是检查的答案没有帮助。如果我将稍后的视图控制器添加为导航堆栈的一部分，则在第一次加载和后续旋转时会发生调整大小。如上所述，只有在通过 presentViewController 添加控制器时才会出现问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T11:03:48.773

将模态分支包装到另一个导航控制器并在那里定义旋转掩码。在 iOS6 中，`- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)`仅适用于导航堆栈分支和整个分支的工作方式应该相同。

因此，子类化导航：

```
@interface CLNotRotatingNavController : UINavigationController 
```

并在其 .m 中添加此

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return NO;
}

- (NSUInteger)supportedInterfaceOrientations {
    return UIInterfaceOrientationMaskLandscape;
}

- (BOOL) automaticallyForwardAppearanceAndRotationMethodsToChildViewControllers {
    return YES;
} 
```

并将所有模态分支包装到此导航。这将在必要时将所有内容锁定到横向。

# entity-framework - 在代码优先的 DbContext 上批处理 ExecuteSqlCommand 语句

> ID：13108202
> 
> 赞同：1
> 
> 时间：2012-10-28T10:53:29.693
> 
> 标签：entity-framework, entity-framework-4, entity-framework-4.1

我每分钟调用 ExecuteSqlCommand 数千次，每一次都是到数据库的往返。命令本身调用存储过程，参数从 INT 到 NVARCHARS 再到“结构化”表值参数。当我查看 Entity Framework 通过 SQL Profiler 生成的 SQL 命令时，相当大的数据块被发送到数据库。

鉴于 SP 没有返回值，这非常“一劳永逸”，我想尝试批量处理 SQL 命令并一次发送一批 10 个。这可能使用实体框架吗？有没有办法让实体框架在每次调用时向我返回完整的 SQL 命令，然后我可以自己连接 SQL 并自己调用 ExecuteSqlCommand？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T16:49:01.053

EntityFramework 当前不支持批处理。但是，如果您只是执行 SQL 查询，那么我看不到使用 EntityFramework 的好处。您可以再往下一层到纯 ADO.NET，它支持批量发送 Sql 命令。查看此 MSDN 帖子了解更多详细信息：http: [//msdn.microsoft.com/en-us/library/aadf8fk2​​.aspx](http://msdn.microsoft.com/en-us/library/aadf8fk2.aspx)

# mysql - 限制 wpdb 查询的结果

> ID：13108204
> 
> 赞同：0
> 
> 时间：2012-10-28T10:53:47.223
> 
> 标签：mysql, wordpress

此代码仅显示当前类别的标签，但它获取所有标签（数百个），因此，我需要限制返回结果的数量并使它们随机化。

如何让这个查询随机只得到 20 个结果？

```
/* Retrieve all tags from posts in selected categories */

$cats = array('beaches','mountains');  // Must be an array even if only one category
$cats_string = "'" . implode($cats,"','") . "'";
$sql = <<<EOSQL
SELECT DISTINCT t.*
FROM $wpdb->posts p
JOIN $wpdb->term_relationships tr ON p.ID = tr.object_id
JOIN $wpdb->term_taxonomy tt ON (tr.term_taxonomy_id = tt.term_taxonomy_id
   AND tt.taxonomy = 'post_tag')
JOIN $wpdb->terms t ON tt.term_id = t.term_id
WHERE
   p.ID IN (
      SELECT p2.ID
      FROM $wpdb->posts p2
      JOIN $wpdb->term_relationships tr2 ON p2.ID = tr2.object_id
      JOIN $wpdb->term_taxonomy tt2 ON (tr2.term_taxonomy_id = tt2.term_taxonomy_id     AND tt2.taxonomy = 'category')
  JOIN $wpdb->terms t2 ON (tt2.term_id = t2.term_id AND t2.name IN ($cats_string))
  WHERE p2.post_type = 'post'
  AND p2.post_status = 'publish'
  AND p2.post_date <= NOW()
  )
  EOSQL;

$terms = $wpdb->get_results($sql);

// print_r($terms);

echo "<br />";
foreach ($terms as $term) {
   echo "ID:$term->term_id NAME:$term->name SLUG:$term->slug<br />";
} 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:18:09.113

您可以尝试一个`ORDER BY RAND() LIMIT 20`，这取决于您的桌子大小，这可以在适当的时间内运行。请参阅[此处](http://www.webtrenches.com/post.cfm/avoid-rand-in-mysql)有关何时避免`order by rand()`逻辑的一些详细信息。就像建议的那样，在指定的帖子中，另一种方法是检索所有条目并随机选择 20 个条目，在 PHP 中而不是使用 mysql。

# html - Flowplayer 在 IE9 中找不到视频，在 IE8 及以下版本中找不到视频

> ID：13108205
> 
> 赞同：1
> 
> 时间：2012-10-28T10:53:58.907
> 
> 标签：html, internet-explorer, video, internet-explorer-9, flowplayer

我正在尝试使用 Flowplayer 在可用的情况下允许 HTML5 视频，并在不支持时使用 Flash 后备。

这在 Firefox 和 Chrome 中运行良好，但是在 IE9 中找不到视频，而在 IE9 下它不支持视频。

是我做错了什么还是 IE 不支持 flowplayer？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-01T16:44:43.330

## 解决方案总结

我遇到了类似的问题，我想我已经解决了，所以也许这也会为您解决。我的问题最终是我的 .mp4 视频文件的 MIME 类型被用作视频/mpeg。当视频作为 video/mp4 提供时，它会在 IE9 上正确加载。我没有测试 .ogg 文件，但我感觉问题很相似。

## 分析：

我有点困惑，因为我在[flowplayer 演示](http://flowplayer.org/demos/)页面和这个[HTML5 视频播放器比较](http://praegnanz.de/html5video/p_flowplayer.php)页面上看到了视频作品（在所有浏览器中）。然而，我觉得有点平反，因为他们自己的开发人员无法获得一致的负载，已作为[错误报告](https://github.com/flowplayer/flowplayer/issues/63)的一部分提交，他们的[“修复”演示](http://example.flowplayer.org/api/load.html)也对我不起作用（但他们的主要演示是！） .

## 扣除：

在完全镜像他们的设置并遵循[设置文档](http://flowplayer.org/docs/)之后，我的播放器仍然无法在 IE9 中运行，但可以在 Firefox、Chrome 和 IE8 中运行（带有 Flash 后备）。

我决定尝试从他们的服务器加载他们的视频，并且立即生效。我检查了 IE9 中的网络窗格，发现了 MIME 类型的差异。当 flowplayer 服务器将 .mp4 文件作为“video/mp4”提供时，我的服务器将 .mp4 文件作为“video/mpeg”提供。我知道 .mp4 文件类型只是一个容器，而视频文件取决于底层编码方案，但我感觉 IE9 只是在尝试基于 MIME 类型解码视频时很挑剔——它甚至不会尝试如果它不是它认为可以播放的东西，就播放它。我让网络管理员更改了 MIME 类型，之前失败的同一视频现在可以完美运行。

作为参考，这是我设置 HTML 的方式：

### 在头上

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script> 
<script src="http://releases.flowplayer.org/5.1.1/flowplayer.min.js"></script> 
```

### 在身体里

```
<div class="flowplayer is-splash">
    <video preload="none">    
        <source src="http://stream.flowplayer.org/black/470x250.mp4" type="video/mp4" />
    </video>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T12:39:58.637

这是一个似乎对我有用的解决方案....

基本上，flowplayer 的 flash 后备似乎在 IE 中不起作用......

解决方案是使用旧的 Flowplayer flash 插件并使用 IE 条件标签，如下所示：

```
<!--[if IE]>

    <a href="videos/file.mp4"
       style="display:block;width:520px;height:330px"  
       id="player"> 
    </a> 

    <script>
    flowplayer("player", "/swf/flowplayer-3.2.15.swf");
    </script>

<![endif]-->

<!--[if !IE]><!-->  

    <div class="flowplayer" data-swf="swf/flowplayer.swf" data-ratio="0.417">
        <video>
        <source type="video/mp4" src="videos/file.mp4"/>
        <source type="video/ogg" src="videos/file.ogv"/>
        </video>
    </div>

<!--<![endif]--> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T21:57:43.797

经过大量研究并且无法添加标题标签以强制兼容模式（因为我的视频在模式内）。我通过更改源标签使其适用于 IE9

`<source type="video/mp4" src="video.mp4"></source>`

到

`<source type="text/html" src="video.mp4"></source>`

我看到当视频没有在 IE9 中播放时，mp4 文件被重新渲染为 text/html 而不是 video/mp4 ......所以我只是尝试更改标签并且它有效！

我知道这没有任何意义......但是既然 IE 什么时候有意义？！所以，如果你不能在你的 php 文件 header('X-UA-Compatible: IE=EmulateIE8'); 像我的情况一样，尝试将 mp4 类型设置为 text/html

# java - 使用 SQL 对列表进行排序还是作为集合排序？

> ID：13108207
> 
> 赞同：13
> 
> 时间：2012-10-28T10:54:04.160
> 
> 标签：java, sql, jakarta-ee, collections

我的数据库中有一些带有日期的条目。什么是最好的？：

*   使用 sql 语句获取它们并应用`order by`.
*   用 sql 获取列表，并在应用程序中使用 orso 对它们进行排序`collection.sort`？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-28T11:03:07.930

这是一个很难回答的非常广泛的问题，很大程度上取决于您所说的*best*是什么意思？

*   从*性能的角度来看*，您只需进行测量以确定系统的哪一部分是瓶颈。数据库通常非常高效，但仍可能与将工作分担给客户端相关。

*   从[关注点分离的](http://en.wikipedia.org/wiki/Separation_of_concerns)角度来看，这取决于排序在应用程序中的重要性以及应用程序的分层方式。

问问你自己：*“数据排序的知识属于哪里？”* 和*“如果我从关系数据库存储更改为不同的东西会发生什么*”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-28T21:59:25.717

在某种程度上，这取决于完整集合中有*多少值。*例如，如果是 20-30 个值，那么您可以在任何地方进行排序——即使是相对较差的排序算法也可以快速完成（尽管避免[Stooge 排序](http://rosettacode.org/wiki/Sorting_algorithms/Stooge_sort)；这很糟糕）——因为这就是您可能期望的数据块大小实际获取一个服务响应。

但是一旦你进入更大的数据集，你需要更加仔细地计划。特别是，您希望避免在不必要的情况下移动数据。如果数据当前仅存在于数据库中，那么您真的不想将其全部提取到客户端只是为了对其进行排序（一个相对昂贵的操作），然后几乎将其全部丢弃。实际开始时最好将数据库中的数据进行排序，这样按顺序提取数据就变得微不足道了；在关系数据库术语中，保持数据排序在功能上与维护数据索引相同。实际上，您可以对数据有多个索引，这可以使相当复杂的查询变得更快。（NoSQL DB 更加多样化；有些甚至不支持保持数据排序的概念。

所以……回到您的问题，您可能不想尝试不对应用程序中的数据进行排序：对于大多数数据，适当的索引可以更有效，因为它让您的代码*甚至不查看不需要的数据*。但是，如果您出于其他原因必须将其全部提取到您的应用程序中，并且您无法将其带入预先排序的状态，则没有理由避免自己对其进行排序：Java 的排序算法高效且稳定。但是您应该*衡量*以新顺序从数据库中获取它是否更快。（问题是数据库开销是否超过了重新排序的超线性成本；很多问题都在“可能；很难说”是答案的领域。）

另一件需要平衡的事情是，您的代码是否更简单，不自己进行排序而是始终将其委托给数据库。让您的代码更简单（并且更无错误）是一个很好的目标……</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T10:59:56.903

数据库管理系统 (DMBS) 已针对这些任务进行了优化，因此我认为您应该坚持使用它们。特别是如果您从用 PHP 或（其他脚本语言）编写的脚本访问数据库，使用脚本执行该任务可能会更慢。如果您使用脚本对数组进行排序，您也可能会达到 PHP 允许使用的内存限制。

我并不是要提出不同编程语言的性能问题，只是想指出，尽可能依赖 DMBS 是一种非常好的做法。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-04-01T20:20:24.627

这对我来说是一个非常有趣的问题，我想提出公认答案的另一面，顺便说一句，这是一个非常好的答案，我不一定*不同意。只想呈现另一面。当我开始我的职业生涯时，我正在研究大型机 DB2，而教我的老前辈们非常坚持在 db 之外进行排序。他们这样做的理由是可以卸载它的工作，这使数据库可以自由地为其他请求提供服务。当然，它远比这更微妙。一般来说，我会说您正在权衡的因素是：A）您的数据库有多忙或对您的系统有多重要？如果您的数据库非常繁忙，如果您在客户端或应用服务器上有大量 OLTP 处理，并且您的客户端或应用服务器有大量过剩容量，为什么不在应用服务器或客户端上排序？即使它的效率较低，它也会将工作分散到整个系统中，并从整个系统的角度为您提供更多的吞吐量。B) 排序有多大？比如说，因为您对海量 MB 的数据进行了排序，所以破坏您的调用堆栈或 Java 堆是很愚蠢的。C) 在您的应用程序或应用程序服务器中进行排序会导致暂停、延迟等吗？换句话说，如果您的特定编程语言的排序库非常糟糕，并且您不想编写自己的库，那么让 DB 花费 0.5 秒可能比让您的应用程序花费 5.0 秒要好。炸毁您的调用堆栈或 Java 堆，因为您对大量 MB 数据进行了排序。C) 在您的应用程序或应用程序服务器中进行排序会导致暂停、延迟等吗？换句话说，如果您的特定编程语言的排序库非常糟糕，并且您不想编写自己的库，那么让 DB 花费 0.5 秒可能比让您的应用程序花费 5.0 秒要好。炸毁您的调用堆栈或 Java 堆，因为您对大量 MB 数据进行了排序。C) 在您的应用程序或应用程序服务器中进行排序会导致暂停、延迟等吗？换句话说，如果您的特定编程语言的排序库非常糟糕，并且您不想编写自己的库，那么让 DB 花费 0.5 秒可能比让您的应用程序花费 5.0 秒要好。

因此，与所有事物一样，“这取决于”;-)。但是，我认为这些是它所依赖的东西。

# winapi - 如何将要呈现的任意窗口重定向到内存中的后备缓冲区？

> ID：13108210
> 
> 赞同：4
> 
> 时间：2012-10-28T10:54:27.963
> 
> 标签：winapi

我正在试验一个本土的应用程序托管框架，我想抽象输入/输出，以便我可以优雅地处理崩溃。Chrome 使用非常相似的模型。

有什么方法可以获取任意窗口句柄，并说服它开始渲染到后台缓冲区？还是我应该先创建自己的窗口，然后将客户端应用程序重新放入其中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T23:15:01.070

正如评论所说，如果您愿意自己挖掘并挂钩 API，您可以做任何事情，但根据[MSDN WM_PAINT 页面](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145216%28v=vs.85%29.aspx)中的评论， WM_PRINT 是强制窗口在特定 DC 上绘制的受支持方式。

听起来您还需要阻止窗口显示在桌面上 - 在这种情况下，您可以使用 WM_SETREDRAW 中所述的[在 Win32 上，我可以在一段时间内禁用窗口的绘制吗？](https://stackoverflow.com/questions/5001566/on-win32-can-i-disable-painting-of-a-window-for-a-period-of-time).

# c#-3.0 - 如何在 C# 中调用长时间运行的 Web 服务？

> ID：13108211
> 
> 赞同：-1
> 
> 时间：2012-10-28T10:54:29.167
> 
> 标签：c#-3.0

我有一种 Web 服务方法，它需要很长时间才能运行。我想让它异步
，Web 服务客户端不应该等待 Web 方法完成。我如何在 c# 上实现这一点。

```
//Web Method
[WebMethod]
public void StartProcess()
{
//long running method
}

//Web Client
webService.StartProcess(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T11:16:06.723

通过在 VS 中选择 async 选项生成您的服务引用或对其进行编辑，现在生成过程将创建两个调用，一个是您可以调用的 yourMethodAsync。您也可以通过这种方式设置回调。您还可以在 C# 中使用并行任务来调用后台线程。我更喜欢生成异步方法，因为它更干净。

[这是一个可以帮助的帖子](https://stackoverflow.com/questions/400798/how-to-make-a-call-to-my-wcf-service-asynchronous)

# service - grailsApplication 未注入服务，Grails 2.1.0

> ID：13108214
> 
> 赞同：0
> 
> 时间：2012-10-28T10:55:12.260
> 
> 标签：service, configuration, code-injection, grails-2.1

我有服务，我从 grailsApplication 访问几个配置属性

我像这样注入它

```
 class MyWebService{
       def grailsApplication
       WebService webService = new WebService()

       def getProxy(url, flag){
        return webService.getClient(url)
      }

    def getResponse(){
     def proxy =  getProxy(grailsApplication.config.grails.wsdlURL, true)
     def response = proxy.getItem(ItemType)
     return response
   }
} 
```

当我调用 getProxy() 方法时，我在 tomcat 日志中看到了这个

方法没有签名：org.example.MyWebService.getProxy() 适用于参数类型：(groovy.util.ConfigObject, java.lang.Boolean) 值：[[:], true] 可能的解决方案：getProxy()、getProxy (java.lang.String, boolean), setProxy(java.lang.Object)

这意味着 grailsApplication 没有被注入到服务中，有没有其他方法可以访问配置对象？根据 burtbeckwith 的 post configurationholder 已被弃用，想不出别的了。

有趣的是，同样的服务在我的本地 IDE（GGTS 3.1.0）中运行良好，这意味着本地 grailsApplication 正在被注入，但是当我创建一个部署到独立 tomcat 的战争时，它会停止注入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T12:58:53.427

我似乎已经找到了问题所在，实际上 grailsApplication 正在正确注入，否则它会引发空指针异常，我觉得配置属性没有被添加。实际上场景就像，我有一个单独的自定义配置文件，其中包含不同环境的配置数据，我的应用程序侦听环境类型（从 tomcat 设置的变量）并基于它合并来自我的自定义配置的相应配置属性文件。我认为这些属性可能没有被添加

# c++ - 如何在 C 或 C++ 中获取主板地址或处理器 ID/序列号？

> ID：13108215
> 
> 赞同：-3
> 
> 时间：2012-10-28T10:55:12.847
> 
> 标签：c++, c

我需要在 C/C++ 程序中获取主板或处理器的序列号。

我需要为我的软件识别一台唯一的计算机，这样一个许可证就不能在多台计算机上使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T11:02:54.920

HAL（硬件抽象层）可以给出Linux上的主板序列号。 [http://www.freedesktop.org/wiki/Software/hal](http://www.freedesktop.org/wiki/Software/hal)

这是背后的图书馆`lshal`：

```
$ lshal | grep 'system\.hardware\.serial'
  system.hardware.serial = '<serial-number>' 
```

# php - PHP：有没有一种优雅的方式来一次遍历多个项目（组）？

> ID：13108220
> 
> 赞同：1
> 
> 时间：2012-10-28T10:56:09.177
> 
> 标签：php, foreach

*给定一个包含N*项的数组：

```
$arr = array('a', 'b', 'c', 'd', 'e', 'f'); 
```

*在M*项目组中循环遍历的最优雅的方式是什么（假设*N*可以被*M*整除）？

我试过了

```
foreach (array_chunk($arr, 2) as list($first, $second)) {
    // do stuff with $first and $second
} 
```

但这导致了语法错误。

换句话说，我想模仿 Tcl 中的样子：

```
set arr [a b c d e f]
foreach {first second} $arr {
    // do stuff with $first and $second
} 
```

现在我已经采取了明显的措施：

```
foreach (array_chunk($arr, 2) as $group) {
    $first  = $group[0];
    $second = $group[1];
    // do stuff with $first and $second
} 
```

但我希望有人有更优雅的方法......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:06:55.900

**不**，没有像你想要的那样的语法糖。然而，他们有很多方法可以实现这一目标。

## 循环

```
for($i=0; $first=$arr[$i], $second=$arr[$i+1], $i<$len; $i+=2){
} 
```

## Foreach 循环

```
foreach (array_chunk($arr, 2) as $chunk) {
    list($first, $second) = $chunk;
} 
```

见`foreach`表格。它与您的语法没有太大不同。

## While 循环

```
$i=0;
while(list($first, $second) = array_slice($arr, ($i+=2)-2, 2)) {
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T11:03:56.167

你可以像这样使用它

```
$arr = array('a', 'b', 'c', 'd', 'e', 'f');

$chunks = array_chunk($arr, 2);
while (list($first, $second) = each($chunks))
{
    ...
} 
```

如果你放入`array_chunk()`它`each()`会产生一个无限循环:(

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-28T11:06:55.480

我会将您的最后一个变体更改为

```
foreach (array_chunk($arr, 2) as $group) {
    list( $first, $second) = $group;
    // do stuff with $first and $second
} 
```

我想到的任何其他解决方案都会更复杂，比如

```
for ( $i = 0; $i < ceil(count($arr)/2) ; $i++) {
    $first = $arr[$i*2];
    $second = $arr[$i*2+1];
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-28T11:24:36.070

您可以使用`array_splice`

```
while ( list($first, $second) = array_splice($arr, 0, 2) ) {
  echo $first.', '.$second.PHP_EOL;
} 
```

`notice`当`$arr`变为空时它会抛出一个

```
while ( !empty($arr) && list($first, $second) = array_splice($arr, 0, 2) ) {
  echo $first.', '.$second.PHP_EOL;
} 
```

但是`notice`如果数组的大小是 ，这仍然会抛出 a `odd`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-28T11:56:07.313

可能是利用 SPL 的 multipleIterator 的一个案例：

```
$arr = array('a', 'b', 'c', 'd', 'e', 'f');
$chunks = array_chunk($arr, 2);

$iterator = new MultipleIterator;
foreach($chunks as $chunk) {
    $iterator->attachIterator(new ArrayIterator($chunk));
}

foreach ($iterator as $values) {
    var_dump($values[0], $values[1], $values[2]);
} 
```

# c# - 任何地方的可靠原理示例？

> ID：13108222
> 
> 赞同：17
> 
> 时间：2012-10-28T10:56:21.420
> 
> 标签：c#, design-patterns

即使我们没有意识到这一点，我们也会用一些模式编写代码。我试图真正理解一些**SOLID**原则以及如何在现实世界中应用这些原则。

我正在与“ **D** ”作斗争。

我有时会混淆*Dependency Inversion*和*Dependency Injection*。这是否意味着只要您根据抽象（IE：接口）保持事情就完成了。

有人甚至有一个小的 C# 示例来解释它吗？

谢谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-28T13:03:36.310

看看 Mark Seeman 的博客，或者买他的书更好。它涵盖的不仅仅是 DI。我很感激您可能只是想要一个简单的示例来使用。然而，这是一个许多声称了解的人并不了解的主题，因此值得好好学习。

也就是说，这是一个非常简单的例子。据我了解，术语是 *Inversion of Control*和*Dependency Injection*。控制反转是指您将一个类的依赖关系的控制权交给了其他一些类，这与控制依赖关系本身的类相反，通常是通过`new`关键字。这种控制是通过依赖注入来施加的，其中给定或注入了一个类及其依赖项。这可以通过 IoC 框架或代码（称为[Pure DI](http://blog.ploeh.dk/2014/06/10/pure-di/)）来完成。注入可以在类的构造函数中通过属性或作为方法的参数执行。依赖关系可以是任何类型，它们不必是抽象的。

这是一个列出未使用兴奋剂的环法自行车赛冠军的课程：

```
class CleanRiders
{
    List<Rider> GetCleanRiders()
    {
        var riderRepository = new MsSqlRiderRepository();

        return riderRepository.GetRiders.Where(x => x.Doping == false);
    }
} 
```

这个类依赖于`MsSqlRiderRepository`. 该类控制实例的创建。问题是这种依赖是不灵活的。很难将其更改为 a`OracleRiderRepository`或 a `TestRiderRepository`。

IoC 和 DI 为我们解决了这个问题：

```
class CleanRiders
{
    private IRiderRepository _repository;

    public CleanRiders(IRiderRepository repository)
    {
        _repository = repository;
    }

    List<Rider> GetCleanRiders()
    {
        return _repository.GetRiders.Where(x => x.Doping == false);
    }
} 
```

现在这个类只依赖于一个接口。依赖项的控制权已交给类的创建者，必须通过其构造函数注入：

```
void Main()
{
    var c = new CleanRiders(new MsSqlRepository());

    var riders = c.GetRiders();
} 
```

可以说，这是一种更灵活、可测试和可靠的方法。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2018-01-10T03:44:20.210

S：单一职责原则

下面的代码有问题。“汽车”类包含两个不同的职责：首先是照顾汽车模型，添加配件等，然后是第二个职责：出售/租赁汽车。这会破坏 SRP。这两个职责是分开的。

```
public Interface ICarModels {
}

public class Automobile : ICarModels {
   string Color { get; set; }
   string Model { get; set; }
   string Year { get; set; }
   public void AddAccessory(string accessory)
   {
      // Code to Add Accessory
   }

   public void SellCar()
   {
      // Add code to sell car
   }
   public void LeaseCar()
   {
      // Add code to lease car
   }
} 
```

为了解决这个问题，我们需要分解汽车类并使用单独的接口：

```
public Interface ICarModels {
}

public class Automobile : ICarModels {
   string Color { get; set; }
   string Model { get; set; }
   string Year { get; set; }
   public void AddAccessory(string accessory)
   {
      // Code to Add Accessory
   }
}

public Interface ICarSales {
}

public class CarSales : ICarSales {
   public void SellCar()
   {
      // Add code to sell car
   }
   public void LeaseCar()
   {
      // Add code to lease car
   }
} 
```

在设计您的接口和类时，请考虑责任。修改类会涉及什么？将类分解成最简单的形式……但不是更简单（正如爱因斯坦所说）。

O：开/关原则

当需求发生变化并添加更多类型进行处理时，类应该具有足够的可扩展性，以便它们不需要修改。可以创建新类并将其用于处理。换句话说，类应该是可扩展的。我称之为“If-Type”原则。如果您的代码中有很多 if (type == ....)，则需要将其分解为单独的类级别。

在这个例子中，我们试图计算经销商中汽车模型的总价格。

```
public class Mercedes { 
   public double Cost { get; set; } 
} 

public class CostEstimation { 
   public double Cost(Mercedes[] cars) { 
     double cost = 0; 
     foreach (var car in cars) { 
        cost += car.Cost; } return cost; } 
} 
```

但是经销店不仅有梅赛德斯！这是类不再可扩展的地方！如果我们还想把其他车型的成本加起来怎么办？！

```
public class CostEstimation { 
   public double Cost(object[] cars)
   {
      double cost = 0;
      foreach (var car in cars)
      {
        if (car is Mercedes)
        {
            Mercedes mercedes = (Mercedes) car;
            cost += mercedes.cost;
        }
        else if (car is Volkswagen)
        {
            Volkswagen volks = (Volkswagen)car;
            cost += volks.cost;
        }
      }
      return cost;
   }
} 
```

现在坏了！对于经销商批次中的每个车型，我们必须修改类并添加另一个 if 语句！

所以让我们修复它：

```
public abstract class Car
{
    public abstract double Cost();
}

public class Mercedes : Car
{
    public double Cost { get; set; }
    public override double Cost()
    {
        return Cost * 1.2;
    }
}

public class BMW : Car
{
    public double Cost { get; set; }
    public override double Cost()
    {
        return Cost * 1.4;
    }
}

public class Volkswagen : Car
{
    public double Cost { get; set; }
    public override double Cost()
    {
        return Cost * 1.8;
    }
}

public class CostEstimation { 

   public double Cost(Car[] cars)
   {
    double cost = 0;
    foreach (var car in cars)
    {
        cost += car.Cost();
    }
    return cost;
   }
} 
```

到这里问题就解决了！

L：里氏替换原则

SOLID 中的 L 指的是 Liskov 原则。在派生类不能以任何方式修改基类的行为的情况下，可以巩固面向对象编程的继承概念。我将回到 LISKOV 原则的真实示例。但现在这是原则本身：

T -> 基地

其中 T [派生类] 不应篡改 Base 的行为。

一：接口隔离原则

c# 中的接口列出了需要由实现该接口的类实现的方法。例如：

```
Interface IAutomobile { 
   public void SellCar();
   public void BuyCar();
   public void LeaseCar();
   public void DriveCar();
   public void StopCar();
} 
```

在这个界面中，有两组活动正在进行。一组属于推销员，另一组属于司机：

```
public class Salesman : IAutomobile { 
   // Group 1: Sales activities that belong to a salesman
   public void SellCar() { /* Code to Sell car */ }
   public void BuyCar(); { /* Code to Buy car */ }
   public void LeaseCar(); { /* Code to lease car */ }

   // Group 2: Driving activities that belong to a driver
   public void DriveCar() { /* no action needed for a salesman */ }
   public void StopCar(); { /* no action needed for a salesman */ }
} 
```

在上面的类中，我们被迫实现 DriveCar 和 StopCar 方法。对推销员来说没有意义且不属于那里的东西。

```
public class Driver : IAutomobile { 
   // Group 1: Sales activities that belong to a salesman
   public void SellCar() { /* no action needed for a driver */ }
   public void BuyCar(); { /* no action needed for a driver */ }
   public void LeaseCar(); { /* no action needed for a driver */ }

   // Group 2: Driving activities that belong to a driver
   public void DriveCar() { /* actions to drive car */ }
   public void StopCar(); { /* actions to stop car */ }
} 
```

与我们现在被迫实施 SellCar、BuyCar 和 LeaseCar 的方式相同。显然不属于 Driver 类的活动。

为了解决这个问题，我们需要将界面分成两部分：

```
Interface ISales { 
   public void SellCar();
   public void BuyCar();
   public void LeaseCar();
}

Interface IDrive {
   public void DriveCar();
   public void StopCar(); 
}

public class Salesman : ISales { 
   public void SellCar() { /* Code to Sell car */ }
   public void BuyCar(); { /* Code to Buy car */ }
   public void LeaseCar(); { /* Code to lease car */ }
}

public class Driver : IDrive { 
   public void DriveCar() { /* actions to drive car */ }
   public void StopCar(); { /* actions to stop car */ }
} 
```

接口分离！

D：依赖倒置原则

问题是：谁取决于谁？

假设我们有一个传统的多层应用程序：

控制器层 -> 业务层 -> 数据层。

假设我们想从 Controller 告诉业务将 Employee 保存到数据库中。业务层要求数据层执行此操作。

所以我们开始创建我们的控制器（MVC 示例）：

```
public class HomeController : Controller { 
   public void SaveEmployee()
   {
       Employee empl = new Employee();
       empl.FirstName = "John";
       empl.LastName = "Doe";
       empl.EmployeeId = 247854;

       Business myBus = new Business();
       myBus.SaveEmployee(empl);
   }
}

public class Employee { 
 string FirstName { get; set; }
 string LastName { get; set; }
 int EmployeeId { get; set; }
} 
```

然后在我们的业务层中，我们有：

```
public class Business { 
   public void SaveEmployee(Employee empl)
   {
       Data myData = new Data();
       myData.SaveEmployee(empl);
   }
} 
```

在我们的数据层中，我们创建连接并将员工保存到数据库中。这是我们传统的三层架构。

现在让我们对我们的控制器进行改进。我们可以创建一个处理所有 Employee 操作的类，而不是在我们的控制器中使用 SaveEmployee 方法：

```
public class PersistPeople {
   Employee empl;
   // Constructor
   PersistPeople(Employee employee) {
      empl = employee;
   }
   public void SaveEmployee() {
     Business myBus = new Business();
     myBus.SaveEmployee();
   }    

   public Employee RetrieveEmployee() {
   } 

   public void RemoveEmployee() {
   }
}

// Now our HomeController is a bit more organized.
public class HomeController : Controller { 
   Employee empl = new Employee();
   empl.FirstName = "John";
   empl.LastName = "Doe";
   empl.EmployeeId = 247854;

   PersistPeople persist = new Persist(empl);
   persist.SaveEmployee();
   } 
} 
```

现在让我们专注于 PersistPeople 类。它与 Employee 类硬编码并紧密耦合。它在构造函数中接收一个 Emloyee 并实例化一个 Business 类来保存它。如果我们想保存“Admin”而不是“Employee”怎么办？现在我们的 Persist 类完全“依赖”于 Employee 类。

让我们使用“依赖倒置”来解决这个问题。但在此之前，我们需要创建一个 Employee 和 Admin 类都派生自的接口：

```
Interface IPerson { 
 string FirstName { get; set; }
 string LastName { get; set; }
 int EmployeeId { get; set; }
}

public class Employee : IPerson {
  int EmployeeId;
}

public class Admin : IPerson {
  int AdminId;
}

public class PersistPeople {
   IPerson person;
   // Constructor
   PersistPeople(IPerson person) {
      this.person = person;
   }
   public void SavePerson() {
      person.Save();
   }    
}

// Now our HomeController is using dependency inversion:
public class HomeController : Controller { 

   // If we want to save an employee we can use Persist class:
   Employee empl = new Employee();
   empl.FirstName = "John";
   empl.LastName = "Doe";
   empl.EmployeeId = 247854;
   PersistPeople persist = new Persist(empl);
   persist.SavePerson();

   // Or if we want to save an admin we can use Persist class:
   Admin admin = new Admin();
   admin.FirstName = "David";
   admin.LastName = "Borax";
   admin.EmployeeId = 999888;
   PersistPeople persist = new Persist(admin);
   persist.SavePerson();
   } 
} 
```

所以总而言之，我们的 Persist 类不依赖于 Employee 类，也没有硬编码。它可以采用任意数量的类型，例如 Employee、Admin 等。保存传入的任何内容的控制权现在由 Persist 类而不是 HomeController。Persist 类现在知道如何保存传入的任何内容（Employee、Admin 等）。控制现在被反转并交给 Persist 类。你也可以参考这个博客来了解一些关于 SOLID 原则的很好的例子：

参考：[https ://darkwareblog.wordpress.com/2017/10/17/](https://darkwareblog.wordpress.com/2017/10/17/)

我希望这有帮助！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-28T18:23:47.577

前几天我试图向我的同事解释这一点，在这个过程中，我什至自己也理解了这个概念。尤其是当我想出现实生活中依赖倒置的真实例子时。

**故事**

想象一下，如果一个汽车司机依赖一辆车：只能开一辆车——那辆车！这将是非常糟糕的：

![直接/硬依赖](../Images/3d2008be756c423f464421165fc968d6.png)

在这种情况下，依赖的方向是：Driver => Car（Driver 对象依赖于 Car 对象）。

值得庆幸的是，在现实生活中，每辆车都有界面：**“方向盘、踏板和变速杆”**。驾驶员不再依赖于汽车，因此驾驶员可以驾驶任何汽车：

![依赖倒置](../Images/c1a6bbd454f627d7068c76780b8e2213.png)

现在 TheDriver 依赖于 ICar 接口，TheCar 也依赖于 ICar 接口 - 依赖是**INVERTED**：

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-28T19:03:50.693

我不像其他人那样是专家，但会尝试用概念解释 DIP。DIP 的核心是对接口的编程，即您的高级类将依赖于抽象，而您的低级类也依赖于抽象。例如

假设您定义了一个抽象，`PhoneVendor`即它可以是三星、苹果、诺基亚等。对不起，我有一段时间没有编写 Java 的代码了，它可能有语法错误，但仍然是关于概念的。

```
public abstract class PhoneVendor {

    /**
    * Abstract method that returns a list of phone types that each vendor creates.
    */
    public abstract Vector getPhones(){ }
}

public class Samsung extends PhoneVendor{
    public Vector getPhones(){ // return a list of phones it manufactures...  }
}

public class PhoneFinder{
   private PhoneVendor vendor;

   public PhoneFinder(PhoneVendor vendor){ this.vendor = vendor;}

  /**
   *for example just return a concatnated string of phones
  */
   public string getPhoneTypes(){
      Vector ListOfPhones = PhoneVendor.getPhones();        
      return ListOfPhones;
   }
} 
```

如您所见，PhoneFinder 类依赖于抽象而不是 PhoneVendor 的实现。实现抽象的基础类与使用它的高级类分离。这使得设计非常灵活，添加新的低级类不会破坏任何以前编写的代码，因为 PhoneFinder 依赖于抽象而不是实现。

# php - Android：使用 PHP 连接到 MySQL

> ID：13108223
> 
> 赞同：0
> 
> 时间：2012-10-28T10:56:51.813
> 
> 标签：php, android

我跟着下面的文章

[http://blog.sptechnolab.com/2011/02/10/android/android-connecting-to-mysql-using-php/](http://blog.sptechnolab.com/2011/02/10/android/android-connecting-to-mysql-using-php/)

我能够执行我的 php 文件。我单独执行它并且工作正常。问题出在android执行部分。我正在为我面临的错误发布 Log Cat。尝试放入 ID 为“list”的列表视图，但错误仍然为 1

```
0-28 16:08:27.201: E/AndroidRuntime(664): **FATAL EXCEPTION: main**
10-28 16:08:27.201: E/AndroidRuntime(664): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.city/com.example.city.City}: java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list'
10-28 16:08:27.201: E/AndroidRuntime(664):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
10-28 16:08:27.201: E/AndroidRuntime(664):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
10-28 16:08:27.201: E/AndroidRuntime(664):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
10-28 16:08:27.201: E/AndroidRuntime(664):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
10-28 16:08:27.201: E/AndroidRuntime(664):  at android.os.Handler.dispatchMessage(Handler.java:99)
10-28 16:08:27.201: E/AndroidRuntime(664):  at android.os.Looper.loop(Looper.java:137)
10-28 16:08:27.201: E/AndroidRuntime(664):  at android.app.ActivityThread.main(ActivityThread.java:4424)
10-28 16:08:27.201: E/AndroidRuntime(664):  at java.lang.reflect.Method.invokeNative(Native Method)
10-28 16:08:27.201: E/AndroidRuntime(664):  at java.lang.reflect.Method.invoke(Method.java:511)
10-28 16:08:27.201: E/AndroidRuntime(664):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
10-28 16:08:27.201: E/AndroidRuntime(664):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
10-28 16:08:27.201: E/AndroidRuntime(664):  at dalvik.system.NativeStart.main(Native Method)
10-28 16:08:27.201: E/AndroidRuntime(664): Caused by: java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list'
10-28 16:08:27.201: E/AndroidRuntime(664):  at android.app.ListActivity.onContentChanged(ListActivity.java:243)
10-28 16:08:27.201: E/AndroidRuntime(664):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:254)
10-28 16:08:27.201: E/AndroidRuntime(664):  at android.app.Activity.setContentView(Activity.java:1835)
10-28 16:08:27.201: E/AndroidRuntime(664):  at com.example.city.City.onCreate(City.java:35)
10-28 16:08:27.201: E/AndroidRuntime(664):  at android.app.Activity.performCreate(Activity.java:4465)
10-28 16:08:27.201: E/AndroidRuntime(664):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
10-28 16:08:27.201: E/AndroidRuntime(664):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
10-28 16:08:27.201: E/AndroidRuntime(664):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T00:18:33.003

在您的 XML 中更改以下内容：

```
<Listview
    android:id="@+id/list"
    ... 
```

至：

```
<ListView
    android:id="@android:id/list"
    ... 
```

# android - Android - 远程服务器的基本 CRUD（REST/RPC 客户端）

> ID：13108224
> 
> 赞同：0
> 
> 时间：2012-10-28T10:56:52.913
> 
> 标签：android

根据 Virgil Dobjanschi 在 GoogleIO 2010 上的演讲，有很多关于 android 中 REST 客户端实现的讨论。我的要求可能不一定涉及，因为我可以自由选择配置。

1.  我只针对平板电脑
2.  如果没有其他简单的方法可以防止配置更改（修复横向模式等）

我正在努力实现。

1.  对我的服务器的基本 CRUD 操作（JSON RPC/REST）。基本上模仿来自android应用程序的ajax请求（没有webview，需要本机应用程序）

基于上面提到的谈话和一些阅读，我看到了这些选项。

1.  实现 Google IO 演讲中提到的 3 个中的任何一个
2.  特别是，最后一种模式可能更合适，因为我不太关心缓存。但不确定同步实现的“实时性”如何。
3.  在 AsyncTask 中使用 HTTP 请求。最简单，但需要避免在设备配置更改（方向更改等）期间重新发送请求。即使我固定在一个方向，活动的娱乐仍然会发生。所以需要优雅地处理它。
4.  使用 service 处理 http 请求。到目前为止，它说使用服务来处理长时间的请求。不确定这是否是简单 GET/POST/PUt 请求的好方法。

请分享你的经验，什么可能是最好的方法。

## 编辑：

进一步搜索会发现一些不错的帖子和代码示例。

1.  [适用于 Android 的 Spring](http://static.springsource.org/spring-android/docs/1.0.x/reference/html/index.html)
2.  [机器人香料](https://github.com/octo-online/robospice/wiki/Understand-the-basics-of-RoboSpice-in-30-seconds)
3.  [使用加载器](http://neilgoodman.net/2011/12/26/modern-techniques-for-implementing-rest-clients-on-android-4-0-and-below-part-1/)
4.  [使用服务](http://neilgoodman.net/2012/01/01/modern-techniques-for-implementing-rest-clients-on-android-4-0-and-below-part-2/)

我正在考虑通过服务来做到这一点。请评论您的建议。

# matlab - 图像处理 为什么高斯平滑通常与边缘检测一起使用

> ID：13108226
> 
> 赞同：-3
> 
> 时间：2012-10-28T10:57:18.820
> 
> 标签：matlab, image-processing

为什么高斯平滑通常与边缘检测一起使用？

边缘检测算法最适合的平滑方法是什么？是高斯平滑吗？如果是这样，为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T11:22:47.553

一个带有您自己的问题标题的简单谷歌就会回答您的问题。

基本上是为了避免噪音影响检测。

“因为这些内核近似于图像的二阶导数测量，它们对噪声非常敏感。为了解决这个问题，图像通常在应用拉普拉斯滤波器之前进行高斯平滑处理。”

来自.. [http://homepages.inf.ed.ac.uk/rbf/HIPR2/log.htm](http://homepages.inf.ed.ac.uk/rbf/HIPR2/log.htm)

# database - 使用实体框架为多个父记录立即加载最后一条相关记录

> ID：13108228
> 
> 赞同：0
> 
> 时间：2012-10-28T10:57:35.070
> 
> 标签：database, linq, entity-framework, linq-to-sql

有谁知道使用实体框架解决下述问题的好方法？

我正在尝试为我们的下一个版本提供一种高效的方式来显示已登录客户的已下订单。当然，当有大量数据可用时，分页始终是一种很好的技术，我希望看到没有任何分页技术的答案。

故事是这样的：客户下了订单，订单状态 = PENDING。根据某些策略，我们将该订单向上移动以使其获得批准。状态的每一次变化都会被记录下来，这样我们就可以看到状态的跟踪，甚至可以看到每个状态的额外注释行，这可以为在界面中看到这个订单的人提供一些额外的有价值的信息。

因此，订单与客户相关联。一个订单可以有多个订单状态存储在 OrderStatusHistory 中。

在我的测试场景中，我使用的客户有 100 多个订单，每个订单在 OrderStatusHistory 表中大约有 5 条记录。我现在希望在不使用分页的情况下在一个页面中查看所有订单，对于每个订单，我会显示最后一个相关状态和额外评论（如果有任何最后一个状态；两个字段都来自 OrderStatusHistory；最高记录给定 OrderId 的 ID）。

我尝试过多种方案，但我希望看到任何潜在的其他解决方案或对我已经尝试过的事情的评论。

*   在获取订单时尝试执行 Include() 但这仍然会导致在数据库上启动多个查询。每个订单都会触发对数据库的额外查询，以获取历史表中的所有订单状态。因此，这里查询所有状态，而不是只返回最后一个相关的状态，另外还会针对 100 个订单启动 100 个额外查询。当数据库中有 100000+ 个订单时，您可以想象这个问题。
*   在数据库上有 2 个计算列：LastStatus、LastStatusInformation 和一个常规的 Linq-Query，它获取通过实体模型可用的那些列。这种方法的问题在于，这些计算列是使用标量函数确定的，如果不从计算列中删除公式等，则无法更改该标量函数......

最后我对 SQL 和存储过程非常熟悉，但是由于数据层的其余部分使用实体框架，我想尽可能长时间地坚持下去，即使我对性能有疑问。使用 SQL 方法我会写这样的东西：

```
WITH cte (RN, OrderId, [Status], Information)
AS
(
SELECT ROW_NUMBER() OVER (PARTITION BY OrderId ORDER BY Id DESC), OrderId,    [Status], Information
FROM OrderStatus
)
SELECT o.Id, cte.[Status], cte.Information AS StatusInformation, o.* FROM [Order] o
INNER JOIN cte ON o.Id = cte.OrderId AND cte.RN = 1
WHERE CustomerId = @CustomerId
ORDER BY 1 DESC; 
```

它返回客户的所有订单以及公共表表达式提供的状态信息。

有谁知道使用实体框架的好方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T16:09:00.710

像这样的东西应该可以按您的意愿工作（只进行 1 db 调用），但我没有测试它：

```
var result = from order in context.Orders
             where order.CustomerId == customerId
             let lastStatus = order.OrderStatusHistory.OrderBy(x => x.Id).Last()
             select new
             {
                 //you can return the whole order if you need
                 //Order = order,
                 //or only the information you actually need to display
                 Number = order.Number,
                 Status = lastStatus.Status,
                 ExtraComment = lastStatus.ExtraComment,
             }; 
```

这假设您的`Order`课程看起来像这样：

```
public class Order
{
    public int Id { get; set; }
    public int CustomerId { get; set; }
    public string Number { get; set; }
    ...
    public ICollection<OrderStatusHistory> OrderStatusHistory { get; set; }
} 
```

如果您的`Order`班级没有类似`ICollection<OrderStatusHistory> OrderStatusHistory`属性的东西，那么您需要先加入。让我知道是否是这种情况，我将编辑我的答案以包含`join`.

# php - 将每个 mongodb 记录输出到 html 表

> ID：13108234
> 
> 赞同：2
> 
> 时间：2012-10-28T10:58:52.470
> 
> 标签：php, mongodb, crud, mongodb-php

我正在构建一个从 MongoDB 中提取记录的应用程序。我已经建立了thead>tr>th，如下所示：

```
 // building table head with keys
    $cursor = $collection->find();
    $array = iterator_to_array($cursor);
    $keys = array();
    foreach ($array as $k => $v) {
            foreach ($v as $a => $b) {
                    $keys[] = $a;
            }
    }
    $keys = array_values(array_unique($keys));
    // assuming first key is MongoID so skipping it
    foreach (array_slice($keys,1) as $key => $value) {
        echo "<th>" . $value . "</th>";
    } 
```

这给了我：

```
<thead>
    <tr>
        <th>name</th>
        <th>address</th>
        <th>city</th>
    </tr>
</thead> 
```

这工作得很好，它抓住了所有的钥匙并建立了表头。我不必指定任何内容，并且该广告是根据数据动态构建的。我无法弄清楚的部分是构建所有 tr>td's

我可以轻松地获取信息并像这样构建它：

```
$cursor = $collection->find();
$cursor_count = $cursor->count();
    foreach ($cursor as $venue) {
        echo "<tr>";
        echo "<td>" . $venue['name'] . "</td>";
        echo "<td>" . $venue['address'] . "</td>";
        echo "<td>" . $venue['city'] . "</td>";
        echo "</tr>";
    } 
```

这样做需要我在每次添加新字段时修改我的 php。如何像使用thead一样根据来自mongodb的数据自动构建tr> td？

我的数据如下所示：

```
{
  "name": "Some Venue",
  "address": "1234 Anywhere Dr.",
  "city": "Some City"
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:08:08.147

您是否尝试如下使用第二个 foreach

```
$cursor = $collection->find();
$cursor_count = $cursor->count();
    foreach ($cursor as $venue) {
        echo "<tr>";
        foreach (array_slice($keys,1) as $key => $value) {
           echo "<td>" . $venue[$value] . "</td>";
        }
        echo "</tr>";
    } 
```

# interface - 在 Go 中的接口中列出接口

> ID：13108237
> 
> 赞同：7
> 
> 时间：2012-10-28T10:59:04.280
> 
> 标签：interface, go

我不明白`container/heap`包中的以下代码片段。

```
type Interface interface {
    sort.Interface   //Is this line a method?
    Push(x interface{})
    Pop() interface{}
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T11:01:07.977

这是一个类型声明。

`heap.Interface`接口嵌入`sort.Interface`接口。

您可以将其视为一种继承/专业化：这意味着实现`heap.Interface`接口的结构被定义为实现`sort.Interface`方法和`Push`and`Pop`方法的结构。

Effective Go 中描述了接口嵌入：http: [//golang.org/doc/effective_go.html#embedding](http://golang.org/doc/effective_go.html#embedding)

# django - Django CMS - 在模板标签中调用 cmsplugin

> ID：13108239
> 
> 赞同：1
> 
> 时间：2012-10-28T10:59:23.060
> 
> 标签：django, django-templates, django-cms, django-tagging

**我的问题**

使用 Django CMS 2.3.3，在创建页面时，我在其他几个 cmsplugins 旁边使用 cmsplugin_picture*。在我的 cms 模板中，而不是这样做：

```
{% placholder "content" %}  //calling the Django Page including all plugins... 
```

我想分别调用每个 cmsplugin，但我该怎么做呢？[我在这里](http://docs.django-cms.org/en/latest/advanced/templatetags.html)查看了 Django 标签模板（过滤器） ，也在[这里](https://docs.djangoproject.com/en/1.4/topics/templates/)研究了 Django CMS 模板标签，但似乎都没有暗示这种可能性。我不得不说我是一个初学者，所以我可能没有把这些点联系起来......

**我试图达到的目标：**

在我的模板中，我有一个 IMG 标记（在`{% placeholder "content" %}`标记之外），我想用我在 Page/cmsplugin_picture 中定义的图像 url 填充它。所以我正在寻找一个允许我抓取该图像的占位符标签。在我最疯狂的梦想中，我会命名它：

```
{% show_placeholder "content" request.current_page.get_cmsplugin_picture %} 
```

**显然以上不起作用，但是这样的事情存在吗？**

**我也尝试过 cmsplugin_filer，但对我来说，解决这个特定问题并不一定更有益。*

编辑：我的意思是 Page/cmsplugin_picture -> 在 Django CMS 页面中，您可以在已安装的 cmsplugins 之间进行选择以添加到页面。就我而言，我选择 cmsplugin_picture 并上传图像（在该插件中）。我想在我的 Django 模板中“调用”这个图像。所以它不是一个静态的 url，而是动态的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T13:13:54.223

您应该在 img 标签所在的位置创建第二个占位符（并且可以选择使用`CMS_PLACEHOLDER_CONF`（http://docs.django-cms.org/en/2.3.3/getting_started/configuration.html#cms-placeholder ）限制插件的类型和数量-conf)。

# php - 在 Eclipse 中键入 PHP 时数组初始值设定项缩进错误

> ID：13108241
> 
> 赞同：6
> 
> 时间：2012-10-28T10:59:42.310
> 
> 标签：php, arrays, eclipse, indentation

我在 Preferences > PHP > Code Style > Fromatter > Line Wrapping 上设置了我的首选数组初始值设定项缩进，但是在键入数组初始值设定项缩进时是错误的：

```
$arr = array([ENTER]
····[CURSOR]) 
```

虽然我期待：

```
$arr = array([ENTER]
··[CURSOR]
) 
```

就像它发生在编辑 Javascript 代码一样。请注意，错误缩进仅在键入时发生，而显式 CTRL+SHIFT+F 会正确缩进数组初始值设定项。（所以不是许多其他询问如何设置缩进的问题的重复，因为这里设置了缩进但在键入时不应用。）

如何在键入数组初始值设定项时获得正确的缩进？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-31T09:41:46.740

我在 Zend Eclipse for PHP Developers 上的设置，在`PHP`> `Code Style`>下`Formatter`：

*   `Indentation`> `Tab policy`>`Spaces`
*   `Indentation`> `Indentation size`>`2`
*   `Indentation`> `Tab size`>`2`
*   `Indentation`> `Default indentation for array initializers`>`2`
*   `Line Wrapping`> `Expressions`> `Array initializers`> `Indentation policy`>`Indent by one`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T11:32:55.513

尝试将缩进策略设置为`Indent by one`（而不是`Default Indentation`）`Method Declarations -> parameters`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T22:46:30.780

在 Eclipse Juno 中，尝试使用 PHP -> Code Style -> Formatter -> Default indentation for array intializers = 1。它适用于我。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-24T11:21:23.287

在我的 Windows 实例中，必须重新启动 Eclipse 才能应用对此设置的更改：

`PHP > Code Style > Formatter > Default indentation for array intializers`

在其他情况下，它不是必需的。不知道为什么。

# jquery - 为 IE 模拟 HTML5 的“占位符”属性

> ID：13108245
> 
> 赞同：1
> 
> 时间：2012-10-28T11:00:17.617
> 
> 标签：jquery, html, placeholder

我知道有很多问题都有完整的答案，但我的情况有点不同。我正在尝试模拟“占位符”属性的确切行为，即-

**1\. 文本保持焦点不变**

**2.光标移动到文本的开头**

**3\. 文本无法通过鼠标单击拖动或键盘的 shift-arrow 选择**

**4\. 文字在按键或粘贴时消失**

第 5 个显然是在提交时删除了“this”文本。

我想我已经完成了 '1' 和 '4' 的第 1 部分，但 '2'、'3' 和第 4 的第 2 部分（onpaste）仍然是一个问题...... :(

到目前为止我的jQuery....

```
$(document).ready(function(){
if(!Modernizr.input.placeholder){
    $('[placeholder]').keypress(function() {
      var input = $(this);
      if (input.val() == input.attr('placeholder')) {
        input.val('');
        input.removeClass('placeholder');
      }
    }).keyup(function() {
      var input = $(this);
      if (input.val() == '' || input.val() == input.attr('placeholder')) {
        input.addClass('placeholder');
        input.val(input.attr('placeholder'));
      }
    }).keyup();
    $('[placeholder]').parents('form').submit(function() {
      $(this).find('[placeholder]').each(function() {
        var input = $(this);
        if (input.val() == input.attr('placeholder')) {
          input.val('');
        }
      })
    });
    $('[placeholder]').focus(function() {
    var input = $(this);
    if (input.val() == input.attr('placeholder')) {
              //move the cursor to beginning
              //move the text unselectable
    }
});
}
}); 
```

对于第 2 次和第 3 次，我尝试过使用 onselectstart、setCursorPosition、setSelectionRange 等……但似乎没有按预期工作。对于 onpaste，我想用按键绑定它，但现在不知道在 w3schools 上该怎么做 bcoz 没有这样的事件属性：http: [//www.w3schools.com/tags/ref_eventattributes.asp](http://www.w3schools.com/tags/ref_eventattributes.asp)虽然在 MSDN 它显示：[http ://msdn.microsoft.com/en-us/library/ie/ms536955%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ie/ms536955%28v=vs.85%29.aspx)。

所以请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T11:12:00.993

我建议一种不同的方法，使用 CSS 更改要显示在输入和 JS 上的标签的位置，仅在 IE 上，使标签可见。

```
(function ($) {

    $.fn.placeholder = function (options) {

        var options = $.extend({}, $.fn.placeholder.defaults, options);

        //show <label @for> for IE 
        if ($.browser.msie && $.browser.version < 10)
        {
            return this.each(function () {

                var $this = $(this);            

                $("label[for=" + $this.attr('id') + "]").show();

                //hide placeholder on focus
                $this.focus(function () {
                    if (!$.trim($this.val())) {
                        $("label[for=" + $this.attr('id') + "]").hide();
                    };
                });

                //show placeholder if the input is empty
                $this.blur(function () {
                    if (!$.trim($this.val())) {
                        $("label[for=" + $this.attr('id') + "]").show();
                    };
                });
            });
        }
    };

    //expose defaults
    $.fn.placeholder.defaults = {

    };
})(jQuery); 
```

# dart - 如何在 Dart 中正确使用 WebAudio 和 Timer

> ID：13108249
> 
> 赞同：1
> 
> 时间：2012-10-28T11:01:12.203
> 
> 标签：dart

我想创建一个随机声音音序器，只是为了了解更多关于 WebAudio 和 Dart 的信息。

我的想法是加载一些声音示例并以随机顺序无休止地播放它们。

为此，我已经加载了所有文件，将它们解码到 arraybuffer 中，并使用以下函数进行播放：

```
void startAudio()
{
   int index=random.nextInt(buffers.length);
   print("Audio played [${index}].");
   source.buffer=buffers[index];
   source.connect(context.destination, 0, 0);
   source.start(0);
   Timer timer=new Timer(100, this.proceed);
}

void proceed(Timer timer)
{
   this.startAudio();
} 
```

问题是一段时间后，声音停止播放。

出了什么问题？

这是做我想做的最好的方法吗？

如果有人想测试我的代码，这里是链接： [http ://cg.usr.sh/Dart/WebAudioTest/WebAudioTest.html](http://cg.usr.sh/Dart/WebAudioTest/WebAudioTest.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T13:38:54.263

在随机更改内容后，我让它按预期工作。

```
 import 'dart:html';
 import 'dart:math';
 import 'dart:async';

 class AudioMaker
 {
   List<String> urls;

   AudioContext context;
   List<AudioBuffer> buffers;

   Random random;

   AudioMaker()
   {
     this.urls=new List<String>();
     this.context=new AudioContext();
     this.buffers=new List<AudioBuffer>();
     this.random=new Random(0);
   }

   void checkAndStart()
   {
     if(buffers.length == urls.length)
     {
       Timer timer=new Timer.repeating(500, this.startAudio);
     }
   }

   void startAudio(Timer timer)
   {
     int index=random.nextInt(this.buffers.length);
     print("Audio played [${index}].");
     AudioBufferSourceNode source=context.createBufferSource();
     source.buffer=this.buffers[index];
     source.connect(context.destination, 0, 0);
     source.start(0);
   }

   void _decodeAudio(url)
   {
     HttpRequest hr=new HttpRequest.get(url, (req){
       this.context.decodeAudioData(req.response, (audio_buff)
           {
             print("${url} decoded.");
             this.buffers.add(audio_buff);
             checkAndStart();
           }, (evt)
           {
             print("Error");
           });
     });
     hr.responseType="arraybuffer";
   }

   void loadAndStart()
   {
     for(String url in this.urls)
     {
       this._decodeAudio(url);
     }
   }
 }

 main()
 {
   AudioMaker audioMaker=new AudioMaker();
   audioMaker.urls.add("bark.ogg");
   audioMaker.urls.add("drip.ogg");
   audioMaker.urls.add("glass.ogg");
   audioMaker.urls.add("sonar.ogg");
   audioMaker.loadAndStart();
 } 
```

# ios - 核心数据和表格视图

> ID：13108252
> 
> 赞同：0
> 
> 时间：2012-10-28T11:01:50.097
> 
> 标签：ios, uitableview, core-data, nsfetchedresultscontroller

设想 ：

我有一个费用跟踪 iOS 应用程序，我将费用从费用详细视图控制器存储到表视图中，该表视图显示费用列表以及类别和金额。

在 tableview 的顶部，是一个带有 CALENDAR 按钮的 UIView、一个显示日期的 UILabel 文本（例如：2012 年 10 月 23 日（Sun））和侧面的另外 2 个按钮。按下日历按钮会打开一个带有当前日期的自定义日历，这两个按钮用于相应地减少和增加日期。

我想根据我的核心数据实体“费用”中的属性日期来保存费用。

问题：假设我按下日历按钮并从那里选择一些随机日期，它下面的表格视图应该显示当天的特定费用。我的意思是我希望表格视图只显示特定日期的费用，如果我按下增加日期或减少日期的按钮，表格视图应该显示当天的费用。我正在使用 NSFetchedResultsController 和 Core Data 来节省开支。

关于我将如何实现这一目标的任何想法？这是FRC的代码。

```
-(NSFetchedResultsController *)fetchedResultsController

{

if(_fetchedResultsController != nil)
{
return _fetchedResultsController;
}

AppDelegate * applicationDelegate = (AppDelegate *) [[UIApplication sharedApplication] delegate];
NSManagedObjectContext * context = [applicationDelegate managedObjectContext];

NSFetchRequest * request = [[NSFetchRequest alloc]init];

[request setEntity:[NSEntityDescription entityForName:@"Money" inManagedObjectContext:context]];

NSSortDescriptor *sortDescriptor1 =
[[NSSortDescriptor alloc] initWithKey:@"rowNumber"
                        ascending:YES];

NSArray * descriptors = [NSArray arrayWithObjects:sortDescriptor1, nil];

[request setSortDescriptors: descriptors];
[request setResultType: NSManagedObjectResultType];
[request setIncludesSubentities:YES];

[sortDescriptor1 release];

self.fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:request
                                                                  managedObjectContext:context
                                                                  sectionNameKeyPath:nil
                                                                           cacheName:nil];
self.fetchedResultsController.delegate = self;

[request release];

NSError *anyError = nil;

if(![_fetchedResultsController performFetch:&anyError])
{
NSLog(@"error fetching:%@", anyError);
} 

return _fetchedResultsController;
} 
```

多谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T11:24:28.573

您必须使用具有适当设置`NSFetchedResultsController`的新创建一个新的：`NSFetchRequest``NSPredicate`

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"(date == %@)", dateToFilterFor];
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
// Edit the entity name as appropriate.
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Expense" inManagedObjectContext:self.managedObjectContext];
[fetchRequest setEntity:entity];
[fetchRequest setPredicate:predicate];

// ...

NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:self.managedObjectContext sectionNameKeyPath:nil cacheName:@"SomeCacheName"];
aFetchedResultsController.delegate = self;
self.fetchedResultsController = aFetchedResultsController; 
```

不要忘记`[self.tableView reloadData];`在分配新的 FRC 后打电话。

编辑：您可以将谓词`NSFetchRequest`分配给然后分配给 fetchedResultsController。您可以将谓词视为过滤器。

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"(date == %@)", dateToFilterFor]; 
```

如果您通过调用将其添加到获取请求中，则`[fetchRequest setPredicate:predicate];`告诉获取的请求仅获取`NSManagedObject`与您在谓词中提供的日期匹配的日期属性的结果。这正是您想要的。

因此，如果您有一个在用户选择日期后调用的方法，您可以像这样修改它：

```
- (void)userDidSelectDate:(NSDate *)date
{
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    // Edit the entity name as appropriate.
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Event" inManagedObjectContext:self.managedObjectContext];
    [fetchRequest setEntity:entity];

    //Here you create the predicate that filters the results to only show the ones with the selected date
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"(date == %@)", date];
    [fetchRequest setPredicate:predicate];

    // Set the batch size to a suitable number.
    [fetchRequest setFetchBatchSize:20];

    // Edit the sort key as appropriate.
    NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"timeStamp" ascending:NO];
    NSArray *sortDescriptors = @[sortDescriptor];

    [fetchRequest setSortDescriptors:sortDescriptors];

    // Edit the section name key path and cache name if appropriate.
    // nil for section name key path means "no sections".
    NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:self.managedObjectContext sectionNameKeyPath:nil cacheName:@"Master"];
   aFetchedResultsController.delegate = self;

   //Here you replace the old FRC by this newly created
   self.fetchedResultsController = aFetchedResultsController;

   NSError *error = nil;
   if (![self.fetchedResultsController performFetch:&error]) {
     // Replace this implementation with code to handle the error appropriately.
     // abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. 
    NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    abort();
   }

   //Finally you tell the tableView to reload it's data, it will then ask your NEW FRC for the new data
   [self.tableView reloadData];

} 
```

请注意，如果您不使用 ARC（您应该这样做），则必须适当地释放分配的对象。

# javascript - Javascript 中的继承：为什么这段代码什么都不做？

> ID：13108253
> 
> 赞同：0
> 
> 时间：2012-10-28T11:01:51.060
> 
> 标签：javascript, oop

该代码有什么问题？

```
var t={a:1};
var g={b:2};
g.prototype=new t();
alert(g.a); //do nothing 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T11:09:08.770

该变量`t`包含一个对象，而不是一个函数，因此您不能像对象构造函数一样使用它。

您可以将对象用作原型，但您需要一个构造函数来使用原型：

```
var t = { a: 1 };
function g() {
  this.b = 2;
}
g.prototype = t;
alert(new g().a); 
```

演示：http: [//jsfiddle.net/Guffa/WeuPG/](http://jsfiddle.net/Guffa/WeuPG/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T11:11:34.223

您使用 new 和构造函数来**创建**对象，但是您现在拥有的 t 和 g 已经是对象了。

这应该有效；

```
function t(){
  this.a = 1;
}

function g(){
  this.b = 2;
}

g.prototype = new t();

alert(new g().a); // 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T11:06:30.343

构造函数必须是函数。

这是一篇非常好的关于[继承的文章](http://www.klauskomenda.com/code/javascript-inheritance-by-example/)

# java - 在单独安装 MYSQL 时使用 XAMPP-phpmyadmin

> ID：13108257
> 
> 赞同：0
> 
> 时间：2012-10-28T11:02:08.833
> 
> 标签：java, php, mysql, phpmyadmin, xampp

我学习 PHP 。我在我的一台 PC 上**安装了 XAMPP 。**

我将**phpmyadmin**用于**mysql**目的。

但最近，我为一个 java 项目目的安装了**MYSQL 服务器。**

问题是，现在我无法通过 phpmyadmin 浏览器访问 mysql 服务

界面。

它显示一个错误。**#2003 MYSQL 错误。**

有什么办法可以同时使用这两者吗？

因为，我已经习惯了这些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T15:49:53.853

将 xampp 与另一个 mysql 安装一起使用很容易。你需要做三件事：

1）在 xampp/phpadmin/config.inc.php 并进行以下更改：

*   第21行更改密码
*   第 31-32 行将值更改为不同的用户（例如 20-21 中列出的 root 用户

2）进入 xampp/mysql/data 并复制 phpmyadmin 文件夹并将其复制到 data 文件夹以进行其他安装（注意：默认情况下，在 windows 中，这是在一个名为 program data 的隐藏文件夹中，因此您需要打开查看文件夹选项中的隐藏文件夹），例如，在我的驱动器上它是 C:/ProgramData/MySQL/MySQL Server 5.5/data。将 phpmyadmin 文件夹复制到数据文件夹中。这会将 phpmyadmin 表放入您的 mySQL 安装中。

3）重新启动一切

这不会解决所有问题，但它允许您从管理面板中访问/编辑表格。需要复制/调整其他几件事以使其完美

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-09T13:00:41.430

如果您想连接 phpmyadmin (mysql) 数据库，您必须将 mysql 连接器库添加到您的项目中。

这是 MySQL Connector/J » [5.1.36的下载链接](http://central.maven.org/maven2/mysql/mysql-connector-java/5.1.36/mysql-connector-java-5.1.36.jar)

之后，您必须为该库提供方言并创建`java.sql.Connection`接口的对象。

所以mysql的方言和添加如下连接字符串，你必须处理SqlException

```
public static void main(String args[]){
try{
Class.forName("com.mysql.jdbc.Driver");

Connection con = DriverManager.getConnection("jdbc:mysql://localhost:port_no/db_name","phpmyadmin's username","phpmyadmin's password");

}catch(Exception e){
   e.printStackTrace();
 }
} 
```

所以这就是你如何将mysql数据库与你的java应用程序连接起来

# javascript - javascript：我如何定义对象 jQuery 对象或其他对象？

> ID：13108262
> 
> 赞同：0
> 
> 时间：2012-10-28T11:02:50.520
> 
> 标签：javascript, jquery

所以，我有两个对象：

```
var object1 = $('div');
var object2 = {}; 
```

我如何定义这个 jQuery 对象，或者不是？

对于 JavaScript 版本 < 1.4

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:09:34.153

尝试使用 instanceof 检查它

`var isJqueryObject = object1 instanceof jQuery`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T11:10:32.077

```
var abc={};

if(typeof(abc.jquery)=="undefined"){

console.log("object is not a jquery object");

}else{

console.log("object is a jQuery object");

} 
```

如果对象是 jQuery 对象，那么

```
objectIdentifier.jquery =< version of jQuery> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T11:15:54.463

试试这种方式`var isJQ = ( object1 && jQuery == object.constructor);`

# php - 获取未选中复选框的值

> ID：13108268
> 
> 赞同：0
> 
> 时间：2012-10-28T11:03:18.703
> 
> 标签：php

我如何从我的复选框中获取未选中的值？

我有 3 个单选按钮。当我单击第一个必须选中所有复选框时，第二个单选按钮未选中所有复选框。第三个单选按钮可以检查一些复选框，所有未检查的复选框我想通过 UPDATE Query 将值从 0 发送到 1 到 DB。单选按钮工作正常，但我没有得到未选中复选框的值以将其发送到我的更新查询。这是带有表单元素的第一页的代码：

```
 //That is only a short version of my Select who works correct
    $abfrageT = "SELECT DISTINCT id_dexpd, acores.code_regate, detail_exp_devise.num_expertise ...
                    FROM acores, infos_bureau, demande_expertise_dev, detail_exp_devise, agents
                        WHERE acores.id_acores = '$id_acores'
                        AND demande_expertise_dev.date_dem_exp = '$expdev' ...";

    $ergebnisT = mysql_query($abfrageT) or die("Query failed with error: ".mysql_error());

        while($abfrageT = mysql_fetch_assoc($ergebnisT))
        {
            $newcup         =   $abfrageT['coupure'];
            $newpd          =   $abfrageT['code_devise'];
            $newns          =   $abfrageT['num_serie'];
            $IDX            =   $abfrageT['id_dexpd'];
            $NumExp         =   $abfrageT['num_expertise'];

  echo"<tr>";
// Here are the ckeckboxes:
  echo"<td bgcolor=".$bgcolor." id='myGlob2' align='center'><input type='checkbox' name='check1' value='$abfrageT[id_dexpd]' /></td>";
  echo"<td bgcolor=".$bgcolor." id='myGlob2'>&nbsp;&nbsp;". $newcup ." ". $newpd ."</td>";
  echo"<td bgcolor=".$bgcolor." id='myGlob2' >&nbsp;&nbsp;". $newns ."</td>";
  echo"<td >&nbsp;&nbsp;</td>";      
  echo'</tr>'; 
```

这里是我更新的第二页代码：

```
$NumExp         = $_GET['NumExp'];
$IDX            = $_GET['check1']; 

$QryUpAnswerIdn = "UPDATE detail_exp_devise SET detail_exp_devise.exp_val  = 1
                WHERE detail_exp_devise.num_expertise = $NumExp
                AND id_dexpd = $IDX";
$ResUpAnswerIdn = mysql_query($QryUpAnswerIdn) or die("Query failed with error: " . mysql_error());

if ($IDX) {
$QryUpAnswerId = "UPDATE detail_exp_devise SET detail_exp_devise.exp_val  = 0
                WHERE detail_exp_devise.num_expertise = $NumExp
                AND id_dexpd = $IDX";
$ResUpAnswerId = mysql_query($QryUpAnswerId) or die("Query failed with error: " . mysql_error());   
} 
```

这里有一张图片： ![在此处输入图像描述](../Images/279566a10d95e7283ca17dc0adc7e4b6.png)

任何想法？

提前 THX

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T11:11:05.417

您无法获取未选中复选框的值。浏览器根本不会提交它们。有一些变通方法（例如使用`<input type="hidden">`和使用 JavaScript 更新它），但这些感觉非常 hacky，我不建议您使用它们。

最简单的方法是有两个查询。

一个会将所有值重置为 0，第二个会将选定的值更新为 1。

在您的示例中，在处理表单之前添加以下查询：

```
UPDATE detail_exp_devise SET detail_exp_devise.exp_val  = 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T11:09:22.213

我不知道这是否是最佳实践，但我为每个复选框发送我使用具有相同名称和值 0 的隐藏输入。这样，即使复选框为假，值 0 的隐藏输入也会发送到服务器。

在你的情况下：

```
// Here are the ckeckboxes:
echo"<td bgcolor=".$bgcolor." id='myGlob2' align='center'>
  <input type='hidden' name='check1' value='0' />
  <input type='checkbox' name='check1' value='$abfrageT[id_dexpd]' />
</td>"; 
```

# c - 为什么我的二维数组代码可以使用 malloc(0)？

> ID：13108271
> 
> 赞同：2
> 
> 时间：2012-10-28T11:03:32.283
> 
> 标签：c, arrays, malloc

我有一个奇怪的问题：我的代码正在运行。具体来说，这是有效的。为什么？

```
char **array = malloc(0);
array[0] = malloc(0);
strcpy(array[0],"hello");
array[1] = malloc(0);
strcpy(array[1],"world"); 
```

这到底是怎么回事？当我用 NULL 替换任何 malloc 或删除它们时，它不起作用，但 malloc 内部的值似乎并不重要，因为它不是负数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:05:11.033

取消引用无效指针是未定义的行为；所以任何事情都可能发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T11:05:25.760

`malloc(0)`是实现定义的，并返回空指针或无效指针。

您正在通过使用返回的指针调用未定义的行为`malloc(0)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T11:46:56.503

除了`malloc(0)`. 由于对齐原因，Malloc 实现通常对分配的块具有最小粒度。这意味着任何块的大小始终至少为 4、8、12、16 字节，具体取决于实现。如果我没记错的话，你甚至可以`mallopt`在某些平台上通过调用来设置这个值。

另一件事是，分配代码中的缓冲区溢出通常只会在您尝试释放指针时崩溃，因为只有这样您的块周围的内存才会用于库使用的内部簿记。这就是为什么缓冲区溢出如此难以捕捉的原因之一，它们出现在不同的位置和时间，然后是它们发生的时间。

# javascript - android phonegap应用程序退出后退按钮按下

> ID：13108272
> 
> 赞同：-1
> 
> 时间：2012-10-28T11:03:44.950
> 
> 标签：javascript, cordova

我在 android phonegap 中做一个应用程序。在应用程序中，我想在 iframe 中显示一个网站。我已经完成并且工作正常。但是当我从 iframe 页面单击返回按钮时，它退出应用程序，不会返回page.当我从 iframe 页面单击后退按钮时，它会显示以下警告并退出应用程序

1.id 0 没有键盘 2.使用默认键盘映射：/system/usr/keychars/qwerty.kcm.bin 3.KeyDown 已在视图上触发 4.onMessage(onPageStarted,file:///android_asset/www/index .html#)

谁能帮助我。提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:16:18.380

为什么不覆盖后退按钮行为：

```
document.addEventListener("backbutton", yourCallbackFunction, false); 
```

# macos - 使用 Firemonkey 2 (FMX2) 以跨平台方式设置鼠标位置

> ID：13108282
> 
> 赞同：6
> 
> 时间：2012-10-28T11:05:48.757
> 
> 标签：macos, delphi, firemonkey

在 Firemonkey 2 (FMX2) 中有接口

IFMXMouseService = 接口（IInterface）['{2370205F-CF27-4DF6-9B1F-5EBC27271D5A}']

该界面只有一个 GetMousePos 函数。但是如何以跨平台方式设置鼠标位置？有什么想法吗？

我想出的最好的主意是进行有条件的编译，直到 FMX 中存在这种可能性 - 但我不知道如何通过 Delphi 为 MACOSX 设置鼠标位置。如果有任何帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T14:55:21.927

这是您需要的程序。您必须将 macapi.coregraphics 和 macapi.cocoatypes 添加到您的 uses 子句中。

```
procedure setmousepos(x,y:single);

var aNSPoint:NSPoint;

begin
  aNSPoint.x:=x;
  aNSPoint.y:=y;
  CGWarpMouseCursorPosition(aNSPoint);
end; 
```

您当然可以通过 TPointF 代替 X,Y，但您仍然需要分别设置 NSPoint X 和 Y，因为 NSPoint 与 TPointF 不同。

问候

Dave Peters
DP 软件
www.dpsoftware.com/firemonkey

# c# - 如何修复 ProtoBuf-Net 中的枚举错误

> ID：13108287
> 
> 赞同：1
> 
> 时间：2012-10-28T11:06:34.673
> 
> 标签：c#, serialization, protobuf-net

尝试序列化时出现此错误。

![序列化错误信息](../Images/47c22d948e16dce4ebe95cc89ea3986d.png)

这个问题的答案：

[如何在 Protobuf.Net 中映射系统枚举](https://stackoverflow.com/questions/5204324/how-to-map-system-enums-in-protobuf-net)

表示这与`Flags`Enum 有关，应在 V2 中处理。这里报告的 Enum 不是`Flags`Enum：

```
public enum RunwayDesignator {
    NONE = 0,
    LEFT = 1,
    RIGHT = 2,
    CENTER = 3,
    WATER = 4,
    C = 5,
    L = 6,
    R = 7,
    W = 8,
    A = 9,
    B = 10,
    NOT_APP = 99
} 
```

我假设“16”指的是枚举中的某些东西，尽管没有 16 个值。我还检查了是否有任何 16 的 ProtoMember ID 与此枚举的 unsages 相关 - 没有。此枚举的所有被序列化的用法都是私有字段。

我将不胜感激有关如何处理此问题的一些指导。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:13:52.850

嗯 - 这很尴尬。问题是确实生成了 16 的值。所以看起来这是我的某种编程错误。错误消息说枚举中没有 16 的值，这是真的。

所以我现在可以回去尝试修复我的代码。Protobuf-Net 没有任何问题。

我想这可能对看到此错误的其他人有用。找出枚举值的使用位置，并查看代码是否发送了无效值。我不明白为什么在尝试为枚举设置无效索引时没有看到某种运行时错误。我现在需要调查一下。这是一个答案

[为什么将 int 转换为无效的枚举值不会引发异常？](https://stackoverflow.com/questions/6413804/why-does-casting-int-to-invalid-enum-value-not-throw-exception)

似乎没有为无效枚举值生成错误，但 protobuf-net 确实找到了它们

# node.js - 使用 maxDistance 对地理空间索引进行 MongoDB 查询从 node.js 客户端失败

> ID：13108288
> 
> 赞同：1
> 
> 时间：2012-10-28T11:06:40.600
> 
> 标签：node.js, mongodb, indexing, geospatial, mongoskin

我想查询 mongo-db 中的地理空间索引（在本教程[http://www.mongodb.org/display/DOCS/Geospatial+Indexing](http://www.mongodb.org/display/DOCS/Geospatial+Indexing)之后设计）。

因此，当我从 shell 执行此操作时，一切正常：

```
db.sellingpoints.find(( { location : { $near: [48.190120, 16.270895], $maxDistance: 7 / 111.2 } } ); 
```

但是来自我的nodejs应用程序的相同查询（使用mongoskin或mongoose）不会返回任何结果，直到我将距离值设置为一个非常高的数字（5690）

```
db.collection('sellingpoints')
 .find({ location: { $near: [lat,lng], $maxDistance: distance / 111.2} })
 .limit(limit)
 .toArray(callback); 
```

有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T16:58:43.740

所有 mongo 地理查询的格式应为 (long,lat) 而不是 (lat,long)。你可以试试那种格式。

PS：您需要确保以（long，lat）格式插入数据以及以（long，lat）格式进行查询

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T12:12:10.017

我只是针对一些地理本地化数据尝试了一个简单的节点猫鼬脚本。我正在使用来自[http://dev.maxmind.com/geoip/geolite](http://dev.maxmind.com/geoip/geolite)的城市地理数据，将其全部加载到 mongodb 中。我为此编写了一个小测试代码（https://github.com/nleite/mongoose_test）。

```
var mongoose = require('mongoose');
var db = mongoose.createConnection( 'localhost', 'geo');

var schema = mongoose.Schema( { city: 'string', loc: 'array', areaCode: 'string', country:      'string', region: 'string', locId: 'string', metroCode: 'string', postalCode: 'string'} );

var City = db.model( 'City', schema);
var distance = 7 / 111.2;
console.log( 'Distance %s', distance);
var query = City.find( { 'loc':  { $near: [48.190120, 16.270895], $maxDistance: distance      }} ); 
query.exec( function( err, city){
   if (err) return handleError(err);
   console.log( 'Found you %s' , city);
   process.exit(-1);
}); 
```

它似乎工作得很好。我什至接受了您的查询以检查它是否有任何问题，但似乎工作正常。

您能否提供有关架构和未按预期工作的查询的更多信息？

# jsf - Ormlite 与 JSF/Glassfish/Eclipse 一起使用

> ID：13108293
> 
> 赞同：0
> 
> 时间：2012-10-28T11:07:13.340
> 
> 标签：jsf, glassfish, noclassdeffounderror, ormlite

我正在尝试将 ormlite 用于我的 JSF 应用程序。

*   日食 3.7
*   奥姆莱特 4.42
*   JSF2.0 规范（在 eclipse、glassfish 中）

我添加了包含 ormlite jar 文件的库，即 core 和 jdbc。

我的模型类配置为；

```
@DatabaseTable(tableName = "account")
public class Account {

@DatabaseField(id = true)
private String name;
@DatabaseField
private String password;

public Account() {
}
{...getters and setters...} 
```

我的问题是；

1.  模型类应该是 POJO - 可以将它与 ormlite 的注释一起使用吗？

2.  虽然在 Eclipse 中成功添加了库，但是当我尝试运行时 - 它会生成如下错误 - web.xml 或 faces-config.xml 中是否需要一些额外的配置？由于 ormlite 只需将库 jar 文件添加到类路径即可完美地在 jsp/servlet 应用程序中工作。

`javax.faces.FacesException: #{register.submit}: java.lang.NoClassDefFoundError: com/j256/ormlite/support/ConnectionSource`

# ruby-on-rails-3.1 - 安装调试器-linecache 时出错：错误：无法构建 gem 原生扩展

> ID：13108299
> 
> 赞同：17
> 
> 时间：2012-10-28T11:08:04.403
> 
> 标签：ruby-on-rails-3.1, ruby-1.9.2

我正在尝试捆绑安装，但它显示上述错误或调试器..请从终端查找详细错误

```
Installing debugger-linecache (1.1.1) with native extensions
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

        /usr/local/ruby/bin/ruby extconf.rb
checking for vm_core.h... no
checking for vm_core.h... no
Makefile creation failed
************************************************************************** 
No source for ruby-1.9.2-p0 provided with debugger-ruby_core_source gem.
**************************************************************************
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
        --with-opt-dir
        --without-opt-dir
        --with-opt-include
        --without-opt-include=${opt-dir}/include
        --with-opt-lib
        --without-opt-lib=${opt-dir}/lib
        --with-make-prog
        --without-make-prog
        --srcdir=.
        --curdir
        --ruby=/usr/local/ruby/bin/ruby
        --with-ruby-dir
        --without-ruby-dir
        --with-ruby-include
        --without-ruby-include=${ruby-dir}/include
        --with-ruby-lib
        --without-ruby-lib=${ruby-dir}/lib

Gem files will remain installed in /usr/local/ruby/lib/ruby/gems/1.9.1/gems/debugger-linecache-1.1.1 for inspection.
Results logged to /usr/local/ruby/lib/ruby/gems/1.9.1/gems/debugger-linecache-1.1.1/ext/trace_nums/gem_make.out 

An error occured while installing debugger-linecache (1.1.1), and Bundler cannot continue.
Make sure that `gem install debugger-linecache -v '1.1.1'` succeeds before bundling. 
```

如果我在终端输入 ruby​​-v 我得到 `ruby 1.9.2p0 (2010-08-18 revision 29036) [x86_64-linux]`

如果我这样做，`gem install debugger-linecache`我仍然会遇到同样的错误。如何解决这个问题。请帮忙？？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-11-06T09:13:31.857

我有一个非常相似的错误，但在 ruby​​ 1.9.3 上。跑步：

```
gem install debugger-linecache -v '1.1.2' -- --with-ruby-include=$rvm_path/src/ruby-1.9.3-p286/ 
```

让它为我工作。归功于[这个答案](https://stackoverflow.com/a/12913418/641293)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-06-25T09:38:05.523

我用简单的方法解决了类似的问题（将 Ruby 1.9.3 升级到 2.0）

```
bundle update debugger 
```

结果安装了gem 1.6.0版

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-05T15:49:15.983

相同的修复，更新一点

```
# check ruby version with rvm info
gem install debugger-linecache -v '1.1.2' \
-- --with-ruby-include=$rvm_path/src/ruby-1.9.3-p448 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-11T06:52:00.780

如果重要的话，在 Ubuntu 13.04 上。

我不得不： gem install debugger-ruby_core_source -v 1.1.2

然后： gem 安装调试器

然后我的捆绑包完成得很好。

感谢对[这个问题的评论](https://github.com/cldwalker/debugger/issues/12#issuecomment-5432823)。

# c# - Facebook 好友检索

> ID：13108306
> 
> 赞同：0
> 
> 时间：2012-10-28T11:09:01.563
> 
> 标签：c#, .net, facebook, facebook-graph-api

回到 facebook c# sdk 并总是在这里和那里发现一些变化。关于正确访问访问令牌的问题，现在我想为用户计算朋友的数量。

这是我现有的代码。

```
string accessToken = ViewState["accessToken"].ToString();
Facebook.FacebookClient fb = new FacebookClient(accessToken);
var me = fb.Get("/me/friends"); 
```

现在我给了我json格式的朋友列表，其中有两个键，一个是“数据”，另一个是“分页”。

我如何着手获得所有朋友和至少数个朋友？

感谢您的投入

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:20:37.173

我使用了 FB 的[Graph API Explorer](https://developers.facebook.com/tools/explorer)，您可以在此查询中添加额外的 url 参数，即“limit=number”和“offset=number”。似乎当您不指定这些时，FB 将返回 MAX 允许的朋友数（[5000](http://uk.answers.yahoo.com/question/index?qid=20100812070229AAURKPY)）。它仍然会给你“分页”键，但是当你点击链接时，第二页上没有朋友。

你可以做：

```
var me = fb.Get("/me/friends?limit=5000&offset=0"); 
```

以确保将来不会将默认限制更改为某个较小的值。

所以你的问题的答案是：
使用上面的查询，不用担心分页，解析从 FB 返回的 JSON 并计算“数据”数组中的对象数量。更具防御性的是，您还可以向该 URL 发出请求`paging.next`并按照该 URL 检查下一页上是否还有其他朋友（这不应该发生，因为有 5000 个限制）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T11:46:49.407

谢天谢地，我自己解决了这个问题。这就是方法。希望它可以节省很多人从这个链接中得到它

[Facebook 动态对象](http://blog.ntotten.com/2010/09/07/dynamic-objects-and-the-facebook-c-sdk/)

这是我的代码，我想这对喜欢/评论等也有好处。

```
 dynamic friends = fb.Get("/me/friends?limit=5000&offset=0");

            Dictionary<string, string> resultList = new Dictionary<string, string>();

            foreach (var item in friends.data)
            {
                var newdata=item;
                string item1 = newdata[0].ToString();
                string item2 = newdata[1].ToString();

                if (resultList.ContainsKey(item1))
                {
                    item1 = item1 + "duplicate";  
                }

                resultList.Add(item1,item2);
            } 
```

containsKey 是为了避免抛出异常，因为某些书呆子具有相同名称的配置文件..

最后一件事是它仍然给我返回的数量比我实际的朋友列表少，不知道为什么.. :(

# javascript - Fabric.js 鼠标右键

> ID：13108310
> 
> 赞同：6
> 
> 时间：2012-10-28T11:09:30.737
> 
> 标签：javascript, canvas, fabricjs

有没有办法在 Fabric.js 画布上接收右键单击鼠标事件？

以下代码仅适用于左键单击：

```
canvas.observe('mouse:down', function(){console.log('mouse down')); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2019-04-10T13:42:43.197

**注意：** *上面的大多数答案都已过时；此答案适用于最新的 Fabric 版本 2.7.0*

* * *

## 只需为您的 Fabric 画布启用触发右键/中键单击事​​件

在画布中触发右键单击和中键单击事​​件的配置可以在[此处`fireRightClick`](https://github.com/fabricjs/fabric.js/blob/master/src/canvas.class.js#L327)[找到`fireMiddleClick`](https://github.com/fabricjs/fabric.js/blob/master/src/canvas.class.js#L335)，并且默认设置为`false`。这意味着默认情况下禁用右键和中键单击事​​件。右键单击时停止上下文菜单显示在画布上的参数`stopContextMenu`可以在[这里找到](https://github.com/fabricjs/fabric.js/blob/master/src/canvas.class.js#L319)

您可以通过在创建画布时设置值来启用这些：

```
var canvas = new fabric.Canvas('canvas', {
  height: height,
  width: width,
  fireRightClick: true,  // <-- enable firing of right click events
  fireMiddleClick: true, // <-- enable firing of middle click events
  stopContextMenu: true, // <--  prevent context menu from showing
}); 
```

现在您的`mousedown`事件将为所有点击触发，您可以使用事件上的按钮标识符来区分它们：

## 对于画布：

```
canvas.on('mouse:down', (event) => {
    if(event.button === 1) {
        console.log("left click");
    }
    if(event.button === 2) {
        console.log("middle click");
    }
    if(event.button === 3) {
        console.log("right click");
    }
} 
```

## 对于对象：

```
object.on('mousedown', (event) => {
    if(event.button === 1) {
        console.log("left click");
    }
    if(event.button === 2) {
        console.log("middle click");
    }
    if(event.button === 3) {
        console.log("right click");
    }
} 
```

* * *

单击对象时，您可以通过 event.e 到达“真正的”鼠标 dom 事件：

```
if(event.button === 3){
  console.log(event.e);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-03T05:09:13.727

我通过扩展 fabric.Canvas 类实现了右键单击。看看[这里](https://github.com/mazong1123/fabric.ext/blob/master/fabricext/scripts/fabric.canvasex.js#L63)的`_onMouseDown`方法。

基本上，默认情况下，fabricjs 中禁用了对象的鼠标右键事件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-03-08T09:51:59.083

如果要处理右键单击（在画布或其对象上），则在上部画布元素上设置上下文菜单侦听器。使用 canvas 方法 findTarget 您可以检查是否单击了任何目标，如果是，您可以检查目标的类型。

```
let scope = this;
jQuery(".upper-canvas").on('contextmenu', function (options: any) {
    let target: any = scope.canvas.findTarget(options, false);
    if (target) {
        let type: string = target.type;
        if (type === "group") {
            console.log('right click on group');
        } else {
            scope.canvas.setActiveObject(target);
            console.log('right click on target, type: ' + type);
        }
    } else {
        scope.canvas.discardActiveObject();
        scope.canvas.discardActiveGroup();
        scope.canvas.renderAll();
        console.log('right click on canvas');
    }
    options.preventDefault();
}); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-04T04:52:08.090

The way I did this was to listen for a right click event across the entire canvas and match up the x,y coordinates of the click event to the object which is currently sitting at the given location. This solution feels a little like a hack but hey, it works!

```
$('#my_canvas').bind('contextmenu', function (env) {
    var x = env.offsetX;
    var y = env.offsetY;
    $.each (canvas._objects, function(i, e) {
        // e.left and e.top are the middle of the object use some "math" to find the outer edges
        var d = e.width / 2;
        var h = e.height / 2;
        if (x >= (e.left - d) && x <= (e.left+d)) {
            if(y >= (e.top - h) && y <= (e.top+h)) {
                console.log("clicked canvas obj #"+i);
                //TODO show custom menu at x, y
                return false; //in case the icons are stacked only take action on one.
            }
        }
    });
    return false; //stops the event propigation
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-01-06T21:22:06.230

这是我所做的，它使用了一些内置的织物对象检测代码：

```
$('.upper-canvas').bind('contextmenu', function (e) {
    var objectFound = false;
    var clickPoint = new fabric.Point(e.offsetX, e.offsetY);

    e.preventDefault();

    canvas.forEachObject(function (obj) {
        if (!objectFound && obj.containsPoint(clickPoint)) {
            objectFound = true;
            //TODO: whatever you want with the object
        }
    });
}); 
```

# java - tomcat 不可访问/manager 可访问

> ID：13108312
> 
> 赞同：0
> 
> 时间：2012-10-28T11:09:54.803
> 
> 标签：java, tomcat, maven, deployment, tomcat7

我在 OS X 上运行一个 tomcat 服务器。Tomcat 使用以下命令启动：

```
sh catalina.sh start 
```

当我去 localhost:8080 什么都没有显示（只是一个空白页面）但是当我去 localhost:8080/manager 我可以登录并且我可以看到经理页面。

此外，当我尝试通过 maven 部署我的应用程序时，我收到以下错误：

```
[ERROR] Failed to execute goal org.codehaus.mojo:tomcat-maven-plugin:1.1:deploy (default-cli) on project docFlow-core: Cannot invoke Tomcat manager: http://localhost:8080/manager/text/deploy?path=%2Fcore&war= -> [Help 1] 
```

我正在运行一个 Tomcat 7 实例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T11:24:06.500

据我所知，管理器应用程序不再与您的默认 tomcat 安装捆绑在一起，可能是出于安全原因。但是，您可以按照 tomcat 网站上的说明自行下载并安装它。

# facebook - Facebook installa facebook app 将我重定向到 url 但在 Facebook 之外

> ID：13108313
> 
> 赞同：0
> 
> 时间：2012-10-28T11:10:13.903
> 
> 标签：facebook

我有以下问题：

我正在尝试为 Facebook 做我的第一个应用程序，在 Facebook 连接后安装应用程序不会自动将我重定向到 url，而是在 Facebook 之外。这只发生在第一次安装后，如果 URL 已充值并保留在 Facebook 中。

有什么想法可以解决吗？

我不知道问题是代码还是应用程序配置:(

```
// PHP SDK v.3.0.0 de Facebook    
require 'includes/facebook.php';

$facebook = new Facebook(array(
  'appId'  => '*******',
  'secret' => '*************',
));
$user = $facebook->getUser();
if ($user) {
  try {
    $user_profile = $facebook->api('/me');
    $me =  $facebook->api('/me');

  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }
}
if ($user) {
  $logoutUrl = $facebook->getLogoutUrl();
} else {
  $loginUrl = $facebook->getLoginUrl(array(
                'scope' => 'read_stream,publish_stream,user_about_me,user_likes,email,user_status'
            ));
}
 if (!$user) {
        echo "<script type='text/javascript'>top.location.href = '$loginUrl';</script>";
        exit;
    } 
?>
<!doctype html>
<html xmlns:fb="http://www.facebook.com/2008/fbml">
  <head>
    <title>php-sdk 3.0.0</title>
        <style typ="text/css">
            html, body { width: 520px;}
        </style>    
  </head>
  <body>
    <h1>php-sdk</h1>
    <h3>PHP Session</h3>
      <?php foreach($_SESSION as $key=>$value){
          echo '<strong>' . $key . '</strong> => ' . $value . '<br />';
      }
      ?>
      <h3>Tu</h3>
      <img src="https://graph.facebook.com/<?php echo $user; ?>/picture">
      <h3>Tus datos (/me)</h3>
      <?php foreach($user_profile as $key=>$value){
          echo '<strong>' . $key . '</strong> => ' . $value . '<br />';
      }
      ?>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T11:29:13.863

您没有`redirect_uri`在`getLoginUrl`方法中指定 a ，因此 SDK 为您构建了一个基于您当前 URL 的方法。

因此，您只需将画布 URL 设置为`redirect_uri`：

```
$loginUrl = $facebook->getLoginUrl(array(
    'scope' => 'read_stream,publish_stream,user_about_me,user_likes,email,user_status',
    'redirect_uri' => 'CANVAS_URL'
)); 
```

PS：`$user_profile`并`$me`持有相同的值，只需使用其中一个而不是进行两次 Graph API 调用。

# php - Mysql：警告：mysql_fetch_array() 期望参数 1 是资源

> ID：13108322
> 
> 赞同：-3
> 
> 时间：2012-10-28T11:11:57.553
> 
> 标签：php, mysql

我之前在 mysql 中创建了一个数据库，现在我试图在一个表中列出它的所有值，但是我`Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean`在线收到以下错误：`while ($row=mysql_fetch_array($result))`

这是我的代码：

```
$con=mysql_connect("localhost","root","");
if (!$con) {
    die("Error: " . mysql_error);
}

mysql_select_db("my_db",$con);

$result = mysql_query("SELECT * FROM Users");

echo "<table border='1'>
<tr>
<th>Username</th>
<th>First Name</th>
<th>Last Name</th>
<th>Age</th>
<th>Email adress</th>
</tr>";

while($row=mysql_fetch_array($result)) {
    echo "<tr>";
    echo "<td>" . $row['username'] . "</td>";
    echo "<td>" . $row['firstname'] . "</td>";
    echo "<td>" . $row['lastname'] . "</td>";
    echo "<td>" . $row['age'] . "</td>";
    echo "<td>" . $row['emailadress'] . "</td>";
    echo"</tr>";
}
echo "</table>";

mysql_close($con); 
```

我读了其他类似的问题，但没有得到答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:15:30.983

您的代码不会评估 MySQL 关于选择数据库或运行查询的响应。该错误表明您的查询没有成功（因此 mysql_query 返回 FALSE）——这意味着上述一项或两项都不起作用。

选择数据库并使用 die(mysql_error()); 时测试错误 看看为什么这些电话会失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T17:59:21.387

确保这一行实际上是从表中获取行： $result = mysql_query("SELECT * FROM Users");

尝试在该查询中进行错误检查：

```
$result = mysql_query("SELECT * FROM Users") or die(mysql_error()); 
```

可能你的表被称为“用户”而不是“用户”（注意大写），所以相应地改变。

问候， 里奇

# java - Java 接口方法 - 参数和返回值类型作为 Number 的子项

> ID：13108327
> 
> 赞同：1
> 
> 时间：2012-10-28T11:13:06.317
> 
> 标签：java, oop, interface

我对Java不是很熟练，所以我认为我的问题是基本的。我正在为 ArrayResult 之类的东西编写一个接口。会有方法add和get。

问题是 ArrayResult 可以获取 Integer 或 Double 的值。所以我需要更一般地在接口中定义方法。我发现get方法可以有这样的东西：

```
public <N extends Number> N get(Integer index); 
```

那是对的吗？我相信这意味着 get 方法可以返回任何扩展数字对象的东西。add 方法使用什么语法？

```
public void add(Number value); 
```

这不是我想要的，因为 add(Integer value) 不会覆盖接口方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T11:16:32.197

我猜你想要的是

```
interface ArrayResult<N extends Number> {
    public N get(Integer index);

    public void add(N value);
} 
```

然后您可以编写两个单独的特定实现者

```
class IntegerResult implements ArrayResult<Integer> {
    @Override
    public void add(Integer value) {
    }

    @Override
    public Integer get(Integer index) {
        return null;
    }
}

class DoubleResult implements ArrayResult<Double> {
    @Override
    public void add(Integer value) {
    }

    @Override
    public Double get(Double index) {
        return null;
    }
} 
```

参考：

*   [有界类型参数](http://docs.oracle.com/javase/tutorial/java/generics/bounded.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T11:18:42.570

```
interface ArrayResult<N extends Number> {
    public N get(Integer index);

    public void add(N value);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T11:30:30.920

刚回来`Number`。

```
Number get(Integer index); 
```

这也将允许您返回任何`Number`后代，例如`Integer`and `Double`。在 Java 中，父类型可以容纳任何后代类型。

`int`在 getter 参数中也使用整数类型。

```
Number get(int index) 
```

`Vector<Number>`您还可以使用具有所需功能的预定义类。

```
public Vector<Number> myfunction() {

     Vector<Number> ans = new Vector<Number>();
     ans.add(new Integer(1));
     ans.add(new Double(3.14));

     return ans;

} 
```

# php - mysql_query() 期望参数 2 是资源，布尔值

> ID：13108331
> 
> 赞同：-3
> 
> 时间：2012-10-28T11:13:48.070
> 
> 标签：php, mysql

我正在尝试从数据库中获取数据，但遇到此错误。查询中没有错误，因为它在 mysql 中完美运行。

为什么我会收到此错误？

```
[client 127.0.0.1] PHP Warning:  mysql_query() expects parameter 2 to be resource, boolean given in /var/www/imdb.php on line 35

[client 127.0.0.1] PHP Warning:  mysql_error() expects parameter 1 to be resource, boolean given in /var/www/imdb.php on line 35 
```

php代码：

```
 function getdirector($director)
    {
    global $db;
    $query = 'select name from peopledb where peopleid = '.$director;
    $result = mysql_query($query,$db) or die(mysql_error($db));
    $row = mysql_fetch_assoc($result);
    extract($row);
    return $name;
    }

    function getactor($actor)
    {
    $query = 'select name from peopledb where peopleid = '.$actor;
    $result = mysql_query($query,$db) or die(mysql_error($db));
    $row = mysql_fetch_assoc($result);
    extract($row);
    return $name;
    }

    function getmovietype($type)
    {
    $query = 'select movietype from movietype where movieid = '.$type;
    $result = mysql_query($query,$db) or die(mysql_error($db));
    $row = mysql_fetch_assoc($result);
    extract($row);
    return $movietype;
    }

    $db = mysql_connect('localhost','root','saw123') or die("Connection error");
    $db = mysql_select_db("moviesite",$db) or die(myql_error($db));
    $query = 'select moviename,releaseyear,director,actor,type from movie';
    $result = mysql_query($query,$db) or die(mysql_error($db));

    $table = <<<ENDHTML
    <div style="text-align: center;" >
    <h2>The Ultimate movie database</h2>
    <table border='1' cellpadding='1' cellspacing='2'
           style="width: 70%; margin-left: auto; margin-right: auto;">

    <tr>
    <th>Movie title</th>
    <th>year of release </th>
    <th>Movie director</th>
    <th>Movie Actor</th>
    <th>Movie type</th>
    </tr>
    ENDHTML;

    while ($row = mysql_fetch_assoc($result))
    {
    extract($row);
    $director1 = getdirector($director);
    $actor1 = getactor($actor);
    $movietype1 = getmovietype($type);

    $table .= <<<ENDHTML
    <tr>
    <td>$moviename</td>
    <td>$releaseyear</td>
    <td>$director1</td>
    <td>$actor1</td>
    <td>$movietype1</td>
    </tr>
    ENDHTML;
    }
    $table .=<<<ENDHTML
    </table>
    </div>
    ENDHTML;

    echo $table;

    ?> 
```

***更新 ::: 无论我在哪里使用 mysql_error() 函数，它都会显示错误。现在删除所有“$db”参数后，它就可以工作了。为什么 ？***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:15:06.167

只需这样称呼它：

```
$result = mysql_query($query); 
```

如果您查看 mysql_connect 函数，它会在失败时返回 false（布尔值）：

[http://php.net/manual/en/function.mysql-connect.php](http://php.net/manual/en/function.mysql-connect.php)

因此，您的连接可能甚至还没有建立。

编辑：看看这个函数： http: [//php.net/manual/en/function.mysql-select-db.php](http://php.net/manual/en/function.mysql-select-db.php)

你在打电话：

```
$db = mysql_connect('localhost','root','saw123') or die("Connection error");
    $db = mysql_select_db("moviesite",$db) or die(myql_error($db)); 
```

第二行将 $db 设置为 true 或 false - 因为 mysql_select_db 只返回一个布尔值。

编辑2：您可能的意思是：

```
$db = mysql_connect('localhost','root','saw123') or die("Connection error");
mysql_select_db("moviesite",$db) or die(myql_error($db)); 
```

在这种情况下，$db 不会被恰当地命名；它会更准确地称为 $connection 或 $db_connection 或类似的东西。

# ruby-on-rails - 如何在 Ruby 中最小化条件和返回值之间的重复？

> ID：13108332
> 
> 赞同：0
> 
> 时间：2012-10-28T11:13:54.900
> 
> 标签：ruby-on-rails, ruby

我想知道是否有办法以更优雅的方式编写此代码：

```
def default_price
  if project.hourly_rate.present?
    project.hourly_rate
  elsif project.person.hourly_rate.present?
    project.person.hourly_rate    
  elsif project.person.organisation.hourly_rate.present?
    project.person.organisation.hourly_rate
  else
    user.preference.hourly_rate
  end
end 
```

在条件和返回值之间有很多重复。有没有更好的编码方法？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T11:17:00.687

```
def default_price
    project.hourly_rate || project.person.hourly_rate || project.person.organisation.hourly_rate || user.preference.hourly_rate
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T16:10:22.477

```
def default_price
  [
    project.hourly_rate,
    project.person.hourly_rate,
    project.person.organisation.hourly_rate,
  ]
  .find(&:present?) ||
  user.preference.hourly_rate
end 
```

或者，进行更多重构：

```
def default_price
  [
    project,
    project.person,
    project.person.organisation,
  ]
  .find{|x| x.hourly_rate.present?}.hourly_rate ||
  user.preference.hourly_rate
end 
```

此外，如果`user.preference.hourly_rate`是 always `present?`，那么您可以进一步重构：

```
def default_price
  [
    project,
    project.person,
    project.person.organisation,
    user.preference,
  ]
  .find{|x| x.hourly_rate.present?}.hourly_rate
end 
```

# c# - 功能 类内范围

> ID：13108335
> 
> 赞同：0
> 
> 时间：2012-10-28T11:14:12.063
> 
> 标签：c#, delegates

为什么我不能这样做？

```
public int FillModel(int id)
{
   // do something...
   return 0;
}

public Func<int, int> actiontest = FilleModel; 
```

代码无法编译并告诉我没有参考？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:19:59.310

正如*LB*在他的评论中所说，你应该改变：

```
public Func<int, int> actiontest = FilleModel;  //FilleModel doesn't exist 
```

和：

```
Func<int, int> actiontest = FillModel; 
```

否则，如果您想公开：

```
public Func<int, int> actiontest;

public myClass(){
   actiontest = FillModel;
} 
```

或者：

```
public Func<int, int> actiontest = FillModel;

private static int FillModel(int id) //private else the delegate doesn't make sense
{
   // do something...
   return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T11:26:01.430

一件重要的事情，除了改变：

```
public Func<int, int> actiontest = FilleModel; 
```

到

```
Func<int, int> actiontest = FillModel; 
```

您不能在*Class 级别进行**直接声明*。您只能在某些行为或setter/getter 中使用此类声明。*`Method``Property`*

# android - 如何仅从一个特定号码接收短信（其他短信转到手机的收件箱）

> ID：13108337
> 
> 赞同：0
> 
> 时间：2012-10-28T11:14:28.000
> 
> 标签：android, android-intent, sms, broadcastreceiver

我的程序可以成功发送和接收短信。现在我想在我的程序中只接收来自特定电话号码的短信，而来自所有其他号码的短信都会进入手机的收件箱。我使用的代码如下。它不起作用，每条短信都会进入手机的收件箱。我认为`msg_from`在`SmsReceiver`方法中，无法在`for`循环中获得价值，并且始终是`null`.

主要活动.java

```
 public class MainActivity extends Activity {
             private TextView showSms;
                private String   ReceivedSms;
            @Override
            public void onCreate(Bundle savedInstanceState) {
                super.onCreate(savedInstanceState);
                setContentView(R.layout.activity_main);
                super.onCreate(savedInstanceState);
                // _smsReceiver.onReceive(getBaseContext(), getIntent());
                setContentView(R.layout.activity_main);
                Intent _intent = getIntent();
                ReceivedSms = _intent.getStringExtra("message");
                showSms = (TextView) this.findViewById(R.id.txt_Show);
                showSms.setText(ReceivedSms);
            }

            @Override
            public boolean onCreateOptionsMenu(Menu menu) {
                getMenuInflater().inflate(R.menu.activity_main, menu);
                return true;
            }
        } 
```

短信接收器.java

```
public class SmsReceiver extends BroadcastReceiver {
    public String str = "";

    @Override
    public void onReceive(Context context, Intent intent) {
        // ---get the SMS message passed in---

        Bundle bundle = intent.getExtras();
        Object messages[] = (Object[]) bundle.get("pdus");
        SmsMessage[] msgs = null;

        if (bundle != null)
        {

            Object[] pdus = (Object[]) bundle.get("pdus");
            SmsMessage smsMessage[] = new SmsMessage[messages.length]; 
           //msgs = new SmsMessage[pdus.length];
            String msg_from[]=null;
            for (int n = 0; n < messages.length; n++) 
            {
                smsMessage[n] = SmsMessage.createFromPdu((byte[]) messages[n]); 
                  msg_from[n] = msgs[n].getOriginatingAddress();
            }

            if(msg_from .equals("+9856874236"))  
            {
            for (int n = 0; n < messages.length; n++) 
            {

                smsMessage[n] = SmsMessage.createFromPdu((byte[]) pdus[n]); 
                str += "SMS from " + msgs[n].getOriginatingAddress();
                str += " :";
                str += msgs[n].getMessageBody().toString();

                str += "\n";

           abortBroadcast();

           }
           Intent act = new Intent(context, MainActivity.class);
            act.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            act.putExtra("message", str);
            context.startActivity(act);
        }

        }

    }
} 
```

清单.xml

```
<uses-permission android:name="android.permission.SEND_SMS">
    </uses-permission>
    <uses-permission android:name="android.permission.RECEIVE_SMS">
    </uses-permission>

<uses-permission android:name="android.permission.READ_SMS" />
    <application android:icon="@drawable/ic_launcher" android:label="@string/app_name">
        <activity android:name=".SMS"
                  android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity android:name=".MainActivity"
                  android:label="@string/app_name"/>
       <receiver
            android:name="com.example.sms.SmsReceiver"
            class="com.example.sms.SmsReceiver" >
            <intent-filter android:priority="100" >
                <action android:name="android.provider.Telephony.SMS_RECEIVED" />
            </intent-filter>
        </receiver>  
    </application> 
```

短信.java

```
public class SMS extends Activity {

     Button btnSendSMS;
        EditText txtPhoneNo;
        EditText txtMessage;

        /** Called when the activity is first created. */
        @Override
        public void onCreate(Bundle savedInstanceState) 
        {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);        

            btnSendSMS = (Button) findViewById(R.id.btnSendSMS);
            txtPhoneNo = (EditText) findViewById(R.id.txtPhoneNo);
            txtMessage = (EditText) findViewById(R.id.txtMessage);

            btnSendSMS.setOnClickListener(new View.OnClickListener() 
            {
                public void onClick(View v) 
                {                
                    String phoneNo = txtPhoneNo.getText().toString();
                    String message = txtMessage.getText().toString();                 
                    if (phoneNo.length()>0 && message.length()>0)                
                        sendSMS(phoneNo, message);                
                    else
                        Toast.makeText(getBaseContext(), 
                            "Please enter both phone number and message.", 
                            Toast.LENGTH_SHORT).show();
                }
            });        
        } 
        private void sendSMS(String phoneNumber, String message)
        {        
            String SENT = "SMS_SENT";
            String DELIVERED = "SMS_DELIVERED";

            PendingIntent sentPI = PendingIntent.getBroadcast(this, 0,
                new Intent(SENT), 0);

            PendingIntent deliveredPI = PendingIntent.getBroadcast(this, 0,
                new Intent(DELIVERED), 0);

            //---when the SMS has been sent---
            registerReceiver(new BroadcastReceiver(){
                @Override
                public void onReceive(Context arg0, Intent arg1) {
                    switch (getResultCode())
                    {
                        case Activity.RESULT_OK:
                            Toast.makeText(getBaseContext(), "SMS sent", 
                                    Toast.LENGTH_SHORT).show();
                            break;
                        case SmsManager.RESULT_ERROR_GENERIC_FAILURE:
                            Toast.makeText(getBaseContext(), "Generic failure", 
                                    Toast.LENGTH_SHORT).show();
                            break;
                        case SmsManager.RESULT_ERROR_NO_SERVICE:
                            Toast.makeText(getBaseContext(), "No service", 
                                    Toast.LENGTH_SHORT).show();
                            break;
                        case SmsManager.RESULT_ERROR_NULL_PDU:
                            Toast.makeText(getBaseContext(), "Null PDU", 
                                    Toast.LENGTH_SHORT).show();
                            break;
                        case SmsManager.RESULT_ERROR_RADIO_OFF:
                            Toast.makeText(getBaseContext(), "Radio off", 
                                    Toast.LENGTH_SHORT).show();
                            break;
                    }
                }
            }, new IntentFilter(SENT));

            //---when the SMS has been delivered---
            registerReceiver(new BroadcastReceiver(){
                @Override
                public void onReceive(Context arg0, Intent arg1) {
                    switch (getResultCode())
                    {
                        case Activity.RESULT_OK:
                            Toast.makeText(getBaseContext(), "SMS delivered", 
                                    Toast.LENGTH_SHORT).show();
                            break;
                        case Activity.RESULT_CANCELED:
                            Toast.makeText(getBaseContext(), "SMS not delivered", 
                                    Toast.LENGTH_SHORT).show();
                            break;                        
                    }
                }
            }, new IntentFilter(DELIVERED));        

            SmsManager sms = SmsManager.getDefault();
            sms.sendTextMessage(phoneNumber, null, message, sentPI, deliveredPI);        
        }

} 
```

主.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical" >

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="Enter the phone number of recipient" />

        <EditText
            android:id="@+id/txtPhoneNo"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="Message" />

        <EditText
            android:id="@+id/txtMessage"
            android:layout_width="fill_parent"
            android:layout_height="150px"
            android:gravity="top" />

        <Button
            android:id="@+id/btnSendSMS"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="Send SMS" />

        <TextView
            android:id="@+id/txt_Show"
            android:layout_width="119dp"
            android:layout_height="wrap_content"
            android:layout_weight="0.11"
            android:text="@string/soha" />
    </LinearLayout>

</RelativeLayout> 
```

# joomla - 如何在没有 2%e %23...等的情况下获取 URL

> ID：13108338
> 
> 赞同：0
> 
> 时间：2012-10-28T11:14:37.970
> 
> 标签：joomla

我为搜索结果创建了一个表单：

```
<form id="searchForm" action="<?php echo JRoute::_('index.php?option=com_new');?>" method="get">

<fieldset class="word">
    <label for="search-searchword">
        <?php echo Word; ?>
    </label>
    <input type="text" name="<?php echo JRoute::_('index.php?option=com_new');?>searchword" id="search-searchword" size="30" value="<?php echo $this->escape($this->origkeyword); ?>" class="inputbox" />

    <button name="Search" onclick="this.form.submit()" class="button"><?php echo Submit;?></button>
    <input type="hidden" name="task" value="search" />

</fieldset> 
```

我得到的网址是：

```
/index.php?%2Fsearch%2Findex.php%3Foption%3Dcom_newsearchword=&Search=&task=search 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:27:33.347

一个 URL 由几个部分组成，如子域、域、路径、url 参数。对于所有这些部分，您都有一定的规则。一条规则说：URL 参数中可能没有某些字符。尤其不是用于描述参数本身的字符，例如：

*   ? 用于标记 url 参数部分的开始
*   & 用于标记任何附加 url 参数的开始
*   = 用于标记 url 参数值的开始。

所以这些字符必须被编码。这就是你所看到的。如果您需要获取第一个（未命名的）url 参数，然后对其进行解码。

这可能会有所帮助： http: [//php.net/manual/en/function.urldecode.php](http://php.net/manual/en/function.urldecode.php)

# java - 如何调用帮助方法

> ID：13108339
> 
> 赞同：0
> 
> 时间：2012-10-28T11:14:39.267
> 
> 标签：java, graphics, panel

我有一个家庭作业，要求我们为一个小图形程序编写一个辅助方法。我遇到的问题是它一直说我有错误。

> 找不到符号 - 方法 drawPolygon(gp, int, int)。

我错过了什么？

PS。我知道 GraphicsPanel 代码不在这里，但更想知道为什么我会收到“找不到符号”错误。当我*只*写drawPolygon(gp, 50, 4) 时，它会编译没有任何错误，但它也不会在面板中绘制任何东西。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
public class G5 {
    public static void drawPolygon(GraphicsPanel gp, int sideCount, int sideLength) {
        for (int i = 0; i < 4; i++) {
            gp.draw(sideLength);
            gp.turn(360 / sideCount);
        }
    }

    public static void main(String[] args) {
        GraphicsPanel gp = new GraphicsPanel();
        gp.setBackgroundColor(Color.BLACK);
        gp.delay(1000);
        int x = gp.getWidth() / 2;
        int y = gp.getHeight() / 2;
        gp.setLocation(x, y);

        gp.setColor(Color.RED);
        gp.drawPolygon(gp, 50, 4);

        gp.clear();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T11:16:45.480

该方法是 G5 类的静态方法。它不是 GraphicsPanel 的实例方法。所以你必须使用它来调用它

```
G5.drawPolygon(gp, 50, 4); 
```

代替

```
gp.drawPolygon(gp, 50, 4); 
```

为了能够像您正在做的那样调用它，该方法必须在 GraphicsPanel 类（或其任何超类）中定义，不带 static 关键字。

阅读[Java 教程的这一部分](http://docs.oracle.com/javase/tutorial/java/javaOO/classvars.html)以了解实例方法和静态方法之间的区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T11:17:51.970

```
 gp.drawPolygon(gp, 50, 4); 
```

您正在寻找`GraphicsPanel`实例中的方法，而不是在您的类中。因为它是一个静态方法，所以使用

```
G5.drawPolygon(gp, 50, 4); 
```

反而

# iphone - 如何使用 Windows 从 iPad 读取崩溃报告

> ID：13108344
> 
> 赞同：1
> 
> 时间：2012-10-28T11:15:32.657
> 
> 标签：iphone, ios, ipad, marmalade

我是使用 Marmalade 和 Visual Studio 为 ios 开发的新手，所以我需要知道如何从 iPad 读取崩溃报告？崩溃报告位于 **/var/mobile/Library/Logs/CrashReporter/game.plist** 如何从 Windows 读取此文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T13:03:27.173

当您将 iPad 与 iTunes 同步时，崩溃报告将被复制到您的计算机上。然后，您可以在以下位置找到它：

*C:\Users\<您的用户名>\AppData\Roaming\Apple Computer\Logs\CrashReporter\MobileDevice\<您的 iPad 的名称>\<崩溃日志名称>.crash*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T06:52:38.607

您需要将 iPad 同步到 iTunes，它会在您的 iTunes 同步文件夹中可用。
此外，我曾经找到一种在 iPad 本身中阅读这些报告的方法，它可能在关于部分。搜索一下，你可能会找到。

路径是设置 > 隐私 > 诊断和使用 > 诊断和使用数据

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-28T11:36:18.690

使用 iTunes 软件。它会对你有所帮助。

# php - 独立路由库？

> ID：13108345
> 
> 赞同：2
> 
> 时间：2012-10-28T11:15:36.723
> 
> 标签：php, frameworks, routing

基本上多年来我已经开发了自己的框架。它缺少的是中央路由系统。我想将一个独立的路由库集成到我的框架中，而不是重新发明轮子。

是否有独立的 php 路由库？
如果没有，你能建议任何指导它的发展吗？

我想要类似 F3 框架的东西：

```
$route->add( 'article/view/[0-9]+' );  //> Call Article->view(); (website.net/article/id/123)
$route->add( 'email', 'email.php' ); //> Run email.php (website.net/email) 
```

## 编辑

我是自己开发的。这里的示例用法：

```
 // index.php

   require 'router.php';

   $router = new Router();

   $router
     //> It will require controllers/article.php and call one of the view,etc method
     ->add('(article)/(view|edit|delete|add)/([0-9]+)')

     //> Same thing as before, but this time we use underscore as separator
     //> It will require controllers/entry.php and call view method
     ->add('(entry)_(view)_([0-9]+)')

     //> Or you can require custom file like this
     ->add( '(myCustomPage)' , '/controllers/myCustomPath/myPage.php' )

     ->dispatch(); 
```

如果您需要一个简单的控制器，您可以直接运行一个函数，而无需指定一个类。例子：

```
 // myCustomController.php
   function myCustomController($id) {
     echo 'I am the Custom Controller';
   }

   // index.php
   $router
      ->add('(myCustomController)/([0-9]+)');

   // The routing system will detect there is a function and will call it directly.
   // Otherwise will just instanciate a new myCustomController() object 
```

您当然可以像这样使用搜索引擎友好的 URL：

```
 //> This will match something like this: article/123/your-title-here
   ->add('(article)/([0-9]+)/[a-z0-9-]+') 
```

您可以像这样从自定义控制器运行自定义方法：

```
 ->add('(ctrlname)/(methodname)/(params)', array('CustomControllerName','CustomMethod') ); 
```

来源： http: [//pastebin.com/9F02GEyN](http://pastebin.com/9F02GEyN)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T11:24:49.737

你可以使用[Symfony 路由组件](https://packagist.org/packages/symfony/routing)，或者出色的[klein.php](https://github.com/chriso/klein.php)路由器，这是一个受 Sinatra 启发的工具，包含在单个 PHP 文件中。

# apache - 通过 mod_rewrite 将 TLD 转换为查询字符串参数

> ID：13108355
> 
> 赞同：1
> 
> 时间：2012-10-28T11:17:03.447
> 
> 标签：apache, mod-rewrite, internationalization

寻找一些关于 mod 重写条件/规则组合的帮助，它可以实现以下目标：

如果 TLD 是 .fr 并且 lang=fr 不是当前参数。

*   如果没有当前参数，请在内部将 ?lang=fr 添加到请求中。

*   如果当前有参数，请在内部将 &lang=fr 添加到请求中。

目前我可以正确检测 TLD，但无法添加“逻辑”来确定如何处理查询字符串参数的修改。我需要能够通过 5 或 6 个可能的 TLD 执行此操作。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T11:22:47.890

这应该有效：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} \.([^\.]*?)$
RewriteCond %{QUERY_STRING} !lang
RewriteRule ^ %{REQUEST_URI}?lang=%1 
```

第一行解析顶级域并将其*存储*在 %1 中。
第二行检查是否已经设置了任何语言，如果没有
在（第三行）添加到请求 url 的语言参数中。

# crystal-reports - 将 2 页数据放入水晶报表的单页中

> ID：13108362
> 
> 赞同：1
> 
> 时间：2012-10-28T11:18:36.217
> 
> 标签：crystal-reports, sap

我有一个显示学生成绩的页面。我想在此页面之后插入另一个页面，显示等级描述。我该怎么做呢？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:21:54.793

*   在报告上添加一个组是学生证/主键
*   在组页脚中添加您的描述页面。
*   在您的组页脚设置中，选中“之前的新页面”选项

# php - ajax 请求中的 Ajax 请求失败 - 再次重新加载整个页面

> ID：13108370
> 
> 赞同：-1
> 
> 时间：2012-10-28T11:20:17.150
> 
> 标签：php, javascript, jquery, ajax, post

所以，基本上我想要实现的目标：在 index.php 中，我将输入产品代码来搜索产品信息和图像（该查询在 open_first.php 中运行，通过 ajax 发布请求调用）。它工作得非常完美..

加载 open_first.php 时，它会显示一些我可以从中选择的图像（当我单击图像时，相关的复选框会被选中，其中包含图像 ID）。这也可以，很好。

但是，如果我在字段中输入代码：“productCodeCopy”并单击“confirmCodeCopy” - 按钮它会重新加载整个页面，我的意思是 index.php，我输入的所有内容都丢失了，我又回到了起点再次。我不明白为什么会这样。我想这与第二个ajax请求是从动态创建的页面（open_first.php）发出的事实有关吗？我是否也错过了应该发布的内容？或者是什么问题，这真的让我很沮丧，因为我已经尝试解决这个问题几个小时了。

注意：Jquery 在 index.php、open_first.php 和 open_second.php 中加载，我只是忽略了这一点，以使代码更简单。

文件：index.php（“起点”）

```
<!-- head -->
<script type="text/javascript">
$(document).ready(function() {
$("#confirmCode").on('click', function(){
    var productCode = $("#productCode").val();
    $.ajax({
        url: 'open_first.php',
        type: "POST",
        data: ({code: productCode}),
        success: function(data){
            $("#found").html(data);
        },
        error: _alertError
    });
    function _alertError() {
        alert('error on request');
    }
    });
});
</script>

<!-- body -->
<input type="text" class="textfields" id="productCode" name="productCode" value="YT-6212">
<input type="button" class="admin-buttons green" name="confirmCode" id="confirmCode" value="Search">
<div id="found"></div> 
```

文件 open_first.php

```
<script type="text/javascript">
    $(function() {
        $("#foundImage").on('click', function(){
            $('#foundImage').toggleClass("foundImage-selected foundImage");
            var myID = $('#foundImage').data('image-id');
            var checkBox = $('input[id=selectedImages-'+myID+']');
            checkBox.prop("checked", !checkBox.prop("checked"));
        });

        $("#confirmCodeCopy").on('click', function(){
            var checkedItems = $('input:checkbox[name="selectedImages[]"]:checked');                
            // this code here reloads the whole page / view (as in "index.php")
            $.ajax({
                url: 'open_second.php',
                type: "POST",
                data: ({checked: checkedItems, copyTo: productCodeCopy, code: "<?php echo $_POST['code']; ?>"}),
                success: function(data){
                    $("#copyToProducts").append(data);
                },
                error: _alertError
            });
            /*
            // the code below runs just fine when I hit the button "confirmCodeCopy"
            alert('Fuu');
            return false;
            */
        });

        function _alertError() {
            alert('error');
        }
    });
</script>
<!--BODY-->
<!-- these are dynamically generated from php, just to simplify we have checkbox that contains value "1" to be posted in ajax -->
<div class="foundImage" id="foundImage" data-image-id="1"><img src="image.jpg"><input type="checkbox" id="selectedImages-1" name="selectedImages[]" value="1" style="display: none;"></div>
<label for="productCodeCopy">Products code</label>
<input type="text" class="textfields" id="productCodeCopy" name="productCodeCopy">
<br /><br />
<label for="confirmCodeCopy">&nbsp;</label>
<input type="button" class="admin-buttons green" name="confirmCodeCopy" id="confirmCodeCopy" value="Search">
<div id="copyToProducts"></div> 
```

open_second.php 现在只打印出 POST 变量，所以还没有什么特别的。

解决了

好吧，我解决了。在达姆的帮助下。

我删除了这一行：

```
$('input:checkbox[name="selectedImages[]"]:checked'); 
```

并添加了这个：

```
var checkedItems = new Array();
var productToCopy = $('#productCodeCopy').val();
$("input:checkbox[name=selectedImages[]]:checked").each(function() {
    checkedItems.push($(this).val());
}); 
```

由于不存在表单元素，因此除非通过 .val() -function“手动检索”，否则它不会获取字段值.. 愚蠢的我..

我不知道这有多大影响，但我也改变了：

```
data: ({checked: checkedItems, copyTo: productCodeCopy"}) 
```

至

```
data: {"checked": checkedItems, "copyTo": productToCopy} 
```

所以现在它工作得很好:) 酷！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:30:04.087

当您将事件处理程序应用于按钮或链接以执行 ajax 时...始终阻止浏览器默认处理对该元素的单击

有2种方式。使用`preventDefault()`或`false`从处理程序返回

```
$("#confirmCodeCopy").on('click', function(event){
  /* method one*/
  event.preventDefault();
  /* handler code here*/

  /* method 2*/
  return false;

}) 
```

将提交处理程序添加到表单以使用表单数据执行 ajax 而不是将表单重定向到其操作 url 也是如此

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T11:55:14.413

您的代码`$('input:checkbox[name="selectedImages[]"]:checked');`返回*未定义*，使 ajax 调用中的 json 数据无效。在那里检查你的选择器。

# javascript - 为什么我会收到一条错误消息：missing ; 声明之前？

> ID：13108373
> 
> 赞同：3
> 
> 时间：2012-10-28T11:20:37.843
> 
> 标签：javascript

```
console.log "january".substring(0,3);
console.log "melbourne is great".substring(0,12);
console.log "hamburgers".substring(4,10); 
```

我试图理解为什么这不起作用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T11:21:32.523

`console.log()`是一个函数。JavaScript 不是 Ruby，需要括号 :)

**例子：**

```
console.log("january".substring(0,3)); 
```

# ruby-on-rails - 如何将一名工作人员分配到队列？

> ID：13108379
> 
> 赞同：0
> 
> 时间：2012-10-28T11:21:54.177
> 
> 标签：ruby-on-rails, ruby-on-rails-3, resque

在 Resque 中，如果我有以下情况：

```
bundle exec rake resque:work QUEUE=critical,high,normal,low,aggregate 
```

我如何表明我只想要一个特定队列（即聚合队列）的工作人员？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T16:21:23.797

我不认为这是可能的

[如果您在此处](https://github.com/defunkt/resque/blob/master/lib/resque/multi_queue.rb#L51)查看当前代码的原因

Resque 轮询所有队列

```
value = @redis.blpop(*(queue_names + [1])) until value 
```

queue_names 是你的`critical,high,normal,low,aggregate`

所以这里的重点不管你是使用单一的resque工作还是multiple workers

使用`resque:workers`每个 resque 工作轮询所有可用队列，并且一旦

消息从队列中的任何队列中消费，工作开始对其进行操作

如果您只想为上述队列分配一项工作，最好运行两个 rake

像这样的任务

`bundle exec rake resque:worker COUNT=4 QUEUE=critical,high,normal,low`

`bundle exec rake resque:work QUEUE=aggregate`

这样，您可以为`aggregate`队列分配一个 resque worker

希望这有帮助

# iphone - 错误 24（打开的文件太多） - iPhone

> ID：13108380
> 
> 赞同：0
> 
> 时间：2012-10-28T11:22:06.227
> 
> 标签：iphone, ios, avfoundation, avaudioplayer

我最近在我的游戏中加入了声音。用户每次触摸屏幕，都会射出一个箭头，并播放一个声音。我正在使用以下代码播放声音：

```
- (void)arrowShoot {
    NSURL *url = [NSURL fileURLWithPath:[NSString stringWithFormat:@"%@/arrow.mp3", [[NSBundle mainBundle] resourcePath]]];
    arrowShootPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:nil];
    if (arrowShootPlayer != nil) {
        [arrowShootPlayer play];
    }
} 
```

`arrowShootPlayer`我每次都分配内存的原因是因为用户可以快速点击屏幕，我希望声音重叠。否则，只有在前一个完成播放后才会播放声音。

无论如何，我收到此错误：

```
<com.apple.main-thread> shm_open failed: "AppleAudioQueue.36.5755" (23) flags=0x2 errno=24 
```

一旦我收到此错误，声音就会停止播放。其他一切都很好，只是箭头声音停止播放。

有没有更好的方法在 iPhone 上播放类似这样的“重叠”声音，或者有没有办法解决这个错误？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:40:51.403

如果始终是相同的音频，请使用从内存缓冲区播放而不是打开文件。声明一些本地缓冲区：

```
NSData* data; 
```

然后在你的方法中：

```
if(!data) {
   data = [NSData dataWithContentsOfURL:url options:NSDataReadingMappedIfSafe error:&err];
}
arrowShootPlayer = [[AVAudioPlayer alloc] initWithData:data error:nil];
if (arrowShootPlayer) {
    [arrowShootPlayer play];
} 
```

# ruby-on-rails - 将 0.0.0.0 添加到 /etc/hosts

> ID：13108381
> 
> 赞同：0
> 
> 时间：2012-10-28T11:22:12.777
> 
> 标签：ruby-on-rails

我在几个 Rails 安装指南中看到了类似的内容。我们到底在做什么？

将默认子域添加到 /etc/hosts，例如：“0.0.0.0 localhost.lan group1.localhost.lan group2.localhost.lan”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T11:34:14.947

这意味着**所有域及其别名**都将指向分配给这台机器的**所有 IP 地址。**

因此，如果您的机器有 3 个 IP NIC，并且每个 IP 都分配了 IP。然后该行会将所有名称指向所有这 3 个 IP。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-28T11:35:30.490

您可以将域/子域绑定到 localhost 127.0.0.1 或 0.0.0.0 以获得可以在浏览器中使用的地址来访问您的应用程序。

当服务在 0.0.0.0 上侦听时，这意味着该服务正在侦听所有配置的网络接口，当在 127.0.0.1 上侦听时，服务仅绑定到环回接口（仅在本地计算机上可用）。

所以“0.0.0.0 localhost.lan group1.localhost.lan group2.localhost.lan”的意思是“请使域 localhost.lan、group1.localhost.lan 和 group2.localhost.lan 可浏览并将它们指向我所有的网络适配器” .

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T11:33:54.063

如果您正在开发一个需要有效子域的应用程序，那么 rails 指南会讨论将该子域添加到 hosts 文件中。这样他们就可以将该请求路由到您的本地主机（127.0.0.1）

例子：

```
127.0.0.1   sampleapp.heroku.com 
```

# java - JPA左/右连接查询

> ID：13108382
> 
> 赞同：1
> 
> 时间：2012-10-28T11:22:30.480
> 
> 标签：java, jpa, jpa-2.0

我有来自实体 Aa、Bb、Cc 的结构：

*   Aa 有一个 Bb 列表
*   Bb 有一个抄送列表

-

```
public class Aa{
@OneToMany   
List<Bb> listBb;
}

public class Bb{
@OneToMany 
List<Bb> listCc;
} 
```

我想创建一个 JPA Criteria API 查询以通过 C 的 id 来池 Aa：

```
public A getAaByCcId(long id) {...} 
```

在本机 sql 中，我会尝试左连接（两次）。如何使用 JPA 执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:31:11.157

您还可以使用 JPQL 中的连接来执行此操作：

```
select a from Aa a
inner join a.listBb b
inner join b.listCc c
where c.id = :cId 
```

请注意，这里可以使用内部连接，因为您对 有一个限制`c.id = :cId`，只有在 B 和 C 存在时才适用。但是你也可以使用左连接。

编辑：

使用 Criteria 查询，它将如下所示（未经测试）：

```
CriteriaBuilder builder = em.getCriteriaBuilder();
CriteriaQuery<Aa> criteria = builder.createQuery(Aa.class);
Root<Aa> a = criteria.from(Aa.class);
CollectionJoin<Aa, Bb> b = a.join(Aa_.listBb);
CollectionJoin<Bb, Cc> c = b.join(Bb_.listCc);
criteria.where(builder.equal(c.get(Cc_.id), cId));
return em.createQuery(criteria).getResultList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T23:04:24.913

假设每个实体都有对其父实体的引用，其中`Cc`' 对 a 的引用`Bb`被称为' 对 an 的引用被称为`bb`，那么在 JPQL 中，您可以执行以下操作：`Bb``Aa``aa`

```
select cc.bb.aa from Cc cc where cc.id = ? 
```

这的标准版本应该是一个简单的翻译。

# asp.net - 数据表到 .accdb 数据库

> ID：13108388
> 
> 赞同：1
> 
> 时间：2012-10-28T11:22:58.903
> 
> 标签：asp.net, excel, ms-access, datatable, oledb

我正在使用 Excel 工作表中的数据填充数据集。我现在需要将此数据插入到具有相同结构的 Access 数据库中的表中。

约定将要求我遍历 DataTable 的行并为每个行进行 INSERT 查询，但我想知道是否有更有效的方法来实现这一点？也许类似于 SQL Server 的 SqlBulkCopy 的东西？

这是我到目前为止的代码：

```
 Dim connection As OleDbConnection = New OleDbConnection("Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" & Server.MapPath(path) & ";Extended Properties=Excel 12.0;")
    Dim adapter = New OleDbDataAdapter("SELECT * FROM [Sheet1$] WHERE EmpID IS NOT NULL", connection)
    Dim results = New System.Data.DataSet
    connection.Open()
    adapter.Fill(results)
    connection.Close()
    connection = New System.Data.OleDb.OleDbConnection("Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" & Server.MapPath("~/App_Data/Leaves.accdb"))
    `Now, short of a loop, how can I insert results.Tables(0) into my database? 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:01:40.653

您可以使用 ADO，例如：

```
INSERT INTO Table1 ( ADate ) 
SELECT SomeDate FROM [Excel 8.0;HDR=YES;DATABASE=Z:\Docs\Test.xls].[Sheet1$a1:a4] 
```

连接到 Access 数据库的位置。如果您希望使用整个工作表，请将 [Sheet1$] 作为您的表格，如果您希望使用命名范围，只需按名称引用即可。

# ruby - 无法阻止“rackup”启动的 Webrick

> ID：13108395
> 
> 赞同：2
> 
> 时间：2012-10-28T11:24:18.370
> 
> 标签：ruby, sinatra, rack, webrick

我正在开发一个 Sinatra 应用程序，我正在使用“rackup”来启动 Webrick。我应该怎么做才能阻止它？现在我正在使用 Ctrl+Z ，它**似乎**停止了。但是，当我尝试再次启动它时，它会说端口已经绑定。

我尝试了许多端口，每次它启动，停止，然后当我再次重新启动它时说它正在使用。

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T12:07:51.043

`Ctrl+Z`只会“暂停”进程，而不是终止/杀死它。

要真正杀死它，请在进程表中找到它并执行`kill -9 [PID]`

像：

```
ps auxwww | grep ruby
slivu  16244   0.0  0.5  2551140  61220 s020  R+    1:18AM   0:10.70 ruby app.rb 
```

第二列（16244）是PID。

另一种方法是用 Ruby “捕捉”`INT`信号并显式退出应用程序。

在您的应用中：

```
Signal.trap 'INT' do
    Process.kill 9, Process.pid
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T13:04:18.357

扩展 slivu 的回复，

`CTRL+C`如果您仍在同一个终端中，请使用终止该进程。

如果您在后台启动它，或者想从不同的终端终止，请使用

```
ps aux | grep [r]ackup | awk '{print $2}' | xargs sudo kill -9 
```

# php - MySQL 'CREATE TABLE' 查询直接通过 PHPMyAdmin 工作，但不通过 PHP

> ID：13108398
> 
> 赞同：1
> 
> 时间：2012-10-28T11:24:32.223
> 
> 标签：php, mysql, phpmyadmin, create-table

我有一个由 PHPMyAdmin 生成的 MySQL CREATE TABLE 脚本。它直接通过 PHPMyAdmin 工作得很好，但我无法通过我的 PHP 脚本工作。

我得到的错误是：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 
'CREATE TABLE IF NOT EXISTS `vc5_users` (`id` int(12) NOT NULL AUTO' at line 14 
```

这是查询：

```
INSERT INTO `users` (fname, lname, email, username, password, books_available, users_available, signup_date)
VALUES (
  'John',
  'Doe',
  'jdoe@gmail.com',
  'jdoe',
  'foobar',
  '250',
  '25',
  '123456' 
);

CREATE TABLE IF NOT EXISTS `jdoe_users` (
  `id` int(12) NOT NULL AUTO_INCREMENT,
  `fname` varchar(128) COLLATE utf8_bin NOT NULL,
  `created_at` varchar(32) COLLATE utf8_bin NOT NULL,
   PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin AUTO_INCREMENT=1 ;

CREATE TABLE IF NOT EXISTS `jdoe_books` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `isbn` varchar(13) NOT NULL,
  `title` varchar(256) NOT NULL,
  `author` varchar(256) NOT NULL,
  `publisher` varchar(128) NOT NULL,
  `status` varchar(32) NOT NULL,
  `last_loan` date NOT NULL,
  `last_return` date NOT NULL,
  `bookholder` varchar(64) NOT NULL,
  `due_back` date NOT NULL,
  `quantity` int(11) NOT NULL DEFAULT '1',
  `thumnail_url` varchar(128) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T11:25:26.390

PHP using 中的查询`mysql_query`只能有 1 条语句。您正在尝试一次执行多个。

分离语句并执行。届时它将起作用。

# c++ - 调试器严重检测到 C++ 分段错误

> ID：13108402
> 
> 赞同：1
> 
> 时间：2012-10-28T11:25:19.033
> 
> 标签：c++, gdb, g++, segmentation-fault

下面是我的 c++ 程序的开始。它对我来说看起来很正常，但是当我运行它时，我得到了分段错误。这是调试器给我的：

```
Program received signal SIGSEGV, Segmentation fault.
0x00000000004008d4 in main () at usu.cpp:12
12      cin >> n >> k; 
```

但是错误与这行代码无关，因为当我在 for 循环程序正常结束之前输入“reutrn 1”时。有什么问题？我使用以下代码编译我的程序：g++ -ggdb3

```
#include <iostream>
#include <stdio.h>
#define MAX_N 1000000
#define MAX_K 1000000
#define MAX_IL_KROKOW 500000

using namespace std;

int main()
{
    int n, k;   
    cin >> n >> k;

    char klocki[MAX_N+1];
    int Przes_C[MAX_IL_KROKOW];//podaje następne c po c znajdującym się na pozycji i
    int Ktore_b[MAX_N];//na podstawie indeksu b w klockach zwraca indeks w tablicy Przes_b
    int Przes_b[MAX_N];//zwraca indeks b w klockach na podstawie występowania b 
    int poprz_c = -1;
    int ilosc_b = 0;
    int klocki_len = 0;
    for(int i=0;i<n;i++) 
    {   
        klocki[i] = getchar();
        return 1;
        if(klocki[i] == 'b')
        {   
            Przes_b[ilosc_b] = i;
            Ktore_b[i] = ilosc_b;
            ilosc_b++;
        }       
        if(poprz_c != -1 && klocki[i] == 'c')
            Przes_C[poprz_c] = i;
        if(klocki[i] == 'c')
            poprz_c = i; 

        klocki_len++;
    }       
    klocki[klocki_len] = '\0'; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T11:30:25.747

当您尝试将某些内容写入数组时，您的数组分配可能会失败，从而导致未定义的行为。

```
char klocki[MAX_N+1];
int Przes_C[MAX_IL_KROKOW];
int Ktore_b[MAX_N];
int Przes_b[MAX_N]; 
```

这些是巨大的阵列。每个进程只分配固定大小的堆栈。使用创建动态数组`new`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T11:49:30.977

您还可以将数组变量定义为主函数之外的全局变量。取决于您的程序（长度）是否有意义。

# c - 如何正确识别C中的不同行尾？

> ID：13108405
> 
> 赞同：4
> 
> 时间：2012-10-28T11:25:37.350
> 
> 标签：c, ascii, line-endings, lf

我想标题不言自明。

我正在使用 g++ 和 Notepad++ 在 Windows 7 上编写 C 程序，它比较文件的内容。

文件内容：

```
simple
file with lines 
```

文件在 Windows 样式 CRLF 中具有行尾。

当我使用此代码计算文件长度时：

```
fseek(file, 0, SEEK_END);
size = ftell(file);
fseek(file, 0, SEEK_SET); 
```

我得到**23**。

当我将行尾更改为 Unix 格式 LF（使用 Notepad++）时，我得到**22**长度。

在比较两个文件时，这会产生一种问题。这就是为什么我问，是否有办法确定给定文件是否有 LF 或 CR 或 CRLF。

我知道我可以区分 CR 和 LF，LF 的 ascii 代码为 10，CR 的 ascii 代码为 13。或者 LF 是 '\n' 而 CR 是 '\r'。

但是当在 char 之后读取文件 char 时，我总是得到 LF（ascii 10），即使有 CRLF。

我希望我说清楚了。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T11:35:50.197

这就是以文本和二进制模式读取文件的区别。

在文本模式下（fopen 使用相关参数`fopen( file, "r")` 然后 getc 等）所有行尾都被读取为一个字符。例如，如果您以二进制模式阅读，`fopen(file, "rb")`那么您将获得实际字节，并且您会看到 CRLF 和 CR 不同。fseek 将使用实际的字节数，因此会看到行尾的差异。

唯一的判断方法是以两种不同的方式读取文件，看看是否有 CRLF 对或大小不同，或者实际上只是看看是否有 LF，因为我认为当前的任何主要操作系统都没有使用它作为一行enfing。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T11:38:01.437

除了 Mark 的回答，如果您需要对已经打开的文件句柄（例如`stdin`or `stdout`）执行此操作，您可以使用[`_setmode()`](http://msdn.microsoft.com/en-us/library/tw4k6df8%28v=vs.80%29.aspx)：

```
#include <fcntl.h>
#include <io.h>

...

_setmode(fileno(stdin), _O_BINARY); 
```

如果该文件句柄尚未发生输入或输出，则此方法有效。顺便说一下，`_setmode()`只存在于 Windows 和 DOS 上；在类 Unix 操作系统（包括 OS X 之后的 Mac OS 版本）上，文件实际上总是以二进制模式打开，并且`fopen(file, "...b")`被接受但没有效果。在这些平台上，行尾由单个字符 编码`\n`。

# c# - Watin：从 IE 获取网页并在其上启动 JavaScript

> ID：13108408
> 
> 赞同：0
> 
> 时间：2012-10-28T11:26:27.790
> 
> 标签：c#, internet-explorer, watin

我正在尝试通过 URI 找到打开的网页并在其上启动 JS。我找到了一些示例并编写了简单的方法。这就是它的外观：

```
private void GetHtmlCode()
    {
        string uri = GetTargetURI();
        if(!string.IsNullOrEmpty(uri))
        {
            IE ie = IE.AttachTo<IE>(Find.ByUrl(uri));
            htmlCode = ie.Eval(JavaScriptToRun);
        }
        else
        {
            MessageBox.Show("Target page is not opened",
                            "Notification", MessageBoxButtons.OK);
        }
    } 
```

还有一种获取 URI 的方法：

```
private string GetTargetURI() //проверка URL
    {

        Regex reg;
        Match match;
        foreach(SHDocVw.InternetExplorer ie in shellWindows)
        {
            reg = new Regex(patternURL);
            match = reg.Match(ie.LocationURL.ToString());
            if (!string.IsNullOrEmpty(match.Value))
            {
                pageURL = ie.LocationURL.ToString();
                return pageURL;
            }
            pageURL = string.Empty;              
        }
        return pageURL;
    } 
```

- 所以 URI 完全正确或为空。

问题`IE ie = IE.AttachTo<IE>(Find.ByUrl(uri));`总是抛出

> WatiN.Core.Exceptions.BrowserNotFoundException：找不到 IE 窗口匹配约束：属性“href”等于 uri“%my_target_URI%”。搜索在 '30' 秒后过期。

我用谷歌搜索了很多，但仍然没有找到任何解决方案:(有人可以帮忙吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T18:33:06.160

尝试使用：

```
Browser.AttachTo<IE>(Find.ByUrl(u => u.Contains("NewMapping"))) 
```

并确保您的函数没有返回空，因为这应该是没有捕获窗口的原因。

问候！

# python - Edgewall Trac0.12.3 中缺少“用户”部分

> ID：13108411
> 
> 赞同：1
> 
> 时间：2012-10-28T11:27:02.987
> 
> 标签：python, linux, trac

我安装了 Edgewall Trac0.12.3 并将自己添加到管理员组。在管理面板中，我看到以下内容：

![在此处输入图像描述](../Images/b2fcb7af1d5d1a2fb95f46f53b709496.png)

AFAICR“用户”组必须在此处可用。通过使用这个组，我可以添加一个用户，管理他的权限，指定邮件等等。

也许我需要安装一些插件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T12:44:20.783

在没有任何插件的基础安装中，您只能从 Web 界面管理用户权限（屏幕截图上的**权限**选项）。

要从 Web 界面管理用户，您需要一个 3rd 方插件，例如[Account Manager 插件（还有其他插件，所以我建议您首先在](https://trac-hacks.org/wiki/AccountManagerPlugin)[Track Hacks](https://trac-hacks.org/)上做一个最适合您需求的调查）。

# android - 是否可以扫描所有支持 WiFi 的 Android 设备，而不仅仅是热点？

> ID：13108414
> 
> 赞同：2
> 
> 时间：2012-10-28T11:28:10.160
> 
> 标签：android, android-wifi, android-wireless

我一直在尝试开发一个扫描附近 WiFi 设备的应用程序。我在市场上发现了很多类似的应用程序，但它们只扫描附近的热点（接入点）。是否可以扫描并找到刚刚单独打开 WiFi 的设备。

如果是这样，请告诉我如何（代码片段）..提前谢谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T11:35:16.137

答案有 2 个部分。

1.  大多数 WiFi 设备可以在 AP 模式下运行（如果安装了正确的软件），在这种情况下，它们将作为普通 AP 出现在周围扫描的任何人面前。
2.  如果您想查找其他未处于 AP 模式的 WiFi 设备，您需要将设备切换到混杂（嗅探器）模式。这需要您的设备驱动程序/固件支持。在嗅探器模式下操作会导致设备指示空中的所有数据包，包括那些未发送给您的数据包。如果您的设备支持此操作模式，您需要通过发送相关命令来指示它 - 这是一个专有接口，因设备软件供应商而异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T11:45:24.960

这些附近的设备必须发送一些信号，您的设备可以接收这些信号才能检测到它们。我认为他们通常不会那样做。但是如果你可以在其他设备上安装一个应用程序，这个应用程序可以发送一个广播信号，你的设备可以接收到。

如果没有标准信号，您可以收听，那就很难了。您必须构建某种网络嗅探器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-16T21:53:26.353

嗅探器是读取直接端口的过程，在本例中为侦听端口 wifi。读取一个端口意味着指向一个指定的地址并读取同一个缓冲区。这个过程是低级的，你必须在纯 C 中完成并在 NDK 中编译。如果你知道这些问题是复杂的。

# c# - 增量更新应用程序数据的最佳方法

> ID：13108416
> 
> 赞同：3
> 
> 时间：2012-10-28T11:28:54.907
> 
> 标签：c#, database, caching, dynamic, storage

几年来，我一直在开发一个应用程序，我使用后端数据库进行了更新。整个关键是所有内容都缓存在客户端上，因此它永远不需要网络连接来操作，但是当它确实有连接时，它总是会获取最新的更新。每个更新的应用程序都附带最新版本的数据库，我希望它在数据库更新时只下载最少量的数据。

我目前使用带有时间戳的表来检查更新。它看起来像这样。

```
ID - Name - Description- Severity - LastUpdated
0 - test.exe - KnownVirus - Critical - 2009-09-11 13:38
1 - test2.exe - Firewall - None - 2009-09-12 14:38 
```

这种方法非常适合我以前需要的东西，但我希望扩展应用程序的更多功能以使用这种类型的动态方法。所有数据当前都存储为`XML`，但我不想将完整的 XML 文件存储在数据库中，只传输更改的数据。

那么，您将如何使用一种相当简单的方法将动态内容（text/xml/json/xaml）存储在数据库中，并让客户端只下载新的更新？我正在考虑让逻辑可以处理直接插入的 XML

```
ID - Data - Revision
15 - XXX - 15 
```

`XXX`会类似于`<Content><File>Test.dll<File/><Description>New DLL to load.</Description></Content>`并且会被插入到缓存中，但这显然会很复杂，因为我需要按顺序加载它们。

已经提到的另一种方法是基于类似于源代码控制的东西，将版本存储在文件的根目录中并计算增量以找出需要发送到客户端的最小数据量。

有人对如何在没有数据损坏风险的情况下解决此问题有任何建议吗？我还将扩展一些功能，使我能够恢复可能不好的修订，并用新的工作替代它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T04:55:41.860

我刚刚构建了一个与您描述的完全一样的应用程序。我在 DjSol 提到的 Microsoft Sync Framework 之上构建了它。

我使用带有 SqlCe 数据库的 C# 前端应用程序和另一端的 SQL 2005 Server。

以下文章对我非常有用：

[教程：同步 SQL Server 和 SQL Server Compact](http://msdn.microsoft.com/en-us/library/ff928494.aspx)

[演练：创建同步服务](http://msdn.microsoft.com/en-us/library/gg298975.aspx)

[ADO.NET 2.0 同步服务的逐步 N 层配置](http://blogs.msdn.com/b/sqlblog/archive/2010/04/19/step-by-step-n-tier-configuration-of-sync-services-for-ado-net-2-0.aspx)

[如何使用同步框架同步模式更改的数据库？](http://tuvianblog.com/2011/05/04/how-to-sync-schema-changed-database-using-sync-framework/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-06T07:38:42.243

这实际上取决于您使用的工具和您已经拥有的架构。是否已经有具有某些逻辑和数据访问层的服务器？

动态方法可能会变得复杂、缓慢并限制解决方案的数量。为什么需要动态结构？在关系数据库中使用名称-值对方法仅添加数据是否可行？静态和统一的数据结构更容易处理。

在详细介绍之前，您应该考虑不同的场景。

*   可以添加项目
*   项目可以更改
*   可以删除项目（我假设）

添加不是一个大问题。客户端需要记住它从服务器获得的最后一个修订号，然后您编写一个查询，从那里获取所有内容。

改变基本相同。您应该关心物品的识别。您需要一个不可更改的代理键，因为它似乎是您已经拥有的 ID。（指南在这里可能很有用。）

删除很棘手。您需要将项目标记为已删除而不是实际删除它们，或者有一个已删除 ID 的列表以及它们被删除时的修订号。

将数据存储在客户端：考虑在客户端使用 SQLite 等关系数据库。（它不需要安装，它只是存储在一个文件中。例如，Firefox 在 SQLite 数据库中存储了很多。）在服务器中使用相同的内容时，您可能可以重用一些代码。它也是基于事务的，这有助于保持一致（在同步期间发生错误时回滚）。

XML——如果你真的需要它——可以作为字符串存储在数据库中。

当使用支持 SQLite 的抽象层或 ORM（例如 NHibernate）时，即使服务器使用另一个数据库，您也可以重用一些代码。请注意，这种 ORM 的学习曲线可能相当陡峭。如果你不知道这样的事情，那可能太多了。

您不需要强制重用客户端和服务器中的代码。

同步本身不应该很复杂。您在客户端有一个修订号，在服务器中有一个最新修订。从那时起，您将在客户端中获得所有新的/更改的和删除的项目并将其应用到本地商店。更新本地修订号。犯罪。完毕。

我永远不会只更新修订的一部分，因为那样你就无法真正知道自上次同步以来发生了什么变化。因为您执行差异更新，所以必须有一个明确定义的客户端状态。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-31T13:50:57.563

我会选择使用[Sync Framework](http://msdn.microsoft.com/en-us/sync/bb821992.aspx)的解决方案。

来自微软的报价：

Microsoft Sync Framework 是一个全面的同步平台，支持应用程序、服务和设备的协作和离线。开发人员可以构建同步生态系统，通过任何网络使用任何协议集成任何应用程序、来自任何商店的任何数据。Sync Framework 具有支持漫游、共享和脱机数据的技术和工具。

Sync Framework 的一个关键方面是能够创建自定义提供程序。提供程序使任何数据源都可以参与 Sync Framework 同步过程，从而实现对等同步。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-06T15:54:39.763

你没有说你的后端数据库是什么，但如果它是 SQL Server，你可以使用 SqlCE（SQL Server Compact Edition）作为客户端数据库，然后使用 RDA 合并复制来根据需要更新客户端数据库。这肯定会满足您的所有要求；对于这样一个常见的要求，没有必要重新发明轮子。

# .net - WCF 委派，服务无法访问 SQL Server

> ID：13108419
> 
> 赞同：1
> 
> 时间：2012-10-28T11:29:41.147
> 
> 标签：.net, sql-server, wcf, active-directory, identity-delegation

我有以下基础设施：

*   计算机 #1，Microsoft SQL Server 2008，在系统帐户下启动。有登录`Master\MyLogin`（使用 Windows Authintification），服务器角色 = `sysadm`，数据库角色 = `db_owner`。

*   计算机#2，IIS 7.0 上的 WCF 服务。应用程序和站点在帐户下运行`Master\IISLogin`(IISLogin@myDomain.ru)

配置：

```
<configuration>
  <system.web>
    <compilation debug="true" />
  </system.web>
  <system.serviceModel>
    <bindings>
      <netTcpBinding>
        <binding name="CommonWindowsBinding" maxReceivedMessageSize="40000000">
          <security mode="TransportWithMessageCredential">
            <transport clientCredentialType="Windows" />
          </security>
        </binding>
      </netTcpBinding>
    </bindings>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
    <services>
      <service behaviorConfiguration="CommonBehavior" name="MyNameSpace.AdminService">
        <endpoint address="Windows" binding="netTcpBinding" bindingConfiguration="CommonWindowsBinding" name="IAdminServiceWindows" contract="MyNameSpace.IAdminService">
          <identity>
            <dns value="WCFServer" />
            <userPrincipalName value="IISLogin@myDomain.ru"/>
          </identity>
        </endpoint>
      </service>
    </services>
    <behaviors>
  <serviceBehaviors>
    <behavior name="CommonBehavior">
      <dataContractSerializer maxItemsInObjectGraph="10000000" />
      <serviceMetadata httpGetEnabled="true" policyVersion="Policy15" />
      <serviceDebug includeExceptionDetailInFaults="true" />
      <serviceCredentials>
        <clientCertificate>
          <authentication certificateValidationMode="PeerTrust" />
        </clientCertificate>
        <serviceCertificate findValue="WCFServer" storeLocation="LocalMachine" storeName="My" x509FindType="FindBySubjectName" />
        <userNameAuthentication userNamePasswordValidationMode="Custom" customUserNamePasswordValidatorType="MyClassFullName, MyDllFullName" />
      </serviceCredentials>
    </behavior>
  </serviceBehaviors>
</behaviors>
</system.serviceModel>
</configuration> 
```

服务有方法

```
[OperationBehavior(Impersonation = ImpersonationOption.Allowed)]
public bool HasRole(string roleName)
{
     //work with database
} 
```

它首先使用 EF 5.0 数据库。连接字符串

```
"Data Source=Computer1; Initial Catalog=myDB; Integrated Security=True; Multipleactiveresultsets=True; Persist Security Info=True;" 
```

*   3 号计算机，客户端。它具有以下配置

    ```
    <configuration>
    <system.serviceModel>
      <bindings>
        <netTcpBinding>
            <binding name="CommonWindowsBinding" closeTimeout="00:01:00"
                openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
                transactionFlow="false" transferMode="Buffered" transactionProtocol="OleTransactions"
                hostNameComparisonMode="StrongWildcard" listenBacklog="10"
                maxBufferPoolSize="524288" maxBufferSize="65536" maxConnections="10"
                maxReceivedMessageSize="40000000">
                <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                    maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                <reliableSession ordered="true" inactivityTimeout="00:10:00"
                    enabled="false" />
              <security mode="TransportWithMessageCredential">
                <transport clientCredentialType="Windows" />
              </security>
            </binding>
         </netTcpBinding>
    </bindings>
    <client>
        <endpoint  name="Megatec.MasterTourService.Contracts.IAdminServiceWindows"
            address="net.tcp://Computer2:5012/IISTest/AdminService.svc/Windows"
            behaviorConfiguration="CustomBehavior"
            binding="netTcpBinding"
            bindingConfiguration="CommonWindowsBinding"
            contract="Megatec.MasterTourService.Contracts.IAdminService">
           <identity>
                <dns value="WCFServer" />
           </identity>
        </endpoint>        
    </client>
    <behaviors>         
      <behavior name="CustomBehavior">
        <dataContractSerializer maxItemsInObjectGraph="10000000"/>
        <clientCredentials>
          <clientCertificate findValue="WCFClient" x509FindType="FindBySubjectName"
              storeLocation="LocalMachine" storeName="My" />
               <serviceCertificate>
                   <defaultCertificate findValue="WCFServer" storeLocation="LocalMachine"
                                       x509FindType="FindBySubjectName" />
                   <authentication certificateValidationMode="PeerTrust" 
                                   revocationMode="NoCheck"
                                   trustedStoreLocation="LocalMachine"/>
                </serviceCertificate>
              </clientCredentials>
            </behavior>
          </endpointBehaviors>
        </behaviors>
      </system.serviceModel>
    </configuration> 
    ```

频道具有以下凭据

```
channelFactory.Credentials.Windows.AllowedImpersonationLevel =
    System.Security.Principal.TokenImpersonationLevel.Delegation;
channelFactory.Credentials.Windows.ClientCredential =
    System.Net.CredentialCache.DefaultNetworkCredentials; 
```

它与数据库错误有关

> *用户“NT AUTHORITY\Anonymous”登录失败*

因此，WCF 委托存在一些问题。当我尝试使用简单的`username/password`身份验证时，它工作得很好——所以，证书等等都很好。

我在[此指令](http://msdn.microsoft.com/en-us/library/ff650896.aspx)上执行了第 4 步，但它不起作用。

也许我的代码或配置有问题？我该如何解决？

**更新**。

1.  试过（没有结果）

    [OperationBehavior(Impersonation = ImpersonationOption.Allowed)] => [OperationBehavior(Impersonation = ImpersonationOption.Required)]

2.  试过（没有结果）

3.  在服务方面

    ServiceSecurityContext.Current.WindowsIdentity.ImpersonationLevel = 模拟（不是委托！）

4.  当我尝试将 IIS 池的标识从 ApplicationPoolIdentity 更改为 IISLogin@myDomain.ru 时，计算机 3 上的客户端崩溃了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T12:09:07.500

在您的 computer3 配置中尝试以下操作（代替您当前的`<behaviors>...</behaviors>`块）：

```
<behaviors>
  <endpointBehaviors>
    <behavior name="CustomBehavior">
      <clientCredentials>
        <!--<windows allowNtlm="false" allowedImpersonationLevel="Delegation" />-->
        <windows allowNtlm="true" allowedImpersonationLevel="Delegation" />
      </clientCredentials>
    </behavior>
  </endpointBehaviors>
</behaviors> 
```

编辑您可能还需要在 Computer2 上设置 Active Directory 记录，以允许在“所有类型”（不仅仅是 Kerberos）上将凭据委派给 Computer1

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T13:20:05.490

不幸的是，Transport/TransportWithMessageCredential 安全模式不支持使用客户端凭据和委派进行此类工作。我已经改变`CommonWindowsBinding`了以下方式

服务器

```
 <binding name="CommonWindowsBinding" maxReceivedMessageSize="40000000">
      <security mode="Message">
        <message clientCredentialType="Windows" />
      </security>
    </binding> 
```

客户

```
 <binding name="CommonWindowsBinding" closeTimeout="00:01:00"
        openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
        transactionFlow="false" transferMode="Buffered" transactionProtocol="OleTransactions"
        hostNameComparisonMode="StrongWildcard" listenBacklog="10"
        maxBufferPoolSize="524288" maxBufferSize="65536" maxConnections="10"
        maxReceivedMessageSize="40000000">
        <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
        <reliableSession ordered="true" inactivityTimeout="00:10:00"
            enabled="false" />
       <security mode="Message">
        <message clientCredentialType="Windows" />
      </security>
    </binding> 
```

# php - 从 PHP 逻辑错误中调用 JavaScript

> ID：13108420
> 
> 赞同：0
> 
> 时间：2012-10-28T11:29:46.660
> 
> 标签：php, javascript, google-maps, logic

我正在从我的数据库中打印出许多行。每行包含一个 td，其中 id 是相应的行号（行号从 1 开始）。

随着每一行的回显，我使用 javascript .appendChild() 更新具有地址的行，这些地址的坐标已从数据库中调用。

前 5 行坐标已正确转换为地址，其余行具有从 db 调用的正确坐标（我知道，因为我检查了源）但是在行中输入的地址始终是数据库的最后一行。

请注意，坐标正在使用 google maps api 转换为地址。

```
if ( mysql_num_rows( $result ) > 0 ){ 

  $i = 1;
  while($row = mysql_fetch_array($result)){
    echo "<tr>";
    ?>

    <script>
      initialize();
      var counter = 1;

      function initialize() {
        var geocoder;
        geocoder = new google.maps.Geocoder();
        var latlng = new google.maps.LatLng(<?php echo $row['latitude'] ?>,<?php echo $row['longitude'] ?>);
        geocoder.geocode({'latLng': latlng}, function(results, status) {
          if (status == google.maps.GeocoderStatus.OK) {
            if (results[1]) {
              var txt = results[0].formatted_address;
              var newtext = document.createTextNode(txt);
              document.getElementById("address" + counter).appendChild(newtext);
              counter++;
            } else {
              alert('No results found');
            }
          } else {
            //alert('Geocoder failed due to: ' + status);
          }
        });
      }

      setInterval(convert, 2);

      function convert() {
        initialize();
      }
    </script>

    <?php
    echo "<td id='address" . $i . "'></td>";
    $i++;
  } 
```

**解决方案**

经过一番思考和大量谷歌搜索，我解决了！下面的完整代码供其他可能偶然发现的人使用！

```
<?php
    // security check
    $account_type = $_COOKIE["account_type"];
    if($account_type != "canvass_leader" && $account_type != "leader" && $account_type != "canvasser"){
        header("location:login.php");
    }
    $username_cookie2 = $_COOKIE["username_cookie"];
?>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="styles/style.css"/> 
    <script src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
    <title>Canvassing Data</title>

    <style type="text/css">
        #header #welcome #para{
            margin-top: -84px;
        }
    </style>

    <script src="http://code.jquery.com/jquery.min.js" type="text/javascript"></script>
    <script>
        function setUp() {
            window.counter = 1;

            setInterval(initialize, 700);
        }

        function initialize() {
            var geocoder;
            geocoder = new google.maps.Geocoder();

            var lat = document.getElementById("lat" + counter);
            var lng = document.getElementById("lng" + counter);
            //alert(lat.innerHTML);
            //alert(lng.innerHTML);

            var latlng = new google.maps.LatLng(lat.innerHTML,lng.innerHTML);

            geocoder.geocode({'latLng': latlng}, function(results, status) {

                if (status == google.maps.GeocoderStatus.OK) {

                    if (results[1]) {
                        var txt = results[0].formatted_address;
                        var addressValue = document.createTextNode(txt);

                        $('#lat' + counter).remove();
                        $('#lng' + counter).remove();

                        var element = "#address" + counter;
                        $(element).append(addressValue)
                        counter++;

                    } else {
                        alert('No results found');
                    }
                } else {
                    //alert('Geocoder failed due to: ' + status);
                }
            });
        }
    </script>
</head>

<body onload="setUp()" >

    <div id="wrapper">

        <?php 
            include('header.php'); 

            // connect to server and select databse.
            mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
            mysql_select_db("$db_name")or die("cannot select DB");

            // get party cookie
            $party = $_COOKIE["party"];

            // set table name
            $tbl_name = "checklist_" . $party;
        ?>

        <div id='info_bubble'>From this page you can view, search and export all collected canvassing data.</div>

        <?php if($account_type == "canvass_leader") { ?>
            <div style="text-align: center;">
                <form id="" method="post" action="" style="margin: 20px 0 30px 0;">
                    <h3>Search Canvassing Data</h3>
                    <fieldset id="inputs" >
                        <input style="width: 270px;" name="search_name" type="text" placeholder="Search by canvasser name.." >
                        <input style="width: 270px;" name="search_reception" type="text" placeholder="Search by reception at door.." >
                    </fieldset>
                    <fieldset id="actions" class="button button-blue">
                        <span><input type="submit" id="submit" name="search" value="Search Data"></span>
                    </fieldset>
                </form>
            </div>
        <?php } ?>

        <?php
            if(isset($_POST['search'])) {
                $search_name = $_POST['search_name']; 
                $search_reception = $_POST['search_reception']; 

                if(strlen($search_name)) {
                    $sql = "SELECT * FROM $tbl_name WHERE canvasser = '$search_name'";
                    $result = mysql_query($sql);
                }
                if(strlen($search_reception)) {
                    $sql = "SELECT * FROM $tbl_name WHERE reception_at_door = '$search_reception'";
                    $result = mysql_query($sql);
                }
            }
            else{
                if($account_type == "canvass_leader") {
                    $sql = "SELECT * FROM $tbl_name WHERE creator = '$username_cookie2'";
                    $result = mysql_query($sql);
                }
                else { // account_type = Leader
                    $sql = "SELECT * FROM $tbl_name";
                    $result = mysql_query($sql);
                }
            }

            // display table data           
            echo "<div id='content'>
                    <table class='bordered' border='1'>
                    <tr>
                    <th>Address</th>
                    <th>House Number</th>
                    <th>Registered to Vote</th>
                    <th>Visited by Candidate</th>
                    <th>Leafleted</th>
                    <th>Canvassed</th>
                    <th>Reception at Door</th>
                    <th>Canvasser</th>
                    </tr>";

            if ( mysql_num_rows( $result ) > 0 ){ 

                //$num_rows = mysql_num_rows($result);
                //echo "$num_rows Rows\n";

                $i = 1;

                while($row = mysql_fetch_array($result)){
                    echo "<tr>";
                    ?>

                    <?php
                    //echo "<td id='address" . $i . "'></td>";
                    //echo "<td id='address" . $i . "'>" . $row['latitude'] . " ## " . $row['longitude'] . "</td>";
                    //echo "<td id='address" . $i . "'>" . $row['latitude'] . " ## " . $row['longitude'] . "</td>";
                    echo "<td id='address" . $i . "'><p id='lat" . $i . "'>" . $row['latitude'] . "</p><p id='lng" . $i . "'>" . $row['longitude'] . "</p></td>";
                    // only set co-ordiantes first, then convert them to address by getElementById and appendChild when dom is ready in js in head of page

                    echo "<td>" . $row['house_number'] . "</td>";
                    echo "<td>" . $row['registered_to_vote'] . "</td>";
                    echo "<td>" . $row['visited_by_candidate'] . "</td>";
                    echo "<td>" . $row['leafleted'] . "</td>";
                    echo "<td>" . $row['canvassed'] . "</td>";
                    echo "<td>" . $row['reception_at_door'] . "</td>";
                    echo "<td>" . $row['canvasser'] . "</td>";
                    echo "</tr>";

                    $i++;

                }
            }

            echo "</table>";    

            if( $account_type == "canvass_leader" || $account_type == "leader"){    
                echo '<form style="margin-top: 10px;" action="dash_data_canvassing_export.php">';
                echo '<fieldset id="actions" class="button button-blue"><span><input type="submit" value="Export Data" id="submit" name="submit"></span></fieldset>';
                echo '</form></div>';
            }

            include('footer.php'); 
        ?>

    </div>
</body>
</html> 
```

# c++ - 上传到 pastebin

> ID：13108425
> 
> 赞同：1
> 
> 时间：2012-10-28T11:30:48.130
> 
> 标签：c++, libcurl, pastebin, trinitycore

简单明了：我正在从数据库中生成一个整数列表，我需要将它上传到 Pastebin.com。这是我的代码：

```
curl_global_init(CURL_GLOBAL_ALL);
if (CURL* curl = curl_easy_init()) {
    std::ostringstream postField;
    postField << "api_user_key=" << "&" << "api_option=paste" << "&" << "api_paste_private=1" << "&";
    postField << "api_paste_name=GuidSet" << "&" << "api_paste_expire_date=10M" << "&";
    postField << "api_paste_format=text" << "&" << "api_dev_key=XXXXXXXXXXXXXXXX" << "&" << "api_paste_code=";
    for (std::set<uint32>::const_iterator itr = resultSet.begin(); itr != resultSet.end(); ++itr) {
        postField << *itr;
        if (itr != --resultSet.end())
            postField << ",";
    }

    struct MemoryStruct chunk;
    chunk.memory = (char*)malloc(1);
    chunk.size   = 1;

    curl_easy_setopt(curl, CURLOPT_URL, "http://pastebin.com/api/api_post.php");
    curl_easy_setopt(curl, CURLOPT_POST, 1);
    char* postStr = curl_easy_escape(curl, postField.str().c_str(), postField.str().length());
    printf("POST parameters: %s\n", postStr);
    curl_easy_setopt(curl, CURLOPT_POSTFIELDS, postStr);
    curl_easy_setopt(curl, CURLOPT_VERBOSE, 1);
    curl_easy_setopt(curl, CURLOPT_NOBODY, 0);
    curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, WriteMemoryCallback);
    curl_easy_setopt(curl, CURLOPT_WRITEDATA, (void*)&chunk);
    curl_easy_setopt(curl, CURLOPT_USERAGENT, "TrinityCore GuidBot/1.0");

    curl_easy_perform(curl);
    curl_easy_cleanup(curl);

    self->_parentThread.sendCommand("PRIVMSG %s :%s: Finished, data available at %s",
        searchParams.targetRoom.c_str(), searchParams.actionInvoker.c_str(), chunk.memory);

    if (chunk.memory)
        free(chunk.memory);
    curl_free(postStr);
}
curl_global_cleanup(); 
```

但是，在执行该代码时，我总是得到这个：

```
* About to connect() to pastebin.com port 80 (#0)
*   Trying 72.20.36.113...
* connected
* Connected to pastebin.com (72.20.36.113) port 80 (#0)
> POST /api/api_post.php HTTP/1.1
User-Agent: TrinityCore GuidBot/1.0
Host: pastebin.com
Accept: */*
Content-Length: 609
Content-Type: application/x-www-form-urlencoded

* upload completely sent off: 609 out of 609 bytes
< HTTP/1.1 200 OK
< Server: nginx
< Date: Sun, 28 Oct 2012 11:21:33 GMT
< Content-Type: text/html
< Transfer-Encoding: chunked
< Connection: keep-alive
< Vary: Accept-Encoding
<
* Connection #0 to host pastebin.com left intact
* Closing connection #0
Bad API request, invalid api_option 
```

有什么我明显做错了吗？应该粘贴的块必须看起来像“48,50,59，...等”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T11:17:02.767

自己解决了，问题不在于 CURL，而是在流参数中，虽然 printf'ing 的东西没有显示任何插入的空间。

# visual-studio-2010 - Visual Studio 项目已加载信息

> ID：13108426
> 
> 赞同：0
> 
> 时间：2012-10-28T11:30:48.363
> 
> 标签：visual-studio-2010, solution, visual-studio-project

因此，我正在与多个使用 SVN 的开发人员一起开发一个包含大量项目的解决方案。有些项目对我来说是我想要加载的，但对于其他项目，它们可能不相关。

所以我的问题是，Visual Studio 在哪里存储有关项目开始加载的信息，以及提交项目/解决方案设置而不破坏其他人的正确方法是什么？

一个例子可能是我刚刚向解决方案添加了一个新项目，我想提交这些更改，但我不想提交项目是否已加载/重新加载（因为其他开发人员必须再次重新加载它们）。

编辑：我在这里找到了答案[当我在 Visual Studio 中卸载项目时，VS 在哪里保存此设置？](https://stackoverflow.com/questions/12275753/when-i-unload-projects-in-visual-studio-where-does-vs-save-this-setting?rq=1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:36:28.713

当您将项目添加到解决方案时，它们将在解决方案打开时被加载。

如果使用源代码管理，如果此类解决方案已更新并包含新项目，它们将被加载。

解决这个问题的一种方法是创建多个解决方案——只有相关项目的解决方案。这些解决方案*可以*是源代码管理的一部分，但不是必须的，但如果您不将它们添加到源代码管理中，您可能会在源代码管理中拥有只有您拥有解决方案引用的项目。

# python - 在子进程之前写出

> ID：13108435
> 
> 赞同：3
> 
> 时间：2012-10-28T11:33:10.140
> 
> 标签：python, io, subprocess

我有一个使用子进程启动多个进程的脚本。现在我想写一个日志文件，其中包含我自己的输出和子进程的输出。

```
log = open(LOG,'w')
for tasks in tasklist:
  log.write('log text')
  ... some code and log text ...
  sp = subprocess('task[0]',stdout=log)
  sp.wait()
  log.write('log text')
  sp = subprocess('task[1]',stdout=log)
  sp.wait()
  log.write('log text')
  sp = subprocess('task[2]',stdout=log)
  sp.wait()
  log.write('log text') 
```

现在它将子进程的输出写入顶部，然后是我写的所有内容。在我每次开始子进程之前，有没有更好的方法来关闭并重新打开文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:34:31.403

您需要在每次写入时刷新 python 缓冲区：

```
log.write('log text')
log.flush() 
```

子进程*不*缓冲它们的写入，因此它们的数据在 python 写入之前最终在日志文件中。Python 的写入最终进入它的缓冲区，并且在该缓冲区已满之前不会被刷新。

# eclipse - 如何在 Eclipse 中刷新更新站点

> ID：13108438
> 
> 赞同：6
> 
> 时间：2012-10-28T11:33:41.020
> 
> 标签：eclipse, eclipse-plugin, update-site

目前，如果我更改 Eclipse 更新站点的内容，我必须重新启动 Eclipse 才能看到新内容。有没有不重启的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-29T02:10:26.447

1.  打开偏好页面
2.  选择安装/更新 > 可用软件站点。
3.  选择要刷新的更新站点，然后按 [Reload] 按钮。

# python - 客户端和服务器无法交换数据python

> ID：13108441
> 
> 赞同：2
> 
> 时间：2012-10-28T11:34:12.310
> 
> 标签：python, sockets

我正在使用python 3.3。这是Server.py。一切都很好，服务器和客户端都能够连接这里可能有问题'tcpcli.send('[%s]%s'%(bytes(ctime() ,'utf-8'),data))'.帮帮我

```
from socket import *
from time import ctime

HOST=''
PORT=21567
BUFSIZ=1024
ADDR=(HOST,PORT)

tcp=socket(AF_INET,SOCK_STREAM)
tcp.bind(ADDR)
tcp.listen(5)

while True:
    print('waiting for connection')
    tcpcli,addr=tcp.accept()
    print('...connected from:',addr)

    while True:
        data=tcpcli.recv(BUFSIZ)
        if not data:
            break
        tcpcli.send('[%s]%s'%(bytes(ctime(),'utf-8'),data))
    tcpcli.close()
tcp.close() 
```

这是客户端.py

```
 from socket import *

HOST='127.0.0.1'
PORT=21567
BUFSIZ=1024
ADDR=(HOST,PORT)

tcpcli=socket(AF_INET,SOCK_STREAM)
tcpcli.connect(ADDR)

while True:
    data=input('>')
    if not data:
        break
    tcpcli.send(data)
    data=tcpcli.recv(BUFSIZ)
    if not data:
        break
    print (data.decode('utf-8'))

tcpcli.close() 
```

当我同时运行它们时，它们工作正常，除了我无法从客户端发送任何数据。我收到此错误消息。

```
tcpcli.send(data)
TypeError: 'str' does not support the buffer interface 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:39:06.603

您正在使用 Python3。这意味着，当使用 CLI 时，`input()`将返回一个`str`对象（相当于 python2 `unicode`）。它包含您输入的字符的 unicode 代码点的内部表示。要通过字节流接口（例如管道、套接字等）发送数据，您必须将其转换为字节对象。这很容易通过选择编码（例如 UTF-8）并执行以下操作来完成：

```
data_raw = data.encode("utf-8")
tcpcli.send(data_raw) 
```

您将不得不类似地调整您的服务器代码，首先解码您从客户端收到的数据并在对其进行字符串操作后重新编码：

```
 data_decoded = data.decode("utf-8")
        reply = '[%s]%s' % (ctime(), data_decoded)
        tcpcli.send(reply.encode("utf-8")) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T11:39:18.267

您正在构建 unicode 字符串，而不是字节字符串，并且套接字接口不支持 unicode 字符串。您需要对字符串插值的*结果进行编码：*

```
 tcpcli.send(bytes('[%s]%s' % (ctime(),data), 'utf-8')) 
```

# c# - 如何在 Visual Studio 2010 中将现有 c# 资源设置为默认资源？

> ID：13108443
> 
> 赞同：1
> 
> 时间：2012-10-28T11:34:20.830
> 
> 标签：c#, visual-studio-2010

我已经导入了一个项目，但是当我导入它时，该项目已被 Visual Studio 2010 转换。

我的问题是 VS 无法识别资源文件，并且将其翻译为默认资源文件。

后果之一是，当我添加一种新语言时，VS 不会将资源添加为卫星......

如何再次将资源文件设置为默认资源？

到目前为止，我手动编辑 Csproj 以添加我的本地化资源文件。

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T12:47:45.823

卸载 csproj 并以这种方式编辑每种语言的 xml：

```
<Compile Include="Resources\Resource.Designer.cs">
  <AutoGen>True</AutoGen>
  <DesignTime>True</DesignTime>
  <DependentUpon>Resource.resx</DependentUpon>
</Compile>
<Compile Include="Resources\Resource.en-US.Designer.cs">
  <AutoGen>True</AutoGen>
  <DesignTime>True</DesignTime>
  <DependentUpon>Resource.en-US.resx</DependentUpon>
</Compile> 
```

请注意，我已将所有资源文件移动到 Resource 文件夹中，如果不是您的情况，请`Resources\`从 xml 中删除。对于每个 resx，您也应该`access modifier`设置`public`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T17:12:46.923

尝试删除资源文件。然后右键单击您的项目，选择添加现有项目并选择您的 .resx 文件。可能这会奏效。

# java - 数组和“空”我可以删除它吗？它会影响随机数生成器吗

> ID：13108454
> 
> 赞同：-1
> 
> 时间：2012-10-28T11:35:32.403
> 
> 标签：java, arrays, null

我只是想知道有没有办法在使用 for 循环输出空格时输出“null”？

例如，我有一个类型对象的二维数组，当显示数组时，我想显示前三个元素，然后跳过 10 个空格，然后打印另外三个元素。

另外，如果我要使用随机生成器随机选择数组元素，空元素会影响这个吗？

主要的：

```
public class CinemaSystem {

    public static void main(String[] args) {
        Seat cinemaactual = new Seat("Cinema");
        Seat[][] cinema = new Seat[12][23];

        Ticket ticket = new Ticket();
        Scanner scan = new Scanner(System.in);
        String answer, contiune;

        int number, check = 0, category, id;

        do {
            System.out.print("Welcome to the Theatre Booking System. (QUIT to exit)"
                    + "\nWould you like to purchase tickets or list available seats?"
                    + "(/Purchase/List/Help)");
            answer = scan.nextLine();

            if (answer.equalsIgnoreCase("purchase")) {
                do {

                    System.out.println("Please choose the cateogry of ticket "
                            + "you would like, followed by who the ticket is for"
                            + "and the amount required. (separated by a space)\n"
                            + "1\. Gold\n2\. Silver\n3\. Bronze\n\n1\. Adult\n2."
                            + " Child\n3\. Concession");
                    category = scan.nextInt();
                    number = scan.nextInt();
                    id = scan.nextInt();
                    if (category == 1 || category == 2 || category == 3 && id == 1 || id == 2 || id == 3) {
                        ticket.SetType(category);
                        if (category == 1) {
                            ticket.SetName("Gold");
                        } else if (category == 2) {
                            ticket.SetName("Siler");
                        } else {
                            ticket.SetName("Bronze");
                        }
                        ticket.SetNumber(number);
                        ticket.SetID(id);
                        if (id == 1) {
                            ticket.SetCategory("Adult");
                        } else if (id == 2) {
                            ticket.SetCategory("Child");
                        } else {
                            ticket.SetCategory("Bronze");
                        }
                        System.out.print("You have selected"
                                + ticket.GetNumber() + " " + ticket.GetName()
                                + " ticket(s) at the" + ticket.GetCategory() + " price .");

                        ticket.BuyTicket(category, id, number);
                    } else {
                        System.out.print("Sorry, incorrect input, please enter an apropriate value.");
                        check = scan.nextInt();
                    }
                } while (check == 0 || check > 3);

                do {
                    System.out.print("Would you like to perchase more tickets? (Yes/No)");
                    contiune = scan.nextLine();
                } while (contiune.equalsIgnoreCase("Yes"));
            } else if (answer.equalsIgnoreCase("list")) {
                cinemaactual.CreateTheatre(cinema);
                cinemaactual.DisplayTheatre(cinema);
            } else if (answer.equalsIgnoreCase("help")) {
                // Code for help
            } else if (answer.equalsIgnoreCase("quit")) {
                System.exit(-1);
            }

            System.out.print("Sorry, incorrect input please enter"
                    + " a valid input (Purchase/List/Help or QUIT to exit");
            answer = scan.nextLine();

        } while (!answer.equalsIgnoreCase("purchase")
                || !answer.equalsIgnoreCase("List")
                || !answer.equalsIgnoreCase("help")
                || !answer.equalsIgnoreCase("quit"));
    }
} 
```

生成数组的类中的方法：

```
public Seat[][] CreateTheatre(Seat[][] x) {
for (int row = 0; row < 8; row++) {
    for (int col = 0; col < 4; col++) {
        x[row][col] = new Seat("B");
    }
}

for (int row = 8; row < 12; row++) {
    for (int col = 0; col < 4; col++) {
        x[row][col] = new Seat("S");
    }
}

for (int row = 0; row < 8; row++) {
    for (int col = 19; col < 23; col++) {
        x[row][col] = new Seat("B");
    }
}

for (int row = 8; row <12; row++){
    for (int col = 19; col < 23; col++) {
        x[row][col] = new Seat("S");
    }
}

for (int row = 3; row < 5; row++) {
    for (int col = 4; col < 9; col++) {
        x[row][col] = new Seat("B");
    }
}

for (int row = 3; row < 5;row++){
    for (int col = 14; col < 19; col++) {
        x[row][col] = new Seat("S");
    }
}

for (int row = 9; row < 12; row++) {
    for (int col = 7; col < 4; col++) {
        x[row][col] = new Seat("S");
    }
}

for (int row = 3; row < 5; row++) {
    for (int col = 14; col < 20; col++) {
        x[row][col] = new Seat("B");
    }
}

for (int row = 5; row < 9; row++) {
        for (int col = 4; col < 9; col++){
        x[row][col] = new Seat("S");
    }
}

for (int row = 5; row < 9; row++) {
    for (int col = 14; col < 20; col++) {
        x[row][col] = new Seat("S");
    }
}

for (int row = 6; row < 9; row++) {
    for (int col = 9; col < 14; col++) {
        x[row][col] = new Seat("G");
    }
}

for (int row = 9; row < 12; row++) {
    for (int col = 7; col < 16; col++) {
        x[row][col] = new Seat("G");
    }
}
return x;
} 
```

对于数组的显示：

```
public void DisplayTheatre(Seat[][] x) {
    for (int row = 0; row < x.length; row++) {
        for (int col = 0; col < x[row].length; col++) {
            System.out.print(x[row][col] + "  ");
        }
        System.out.println();
    }
} 
```

只是想知道我是否可以删除空值，因为我希望显示一些对象，然后在中间显示空白，然后在同一行上再显示一些。

空元素是否会干扰从数组中随机选择元素，例如是否会随机选择空元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:40:44.910

如果我理解你的要求。下面是您正在寻找的东西。

```
 String[] arr = new String[5];
       arr[0]="2";
       arr[1]="3";
       arr[4]="5";
       for(int i=0; i<arr.length; i++){
           if(arr[i]==null){
               System.out.println(' ');
           }
           else {
               System.out.println(arr[i]);
           }
       } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T12:41:48.747

> 另外，如果我要使用随机生成器随机选择数组元素，空元素会影响这个吗？

如果某些元素为空，那么随机选择一个元素有时会不可避免地给你一个空值。

您可以尝试通过再次尝试使用新的随机数来处理这个问题......直到您获得一个非空元素。但如果数组稀疏，这可能会很昂贵。如果*所有*元素都为空，它可能会给你一个无限循环。

（但不要只从初始随机位置搜索非空元素......因为这会给出有偏差的选择。）

* * *

然而，更好的解决方案是有一个单独的列表，其中只包含未占用的座位（或其他）。

理想的影院预订系统不会随意分配座位。相反，它会尝试有条不紊地填满……这样即使吉姆和他的女朋友买了最后两张票，他们也有很好的机会坐在一起。

# c++ - 对虚函数和派生类的混淆

> ID：13108460
> 
> 赞同：4
> 
> 时间：2012-10-28T11:36:14.933
> 
> 标签：c++, virtual-functions, name-hiding

我试图理解以下代码：

```
#include<iostream>
using namespace std;
class Base {
    public:
        virtual void f(float) { cout << "Base::f(float)\n"; }
};
class Derived : public Base {
    public:
        virtual void f(int) { cout << "Derived::f(int)\n"; }
};
int main() {
    Derived *d = new Derived();
    Base *b = d;
    d->f(3.14F);
    b->f(3.14F);
} 
```

这打印

```
Derived::f(int)
Base::f(float) 
```

我不确定为什么。

第一次调用 d->f(3.14F) 调用 Derived 中的函数 f。我不是 100% 确定为什么。我看了一下这个（http://en.cppreference.com/w/cpp/language/implicit_cast），上面写着：

> 浮点类型的纯右值可以转换为任何整数类型的纯右值。小数部分被截断，即小数部分被丢弃。如果该值不适合目标类型，则行为未定义

对我来说，你不能这样做，因为浮点数不适合 int。为什么允许这种隐式转换？

其次，即使我只是接受上述内容没问题，对 b->f(3.14F) 的第二次调用也没有意义。b->f(3.14F)是调用虚函数f，所以这被动态解析为调用b所指向的对象的动态类型关联的f()，这是一个Derived对象。由于我们被允许将 3.14F 转换为 int，因为第一个函数调用表明这是合法的，所以 this（据我的理解）应该再次调用 Derived::f(int) 函数。然而，它调用了 Base 类中的函数。那么这是为什么呢？

编辑：这就是我想出来并向自己解释的方式。

b 是指向 Base 对象的指针，因此我们只能使用 b 访问 Base 对象的成员，即使 b 确实指向某个 Derived 对象（这是标准的 OO/继承内容）。

此规则的唯一例外是当 Base 的成员函数被声明为虚拟时。在这种情况下，派生对象可能会**覆盖此函数，通过使用****完全相同的签名**提供另一种实现。如果发生这种情况，即使我们碰巧通过指向 Base 对象的指针访问成员函数，也会在运行时调用这个 Derived 实现。

现在，在上面的代码片段中，我们没有发生任何覆盖，因为 B::f 和 D::f 的签名不同（一个是浮点数，另一个是整数）。所以当我们调用 b->f(3.14F) 时，唯一考虑的函数就是原来的 B::f，也就是被调用的函数。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-28T11:40:31.017

这两个函数有不同的签名，所以`f`in`derived`不会覆盖 in 中的虚函数`base`。仅仅因为类型`int`和`float`可以隐式转换在这里没有效果。

```
virtual void f(float) { cout << "Base::f(float)\n"; }
virtual void f(int) { cout << "Derived::f(int)\n"; } 
```

使用 C++11 中的 new 关键字可以看到正在发生的事情的线索`override`，这对于减少此类错误非常有效。

```
virtual void f(int) override { cout << "Derived::f(int)\n"; } 
```

gcc 从中产生错误：

> virtual void Derived::f(int)' 标记覆盖，但不覆盖

铛

> 错误：“f”标记为“覆盖”但不覆盖任何成员函数

[http://en.cppreference.com/w/cpp/language/override](http://en.cppreference.com/w/cpp/language/override)

编辑：

对于第二点，您实际上可以公开`float`重载`base`，`derived`其中公开了一个隐式兼容的成员函数。像这样：

```
class Derived : public Base {
public:
    using Base::f;
    virtual void f(int) { cout << "Derived::f(int)\n"; }
}; 
```

现在将浮点数传递给成员函数会`f`更接近基中定义的函数并产生：

```
Base::f(float)
Base::f(float) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T11:54:42.973

考虑隐藏的简单方法如下 - 查看 d->f(3.14F); 从示例中：

1.  编译器的第一步是选择一个类名。成员函数名称 f 用于执行此操作。不使用参数类型。选择派生。
2.  编译器的下一步是从该类中选择一个成员函数。使用参数类型。无效派生::f(int); 是 Derived 类中唯一具有正确名称和参数的匹配函数。
3.  从 float 到 int 的缩小类型转换正在发生。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T11:47:34.947

由于这两个函数的参数类型不同，`Derived`类中的那个实际上并没有覆盖`Base`. 而是`Derived::f`隐藏`Base::f`（目前我没有标准，所以我不能引用该章）。

这意味着当您调用时`d->f(3.14f)`，编译器甚至不会考虑`B::f`. 它解决了对 的调用`D::f`。但是，当您调用 时`b->f(3.14f)`，编译器可以选择的唯一版本是`B::f`as`D::f`不会覆盖它。

你的阅读`If the value can not fit into the destination type, the behavior is undefined`是错误的。它说的是*价值*而不是类型。所以值 3.0f 确实适合 int，但 3e11 不适合。在后一种情况下，行为是未定义的。您的报价的第一部分`A prvalue of floating-point type can be converted to prvalue of any integer type.`解释了为什么`d->f(3.14f)`解析为`D::f(int)`- float 确实可以转换为整数类型。

# javascript - 如何监控从我的服务器加载图像的时间和位置？

> ID：13108462
> 
> 赞同：1
> 
> 时间：2012-10-28T11:36:20.867
> 
> 标签：javascript, image, ip, server-side-scripting, spying

几乎我们所有人都听说过像[spypig](http://spypig.com)这样的服务。我想知道当加载来自服务器的图像时，他们如何跟踪客户端的 IP。为此，我制作了一个 aspx 页面，`Response.ContentType = "image/png"`但为此我的链接为

www.something.com/imagePage.aspx?id=rndmval

有没有什么方法可以让我的服务器上的图像说“mysite.com/images/me.gif”被加载到系统上，我会收到该系统的IP通知？它类似于监控图像。我喜欢 spypig 的工作方式，它可以在任何浏览器上加载图像时监控图像。有人知道他们是怎么做到的吗？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T11:43:18.220

您收到请求，从请求中提取客户端的 IP 地址（不知道如何在 ASP 中做到这一点，但肯定有办法做到这一点）并将其存储在数据库中 / 发送电子邮件 / 其他任何东西。 .

无需设置`Content-type`为`image/png`，这只是告诉浏览器（谁在期待图像）“这是您的图像”的一种更好的方式，但除非您返回实际的 1x1 PNG 图像，否则它没有多大意义。

## 更新

IP 地址应包含在：

```
Request.ServerVariables("remote_addr") 
```

如果你想要一个“干净”的 url，比如`http://example.com/path/to/image.gif`，你必须在 webserver-side 做一些事情；PHP中使用的一种常见技巧是使Web服务器“重写”`/path/to/non-existent/file`对类似的请求`/path/to/my/script.php?path=/path/to/non-existent/file`，但不确定如何使用ASP / IIS做到这一点......

## 更新：spypig 是如何工作的

他们给你一个“要放入电子邮件的图像”，即`<img>`一个指向他们服务器上某个页面的标签，`src=""`在其名称中包含一个唯一标识符，例如：

```
http://example.com/track-user.asp?id=ABCD12345678 
```

一旦用户打开包含图像的电子邮件（请注意，大多数电子邮件程序要求用户在实际加载图像之前单击“加载外部内容” - 即一种反跟踪措施），一个请求被发送到服务器，该服务器在某处存储包含 id、日期、IP 地址和任何其他有趣信息的记录。

知道您将某个 ID 发送给了谁，您就可以跟踪打开的电子邮件。

（让用户点击“加载外部图像”的一个常见技巧是发送一封非常需要图像才能正确显示的电子邮件，因此鼓励用户加载它们 - 并被跟踪）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T11:48:45.303

快速查看这个 spypig.com，似乎当你创建一个图像时，它被赋予了一个唯一的 ID。此 ID 然后存储在数据库中，当有人稍后输入此图像时，系统可以将此唯一 ID 与必须通知的电子邮件地址相匹配。

跟踪 IP 实际上要简单得多。HTTP 在 TCP/IP 之上工作，因此您始终知道客户端的地址是什么（尽管它可能是防火墙/NAT/欺骗地址）。

在 ASP 中这可能很有用：[How to get a user's client IP address in ASP.NET?](https://stackoverflow.com/questions/735350) 但几乎任何 HTTP 服务器端技术都可以让您访问这些信息。看看我的网络浏览器在加载图像时发送了多少（任何电子邮件客户端都会提供类似的信息）：

```
GET /rndmVal/img.gif HTTP/1.1
User-Agent: Opera/9.80 (X11; Linux i686; U; pl) Presto/2.10.229 Version/11.64
Host: localhost:8080
Accept: text/html, application/xml;q=0.9, application/xhtml+xml, image/png, image/webp, image/jpeg, image/gif, image/x-xbitmap, */*;q=0.1
Accept-Language: pl-PL,pl;q=0.9,en;q=0.8
Accept-Encoding: gzip, deflate
Cache-Control: no-cache
Connection: Keep-Alive 
```

客户端计算机的 IP 地址可以通过 TCP/IP 连接获得。

# android - 存在不同情况的资源

> ID：13108465
> 
> 赞同：11
> 
> 时间：2012-10-28T11:36:38.503
> 
> 标签：android, eclipse

由于一个奇怪的错误，我无法构建我的 android 应用程序：

> 说明 资源路径位置类型 由于“存在不同情况的资源：'/ProjectName/bin/classes/com/Name/ProjectName'。”，因此未构建项目。修复问题，然后尝试刷新此项目并构建它，因为它可能是不一致的 ProjectName Unknown Java Problem

我的文件结构如下： http: [//pastebin.com/6P6mEftD](http://pastebin.com/6P6mEftD)

我检查了具有几乎相同名称的文件，但找不到任何文件。这在先前提出的描述相同错误的问题中被标记为解决方案。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-10-31T20:16:31.453

我有相同的“资源存在不同的情况”错误。

我必须做的修复是在 AndroidManifest.xml 文件中。清单 XML 标记中的“包”参数与 Java 文件中的包名称不完全匹配。我建议您查看清单 XML，看看您是否在那里发现了命名问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-13T19:22:16.487

我刚遇到这个错误，我研究了很多来解决它。

它是这样的：

您可能找到的所有答案都可能是正确的，因为它有不同的原因。要解决此问题，您必须查看“gen”文件夹中生成的“R.java”。

打开它后，查找两个具有相同名称但用不同大小写编写的类。示例（我的）：“字符串”...“字符串”

然后，你会发现你错过了一些拼写的东西。您永远不会使用大写字母来调用 xml 文件中的字符串。

示例：android:contentDescription="@+String/imageView2"
不要用大写 S 编写字符串。

采用：

android:contentDescription="@+string/imageView2" 代替。

找到字符串后，您需要使用 find 命令找到放置它的位置。更正“语法”后，只需清理您的项目。

豌豆。

三甲基丙烯酸甲酯。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T12:20:13.477

尝试删除 bin 文件夹和“清理项目”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-12T19:02:52.703

我有这个问题。我关注 Pauland 并删除了我的 bin 文件夹。但是什么也没发生。然后我关闭了项目，它打开了，没有任何错误了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-11T07:24:12.290

确保包名称在 Android Manifest 和源代码中完全相同

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-14T10:46:15.003

我将项目“src”文件从一个项目复制到另一个项目。在那里，我将项目文件夹重命名为 (com\company\projectName) 时犯了一个错误。项目文件夹名称应全部小写。然后我删除了 bin & gen 文件夹并重建了项目。可以了，好了。

希望这可以帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-07-21T15:52:42.793

我通过删除***目标***目录下的所有文件并让自动重建执行来修复它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-01-19T05:47:34.727

我修改了我的 AndroidManifest.xml，但是当我尝试重建时它以某种方式被回滚。

比我尝试使用“重构>重命名”从 gen 文件夹中编辑类名。

我将班级名称从 xxxxLib 更改为 xxxlib（小写）。

它解决了我的问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-03-16T10:18:58.877

**1_**将清单 XML 标记中的“package”参数与 Src Java 文件中的包名称完全匹配。

com.example.myapp**不是**com.example.MyApp

**2_**删除Gen文件夹中的所有东西

**3_**项目 -> 清理

享受**:)**

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-05-27T21:51:50.557

我的问题是 `AndroidManifest.xml`文件中定义的包名不正确，记住包名区分大小写，然后只是`Clean`>`Build Project`

更新：有时需要对删除文件夹的项目进行“硬重置” `/gen`，`/bin`然后 `Build Project`

# jsp - servlet 应用程序中的 Unicode 字符显示为问号

> ID：13108466
> 
> 赞同：2
> 
> 时间：2012-10-28T11:36:47.573
> 
> 标签：jsp, servlets, character-encoding, internationalization, jstl

最近我根据[如何国际化 Java Web 应用程序实现了国际化？](https://stackoverflow.com/questions/4276061/how-to-internationalize-a-java-web-application).

但是现在我在某些页面中遇到了问题。如果是英语，则显示良好，但如果我们选择任何其他语言，则该页面中的所有值都显示为`?????????`。

![图片](../Images/4c086e772b86fb29a942287333b149fd.png)

我检查了服务器日志中的异常，但找不到任何人。

这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T12:46:05.173

看到`??????`而不是可理解的字符（甚至不是[Mojibake](http://en.wikipedia.org/wiki/Mojibake)）通常表明负责的数据传输本身非常了解源和目标中使用的编码。在一般的 Web 应用程序中，只有 2 个地方会出现这种情况：通过 JDBC 将数据传输到/从 DB 传输的时间点以及将数据传输到 HTTP 响应的时间点`response.getWriter()`（由 JSP 隐式使用） .

在您使用属性文件的特殊情况下，没有数据库，因此 HTTP 响应仍然是主要嫌疑人。如果没有指示服务器使用 UTF-8 来解码写入 HTTP 响应的字符，而是使用某些平台默认编码（最常见的是 ISO-8859-1），则可能会发生此问题。这样，ISO-8859-1 未[涵盖](http://en.wikipedia.org/wiki/ISO_8859-1#Codepage_layout)的源代码中的任何字符都将变成问号。由于 ISO-8859-1 专门用于拉丁字符，因此这将影响*所有*非拉丁字符，例如中文、日文、阿拉伯文、西里尔文、希伯来文、梵文等。它们都将被写成问号。

这可以通过将以下内容添加到 JSP 的最顶部来针对每个 JSP 进行修复：

```
<%@page pageEncoding="UTF-8" %> 
```

*（请注意，您确实需要将其放入**每个**JSP 以及包含文件中！）*

或者，更好的是，通过将以下条目添加到 webapp 来在应用程序范围内修复它`web.xml`：

```
<jsp-config>
    <jsp-property-group>
        <url-pattern>*.jsp</url-pattern>
        <page-encoding>UTF-8</page-encoding>
    </jsp-property-group>
</jsp-config> 
```

### 也可以看看：

*   [Unicode - 如何让字符正确？](http://balusc.blogspot.com/2009/05/unicode-how-to-get-characters-right.html)
*   [如何将 Unicode 字符作为 JSP/Servlet request.getParameter 传递？](https://stackoverflow.com/questions/10517268/how-to-pass-unicode-characters-as-jsp-servlet-request-getparameter)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T15:10:12.287

实际上，在发送响应之前，我们在 servlet 中缺少一行。

即我们忘记设置内容类型。

这是要包含在 servlet 中的代码

```
response.setContentType("text/html;charset=UTF-8"); 
```

谢谢

# c# - 在 mvvm 中选择的列表框第一项

> ID：13108468
> 
> 赞同：1
> 
> 时间：2012-10-28T11:36:58.277
> 
> 标签：c#, xaml, mvvm, silverlight-4.0

我是 mvvm 的新手。我的 silverlight 应用程序中有一个列表框，它绑定到视图模型中的一个可观察集合，我想制作一个选择第一个项目的列表框。我厌倦了这个，但它不起作用。

```
<ListBox Height="431" Canvas.Left="17" Canvas.Top="77" Width="215" FontSize="13" ItemsSource="{Binding Path=Categorys, Mode=TwoWay}" DataContext="{Binding}" SelectedItem="{Binding CurrentCategory, Mode=TwoWay}" ItemTemplate="{StaticResource CategoryDataTemplate}" ScrollViewer.HorizontalScrollBarVisibility="Disabled" Name="lst_category"> 
```

然后我在主页视图模型的主页加载中添加了这个

```
CurrentCategory = Categorys[0]; 
```

谁能帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:44:00.687

执行以下步骤：

1.  确保集合`Categorys`已填满。您可能需要使用[AsycCTP、使用 Async 和 Await 进行异步编程](http://msdn.microsoft.com/en-us/library/hh191443.aspx)或其他一些机制来首先等待集合被填充。

    > [await](http://msdn.microsoft.com/en-us/library/hh156528.aspx)运算符应用于异步方法中的任务，以暂停该方法的执行，直到等待的任务完成。任务代表正在进行的工作。

2.  `INotifyPropertyChanged`在 ViewModel 中实现公开`Property`， 并从中`CurrentCategory`引发 PropertyChanged 事件。`Setter``Property`

    ```
    private Category _currentCategory = null;

    public Category CurrentCategory 
    {
        get { return _currentCategory; }
        set
        {
            if (_currentCategory != value)
            { 
                _currentCategory = value;

                // Update bindings
                RaisePropertyChanged("CurrentCategory");
            }
        }
    } 
    ```

现在您可以使用相同的代码：

```
CurrentCategory = Categorys[0]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T12:37:23.393

尝试使用`ICollectionView`和`IsSynchronizedWithCurrentItem`。CollectionView 具有您需要的所有功能。例如`MoveToFirst()`.

xml:

```
<ListBox ItemsSource="{Binding Categories}" 
                 DisplayMemberPath="Name" 
                 IsSynchronizedWithCurrentItem="True" /> 
```

视图模型：

```
 public class ViewModel :INotifyPropertyChanged
        {
            private ObservableCollection<Category> _categories = new ObservableCollection<Category>();
            private Category _currentCategory;

            public ObservableCollection<Category> Categories
            {
                get { return _categories; }
                set { _categories = value; OnPropertyChanged("Categories");}
            }

            public Category CurrentCategory
            {
                get { return _currentCategory; }
                set { _currentCategory = value; OnPropertyChanged("CurrentCategory");}
            }

            public ICollectionView CategoriesView { get; private set; }

            public ViewModel()
            {
                Categories.Add(new Category{Id = Guid.NewGuid(), Name = "Cat1"});
                Categories.Add(new Category{Id = Guid.NewGuid(), Name = "Cat2"});
                Categories.Add(new Category{Id = Guid.NewGuid(), Name = "Cat3"});

                CategoriesView = CollectionViewSource.GetDefaultView(Categories);
                CategoriesView.CurrentChanged += OnCategoriesChanged;
                CategoriesView.MoveCurrentToFirst();
            }

            private void OnCategoriesChanged(object sender, EventArgs e)
            {
                var selectedCategory = CategoriesView.CurrentItem as Category;
                if (selectedCategory == null) return;

                CurrentCategory = selectedCategory;
            }

            public event PropertyChangedEventHandler PropertyChanged;

            protected virtual void OnPropertyChanged(string propertyName)
            {
                PropertyChangedEventHandler handler = PropertyChanged;
                if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName));
            }
        }

        public class Category
        {
            public Guid Id { get; set; }

            public string Name { get; set; }
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-01T05:26:56.603

你也应该尝试这种方式........

列表 c = 新列表

```
CurrentCategory = c.firstOrDefault() 
```

# c# - Ninject 表格 说明

> ID：13108472
> 
> 赞同：0
> 
> 时间：2012-10-28T11:37:31.470
> 
> 标签：c#, visual-studio-2010, ninject

我有一个`ModuleLoader : NinjectModule`绑定所有东西的地方。

首先我使用

```
Bind<Form>().To<Main>(); 
```

将 a 绑定`System.Windows.Forms.Form`到我的`Main`表单。

它是否正确？

其次在 Program.cs 我使用这个：

```
 _mainKernel = new StandardKernel(new ModuleLoader());
 var form = _mainKernel.Get<Main>(); 
```

`_mainKernel`ninject 标准内核在哪里。

然后我用`Application.Run(form)`

它是否正确？

我不确定在`Windows.Forms`.

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T21:29:29.300

你不应该真的绑定到`System.Windows.Forms.Form`. Ninject 主要用于将接口绑定到具体类型，以便您可以将依赖项作为接口传递并在运行时/测试期间切换具体实现。

但是，如果您只想使用 Ninject 以这种方式创建表单，则只需使用`Bind<MyForm>().ToSelf()`then do `kernel.Get<MyForm>()`。如果您直接请求具体类型并且它不需要任何依赖项，那么使用 Ninject 对其进行初始化没有多大意义。

在您的情况下，如果您的表单实现了一个接口，那么您会这样做：`Bind<IMainForm>().To<MainForm>()`并向 Ninject 请求接口类型。通常，您的界面不应该绑定到“表单”的概念，但它应该与实现无关（因此稍后您可以生成 CLI 和网站版本并简单地交换 Ninject 绑定）。

您可以使用 Model-View-Presenter 设计模式（或变体）来实现这一点，例如：

```
public interface IUserView
{
    string FirstName { get; }
    string LastName { get; }
}

public class UserForm : IUserView, Form
{
    //initialise all your Form controls here

    public string FirstName
    {
        get { return this.txtFirstName.Text; }
    }

    public string LastName
    {
        get { return this.txtLastName.Text; }
    }
}

public class UserController
{
    private readonly IUserView view;

    public UserController(IUserView view)
    {
        this.view = view;
    }

    public void DoSomething()
    {
        Console.WriteLine("{0} {1}", view.FirstName, view.LastName);
    }
}

Bind<IUserView>().To<UserForm>();
Bind<UserController>().ToSelf();

//will inject a UserForm automatically, in the MVP pattern the view would inject itself though    
UserController uc = kernel.Get<UserController>(); 
uc.DoSomething(); 
```

# php - 上传验证，允许其他扩展？

> ID：13108476
> 
> 赞同：-3
> 
> 时间：2012-10-28T11:37:59.503
> 
> 标签：php

目前我已经允许上传 .jpg 文件。

如何添加 jpeg、gif 和 png？

我当前的代码如下...

```
$filename = basename($_FILES['photo']['name']);
            $ext = substr($filename, strrpos($filename, '.') + 1);

            //Check if the file is JPEG image and it's size is less than 5Mb
$allowedExts = array('jpg', 'jpeg', 'gif', 'png');
            if ( (in_array($ext, $allowedExts)) && ($_FILES["photo"]["type"] == "image/jpeg") && ($_FILES["photo"]["size"] <= 5242880) ){
                //Determine the path to which we want to save this file
                $newname = str_replace( ' ', '_', trim( strip_tags( $_POST['name'] ) ) ) . _ . $formKey->generateKey() . '_' . time() . '.jpg'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:44:37.457

制作一组允许的扩展名，并对其进行检查。看看[http://php.net/manual/en/function.in-array.php](http://php.net/manual/en/function.in-array.php)。

你会以类似的方式结束：

```
$allowedExts = array('jpg', 'jpeg', 'gif'); // Add more here
if (in_array($ext, $allowedExts))
{
    // Do something here
} 
```

另外，要检查文件的扩展名，我建议您使用 pathinfo：[http://php.net/manual/en/function.pathinfo.php](http://php.net/manual/en/function.pathinfo.php) 有些人可以通过上传以 .jpg 结尾的文件来欺骗您，但这可能是 .php 文件。

[编辑]更新，因为我讨厌迷你评论：

```
 $allowedExtensions = array("image/jpeg", "image/png", "image/gif", "image/pjpeg", "image/jpg");
   $pathInfo = pathinfo($_FILES["photo"]["type"]);
   if (in_array($pathInfo['extension'], $allowedExtensions))
   {
       // Do stuff
   } 
```

Waaaay这种方式更简单。这甚至可以通过使用 pathinfo 的第二个参数来简化，但我假设您之后需要数组的其他元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-01T13:34:10.770

您可以使用以下内容：

```
if(file_exists($path_image) && in_array(exif_imagetype($path_image),array(1, 2, 3, 6))){ ... } 
```

[http://php.net/manual/en/function.exif-imagetype.php](http://php.net/manual/en/function.exif-imagetype.php)

# javascript - d3.js - 如何自动计算径向树状图中的弧长

> ID：13108478
> 
> 赞同：18
> 
> 时间：2012-10-28T11:38:21.013
> 
> 标签：javascript, svg, d3.js, dendrogram, bundle-layout

我正在创建 Mike Bostock 的分层边缘捆绑图的修改版本：

[http://mbostock.github.com/d3/talk/20111116/bundle.html](http://mbostock.github.com/d3/talk/20111116/bundle.html)

但我想制作跨越某些数据组的弧线，如下所示：

![在此处输入图像描述](../Images/eeeecd057f8ffeb3d09c89693381fc4e.png)

我目前只是硬编码弧的长度，但我想动态地做。我怎样才能做到这一点？这是我当前的代码：

```
/* MH - USER DEFINED VARIABLES */
var chartConfig = { "Tension" : .85, "canvasSize" : 800, "dataFile" : "../data/projects.json", "linePadding" : 160, "textPadding" : 30, "arcPadding" : 5, "arcWidth" : 30 }
var pi = Math.PI;

var radius = chartConfig.canvasSize / 2,
    splines = [];

var cluster = d3.layout.cluster() //Cluster is the diagram style, a node to link dendrogram dendrogram (tree diagram)
    .size([360, radius - chartConfig.linePadding]); //MH - sets the size of the circle in relation to the size of the canvas

var bundle = d3.layout.bundle(); //Bundles the node link lines so that they spread at the end but keep close initially

var arcInner = radius - chartConfig.linePadding + chartConfig.arcPadding;
var arcOuter = arcInner + chartConfig.arcWidth;
var arc = d3.svg.arc().innerRadius(arcInner).outerRadius(arcOuter);

var line = d3.svg.line.radial()
    .interpolate("bundle")
    .tension(chartConfig.Tension) //How tightly to bundle the lines. No tension creates straight lines
    .radius(function(d) { return d.y; })
    .angle(function(d) { return d.x / 180 * Math.PI; });

var vis = d3.select("#chart").append("svg")
    .attr("width", radius * 2)
    .attr("height", radius * 2)
    .attr("class","svg")
    .append("g")
    .attr("class","chart")
    .attr("transform", "translate(" + radius + "," + radius + ")");

d3.json(chartConfig.dataFile, function(classes) {
  var nodes = cluster.nodes(packages.root(classes)),
      links = packages.imports(nodes),
      splines = bundle(links);

  var path = vis.selectAll ("path.link")
      .data(links)
      .enter().append("path")
      .attr("class", function(d){ return "link source-" + d.source.key + " target-" + d.target.key; })
      .attr("d", function(d,i){ return line(splines[i]); });

  vis.selectAll("g.node")
      .data(nodes.filter(function(n) { return !n.children; }))
    .enter().append("g")
      .attr("class", "node")
      .attr("id",function(d){ return "node-" + d.key; })
      .attr("transform", function(d) { return "rotate(" + (d.x - 90) + ")translate(" + d.y + ")"; })
    .append("text")
      .attr("dx", function(d) { return d.x < 180 ? chartConfig.textPadding : -chartConfig.textPadding; }) //dx Moves The text out away from the lines in a positive or negative direction, depending on which side of the axis it is on
      .attr("dy", ".31em") //moves the text up or down radially around the circle
      .attr("text-anchor", function(d) { return d.x < 180 ? "start" : "end"; })
      .attr("transform", function(d) { return d.x < 180 ? null : "rotate(180)"; })
      .text(function(d) {
        textString = d.key;
        textString = textString.split('_').join(' '); //MH replace underscores with spaces
        return textString; 
      })
      .on("mouseover",textOver)
      .on("mouseout",textOut);

});

/* ARCS ARE HARDCODED, SHOULD BE DYNAMIC */

var arcData = [
  {aS: 0, aE: 45,rI:radius - chartConfig.linePadding + chartConfig.arcPadding,rO:radius - chartConfig.linePadding + chartConfig.textPadding-chartConfig.arcPadding}
];

var arcJobsData = d3.svg.arc().innerRadius(arcData[0].rI).outerRadius(arcData[0].rO).startAngle(degToRad(1)).endAngle(degToRad(15));
var g = d3.select(".chart").append("svg:g").attr("class","arcs");
var arcJobs = d3.select(".arcs").append("svg:path").attr("d",arcJobsData).attr("id","arcJobs").attr("class","arc");
g.append("svg:text").attr("x",3).attr("dy",15).append("svg:textPath").attr("xlink:href","#arcJobs").text("JOBS").attr("class","arcText"); //x shifts x pixels from the starting point of the arc. dy shifts the text y units from the top of the arc

... 

function degToRad(degrees){
  return degrees * (pi/180);
}

function updateNodes(name,value){
  return function(d){
    if (value) this.parentNode.appendChild(this);
    vis.select("#node-"+d[name].key).classed(name,value);
  }
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-29T11:19:58.433

I've seen your json data structure here: [http://mikeheavers.com/transfers/projects/data/projects.json](http://mikeheavers.com/transfers/projects/data/projects.json). Firstly, in order to group the data and append the tag correctly, it'll be better to change your data like this: [https://raw.github.com/gist/4172625/4de3e6a68f9721d10e0068d33d1ebb9780db4ae2/flare-imports.json](https://raw.github.com/gist/4172625/4de3e6a68f9721d10e0068d33d1ebb9780db4ae2/flare-imports.json) to create a hirarchical structure.

We can then use the groups to draw the arcs.

First we create groups by "selectAll" and filter your nodes. Here you could add other group names of your data:

```
var groupData = svg.selectAll("g.group")
  .data(nodes.filter(function(d) {return (d.key=='Jobs' || d.key == 'Freelance' || d.key == 'Bayard') && d.children; }))
.enter().append("group")
  .attr("class", "group"); 
```

I just checked that in my case, so you'd better verify the result of the filter and make change according to your case (our data structure is a little bit different).

Now we got a list of groups. Then we'll go through the children of each group, and choose the smallest and largest x as the start and end angle. We can create a function like this:

```
function findStartAngle(children) {
    var min = children[0].x;
    children.forEach(function(d){
       if (d.x < min)
           min = d.x;
});
return degToRad(min);
} 
```

And similarly a findEndAngle function by replacing min by max. Then we can create the arcs' format:

```
var groupArc = d3.svg.arc()
  .innerRadius(arcData[0].rI)
  .outerRadius(arcData[0].rO)
  .startAngle(function(d){return findStartAngle(d.children);})
  .endAngle(function(d){return findEndAngle(d.children);}); 
```

Then we can create arcs in "dynamic" way:

```
svg.selectAll("g.arc")
  .data(groupData[0])
.enter().append("arc")
  .attr("d", groupArc)
  .attr("class", "arc")
    .append("svg:text")
      ...; 
```

In my case it is groupData[0], maybe you should check it in your case. For adding tags to arcs you just need to add d.key or d.name according to the result of your selection.

![the arc example](../Images/15c9f1474b4a16e0241a536b0b0e4f08.png)

The full code is available here: [https://gist.github.com/4172625](https://gist.github.com/4172625). Every time I get json from database so if there's no dynamic way to generic arcs I will be dead :P Hope it helps you!

# iphone - 将两个 NSDIctionay 合并到一个 NSDictionary 中

> ID：13108479
> 
> 赞同：0
> 
> 时间：2012-10-28T11:38:29.690
> 
> 标签：iphone, objective-c, xcode, ios4, nsdictionary

我想将两个 NSDictionary 合并到一个 NSDictionary 中。我的第一本词典

```
BreakFast Dates Dic {
    "2012-07-24" = "27";
    "2012-08-03" = "98";
    "2012-08-06" = "4203";
    "2012-08-23" = "0";
    "2012-08-24" = "0";
    "2012-09-11" = "36";
    "2012-09-19" = "450";
    "2012-09-24" = "36";
    Goals = 3;
} 
```

我的第二本词典

```
Dinner Dates Dic {
    "2012-08-03" = "100";
    "2012-08-27" = "0";
    "2012-09-19" = "270";
    Goals = 4;
} 
```

我想将两个字典合并为一个。就像早餐中我有“2012-09-19”和晚餐中的相同日期一样。我想用逗号 (,) 分隔两个值。我的结果字典应该是这样的。

```
combine {
    "2012-07-24" = "27,0";
    "2012-08-03" = "98,100";
    "2012-08-06" = "4203,0";
    "2012-08-23" = "0,0";
    "2012-08-24" = "0,0";
    "2012-09-11" = "36,0";
    "2012-09-19" = "450,270";
    "2012-09-24" = "36,0";
    Goals = 3,4;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T13:21:36.013

```
NSMutableDictionary *combined = [objectDelegate.dataBreakFastSummary mutableCopy];
    for(NSString *key in [combined allKeys])
    {
        NSString *breakfastDate = [objectDelegate.dataBreakFastSummary valueForKey:key];
        NSString *dinnerDate = [objectDelegate.dataDinnerSummary objectForKey:key];
        if(dinnerDate){
            [combined setObject:[NSString stringWithFormat:@"%@,%@",breakfastDate, dinnerDate] forKey:key];
            } else {
                [combined setObject:[NSString stringWithFormat:@"%@,0",breakfastDate] forKey:key];
                }
    }
    NSLog(@"Combine %@",combined); 
```

# php - 如何在 ZF2 控制器中捕获异常？

> ID：13108482
> 
> 赞同：8
> 
> 时间：2012-10-28T11:39:13.770
> 
> 标签：php, exception, try-catch, zend-framework2

我已经设置了[ZendSkeletonApplication](https://github.com/zendframework/ZendSkeletonApplication)，`ZF 2.0.3`但我无法在我的控制器中捕获异常。例如，如果我将以下代码放入`module/Application/src/Application/Controller/IndexController.php`：

```
public function indexAction() {
    echo "BEFORE\n";
    try {
        throw new \Exception("My exception");
    } catch (Exception $e) {
        echo "Caught exception $e\n";
        exit;
    } 
```

并访问我得到的页面：

```
BEFORE
An error occurred
An error occurred during execution; please try again later.
Additional information:
Exception

File:

    module/Application/src/Application/Controller/IndexController.php:25

Message:

    My exception 
```

启动`ViewModel`并显示异常，有效地阻止我捕捉它。

**如何在`ZF2`控制器中捕获异常？**

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-10-28T11:57:35.153

您正在抛出 PHP 的通用异常

```
throw new \Exception("My exception"); 
```

但是您从当前命名空间中捕获了异常

```
} catch (Exception $e) { 
```

假设你的控制器在`Application\Controller`，你要么必须声明

```
use \Exception; 
```

在您的类上方[将全局异常](http://php.net/manual/en/language.namespaces.importing.php)导入当前命名空间或

```
} catch (\Exception $e) { 
```

捕获 PHP 的全局异常。

# android - 从 USB（多产）到 android 设备的数据传输

> ID：13108484
> 
> 赞同：10
> 
> 时间：2012-10-28T11:39:18.117
> 
> 标签：android, usbserial

我发现了一个问题，用于读取 FTDI 设备的 USB 数据。 [传输数据 USB](https://stackoverflow.com/questions/10429615/transferring-data-usb) 我将此代码用于多产设备，并且可以检测到 USB 等，除了 conn.bulkTransfer() 给出 -1。

```
 private class UsbRunnable implements Runnable {
    private final UsbDevice mDevice;

    UsbRunnable(UsbDevice dev) {
        mDevice = dev;
    }

    public void run() {//here the main USB functionality is implemented
        UsbDeviceConnection conn = mUsbManager.openDevice(mDevice);
        if (!conn.claimInterface(mDevice.getInterface(1), true)) {
            l("in run(), no connection");
            return;
        }
        l("in run(), connection");

         conn.controlTransfer(0x40, 0, 0, 0, null, 0, 0);// reset
         // mConnection.controlTransfer(0×40,
         // 0, 1, 0, null, 0,
         // 0);//clear Rx
         conn.controlTransfer(0x40, 0, 2, 0, null, 0, 0);// clear Tx
         conn.controlTransfer(0x40, 0x02, 0x0000, 0, null, 0, 0);// flow
                 // control
                 // none
         conn.controlTransfer(0x40, 0x03,  0xC04E, 0, null, 0, 0);// baudrate
                 // 38400
         conn.controlTransfer(0x40, 0x04, 0x0008, 0, null, 0, 0);// data bit
                 // 8, parity
                 // none,
                 // stop bit
                 // 1, tx off   

        UsbEndpoint epIN = null;
        UsbEndpoint epOUT = null;

        byte counter=0;
    //conn.bulkTransfer(epOUT, new byte[]{msData}, 1, 0);

        UsbInterface usbIf = mDevice.getInterface(0);
        for (int i = 0; i < usbIf.getEndpointCount(); i++) {
            l("EP: "
                    + String.format("0x%02X", usbIf.getEndpoint(i)
                            .getAddress()));
            l("Type:"+usbIf.getEndpoint(i).getType());
            if (usbIf.getEndpoint(i).getType() == UsbConstants.USB_ENDPOINT_XFER_INT) {
                l("Bulk Endpoint");
                l("direction: "+usbIf.getEndpoint(i).getDirection());
                if (usbIf.getEndpoint(i).getDirection() == UsbConstants.USB_DIR_IN)
                    epIN = usbIf.getEndpoint(i);

            }
            else l("no bulk");
            l("epIN: "+epIN.toString());
        }

        for (;;) {// this is the main loop for transferring
            try {
                Thread.sleep(100);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            // This is where it is meant to receive
            byte[] buffer = new byte[38400];

            StringBuilder str = new StringBuilder();

            l("bulk transfer thing: " + conn.bulkTransfer(epIN, buffer, 38400, 1000));

            if (conn.bulkTransfer(epIN, buffer, 38400, 1000) > 0 ) {
                l("bulk transfer is success");
                for (int i = 2; i < 64; i++) {
                    if (buffer[i] != 0) {
                        str.append((char) buffer[i]);
                    } else {
                        l(str);
                        break;
                    }
                }

            }
            // this shows the complete string
            l(str);

            if (mStop) {
                mConnectionHandler.onUsbStopped();
                return;
            }
             l("sent " + counter);
                counter++;
                counter = (byte) (counter % 16);
        }

    }
}

// END MAIN LOOP
private BroadcastReceiver mPermissionReceiver = new PermissionReceiver(
        new IPermissionListener() {

            public void onPermissionDenied(UsbDevice d) {
                l("Permission denied on " + d.getDeviceId());
            }
        });

private static interface IPermissionListener {
    void onPermissionDenied(UsbDevice d);
}

public final static String TAG = "USBController";

private void l(Object msg) {
    Log.d(TAG, ">==< " + msg.toString() + " >==<");
}

private void e(Object msg) {
    Log.e(TAG, ">==< " + msg.toString() + " >==<");
} 
```

谁能告诉我我需要做哪些改变？先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-14T23:19:13.230

有几个问题。

我认为注释掉的行是您遇到问题的地方。您可能需要重新格式化代码缩进并提供更多信息。无论如何，假设您的问题发生在这里：

```
byte counter=0;
//conn.bulkTransfer(epOUT, new byte[]{msData}, 1, 0); 
```

我看到的直接问题 - epOut，您发送数据的端点为空。所以当然会失败。你什么都没有发送数据。我按照您发布到您复制的示例代码的链接，他们有一行显示：

```
epOUT = usbIf.getEndpoint(i); 
```

我强烈建议您至少在开始进行更改之前，首先确保您了解原始代码或使其在您自己的程序中工作。**不要**只是复制上面的代码行来“修复”你的问题。

# php - Yii 框架似乎在 GET 响应中发送标头

> ID：13108486
> 
> 赞同：0
> 
> 时间：2012-10-28T11:40:19.473
> 
> 标签：php, yii, http-headers

我有一段代码在我开发它时已经停止工作（但以前工作过）。它发送一些标头，然后使用`readfile()`.

这是我的行动：

```
public function actionShowMediaFile2() {
    if (headers_sent()) { 
        ... 
```

换句话说，我行动的第一件事就是`headers_sent()`返回**true**。

实际上，查看 Firebug 中的 GET 响应，那里有几个标头。这可以防止我发送自己的标头，并且似乎也让`readfile()`.

我的问题：

1.- Yii 框架是否自动发送标头？

2.- 如果是这样，我该如何防止这种情况？

3.- 或者这可能与 Yii 无关？

以下是 Yii 自动生成的标题：

```
HTTP/1.1 200 OK
Date: Sun, 28 Oct 2012 10:59:05 GMT
Server: Apache
Vary: Accept-Encoding
Content-Encoding: gzip
Content-Length: 22
Keep-Alive: timeout=2, max=99
Connection: Keep-Alive
Content-Type: text/html 
```

检查 Fiddler，服务器响应似乎是：......

# javascript - 自动展开产品类别树

> ID：13108488
> 
> 赞同：5
> 
> 时间：2012-10-28T11:40:41.733
> 
> 标签：javascript, magento, extjs

我被困在这个问题上，基本上我需要的是一种自动扩展包含选中子类别节点的类别树节点的方法。

代码中的入口点是 `js/extjs/ext-tree-checkbox.js`和`'catalog/category/tree.phtml'`

可以用`expand()`js方法扩展一个节点，扩展所有节点并不难，但这会使页面变慢太多。

**更新：**

我已经测试了以下解决方案：

1.  更改`js/extjs/ext-tree-checkbox.js`渲染方法添加此：

    ```
    var tree = n.getOwnerTree();
        if (tree){
            expandNodeIds =  tree.expandNodeIds.split(',');
            for (i in expandNodeIds) 
            {
                if (n.id == expandNodeIds[i])
                    n.expand();
            }
        } 
    ```

此解决方案有效，但它破坏了（不再显示）权限树

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-11-20T14:17:46.460

我做了一些错误修复和重构，并将@obscures 答案打包成一个小扩展。在 GitHub 上尝试一下：[Kiwigrid_AutoExpandProductCategoryTree](https://github.com/kiwigrid/Kiwigrid_AutoExpandProductCategoryTree)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-22T21:30:36.360

因为：

```
 - Google sees this as a solution 
```

我的解决方案在 Php 方面，在 Mage_Adminhtml_Block_Catalog_Product_Edit_Tab_Categories 类中。

```
// start Added stuff
protected $_ubProductCategoriesParents;

public function getUbProductCategories()
{
    if (is_null($this->_ubProductCategoriesParents)) {
        $this->_ubProductCategoriesParents = array();
        $this->_ubProductCategoriesParents = array();
        foreach ($this->getCategoryIds() as $id) {
            $storeId = (int) $this->getRequest()->getParam('store');
            $path = Mage::getResourceModel('catalog/category')
                ->getAttributeRawValue($id, 'path', $storeId); // no model->load ever ever ever
            if (empty($path)) {
                $path = "";
            }
            $parentsIds = explode("/", $path);
            if (!(is_array($parentsIds) && count($parentsIds) > 0)) {
                $parentsIds = array();
            }
            $this->_ubProductCategoriesParents = array_unique(array_merge($this->_ubProductCategoriesParents, $parentsIds));
        }

        //Mage::log(print_r($this->_ubProductCategoriesParents, true));
    }

    return $this->_ubProductCategoriesParents;
}
// end Added stuff

// magento core function from class
protected function _getNodeJson($node, $level = 1)
{
    $item = parent::_getNodeJson($node, $level);

    if ($this->_isParentSelectedCategory($node)) {
        $item['expanded'] = true;
    }

    // added new if statement
    if (!(isset($item['expanded']) && $item['expanded'] == true) && array_search($node->getId(), $this->getUbProductCategories()) !== false) {
        $item['expanded'] = true;
    }

    if (in_array($node->getId(), $this->getCategoryIds())) {
        $item['checked'] = true;
    }

    if ($this->isReadonly()) {
        $item['disabled'] = true;
    }

    return $item;
} 
```

现在将上面的代码放在重写类中。

谢谢

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T05:23:01.397

这解决了所有问题

```
 var tree = n.getOwnerTree();
    if (tree){
        expandNodeIds =  tree.expandNodeIds;

        if (expandNodeIds) {
            expandNodeIds = expandNodeIds.split(',');
            for (i in expandNodeIds) 
            {
                if (n.id == expandNodeIds[i])
                    n.expand();
            }
        } 
```

`render`在方法中添加上面的代码`js/extjs/ext-tree-checkbox.js`

# java - 如何编辑/更新 BLOB 图像 (PNG)

> ID：13108494
> 
> 赞同：0
> 
> 时间：2012-10-28T11:41:15.743
> 
> 标签：java, sqlite, blob

我在创建用于编辑 BLOB 图像的方法时遇到问题。您可以在下面找到我的代码（所有代码均已缩短）；

```
String edit=txt_gid.getText();
**byte[] e = icon_image1;**
 String sql="update GamesCollector set FrontCover='"+e+"'where GameId='"+edit+"' ";
    ps=conn.prepareStatement(sql);
    ps.execute();

    JOptionPane.showMessageDialog(null, "Data Edited");
    Browse.UpdateTable(); 
```

这就是我在 JLabel（Swing 组件）上显示图像的方式；

```
 public static ImageIcon pic1=null;

 String sql="select * from GamesCollector where Title=?";
        ps=conn.prepareStatement(sql);

        ps.setString(1, txt_search.getText().toUpperCase().trim());
        rs=ps.executeQuery();

 if(rs.next()){

byte[] datapic = rs.getBytes("FrontCover");
            pic1 = new ImageIcon(datapic);
            front.setIcon(pic1);} 
```

这是导致问题的代码；

```
static void Edit(){

 try{

        String edit=txt_gid.getText();

        String edit1=txt_title.getText().toUpperCase().trim();
        String edit2=cmb_platform.getSelectedItem().toString();
        if(edit2==null){edit2="";}

        String edit3=cmb_format.getSelectedItem().toString();
        if(edit3==null){edit3="";}

        String edit4=list_genres.getSelectedValue().toString();
        if(edit4==null){edit4="";}

        String edit5=((JTextField)pck_releasedate.getDateEditor().getUiComponent()).getText(); 
        String edit6=txt_desc.getText().toUpperCase().trim();
        String edit7=txt_developer.getText().toUpperCase().trim();
        String edit8=txt_publisher.getText().toUpperCase().trim();
        String edit9=txt_series.getText().toUpperCase().trim();
        String edit10=txt_barcode.getText().toUpperCase().trim();
        String edit11=collection;
        String edit12=cmb_esrb.getSelectedItem().toString();
        if(edit12==null){edit12="";}

        String edit13=cmb_pegi.getSelectedItem().toString();
        if(edit13==null){edit13="";}

        String edit14 = Integer.toString(rating_slider.getValue());

        **byte[] e = icon_image1;**

        String sql="update GamesCollector set Title=='"+edit1+"',Platform='"+edit2+"',Format='"+edit3+"',Genres='"+edit4+"',ReleaseDate='"+edit5+"',Description='"+edit6+"',Developer='"+edit7+"',Publisher='"+edit8+"',Series='"+edit9+"',Barcode='"+edit10+"',Collection='"+edit11+"',ESRB='"+edit12+"',PEGI='"+edit13+"',Rating='"+edit14+"',FrontCover='"+e+"'   where GameId='"+edit+"' ";
        ps=conn.prepareStatement(sql);
        ps.execute();

        JOptionPane.showMessageDialog(null, "Data Edited");
        Browse.UpdateTable();

    }

    catch(Exception e){
        JOptionPane.showMessageDialog(null, e);
    }
    finally {

        try{
            rs.close();
            ps.close();

        }

        catch(Exception e){}

    }

  } 
```

}

该方法用于获取路径并将其转换为 ByteArray；

```
protected static void AttachImage(){

    JFileChooser chooser= new JFileChooser("D:\\Downloads\\Software Development\\GameCollector\\Images\\Game");
    chooser.showOpenDialog(null);
    File s=chooser.getSelectedFile();
    filename = s.getAbsolutePath();

    try{
    File image = new File(filename);
    FileInputStream fis = new FileInputStream(image);
    ByteArrayOutputStream baos = new ByteArrayOutputStream();

    byte[] bug = new byte[1024];

    for(int readNum; (readNum=fis.read(bug)) !=-1;){
        baos.write(bug,0,readNum);        
    }

     icon_image1=baos.toByteArray();
     icon_image2=baos.toByteArray();

    }
    catch(Exception e)
    {
        JOptionPane.showMessageDialog(null, e);
    }
 } 
```

该方法用于保存文件；

```
static void Save(){

   try{

        String sql="insert into GamesCollector (GameId,Title,Platform,Format,Genres,ReleaseDate,Description,Developer,Publisher,Series,Barcode,Collection,ESRB,PEGI,Rating,FrontCover,BackCover) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
        ps=conn.prepareStatement(sql);

        ps.setString(1, txt_gid.getText().toUpperCase().trim());
        ps.setString(2, txt_title.getText().toUpperCase().trim());
        String platform=cmb_platform.getSelectedItem().toString();
        if(platform==null){platform="";}
        ps.setString(3, platform);
        String format=cmb_format.getSelectedItem().toString();
        if(format==null){format="";}
        ps.setString(4, format);
        String genres=list_genres.getSelectedValue().toString();
        if(genres==null){genres="";}
        ps.setString(5, genres);
        ps.setString(6, ((JTextField)pck_releasedate.getDateEditor().getUiComponent()).getText());
        ps.setString(7, txt_desc.getText().toUpperCase().trim());
        ps.setString(8, txt_developer.getText().toUpperCase().trim());
        ps.setString(9, txt_publisher.getText().toUpperCase().trim());
        ps.setString(10, txt_series.getText().toUpperCase().trim());
        ps.setString(11, txt_barcode.getText().toUpperCase().trim());

        ps.setString(12, collection);

        String esrb=cmb_esrb.getSelectedItem().toString();
        if(esrb==null){esrb="";}
        ps.setString(13, esrb);
        String pegi=cmb_pegi.getSelectedItem().toString();
        if(pegi==null){pegi="";}
        ps.setString(14, pegi);
        int rating = rating_slider.getValue();
        ps.setString(15, Integer.toString(rating));
        ps.setBytes(16, icon_image1);
        ps.setBytes(17, icon_image2);

        ps.execute();

        JOptionPane.showMessageDialog(null, "Data Saved");
       }

    catch(Exception e){
        JOptionPane.showMessageDialog(null, e);
    }
    finally {

        try{
            rs.close();
            ps.close();

        }

        catch(Exception e){}

    }
  } 
```

当我检索数据时，一切正常。

该方法用于编辑数据；

```
static void Edit(){
   try{
        String edit=txt_gid.getText();

        String edit1=txt_title.getText().toUpperCase().trim();
        String edit2=cmb_platform.getSelectedItem().toString();
        if(edit2==null){edit2="";}

        String edit3=cmb_format.getSelectedItem().toString();
        if(edit3==null){edit3="";}

        String edit4=list_genres.getSelectedValue().toString();
        if(edit4==null){edit4="";}

        String edit5=((JTextField)pck_releasedate.getDateEditor().getUiComponent()).getText(); 
        String edit6=txt_desc.getText().toUpperCase().trim();
        String edit7=txt_developer.getText().toUpperCase().trim();
        String edit8=txt_publisher.getText().toUpperCase().trim();
        String edit9=txt_series.getText().toUpperCase().trim();
        String edit10=txt_barcode.getText().toUpperCase().trim();
        String edit11=collection;
        String edit12=cmb_esrb.getSelectedItem().toString();
        if(edit12==null){edit12="";}

        String edit13=cmb_pegi.getSelectedItem().toString();
        if(edit13==null){edit13="";}

        String edit14 = Integer.toString(rating_slider.getValue());

        byte[] e = icon_image1;

        String sql="update GamesCollector set Title=='"+edit1+"',Platform='"+edit2+"',Format='"+edit3+"',Genres='"+edit4+"',ReleaseDate='"+edit5+"',Description='"+edit6+"',Developer='"+edit7+"',Publisher='"+edit8+"',Series='"+edit9+"',Barcode='"+edit10+"',Collection='"+edit11+"',ESRB='"+edit12+"',PEGI='"+edit13+"',Rating='"+edit14+"',FrontCover='"+icon_image1+"'   where GameId='"+edit+"' ";
        ps=conn.prepareStatement(sql);
        ps.execute();

        JOptionPane.showMessageDialog(null, "Data Edited");
        Browse.UpdateTable();

    }

    catch(Exception e){
        JOptionPane.showMessageDialog(null, e);
    }
    finally {

        try{
            rs.close();
            ps.close();

        }

        catch(Exception e){}

    }

  } 
```

编辑后，该方法将不再检索任何数据。

数据在我编辑时保存。仅当我在图形界面上显示它时才会出现此问题。除了显示空白区域的图像外，将显示所有数据。

如何解决我遇到的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T12:57:08.247

您正在尝试将图像放入 SQL 命令字符串：

```
String sql="update ... set ... FrontCover='"+icon_image1+"' ... 
```

这不适用于二进制数据。

为确保二进制数据正确进入数据库，请使用参数，例如在您的`Save`方法中。

# java - JPA 时间戳列和 net.sf.json 查询结果

> ID：13108495
> 
> 赞同：0
> 
> 时间：2012-10-28T11:41:17.910
> 
> 标签：java, json, jpa

在我的实体类中，我有一列时间戳类型：

```
@Column(name = "TESTD")
@Temporal(TemporalType.TIMESTAMP)    
private Date test_date; 
```

在我的会话 bean 中，我创建了一个返回结果列表的选择查询，然后我从中创建了一个 json 对象：

```
Query query = em.createNamedQuery("findAllTest");                                               
List<entityClass> results = query.getResultList();  
JSONSerializer.toJSON((List)results ,jsonConfig); 
```

创建 json 对象时，我希望对时间戳列进行格式化（而不是作为对象返回）。如何才能做到这一点？如何根据我想要的日期格式转换/格式化时间戳列？做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:00:31.797

我猜你正在使用基于代码示例的 json-lib，我从未使用过它，但[javadoc](http://json-lib.sourceforge.net/apidocs/jdk15/net/sf/json/JsonConfig.html#registerJsonValueProcessor%28java.lang.Class,%20net.sf.json.processors.JsonValueProcessor%29)显示 JsonConfig 提供了以下方法：

```
public void registerJsonValueProcessor(Class propertyType,
                                       JsonValueProcessor jsonValueProcessor)

Registers a JsonValueProcessor.
[Java -> JSON] 
```

因此，我想您可以使用该方法，并为 Calendar.class 注册一个处理器，该处理器将使用您想要的格式将 Calendar 对象转换为 String ..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T14:06:51.880

我创建了第二个瞬态 getter，它以我想要的格式返回日期作为字符串。这有点像黑客攻击但有效。

# asp.net-mvc - 是否需要为 webfarm 动态构建 url？

> ID：13108497
> 
> 赞同：1
> 
> 时间：2012-10-28T11:41:36.640
> 
> 标签：asp.net-mvc, url, deployment, web-farm

我们计划将我们的 asp .net mvc 应用程序转移到带有负载平衡器的 webfarm，

我担心应用程序中可用的许多硬编码网址，例如。

```
<a href="https://root:xxx/home/index">Index</a> 
```

和

**this.RedirectToAction(x=>x.Index());**

和

**Response.Redirect("~/home/index");**

是否需要根据 RRA 算法动态构建此 url 以重定向到某个特定位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T17:45:13.133

不，这应该由您的负载均衡器处理。我希望您展示的代码可以正常工作。

# azure-role-environment - “ServiceRuntime.RoleEnvironment”的类型初始化程序抛出异常

> ID：13108502
> 
> 赞同：3
> 
> 时间：2012-10-28T11:42:43.317
> 
> 标签：azure-role-environment

我有一个自定义的 azure 实用程序 dll，它有一种方法可以从中读取配置值，`ServiceConfiguration`并且还有备用代码可以在没有运行的情况下`AppSettings`从中读取。此 DLL 可与在本地和生产云环境上运行的 Azure WCF 项目一起正常工作。`web.config``RoleEntironment`

出于某种原因，我将这个 WCF 服务托管在 IIS 上的 Rackspace 服务器上。

在我的本地机器 IIS 上，WCF 服务工作正常，但在 Rackspace 上它崩溃并出现以下错误：

> 'Microsoft.WindowsAzure.ServiceRuntime.RoleEnvironment' 的类型初始化程序引发了异常。

我已经复制了`WindowsAzure.ServiceRuntime.dll`,`Diagnostics.dll`并`StorageClient.dll`在机架空间的 bin 中。它仍然给出同样的错误。

我也试过复制`<startup useLegacyV2RuntimeActivationPolicy="true">`到`Web.config`，还是不行。

任何的想法？我是否缺少更多云 DLL 或需要更多配置？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T16:45:13.907

我最近经历了这种痛苦。它最终成为导致问题的 Azure 项目文件中 Microsoft.WindowsAzure.Diagnostics dll 的不匹配版本。如果您有本地工作副本并从以前的版本成功部署，您可以从 Azure VM 复制已部署的文件并将它们与您的本地集进行比较（对我来说失败的是工作角色）。如果不检查版本以确保所引用的版本包含在 CopyLocal 设置为 true 的部署中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-03T07:37:20.220

我通过在配置文件中添加 useLegacyV2RuntimeActivationPolicy="true" 解决了这个问题

```
<configuration>
  <startup useLegacyV2RuntimeActivationPolicy="true">
    <supportedRuntime version="v4.0"/>
  </startup> 
```

# bash - 使用 sed 反转输入顺序

> ID：13108503
> 
> 赞同：7
> 
> 时间：2012-10-28T11:42:44.777
> 
> 标签：bash, unix, command-line, sed

我有一个文件，我们称之为“a.txt”，这个文件包含以下文本行

```
do to what 
```

我想知道 SED 命令是什么来反转此文本的顺序以使其看起来像

```
what to do 
```

我必须做某种附加吗？就像将 'do' 附加到 'to' 所以它看起来像

to ++ do（使用 ++ 只是为了清楚）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-28T11:51:25.863

我知道`tac`可以做一些相关的事情

```
$ cat file
 do to what
$ tac -s' ' file

what to do  $ 
```

其中`-s`定义了分隔符，默认情况下是换行符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T11:50:59.983

我`awk`会这样做：

```
awk '{ for (i=NF; i>=1; i--) printf (i!=1) ? $i OFS : $i "\n" }' file.txt 
```

结果：

```
what to do 
```

***编辑***：

如果您需要单行“就地”修改文件，请尝试：

```
{ rm file.txt && awk '{ for (i=NF; i>=1; i--) printf (i!=1) ? $i OFS : $i "\n" }' > file.txt; } < file.txt 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-28T12:02:11.370

## [sed](/questions/tagged/sed "显示标记为“sed”的问题")答案

由于这个问题被标记为[sed](/questions/tagged/sed "显示标记为“sed”的问题")，我的第一个答案是：

首先（使用任意`_`标记查看的空间，当`a.txt`包含`do to what`：

```
sed -e '
    :a;
    s/\([^_]*\) \([^ ]*\)/\2_\1/;
    ta;
    y/_/ /;
   ' a.txt
what to do 
```

比，当`a.txt`包含`do to to what`：

```
sed -e '
    :a;
    s/^\(\|.* \)\([^+ ]\+\) \2\([+]*\)\(\| .*\)$/\1\2\3+\4/g;
    ta;
    :b;
    s/\([^_]*\) \([^ ]*\)/\2_\1/;
    tb;
    y/_/ /;
   ' <<<'do to to to what'
what to++ do 
```

`+`每个被*抑制*的重复单词都有一个：

```
sed -e ':a;s/^\(\|.* \)\([^+ ]\+\) \2\([+]*\)\(\| .*\)$/\1\2\3+\4/g;ta;
        :b;s/\([^_]*\) \([^ ]*\)/\2_\1/;tb;
        y/_/ /;' <<<'do do to what what what what'
what+++ to do+ 
```

## [重击](/questions/tagged/bash "显示标记为“bash”的问题")答案

但是由于有很多人在寻找简单的[bash](/questions/tagged/bash "显示标记为“bash”的问题")解决方案，所以有一个简单的方法：

```
xargs < <(uniq <(tac <(tr \  \\n <<<'do do to what what what what')))
what to do 
```

这可以写成：

```
tr \  \\n <<<'do do to what what what what' | tac | uniq | xargs 
what to do 
```

甚至使用一些[bash](/questions/tagged/bash "显示标记为“bash”的问题")脚本：

```
revcnt () { 
    local wrd cnt plut out="";
    while read cnt wrd; do
        printf -v plus %$((cnt-1))s;
        out+=$wrd${plus// /+}\ ;
    done < <(uniq -c <(tac <(tr \  \\n )));
    echo $out
} 
```

会做：

```
revcnt <<<'do do to what what what what' 
what+++ to do+ 
```

## 或者作为*纯粹的[bash](/questions/tagged/bash "显示标记为“bash”的问题")*

```
revcnt() { 
    local out i;
    for ((i=$#; i>0; i--))
    do
        [[ $out =~ ${!i}[+]*$ ]] && out+=+ || out+=\ ${!i};
    done;
    echo $out
} 
```

其中提交的字符串必须作为参数提交：

```
revcnt do do to what what what what
what+++ to do+ 
```

或者，如果需要处理*标准输入*（或来自文件）：

```
revcnt() { 
    local out i arr;
    while read -a arr; do
        out=""
        for ((i=${#arr[@]}; i--; 1))
        do
            [[ $out =~ ${arr[i]}[+]*$ ]] && out+=+ || out+=\ ${arr[i]};
        done;
        echo $out;
    done
} 
```

所以你可以处理多行：

```
revcnt <<eof
do to what
do to to to what
do do to what what what what
eof
what to do
what to++ do
what+++ to do+ 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-28T20:33:32.860

这可能对您有用（GNU sed）：

```
sed -r 'G;:a;s/^\n//;t;s/^(\S+|\s+)(.*)\n/\2\n\1/;ta' file 
```

解释：

*   `G`在模式空间的末尾添加一个换行符 (PS)
*   `:a`循环名称空间
*   `s/^\n//;t`当换行符位于 PS 的前面时，将其删除并打印行
*   `s/^(\S+|\s+)(.*)\n/\2\n\1/;ta`在换行符之后直接插入非空格或空格字符串并循环到`:a`

该`-r`开关使正则表达式更易于使用（分组`(...)`、交替`...|...`和一个或多个的元字符`+`不再需要反斜杠前缀）。

选择：

```
sed -E 'G;:a;s/^(\S+)(\s*)(.*\n)/\3\2\1/;ta;s/.//' file 
```

注意要反转线，请将上述解决方案调整为：

```
sed -E 'G;:a;/^(.)(.*\n)/\2\1/;ta;s/.//' file 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-29T13:23:21.363

可能你会喜欢 perl：

```
perl -F -lane '@rev=reverse(@F);print "@rev"' your_file 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-20T15:55:12.793

正如[伯恩哈德所说](https://stackoverflow.com/a/13108568/52499)，`tac`可以在这里使用：

```
#!/usr/bin/env bash
set -eu
echo '1 2 3
2 3 4
3 4 5' | while IFS= read -r; do
    echo -n "$REPLY " | tac -s' '
    echo
done

$ ./1.sh
3 2 1 
4 3 2 
5 4 3 
```

我相信我的例子更有帮助。

# php - 如何在我通过编码创建的 Codeigniter 中附加文件？

> ID：13108508
> 
> 赞同：-2
> 
> 时间：2012-10-28T11:43:40.843
> 
> 标签：php, codeigniter

我已经通过编码创建了一个 pdf 文件，我希望通过电子邮件附件发送该 pdf 文件。有人可以帮忙吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T11:48:15.033

使用codeigniter附加功能..

```
$this->email->attach() 
```

它使您能够发送附件。将文件路径/名称放在第一个参数中。

例如..

```
$this->email->attach('/path/to/yourfile.pdf');

$this->email->send(); 
```

浏览用户指南.. [http://ellislab.com/codeigniter/user_guide/libraries/email.html](http://ellislab.com/codeigniter/user_guide/libraries/email.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T11:48:40.467

你可以在这里阅读： http: [//ellislab.com/codeigniter/user_guide/libraries/email.html](http://ellislab.com/codeigniter/user_guide/libraries/email.html)

```
$this->email->attach('/path/to/photo1.jpg');
$this->email->attach('/path/to/photo2.jpg');
$this->email->attach('/path/to/photo3.jpg');

$this->email->send(); 
```

**请记住，您只能从自己的服务器附加文件。**

# c# - 访问违规异常 emguCV cvQueryHistValue

> ID：13108511
> 
> 赞同：1
> 
> 时间：2012-10-28T11:43:50.273
> 
> 标签：c#, opencv, access-violation, emgucv

我在托管代码中遇到了访问冲突异常。直方图指针不为空，一切似乎都很好。[从http://www.emgu.com/forum/viewtopic.php?f=8&t=59](http://www.emgu.com/forum/viewtopic.php?f=8&t=59)获得了创建 IntPtr 的示例

```
// initializing data
var random = new Random();
var array = new double[1000];
for (int i = 0; i < 1000; i++)
{
    array[i] = random.NextDouble();
}
var arrayPtr = GetDataPtr(array);

//initializing ranges array
double[] rangesArray = { 0, 1 };
var rangesArrayPtr = GetRangesArrayPtr(rangesArray);
//creating and querying histogram
var histogramStructure = CvInvoke.cvCreateHist(1, new[] {20}, HIST_TYPE.CV_HIST_ARRAY, rangesArrayPtr, true);
var histogram = CvInvoke.cvMakeHistHeaderForArray(1, new[] { 20 }, histogramStructure, arrayPtr, rangesArrayPtr, 1);
CvInvoke.cvNormalizeHist(histogram, 1.0);
CvInvoke.cvQueryHistValue_1D(histogram, 0); // getting exception here 
```

帮助方法

```
private static IntPtr[] GetRangesArrayPtr(double[] array)
{
    var ranges = new IntPtr[1];
    ranges[0] = Marshal.AllocHGlobal(array.Length * sizeof(double));
    Marshal.Copy(array, 0, ranges[0], array.Length);
    return ranges;
}
private static IntPtr GetDataPtr(double[] array)
{
    var ranges = new IntPtr();
    ranges = Marshal.AllocHGlobal(array.Length * sizeof(double));
    Marshal.Copy(array, 0, ranges,array.Length);
    return ranges;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-20T12:19:03.880

我在最近的一个项目中遇到了同样的问题，并通过将直方图值复制到一个新数组中来解决它。

```
Double[] histtemp = new double[255];

Histogram.MatND.ManagedArray.CopyTo(histtemp,0); 
```

现在您可以访问 histt​​emp 中的直方图值。希望对以后的观众有所帮助。

# c# - 如何从封闭类型的 MethodInfo 获取开放泛型类型的 MethodInfo

> ID：13108519
> 
> 赞同：10
> 
> 时间：2012-10-28T11:44:41.857
> 
> 标签：c#, .net, reflection

假设我有这样的课程：

```
public class MyClass<T>
{
    public void Foo(T t)
    {
    }
} 
```

现在，假设，我有一个实例`MyClass<int>`和一个`MethodInfo`它的`Foo`方法。调用`methodInfo.GetParameters()`将返回一个`ParameterInfo`包含一个条目的数组，指的是 type `int`。我的问题是，我似乎无法确定该参数是`int`在类中声明还是声明为`T`.

**我想达到什么目的？**
在运行时，我想`MethodInfo`从 Visual Studio 生成的 XML Doc 文件中读取指定方法的文档。
对于上面定义的方法，键如下所示：

```
<namespace>.MyClass`1.Foo(`0) 
```

引用声明类的``0`第一个泛型类型参数。为了能够构造这个字符串，我需要以某种方式获取这些信息。
*但是怎么做？* `MethodInfo`好像没有那个信息...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T11:16:47.077

关键似乎[`Type.ContainsGenericParameters`](http://msdn.microsoft.com/en-us/library/system.type.containsgenericparameters.aspx)在参数类型上：

给定

```
public class MyClass<T>
{
    public void Foo(T t)
    {
    }

    public void Bar(int i)
    {

    }
} 
```

然后

```
class Program
{
    static void Main(string[] args)
    {
        var obj = new MyClass<int>();

        // Closed type
        var closedType = obj.GetType();

        // Open generic (typeof(MyClass<>))
        var openType = closedType.GetGenericTypeDefinition();

        // Methods on open type
        var fooT = openType.GetMethod("Foo");
        var barint = openType.GetMethod("Bar");

        // Parameter types
        var tInFoo = fooT.GetParameters()[0].ParameterType;
        var iInBar = barint.GetParameters()[0].ParameterType;

        // Are they generic?
        var tInFooIsGeneric = tInFoo.ContainsGenericParameters;
        var iInBarIsGeneric = iInBar.ContainsGenericParameters;

        Console.WriteLine(tInFooIsGeneric);
        Console.WriteLine(iInBarIsGeneric);

        Console.ReadKey();
    }
} 
```

输出

```
True
False 
```

这显然需要更多的工作来处理重载等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T12:17:27.103

您能否通过[Type.GetGenericTypeDefinition Method](http://msdn.microsoft.com/en-us/library/system.type.getgenerictypedefinition.aspx)获得泛型类的定义，并在那里找到相同方法的定义，例如，按名称（和签名），然后比较`Foo(T t)`和`Foo(int t)`：

```
MyClass<int> c = new MyClass<int>();

Type concreteType = c.GetType();
Console.Write("Concrete type name:");
Console.WriteLine(concreteType.FullName);
Console.WriteLine();

MethodInfo concreteMethod = concreteType.GetMethod("Foo");
if (concreteMethod != null)
{
    Console.WriteLine(concreteMethod.Name);
    foreach (ParameterInfo pinfo in concreteMethod.GetParameters())
    {
        Console.WriteLine(pinfo.Name);
        Console.WriteLine(pinfo.ParameterType);
        Console.WriteLine();
    }
    Console.WriteLine();
}

if (concreteType.IsGenericType)
{
    Console.Write("Generic type name:");
    Type genericType = concreteType.GetGenericTypeDefinition();
    Console.WriteLine(genericType.FullName);
    Console.WriteLine();

    MethodInfo genericMethod = genericType.GetMethod("Foo");
    if (genericMethod != null)
    {
        Console.WriteLine(genericMethod.Name);
        foreach (ParameterInfo pinfo in genericMethod.GetParameters())
        {
            Console.WriteLine(pinfo.Name);
            Console.WriteLine(pinfo.ParameterType);
            Console.WriteLine();
        }
        Console.WriteLine();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T09:37:07.210

我不知道您是否考虑过使用 Mono.Cecil 而不是 .Net 的反射。

```
// Gets the AssemblyDefinition (similar to .Net's Assembly).
Type testType = typeof(MyClass<>);
AssemblyDefinition assemblyDef = AssemblyDefinition.ReadAssembly(new Uri(testType.Assembly.CodeBase).LocalPath);
// Gets the TypeDefinition (similar to .Net's Type).
TypeDefinition classDef = assemblyDef.MainModule.Types.Single(typeDef => typeDef.Name == testType.Name);
// Gets the MethodDefinition (similar to .Net's MethodInfo).
MethodDefinition myMethodDef = classDef.Methods.Single(methDef => methDef.Name == "Foo"); 
```

然后`myMethodDef.FullName`返回

```
"System.Void MyNamespace.MyClass`1::Foo(System.Int32,T,System.String)" 
```

并`classDef.GenericParameters[0].FullName`返回

```
"T" 
```

请注意，Mono.Cecil 使用不同的方式来编写泛型、嵌套类和数组：

```
List[T] => List<T>
MyClass+MyNestedClass => MyClass/MyNestedClass
int[,] => int[0...,0...] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-28T22:24:15.047

这是一个棘手的问题。如果你有一个（***非***泛型）方法的`MethodInfo`实例，它是在一个***开放的泛型***上获得的，你实际上*可以*使用它来重复关闭该方法（即，为*封闭*类型使用不同的泛型参数）。 **`Type`**

 ***关键是使用晦涩的静态函数[`MethodInfo.GetMethodFromHandle(...)`](https://docs.microsoft.com/en-us/dotnet/api/system.reflection.methodbase.getmethodfromhandle)：

**完整的工作示例：**

```
static class SomeType<T>
{
    public static int NonGenericMethod() => typeof(T).MetadataToken;
}; 
```

**如何使用：**

```
static void demo()
{
    var Topen = typeof(SomeType<>);
    var mi_nope = Topen.GetMethod("NonGenericMethod");  // cannot 'Invoke' this.

    /// ...later perhaps...

    var Tclosed = Topen.MakeGenericType(typeof(ushort));
    var mi_ok = MethodInfo.GetMethodFromHandle(mi_nope.MethodHandle, Tclosed.TypeHandle);
    var ret = (int)mi_ok.Invoke(null, null);     // --> 0x02000150

    /// ...again with a different generic arg, reusing 'mi_wontInvoke' (and Topen)...

    Tclosed = Topen.MakeGenericType(typeof(Guid));
    mi_ok = MethodInfo.GetMethodFromHandle(mi_nope.MethodHandle, Tclosed.TypeHandle);
    ret = (int)mi_ok.Invoke(null, null);         // --> 0x020000eb
} 
```

请注意，`Tclosed`类型句柄（作为第二个参数传入）不仅仅是`T`您最终想要参数化的类型参数的句柄。相反，您必须首先使用它`T`来关闭原始`Topen`（打开）泛型类型，然后使用生成的（关闭）泛型类型的句柄。

换句话说，如果不先显式关闭泛型类型，就无法关闭泛型方法。***

# jquery - jquery li ul子菜单问题

> ID：13108520
> 
> 赞同：0
> 
> 时间：2012-10-28T11:44:59.250
> 
> 标签：jquery, slidetoggle, jquery-hover

我有一个问题，我想制作一个这样的 jquery 子菜单：

```
 <ul id="submenu" class="menu">
    <li class="item-1"><a href="test.html">Test 1</a></li>
    <li class="item-2 deeper parent">
        <a href="test.html">Test 2</a>
        <ul>
            <li class="item-xy"><a href="#">Test 1</a></li>
            <li class="item-xy"><a href="#">Test 1</a></li>
            <li class="item-xy"><a href="#">Test 1</a></li>
        </ul>
    </li>
    <li class="item-3 deeper parent">
        <a href="test.html">Test 3</a>
        <ul>
            <li class="item-xy"><a href="#">Test 1</a></li>
            <li class="item-xy"><a href="#">Test 1</a></li>
            <li class="item-xy"><a href="#">Test 1</a></li>
        </ul>
    </li>
    <li class="item-4"><a href="test.html">Test 4</a></li>
    <li class="item-5"><a href="test.html">Test 5</a></li>
</ul>

$("li.deeper ul").hide();
$("ul#submenu li.deeper").hover(function(event){
    var myClass = $(this).attr("class");
    var ulcl = myClass.replace("deeper parent","");
    event.stopPropagation();
    $("."+ulcl+" ul").slideToggle();
}); 
```

它可以工作，但有时如果您使用鼠标靠近 li 项目，则子项目开始冒泡。你可以在这里看到它：http: [//jsfiddle.net/andrewwhitaker/ybVFj/](http://jsfiddle.net/andrewwhitaker/ybVFj/)

有人可以帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:54:18.970

它会冒泡，因为当它开始滑动时，您会收到另一个 mouseout 事件，这会再次触发切换。所以，添加一些标志

你的构造有点奇怪，为什么而不是

```
var myClass = $(this).attr("class");
var ulcl = myClass.replace("deeper parent","");
$("."+ulcl+" ul").slideToggle(); 
```

不使用

```
if(!isSliding) {
    isSliding = true;
    $(this).find("ul").slideToggle(function(){isSliding = false;});
} 
```

?

您引用的代码与您在此处发布的代码不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T11:51:49.687

您的`li`元素显示为块，因此它们占据了屏幕的整个宽度。通过 css 减小它们的宽度，或者只使用这个变体：

```
$("li.deeper ul").hide();
$("ul#submenu li.deeper > a").hover(function(event){
    var myClass = $(this).parent().attr("class");
    var ulcl = myClass.replace("deeper parent","");
    event.stopPropagation();
    $("."+ulcl+" ul").slideToggle();
}); 
```

我添加`> a`到选择器并更改`$(this).attr("class")`为`$(this).parent().attr("class")`

# ruby - Ruby 枚举：首先取 n 块返回 true

> ID：13108521
> 
> 赞同：3
> 
> 时间：2012-10-28T11:45:14.693
> 
> 标签：ruby, enumerable

我想获取通过该块的前“n”个条目

```
a = 1..100_000_000 # Basically a long array

# This iterates over the whole array -- no good
b = a.select{|x| x.expensive_operation?}.take(n) 
```

一旦我有 n 个“昂贵”条件为真的条目，我想缩短迭代。

你有什么建议？take_while 并保持计数 n?

```
# This is the code i have; which i think can be written better, but how?
a = 1..100_000_000 # Basically a long array
n = 20
i = 0
b = a.take_while do |x|
  ((i < n) && (x.expensive_operation?)).tap do |r|
    i += 1
  end
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T11:46:54.227

Ruby 2.0 实现了[惰性枚举](http://railsware.com/blog/2012/03/13/ruby-2-0-enumerablelazy/)，对于旧版本使用 gem [enumerable-lazy](https://github.com/yhara/enumerable-lazy)：

```
require 'enumerable/lazy'
(1..Float::INFINITY).lazy.select(&:even?).take(5).to_a
#=> [2, 4, 6, 8, 10] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T13:55:11.920

它应该使用一个简单的`for`循环和一个`break`：

```
a = 1..100_000_000 # Basically a long array
n = 20
selected = []
for x in a
  selected << x if x.expensive_operation?
  break if select.length == n
end 
```

# angularjs - Angularjs取决于父范围

> ID：13108522
> 
> 赞同：0
> 
> 时间：2012-10-28T11:45:20.607
> 
> 标签：angularjs

在使用 AngularJs 构建应用程序时，我问自己以下是否是好的做法

我有“AppController”，其他所有控制器都是它的子级。AppController 有这样的东西。

```
$scope.layout = { sidebar: false, searchbar: true}; 
```

现在，子控制器应该能够更改这些值：

```
$rootScope.sidebar = true; 
```

在这种情况下，我的子模块完全依赖于根控制器，如果我希望这个子控制器在其他应用程序中工作，我必须确保该其他应用程序的父控制器始终具有 $scope.layout 对象。这是好习惯吗？构建父控制器和子控制器都使用的布局模块会更好吗？就像下面的代码：

```
angular.module("app.ui", [])
  .factory("Layout", [function(){
     var _sidebar = false;
     var searchbar = true;

     var sidebar = function(flag){
        if(flag !== undefined) _sidebar = flag;
        return _sidebar;
     }

     var searchbar = function(flag){
        if(flag !== undefined) _searchbar = flag;
        return _searchbar;
     }

return {
   sidebar : sidebar,
   searchbar : searchbar
}
}]) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T05:52:24.333

虽然您想要做的事情可能有其他架构方法（例如，查看有关指令声明的*范围*属性的文档及其使用 @、= 和 & 在父范围中绑定特定属性的工具），但通常服务确实是一个共享对公共数据的访问的好选择。如果您没有在更新值时必须发生的额外逻辑，您可以稍微简化一下：

```
angular.module("app.ui", [])

.service("Layout", function() {
  this.sidebar = false;
  this.searchbar = true;
}) 
```

如果您将此服务注入您的控制器并将其添加到它们的范围内，您可以更新它并监听如下更改：

```
.controller("AppCtl", function($scope, Layout) {
  $scope.Layout = Layout;

  // Method called by a search button, say
  $scope.search = function() {
    Layout.searchbar = true;
  }

  $scope.$watch("Layout.searchbar", function(newVal, oldVal) {
    // Do something in this scope if value has been changed from elsewhere
  });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-02T08:32:19.550

您可以尝试这种方法，在该方法中创建一个触发点击滚动的指令。 [普朗克](http://embed.plnkr.co/mjGE9GOQFUzGzQqYVFAw/preview)

# sql - MS Access 2010 查询多次提取相同的记录，sql 挑战

> ID：13108525
> 
> 赞同：6
> 
> 时间：2012-10-28T11:46:16.990
> 
> 标签：sql, ms-access

我目前正在开发一个使用 ms Access 2010 跟踪我公司库存的程序。我很难获得旨在显示库存的查询以显示我想要的信息。问题似乎是查询多次提取相同的记录，从而夸大了保留和已售产品的总和。

背景：我公司库存钢筋。我们提供将酒吧切成小块。从库存方面，我们想要跟踪每根金条的长度，从它进入仓库的那一刻起，到它在仓库中的时间（它可能会被切成小块），直到整个金条被售出并消失.

数据库：给出问题的查询，正在查询3个表；

*   棒料（具有以下字段）
    *   批号（所有收到的棒材，属于同一生产热度）
    *   BarNo（单个酒吧）
    *   原始长度（在库存收到时棒材的长度

（BatchNumber 和 BarNo 结合，是主键）

*   销售量

    *   ID（主键）
    *   批号
    *   酒吧编号
    *   售出数量
*   预订（当客户表示有兴趣但需要时间来决定时，卖家会保留一些材料）

    *   ID（主键）
    *   批号
    *   酒吧编号
    *   保留数量

我想将三个表中的信息提取到一个列表中，该列表显示：-Barstock.orginial length As Received - Sales.Quantity sold As Sold - Recieved - Sold As On Stock - reservation.Quantity Reserved As Reserved - On Stock -保留为可用。

问题是我不擅长 sql。我已经尽我所能研究了联合和内部连接，但我的努力都是徒劳的。我通常依靠设计视图来生成我需要的 Sql 语句。在设计视图中，我提出了以下 Sql：

```
SELECT 
  BarStock.BatchNo
  , BarStock.BarNo
  , First(BarStock.OrgLength) AS Recieved
  , Sum(Sales.QtySold) AS SumAvQtySold
  , [Recieved]-[SumAvQtySold] AS [On Stock]
  , Sum(Reservation.QtyReserved) AS Reserved
  , ([On Stock]-[Reserved])*[Skjemaer]![Inventory]![unitvalg] AS Available
FROM 
  (BarStock 
    INNER JOIN Reservation ON (BarStock.BarNo = Reservation.BarNo) AND (BarStock.BatchNo = Reservation.BatchNo)
  ) 
    INNER JOIN Sales ON (BarStock.BarNo = Sales.BarNo) AND (BarStock.BatchNo = Sales.BatchNo)
GROUP BY 
  BarStock.BatchNo
  , BarStock.BarNo 
```

我知道查询多次提取相同的记录，因为；- 当我删除 GROUP BY 术语时，我得到了几条完全相同的记录。- 但是，在相应的表中只有这些记录的一个实例。

我希望我能够正确解释自己，请问我是否需要详细说明。

感谢您花时间查看我的问题！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-29T15:11:42.923

！！！检查一些假设

从您的数据库架构中，似乎：

*   *给定的可能*有多个`Sales`记录`BatchNumber/BarNo`（例如，我可以想象多个客户可能购买了同一条的子部分）。
*   *给定的可能*有多个`Reservation`记录`BatchNumber/BarNo`（例如，同一条的多个部分可以“保留”）

要检查这些表中是否确实有多个记录，请尝试以下操作：

```
SELECT CountOfDuplicates
FROM   (SELECT COUNT(*) AS CountOfDuplicates
        FROM   Sales
        GROUP  BY BatchNumber & "," & BarNo)
WHERE  CountOfDuplicates > 1 
```

如果查询返回一些记录，则说明存在重复，这可能是您的查询返回不正确值的原因。

### 从头开始

现在，让你的查询工作的诀窍是真正考虑你想要显示的主要数据是什么，然后从那开始：

*   你基本上想要一个库存中所有柱的列表。其中一些金条可能已售出，或者可能被保留，但如果没有，您应该显示库存中的可用数量。您当前的查询永远不会向您显示。
*   对于库存中的每根棒材，您要列出已售出的数量和保留的数量，并将它们组合起来以找出剩余的可用数量。

所以很明显，您的中心数据是库存条的列表。

与其试图立即将所有内容整合到一个大型查询中，不如为每个目标创建简单的查询，并确保我们在每种情况下都获得正确的数据。

### 只是酒吧

根据您的解释，每个单独的条都记录在`BarStock`表中。
正如我在评论中所说，据我了解，所有交付的酒吧在`BarStock`表中都有一条记录，没有重复。因此，您应该衡量库存的主要清单是下`BarStock`表：

```
SELECT BatchNumber, 
       BarNo, 
       OrgLength
FROM   BarStock 
```

### 只是销售

同样，这应该非常简单：我们只需要找出每`BatchNumber/BarNo`双鞋的总长度：

```
SELECT BatchNumber, 
       BarNo, 
       Sum(QtySold) AS SumAvQtySold
FROM   Sales
GROUP BY BatchNumber, BarNo 
```

### 只是预订

与销售相同：

```
SELECT BatchNumber,
       BarNo,
       SUM(QtyReserved) AS Reserved
FROM   Reservation
GROUP  BY BatchNumber, BarNo 
```

### 原始库存对销售

现在，我们应该能够将前 2 个查询合并为一个。我不是想优化，只是为了让数据一起工作：

```
SELECT BarStock.BatchNumber,
       BarStock.BarNo,
       BarStock.OrgLength,
       S.SumAvQtySold,
       (BarStock.OrgLength - Nz(S.SumAvQtySold)) AS OnStock
FROM   BarStock
LEFT JOIN (SELECT BatchNumber,
                  BarNo,
                  Sum(QtySold) AS SumAvQtySold
           FROM   Sales
           GROUP  BY BatchNumber, BarNo) AS S
  ON (BarStock.BatchNumber = S.BatchNumber) AND (BarStock.BarNo = S.BarNo) 
```

我们这样做是`LEFT JOIN`因为库存中可能有尚未售出的金条。
如果我们做了`INNER JOIN`，我们会在最终报告中错过这些，导致我们相信这些酒吧从一开始就不存在。

### 全部一起

我们现在可以将整个查询包装在另一个`LEFT JOIN`针对保留条的查询中以获得最终结果：

```
SELECT BS.BatchNumber,
       BS.BarNo,
       BS.OrgLength,
       BS.SumAvQtySold,
       BS.OnStock,
       R.Reserved,
       (OnStock - Nz(Reserved)) AS Available
FROM   (SELECT BarStock.BatchNumber,
               BarStock.BarNo,
               BarStock.OrgLength,
               S.SumAvQtySold,
               (BarStock.OrgLength - Nz(S.SumAvQtySold)) AS OnStock
        FROM   BarStock
        LEFT JOIN (SELECT BatchNumber,
                          BarNo,
                          SUM(QtySold) AS SumAvQtySold
                   FROM   Sales
                   GROUP  BY BatchNumber,
                             BarNo) AS S
          ON (BarStock.BatchNumber = S.BatchNumber) AND (BarStock.BarNo = S.BarNo)) AS BS
LEFT JOIN (SELECT BatchNumber,
                  BarNo,
                  SUM(QtyReserved) AS Reserved
           FROM   Reservation
           GROUP  BY BatchNumber,
                     BarNo) AS R
  ON (BS.BatchNumber = R.BatchNumber) AND (BS.BarNo = R.BarNo) 
```

请注意`Nz()`连接右侧的 for 项目的使用：如果给定对没有`Sales`or数据，则and的值将是并且也将呈现null ，而不管库存的实际数量是多少，这不会是我们期望的结果。`Reservation``BatchNumber/BarNo``SumAvQtySold``Reserved``Null``OnStock``Available`

使用 Access 中的查询设计器，您必须分别创建 3 个查询，然后将它们组合起来。请注意，虽然查询设计在处理多个和连接
方面不是很好，所以我认为您不可能一口气写完整个内容。`LEFT``RIGHT`

### 一些评论

我相信你应该阅读@Remou 在他的评论中给你的信息。对我来说，这个数据库有一些不幸的设计选择：获取基本库存数据应该像保存库存记录的列
一样简单。`SUM()`

通常，跟踪库​​存的一种简单方法是跟踪每个库存交易：

*   进货记录有一个+数量
*   出库记录有一个 - 数量
*   该记录还应跟踪零件/项目/棒材参考（或 ID）、交易的日期和时间，以及 - 如果您要管理多个仓库 - 涉及哪个仓库 ID。

因此，如果您需要了解所有物品的完整库存，您需要做的就是：

```
SELECT BarID,
       Sum(Quantity)
FROM   StockTransaction
GROUP BY BarID 
```

在您的情况下，虽然`BatchNumber/BarNo`是您的自然键，但将它们保存在单独的`Bar`表中会有一些优势：

*   您可以使用它`Bar.ID`来取回您需要的任何地方`Bar.BatchNumber`。`Bar.BarNo`
*   您可以在,和表`BarID`中用作外键。它使连接更容易，而不必弄乱复合键的复杂性。`BarStock``Sales``Reservation`

Access 允许的某些事情并不是真正的好习惯，例如表名和字段中的空格，这最终会降低可读性（至少因为您需要将它们保留在 之间`[]`），与表示这些的 VBA 变量名称不太一致字段，并且与不接受表和字段名称的字母数字字符以外的任何其他数据库不兼容（如果您希望稍后扩大大小或将数据库与其他应用程序接口）。

此外，通过坚持单一的命名约定来帮助自己，并保持一致：

*   不要不一致地混合大小写：要么使用 CamelCase，要么使用小写或大写，但始终遵守该规则。
*   以单数或复数形式命名表，但保持一致。我更喜欢使用单数，比如 table`Part`而不是`Parts`，但这只是一个约定（有其自身的原因）。
*   拼写正确：`Received`不是`Recieved`。在调试某些查询或 VBA 代码不起作用的原因时，仅仅因为有人打错了，这个错误可能会让您付出代价。
*   每个表应该/必须有一个`ID`列。通常，这将是一个自动增量，以保证表中每条记录的唯一性。如果您保持该约定，那么外键将变得容易猜测和阅读，并且您不必担心某些业务需求会改变您可能突然发现自己有 2 个相同的事实`BatchNumbers`，由于某种原因您现在无法理解。

关于数据库设计有很多争论，但是每个人都同意某些“规则”，所以我的建议应该是争取：

*   简单性：确保每个表记录一种数据，并且不包含来自其他表的冗余数据（规范化）。
*   一致性：命名约定很重要。无论您选择什么，请在整个项目中坚持下去。
*   清晰性：确保 3 年后的您和其他人可以轻松阅读表名和字段并了解它们的含义，而无需阅读 300 页的规范。并不总是那么清楚，但这是值得努力的事情。

# jquery - jQuery：如何通过单击图像打开/关闭下拉菜单？

> ID：13108526
> 
> 赞同：3
> 
> 时间：2012-10-28T11:46:43.443
> 
> 标签：jquery, option

我想通过单击图像来打开和关闭下拉菜单。下面是我的html。

```
<a href="javascript:void(0);" class="select_button1"><img alt="" src="images/button.gif" /></a>
<select class="select1">
      <option name="test" value="" class="first">Select</option>
      <option name="test" value="" class="">Opt1</option>
      <option name="test" value="" class="">Opt2</option>
</select> 
```

这是我尝试过但似乎不起作用的方法：

```
$(document).ready(function() {
  $('select_button1').click(function() {
   $('.select1').toggle();
  });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:51:54.070

编辑：

正如 techfoobar 所提到的，显然这是不可能的。您可以做的是保持您的选择元素不断扩展并在点击时隐藏/显示它。

HTML：

```
<a href="javascript:void(0);" class="select_button1"><img alt="" src="images/button.gif" /></a>
<br/>
<select class="select1" size="5" style="display:none">        
    <option name="test" value="" class="first">Select</option>       
    <option name="test" value="" class="">Opt1</option>       
    <option name="test" value="" class="">Opt2</option>
</select> 
```

JS：

```
$('.select_button1').click(function() {
    $('.select1').toggle();
}); 
```

[http://jsfiddle.net/WYm4H/4/](http://jsfiddle.net/WYm4H/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T11:59:59.577

这对于默认选择框是不可能的。您可以尝试使用用于选择框的插件或自行创建的插件。它们通常可以通过事件打开/关闭。

也许这将是一种方式

```
$('.select_button1').click(function() {
  var $select = $( '.select1' );
  var options = $select.children().size();
  var size = $select.attr( 'size' );
  $('.select1').attr('size', ( size != options ? options : 1 ) );
}); 
```

# scala - Scala - foldLeft 类型推断失败

> ID：13108527
> 
> 赞同：3
> 
> 时间：2012-10-28T11:46:44.807
> 
> 标签：scala, types, fold

在我的代码中，我有以下内容：

```
 type Occurrences = List[(Char, Int)]

  def subtract(x: Occurrences, y: Occurrences): Occurrences = {
    val yMap = y.toMap
    x foldLeft (List[(Char, Int)]()) {  // ERROR
        case (a: List[(Char, Int)], xe: (Char, Int)) =>
        if(yMap.contains(xe._1)) (xe._1 -> (xe._2 - yMap(xe._1))) :: a
        else a
    }
  } 
```

它在编译时失败，就`{`在代码中的错误标记之前。错误消息如下：

> 扩展函数缺少参数类型匿名函数的参数类型必须是完全已知的。(SLS 8.5) 预期类型为：Int

1）怎么可能？据我所知，这里没有对类型信息进行误解的余地，我在互联网上找到了很多这样的例子。我该如何解决？

2）为什么认为预期的类型`Int`毕竟是？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-28T11:52:24.147

发生错误是因为您写`xs foldLeft (init) (f)`的不是`(xs foldLeft init)(f)`or `xs.foldLeft(init)(f)`。

前者不起作用，因为 Scalas 运算符符号规则只允许在调用发生时留下点和括号 form `obj method param`，但情况并非如此，`foldLeft`因为它有两个参数列表。

# c# - ASP.NET 3-Tier / 3-Layer 架构 - 如何分离 UI 和 BLL

> ID：13108533
> 
> 赞同：4
> 
> 时间：2012-10-28T11:47:04.683
> 
> 标签：c#, asp.net, n-tier-architecture

我目前正在攻读计算机科学学位的最后一年，并正在完成我的期末项目和论文。我将使用 ASP.NET Web 窗体和 C# 来创建一个 3 层项目 - 我不能真正称它为 3 层，因为它很可能永远不会托管在我本地 PC 以外的任何东西上进行测试，因为它是仅用于单一用途。

我的主要问题是：

根据我的理解，3-Layer 的想法是 BLL 引用 DAL，UI 引用 BLL 以创建完全的关注点分离。然而，我在几个教程之后做了一个小型模拟项目，所以掌握 3-Layer 的窍门，大多数基本教程仍然需要 UI 和 BLL 之间的参考。

例如在我创建的项目中，这是一个非常基本的 Products 和 Categories 类型的电子商务系统，我在 DAL 中创建了 Product 和 ProductDAL 类，然后在 BLL 中创建了 ProductBLL 类。通过这种设置，只使用一个数据库表（暂时忘记类别），BLL 似乎只是作为 UI 和 DAL 之间的一种接口，方法与 DAL 中的方法完全相同，并且只调用 DAL版本。

问题是要通过 BLL 访问 DAL，我必须将 Product 对象传递给 BLL 方法参数，这意味着首先在 UI 中创建 Product 对象，这意味着从 UI 引用 DAL。这是正确的做事方式吗？

我可以通过在 BLL 中创建一个方法来解决这种简单的情况，该方法采用适当的字段（例如字符串和整数）来创建产品对象并将其返回给 AddProduct 方法。但是，在将不同的产品属性绑定到 UI 中的标签时，我仍然需要访问 Product 对象。

所以本质上，我是否需要在 BLL 中加载大量方法来访问产品对象的属性？如果不是，那么实际上什么样的方法会去那里，你能给我一些在这种产品场景中可能进入 BLL 的方法的例子吗？

提前致谢，如果之前有人问过这个问题，我深表歉意——我确实阅读了很多关于 3 层架构的帖子，但大多数都是非常基础的，只能访问一张表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T11:55:34.990

> BLL 似乎只是作为 UI 和 DAL 之间的一种接口

这只是因为这个应用程序非常简单——目前只是一个 CRUD 接口。更复杂的应用程序具有将封装在 BLL 中的*业务规则（而不是在 UI 或 DAL 中）。*

> 我必须将 Product 对象传递给 BLL 方法参数，这意味着首先在 UI 中创建 Product 对象，这意味着从 UI 引用 DAL。这是正确的做事方式吗？

好吧，这里有几种不同的选择：

*   您可以拥有一个在不同层之间*共享*`Product`的数据访问对象 (DAO) 。此对象不是 DAL 对象，但 DAL 使用它。它被称为**DTO** - 数据传输对象。
****   您可以有几个不同的`Product`对象——一个由 UI 使用，一个由 BLL 使用，一个由 DAL 使用，并且具有映射层以在不同对象之间进行转换。*   以上的一些组合。***

 **** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T11:59:29.137

分离关注点的一种常见方法是从一个名为 YourProject.Entities 或类似名称的项目开始。这包含主要的类定义，当您需要获得像客户或产品或类似的东西这样的大型实体时，您可以引用它。此外，您还有另一个项目作为存储库。根据您使用的技术，它可以实现类似 EF 的东西来从您的数据库中获取您的对象，或者可以包含直接使用 SQL 或存储过程查询您的数据库的方法。

您必须记住的是，这些项目主要是根据用户输入来运行的。您的用户将采取行动，您的程序将做出响应。这个想法是实际的业务逻辑与你的 UI 和数据访问是分开的。您可以根据需要混合和匹配这些想法，但在我的专业经验中，我倾向于在事物的数据库访问端执行基本的数据约束实施，并且在实体项目中创建对象时直接完成数据验证或在以实体为参数的单独实体验证项目中。

如果您不想拥有单独的验证项目，请记住，您可以使用构造函数和属性直接在对象中实现业务逻辑。构造函数可以在创建对象之前对输入强制执行逻辑，并使用完整的属性——也就是说……

```
private string myProp    

public string MyProp
{
    get
    {
        // Some code
    }
    set
    {
        // Some code
    }
} 
```

而不是这个...

```
public string MyProp { get; set; } 
```

允许您在访问与这些属性关联的数据时实施规则。

最后，这些问题可以有多种不同的回答方式，我相信对这个问题的每一次回答都会让你对最佳的做事方式有不同的想法和看法。对我来说，我一直遵循的两条规则是 DRY（不要重复自己）和代码可维护性。通过将逻辑与数据访问与 UI 中的对象设计分离，您将更容易维护和更新您的程序……即使它只是一个学校项目；）。***

# jquery - 雅虎财经彗星技术

> ID：13108534
> 
> 赞同：2
> 
> 时间：2012-10-28T11:47:28.973
> 
> 标签：jquery, comet, yahoo, finance

雅虎财经使用了一种基于彗星的股票报价获取技术

[评论网址： http](http://streamerapi.finance.yahoo.com/streamer/1.0?s=AAPL&k=l10,a00,b00&callback=parent.yfs_u1f&mktmcb=parent.yfs_mktmcb&gencallback=parent.yfs_gencb) ://streamerapi.finance.yahoo.com/streamer/1.0?s =AAPL&k=l10,a00,b00&callback=parent.yfs_u1f&mktmcb=parent.yfs_mktmcb&gencallback=parent.yfs_gencb

无休止的回应：

```
<html><head><script type='text/javascript'> document.domain='finance.yahoo.com'; </script> </head><body></body><script>try{parent.yfs_u1f({"AAPL":{l10:"604.00",a00:"603.70",b00:"603.36"}});}catch(e){}</script> 
```

一旦股票报价实时变化，响应就会增加，并附加以下内容：

```
<script>try{parent.yfs_u1f({"AAPL":{l10:"604.10",a00:"603.70",b00:"603.36"}});}catch(e){}</script> 
```

所以我试图通过创建 iframe 来捕获这些数据：

```
<iframe src="http://streamerapi.finance.yahoo.com/streamer/1.0?s=AAPL&k=l10,a00,b00&callback=parent.yfs_u1f&mktmcb=parent.yfs_mktmcb&gencallback=parent.yfs_gencb" /> 
```

以及处理该功能的脚本：

```
<script>function yfs_u1f(data){alert(data);}</script> 
```

但脚本没有执行，我猜是因为同源策略。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-27T13:43:33.193

我一直在寻找同样的东西，发现了这个：

[http://blog.ijun.org/2010/12/grab-yahoo-stock-data-streamerapi.html](http://blog.ijun.org/2010/12/grab-yahoo-stock-data-streamerapi.html)

# java - 从“肮脏的富客户端”中理解 Swing 代码

> ID：13108536
> 
> 赞同：1
> 
> 时间：2012-10-28T11:47:42.527
> 
> 标签：java, swing, graphics2d

下面是来自 Romain Guy 和 Chet Haase 的“肮脏的富客户”的代码

```
private class ImageViewer extends JComponent {
    private BufferedImage image, landscape;

    private ImageViewer() {
        try {
            image = ImageIO.read(new File("picture.png"));
            landscape = ImageIO.read(new File("landscape.jpg"));
        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }

    @Override
    protected void paintComponent(Graphics g) {
        BufferedImage temp = new BufferedImage(getWidth(), getHeight(),
            BufferedImage.TYPE_INT_ARGB);
        Graphics2D g2 = temp.createGraphics();

        if (shadow.isSelected()) {
            int x = (getWidth() - image.getWidth()) / 2;
            int y = (getHeight() - image.getHeight()) / 2;
            g2.drawImage(image, x + 4, y + 10, null);

            Composite oldComposite = g2.getComposite();
            g2.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_IN, 0.75f));
            g2.setColor(Color.BLACK);
            g2.fillRect(0, 0, getWidth(), getHeight());
            g2.setComposite(oldComposite);
            g2.drawImage(image, x, y, null);
        } else {
            int x = (getWidth() - image.getWidth()) / 2;
            int y = (getHeight() - image.getHeight()) / 2;
            g2.drawImage(image, x, y, null);

            Composite oldComposite = g2.getComposite();
            g2.setComposite(AlphaComposite.SrcIn);
            x = (getWidth() - landscape.getWidth()) / 2;
            y = (getHeight() - landscape.getHeight()) / 2;
            g2.drawImage(landscape, x, y, null);
            g2.setComposite(oldComposite);
        }

        g2.dispose();
        g.drawImage(temp, 0, 0, null);
    }
} 
```

选中复选框时，获取以下具有不同状态的输出是代码的一部分：- ![在此处输入图像描述](../Images/815112bace73e278a28c32c5744a0913.png)

我不明白的是

1）什么是线

```
BufferedImage temp = new BufferedImage(getWidth(), getHeight(),
        BufferedImage.TYPE_INT_ARGB); 
```

在那里这样做是因为如果我只编写以下代码并运行，则输出中不会获得任何内容。

```
BufferedImage temp = new BufferedImage(getWidth(), getHeight(),
        BufferedImage.TYPE_INT_ARGB);
    Graphics2D g2 = temp.createGraphics();

    if (jcb.isSelected()) {
        int x = (getWidth() - image.getWidth()) / 2;
        int y = (getHeight() - image.getHeight()) / 2;
        g2.drawImage(image, x + 4, y + 10, null);
           } 
```

2）创建“temp”缓冲图像后需要获取g2吗？我不能像这样直接做吗

```
Graphics2D g2=(Graphics2D)g.create(); 
```

3) TYPE_INT_RGB 和 TYPE_INT_ARGB 的实际区别是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T11:58:43.570

这是双缓冲： [http ://docs.oracle.com/javase/tutorial/extra/fullscreen/doublebuf.html](http://docs.oracle.com/javase/tutorial/extra/fullscreen/doublebuf.html)

您首先在屏幕外图像上绘制，在这种情况下，它由变量 temp 中引用的 BufferedImage 对象支持；然后你对屏幕外的图像做任何事情；最后，您通过 g.drawImage(temp, ...) 在组件上打印结果。这不是为了让用户看到由于直接在屏幕上构建的图像而导致的故障或伪影。

# webkit - Webkit：图像覆盖圆形边框

> ID：13108537
> 
> 赞同：0
> 
> 时间：2012-10-28T11:47:53.950
> 
> 标签：webkit, border, css

在图像上使用圆角边框时，webkit 浏览器会将边框隐藏在图像后面

**CSS**

```
img {
    border: 10px solid #000;
    border-radius: 100%;    
} 
```

**HTML**

```
<img src="http://25.media.tumblr.com/tumblr_mbjei3b3re1r30y2do1_500.jpg" /> 
```

**错误转载[@http://jsfiddle.net/zPpVm/](http://jsfiddle.net/zPpVm/)**

这可能与[这个 Webkit bug](https://stackoverflow.com/q/5736503/681807)有关，但我找不到合适的解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:53:45.927

一种可能的解决方法是使用`box-shadow`：

```
box-shadow: 0 0 0 10px black; 
```

**[现场示例](http://jsfiddle.net/zPpVm/1/)**

主要问题：它不会在盒子模型中计算

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T12:07:25.533

作为另一种解决方法，您可以像这样包装图像：

```
 <span class="img_container" >
    <img src="http://25.media.tumblr.com/tumblr_mbjei3b3re1r30y2do1_500.jpg" />
 </span> 
```

比风格元素：

```
.img_container {
    border: 10px solid #000;
    border-radius: 100%; 
    display: inline-block;
    overflow: hidden;
}
.img_container img {
    display: block;
} 
```

除 Opera 之外的所有现代浏览器都会正确呈现它。

# node.js - 在 node.js 上运行多个站点

> ID：13108543
> 
> 赞同：7
> 
> 时间：2012-10-28T11:48:35.287
> 
> 标签：node.js

我打算使用 node.js 做三个站点。我在网站中有一些通用模板。我应该在单个 node.js 实例上运行所有三个站点吗？

我知道允许您在单个 http 服务器上运行多个域的“虚拟主机”中间件。有没有更好的选择来做到这一点？

我也有一些静态 html 模板，不知道如何在 node.js 中处理这些？

最后我想知道这种设置的托管选项？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-28T12:31:54.693

我自己只需要做同样的事情。你想要做的是使用某种反向代理。

我使用的是这里：[https ://github.com/nodejitsu/node-http-proxy](https://github.com/nodejitsu/node-http-proxy)

只需安装代理包：`npm install http-proxy`

我所做的是让代理在服务器的 80 端口上运行。我在每个域上设置 DNS 以指向该服务器。

每个应用程序都在同一台服务器上运行（我使用屏幕）。

例如：

```
MySiteApplication1 - 3001
MySiteApplication2 - 3002
MySiteApplication3 - 3003 
```

然后您的代理服务器文件将如下所示

```
var httpProxy = require('http-proxy');

var server = httpProxy.createServer({
   router: {
     'mysite1.com': 'localhost:3001',
     'mysite2.com': 'localhost:3002',
     'mysite3.com': 'localhost:3003'
   }
});

server.listen 80 
```

# java - 如何找到 jvm 中的会话数？

> ID：13108554
> 
> 赞同：1
> 
> 时间：2012-10-28T11:49:30.280
> 
> 标签：java, session, jvm, application-server

> **可能重复：**
> [查找从给定客户端 IP 创建的活动会话数](https://stackoverflow.com/questions/3679465/find-number-of-active-sessions-created-from-a-given-client-ip)
> [使用 Java 获取 Tomcat 中的活动会话列表](https://stackoverflow.com/questions/4069444/getting-a-list-of-active-sessions-in-tomcat-using-java)

我想知道 JVM 中的会话数。如何在应用服务器中找到它来管理它？应用服务器是tomcat。

# git - 来自heroku的Git结帐

> ID：13108556
> 
> 赞同：1
> 
> 时间：2012-10-28T11:49:44.070
> 
> 标签：git, heroku

我想用我已经部署到 heroku 并且当前正在运行的代码“刷新”我的本地代码库。

我做了一个

```
git pull heroku master 
```

并收到一条消息说一切都是最新的。然后我尝试了

```
git checkout master 
```

希望这会用 Heroku 上可用的内容覆盖我的本地代码副本。然而这并没有奏效。如何“获取”部署到 Heroku 的代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T15:35:37.433

它只是一个 git 遥控器，就像其他任何东西一样。如果您希望本地 master 分支准确反映 heroku 中当前的内容（可能您的本地副本不正确地分歧），您可以

```
git fetch heroku
git reset --hard heroku/master 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T14:11:55.587

在你的分支上做一个`git checkout .`，这将删除你所有的本地更改。

之后你不需要拉代码

# c# - 使用 LINQ 的 Facebook 好友

> ID：13108558
> 
> 赞同：0
> 
> 时间：2012-10-28T11:49:54.657
> 
> 标签：c#, .net, facebook, linq, linq-to-sql

我正在构建一个 linq-to-sql Web 应用程序，但遇到了问题。我正在尝试使用从 facebook 实时获取的用户朋友列表，然后将它们加入到 SQL 表中。

为此，我通常使用 .Contains(friends) ，其中朋友是用户 ID。问题是当朋友超过 2100 个值并且我遇到异常时，LINQ 将无法使用 .contains(friends) 。

所以我的问题是 - 动态阅读用户的朋友并将其与我的 SQL 表一起加入的最佳做法是什么？

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T12:09:37.250

发出多个查询，每个查询最多 2100 个值。您看到的问题是 SQL Server 每个查询批次只能接受 2100 个 SQL 参数。

从这个意义上说，您的问题与 Facebook 无关。这是由 LINQ to SQL 决定发送的查询类型触发的 SQL Server 限制（并且没有办法让它以不同的方式发送查询）。

# java - Hibernate 中的小写注释

> ID：13108559
> 
> 赞同：4
> 
> 时间：2012-10-28T11:50:16.257
> 
> 标签：java, hibernate, jpa

在休眠中有什么方法可以将实体的列注释为字符串小写？我的意思是例如

```
@Entity  
public class User {  
    @Column  
    private String username;  
} 
```

我希望休眠将所有查询中的用户名转换为小写，而不是绑定到特定数据库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T12:20:35.613

例如，您可以在 setter 中创建它：

```
public void setUsername(String username) {
    this.username = username.toLowerCase();
} 
```

或者使用interseptor：

```
 public boolean onSave(Object entity,Serializable id, Object[] state,String[] propertyNames,Type[] types) throws CallbackException {
    if (entity instanceof User ){
        entity.username = usename.toLowerCase();
    }
    return false;
} 
```

你可以在这里阅读更多关于拦截器的信息： [http ://www.mkyong.com/hibernate/hibernate-interceptor-example-audit-log/](http://www.mkyong.com/hibernate/hibernate-interceptor-example-audit-log/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-28T13:27:07.610

`UserType`您可以为此字符串编写自己的

```
public class LowerCaseString implements UserType
 {  
     //....  
        public void nullSafeSet(PreparedStatement preparedStatement, Object value, int index)
            throws HibernateException, SQLException {
        Hibernate.STRING.nullSafeSet(preparedStatement, 
                (value != null) ? ((String)value).toLowerCase() : null, index);
         }  
    ///....  
} 
```

你实体

```
@Entity  
public class User {  
    @Column  
    @Type(type="com.youcompany.LowerCaseString")
    private String username;  
} 
```

# python - Python：比较更多的数字

> ID：13108561
> 
> 赞同：1
> 
> 时间：2012-10-28T11:50:23.790
> 
> 标签：python, for-loop, numbers, compare

我想在现有列表中搜索数字。如果重复此数字之一，则将变量的值设置为 true 并中断循环。

```
list = [3, 5, 3] //numbers in list 
```

因此，如果函数得到两个相同的数字，则中断 - 在这种情况下，有 3 个重复。

怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T11:54:33.977

首先，不要命名您的列表`list`。那是[**Python 内置的**](http://docs.python.org/2/library/functions.html#list)，使用它作为变量名会产生不希望的副作用。`L`让我们改为调用它。

[**您可以通过将列表与自身的集合**](http://docs.python.org/2/library/functions.html#func-set)版本进行比较来解决您的问题。

**编辑：当有**重复时，你想要 true ，而不是相反。代码已编辑。

```
def testlist(L):
    return sorted(set(L)) != sorted(L) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T11:54:13.430

你可以使用`collections.Counter()`和`any()`：

```
>>> lis=[3,5,3]
>>> c=Counter(lis)
>>> any(x>1 for x in c.values()) # True means yes some value is repeated
True
>>> lis=range(10)
>>> c=Counter(lis)
>>> any(x>1 for x in c.values()) # False means all values only appeared once
False 
```

或使用`sets`和匹配长度：

```
In [5]: lis=[3,3,5]

In [6]: not (len(lis)==len(set(lis)))
Out[6]: True

In [7]: lis=range(10)

In [8]: not (len(lis)==len(set(lis)))
Out[8]: False 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-28T11:56:41.600

你可以看看[set](http://docs.python.org/2/library/sets.html)。你遍历你的列表，或者将数字添加到支持集，或者打破循环。

```
>>> l = [3, 5, 3]
>>> s = set()
>>> s
set([])
>>> for x in l:
...     if x not in s:
...         s.add(x)
...     else:
...         break 
```

您还可以更进一步，使用此代码创建一个函数，返回您找到的第一个重复数字（或者`None`如果列表不包含重复项）：

```
def get_first_duplicate(l):
    s = set()
    for x in l:
        if x not in s:
            s.add(x)
        else:
            return x

get_first_duplicate([3, 5, 3])
# returns 3 
```

否则，如果您想获得“此列表是否包含重复项？”问题的布尔答案，您可以返回它而不是重复元素：

```
def has_duplicates(l):
    s = set()
    for x in l:
        if x not in s:
            s.add(x)
        else:
            return true
    return false

get_first_duplicate([3, 5, 3])
# returns True 
```

* * *

**[senderle](https://stackoverflow.com/users/577088/)**指出：

> 人们有时会使用一种成语将这种逻辑压缩成几行。我不一定推荐它，但值得知道：

```
s = set(); has_dupe = any(x in s or s.add(x) for x in l) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T11:59:48.813

你永远不应该给`list`变量起名字——`list`它是 Python 中的一种*类型*，你会给自己带来各种各样的问题来掩盖这样的内置名称。给它一个描述性的名字，比如`numbers`.

也就是说......您可以使用一组来跟踪您已经看到的数字：

```
def first_double(seq):
    """Return the first item in seq that appears twice."""
    found = set()
    for item in seq:
        if item in found:
            return item
            # return will terminate the function, so no need for 'break'.
        else:
            found.add(item)

numbers = [3, 5, 3]
number = first_double(numbers) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-28T12:07:43.360

没有额外的内存：

```
any(l.count(x) > 1 for x in l) 
```

# design-patterns - 存储库模式和集合错误处理

> ID：13108564
> 
> 赞同：4
> 
> 时间：2012-10-28T11:50:50.850
> 
> 标签：design-patterns, repository-pattern, service-layer

假设我有存储库：

```
interface IRepo
{
    Foo Get(int id);
    void Add(Foo f);
} 
```

现在，要求我只能拥有一个`Foo`具有给定属性的人，比如说`Id`...。显然，如果我`IRepo`使用一些 SQL 后端实现并映射`Foo.Id`到主键，我会免费获得类似的东西——我可能会以某种`PKViolationException`. 但这正在变得特定于实现，所以无论我在哪里使用这个`IRepo`实现并开始捕获这些异常，我都会失去松散耦合的好处。

现在，我将如何解决这个问题？我是否应该添加某种服务层，首先检查对象是否存在，然后抛出一些独立于存储库的异常？

```
class Service
{
    IRepo repo;

    public void AddFoo(Foo foo)
    {
        if(repo.Get(foo.Id) != null)
            repo.Add(foo);
        else
            throw new FooAlreadyExistsException(foo.Id);
    }
} 
```

这个解决方案似乎很糟糕，因为它`repo.Add(foo)`仍然会引发一些异常，尤其是在检查之后（通过其他一些活动）添加了具有给定 ID 的对象时，所以我只是向我的基础架构添加了一个额外的调用，而几乎没有好处。

似乎我应该小心并`IRepo`在考虑到这种异常的情况下实现（可以捕获`PKViolationException`并将其转换`FooAlreadyExistsException`为示例 SQL 实现），但是如何确保每个`IRepo`实现都遵循这样的规范？

您一般如何解决这些问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T10:49:08.500

*“看来我应该小心并在考虑到这种异常的情况下实现 IRepo（可以捕获 PKViolationException 并将其转换为 FooAlreadyExistsException 在示例 SQL 实现中）”*

你在这个钱上是对的。抛出的异常成为接口契约的一部分，实现必须遵守这个契约。编译器不会为您强制执行此操作，因此您必须绝对清楚预期。

*“但是如何确保每个 IRepo 实现都遵循这样的规范呢？”*

作为接口编写者，您不能对实现它的类负责。如果其他类有缺陷并暴露了泄漏的抽象，那就是它们的缺陷。您所能做的就是绝对清楚您正在定义的合同。

存储库的目的是抽象出数据库的实现细节，**包括它的异常**。因此，您还应该抽象出实现特定的异常......

```
interface IRepo
{
    /// <exception cref="FooAlreadyExistsException">Thrown if the specified Foo object already exists in the database.</exception>
    void Add(Foo f);
}

class ConcreteRepo
{
    public void Add(Foo f)
    {
        try
        {
            // Database stuff...
        }
        catch (PKViolationException e)
        {
            throw new FooAlreadyExistsException(e);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T12:28:26.077

首先，考虑以下问题：您更改存储库使用的底层后备存储的概率是多少（即从具有主键的数据库转到一些没有唯一 ID 概念的未知数据存储）？我猜这个概率非常接近于 0。YAGNI 在这里适用。不要开始实现代码，以防发生一些不太可能发生的未知更改。当实际发生更改时，再进行必要的更改。

然后，关于您的示例，您为什么不为要添加的实体生成一个新 ID（或让底层数据存储为您完成），而不是强制客户端代码之前执行它？ID 应该使用数据库序列、UUID 或 n 自动增量列自动生成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-29T10:41:06.603

我首先要说的是

> repo.Add(foo) 仍然可以抛出一些异常，尤其是在检查后立即添加了具有给定 ID 的对象时（通过其他一些活动）

是过度工程的一部分。

如果您强烈认为您的 Add 方法必须进行大量验证，则将您的方法命名为 **TryAdd** ，例如**TryParse**。这样，您的 Add 方法的调用者就知道 Add 方法在添加值之前会进行验证。

# java - 将 Java 解密代码迁移到 Golang

> ID：13108567
> 
> 赞同：9
> 
> 时间：2012-10-28T11:51:13.837
> 
> 标签：java, go, aes, bzip2

在过去的几天里，我一直在努力将 Java 代码迁移到 Golang，现在我陷入了困境。这是有效的 Java 代码：

```
final Key k = new SecretKeySpec(keyString.getBytes(), "AES");
Cipher c = Cipher.getInstance("AES");
c.init(Cipher.DECRYPT_MODE, k);

final InputStream in = new BufferedInputStream(new FileInputStream(fileNameToDecrypt));
final CipherInputStream instream = new CipherInputStream(in, c);

if (instream.read() != 'B') {
    System.out.println("Error");
}

if (instream.read() != 'Z') {
    System.out.println("Error");
}

final CBZip2InputStream zip = new CBZip2InputStream(instream); 
```

我在 Golang 中的实现：

```
c, _ := aes.NewCipher([]byte(keyString))
// IV must be defined in golang
iv := []byte{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
d := cipher.NewCBCDecrypter(c, iv)

fi, _ := os.Open(fileNameToDecrypt)
stat, _ := fi.Stat()
enc := make([]byte, stat.Size())
dec := make([]byte, stat.Size())
fi.Read(enc)
d.CryptBlocks(dec, enc)
instream := bytes.NewBuffer(dec)
zip := bzip2.NewReader(instream) 
```

到目前为止我所知道的：

*   省略的所有错误值`_`都`nil`在这段代码中
*   必须省略 bzip2 标头（“BZ”）`CBzip2InputStream`，但不能`bzip2.NewReader`
*   从 Java 和 golang 中读取的前 16 个字节`instream`是相同的，从第 17 个字节开始所有字节因任何原因而不同

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-29T09:12:39.663

CBizp2InputStream 确实使用 AES ECB。这是一个有效的实现。我省略了错误处理以使代码更短：

```
c, _ := aes.NewCipher([]byte(keyString))
bufIn := make([]byte, 16)
bufOut := make([]byte, 16)
dec := bytes.NewBuffer(make([]byte, 0))
var i int

for {
    i, _ = src.Read(bufIn)
    if i == 0 {
        break
    }

    c.Decrypt(bufOut, bufIn)
    dec.Write(bufOut)
}

zip := bzip2.NewReader(dec)
io.Copy(dst, zip) 
```

补充说明：

*   src 是一个 io.Reader，dst 是一个 io.Writer，两者都作为参数提供给解密函数
*   keyString 包含密钥
*   我`i == 0`用作中断条件，因为`err`在最后一次成功读取中可以或不能设置为 io.EOF（请参阅[golang io.Reader 规范](http://golang.org/pkg/io/#Reader)）

完美运行。现在实施加密应该很容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-17T05:30:48.837

我正在尝试相同但使用三重 DES ECB 模式。我找到了 ECB 的代码，因为它没有在 go crypto lib 中实现，因为它不安全。但是，在初始化三重 DES 密码时，我收到密钥长度错误，我必须使用某个密钥。密码库中引发错误的代码是：

```
// NewTripleDESCipher creates and returns a new cipher.Block.
func NewTripleDESCipher(key []byte) (cipher.Block, error) {
if len(key) != 24 {
    return nil, KeySizeError(len(key))
} 
```

我能做些什么来克服这个问题？请注意，在 Java 中我没有这个问题。

# javascript - 单击时出现javascript / jquery问题

> ID：13108569
> 
> 赞同：0
> 
> 时间：2012-10-28T11:51:37.377
> 
> 标签：javascript, jquery, click

我的 java 脚本代码出了点问题。我有一个基本的 html 页面和这段代码

```
<div class="myclass" id="myid"> 
   <h3 class="myotherclass"><?php echo _("Some sentence"); ?></h3>
</div> 
```

当我把这个脚本：

```
<script type="text/javascript">
    $("div").click(function () {
        alert('hello');
    });
</script> 
```

单击 div 标签会触发警报消息，但是当我输入以下内容时：

```
<script type="text/javascript">
    $("h3").click(function () {
        alert('hello');
    });
</script> 
```

什么都没有触发。有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T11:54:40.503

您应该将代码放在文档就绪处理程序中：

```
$(document).ready(function(){
   // ...
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T15:55:57.060

实际上，在这种情况下，您可以使用 jquery 的 live() 语法：`.live( events, handler(eventObject) )`，请参见[此处](http://api.jquery.com/live/)。您还可以使用 on() 语法 .on( events [, selector] [, data] , handler(eventObject) ) 因为对于最新版本的 jquery，live 开始被弃用，请参见[此处](http://api.jquery.com/on/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T11:56:39.027

您是否将代码包装在就绪处理程序中。

```
$("document").ready(function(){}) 
```

# python - Python - 从服务器端的 http 标头获取字段

> ID：13108570
> 
> 赞同：0
> 
> 时间：2012-10-28T11:51:42.603
> 
> 标签：python, http-headers, webapp2

我需要知道客户请求的日期/时间。

[我想]这些信息嵌入在 post http 请求的标头部分中。

那么，如何在 webapp2.RequestHandler 类中获取它们？

```
class GetPostHeaderFields(webapp2.RequestHandler):
    def post(self):
        <date or time or datetime whatever> = ??? 
```

坦克寻求任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T12:15:36.767

这取决于您使用的框架。在 webapp2 的情况下，它可以作为`request.headers`. 见[链接](http://webapp-improved.appspot.com/guide/request.html#getting-the-current-request)

```
class MyHandler(webapp2.RequestHandler):
    def post(self):
        name = self.request.get('name')
        #Access request headers here
        request.headers['Cookie'] = 'test=value' #Could be anything like Authorization, etc 
```

如果是 Django，您可以将其作为字典对象访问`request.META`，请参见[此处](https://docs.djangoproject.com/en/dev/ref/request-response/#django.http.HttpRequest.META)

# vb.net - 在 VB .NET 中将 DateTime 转换为秒数

> ID：13108574
> 
> 赞同：7
> 
> 时间：2012-10-28T11:51:50.373
> 
> 标签：vb.net, datetime, time, datetime-conversion

为了将秒数转换为 DateTime，在 VB .NET 中，我使用以下代码：

```
 Dim startDate As New DateTime(1970, 1, 1)
    Dim targetDate As DateTime
    Dim noOfSeconds As Integer = DataInSeconds

    targetDate = startDate.AddSeconds(noOfSeconds) 
```

其中 DataInSeconds 是一个包含秒数的整数（从 1970 年 1 月 1 日开始）

这很好用。但我不知道如何进行逆变换。（从 DateTime 到秒数）。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-28T11:58:36.720

当您`DateTime`从彼此中减去实例时，您会得到一个[`TimeSpan`](http://msdn.microsoft.com/en-us/library/system.timespan.aspx)- 您可以使用它来获取秒数：

```
Dim startDate As New DateTime(1970, 1, 1)
Dim noOfSeconds As Integer

noOfSeconds = (currentDate - startDate).TotalSeconds 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-28T12:24:00.653

1/1/1970 是 Unix 时代。请注意，它是 UTC 日期，您不能在转换中忽略它。因此：

```
Module DateConversion
    Public ReadOnly Property Epoch() As DateTime
        Get
            Return New DateTime(1970, 1, 1, 0, 0, 0, DateTimeKind.Utc)
        End Get
    End Property

    Public Function FromUnix(ByVal seconds As Integer, local As Boolean) As DateTime
        Dim dt = Epoch.AddSeconds(seconds)
        If local Then dt = dt.ToLocalTime
        Return dt
    End Function

    Public Function ToUnix(ByVal dt As DateTime) As Integer
        If dt.Kind = DateTimeKind.Local Then dt = dt.ToUniversalTime
        Return CInt((dt - Epoch).TotalSeconds)
    End Function
End Module 
```

注意 ToUnix()，DateTimeKind 可能未指定，就像在您的代码段中一样。考虑改用 DateTimeOffset 以使其明确。当所有这一切都崩溃时，一定要在 2038 年做一些合理的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-29T21:55:05.463

```
Label1.Text = New DateTime(1970, 1, 1, 0, 0, 0, 
    DateTimeKind.Utc).AddSeconds(CLng(TextBox1.Text) / 1000) 
```

制作一个文本框、一个按钮和一个标签，将此代码放入按钮中，根据您使用的是微秒（保留 /1000）还是秒（删除 /1000）将显示日期/时间等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-29T14:36:02.340

```
Public Function Date2Unix(ByVal vDate As Date) As Long
 Return (vDate - #1970/01/01#).TotalSeconds
End Function

Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
 MsgBox(Date2Unix(Now()))
End Sub 
```

# c# - 如何以编程方式获取当前的 Trace Switch？

> ID：13108577
> 
> 赞同：7
> 
> 时间：2012-10-28T11:52:06.800
> 
> 标签：c#, web-config, system.diagnostics

在我的`web.config`我有：

```
<system.diagnostics>
  <switches>
    <add name="logLevelSwitch" value="1" />
  </switches>
</system.diagnostics> 
```

有没有办法可以调用，例如：

`System.Diagnostics.TraceSwitch["logLevelSwitch"]`获取当前值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-29T10:25:33.463

一旦你在`web.config`文件中定义了开关值，就可以很容易地通过创建一个[`TraceSwitch`](http://msdn.microsoft.com/fr-fr/library/system.diagnostics.traceswitch%28v=vs.71%29.aspx)同名的来从你的应用程序中获取这个值：

```
private static TraceSwitch logSwitch = new TraceSwitch("logLevelSwitch",
    "This is your logLevelSwitch in the config file");

public static void Main(string[] args)
{
    // you can get its properties value then:
    Console.WriteLine("Trace switch {0} is configured as {1}",
        logSwitch.DisplayName,
        logSwitch.Level.ToString());

    // and you can use it like this:
    if (logSwitch.TraceError)
        Trace.WriteLine("This is an error");

    // or like this also:
    Trace.WriteLineIf(logSwitch.TraceWarning, "This is a warning");
} 
```

此外，根据文档，要使其正常工作：

> 您必须启用跟踪或调试才能使用开关。以下语法是特定于编译器的。如果您使用 C# 或 Visual Basic 以外的编译器，请参阅编译器的文档。
> 
> 要在 C# 中启用调试，`/d:DEBUG`请在编译代码时将标志添加到编译器命令行，或者可以添加`#define DEBUG`到文件顶部。在 Visual Basic 中，将该`/d:DEBUG=True`标志添加到编译器命令行。
> 
> 要在 C# 中启用跟踪，`/d:TRACE`请在编译代码时将标志添加到编译器命令行，或添加`#define TRACE`到文件顶部。在 Visual Basic 中，将该`/d:TRACE=True` 标志添加到编译器命令行。

# php - PHP 没有从 XML 正确创建数组？

> ID：13108580
> 
> 赞同：0
> 
> 时间：2012-10-28T11:52:16.667
> 
> 标签：php, xml, xmldom

我真的很困惑为什么会发生这种情况（相当多的时间，比我想承认的要多）。基本上，当它到达 Date 时，它​​不会将日期添加到数组中，而 Time 绝对没问题。

**XML 代码示例**

```
<xml>
<Route id="1">
    <itdDateTime>
        <itdDate day="28" month="10" year="2012" weekday="-1"/>
        <itdTime hour="12" minute="53"/>
    </itdDateTime>
</Route>
<Route id="2">
    <itdDateTime>
        <itdDate day="3" month="12" year="2012" weekday="-1"/>
        <itdTime hour="8" minute="14"/>
    </itdDateTime>
</Route>
<Route id="3">
    <itdDateTime>
        <itdDate day="3" month="12" year="2012" weekday="-1"/>
        <itdTime hour="9" minute="16"/>
    </itdDateTime>
</Route> 
```

**PHP 代码示例**

```
foreach($route->childNodes as $node) {
    if ($node->nodeName == 'itdDateTime') {
        foreach ($node->childNodes as $child) {
            $dateAttr = $child->attributes;
            $x[$i]['leave'] = array();
            $x[$i]['leave']['date'] = array();
            $x[$i]['leave']['time'] = array();
            foreach ($dateAttr as $index=>$attr) {
                $x[$i][$attr->nodeName] = $attr->nodeValue;             
                if ($index == 'minute' || $index == 'hour') {
                    $x[$i]['leave']['time'][$attr->nodeName] = $attr->nodeValue;
                } else {
                    $x[$i]['leave']['date'][$attr->nodeName] = $attr->nodeValue;
                }
            }
        }
    }
} 
```

**数组示例**

```
 Array
(
    [0] => Array
        (
            [active] => 1
            [delete] => 0
            [changes] => 2
            [distance] => 966
            [alternative] => 0
            [publicDuration] => 01:19
            [individualDuration] => 00:22
            [print] => 0
            [routeIndex] => 1
            [hasFrequency] => 1
            [routeTripIndex] => 1
            [cTime] => 20121028113640847
            [searchMode] => 1
            [vehicleTime] => 53
            [method] => itp
            [selected] => 1
            [leave] => Array
                (
                    [date] => Array
                        (
                        )

                    [time] => Array
                        (
                            [hour] => 12
                            [minute] => 53
                        )

                )

            [day] => 28
            [month] => 10
            [year] => 2012
            [weekday] => 1
            [hour] => 12
            [minute] => 53
        ) 
```

**问题**

所以基本上问题是日期（日、月、工作日）应该输入到 [leave][date] ..（示例）[leave][date][day]

即使没有 IF 语句，并且仅将其输入 [leave] 数组也不起作用，例如

```
$x[$i]['leave'][$attr->nodeName] = $attr->nodeValue; 
```

所以我基本上不确定并且不明白为什么它会显示在第一个数组中（例如按照示例在离开旁边）

```
$x[$i][$attr->nodeName] = $attr->nodeValue; 
```

对此的任何建议或帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:23:25.533

```
foreach ($node->childNodes as $child) {
    ...
    $x[$i]['leave'] = array();
    $x[$i]['leave']['date'] = array();
    $x[$i]['leave']['time'] = array();
    ...
} 
```

此循环运行两次， for`itdDate`和`itdTime`，正如您在第二次迭代中看到的那样，它正在用空的数组覆盖先前填充的数组。

您应该在覆盖它们之前检查这些数组是否不存在，或者在遍历`itdDateTime`子节点之前更好地移动它们的定义：

```
if ($node->nodeName == 'itdDateTime') {
    $x[$i]['leave'] = array();
    $x[$i]['leave']['date'] = array();
    $x[$i]['leave']['time'] = array();
    foreach ($node->childNodes as $child) {
        $dateAttr = $child->attributes;
        foreach ($dateAttr as $index=>$attr) {
            $x[$i][$attr->nodeName] = $attr->nodeValue;             
            if ($index == 'minute' || $index == 'hour') {
                $x[$i]['leave']['time'][$attr->nodeName] = $attr->nodeValue;
            } else {
                $x[$i]['leave']['date'][$attr->nodeName] = $attr->nodeValue;
            }
        }
    }
} 
```

# c# - 将两个实体列表与条件相结合

> ID：13108583
> 
> 赞同：1
> 
> 时间：2012-10-28T11:52:52.727
> 
> 标签：c#, linq, list, intersect, except

假设我有一个类定义为

```
class Object
{
    public int ID { get;set; }
    public string Property { get; set; }

    public override bool Equals(object obj)
    {
        Object Item = obj as Object;
        return Item.ID == this.ID;
    }

    public override int GetHashCode()
    {
        int hash = 13;
        hash = (hash * 7) + ID.GetHashCode();
        return hash;       
    }
} 
```

还有两个列表，定义如下：

```
List<Object> List1;
List<Object> List2; 
```

这两个列表包含`ID`字段可能相同的对象，但`Property`字段可能相同也可能不同。我希望得到包含在任何这些列表中的所有对象以及属性“1”“1”`中包含的所有`List1`对象`List2, with the condition that`的`field must be set to`结果`if it is set to`。结果必须包含不同的值（不同的 ID）。

例如，如果我们有 2 个这样的列表：

```
List1 
-----  
ID = 0, Property = "1"
ID = 1, Property = ""
ID = 2, Property = "1"
ID = 3, Property = ""

List2
-----
ID = 1, Property = "1"
ID = 2, Property = ""
ID = 3, Property = "" 
```

我需要一个看起来像这样的结果：

```
Result
-------
ID = 0, Property = "1"
ID = 1, Property = "1"
ID = 2, Property = "1"
ID = 3, Property = "" 
```

目前它的工作原理是这样的：

```
var Result = List1.Except(List2).Concat(List2.Except(List1));
var Intersection = List1.Intersect(List2).ToList();
Intersection.ForEach(x => {
    x.Property = List1.Single(y => y.ID == x.ID).Property == "1" ? "1" : List2.Single(y => y.ID == x.ID).Property == "1" ? "1" : "";
});

Result = Result.Concat(Intersection); 
```

...但是 ForEach 非常慢。有人可以建议一种更快的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T12:01:56.613

```
var result = List1.Concat(List2)
                  .GroupBy(o => o.ID)
                  .Select(g => new Object() { 
                                   ID=g.Key,
                                   Property=g.Any(o=>o.Property=="1")?"1":""
                   })
                  .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T12:33:20.423

```
var result = List1.Concat(List2)
        .OrderByDescending(o => o.Property)
        .GroupBy(g => o.ID)
        .Select(g => g.First())
        .ToList(); 
```

# php - 在嵌入式 SQL 查询中使用 PHP $_GET 变量

> ID：13108585
> 
> 赞同：-1
> 
> 时间：2012-10-28T11:53:04.243
> 
> 标签：php, sql

所以我有我的 PHP 页面，在地址栏中它显示如下内容：

```
http://blabla/ClientStats.php?client=blabla 
```

我已经成功使用了 $_GET['CLIENT'] 变量，直到我想在 SQL 查询中访问它，如下所示：

```
<?php
$query = "SELECT ... ... ... FROM ... ... ... WHERE Client = '" + $_GET['CLIENT'] + "'";
?> 
```

查询比这复杂得多，但是那个“WHERE”语句会起作用吗？

我曾尝试以多种不同的方式让它工作，但没有成功，所以如果我今天能找到让它明天工作的方法，那就太好了（甚至不记得我是否像上面写的那样尝试过！ ）。

那么这会起作用吗，如果不是，我应该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:54:32.717

这不是一个好主意，因为您在 sql 查询中使用未经检查的用户输入，这将导致安全漏洞。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T11:58:38.267

添加 '。' 而不是“+”。它应该是

```
$query = "SELECT ... ... ... FROM ... ... ... WHERE Client = '" . $_GET['CLIENT'] . "'"; 
```

但在此之前，请检查您的代码，因为它容易受到 SQL 注入的影响

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T11:57:19.263

回答您最初的问题，是的，它会起作用，但我认为您会发现它相当不受欢迎，因为它会在您的应用程序中打开巨大的安全漏洞。

我所做的是将值存储在变量中，然后对输入进行清理：

例子：

```
$client = mysql_real_escape_string($_GET['CLIENT']); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T11:59:03.040

您必须使用 *_real_escape_string 转义，否则您的查询能够进行 sql 注入攻击，因此像这样使用

```
$client = mysql_real_escape_string($_GET['CLIENT']);//if using mysql

<?php
$query = "SELECT ... ... ... FROM ... ... ... WHERE Client = '".$client. "'";
?> 
```

# mysql - 选择另一个表中没有外键的主键

> ID：13108587
> 
> 赞同：12
> 
> 时间：2012-10-28T11:53:34.193
> 
> 标签：mysql, sql, database, one-to-many

为简化起见，我有两个使用外键与一对多相关的表，例如：

```
Users table:
id
name

Actions table:
id
user_id 
```

一个用户可能有很多动作，也可能没有。我需要一个 sql select 来返回在操作表中没有 user_id 值的用户 ID。

```
Users Table:
id      name
1       John
2       Smith
3       Alice

Actions Table:
id      user_id
1       3
2       1 
```

所以我需要一个返回用户 id 2 (Smith) 的 sql 查询，因为外键值不包括 id 2

我尝试了以下 SQL，但它返回所有用户 ID：

```
SELECT users.id from users left join actions on actions.user_id is null 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-28T11:55:01.697

```
select u.id
from users u
left outer join actions a on a.user_id = u.id
where a.user_id is null 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T12:00:35.290

优化后的版本是：

```
SELECT u.id
FROM users u
LEFT JOIN actions a
ON a.user_id = u.id
AND ISNULL(a.user_id) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-28T11:55:49.207

```
SELECT u.id
FROM users u
LEFT JOIN actions a
   ON a.user_id = u.id
WHERE a.user_id IS NULL 
```

# javascript - Javascript 表单：仅更改的字段

> ID：13108588
> 
> 赞同：-1
> 
> 时间：2012-10-28T11:53:40.047
> 
> 标签：javascript

我有一个带有表单的 php 站点，我在该表单上通过 php 输出预选值。在提交表单时，我想检查哪些值已更改，然后通过 javascript 提交这些值。

这些是我从 php.ini 传递过来的预选值。保持关联数组结构很重要。

```
var pbData = jQuery.parseJSON("{
"GameMode":"DEATHMATCH",
"Current Map":"VEGAS JUNKYARD",
"Current Missions":["VEGAS JUNKYARD","VILLA","PRESIDIO","KILL HOUSE","MURDERTOWN","CQB TRAINING","STREETS","THREE KINGDOMS CASINO","IMPORT\/EXPORT;"],
"RoundDuration":"3 minutes"}"); 
```

我在代码中标记了错误。

```
<script>
function displayVars(){
var form = document.getElementById('settings');
var elems = form.elements;
var txt = "";
for (var index = 0; index < elems.length; index++){
    var selIndex = elems[index].selectedIndex;
    if (typeof selIndex !== "undefined"){
        //the Index Name in the json-object and the name of the form-field are the same 
        var idxName = elems[index].name;
//HERE is the problem. I want to access the subobject via a variablename, so i can iterate through it, but that doesnt work.
        console.log ("pbData default = "+pbData.idxName); //always undefined
        if (elems[index].value !== pbData.idx_name){
            //building a POST-Url
            txt = txt + elems[index].name + "=" + elems[index].options[selIndex].value+"&";
        }
    }
}
console.log (txt);
return false;
}
</script> 
```

我知道我可以用不同的方式来做这件事，也可以使用 jQuery。就我而言，因为无论如何我都将预选值作为 php 变量，所以我认为这样更容易。我真的很想知道如何通过包含对象名称的变量来遍历子对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:02:31.303

在 Javascript 中，您可以保留具有初始值的对象或数组，并且只发布那些更改的值。

但事实上，我会做类似的事情，但在 PHP 中。您可以将原始值保留在会话中，并将发布的值与那些初始值进行比较，以查看发生了什么变化。这样，您就不会依赖 Javascript。不仅可以禁用 Javascript，而且理论上快速用户可以在 Javascript 运行之前发布表单。将此检查移至 PHP 可消除该风险。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T12:03:33.493

这是由于您尝试访问 (JSON) 对象的属性的方式。考虑

```
var o1 = {idxName: true},
    o2 = {foo : 'bar'},
    idxName = 'foo';

o1.idxName;  // true
o2.idxName;  // undefined
o2[idxName]; // 'bar' 
```

您需要通过 访问该属性`pbData[idxName]`。

* * *

此外，您没有转义 JSON 字符串中的引号，并且需要转义换行符，如下所示

```
var pbData = jQuery.parseJSON("{\
\"GameMode\":\"DEATHMATCH\",\
\"Current Map\":\"VEGAS JUNKYARD\",\
\"Current Missions\":[\"VEGAS JUNKYARD\",\"VILLA\",\"PRESIDIO\",\"KILL HOUSE\",\"MURDERTOWN\",\"CQB TRAINING\",\"STREETS\",\"THREE KINGDOMS CASINO\",\"IMPORT\/EXPORT;\"],\
\"RoundDuration\":\"3 minutes\"}"); 
```

# sql - 在日期范围内选择 COUNT 个

> ID：13108590
> 
> 赞同：5
> 
> 时间：2012-10-28T11:54:04.240
> 
> 标签：sql, sql-server

我正在尝试使用 MSSQL Express 2005 获取在某个日期范围内收到的电子邮件的计数。我已经管理了这么多，但现在我想将数据拆分为使用它完成的内容。

这是我到目前为止所得到的：

```
SELECT EmailAddress, COUNT(EmailAddress) 
  FROM mails 
  WHERE ReceivedTime >= DATEADD(DAY, -7, GETDATE()) 
  GROUP BY EmailAddress
    HAVING COUNT(EmailAddress) > 10 
```

这给了我上周邮寄超过 10 次的地址列表，但我们还有另一列告诉我们邮件发生了什么。我正在尝试实现这样的目标：

```
SELECT EmailAddress, 
  COUNT(ActionTaken WHERE ActionTaken="Deleted") AS Deleted,
  COUNT(ActionTaken WHERE ActionTaken="Replied") AS Replied,
  COUNT(ActionTaken WHERE ActionTaken="Read") AS Read,
  COUNT(EmailAddress) AS Total
  FROM mails 
  WHERE ReceivedTime >= DATEADD(DAY, -7, GETDATE()) 
  GROUP BY EmailAddress
    HAVING COUNT(EmailAddress) > 10 
```

我正在寻找以下方面的结果集：

```
 EmailAddress     | Deleted | Replied | Read | Total
 ---------------------------------------------------
 user1@domain.com | 4       | 5       | 3    | 12
 user2@domain.com | 2       | 6       | 3    | 11 
```

我很确定这与使用 OVER(PARTITION BY) 子句有关，但我碰壁了。我意识到 ActionTaken 字段并不理想，但我没有构建它！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T11:56:27.810

对字符串文字使用单引号，这样它就可以不受[`QUOTED_IDENTIFIER`](http://msdn.microsoft.com/en-us/library/ms174393.aspx)设置的影响。

```
SELECT EmailAddress,
       Sum(CASE WHEN ActionTaken = 'Deleted' THEN 1 ELSE 0 END) AS Deleted,
       Sum(CASE WHEN ActionTaken = 'Replied' THEN 1 ELSE 0 END) AS Replied,
       Sum(CASE WHEN ActionTaken = 'Read' THEN 1 ELSE 0 END)    AS [Read],
       Count(EmailAddress) AS Total
FROM   mails
WHERE  ReceivedTime >= Dateadd(DAY, -7, Getdate())
GROUP  BY EmailAddress
HAVING Count(EmailAddress) > 10 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T12:34:49.103

```
SELECT EmailAddress,
       COUNT(CASE WHEN ActionTaken = 'Deleted' THEN ActionTaken END) AS Deleted,
       COUNT(CASE WHEN ActionTaken = 'Replied' THEN ActionTaken END) AS Replied,
       COUNT(CASE WHEN ActionTaken = 'Read' THEN ActionTaken END)    AS [Read],
       COUNT(EmailAddress) AS Total
FROM mails
WHERE ReceivedTime >= DATEADD(DAY, -7, GETDATE())
GROUP BY EmailAddress
HAVING COUNT(EmailAddress) > 10 
```

# excel - 将 Excel 电子表格值设置为在从 VBA 表单插入值时自动换行

> ID：13108594
> 
> 赞同：0
> 
> 时间：2012-10-28T11:54:23.743
> 
> 标签：excel, vba

我目前正在通过 VBA 表单将一些值插入到 Excel 电子表格中。到目前为止，我所做的一切都很好，但我想知道是否有办法将文本设置为自动换行在每个单元格中？

就目前而言，似乎一切都会相互重叠。

```
Private Sub btnSubmit_Click()
    Dim ws As Worksheet
    Dim rng1 As Range
    Set ws = Worksheets("main")
    Set rng1 = ws.Cells(Rows.Count, "a").End(xlUp)
    rng1.Offset(1, 0) = cbo_deptCode.Value
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:14:25.223

尝试

```
With rng1.Offset(1, 0)
    .Value = cbo_deptCode.Value
    .WrapText = True
End With 
```

# android - 尝试构建 CyanogenMod 相机应用程序时出现 NDK 错误

> ID：13108603
> 
> 赞同：0
> 
> 时间：2012-10-28T11:55:18.183
> 
> 标签：android, android-ndk

上一个问题的后续问题 -[编译 ICS/JB 相机应用程序 - 本机库 jni-mosaic 错误](https://stackoverflow.com/questions/13069056/compile-ics-jb-camera-application-native-library-jni-mosaic-error)

我一直在尝试从[CyanogenMod 源](https://github.com/CyanogenMod/android_packages_apps_Camera)构建 ICS 相机应用程序。我在 Windows 7 上，UAC 关闭。使用 Cygwin 和最新的 Android NDK。

在工作区上尝试了 chmod -R 777 ，将`NDK_TOOLCHAIN_VERSION := 4.4.3`and添加`LOCAL_LDLIBS := -L$(SYSROOT)/usr/lib -llog`到我的**Android.mk**文件中，但无论我做什么，我仍然收到此错误：

```
Compile++ thumb  : jni_mosaic <= feature_mos_jni.cpp
In file included from jni/feature_mos_jni.cpp:21:0:
C:/android-ndk/platforms/android-14/arch-arm/usr/include/jni.h:592:13: note: the mangling of 'va_list' has changed in GCC 4.4
Compile++ thumb  : jni_mosaic <= mosaic_renderer_jni.cpp
In file included from jni/mosaic_renderer_jni.cpp:19:0:
C:/android-ndk/platforms/android-14/arch-arm/usr/include/jni.h:592:13: note: the mangling of 'va_list' has changed in GCC 4.4
Compile++ thumb  : jni_mosaic <= trsMatrix.cpp
Compile++ thumb  : jni_mosaic <= AlignFeatures.cpp
Compile++ thumb  : jni_mosaic <= Blend.cpp
Compile++ thumb  : jni_mosaic <= Delaunay.cpp
Compile++ thumb  : jni_mosaic <= ImageUtils.cpp
Compile++ thumb  : jni_mosaic <= Mosaic.cpp
Compile++ thumb  : jni_mosaic <= Pyramid.cpp
Compile++ thumb  : jni_mosaic <= Renderer.cpp
Compile++ thumb  : jni_mosaic <= WarpRenderer.cpp
Compile++ thumb  : jni_mosaic <= SurfaceTextureRenderer.cpp
Compile++ thumb  : jni_mosaic <= YVURenderer.cpp
Compile++ thumb  : jni_mosaic <= FrameBuffer.cpp
Compile++ thumb  : jni_mosaic <= db_feature_detection.cpp
Compile++ thumb  : jni_mosaic <= db_feature_matching.cpp
Compile++ thumb  : jni_mosaic <= db_framestitching.cpp
Compile++ thumb  : jni_mosaic <= db_image_homography.cpp
Compile++ thumb  : jni_mosaic <= db_rob_image_homography.cpp
Compile++ thumb  : jni_mosaic <= db_utilities.cpp
Compile++ thumb  : jni_mosaic <= db_utilities_camera.cpp
Compile++ thumb  : jni_mosaic <= db_utilities_indexing.cpp
Compile++ thumb  : jni_mosaic <= db_utilities_linalg.cpp
Compile++ thumb  : jni_mosaic <= db_utilities_poly.cpp
Compile++ thumb  : jni_mosaic <= dbreg.cpp
Compile++ thumb  : jni_mosaic <= dbstabsmooth.cpp
Compile thumb  : jni_mosaic <= vp_motionmodel.c
SharedLibrary  : libjni_mosaic.so
./obj/local/armeabi/objs/jni_mosaic/mosaic_renderer_jni.o: In function `checkGLErrorDetail(char const*, int, char const*)':
D:\CMCam/jni/mosaic_renderer_jni.cpp:195: undefined reference to `glGetError'
./obj/local/armeabi/objs/jni_mosaic/mosaic_renderer_jni.o: In function `checkFramebufferStatus(char const*)':
D:\CMCam/jni/mosaic_renderer_jni.cpp:177: undefined reference to `glCheckFramebufferStatus'
./obj/local/armeabi/objs/jni_mosaic/mosaic_renderer_jni.o: In function `bindSurfaceTexture(unsigned int)':
D:\CMCam/jni/mosaic_renderer_jni.cpp:211: undefined reference to `glBindTexture'
D:\CMCam/jni/mosaic_renderer_jni.cpp:215: undefined reference to `glTexParameterf'
D:\CMCam/jni/mosaic_renderer_jni.cpp:217: undefined reference to `glTexParameterf'
D:\CMCam/jni/mosaic_renderer_jni.cpp:220: undefined reference to `glTexParameteri'
D:\CMCam/jni/mosaic_renderer_jni.cpp:222: undefined reference to `glTexParameteri'
./obj/local/armeabi/objs/jni_mosaic/mosaic_renderer_jni.o: In function `Java_com_android_camera_MosaicRenderer_init':
D:\CMCam/jni/mosaic_renderer_jni.cpp:528: undefined reference to `glBindFramebuffer'
D:\CMCam/jni/mosaic_renderer_jni.cpp:530: undefined reference to `glGenTextures'
./obj/local/armeabi/objs/jni_mosaic/mosaic_renderer_jni.o: In function `Java_com_android_camera_MosaicRenderer_transferGPUtoCPU':
D:\CMCam/jni/mosaic_renderer_jni.cpp:695: undefined reference to `glBindFramebuffer'
D:\CMCam/jni/mosaic_renderer_jni.cpp:703: undefined reference to `glReadPixels'
D:\CMCam/jni/mosaic_renderer_jni.cpp:708: undefined reference to `glBindFramebuffer'
D:\CMCam/jni/mosaic_renderer_jni.cpp:716: undefined reference to `glReadPixels'
./obj/local/armeabi/objs/jni_mosaic/feature_mos/src/mosaic_renderer/Renderer.o: In function `Renderer::loadShader(unsigned int, char const*)':
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:39: undefined reference to `glCreateShader'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:41: undefined reference to `glShaderSource'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:42: undefined reference to `glCompileShader'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:44: undefined reference to `glGetShaderiv'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:47: undefined reference to `glGetShaderiv'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:51: undefined reference to `glGetShaderInfoLog'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:56: undefined reference to `glDeleteShader'
./obj/local/armeabi/objs/jni_mosaic/feature_mos/src/mosaic_renderer/Renderer.o: In function `Renderer::createProgram(char const*, char const*)':
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:78: undefined reference to `glCreateProgram'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:81: undefined reference to `glAttachShader'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:83: undefined reference to `glAttachShader'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:86: undefined reference to `glLinkProgram'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:88: undefined reference to `glGetProgramiv'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:95: undefined reference to `glGetProgramiv'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:106: undefined reference to `glDeleteProgram'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:101: undefined reference to `glGetProgramInfoLog'
./obj/local/armeabi/objs/jni_mosaic/feature_mos/src/mosaic_renderer/Renderer.o: In function `Renderer::SetupGraphics(int, int)':
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:126: undefined reference to `glUseProgram'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:129: undefined reference to `glBindFramebuffer'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:135: undefined reference to `glViewport'
./obj/local/armeabi/objs/jni_mosaic/feature_mos/src/mosaic_renderer/Renderer.o: In function `Renderer::SetupGraphics(FrameBuffer*)':
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:157: undefined reference to `glUseProgram'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:160: undefined reference to `glBindFramebuffer'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:166: undefined reference to `glViewport'
./obj/local/armeabi/objs/jni_mosaic/feature_mos/src/mosaic_renderer/Renderer.o: In function `Renderer::Clear(float, float, float, float)':
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:185: undefined reference to `glClearColor'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/Renderer.cpp:186: undefined reference to `glClear'
./obj/local/armeabi/objs/jni_mosaic/feature_mos/src/mosaic_renderer/WarpRenderer.o: In function `WarpRenderer::InitializeGLProgram()':
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:101: undefined reference to `glDeleteProgram'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:82: undefined reference to `glUseProgram'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:86: undefined reference to `glGetAttribLocation'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:87: undefined reference to `glGetUniformLocation'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:88: undefined reference to `glGetUniformLocation'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:89: undefined reference to `glGetUniformLocation'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:90: undefined reference to `glGetAttribLocation'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:93: undefined reference to `glGetUniformLocation'
./obj/local/armeabi/objs/jni_mosaic/feature_mos/src/mosaic_renderer/WarpRenderer.o: In function `WarpRenderer::DrawTexture(float*)':
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:119: undefined reference to `glDisable'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:121: undefined reference to `glActiveTexture'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:125: undefined reference to `glBindTexture'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:129: undefined reference to `glUniform1i'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:133: undefined reference to `glVertexAttribPointer'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:137: undefined reference to `glVertexAttribPointer'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:139: undefined reference to `glEnableVertexAttribArray'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:140: undefined reference to `glEnableVertexAttribArray'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:143: undefined reference to `glUniformMatrix4fv'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:144: undefined reference to `glUniformMatrix4fv'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:145: undefined reference to `glUniformMatrix4fv'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:148: undefined reference to `glDrawElements'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/WarpRenderer.cpp:152: undefined reference to `glBindFramebuffer'
./obj/local/armeabi/objs/jni_mosaic/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.o: In function `SurfaceTextureRenderer::InitializeGLProgram()':
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:110: undefined reference to `glDeleteProgram'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:92: undefined reference to `glUseProgram'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:95: undefined reference to `glGetAttribLocation'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:97: undefined reference to `glGetAttribLocation'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:99: undefined reference to `glGetUniformLocation'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:101: undefined reference to `glGetUniformLocation'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:103: undefined reference to `glPixelStorei'
./obj/local/armeabi/objs/jni_mosaic/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.o: In function `SurfaceTextureRenderer::DrawTexture(float*)':
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:128: undefined reference to `glDisable'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:130: undefined reference to `glActiveTexture'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:134: undefined reference to `glBindTexture'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:137: undefined reference to `glUniformMatrix4fv'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:138: undefined reference to `glUniformMatrix4fv'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:142: undefined reference to `glVertexAttribPointer'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:143: undefined reference to `glEnableVertexAttribArray'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:146: undefined reference to `glVertexAttribPointer'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:147: undefined reference to `glEnableVertexAttribArray'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:150: undefined reference to `glDrawElements'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/SurfaceTextureRenderer.cpp:152: undefined reference to `glBindFramebuffer'
./obj/local/armeabi/objs/jni_mosaic/feature_mos/src/mosaic_renderer/YVURenderer.o: In function `YVURenderer::InitializeGLProgram()':
D:\CMCam/jni/feature_mos/src/mosaic_renderer/YVURenderer.cpp:70: undefined reference to `glDeleteProgram'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/YVURenderer.cpp:54: undefined reference to `glUseProgram'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/YVURenderer.cpp:58: undefined reference to `glGetAttribLocation'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/YVURenderer.cpp:59: undefined reference to `glGetAttribLocation'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/YVURenderer.cpp:62: undefined reference to `glGetUniformLocation'
./obj/local/armeabi/objs/jni_mosaic/feature_mos/src/mosaic_renderer/YVURenderer.o: In function `YVURenderer::DrawTexture()':
D:\CMCam/jni/feature_mos/src/mosaic_renderer/YVURenderer.cpp:88: undefined reference to `glDisable'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/YVURenderer.cpp:90: undefined reference to `glActiveTexture'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/YVURenderer.cpp:94: undefined reference to `glBindTexture'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/YVURenderer.cpp:98: undefined reference to `glUniform1i'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/YVURenderer.cpp:102: undefined reference to `glVertexAttribPointer'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/YVURenderer.cpp:106: undefined reference to `glVertexAttribPointer'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/YVURenderer.cpp:108: undefined reference to `glEnableVertexAttribArray'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/YVURenderer.cpp:109: undefined reference to `glEnableVertexAttribArray'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/YVURenderer.cpp:112: undefined reference to `glDrawElements'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/YVURenderer.cpp:116: undefined reference to `glBindFramebuffer'
./obj/local/armeabi/objs/jni_mosaic/feature_mos/src/mosaic_renderer/FrameBuffer.o: In function `FrameBuffer::CreateBuffers()':
D:\CMCam/jni/feature_mos/src/mosaic_renderer/FrameBuffer.cpp:72: undefined reference to `glGenFramebuffers'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/FrameBuffer.cpp:73: undefined reference to `glGenTextures'
./obj/local/armeabi/objs/jni_mosaic/feature_mos/src/mosaic_renderer/FrameBuffer.o: In function `FrameBuffer::Init(int, int, unsigned int)':
D:\CMCam/jni/feature_mos/src/mosaic_renderer/FrameBuffer.cpp:30: undefined reference to `glBindFramebuffer'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/FrameBuffer.cpp:31: undefined reference to `glBindTexture'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/FrameBuffer.cpp:41: undefined reference to `glTexImage2D'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/FrameBuffer.cpp:45: undefined reference to `glTexParameteri'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/FrameBuffer.cpp:46: undefined reference to `glTexParameteri'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/FrameBuffer.cpp:49: undefined reference to `glTexParameteri'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/FrameBuffer.cpp:50: undefined reference to `glTexParameteri'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/FrameBuffer.cpp:57: undefined reference to `glFramebufferTexture2D'
D:\CMCam/jni/feature_mos/src/mosaic_renderer/FrameBuffer.cpp:67: undefined reference to `glBindFramebuffer'
collect2: ld returned 1 exit status
/cygdrive/c/android-ndk/build/core/build-binary.mk:378: recipe for target `obj/local/armeabi/libjni_mosaic.so' failed
make: *** [obj/local/armeabi/libjni_mosaic.so] Error 1 
```

将不胜感激任何帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T21:08:37.523

为了更好地理解 NDK 如何解释你的`Android.mk`，你可以运行

```
ndk-build V=1 
```

这将回显所有执行的命令，包括编译和链接，以及 NDK 构建分配的所有参数。

通常，NDK 会包含目录`C:/android-ndk/platforms/android-14/arch-arm/usr/lib/`。如果出于某种原因未在链接命令行上指定此路径（请参见上面的**V=1**），则应`LOCAL_LDLIBS`手动添加它。

```
LOCAL_LDLIBS += C:/android-ndk/platforms/android-14/arch-arm/usr/lib 
```

cyanogen tree 中的 make 文件没有为`ndk-build`. 它不使用打包在 NDK 中的预构建系统库，而是引用预期在`lunch`或`brunch`. 这就是为什么它有这条线

```
LOCAL_SHARED_LIBRARIES := liblog libnativehelper libGLESv2 
```

你不建树；因此，这些库不是本地的。但是，您必须将它们全部提供给链接器：

```
LOCAL_LDLIBS += -llog -lnativehelper -lGLESv2 
```

不幸的是，NDK 只提供了两个。`libnativehelper.so`不是公共 API 的一部分。这意味着理论上，你不应该依赖它。但实际上，这个库存在于所有设备上，并且它的界面非常稳定。

您可以从您的设备中提取此二进制文件，甚至可以使用命令从模拟器中提取此二进制文件

```
adb pull /system/lib/libnativehelper.so C:/android-ndk/platforms/android-14/arch-arm/usr/lib 
```

# iphone - IOS蓝牙低功耗连接间隔

> ID：13108608
> 
> 赞同：5
> 
> 时间：2012-10-28T11:56:04.880
> 
> 标签：iphone, ios, xcode, core-bluetooth, bluetooth-lowenergy

我正在为蓝牙低功耗设备构建应用程序。我试图弄清楚如何在 iPhone 端设置连接间隔。

我在外围设备上定义了最小和最大连接间隔。但是，我希望 iPhone 应用程序尽可能使用最长的连接间隔。有没有办法在应用程序中设置连接间隔，或者至少有一种影响它的方法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-07-26T14:09:17.233

有两种可能：

**情况1**

如果您的应用程序是主应用程序，则无法从应用程序更改连接间隔。没有用于此的 API。您的外围设备应要求更改连接间隔。有关可接受的连接间隔值，请查看本文档 ( [https://developer.apple.com/hardwaredrivers/BluetoothDesignGuidelines.pdf](https://developer.apple.com/hardwaredrivers/BluetoothDesignGuidelines.pdf) ) 的 3.6 连接参数。

**案例2**

如果您的应用程序是外围应用，您可以使用 CBPeripheralManager 中的*setDesiredConnectionLatency*方法。更多细节在这里：[https ://developer.apple.com/reference/corebluetooth/cbperipheralmanager/1393277-setdesiredconnectionlatency](https://developer.apple.com/reference/corebluetooth/cbperipheralmanager/1393277-setdesiredconnectionlatency)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T16:59:12.577

您可以从外围设备发送连接参数更新请求，最小连接间隔更接近高间隔。不知道你是否可以在 iPhone 上影响它。

# javascript - 如何从父网站监控 iframe？

> ID：13108610
> 
> 赞同：-1
> 
> 时间：2012-10-28T11:56:11.230
> 
> 标签：javascript, jquery

我有一个名为 A 的网站，我想使用 iframe 将另一个名为 B 的网站包含到 A 中。网站 B 是一个电子购物网站。我想监控B到A的所有页面，可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T11:59:06.043

根据站点 A 和 B 的域、协议和端口，您很可能会遇到与[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)相关的问题。

它还取决于您的意思是*我想监视 B 到 A 的所有页面*。

如果您同时拥有站点 A 和 B，并且它们位于不同的域中，则可以使用 HTML5 postMessage 功能实现[跨文档消息传递。](http://en.wikipedia.org/wiki/Cross-document_messaging)

postMessage 的一个很好的包装可以在[这里](http://postmessage.freebaseapps.com/)找到。如果可能，它使用 jQuery，并回退到 IE7 上的位置散列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T12:09:47.377

当域不同时，您只能列出从内部 iframe 加载的网站。

如果您使用的是 jQuery：

```
<script>
var webList=[];
$("document").ready(function(){
    $("#b").load(function(){
        webList.push($(this).attr("src"));
    });
})
</script>
<iframe id="b"></iframe> 
```

# javascript - jQuery load() 函数不会加载所有内容

> ID：13108614
> 
> 赞同：0
> 
> 时间：2012-10-28T11:56:44.893
> 
> 标签：javascript, jquery, html, ajax

我一直在努力查询一段时间。我有一个我想在我的网站上使用的 CMS，购买我不能使用 PHP，所以我决定使用 jquery。我已经做了所有必要的包括，当我打开网页时它不会加载所有文件...... load() 函数很少加载每个文件。任何解决问题的想法或替代方案？谢谢。

```
<script type="text/javascript">
$(document).ready(function(){  
// find element with ID of "target" and put file contents into it  
$('#welcome-container').load('admin/data/blocks/Slider/Text.html');
$('#slides').load('admin/data/blocks/Slider/Imagini.html');  
$('#acasa-continut').load('admin/data/blocks/Acasa/Continut.html');  
$('#sidebar').load('admin/data/blocks/Sidebar/Continut.html');  
$('#sidebar-v1').load('admin/data/blocks/Sidebar/Video-1.html'); 
$('#sidebar-v2').load('admin/data/blocks/Sidebar/Video-2.html');
$('#principii').load('admin/data/blocks/Despre/Principii.html');
$('#echipa').load('admin/data/blocks/Despre/Echipa.html');
$('#echipament').load('admin/data/blocks/Despre/Echipament.html');
$('#contact-t').load('admin/data/blocks/Contact/Contact.html');
}); 
</script> 
```

我已经使用 deloper 工具进行了检查，它在每次刷新时随机给出 500 不同元素的内部服务器错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:20:15.683

请求复合 HTML 并将其分发到各种容器的客户端代码将如下所示：

```
$(document).ready(function(){  
    $.ajax({
        url: 'admin/data/blocks/all/page.html',
        dataType: 'json',
        success: function(data){
            $.each(data, function(i, obj) {
                $('#'+obj.target).html(obj.html);
            });
        }
    });
}); 
```

这假定`admin/data/blocks/all/page.html`是一个服务器端资源，它将提供以下构造的 json 编码响应：

```
[
    { 'target':'welcome-container', 'html':'<div>whatever</div>' },
    { 'target':'slides', 'html':'<div>whatever</div>' },
    { 'target':'acasa-continut', 'html':'<div>whatever</div>' },
    { 'target':'sidebar', 'html':'<div>whatever</div>' },
    { 'target':'sidebar-v1', 'html':'<div>whatever</div>' },
    { 'target':'sidebar-v2', 'html':'<div>whatever</div>' },
    { 'target':'principii', 'html':'<div>whatever</div>' },
    { 'target':'echipa', 'html':'<div>whatever</div>' },
    { 'target':'echipament', 'html':'<div>whatever</div>' },
    { 'target':'contact-t', 'html':'<div>whatever</div>' },
] 
```

# python - 电子邮件末尾的神秘字符，用python中的socket接收

> ID：13108615
> 
> 赞同：0
> 
> 时间：2012-10-28T11:56:46.800
> 
> 标签：python, sockets, smtp

我不确定这是否是正确的论坛，但我试一试。

一个设备正在向我的代码发送一封电子邮件，我在其中尝试通过 python 中的套接字接收电子邮件，并通过 `Messsage.get_payload()`调用解码电子邮件。然而。我总是`\n.\n`在消息的末尾有一个。

如果同一设备将相同的消息发送到真正的电子邮件客户端（例如 gmail），我会得到正确的原始消息，但没有`\n.\n`.

我想知道 SMTP/E-Mail 处理/发送中的这组特殊字符是什么，以及如何将其编码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T12:15:35.790

如果您查看[SMTP 协议定义](https://www.rfc-editor.org/rfc/rfc2821#page-33)，您会看到，消息传输的 DATA 部分以`<CRLF>.<CRLF>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T11:59:18.577

这些只是换行符。在 GMail 中，它们将被处理并“显示”，因此您看不到它们。`get_payload()`但它们仍然是电子邮件文本消息的一部分，因此返回它们是有意义的。

# oracle - Oracle 11g DBCP 网络适配器无法建立连接

> ID：13108616
> 
> 赞同：2
> 
> 时间：2012-10-28T11:56:51.513
> 
> 标签：oracle, spring, jdbc

我习惯于将 Oracle 与 Spring 和 DBCP 连接起来。

```
 <bean id="dataSource" class="org.apache.tomcat.dbcp.dbcp.BasicDataSource">
        <property name="driverClassName" value="oracle.jdbc.OracleDriver" />
        <property name="url" value="jdbc:oracle:thin:@localhost:1521/ORCL" />
        <property name="username" value="PMSYSDB" />
        <property name="password" value="********" />
    </bean> 
```

但我得到：`Could not get JDBC Connection; nested exception is org.apache.tomcat.dbcp.dbcp.SQLNestedException: Cannot create PoolableConnectionFactory (IO Error: The Network Adapter could not establish the connection)`

我可以通过 SQLDeveloper 使用以下属性进行连接：

```
Hostname: localhost
Port    : 1521
SID     : ORCL
username: PMSYSDB
password: 
```

所以我的数据库已启动并正在运行...防火墙已关闭...数据库和tomcat在同一台机器上...

认为这并不重要，但我将数据源与 Spring Security 一起使用：

```
 <authentication-manager>
         <authentication-provider>
        <jdbc-user-service data-source-ref="dataSource"

           users-by-username-query="
              select username, password, enabled 
              from users where username=?" 

           authorities-by-username-query="
              select u.username, ur.authority from users u, user_roles ur 
              where u.user_id = ur.user_id and u.username =?  " 

        />
      </authentication-provider>
    </authentication-manager> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T18:12:26.100

问题是我将此语法`jdbc:oracle:thin:@localhost:1521/ORCL`用于连接字符串。在`/`Oracle 需要服务名称而不是 SID 之后（ORCL 是我的 SID）。解决方案是将连接sring更改为`jdbc:oracle:thin:@localhost:1521:ORCL`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T14:37:25.523

数据库可能设置为不允许此类连接。试试这个：

```
telnet localhost 1521 
```

看看你是否可以在那个端口上连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-25T13:29:28.173

更改和操作后刷新侦听器

> C:\oracleexe\app\oracle\product\11.2.0\server\network\ADMIN\listener.ora

和

> C:\oracleexe\app\oracle\product\11.2.0\server\network\ADMIN\tnsnames.ora

不要忘记在 CMD 中使用以下命令刷新侦听器（以管理员身份运行）。

```
lsnrctl stop
lsnrctl start 
```

在此之后等待 1-2 分钟，然后单击测试。

# java - 在可嵌入的类对象中映射列表？

> ID：13108618
> 
> 赞同：-1
> 
> 时间：2012-10-28T11:57:19.543
> 
> 标签：java, hibernate, jakarta-ee

如何在包含可嵌入对象的 TreeMap 中映射列表？

我试图举一个例子，尽管它没有多大意义。但你得到我的问题：

```
@Embeddable
class BookStore {

    Map<BookType, List<Order>> orders = new TreeMap<BookType, List<Order>>();
} 
```

结果：

```
@OneToMany: targeting an unmapped class List<Order>.
@ElementCollection: HibernateMappingException: could not determine type for: java.util.List 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T15:04:02.023

不可能。我能想到的最好的方法是拥有一个私人收藏`List<BookTypeOrder>`并拥有类似地图的方法`List<Order> getOrder(BookType b)`，`void addOrder(BookType b, Order o)`并使用内部收藏对结果进行分组

# c++ - 数组中连续元素的总和，C++

> ID：13108622
> 
> 赞同：1
> 
> 时间：2012-10-28T11:58:36.183
> 
> 标签：c++, arrays, algorithm, sum

假设我有一个由 n 个元素组成的数组。

```
1 2 3 4 5 6 ... n 
```

我需要找到一种方法来使用 C++ 提取此数组中连续元素的总和。像这样：

```
1, 2, 3,...n, 1+2, 2+3, 3+4,...(n-1)+n, 1+2+3, 2+3+4,...(n-2)+(n-1)+n,...1+2+3...n 
```

到目前为止，我发现我需要通过在每次运行时求和一定数量的元素来遍历这个数组。我不确定是否可以实现我上面解释的算法。可能有更好的解决方案，但这是我能想到的最好的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T12:07:53.500

您可以使用它`std::transform`来执行此操作：

```
std::transform(
    v.begin(), v.end()-1,
    v.begin()+1,
    std::ostream_iterator<int>(std::cout, "\n"),
    std::plus<int>()
); 
```

当然你不必使用 ostream_iterator 作为它的输出，你也可以使用另一个容器迭代器，或者`std::back_inserter`一个容器或任何其他`OutputIterator`

### 参考

[http://en.cppreference.com/w/cpp/algorithm/transform](http://en.cppreference.com/w/cpp/algorithm/transform)

[http://en.cppreference.com/w/cpp/utility/functional/plus](http://en.cppreference.com/w/cpp/utility/functional/plus)

[http://en.cppreference.com/w/cpp/container/vector](http://en.cppreference.com/w/cpp/container/vector)

编辑：

```
std::vector<int> v(100), t;
//this just populates v with 1,2,3...100
std::iota(v.begin(), v.end(), 1);

std::transform(
    v.begin(), v.end()-1, v.begin()+1,
    std::back_inserter(t),
    std::plus<int>()
);

std::transform(
    t.begin(), t.end()-1, v.begin()+2,                
    std::ostream_iterator<int>(std::cout, "\n"),
    std::plus<int>()
); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T13:01:08.903

这是怎么回事。给定一个由 5 个整数组成的数组：5, 7, 3, 9, 4

```
 void DoMaths (void)
    {
         int       iArray [] = { 5, 7, 3, 9, 4 } ;
         int       iSize = 5 ;

         int       iGroup ;
         int       iIndex ;
         int       iPass ;
         int       iResults ;
         int       iStart ;
         int       iSum ;

    // Init
         iGroup   = 1 ;
         iResults = iSize ;
    // Repeat for each pass
         for (iPass = 0 ; iPass < iSize ; iPass ++)
         {
              printf ("\n") ;
              printf ("Pass %d : Group %d :\n", iPass, iGroup) ;
         // Repeat for each group of integers in a pass
              for (iStart = 0 ; iStart < iResults ; iStart ++)
              {
                   iSum = 0 ;
                   printf ("  %d [ ", iStart) ;
                   for (iIndex = iStart ; iIndex < (iStart + iGroup) ; iIndex ++)
                   {
                        printf ("%d ", iIndex) ;
                        iSum += iArray [iIndex] ;
                   }
                   printf ("] sum = %d \n", iSum) ;
              }
              iGroup ++ ;
              iResults -- ;
         }
         return ;
    }
```

这会产生以下结果...

```
    第 0 组：第 1 组：
      0 [ 0 ] 总和 = 5
      1 [ 1 ] 总和 = 7
      2 [ 2 ] 总和 = 3
      3 [ 3 ] 总和 = 9
      4 [ 4 ] 总和 = 4

    第 1 组：第 2 组：
      0 [ 0 1 ] 总和 = 12
      1 [ 1 2 ] 总和 = 10
      2 [ 2 3 ] 总和 = 12
      3 [ 3 4 ] 总和 = 13

    通行证 2：第 3 组：
      0 [ 0 1 2 ] 总和 = 15
      1 [ 1 2 3 ] 总和 = 19
      2 [ 2 3 4 ] 总和 = 16

    第 3 组：第 4 组：
      0 [ 0 1 2 3 ] 总和 = 24
      1 [ 1 2 3 4 ] 总和 = 23

    第 4 组：第 5 组：
      0 [ 0 1 2 3 4 ] 总和 = 28

```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-28T12:27:02.397

让我们检查包含 4 个元素的案例：

```
{1,3,4,5, // from original array
 4,7,9, // sum of 2 consecutive elements
 8,12, // sum of 3
 13} // sum of 4 
```

如您所见，N sum 数组的每个部分的大小都比原始数组小 (N-1)。所以你需要大小的目标数组： N + (N-1) + (N-2) + ... 1 - 这是 N*(1+N)/2

```
int* createSumArray(int* arr, int size)
{
   int ti = 0; // target index
   int* ta = new int[size*(size+1)/2];
   for (int s = 1; s <= size; ++s) // how many elements to sum
   {
      for (int si = 0; si < size + 1 - s; ++si)
      {
          ta[ti] = 0;
          for (int i = si; i < si + s; ++i)
            ta[ti] += arr[i];
          ++ti;
      } 
   }
   return ta;
} 
```

见[ideone上的测试](http://ideone.com/VJFGFL)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-28T12:53:52.023

```
int main()
{
    int ptr=0,i,j,k;
    int Ar[]={1,2,3,4,5,6,7,8,9,10,11,12,13};
    int n=13;
    int *Res;
    Res=(int*)calloc(n*(n+1)/2,sizeof(int));
    for(i=1;i<=n;i++) //tells about how many element's sum we need
    for(j=i;j<=n;j++)
    {
        for(k=0;k<i;k++)
        {      
               Res[ptr]+=Ar[j-i+k];
        }
        ptr++;
    }
    for(int x=0;x<ptr;x++)
    cout<<Res[x]<<"\t";
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-28T12:11:24.583

我们将原始数组称为 A。

让我们将 k 个连续元素之和的数组称为 B。

让我们将 k+1 个连续元素之和的数组称为 C。

每个数组的大小为 n。

C 的前 k-2 个单元格是不相关的。

```
for(int i = k-1; i < n; i++)
    C[i] = A[i-1] + B[i]; 
```

对每个 k 重复上述代码直到 n ，并在每次传递后将结果数组连接到上一次迭代的结果。（确保检查好角落案例）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-28T13:20:25.493

在[ideone.com](http://ideone.com/xdaZP4)上查看它：

```
std::vector<std::vector<int> > sums(int array[], int size)
{
        std::vector<std::vector<int> > result(size - 1);
        //build the two element sums
        for(int *p = array; p - array < size - 1; ++p)
                result[0].push_back(std::accumulate(p, p + 2, 0));
        //build the rest of the sums
        for(int i = 1; i < size - 1; ++i)
                for(int j = 0; j < size - (i + 1); ++j)
                        result[i].push_back(result[i - 1][j] + array[i + j + 1]);
        return result;
} 
```

这也应该使用先前计算的总和。

# c++ - 如何覆盖 opencv Mat 的子图像？

> ID：13108627
> 
> 赞同：1
> 
> 时间：2012-10-28T11:59:03.117
> 
> 标签：c++, opencv

opencv 2.4 中是否有任何解决方案返回对子垫的非常量引用？
我问这个是因为我想覆盖一个由 roi 定义的子图像，但`mat(roi)`返回一个 const 引用，所以我不能写 say`mat(roi)=mat2`或`cv::rectangle(mat(roi), rect_relative_to_roi)`.

编辑：（我会更具体地使用安德烈的回答）

如果我已经定义了在子图像上工作的复杂绘图函数，
那么我可以避免向绘图函数发送相对坐标的唯一方法是
来回复制我想要使用的子图像吗？

我的意思是这样的：

```
/* Mat canvas; */
Mat subimg = canvas(roi);
draw_sth(subimg);
subimg.copyTo(canvas(roi)); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T12:09:52.087

你可以做

```
mat2.copyTo(mat(roi)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T16:23:46.337

好吧，事实证明

```
Mat subcanvas = canvas(roi);
draw_sth(subcanvas); 
```

是答案，它将修改原始画布，因为 Mat 将被视为引用计数的智能指针，它们只是指向图像数据。

另一方面，copyTo() 不好。看一下opencv代码：

> ```
> //! copies the matrix content to "m".
> // It calls m.create(this->size(), this->type()). 
> ```

# android - 将屏幕坐标转换为地理点

> ID：13108629
> 
> 赞同：0
> 
> 时间：2012-10-28T11:59:14.677
> 
> 标签：android, osmdroid

我正在尝试将应用程序`googlemap 2.2`从`osmdroid 3.0.8`. 我在 MapView 中遇到以下代码：

```
Projection proj = getProjection();
GeoPoint topLeft = proj.fromPixels(0, 0);
GeoPoint bottomRight = proj.fromPixels(getWidth()-1, getHeight()-1); 
```

使用 osmdroid，topLeft 总是在北极。

在 OSM 中是否有不同的方法来处理它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T15:46:09.183

在 OsmDroid 中，您使用 mapView.getScreenRect 来查找屏幕的左上角。

# datetime - 如何获取 datetime64 数组中每个元素的时间？

> ID：13108635
> 
> 赞同：1
> 
> 时间：2012-10-28T12:00:23.177
> 
> 标签：datetime, numpy

在 Numpy 中，我试图获取`datatime64`.

我可以选择一个新数组，`timedelta64`其中包含每个元素从一天开始以来经过的时间。

我已经尝试过使用`numpy.datetime_as_string`，但我不知道如何操作字符串。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-01T12:44:16.937

```
def datetime64_to_time_of_day(datetime64_array):
    """
    Return a new array. For every element in datetime64_array return the time of day (since midnight).
    >>> datetime64_to_time_of_day(np.array(['2012-01-02T01:01:01.001Z'],dtype='datetime64[ms]'))
    array([3661001], dtype='timedelta64[ms]')
    >>> datetime64_to_time_of_day(np.datetime64('2012-01-02T01:01:01.001Z','[ms]'))
    numpy.timedelta64(3661001,'ms')
    """
    day = datetime64_array.astype('datetime64[D]').astype(datetime64_array.dtype)
    time_of_day = datetime64_array - day
    return time_of_day 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-30T19:34:37.190

如果使用 pandas，您可以调用`pandas.Series.dt.time`获取`datetime.time`对象。

# android - 拆分或堆叠时Android更改操作栏选项卡的选择器颜色

> ID：13108637
> 
> 赞同：2
> 
> 时间：2012-10-28T12:00:36.007
> 
> 标签：android, android-actionbar

我设置了带有标签导航的操作栏。在较小的屏幕上，选项卡位于操作栏下方，而在较大的屏幕上，选项卡位于操作栏内。我的操作栏是红色的，标签是黑色的。When the tabs are below the action bar I would like the selector to be colored red and then change the color to black if the tabs are inside the action bar.

我的问题是我要么在操作栏下方和内部得到一个红色选择器，要么在操作栏下方和内部得到一个黑色选择器。When the tabs are below the actionbar I would like the selector to be red and when they are inside I would like the selector to be black. 这是我的styles_actionbar.xml：

```
<style name="Theme.customabthemegenerated" parent="@android:Theme.Holo.Light">
    <item name="android:actionBarItemBackground">@drawable/selectable_background_customabthemegenerated</item>
    <item name="android:actionBarStyle">@style/solid_ActionBar</item>
    <item name="android:actionBarTabStyle">@style/ActionBarTabStyle</item>        
    <item name="android:actionBarTabBarStyle">@style/ActionBarTabBarStyle</item>
    <item name="android:actionBarTabTextStyle">@style/ActionBarText</item>
</style>

<style name="solid_ActionBar" parent="@android:Widget.Holo.Light.ActionBar.Solid">
    <item name="android:background">@drawable/ab_solid_customabthemegenerated</item>
    <item name="android:backgroundStacked">@drawable/ab_stacked_solid_customabthemegenerated</item>
    <item name="android:backgroundSplit">@drawable/ab_bottom_solid_customabthemegenerated</item><!-- No difference without it -->
</style>

<style name="ActionBarTabStyle" parent="@android:style/Widget.Holo.ActionBar.TabView">
    <item name="android:background">@drawable/tab_indicator_inside</item>
</style>

<style name="ActionBarTabBarStyle" parent="@android:style/Widget.Holo.ActionBar.TabBar">
    <item name="android:background">@drawable/tab_indicator_outside</item>
</style>

<style name="ActionBarText" parent="@android:style/TextAppearance">
    <item name="android:textColor">@color/white</item>
</style> 
```

我认为 ActionBarTabBarStyle 会在选项卡位于操作栏之外时设置它们的样式，但它似乎没有效果。有没有办法在操作栏拆分时获得红色选择器，在操作栏堆叠时获得黑色选择器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T12:19:23.907

当屏幕宽度高于 480dp 时，我可以通过提供不同的样式来做到这一点。小于此的屏幕被认为是窄的，并且操作栏被拆分（并且选项卡位于堆叠栏中）。

为此，请创建一个资源文件`res/values-w480dp/style.xml`并定义选项卡在操作栏中合并时的样式。在常规`res/values-w480dp/style.xml`中，定义选项卡在堆叠操作栏中时的样式。

这仅适用于 SDK>13。

这不是一个非常干净的解决方案，但它到目前为止有效。

# automated-tests - windows froms的自动烟雾测试

> ID：13108638
> 
> 赞同：2
> 
> 时间：2012-10-28T12:01:21.370
> 
> 标签：automated-tests, smoke-testing

我们有两个要运行自动冒烟测试的窗体应用程序。第一个是内容制造商，在这个应用程序中用户可以创建公式和树和......。第二个是计算器，这个应用程序使用第一个应用程序的内容和输出（数据库和 XML 文件）。

在第一个应用程序（内容制造商）中，我们可以轻松地使用烟雾测试，但在第二个应用程序中，不可能使用烟雾测试，因为内容是由用户创建的，我们如何检查结果？我想知道是否有人可以建议现有的框架或应用程序来帮助解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-02T03:10:10.207

我想说这取决于你想做什么*样的冒烟测试，功能级别或集成级别。*功能级别意味着您的冒烟测试只需要被测应用程序，集成级别意味着您需要两个应用程序的环境设置。

对于功能级别测试，依赖关系可以是模拟的或静态的。对于集成级别测试，您意识到您的验证点可能会更少。一种解决方法是让用户始终使用该环境中的预定义数据进行烟雾测试。

# android - 从 Mysql 服务器加载 ID 时出现黑色图像

> ID：13108645
> 
> 赞同：-2
> 
> 时间：2012-10-28T12:02:14.397
> 
> 标签：android, imageview

我有一个 MySQL 数据库，其中包含带有图像 ID 的人员列表。像这样：“0x7f020000”。

这些图像包含在 APK 中。但是当我将一个人添加到数据库但**不**更新 APK 时，我希望显示一些错误消息。那么如何验证图像是否存在并采取适当的行动呢？

谢谢

这行得通，感谢 user1364052 的想法

```
try
{
    d0 = getResources().getDrawable(Integer.parseInt(ID.get(img0Zahl),16)); 
    d1 = getResources().getDrawable(Integer.parseInt(ID.get(img1Zahl),16));
}
catch(Exception e)
{
    d0 = getResources().getDrawable(0x7f020197); 
    d1 = getResources().getDrawable(0x7f020197); 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T12:06:49.467

你需要在代码中解决这个问题，它与mysql无关。由于该条目存在于您的数据库中，但您的 apk 中没有该图像。可能在您通过检索到的 id 检索图像的逻辑中，您应该验证图像是否存在并采取适当的行动。

而不是捕获 NPE 异常，您应该显示错误消息。

# java - Spring MVC 表单静态文本

> ID：13108649
> 
> 赞同：3
> 
> 时间：2012-10-28T12:03:32.207
> 
> 标签：java, forms, spring

我正在尝试使用 Spring MVC 制作表单以编辑某些对象。该对象的某些字段是在创建时设置的，然后无法编辑，因此它们必须像纯文本一样显示在编辑表单上，而不是像输入一样。当我在 spring 表单标签库中没有找到像 spring:output 这样的东西时，我感到非常惊讶。怎么办？请帮助:)这是我的表格代码：

```
 <?xml version="1.0" encoding="UTF-8" ?>
    <%@page contentType="text/html" pageEncoding="UTF-8"%>
    <%@ taglib prefix="c" uri="http://java.sun.com/jstl/core" %>
    <%@taglib prefix="form" uri="http://www.springframework.org/tags/form" %>
    <%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags" %>
    <%@taglib prefix="spring" uri="http://www.springframework.org/tags" %>

    <h1><spring:message code="Information" /></h1>

    <form:form commandName="shop" method="POST">
        <table>
            <tr>
                <td><spring:message code="ShopCompanyName"/>
                <td colspan="2">**HERE MUST BE A STATIC TEXT 
FILLED WITH THE VALUE OF SOME FIELD FROM OBJECT**</td>
            </tr>
            <tr>
                <td colspan="3"><h2><spring:message code="Contacts"/></h2></td>
            </tr>
            <tr>
                <td><spring:message code="ShopUserLN"/></td>
                <td><form:input path="user.lastName"/></td>
                <td><form:errors path="user.lastName" cssClass="error"/></td>
            </tr>
            <tr>
                <td><spring:message code="ShopUserFN"/></td>
                <td><form:input path="user.firstName"/></td>
                <td><form:errors path="user.firstName" cssClass="error"/></td>
            </tr>
            <tr>
                <td><spring:message code="ShopUserMN"/></td>
                <td><form:input path="user.middleName"/></td>
            </tr>
            <tr>
                <td><spring:message code="ShopUserPhone"/></td>
                <td><form:input path="user.phone"/></td>
                <td><form:errors path="user.phone" cssClass="error"/></td>
            </tr>
        </table>
        <input type="submit" value="Save">
    </form:form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T12:19:50.487

```
<c:out value="${someObject.someProperty}"/> 
```

甚至

```
${someObject.someProperty} 
```

如果不需要 XML 转义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-05-18T15:45:54.737

如果您已将输出分离到标记文件，则可以使用 spring 数据绑定和状态对象，以避免表单名称或对象“shop”的移交：

```
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<%@ taglib prefix="my" tagdir="/path/to/tag"%>

<form:form commandName="shop" method="POST">
    <my:formFieldFixed path="name"/>
</form> 
```

并在 /path/to/tag/formFieldFixed.tag 文件中

```
<%@ attribute name="path" required="true" type="java.lang.String" %>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags" %>

<spring:bind path="${path}">
    <span>${status.value}</span>
</spring:bind> 
```

使用这样的绑定，您还可以将表单错误与表单容器分开，等等。在此处查看示例： [https ://docs.spring.io/spring/docs/1.1.5/taglib/tag/BindTag.html](https://docs.spring.io/spring/docs/1.1.5/taglib/tag/BindTag.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-06T14:02:07.810

如果您想在 Spring 中的一行中创建多个字段，那么您可以使用以下代码：

```
<tr>
    <td><form:label path="first_name">First Name:</form:label></td>
    <td><form:input path="first_name" /></td>

    <td><form:label path="last_name">Last Name:</form:label></td>
    <td><form:input path="last_name" /></td>
</tr> 
```

这是在单行中创建表单字段的最简单方法...

# core-data - 核心数据模型设置

> ID：13108656
> 
> 赞同：0
> 
> 时间：2012-10-28T12:04:18.750
> 
> 标签：core-data

我有一个使用核心数据模型跟踪 iOS 应用程序的费用：

设想：

-> 一个名为“Money”的抽象父实体，具有“vendor”、“date”、“amount”等属性。“费用”和“收入”这两个子实体继承自父实体“金钱”。然后还有其他实体，例如“Category”和“subCategory”及其属性。截至目前的总数：我的数据模型中有 5 个实体（金钱、费用、收入、类别和子类别）。

问题：我想要实现的是每天、每周、每两周、每月和每年跟踪费用。我正在考虑用 12 个属性（一月 - 十二月 - > 月份名称）让一个实体说“月份”，但这不是太复杂吗？

想法？

我有一个表格视图，并使用 NSFetchedResultsController 来填充我的表格视图，其中包含混合 od 费用和收入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T12:40:33.067

您必须为适当的时间段创建一个`NSFetchRequest`过滤器。`NSPredicate`假设您想列出两个日期之间的所有费用，您可以实现一个返回`NSFetchRequest`此期间过滤器的方法：

```
- (NSFetchRequest *)filteredFetchRequestForEntity:(NSString *)entityName startDate:(NSDate *)startDate endDate:(NSDate *)endDate
{
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"(date >= %@) AND (date <= %@", startDate, endDate];
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:entityName inManagedObjectContext:self.managedObjectContext];
    [fetchRequest setEntity:entity];
    [fetchRequest setPredicate:predicate];

    return fetchRequest;
} 
```

然后，您可以使用此 fetchRequest 例如，`NSFetchedResultsController` 类似于我在您的其他问题中的回答： [CoreData 和 TableViews](https://stackoverflow.com/questions/13108252/core-data-and-table-views/13108396#13108396)

然后，您所要做的就是在您想要的时间段内为 start- 和 endDate 创建 NSDate 对象，并将它们传递给此方法。

# php - 将 CF 响应解析为数组

> ID：13108657
> 
> 赞同：1
> 
> 时间：2012-10-28T12:04:19.880
> 
> 标签：php, arrays, json

我有一个 CFResponse，我想将其解析成这样的数组：

```
$response = $this->scan($query);        
$array = $response->body->Items->to_array();
print_r($array); 
```

出于某种原因，这给了我一个空的 CFArray，而

```
$response->body->Items->to_json(); 
```

另一只手给了我这个：

```
{"userID":{"S":"someemail@me.com"},"password":{"S":"secretPassword"}} 
```

这只是第一行。但是，这是我通过 $response->body; 得到的。

```
CFSimpleXML Object ( [ConsumedCapacityUnits] => 0.5 [Count] => 2 [Items] => Array ( [0] => CFSimpleXML Object ( [userID] => CFSimpleXML Object ( [S] => someemail@me.com ) [password] => CFSimpleXML Object ( [S] => secretPassword ) ) [1] => CFSimpleXML Object ( [userID] => CFSimpleXML Object ( [S] => somemoreemail@me.com ) [password] => CFSimpleXML Object ( [S] => secretPassword ) ) ) [ScannedCount] => 2 ) 
```

正如您在此处看到的，Items 是一个数组。它是一个 SimpleXMLIterator 对象。有两行被返回。

通过调用 Items，我只得到第一个对象。如何将所有孩子解析成一个数组，或者至少制作一个 json 字符串？我试过[getChildren()](http://php.net/manual/de/simplexmliterator.getchildren.php)，但没有用。另外，为什么不`to_array()`工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T08:30:30.480

```
$query_response = $db->query(array(
        'TableName'    => $tableName,
        'HashKeyValue' => $db->attribute($peer)
));

if (!$query_response->isOK()){
    die(json_encode(CFUtilities::convert_response_to_array($query_response)));
}

$ps = array();

foreach ($query_response->body->Items as $item)
{
    if (empty($item)) continue;
    $p = array();
    $p['P'] = (string) $item->p->S;
    $p['TIME'] = (integer) $item->TIME->N;
    $p['STATUS'] = (string) $item->STATUS->S;
    $p['ICON'] = (string) $v->ICON->S;
    array_push($ps,$p);
}
echo json_encode($ps); 
```

# asp.net - 无法识别的属性“targetFramework”属性名称区分大小写

> ID：13108660
> 
> 赞同：0
> 
> 时间：2012-10-28T12:05:13.780
> 
> 标签：asp.net, iis

这是一个常见错误，在 SO 上已多次讨论。但在将我发送到其他答案之前，请阅读以下情况。这不是针对错误框架的情况。

编辑：如果 web.config 以“4.0”或“4.0.3”为目标，则发生错误，其中之一。

在 Visual Studio 2010（在 Win 7 x64 上）中，我进入了高级编译选项并从目标框架下拉列表中选择了“安装其他框架”。此过程从 Microsoft 网站下载 4.0.3 框架。安装过程需要几分钟，并且需要重新启动。我下载，安装并重新启动。

然后我在 Visual Studio 2010 中进入我的应用程序，针对 4.0.3 框架，这一步需要关闭并重新打开项目，我这样做了。然后我重建了这个项目。我可以在 Visual Studio 中成功运行该应用程序。然后我发布了应用程序。但它不能直接在浏览器中运行。我收到以下错误。只是为了确保，我在收到错误后重新注册了框架，但并不高兴：

```
cd C:\Windows\Microsoft.NET\Framework\v4.0.30319
iisreset /stop
aspnet_regiis -i
iisreset /start

======================================
Configuration Error

Description: An error occurred during the processing of a configuration file required to service this request. Please review the specific error details below and modify your configuration file appropriately. 

Parser Error Message: Unrecognized attribute 'targetFramework'. Note that attribute names are case-sensitive.

Source Error: 

Line 9:    </connectionStrings>
Line 10:   <system.web>
Line 11:     <compilation strict="false" explicit="true" targetFramework="4.0.3" />
Line 12:     <authentication mode="None" />
Line 13:     <membership> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T12:08:41.353

您为 输入的值`targetFramework`无效`4.0.3`。

从有关[`<compilation>`元素](http://msdn.microsoft.com/en-us/library/s10awwz0%28v=vs.100%29.aspx)的文档中：

```
targetFramework="2.0|3.0|3.5|4.0" 
```

所以，只要放下`.3`，你应该没问题。

# php - DOMDocument::save [domdocument.save]：打开流失败：权限被拒绝

> ID：13108661
> 
> 赞同：3
> 
> 时间：2012-10-28T12:06:00.170
> 
> 标签：php, xml, apache, curl

我有一个代码可以将 XML 文件保存到我的目录中。它实际上在我的本地主机和我的共享主机中就像一个魅力，但它在我的 Linux VPS 中不起作用。

我总是收到这个错误：

警告：DOMDocument::save(/home/admin/xxxxxx) [domdocument.save]：无法打开流：第 240 行 /home/admin/xxxxx 中的权限被拒绝

我现在能做什么？我有 chmod 777 目录但仍然无法正常工作......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-13T12:03:33.123

即使**文件**是可读/可写的，您也可能无权在此**文件夹中写入内容。**尝试

 **```
cd /said/folder
chmod a+w . 
```

*如果这可行，请尝试通过删除**每个人*的写入位来缩小 rw 权限：

```
chmod a-w . 
```

并且仅将其授予默认 Web 服务器*组*（请参阅您的 GNU/Linux 分发手册），例如：

```
chown .www-data . 
```**

# c++ - 存储函数调用和稍后调用的参数列表

> ID：13108663
> 
> 赞同：3
> 
> 时间：2012-10-28T12:06:20.653
> 
> 标签：c++, locking

由于锁定，我的代码面临性能问题。请参见下面的草图（无论如何不能发布太大的实际代码）：

```
XYZ::process()
{
  ...
  lock();
  processSharedData(id );
  unlock();
  ...
}

XYZ::processSharedData(obj id)
{
  obj a = accessDataAttr1(id);
  //do some integrity checks

  //evaluate some conditions and then
  func1(attr1, attr2, attr3, ...);

  obj b = accessDataAttr2(id);
  //do some integrity checks

  //evaluate some conditions and then
  func2(attr1, attr2, attr3, ...);

  obj c = accessDataAttr3(id);
  //do some integrity checks

  //evaluate some conditions and then
  func3(attr1, attr2, attr3, ...);

  //do some clean up
  return;
} 
```

现在我想将 func1、func2 和 func3 从锁定/解锁范围中移出。请提出有效的方法。有没有办法用它的参数存储函数调用以便以后调用它？

将所有参数存储在成员结构中并将函数指针存储在 std::list 中怎么样？

编辑：

很抱歉在我还没有 c++11 之前没有提到这一点。任何没有 std:function 和 std:bind 的解决方案现在都很好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T12:18:07.677

确保您可以这样做：

```
typedef std::vector<std::function<void(void)>> f_list;

XYZ::process() {
  //our function list
  f_list fl;
  lock();
  fl=processSharedData(id );
  unlock();
  //invoke functions
  for(auto& f : fl) f();
}

f_list XYZ::processSharedData(obj id) {
  f_list fl;
  obj a = accessDataAttr1(id);
  //do some integrity checks

  fl.push_back(
       std::bind(&func1, attr1, attr2, attr3)
  );

  obj b = accessDataAttr2(id);
  //do some integrity checks

  //evaluate some conditions and then
  fl.push_back(
       std::bind(&func2, attr1, attr2, attr3)
  );
  //and so on
  return fl;
} 
```

## 参考

[http://en.cppreference.com/w/cpp/utility/functional/bind](http://en.cppreference.com/w/cpp/utility/functional/bind)

[http://en.cppreference.com/w/cpp/utility/functional/function](http://en.cppreference.com/w/cpp/utility/functional/function)

[http://en.cppreference.com/w/cpp/container/vector](http://en.cppreference.com/w/cpp/container/vector)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-28T12:22:49.840

要基于 111111 的答案，如果要调用的函数是`XYZ`类中的成员函数，则必须将实例作为第一个参数传递：

```
fl.push_back(
    std::bind(&func1, this, attr1, attr2, attr3)
); 
```

稍后当您调用函数时，您可以使用 C++11 中的另一个新功能：基于[范围的 for 循环](http://en.wikipedia.org/wiki/C++11#Range-based_for-loop)：

```
for (auto f : fl)
    f(); 
```

# math - 如何解决一般复发？

> ID：13108668
> 
> 赞同：0
> 
> 时间：2012-10-28T12:07:04.870
> 
> 标签：math, recurrence

有没有办法解决形式的一般递归关系

```
a(n)=a(n-1) * a(n-2).... 
```

我的意思是我可以使用矩阵方法来解决表格的关系

```
F(n)=a1*F(n-1) + a2*F(n-2).......+ ak*F(n-k) 
```

但是当有`'*'`标志而不是`'+'`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T12:43:41.173

使用对数：

```
a(n) = a(n-1) * a(n-2) * a(n-3) * .... 
```

记录双方的日志：

```
log(a(n)) = log(a(n-1) * a(n-2) * a(n-3) * ...) 
```

使用事实`log(a * b) = log(a) + log(b)`来分解因子：

```
log(a(n)) = log(a(n-1)) + log(a(n-2)) + log(a(n-3)) + ... 
```

现在，如果你这么说，`F(n) = log(a(n))`那么这个方程看起来就像你的第二个方程。使用矩阵方法求解`log(a(n))`：

```
log(a(n)) = X 
```

留下：

```
a(n) = e ^ X 
```

（假设你取自然对数）

# javascript - jqGrid - 单击，右键单击，onSelectRow

> ID：13108677
> 
> 赞同：7
> 
> 时间：2012-10-28T12:08:37.403
> 
> 标签：javascript, jqgrid

在 jqGrid 中，在行选择之​​前，是否有一种“内置”方法可以知道单击了哪个鼠标按钮？

目前我们有 jqGrid，一些动作绑定在 jqGrid 的“onSelectRow”事件上。问题是当用户右键单击该行时，会引发 onSelectRow 事件并执行操作。我需要的是当用户右键单击一行时忽略“onSelectRow”。

**编辑：**我知道存在 onRightClickRow 事件，但它在 onSelectRow 和已经执行的操作之后引发。

我发现我可以知道事件对象的“类型”单击了哪个按钮。单击时，右键单击时类型为“单击”，类型为“上下文菜单”....是否存在附加方式，或者我必须检查类型才能知道单击了哪个按钮？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-28T12:58:20.230

这是个好问题！这种行为的原因如下。jqGrid使用以下代码`contextmenu`为整个网格元素上的事件注册一个事件处理程序（请参见[此处](https://github.com/tonytomov/jqGrid/blob/v4.4.1/js/grid.base.js#L2500-2509)）`<table>`

```
.bind('contextmenu', function(e) {
    td = e.target;
    ptr = $(td,ts.rows).closest("tr.jqgrow");
    if($(ptr).length === 0 ){return;}
    if(!ts.p.multiselect) { $(ts).jqGrid("setSelection",ptr[0].id,true,e);  }
    ri = ptr[0].rowIndex;
    ci = $.jgrid.getCellIndex(td);
    $(ts).triggerHandler("jqGridRightClickRow", [$(ptr).attr("id"),ri,ci,e]);
    if ($.isFunction(this.p.onRightClickRow)) {
        ts.p.onRightClickRow.call(ts,$(ptr).attr("id"),ri,ci, e);
    }
}); 
```

从代码中可以看出它调用`setSelection`方法并调用`onRightClickRow`回调和触发`jqGridRightClickRow`事件。因此，如果您不需要选择行并且不使用`onRightClickRow`并且`jqGridRightClickRow` **您可以取消绑定事件处理程序**：

```
$("#list").unbind("contextmenu"); 
```

如果您确实想要使用`onRightClickRow`回调，或者如果您不确定是否需要在`jqGridRightClickRow`某个地方使用，您可以“子类化”事件处理程序。实现有点依赖于您使用的 jQuery 版本。从 jQuery 1.8 开始，应该使用另一个调用来获取在 DOM 元素上注册的当前事件。相应的代码可能如下：

```
//$grid.unbind('contextmenu');

var getEvents = $._data($grid[0], "events"); // $grid.data("events") in jQuery ver<1.8
if (getEvents && getEvents.contextmenu && getEvents.contextmenu.length === 1) {
    var orgContextmenu = getEvents.contextmenu[0].handler;
    $grid.unbind('contextmenu', orgContextmenu);
    $grid.bind('contextmenu', function(e) {
        var oldmultiselect = this.p.multiselect, result;
        this.p.multiselect = true; // set multiselect to prevent selection
        result = orgContextmenu.call(this, e);
        this.p.multiselect = oldmultiselect; // restore multiselect
        return result;
    });
} 
```

[该演示](http://www.ok-soft-gmbh.com/jqGrid/DontSelectOnRightClick.htm)现场演示了上述代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T12:26:04.580

事件列在这里： [http ://www.trirand.com/jqgridwiki/doku.php?id=wiki:events](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:events)

有一个 onRightClickRow 事件。

另外，使用普通的 jquery 事件对象`which`会告诉你。[http://api.jquery.com/event.which/](http://api.jquery.com/event.which/)

您必须将第三个参数用于 onRowSelected`which`或您提到的类型。

# c# - 通过 asp.net 中 QueryString 中的参数在 CreateUserWizard 中设置步骤

> ID：13108678
> 
> 赞同：0
> 
> 时间：2012-10-28T12:08:40.450
> 
> 标签：c#, asp.net, vb.net, createuserwizard

我有 createuserwizard 控件，它有 4 个步骤。当 qeurystring 中存在某些参数时，我想在步骤 0 中为 contols 设置它们，然后将 activeindex 设置为下一步。我这样做：

```
 if (!Page.IsPostBack)
        {
            if (!String.IsNullOrEmpty(Request["from"]) && !String.IsNullOrEmpty(Request["to"]) && !String.IsNullOrEmpty(Request["seek"]) && !String.IsNullOrEmpty(Request["livein"]))
            {
                ((DropDownList)RegisterUser.WizardSteps[0].FindControl("ddlGender")).SelectedValue = Request["seek"];
                ((TextBox)RegisterUser.WizardSteps[0].FindControl("txtAgeFrom")).Text = Request["from"];
                ((TextBox)RegisterUser.WizardSteps[0].FindControl("txtAgeTo")).Text = Request["to"];
                ((DropDownList)RegisterUser.WizardSteps[0].FindControl("ddlLive")).SelectedValue = Request["livein"];

                RegisterUser.ActiveStepIndex = 1;
            }
        } 
```

这有效并将当前步骤设置为正确的步骤，但问题是“上一个”按钮不起作用并且它不会转到步骤 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T06:00:21.617

当在 ASP.NET 中的 Wizzard 控件上单击上*一个*按钮时，会触发两个事件，顺序如下：

1)`PreviousButtonClick`

2)`ActiveStepChanged`

*我的建议是 - 在这两个事件中设置断点，并确保在单击Previous*时都执行。

此外，如果您在我刚刚提到的两个事件处理程序中有任何代码，请确保它们不会重置`ActiveStepIndex`

# jquery - 需要阻止 div 在 JQM 中滚动

> ID：13108680
> 
> 赞同：0
> 
> 时间：2012-10-28T12:08:50.700
> 
> 标签：jquery, html, css, jquery-mobile

这是我的[http://jsfiddle.net/coderslay/Lhb5Y/](http://jsfiddle.net/coderslay/Lhb5Y/)实现

基本上我有这样的内容

```
<div data-role="content">
   <div><!--Contains a button --></div>
   <div><ul>..<!--Contains a list -->...</ul></div>
</div> 
```

现在我想让包含按钮的 div 固定并且在列表应该滚动时不应该滚动。如何在 JQM 中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T18:57:47.823

可能`data-position="fixed"`有帮助：

```
 <div data-role="page" id="page1">
    <div data-role="header" data-position="fixed">
      <h3>Page1</h3>
      <div data-role="button" data-theme="b">Something</div>
    </div>

    <div data-role="content">
      <div>
        <ul data-role="listview">
          ...
        </ul>          
      </div>
    </div>
  </div> 
```

另请参阅[此处的文档](http://jquerymobile.com/test/docs/toolbars/bars-fixed.html)

```
Fixed header markup example:
<div data-role="header" data-position="fixed">
    <h1>Fixed Header!</h1>
</div> 
```

你也可能想在[这里阅读](https://stackoverflow.com/questions/8701287/jquery-mobile-why-fixed-header-footer-are-not-really-css-fixed)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T12:19:59.343

您希望`div`使用按钮定位`fixed`，使其始终显示在顶部。看看[这个](http://jsfiddle.net/TheJoeFletch/mz6rn/)。以下是详细信息的摘要。

```
<div data-role="content">
   <div style="position: fixed; top:0px; height: 100px;"><!--Contains a button --></div>
   <div style="margin-top: 110px;"><ul>..<!--Contains a list -->...</ul></div>
</div> 
```

# perl - Perl TK 与 Proc::Background 正确使用（保持 GUI 活动？）

> ID：13108682
> 
> 赞同：0
> 
> 时间：2012-10-28T12:08:58.237
> 
> 标签：perl, cmd, system, fork, tk

我正在尝试构建一个显示系统 cmd 进度的顶级窗口。我希望 GUI 处于活动状态（没有冻结和“无响应”），因此按下“取消”按钮将终止进程，否则，完成后，激活“关闭”按钮并禁用“取消”。根据对我之前的一个问题的建议，我尝试使用 Proc::Background。我发现这样做的唯一方法是：

```
my $proc1;

my $cancel = $toplevel->Button(-text => "Cancel", -command =>sub{$proc1->die;})->pack;
my $close = $toplevel->Button(-text => "Close", -command =>sub{destroy $toplevel;}, -state=>"disabled")->pack;

$proc1 = Proc::Background->new("x264.exe $args");

while ($proc1->alive == 1){
    $mw->update();
    sleep(1);
}

$cancel->configure(-state=>'disabled');
$close->configure(-state=>'normal'); 
```

是否有另一种更有效的方法（无需等待 1 秒响应）？

谢谢，马克。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T16:37:42.410

我使用 Time::HiRes::usleep。

```
use Time::HiRes qw(usleep);
while ($proc1->alive == 1){
    $mw->update();
    usleep(100_000); //0.1 seconds
} 
```

对于这个问题，这可能有点过头了，但在某些时候，我们的 UI 应用程序会增长，我们迫切需要使用高分辨率计时器，并在整个应用程序中异步调度和侦听事件。为此，我发现[POE](http://search.cpan.org/~rcaputo/POE-1.354/lib/POE.pm)框架是一项巨大的资产。

我特别将 POE 与 wxWidgets 一起使用，但它也与 Tk 兼容： [POE::Loop::Tk](http://search.cpan.org/~rcaputo/POE-Loop-Tk-1.304/lib/POE/Loop/Tk.pm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T19:08:09.483

该[`after`方法](http://search.cpan.org/dist/Tk/pod/after.pod)（任何 Tk 小部件的）允许您安排回调在未来某个毫秒数发生，并且该[`waitVariable`方法](http://search.cpan.org/~srezic/Tk/pod/Widget.pod)（您需要在页面中搜索）将运行事件循环，直到设置了变量。

```
my $proc1;
my $cancel = $toplevel->Button(-text => "Cancel", -command =>sub{$proc1->die;})->pack;
$proc1 = Proc::Background->new("x264.exe $args");
my $procDone = 0;
my $timercb = sub {
    if ($proc1->alive) {
        $toplevel->after(100, $timercb);
    } else {
        $procDone = 1; # Anything really
    }
};
$timercb();
$toplevel->waitVariable(\$procDone) unless ($procDone); 
```

(I'm not sure if this code will work; I don't code very much in Perl these days, so I'm translating what I'd do in [another language](http://www.tcl.tk/)…)

# delphi - Delphi 本地网络应用程序

> ID：13108683
> 
> 赞同：3
> 
> 时间：2012-10-28T12:09:16.657
> 
> 标签：delphi, sockets, drawing, client-server, delphi-7

尝试学习如何制作服务器客户端应用程序之类的东西。我试图在所有客户端中绘制圆圈（单击鼠标），所以这就是我尝试这样做的方式。但它不起作用 - 没有错误，但表单是空的。我需要修复什么？客户端代码

```
unit Client;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, ExtCtrls, {Figure, Ball,} IdBaseComponent, IdComponent,
  IdTCPConnection, IdTCPClient, ScktComp;

type
  TForm1 = class(TForm)
    Timer1: TTimer;
    Button1: TButton;
    ClientSocket: TClientSocket;
    procedure FormCreate(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Timer1Timer(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure FormMouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);

  private

  public
    { Public declarations }
  end;

var
  Form1: TForm1;
  f:boolean;
  p:MyPoint;
  s:MyPoint;
  z:TCanvas;
  obj: MyFigure;
  pX, pY:Integer;
  myBuf: array[1..32] of Integer;
  dataBuf: array[1..32] of Integer;
implementation

{$R *.dfm}

procedure TForm1.FormCreate(Sender: TObject);
begin

  Timer1.Enabled:=false;
  Timer1.Interval:=5;
  z:=Form1.Canvas;//TCanvas.Create;

  Button1.Caption:='Пуск';

  f:=false;

  ClientSocket.Port:=1234;
  ClientSocket.Active:= False;
end;

procedure TForm1.Button1Click(Sender: TObject);
begin
if not f then
 begin
  Timer1.Enabled:=true;
  Button1.Caption:='Стоп';
  f:=not f;
 end
else
 begin
  Timer1.Enabled:=false;
  Button1.Caption:='Пуск';
  ClientSocket.Active:= True;
  f:=not f;
 end;
end;

procedure TForm1.Timer1Timer(Sender: TObject);
begin
 //z.Lock;

  //z.Brush.Color:=ClWhite;
  //z.FillRect(Canvas.ClipRect);

  //obj.Draw(z);
  if ClientSocket.Active  then
     ClientSocket.Socket.ReceiveBuf(dataBuf, 32);

  z.Brush.Color:=ClRed; 
  z.Ellipse(dataBuf[1] + 10, dataBuf[2] + 10,dataBuf[1] - 10, dataBuf[2] - 10);

//z.Unlock;
end;

procedure TForm1.FormClose(Sender: TObject; var Action: TCloseAction);
begin
      ClientSocket.Active := false;
end;

procedure TForm1.FormMouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin

  myBuf[1]:=X;
  myBuf[2]:=Y;
  if ClientSocket.Active  then
     ClientSocket.Socket.SendBuf(myBuf, 32);

end;

end. 
```

服务器

```
unit ServerProject;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, ScktComp;

type
  TForm1 = class(TForm)
    ServerSocket1: TServerSocket;
    procedure FormCreate(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure ServerSocket1ClientRead(Sender: TObject;
      Socket: TCustomWinSocket);
    procedure ServerSocket1ClientWrite(Sender: TObject;
      Socket: TCustomWinSocket);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;
  sBufer : array [1..32] of Integer;
implementation

{$R *.dfm}

procedure TForm1.FormCreate(Sender: TObject);
begin
  ServerSocket1.Port:=1234;
  ServerSocket1.Active := True;
end;

procedure TForm1.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  ServerSocket1.Active := false;
end;

procedure TForm1.ServerSocket1ClientRead(Sender: TObject;
  Socket: TCustomWinSocket);
var
  i:integer;

begin
  for i := 0 to ServerSocket1.Socket.ActiveConnections-1 do
  begin
    with ServerSocket1.Socket.Connections[i] do
    begin
      ReceiveBuf(sBufer, 32);
    end;
  end;
end;

procedure TForm1.ServerSocket1ClientWrite(Sender: TObject;
  Socket: TCustomWinSocket);
var
  i:integer;

begin
  for i := 0 to ServerSocket1.Socket.ActiveConnections-1 do
  begin
    with ServerSocket1.Socket.Connections[i] do
    begin
      SendBuf(sBufer, 32);
    end;
  end;

end;

end. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T12:15:33.643

您的绘画代码在错误的位置并且正在绘画错误的东西。在 Windows 程序中，您需要绘制以响应`WM_PAINT`消息。你没有这样做。更重要的是，您必须在调用`BeginPaint`.

VCL 为您包装了所有这些细节，但您仍然需要遵守规则。在您的情况下，我建议您`TPaintBox`在表单中添加一个组件。然后`OnPaint`为画框实现一个事件处理程序。最后，每当您希望重新绘制油漆盒时，例如在计时器上，调用`Invalidate`油漆盒的方法。

我怀疑除了先前绘制的椭圆之外，您还希望绘制每个新椭圆。在这种情况下，最好先将它们绘制到屏幕外的位图上，然后，当您要绘制到绘图框时，在绘图框上绘制该位图。关键是一个窗口需要能够重新绘制它自己的整体。当您绘制到屏幕设备时，您绘制的内容会在下次需要绘制该窗口时丢失。因此，应用程序有责任在任何时候绘制它的整个自身，如果被要求的话。

更一般地说，我敦促您停止使用全局变量。他们会给你带来无穷无尽的麻烦。尽可能选择局部变量。如果您需要在不同的方法调用之间保持状态，请使用成员变量。指导原则是尽可能使用最窄的范围。

您当前的设计使用计时器来轮询新数据。这是一个非常糟糕的方法。最有效和最有效的方法是使用同步阻塞通信。Indy 采用了这种方法。相反，Windows 套接字组件倾向于以异步模式使用。不管这两种方法的相对优点如何，您都不应该对计时器进行轮询。如果您确实使用异步通信，则通过处理事件而不是轮询来响应新数据。

您的程序目前正在尝试将 GDI 绘画和网络通信混合在一起。我建议您尝试一次掌握这些概念。学习如何在不分心交流的情况下绘画。然后当你画坏了，试着引入交流方面。

# python - Python wave MemoryError

> ID：13108684
> 
> 赞同：0
> 
> 时间：2012-10-28T12:09:36.307
> 
> 标签：python, memory, memory-leaks, wav, wave

我正在处理 wav 文件并使用 python 的 wave 模块检查每个文件的能级。一切都适用于几十个文件，但突然间我开始得到这个 MemoryError 异常。与此同时，我忽略了异常并继续检查，这些检查有时会因异常而失败，有时会给我答案。

检查文件的方法是这样的（**请关注 MemoryError 异常，因为我的代码可以正常工作，尽管目前我无法访问它，所以我决定重写它的基础知识**）：

```
import wave,os,glob

def wavCheck(filepath):
    with open(filepath,'rb') as w:
        handle = wave.open(w)
        data = handle.readframes()
        nframes = handle.getnframes()
        channels = [[] for x in handle.getchannels()]
        for i in nframes:
            bucket = i%2
            channels[bucket].append(data[i])
        for channel in channels:
            # calculate which frame is silent and do something
        handle.close()
        del handle
        del nframes
        del channels
    return results

if __name__ == "__main__":
    while os.path.exists(someDirectoryWhichContainWaves):
        for filepath in glob.glob(someDirectoryWhichContainWaves+'\*.wav')
            results = wavCheck(filepath)
            # Do something with results 
```

好吧-假设读取文件正常并且一切顺利并且按预期进行，当然波形文件都正常，为什么我会得到 MemoryError 异常？

额外细节 -

1.  波形文件在 3MBytes 和 10MBytes 之间
2.  我一直在尝试自定义垃圾收集器以收集每隔几次迭代，但这没有用。在阅读了一些关于 GC 的内容后，我决定最好的方法是检查是否有垃圾要收集。所以我做了。这也不起作用。

请-这里有什么想法吗？

干杯。

# query-string - 如何在 Dart 中解析查询字符串？

> ID：13108689
> 
> 赞同：4
> 
> 时间：2012-10-28T12:10:03.313
> 
> 标签：query-string, dart

如何在[Dart](http://dartlang.org)中安全地解析查询字符串？

假设我的`q`字符串值为：

```
?page=main&action=front&sid=h985jg9034gj498g859gh495 
```

理想情况下，代码应该在服务器和客户端都可以工作，但现在我将满足于工作的客户端代码。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-12-02T19:03:13.367

越简单越好。查找类 Uri的[splitQueryString静态方法。](https://api.dartlang.org/apidocs/channels/stable/dartdoc-viewer/dart:core.Uri#id_splitQueryString)

```
Map<String, String> splitQueryString(String query, {Encoding encoding: UTF8}) 

Returns the query split into a map according to the rules specified for 
FORM post in the HTML 4.01 specification section 17.13.4\. Each key and value 
in the returned map has been decoded. If the query is the empty string an 
empty map is returned. 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-28T12:18:54.013

我为此目的制作了一个简单的包：[https ://github.com/kaisellgren/QueryString](https://github.com/kaisellgren/QueryString)

例子：

```
import 'package:query_string/query_string.dart');

void main() {
  var q = '?page=main&action=front&sid=h985jg9034gj498g859gh495&enc=+Hello%20&empty';

  var r = QueryString.parse(q);

  print(r['page']); // "main"
  print(r['asdasd']); // null
} 
```

结果是一个[`Map`](http://api.dartlang.org/docs/bleeding_edge/dart_core/Map.html). 访问参数只是一个简单的`r['action']`，访问一个不存在的查询参数是`null`。

现在，要安装，添加到您`pubspec.yaml`的依赖项：

```
dependencies:
  query_string: any 
```

并运行`pub install`。

该库还处理诸如`%20`和之类的解码，`+`甚至对空参数也有效。

它不支持“数组样式参数”，因为它们不是[RFC 3986](https://www.rfc-editor.org/rfc/rfc3986)规范的一部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-22T13:51:52.353

我这样做是这样的：

```
 Map<String, String> splitQueryString(String query) {
    return query.split("&").fold({}, (map, element) {
      int index = element.indexOf("=");
      if (index == -1) {
        if (element != "") {
          map[element] = "";
        }
      } else if (index != 0) {
        var key = element.substring(0, index);
        var value = element.substring(index + 1);
        map[key] = value;
      }
      return map;
    });
 } 
```

我从 [splitQueryString](https://api.dartlang.org/apidocs/channels/stable/dartdoc-viewer/dart:core.Uri#id_splitQueryString)

# web - 谷歌脚本网络应用程序触发器取决于时间不起作用

> ID：13108691
> 
> 赞同：0
> 
> 时间：2012-10-28T12:11:22.603
> 
> 标签：web, triggers, google-apps-script

我已将我的脚本部署为 Web 应用程序，我有触发 onTime，但触发器不想执行我的脚本。如何在主机和客户端都获得 Web 应用程序和准时触发器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-04T19:59:33.197

据我所知，您不能同时通过基于时间的触发器和网络应用程序来执行谷歌脚本。

# c# - 在 .NET 中序列化高度链接的数据（自定义 JSON.NET 引用）

> ID：13108693
> 
> 赞同：7
> 
> 时间：2012-10-28T12:11:27.860
> 
> 标签：c#, .net, json, serialization, json.net

我想避免在序列化数据时重新发明轮子。我知道一些序列化相互链接的对象的方法，但它的范围从编写一些代码到编写大量用于序列化的代码，我想避免这种情况。必须有一些通用的解决方案。

假设我有这样的结构：

```
Person
    bro = new Person { name = "bro", pos = new Pos { x = 1, y = 5 } },
    sis = new Person { name = "sis", pos = new Pos { x = 2, y = 6 } },
    mom = new Person { name = "mom", pos = new Pos { x = 3, y = 7 }, 
        children = new List<Person> { bro, sis }
    },
    dad = new Person { name = "dad", pos = new Pos { x = 4, y = 8 }, 
        children = new List<Person> { bro, sis }, mate = mom
    };
mom.mate = dad;
Family family = new Family { persons = new List<Person> { mom, dad, bro, sis } }; 
```

我想将数据序列化为这样的：

```
family: {
    persons: [
        { name: "bro", pos: { x: 1, y: 5 } },
        { name: "sis", pos: { x: 2, y: 6 } },
        { name: "mom", pos: { x: 3, y: 7 }, mate: "dad", children: [ "bro", "sis" ] },
        { name: "dad", pos: { x: 4, y: 8 }, mate: "mom", children: [ "bro", "sis" ] },
    ]
} 
```

在这里，链接被序列化为名称，假设名称是唯一的。链接也可以是“family.persons.0”或生成的唯一 ID 或其他。

要求：

1.  格式必须是**人类可读的**，最好也是**人类可写的**。因此，按照优先顺序：JSON、YAML*、XML、自定义。没有二进制格式。

2.  序列化必须支持 .NET 提供的所有好东西。**泛型**是必须的，包括 IEnumerable<>、IDictionary<> 等类型。动态类型/无类型对象是可取的。

3.  格式**不能是可执行**的。没有 Lua、Python 等脚本和类似的东西。

4.  如果生成了唯一 ID，它们必须是稳定的（通过序列化-反序列化持续存在），因为文件将被放入**版本控制系统中**。

* 听说过 YAML，但遗憾的是，它似乎已经死了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-28T22:59:40.050

使用 JSON.NET（很棒的库！）解决了这个问题。现在，首先，对象被序列化并准确引用到我想要它们的位置；其次，没有大量的“$id”和“$ref”字段。在我的解决方案中，对象的第一个属性用作其标识符。

我创建了两个`JsonConvertor`s（用于引用对象和引用对象）：

```
interface IJsonLinkable
{
    string Id { get; }
}

class JsonRefConverter : JsonConverter
{
    public override void WriteJson (JsonWriter writer, object value, JsonSerializer serializer)
    {
        writer.WriteValue(((IJsonLinkable)value).Id);
    }

    public override object ReadJson (JsonReader reader, Type type, object existingValue, JsonSerializer serializer)
    {
        if (reader.TokenType != JsonToken.String)
            throw new Exception("Ref value must be a string.");
        return JsonLinkedContext.GetLinkedValue(serializer, type, reader.Value.ToString());
    }

    public override bool CanConvert (Type type)
    {
        return type.IsAssignableFrom(typeof(IJsonLinkable));
    }
}

class JsonRefedConverter : JsonConverter
{
    public override void WriteJson (JsonWriter writer, object value, JsonSerializer serializer)
    {
        serializer.Serialize(writer, value);
    }

    public override object ReadJson (JsonReader reader, Type type, object existingValue, JsonSerializer serializer)
    {
        var jo = JObject.Load(reader);
        var value = JsonLinkedContext.GetLinkedValue(serializer, type, (string)jo.PropertyValues().First());
        serializer.Populate(jo.CreateReader(), value);
        return value;
    }

    public override bool CanConvert (Type type)
    {
        return type.IsAssignableFrom(typeof(IJsonLinkable));
    }
} 
```

以及保存引用数据的上下文（每种类型都有一个字典，因此 ID 只需要在相同类型的对象中是唯一的）：

```
class JsonLinkedContext
{
    private readonly IDictionary<Type, IDictionary<string, object>> links = new Dictionary<Type, IDictionary<string, object>>();

    public static object GetLinkedValue (JsonSerializer serializer, Type type, string reference)
    {
        var context = (JsonLinkedContext)serializer.Context.Context;
        IDictionary<string, object> links;
        if (!context.links.TryGetValue(type, out links))
            context.links[type] = links = new Dictionary<string, object>();
        object value;
        if (!links.TryGetValue(reference, out value))
            links[reference] = value = FormatterServices.GetUninitializedObject(type);
        return value;
    }
} 
```

属性上的一些属性是必需的：

```
[JsonObject(MemberSerialization.OptIn)]
class Family
{
    [JsonProperty(ItemConverterType = typeof(JsonRefedConverter))]
    public List<Person> persons;
}

[JsonObject(MemberSerialization.OptIn)]
class Person : IJsonLinkable
{
    [JsonProperty]
    public string name;
    [JsonProperty]
    public Pos pos;
    [JsonProperty, JsonConverter(typeof(JsonRefConverter))]
    public Person mate;
    [JsonProperty(ItemConverterType = typeof(JsonRefConverter))]
    public List<Person> children;

    string IJsonLinkable.Id { get { return name; } }
}

[JsonObject(MemberSerialization.OptIn)]
class Pos
{
    [JsonProperty]
    public int x;
    [JsonProperty]
    public int y;
} 
```

因此，当我使用此代码进行序列化和反序列化时：

```
JsonConvert.SerializeObject(family, Formatting.Indented, new JsonSerializerSettings {
    NullValueHandling = NullValueHandling.Ignore,
    Context = new StreamingContext(StreamingContextStates.All, new JsonLinkedContext()),
});

JsonConvert.DeserializeObject<Family>(File.ReadAllText(@"..\..\Data\Family.json"), new JsonSerializerSettings {
    Context = new StreamingContext(StreamingContextStates.All, new JsonLinkedContext()),
}); 
```

我得到了这个整洁的 JSON：

```
{
  "persons": [
    {
      "name": "mom",
      "pos": {
        "x": 3,
        "y": 7
      },
      "mate": "dad",
      "children": [
        "bro",
        "sis"
      ]
    },
    {
      "name": "dad",
      "pos": {
        "x": 4,
        "y": 8
      },
      "mate": "mom",
      "children": [
        "bro",
        "sis"
      ]
    },
    {
      "name": "bro",
      "pos": {
        "x": 1,
        "y": 5
      }
    },
    {
      "name": "sis",
      "pos": {
        "x": 2,
        "y": 6
      }
    }
  ]
} 
```

我在我的解决方案中不喜欢的是，我必须使用`JObject`，即使从技术上讲它是不必要的。它可能会创建相当多的对象，因此加载会更慢。但看起来这是自定义对象转换器最广泛使用的方法。无论如何，可以用来避免这种情况的方法都是私有的。

# php - 我是否需要使用以下函数在 PHP 中进行字符串转义？

> ID：13108695
> 
> 赞同：1
> 
> 时间：2012-10-28T12:11:46.987
> 
> 标签：php, string, escaping

```
function escape($value){
    $magic_quotes_active = get_magic_quotes_gpc();
    $new_enough_php = function_exists("mysql_real_escape_string");
      if ($new_enough_php) {
        if ($magic_quotes_active) {
            $value = stripslashes($value);
            $value = mysql_real_escape_string($value);
        }
        elseif (!$magic_quotes_active) {
            $value = addslashes($value);
        }
        return $value;
    }
} 
```

很长一段时间我一直在使用上面的函数来转义字符串？现在，我想问我是否需要使用该函数（我发现通过互联网转义适用于大多数 PHP 版本的字符串）？或者它使事情变得不必要地复杂？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T12:20:56.050

不，事实上，你应该不惜一切代价避免使用这些函数！您应该研究的是使用准备好的语句。
检查任何功能的[文档页面](http://www.php.net/mysql_connect)`mysql_*`，并注意红色警告：扩展程序已开始弃用过程，而不是`PDO`建议`mysqli_*`。

为避免注入，您应该使用准备好的语句...阅读有关此事的几篇文章，并了解`PDO`和`mysqli_*`. 那就是，恐怕是唯一的出路……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T12:25:12.353

你不需要这样的功能。通常使用`addslashes(...)`. 在特殊情况下，请参阅文档，如推荐的 @Elias Van Ootegem

# matlab - 如何从另一列中的对应项中减去列中的每个元素？

> ID：13108696
> 
> 赞同：-1
> 
> 时间：2012-10-28T12:12:00.870
> 
> 标签：matlab

我意识到我可以通过循环来做到这一点，但想知道是否有一些更简单的方法来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T12:16:07.080

只是减去它们？

```
>>  foo = round(20*rand(6,2))  # generate a random matrix with 2 columns

foo =                    

    13     9
     6    18
     0    11
    13    14
    17     4
    10     3

>>  foo(:,1) - foo(:,2)         # first column minus second column

ans =

     4
   -12
   -11
    -1
    13
     7 
```

# javascript - 我的 ajax 在 live() 中不起作用

> ID：13108697
> 
> 赞同：1
> 
> 时间：2012-10-28T12:12:02.540
> 
> 标签：javascript, jquery, ajax, live

我的页面中有一个链接，我在它的`onclick()`事件中写了一个 div，其中包含一个名为“datepicker0”的日期输入文本，并且我在这个输入文本下方有一个 div id =“bContent”。

现在我写了下面的脚本，我想在“bContent”中对我的数据应用日期过滤器，但它不起作用！感谢任何帮助，请...

```
$('#datepicker0').live('focus', function() {
    $(this).datepicker().datepicker('show');
    true;
 })
 $('#datepicker0').live('change', function() {
    ShowMathesByDateFilter($(this).val());
 }) 
```

和`ShowMathesByDateFilter()`功能是：

```
function ShowMathesByDateFilter(Fdate)
{

  if (Fdate=="")
  {
  $("#bContent").html('<div class="bContent" dir="rtl"> no result are fond! </div>');
      return;
  }
  else
  {
      $.ajax({
          url:'/includes/GetMtch.php',
          data:"Fdate="+Fdate,
          success: function(data){
              //alert(data);    // this is work 
              $("#bContent").html(data);   //but this line doesn't work.
          }
      })
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:38:26.713

你用的是什么版本的jquery？从 jquery 1.7 开始，live 已贬值：http: [//api.jquery.com/live/](http://api.jquery.com/live/)

尝试使用“on”而不是 live： [http ://api.jquery.com/on/](http://api.jquery.com/on/)

我同意charlietfl 的评论。这条线似乎有问题：

```
$(this).datepicker().datepicker('show'); 
```

# ios - 回合制游戏中心离线时显示游戏状态不正确

> ID：13108698
> 
> 赞同：3
> 
> 时间：2012-10-28T12:12:02.367
> 
> 标签：ios, game-center

我正在使用 iOS 6 Game Center API 进行回合制游戏。

当设备与互联网断开连接时在方法的完成处理程序中

```
[currentMatch endTurnWithNextParticipant:nextParticipant matchData:data completionHandler:^(NSError *error) {
        if (error) {
            NSLog(@"%@", error);

        } else {
            //save the new state of the game
        } 
```

我得到一个错误。但是随后，显示匹配列表的游戏中心标准 UI 显示“轮到他们了”。再次连接时，它变为“轮到你了”。

[http://www.raywenderlich.com/5509/beginning-turn-based-gaming-with-ios-5-part-2](http://www.raywenderlich.com/5509/beginning-turn-based-gaming-with-ios-5-part-2)上著名教程的代码有同样的问题。

我应该如何处理这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T17:09:00.993

如果您使用的是 iOS 6 Game Center API，那么您必须使用

```
-endTurnWithNextParticipants:turnTimeout:matchData:completionHandler: 
```

因为...

```
–endTurnWithNextParticipant:matchData:completionHandler: Deprecated in iOS 6.0 
```

[http://developer.apple.com/library/ios/#documentation/GameKit/Reference/GKTurnBasedMatch_Ref/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/GameKit/Reference/GKTurnBasedMatch_Ref/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-06-07T10:56:58.870

问题是，当您使用改变比赛状态的 GC 方法（`matchData`在这种情况下是同步信息）时，数据会上传到 GC 服务器，以便其他玩家获得更新。如果您断开连接并忽略错误、您的本地`GKTurnBasedMatch`及其`matchData`更改，以及您的同步信息（用于确定是否轮到您采取其他措施）。

但是，由于您是断开连接的，因此只有您的本地实例`GCTurnBasedMatch`被更新（您会收到错误，以便您的应用程序知道这一点）。当您重新连接时，您的应用程序会对用户进行身份验证并更新匹配状态（如果您遵循教程代码）。更新比赛数据会恢复同步数据（所以现在轮到你了）。

此时，您应该再次提交轮次（前提是您缓存`gameData`了在断开连接时传递给 GC 的内容）和/或调用`updateMatchData`，以便您的本地`GKTurnBasedMatch`及其`matchData`与服务器上的内容同步。如果您在重新连接后没有重新提交回合，您还应该使用前一回合的数据重新布局您的游戏板。

# jquery - 需要获取相邻复选框的值

> ID：13108700
> 
> 赞同：1
> 
> 时间：2012-10-28T12:12:04.543
> 
> 标签：jquery, checkbox, each

我单击复选框，然后我应该查看行上的所有复选框，选中与否（3 个复选框）。

![在此处输入图像描述](../Images/d25a0f9d8e52960021ebf0eaeae53152.png) 当我点击复选框时`update_order_status(this);`

```
function update_order_status(e){
    var order_id = $(e).parents('tr').find('.order_id').html();
    var status_id = $(e).parents('tr').find('.status_id').val();

    $(e).parents('tr').find('input').each(function(i){
        //watch all input on the page, but not row
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T12:27:16.923

使用最接近的方法。在您的复选框方法中

```
function yourMethod(e){
  $(e).closest("tr").find(':checkbox').each(function(e2){
    // code
  });
} 
```

最近的方法选择树上最接近的dom元素并在找到它时停止，因此它将仅选择父tr。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T12:23:03.317

您必须在第一行调用复选框父母，并使用它来代替 e：

```
$(':checkbox').click(function(e){
    $(this).parents("tr:first").find(':checkbox').each(function(e2){
         //Required logic here
    });
}); 
```

# c# - openAuth注册后创建本地登录

> ID：13108702
> 
> 赞同：0
> 
> 时间：2012-10-28T12:12:25.237
> 
> 标签：c#, asp.net-mvc-3, asp.net-mvc-4

我创建了一个 MVC4 应用程序并实现了 OpenAuth 登录。当用户决定使用外部帐户登录/注册时。例如谷歌用户被带到谷歌登录。成功登录后，应用程序会要求用户注册返回的电子邮件。

现在，当我尝试使用本地电子邮件地址登录时，它会失败。有没有一种方法，当用户使用 Google 成功登录时，应用程序也会创建一个本地用户帐户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T13:14:54.093

我发现已经有功能可以做到这一点。Account 控制器的 Manage 操作允许创建本地帐户。CreateAccount() 方法假定用户存在于 UserProfile 中并为该用户名创建一个会员帐户

# google-chrome - Chrome 应用创建

> ID：13108703
> 
> 赞同：2
> 
> 时间：2012-10-28T12:12:28.967
> 
> 标签：google-chrome

这是我的 manifest.json

```
{
    "name" : "www.mysite.com",
    "version" : "1.0",
    "manifest_version" : 1,
    "description" : "Stay Updated with the latest post from www.mysite.com",
    "icons" : {
        "128" : "icon_128.png"
    },

    "browser_action" : {
        "default_icon" : "icon_19.png",
        "popup" : "mysite.html"
    }

} 
```

正在工作..但我升级到清单 2 后不工作..

```
{
    "name" : "www.mysite.com",
    "version" : "1.0",
    "manifest_version" : 2,
    "description" : "Stay Updated with the latest post from www.mysite.com",
    "icons" : {
        "128" : "icon_128.png"
    },

    "browser_action" : {
        "default_icon" : "icon_19.png",
        "popup" : "mysite.html"
    }

} 
```

你能告诉我如何解决这个问题吗？

# macos - 在 Mac 上从 java 7 降级到 java 6

> ID：13108705
> 
> 赞同：2
> 
> 时间：2012-10-28T12:12:43.740
> 
> 标签：macos, java-7, java-6

有人能告诉我在哪里可以找到 java jdk 6 吗？

我需要从 7 降级，因为我的 mac 上的 java-7 有一些问题。我从 oracle 安装了 jdk 7。

有对mac的支持，但没有低于jdk7的支持。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T18:20:26.297

这可能是您正在寻找的。[http://support.apple.com/kb/HT5559?viewlocale=en_US](http://support.apple.com/kb/HT5559?viewlocale=en_US)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T12:15:38.677

您可以使用“Java Preferences”将较旧的 jdk 6 设置为您的默认 JDK。使用“spotlight”找到 Java Preferences 面板。

# java - 如何限制通过浏览器访问 Servlet

> ID：13108706
> 
> 赞同：1
> 
> 时间：2012-10-28T12:12:47.533
> 
> 标签：java, html, jsp, tomcat, servlets

我正在使用以下 jquery 代码在 DIV 中加载 Servlet。

```
$.get('Test',function(responseText){
      $("#test").html(responseText);
}); 
```

从这个 Servlet 带来的元素将使用包含在这个网页中的 css 文件。

但是如果我在浏览器中输入 ..../myProject/Test

它将显示这个 Servlet 想要显示的内容，但是如果没有 css 文件，它看起来会很糟糕。

如何限制某人通过浏览器访问此 Servlet？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T12:17:02.227

首先，当您使用 AJAX 获取某些内容时，您**是**通过浏览器访问它。

您可以在 AJAX 调用中设置一些特殊的 HTTP 标头，但无论如何它都不安全。但是，在服务器端，您可以识别此特殊标头，如果不存在，则拒绝或返回一些不同的内容。

# javascript - 如何使用 CSS 和/或 Javascript 实现这种效果（换行符）

> ID：13108708
> 
> 赞同：0
> 
> 时间：2012-10-28T12:13:41.370
> 
> 标签：javascript, html, css, newline

现在我正在使用多个标题标签和一个 css 类来实现下图所示的效果，有没有办法通过只使用一个标题/行和 css 来实现这一点？

当前代码：

```
<h2 class="heading">Hi guys, How can i achieve this effect using just a single</h2>
<div class="clearfix"></div>
<h2 class="heading">line of text and css. Right now i am using</h2>
<h2 class="heading">multiple &lt;h2&gt; tags and a css class to achieve this effect.</h2>
<h2 class="heading">Is it possible to achieve this only with css or do i have to use Javascript as well?</h2> 
```

预期代码

```
<h2 class="heading">Hi guys, How can i achieve this effect using just a single line of text and css. Right now i am using multiple &lt;h2&gt; tags and a css class to achieve this effect. Is it possible to achieve this only with css or do i have to use Javascript as well?</h2> 
```

在我看来，这个的主要问题是，如果不减小我不想要的字体大小、填充等，我就无法让它响应。

即使我让它具有响应性，我也无法在不使用其他标签或 JavaScript 的情况下在任何我想要的地方添加换行符。

你们是如何解决这个问题的？

![如何使用单个标题/任何标签和 css 实现此效果](../Images/990f2e00596842309bab52804b26e1fc.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T12:20:55.160

一，大量的解决方案

```
<h2 class="heading">
    <span>Hi guys, How can i achieve this effect using just a single</span>
    <span>line of text and css. Right now i am using</span>
    <span>multiple &lt;h2&gt; tags and a css class to achieve this effect.</span>
    <span>Is it possible to achieve this only with css or do i have to use Javascript as well?</span>
    <span class="clear"></span>
</h2> 
```

有了这种风格`<head>`

```
<style type="text/css">
    h2.heading {
        background:#0f0;
        padding:2px;
        float:left;
    }

    h2.heading span {
        clear:left;
        display:block;
        float:left;
        background:#fff;
        padding:1px;
        margin:1px;
    }

    h2.heading .clear {
        clear:left;
        margin:0px;
        padding:0px;
        float:none;
    }
</style> 
```

编辑：第二个变种

```
<style type="text/css">
    h2.heading {
        background:#0f0;
        padding:2px;
        display:inline-block;
        font-size:20px;
    }

    h2.heading span {
        background:#fff;
        padding:1px;
        margin:1px;
        line-height:30px;
    }
</style> 
```

用这个标记

```
<div style="width:300px;">
    <h2 class="heading">
        <span>Hi guys, How can i achieve this effect using just a single line of text and css. Right now i am using multiple &lt;h2&gt; tags and a css class to achieve this effect. Is it possible to achieve this only with css or do i have to use Javascript as well?</span>
    </h2>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T12:19:14.077

不需要 CSS 或 JavaScript，只需使用`<br>`标签。

```
<h2 class="heading">
Hi guys, How can i achieve this effect using just a single
<br> 
line of text and css. Right now i am using 
<br>
multiple &lt;h2&gt; tags and a css class to achieve this effect.
<br>
Is it possible to achieve this only with css or do i have to use Javascript as well?
</h2> 
```

还是我误解了这个问题？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T12:32:25.537

我有点解决了这个问题。看看这里[http://jsfiddle.net/7nafE/](http://jsfiddle.net/7nafE/)（删除 div 以查看响应）

HTML：

```
<span class="heading">Hi guys, How can i achieve this effect using just a single line of text and css. Right now i am using multiple &lt;h2&gt; tags and a css class to achieve this effect. Is it possible to achieve this only with css or do i have to use Javascript as well?</h2> 
```

与您的 HTML 相同，只是我使用 span 而不是 h2

和CSS：

```
.heading {
        background: white;
        line-height:2em;
        padding: 0.3em;;
    }

    body { /*not really neccessary to show, but anyway*/
        background: limegreen;
        font-family: verdana;
        color: #999999} 
```

问题在于文本的左右两侧没有填充。并且。你不能在你想要的地方换行。这完全取决于您将其放置在哪个容器中。如果您问我，这很好，因为这使它以某种方式做出响应`<br />`或类似的事情不会做。

# delphi - 为 TStringGrid 启用编辑

> ID：13108710
> 
> 赞同：3
> 
> 时间：2012-10-28T12:14:06.953
> 
> 标签：delphi, delphi-xe3

我正在按照这个[视频](http://www.youtube.com/watch?feature=player_detailpage&v=416qL6is5Xw#t=204s)制作一个简单的数据库应用程序。当我使用 a`TStringGrid`而不是`TGrid`视频中所述的 a 时会出现我的问题，因为我没有它。我有一个导航器，我的所有数据都加载到了 中`TStringGrid`，但我根本无法编辑它。到目前为止，我已经尝试双击一个条目，按 F2 并单击导航器上的编辑按钮，但没有任何效果。

我需要在属性中进行任何更改`TStringGrid`以允许编辑还是仅用于显示数据？

提前谢谢你！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T12:30:32.970

您需要添加`goEditing`到`Options`属性。将其包含在 Object Inspector 或代码中：

```
StringGrid1.Options := StringGrid1.Options + [goEditing]; 
```

# actionscript-3 - Adobe air 还是 flex？

> ID：13108717
> 
> 赞同：2
> 
> 时间：2012-10-28T12:15:46.967
> 
> 标签：actionscript-3, apache-flex, air, adobe

我从我的第一个应用程序开发开始。到目前为止，我只使用过 Html、css、js、jquery 等。

我想创建一个像桌面 gmail 通知程序这样的应用程序，它定期 ping 服务器，查找任何消息并通知用户。我读到 Adob​​e Air 和 flex 是可以用于此的工具。我通过学习net中的教程在adobe air中开发了基本原型。

但问题是，我的客户不希望将源代码提供给用户。使用 air，您可以在安装/解压 .air 应用程序后看到完整的源代码。

有什么办法可以保护源代码吗？或者我应该使用 flex 并将其转换为 swf？源代码是否在 flex 中受到保护？我不熟悉 Flash 动作脚本。请指教。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T16:18:54.000

我认为您对 Flex 是什么感到困惑。它是一个低于 AIR 和 Flash SDK 级别的 SDK。Flex 是一种二级结构语言，旨在与 AS3 结合使用，而 AIR 是编译型语言。

不管你如何编译它，如果有人真的想得到它，源代码是可以获得的。如果您编译为 AIR 应用程序，则可以解压缩并获取 SWF 文件。如果您编译为 SWF，则您已经拥有该 SWF。然后可以使用各种工具对 SWF 进行反编译。

没有真正的方法可以隐藏前端代码以防窥探。Flash 绝对比 HTML 或 CSS 或 Javascript 更难阅读，但无论您如何编译，都绝对不是不可能查看的。您最好的选择肯定是尽可能多地卸载到服务器并可能混淆您的代码。

我肯定会尝试向您的客户解释，根本不可能对想要访问它的个人真正隐藏源代码。如果有人真的想窃取代码，他们可以而且愿意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T12:47:34.330

代码不能隐藏在任何前端技术、Flash（SWF、Flex 或 AIR）或 HTML (JavaScript) 中。在服务器上执行所有业务逻辑并正确验证以保护您的数据。

AIR 和 Flash Player 都是运行用 Adob​​e Flash 或 Apache Flex 编写的应用程序的运行时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T12:27:39.877

您可以使用客户端-服务器实现向用户隐藏逻辑，而 flex 只会根据与 gmail 服务器交互的服务器端代码（php、java 或 .NET）的业务逻辑呈现 UI

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-29T20:02:21.297

如果您想要适当的通知，请使用 AIR - 访问某些系统级功能，例如[toast 通知](http://www.adobe.com/devnet/air/flex/quickstart/articles/creating_toast-style_windows.html)。使用 Flex，您将仅限于网页内容。
关于代码保护 - 您可以在 ActionScript 中开发应用程序，然后使用混淆器保护已编译的 SWF 以进行一些公平的防御，尽管可能没有好的免费混淆器。[我为secureSWF](http://www.kindi.com/)许可证支付了一些钱，并认为这是一项不错的投资。当然，坚定的黑客无论如何都会破解应用程序（理论上），但对于一个简单的 pinger 应用程序，我不会太担心这一点。

# mysql - SQL group by 和 order by issue

> ID：13108719
> 
> 赞同：0
> 
> 时间：2012-10-28T12:15:59.307
> 
> 标签：mysql, sql

假设我有一个表 - 任务 - 包含以下数据：

```
task    user     when_added
---------------------------
run     1        2012-08-09
walk    2        2012-08-07
bike    2        2012-08-07
car     1        2012-08-06
run     2        2012-08-06
car     1        2012-08-05
bike    1        2012-08-04
run     1        2012-08-04 
```

如您所见，任务是重复的。

问题是，当我显示数据时，例如

```
select * from tasks group by task order by when_added desc 
```

小组如何通过影响结果？'group by' 是否按任何顺序对它们进行分组，我可以做到吗？

我问的原因是我有一个大表，我在上面显示数据，如果我丢失了 group by 并且只按日期顺序显示结果，我会得到一些没有显示在 group by 上的结果，这意味着任务已经完成以前做过，但它似乎是按最旧的日期分组的，我希望最新的日期在堆的顶部。

希望这是有道理的...是否可以按顺序影响组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:18:58.953

那是你要的吗？

```
select task, group_concat(user), max(when_added)
from tasks 
group by task
order by when_added desc 
```

`group by`是一个聚合函数。在 MySQL 中，您无论如何都可以选择不聚合列，但您不应该这样做。

如果按列分组，则该列的结果将是不同的，所有其他数据将围绕它进行分组。因此，例如，可能有多个数据在`task`哪里`run`。只需选择其他列将选择随机结果。您应该从该组中选择一个特定的结果，例如`max`或`min`或`sum`或连接它们。

# ubuntu - 如何将 Java Hotspot Server VM 设置为客户端模式？

> ID：13108723
> 
> 赞同：0
> 
> 时间：2012-10-28T12:16:39.090
> 
> 标签：ubuntu, jvm, java, jvm-hotspot

[我读过](https://stackoverflow.com/a/3669855/841064)最好在 64 位 Ubuntu 上使用 32 位 JDK，所以我安装`jdk-7u9-linux-i586.tar.gz`在那里`libc6-i386`。当我运行时`java -version`，会打印以下信息：

```
java version "1.7.0_09"
Java(TM) SE Runtime Environment (build 1.7.0_09-b05)
Java HotSpot(TM) Server VM (build 23.5-b02, mixed mode) 
```

[我还读到](http://www.oracle.com/technetwork/java/hotspotfaq-138619.html#compiler_types)客户端 VM 在开发计算机上比服务器 VM 好。如何将热点设置为客户端模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T12:57:55.847

这在 2 年前可能是正确的，但是 64 位 HotSpot 现在在开发和生产中都可以正常工作，并且当您不使用大于 24 GB 的堆时，它具有自动指针压缩功能。

至于 JIT 模式，您选择带有 -server 的服务器 VM（现在大多数机器上的默认设置），以及带有 -client 的客户端 VM。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T12:55:40.053

如果有什么可以工作的，它将将该`-client`选项添加到`java`命令行。

但是，根据[此页面](http://docs.oracle.com/javase/7/docs/technotes/guides/vm/server-class.html)，客户端 VM 不适用于某些平台……因此您可能会发现这`-client`不被接受。（页面的措辞并没有完全清楚是硬件的指令集还是JDK / JRE的指令集是关键的......）

* * *

> 我还读到客户端 VM 在开发计算机上比服务器 VM 好。

我认为这取决于您是否使用 IDE，和/或构建的大小。对于长构建和长 IDE 会话，我希望服务器 VM 会更好。

# java - 具有嵌套泛型的不可转换类型

> ID：13108724
> 
> 赞同：2
> 
> 时间：2012-10-28T12:16:59.060
> 
> 标签：java, nested-generics

我查看了我仍然感到困惑的其他类型转换 Java 泛型问题。

我有以下类层次结构：（`WeightedThing<T>`只是为某些随机类型添加权重）和一个自定义`Vector`类`WeightedVector`（不，`WeightedVector`不仅仅是`WeightedThing<Vector>`）是子类。

我想做最近邻搜索并将最近向量列表返回给给定查询向量及其距离。为此，我定义了一个`search`方法：

```
public List<WeightedThing<? extends Vector>> search(Vector, int limit) {...} 
```

希望我能做到

```
List<WeightedThing<WeightedVector>> neighbors = (List<WeightedThing<WeightedVector>>)search(query, 1); 
```

这不起作用（IntelliJ 不会将其标记为错误，但使用 Sun 的 Mac OS X 的 jdk7u10 编译它会失败）。也不用 . 调用相同的函数`Vector`。我可以通过添加向上转换来强制它编译`Object`，但这看起来很可怕。

这样做的目的是我可以搜索和添加任何类型的向量，但如果我知道我只添加了 WeightedVectors，我想将结果转换回 WeightedVectors。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T13:31:03.597

通常，在方法的返回类型中使用通配符类型不是一个好习惯。您为什么不尝试更改方法签名，如下所示：

```
public <T extends Vector> List<WeightedThing<T>> search(T vector, int limit) {...} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T12:18:22.653

列表`WeightedThing<? extends Vector>`与 列表不同`WeightedThing<WeightedVector>`。要进行类型转换，它将转换为野生字符类型，`any collection`然后转换为特定类型。

```
 List<WeightedThing<WeightedVector>> neighbors = (List<WeightedThing<WeightedVector>>)
                                                (List<?>)search(query, 1); 
```

# java - 如何将 xml 节点（作为字符串）附加到现有的 XML 元素节点（仅使用 java 内置）？

> ID：13108726
> 
> 赞同：5
> 
> 时间：2012-10-28T12:17:02.353
> 
> 标签：java, rhino

（免责声明：在 RingoJS 中使用 Rhino）

假设我有一个带有元素的文档，我看不到如何将节点作为字符串附加到该元素。为了将字符串解析为 xml 节点，然后将它们附加到节点，我尝试使用 documentFragment，但我无处可去。简而言之，我需要像 .NET 的 .innerXML 一样简单的东西，但它不在 java api 中。

```
var dbFactory = javax.xml.parsers.DocumentBuilderFactory.newInstance();
var dBuilder = dbFactory.newDocumentBuilder();
var doc = dBuilder.newDocument();
var el = doc.createElement('test');
var nodesToAppend = '<foo bar="1">Hi <baz>there</baz></foo>';
el.appendChild(???); 
```

如何在不使用任何第三方库的情况下做到这一点？

[编辑] 在示例中并不明显，但我不应该知道变量“nodesToAppend”的内容。因此，请不要向我指出有关如何在 xml 文档中创建元素的教程。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-28T16:53:31.513

您可以在 java 中执行此操作 - 您应该能够派生 Rhino 等价物：

```
DocumentBuilderFactory dbFactory = javax.xml.parsers.DocumentBuilderFactory.newInstance();
DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
Document doc = dBuilder.newDocument();
Element el = doc.createElement('test');
doc.appendChild(el);

String xml = "<foo bar=\"1\">Hi <baz>there</baz></foo>";
Document doc2 = builder.parse(new ByteArrayInputStream(xml.getBytes()));

Node node = doc.importNode(doc2.getDocumentElement(), true);
el.appendChild(node); 
```

因为`doc`和`doc2`是两个不同`Document`的 s，所以技巧是将节点从一个文档导入到另一个文档，这是通过`importNode`上面的 api完成的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:12:54.610

我认为您的问题就像这个问题，并且有答案： [Java：如何读取和写入 xml 文件？](https://stackoverflow.com/questions/7373567/java-how-to-read-and-write-xml-files)

或查看此链接[http://www.mkyong.com/java/how-to-create-xml-file-in-java-dom/](http://www.mkyong.com/java/how-to-create-xml-file-in-java-dom/)

# wordpress - 用户通过 WordPress 中的帖子将图像添加到幻灯片

> ID：13108727
> 
> 赞同：0
> 
> 时间：2012-10-28T12:17:06.300
> 
> 标签：wordpress

由于 Stackexchange 的 WordPress 论坛几乎无人问津，我想我会在这里问同样的问题，因为这是我经常发帖的地方。

**原帖：** [https ://wordpress.stackexchange.com/questions/70742/users-adding-images-to-a-slideshow-through-posts](https://wordpress.stackexchange.com/questions/70742/users-adding-images-to-a-slideshow-through-posts)

我对一个页面感到困惑，我希望用户能够在其中创建自己的帖子——为此我使用插件[WP User Frontend](http://wordpress.org/extend/plugins/wp-user-frontend/)。

每个帖子都包含各种文本字段，包括描述、位置、联系信息，最后是一张特色图片（缩略图）。

现在，我想添加一个功能，使我的用户可以将最多五张自选图片添加到幻灯片中——用户发布的每个帖子都应该包含一个幻灯片。我该怎么做？

如果我可以让 WP User Frontend 与现有的幻灯片插件（例如[Meteor Slides](http://wordpress.org/extend/plugins/meteor-slides/)或[Slideshow](http://wordpress.org/extend/plugins/slideshow-jquery-image-gallery/)？）一起工作，我认为它可以工作吗？也许通过自定义 PHP 语句？

我已经尝试这样做好几天了。现在我转向你，希望最终解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T04:07:46.547

为了在外部上传图片，将这些代码粘贴到您的functions.php中

```
function uploadImage($new_post){
 $inc = 1;    
 if ($_FILES) {
   foreach ($_FILES as $file => $array) {          
      $newupload = insert_attachment($file,$new_post);
      // $newupload returns the attachment id of the file that
      // was just uploaded. Do whatever you want with that now.
      $inc++;
   }
 }

}

function insert_attachment($file_handler,$post_id) {

 // check to make sure its a successful upload
 if ($_FILES[$file_handler]['error'] !== UPLOAD_ERR_OK) return false;

require_once(ABSPATH . "wp-admin" . '/includes/image.php');
require_once(ABSPATH . "wp-admin" . '/includes/file.php');
require_once(ABSPATH . "wp-admin" . '/includes/media.php');

$attach_id = media_handle_upload( $file_handler, $post_id );  
} 
```

并使用您的新帖子 ID 在您的模板中调用 uploadimage 函数

```
uploadImage($the_post_id); 
```

只需输入五个上传输入表单，它会自动被函数读取

# java - 将 Smooks CSV 文件转换为 JAVA，我没有找到以下类别加载器：au.com.bytecode.opencsv.CSVReader

> ID：13108734
> 
> 赞同：0
> 
> 时间：2012-10-28T12:18:22.687
> 
> 标签：java, https, io, richfaces, smooks

现在我使用 smooks 将 csv 文件转换为 java 所以我得到了 Exception No ClassLoaders found for: au.com.bytecode.opencsv.CSVReader ,

我得到异常是

```
 15:03:41,263 ERROR [STDERR] org.milyn.SmooksException: Smooks Filtering operation failed.
15:03:41,264 ERROR [STDERR]     at org.milyn.Smooks._filter(Smooks.java:538)
15:03:41,264 ERROR [STDERR]     at org.milyn.Smooks.filterSource(Smooks.java:475)
15:03:41,264 ERROR [STDERR]     at com.manam.mobee.migrationCustomerManagement.MigrationCustomerHome.runSmooksTransform(MigrationCustomerHome.java:76)
15:03:41,264 ERROR [STDERR]     at com.manam.mobee.migrationCustomerManagement.MigrationCustomerHome.displyTempCustomers(MigrationCustomerHome.java:115)
15:03:41,264 ERROR [STDERR]     at com.manam.mobee.migrationCustomerManagement.MigrationCustomerHome.listener(MigrationCustomerHome.java:144)
Caused by: java.lang.NoClassDefFoundError: au/com/bytecode/opencsv/CSVReader
15:03:41,268 ERROR [STDERR]     at org.milyn.csv.CSVReader.parse(CSVReader.java:314)
15:03:41,268 ERROR [STDERR]     at org.milyn.delivery.sax.SAXParser.parse(SAXParser.java:70)
15:03:41,268 ERROR [STDERR]     at org.milyn.delivery.sax.SmooksSAXFilter.doFilter(SmooksSAXFilter.java:75)
15:03:41,268 ERROR [STDERR]     at org.milyn.delivery.sax.SmooksSAXFilter.doFilter(SmooksSAXFilter.java:61)
15:03:41,268 ERROR [STDERR]     at org.milyn.Smooks._filter(Smooks.java:516)
15:03:41,269 ERROR [STDERR]     ... 92 more
15:03:41,269 ERROR [STDERR] Caused by: java.lang.ClassNotFoundException: No ClassLoaders found for: au.com.bytecode.opencsv.CSVReader
15:03:41,269 ERROR [STDERR]     at org.jboss.mx.loading.LoadMgr3.beginLoadTask(LoadMgr3.java:306)
15:03:41,269 ERROR [STDERR]     at org.jboss.mx.loading.RepositoryClassLoader.loadClassImpl(RepositoryClassLoader.java:521)
15:03:41,269 ERROR [STDERR]     at org.jboss.mx.loading.RepositoryClassLoader.loadClass(RepositoryClassLoader.java:415)
15:03:41,269 ERROR [STDERR]     at java.lang.ClassLoader.loadClass(Unknown Source)
15:03:41,269 ERROR [STDERR]     ... 97 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T12:22:33.130

可能您的类路径中缺少 opencsv-XX.jar（XX 代表 opencsv 版本，例如：1.6 或 1.7）。或者它不在您的容器看到它的正确位置（检查 WEB-INF/lib）。

# ruby - 带有 gsub 的 Ruby 1.9.3 正则表达式：错误还是特性？

> ID：13108737
> 
> 赞同：0
> 
> 时间：2012-10-28T12:18:53.913
> 
> 标签：ruby, regex, gsub

使用这段代码，它应该用它的 URL 替换一个 href 标记：

```
irb> s='<p><a href="http://localhost/activate/57f7e805827f" style="color:#F19300;font-weight:bold">Click here!</a></p>'
irb> s.gsub(/<a href="([^ '"]*)"([^>]*)?>([^<]*)<\/a>/, "#{$1}")
=> "<p></p>" 
```

此正则表达式失败（未找到 URL）。然后我转义`<`正则表达式中的字符，它可以工作：

```
irb> s.gsub(/<a href="([^ '"]*)"([^>]*)?>([^\<]*)<\/a>/, "#{$1}")
=> "<p>http://localhost/activate/57f7e805827f</p>" 
```

**1：**根据RubyMine的检查，这种逃逸应该是没有必要的。它是否正确？如果是这样，为什么`>`显然也没有必要逃脱？

**2：**之后在同一个 IRB 会话中，使用相同的字符串，原来的正则表达式突然也起作用了：

```
irb> s.gsub(/<a href="([^ '"]*)"([^>]*)?>([^<]*)<\/a>/, "#{$1}")
=> "<p>http://localhost/activate/57f7e805827f</p>" 
```

这是因为再次`$1`调用时变量没有清除吗？`gsub`如果是这样，是故意行为还是 Ruby 正则表达式错误？

**3：**当我更改字符串并重新执行相同的命令时，`$1`只会在更改后`gsub`的字符串上调用两次后更改：

```
irb> s='<p><a href="http://localhost/activate/xxxxyyy" style="color:#F19300;font-weight:bold">Click here!</a></p>'
=> "<p><a href=\"http://localhost/activate/xxxxyyy\" style=\"color:#F19300;font-weight:bold\">Click here!</a></p>"
irb> s.gsub(/<a href="([^ '"]*)"([^>]*)?>([^\<]*)<\/a>/, "#{$1}")
=> "<p>http://localhost/activate/57f7e805827f</p>"
irb> s.gsub(/<a href="([^ '"]*)"([^>]*)?>([^\<]*)<\/a>/, "#{$1}")
=> "<p>http://localhost/activate/xxxxyyy</p>" 
```

这是故意的吗？如果是这样，这背后的逻辑是什么？

**4：**作为替换字符，有的教程建议使用`"#{$n}"`，有的建议使用`'\n'`。使用反斜杠变体，不会出现上述问题。为什么-两者之间有什么区别？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T12:54:04.960

`$1`包含最后一场比赛的第一次捕获。在您的示例中，它在匹配*之前*进行评估（实际上甚至在`gsub`调用之前），因此值`$1`固定为`nil`（因为您还没有匹配任何内容）。所以你总是能第一次捕捉到*上*一场比赛，你甚至不需要改变你原来的正则表达式来第二次得到预期的结果：

```
s='<p><a href="http://localhost/activate/57f7e805827f" style="color:#F19300;font-weight:bold">Click here!</a></p>'

s.gsub(/<a href="([^ '"]*)"([^>]*)?>([^<]*)<\/a>/, "#{$1}")
# => "<p></p>"

s.gsub(/<a href="([^ '"]*)"([^>]*)?>([^<]*)<\/a>/, "#{$1}")
# => "<p>http://localhost/activate/57f7e805827f</p>" 
```

您可以将一个块传递给`gsub`虽然，它在匹配*后进行评估，例如*

```
s.gsub(/<a href="([^ '"]*)"([^>]*)?>([^<]*)<\/a>/){ $1 }
# => "<p>http://localhost/activate/57f7e805827f</p>" 
```

这样，`$1`行为就如你所料。我喜欢总是使用命名的捕获，所以当我添加捕获时我不必跟踪数字，但是：

```
s.gsub(/<a href="(?<href>([^ '"]*))"([^>]*)?>([^<]*)<\/a>/){ $~[:href] }
# => "<p>http://localhost/activate/57f7e805827f</p>" 
```

# delphi - 如何将扫描的图像从 WIA ImageFile 传输到 TBitmap 而不将其保存到磁盘？

> ID：13108742
> 
> 赞同：3
> 
> 时间：2012-10-28T12:19:36.080
> 
> 标签：delphi, delphi-xe2, wia

我正在使用此代码从 WIA 获取扫描图像：

```
const
  wiaFormatJPEG = '{B96B3CAE-0728-11D3-9D7B-0000F81EF32E}';
  wiaFormatPNG = '{B96B3CAF-0728-11D3-9D7B-0000F81EF32E}';
var
  CommonDialog: ICommonDialog;
  AImage: IImageFile;
  i: Integer;
begin
  CommonDialog := CreateOleObject('WIA.CommonDialog') as ICommonDialog;

  for i := 1 to Scanner.Properties.Count do
  begin
    if (Scanner.Properties[i].Name = 'Horizontal Resolution') or
      (Scanner.Properties[i].Name = 'Vertical Resolution') then
      Scanner.Properties[i].Set_Value(72)
    else if Scanner.Properties[i].Name = 'Horizontal Extent' then
      Scanner.Properties[i].Set_Value(Round(8.27 * 72))
    else if Scanner.Properties[i].Name = 'Vertical Extent' then
      Scanner.Properties[i].Set_Value(Round(11.00 * 72));
  end;
  AImage := IUnknown(CommonDialog.ShowTransfer(Scanner, wiaFormatPNG, True)) as IImageFile;
  //Save the image
  AImage.SaveFile('D:\1.' + AImage.FileExtension);
  imgImage.Picture.LoadFromFile('D:\1.' + AImage.FileExtension);
  DeleteFile('D:\1.' + AImage.FileExtension);
end; 
```

`Scanner`使用以下代码初始化：

```
Scanner := DevMgr.DeviceInfos[Integer(cbWIASource.Items.Objects[cbWIASource.ItemIndex])].Connect.Items[1]; 
```

并使用以下代码进行初始化`DevMgr`：`cbWIASource`

```
DevMgr := CreateOleObject('WIA.DeviceManager') as IDeviceManager;
for i := 1 to DevMgr.DeviceInfos.Count do
    for j := 1 to DevMgr.DeviceInfos[i].Properties.Count do
      if DevMgr.DeviceInfos[i].Properties[j].Name = 'Name' then
      begin
        cbWIASource.Items.AddObject(DevMgr.DeviceInfos[i].Properties[j].Get_Value, TObject(i));
        Break;
      end; 
```

我想知道是否有一种方法可以在不先将其保存到磁盘的情况下复制扫描的文档。我在 MSDN 上读到我可以访问`ARGBData`成员`ImageFile`以访问像素数据，但是有没有一种简单的方法可以将整个图像从复制`FileData`到`TBitmap`？例如，我可以使用`TMemoryStream`?

* * *

作为更新，我在 MSDN 上找到[了这个示例。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms630826%28v=vs.85%29.aspx#SharedSample001)我对 VB 一无所知，但我猜这个`Picture`对象是`HBITMAP`. 那么，得出该`ImageFile.Picture`房产是我需要的结论是否合乎逻辑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T22:38:23.283

IImageFile 具有 FileData 属性，通过[IVector.BinaryData提供对二进制图像数据的访问](http://msdn.microsoft.com/en-us/library/windows/desktop/ms630518%28v=vs.85%29.aspx)

# iphone - 媒体查询 css 总是显示水平滚动条

> ID：13108744
> 
> 赞同：1
> 
> 时间：2012-10-28T12:19:47.577
> 
> 标签：iphone

我的网站是：alwaysriding.co.uk

我已更新并使用媒体查询使其在智能手机上显示得更好，但我遇到了一些问题`zoom in`，`zoom out`.

当您使用智能手机访问我的网站时，您会看到水平滚动条，虽然我已经修复了`width = 480px`.

如果您调整浏览器窗口的大小，您可以看到我的 css。

提前致谢。

楚

# jquery - 模糊整个 除了最后一句话

> ID：13108749
> 
> 赞同：0
> 
> 时间：2012-10-28T12:20:43.007
> 
> 标签：jquery, css, node.js, socket.io, dust.js

我有一个 socket.IO 应用程序，它也将数据保存到 MongoDB。

我正在尝试找到一种方法来模糊除最后一个单词之外的整个句子。

行将在哪里的代码：

```
{#storylines}
<li>{text}</li>
{/storylines}

<input id="newstoryline" name="newstoryline" class="StoryBoard" type="text" placeholder="" onKeyDown="countChars()" onKeyUp="countChars()"/> 
```

套接字.IO：

```
socket.on('updatechat', function (username, data) {
  $('#newstoryline').before('<li>' + data + '</li>');
}); 
```

应用程序还将向模板发送 {maxlines} 将包括剩余的行数。基本上我正在寻找一种说法：

如果 {maxlines} > 0 则模糊除最后一个单词之外的“数据”。

因此，如果来自服务器的消息是“你好，我的名字是 Jim！” 我想成为“**** * *** ** Jim！”所以用户只能看到单词 Jim！*

 *我正在使用 Node.JS/Mongoose/Socket.IO

我是否必须在客户端实现某种 javascript 函数来检查 {maxlines} > 0 是否然后将模糊效果应用于线条，或者我会在服务器端做些什么？

目前这是服务器发送信息的方式：

```
app.get('/s/:id', function(req, res){
    Story.findOne({ sid: req.params.id }, function(err, story){
            if (err) {
            res.redirect('/')
        }
        else if(story == null) {
            res.redirect('/')
        }
        else{
    res.render('story', {
        title: 'Storifi',
        storytitle: story.title,
        storylines: story.lines,
        lines: story.maxlines,
        storyid: story.sid
            maxlines: story.maxlines   

                });
            }
        });
}); 
```

Socket.IO（服务器端）：

```
socket.on('sendchat', function (data) {
    // we tell the client to execute 'updatechat' with 2 parameters
    io.sockets.in(socket.room).emit('updatechat', socket.username, data); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:49:56.117

我同意利克斯。用 span 标签包裹您希望模糊的部分，并使用 css 将样式应用于该标签。

```
socket.on('updatechat', function (username, data) {
    var dataSplit= data.split(' ');
    var lastWord =   dataSplit.pop();
    var toBlur=  '<span class="blur">' + dataSplit.join(' ') +  '</span>'; 

     $('#newstoryline').before('<li>' + toBlur + lastWord + '</li>');
}); 
```

--------------------css-------------- ---

```
.blur{
   color: transparent;  
   text-shadow: 0 0 5px #000;  
} 
```*

# python - 我是否需要在其他模块中重新导入模块

> ID：13108758
> 
> 赞同：3
> 
> 时间：2012-10-28T12:22:36.863
> 
> 标签：python, module

正如标题所说，我是否需要在导入到主文件的模块中重新导入模块？在这方面找不到任何东西，也不确定要搜索什么。因为这在我导入其他史诗之前不起作用

文件1：

```
import epicness
import otherepic

epicness.someother(3) 
```

史诗：

```
def someother(x):
    return dosomething(x) 
```

其他：

```
def dosomething(x):
    return x*4 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T13:10:15.463

是的，你必须在每个模块中导入你需要的一切。如果使用 in 中定义`module_a`的函数，则必须 import inside ，或者至少导入函数 from 。`B``module_b``module_b``module_a``B``module_b`

解释：

在 Python 中，模块是对象！当您导入一个模块时，它的代码将被执行，并且在那里定义的所有内容都附加到模块对象的`__dict__`：

```
$ echo 'a=1' > testing.py
$ python
Python 2.7.3 (default, Aug  1 2012, 05:14:39) 
[GCC 4.6.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import testing
>>> 'a' in testing.__dict__
True 
```

该模块`__dict__`还包含通常的全局内置插件。在模块内定义的任何内容都使用模块`__dict__`作为全局范围。在 python 中，没有“全局变量”之类的东西，这意味着每个模块/类/函数都可以访问一个变量。全局变量实际上只是模块的即时变量。

如果要将模块中的某些项目导入到另一个模块的命名空间中，可以使用以下`from`语法：

```
from module_a import functionA, functionB, classA, CONSTANT 
```

您可以使用以下命令导入所有内容`*`：

```
from module_a import * 
```

但避免使用`from ... import *`语法！您会遇到 C 包含中的命名空间冲突。仅当模块在其文档中声明它是*`*`-import safe*时才执行此操作。为了使模块*`*`-import 安全*，您可以定义全局，它应该是一个字符串序列，表示在执行 -import`__all__`时应该导出的标识符。`*`

例如：

```
#module_a
A = 1
B = 2
__all__ = ['A']

#module_b
from module_a import *
print(A)   #okay
print(B)   #NameError, B was not exported! 
```

# javascript - 如何使地图以当前用户位置为中心（地理位置

> ID：13108759
> 
> 赞同：3
> 
> 时间：2012-10-28T12:22:45.877
> 
> 标签：javascript, geolocation, location, point

我有这个代码，我想以用户位置为中心，因为现在它以我拥有的坐标为中心（在丹麦哥本哈根上方）并且它是固定的。我需要使我的代码使地图以用户位置为中心并显示其周围的点

```
function initialize() {

var locations = [
    ['kastelet', 55.6911, 12.5939],
    ['norebro', 55.6883, 12.5597],
    ['noreport', 55.6832, 12.5714],
    ['edisikvosi', 55.678272, 12.503643,],
    ['Sentosa', 55.713207, 12.526474,]
    ];

var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 12,
    center: new google.maps.LatLng(55.6750, 12.5687),
    mapTypeId: google.maps.MapTypeId.ROADMAP
});

var infowindow = new google.maps.InfoWindow();

var marker, i;

for (i = 0; i < locations.length; i++) {
    marker = new google.maps.Marker({
        position: new google.maps.LatLng(locations[i][1], locations[i][2]),
        map: map
    });

    google.maps.event.addListener(marker, 'click', (function(marker, i) {
        return function() {
            infowindow.setContent(locations[i][0]);
            infowindow.open(map, marker);
        }
    })(marker, i));
}

// Check if user support geo-location
if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
        var latitude = position.coords.latitude;
        var longitude = position.coords.longitude;
        var geolocpoint = new google.maps.LatLng(latitude, longitude);

        var mapOptions = {
            zoom: 8,
            center: geolocpoint,
            mapTypeId: google.maps.MapTypeId.HYBRID
        }
        // Place a marker
        var geolocation = new google.maps.Marker({
            position: geolocpoint,
            map: map,
            title: 'Your geolocation',
            icon: 'http://labs.google.com/ridefinder/images/mm_20_green.png'
        });
    });
}
}
google.maps.event.addDomListener(window, 'load', initialize);​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T12:26:41.233

使用`map.setCenter`.

```
 .....
 navigator.geolocation.getCurrentPosition(function(position) {
        var latitude = position.coords.latitude;
        var longitude = position.coords.longitude;
        var geolocpoint = new google.maps.LatLng(latitude, longitude);
          map.setCenter(geolocpoint );//line added for setting center
...... 
```

# c++ - 为什么我从 cmath.h 中得到数百个语法错误？

> ID：13108761
> 
> 赞同：0
> 
> 时间：2012-10-28T12:23:01.057
> 
> 标签：c++, c, visual-studio-2010, cmath

我正在使用 OpenGL 在 C++ 中做一个项目，并且不断受到来自 cmath.h 的数百个语法错误的影响。主要的难题是我什至根本没有提到或包括 cmath。我在一两件事上使用了 math.h，但在我进行最近的更改之前，该代码运行良好。回到以前工作的代码现在显示相同的错误，所以我有点难过从哪里开始寻找。

我是否遗漏了一些非常明显的东西，或者这可能是 Visual Studio 10 的问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T12:26:58.233

可能是因为没有（标准）`cmath.h`

C 数学头文件`math.h`和 C++ 也公开了这个库，但只是`cmath`，但是它的所有元素都被提升到 std:: 命名空间。

在 C++ 项目中，您应该像这样包含库：

```
 #include <cmath> 
```

并使用它的元素，如：

```
 c=std::sqrt(
       std::pow(a,2)
      +std::pow(b,2)); 
```

或者你正在做的任何其他事情。

### 参考

[http://en.cppreference.com/w/cpp/numeric/math](http://en.cppreference.com/w/cpp/numeric/math)

# android - 更改布局颜色android应用程序

> ID：13108765
> 
> 赞同：1
> 
> 时间：2012-10-28T12:23:40.150
> 
> 标签：android, android-layout, layout, background

我正在尝试编写一个程序，将屏幕的背景颜色更改为我决定的颜色。我写了类似的东西，但是当它运行时它崩溃了这是什么问题，请帮助我。这里是 xml 代码

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal" >

    <LinearLayout 

        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:layout_gravity="bottom"
        android:background="#FFFFFF"

        >

        <Button
            android:id="@+id/button1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Red"
            />

        <Button
            android:id="@+id/button2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Green" />

        <Button
            android:id="@+id/button3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Blue" />
         <Button
            android:id="@+id/button4"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="White" />

    </LinearLayout>

</LinearLayout> 
```

这是.java代码

```
package com.example.flashlight;

import android.os.Bundle;
import android.app.Activity;
import android.graphics.Color;
import android.view.Menu;
import android.view.View;
import android.widget.Button;
import android.widget.LinearLayout;

public class FlashLight extends Activity {

Button red,green,blue,white;
LinearLayout view;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_flash_light);
    red=(Button) findViewById(R.id.button1);
    green=(Button) findViewById(R.id.button2);
    blue=(Button) findViewById(R.id.button3);
    white=(Button) findViewById(R.id.button4);

    red.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub

            view.setBackgroundColor(Color.RED);

        }
    });

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_flash_light, menu);
    return true;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:28:04.733

您需要为您的`LinearLayout`

```
 <LinearLayout 
    android:id="@+id/view"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:layout_gravity="bottom"
    android:background="#FFFFFF" 
```

然后初始化你的视图

```
view = (LinearLayout) findViewById(R.id.view)
red.setOnClickListener(new View.OnClickListener() {

    public void onClick(View v) {
        // TODO Auto-generated method stub

        view.setBackgroundColor(Color.RED);

    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T05:26:59.337

试试这个代码

这对我有用...在你的 xml 文件中，为你的线性布局设置 id 作为视图。

```
<LinearLayout 

    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:layout_gravity="bottom"
    android:id="@+id/view"
    android:background="#FFFFFF"

    > 
```

在您的 java 文件中，由于 id，您的线性布局视图为空。

所以把下面的行放在你的java文件中

```
 view  = (LinearLayout) findViewById(R.id.view); 
```

这对我有用....

快乐的编码..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T12:27:14.567

您没有将`view`变量分配给任何东西，这可能会导致`NullPointerException`代码中出现

尝试在您的 XML 文件中添加以下行`LinearLayout`：

`android:id="@+id/view"`

并将这一行添加到您的`onCreate`：

`view = (LinearLayout)findViewBiId(R.id.view);`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-30T10:27:02.440

在 onClick 之后使用下面的代码：

```
view.setBackgroundColor(Color.DKGRAY); 
```

例子：

```
public void onClick(View v) {
        view.setBackgroundColor(Color.DKGRAY); //Add any color you want
    } 
```

# mysql - 从多个表中选择数据

> ID：13108767
> 
> 赞同：0
> 
> 时间：2012-10-28T12:23:47.187
> 
> 标签：mysql, sql, select

如何通过mysql在一行中加入多行？

例子 ：

学生桌

```
Sno.|  Name |  Subjects
1\.  | ABC   |  1
2\.  | ABC   |  3
3\.  | ABC   |  4
4\.  | FMC   |  2
5\.  | ABC   |  4
6\.  | JBC   |  4 
```

论文表：

```
Sno. | Paper Name | Type 
 1\.      French     Optional
 2\.      English    Mandatory
 3\.      Japenese   Optional
 4\.      Maths      Optional 
```

现在我想要这种格式

```
Sno.| Name|   Sub1  |  Sub2    | Sub3  |  Sub4 |
1\.  | ABC |  French |  Japenese| Maths | Null  |
2\.  | FMC |  Null   | Null     | Null  | Null  |
3\.  | JBC |  Maths  | Null     | Null  | Null  | 
```

我要选择的是论文表中的论文名称和学生姓名，另一个表中的四个科目。我只想看那些可选的论文。我不知道该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T14:10:13.637

我认为您正在寻找的概念是**旋转**的。

### 带*连接的版本*

```
select 
  name,
  max(if(s.subject = 1 and p.type = 'Optional', p.paper_name, null)) as subject1,
  max(if(s.subject = 2 and p.type = 'Optional', p.paper_name, null)) as subject2,
  max(if(s.subject = 3 and p.type = 'Optional', p.paper_name, null)) as subject3,
  max(if(s.subject = 4 and p.type = 'Optional', p.paper_name, null)) as subject4
from 
  students s
inner join
  papers p on p.sno = s.subject
group by s.name 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/c5c03/23/0)

### 带有子*选择*而不是连接的版本

```
select 
  name,
  max(
    case 
      when subject = 1 
        then (select paper_name from papers p where p.sno = subject and type = 'Optional') 
      else 
        null 
    end) as subject1, 
  max(
    case 
      when subject = 2 
        then (select paper_name from papers p where p.sno = subject and type = 'Optional') 
      else 
        null 
    end) as subject2,
  max(
    case 
      when subject = 3 
        then (select paper_name from papers p where p.sno = subject and type = 'Optional') 
      else 
        null 
    end) as subject3,
  max(
    case 
      when subject = 4
        then (select paper_name from papers p where p.sno = subject and type = 'Optional') 
      else 
        null 
    end) as subject4
from 
  students
group by 
  name 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/c5c03/15/0)

# asp.net-mvc - Jquery postback 在 mvc 4 客户端上不起作用

> ID：13108772
> 
> 赞同：0
> 
> 时间：2012-10-28T12:25:41.530
> 
> 标签：asp.net-mvc, json, jquery, asp.net-mvc-4, postback

我试图简单地创建一个 json 回发，以便我可以在客户端更新一些控件。我找不到一个很好的例子来证明这一点。

这是我到目前为止所得到的，它似乎正在从控制器发出警报，但在客户端一直说“未定义”对象。

什么是实现这一目标的最佳实践方法，因为我不知道如何以与常规代码相同的方式调试 javascript？:( 我正在使用 vs2012 express、mvc 4、jquery 1.7.1 和 jquery mobile 1.1。

我的控制器时间/索引：

```
[HttpPost]
public JsonResult Index()
{
     var msg = "hello there";  //test message
     return Json(msg);
} 
```

我的客户端：

```
function populateUserDetails() {
     var user = {};
     user.UserId = $("#UserId").val();    // potential fields i may use once i get it working
     $.post('Time/Index', user, updateFields, 'json');
 };

updateFields = function (data) {
    alert("hi " + data.msg);
    $("#textEntered").val(data.msg);
}; 
```

***********更新******* *** ** *** **********

 *****通过将控制器中的返回对象包装到一个临时类中来修复它：

```
 [HttpPost]
    public JsonResult Index()
    {
        var response = new {msg = "hello there"};   //here's what i changed
        return Json(response);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-24T07:09:51.250

替换您的最后一行代码，如下所示。

返回 Json(response,JsonRequestBehavior.AllowGet);

所以应该是这样的

[HttpPost]

```
public JsonResult Index()
{
    var response = new {msg = "hello there"};  
   //here's what i changed

   return Json(response,JsonRequestBehavior.AllowGet);
} 
```*****

# jquery - 未在 ajax 帖子中返回选定的复选框值

> ID：13108773
> 
> 赞同：0
> 
> 时间：2012-10-28T12:25:44.020
> 
> 标签：jquery, ajax, post, checkbox

```
var dataArray = $('input:checkbox:checked').map(function() {
    return this.value;
}).get();

$.ajax({
    type: 'POST',
    url: 'showdata.php',
    data: {data : dataArray},
    success: function(data) {
        //only the value of last selected checkbox value is returned ,
// but when I alert the dataArray then it shows all values separated with commas.
            alert('response data = ' + data);
        }
    }); 
```

**显示数据.php**

```
$data = ''; 

if (isset($_POST['data']))
{
    $data = $_POST['data'];
}

echo $data; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:31:16.843

你应该使用`$("input:checked")`，而不是`$('input:checkbox:checked')`。

**Javascript：**

```
var dataArray = {'data': $("input:checked").map(function() {
    return this.value;
}).get()};

$.ajax({
    type: 'POST',
    url: 'showdata.php',
    data: dataArray,
    success: function(data) {
        alert('response data = ' + data);
    }); 
```

**PHP：**

```
$data = ''; 

if (isset($_POST['data']))
{
    $data = implode(', ', $_POST['data']);
}

echo $data; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T12:31:18.537

它不是`$_POST`作为`data`键出现，而是作为控制名称（序列化）或您给出的显式键名（显式示例）。

成功回调将获得数据的结果，即您的 PHP 文件输出的内容。

```
$.ajax({
    type: 'POST',
    url: 'showdata.php',
    data: $("myformid_in_html").serialize(),
    success: function(data) {
        //only the value of last selected checkbox value is returned ,
        // but when I alert the dataArray then it shows all values separated with commas.
        alert('response data = ' + data);
    }
}); 
```

在上面的例子中，如果你把所有的复选框放在一个表单中，你可以一次把它们全部拿走。

或明确：

```
$.ajax({
    type: 'POST',
    url: 'showdata.php',
    data: {
        mypostvar: "testing_service",
        myotherpostvar: 1
    },
    success: function(data) {
        //only the value of last selected checkbox value is returned ,
        // but when I alert the dataArray then it shows all values separated with commas.
        alert('response data = ' + data);
    }
}); 
```

然后你在里面有他们的名字：

```
$data = ''; 

if (isset($_POST))
{
    $data = $_POST['myformfield_html_name'];
    // or
    $mypostvar = $_POST['mypostvar'];
    $myotherpostvar = $_POST['myotherpostvar'];
} 
```

这是主要问题，您没有正确处理 POST 数据。该复选框仅在选中时才会出现在 POST vars 中，否则您将无法在其中找到它。

# asp.net - 如何在google map api 3中绘制从源到目的地的路线

> ID：13108776
> 
> 赞同：0
> 
> 时间：2012-10-28T12:26:26.280
> 
> 标签：asp.net, google-maps-api-3

下面的链接非常有帮助。我想做额外的，但我做不到。我想像谷歌那样在 2 个或更多地方之间绘制路线，在该源代码中它只有 2 个地方（在“方向”部分下）。请帮助我，并在此先感谢

[http://www.codeproject.com/Articles/291499/Google-Maps-API-V3-for-ASP-NET](http://www.codeproject.com/Articles/291499/Google-Maps-API-V3-for-ASP-NET)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:47:32.663

Google Maps JavaScript API V3 允许地图对象通过实现 MVC 对象来存储状态并自动更新其表示。

其中两个可能会让您对您的项目感兴趣。 [**DirectionsService**](https://developers.google.com/maps/documentation/javascript/reference#DirectionsService)和[**DirectionsWaypoint**](https://developers.google.com/maps/documentation/javascript/reference#DirectionsWaypoint)。

具体来说，您可以使用[**航点**](https://developers.google.com/maps/documentation/directions/#Waypoints)来提供路线上的位置。这些航路点可以做成可移动的。

# sql - 快速删除数据仓库数据中的多行

> ID：13108778
> 
> 赞同：2
> 
> 时间：2012-10-28T12:26:52.040
> 
> 标签：sql, sql-server, sql-server-2008, delete-row

在 SQL Server 2008 中，我有几百万行需要删除的数据。它们分散在几张桌子上。删除最多需要 20 秒，我认为这很慢！要删除的数据由一`timestamp`列标识。以下是我迄今为止为优化所做的工作：

*   使用隔离级别`read uncommitted`。我不关心交易。如果我们失败了，用户将再次发出删除操作。并确保新数据没有`timestamp`我们正在删除的内容。
*   在父表之前删除叶表。
*   该`timestamp`列是 PK 聚集索引的一部分，实际上它是 PK/索引的第一个位置。
*   每个表都使用一个循环清空，该循环删除前 200000 个条目，以减少事务日志开销。
*   服务器上的 I/O 和 CPU 均未达到最大值

我忽略了什么？

我也怀疑将时间戳列移动到 PK 中的第一个位置的效果。这样做之后，我必须重新组织表还是 SQL Server 足够聪明，可以自己完成。我对聚集索引的理解是，由于它定义了行的物理布局，因此强制重新组织数据。但是我们没有收到客户抱怨更改聚集索引操作需要很长时间才能执行的投诉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-02-12T22:07:10.487

请确保您要从中删除数据的表具有明确指出的“主键”。

错误的：`create table myTable (ID int)`

真的： `create table myTable (ID int PRIMARY KEY)`

除此之外，请尝试添加“选项（重新编译）”，这将有助于提高性能：

```
DELETE FROM myTable 
WHERE timestamp in (select timestamp from other_table)
OPTION (RECOMPILE) 
```

# sql - 按 SQL 时间戳排序

> ID：13108785
> 
> 赞同：3
> 
> 时间：2012-10-28T12:27:41.073
> 
> 标签：sql, sql-order-by

我在每条记录中添加了一个时间戳字段，并带有一个 SQL 时间戳（是的，格式实际上是 TIMESTAMP）。我想按日期和时间显示我的记录；我可以在 SQL 语句中只使用 ORDER BY 吗？

```
SELECT * FROM table ORDER BY timestamp DESC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-04-03T08:13:44.753

假设它的 MySQL，

```
SELECT *
FROM randomTable
ORDER BY timestampfield DESC; 
```

简直完美。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-27T09:37:50.160

是的，我试过了，它在 Oracl SQL Developer 上对我有用

# css - 在 JavaFX 的上下文菜单中添加阴影效果

> ID：13108789
> 
> 赞同：2
> 
> 时间：2012-10-28T12:28:32.833
> 
> 标签：css, javafx, effect

我试过用这样的 CSS 来做到这一点（测试示例）：

```
.context-menu {
    -fx-effect: dropshadow(one-pass-box, black, 10, 1.0, 3, 3)
} 
```

但它不起作用。试图找出我应该通过 ScenicView 设置样式的节点，但上下文菜单在我可以读取 SV 中的信息之前消失。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-20T06:32:25.000

```
yourMenu.setEffect(addLabelEffect()); 
```

在类中定义投影并检查它是否工作。这是一个简单的示例

```
private DropShadow addLabelEffect() {

        DropShadow ds = new DropShadow();
        ds.setSpread(0);
        ds.setOffsetY(1.0);
        ds.setOffsetX(1.0);
        ds.setColor(Color.BLACK);

        return ds;

    } 
```

# sql - SQL中的计数

> ID：13108791
> 
> 赞同：0
> 
> 时间：2012-10-28T12:28:42.070
> 
> 标签：sql

AFDELING = 部门。MEDLEM = 会员。我想查看每个部门的成员数量，显示部门名称，但似乎无法正常工作。我得到的只是 Personnr 的副本。

```
SELECT AFDELING.afdnavn, MEDLEM.personnr, count(*)
FROM [dbo].[MEDLEM],[dbo].AFDELING
WHERE AFDELING.afdnr = MEDLEM.afdnr
GROUP BY AFDELING.afdnavn, MEDLEM.personnr
GO 
```

使用的表：

```
爱德灵
Afdnr（主键）
阿夫德纳文

```

```
梅德莱姆
Afdnr（外键）
Personnr（外键）（主键）

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:31:28.157

我认为您的错误是您按`MEDLEM.personnr`. 您只需要分组 `AFDELING.afdnavn`并执行`count`

```
select
    A.afdnavn,
    count(*) as number
from dbo.AFDELING as A
    inner join dbo.MEDLEM as M on M.afdnr = A.afdnr
group by A.afdnavn 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T12:32:03.800

```
SELECT 
  AFDELING.afdnavn
  , COUNT(MEDLEM.personnr)
FROM
  dbo.AFDELING JOIN
    dbo.MEDLEM ON AFDELING.afdnr = MEDLEM.afdnr
GROUP BY
  AFDELING.afdnavn 
```

# actionscript - Actionscript - 长类名的快捷方式引用

> ID：13108792
> 
> 赞同：0
> 
> 时间：2012-10-28T12:28:51.033
> 
> 标签：actionscript, import, classname

有没有办法在动作脚本中做类似的事情`import <BLAH> as`？我有一些类，我不想每次使用它们时都输入完整的类名。这就是为什么我试图找到一个导入为，或`var C = ImportedClassThatIDontWantToTypeEveryTime`。我尝试了几种不同的方法，例如：

```
package com.mysite.blah {
    // doesn't work
    import com.mysite.ImportedClassThatIDontWantToTypeEveryTime as C;

    // also doesn't work
    import com.mysite.ImportedClassThatIDontWantToTypeEveryTime;
    var C:Class = ImportedClassThatIDontWantToTypeEveryTime;

    // ????

    public class SomeOtherClass {

        public function blah():void {

            C.doSomething();

        }

    }

} 
```

我知道有办法做到这一点——几年前我就做过了。但是，我不记得该怎么做。帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T10:46:48.867

你用的是什么IDE？我问这个是因为多年来我不必输入完整的类路径。[FlashDevelop](http://www.flashdevelop.org/)和[FlashBuilder](http://www.adobe.com/products/flash-builder.html)的自动完成功能将允许您键入所需类的前几个字母，从列表中选择它，它会自动将适当的`import`语句添加到类的顶部。

# ruby-on-rails - Ruby on rails - 如何检查由简单表单创建的单选按钮是否已在控制器中检查？

> ID：13108794
> 
> 赞同：3
> 
> 时间：2012-10-28T12:29:00.397
> 
> 标签：ruby-on-rails, ruby-on-rails-3, simple-form

我建立了一个视图来创建问题和答案。这是我的问答模型：

```
class Question < ActiveRecord::Base
  attr_accessible :content

  belongs_to :topic
  belongs_to :user
  belongs_to :question_type
  has_many :answers, dependent: :destroy
  accepts_nested_attributes_for :answers
end

class Answer < ActiveRecord::Base
  attr_accessible :content

  belongs_to :question
end 
```

我的答案模型还有一个名为`correct`type boolean 的属性，如果哪个答案正确，则设置为 true，默认为 false。我已经建立了一个表格来创建一个真/假问题：

```
<%= simple_form_for @question do |q| %>

  <%= q.input :content, input_html: { rows: 3, class: 'span6' } %>
  <%= q.input :mark, input_html: { class: 'span1' } %>
  <%= q.association :topic %>
  <%= q.association :question_type %>

  <%= q.simple_fields_for :answers do |a| %>

    <%= a.input :correct, collection: [[true, 'True'], [false, 'False']],
                                                            as: :radio_buttons,
                                                            label: 'Answer',
                                                            value_method: :first,
                                                            label_method: :last,
                                                            item_wrapper_class: 'inline'
                                                            %>

  <% end %>
<% end %> 
```

在视图中呈现时的正确属性具有以下 html：

```
<label class="radio inline"><input class="radio_buttons optional" id="question_answers_attributes_0_correct_true" name="question[answers_attributes][0][correct]" type="radio" value="true">True</label>

<label class="radio inline"><input checked="checked" class="radio_buttons optional" id="question_answers_attributes_0_correct_false" name="question[answers_attributes][0][correct]" type="radio" value="false">False</label> 
```

现在在控制器中，我想检查选中了哪个单选按钮及其值。有什么方法可以检查是否`correct`检查了属性及其在控制器中的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T12:33:46.390

将`params[:question][:answers_attributes][0][:correct]`具有真或假的值。因为`params[:question][:answers_attributes][0][:correct]`只有一个值。您可以找到用户选择的值。

只有选定的单选按钮的值被发送到服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T15:35:38.653

您必须遍历 params[:question][:answers_attributes] 来检查单选按钮是否被选中。你可以做这样的事情，

```
params[:question][:answers_attributes].collect do |answer_attribute|
     answer_attribute if answer_attribute.last["correct"] == true
end.compact 
```

这将返回一个答案属性数组，这些属性被更正为真。

# apache-flex - 如何撤消移动效果

> ID：13108795
> 
> 赞同：0
> 
> 时间：2012-10-28T12:29:03.923
> 
> 标签：apache-flex

我有一个非常简单的问题。我希望组件在鼠标悬停时向右移动，当鼠标在其他位置时组件将向后移动。我想出的代码是这样的。

```
<?xml version="1.0" encoding="utf-8"?>

<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009"
               xmlns:s="library://ns.adobe.com/flex/spark"
               xmlns:mx="library://ns.adobe.com/flex/mx"
               xmlns:ns1="*"
               minWidth="955" minHeight="600">
    <fx:Style source="testproject.css"/>

    <fx:Declarations>

        <s:Move3D id="nueffect" target="{menuC}"  xBy="+100" />
    </fx:Declarations>

    <ns1:menu id="menuC" x="-296" y="155" mouseOver="nueffect.play();">
    </ns1:menu>

</s:Application> 
```

我的问题是当鼠标没有悬停在组件上时如何实现效果？

# java - Hadoop MapReduce Java 实现中的 Reducer

> ID：13108796
> 
> 赞同：3
> 
> 时间：2012-10-28T12:29:15.703
> 
> 标签：java, hadoop

我正在 Hadoop MapReduce 框架中编写一个 Java 实现程序。我正在写一个名为`CombinePatternReduce.class`. 为了在 Eclipse 中调试 reducer，我编写了`main()`如下函数：

```
@SuppressWarnings("unchecked")
public static void main(String[] args) throws IOException, InterruptedException{
    Text key = new Text("key2:::key1:::_ performs better than _");
    IntWritable count5 = new IntWritable(5);
    IntWritable count3 = new IntWritable(3);
    IntWritable count8 = new IntWritable(8);
    List<IntWritable> values = new ArrayList<IntWritable>();
    values.add(count5);
    values.add(count3);
    values.add(count8);
    CombinePatternReduce reducer = new CombinePatternReduce();
    Context dcontext = new DebugTools.DebugReducerContext<Text, IntWritable, KeyPairWritableComparable, WrapperDoubleOrPatternWithWeightWritable>(reducer, key, count3); // here is the problem
    reducer.reduce(key, values, dcontext);      
} 
```

这`DebugTools.DebugReducerContext`是我编写的一个类，用于使调试过程更易于执行，如下所示：

```
public static class DebugReducerContext<KIN, VIN, KOUT, VOUT> extends Reducer<KIN, VIN, KOUT, VOUT>.Context {
    DebugTools dtools = new DebugTools();
    DataOutput out = dtools.new DebugDataOutputStream(System.out);

    public DebugReducerContext(Reducer<KIN, VIN, KOUT, VOUT> reducer, Class<KIN> keyClass, Class<VIN> valueClass) throws IOException, InterruptedException{
        reducer.super(new Configuration(), new TaskAttemptID(), new DebugRawKeyValueIterator(), null, null, 
                null, null, null, null, keyClass, valueClass);
    }

    @Override
    public void write(Object key, Object value) throws IOException, InterruptedException {
        writeKeyValue(key, value, out);
    }

    @Override
    public void setStatus(String status) {
        System.err.println(status);
    }
} 
```

问题出在代码的第一部分，即`main()`. 当我写

```
Context dcontext = new DebugTools.DebugReducerContext<Text, IntWritable, KeyPairWritableComparable, WrapperDoubleOrPatternWithWeightWritable>(reducer, key, count3); 
```

有一个错误是

```
The constructor DebugTools.DebugReducerContext<Text,IntWritable,KeyPairWritableComparable,WrapperDoubleOrPatternWithWeightWritable>(CombinePatternReduce, Text, IntWritable) is undefined. 
```

当我写

```
Context dcontext = new DebugTools.DebugReducerContext<Text, IntWritable, KeyPairWritableComparable, WrapperDoubleOrPatternWithWeightWritable>(reducer, key, values); 
```

有一个错误是

```
The constructor DebugTools.DebugReducerContext<Text,IntWritable,KeyPairWritableComparable,WrapperDoubleOrPatternWithWeightWritable>(CombinePatternReduce, Text, List<IntWritable>) is undefined. 
```

由于文档`Reducer.Context`是

```
public Reducer.Context(Configuration conf,
                       TaskAttemptID taskid,
                       RawKeyValueIterator input,
                       Counter inputKeyCounter,
                       Counter inputValueCounter,
                       RecordWriter<KEYOUT,VALUEOUT> output,
                       OutputCommitter committer,
                       StatusReporter reporter,
                       RawComparator<KEYIN> comparator,
                       Class<KEYIN> keyClass,
                       Class<VALUEIN> valueClass)
                throws IOException,
                       InterruptedException 
```

我需要传入一个`Class<KEYIN> keyClass`and `Class<VALUEIN> valueClass`。那么如何编写 main() 函数（尤其是有错误的句子）来调试 reducer 类呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T14:44:23.097

很明显，类构造函数需要 3 个参数。一个 reducer 的实例，一个 key 的 class，一个 value 的 class。

而不是实际传递键和值。您需要为其提供课程链接

```
Context dcontext = new DebugTools.DebugReducerContext<Text, IntWritable, KeyPairWritableComparable, WrapperDoubleOrPatternWithWeightWritable>(reducer, Text.class, IntWritable.class); 
```

本质上，这是重申上下文应该能够处理减少的值的类型。

# spring - 使用spring3的异常

> ID：13108797
> 
> 赞同：0
> 
> 时间：2012-10-28T12:29:28.717
> 
> 标签：spring

我使用 Spring 3 和 Hibernate 开发了一个应用程序。为了测试我的 DAO，我使用 Junit，当我运行测试时，我得到了一个异常。

这是我的应用程序 context.xml 的一部分：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
    <property name="driverClassName" value="com.mysql.jdbc.Driver"/>
    <property name="url" value="jdbc:mysql://localhost/register"/>
    <property name="username" value="root"/>
</bean>

<bean id="sessionFactory" 
class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <property name="dataSource" ref="dataSource"/>
    <property name="configurationClass" value="org.hibernate.cfg.AnnotationConfiguration"/> 

    <property name="annotatedClasses">
        <list>
            <value>com.model.Register</value>
        </list>
    </property>

    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
            <prop key="hbm2ddl.auto">update</prop>
            <prop key="hibernate.show_sql">true</prop>
        </props>
    </property>
</bean> 
```

当我运行测试时，出现以下异常：

> org.springframework.beans.factory.BeanDefinitionStoreException：来自类路径资源 [application-context.xml] 的 XML 文档中的第 10 行无效；嵌套异常是 org.xml.sax.SAXParseException: L'élément racine de document "beans" doit compatiblere à la racine DOCTYPE "null"。org.xml.sax.SAXParseException；行号：10；列号：105；L'élément racine de document "beans" doit compatiblere à la racine DOCTYPE "null"。在 com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException（未知来源）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T13:03:37.067

xsi:schemalocation 的 Spring bean 是错误的。将 xsi:schemalocation 的第一行更改为

```
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd 
```

你错过了 -3.0.xsd

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T14:51:46.347

`</beans>`在上下文文件的末尾添加

# eclipse - Eclipse 如何确定项目是否可以添加到 Java EE 服务器？

> ID：13108798
> 
> 赞同：0
> 
> 时间：2012-10-28T12:29:28.997
> 
> 标签：eclipse, glassfish

我认为图像将更好地说明我的问题。我在 Eclipse 中有一个 Java 项目，无法将其添加到内部 GlassFish。我必须做什么才能让 Eclipse 让我这样做？

![Eclipse Java 项目](../Images/db881a9a5cd78ded1770fde605439d4c.png)

![期望的动作](../Images/e9d390ba35427fcf5247cf0659f9d693.png)

![失败](../Images/085c9535865b0a017a78348589ce8562.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T13:17:05.187

弄清楚了！

转到项目属性-> 项目方面。单击转换为多面形式。将出现一个构面列表。检查动态 Web 模块方面。单击应用。

仍在项目属性中时，转到部署程序集。删除 WebContent 条目。添加一个新条目，选择 src/main/webapp 目录。点击完成。它将将此目录部署到/。

而已！工作对我来说就像一个魅力！

# php - 通过 POST 方法以形式传递 PHP 回显的问题

> ID：13108799
> 
> 赞同：1
> 
> 时间：2012-10-28T12:29:34.397
> 
> 标签：php, codeigniter

```
<form method="POST" name="send"
<input type="hidden" name="title" value="<?php echo ($pro->title;?)">
</form> 
```

我不希望人们看到隐藏的信息，这是将变量传递给我的控制器的最佳方式吗？

这是我控制器中的代码

```
$this->email->subject('subject '.$_POST['title'].' ' ); 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T12:31:20.743

```
<form method="POST" name="send"
<input type="hidden" name="title" value="<?php echo ($pro->title;?)"> 
```

应该

```
<form method="POST" name="send">
<input type="hidden" name="title" value="<?php echo $pro->title; ?>" /> 
```

为此，我建议您使用`SESSION`，因为`hidden`可以更改字段。

# c# - 如何将 LINQ 查询中的“var”填充到同一个数据表中？

> ID：13108800
> 
> 赞同：2
> 
> 时间：2012-10-28T12:30:18.887
> 
> 标签：c#, database, linq, ado.net, datatable

我对 LINQ 相当陌生，并且正在尝试将此查询应用于名为“EmpInfo”的数据表以对其进行排序。

```
var sortedRows = (from myRow in EmpInfoDS.Tables["EmpInfo"].AsEnumerable()
                 orderby myRow["EmpID"] ascending
                 select myRow).ToArray(); 
```

这行得通。我要做的下一件事是将结果复制到 SAME 数据表中。

```
EmpInfoDS.Tables["EmpInfo"].Clear();
EmpInfoDS.Tables["EmpInfo"] = sortedRows.CopyToDataTable(); 
```

第二行抛出以下错误：

> “无法将属性或索引器‘System.Data.DataTableCollection.this[string]’分配给——它是只读的”

请有人告诉我如何处理这个问题。如果有其他方法请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:44:54.403

该错误表示您无法使用索引器分配表，因为`Tables`它是**只读属性**。所以要解决这个问题：

```
EmpInfoDS.Tables.Remove("EmpInfo");
DataTable dt = sortedRows.CopyToDataTable();
dt.TableName = "EmpInfo";
EmpInfoDS.Tables.Add(dt); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:01:39.903

使用 LINQ，您必须注意延迟执行。基本上，在查询中的数据被消耗之前，不会执行查询。如果您希望查询立即执行，请使用该`ToList()`方法。

```
var sortedRows = EmpInfoDS.EmpInfo.OrderBy(e => e.EmpID).ToList(); 
```

接下来，代码很简单：

```
var employees = EmpInfoDS.EmpInfo;
employees.Clear();
foreach (var sortedRow in sortedRows)
    employees.Add(sortedRow);
EmpInfoDS.SaveChanges(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T12:41:39.760

我认为这是可以做到的：（你可能更喜欢不同的[`LoadOption`](http://msdn.microsoft.com/en-us/library/system.data.loadoption.aspx)）

```
EmpInfoDS.Tables["EmpInfo"].Clear();
sortedRows.CopyToDataTable(EmpInfoDS.Tables["EmpInfo"], LoadOption.OverwriteChanges); 
```

这也应该有效：

```
EmpInfoDS.Tables["EmpInfo"].Clear();
foreach (var row in sortedRows)
    EmpInfoDS.Tables["EmpInfo"].Rows.Add(row); 
```

# android - Android 圆形菜单，如 Catch Notes

> ID：13108803
> 
> 赞同：12
> 
> 时间：2012-10-28T12:30:36.140
> 
> 标签：android, android-layout, android-widget, android-custom-view

![赶上笔记应用程序](../Images/45172fbb79cf68aac75aae63ccd42eda.png)

我尝试像在这个应用程序中那样做圆形菜单。

在“扩展”模式下，我绘制这个组件如下：

```
<RelativeLayout android:id="@+id/bigCircle">
<!--color full borders-->
    <my.custom.component android:id="@+id/middleCircle">
    <!--circle for buttons-->
         <RelativeLayout android:id="@+id/smallCircle">
           <!--minus button-->
         </RelativeLayout>
    </my.custom.component>
</RelativeLayout> 
```

在我的 onDraw 方法中，`my.custom.component`我使用`android.graphics.Path`with`android.graphics.Paint`和一些数学将圆划分为 8 个部分。
视觉上我完全如屏幕截图所示。但是当我按下圆圈的一部分时，我需要用另一种颜色重新绘制这部分以向用户展示发生了什么事情。

例如，我如何重绘从画布的另一部分截断的组件画布的一部分`android.graphics.Path`。
换句话说，我知道我应该在 onDraw 方法中重绘画布，我知道我可以从在 photoshop 中绘制的可绘制对象中显示一些位图并且有一些“多屏问题”，我知道如何确定用户按下的部分。但我不知道如何选择画布的一部分并重绘它。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-29T21:23:11.007

Catch 的开发者在这里。如果我理解您的问题，那么您将无法理解如何在圆形菜单的一部分上专门绘制突出显示/选择指示器。

虽然有很多不同的方式可以实现它，但您倾向于（使用`android.graphics.Path`）是我们如何做到的。在我们的捕获按钮的视图层次结构中，有一个元素用作画布，在该画布上绘制选择突出显示颜色（如果有活动选择）*。*

如果您的布局中有类似的自定义`View`，则可以像这样复制此行为。首先，您需要`Path`定义特定圆段的选择。使用`Path.addArc(RectF, float, float)`我们可以得到我们需要的披萨片形状的路径：

```
private Path getPathForSegment(float startAngle, float sweep) {
    Point center = new Point(getWidth() / 2, getHeight() / 2);
    RectF rect = new RectF(0f, 0f, getWidth(), getHeight());
    Path selection = new Path();
    selection.addArc(rect, startAngle, sweep);
    selection.lineTo(center.x, center.y);
    selection.close();
    return selection;
} 
```

`getWidth()`和上面是封闭的`getHeight()`自定义视图对象，因此它们定义了包含绘制选择的圆圈的边界框。

然后，在您的自定义视图中`onDraw(Canvas)`，如果您的代码已确定应为段绘制选择：

```
@Override
protected void onDraw(Canvas canvas) {
    // Assume one has the rest of these simple helper functions defined
    if (shouldDrawSelection()) {
        float startAngle = getStartAngleOfSelectedSegment();
        float sweep = getSweepAngle();
        Paint paint = getPaintStyleForSelectedSegment();
        Path path = getPathForSegment(startAngle, sweep);
        canvas.drawPath(path, paint);
    }

    // ...

    super.onDraw(canvas);
} 
```

在跟踪触摸的代码的其他区域中，只需调用`invalidate()`自定义视图，以便它根据输入或状态的变化重绘（或不重绘）选择路径。

请记住，避免在 中添加`new`对象是一种很好的做法`onDraw()`，因此这些构建块（`Path`s、`Paint`s 等）中的大多数可以提前构建（或在第一次出现时构建一次）并重用。

希望这接近你的要求！

# javascript - jQuery 获取类名列表并添加到隐藏表单

> ID：13108804
> 
> 赞同：0
> 
> 时间：2012-10-28T12:30:38.060
> 
> 标签：javascript, jquery, input, timetable

我正在为我的网站设置一个时间表制作小部件。主题包含在单独的 DIV 中，然后将这些 DIV 拖到表格上的列中。参见示例： http: [//jsfiddle.net/x5T4h/2/](http://jsfiddle.net/x5T4h/2/)（感谢您之前的帮助）

现在我在桌子下面有一堆隐藏的输入

```
<input type="hidden" name="monday" value="">
<input type="hidden" name="tuesday" value="">
<input type="hidden" name="wednesday" value="">
<input type="hidden" name="thursday" value="">
<input type="hidden" name="friday" value="">
<input type="hidden" name="saturday" value="">
<input type="submit" name="submit" class="btn green disabled" value='Save'> 
```

每个主题 DIV 都有一个带有它的 ID 的类，例如`<div id="drag" class="21">Biology</div>`

有没有什么方法可以让 Javascript 获取列中每个 DIV 的类，并根据日期将其（按顺序）添加到隐藏输入中。

它看起来很复杂，我不知道，所以非常感谢任何帮助。

我的JS已经：

```
<script>
$(function() {
    $( "ul li" ).each(function(){
        $(this).draggable({
            helper: "clone"
        });
    });

    $( ".day" ).droppable({
        activeClass: "ui-state-hover",
        hoverClass: "ui-state-active",
        accept: ":not(.ui-sortable-helper)",
        drop: function( event, ui ) {
            var targetElem = $(this).attr("id");

            $( this ).addClass( "ui-state-highlight" );
            if($(ui.draggable).hasClass('draggable-source'))
                $( ui.draggable ).clone().appendTo( this ).removeClass('draggable-source');
            else
                $( ui.draggable ).appendTo( this );

            console.log(this.id)
        }
    }).sortable({
        items: "li:not(.placeholder)",
        sort: function() {
            $( this ).removeClass( "ui-state-default" );
        }
    });
})
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T12:49:21.883

嗯……似乎有点棘手……试试这个（尚未测试）

```
window.readDays = function() {
    $( 'table#days .day' ).each( function() {
        var vals = [];
        $( '.ui-draggable > div', $(this) ).each(function() {
            vals.push( $(this).attr('class') );
        } );
        $( 'input[name="'+ $(this).attr('id') +'"]' ).val( vals.join(','));
    } );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T12:58:12.180

不清楚你想要什么格式的值，所以逗号分隔作为起点是有意义的。目前尚不清楚您希望通过什么事件来触发它。

```
$('#days .day' ).each(function(){
  var day=this.id; 
   var items= $(this).find('div').map(function(){
       /* text of item seems like only place currently to retrieve the title of item*/
       return $(this).text();
   }).get()
   $( 'input[name="'+ day+'"]' ).val( items.join(','));
}); 
```

**演示：http:** [//jsfiddle.net/x5T4h/5/](http://jsfiddle.net/x5T4h/5/)

您可能会使用 ajax 提交所有数据，在这种情况下，您甚至不需要隐藏输入，只需将数组发送到服务器

# javascript - 使用 eval 在 JavaScript 中运行一组闭包

> ID：13108823
> 
> 赞同：0
> 
> 时间：2012-10-28T12:33:51.740
> 
> 标签：javascript, closures, eval

我想将一组在调用时运行的闭包存储到一个数组中。

eval 是最好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T12:39:36.157

“评估是邪恶的”;-)

但这是一个可能的解决方案

```
Array.prototype.execute = function() {
    for ( var i in this ) {
        if ( i && 'execute' != i && Function == this[ i ].constructor ) {
            this[ i ].apply( this );
        }
    }
};

var arr = [];
arr.push( ( function() {alert('A'); } ) );
arr.push( ( function() {alert('B'); } ) );
arr.push( ( function() {alert('C'); } ) );
arr.execute(); 
```

请记住：不建议像我那样扩展基本的 Javascript 类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:01:14.460

您可以即时创建函数并将引用存储在变量中：

```
var something = function() { alert("hello world"); }; 
```

并在数组中扩展：

```
var something = [function() { alert("hello world"); }, 
                 function() { alert("hello world"); }, 
                 function() { alert("hello world"); }]; 
```

例如，您稍后可以`something();`在第一个示例或`something[1]();`第二个示例中使用它来调用它。这里绝对不需要 Eval，除非函数的实际主体来自用户输入（上帝禁止 :-)）

什么以及如何调用它留给实现，但是一旦你意识到这一点，它应该是相当微不足道的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T13:22:36.433

好的，因为每个人都在猜测你真正在寻找什么，所以这是我的 .02：

```
var closures = (function(Global,undefined)
{
    var that = [];//return value
    that[0] = (function(some,vars, forClosure1)
    {
         return function()
         {
             console.log(some, vars,forClosure1);
         };
    })(values,of,closureArguments);//create all closures you need
    that.execAll = function (context,args)//the method to call them all (with arguments)
    {
        context = (context === undefined || context === Global ? that : context);
        args = args.length ? args : [];//make sure arguments has length property
        for (var i=0;i<that.length;i++)
        {
            if (typeof that[i] === 'function')
            {
                that[i].apply(context,args);
            }
        }
    };
    return that;//return closure array (with execAll method)
})(window); 
```

现在，我创建了一个闭包数组，它有自己的方法`execAll`，您可以向该方法传递 2 个参数：第一个确定调用数组的 closre 函数的上下文，第二个需要一个数组或参数对象传递给这些闭包函数中的每一个。
就目前而言，闭包*不能*在全局上下文中使用`execAll`. 这只是为了安全，但你永远不知道，也许你可能想在全局对象的上下文中调用它们。

总而言之，我认为这就是您正在寻找的东西，尽管我必须承认：我正在努力看看这段代码有什么用处，但也许这只是我。
无论如何：祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T12:49:41.320

我不确定“调用时运行”是什么意思，但是由于数组是对象，因此您可以将静态信息作为对象键存储在数组中：

```
var arr = ['foo','bar'];
arr.methods = {
   foo: function() { alert(this[0]); },
   bar: function() { alert(this[1]); },
};
arr.run = function() {
    for (var fn in this.methods) {
        this.methods[fn].call(this);
    }
};

​arr.run();​ 
```

您也可以使用原型继承将其变为可重用函数，但您需要将数组嵌入其中，因为数组在 javascript 中不是“可子类化”的。

# java - 使用同步获取意外值

> ID：13108824
> 
> 赞同：3
> 
> 时间：2012-10-28T12:34:07.220
> 
> 标签：java, multithreading, synchronized

我有一个简单的代码片段，并尝试对其进行一些试验，但在下一个代码中，我不清楚输出数据的顺序：

```
public class Main {

    static int n = 100;

    public static synchronized int decreaseValue(){
        return --n;
    }

    public static void main(String[] args) throws InterruptedException, IOException {

        Thread t1 = new Thread(new Runnable() {
            @Override
            public void run() {
                while(true){
                    try {
                        System.out.println("Thread1: "+ decreaseValue());
                        Thread.sleep(2000);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
            }
        },"Thread1");
        t1.start(); 

        Thread t2 = new Thread(new Runnable() {
            @Override
            public void run() {
                while(true){
                    try {
                        System.out.println("Thread2: "+ decreaseValue());
                        Thread.sleep(2000);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
            }
        },"Thread2");
        t2.start();

        while(true){
            try {
                System.out.println("Main Thread: "+ decreaseValue());
                Thread.sleep(2000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }
} 
```

无法理解，为什么我会按下一个顺序获得这样的值：

线程 1：89 线程 2：90 主线程：88

请注意 N 值而不是调用线程的顺序：

```
Thread1: 99
Thread2: 98
Main Thread: 97
Main Thread: 95
Thread2: 94
Thread1: 96
Main Thread: 92 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T12:47:41.163

您必须在某处阅读过`synchronized`必须用于确保正确排序的内容或类似内容。“排序”这个词与您所想到的概念不同：它意味着同步块的执行总会有一些确定的顺序。顺序是事先不知道的，但每次都会在那里。如果没有同步，您甚至不会得到保证：一个线程可以感知一个顺序，另一个线程可以感知不同的顺序，或者根本不感知其他线程的任何操作。

## 关于您的编辑：

如果您担心打印输出乱序，这是因为您的`println`语句在外部，`synchronized`因此可以独立于对`decreaseValue`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T12:41:49.853

线程并行运行。你无法预测他们的执行顺序。您可以设置线程优先级，确定其执行顺序的优先级。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T12:37:19.937

线程同时运行，并且没有任何东西强加他们应该调用你的`decreaseValue()`函数的顺序。您会期望它们是有序的，因为您正在执行相同数量的睡眠 :)，但是一旦线程从睡眠中启动/恢复，CPU 就会将该线程放入运行队列中（创建执行顺序，这是同步将保证的顺序），因此您的打印顺序取决于 CPU 将如何将线程放入运行队列中。

如果您质疑打印顺序，控制台上的打印也会同步（但与您的 reductionValue 不在同一块中）。相同的逻辑适用于打印作为减少值的逻辑。

如果您想以与值递减相同的顺序查看打印，您可以在`decreaseValue()`函数中移动打印。但这不会影响值递减的顺序。

# lighttpd - Lighttpd fastcgi url 未重写

> ID：13108825
> 
> 赞同：1
> 
> 时间：2012-10-28T12:34:08.730
> 
> 标签：lighttpd, web.py, fastcgi

我有一个带有 fastcgi 和 web.py 的 lighttpd 服务器，具有以下 fcgi 配置：

```
fastcgi.server = ( "/code.py" => 
(( "socket" => "/tmp/fastcgi.socket",
   "bin-path" => "/etc/lighttpd/code/code.py",
   "check-local" => "disable",
   "max-procs" => 1 
```

）））

和主要配置：

```
url.rewrite-once = (
  "^(.*)/favicon.ico$"  => "/static/favicon.ico",
  "^/static/(.*)$"      => "/static/$1",
  "^/code.py(.*)$"      => "/code.py/404",
  "^/forum(.*)$"        => "/code.py/forum/$1"
) 
```

如果我去 www.mysite.com/forum 一切正常，但如果我去 www.mysite.com/code.py/forum 我不会像我应该的那样重定向到 404，但实际上获取第一个链接。我基本上想向外界隐藏我的内部。

我查看了错误日志，似乎服务器确实在重写 url，但并没有什么不同。

```
(response.c.300) -- splitting Request-URI 
(response.c.301) Request-URI  :  /code.py/forum 
(response.c.302) URI-scheme   :  https 
(response.c.303) URI-authority:  www.mysite.com 
(response.c.304) URI-path     :  /code.py/forum 
(response.c.305) URI-query    :   
(response.c.300) -- splitting Request-URI 
(response.c.301) Request-URI  :  /code.py/404 
(response.c.302) URI-scheme   :  https 
(response.c.303) URI-authority:  www.mysite.com 
(response.c.304) URI-path     :  /code.py/404 
(response.c.305) URI-query    :   
(response.c.349) -- sanatising URI 
(response.c.350) URI-path     :  /code.py/404 
(mod_access.c.135) -- mod_access_uri_handler called 
(mod_fastcgi.c.3609) handling it in mod_fastcgi 
(response.c.470) -- before doc_root 
(response.c.471) Doc-Root     : /var/www/html 
(response.c.472) Rel-Path     : /code.py 
(response.c.473) Path         :  
(response.c.521) -- after doc_root 
(response.c.522) Doc-Root     : /var/www/html 
(response.c.523) Rel-Path     : /code.py 
(response.c.524) Path         : /var/www/html/code.py 
(response.c.541) -- logical -> physical 
(response.c.542) Doc-Root     : /var/www/html 
(response.c.543) Rel-Path     : /code.py 
(response.c.544) Path         : /var/www/html/code.py 
(mod_fastcgi.c.3035) got proc: pid: 30262 socket: unix:/tmp/fastcgi.socket-0 load: 1 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:11:49.830

尝试这样的事情：

```
url.rewrite-once = (
  "^/favicon\.ico$" => "/static/favicon.ico",
  "^/forum(.*)$" => "/forum/code.py$1"
)

$HTTP["url"] =~ "^/forum(.*)$" { 
  ( "/code.py" => 
    (( "socket" => "/tmp/fastcgi.socket",
       "bin-path" => "/etc/lighttpd/code/code.py",
       "check-local" => "disable",
       "max-procs" => 1,
       "bin-environment" => ("REAL_SCRIPT_NAME" => "")
    ))
  )
} 
```

# authentication - Jenkins + Crowd2 插件：从 3rd 方应用程序执行 API

> ID：13108831
> 
> 赞同：3
> 
> 时间：2012-10-28T12:35:43.130
> 
> 标签：authentication, jenkins, authorization, atlassian-crowd

**目标：**

我想编写一个可以*触发 Jenkins 作业*的应用程序，它本身也可以针对 Crowd 服务器对用户进行身份验证。用户必须在单独的人群组中才能被授权对 Jenkins 采取行动。

**设置：**

我正在使用 Crowd2 插件针对 Atlassian Crowd 2.1 服务器对 Jenkins 用户进行身份验证。

**我的想法：**

现在，Jenkins 有两种远程执行方式：

*   [Jenkins REST API](https://wiki.jenkins-ci.org/display/JENKINS/Remote+access+API)（使用每个用户的令牌进行身份验证）

    可以使用“TOKEN”以如下方式通过此调用触发构建：
    JENKINS_URL/job/JOBNAME/build?token=TOKEN

*   [Jenkins CLI](https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+CLI)（使用 SSH 密钥进行身份验证）

    可以通过命令行工具触发构建，使用 SSH 私钥对用户进行身份验证。

# 令牌方法（REST API）...

... 要求我的应用程序知道 API 令牌。

如何绕过 API 令牌限制？

**将 API 令牌存储在 Crowd 中？**

Crowd2 Jenkins 插件可以将 Jenkins API 令牌存储为群组属性（可以存储在群组用户目录中的用户定义属性），这是一种方式。尽管我认为这可能是一个安全漏洞，因为该属性可能是从在 Crowd 注册的所有其他应用程序中检索到的（这将使他们能够代表用户执行 Jenkins 作业）。

~~**问：**好的方法和足够的安全？~~在我看来，这还不够安全。

**使用我的应用程序人群令牌对 Jenkins 进行身份验证？**

我还尝试通过 Crowd 的 API 生成人群令牌，然后使用该令牌作为 Cookie 请求 Jenkins REST API，希望 Jenkins crowd2 插件针对 Crowd 验证传递的 Crowd 令牌。但它不起作用（当使用我的浏览器中的人群令牌时，通过检查 Firefox 中的页面信息，它当然可以工作）。

我不确定这种方法（如果 crowd2 插件*会*检查传递的令牌）是否存在安全漏洞，以及 crowd-token 机制是否设计为以这种方式工作。不过我敢肯定，这可能会对 Jenkins 的性能产生负面影响，因为每个 API 请求都必须检查令牌是否有效。

**问：**好的方法和可能吗？

# CLI 方法...

...要求我的应用程序知道在 Jenkins 注册的 SSH 私钥。

如果 Jenkins 支持添加 SSH 密钥，这将是一个好方法。我的应用程序可以生成一个 SSH 密钥对（带有随机）密码，并代表用户在 Jenkins 中自动存储公钥。

我认为这是正确的方法，即使它需要扩展 Jenkins 并且可能需要扩展身份验证插件。

**问：**这种方法是否可行且足够安全？

**问：**还有其他方法吗？

我认为 Jenkins 应该实现一个 OAuth 端点来进行授权（如果是 crowd 插件，它必须将授权委托给 Crowd）或者将用户管理与其核心完全分离。我错了吗？

如果有必要，请帮助我改进这个问题。我可以想象我已经混合了两个问题，并且目标描述得不够清楚。

**注意：**在创建后约 1 小时编辑此问题（请参阅我的第 1 条评论）。

# ruby - 不确定的 IRB 完成行为？

> ID：13108832
> 
> 赞同：2
> 
> 时间：2012-10-28T12:36:01.680
> 
> 标签：ruby, irb, ruby-1.9.3

我是在 irb 中发现错误还是我在这里遗漏了什么？

*   当 irb 在没有额外初始化的情况下运行并以交互方式加载完成模块时，一切都按预期工作：

> ```
> irb> 'abc'.str<TAB pressed>
> irb> 'abc'.strip
> irb> 'abc Def'.str<TAB pressed>
> irb> 'abc Def'.strip 
> ```

*   但是，当使用`irb -f -r irb/completion`或使用`irb`.irbrc确实包含唯一行时*，*`require 'irb/completion'`奇怪的事情开始发生：

> ```
> irb> 'abc'.str<TAB pressed>
> irb> 'abc'.strip
> irb> 'abc dEf'.str<TAB pressed>
> dEf'.strftime  dEf'.string    dEf'.strip     dEf'.strip!
> irb> 'abc Def'.str<TAB pressed>
> <no possible completions are displayed> 
> ```

字符串中的空格和空格后面的大写字母会以某种方式破坏完成代码，但前提是完成模块是以非交互方式加载的！

> ```
> Ruby 1.9.3p286
> Irb 0.9.6
> Linux x86_64 
> ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T13:51:36.460

默认情况下，irb 没有`tab completion`启用。

上面的第一组 irb 交互示例正在工作，因为您以其他方式启用了该功能。很可能[`wirble`gem](http://pablotron.org/software/wirble/)或[`bond`gem](http://tagaholic.me/bond/)或其他类似的 gem 正在 irb 上下文中加载。

将 ~/.irbrc 文件重命名为其他名称，这样它就不会加载到 irb 中，然后重试。选项卡完成不应该工作。

我用 . 确认了选项卡完成行为`'abc Def'.str`。似乎是 irb 选项卡完成功能中的错误。

简要挖掘[irb tab 完成的代码](https://github.com/ruby/ruby/blob/trunk/lib/irb/completion.rb)，我还没有弄清楚为什么会发生这种情况。:-)

# mysql - 如何在 MySQL 表中查找特定列名并清除结果？

> ID：13108833
> 
> 赞同：0
> 
> 时间：2012-10-28T12:36:13.987
> 
> 标签：mysql, pdo, prepared-statement

我正在尝试执行 PHP/MySQL 查询以对单个记录执行以下操作：

1.  在 users 表中查找所有以“_abc”结尾的列名
2.  清除单个记录的这些字段（即 user_id）
3.  将其余列中的数据单独保留

我以前从未对数据库信息模式做过任何事情，所以任何帮助都会很棒！

就像是...？

```
$sth = $dbh->prepare("DESCRIBE users
                      WHERE column_name LIKE '_abc'
                      AND id = $user_id");

$sth->execute(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:38:22.720

```
SELECT column_name
FROM information_schema.columns
WHERE table_schema = 'db_name'
AND table_name = 'users'
AND column_name like '%_abc'; 
```

然后在更新语句中使用返回的列名

```
update users 
set col1_abc = null, col2_abc = NULL
where id = $user_id 
```

# hibernate - var 是集合，而不是项目

> ID：13108838
> 
> 赞同：3
> 
> 时间：2012-10-28T12:36:58.063
> 
> 标签：hibernate, primefaces

我正在遍历“RSVP”对象的集合，并像这样打印出每个人的“名称”属性的值

```
<p:dataTable id="rsvpDataTable" var="rsvp" value="#{eventController.event.rsvps}"...
   <h:outputText value="#{rsvp.name}" />
</p:dataTable> 
```

但我得到了错误：类'org.hibernate.collection.internal.PersistentSet'没有属性'name'

相反，如果我打印出 'rsvp.class.name' 以查看它是什么类型，它确实是一个 PersistentSet。

但为什么？它应该是集合中的单个 RSVP 实例。

如果我调试代码并在 getRsvps() 处停止，我可以看到它正在返回一个包含我的 RSVP 对象的 PersistentSet。RSVP 与 Event 具有双向关系。会不会造成这种情况？

实际上，我对它是否也是 PersistentSet 有点怀疑，我原以为它现在会被转换回普通的“Java”集，但也许不是。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-28T14:39:18.363

您不能遍历 a `Set`，这是目前 JSF 的限制。JSF 2.2 将能够做到这一点。

也就是说，您可以自己转换它，或者我会做的，您可以使用[OmniFaces `#{of:setToList}`EL 函数](http://showcase.omnifaces.org/functions/Converters)。您不必重新发明轮子。:)

另请参阅BalusC 的[这个答案](https://stackoverflow.com/a/7712593/1363540)。

* * *

至于 Hibernate 返回 a 的事实`PersistentSet`，这就是它的工作方式。Hibernate 有自己的实现`Set`，所以它可以实现延迟加载等特性。

# javascript - 限制和更改沿 jQuery UI 的 datepicker 使用的选择列表值

> ID：13108839
> 
> 赞同：1
> 
> 时间：2012-10-28T12:37:05.267
> 
> 标签：javascript, jquery, jquery-ui

我正在使用 jQuery UI 的 datepicker 来显示带有选择列表的日历。输入字段和选择列表是同步的，因此当您更改日期选择器或选择列表的值时，其他字段的值将相应更改。

日期选择器与限制日期范围功能一起使用 (http://jqueryui.com/datepicker/#min-max)。这完美地完成了它的工作 - 结束日期不能早于开始日期，您无法相应地选择前几天。当然，您也不能选择 START 日期在 END 日期之后。

问题出在选择列表上。即使“限制日期范围”发挥了作用，您仍然可以使用选择列表选择任何日期。因此，当您使用选择列表时，我正在寻找此解决方案（如果您只使用日历图标，它应该不会影响任何事情）：

1.  如果您首先选择开始日期，则结束日期应自动更改为所选日期后的一天。

2.  如果您选择了两个日期并决定将 START 日期更改为 END 日期之后的日期，则 END 日期应再次更改为一天后。

3.  如果您选择了两个日期并决定将 END 日期更改为 START 日期之前的日期，则 START 日期应更改为 END 日期的前一天。

我尝试使用这段代码来影响#1 和#2：

```
$('#start').change(function() {
  var date2 = $('#start').datepicker('getDate', '+1d');
  date2.setDate(date2.getDate()+1);
  $('#end').datepicker('setDate', date2);
}); 
```

但是，它似乎不会影响任何事情。这是 jsFiddle 上的整个示例：

[http://jsfiddle.net/JW4jg/](http://jsfiddle.net/JW4jg/)

# android - 如何在android上实现实时音频处理？

> ID：13108845
> 
> 赞同：1
> 
> 时间：2012-10-28T12:37:56.940
> 
> 标签：android, multithreading, audio, real-time, signal-processing

我正在尝试实现音频处理器和android，其中输入将生成正弦波，然后会产生一些效果（回声、失真等），所以我应该如何设计关于线程和缓冲的应用程序。

如果有任何应该遵循的架构，请提供帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T13:11:16.167

建议：

在流模式 ( ) 中使用 AudioTrack 对象，`AudioTrack.MODE_STREAM`并使用循环不断地`AudioTrack write`从专门的非 UI 线程调用阻塞来为其提供数据。该线程从其他线程准备数据的循环缓冲区中读取。

请注意，即使最小内部音频缓冲区大小受系统限制（请务必检查 AudioTrack 对象的构造结果），您也可以将数据写入更小的块中，这可以减少平均延迟。

避免进行浮点运算，尤其是实时计算三角函数（例如正弦）和浮点/整数转换；提前准备尽可能多的波形，并将它们存储在循环表中；保持您的 PCM 幅度为浮点形式，直到最后一步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:12:03.283

Gstreamer 已移植到安卓。它是一个用于处理多种格式以及实时播放、转码和创建效果的框架。

如果您无法从现有的参数中找到正确的参数化，则可以轻松构建自己的过滤器。

# android - Android MediaPlayer - 重新审视同时下载和流式传输

> ID：13108846
> 
> 赞同：7
> 
> 时间：2012-10-28T12:38:07.110
> 
> 标签：android, android-mediaplayer, android-2.2-froyo

以前有人问过这个问题，但现在有了较新版本的 Android（直到 Jelly Bean），我想知道在同时下载和流式传输文件方面是否有任何进展。从 API 来看，这看起来并不可能，因为这些是可用的 setDataSource 方法：

```
void    setDataSource(String path)
Sets the data source (file-path or http/rtsp URL) to use.
void    setDataSource(Context context, Uri uri, Map<String, String> headers)
Sets the data source as a content Uri.
void    setDataSource(Context context, Uri uri)
Sets the data source as a content Uri.
void    setDataSource(FileDescriptor fd, long offset, long length)
Sets the data source (FileDescriptor) to use.
void    setDataSource(FileDescriptor fd)
Sets the data source (FileDescriptor) to use. 
```

不幸的是，它不接受任何类型的 InputStream。有一些示例使用旧的 NPR 代理代码在 Android 应用程序中打开本地 Web 服务器，远程下载内容，并将请求的数据输出到任何侦听套接字，但是该代码已超过 2 年，仍然用作标准完成这项任务（即使很多人报告说存在口吃问题等）。

我已经研究了 MediaPlayer 类并希望扩展它以允许这种行为但是很多实现是通过本机代码完成的，并且根据我的阅读，不同的设备制造商以不同的方式实现本机音频功能（如果是这样的话，我不想碰它！:)）。

那么，在不丢弃数据的情况下**，存储和同时流式传输来自远程服务器的传入音频数据（MP3 或 OGG）的最佳方法是什么？**最好使用 Android 2.2 及更高版本，但对任何可用 API 的输入将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-05T05:20:15.657

建立本地代理是您最好的选择。我没有看过 NPR 的例子，但我做过类似的。[在这里](https://stackoverflow.com/questions/12701249/getting-access-to-media-player-cache)查看我的答案。

# php - 在 PHP 中检查 URL 的更好方法

> ID：13108849
> 
> 赞同：0
> 
> 时间：2012-10-28T12:38:44.983
> 
> 标签：php, arrays, pattern-matching

有没有更好的方法或优雅的方法来做到这一点？我一直在使用此代码根据提供的模式检查数据库中的类似 url。

```
 $menu_selected = '';
$uri_array = explode('/','commodity/statement/flour/factory/');
    $menus = array(
        'commodity/search/flour/factory/index',
        'commodity/statement/sugar/branch/index'
    );

    $pattern_parts = explode('/', '=/*/=/=/*');

foreach ($menus as $menu) {
    $url_parts = explode('/',$menu);

    if( count($pattern_parts) == count($url_parts) ){

        #[i] Trim down for wildcard pattern
        foreach($pattern_parts as $i => $part ){
            if( $part == '*' ) {
                unset($pattern_parts[$i]);
                unset($url_parts[$i]);
                unset($uri_array[$i]);
            }
        }

        #[i] Join array and compare
        if( join('/', $uri_array) == join('/', $url_parts) ) {
            // Found and return the selected
            $menu_selected = $menu; 
            break;
        }
    }
} 
```

# ssh - 在中国，对不断终止的目录进行 tar 处理。[防火墙问题？]

> ID：13108850
> 
> 赞同：0
> 
> 时间：2012-10-28T12:38:49.653
> 
> 标签：ssh, migration, firewall

背景：我位于中国，使用 VPN 服务将我的连接路由到美国。我正在使用 SSH 连接到美国的服务器。

我正在尝试帮助将托管在 GoDaddy 上的服务器转移到 Bluehost。我从 GoDaddy 使用的服务器服务支持很差，并且没有 rsync、scp 或 git。我决定压缩我移动的内容目录，并在新服务器上执行 wget pull。

问题是当我运行 tar 时，我得到一个 TERMINATED 语句。我现在尝试运行 tar 几次，但每次我得到一个 TERMINATED 语句。我不应该总是在同一个地方。

上次我这样做时，我通过查看其进程的内容来运行 tar。我注意到，当它通过一个带有锚标签的声明“中美空中飞机相撞事件”到一个在中国被封锁的网站时，它就终止了。

我想知道，即使我通过 SSH 连接到美国的服务器，tar 是否有可能因为中国防火墙而中断？这是我不太了解的问题。我想问一下是否有人理解这个问题的原因。

（ps：如果有人有更好的方法从托管服务器传输文件，我正在寻找替代方案）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:42:07.043

据我所知，糟糕的共享托管服务器，我发现某些内存监视器更有可能`tar`因为内存消耗或类似原因而杀死您的进程。

# ruby - 在 update_attribute 中使用变量而不是符号

> ID：13108854
> 
> 赞同：0
> 
> 时间：2012-10-28T12:39:34.420
> 
> 标签：ruby, activerecord

我对这一切都很陌生，所以请对我的知识做最坏的假设。关于

```
record = tablename.new
result["top"].each do |r|    #result is the answer from a variable length JSON
  if ActiveRecord::Base.connection.column_exists?(:tablename, r["aaa"]["bbb"] )
    record.update_attribute(r["aaa"]["bbb"] , r["ccc"] )
  else
    ActiveRecord::Base.connection.add_column(:tablename, r["aaa"]["bbb"] , :integer )
    #record.update_attribute( r["aaa"]["bbb"] , r["ccc"] )
  end
record.save 
```

我收到此错误，因为我在 update_attribute 中使用变量而不是符号：

```
undefined method `stringify_keys' for "contents of r["aaa"]["bbb"]":String (NoMethodError) 
```

但是我不能使用符号，因为我实际上并不知道列的名称 - 它都是动态生成的，正如您从这一行中看到的那样：

```
ActiveRecord::Base.connection.add_column(:tablename, r["aaa"]["bbb"] , :integer ) 
```

简而言之，我怎样才能适应具有 update_attribute 的可变列名？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T12:56:15.617

您可以使用[String#to_sym将字符串转换为符号](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-to_sym)

```
record.update_attribute(r["aaa"]["bbb"].to_sym , r["ccc"] ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:44:36.917

对不起，但没有足够的评论点。

edouardbriere 回答了您的问题，但您能解释一下您的用例吗？由于某些数据而编辑架构几乎永远不会接近正确的做事方式。

# c - Shellcode c语言

> ID：13108856
> 
> 赞同：1
> 
> 时间：2012-10-28T12:39:36.310
> 
> 标签：c, shellcode

```
char sh[] = "\x31\xc0\x31\xdb\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68"
"\x68\x2f\x2f\x62\x69\x89\xe3\x52\x53\x89\xe1\xb0\x0b\xcd\x80"; 
```

为什么程序员对这个字符串使用十六进制编码？例如，为什么使用`\x31`第一个字符而不是`1`?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T12:59:07.813

我通过反汇编程序运行了您的代码。该数组似乎包含一些 x86 linux 的 shellcode：

```
804a014:    31 c0           xor    %eax,%eax   #set registers to zero
804a016:    31 db           xor    %ebx,%ebx
804a018:    31 c9           xor    %ecx,%ecx
804a01a:    31 d2           xor    %edx,%edx
804a01c:    52              push   %edx        #push a null word
804a01d:    68 6e 2f 73 68  push   $0x68732f6e #push "/bin/sh"
804a022:    68 2f 2f 62 69  push   $0x69622f2f
804a027:    89 e3           mov    %esp,%ebx
804a029:    52              push   %edx        #push another null word
804a02a:    53              push   %ebx        #push pointer to string
804a02b:    89 e1           mov    %esp,%ecx
804a02d:    b0 0b           mov    $0xb,%al    #system call 11: execve
804a02f:    cd 80           int    $0x80       #call the system 
```

显然，它`/bin/sh`在内存中组装字符串，然后尝试调用该程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T12:42:31.893

虽然`sh`是`char`元素数组，但也可以认为是字节数组。好吧，假设`char`它通常是 8 位宽。

因此，如果此变量包含代码，则将其表示为字节数组而不是文本数组会更清楚。例如，可能存在不容易表示为可打印字符的元素。由于内容将由编译器或汇编器生成，因此它最初采用二进制代码块的形式。将其转换为您提供的十六进制表示是最简单和最清晰的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T12:44:56.203

它是十六进制转义序列。

> **C11 (n1570)，第 6.4.4.4 节字符常量**
> 
> 反斜杠后面的十六进制数字和`x`十六进制转义序列中的字母被视为整数字符常量的单个字符或宽字符常量的单个宽字符构造的一部分。如此形成的十六进制整数的数值指定所需字符或宽字符的值。

要执行它，您可以使用函数指针强制转换。

```
void (*shell)();
shell = (void(*)()) (&sh);

shell(); 
```

# c# - 无法在 Windows 商店应用程序的 XAML 中使用 mediaelement 播放视频

> ID：13108861
> 
> 赞同：1
> 
> 时间：2012-10-28T12:40:42.727
> 
> 标签：c#, xaml, windows-8, windows-store-apps

我正在尝试在 Windows 商店应用程序的 XAML 中的媒体元素中播放视频文件。但是，每当我尝试通过在源属性中设置指向视频文件的 url 来播放它时，我都会在`MediaFailed`事件中收到以下错误。

```
MF_MEDIA_ENGINE_ERR_SRC_NOT_SUPPORTED : HRESULT - 0xC00D36C4 
```

我的 XAML 如下所示

```
 <MediaElement x:Name="media" AutoPlay="true" Width="300" Height="300" 
              Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="3" Margin="350,300,350,100" MediaOpened="media_MediaOpened"  MediaFailed="media_MediaFailed" /> 
```

在后面的代码中

```
protected override void LoadState(Object navigationParameter, Dictionary<String, Object> pageState)
    {
        var item = (ESPNHelper.VideoGallery)navigationParameter;
        media.Source = item.VideoWebUrl;
        media.Play();

    }

private void media_MediaOpened(object sender, RoutedEventArgs e)
    {
        txtStatus.Text = "Total Duration is " + media.NaturalDuration.TimeSpan.Hours + ":" + media.NaturalDuration.TimeSpan.Minutes + ":" + media.NaturalDuration.TimeSpan.Seconds; 
    }

    private void media_MediaFailed(object sender, ExceptionRoutedEventArgs e)
    {
        txtStatus.Text = "Playback failed";
    } 
```

我在浏览器中尝试了 url 并在那里播放，所以我假设 url 没有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T10:51:58.003

Windows 应用商店应用程序不支持 Flash。

请参阅：http: [//msdn.microsoft.com/en-us//library/windows/apps/hh465143.aspx](http://msdn.microsoft.com/en-us//library/windows/apps/hh465143.aspx)

# javascript - 选择数组的一个元素的惯用方式，概率取决于元素的字段

> ID：13108865
> 
> 赞同：1
> 
> 时间：2012-10-28T12:41:07.667
> 
> 标签：javascript, algorithm, language-agnostic, underscore.js

假设我有这个数组：

```
[{name: "A", works: true}, {name: "B", works: true}, {name: "C", works: false}] 
```

我想要一个函数来选择这个数组的一个元素，比如说`80%`获得一个工作元素的概率（`works: true`）。

我怎么能优雅地做到这一点？将欣赏任何语言的伪代码或代码。

（如果需要我可以使用`underscore.js`，如果使用js）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T12:46:18.983

在您的情况下，首先您愿意掷硬币来决定您是否要选择一个工作元素或更少。这可以在 JS 中完成，`Math.random()`其中返回一个`[0,1]`.

```
value = Math.random() <= 0.8 
```

将 value 设置为 true 80% 的时间。此时您已经知道想要哪种元素，因此您可以随机选择一个并检查是否有效。如果它的类型正确，则返回它，否则选择另一个随机的。

如果您的列表很长，这可能需要很多选择，在这种情况下，您可以拆分列表并保留两个列表（有效的和无效的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T13:03:11.477

功能：

```
function chooser(an_array) {
    var node_found = false;
    var works = Math.random() <= .80;
    while(node_found === false) {
        var node = an_array[Math.floor(Math.random()*an_array.length)];
        if(node.works === works) node_found = true;
    }
    return node;
} 
```

编辑：决定我应该测试它。运行上述函数10000次，效果不错：http: [//jsfiddle.net/YyZfA/4/](http://jsfiddle.net/YyZfA/4/)

# javascript - 如何在我的网站中加载谷歌地图？

> ID：13108871
> 
> 赞同：0
> 
> 时间：2012-10-28T12:41:55.930
> 
> 标签：javascript, google-maps

我的代码是这样的

```
<div id="map" style="width: 200px; height: 200px; border:1px solid #000000; position:absolute">&nbsp;</div>
<script type="text/javascript">
function ShowMap(Longitude,Latitude,Address){
var map = new GMap(document.getElementById("map"));
map.centerAndZoom(new GPoint(Longitude,Latitude),2);
map.addControl(new GLargeMapControl());
var point = new GPoint(Longitude,Latitude);
}
</script>
<script language="javascript">ShowMap('73.15821','22.32316','')</script>        
</div> 
```

在头部标签中

```
<script src="http://maps.google.com/maps?file=api&v=1&key=ABQIAAAAUbVoUU0NAYILZTXJsa42UhQAOjerBL9Cz5dE0cCceAtSlRyy8RSeV_tVtvvlVOxAL55LJfb2kwET3Q" type="text/javascript"></script> 
```

错误是

> ReferenceError: GMap 未定义 [Break On This Error]
> var map = new GMap(document.getElementById("drctmap"));

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:47:39.470

您应该`showMap`在 dom 加载后执行该函数：

```
window.onload = function(){ShowMap('73.15821','22.32316','')); 
```

或者谷歌如何附加加载事件（如[这里](https://developers.google.com/maps/documentation/javascript/tutorial#LoadingMap)所示）：

```
<body onload="ShowMap('73.15821','22.32316','');"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-05T05:14:55.660

您使用的是已弃用的 Google Maps API 版本。如果您真的使用版本 3，您只需使用“Map”而不是“GMap”作为构造函数...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T12:47:17.720

很可能是因为您的文档在执行时没有完全加载`ShowMap()`

尝试将您的脚本包装成`document.onload`or `window.onload`。

# android - Android 服务中错误处理的最佳实践

> ID：13108875
> 
> 赞同：4
> 
> 时间：2012-10-28T12:42:32.487
> 
> 标签：android, exception, error-handling, android-service

我有一个 Android 服务，它使用单独的线程对图像进行一些后台处理。如果这个Service出现错误，或者线程出现更糟的情况，最好的做法是通知启动Activity这个问题，让应用程序恢复到稳定状态（即启动服务之前的状态）。

在服务中，我可以发布 Toast 或 Notification，但这对我没有帮助。我想将问题告知用户，但同时将应用程序恢复到稳定状态。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T08:32:58.580

如果有人搜索这个，我会解释我最终做了什么。

**在服务内部，我添加了一个扩展AsyncTask**的私有类。这就是所有处理完成。

在这个类中，我有一个私有变量“异常”。**doInBackground**方法的内容由 try/catch 包围，任何捕获的异常都存储在“异常”中。在**onPostExecute**方法中，我检查是否设置了“异常”，如果是这种情况，我会发送带有异常详细信息的**广播**PROCESSING_ERROR，以便通知调用活动。

如果您不知道**AsyncTask**、**doInBackground**或**onPostExecute**是什么，您应该阅读以下内容：

*   [http://developer.android.com/guide/components/processes-and-threads.html#AsyncTask](http://developer.android.com/guide/components/processes-and-threads.html#AsyncTask)

*   [http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T16:56:17.317

您可以使用 a`Messenger`在服务和主应用程序之间传递信息。

在您的主要活动中定义一个信使，如下所示：

```
private Messenger = mMessengerCliente = new Messenger(new IncomingHandler());

/**
 * Handler of incoming messages from service.
 */
private class IncomingHandler extends Handler {
    @Override
    public void handleMessage(Message msg) {
        switch (msg.what) {
            case MSG_1:
                //actions to perform on message type 1
                break;
            case MSG_2:
                //actions to perform on message type 2
                break;
            default:
                super.handleMessage(msg);
        }
    }
} 
```

将`Messenger`对象作为`Extra`或绑定到您的服务时传递。

在您的服务中，恢复`Messenger`对象并使用它进行通信：

```
 mMsgClientMain = (Messenger)intent.getExtras().get(EXTRA_MESSENGER);

                Message msg = Message.obtain(null, MSG_1, arg1, arg2);
                msg.replyTo=reply_to; // if you need to have bidirectional communication, pass here the service messenger object
                mMsgClientMain.send(msg); 
```

问候。

# wcf - 异步 WCF

> ID：13108876
> 
> 赞同：4
> 
> 时间：2012-10-28T12:42:42.127
> 
> 标签：wcf, asynchronous

我正在尝试创建一个支持异步调用的 WCF 服务。我遵循了我能找到的所有示例和教程，它们都具有一种同步方法的习惯模式，以及异步开始和结束，例如：

```
[OperationContract(AsyncPattern = false)]
string GetData(int value);

[OperationContract(AsyncPattern = true)]
IAsyncResult BeginGetData(int value, AsyncCallback callback, object asyncState);

string EndGetData(IAsyncResult result); 
```

但是，无论我在客户端做什么，都只会调用同步的 GetData。Fiddler 告诉我消息总是一样的：

```
 <s:Envelope
 xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><GetData
 xmlns="http://tempuri.org/"><value>0</value></GetData></s:Body></s:Envelope> 
```

当我*删除*同步 GetData 接口时，现在可以正确调用 async 方法。

这是正常行为吗？我还应该做些什么来支持方法的同步和异步版本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T12:51:38.323

这是一个普遍的误解。您假设您需要使服务器异步，以便客户端能够进行异步调用。这不是真的。服务器和客户端是 100% 独立的。它们由二进制有线协议分隔。

您在 Fiddler 中看到的消息总是相同的，因为 SOAP 对同步或异步一无所知。在 SOAP 级别，您的决定不会表现出来。出于这个原因，客户端也无法观察您的服务器端决策。

这意味着您可以让服务器同步，仍然有一个真正的异步客户端，或者相反。

无论如何，您应该只在服务器上实现*一种*模式：同步或异步。从不两者兼而有之。摆脱您的一种实现。从功能的角度来看，留下哪一个并不重要。

我从这里的评论中提取重要信息：

> 很难将有关何时使用服务器端异步的解释放入此评论框中。简而言之，默认情况下不要在服务器上使用它。如果特殊情况使其具有吸引力或必要性，请使用它。
> 
> 在元级别上，让我指出异步 IO 已成为一种不应掉以轻心的时尚。社区现在处于非常不幸的错误信息状态。

# c# - 如何创建一个等待类？

> ID：13108877
> 
> 赞同：1
> 
> 时间：2012-10-28T12:43:17.600
> 
> 标签：c#, windows-runtime, async-await

> **可能重复：**
> [构造函数可以是异步的](https://stackoverflow.com/questions/8145479/can-constructors-be-async)

我有一个类示例，它从互联网上提取了一些关于创建的信息。

```
public class Example
{
    string information;    

    public Example()
    {
        //Pull information
    }
} 
```

现在我想让 Example 成为可等待的，因为在创建后继续该部分之前创建 Example 很重要。

```
public async void SetupSomething()
{
    Example ex = new Example();
    await ex;
    // Do something with ex
} 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T13:17:14.500

好吧，构造函数应该等到它完成它的东西。毕竟，用于创建它的线程来自调用它的方法。

但是，我认为非常重要的是向我们展示构造函数在做什么。很有可能它正在某个地方调用某个启动另一个线程并且不等待它解决的东西，从而使构造函数返回而没有您正在谈论的所有“信息”。

可能类似于：[C#：阻塞函数调用直到满足条件](https://stackoverflow.com/questions/2213783/c-sharp-blocking-a-function-call-until-condition-met)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:29:35.463

您可以这样做，但我认为这不是一个好方法，因为`await`在您开始使用实例之前没有任何强制要求。

我认为一个好主意是创建创建对象的静态异步方法。就像是：

```
class Example
{
    private Example()
    {
    }

    private async Task InitializeAsync()
    {
        // get the required data asynchronously here
    }

    public static async Task<Example> CreateAsync()
    {
        var result = new Example();
        await result.InitializeAsync();
        return resul;
    }
} 
```

# c - 在 c 中：我可以通过引用指向要从中复制的数组中插槽位置的指针来一次复制整个数组的一部分吗？

> ID：13108878
> 
> 赞同：0
> 
> 时间：2012-10-28T12:43:31.610
> 
> 标签：c, arrays, pointers, copy

希望我的问题是明确的和相关的，新的指针...... - 我可以一次复制整个数组的一部分，通过引用指向我想要开始复制的数组中第一个插槽的位置的指针吗？

例如 - 给定一个数组：A [ 1,2,3,4,5,7,8,3,2,5,1,0,9] - 我只想从 n' 复制数组的一部分第一个插槽，进入数组 B [0 0 0 .....] 的开头（B 与 A 的长度相同）。

我可以立即使用指针而不是循环吗？类似于 - 将指向 B 中第一个插槽的指针切换到 A 的第 n 个插槽，将 B 中的第 n 个插槽与 A 中的最后一个插槽切换？

非常感谢提前！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T12:47:20.640

这[`memcpy`](http://en.cppreference.com/w/c/string/byte/memcpy)就是为了。

```
memcpy(B, A + n, (N - n) * sizeof(A[0])); 
```

其中`N`是 中的元素个数`A`。如果`A`真的是一个数组（不仅仅是指向一个的指针），那么`N`可以[计算](https://stackoverflow.com/questions/4162923/calculate-length-of-array-in-c-by-using-function)为`sizeof(A) / sizeof(A[0])`，因此调用简化为

```
memcpy(B, A + n, sizeof(A) - n * sizeof(A[0])); 
```

`memcpy`住在`<string.h>`; 它的第一个参数是副本的目标，第二个参数是源。

（对不起，我并没有真正遵循您想到的指针技巧，所以我无法对此发表评论。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:05:41.103

我想我明白你在问什么。您*可以*使用指针来设置您的第二个数组，但这样做的问题是：

```
int [] primary = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 0 };
int * secondary = primary + 5; 
```

此时primary是{1, 2, 3, 4, 5, 6, 7, 8, 9, 0}，secondary是{6, 7, 8, 9, 0}，但问题是它们都指向到内存中的同一个数组。因此，如果您编辑“次要”的任何元素，而不是拥有两个独立的副本，它们也会在“主要”中进行编辑。

```
secondary[2] = 10;
for(int i = 0; i < 10; ++i)
  cout << primary[i] << ' '; 
```

这部分代码现在将产生： 1 2 3 4 5 6 7 10 9 0

正确的方法是要么设置新数组，然后循环复制值，要么使用[memcpy()。](http://www.cplusplus.com/reference/clibrary/cstring/memcpy/)

编辑：

```
//Rotate an array such that the index value is moved to the front of the array
null rotateArray( &int original[], int size, int index)
{
  int * secondary = new int[size]; //dynamically allocated array
  for(int i = 0; i < size; ++i)
  {
    secondary[i] = original[(i+index)%size];
  }
  original = secondary; //Move the original array's pointer to the new memory location
} 
```

一些注意事项：

```
secondary[i] = original[(i+index)%size]; 
```

这就是我旋转阵列的方式。假设您有一个大小为 5 的原始数组，并且您希望第四个元素成为新的开始（请记住，元素编号为 0-(size-1)）：

我 = 0;

次要[0] = 原始[(0 + 3)%5]// = 原始[3]

我 = 1;

次要[1] = 原始[(1 + 3)%5]// = 原始[4]

我 = 2;

次要[2] = 原始[(2 + 3)%5]// = 原始[0]

...

代码的最后一部分：

```
original = secondary; 
```

有点可疑，因为我不记得一旦函数退出，c++ 是否会尝试清理使用的内存。一种更安全且 100% 确定的方法是循环遍历辅助数组的元素并将其复制到原始数组中：

```
for(int i = 0; i < size; ++i)
  original[i] = secondary[i]; 
```

# regex - 从 Rails 3 中的 JSON 响应中去除数字？

> ID：13108884
> 
> 赞同：1
> 
> 时间：2012-10-28T12:43:45.533
> 
> 标签：regex, database, ruby-on-rails-3, json

我在 Rails 3 应用程序中收到了 JSON 帖子。然后我解析每个值并将它们插入到应用程序数据库中。一切正常，但现在我想在将接收到的值插入数据库之前对其进行修改。

```
:subject => email_payload['subject'] 
```

如上面的代码所示，我将接收到的“主题”值插入名为“主题”的列中。

在上面的示例中，接收到的值是这样的：

```
Results from Example Company - Surname/Firstname/[12345] 
```

我想做的是将除[]之间的数值之外的所有内容都去掉。所以插入数据库的值很简单：

```
12345 
```

我大概可以从 0-9 中选择任何内容，但是如何将正则表达式添加到接收到的字符串中？

以下似乎都不起作用：

```
['subject.gsub!([0-9])']
['subject'.gsub!([0-9])]
['subject'].gsub!([0-9]) 
```

我在这里测试了正则表达式[http://rubular.com/r/AVFkm3A440](http://rubular.com/r/AVFkm3A440)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T13:07:10.487

由于您将 应用于`.gsub()`散列键返回的值`email_payload['subject']`，因此该方法属于在关闭之外链接`]`。

您的正则表达式缺少`/`分隔符。要捕获整个组，请添加`+`as in `/[^0-9]+/`。将`^`匹配所有非数字字符，然后`.gsub()`将它们替换为空字符串。所以下面的模式将改变`email_payload['subject']`原地的钥匙

```
email_payload['subject'] = 'Results from Example Company - Surname/Firstname/[12345]'

email_payload['subject'].gsub!(/[^0-9]+/, '')
>> "12345"
# gsub!() has mutated the value:
puts email_payload['subject']
>> 12345 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T13:09:50.693

[String](http://www.ruby-doc.org/core-1.9.3/Regexp.html)的 Ruby 文档中的示例：

```
"hello".gsub(/[aeiou]/, '*')                  #=> "h*ll*"
"hello".gsub(/([aeiou])/, '<\1>')             #=> "h<e>ll<o>"
"hello".gsub(/./) {|s| s.ord.to_s + ' '}      #=> "104 101 108 108 111 "
"hello".gsub(/(?<foo>[aeiou])/, '{\k<foo>}')  #=> "h{e}ll{o}"
'hello'.gsub(/[eo]/, 'e' => 3, 'o' => '*')    #=> "h3ll*" 
```

所以 gsub 用于在字符串上全局替换模式。

你可能需要`scan`.

```
"Results from Example Company - Surname/Firstname/[12345]".
   scan(/\[(\d*)\]$/).
   flatten
>> ["12345"] 
```

这假定您要选择的数字位于`[]`括号内，并且`]`位于字符串的末尾。

# c++ - 删除 pthread_t*

> ID：13108886
> 
> 赞同：0
> 
> 时间：2012-10-28T12:44:12.787
> 
> 标签：c++, pthreads

我写了一个小的 pthread 多线程编程，我想清理我创建的 pthred_t 数组。但是当我这样做时，我得到了检测到 glib 的错误。我怎样才能删除数组，或者我根本不需要。代码在没有释放内存的情况下运行良好，但我认为下面的代码会导致（小）内存泄漏。谢谢

```
pthread_t* threadNumber = new pthread_t (4);
args var;
var.matrixA=matrixA;
var.matrixB=matrixB;
var.matrixC=matrixC;
var.alpha=alpha;
var.beta=beta;
var.cellCount=0;
var.maxCells=cColumns*cRows;

for (int i =0 ;i<4;++i)
  pthread_create(&threadNumber[i],&attr,matrixMultiply,(void *) (&var));

for(int i=0;i<4;++i)
  pthread_join(threadNumber[i],NULL);

printMatrix(matrixA,aRows,aColumns);
printMatrix(matrixB,bRows,bColumns);
printMatrix(matrixC,cRows,cColumns);

//delete threadNumber;
//this caused a memory trash 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T12:47:16.437

您需要方括号来创建数组：

不是这个：

```
pthread_t* threadNumber = new pthread_t (4);
//                                      ^ ^ 
```

但这是正确的：

```
pthread_t* threadNumber = new pthread_t [4];
//                                      ^ ^ 
```

您的版本是一个 pthread_t 变量初始化为`4`- 无论这`4`在此上下文中意味着什么 - 因为 pthread_t 是不透明类型。

因此，您应该使用错误的版本删除`delete threadNumber`，使用正确的版本删除`delete [] threadNumber`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-28T12:56:01.277

我知道您有 pthreads 的答案，但是我认为您可能会感兴趣考虑以下内容。

```
 std::vector<std::thread> threads;

 for(int i=0; i!=4; ++i) threads.emplace_back(&my_function, args);

 for(auto& th : threads) th.join(); 
```

不需要手动清理，并且可以跨任何兼容的编译器移植，不像 pthread 只能跨 POSIX 平台工作。

但是，如果您尝试将单个问题拆分到多个线程中，您可能还想查看 Intel TBB 等库。

### 参考

[http://en.cppreference.com/w/cpp/thread/thread](http://en.cppreference.com/w/cpp/thread/thread)

[http://en.cppreference.com/w/cpp/container/vector](http://en.cppreference.com/w/cpp/container/vector)

注意：如果您的编译器不支持 C++11（它可能支持），那么 boost 具有 boost::thread ，它具有非常相似的接口和功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T12:46:27.180

`delete[] threadNumber;`删除数组时使用。

# java - Java Map Value Comparator，边插入边排序

> ID：13108887
> 
> 赞同：4
> 
> 时间：2012-10-28T12:44:16.367
> 
> 标签：java, sorting, dictionary, insert

我想使用值比较器将项目插入 HashMap、TreeMap 或 SortedMap（您可能会建议其他一些 api）。

我已经阅读了很多帖子，包括这篇文章[，](https://stackoverflow.com/questions/109383/how-to-sort-a-mapkey-value-on-the-values-in-java)大多数帖子都建议在插入所有项目后将 HashMap 重新插入到带有值 Comparator 的 SortedMap 中。

我没有兴趣再次重新插入所有值。是不是有一个选项或类似 Map 的数据结构支持在每次插入后激活值比较器？

如果有重复的问题，我会很感激一个链接（我已经做了一些搜索，虽然我可能错过了一些）

**同样，我有兴趣为某种有序 Map 添加一个值，以便在每次插入后所有项目都按值而不是键排序。**

Map 条目中的值实际上是一个带有一些 getter 的复杂对象，我只想按值对象上的特定 getter 进行排序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T13:05:34.720

我想你需要的是[`org.apache.commons.collections.bidimap.TreeBidiMap`](http://commons.apache.org/collections/apidocs-COLLECTIONS_3_1/org/apache/commons/collections/bidimap/TreeBidiMap.html)

> BidiMap 基于红黑树的实现，其中添加的所有对象都实现了 Comparable 接口。
> 
> 此类保证映射将按键升序和值升序排列，根据键和值类的自然顺序进行排序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T13:14:24.497

我有一些解决方法，它并不完美，并且会使用更多的内存，但它相当简单。

我可以扩展 Map 的键来保存 Value 对象的 getter 返回的值，然后我将扩展键 Comparator 以按键的右元组排序。

**更新**

作为一个具有非常好的性能的魅力。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-28T12:54:06.720

地图都是关于从键到值的。Guava 有一个[双向映射](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/BiMap.html)的概念，但您并不真正关心从值到键，而是公开值的排序迭代。我推荐的是一个自定义容器，它可以容纳 HashMap 和[Priority Queue](http://docs.oracle.com/javase/6/docs/api/java/util/PriorityQueue.html)。

因此，扩展 Map、Collection 和 Iterable 接口，并将插入添加到 HashMap 和优先级队列中。当您迭代时，迭代队列，当您搜索/进入地图时。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-12-06T01:44:50.537

我正在寻找类似的东西，但无法使用，`TreeBidiMap`因为它需要 Map 的键来实现 Comparable 接口。

所以我写了我自己的简约`ValueTreeMap`：

```
import java.util.HashMap;
import java.util.Iterator;
import java.util.TreeSet;

public class ValueTreeMap<K, V extends Comparable<V>> implements Iterable<V> {
    private TreeSet<V> tree = new TreeSet<V>();
    private HashMap<K, V> map = new HashMap<K, V>();

    public void put(K key, V value){
        V oldValue = map.get(key);
        if(oldValue != null){
            tree.remove(oldValue);
        }
        tree.add(value);
        map.put(key, value);
    }

    public V get(K key){
        return map.get(key);
    }

    @Override
    public Iterator<V> iterator() {
        return tree.iterator();
    }

} 
```

# perl - 如何将 Plack::Middleware::CSRFBlock 与 Dancer 一起使用？

> ID：13108894
> 
> 赞同：2
> 
> 时间：2012-10-28T12:45:46.360
> 
> 标签：perl, csrf, dancer, plack

我想用`Dancer`.

我尝试使用`Plack::Middleware::CSRFBlock`，但错误提示“CSRFBlock 需要 Session。”。即使我使用`Plack::Session`，表单也没有包含一次性标记的隐藏输入字段。

有什么好的做法可以做到这一点吗？非常感谢任何建议。

我`environment/development.yml`的是：

```
# configuration file for development environment

# the logger engine to use
# console: log messages to STDOUT (your console where you started the
#          application server)
# file:    log message to a file in log/
logger: "console"

# the log level for this environment
# core is the lowest, it shows Dancer's core log messages as well as yours
# (debug, info, warning and error)
log: "core"

# should Dancer consider warnings as critical errors?
warnings: 1

# should Dancer show a stacktrace when an error is caught?
show_errors: 1

# auto_reload is a development and experimental feature
# you should enable it by yourself if you want it
# Module::Refresh is needed 
# 
# Be aware it's unstable and may cause a memory leak.
# DO NOT EVER USE THIS FEATURE IN PRODUCTION 
# OR TINY KITTENS SHALL DIE WITH LOTS OF SUFFERING
auto_reload: 0

session: Simple
#session: YAML

plack_middlewares:
    -
        #- Session
        - CSRFBlock
        - Debug
        - panels
        -
            - Parameters
            - Dancer::Version
            - Dancer::Settings
            - Memory 
```

路线是：

```
get '/test' => sub {
    return <<EOM
        <!DOCTYPE html>
        <html>
        <head><title>test route</title></head>
        <body>
            <form action="./foobar" method="post">
            <input type="text"/>
            <input type="submit"/>
            </form>
        </body>
        </html>
EOM
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T08:56:22.093

好吧，我注意到 Debug 面板没有显示，这意味着 Plack::Middlewares::Debug 没有加载。在 [How to use Dancer with Plack 中间件的帮助下 | PerlDancer Advent Calendar](http://advent.perldancer.org/2010/22)和[Plack::Middleware::Debug::Dancer::Version](http://search.cpan.org/perldoc/Plack%3a%3aMiddleware%3a%3aDebug%3a%3aDancer%3a%3aVersion)我设法打开它

```
session: PSGI
## Dancer::Session::PSGI

plack_middlewares:
    -
        - Session
    -
        - CSRFBlock
    -
        - Debug
## panels is an argument for Debug, as in 
## enable 'Debug', panels => [ qw( Parameters Response Environment Session Timer Dancer::Logger Dancer::Settings Dancer::Version ) ];
        - panels
        -
            - Parameters
            - Response
            - Environment
            - Session
            - Timer
            - Dancer::Logger
            - Dancer::Settings
            - Dancer::Version
#Plack::Middleware::Debug::Dancer::Version 
```

# node.js - 自动完成在 webstorm 中不能与 Node.js 一起使用

> ID：13108900
> 
> 赞同：1
> 
> 时间：2012-10-28T12:46:53.410
> 
> 标签：node.js, webstorm

刚刚下载了 WebStorm 并尝试了 Node.js。

不幸的是，自动完成似乎不起作用。

我已将节点 js 解释器设置为 node.exe，但看到一篇帖子说我应该将其设置为 Node.js 文件。当我使用 Node.exe 时，至少在 Node.js 配置对话框中填充了该版本，但是当我下载代码并选择 Node.js 文件时，我得到“找不到版本”。

无论哪种方式，自动完成都不起作用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-11T15:52:42.830

在执行“文件-> 无效缓存”之后，一切似乎都可以正常工作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-09-13T17:51:44.623

从项目文件夹中删除**.idea**（隐藏）目录并再次打开项目。

`"File->Invalidate cache"`对我不起作用。

# php - 注意：未定义索引：图像在

> ID：13108901
> 
> 赞同：1
> 
> 时间：2012-10-28T12:47:02.583
> 
> 标签：php, database, upload, xampp

> **可能重复：**
> [未定义索引：文件](https://stackoverflow.com/questions/6098261/undefined-index-file)

嗨我现在正在学习如何将图像上传到数据库，但我收到了这个错误/通知

> 注意：未定义索引：第 19 行 C:\xampp\htdocs\Pildibaas\index.php 中的图像

这是我的 index.php 整个代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Image upload</title>
</head>

<body>
    <form action="index.php" method="POST" enctype="multipart/form-data">
        File:
        <input type="file" name="image"> <input type="submit" value="Upload"> 
    </form>

<?php
mysql_connect ("localhost", "root", "") or die (mysql_error());
mysql_select_db ("databaseimage") or die (mysql_error());

?>
</body>

</html> 
```

从 index.php 中删除的第 19 行（此行给出错误）：

```
echo $file = $_FILES['image']['tmp_name']; 
```

从谷歌发现我需要更改 tmp 文件夹的权限，但它已经拥有它需要的所有权限。

在教程中他没有得到这个错误

谢谢你

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-28T12:50:12.570

```
echo $file = $_FILES['image']['tmp_name']; 
```

应该

```
if(isset($_FILES['image'])){
    echo $_FILES['image']['tmp_name'];
} 
```

这首先检查是否`$_FILES['image']`已设置。如果没有，这将不会运行。因此，您不会收到超出索引的错误。

因为你首先要提交表单`$_FILES['image']`才会被设置...

此外，输入标签是自动关闭的，因此您的表单不会是：

```
<form action="index.php" method="POST" enctype="multipart/form-data">
    File:
    <input type="file" name="image"> <input type="submit" value="Upload"> 
</form> 
```

但：

```
<form action="index.php" method="POST" enctype="multipart/form-data">
    File:
    <input type="file" name="image" /> <input type="submit" value="Upload" /> 
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T12:48:28.717

```
echo $file = $_FILES['image']['tmp_name']; 
```

应该

```
echo $_FILES['image']['tmp_name'];
 or 
if(!empty($_FILES) && isset($_FILES['image'])){
  echo $_FILES['image']['tmp_name'];
    } 
```

你也可以使用

```
print_r($_FILES); 
```

# jsf - 如果按下 page1 中的命令按钮，如何在导航后在 page2 中显示对话框？

> ID：13108907
> 
> 赞同：1
> 
> 时间：2012-10-28T12:47:36.437
> 
> 标签：jsf, primefaces

我在 page1 中使用命令按钮。如果按下命令按钮，则流程转到第 2 页。我想仅在按下 page1 中的命令按钮时才在 page2 中显示一个对话框（因此如果直接打开 page2 则不会）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:51:57.653

只需使用`visible`属性。EL 表达式的计算结果必须为 a `boolean`。

例如

```
<p:dialog ... visible="#{bean.page1CommandButtonClicked}"> 
```

# remote-access - 如何从另一台 PC 打开 PC

> ID：13108910
> 
> 赞同：0
> 
> 时间：2012-10-28T12:47:45.143
> 
> 标签：remote-access

我的家用电脑上有一个网络服务器和一个 ftp 服务器，我希望能够在我上学时在我的笔记本电脑上打开它。我认为这将是一个常见问题，但我在 google/SO 上找不到我的答案。那么如何通过互联网从另一台笔记本电脑打开我的电脑呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:49:59.650

您可以使用：

Wake-on-LAN (WOL)，一种以太网计算机网络标准，允许通过网络消息打开或唤醒计算机。该消息通常由在同一局域网上的另一台计算机上执行的程序发送。这是一条 UDP 消息，您几乎可以从任何语言轻松创建它。

请注意，UDP 消息不会通过路由器...

# c# - Fql facebook api 查询

> ID：13108911
> 
> 赞同：0
> 
> 时间：2012-10-28T12:47:57.130
> 
> 标签：c#, .net, facebook, facebook-graph-api

```
 var webRequest = (HttpWebRequest)HttpWebRequest.Create("https://graph.facebook.com/");
            webRequest.Method = "POST";
            webRequest.ContentType = "application/x-www-form-urlencoded";

            var requestString = "fql?q=SELECT status_id, message FROM status 
               WHERE uid=me()";

            byte[] bytedata = Encoding.UTF8.GetBytes(requestString);

            webRequest.ContentLength = bytedata.Length;

            var requestStream = webRequest.GetRequestStream();
            requestStream.Write(bytedata, 0, bytedata.Length);
            requestStream.Close();

            var response = webRequest.GetResponse();
            var responseStream = new StreamReader(response.GetResponseStream());
            var responseString = responseStream.ReadToEnd(); 
```

我正在尝试获取我的 fb 帐户的状态消息，上面的代码抛出了错误的请求，而这个使用 facebook api 获取请求的消息说参数无效

```
 string accessToken = ViewState["accessToken"].ToString();
            Facebook.FacebookClient fb = new FacebookClient(accessToken);
            dynamic me = fb.Get("/me");

            var id = me.id;

            string query = "SELECT status_id, message FROM status WHERE uid=me()";

            var posts = fb.Get("/fql?q=SELECT status_id, message FROM status WHERE uid=me()"); 
```

任何帮助将不胜感激.. facebook 给了我 headbangings.. :\ 最后一件事是上面的查询在 fql graph api 模拟器中完美运行

[https://developers.facebook.com/tools/explorer?method=GET&path=uridfields%3Did%2Cname](https://developers.facebook.com/tools/explorer?method=GET&path=uridfields%3Did%2Cname)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T13:01:41.477

我猜你正在寻找这个：[Facebook Graph API - User](http://developers.facebook.com/docs/reference/api/user/)
Under Connections 你会发现“状态”。

为了获得所有状态的数组，您必须致电`/me/statuses?access_token=ACCESS_TOKEN` 您必须获得`read_stream`许可。

希望我能帮上忙。

编辑：在 WinRT 的情况下：我会以另一种方式调用 Graph API（不知道它是否更好，但它也可以）：

```
// Example Uri
Uri requestUri = new Uri("https://graph.facebook.com/me/statuses?access_token=ACCESS_TOKEN");    

HttpClient client = new HttpClient();
HttpResponseMessage response = await client.GetAsync(requestUri);

string content = await response.Content.ReadAsStringAsync();
return content; 
```

# ios - IOS5 - 如何在以编程方式创建的视图中播放视频？

> ID：13108912
> 
> 赞同：1
> 
> 时间：2012-10-28T12:48:13.457
> 
> 标签：ios, video, opengl-es, view

我正在使用 OpenGL 为 iPad 创建游戏。我使用以下代码在语法上创建了一个视图（具有简单的背景）：

```
- (void) addNewView {    
    UIWindow* window = [UIApplication sharedApplication].keyWindow;
    UIView *polygonView = [[UIView alloc] initWithFrame: CGRectMake ( 60, 0, 900, 900)];
    polygonView.backgroundColor = [UIColor blueColor];

    //here play a movie:-)

    [window addSubview:polygonView];
    [polygonView release];

} 
```

我在窗口的案例切换中使用以下代码显示它：

```
[self addNewView]; 
```

这一切都很好。

但是，当它显示时，我需要帮助才能在此视图中实现视频功能。任何人都可以以代码或相关教程链接的形式为我提供帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T12:55:09.367

看一眼：

[MPMoviePlayerController 类参考](http://developer.apple.com/library/ios/#documentation/mediaplayer/reference/MPMoviePlayerController_Class/Reference/Reference.html) 和 [MPMoviePlayerViewController 类参考](http://developer.apple.com/library/ios/#documentation/mediaplayer/reference/mpmovieplayerviewcontroller_class/Reference/Reference.html)

那应该让你开始。

# hadoop - 无法运行hadoop

> ID：13108913
> 
> 赞同：-2
> 
> 时间：2012-10-28T12:48:20.850
> 
> 标签：hadoop

我是hadoop和ubuntu的新手。我只是想启动 hadoop，我正在尝试这个命令

```
bin/start-dfs.sh 
```

但这会给出以下消息

> bin/dfs.sh 权限被拒绝

我也尝试了这些命令，但无法启动 hadoop。

```
sudo chmod -R og+rx /media/Entertainment/hadoop/bin/

sudo chown -R hadoop /media/Entertainment/hadoop/bin/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T12:50:04.583

您应该制作`.sh`可执行文件。

例如，对于 Hadoop 二进制目录中的所有可执行文件，如下所示：

```
sudo chmod +x bin/*.sh
sudo chmod +x bin/hadoop 
```

# couchdb - 我在哪里可以找到 couchdb 应用程序的列表？

> ID：13108918
> 
> 赞同：1
> 
> 时间：2012-10-28T12:49:31.150
> 
> 标签：couchdb, couchapp, kanso

我已经知道[http://www.couchapp.org/page/list-of-couchapps](http://www.couchapp.org/page/list-of-couchapps)。我找不到 kanso 制作的应用程序列表，甚至找不到翻新应用程序，我敢打赌还有更多。不应该有一个包含所有在 couchdb 上运行的应用程序的站点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T14:11:55.470

试试[http://garden20.com/market](http://garden20.com/market)

那里的所有应用程序还应该有一个指向其源代码的链接。目前都是kanso应用程序。该列表并非详尽无遗，但应该为您制作沙发应用程序提供了一个良好的开端。

免责声明，我编写了 garden20 以使最终用户更容易安装 couchapps。

# mvc-mini-profiler - 如何自定义 Mini-Profiler UI

> ID：13108920
> 
> 赞同：3
> 
> 时间：2012-10-28T12:49:48.687
> 
> 标签：mvc-mini-profiler, mvcminiprofiler

我已经在我的 MVC 4 应用程序上安装了 Mini-Profiler，它的工作就像一个魅力。我遇到的唯一问题是 UI 覆盖了我 UI 的关键部分。我可以使用 css 在页面上移动它，但理想情况下我想让它默认为隐藏状态，并使用抽屉按钮使其弹出。我尝试编写一个 javascript 函数来操纵结果显示，但是当我将以下代码放在我的 _Layout.cshtml 文件的底部时，迷你分析器会将它的所有代码放在我的自定义函数之后页面的最底部，所以自定义功能将在探查器之前运行。

```
@MiniProfiler.RenderIncludes() 
<script type="text/javascript">
    $(function() {
        CustomizeMiniProfiler();
    });
</script> 
```

有任何想法吗？理想情况下，我不想修改 Mini-profiler 的源代码，因为我想让 NuGet 的升级变得容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T11:52:31.487

Mini Profiler 的大部分初始化都推迟到 之后`jQuery.ready`，因此 Mini Profiler 对页面加载行为的影响最小。请参阅：[https ://github.com/SamSaffron/MiniProfiler/blob/master/StackExchange.Profiling/UI/includes.js#L597](https://github.com/SamSaffron/MiniProfiler/blob/master/StackExchange.Profiling/UI/includes.js#L597)

我会推荐一个与 Mini Profiler 初始化过程挂钩的拉取请求：

```
MiniProfiler.afterInit(
   function(){
      /* if called after init happens right away, else happens after init */
   }); 
```

# c# - 我在我的网页站点中实现了缓存，但我认为它不起作用

> ID：13108923
> 
> 赞同：1
> 
> 时间：2012-10-28T12:50:08.073
> 
> 标签：c#, .net, caching, razor, webmatrix

# **编辑：**

*有没有办法监控缓存？

* * *

我决定实施缓存来提高产品页面的性能。目前，每个产品页面至少包含 3000 个条目。

使用缓存，这应该会大大改善这些页面的加载时间。但我不确定我的实现是否有效，因为我已经向数据库添加了新记录，并且这些更改反映在浏览器中。

任何想法为什么缓存不起作用？

```
public class Acquire
{
    public class All
    {
        public WebGrid Products(String Range, String Category)
        {
            String cacheItemKey = Range + Category;
            bool cacheHit = true;
            Grid = WebCache.Get(cacheItemKey);

            if (Grid == null)
                cacheHit = false;

            if (cacheHit == false)
            {
                results = database.Products.Where(
                                   x => x.Range == Range && x.Category == Category);

                Grid = new WebGrid(results, canPage: false);

                // Add it to the Cache.
                WebCache.Set(cacheItemKey, Grid, 1, false);
            }

            return Grid;
        }
    }
} 
```

如果您想知道为什么它包含在类和方法中；主要是为了保持页面整洁，减少代码重复，帮助防止错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T13:13:36.607

您需要确保缓存的是查询结果，而不是查询本身。即确保您枚举查询。最简单的方法是使用 results.ToList() 创建您的 webgrid

编辑：这就是我的意思。

```
results = database.Products.Where(
    x => x.Range == Range 
    && x.Category == Category).ToList(); 
```

您可以通过在代码中设置断点来监控缓存，并检查您是否曾经从`WebCache.Get(cacheItemKey)`.*

# android - 模拟器中未收到 GCM 通知

> ID：13108925
> 
> 赞同：2
> 
> 时间：2012-10-28T12:50:46.513
> 
> 标签：android, android-emulator, google-cloud-messaging

我正在开发一个使用 Google Cloud Messaging (GCM) 的 Android 应用程序。我按照这里提到的这些步骤： [http ://www.androidhive.info/2012/10/android-push-notifications-using-google-cloud-messaging-gcm-php-and-mysql/](http://www.androidhive.info/2012/10/android-push-notifications-using-google-cloud-messaging-gcm-php-and-mysql/)

在运行多个模拟器时，数据库可以获取每个模拟器的注册 ID。但不幸的是，我无法收到我的应用服务器（本地主机）发送的任何通知。

你知道什么会导致这个问题吗？

这将不胜感激。

# php - PHP-如何检索过期日期时间

> ID：13108927
> 
> 赞同：-1
> 
> 时间：2012-10-28T12:51:08.623
> 
> 标签：php, codeigniter, datetime

我需要从当前日期时间 + 某个时间开始检索过期日期时间。

例子是：

```
$current_datetime = date('Y-m-d H:m:s');
$expire_time = 24;// 1 day in hours as int() for example ;)

$expire_datetime = date($current_datetime + $expire_time); //don't know how to do this in Y-m-d H:m:s format!! 
```

我想从这个脚本开始写一个帮助库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T12:55:51.650

用这个

```
$expire_datetime = date('Y-m-d H:m:s',strtotime("NEXT DAY")); 
```

或者

```
 $expire_datetime = date('Y-m-d H:m:s',strtotime("tomorrow")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T12:56:08.260

```
$date = date('Y-m-d H:m:s');
$newdate = strtotime ( '+1 day' , strtotime ( $date ) ) ;
$newdate = date('y-m-d',$newdate)
echo $newdate; 
```

# android - 如何在 Eclipse 上使用中文手机？

> ID：13108933
> 
> 赞同：0
> 
> 时间：2012-10-28T12:52:05.660
> 
> 标签：android, eclipse, smartphone

我有一个大问题，我不知道如何解决它。我有一部中国智能手机，一部带有适用于三星 S3 的 Android 4.1 ROM 的 Bluebo L100 FW。我正在使用 Eclipse Juno 开发 Android 应用程序，我想在我的新手机上测试它们。我在[这里](http://developer.android.com/tools/device.html)完成了所有步骤，也尝试[了这个](http://blog.neodoo.es/maznar/android-2/list-of-devices-attached-no-permissions-con-adb/)，但没有任何效果。我确定问题是我必须在 51-adroid 规则中使用的供应商 ID。我也试过三星id和华为。不工作，仍然附有设备列表。使用 ./adb 设备时没有权限。我正在使用Linux顺便说一句。

有什么建议么？

# asp.net-mvc-4 - Web Api XML，如何设置编码、版本、xmlns:xsi 和 xsi:schemaLocation

> ID：13108934
> 
> 赞同：6
> 
> 时间：2012-10-28T12:52:10.647
> 
> 标签：asp.net-mvc-4, asp.net-web-api, xmlserializer, xml-encoding

我正在使用 asp.net MVC4 Web Api。

我已经设定：

```
Dim xml = GlobalConfiguration.Configuration.Formatters.XmlFormatter
xml.UseXmlSerializer = True 
```

我创建了一个指定我需要的 XML 的类，并且效果很好。

我快到了，但我不确定如何设置：

```
<?xml version="1.0" encoding="utf-8"?> 
```

以及如何设置元素属性：

xmlns:xsi 和 xsi:schemaLocation

我可以使用属性设置它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-04-14T14:39:33.680

这个答案延迟了一年，并针对 WebAPI2 进行了测试！

`WebApiConfig`在您的班级中启用 XML 声明

```
config.Formatters.XmlFormatter.WriterSettings.OmitXmlDeclaration = false; 
```

然后添加`schemaLocation`属性或成员（我总是更喜欢属性）

```
public class SampleData
{
    [XmlAttribute(AttributeName = "schemaLocation", Namespace = "http://www.w3.org/2001/XMLSchema-instance")]
    public string SchemaLocation { get; set; }

    //other properties
    public string Prop1 { get; set; }

    public SampleData()
    {
        SchemaLocation = "http://localhost/my.xsd";
    }
} 
```

输出：

```
<?xml version="1.0" encoding="utf-8"?>
<TestModel 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:xsd="http://www.w3.org/2001/XMLSchema" xsi:schemaLocation="http://localhost/my.xsd">
    <Prop1>1</Prop1>
</TestModel> 
```

# java - 将字符串从 JSNI 传递到 Java - GWT

> ID：13108935
> 
> 赞同：0
> 
> 时间：2012-10-28T12:52:36.047
> 
> 标签：java, gwt, jsni

我`String`在 GWT 项目中传递给 Java 方法时遇到问题：

```
public final native String waveIt()/*-{
    var instance = this;
    var data = $wnd.Waverecorder.data();
    var strData = data.toString();
    var arr = strData.split(',');
    for (var i = 0; i < arr.length; i++) {
        var data = arr[i];
        console.log(data);
        instance.@com.mycode.wave.showcase.client.Showcase::updateWave(Ljava/lang/String;)(data.toString());
    }
}-*/; 
```

从 Chrome/Firefox 的控制台日志看，我可以看到我得到了正确的数据（这是我得到的确切日志）：

```
-0.00006103515625
-0.00006103515625
-0.00006103515625
-0.05072021484375
-0.553833007812
 (more data omitted) 
```

当 GWT java 方法接收到它时，`data`它是空的。可能是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T13:22:44.117

你是什​​么意思：

> 当 GWT java 方法接收到数据时，它是空的。

您是在谈论`waveIt()`应该返回的字符串吗？

错误可能`return`是`waveIt()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T17:35:12.573

1.  这个方法应该是无效的，因为你不返回一个字符串 - 你从它调用一个 Java 方法。

2.  查看您的代码，您不需要 var instance = this; 你可以删除实例。在@com 之前。

3.  您声明 var data 两次：循环前和循环内。您可以使用 arr[i] 调用它，而不是使用 data.toString() 调用您的 Java 方法。

# javascript - 文件更改后第二次需要时，Nodejs 需要返回相同的旧文件

> ID：13108936
> 
> 赞同：6
> 
> 时间：2012-10-28T12:52:36.300
> 
> 标签：javascript, node.js, require

所以在我的nodejs服务器文件中，我有一行：

```
tools=require("./tools.js"); 
```

工具文件包含我更改很多的功能等，所以我想不是每次更改时都重新启动服务器，我可以简单地添加一些方法让我重新需要 tools.js，所以我做到了。但是现在的问题是，当我启动程序时，更改 tools.js 并使其重新需要它，它再次需要它，就好像它仍处于第一次需要时的状态一样。什么？

编辑：我不想在文件更改时重新启动应用程序，因为这与重新启动服务器相同，这是我想要阻止的！所以我需要一些让我重新需要它的东西，忽略模块缓存或其他什么。

有什么想法可以帮助我吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-28T15:42:24.987

如果您不想在每次需要时重新启动应用程序，请执行此操作。

```
var path = require('path');
var filename = path.resolve('./tools.js');
delete require.cache[filename];
var tools = require('./tools'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2021-01-20T06:59:31.640

这为我解决了它：

```
let tools = require("./tools.js"); 
delete require.cache[require.resolve("./tools.js")];
tools = require("./tools.js"); 
```

对这个[答案的信任](https://stackoverflow.com/questions/9210542/node-js-require-cache-possible-to-invalidate/11477602#11477602)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-28T12:58:09.500

一旦 node.js require()sa 模块，对 require() 的任何后续调用都会从内存中获取它，实际的模块文件不会再次加载。您需要做的是使用像 nodemon (https://github.com/remy/nodemon) 这样的工具，它会在文件更改时自动重新启动您的应用程序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-28T12:55:43.183

如果我理解正确，您将遇到 Node 的模块缓存。[http://nodejs.org/docs/latest/api/modules.html#modules_caching](http://nodejs.org/docs/latest/api/modules.html#modules_caching)

如果可以的话，您可能想为 Node 寻找合适的重新加载器。例如，请参阅[https://github.com/isaacs/node-supervisor](https://github.com/isaacs/node-supervisor)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-28T12:55:51.947

看看主管。Supervisor 可以在文件更改时自动重新启动应用程序，并且设置简单。

`npm install -g supervisor`

`supervisor app.js`

# c++ - MPI：如何启动三个将在不同线程中执行的函数

> ID：13108937
> 
> 赞同：2
> 
> 时间：2012-10-28T12:53:12.387
> 
> 标签：c++, multithreading, mpi

我有 3 个功能和 4 个核心。我想使用 MPI 和 C++ 在新线程中执行每个函数我写这个

```
int rank, size;
MPI_Init(&argc, &argv);
MPI_Comm_rank(MPI_COMM_WORLD,&rank);
MPI_Comm_size(MPI_COMM_WORLD,&size);
size--;
if (rank == 0)
{
    Thread1();
}
else 
{
    if(rank == 1)
    {
        Thread2();
    }
    else
    {
        Thread3();
    }
}
MPI_Finalize(); 
```

但它只执行 Thread1()。我必须如何更改代码？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T13:00:42.210

打印以筛选变量的当前值`size`（可能不递减），您会发现`1`. 即：“有`1`进程正在运行”。

您可能以错误的方式运行已编译的代码。考虑使用**`mpirun`** （或**`mpiexec`**，取决于您的 MPI 实现）来执行它，即

```
 mpirun -np 4 ./MyCompiledCode 
```

该`-np`参数指定您将启动的进程数（这样做，您 `MPI_Comm_size`将是 4，如您所愿）。

* * *

但是，目前，由于 C++，您没有明确使用任何东西。您可以考虑 MPI 的一些 C++ 绑定，例如[`Boost.MPI`](http://www.boost.org/doc/libs/1_51_0/doc/html/mpi.html).

* * *

我对您提供的[代码做了一些工作。](http://srcboard.com/yfa2e28)我对其进行了一些更改，以生成[此](http://srcboard.com/hjv7w18) **工作**mpi 代码（我以大写字母提供了一些需要的更正）。

供参考：

*   编译（在 gcc、mpich 下）：

    ```
     $ mpicxx -c mpi1.cpp 
     $ mpicxx -o mpi1 mpi1.o 
    ```

*   执行

    ```
    $ mpirun -np 4 ./mpi1 
    ```

*   输出

    ```
    size is 4
    size is 4
    size is 4
    2 function started.
    thread2
    3 function started.
    thread3
    3 function ended.
    2 function ended.
    size is 4
    1 function started.
    thread1
    1 function ended. 
    ```

请注意，这`stdout`可能会搞砸。

您确定以正确的方式编译代码吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T13:39:08.287

您的问题是 MPI 无法将控制台输入提供给许多进程，而只能提供给具有 rank 的进程`0`。由于 中的前三行`main`：

```
int main(int argc, char *argv[]){

    int oper;
    std::cout << "Enter Size:";
    std::cin >> oper;           // <------- The problem is right here

    Operations* operations = new Operations(oper);
    int rank, size;
    MPI_Init(&argc, &argv);
    int tid;
    MPI_Comm_rank(MPI_COMM_WORLD, &tid);
    switch(tid)
    { 
```

所有进程，但排名`0`块等待他们无法获得的控制台输入。您应该`main`如下重写函数的开头：

```
int main(int argc, char *argv[]){

    int oper;

    MPI_Init(&argc, &argv);
    int tid;
    MPI_Comm_rank(MPI_COMM_WORLD, &tid);

    if (tid == 0) {
       std::cout << "Enter Size:";
       std::cin >> oper;
    }
    MPI_Bcast(&oper, 1, MPI_INT, 0, MPI_COMM_WORLD);

    Operations* operations = new Operations(oper);
    switch(tid)
    { 
```

它的工作原理如下：仅 rank`0`显示提示，然后将控制台输入读入`oper`. 然后广播`oper`from rank的值，`0`以便所有其他进程获得正确的值，创建`Operations`对象，然后分支到适当的函数。

# php - Swift Mailer 不发送到“to”，而是发送到 bcc

> ID：13108938
> 
> 赞同：0
> 
> 时间：2012-10-28T12:53:42.927
> 
> 标签：php, swiftmailer, bcc

我正在开发一个与在线论坛相结合的邮件列表系统。邮件输入（通过 Postfix 转发到脚本）有效，在收到电子邮件后，脚本应该处理它并将其发送出去。

处理，一切正常，发送。

我有一个可供少数地址访问的列表 (list@example.com)（例如 user1@ user2@ user3@example.com 和 user1@ user2@ user3@otherdomain.com）

如果一个用户将邮件发送到列表，它将被传递到 php 脚本，则执行处理（检查用户是否具有权限，向消息中添加一些信息，例如注销链接）并将邮件发送给列表收件人.

但我想对来自脚本的外发邮件有这样的行为：

*   发件人是原始发件人
*   To in the mail 是邮件列表 (list@example.com)[X]
*   回复是邮件列表
*   主题已修改
*   身体被修改
*   Real To 是列表的接收者。

**这就是问题所在：** [X] 所以我想发送一封邮件，它只是发送到密件抄送而不是发送到，但有一个收件人地址。

我在 Codeigniter 中使用 swift-mailer。

如果我将它发送到列表本身，我会创建一个无限循环，因为所有邮件都发送到列表

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T13:00:55.610

该`To`字段指示收件人。如果没有`To`收件人，请将该`To`字段留空。

为了解决这个问题并包含一个*不是*`To`收件人的字段，我相信一些列表使用标题：*`X-BeenThere`*

 *```
X-BeenThere: listaddress@domain.org
To: listaddress@domain.org 
```

然后，当列表收到回复的电子邮件时——它会连同你所有的密件抄送“真实”收件人一起做——它可以简单地忽略它，因为它`X-BeenThere`匹配它的地址。这可以防止循环。

我不知道这是多么标准，Swift-Mailer 是否支持它，如果不支持它是如何做到的。[我在gpsd-users](http://lists.nongnu.org/archive/html/gpsd-users)列表中观察到了这个先例。*

# android - 动态添加组件的活动冻结

> ID：13108943
> 
> 赞同：0
> 
> 时间：2012-10-28T12:54:14.840
> 
> 标签：android, custom-component

如果向当前活动/布局添加超过 3 个自己的“组件”，我的应用程序将冻结，LogCat 将堆（碎片情况）增加到 14mb。添加第四个“组件”并且Android要求关闭我的应用程序需要很长时间。

我编写了一个 Activity，它有一些组件（EditTexts）和一个自己的“组件”。我想做一些类似于联系人应用程序（添加号码）但有成分的事情。因此，我创建了一个类 IngredientsLayout，它扩展了 LinearLayout 和一个 Layout xml 文件，其中包含一个 TextView 和一个“添加”按钮，我已将其放置在 Activity-Layout 上。每次我按下添加按钮时，一个带有 3 个 EditTexts 和一个 ImageButton 的成分布局将被添加到当前的成分布局中，它应该“保存”所有添加的成分。

我做错了什么？

成分布局类：

```
public class IngredientsLayout extends LinearLayout {

ImageButton imageButtonAddIngredient;
ArrayList<IngredientLayout> arrayList;

public IngredientsLayout(Context context, AttributeSet attrs) {
    super(context, attrs);
    LayoutInflater inflater = (LayoutInflater) context
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    inflater.inflate(R.layout.ingredients_list, this);

    arrayList = new ArrayList<IngredientLayout>();
    imageButtonAddIngredient = (ImageButton) findViewById(R.id.imageButtonAddIngredient);
    imageButtonAddIngredient.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            LinearLayout layout = (LinearLayout) findViewById(R.id.linearLayoutIngredientsList);
            IngredientLayout ingredientLayout = new IngredientLayout(getContext(), null);
            ingredientLayout.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT,
                    LayoutParams.WRAP_CONTENT));  
            arrayList.add(ingredientLayout);
            layout.addView(ingredientLayout);
        }

    });
}
} 
```

成分_布局.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<merge xmlns:android="http://schemas.android.com/apk/res/android">
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linearLayoutIngredientsList"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >
    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
            android:layout_margin="5dp"
        android:orientation="horizontal" >
        <TextView
            android:id="@+id/textView1"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_gravity="left|center_vertical"
            android:layout_weight="1"
            android:text="@string/ingredients_list_name" />
        <ImageButton
            android:id="@+id/imageButtonAddIngredient"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="@android:color/transparent"
            android:src="@drawable/ic_menu_add_ingredient" />
    </LinearLayout>
</LinearLayout>
</merge> 
```

成分布局类：

```
public class IngredientLayout extends LinearLayout {
public IngredientLayout(Context context, AttributeSet attrs) {
    super(context, attrs);
    LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    inflater.inflate(R.layout.ingredients_list_row, this);
}
} 
```

成分列表行.xml

```
<?xml version="1.0" encoding="utf-8"?>
<merge xmlns:android="http://schemas.android.com/apk/res/android">
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:id="@+id/linearLayoutIngredientRow"
  android:layout_width="match_parent"
  android:layout_height="wrap_content">

  <EditText
      android:id="@+id/editTextAmount"
      android:layout_width="45dp"
      android:layout_height="fill_parent"
      android:layout_weight="0.11"
      android:ems="10"
      android:hint="@string/ingredients_list_listrow_amount"
      android:inputType="numberDecimal" >

      <requestFocus />
  </EditText>

  <EditText
      android:id="@+id/editTextUnit"
      android:layout_width="60dp"
      android:layout_height="fill_parent"
      android:layout_weight="0.06"
      android:ems="10"
      android:hint="@string/ingredients_list_listrow_unit" /><EditText
      android:id="@+id/editTextName"
      android:layout_width="127dp"
      android:layout_height="match_parent"
      android:layout_gravity="left"
      android:layout_weight="0.005"
      android:ems="10"
      android:hint="@string/ingredients_list_listrow_name" />

<ImageButton
      android:id="@+id/imageButton1"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:background="@android:color/transparent"
      android:src="@drawable/ic_menu_cancel" />

</LinearLayout>
</merge> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T13:01:22.570

LinearLayouts 不适用于这种动态访问。你需要做的是一个 ListView 和一个适配器。

每次您将新项目添加到适配器中时，您都会调用 NottifyDataChanged 以使用新项目更新列表视图。

# php - 我可以使用 nginX+Webkit+PHP+SQLite 创建 Mac Appstore 应用程序吗？

> ID：13108944
> 
> 赞同：1
> 
> 时间：2012-10-28T12:54:36.457
> 
> 标签：php, macos, webkit, nginx, app-store

我想使用 Laravel PHP 为 Mac Appstore 开发。有没有包含 Nginx、Webkit 和 Sqlite 的框架，如果没有这样的框架，创建一个有多容易？我知道 titsdk.org 但不会帮助我使用 Laravelphp 框架进行开发。

更新：我不是在问 iOS，我只是想为 OS X 开发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T18:57:49.053

有两种方法：

1) 仅用 PHP 构建完整的应用程序，就有一个名为[miniPHP](http://exvision.net/miniphp/)的框架。这是我在 OS X 上唯一能找到的东西，除了[WinBinder](http://winbinder.org/)（仅限 Windows）。

2) 构建一个基于 Web 的应用程序并将其嵌入到[WebView](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/WebKit/Classes/WebView_Class/Reference/Reference.html)中。OS X GUI 将在 Objective C 中，但应用程序的核心将在服务器上。

我个人认为选项 #1 是个坏主意，因为 PHP 并非旨在作为实例应用程序运行。它更适合用于 Web 应用程序或命令行脚本。

选项 #2 是您的最佳选择。我相信 WebView 与 JavaScript 绑定，可以调用/从 GUI 应用程序调用。我个人没有使用过 WebView，所以我不确定它是如何工作的。我主要是在 iOS 上开发，UIWebView 比较有限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T11:17:19.230

很快，你不能。

PHP 是一种后端语言。虽然您可以使用 OSX 中的 Webkit 引擎来运行您的应用程序，但您的应用程序的 GUI 应该用 Javascript 和 HTML 编写。您可以使用“HTML5 本机应用程序”搜索 google 以获取更多信息。

至于 Nginx，它是一个服务器程序。它服务于服务器但不服务于客户端。任何想在 Mac Store 或 Google Play 中构建应用程序的人都不应涉及 Nginx。

SQLite 在原生应用程序开发中很有帮助，我认为您可以将 SQLite 与您使用的框架提供的某种形式的 API 一起使用。

要获取更多信息，请参阅 PhoneGap 和 Node-webkit，假设您是 Web 开发人员，它们可以帮助您。如果你打算在 OSX 上开发，推荐的方式是 Objective-c 语言和 Cocoa 框架和 Xcode IDE。

# facebook - 使用 fql api 获取组的事件

> ID：13108946
> 
> 赞同：1
> 
> 时间：2012-10-28T12:54:53.303
> 
> 标签：facebook, api, events, facebook-fql, facebook-group

我需要在一个组内显示所有 Facebook 事件。我知道组 ID 和创建者 ID，但我无法显示它们。

我总是在返回中得到 NULL 值，就好像它们不存在一样。我怎样才能让这个代码工作？

*   该组是公开的
*   即使用户未登录，我也想在外部页面上显示事件，以便每个访问者都能看到该组的事件。

代码：

```
facebook = new Facebook(
    array('appId' => $this -> params -> get('appid'), 
          'secret' => $this -> params -> get('secret'), 
          'cookie' => true, // enable optional cookie support
         )
    );

// Get the current access token
$access_token = $facebook->getAccessToken();

$fql = "SELECT name, pic, eid, start_time, end_time, location, description, update_time from event WHERE creator=XXXXXXXXXXX and eid IN ( SELECT eid FROM event_member WHERE uid = " . $this -> params -> get('idfbpage') . ")";    

$fqlResult = $facebook -> api($param); 
```

返回空行，即使该创建者创建的所有事件都可以假设他们仅为该组创建事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T13:06:23.703

您是否尝试过使用 Graph API？

```
/[group-id]/events 
```

我刚刚尝试过，它为我提供了一个组中的所有事件，我也得到了较旧的事件。您还可以轻松获取事件的所有者：

```
/[group-id]/events?fields=owner 
```

您可以只使用应用访问令牌来执行此操作，该令牌的创建方式如下：

```
$access_token = FBAPPID . '|' . FBSECRET; 
```

如果有 Graph API 的解决方案，你应该总是去寻求它。FQL 是一种痛苦。

# php - 使用 jquery、php 和 red bean 检查用户会话

> ID：13108947
> 
> 赞同：0
> 
> 时间：2012-10-28T12:55:06.000
> 
> 标签：php, jquery, authentication, voting, redbean

我已经花了一个多月的时间尝试制作费率系统，我真的开始对使用 jquery 感到厌烦:(

我已经实现了本[教程](http://net.tutsplus.com/tutorials/html-css-techniques/building-a-5-star-rating-system-with-jquery-ajax-and-php/)，但是，本教程允许任何人无限制地投票

我用 mysql DB 成功加入了这个评级系统.. 但我想要但我无法达到的是：

1-检查 $_session ，如果用户没有登录用户，请阻止他/她投票。他们只能看到票数。

2-如果用户已登录，请检查他/她之前是否投票过。如果是，则阻止他/她投票。如果否，则允许他/她为每个产品投票一次。

函数.js

```
 //--------------------------------rating--------------------------------
$(function() { 
 $('.rate_widget').each(function(i) {
            var widget = this;
            var out_data = {
                widget_id : $(widget).attr('id'),
                fetch:1
            };
            $.post(
                'ratings.php',
                out_data,
                function(INFO) {
                    $(widget).data( 'fsr', INFO );
                    set_votes(widget);
                },
                'json'
            );
        });

        $('.ratings_stars').hover(
            // Handles the mouseover
            function() {
                $(this).prevAll().andSelf().addClass('ratings_over');
                $(this).nextAll().removeClass('ratings_vote'); 
            },
            // Handles the mouseout
            function() {
                $(this).prevAll().andSelf().removeClass('ratings_over');
                // can't use 'this' because it wont contain the updated data
                set_votes($(this).parent());
            }
        );

        // This actually records the vote
        $('.ratings_stars').bind('click', function() {
            var star = this;
            var widget = $(this).parent();

            var clicked_data = {
                clicked_on : $(star).attr('class'),
                widget_id : $(star).parent().attr('id')
            };
            $.post(
                'ratings.php',
                clicked_data,
                function(INFO) {
                    widget.data( 'fsr', INFO );
                    set_votes(widget);
                },
                'json'
            ); 
        });

}); 

     function set_votes(widget) {

        var avg = $(widget).data('fsr').whole_avg;
        var votes = $(widget).data('fsr').number_votes;
        var exact = $(widget).data('fsr').dec_avg;

        $(widget).find('.star_' + avg).prevAll().andSelf().addClass('ratings_vote');
        $(widget).find('.star_' + avg).nextAll().removeClass('ratings_vote'); 
        $(widget).find('.total_votes').text( votes + ' votes recorded (' + exact + ' rating)' );
        }
        //--------------------------------END rating-------------------------------- 
```

评级.php

```
<?php
include('functions.php');
require('rb.php');
    R::setup('mysql:host=localhost;  
       dbname=eshop','root','');

     $rating = new ratings($_POST['widget_id']);

    isset($_POST['fetch']) ? $rating->get_ratings() : $rating->vote();  

      class ratings {

    private $widget_id;
    private $data = array();

function __construct($wid) {

    $this->widget_id = $wid;

    $this->data=R::getAll('select id,number_votes,total_points,dec_avg,whole_avg from product' );

}
public function get_ratings() {

    if (!empty($this->data[$this->widget_id])) {
        echo json_encode($this->data[$this->widget_id]);

    }
    else {
        $data['id'] = $this->widget_id;
        $data['number_votes'] = 0;
        $data['total_points'] = 0;
        $data['dec_avg'] = 0;
        $data['whole_avg'] = 0;
        echo json_encode($data);
    } 
}
public function vote() {

    # Get the value of the vote
    preg_match('/star_([1-5]{1})/', $_POST['clicked_on'], $match);
    $vote = $match[1];

    $ID = $this->widget_id;
    # Update the record if it exists
    if (!empty($this->data[$this->widget_id])){
        $this->data[$ID]['number_votes']+= 1;
        $this->data[$ID]['total_points']+= $vote;
    }
    # Create a new one if it doesn't
    else {
        $this->data[$ID]['number_votes'] = 1;
        $this->data[$ID]['total_points'] = $vote;
    }

    $this->data[$ID]['dec_avg'] = round( $this->data[$ID]['total_points'] / $this->data[$ID]['number_votes'], 1 );
    $this->data[$ID]['whole_avg'] = round( $this->data[$ID]['dec_avg'] );

$number_votes=$this->data[$ID]['number_votes'];
$total_points= $this->data[$ID]['total_points'];
$dec_avg=$this->data[$ID]['dec_avg'];
 $whole_avg= $this->data[$ID]['whole_avg'];   

    $save_vote=R::exec('update product set number_votes= :number_votes ,total_points= :total_points ,dec_avg= :dec_avg ,whole_avg= :whole_avg  where id= :ID',
array(':number_votes'=>$number_votes,':total_points'=>$total_points,':dec_avg'=>$dec_avg,':whole_avg'=>$whole_avg,':ID'=>$ID)   );

    $this->get_ratings();
}

}
?> 
```

索引.php

```
function get_new_arrivals(){
$data=R::getAll('select * from product');

foreach ($data as $list)
{
     echo  "<div class='span-6 p_box' ><a href='product_single.php?id=".$list['id']."'><img src='".$list["p_pic"]."'/></a><br/><b>".$list["p_name"]."</b><br/><label>Rent Price: $</label>".$list["p_r_price"]."<br/><label>Buying Price: $</label>".$list["p_b_price"]."<br/>
     <div class='p_choice'>  
    <label>Rate:</label>
    <div id='".$list['id']."' class='rate_widget'>  
        <div class='star_1 ratings_stars'></div>  
        <div class='star_2 ratings_stars'></div>  
        <div class='star_3 ratings_stars'></div>  
        <div class='star_4 ratings_stars'></div>  
        <div class='star_5 ratings_stars'></div>  
        <div class='total_votes'>vote data</div> ";
        if(isset($_SESSION['u_email'])){
         echo "<input type='hidden' id='check_user' value='".$_SESSION['u_email']."'/>";
         }else{
         echo "<input type='hidden' id='check_user' value='guest'/>";
         }
  echo"  </div>  
</div></div>";
} 
```

# dll - C# 使用 XSAMPA 获取单词的音素拼写

> ID：13108949
> 
> 赞同：1
> 
> 时间：2012-10-28T12:55:25.753
> 
> 标签：dll, resources, speech, phonetics

我在互联网上搜索资源和方法，但我只能找到任何链接。

我能找到的唯一可以做到这一点的地方是[这个链接](http://theaccentlab.com/)，您可以在其中输入一个单词，它会为您提供该单词在*SAMPA*中的音位拼写。

[这家伙在](https://stackoverflow.com/questions/10272932/quickest-array-initialization)*xsampa*行中发布了一些东西，但没有提供任何关于他如何获得这些类等的线索。你知道这在 C# 中是否可能，我在哪里可以找到有关这方面的资源？

您的翻译应该如何与 JULIUS 一起使用。

例子：

```
abatement   @ b @i t m @ n t    1   0
abates  @ b @i t s  1   0
abating @ b @i t i N    1   0
abattoir    { b @ t w A: r\ 1   0
abattoirs   { b @ t w A: z  1   0
abbess  { b E s 1   0
abbesses    { b E s @ s 1   0
abbey   { b i   1   0
abbeys  { b i z 1   0
abbot   { b @ t 1   0
abbots  { b @ t s   1   0
abbreviate  @ b r\ i: v i @i t  1   0
abbreviated @ b r\ i: v i @i t @ d  1   0
abbreviates @ b r\ i: v i @i t s    1   0
abbreviating    @ b r\ i: v i @i t i N  1   0
abbreviation    @ b r\ i: v i @i S @ n  1   0
abbreviations   @ b r\ i: v i @i S @ n z    1   0
abdicate    { b d i k @i t  1   0
abdicated   { b d i k @i t @ d  1   0
abdicates   { b d i k @i t s    1   0 
```

是否应该先将其转换为 Sampa，然后将单词替换为与 Juluis 兼容的 X-sampa，或者直接使用一些映射将其转换为 X-Sampa

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T03:08:32.550

听起来你需要一本英语发音词典。一种常用的方法是[CMU 发音词典](http://www.speech.cs.cmu.edu/cgi-bin/cmudict)（[维基百科](https://en.wikipedia.org/wiki/CMU_Pronouncing_Dictionary)），其中列出了 133746 个单词的发音。它作为纯文本文件免费提供（公共领域）。

它使用[自己奇怪的音标](https://en.wikipedia.org/wiki/Arpabet)，但如果您不关心词汇重音，用等效的 X-SAMPA 替换每个音素并不难。例子：

> *堆栈溢出*
> `S T AE K . OW V ER F L OW2 .`

可以转换为 X-SAMPA

> `/st{k Owvr=flOw/`

为每个音素使用查找表。

字典不包含所有的英语单词，但[也有一个工具可以猜测字典中没有的单词的发音](http://www.speech.cs.cmu.edu/tools/lextool.html)。

# sql - 获取已合并到多个表中的第一个表计数

> ID：13108956
> 
> 赞同：1
> 
> 时间：2012-10-28T12:56:07.983
> 
> 标签：sql, sql-server, visual-studio

这是我想要的伪代码。我需要在以下声明中计算拳头工会的数量。

```
SELECT *  
FROM Table1 
UNION 
SELECT Cats.Id + (SELECT COUNT(*) FROM Fist_Union_Result), 
       Cats.Name 
FROM Table2 
```

任何想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:34:55.483

假设第一部分是一个复杂的查询，您可以使用该`with`子句为其设置别名。这允许您在两个地方使用它，联合的顶部和您计算的地方：

```
; with  FirstPart as
        (
        select  *
        from    Table1
        )
select  *
from    FirstPart
union all
select  cats.Id - cnt.cnt
,       cats.Name
from    Table2 cats
cross join
        (
        select  count(*) as cnt
        from    FistPart
        ) as cnt 
```

如果您只想要一个唯一的 ID，您可以将其`union`放在子查询中并标记行 1..N：

```
select  row_number() over (order by Name) as Id
,       Name
from    (
        select  Name
        from    Table1
        union all
        select  Name
        from    Table2
        ) as SubQueryAlias 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:34:29.707

像这样的东西：

```
with first_union_result as (
  select col1, 
         col2
  from table1
), count_from_first as (
  select count(*) as first_count
  from first_union_result
)
select col1, 
       col2
from first_union_result
union all
select cats.id + cnt.first_count,
       cats.name
from cats
  cross join count_from_first as cnt; 
```

如果您试图在整体结果中获得一些唯一的 id 或类似的东西，您最好使用`row_number()`为所有行生成它。

# java - Java将所有表数据添加到列表中

> ID：13108960
> 
> 赞同：1
> 
> 时间：2012-10-28T12:57:02.333
> 
> 标签：java, servlets

```
+--------+-------+-----+
|  Name  |number |qty  |
+--------+-------+-----+
|   ab   |   5   |  7  |
+--------+-------+-----+ 
|   cd   |   1   |  6  |
+--------+-------+-----+ 
|   ef   |   0   |  9  |
+--------+-------+-----+ 
|   gh   |   8   |  2  |
+--------+-------+-----+ 
```

我正在展示这个示例产品表。我需要在不使用结果集的情况下将所有表格日期放入一个 jsp。我试图做到这一点：

```
public Product search(){
    Product p = null;
    ResultSet rs = DAO.fetch("SELECT * FROM Products");
    if (rs.next()) {
        p = new Product();
        p.setNumber(rs.getString("ProductNumber"));
        p.setName(rs.getString("ProductName"));
        p.setQty(rs.getString("ProductQty"));

    }
    return p;
} 
```

我需要将所有表格数据添加到列表中或？？并使用方法返回它我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T12:58:52.790

使您的`search()`方法返回 a`List<Product>`而不是单个`Product`.

```
public List<Product> search(){
    List<Product> products = new ArrayList<Product>();
    ResultSet rs = DAO.fetch("SELECT * FROM Products");
    while (rs.next()) {
        Product product = new Product();
        product.setNumber(rs.getString("ProductNumber"));
        product.setName(rs.getString("ProductName"));
        product.setQty(rs.getString("ProductQty"));
        products.add(product);
    }
    return products;
} 
```

然后，在您的 JSP 文件中，遍历返回的列表：

```
<c:forEach var="product" items="${products}">
    <!-- build your row -->
</c:forEach> 
```

# vb.net - VB.Net“.DLL 已加载，但未找到 DllRegisterServer 入口点”

> ID：13108965
> 
> 赞同：3
> 
> 时间：2012-10-28T12:57:59.620
> 
> 标签：vb.net

我发现很难发现此消息的原因。我下载了 PIA 服务并安装了提取的文件，但是当我使用注册时，`regsvr32 path\file name`我收到了上述消息：

> .dll 已加载，但未找到 DllRegisterServer 入口点

我再次尝试提取 systems32 文件夹中的文件，消息告诉我它们已被提取。但是当我在 system32 文件夹中搜索时，文件不存在。请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-23T09:38:25.007

我今天在同样的问题上苦苦挣扎。这对我来说都很新，但这是我发现的：

RegSvr32 仅适用于设计为可动态链接的 COM 库。正如 Hans Passant 所说：您需要使用 regasm 而不是 regsvr32 来注册 .NET 程序集：

```
regasm assemblyFile [options] 
```

（更多关于 regasm 的信息可以在[这里](http://msdn.microsoft.com/en-us/library/tzat5yw6.aspx)找到。）

对于您的第二个问题：DLL 可能链接到不在您在运行 regasm 时指定的路径中的其他 DLL。[（如此](https://stackoverflow.com/questions/4508012/unable-to-register-dll-using-regsvr32)处所回答。）尝试检查所有依赖项。

# android - 行内容独立的可点击区域

> ID：13108968
> 
> 赞同：1
> 
> 时间：2012-10-28T12:58:13.510
> 
> 标签：android, android-layout, listview

**注意：如果您因为遇到类似问题而来到这里，请确保您阅读并尝试提供的所有答案。似乎在某些情况下，一种可能比另一种更好。所以也做你自己的测试！**

**前言**

我得到了这样的listview的行布局（这是我的真实布局的精简版，所以不要评论包裹在LinearLayout中的单个元素等内容 - 它只是为了说明问题 - 最终版本在那里有更多元素）：

![在此处输入图像描述](../Images/29a54aa34b975a6d54367b0de946dfc2.png)

XML 文件在下面供参考，但我简要描述了我想要实现的目标：

*   蓝色框（图标）和“这里通常是长文本”TextView 是行“真实”内容（`item_main_container`）。它可以是任何东西——它应该是无关紧要的。此图层内容不可点击。事实上（但我刚刚意识到）我应该从下一层显示“蓝色盒子”一半被红色覆盖，一半被绿色盒子覆盖。
*   红色和绿色框是我将行的 OnCliclListeners 绑定到（包裹在`item_click_area_container`）的视图 - 我只希望用户能够点击该行，不管`item_main_container`它的内容是什么（所以这些红色/绿色在应用程序中是透明的） . **注意：**这些在图像上设置为透明，因此您可以`item_main_content`通过它看到，但这仅用于演示目的。另请注意，红色和绿色代表**单独**的操作，我需要能够在`item_click_area_container`图层上有更多元素才能根据用户点击的位置处理更多操作。
*   黄色区域 ( `button_bar_container`) 包含用户可能想要点击的按钮。

所以基本上`item_click_area_container`覆盖`item_main_container`，但不是`button_bar_container`，`item_click_area_container`否则用户将无法点击其任何按钮。从长远来看，它将是：

![在此处输入图像描述](../Images/cd00eb233fba5598629abaeae21f9ea2.png)

布局大纲如下所示：

![在此处输入图像描述](../Images/5290b5d9a7d405b9e0dcc92fe9c3729c.png)

* * *

**问题**

尽管我很努力，但我无法`item_click_area_container`正确地拉伸以覆盖**整体。** `item_main_container`由于`"usually long text here"`文本可以是任意长度，我不知道`item_main_container`. 在下面的 XML 中有`android:layout_height="100dp`- 这适用于我看到所有行元素，但是对于较长的文本`item_click_area_container`高度太小。但是，如果我将其替换为，`android:layout_height="fill_parent"`则整体`item_click_area_container`将不可见，这违背了目的。

* * *

**问题**

1.  为什么这不能按预期工作和/或如何解决？
2.  有没有比使用像我这样的方法`item_click_area_container`（但没有基于 OnTouchListener 的解决方案）更好的方法来获得内容独立的点击区域？

* * *

**布局 XML**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/item_container"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical">

    <RelativeLayout
        android:layout_width="fill_parent" 
          android:layout_height="wrap_content">

        <LinearLayout 
            android:id="@+id/item_main_container"
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content">

            <ImageView 
               android:id="@+id/item_avatar" 
               android:layout_width="40dp" 
               android:layout_height="40dp" 
               android:background="#0000ff" 
               android:src="@drawable/icon_help"/>

            <LinearLayout 
               android:layout_width="fill_parent" 
               android:layout_height="wrap_content" 
               android:orientation="vertical">

               <TextView android:id="@+id/item_body" 
                 android:layout_width="fill_parent" 
                 android:layout_height="fill_parent" 
                 android:text="Usually long text here..." 
                 android:textColor="#ffffff"/>
            </LinearLayout>

        </LinearLayout>

        <LinearLayout 
               android:id="@+id/item_click_area_container" 
               android:layout_width="fill_parent" 
               android:layout_height="100dp">
            <LinearLayout 
               android:id="@+id/green_click" 
               android:layout_width="fill_parent" 
               android:layout_height="fill_parent" 
               android:layout_weight="1" 
               android:background="#7700ff00">
            </LinearLayout>
            <LinearLayout 
               android:id="@+id/red_click" 
               android:layout_width="fill_parent"
               android:layout_height="fill_parent"
               android:layout_weight="2" 
               android:background="#77ff0000">
            </LinearLayout>
        </LinearLayout>

    </RelativeLayout>

    <LinearLayout 
       android:id="@+id/button_bar_container" 
       android:layout_width="fill_parent" 
       android:layout_height="50dp" 
       android:layout_marginTop="3dp" 
       android:background="#ffff00">
    </LinearLayout>

</LinearLayout> 
```

* * *

**编辑#1**

我想我可以使用`OnTouchListener`, 并`onTouch()`检查`event.getAction()`是否`MotionEvent.ACTION_DOWN`读取了事件的 X/Y 并检查视图的边界。这可能会奏效，但如果可能的话，我更愿意单独使用 OnClickListener。更不用说它有助于理解当前的罪魁祸首是什么，尤其是在 ADT 中正确呈现布局

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T19:22:12.747

在这里，您可以使用此布局。简单的解决方案是使用这 4 条线将 的 4 条边`item_click_area_container`与相应的 4条边对齐：`item_main_container`

```
 android:layout_alignTop="@+id/item_main_container"
        android:layout_alignBottom="@+id/item_main_container"
        android:layout_alignLeft="@+id/item_main_container"
        android:layout_alignRight="@+id/item_main_container" 
```

这是带有 wrap_content 高度的布局。没有更多的硬编码大小（：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/item_container"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

        <LinearLayout
            android:id="@+id/item_main_container"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >

            <ImageView
                android:id="@+id/item_avatar"
                android:layout_width="40dp"
                android:layout_height="40dp"
                android:background="#0000ff"
                android:src="@drawable/ic_action_search" />

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:orientation="vertical" >

                <TextView
                    android:id="@+id/item_body"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:text="Usually long text hasdkfn ash jsjkgh sjhgjk hasjkh ash fjk hasdjkh fkjash jkdf hjkasdh fjkhasjkg hjkasjkd hfjkash gsdgh kgh sdfh fjksah djkfasd jkg jsdf asgjf sg sd agfgas fjhasg f asdgf gjhsdg sdjhsdg fasdfjhs agjhfg  adf asdg jh dvhsdvjhas gdh fv gsfjivhdfvjksfgjkdhjhixcgzvjk gdshg dfg v gvgdfgvjkshvjksdgvsdvere..."
                    android:textColor="#000" />
            </LinearLayout>
        </LinearLayout>

        <LinearLayout
            android:layout_alignTop="@+id/item_main_container"
            android:layout_alignBottom="@+id/item_main_container"
            android:layout_alignLeft="@+id/item_main_container"
            android:layout_alignRight="@+id/item_main_container"
            android:id="@+id/item_click_area_container"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >

            <LinearLayout
                android:id="@+id/green_click"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:layout_weight="1"
                android:background="#7700ff00" >
            </LinearLayout>

            <LinearLayout
                android:id="@+id/red_click"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:layout_weight="2"
                android:background="#77ff0000" >
            </LinearLayout>
        </LinearLayout>
    </RelativeLayout>

    <LinearLayout
        android:id="@+id/button_bar_container"
        android:layout_width="fill_parent"
        android:layout_height="50dp"
        android:layout_marginTop="3dp"
        android:background="#ffff00" >
    </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T03:50:50.423

你可以尝试更换你的

```
<RelativeLayout
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content">...</RelativeLayout> 
```

与

```
<FrameLayout
    android:layout_width="wrap_content" 
    android:layout_height="wrap_content">...</FrameLayout> 
```

然后将参数设置`item_click_area_container`为`fill_parent`/`match_parent`使其增长到覆盖与 相同的区域`item_main_container`。

如果您使用扩展类`LinearLayout`来处理红色和绿色区域所需的操作，那么您应该没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T04:16:06.137

你可以做这样的事情。

在 layout.xml android:onClick 中的单个元素上

```
 <LinearLayout 
       android:id="@+id/red_click" 
       android:layout_width="fill_parent"
       android:layout_height="fill_parent"
       android:layout_weight="2" 
       android:background="#77ff0000">
   android:onClick="redAreaClicked"
    </LinearLayout> 
```

在您的 java 文件中使用以下代码编写一个方法 redAreaClicked()。

```
 public void redAreaClicked(View v) {
      RelativeLayout ParentRow = (RelativeLayout) v.getParent();
      final int position = mList.getPositionForView(ParentRow);
      // more code here..
    } 
```

这应该会给你在列表中的位置。即行号。但是要使其正常工作，您必须将所有子视图（彩色视图，在您的情况下为线性布局）移动到单个父级中。使用相对布局我认为这是非常可行的。

否则，您可以使用 view.getId() 并进行比较，以获得父视图。然后确定它在列表中的位置。

您可以对其他颜色区域执行相同操作。

# c++ - 自动创建文件名 C++

> ID：13108973
> 
> 赞同：5
> 
> 时间：2012-10-28T12:58:55.467
> 
> 标签：c++, file, names, const-char

我正在尝试用 C++ 编写一个程序，它会创建一些文件 (.txt) 并在其中写下结果。问题是这些文件的数量在开始时不是固定的，只出现在程序结尾附近。我想将这些文件命名为“file_1.txt”、“file_2.txt”、...、“file_n.txt”，其中 n 是一个整数。

我不能使用连接，因为文件名需要类型“const char*”，而且我没有找到任何方法将“string”转换为这种类型。我还没有通过互联网找到任何答案，如果你能帮助我，我会很高兴。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T12:59:53.723

您可以使用成员函数`const char*`从a 中获取 a。`std::string`[`c_str`](http://www.cplusplus.com/reference/string/string/c_str/)

```
std::string s = ...;
const char* c = s.c_str(); 
```

如果您不想使用`std::string`（也许您不想进行内存分配），那么您可以使用[`snprintf`](http://www.cplusplus.com/reference/clibrary/cstdio/snprintf/)创建格式化字符串：

```
#include <cstdio>
...
char buffer[16]; // make sure it's big enough
snprintf(buffer, sizeof(buffer), "file_%d.txt", n); 
```

`n`这是文件名中的数字。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-28T13:04:11.587

```
 for(int i=0; i!=n; ++i) {
     //create name
     std::string name="file_" + std::to_string(i) + ".txt"; // C++11 for std::to_string 
     //create file
     std::ofstream file(name);
     //if not C++11 then std::ostream file(name.c_str());
     //then do with file
 } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-28T13:06:12.237

...另一种构建文件名的方法

```
#include <sstream>

int n = 3;
std::ostringstream os;
os << "file_" << n << ".txt";

std::string s = os.str(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-28T19:12:58.947

示例代码：

```
#include <iostream>
#include <fstream>
#include <string>
#include <sstream>
using namespace std;

string IntToStr(int n) 
{
    stringstream result;
    result << n;
    return result.str();
}

int main () 
{
    ofstream outFile;
    int Number_of_files=20;
    string filename;

  for (int i=0;i<Number_of_files;i++)
  {
        filename="file_" + IntToStr(i) +".txt";
        cout<< filename << "  \n";

        outFile.open(filename.c_str());
        outFile << filename<<" : Writing this to a file.\n";
        outFile.close();
  }

  return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-08-16T14:24:52.870

我为此使用以下代码，您可能会发现这很有用。

```
std::ofstream ofile;

for(unsigned int n = 0; ; ++ n)
{
    std::string fname = std::string("log") + std::tostring(n) + std::string(".txt");

    std::ifstream ifile;
    ifile.open(fname.c_str());

    if(ifile.is_open())
    {
    }
    else
    {
        ofile.open(fname.c_str());
        break;
    }

    ifile.close();
}

if(!ofile.is_open())
{
    return -1;
}

ofile.close(); 
```

# ios - 使用 ios 上的按钮旋转图像

> ID：13108974
> 
> 赞同：0
> 
> 时间：2012-10-28T12:58:59.750
> 
> 标签：ios, rotation

我试图找到一种方法来实现类似于命运之轮的东西，但每个三角形都是一个按钮，每个按钮都会将用户带到另一个屏幕。你认为最好的方法是什么？

我想编写自己的代码，但作为一个例子，我发现了这个：[http ://www.walnutlabs.com/blog/?p=9](http://www.walnutlabs.com/blog/?p=9)

这对于车轮和动力来说很棒，但我的问题在于按钮。我如何使它们成为三角形，以及如何使它们与图像的其余部分一起旋转？常规子视图会起作用吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:36:23.713

这真的取决于你的具体需求。当然可以通过使用按钮的子视图来实现滚轮的视觉外观，但是您不能使它们在三角形区域中响应。

如果这是不可接受的，我建议为您的轮子创建一个 UIView 子类。在它的`drawRect:`方法中，您可以进行自定义绘图来绘制轮子。然后，您使用`touchesBegan:withEvent:`, `touchesMoved:withEvent:`, `touchesEnded:withEvent:`（也许 touchesEnded 就足够了）方法来跟踪`button`用户触摸了哪个（即您的视图中的区域）并调用适当的方法。

注意：将委托属性添加到自定义视图和协议以处理响应其他地方的触摸的操作可能会很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T06:09:34.780

这并不完全适用，但我认为该项目和评论会很有用： [how-to-create-a-rotating-wheel-control-with-uikit](http://www.raywenderlich.com/9864/how-to-create-a-rotating-wheel-control-with-uikit)

# arrays - 网格总和中其索引小于 K 的点数

> ID：13108981
> 
> 赞同：0
> 
> 时间：2012-10-28T13:00:06.597
> 
> 标签：arrays, algorithm, data-structures

给定一个网格，如果机器人可以探索 X，Y（坐标）的数字总和小于 K 的点，则找出机器人可以导航的点数。

一个明显的解决方案是 O(n^2)。（遍历 2D 矩阵并根据条件接受/忽略一个点）其他是在数组中取 0 到 K-1 个元素，然后找到 2 个元素，使得总和为小于 K。涉及 O(k) 空间和 O(k) 时间。

任何人都可以提出一些更好的方法，在时空方面改进任何东西。我正在寻找更好的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T13:15:53.240

该等式在您的网格中`x+y = K`定义了一条**对角线**，从西北的一点到东南的一点。

![x+y=K 图](../Images/80270c0bdaa7aa9f0842e138baf627f9.png)

如果网格中的点都是 和 的整数值，并且`x`也是整数，那么对角线 ( ) 以南的点数将为。`y``K``x+y < K``K(K-1)/2`

包括对角线 ( ) 在内的网格中的点数`x+y <= K`将为`K(K+1)/2`。

显然，这是在恒定时间内计算的`O(1)`。

# android - 如何防止其他人访问我位于 /data/data/com.xxx/database/test.db 的应用程序数据库

> ID：13108982
> 
> 赞同：0
> 
> 时间：2012-10-28T13:00:05.377
> 
> 标签：android, sqlite

当我们将数据保存在 android 中时，我们总是将它们保存在 sqlite 中。并且数据库总是可以访问他人的。如何保证这些数据的安全性。

我发现一些应用程序的数据库只能访问它们自己，当你尝试打开它们的数据库时，它会说'打开数据库时发生错误，无法打开数据库文件'

PS：我使用'Root Explore'打开xxx.db

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T13:19:37.070

根访问权限允许设备用户或授予管理员权限的应用程序访问设备上的每个文件，因此您不能“隐藏”根文件上的任何文件。

如果这个数据库有你想保密的数据，你必须对其进行加密，请参阅这个项目： [http ://sqlcipher.net/sqlcipher-for-android/](http://sqlcipher.net/sqlcipher-for-android/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T13:03:56.297

其他人可以访问它，因为您的设备已获得 root 权限，并且 root 权限意味着能够授予应用程序通常无法使用的超级用户权限。在“正常”的非根设备上，其他应用程序无法访问这些文件。如果您也想防止在有根设备上偷看内容，您需要加密您的数据库

# java - 依赖注入，模拟来自外部库的东西？

> ID：13108989
> 
> 赞同：0
> 
> 时间：2012-10-28T13:01:37.327
> 
> 标签：java, dependency-injection

我对使用依赖注入很感兴趣，但是我很困惑我应该如何处理没有考虑到 DI 设计的外部库。

例如，如果我有一些构建项目范围内对象的代码，我可以使用接口，然后创建模拟版本以及这些的具体版本。

然而，相同的代码也可能使用外部库来写入数据库或调用 API 或其他任何东西。外部库可能只提供一个具体的实现。

这意味着我的代码将混合具体和抽象的东西，并迫使我在测试其他代码的同时测试外部库。

我应该为所有外部类创建包装器以便可以注入模拟版本吗？这似乎需要做很多工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T20:16:09.233

您还可以使用 Needle 框架轻松测试您的代码 - [http://needle.spree.de/](http://needle.spree.de/)。它与 Mockito 和 EasyMock 很好地集成在一起。Needle 通过分析依赖关系和自动注入模拟对象来减少测试设置代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T13:22:38.910

如果您确实必须创建具体的第三方依赖项的模拟来隔离您自己的单元，您可以使用诸如[Mockito](http://code.google.com/p/mockito)之类的模拟框架来非常轻松地做到这一点，该框架利用了仪器。

单元测试应该通知和加强你的设计决策，而不是驱动它们，你应该能够快速编写它们，以便将大部分精力集中在实际代码的设计和实现上。像 Mockito 这样的现代框架使这成为可能。

# ruby-on-rails - Ruby on Rails：根本无法渲染嵌套属性

> ID：13108991
> 
> 赞同：2
> 
> 时间：2012-10-28T13:01:39.913
> 
> 标签：ruby-on-rails, ruby-on-rails-3, foreign-keys, nested-attributes, has-many-through

我希望能够显示喜欢用户帖子的用户。我将提供一些简单的信息，这样这个问题就不会变得不堪重负。

我涉及三个类：用户、分享和意见。他们的模型也是这样设置的：

```
class User
  has_many :opinions, foreign_key: "fan_id", dependent: :destroy
end

class Share
  has_many :opinions, foreign_key: "like_id", dependent: :destroy
  has_many :likes, through: :opinions
  has_many :agreeables, foreign_key: "fan_id", class_name: "Opinion", dependent: :destroy
  has_many :fans, through: :agreeables
end

class Opinion
  belongs_to :fan, class_name: "User"
  belongs_to :like, class_name: "Share"
end 
```

换句话说： `like_id = share.id`&`fan_id = user.id`

然后在我的控制器中：

```
SharesController
  def show
    @share = Share.find(params[:id])
    @shares = @share.fans.paginate(page: params[:page])
  end 
```

我单击指向 的链接`share_path`，它呈现页面但上面没有任何内容。当我查看我的 SQL 日志时，**我注意到了这个问题：**

`like_id`使渲染的共享 ( ) 与喜欢共享 ( ) 的用户匹配并不是正确的内部加入意见`fan_ids`。

假设`share.id`是 11 和`current_user.id`是 5。它的查询主要包括内部连接意见以具有`like_id` **AND** `fan_id = 11`。

关于如何解决此问题或更实用的替代方法的任何想法？

谢谢你的帮助。

**编辑**

对于任何未来的读者，解决方案如下：

```
class User
  has_many :fans, foreign_key: "fan_id", class_name: "Opinion", dependent: :destroy
end

class Share
  has_many :opinions, foreign_key: "like_id", dependent: :destroy
  has_many :likes, through: :opinions
  has_many :fans, through: :opinions
end 
```

和`SharesController`意见模型保持不变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T14:24:40.597

如果你想得到所有喜欢 a`Share`的用户，下面的代码应该足够了：

```
class User
  has_many :opinions, foreign_key: "fan_id", dependent: :destroy
  has_many :shares, through: :opinions
end

class Share
  has_many :opinions, foreign_key: "like_id", dependent: :destroy
  has_many :fans, through: :opinions # I'm not sure, but you might need to add class_name option here
end

class Opinion
  belongs_to :fan, class_name: "User"
  belongs_to :like, class_name: "Share"
end 
```

在您的控制器中， `@shares = @share.fans.paginate(page: params[:page])`将返回用户（粉丝）列表

编辑：由于您没有使用传统名称（粉丝而不是用户，喜欢而不是分享），您可能需要添加更多选项，例如 inverse_of 和 class_name，但我不太确定

# flat-file - 如何在 informatica 的会话属性中动态赋予平面文件源文件名？

> ID：13108994
> 
> 赞同：1
> 
> 时间：2012-10-28T13:01:47.720
> 
> 标签：flat-file, informatica-powercenter, informatica

我有一个问题，我得到带有日期和时间扩展名的平面文件，如 test_28-10-2012.txt

我可以通过检查源分析器中的属性来获取映射中的平面文件名`AddCurrentlyProcessedFileName`，从那里我可以做我的逻辑，但我的问题是

如何在会话的源文件名属性中动态给出平面文件名。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T09:24:16.263

一种方法是使用间接来源。您可以将会话配置为使用间接源，其中源文件名来自文本文件（列表文件中的每个条目都是会话将读取的源文件）。

然后您可以安排您的代码将该动态文件名添加到该列表文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T07:44:27.977

You can parametrize the name of the source file - in the session properties replace the hard-coded *Source filename* value with a parameter (e.g. $$SOURCE_FILENAME) and define its value in the parameter file:

```
$$SOURCE_FILENAME=test_28-10-2012.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T10:09:09.103

来自 IPC 帮助：

**按事务创建目标文件**

每次集成服务启动新事务时，您都可以生成单独的输出文件。您可以动态命名每个目标平面文件。

要为每个事务生成单独的输出文件，请将 FileName 端口添加到平面文件目标定义。当您连接映射中的 FileName 端口时，集成服务会在每次提交时创建一个单独的目标文件。集成服务根据每个事务中第一行的 FileName 端口值命名输出文件。默认情况下，集成服务将输出文件写入 $PMTargetFileDir。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-15T16:53:46.890

使用创建文件列表的会话前脚本。

**视窗**

```
dir /b part_of_file_name*.txt > FILELIST_NAME.LST 
```

**UNIX**

```
ls part_of_file_name* > FILELIST_NAME.LST 
```

在 Workflow Manager 中编辑会话任务并转到映射选项卡。选择平面文件源。在属性下，输入列表文件名（“FILELIST.LST”）。在源文件名下，将源文件类型的值更改为间接。

# node.js - 如何使用 node.js 从 facebook API 获取 facebook 好友

> ID：13108995
> 
> 赞同：16
> 
> 时间：2012-10-28T13:02:01.353
> 
> 标签：node.js, facebook-graph-api

我正在使用 node.js 中的 facebook connect 开发一个项目。一切都很好，但现在我想从 facebook 获取连接用户的朋友列表，我有用户的访问令牌，但我不知道如何开始从 facebook 获取数据

有什么帮助吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-28T13:04:04.517

从 node.js 使用 facebook API 非常容易，创建一个模块（例如`facebook.js`：）

**`facebook.js`**

```
var https = require('https');

exports.getFbData = function(accessToken, apiPath, callback) {
    var options = {
        host: 'graph.facebook.com',
        port: 443,
        path: apiPath + '?access_token=' + accessToken, //apiPath example: '/me/friends'
        method: 'GET'
    };

    var buffer = ''; //this buffer will be populated with the chunks of the data received from facebook
    var request = https.get(options, function(result){
        result.setEncoding('utf8');
        result.on('data', function(chunk){
            buffer += chunk;
        });

        result.on('end', function(){
            callback(buffer);
        });
    });

    request.on('error', function(e){
        console.log('error from facebook.getFbData: ' + e.message)
    });

    request.end();
} 
```

现在，在您的代码中导入您的 facebook 模块 ( `var facebook = require('./facebook.js');`) 并像这里一样使用它：

```
facebook.getFbData('USER_ACCESS_TOKEN', '/me/friends', function(data){
    console.log(data);
}); 
```

这`getFbData()`是一个通用函数，您可以使用您的 api 请求路径（例如“/me/friends”）调用它，传递`access token`当前用户的 和一个回调函数，以便在数据准备好时调用。

# ios - iOS 上的 PhoneGap/Cordova：获取准确的设备硬件版本（例如 iPad 1 或 iPad 2）

> ID：13108998
> 
> 赞同：0
> 
> 时间：2012-10-28T13:03:11.910
> 
> 标签：ios, cordova, cordova-2.0.0

查看[Cordova Docs](http://docs.phonegap.com/en/edge/cordova_device_device.md.html#device.platform)，似乎只有一些一般信息可通过该`device`对象获得。但是，我不仅想知道设备的名称，还想知道它的硬件版本：例如，如果它是 iPad mini 或 iPad 2、iPhone 4 或 5...

PhoneGap 是否有内置方法可以做到这一点，还是我必须通过用户代理和分辨率来猜测设备？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T17:41:23.460

在 Cordova (PhoneGap) 2.3.0 中，无需使用任何插件即可`device.model`

> 对于所有平台，都有一个名为 device.model 的新属性——它返回特定的设备型号，例如“iPad2,5”（对于其他平台，它返回用于返回的 device.name）。

[资源](http://docs.phonegap.com/en/edge/guide_upgrading_ios_index.md.html#Upgrading%20Cordova%20iOS)

（从我的回答[here](https://stackoverflow.com/a/16175362/1549818)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T13:17:16.667

您可以在您的应用程序中使用[此代码](https://gist.github.com/1323251)来检测设备类型。

我刚刚[用插件代码创建了一个要点](https://gist.github.com/4352031)。如果您在使用时遇到问题，请告诉我

如果你有时间，你能看看[这个](https://stackoverflow.com/questions/13085761/cordova-ios-custom-plugin-handle-memory-warning)与phonegap和内存管理相关的问题吗？