# StackOverflow 问答 13480000-13480999

# mysql - 我应该将有关项目的信息放在与项目的产品/父 ID 不同的表中吗？MYSQL

> ID：13480002
> 
> 赞同：0
> 
> 时间：2012-11-20T18:46:31.290
> 
> 标签：mysql, database, database-design

我有一个商店数据库，其中包含商店列表、他们的 ID 和 5 行的 5 级父/祖父母 ID。

我也有商店信息，如地址、电话号码、产品等，但所有这些行都在一个单独的表中，该表也有商店名称和商店 ID，但没有父母。

目前，我将所有商店信息与商店 ID 放在一个单独的表中，如果我需要将父 ID 与信息相关联，我使用 store_ID 将两者连接起来。

因此，如果我将所有内容都放入一个表中，则基本上可以删除冗余行“store_Id”和“store_name”。

但那是正确的形式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:06:49.220

只要你不需要一个店铺过去属性的历史记录，即你不需要知道一个店铺从address1搬到address2，你只需要知道当前地址，那么我会合并表格. 就性能而言，它可能不会产生明显的差异，但是将数据放在一个表中比`JOIN`在需要时更容易。它还将在冗余列和索引上节省一些存储空间。随着您存储的数据量及其相关性，您不会从将详细信息存储在第二个表中获得太多收益。如果`TEXT`每个商店有 20 列，那么您可以从详细信息表中受益，但实际上，您不需要它。

# c# - 创建数据绑定

> ID：13480003
> 
> 赞同：1
> 
> 时间：2012-11-20T18:46:38.370
> 
> 标签：c#, wpf, data-binding

我正在尝试用 WPF 和 C# 中的 DataBinding 做一件小事，但我无法理解 DataBinding 的任何教程。我的问题是，我在 C# 中有一个字符类，它有 X 和 Y 坐标与 get并设置功能。然后我在窗口的画布中有一个图像，现在我试图将角色类的坐标绑定到图像。（只有一个图像，并且只会创建一个角色类的实例，虽然不是在开始时）。希望任何人都可以解释一下，以便我完全理解它：/

编辑：

这是 XAML：

```
<Window x:Class="ProjectChar.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="800" Width="1000" Background="Gray">
<Viewbox StretchDirection="Both" Stretch="Uniform">
    <Grid>
        <Canvas Name="Canv" Background="White" Visibility="Hidden" MaxHeight="750" MaxWidth="1000">
            <Canvas.LayoutTransform>
                <ScaleTransform ScaleY="-1"/>
            </Canvas.LayoutTransform>
            <Image Name="CharImage"  Source="CharBild.png" Canvas.Left="{Binding iXCoordinate}" Canvas.Top="{Binding iYCoordinate}"/>
        </Canvas>
    </Grid>
</Viewbox> 
```

这是 C# 部分：

```
namespace ProjectChar
{
    public class Char : MainWindow
    {
        public int iXCoordinate { get; set; }
        public int iYCoordinate { get; set; }
    }
} 
```

所以我需要以某种方式将它们绑定在一起，但我不知道如何。我知道我必须创建一个 DataContext 并且我需要将 UpdateSource 设置为 PropertyChanged 并且我需要一个用于 Property Changed 的​​ EventHandler ，但是我不知道该怎么做，互联网上的教程都是说不同的事情：/

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T20:06:41.793

要将`Image`的 X 和 Y 坐标绑定到您的属性，请执行以下操作：

1.  从 中删除`Char`的继承`MainWindow`。
2.  将`MainWindow`'s设置`DataContext`为`Char`.
3.  从`Visibility="Hidden"`_`Canvas`

例子：

```
public class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        DataContext = new Char { iXCoordinate = 20, iYCoordinate = 50 };
    }
} 
```

确保您确实将`iXCoordinate`and`iYCoordinate`属性设置为某些东西。如果不是，它们将是 的默认值`int`，即 0。例如，图像将显示在左上角。

要让视图 (UI) 知道绑定值何时发生更改，请在每次设置属性时实现[`INotifyPropertyChanged`](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)并引发事件：`PropertyChanged`

```
public class Char : INotifyPropertyChanged
{
    private int _iXCoordinate;

    public int iXCoordinate
    {
        get { return _iXCoordinate; }
        set
        {
            _iXCoordinate = value;
            OnPropertyChanged("iXCoordinate");
        }
    }

    private int _iYCoordinate;

    public int iYCoordinate
    {
        get { return _iYCoordinate; }
        set
        {
            _iYCoordinate = value;
            OnPropertyChanged("iYCoordinate");
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;

    private void OnPropertyChanged(string propertyName)
    {
        var handler = PropertyChanged;
        if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName));
    }
} 
```

这是最简单的实现方式`INotifyPropertyChanged`。但是，我建议创建一个实现接口的基类，并让您的 ViewModels 从中继承。尝试这样的事情：

```
public class PropertyChangedBase : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    protected void OnPropertyChanged<T>(Expression<Func<T>> propertyExpression)
    {
        var handler = PropertyChanged;
        var propertyName = GetPropertyName(propertyExpression);
        if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName));
    }

    private static string GetPropertyName<T>(Expression<Func<T>> propertyExpression)
    {
        var memberExpression = propertyExpression.Body as MemberExpression;
        if (memberExpression == null)
        {
            var unaryExpression = propertyExpression.Body as UnaryExpression;
            if (unaryExpression == null) 
                throw new ArgumentException("Expression must be a MemberExpression.", "propertyExpression");

            memberExpression = unaryExpression.Operand as MemberExpression;
        }

        if (memberExpression == null) 
            throw new ArgumentException("Expression must be a MemberExpression.", "propertyExpression");

        var propertyInfo = memberExpression.Member as PropertyInfo;
        if (propertyInfo == null) 
            throw new ArgumentException("Expression must be a Property.", "propertyExpression");

        return propertyInfo.Name;
    }
} 
```

这`PropertyChangedBase`还有一个额外的好处，即您必须`PropertyChanged`使用 lambda 表达式而不是使用["magic strings"](http://en.wikipedia.org/wiki/Magic_string)来引发事件，这很容易出现拼写错误并且不利于重构：

```
 public int iYCoordinate
    {
        get { return _iYCoordinate; }
        set
        {
            _iYCoordinate = value;
            OnPropertyChanged(() => iYCoordinate);
        }
    } 
```

但是，您**真正**的问题是`ViewBox`包装`Grid`.

A`ViewBox`测量它的孩子的大小`Infinity`，然后按他们的大小排列它们`DesiredSize`。这意味着它的孩子可以是他们想要的任何大小。两者`Grid`都`Canvas`没有他们*想要*的尺寸，他们依靠父母给他们一个尺寸。

要解决您的问题，请指定`Width`其中`Height`的`Grid`或`Canvas`内部的和。

**顺便说一句**：你知道的

```
<Canvas.LayoutTransform>
  <ScaleTransform ScaleY="-1"/>
</Canvas.LayoutTransform> 
```

会翻转你的卡瓦斯，对吧？

# ruby - Ruby 1.9.3 中没有定义 Random 吗？

> ID：13480004
> 
> 赞同：0
> 
> 时间：2012-11-20T18:46:43.207
> 
> 标签：ruby, random, undefined

我`ruby -v`的是： `ruby 1.9.3p327 (2012-11-10 revision 37606) [x86_64-darwin12.2.0]`

但是尝试调用 Random 会导致以下错误： `uninitialized constant Random (NameError)`

有谁知道解决这个问题的方法？我听说 Random 是从 1.9.2 定义的。:(

谢谢你。

# javascript - 为什么 jQuery 的 .html() 方法不使用 .hover() 将 HTML 推送到容器中？

> ID：13480005
> 
> 赞同：0
> 
> 时间：2012-11-20T18:46:45.210
> 
> 标签：javascript, jquery

我想知道为什么在这个例子中：http: [//jsfiddle.net/ZdPry/2/](http://jsfiddle.net/ZdPry/2/)悬停的父项中的 HTML`<ul>`被推送到我想要的容器，但是在 mouseleave 和随后的悬停时，没有 HTML 被推送到首次悬停的相同元素的容器。悬停的其他元素确实会在第一次鼠标悬停时推送有问题的 HTML，但只会推送一次。我在下面复制了一些有问题的代码。

```
$('#superfish-1 li').hover(function(e) {
    e.stopPropagation();
    $('.menuarea').html($('ul', this)).slideDown();
}, function() {
    // do something else
});​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:51:44.027

您正在传递一个对象，您可以使用`html`方法并传递`html`内容：

```
$('.menuarea').html($('ul', this).html()).slideDown(); 
```

[http://jsfiddle.net/YePWJ/](http://jsfiddle.net/YePWJ/)

# facebook - 安装 NuGet 包“Facebook 6.1.2”Windows 8 应用程序时出错

> ID：13480007
> 
> 赞同：2
> 
> 时间：2012-11-20T18:46:48.277
> 
> 标签：facebook, facebook-c#-sdk, nuget, windows-store-apps

当尝试将 Facebook 6.1.2 NuGet 安装到我的 Windows 8 应用程序中时，我收到以下消息：

```
PM> Install-Package Facebook
Successfully installed 'Facebook 6.1.2'.
Successfully uninstalled 'Facebook 6.1.2'.
Install failed. Rolling back...
Install-Package : Could not install package 'Facebook 6.1.2'. You are trying to install
this package into a project that targets '.NETCore,Version=v4.5', but the package does not
contain any assembly references that are compatible with that framework. For more
information, contact the package author. 
```

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T02:04:37.707

详情请见[https://github.com/facebook-csharp-sdk/facebook-csharp-sdk/issues/199](https://github.com/facebook-csharp-sdk/facebook-csharp-sdk/issues/199)

TLDR；

我们现在将 win 商店应用程序的 facebook.dll 存储在`win8`文件夹中，而不是`winRT45`只有 nuget 2.1+ 才能理解。因此，请确保您的 nuget 包管理器是最新的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:12:22.743

Facebook 6.1.2 包可能不是针对 .Net 框架的 4.5 版。

尝试在您的 Windows 8 App 项目中定位 4.0 版。

# xcode - 关闭 UITable 的所有部分

> ID：13480010
> 
> 赞同：0
> 
> 时间：2012-11-20T18:47:08.257
> 
> 标签：xcode, uitableview

我有一个具有可扩展单元格的 UItable。当用户点击某个部分时，它会展开并显示行。但是我需要在打开新部分之前关闭任何以前打开的部分。我想我需要在 didselectrow 中执行此操作，只是不确定该怎么做？

我的 didselectrow 代码如下

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath    *)indexPath
{
    if(tableView.tag == 4)
    {
        //NSLog(@"Did Select Row");

        if ([self tableView:tableView canCollapseSection:indexPath.section])
        {
            if (!indexPath.row)
            {
                // only first row toggles exapand/collapse
                [tableView deselectRowAtIndexPath:indexPath animated:YES];

                NSInteger section = indexPath.section;
                BOOL currentlyExpanded = [expandedSections3 containsIndex:section];
                NSInteger rows;

                NSMutableArray *tmpArray = [NSMutableArray array];

                if (currentlyExpanded)
                {
                    rows = [self tableView:tableView numberOfRowsInSection:section];
                    [expandedSections3 removeIndex:section];

                }
                else
                {
                    [expandedSections3 addIndex:section];
                    rows = [self tableView:tableView numberOfRowsInSection:section];
                }

                for (int i=1; i<rows; i++)
                {
                    NSIndexPath *tmpIndexPath = [NSIndexPath indexPathForRow:i
                                                               inSection:section];
                     [tmpArray addObject:tmpIndexPath];
                }

                //UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];

                if (currentlyExpanded)
                {
                    [tableView deleteRowsAtIndexPaths:tmpArray
                                 withRowAnimation:UITableViewRowAnimationTop];

                }
                else
                {
                    [tableView insertRowsAtIndexPaths:tmpArray
                                 withRowAnimation:UITableViewRowAnimationTop];
                }
            }

            else {

            }
        }

        //NSLog(@"Button Pressed?");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:34:27.343

`reloadSections:withRowAnimation:`尝试从内部调用 UITableView `tableView:didSelectRowAtIndexPath:`。这允许表视图重新查询您的委托以获取您指定的部分。作为一个好处，您将获得以这种方式添加和删除的行的漂亮动画。

当然，这与您当前直接操作表视图行的解决方案完全不同，因此如果您想尝试`reloadSections:withRowAnimation:`，您可能需要重写委托的大部分内容。更改将涉及存储您的部分的折叠/展开状态，直接在您的委托或委托引用的模型对象中，以便委托在表格视图重新查询时具有更新的返回值。

# .net - 从.NET 创建数据库存储过程？

> ID：13480011
> 
> 赞同：1
> 
> 时间：2012-11-20T18:47:11.837
> 
> 标签：.net, sql, sql-server, stored-procedures

我想从 C# 代码中在我的数据库中创建一个存储过程。

我怎样才能做到这一点？

例如：使用 Microsoft SQL Server，我只想`sp_GetUsers`在数据库中创建一个存储过程，它接受一个`int`参数`userid`和一个简单的语句，例如

```
SELECT * FROM Users WHERE ID = @userid 
```

这会很棒，因为我可以检查数据库是否存在该存储过程，如果不存在，我只需从代码中创建。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T18:48:31.083

您可以运行任意 DDL 语句：

```
new SqlCommand(@"CREATE PROCEDURE ...").ExecuteNonQuery(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:49:43.283

这个有可能。您所要做的就是`CREATE PROCEDURE`通过您的开放数据库连接执行一条语句。如果您现在可以向我们提供您的数据库连接/查询代码的示例，以及您正在使用的数据库供应商（即 MS SQL、DB2），那么我们可能会为您提供一个简单而快速的示例。

# gwt - 如何设置边框样式

> ID：13480014
> 
> 赞同：0
> 
> 时间：2012-11-20T18:47:30.723
> 
> 标签：gwt, gwt-2.3, richtextarea

我想知道是否有直接为 RichTextArea 设置边框（类似 CSS）的最佳方法？

我尝试使用 Formatter 但它不包含必需的方法:(

我正在使用 GWT 2.3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:30:48.443

您可以将 CSS 设置应用于您的 gwt-objects

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T12:55:33.913

有很多方法可以实现它。

您可以使用以下

```
getElement().setAttribute( "name", "value" ); 
```

此处提供您要修改的 CSS 属性名称并提供值。

```
getElement().setClassName( "className" );
getElement().addClassName( "className" ); 
```

这里提供 CSS 类名（可以是任何名称）。在您的 CSS 文件中使用相同的 className 并执行您需要的所有操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:51:48.420

也许您可以使用设置边框的方法从 GWT 的框架中扩展框架：

```
public void setFrameBorder(Integer border) {
    getFrameElement().setFrameBorder(border);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-10T10:03:36.210

一种方法是使用 GWT 中的嵌入式方法，它们是：

*   [setBorderStyle(BorderStyle 样式)](http://www.gwtproject.org/javadoc/latest/com/google/gwt/dom/client/Style.html#setBorderStyle-com.google.gwt.dom.client.Style.BorderStyle-)
*   [setBorderWidth(double value, Style.Unit 单位)](http://www.gwtproject.org/javadoc/latest/com/google/gwt/dom/client/Style.html#setBorderWidth-double-com.google.gwt.dom.client.Style.Unit-)
*   [setBorderColor（字符串颜色）](http://www.gwtproject.org/javadoc/latest/com/google/gwt/dom/client/Style.html#setBorderColor-java.lang.String-)

来自[GWT 样式](http://www.gwtproject.org/javadoc/latest/com/google/gwt/dom/client/Style.html)类。

这是一个例子：

```
HTMLPanel htmlPanel= new HTMLPanel("TestPanel");
htmlPanel.getElement().getStyle().setBorderStyle(BorderStyle.SOLID); // DOTTED, NONE ...
htmlPanel.getElement().getStyle().setBorderWidth(0.5, Unit.PX);
htmlPanel.getElement().getStyle().setBorderColor("#DD05FF"); 
```

在这里，您`htmlPanel`将有一个 0.5 像素宽的紫色实心边框。

# ios - iPhone 开发，UIKeyboard 给出的只是字母？

> ID：13480016
> 
> 赞同：0
> 
> 时间：2012-11-20T18:47:49.133
> 
> 标签：ios

有`UIKeyboard`没有只发出字母而不发出其他任何东西的？我尝试了字母表，但它给出了数字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:51:43.713

`UIKeyboard`如果没有从头开始创建自己的子类，您将无法获得仅包含字母的键盘；但是您可以使用 . 拒绝您不想要的字符`UITextFieldDelegate`。

如果`string`不是字母，则返回`NO`此函数：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string; 
```

[这](https://stackoverflow.com/questions/6954382/uitextfield-should-have-only-positive-number/6954599#6954599)是针对您的情况的答案的改编：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    NSCharacterSet *cs = [[NSCharacterSet characterSetWithCharactersInString:@"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"] invertedSet];
    NSString *filtered = [[string componentsSeparatedByCharactersInSet:cs] componentsJoinedByString:@""];
    return [string isEqualToString:filtered];
} 
```

# java - Java LWJGL：按钮闪烁

> ID：13480018
> 
> 赞同：0
> 
> 时间：2012-11-20T18:47:51.550
> 
> 标签：java, menu, lwjgl, flicker

我目前正在尝试在 LWJGL 中创建游戏标题菜单，但是当我将鼠标悬停在我的一个按钮上时，它开始闪烁并且在 DEFAULT 和 HOVER 状态之间快速变化。大约 0.5 秒后，闪烁停止并显示悬停纹理。当再次将鼠标从按钮上移开时，会发生同样的事情，0.5 秒后它再次显示默认纹理。

我正在使用最新的 Eclipse、Java、jinput 和 LWJGL 版本。

我已经尝试过的：

*   Display.sync(123) --> 高数字使闪烁持续时间更长，低数字 (1-5) 停止闪烁，但我显然不希望有 5 FPS。
*   Display.setVSyncEnabled(true) --> 不会改变任何东西

源代码：

（已删除：源代码与问题无关，帖子太长...有关解决方案，请参见下面的答案。）

提前致谢！（我现在正在尝试解决这个问题几天......）

编辑： 可能与我的鼠标无关，因为我更改了 isHovering 方法，因此它使用系统时间。它仍然在闪烁。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:36:03.843

终于修好了！

对于遇到此问题并且能够理解我糟糕英语的其他任何人：我不小心将 Display.update() 调用放在了我的游戏循环而不是渲染循环中，因此它被调用得太频繁了。

如果您遇到同样的问题，祝您好运！

# c# - 使用现有 C# 模型类构建实体图 (.EDMX)

> ID：13480021
> 
> 赞同：3
> 
> 时间：2012-11-20T18:47:55.270
> 
> 标签：c#, oracle, entity-framework, visual-studio-2012, edmx

我正在将应用程序的持久存储机制从 SQL Compact 移植到 Oracle。

*当前实施*

该应用程序实现了实体框架 5 (EF)，但它的耦合非常紧密：**(a)** EF 和控制器之间没有*服务层，* **(b)**`IRepository` EF 和 SQL Compact 之间没有-style 抽象。

C# 模型是简单的 POCO，但具有丰富的数据注释，并使用“代码优先”样式生成 DB 模式。

*问题（甲骨文）*

我必须使用 Oracle 的标准 ODP.Net 提供程序。提供程序支持 EF，但不支持“代码优先”方法，仅支持“模型优先”。

*预期解决方案*

我试图找到一种方法来保留与控制器紧密耦合的 EF 实现以及模型类注释的丰富性，同时使用它们来构建 Oracle 可以吞下的“模型优先”样式的 EDMX 文件。本质上，我正在寻找一种模仿“代码优先”的方法。

我希望它就像将我的 C# 对象拖到 EDMX 文件上一样简单，但似乎还有很多事情要做。

## 问题

如何使用已经存在的 C# 模型构建 .EDMX 文件？如果不可能，实现这一目标的下一个最佳解决方案是什么？

### 注意：请不要推荐第三方付费产品。该解决方案必须可以使用 Visual Studio、`C#`开源库或某种组合来实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:54:00.030

如果您有 DbContext，您可以使用“EdmxWriter.WriteEdmx()”将您的模型写入您应该能够使用设计器打开的 edmx 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:52:00.107

编辑：文章发布的地方重新组织了他们的 URL。修正了参考。抱歉，链接断开。

[这](http://www.oakwoodsys.com/adding-annotations-data-model-first-entities/)是我写的一篇博客文章，它解释了如何使用 MetaDataTypeAttribute 来让您在使用新生成的数据库优先/模型优先 edmx 时受益于所有代码优先注释工作。

虽然它不允许您从模型构建 .edmx，但您至少可以从数据库生成，然后使用当前的代码优先类作为元数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T01:17:30.630

**@Pawel**提供了基本答案，`EdmxWriter`. 他的回答被标记了，感谢他。我的回答只是提供更多细节、Oracle 文档参考和一个简单的代码示例：

* * *

### C# 到 EDMX

命名空间为此目的提供`System.Data.Entity.Infrastructure`了一个静态：`EdmxWriter`

```
// 1\. Instantiate your DbContext derived type
var db = new AppContext();

// 2\. Instantiate an XmlWriter
var xw = XmlWriter.Create("models.edmx");

// 3\. Write to file.
EdmxWriter.WriteEdmx(db, xw); 
```

生成的 EDMX 文件可以添加到项目/解决方案中并由设计人员打开。

### EDMX 到 Oracle 模式

通过对 EDMX 文件属性进行一些更改（请参阅[“模型优先”步骤 2](http://www.oracle.com/webfolder/technetwork/tutorials/obe/db/dotnet/EntityFrameworkOBE/EntityFrameworkOBE.htm)），您可以随后`Generate Database from Model`更改用于构建 db 模式的 Oracle 语法 SQL 脚本。

***注意：**正如 Pawel 在评论中指出的那样，EDMX 编写器将承认并尊重数据注释属性（例如`[MaxLength]`）和流利的 api 配置`.HasMaxLength(50)`，但它不处理 C#/EntityFramework 和 Oracle 的 db 类型之间的某些数据类型映射问题。*

# c# - 使用分析管理对象 (AMO) 将 xmla 文件反序列化为对象

> ID：13480024
> 
> 赞同：0
> 
> 时间：2012-11-20T18:48:10.973
> 
> 标签：c#, ssas

我想将其中包含数据库对象的 xmla 文件反序列化为正确的对象表示形式。（我不知道它是否应该是一个数据库）。因此，我执行以下操作：

```
Database db = new Database();
XmlTextReader xmlread = new XmlTextReader("input.xmla");
Microsoft.AnalysisServices.Utils.Deserialize(xmlread, db);
xmlread.Close(); 
```

但我收到以下错误：

```
Unhandled Exception: Microsoft.AnalysisServices.XmlSerializationException: Unexpected root 'Create' (namespace 'http://schemas.microsoft.com/analysisservices/2003/engine') when trying to read 'Microsoft.AnalysisServices.Database'.
  at Microsoft.AnalysisServices.DesignXmlReader.ReadRoot (System.Type type) [0x00000] in <filename unknown>:0 
  at Microsoft.AnalysisServices.DesignXmlReader.DeserializeComponent (IDesignerSerializationManager manager, System.Xml.XmlReader reader, System.Type root) [0x00000] in <filename unknown>:0 
  at Microsoft.AnalysisServices.JaXmlSerializer.DeserializeComponent (IDesignerSerializationManager manager, System.Xml.XmlReader reader, System.Type root) [0x00000] in <filename unknown>:0 
  at Microsoft.AnalysisServices.Utils.Deserialize (System.Xml.XmlReader xmlReader, Microsoft.AnalysisServices.MajorObject obj) [0x00000] in <filename unknown>:0 
```

input.xmla 文件如下所示：

```
<Create xmlns="http://schemas.microsoft.com/analysisservices/2003/engine">
    <ObjectDefinition>
         <Database xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ddl2="http://schemas.microsoft.com/analysisservices/2003/engine/2" xmlns:ddl2_2="http://schemas.microsoft.com/analysisservices/2003/engine/2/2" xmlns:ddl100_100="http://schemas.microsoft.com/analysisservices/2008/engine/100/100" xmlns:ddl200="http://schemas.microsoft.com/analysisservices/2010/engine/200" xmlns:ddl200_200="http://schemas.microsoft.com/analysisservices/2010/engine/200/200">
             <ID>100</ID>
             <Name>Deserialized</Name>
             <Description>Deserialized Description</Description>
        </Database>
    </ObjectDefinition>
</Create> 
```

我找不到一个很好的例子。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T21:22:15.843

问题是，您试图反序列化包含“CREATE”命令的 xmla 文档，而不仅仅是序列化的数据库对象。如果您有一个仅位于数据库节点上的 xml-reader，它应该可以工作！

# matlab - 通过三次样条插值 3d 矩阵

> ID：13480026
> 
> 赞同：1
> 
> 时间：2012-11-20T18:48:15.293
> 
> 标签：matlab, spline, cubic

Map 提供了一个 185 x 250 x 3 的矩阵 Map，表示图像和“图像坐标”xi 和 yi。插值坐标 5 < x < 180 和 5 < y < 245，均以间距 0.1 均匀分布。首先在一个方向上对矩阵 Map 的 3 个大小为 185 x 250 的块中的每一个进行插值，然后在另一个方向上插值，以生成 1751 x 2401 x 3 矩阵 InterpolatedMap。将任何大于 1 的值设置为 1，将任何小于 0 的值设置为 0。使用 image 命令将原始图像 Map 与 InterpolatedMap 中的图像进行比较。

我生成了代码 MyCubicInterpolation，它以下列方式工作，xi = linspace(-1,1,150); zi = sin((pi.*xi)/2);

x = linspace(-1,1,200);

y = MyCubicSpline(xi,zi,x);

现在我不明白哪个是我的第一个方向，哪个是我的第二个方向，我应该从三个中选择整个块 Map(:,:,1)。总之我无法理解接下来的步骤。

# python - 如何在 python 的列表中压缩带有单个值的键？

> ID：13480031
> 
> 赞同：6
> 
> 时间：2012-11-20T18:48:37.353
> 
> 标签：python, key, dictionary

我正在导入一个矩阵，将第一行转换为键，并将其余行转换为值。我想用每个值压缩键并将它们放入字典中。

前任：

如果我有以下情况：

```
k = ['a', 'b']
v = [[1,2], [3,4]] 
```

我想获取 v 中的每个值（对于 v 中的 x）并压缩它们（k 和 x），然后转换为字典。

然后我将字典添加到字典列表中。

最后我应该有：

```
dicts = [{'a':1, 'b':2}, {'a':3, 'b':4}] 
```

现在，我只是用我的钥匙压缩我的行。我该如何解决？

```
matrix_filename = raw_input("Enter the matrix filename:  ")  
matrix = [i.strip().split() for i in open(matrix_filename).readlines()]  
keys = matrix[0]  
vals= (matrix[1:])  
N=len(vals)  

dicts = []  

for i in range(1,N):  
    for j in range(1,N):  
        vals[i-1][j-1] = int(matrix[i][j])  
        dicts = dict(zip(keys,vals)) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-20T18:54:36.220

```
>>> [dict(zip(k, x)) for x in v]
[{'a': 1, 'b': 2}, {'a': 3, 'b': 4}] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T18:54:29.890

使用`itertools.cycle()`：

```
In [51]: from itertools import *

In [52]: cyc=cycle(k)

In [53]: [{next(cyc):y for y in x} for x in v]
Out[53]: [{'a': 1, 'b': 2}, {'a': 3, 'b': 4}] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-15T01:01:03.130

我根据另一个问题的[答案](https://stackoverflow.com/a/21930762/11121534)开发了一个基于生成器的解决方案。

（答案重复：[https](https://stackoverflow.com/a/69578838/11121534) ://stackoverflow.com/a/69578838/11121534 ）

当字典很大时，这可能会有所帮助。

```
def zip_dict(d):
    for vals in zip(*(d.values())):
        yield dict(zip(d.keys(), vals)) 
```

示例用法：

```
d = dict(
    x=[1,3,5,7,9],
    y=[2,4,6,8,10]
)

for t in zip_dict(d):
    print(t) 
```

结果将是：

```
{'x': 1, 'y': 2}
{'x': 3, 'y': 4}
{'x': 5, 'y': 6}
{'x': 7, 'y': 8}
{'x': 9, 'y': 10} 
```

# scala - 在 (List[Int], List[Int]) 上匹配时缺少组合

> ID：13480032
> 
> 赞同：2
> 
> 时间：2012-11-20T18:48:39.103
> 
> 标签：scala

```
 def isLegalFor(board:Board) = 
        (board(from), board(to)) match {
            case (Nil, _) => false
            case (x :: _, Nil) => true
            case (x :: _, y :: _) if x < y => true
            case (x :: _, y :: _) if x > y => false             
        } 
```

board(from) 和 board(to) 都是 List[Int]

产生警告：

```
[warn] missing combination              *           Nil             *             * 
```

这似乎真的很混乱。第一种情况应涵盖 list1 为空且 list2 为任何内容 最后三种情况应涵盖 list1 具有至少一个元素且 list2 为空或至少一个元素。

列表可以为空，也可以不为空……总共有四种组合。似乎还可以。什么不见​​了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T18:56:23.503

当两个列表都至少有一个元素`x`and时，您会丢失一个条件`y`and `x == y`：

```
case (x :: _, y :: _) if x == y => ??? 
```

或者，如果您决定如何处理，`x == y`您可以结合最后两种情况，并简单地包括上面的第三种情况：

```
case (x :: _, y :: _) => x < y 
```

# c# - 表查询 来自在 PartitionKey 上筛选的 Azure TableStorage

> ID：13480039
> 
> 赞同：18
> 
> 时间：2012-11-20T18:49:32.187
> 
> 标签：c#, azure, azure-storage, azure-table-storage

我正在尝试通过 partitionKey 从表中抽象获取所有实体，如下所示：

```
public List<T> GetEntities<T>(string partitionKey, T entity) where T : TableEntity
    {
        try
        {
            var tableClient = _account.CreateCloudTableClient();
            var table = tableClient.GetTableReference(entity.GetType().Name.ToLower());
            var exQuery =
                new TableQuery<T>().Where(TableQuery.GenerateFilterCondition("PartitionKey", QueryComparisons.Equal,
                                                                             partitionKey));

            var results = table.ExecuteQuery(exQuery).Select(ent => (T) ent).ToList();
            return results;
        }
        catch (StorageException ex)
        {
            //TODO: Add more trace info
            Trace.TraceInformation("Unable to retrieve entity based on query specs");
            return null;
        }
    } 
```

但是，它在

```
new TableQuery<T> 
```

因为 TElement 没有无参数构造函数。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-20T19:26:58.340

正如您在问题中提到的那样， T 必须有一个无参数的构造函数。因此，请按如下方式更改您的方法的定义：

```
public List<T> GetEntities<T>(string partitionKey, T entity) where T : TableEntity, new () 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-09-05T17:57:05.547

我为表存储编写了一个小型通用存储库：

```
 public class CloudTableRepository<T> where T : ITableEntity,new ()
{
    private readonly string _tableName;
    private CloudTable _table;

    public CloudTableRepository(string tableName)
    {
        _tableName = tableName;
        InitializeTable();
    }

    #region Public Methods

    public virtual async Task<List<T>> GetPartitionAsync(string partitionKey, int takeCount = 1000)
    {
        var result = new List<T>();
        var query =
            new TableQuery<T>().Where(TableQuery.GenerateFilterCondition("PartitionKey", QueryComparisons.Equal,
                partitionKey));
        query.TakeCount = takeCount;
        TableContinuationToken tableContinuationToken = null;
        do
        {
            var queryResponse = await _table.ExecuteQuerySegmentedAsync(query, tableContinuationToken);
            tableContinuationToken = queryResponse.ContinuationToken;
            result.AddRange(queryResponse.Results);
        } while (tableContinuationToken != null);
        return result;
    }

    public virtual async Task<TableResult> GetSingleAsync(string partitionKey, string rowKey)
    {
       return  await GetSingle(partitionKey, rowKey);
    }

    public virtual async Task<T> UpdateAsync(T tableEntityData)
    {
        var updateCallistConfig = await GetSingleAsync(tableEntityData.PartitionKey, tableEntityData.RowKey);
        if (updateCallistConfig != null)
        {
            var updateOperation = TableOperation.InsertOrMerge(tableEntityData);
            var tableResult = await _table.ExecuteAsync(updateOperation);
            return (T) tableResult.Result;
        }
        return default(T);
    }

    public virtual async Task<T> AddAsync(T tableEntityData)
    {
        var retrieveOperation = TableOperation.Insert(tableEntityData);
        var tableResult = await _table.ExecuteAsync(retrieveOperation);
        return (T) tableResult.Result;
    }

    #endregion

    #region Private Methods

    private async void InitializeTable()
    {
        var storageAccount =
            CloudStorageAccount.Parse(CloudConfigurationManager.GetSetting("TableStorageConnectionString"));
        var tableClient = storageAccount.CreateCloudTableClient();
        _table = tableClient.GetTableReference(_tableName);
        await _table.CreateIfNotExistsAsync();
    }

    private async Task<TableResult> GetSingle(string partitionKey, string rowKey)
    {
        var retrieveOperation = TableOperation.Retrieve<T>(partitionKey, rowKey);
        var tableResult = await _table.ExecuteAsync(retrieveOperation);
        return tableResult; //(T) tableResult.Result;
    }

    #endregion
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-04-10T23:06:24.383

除了@serdar-ozler-microsoft 回答之外，您甚至不需要转换和转换实体即可返回。

CloudTable.ExecuteQuery方法有一个接受泛型类型的[重载](https://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.table.cloudtable.executequery.aspx)：

```
public IEnumerable<TElement> ExecuteQuery<TElement>(
TableQuery<TElement> query,
TableRequestOptions requestOptions = null,
OperationContext operationContext = null)
where TElement : new(), ITableEntity 
```

您还可以使用 Linq 对表服务进行过滤。

这样您就可以像这样重写您的方法：

```
public List<T> GetEntities<T>(string partitionKey, T entity) where T : ITableEntity, new()
{
    try
    {
        var tableClient = _account.CreateCloudTableClient();
        var table = tableClient.GetTableReference(entity.GetType().Name.ToLower());
        return table.CreateQuery<T>().Where(e => e.PartitionKey == partitionKey).ToList();
    }
    catch (StorageException ex)
    {
        //TODO: Add more trace info
        Trace.TraceInformation("Unable to retrieve entity based on query specs");
        return null;
    }
} 
```

# android - OpenGL ES Android 矩阵变换

> ID：13480043
> 
> 赞同：12
> 
> 时间：2012-11-20T18:49:47.397
> 
> 标签：android, opengl-es, opengl-es-2.0

我有一个实现 GLSurfaceView.Renderer 接口的渲染器；GLSurfaceView 的子类和一些代表我要绘制的对象的类。我有来自[http://developer.android.com/training/graphics/opengl/motion.html](http://developer.android.com/training/graphics/opengl/motion.html)的代码 我想扩展它并添加一些沿轴移动并且无法管理它。对象仅旋转。这是我的代码：

```
public class NotMyCoolRenderer implements GLSurfaceView.Renderer {

public GLShip mTriangle;
private GLBackgroundStar   mSquare;

private final float[] mMVPMatrix = new float[16];
private final float[] mProjMatrix = new float[16];
private final float[] mVMatrix = new float[16];
private final float[] mModelMatrix = new float[16];
private final float[] tempMatrix = new float[16];

public void onDrawFrame(GL10 unused) {
    // Draw background color
    GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT);
    // Set the camera position (View matrix)
    Matrix.setLookAtM(mVMatrix, 0, 0, 0, -3, 0f, 0f, 0f, 0f, 1.0f, 0.0f);
    // Calculate the projection and view transformation
    Matrix.multiplyMM(mMVPMatrix, 0, mProjMatrix, 0, mVMatrix, 0);
    // Draw square
    mSquare.draw(mMVPMatrix);
    // Now moving on to triangle aka ship
    Matrix.setIdentityM(mModelMatrix, 0);
    Matrix.translateM(mModelMatrix, 0, 0.1f, 0f, 0);
    Matrix.rotateM(mModelMatrix, 0, mTriangle.mAngle, 0, 0, -1.0f);
    Matrix.multiplyMM(tempMatrix, 0, mVMatrix, 0, mProjMatrix, 0); 
    Matrix.multiplyMM(mMVPMatrix, 0, mModelMatrix , 0, tempMatrix , 0);  

    // Draw triangle
    mTriangle.draw(mMVPMatrix);
}
public void onSurfaceChanged(GL10 unused, int width, int height) {
    // Adjust the viewport based on geometry changes,
    // such as screen rotation
    GLES20.glViewport(0, 0, width, height);

    float ratio = (float) width / height;

    // this projection matrix is applied to object coordinates
    // in the onDrawFrame() method
    Matrix.frustumM(mProjMatrix, 0, -ratio, ratio, -1, 1, 3, 7);

}

public class GLShip {
    public volatile float mAngle;
    private final String vertexShaderCode =
        // This matrix member variable provides a hook to manipulate
        // the coordinates of the objects that use this vertex shader
        "uniform mat4 uMVPMatrix;" +

        "attribute vec4 vPosition;" +
        "void main() {" +
        // the matrix must be included as a modifier of gl_Position
        "  gl_Position = uMVPMatrix * vPosition;" +
        "}";

    public void draw(float[] mvpMatrix) {
        // Add program to OpenGL environment
        GLES20.glUseProgram(mProgram);

        // get handle to vertex shader's vPosition member
        mPositionHandle = GLES20.glGetAttribLocation(mProgram, "vPosition");

        // Enable a handle to the triangle vertices
        GLES20.glEnableVertexAttribArray(mPositionHandle);

        // Prepare the triangle coordinate data
        GLES20.glVertexAttribPointer(mPositionHandle, COORDS_PER_VERTEX,
                                     GLES20.GL_FLOAT, false,
                                     vertexStride, vertexBuffer);

        // get handle to fragment shader's vColor member
        mColorHandle = GLES20.glGetUniformLocation(mProgram, "vColor");

        // Set color for drawing the triangle
        GLES20.glUniform4fv(mColorHandle, 1, color, 0);

        // get handle to shape's transformation matrix
        mMVPMatrixHandle = GLES20.glGetUniformLocation(mProgram, "uMVPMatrix");
        NotMyCoolRenderer.checkGlError("glGetUniformLocation");

        // Apply the projection and view transformation
        GLES20.glUniformMatrix4fv(mMVPMatrixHandle, 1, false, mvpMatrix, 0);
        NotMyCoolRenderer.checkGlError("glUniformMatrix4fv");

        // Draw the triangle
        GLES20.glDrawArrays(GLES20.GL_TRIANGLES, 0, vertexCount);

        // Disable vertex array
        GLES20.glDisableVertexAttribArray(mPositionHandle);
    }
} 
```

我的期望是，在每次重绘时，对象都会旋转 mAngle 并沿 Y 轴平移 1f。我只能看到旋转（也有点投影）。实际上，我对此有一些疑问：如何应用我的翻译矩阵以及划分 opengl 功能的最佳实践是什么？modelMatrix 不应该存储在对象本身而不是渲染器中吗？矩阵运算应该在渲染器类中执行吗？我将它们组合在一起，因为我猜它们都是相关的。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-06-25T08:47:13.170

我一直在使用 Android 培训中的示例，以下方法最终对我有用。（基于[Android 培训 > 使用 OpenGL ES 显示图形 > 添加运动](http://developer.android.com/training/graphics/opengl/motion.html "Android 培训 > 使用 OpenGL ES 显示图形 > 添加运动")）

1.  使用正确的顶点着色器：

    ```
    private final String vertexShaderCode =
    // This matrix member variable provides a hook to manipulate
    // the coordinates of the objects that use this vertex shader
    "uniform mat4 uMVPMatrix;" +
    "attribute vec4 vPosition;" +
    "void main() {" +
    // the matrix must be included as a modifier of gl_Position
    "  gl_Position = uMVPMatrix * vPosition;" +
    "}"; 
    ```

2.  在渲染器类中：

    ```
    public class MyGL20Renderer implements GLSurfaceView.Renderer {
    [...]
    // create a model matrix for the triangle
    private final float[] mModelMatrix = new float[16];
    // create a temporary matrix for calculation purposes,
    // to avoid the same matrix on the right and left side of multiplyMM later
    // see https://stackoverflow.com/questions/13480043/opengl-es-android-matrix-transformations#comment18443759_13480364
    private float[] mTempMatrix = new float[16];
    [...] 
    ```

3.  *在onDrawFrame*中应用转换，从*translation*开始：

    ```
    public void onDrawFrame(GL10 unused) {
    [...]
    Matrix.setIdentityM(mModelMatrix, 0); // initialize to identity matrix
    Matrix.translateM(mModelMatrix, 0, -0.5f, 0, 0); // translation to the left 
    ```

4.  然后*旋转*：

    ```
    // Create a rotation transformation for the triangle
    long time = SystemClock.uptimeMillis() % 4000L;
    float mAngle = 0.090f * ((int) time);
    Matrix.setRotateM(mRotationMatrix, 0, mAngle, 0, 0, -1.0f); 
    ```

5.  结合旋转和平移，**避免使用*mModelMatrix***

    > “作为multiplyMM左右两边的同一个矩阵”（见[2](https://stackoverflow.com/questions/13480043/opengl-es-android-matrix-transformations#comment18443759_13480364)）

    ```
    // Combine Rotation and Translation matrices 
    mTempMatrix = mModelMatrix.clone();
    Matrix.multiplyMM(mModelMatrix, 0, mTempMatrix, 0, mRotationMatrix, 0); 
    ```

6.  将模型矩阵与投影和相机视图相结合；**再次避免使用*mModelMatrix***

    > “作为multiplyMM左右两边的同一个矩阵”（见[2](https://stackoverflow.com/questions/13480043/opengl-es-android-matrix-transformations#comment18443759_13480364)）

    ```
    // Combine the model matrix with the projection and camera view
    mTempMatrix = mMVPMatrix.clone();
    Matrix.multiplyMM(mMVPMatrix, 0, mTempMatrix, 0, mModelMatrix, 0); 
    ```

7.  画出形状

    ```
    // Draw shape
    mTriangle.draw(mMVPMatrix); 
    ```

谢谢大家，我可以从这个线程中获得所有有用的输入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T18:59:58.283

如果你想看到运动，你应该更新 mTriangle.mAngle 每帧（最好作为时间的函数来对抗由其他进程引起的速度差异或延迟......）。

注意 Matrix.setIdentityM(mModelMatrix, 0); 将所有累积的旋转和平移恢复到“零”或实际上恢复到单位矩阵......同样的约定顺便适用于所有*集合*函数。为了积累所有的变化，一个人必须

*   设置身份（模型）；
*   翻译（转）；// 获取旋转原点
*   旋转（旋转矩阵）；// 累积旋转
*   翻译（t2）；// 再次翻译到更好的位置...

还应该在每次调用之间保留对象平移向量 [ox,oy,oz] 的值，并将它们提供给 Matrix.translateM(mModelMatrix, ox, oy, oz, 0);

通常，尽可能早地连接所有“平移、旋转、缩放”等矩阵，并按对象缓存它们，或者按具有多个对象并具有边界框的复杂容器分层缓存，以便可以在后面剔除多个对象相机（或通常在视锥体之外）。

此外，通常将移动相机保持在一个矩阵中，并且每帧将其与投影矩阵相乘。

您可以从以下内容开始：

```
float Time = System.currentTimeMillis() * 0.01f;  // 10 radians / second == fast!
Matrix.translateM(mModelMatrix, Math.sin(Time)*2.0f, 0, 1f, 0);
... 
```

正如 Tim 所注意到的，没有涉及投影矩阵，这意味着所有 z 值在此代码中的行为完全相同，即使更改 x 和 y 值会有所不同。

我很想说，MVP 矩阵意味着按 M * V * P = (M*V) * P = M * (V*P) 的顺序相乘。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T19:10:09.697

请注意，您没有将投影矩阵应用于您正在绘制的三角形，这可能会导致问题。

应该是：

```
Matrix.multiplyMM(mMVMatrix, 0, mVMatrix, 0, mModelMatrix, 0);  
Matrix.multiplyMM(mMVPMatrix, 0, mProjMatrix, 0, mMVMatrix, 0); 
```

# asp.net-mvc - @Html.DropDownListFor 没有选择默认值

> ID：13480045
> 
> 赞同：0
> 
> 时间：2012-11-20T18:49:48.343
> 
> 标签：asp.net-mvc, razor

我在模型中有 5 个值（代码 1、2、3、4、5），并将代码 5 分配为默认值。它正在拾取第一个值，即 1。我用过`Model.Eobadlstatus.Select(n => n.Code = 5)`

```
 @Html.DropDownListFor(m => m.EbAdlAmbulationCd, 
                          new SelectList(Model.Eobadlstatus, 
                                         "Code", 
                                         "Description", 
                                         Model.EbAdlAmbulationCd),
                          Model.Eobadlstatus.Select(n => n.Code = 5) ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:08:29.030

第三个参数[`DropDownListFor`](http://msdn.microsoft.com/en-us/library/ee703573%28v=vs.108%29.aspx)不是默认值——它要么是 HTML 属性哈希，要么是选项标签。

*   #1：`Expression<Func<TModel, TProperty>> expression`
*   #2：`IEnumerable<SelectListItem> selectList`
*   #3：`string optionLabel`——或者——`Object htmlAttributes`

所选值由模型属性的值决定，即`EbAdlAmbulationCd`。如果你想要一个默认值，最好在模型中实现它（数据注释，或模型构造函数等）。

# javascript - 仪表板的主干.js 设计模式

> ID：13480054
> 
> 赞同：2
> 
> 时间：2012-11-20T18:50:10.693
> 
> 标签：javascript, design-patterns, backbone.js

我正在使用 Backbone.js 构建仪表板应用程序

有一个称为模块的窗格网格。每个模块都有自己需要监听的自定义数据。

每个模块都有共同的职责和单独的职责，例如，它们都有标题、描述等，但它们都有各自的数据集。

我应该如何构建应用程序以实现向这些单独模块的持续数据流？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T18:54:38.727

在处理如此多的依赖项时，我建议通过一个全局 pubSub 类

```
var pubsub = _.extend({}, Backbone.Events); 
```

这样您就可以通过以下方式共享事件

```
pubsub.on('some:channel', function () {
    console.log('channel ', arguments);
});
pubsub.trigger('some:channel', 'Dude...'); 
```

具有多个模块并构建它们对它的响应。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:59:00.217

我强烈推荐你使用[backbone.marionette](https://github.com/marionettejs/backbone.marionette)

这是一个很好的[起点](https://stackoverflow.com/questions/11410059/suggested-bootstrap-boilerplate-sample-for-backbone-marionette-application)，可以帮助您

我使用木偶开发了复杂的仪表板应用程序，我节省的时间和精力是巨大的。自然地，marionette 包含了几个 pub/sub 机制，可以让你的工作变得轻松。

# video - Kindle Fire HD 无法在网络视图中使用 iframe 播放 youtube 视频

> ID：13480055
> 
> 赞同：0
> 
> 时间：2012-11-20T18:50:20.380
> 
> 标签：video, youtube, playback, kindle

我正在尝试通过加载在 KindleFire 上播放 YouTube 视频

`<html><body><iframe id="player" type="text/html" width="640" height="390" src="http://www.youtube.com/embed/HS78vzEVA28?autoplay=1" frameborder="0"/></html></body>`

在 Web 视图中。它在 Kindle Fire 第一代上运行良好，但在 Kindle Fire HD 上，它会加载视频拇指和红色重叠播放按钮，但一旦点击视频就无法播放。

任何建议如何让视频播放？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T19:26:33.253

在您的清单中，您是否为 webview 启用了硬件加速，并指定了 WebChromeClient 而不是只为托管 HTML 的 webview 采用默认值 - 有关示例，请参见[https://gist.github.com/3718414](https://gist.github.com/3718414)。我试过你的 YouTube 剪辑，它工作正常（从 FireHD 不支持的 Flash 切换到 HTML5 视频播放，但工作正常）

# google-app-engine - Google App Engine Datastore：土耳其语字符无法正确排序

> ID：13480056
> 
> 赞同：0
> 
> 时间：2012-11-20T18:50:44.610
> 
> 标签：google-app-engine

我正在使用 App Engine Python 并且 Datastore 无法正确排序土耳其语字符。我找不到解决方案。这是我的问题：

```
yazarlar = Yazarlar.all().order('isim') 
```

好吧，这会在结果末尾返回以字母“ş”（土耳其字母）开头的字段。它应该在 S 字母之后，但它在 Z 之后，这令人沮丧！

我在互联网上找不到合适的解决方案，所以我非常希望这里的人能想出一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T07:53:06.730

在没有可配置排序规则的情况下，如果您知道要处理的字符，那么在您的模型上有第二个属性“isim_sortable”，它将额外的字符替换为它们的 ascii 等效字符（例如 ş -> 'sz'）工作。

# firefox - 是否可以在离线时安装 AppCache 清单文件？

> ID：13480057
> 
> 赞同：1
> 
> 时间：2012-11-20T18:50:46.647
> 
> 标签：firefox, google-chrome, google-chrome-extension, firefox-addon, google-chrome-app

如果我想在离线设置中安装离线浏览器应用程序，是否可以安装 AppCache 清单文件，以便应用程序可以显示在[http://example.com/app.html](http://example.com/app.html)？哪个浏览器都没有关系，我只需要一个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:33:23.190

[在 Firefox 上，是的，但该过程对用户不友好，它旨在由构建系统在为Gaia](http://wiki.mozilla.org/Gaia)打包内置应用程序时使用。请参阅Gaia 的 Makefile 和[install-gaia.py上的](https://github.com/mozilla-b2g/gaia/blob/master/build/install-gaia.py)[install-gaia](https://github.com/mozilla-b2g/gaia/blob/master/Makefile#L518)目标。

您可以调整脚本以在您的 Firefox 配置文件中安装应用程序缓存和清单，但这是一个相当棘手的过程。

# python - python在try-except中递减时行为不明确

> ID：13480060
> 
> 赞同：2
> 
> 时间：2012-11-20T18:50:57.273
> 
> 标签：python, increment, behavior, except, decrement

在 except 子句中减少变量时是否有任何特殊行为？ `sid`一直递增，直到它第一次进入异常子句，然后它在`for`循环的剩余时间内保持相同的值。

105 次尝试中有 7 次抛出异常

没有打印输出“Fehlercode：”，错误代码

这是我的代码：

```
for bid in range(bidStart, bidEnd + 1):
    for syn in getSynsProBeitrag(bid):
        try:
            sid += 1
            query = "INSERT INTO zuord (bid, hid, sid) VALUES(%s, %s, %s)"
            cursor.execute(query, [bid, hid, sid])
            query2 = "INSERT INTO synonyme (synonym) VALUE (%s)"
            cursor.execute(query2, syn)

        except MySQLdb.IntegrityError, message:
            errorcode = message[0]      
            if errorcode == 1062:       
                sid -= 1
                print sid
            else:
                print "Fehlercode:", errorcode 
```

已解决：在 query2 抛出它的第一个异常之后，第一个查询也导致了一个（相同的）IntegrityError，然后它就像科琳说的那样来回移动

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:55:16.463

好吧，你在 except 子句中递减它，然后在 try 中递增它，所以它只是来回移动......如果它第一次失败，它会继续失败。

例如

```
try:
1
try:
1+1=2 ->fail->id-1=1
try:
1+1=2 ->fail->id-1=1
try:
1+1=2 ->fail->id-1=1
try:
1+1=2 ->fail->id-1=1
.... 
```

等等

如果您试图跳过失败的 id，请不要减少它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:56:27.603

在 except 子句中递减时没有任何特殊行为。

是不是因为同样的异常不断被抛出，所以它不断递减？我注意到您只有在收到相同的错误代码时才将其打印出来，您是否曾经收到“Fehlercode：错误代码”的打印输出？

# sql-server-2008 - 在 android 模拟器中将 SQLServer2008R2 与 Netbeans 连接

> ID：13480061
> 
> 赞同：1
> 
> 时间：2012-11-20T18:50:58.990
> 
> 标签：sql-server-2008, android-emulator, netbeans-7, jtds

我正在尝试使用 Netbeans 7.2.1 连接到 SQL Server 2008 R2 以编码到 android 模拟器 SDK。基本上，我正在使用这段代码：

```
package ConnectDB;

import java.sql.*;
import net.sourceforge.jtds.jdbc.*;

public final class ConnectDB {
    public void Connect() {
        String Connectionurl="jdbc:jtds:sqlserver://xxx.xxx.xxx.xxx;instance=some_instance;databasename=some_database;user=some_user;password=some_password;";
        Class.forName("net.sourceforge.jtds.jdbc.Driver");
        Connection conn = DriverManager.getConnection(Connectionurl);
    }

} 
```

此代码在一个简单的 java 应用程序中经过测试并且工作正常，但在 android 项目中，它在调用驱动程序时会给出 NoClassDefFoundError。我已经复制到 libs dir jtds-1.3.0.jar 并且当我右键单击 Project>Properties 时，我在 JAR 库中看到包含此​​ jar，但错误仍然存​​在。我已经使用了 sqljdbc4.jar 和不同的连接方法，但最终我得到了相同的结果。android平台是4.2和JRE 1.7。服务器IP是192.xxx.xxx.xxx

我在这里想念什么？这在 Netbeans 上可行吗？LZ需要一些建议...

# c# - 更改 XAML 元素的图像

> ID：13480062
> 
> 赞同：0
> 
> 时间：2012-11-20T18:51:06.427
> 
> 标签：c#, silverlight, xaml, binding

我正在尝试更改我的 XAML 元素的图像，但无法弄清楚如何，我正在使用来自[http://www.divelements.co.uk/net/controls/sandribbonsl/](http://www.divelements.co.uk/net/controls/sandribbonsl/)的沙带按钮任何想法我会这样做吗？

XAML 代码：

```
<sr:Button x:Name="Print" Text="Print" SmallImage="/Fsc.Feenics.Clients.Silverlight2;component/Images/16/print.png" Size="Small" Activate="Button_Activate" /> 
```

（坏掉的）C#代码：

```
Print.SmallImage = new BitmapImage(new Uri("/Fsc.Feenics.Clients.Silverlight2;component/Images/16/printOn.png")); 
```

谢谢，
杰森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:54:24.400

添加`UriKind.RelativeOrAbsolute`到以下行有效：

```
Print.SmallImage = new BitmapImage(
    new Uri("/Fsc.Feenics.Clients.Silverlight2;component/Images/16/printOn.png",
            UriKind.RelativeOrAbsolute)); 
```

# android - 实时编码音频会导致声音跳过

> ID：13480064
> 
> 赞同：0
> 
> 时间：2012-11-20T18:51:11.937
> 
> 标签：android, audio, audio-recording

## **高水平：**

我以两种不同的方式使用相同的编码器。

方法#1：录制原始音频并保存到整个文件，然后在全部完成后压缩文件。**结果**完美的音频

方式#2：记录原始音频，逐帧编码。**结果**有声跳音

**为什么**方式#2会导致跳过？

## **低级**

方式#1的代码（写入FileOutputStream fos，并在所有写入完成后压缩）

```
public void writeSample(short[] buf) throws IOException {
            byte[] byteArray = Util.toByteArray(buf,false);
            bytesWritten += byteArray.length;
            fos.write(byteArray);
        } 
```

方式#2的代码

```
public void writeSample(short[] buf) throws IOException {
            byte[] byteArray = Util.toByteArray(buf,false);
            bytesWritten += byteArray.length;
            encoder.encode(byteArray);
        } 
```

几乎完美：方法#2 中短缓冲区的长度为 15360。由于这是一个奇数大小，我采用了这种技术：但仍然有轻微的可听跳过：

```
 ByteArrayInputStream bais = new ByteArrayInputStream(byteArray);
      byte[] readme = new byte[4096];
      int count = bais.read(readme);
      while ( count != -1 ) {
        System.out.println("READING :"+count+ " bytes");
        if(bais.available() < 4096) {
          System.out.println ("LESS THAN 4096 available: "+bais.available());
          byte[] remain = new byte[bais.available()];
          bais.read(remain);
          aacEncoder.encode(remain);
          break;
        }
        aacEncoder.encode(readme);
        count = bais.read(readme);
      } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:48:33.563

这是交易：当编码器编码时，它并不总是花费相同的时间。有时它只是将一些数据藏起来以备后用，有时它实际上会进行大量的数字运算。它必须等待足够的音频来编码整个 MP3“帧”，否则它只会存储数据。

每次调用需要数字运算的新数据时，如果它需要的时间比音频所代表的时间长，那么就有可能发生丢失的风险。

解决方案是让您的记录线程填充缓冲区并让第二个线程完成所有可能减慢速度或花费不可预测的时间的工作。这包括编码和写入文件。

对于您的缓冲区，如果您的目标是 android 2.3 或更高版本，则可以使用管道[I](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/PipedInputStream.html) / [O](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/PipedOutputStream.html)。从技术上讲，这不是环形缓冲区，因为它会阻塞，但根据我的经验，它运行得很好。（这个 api 在早期版本的 android 中可用，但你不能设置缓冲区大小。Grrr！）

您可能会发现此链接有助于理解音频 IO 在概念上的实际工作原理：[http ://blog.bjornroche.com/2011/11/slides-from-fundamentals-of-audio.html](http://blog.bjornroche.com/2011/11/slides-from-fundamentals-of-audio.html)

# azure - 错误请求 - 在 Azure 本地存储中创建表

> ID：13480068
> 
> 赞同：5
> 
> 时间：2012-11-20T18:51:16.790
> 
> 标签：azure, azure-storage, azure-table-storage

当我尝试在表存储中创建表（使用 Azure 本地存储模拟器）时，我收到错误*“远程服务器返回错误：(400) 错误请求。”*

表的名称是符合规则的，所以会发生什么？！

**角色配置：**

```
<ConfigurationSettings>
<Setting name="Microsoft.WindowsAzure.Plugins.Diagnostics.ConnectionString" value="UseDevelopmentStorage=true" />
<Setting name="StorageConnectionString" value="UseDevelopmentStorage=true" />
</ConfigurationSettings> 
```

**创建表方法：**

```
CloudStorageAccount storageAccount = CloudStorageAccount.Parse(
CloudConfigurationManager.GetSetting("StorageConnectionString"));

CloudTableClient tableClient = storageAccount.CreateCloudTableClient();

CloudTable table = tableClient.GetTableReference("people");
table.CreateIfNotExists(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T20:17:52.447

您使用的是什么版本的 SDK？如果您混合使用 Storage Client 库 2.0 和较旧的 SDK（1.8 之前），则模拟器会出现问题。我也遇到了这个问题，并确保我使用的是 StorageClient 2.0 库和 Azure SDK 1.8：

[http://social.msdn.microsoft.com/Forums/en-US/windowsazuredata/thread/b1b66cc0-5143-41fb-b92e-b03d017ea3c1](http://social.msdn.microsoft.com/Forums/en-US/windowsazuredata/thread/b1b66cc0-5143-41fb-b92e-b03d017ea3c1)

编辑：也许有办法通过将存储 API 与 Azure SDK 混合使用，但这是一个简单的解决方案（解决方法）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-12T13:37:04.330

如果表名无效（例如名称中的下划线），则至少 Azure SDK 会回复相同的错误消息（400 Bad request）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-26T07:15:16.917

如果表名有下划线（_）。它抛出相同的异常。我遇到了同样的错误，我删除了下划线并且效果很好。

# jquery - Jquery/WP 插件通过简单地粘贴一个 url 来啜谷歌、Facebook、Linkedin 等元数据？

> ID：13480080
> 
> 赞同：0
> 
> 时间：2012-11-20T18:51:50.627
> 
> 标签：jquery, wordpress, plugins

你知道，当你粘贴一个 url 时，这些著名的服务可以同时显示标题、元和图像，你知道有什么 jquery 插件或 wordpress 插件可以做到这一点吗？

非常感谢您的帮助，

伊莎贝尔，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:57:49.263

它被称为[微数据](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=176035)。不幸的是，似乎没有任何插件可以使 Wordpress 上的微数据解析变得容易，但这并不意味着您不能使用 PHP 或 JavaScript 工具来做到这一点。

来自快速谷歌搜索的 JavaScript的[microdatajs和](https://gitorious.org/microdatajs/)[PHP 的 PHP-Microdata](https://github.com/soyrex/PHP-Microdata)。

[schema.org](http://schema.org)可以让您了解这些微数据标签的外观。

# javascript - 使用 javascript/jquery 更改 html5 视频源

> ID：13480087
> 
> 赞同：0
> 
> 时间：2012-11-20T18:52:16.587
> 
> 标签：javascript, jquery, html

我的网页上有一个视频，如下所示：

```
<div id="videoContainer">
<video id="video1" width="960" controls autoplay>
    <source src=static/media/Wreck_It_Ralph_Trailer.mp4 type="video/mp4">
    Your browser does not support html5 video
</video> 
```

我想使用 jquery/javascript 更改视频的来源。我有这个代码，但它不起作用

```
$('source').attr({'src':'static/media/Here_Comes_The_Boom_Official_Trailer.mp4'}) 
```

有人可以说为什么这不起作用或建议正确的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:56:31.247

通过 Mic 查看链接后，我需要一行额外的代码

```
a=document.getElementById('video1')
a.load() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:28:47.247

我相信你可以做这样的事情：

```
document.getElementById('video1').src = 'static/media/Here_Comes_The_Boom_Official_Trailer.mp4'; 
```

它只是直接更改视频播放器的源，而不用摆弄 DOM 元素。

# django - 谷歌云 SQL 和 ODBC

> ID：13480089
> 
> 赞同：1
> 
> 时间：2012-11-20T18:52:28.867
> 
> 标签：django, google-app-engine, jdbc, odbc

我知道可以通过外部 JDBC 访问 Google Cloud SQL，这很好，但我一直在使用各种 SQL GUI 客户端来查看和管理大部分 MySQL 数据库。Navicat、Sequel Pro 等工具对我来说很熟悉。简要了解了 Google 提到的 SQuirreL SQL 客户端，它使用 JDBC，但它是另一种学习工具，向后而不是向前。还搜索了 ODBC-JDBC 桥，但大多数都是昂贵的工具。

有什么建议吗？我只想用 Django 和关系数据库开发应用程序，而不是处理所有这些复杂性。Google App Engine 和 Cloud SQL 似乎很有希望，多年来一直在等待 Django 支持，它终于来了，但这似乎是一个缺失的环节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-04T19:32:09.783

现在可以使用 IP 连接。[管理和报告工具](https://developers.google.com/cloud-sql/docs/admin-tools)解释了如何从MySQL Workbench 和 Toad 等 GUI 工具进行连接。

# jquery - 如何在 iframe 中为 phpbb 论坛实现 jquery 滚动条？

> ID：13480091
> 
> 赞同：1
> 
> 时间：2012-11-20T18:52:35.907
> 
> 标签：jquery, html, iframe, phpbb

我这里有一个非常具体的案例。

我需要为在网站上保存论坛的 iframe 实现一个漂亮的 jquery 滚动条。

新闻和公告部分可以很好地容纳 jquery 滚动条，但是我无法让插件为论坛部分工作（第三个按钮）。如果我把它放在 iframe 周围，它只会滚动一点。如果我启用 iframe 滚动，那么它看起来很难看。如果我尝试将 jquery 代码放在 phpbb 主题文件上，比如说 tinyscrollbar，那么它根本不会出现。

我为 phpbb 寻找了一些 jquery mods，它们允许垂直滚动条，但没有找到。我用我现有的工具集尝试了不同的组合，但失败了。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:31:43.257

另一个答案是大衮。喜欢改用 Jquery。

```
$.get('http://foobar.com', function(data) { $('#divIdHere').html(data); }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:56:40.080

您始终可以像这样将滚动添加到您的 iframe 标记：

```
<iframe scrolling="yes" src="http://foobar.com" height="800" width="400"></iframe> 
```

然后使用[http://code.google.com/p/jscrollpane/](http://code.google.com/p/jscrollpane/)

# html - 样式化 HTML 元素：避免无效的父级

> ID：13480092
> 
> 赞同：1
> 
> 时间：2012-11-20T18:52:38.187
> 
> 标签：html, forms, html-lists

**情况：**

我有一个站点，其中包含跨多个页面的一长串问题。

每个问题都在一个由标签和输入组成的范围内。问题 div 组位于附加 div 中，以提供分组和边框样式等。

**问题：**

我想给我的问题编号，但想避免对编号进行硬编码。但是，将 html 放置`<li>`在 div 或标签内部是无效的。

此外，**一些问题 div 会**根据用户输入有条件地隐藏和显示。因此，div 提供了关键功能，并且数字必须与这些 div 一起隐藏和显示，（因此将每个`<li>`放在 div 之外是有问题的。

**代码：**

这是我的表单的精简结构示例，显示了两个问题“块”：

```
<form id="myform" method="post" action="/destinaion/page.php">
    <div class="formfield">
        <div class="page1">
            <div class="lowerborder">
                <div class="question">                      
                    <label for="q2">Question 1</label> 
                    <input type="number" id="q1" name="q1"/>
                </div>

                <div class="question">                      
                    <label for="q1">Question 2</label> 
                    <input type="number" id="q2" name="q2"/>
                </div>
            </div>
        </div>
    </div>
</form> 
```

div 类表单字段包含表单页面和 page1 页面 1 的各种样式细节。

我想从我的问题中列出一个有序的列表，也许像

**努力实现目标：**

```
<form id="myform" method="post" action="/destination/page.php">
    <div class="formfield">
    <ol>
        <div class="page1">
            <div class="lowerborder">
                <div class="question">                      
                    <label for="q2"><li>Question 1</li></label> 
                    <input type="number" id="q1" name="q1"/>
                </div>

                <div class="question">                      
                    <label for="q1"><li>Question 2</li></label> 
                    <input type="number" id="q2" name="q2"/>
                </div>
            </div>
        </div>
    </ol>
    </div>
</form> 
```

但是正如您所看到的，我将其中 a) 不是有效的 html`<li>`放入`<label>`其中，并且 b) 不能在所有浏览器中正常运行。

`<li>`当我的列表项被许多嵌套的 div 分隔时，如何避免将元素放入无效的父项中？

**jsFiddle：**

请参阅[我上述尝试的小提琴](http://jsfiddle.net/nWHcs/9/)。包括我试图实现的一些样式和功能（通过嵌套 div 设置样式、显示的隐藏问题等）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T01:47:04.810

请看[这个小提琴](http://jsfiddle.net/xH95y/2/)演示如何在不插入任何其他元素的情况下做你想做的一切。我发现任何地方都不需要一个 div。

注意：我最初用于`float:left`问题以使答案正确排列。但是，这导致 IE 呈现答案左侧的数字而不是问题左侧的数字。我切换到使用`display:inline-block`，现在一切都在 IE 中运行。

评论：

*   我清理了样式表，其中有一些重复和冲突的样式规则。我删除了不必要的规则。

*   我使用一个类创建了分隔问题组的线条，并且我还将它应用于问题的顶部边框而不是底部，这样即使有隐藏的问题结束了一个组，你也可以使用它，因为隐藏的问题可能永远不会开始一个小组。不需要额外的元素有边界。

*   在我看来，“显示”复选框的标签应该是它旁边的文本，以便您可以单击该文本来选中和取消选中该框。因此，我为问题项目添加了一个“问题”类，而不是使用标签。您必须将样式“问题”应用于问题以使其样式正确。您可以将其应用于标签元素（是否用于其他内容），或者您可以使用跨度或其他元素来包含不是标签的文本。

*   IE 7 愚蠢地将数字放在行的底部，即使问题的样式是`vertical-align:top`. 我现在不知道如何解决这个问题，但对于那些比我更擅长 CSS 怪癖的人来说，这可能是另一个问题。

*   IE 没有很好地处理“隐藏”方法，占用了额外的空间，然后在显示时不显示子元素，所以我改用绝对定位（通过将其从文档流中取出，具有相同的效果）。请参阅 CSS 以了解其工作原理。

*   我修改了您应用显示脚本的方式。我没有手动连接每个单独的项目，而是在复选框本身上放置一个数据值，然后在准备好的事件中，我使用它来适当地连接页面。现在，您可以拥有显示更多问题的复选框，只需向显示的问题添加一个 id（或者如果您需要一次显示多个问题，则使用 class 代替）和一个 data expando 属性，例如`data-togglehidden="l4"`指定要在复选框元素。无需更改脚本。

*   它看起来有点像你可能有“div-itis”，这是一种在整个地方增加 div 的趋势。不用尴尬，当我刚接触 html 开发时，我也有过 div-itis。由于这样的经历，你会从中成长。通常，您应该使用普通的非 div 页面元素并直接对其进行样式设置，而不是将内容包装在 div 中并对其进行样式设置。当您需要为一组相关功能设置样式或为不同元素提供一个框时，Div 很有用。*您可能*不正确地使用 div 的一个提示是当它们只有一个项目时（尤其是另一个 div）。有时这是必要的，但问问自己：我可以将样式移动到父元素或子元素吗？

*   我需要更多地了解您提到的“页面”是如何工作的并且在您的原始 html 标记中。html中*没有*页面，只有打印html时。所以我不太确定这意味着什么或如何为您设置页面样式。

这是清理后的 html，不需要 ol 和 li 之间的其他元素：

```
<form id="myform" method="post" action="/destination/page.php">
    <ol class="formfield">
        <li>
            <label class="question" for="q1">What is your first name?</label>
            <input type="text" id="q1" name="q1"/>
        </li>
        <li>
            <label class="question" for="q2">A very long question 2 that is sure to run to a second line just to prove that such a thing will work properly and not mess up the layout, described in your own words?</label>
            <input type="text" id="q2" name="q2"/>
        </li>
        <li class="begingroup">
            <span class="question">Are you the type of person who likes to needlessly answer extra questions?</span>
            <input type="checkbox" id="q3" name="q3" data-togglehidden="l4"/>
            <label for="q3">Yes, yes, that's me!!!</label>
        </li>
        <li id="l4" class="hidden">
            <label class="question" for="q4">Why do you like to do extra needless work?</label>
            <input type="text" id="q4" name="q4"/>
        </li>
        <li class="begingroup">
            <label class="question" for="q5">What was your first pet's name?</label>
            <input type="text" id="q5" name="q5"/>
        </li>
    </ol>
</form> 
```

这是 Firefox 16.0.2 中的样子：![Firefox 16.0.2 中的表单](../Images/285ddb38a3a9c7415d9a68333623a108.png)

在 IE 7.0.5730.13CO 中：![IE 7.0.5730.13CO 中的表单](../Images/09122f9214f9bad4efdd00d73620be9f.png)

CSS：

```
ol.formfield {
    width: 500px;
    margin: 10px auto;
    padding: 16px 16px 16px 0;
    border: 5px groove #005E9B;
    list-style: decimal outside;
    color: black;
    background-color: #6Fc2F7;    
    font-family: 'Oxygen', sans-serif;
    font-size:15px;
}

ol.formfield li {
    clear: both;
    padding: 2px;
    margin-left: 1.7em;
}

ol.formfield li.begingroup {
    margin-top: 8px;
    padding-top: 8px;
    border-top: 1px solid #005E9B;
}

.question {
    display:inline-block;
    width:300px;
    vertical-align:top;      
}

.hidden {
    position: absolute;
    height: 0;
    width: 0;
    overflow: hidden;
}

ol.formfield input {
    border-radius:5px; /* css 3 */
    -moz-border-radius:5px; /* mozilla */
    -webkit-border-radius:5px; /* webkit */
} 
```

`data`以及根据元素值连接隐藏/显示的脚本：

```
$('ol.formfield input:checkbox')
    .each(function() {
        var d = $(this).data('togglehidden');
        if(d) {
            $(this).on('change', function() {
                if ($(this).attr('checked')) {     
                    $('#' + d)
                        .removeClass('hidden')
                        .find(':input')
                        .focus();
                } else {
                    $('#' + d).addClass('hidden');
                }
            });
        }
    }); 
```

# java - Android doc：构造函数为 SoundPool 返回 null？

> ID：13480094
> 
> 赞同：3
> 
> 时间：2012-11-20T18:52:42.710
> 
> 标签：java, android, constructor, soundpool

我知道[这个](https://stackoverflow.com/questions/11103444/java-can-creating-an-object-return-a-null-reference)stackoverflow主题已经讨论了一般问题（构造函数从不返回`null`），但是考虑到它在这个具体问题中的意义，我想知道`SoundPool` [构造函数](http://developer.android.com/reference/android/media/SoundPool.html#SoundPool%28int,%20int,%20int%29)的官方Android文档是否有**错误**：

> 构造函数。返回 SoundPool 对象，如果创建失败则返回 null

我问这个是因为我们谈论的不亚于已经存在多年的 Android 官方文档（以防万一`SoundPool`）。

检查 Android 源代码，如果构造函数中出现错误，则会`SoundPool`抛出一个。`RuntimeException`（2.3 之前的 Android 甚至没有抛出异常。）也许文档试图表达如果捕获到异常，那么我打算存储对象引用的变量仍然为空？在这种情况下，文档的措辞仍然很糟糕。我错过了什么吗？

**编辑：**考虑到这可能不是一个内容非常丰富的问题​​（即使它可能有用——请参阅我的评论），一个简单的*“是”*或*“否”*就足够了，然后线程可以关闭。我想确保我没有忽略任何事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:27:35.467

1.  构造函数不能返回 null。他们可以抛出异常，但如果成功，他们只能返回他们创建的对象。
2.  如您所见，`SoundPool`可能会在其构造函数中引发异常。你可以忽略它。他们特别选择抛出`RuntimeException`（在 2.3+ 上）而不是检查异常，这表明 API 设计人员认为这是使应用程序崩溃的充分理由，并且不需要常规处理。
3.  如果您真的必须处理异常，那么我只需通知用户并立即退出。

所以**不**，它不能返回null。但是如果你处理异常然后**是**，你对对象的引用将是`null`因为构造函数没有完成。

# git - git 错误：此操作必须在工作树中运行

> ID：13480095
> 
> 赞同：0
> 
> 时间：2012-11-20T18:52:46.030
> 
> 标签：git, netbeans

我在 bitbucket 上有一个存储库，我想将它导入到我在实时共享主机 Web 服务器（我安装了 git）上创建的 .git 文件夹中。我可以通过 SSH 发出命令。我正在按照[http://joemaller.com/990/a-web-focused-git-workflow/中的说明进行操作](http://joemaller.com/990/a-web-focused-git-workflow/)

如文章中所述，我已经能够在服务器上设置 2 个存储库。我也有 post update 和 post commit hooks。我正在尝试通过将更新推送到服务器来测试系统。我正在使用 netbeans 7.3 beta git 支持。但是，当给出命令时：

```
push ( in netbeans ) to ssh://****.com/home/******/site_hub.git

==[IDE]== Nov 19, 2012 10:28:15 PM Pushing
git push ssh://***.com/home/***/site_hub.git +refs/heads/master:refs/heads/master
Repository Updates
Branch : master
Old Id : 0121897bdd7cf3caad9e18717fc27a7a08***
New Id : 837c194c70fb41dc7de3be7841c946ca***
Result : REJECTED_NONFASTFORWARD

Local Repository Updates
No update
==[IDE]== Nov 19, 2012 10:28:18 PM Pushing finished. 
```

有人建议我尝试“ git pull 以合并两个分支，然后推送结果” - 这不起作用。

我还被建议尝试“ git fetch ，然后是 git rebase origin/master （或你放在远程和 HEAD 分支的任何名称），这样你的提交就会应用到远程分支的顶部。然后你可以推送结果”

谁能建议我下一步该怎么做？

这可以在netbeans中完成还是我需要进入命令行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T15:22:57.477

我最终最终使用了[http://danielmiessler.com/study/git/#website](http://danielmiessler.com/study/git/#website)。我无法在 netbeans 中完成它，而是使用了 git gui - 问候，Bill

# android - Android HTTP PUT 请求仅在 Android 2.1 上返回 411 错误

> ID：13480101
> 
> 赞同：0
> 
> 时间：2012-11-20T18:53:04.337
> 
> 标签：android, http, rest, http-put

我在这里有一个应用程序，可以将 HTTP PUT 发送到网络服务器。代码如下所示：

```
 URL url = new URL(urlStr + "?" + encodedParameters);
  HttpURLConnection connection = (HttpURLConnection) url.openConnection();
  connection.setRequestMethod("PUT");
  connection.setRequestProperty("Content-Length", "0"); 
```

当我在 Android 2.1 上尝试这个时，我最终得到一个 411 错误（“需要长度”）。

在 Android 2.3.3 及更高版本上，我得到了同样的 411 错误，直到我添加了最后一个“Content-Length”属性。但它仍然在 Android 2.1 上发生。

任何人都知道这里可能发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:54:50.663

不确定这是否可行，但可能值得尝试设置“Content-Length”，如下所示：

```
connection.setRequestProperty("Content-Length", Integer.toString(encodedParameters.getBytes().length)); 
```

# c - opengl中的平滑阴影

> ID：13480109
> 
> 赞同：1
> 
> 时间：2012-11-20T18:53:32.300
> 
> 标签：c, opengl

我一直在到处寻找如何做到这一点，并查看了 opengl 的红皮书，它只讨论了对 2d 多边形进行平滑着色。我不确定您将如何为 glutSolidSphere 进行平滑着色。我知道你必须做 glShadeModel。当场景没有光线时，我如何区分它是平坦的还是光滑的。

```
#include <GLUT/glut.h>
#include <stdio.h>
#include <stdlib.h>
//Global variables
double sphere = 1, cone = 1, viewy = 2, viewx = -10, viewz = 5,headup = 5,headright = 5;
void myinit(){
    glClearColor(0,0,0,1);
    glShadeModel(GL_SMOOTH);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(60,1,1,100);
    //glOrtho(-2,20,-2,20,-10,10);
}
void drawRoom(){
    //floor
    glBegin(GL_POLYGON);
    glColor3f(1,1,1);
    glVertex3f(0,0,0);
    glVertex3f(0,10,0);
    glVertex3f(10,10,0);
    glVertex3f(10,0,0);
    glEnd(
    );
    //wall
    glBegin(GL_POLYGON);
    glColor3f(0,0,1);
    glVertex3f(0,10,0);
    glVertex3f(0,10,10);
    glVertex3f(10,10,10);
    glVertex3f(10,10,0);
    glEnd();
    //wall2
    glBegin(GL_POLYGON);
    glColor3f(0,1,0);
    glVertex3f(10,10,0);
    glVertex3f(10,10,10);
    glVertex3f(10,0,10);
    glVertex3f(10,0,0);
    glEnd();
}
void drawObjects(){
    //draw cone
    glColor3f(1,0,1);
    glTranslatef(2,2,0);
    glutSolidCone(cone,5,10,2);
    //draw sphere
    glTranslatef(5,5,0);
    glColor3f(1,0,0);
    glutSolidSphere(sphere,500,500);

}
void move(unsigned char key, int x, int y){
    switch(key){
        case 'y': 
            viewy++;
            glutPostRedisplay();
            break;
        case 'x':
            viewx++;
            glutPostRedisplay();
            break;
        case 'z':
            viewz++;
            glutPostRedisplay();
            break;
        //moves head
        case 'd':
            headup--;
            headright--;
            glutPostRedisplay();
            break;
        case 'a':
            headup++;
            headright++;
            glutPostRedisplay();
            break;
    }
}

void display(){
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    gluLookAt(viewx,viewy,viewz,headup,headright,5,0,0,1);
    glClear(GL_COLOR_BUFFER_BIT);
    drawRoom();
    drawObjects();
    glutSwapBuffers();
    glFlush();
}
int main (int argc, char** argv)
{
    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_RGB | GLUT_DOUBLE);
    glutInitWindowSize(500,500);
    glutInitWindowPosition(100,100);
    glutCreateWindow("Room");
    myinit();
    glutDisplayFunc(display);
    glutKeyboardFunc(move);
    glutMotionFunc(moveHead);
    glutMainLoop();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:09:23.357

您需要启用照明，启用至少一个灯光，并为您的几何体提供不同的每个顶点法线以查看`GL_SMOOTH`.

* * *

> ...当场景没有光线时，我如何区分它是平坦的还是光滑的。

您可以通过以下方式检索当前的着色模型`glGetIntegerv()`：

```
GLenum shadeModel;
glGetIntegerv( GL_SHADE_MODEL, &shadeModel ); 
```

# javascript - JqueryUI 可拖动 - 在 dom 中移动拖动的元素

> ID：13480111
> 
> 赞同：1
> 
> 时间：2012-11-20T18:53:40.333
> 
> 标签：javascript, jquery, html, jquery-ui

我遇到了 Javascript (Jquery + JqueryUI) 的一些问题。我想拖放一个元素。如果它在另一个特定元素之上，则重新创建该元素.. 下面我尝试制作一个简化的示例，以便您了解我的意思..

如何将拖动元素的代码正确移动到 dom 中的新位置？这应该发生在“结束”事件上。**不是**当我放下它的时候。当我“离开”放置区时，应该恢复之前所做的操作。表示复制回其源的元素，用相同的 id 替换另一个新创建的元素。

谢谢！帕拉

-Edit-：为了更好的可视化，我对代码进行了一些更改。当我删除此行时：

```
ui.draggable.attr("id", ui.draggable.attr("id") + "_bkp"); 
```

“out：”代码进入 out-Part.. 问题是，我必须更改该 id，否则将有 2 个相同的 id。我可以以某种方式告诉 jquery，那仍然是同一个元素吗？

```
<!doctype html> 
<html lang="en">
<head>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.1/themes/base/jquery-ui.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.js"></script>
    <script src="http://code.jquery.com/ui/1.9.1/jquery-ui.js"></script>
    <style>
        .bigbox{ width: 150px; height: 150px; padding: 0.5em; margin: 10px; border:thin solid black;}
        .box{ width: 100px; height: 100px; padding: 0.5em; margin: 10px 10px 10px 0; border:thin solid black;}
    </style>
    <script>
        $(function() {
            $("#draggable_1, #draggable-nonvalid").draggable();
            $("#droppable").droppable({
                over: function(event, ui) {
                    ui.draggable.attr("id", ui.draggable.attr("id") + "_bkp");
                    ui.draggable.appendTo($("#muell"));
                    $('#momo').append('<div id="draggable_1" class="box"><p>I am a new Elemento</p></div>');
                },
                accept: "#draggable_1",
                out: function(event, ui) {
                    $.each($("#muell > div"), function() {
                        var idOfBackedupElement = $(this).attr("id");
                        var origId = $(this).attr("id").replace("_bpk", "");
                        $("#" + origId).replaceWith($("#" + idOfBackedupElement));
                    });
                }
            });
        });
    </script>
</head>
<div id="momo" style="border:thin solid blue;float:left;">
    <div id="draggable_1" class="box" >
        <p>
            Drag me to my target
        </p>
    </div>
    <div id="droppable" class="bigbox">
        <p>
            accept: '#draggable'
        </p>
    </div>
</div>

<div id="muell" style="border:thin solid red;float:left;"></div>

</html> 
```

# c++ - 我如何验证给定类的每个实例都被应用程序终止破坏了？

> ID：13480113
> 
> 赞同：0
> 
> 时间：2012-11-20T18:53:42.743
> 
> 标签：c++, winapi, mfc, visual-studio-2012, global-variables

我写了一个`DBResourceMonitor`由一组数据库类使用的简单类。当我的一个数据库类的实例被创建时，它会注册自己，当被销毁时，它会使用`DBResourceMonitor`. 当应用程序终止时，该全局实例`DBResrouceMonitor`被销毁，它检查以确保没有任何它监视的类的剩余已注册实例（即，对于每个寄存器，都调用了一个注销），并发出一个 TRACE 输出如果不匹配，则断言。

这一切都很好......直到我将这些数据库对象中的几个作为我的全局应用程序对象的成员。因此，全局应用程序对象和应用程序`DBResourceMonitor`都是全局单例，应用程序是第一个被构造的，因此是最后一个被销毁的，因此当`DBResrouceMonitor`被销毁时，应用程序对象的成员还没有被注销，并且所以它会抛出一个错误，表明存在不匹配的注册/注销调用。

据我所知，没有办法确保`DBResrouceMonitor`在应用程序对象之前构建（因此在之后销毁）。

它是否正确？有没有一种聪明的方法来解决这个问题，或者重新考虑上面的方法，以便我仍然可以跟踪在最终线程终止之前是否所有事情都得到了照顾？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:02:22.713

您需要将对这些对象的引用存储在 Singleton 的集合属性中，而不是让对象注册/注销它们自己。所以不要这样做：

```
var x = new MyDBObject(); 
```

您将使用工厂模式，例如：

```
var x = DBResourceMonitor.GetDBObject(); 
```

在 DBResourceMonitor 的某个地方，您可以管理 MyDBObjects 的集合

```
MyDBObject GetDBObject()
{
//construct and save a MyDBObject or retrieve one from a list.

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:15:52.843

您可以让数据库对象与资源监视器相同，方法是在其构造函数中“注册”数据库对象，并在（虚拟）析构函数中“取消注册”它。这样您就可以只创建对象而不必担心单例或额外的监视器类。对象的集合当然是这个基类中的私有静态成员，在您使用多线程的情况下可能受到保护。

我也会使用[`std::unique_ptr`](http://en.cppreference.com/w/cpp/memory/unique_ptr)而不是原始指针，或者可能[`std::shared_ptr`](http://en.cppreference.com/w/cpp/memory/shared_ptr).

# linux - Bash 匹配二进制模式

> ID：13480119
> 
> 赞同：3
> 
> 时间：2012-11-20T18:54:11.503
> 
> 标签：linux, bash, grep

我想检查文件是否与二进制模式匹配。

为此，我正在使用 clamAV 签名数据库

```
Trojan.Bancos-166:1:*:3d415d736715ab5ee347238cacac61c7123fe35427224d25253c7b035558baf19e54e8d1a82742d6a7b37afc6d91015f751de1102d0a31e66ec33b74034b1ab471cc1381884dfdf0bb3e4233bd075fef235f342302ffd72ecabfa5aedf1b3dc99b3348346db4d9001026aef44c592fee61493f7262ad2bd1bce8a7ce60d81022533f6473ae184935f25cf6cc07c3aebfdf70a5a09139 
```

我对此进行编码以检索十六进制字符串表示签名

```
signature=$(echo "$line" |awk -F':' '{ print $4 }') 
```

此外，我将十六进制字符串更改为二进制

```
printf -v variable $(sed 's/\(..\)/\\x\1/g;' <<< "$signature") 
```

直到这里它完美地工作。

最后我想检查我的文件（ *$raw_file_path* ）是否匹配我的二进制模式（现在在 $variable 中）我试试这个

```
test_var=$(grep -qU "$variable" "$raw_file_path") 
```

或者

```
test_var=$(grep -qU --regexp="$variable" "$raw_file_path") 
```

我不知道为什么它不起作用，Grep 不匹配任何东西。有时会出现一些错误：

*   grep：尾随反斜杠

*   grep：无效的正则表达式

我知道它处理模式匹配问题。在我的测试中，我不想使用正则表达式。

如果您有任何想法或其他 bash 工具。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:01:02.563

您当前正在通过指定in来使用`--quiet`选项。这可以防止将任何内容打印到，因此不会将任何内容保存到。`grep``q``-qU``grep``stdout``test_var`

将您的代码更改为：

```
test_var=$(grep -UE "$variable" "$raw_file_path") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T06:30:08.573

首先可以避免额外的子外壳：

```
#!/bin/bash
signature="Trojan.Bancos-166:1:*:3d415d736715ab5ee347238cacac61c7123fe35427224d25253c7b035558baf19e54e8d1a82742d6a7b37afc6d91015f751de1102d0a31e66ec33b74034b1ab471cc1381884dfdf0bb3e4233bd075fef235f342302ffd72ecabfa5aedf1b3dc99b3348346db4d9001026aef44c592fee61493f7262ad2bd1bce8a7ce60d81022533f6473ae184935f25cf6cc07c3aebfdf70a5a09139"
variable=$(echo "${signature//*:/}" | sed 's/\(..\)/\\x\1/g;') 
```

只需要确认匹配：

```
if grep -qU "$variable" "$raw_file_path"; then
    # matches
fi 
```

或者要求将结果进行进一步处理：

```
test_var=$(grep -U "$variable" "$raw_file_path")
# contents of match in test_var 
```

返回变量时，greps `-q`opt 抑制标准输出

**编辑**

测试工作示例

```
> signature="Trojan.Bancos-166:1:All_text before-the last : should be trimed:3d415d736715ab5ee347238cacac61c7123fe35427224d25253c7b035558baf19e54e8d1a82742d6a7b37afc6d91015f751de1102d0a31e66ec33b74034b1ab471cc1381884dfdf0bb3e4233bd075fef235f342302ffd72ecabfa5aedf1b3dc99b3348346db4d9001026aef44c592fee61493f7262ad2bd1bce8a7ce60d81022533f6473ae184935f25cf6cc07c3aebfdf70a5a09139" \
> hex_string=$( echo "${signature//*:/}" | sed 's/\(..\)/\\x\1/g;' ) \
> echo "$hex_string"
\x3d\x41\x5d\x73\x67\x15\xab\x5e\xe3\x47\x23\x8c\xac\xac\x61\xc7\x12\x3f\xe3\x54\x27\x22\x4d\x25\x25\x3c\x7b\x03\x55\x58\xba\xf1\x9e\x54\xe8\xd1\xa8\x27\x42\xd6\xa7\xb3\x7a\xfc\x6d\x91\x01\x5f\x75\x1d\xe1\x10\x2d\x0a\x31\xe6\x6e\xc3\x3b\x74\x03\x4b\x1a\xb4\x71\xcc\x13\x81\x88\x4d\xfd\xf0\xbb\x3e\x42\x33\xbd\x07\x5f\xef\x23\x5f\x34\x23\x02\xff\xd7\x2e\xca\xbf\xa5\xae\xdf\x1b\x3d\xc9\x9b\x33\x48\x34\x6d\xb4\xd9\x00\x10\x26\xae\xf4\x4c\x59\x2f\xee\x61\x49\x3f\x72\x62\xad\x2b\xd1\xbc\xe8\xa7\xce\x60\xd8\x10\x22\x53\x3f\x64\x73\xae\x18\x49\x35\xf2\x5c\xf6\xcc\x07\xc3\xae\xbf\xdf\x70\xa5\xa0\x91\x39 
```

# java - Android 将 DatePicker 生成的日期转换为 SimpleDateFormat

> ID：13480120
> 
> 赞同：1
> 
> 时间：2012-11-20T18:54:13.550
> 
> 标签：java, android, datepicker, simpledateformat

我刚刚为我的应用程序实现了一个 DatePicker。但我很难理解如何将它（'theDate'）转换为 SimpleDateFormat("yyyy-MM-dd HH:mm:ss Z")，就像我下面代码中的 ('submitDate') 一样。

有人可以告诉我如何在我的代码中做到这一点吗？谢谢！

```
 protected Dialog onCreateDialog(int id) {
        switch (id) {
        case SDATE_DIALOG_ID:
            return new DatePickerDialog(this, 
            sDateSetListener, mYear, mMonth, mDay);        
        }
        return null;
    }

    private DatePickerDialog.OnDateSetListener sDateSetListener =
        new DatePickerDialog.OnDateSetListener() {
            public void onDateSet(DatePicker view, 
            int year, int monthOfYear, int dayOfMonth) {

                mYear = year;
                mMonth = monthOfYear;
                mDay = dayOfMonth;                                
                updateDate();
            }
    };

    private void updateDate() {
        inputDate.setText(
            new StringBuilder()                
                .append(mMonth + 1).append("-")
                .append(mDay).append("-")
                .append(mYear).append(" "));                
    }

    class CreateNewRequest extends AsyncTask<String, String, String> {

        protected String doInBackground(String... args) {

            Calendar c = Calendar.getInstance();
            SimpleDateFormat sd = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss Z");

            String submitDate = sd.format(c.getTime());

            String theDate = inputDate.getText().toString();

            List<NameValuePair> params = new ArrayList<NameValuePair>();

            params.add(new BasicNameValuePair("request_date", theDate));            
            params.add(new BasicNameValuePair("submitDate", submitDate));

            } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:57:02.197

步骤 1）您需要使用解析`theDate`为 Date 对象`SimpleDateFormatter`

您可能需要单独`SimpleDateFormatter`执行上述步骤，您已经为以下步骤工作的那个。

您的 thisDate 使用连字符作为分隔符进行格式化，因此步骤 1 的 SimpleDateFormatter 应使用连字符：

例子： `new SimpleDateFormat("MM-dd-yyyy");`

Step2) 将上述步骤中构造的 Date 对象作为输入而不是 c.getTime() 传递，然后您将获得所需的格式化日期。

编辑：

```
String theDate = inputDate.getText().toString();
SimpleDateFormat firstFormatter = new SimpleDateFormat("MM-dd-yyyy");
try {
      Date date = firstFormatter .parse(theDate );
      SimpleDateFormat sd = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss Z");
      String submitDate = sd.format(date);

    } catch (ParseException e) {
      e.printStackTrace();
    } 
```

# android - 笔记应用程序如何创建和保存您写的笔记

> ID：13480121
> 
> 赞同：-1
> 
> 时间：2012-11-20T18:54:11.480
> 
> 标签：android, file, listview, save

我正在开发一个应用程序，我基本上想实现某种类型的功能，就像笔记应用程序一样。基本上，我设置了一个列表视图，其中包含指向不同 xml 文件的链接。我希望用户有一个创建新选项，他们可以在其中将一些文本添加到编辑文本中，并能够保存文本并将其添加到我设置的列表视图中。

我的问题是 Note Pads 和 Memos 之类的应用程序如何。做这个。我需要设置某种类型的数据库吗？

我已经快速搜索了它并在堆栈上进行了快速搜索，但我不知道我是否正在寻找正确的东西。我只是在寻找朝着正确方向迈出的一步！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:18:18.163

他们都将数据保存在数据库中。对于 android，您应该使用 SQLite 数据库，因为它包含在 SDK 中。那里有很多很棒的 SQLite 教程，但我认为这是最好的

*   [http://www.vogella.com/articles/AndroidSQLite/article.html](http://www.vogella.com/articles/AndroidSQLite/article.html)

可以使用 来执行此操作`SharedPrefernces`，但为了效率和简单性，我不推荐它

# c++ - Qt 中的 const char* 错误行为

> ID：13480122
> 
> 赞同：2
> 
> 时间：2012-11-20T18:54:15.217
> 
> 标签：c++, qt, pointers, qstring, qmap

我`const char*`从一个类的两个函数返回 a 时遇到问题，由于某种原因，第一个值是第二个值的副本，或者某些值是错误的，但是返回的两个值都来自不同的指针，在这种情况下是两个`QMap`，以下是两个函数的代码：

```
const char* SomeClass::getSignal(QString signalName)
{
    QString signalsignature = this->signals.value(signalName);
    signalsignature.prepend(QString::number(QSIGNAL_CODE));
    QByteArray ba = signalsignature.toLatin1(); // i try toUTF8 and to Local8Bit
    const char* signalformated = ba.constData();
    return signalformated;
}

const char* SomeClass::getSlot(QString slotName)
{
    QString slotsignature = this->slots.value(slotName);
    slotsignature.prepend(QString::number(QSLOT_CODE));
    QByteArray ba = slotsignature.toLatin1();
    const char* slotformated = ba.constData();
    return slotformated;
} 
```

The`this->slot`和 the`this->signals`分别`QMap<QString, QString>`保存插槽和信号签名（`somesignal(int)`或分别`someslot(bool)`使用键`somesignal`）`someslot`。

我使用的类是通过`QLibrary`使用接口从 DLL 加载的，使用它的其他函数一切正常，但使用这些函数，如下所示：

```
const char* signal = someclassinstance->getSignal(tr("clicked"));
const char* slot = someclassinstance->getSlot(tr("onclicked"));

cout << "connecting signal " << signal << " to slot " << slot << endl; 
```

这告诉我：

```
connecting signal clicked to slot rc 
```

以及我使用 QObject::connect 时的错误

```
Object::connect: Use the SLOT or SIGNAL macro to connect NovaRadioButton:: rc 
```

我填充`QMap`s 是一些函数：

```
signals.insert(methodname,QString(metamethod.signature())); 
```

我不知道我做错了什么，或者可能是 Qt 函数中的错误`QString`，感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T18:57:48.613

当您的函数退出时，`ba`对象将被销毁。您返回的指针指向不再存在的对象的内存位置。这是返回本地指针的基本（也是众所周知的）错误：

```
char* foo()
{
    char c = 'a';
    return &c;
} 
```

您正在处理 QByteArray 的事实并不重要；它仍然是一个自动的局部变量，因此在函数退出时被破坏。

您应该改为直接返回 QByteArray，而不是`char*`. 这仍然有效，因为 QByteArray 使用[隐式共享](http://doc.qt.digia.com/qt/implicit-sharing.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:01:12.493

没有错误，您正在返回一个指向已销毁对象内部的指针。

像这样重写你的函数

```
QByteArray SomeClass::getSignal(QString signalName)
{
    QString signalsignature = this->signals.value(signalName);
    signalsignature.prepend(QString::number(QSIGNAL_CODE));
    return signalsignature.toLatin1(); // i try toUTF8 and to Local8Bit
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-09T08:21:32.443

`QByteArray`应该优先于`char*`. 来自 Qt 文档

> QByteArray 类提供了一个字节数组。
> 
> QByteArray 可用于存储原始字节（包括“\0”）和传统的 8 位“\0”结尾的字符串。使用 QByteArray 比使用 const char * 方便得多。在幕后，它始终确保数据后跟一个 '\0' 终止符，并使用隐式共享（写时复制）来减少内存使用并避免不必要的数据复制。

# c++ - 结构中的运算符重载

> ID：13480135
> 
> 赞同：17
> 
> 时间：2012-11-20T18:54:44.880
> 
> 标签：c++

假设我定义了这个结构：

```
struct Point {
   double x, y;
}; 
```

我怎样才能重载`+`运算符，以便声明，

```
Point a, b, c;
double k; 
```

表达方式

```
c = a + b; 
```

产量

```
c.x = a.x + b.x;
c.y = a.y + b.y; 
```

和表达式

```
c = a + k; 
```

产量

```
c.x = a.x + k;
c.y = a.y + k; // ? 
```

对于后一种情况，交换性质是否成立？也就是说，做`c = a + k;`和`c = k + a;`必须分开处理吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-20T18:59:56.357

去做就对了：

```
Point operator+( Point const& lhs, Point const& rhs );
Point operator+( Point const& lhs, double rhs );
Point operator+( double lhs, Point const& rhs ); 
```

关于您的最后一个问题，编译器不会 对您的操作员所做的事情做出*任何假设。*（请记住， `+`运算符 on`std::string`不是可交换的。）因此您*必须*提供两个重载。

或者，您可以提供 to 的隐式转换 `double`（`Point`通过在 中具有转换构造函数 `Point`）。在这种情况下，上面的第一个重载将处理所有三种情况。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-20T19:10:43.573

这是我将如何做到的。

```
struct Point {
   double x, y;
   struct Point& operator+=(const Point& rhs) { x += rhs.x; y += rhs.y; return *this; }
   struct Point& operator+=(const double& k) { x += k; y += k; return *this; }
};

Point operator+(Point lhs, const Point& rhs) { return lhs += rhs; }
Point operator+(Point lhs, const double k) { return lhs += k; }
Point operator+(const double k, Point rhs) { return rhs += k; } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-20T18:58:42.470

在 C++ 中，结构和类之间只有一个区别：在结构中，默认可见性是公共的，而在类中是私有的。

除此之外，您可以在结构中的类中做任何您想做的事情，并且看起来完全一样。

像在类中一样在结构中编写运算符重载。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-10T12:43:26.223

这也将起作用：

```
struct Point{
    double x,y;
    Point& operator+(const Point& rhs){ 
            x += rhs.x;
            y += rhs.y;
            return *this;
    }
} 
```

# java - JMS 持久异步事件通知

> ID：13480140
> 
> 赞同：1
> 
> 时间：2012-11-20T18:55:19.197
> 
> 标签：java, spring, events, jms

我希望有人为我指出一些要求的正确方向：我们需要通过我们的服务器发送异步可靠通知消息的消费者将随意订阅/取消订阅消费者数量将很大生产者将是一个通知，即使服务器宕机，也不会丢失，如果服务器再次启动，将会发送通知。通知的数量预计会很高 使用的线程数应该尽可能低。

鉴于上述（疯狂的）要求，我尝试使用 activemq/jms 解决这个问题。这看起来是正确的方向吗？

鉴于上述情况： 1\. 我使用了持久订阅者和 jms 消息和 kahadb。2 对于 jms 生产者，解决方案似乎很简单。3.对于消费者来说，我有麻烦了。

一种。虽然我有 spring，但我不能使用 jms:listener-container，因为我需要动态订阅和取消订阅消费者，这似乎是不可能的，所以我为我拥有的每个侦听器创建一个 SimpleListenerContainer。这听起来不错？湾。在 SimpleListenerContainer 中，我设置了 clientId（因为这是持久化所需的）

```
 super.setSubscriptionDurable(durable);
    if (durable ) super.setClientId(clientId); 
```

在这里，我有以下内容。给定以下配置：

```
 <bean id="messageBusReceiverConnectionFactory" class="org.apache.activemq.pool.PooledConnectionFactory" destroy-method="stop">
        <property name="maxConnections" value="10"/>
        <property name="maximumActive" value="500"/>
        <property name="connectionFactory" ref="jmsConnectionFactory"/>
        <property name="idleTimeout" value="0"/>
    </bean> 
```

我预计可能有 10*500=5000 个并行消费者。如果消费者不耐用，情况就是如此。但是，对于使用 super.setClientId(clientId) (super is SimpleMessageListenerContainer) 的持久消费者，在第 10 次连接后，我得到： org.springframework.jms.IllegalStateException: Setting clientID on a used Connection is not allowed; 嵌套异常是 javax.jms.IllegalStateException: Setting clientID on a used Connection is not allowed

所以看来我不能使用使用 SimpleMessageListenerContainer 的持久订阅者进行会话，只能用于连接。这是真的？maxConnections=500 和 maximumActive=1 听起来合理吗？这解决了我的问题，但是……虽然对 JMS 来说是新手，但这对经纪人来说似乎有点过分了。

好的，考虑到我仍然在正确的轨道上，我现在需要动态地取消订阅我的消费者/听众，所以我这样做了

```
container.stop();
container.destroy(); 
```

其中容器是 SimpleMessageListenerContainer。容器.destroy(); 调用时抛出一些异常。是否有必要调用它或停止方法就足够了？

好的，我知道这些问题是武断的，即使对于知道 jms（如果 jms 是正确的解决方案）并且几乎没有从我的代码中给出任何内容的人来说，也可能很难回答。我希望有人给我一些指导，让我知道我是否在正确的轨道上，尽可能多地给我提出的问题，然后我可以在需要的地方提供代码，以解决我剩下的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T14:11:53.230

我缺乏关于 spring 的知识来回答你关于 IllegalStateException 的问题，尽管我猜它与 maxConnections 设置为 10 有关。

你需要春天吗？在任何情况下，请确保您在 JMS 代理的配置中启用了持久性，确保使用持久队列/主题并确保`setDurable(true)`在消息上使用。

如果您想要可靠的消息传递，我认为您通常会做出正确的决定来使用功能强大的 JMS 提供程序。您可以使用 SPECjms2007 基准测试各种产品，具体取决于性能对您的重要性，也有一些可用的[结果](http://www.spec.org/jms2007/results/jms2007.html "SPECjms2007")。

# python - 通过经过身份验证的 HTTP 代理建立 TCP 连接？

> ID：13480141
> 
> 赞同：2
> 
> 时间：2012-11-20T18:55:20.993
> 
> 标签：python, http-proxy

我所在的网络需要我通过经过身份验证的 HTTP 代理进行连接才能访问网络外的任何内容。我需要做的基本上是制作一个`socket`（或等效的）连接到互联网，但通过代理发送所有数据而不是尝试直接发送。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T15:33:21.620

由于我没有找到任何可以使用的实际模块或其他代码，我最终编写了自己的通过代理连接的函数：

```
def http_proxy_connect(address, proxy = None, auth = None, headers = {}):
  """
  Establish a socket connection through an HTTP proxy.

  Arguments:
    address (required)     = The address of the target
    proxy (def: None)      = The address of the proxy server
    auth (def: None)       = A tuple of the username and password used for authentication
    headers (def: {})      = A set of headers that will be sent to the proxy

  Returns:
    A 3-tuple of the format:
      (socket, status_code, headers)
    Where `socket' is the socket object, `status_code` is the HTTP status code that the server
     returned and `headers` is a dict of headers that the server returned.
  """
  import socket
  import base64

  def valid_address(addr):
    """ Verify that an IP/port tuple is valid """
    return isinstance(addr, (list, tuple)) and len(addr) == 2 and isinstance(addr[0], str) and isinstance(addr[1], (int, long))

  if not valid_address(address):
    raise ValueError('Invalid target address')

  if proxy == None:
    s = socket.socket()
    s.connect(address)
    return s, 0, {}

  if not valid_address(proxy):
    raise ValueError('Invalid proxy address')

  headers = {
    'host': address[0]
  }

  if auth != None:
    if isinstance(auth, str):
      headers['proxy-authorization'] = auth
    elif auth and isinstance(auth, (tuple, list)):
      if len(auth) == 1:
        raise ValueError('Invalid authentication specification')

      t = auth[0]
      args = auth[1:]

      if t.lower() == 'basic' and len(args) == 2:
        headers['proxy-authorization'] = 'Basic ' + base64.b64encode('%s:%s' % args)
      else:
        raise ValueError('Invalid authentication specification')
    else:
      raise ValueError('Invalid authentication specification')

  s = socket.socket()
  s.connect(proxy)
  fp = s.makefile('r+')

  fp.write('CONNECT %s:%d HTTP/1.0\r\n' % address)
  fp.write('\r\n'.join('%s: %s' % (k, v) for (k, v) in headers.items()) + '\r\n\r\n')
  fp.flush()

  statusline = fp.readline().rstrip('\r\n')

  if statusline.count(' ') < 2:
    fp.close()
    s.close()
    raise IOError('Bad response')
  version, status, statusmsg = statusline.split(' ', 2)
  if not version in ('HTTP/1.0', 'HTTP/1.1'):
    fp.close()
    s.close()
    raise IOError('Unsupported HTTP version')
  try:
    status = int(status)
  except ValueError:
    fp.close()
    s.close()
    raise IOError('Bad response')

  response_headers = {}

  while True:
    tl = ''
    l = fp.readline().rstrip('\r\n')
    if l == '':
      break
    if not ':' in l:
      continue
    k, v = l.split(':', 1)
    response_headers[k.strip().lower()] = v.strip()

  fp.close()
  return (s, status, response_headers) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:06:57.907

我不确定这是否会有很大帮助，但你看过[pycurl](http://pycurl.sourceforge.net/)吗？这可以帮助您连接到提供用户名/密码身份验证系统的代理（请参阅[此](http://www.quietless.com/kitchen/curl-requests-http-authentication-in-python/)和[此](https://stackoverflow.com/questions/6999565/python-https-get-with-basic-authentication)）

# php - Codeigniter Image Resize 给出错误的输出

> ID：13480144
> 
> 赞同：0
> 
> 时间：2012-11-20T18:55:29.790
> 
> 标签：php, codeigniter, image-resizing

我正在使用**Codeigniter 2.0.2** 我想要图像尺寸**60x70**此代码没有给出任何错误并生成 *宽度 = 60 和高度 = 44*的图像有 什么问题？

```
 $config['source_image'] = $preview_path;
        $config['new_image'] = $dir_small_prev.$file_namee;
        $config['maintain_ratio'] = TRUE;
        $config['master_dim'] = 'width';
        $config['width'] = 60;
        $config['height'] = 70;
        $config['image_library'] = 'gd2';
        $config['quality'] = 100;
        $this->image_lib->initialize($config);
        if ( ! $this->image_lib->resize()){
        echo $this->image_lib->display_errors(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:56:20.660

`$config['maintain_ratio'] = TRUE;`将此设置为`FALSE`

你会扭曲你的图像，但你会得到你正在寻找的尺寸

# ssl - 来自 Google Docs 的 wget 上的 SSL 证书错误

> ID：13480145
> 
> 赞同：0
> 
> 时间：2012-11-20T18:55:31.287
> 
> 标签：ssl, batch-file, wget

我正在编写批处理脚本.. 将使用 wget 从谷歌文档下载。

我从谷歌公司收到 SSL 错误。

这是代码 wget（从此链接[Windows 批处理文件文件从 URL 下载](https://stackoverflow.com/questions/4619088/windows-batch-file-file-download-from-a-url)）

```
@echo off

for /F "tokens=2,3,4 delims=/ " %%i in ('date/t') do set y=%%k
for /F "tokens=2,3,4 delims=/ " %%i in ('date/t') do set d=%%k%%i%%j
for /F "tokens=5-8 delims=:. " %%i in ('echo.^| time ^| find "current" ') do set t=%%i%%j
set t=%t%_
if "%t:~3,1%"=="_" set t=0%t%
set t=%t:~0,4%
set "theFilename=%d%%t%"
echo %theFilename%

@pause
cd "C:\Users\MYNAME\Documents\TemObv\GnuWin32\bin"
wget.exe --output-document C:\Users\MYNAME\Documents\TemObv\file_%theFilename%.tsv https://docs.google.com/spreadsheet/pub?key=0AqSBI1OogE84dGN2bXRSZkZPVVRuNkMtN0p4eXpyVlE&single=true&gid=0&range=A5&output=txt
@pause 
```

这是来自 wget 的 ssl 错误

```
Resolving docs.google.com... 74.125.227.72, 74.125.227.73, 74.125.227.78, ...
Connecting to docs.google.com|74.125.227.72|:443... connected.
ERROR: cannot verify docs.google.com's certificate, issued by `/C=US/O=Google In
c/CN=Google Internet Authority':
  Unable to locally verify the issuer's authority.
To connect to docs.google.com insecurely, use `--no-check-certificate'.
Unable to establish SSL connection.
'single' is not recognized as an internal or external command,
operable program or batch file.
'gid' is not recognized as an internal or external command,
operable program or batch file.
'range' is not recognized as an internal or external command,
operable program or batch file.
'output' is not recognized as an internal or external command,
operable program or batch file.
Press any key to continue . . . 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:21:45.570

我不了解 Windows，但是 wget 的 unix 版本有一个名为 no-check-certificate 的标志，可以在这种情况下使用。

# phpdoc - 为一个巨大的 PHP 文件生成文档

> ID：13480146
> 
> 赞同：0
> 
> 时间：2012-11-20T18:55:33.547
> 
> 标签：phpdoc

我有一个巨大的 PHP 文件（大约 2 MB）。由于它是第三方文件，因此无法更改。现在我想使用自动文档生成器为其生成文档。

我试过 Doxygen、Apigen 和 PHP Documenter。但它每一个都会挂起或耗尽内存。

有没有办法为这个文件生成文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:58:06.253

您可以尝试增加 php.ini 中的内存限制设置

如果失败，您可以将文件拆分为几个新文件，然后将生成器的输出“缝合”在一起。

# c# - 使用带有 c# 动态的 jquery 模板？

> ID：13480150
> 
> 赞同：1
> 
> 时间：2012-11-20T18:55:51.533
> 
> 标签：c#, jquery, dynamic, jquery-templates

我不认为这会那么难，但我试图将一个具有动态属性的类（当前在 c# 中设置为 expando 对象）传递到视图中。在这个视图中，使用一些 jQuery 模板渲染了一个很好的部分，我想如果我在 c# 代码中有这个：

```
public dynamic SomeProperty {get;set;}
...
SomeProperty = new ExpandoObject();
SomeProperty.SomeValue = "5";
return View(TheClassThatContainsSomeProperty); 
```

这样在 jquery 模板中我可以这样做：

```
${SomeProperty.SomeValue} 
```

...并且希望它会起作用。它没有......如果您检查响应，您可以看到它实际上是作为字典发送的：

```
SomeProperty: [{SomeValue, Value:5}]
0: {Key:SomeValue, Value:5} 
```

这导致（我猜）我的下一个问题：是否有一种简单的方法可以访问 jquery 模板中的字典？我确实试过这个：

```
${SomeProperty["SomeValue"]} 
```

也无济于事。在这一点上，我唯一知道要做的就是利用在模板中放置函数的能力（从[jquery](http://api.jquery.com/template-tag-equal/)网站复制到这里）：

模板：

```
<tr><td>${getLanguages(Languages, " - ")}</td></tr> 
```

代码：

```
function getLanguages( data, separator ) {
    return data.join( separator );
} 
```

那么我是否过度复杂化了呢？我是否可以轻松地 1）从 jquery 模板访问动态值或 2）轻松地从 jquery 模板中的字典中查找值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:25:07.447

`ExpandoObject`派生自`IEnumerable<KeyValuePair<string, Object>>`，并且当您分配 时，大多数序列化程序会将 a 识别`dynamic`为这种类型`ExpandoObject`。**这就是为什么您会在 javascript 端看到一个带有命名键**::**值**对的数组类型。

[ExpandoObject 类 (System.Dynamic) @ MSDN](http://msdn.microsoft.com/en-us/library/system.dynamic.expandoobject.aspx)

使用的一种替代方法`ExpandoObject`是使用 C# 匿名类型。当序列化为 json 时，这些映射字段按您的预期。

[匿名类型（C# 编程指南）@ MSDN](http://msdn.microsoft.com/en-us/library/bb397696.aspx)

可以从 jQuery 访问使用声明的值`dynamic`，但很可能您不会返回`View()`带有要使用 jQuery 使用的模型的 MVC，因为任何服务器端视图模板引擎（剃须刀等）已经可以执行相同的操作具有较少开销的模板活动。相反，jQuery 模板更适合与 Ajax 调用一起使用。

下面的代码示例演示了三种情况，其中`dynamic`服务器上声明的变量在浏览器中与 jQuery 模板一起使用。

第一个示例对成员字段使用匿名类型`SomeValue`，并有一个将其视为成员对象的 jQuery 模板。

第二个示例对成员字段使用匿名类型数组，`SomeValue`并具有使用`{{each}}`语法枚举项目的模板。请注意，在这种情况下，事情可能会变得很糟糕`dynamic`，因为您没有得到强类型支持，并且必须知道正确的类型或在您访问它时发现它。

第三个示例使用`ExpandoObject`成员字段`SomeValue`，并具有与第一个示例类似的 jQuery 模板（单个成员对象）。请注意，在这种情况下，我们需要使用辅助函数`pivotDictionaryMap()`将**Key** :: **Value**对转换为对象成员。

从一个空白的 C# MVC3 Web 项目开始，我们需要修改三个文件来演示这些示例。

在**_Layout.cshtml**中，为 jQuery 模板添加脚本，并在 <head> 元素中添加适当版本的 jQuery。

```
<script src="@Url.Content("~/Scripts/jquery-1.8.2.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.tmpl.js")" type="text/javascript"></script> 
```

在**HomeController.cs**中，我们将添加一些返回 json`ActionResult`的方法。另外，为简洁起见，我们只`SomeModelType`在这里声明一个类；**请注意，一个适当的应用程序可能会在其Models**中声明此类。

```
using System.Dynamic; // up top...

public class HomeController : Controller
{
    public ActionResult Index()
    {
        ViewBag.Message = "Welcome to ASP.NET MVC!";

        return View();
    }

    public ActionResult SomeDataSource(int id)
    {
        dynamic d = new { innerId = 99, innerLabel = "inside object" };
        SomeModelType obj = new SomeModelType(id, "new object");
        obj.SomeValue = d;

        return Json(obj, "text/plain");
    }

    public ActionResult SomeDataSourceWithArray(int id)
    {
        dynamic d1 = new { innerId = 99, innerLabel = "inside object (first array member)" };
        dynamic d2 = new { innerId = 100, innerLabel = "inside object (second array member)" };

        SomeModelType obj = new SomeModelType(id, "new object");
        obj.SomeValue = new object[] {d1, d2};

        return Json(obj, "text/plain");
    }

    public ActionResult SomeDataSourceWithExpando(int id)
    {
        dynamic d = new ExpandoObject();
        d.innerId = 99;
        d.innerLabel = "inside object";

        SomeModelType obj = new SomeModelType(id, "new object");
        obj.SomeValue = d;

        return Json(obj, "text/plain");
    }
}

public class SomeModelType
{
    public SomeModelType(int initId, string initLabel)
    {
        Id = initId;
        Label = initLabel;
    }

    public int Id { get; set; }
    public string Label { get; set; }
    public dynamic SomeValue { get; set; }
} 
```

最后，在默认视图中，我们将为模板添加脚本标签以及使用它们所需的 javascript。注意`$.post()`and not的使用`$.get()`，因为`JsonResult`MVC 中的 a 默认不允许 GET 请求（您可以使用属性打开这些请求）。

```
@{
    ViewBag.Title = "Home Page";
}
<h2>@ViewBag.Message</h2>

<script id="someDataTemplate" type="text/x-jquery-tmpl">
Item <b>${Id}</b> is labeled "<i>${Label}</i>" and has an inner item with id <b>${SomeValue.innerId}</b> whose label is "<i>${SomeValue.innerLabel}</i>".
</script>

<h3>SomeDataSource Example #1 (Single Item)</h3>
<div id="someData">
</div>

<script id="someDataArrayTemplate" type="text/x-jquery-tmpl">
Item <b>${Id}</b> is labeled "<i>${Label}</i>" and has these inner items:
<ul>
 {{each SomeValue}}
    <li><b>${innerId}</b> has a label "<i>${innerLabel}</i>".</li>
 {{/each}}
</ul>
</script>

<h3>SomeDataSource Example #2 (Array)</h3>
<div id="someArrayData">
</div>

<script id="someDataTemplateFromExpandoObject" type="text/x-jquery-tmpl">
Item <b>${Id}</b> is labeled "<i>${Label}</i>" and has an inner item with id <b>${SomeValue.innerId}</b> whose label is "<i>${SomeValue.innerLabel}</i>".
</script>

<h3>SomeDataSource Example #3 (Single Item, Expando Object)</h3>
<div id="someDataFromExpandoObject">
</div>

<script type="text/javascript">
function pivotDictionaryMap(src)
{
    var retval = {};

    $.each(src, function(index, item){
        retval[item.Key] = item.Value;
    });

    return retval;
}
</script>

<script type="text/javascript">
$(document).ready(function() {
    // Ajax Round-Trip to fill example #1
    $.post("/Home/SomeDataSource/5", function(data) {
        $("#someDataTemplate").tmpl(data).appendTo("#someData");
    }, "json");

    // Ajax Round-Trip to fill example #2
    $.post("/Home/SomeDataSourceWithArray/67", function(data) {
        $("#someDataArrayTemplate").tmpl(data).appendTo("#someArrayData");
    }, "json");

    // Ajax Round-Trip to fill example #3
    $.post("/Home/SomeDataSourceWithExpando/33", function(data) {
        data.SomeValue = pivotDictionaryMap(data.SomeValue);
        $("#someDataTemplateFromExpandoObject").tmpl(data).appendTo("#someDataFromExpandoObject");
    }, "json");
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:08:03.453

不确定这是否有帮助，但看看[这个要点](https://gist.github.com/3042650)。很难从您的代码片段中分辨出来，但如果您要将其`ExpandoObject`转换为 JSON，请尝试将其包装在第一个上`DynamicJsonObject`，就像在 gist 中所做的那样。

* * *

Gist 中的代码复制/粘贴给那些不想点击链接的人：

```
// By default, Json.Encode will turn an ExpandoObject into an array of items,
// because internally an ExpandoObject extends IEnumerable<KeyValuePair<string, object>>.
// You can turn it into a non-list JSON string by first wrapping it in a DynamicJsonObject.
[TestMethod]
public void JsonEncodeAnExpandoObjectByWrappingItInADynamicJsonObject()
{
    dynamic expando = new ExpandoObject();
    expando.Value = 10;
    expando.Product = "Apples";

    var expandoResult = System.Web.Helpers.Json.Encode(expando);
    var dictionaryResult = System.Web.Helpers.Json.Encode(new DynamicJsonObject(expando));

    Assert.AreEqual("{\"Value\":10,\"Product\":\"Apples\"}", expandoResult); // FAILS (encodes as an array instead)
    Assert.AreEqual("{\"Value\":10,\"Product\":\"Apples\"}", dictionaryResult); // PASSES
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:24:00.813

仅在我不喜欢这个答案的前提下，我不会将自己的答案标记为“正确”。如果有人弄清楚我在上面试图做什么，我很乐意给你积分。

```
 function getDisplayValue(data, toMatchOn) {
        var _return = $.grep(data, function (n, i) { return (n.Key == toMatchOn); })[0];

        if (_return != null)
            return _return.Value;

        return "";
    } 
```

并在 jquery 模板中：

```
${getDisplayValue(DisplayFields, 'Something')} 
```

所以我能够让它与上述方法一起工作，所以这是一个可能的解决方案，但我不太了解javascript，无法知道这可能会造成多么糟糕的性能影响（当我研究它时，我会更新这个答案）但我认为 javascript 字典已针对其键值进行了优化，因此 MVC 没有将 expando 序列化为真正的 javascript 字典这一事实似乎使这个答案非常低效。事实上，我最初采用动态 c# 对象的方法是，我最初认为这会序列化为更清晰的形式。无论如何，这行得通，但奥卡姆剃刀只是让这种感觉太复杂了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T18:07:56.273

你是对的，如果你遍历一个数组来找到一个键，性能将会很粗略。但是您应该能够轻松地将键值对数组（服务器发回的）转换为“真正的”Javascript 字典/映射。例如：

```
var kvps = [ {key: "test", value: "expando"}, {key: "hello", value: "world" } ]; 
var map = {};
kvps.forEach(function(kvp) { map[kvp.key] = kvp.value; } );
console.log( JSON.stringify(map) ); 
```

> {“测试”：“扩展”，“你好”：“世界”}

当然，如果您是嵌套对象，那么您必须对上述方法应用递归才能使其工作。

# awk - awk 大于 小于

> ID：13480155
> 
> 赞同：2
> 
> 时间：2012-11-20T18:56:19.583
> 
> 标签：awk

我正在使用这个命令

```
num1=2.2
num2=4.5

result=$(awk 'BEGIN{print ($num2>$num1)?1:0}') 
```

这总是返回 0。无论是 num2>numl 还是 num1>num2 但是当我这样放置实际数字时

```
result=$(awk 'BEGIN{print (4.5>2.2)?1:0}') 
```

我会得到一个返回值 1。这是正确的。

我能做些什么来完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:59:52.723

因为`$num1`and`$num2`没有被 bash 扩展——你使用的是单引号。但是，以下将起作用：

```
result=$(awk "BEGIN{print ($num2>$num1)?1:0}") 
```

但是请注意，正如评论中指出的那样，这是一种糟糕的编码风格，并且混合了 bash 和 awk。就个人而言，我不介意这样的结构。但总的来说，尤其是对于复杂的事情，如果你不记得在双引号中 bash 会评估什么事情，请转向这个问题的其他答案。

请参阅下面评论中@EdMorton 的出色示例。

编辑：实际上，我会使用 awk 而不是`bc`：

```
$num1=2.2
$num2=4.5

result=$( echo "$num2 > $num1" | bc ) 
```

为什么？因为它更清晰……更轻。

或者使用 Perl（因为它更短，因为我喜欢 Perl 多于 awk 并且因为我喜欢反引号多于`$()`：

```
result=`perl -e "print ( $num2 > $num1 ) ? 1 : 0;"` 
```

或者，花哨（而且可能效率低下）：

```
if [ `echo -e "$num1\n$num2" | sort -n | head -1` != "$num1" ] ; then result=0 ; else result=1 ; fi 
```

（是的，我知道）

在史前时期，我曾短暂、密集、长达 3 年地接触过 awk。如今 bash 无处不在，可以做很多事情（当时我只有 sh/csh），所以它经常可以用来代替 awk，而计算机的速度足以让 Perl 用于临时命令行而不是 awk。只是在说'。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:02:38.107

尝试这样做：

```
result=$(awk -v num1=2.2 -v num2=4.5 'BEGIN{print (num2 > num1) ? 1 : 0}') 
```

看 ：

```
man awk | less +/'^ *-v' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T19:05:42.257

使用变量时失败的原因是`awk`单引号括起来的脚本是由`awk`而不是评估的`bash`：所以如果你想传递你正在使用的变量 from `bash`to `awk`，你必须使用`-v`如下选项指定它：

```
num1=2.2
num2=4.5

result=$(awk -v n1=$num1 -v n2=$num2 'BEGIN{print (n2>n1)?1:0}') 
```

**请注意**，脚本 中使用的程序变量`awk`不得以`$`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T00:38:18.703

这可能对您有用：

```
result=$(awk 'BEGIN{print ('$num2'>'$num1')?1:0}') 
```

把's 想象成通过命令向底层shell`'`戳洞。`awk``bash`

# java - 如何使用 URLConnection 上传二进制文件

> ID：13480160
> 
> 赞同：11
> 
> 时间：2012-11-20T18:56:26.240
> 
> 标签：java, upload, stream, httpurlconnection

为了将二进制文件上传到 URL，建议我使用[本指南](https://stackoverflow.com/a/2793153/870122)。但是，该文件不在目录中，而是存储在 MySql db 的 BLOB 字段中。`byte[]`BLOB 字段在 JPA中被映射为一个属性：

```
byte[] binaryFile; 
```

我以这种方式稍微修改了从指南中获取的代码：

```
HttpURLConnection connection = (HttpURLConnection ) new URL(url).openConnection();
// set some connection properties
OutputStream output = connection.getOutputStream();
PrintWriter writer = new PrintWriter(new OutputStreamWriter(output, CHARSET), true); 
// set some headers with writer
InputStream file = new ByteArrayInputStream(myEntity.getBinaryFile());
System.out.println("Size: " + file.available());
try {
    byte[] buffer = new byte[4096];
    int length;
    while ((length = file.read(buffer)) > 0) {
        output.write(buffer, 0, length);
    } 
    output.flush();
    writer.append(CRLF).flush();
    writer.append("--" + boundary + "--").append(CRLF).flush();
} 
// catch and close streams 
```

我没有使用分块流。使用的标题是：

```
username and password
Content-Disposition: form-data; name=\"file\"; filename=\"myFileName\"\r\nContent-Type: application/octet-stream"
Content-Transfer-Encoding: binary 
```

主机正确接收所有标头。它也接收上传的文件，但不幸的是抱怨文件不可读，并断言接收到的文件的大小比我的代码输出的大小大 37 个字节。

我对流、连接和字节 [] 的了解太有限，无法掌握解决此问题的方法。任何提示表示赞赏。

* * *

编辑

正如评论者所建议的那样，我也尝试过直接编写 byte[]，而不使用 ByteArrayInputStream：

```
output.write(myEntity.getBinaryFile()); 
```

不幸的是，主持人给出的答案与另一种方式完全相同。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T20:58:35.723

我的代码是正确的。

主机给出了一个错误，因为它没有预料到`Content-Transfer-Encoding`标题。删除它后，一切都很顺利。

# jquery - 每秒点击一次的触发功能（jQuery）

> ID：13480162
> 
> 赞同：0
> 
> 时间：2012-11-20T18:56:35.477
> 
> 标签：jquery

我在页面上有一个按钮，我希望每秒最多被触发一次。这意味着如果用户像疯子一样点击它五秒钟，它只会被执行五次。我一直在谷歌搜索和搜索堆栈，没有结果。还尝试了 Alman 的油门/去抖动插件，但似乎不适用于点击。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:02:31.770

使用计时器

```
 var clicked = false;
 setInterval(function(){
     clicked = false;
 },5000);

if($('.button').click(function(){
   if(!clicked){
      do job;
      clicked = true;
   }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:01:01.127

为什么不在按钮的单击事件中禁用按钮 1 秒？

```
$('#my_button').click(function() {
    /*
    your logic here
    */

    // disable the button for 1 second
    $(this).attr('disabled', 'disabled').delay(1000).removeAttr('disabled');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:02:11.133

创建一个终止事件的节流阀，除非距离上一次单击已经 1 秒。

```
var clicked = false;
$(element).click(function(e){
    e.preventDefault();
    if (clicked) {
        return;
    }
    clicked = true;
    console.log("Do Stuff");
    setTimeout(function(){
        clicked = false;
    },1000);
}); 
```

或者您可以使用数据属性来避免额外的变量：

```
$(element).click(function(e){
    e.preventDefault();
    if ($(this).data("clicked")) {
        return;
    }
    $(this).data("clicked",true);
    console.log("Do Stuff");
    setTimeout(function(){
        $(this).data("clicked",false);
    },1000);
}).data("clicked",false); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T19:09:26.447

试试这个：

```
$(function(){
    var currentTime = (new Date()).getTime();
    $("input:button").click(function(){
        var nowTime = (new Date()).getTime();
        var diff = Math.abs((nowTime - currentTime)/1000);

        if(diff < 1) 
            return;

        currentTime = nowTime;

        // do your stuff
    });
}); 
```

# jquery - 在 @Html.TextBoxFor 上设置焦点

> ID：13480166
> 
> 赞同：0
> 
> 时间：2012-11-20T18:56:48.940
> 
> 标签：jquery, asp.net-mvc-3, focus

我无法让文本框的焦点正常工作。

```
 <script type="text/javascript">
    $(document).ready(function () {
        $('#focus').focus();
    });
</script> 
```

--

```
@Html.TextBoxFor(m => m.ListFields[i].Value, new { id = "focus" })<br /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:00:33.657

由（主要`id`是`TextBoxFor`什么使它“为”模型字段具有与属性名称匹配的名称/ID）设置。

最好使用类似的微格式`new { uifocus = "focus" }`（或者只是一个类，如果您愿意的话）。您可以选择如下：

```
$('input[uifocus=focus]').focus(); 
```

# javascript - 查找不包含特定字符串的所有元素

> ID：13480169
> 
> 赞同：5
> 
> 时间：2012-11-20T18:57:04.467
> 
> 标签：javascript, jquery, jquery-selectors

是否可以选择具有某个类的所有元素，但如果它们包含某些元素则不能`.text()`？

这是我到目前为止所拥有的 -

```
<div class="test">0</div>
<div class="test">1</div>
<div class="test">2</div>
<div class="test">3</div>
<div class="test">4</div>

var divList = $(".test").toArray();
var divLength = divList.length; 
```

我想用这段代码做的是不包含`<div>`0 。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-20T18:58:47.323

```
$('.test').not(':contains(0)') 
```

[http://api.jquery.com/contains-selector/](http://api.jquery.com/contains-selector/)

顺便说一句，要回答 epascarello 的问题，这将匹配元素内的 ANY 子字符串 ANYWHERE。如果您的数字上升到 10，它也会匹配并打折那个数字。如果这对您来说是个问题，您将需要一个自定义选择器或一个`.filter()`函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T19:01:07.913

一个快速的谷歌把它带到了表面[http://forum.jquery.com/topic/jquery-opposite-of-contains](http://forum.jquery.com/topic/jquery-opposite-of-contains)

归根结底

```
$(".test:not(:contains('0'))") 
```

**编辑**

@jbabey 的测试表明接受的答案更快，所以使用它

```
$(".test").not(":contains(0)"); 
```

作为对 epascarello 的回答的后续，以下选择器将进行完全匹配（默认情况下不包含在 jQuery 中！）

```
$.expr[":"].econtains = function(obj, index, meta, stack){
    return (obj.textContent || obj.innerText || $(obj).text() || "").toLowerCase() == meta[3].toLowerCase();
} 
```

要进行完全匹配，您现在可以使用

```
$(".test").not(":econtains(0)");​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:00:57.267

你可以试试这个： -

```
$(".test:not(:contains('0'))") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T19:01:08.523

这是一个不使用`:contains`选择器的方法

你可以使用`.filter()`函数

```
$('.test').filter(function(){
    return $(this).text().indexOf('0') < 0 ;
}); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/AYCw2/)**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T19:08:46.977

这也是获取所需文本的方法之一：http: [//jsbin.com/arifuv/1/edit](http://jsbin.com/arifuv/1/edit)

```
var aa = $('.test').filter(':not(:contains(0))').text();

console.log(aa);

// results are ---> 1234 
```

# mysql - MYSQL 错误 1045 拒绝访问

> ID：13480170
> 
> 赞同：9
> 
> 时间：2012-11-20T18:57:07.863
> 
> 标签：mysql, macos, terminal, osx-mountain-lion, mysql-python

我刚买了一个新的 macbook pro (OS X 10.8.2)，并试图在上面设置 mysql。到目前为止，我已经能够安装它，但我无法获得我的 root 用户访问权限（或任何用户）。我计划将它用于`Python`，在我的另一台计算机上我只使用 MYSQL（没有 MAMP），我更喜欢保持这种方式。

作为参考，我做了以下事情：

`$ alias mysql=/usr/local/mysql/bin/mysql $ sudo /Library/StartupItems/MySQLCOM/MySQLCOM start $ alias mysqladmin=/usr/local/mysql/bin/mysqladmin`

当我进入`mysql`或`mysql -u root -p`它给我这个：

`ERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES)`

或者

`ERROR 1045 (28000): Access denied for user 'jmitch'@'localhost' (using password: NO)` 取决于我使用的措辞

MYSQL 在我的系统首选项中运行。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-20T19:10:44.200

也许更新程序包更新程序覆盖了 root 密码。

要恢复它：

停止 mysqld 守护进程。

```
$ sudo service mysqld stop 
```

进入 mysql/bin 目录

```
$ cd /usr/bin 
```

使用此选项启动 mysql 守护程序：

```
$ sudo mysqld_safe --skip-grant-tables 
```

打开另一个终端并打开一个 mysql 会话来执行这个：

```
$ mysql

mysql> use mysql;

see Note1 below for next line.
mysql> UPDATE user SET password=PASSWORD('YOUR_NEW_PASSWORD_HERE') WHERE user = 'root';

mysql> exit; 
```

现在杀死mysqld_safe进程并正常重启mysqld：

```
$ sudo service mysqld start 
```

***注 1：*** 是5.7 版本之前`password`的表中的列名`mysql.user`之后就变成了`authentication_string`。相应地更改您的更新声明。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-06-30T15:40:20.923

在 Mac OSX 10.9 Mavericks 上，我使用了 support-files 目录中的“mysql.server”脚本，而不是 mysqld_safe 和 service 脚本。

```
$sudo ./mysql.server stop
$sudo ./mysql.server start --skip-grant-tables
$ mysql
mysql> use mysql;
mysql> UPDATE user SET password=PASSWORD('YOUR_NEW_PASSWORD_HERE') WHERE user = 'root';
mysql> exit;
$sudo ./mysql.server stop
$sudo ./mysql.server start 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-17T17:56:45.537

我在尝试通过 Mountain Lion 上的终端访问 MAMP 的 MySQL 时遇到了类似的问题。

--no-defaults 标志为我解决了这个问题。

```
/Applications/MAMP/Library/bin/mysql --no-defaults -u root -proot -h localhost 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-31T11:04:24.390

我想为 MySQL 5.7 添加它，简单地更改 authentication_string 列是行不通的。这是因为 MySQL 从不实际使用这些值进行 root 身份验证，它使用插件。据我所知，这个插件验证你也是主机帐户的 root（所以你必须 sudo mysql -u root）。

我能够让它工作的唯一方法是运行它：

```
UPDATE mysql.user
SET authentication_string=PASSWORD(''), plugin=''
WHERE mysql.user = 'root'; 
```

还应该注意的是，5.7 的官方 MySQL 文档从未提及这一点。遵循此文档的信函让您一无所获。

# ipad - 向现有客户分发 iphone 应用程序

> ID：13480172
> 
> 赞同：2
> 
> 时间：2012-11-20T18:57:34.710
> 
> 标签：ipad, app-store

有谁知道应用程序开发的开发者企业选项是否有替代方案？

我们正在考虑开发一个应用程序，但我不确定是否会通过 App Store 获得批准，因为覆盖面可能不够大？

该应用程序将显示我们为客户收集的各种数据，因此它仅与我们现有的客户真正相关

苹果会在 App Store 上允许这样的应用吗？

我认为企业软件包不适用，因为这似乎是针对我们组织中的人员，我们希望能够将应用程序分发给我们的客户

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:08:12.443

我在您所描述的内容中没有看到任何违反[App Store 审查指南](https://developer.apple.com/appstore/resources/approval/guidelines.html)（需要登录）的内容。

此外，如果苹果拒绝一个应用程序，因为它只对特定公司的客户有用，这将违背他们通过接受银行、信用卡、经纪账户、Netflix、Carbonite 等应用程序所设定的先例。

那么苹果会在这个基础上拒绝你吗？几乎可以肯定不是，但真正确定的唯一方法是提交应用程序并找出答案。

* * *

如果您无法访问完整列表，以下是一些可能适用于您也可能不适用于您的功能的指南：

> **2.12**不是很有用、不独特、只是捆绑为应用程序的网站或不提供任何持久娱乐价值的应用程序可能会被拒绝
> 
> **2.13**主要是营销材料或广告的应用程序将被拒绝
> 
> **2.22**任意限制哪些用户可以使用应用程序的应用程序，例如位置或运营商，可能会被拒绝

据我了解，这些都不适用于您的情况。

# git - 单个 git 分支是否可以有 2 个名称？

> ID：13480182
> 
> 赞同：1
> 
> 时间：2012-11-20T18:58:11.523
> 
> 标签：git

> **可能重复：**
> [是否可以在 Git 中为分支起别名？](https://stackoverflow.com/questions/549920/is-it-possible-to-alias-a-branch-in-git)

我们的代码有一个公共版本和一个内部版本。现在我们有 2 个分支，我们必须手动向每个分支提交更改以保持它们同步。有没有办法创建一个别名或其他东西，让开发人员在一个具有 2 个不同名称的分支中使用？

这个想法是一组开发人员只知道并使用公共版本，所以他们会做一个`git checkout pub-1.0.0`和另一个部门的开发人员只知道内部版本，所以他们会做一个`git checkout dev-1.2.3`.

两组开发人员都应该使用相同的代码。应该在 dev-1.2.3 和 visa verse 中看到对 pub-1.0.0 的提交。

这种设置可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:01:16.227

从[是否可以在 Git 中为分支起别名？](https://stackoverflow.com/questions/549920/is-it-possible-to-alias-a-branch-in-git)：

> 您可以创建对 master 分支的符号引用：
> 
> ```
> git symbolic-ref refs/heads/trunk refs/heads/master 
> ```
> 
> 请注意，主干不是一等公民。如果您签出trunk 并执行git status，您实际上将在master 上，但是您可以在所有使用分支名称的地方（日志、合并等）使用trunk 命令。

# java - Java，最快的从 txt 文件中读取的类

> ID：13480183
> 
> 赞同：6
> 
> 时间：2012-11-20T18:58:12.867
> 
> 标签：java, io, java-io

我必须在我的程序中阅读 txt 文件。我目前正在使用 FileReader 和 BufferedReader。我尝试使用 Scanner，但它比 FileReader 和 BufferedReader 慢。有没有什么类可以更快地读取文件？它必须用 Java 语言编写。

我需要从文本文件中读取所有单词（由空格分隔的字符串）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:05:08.927

假设您读取内存中的所有文件，从代码编写的角度来看，最快的是：

```
List<String> lines = Files.readAllLines(yourFile, charset); 
```

从执行的角度来看，我希望性能即使不是更好也一样好（据说这已经由编写它的团队进行了优化）。

然后，您可以拆分或做任何您需要的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:06:09.313

如果正在读取的文件很大，那么您可能希望`BufferedReader`在 a 之上使用`FileReader`来提高读取性能。

或者你可以尝试这样的事情： -

```
 BufferedReader br = new BufferedReader(new FileReader("file.txt"));
try {
    StringBuilder sb = new StringBuilder();
    String line = br.readLine();

    while (line != null) {
        sb.append(line);
        sb.append("\n");
        line = br.readLine();
    }
    String everything = sb.toString();
   } finally {
    br.close();
} 
```

或者你可以试试这个程序。它适用于较大的文件更快： -

```
public String readDoc(File f) {
String text = "";
int read, N = 1024 * 1024;
char[] buffer = new char[N];

try {
    FileReader fr = new FileReader(f);
    BufferedReader br = new BufferedReader(fr);

    while(true) {
        read = br.read(buffer, 0, N);
        text += new String(buffer, 0, read);

        if(read < N) {
            break;
        }
    }
} catch(Exception ex) {
    ex.printStackTrace();
}

return text;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T19:46:21.910

读取和拆分的速度是`85 MB/sec`. 我使用了 560 MB 文件，每行 20 列。这是代码：

```
package csvreader_speedtest;

import java.io.*;

public class Csvreader_SpeedTest {

    final char delimiter = ',';
    String[] splitted = new String[64];

    Csvreader_SpeedTest(String filename) throws Throwable {
        File file = new File(filename);
        BufferedReader reader = new BufferedReader(new FileReader(file));
        String line;
        long t0 = System.currentTimeMillis();
        while ((line = reader.readLine()) != null) {
            split(line);
        }
        long t1 = System.currentTimeMillis();
        reader.close();
        System.out.println("read " + file.length() + " bytes in " + (t1 - t0) + " ms");
    }

    private void split(String line) {
        int idxComma, idxToken = 0, fromIndex = 0;
        while ((idxComma = line.indexOf(delimiter, fromIndex)) != -1) {
            splitted[idxToken++] = line.substring(fromIndex, idxComma);
            fromIndex = idxComma + 1;
        }
        splitted[idxToken] = line.substring(fromIndex);
    }
} 
```

输出：

```
read 561362951 bytes in 6575 ms 
```

**更新：** 如果我使用`splitted = line.split(",");`而不是`split(line);`，速度下降到`32 MB/sec` **更新2：**不分裂，速度是`194 MB/sec`。你需要多快？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T19:47:01.767

如果您的文件很大 Files.readAllLines 将不起作用。但是，如果您仍然想尝试 NIO，这很容易：

```
FileInputStream fis = new FileInputStream("test.txt");
Reader rdr = Channels.newReader(fis.getChannel(), "UTF-8");
BufferedReader br = new BufferedReader(rdr);
... 
```

# networking - 为什么我们可以使用 IDM 更快地下载

> ID：13480185
> 
> 赞同：3
> 
> 时间：2012-11-20T18:58:24.963
> 
> 标签：networking, web, network-programming, social-networking

我对使用 IDM 或不使用 IDM 下载有疑问

问题是，我们有相同的带宽和服务器共享相同的带宽

用于 IDM 和简单的下载管理器。

但是为什么我们可以使用 IDM 更快地下载？是什么原因？

天津...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T19:10:18.017

如果没有下载加速器，您可能不会遇到您和远程服务器的带宽瓶颈。这意味着你们中的一个或两个都有更多的带宽可以利用。

下载加速器以两种方式利用此额外带宽：

1.  通过增加与服务器的连接数，IDM 会消耗您的全部或最大带宽，并增加用于下载的 Internet 总带宽的比例。
2.  远程服务器将其总带宽除以与它的连接数。因此，与服务器的多个连接可确保您使用的总带宽是这些划分带宽的总和，从而消除了另一个瓶颈。

有关更多信息，请参见[http://en.wikipedia.org/wiki/Download_manager#Download_acceleration](http://en.wikipedia.org/wiki/Download_manager#Download_acceleration)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:03:20.507

通常，下载管理器通过与远程服务器建立多个同时连接来加速。我相信 IDM 实际上可能同时向同一个文件发出多个请求，从而欺骗服务器通过多个连接提供更高的带宽。服务器通常在每个连接的基础上限制带宽，因此通过建立多个连接，您可以获得更高的总带宽。

# android - 显示关闭时Android媒体控制器暂停？

> ID：13480186
> 
> 赞同：0
> 
> 时间：2012-11-20T18:58:26.533
> 
> 标签：android, mediacontroller

当屏幕显示自行或手动关闭时，有没有办法阻止媒体控制器暂停。我的应用程序使用媒体控制器从互联网流式传输音频文件，因此即使屏幕关闭，我也需要它继续播放。任何帮助将非常感激。

这是我的媒体控制器类的代码：

```
import android.app.Activity;
import android.content.Context;
import android.view.KeyEvent;
import android.widget.MediaController;

public class WillMediaController extends MediaController {

    public WillMediaController(Context context) {
        super(context);
    }

    @Override
    public void hide() {
        // Do Nothing to show the controller all times

    }

    @Override
    public boolean dispatchKeyEvent(KeyEvent event)
    {
        if (event.getKeyCode() == KeyEvent.KEYCODE_BACK)
        {
            ((Activity) getContext()).finish();

        }else{
            super.dispatchKeyEvent(event);
        }
        if (event.getKeyCode() == KeyEvent.KEYCODE_VOLUME_DOWN ||
                event.getKeyCode() == KeyEvent.KEYCODE_VOLUME_UP) {
            // don't show the controls for volume adjustment
            return super.dispatchKeyEvent(event);
        }
        return true;

    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:30:53.313

我不确定是否有办法防止 MediaController 在活动暂停时（即屏幕关闭时）自行暂停，但我确实有几个想法：

首先，您可以尝试通过以下方式禁用屏幕在您的活动中超时：

```
getWindow().setFlags(android.view.WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON,
                     android.view.WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON); 
```

但是，这可能不会阻止用户点击锁定按钮并手动关闭屏幕并结束音频播放。

其次，您可以创建一个带有 MediaPlayer 的服务，以在后台播放您的音频流并响应来自您的应用程序的播放/暂停命令：http: [//developer.android.com/guide/topics/media/mediaplayer.html#mpandservices](http://developer.android.com/guide/topics/media/mediaplayer.html#mpandservices)

# ruby - 使用 rmagick 的多语言文本

> ID：13480189
> 
> 赞同：2
> 
> 时间：2012-11-20T18:58:33.460
> 
> 标签：ruby, utf-8, fonts, rmagick

我正在使用 rmagick 以编程方式用文本注释图像。文本需要支持多种语言，包括中文、韩文、英文等。我正在处理的字体要求非常具体，为英文选择的字体支持多种西方语言，但不支持中文或韩文。我将为这些语言提供其他字体。

我想到的方法是将字符范围映射到特定字体，并基于此以编程方式告诉 rmagick 要使用什么字体。我是否遗漏了任何明显的东西，或者这是一个很好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T22:33:27.417

这是我最终解决此问题的方法：

```
def font_for(verb)
  return "#{Rails.root}/app/uploaders/fonts/Gotham-Bold.ttf" if verb =~ /\p{Latin}/
  return "#{Rails.root}/app/uploaders/fonts/ArialUnicode.ttf"
end 
```

该方法将获取一些文本并将路径返回到适当的字体。正则表达式的[字符属性匹配](http://www.ruby-doc.org/core-1.9.3/Regexp.html#label-Character+Properties)在这里派上用场！然后我可以在我的 rmagick 脚本中使用 font_for 方法来注释图像。

```
 def create_image_with_text
    canvas = Magick::ImageList.new
    canvas.new_image(640, 480)  {self.background_color = "white"}
    text = Magick::Draw.new
    text.font = font_for "english"
    text.pointsize = 23
    text.gravity = ::Magick::NorthGravity
    text.annotate(canvas, 0,0,0,28, "ENGLISH") { self.fill = '#343434' }
    text.font = font_for self.verb
    text.pointsize = 65
    text.gravity = ::Magick::CenterGravity
    text.annotate(canvas, 0,0,0,18, self.verb.upcase) { self.fill = '#343434' }
    tempfile = Tempfile.new(['new_center_stripe', '.jpg'])
    canvas.write tempfile.path
    self.image.store!(tempfile)
  end 
```

值得注意的是，这种简单化的方法无法处理混合语言的输入。

# ruby-on-rails - 在rails中返回修改后的对象

> ID：13480190
> 
> 赞同：1
> 
> 时间：2012-11-20T18:58:38.483
> 
> 标签：ruby-on-rails, ruby

我正在尝试制作一个可链接的方法，以便我可以编写：

```
@blog = Blog.new.set_user(current_user).save 
```

代替

```
@blog = Blog.new
@blog.user = current_user 
```

我在模型中定义了以下方法：

```
def set_user(user)
  self.user = user
  return self
end 
```

除了它不起作用。如何创建一个方法来返回更新的实例，以便可以对其进行进一步的链接？

**更新：** 我的错，这就是我做错了：可链接的方法被命名为“用户”，因此它与模型自己的`blog.user`方法冲突。我将名称更改为独特的名称，瞧！有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:12:31.213

我会尝试在 Rails 中避免这种情况，并使用模型关联和范围来完成部分工作：

```
@blog = current_user.blogs.create 
```

关于您提出的问题，返回 self 应该完成工作 idd，您能否在创建博客时编写控制台的输出，并让我们知道输出是什么：

```
@blog.inspect 
```

也许错误在其他地方......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:01:19.427

您的`set_user`方法应该返回一个用户实例。`self`在这种情况下是`Blog`

```
def set_user(user)
  user
end 
```

如果您正在使用 Rails 并且两者之间存在关联，`Blog`并且`User`您已经能够做到

`blog.user`或`blog.users`基于您在这些模型之间的关联类型。

# c++ - std::map 插入错误：没有运算符“<”匹配这些操作数

> ID：13480197
> 
> 赞同：4
> 
> 时间：2012-11-20T18:59:17.897
> 
> 标签：c++, operators, stdmap

试图复习我的 C++ 和 STL 熟练程度，遇到了 std::map 由我定义的结构键入的问题。相关代码：

```
typedef struct key_t {
   int a;
   int b;
   bool operator==(const key_t& rhs)
   {
      return (a == rhs.a) && (b == rhs.b);
   }
   bool operator<(const key_t& rhs) //added the when I saw this error, didn't help
   {
      return a < rhs.a;
   }
} key_t;

std::map<key_t, int> fooMap;

void func(void)
{
    key_t key;        
    key.a = 1;
    key.b = 2;

    fooMap.insert(std::pair<key_t, int>(key, 100));
} 
```

错误如下所示：

```
"/opt/[redacted]/include/functional", line 133: error: no operator "<" matches these operands
            operand types are: const key_t < const key_t
          detected during:
            instantiation of "bool std::less<_Ty>::operator()(const _Ty &, const _Ty &) const [with _Ty=key_t]" at line 547 of "/opt/[redacted]/include/xtree"
instantiation of "std::_Tree<_Traits>::_Pairib std::_Tree<_Traits>::insert(const std::_Tree<_Traits>::value_type &) [with _Traits=std::_Tmap_traits<key_t, UI32, std::less<key_t>, std::allocator<std::pair<const key_t, UI32>>, false>]" 
```

我究竟做错了什么？将结构用作地图键是否完全糟糕/不可能？还是我忽略的其他东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T19:00:55.243

这个

```
 bool operator<(const key_t& rhs) 
```

需要是一个 const 方法

```
 bool operator<(const key_t& rhs) const 
```

两者是不同的签名，并`std::less`寻找后者。后者作为 const 方法，暗示它不会修改对象。然而，没有 const 的前者可能意味着`this`可以执行修改 to。

一般来说，拥有`const`方法是个好主意，即使您可以放弃，这也意味着向客户承诺不会发生任何修改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:02:36.443

首先，操作员必须是`const`. （而且您不需要`==`操作员。）

你是从哪里学会使用 typedef 的`struct`。没有理由这样做。

最后，如果您希望这两个元素都作为密钥的一部分参与，则必须比较它们：

```
struct Key
{
    int a;
    int b;
    bool operator<( Key const& rhs ) const
    {
        return a < rhs.a
            || ( !(rhs.a < a) && b < rhs.b );
    }
}; 
```

否则，`Key( 1, 2 )`将`Key( 1, 3 )`有效地相等。

# javascript - 以编程方式更改选择选项事件

> ID：13480209
> 
> 赞同：0
> 
> 时间：2012-11-20T19:00:02.170
> 
> 标签：javascript, jquery

好的。没有人在听我说话，所以我将尝试通过向您展示可以执行我想要的工作的代码来重新表述这个问题，但不是以我想要的方式。

注意：我不是在问如何做到这一点。我问的更像是……最好的方法是什么……

```
// 首先我需要正确的值
$select.find("option:selected").prop("selected", false);
$select.find("option:first").prop("selected", true);

// 现在我需要触发事件
$select.trigger("改变");

```

我想在一行中做到这一点......就像这个问题的最后一行代码一样。

请不要告诉我任何你希望从事前端工作 10 年的人知道的事情。

**原创 - 不要根据以下内容回答**

不一定是 jQuery，但我正在使用它，所以它也可能是。

基本上，我想做的是说

```
var $option = $select.find("option:first");
$option.trigger("click"); 
```

但这真的行不通。我的意思是，它有点，但它似乎并没有触发选择上的更改事件......所以我想我实际上应该做一些更像......

```
$select.triggerEvent(新事件({
    类型：“改变”，
    目标：$选项
});

```

但这不可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:01:14.957

用于`.val()`更改`select`下拉列表的值：

```
$select.val($select.find('option:first').val()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:06:23.490

您可以使用该`.attr`方法

```
var $option = $select.find("option:first");
$option.attr('selected', true); 
```

**或**使用`.val()`选择

```
var $option = $select.find("option:first").val();
$select.val($option); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:08:04.457

您可以使用 prop() jQuery 方法，如下所示：

```
$select.find('option:first').prop('selected',true); 
```

[从语义上讲](http://www.w3.org/wiki/HTML/Elements/select)，这是将选项设置为选中的正确方法，它似乎也是[**自 1.6 以来**](http://api.jquery.com/prop/)[在 jQuery 中设置属性的](http://api.jquery.com/prop/)**正确方法。**

 ****如果你在 1.6 之前**使用 jQuery ，你应该这样做：

```
$select.find('option:first').attr('selected',true); 
```

如果您需要在您的选择上触发更改事件，您可以这样做：

```
$select.find('option:first').prop('selected',true);
$select.change(); 
```

这是[一个工作示例](http://jsfiddle.net/rayfranco/LKhnN/)

如果您需要一行代码，您可以通过某些方式扩展 jQuery *（未经测试的代码）*：

```
;(function($){
    $.fn.changeToOption = function(n) {

        var option;

        option = this.find('option').eq(n);

        if (option.prop('selected',true)) {
            this.change();
        }

        return this;

    }
})(jQuery) 
```

然后简单地说：

```
$select.changeToOption(0); 
```**

# xml - 显示的不仅仅是 xml 文件中的标记

> ID：13480210
> 
> 赞同：0
> 
> 时间：2012-11-20T19:00:06.480
> 
> 标签：xml, google-maps-api-3, google-maps-markers

我试图从一个 xml 文件中显示多个标记，但我只能显示一个标记。这是代码，它缺少什么吗？

最好的祝福。

```
 downloadUrl("myfile.xml", function(data) {
    var xml = xmlParse(data);
    var markers = xml.documentElement.getElementsByTagName("marker");   
    var position = [];
    for (var i = 0; i < markers.length; i++) {
    var lat = parseFloat(markers[i].getAttribute("lat"));
    var lng = parseFloat(markers[i].getAttribute("lng"));
    var point = new google.maps.LatLng(lat,lng);

}//finish loop

var image = '/artworks/icons/iconBlue.png';
var myLatlng = new google.maps.LatLng(lat, lng);
            var marker = new google.maps.Marker({
                position: myLatlng,
                map: map,
                title:"info",
                icon: image
            });

}); //end downloadurl 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:09:32.733

Javascript 保存函数中每个变量的值。要创建许多标记，您的代码应如下所示：

```
downloadUrl("myfile.xml", function(data) {
    var xml = xmlParse(data);
    var markers = xml.documentElement.getElementsByTagName("marker");   
    var position = [];
    for (var i = 0; i < markers.length; i++) {
        var lat = parseFloat(markers[i].getAttribute("lat"));
        var lng = parseFloat(markers[i].getAttribute("lng"));
        var myLatlng = new google.maps.LatLng(lat, lng);
        createMarker(myLatlng);
    }//finish loop
}); //end downloadurl

function createMarker(myLatlng) {
    var image = '/artworks/icons/iconBlue.png';
    var marker = new google.maps.Marker({
      position: myLatlng,
      map: map,
      title:"info",
      icon: image
    });
    return marker;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T07:43:17.153

> 再次您好，如果我想删除这些标记怎么办？

要删除这些标记，请使用 Marker.setMap() 方法指定 null。所以代码是这样的：

```
var myMarkers = [];
downloadUrl("myfile.xml", function(data) {
    var xml = xmlParse(data);
    var markers = xml.documentElement.getElementsByTagName("marker");   
    var position = [];
    for (var i = 0; i < markers.length; i++) {
        var lat = parseFloat(markers[i].getAttribute("lat"));
        var lng = parseFloat(markers[i].getAttribute("lng"));
        var myLatlng = new google.maps.LatLng(lat, lng);
        var marker = createMarker(myLatlng);
        myMarkers.push(marker);
    }//finish loop
}); //end downloadurl

function createMarker(myLatlng) {
    var image = '/artworks/icons/iconBlue.png';
    var marker = new google.maps.Marker({
      position: myLatlng,
      map: map,
      title:"info",
      icon: image
    });
    return marker;
}

function removeAllMarkers() {
  var i;
  for (i = 0; i < myMarkers.length; i++) {
    myMarkers[i].setMap(null);
  }
} 
```

# ios - UIManagedDocument 单例代码 openWithCompletionHandler 调用了两次并崩溃

> ID：13480211
> 
> 赞同：6
> 
> 时间：2012-11-20T19:00:17.587
> 
> 标签：ios, singleton, uimanageddocument

我正在使用 Justin Driscoll 在[Core Data 上的实现和单个共享 UIManagedDocument](http://adevelopingstory.com/blog/2012/03/core-data-with-a-single-shared-uimanageddocument.html)。在我将它移到 iPad 故事板和 ipad 应用程序的 splitview 控制器之前，我的 iphone 应用程序中的一切都很好。问题是 openwithCompletionHandler 被调用了两次，一次是在 viewDidLoad 的主视图中，一次是在我的详细视图 viewWillLoad 中。这些调用是快速连续的，因为当第二次调用我的单例的 performWithDocument 方法（如下）时，文档仍处于 UIDocumentStateClosed 中，因此应用程序崩溃了。我查看了 e_x_p 对 iOS5.1 后的回答[：同步任务（等待完成）](https://stackoverflow.com/questions/9964571/ios5-1-synchronising-tasks-wait-for-a-completion)但是@sychronized 在这种情况下将不起作用，因为下面的 performWithDocument 是在同一个线程上调用的。我将如何防止对 openwithCompletionHandler 的多次调用？我能想到的防止这种情况的唯一方法是暂停执行上述调用之一，直到我确定 UIDocumentStateNormal 为真，然后释放。但这会冻结不好的主 UI 线程。在不冻结 UI 的情况下，最好的方法是什么？

从 UIManagedDocumentSingleton 代码：

```
- (void)performWithDocument:(OnDocumentReady)onDocumentReady
{
    void (^OnDocumentDidLoad)(BOOL) = ^(BOOL success)
    {
        onDocumentReady(self.document);
    };

    if (![[NSFileManager defaultManager] fileExistsAtPath:[self.document.fileURL path]])
    {
        //This should never happen*******************
        [self.document saveToURL:self.document.fileURL
                forSaveOperation:UIDocumentSaveForCreating
               completionHandler:OnDocumentDidLoad];

    } else if (self.document.documentState == UIDocumentStateClosed) {
        [self.document openWithCompletionHandler:OnDocumentDidLoad];
    } else if (self.document.documentState == UIDocumentStateNormal) {
        OnDocumentDidLoad(YES);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-18T15:02:12.460

我按照~~上面~~贾斯汀的建议做了。在我的一个应用程序中运行良好两年，有大约 2 万用户。

```
@interface SharedUIManagedDocument ()  
@property (nonatomic)BOOL preparingDocument; 
@end

- (void)performWithDocument:(OnDocumentReady)onDocumentReady
{
    void (^OnDocumentDidLoad)(BOOL) = ^(BOOL success) {
        onDocumentReady(self.document);
        self.preparingDocument = NO; // release in completion handler
    };

    if(!self.preparingDocument) {
        self.preparingDocument = YES; // "lock", so no one else enter here
        if(![[NSFileManager defaultManager] fileExistsAtPath:[self.document.fileURL path]]) {
            [self.document saveToURL:self.document.fileURL forSaveOperation:UIDocumentSaveForCreating completionHandler:OnDocumentDidLoad];
        } else if (self.document.documentState == UIDocumentStateClosed) {
            [self.document openWithCompletionHandler:OnDocumentDidLoad];
        } else if (self.document.documentState == UIDocumentStateNormal) {
            OnDocumentDidLoad(YES);
        }
    } else {
        // try until document is ready (opened or created by some other call)
        [self performSelector:@selector(performWithDocument:) withObject:onDocumentReady afterDelay:0.5];
    }
} 
```

**斯威夫特**（没有太多测试）

```
typealias OnDocumentReady = (UIManagedDocument) ->()

class SharedManagedDocument {

private let document: UIManagedDocument
private var preparingDocument: Bool

static let sharedDocument = SharedManagedDocument()

init() {
    let fileManager = NSFileManager.defaultManager()
    let urls = fileManager.URLsForDirectory(.DocumentDirectory, inDomains: .UserDomainMask)
    let documentsDirectory: NSURL = urls.first as! NSURL
    let databaseURL = documentsDirectory.URLByAppendingPathComponent(".database")
    document = UIManagedDocument(fileURL: databaseURL)
    let options = [NSMigratePersistentStoresAutomaticallyOption : true, NSInferMappingModelAutomaticallyOption : true]
    document.persistentStoreOptions = options
    preparingDocument = false
}

func performWithDocument(onDocumentReady: OnDocumentReady) {

    let onDocumentDidLoad:(Bool) ->() = {
        success in
        onDocumentReady(self.document)
        self.preparingDocument = false
    }
    if !preparingDocument {
        preparingDocument = true
        if !NSFileManager.defaultManager().fileExistsAtPath(document.fileURL.path!) {
            println("Saving document for first time")
            document.saveToURL(document.fileURL, forSaveOperation: .ForCreating, completionHandler: onDocumentDidLoad)
        } else if document.documentState == .Closed {
            println("Document closed, opening...")
            document.openWithCompletionHandler(onDocumentDidLoad)
        } else if document.documentState == .Normal {
            println("Opening document...")
            onDocumentDidLoad(true)
        } else if document.documentState == .SavingError {
            println("Document saving error")
        } else if document.documentState == .EditingDisabled {
            println("Document editing disabled")
        }
    } else {
        // wait until document is ready (opened or created by some other call)
        println("Delaying...")
        delay(0.5, closure: {
            self.performWithDocument(onDocumentReady)
        })
    }
}

private func delay(delay:Double, closure:()->()) {
    dispatch_after(
        dispatch_time(
            DISPATCH_TIME_NOW,
            Int64(delay * Double(NSEC_PER_SEC))
        ),
        dispatch_get_main_queue(), closure)
}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T20:17:57.247

That's interesting and definitely a flaw in my code (sorry!). My first thought would be to add a serial queue as a property to your document handler class and perform the check on that.

```
self.queue = dispatch_queue_create("com.myapp.DocumentQueue", NULL); 
```

and then in performWithDocument:

```
dispatch_async(self.queue, ^{
    if (![[NSFileManager defaultManager] fileExistsAtPath... // and so on
}); 
```

But that wouldn't work either...

You could set a BOOL flag when you call saveToURL and clear it in the callback. Then you can check for that flag and use performSelectorAfterDelay to call performWithDocument again a little later if the file is being created.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T05:21:03.733

之间共享的代码块，`numberOfRowsInSection:`应该`cellForRowAtIndexPath:`只调用一次。`numberOfRowsInSection`将始终在`tableView`尝试渲染单元格之前调用，因此您应该创建一个`NSArray`对象，您可以将获取请求的结果存储到其中，然后在渲染单元格时使用此数组：

```
@implementation FooTableViewController {
    NSArray *_privateArray;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    [[UIManagedDocumentSingletonHandler sharedDocumentHandler] performWithDocument:^(FCUIManagedDocumentObject *document) {
        NSManagedObjectContext * context =  document.managedObjectContext;

        NSFetchRequest * request = [NSFetchRequest fetchRequestWithEntityName:@"FCObject"];
        NSPredicate * searchStringPredicate = nil;
        if (searchFilterString)
        {
            searchStringPredicate = [NSPredicate predicateWithFormat:@"word BEGINSWITH[c] %@",searchFilterString];
        }
        request.predicate = searchStringPredicate;
        request.shouldRefreshRefetchedObjects = YES;
        NSError * error;
        _privateArray = [context executeFetchRequest:request error:&error];
        }];
    return _privateArray.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"FCCell";
    FCardCell *cell = (FCCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // Configure the cell...
    FCManagedObject * fcc = [_privateArray objectAtIndex:indexPath.row];
    cell.isWordVisible.on = fcc.isUsed;
    cell.fWord.text = fcc.word;
    return cell;
} 
```

`NSArray`如果你需要做一些特别的事情来将它设置在块内（a la `__block`），我不确定我的头顶。

这样做的主要原因是您需要确保用于确定行数的数据集 100% 的时间与您创建单元格时的大小相同。如果它们不匹配，那么您将崩溃。此外，由于您没有块，因此您现在不需要调度进行`UITableViewCell`更新。

最后，如果`UIDocumentStateClosed`导致问题，您应该将它们从`NSFetch`结果中过滤掉（附加谓词，看看`NSCompoundPredicate`是否需要），或者有代码来更好地处理它们`cellForRowAtIndexPath:`

# c - 如何在内核中动态分配数组？

> ID：13480213
> 
> 赞同：20
> 
> 时间：2012-11-20T19:00:26.043
> 
> 标签：c, cuda, gpgpu

我需要在内核函数中动态分配一些数组。我怎么能这样做？

我的代码是这样的：

```
__global__ func(float *grid_d,int n, int nn){  
    int i,j;  
    float x[n],y[nn];  
    //Do some really cool and heavy computations here that takes hours.  
} 
```

但这行不通。如果这是在主机代码中，我可以使用 malloc。cudaMalloc 需要主机上的指针和设备上的其他指针。在内核函数内部，我没有主机指针。

所以我该怎么做？

如果需要太长时间（几秒钟）来分配所有数组（我需要大约 4 个大小为 n 和 5 个大小为 nn），这不会是一个问题。因为内核可能至少会运行 20 分钟。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-20T19:14:08.877

动态内存分配仅在计算能力 2.x 和更新的硬件上受支持。您可以在内核中使用 C++ new 关键字或 malloc，因此您的示例可以变为：

```
__global__ func(float *grid_d,int n, int nn){  
    int i,j;  
    float *x = new float[n], *y = new float[nn];   
} 
```

这会在具有上下文生命周期的本地内存运行时堆上分配内存，因此如果您不打算再次使用内存，请确保在内核完成运行后释放内存。您还应该注意，运行时堆内存不能直接从主机 API 访问，因此您不能将在内核中分配的指针作为参数传递`cudaMemcpy`给例如。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-21T02:08:41.427

@talonmies 回答了您关于如何在内核中动态分配内存的问题。这旨在作为补充答案，解决`__device__ malloc()`您可能要考虑的性能和替代方案。

在内核中动态分配内存可能很诱人，因为它允许 GPU 代码看起来更像 CPU 代码。但它会严重影响性能。我写了一个独立的测试并将其包含在下面。该测试启动了大约 260 万个线程。每个线程使用从线程索引派生的一些值填充 16 个整数的全局内存，然后对这些值求和并返回总和。

该测试实现了两种方法。第一种方法使用`__device__ malloc()`，第二种方法使用在内核运行之前分配的内存。

在我的 2.0 设备上，内核在使用时运行时间为 1500`__device__ malloc()`毫秒，在使用预分配内存时运行时间为 27 毫秒。换句话说，当内存在内核中动态分配时，测试的运行时间要**长 56 倍。**时间包括外部循环`cudaMalloc()`/ `cudaFree()`，它不是内核的一部分。如果使用相同数量的线程多次启动同一个内核（通常是这种情况），则`cudaMalloc()`/的成本将`cudaFree()`在所有内核启动中分摊。这使差异更大，达到 60 倍左右。

推测，我认为性能下降部分是由隐式序列化引起的。GPU 可能必须序列化所有同时调用`__device__ malloc()`，以便为每个调用者提供单独的内存块。

不使用的版本会`__device__ malloc()`在运行内核之前分配所有的 GPU 内存。指向内存的指针被传递给内核。每个线程计算一个索引到先前分配的内存中，而不是使用`__device__ malloc()`.

预先分配内存的潜在问题是，如果只有一些线程需要分配内存，并且不知道这些线程是哪些线程，则有必要为所有线程分配内存。如果没有足够的内存，那么减少每个内核调用的线程数可能比使用`__device__ malloc()`. 其他解决方法可能最终会重新实现 `__device__ malloc()`在后台执行的操作，并且会看到类似的性能损失。

测试性能`__device__ malloc()`：

```
#include "cuda_runtime.h"
#include "device_launch_parameters.h"
#include <stdio.h>

const int N_ITEMS(16);

#define USE_DYNAMIC_MALLOC

__global__ void test_malloc(int* totals)
{
  int tx(blockIdx.x * blockDim.x + threadIdx.x);

  int* s(new int[N_ITEMS]);

  for (int i(0); i < N_ITEMS; ++i) {
    s[i] = tx * i;
  }

  int total(0);
  for (int i(0); i < N_ITEMS; ++i) {
    total += s[i];
  }

  totals[tx] = total;

  delete[] s;
}

__global__ void test_malloc_2(int* items, int* totals)
{
  int tx(blockIdx.x * blockDim.x + threadIdx.x);

  int* s(items + tx * N_ITEMS);

  for (int i(0); i < N_ITEMS; ++i) {
    s[i] = tx * i;
  }

  int total(0);
  for (int i(0); i < N_ITEMS; ++i) {
    total += s[i];
  }

  totals[tx] = total;
}

int main()
{
  cudaError_t cuda_status;

  cudaSetDevice(0);

  int blocks_per_launch(1024 * 10);
  int threads_per_block(256);

  int threads_per_launch(blocks_per_launch * threads_per_block);

  int* totals_d;
  cudaMalloc((void**)&totals_d, threads_per_launch * sizeof(int));

  cudaEvent_t start, stop;
  cudaEventCreate(&start);
  cudaEventCreate(&stop);

  cudaDeviceSynchronize();
  cudaEventRecord(start, 0);

#ifdef USE_DYNAMIC_MALLOC
  cudaDeviceSetLimit(cudaLimitMallocHeapSize, threads_per_launch * N_ITEMS * sizeof(int));

  test_malloc<<<blocks_per_launch, threads_per_block>>>(totals_d);
#else
  int* items_d;
  cudaMalloc((void**)&items_d, threads_per_launch * sizeof(int) * N_ITEMS);

  test_malloc_2<<<blocks_per_launch, threads_per_block>>>(items_d, totals_d);

  cudaFree(items_d);
#endif

  cuda_status = cudaDeviceSynchronize();
  if (cuda_status != cudaSuccess) {
    printf("Error: %d\n", cuda_status);
    exit(1);
  }

  cudaEventRecord(stop, 0);
  cudaEventSynchronize(stop);
  float elapsedTime;
  cudaEventElapsedTime(&elapsedTime, start, stop);

  printf("Elapsed: %f\n", elapsedTime);

  int* totals_h(new int[threads_per_launch]);
  cuda_status = cudaMemcpy(totals_h, totals_d, threads_per_launch * sizeof(int), cudaMemcpyDeviceToHost);
  if (cuda_status != cudaSuccess) {
    printf("Error: %d\n", cuda_status);
    exit(1);
  }

  for (int i(0); i < 10; ++i) {
    printf("%d ", totals_h[i]);
  }
  printf("\n");

  cudaFree(totals_d);
  delete[] totals_h;

  return cuda_status;
} 
```

输出：

```
C:\rd\projects\test_cuda_malloc\Release>test_cuda_malloc.exe
Elapsed: 27.311169
0 120 240 360 480 600 720 840 960 1080

C:\rd\projects\test_cuda_malloc\Release>test_cuda_malloc.exe
Elapsed: 1516.711914
0 120 240 360 480 600 720 840 960 1080 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T09:14:37.407

如果在调用内核之前 n 和 nn 的值是已知的，那么为什么不 cudaMalloc 主机端的内存并将设备内存指针传递给内核呢？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-04-10T21:07:07.567

根据@rogerdahl 帖子中的概念进行实验。假设：

*   以 64B 块分配的 4MB 内存。
*   该块中有 1 个 GPU 块和 32 个扭曲线程
*   在 P100 上运行

GPU 本地的 malloc+free 调用似乎比`cudaMalloc`+`cudaFree`调用快得多。程序的输出：

```
Starting timer for cuda malloc timer
Stopping timer for cuda malloc timer
         timer for cuda malloc timer took 1.169631s
Starting timer for device malloc timer
Stopping timer for device malloc timer
         timer for device malloc timer took 0.029794s 
```

我省略了`timer.h`and的代码`timer.cpp`，但这里是测试本身的代码：

```
#include "cuda_runtime.h"
#include <stdio.h>
#include <thrust/system/cuda/error.h>

#include "timer.h"

static void CheckCudaErrorAux (const char *, unsigned, const char *, cudaError_t);
#define CUDA_CHECK_RETURN(value) CheckCudaErrorAux(__FILE__,__LINE__, #value, value)

const int BLOCK_COUNT = 1;
const int THREADS_PER_BLOCK = 32;
const int ITERATIONS = 1 << 12;
const int ITERATIONS_PER_BLOCKTHREAD = ITERATIONS / (BLOCK_COUNT * THREADS_PER_BLOCK);

const int ARRAY_SIZE = 64;

void CheckCudaErrorAux (const char *file, unsigned line, const char *statement, cudaError_t err) {
    if (err == cudaSuccess)
        return;
    std::cerr << statement<<" returned " << cudaGetErrorString(err) << "("<<err<< ") at "<<file<<":"<<line << std::endl;
    exit (1);
}

__global__ void mallocai() {
    for (int i = 0; i < ITERATIONS_PER_BLOCKTHREAD; ++i) {
        int * foo;
        foo = (int *) malloc(sizeof(int) * ARRAY_SIZE);
        free(foo);
    }
}

int main() {

    Timer cuda_malloc_timer("cuda malloc timer");

    for (int i = 0; i < ITERATIONS; ++ i) {
        if (i == 1) cuda_malloc_timer.start(); // let it warm up one cycle
        int * foo;
        cudaMalloc(&foo, sizeof(int) * ARRAY_SIZE);
        cudaFree(foo);
    }
    cuda_malloc_timer.stop_and_report();
    CUDA_CHECK_RETURN(cudaDeviceSynchronize());

    Timer device_malloc_timer("device malloc timer");
    device_malloc_timer.start();
    mallocai<<<BLOCK_COUNT, THREADS_PER_BLOCK>>>();
    CUDA_CHECK_RETURN(cudaDeviceSynchronize());
    device_malloc_timer.stop_and_report();
} 
```

如果您发现错误，请在评论中 lmk，我会尽力修复它们。

我用更大的东西再次运行它们：

```
const int BLOCK_COUNT = 56;
const int THREADS_PER_BLOCK = 1024;
const int ITERATIONS = 1 << 18;
const int ITERATIONS_PER_BLOCKTHREAD = ITERATIONS / (BLOCK_COUNT * THREADS_PER_BLOCK);

const int ARRAY_SIZE = 1024; 
```

cudaMalloc 仍然慢了很多：

```
Starting timer for cuda malloc timer
Stopping timer for cuda malloc timer
         timer for cuda malloc timer took 74.878016s
Starting timer for device malloc timer
Stopping timer for device malloc timer
         timer for device malloc timer took 0.167331s 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-09T02:46:31.967

也许你应该测试

```
cudaMalloc(&foo,sizeof(int) * ARRAY_SIZE * ITERATIONS);
cudaFree(foo); 
```

反而

```
for (int i = 0; i < ITERATIONS; ++ i) {
    if (i == 1) cuda_malloc_timer.start(); // let it warm up one cycle
    int * foo;
    cudaMalloc(&foo, sizeof(int) * ARRAY_SIZE);
    cudaFree(foo);
} 
```

# javascript - 为什么我必须在 beforeEach() 中调用 spyOn？

> ID：13480214
> 
> 赞同：14
> 
> 时间：2012-11-20T19:00:30.680
> 
> 标签：javascript, unit-testing, jasmine

我有一个简单的测试套件，`it`里面有一个功能。我想看看我正在调用的函数中是否调用了某个函数，所以我有这样的东西：

```
describe("doStuff", function () {
    var foo = new Foo();
    spyOn(foo, "doOtherStuff");
    foo.doStuff(true);
    it("should do stuff and other stuff", function() {
        expect(foo.stuffDone).toBe(true);
        expect(foo.doOtherStuff).toHaveBeenCalled();
    });
}); 
```

但是，这给了我错误：`Expected a spy, but got Function.`

环顾一番后，我看到所有示例`spyOn`都有`beforeEach`. 因此，我将测试更改为：

```
describe("doStuff", function () {
    var foo = new Foo();
    beforeEach(function() {
        spyOn(foo, "doOtherStuff");
        foo.doStuff(true);
    });
    it("should do stuff and other stuff", function() {
        expect(foo.stuffDone).toBe(true);
        expect(foo.doOtherStuff).toHaveBeenCalled();
    });
}); 
```

这有效。我对茉莉花很陌生，所以我可能只是遗漏了一些明显的东西，但我只想知道为什么它必须在 a`beforeEach`中`spyOn`才能工作。使用 很容易`beforeEach`，但我想更好地了解发生了什么。谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-20T20:53:04.080

这仅仅是因为 Jasmine 在不同的闭包中运行 Specs。`describe`and调用只注册回调，这些`it`回调被添加到队列中，然后由 Jasmine 稍后执行。茉莉总是清理间谍......

但是您也可以将 添加`spyOn`到`it`回调中。

# matlab - Matlab绘制x = a？

> ID：13480217
> 
> 赞同：0
> 
> 时间：2012-11-20T19:00:39.943
> 
> 标签：matlab, plot

如何在 Matlab 中绘制即 x = 5 线？

我这样绘制：

```
x = (-10:.1:10); 
f= 10;
plot(x, f, 'r'); 
```

当然它不起作用。对于 x 的每个变量，除了 x=10 之外，y 都等于 0。当 x = 10 时，y 等于一切。如何绘制这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:03:58.690

在 MATLAB 中，[`plot(X, Y)`](http://www.mathworks.com/help/matlab/ref/plot.html;jsessionid=f35e00dda81b3ad5ea6995afaeaa)只需在图形上绘制点（并用线将它们连接起来）。请注意，在这种形式的语法中，`X`必须`Y`具有相同的维度。因此，要绘制线`x = 5`，请创建所需 y 坐标的向量，然后创建匹配的 x 坐标，它们都等于 5：

```
Y = -10:0.1:10;
X = 5 * ones(size(Y));
plot(X, Y); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T21:27:30.447

FileExchange 中的一个有用的[`hline`功能`vline`](http://www.mathworks.com/matlabcentral/fileexchange/1039-hline-and-vline)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:16:16.633

您也可以通过仅绘制 2 个点来实现此目的：

```
f = 5;    
plot([-10 10] , [1 1]*f); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T10:20:55.307

我认为在这里使用线比情节更直接。

```
 x = [-10, 10]; 
    f = ones(size(x));
    f = 5 .* f;
    line(x, f); 
```

# android - MediaPlayer 视频不显示

> ID：13480219
> 
> 赞同：1
> 
> 时间：2012-11-20T19:00:53.407
> 
> 标签：android

我在我的应用程序上播放视频时遇到了这个大问题。我有这个游戏，想在某个地方展示一些视频，但最好的情况是我能听到声音但看不到视频。

这是持有人

```
 public void surfaceCreated(SurfaceHolder holder) {
      level.playerholder = holder;              
      gameLoopThread.setRunning(true);
      renderLoopThread.setRunning(true);
       gameLoopThread.start();
    renderLoopThread.start();               
 } 
```

这是媒体播放器的创建，应该显示视频

```
while(!playerholder.isCreating());          
MediaPlayer mediaPlayer = new MediaPlayer();
mediaPlayer.setDisplay(playerholder);

switch(startVideo){
case 1:
try {   
mediaPlayer.setDataSource(context,Uri.parse("android.resource://com.getfun.treevolve/raw/getfunvideo"));
                mediaPlayer.prepare();
            } catch (IllegalArgumentException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            } catch (SecurityException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            } catch (IllegalStateException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            } catch (IOException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }
            break;
        }

        Log.d("player", "Sec: " + Integer.toString(mediaPlayer.getDuration()));

        Log.d("player", "Video width: " + Integer.toString(mediaPlayer.getVideoWidth()));
        mediaPlayer.start(); 
```

使用此设置，我的日志仅显示 0。就像视频错误一样。如果在第二行中我删除了持有人

```
 mediaPlayer.setDisplay(playerholder); 
```

正在工作，日志中的所有信息都正确显示，但是我听到了音频但什么也没看到。

谢谢你的帮助，我真的很需要这个。=)

# php - 如何在 Joomla Virtuemart 中的父类别下设置子类别

> ID：13480222
> 
> 赞同：1
> 
> 时间：2012-11-20T19:00:58.253
> 
> 标签：php, joomla, virtuemart

在这里我有一个问题，当我创建一个子类别时，它会进入主菜单，我需要在显示主类别的正文中显示它。我需要这样的类别设置，所以我该怎么做。

两个站点都使用“Virtuemart”。对于这种结果，我需要做什么？

我需要这个[http://www.empiremedia.biz/](http://www.empiremedia.biz/)就像这个 [http://www.unitedbroadcast.com/](http://www.unitedbroadcast.com/)

任何在 Virtuemart 经验丰富的人。或者我该如何解决我的问题，请指导或建议我需要做什么？或者我需要在哪里更改核心文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:52:36.300

尝试在“配置”菜单的“模板”选项卡中选中“显示子类别”。（虚拟机 2.0.10）

去做这个：

1.  转到 Virtuemart > 配置
2.  单击模板选项卡
3.  选中“显示子类别”复选框
4.  节省

选项 2：

1.  转到 Virtuemart > 产品 > 产品类别
2.  单击要编辑的产品类别。
3.  在描述框中键入您的子类别的名称，然后将其作为指向该子类别的链接...如果您需要该链接，请在浏览器中导航到它。

如果您在使用 VM 时遇到这么多麻烦，我再强调一次，我强烈建议您买一本书或聘请一名开发人员。请考虑[购买 VM 书](https://rads.stackoverflow.com/amzn/click/com/1475144636)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T12:02:45.137

将您的主页或任何页面的“菜单项类型”设置为美德市场类别布局。

在您的管理页面上转到

菜单>主菜单单击“主页”或任何其他页面在菜单项类型上选择美德玛特类别布局*

# node.js - 如何处理负载较重的请求？

> ID：13480232
> 
> 赞同：0
> 
> 时间：2012-11-20T19:01:19.597
> 
> 标签：node.js, websocket, redis, socket.io, background-process

这是一个关于哪种方案是解决服务器端繁重情况但为用户提供响应式 UI 的更智能方法的建议。

**设置；** 我的系统由两个服务组成（用节点编写）；一个前端服务，它监听来自用户的请求和一个后台工作人员，它执行繁重的工作并且不会在 1-2 秒内完成（例如，视频转换、图像大小调整、gzipping、蜘蛛等）。用户通过 WebSockets（和正常的 POST 请求）连接到前端服务。

**情景1；** 当用户例如。上传视频，前端服务只做一些简单的检查，以用户的名义创建一个工作给后台工作人员处理并直接以状态200响应。稍后工作人员看到它的工作，完成工作并完成工作。然后它会找到用户连接的套接字（如果有的话）并发送“嘿，工作完成”，其中包含与视频转换作业相关的数据（url、长度、比特率等）。

*   我看到的优点：成功上传的快速用户反馈（例如，可以隐藏 ProgressBar）
*   我看到的缺点：用户将得到一个虚假的“成功”响应，没有要处理/显示的数据，并且无论如何都需要等到工作完成。

**情景2；** 与场景 1 类似，但前端服务不会以状态 200 响应，而是订阅创建的作业“onComplete”事件并让请求悬空，直到触发回调并且数据可以通过管道发送给用户。

*   我看到的优点：“onSuccess”，所有数据都在用户
*   我看到的缺点：根据作业的权重和活动作业数，用户请求可能会超时

在写这个问题时，事情对我来说越来越清楚了（场景 1，但发送了智能成功和更新事件）。无论如何，我想听听您使用的其他场景或对我的场景的进一步利弊！？

谢谢你的协助！

一些不必要的信息；对于 websockets，我使用的是 socket.io，用于创建 kue 和用于 pub/sub redis

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:51:54.727

我刚刚写了这样的东西，我将这两种方法用于不同的事情。场景 1 最适合 IMO，因为它最符合现实，然后可以最准确地传达给用户。通过首先回复 200“是的，我收到了请求并按照您的请求创建了‘工作’”，然后您可以准确地更新 UI 以反映正在处理该请求。然后，您可以根据需要使用推送通道通知用户更新，例如进度百分比、错误和成功，但没有 UI“挂起”（显然您不会在场景 2 中挂起 UI，但这是一个尴尬的情况正在发生，用户界面只需要“猜测”工作正在处理中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-29T18:13:12.310

场景 1 - 但不是响应`200 OK`，而是响应`202 Accepted`。来自维基百科： [https ://en.wikipedia.org/wiki/List_of_HTTP_status_codes](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes)

> 202 Accepted 请求已被接受处理，但处理尚未完成。该请求最终可能会或可能不会被执行，因为在实际进行处理时它可能会被禁止。

这为工人错误的可能性敞开了大门。你只是说你接受了这个请求，并试图用它做点什么。

# linux - libc 内存管理

> ID：13480235
> 
> 赞同：1
> 
> 时间：2012-11-20T19:01:32.513
> 
> 标签：linux, memory-management, libc

libc 如何与操作系统（例如，Linux 内核）通信以管理内存？具体来说，它是如何分配内存的，又是如何释放内存的？另外，在什么情况下它会分别分配和解除分配失败？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T22:32:07.003

这是一个非常笼统的问题，但我想谈谈分配失败。重要的是要意识到内存实际上是由内核在第一次访问时分配的。您在调用`malloc`//`calloc`时所做的事情`realloc`是在进程的虚拟地址空间内保留一些地址（通过 syscalls `brk`、`mmap`等`libc`）。

当我得到`malloc`或类似失败时（或当`libc`得到`brk`或`mmap`失败时），通常是因为我用尽了进程的虚拟地址空间。当没有连续的空闲地址块，没有空间扩展现有地址时，就会发生这种情况。您可以耗尽所有可用空间或达到限制 RLIMIT_AS。当使用多个线程时，这在 32 位系统上尤其常见，因为人们有时会忘记每个线程都需要它自己的堆栈。堆栈通常会消耗几兆字节，这意味着在没有更多可用地址空间之前，您只能创建几百个线程。耗尽地址空间的一个更常见的原因可能是内存泄漏。 `Libc`当然会尝试重用堆上的空间（由`brk`系统调用获得的空间）并尝试`munmmap`不需要的映射。但是，它不能重用未“释放”的东西。

由于分配失败，无法从进程（或作为进程一部分的 libc）中检测到物理内存不足。是的，您可以达到“过度使用限制”，但这并不意味着物理内存已全部占用。当可用物理内存不足时，内核会调用称为 OOM 杀手（Out Of Memory Killer）的特殊任务，该任务会终止一些进程以释放内存。

关于失败`deallocate`，我的猜测是除非你做一些愚蠢的事情，否则它不会发生。我可以想象将程序中断（堆结束）设置在其原始位置下方（通过`brk`系统调用）。这当然是灾难的根源。希望`libc`不会这样做，也没有多大意义。但这可以看作是失败的解除分配。 `munmap`如果您提供一些愚蠢的论点，也可能会失败，但我想不出它失败的常规原因。这并不意味着它不存在。我们必须深入挖掘 glibc/kernel 的源代码才能找到答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:13:22.763

1）它如何分配内存

libc 为 C 程序提供 malloc()。

> 通常，[malloc](http://linux.die.net/man/3/malloc)从堆中分配内存，并根据需要使用 sbrk(2) 调整堆的大小。当分配大于 MMAP_THRESHOLD 字节的内存块时，glibc malloc() 实现使用 mmap(2) 将内存分配为私有匿名映射。MMAP_THRESHOLD 默认为 128 kB，但可以使用 mallopt(3) 进行调整。使用 mmap(2) 执行的分配不受 RLIMIT_DATA 资源限制的影响（请参阅 getrlimit(2)）。

这是关于 sbrk 的。

> [sbrk](http://linux.die.net/man/2/sbrk) - 更改数据段大小

2) 什么情况下会分配失败

同样来自[malloc](http://linux.die.net/man/3/malloc)

> 默认情况下，Linux 遵循乐观的内存分配策略。这意味着当 malloc() 返回非 NULL 时，不能保证内存确实可用。

并从[proc](http://linux.die.net/man/5/proc)

> /proc/sys/vm/overcommit_memory
> 该文件包含内核虚拟内存记帐模式。值为：
> 
> 0：启发式过度使用（这是默认设置）
> 1：总是过度使用，从不检查
> 2：总是检查，从不过度使用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T19:13:06.307

大多数情况下，它使用`sbrk`系统调用来调整数据段的大小，从而为其分配更多内存。以这种方式分配的内存通常不会释放回操作系统，因为只有当可释放的块位于数据段的末尾时才有可能这样做。

较大的块有时通过使用`mmap`来分配内存，并且可以通过`munmap`调用再次释放该内存。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T19:14:53.517

> libc 如何与操作系统（例如，Linux 内核）通信以管理内存？

通过[系统调用](http://en.wikipedia.org/wiki/System_call)- 这是内核提供的低级 API。

> 具体来说，它是如何分配内存的，又是如何释放内存的？

类 Unix 系统提供[“sbrk”系统调用](http://en.wikipedia.org/wiki/Sbrk)。

> 另外，在什么情况下它会分别分配和解除分配失败？

例如，当没有足够的可用内存时，分配可能会失败。释放不会失败。

# iphone - uiNavigationController 推送视图控制器时出错

> ID：13480245
> 
> 赞同：0
> 
> 时间：2012-11-20T19:02:36.680
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

> **可能重复：**
> [iphone - “不支持多次推送同一个视图控制器实例”异常](https://stackoverflow.com/questions/7083124/iphone-pushing-the-same-view-controller-instance-more-than-once-is-not-suppor)

我正在正确地从 1 推送 test2ViewController，如下所示，

```
self.controller2 = [[test2ViewController alloc] initWithNibName:@"test2ViewController" bundle:nil anUser:self.idUser];

[[self navigationController] pushViewController:self.controller2 animated:NO];

[self.controller2 release]; 
```

从 2 到 1 我在再次初始化 1 后弹出它（需要初始化）。

```
self.controller1 = [[test1ViewController alloc] initWithNibName:@"test1ViewController" bundle:nil anUser:self.idUser];

    [[self navigationController]  popToRootViewControllerAnimated:NO];

    [self.controller1 release]; 
```

并且在尝试从 1 再次推送 2 时出现问题，应用程序因错误而崩溃，

```
Pushing the same view controller instance more than once is not supported 
```

做错了什么？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:09:46.853

好吧，首先您要创建另一个 test2ViewController 实例，因此每次更改视图时都会转到不同的实例。

你应该做什么：

```
if(!test2ViewController)
    secondView = [[test2ViewController alloc] init...];
[self navigationController pushViewController:secondView animated:NO]; 
```

并返回，简单地说：

```
[self.navigationController popViewControllerAnimated:NO]; 
```

PoppingtoRoot 使您弹出到使用 pushViewController 方法的第一个视图控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:07:06.327

从您发布的代码来看，您只需将一个视图控制器（controller2）推送到导航控制器。

`popToRootViewControllerAnimated:`将从堆栈中删除除根视图控制器（在您的情况下似乎是 controller2）*之外的所有视图控制器。*所以基本上它什么都不做。

然后您尝试再次推送相同的视图控制器 2，但它失败了，因为正如错误消息所述，这是不允许的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T07:29:24.373

您不需要再次重新初始化 viewController1；如果您从 1 推送 viewController2，那么您只需调用

```
[self.navigationController popToRootViewControllerAnimated:NO]; 
```

因为 viewController1 已经在堆栈中。这个方法的作用是移除堆栈上的所有视图控制器，除了第一个视图控制器并移回它。

如果 viewController1 不是你应该使用的 rootView 控制器

```
[self.navigationController popViewControllerAnimated:NO]; 
```

它将仅弹出堆栈上最后一个推送的视图控制器并显示其下方的视图控制器。

# java - Android BluetoothSocket 未关闭

> ID：13480248
> 
> 赞同：1
> 
> 时间：2012-11-20T19:02:44.220
> 
> 标签：java, android, sockets, bluetooth

我有一个奇怪的问题，我似乎无法弄清楚发生了什么。我使用蓝牙聊天示例作为基础，并且在大多数情况下一切正常，但是，当尝试将连接从一个 UUID 切换到另一个（两个不同的应用程序）时。硬件关闭连接并打开一个具有不同 UUID 的新连接。

问题是我的蓝牙套接字在应用程序端没有关闭。我在日志中看到这些消息：

```
11-20 15:00:44.287: I/BTL_IFC(13313): btl_ifc_ctrl_rx: [BTL_IFC CTRL] recv BTLIF_BTS_RFC_DISC_IND (BTS) 11 pbytes (hdl 47)
11-20 15:00:44.287: I/BLZ20_WRAPPER(13313): btlif_ctrl_callback: btlif_ctrl_callback : msg id BTLIF_BTS_RFC_DISC_IND
11-20 15:00:44.287: I/BLZ20_WRAPPER(13313): btlif_process_disc_ind: disconnect ind status 19, rc chan 8
11-20 15:00:44.287: D/BLZ20_WRAPPER(13313): btlif_signal_event:  fd (-1:51), bta 5, rc 8, wflags 0x0, cflags 0x6, port 9053
11-20 15:00:44.287: D/BLZ20_WRAPPER(13313): btlif_signal_event: ### event BTLIF_BTS_RFC_DISC_IND not matched ###
11-20 15:00:44.287: I/BTL_IFC(13313): send_ctrl_msg: [BTL_IFC CTRL] send BTLIF_BTS_RFC_DISC_IND_ACK (BTS) 9 pbytes (hdl 47) 
```

所以我知道它被断开了，但是我的套接字仍然打开。我会假设当我尝试这样做时，它会给我一个 I/O 异常，但事实并非如此。

```
mmInStream.available() 
```

它只是返回 0 并继续运行。我还监视了 BluetoothSocket.java 类中的 mClosed 标志，在这种情况下它永远不会设置为 true。

我注册了正常的断开连接意图，我错过了一个吗？

```
 IntentFilter stateChangeFilter = new IntentFilter("android.bluetooth.adapter.action.STATE_CHANGED");
    IntentFilter disconnectFilter1 = new IntentFilter("android.bluetooth.device.action.ACL_DISCONNECTED");
    IntentFilter disconnectFilter2 = new IntentFilter("android.bluetooth.device.action.ACL_DISCONNECT_REQUESTED");

    registerReceiver(mListenForDisconnect,stateChangeFilter );
    registerReceiver(mListenForDisconnect,disconnectFilter1 );
    registerReceiver(mListenForDisconnect,disconnectFilter2 ); 
```

# sql - 将日期格式更改为 dmy

> ID：13480262
> 
> 赞同：-1
> 
> 时间：2012-11-20T19:03:46.887
> 
> 标签：sql, database, postgresql

有人可以告诉我如何更改日期数据类型以在 PostgreSQL 中接受 dmy 吗？这些必须始终是默认格式！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:35:10.253

看[**`datestyle`**](http://www.postgresql.org/docs/current/interactive/runtime-config-client.html#GUC-DATESTYLE)设置。

另请查看这个最近密切相关的答案：
[将单独的年、月、日、小时、分钟和第二列集成为单个时间戳列](https://stackoverflow.com/questions/13440492/integrate-separate-year-month-day-hour-minute-and-second-columns-as-a-single/13440802#13440802)

# python - Python Google Drive API 出现 SSL 错误

> ID：13480263
> 
> 赞同：1
> 
> 时间：2012-11-20T19:03:49.610
> 
> 标签：python, google-drive-api, google-api-python-client

[我写了一个简单的代码，与https://developers.google.com/drive/quickstart-python](https://developers.google.com/drive/quickstart-python)上的代码基本相同，每次第一次尝试后我都会遇到同样的错误：

```
# Traceback (most recent call last):
#   File "C:/plug-ins/googleDrive.py", line 35, in <lambda>
#     self.authAction = self.menu.addAction( 'Authentication', lambda: self.runAuthentication()  )
#   File "C:/plug-ins/googleDrive.py", line 46, in runAuthentication
#     credentials = self.flow.step2_exchange( unicode(text) )
#   File "D:/Python\oauth2client\util.py", line 120, in positional_wrapper
#     return wrapped(*args, **kwargs)
#   File "D:/Python\oauth2client\client.py", line 1131, in step2_exchange
#     headers=headers)
#   File "D:/Python\httplib2\__init__.py", line 1597, in request
#     (response, content) = self._request(conn, authority, uri, request_uri, method, body, headers, redirections, cachekey)
#   File "D:/Python\httplib2\__init__.py", line 1345, in _request
#     (response, content) = self._conn_request(conn, request_uri, method, body, headers)
#   File "D:/Python\httplib2\__init__.py", line 1281, in _conn_request
#     conn.connect()
#   File "D:/Python\httplib2\__init__.py", line 1013, in connect
#     self.disable_ssl_certificate_validation, self.ca_certs)
#   File "D:/Python\httplib2\__init__.py", line 80, in _ssl_wrap_socket
#     cert_reqs=cert_reqs, ca_certs=ca_certs)
#   File "C:\python26\ssl.py", line 350, in wrap_socket
#   File "C:\python26\ssl.py", line 118, in __init__
#   File "C:\python26\ssl.py", line 293, in do_handshake
# ssl.SSLError: [Errno 8] _ssl.c:480: EOF occurred in violation of protocol 
```

我在 Python 2.6.4、httplib2 v0.7.7 和 google-api-python-client v1.0b9 下运行它。如果有人有想法......我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T03:17:16.533

该版本的 google-api-python-client (v1.0b9) 是客户端库的 beta 9，您应该升级到发布版本，即 v1.0。

至于“EOF 违反协议”，我只看到发生在不稳定的网络连接上，是这种情况吗？

# java - java.lang.ClassNotFoundException：资源？

> ID：13480268
> 
> 赞同：3
> 
> 时间：2012-11-20T19:04:06.010
> 
> 标签：java, libgdx

我正在尝试使用在 json 文件中定义的皮肤创建一个 Textbutton。我是libgdx的初学者，所以问题可能出在显示器和键盘之间；）我希望你能帮助我。

LibGDX 版本：Fresh Git-Pull（2012 年 11 月 20 日）

**我的 json（在“data/button.json”）：**

```
{
        resources: {
                com.badlogic.gdx.graphics.Color: {
                        white: { r: 1, g: 1, b: 1, a: 1 },
                        downFontColor: { r: 1, g: 0.1, b: 0.2, a: 1 }
                },
                com.badlogic.gdx.graphics.g2d.BitmapFont: {
                        default-font: { file: default.fnt }
                }
        },
        styles: {
                com.badlogic.gdx.scenes.scene2d.ui.TextButton$TextButtonStyle: {
                        default: {
                                font: default-font, 
                                downFontColor: downFontColor,
                                fontColor: white
                        }
                }
        }
 } 
```

**失败的地方：**

```
 Skin skin = new Skin(Gdx.files.internal("data/button.json")); 
```

**例外：**

```
Exception in thread "LWJGL Application" com.badlogic.gdx.utils.GdxRuntimeException: com.badlogic.gdx.utils.SerializationException: Error reading file: data/button.json
    at com.badlogic.gdx.backends.lwjgl.LwjglApplication$1.run(LwjglApplication.java:111)
Caused by: com.badlogic.gdx.utils.SerializationException: Error reading file: data/button.json
    at com.badlogic.gdx.scenes.scene2d.ui.Skin.load(Skin.java:95)
    at com.badlogic.gdx.scenes.scene2d.ui.Skin.<init>(Skin.java:72)
    at eu.loecken.tools.virtuallampsi.screens.MenuScreen.createButton(MenuScreen.java:105)
    at eu.loecken.tools.virtuallampsi.screens.MenuScreen.create(MenuScreen.java:47)
    at eu.loecken.tools.virtuallampsi.screens.MenuScreen.show(MenuScreen.java:131)
    at com.badlogic.gdx.Game.setScreen(Game.java:62)
    at eu.loecken.tools.virtuallampsi.MainGame.create(MainGame.java:48)
    at com.badlogic.gdx.backends.lwjgl.LwjglApplication.mainLoop(LwjglApplication.java:125)
    at com.badlogic.gdx.backends.lwjgl.LwjglApplication$1.run(LwjglApplication.java:108)
Caused by: com.badlogic.gdx.utils.SerializationException: Error reading file: data/button.json
    at com.badlogic.gdx.utils.Json.fromJson(Json.java:596)
    at com.badlogic.gdx.scenes.scene2d.ui.Skin.load(Skin.java:93)
    ... 8 more
Caused by: com.badlogic.gdx.utils.SerializationException: 
    at com.badlogic.gdx.scenes.scene2d.ui.Skin$2.read(Skin.java:424)
    at com.badlogic.gdx.scenes.scene2d.ui.Skin$2.read(Skin.java:1)
    at com.badlogic.gdx.utils.Json.readValue(Json.java:762)
    at com.badlogic.gdx.scenes.scene2d.ui.Skin$1.readValue(Skin.java:409)
    at com.badlogic.gdx.utils.Json.fromJson(Json.java:594)
    ... 9 more
Caused by: java.lang.ClassNotFoundException: resources
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Unknown Source)
    at com.badlogic.gdx.scenes.scene2d.ui.Skin$2.read(Skin.java:422)
    ... 13 more 
```

**没有 json 文件的工作代码：**（只是为了表明某些东西有效）

```
Texture texture = new Texture(Gdx.files.internal(imageURL));
textures.add(texture);

TextureRegion image = new TextureRegion(texture);
TextureRegion flippedImage = new TextureRegion(image);
flippedImage.flip(true, true);
ButtonStyle style = new ButtonStyle();
style.up = new TextureRegionDrawable(image);
style.down = new TextureRegionDrawable(flippedImage);
return new Button(style); 
```

**更新：这个也在工作：**

```
private final BitmapFont defaultFont = new BitmapFont(
        Gdx.files.internal("data/default.fnt"), false);
private final Texture btnTexture = new Texture(
        Gdx.files.internal("buttons/lvl.png"));

private Button createButton(String text) {
    // Initialize skin
    // Skin skin = new Skin(Gdx.files.internal("data/button.json"));
    TextureRegion image = new TextureRegion(btnTexture);
    TextureRegion flippedImage = new TextureRegion(image);
    flippedImage.flip(true, true);
    TextButtonStyle style = new TextButtonStyle();
    style.up = new TextureRegionDrawable(image);
    style.down = new TextureRegionDrawable(flippedImage);
    style.font = defaultFont;
    return new TextButton(text, style);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T12:13:25.587

根据[Skin docs ，这就是你的 json 文件的样子](https://code.google.com/p/libgdx/wiki/Skin#Skin_JSON)

```
{
    className: {
            name: resource,
            ...
    },
    className: {
            name: resource,
            ...
    },
    ...
} 
```

如您所见，您得到了异常，因为它查找“资源”类..所以只需将其更改为上面的模板，例如：

```
{
    com.badlogic.gdx.graphics.Color: {
            white: { r: 1, g: 1, b: 1, a: 1 },
            red: { r: 1, g: 0, b: 0, a: 1 },
            yellow: { r: 0.5, g: 0.5, b: 0, a: 1 },
    },
    com.badlogic.gdx.graphics.g2d.BitmapFont: {
            medium: { file: default.fnt }
    },
    com.badlogic.gdx.scenes.scene2d.ui.TextButton$TextButtonStyle: {
            default: {
                    down: button, up: button,
                    font: medium, fontColor: white
            },
            green: {
                    down: button, up: button,
                    font: medium, fontColor: { r: 0, g: 1, b: 0, a: 1 }
            }
    } 
```

}

PS 按钮是一个真实的图像资源，我也很确定你的皮肤 json 文件模板适用于旧版本的 libgdx

# objective-c - 无法访问另一个类的公共变量

> ID：13480269
> 
> 赞同：0
> 
> 时间：2012-11-20T19:04:08.570
> 
> 标签：objective-c

我知道这个问题经常被问到，我已经阅读了很多，但我仍然无法让它发挥作用。假设我有两个班级，FirstClass 和 SecondClass。FirstClass 有一个标签，而 SecondClass 想要获取该标签的文本。这是我所做的：

```
//FirstClass
@interface FirstClass : UIViewController
{
@public
    UILabel *theLabel;
}
@property (strong, nonatomic) UILabel *theLabel;

@implementation FirstClass
@synthesize theLabel;

//SecondClass
#import "MainGameDisplay.h"
@interface SecondClass : UIViewController
{
    MainGameDisplay *mainGame;
}
@property (strong, nonatomic) UILabel *theSecondLabel;

@implementation SecondClass

-(void) thisMethodIsCalled {
    mainGame = [[FirstClass alloc] init];

    self.theSecondLabel.text = mainGame.theLabel.text;
    NSLog(@"%@",mainGame.theLabel.text); //Output is '(Null)'
} 
```

theLabel.Text 不为零，因为它每秒都在更改，并且还在加载 SecondClass 视图时在后台运行的另一个控制器上显示标签。如果我完全错了，有人可以指出我的写作方向，或者告诉我一些关于如何做到这一点的例子。谢谢你。

* * *

编辑：

```
@Implementation FirstClass
@synthesize theLabel;

- (void)viewDidLoad {
    [self superview];
    [self startTickCount];
}

-(void) startTickCount {
            timer = [NSTimer scheduledTimerWithTimeInterval:5.0 target:self selector:@selector(timeChanger) userInfo:nil repeats:YES];
}

-(void) timeChanger {
        theDay++;
        NSLog(@"%@",self.theLabel.text);
        if (theDay <= 9)
            self.theLabel.text = [NSString stringWithFormat: @"0%i", theDay];
        else
            self.theLabel.text = [NSString stringWithFormat: @"%i", theDay];
        if (theDay > 27)
            [self monthChanger];
} 
```

差不多就是这样。NSLog 按预期输出日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:20:48.287

如果你没有遗漏很多代码，

```
-(void) thisMethodIsCalled {
mainGame = [[MainGameDisplay alloc] init];

self.theSecondLabel.text = mainGame.theLabel.text;
NSLog(@"%@",mainGame.theLabel.text); //Output is '(Null)'
} 
```

不会工作.. 没有人可以在 alloc init 和获取 .text 变量之间修改 mainGame....

[@all 我知道这不是答案，但评论的格式很糟糕。我会根据需要编辑或删除它]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T20:27:28.980

我假设 MainGameDisplay 是您的 FirstClass。然后，为了更新 SecondClass 对象中的 theSecondLabel.text，您需要传递 FirstClass 对象，而不是在方法调用中实例化它。

我想你需要做这样的事情（这是一个非常简单的例子）

1.  将属性添加到您的 SecondClass @property (nonatomic, strong) FirstClass *firstClass;

之后：

1）创建FirstClass的实例，让它有名字firstClass。

2) 创建 SecondClass 的实例。SecondClass *secondClass = [[SecondClass alloc] init];

3) 将第二类的属性设置为第一类的实例

```
secondClass.firstClass = firstClass; 
```

4) 现在您有了对 FirstClass 实际对象的引用，并且可以访问它的属性。

```
-(void) thisMethodIsCalled {

    self.theSecondLabel.text = self.firstClasss.theLabel.text;
    NSLog(@"%@",mainGame.theLabel.text); 
} 
```

我希望这将有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:07:38.783

方法名称是文本，而不是文本。大小写很重要，使用 T 较低的文本会导致错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T19:09:28.230

如果这正是您的代码，那么您有两个问题。首先，`Text`不必要地大写。其次，`TheLabel`不必要地大写。

编辑代码：

```
-(void) thisMethodIsCalled {
    mainGame = [[MainGameDisplay alloc] init];

    // 'text' shouldn't be capitalized
    // 'theLabel' shouldn't be capitalized
    self.theSecondLabel.text = mainGame.theLabel.text;
    NSLog(@"%@",mainGame.theLabel.text);
} 
```

# character-encoding - 字母频率表，包括特殊字符？

> ID：13480271
> 
> 赞同：7
> 
> 时间：2012-11-20T19:04:24.500
> 
> 标签：character-encoding, special-characters

有没有人知道某个地方的表格不仅是字母的相对频率，还有标点符号/特殊字符的相对频率？我需要使用该表为我的霍夫曼代码密钥生成算法设置字母频率，但在半小时多的谷歌搜索中，我无法找到任何可以比较字母和特殊字符的内容（我找到了字母表，并且我什至发现一个只比较特殊字符，但没有什么可以相互比较的）。

# jquery - 使用 jQuery 从嵌入对象中删除 div

> ID：13480272
> 
> 赞同：1
> 
> 时间：2012-11-20T19:04:32.067
> 
> 标签：jquery, object, select, tags

我正在将一个对象嵌入到我的网站上，并希望从中删除一个 div。那可能吗？我想用 jQuery 删除对象标签内具有特定 id 的 div。我尝试了下面的 jQuery，但它没有选择嵌入对象内的 div。

```
$("div").filter(function(){
console.log(this.id); // i don't see any of the id's from the div's inside my object 
}); 
```

编辑：

```
<object data=http://www.msn.com width='100%' height='100%'>
<embed src=http://www.msn.com width='100%' height='100%'>
</embed> Error: Embedded data could not be displayed. </object> 
```

我需要在我的网站上删除嵌入对象内的 div。

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:10:26.860

```
$(this).attr('id')  // $(this)  is jQuery Object 
```

**或者**

```
this.id //  this is DOM Object 
```

/

```
$("div").filter(function(){
       return this.id != 'div1' && this.id != 'div2' ;
}).css('backgroundColor' , 'orange')​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/AYCw2/1/)**

# gremlin - 基本 Gremlin：查找节点属性？

> ID：13480278
> 
> 赞同：3
> 
> 时间：2012-11-20T19:04:55.940
> 
> 标签：gremlin

初学者小鬼问题。我想使用属性名称从图中检索节点，然后打印其所有附加属性。

这就是我正在尝试的：

```
println g.v(20020000001901003) 
```

那是给我null。当我尝试这个时：

```
println g.idx('mygraph')[[id:20020000001901003]] 
```

输出是`[StartPipe]`。

如何从`StartPipe`节点的属性中获取？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T19:37:10.863

下面是 Gremlin 终端使用玩具图和 TinkerPop 2.x 的一些示例（3.x 说明在下面进一步说明）。以下控制台会话显示了如何创建键索引并在其上进行搜索。

```
gremlin> g = TinkerGraphFactory.createTinkerGraph()
==>tinkergraph[vertices:6 edges:6]
gremlin> g.createKeyIndex("name",Vertex.class)
==>null
gremlin> g.V("name","marko").name
==>marko
gremlin> g.V("name","marko").map
==>{age=29, name=marko} 
```

您应该注意，`g.v(20020000001901003)`返回 null 的原因是因为该函数尝试根据图中元素的唯一标识符而不是您分配的标识符来查找顶点（很少有图支持用户分配 id...他们通常会自己生成）。考虑以下我使用分配的标识符来访问顶点的地方：

```
gremlin> g.V("name","marko")
==>v[1]
gremlin> g.v(1).map
==>{age=29, name=marko} 
```

如果您创建了手动索引，那么您将使用您所引用的 g.idx 语法。这是一个例子：

```
gremlin> idx = g.createIndex("my-index",Vertex.class)
==>index[my-index:Vertex]
gremlin> idx.put("id", 1000, g.v(1))
==>null
gremlin> g.idx("my-index")[[id:1000]]
==>v[1] 
```

我假设您没有使用 Gremlin 终端，因此您需要迭代该启动管道。您可能会做一些事情，例如将其发送到列表：

```
gremlin> x=[];g.idx("my-index")[[id:1000]].fill(x)
==>v[1]
gremlin> x.size()
==>1 
```

在[TinkerPop 3.x](http://tinkerpop.apache.org/)中，索引没有 TinkerPop 抽象。您必须使用底层图数据库规定的索引创建方法。例如，在 neo4j 中，您将使用一些 Cypher 语法。使用 TinkerGraph，只有一种`createIndex()`方法。你可以看到它的用法如下：

```
gremlin> graph = TinkerGraph.open()
==>tinkergraph[vertices:0 edges:0]
gremlin> graph.createIndex('name',Vertex.class)
gremlin> g = graph.traversal()
==>graphtraversalsource[tinkergraph[vertices:0 edges:0], standard]
gremlin> g.addV('name','stephen')
==>v[0]
gremlin> g.addV('name','steve')
==>v[2]
gremlin> g.V().has('name','stephen')
==>v[0] 
```

Note that when doing a lookup with that last line above, there is no explicit syntax to use from Gremlin's perspective to use the index on "name". TinkerGraph automatically detects the use of `has()` and that the key is "name" and then it uses the index. If it didn't find an index for "name" it would do a full scan of the vertices to find "stephen". All TinkerPop implementations will have similar [strategies](http://tinkerpop.apache.org/docs/current/reference/#traversalstrategy) for doing those kinds of index lookups.

# windows-8 - 在 Metro 中播放 .asx 链接

> ID：13480279
> 
> 赞同：-1
> 
> 时间：2012-11-20T19:05:03.693
> 
> 标签：windows-8, microsoft-metro, asx

我正在尝试`.asx`在我的 Metro 应用程序中打开一些链接。但似乎`MediaElement`也没有工作。`WebView`

还有其他选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:10:18.350

假设播放列表（.asx 文件）包含 Windows 8 可以播放的视频，我建议在您的应用程序中下载该文件并对其进行解析。然后只需将实际的视频网址传递给播放器框架（如果只有一个视频，则通过设置源，如果有更多，则填充播放列表）。

# c# - 为什么 cmd.BeginExecuteNonQuery(callback, cmd) 抛出“异步操作已经完成”

> ID：13480281
> 
> 赞同：0
> 
> 时间：2012-11-20T19:05:06.217
> 
> 标签：c#, ado.net, wcf-data-services

在下面的代码中`command.EndExecuteNonQuery`抛出

> 异步操作已经完成。

`EndExecuteNonQuery`结束异步操作。MSDN 状态用于`EndExecuteNonQuery`正确完成操作。有什么想法吗？

```
using (var command = new SqlCommand("EXEC SP", connection))
{
    AsyncCallback callback = HandleCallBack;
    command.BeginExecuteNonQuery(callback, command);
}

private void HandleCallBack(IAsyncResult result)
{
    try
    {
        using (var command = (SqlCommand)result.AsyncState)
        {
            command.EndExecuteNonQuery(result);
        }
    }
    catch (Exception ex)
    {

    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T19:24:23.813

在异步操作完成之前，您不应该处理命令（在这里隐式地通过 using 语句）。

将 using 语句替换为 try/catch 以在 Begin 上处理异常命令，并添加 try/finally 以在异步回调中处理命令。

# ios - 使用 UIAlertView 创建登录视图

> ID：13480283
> 
> 赞同：1
> 
> 时间：2012-11-20T19:05:19.117
> 
> 标签：ios, login, uialertview, xcode4.5

我正在尝试为用户创建一个登录名以输入他们的用户名和密码。我正在使用 Xcode 4.5。这是我的 .h 文件代码：

```
 #import <UIKit/UIKit.h>
    #import "AccountViewController.m"

    @interface AccountViewController : UIViewController {

    }

    - (IBAction) alert: (id)sender;

    @end 
```

这是我的 .m 文件代码：

```
 #import "AccountViewController.h"

    @implementation AccountViewController

    - (IBAction)alert:(id)sender
    {
    UIAlertView *alert =[[UIAlertView alloc] initWithTitle:@"Log In" message:@"Please enter      your    Username and Password" delegate:self cancelButtonTitle:@"Log In"         otherButtonTitles:@"Cancel", nil];

    [alert addTextFieldWithValue:@"" label:@"Username"];
    [alert addTextFieldWithValue:@"" label:@"Password"];

    UITextField *tf = [alert textFieldAtIndex:0];
    tf.clearButtonMode = UITextFieldViewModeWhileEditing;
    tf.keyboardType = UIKeyboardTypeAlphabet;
    tf.keyboardAppearance = UIKeyboardAppearanceAlert;
    tf.autocapitalizationType = UITextAutocapitalizationTypeWords;
    tf.autocorrectionType = UITextAutocorrectionTypeNo;

    tf = [alert textFieldAtIndex:1];
    tf.clearButtonMode = UITextFieldViewModeWhileEditing;
    tf.keyboardType = UIKeyboardTypeURL;
    tf.keyboardAppearance = UIKeyboardAppearanceAlert;
    tf.autocapitalizationType = UITextAutocapitalizationTypeWords;
    tf.autocorrectionType = UITextAutocorrectionTypeNo;

    [alert show];

    }

    - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    // Return YES for supported orientations
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
    }

    - (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning]; // Releases the view if it doesn't have a superview
    // Release anything that's not essential, such as cached data
    }

    - (void)dealloc {

    }

    @end 
```

错误发生在 .m 文件中的以下每一行代码中：

```
 [alert addTextFieldWithValue:@"" label:@"Username"];
    [alert addTextFieldWithValue:@"" label:@"Password"]; 
```

错误是：“UIAlertView”没有可见的@interface 声明选择器“addTextFieldWithValue:label:”

任何帮助，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:41:31.677

在这里做什么`addTextFieldWithValue`？下没有列出这样的方法`UIAlertView`。

此外，如果您要处理警报按钮上的点击事件，请将 包含在`UIAlertViewDelegate`您的课程中。

# css - 如何停止 FLOAT（无需额外标记）？

> ID：13480285
> 
> 赞同：4
> 
> 时间：2012-11-20T19:05:31.413
> 
> 标签：css, css-float, nav

**问题**：
我如何获得`NAV`不浮动之后的结果？

**前言：**
我正在整理一个可重复使用*的进度跟踪器*模块，以插入一些正在构建的工具中，以供我们防火墙内的内部使用。
虽然跨浏览器兼容性很好，但我们只***需要***针对 Chrome 和 FireFox 编写代码。这些是我们技术团队正式支持的唯一浏览器。
此外，始终欢迎任何和所有改进建议。

**挑战：**漂浮！！
为了使箭头正确显示并直观地表现，我必须*正确*浮动`li`'s.
（通过*“有”*，我的意思是*“想不出更好的方法”* :)

为了防止整体`nav`向右浮动，我不得不让*那个*浮动。
现在，导航之后出现的任何内容都与它一致。

**注意：**
您还可以[**在 jsFiddle 上**](http://jsfiddle.net/mOrloff/G6J6P/)查看和使用代码。

**代码：**
HTML：

```
<nav id="progress_tracker">
    <ul>
        <li><a href='#'>Grab a beer</a></li>
        <li><a href='#'>Work a little more</a></li>
        <li><a href='#' class="current">Take a Nap</a></li>
        <li><a href='#' class="complete">Work like a dog</a></li>
        <li><a href='#' class="complete">Grab a coffee</a></li>
    </ul>
</nav> 
```

CSS：

```
nav {
    float: left;
}
nav#progress_tracker {
    padding: 0.25em;
    background-color: #1a3340;
    border-radius: 1.75em;
}
nav ul li:last-child{                       /* Remember. We are floating right, so last is furthest left */
    margin-left: -1.7em;
}
nav ul{
    list-style-type: none; 
}
nav ul li{
    display: inline-block;
    float: right;
    position: relative;
    padding: 0;
    margin: 0;
}
nav ul li a{
    display: inline-block;
    vertical-align: middle;
    color: #777;
    background-color: DDD;
    padding-top: 0.75em;                    /* top/btm padding need to be half of line-height */
    padding-bottom: 0.75em;                 /* top/btm padding need to be half of line-height */
    padding-left: 2em;                      /* left padding */
    padding-right: 1em;                     /* right padding is (left-padding - depth-of-arrow (see below) */
    line-height: 1.5em;                     /* line-height needs to be double top/btm padding */
}
nav ul li a:after{
    width: 0;
    height: 0;
    position: absolute;
    top: 0;
    right: -1em;                            /* depth of offset (equal to depth of arrow) */
    border-left: 1em solid #d9d9d9;         /* depth of arrow (equal to depth of offset) */
    border-top: 1.5em inset transparent;    /* border thickness needs to match line-height */
    border-bottom: 1.5em inset transparent; /* border thickness needs to match line-height */
    content: "";                            /* required to make all of this work */
}
nav ul li a:visited{
    color: #888888;
}

nav ul li a.current{
    font-weight: bold;
    color: #777;
    background-color: #FFBB00;
}
nav ul li a.current:after{
    border-left: 1em solid #FFBF00;         /* depth of arrow (equal to depth of offset) */
}

nav ul li a.complete{
    color: #666;
    background-color: #FFFFEE;
}
nav ul li a.complete:after{
    border-left: 1em solid #FFFFEF;         /* depth of arrow (equal to depth of offset) */
}

nav ul li:last-child a{                    /* Remember. We are floating right, so last is furthest left */
    border-top-left-radius: 1.45em;
    border-bottom-left-radius: 1.45em;
}
nav ul li:first-child a{                    /* Remember. We are floating right, so first is furthest rt */
    border-top-right-radius: 1.45em;
    border-bottom-right-radius: 1.45em;
}
nav ul li:first-child a:after{
    border: none;
} 
```

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:08:42.543

看起来有点笨拙，但不添加标记，您可以在 p 元素上设置 css 样式，如下所示：

```
p {
    clear:both;
} 
```

[http://jsfiddle.net/G6J6P/2/](http://jsfiddle.net/G6J6P/2/)

如果你对标记没意见，我会这样做：

```
<br style="clear:both;" /> 
```

在你的导航之后。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:08:30.130

应用 css 样式

```
clear: both; 
```

到下一个元素。这将防止它在你的 float 旁边依偎`nav`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:32:19.777

我知道你说过你想保持标记不变，但是你在元素`display:inline-block;`之间使用和留有空间时遇到了问题。`li`这是一个没有`float`混乱的工作版本（[示例](http://jsfiddle.net/G6J6P/19/)）。它有`:before`和`:after`，每个都充当*前面*箭头的一半。我添加了一种`:hover`样式，因此您可以测试悬停并查看如何自己设置样式。

***注意：**包装后看起来不那么漂亮。*

## HTML

```
<nav id="progress_tracker">
    <ul>
        <li><a href='#' class="complete">Grab a coffee</a></li><!--
        --><li><a href='#'>Work like a dog</a></li><!--
        --><li><a href='#' class="complete">Take a Nap</a></li><!--
        --><li><a href='#' class="current">Work a little more</a></li><!--
        --><li><a href='#'>Grab a beer</a></li>
    </ul>
</nav>
<p>Some random text</p> 
```

## 新的 CSS

```
a:hover,
a:hover:before,
a:hover:after {
    background:lime !important;
}
nav#progress_tracker {
    display:inline-block;
    padding: 0.25em;
    background-color: #1a3340;
    border-radius: 1.75em;
    overflow:hidden;
}
nav ul{
    list-style-type: none;
}
nav ul li{
    display: inline-block;
    position: relative;
    padding: 0;
    margin: 0;
}
nav ul li a{
    display: inline-block;
    vertical-align: middle;
    color: #777;
    background: #1A3340;
    padding-top: 0.75em;                    /* top/btm padding need to be half of line-height */
    padding-bottom: 0.75em;                 /* top/btm padding need to be half of line-height */
    padding-left: 1em;                      /* left padding */
    padding-right: 1.5em;                   /* right padding is (left-padding + 1/2 depth-of-arrow (see below) */
    line-height: 1.5em;                     /* line-height needs to be double top/btm padding */
}
nav ul li a:before,
nav ul li a:after {
    width: 1em;
    height: 1.5em;
    position: absolute;
    left: 0;
    content: "";                            /* required to make all of this work */
    background: #1A3340;
}
nav ul li a:before{
    top: 0;
    -webkit-transform: skewX(33deg) translate(-50%);
    -moz-transform: skewX(33deg) translate(-50%);
    transform: skewX(33deg) translate(-50%);
}
nav ul li a:after{
    bottom: 0;
    -webkit-transform: skewX(-33deg) translate(-50%);
    -moz-transform: skewX(-33deg) translate(-50%);
    transform: skewX(-33deg) translate(-50%);
}
nav ul li a:visited{
    color: #888888;
}

/* .current styles */
nav ul li a.current{
    font-weight: bold;
    color: #777;
    background-color: #FFBB00;
}
nav ul li a.current:before,
nav ul li a.current:after{
    background: #FFBF00;
}

/* .complete styles */
nav ul li a.complete{
    color: #666;
    background-color: #FFFFEE;
}
nav ul li a.complete:before,
nav ul li a.complete:after{
    background: #FFFFEF;
}

/* First/last fixes */
nav ul li:first-child a {
    border-top-left-radius: 1.45em;
    border-bottom-left-radius: 1.45em;
}
nav ul li:last-child a {
    border-top-right-radius: 1.45em;
    border-bottom-right-radius: 1.45em;
}
nav ul li:first-child a:before,
nav ul li:first-child a:after{
    background: none !important;
} 
```

# regex - Perl Regex 从不规则的串口输出中获取数据

> ID：13480287
> 
> 赞同：3
> 
> 时间：2012-11-20T19:05:37.200
> 
> 标签：regex, perl, serial-port, data-processing

简要概述...我家里有一个油箱监视器，它通过串行端口输出数据，包括油箱中的油位。在大多数情况下，输出是一致的，但在小时和随机“特殊事件”上，它发送的内容略有不同。

这是一个从端口、换行符等转储的示例。作为原始示例。

```
20:23,Ull=000
20:24,Ull=000

RX:033 CMs,048 *F
20:25,Ull=000
20:26,Ull=000
20:29,Ull=000
RX:033 CMs,051 *F (Fast)
Chosen:0,Hour:10,033 CMs,051 *F

RX:033 CMs,051 *F (Fast)
Chosen:0,Hour:10,033 CMs,051 *F
20:34,ull=000 
```

我想从此输出中提取的是 'ull=' 后面的数字，在这种情况下为 000，但该数字始终是 3 位整数，并且始终具有前导 0，即。“033”或“001”或“259”

当它不以“HH:MM,ull=nnn”格式发送时，可以忽略输出，因为它最多只能持续 10 分钟，然后再次返回标准输出

使用我的电力监视器作为模板，它在类似的基础上工作，但我想出了更一致的输出......

```
#!/usr/bin/perl -w

# Read data from oil tank sensor via USB-serial port.

use strict;
use Device::SerialPort qw( :PARAM :STAT 0.07 );
use WWW::Mechanize;

open STDERR, '>/dev/null';

my $PORT = "/dev/ttyUSB2";
my $ob = Device::SerialPort->new($PORT);
$ob->baudrate(115200);
$ob->write_settings;

open(SERIAL, "+>$PORT");
while (my $line = <SERIAL>) {
    if ($line =~ m!ull=(\d+)!) { # trying and failing to extract the data on this line

my $oil = $1*1234;              # once the value is successfully captured I'll process
                                # it and send it for viewing & storage on the internet.

#send the oil volume value to emoncms (this section works ok.)
my $ua = WWW::Mechanize->new();
my $url = "http://emoncms.org/input/post?json={oil:$oil}&apikey=MY API KEY";
my $response = $ua->get($url);

    }

} 
```

这只是一直在后台运行。

我认为可能是字符串中的 ',' 或 '=' 让我感到困惑，因为我可以将字符串的其他随机部分放入变量中，但绝不是我需要的值。任何帮助将不胜感激，因为我似乎使用了我能想到的所有随机符号组合 {} * .!m\//g /\n ！等等......还有什么都无济于事！

目前这是一个实验，因为我什至不能 100% 确定“ull”值是多少，但我希望它是从传感器到油箱中油表面的距离！时间会证明一切。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:08:09.543

那是因为您试图将您的正则表达式与完整的字符串匹配，但事实并非如此。由于`ull=(\d+)`不会匹配包含该模式的长字符串。它只会匹配完全匹配该模式的字符串。

此外，如果您的号码肯定是`length 3`，那么您可以在正则表达式中明确指定。你不需要`+`量词。而是一个`{3}`量词，或者`0\d{2}`因为您的数字以 . 开头`0`。并添加一个`i`标志以进行匹配`case-insensitive`。

尝试使用这个： -

```
if ($line =~ m!.*?ull=(0\d{2}).*!i) 
```

# sql - 如何通过查询从表中删除自日期时间 X 以来未更新或创建的所有记录

> ID：13480288
> 
> 赞同：1
> 
> 时间：2012-11-20T19:05:37.360
> 
> 标签：sql, sql-server, oracle

如何通过查询从指定日期时间以来未更新或创建的表中删除所有记录？这适用于 SQL Server 2008 和 Oracle。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T19:47:36.867

虽然我同意没有评论中指出的神奇解决方案。可能有一种方法可以潜在地完成您需要的事情。如果您的数据库备份与记住的日期和时间相对应，您可以将该备份恢复到单独的数据库，然后进行一些比较。

您可以使用 SSIS 编写一些任务来比较数据并根据您的标准删除。还有各种 3rd 方工具，例如 RedGate 和 Idera，可以在两个单独的数据库之间进行数据比较。

Merge 语句为您提供了匹配和不匹配数据的选项，并且可以在连接中使用以在找到确切的行版本时提供指令（例如删除）。

我知道您希望通过一个简单的查询来完成您所需要的，但跳出框框思考仍然可以帮助您获得所需的内容。

**然而，所有这些都需要您从相关日期/时间进行备份。**

# python - 使用 web.py 和 pysnmp 的 Python 线程来创建 Web 服务

> ID：13480295
> 
> 赞同：0
> 
> 时间：2012-11-20T19:06:20.890
> 
> 标签：python, json, multithreading, web.py, pysnmp

我正在尝试为我的家庭网络创建一个小型服务，该服务从我的交换机中读取路由器所在端口的 SNMP 值，进行一些计算并返回当前的平均带宽利用率。

我让 pysnmp 工作得很好，每两秒读取一次 snmp 值……然后我决定集成 web.py 来创建一个非常简单的 Web 服务，它返回上传和下载平均值的 JSON，以千比特为单位。

为此，我必须使用线程来保持 SNMP 轮询在后台进行。虽然我是一个 NOOOB，但它不能正常工作——当我在浏览器中加载该值时，它似乎出于某种原因创建了 SNMP 进程的第二个线程，我真的不知道为什么。

这是代码：

```
from pysnmp.entity.rfc3413.oneliner import cmdgen
from time import sleep
import threading
import json
import web

LOCK = threading.Lock()

class getBW(threading.Thread):

    def __init__(self):
        threading.Thread.__init__(self)
        self.data = dict(upload="0",download="0",)
        self.lock = LOCK
        self.start()

    def run(self):

        router_ip = "192.168.2.2"
        snmp_community = "public"
        upload_mib = "1.3.6.1.2.1.2.2.1.16.1"
        download_mib = "1.3.6.1.2.1.2.2.1.10.1"
        read_interval = 2
        up_octets = 0
        dn_octets = 0
        last_up_octets = 0
        last_dn_octets = 0
        up_change = 0
        dn_change = 0
        avg_up =0
        avg_dn =0
        up_hist = [0,0,0,0,0] 
        dn_hist = [0,0,0,0,0]
        i = 0
        cmdGen = cmdgen.CommandGenerator()

        while (1):
            errorIndication, errorStatus, errorIndex, varBinds = cmdGen.getCmd(
                cmdgen.CommunityData(snmp_community),
                cmdgen.UdpTransportTarget((router_ip, 161)),
                upload_mib,
                download_mib
            )

            # Check for errors and print out results
            if errorIndication:
                print(errorIndication)
            else:
                if errorStatus:
                    print('%s at %s' % (
                        errorStatus.prettyPrint(),
                        errorIndex and varBinds[int(errorIndex)-1] or '?'
                        )
                    )
                else:
                    for name, val in varBinds:
                        if str(name) == upload_mib:
                            if up_octets > 0: 
                                last_up_octets = up_octets
                                up_change = val-last_up_octets
                                # convert to kilobits/s
                                up_change = (((up_change*8)/1000)/read_interval)
                                up_hist[i] = up_change
                                avg_up=(sum(up_hist)/len(up_hist))
                            up_octets = val
                            #print ('%d kilobit per second upload, %d average' % (up_change,avg_up))

                        elif str(name) == download_mib:
                            if dn_octets > 0:
                                last_dn_octets = dn_octets
                                dn_change = val-last_dn_octets
                                # convert to kilobits/s
                                dn_change = (((dn_change*8)/1000)/read_interval)
                                dn_hist[i] = dn_change
                                avg_dn=(sum(dn_hist)/len(dn_hist))
                                i += 1
                                i = i % 5 # if I is 5 reset to 0
                            dn_octets = val
                            #print ('%d kilobit per second download, %d average' % (dn_change,avg_dn))

            #output values to dict
            self.lock.acquire()
            self.data = dict(upload=str(avg_up),download=str(avg_dn),)
            self.lock.release()
            print("UPLOAD: %d change, %d average; DOWNLOAD: %d change, %d average" % (up_change,avg_up,dn_change,avg_dn))
            print("sleeping for %i secs...\r\n" % read_interval)
            sleep(read_interval)

try:
    BW = getBW()
except:
    print "Error: unable to start thread"

urls = ("/.*", "hello")
app = web.application(urls, globals())

class hello:
    def __init__(self):
        self.lock = LOCK
    def GET(self):
        self.lock.acquire()
        thedata = BW.data
        self.lock.release()
        return json.dumps(thedata)

if __name__ == "__main__":
    #start web service
    app.run() 
```

我将衷心感谢您的帮助。请记住，我是线程的菜鸟，只是学习 Python。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:30:08.387

您正在使用 web.py 的内置网络服务器。默认情况下，它启用“模块重新加载”，并且重新加载器会加载主模块两次。由于您在导入时启动线程，因此您将运行两个线程。

一个简单的解决方法是将线程创建移动到`__main__`块中，因此它只创建一次：

```
if __name__ == "__main__":
    BW = getBW()
    #start web service
    app.run() 
```

# facebook - 我可以稍后在我的网站用户使用网站时而不是在注册过程中向他们请求 Facebook 权限吗？

> ID：13480298
> 
> 赞同：1
> 
> 时间：2012-11-20T19:06:46.240
> 
> 标签：facebook, facebook-graph-api

我有一个网站，想知道我是否需要在我的用户注册时征求他们的许可才能发布到他们的 Facebook 个人资料……或者当他们与他们的 Facebook 帐户分享内容时我可以这样做吗？

# java - Java 加密 AES 函数

> ID：13480303
> 
> 赞同：3
> 
> 时间：2012-11-20T19:06:54.337
> 
> 标签：java, cryptography, aes, block-cipher

作为练习，我正在实现自己的 CBC 和 CTR 模式。（例如，对于 CBC 的第一个块，`E(k, IV xor message[0]`）。

例如，我尝试了以下想法，我可以将其用作我的`E`函数（使用 BouncyCastle）：

```
Cipher cipher = Cipher.getInstance("AES/NONE/PKCS5", "BC"); 
```

但“无”不是一个选项。

我的问题是如何为我的目的使用 Java AES 函数；我该怎么办`E(k, ...)`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T09:23:58.800

通常，要构建自己的密码，您需要访问块模式操作。如果您只能访问更高级别的功能，则应使用不指定填充的 ECB 模式加密。ECB 模式在给定密码和密钥的情况下独立转换每个块。填充应该只对块模式操作执行，即使这样也只对最后一个块执行。

如果您要在 Java 密码体系结构中使用它，您将使用`"AES/ECB/NoPadding"`模式。

# php - 如何使用单个帖子样式在wordpress中显示所有帖子

> ID：13480308
> 
> 赞同：0
> 
> 时间：2012-11-20T19:07:18.563
> 
> 标签：php, wordpress, post

这可能是一个非常基本的问题，但我在我的主页上显示了我所有的帖子后，按照发布的顺序。这最初是这样的，但我已经摆弄了一些完全不同的东西！我仍然想要那个主页，但我所有的帖子都放在它下面

任何帮助将非常感激

我当前的索引页面如下 -

```
<?php include "header.php"; ?>

<div id="wrapper">

<?php include "iframe.php"; ?>

<?php include "sidebar.php"; ?>

</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:31:42.007

WordPress Codex 建议以下内容

```
<?php
$allposts = get_posts( array('numberposts' => -1) );
foreach($allposts as $post) : setup_postdata($post); ?>
    <h2><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h2>  
    <?php the_content();
endforeach;
?> 
```

# mysql - 如何在派生表的 where 条件中使用先前联接中的字段？

> ID：13480309
> 
> 赞同：0
> 
> 时间：2012-11-20T19:07:19.640
> 
> 标签：mysql, performance, optimization, greatest-n-per-group

例子：

```
SELECT fbs_household_id,fbh_file_no, fbc_last_name,fbc_first_name
    FROM fbs_household
        LEFT JOIN (SELECT fbc_household_id, fbc_last_name,fbc_first_name FROM fbs_client WHERE fbc_household_id=fbs_household_id ORDER BY fbc_dob ASC LIMIT 1) t1 ON 1; 
```

`fbs_household_id`来自`fbs_household`表格，但我收到一条错误消息，提示未知字段。

我可以将查询重写为：

```
SELECT fbs_household_id,fbh_file_no, fbc_last_name,fbc_first_name
    FROM fbs_household
        LEFT JOIN fbs_client ON fbs_client_id=(SELECT fbs_client_id
            FROM fbs_client
            WHERE fbc_household_id=fbs_household_id ORDER BY fbc_dob ASC LIMIT 1) 
```

但这非常慢。有什么办法可以加快速度吗？

我正在尝试获取每个家庭中最年长的成员，以及有关该家庭的一些其他信息（实际查询包含更多列和连接）。

* * *

第三种解决方案，也很慢：

```
SELECT fbs_household_id,fbh_file_no, fbc_last_name,fbc_first_name
    FROM fbs_household
    LEFT JOIN (SELECT fbc_household_id, fbc_last_name,fbc_first_name
        FROM fbs_client
        ORDER BY fbc_dob ASC) c1 ON fbc_household_id=fbs_household_id; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:23:47.207

不确定这是否可行，但您是否尝试过子查询来获取`max(fbc_dob)`每个家庭的值，然后再次加入表以获取其他值：

```
SELECT h.fbs_household_id, h.fbh_file_no, c1.fbc_last_name, c1.fbc_first_name
FROM fbs_household h
LEFT JOIN fbs_client c1
  ON h.fbs_household_id = c1.fbc_household_id
LEFT JOIN
(
    select max(fbc_dob) fbc_dob, fbc_household_id  --- this will get you the oldest per household
    from fbs_client
    group by fbc_household_id
) c2
    ON c1.fbc_household_id = c2.fbc_household_id
    AND c1.fbc_dob = c2.fbc_dob 
```

**不确定我是否将别名放置在选择中的正确字段上。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T20:10:30.033

尝试通过将客户端表中的每一行与同一家庭的年长成员的行进行自联接，然后选择没有找到此类年长者的那一个，来找到每个家庭中最年长的客户。

```
SELECT fbs_household_id, fbh_file_no, c1.fbc_last_name, c1.fbc_first_name
FROM fbs_household
LEFT JOIN fbs_client c1 
ON c1.fbc_household_id = fbs_household_id 
LEFT JOIN fbs_client c2
ON c1.household_id = c2.household_id
AND (c1.dob > c2.dob
     OR c1.dob = c2.dob 
     AND c1.fbs_client_id > c2.fbs_client_id) -- if same dob, choose lower id
WHERE c2.dob IS NULL 
```

# c - 如何让所有人都可以使用我的 API？

> ID：13480310
> 
> 赞同：0
> 
> 时间：2012-11-20T19:07:21.627
> 
> 标签：c, linux, api, libraries, abstraction

我想创建一个抽象的链表实现（对*createList*、*destroy*、*addNode*、*deleteNode*等进行一般操作）。如何使使用操作系统的任何人都可以使用这些功能？（我正在使用 Ubuntu。）

我可以声明一个函数：

**在 add.h 中：**

```
int add(int a,int b);   /* add.h having the declaration */ 
```

**在 add.c 中：**

```
#include "add.h"    
int add(int a,int b)    /* add.c having only definition */
{
    return (a+b);
} 
```

**在 main.c 中：**

```
#include<stdio.h>
#include"add.h"
int main() 
{
 //use add() here
} 
```

如何在 Linux 环境中设置 API，以便`add.c`对 API 的用户隐藏其中的实现？我不想强迫 API 的用户将`add.h`文件复制到他们的工作目录中；我宁愿有一些方法将它安装到 Linux 环境中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:17:35.617

原生 API 以 headers+libraries 的形式分布。API 用户在构建他的软件时指定头文件搜索路径（-I/dir/with/headers），将源代码编译为目标文件，库搜索路径（-L/dir/with/libs）和库（-lmylibname）将目标文件链接到库或二进制文件。有些人还喜欢将库搜索路径嵌入到正在构建的库和二进制文件中，这可以通过 -Wl,-rpath=/dir/with/libs 链接时间 gcc 标志来完成。

您应该更喜欢公共头文件中的#include<>，因为首先在包含文件所在的同一目录中搜索#include""，这可能会减慢编译速度。

以下大部分操作都可以使用标准开发 Linux 工具（automake 等）自动化。

用于构建 API 的命令行：

```
gcc -c -o add.o -fPIC add.cc -I/dir/where/add_h 
```

用于链接 API 的命令行：

```
gcc -shared -fPIC -Wl,-soname=add -olibadd.so 
```

编译客户端代码（main.c）的命令行：

```
gcc [-I/dir/with/headers] -o main.exe [-L/dir/with/libs] -ladd [-Wl,-rpath=/dir/with/libs] main.c 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T20:01:36.170

如果bobah的解决方案不够好，因为你不想指定你的源当前所在的路径，当你*使用*API​​时，你可以将库安装到系统目录（/usr/local/lib, / usr/local/include 等等）。然后，您将不需要`-I`and `-L`。你仍然需要`-l`.

您将需要管理员权限（作为 root 或使用 sudo）。考虑使用“安装”命令。和“libtool”，如果你想构建你的库的共享对象。还有自动工具（autoconf 和 automake）。

如果你的意思是真的任何人，而不仅仅是你电脑上的任何人，用这个

> 给正在使用操作系统的人？（我正在使用 Ubuntu。）

那么你还需要构建一个源代码或二进制包。并说服 Ubuntu 维护人员将其包含到他们的存储库中。对于另一个链表库来说，这可能会很困难。

# php - GIS面积计算

> ID：13480311
> 
> 赞同：1
> 
> 时间：2012-11-20T19:07:26.800
> 
> 标签：php, python, ruby, gis, area

我正在开发一个基于网络的系统，我需要在地图中为不同的人和目的分配区域。

我有一个**不规则边界的****划定区域**，将在不同的人之间共享。

 **例如：

```
Person 1: 3.000m2
Person 2: 5.000m2
Person 3: 10.000m2 
```

我需要在该区域分配这些值并将它们显示在地图中。我很难找到一种方法来为每个注意我初始区域的不规则边界的人定义周长。

问题：

*   PostGIS 或 PHPGis 等流行数据库的 GIS 扩展可以帮助我吗？
*   是否有任何库或众所周知的算法来计算它？
*   流行的基于 Web 的框架，例如 geodjango，有这种功能吗？

我不限于特定的语言，任何有帮助的东西，ruby、python、php、c#、javascript。

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T20:31:01.087

我无法谈论流行框架中此功能的可用性。但是鉴于您对分布区域和不规则边界的描述，我建议您研究进行重新划分的软件，也就是 gerrymandering。一个来源可能是[公共映射项目](http://www.publicmapping.org/resources/software)另一个可能是[重新划分](https://code.google.com/p/redistricter/)**

# python - 循环遍历 Python 中的文件目录

> ID：13480316
> 
> 赞同：2
> 
> 时间：2012-11-20T19:07:40.380
> 
> 标签：python, loops, elementtree, os.walk

我已经完成了我的第一个 python 脚本的 99%，但是我被相当于一个 for-each 循环遍历目录中的文件所绊倒。我的脚本适用于单个文件，我只是不确定如何将它应用于多个文件，一次一个。

我有一个路径`path = ~/documents`和一个带有我想排除的文件名的 XML 文件：

```
 <root><synced name="Already Synced"><sfile name="Filename">base</sfile><sfile name="Filename">File1.blah</sfile><sfile name="Filename">File2.blah</sfile><sfile name="Filename">File3.blah</sfile></synced></root> 
```

`*.blah`我将如何在所有以 XML sfile 结尾且不在 XML sfile 中的文件上运行我的脚本？

我有这个，但这是不行的：

```
path = '~/documents'
tree = ET.parse("sync_list.xml")
root = tree.getroot()
for elem in root.findall('sfile'):
    synced = elem.text
do_library = os.listdir(path)
if glob.fnmatch.fnmatch(file,"*.blah") and not synced:
  for entry in do_library:
    file = os.path.join(path, entry)
    result = plistlib.readPlist('file') 
```

非常感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:12:47.447

```
import fnmatch
import os

path = os.path.expanduser('~/documents')
tree = ET.parse("sync_list.xml")
root = tree.getroot()
synced = [elt.text for elt in root.findall('synced/sfile')]
for filename in os.listdir(path):
    if fnmatch.fnmatch(filename, '*.blah') and filename not in synced:
        filename = os.path.join(path, filename) 
```

编辑：按照@mata 的建议添加了 os.path.expanduser。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:16:02.347

```
path = '~/documents' 
```

这不会为您提供`documents`主目录中的文件夹。`~`并不是真正代表主目录，而是让您使用它，就好像它通常是 shell 进行波浪号扩展一样。没有它，`~`可以是任何文件或目录的名称，python 将其视为这样。要正确获取它，请使用：

```
path = os.path.expanduser('~/documents') 
```

# php - 视频加载后更改页面背景

> ID：13480319
> 
> 赞同：1
> 
> 时间：2012-11-20T19:07:56.047
> 
> 标签：php, javascript, jquery, html

我有一个简单的问题，可能需要一个复杂的答案。

我使用 HTML5 中的标签来制作视频背景。在加载视频时，我希望页面背景为白色。视频加载后，背景应变为黑色。

视频自动加载并在加载后自动启动。

有没有办法用一点 PHP、JavaScript 或 JQuery 来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T19:11:27.933

假设您的标记看起来像

```
<video id='myvideo'></video> 
```

尝试附加一个 onload 事件处理程序

```
document.getElementById('myvideo').onload = function() {
    document.body.style.backgroundColor = 'black';
} 
```

# mysql - Rails/MySQL 只有一个属性值被保存在列中，到 DB

> ID：13480327
> 
> 赞同：0
> 
> 时间：2012-11-20T19:08:19.997
> 
> 标签：mysql, ruby-on-rails, activerecord

这将是一个很难提供意见的问题，所以我会尽可能详细地提供。以下是我试图弄清楚的确切问题。出于某种原因，当我保存时，经验是删除列中的所有其他值并在更新当天写入。我刚刚保存了所有其他值，但为了清楚起见，我将它们排除在表之外。最奇怪的部分是预算和经验设置完全相同，但不幸的是并没有节省相同的费用。下面是关于这个问题的更多细节。

# 非常感谢您对可能发生的事情的任何见解。

```
+------+--------+-----------+------------+-----------------+
| id   | bar_id | day       | budget     | experience      |
+------+--------+-----------+------------+-----------------+
| 1816 |    369 | monday    | LOW BUDGET |                 |
| 1817 |    369 | tuesday   | low budget |                 |
| 1818 |    369 | wednesday | low budget | IN CONVERSATION |
| 1819 |    369 | thursday  | low budget |                 |
| 1820 |    369 | friday    | low budget |                 |
| 1821 |    369 | saturday  | low budget |                 |
+------+--------+-----------+------------+-----------------+

+------+--------+-----------+------------+--------------------+
| id   | bar_id | day       | budget     | experience         |
+------+--------+-----------+------------+--------------------+
| 1822 |    369 | monday    | LOW BUDGET |                    |
| 1823 |    369 | tuesday   | low budget |                    |
| 1824 |    369 | wednesday | low budget |                    |
| 1825 |    369 | thursday  | low budget | ON THE DANCE FLOOR |
| 1826 |    369 | friday    | low budget |                    |
| 1827 |    369 | saturday  | low budget |                    |
+------+--------+-----------+------------+--------------------+ 
```

这些是表单（视图）的输入

```
 <div class="row clearfix">
      <div class="label">Budget</div>
        <div class="mid budget">
        <div class="mid">
          <input class="venProfileInputs caps" name="bar_profile[<%= day %>][budget]" onblur=checkBudVals(this)>
        </div>
      </div>
    </div>

    <div class="row clearfix">
      <div class="label">Experience</div>
        <div class=" mid">
          <input class="venProfileInputs caps" name="bar_profile[<%= day %>][experience]" onblur=checkExVals(this) /> 
        </div>
      </div> 
```

然后进入控制器

```
 def update
    @bar = Bar.find(params[:id])
    if @bar.update_attributes(params[:bar])
      @bar.update_profiles(params[:bar_profile])
      redirect_to "/admin", :notice => "Bar was successfully updated."
    else
      render :action => :edit
    end
  end 
```

它在模型中得到更新

```
 def update_profiles(params)
    profiles.each {|p| p.destroy }

    params[:active_profiles].split(',').each do |profile_day|
      next if profile_day.blank?

      add_profile(params[profile_day.to_sym])

      # sets up crowd tags
      crowd_tags_ids = params[profile_day.to_sym][:tags]
      unless crowd_tags_ids.blank?
        crowd_tags_ids.split(',').each do |tag_id|
          next if tag_id.strip == ""
          profiles.last.crowd_tags << CrowdTag.find(tag_id)
        end
      end      
      profiles.last.set_crowd_tags
      #need to loop through cf_tags_ids = params[profile_day.to_sym][:cf_tags]
      cf_tags_ids = params[profile_day.to_sym][:cf_tags]
      unless cf_tags_ids.blank?
        # loop through each category 0,1,2,3,4
        cf_tags_ids.each_pair{ |cat, ids|
            #cycle through each id in the current cat and add to crowd fiter tag
            ids.split(',').each do |cf_id|
                next if cf_id.strip == ""
                profiles.last.crowd_filter_tags << CrowdFilterTag.find(cf_id)
            end
          }
      end     
      profiles.last.set_cf_tags
      # below is not working for saving experience
      profiles.last.experience = params[profile_day.to_sym][:experience]
      logger.info "#{profiles.last.inspect}"
      #### Still need to save experience some how, budget seems to be getting saved
      # but only one value for experience is being logged in a single row for each bar_id

    end
  end 
```

记录器输出：

```
Parameters: {"utf8"=>"✓&quot;, 
"bar"=>{"name"=>"Rue B", "website"=>"www.ruebnyc.com", "neighbourhood"=>"Greenwich Village",
"street_address"=>"188 Avenue B", "city"=>"New York", "country"=>"US", "state"=>"NY", "zipcode"=>"10009"}, 
"bar_profile"=>{"active_profiles"=>",monday,tuesday,wednesday,thursday,friday,saturday", 

"monday"=>{"day"=>"monday", "description"=>"", "plan_b"=>"", "capacity"=>"100",    
"rating"=>"5", "budget"=>"LOW BUDGET", "experience"=>"ON THE DANCE FLOOR", 
"cf_tags"=>{"0"=>"83,", "1"=>"127,", "2"=>"120,", "3"=>"111,", "4"=>"128,"}, "tags"=>"16,46,45,"}, 

"tuesday"=>{"day"=>"tuesday", "description"=>"Come after dining hours to mellow out with the Lost Generation of today. Fedora optional.",
"plan_b"=>"", "capacity"=>"", "rating"=>"0", "budget"=>"low budget", "experience"=>"",
"cf_tags"=>{"0"=>"61,", "1"=>"", "2"=>"", "3"=>"", "4"=>""}, "tags"=>""}, 

"wednesday"=>{"day"=>"wednesday", "description"=>"Come after dining hours to mellow out with the Lost Generation of today. Fedora optional.", 
"plan_b"=>"", "capacity"=>"", "rating"=>"0", "budget"=>"low budget", "experience"=>"",
"cf_tags"=>{"0"=>"61,", "1"=>"", "2"=>"", "3"=>"", "4"=>""}, "tags"=>""}, 

"thursday"=>{"day"=>"thursday", "description"=>"Come after dining hours to mellow out with the Lost Generation of today. Fedora optional.", 
"plan_b"=>"", "capacity"=>"", "rating"=>"0", "budget"=>"low budget", "experience"=>"",
"cf_tags"=>{"0"=>"59,", "1"=>"", "2"=>"", "3"=>"", "4"=>""}, "tags"=>""}, 

"friday"=>{"day"=>"friday", "description"=>"Come after dining hours to mellow out with the Lost Generation of today. Fedora optional.", 
"plan_b"=>"", "capacity"=>"", "rating"=>"0", "budget"=>"low budget", "experience"=>"",
"cf_tags"=>{"0"=>"60,", "1"=>"", "2"=>"", "3"=>"", "4"=>""}, "tags"=>""}, 

"saturday"=>{"day"=>"saturday", "description"=>"Come after dining hours to mellow out with the Lost Generation of today. Fedora optional.",
"plan_b"=>"", "capacity"=>"", "rating"=>"0", "budget"=>"low budget", "experience"=>"",
"cf_tags"=>{"0"=>"59,", "1"=>"", "2"=>"", "3"=>"", "4"=>""}, "tags"=>""}, 

"sunday"=>{"day"=>"sunday", "description"=>"", "plan_b"=>"", "capacity"=>"", "rating"=>"",
"budget"=>"", "experience"=>"", "cf_tags"=>{"0"=>"", "1"=>"", "2"=>"", "3"=>"", "4"=>""}, "tags"=>""}}, "id"=>"369"} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:08:40.467

我无法想象这真的对任何人有帮助，但是这个巨大项目中的某些 JQuery 依赖于 html 中的特定设置。“体验”块缺少一个额外的 div，它允许 JS 获取正确的值……这就是为什么它不断更新为 nil，因为找不到该值。

```
 <div class="row clearfix">
          <div class="label">Budget</div>
          <div class="mid budget">
          <div class="mid">
            <input class="venProfileInputs caps" name="bar_profile[<%= day %>][budget]" onblur=checkBudVals(this)>
            </div>
          </div>
        </div>

        <div class="row clearfix">
          <div class="label">Experience</div>
------>   <div class="mid experience">
          <div class=" mid">
            <input class="venProfileInputs caps" name="bar_profile[<%= day %>][experience]" onblur=checkExVals(this) /> 
          </div>
          </div>
        </div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:23:32.303

据我所知，它正在做它应该做的事情。您的日志文件显示，除了“星期一”之外的每一“天”，“体验”都设置为“”。星期一它被设置为“在舞池上”。其中，“预算”设置为每天的某事。

我会查看您的 HTML/JS，看看您是否在提交表单之前以某种方式清除了该字段。

# c# - C#（单声道）Linux Web 服务器托管，跨线程具有一致的静态变量

> ID：13480328
> 
> 赞同：4
> 
> 时间：2012-11-20T19:08:19.443
> 
> 标签：c#, linux, mono, webserver, hosting

有人知道 C#（单声道）Linux Web 服务器托管配置，它支持跨线程的一致静态变量（即不是每个线程实例的 CGI 模型）吗？

**细节**

我有一些 c#（单声道）代码，我们需要将它们作为简单 Web 应用程序的一部分托管在 linux 上。我们不需要任何传统的 asp 甚至 asp.net mvc 功能，实际上我们只需要基于共享静态变量以动态内容响应特定 url 的能力。

**静态变量：** 我们确实有一个特殊要求是我们需要静态变量来在所有传入请求中保留它们的值（就像它们在具有 ASP.net mvc 应用程序的 Windows 上所做的一样）。托管像 Apache mod_mono 这样的单声道 c# Web 应用程序的常用方法似乎使用“每个线程的 c# 应用程序实例”模型，其中我们的 c# 应用程序有多个独立的实例，每个实例都有自己的静态变量。这是我们需要避免的问题。我需要一种托管 ac# 应用程序的方法，该方法为一个通用应用程序提供一组共享的静态变量，所有传入请求都会看到这些变量。如果在应用程序回收时静态变量被重置（就像在正常的 IIS/MVC 中一样），只要不经常回收就可以了。

背景是这个网络应用程序需要将大量数据保存在 RAM 中的静态变量中，并快速回答有关该数据的问题。为每个线程打开应用程序的副本会过多地限制 RAM 资源，并且频繁地将数据重新加载到内存中会使应用程序变得太慢（像 IIS/Asp.net MVC 这样的偶尔回收很好）。该系统在 Windows/IIS7 上运行得非常好（每秒 50,000+ 个动态请求），我们**不想**更改此架构，因此我正在寻找的答案与托管而不是更改应用程序设计有关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T15:14:45.583

mod_mono 不会为每个新的 Web 请求生成新的单声道进程。如果您将 fastcgi 服务器与 apache 或 nginx 一起使用，它也不会。

编辑：静态变量在同一个应用程序域中共享。这适用于 Microsoft .NET IIS 和 mono（无论您使用的是 mod_mono、xsp 还是 mono-fastcgi-server）。即使 apache 产生多个工作线程并且单个请求由单个工作线程处理，在任何给定时间也只有一个单进程运行（除非您配置了多个 asp.net 应用程序，那么每个应用程序都有一个） .

Mono 也尝试为 ASP.NET 实现 100% 的兼容性，因此设计上没有不同的行为！

您的程序在 linux 上的不同行为很可能与 mod_mono 如何处理请求无关，而是与 mono 本身或您的代码中的错误有关（即，通过做出在 linux 上不成立的平台假设）。您应该真正使用 MonoDevelop/xsp 进行调试，并尝试更清楚地查明问题，或者在此处粘贴一些示例代码。

# java - 用 GSON 解析 JSON，但我不能

> ID：13480330
> 
> 赞同：-2
> 
> 时间：2012-11-20T19:08:24.647
> 
> 标签：java, android, json, gson

我想显示 URL 的 JSON，URL 是（[http://loyaltier.com/app/mobile/code/places/Maps.php](http://loyaltier.com/app/mobile/code/places/Maps.php)），我使用 GSON 并编写此代码，但是当我运行程序时，程序没有'不显示`gsonFoo`方法的日志。问题可能是什么？我阅读此链接以使用 GSON，[https: //stackoverflow.com/questions/7939632/gson-jackson-in-android](https://stackoverflow.com/questions/7939632/gson)

东西.java

```
package org.example.loyaltier;

public class Thing {
String branchId=null;
String branchCode=null;
String branchName=null;
String branchTel=null;
String address=null;
String cityName=null;
String countryName=null;
String latitude=null;
String longitude=null;
String workingHours=null;
  } 
```

我的位置.java

```
 public class MyLocation extends MapActivity {
      public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.location);
                try {
        Log.i("THISSSSSSSSS", "ISSSSSSSSS");
        Log.i("FFOOOORRRR", "YYOUUUUUUUUU");
        gsonFoo();
    } catch (Exception e1) {
        Log.i("catch", "catch");
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }
     }
public void gsonFoo() throws Exception
  {
    Gson gson = new Gson();
    Thing thing = gson.fromJson(new FileReader("http://loyaltier.com/app/mobile/code/places/Maps.php"), Thing.class);
    System.out.println(gson.toJson(thing));
    Log.i("GSOOOON", "FOOOO");
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:14:18.777

您可以在不使用 Gson 的情况下粘贴 json 字符串：

```
JSONArray ja = new JSONArray("Your json String");
for (int i = 0; i < ja.length(); i++) {
  JSONObject oneObject = jArray.getJSONObject(i);
  // Pulling items from the array
   String oneBranchId = oneObject.getString("BranchId");
   String oneBranchCode = oneObject.getString("BranchCode");
   String oneBranchTel = oneObject.getString("BranchTel");
   String oneAddress = oneObject.getString("Address");
    //your code here...
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T11:25:46.150

`Thing thing = gson.fromJson(new FileReader("http://loyaltier.com/app/mobile/code/places/Maps.php"), Thing.class);`包含错误，它需要`FileReader`类的对象而不是 json 数据。因此，您必须从链接中获取 json 数据并将其传递给`FileReader`对象。根据[链接](http://loyaltier.com/app/mobile/code/places/Maps.php)中提供的json数据，

```
[{"BranchId":"1","BranchCode":"b1","BranchName":"The Dubai Mall","BranchTel":"+ 971 4 339 9716","Address":"The Waterfalls, Lower Ground LG-119 Dubai Mall","CityName":"Dubai","CountryName":"UAE","Latitude":"25.197427","Longitude":"55.279251","WorkingHours":"10:00AM - 10:30PM","BranchImage":"dubai-mall.jpg"},{"BranchId":"2","BranchCode":"b2","BranchName":"The Dubai Festival City","BranchTel":"+ 971 4 232 8856","Address":"Shop 102, Ground Floor, North Oval, Dubai Festival City","CityName":"Dubai","CountryName":"UAE","Latitude":"25.22319","Longitude":"55.350394","WorkingHours":"10:00AM - 10:30PM","BranchImage":"festival-City.jpg"},{"BranchId":"3","BranchCode":"b3","BranchName":"Dubai Media City","BranchTel":"+971 4 449 4010 ","Address":"Tower B, Business Central Towers, Dubai Media City","CityName":"Dubai","CountryName":"UAE","Latitude":"25.094713","Longitude":"55.154604","WorkingHours":"10:00AM - 10:30PM","BranchImage":"media-city.jpg"}] 
```

它似乎是`Thing`'s 对象的列表，因此您必须修改`Thing`为*List*类型。*List*将包含`Thing`s 个对象。修改后的代码如下：

东西.java

```
package org.example.loyaltier;

import java.io.Serializable;

public class Thing implements Serializable{
private String branchId;
private String branchCode;
private String branchName;
private String branchTel;
private String address;
private String cityName;
private String countryName;
private String latitude;
private String longitude;
private String workingHours;

    public String getAddress() {
        return address;
    }

    public void setAddress(String address) {
        this.address = address;
    }

    public String getBranchCode() {
        return branchCode;
    }

    public void setBranchCode(String branchCode) {
        this.branchCode = branchCode;
    }

    public String getBranchId() {
        return branchId;
    }

    public void setBranchId(String branchId) {
        this.branchId = branchId;
    }

    public String getBranchName() {
        return branchName;
    }

    public void setBranchName(String branchName) {
        this.branchName = branchName;
    }

    public String getBranchTel() {
        return branchTel;
    }

    public void setBranchTel(String branchTel) {
        this.branchTel = branchTel;
    }

    public String getCityName() {
        return cityName;
    }

    public void setCityName(String cityName) {
        this.cityName = cityName;
    }

    public String getCountryName() {
        return countryName;
    }

    public void setCountryName(String countryName) {
        this.countryName = countryName;
    }

    public String getLatitude() {
        return latitude;
    }

    public void setLatitude(String latitude) {
        this.latitude = latitude;
    }

    public String getLongitude() {
        return longitude;
    }

    public void setLongitude(String longitude) {
        this.longitude = longitude;
    }

    public String getWorkingHours() {
        return workingHours;
    }

    public void setWorkingHours(String workingHours) {
        this.workingHours = workingHours;
    }

} 
```

修改`gsonFoo()`方法为：

```
public void gsonFoo() throws Exception {
        URL url = new URL("http://loyaltier.com/app/mobile/code/places/Maps.php");
        InputStream inputStream = url.openStream();
        byte[] bt = new byte[inputStream.available()];
        inputStream.read(bt);
        System.out.println(new String(bt));
        Gson gson = new Gson();
        String input = new String(bt);
        List listOfThings = gson.fromJson(input, List.class);
        //System.out.println(listOfThings.get(0).toString());

        for (int i = 0; i < listOfThings.size(); i++) {
            Thing thing = gson.fromJson(listOfThings.get(i).toString(), Thing.class);
            System.out.println(thing.getAddress());
        }
    } 
```

在方法中，`String`变量`input`包含从给定的 .json 检索到的*json*数据`url`。并将数据传递给方法以创建`List`. 并且`List`在其每个数组中都包含用于创建对象的*json数据。*`Thing`

但是从给定链接中检索到的 json 数据中存在错误。在 json 数据中，您必须删除 json 对象值中的空格。例如，`"BranchName":"The Dubai Mall"`在其值中包含空格，将其转换为`"BranchName":"TheDubaiMall"`. 并删除每个 json 值中的空格。它会正常工作。尝试下面给出的示例*json*数据：

```
[{"branchId":"branchidinthing1","branchCode":"branchcodeinthing1","branchName":"branchnameinthing1","branchTel":"telinthing1","address":"addressinthing1","cityName":"citynameinthing1","countryName":"countrynameinthing1","latitude":"latitudeinthing1","longitude":"longitudeinthing1","workingHours":"workinghoursinthing1"},{"branchId":"branchidinthing2","branchCode":"branchcodeinthing2","branchName":"branchnameinthing2","branchTel":"telinthing2","address":"addressinthing2","cityName":"citynameinthing2","countryName":"countrynameinthing2","latitude":"latitudeinthing2","longitude":"longitudeinthing2","workingHours":"workinghoursinthing2"}] 
```

*它会正常工作，因为它在任何json*值中都不包含空格。

# objective-c - 如何删除持久的出口和行动

> ID：13480336
> 
> 赞同：0
> 
> 时间：2012-11-20T19:08:42.277
> 
> 标签：objective-c, xib, ibaction, iboutlet

我有一个未使用的出口和行动，仍然显示在文件的所有者出口和收到的行动列表中。我从 .m 和 .h 文件中删除了对象（tableView 和按钮）和相关代码，但未链接的插座和操作仍显示在列表中。这些可以去掉吗？这是个问题吗？

我尝试创建一组新对象，将它们链接起来并删除几种不同的方式（可能并不详尽），但无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:10:27.353

您是否单击了这些列表中的“x”以删除连接？如果没有，请这样做。

![删除连接](../Images/6626bb7b182d9be387b6045174d9280a.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T10:35:28.760

选择 .xib 文件，然后按 Ctrl 单击，打开为..，源代码。

查找并删除该旧插座的任何 xml 块。

编辑：对不起，我认为这很容易理解。让我展开...

例如：如果我从视图中删除了一个名为 btnPrevious 的按钮，而没有先清除出口链接。我会列出网点，但无法从视图中清除它们。

然后，我将打开 viewcontroller 的 .xib 文件（通过 Ctrl 单击/Open As../Source Code）并搜索 (Ctrl F) 以查找包含“btnPrevious”字样的任何块。删除找到的与已删除插座相关的任何代码块。.xib 文件中应该有一些。以下是要删除的 .xib 文件中的代码块示例。删除整个块以包含在内。

```
<object class'"IBActionInfo" key="btnPrevious_Click:">
    <string key="name">btnPrevious_Click:</string>
    (string key="candidateClassName">id</string>
</object> 
```

# function - 从另一个 MC 启动一个功能

> ID：13480339
> 
> 赞同：0
> 
> 时间：2012-11-20T19:08:56.367
> 
> 标签：function, actionscript, movieclip

我正在尝试通过我的“checkBoxes”MC 中的 eventListener 从我的“列”MC 内部触发一个函数。甚至有可能还是我应该以不同的方式看待？

我的“列”MC 代码：

```
act_btn.addEventListener(MouseEvent.CLICK, actPoint);
function actPoint(m:MouseEvent){
cA.height = cA.height + 10;
var clickSound:pointPlus = new pointPlus ();
clickSound.play(0,1);
if(cA.height == 200){
act_btn.removeEventListener(MouseEvent.CLICK, actPoint);
}
} 
```

这是我的“checkBoxes”MC中的代码：

```
cbPlus_btn.addEventListener(MouseEvent.CLICK, actPoint); 
```

如您所见，我向两个不同的事件监听器添加了“actPoint”函数......当然，它不起作用:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:24:18.863

您可以为同一函数分配任意数量的事件侦听器。关键（我认为这可能是您的问题）是您要设置为侦听器的函数必须在您尝试这样做的上下文中可见。

我认为您的问题是，当您尝试在复选框上创建单击侦听器时，您实际上并没有引用`actPoint`列中的方法`MovieClip`（如果您在控制台中发布任何错误消息，我们可能能够确认这一点）。

假设复选框是在与 column 相同的范围内创建的`MovieClip`，并且假设它具有实例名称，您应该能够通过将在复选框上添加事件侦听器的代码更改为以下代码来解决您的问题：

```
// Reference the method via the MovieClip instance which contains it
// Assumes column MovieClip has an instance name of columnMC
cbPlus_btn.addEventListener(MouseEvent.CLICK, columnMC.actPoint); 
```

# battery - 在 Android 平板电脑上查找电池电流 (mA/mAh)

> ID：13480341
> 
> 赞同：1
> 
> 时间：2012-11-20T15:14:23.937
> 
> 标签：battery, shell

我正在创建一个应用程序，我**需要能够获得电池电流 (mA/mAh)**。我有电压/温度/电平等，这是我需要得到的最后一件事，巧合的是，也是最难的。

我查看了 CurrentWidget 源代码（https://play.google.com/store/apps/details?id=com.manor.currentwidget&hl=en）并在 Google 上下搜索，我拥有所有的类/方法要提取数据，**它只是包含当前阻止我获取它的文件的路径**。

“CurrentWidget”包含许多不同的文件路径（适用于各种设备），但它们都不能在我的 4.0.3 上的**ASUS EEPad Transformer**上工作，我需要它来工作，因为它是我的测试设备，我能得到的都是我的手。我已经进入 adb shell 并在平板电脑的根部挖了几个小时，但除了我已经拥有的名称、温度、电压_now 和其他东西之外，我似乎找不到任何东西。它们都存储在 /sys/class/power_supply/battery 中，但没有我预期的“电流”，而且似乎在其他设备上。

感谢您的帮助，我知道这很长！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-03T06:29:52.753

current capacity of battery can be achieved by using android developer,s function via reflection

```
private Object mPowerProfile_;

private static final String POWER_PROFILE_CLASS ="com.android.internal.os.PowerProfile";

mPowerProfile_ = Class.forName(POWER_PROFILE_CLASS).getConstructor(Context.class).newInstance(this);

double batteryCapacity=(Double)Class.forName(POWER_PROFILE_CLASS).getMethod("getAveragePower", java.lang.String.class).invoke(mPowerProfile_, "battery.capacity"); 
```

i think this will help

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T23:15:58.497

这似乎是重复[获取 Android 手机的电池电流值](https://stackoverflow.com/questions/2439619/getting-the-battery-current-values-for-the-android-phone)

但是，如果您愿意的话，似乎如果当前小部件找不到您的平板电脑的安培数，那么平板电脑可能不支持写入该文件。要么是因为它没有内核支持的特定功能，要么是因为特定的硬件平台没有必要的硬件来从本质上测量电池终端本身的电流。

如另一篇文章所述，大多数其他小部件根据电流以外的其他因素计算电池百分比。

# django-forms - Django：如何访问模板中的表单字段 input_type

> ID：13480342
> 
> 赞同：1
> 
> 时间：2012-11-20T19:09:04.427
> 
> 标签：django-forms

我正在以这种方式呈现表单：

```
{% for field in form %}
    <div>
        {{ field.errors }}
        <input  name="{{field.name}}" type="{{field.widget.input_type}}" placeholder="{{field.name}}">
    </div>
{% endfor %} 
```

但是，`{{field.widget.input_type}}`在这里返回空字符串，尽管从 shell 中尝试它会产生`input_type`. 那么如何从模板中访问字段的输入类型呢？

我没有使用`{{field}}`，因为我需要在每个输入字段中放置一个占位符。

编辑：

我刚刚使用`{{field}}`了一个简单的 javascript，它将每个输入元素字段中的占位符与元素名称相同，但我仍然想知道如何`widget.input_type`从模板访问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T20:21:36.780

我可以建议和替代方法来获得相同的东西吗？

试着放

```
attrs = {'placeholder':'your placeholder text here'} 
```

像这样进入您的表单字段小部件：

```
formfield = SomeField(widget = SomeWidget(attrs = {'placeholder':'your placeholder text here'} )) 
```

然后你可以打印出来

```
{{ field }} 
```

在模板中并完成它。

编辑：回应第一条评论。

由于我刚刚开始新项目并在页面顶部下载了带有漂亮时尚登录表单的 html5 样板文件，因此我必须完全按照我的建议进行操作。我是这样做的：

表格.py：

```
from django.contrib.auth.forms import AuthenticationForm

class MyAuthenticationForm(AuthenticationForm):
    def __init__(self, *args, **kwargs):
        super(MyAuthenticationForm, self).__init__(*args, **kwargs)
        self.fields['username'].widget.attrs['placeholder'] = self.fields['username'].label
        self.fields['password'].widget.attrs['placeholder'] = self.fields['password'].label 
```

现在也许您的问题是您还想使用 django.contrib.auth.views.login 来登录用户，并且该视图使用 django 默认身份验证表单。不是问题！

打开你的 urls.py 并使用这个魔法：

```
from yourapp.forms import MyAuthenticationForm
from django.contrib.auth.views import login

urlpatterns = patterns('',
    url(r'^login/$',
        login,
        {'template_name': 'yourapp/login.html', 'authentication_form':MyAuthenticationForm},
        name='auth_login'),
) 
```

奇迹般有效

# c++ - 获取 winlogon.exe 的会话 ID 和进程 ID

> ID：13480344
> 
> 赞同：2
> 
> 时间：2012-11-20T19:09:06.480
> 
> 标签：c++, process

我正在尝试创建一个启动需要 UI 的应用程序的进程。所以它不能在会话0中。我的想法是获取当前登录用户的winlogon.exe的进程ID。通过这种方式，我可以复制 winlogon 令牌并使用 CreateProcessAsUser 函数运行我的应用程序。到目前为止我的代码：（当需要我要运行的应用程序时调用它）

```
#include <windows.h>
#include <tlhelp32.h>
#include <tchar.h>

this function()
{
  HANDLE hProcessSnap;
  HANDLE hProcess;
  PROCESSENTRY32 pe32;
  DWORD dwPriorityClass;

  // Take a snapshot of all processes in the system.
  hProcessSnap = CreateToolhelp32Snapshot( TH32CS_SNAPPROCESS, 0 );

  // Set the size of the structure before using it.
  pe32.dwSize = sizeof( PROCESSENTRY32 );

  //get the active session id
  DWORD sessionID = WTSGetActiveConsoleSessionId();

  // Now walk through the snapshot of processes
  //I want to narrow this down to processes called winlogon
  //if multiple users logged on system i want to make sure the active user
  //will get the application run the their screen
  do
  {
  // Retrieve the priority class.
    dwPriorityClass = 0;

    //here i want to compare the sessionID with session IDs of each winlogon process
    //stuck for implementation here
    //when i find a match i can use the processID to gain the token and create
    //a duplicate so it can be used in CreateAsUser function.
  }while( Process32Next( hProcessSnap, &pe32 ) );

 } 
```

所以基本上我需要一些帮助将进程的快照缩小到“winlogon”并遍历这些进程的会话 ID 以匹配活动用户的会话 ID。先谢谢了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T15:48:47.897

您可以使用[ProcessIdToSessionId](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382990%28v=vs.85%29.aspx)获取与“winlogon.exe”匹配的每个进程的会话 ID，然后将结果与[WTSGetActiveConsoleSessionId](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383835%28v=vs.85%29.aspx)进行比较。

这是您可以在循环中使用的片段：

```
if (_wcsicmp(pe32.szExeFile, L"winlogon.exe") == 0)
{
    DWORD ProcessSessionId = 0;
    ProcessIdToSessionId(pe32.th32ProcessID, &ProcessSessionId);
    if (ProcessSessionId == sessionID)
    {
        DoYourMagic(pe32.th32ProcessID);
        break;
    }
} 
```

# wordpress - .htaccess 重定向：http://domain.com 不会重定向到 https://www.domain.com

> ID：13480345
> 
> 赞同：1
> 
> 时间：2012-11-20T19:09:10.190
> 
> 标签：wordpress, .htaccess, redirect

我遇到了一些 .htaccess 规则的问题，该网站在 Wordpress 上并使用以下规则

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule ^ https://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

当有人访问 domain.com 或 www.domain.com 或 domain.com/* 它工作正常，它重定向到[https://www.domain.com](https://www.domain.com)。但是当我访问[https://domain.com](https://domain.com)时，它不会重定向到上面提到的 url。

# git - 从分离的头切换回分支时，Git“提交遗留”

> ID：13480346
> 
> 赞同：5
> 
> 时间：2012-11-20T19:09:15.027
> 
> 标签：git

对于我们 repo 中的某些提交（但不是全部），如果我检查提交，然后返回到 master 分支，我会收到关于提交被遗忘的意外警告：

```
# Check out one of the commits in question:
$ git checkout dd33caa5b004b0e3bd449152f9335e40450db91c
Note: checking out 'dd33caa5b004b0e3bd449152f9335e40450db91c'.

You are in 'detached HEAD' state. You can look around, make experimental
[...]
HEAD is now at dd33caa... Organized DataStore build files, added cleanup targets.

# Now switch back to the master branch so I can work:
$ git checkout master
Warning: you are leaving 17 commits behind, not connected to
any of your branches:

  dd33caa Organized DataStore build files, added cleanup targets.
  4916eec Fixes to C++ codegen to use maven features.
  a26291d Merge branch 'master' of [redacted origin repo address]
  93ae0b9 Add protobuf 2.4.1 jar file to install scripts. Add QTDIR to build script.
 ... and 13 more.

If you want to keep them by creating a new branch, this may be a good time
to do so with:

 git branch new_branch_name dd33caa5b004b0e3bd449152f9335e40450db91c

Switched to branch 'master' 
```

所有有问题的提交（据我所知）都可以从 master 访问，并且在分离的 head 状态下我没有进行任何提交（这是我们存储库的干净克隆）。master 分支的历史是这样的：

```
* 04d7fcc (HEAD, origin/master, origin/HEAD, master) Removed files from DataS
* ecaa2f5 Fixed .gitignore.
* dd33caa Organized DataStore build files, added cleanup targets.
* 4916eec Fixes to C++ codegen to use maven features.
*   a26291d Merge branch 'master' of [redacted]
|\  
| * 93ae0b9 Add protobuf 2.4.1 jar file to install scripts. Add QTDIR to buil
| * 3cba845 switched to protobug 2.4.1 jar files
| * 1046d22 fixed GATEWAY_ROOT
| * ebcda06 edit windows build scripting path for new repo location
| * bda1e17 add windows build scripts from old repo
* |   371883d Merge branch 'master' of [redacted]
|\ \  
| |/  
| * 771c579 Fix MCast and RMCast service names in gateway manager config
* | 864fb25 First cut at DataStore code generation update to sync with refact
|/  
* f505e46 Testing new repository
*   111d89a Merge branch 'master' of [redacted] 
```

知道这里可能会发生什么吗？它似乎与一个特定用户的提交有关，我可以在 OSX 上使用 Git 1.7.9.6 和在 Ubuntu 上使用 Git 1.7.9.5 来重现这一点，但在 Ubuntu 上却不能使用 1.8.0 ......所以可能是 Git 错误？不过，我在发行说明中看不到任何相关的内容...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T19:46:40.163

是的，这看起来像一个 Git 错误。如果你想知道是什么修复了它，你可以做一个二等分。克隆[git.git](https://github.com/git/git)，检查一个损坏的版本并验证问题是否发生，检查最新版本并验证它是否已修复，然后运行二分法以查找修复了问题的提交：

```
$ git clone git://github.com/git/git.git
$ cd git
$ git checkout v1.7.9.5
$ make
$ (cd my-repo && /path/to/my/git checkout dd33caa && /path/to/my/git checkout master 2>&1 | grep "leaving .* commits behind")
$ git checkout v1.8.0
$ make
$ (cd my-repo && /path/to/my/git checkout dd33caa && /path/to/my/git checkout master 2>&1 | grep "leaving .* commits behind")
# if the above gave the expected results:
$ git bisect start v1.7.9.5 v1.8.0
$ git bisect run bash -c "make && cd my-repo && /path/to/my/git checkout dd33caa && (! /path/to/my/git checkout master 2>&1 | grep -q 'leaving .* commits behind')" 
```

那应该让您继续进行修复错误的提交。请注意，我们正在做与通常的二分法相反的操作，在该二分法中，您试图找到引入错误的提交。

# ruby-on-rails - habtm 外键

> ID：13480349
> 
> 赞同：1
> 
> 时间：2012-11-20T19:09:23.317
> 
> 标签：ruby-on-rails

我尝试使用 habtm 关系，但我需要使用 uid 作为外键

```
SELECT "friends".* FROM "friends" INNER JOIN "friendships" ON "friends"."uid" = "friendships"."uid" WHERE "friendships"."user_id" = 4
#User
has_and_belongs_to_many :friends, :class_name => "Friend", :join_table => "friendships", :association_foreign_key => "uid"
#Friend
has_and_belongs_to_many :users, :class_name => "User", :join_table => "friendships", :foreign_key => "uid"

SELECT "friends".* FROM "friends" INNER JOIN "friendships" ON "friends"."id" = "friendships"."uid" WHERE "friendships"."user_id" = 4 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:34:30.910

遵循[Rails 样式指南](https://github.com/bbatsov/rails-style-guide#activerecord)：

> 更喜欢 has_many :through 到 has_and_belongs_to_many。使用 has_many :through 允许连接模型上的附加属性和验证

在你的情况下：

```
class Friendship < ActiveRecord::Base
  belongs_to :friend
  belongs_to :user
  # the validates are not mandatory but with it you make sure this model is always a link between a Friend and a User
  validates :user_id, :presence => true
  validates :uid, :presence => true # the Foreign Key is 'uid' instead of 'friend_id'
end

class User < ActiveRecord::Base
  has_many :friends, :through => :friendships
end

class Friend < ActiveRecord::Base
  has_many :users, :through => :friendships, :foreign_key => "uid"
end 
```

# jquery - 通过 $(element).css('top') 移动元素时出现可怕的抖动

> ID：13480353
> 
> 赞同：0
> 
> 时间：2012-11-20T19:09:29.673
> 
> 标签：jquery, css, google-chrome

我有一堆“页面”，我试图在鼠标滚轮上移动，这样顶部的移动比它下面的移动多，等等。它们是`position: absolute`，目前我正在调整 CSS`top`以移动它们，但它非常缓慢和笨拙。

编辑：取下演示，问题解决。

相关代码：

```
window.onScroll = (e, delta) ->
    e.preventDefault()

    minHeight = 5
    maxHeight = 800
    top_scale = 50
    second_scale = 5
    third_scale = 1
    stack = $('.card_stack').first().children()
    top = $(stack[stack.length - 1])
    second = $(stack[stack.length - 2])
    third = $(stack[stack.length - 3])

    for pair in [[top, top_scale], [second, second_scale], [third, third_scale]]
        pair[0].css('top', parseInt(pair[0].css('top'), 10) + delta*pair[1] + 'px')

$(window).mousewheel(window.onScroll)   # jQuery mousewheel plugin 
```

我尝试在 Chrome 的 Frames 选项卡中查看这个，以找出什么是这么慢，并得到了这个：[https ://dl.dropbox.com/u/407870/static/Screen%20Shot%202012-11-20%20at% 201.44.33%20PM.png](https://dl.dropbox.com/u/407870/static/Screen%20Shot%202012-11-20%20at%201.44.33%20PM.png)

看起来并没有发生太多事情，但也许我错过了一些东西。与我遇到的 Frames 问题有关的先前未回答的问题：[Web 检查器使用“Frames”进行分析：当时间轴中没有任何内容时找到性能问题的原因](https://stackoverflow.com/questions/11423330/web-inspector-profiling-with-frames-finding-the-cause-of-performance-problems)

我知道在发布任何类型的版本（例如，我正在编译 Less 和 Coffeescript in-page）之前还有很多其他的事情需要清理，但滚动是我目前关心的问题，因为它是我前提的核心。

我怎样才能最好地加快速度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T11:33:25.057

好的，我想我发现了问题（我亲爱的华生）。它不是来自滚动事件，而是更多关于你用它做什么。如果你检查帧你有一幅画需要 70 毫秒。那是因为您使用了诸如 box-shadows 之类的繁重的 css3 规则。如果您删除它，您将只有 7 毫秒的绘画时间！（所以性能提高了 10 倍）。

作为一般规则，尽量避免在动画元素上使用 css3 属性（因为它们对于浏览器来说很重！）。

**你可以看看这个 Google I/O 2012 会议关于这个特殊问题以及如何解决它：** [https ://www.youtube.com/watch?v=hAzhyTnhEI](https://www.youtube.com/watch?v=hAzhayTnhEI)

# python - 如何使用 PyQt4 仅加载特定信息

> ID：13480355
> 
> 赞同：0
> 
> 时间：2012-11-20T19:09:34.797
> 
> 标签：python, qt, pyqt

为了让我的问题更清楚，我举个例子：假设我去[http://python.org](http://python.org)并且我想加载里面的内容`<div id="content'> .... </div>`。而不是其余的，不想加载任何搜索栏、页脚、侧栏等。这个想法是节省带宽。

我的猜测是使用`SIGNAL - loadStarted()`，但我对如何编写适当的`SLOT`.

任何意见，建议都非常欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T20:48:44.937

我不认为你可以这样做......当你加载网址[http://python.org](http://python.org)时，它会下载和解析、渲染等整个页面，你无法加载该页面的特定部分。

编辑：也 loadStarted() 指的是整个页面，而不是它的一部分

# android - 在android中使用位置api

> ID：13480356
> 
> 赞同：0
> 
> 时间：2012-11-20T19:09:41.533
> 
> 标签：android, geolocation, maps, location, android-location

> **可能重复：**
> [在 Android 中获取用户当前位置的最简单、最可靠的方法是什么？](https://stackoverflow.com/questions/3145089/what-is-the-simplest-and-most-robust-way-to-get-the-users-current-location-in-a)

我研究了 android 的位置 api，并尝试了使用 locationChanged 方法的基本应用程序，并提供了一个最简单的解决方案来跟踪使用位置。

如何在同一上下文中跟踪用户的以下操作

*   用户输入新位置
*   离开当前位置的用户

以及以下因素：

*   新位置不在旧位置的 x 米范围内
*   以及比较上一个位置和新位置所需的属性

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:17:49.697

这还不错。关于这件事的官方Android SDK其实还不错。[关于它的官方谷歌文档](http://developer.android.com/guide/topics/location/strategies.html)

基本上，它使用的界面会在每种情况出现时运行功能。因此，只要位置根据触发该参数的任何参数发生更改，就会调用 onLocationChanged。另外，我建议只使用不同的提供商类型

最难的部分是距离部分。有公式可以使用经度和纬度计算距离。

从文档中：

```
// Acquire a reference to the system Location Manager
LocationManager locationManager = (LocationManager) this.getSystemService(Context.LOCATION_SERVICE);

// Define a listener that responds to location updates
LocationListener locationListener = new LocationListener() {
    public void onLocationChanged(Location location) {
      // Called when a new location is found by the network location provider.
      makeUseOfNewLocation(location);
    }

    public void onStatusChanged(String provider, int status, Bundle extras) {}

    public void onProviderEnabled(String provider) {}

    public void onProviderDisabled(String provider) {}
  };

// Register the listener with the Location Manager to receive location updates
locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, locationListener); 
```

# browser - 关闭另一个浏览器选项卡

> ID：13480358
> 
> 赞同：0
> 
> 时间：2012-11-20T19:09:49.407
> 
> 标签：browser

如果我将用户发送到移动应用商店（我的应用页面），有什么方法可以在用户下载我的应用后自动关闭该选项卡？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:14:15.543

嗨，您可以随时尝试，如果您使用 JavaScript 显示选项，只需添加

```
window.close(); 
```

作为脚本的最后一行

或放置单独的 JavaScript，例如

```
function  CloseWindow() {
 window.close();
 } 
```

并从 Button 调用它`onClick (HTML--> OnClick="CloseWindow()"/ASP-->this.btnTest.Attributes.Add("OnClick","CloseWindow()"); )`

您还可以将访问点存储到父窗口（打开窗口）的子窗口（弹出窗口）

```
var child = window.open(); 
```

然后您可以从父方关闭该弹出窗口

```
child. close(); 
```

# php - PHP 抑制与 'if' 以避免通知

> ID：13480360
> 
> 赞同：1
> 
> 时间：2012-11-20T19:09:54.127
> 
> 标签：php, session, suppress

> **可能重复：**
> [isset($var) 与 @$var](https://stackoverflow.com/questions/2600312/issetvar-vs-var)

如果有可能`$_SESSION`不会在页面加载时设置，那么在以下情况下，最佳实践是什么？是否可以取消类似 的通知，如果前面`Undefined index`没有，这将是第二个示例的结果。`@`考虑到处理器的使用情况，“无错误”代码值得多远（尽管在以下情况下差异必须很小）。

```
if( isset($_SESSION['sessionvar']) ){ $seen = $_SESSION['sessionvar']; } 
```

对比

```
@$sessionid = $_SESSION['sessionvar']; 
```

# git - 带有多个遥控器的 Git 结帐

> ID：13480361
> 
> 赞同：2
> 
> 时间：2012-11-20T19:09:58.643
> 
> 标签：git, git-checkout

我对 git checkout 的工作方式感到非常困惑。

假设我有两个遥控器：

```
origin
alternative 
```

假设两个遥控器都有一个名为 master 的分支。

如果我执行 git checkout master 会发生什么？我会检查原产地大师还是替代大师？我怎么换成另一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:25:16.567

```
git checkout master 
```

Grabs 签出名为 master 的本地分支。

```
git checkout -b NEWBRANCHNAME1 origin/master
git checkout -b NEWBRANCHNAME2 alternative/master 
```

将创建您可以工作的本地分支机构。

# c# - 覆盖页面渲染方法

> ID：13480362
> 
> 赞同：1
> 
> 时间：2012-11-20T19:10:04.890
> 
> 标签：c#, asp.net, sharepoint, sharepoint-2010

> **可能重复：**
> [SharePoint 2010 >> 编辑输出 HTML >> 页面或母版页呈现覆盖问题](https://stackoverflow.com/questions/5980477/sharepoint-2010-editing-output-html-issues-with-page-or-master-page-render)

我需要覆盖页面的 Render 方法并在渲染之前使用输出 html 进行一些操作。但是在尝试执行最简单的操作时，我遇到了一些奇怪的问题。对于调试建议，我添加了如下代码：

```
protected override void Render(System.Web.UI.HtmlTextWriter writer)
{
    if (Request.QueryString["test"] == "test")
    {
        StringBuilder sb = new StringBuilder();

        base.Render(new HtmlTextWriter(new StringWriter(sb)));

        writer.Write(sb.ToString());
    }
    else
    {
        base.Render(writer);
    }
} 
```

现在，如果 URL 中有 ?test=test ，则输出 HTML 将被破坏。响应 HTML 开头为：

```
VM-SP\administrator<script type="text/javascript">
//<![CDATA[
var _spUserId=1;
//]]>
</script>
<!DOCTYPE html ... 
```

如果 URL 中没有 ?test=test ，则响应 HTML 以：

```
<!DOCTYPE html ... 
```

'VM-SP\administrator' 是当前用户的名称。为什么输出不一样？这段代码有什么问题？

# apache - 在使用 Google 分析时配置无 cookie 域

> ID：13480363
> 
> 赞同：3
> 
> 时间：2012-11-20T19:10:07.473
> 
> 标签：apache, google-analytics, subdomain, cookieless

我的应用程序托管在 www.abc.co.in 上，托管静态内容的子域位于 static.abc.co.in 上。添加谷歌分析后，对子域的每个请求还包括 cookie。如何避免这种情况？

下面是我添加的脚本。我尝试了各种子域选项，例如设置为 www.abc.co.in 和 abc.co.in，但这不起作用。目前我正在尝试“无”，这也不起作用。

```
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-1234545-1'],['_setDomainName', 'none'],['_setSiteSpeedSampleRate', 50], ['_trackPageview'], 
['_trackPageLoadTime']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T16:04:36.163

最佳做法是为您的静态内容使用完全不同的域，例如“static.abc.co.net **” ，因此完全没有 cookie。**

# asp.net - 何时在 ASP.NET 中使用 Web 服务

> ID：13480369
> 
> 赞同：0
> 
> 时间：2012-11-20T19:10:36.300
> 
> 标签：asp.net, web-services

我正在看一个 javascript 教程，做它的人创建了一个简单的 toUpper 函数，他通过 javascript 访问该函数，实际上使用 javascript 来调用 Web 服务。它没有给我任何解释他为什么选择这样做，所以我想知道它何时适用于使用它们以及它们如何使我受益，而不是使用 C# 类或仅用 javascript 编写整个函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T06:26:00.260

Web 服务也非常适合在多个应用程序之间共享数据。

例如，如果您有一个域和服务层，您可以创建一个服务器，您的网站、andoird/iphone 应用程序和控制台应用程序可以访问而无需复制您的业务逻辑。

基本上它将用于检索数据，然后让您的应用程序决定如何处理该数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T06:04:51.167

在以下情况下使用 Web 服务而不是 C# 类

1.  您想向外部世界/消费者/其他应用程序公开一些功能
2.  您想解耦系统的各个部分，以便可以更改它们而不影响应用程序的其他部分
3.  您想要使您的应用程序可扩展，因此您创建网络服务并将其部署在不同的服务器上

# android - ProgressDialog 关闭 onClick

> ID：13480370
> 
> 赞同：4
> 
> 时间：2012-11-20T19:10:37.260
> 
> 标签：android, dialog, onclick, android-asynctask

我开始`AsyncTask`加载一个需要一些时间的文件。为了通知用户我正在显示一个`ProgressDialog`，但是如果我触摸屏幕，它会`ProgressDialog`立即关闭。这可能是什么原因？

```
 public LoadTask(Activity activity, FaceRecognizer recognizer,SecretKey key) {
    this.key = key;     
    this.recognizer = recognizer;       
    dialog = new ProgressDialog(activity);

}

@Override
protected void onPreExecute() {
    dialog.setMessage("Loading the recognizer...");
    dialog.show();
}

@Override
protected Boolean doInBackground(Void... params) {
    recognizer.load(key);
    return null;
}

@Override
protected void onPostExecute(Boolean result) {

    if (dialog.isShowing()) {
        dialog.dismiss();
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T19:46:59.697

用这个...

```
public LoadTask(Activity activity, FaceRecognizer recognizer,SecretKey key) {
    this.key = key;     
    this.recognizer = recognizer;       
    dialog = new ProgressDialog(activity);
     /////////////////////////////////////////// 
    dialog.setCancelable(false);
           //or////////
    dialog.setCanceledOnTouchOutside(false);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:22:50.957

尝试：[`dialog.setCanceledOnTouchOutside(false)`](http://developer.android.com/reference/android/app/Dialog.html#setCanceledOnTouchOutside%28boolean%29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:47:26.733

尝试：

```
dialog.setIndeterminate();
dialog.setCancelable(false); 
```

# jquery - 有没有办法找出 JQuery .load() 函数是否失败？

> ID：13480371
> 
> 赞同：1
> 
> 时间：2012-11-20T19:10:38.297
> 
> 标签：jquery, overlay, modal-dialog

有没有办法确定 jquery 中的 .load 函数是否加载了某些东西？我正在尝试将页面加载到模式对话框中。当验证失败时，它什么也不加载。在这种情况下，我想关闭覆盖。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T19:12:45.457

是的（来自[jQuery doc](http://api.jquery.com/load/)）：

```
$("#success").load("/not-here.php", function(response, status, xhr) {
  if (status == "error") {
    var msg = "Sorry but there was an error: ";
    $("#error").html(msg + xhr.status + " " + xhr.statusText);
  }
}); 
```

# php - 如何使用javascript删除引号之间的字符串内容？

> ID：13480373
> 
> 赞同：0
> 
> 时间：2012-11-20T19:10:43.197
> 
> 标签：php, javascript, jquery, regex, string

我有以下字符串：

```
var content = '<a href="www.topSecret.com">Link</a>' 
```

我的主要目标是：

```
var content = '<span>Link</span>' 
```

或者，如果不可能，至少：

```
var content = '<a href="" >Link</a>' 
```

一些注意事项：

1.  这个 var 将被发送到 PHP 变量，所以如果使用 PHP 更容易，它也被接受
2.  jQuery 最受欢迎

感谢您的所有帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T19:12:34.737

使用 PHP 轻松完成[`strip_tags()`](http://php.net/strip_tags)：

```
$str = '<a href="www.topSecret.com">Link</a>';
$result = '<span>' . strip_tags( $str) . '</span>';
echo $result; 
```

**输出：**

```
<span>Link</span> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:26:09.720

## jQuery版本

```
var $content = $('<a href="www.topSecret.com">Link</a>');
var result = "<span>" + $content.text() + "</span>"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T19:20:44.733

```
 var input = '<a href="www.topSecret.com">Link</a>';  
  pattern = /<a.+>(.*?)<\/a>/;
  matches = input.match(pattern);
  result = '<span>' + matches[1] + '</span>';
  alert(result); 
```

这是工作示例：http: [//jsbin.com/oqikib/1/edit](http://jsbin.com/oqikib/1/edit)

# perl - 使用 Winrar CMD 检查结构

> ID：13480375
> 
> 赞同：0
> 
> 时间：2012-11-20T19:10:44.780
> 
> 标签：perl, cmd, winrar

我有一堆 rar 文件，其中一些只包含一个或多个文件，有些有一个目录结构

我想创建一个 bat 文件，它可以按原样提取带有目录的 rar，如果没有目录，则使用 rar 文件名创建目录，然后提取到该目录，处理任何错误

所以这个 cmd 会输出一个列表到一个文本文件

```
C:\Program Files\WinRAR>UnRAR.exe l H:\temp\test.rar >H:\temp\test.txt 
```

结果是

```
UNRAR 4.20 freeware      Copyright (c) 1993-2012 Alexander Roshal

Archive H:\temp\Test.rar

 Name             Size   Packed Ratio  Date   Time     Attr      CRC   Meth Ver
-------------------------------------------------------------------------------
 Test.TXT            0        0   0% 20-11-12 18:44  .....A.   00000000 m0b 2.9
-------------------------------------------------------------------------------
    1                0        0   0% 
```

对于没有目录结构的 rar 文件和

```
UNRAR 4.20 freeware      Copyright (c) 1993-2012 Alexander Roshal

Archive H:\temp\testDir.rar

 Name             Size   Packed Ratio  Date   Time     Attr      CRC   Meth Ver
-------------------------------------------------------------------------------
 Test.TXT            0        0   0% 20-11-12 18:44  .....A.   00000000 m0b 2.9
 test                0        0   0% 20-11-12 18:45  .D.....   00000000 m0  2.0
-------------------------------------------------------------------------------
    2                0        0   0% 
```

有目录

我可以创建一个 perl 脚本，将这个列表输出到一个临时文本文件中读取它查找/模式匹配.D.....测试该目录是否存在并测试文件是否存在

然后创建另一个浴文件来提取文件

但我想知道是否有更简单的方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:12:29.163

您可以从这样的批处理脚本开始：

```
@echo off
setlocal EnableDelayedExpansion

for %%a in (*.rar) do (
  UnRAR.exe l "%%a" | findstr /C:".D....." >nul
  if !errorlevel!==0 (
    echo File %%a contains dirs
    UnRAR.exe x "%%a"
  )
  if !errorlevel!==1 (
    echo File %%a does not contain dirs, extracting in %%~na
    mkdir "%%~na"
    UnRAR.exe x "%%a" "%%~na\"
  )
) 
```

这将对当前目录`UnRAR.exe l filename`中的每个`*.rar`文件执行，然后检查它是否包含字符串`.D.....`，如果找不到字符串，它将在当前目录中提取 rar，否则它将创建一个与存档具有相同文件名的目录（但没有扩展名）并在那里提取档案。请检查我使用的 UnRAR.exe 的语法是否正确。

**编辑：**此代码通过子目录递归循环：

```
@echo off
setlocal EnableDelayedExpansion

for /r "%1" %%a in (*.rar) do (
  UnRAR.exe l "%%a" | findstr /C:".D....." >nul
  if !errorlevel!==0 (
    echo File %%a contains dirs, extracting in "%%~dpa"
    UnRAR.exe x "%%a" "%%~dpa"
  )
  if !errorlevel!==1 (
    echo File %%a does not contain dirs, extracting in %%~dpna
    mkdir "%%~na"
    UnRAR.exe x "%%a" "%%~dpna\"
  )
) 
```

# javascript - 访问 HTML5 数据属性

> ID：13480376
> 
> 赞同：0
> 
> 时间：2012-11-20T19:11:17.103
> 
> 标签：javascript, jquery, html, attributes, jquery-easyui

我正在尝试使用 HTML5 data-* 属性。但是我使用的是 EasyUI 框架，它有问题。

HTML5定义选项设置如下： `<div data-options="{region:'north', title:'North Region', border:true}">`

但 EasyUI 强制它们设置为（没有大括号）： `<div data-options="region:'north', title:'North Region', border:true">`

有没有办法在不编写我自己的解析器函数的情况下访问属性对象？如果必须，我必须，但我认为必须有更好的方法。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:19:38.490

查看源代码，有一种方法可以做到这一点。

```
$.parser.parseOptions(element); 
```

仅提取方法的演示：http: [//jsfiddle.net/FnJAE/](http://jsfiddle.net/FnJAE/)

注意：此方法未记录在案，因此如有更改，恕不另行通知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T20:05:10.913

仅供参考，你真的不必做所有的解析。尽管您的 HTML 确实需要在引号中进行一些更改：[[**请参阅参考 jQuery.Data() HTML5**]](http://api.jquery.com/data/#data-html5)

> HTML

```
<div id="Bob" data-options='{"region":"north", "title":"North Region", "border":"true"}'></div> 
```

> 脚本

```
console.log($("#Bob").data("options").title);
// Will return String "North Region"

console.log($("#Bob").data("options").region);
// Will return String "north"

console.log($("#Bob").data("options").border);
// Will return String "true"

console.log($("#Bob").data("options")
// will return a JSON Object but it is EASY to convert to Array
var eleData = $("#Bob").data("options"),
    eleArray = new Array();
for (x in eleData) { eleArray[x] = eleData[x]; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:32:41.953

如果您知道它将始终被格式化为一个对象，您可以：

```
jsonData = JSON.parse("{" + element + "}"); 
```

# java - 从一个表中读取行并将其复制到Java中的另一个数据库表

> ID：13480379
> 
> 赞同：2
> 
> 时间：2012-11-20T19:11:28.450
> 
> 标签：java, sql, database

我的 Java 数据库中有 2 个表。我想从 table1 加载行并将它们放在 table2 中。请问怎么做？我`ResultSet res = stmt.executeQuery(SQL)`用于从表 I 中读取数据。我可以使用什么来将此数据放入表 II。?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T19:50:48.187

给你：

```
String sql = "insert into table1 select * from table2 [where conditions]";
Statement stmt = connection.prepareStatement(sql);
stmt.executeUpdate(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:18:47.440

你可以尝试这样的事情： -

```
 Statement st1 = con1.createStatement();
 ResultSet rs = st1.executeQuery("select * from table1");
 PreparedStatement ps = null;

 while(rs.next())
    {
        ps = con2.prepareStatement("insert into table2 values(?,?)");
        ps.setInt(rs.getInt());
        ps.setString(rs.getString());
        ps.executeUpdate();
    } 
```

假设您的表中有两列

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:20:53.950

您可以为此使用 PreparedStatments

示例代码在这里

```
 int result;
    Connection connection = null; // manages connection
            PreparedStatement insert = null;

    connection = DriverManager.getConnection(DB_URL,"root","password");
                insert = connection.prepareStatement("INSERT into table2" +
                "(f1,f2,f3)" +
                "VALUES(?,?,?)" );
                        insert.setString(1, Yourvaluehere);
                insert.setInt(2, Yourvaluehere);
                insert.setDouble(3, YourValueHere);
    result = insert.executeUpdate(); 
```

//Yourvaluehere - 应该来自对象的getmethods - 这就是我所做的，如果你有这个想法，你可以做得更好

# python - 如何使用 python 找到对？

> ID：13480383
> 
> 赞同：1
> 
> 时间：2012-11-20T19:11:36.910
> 
> 标签：python

假设我有这种格式的数据（假设制表符分隔）

```
1   10,11,15
2   12
3   12,11
4   10,11 
```

如何遍历列表并计算第二列中最流行的对象对？假设第二列可以有无限数量的项目。

理想的输出将返回类似

```
pairs count
10,11 (2)
10,15 (1)
11,15 (1)
11,12 (1) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T19:22:37.643

这些都假设您可以将输入放入列表列表中：

如果您有 Python 2.7，请尝试`Counter`结合使用`itertools`：

```
>>> from collections import Counter
>>> from itertools import combinations
>>> l = [[10, 11, 15], [12], [12, 11], [10, 11]]
>>> c = Counter(x for sub in l for x in combinations(sub, 2))
>>> for k, v in c.iteritems():
...   print k, v
...
(10, 15) 1
(11, 15) 1
(10, 11) 2
(12, 11) 1 
```

如果你有 Python < 2.6，你可以`defaultdict`结合使用 a `itertools`（我敢肯定其中一位大师会提供更简洁的解决方案）。

```
In [1]: from collections import defaultdict

In [2]: from itertools import combinations

In [3]: l = [[10, 11, 15], [12], [12, 11], [10, 11]]

In [4]: counts = defaultdict(int)

In [5]: for x in l:
   ...:     for item in combinations(x, 2):
   ...:         counts[item] += 1
   ...:
   ...:

In [6]: for k, v in counts.iteritems():
   ...:     print k, v
   ...:
   ...:
(10, 15) 1
(11, 15) 1
(10, 11) 2
(12, 11) 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:28:14.320

```
In [7]: with open("data1.txt") as f:
        lis=[map(int,x.split(",")) for x in f]
   ...:     

In [8]: Counter(chain(*[combinations(x,2) for x in lis]))
Out[8]: Counter({(10, 11): 2, (10, 15): 1, (11, 15): 1, (12, 11): 1}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:28:34.140

你可以使用`combinations`和一个`Counter`.

```
from itertools import combinations
import collections

newinput = []

# Removes the tabs
for line in oldinput:
    newinput.append(line.partition("\t")[2])

# set up the counter
c = collections.Counter()

for line in newinput:
    # Split by comma
    a = line.split(',')
    # make into integers from string
    a = map(int, a)
    # add to counter
    c.update(combinations(a, 2)) 
```

然后，你最终得到一个`Counter`包含所有计数的：`(10,15): 1) 等。

# lua - 在 corona sdk 中让玩家在碰撞时淡入淡出

> ID：13480385
> 
> 赞同：2
> 
> 时间：2012-11-20T19:12:08.663
> 
> 标签：lua, physics, coronasdk

发生碰撞时如何让我的播放器淡入淡出几秒钟？我有我的玩家设置，当他碰撞时他会失去生命，但当他碰撞时，他基本上会卡在物体上。我希望他与物理对象发生碰撞，失去生命并在物理对象上闪烁一秒钟，而玩家在该淡入淡出时间内没有任何物理属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T11:25:19.677

碰撞我想你在做物理。

对于失去生命，这取决于您的代码。

闪入闪出：

使用“transition”和“setFillColor”或“alpha”，我在我的一个项目中亲自使用此代码：

```
--on collision yaddayadda
myPlayerObject.alpha = 0.3;
transition.to(myPlayerObject, {alpha=1, time=300})
--more yaddayadda 
```

由于您只能使用代码删除颜色（而不是添加），如果您希望它闪烁白色（如那些旧的 NES 游戏），您将需要第二个白色对象，并执行与我所做的相反的操作（将 alpha 设置为1 并转换为 0）。

制作物理对象没有属性：

有一个名为“isSensor”的属性，只需在您的播放器上将其设置为 true，这将使其不会与其他东西碰撞，但会保持动量、速度等。

它仍然会触发碰撞事件（但它不会“撞”到东西上），因此您需要检查“isSensor”是否为真，然后从该点返回。

# wpf - 带有 Unity 容器的 WPF - 如何将 ViewModel 注册和解析为 View

> ID：13480387
> 
> 赞同：6
> 
> 时间：2012-11-20T19:12:09.923
> 
> 标签：wpf, unity-container

您好我正在尝试在 WPF MVVM 应用程序中使用 Unity 容器。我没有使用棱镜，因为它似乎很重。这是应用程序结构。我试图弄清楚如何将视图解析为 ViewModels 和视图模型（服务）的依赖关系。

# 应用：

意见

```
MainWindow.xaml
CustomerList.xaml
CustomerDetail.xaml
BookList.xaml
BookDetail.xaml 
```

视图模型

```
MainViewModel

CustomerListViewModel

BoolListViewModel

BookDetailViewModel

CustomerDetailViewModel 
```

图书馆

```
ICustomerService (AddCustomer, SaveCustomer, GetCustomers, GetCustomer)

CustomerService:ICustomerService

IBookService (GetBooks, GetBook)

BookService:IBookService

IBookReserveService(Reserve, Return)

BookReserveService:IBookReserveService 
```

1.  MainViewModel 需要引用 ICustomerService 和 IBookService

2.  CustomerListViewModel 需要引用 ICustomerService

3.  BoolListViewModel 需要参考 IBookService

4.  BookDetailViewModel 需要引用 ICustomerService 和 IBookReserveService

5.  CustomerDetailViewModel 需要引用 ICustomerService 和 IBookReserveService

我在每个视图模型中都有用于服务的 getter setter 属性。

我遇到了如何将依赖注入与 WPF 一起使用的问题，尤其是对于 Views 和 ViewModel。我尝试使用 Unity 在运行正常的控制台应用程序中注册和解析。但我想要一些关于如何为 WPF 应用程序完成此操作的想法。我试过注册

```
 container.RegisterType<ICustomerService, CustomerService>()
 container.RegisterType<IBookReserveService, BookReserveService>()
 container.RegisterType<IBookService, BookService>() 
```

并使用 container.Resolve(); 解决它

但我不确定如何判断哪个视图必须使用哪个视图模型并在需要时解决它们，而不是在应用程序启动时解决它们。另外，我不解决应用程序启动中的所有映射。应在选择菜单（选择客户查看详细信息、选择图书查看详细信息、保存客户、预订图书等）时完成。

我读到的大部分内容都想使用 IView 和 IViewModel。但不确定我是否理解它的优势。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-20T19:36:17.637

这是您可以做到这一点的一种方法。首先，使用 Unity 注册您的视图模型和服务，如下所示：

```
// Unity is the container
_container.RegisterType<IMainViewModel, MainViewModel>();
_container.RegisterType<IBookService, BookService>(); 
```

其次，在视图的构造函数中将视图的 DataContext 设置为视图模型，如下所示：

```
public partial class MainView:UserControl
{
   private readonly IUnityContainer _container;

   public MainView(IUnityContainer container)
        {
            InitializeComponent();
            _container = container;   
            this.DataContext = _container.Resolve<IMainViewModel>();            
        }      
} 
```

第三，您需要将您的服务注入到您的视图模型中：

```
public MainViewModel(ICustomerService custService, IBookService bookService ){} 
```

使用 .config 文件等还有其他方法可以做到这一点，但这应该足以让您开始，如果您需要更多，请告诉我。你问DI有什么优点，我觉得有很多。仅举几例：促进组件之间的松散耦合并提高可测试性。我觉得这是一个好的设计/实现的关键。

更新：

使用 Unity >=3，如果遵循如下命名约定，则可以跳过容器注册：

```
// This will register all types with a ISample/Sample naming convention 
            container.RegisterTypes(
                AllClasses.FromLoadedAssemblies(),
                WithMappings.FromMatchingInterface,
                WithName.Default); 
```

# android - 使用命令行有效地将资源复制到另一个项目中

> ID：13480389
> 
> 赞同：1
> 
> 时间：2012-11-20T19:12:14.453
> 
> 标签：android, bash, shell, command-line

有时，我需要将 android 资源从一个项目移动到另一个项目。例如，[Android Holo Colors](http://android-holo-colors.com/)会输出一个 .zip 文件，提取该文件后会生成一个具有通常 Android 目录结构的 res 文件夹。

```
res/ 
  - drawable-ldpi/
  - drawable-mdpi/
  - drawable-hdpi/
  - drawable-xhdpi 
```

通常，不同大小的资源被放置在具有相同名称的每个目录中。因此，button.png 将存在于 drawable-ldpi、drawable-mdpi、drawable-hdpi 和 drawable-xhdpi 中。可以使用什么命令或脚本将输出的可绘制文件夹立即复制或移动到我的项目中，而无需复制整个 res 目录并覆盖其他文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:08:02.397

`mv`不移动目录而是移动它的内容。你应该使用

```
 $ cd orig
 $ tar cf - res | (cd dest; tar xkf -) 
```

**从orig**中删除你不想要的东西。

# c# - 使用 AxAcroPDFLib 显示 PDF 文件

> ID：13480398
> 
> 赞同：1
> 
> 时间：2012-11-20T19:12:50.377
> 
> 标签：c#, acrobat-sdk

在 C# 中使用 AxAcroPDF 对象，是否有隐藏弹出的悬停栏？我使用此控件的动机是能够向我的用户显示 PDF，但不允许他们保存 PDF 的副本。或者，是否有人知道除 Adob​​e 之外的任何控件可以使用 C# 嵌入到 WPF 应用程序中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-22T15:37:02.813

在撰写本文时，Adobe COM 组件不支持隐藏浮动悬停栏，因此用户可以保存 PDF。我最终使用了 O2 解决方案中的 PDFView4NET 库，它为我提供了所需的可定制性。

# svg - SVG 在 Safari iOS 6 中加载缓慢

> ID：13480402
> 
> 赞同：2
> 
> 时间：2012-11-20T19:12:58.603
> 
> 标签：svg, ios6, mobile-safari

我们有一些 svg 文件在 iOS 6 的 Safari 中加载速度非常慢（浏览器在加载文件时会挂起大约一分钟左右。这是直接浏览到 svg 文件，没有 javascript 或外部代码。

在 iOS 5 的 Safari 中加载相同的文件只需要一到 2 秒即可加载。有没有其他人在 iOS 6 中遇到过这个问题，或者知道任何可能导致在 iOS 6 中发生这种情况的 svg 元素？

# c++ - C++ - 计算 PCA 的框架（犰狳除外）

> ID：13480410
> 
> 赞同：2
> 
> 时间：2012-11-20T19:13:30.817
> 
> 标签：c++, pca, armadillo

我有一个围绕`200000`数据点的大型数据集，其中每个数据点都包含`132`特征。所以基本上我的数据集是`200000 x 132`.

我已经使用[犰狳框架](http://arma.sourceforge.net/)完成了所有的计算。但是，我尝试进行 PCA 分析，但我收到了一个内存错误，我不知道这是因为我的 RAM 内存（8 GB 的 Ram）还是由于框架本身的限制。

我收到以下错误：`requested size is too large`。

你能推荐我另一个没有大小/内存限制的 PCA 计算框架吗？

或者，如果您以前使用犰狳进行 PCA 计算并遇到此问题，您能告诉我您是如何设法解决的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:04:03.447

您可能需要在 Armadillo 中启用[64 位整数](http://arma.sourceforge.net/docs.html#config_hpp)，用于存储元素的总数等。

具体来说，编辑文件 **include/armadillo_bits/config.hpp** 并取消注释该行：`// #define ARMA_64BIT_WORD`。在 3.4 版中，这应该在第 59 行附近。

或者，您可以在程序中包含 Armadillo 标头之前定义 ARMA_64BIT_WORD，例如：

```
#define ARMA_64BIT_WORD
#include <armadillo>
#include <iostream>
... 
```

请注意，您的 C++ 编译器必须能够处理 64 位整数。现在大多数编译器都有它。

# php - MYSQL 计数的显示结果

> ID：13480413
> 
> 赞同：0
> 
> 时间：2012-11-20T19:13:53.673
> 
> 标签：php, mysql, count

我正在使用查询来输出喊话箱成员的列表及其喊叫次数：

```
SELECT user_id, COUNT( * ) AS Shouts
FROM shouts
GROUP BY user_id
ORDER BY Shouts DESC 
```

其中显示：

用户 1：3490
用户 2：1234
用户 3：345
...

我尝试了以下方法：

```
$result = mysql_query(the query above);
$count = mysql_fetch_array($result);
echo $count['Shouts']; 
```

但它只显示第一行。如何显示整个结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:16:24.417

您需要将 mysql_fetch_array 放在一个循环中：

```
while ($count = mysql_fetch_array($result)) {
    echo $count['Shouts'];
} 
```

# r - 使用 R 进行刻面标记

> ID：13480424
> 
> 赞同：5
> 
> 时间：2012-11-20T19:14:34.990
> 
> 标签：r, labels, facet

我正在尝试使用构面图绘制数据子集。它是 2 列 x4 行图。第一列的值介于 120 和 150 之间，第二列的值介于 180 和 250 之间，并且变量在数据文件中分配为较小或较大。我在将特定标签（'120 <= greek symbol(alpha) <= 150'、'180 <= greek symbol(alpha) <= 250）添加到列变量（“Lesser”、“Greater”）时遇到问题. 我试着这样做：

```
require(graphics)
library(ggplot2)
hp <- ggplot2(data) + ....
xlow <- paste("120 <", expression(alpha), " < 150") 
xhi <- paste("180 <", expression(alpha), " < 250")
mf_labeller <- function(var, value){
  value <- as.character(value)
  if (var=="regime") {
  value[value=="Lesser"] <- xlow
  value[value=="Greater"]  <- xhi
}
  return(value) 
}
(hp %+% data) + facet_grid(param~regime,  scales="free", labeller=mf_labeller) 
```

我得到“值错误==“更大”：表达式不允许比较”。我也尝试强制数据。如果我以任何方式进行标记：

```
data2 <- transform(data, regime = factor(regime, levels=c("Lesser", "Greater"), labels=c(expression(paste("120 <", alpha," < 150")), expression("180 < alpha < 250")))) 
```

我得到了完整的表达，而不是想要的情节。我可能会遗漏一些东西。任何帮助都非常感谢！先感谢您..

我的样本摘录是：

```
regime,param,line,XX,Var,sner
Lesser,Rise,VII,AA,4.968624,0.1275248
Lesser,Rise,VII,BB,3.719405,0.08470305
Lesser,Rise,VII,CC,7.608773,0.177848
Lesser,Rise,VII,DD,9.874395,0.1367159
Lesser,Text,VII,AA,4.968624,0.1275248
Lesser,Text,VII,BB,3.719405,0.08470305
Lesser,Text,VII,CC,7.608773,0.177848
Lesser,Text,VII,DD,9.874395,0.1367159
Lesser,Chant,VII,AA,0.1771826,0.186758
Lesser,Chant,VII,BB,0.3611497,0.5484656
Lesser,Chant,VII,CC,0.7719002,0.8864444
Lesser,Chant,VIII,DD,1.829022,0.2639881
Greater,Rise,VII,AA,4.968624,0.1275248
Greater,Rise,VII,BB,3.719405,0.08470305
Greater,Rise,VII,CC,7.608773,0.177848
Greater,Rise,VII,DD,9.874395,0.1367159
Greater,Text,VII,AA,4.968624,0.1275248
Greater,Text,VII,BB,3.719405,0.08470305
Greater,Text,VII,CC,7.608773,0.177848
Greater,Text,VII,DD,9.874395,0.1367159
Greater,Chant,VII,AA,0.1771826,0.186758
Greater,Chant,VII,BB,0.3611497,0.5484656
Greater,Chant,VII,CC,0.7719002,0.8864444
Greater,Chant,VIII,DD,1.829022,0.2639881 
```

和我使用的代码：我在帖子中以错误的方式写了前面的表达式，但我确实在代码中使用了正确的表达式。

```
x <- read.table("sample.csv", header=T, sep=',')
require(graphics)
library(ggplot2)
ppi <- 300
png("figure.png", width=6*ppi, height=6*ppi, res=ppi)
hp <- ggplot(data=x,aes(x=XX, y=Var, colour=line, group = line)) + geom_errorbar(aes(ymin=Var-sner, ymax=Var+sner, colour=line), width=.3) + geom_line(aes(ymax=Var+sner), size=0.7) + geom_point(aes(ymax=Var+sner), shape=21, size=2,fill="white") + theme_bw() + theme(axis.text.x = element_text(angle=90,vjust=0.25), panel.grid.minor=element_blank(), panel.grid.major=element_blank(), panel.background =element_blank(), legend.position="none" ) + scale_colour_hue(l=40) 
xlow <- expression(paste("120 <",alpha," < 150"))
xhi <- expression(paste("180 <", alpha," < 250"))
.. earlier code block as alternative here...
data2 <- transform(x, regime = factor(regime, levels=c("Lesser", "Greater"), labels=c( bquote(120<.(alpha)~phantom()<150), bquote(180<.(alpha)~phantom()<250) )
(hp %+% data2) + facet_grid(param~regime,  scales="free", labeller=label_bquote) 
```

我也像以前一样尝试过 mf_labeller .. 提前谢谢你

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T21:21:17.297

你想要的 plotmath 表达式的形式是

```
expression(120 <= alpha~phantom() <= 150)
expression(180 <= alpha~phantom() <= 250) 
```

您可以通过这种方式或间接获得

```
parse(text="120 <= alpha~phantom() <= 150")
parse(text="180 <= alpha~phantom() <= 250") 
```

最简单的方法是将因子的级别设置为这些字符串并使用该`label_parsed`函数。

用`mtcars`数据模拟它，因为您没有提供可重现的示例：

```
dat <- mtcars   
dat$regime <- factor(dat$am)
levels(dat$regime) <- list("120 <= alpha~phantom() <= 150" = "0",
                           "180 <= alpha~phantom() <= 250" = "1")

ggplot(aes(x=wt, y=mpg), data=dat) +
  geom_point() +
  facet_grid(cyl ~ regime, labeller=label_parsed) 
```

![在此处输入图像描述](../Images/9537bc4636aa9fd1c18e4e94855a916a.png)

如果您真的想使用自己的标注器，并且不想更改基础数据的因子水平，您也可以这样做。从具有“较小”和“较大”级别的模拟数据开始：

```
dat <- mtcars   
dat$regime <- factor(dat$am, levels=c(0,1), labels=c("Lesser", "Greater")) 
```

那么 labeller 函数和 ggplot 代码将是：

```
mf_labeller <- function(var, value){
  value <- as.character(value)
  if (var=="regime") {
    value[value=="Lesser"] <- "120 <= alpha~phantom() <= 150"
    value[value=="Greater"]  <- "180 <= alpha~phantom() <= 250"
    value <- lapply(value, function(x) parse(text=x))
  }
  return(value) 
}

ggplot(aes(x=wt, y=mpg), data=dat) +
  geom_point() +
  facet_grid(cyl ~ regime, labeller=mf_labeller) 
```

该图看起来相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:18:36.127

我没有真正的答案，但我提出这个希望它有帮助。我的解决方案引发了一个错误，带有两个小于号，但可以使用一个，这让我觉得这是错误的行为。*（编辑，请参阅下面的 Brian Diggs 评论或大概/希望在上面回答为什么这不是错误的。）*

有效的示例数据，请注意，我在 twolabs 中用一个加号代替了一个小于号：

```
twolabs  <- c("120<alpha+150","150<alpha+250")
df<- data.frame(x=rnorm(mean=4,40),
   y=rnorm(mean=4,40),
   labs=sample(twolabs,40,replace=T)) 
```

这个情节很漂亮。

```
ggplot(df,aes(x=x,y=y))+geom_point()+facet_grid(.~labs,labeller=label_parsed) 
```

但是，带有两个小于号的数据会引发错误：

```
twolabs  <- c("120<alpha<150","150<alpha<250")
df2<- data.frame(x=rnorm(mean=4,40),
   y=rnorm(mean=4,40),
   labs=sample(twolabs,40,replace=T))

> ggplot(df2,aes(x=x,y=y))+geom_point()+facet_grid(.~labs,labeller=label_parsed)
Error in parse(text = x) : <text>:1:10: unexpected '<'
1: 120<alpha< 
```

通过使用 label_parsed，我认为我们最终会调用 gridDevices::plotmath，因为它的价值。有人可以更进一步吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T20:35:29.057

我们没有要测试的数据（我们也没有您正在使用的代码），但先前的格子绘图经验告诉我，可能需要and中`bquote`的任何一个或某种组合。尝试 ：`sapply``as.expression`

```
..., labels=c( bquote(120<.(alpha)~phantom()<150), bquote(180<.(alpha)~phantom()<250) ) 
```

在代码的第一部分中，我不认为您应该在`expression`内部使用，`paste`而是先构建标签，然后构建表达式向量。

如果你绝望了，你可以先构建情节，然后强制标签变得不同。[如何使用网格编辑 ggplot2 对象以将数学表达式添加到构面标签？](https://stackoverflow.com/questions/6525857/how-can-i-use-grid-to-edit-a-ggplot2-object-to-add-math-expressions-to-facet-lab)

# java - 将具有所有子类的 java-object 映射到 json 字符串

> ID：13480425
> 
> 赞同：0
> 
> 时间：2012-11-20T19:14:35.847
> 
> 标签：java, javascript, json, object, serialization

我知道如何序列化 java 对象。但是如果我有一个对象并且在另一个为空的对象内部怎么办？

例如

我的第一堂课：

```
public class Invoice {

  private Adresse adresse;
  private Double betrag;
  private Double ust;
  private String zweck;

} 
```

我的第二堂课：

```
public class Adresse {

  private String name;
  private Ort ort;

} 
```

我的第三堂课：

```
public class Ort {

  private String plz;
  private String name;

} 
```

也许更多生成的子类......

我想得到这个 json 对象：

```
{"adresse":{"name":null,"ort"{"plz":null,"name":null}},"betrag":null,"Ust":null,"zweck":null} 
```

我不允许更改我的 POJO。什么样的框架可以为我做到这一点？我尝试了 gson，但 gson 不适用于子类。

问候，戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T02:53:16.190

我让它工作了！使用 Java 反射，json 和它是递归的！

这里的代码：

1.  **userDefined()**检查一个类是用户定义的还是原始的，可以根据需要进行自定义。

    ```
    public boolean isUserDefined(Class o) {
      if (o.isAssignableFrom(String.class)) {
        return false;
      }
      if (o.isAssignableFrom(Double.class)) {
        return false;
      }
      if (o.isAssignableFrom(Integer.class)) {
        return false;
      }
      if (o.isAssignableFrom(Boolean.class)) {
        return false;
      }
      if (o.isAssignableFrom(Short.class)) {
        return false;
      }
      if (o.isAssignableFrom(Float.class)) {
        return false;
      }
      if (o.isAssignableFrom(Long.class)) {
        return false;
      }
      return true;
    } 
    ```

2.  **getSetterMethod()**返回字段的设置方法。

    ```
    private static Method getSetterMethod(Object o, Field f) {       
        for (Method method : o.getClass().getMethods()) {
            String fieldname = "set" + f.getName();
            String methodname = method.getName().toLowerCase();
            if (fieldname.equals(methodname)) {
                return method;
            }
        }
        return null;
    } 
    ```

3.  最后，**invokeSetters()**调用用户定义的对象 setter 方法和子类的方法！是的。所以我的 Invoice 对象我会放在这里作为参数：

    ```
    Invoice i = new Invoice();
    invokeSetters(i); 
    ```

这是：

```
 private void invokeSetters(Object o) throws IllegalArgumentException, IllegalAccessException, ClassNotFoundException, InstantiationException, NoSuchMethodException, InvocationTargetException {
        System.out.println("INVOKING THE OBJECT " + o.getClass().toString());
          for (Field f : o.getClass().getDeclaredFields()) {
            System.out.println("NOW IN THE FIELD: " + f.getName());
            f.setAccessible(true);
            Object obj = null;
            if (isUserDefined(f.getType()) && f.get(o) == null) {
                System.out.println("FIELD is USER DEFINED AND NULL");
                Class c = Class.forName(f.getType().getName());
                System.out.println("CLASS IS " + c.getName());
                obj = c.getConstructor().newInstance();
                System.out.println("GOING INSIDE " + obj.toString() + " NOW.");
                invokeSetters(obj);
            }
            if (obj != null) {
                Method setter = getSetterMethod(o, f);
                System.out.println("IM IN PARENT OBJECT " + o + " AND INVOKING METHOD " + setter.getName() + " WITH PARAMETER " + obj.toString());
                setter.invoke(o, obj);
                System.out.println("METHOD WAS INVOKED");
            }
          }
        } 
```

# matlab - 如何在伽罗瓦域中找到矩阵的行秩？

> ID：13480427
> 
> 赞同：2
> 
> 时间：2012-11-20T19:14:38.790
> 
> 标签：matlab, matrix, rank, galois-field

Matlab 有一个内置函数，用于计算具有十进制数和有限域数的矩阵的秩。但是，如果我没记错的话，他们只计算最低排名（行排名和列排名最低）。我只想计算行秩，即找到矩阵的独立行数（在我的例子中是有限字段）。有没有功能或方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T20:40:27.993

在线性代数中，列秩和行秩***总是***相等的（见[证明](http://en.wikipedia.org/wiki/Rank_%28linear_algebra%29#Column_rank_.3D_row_rank_or_rk.28A.29_.3D_rk.28AT.29)），所以只需使用 （如果你正在计算伽罗瓦域上的矩阵的秩，请考虑使用，就像@DanBecker 在他的评论中建议的那样）：[`rank`](http://www.mathworks.com/help/matlab/ref/rank.html)
[`gfrank`](http://www.mathworks.com/help/matlab/ref/rank.html)

### 例子：

```
>> A = [1 2 3; 4 5 6]

A =
    1   2   3
    4   5   6

>> rank(A)
ans =
    2 
```

也许所有三列似乎都是线性独立的，但它们*是*相互依赖的：

```
[1 2; 4 5] \ [3; 6]
ans =
    -1
     2 
```

意思是`-1 * [1; 4] + 2 * [2; 5] = [3; 6]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T17:55:37.547

施瓦茨，

两条评论：

1.  您在评论中声明“等级函数在伽罗瓦域中也可以正常工作！” 我不认为这是正确的。考虑文档页面上给出的示例`gfrank`：

    ```
    A = [1 0 1;
       2 1 0;
       0 1 1];
    gfrank(A,3) % gives answer 2
    rank(A) % gives answer 3 
    ```

    但有可能我误解了一些事情！

2.  您还说“如何检查矩阵的行是否线性独立？我在上面发布的解决方案对您来说是否合法，即获取每一行并逐一查找其与所有其他行的排名？”

    我不知道你为什么说“一一找到它与所有其他行的排名”。可以有一组成对线性独立但线性相关的向量作为一个组。只需考虑向量`[0 1]`, `[1 0]`, `[1 1]`。没有向量是任何其他向量的倍数，但集合不是线性独立的。

    你的问题似乎是你有一组你知道是线性独立的向量。您向该集合添加一个向量，并想知道新集合是否仍然线性独立。正如@EitanT 所说，您需要做的就是将（行）向量组合成一个矩阵并检查它的`rank`（或`gfrank`）是否等于行数。无需“一个接一个”地做任何事情。

    既然您知道“旧”集是线性独立的，也许有一个很好的快速算法来检查新向量是否使事物线性相关。也许在每一步你都会正交化集合，也许这会使给定新向量的线性独立性检查过程更快。这可能会在诸如 mathoverflow 之类的地方提出一个有趣的问题。

# android - RSS 应用程序停止

> ID：13480431
> 
> 赞同：1
> 
> 时间：2012-11-20T19:14:52.403
> 
> 标签：android, parsing, casting, rss

我遵循了这个 RSS 阅读器[教程](http://androidresearch.wordpress.com/2012/01/21/creating-a-simple-rss-application-in-android/)。

所以起初我在这一行遇到了一个错误：

```
Uri uri = Uri.parse(links.get(position)); 
```

我得到了错误，我必须将它转换为这样的字符串：

```
Uri uri = Uri.parse((String) links.get(position)); 
```

之后就可以运行应用程序了。但是，如果我想打开一个 ListView 元素，应用程序每次都会停止......有没有人知道出了什么问题？

这里是logcat：

```
11-20 19:25:19.027: E/AndroidRuntime(505): FATAL EXCEPTION: main
11-20 19:25:19.027: E/AndroidRuntime(505): java.lang.IndexOutOfBoundsException: Invalid index 2, size is 0
11-20 19:25:19.027: E/AndroidRuntime(505):  at java.util.ArrayList.throwIndexOutOfBoundsException(ArrayList.java:257)
11-20 19:25:19.027: E/AndroidRuntime(505):  at java.util.ArrayList.get(ArrayList.java:311)
11-20 19:25:19.027: E/AndroidRuntime(505):  at com.rss_reader.MainActivity.onListItemClick(MainActivity.java:111)
11-20 19:25:19.027: E/AndroidRuntime(505):  at android.app.ListActivity$2.onItemClick(ListActivity.java:319)
11-20 19:25:19.027: E/AndroidRuntime(505):  at android.widget.AdapterView.performItemClick(AdapterView.java:284)
11-20 19:25:19.027: E/AndroidRuntime(505):  at android.widget.ListView.performItemClick(ListView.java:3513)
11-20 19:25:19.027: E/AndroidRuntime(505):  at android.widget.AbsListView$PerformClick.run(AbsListView.java:1812)
11-20 19:25:19.027: E/AndroidRuntime(505):  at android.os.Handler.handleCallback(Handler.java:587)
11-20 19:25:19.027: E/AndroidRuntime(505):  at android.os.Handler.dispatchMessage(Handler.java:92)
11-20 19:25:19.027: E/AndroidRuntime(505):  at android.os.Looper.loop(Looper.java:123)
11-20 19:25:19.027: E/AndroidRuntime(505):  at android.app.ActivityThread.main(ActivityThread.java:3683)
11-20 19:25:19.027: E/AndroidRuntime(505):  at java.lang.reflect.Method.invokeNative(Native Method)
11-20 19:25:19.027: E/AndroidRuntime(505):  at java.lang.reflect.Method.invoke(Method.java:507)
11-20 19:25:19.027: E/AndroidRuntime(505):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
11-20 19:25:19.027: E/AndroidRuntime(505):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
11-20 19:25:19.027: E/AndroidRuntime(505):  at dalvik.system.NativeStart.main(Native Method) 
```

在我阅读描述后，我认为 Uri 可能为空，因为：

如果 uriString 为空，则抛出 NullPointerException

但为什么它为空？我不知道...

编辑：教程的链接是错误的......但现在我找到了正确的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:34:11.367

LogCat 中的重要信息是：

```
java.lang.IndexOutOfBoundsException: Invalid index 2, size is 0 
```

这意味着您的`links`列表为*空*，然后：

```
 at java.util.ArrayList.throwIndexOutOfBoundsException(ArrayList.java:257)
    at java.util.ArrayList.get(ArrayList.java:311)
    at com.rss_reader.MainActivity.onListItemClick(MainActivity.java:111) 
```

您可以看到您尝试在第 111 行的方法中从`links`（不存在的）读取值，正如您在上面所说的：`onListItemClick()`

```
Uri uri = Uri.parse((String) links.get(position)); 
```

您**必须**在某些时候将数据添加到您的`links`列表`links.add()`中......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:32:39.563

你的罪魁祸首在这里：

```
com.rss_reader.MainActivity.onListItemClick(MainActivity.java:111) 
```

在 MainActivity.java 的第 111 行

**编辑**

那么这意味着你到达了你的数据之外，或者更准确地说

```
java.lang.IndexOutOfBoundsException: Invalid index 2, size is 0 
```

`links`当您尝试从中获取第三个元素时，您是空的，因此 IndexOutOfBounds 异常。检查为什么`links`未正确初始化或进行一些其他检查以确保您`position`的设置适合​​环境。

# amazon-s3 - 如何将文件从远程服务器传输到我的 Amazon S3 实例？

> ID：13480433
> 
> 赞同：3
> 
> 时间：2012-11-20T19:14:56.053
> 
> 标签：amazon-s3, amazon

我在 5 个文件中有大约 15 GB 的数据需要传输到 Amazon S3 存储桶，它们目前托管在我没有脚本或 shell 访问权限的远程服务器上 - 我只能通过 httpd 链接下载它们。

如何将这些文件传输到我的 Amazon S3 存储桶，而无需先将它们下载到我的本地计算机然后将它们重新上传到 S3？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-17T02:00:35.067

如果您想自动化该过程，请使用 AWS 开发工具包。

就像在以下情况下使用 AWS PHP SDK：

```
use Aws\Common\Aws;

$aws = Aws::factory('/path/to/your/config.php');
$s3 = $aws->get('S3');

$s3->putObject(array(
    'Bucket'     => 'your-bucket-name',
    'Key'        => 'your-object-key',
    'SourceFile' => '/path/to/your/file.ext'
)); 
```

更多细节：

[http://blogs.aws.amazon.com/php/post/Tx9BDFNDYYU4VF/Transferring-Files-To-and-From-Amazon-S3](http://blogs.aws.amazon.com/php/post/Tx9BDFNDYYU4VF/Transferring-Files-To-and-From-Amazon-S3) [http://docs.aws.amazon.com/aws-sdk-php/guide /latest/service-s3.html](http://docs.aws.amazon.com/aws-sdk-php/guide/latest/service-s3.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-04T17:01:44.770

鉴于您只有 5 个文件，请在将文件下载到某个中间层后使用 S3 文件上传器[http://console.aws.amazon.com/s3/home?region=us-east-1](http://console.aws.amazon.com/s3/home?region=us-east-1) （操作，上传）机器。运行 Windows 的 EC2 可能是最佳解决方案，因为上传到 S3 会非常快。您可以从 chrome.google.com 将 Chrome 下载到您的 EC2 实例，或使用现有的 Web 浏览器 (IE) 来完成这项工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-18T12:12:05.050

**[1] 带密钥的 SSH**

```
 sh-keygen -f ~/.ssh/id_rsa -q -P ""
    cat ~/.ssh/id_rsa.pub 
```

将此 SSH 密钥放入您的 ~/.ssh/authorized_keys 文件中

```
 mkdir ~/.ssh 
    chmod 0700 ~/.ssh
    touch ~/.ssh/authorized_keys
    chmod 0644 ~/.ssh/authorized_keys 
```

**[2] 快照 ZFS，使用 LZMA 最小化传输，使用 RSYNC 发送**

```
 zfs snapshot zroot@150404-SNAPSHOT-ZROOT
    zfs list -t snapshot 
```

用 lzma 压缩成文件（比 bzip2 更有效）

```
 zfs send zroot@150404-SNAPSHOT-ZROOT | lzma -9 > /tmp/snapshots/zroot@150404-SNAPSHOT-ZROOT.lzma
    rsync -avz -e "ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null" --progress --partial /tmp/snapshots/zroot@150404-SNAPSHOT-ZROOT.lzma <username>@<ip-address>:/ 
```

**[3] Speedup transfer with MBUFFER, send with ZFS Send/Recieve** 先启动接收器。这监听端口 9090，有 1GB 缓冲区，使用 128kb 块（与 zfs 相同）：

```
 mbuffer -s 128k -m 1G -I 9090 | zfs receive zremote 
```

现在我们发送数据，也通过 mbuffer 发送：

```
 zfs send -i zroot@150404-SNAPSHOT-ZROOT zremote@150404-SNAPSHOT-ZROOT | mbuffer -s 128k -m 1G -O <ip-address>:9090 
```

**[4] 只发送 diff 加速传输**

```
 zfs snapshot zroot@150404-SNAPSHOT-ZROOT
    zfs snapshot zroot@150405-SNAPSHOT-ZROOT [e.g. one day later]
    zfs send -i zroot@150404-SNAPSHOT-ZROOT zroot@150405-SNAPSHOT-ZROOT | zfs receive zremote/data 
```

另见[我的笔记](http://www.blaeu.com/nl/doku.php/Notes)

# ruby-on-rails-3 - 链接到具有自动 belongs_to 关系的新记录？

> ID：13480453
> 
> 赞同：0
> 
> 时间：2012-11-20T19:16:19.943
> 
> 标签：ruby-on-rails-3, model, relationship, belongs-to

在我的 Rails 3 应用程序中，我有一个简单的模型关系，如下所示：

**动物模型**

```
has_many :claims 
```

**索赔模型**

```
belongs_to :animal
has_many :payments 
```

**支付模式**

```
belongs_to :claim 
```

索赔表有一个名为 animal_id 的列，支付表有一个名为 claim_id 的列。

我可以成功列出索赔拥有的所有付款。

我想要做的是在动物展示视图中添加一个链接，该链接创建一个新的声明，其中已经设置了 animal_id，并且与新支付链接的声明显示视图相同。

根据我的阅读，您可以使用控制器和操作集手动创建 link_to，如下所示：

**声明显示视图**

```
<%= link_to 'Create a Payment', {:controller => "payments", :action => "new", :claim_id => '@claim.id'} %> 
```

这似乎不起作用，尽管它确实正确链接到新的付款页面。

有没有更简单的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T19:58:20.587

在我的脑海中，未经测试，我认为以下方法会起作用：

```
= link_to 'Create Payment', payments_path(:payment=>{:claim_id=>@claim.id}), :method => :post 
```

在 url 助手中添加一个哈希只是将参数放在 url 上，这将由 rails 解释，就像从表单发布的“正常”参数一样。

这相当于提交一个新的支付表单，所以它会以同样的方式重定向。如果您希望通过 ajax 处理它，只需添加`:remote => true`，并确保您的 PaymentsController 上的 create 操作正确响应 javascript。

* * *

更新：再次阅读您的问题，您想要已设置 claim_id 的新付款表格吗？

好的，有很多方法可以做到这一点。如果您将参数传递给新操作，您可以从参数中获取 claim_id，就像我在上面展示的创建记录一样：

```
= link_to 'New Payment', new_payment_path(:claim_id=>@claim.id) 
```

这应该将您链接到 /payments/new?claim_id=123

然后在你的控制器中：

```
def new
  @payment = Payment.new(:claim_id => params[:claim_id])
end 
```

但是，正如评论中指出的那样，更好的方法是将付款嵌套在索赔下：

在您的路线中：

```
resources :claims do
  resources :payments
end 
```

在您的 PaymentsController 中：

```
before_filter :load_claim

def new
  @payment = @claim.payments.build
end

def create
  @payment = @claim.payments.build(params[:payment])
  ...
end

private
def load_claim
  @claim = Claim.find(params[:claim_id])
end 
```

在您的链接中：

```
= link_to 'New Payment', new_claim_payment_path(@claim) 
```

请注意，现在您的付款路径助手将需要其中的声明，即：

```
= link_to 'Payment', claim_payment_path(@claim, payment) 
```

表单助手也是如此：

```
= form_for [@claim, @payment] ... 
```

# ui-automation - 获取/使用完整路径在 UIA 和 White 中查找控件

> ID：13480454
> 
> 赞同：1
> 
> 时间：2012-11-20T19:16:21.410
> 
> 标签：ui-automation, white-framework, microsoft-ui-automation

我正在使用 Microsoft UI 自动化 + White 框架。是否可以从顶级父级获取到控件的**完整路径**，然后使用它来查找元素？例如，使用 UI spy 获取完整路径，然后以某种方式通过获取的路径获取控件？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T20:04:31.227

我使用 MSUIA 的非托管版本并且不使用白色，但是这样的东西应该可以满足您的要求。传入一个元素。

```
 CUIAutomation auto = new CUIAutomation();

        var desktop = auto.GetRootElement();
        var walker = GetRawTreeWalker();
        while (true)
        {
            element = walker.GetParentElement(element);
            if (auto.CompareElements(desktop, element) == 1)
            {
                break;
            }
            winPath = AppendWinPathPart(winPath, element);
        } 
```

AppendWinPathPart 是对一种方法的调用，该方法构建了我在自动化中使用的字符串形式的路径。它很像 MSUIA 的 XPath。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T22:25:16.160

我过去做过一些类似于你正在尝试做的事情。不幸的是，这并不一定那么容易做到。

我基本上构建了自己的 UI Spy 简化版本，它使用了一些类似于上面@chrismead 答案中的代码来构建自动化 ID 的“\”分隔路径（不幸的是，正如您可能已经发现的那样，自动化 ID 可能不可靠，因此，为了稳健起见，我还必须添加通过名称、兄弟姐妹之间的位置或相对于父级的位置等来识别 AutomationElements 的功能）。

然后，我在另一个应用程序中有代码，可以将这些路径作为输入，以便定位那些特定的 AutomationElement 并与它们进行交互。

# php - wordpress 管理员 curl 登录将无法正常工作

> ID：13480460
> 
> 赞同：0
> 
> 时间：2012-11-20T19:16:41.630
> 
> 标签：php, wordpress, curl

我正在尝试通过 curl 访问我的 wordpress 管理部分，但我得到的只是一个空白页面。我究竟做错了什么？这是脚本

```
$username="username";
$password="password";
$url="http://www.socialzend.com";
$cookie="cookie.txt";

$postdata = "log=". $username ."&pwd=". $password ."&wp-submit=Log%20In&redirect_to=". $url ."wp-admin/&testcookie=1";
$ch = curl_init();
curl_setopt ($ch, CURLOPT_URL, $url . "/wp-login.php");
curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
curl_setopt ($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6");
curl_setopt ($ch, CURLOPT_TIMEOUT, 60);
curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt ($ch, CURLOPT_COOKIEJAR, $cookie);
curl_setopt ($ch, CURLOPT_REFERER, $url . "wp-admin/");
curl_setopt ($ch, CURLOPT_POSTFIELDS, $postdata);
curl_setopt ($ch, CURLOPT_POST, 1);
$result = curl_exec ($ch);
curl_close($ch);
echo $result; 
```

# c - 用 C 解析 HTTP 请求

> ID：13480461
> 
> 赞同：-1
> 
> 时间：2012-11-20T19:16:43.400
> 
> 标签：c, regex, http, parsing

我需要在 C 中解析 HTTP 请求。我以前一直在使用 std::regex 进行 C++，但现在我必须使用 C。用 C 解析 HTTP 请求的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:21:11.043

几个项目使用[Ragel](http://www.complang.org/ragel/)，一个状态机生成器，在 C 中实现 HTTP 解析器。它非常适合自动化你需要构建来解析 HTTP 的那种状态机，而没有像 Bison 这样的解析器生成器的复杂性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:40:59.760

Apache 推荐使用 cgic，你可以在[http://www.boutell.com/cgic/](http://www.boutell.com/cgic/)找到它，它使用起来非常简单

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:21:49.417

这（当然）是非常主观的，因为您没有说出要优化的标准。

如果您在 POSIX 领域，您可以继续使用正则表达式，使用起来`[<regex.h>](http://linux.die.net/man/3/regex)`非常容易。当然，您也可以手动构建解析器、使用现有库或使用例如[Bison](http://en.wikipedia.org/wiki/GNU_bison)自行构建。

# erlang - 我可以获得所有当前注册的原子的列表吗？

> ID：13480462
> 
> 赞同：15
> 
> 时间：2012-11-20T19:16:44.187
> 
> 标签：erlang

我的项目已经超过了最大 1M 个原子，我们已经提高了限制，但是我需要对人们提交的关于 list_to_atom 及其朋友的代码进行一些理智的处理。我想首先获取所有已注册原子的列表，这样我就可以看到最大的违规者在哪里。有没有办法做到这一点。我必须对如何做到这一点有创意，所以我最终不会试图在实时控制台中转储 1-2M 行。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2016-01-19T17:31:27.087

您可以使用外部术语格式的未记录功能来获取所有原子。

**TL;DR**：将以下行粘贴到正在运行的节点的 Erlang shell 中。继续阅读以获取解释和代码的非简洁版本。

```
(fun F(N)->try binary_to_term(<<131,75,N:24>>) of A->[A]++F(N+1) catch error:badarg->[]end end)(0). 
```

[Ivar Vong 的](https://mobile.twitter.com/ivarvong/status/1076161644869419008?p=p)Elixir 版本：

```
for i <- 0..:erlang.system_info(:atom_count)-1, do: :erlang.binary_to_term(<<131,75,i::24>>) 
```

* * *

以外部术语格式编码的 Erlang 术语以字节 131 开头，然后是标识类型的字节，然后是实际数据。我发现[EEP-43](http://www.erlang.org/eeps/eep-0043.html)提到了所有可能的类型，包括类型 byte 75，[在外部术语格式的官方文档中](http://www.erlang.org/doc/apps/erts/erl_ext_dist.html)`ATOM_INTERNAL_REF3`没有提到。

对于`ATOM_INTERNAL_REF3`，数据是原子表的索引，编码为 24 位整数。我们可以轻松创建这样的二进制文件：`<<131,75,N:24>>`

例如，在我的 Erlang VM 中，`false`似乎是原子表中的第零个原子：

```
> binary_to_term(<<131,75,0:24>>).
false 
```

没有简单的方法可以找到当前原子表^*中的原子数量，但我们可以不断增加数量，直到出现`badarg`错误。

所以这个小模块给你一个所有原子的列表：

```
-module(all_atoms).

-export([all_atoms/0]).

atom_by_number(N) ->
    binary_to_term(<<131,75,N:24>>).

all_atoms() ->
    atoms_starting_at(0).

atoms_starting_at(N) ->
    try atom_by_number(N) of
        Atom ->
            [Atom] ++ atoms_starting_at(N + 1)
    catch
        error:badarg ->
            []
    end. 
```

输出如下所示：

```
> all_atoms:all_atoms().
[false,true,'_',nonode@nohost,'$end_of_table','','fun',
 infinity,timeout,normal,call,return,throw,error,exit,
 undefined,nocatch,undefined_function,undefined_lambda,
 'DOWN','UP','EXIT',aborted,abs_path,absoluteURI,ac,accessor,
 active,all|...]
> length(v(-1)).
9821 
```

* * *

^*在 Erlang/OTP 20.0 中，您可以调用`erlang:system_info(atom_count)`：

```
> length(all_atoms:all_atoms()) == erlang:system_info(atom_count).
true 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-20T21:35:25.007

我不确定是否有办法在实时系统上执行此操作，但如果您可以在测试环境中运行它，您应该能够通过故障转储获取列表。原子表接近[故障转储格式](http://erlang.org/doc/apps/erts/crash_dump.html#id77867)的末尾。[您可以通过erlang:halt/1](http://erlang.org/doc/man/erlang.html#halt-1)创建故障转储，但这会导致整个运行时系统崩溃。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-21T18:32:45.777

我敢说，如果你使用超过 100 万个原子，那么你做错了什么。一旦应用程序运行，Atoms 就应该是静态的，或者至少以一些小的数字为上限，对于中型应用程序来说是 3000 左右。

当敌人可以在你的虚拟机中生成原子时要非常小心。特别是像 list_to_atom/1 这样的调用有点危险。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T22:11:54.673

已编辑（错误答案..）

您可以调整原子数`+t`

[http://www.erlang.org/doc/efficiency_guide/advanced.html](http://www.erlang.org/doc/efficiency_guide/advanced.html)

..但我知道很少有必要的用例。

您可以使用以下命令跟踪原子统计信息`erlang:memory()`

# mysql - mysql datetime 中 UTC 时间的不正确表示

> ID：13480463
> 
> 赞同：0
> 
> 时间：2012-11-20T19:16:52.683
> 
> 标签：mysql, datetime, utc

所以我有这个应用程序可以接收来自手机的包裹，包括 UTC 的 gps 时间。我目前从 php 将其存储在我的 mysql 数据库中。

我有两个日期时间字段，一个包含电话时间，另一个是服务器时间。

我的查询如下所示： INSERT INTO GeoLocation(Time, ServerTime) VALUES(FROM_UNIXTIME(1353438497), UTC_TIMESTAMP())

我简化并删除了所有其他值。当前的 UTC unix 时间戳现在是：1353438597 与[http://www.unixtimestamp.com/index.php](http://www.unixtimestamp.com/index.php)一致，所以我的其他手机时间戳是 100 秒，非常有意义。

但是现在有趣的事情。我应该提到我住在瑞典，时区为+1，服务器在瑞典，很可能配置为瑞典时间

当我使用 phpmyadmin 查看刚刚插入的值时，它说时间是 2012-11-20 20:08:17 但服务器时间是 2012-11-20 19:08:23。因此，即使两者都是正确的 utc 时间，一个输入 ass From_unixtime，另一个输入 UTC_TIMESTAMP，它们现在显示不同的时间。

我读到您需要使用 SET time_zone = '+00:00'; 设置时区；

所以我尝试在 phpmyadmin 中打开一个查询窗口并输入

```
SET time_zone = '+00:00';
SELECT Time, ServerTime FROM `GeoLocation` WHERE 1; 
```

但我仍然得到两个领域报告的完全相同的时间。

但是 phpmyadmin 确实运行了这两行，因为如果我改为尝试这个：

```
SELECT @ @global.time_zone , @ @session.time_zone 
```

我明白了：

@@global.time_zone @@session.time_zone

系统系统

但如果我这样做：

```
SET time_zone = '+00:00';
SELECT @@global.time_zone, @@session.time_zone 
```

我明白了：

@@global.time_zone @@session.time_zone

系统 +00:00

所以这对我来说没有任何意义，我已经确认我提供了 UTC 时间（从 unix 时间开始），但它显示为 UTC+1 并且它无助于设置时区。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T10:09:39.080

解决方法是执行“SET time_zone = '+00:00';” 在数据库中存储数据之前（插入）。

读取数据时它对您没有好处，但是如果您在存储数据时调用它，一切都会好起来的。

# opencv - Freeman 链 - cvApproxChains (openCV) - 示例

> ID：13480464
> 
> 赞同：0
> 
> 时间：2012-11-20T19:16:58.080
> 
> 标签：opencv

每个人

我是opencv的新手，我遇到了弗里曼链-cvApproxChains算法

已经搜索了一些关于如何使用该方法（cvApproxChains）但无效的归纳代码

希望有人已经实施了这样的方法，并准备分享他的知识+辛勤工作

在此先感谢希望尽快得到答复

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-27T09:20:19.120

以下是一些入门示例代码：

```
{
    string inputFile = "path/to/your/file.bmp";
    // Create Memory Storage
    CvMemStorage *storage = cvCreateMemStorage(0);

    //Load image from disk
    IplImage *img = cvLoadImage(inputFile.c_str(),0);

    //Create contour chains
    CvSeq *seq = 0;
    cvFindContours(img, storage, &seq, sizeof(CvContour),
        CV_RETR_TREE, CV_CHAIN_CODE, cvPoint(0,0) );

    //Create approximated Freeman chains
    seq = cvApproxChains(seq, storage, CV_CHAIN_APPROX_SIMPLE,0,0,0);
    printf("total: %i\n",seq->total);
} 
```

希望能帮助到你

# php - 如何将变量从 PHP 传递到 JS，对变量执行数学运算然后输出到页面元素

> ID：13480465
> 
> 赞同：2
> 
> 时间：2012-11-20T19:17:11.007
> 
> 标签：php, javascript

> **可能重复：**
> [如何从 JavaScript 中访问 PHP 变量？](https://stackoverflow.com/questions/7705921/how-to-access-php-variables-from-within-javascript)

我试图将一个变量从 mySQL 传递给 PHP，然后传递给 JavaScript 以对其执行一些数学运算，然后将结果显示在特定区域的页面上（在`<p>`分配给它的特定 ID 的元素中）。这是可能的还是有更简单的解决方案？

谢谢！

我已经知道如何将变量从 MySQL 获取到 PHP，只是不知道之后该怎么做。

这是我阅读回复后更新的代码。仍然无法正常工作，但我确定我做错了什么！

```
<p id="p_id"><?php echo $price; ?></p>
<input type="radio" group="radio_group" value="Reduce 10%" onclick="radio_click();" />

<script type="text/javascript">
var price = <?php echo $price; ?>;

function radio_click() {
var target = document.GetElementById('p_id');
var final_number; // this will be variable your store the final number in

final_number = price * .9;
target.innerHTML = final_number;

}
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:20:33.847

简而言之，您必须将变量`<script>`作为 JavaScript 友好格式（引号和其他内容）的字符串传递给标记。

```
<?php

$variable = 5;
$javaScriptAccessible = '
    <script type="text/javascript">
        var javaScriptAccessible = "'. $variable . '";
    </script>
';

echo $javaScriptAccesible; 
```

此外，你可以 JSON 它：

```
<?php

$variable = 5;
$javaScriptAccessible = '
    <script type="text/javascript">
        var javaScriptAccessible = '. json_encode($variable) .';
    </script>
';

echo $javaScriptAccessible; 
```

使用 JSON，引号将自动附加。

在这里您可以看到两者的实际效果：[http ://codepad.viper-7.com/Jyfw31](http://codepad.viper-7.com/Jyfw31)

## 更新：

这里有更精致，我认为更好理解的例子：[http://codepad.viper-7.com/1cloyB](http://codepad.viper-7.com/1cloyB)
你唯一要做的就是在你的`radio`按钮/元素上使用它。

我强烈建议使用 JSON，因为它实际上代表[JavaScript Object Notation](http://en.wikipedia.org/wiki/JSON)，它可能包含地球上每一种编程语言中的库，并且专门设计用于将 JS 数据从一个环境传递到另一个环境。

[http://php.net/manual/en/function.json-encode.php](http://php.net/manual/en/function.json-encode.php)在这里您可以看到您可以传递的多个选项，以便以不同的方式呈现它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:20:26.217

要将数据从 PHP 传递到 JavaScript，只需`echo`它。例如，假设您想在消息框中显示数据：

```
$data="something";
echo "<script>";
// Do the maths
echo 'var = ' . $data . ' + 1';
echo 'document.write("<p id=\"someID\">" + var + "</p>");' // PHP code writing Javascript code to write HTML code. Wow.
echo "</script>"; 
```

如果要在单击单选按钮时显示数据：

```
<input type="radio" onClick="someFunction();">
<?php
echo "<script>function someFunction() {";
// Do the maths
echo 'var = ' . $data . ' + 1';
echo 'document.write("<p id=\"someID\">" + var + "</p>");' // PHP code writing Javascript code to write HTML code. Wow.
echo "}</script>";
?> 
```

***编辑**：如果`<p>`标签已经存在，使用`document.GetElementById(\"someID\").innerHTML = var;`而不是`document.write("<p id=\"someID\">" + var + "</p>");`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:27:17.710

只需将 PHP 中的变量输出到`<script>`项目中。`<p>`然后根据您的计算设置您的 innerHTML 属性。您可以将其放入一个函数中，然后从单选按钮的 onclick 中调用它。

```
<p id="p_id"><!-- Your value will be inserted here --></p>
<input type="radio" group="radio_group" value="some_value" onclick="radio_click();" />

<script type="text/javascript">
var your_number = <?php echo $php_number; ?>;

function radio_click() {
    var target = document.GetElementById('p_id');
    var final_number; // this will be variable your store the final number in

    // do your math here using your_number variable

    target.innerHTML = final_number;

}
</script> 
```

# java - 断字预处理

> ID：13480480
> 
> 赞同：4
> 
> 时间：2012-11-20T19:18:18.840
> 
> 标签：java, php, preprocessor, hyphenation

我需要一些关于 PHP 和/或 java（目前是 Spring + Hibernate）中的工具的线索，以用于内容的连字符。我在包含的文件中有一些文本内容，在数据库中有一些。所有文本都是 utf-8 编码的，我需要软连字符，因为对它的支持在大多数浏览器中都很常见。

所以这个存储的原件：

```
<p> These words need hyphenation</p> 
```

会出现这样的事情

```
<p> The&shy;se wor&shy;ds need hyp&shy;he&shy;na&shy;tion</p> 
```

在最终加载的网页的源代码中。

任何想法如何实现这一目标？

在没有使用任何服务器端代码且只有纯 HTML 源文件的情况下，也欢迎在 HTML 标记中包含连字符的文本编辑工具的建议。

此外，我还没有找到断字词列表的好来源。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-31T09:56:37.537

CSS3 定义了[客户端连字符](http://www.w3.org/TR/css3-text/#hyphens)。

这意味着在支持浏览器时¹，您只需要指定文本的语言和您对自动断字的渴望，它将自动断字，无需您做任何工作。显然，这意味着连字符点由浏览器的语言资源控制。

对于手动控制，您可以在您希望使用的每个连字符点放置任意连字符，并指示浏览器仅使用这些连字符。

在实践中，要找到断字点并插入任意连字符，最好的方法可能是使用古老的[TeX 风格的断字方法](http://tug.org/docs/liang/)，其中指定分层断字或无断字点的子词模式与要断字的单词匹配。这些模式现在被广泛使用（包括 OpenOffice、LibreOffice 和 Adob​​e InDesign），并且可用于大多数语言。

实现该算法只需要几行代码。更重要的是，有多种语言的现成实现：PHP 实现，如[phpHyphenator](http://phphyphenator.yellowgreen.de/)，Java 实现，如[TeXHyphenator-J](http://www.davidashen.net/texhyphj.html)或[连字符](https://bitbucket.org/feuervogel/hyphenation/src)，以及用于 libhyphen 的 C++ 实现的 Java 绑定，如[jhyphen](https://github.com/sbsdev/jhyphen)。

¹ 目前，Firefox、Safari 和 IE 支持自动连字符，Chrome 和 Opera 不支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:48:10.677

断字实际上是非常困难的。那里真的没有任何单词列表。如果您使用 PHP，您可以制作[Perl 库 TeX::Hyphen](http://search.cpan.org/~janpaz/TeX-Hyphen-1.01/lib/TeX/Hyphen.pm)。我不知道任何 Java 解决方案。

有关更多信息，[请阅读此 Wikipedia 文章。](http://en.wikipedia.org/wiki/Hyphenation_algorithm)

# spring - KISS & 设计模式

> ID：13480484
> 
> 赞同：2
> 
> 时间：2012-11-20T19:18:59.027
> 
> 标签：spring, design-patterns, yagni

我需要重写旧的遗留桌面应用程序。它是一个小型的非 Java 桌面程序，仍然支持多个内部用户社区的日常任务。

应用程序已过时且不再受支持的语言。我是初级开发人员，我需要重写它。为了避免[应用程序重写陷坑](http://www.joelonsoftware.com/articles/fog0000000069.html)，我计划开始使用现有的数据库和数据结构（有一些重大限制，但与重构一样痛苦，这种方法将更快地完成初始工作，并且避免迁移，这两者都是成功的关键）。

我的挑战是我对保持简单的概念非常矛盾。我知道这是在谈论功能，而不是设计。但是当我打算编写这个应用程序时，似乎在坚持良好（但非“四人组”）的情况下，可能会花费大量时间来追踪设计模式（特别是我真的在依赖注入方面苦苦挣扎）设计可以更快、更简单地完成工作。

这个应用程序会成长并存在很长时间，但它永远不会成为一个拥有 400 万行的企业庞然大物，并且它的对象不会被另一个应用程序使用（是的，我知道，但是如果......YAGNI ！）。

**问题**

KISS 是否适用于建筑和设计？“稍后重构”规则是否可以扩展到说，例如，“我们稍后会回来进行依赖注入”，或者如果项目没有融入所有所谓的关键，那么项目是否注定要失败立即支持框架？

我想“正确”地做到这一点......但它也必须完成。如果我让它太复杂而无法完成，无论设计如何，它都会失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:35:57.317

我想说 KISS 当然适用于建筑和设计。

在我的经验中，过度架构是一个常见的问题，并且有一种相关的代码异味：

[人为的复杂性](http://en.wikipedia.org/wiki/Code_smell)

> 强制使用过于复杂的设计模式，而简单的设计就足够了。

如果使用更高级的设计模式、范式或架构不适合您的项目规模，请不要强求。

您必须权衡架构的潜在成本与潜在的节省......但还要考虑早日实施它所节省的额外时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:44:08.183

是的，KISS，但请参阅[http://www.amazon.com/Refactoring-Patterns-Joshua-Kerievsky/dp/0321213351并考虑以小](https://rads.stackoverflow.com/amzn/click/com/0321213351)*步骤*重构设计模式。代码应该有点告诉你该怎么做。

# android - 服务/活动之间的消息

> ID：13480487
> 
> 赞同：-4
> 
> 时间：2012-11-20T19:19:03.850
> 
> 标签：android

很抱歉问了这么一个基本问题，我对 Java 有一点了解，但现在我只是在尝试 Android。我只是想知道是否有一种简单的方法可以在 Android 中的 Activity 和 Services 之间发送消息。我看过这个人的实现：

[示例：使用消息传递在 Activity 和 Service 之间进行通信](https://stackoverflow.com/questions/4300291/example-communication-between-activity-and-service-using-messaging)

但这似乎仍然有点冗长，并且特定于他的设计，应用程序需求。我有服务正在运行并绑定到 Activity，但是当涉及到实际使用 Message.obtain() 方法时，我不确定我应该作为参数传递什么，我什至不明白这个过程是如何发送消息实际上是有效的。Android是否提供了其他任何简单的方法来在两者之间发送消息？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T20:05:28.740

API 指南提供了有关如何[将服务绑定到应用程序并通过消息与它们交互的信息](http://developer.android.com/guide/components/bound-services.html#Messenger)。如链接章节末尾所述，SDK 包含如何实现它的简单示例。

# apache-pig - 如何在 Pig UDF 的 exec 函数中获取输入模式

> ID：13480488
> 
> 赞同：4
> 
> 时间：2012-11-20T19:19:06.010
> 
> 标签：apache-pig, udf

我想知道当我在 Piglatin 中构建 UDF 时如何在 exec() 函数中获取输入模式。我可以从 outputSchema() 函数获取模式，但看起来后端函数无法利用结果。

任何提示将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-15T06:57:03.067

据我所知，Pig 的 UDF (EvalFunc) 中有一个 getInputSchema 方法。你试过了吗？

[https://pig.apache.org/docs/r0.11.1/api/org/apache/pig/EvalFunc.html](https://pig.apache.org/docs/r0.11.1/api/org/apache/pig/EvalFunc.html)

# python - 从 Python 提示符运行 Python 脚本，以便将变量加载到交互式环境中

> ID：13480490
> 
> 赞同：2
> 
> 时间：2012-11-20T19:19:09.753
> 
> 标签：python

假设我有一个（有点毫无意义的）Python 脚本

```
#!/usr/bin/python

a = 5 
```

有没有办法从交互式提示符运行这个脚本，这样运行后如果我输入`a`我得到

```
>>> a
5 
```

并不是

```
>>> a
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'a' is not defined 
```

更一般地说，如果我的脚本通过一系列步骤计算某些内容，是否有办法在脚本完成后访问该内容（以相同的方式）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T19:20:05.953

导入它：

```
from yourscriptname import a 
```

python中的每个`.py`文件都是一个模块，您可以简单地导入它。如果文件被调用`foo.py`，则导入`foo`.

# php - 在 URL 中编码和存储多个变量

> ID：13480491
> 
> 赞同：2
> 
> 时间：2012-11-20T19:19:16.337
> 
> 标签：php, url, variables, encode

我知道这是可能的，我在许多网站上进行了研究，但没有找到任何可以完全满足我需要的东西。

我需要在 URL 中编码和存储两个参数，然后使用 $_GET 方法检索它。

参数不是敏感数据。我的目的主要是混淆它，所以访问者在没有网站访问的情况下无法阅读它。

我有这样的事情：

**site.com/?name=john&food=banana%20split**

我需要它变成这样：

**site.com/g57HT90dw8lC5p**

我怎样才能做到这一点？谢谢。

（对不起，我的英语不好）

**编辑：**我应该多解释一下。

1.  我知道我将不得不使用 mod_rewrite 并且我已经涵盖了那部分；
2.  第二个参数是一个完整的句子（带有空格、标点符号等）；
3.  我需要这个来创建圣诞贺卡，所以这些参数都不需要安全方法。我真正需要存储的只是一个**名称**和一个简单的**消息**。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T19:23:12.813

这是错误的方法 - 你说它不敏感，所以你最好修复你的代码，如果有人向你发送精心制作的数据，它就不会被黑客入侵。混淆可以防止普通用户进行更改，但没有技术人员会被此愚弄。此外，许多浏览器的 GET 是有限的（因此可以配置 PHP 和服务器），因此这可能会比您想要的更快地碰壁。但是如果你坚持你想要这种方法，你可以将所有变量放入 json_array，然后使用 base64 进行编码。

```
$myData = array('foo'=>1, 'bar'=>'hax0r');
$arg = base64_encode( json_encode($myData) );

http://site.com/secret=$arg 
```

然后回来：

```
$myData = json_decode( base64_decode( $_GET['secret'] ) ); 
```

但同样 - 这在设计上是错误的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:22:04.237

将两个字符串值附加在一起；然后使用一些编码函数，如[str_rot13](http://php.net/manual/en/function.str-rot13.php)或其他

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T19:23:27.643

你可以对它进行[uuencode](http://php.net/manual/en/function.convert-uuencode.php)。

创建时

```
$converted = convert_uuencode('?name=john&food=banana');
// 6/VYA;64]:F]H;B9F;V]D/6)A;F%N80`` 
```

并在解码

```
$query = $_SERVER['QUERY_STRING'];
// 6/VYA;64]:F]H;B9F;V]D/6)A;F%N80``
$real = convert_uudecode($query);
// ?name=john&food=banana 
```

uuencoding 的目的是使数据对网络传输安全。它不提供保护，但会使它们成为明文以外的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-28T20:42:22.620

试试这些 PHP 函数[convert_uuencode](http://www.php.net/manual/en/function.convert-uuencode.php)和[convert_uudecode](http://www.php.net/manual/en/function.convert-uudecode.php)

**它比只使用 base64 安全得多**

```
function encrypt_decrypt ($data, $encrypt) {
    if ($encrypt == true) {
        $output = base64_encode (convert_uuencode ($data));
    } else {
        $output = convert_uudecode (base64_decode ($data));
    }
    return $output;
}

$enc_txt = encrypt_decrypt ("name=john&food=banana%20split", true);
echo $enc_txt."\n";
// PTtGJU05M1VKO1ZBTilGOU87VjBdOEYlTjg2WUEpMyhQPFchTDo3MGAKYAo=
echo encrypt_decrypt ($enc_txt, false);
// name=john&food=banana%20split 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T19:23:40.750

查看 PHP 文档[Base64Encode](http://www.php.net/manual/en/function.base64-encode.php)。只需对字符串进行编码，并在读取查询时对其进行解码。

# intellij-idea - 是否可以在 IntelliJ IDEA 中一次查看多个查找操作的结果？

> ID：13480493
> 
> 赞同：20
> 
> 时间：2012-11-20T19:19:26.987
> 
> 标签：intellij-idea

在 Eclipse 中，可以浏览一堆以前的搜索结果。在IDEA中似乎只能有一组搜索结果，如果我想做另一组，我注定会输掉第一组。有没有解决的办法？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-20T19:29:43.053

如果您使用“在路径中查找”方法进行搜索（在 Windows 上为 CRTL + shift + F），那么您将在对话框中看到右下角附近标有“在新选项卡中打开”的复选框。选中该复选框允许您在各自的选项卡中拥有多个搜索结果。

# ruby - Carrierwave + MiniMagick - 如何将动画 GIF 压缩到第一帧？

> ID：13480499
> 
> 赞同：6
> 
> 时间：2012-11-20T19:19:45.523
> 
> 标签：ruby, imagemagick, carrierwave, minimagick

有人知道如何使用 Carrierwave + MiniMagick 将动画 GIF 压缩到第一帧吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-08-22T17:47:52.203

我认为 MiniMagick 发生了一些变化，因为我只花了三个小时试图找出为什么 Andrey 的代码不适合我。

我收到以下错误：

```
ActiveRecord::RecordInvalid (Validation failed: 
Image Failed to manipulate with MiniMagick, maybe it is not an image? 
Original Error: Command 
("mogrify -scene /var/folders/0o/0oqNck+++TI/-Tmp-/mini_magick2022-499-15zc.gif") 
failed: {:status_code=>1, :output=>"mogrify: invalid argument for option 
`/var/folders/0o/0oqNck+++TI/-Tmp-/mini_magick2022-499-15zc.gif': -scene 
@ error/mogrify.c/MogrifyImageCommand/5558.\n"}) 
```

最后我发现 MiniMagick::Image 有方法`collapse!`（在这里找到：[http ://www.ruby-doc.org/gems/docs/j/jf--mini_magick-3.1/MiniMagick/Image.html#method-i- collapse-21](http://www.ruby-doc.org/gems/docs/j/jf--mini_magick-3.1/MiniMagick/Image.html#method-i-collapse-21)）解决了这个问题：

```
process :remove_animation

def remove_animation
  manipulate! do |img|
    if img.mime_type.match /gif/
      img.collapse!
    end
    img
  end
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-06T11:24:01.130

它对我有用：

```
def only_first_frame
    manipulate! do |img|
      if img.mime_type.match /gif/
        if img.scene == 0
          img = img.cur_image #Magick::ImageList.new( img.base_filename )[0]
          else
            img = nil # avoid concat all frames
        end
      end
      img
    end
  end 
```

然后你必须调用：

```
process :only_first_frame 
```

# php - 使用 PHPExcel 从 excel 文件中读取日期

> ID：13480501
> 
> 赞同：1
> 
> 时间：2012-11-20T19:19:54.587
> 
> 标签：php, phpexcel

当我尝试将 Excel 文件读取到 PHP 时出现问题。我现在使用的是 PHPExcel 1.7.7 版本。

这是 excel 2007 文件中的一个示例（A 列是名称，B 列是日期）

```
吉姆 2010 年 9 月 17 日
戈登 1979 年 6 月 4 日
1987 年 3 月 24 日法案
史蒂夫 1991 年 5 月 24 日
罗宾 1964 年 8 月 8 日

```

我使用此代码读取姓名和生日：

```
include 'PHPExcel/IOFactory.php';
$inputFileName = 'example.xls';

echo 'Loading file ',pathinfo($inputFileName,PATHINFO_BASENAME),' using IOFactory to identify the format
';
$objPHPExcel = PHPExcel_IOFactory::load($inputFileName);

$sheetData = $objPHPExcel->getActiveSheet()->toArray(null,true,true,true);

foreach ($sheetData as $row) {
echo $row['A'];
echo date_format(date_create_from_format('m-d-y', $row['B']), 'Y-m-d');
} 
```

最后它会打印出这样的东西

```
吉姆 2010-09-17
戈登 1979-06-04
法案 1987-03-24
史蒂夫 1991-05-24
罗宾 2064-08-08

```

我如何改变最后一部分，所以年份是 1964 年？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:22:36.003

从未使用过该功能，但通过检查 php.net 上的文档，我认为您可以更改此行：

```
echo date_format(date_create_from_format('m-d-y', $row['B']), 'Y-m-d'); 
```

至：

```
echo date_format(date_create_from_format('m-d-Y', $row['B']), 'Y-m-d'); 
```

参考： [http ://www.php.net/manual/en/datetime.createfromformat.php](http://www.php.net/manual/en/datetime.createfromformat.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:21:53.177

尝试这个：

```
echo date_format(date_create_from_format('m-d-y', $row['B']), 'Y'); 
```

# objective-c - Objective c - 向 UIView 动画方法添加线程导致仅运行一个动画

> ID：13480503
> 
> 赞同：1
> 
> 时间：2012-11-20T19:20:05.857
> 
> 标签：objective-c, multithreading, animation

我编写了一个方法 sortAndSlideHandCards()，它可以移动 6 个 UIButton。每个 UIButton 都移动到相同的位置。这是通过 for-each 循环和在每个 UIButton 上调用的 animateWithDuration 方法来完成的。

同时为多个玩家调用此方法。目前，该行为会导致每个玩家的 UIButtons 移动，但一次只能移动一个。任何时候都不能移动超过一个 UIButton，就好像每个动画都在等待当前正在运行的任何动画停止，然后再尝试它自己的动画，本质上，每个播放器/UIButton 的代码都是按顺序执行的。我希望线程能帮助我解决这个问题。

当我添加线程代码时：

```
backgroundQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);     
sortAndSlideHandCardsGroup = dispatch_group_create();

for(Player* player in _playersArray) {

    dispatch_group_async(sortAndSlideHandCardsGroup, backgroundQueue, ^(void) {
        [player sortAndSlideHandCards];
    });    

    dispatch_group_wait(sortAndSlideHandCardsGroup,DISPATCH_TIME_FOREVER); 
```

我发现每个玩家只触发了第一个 UIButton 动画，并且代码在运行循环“while”中被阻止，因为“_animationEnd”永远不会被设置，因为看起来第二个动画永远不会开始。

我可以看到该方法在自己的线程中启动

```
- (void) sortAndSlideHandCards  {

NSLog(@"PLAYER:sortAndSlideHandCards");

CGPoint newCenter;
Card* tempCard = nil;
int count = 1;

float duration = 0.2 / _speedMultiplyer;
NSRunLoop *runLoop = [NSRunLoop currentRunLoop];
for(Card *card in _handCards) { //move cards in hand to one postion in hand

    if(count == 1) {
        tempCard = [[Card alloc] init:_screenWidth:_screenHeight :[card getNumber] :[card getCardWeight] :[card getSuit] :[card getIsSpecial]];
        [tempCard setImageSrc: _playerNumber :!_isPlayerOnPhone :count : true :_view: _isAI: [_handCards count]];
        newCenter = [tempCard getButton].center;
    }

    _animationStillRunning = true;
    if(![[DealViewController getCardsInPlayArray] containsObject:card] ) {

        [UIView animateWithDuration:duration delay:0 options:UIViewAnimationOptionLayoutSubviews animations:^{[card getButton].center = newCenter;} completion:^(BOOL finished){[self animationEnd];}];            
        while (_animationStillRunning){ //endAnimation will set _animationStillRunning to false when called
            //stuck in here after first UIButton when threading code is in play
            [runLoop runMode:NSDefaultRunLoopMode beforeDate:[NSDate dateWithTimeIntervalSinceNow:0.1]];
        } //endAnimation will set _animationStillRunning to false when called

    }

    count++;
} 
```

}

当我注释掉线程代码时，每个 UIButton (Card) 都会一个接一个地设置动画。

随着线程代码的运行，第一个 UIButton 将进行动画处理，但在通过 for 循环的第二次运行期间，代码将卡在 while 循环中，等待动画结束。我猜第二个动画甚至都没有开始。

我也试过这个线程代码：

```
[player performSelectorInBackground:@selector(sortAndSlideHandCards) withObject:nil]; 
```

同样的结果

任何人都知道为什么 animateWithDuration 不喜欢在主线程以外的线程中被循环调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:37:53.367

您应该能够从执行的任何 UI 操作中启动您想要的动画。UIView animateWith... 方法会立即返回，因此您无需担心等待它们完成。

如果您有未知数量的动画要按顺序启动，请使用该`delay`参数。伪代码：

```
NSTimeInterval delay = 0;
NSTimeInterval duration = 0.25;

for (UIView *view in viewsToAnimate)
{
    [UIView animateWithDuration:duration delay:delay animations:^{ ... animations ...}];
    delay += duration;
} 
```

这将增加每个连续动画的延迟，因此它从前一个动画的末尾开始。

# objective-c - 打开 UI webview 时，RestKit 未将 URL 添加到后退列表

> ID：13480506
> 
> 赞同：0
> 
> 时间：2012-11-20T19:20:16.733
> 
> 标签：objective-c, ios, ipad, uiwebview, restkit

所以我遇到的问题是我正在使用 RestKit 来验证自签名证书并同时处理用户登录但是在 webView 打开之后第一页没有被添加到后退列表中（据我所知）。即，在我单击该页面上的链接后，我无法返回上一页。如果我单击另一个链接（3 页），我可以返回到第二页但仍然不是第一页。当我打开 UI Webview 时，有没有办法手动将 URL 添加到后退列表？或者对其他解决方法有什么建议？

```
- (id)initWithURL:(NSURL*)pageURL {

    _retainedURL = pageURL;
    [_retainedURL retain];

    RKClient *client;
    NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
    client = [RKClient clientWithBaseURL: pageURL];
    client.username=[userDefaults objectForKey:@"UserName"];
    client.password=[userDefaults objectForKey:@"Password"];
    client.authenticationType=RKRequestAuthenticationTypeHTTPBasic;
    client.disableCertificateValidation= TRUE;
    //The below "delegate:self seems to be what is preventing the URL from passing into the forwardBack list (works if it is delegate self but then RestKit breaks
    RKRequest *request=[RKRequest requestWithURL:pageURL delegate:self];
    [client configureRequest:request];
    request.authenticationType = RKRequestAuthenticationTypeHTTPBasic;
    request.disableCertificateValidation = TRUE;
    self.authenticatedRequest = request;
    NSLog(@"%@",[request URLRequest]);
    [request sendAsynchronously];

    if(self = [super init]) {
        self.URL = pageURL;
        self.availableActions = SVWebViewControllerAvailableActionsOpenInSafari | SVWebViewControllerAvailableActionsMailLink | SVWebViewControllerAvailableActionsCopyLink;
    }
    return self;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:54:40.957

我最终通过创建一个 NSMutableArray 数组来跟踪浏览器历史记录并添加代码来处理各种事情（例如前进和后退按钮显示）来修复此错误。我使用 2 个整数（urlListIndex 和 urlIndexMax）以及一个 BOOL（backFix）进行导航控制

```
 - (id)initWithURL:(NSURL*)pageURL {

        _retainedURL = pageURL;
        [_retainedURL retain];

        RKClient *client;
        NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
        client = [RKClient clientWithBaseURL: pageURL];
        client.username=[userDefaults objectForKey:@"UserName"];
        client.password=[userDefaults objectForKey:@"Password"];
        client.authenticationType=RKRequestAuthenticationTypeHTTPBasic;
        client.disableCertificateValidation= TRUE;
        RKRequest *request=[RKRequest requestWithURL:pageURL];
        [client configureRequest:request];
        request.delegate = self;
        request.authenticationType = RKRequestAuthenticationTypeHTTPBasic;
        request.disableCertificateValidation = TRUE;
        self.authenticatedRequest = request;
        [request sendAsynchronously];

        //Instantiate urlList (for web history) and urlListIndex 
        urlList = [[NSMutableArray alloc] init];
        urlListIndex = 0;

        if(self = [super init]) {
            self.URL = pageURL;
            self.availableActions = SVWebViewControllerAvailableActionsOpenInSafari | SVWebViewControllerAvailableActionsMailLink | SVWebViewControllerAvailableActionsCopyLink;
        }
          return self;
    }

    - (void)updateToolbarItems {

        //check if you are further than the first page. If so, enable the back button
        if (urlListIndex > 0)
        {
        self.backBarButtonItem.enabled = YES;
        }
        else
        {
        self.backBarButtonItem.enabled = NO;
        }

        //Check if there are more total urls in the list than the one you are on. If so, enable the forward button
        if (urlListIndex < maxListIndex)
        {
        self.forwardBarButtonItem.enabled = YES;
        }
        else
        {
        self.forwardBarButtonItem.enabled = NO;  
        }
    //Took out the rest for space 

- (void)webViewDidFinishLoad:(UIWebView *)webView {
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
    self.navigationItem.title = [webView stringByEvaluatingJavaScriptFromString:@"document.title"];

    NSURL *urlstring = self.mainWebView.request.URL;

    //Check to see if the current url is in the list. If not, add it to the list.
    if ([urlList containsObject:urlstring])
    {}
    else
    {
        //The first url you click doesnt show up normally so an exception is used here with _retainedURL
        if (_retainedURL != nil) 
        {
            [urlList addObject:_retainedURL];
            _retainedURL = nil;
        }
        else
            { if (backFix == NO)
            {
                urlListIndex++;
                [urlList addObject:urlstring];
            }
            }
    }

    //Keeps track of the max number of URLs in the list
    if (urlListIndex > maxListIndex)
    {
        maxListIndex = urlListIndex;
    }

    [self updateToolbarItems];
    backFix = NO;
}

- (void)goBackClicked:(UIBarButtonItem *)sender {
    backFix = YES;
    urlListIndex--;
    _request = [NSURLRequest requestWithURL:[urlList objectAtIndex:urlListIndex]];
   [mainWebView loadRequest:_request];
}

//Handles the forward button by incrementing the urlListIndex and then loading the url for that index.
- (void)goForwardClicked:(UIBarButtonItem *)sender {
    urlListIndex++;
    _request = [NSURLRequest requestWithURL:[urlList objectAtIndex:urlListIndex]];
    [mainWebView loadRequest:_request];

} 
```

# android - 上下文操作栏强制溢出

> ID：13480508
> 
> 赞同：4
> 
> 时间：2012-11-20T19:20:20.400
> 
> 标签：android, android-actionbar, actionbarsherlock, contextual-action-bar

我正在以`Actionbar`编程方式构建我的菜单项，这是由于[Android 中的一个错误，](http://code.google.com/p/android/issues/detail?id=20065)其中两个`Fragments`都有自己的菜单。

我正在构建菜单`onCreateActionMode`。`MultiChoiceModeListener`如果菜单项超过 4 个，则所有项目都被强制进入上下文操作栏的溢出菜单。

这发生在纵向和横向模式下，但仅当布局在非平板电脑视图中时（例如，两个片段都未显示）。我正在使用 Android 4.2 在 Galaxy Nexus 上进行测试

```
 mListView = getListView();
    mListView.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE_MODAL);

    mListView.setMultiChoiceModeListener(new MultiChoiceModeListener() {
        @Override
        public boolean onCreateActionMode(android.view.ActionMode mode, android.view.Menu menu) {
            // Inflate the menu for the CAB
            menu.add(1, 0, 0, "Menu Item 1");
            menu.add(1, 1, 1, "Menu Item 2");
            menu.add(1, 2, 2, "Menu Item 3");
            menu.add(1, 3, 3, "Menu Item 4");
            menu.add(1, 4, 4, "Menu Item 5");
            return true;
        }
    } 
```

**更新**

我已经将这个问题缩小到如果有超过 4 个菜单项，所有项目都会强制溢出。文本标签的长度无关紧要。我什至将所有文本都设置为空字符串，但它们仍然被迫溢出。设置`IF_ROOM`or`ALWAYS`似乎没有效果。

**更新 2**

我有另一个`Fragment`使用 a `OnItemLongClickListener`，而不是 a `MultiChoiceModeListener`，并且我没有遇到同样的问题。我可以放入 10 个菜单项，它会`Actionbar`按预期显示第一对，并将其余的放入溢出中。

**更新 3**

关于这个问题的更多信息，对于纵向模式的 Nexus 7，问题仍然存在，但是，在非平板电脑视图中（两个片段*均未*显示），在 Nexus 7 的横向模式下，菜单项显示。我唯一能想到的是，当使用一个`MultiChoiceModeListener`认为上下文操作栏中没有空间的情况下，会进行一些间距计算。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:38:48.933

Menu.add [()](http://developer.android.com/reference/android/view/Menu.html#add%28int,%20int,%20int,%20int%29)方法都返回[MenuItem](http://developer.android.com/reference/android/view/MenuItem.html)。对于添加的每个 MenuItem，只需像这样调用[MenuItem.setShowAsAction(int)](http://developer.android.com/reference/android/view/MenuItem.html#setShowAsAction%28int%29)：

```
MenuItem menuItem = menu.add(1, 0, 0, "Menu Item 1");
menuItem.setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS); 
```

# neural-network - 神经网络训练中的奇怪行为？

> ID：13480513
> 
> 赞同：0
> 
> 时间：2012-11-20T19:20:34.477
> 
> 标签：neural-network, classification, email-spam

我创建了一个用于检测垃圾邮件的神经网络。它涉及以下步骤；

```
1.Formation of tf-idf matrix of terms and mails.
2.Reduction of matrix using PCA.
3.Feeding the 20 most important terms according to eigen values to neural network as features. 
```

我正在针对 1-垃圾邮件和 0-非垃圾邮件对其进行训练。

编辑：我决定通过批量处理 7 封邮件来训练它，因为它在形成矩阵时很容易出现内存不足错误。我使用了 ham 和 spam 的标准 enron 数据集。我曾经通过反向传播训练神经网络 -1 输入 - 1 隐藏 - 1 输出层，第一层有 20 个神经元和 6 个隐藏层神经元。

因此，我开始使用 gmail 中的原始垃圾邮件进行培训，结果非常糟糕，然后才将其切换到 enron 数据集。经过相当多的训练后获得了令人满意的输出。

当我测试时，14 封邮件中有 6 封被检测为垃圾邮件。

我使用了替代训练，例如第 1 批垃圾邮件和第 2 批垃圾邮件等，这样网络就被训练为垃圾邮件的 1 输出和 ham 的 0 输出。

但是现在经过太多的培训，我猜大概有 400-500 封邮件，如果再次给出不好的结果。我降低了学习率，但没有帮助。怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:23:09.017

将我的评论总结为答案...如果您确实产生了预期的结果，然后经过额外的培训，输出的准确性降低了，那么很有可能它被[过度训练](http://en.wikipedia.org/wiki/Overfitting)了。

如果您的数据集很小或变化不够，则尤其容易发生这种情况。找到最佳时期数主要是反复试验。

# javascript - 为什么这个 javascript 不能运行？

> ID：13480514
> 
> 赞同：0
> 
> 时间：2012-11-20T19:20:39.420
> 
> 标签：javascript, arrays, html, function, object

在这里，我有两个“类”制作卡片和卡片。Cards 本质上是一个具有特定方法的数组：

*   添加卡
*   移除卡
*   排序和洗牌

Card 是一个对象，用于保存花色值并输出连接两者的字符串。

我的问题是尝试运行此代码，即`setup()`单击按钮。我发现当我刚刚创建一张卡片时，它仍然可以运行。我知道这一点，因为输出仍然会变为 hello world。

但是当我尝试将卡片添加到卡片类或卡片组时。脚本停止运行。我不知道这是为什么，我感觉它不喜欢我使用 Array 的方式。

那是问题一。

我的第二个问题是，当我

```
var temp= new card('c','2');
alert(temp.getvalue()); 
```

这也失败了。

关于我在这里做错了什么的任何见解都会有所帮助并受到赞赏。

```
function setup() {
    var temp = new card('c', '2');
    var textbox = document.getElementById("output");
    textbox.value = "Hello, world!";
};

Array.prototype.shuffle = function () {
    for (var i = this.length - 1; i > 0; i--) {
        var j = Math.floor(Math.random() * (i + 1));
        var tmp = this[i];
        this[i] = this[j];
        this[j] = tmp;
    }

    return this;
}

function card(s, v) {
    this.suit = s;
    this.value = v;

    this.getvalue = function () {
        return (suit.toString() + value.toString());
    };

    this.getSortOrder = function () {
        var factor;
        if (this.suit == 'c') {
            factor = 0;
        }
        else if (this.suit == 'd') {
            factor = 1;
        }
        else if (this.suit == 'h') {
            factor = 2;
        }
        else if (this.suit == 's') {
            factor = 3;
        }
        else {
            factor = -2;
        }

        return (this.value + 13 * factor);
    };
};

function Cards() {
    this.list = new Array();

    this.Addcard = function (c) {
        list.push(c);
    };

    this.removeCard = function (c) {
        list.splice(list.indexOf(c), 1);
    };

    this.lookat = function (i) {
        return list[i];
    };

    this.sort = function () {
        list.sort();
    };

    this.shuffle = function () {
        list.shuffle();
    };

    this.prototype;
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:24:33.487

这是一件事：

```
this.getvalue = function () {

    return (suit.toString() + value.toString());

}; 
```

您需要通过以下方式访问西装和价值：

```
this.getvalue = function () {

    return (this.suit.toString() + this.value.toString());

}; 
```

**编辑：**

您的代码中还有很多类似的内容（请参阅`Cards`函数）。Javascript 不会像其他语言那样自动为您放置“this”，因为它没有类，它有原型。

每当您尝试访问“成员变量”时，给它一些上下文，使用`this`.

其他代码风格提示：

*   使用 [] 代替`new Array()`
*   `/*`用and注释大块代码`*/`
*   构造函数应该大写（Card，不是 Card），函数应该是驼峰式大小写（addCard，不是 Addcard）

# c - 无效的写入/读取 valgrind 错误，在其他问题中未找到解决方案

> ID：13480521
> 
> 赞同：4
> 
> 时间：2012-11-20T19:20:57.900
> 
> 标签：c, valgrind

我正在为家庭作业编写 C 代码，该作业通过内存段的动态数组复制主内存。

这些内存段来自不同的接口，它本身只是一个 uint32_ts 的静态数组。

我的主内存接口称为 heapmem（如堆内存），自从切换以来，我一直收到奇怪的 valgrind 读/写错误。在咀嚼我之前，我已经查看和研究，并且作为最后的手段来SO。

这是错误

```
==30352== Invalid write of size 8
==30352==    at 0x401661: HeapMem_map (heapmem.c:84)
==30352==    by 0x400E74: map (um.c:109)
==30352==    by 0x4010FD: runOpcode (um.c:182)
==30352==    by 0x4011A1: UM_run (um.c:209)
==30352==    by 0x400A71: main (main.c:10)
==30352==  Address 0x4c53b00 is 0 bytes after a block of size 16 alloc'd
==30352==    at 0x4A0610C: malloc (vg_replace_malloc.c:195)
==30352==    by 0x401425: HeapMem_new (heapmem.c:32)
==30352==    by 0x400ABE: UM_new (um.c:31)
==30352==    by 0x400A64: main (main.c:8)
==30352== 
==30352== Invalid read of size 8
==30352==    at 0x401787: HeapMem_put (heapmem.c:114)
==30352==    by 0x400D38: sstore (um.c:90)
==30352==    by 0x401090: runOpcode (um.c:167)
==30352==    by 0x4011A1: UM_run (um.c:209)
==30352==    by 0x400A71: main (main.c:10)
==30352==  Address 0x4c53b00 is 0 bytes after a block of size 16 alloc'd
==30352==    at 0x4A0610C: malloc (vg_replace_malloc.c:195)
==30352==    by 0x401425: HeapMem_new (heapmem.c:32)
==30352==    by 0x400ABE: UM_new (um.c:31)
==30352==    by 0x400A64: main (main.c:8)
==30352== 
==30352== Invalid read of size 8
==30352==    at 0x401956: car_double (heapmem.c:151)
==30352==    by 0x401640: HeapMem_map (heapmem.c:82)
==30352==    by 0x400E74: map (um.c:109)
==30352==    by 0x4010FD: runOpcode (um.c:182)
==30352==    by 0x4011A1: UM_run (um.c:209)
==30352==    by 0x400A71: main (main.c:10)
==30352==  Address 0x4c53b00 is 0 bytes after a block of size 16 alloc'd
==30352==    at 0x4A0610C: malloc (vg_replace_malloc.c:195)
==30352==    by 0x401425: HeapMem_new (heapmem.c:32)
==30352==    by 0x400ABE: UM_new (um.c:31)
==30352==    by 0x400A64: main (main.c:8)
==30352== 
==30352== Invalid read of size 8
==30352==    at 0x40174A: HeapMem_get (heapmem.c:108)
==30352==    by 0x400CD9: sload (um.c:86)
==30352==    by 0x401079: runOpcode (um.c:164)
==30352==    by 0x4011A1: UM_run (um.c:209)
==30352==    by 0x400A71: main (main.c:10)
==30352==  Address 0x4c7e0f0 is 0 bytes after a block of size 4,096 alloc'd
==30352==    at 0x4A0610C: malloc (vg_replace_malloc.c:195)
==30352==    by 0x401923: car_double (heapmem.c:148)
==30352==    by 0x401640: HeapMem_map (heapmem.c:82)
==30352==    by 0x400E74: map (um.c:109)
==30352==    by 0x4010FD: runOpcode (um.c:182)
==30352==    by 0x4011A1: UM_run (um.c:209)
==30352==    by 0x400A71: main (main.c:10) 
```

以下是代码中的函数给我错误：

```
//  Heap Memory Structure
struct T {
   Stack_T SegID_stack;
   MemSeg_T* HeapMem_car;
   int length, highest;
};

//  Create a new heap memory structure
T HeapMem_new (MemSeg_T program) {
    assert (program);
    T retHeap = malloc(sizeof(*retHeap));
    Stack_T structStack = Stack_new ();
    retHeap->length = INIT_SIZE;
    retHeap->highest = 0;
    MemSeg_T* structCar = malloc(INIT_SIZE * sizeof(*structCar));
    //  Fill the array with NULL ptrs
    for (int i = 0; i < INIT_SIZE; i++) {
        structCar[i] = NULL;
    }
    retHeap->HeapMem_car = structCar;
    retHeap->SegID_stack = structStack;
    //  We'll be using the map function to initialize
    //  the heap with a program at the 0th segment.
    HeapMem_map (retHeap, MemSeg_length (program));
    retHeap->HeapMem_car[PROGRAM_LOC] = program;
    return retHeap;
}

//  Line 84
heapmem->HeapMem_car[toMap] = segment;
//  Line 114
MemSeg_T segToPut = heapmem->HeapMem_car[toPut];
//  Line 151
newCar[i] = heapmem->HeapMem_car[i];
//  Line 108
MemSeg_T wordSeg = heapmem->HeapMem_car[toGet]; 
```

其余代码可[在此处](http://pastebin.com/DrgahENB)获得。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-20T22:35:08.280

*首先对您的一个*错误进行小剖析：

```
==30352== Invalid write of size 8
==30352==    at 0x401661: HeapMem_map (heapmem.c:84)
==30352==    by 0x400E74: map (um.c:109)
==30352==    by 0x4010FD: runOpcode (um.c:182)
==30352==    by 0x4011A1: UM_run (um.c:209)
==30352==    by 0x400A71: main (main.c:10)
==30352==  Address 0x4c53b00 is 0 bytes after a block of size 16 alloc'd
==30352==    at 0x4A0610C: malloc (vg_replace_malloc.c:195)
==30352==    by 0x401425: HeapMem_new (heapmem.c:32)
==30352==    by 0x400ABE: UM_new (um.c:31)
==30352==    by 0x400A64: main (main.c:8) 
```

请注意，此列表的底部告诉您分配*发生*的位置。顶部告诉你它是如何被*滥用*的。在这种情况下，您正好经过请求分配的末尾 8 个字节。

您会注意到其中的所有超限，并且剩余的违规以完全相同的偏移量（8 个字节）超出了他们的能力范围。对引用代码的进一步检查表明它似乎总是*相同的数组*。这实际上是一件好事，因为它很可能只是错误地计算数据项的存在方式并达到超出允许空间的一个或两个的问题

在这种情况下，被破坏的项目似乎是一个动态分配的指针列表（`heapmem->HeapMem_car[]`）。在具有 64 位指针的机器上运行会使每个指针都有 8 字节宽，因此您很可能在此分配的最后一个可访问元素中简单地一个接一个，而在 C 中，这通常意味着在某些点你分配的`N`项目，然后访问`array[N]`忘记限制是`N-1`。所有上述访问违规似乎都集中在相信该数组的索引没有越界，但 valgrind 报告它们是。我建议您将一些 assert() 插入这些访问点并在违规时中断以查看您是如何到达那里的。哦等等.. valgrind 已经为你提供了这些信息。看看那个可爱的调用堆栈。嗯……

*那么，为什么即使有这些违规行为它似乎也能奏效呢？*多种可能性。如果您没有远远超出分配的内存 - 并且这里的所有地址都是 0 字节之后 - （这些毕竟是指针，所以祈祷它们是 NULL）很有可能不会覆盖重要数据和程序似乎工作。直到分配突然降落在其他地方并且您跨过页面边界。过冲和kerboom。

感谢[Daniel Fischer](https://stackoverflow.com/users/1011995/daniel-fischer)对这个答案的第二部分的贡献（为什么它似乎有效）。

# c# - 用于限制可以为属性设置的值的结构化代码

> ID：13480525
> 
> 赞同：2
> 
> 时间：2012-11-20T19:21:24.930
> 
> 标签：c#, .net, vb.net

对属性可以获得哪些值进行限制编码的正确（和最佳）方法是什么？

例如，假设我有以下简单的类：

```
Public Class MyClass
   Public Property MyDate As Date 
```

现在，假设`MyDate`在运行时设置，但不能取不到一年前的任何值。

在 MyDate 的设置器中抛出异常然后以某种`Try...Catch`方式在我的主模块中对其进行编程然后在值错误时提醒用户或者是否有更好的方法来执行此操作是否正确？

我敢肯定这是一个愚蠢的简单问题，但我只是想确保我是根据最佳编程实践来做这件事的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T19:24:12.060

是的，抛出和异常是个好主意。[ArgumentOutOfRangeException](http://msdn.microsoft.com/en-us/library/system.argumentoutofrangeexception.aspx)在这种情况下似乎是最好的。遵循 MSDN：

> 当参数的值超出被调用方法定义的允许值范围时引发的异常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:31:53.170

虽然抛出异常是一个有效的选择，但我建议不要这样做。原因是当程序员设置一个属性时，除了设置的值之外，他/她期望很少发生。在这种情况下，我建议使用 set 函数而不是属性或将值作为构造函数的一部分传递（程序员希望发生这种验证逻辑）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:25:36.450

看看这篇文章。它概述了 System.ComponentModel.DataAnnotations 命名空间中的验证器。它们是支持验证的模型的属性。

[http://stephenwalther.com/archive/2008/09/10/asp-net-mvc-tip-43-use-data-annotation-validators.aspx](http://stephenwalther.com/archive/2008/09/10/asp-net-mvc-tip-43-use-data-annotation-validators.aspx)

ASP.NET MVC 支持使用 JS 在表单上显示这些验证，但在其他应用程序类型中，您可以从模型本身读取属性并强制执行验证。

# jquery - 固定标题上的点击事件

> ID：13480526
> 
> 赞同：0
> 
> 时间：2012-11-20T19:21:28.660
> 
> 标签：jquery, fixed-header-tables

我在我的代码中使用了[这个 gist](https://gist.github.com/3819758)中的固定标头。我希望能够单击标题列并根据单击的列标题对表格进行排序。但我无法掌握该列上的点击事件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:35:33.623

试试这个

```
$('.fixed-table').on('click', '.header-fixed th', function(){
    var th=$(this).index();
    alert('Column number is : ' + th + ' and text is : ' + $(this).text());
}); 
```

[**演示**](http://jsfiddle.net/NWV73/27/)。

# javascript - 我的样式被我用 ajax 获得的 html 覆盖

> ID：13480527
> 
> 赞同：1
> 
> 时间：2012-11-20T19:21:42.120
> 
> 标签：javascript, jquery, html, css, ajax

我正在构建一个群发邮件系统，您可以在其中查看电子邮件在发送之前的预览。我使用 jquery 将电子邮件 html 呈现到预览框中——`$().html(theHtml).`

Html 电子邮件的样式使用所有内联 css。当我填写 html 时，它会覆盖我的一些 css。

我正在寻找一种解决方案来完全阻止这种情况的发生。有什么方法可以自我包含电子邮件 html/css，这样它就不会影响整个文档？

我知道在我的样式中添加 !important 可以解决问题，但这不是一个非常可扩展的选项。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:26:54.510

不幸的是 !important 是覆盖内联样式的唯一方法 - 这就是特异性的工作方式。

但是，您可以通过使用 ID 和类等使所有“包装器”CSS（例如，您的页面的 CSS，而不是 HTML 电子邮件预览）更具体，这样它们的样式就不会被覆盖，从而绕过它。嵌入在 HTML 电子邮件中的通用样式声明。

不过我有点困惑 - 你是在尝试覆盖“内联”样式（如在具有 style="your css here" 属性的元素中）还是嵌入 CSS（例如“your css here”）？如果是后者，只需在您自己的 CSS 中使重要的东西更具体。

有关特异性的更多信息：http: [//coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/](http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)

不过，按照 Sander 的建议，使用 iframe 可能比尝试重构 CSS 特异性规则更简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:29:09.747

您的网站和电子邮件是否使用相同的`class`/名称？`id`这不应该是这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:31:02.247

我强烈建议为您的 CSS使用[伪命名空间。](http://meiert.com/en/blog/20070321/css-practice-pseudo-namespaces-in-complex-projects/)

基本上，为您的 CSS 添加一个不会包含在内联 3rd-party 内容中的任意前缀：`<div class='foo'>`变为`<div class='myapp-foo'>`

最近在我们的项目中使用了这种做法，它只需要更多的纪律，但使应用程序更易于管理以嵌入其他内容。

# c++ - 无法在 Kubuntu 10 上运行 c++ cgi。检查了所有 apache 配置+exec+cgi-bin+api

> ID：13480528
> 
> 赞同：2
> 
> 时间：2012-11-20T19:21:45.550
> 
> 标签：c++, apache2, cgi, ubuntu-10.10

我正在尝试使用 Apache2 在 kubuntu 10 上编译我的第一个 c++ cgi 程序，但什么也没有。

我把它放到 cgi-bin 文件夹中检查了配置文件，在命令上运行程序，将权限更改为可执行文件，但什么也没有。Rekonq 说“没有服务可以处理这个文件”

我已经安装了 apache2。也重启了。坚果

它已经一整天了，绝望了。如果你有任何想法，会救我

我的 cgi-bin 在 etc/apache2/ 中。我的配置文件 @ etc/apache2/sites-enabled/000-default 另一个答案是这些是 Kub10-12 的作者

您可以在此屏幕截图中查看所有配置和执行。也复制到这里 [http://img832.imageshack.us/img832/1659/cgiv.jpg](http://img832.imageshack.us/img832/1659/cgiv.jpg)

```
<VirtualHost *:80>
    ServerAdmin webmaster@localhost

    DocumentRoot /var/www
    <Directory />
        Options FollowSymLinks
        AllowOverride None
    </Directory>
    <Directory /var/www/>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride None
        Order allow,deny
        allow from all
    </Directory>

    ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
    <Directory "/usr/lib/cgi-bin">
        AllowOverride None
        Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
        Order allow,deny
        Allow from all
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/error.log

    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel warn

    CustomLog ${APACHE_LOG_DIR}/access.log combined

    Alias /doc/ "/usr/share/doc/"
    <Directory "/usr/share/doc/">
        Options Indexes MultiViews FollowSymLinks
        AllowOverride None
        Order deny,allow
        Deny from all
        Allow from 127.0.0.0/255.0.0.0 ::1/128
    </Directory>

</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T03:05:12.780

问题是您正试图通过文件系统（使用`file://`URL）直接访问您的 CGI 程序，这意味着 Apache 没有为您的请求提供服务。

相反，使用 URL 连接到在 localhost 上运行的 Apache `http://localhost/cgi-bin/cplusplus.cgi`。

# java - 我应该如何将值传递给页面？

> ID：13480529
> 
> 赞同：0
> 
> 时间：2012-11-20T19:21:46.850
> 
> 标签：java, html, jsp, jakarta-ee, servlets

我是 JSP 的新手，并试图从 ASP.NET 过渡（这是完全不同的）。

我基本上有一组 html 输入按钮。按下时，这些按钮中的每一个都应重定向到同一页面。但是，我也想传递一个参数，即我希望页面根据哪个按钮启动重定向而表现不同。

到目前为止，我所做的是将按钮包装在一个表单中，该表单与 servlet 的 GET 方法进行通信。从这里，我可以看到按下了哪个按钮。

我现在想重定向到页面并传递按下的按钮的值。如何才能做到这一点？我需要重定向到的页面是一个 JSP 页面。

我的代码：

**HTML页面：**

```
<form action="DashboardServlet" method="get">
<input type="button" value="Button1" name="button1"/>
<input type="button" value="Button2" name="button2"/>
</form> 
```

**DashboardServlet**

```
....

    // If-statements to see what button was pressed

.... 
```

**编辑**：我正在考虑使用会话来存储值。这有效吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:23:27.427

```
request.getParameter("button1"); 
```

它的工作原理与您在文本框的情况下使用的非常相似。

要检查按下了哪些按钮： -

```
if (request.getParameter("button1") != null) {
    // button1 was pressed

} else if (request.getParameter("button2") != null) {
    // button2 was pressed
} 
```

* * *

当您将请求重定向到您的 JSP 页面时，您可以将这些参数添加到请求中。相同的请求参数在您的 JSP 中不可用，除非您明确添加它。

* * *

如果您使用的是：- `RequestDispatcher.forward()`，那么您可以在请求中设置参数：-

```
request.setAttribute("button1", request.getParameter("button1").toString()); 
```

接着： -

```
getServletContext().getRequestDispatcher("/yourJSP.jsp").forward() 
```

在你的`JSP`，使用： -

```
request.getAttribute("button1"); 
```

* * *

或者，如果您使用的是`response.sendRidirect`，您可以将您的值添加到`queryString`： -

```
String buttonValue = request.getParameter("button1").toString();
response.sendRedirect("/yourJSP.jsp?button1=" + buttonValue); 
```

# perl - Perl grep 未返回预期值

> ID：13480532
> 
> 赞同：1
> 
> 时间：2012-11-20T19:21:55.237
> 
> 标签：perl

我有以下代码：

```
#!/usr/bin/perl
# splits.pl

use strict;
use warnings;
use diagnostics;

my $pivotfile = "myPath/Internal_Splits_Pivot.txt";

open PIVOTFILE, $pivotfile or die $!;

while (<PIVOTFILE>) { # loop through each line in file

    next if ($. == 1); # skip first line (contains business segment code)
    next if ($. == 2); # skip second line (contains transaction amount text)

    my @fields = split('\t',$_);  # split fields for line into an array     

    print scalar(grep $_, @fields), "\n"; 

} 
```

鉴于文本文件中的数据是这样的：

```
 4   G   I   M   N   U   X
    Transaction Amount  Transaction Amount  Transaction Amount  Transaction Amount  Transaction Amount  Transaction Amount  Transaction Amount
0000-13-I21             600         
0001-8V-034BLA              2,172   2,172       
0001-8V-191GYG                  13,125      4,375
0001-9W-GH5B2A  -2,967.09       2,967.09    25.00 
```

我希望 perl 脚本的输出是：`2 3 3 4`给定每行中定义的元素的数量。该文件是一个制表符分隔的文本文件，有 8 列。

相反，我得到`3 4 3 4`了，我不知道为什么！

作为背景，我[在 Perl 中使用 Counting array elements](https://stackoverflow.com/questions/863426/counting-array-elements-in-perl)作为我开发的基础，因为我试图计算行中的元素数量以了解是否需要跳过该行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:27:06.570

问题应该在这一行：

```
my @fields = split('\t',$_);  # split fields for line into an array 
```

制表符不会被插值。而且您的文件似乎不是仅制表符分隔的，至少在此处如此。我更改了拆分正则表达式以匹配任意空格，在我的机器上运行代码并得到“正确”的结果：

```
my @fields = split(/\s+/,$_);  # split fields for line into an array 
```

结果：

```
2
3
3
4 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T20:26:39.933

作为旁注：

> 作为背景，我[在 Perl 中使用 Counting array elements](https://stackoverflow.com/questions/863426/counting-array-elements-in-perl)作为我开发的基础，因为我试图计算行中元素的数量以了解是否需要跳过该行。

现在我明白了为什么要使用`grep`数组元素来计数。当您的数组包含如下未定义的值时，这一点很重要：

```
my @a;
$a[1] = 42;      # @a contains the list (undef, 42)
say scalar @a;   # 2 
```

或者当您手动删除条目时：

```
my @a = split /,/ => 'foo,bar';    # @a contains the list ('foo', 'bar')
delete $a[0];                      # @a contains the list (undef, 'bar')
say scalar @a;                     # 2 
```

但在许多情况下，尤其是当您使用数组仅存储列表而不对单个数组元素进行操作时，`scalar @a`效果**非常好**。

```
my @a = (1 .. 17, 1 .. 25);        # (1, 2, ..., 17, 1, 2, .., 25)
say scalar @a;                     # 42 
```

重要的是要了解，是什么`grep`！在你的情况下

```
print scalar(grep $_, @fields), "\n"; 
```

`grep`返回**真**值的列表，`@fields`然后打印你有多少。但有时这不是您想要/期望的：

```
my @things = (17, 42, 'foo', '', 0);  # even '' and 0 are things
say scalar grep $_ => @things         # 3! 
```

因为空字符串和数字 0 在 Perl 中是错误值，所以它们不会被该习语计算在内。因此，如果您想知道数组有多长，只需使用

```
say scalar @array; # number of array entries 
```

如果要计算**真实**值，请使用此

```
say scalar grep $_ => @array; # number of true values 
```

但是如果你想计算**定义**的值，使用这个

```
say scalar grep defined($_) => @array; # number of defined values 
```

我很确定您已经从链接页面上的其他答案中知道了这一点。在散列中，情况稍微复杂一些，因为设置某些`undef`内容与`delete`ing 不同：

```
my %h = (a => 0, b => 42, c => 17, d => 666);
$h{c} = undef;   # still there, but undefined
delete $h{d};    # BAM! $h{d} is gone! 
```

当我们尝试计算值时会发生什么？

```
say scalar grep $_ => values %h;   # 1 
```

因为**42**是`%h`.

```
say scalar grep defined $_ => values %h;   # 2 
```

因为 0 被定义，虽然它是假的。

```
say scalar grep exists $h{$_} => qw(a b c d);   # 3 
```

因为可能存在未定义的值。结论：

**知道你在做什么而不是复制'n'粘贴代码片段:)**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T19:33:40.060

我怀疑您在某些地方与制表符混合了空格，并且您的 grep 测试会认为“”为真。

有什么作用：

```
use Data::Dumper;
$Data::Dumper::Useqq=1;
print Dumper [<PIVOTFILE>]; 
```

节目？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-20T19:35:20.113

不仅有制表符，还有空格。

尝试按空间分割作品看下面

```
#!/usr/bin/perl
# splits.pl

use strict;
use warnings;
use diagnostics;

while (<DATA>) { # loop through each line in file

    next if ($. == 1); # skip first line (contains business segment code)
    next if ($. == 2); # skip second line (contains transaction amount text)

    my @fields = split(" ",$_);  # split fields by SPACE     

    print scalar(@fields), "\n"; 

}

__DATA__
    4   G   I   M   N   U   X
    Transaction Amount  Transaction Amount  Transaction Amount  Transaction Amount  Transaction Amount  Transaction Amount  Transaction Amount
0000-13-I21             600         
0001-8V-034BLA              2,172   2,172       
0001-8V-191GYG                  13,125      4,375
0001-9W-GH5B2A  -2,967.09       2,967.09    25.00 
```

输出

```
2
3
3
4 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-20T19:36:53.507

你的代码[对我有用](http://ideone.com/DeZE2N)。问题可能是输入文件包含一些“隐藏的”空白字段（例如，除了制表符之外的其他空白）。例如

*   `A<tab><space><CR>`给出两个字段，`A`并且`<space><CR>`
*   `A<tab>B<tab><CR>`给出三个, `A`, `B`, `<CR>`（记住，行尾是输入的一部分！）

我建议您`chomp`使用您使用的每一行；除此之外，您将不得不从仅限空格的字段中清除数组。例如。

```
scalar(grep /\S/, @fields) 
```

应该这样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-20T22:48:21.440

在这个问题上有很多很大的帮助，而且很快！

经过漫长而漫长的学习过程，这是我想出的，效果很好，达到了预期的效果。

```
#!/usr/bin/perl
# splits.pl

use strict;
use warnings;
use diagnostics;

my $pivotfile = "myPath/Internal_Splits_Pivot.txt";

open PIVOTFILE, $pivotfile or die $!;

while (<PIVOTFILE>) { # loop through each line in file

    next if ($. == 1); # skip first line (contains business segment code)
    next if ($. == 2); # skip second line (contains transaction amount text)

    chomp $_; # clean line of trailing \n and white space

    my @fields = split(/\t/,$_);  # split fields for line into an array     

    print scalar(grep $_, @fields), "\n"; 

} 
```

# iphone - UIScrollView 随机卡住，CADisplayLink 不触发

> ID：13480538
> 
> 赞同：0
> 
> 时间：2012-11-20T19:22:21.970
> 
> 标签：iphone, objective-c, ios, xcode, opengl-es

我有一个 OpenGLES 应用程序，带有一个 CADisplayLink（在 NSRunLoopCommonModes 中添加），用于调用主循环（我在其中执行所有 OpenGL 调用）。

我添加了一个 UIScrollView，但它随机卡住了。如果我将应用程序发送到后台，当我返回时，有时它可以完美运行，而另一些则卡住（我可以移动它，但放手时它不会滑动）。

追踪问题，我注意到 UIScrollView 的内部函数 _ *smoothScrollWithUpdateTime* : 没有被调用。显然，它使用自己的 CADisplayLink 来获取该调用。所以我尝试添加自己的 CADisplayLink （与完成所有绘图的主要 CADisplayLink 分开），并且它也随机不被调用。这是代码：

```
- (void) addDisplayLink
{
    displayLink = [NSClassFromString(@"CADisplayLink") displayLinkWithTarget:self selector:@selector(loop:)];
    [displayLink setFrameInterval:1];
    [displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes];
}

- (void) loop:(id)sender
{
    NSLog(@"Loop working!");
} 
```

有任何想法吗？

**TL/DR：**我有两个 CADisplayLink，其中一个不工作。

# opengl-es - 如何在 OpenGL ES 2.0 中使用 GL_FLOAT 创建纹理？

> ID：13480540
> 
> 赞同：0
> 
> 时间：2012-11-20T19:22:29.850
> 
> 标签：opengl-es, opengl-es-2.0, textures

当有人打电话时：

```
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, texWidth, texHeight, 0, GL_RGBA, GL_UNSIGNED_BYTE, rawData); 
```

很容易知道如何格式化数据：传入一个字节数组，范围为 0-255，其中 0 是最低的，255 是每个颜色分量最亮的。

当你对 GL_FLOAT 做同样的事情时，你传入一个浮点数组。我的问题是，每个颜色分量值的范围是多少？0 到 1.0？0 到浮点数的最大值？

你会传入一个浮点数组，当使用 GL_RGBA 时，每个像素有 4 个浮点数，对吗？

另外，要确认：GL_HALF_FLOAT_OES 不是 glTexImage2D 的参数，而是仅用于顶点，对吗？

我的 iPad 3 报告支持“GL_OES_texture_float”和“GL_OES_texture_half_float_linear”。这意味着我确实可以使用 GL_FLOAT 作为 glTexImage2D 的参数，对吧？有人知道 iPad 2 是否支持这个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T19:48:04.063

浮点值的范围是……[浮点值的范围](http://en.wikipedia.org/wiki/IEEE_754#Basic_formats)。这就是使用它们的意义所在。当您从着色器中的浮点纹理获取时，您将获得存储在那里的浮点值。没有夹紧或任何应用。

如果你制作一个半浮点纹理，那么它的值的范围是 16 位浮点值。如果您制作单精度浮点纹理，则其值的范围为 32 位浮点值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:28:39.117

我可以回答这个问题的前两部分，最后两部分请参考[这个问题](https://stackoverflow.com/questions/8621095/how-to-use-gl-half-float-oes-typed-textures-in-ios)

> 我的问题是，每个颜色分量值的范围是多少？0 到 1.0？

是的，范围是 0.0 到 1.0

[编辑] 正如 Nicol Bolas 指出的那样，这是不正确的，您可以使用任何浮点值，但是当它被解释为颜色值时，它将被限制在 (0.0 - 1.0) 范围内

> 你会传入一个浮点数组，当使用 GL_RGBA 时，每个像素有 4 个浮点数，对吗？

是的，浮点数也将按该顺序存储（红色、绿色、蓝色、Alpha）

# nhibernate - FluentNHibernate 与 NHibernate 的“代码映射”的区别

> ID：13480543
> 
> 赞同：31
> 
> 时间：2012-11-20T19:22:42.623
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping, fluent-nhibernate-mapping

我来自我的 ORM 工具的实体框架和 LLBL 背景。

我被要求构建一个基于 NHibernate 的新系统。我从来没有这样做过，所以我以全新的眼光来看待它。

使用 Fluent NHibernate 进行映射和 NHibernate 中的“按代码映射”有什么区别？有偏好吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-20T19:33:54.957

[流畅的氨](https://github.com/jagregory/fluent-nhibernate/wiki)

> Fluent NHibernate 提供了 NHibernate 的标准 XML 映射文件的替代方案。您无需编写 XML 文档，而是使用强类型 C# 代码编写映射。这允许轻松重构、提高可读性和更简洁的代码。

对比

[NH 的新代码映射](http://notherdev.blogspot.com/2012/02/nhibernates-mapping-by-code-summary.html)

> 它是基于 ConfORM 库的无 XML 映射解决方案，自 3.2 起成为 NHibernate 不可或缺的一部分。它的 API 试图符合 XML 命名和结构。映射方法的构建方式有一个严格的约定。它的名称几乎总是等于 XML 元素的名称。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-20T19:35:48.040

其中一些是偏好，其中一些是现有的代码库。曾经有一段时间，NHibernate 没有任何内置的非 XML 映射选项。有一些解决方案可以解决这个问题——例如 confORM、Fluent NHibernate 和其他我可能不知道的解决方案。

从 3.2 开始，我相信（也许是 3.0）NHibernate 现在有“代码映射”。与 Fluent NHibernate 相比，它的优势在于它不需要额外的库，并且由与 NHibernate 相同的团队支持。另一方面，Fluent NHibernate 更成熟一些（据我所知），可以支持更广泛的映射功能。

我还提到了“现有代码库”。显然，如果您有一个已经使用 Fluent NHibernate 映射的项目，最好继续使用它。如果您刚开始，也许值得尝试使用内置的“按代码映射”

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-23T10:05:04.607

我知道这篇文章已经过时了，但是对于其他对此感兴趣的人，我强烈建议您阅读此博客。它让我很清楚，它甚至还为您提供了两种方法之间的比较。

[http://notherdev.blogspot.de/2012/01/nhibernates-mapping-by-code-first.html](http://notherdev.blogspot.de/2012/01/nhibernates-mapping-by-code-first.html)

# objective-c - 导出为 CSV 文件时的 NSMutableArray 元数据

> ID：13480544
> 
> 赞同：0
> 
> 时间：2012-11-20T19:22:44.550
> 
> 标签：objective-c, nsstring, nsmutablearray, plist, metadata

寻找有关 iOS 应用程序的一些建议。

本质上，我的应用程序所做的是生成一个 CSV 文件，该文件在一段时间内记录某些事件。所以用户可以按下一个按钮，一个条目将被添加到日志中，上面写着“类型 X 的事件发生在时间 T”

我这样做的方式是维护一个存储 NSStrings 的 NSMutableArray。每个事件都会向 NSMutableArray 添加一个字符串。

当用户完成会话时，他们可以“导出”文件。我正在使用 NSMutableArray 的 writeToFile；然后我使用电子邮件界面将该文件作为 CSV 文件发送到目标电子邮件。

一切正常，除了生成的 CSV 文件中包含一些元数据。具体来说，我相信在我看到的文件顶部以及在 excel 中打开时每行单元格的开头。

这是我正在使用的数据结构（NSMutableArray）或数据类型（NSString）中固有的东西吗？有没有办法让我只获取原始数据？

如果需要，我可以上传代码（不过我现在不在工作计算机附近，所以我正在试水，看看是否有一些简单的方法可以阻止看到这些元数据）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:02:51.360

CSV 是一种非常简单的格式。您可以使用分号分隔字符串，然后使用`NSOutputStream`.

此代码假定您已经有一个包含 CSV 行的字符串数组：

```
NSOutputStream* csvoutput = [NSOutputStream outputStreamToFileAtPath:filepath append:NO];
[csvoutput open];
for (NSString* str in array) {
    NSString* tempStr = [str stringByAppendingString:@"\n"]; //new line
    NSData *strData = [tempStr dataUsingEncoding:NSUTF8StringEncoding];
    [csvoutput write:(uint8_t *)[strData bytes] maxLength:[strData length]];
}
[csvoutput close]; 
```

您最好创建一个模型类 ( `Event`) 并使用 Event-instances 而不是字符串填充数组。那更清洁，更高效。然后，您将在导出到文件时创建 CSV 字符串。

# javascript - 如何生成javascript堆栈跟踪？

> ID：13480558
> 
> 赞同：8
> 
> 时间：2012-11-20T19:23:47.360
> 
> 标签：javascript, stack-trace, printstacktrace

关于如何以跨浏览器的方式在 javascript 中生成堆栈跟踪的任何建议？

较新的浏览器 Chrome 和 Firefox 公开了一个允许生成堆栈跟踪的控制台对象。此方法不提供将堆栈跟踪存储到变量的方法。

[https://github.com/eriwen/javascript-stacktrace](https://github.com/eriwen/javascript-stacktrace) 工作得很好，但它会发出单独的 ajax 请求来加载包含在跟踪中的脚本文件。这似乎是跟踪库中的常用方法。我猜浏览器没有公开足够的信息来生成有意义的堆栈跟踪（行号、函数名、文件名、参数等）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-02T22:15:58.243

创建一个错误对象并检查它是否有堆栈成员。改编自[代码泛音](http://www.codeovertones.com/2011/08/how-to-print-stack-trace-anywhere-in.html)：

```
var e = new Error('dummy');
var stack = e.stack.replace(/^[^\(]+?[\n$]/gm, '') // remove lines without '('
  .replace(/^\s+at\s+/gm, '') // remove prefix text ' at '
  .split('\n');
console.log(stack); 
```

Error.stack 记录在[Mozilla 的参考文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Error/prototype)中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:27:28.763

[Airbrake 提供了一个 JavaScript 库，用于将堆栈跟踪记录](https://github.com/airbrake/airbrake-js)到您的 Airbrake 帐户或 Errbit 服务器。

我在 IE 中没有得到堆栈跟踪，其他的可能并不完美，但它看起来确实符合您正在寻找的内容。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-07-25T11:50:30.993

您可以使用 stacktrace.js 生成 javascript stacktrace

[http://stacktracejs.com/](http://stacktracejs.com/)

另外，您可以参考：[http ://www.eriwen.com/javascript/js-stack-trace/](http://www.eriwen.com/javascript/js-stack-trace/)

# javascript - JavaScript 作为服务器端语言

> ID：13480559
> 
> 赞同：0
> 
> 时间：2012-11-20T19:23:49.210
> 
> 标签：javascript, serverside-javascript

我一直在尝试了解 JavaScript 如何充当服务器端语言，因为我习惯于 JavaScript 用于 AJAX 等客户端工作。有人可以简洁地向我解释一下，我有 Java 和 OOP 经验，并且无法理解因为 JS 是无状态的这一事实。

非常感谢，如果答案真的很深入，我会把它变成一个社区维基。我知道nodeJS是用JS来完成服务端编码的，是不是因为它是用谷歌V8引擎编译的？

另一方面，在 AJAX 中，JS 被用作页面上的逻辑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T19:27:33.880

你是什​​么意思javascript是无状态的？这是一个具有瞬态的简单[node.js](http://nodejs.org/)服务器（在服务器重新启动时丢失）：

```
var http = require('http');

var someState = 0;

http.createServer(function(req, res) {
    res.writeHead(200, {'Content-Type': 'text/plain'});
    res.end('Javascript has state: ' + someState++ + '\n');
}).listen(1337, '127.0.0.1');
console.log('Server running at http://127.0.0.1:1337/'); 
```

> 我知道nodeJS是用JS来完成服务端编码的，是不是因为它是用谷歌V8引擎编译的？

这就像在问*“我知道你可以使用 PHP 进行服务器端编码，但这是因为它需要 PHP 运行时吗？”*

# asp.net-mvc - 在提交时使用 DisplayFor 发布模型属性

> ID：13480564
> 
> 赞同：1
> 
> 时间：2012-11-20T19:24:17.917
> 
> 标签：asp.net-mvc, razor, viewmodel, displayfor

我的一个视图页面我通过控制器传入了一个模型，所以我可以写：
`@Html.DisplayFor(m => m.FirstName)`它显示模型的名字。当我尝试使用在页面上提交表单时

```
@using (Html.BeginForm("CreateUser", "Controller", FormMethod.Post, new { UserViewModel = Model })) 
```

我看看我的模型

```
[HttpPost]
public virtual ActionResult CreateUser(UserViewModel model)
{
    //model.FirstName is blank 
```

无论如何我可以让model.FirstName不为空吗？通过一些如何通过我最初通过的模型？我可以设置一堆隐藏的评论，但如果有更好的方法会很有帮助

编辑：DisplayFor 只是显示模型可访问的示例。我实际上有大约 15 个字段，并且我正在通过多种形式尝试填充模型。隐藏是唯一的方法吗？我可以隐藏整个模型吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:27:17.367

`@Html.DisplayFor()`默认情况下（如果您不使用显示模板）创建一个简单的文字值，仅在提交表单元素时提交给服务器。

您可以使用隐藏输入。

```
@Html.HiddenFor(m => m.FirstName) 
```

这将是这样的：

```
<input type="hidden" value="{the first name}" name="FirstName" id="FirstName" /> 
```

# c++ - 如何在 C++ 类中创建私有动态数组？

> ID：13480568
> 
> 赞同：4
> 
> 时间：2012-11-20T19:24:26.833
> 
> 标签：c++, arrays, dynamic

您好，我在类中使用动态数组时遇到问题。我被指示“VectorDouble 类将有一个用于双精度动态数组的私有成员变量。” 我只是为这个程序编写头文件，但我还没有完成。一旦达到容量，这个类需要能够增加一倍的大小。这是我的代码：

```
#include <iostream>
using namespace std;

// VectorDouble class header file
class VectorDouble
{
    public:
    // constructor for an empty vector of type double
        VectorDouble();
    // constructor that take an int argument for an integer size of and array
        VectorDouble(int initial_size);
    // copy constructor
        VectorDouble(VectorDouble &object);
    // destructor to return dynamic memory to the freestore
        ~VectorDouble();
    // overloaded operator = for VectorDouble class
        VectorDouble& operator =(const VectorDouble &source);
    // overloaded operator == for VectorDouble class
        friend bool& operator ==(const VectorDouble &this_vector,
                                 VectorDouble &other_vector);
    // adds a new element at the end of the array
        void push_back();
    // returns allocated size of VectorDouble dynamic array
        int capacity();
    // returns used size of the VectorDouble object
        int size();
    // allocates a specified block of memory for specified number of double
    // type values
        void reserve(int new_reserve);
    // changes the size of the dynamic array
        void resize(int new_size);
    // returns the value at the specified index
        double value_at(int index);
    // changes the value at the specified index to double value d
        void change_value_at(double d, int index);

    private:

        int count;
        int max_count;
        int index_pointer;
        *index_pointer = new double[100]; 

}; 
```

我得到的错误都在这一行：*index_pointer = new double[100];

*   `new' 不能出现在常量表达式中

*   ISO C++ 禁止声明没有类型的“index_pointer”

*   ISO C++ 禁止初始化成员“index_pointer”

*   使 `index_pointer' 静态

*   非整数类型“int*”的静态数据成员的类内初始化无效

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T19:26:44.993

你的指针需要一个类型。将该行更改为

```
double* index_pointer; 
```

并在您的构造函数中添加该行

```
index_pointer = new double[100]; 
```

对于您的其他构造函数和赋值运算符，依此类推。

但这也是一个命名冲突，因为您有另一个名为 index_pointer 的私有 int 成员。我不确定该成员的用途，但是如果您确实需要它，那么您必须将其命名或将指针命名为其他名称。

记得`delete[] index_pointer;`在你的析构函数中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T19:27:33.220

你应该使用`std::vector<double>`.

# c# - 组合框不应该更新 ItemsSource

> ID：13480571
> 
> 赞同：0
> 
> 时间：2012-11-20T19:25:11.630
> 
> 标签：c#, .net, wpf, xaml

我有一个看起来像这样的组合框：

```
<ComboBox x:Name="cbGender"
            DisplayMemberPath="Value"
            ItemsSource="{x:Static patientObjects:Gender.GenderList}"
            SelectedIndex="0"
            SelectedItem="{Binding Encounter.Patient.Gender,
                                    Mode=TwoWay}"
            SelectedValuePath="Id"
            StaysOpenOnEdit="True" /> 
```

这一切都适用于正常使用。但是，当我从数据库中加载 Encounter.Patient.Gender 时，请清除该值。组合框的下一次使用已经用从数据库加载的值覆盖了我的 Gender.GenderList 中的顶部项目。（在我的复制示例中，未知被男性覆盖）。

我的 GenderList 是静态性别属性的 ObserverableCollection。这些属性中的每一个都由静态只读性别字段支持。

因为支持字段是只读的，所以我的猜测是该集合正在以某种方式更新引用。但我无法弄清楚如何使用这种绑定来完成......

**有什么猜测吗？**

更新：我尝试了以下没有效果：

1.  删除 SelectedIndex 和 SelectedValuePath
2.  向 GenderList 集合的集合添加事件已更改（未触发）。
3.  从 SelectedItem 中删除 TwoWay 模式
4.  将 Gender.GenderList 更改为`ReadOnlyObserveableCollection`.

# objective-c - 是否可以将枚举范围限定为 Objective-C 中的类？

> ID：13480574
> 
> 赞同：3
> 
> 时间：2012-11-20T19:25:20.507
> 
> 标签：objective-c, enums

我是 Objective-C 的新手，并试图找出枚举。有没有办法将枚举范围限定为一个类，以便另一个类可以使用这些值？像这样的东西：

```
@interface ClassA {
    typedef enum {
        ACCEPTED,
        REJECTED
    } ClassAStatus;
}
@end

@interface ClassB {
    typedef enum {
        ACCEPTED,
        REJECTED
    } ClassBStatus;
}
@end 
```

虽然这不起作用，但显然。还是有更好的方法来做枚举？

**编辑：**我想我的措辞不清楚，但我不是在问如何声明枚举。我知道将它们放在文件的顶部是可行的。我在问是否有办法确定它们的范围，因此这些值对整个文件来说不是全局的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T19:27:54.007

您必须为您的公共枚举添加前缀。只需将枚举定义放在类的标题中。

```
// ClassA.h
typedef enum {
    ClassAStatusAccepted,
    ClassAStatusRejected
} ClassAStatus;

@interface ClassA {
    ClassAStatus status;
}
@end

// ClassB.h
typedef enum {
    ClassBStatusAccepted,
    ClassBStatusRejected
} ClassBStatus;

@interface ClassB {
    ClassBStatus status;
}
@end 
```

这就是苹果的做法。

或者您可以使用新样式：

```
// UIView.h
typedef NS_ENUM(NSInteger, UIViewAnimationCurve) {
    UIViewAnimationCurveEaseInOut,         // slow at beginning and end
    UIViewAnimationCurveEaseIn,            // slow at beginning
    UIViewAnimationCurveEaseOut,           // slow at end
    UIViewAnimationCurveLinear
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T19:29:55.353

只需将`enum`右侧放在 .h 的顶部，就像 Apple 在 UITableView.h 中所做的那样，例如：

```
//
//  UITableView.h
//  UIKit
//
//  Copyright (c) 2005-2012, Apple Inc. All rights reserved.
//

#import <Foundation/Foundation.h>
#import <CoreGraphics/CoreGraphics.h>
#import <UIKit/UIScrollView.h>
#import <UIKit/UISwipeGestureRecognizer.h>
#import <UIKit/UITableViewCell.h>
#import <UIKit/UIKitDefines.h>

typedef NS_ENUM(NSInteger, UITableViewStyle) {
    UITableViewStylePlain,                  // regular table view
    UITableViewStyleGrouped                 // preferences style table view
};

typedef NS_ENUM(NSInteger, UITableViewScrollPosition) {
    UITableViewScrollPositionNone,
    UITableViewScrollPositionTop,    
    UITableViewScrollPositionMiddle,   
    UITableViewScrollPositionBottom
};                // scroll so row of interest is completely visible at top/center/bottom of view

typedef NS_ENUM(NSInteger, UITableViewRowAnimation) {
    UITableViewRowAnimationFade,
    UITableViewRowAnimationRight,           // slide in from right (or out to right)
    UITableViewRowAnimationLeft,
    UITableViewRowAnimationTop,
    UITableViewRowAnimationBottom,
    UITableViewRowAnimationNone,            // available in iOS 3.0
    UITableViewRowAnimationMiddle,          // available in iOS 3.2\.  attempts to keep cell centered in the space it will/did occupy
    UITableViewRowAnimationAutomatic = 100  // available in iOS 5.0\.  chooses an appropriate animation style for you
}; 
```

您可能认识其中的一些名称，但您可能不知道它们实际上是`enum`Apple 头文件中公共的一部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T22:24:43.423

只是想添加到我通常这样写的@DrummerB 的答案。camelCase 中的命名空间，然后是大写的常量。

```
typedef enum {
    ClassAStatus_ACCEPTED,
    ClassAStatus_REJECTED
} ClassAStatus; 
```

# html - 探索者阅读风格的问题

> ID：13480578
> 
> 赞同：0
> 
> 时间：2012-11-20T19:25:34.647
> 
> 标签：html, css, wordpress

大家好，我正在一个网站[http://www.prodjsoundlighting.com/](http://www.prodjsoundlighting.com/)上工作，并在 Chrome 中开发。现在，当您在 Firefox 和资源管理器中查看它时，它看起来很糟糕，更具体地说，当您将鼠标悬停在它上面时，侧导航会下降。如果您查看 firefox 或 ex，您会看到在样式表中已处理的列表旁边有方块，ul li ul 应该显示 none，因为它是在样式表中设置的. 顶部也有黑色背景，不应该在那里。它也应该是固定位置的，因为这是我定义的。

如果您能帮我一把，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:28:37.157

我觉得很好。我使用的是 Firefox，但在边栏中看不到任何列表项目符号。我没有正确理解你的问题吗？

# python - 跨列表连接断开的字符串 - Python

> ID：13480581
> 
> 赞同：0
> 
> 时间：2012-11-20T19:25:37.937
> 
> 标签：python, string, list

我刚开始用 Python 编程。我已将文本文件中的一些记录读入列表中，其中记录中的第四项是一个长字符串，有时跨越多行。例如，

```
[ *, *, *, TXT1]
[TXT2]
[TXT3]
[ *, *, *, TXT4]
[TXT5]
[ *, *, *, TXT6]
[ *, *, *, TXT7] 
```

如何从原始列表中创建一个新列表以便正确显示

```
[ *, *, *, TXT1+TXT2+TXT3]
[ *, *, *, TXT4+TXT5]
[ *, *, *, TXT6]
[ *, *, *, TXT7] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:36:17.600

假设您在此处有一个名为的列表列表`linelist`，如下所示`[[*,*,*,TXT1],[TXT2],[TXT3],[*,*,*,TXT4],...]`：

```
newoutput = []
for item in linelist:
   if len(item) == 1:
       newoutput[-1][-1] += item[0]
   else:
       newoutput.append(item) 
```

最后，您的输出将如下所示：

```
[
    [*,*,*,TXT1+TXT2+TXT3],
    ...
] 
```

正在使用：

```
>>> a
[['.', '.', '.', 'a'], ['b'], ['c'], ['.', '.', '.', 'd'], ['.', '.', '.', 'e']]

>>> newoutput = []
>>> for item in a:
...   if len(item) == 1:
...     newoutput[-1][-1] += item[0]
...   else:
...     newoutput.append(item)
...
>>> newoutput
[['.', '.', '.', 'abc'], ['.', '.', '.', 'd'], ['.', '.', '.', 'e']]
>>> 
```

# java - 比较 if 中的字符串：!string.equals("") vs !"".equals(string)

> ID：13480582
> 
> 赞同：4
> 
> 时间：2012-11-20T19:25:40.177
> 
> 标签：java

> **可能重复：**
> [这两个条件之间的区别？](https://stackoverflow.com/questions/13084049/difference-between-these-two-conditions)

我正在做一些代码清理，NetBeans 提出了更改建议

`if(!billAddress1.equals(""))`到`if (!"".equals(billAddress1))`.

两者之间有什么区别，以及使用建议版本相对于原始版本的可读性的优势？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T19:27:39.197

`billAddress1.equals("")``billAddress1`如果是，将导致 NullPointerException `null`，`"".equals(billAddress1)`不会。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T19:27:32.850

```
// Could cause a NullPointerException if billAddress1 is null
if(!billAddress1.equals(""))

// Will not cause a NullPointerException if billAddress1 is null
if (!"".equals(billAddress1)) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-20T19:27:39.043

`!"".equals(billAddress1)`永远不会导致`NPE`，因此它允许摆脱`billAddress1 == null`原本需要的 ，从而允许更紧凑的语法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-20T19:28:46.667

如果值为 null，则后者不会导致 Null 指针异常。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-20T19:32:01.500

正如其他人所指出的那样，一个可以将您从 NPE 中拯救出来。但是，如果您确定它不会为空，那么检查字符串是否为空的更好方法是使用该[`String.isEmpty()`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#isEmpty%28%29)方法，这就是代码似乎正在尝试做的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-20T19:29:03.427

第一个有可能导致 NullPointerException。

# php - 运行 make 时来自 homebrew 安装 php 的链接器错误

> ID：13480584
> 
> 赞同：0
> 
> 时间：2012-11-20T19:25:46.150
> 
> 标签：php, macos, installation, makefile, homebrew

我正在尝试使用 Homebrew 安装 php 和 php-cgi。

```
brew install https://github.com/ampt/homebrew/raw/php/Library/Formula/php.rb 
```

使用此方法会返回以下错误。

```
==> make
clang: clangerror: : linker command failed with exit code 1 (use -v to see invocation)error: 
linker command failed with exit code 1 (use -v to see invocation)
make: *** [sapi/cli/php] Error 1
make: *** Waiting for unfinished jobs....
make: *** [sapi/cgi/php-cgi] Error 1 
```

我更新了 Homebrew 和 XCode 命令行工具。给我的唯一警告`brew doctor`是在我的系统或 Homebrew 目录之外存在一些 Python“配置”脚本。

有谁知道可能是什么问题？在哪里可以找到更详细的错误消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:38:21.673

我不熟悉 ampt 水龙头，当我抓起 php 时，我使用了 josegonzalez 水龙头。你可以试试。

```
$ brew tap josegonzalez/homebrew-php 
```

您还可以通过使用 -vd 选项进行 brew install 来获取更多信息。

```
$ brew install -vd https://github.com/ampt/homebrew/raw/php/Library/Formula/php.rb 
```

我刚刚从 josegonzalez 取消链接我的 5.3.13 php 并运行上述命令。使用 -vd 我可以看到 ./configure 命令运行以及它的所有输出以及命令调用和编译器输出。唷，这需要一段时间才能建立。

这个输出对我来说确实失败了

```
==> cp ./php.ini-production /usr/local/Cellar/php/5.3.10/etc/php.ini
cp ./php.ini-production /usr/local/Cellar/php/5.3.10/etc/php.ini 
cp: /usr/local/Cellar/php/5.3.10/etc/php.ini: No such file or directory
/usr/local/Library/Homebrew/formula.rb:553:in `system 
```

看起来公式永远不会创建 ${prefix}/etc。我责怪公式。试试 josegonzalez 水龙头。

```
$ rm /Library/Caches/Homebrew/Formula/php.rb 
$ brew tap jozegonzalez/homebrew-php
$ brew install php53 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-29T20:38:23.947

作为对 homebrew-php 存储库的[评论](https://github.com/Homebrew/homebrew-php/issues/1931#issuecomment-125519721)，只需强制链接 libxml2

```
brew link libxml2 --force 
```

# java - JavaFX 2 WebView URL 监听器

> ID：13480586
> 
> 赞同：5
> 
> 时间：2012-11-20T19:26:02.710
> 
> 标签：java, javafx-2

使用 JavaFX (2.2) WebView 时，有没有办法在 java 代码中收听和处理 url？

例如：我正在使用 webEngine.loadContent(html) 将本地 HTML 文件加载到我的 WebView。HTML 包含资源，例如

```
<script src="local:my-script.js"></script>
<img src="cms:1234.png"/> 
```

这也是一个本地文件，应该从 java 应用程序中提供。所以我想注册一个可以处理来自页面的请求的监听器。

编辑：在 HTML 页面中加载的资源数据来自内容管理系统，因此使用相对路径不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T07:45:29.923

创建您自己的 URL 协议处理程序并使用以下命令安装它：

```
URL.setURLStreamHandlerFactory(new HandlerFactory()); 
```

[Java URL 协议处理程序的新时代文章](http://media.techtarget.com/tss/static/articles/content/dm_protocolHandlers/java_protocol.pdf)提供了有关创建处理程序的详细说明。

WebView 可以使用您的自定义协议来加载您的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:51:07.770

对您来说最简单的方法是`local:`在加载它之前用 html 中的运行时值替换资源。例如：

```
public class WebViewLocal extends Application {
    @Override
    public void start(Stage primaryStage) {
        String st = "<html><head><title>X</title>"
                + "</head><body><img src='local:1.jpg'/>"
                + "</body></html>";
        System.out.println(st);
        primaryStage.setScene(new Scene(loadHtml(st), 400, 400));
        primaryStage.show();
    }

    public WebView loadHtml(String html) {
        html = html.replace("local:", getClass().getResource(".").toString());
        WebView view = new WebView();
        view.getEngine().loadContent(html);
        return view;
    }

    public static void main(String[] args) { launch(); }
} 
```

注意：这是工作示例，只需将`1.jpg`图像放在与此文件相同的位置即可。

如果您*真的*想使用 javascript 中的 java 类，您可以使用“JavaFX 到 JavaScript 桥接”功能。看看这里的教程：[https ://blogs.oracle.com/javafx/entry/communicating_between_javascript_and_javafx](https://blogs.oracle.com/javafx/entry/communicating_between_javascript_and_javafx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T20:13:29.260

如果你在本地加载你的 html 文件，你可以简单地使用相对路径：

这是一个使用相关脚本加载 html 的示例。 [http://code.google.com/p/jfx-gap/source/browse/src/main/java/com/googlecode/jfxgap/JFXGap.java](http://code.google.com/p/jfx-gap/source/browse/src/main/java/com/googlecode/jfxgap/JFXGap.java)

诀窍应该是 html 中的相对路径。

# backbone.js - 使用骨干路由器跟踪网站上的 adwords 性能

> ID：13480589
> 
> 赞同：1
> 
> 时间：2012-11-20T19:26:12.183
> 
> 标签：backbone.js, google-analytics, google-ads-api

因此，我们刚刚重新启动了我们的网站，将其作为支持 Backbone 的单页应用程序，但我们正在使用 Google Analytics 跟踪我们从 AdWords 广告到网站的转化。

问题在于，为了让 Google Analytics（分析）跟踪用户来自 AdWords 的事实，它会查找 URL 中调用的 URL 查询参数`gclid`：

```
http://test.com/?gclid=(Q#kjsdf0INKJSDJF9 
```

但是，当 Backbone 的路由器初始化时，它会从 URL 中删除所有查询参数，因此当跟踪事件触发时，它不会看到用户来自 AdWords 广告。

我们尝试将用户发送到加载分析代码并等待事件触发然后将它们转发到站点的插页式页面，但是

1.  它丑陋，并在一段时间内向用户显示空白页面
2.  如果不等待 IE8 用户（遗憾地占我们用户群的 50%），则无法正常工作

我们联系了 Google 的 AdWords 帮助，看看我们是否可以手动将其提供`gclid`给 Analytics，他们的回答是

> 您应该聘请我们的一位顾问，他将弄清楚如何在您的网站上保留 URL 参数以使其正常工作，因为我们不支持手动设置`gclid`ID

（可悲的是只有一个非常小的释义。）

Google-fu 在这方面让我一片空白——很多人在 Google 论坛上提问，但没有答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:48:36.797

我不知道一切是如何设置的，但是 Backbone 可能没有将带有参数的 URL 视为匹配项，或者它知道的路由。实际上，您可以通过执行以下操作来测试...

```
unless Backbone.history.start(pushState: true)
  window.location = someDefaultURL; 
```

如果您只想要一种简单的方法来匹配路由与参数，这里有两种方法可以做到。

```
class MyRouter extends Backbone.Router
  routes:
    'test?*params': 'test'
    'testTwo?gclid=:gclid': 'testTwo'

  test: (params) ->
    console.log 'test route', params

  testTwo: (gclid) ->
    console.log 'test route two', gclid 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T20:52:15.543

所以这里的问题是我立即使用该`navigate`方法将条目推送到历史对象中。

这会（正确地）覆盖当前 URL 并且不保留 URL 参数（尽管如果可以的话会很好，我想这是我应该提出的拉取请求）。

通过不`navigate`立即调用，这允许 URL 参数在 URL 中停留足够长的时间以供 GA 看到它。

# javascript - javascript窗口位置获取要重定向到本地主机和实际域之间的网站路径

> ID：13480591
> 
> 赞同：0
> 
> 时间：2012-11-20T19:26:30.233
> 
> 标签：javascript, redirect, href

我希望能够在我的网站注销时将我的用户重定向回主页/登录名，如果我只是重定向到网站本身，这将很容易，IE`http://www.example.com/`但是，我如何确定我的网站的根文件夹路径当它在本地主机上时？

例如，我的一些网站位于：`localhost/folder1/websiteBackup/`一些位于：`localhost/`

将它组合起来的最佳方法是什么，这样一行代码既适用于本地主机又适用于域名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:30:15.933

使用相对路径而不是绝对路径。例如，而不是

```
/somePage.html 
```

你可能会写

```
../../somePage.html 
```

如果脚本是共享的，并且您不知道它相对于页面的位置，请考虑在单独`<VirtualHost>`的 s 上开发，以便您的环境匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T20:22:24.460

我建议使用一些服务器端会话变量（PHP/ASP）并为它们分配根路径。那么您可以随时使用它们。

```
session("rootPath") = "/RootFolder/your-filename" (for ASP/VBScript) 
```

稍后在您的 JS 代码中使用它们来重定向。

```
var path = '<%= session("rootPath")%> (JS code)'; 
```

检查我在此处询问的类似问题，以获取有关相对路径、相对根路径和绝对根路径的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:31:47.370

这对我有用..试试你的运气

```
 url:'<%=VirtualPathUtility.ToAbsolute("~/Include/ctnrls/Data.aspx") %>', 
```

但我在 IIS 中映射我的虚拟路径

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T19:32:13.210

```
document.location = 
    document.location.href.indexOf('localhost') >=0 ?
    document.location.href.split('localhost')[1] + 'index.htm' : 
    'index.htm'; 
```

# iis - Mac 版 Safari 上的 Facebook 应用 iframe 证书问题

> ID：13480599
> 
> 赞同：2
> 
> 时间：2012-11-20T19:26:59.717
> 
> 标签：iis, iis-7, https, safari, ssl-certificate

我在 Safari for MAC 上使用 facebook iframe 应用程序时遇到了证书问题 - “网站需要客户端证书”（截图：http: [//imgur.com/aslls](http://imgur.com/aslls)）整个网站使用的协议是 HTTPS，我们在 Windows 服务器上使用 IIS 7 托管我们的网站。

我们仅在我们的 facebook iframe 应用程序上遇到此问题。我们有一个有效的 GoDaddy 颁发的证书，它可以在除 Safari 之外的所有浏览器上正常工作。

关于这里可能出现什么问题的任何想法？我尝试用谷歌搜索这个问题，但没有发现任何有用的东西。

谢谢！

# sql-server - 将 Delphi 连接到 SQL 数据库

> ID：13480604
> 
> 赞同：1
> 
> 时间：2012-11-20T19:27:07.693
> 
> 标签：sql-server, delphi, sql-server-2008r2-express

我正在使用 Microsoft SQL Server R2 Express 创建数据库。

当我尝试使用 delphi 连接到数据库时，我必须使用此连接字符串：

```
ADOConnection1.ConnectionString := 'Provider=SQLOLEDB.1;Integrated Security=SSPI;Initial Catalog=db_formation;Data Source=EVILKID-pc\evilkid;'; 
```

其中“EVILKID-PC\evilkid”是我的电脑的名称， ![在此处输入图像描述](../Images/cbfd65363cdc45610981c520b487ffab.png)

如您所见，这仅适用于我的PC。我应该怎么做才能连接到本地主机？我尝试将“数据源”更改为“本地主机”，但它无法连接，我会得到：

`[DBNETLIN][ConnectionOpen(Connect()).]SQL Server does not exist or access denied`

知道问题出在哪里吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T19:51:35.860

即使您的实例位于本地主机上，它仍然是您需要在连接字符串中指定的命名实例：

```
ADOConnection1.ConnectionString := '... Data Source=localhost\evilkid;'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T20:58:21.270

有几种方法可以解决这个问题。正如迈克尔所说，使用配置文件。其他可能的方法是使用 DSN 访问数据库。如果它始终是 localhost/machinename，您可以使用任意数量的方法检索机器名称。我在一些较旧的项目中使用 TtvAPIThing，JEDI 有一个系统信息组件可以让访问这些更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T22:22:39.363

我会在您 PC 上的本地应用程序数据路径中创建一个 UDL 文件 (Connection.UDL)，并让应用程序中的连接字符串使用它

```
Var
  plainAppName : String;
  appDataPath : String;

Begin
  plainAppName := ChangeFileExt(ExtractFilePath(ParamStr(0)),'.EXE','');
  appDataPath := IncludeTrailingBackslash(GetSpecialFolderLocation(CSIDL_APPDATA))+plainAppName+'\';
  ADOConnection.Connectionstring := 'FILE NAME = '+appDataPath+'Connection.UDL'; 
```

Connection.UDL 包含

```
[oledb]
; Everything after this line is an OLE DB initstring
Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;Initial Catalog=test;Data Source=YourPC\InstanceName 
```

事实上，它可能是空的。但是，您（或客户）双击该文件，将打开 oleDB 连接对话框。现在设置服务器、实例、登录凭据、测试连接并保存。

完毕。

您的应用程序将打开文件（好吧，ADOConnection 将打开），您就安全了。

另一种更通用的方法是将服务器 pc 的 IP/名称简单地存储在 INI 文件中并在代码中替换它

```
CONST
  adoStr = 'Provider=SQLOLEDB.1;Integrated Security=SSPI;'
          +'Persist Security Info=False;Initial Catalog=test;'
          +'Data Source=%s';

ADOConnection.ConnectionString := Format(adoStr,[TheIPOrNameOfThePC]);
... 
```

# matlab - Matlab：查找单元格中重复次数最多的值（修订版）

> ID：13480606
> 
> 赞同：3
> 
> 时间：2012-11-20T19:27:11.640
> 
> 标签：matlab, mode, cell-array

对我的代码 idxcell{:,1} 进行 1:10 迭代给出以下结果：

```
ans =
         9    10    14    15    19    20    24    25
    ans =
      Columns 1 through 13
         7     8    11    12    13    14    16    17    18    19    21    22    23
      Column 14
        24
    ans =
        13    14    15    18    19    20    23    24    25
    ans =
         6     7    11    12    16    17    21    22
    ans =
        16    17    21    22
    ans =
         6     7    11    12    13    16    17    21
    ans =
         4     5     8     9    10    13    14    15    19    20
    ans =
         4     5     8     9    10    14    15
    ans =
        11    12    13    14    16    17    18    19    21    22    23    24
    ans =
         1     2     3     6     7     8    11    12    13 
```

我怎样才能获得这些单元格元素的重复值最多的值（我认为那个范式是'14'）？我不想只索引它的值。我努力了

```
idxcell{:,1}
temp = idxcell{:,1};
M = mode(temp) 
```

但只得到了第一个单元格的结果，我不确定 mode() 是我必须用于我的目的。

* * *

**这是由[angainor](https://stackoverflow.com/users/1644189/angainor)回答的：** `mode([idxcell{:}])`

* * *

**修订：**是否可以一次搜索所有单元格数组/行进行 i 次迭代，以找到重复次数最多的值并对结果进行排序，重复次数最多的结果在单元格数组或矩阵中按降序排列？

* * *

|在[angainor的](https://stackoverflow.com/users/1644189/angainor)提示后由我回答：`Sort = sort([idxcell{:}])`

* * *

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T19:36:03.747

如果我理解正确，您需要在调用之前将所有单元向量连接成一个`mode`

```
mode([idxcell{:}])
ans =

13 
```

如果要获取所有单元格出现频率最高的值，可以使用`cellfun`

```
cellfun(@mode, idxcell)
ans =

 9    10    14    15    19    20    24    25 
```

# ios - 有没有人在后台线程中使用 ALAssetsLibrary 时遇到过崩溃？

> ID：13480611
> 
> 赞同：8
> 
> 时间：2012-11-20T19:27:31.360
> 
> 标签：ios, ios6, alassetslibrary

我有一个 ios 应用程序，它在 ios 5 上没有以这种方式崩溃，现在在 4 或 5 个 bg/fg 周期后启动时，它在 ios 6 上一直崩溃。我已将问题追溯到我对 ALAssetsLibrary enumerateGroupsWithTypes 的调用（应用程序在启动时会同步到底层照片库）。对 enumerateGroupsWithTypes 的调用是在通过调度队列调用的后台线程中进行的，因此即使用户在完成之前将应用程序发送到 bg，同步代码也可以完成。我收到的崩溃消息总是一样的：

*** __addContextToList_block_invoke_0() 中的断言失败，/SourceCache/PhotoLibraryServices/MobileSlideShow-1647.5/Sources/PLManagedObjectContext.m:1305

和

***由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“上下文太多。contextList 中没有空格。

谷歌搜索这些错误消息并没有产生任何结果。由于在应用程序至少循环打开/关闭 5 次之前不会发生这种情况，我想也许这些块在完成时没有从苹果数据结构中正确删除？提前感谢任何线索。

更新：经过更多调查，这似乎与同步 ALAssetsGroupLibrary 有关。当我只同步 ALAssetsGroupSavedPhotos 或 ALAssetsGroupLibrary 中有 0 张照片时，不会发生崩溃。如果我只同步 ALAssetsGroupLibrary 并且其中至少有 1 张照片，就会发生这种情况。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T17:29:29.293

事实证明，这都与为每个同步重新分配 ALAssetsLibrary 有关。通过添加一个成员变量，崩溃似乎已经消失了。

assetsLibrary = [[ALAssetsLibrary alloc] init];

虽然这显然是我的代码更有效/更好的设计，但我想说我遇到的问题表明 ALAssetsLibrary 和线程存在一些 ARC 问题。确保只分配一次！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T08:06:24.760

我遇到了同样的问题：

简而言之：当`ALAssetsLibrary`实例枚举类型或`ALAssetsGroup`上一步枚举的实例正在枚举资产时，在所有枚举块完成之前，不应更改`ALAssetsLibrary`实例和实例。`ALAssetsGroup`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-10T03:59:41.973

ALAssetsLibrary 枚举在主线程中运行（请参阅[此 SO 答案](https://stackoverflow.com/a/6700742/147508)）。我怀疑这是因为资产库可能希望与用户交互以获得使用位置数据的权限（因为照片具有地理标记）。

如果您的代码假定 ALAssetsLibrary 将继续在后台线程中运行，这可能是您的问题的根源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-21T10:45:02.550

你可以签出这个。我以前有这个问题。但是通过创建一个单例 ALAssetsLibrary 对象来解决它

[https://stackoverflow.com/a/32693118/3103450](https://stackoverflow.com/a/32693118/3103450)

# bash - 在 shell 和 TCL 之间调用函数时需要帮助

> ID：13480618
> 
> 赞同：1
> 
> 时间：2012-11-20T19:27:47.790
> 
> 标签：bash, function, shell, tcl

是否可以在 tcl 脚本中调用实际上在另一个 shell 脚本中定义的函数？例如，

我的 shell 脚本函数是

```
add ()
{
 `a=$1
 b=$2
 c=`expr $a + $b`
`} 
```

如何在 tcl 文件中调用此函数？请指导我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:08:57.270

除了几种方式外，实际上不可能从 Tcl 调用用另一种语言编写的函数。例如，如果 C 函数符合 Tcl 的命令定义签名，或者存在某些胶合代码（例如可能使用 SWIG 或 Critcl 生成），则可以调用该函数。调用代码的另一种方法是在另一个进程中调用它，通常是子进程。然后可以像这样在 shell 脚本中运行命令（假设您的函数定义在 中`my_script.sh`）：

```
exec /bin/sh -c ". my_script.sh; add 123 456; echo \$c" 
```

但这相当笨拙，并且在处理更复杂的输入值时容易引起问题。我建议将你的脚本变成一个可以更直接运行的完整程序（这样你就可以这样做`exec my_script.sh 123 456`），或者更好的是，用其他语言编写它，它比 Unix shell 具有更少的神秘陷阱（即，大多数语言！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T12:39:59.070

如果您的要求是在执行某些功能后从 shell 脚本中获取任何返回值，我建议您使用这种方法，

--> 在单独的文件中定义每个函数，并尽可能在 shell 脚本中将返回值写入 /tmp 目录中的某个文件。

文件名 :: add.sh :::::::::::赋予它执行权限

```
function add ()
{
 a=$1
 b=$2
 c=`expr $a + $b
echo $c > /tmp/arg1
}

add $1 $2 
```

:::::::::::::::::::::::::::::::::::

现在打开 tclsh ，

```
[root@localhost test]# tclsh
%
% ./add.sh 2 3
% set fp [open /tmp/arg1]
file3
% set value [read $fp]
5

% close $fp
% set value
5

% ^C
[root@localhost test]# 
```

# javascript - 在 HTML 页面上添加更多文件

> ID：13480619
> 
> 赞同：0
> 
> 时间：2012-11-20T19:27:48.623
> 
> 标签：javascript, html, ruby-on-rails-3, file

我见过一些网站，其中有一个框供用户浏览要上传的文件，然后是“添加更多文件”链接。当用户单击链接时，会出现另一个框，允许用户选择另一个文件。用户可以点击“添加更多文件”继续添加框。他们怎么做到的？

我使用 Ruby on Rails 作为我的后端。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:34:15.683

```
<div id="filePickers">
  <input type="file" name="files[]">
  <input type="file" name="files[]">
  <input type="file" name="files[]">
</div> 
```

`params[:files]`当发布到您的服务器时，它将显示为一组文件。

如果您想要更多，请将一些 Javascript 绑定到某处的按钮以添加新输入。

```
// jQuery for brevity
$('#filePickers').append('<input type="file" name="files[]">'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:32:51.687

这是一个 HTML5“拖放上传”，基于两个 HTML5 API：

*   [HTML5 拖放 API](http://www.w3.org/TR/html5/editing.html#dnd)
*   [文件 API](http://www.w3.org/TR/FileAPI)

[您可以在此处](http://www.thebuzzmedia.com/html5-drag-and-drop-and-file-api-tutorial/)找到手动实现它的教程

但是您宁愿使用已经实现它的库，例如[jquery-filedrop](https://github.com/weixiyen/jquery-filedrop)

# java - 用于软件的 Java Swing GUI，最好的方法

> ID：13480620
> 
> 赞同：2
> 
> 时间：2012-11-20T19:27:49.987
> 
> 标签：java, swing, user-interface, awt

我需要为带有登录面板的程序创建一个 GUI，该面板将在设置登录后显示真实软件。

所以问题是：

我应该创建两个框架并显示第一个用于登录，第二个用于程序吗？还是在程序启动时添加两个不同的面板并隐藏登录更好？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T19:39:10.273

这有点主观。对我来说，这将归结为应用程序的复杂程度以及您是否需要支持多个会话以及这些会话是否共享一个框架。

如果您的应用程序相对简单（例如有一个或两个视图），我认为它可以使用类似 a 的东西，[`CardLayout`](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)并在主应用程序框架内简单地显示登录窗格，当用户成功通过身份验证时，切换到主视图。

如果应用程序更复杂，我会考虑使用单独的对话框。

即使您允许用户进行多个会话，也取决于实际应用程序的复杂程度（恕我直言），我是否会使用单独的对话框。

我还会考虑用户在登录之前是否可以做任何事情，例如，他们可以更新设置吗？如果是这样，使用面板将是合适的，因为登录对话框很可能是模态的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T19:41:00.587

就我个人而言，我会先为实际程序创建一个 jFrame，然后（立即）打开一个 jDialog 窗口并在你的 jFrame 前面打开它。jDialog 类有一个方便的属性，当它打开时，您无法在其他框架上执行操作。所以必须先关闭它（经过一些操作，比如填写密码）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T21:27:29.037

使用框架的[GlassPane](http://docs.oracle.com/javase/tutorial/uiswing/components/rootpane.html)是一种选择（假设您不需要使用下拉菜单）。有人可能会说这是对窗格系统的滥用，但如果登录屏幕足够简单，我认为它是合法的。

好处是它已经可供您使用（它不需要对您的应用程序进行重大更改），并且它会吃掉任何事件（因此它们不会传递给实际的应用程序）。它也很容易显示/隐藏。

缺点是一些摆动组件在玻璃窗格上不起作用（JComboBox 就是一个例子）。

下面是使用 GlassPane 的示例：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class QuickTest {

    public QuickTest(){
        //Setup Frame
        final JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);       
        frame.pack();
        frame.setSize(400, 300);
        frame.setLocationRelativeTo(null);

        //Setup Main Content
        JPanel main = new JPanel();
        main.add(new JLabel("Here's the application!"));
        frame.setContentPane(main);

        //Setup login Screen
        Box login = new Box(BoxLayout.Y_AXIS){
            // Makes the main screen faded
            public void paintComponent(Graphics g){
                g.setColor(new Color(255,255,255,200));
                g.fillRect(0,0, getWidth(), getHeight());
                super.paintComponent(g);
            }
        };
        login.add(new JLabel("Username here:"));
        login.add(new JLabel("Password here:"));
        JButton loginButton = new JButton("login");
        loginButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                frame.getGlassPane().setVisible(false);
            }
        });
        login.add(loginButton);
        login.add(Box.createVerticalGlue());
        frame.setGlassPane(login);
        frame.getGlassPane().setVisible(true);

        //Show Frame
        frame.setVisible(true);

    }

    public static void main(String[] args){
        new QuickTest();
    }
} 
```

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-11-20T19:39:37.687

您创建一个登录页面并使用会话启用检查用户权限。如果用户被识别，那么您可以重定向到另一个页面。

# ruby-on-rails - Rails：在选择表单助手中指定排序顺序

> ID：13480624
> 
> 赞同：2
> 
> 时间：2012-11-20T19:28:10.427
> 
> 标签：ruby-on-rails, sorting, html-select, form-helpers

我正在使用 Rails`select()`表单助手来生成`<select>`结构。以下行有效，但会导致未排序的列表。如何将排序顺序更改为字母升序？

```
<%= select('category', 'name', Category.all.collect { |category| [ category.name ] }) %> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T19:44:40.857

您应该使用 Rails 3 方式：

```
<%= select('category', 'id',
            Category.order('name ASC').all.map{ |c| [c.name, c.id] }) %> 
```

这将为每个类别生成 HTML 选项，如下所示：

```
<option value="1">CategoryName</option> 
```

其中值是类别 ID 而不是其名称：

您将得到一个包含类别名称的字符串，`params[:category_id]`而不是。`params[:category]`然后要在数据库中找到一个类别，最好使用一个 id（因为它们是唯一的，不像名称）而且它更快！

# python - Python StringIO - 有选择地将数据放入标准输入

> ID：13480632
> 
> 赞同：1
> 
> 时间：2012-11-20T19:28:41.067
> 
> 标签：python, stdin, stringio

我们使用了一些我们没有源代码的编译 python 代码。代码提示用户输入，我们正在尝试自动化该部分。

基本上会询问用户名、密码，然后根据特定情况询问一些不同的问题。我不知道编译后的函数是否使用 raw_input、input 或其他东西。

我已经能够使用 StringIO 用用户名和密码替换 stdin，我可以用我自己的类替换 stdout 并找出出现的提示，但是在有选择地将数据放入基于 stdin 时我很难过关于我从标准输出中读到的内容。

```
import sys
import re
from StringIO import StringIO

def test():
    overwrite = raw_input("The file exists, overwrite? ")
    notify = raw_input("This file is marked for notifies.  Notify?")
    sys.stdout.write("Overwrite: %s, Notify: %s" % (overwrite,notify))

class Catcher(object):
    def __init__(self):
        pass

    def write(self, msg):
        if re.search("The file exists, overwrite", msg):
            # put data into stdin 
        if re.search("The file is marked for notification", msg):
            # put data into stdin

sys.stdout = Catcher()
test() 
```

我不能只预加载一个 StringIO 对象，因为问题可能会因情况而异，但我需要自动输入标准输入，因为他们试图将其放入自动构建系统中，因此他们将提供默认值通过命令行回答出现的任何问题。

如果我在调用编译函数之前将 stdin 设置为一个空的 StringIO 对象，那么它只会出现 EOF 错误 - 不知道如何让它等待输入。

像这样的东西：

```
import sys
import re
from StringIO import StringIO

def test():
    overwrite = raw_input("The file exists, overwrite? ")
    notify = raw_input("This file is marked for notifies.  Notify?")
    sys.__stdout__.write("Overwrite: %s, Notify: %s" % (overwrite,notify))

class Catcher(object):
    def __init__(self, stdin):
        self.stdin = stdin

    def write(self, msg):
        if re.search("The file exists, overwrite", msg):
            self.stdin.write('yes\n')
        if re.search("The file is marked for notification", msg):
            self.stdin.write('no\n')

sys.stdin = StringIO()
sys.stdout = Catcher(sys.stdin)
test() 
```

产生：

```
Traceback (most recent call last):
  File "./teststdin.py", line 25, in <module>
    test()
  File "./teststdin.py", line 8, in test
    overwrite = raw_input("The file exists, overwrite? ")
EOFError: EOF when reading a line 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T19:54:54.540

如果您想从`StringIO`刚写过的内容中读取内容，则必须先将其倒回开始写入的位置。
此外，您的第二次搜索测试错误的字符串。

这应该有效：

```
import sys
import re
from StringIO import StringIO

def test():
    overwrite = raw_input("The file exists, overwrite? ")
    notify = raw_input("This file is marked for notifies.  Notify?")
    sys.__stdout__.write("Overwrite: %s, Notify: %s" % (overwrite,notify))

class Catcher(object):
    def __init__(self, stdin):
        self.stdin = stdin

    def write(self, msg):
        if re.search("The file exists, overwrite?", msg):
            self.stdin.truncate(0)
            self.stdin.write('yes\n')
            self.stdin.seek(0)
        if re.search("This file is marked for notifies.  Notify?", msg):
            self.stdin.truncate(0)
            self.stdin.write('no\n')
            self.stdin.seek(0)

sys.stdin = StringIO()
sys.stdout = Catcher(sys.stdin)
test() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:40:46.033

这是一个完全避免的解决方案`StringIO`：

```
import sys
import re

class Catcher(object):
    def __init__(self, handler):
        self.handler = handler
        self.inputs = []

    def __enter__(self):
        self.__stdin  = sys.stdin
        self.__stdout = sys.stdout
        sys.stdin = self
        sys.stdout = self

    def __exit__(self, type, value, traceback):
        sys.stdin  = self.__stdin
        sys.stdout = self.__stdout

    def write(self, value):
        result = self.handler(value)
        if result:
            self.inputs = [result] + self.inputs

    def readline(self):
        return self.inputs.pop() 
```

用作：

```
def test():
    overwrite = raw_input("The file exists, overwrite? ")
    notify = raw_input("This file is marked for notifies.  Notify?")
    sys.__stdout__.write("Overwrite: %s, Notify: %s" % (overwrite,notify))

@Catcher
def exist_notify(msg):
    if re.search("The file exists, overwrite", msg):
        return 'yes'
    if re.search("This file is marked for notifies", msg):
        return 'no'

with exist_notify:
    test() 
```

# javascript - Javascript VAR 和 HREF

> ID：13480633
> 
> 赞同：-1
> 
> 时间：2012-11-20T19:28:41.043
> 
> 标签：javascript, html, href

我的捐款表格中有该人希望捐款的金额：

```
<input type="number" id="quantity" min="<?php echo $minimum_donation; ?>"
 max="100" onchange="changeDonation()"> 
```

在此之下，我有实际的捐赠按钮：

```
<a href="<?php echo $paypal_redirect;?>" 
onclick="location.href=this.href+donation;return false;"> 
```

为了使它工作，我在标题中有这个 javascript：

```
function changeDonation()
{
var donation = document.getElementById("quantity").value;
} 
```

我怎样才能使这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:34:16.810

如果您只是将捐赠值提交到另一个页面，则不需要 JavaScript：

```
<form action='<?php echo $paypal_redirect;?>' method='post'>
    <input type="number" id="quantity" min="<?php echo $minimum_donation; ?>" max="100">
    <button type='submit'>Donate</button>
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:32:57.247

在您的`changeDonation()`中，`donation`变量是本地的。意思是，它只存在于该函数内部。

我建议让该函数返回捐赠，而不是尝试更新变量。

```
function changeDonation(){
    return document.getElementById("quantity").value;
} 
```

更改您的 HTML；

```
<input type="number" id="quantity" min="<?php echo $minimum_donation; ?>" max="100" />
<a href="<?php echo $paypal_redirect;?>" onclick="location.href=this.href+changeDonation();return false;"> 
```

# processing - 加工中画线时如何防止伪影

> ID：13480635
> 
> 赞同：1
> 
> 时间：2012-11-20T19:28:41.677
> 
> 标签：processing

我在处理中绘制了一些生成的形状。只是一对贝塞尔曲线，它们的点由对其施加重力的点控制。

问题是我的线条正在形成伪影，它们不清晰流畅。这只是我的图纸大小的问题吗？任何帮助将不胜感激，我已经上传了一个示例图像，您可以在其中看到一些奇怪的东西。

![工件示例](../Images/f0659297168ee36960e8130d27a3dc7f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:53:33.487

这看起来很酷。[如果你想要更清晰的线条](http://processing.org/reference/smooth_.html)，你应该在`setup()`. 我在 Processing 2.0+ 中看到，您还可以在一定程度上控制平滑度。

我不是 100% 确定你的意思

> 线条正在形成伪影

但除非它是smooth() 将修复的线条的抗锯齿，否则那将是[Moiré 模式](http://en.wikipedia.org/wiki/Moir%C3%A9_pattern)。

# php - 在php函数中过滤syslog，然后在JS div中显示内容？

> ID：13480642
> 
> 赞同：3
> 
> 时间：2012-11-20T19:29:18.917
> 
> 标签：php, javascript, ajax, regex, syslog

让我们用一种新方法来修改这个问题……我有三个文件：logtail.php、ajax.js 和 index.php。我的目标是创建一个系统日志查看器（Linux）。

在 index.php 上，我创建了一个 div，我只想显示过滤后的 syslog 内容。我必须过滤 logtail.php 中的内容。我必须使用 shell_exec 和 | 使用多个不同的正则表达式 grep 内容。现在我| grep 整个 syslog 文件，它会在日志查看器中实时显示，但我的过滤器没有按计划工作。

我需要帮助弄清楚如何使用 $_GET 仅从系统日志中获取用户想要查看的内容。我的 index.php 文件中有一个为此准备的文本字段和提交按钮。我应该使用函数（已经尝试过）吗？还是有更好的方法？你能给我一些例子吗？

logtail.php

```
//Executes a shell script to grab all file contents from syslog on the device
//Explodes that content into an array by new line, sorts from most recent entry to oldest entry

if (file_exists($filename = '/var/log/syslog')) {
    $syslogContent = shell_exec("cat $filename | grep -e '.*' $filename");
    $contentArray = explode("\n", $syslogContent);
    rsort($contentArray);
    print_r($contentArray);
} 
```

ajax.js（正常工作）

```
function createRequest() {
    var request = null;
    try {
        request = new XMLHttpRequest();
    } catch (trymicrosoft) {
        try {
            request = new ActiveXObject("Msxml2.XMLHTTP");
        } catch (othermicrosoft) {
            try {
                request = new ActiveXObject("Microsoft.XMLHTTP");
            } catch (failed) {
                request = null;
            }
        }
    }

    if (request == null) {
        return alert("Error creating request object!");
    } else {
        return request;
    }
}

var request = createRequest();

function getLog(timer) {
    var url = 'logtail.php';
    request.open("GET", url, true);
    request.onreadystatechange = updatePage;
    request.send(null);
    startTail(timer);
}

function startTail(timer) {
    if (timer == "stop") {
        stopTail();
    } else {
        t = setTimeout("getLog()",1000);
    }
}

function stopTail() {
    clearTimeout(t);
    var pause = "The log viewer has been paused. To begin viewing again, click the Start Log button.\n";
    logDiv = document.getElementById("log");
    var newNode = document.createTextNode(pause);
    logDiv.replaceChild(newNode,logDiv.childNodes[0]);
}

function updatePage() {
    if (request.readyState == 4) {
        if (request.status == 200) {
            var currentLogValue = request.responseText.split("\n");
            eval(currentLogValue);
            logDiv = document.getElementById("log");
            var logLine = ' ';
            for (i = 0; i < currentLogValue.length - 1; i++) {
                logLine += currentLogValue[i] + "<br/>\n";
            }
            logDiv.innerHTML = logLine;
        } else
            alert("Error! Request status is " + request.status);
    }
}

index.php

    <script type="text/javascript" src="scripts/ajax.js"></script>
        <button style="margin-left:25px;" onclick="getLog('start');">Start Log</button>
        <button onclick="stopTail();">Stop Log</button>
            <form action="" method="get"> //This is where the filter options would be
                Date & Time (ex. Nov 03 07:24:57): <input type="text" name="dateTime" />
                <input type="submit" value="submit" />
            </form>
    <br>
    <div id="log" style="...">
    //This is where the log contents are displayed
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:59:40.910

我会比简单的池更进一步。我会将日志通过管道传输到某个脚本。让我们说信息日志

```
 *.info                        |/somescript.php 
```

在这里，我将实时使用[Strophe](http://strophe.im/)和[Php XMPP](http://code.google.com/p/xmpphp/)。

告诉我你的想法？

# ruby-on-rails - 如何在rails helper中格式化小数点后2位

> ID：13480643
> 
> 赞同：0
> 
> 时间：2012-11-20T19:29:21.877
> 
> 标签：ruby-on-rails, decimal, currency, helper

我正在尝试将数字格式化为 Rails 助手（app/helpers/emails_helper.rb）中的货币或小数点后 2 位

```
module EmailsHelper
  def email_message(invoice)
    message = "PO: #{invoice.po_number}\nAmount: #{number_to_currency(invoice.total)}"
    return message
  end
end 
```

当我尝试这个时，我收到以下错误：

```
undefined method `number_to_currency' for #<EmailsController:0x00000102b88640> 
```

我假设这是因为文件是 rb 而不是 erb 但不确定如何处理。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T19:39:10.880

尝试导入`NumberHelper`模块：

```
module EmailsHelper
  include ActionView::Helpers::NumberHelper
  ...
end 
```

# c# - Jquery Ajax 调用 C# Web 服务错误

> ID：13480652
> 
> 赞同：0
> 
> 时间：2012-11-20T19:30:07.323
> 
> 标签：c#, jquery, ajax, iis-7

我正在尝试使用 jQuery 对位于同一网站下的 C# Web 服务进行 AJAX 调用。无论我找到/尝试什么，我都会不断收到 500 错误：

```
Request format is unrecognized for URL unexpectedly ending in '/MyTest'. 
```

**来自网页的 jQuery AJAX 调用**

```
 $.ajax({
        type: "POST",
        url: 'http://172.1.1.10/MYService/MyService.asmx/MyTest',
        data: "{}",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (data) {
            alert(data);
        },
        error: function (data, errorThrown) {
            alert("Fail");
            alert(errorThrown);
        }
    }); 
```

**Web 服务 (MyService.asmx) 代码背后**

```
[WebMethod]
[ScriptMethod(ResponseFormat = ResponseFormat.Json)]
public string MyTest()
{
    return "Hello World";
} 
```

是的，我在顶部未注释以下内容：

```
[System.Web.Script.Services.ScriptService] 
```

当我尝试加载我的网页时，我收到“失败”的警报窗口。这是我收到 500 错误的时候（见帖子顶部）。

太多人建议将此添加到 Web 服务的 web.config 中：

**网络服务 (Web.config)**

```
<configuration>
  <system.web>
    <webServices>
      <protocols>
        <add name="HttpGet"/>
        <add name="HttpPost"/>
      </protocols>
    </webServices>
  </system.web>
 </configuration> 
```

添加后，我可以使用以下地址访问本地计算机：

```
http://172.1.1.10/MYService/MyService.asmx/MyTest 
```

我得到了“Hello World”的正确响应。在添加之前，我会在本地收到相同的 500 错误消息。

Web 服务和网站都设置在同一个 IIS 实例上，每个实例都作为自己的应用程序，位于 IIS 中的同一个网站下。我知道这不是跨域问题，因为如果这是真的，我没有收到您通常会收到的 503 错误，也没有收到 File Not Found 的 404 错误。

我在网上搜索过，似乎找不到解决办法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:01:57.787

由于它说请求格式无法识别，因此您不需要在 ajax 调用中发送数据。尝试从 ajax 调用中删除数据字段 data:"{}" 看看是否有效。只需使用：

```
 $.ajax({
    type: "POST",
    url: 'http://172.1.1.10/MYService/MyService.asmx/MyTest',
    dataType: "json",
    success: function (data) {
        alert(data);
    },
    error: function (data, errorThrown) {
        alert("Fail");
        alert(errorThrown);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T15:45:50.260

感谢 nick_w，使用 Chrome 的控制台功能为我提供了以下错误：

```
XMLHttpRequest cannot load http://172.1.1.10/MYService/MyService.asmx/MyTest. Origin http://mydomain.mysitename.com is not allowed by Access-Control-Allow-Origin. 
```

我发现当我浏览我的网站时，我使用的是域名：

```
http://mydomain.mysitename.com 
```

而当我在代码中调用 Web 服务时，我使用的是 IP 地址：

```
http://172.1.1.10 
```

因此，我在技术上遇到了跨域问题。一旦我在 IP 地址上访问了我的网站，或者将 web 服务调用更改为：

```
http://mydomain.mysitename.com/MyService/MyService.asmx/MyTest 
```

然后解决就好了。我确实需要更新我的代码：

```
$.ajax({
    type: "POST",
    url: 'http://mydaomin.mysitename.com/MYService/MyService.asmx/MyTest',
    data: "{}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function (data) {
        alert(data.d);
    },
    error: function (data, errorThrown) {
        alert("Fail");
        alert(errorThrown);
    }
}); 
```

请注意，我在警报中添加了“.d”，因为它返回的是“对象对象”而不是结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-27T07:32:19.210

您可以在服务中添加全局类并在`Application_BeginRequest`函数中添加以下代码：

```
HttpContext.Current.Response.AddHeader("Access-Control-Allow-Origin", "*");
if (HttpContext.Current.Request.HttpMethod == "OPTIONS")
{
    //These headers are handling the "pre-flight" OPTIONS call sent by the browser
    HttpContext.Current.Response.AddHeader("Access-Control-Allow-Methods", "GET, POST");
    HttpContext.Current.Response.AddHeader("Access-Control-Allow-Headers", "Content-Type, Accept");
    HttpContext.Current.Response.AddHeader("Access-Control-Max-Age", "1728000");
    HttpContext.Current.Response.End();
} 
```

# python - 创建重复的圆圈x和y轴python

> ID：13480654
> 
> 赞同：1
> 
> 时间：2012-11-20T19:30:23.933
> 
> 标签：python, python-3.x, python-2.7

我希望在 python 中生成这种模式：

![红色圆圈和半圆形](../Images/ae3d37908967d3f417561ae86fb56ef8.png)

这是我生成的代码，它生成了 5 个完整的圆圈：

```
def fdShape():
    win = GraphWin("pdShape",200,200)
    centre = Point(20,100)
    for x in range(5):
        circle = Circle(centre, 20)
        circle.setFill("red")
        centre = Point((centre.getX() + 40),100)
        circle.draw(win) 
```

但是，我对如何获得上方和下方的半圆感到困惑。有人有想法么？我不确定如何让代码沿 y 轴重复。

任何帮助深表感谢。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-12-15T01:13:50.820

这是一个使用 Python 的海龟图形的解决方案，它可能不像您想象的那样工作：

```
from turtle import Turtle, Screen, Shape

COUNT = 5
SIZE = 400
RADIUS = SIZE / COUNT
STAMP_UNIT = 20

screen = Screen()

circle_in_square = Shape("compound")
turtle = Turtle(shape="square")
circle_in_square.addcomponent(turtle.get_shapepoly(), "white")
circle_in_square.addcomponent([(-10, 10), (-10, -10)], "black")
circle_in_square.addcomponent([(10, -10), (10, 10)], "black")

turtle.shapesize(SIZE / STAMP_UNIT * 1.01)
turtle.stamp()  # stamp background to get a border

turtle.shape("circle")
turtle.shapesize(1.0)
circle_in_square.addcomponent(turtle.get_shapepoly(), "red", "black")

screen.register_shape("squircle", circle_in_square)
turtle.shape("squircle")
turtle.shapesize(RADIUS / STAMP_UNIT)
turtle.penup()

for y in range(1 - COUNT, 1):
    for x in range(-COUNT//2 + 1, COUNT//2 + 1):
        for sign in (1, -1):
            turtle.goto(x * RADIUS, y * RADIUS/2 * sign)
            turtle.stamp()

screen.exitonclick() 
```

它首先创建了一个我称之为***squircle***的图章，它是一个白色正方形上的红色圆圈，顶部和底部有黑色边框：

[![在此处输入图像描述](../Images/a5940aa333e9e1282ef40a7ed70a4a3e.png)](https://i.stack.imgur.com/i5dlB.png)

然后它会在水平方向上并排打印出一堆这些，在垂直方向上重叠 50%：

[![在此处输入图像描述](../Images/0bed3acb0c6e96dd0d8e86f417f4083e.png)](https://i.stack.imgur.com/pgowN.png)

加盖了一点外边框。这是我的“通过加盖更好地生活*”*系列的一部分（与您的解决方案和其他答案尝试的*绘图相反。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:45:58.437

在不知道您使用的是什么图形库的情况下，很难给出具体的答案。但是有四种可能：

1.  该库可能具有与`Arc`该类类似的`Circle`类，或者可能是一种限制`Circle`对象仅显示（填充）弧线或类似内容的方法。如果是这样，为了得到你的半圆，你会使用类似的东西`Arc(centre, 20, -math.pi/2, math.pi/2)`and `Arc(centre, 20, math.pi/2, 3*math.pi/2)`。

2.  该库可能有一种方法来设置显式边界框以截断任何对象。所以，你会做这样的事情：`bb = circle.getBoundingBox(); bb.top = (bb.top + bb.bottom) / 2; circle.setBoundingBox(bb)`.

3.  该库可能没有任何明确的方法来执行此操作，但可以让您在 Z 顺序中的其他事物之上绘制事物。所以，首先你画五个完整的圆圈穿过顶部，然后你画一个白色的大矩形，覆盖所有圆圈的下半部分。（如果有办法设置边框颜色和填充颜色，那甚至可以免费为您提供这些矩形线。）

4.  该库可能根本没有任何方法可以做到这一点，在这种情况下，您必须使用不同的库。

同时，对于“我如何让代码沿 y 轴重复”，这只是您已有的循环之外的另一个循环。像这样的东西：

```
def fdShape():
    win = GraphWin("pdShape",200,200)
    centre = Point(20,100)
    for y in range(9):
        for x in range(5):
            circle = Circle(centre, 20)
            circle.setFill("red")
            centre = Point((centre.getX() + 40), centre.getY())
            circle.draw(win)
        centre = Point(20, centre.getY() + 40) 
```

但是，最好只从 x 和 y 创建点，而不是显式添加它们：

```
 for y in range(9):
        for x in range(5):
            centre = Point(x * 40 + 20, y * 40 + 60)
            circle = Circle(centre, 20)
            circle.setFill("red")
            circle.draw(win) 
```

查看[您在评论中提供的库链接](http://poolem.myweb.port.ac.uk/intprog/graphics.py)，似乎没有任何方法可以执行 1 或 2。完整的文档在我没有的教科书中，但是在线[参考文档](http://mcsp.wartburg.edu/zelle/python)和代码很简单。无论`Circle`是它的父类还是它的任何父类都没有任何方法来指定弧或要截断的框。（有一个边界框，但将其切成两半只会导致压扁椭圆的高度为原始圆的一半，而不是半圆。）

并且大概你正在学习需要这个库的课程，所以 4 不是一个选项。

剩下 3。这意味着你实际上将不得不稍微改变循环。像这样的东西：

```
 for y in range(4):
        # draw row of circles y
        # draw row 8-y
        # draw rectangle y
        # draw rectangle 8-y
    # draw row of circles 4 
```

请注意，矩形 3 和矩形 5 将是同一个，因此绘制两者有点浪费，但我认为在这种情况下，保持代码更简单是值得浪费的。如果你的老师不同意，应该很容易弄清楚如何重构代码。

最后，说到重构代码，考虑到你必须用不同的值两次“画一排圆”，你应该把它变成一个函数，同样的“画矩形”。那么上面的伪代码就变成了真正的代码：

```
 for y in range(4):
        drawRowOfCircles(win, y)
        drawRowOfCircles(win, 8-y)
        drawRectangle(win, y)
        drawRectangle(win, 8-y)
    drawRowOfCircles(win, 4) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-20T19:37:32.120

看一下python中的[turtle](http://docs.python.org/2/library/turtle.html)包。在海龟中，您可以指定一个[圆圈](http://docs.python.org/2/library/turtle.html#turtle.circle)以及绘制它的角度范围。当然，你只需要弄清楚你的圈子在哪里集中并迭代到你的内心满足！

# javascript - Zombie.js 不返回完整的 HTML

> ID：13480655
> 
> 赞同：5
> 
> 时间：2012-11-20T19:30:25.277
> 
> 标签：javascript, node.js, zombie.js

我刚刚测试了 Zombie.js，并让它访问了 StackOverflow 上的登录页面。我的代码如下：

```
var Browser = require("zombie");

// Load the page from localhost
browser = new Browser()
browser.visit("http://stackoverflow.com/users/login/", function () {
    browser.wait(3000, function (){
        console.log(browser.html());
        console.log(browser.success);
    });
}); 
```

我试着环顾四周，我知道 Zombie.js 运行脚本并压缩 HTML，但在这种情况下，整个`body`代码都丢失了。

**我不认为这是相关的，**但返回的 HTML 代码是：

```
<html><head>

    <title>Log In - Stack Overflow</title>
    <link rel="shortcut icon" href="http://cdn.sstatic.net/stackoverflow/img/favicon.ico" />
    <link rel="apple-touch-icon" href="http://cdn.sstatic.net/stackoverflow/img/apple-touch-icon.png" />
    <link rel="search" type="application/opensearchdescription+xml" title="Stack Overflow" href="/opensearch.xml" />

    <script type="text/javascript" src="http://www.google-analytics.com/ga.js"></script><script type="text/javascript" src="http://edge.quantserve.com/quant.js"></script><script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://cdn.sstatic.net/js/stub.js?v=8a629d6e9fb6"></script>
    <link rel="stylesheet" type="text/css" href="http://cdn.sstatic.net/stackoverflow/all.css?v=24fdd40e5473" />

    <meta http-equiv="X-XRDS-Location" content="http://stackoverflow.com/yadis" />
    <script src="http://cdn.sstatic.net/Js/third-party/openid-jquery.js?v=8b3167d0ee55" type="text/javascript"></script>
    <script type="text/javascript">
        document.write('<style type="text/css">.login-page .script-only { display: block; }<\/style>');
        $(function() {
            openid.init('openid_identifier', '', 'http://cdn.sstatic.net/Img/openid/openid-logos.png?v=8', true);
        });
    </script>

    <script type="text/javascript">
        StackExchange.init({"stackAuthUrl":"https://stackauth.com","serverTime":1353439370,"styleCode":true,"enableUserHovercards":true,"site":{"name":"Stack Overflow","description":"Q&A for professional and enthusiast programmers","isNoticesTabEnabled":true,"recaptchaPublicKey":"6LdchgIAAAAAAJwGpIzRQSOFaO0pU6s44Xt8aTwc","enableSocialMediaInSharePopup":true},"user":{"fkey":"8074e87bcb0a1a15cc69db799d304930","isAnonymous":true}});
        StackExchange.using.setCacheBreakers({"js/prettify-full.js":"c862bf93b3ec","js/moderator.js":"37bba549a03e","js/full-anon.js":"bcd6f2e0d542","js/full.js":"87618162bac4","js/wmd.js":"89ec12ce09df","js/third-party/jquery.autocomplete.min.js":"e5f01e97f7c3","js/mobile.js":"6eb68240242f","js/help.js":"fc9fb0517db2","js/tageditor.js":"450c9e8426fc","js/tageditornew.js":"9ac6c13a3a7f","js/inline-tag-editing.js":"30f72b99548b","js/revisions.js":"8c6bcd93b7fe","js/review.js":"37dd8dc83788"});

    </script>
</head>
<body class="login-page" style="cursor: default;"><style type="text/css">.login-page .script-only { display: block; }</style></body></html> 
```

编辑：刚刚注意到这可能是由`document.write`页面脚本中的调用引起的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T19:40:38.513

使用`runScripts: false`浏览器的选项解决了这个问题，因为`document.write`覆盖了正文。

我[在他们的 Github 上打开了一个问题，](https://github.com/assaf/zombie/issues/437)因为这不是其他浏览器显示的行为。

# c# - LINQ 参数“x”不在范围内

> ID：13480658
> 
> 赞同：0
> 
> 时间：2012-11-20T19:30:40.357
> 
> 标签：c#, linq-to-sql, lambda

在我关于制定[IQueryable 来查询递归数据库表](https://stackoverflow.com/questions/13429855/)的问题之后，我尝试了给出的答案，并且更接近我的问题的解决方案。我已经重组了提供的答案，所以对我来说更容易理解发生了什么。但是，无论我尝试什么，我都会不断收到错误消息`"the parameter 'x' is not in scope"`。`return entities.Single();`如何确保参数“x”在范围内？我试过`ParameterExpression`在`BuildParentPropertiesExpression`方法中制作，我试过每次都用不同的名字把它放在for循环中。一切都无济于事。

[在此处阅读背景故事](https://stackoverflow.com/questions/13429855/)

```
public Entity Single(string path)
{
    if (path[0] == '/')
        path = path.Substring(1); // only absolute paths for now

    List<string> pathParts = path.Split('/').ToList();
    pathParts.Reverse();

    var entities =
        from entity in dataContext.Entities
        select entity;

    // Build up a template expression that will be used to create the real expressions with.
    Expression<Func<Entity, bool>> templateExpression = (x => x.Code == "dummy");
    BinaryExpression equals = (BinaryExpression)templateExpression.Body;
    MemberExpression property = (MemberExpression)equals.Left;

    ParameterExpression entityParameter = Expression.Parameter(typeof(Entity), "x");

    for (int index = 0; index < pathParts.Count; index++)
    {
        string pathPart = pathParts[index];

        Expression parentPropertyExpression = BuildParentPropertiesExpression(index, entityParameter);

        MemberExpression left = Expression.Property(
            parentPropertyExpression,
            (PropertyInfo)property.Member
        );

        ConstantExpression right = Expression.Constant(pathPart);

        BinaryExpression equalExpression = Expression.Equal(
            left, 
            right, 
            equals.IsLiftedToNull, 
            equals.Method
        );

        var entityFilterExpression = Expression.Lambda<Func<Entity, bool>>(
            equalExpression, 
            templateExpression.Parameters
        );

        entities = entities.Where<Entity>(entityFilterExpression);
    }

    return entities.Single();
}

private Expression BuildParentPropertiesExpression(int numberOfParents, ParameterExpression entityParameter)
{
    if (numberOfParents == 0)
        return entityParameter;

    var getParentMethod = typeof(Entity).GetProperty("Entity1").GetGetMethod();
    var property = Expression.Property(entityParameter, getParentMethod);

    for (int count = 2; count <= numberOfParents; count++)
        property = Expression.Property(property, getParentMethod);

    return property;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:29:00.447

您与原始实现非常接近

```
public Entity Single(string path) {
    string[] pathParts = path.Split('/');
    string code = pathParts[pathParts.Length -1];

    if (pathParts.Length == 1)
            return dataContext.Entities.Single(e => e.Code == code && e.ParentID == 0);

    IQueryable<Entity> entities = dataContext.Entities.Where(e => e.Code == code);
    for (int i = pathParts.Length - 2; i >= 0; i--) {
        string parentCode = pathParts[i];
        entities = entities.Where(e => e.Entity1.Code == parentCode).Select(e => e.Entity1); //This now gets the parent entity
    }

    return entities.Single();
} 
```

# php - Drupal：为我的表单创建一个特殊的模板文件会影响我的 css，它不会加载

> ID：13480661
> 
> 赞同：0
> 
> 时间：2012-11-20T19:30:44.210
> 
> 标签：php, css, templates, drupal, edit

我`<?php print $title; ?>`在 Drupal 6 中删除了我的页面 tpl。这样，我为每个节点类型创建了一个特殊的模板，我可以在其中以自己的方式设置标题（或不设置）（每种内容类型都不同）。

问题是，通过该操作，我还删除了节点/添加表单中的标题（这不好）。

我在[这里](https://stackoverflow.com/questions/1538600/how-can-i-theme-the-template-for-edit-or-add-a-node-for-a-specific-content-type)找到了该问题的解决方案，因此，我将此功能添加到了一个新模块中：

```
function modding_preprocess_page(&$vars, $hook) {
  if ((arg(0) == 'node') && (arg(1) == 'add')) {
    $vars['template_files'][] =  'node-add';
  }
} 
```

这样，每次我创建一个新节点时，标题都会出现。

我的 node-add.tpl.php 模板如下所示：

```
<h1><?php print $title ?></h1>
<?php print $content ?> 
```

**我现在的问题是样式表无法加载，我不明白为什么。当没有加载任何样式时，它看起来很丑。** 我可以补充一点，我已经多次清除缓存，并且由于这是一个测试站点，所有性能缓存都已禁用。

**请注意，我正在告诉您所有这些关于我的动机的信息，以防万一您知道将标题添加到每个节点/添加、节点/编辑表单的更好解决方案。因为我因此而陷入混乱。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:04:25.290

您可以使用[排除节点标题](http://drupal.org/project/exclude_node_title)模块并为其他问题头疼:) 它是节点的粒度，但您可以在内容类型级别进行设置

希望能帮助到你

公关

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:37:56.460

我找到了解决方案。在这里发布它以防万一它对其他人有帮助：

```
<?php 
      if ((arg(0) == 'node') && (arg(1) == 'add') || (arg(2) == 'edit')){
    $node = node_load(array('nid' => arg(1)));
    print $title;
    }
?> 
```

[感谢 nevets](http://drupal.org/node/1846094)，他给了我需要的提示！:)

# java - HttpRequestRetryHandler 处理哪些异常？

> ID：13480666
> 
> 赞同：1
> 
> 时间：2012-11-20T19:31:03.287
> 
> 标签：java, android, http

我正在尝试在我的 Android 应用程序中实现 HttpRequestRetryHandler。我在[这里](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/fundamentals.html#d5e281)阅读了 HttpRequestRetryHandler 的文档。

```
DefaultHttpClient httpclient = new DefaultHttpClient();

HttpRequestRetryHandler myRetryHandler = new HttpRequestRetryHandler() {

    public boolean retryRequest(
            IOException exception, 
            int executionCount,
            HttpContext context) {
        if (executionCount >= 5) {
            // Do not retry if over max retry count
            return false;
        }
        if (exception instanceof InterruptedIOException) {
            // Timeout
            return false;
        }
        if (exception instanceof UnknownHostException) {
            // Unknown host
            return false;
        }
        if (exception instanceof ConnectException) {
            // Connection refused
            return false;
        }
        if (exception instanceof SSLException) {
            // SSL handshake exception
            return false;
        }
        HttpRequest request = (HttpRequest) context.getAttribute(
                ExecutionContext.HTTP_REQUEST);
        boolean idempotent = !(request instanceof HttpEntityEnclosingRequest); 
        if (idempotent) {
            // Retry if the request is considered idempotent 
            return true;
        }
        return false;
    }

};

httpclient.setHttpRequestRetryHandler(myRetryHandler); 
```

文档中的示例指出不应重试某些异常。例如，不应重试 InterruptedIOException。

**问题1**为什么不应重试InterruptedIOException？

**问题 2**如何知道哪些异常要重试，哪些不应该重试？例如 - 我们是否应该重试 ConnectionTimeoutException 和 SocketTimeoutException？

文档还说*HttpClient 假定 GET 和 HEAD 等非实体封闭方法是**幂等**的，而 POST 和 PUT 等实体封闭方法则不是。*

**问题 3**这是否意味着我们不应该重试 POST 和 PUT 方法，如果不是，那么我们应该如何重试 HttpPost 请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:54:56.463

我认为这只是实施的一个例子`RetryHandler`。

> 问题1 为什么不应重试InterruptedIOException？

在这个例子中，我相信它假设超时的原因是`resource unavailability at URL`，因此重试不会做得更好。这就是原因，它被设置为假。如果在您的情况下，您认为这可能只是因为连接速度慢或一些间歇性问题，请随时将其设置为 true 以重试。

> 问题 2 如何知道哪些异常要重试，哪些不应该重试？例如 - 我们是否应该重试 ConnectionTimeoutException 和 SocketTimeoutException？

任何异常，您认为这是由于暂时性问题，您可以重试。任何其原因在性质上更持久的异常，例如未找到资源或某些业务异常，都不应该重试，因为它们总是会失败。

> 问题 3 这是否意味着我们不应该重试 POST 和 PUT 方法，如果不是，那么我们应该如何重试 HttpPost 请求？

仅在您可以在没有任何外部依赖的情况下重新启动进程的情况下才允许重试。

# octave - 在 Octave 中求解复微分方程组

> ID：13480667
> 
> 赞同：1
> 
> 时间：2012-11-20T19:31:08.700
> 
> 标签：octave

好吧，我想以以下形式解决一个复杂的 ODE 系统：

$ i\hbar \dfrac{\partial \rho}{\partial t} = \left[ H, \rho \right] $

[http://mathbin.heroku.com/rq65idQ](http://mathbin.heroku.com/rq65idQ "粘贴方程的 bin")

其中 $\rho$ 和 $H$ 是 $nxn$ 矩阵。

我尝试使用以下方法定义通用函数：

```
function xdot = f(x,t)

i*xdot(1)=
i*xdot(2)=

endfunction
x0=[0;0];
t=linspace(0,20,200);
y=lsode("f",x0,t). 
```

但我收到有关*i*的错误消息。那么我的问题是：如何在 Octave 中求解一个复杂的微分方程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T13:39:08.647

我认为问题是因为 i 位于等号的 LHS 而不是 RHS。

你有没有尝试过？

```
xdot(1) = <whatever your RHS expression is> / i;
xdot(2) = <whatever your RHS expression is> / i; 
```

# c++ - 静态变量动态分配

> ID：13480668
> 
> 赞同：10
> 
> 时间：2012-11-20T19:31:10.590
> 
> 标签：c++, dynamic, static

函数内的静态变量在程序的生命周期内只分配一次。

所以如果我有这样的功能：

```
void f(int n) {

  static int *a = new int[n];

} 
```

我先打电话

```
f(1) 
```

进而

```
f(3) 
```

第二次调用后数组 a 会有多大？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T19:37:03.600

`static`函数的局部变量在控制第一次通过它们时被初始化。标准中的相关部分是 6.7 [stmt.dcl]。也就是说，除非您明确更改其大小，否则数组将获取大小 1 并保持此大小。

C++ 2011 的优点在于初始化`static`变量也是线程安全的：如果在初始化变量时另一个线程到达实例，则第二个线程将被阻塞，直到初始化完成。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-20T19:38:06.110

`static`当控制流第一次到达声明时，局部变量将被初始化。在这种情况下，自从您第一次用作`1`参数以来`n`，您将为 one 分配大小`int`。

做这种事情是个坏主意。您应该只使用本地的、非静态的`std::vector`或其他更高级别的容器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T19:49:13.183

函数内静态变量的初始化仅发生在函数内静态语句的第一次评估期间。第一次使用`f`调用when 时`f(1)`，将进行 for 的初始化，`a`它将指向单个 int 的数组。当`f(3)`被调用时，`a`已经被初始化了，所以右手边的：

```
static int *a = new int[n]; 
```

不会再被求值，并且`a`会继续指向最初分配的大小为 1 的数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T20:02:36.167

数组的大小为 1，因为变量“a”的初始化只进行了一次，即第一次调用函数“f”。

# servicestack - 使用 ServiceStack 为根路径“/”创建路由

> ID：13480673
> 
> 赞同：11
> 
> 时间：2012-11-20T19:31:32.950
> 
> 标签：servicestack

我正在尝试为 root 设置一个 RestPath，'/'，但它不允许我这样做。它的说法`RestPath '/' on Type 'MainTasks' is not Valid`

有没有办法允许这样做？我想从根目录提供资源。

```
[Route("/", "GET")]
public class MainTasks : IReturn<MainTasksResponse>
{
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-15T15:59:41.390

这对我有用。我刚刚添加了 RawHttpHandler 并重写了请求路径。像冠军一样工作。（这可以在我的 AppHost 的配置功能中找到。）

```
var conf = new EndpointHostConfig();
{
    DefaultRedirectPath = "/foo",
    AllowFileExtensions = { { "eot" }, { "svg" }, { "ttf" }, { "woff" } },
};

conf.RawHttpHandlers.Add(r =>
{
    if (r.RawUrl == "/")
    {
        HttpContext.Current.RewritePath(conf.DefaultRedirectPath);
    }

    return null;
});

this.SetConfig(conf); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-20T20:21:26.727

您只能在[ServiceStack](http://www.servicestack.net/)`/`中的 Route Path 上使用[FallbackRoute](https://github.com/ServiceStack/ServiceStack/wiki/Routing#fallback-route)进行匹配，例如：

```
[FallbackRoute("/{Path*}")]
public class Fallback
{
    public string Path { get; set; }
} 
```

这使用通配符来处理每个不匹配的路由（包括 /foo/bar）。只允许 1 个后备路由。

还有一些其他方法可以处理默认根路径 /：

1.  更改`EndpointHostConfig.DefaultRedirectPath`以重定向到您希望使用的服务
2.  添加`default.cshtml`Razor 或 Markdown 视图或静态`default.htm`（用于 HTML 请求）
3.  Register a `EndpointHostConfig.RawHttpHandlers`- 这是在[ServiceStack 的 Order of Operations](https://github.com/ServiceStack/ServiceStack/wiki/Order-of-Operations)中查看的第一个处理程序。
4.  注册一个`IAppHost.CatchAllHandlers`- 这被称为**不匹配的**请求。
5.  在[全局请求过滤器中处理请求](https://github.com/ServiceStack/ServiceStack/wiki/Request-and-response-filters)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-06T10:35:58.340

我一直在尝试这样做，并发现 Christopher Davies 方法不再适用于自托管服务的最新服务堆栈。我的服务上的以下不带参数的工作有效。

[FallbackRoute("/")]

# python - Flask 和 mimerender 异常处理

> ID：13480675
> 
> 赞同：3
> 
> 时间：2012-11-20T19:31:39.627
> 
> 标签：python, flask, flask-extensions

我正在使用来自 mimerender 的异常映射（我们以 json 为例），但是输出与请求工作时不同：

```
import json
import mimerender
...

mimerender = mimerender.FlaskMimeRender()

render_xml = lambda message: '<message>%s</message>'%message
render_json = lambda **args: json.dumps(args)
render_html = lambda message: '<html><body>%s</body></html>'%message
render_txt = lambda message: message

render_xml_exception = lambda exception: '<exception>%s</exception>'%exception
render_json_exception = lambda exception: json.dumps(exception.args)
render_html_exception = lambda exception: '<html><body>%s</body></html>'%exception
render_txt_exception = lambda exception: exception

@mimerender.map_exceptions(
    mapping=(
        (ValueError, '500 Internal Server Error'),
        (NotFound, '404 Not Found'),
    ),
    default = 'json',
    html = render_html_exception,
    xml  = render_xml_exception,
    json = render_json_exception,
    txt  = render_txt_exception
)
@mimerender(
    default = 'json',
    html = render_html,
    xml  = render_xml,
    json = render_json,
    txt  = render_txt
)
def test(... 
```

当请求有效时，我得到以下响应：

```
* HTTP 1.0, assume close after body
< HTTP/1.0 200 OK
< Content-Type: application/json
< Content-Length: 29
< Vary: Accept
< Server: Werkzeug/0.8.3 Python/2.7.3rc2
< Date: Tue, 20 Nov 2012 19:27:30 GMT
< 
* Closing connection #0
{"message": "Success"} 
```

当请求失败并触发异常时：

```
* HTTP 1.0, assume close after body
< HTTP/1.0 401 Not Found
< Content-Type: application/json
< Content-Length: 25
< Vary: Accept 
< Server: Werkzeug/0.8.3 Python/2.7.3rc2
< Date: Tue, 20 Nov 2012 19:16:45 GMT
< 
* Closing connection #0
["Not found"] 
```

我的问题：除了我想要相同类型的输出，如下所示：

```
{'message': 'Not found'} 
```

如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T15:33:21.143

显然`exception.args`是一个列表，并且它被这样返回:-) 要更改它，只需更改您返回的数据结构。

换句话说，改变：

```
render_json_exception = lambda exception: json.dumps(exception.args) 
```

至：

```
render_json_exception = lambda exception: json.dumps({"message": exception.args}) 
```

或者，如果您*必须*在出错时只返回一条消息：

```
render_json_exception = lambda exception: json.dumps({"message": " - ".join(exception.args)}) 
```

# c++ - zip_iterator 和 lower_bound

> ID：13480679
> 
> 赞同：3
> 
> 时间：2012-11-20T19:31:47.693
> 
> 标签：c++, boost, iterator, lower-bound

我不知道如何`lower_bound`用`zip_iterator`.

这不会编译：

```
#include <boost/iterator/zip_iterator.hpp>
#include <vector>
#include <algorithm>

void main()
{
    typedef int Key;
    typedef double Value;

    typedef boost::tuple<typename std::vector<Key>::iterator,
                         typename std::vector<Value>::iterator> the_iterator_tuple;
    typedef boost::zip_iterator<the_iterator_tuple> the_zip_iterator;

    std::vector<Key>   keys_;
    std::vector<Value> values_;

    // Add values to keys_ and values_...

    auto it = std::lower_bound(
        the_zip_iterator(the_iterator_tuple(keys_.begin(), values_.begin())),
        the_zip_iterator(the_iterator_tuple(keys_.end(), values_.end())),
        123,
        [](const the_iterator_tuple & it, const int v) -> bool { return *boost::get<0>(it) < v; }
    );

    // Use "it"...
} 
```

VS2010 说它“无法将参数 1 从 'int' 转换为 'const std::_Vector_iterator<_Myvec> &'”（加上其他几十个相同的错误），但它与一个不起眼的 boost::tuple 构造函数有关，而不是给定的 lambda。

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T20:24:57.793

这看起来像 VS2010 中的“概念检查”错误。

25.4.3.1 [下限]/p1：

> Requires:: 的元素`e`应`[first,last)`根据表达式`e < value`or进行分区`comp(e, value)`。

即只`*it < v`需要。

该`upper_bound`算法有相反的要求： `v < *it`. 并且`equal_range`需要这两个表达式才能工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T20:14:51.583

`std::lower_bound(it, end, v)`需要能够同时做到`*it < v`和`v < *it`。您的函数对象仅支持其中之一。

既然对此有评论，就留下上面的说法：事实并非如此。正如霍华德所指出的，比较需要使用`comp(*it, v)`，即这个操作不需要是对称的。

但是，查看它的文档[`boost::zip_iterator<It0, It1>`](http://www.boost.org/doc/libs/1_51_0/libs/iterator/doc/zip_iterator.html)似乎会`*it`产生一个`boost::tuple<typename It0::reference, typename It1::reference>`. 因此，添加`typedef`

```
typedef boost::tuple<typename std::vector<Key>::reference,
                     typename std::vector<Value>::reference> the_reference_tuple; 
```

...并将 lambda 更改为

```
[](the_reference_tuple const& it, int v) { return it.get<0>() < v; } 
```

使用 gcc 和 clang 解决编译问题。

# javascript - 如何使用 jQuery 和 javascript 在幻灯片下方创建移动图像幻灯片？

> ID：13480685
> 
> 赞同：1
> 
> 时间：2012-11-20T19:32:01.243
> 
> 标签：javascript, jquery, css

我正在尝试制作缩略图幻灯片，以配合我网站上的幻灯片。每次幻灯片中的图像更改时，它们都应该向左移动；最左边的缩小到 0px 的宽度；一个新的从右边出现。然而，目前，图像会很好地向左移动，但它们不会循环播放，它们只是继续离开页面。一个新的确实出现在该行的末尾。我目前拥有的代码是

```
 function slideImage() {
        var $pic1 = $('#pic1');
        var $pic8 = $('#pic8');

        if (i <= numImages - 8) {
            name8 = name1 + getString(i + 7) + name2;
        }
        else if (i <= numImages) {
            name8 = name1 + getString((i - numImages) + 7) + name2;
        }
        else {
            i = 1;
            name8 = name1 + getString(i + 8) + name2;
        }

        $pic1.animate({ width: "0px", padding: "0px" }, 1000, function () {
            $pic1.attr("id", "pic8")
                .attr("src", name8);
        });
        $pic8.animate({ width: "75px", padding: "5px"}, 1000, function () {
            $("#pic2").attr("id", "pic1");
            $("#pic3").attr("id", "pic2");
            $("#pic4").attr("id", "pic3");
            $("#pic5").attr("id", "pic4");
            $("#pic6").attr("id", "pic5");
            $("#pic7").attr("id", "pic6");
            $pic8.attr("id", "pic7");
        });
        $(".im").not("#pic8").animate({ left: "-=85px" }, 1000);
    } 
```

每次调用更改实际幻灯片中图像的函数时，我都会调用此函数。我有一个 ID 为 pic1 到 pic8 的图像列表，它们都绝对位于一个 div 中。图片的来源是 ..\photos\pic_.jpg，其中 _ 被替换为从 1 到文件夹中图片数量的三位数字。我对javascript和jquery真的很陌生，所以任何帮助都将不胜感激！谢谢！

# jquery - 在此特定示例中，slideUp 无法正常工作

> ID：13480686
> 
> 赞同：0
> 
> 时间：2012-11-20T19:32:04.783
> 
> 标签：jquery, html, slideup

我有一个不寻常的问题。

下面的代码不能正常工作。我已将它粘贴到 jsFiddle 中，它工作正常，但是在我的网站上它运行不顺畅，而且看起来也不怎么好。它应该做什么：点击“从这里开始”按钮后，它应该平滑地向上滑动整个内容，然后进入下一页。它实际上开始向上滑动，但并没有走到尽头并加载一个新页面。我认为它可以通过使用任何类型的延迟来修复，但我是 jQuery 的新手，我不知道如何正确地做到这一点。或者也许有另一种方法来解决它。（问题已解决，原因：应用了最小高度）

我面临的下一个问题是加载外部 .js 文件（代码中的注释片段）。当我这样做时，脚本不起作用。当我将脚本放在按钮下方时，它可以工作。如何克服这个问题，我可以将代码实现为头部中的外部 .js，而不是将其放在按钮下方的标签中？

非常感谢您提前。

代码在这里：

```
 <html>
    <head>

        <meta charset="utf-8">
        <meta name="viewport" content="width=480" />
        <link rel="stylesheet" type="text/css" href="_css/index.css">
        <script type="text/javascript" src="_js/jquery.js"></script>
        <script type="text/javascript" src="_js/form.js"></script>
    <!--            <script type="text/javascript" src="_js/transitions.js"></script>
    -->
    </head>

    <body>

    <div id="wrapper">

      <div id="header">
            <img src="_images/header.png">
            <div id="spons"><img src="_images/main-sponsor.jpg"></div>
      </div>

      <div id="content">

        <div id="starthere">
                <strong>Thank you. <br/>You have gained access to free Wi-Fi Media Network. <br/>Please enjoy free content from GAME.</strong>
            <div id="finalbut">
                <a href="#" id="roll"><img src="_images/butt-start.png"></a>
            </div>

            <script>
            $("#roll").click(function() {
                 $("#content").slideUp(function() {
                     window.location.href = "menu.html";
                 });
            });
            </script>

        </div>

      </div>

    </div>

    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:37:43.100

您的内容 div 有一个`min-height`，它搞砸了动画。

您可以简单地删除最小高度

对于您的问题的第二部分，将代码包装在[jQuery on ready 事件中](http://api.jquery.com/ready/)。

使用 jQuery 时总是这样做！当一切准备就绪时，它将确保运行您的代码，因此您可以将代码放在任何地方。

```
$(function() {
    $("#roll").click(function() {
        $("#content").slideUp(function() {
            window.location.href = "menu.html";
        });
    });
}); 
```

# c++ - 如何检测用户何时断开网络连接？

> ID：13480688
> 
> 赞同：0
> 
> 时间：2012-11-20T19:32:11.900
> 
> 标签：c++, sockets, winsock

> **可能重复：**
> [检测网络电缆何时拔出](https://stackoverflow.com/questions/2916243/detect-when-network-cable-unplugged)

我需要一些帮助来检查是否有人断开连接。目前我的代码说每次我连接到它时都会有人断开连接。我尝试使用 send() 检查它们是否仍然“活着”，但我不确定我是否做得对。

```
#pragma comment (lib,"Ws2_32.lib")

#include <iostream>
#include <WinSock2.h>

using namespace std;

#pragma region shittyvars

int countcons = 0, connections[100];
char *dead = new char;
int error;
WSAData netinfo;
int mySocket;
HANDLE acceptth, discth;

#pragma endregion

void AcceptThread( int* a)
{
int clientSocket;
while ( (clientSocket = accept(mySocket,0,0))!=SOCKET_ERROR) 
   connections[countcons++]=clientSocket;
}
void DissconectThread(int*b)
{
for(;;)
  for(int i=0;i<countcons;i++)
   {
       error = send(connections[i],dead,4,0);
 error = WSAGetLastError();
       if(error != 0 )
       {
           closesocket(connections[i]);
           for(int j=i+1 ; j<countcons ;j++)
               connections[j-1]=connections[j];
           countcons--;
           cout<<"\nSomebody disconnected\n";
       }
   }
}

int main() {
#pragma region InitConnection
    error = WSAStartup(MAKEWORD(2,2), &netinfo);

    if (error == SOCKET_ERROR) {
        cout << "Error:Starting socket failed";
        return 1;
    }

    mySocket = socket(AF_INET, SOCK_STREAM, 0);

    if (mySocket == SOCKET_ERROR) {
        cout << "Error:Socket failed to initialize!";
        return 1;
    }
    cout << "Works!";

    struct sockaddr_in server; // network socket struct

    server.sin_family = AF_INET;
    server.sin_port = htons(7654);
    server.sin_addr.s_addr = INADDR_ANY; // Let's us accept any connection

    error = bind(mySocket, (sockaddr*) &server, sizeof(server));

    if (error == SOCKET_ERROR) {
        cout << "Error:Failed to bind socket";
        return 1;
    }

    error = listen(mySocket, 100);

    if (error == SOCKET_ERROR) {
        cout << "Error:The socket is deaf";
        return 1;
    }

#pragma endregion

    acceptth = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE) AcceptThread,
            &server, 0, (LPDWORD) &acceptth);
    discth = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE) DissconectThread,
            &server, 0, (LPDWORD) &discth);
    getchar();
    closesocket(mySocket);
    WSACleanup();
    getchar();
    return 0;
} 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:58:18.950

检查`send`失败时出现的错误......它可能会为您指明正确的方向（`WSAGetLastError()`在 Windows 上使用）。顺便说一句，您`DissconectThread`只会旋转并咀嚼 CPU 直到有连接，然后它会阻塞数据，直到它阻塞一个具有完整发送缓冲区的连接......可能不是您想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:20:18.620

您需要检查`read()`和`write()`调用您的套接字的返回值（和 相同`recv()`）`send()`。

*   对于另一端的优雅连接终止，您`0`将从`read()`,
*   对于突然断开连接，您`-1`将从.`write()``WSAECONNRESET`[`WSAGetLastError()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms741580%28v=vs.85%29.aspx)
*   检查所有其他错误代码，`-1`然后[`send()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740149%28v=vs.85%29.aspx)忽略[`recv()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740121%28v=vs.85%29.aspx)所有其他错误代码，例如`WSAEINTR`关闭套接字。

***将一些常规的空闲心跳***合并到您的***应用程序级协议***中会好得多，而不是像现在这样从专用线程冲击您的系统。

# javascript - 无法在 JavaScript 中访问对象的属性 - 我做错了什么？

> ID：13480689
> 
> 赞同：-1
> 
> 时间：2012-11-20T19:32:13.440
> 
> 标签：javascript

我有一个 Object obj，它的属性“value”的值为 123。当`console.log(obj)`我看到 firefox 打印该对象及其所有字段时。

当我尝试打印“值”属性的值时，我得到了未定义。

我试过了：

```
console.log(obj.value); 
```

和

```
console.log(obj[value]); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:55:02.893

如果您的对象具有如下所示的值：

```
obj={value:"Object Value"}; 
```

那么`obj.value`并且`obj['value']`是有效的。

```
 console.log (obj.value); //Output will be 'Object Value'
 console.log (obj['value']); //Again output will be same 'Object Value'​​​​​​​​​​​​​​​​​​​​ 
```

在 javascript 中，您几乎可以互换使用方括号和点表示法。

[有关点与方括号符号的更多信息](http://modernjavascript.blogspot.co.uk/2012/05/dot-vs-square-bracket-notations-in.html)

# java - 有没有办法在java中锁定（同步）二维数组中的一行？

> ID：13480690
> 
> 赞同：1
> 
> 时间：2012-11-20T19:32:16.037
> 
> 标签：java, arrays, synchronization, locking, dimension

有没有办法在java中锁定（同步）二维数组中的一行？我只想更新一个特定行中的一些条目并仅锁定该行而不是整个数组？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T19:35:40.557

需要明确的是，您在一个对象上进行同步。要在数组的第 3 行同步（记住从 0 开始的索引）：

```
String[][] array = ....
synchronize(array[2]) {
} 
```

例如。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T19:43:00.350

我们同步一个代码块，而不是一个数据结构。

您应该封装该数组并同步对其的访问（根据您的要求），以使其成为线程安全的。

# javascript - 创建 javascript 验证错误

> ID：13480693
> 
> 赞同：0
> 
> 时间：2012-11-20T19:32:32.760
> 
> 标签：javascript, html, quickbase

我有 3 个字段用于输入 6 位代码以用于数据库（Quickbase）查询。每个字段都需要一个单独的警报/消息，让提交者知道代码是否无效。示例：“在字段 #1 中输入的数据无效”。我将下面的片段放在一起，它在一定程度上达到了结果。问题是当我只输入 1 个坏数据字段时，脚本可以工作，但是当我输入超过 1 个坏数据字段或将好数据与坏数据混合时，脚本不能正常工作......谢谢您的帮助。

这是字段

```
<input name="searchRecord" id="searchRecord1" type="text" size="8" maxlength="8" >
<input name="searchRecord" id="searchRecord2" type="text" size="8" maxlength="8">
<input name="searchRecord" id="searchRecord3" type="text" size="8" maxlength="8">
<input name="searchRecord" id="searchRecord4" type="text" size="8" maxlength="8"> 
<input name="searchRecord" id="searchRecord5" type="text" size="8" maxlength="8"> 
<input name="searchRecord" id="searchRecord6" type="text" size="8" maxlength="8">' 
```

这是片段

```
var js = req.responseText;
eval(js);

if (qdb_numrows == 0); {
    var x = true;
    var msg = "Precert 1:\n";
    if (document.getElementById('searchRecord1').value == qdb_numrows == 0) {
        if (qdb_numrows == 0) //only receive focus if its the first error
        document.getElementById('searchRecord1').focus();
        //change border to red on error (i would use a class change here...
        document.getElementById('searchRecord1').style.border = "solid 1px red";
        alert(msg = "Error: Data entered for field #1 not required for procedure code Or procedure code is not valid!\n");
        valid = false;
    }
    if (document.getElementById('searchRecord2').value == qdb_numrows == 0) {
        if (qdb_numrows == 0) document.getElementById('searchRecord2').focus();
        document.getElementById('searchRecord2').style.border = "solid 1px red";
        alert(msg += "Error: Data entered for field #2 not required for procedure code Or procedure code is not valid!\n");
        valid = false;
    }
    if (document.getElementById('searchRecord3').value == qdb_numrows == 0) {
        if (qdb_numrows == 0) //only receive focus if its the first error
        document.getElementById('searchRecord3').focus();
        //change border to red on error (i would use a class change here...
        document.getElementById('searchRecord3').style.border = "solid 1px red";
        alert(msg = "Error: Data entered for field #3 not required for procedure code Or procedure code is not valid!\n");
        valid = false;
    }
    if (document.getElementById('searchRecord4').value == qdb_numrows == 0) {
        if (qdb_numrows == 0) //only receive focus if its the first error
        document.getElementById('searchRecord4').focus();
        //change border to red on error (i would use a class change here...
        document.getElementById('searchRecord4').style.border = "solid 1px red";
        alert(msg = "Error: Data entered for field #4 not required for procedure code Or procedure code is not valid!\n");
        valid = false;
    }
    if (document.getElementById('searchRecord5').value == qdb_numrows == 0) {
        if (qdb_numrows == 0) //only receive focus if its the first error
        document.getElementById('searchRecord5').focus();
        //change border to red on error (i would use a class change here...
        document.getElementById('searchRecord5').style.border = "solid 1px red";
        alert(msg = "Error: Data entered for field #5 not required for procedure code Or procedure code is not valid!\n");
        valid = false;
    }
    if (document.getElementById('searchRecord6').value == qdb_numrows == 0) {
        if (qdb_numrows == 0) //only receive focus if its the first error
        document.getElementById('searchRecord6').focus();
        //change border to red on error (i would use a class change here...
        document.getElementById('searchRecord6').style.border = "solid 1px red";
        alert(msg = "Error: Data entered for field #6 not required for procedure code Or procedure code is not valid!\n");
        valid = false;
    }

    //if (!qdb_numrows==0) alert(msg);
    //return false;
} 
```

# spring-mvc - Spring MVC 中的下拉值绑定

> ID：13480694
> 
> 赞同：9
> 
> 时间：2012-11-20T19:32:36.033
> 
> 标签：spring-mvc

我是 Spring MVC 的新手。我正在编写一个使用 Spring、Spring MVC 和 JPA/Hibernate 的应用程序我不知道如何让 Spring MVC 将来自下拉列表的值设置为模型对象。我可以想象这是一个非常常见的场景

这是代码：

发票.java

```
@Entity
public class Invoice{    
    @Id
    @GeneratedValue
    private Integer id;

    private double amount;

    @ManyToOne(targetEntity=Customer.class, fetch=FetchType.EAGER)
    private Customer customer;

    //Getters and setters
} 
```

客户.java

```
@Entity
public class Customer {
    @Id
    @GeneratedValue
    private Integer id;

    private String name;
    private String address;
    private String phoneNumber;

    //Getters and setters
} 
```

发票.jsp

```
<form:form method="post" action="add" commandName="invoice">
    <form:label path="amount">amount</form:label>
    <form:input path="amount" />
    <form:label path="customer">Customer</form:label>
    <form:select path="customer" items="${customers}" required="true" itemLabel="name" itemValue="id"/>                
    <input type="submit" value="Add Invoice"/>
</form:form> 
```

发票控制器.java

```
@Controller
public class InvoiceController {

    @Autowired
    private InvoiceService InvoiceService;

    @RequestMapping(value = "/add", method = RequestMethod.POST)
    public String addInvoice(@ModelAttribute("invoice") Invoice invoice, BindingResult result) {
        invoiceService.addInvoice(invoice);
        return "invoiceAdded";
    }
} 
```

调用 InvoiceControler.addInvoice() 时，将接收 Invoice 实例作为参数。发票的金额符合预期，但客户实例属性为空。这是因为 http post 提交了客户 ID，而 Invoice 类需要一个 Customer 对象。我不知道转换它的标准方法是什么。

我已经阅读了关于 Controller.initBinder()，关于 Spring 类型转换（在[http://static.springsource.org/spring/docs/current/spring-framework-reference/html/validation.html](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/validation.html)中），但我不知道如果这是这个问题的解决方案。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T19:53:35.050

您已经注意到的技巧是注册一个自定义转换器，它将 id 从下拉列表转换为自定义实例。

您可以这样编写自定义转换器：

```
public class IdToCustomerConverter implements Converter<String, Customer>{
    @Autowired CustomerRepository customerRepository;
    public Customer convert(String id) {
        return this.customerRepository.findOne(Long.valueOf(id));
    }
} 
```

现在用 Spring MVC 注册这个转换器：

```
<mvc:annotation-driven conversion-service="conversionService"/>

<bean id="conversionService"
    class="org.springframework.format.support.FormattingConversionServiceFactoryBean">
    <property name="converters">
       <list>
          <bean class="IdToCustomerConverter"/>
       </list>
    </property>
</bean> 
```

# wpf - 我的 URI 必须如此长且明确吗？

> ID：13480696
> 
> 赞同：2
> 
> 时间：2012-11-20T19:32:41.697
> 
> 标签：wpf, mvvm, prism, unity-container

我正在使用 Microsoft Prism 和 Unity编写**模块化应用程序。**我的应用程序的 Shell 项目会加载各种 DLL，这些 DLL 都包含它们自己的 /resources 或 /images 文件夹和用户界面视图。因此，每个模块都是一个 DLL。

当我尝试在我的应用程序中使用资源时，似乎我必须非常明确地说明它的位置才能使其工作。例如，要在同一模块/dll 中定位图像：

```
<Image Source="pack://application:,,,/MyCompany.MyProduct.MyModule;Component/Images/ZoomIn.gif" /> 
```

我真的必须每次都使用长格式的 URI 吗？我尝试过较短的版本，例如：

```
pack://application:,,,/Images/ZoomIn.gif

Images/ZoomIn.gif

ZoomIn.gif 
```

等等

我想也许那里的第二个版本应该可以工作。当我看到 Uri 示例时，他们经常说“相对于当前程序集”。这是正在运行的可执行程序的程序集吗？或者这是代码所属的程序集（我的库/模块）？

**更新：**

在彼得汉森的帮助下，我能够将其缩短为：

```
<Image Source="../Images/ZoomOut.png" /> 
```

显然我必须使用 ../ 因为我的视图位于子文件夹中。我也可以不使用 pack:// 语法，因为类型转换器会为我执行此操作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T22:08:59.640

在 WPF 中检索二进制资源时有几个不同的选项，它们都取决于您想要哪种行为。

1.  如果您的资源应该嵌入到程序集中，请将它们添加到 Visual Studio 中的项目中，并将*Build Action*设置为*Resource*。这样它们将被烘焙到组件中，因此不能轻易更改。

2.  如果它们应该保留为松散文件，请将它们添加到项目中，并将*Build Action*设置为*Content*。还要确保它们被复制到输出目录。这是一个好主意，如果您需要经常更换它们，并且不想每次都重新编译程序集。

3.  如果您希望它们作为松散文件，但由于某种原因不想将它们包含在您的 Visual Studio 解决方案中（可能它们在编译时未知），您可以使用完整路径或使用称为 SiteOfOrigin 表示法的东西来访问它们。我不会讨论这个，因为这与你的情况无关。

要从您的代码中访问资源，您可以使用 Pack URI，它可以有不同的形式：

*   `pack://application:,,,/img.jpg`
    在项目的根目录中引用图像。

*   `pack://application:,,,/Folder1/Folder2/img.jpg`
    参考项目子文件夹中的图像。

*   `pack://application:,,,/NameOfDll;Component/img.jpg`
    在 Visual Studio 中引用的不同程序集中引用图像。

幸运的是，当从 XAML 引用资源时，无需编写完整的 URI。
基本上`pack://application:,,,`可以避免该部分，因为存在可以为您将部分位置转换为完整 URI 的 TypeConverter。

对于上面的第 1 点和第 2 点，使用相同的 XAML 来引用资源，无论它们在执行时是作为程序集旁边的松散文件存在还是嵌入其中。

但是，在从过程代码中引用资源时，必须使用完全定义的显式 URI。

我已经编写了一些代码并包含了一些图像，以展示它是如何工作的。

![显示正在运行的程序的图像](../Images/850d40d60b9adc2b8876f4bd67ea4b57.png) ![解决方案资源管理器视图的图像](../Images/d78cfd5c561f838dcdc8485efdd28666.png)

相关 XAML：

```
<StackPanel>
    <TextBlock Text="Embedded in same assembly" />
    <Image Source="gift.png" />
</StackPanel>

<StackPanel>
    <TextBlock Text="Embedded in same assembly in a subfolder" />
    <Image Source="Content/Images/gift.png" />
</StackPanel>

<StackPanel>
    <TextBlock Text="Embedded in same assembly in a subfolder using full pack URI format" />
    <Image Source="pack://application:,,,/Content/Images/gift.png" />
</StackPanel>

<StackPanel>
    <TextBlock Text="Embedded in different assembly" />
    <Image Source="/Module1;Component/gift.png" />
</StackPanel>

<StackPanel>
    <TextBlock Text="Embedded in different assembly in a subfolder" />
    <Image Source="/Module1;Component/Images/gift.png" />
</StackPanel>

<StackPanel>
    <TextBlock Text="Embedded in different assembly in a subfolder using full Pack URI format" />
    <Image Source="pack://application:,,,/Module1;Component/Images/gift.png" />
</StackPanel>

<StackPanel>
    <TextBlock Text="Setting imagesource from code-behind" />
    <Image x:Name="image1" />
</StackPanel> 
```

相关代码隐藏：

```
public Window1()
{
    InitializeComponent();

    //Here we have to use the full Pack URI
    //image1.Source = new BitmapImage(new Uri("/Module1;Component/Images/gift.png")); //Throws exception..
    image1.Source = new BitmapImage(new Uri("pack://application:,,,/Module1;Component/Images/gift.png"));
} 
```

**更新**
当资源在使用它的同一个程序集中时，应该没有理由包含`/NameOfDll;Component/`URI 的一部分。我不确定为什么它不适用于您的情况。

我在 Module1 中添加了一个窗口，它只在自己的程序集中引用了一个图像，这似乎工作正常。在 WPF 应用程序中单击按钮时会显示该窗口。

```
<Window x:Class="Module1.WindowTest"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300"
             Title="Window from Module1">
    <Grid>
        <Image Source="Images/gift.png" />
    </Grid>
</Window> 
```

![显示显示资源的不同窗口](../Images/54daa2071fcfee0987f7e5758bc6368e.png)

# asp.net - 嵌套用户控件无法访问渲染中的页面上下文

> ID：13480700
> 
> 赞同：0
> 
> 时间：2012-11-20T19:32:52.723
> 
> 标签：asp.net, vb.net, user-controls, custom-controls

这个问题似乎与[如何从用户控件访问页面控件有关？](https://stackoverflow.com/questions/10053541/how-to-access-page-controls-from-user-control)，但我不相信它是重复的。

我有许多用户控件需要在他们的事件`Page`期间访问该变量。`Render`当我将控件放在 .aspx 页面上时，这可以正常工作。但是，当我尝试像这样嵌套控件时：

```
Protected Overrides Sub Render(ByVal writer As HtmlTextWriter)
    Dim nestedControl = New CustomControl()

    helpIcon.RenderControl(writer)

    MyBase.Render(writer)
End Sub 
```

`Variable cannot be null: Page`我从（嵌套的控件）`Render`事件中得到一个异常。`CustomControl`

有没有一种简单的方法来解决这个问题，以便在另一个控件的代码中构造的控件可以访问页面上下文？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:52:11.423

我看到控件的页面属性为空的唯一一次是控件尚未添加到控件集合中：例如

```
Me.Controls.Add(helpIcon) //This must happen before calling render 
```

如果将控件添加到有根控件集合中，则无需调用 render 方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T20:13:16.063

您需要将控件添加到页面的控件树中，然后它将正常呈现而无需调用 Render()

```
Page.Controls.Add(new CustomControl()); 
```

您更有可能将其添加到页面上的某个容器中：

```
PlaceHolder1.Controls.Add(new CustomControl()); 
```

# javascript - 如何在ajax调用之前创建延迟？

> ID：13480706
> 
> 赞同：4
> 
> 时间：2012-11-20T19:33:16.703
> 
> 标签：javascript, jquery

我正在使用 jQuery 1.8。

我有一系列复选框，用户可以检查这些复选框以获取有关特定产品的信息。选中该框时，将调用一个函数并将产品信息加载到 div 中。目前，该功能在每次点击后立即触发。因此，如果访问者选中所有五个框，则将进行五次 ajax 调用。

我想要的是一旦访问者停止点击，该功能会在一段时间后触发。该函数应该只触发一次。延迟的目的是限制调用次数，创造更流畅的用户体验。

这是我的 HTML：

```
<input type='checkbox' class='SomeClass' data=prodid='1'> 1 
<input type='checkbox' class='SomeClass' data=prodid='2'> 2
<input type='checkbox' class='SomeClass' data=prodid='3'> 3
<input type='checkbox' class='SomeClass' data=prodid='4'> 4
<input type='checkbox' class='SomeClass' data=prodid='5'> 5
<div id='ProductInfoDiv'></div> 
```

这是我的伪 JavaScript：

```
// set vars
$Checkbox = $('input.SomeClass');
$ProductInfoDiv = $('div#ProductInfoDiv');

// listen for click
$Checkbox.click(getProductInfo);

// check which boxes are checked and load product info div
getProductInfo = function() {

    // create list of product id from boxes that are checked
    var QString = $Checkbox.filter(":checked");

    // LOAD THE PRODUCT DIV
    $ProductInfoDiv.load('SomePage.cfm?'+QString);

} 
```

那么，我该把延迟放在哪里呢？如何确保该功能只触发一次？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T19:38:28.820

带有 clearTimeout 的 setTimeout 将完成此操作。每次点击都会做

```
var timeout = null;

$(element).click(function(){
    if(timeout)
    {
        clearTimeout(timeout);
    }

    timeout = setTimeout([some code to call AJAX], 500);
}) 
```

每次单击时，如果超时，它会被清除并在 500 毫秒后重新启动。这样，在用户停止点击 500 毫秒之前，ajax 永远不会触发。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T19:38:14.533

```
// set vars
$Checkbox = $('input.SomeClass');
$ProductInfoDiv = $('div#ProductInfoDiv');

// listen for click
$Checkbox.click(getProductInfo);
var timeout;
var timeoutDone = function () {
    $ProductInfoDiv.load('SomePage.cfm?'+QString);
}
// check which boxes are checked and load product info div
getProductInfo = function() {

    // create list of product id from boxes that are checked
    var QString = $Checkbox.filter(":checked");

    // LOAD THE PRODUCT DIV
    clearTimeout(timeout);
    timeout = setTimeout(timeoutDone, 4000);

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-20T19:38:20.040

```
var clickTimer = false;

// listen for click
$Checkbox.click(function(){
   if(clickTimer) { 
      // abort previous request if 800ms have not passed
      clearTimeout(clickTimer);
   }

   clickTimer = setTimeout(function() {
       getProductInfo();
   },800); // wait 800ms
}); 
```

这里的工作示例：http: [//jsfiddle.net/Th9sb/](http://jsfiddle.net/Th9sb/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T19:53:42.630

在ajax请求完成之前是否可以禁用复选框？

```
$('.SomeClass').on('click', function(e) {
    $('.SomeClass').attr('disabled', true);

    //-- ajax request that enables checkboxes on success/error
    $.ajax({
        url: "http://www.yoururl.com/",
        success: function (data) {
            $('.SomeClass').removeAttr('disabled');
        },
        error: function(jqXHR, textStatus, errorThrown) {
            $('.SomeClass').removeAttr('disabled');
        }
    });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T19:38:41.540

我想你必须把它放在这里

```
$Checkbox.click(getProductInfo); 
```

它应该是这样的：工作示例在这里--> [http://jsbin.com/umojib/1/edit](http://jsbin.com/umojib/1/edit)

```
$Checkbox.one("click", function() {
  setTimeout(function() {
   getProductInfo();
  },200);
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-10T17:10:24.860

*如果您被允许添加另一个库。*

**Underscore**有一个**debounce**功能，非常适合你想要的。

```
function callback(){
    // some code to call AJAX
}

$(element).click(_.debounce(callback, 500)) 
```

```

# android - 将单选组添加到自定义对话框

> ID：13480707
> 
> 赞同：4
> 
> 时间：2012-11-20T19:33:20.900
> 
> 标签：android, dialog, radio-button

我正在尝试将单选按钮动态添加到自定义对话框，但无法将其添加到我的自定义对话框中

```
 final RadioButton[] rb = new RadioButton[5];
 RadioGroup rg = new RadioGroup(this); 
 rg.setOrientation(RadioGroup.VERTICAL);

        // layout params to use when adding each radio button
 LinearLayout.LayoutParams layoutParams = new RadioGroup.LayoutParams(
                RadioGroup.LayoutParams.WRAP_CONTENT,
                RadioGroup.LayoutParams.WRAP_CONTENT);

 LinearLayout ll2 = (LinearLayout) findViewById(R.id.linearMain);

 // add 5 radio buttons to the group

 for (int i = 0; i < 5; i++){
      rb[i] = new RadioButton(this);
      String label = "item set" + i;
      rb[i].setText(label);
      rb[i].setId(i);
      rg.addView(rb[i],layoutParams);

      }
 ll2.addView(rg);

--------------------------------------------------------------------

 Context context=LocationActivity.this;
 dialog=new Dialog(context);
 dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);

 dialog.setContentView(R.layout.custom_dialog);
     ----------------------------------------------------------------------

 Linearlayout2 is defined in custom_dialog.xml file. I must be doing something wrong but not able to figure it out. Other widgets are getting displayed except radiogroup buttons. 
```

任何指向此问题的指针都值得赞赏。

谢谢！瑞士

custom_dialog 文件如下：

它有 2 个 textview 小部件和一个声明的 radiogroup。我能够成功地将相同的布局添加到活动屏幕，但不能添加到自定义对话框。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
android:id="@+id/linlayoutBase"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical"
xmlns:android="http://schemas.android.com/apk/res/android"
>

    <LinearLayout
        android:id="@+id/linearLayout3"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/TextView03"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="10dip"
            android:layout_marginRight="5dip"
            android:text="Longitute: "
            android:textSize="20dip" >
        </TextView>

        <TextView
            android:id="@+id/TextView04"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="unknown"
            android:textSize="20dip" >
        </TextView>
    </LinearLayout>

    <LinearLayout
          android:id="@+id/linearMain"
          android:layout_width="match_parent"
          android:layout_height="wrap_content">

    <RadioGroup
          android:id="@+id/radiogroup"
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          xmlns:android="http://schemas.android.com/apk/res/android"
          android:orientation="vertical"
    >
    </RadioGroup>

    </LinearLayout>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T19:58:37.097

查看您发布的 XML，试试这个：

```
Context context=LocationActivity.this;
dialog=new Dialog(context);
dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);

View view = LayoutInflater.fromContext(context).inflate(R.layout.custom_dialog, null, false);
RadioGroup rg = (RadioGroup) view.findViewById(R.id.radiogroup);
RadioGroup.LayoutParams layoutParams = new RadioGroup.LayoutParams(
                RadioGroup.LayoutParams.WRAP_CONTENT,
                RadioGroup.LayoutParams.WRAP_CONTENT);

 // add 5 radio buttons to the group
RadioButton rb;
for (int i = 0; i < 5; i++){
    rb = new RadioButton(context);
    rb.setText("item set" + i);
    rb.setId(i);
    rg.addView(rb, layoutParams);
}

dialog.setContentView(view); 
```

我没有看到您如何更改对话框布局。所以我膨胀了布局，添加了 RadioButtons，然后将完成的布局传递给`dialog`.

此外，因为`linearMain`只有一个孩子，您可以删除此 LinearLayout 并简单地使用`radioGroup`.

# core-data - IOS - 搜索/过滤后，如何选择 rowAtIndexPath

> ID：13480708
> 
> 赞同：-1
> 
> 时间：2012-11-20T19:33:21.700
> 
> 标签：core-data, ios6, uisplitviewcontroller

我有一个 splitView 应用程序，我在其中安装了搜索/过滤。

过滤适用于主视图，但我不知道如何设置“didSelectRowAtIndexPath”。似乎 Root 和 Detail 之间的链接丢失了。

我尝试使用以下代码重新连接：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    indexPath = [self.tableView indexPathForSelectedRow];

     if (tableView == self.searchDisplayController.searchResultsTableView)
     {
         self.selectedItem = [self.searchResults objectAtIndex:indexPath];
     }
     else
     {
         self.selectedItem = [self.fetchedResultsController objectAtIndexPath:indexPath];
     }

    detailViewController.item = self.selectedItem;
    [self.detailViewController.tableView reloadData]; 
```

但这并没有给我一个 NSRangeException。

如果相反，我使用：

```
self.selectedItem = [self.searchResults objectAtIndex:indexPath.row]; 
```

也不例外，但未捕获详细视图。

我会很感激任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T20:36:33.883

没有必要（也可能是错误的）打电话

```
indexPath = [self.tableView indexPathForSelectedRow]; 
```

因为选定的行作为参数提供给`tableView:didSelectRowAtIndexPath:`.

# rss - 使用 Google 新闻 RSS URL 时如何指定检索本地新闻？

> ID：13480710
> 
> 赞同：5
> 
> 时间：2012-11-20T19:33:32.157
> 
> 标签：rss, google-api, google-news

我正在尝试构建一个用户谷歌新闻 RSS 的 RSS 解析器。只需定位以下 URL，我就可以从新闻 URL 中检索新闻文章：

```
https://news.google.com/news/section?output=rss 
```

但是，在谷歌新闻页面上，它们是检索您当前位置附近新闻的选项。浏览器中的这个 URL 是：

```
https://news.google.com/news/section?geo=detect_metro_area 
```

仅添加 output=rss 查询字符串参数不足以返回 RSS 格式的本地新闻。相反，我得到了一个非常空洞的回应：

```
<rss version="2.0">
<channel>
<generator>NFE/1.0</generator>
<title>News near you - Google News</title>
<link>
http://news.google.com/news?pz=1&ned=us&hl=en&geo=detect_metro_area
</link>
<language>en</language>
<webMaster>news-feedback@google.com</webMaster>
<copyright>&copy;2012 Google</copyright>
<pubDate>Tue, 20 Nov 2012 19:32:04 GMT</pubDate>
<lastBuildDate>Tue, 20 Nov 2012 19:32:04 GMT</lastBuildDate>
<image>
<title>News near you - Google News</title>
<url>
https://ssl.gstatic.com/news/img/logo/en_us/news.gif
</url>
<link>
http://news.google.com/news?pz=1&ned=us&hl=en&geo=detect_metro_area
</link>
</image>
<description>Google News</description>
</channel>
</rss> 
```

有谁知道他们是否可以从这个 RSS 提要中获取地理上靠近您的新闻？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:53:54.497

据我所知，您需要确定您自己，因为该网站需要使用设备上的机制或登录的用户帐户自动确定您的位置。但是，如果您想根据包含城市或地区的新闻进行查询，您可以对纽约执行类似的操作。如果你将它与设备上的一些地理位置功能结合起来，那么你应该能够获得你想要的新闻。

[https://news.google.com/news/section?output=rss&q=New%20York](https://news.google.com/news/section?output=rss&q=New%20York)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-21T00:13:05.827

将 ?geo=detect_metro_area 替换为 ?geo=*邮政编码*

如[https://news.google.com/news/section?geo=90210](https://news.google.com/news/section?geo=90210)

对于 RSS，它将是[https://news.google.com/news/feeds?geo=90210&output=rss](https://news.google.com/news/feeds?geo=90210&output=rss)

# c# - 每天轮换阵列？

> ID：13480711
> 
> 赞同：0
> 
> 时间：2012-11-20T19:33:35.327
> 
> 标签：c#

我有五种颜色的数组，我想每天在标题中旋转进出。我将如何在 C# 中在语法上执行此操作？我可以很容易地用 Javascript 编写它，但不能用 C# 编写。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T19:36:05.197

您可以使用一年中的当前日期作为旋转颜色的方式。

```
var color = colors[DateTime.Now.DayOfYear % 5]; 
```

# c# - 二维数组中的寻路

> ID：13480714
> 
> 赞同：3
> 
> 时间：2012-11-20T19:33:43.250
> 
> 标签：c#, arrays, queue, 2d, path-finding

我目前正在做一个项目，在该项目中我必须使用包含随机数的二维数组执行任务。该数组形成一个网格，表示一座山的山峰（高度）。我解决了除最后一项之外的所有任务：

最后一项任务是查找是否存在从最小峰值到最高峰值的路径（不一定是最短的）。路径应该由不断增长的山峰组成，我不能踩到较低的山峰。

为简单起见，这里有一个示例，表示为 3x3 网格（原始的要大得多，并且不必像正方形，它是根据用户的需要生成的，并且数字是完全随机的）。

```
2  4  5    
1  3  8
9  7  10 
```

可能的方式是 1-3-7-10、1-3-8-10、1-2-4-5-8-10。

我很确定，我应该使用某种递归。我读到了一个*探路者，但要使用它，我必须有一个带有“障碍”的“地图”（我无法跨过的节点=较小的峰），而这正是我无法制作的，因为您只能在旅途中找到它。

我的意思是我可以将数字 7 放在“例外列表”上——因为步骤 1-9-7 是被禁止的，但步骤 1-3-7-10 是完美的，所以将 7 放在例外列表上是错误的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T19:49:40.157

关键是首先将您的数组转换为“有向图”，这是一个有向图，仅包含根据您的规则的有效单元格到单元格的移动。这个有向图将是一个数组或条目列表，包括： {FromCell, ToCell}

您的有向图将包含如下数据：

```
2,4
4,5
5,8
1,2
1,3
1,9
3,4
3,8
3,7
8,10
7,10 
```

从这里您应该能够应用 A* 算法或其他任何算法。

（注意：我没有发布完整的答案，因为我假设您想自己这样做）

* * *

也就是说，您可以通过回溯进行强力递归搜索。这是最简单的解决方案，尽管可能不是最有效的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:49:53.613

您可以执行以下操作：

1.  从您的矩阵创建一个加权图（每条边的权重将是 abs（两个节点的值之间的差异））

    ```
    2 - 4 - 5

    |   |   |

    1 - 3 - 8

    |   |   |

    9 - 7 - 9 
    ```

(2, 4) 的权重为**abs(4 - 2) = 2**

(4, 5) 的权重为**abs(4 - 5) = 1**

1.  应用考虑边缘权重的最短路径算法[http://www.informatics.susx.ac.uk/courses/dats/notes/html/node147.html](http://www.informatics.susx.ac.uk/courses/dats/notes/html/node147.html)

2.  删除节点值不上升的解决方案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-05T20:11:12.707

（我修复了帖子并将答案放在这里。）

**这就是我最终解决它的方法：**

因为我已经有了最小和最大的位置，所以我用零包围了原始数组。零是数组的全局最小值，因为默认情况下我从不生成零。有了这个，我不必每次都检查我是否在外面或在数组中（我只踩更大的数字）。

我创建了两个队列（QueueX，QueueY）。从最小的数字开始（我在开始时排队进入队列的位置，给数组 t[x,y] 的 x,y 变量，然后出队）。

然后，我将每个较大数字的“坐标”排入相应的队列中。如果我在实际点 (t[x,y]) 周围找到了所有更大的数字，我将下一个 X,Y 坐标排入队列，这将是新的实际点（如开头所述）。并且检查重复。

整个事情都在一个while循环中，当其中一个队列清空时，它会保持不变。

如果在任何给定的检查中 X,Y 与最大峰值的 X,Y 坐标相同，我返回并且存在路径。在 while 循环结束时，如果 X,Y 与 max 的 X,Y 不同，则没有路径。

我希望我的解释可以理解，英语不是我的母语。如果你愿意，我可以在这里发布代码。

# php - mysql while in mysql while - 优化

> ID：13480718
> 
> 赞同：0
> 
> 时间：2012-11-20T19:34:03.487
> 
> 标签：php, mysql

我有代码：

```
$somevar=mysql_query("SELECT * FROM feed");
while ($fetched=mysql_fetch_array($somevar)) {

  $nextvar=mysql_query("SELECT FROM comments WHERE feed_id='".$fetched['id']."'");
  while ($anotherfetch=mysql_fetch_array($nextvar)) {
    echo $anotherfetch['comment'];
  }

  echo $fetched['person'].$fetched['text'];
} 
```

表结构：

```
feed
id | person | text

comments
id | feed_id | person | comment 
```

优化它的最佳解决方案是什么，有可能吗？我知道在一段时间内犯下一个大错误，但看起来没有其他办法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:02:24.120

听起来你想要这样的东西：

```
SELECT person, 
       comment 
  FROM feed f 
         INNER JOIN comments c 
         ON f.id = c.feed_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:45:14.327

a`while`中的A`while`与其说是嵌套查询的问题，不如说是问题。这通常表明存在[N+1 问题](https://stackoverflow.com/questions/97197/what-is-the-n1-selects-problem)。

虽然有[不同的解决方案](http://phpadvent.org/2011/a-stitch-in-time-saves-nine-by-paul-jones)，但我对您的建议是使用 a`JOIN`并根据需要将数据拼接在一起。

此外，如评论中所述，请不要使用这些`mysql_*`功能，因为它们处于[弃用过程中](http://news.php.net/php.internals/53799)。改用[MySQLi](http://php.net/manual/en/book.mysqli.php)或[PDO](http://php.net/manual/en/book.pdo.php)，[成为更好的 PHP 开发人员](http://jason.pureconcepts.net/2012/08/better-php-developer/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:45:25.880

这通常是一个坏习惯，在循环内部运行*N*个查询，循环执行的次数取决于外部查询返回的行数。风险是外部查询返回 1000 行，然后你的代码执行 1000 次内部查询，这有很大的开销。

还有一个问题是 MySQL 不允许客户端在外部查询仍在进行中时执行新查询。也就是说，外部查询仍然有结果要返回。解决方法是由 PHP mysql 客户端透明地完成，它在内部已经从外部查询中获取了*所有结果。*调用`mysql_fetch_array()`实际上只是迭代它已获取并保存在内存中的数据。

您应该学习如何使用`JOIN`查询来避免这种反模式。

# artificial-intelligence - SVM 和无效类别

> ID：13480729
> 
> 赞同：0
> 
> 时间：2012-11-20T19:35:00.847
> 
> 标签：artificial-intelligence, classification, svm, libsvm

我想在我的 SVM 分类中有一个无效的类别。例如考虑水果分类，我想要 APPLE、ORANGE、BANANA 和“NOT FRUIT”（无效）。我想知道是否最好为每个类别创建一个二进制 SVM 分类器（一个用于 APPLE，一个用于 ORANGE 等），或者创建一个将无效类别作为类别之一的 SVM 分类器，并为其提供无效的训练数据。

更具体地说，我有一个分类时间序列数据的分类器。我需要将一些美联储时间序列分类为无效类别（或基本上不是所需类别）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:43:53.423

这取决于您的 SVM 包。如果您使用的是 libsvm，则可以有几个“正”类。只需将“无效”类称为 0，将 apple 称为 1，将 orange 称为 2，依此类推。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-02T16:54:09.863

no_fruit 只是另一个类。你需要的是[多类分类](http://en.wikipedia.org/wiki/Multiclass_classification)。SVM 通过超平面分离类，因此您需要在顶部使用另一种算法。现在大多数包都提供这样的多类分类，但性能上存在差异。

1.  他们每堂课都针对其他人
2.  他们对每个人都做

无论你先做什么，你都会有多个结果（石头剪刀布）

1.  在这种情况下，您可能有 0 到 n 个阳性
2.  在这种情况下，您可能有 1 到 n 个班级，有 1 到 n-1 票

我建议使用一个也可以进行投票的库。

尽管您说的是*“时间序列数据”*。听起来不像水果，可能还有其他要求

# windows - 输出到文本文件时在新行上设置内容

> ID：13480734
> 
> 赞同：0
> 
> 时间：2012-11-20T19:35:23.857
> 
> 标签：windows, file, powershell, text

我有一个脚本，它要求用户使用 Windows 富文本框表单输入信息，每条信息都在不同的行上输入，然后脚本将信息添加到文本文件中，但我希望它通过分隔信息新线的意思。下面是我正在使用的代码：目前将信息添加为一段文本，没有任何空格或行。任何帮助，将不胜感激

```
cls
[void] [System.Reflection.Assembly]::LoadWithPartialName("System.Drawing") 
[void] [System.Reflection.Assembly]::LoadWithPartialName("System.Windows.Forms") 

$objForm = New-Object System.Windows.Forms.Form 
$objForm.Text = "Till's to Update"
$objForm.Size = New-Object System.Drawing.Size(300,550) 
$objForm.StartPosition = "CenterScreen"

$OKButton = New-Object System.Windows.Forms.Button
$OKButton.Location = New-Object System.Drawing.Size(75,480)
$OKButton.Size = New-Object System.Drawing.Size(75,23)
$OKButton.Text = "OK"
$OKButton.Add_Click({$x=$RichTextBox.Text;$objForm.Close()})
$objForm.Controls.Add($OKButton)

$CancelButton = New-Object System.Windows.Forms.Button
$CancelButton.Location = New-Object System.Drawing.Size(150,480)
$CancelButton.Size = New-Object System.Drawing.Size(75,23)
$CancelButton.Text = "Cancel"
$CancelButton.Add_Click({$objForm.Close()})
$objForm.Controls.Add($CancelButton)

$objLabel = New-Object System.Windows.Forms.Label
$objLabel.Location = New-Object System.Drawing.Size(10,20) 
$objLabel.Size = New-Object System.Drawing.Size(280,20) 
$objLabel.Text = "Please enter information:"
$objForm.Controls.Add($objLabel) 

$RichTextBox = New-Object System.Windows.Forms.richtextbox 
$RichTextBox.Location = New-Object System.Drawing.Size(10,80) 
$RichTextBox.Size = New-Object System.Drawing.Size(260,320)
$objForm.Controls.Add($RichTextBox) 

$objForm.Topmost = $True

$objForm.Add_Shown({$objForm.Activate()})
[void] $objForm.ShowDialog()

$x

Set-Content -Value  `n$x`n -Path c:\Computers.txt 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:47:29.263

通过 `n 拆分文本并将其通过管道传输到文件。您可以删除脚本中的最后两行。

```
$OKButton.Add_Click({
    $RichTextBox.Text -split "`n" | Set-Content -Path c:\Computers.txt
    $objForm.Close()
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:49:15.857

更改这些行

```
$x
Set-Content -Value  `n$x`n -Path c:\Computers.txt 
```

和

```
set-content -Value ($RichTextBox.text -split "`n" ) -Path c:\Computers.txt 
```

或者

```
set-content -Value $RichTextBox.Lines -Path c:\Computers.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:46:01.210

RichTextBox 想要为您提供 RTF 格式的文本。当您要求 Text 时，我认为它会剥离格式代码并只给您字母和空格，我认为它不会将其变成轻量级的 ascii 格式。

您可能想要使用 .Lines 属性，它返回一个字符串[]，您可以循环并写入文件。

参考：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.textboxbase.lines.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.textboxbase.lines.aspx)

# javascript - 尝试使用“Monthpicker”Jquery UI 小部件并绑定更改

> ID：13480740
> 
> 赞同：0
> 
> 时间：2012-11-20T19:35:44.530
> 
> 标签：javascript, jquery, date

我正在使用[http://lucianocosta.info/jquery.mtz.monthpicker/](http://lucianocosta.info/jquery.mtz.monthpicker/)来显示仅显示月份和年份的“日历”。

我的 Javascript 来初始化它是

```
var Year = new Date().getFullYear();
var Month = new Date().getMonth() + 1;
$(document).ready(function() {

     $('#monthpicker_widget').monthpicker({
        startYear: 2011,
        finalYear: new Date().getFullYear()
    });

     $('#monthpicker_widget').bind('onchange',function(e){
        alert("input change");
     });
}); 
```

在我的 HTML 中，我有这个

```
 <p> Date: <input id="monthpicker_widget" class="mtz-monthpicker-widgetcontainer" type="text"> </p> 
```

这就是我想要的...

我希望输入字段立即显示当前月份/年份。因此，当页面加载时，我想要 11/2012。当用户点击输入字段时，它会弹出 MonthPicker 小部件（它目前是）。当用户选择不同的年份或月份时，我希望输入字段更新——它目前正在这样做。虽然如果我刷新页面，它不会恢复到当前日期。

我想要做的是在用户更改月份和年份数据时使用它。我在表格中使用它来根据月/年显示不同的数据。我上面的绑定方法在输入更改时不显示警报。

有关解决此问题的任何建议？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:49:19.720

由于单击一个月是更新文本框的唯一方法（更改年份并单击框外将其关闭但不更新文本，我认为这是一个错误！），您可以处理`monthpicker-click-month`如图所示的事件[文档](http://lucianocosta.info/jquery.mtz.monthpicker/)：_

```
$('#events_widget').monthpicker().bind('monthpicker-click-month', function (e, month) {
    alert('You clicked on month ' + month);
}); 
```

作为旁注，我会考虑使用标准的[jQuery UI Datepicker](http://jqueryui.com/datepicker/)并根据您的喜好对其进行自定义，因为它受到更多支持并且没有上述错误。

# javascript - IE9：hasOwnProperty 技巧不起作用？

> ID：13480745
> 
> 赞同：3
> 
> 时间：2012-11-20T19:35:56.307
> 
> 标签：javascript, internet-explorer, prototype, hasownproperty

有据可查的是，IE 中的原生 DOM 元素不包含 hasOwnProperty() 方法。有几个解决方案；其中最优雅的是直接在 Object.prototype 中访问 hasOwnProperty() 方法，如下所示：

```
Object.prototype.hasOwnProperty.call(element, name); 
```

在我看来，这不再适用于 IE9。有人可以解释吗？这是一个说明这一点的[小提琴。](http://jsfiddle.net/fHRZs/)

在标准模式下使用 IE9 并关闭兼容模式，警报显示：

```
sessionStorage is supported: false
localStorage is supported: false 
```

但是，在打开兼容性或怪癖模式（或使用开发人员工具使用 IE8 和 IE7 引擎呈现页面）后，警报会显示：

```
sessionStorage is supported: true
localStorage is supported: true 
```

这里还有其他工作吗，或者 hasOwnProperty 的这种解决方法不再可用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T19:45:48.810

这是因为这些属性存储在原型链中，`window`而不是直接存储在对象上。

如果您使用`in`，它会为您搜索原型链，并为您`true`提供`IE9`.

```
var isSessionStorageSupported = "sessionStorage" in window; // true
var isLocalStorageSupported = "localStorage" in window;     // true 
```

[http://jsfiddle.net/fHRZs/2/](http://jsfiddle.net/fHRZs/2/)

`.hasOwnProperty()`给出正确的结果也是如此。

# c# - (type1)+(type2) 使用 GetType().ToString() 是什么意思？

> ID：13480756
> 
> 赞同：2
> 
> 时间：2012-11-20T19:36:28.503
> 
> 标签：c#, types, tostring, gettype

我正在编写一个小控制台应用程序来测试一些基本的 MS ProjectServer 互操作性。我可以毫无问题地连接到服务器，并且我试图将我的一个`for (int i = 0; i < projectDataSet.Project.Count; i++)`循环重构为一个循环`foreach (var project in projectDataSet.Project)`。

当我做的时候`for`，类型`projectDataSet.Project`是`SvcProject.ProjectDataSet.ProjectDataTable`。因此，我执行以下操作：

```
projectClient.ReadProject(projectDataSet.Project[i].PROJ_UID,
    SvcProject.DataStoreEnum.WorkingStore); 
```

获取我需要的项目对象。

但是当我做`foreach`变化时，对象的类型`project`是`SvcProject.ProjectDataSet+ProjectRow`. 我不知道如何处理这个。这到底是什么意思？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:43:19.220

这意味着`type2`嵌套在`type1`

```
class type1
{
   public class type2 { }
} 
```

为了证明这一点：

```
foreach (var t in typeof (A).GetNestedTypes(BindingFlags.Public | BindingFlags.NonPublic))
    Console.WriteLine(t.FullName);

class A
{
    private class B
    {
    }

    protected class C
    {
    }

    internal class D
    {
    }

    public class E
    {

    }
} 
```

输出：

```
YourAssembly.A+B
YourAssembly.A+C
YourAssembly.A+D
YourAssembly.A+E

```

# php - PHP 代码突然停止工作

> ID：13480757
> 
> 赞同：-1
> 
> 时间：2012-11-20T19:36:31.153
> 
> 标签：php, arrays, session

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:40:01.290

这是正确的。`$_SESSION`确实是您存储的会话变量数组。您的第二个代码不起作用，因为从技术上讲，您的数组中没有`valid`变量。`$_SESSION`最好使用：`if(!isset($_SESSION['valid']))`代替。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T20:56:59.227

感谢所有回复的人。原来这是会话存储的问题。

里面有一大堆垃圾文件。我们在几台虚拟机上安装了我们的 Web 服务器，而同一台机器上的其他几台服务器出现了问题。

我们将整个网站移到了一个新的虚拟机上，现在它运行良好。

不过，我*确实*了解了 isset() 的价值，所以这一天并没有完全浪费。

谢谢大家的帮助！感恩节快乐

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:14:20.363

感谢所有回复的人。原来这是会话存储的问题。

我查看了正确的路径，但是当我在机器上实际走到那里时，它充满了垃圾文件和带有坏字符的文件名。我们在同一台整体服务器上的多个虚拟机上运行了各种 Web 服务器，不同领域的其他几个也有问题。

我们将整个网站移到了一个新的虚拟机上，现在它运行良好。

不过，我*确实*了解了 isset() 的价值，因此我现在不仅可以向已注销的人显示错误，还可以向从未登录过的人显示错误，因此这一天并没有完全浪费。

再次感谢您的帮助，感恩节快乐

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T19:41:29.723

该通知告诉您该索引没有设置任何内容，因此`Undefined Index`

解决此问题的一种方法是`isset()`在进行比较或从中获取值之前检查变量是否已设置。

```
if (!isset($_SESSION['valid'])) { 
    session_destroy(); 
    die("<b>You must be logged into this application to use it</b>"); 
?> 
```

[http://www.php.net/manual/en/function.isset.php](http://www.php.net/manual/en/function.isset.php)

您可能还想检查您的会话文件夹是否可写（通常`/tmp/`）

```
if (!is_writable(session_save_path())) {
    echo session_save_path().'" is not writable!'; 
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T19:42:45.397

您可以将`if`语句更改为：

```
<?php 
if isset($_SESSION['valid']) && $_SESSION['valid'] == 'TRUE' ; ?> 
```

但是为什么要使用字符串 'TRUE' 来表示 php 在预定义的 boolean 中包含的内容`true`？

# c# - 包含循环，如果禁用引用跟踪，则无法序列化，json.net 和 webapi

> ID：13480760
> 
> 赞同：13
> 
> 时间：2012-11-20T19:36:57.997
> 
> 标签：c#, entity-framework, ef-code-first, asp.net-web-api, entity-framework-5

我收到错误：

```
 Object graph for type 'System.Collections.Generic.List`1[[Proj.Model.Prom, Proj.Model, 
 Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]' contains cycles and cannot be 
 serialized if reference tracking is disabled. 
```

阅读它，似乎是序列化程序，但 Json.Net 声称是解决方案，我已经阅读了 WebApi 和 Framework 4.5 默认情况下拥有它。那么它是默认出现的吗？如果是这样，为什么我仍然收到该错误？

谢谢！吉列尔莫。

编辑：添加代码

```
using System;
using System.Collections.Generic;
using System.Data.Spatial;

namespace Proj.Model
{
    public class Prom
    {
        public Prom()
        {
            this.Stores = new List<Store>();
            this.Branches = new List<Branch>();
            this.Products = new List<Product>();
        }

        public int Id { get; set; }
        public string Name { get; set; }
        public DbGeography Location { get; set; }
        public string Latitude { get; set; }
        public string Longitude { get; set; }
        public int StateId { get; set; }
        public int CategoryId { get; set; }

        public virtual ICollection<Store> Stores { get; set; }
        public virtual ICollection<Branch> Branches { get; set; }
        public virtual ICollection<Product> Products { get; set; }

        public virtual Category Category { get; set; }
        public virtual State  State  { get; set; }

    }
}

using System;
using System.Collections.Generic;

namespace Proj.Model
{
    public class Category
    {
        public Category()
        {
            this.Proms = new List<Prom>();
        }

        public int Id { get; set; }
        public string Name { get; set; }
        public string Description { get; set; }

        public virtual ICollection<Prom> Proms { get; set; }
    }
} 
```

然后运行这样的东西会返回错误

```
public IEnumerable<Category> GetList(int estadoId, string idTiposTarjetasList)
{
    var ids = "1,2,3,4".Split(',');
    var intIds = ids.Select(int.Parse);

    var Categories = Uow.Categorias.GetAllIncluding(c => c.Proms).ToList();
    foreach (var category in Categories)
    {
        var proms = category.Proms.Where(p => intIds.Contains(p.Id) && p.StateId == stateId).ToList();
        category.Proms = proms;
    }
    return Categories
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T20:09:31.403

默认情况下，WebApi 将“PreserveReferencesHandling”设置为 None。

您可以在 WebApiConfig.cs 中配置 Json.NET SerializerSettings：

```
config.Formatters.JsonFormatter.SerializerSettings.PreserveReferencesHandling = 
    Newtonsoft.Json.PreserveReferencesHandling.All; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-07-13T15:06:30.467

以下帮助了我：

```
config.Formatters.JsonFormatter.SerializerSettings.ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Ignore;
config.Formatters.JsonFormatter.SerializerSettings.PreserveReferencesHandling = Newtonsoft.Json.PreserveReferencesHandling.None; 
```

# linux - 使用 Qt Creator 和 Linux 提升

> ID：13480765
> 
> 赞同：6
> 
> 时间：2012-11-20T19:37:05.020
> 
> 标签：linux, boost, qt-creator

所以我补充说：

```
LIBS += 
       -lboost_system\                                                         
       -lboost_gregorian 
```

对于我的项目 .pro，但在 Creator 中显示“找不到 -lboost_system”。我尝试使用“UNCLUDEPATH”，但这破坏了所有库的路径。

任何人都知道如何将 boost::gregorian 与 Qt Creator 一起使用？

编辑：下面的工作使它得到认可，但破坏了所有其他库。

INCLUDEPATH += /usr/include
LIBS += -L"/usr/include/boost" -lboost_system -lboost_gregorian

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-09-27T23:56:18.093

我只是自己尝试过，它正在工作，这是我的第一个 Qt 和 boost 程序。

在 .pro 文件中，您只需添加

```
LIBS += \
       -lboost_system\ 
```

我没有提到包含文件，因为我在源文件中的包含中使用了提到 boost dir。

```
#include <boost/asio.hpp>
#include <boost/bind.hpp> 
```

对于软件包，如果您使用 Fedora/RHEL 系统，只需执行

```
yum install boost boost-devel 
```

对于基于 Ubuntu 的系统

```
sudo apt-get install libboost-all-dev 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-25T10:59:18.873

LIBS 不应包含 /usr/include/boost 并且 INCLUDEPATH 默认包含 /usr/include。

确保您已安装**libboost-system-dev**（或 devel，取决于您的发行版）软件包。

# ms-access - 根据组合框中的选择自动从数据库中填充表单中的其他字段

> ID：13480766
> 
> 赞同：0
> 
> 时间：2012-11-20T19:37:10.233
> 
> 标签：ms-access

我有一个要求，必须输入表中的数据并且必须检查它。我完成了新记录的输入。我正在尝试检查数据部分。我可以形成一个组合框，其中填充了来自数据库的数据。我希望根据组合框中的选择来填充表单上的其他字段（数据库中的字段），以便在出现任何错误时检查和更正这些值。请帮助我，因为我对 Access 很陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:40:14.747

使用向导根据您的表格创建表单。接下来使用向导添加一个组合框，然后在组合选项中选择“根据我在组合框中选择的值在我的表单上查找记录”。

![组合](../Images/8683e2305d4e84c6f44bc59f2e890973.png)

# python - 为什么我必须更改 Flask for SQLAlchemy 中的 uri？

> ID：13480768
> 
> 赞同：4
> 
> 时间：2012-11-20T19:37:16.450
> 
> 标签：python, sqlite, sqlalchemy, uri, flask

我正在尝试在 Flask 中开发一个 Web 应用程序，我注意到如果我想使用 SQLite3 作为我的数据库，那么我必须输入

```
DATABASE = 'flaskr.json' 
```

但是，如果我想为我的数据库实现使用 SQLAlchemy，我必须使用类似的东西

```
DATABASE = 'sqlite:////Users/jake/repos/flaskralchemy/flaskr.db 
```

这种变化有什么意义？此外，在我看到的所有示例中，没有人在他们的服务器上创建实际的数据库。到底是怎么回事？

提前致谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-21T20:43:33.160

我有点不清楚你在问什么，你在哪里设置这个 DATABASE 值以及 flaskr.json 值来自哪里。但我会试一试，希望它会有一些用处。

因此，显然，您需要告诉您的应用程序如何连接到您的数据库。您通常在应用程序配置中进行设置，如下所示：

```
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:////tmp/test.db' 
```

对于 SQLlite，您只需要一个文件路径（如上）对于 MySQL，我的应用程序设置如下：

```
app.config['SQLALCHEMY_DATABASE_URI'] = 'mysql+pymysql://username:password@server.site.com/database' 
```

您可以在 SQLAlchemy 文档中阅读比您想知道的更多的内容：

[http://docs.sqlalchemy.org/en/latest/core/engines.html#database-urls](http://docs.sqlalchemy.org/en/latest/core/engines.html#database-urls)

另外，你看过 Flask-SQLAlchemy 插件吗？它为您提供了一些很好的工具来处理这个问题。

[http://flask-sqlalchemy.pocoo.org/2.3/quickstart/#a-minimal-application](http://flask-sqlalchemy.pocoo.org/2.3/quickstart/#a-minimal-application)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-21T17:46:35.710

对于 windows 使用这个

```
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///E:\\account-verification-flask\\src\\example.db'
# sqlite:///absolute path 
```

了解更多信息。[访问这里](https://github.com/mitsuhiko/flask-sqlalchemy/issues/469)

# sharepoint-2010 - 搜索核心结果 Web 部件不显示托管属性

> ID：13480772
> 
> 赞同：0
> 
> 时间：2012-11-20T19:37:38.180
> 
> 标签：sharepoint-2010

我正在尝试在搜索核心结果 Web 部件中显示托管属性（内容类型），但它不起作用。

```
I have created the Managed Property in CA
I have mapped it to content type
I have done a full crawl
I have checked the "Content Using this property" in CA 
I have added the column name in the tool panne and also the xslt code 
```

（如此处所述：http: [//www.prosharepointsearch.com/?p=240](http://www.prosharepointsearch.com/?p=240)）

但我仍然看不到 Web 部件中的托管属性。

我还需要检查什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T12:38:22.667

问题解决了。我在上面发布的链接可以正常工作。在我看来，我的问题是我从网站复制代码并将其粘贴到 Visual Studio 中，这导致了问题。请注意，我对引号进行了格式设置，例如：(') 和 (")，但是没有用。

**所以我的解决方案是从头开始自己输入。这样就避免了复制和粘贴引起的任何问题。**

# iphone - 如何为从 nib 创建的视图的子类编写初始化程序？

> ID：13480775
> 
> 赞同：1
> 
> 时间：2012-11-20T19:37:58.413
> 
> 标签：iphone, ios, ipad

我有一个名为 TextFieldView 的自定义视图类，它是从笔尖初始化的......

```
+ (TextFieldView *)textFieldView {
    NSArray *nibObjects = [[NSBundle mainBundle]
                           loadNibNamed:@"TextFieldView"
                                  owner:nil
                                options:nil];
    return (TextFieldView *)[nibObjects objectAtIndex:0];
} 
```

我正在尝试创建一个名为 EmailTextFieldView 的子类，但我不知道如何为其编写初始化程序。我目前的做法是...

```
+ (EmailTextFieldView *)emailTextFieldView {
    return (EmailTextFieldView *)[EmailTextFieldView textFieldView];
} 
```

这会导致崩溃，因为每当我创建一个 EmailTextFieldView 并在其上调用 EmailTextFieldView 方法时，它都会崩溃，因为消息被发送到 TextFieldView 子类，而该子类没有实现该方法。如何为从 nib 创建的视图的子类编写初始化程序？

非常感谢你的智慧！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:48:00.080

您的 nib 指定了它在 Identity Inspector 中的类。如果您正在加载 TextFieldView nib，并且它设置了 TextFieldView 的自定义类，那么您几乎已经绑定到该对象。

![笔尖](../Images/64b7f6e0f1bb77d61e1285eb1682c141.png)

如果要创建子类，则需要在 Identity Inspector 中将另一个 nib 设置为 EmailTextFieldView。

# c - C 通过管道或参数输入

> ID：13480781
> 
> 赞同：1
> 
> 时间：2012-11-20T19:38:27.387
> 
> 标签：c

我正在寻找一种方法来从终端的管道或通过将文件名指定为参数来将输入拉入我的程序。有效地

```
1\. foo | myprogram
OR
2\. foo > bar; myprogram -w bar 
```

第二个操作只需读取文件即可完成。但是，我对如何使用管道将输出重定向`foo`到空白处。`myprogram`在我设法找到的所有示例中，管道几乎专门用于从父进程到子进程的 IPC。我是在考虑合适的管道还是这是一种不同的机制？

我也意识到，当`foo | myprogram`执行时，程序是同时执行的。如果`foo`连续读入，这将如何处理。

编辑：

忘了包括这个：

```
int main(){
    char buff[255];
    int i = read(0, buff, 255);
    printf("Debug: %s\n", buff);
    return 0;
} 
```

例如，如果我执行`ls | myprogram`我倾向于收到。

```
. ../ files
Debug: 
```

代替

```
Debug: . ../ files 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T19:41:25.400

> 第二个操作只需读取文件即可完成。但是，我对如何使用管道将输出从 foo 重定向到 myprogram 持空白。

当使用管道重定向时，shell 将`stdout`左侧的进程设置为转到`stdin`右侧的进程。只需`stdin`像往常一样阅读就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:45:46.797

你可以这样做：

```
FILE* input;
//...
if (argc == 1) {
    input = stdin;
} else {
    input = fopen(argv[2] /* or whatever */, "r");
} 
```

# c# - 试图将 javascript 数组和 int 传递给代码隐藏

> ID：13480784
> 
> 赞同：0
> 
> 时间：2012-11-20T19:38:30.010
> 
> 标签：c#, javascript, asp.net, json

我正在尝试将 javascript 数组传递给我后面代码中的方法。问题是，我需要将一个 int 与数组一起传递给该方法。当我做：

```
$.ajax({
                type: "POST",
                url: webMethod,
                data: JSON.stringify({ myArray : passedArray }), 
```

有用。但现在我似乎无法弄清楚如何将数组传递给 AND 一个 int 后面的代码。我需要将它与数组一起传递：

```
"{'selectID' : '" + $("#ScarTattoos option:selected").val() 
```

因为我的方法参数是：

```
public markItem getMarkNoID(int selectID, string[] person)
{
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T19:43:05.333

您可以发送复合 JSON 对象，如下所示：

```
{
    myArray: passedArray,
    selectID: $("#ScarTattoos option:selected").val()
} 
```

将此传递给`JSON.Stringify`您的 AJAX 调用，两个所需的对象都将发送到服务器处理程序。

但是，您必须手动反序列化它，除非您将其发送到 Web 服务，该服务通常根据参数名称（在 JSON 模式下）自行进行反序列化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:42:45.313

不确定您是否可以简单地从 jquery ajax 方法发布到您的代码后面。如果您使用 MVC 进行开发，是的，您可以 POST 到控制器，但您似乎正在使用 Web 表单。您可能会有更好的运气将您的 JSON 数据保存到 a`<asp:HiddenField />`然后发回。

您可以通过调用服务器上的方法获取所需的 Postback JavaScript 代码`Page.ClientScript.GetPostBackEventReference()`，然后将结果传递给客户端 JavaScript 代码以供以后调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T19:43:17.097

我建议将数组和 int 添加到一个对象并对该对象进行字符串化。

```
var theID = $("#ScarTattoos option:selected").val();
var array = passedarray;
var PassObj = { selectID: theID, person: array}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T19:43:59.180

尝试这样的事情：

```
var obj = {
    selectID: parseInt($("#ScarTattoos option:selected").val(), 10),
    myArray: passedArray
}; 
```

`$("#ScarTattoos option:selected").val()`会给你一个字符串，所以你需要 parseInt() 使它成为一个数字类型。

只需 JSON.stringify 你的 obj 并发送它。

# asp.net-mvc - 支持添加数据集合的 ASP.NET MVC 视图

> ID：13480786
> 
> 赞同：0
> 
> 时间：2012-11-20T19:38:33.453
> 
> 标签：asp.net-mvc, generic-collections

我的应用程序将用于接受/编辑保修索赔。在保修索赔中，用户可以提交多个“部分”作为索赔的一部分。我的模型包含 WarrantyParts 的 IEnumerable<> - 我创建了一个包含以下内容的视图模型：

```
public class WarrantyClaimViewModel
{
    public int WarrantyClaimId { get; set; }

    public int UserId { get; set; }
    public DateTime DateCreated { get; set; }

    [Display(Name = "Claim Status")]
    public string Status { get; set; }

    ... other model data omitted for brevity ...

    public IEnumerable<WarrantyClaimPart> WarrantyClaimParts { get; set; }
} 
```

我的问题是如何构建允许用户填充保修部件集合的视图？他们可以输入一个或 100 个单独的部分；我想创建一个视图，用户可以在其中单击“添加部件”按钮，然后会出现一组新的文本框。也就是说，我想将文本框动态添加到现有视图中，而不是仅用于保修部分的单独视图。

部分视图是否符合此要求，或者我应该为零件创建单独的视图（不是我想要做的，但可能是最好的方法）？我在这里寻找最佳实践。一个例子会很棒——我喜欢视觉效果。

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:50:48.723

部分视图绝对适合您尝试做的事情 - 您可以将视图强烈键入到 WarrantyClaimParts 的集合中。

作为替代方案的一部分（由于 UI 改进，我喜欢一个）是使用类似[Knockout.js](http://knockoutjs.com/)的东西来允许编辑模型并一次性提交。查看教程[使用列表和集合](http://learn.knockoutjs.com/#/?tutorial=collections)以及教程[加载和保存数据](http://learn.knockoutjs.com/#/?tutorial=loadingsaving)。那里有一些非常棒的示例（包括代码！），它们应该可以满足您的需求。它的可用性非常好，而且非常易于使用。（根据您的意见，这符合您的 Ajax 解决方案要求。）

# java - 在 Java 中同步两个 DOM 树

> ID：13480792
> 
> 赞同：0
> 
> 时间：2012-11-20T19:38:51.743
> 
> 标签：java, xml, dom, merge, sax

我以不同的格式提出了这个问题，并提到了 XSLT，但我认为我没有解释我需要的解决方案。我有两个 xml 文件并使用 Java，我正在尝试编写一个程序，该程序将接受源和目标 xml 文件，并且在大多数情况下，它们将具有相同的结构，除了源将添加一些新元素，我需要弄清楚找出我如何导航源 DOM 以及如果在目标中找不到元素然后添加它，或者此时甚至只是让程序输出在目标文件中找不到哪些元素，从而更容易手动修改目标文件。有谁知道一个实用程序，我可以在其中执行类似的操作，并且只获取目标 xml 文件中未找到的元素列表。我是否正确使用 DOM 解析器与 SAX。我需要这方面的帮助，

我的想法是否符合为每个节点或元素导航整个源 DOM 获取完整路径（如 people/person/john）然后在我的目标 DOM 上以某种方式测试以查看该节点是否存在的想法？这听起来更像是 DOM 还是 SAX 解析范式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T19:42:31.790

看起来你的问题要简单得多。

1.  将源代码解析为 DOM
2.  将 dest 解析为 DOM
3.  *在深度优先搜索中并行*遍历 source 和 dest
**   每当您在 dest 中找到 source 中缺少的内容时，添加它（如评论中所述，一种简单的方法是[Document.importNode()](http://docs.oracle.com/javase/6/docs/api/org/w3c/dom/Document.html#importNode%28org.w3c.dom.Node,%20boolean%29)）*

# angularjs - 错误：“选择器未实现”

> ID：13480796
> 
> 赞同：22
> 
> 时间：2012-11-20T19:39:06.363
> 
> 标签：angularjs

我很难选择有角度的元素。我一定犯了一些愚蠢的错误：

```
function Root($scope) {
    $scope.elem = angular.element('div');
}​ 
```

导致的错误：

```
Error: selectors not implemented
    at Error (<anonymous>)
    at Object.JQLite [as element] (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:1523:13)
    at new Root (http://fiddle.jshell.net/kzX9z/7/show/:28:27)
    at invoke (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:2795:28)
    at Object.instantiate (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:2805:23)
    at $get (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:4621:24)
    at $get.i (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:4200:17)
    at forEach (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:117:20)
    at nodeLinkFn (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:4185:11)
    at compositeLinkFn (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:3834:14) angular.js:5563
$get angular.js:5563
$get angular.js:4661
$get.Scope.$apply angular.js:7890
SNAKE_CASE_REGEXP angular.js:930
invoke angular.js:2788
bootstrap angular.js:928
angularInit angular.js:904
(anonymous function) angular.js:14397
trigger angular.js:1695
event.preventDefault angular.js:1930
forEach angular.js:110
eventHandler 
```

[在这个小提琴中转载](http://jsfiddle.net/kzX9z/7/)

我究竟做错了什么？我包括了 jQuery。这不应该工作吗？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-11-20T20:25:14.707

这是因为 jquery 需要在angular*之前被引用。*JSFiddle 首先注册了 Angular 1.0.2，然后是您添加为资源的 jquery 版本。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.min.js"></script> 
```

这样 Angular 就知道它可以使用 JQuery 而不是 JQLite。一旦你这样做，选择器将在`angular.element()`

[这是您的小提琴，已更新为以正确的顺序引用脚本（并略有更改，请参阅评论）](http://jsfiddle.net/blesh/kzX9z/9/)

如果您没有 JQuery，您可以手动选择 DOM 元素。

```
var div = document.querySelector('div');
$scope.elem = angular.element(div); 
```

# ckan - CKAN 开发安装问题：AttributeError：“模块”对象没有属性“css/main.debug.css”

> ID：13480800
> 
> 赞同：11
> 
> 时间：2012-11-20T19:39:12.970
> 
> 标签：ckan

我已经完成了 CKAN 开发安装，并且在我的 development.ini 文件中使用 debug = true 运行。在访问 localhost:5000 时，我收到一个错误，其终点是错误：

```
AttributeError: 'module' object has no attribute 'css/main.debug.css' 
```

由 lib/helpers.py 中的调用引起：

```
r = getattr(fanstatic_resources, resource) 
```

知道我做错了什么以及我能做些什么来解决这个错误。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-21T13:57:31.643

您需要从CKAN 源代码中`less`的目录运行脚本来构建文件。有这方面的[一些文档，](http://docs.ckan.org/en/latest/frontend-development.html)但它还没有与其余的 CKAN 文档集成（即在任何地方都没有指向它的链接，我们有一张票可以解决这个问题）。`bin``main.debug.css`

这适用于 Ubuntu 12.04，您可能需要在执行此操作时激活 virtualenv：

```
sudo apt-get install nodejs npm
npm install less nodewatch
./bin/less # Assuming you're in your ckan dir e.g. `~/pyenv/src/ckan` 
```

现在重新启动`paster serve development.ini`命令，它应该可以工作。

一般来说，每当运行 CKAN 2.0 进行开发时，您应该：

*   在你`debug = True`的ini文件中有
*   一直`./bin/less`在终端运行

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-28T12:46:47.757

请注意`apt-get install nodejs`installs`nodejs`而不是`node`in `/usr/bin`，至少在 Ubuntu 12.10 中（我没有检查其他发行版）。这会引发错误，因为两者都`ckan/bin/less`在`ckan/node_modules/less/bin/lessc`调用 `node`. 所以要么在 /usr/bin 中创建一个软链接，要么修改脚本 ( `#!/usr/bin/env nodejs`)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-09-16T20:05:44.867

我在安装软件包时遇到了一些错误。以下是不耐烦的解决方案（根据[官方 CKAN 文档](http://docs.ckan.org/en/latest/maintaining/installing/install-from-source.html?highlight=debug#attributeerror-module-object-has-no-attribute-css-main-debug-css)）：

`cp /usr/lib/ckan/default/src/ckan/ckan/public/base/css/main.css /usr/lib/ckan/default/src/ckan/ckan/public/base/css/main.debug.css`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-14T10:35:37.733

我正在使用 ubuntu 12.04 并遇到了一些问题

遵循肖恩的回答并运行后出现此错误

`npm install less nodewatch`

并得到这个错误：

```
(default)root@ckan:/# npm install less nodewatch
npm http GET https://registry.npmjs.org/less
npm http GET https://registry.npmjs.org/nodewatch
npm ERR! Error: failed to fetch from registry: less
npm ERR!     at /usr/share/npm/lib/utils/npm-registry-client/get.js:139:12
npm ERR!     at cb (/usr/share/npm/lib/utils/npm-registry-client/request.js:31:9)
npm ERR!     at Request._callback (/usr/share/npm/lib/utils/npm-registry-client/request.js:136:18)
npm ERR!     at Request.callback (/usr/lib/nodejs/request/main.js:119:22)
npm ERR!     at Request.<anonymous> (/usr/lib/nodejs/request/main.js:212:58)
npm ERR!     at Request.emit (events.js:88:20)
npm ERR!     at ClientRequest.<anonymous> (/usr/lib/nodejs/request/main.js:412:12)
npm ERR!     at ClientRequest.emit (events.js:67:17)
npm ERR!     at HTTPParser.onIncoming (http.js:1261:11)
npm ERR!     at HTTPParser.onHeadersComplete (http.js:102:31)
npm ERR! You may report this log at:
npm ERR!     <http://bugs.debian.org/npm>
npm ERR! or use
npm ERR!     reportbug --attach /npm-debug.log npm
npm ERR! 
npm ERR! System Linux 3.8.0-29-generic
npm ERR! command "node" "/usr/bin/npm" "install" "less" "nodewatch"
npm ERR! cwd /
npm ERR! node -v v0.6.12
npm ERR! npm -v 1.1.4
npm ERR! message failed to fetch from registry: less
npm ERR! 
npm ERR! Additional logging details can be found in:
npm ERR!     /npm-debug.log
npm not ok 
```

找到另一个[线程](https://stackoverflow.com/questions/12913141/installing-from-npm-fails)来解释这一点并提供执行的解决方案

```
npm config set registry http://registry.npmjs.org/ 
```

但是，在运行上述命令后，我收到此错误：

```
(default)root@ckan:/# npm config set registry http://registry.npmjs.org/
(default)root@ckan:/# npm install less nodewatch
npm http GET http://registry.npmjs.org/less
npm http GET http://registry.npmjs.org/nodewatch
npm http 200 http://registry.npmjs.org/less
npm http GET http://registry.npmjs.org/less/-/less-1.6.3.tgz
npm http 200 http://registry.npmjs.org/nodewatch
npm http GET http://registry.npmjs.org/nodewatch/-/nodewatch-0.3.1.tgz
npm http 200 http://registry.npmjs.org/less/-/less-1.6.3.tgz
npm http 200 http://registry.npmjs.org/nodewatch/-/nodewatch-0.3.1.tgz
npm http GET http://registry.npmjs.org/mime
npm http GET http://registry.npmjs.org/request
npm http GET http://registry.npmjs.org/mkdirp
npm http GET http://registry.npmjs.org/clean-css
npm http GET http://registry.npmjs.org/source-map
npm http 200 http://registry.npmjs.org/request
npm http GET http://registry.npmjs.org/request/-/request-2.33.0.tgz
npm http 200 http://registry.npmjs.org/request/-/request-2.33.0.tgz
npm http 200 http://registry.npmjs.org/mime
npm http GET http://registry.npmjs.org/mime/-/mime-1.2.11.tgz
npm http 200 http://registry.npmjs.org/mkdirp
npm http 200 http://registry.npmjs.org/clean-css
npm http GET http://registry.npmjs.org/mkdirp/-/mkdirp-0.3.5.tgz
npm WARN optional dependency failed, continuing clean-css@2.0.x
npm http 200 http://registry.npmjs.org/source-map
npm http 200 http://registry.npmjs.org/mime/-/mime-1.2.11.tgz
npm http GET http://registry.npmjs.org/source-map/-/source-map-0.1.3.tgz
npm http 200 http://registry.npmjs.org/mkdirp/-/mkdirp-0.3.5.tgz
npm http 200 http://registry.npmjs.org/source-map/-/source-map-0.1.3.tgz
npm ERR! error installing less@1.6.3
npm ERR! error rolling back less@1.6.3 Error: UNKNOWN, unknown error '/node_modules/less'

npm ERR! Unsupported
npm ERR! Not compatible with your version of node/npm: request@2.33.0
npm ERR! Required: ["node >= 0.8.0"]
npm ERR! Actual:   {"npm":"1.1.4","node":"0.6.12"}
npm ERR! 
npm ERR! System Linux 3.8.0-29-generic
npm ERR! command "node" "/usr/bin/npm" "install" "less" "nodewatch"
npm ERR! cwd /
npm ERR! node -v v0.6.12
npm ERR! npm -v 1.1.4
npm ERR! code ENOTSUP
npm ERR! message Unsupported
npm ERR! errno {}
npm http GET http://registry.npmjs.org/requirejs/0.26.0
npm ERR! 
npm ERR! Additional logging details can be found in:
npm ERR!     /npm-debug.log
npm not ok 
```

似乎版本不兼容，或者这可能是 node 和 node.js 的问题？

干杯，邵

# c# - 我应该相信 C# 编译器为我优化还是应该在这种情况下使用不安全的代码

> ID：13480802
> 
> 赞同：0
> 
> 时间：2012-11-20T19:39:17.383
> 
> 标签：c#, memory-management

我有一些小类，它们会非常频繁地创建和销毁，绝大多数时间它们会被短暂使用，然后超出范围。我希望将这些东西分配在堆栈上。

我不能使用结构，因为我的对象需要析构函数。我刚刚发现使用不安全的 stackalloc。在阅读之后，我发现 c# 不一定总是在堆上创建类。尽管如此，如果这些东西是在堆上创建的，它很可能会成为我的性能瓶颈。我应该相信 c# 在智能时将它们分配到堆栈上，还是应该我自己做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T19:42:13.043

如果您不能或不想依赖 C# 内存优化并希望尽可能多地重用您的对象，您可以而且应该简单地实现对象池创建模式。

[http://sourcemaking.com/design_patterns/object_pool](http://sourcemaking.com/design_patterns/object_pool)

祝你好运

# c++ - 显示链接列表

> ID：13480803
> 
> 赞同：2
> 
> 时间：2012-11-20T19:39:25.267
> 
> 标签：c++, linked-list

我在显示链接列表中的数据时遇到问题。我曾尝试在我的 for 循环中包含显示循环，并且只是为了检查它是否是指针和数据的问题，但我得到了相同的结果。

它显示第一个数据，但随后开始显示乱码。

```
#include <stdio.h>
#include <conio.h>
#include <iostream>
#include <string>

void main(void) {
    clrscr();
    struct Student {
        string Name;
        double GPA;
        Student *next;
    };

    Student *head;
    head = NULL;

    int ch, i;
    string name;
    double gpa;

    cout << "How Many Records Do You Want To Enter?";
    cin >> ch;
    cout << endl;

    for (i = 0; i < ch; i++) {
        cout << (i + 1) << ". Name Of Student:";
        cin >> name;
        cout << "GPA Of Student:";
        cin >> gpa;
        cout << endl;

        Student *newstudent;
        Student *studentptr;

        newstudent = new Student;
        newstudent->Name = name;
        newstudent->GPA = gpa;
        newstudent->next = NULL;

        if (!head)
            head = newstudent;
        else {
            studentptr = head;

            while (studentptr->next) {
                studentptr = studentptr->next;
            }
            studentptr->next = new Student;
        }
    }

    clrscr();
    Student *display;
    display = head;

    while (display) {
        cout << "Name:" << display->Name << endl;
        cout << "GPA:" << display->GPA << endl;

        display = display->next;
    }
    getch();
} 
```

对正确方向的任何建议和指示？

显然我正在关注某人的教程，但发生了这个错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:43:41.530

`studentptr->next = new Student;`应该`studentptr->next = newstudent;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:47:00.473

由于问题是关于正确方向的建议：

1.  在您尝试阅读任何您想阅读的内容后，您需要**始终**`if (std::cin >> value) { ... }`检查您的输入是否成功，例如.
2.  [不要使用`std::endl`](http://kuhllib.com/2012/01/14/stop-excessive-use-of-stdendl/).
3.  您正在循环中创建多余的`Student`对象。
4.  您没有将创建的`Student`对象与列表挂钩。您可能打算在创建新对象的地方执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T19:47:05.673

我有一些建议可能会有所帮助：

```
struct Student {
    string Name;
    double GPA;
    Student *next;
    Student(const string& name, double GPA) : Name(name), GPA(GPA), next(NULL) {}
    void print() {
        cout << "Name:" << Name << endl;
        cout << "GPA:" << GPA << endl;
    }
}; 
```

现在而不是：

```
 newstudent = new Student;
    newstudent->Name = name;
    newstudent->GPA = gpa;
    newstudent->next = NULL; 
```

你只需写：

```
newstudent = new Student(name, gpa); 
```

为列表创建一个结构：

```
struct StudentList {
    Student* head;
    Student* current;

    StudentList() :head(NULL), current(NULL) {}

    ~StudentList() {/*Delete list here*/}

    void insert(string name, double gpa) {
        if(!head) {
            head = new Student(name, gpa);
            current = head;
        } else {
            current->next = new Student(name, gpa);
            current = current->next;
        }
    }

    void display() {
        Student *display = head;
        while (display) {
            display->print();
            display = display->next;
        }
    }
}; 
```

有了这一切，你的主要现在应该是：

```
int main(void) {
    clrscr();

    StudentList list;

    int ch, i;
    string name;
    double gpa;

    cout << "How Many Records Do You Want To Enter?";
    cin >> ch;
    cout << endl;

    for (i = 0; i < ch; i++) {
        cout << (i + 1) << ". Name Of Student:";
        cin >> name;
        cout << "GPA Of Student:";
        cin >> gpa;
        cout << endl;

        list.insert(name, gpa);
    }

    clrscr();
    list.display();
    getch();
} 
```

# iphone - 识别“if 语句”中的按钮按下

> ID：13480812
> 
> 赞同：2
> 
> 时间：2012-11-20T19:40:05.390
> 
> 标签：iphone, objective-c, oop

我正在开发一个出现文本标签的 iOS 游戏，玩家必须点击相应的彩色按钮。我试图弄清楚如何格式化 if 语句以识别按下的按钮是否与屏幕上的当前文本匹配。我希望在这个 if 语句中发生的是：如果显示 redText 并且按下 redButton，则添加点。否则游戏结束。我将为四种颜色中的每一种复制/粘贴此语句。

这是我目前拥有的方法，注意“buttonPressed”没有任何意义，只是一个占位符：

```
-(void)gameStatePlayNormal
{
    if (redText.hidden=NO && buttonPressed == redButton)
{
     score += 10;
}
    else
{
    gameState = kStateGameOver;
}
} 
```

提前感谢您的反馈。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:43:27.020

您需要创建一个在按下任何按钮时都会调用的函数。将每个按钮与故事板中的此功能挂钩（“Touch Up Inside”事件）。然后你可以拦截发件人。

```
- (IBAction)buttonWasPressed:(id)sender
{
    if (redText.hidden=NO && [(UIButton *)sender isEqual:redButton]) {
        score += 10;
    }
    else {
        gameState = kStateGameOver;
    }
} 
```

# workflow - Bugzilla - 根据角色限制更改错误状态

> ID：13480817
> 
> 赞同：0
> 
> 时间：2012-11-20T19:40:30.957
> 
> 标签：workflow, roles, bugzilla

我们希望以这种方式为错误状态工作流定义角色：

*   提交错误的人
*   确认错误的人
*   解决问题的人
*   验证错误的人

我们想强迫每个人都是不同的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-01T07:32:30.740

我们可以将权限（谁可以提交错误，谁可以确认错误）授予产品权限中的一组人。

管理->产品->编辑组访问控制

阅读该页面的说明，并为每个组授予适当的权限。

抱歉，我不知道剩下的两个权限。解决错误的人 验证错误的人

# eclipse - 我可以指定通过 ADB 发送的意图吗？

> ID：13480827
> 
> 赞同：2
> 
> 时间：2012-11-20T19:41:22.937
> 
> 标签：eclipse, debugging, android-intent, adb

我正在开发一个应用程序，该应用程序旨在（仅）从另一个在 Intent 中提供附加功能的应用程序启动。因此，该应用程序在其意图过滤器中不使用 LAUNCHER 类别，并且当我从 Eclipse 启动它时，它不会启动并附加到调试器。

调试与启动或 Intent 相关的任何内容都非常困难，因为我只能通过将 LAUNCHER 类别添加到清单中来进行调试，从而绕过启动活动的预期方法，而没有必要的额外内容。有什么方法可以指定亚行发送的启动意图以包含额外数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:58:01.077

当面临类似的挑战时，我能够通过切换到 URI 表单来为我尝试发送的广播提供额外的内容：

```
am broadcast "intent:#Intent;action=android.intent.action.AIRPLANE_MODE;B.state=true;end" 
```

# c# - 使用 C# (Windows 8) 生成问题的静态变量

> ID：13480828
> 
> 赞同：1
> 
> 时间：2012-11-20T19:41:23.690
> 
> 标签：c#, variables, asynchronous, static, manualresetevent

我不是一个用过的 C# 程序员，所以如果这很愚蠢，对不起:-)

我正在为 Windows 8 开发 C# 应用程序。我需要执行 Web 请求，因此，我有一个回调来处理请求数据。

我正在使用标准方法：

```
private static ManualResetEvent allDone = new ManualResetEvent(false);

private static void daCallback(IAsyncResult data) {
   ...
   SampleDataSource.allDone.Set();
}

// This is the Class CONSTRUCTOR
public SampleDataSource() {
   # before anything, reset allDone:

  string request = "http://some.url.com";
  HttpWebRequest webRequest = WebRequest.Create(request) as HttpWebRequest;
  webRequest.Method = "POST";

  webRequest.BeginGetResponse(new AsyncCallback(daCallback), webRequest);

  Debug.WriteLine("Asked to begin get response");

  SampleDataSource.allDone.WaitOne(12000);

  Debug.WriteLine("Done Waiting");
   #...
} 
```

运行时，allDone（do_something 内部）未初始化。我什至添加了一个条件来比较 allDone 和 null，是的，它是 null。

“等待完成”消息永远不会被打印出来......

我究竟做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:44:28.140

您正在从实例方法调用静态字段。改为使用`YourClassName.allDone.Reset()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:45:01.310

您必须在调用前添加类名`allDone`，因为它是静态的。所以而不是

```
allDone.Reset(); 
```

尝试

```
//replace CLASS with whatever you named your class
CLASS.allDone.Reset(); 
```

所有其他调用的等效方法。

# ios - 如何向 UITableViewController 添加粘性搜索栏

> ID：13480830
> 
> 赞同：0
> 
> 时间：2012-11-20T19:41:27.163
> 
> 标签：ios, iphone, uitableview, cocoa-touch, uikit

我试图向嵌入在 tabBarController 中的 UItableViewController 添加一个粘性搜索栏。但我不明白。我用 containerView 尝试了一些东西，但我认为这不是正确的方法。是否有任何最佳做法可以在 tableView 顶部添加粘性搜索栏？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:54:14.280

你不能使用 UITableViewController。您必须使用普通的 UIViewController 并将搜索栏和表格视图添加为单独的子视图。否则，正如您所发现的，搜索栏将随表格一起滚动。

# actionscript-3 - 在 AS3 中连接变量名

> ID：13480834
> 
> 赞同：3
> 
> 时间：2012-11-20T19:41:35.257
> 
> 标签：actionscript-3, flash, loops, actionscript, concatenation

我现在正在开发一款 AS3 游戏，并对其进行设置，以便玩家精灵可以收集硬币。这是通过在检测到与玩家发生碰撞时使“硬币”影片剪辑不可见并将硬币计数加一来完成的。

现在，我有以下循环。

```
if (coin1Collected == false){
  if (player.hitTestObject(level.coin1)){
    level.coin1.visible = false;
    coin1Collected = true;
    coinsCollected++;
    soundChannel = coinSound.play();
    }
} 
```

我不想为每个单独的硬币电影剪辑和硬币收集布尔值设置其中一个，但是我无法找到将它们全部放入 for 循环的方法。有没有办法在 for 循环中将变量与增量值连接起来？提前致谢，如果这是一个愚蠢的问题，我很抱歉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T19:46:12.477

我想你正在寻找`level['coin' + i]`. `i = 5`例如，当等价于`level.coin5`。为了避免两次收集同一枚硬币，为什么不检查它的可见性呢？

```
const NUM_COINS = 10;

for (var i:int = 1; i < NUM_COINS; i++) {
    var coin:Sprite = level['coin' + String(i)];

    if (coin.visible && player.hitTestObject(coin)) {
        coin.visible = false;
        coinsCollected++;
        soundChannel = coinSound.play();
    }
} 
```

如果您需要存储有关硬币的更多信息，您可以：

*   创建一个数组，其中 coinX 具有索引 X 处的信息

*   使用 MovieClip 并将信息设置为属性，因为 MovieClip 是动态的 ( `coin.pickedUp = true`)

*   创建一个已经将该信息作为属性的 Coin 类

# java - 在生产环境中使用 RAM Disk 来加速应用程序性能

> ID：13480842
> 
> 赞同：0
> 
> 时间：2012-11-20T19:42:14.320
> 
> 标签：java, performance, ramdisk, ramdrive

我的应用程序由于其与数据库的聊天性质而面临问题。由于许多 I/O 操作或数据库调用，完成一个流程特殊的批处理作业需要时间。代码优化正在进行中，这个过程需要一些时间才能显示出积极的结果。

*   我可以在生产环境中安装 RAMdisk 并在 RAMDisk 中安装 jdk 和 SQL server 吗？
*   这对所有 I/O 操作有帮助吗？
*   至少在批处理作业的情况下，我可以得到一些性能提升吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T20:21:00.593

正如@BaileyS 建议的那样，一个好的折衷方案是使用耐用的 SSD 驱动器。如果您有大量数据，您可以仅使用 SSD 来存储数据库索引并将数据保存在常规驱动器上。

我不建议使用 RAM 磁盘，除非您经常备份它，或者上面的数据不重要。

相反，我会尝试最大化您的操作系统的文件缓存。如果您的文件缓存在 RAM 中，那么使用它们就像在 RAM 磁盘上一样。在 Linux 上，您可以降低内核的值`vfs_cache_pressure`，这意味着内核将更加努力地将缓存文件保留在 RAM 中。并且还设置`vm.swappiness`为 100，以便系统更主动地交换未使用的内存页面，保持 RAM 可用于缓存。这可以大大加快速度。请参阅[我可以配置我的 Linux 系统以获得更积极的文件系统缓存吗？](https://unix.stackexchange.com/q/30286/22339)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:44:55.643

假设大部分时间都花在数据库等待 I/O 上，RAM 磁盘肯定会有所帮助（但持久性已经消失）。但是为什么不简单地选择像[h2](/questions/tagged/h2 "显示标记为“h2”的问题")这样的内存数据库，甚至可以在嵌入式模式下减少网络延迟呢？

# jquery - 骨干滚动事件未触发

> ID：13480843
> 
> 赞同：5
> 
> 时间：2012-11-20T19:42:19.113
> 
> 标签：jquery, backbone.js, backbone-events

骨干滚动事件不会触发。单击事件和 jquery 附加滚动有效。这也是一个小提琴：http: [//jsfiddle.net/cX2UV/](http://jsfiddle.net/cX2UV/)

js

```
var TView = Backbone.View.extend({        
    events: {
        'scroll .content': 'loadMore',
        'click .code': 'codeClick'
    },

    loadMore: function() {
        this.$el.append('<p>backbone scrolling</p>');
    },

    codeClick: function() {
        this.$el.append('<p>clicking</p>');
    }
});

new TView({ el: '.target' });

$('.content').scroll(function(){ $('.target').append('jq scrolling...'); }); 
```

html

```
<div class="target">
<div class="content">
    <div>
        <span class="text">text</span>
        <span class="term">termmm</span>
        <span class="codes"><span class="code">12345</span></span>
    </div>
    <div>
        <span class="text">text</span>
        <span class="term">termmm</span>
        <span class="codes"><span class="code">12345</span></span>
    </div>  
</div>
</div> 
```

css

```
body {margin:1em;}
.content {background:#EEE; height: 200px; overflow: scroll;}
.code{color:#00c} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T19:53:33.707

当使用选择器将事件绑定到视图时，Backbone 使用 jQuery 的`delegate`. 如[对此问题的回答中](https://stackoverflow.com/questions/9253904/why-doesnt-delegate-work-for-scroll)所述，该`scroll`事件[不会冒泡，](http://www.quirksmode.org/dom/events/scroll.html)因此处理程序无法响应它。

# java - 在根 url 下搜索文件名而不是文件系统

> ID：13480844
> 
> 赞同：0
> 
> 时间：2012-11-20T19:42:19.970
> 
> 标签：java

我有以下代码在文件系统下搜索文件名

```
 private String getFile(final String myId) {

    File folder = new File(System.getenv("MY_DIR"));

    return folder.listFiles(new FilenameFilter(){
        public boolean accept(File dir, String name){
            return name.startsWith(myId);
        }
    })[0].getName();
} 
```

我如何修改以查看[http://server.com/mydir](http://server.com/mydir)而不是当前是 MY_DIR 的 /home/jay/mydir ？

# python - 我们可以通过在python中的原始名称周围添加双下划线来将所有内置函数转换为类中的魔术（特殊）方法吗？

> ID：13480845
> 
> 赞同：1
> 
> 时间：2012-11-20T19:42:20.850
> 
> 标签：python, class

我正在学习python中的类，我发现了一些称为魔术方法或特殊方法的函数，我们在类定义中使用它们，问题如下：

例如，如果我们在任何原始内置函数之前和之后添加双下划线，这是否允许我们在一个类中使用所有它们来完成相同的任务。

```
>>> int (3.6)
3

>>> str(3.7)
'3.7' 
```

我们可以在类中使用**str**如下：

```
class Character:
    def __init__(self, name, initial_health):
       self.name = name
       self.health = initial_health
       self.inventory = []

    def __str__(self):
       s  = "Name: " + self.name
       s += " Health: " + str(self.health)
       s += " Inventory: " + str(self.inventory)
       return s

   def grab(self, item):
       self.inventory.append(item)

   def get_health(self):
       return self.health

   def example():
       me = Character("Bob", 20)
       print str(me)
       me.grab("pencil")
       me.grab("paper")
       print str(me)
       print "Health:", me.get_health()

example() 
```

结果 ：

```
Name: Bob Health: 20 Inventory: []
Name: Bob Health: 20 Inventory: ['pencil', 'paper']
Health: 20 
```

所有内置函数都可以是魔术（特殊）函数吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:47:08.407

不，有些内置函数有专门的方法，有些则没有。此外，一些特殊方法不对应于内置函数，并且一些内置函数使用具有不同名称的特殊方法（例如，`__instancecheck__`）。您可以在[文档](http://docs.python.org/2/reference/datamodel.html#special-method-names)中查看有哪些特殊方法。 [这](http://www.rafekettler.com/magicmethods.html)也是一个很好的参考网站。

# makefile - 如何在不再次运行配置脚本/cmake 的情况下修改安装路径

> ID：13480846
> 
> 赞同：40
> 
> 时间：2012-11-20T19:42:25.147
> 
> 标签：makefile, cmake, configure, build-system

我正在做一个需要大量时间来构建（10-15）分钟的项目。我已经重新编译以验证是否存在编译错误。现在我想更改安装目录，以便我拥有带有新更改的新版本的可执行文件。有没有一种方法可以修改安装路径，以便“make install”安装到新位置而不是旧位置？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-11-21T07:33:03.850

CMake 生成的 makefile 支持 makefile 的[DESTDIR 编码约定](http://www.gnu.org/prep/standards/html_node/DESTDIR.html)。`DESTDIR`因此，您可以通过在调用 make 时设置变量来覆盖默认安装位置：

```
$ make install DESTDIR=/opt/local 
```

无需重新运行 CMake。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-12-13T17:45:09.253

我不知道这是否普遍正确，但我可以举一个应用程序的示例，其中[接受的答案](https://stackoverflow.com/a/13488348/1168152)无法`sakra`正常工作。如果您在安装 ITK 时通过修改来修改安装目录`DESTDIR`，它只会追加`DESTDIR`到其已形成的安装路径：

```
make install DESTDIR=/opt/local 
```

[...]

```
-- Installing: **/opt/local/usr/local**/lib/cmake/ITK-4.4/WrapITK/Configuration/Typedefs/itkRenyiEntropy[...]
```

另一方面，遵循[此答案](https://stackoverflow.com/a/13485019/1168152)将`Fraser`导致正确的安装路径而无需重新编译：

```
cmake -DCMAKE_INSTALL_PREFIX=/opt/local /path/to/ITK_source
make install 
```

[...]

```
-- Installing: **/opt/local**/lib/cmake/ITK-4.4/WrapITK/Configuration/Typedefs/itkRenyiEntropy[...]
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-11-21T01:27:06.090

运行 CMake`-DCMAKE_INSTALL_PREFIX=<somewhere different to last time>`不会导致您的项目需要重新编译。如果您将其他命令行参数传递给 CMake，例如更改编译器标志，这*将*强制重建受影响的目标，但简单地更改安装前缀不会。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-06-15T21:38:25.930

DESTDIR 和前缀的规范定义是：文件安装到 $DESTDIR$prefix，但准备好好像它们的最终安装位置只是 $prefix。

所以 DESTDIR 仅适用于构建二进制包或 tarball 的人；CMAKE_INSTALL_PREFIX 适用于任何想要指定构建的二进制文件最终应该放在哪里的人。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-03-13T21:19:20.910

以防万一有人不使用 CMake，那么在 Makefile 中有一种方法可以做到这一点。如果您在构建目录中生成了 Makefile.config 文件，请找到`prefix`. 这`prefix`是将安装`path`二进制文件/头文件等的安装。更改此设置会将二进制文件/头文件安装到修改后的`path`.

# php - 去掉字符串末尾 () 中的所有内容

> ID：13480864
> 
> 赞同：0
> 
> 时间：2012-11-20T19:43:24.293
> 
> 标签：php, regex

我有一个文本字符串：

```
$str = "This is my string (something else)"; 
```

该字符串在 ( ) 中可能有也可能没有，但如果有，我需要将其完全剥离。我试过这个：

```
$new = str_replace('/\\(.*/', '', $str); 
```

但它似乎不起作用......我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:45:10.883

```
$new = preg_replace('/\(.*\)/', '', $str); 
```

# ruby-on-rails - Rails 响应在某些时候被忽略

> ID：13480868
> 
> 赞同：0
> 
> 时间：2012-11-20T19:43:31.447
> 
> 标签：ruby-on-rails, ruby-on-rails-3, unicorn, rack-pow

我的 Rails 操作在传输相同数量的数据后停止呈现响应。不显示错误或警告。

起初，我认为我的部分可能是造成这种情况的原因，但后来我删除了部分调用并插入了一些纯文本，结果 html 仍然被截断，具体取决于我插入的文本量。

我用`thin`,`webrick`和`pow`+试过了`nginx`。

它看起来好像在某处有某种响应大小限制。有任何想法吗？

**更新：**

渲染在特定代码上失败（即使我清空`_offer`部分代码）：

```
# Controller:
@offers = Offer.all

# View:
<% offers.each do |offer| %>
<%= render offer %>
<% end %>

# views/offers/_offer.html.haml
%li{ :class => offer.promo_type }
.content_card
    .content_item_wrapper
        .exclusive_content_ribbon
        .exlusive_glossy
        .exclusive_operator
            .operator_icon
        .exclusive_content_photo= image_tag offer.package.hotel.main_image_path
        .exclusive_content_hotel
            .ex_hotel_stars
                %span{ :class => ["ex_hotel_stars_b", "star_#{offer.package.hotel.stars}"] }
            .ex_hotel_name
                %a= offer.package.hotel.name
            .ex_hotel_place
                %span.ex_hotel_place_country= offer.package.hotel.country.name_ru
                &#8250;
                %span.ex_hotel_place_region= offer.package.hotel.city.name_ru 
```

**更新 2：**

如果我删除下面的所有内容`.exclusive_content_photo= image_tag offer.package.hotel.main_image_path`（包括这一行） ，它就会开始工作

**更新 3：**

任何调用`offer.package`都会导致它崩溃。在控制台中一切正常。

=========

我的宝石清单：

```
捆绑包中包含的宝石：
  * aasm (3.0.14)
  * actionmailer (3.2.9)
  *动作包（3.2.9）
  * activeadmin (0.5.0 eea827a)
  *活动模型（3.2.9）
  *活动记录（3.2.9）
  *活动资源（3.2.9）
  * 主动支持 (3.2.9)
  * 可寻址 (2.3.2)
  * ansi (1.4.3)
  * arbre (1.0.1)
  * 雷尔 (3.0.2)
  * aws-sdk (1.7.1)
  * bcrypt-ruby (3.0.1)
  *波旁威士忌（2.1.2）
  *生成器（3.0.4）
  * 项目符号（4.2.0 c292bb7）
  *捆绑器（1.2.1）
  *康康（1.6.8）
  * capistrano (2.13.5)
  * 水豚 (1.1.3)
  *赛璐珞（0.12.3）
  *子进程（0.3.6）
  * 慢性 (0.8.0)
  * clickatell (0.8.2 62d215c)
  * 码雷 (1.0.8)
  * 咖啡轨 (3.2.2)
  * 咖啡脚本 (2.2.0)
  * 咖啡脚本源 (1.4.0)
  * 连接池（0.9.2）
  * css_parser (1.2.6)
  * 守护进程 (1.1.9)
  * 设计（2.1.2）
  * diff-lcs (1.1.3)
  * 域名 (0.5.4)
  * 厄鲁比斯 (2.7.0)
  *事件机（1.0.0）
  * exception_notification (3.0.0)
  * execjs (1.4.0)
  * 因素 (1.6.14)
  * factory_girl (4.1.0)
  * factory_girl_rails (4.1.0)
  * fancybox-rails (0.1.4)
  *法拉第（0.8.4）
  * faraday_middleware (0.9.0)
  *更快的csv（1.5.5）
  * faye-websocket (0.4.6)
  * 菲 (1.2.0)
  * 形式化（2.2.1）
  *上帝（0.13.1）
  *后卫（1.5.4）
  * 守卫-rspec (2.1.2)
  * 哈姆 (3.1.7)
  * has_scope (0.5.1)
  *哈希（1.2.0）
  * 高线 (1.6.15)
  * 远足 (1.2.1)
  * http_parser.rb (0.5.3)
  * httparty (0.9.0)
  * i18n (0.6.1)
  * 继承资源 (1.3.1)
  * jbuilder (0.8.2)
  *旅程（1.0.4）
  * jquery-rails (2.1.3)
  * json (1.7.5)
  * kaminari (0.14.1)
  *公斤（2.7.4）
  * 发射 (2.1.2)
  * letter_opener (1.0.0)
  * libv8 (3.3.10.4)
  * libwebsocket (0.1.6.1)
  * libxml-ruby (2.3.3)
  *听（0.5.3）
  *伐木工人（1.0.2）
  * 邮件 (2.4.4)
  *标记b（1.0.0）
  *机械化（2.5.1）
  * 元搜索 (1.1.3)
  * 方法源（0.8.1）
  * 哑剧类型 (1.19)
  * mini_magick (3.4)
  * multi_json (1.3.7)
  * multi_xml (0.5.1)
  * 多部分帖子 (1.1.5)
  * mysql2 (0.3.11)
  * 网络 http-digest_auth (1.2.1)
  * net-http-persistent (2.8)
  * 网络SCP（1.0.4）
  * 网络 sftp (2.0.5)
  * 网络 SSH (2.6.1)
  * 网络 SSH 网关 (1.1.0)
  * newrelic_rpm (3.5.2.17)
  * nokogiri (1.5.5)
  * ntlm-http (0.1.1)
  * orm_adapter (0.4.0)
  * 恶作剧 (1.0.2)
  *多角（0.5.0）
  * 多语言 (0.3.3)
  * 撬 (0.9.10)
  * 机架 (1.4.1)
  * 机架缓存 (1.2)
  *机架保护（1.2.0）
  * 机架 SSL (1.3.2)
  *机架测试（0.6.2）
  * 导轨 (3.2.9)
  *铁路（3.2.9）
  *雨滴（0.10.0）
  * 耙子 (10.0.2)
  * rb-fsevent (0.9.2)
  * rdoc (3.12)
  *红地毯（2.2.2）
  * redis (3.0.2)
  * redis-actionpack (3.2.3)
  * redis-activesupport (3.2.3)
  * redis 命名空间 (1.2.1)
  * redis 机架 (1.4.2)
  * redis-rails (3.2.3)
  * redis 存储 (1.1.3)
  *响应者（0.9.3）
  * 路人 (2.3.4)
  * rspec (2.12.0)
  * rspec 核心 (2.12.0)
  * rspec-expectations (2.12.0)
  * rspec 模拟 (2.12.0)
  * rspec-nc (0.0.4)
  * rspec-rails (2.12.0)
  * ruby​​zip (0.9.9)
  * 俄语 (0.6.0)
  *萨斯（3.2.3）
  * sass-rails (3.2.5)
  *萨克斯机（0.1.0）
  *硒网络驱动程序（2.26.0）
  *发送网格（1.1.0）
  * sidekiq (2.5.3)
  * simple_oauth (0.1.9)
  * 西纳特拉 (1.3.3)
  *苗条（1.3.4）
  * 斜坡 (3.3.3)
  * 链轮 (2.2.1)
  * 子执行 (0.2.2)
  *寺庙（0.5.5）
  *终端通知器（1.4.2）
  * therubyracer (0.10.2)
  * 薄 (1.5.0)
  * 雷神 (0.16.0)
  * 倾斜 (1.3.3)
  * 计时器 (1.0.1)
  * 火种 (1.9.1)
  * 树顶 (1.4.12)
  * turbo-sprockets-rails3 (0.3.2)
  *转（0.9.6）
  * 推特流 (0.1.16)
  * 台风 (0.4.2)
  * tzinfo (0.3.35)
  *丑化剂（1.3.0）
  * unf (0.0.5)
  * unf_ext (0.0.5)
  *独角兽（4.4.0）
  * uniform_notifier (1.1.0)
  * uuidtools (2.1.3)
  * 典狱长 (1.2.1)
  * 网络机器人 (0.0.13)
  * websocket (1.0.3)
  * 无论何时（0.8.0）
  * xpath (0.1.4)
  * yaml_db (0.2.3)

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T14:13:12.887

**Bullet** gem was the cause of it. For more information see [https://github.com/rails/rails/issues/8283](https://github.com/rails/rails/issues/8283)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:42:53.650

您似乎在视图中使用“offers”而不是“@offers”。除此之外，我还遇到了 HAML 忽略视图中由 Ruby 代码引起的错误消息的问题。您确定控制器返回的对象包含视图使用的所有数据吗？在您获取优惠后在您的控制器中尝试放入

```
puts @offers.inspect 
```

并查看您的服务器日志以查看此对象是否具有您期望的信息

# workflow - 用户从 Peoplesoft 收到重复的电子邮件

> ID：13480871
> 
> 赞同：3
> 
> 时间：2012-11-20T19:44:05.020
> 
> 标签：workflow, peoplesoft

一个特定用户与 2 个角色相关联，而这 2 个角色在工作流电子邮件列表中，因此该用户两次收到相同的电子邮件。无论如何我可以避免这种重复的电子邮件

谢谢

高瑟姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-01-04T13:20:41.770

只是有点晚了......：/但看到了这个问题，所以我想我会给我2美分，希望这对某人有所帮助。

一种选择是创建动态的“外壳”角色来推动您的工作流程。通过这种方式，您可以对用户拥有的角色使用查询，并构建与安​​全角色分开的工作流角色。

第一个查询可以查找多个角色，其他查询可以查找单数，不包括多个。

# ruby - 如何使用 Pry 导航列出模块中的所有方法？

> ID：13480876
> 
> 赞同：1
> 
> 时间：2012-11-20T19:44:18.817
> 
> 标签：ruby, pry

Pry 提供的功能使用“cd”更改内容并使用“ls”显示其中的所有方法和变量。

我的问题是如何在模块中使用它，比如显示模块中的所有`Math`方法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T12:30:34.530

```
[4] pry(main)> ls Math -m
Math.methods: acos  acosh  asin  asinh  atan  atan2  atanh  cbrt  cos  cosh  erf  erfc  exp  frexp  gamma  hypot  ldexp  lgamma  log  log10  log2  sin  sinh  sqrt  tan  tanh
[5] pry(main)> 
```

# javascript - 谷歌翻译获取当前语言

> ID：13480879
> 
> 赞同：7
> 
> 时间：2012-11-20T19:44:28.017
> 
> 标签：javascript, google-translate

在网上找到任何可以帮助我的零之后....

我正在为多语言网站使用当前功能：

```
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en', includedLanguages: 'en,es',     layout: google.translate.TranslateElement.InlineLayout.SIMPLE}, 'google_translate_element');
} 
```

但是，一旦用户更改它，我不知道如何获取当前语言。我不确定这是否可能。基本上，如果选择西班牙语而不是英语，我想更新为西班牙语图像。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T20:08:27.320

你不会相信的：

```
window.setInterval(function(){
     var lang = $(".goog-te-menu-value span:first").text();
     alert(lang);
},5000); 
```

我只需要在 Firebug 中挖掘容器并从第一个 span 元素中获取值。希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-15T16:11:38.690

当前选择的语言存储在名为 的 cookie 中`googtrans`。

Here's a simple example of grabbing the value from the cookie (based on cookie code from here: [What is the shortest function for reading a cookie by name in JavaScript?](https://stackoverflow.com/questions/5639346/shortest-function-for-reading-a-cookie-in-javascript)):

```
function readCookie(name) {
    var c = document.cookie.split('; '),
    cookies = {}, i, C;

    for (i = c.length - 1; i >= 0; i--) {
        C = c[i].split('=');
        cookies[C[0]] = C[1];
     }

     return cookies[name];
}
console.log(readCookie('googtrans')); //eg. 'en/no' for Norwegian, '/en/hr' for Croatian, etc. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-22T20:43:53.540

调用`google.translate.TranslateElement().c`会给出当前语言的代码。例如，“fr”表示法语，“en”表示英语，“de”表示德语。

检查`google.translate`全局对象通常是有用的。这有点难 b/c 谷歌显然编译了代码，这样`TranslateElement.c`就没有人类可读的名称，但只要稍加努力，你就可以理解一些参数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-11-07T14:17:18.083

调用`google.translate.TranslateElement().a.sd`给出当前语言的标识符。

> 示例： **“fr”**表示法语，**“en”**表示英语，**“de”**表示德语，**“it”**表示意大利语

* * *

调用`google.translate.TranslateElement().a`是其他当前参数的对象，例如 Google Analytics 跟踪代码。

在控制台中查看它，看看那里有什么。[如何访问控制台？](https://webmasters.stackexchange.com/questions/8525/how-to-open-the-javascript-console-in-different-browsers)

检查`google.translate`全局对象通常是有用的。这有点困难，因为 Google 会不断更新代码，更改参数分配，并且显然已经将代码编译为`google.translate.TranslateElement()`没有人类可读名称之类的东西；不过，只要稍加努力，您就可以理解一些参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T19:54:42.063

您也许可以从 URL 中获取语言。

```
 function getUrlVars() {
    var vars = {};
    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
        vars[key] = value;
    });
    return vars;
} 
```

然后

```
var selected_lang = getUrlVars()['lang']; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-22T06:40:46.423

我在我的 joomla 网站中使用谷歌翻译模块。我的要求是我们在顶部有一个语言按钮。默认站点为英文。所以显示在顶部的按钮将是西班牙语。当用户单击按钮时，页面会翻译成西班牙语，按钮会变为英语，反之亦然。只要您不刷新页面，它就可以正常工作。现在说翻译页面是西班牙语，顶部的按钮是英语。现在，当您刷新页面时，按钮会变回西班牙语（javascript 隐藏显示功能，默认为西班牙语）。由于我可以跟踪当前语言，因此顶部的语言按钮与选择的语言不相符。经过大量挖掘，我发现了这个脚本，它帮助我解决了我的问题。我希望它也对其他人有所帮助。

```
<script>
 //to get currently selected language
window.setInterval(function(){
     lang = $("select.goog-te-combo option:selected").text();
    alert(lang);
},5000);
 </script> 
```

# sql - 计算不同记录的窗口函数

> ID：13480880
> 
> 赞同：22
> 
> 时间：2012-11-20T19:44:36.063
> 
> 标签：sql, sql-server-2008, tsql

下面的查询基于一个复杂的视图，该视图按我的意愿工作（我不打算包含该视图，因为我认为它不会帮助解决手头的问题）。我不能正确的是`drugCountsinFamilies`专栏。我需要它来显示`distinct drugName`每个药物家族的 s 数量。您可以从第一个屏幕截图中看到有三个不同的 H3A 行。对于`drugCountsInFamilies`H3A 应该是 3（有三种不同的 H3A 药物。）

![在此处输入图像描述](../Images/547c3285c8dfa4b9a071c2b8ef10565f.png)

您可以从第二个屏幕截图中看到，`drugCountsInFamilies`第一个屏幕截图中的内容是捕获列出药物名称的行数。
![在此处输入图像描述](../Images/9dc8c1d0367ac7de26ece311f35364a4.png)

以下是我的问题，对不正确的部分进行了评论

```
select distinct
     rx.patid
    ,d2.fillDate
    ,d2.scriptEndDate
    ,rx.drugName
    ,rx.drugClass
    --the line directly below is the one that I can't figure out why it's wrong
    ,COUNT(rx.drugClass) over(partition by rx.patid,rx.drugclass,rx.drugname) as drugCountsInFamilies
from 
(
select 
    ROW_NUMBER() over(partition by d.patid order by d.patid,d.uniquedrugsintimeframe desc) as rn
    ,d.patid
    ,d.fillDate
    ,d.scriptEndDate
    ,d.uniqueDrugsInTimeFrame
    from DrugsPerTimeFrame as d
)d2
inner join rx on rx.patid = d2.patid
inner join DrugTable as dt on dt.drugClass=rx.drugClass
where d2.rn=1 and rx.fillDate between d2.fillDate and d2.scriptEndDate
and dt.drugClass in ('h3a','h6h','h4b','h2f','h2s','j7c','h2e')
order by rx.patid 
```

如果我尝试在`count(rx.drugClass)`子句中添加不同的内容，SSMS 会发疯。可以使用窗口函数来完成吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2017-06-07T18:32:32.680

我遇到了这个问题，以寻找解决我计算不同值的问题的方法。在寻找答案时，我遇到了这篇[文章](https://www.sqlservercentral.com/Forums/Topic1455129-391-1.aspx)。见最后一条评论。我已经对其进行了测试并使用了 SQL。它对我来说非常有效，我想我会在这里提供另一种解决方案。

总之，将`DENSE_RANK()`, 与`PARTITION BY`分组列一起使用，并`ORDER BY`在要计数的列上使用 and ：`ASC``DESC`

```
DENSE_RANK() OVER (PARTITION BY drugClass ORDER BY drugName ASC) +
DENSE_RANK() OVER (PARTITION BY drugClass ORDER BY drugName DESC) - 1 AS drugCountsInFamilies 
```

我用这个作为自己的模板。

```
DENSE_RANK() OVER (PARTITION BY PartitionByFields ORDER BY OrderByFields ASC ) +
DENSE_RANK() OVER (PARTITION BY PartitionByFields ORDER BY OrderByFields DESC) - 1 AS DistinctCount 
```

我希望这有帮助！

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-11-20T20:19:23.660

将 a`count(distinct)`作为 Windows 功能执行需要一个技巧。实际上，有几个级别的技巧。

因为您的请求实际上非常简单——该值始终为 1，因为 rx.drugClass 在分区子句中——我将做一个假设。假设您要计算每个患者的独特药物类别的数量。

如果是这样，请`row_number()`按 patid 和 drugClass 进行分区。当这是 1 时，在一个 patid 内，一个新的 drugClass 开始了。创建一个标志，在这种情况下为 1，在所有其他情况下为 0。

然后，您可以简单地`sum`使用分区子句来获取不同值的数量。

查询（在格式化它以便我可以阅读之后）看起来像：

```
select rx.patid, d2.fillDate, d2.scriptEndDate, rx.drugName, rx.drugClass,
       SUM(IsFirstRowInGroup) over (partition by rx.patid) as NumDrugCount
from (select distinct rx.patid, d2.fillDate, d2.scriptEndDate, rx.drugName, rx.drugClass,
             (case when 1 = ROW_NUMBER() over (partition by rx.drugClass, rx.patid order by (select NULL))
                   then 1 else 0
              end) as IsFirstRowInGroup
      from (select ROW_NUMBER() over(partition by d.patid order by d.patid,d.uniquedrugsintimeframe desc) as rn, 
                   d.patid, d.fillDate, d.scriptEndDate, d.uniqueDrugsInTimeFrame
            from DrugsPerTimeFrame as d
           ) d2 inner join
           rx
           on rx.patid = d2.patid inner join
           DrugTable dt
           on dt.drugClass = rx.drugClass
      where d2.rn=1 and rx.fillDate between d2.fillDate and d2.scriptEndDate and
            dt.drugClass in ('h3a','h6h','h4b','h2f','h2s','j7c','h2e')
     ) t
order by patid 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-09-07T08:01:05.517

我认为你试图做的是作为一个窗口函数：

```
COUNT(DISTINCT rx.drugName) over(partition by rx.patid,rx.drugclass) as drugCountsInFamilies 
```

SQL抱怨的。但是你可以这样做：

```
SELECT 
rx.patid
, rx.drugName
, rx.drugClass
, (SELECT COUNT(DISTINCT rx2.drugName) FROM rx rx2 WHERE rx2.drugClass = rx.DrugClass AND rx2.patid = rx.patid) As drugCountsInFamilies
FROM rx
... 
```

如果表很大，那么最好在其中一列（例如 patid）上放置一个索引，这样嵌套查询就不会消耗大量资源。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2016-08-18T19:05:14.100

为什么这样的事情不起作用？

```
SELECT 
   IDCol_1
  ,IDCol_2
  ,Count(*) Over(Partition By IDCol_1, IDCol_2 order by IDCol_1) as numDistinct
FROM Table_1 
```

# python - 如何在站点范围内应用/使我修改后的基于 Django 类的通用视图混合可用？

> ID：13480883
> 
> 赞同：0
> 
> 时间：2012-11-20T19:44:47.177
> 
> 标签：python, django, generics, view

在我的一个项目 Django 应用程序中，我有一个自定义 mixin，用于修改基于日期的对象的基于类的通用视图：

```
class MyCoolMixin(ArchiveIndexView):
    """
    ArchiveIndexView mixin with my customizations
    """
    allow_empty = True
    make_object_list = True
    date_field = 'pub_date'

    # Pass in some custom request vars

    def get(self, request, *args, **kwargs):
        # Cool stuff here
        # including getting
        # my context data
        return self.render_to_response(context)

class MyNewArchiveIndexView(MyCoolMixin, ArchiveIndexView):
    pass 
```

它工作得很好。太好了，事实上，我想在站点范围内应用它，而不仅仅是这个特定的应用程序。但是，在 Django 1.4 的项目布局中，我不确定站点范围内的基于类的通用视图覆盖 mixin 应该存在于何处。在根views.py?

```
/path/to/myproject/myproject/views.py 
```

然后我是否只需在每个应用程序中导入修改后的通用视图以确保它可用？

此外，在我的各种应用模型中，我有不同的日期字段（有时是**pub_date**或**start_date**）。知道如何将它传递到 mixin 中，以便我可以覆盖通用视图**date_field**设置吗？

我正在寻找一种最佳实践，但我还没有看到新的基于类的通用视图 + mixins。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:05:20.923

你可以猴子补丁......但这不是“最佳实践”，它是一个黑客。

最好的做法是用你的覆盖使用默认 ArchiveIndexView 的每个 url。我已经[详细写过了，](http://blog.yourlabs.org/post/19777151073/how-to-override-a-view-from-an-external-django-app)也许它会有所帮助。

# java - Java 数组同步（可见性）

> ID：13480891
> 
> 赞同：10
> 
> 时间：2012-11-20T19:45:13.347
> 
> 标签：java, arrays, synchronization

我试图准确了解元素可见性如何在 java 中的数组上起作用。

给定班级：

```
class IntList {

    private final int[] array;

    public IntList(int[] array) {
        this.array = array;
    }

    public int[] readElements() {
        return Arrays.copyof(this.array, this.array.length);
    }

} 
```

以及以下用于创建实例的方法体：

```
int[] array = new int[length];
fillArrayWithRandomData(array); // puts data into the array from arbitrary source
return new IntList(array); 
```

我想知道 中的元素`IntList`是否保证被其他获得对返回的引用的线程可见`IntList`？

我确信对数组的引用将是可见的，因为它是最终的，但我似乎无法保证数组中的元素也可见。

注意：`IntList`该类没有允许修改数组的方法，并且数组引用不会发布到任何其他对象，我只是想知道构造后的可见性。

**编辑：**对不起，我的课程`String`在我的实际实现中没有被调用。我将班级名称更改为，`IntList`因为似乎有太多的混乱。

**编辑：** 我要在这里给出的最终答案是是的，元素是可见的。
@MikeClark 找到了 JLS 的答案：JLS § 17.5 “最终字段的使用模型很简单：在该对象的构造函数中设置对象的最终字段；并且不要将正在构造的对象的引用写在另一个线程可以在对象的构造函数完成之前看到它。如果遵循这个，那么当另一个线程看到该对象时，该线程将始终看到该对象的最终字段的正确构造版本。它还将看到任何对象的版本或由至少与最终字段一样最新的最终字段引用的数组。”

再次感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:48:50.780

由于您在构造函数中填充数组，所以是的，任何调用`new String(int[] array)`都会在它返回时初始化数组。该`final`关键字还将保证`array`在分配时对参数的最新更改将是可见的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-20T05:36:54.280

我发现这很有帮助[http://jeremymanson.blogspot.ch/2009/06/volatile-arrays-in-java.html](http://jeremymanson.blogspot.ch/2009/06/volatile-arrays-in-java.html) 所以基本上一切都发生在 volatile 读取保证被其他线程看到之前。所以有一些技巧可以让它发生。此外，jaa 提供原生 AtomicReference/Long/Integer/...Array 支持。这将确保更新对其他线程可见。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-20T19:51:08.503

您的问题似乎混淆了许多不同的概念。

*   能见度和`final`彼此无关
*   可见性和线程彼此无关
*   变量在`private`类外部对任何其他代码都不可见，无论它是否是最终的
*   `final`数组仍然可以更改其元素。它只是对数组本身的引用`final`。

当您构造`IntList`对象时（顺便说一句，感谢您更改名称），如下所示：

```
public IntList(int[] array) {
    this.array = array;
} 
```

内部`this.array`字段引用传递给构造函数的相同数组对象。仍然可以从`String`类外部修改数组：

```
int[] array = {1, 2, 3};
IntList list = new IntList(array);
System.out.println(Arrays.toString(list.readElements()); // prints [1, 2, 3]
array[1] = 0;
System.out.println(Arrays.toString(list.readElements()); // prints [1, 0, 3] 
```

您可以通过在构造函数中制作数组的副本来将您的类与此隔离：

```
public IntList(int[] array) {
    this.array = Arrays.copyOf(array, array.length);
} 
```

# java - 关于 EJB Bean 构造和 Java Servlet Inits

> ID：13480895
> 
> 赞同：0
> 
> 时间：2012-11-20T19:45:38.047
> 
> 标签：java, eclipse, servlets, ejb-3.0

我创建了一个 SimpleBean.java

```
public class SimpleBean implements SimpleBeanRemote  
{  
    private static String str = "Test";  

    private int value =0;  

    public SimpleBean()  
    {  
        G += " A";  
    value++;  
    }   

    public String getValue()
    {  
        return G + Integer.toString(value);  
    }  
} 
```

在 servlet 中，我声明了一个`private @EJB SimpleBeanRemote`bean。在`doGet`处理程序中，`bean.getValue()`语句被调用。
返回结果：Test A A1
似乎`SimpleBean`是由两次构造的。根据我的观察，Once 是在 EJB 构造中，另一个是由 Servlet 为 @EJB bean 发布的。我想问一下EJB的初始化是否正确。如果 SimpleBean 被创建了两次，那么第一次没有用吗？

是否可以一次性构造 EJB 对象。

我们会分享和讨论这些操作意味着什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:01:50.517

要理解这一点，您应该查看[会话 bean 的类型](http://docs.oracle.com/javaee/6/tutorial/doc/gipjg.html#gipkr)。

而且，如果你确定你需要这个：

> 只为一次性构造 EJB 对象。

，您应该使用单例会话 bean（使用 JavaEE 6 [@Singleton](http://docs.oracle.com/javaee/6/api/javax/ejb/Singleton.html)注释）。

# django - 跟踪在套接字 socket.io 上发送的消息

> ID：13480896
> 
> 赞同：0
> 
> 时间：2012-11-20T19:45:39.010
> 
> 标签：django, sockets, websocket, socket.io, gevent

我正在与 django.socketio 进行聊天。我想跟踪在套接字上发送的消息，以便在新用户到来时呈现它。我想让他看到在他到达之前发送的消息。

我的代码很简单：

模板：

```
 <script>
      var url = window.location.pathname.split('/');
      var id = url[3];
      var socket = new io.Socket();
      socket.connect();
      socket.on('connect', function(context){
      socket.subscribe('channel-' + id)  
      });

      socket.on('message', function(data){
      $('.try').prepend('<div> '+val+' </div>');
       });

    function send(){
    var val = $('#text').val();
    data = val
    socket.send(data);
   };
    </script> 
```

html:

```
 <form id="form" onsubmit="send(); return false">
  <input type="text" id="text">
  <input type="submit" value="Send">
  </form>

  <div class="try"> </div> 
```

事件.py：

```
 @events.on_message(channel='^channel-')
    def messages(request, socket, context, message):
    socket.send_and_broadcast_channel(message) 
```

在这个使用不同频道的简单聊天中，我想跟踪发送的消息（针对每个频道）并在用户首次连接时呈现。

我正在寻找有关如何做到这一点的提示。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T00:18:45.873

只需为消息创建一个表，并确保其中一列是聊天室名称或 id，这样您就可以查询订阅聊天室的最后 10 条消息。

因此，在呈现页面时，您会从数据库中获取最后一条消息，而下一条则来自套接字。

如果您不希望长时间保存消息，只需定期截断表以进行清理。

# r - 从 linux 命令行安装 R 包

> ID：13480897
> 
> 赞同：0
> 
> 时间：2012-11-20T19:45:39.293
> 
> 标签：r, amazon-ec2, ubuntu-12.04

我正在使用 AWS EC2 (ubuntu 12.04) 在 R 中运行一些模拟。我有一个脚本可以启动实例并更新和升级并安装 r-base r-base-dev

我想在启动（bash）脚本中添加一个命令来安装 doMC 包。每次运行机器时，我的实例都是全新的（**没有定义 R 存储库，没有定义 R 库**），我希望能够在安装 r-base 后立即安装 doMC 包。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:48:38.740

当然—— `sudo apt-get install r-cran-domc`。所以安装它就像你安装 R 本身一样。

BTW`r-base`已经暗示了`r-base-dev`。

# arrays - 裁剪一个 Matlab 数组？

> ID：13480905
> 
> 赞同：1
> 
> 时间：2012-11-20T19:46:09.697
> 
> 标签：arrays, image, matlab, crop

```
fname = dir('*sir');
[tmp, head] = loadsir(fname(1).name);
dayh99 = zeros(length(fname),size(tmp,1),size(tmp,2));  %41-100,1360,3600

% use temporary array to simplify 3d array creation
for i=1:length(fname)
  tmp = loadsir(fname(i).name);
  dayh99(i,:,:) = tmp;
end 
```

我感兴趣的领域是

```
 dayh99(i,:,:) = tmp; 
```

tmp 基本上是一个 1360X3600 的数组。问题是我不需要将整个数组存储到 dayh99 中。（它代表图像数据，我只对该图像的一部分感兴趣。）我还不确定我需要数组的哪一部分，因为我无法绘制数据也无法裁剪它。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:52:05.380

如果您只想将 tmp 的一部分放入 dayh99，只需使用索引：

```
j1 = 10
j2 = 12
k1 = 10
k2 = 12

dayh99 = zeros(length(fname), j2-j1, k2-k1)
dayh99(i, :, :) = tmp([j1:j2], [k1:k2]) 
```

我也不知道这是否是一个错误，但我不认为有一个名为 loadingir 的函数，除非你创建了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T20:01:04.500

在 matlab 中裁剪数组的方法是对它们进行切片，如下所示：

```
cropped_array=array(1:10,1:10) 
```

你也可以做一些很酷的事情，比如：

```
cropped_array=array(1:10:100,1:10:100) 
```

这只会将每 10 个变量放入列表中。

# spring - Web应用程序中的多线程和并行处理 - 需要建议

> ID：13480909
> 
> 赞同：2
> 
> 时间：2012-11-20T19:46:25.547
> 
> 标签：spring, multithreading, parallel-processing, spring-batch

问题：在 webapp 中，我们必须调用一个输入为 N(100) 数字的 Web 服务，以便该 Web 服务从队列中获取响应。一旦我得到 100 个响应，我必须将它分成 5 个线程，并为每个线程相应地划分这些响应（每个 20 个）。一旦线程的处理完成，它应该再次调用webservice。

我有 web 服务，它会根据输入编号返回响应，但我不知道应该使用什么技术来实现另一部分。

我研究了以下内容：

1.  Spring 任务执行：[http](http://static.springsource.org/spring/docs/3.0.x/reference/scheduling.html) ://static.springsource.org/spring/docs/3.0.x/reference/scheduling.html - 但这不适合，因为我无法指定需要启动多少线程。

2.  分区：section7.4：http://static.springsource.org/spring-batch/reference/html/scalability.html [-](http://static.springsource.org/spring-batch/reference/html/scalability.html)我刚遇到这个，但之前没有使用过。

如果你们中的任何一个人能引导我朝着正确的方向前进，那就太好了。

这是我的第一篇文章，如果有任何错误，我深表歉意。

更新：2012 年 11 月 21 日：我已经使用 ThreadPoolTask​​Executor 实现了。假期后我将发布我的代码片段。但是让我烦恼的一件事是我必须将 100 个结果分成 20 个一组并使用 taskExecutor.submit(); 在 For 循环中循环 5 次，这将创建 5 个线程。最好有一个直接的方式来提交这 100 个请求，并且可以选择我想要生成的线程数。

祝大家感恩节快乐。放假后会更新帖子

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:49:13.837

您可以尝试查看 google guava 是否适合[http://code.google.com/p/guava-libraries/wiki/ListenableFutureExplained](http://code.google.com/p/guava-libraries/wiki/ListenableFutureExplained)或者[http://akka.io/](http://akka.io/)框架是否适合您的需求。两者都易于封装线程处理和回调实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:49:20.717

如果您还没有使用 Spring，那么我不会仅仅将 Spring 用于它的任务执行框架：我会为此使用标准 Java。看看[执行者](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T11:58:22.120

对于使用 Spring Task Execution，您提到“但这不适合，因为我无法指定需要启动多少线程。”

实际上使用[ThreadPoolTask​​Executor](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/scheduling/concurrent/ThreadPoolTaskExecutor.html)你可以很容易地实现这一点。

```
<bean id="taskExecutor" class="org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor">
  <property name="corePoolSize" value="5" />
  <property name="maxPoolSize" value="10" />
  <property name="queueCapacity" value="25" />
</bean>

<bean id="taskExecutorExample" class="TaskExecutorExample">
  <constructor-arg ref="taskExecutor" />
</bean> 
```

这里的 corePoolSize 属性设置最初启动的线程数。

您可以阅读[http://static.springsource.org/spring/docs/3.0.x/reference/scheduling.html](http://static.springsource.org/spring/docs/3.0.x/reference/scheduling.html)中**的 25.2.2 Using a TaskExecutor**

# python - 在 Python (ProblemSetQuestion) 中解析句子（或其他更长的字符串）如何进行？

> ID：13480911
> 
> 赞同：2
> 
> 时间：2012-11-20T19:46:32.613
> 
> 标签：python, python-3.x

好的，所以我没有成功搜索该网站以在 Python 中解析长字符串（或句子，如果您愿意）。如果有以前回答过的相同性质的问题，请将我重定向到它！总之，嗨！我是一名初学者程序员（使用互联网自学 Python），我正在寻找一个（看似简单的）问题的帮助。如果您对此问题有任何意见，请不要犹豫，按照您认为合适的方式回答问题，但如果您向我解释您的解决方案或编码示例，这将真正对我有所帮助！此外，我解决这个问题的唯一想法是使用 ascii 值删除所有标点符号，如果语句将非常长，然后使用剩余的空格将剩余的文本拆分，同时将它们附加到列表中。为了节省您的时间并让我学习新的东西 宁愿看不到最长的表达式语句！另请记住，这是一个返回列表的函数，因此不要费心将其（返回）转换为字符串或不同的数据类型，例如字典。提前感谢您提供的任何帮助！

废话不多说，问题来了：

* * *

> **解析一个字符串**
> 
> 创建一个将字符串作为输入并返回 >string 中所有单词的列表的函数。它应该删除所有标点符号，用空格替换破折号。

* * *

示例（电话）：

```
 >>> parse("Listen, strange women lyin' in ponds distributin' swords is no basis for a system of government. Supreme executive power derives from a mandate from the masses, not from some farcical aquatic ceremony.") 
   [Listen, strange, women, lyin, in, ponds, distributin, swords, is, no, basis, for, a, system, of, government, Supreme, executive, power, derives, from, a, mandate, from, the, masses, not, from, some, farcical, aquatic, ceremony] 
    >>> parse("What... is the air-speed velocity of an unladen swallow?") 
    [What, is, the, air, speed, velocity, of, an, unladen, swallow] 
```

* * *

对于代码长度的运行，我感到非常抱歉！无论如何，我认为你们都明白仅从问题本身应该做什么。绝对欢迎任何建议或独特/有效的解决方案！- 温克尔森

Ps 对于连续的句子和“文本墙”非常抱歉。我有点健谈...无论如何，再次感谢您的帮助！

**请注意，输出不是列表！答案中不能包含更多符号！请不要忘记！再次感谢你的帮助！抱歉，问题的作者与答案不匹配！**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T20:08:10.813

[使用自然语言工具包 (nltk)](http://nltk.org/)真的很容易。

```
import nltk, string
text = "Listen, strange women lyin' in ponds distributin' swords is no basis for a system of government. Supreme executive power derives from a mandate from the masses, not from some farcical aquatic ceremony."

tokens = nltk.word_tokenize(text)

# remove punctuation
tokens = [word.replace("-"," ") for word in tokens if word not in string.punctuation] 
```

正在使用：

```
>>> text = "Listen, strange women lyin' in ponds distributin' swords is no basis
 for a system of government. Supreme executive power derives from a mandate from
 the masses, not from some farcical aquatic ceremony."
>>> tokens = nltk.word_tokenize(text)
>>> tokens = [word.replace("-"," ") for word in tokens if word not in string.punctuation]
>>> tokens
['Listen', 'strange', 'women', 'lyin', 'in', 'ponds', 'distributin', 'swords', '
is', 'no', 'basis', 'for', 'a', 'system', 'of', 'government.', 'Supreme', 'execu
tive', 'power', 'derives', 'from', 'a', 'mandate', 'from', 'the', 'masses', 'not
', 'from', 'some', 'farcical', 'aquatic', 'ceremony'] 
```

显然，您想要的输出非常不清楚，但如果您正在寻找该输出的字符串版本，您可以使用该`tokens`变量并执行以下操作：

```
print '[' + ', '.join(tokens) + ']' 
```

好像：

```
>>> print '['+', '.join(tokens)+']'
[Listen, strange, women, lyin, in, ponds, distributin, swords, is, no, basis, fo
r, a, system, of, government., Supreme, executive, power, derives, from, a, mand
ate, from, the, masses, not, from, some, farcical, aquatic, ceremony] 
```

你的“文字墙”确实让你很难弄清楚你想要什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:50:12.557

```
In [133]: punc = set('.,<>!@#$%^&*()-_+=]}{[\\|')

In [134]: [''.join(char for char in word if char not in punc) for word in "Listen, strange women lyin' in ponds distributin' swords is no basis for a system of government. Supreme executive power derives from a mandate from the masses, not from some farcical aquatic ceremony.".split()]
Out[134]: 
['Listen',
 'strange',
 'women',
 "lyin'",
 'in',
 'ponds',
 "distributin'",
 'swords',
 'is',
 'no',
 'basis',
 'for',
 'a',
 'system',
 'of',
 'government',
 'Supreme',
 'executive',
 'power',
 'derives',
 'from',
 'a',
 'mandate',
 'from',
 'the',
 'masses',
 'not',
 'from',
 'some',
 'farcical',
 'aquatic',
 'ceremony'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T20:09:45.493

我建议使用[正则表达式](http://docs.python.org/2/library/re.html)，像这样

```
import re

re.findall(r'[a-zA-Z]+',input_string) 
```

或者做多个字符串，先编译正则表达式

```
regexp=re.compile(r'[a-zA-Z]+')
regexp.findall(test) 
```

本质上，这是要求所有包含字母的字符，按字符分组。例如，如果您想包含缩略词，您只需将 ' 添加到表达式中，如下所示：

```
re.findall(r'[a-zA-Z']+',input_string) 
```

# ruby-on-rails - Ruby on Rails 社交网络 - user_id 产生错误

> ID：13480912
> 
> 赞同：0
> 
> 时间：2012-11-20T19:46:34.770
> 
> 标签：ruby-on-rails, ruby, rubygems, ruby-on-rails-3.2, rvm

我正在用 Ruby on rails 构建一个社交网络。我正在尝试将 user_id 添加到用户状态，但它会产生错误。代码可以在我的 github 上找到：[https ://github.com/lewisfrost/treebook.git](https://github.com/lewisfrost/treebook.git)

你能帮忙吗？我整天都被困在这上面！！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:54:03.437

至少有一个`status`对象没有关联的`user`. 这反过来意味着您无法显示该`first_name`属性。您可以通过在控制台中运行它来查找哪些状态 ID 存在此问题：

```
puts Status.where(user_id: nil).map(&:id).inspect 
```

如果你想确保一个状态确实*有*一个用户，你应该：

*   使用以下方法验证用户是否关联：`validates :user_id, :presence => true`
*   在数据库中将您的`:user_id`列设置为 NOT NULL：

    `change_table(:status){|t| t.references :user, :null => false }`

如果您不关心是否分配了用户，请修改您的视图以仅在存在 :user_id 时运行该 erb 片段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:59:57.043

为了尝试获取与您的状态相关联的用户的名字和姓氏，您可以使用非常方便的 & 含义[方法 try](http://api.rubyonrails.org/classes/Object.html#method-i-try)！

你可以在你的视图中做这样的事情：

```
<strong><%= status.user.try(:first_name) %> <%= status.user.try(:last_name) %></strong> 
```

如果用户存在，它将尝试获取用户的名字，如果用户不存在，则不会引发错误！

# c# - 使用 GetHashCode() 的子集通过分区提高 AzureTable 性能

> ID：13480913
> 
> 赞同：0
> 
> 时间：2012-11-20T16:18:47.733
> 
> 标签：c#, .net, performance, azure, azure-table-storage

一般来说，Azure Table IO 性能会随着使用更多分区而提高（我不会在延续令牌和批量更新方面进行一些权衡）。

由于分区键始终是一个字符串，我正在考虑使用基于分区键*子集*的“自然”负载平衡技术`GetHashCode()`，并将该子集附加到分区键本身。这将允许以很少的开销和轻松地计算所有直接 PK/RK 查询。批量更新可能只需要一个中间人在提交之前将类似的 PK 组合在一起。

问题：

*   我应该用它`GetHashCode()`来计算分区键吗？有更好的功能吗？

*   如果我使用`GetHashCode()`我的 PK 使用哪个角色有关系吗？

*   Azure 表和 Blob 存储是否已经为我做了这个抽象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:41:43.970

不，不要使用`GetHashCode`，因为它的值只保证在当前的 AppDomain 中是稳定的。否则，它可以随时更改。

使用您控制或标准化的散列函数。谷歌为此目的推出了一组哈希，包括“杂音哈希”。

你应该对什么进行分区（和散列）？这取决于您的查询模式。如果不查看您的查询模式，绝对无法回答。通常，尝试对几乎所有查询中的谓词进行分区。

# javascript - 自动与网站交互 - Rails

> ID：13480916
> 
> 赞同：3
> 
> 时间：2012-11-20T19:46:40.317
> 
> 标签：javascript, ruby-on-rails, mechanize

我正在尝试自动登录并在网站上发布一些内容，但我不能使用 Mechanize，因为涉及到许多 javascript 操作。我想知道是否有任何其他宝石/工具可以使用支持 javascript。

我也尝试过 Watir，但它需要一个浏览器，我想要一个无浏览器的选项。

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T20:04:04.643

有几种选择：

*   [幻影JS](http://phantomjs.org/)
*   [水豚-webkit](https://github.com/thoughtbot/capybara-webkit)
*   [硒网络驱动程序](http://seleniumhq.org/docs/01_introducing_selenium.html#selenium-2-aka-selenium-webdriver)

在此处阅读有关如何使用它们的更多信息，例如与水豚一起使用： [https ://github.com/jnicklas/capybara#drivers](https://github.com/jnicklas/capybara#drivers)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:58:38.357

您可以尝试使用 watir 无头来隐藏浏览器[。](https://github.com/leonid-shevtsov/headless)您的代码将如下所示：

```
require 'watir-webdriver'
require 'headless'

headless = Headless.new
headless.start

profile = Selenium::WebDriver::Firefox::Profile.new
driver = Selenium::WebDriver.for :firefox, profile: profile
browser = Watir::Browser.new driver

browser.goto "http://example.com"
browser.wait_until do
  browser.text_field(name: 'login').set("email@example.com")
  browser.text_field(name: 'password').set("secret")
  browser.button(name: "Sign in").click
end

# etc...

browser.close
headless.destroy 
```

# mysql - WHERE CLAUSE 中 IN 的 Mysql 变量

> ID：13480920
> 
> 赞同：0
> 
> 时间：2012-11-20T19:46:51.937
> 
> 标签：mysql, variables

> **可能重复：**
> [参数化 SQL IN 子句？](https://stackoverflow.com/questions/337704/parameterizing-an-sql-in-clause)

是否可以在 IN 子句中使用变量来获得想要的结果？

硬编码示例；

```
SELECT 1 FROM `test` WHERE test_name IN ('Test1', 'Test2'); 
```

所需的解决方案：

```
SET @test_names = 'Test1, Test2';
SELECT 1 FROM `test` WHERE test_name IN (@test_names); 
```

还是有其他方法可以实现这一目标？

解决方案：

```
SET @test_names = 'Test1,Test2';
SELECT 1 FROM `test` FIND_IN_SET(test_name, @test_names); 
```

请注意，@test_names 中没有任何空格！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:22:13.497

只是另一种解决方案。（通过反复试验得到它^^）

[SQLFIDDLE 演示](http://sqlfiddle.com/#!2/f535e/43)

```
SET @looking_for = "('Test1', 'Test2')";

SET @sql = CONCAT_WS(' WHERE test_name IN ', 'SELECT * FROM test', @looking_for);
PREPARE preptest FROM @sql;
EXECUTE preptest; 
```

# asp.net - 带有 DetailsView 的 ASP.NET 父子 DropDownList 控件

> ID：13480923
> 
> 赞同：0
> 
> 时间：2012-11-20T19:47:01.117
> 
> 标签：asp.net, sql-server

从上一期关于父子下拉列表的问题修复后，我想在选择子下拉列表（数据库名称）后制作详细信息视图显示结果。我试图在detailview的sqldatasource中添加控件，它似乎不起作用并且显示为空白。我在 SQLDataSource 的 SelectCommand 中添加了 @Database。这是父子下拉列表代码，

```
<asp:Label ID="Label9" runat="server" Text="Select Server:"></asp:Label>
    <br />
    <asp:DropDownList ID="DropDownServerName" runat="server" AutoPostBack="True" DataSourceID="SqlDataSource2" DataTextField="ServerName" DataValueField="ServerName">
    </asp:DropDownList>
    <asp:SqlDataSource ID="SqlDataSource2" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [ServerName] FROM [tblServer]"></asp:SqlDataSource>
    <br />
    <br />
    <br />
    <asp:Label ID="Label10" runat="server" Text="Select Database:"></asp:Label>
    <br />
    <asp:DropDownList ID="DropDownDatabase" runat="server" AutoPostBack="True" DataSourceID="SqlDataSource3" DataTextField="DatabaseName" DataValueField="DatabaseName">
    </asp:DropDownList>
    <asp:SqlDataSource ID="SqlDataSource3" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [DatabaseName] FROM [tblDatabase] WHERE [ServerName] = @ServerName">
        <SelectParameters>
            <asp:ControlParameter ControlID="DropDownServerName" Name="ServerName" PropertyName="SelectedValue" />
        </SelectParameters>
    </asp:SqlDataSource> 
```

然后详细查看代码，

```
<asp:DetailsView ID="DetailsView1" runat="server" AllowPaging="True" AutoGenerateRows="False" DataKeyNames="DatabaseName,ServerName,Instance" DataSourceID="SqlDataSource1" Height="50px" Width="125px" BackColor="White" BorderColor="#CCCCCC" BorderStyle="None" BorderWidth="1px" CellPadding="3">
        <EditRowStyle BackColor="#669999" Font-Bold="True" ForeColor="White" />
        <Fields>
            <asp:CommandField ShowDeleteButton="True" ShowEditButton="True" ShowInsertButton="True" />
            <asp:TemplateField HeaderText="ServerName" SortExpression="ServerName">
                <EditItemTemplate>
                    <asp:Label ID="Label1" runat="server" Text='<%# Eval("ServerName") %>'></asp:Label>
                </EditItemTemplate>
                <InsertItemTemplate>
                    <asp:DropDownList ID="DropDownList15" runat="server" DataSourceID="servername" DataTextField="ServerName" DataValueField="ServerName" SelectedValue='<%# Bind("ServerName") %>'>
                    </asp:DropDownList>
                    <asp:SqlDataSource ID="servername" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [ServerName] FROM [tblServer]"></asp:SqlDataSource>
                </InsertItemTemplate>
                <ItemTemplate>
                    <asp:Label ID="Label8" runat="server" Text='<%# Bind("ServerName") %>'></asp:Label>
                </ItemTemplate>
            </asp:TemplateField>
            <asp:BoundField DataField="Instance" HeaderText="Instance" ReadOnly="True" SortExpression="Instance" />
            <asp:BoundField DataField="DatabaseName" HeaderText="DatabaseName" ReadOnly="True" SortExpression="DatabaseName" />
            <asp:BoundField DataField="InstanceOccurence" HeaderText="InstanceOccurence" SortExpression="InstanceOccurence" />
            <asp:BoundField DataField="OccurenceNormalState" HeaderText="OccurenceNormalState" SortExpression="OccurenceNormalState" />
            <asp:BoundField DataField="SupportedFuntionalArea" HeaderText="SupportedFuntionalArea" SortExpression="SupportedFuntionalArea" />
            <asp:TemplateField HeaderText="Primary_DBA" SortExpression="Primary_DBA">
                <EditItemTemplate>
                    <asp:DropDownList ID="DropDownList2" runat="server" DataSourceID="userid" DataTextField="UserID" DataValueField="UserID" SelectedValue='<%# Bind("Primary_DBA") %>'>
                    </asp:DropDownList>
                    <asp:SqlDataSource ID="userid" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [UserID] FROM [tblDBA]"></asp:SqlDataSource>
                </EditItemTemplate>
                <InsertItemTemplate>
                    <asp:DropDownList ID="DropDownList8" runat="server" DataSourceID="userid" DataTextField="UserID" DataValueField="UserID" SelectedValue='<%# Bind("Primary_DBA") %>'>
                    </asp:DropDownList>
                    <asp:SqlDataSource ID="userid" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [UserID] FROM [tblDBA]"></asp:SqlDataSource>
                </InsertItemTemplate>
                <ItemTemplate>
                    <asp:Label ID="Label2" runat="server" Text='<%# Bind("Primary_DBA") %>'></asp:Label>
                </ItemTemplate>
            </asp:TemplateField>
            <asp:BoundField DataField="Quarter_Close_Vital" HeaderText="Quarter_Close_Vital" SortExpression="Quarter_Close_Vital" />
            <asp:BoundField DataField="Business_Importance" HeaderText="Business_Importance" SortExpression="Business_Importance" />
            <asp:BoundField DataField="Application_Number" HeaderText="Application_Number" SortExpression="Application_Number" />
            <asp:BoundField DataField="Portfolio_Lookup" HeaderText="Portfolio_Lookup" SortExpression="Portfolio_Lookup" />
            <asp:BoundField DataField="Description" HeaderText="Description" SortExpression="Description" />
            <asp:TemplateField HeaderText="WorkProcess" SortExpression="WorkProcess">
                <EditItemTemplate>
                    <asp:DropDownList ID="DropDownList1" runat="server" DataSourceID="workprocess" DataTextField="WorkProcess" DataValueField="WorkProcess" SelectedValue='<%# Bind("WorkProcess") %>'>
                    </asp:DropDownList>
                    <asp:SqlDataSource ID="workprocess" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [WorkProcess] FROM [tblWorkProcess]"></asp:SqlDataSource>
                </EditItemTemplate>
                <InsertItemTemplate>
                    <asp:DropDownList ID="DropDownList9" runat="server" DataSourceID="workprocess" DataTextField="WorkProcess" DataValueField="WorkProcess" SelectedValue='<%# Bind("WorkProcess") %>'>
                    </asp:DropDownList>
                    <asp:SqlDataSource ID="workprocess" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [WorkProcess] FROM [tblWorkProcess]"></asp:SqlDataSource>
                </InsertItemTemplate>
                <ItemTemplate>
                    <asp:Label ID="Label1" runat="server" Text='<%# Bind("WorkProcess") %>'></asp:Label>
                </ItemTemplate>
            </asp:TemplateField>
            <asp:BoundField DataField="Data_Owner_1" HeaderText="Data_Owner_1" SortExpression="Data_Owner_1" />
            <asp:BoundField DataField="Data_Owner_2" HeaderText="Data_Owner_2" SortExpression="Data_Owner_2" />
            <asp:TemplateField HeaderText="TMASGroupNumber" SortExpression="TMASGroupNumber">
                <EditItemTemplate>
                    <asp:DropDownList ID="DropDownList3" runat="server" DataSourceID="TMAS" DataTextField="TMASGroupNumber" DataValueField="TMASGroupNumber" SelectedValue='<%# Bind("TMASGroupNumber") %>'>
                    </asp:DropDownList>
                    <asp:SqlDataSource ID="TMAS" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [TMASGroupNumber] FROM [tblTM_AS]"></asp:SqlDataSource>
                </EditItemTemplate>
                <InsertItemTemplate>
                    <asp:DropDownList ID="DropDownList10" runat="server" DataSourceID="TMAS" DataTextField="TMASGroupNumber" DataValueField="TMASGroupNumber" SelectedValue='<%# Bind("TMASGroupNumber") %>'>
                    </asp:DropDownList>
                    <asp:SqlDataSource ID="TMAS" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [TMASGroupNumber] FROM [tblTM_AS]"></asp:SqlDataSource>
                </InsertItemTemplate>
                <ItemTemplate>
                    <asp:Label ID="Label3" runat="server" Text='<%# Bind("TMASGroupNumber") %>'></asp:Label>
                </ItemTemplate>
            </asp:TemplateField>
            <asp:TemplateField HeaderText="TMLASGroupNumber" SortExpression="TMLASGroupNumber">
                <EditItemTemplate>
                    <asp:DropDownList ID="DropDownList4" runat="server" DataSourceID="TMLAS" DataTextField="TMLASGroupNumber" DataValueField="TMLASGroupNumber" SelectedValue='<%# Bind("TMLASGroupNumber") %>'>
                    </asp:DropDownList>
                    <asp:SqlDataSource ID="TMLAS" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [TMLASGroupNumber] FROM [tblTM_LAS]"></asp:SqlDataSource>
                </EditItemTemplate>
                <InsertItemTemplate>
                    <asp:DropDownList ID="DropDownList11" runat="server" DataSourceID="TMLAS" DataTextField="TMLASGroupNumber" DataValueField="TMLASGroupNumber" SelectedValue='<%# Bind("TMLASGroupNumber") %>'>
                    </asp:DropDownList>
                    <asp:SqlDataSource ID="TMLAS" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [TMLASGroupNumber] FROM [tblTM_LAS]"></asp:SqlDataSource>
                </InsertItemTemplate>
                <ItemTemplate>
                    <asp:Label ID="Label4" runat="server" Text='<%# Bind("TMLASGroupNumber") %>'></asp:Label>
                </ItemTemplate>
            </asp:TemplateField>
            <asp:TemplateField HeaderText="IIASGroupNumber" SortExpression="IIASGroupNumber">
                <EditItemTemplate>
                    <asp:DropDownList ID="DropDownList5" runat="server" DataSourceID="IIAS" DataTextField="IIASGroupNumber" DataValueField="IIASGroupNumber" SelectedValue='<%# Bind("IIASGroupNumber") %>'>
                    </asp:DropDownList>
                    <asp:SqlDataSource ID="IIAS" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [IIASGroupNumber] FROM [tblII_AS]"></asp:SqlDataSource>
                </EditItemTemplate>
                <InsertItemTemplate>
                    <asp:DropDownList ID="DropDownList12" runat="server" DataSourceID="IIAS" DataTextField="IIASGroupNumber" DataValueField="IIASGroupNumber" SelectedValue='<%# Bind("IIASGroupNumber") %>'>
                    </asp:DropDownList>
                    <asp:SqlDataSource ID="IIAS" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [IIASGroupNumber] FROM [tblII_AS]"></asp:SqlDataSource>
                </InsertItemTemplate>
                <ItemTemplate>
                    <asp:Label ID="Label5" runat="server" Text='<%# Bind("IIASGroupNumber") %>'></asp:Label>
                </ItemTemplate>
            </asp:TemplateField>
            <asp:BoundField DataField="Backup_Nodes" HeaderText="Backup_Nodes" SortExpression="Backup_Nodes" />
            <asp:BoundField DataField="ConnectionString" HeaderText="ConnectionString" SortExpression="ConnectionString" />
            <asp:BoundField DataField="Notes" HeaderText="Notes" SortExpression="Notes" />
            <asp:BoundField DataField="Role_Based_Security_Doc" HeaderText="Role_Based_Security_Doc" SortExpression="Role_Based_Security_Doc" />
            <asp:BoundField DataField="Alias" HeaderText="Alias" SortExpression="Alias" />
            <asp:TemplateField HeaderText="Architecture" SortExpression="Architecture">
                <EditItemTemplate>
                    <asp:DropDownList ID="DropDownList6" runat="server" SelectedValue='<%# Bind("Architecture") %>'>
                        <asp:ListItem>BSN EAP</asp:ListItem>
                        <asp:ListItem>BSN NEA</asp:ListItem>
                        <asp:ListItem>BSNConnect.com</asp:ListItem>
                        <asp:ListItem>BSNDMZ.COM</asp:ListItem>
                        <asp:ListItem>Dow EAP</asp:ListItem>
                        <asp:ListItem>Dow NEA</asp:ListItem>
                    </asp:DropDownList>
                </EditItemTemplate>
                <InsertItemTemplate>
                    <asp:DropDownList ID="DropDownList13" runat="server" SelectedValue='<%# Bind("Architecture") %>'>
                        <asp:ListItem>BSN EAP</asp:ListItem>
                        <asp:ListItem>BSN NEA</asp:ListItem>
                        <asp:ListItem>BSNConnect.com</asp:ListItem>
                        <asp:ListItem>BSNDMZ.COM</asp:ListItem>
                        <asp:ListItem>Dow EAP</asp:ListItem>
                        <asp:ListItem>Dow NEA</asp:ListItem>
                    </asp:DropDownList>
                </InsertItemTemplate>
                <ItemTemplate>
                    <asp:Label ID="Label6" runat="server" Text='<%# Bind("Architecture") %>'></asp:Label>
                </ItemTemplate>
            </asp:TemplateField>
            <asp:BoundField DataField="Max_Users" HeaderText="Max_Users" SortExpression="Max_Users" />
            <asp:BoundField DataField="Projected_Growth" HeaderText="Projected_Growth" SortExpression="Projected_Growth" />
            <asp:BoundField DataField="Storage_Requirements" HeaderText="Storage_Requirements" SortExpression="Storage_Requirements" />
            <asp:BoundField DataField="SID" HeaderText="SID" SortExpression="SID" />
            <asp:TemplateField HeaderText="Version" SortExpression="Version">
                <EditItemTemplate>
                    <asp:DropDownList ID="DropDownList7" runat="server" SelectedValue='<%# Bind("Version") %>'>
                        <asp:ListItem>Oracle 11g</asp:ListItem>
                        <asp:ListItem>Oracle 11g R2</asp:ListItem>
                        <asp:ListItem>SQL Server 2008</asp:ListItem>
                        <asp:ListItem>SQL Server 2008 R2</asp:ListItem>
                        <asp:ListItem>SQL Server 2012</asp:ListItem>
                        <asp:ListItem>SQL Svr 2008 R2 SS%S</asp:ListItem>
                        <asp:ListItem>SQL Svr 2012 SS%S</asp:ListItem>
                    </asp:DropDownList>
                </EditItemTemplate>
                <InsertItemTemplate>
                    <asp:DropDownList ID="DropDownList14" runat="server" SelectedValue='<%# Bind("Version") %>'>
                        <asp:ListItem>Oracle 11g</asp:ListItem>
                        <asp:ListItem>Oracle 11g R2</asp:ListItem>
                        <asp:ListItem>SQL Server 2008</asp:ListItem>
                        <asp:ListItem>SQL Server 2008 R2</asp:ListItem>
                        <asp:ListItem>SQL Server 2012</asp:ListItem>
                        <asp:ListItem>SQL Svr 2008 R2 SS%S</asp:ListItem>
                        <asp:ListItem>SQL Svr 2012 SS%S</asp:ListItem>
                    </asp:DropDownList>
                </InsertItemTemplate>
                <ItemTemplate>
                    <asp:Label ID="Label7" runat="server" Text='<%# Bind("Version") %>'></asp:Label>
                </ItemTemplate>
            </asp:TemplateField>
        </Fields>
        <FooterStyle BackColor="White" ForeColor="#000066" />
        <HeaderStyle BackColor="#006699" Font-Bold="True" ForeColor="White" />
        <PagerStyle BackColor="White" ForeColor="#000066" HorizontalAlign="Left" />
        <RowStyle ForeColor="#000066" />
    </asp:DetailsView>
    <asp:SqlDataSource ID="SqlDataSource1" runat="server" ConflictDetection="CompareAllValues" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" DeleteCommand="DELETE FROM [tblDatabase] WHERE [DatabaseName] = @original_DatabaseName AND [ServerName] = @original_ServerName AND [Instance] = @original_Instance AND [WorkProcess] = @original_WorkProcess AND [Primary_DBA] = @original_Primary_DBA AND [TMLASGroupNumber] = @original_TMLASGroupNumber AND [TMASGroupNumber] = @original_TMASGroupNumber AND [IIASGroupNumber] = @original_IIASGroupNumber AND (([Architecture] = @original_Architecture) OR ([Architecture] IS NULL AND @original_Architecture IS NULL)) AND (([Version] = @original_Version) OR ([Version] IS NULL AND @original_Version IS NULL)) AND (([Quarter_Close_Vital] = @original_Quarter_Close_Vital) OR ([Quarter_Close_Vital] IS NULL AND @original_Quarter_Close_Vital IS NULL)) AND (([Business_Importance] = @original_Business_Importance) OR ([Business_Importance] IS NULL AND @original_Business_Importance IS NULL)) AND (([Application_Number] = @original_Application_Number) OR ([Application_Number] IS NULL AND @original_Application_Number IS NULL)) AND (([Description] = @original_Description) OR ([Description] IS NULL AND @original_Description IS NULL)) AND (([Role_Based_Security_Doc] = @original_Role_Based_Security_Doc) OR ([Role_Based_Security_Doc] IS NULL AND @original_Role_Based_Security_Doc IS NULL)) AND (([Max_Users] = @original_Max_Users) OR ([Max_Users] IS NULL AND @original_Max_Users IS NULL)) AND (([Storage_Requirements] = @original_Storage_Requirements) OR ([Storage_Requirements] IS NULL AND @original_Storage_Requirements IS NULL)) AND (([Projected_Growth] = @original_Projected_Growth) OR ([Projected_Growth] IS NULL AND @original_Projected_Growth IS NULL)) AND (([Data_Owner_1] = @original_Data_Owner_1) OR ([Data_Owner_1] IS NULL AND @original_Data_Owner_1 IS NULL)) AND (([Data_Owner_2] = @original_Data_Owner_2) OR ([Data_Owner_2] IS NULL AND @original_Data_Owner_2 IS NULL)) AND (([SID] = @original_SID) OR ([SID] IS NULL AND @original_SID IS NULL)) AND (([Alias] = @original_Alias) OR ([Alias] IS NULL AND @original_Alias IS NULL)) AND (([Backup_Nodes] = @original_Backup_Nodes) OR ([Backup_Nodes] IS NULL AND @original_Backup_Nodes IS NULL)) AND (([Portfolio_Lookup] = @original_Portfolio_Lookup) OR ([Portfolio_Lookup] IS NULL AND @original_Portfolio_Lookup IS NULL)) AND (([Notes] = @original_Notes) OR ([Notes] IS NULL AND @original_Notes IS NULL)) AND (([ConnectionString] = @original_ConnectionString) OR ([ConnectionString] IS NULL AND @original_ConnectionString IS NULL)) AND (([InstanceOccurence] = @original_InstanceOccurence) OR ([InstanceOccurence] IS NULL AND @original_InstanceOccurence IS NULL)) AND (([OccurenceNormalState] = @original_OccurenceNormalState) OR ([OccurenceNormalState] IS NULL AND @original_OccurenceNormalState IS NULL)) AND (([SupportedFuntionalArea] = @original_SupportedFuntionalArea) OR ([SupportedFuntionalArea] IS NULL AND @original_SupportedFuntionalArea IS NULL))" InsertCommand="INSERT INTO [tblDatabase] ([DatabaseName], [ServerName], [WorkProcess], [Primary_DBA], [TMLASGroupNumber], [TMASGroupNumber], [IIASGroupNumber], [Architecture], [Version], [Quarter_Close_Vital], [Business_Importance], [Application_Number], [Description], [Role_Based_Security_Doc], [Max_Users], [Storage_Requirements], [Projected_Growth], [Data_Owner_1], [Data_Owner_2], [SID], [Alias], [Instance], [Backup_Nodes], [Portfolio_Lookup], [Notes], [ConnectionString], [InstanceOccurence], [OccurenceNormalState], [SupportedFuntionalArea]) VALUES (@DatabaseName, @ServerName, @WorkProcess, @Primary_DBA, @TMLASGroupNumber, @TMASGroupNumber, @IIASGroupNumber, @Architecture, @Version, @Quarter_Close_Vital, @Business_Importance, @Application_Number, @Description, @Role_Based_Security_Doc, @Max_Users, @Storage_Requirements, @Projected_Growth, @Data_Owner_1, @Data_Owner_2, @SID, @Alias, @Instance, @Backup_Nodes, @Portfolio_Lookup, @Notes, @ConnectionString, @InstanceOccurence, @OccurenceNormalState, @SupportedFuntionalArea)" OldValuesParameterFormatString="original_{0}" SelectCommand="SELECT * FROM [tblDatabase] WHERE [DatabaseName] = @DatabaseName" UpdateCommand="UPDATE [tblDatabase] SET [WorkProcess] = @WorkProcess, [Primary_DBA] = @Primary_DBA, [TMLASGroupNumber] = @TMLASGroupNumber, [TMASGroupNumber] = @TMASGroupNumber, [IIASGroupNumber] = @IIASGroupNumber, [Architecture] = @Architecture, [Version] = @Version, [Quarter_Close_Vital] = @Quarter_Close_Vital, [Business_Importance] = @Business_Importance, [Application_Number] = @Application_Number, [Description] = @Description, [Role_Based_Security_Doc] = @Role_Based_Security_Doc, [Max_Users] = @Max_Users, [Storage_Requirements] = @Storage_Requirements, [Projected_Growth] = @Projected_Growth, [Data_Owner_1] = @Data_Owner_1, [Data_Owner_2] = @Data_Owner_2, [SID] = @SID, [Alias] = @Alias, [Backup_Nodes] = @Backup_Nodes, [Portfolio_Lookup] = @Portfolio_Lookup, [Notes] = @Notes, [ConnectionString] = @ConnectionString, [InstanceOccurence] = @InstanceOccurence, [OccurenceNormalState] = @OccurenceNormalState, [SupportedFuntionalArea] = @SupportedFuntionalArea WHERE [DatabaseName] = @original_DatabaseName AND [ServerName] = @original_ServerName AND [Instance] = @original_Instance AND [WorkProcess] = @original_WorkProcess AND [Primary_DBA] = @original_Primary_DBA AND [TMLASGroupNumber] = @original_TMLASGroupNumber AND [TMASGroupNumber] = @original_TMASGroupNumber AND [IIASGroupNumber] = @original_IIASGroupNumber AND (([Architecture] = @original_Architecture) OR ([Architecture] IS NULL AND @original_Architecture IS NULL)) AND (([Version] = @original_Version) OR ([Version] IS NULL AND @original_Version IS NULL)) AND (([Quarter_Close_Vital] = @original_Quarter_Close_Vital) OR ([Quarter_Close_Vital] IS NULL AND @original_Quarter_Close_Vital IS NULL)) AND (([Business_Importance] = @original_Business_Importance) OR ([Business_Importance] IS NULL AND @original_Business_Importance IS NULL)) AND (([Application_Number] = @original_Application_Number) OR ([Application_Number] IS NULL AND @original_Application_Number IS NULL)) AND (([Description] = @original_Description) OR ([Description] IS NULL AND @original_Description IS NULL)) AND (([Role_Based_Security_Doc] = @original_Role_Based_Security_Doc) OR ([Role_Based_Security_Doc] IS NULL AND @original_Role_Based_Security_Doc IS NULL)) AND (([Max_Users] = @original_Max_Users) OR ([Max_Users] IS NULL AND @original_Max_Users IS NULL)) AND (([Storage_Requirements] = @original_Storage_Requirements) OR ([Storage_Requirements] IS NULL AND @original_Storage_Requirements IS NULL)) AND (([Projected_Growth] = @original_Projected_Growth) OR ([Projected_Growth] IS NULL AND @original_Projected_Growth IS NULL)) AND (([Data_Owner_1] = @original_Data_Owner_1) OR ([Data_Owner_1] IS NULL AND @original_Data_Owner_1 IS NULL)) AND (([Data_Owner_2] = @original_Data_Owner_2) OR ([Data_Owner_2] IS NULL AND @original_Data_Owner_2 IS NULL)) AND (([SID] = @original_SID) OR ([SID] IS NULL AND @original_SID IS NULL)) AND (([Alias] = @original_Alias) OR ([Alias] IS NULL AND @original_Alias IS NULL)) AND (([Backup_Nodes] = @original_Backup_Nodes) OR ([Backup_Nodes] IS NULL AND @original_Backup_Nodes IS NULL)) AND (([Portfolio_Lookup] = @original_Portfolio_Lookup) OR ([Portfolio_Lookup] IS NULL AND @original_Portfolio_Lookup IS NULL)) AND (([Notes] = @original_Notes) OR ([Notes] IS NULL AND @original_Notes IS NULL)) AND (([ConnectionString] = @original_ConnectionString) OR ([ConnectionString] IS NULL AND @original_ConnectionString IS NULL)) AND (([InstanceOccurence] = @original_InstanceOccurence) OR ([InstanceOccurence] IS NULL AND @original_InstanceOccurence IS NULL)) AND (([OccurenceNormalState] = @original_OccurenceNormalState) OR ([OccurenceNormalState] IS NULL AND @original_OccurenceNormalState IS NULL)) AND (([SupportedFuntionalArea] = @original_SupportedFuntionalArea) OR ([SupportedFuntionalArea] IS NULL AND @original_SupportedFuntionalArea IS NULL))">
        <SelectParameters>
            <asp:ControlParameter ControlID="DropDownDatabase" Name="DatabaseName" PropertyName="SelectedValue"/>
        </SelectParameters>
            <UpdateParameters>
            <asp:Parameter Name="WorkProcess" Type="String" />
            <asp:Parameter Name="Primary_DBA" Type="String" />
            <asp:Parameter Name="TMLASGroupNumber" Type="Int32" />
            <asp:Parameter Name="TMASGroupNumber" Type="Int32" />
            <asp:Parameter Name="IIASGroupNumber" Type="Int32" />
            <asp:Parameter Name="Architecture" Type="String" />
            <asp:Parameter Name="Version" Type="String" />
            <asp:Parameter Name="Quarter_Close_Vital" Type="String" />
            <asp:Parameter Name="Business_Importance" Type="String" />
            <asp:Parameter Name="Application_Number" Type="String" />
            <asp:Parameter Name="Description" Type="String" />
            <asp:Parameter Name="Role_Based_Security_Doc" Type="String" />
            <asp:Parameter Name="Max_Users" Type="String" />
            <asp:Parameter Name="Storage_Requirements" Type="String" />
            <asp:Parameter Name="Projected_Growth" Type="String" />
            <asp:Parameter Name="Data_Owner_1" Type="String" />
            <asp:Parameter Name="Data_Owner_2" Type="String" />
            <asp:Parameter Name="SID" Type="String" />
            <asp:Parameter Name="Alias" Type="String" />
            <asp:Parameter Name="Backup_Nodes" Type="String" />
            <asp:Parameter Name="Portfolio_Lookup" Type="String" />
            <asp:Parameter Name="Notes" Type="String" />
            <asp:Parameter Name="ConnectionString" Type="String" />
            <asp:Parameter Name="InstanceOccurence" Type="Decimal" />
            <asp:Parameter Name="OccurenceNormalState" Type="String" />
            <asp:Parameter Name="SupportedFuntionalArea" Type="String" />
            <asp:Parameter Name="original_DatabaseName" Type="String" />
            <asp:Parameter Name="original_ServerName" Type="String" />
            <asp:Parameter Name="original_Instance" Type="String" />
            <asp:Parameter Name="original_WorkProcess" Type="String" />
            <asp:Parameter Name="original_Primary_DBA" Type="String" />
            <asp:Parameter Name="original_TMLASGroupNumber" Type="Int32" />
            <asp:Parameter Name="original_TMASGroupNumber" Type="Int32" />
            <asp:Parameter Name="original_IIASGroupNumber" Type="Int32" />
            <asp:Parameter Name="original_Architecture" Type="String" />
            <asp:Parameter Name="original_Version" Type="String" />
            <asp:Parameter Name="original_Quarter_Close_Vital" Type="String" />
            <asp:Parameter Name="original_Business_Importance" Type="String" />
            <asp:Parameter Name="original_Application_Number" Type="String" />
            <asp:Parameter Name="original_Description" Type="String" />
            <asp:Parameter Name="original_Role_Based_Security_Doc" Type="String" />
            <asp:Parameter Name="original_Max_Users" Type="String" />
            <asp:Parameter Name="original_Storage_Requirements" Type="String" />
            <asp:Parameter Name="original_Projected_Growth" Type="String" />
            <asp:Parameter Name="original_Data_Owner_1" Type="String" />
            <asp:Parameter Name="original_Data_Owner_2" Type="String" />
            <asp:Parameter Name="original_SID" Type="String" />
            <asp:Parameter Name="original_Alias" Type="String" />
            <asp:Parameter Name="original_Backup_Nodes" Type="String" />
            <asp:Parameter Name="original_Portfolio_Lookup" Type="String" />
            <asp:Parameter Name="original_Notes" Type="String" />
            <asp:Parameter Name="original_ConnectionString" Type="String" />
            <asp:Parameter Name="original_InstanceOccurence" Type="Decimal" />
            <asp:Parameter Name="original_OccurenceNormalState" Type="String" />
            <asp:Parameter Name="original_SupportedFuntionalArea" Type="String" />
        </UpdateParameters>
    </asp:SqlDataSource> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:55:39.157

它正在做你告诉它做的事情。

```
 <SelectParameters>
        <asp:ControlParameter ControlID="DropDownServerName" PropertyName="SelectedValue" />
    </SelectParameters> 
```

那就是告诉第二个列表基于第一个列表的选择。如果您希望这些列表彼此分开，您将需要一个数据库名称列表，您可以使用它来填充不依赖于服务器名称选择的数据库名称列表。

编辑：

您的语法似乎不正确。

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.controlparameter(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.controlparameter(v=vs.80).aspx)

```
<asp:SqlDataSource ID="SqlDataSource3" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [DatabaseName] FROM [tblDatabase]">
        <SelectParameters>
            <asp:ControlParameter ControlID="DropDownServerName" PropertyName="SelectedValue" />
        </SelectParameters>
    </asp:SqlDataSource> 
```

应该

```
<asp:SqlDataSource ID="SqlDataSource3" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [DatabaseName] FROM [tblDatabase] WHERE [Servername] = @ServerName">
    <SelectParameters>
        <asp:ControlParameter name="ServerName" ControlID="DropDownServerName" PropertyName="SelectedValue" />
    </SelectParameters>
</asp:SqlDataSource> 
```

# networking - 用星号设置 IVR

> ID：13480925
> 
> 赞同：0
> 
> 时间：2012-11-20T19:47:06.050
> 
> 标签：networking, asterisk, telephony, ivr

我正在尝试用星号实现一个​​最简单的 IVR 系统， 我在我的 Windows 系统上安装了[asteriskwin32 。](http://www.asteriskwin32.com/)

我目前拥有的是

*   PSTN 连接

*   56k 语音和传真调制解调器。

我还需要什么（硬件或软件）吗？它会起作用吗？

我需要做些什么来同时处理多个电话，因为我的 PSTN 连接一次只能打一个电话？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:55:10.390

您将需要一些额外的硬件来将您的 PSTN 连接到 Asterisk 盒子：

[http://store.digium.com/boards/](http://store.digium.com/boards/)

或者你可以跳过所有这些，让自己成为一个 SIP 提供商，这不需要硬件，只需要一些配置。

如果您想坚持使用 PSTN，则需要额外的 PSTN 线路来同时通话。使用 SIP 提供商，您只需配置一个 SIP 连接，即可获得想要支付的任意数量的“线路”。

如果可能的话，我还想建议您在 Linux 机器上进行此设置。祝你好运，希望你能按照自己的喜好进行设置！

哦，这里列出了许多 SIP 中继提供商：

[http://www.voip-info.org/wiki/view/Sip+Trunking+Providers](http://www.voip-info.org/wiki/view/Sip+Trunking+Providers)

# c++ - OpenGL：GL_TEXTURE_CUBE_MAP 和 GL_REFLECTION_MAP

> ID：13480928
> 
> 赞同：4
> 
> 时间：2012-11-20T19:47:08.250
> 
> 标签：c++, opengl

我目前正在开发一个 OpenGL 项目。每次我尝试引用 GL_TEXTURE_CUBE_MAP 和 GL_REFLECTION_MAP 时，它们在我看来都是未定义的。我已经包含了 gl.h、glu.h 和 glut.h，但它们仍然显示为未定义。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T19:49:59.177

OpenGL-1.1 之外的所有内容都不是 Windows 上的 OS ABI（二进制接口）规范和 GLX 上的 OpenGL-1.2 规范的一部分（Linux 即将获得修订后的 OpenGL ABI）

超出该功能的任何内容都必须在运行时通过*扩展加载机制加载*，即使它是核心功能。使用[GLEW](http://glew.sf.net)库最容易完成。

# php - 验证 PHP 生成的 HTML 代码

> ID：13480930
> 
> 赞同：-3
> 
> 时间：2012-11-20T19:47:12.427
> 
> 标签：php, html, validation, declaration, doctype

我想知道你是否可以提供一点帮助。

首先，我是编码的高初学者，所以不要对我太苛刻:)

我正在尝试验证我网站上的代码，但我遇到了无法摆脱的恼人错误。 **这是源代码：**

```
<div id="mainWrapperbackground">
    <div id="allContentbackground">
        <img src="img/banner.png" alt="banner" id="banner">
        <img src="img/left.jpg" alt="leftside" id="left">
        <img src="img/right.jpg" alt="rightside" id="right">
        <img src="img/nav.png" alt="navigation" id="fullnav">
        <img src="img/poleright.png" alt="poleright" id="poleright">
        <img src="img/poleleft.png" alt="poleleft" id="poleleft">
        <img src="img/footer.jpg" alt="footer" id="footerimg">
        <form method="get" action="/search" id="search">
            <input name="index.php?page=recipe1" type="text" size="40" placeholder="Search..." >
        </form>

        <div id="footer">
            <em>Rising Cupcakes | Fairystreet 182st | 4500 Wonderland | Tel. +88 21 45 65</em>
        </div></div></div>
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <link href="styles.css" rel="stylesheet" />
        <title>Cupcake Lovers</title>
    </head>
    <body>
        <div id="mainWrapper">
            <div id="allContent">
                <div id="mainWrapperbackground"> 
                    <div id="allContentbackground"> 
                        <nav id="global-nav"> 
                            <a href="index.php?page=contact"> <img src="img/contactb.png" alt="contactb" id="contactb"></a> <a href="index.php?page=guestbook"><img src="img/guestbookb.png" alt="guestbookb" id="guestbookb"></a> <a href="index.php?page=newsletter"><img src="img/newsletterb.png" alt="newsletterb" id="newsletterb"></a> <a href="index.php?page=history"><img src="img/historyb.png" alt="historyb" id="historyb"></a> <a href="mailto:cupcake@recipes.dk"><img src="img/maillogo.png" alt="maillogo" id="maillogo"></a> <a href="http://www.facebook.com"><img src="img/fblogo.png" alt="facebooklogo" id="fblogo"></a> <a href="index.php?page=home"><img src="img/homeb.png" alt="homeb" id="homeb"></a> <a href="index.php?page=recipegallery"><img src="img/recipesb.png" alt="recipesbutton" id="recipesb"> </a> 
                        </nav> 
                        <img src ="img/cupcake.png" alt="cupcake" id="cupcake"> 
                        <div id="homehead"> 
                        <h5>Welcome!
                    </h5> 
                </div> 
                <p class="first">Welcome to <b>"Cupcake Lovers"!</b>
                <br>
                    <br> 
                        We have opened this homepage to introduce you to Celina's 6 most famous cupcake recipes.
                        <br> 
                            Celina's recipes follow the principle of being easy to make, beautiful to look at, and delicious to eat!
                            <br> 
                                If like Celina, cupcakes are your passion, then go learn about the history of cupcakes or join our 
                                <br>
                                    newsletter and get updates about what's going on in the world of cupcakes. 
                                    <br>
                                        <br>
                                            Don't forget to sign our guestbook!
                                            <br>
                                                <br>
                                                    Happy baking,
                                                    <br>
                                                        <em>Celina's cupcakes for Cupcake Lovers</em>
                                                        <br> 
                                                            ----------------------------------------------------------------------------------------------------------------------------- 
                                                        </p> 
                                                    </div>
                                                </div>
                                            </body>
                                        </html> 
```

**验证器说：** 第 3 行，第 1 列：没有文档类型声明；将在没有验证的情况下解析（**如果我放入这个文件，那么它会验证一大堆错误**）第 19 行，第 3 列：实例中不允许“DOCTYPE”声明第 20 行，第 6 列：文档类型不允许元素“HTML “ 这里

但问题是我没有使用任何像 fx 这样的 html 标签。在这些文件中，我只是让 php 文件为我生成它。

**我的 index.php 看起来像这样：**

```
<?php

include "magic-1.4.php";    
include "background.php";   

$page = new Page(); 
$title = "Cupcake Lovers"; 
$href = "styles.css";
$page->title($title)->css($href); 
$wrapper = html("div")->id("mainWrapper"); 
$content = html("div")->id("allContent");   

$content->append(file_get_contents("views/nav.php"));   

$section = new HtmlElm("section");

$request = new Controller(); 
if($request->has("page")){
    $requestedPage = $request->get("page"); 
}
else{
    $requestedPage = 'home'; 
}

if($requestedPage=="home"){
    $content->append(file_get_contents("views/home.php"));
}   

$wrapper->append($content); 
$page->body($wrapper);

//convert the page object to HTML and echo it to browser echo
$page->asHTML(); 
```

所以我的问题是，我做错了什么，因为 php 生成了 3 个 html 页面，然后它验证真的错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:57:04.250

需要成为浏览器首先看到的`<!DOCTYPE html>`东西，所以它需要先于其他一切。`<div id="mainWrapperbackground">`需要进入`<body>`. 在此之后，您需要一一检查验证器显示的错误。

# gwt - 如何在 RestyGWT 中序列化地图

> ID：13480932
> 
> 赞同：1
> 
> 时间：2012-11-20T19:47:24.123
> 
> 标签：gwt, resty-gwt

我想`Map<String,Object>`使用 RestyGWT 向服务器发送一个。但是，当我在请求中序列化地图时，它会在字符串键周围添加额外的引号转义。

所以，

```
map.put("hello",123);
service.sendRequest(map,callback); 
```

导致 JSON 被发送

```
{"\"hello\"":123} 
```

而不是想要的结果

```
{"hello":123} 
```

这是 RestyGWT 接口：

```
@POST
@Path("/data")
public void setRequest(Map<String, Object> map, JsonCallback callback); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:07:15.537

这种行为是一个错误。它已在最新的源代码版本中修复，因此从 v1.4 开始应该不会出现此问题。

# javascript - 如何使用 jQuery 插入列表中的特定位置？

> ID：13480937
> 
> 赞同：1
> 
> 时间：2012-11-20T19:47:44.073
> 
> 标签：javascript, jquery

我有一个包含 div 的表单域 div 列表。

```
<div id="container">
    <div class="form-field">    
        // Data
    </div>
    <div class="form-field"> // selected item   
        // Data
    </div>
    <div class="form-field">    
        // Data
    </div>
</div> 
```

我有一个选定的项目 var，其中包含我们正在使用的项目。例如，选择了第二个表单域 div。如何在所选项目之后附加另一个元素？另一个表单域 div 需要添加到列表中的第三个位置。该列表将是动态的，因此它的去向将始终取决于所选项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:49:52.827

[jsFiddle 演示](http://jsfiddle.net/BDBa4/)

与选择器`.after()`结合使用`:eq()`

```
$('.form-field:eq(1)').after('<h2>Your New Html After it</h2>'); 
```

您可能希望使其动态化，并使其`1`成为一个变量，以便您可以将它放在您想要的任何表单字段之后。这将使它在您想要的第二个 div 之后出现。注意 :eq() 是基于 0 索引的。

# python - 多标签分类器中的拟合概率

> ID：13480941
> 
> 赞同：1
> 
> 时间：2012-11-20T19:48:12.563
> 
> 标签：python, classification, scikit-learn

我想使用 scikit-learn 将其分类为多个类别，如此处所述[使用 scikit-learn 分类为多个类别](https://stackoverflow.com/questions/10526579/use-scikit-learn-to-classify-into-multiple-categories)，但我不想返回分类器计算的标签，而是返回成员的概率。scikit-learn 可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T19:14:45.273

事实上，OneVsRestClassifier 还没有实现 predict_proba。请提交错误报告或向我们发送请求请求（只需在 n_classes 基础估计器上调用 predict_proba 并将结果提供给 n_samples * n_classes 矩阵即可）。

# ruby - Ruby readpartial 和 read_nonblock 不抛出 EOFError

> ID：13480942
> 
> 赞同：12
> 
> 时间：2012-11-20T19:48:20.283
> 
> 标签：ruby, unix, nonblocking, unicorn, preforking

我试图理解并重新创建一个简单的预分叉服务器，就像独角兽一样，服务器在启动时分叉 4 个进程，这些进程都在控制套接字上等待（接受）。

控制套接字`@control_socket`绑定到 9799 并产生 4 个等待接受连接的工作人员。每个工人所做的工作如下

```
def spawn_child
  fork do
    $STDOUT.puts "Forking child #{Process.pid}"
    loop do 
      @client = @control_socket.accept                                        
      loop do                     
        request = gets              

        if request                          
            respond(@inner_app.call(request))                           
        else
            $STDOUT.puts("No Request")
            @client.close                           
        end
      end
    end
  end
end 
```

我使用了一个非常简单的机架应用程序，它只返回一个状态码为 200 的字符串和一个 text/html 的 Content-Type。

我面临的问题是，当我使用 a而不是or之类的东西读取传入请求（通过点击“ [http://localhost:9799](http://localhost:9799) ”处的 url）时，我的服务器正常工作。当我使用非阻塞读取时，它似乎永远不会抛出 EOFError，根据我的理解，这意味着它没有接收到状态。`gets``read``read_partial``read_nonblock``EOF`

这会导致读取`loop`无法完成。这是完成这项工作的代码片段。

```
# Reads a file using IO.read_nonblock
# Returns end of file when using get but doesn't seem to return 
# while using read_nonblock or readpartial
        # The fact that the method is named gets is just bad naming, please ignore
def gets
  buffer = ""         
  i =0
  loop do
    puts "loop #{i}"
    i += 1
    begin
      buffer << @client.read_nonblock(READ_CHUNK)
      puts "buffer is #{buffer}"
    rescue  Errno::EAGAIN => e
      puts "#{e.message}"
      puts "#{e.backtrace}"
      IO.select([@client])
      retry
    rescue EOFError
      $STDOUT.puts "-" * 50
      puts "request data is #{buffer}"    
      $STDOUT.puts "-" * 50
      break           
    end
  end
  puts "returning buffer"
  buffer
end 
```

但是，如果我使用简单的`gets`而不是，`read`或者`read_nonblock`如果`IO.select([@client])`用`break`.

这是代码工作并返回响应的时间。我打算使用 read_nonblock 的原因是 unicorn 使用了一个等效的实现 non_blocking 读取的[kgio库。](http://bogomips.org/kgio.git/tree/ext/kgio/read_write.c)

```
def gets
  @client.gets
end 
```

接下来粘贴整个代码。

```
module Server   
  class Prefork
    # line break 
    CRLF  = "\r\n"
    # number of workers process to fork
    CONCURRENCY = 4
    # size of each non_blocking read
    READ_CHUNK = 1024

    $STDOUT = STDOUT
    $STDOUT.sync

    # creates a control socket which listens to port 9799
    def initialize(port = 21)
      @control_socket = TCPServer.new(9799)
      puts "Starting server..."
      trap(:INT) {
        exit
      }
    end

    # Reads a file using IO.read_nonblock
    # Returns end of file when using get but doesn't seem to return 
    # while using read_nonblock or readpartial
    def gets
      buffer = ""         
      i =0
      loop do
        puts "loop #{i}"
        i += 1
        begin
          buffer << @client.read_nonblock(READ_CHUNK)
          puts "buffer is #{buffer}"
        rescue  Errno::EAGAIN => e
          puts "#{e.message}"
          puts "#{e.backtrace}"
          IO.select([@client])
                              retry
        rescue EOFError
          $STDOUT.puts "-" * 50
          puts "request data is #{buffer}"    
          $STDOUT.puts "-" * 50
          break           
        end
      end
      puts "returning buffer"
      buffer
    end

    # responds with the data and closes the connection
    def respond(data)
      puts "request 2 Data is #{data.inspect}"
      status, headers, body = data
      puts "message is #{body}"
      buffer = "HTTP/1.1 #{status}\r\n" \
               "Date: #{Time.now.utc}\r\n" \
               "Status: #{status}\r\n" \
               "Connection: close\r\n"            
      headers.each {|key, value| buffer << "#{key}: #{value}\r\n"}          
      @client.write(buffer << CRLF)
      body.each {|chunk| @client.write(chunk)}            
    ensure 
      $STDOUT.puts "*" * 50
      $STDOUT.puts "Closing..."
      @client.respond_to?(:close) and @client.close
    end

    # The main method which triggers the creation of workers processes
    # The workers processes all wait to accept the socket on the same
    # control socket allowing the kernel to do the load balancing.
    # 
    # Working with a dummy rack app which returns a simple text message
    # hence the config.ru file read.
    def run         
      # copied from unicorn-4.2.1
      # refer unicorn.rb and lib/unicorn/http_server.rb           
      raw_data = File.read("config.ru")           
      app = "::Rack::Builder.new {\n#{raw_data}\n}.to_app"
      @inner_app = eval(app, TOPLEVEL_BINDING)
      child_pids = []
      CONCURRENCY.times do
        child_pids << spawn_child
      end

      trap(:INT) {
        child_pids.each do |cpid|
          begin 
            Process.kill(:INT, cpid)
          rescue Errno::ESRCH
          end
        end

        exit
      }

      loop do
        pid = Process.wait
        puts "Process quit unexpectedly #{pid}"
        child_pids.delete(pid)
        child_pids << spawn_child
      end
    end

    # This is where the real work is done.
    def spawn_child
      fork do
        $STDOUT.puts "Forking child #{Process.pid}"
        loop do 
          @client = @control_socket.accept                                        
          loop do                     
            request = gets              

            if request                          
              respond(@inner_app.call(request))                           
            else
              $STDOUT.puts("No Request")
              @client.close                           
            end
          end
        end
      end
    end
  end
end

p = Server::Prefork.new(9799)
p.run 
```

有人可以向我解释为什么“read_partial”或“read_nonblock”或“read”读取失败。我真的很感激这方面的一些帮助。

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-27T15:07:43.520

首先我想讲一些基础知识，EOF 表示文件结束，就像当数据源中没有更多数据可以读取时，信号会发送给调用者，例如，打开一个文件，读取整个文件后会收到一个EOF，或者只是简单地关闭 io 流。

那么这4种方法有几个区别

*   `gets`从流中读取一行，在ruby中它`$/`用作默认的行分隔符，但是你可以传递一个参数作为行分隔符，因为如果客户端和服务器不是同一个操作系统，行分隔符可能不同，这是一个**块**方法，如果从未遇到行分隔符或 EOF，它将阻塞，并在收到 EOF 时返回 nil，因此**`gets`永远不会遇到`EOFError`**.

*   `read(length)`从流中读取length字节，是一个**block**方法，如果省略length则阻塞直到读到EOF，如果有length则只返回一次读到一定数量的数据或者遇到EOF，接收到一个返回空字符串EOF，所以**`read`永远不会遇到`EOFError`**.

*   `readpartial(maxlen)`从流中读取最多 maxlen 个字节，它会读取可用数据并立即返回，有点像急切版本的`read`，如果数据太大可以使用`readpartial`代替`read`防止阻塞，但它仍然是一个**阻塞**方法，它阻塞如果没有立即可用的数据，**`readpartial`将引发`EOFError`if 收到 EOF**。

*   `read_nonblock(maxlen)`有点像`readpartial`，但就像名字说的那样它是一个**非阻塞**方法，即使没有可用的数据它也会`Errno::EAGAIN`立即引发它意味着现在没有数据，你应该关心这个错误，通常在`Errno::EAGAIN`救援子句中应该`IO.select([conn])`首先调用更少不必要的循环，它会阻塞直到 conn 变得可读取，然后`retry`,**`read_nonblock`将引发一个`EOFError`if 接收到 EOF**。

现在让我们看看您的示例，因为我看到您正在做的是首先尝试通过“点击 url”来读取数据，这只是一个 HTTP GET 请求，一些文本，如“GET / HTTP/1.1\r\n”，连接是默认情况下在 HTTP/1.1 中保持活动状态，因此使用`readpartial`or`read_nonblock`将永远不会收到 EOF，除非`Connection: close`在您的请求中放入标头，或者更改您的获取方法，如下所示：

```
buffer = ""
if m = @client.gets
  buffer << m
  break if m.strip == ""
else
  break
end
buffer 
```

这里不能使用`read`，因为你不知道请求包的确切长度，使用大长度或者只是简单地省略会导致阻塞。

# r - 为什么共识树上没有分支长度？

> ID：13480948
> 
> 赞同：1
> 
> 时间：2012-11-20T19:48:38.487
> 
> 标签：r, phylogeny, r-ape

使用`ape::consensus`分支长度制作共识树时会丢失。有没有办法不丢失分支长度？或者在制作完成后以某种方式将它们添加到共识树中。

```
library(ape)

> cat("owls(((Strix_aluco:4.2,Asio_otus:4.1):4.1,Athene_noctua:7.3):6.3,Tyto_alba:13.5);",     file = "ex1.tre", sep = "\n")
> cat("owls(((Strix_aluco:1.2,Asio_otus:4.5):3.1,Athene_noctua:7.3):6.3,Tyto_alba:13.5);",     file = "ex2.tre", sep = "\n")
> cat("owls(((Strix_aluco:3.2,Asio_otus:4.7):8.1,Athene_noctua:7.3):6.3,Tyto_alba:13.5);",     file = "ex3.tre", sep = "\n")
> tree1 <- read.tree("ex1.tre")
> tree2 <- read.tree("ex2.tre")
> tree3 <- read.tree("ex3.tre")
> trees <- c(tree1, tree2, tree3)
> trees_con <- consensus(trees)
> trees_con

Phylogenetic tree with 4 tips and 3 internal nodes.

Tip labels:
[1] "Strix_aluco"   "Asio_otus"     "Athene_noctua" "Tyto_alba"    

Rooted; no branch lengths. 
```

# ruby - 生产（Heroku）上的错误请求/错误 URI 但不是本地

> ID：13480949
> 
> 赞同：0
> 
> 时间：2012-11-20T19:48:39.477
> 
> 标签：ruby, http, heroku, sinatra, haml

让我先说这个应用程序的大部分内容是一个巨大的黑客，在压力下在短时间内组合在一起，所以我可能有更深层次的问题。这个问题可能会有一些错误的代码。

我已经构建了一个 Sinatra 应用程序来处理内部采购和销售订单的一些任务。其中一部分是将一些参数发送到应用程序中的一个路由，然后将这些参数推送到一个对它们执行有用操作的 API。

现在，我正在从 HAML 中一个非常丑陋的循环中生成带有参数的链接：

```
 %td
          - opts = JSON.generate({ "key" => d[d.keys.first]["key"], "sa_id" => d.keys.first, "site" => d[d.keys.first]["site"], "name" => d[d.keys.first]["name"], "recipient" => d[d.keys.first]["email"], "items" => d[d.keys.first]["descriptions"], "date" => d[d.keys.first]["ship_date"]})

          -if (d[d.keys.first]["email"]) && (d[d.keys.first]["site"] != "")
            %a{:href => "/notify?options=#{opts}", :title => "Deliver"} Deliver
          -else
            Deliver
          %a{:href => "/destroy?key=#{d.keys.first}", :title => "Destroy"} Destroy 
```

在本地单击“交付”链接 ( `%a{:href => "/notify?options=#{opts}", :title => "Deliver"} Deliver`) 时，一切都按预期运行。我的`/notify`路由被调用，它将参数传递给所需的 API，一切都是彩虹和独角兽。当我在 Heroku 上单击相同的链接时，它会抛出一个“Bad Request”，说明“Bad URI”。生成的两个 URL 之间的*唯一*区别是主机名（localhost:3000 与 myapp.herokuapp.com），vimdiff 证实了这一点。

其他一切都是平等的，当我的本地实例（Thin）似乎不在乎时，为什么 Heroku（使用 Webrick）会回退我的 URI？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:09:01.893

在 Heroku 上从 Webrick 切换到 Thin 解决了这个问题，但我不确定具体*原因*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T10:35:22.653

我们遇到了一些问题，即看似相同的开发和生产环境在部署到 heroku 后表现不同。我喜欢做的快速健全性检查是在部署过程完成后将本地 gemfile.lock 与 heroku 上的进行比较。我知道 - 我们应该更严格地锁定我们的 gem 版本，我们会这样做，所以不要认为这是一个最佳实践 - 但它发现了一些难以追踪的问题，其中一些与我们有一些开发人员的事实有关在 Windows 和 Mac 上，gemfile.lock 通常有 Windows 特定的 gem，这会导致 heroku 出现问题。只是需要考虑的事情。

# django - MultiTableInheritance 的 Django ModelForm

> ID：13480951
> 
> 赞同：1
> 
> 时间：2012-11-20T19:48:48.937
> 
> 标签：django, inheritance, modelform

所以我有一个使用多表继承的模型层次结构，我想知道是否有某种 ModelForm 或类似的方法来创建像普通模型表单这样的对象，并让用户选择他们想要在形成一个选择字段。

层次结构如下：

```
class Base(models.Model):
    field1 = models.CharField(max_length=10)
    field2 = models.CharField(max_length=20)
class A(Base):
    pass
class B(Base):
    pass
class C(Base):
    pass 
```

我不能使用 Meta 抽象模型，因为我有一个类需要 Base 的外键，这就是我使用多表继承的原因，并且将来子类可能有额外的字段。你对我如何去做这件事有什么建议吗？

目前我这样做的方式是使用普通表单并在该表单中拥有所有公共字段以及一个选择字段，他们可以选择他们想要使用的模型类型，然后我创建了一个保存方法它从选择字段解释类型并创建该类型的对象。我不禁觉得有更好的方法来做到这一点。

# python - 使用 Python 的夹具模块生成夹具数据

> ID：13480955
> 
> 赞同：6
> 
> 时间：2012-11-20T19:48:53.497
> 
> 标签：python, sqlalchemy, flask, nose

我是第一次使用fixture 模块，试图获得一组更好的fixture 数据，这样我就可以使我们的功能测试更加完整。

我发现夹具模块有点笨拙，我希望有更好的方法来做我正在做的事情。这是 Python 2.7 中的 Flask/SQLAlchemy 应用程序，我们使用鼻子作为测试运行程序。

所以我有一组员工。员工有角色。有一些页面具有相当复杂的权限，我想确保对这些页面进行测试。

我创建了一个具有每种类型角色的数据集（我们的应用程序中大约有 15 个角色）：

```
class EmployeeData(DataSet):

  class Meta:
    storable = Employee

  class engineer:
    username = "engineer"
    role = ROLE_ENGINEER

  class manager:
    username = "manager"
    role = ROLE_MANAGER

  class admin:
    username = "admin"
    role = ROLE_ADMIN 
```

我想做的是编写一个功能测试来检查只有合适的人可以访问一个页面。（实际的权限要复杂得多，我只是想要一个玩具示例向您展示。）

像这样的东西：

```
def test_only_admin_can_see_this_page():

  for employee in Employee.query.all():
    login(employee)

    with self.app.test_request_context('/'):
    response = self.test_client.get(ADMIN_PAGE)
    if employee.role == ROLE_ADMIN
      eq_(200, response.status_code)
    else:
      eq_(401, response.status_code)

    logout(employee) 
```

有没有办法生成夹具数据，这样我的开发人员就不必记住每次添加角色时都在夹具上添加一行？我们有所有角色的规范列表作为应用程序其他地方的配置，所以我有。

我不喜欢任何这个或夹具模块，所以我很高兴听到建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-05-18T08:44:00.593

一个选项是使用[factory_boy](https://github.com/FactoryBoy/factory_boy)创建您的测试数据。

*   假设您保留并相应地更新一个角色列表（稍后将使用），如下所示：

    ```
    roles = [ROLE_ENGINEER, ROLE_ADMIN, ROLE_MANAGER, ...] 
    ```

*   让我们为表创建一个工厂`Employee`：

    ```
    import factory
    from somewhere.in.the.app import roles

    class EmployeeFactory(factory.alchemy.SQLAlchemyModelFactory):
        class Meta:
            model = Employee
            sqlalchemy_session = session

        username = factory.Sequence(lambda n: u'User %d' % n)
        # Other attributes
        ...
        # Now the role choice
        role = factory.fuzzy.FuzzyChoice(roles) 
    ```

    该[`FuzzyChoice`](https://factoryboy.readthedocs.io/en/latest/fuzzy.html#fuzzychoice)方法采用一个选择列表并从该列表中进行随机选择。
    现在这将能够`Employee`按需创建任意数量的对象。

*   使用工厂：

    ```
    from factory.location import EmployeeFactory

    def test_only_admin_can_see_this_page():
        EmployeeFactory.create_batch(size=100)

        for employee in session.query(Employee).all():
            login(employee)

            with self.app.test_request_context('/'):
            response = self.test_client.get(ADMIN_PAGE)
            if employee.role == ROLE_ADMIN
                eq_(200, response.status_code)
            else:
                eq_(401, response.status_code)

            logout(employee) 
    ```

    **分解：**

    *   `EmployeeFactory.create_batch(size=100)``Employee`在测试会话中创建 100 个对象。
    *   我们可以从工厂访问这些对象`session`。

* * *

有关在 SQLAlchemy 中使用 factory_boy 的更多信息：[https](https://factoryboy.readthedocs.io/en/latest/orms.html?highlight=sqlalchemy#sqlalchemy) ://factoryboy.readthedocs.io/en/latest/orms.html?highlight=sqlalchemy#sqlalchemy 。
尤其要小心会话管理：[https ://factoryboy.readthedocs.io/en/latest/orms.html?highlight=sqlalchemy#managing-sessions](https://factoryboy.readthedocs.io/en/latest/orms.html?highlight=sqlalchemy#managing-sessions)

# javascript - 可折叠的菜单变化

> ID：13480956
> 
> 赞同：0
> 
> 时间：2012-11-20T19:49:12.063
> 
> 标签：javascript, jquery, html, css, menu

对于此页面中的此可折叠菜单：http: [//2ddige.com/temps/Services/proteomics%202d_dige_copy%281%29.html](http://2ddige.com/temps/Services/proteomics%202d_dige_copy%281%29.html)

需要在代码中进行哪些更改，以便仅扩展“基于凝胶的蛋白质组学”部分而折叠其他 3 个类别？Javascript：

```
// Appear/Disappear
            $('#menu4 > li > a.expanded + ul').show();
            $('#menu4 > li > a').click(function() {
                $(this).toggleClass('expanded').toggleClass('collapsed').parent().find('> ul').toggle();
            });
            $('#example4 .expand_all').click(function() {
                $('#menu4 > li > a.collapsed').addClass('expanded').removeClass('collapsed').parent().find('> ul').show();
            });
            $('#example4 .collapse_all').click(function() {
                $('#menu4 > li > a.expanded').addClass('collapsed').removeClass('expanded').parent().find('> ul').hide();
            }); 
```

HTML：展开状态由名为“expanded”的类控制

CSS: .leftmenu a.expanded { background: url('../Images/collapse8.png') no-repeat 50%; 行高：35px；颜色：#333333；字体大小：11px；宽度：243px；左边距：30px；

```
 }
    .leftmenu a.collapsed {
        background: url('../Images/expand8.png') no-repeat 50%;
        line-height: 35px;
        color: #333333;
        font-size: 11px;
        width: 243px; 
        padding-left:30px;
} 
```

我尝试将类更改为“折叠”，但它所做的只是改变了背景图像并且块仍然展开。

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:38:44.340

如果您更改要关闭的菜单项的类，`collapsed`则可以在 javascript 中添加以下行以在加载时关闭菜单：

```
$('#menu4 > li > a.collapsed + ul').hide(); 
```

您的 javascript 现在应该如下所示：

```
// Appear/Disappear
$('#menu4 > li > a.expanded + ul').show();
$('#menu4 > li > a.collapsed + ul').hide();
$('#menu4 > li > a').click(function() {
    $(this).toggleClass('expanded').toggleClass('collapsed').parent().find('> ul').toggle();
});
$('#example4 .expand_all').click(function() {
    $('#menu4 > li > a.collapsed').addClass('expanded').removeClass('collapsed').parent().find('> ul').show();
});
$('#example4 .collapse_all').click(function() {
    $('#menu4 > li > a.expanded').addClass('collapsed').removeClass('expanded').parent().find('> ul').hide();
});​ 
```

# javascript - 将参数传递给 crm 2011 url

> ID：13480960
> 
> 赞同：-2
> 
> 时间：2012-11-20T19:49:14.933
> 
> 标签：javascript, silverlight, dynamics-crm-2011

我在我的 crm 2011 中安装了一个 silverlight 应用程序，我需要在我的应用程序中获取帐户 ID，因此我需要将一个 guid 帐户的值传递给 url。有什么建议么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T08:54:51.167

在不知道您想要做什么的任何细节的情况下，您最好查看一些示例。

谷歌一如既往地是你的朋友：

[http://blog.webmastersam.net/post/Easily-pass-parameters-to-Silverlight.aspx](http://blog.webmastersam.net/post/Easily-pass-parameters-to-Silverlight.aspx) http://msdn.microsoft.com/en-us/library/gg328358.aspx

# asp.net-mvc-3 - 何时使用 MVVM（即 Knockout.js）或仅从 Controller 操作返回 EditorTemplate 对象

> ID：13480961
> 
> 赞同：1
> 
> 时间：2012-11-20T19:49:18.213
> 
> 标签：asp.net-mvc-3, mvvm, knockout.js, mvc-editor-templates

在需要通过 ajax 将新项目添加到列表中的情况下，使用 Knockout 之类的最大好处是什么。

到目前为止，在我看来，我一直在做的是使用编辑器模板（带有关联的视图模型）来呈现项目列表。然后为了添加一个新项目，我向一个加载服务器端视图模型的操作发出请求，并返回一个刚刚附加到列表的 EditorTemplte 对象。像这样：

```
return Json(new { this.RenderPartialViewToString("MyEditorTemplate", model) }); 
```

淘汰的做事方式需要实现另一个视图模型来显示项目，然后另一个模板来显示它。但是这样做需要重复代码，因为视图模型必须在两个地方表示：在 cserver 端代码中，然后是淘汰视图模型的视图。这不是坏习惯吗？

我是否遗漏了什么，或者了解淘汰赛和 MVVM 的目的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:34:36.653

您将从 Knockout 中看到的最大好处是，您*无需*访问服务器即可将新项目添加到列表中 - 一切都发生在客户端。这有很多好处，包括：

*   您可以减少服务器上的负载。
*   您可以改善最终用户的体验。
*   您可以使用您的模型使页面上的多个元素保持最新，而无需任何服务器交互。

在这些 Knockout 教程中可以找到两个很好的例子：

*   [使用列表和集合](http://learn.knockoutjs.com/#/?tutorial=collections)
*   [加载和保存数据](http://learn.knockoutjs.com/#/?tutorial=loadingsaving)

至于复制代码，如果您查看这两个教程，您会注意到您不需要复制代码。例如：

1.  创建一个视图以显示整个列表。
2.  要将新项目添加到列表中，请创建在向页面添加新项目时加载的局部视图 - 该局部视图绑定到 Knockout
3.  当您提交整个表单时，该列表中的所有内容都将被提交 - 包括您通过 Knockout 添加的那些项目。

您的 ViewModel 将特定于您的列表项（您不一定需要为所有内容创建完整的 ViewModel）。而且您的视图特定于单个列表项。

希望这很清楚。Knockout 非常简单，他们有一些很棒的文档和教程可以帮助您前进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T06:04:56.173

恕我直言，以下是将淘汰赛和 asp mvc 混合在一起的架构最干净的选项。

让您的 ASP.net 充当 Web 服务，并控制您的所有视图模板和逻辑。

否则，是的，当您需要更改模型时，可能会复制视图模型并且必须重构前端和后端代码。

# c# - 对一个对象多次调用 Dispose() 会导致崩溃吗？

> ID：13480965
> 
> 赞同：1
> 
> 时间：2012-11-20T19:49:21.467
> 
> 标签：c#, winforms, crash

我正在调查我的应用程序中的零星崩溃，但仍然不确定是什么原因造成的。当我想关闭包含 VB 6.0 或 VC 6.0 文本控件的 MDI 表单时，有时会发生这种情况——它作为互操作的 C# 包装器。在查看代码时，我注意到我有一些这样的代码：

```
 private void Dispose(bool disposing)
    {
        if (!this.disposed)
        {
            if (disposing) //Disposing of everything: managed and unmanaged resources.
            {
                moTextEditor.Dispose();  --here
                moTextEditor.Dispose();  --here
            }

            // Deal with our own & whatever other unmanaged resources (this used to be done in the finalizer, above)
            SetLockedFields(false);

            disposed = true;
        }
    } 
```

所以注意到*moTextEditor.Dispose();* 线路重复两次？你怎么看？这可能是问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T19:55:41.047

[Dispose](http://msdn.microsoft.com/en-us/library/system.idisposable.dispose.aspx)的[IDisposable 接口](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)文档特别指出：

> 如果多次调用对象的 Dispose 方法，则对象必须忽略第一次调用之后的所有调用。如果多次调用其 Dispose 方法，则该对象不得引发异常。当资源已被释放时，除 Dispose 之外的实例方法可能会引发 ObjectDisposedException。

如果对象`IDisposable` *正确*实施，这应该不是问题。

话虽如此，并非所有的实现都`IDisposable`遵循规则。我个人会说该对象有一个错误，如果`Dispose`多次调用有问题，应该予以纠正。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:54:10.807

重复处理看起来像一个错误，但通常不会导致任何问题。

如果实施得当，一个对象可以被多次处置而不会造成伤害。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T19:55:01.550

> 对一个对象多次调用 Dispose() 会导致崩溃吗？

是的。

> 对一个对象多次调用 Dispose() 是否总是会导致崩溃？

不。

基本上，它完全取决于实现。一个对象实现的事实`IDisposable`仅仅意味着它有一个`Dispose`方法。关于如何实施它有很多指导方针，但实际上没有绝对的规则。

所以现在我们问：

> 确保`Dispose`对我的`IDisposable`对象的多次调用不会引发异常、导致崩溃或以其他方式破坏内容是否被认为是一种好习惯？

是的。

> 每个人都真正遵循该准则吗？

不。

> 这实际上是我的问题吗？

*耸耸肩*很难说。我们不知道该对象具体是如何实现`Dispose`的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T20:08:13.970

BDotA,

通常它不会使您的应用程序崩溃，但您需要考虑 moTextEditor 的 Dispose() 方法在做什么。

# perl - postgresql 自动文档

> ID：13480967
> 
> 赞同：0
> 
> 时间：2012-11-20T19:49:28.243
> 
> 标签：perl, postgresql, dbi, dbd, er-diagrams

我想为我在 Postgresql 中创建的空间数据库生成一种 ER 图。由于我也是 Postgresql 的新手，我不太确定图表功能是否可以使用 PgAdmin 提供的功能来完成（不是指图形查询生成器）。但是，在我看来，没有。我读到有一个名为 postgresql_autodoc 的基于 perl 的工具，它可以通过 PostgreSQL 系统表运行并返回描述数据库的 HTML、Dot、Dia 和 DocBook XML。现在这不是我想要的，但它是我最接近的选择。所以我已经成功安装了用于 Perl 5.8 的 ActivePerl 5.8 和 DBD-Pg 2.10.0（DBD PG 是 PostgreSQL 数据库的 Perl DBI 驱动程序），并且我还下载了 postgresql_autodoc.pl 文件。我还添加了 Perl 的路径。但是当我尝试运行 postgresql_autodoc 时。**可能在 C:/Perl/bin/postgresql_autodoc.pl 第 1831 行的字符串中意外插入 @TEMPLATE。全局符号“@TEMPLATE”需要在 C:/Perl/bin/postgresql_autodoc.pl 第 1831 行显示包名。执行 C： /Perl/bin/postgresql_autodoc.pl 由于编译错误而中止。**

我尝试使用 notepad++ 查看 postgresql_autodoc.pl，但是我没有使用 perl 语言的经验，所以我无法弄清楚真正的问题是什么。我所能做的就是找到第 1831 行，但我不知道我应该怎么做才能解决这个问题。

postgresql_autodoc.pl 文件下载自：[http ://www.rbt.ca/autodoc/](http://www.rbt.ca/autodoc/)

如果有人可以在这里帮助我，我将不胜感激！

提前致谢

芭芭拉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:59:08.047

那个东西 ,`@@TEMPLATE-DIR@@`是一个字符串，当你构建和安装模块时会被替换——这意味着你不应该直接从解压缩的存档中运行它。

大多数 Perl 模块都通过或多或少简单的三步安装过程进行安装，例如`perl Makefile.PL ; make ; make install`. 但是，这个包略有不同，你似乎只需要`make install`.

请注意，我没有使用 ActiveState 在 Windows 上安装 Perl 模块的经验。所以上述可能不起作用（例如，如果没有`make`通常不属于 Perl 的实用程序——尽管它可能是 ActiveState Perl 发行版的一部分）。

但是有一个解决方法。您可以简单地执行安装脚本所做的事情并`@@TEMPLATE-DIR@@`自己替换字符串。可以使用任何文本编辑器轻松完成，只需将出现的两次 替换为`@@TEMPLATE-DIR@@`脚本`postgresql_autodoc.pl`已解压缩到的路径——这意味着它是脚本将在其中查找`*.tmpl`文件的路径。

请注意，Windows 路径名在 Perl 中可以用正斜杠书写，意思`C:/Temp/postgresql_autodoc`应该没问题。

# c# - 使用 MVVM 以 1:1 将 WPF 中的 DataGrid 绑定到子导航属性 (EF)

> ID：13480968
> 
> 赞同：0
> 
> 时间：2012-11-20T19:49:33.603
> 
> 标签：c#, entity-framework, wpfdatagrid, one-to-one

使用 MVVM 以 1:1 将 WPF 中的 DataGrid 绑定到子导航属性 (EF)

全部，

使用 .Net 4 和 EF 4.4（数据库优先）

我有一个 ViewModel，其中包含对 EntityCollection“Entity1”的引用。

该实体与 Entity2 具有 1:1 的关系。

我的问题是，虽然我可以绑定到具有 1:many 或 many:many 关系的其他实体，但我似乎无法绑定到 Entity1.Entity2。我的猜测是这是因为 Entity2 不是一个集合，所以 WPF 不太确定如何处理它。

因此，除了将 ObservableCollection 添加到我的 Entity1 类（仅包含 Entity2 的 1 个实例，是 1:1 关系）并绑定到此之外，我想知道是否有更好的方法来实现我拥有 Entity1 的目标.Entity2 显示在 DataGrid 中（无需重新设计我的数据库或创建最终仅包含 1 个对象的不必要的集合）。

我已经尝试将 Entity1.Entity2 放在 CollectionViewSource 中，但这似乎没有任何帮助。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:53:48.450

为什么要为单个实体使用数据网格？我绝对不会在您的模型中粘贴 ObservableCollection 属性来涵盖这一点。

如果您想显示所有 entity1 的所有 entity2。您可以将数据网格的 ItemsSource 绑定到 entity1 的集合并深入了解 entity2 的属性。

另一种选择是构建一个自定义表单来呈现 entity2 数据。

**尝试 1**

~~您绝对可以从 Entity1 深入了解 Entity2 中的属性。尝试这个：~~

~~*   使用您要使用的 Entity1 的实例填充 ObservableCollection。*   将 DataGrid 上的 ItemsSource 设置为 ObservableCollection*   在 DataGrid 上将 AutoGenerateColumns 设置为 false*   将所需的列添加到数据网格中，将绑定路径设置为 Entity2.PropertyName~~
2.  ~~您可能必须为每个 Entity1 临时创建一个 Entity2 实例才能使其正常工作。~~

**尝试 2** 实体框架将允许从两个表构造单个实体。您可能需要考虑该实现。最大的问题是“如果 Table2 仅扩展 Table1，我是否真的关心 Table2 中是否有毫无价值的记录？”

**尝试 3** 不要直接使用 Entity1 和 Entity2，我认为您应该在您的域中引入一个新模型。拥有一个包含 Entity1 和 Entity2 属性的类可能是最好的选择。然后，当您准备好更新数据库时，您可以确定是否有 Entity2 的实例。

遵循 WPF 应用程序框架，您可能会遇到这样的情况：

```
//In your application layer

public class RecordsViewModel
{
    public ObservableCollection<Record> Records {get;set;}
}

//In your domain layer

public class Record
{
    //Properties from Entity1

    //Properties from Entity2
}

//In your Data Access Layer

public class Repository
{
    public IEnumerable<Record> GetRecords()
    {
        return db.Entity1.Include("Entity2")
                .Select(e => 
                    new Record() 
                        { 
                            //object initialization
                        });
    }

    public void Update(IEnumerable<Record> records)
    {
        var recordIds = records.Select(r => r.Id);

        var entities = db.Entity1.Include("Entity2").Where(e => recordIds.Contains(e.Id));

        foreach(var record in records)
        {
            var entity = entities.SingleOrDefault(e => e.Id == record.Id);

            if (entity == null)
            {
                entity = new Entity1();
                db.Entity1.Add(entity);
            }

            //update properties on Entity1

            //check if Entity2 should exist
            //If so, create/update entity2
            //If not, decide if you should delete entity2 or simply set Entity1.Entity2 to null
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:08:21.640

尝试 1：在创建实体类的 T4 模板中，将 NavigationProperty 更改为：

```
public string NavigationProperty(NavigationProperty navigationProperty)
{
    var endType = _typeMapper.GetTypeName(navigationProperty.ToEndMember.GetEntityType());

    return string.Format(
        CultureInfo.InvariantCulture,
        "{0}\n\n    {1}  {2}  {3}\n    {{\n      {4}get\n        {{\n           return _{3}; \n        }}\n        {5} set\n        {{\n          _{3}=value; OnSet{3}();\n        }}\n      }}\n\n    {6}",
        string.Format(CultureInfo.InvariantCulture, "{0} _{1};",_typeMapper.GetTypeName(navigationProperty.TypeUsage), _code.Escape(navigationProperty)),
        AccessibilityAndVirtual(Accessibility.ForProperty(navigationProperty)),
        navigationProperty.ToEndMember.RelationshipMultiplicity == RelationshipMultiplicity.Many ? ("ICollection<" + endType + ">") : endType,
        _code.Escape(navigationProperty),
        _code.SpaceAfter(Accessibility.ForGetter(navigationProperty)),
        _code.SpaceAfter(Accessibility.ForSetter(navigationProperty)),
        string.Format(CultureInfo.InvariantCulture, "partial void OnSet{0}();", _code.Escape(navigationProperty)));
} 
```

然后添加部分 Entity1 类：

```
Partial Class Entity1:EntityBase
{
    public SpecificObservableCollection<Entity2> Entity2_Observable
    {
        get;
        set;
    }

    partial void OnSetEntity2()
    {
        Misc_Observable.Add(Entity2);
    }
    public class SpecificObservableCollection<T> : ObservableCollection<T>
    {
        public Action<T> SetValue { get; set; }
        protected override void InsertItem(int index, T item)
        {
            if (item != null)
            {
                base.InsertItem(index, item);
            }
        }
        protected override void OnCollectionChanged(System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
        {
            base.OnCollectionChanged(e);
            if (this.Count>0)
                SetValue(this[0]);
        }
    }

    protected override void DoStuffOnAdd()
    {
            Entity2_Observable = new SpecificObservableCollection<Entity2>();
            Entity2_Observable.SetValue = a => _Entity2 = a;
    }
} 
```

然后在 EntityBase 中：

```
public abstract class EntityBase
{
    EntityBase()
    {
        DoStuffOnAdd();
    }
    protected virtual void DoStuffOnAdd() { }
} 
```

对于 IValueConverter（为了避免在 1:1 关系中添加太多记录）

```
public class CanAddValueConverter : IValueConverter
{
   private Type _T;
   private DataGrid _dg;

   public void SetValues(DataGrid dg, Type T)
   {
       _T = T;
       _dg = dg;
   }

   public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
   {
       System.Collections.IEnumerable dgIS = value as System.Collections.IEnumerable;
       if (_dg != null && dgIS == _dg.ItemsSource)
       {
           if (_dg.Items.Count > 0)
               return _dg.Items.Count <= System.Convert.ToInt32(parameter) && _dg.Items[_dg.Items.Count - 1].GetType() != _T;
           else
               return true;
       }
       else
           return false;
   }
} 
```

然后在 CodeBehind 中，将 DataGrid 分配给 IValueConverter 以及相应的实体类型。

# css - Twitter Bootstrap 对齐 Span 内容的首选方式

> ID：13480977
> 
> 赞同：4
> 
> 时间：2012-11-20T19:50:05.227
> 
> 标签：css, twitter-bootstrap, responsive-design

所以这对某些人来说似乎是一个显而易见的问题，但是在响应式网格中对齐通用跨度内容的最佳实践是什么？我知道你可以简单地设置一个像素高度，但这不会破坏保持响应的目的吗？

以下面的截图为例：

![变化的跨度内容](../Images/3e84ca898d186a024c974f83cbf8d608.png)

```
<div class="container">
    <div class="row">
       <div class="span3 well"><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec facilisis venenatis sollicitudin. Nam eros risus, lobortis a ultricies sed, interdum in mi. Donec elementum ullamcorper odio, vel gravida velit pretium quis. Donec sagittis, sem nec rhoncus tristique, dui ante volutpat nisl, sit amet feugiat velit lorem sagittis turpis. Quisque laoreet arcu et sapien volutpat nec porta augue iaculis. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean accumsan feugiat libero, vel fringilla neque euismod vitae. Nullam justo mi, faucibus sagittis pharetra non, egestas sit amet nulla.</p></div>
       <div class="span3 well"><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec facilisis venenatis sollicitudin. Nam eros risus, lobortis a ultricies sed, interdum in mi. Donec elementum ullamcorper odio, vel gravida velit pretium quis. Donec sagittis, sem nec rhoncus tristique, dui ante volutpat nisl, sit amet feugiat velit lorem sagittis turpis. Quisque laoreet arcu et sapien volutpat nec porta augue iaculis. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean accumsan feugiat libero, vel fringilla neque euismod vitae. Nullam justo mi, faucibus sagittis pharetra.</p> </div>
       <div class="span3 well"><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec facilisis venenatis sollicitudin. Nam eros risus, lobortis a ultricies sed, interdum in mi. Donec elementum ullamcorper odio, vel gravida velit pretium quis. Donec sagittis, sem nec rhoncus tristique, dui ante volutpat nisl, sit amet feugiat velit lorem sagittis turpis. Quisque laoreet arcu et sapien volutpat nec porta augue iaculis. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean accumsan feugiat libero.</p> </div>
    </div>    
</div> 
```

[您可以在此处](http://jsfiddle.net/wc4g9/1/)找到相关的 JSfiddle 。

*注意：由于某种原因，这个 JSFiddle 中的响应性似乎被破坏了，但是在我自己的 Twitter Bootstrap 应用程序中工作正常。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T20:25:09.113

如果您查看我工作的网站[DigitalLabs](http://digitallabs.mmu.ac.uk)，然后如果您查看配置文件，我会遇到类似的错误 - 我希望它们都具有相同的高度。

在这里查看我的 JSFiddle：http: [//jsfiddle.net/LDtRr/2/](http://jsfiddle.net/LDtRr/2/)

（向下滚动到底部并按调整大小以查看它们全部动态调整大小）

我使用了一些 javascript 来修复高度 - 我将向您展示我使用的代码。

```
function resize(resize, resizeinner) {
var max = 0;

//reset height back to 0
$(resize).each(function(index, element) {
    $(element).css({ 'height' : '0' });
});

//find height of the profiles
$(resizeinner).each(function(index, element) {
    var height = $(element).height();
    console.log('    height=' + height);
    if(height > max) {
        max = height;
    }

});

//set the height dynamically based on the maximum so they are all uniform
$(resize).each(function(index, element) {
    $(element).css({ 'height' : max });
    console.log('    resizedTo=' + $(element).height());
});

console.log('max - ' + max);
} 
```

然后对于我使用的 html

```
<div class="span4">
    <div class="well profile">
        <div class="profile-resize">
            <!-- content -->
        </div>
     </div>
 </div> 
```

代码的作用是获取配置文件类的 div 的最大高度，然后将该类的所有 div 设置为最大高度 - 您也可以将其绑定到窗口调整大小，以便它自动调整窗口的高度大小.

```
$(window).load(function() { 
//initially size the elements
resize('.profile', '.profile-resize');
}); 
```

也许不是最优雅的解决方案，但我当时想不出更好的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T23:39:25.497

尽管您的标记没有保持引导文档 ( `.container > .row > .span > .well`) 推荐的层次结构，但您是否考虑过绝对定位？不涉及 JS。

[演示（jsfiddle）](http://jsfiddle.net/Sherbrow/wc4g9/5/)

```
<div class="container" style="position: relative;">
    <div class="row faux-row">
        <div class="span3 well"></div>
        <div class="span3 well"></div>
        <div class="span3 well"></div>
    </div>
    <div class="row vrai-row">
        <div class="span3"><p>...</p></div>
        <div class="span3"><p>...</p></div>
        <div class="span3"><p>...</p></div>
    </div>
</div> 
```

```
.vrai-row { position: relative;z-index: 101; }

.faux-row { position: absolute;top: 0;left: 0;right: 0;bottom: 0;z-index: 100; }
.faux-row .well {
    height: 100%;
    /* The following is because .span* elements should not have paddings, margins nor borders see http://stackoverflow.com/a/11299934/1478467 */
    box-sizing: border-box;
} 
```

如果要设置填充、边距、边框（实际占用空间的样式），则应将其应用于真实的和*虚假*的 - 不是列本身，而是它们的子项。

缺点是（就像在演示中一样）您必须坚持使用非响应式网格（流体或静态）。但它应该与封装在媒体查询中的更多规则一起使用。

* * *

### 更新

`.well`如果您将课程保持在所有跨度上，那么响应性实际上并不难获得：

[演示响应（jsfiddle）](http://jsfiddle.net/Sherbrow/wc4g9/6/)

```
@media (max-width: 767px) {
    .faux-row { display: none!important; }
}
@media (min-width: 768px) {
    .vrai-row .well { /* Deactivate well styles */
      background-color: transparent;
      border-color: transparent;
      -webkit-box-shadow: none;
         -moz-box-shadow: none;
              box-shadow: none;
    }
} 
```

# c# - asp.net多文件上传控制

> ID：13480988
> 
> 赞同：1
> 
> 时间：2012-11-20T19:51:18.393
> 
> 标签：c#, asp.net

我`FileUpload`在模式弹出窗口上有两个控件。第一个文件上传控件工作正常，将文件保存到服务器。但是，第二个文件上传控件与第一个完全相同，但是当它上传文件时，它被上传为损坏的 0 字节。任何想法可能会发生什么？此外，我的更新面板上有一个触发器，它解决了在更新面板中设置上传控件的问题。

我的asp和c#很简单

```
<tr align="center">
 <td>Editable Doc</td>
  <td>
     <asp:FileUpload ID="uploadeditable" runat="server" />
  </td>
</tr> 
```

这是后面的代码

```
 upload.PostedFile.SaveAs(path + "\\" + file); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-06T19:14:01.070

与 UpdatePanel 控件不兼容的控件

以下 ASP.NET 控件与部分页面更新不兼容，因此在 UpdatePanel 控件中不受支持：

```
1\. TreeView and Menu controls.

2\. Web Parts controls. For more information, see ASP.NET Web Parts Controls.

3\. FileUpload controls when they are used to upload files as part of an asynchronous postback.

4\. GridView and DetailsView controls when their EnableSortingAndPagingCallbacks property is set to true. The default is false.

5\. Login, PasswordRecovery, ChangePassword, and CreateUserWizard controls whose contents have not been converted to editable templates.

6\. The Substitution control.

7\. Validation controls, which includes the BaseCompareValidator, BaseValidator, CompareValidator, CustomValidator, RangeValidator, RegularExpressionValidator, RequiredFieldValidator, and ValidationSummary control. 
```

对于您的类型信息，请检查 FileUpload1.hasfile 它在​​更新面板中使用时将始终返回 false。

# jsessionid - 链接输出因 JSESSIONID 冲突而失败

> ID：13480990
> 
> 赞同：1
> 
> 时间：2012-11-20T19:51:24.417
> 
> 标签：jsessionid

我的应用程序（例如 App2）在另一个应用程序（例如 App1）上的链接出现问题。

两者都是 Web 应用程序，因此两者都在那里创建自己的 JSESSION ID。链接输出在弹出窗口中打开并且单点登录工作（站点管理员传递 sm 用户 cookie），但是一旦我在链接的应用程序上执行任何事务，我就会被抛出，说明会话超时或无效。

我查看了浏览器上的 cookie，发现两个 JSESSION ID 都存在。唯一的区别在于两个 JSESSION ID 的域范围。App1 应用程序的域范围为 abc.com，而 App2 的域范围为 app2.abc.com

我尝试更改 App2 的 JSESSION ID cookie 的名称，但应用程序无法使用重命名的 JSESSION cookie。

关于如何解决这个问题的任何建议？

注意：App2 的环境是 was5

问候 AVN

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T21:19:39.430

您应该在 config.xml 中使用不同的 cookie 名称。更改任何一个应用程序以使用除 JSESSIONID 之外的不同 cookie 名称。类似于以下的东西。

```
War:
<?xml version="1.0" encoding="UTF-8"?>
<weblogic-web-app xmlns="http://www.bea.com/ns/weblogic/90">
    <session-descriptor>
        <cookie-name>APP1SESSIONID </cookie-name>
    </session-descriptor>
</weblogic-web-app>

Ear:
<?xml version="1.0" encoding="UTF-8"?>
<weblogic-application xmlns="http://www.bea.com/ns/weblogic/90">
    <session-descriptor>
        <cookie-name>APP1SESSIONID </cookie-name>
    </session-descriptor>
</weblogic-application> 
```

现在您将拥有两个 cookie，并且不会相互覆盖。

# php - 处理用户数据库名称和密码的最佳方式

> ID：13480994
> 
> 赞同：1
> 
> 时间：2012-11-20T19:51:38.187
> 
> 标签：php, mysql, security

> **可能重复：**
> [如何最好地存储用户信息和用户登录名和密码](https://stackoverflow.com/questions/947618/how-to-best-store-user-information-and-user-login-and-password)

在我们的应用程序中，我们有来自不同公司的用户。但是，所有用户都从同一页面登录。每个公司都有自己的数据库名称和密码。

当用户尝试登录时，我会检查他/她的用户名和密码（salted 和 sha-2 hashed）。如果他们被授权，我需要将他们连接到他们公司的数据库。

公司数据库名称和密码被编码并存储在表中，当用户每次需要访问公司数据库时，我应该检查和解码数据库名称和密码。有没有办法在配置文件或其他东西中定义公司数据库名称和密码（编码）？什么是安全、现代和专业的方法？

用户表

```
 Users    pass  firm_id
  user1    123     3
  user2    344     2
  user4    435     3
  user5    535     2 
```

坚固的桌子

```
 firm_id     firm         db_name    pass
    2        ACG co.       klf        123
    3        XYZ co.       tef        434 
```

# java - java生成嵌套报告的最有效方法？

> ID：13480995
> 
> 赞同：0
> 
> 时间：2012-11-20T19:51:38.980
> 
> 标签：java, sorting, reporting

我的列表包含具有以下字段的 House 对象：

```
private Integer address;
private String street;
private double price;
private int rooms; 
```

我想生成一份报告，列出房间数量，有多少房子有房间，然后列出这些房子。类似于下面。

# 两房的房子：3

-Mainstreet, 1112, $45,000.00

-Mainstreet, 1456, $42,200.00

-橡木, 54, 43,600.00

# 有 3 个房间的房子：1

-Mainstreet，1890 年，52,000.00 美元

我正在考虑一个带有房间/数量键对的哈希图，然后使用哈希图来构建一个数组，但必须有比运行一堆循环更容易的东西。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:56:43.773

这就是你需要的：

```
Map<Integer, List<House>> map = new HashMap<Integer, List<House>>(); 
```

然后遍历您的列表以构建地图。

```
for(House h: houses){
    List<House> l = map.get(h.rooms);
    if(l==null){ 
        l = new ArrayList<House>();
        map.put(h.rooms, l);
    }
    l.add(h);
} 
```

map.get(3) 将返回有 3 个房间的列表房屋；

然后你就完成了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T20:18:19.590

您可以编写一个自定义[比较器](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)来比较房间数量，然后将价格用作决胜局。像这样的东西

```
class HouseComparator implements Comparator<House>{
    public int compare(House a,House b){
        int value = Integer.compare(a.rooms, b.rooms);
        if (value == 0)
        {
             value = Double.compare(a.price, b.price);
        }
        return value;
    }
} 
```

您可以使用[Collections](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Collections.html#sort%28java.util.List,%20java.util.Comparator%29)类对列表进行排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T20:05:36.967

您正在寻找的数据结构是 MultiMap。[Guava](http://guava-libraries.googlecode.com/svn/tags/release03/javadoc/com/google/common/collect/Multimap.html) for java中有几种实现。它为您处理来自@Pawel Solarski 的内部列表。

这将整理您的所有数据以运行您的报告。

# python - 如何检查 PyQt4 中的单选按钮和选项列表

> ID：13480996
> 
> 赞同：0
> 
> 时间：2012-11-20T19:51:46.257
> 
> 标签：python, qt, pyqt4

在我的应用程序中，我必须使用 PyQt4，并且我希望能够检查单选按钮和选项列表。

当我想将参数传递给文本字段类型时，我这样做：

```
doc = QWebView.page().mainFrame().documentElement()
first_name = doc.findFirst("input[id=f_name]")
first_name.setAttribute("value", "John") 
```

但是如何设置单选按钮的值：

```
 <li id="signup-list-gender" class="gender" >
                    <span class="gender-label">     Gender:
<span class="formNote">(Optional)</span></span>
                    <label for="signup-gender-male"><input id="signup-gender-male" class="gender" tabindex="9" type="radio" name="gender" value="m" > Male</label>
                    <label for="signup-gender-female"><input id="signup-gender-female" class="gender" tabindex="10" type="radio" name="gender" value="f" > Female</label>
                </li>
                <li id="signup-list-birthdate" class="birthdate"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:42:35.513

您需要在单选按钮上设置属性“已检查”，如下所示（我没有测试此代码）：

```
doc = QWebView.page().mainFrame().documentElement()
male = doc.findFirst("input[id=signup-gender-male]")
male.setAttribute("checked", "true") 
```

对于单选按钮属性检查[here](http://www.echoecho.com/htmlforms10.htm)