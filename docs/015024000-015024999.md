# StackOverflow 问答 15024000-15024999

# java - 将父子映射存储在内存中。有效地为父母列出所有可到达的孩子

> ID：15024002
> 
> 赞同：6
> 
> 时间：2013-02-22T12:13:12.777
> 
> 标签：java, algorithm, data-structures, graph

我在理性数据库中有父子映射，如下所示，

```
relationship_id | parent_id | child_id
1               | 100009    | 600009
2               | 100009    | 600010
3               | 600010    | 100008 
```

为了性能优化，我喜欢将所有这些映射保存在内存中。在这里，一个孩子将有一个以上的父母，而一个父母有两个以上的孩子。我想，我应该使用“Graph”数据结构。

填充到内存中是一次性的活动。我担心的是，当我要求列出所有孩子（不仅仅是直系孩子）时，它应该尽快返回它们。添加和删​​除很少发生。我应该使用什么数据结构和算法？

尝试了[MultiHashMap](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/MultiHashMap.html)，以实现`O(1)`搜索时间，但它有更多的冗余。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T12:21:48.083

具有用于父子关系的图形数据结构。每个 GraphNode 只能有一个`ArrayList`子节点。

然后`HashMap`将 ID 映射到 GraphNode。

你需要弄清楚一些事情，这样你就不会创建一个会导致无限循环的循环（如果可能的话）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T12:24:12.677

您将需要一个自定义`Node`类和一个 hashmap 来存储节点引用以便于查找。

```
for each row in database
if parent node exists in map
  get it
else
  create it and add it

if child node exists in map
  get it
else
  create it and add it

set relationship between parent and child 
```

节点类看起来像；

```
public class Node {

  private int id;

  private List<Node> parents = new ArrayList<Node>();
  private List<Node> children = new ArrayList<Node>();

  //getters and setters

} 
```

# python - 在 unpickling 中有条件地使用 __setstate__

> ID：15024003
> 
> 赞同：0
> 
> 时间：2013-02-22T12:13:17.207
> 
> 标签：python, pickle

所以我有一个类可以根据 ID 记住它的实例。解开这样的对象时，我想处理两种情况：

1.  不存在具有该 ID 的其他实例，因此会生成一个新实例并`__setstate__`应正常调用。
2.  当该 ID 的另一个实例存在时，该对象被返回，我想避免调用`__setstate__`它。

请看一下[这个类的定义](https://github.com/Midnighter/unique-base/blob/master/base.py)。

您会注意到，目前我只更新评估为**`False`**作为解决方法的属性。

我可以想到两种通用策略来解决这个问题：

1.  与[前面的答案](https://stackoverflow.com/questions/5238252/unpickling-new-style-with-kwargs-not-possible)一样，我可以定义另一个使用结果调用的函数，`__getnewargs__`并附加一些属性来告诉我是否运行`__setstate__`。
2.  如果我能分辨出是否`__call__`从泡菜中调用了类的方法，我也可以这样做。

我不知道是否有可能进一步干扰酸洗机械，我不想将 unpickler 子类化。

想法，建议，完全不同的解决方案？谢谢你。

# android - 按钮在果冻豆的视图寻呼机中不可见

> ID：15024005
> 
> 赞同：0
> 
> 时间：2013-02-22T12:13:27.683
> 
> 标签：android, android-viewpager, android-4.2-jelly-bean

我正在制作一个应用程序，其中包含单击按钮日期选择器警报时的视图寻呼机，但此按钮在果冻豆中不可见，它在 android 4.0.3 和 4.0.4 版本中可见，但在 4.1 中不可见单击日期选择器弹出但按钮不可见的空白区域请告诉我如何使其可见

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:32:41.190

在某些摩托罗拉和三星智能手机中会发生这种情况，即使我也遇到过同样的问题，使用片段活动来解决问题，然后才能正常工作。

您的问题并不存在于所有 JellyBean 设备中，同一家公司的其他 Jelly Bean 设备有时可以正常工作..

# java - 在 Spring 中使用 Hibernate 的困难： 原因：org.hibernate.AnnotationException：使用@OneToMany 或@ManyToMany 针对未映射的类：

> ID：15024012
> 
> 赞同：0
> 
> 时间：2013-02-22T12:13:46.500
> 
> 标签：java, spring, hibernate, spring-mvc, orm

我是 Spring ORM 的新手，我正在尝试实现这个 Spring+Hibernate 教程：

[http://it4beginners.wordpress.com/2012/10/05/spring-3-and-hibernate-4-for-beginners/](http://it4beginners.wordpress.com/2012/10/05/spring-3-and-hibernate-4-for-beginners/)

唯一的区别是我没有使用**PostgreSQL**，但我使用的是**MySql**数据库，所以我在 pom.xml 文件中插入了正确的 MySql 连接器，并且我在**ApplicationContext.xml**配置文件中更改了 mainDataSource 属性...

问题是当我运行我的**App.java**类（包含 main 方法的主类）时，我在堆栈跟踪中获得以下错误消息：

```
Caused by: org.hibernate.AnnotationException: Use of @OneToMany or @ManyToMany targeting an unmapped class: org.andrea.myexample.myHibernateSpringExample.entityclasses.ChemicalStructure.occurence[java.lang.Object]
at org.hibernate.cfg.annotations.CollectionBinder.bindManyToManySecondPass(CollectionBinder.java:1057)
at org.hibernate.cfg.annotations.CollectionBinder.bindStarToManySecondPass(CollectionBinder.java:733)
at org.hibernate.cfg.annotations.CollectionBinder$1.secondPass(CollectionBinder.java:668)
at org.hibernate.cfg.CollectionSecondPass.doSecondPass(CollectionSecondPass.java:66)
at org.hibernate.cfg.Configuration.originalSecondPassCompile(Configuration.java:1597)
at org.hibernate.cfg.Configuration.secondPassCompile(Configuration.java:1355)
at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1737)
at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1788)
at org.springframework.orm.hibernate4.LocalSessionFactoryBuilder.buildSessionFactory(LocalSessionFactoryBuilder.java:242)
at org.springframework.orm.hibernate4.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:372)
at org.springframework.orm.hibernate4.LocalSessionFactoryBean.afterPropertiesSet(LocalSessionFactoryBean.java:357)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
... 12 more 
```

不明白问题出在哪里！！！

这是似乎存在问题的类的代码：

```
package org.andrea.myexample.myHibernateSpringExample.entityclasses;

import java.io.Serializable;
import java.util.Set;
import javax.persistence.CascadeType;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.FetchType;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.OneToMany;
import javax.persistence.SequenceGenerator;
import javax.persistence.Table;

@Entity
@Table(name = "chemical_structure")
public class ChemicalStructure implements Serializable {

private Long id;
private String structureKey;
private String structureData;
private Set<Object> occurence;

/**
 * @return the id
 */
@Id
@GeneratedValue(strategy = GenerationType.AUTO, generator = "chem_structure_seq_gen")
@SequenceGenerator(name = "chem_structure_seq_gen", sequenceName = "seq_chemical_structure")
@Column(name = "structure_id")
public Long getId() {
    return id;
}

/**
 * @param id
 *            the id to set
 */
public void setId(Long id) {
    this.id = id;
}

/**
 * @return the structureKey
 */
@Column(name = "structure_key", unique = true)
public String getStructureKey() {
    return structureKey;
}

/**
 * @param structureKey
 *            the structureKey to set
 */
public void setStructureKey(String structureKey) {
    this.structureKey = structureKey;
}

/**
 * @return the structureData
 */
@Column(name = "chemical_structure")
public String getStructureData() {
    return structureData;
}

/**
 * @param structureData
 *            the structureData to set
 */
public void setStructureData(String structureData) {
    this.structureData = structureData;
}

@OneToMany(fetch = FetchType.LAZY, mappedBy = "pk.chemicalStructure", cascade = CascadeType.ALL)
public Set<Object> getOccurence() {
    return occurence;
}

public void setOccurence(Set<Object> occurence) {
    this.occurence = occurence;
}
} 
```

你有什么想法吗？

肿瘤坏死因子

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T12:36:06.287

该错误的原因在于您尝试映射一组普通对象。Object 不是 JPA 实体，因此不能映射到关系类型。

您需要创建一个名为 Occurence 的实体，并按照您使用对象集的方式对其进行映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:45:30.367

我认为问题出在 mappedBy = "pk.chemicalStructure" 检查您是否在此类中有 ManyToOne 关系，例如：

```
@ManyToOne
@JoinColumn(name = "chemicalstructure_id", nullable = false)
@ForeignKey(name = "fk_chemicalstructure_id")
private Occurence occurence; 
```

然后 mappedBy = "发生"

该错误表明缺少这种双向关系。

# ruby-on-rails-3 - 在 Rails 3 中使用带有自定义 foreign_key 的 has_many 时出现未定义的方法错误

> ID：15024020
> 
> 赞同：1
> 
> 时间：2013-02-22T12:14:10.243
> 
> 标签：ruby-on-rails-3, activerecord, has-many

第一个模型：

```
class FaqGroup < ActiveRecord::Base
  has_many :faqs, :foreign_key => 'group_id', :order => 'position'

  acts_as_list
end 
```

第二种型号：

```
class Faq < ActiveRecord::Base
  belongs_to :faq_group, :foreign_key => 'group_id'

  acts_as_list :scope => :faq_group
end 
```

控制器：

```
def new_faq
  @group = FaqGroup.find(params[:id])

  @faq = @group.faqs.create(question: 'lorem', answer: 'ipsum') 
```

结尾

当我在浏览器中加载它时，我收到以下错误：

```
undefined method `faq_group_id' for #<Faq:0xb56fcde4> 
```

所以，基本上当我尝试创建一个新的关联对象时，foreign_key 就会被忽略。如果我放弃自定义 :foreign_key 一切都会很好。

另一个观察结果是，如果我这样做：

```
@group = FaqGroup.find(params[:id])
@faqs = @group.faqs 
```

它工作正常，所以它似乎只有在创建新的关联对象时才使用 foreign_key 问题。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:44:45.727

检查[belongs_to 与外键选项](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-belongs_to)的关联。

正如那里提到的，

对于`foreign key`在`belongs_to`-

"指定用于关联的外键。默认情况下，这被猜测为带有“_id”后缀的关联名称。因此，定义belongs_to:person关联的类将使用“person_id”作为默认:foreign_key。同样，belongs_to :favorite_person, :class_name => "Person" 将使用外键 "favorite_person_id"。"

因此，在上下文中，错误是因为您定义了：

```
class Faq < ActiveRecord::Base
  belongs_to :faq_group, :foreign_key => 'group_id' 
```

此关联需要`faq_group_id`作为外键而不是`group_id`.

错误也是如此 -

```
undefined method `faq_group_id' for #<Faq:0xb56fcde4> 
```

# asp.net-mvc - jQuery 在第一次尝试时在 IE9 中不起作用；按 F5 （刷新）它可以工作

> ID：15024022
> 
> 赞同：1
> 
> 时间：2013-02-22T12:14:10.703
> 
> 标签：asp.net-mvc, internet-explorer, jquery-mobile

（我已经问过这个问题；在这里我添加更多细节）

我返回了一个 jQuery，它返回在更改事件中输入元素中输入的文本。此 jQuery 在 FireFox 中运行良好，但在 Internet Explorer (IE9) 中失败。

```
 <script>
      $(document).ready(function () {
          $("#UserName").change(function () {
              alert("Text Entered Is :"+$("#UserName").val());
          });
      });
  </script> 
```

1）我正在使用 ASP.NET MVC；要到达具有上述 jquery 的页面，我正在使用 Html.ActionLink

2) 在 IE 上，当我到达上面 jQuery 的页面时，它不起作用；但是当我按 F5 并刷新页面时它可以工作。

3) 在 Firefox 上我不需要刷新页面；它在第一次尝试时起作用。

请帮忙...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:52:42.523

$(document).ready() 事件依赖于一个名为**DOMContentLoaded**的事件（在 Chrome 中，不太确定 firefox，但它以某种名称存在）。

一旦加载了 HTML 并引入了所有相关文件（CSS 和 JS 文件），就会触发此事件。Chrome、Safari ( **WebKit** ) 和 Firefox( **Gecko** ) 在触发此特定事件时非常可预测. 它像发条一样在堆栈中冒泡，一旦被抓住，你就可以摆弄它，因为任何人都在乎。

但是，就 IE 而言，直到第 7 版（我认为）他们从未实现过此事件。鉴于此，最近版本中的实现也不是那么有效。

我一次又一次地面临这个问题。

一种每次都有效的解决方法是在 HTML 末尾手动触发事件：

```
<script type="text/javascript">
try{jQuery.ready();}catch(e){}
</script> 
```

希望这可以帮助

**编辑**
查看事件是否被触发的一个好方法是在代码中添加某种动作。就像是：

```
<script>
      $(document).ready(function () {
          alert("Loaded");
          $("#UserName").change(function () {
              alert("Text Entered Is :"+$("#UserName").val());
          });
      });
</script> 
```

**由于 Javascript 的单线程特性，**alert会阻止代码的执行。**因此，您可以使用它来获取代码的伪堆栈跟踪。**

# spring-mvc - 使用 Spring AOP 3.1.0 使用方法参数设置服务实例

> ID：15024032
> 
> 赞同：0
> 
> 时间：2013-02-22T12:14:34.477
> 
> 标签：spring-mvc, annotations, aspectj, spring-aop

嗨，我是 Annotation 和 Spring AOP 的新手。以下是我想要实现的目标

```
public interface Service {
    public void process(String ServiceName, Bean bean);
}

public class ServiceImpl1 implements Service{
    public void process(String ServiceName, Bean bean) {

        /// do something here    
    }
}

public class ServiceImpl2 implements Service{
    public void process(String ServiceName, Bean bean) {

        /// do something here
    }
} 
```

从其他班级我会打电话给类似的东西

```
...

public void doSomething(String serviceName, Bean bean){

    service.process("ServiceImpl1", bean); 

}
... 
```

我可以通过使用 AroundAdvice 和 Before 建议并拦截我的 doSomething 方法来实现相同的目的，然后在读取 serviceName 后实例化服务对象。

我有更好的方法吗？

我只需要一个方向，然后我会弄清楚。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:52:42.953

好吧，我猜你想要做的是有一个 Before 通知，它接受传入的服务名称，创建一个适当类的对象，然后在该新创建的对象上调用适当的方法。在我看来，您确实在寻找更多的工厂模式，但试图使用 AOP 来完成它。

如果您采用工厂模式，您将创建一个名为 ServiceFactory 的类，该类接受一些参数并为这些参数返回正确的服务实现。您调用代码只需使用工厂在运行时获取正确的服务。

另一种方法，如果你想坚持更多的 DI 模式，可能是创建一个用作“导体”的包装类。这可能具有服务名称到服务实现的映射。然后，您可以将此包装器注入到您的代码中，甚至可以将 Map 注入到包装器中。您的调用代码将调用包装器上的方法，这将找到正确的单例实现并聚合对它的调用。

我只是觉得为此使用AOP是自找麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:53:43.400

您可以使用 spring @Autowire 注释注入服务 impl 类。由于您有 2 个实现类，您可以使用限定符来指定需要注入的 impl。

# vim - 使用latex-suite的vim（gvim）启动非常慢

> ID：15024035
> 
> 赞同：1
> 
> 时间：2013-02-22T12:14:43.963
> 
> 标签：vim, latex, latex-suite

我在使用 tex 文件和 latex-suite 插件时遇到了一个非常缓慢的 gvim 启动。例如，打开[这个 tex 文件](https://bitbucket.org/andrenarchy/funcall/raw/25d83535b4839ae1598a620b4cb7315a467ccc4b/funcall.tex)需要 7 秒。一个最小的 .vimrc 文件只包含以下行：

```
filetype plugin on 
```

我的 .vim 文件夹仅包含[latex-suite 插件](http://vim-latex.sourceforge.net/index.php?subject=download&title=Download)（快照 2013-01-16）。我怀疑乳胶套件中的折叠功能，但我不确定如何正确追踪并修复它。我在 Ubuntu 12.10 上运行 gvim 7.3。

有谁知道如何解决这个缓慢的启动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T13:55:13.073

latex-suite seems to do some kind of package scanning which I disabled by setting

```
let g:Tex_PackagesMenu = 0 
```

in my .vimrc. This reduces the startup time to 3.5s (from 7s) and I think I can live with this ;).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:30:35.407

如果问题与文件类型有关（正如您已经确定的那样），当您`:edit`从正在运行的 Vim 中读取文件时，甚至当您通过`:e!`. 我会用它来调查根本原因。如果您怀疑折叠，`:setl foldmethod=manual`或者`:setl nofoldenable`将是第一次尝试。

由于您已经将问题隔离到插件，我建议将任何反馈和问题报告直接发送给其作者；即使您在这里得到了修复或解决方法，它仍然应该流回插件中。

# ios - 使用 UIAppearance 在更改后更新导航栏

> ID：15024037
> 
> 赞同：7
> 
> 时间：2013-02-22T12:14:46.230
> 
> 标签：ios, background, uinavigationbar, updates, uiappearance

我目前正在使用 UIAppearance 代理自定义我的 iOS 应用程序的导航栏背景图像。有一个用于在触发通知的两种不同模式之间切换的按钮。此通知将再次使用代理将背景更改为不同的图像。我的问题是，只有当我转到另一个控制器并返回它时，这种变化才会变得可见。我无法强制更新控制器内的导航栏。

我在我的 MainTabBarController 中试过这个：

```
- (void) onAppChangedMode: (NSNotification*)notif {

APP_MODE mode = (APP_MODE) [[notif object] integerValue];

// change navigation bar appearance
[[UILabel appearance] setHighlightedTextColor:[UIColor redColor]];
[[UINavigationBar appearance] setBackgroundImage:[UIImage imageNamed:(mode == 0 ? @"navbar.png" : @"navbar2.png")] forBarMetrics:UIBarMetricsDefault];
// trying to update
for (UIViewController* vc in self.viewControllers) {
     [vc.navigationController.navigationBar setNeedsDisplay];
}

} 
```

但什么都没有......它不起作用。知道如何实现吗？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-02-02T09:26:44.593

只需从窗口中删除视图并再次添加它们：

```
for (UIWindow *window in [UIApplication sharedApplication].windows) {
    for (UIView *view in window.subviews) {
        [view removeFromSuperview];
        [window addSubview:view];
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-27T07:25:34.717

我只是有同样的问题，这段代码会帮助你：

```
- (IBAction)btnTouched:(id)sender {
    [[UADSwitch appearance]setOnTintColor:[UIColor redColor]];

    // Present a temp UIViewController 
    UIViewController *vc = [[UIViewController alloc]init];
    [self presentViewController:vc animated:NO completion:nil];//"self" is an instance of UIViewController
    [vc dismissViewControllerAnimated:NO completion:nil];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T00:04:34.107

尝试使用此代码仅更改**当前导航栏**的背景图像：

```
[self.navigationController.navigationBar setBackgroundImage:image forBarMetrics:UIBarMetricsDefault]; 
```

更改 UIAppearance 后使用上述代码。这将强制更改当前控制器的导航栏。其他控制器的导航栏将由 UIAppearance 中的更改处理。

# c# - 限制查询以忽略元素后代

> ID：15024038
> 
> 赞同：1
> 
> 时间：2013-02-22T12:14:47.080
> 
> 标签：c#, linq, linq-to-xml

我正在尝试查询以下 XML 以构建一些对象，这些对象复制 XML 中概述的文件夹层次结构。

```
<ShareList>
    <Title>Documantis</Title>
    <Url>/sites/dev/Documantis/Forms/AllItems.aspx</Url>
    <Guid>fed8f456-efa9-4fe5-8b97-46734a3040b6</Guid>
    <HasUniqueScopes>False</HasUniqueScopes>
    <RootFolder>/sites/dev</RootFolder>
    <Children>
        <ShareListItem>
            <Title>First</Title>
            <Url>Documantis/First</Url>
            <HasUniqueRole>False</HasUniqueRole>
            <IsSubFolder>False</IsSubFolder>
            <PermissionMask>FullMask</PermissionMask>
            <Children>
                <ShareListItem>
                    <Title>Second</Title>
                    <Url>Documantis/First/Second</Url>
                    <HasUniqueRole>False</HasUniqueRole>
                    <IsSubFolder>False</IsSubFolder>
                    <ParentGuid>22b2a7e9-a42e-497f-aad3-8caa85f6ac6d</ParentGuid>
                </ShareListItem>
            </Children>
        </ShareListItem>
        <ShareListItem>
            <Title>Folda</Title>
            <Url>Documantis/Folda</Url>
            <HasUniqueRole>False</HasUniqueRole>
            <IsSubFolder>False</IsSubFolder>
            <PermissionMask>FullMask</PermissionMask>
        </ShareListItem>
    </Children>
</ShareList> 
```

我很难找到一种方法来一次返回一个级别的`<ShareListItem>`元素，使用我当前的代码它返回一个 List 中的所有 ShareListItems，它不能准确地表示层次结构。

```
XmlDocument doc = new XmlDocument();
doc.LoadXml(sharepointXml);

XElement root;
using (XmlReader xr = new XmlNodeReader(doc)) { root = XElement.Load(xr); }

var result = from child in root.DescendantsAndSelf("ShareList") //.Elements("ShareList") // Descendants("ShareList")
             select child;

foreach (XElement xml in result)
{
    // Build ListItem from results
    ShareList list = new ShareList()
    {
        Title = xml.Element("Title").Value,
        Url = xml.Element("Url").Value,
        Guid = xml.Element("Guid").Value,
        HasUniqueScopes = Convert.ToBoolean(xml.Element("HasUniqueScopes").Value),
        RootFolder = xml.Element("RootFolder").Value,
    };

    if (xml.Element("Children") != null)
    {
        var subResult = from child in xml.Element("Children").Descendants("ShareListItem")
                        select child;

        foreach (XElement subXml in subResult)
        {
            // results here are flat and don't show depth of nodes
        }
        //list.Children =
    } 
```

我可以从 URL 元素递归地推断层次结构的结构，但是我已经用 XML 表示它，所以我宁愿学习如何通过查询返回它。

**编辑：**

这是我最终使用的

```
public List<ShareList> HandleLists(XElement levelRoot)
{
    List<ShareList> lists = new List<ShareList>();

    var results = from list in levelRoot.DescendantsAndSelf("ShareList")
                 select list;

    foreach (var list in results)
    {
        var children = list.Element("Children");
        if (children == null)
            return null;

        ShareList shareList = new ShareList()
        {
            Title = list.Element("Title").Value,
            Url = list.Element("Url").Value,
            Guid = list.Element("Guid").Value,
            HasUniqueScopes = Convert.ToBoolean(list.Element("HasUniqueScopes").Value),
            RootFolder = list.Element("RootFolder").Value,
            // Recursively find ListItem folders
            Children = HandleSubfolders(list)
        };
        lists.Add(shareList);
    }
    return lists;
}

public List<ShareListItem> HandleSubfolders(XElement levelRoot)
{
    List<ShareListItem> subfolders = new List<ShareListItem>();

    // All nodes deeper than current
    var children = levelRoot.Element("Children");
    if (children == null)
        return null;

    // Subfolders
    var items = children.Elements("ShareListItem");
    foreach (var item in items)
    {
        ShareListItem listItem = new ShareListItem()
        {
            Title = item.Element("Title").Value,
            Url = item.Element("Url").Value,
            HasUniqueRole = Convert.ToBoolean(item.Element("HasUniqueRole").Value),
            IsSubfolder = Convert.ToBoolean(item.Element("IsSubFolder").Value),
            PermissionMask = item.Element("PermissionMask").Value,
            PermissionMaskName = item.Element("PermissionMaskName").Value,
            // Recursively find ListItem subfolders
            Children = HandleSubfolders(item)
        };
        // Add subfolder to Children collection
        subfolders.Add(listItem);
    }
    return subfolders;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:20:19.287

你会想在这里使用递归。

创建一个方法来处理层次结构的一个级别并在下一个级别调用自身。

```
public void HandleLevel(XElement levelRoot)
{
    PerformAction(levelRoot);

    var children = levelRoot.Element("Children");
    if(children == null)
        return;
    var items = children.Elements("ShareListItem");
    foreach(var item in item)
    {
        // Handle child's children:
        HandleLevel(item);
    }
} 
```

`PerformAction`是实际执行的代码，无论您想对每个文档执行什么操作。
代码当前的结构方式，这个动作也是针对根文档执行的`/sites/dev/Documantis/Forms/AllItems.aspx`。
如果您不希望这样做，只需`PerformAction`进入`foreach`循环并通过`item`而不是`levelRoot`.

顺便说一句：您对根元素的初始化*很*奇怪。
你可以简单地使用这个：

```
var root = XDocument.Parse(sharepointXml).Root; 
```

最初的调用`HandleLevel`看起来像这样：

```
HandleLevel(root); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T12:34:55.593

一种方法是创建类来表示层次结构，如下所示：

```
public class ShareList {
    ...
    public List<ShareList> Children { get; set; }
} 
```

在您的代码中，将遍历部分重构为接受 Sharelist 节点并遍历它的方法，为每个 Children 节点调用自身：

```
private Sharelist RecurseHierarchy(XElement sharelistNode, ShareList parent)
{
    // your traversing code goes here
    // get your data and create a new Sharelist object
    // if it has a children node, traverse it and call this same method on the child
    // Sharelist nodes
    parent.Title = sharelistNode.Element("Title").Value;        

    var children = sharelistNode.Element("Children");

    if (children != null)
    {
        var items = children.Elements("ShareListItem");
        foreach(var listItem in items)
        {
            ShareList childShareList = new ShareList();
            parent.Children.Add(childShareList);

            RecurseHierarchy(listItem, childShareList);
        }
    }

    // Just in case we want to chain some method
    return parent;
} 
```

要最初调用它，您必须传入根节点和一个新的 ShareList 对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T12:46:56.697

产生结果的一个好方法是使用 XPath（如果需要，[这里是一个很好的入门指南）。](http://www.w3schools.com/xpath/xpath_functions.asp)

将 XML 放入 XmlDocument 后，您可以使用 XPathNavigator 返回它的不同部分，如下所示：

```
var xmlNavigator = xmlDocument.CreateNavigator();

var outerQuery = xmlNavigator.Select("ShareList/Children/ShareListItem");

while (outerQuery.MoveNext()) {
    Console.WriteLine(outerQuery.Current.SelectSingleNode("Title").Value);
    var innerQuery = outerQuery.Current.Select("Children/ShareListItem");
    while (innerQuery.MoveNext()) {
        Console.WriteLine(" - " + innerQuery.Current.SelectSingleNode("Title").Value);
    }
} 
```

在上面的代码中，我们在 XML 中查询根 ShareList 节点的 Children 节点中的所有 ShareListItem 节点，并将生成的 XPathNodeIterator 存储在变量 outerQuery 中。然后我们遍历所有找到的节点，并在每个节点上运行一个操作以及另一个 XPath 查询以检索要处理的子节点。上面的代码产生以下输出：

> 第一
> -第二
> 折

我认为这是你所追求的。显然，如果您的 XML 可以嵌套得比这更深，您可以在必要时使用递归。

# email - 如何正确格式化此多部分电子邮件？

> ID：15024039
> 
> 赞同：2
> 
> 时间：2013-02-22T12:14:48.877
> 
> 标签：email, format, multipart

我很难格式化多部分电子邮件，这导致我查看它的任何邮件程序都显示一个空白文档。有人知道我在这里做错了什么吗？

抱歉，如果之前已经回答过...我尝试了其他一些人的答案，但无法将任何解决方案与我的问题联系起来。

提前谢谢！

```
Delivered-To: omenjohn@gmail.com
Received: by 10.182.151.107 with SMTP id up11csp166588obb;
        Fri, 22 Feb 2013 04:03:14 -0800 (PST)
X-Received: by 10.50.53.208 with SMTP id d16mr804024igp.5.1361534594250;
        Fri, 22 Feb 2013 04:03:14 -0800 (PST)
Return-Path: <noreply@lab.dyndnds-ip.com>
Received: from smtp-out-02.shaw.ca (smtp-out-02.shaw.ca. [64.59.136.138])
        by mx.google.com with ESMTP id xf7si2720052igb.40.2013.02.22.04.03.14;
        Fri, 22 Feb 2013 04:03:14 -0800 (PST)
Received-SPF: neutral (google.com: 64.59.136.138 is neither permitted nor denied by best guess record for domain of noreply@lab.dyndnds-ip.com) client-ip=64.59.136.138;
Authentication-Results: mx.google.com;
       spf=neutral (google.com: 64.59.136.138 is neither permitted nor denied by best guess record for domain of noreply@lab.dyndnds-ip.com) smtp.mail=noreply@lab.dyndnds-ip.com
X-Cloudmark-SP-Filtered: true
X-Cloudmark-SP-Result: v=1.1 cv=3f4U5fHrZLLPCzJ96ldNbjtja1zQ0ih230F6vdsLr5s= c=1 sm=1
 a=FaKJ9xKj03AA:10 a=BLceEmwcHowA:10 a=A_tRFZU-kTUA:10
 a=KDKwGF1bB4N2lZfoIKkULA==:17 a=wN4yYl2XIkzaJHmYasIA:9 a=QEXdDO2ut3YA:10
 a=CSdORdO7lnbvznqBb-0A:9 a=_W_S_7VecoQA:10 a=MZpOI37Du90A:10
 a=HpAAvcLHHh0Zw7uRqdWCyQ==:117
Received: from unknown (HELO lab.dyndns-ip.com) ([24.77.8.238])
  by smtp-out-02.shaw.ca with SMTP; 22 Feb 2013 05:03:13 -0700
Received: from Danielle-PC ([127.0.0.1])
    by lab.dyndns-ip.com
    ; Fri, 22 Feb 2013 06:02:53 -0600
Message-ID: <04371205-4ED3-48B2-BDA8-A338DBCAE3D1@lab.dyndns-ip.com>
Subject: Automated Email
To: 
From: Structure Agency <no-reply@lab.dyndns-ip.com>
Return-Path: Structure Agency <no-reply@lab.dyndns-ip.com>
Sender: Structure Agency <no-reply@lab.dyndns-ip.com>
Content-Language: en
MIME-Version: 1.0
Date: Fri, 22 Feb 2013 06:02:53 -0600
Priority: normal
Importance: normal
Content-Type: multipart/alternative; boundary="alt-boundary-1I6GTFY8"

--alt-boundary-1I6GTFY8
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit

Plain text message!

--alt-boundary-1I6GTFY8
Content-Type: text/html; charset="utf-8"
Content-Transfer-Encoding: 7bit

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8">
        <title>Automated Email</title>
    </head>
    <body>
        <p>Message in HTML!</p>
    </body>
</html>

--alt-boundary-1I6GTFY8 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:42:48.520

我很确定最后一个边界需要在末尾添加“--”。

希望有帮助，斯图尔特

# android - 运行 Google Maps Android API v2 的最低 Android API 级别

> ID：15024040
> 
> 赞同：11
> 
> 时间：2013-02-22T12:14:52.193
> 
> 标签：android, google-maps-android-api-2

我已经开发了一个使用 Google Maps Android API v1 的移动应用程序，我计划按照 Google 的推荐将它移植到最近的 Google Maps Android API v2。

但是，我的应用程序还针对 Android 2.1 设备，我无法确定 v2 地图是否会在此类设备上运行。我发现一些参考表明 v2 应该与 API 级别 8 和 10（[here](https://stackoverflow.com/a/15011895/881731)、[here](http://mobisys.in/blog/2012/12/google-rolls-out-android-maps-api-v2/)和[here](https://stackoverflow.com/a/14266014/881731)）一起使用，前提是移动设备支持 OpenGL ES 2.0，但 API 级别 7 不支持。

因此，我的问题是：运行 Google Maps Android API v2 的最低 Android API 级别是多少？

蒂亚！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-22T12:40:27.367

Maps API 与 Google Play 服务捆绑在一起，并与 Android 2.2 及更高版本兼容。所有 Android 8 API 级别的设备都支持 OpenGL 2.0，因此 Android 2.1 版本的设备无法支持 Google Maps v2。您可以查看[Google 文档](https://developers.google.com/maps/documentation/android/start#installing_the_google_maps_android_v2_api)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-25T16:00:51.890

这是一个 API 级别 8 (Froyo)，因为 Play Services 依赖。

还要注意，如果您使用的是 API 级别 8 - 10，则需要将 SupportMapFragment 与 Android 支持库一起使用：http: [//developer.android.com/tools/extras/support-library.html](http://developer.android.com/tools/extras/support-library.html)，因为仅在API 级别 11。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T12:26:53.940

i guess you are trying in Android Emulator,

or,

you are trying with Tablet with don't have GPS Feature, Try with GPS enabled device, it should work properly

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T16:54:08.633

正如 beni 所说，它适用于 Android 2.2 及更高版本。但是您需要 2.x 版本的 android 支持库，因为它使用片段...

# python - Python：仅替换字符串中的一次出现

> ID：15024043
> 
> 赞同：1
> 
> 时间：2013-02-22T12:15:04.757
> 
> 标签：python

我有一些示例数据，如下所示：

```
ATOM    973  CG  ARG A  61     -21.593   8.884  69.770  1.00 25.13           C
ATOM    974  CD  ARG A  61     -21.610   7.433  69.314  1.00 23.44           C
ATOM    975  NE  ARG A  61     -21.047   7.452  67.937  1.00 12.13           N 
```

我想通过添加偏移值来替换第 6 列，并且只替换第 6 列，在上面的情况下它是 308。

所以61+308 = 369，所以第6列的61应该换成369

我不能`str.split()`行，因为行距非常重要。

我尝试过使用`str.replace()`，但第 2 列中的值也可以与第 6 列重叠

我确实尝试反转该行并使用`str.repalce()`，但第 7、8、9、10 和 11 列中的值可能与`str`要替换的值重叠。

到目前为止，我所拥有的丑陋代码是（除了第 7、8、9、10 和/或 11 列中的值重叠之外，它部分有效）：

```
with open('2kqx.pdb', 'r') as inf, open('2kqx_renumbered.pdb', 'w') as outf:
    for line in inf:
        if line.startswith('ATOM'):
            segs = line.split()
            if segs[4] == 'A':
                offset = 308
                number = segs[5][::-1]
                replacement = str((int(segs[5])+offset))[::-1]
                print number[::-1],replacement
                line_rev = line[::-1]
                replaced_line = line_rev.replace(number,replacement,1)
                print line
                print replaced_line[::-1]
                outf.write(replaced_line[::-1]) 
```

上面的代码在下面产生了这个输出。正如您在第二行中看到的那样，第 6 列没有更改，但在第 7 列中发生了更改。我认为通过反转字符串我可以绕过与第 2 列的潜在重叠，但我忘记了其他列，我真的不知道如何解决它。

```
ATOM    973  CG  ARG A  369     -21.593   8.884  69.770  1.00 25.13           C
ATOM    974  CD  ARG A  61     -21.3690   7.433  69.314  1.00 23.44           C
ATOM    975  NE  ARG A  369     -21.047   7.452  67.937  1.00 12.13           N 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:29:01.503

```
data = """\
ATOM    973  CG  ARG A  61     -21.593   8.884  69.770  1.00 25.13           C
ATOM    974  CD  ARG A  61     -21.610   7.433  69.314  1.00 23.44           C
ATOM    975  NE  ARG A  61     -21.047   7.452  67.937  1.00 12.13           N"""

offset = 308
for line in data.split('\n'):
    line = line[:22] + "  {:<5d}  ".format(int(line[22:31]) + offset) + line[31:]
    print line 
```

我还没有对空格进行精确计数，这只是一个粗略的估计。如果您想要更多的灵活性，而不仅仅是将数字 22 和 31 分散在代码中，您将需要一种方法来确定您的开始和结束索引（但这与我假设数据采用固定列格式的假设相反）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T13:24:48.607

您最好不要尝试自己解析`PDB`-files。

使用 PDB 解析器。例如，在不同的生物/计算化学软件包中有许多免费可用的

[生物蟒](http://biopython.org/wiki/Main_Page)

下面是使用 biopython 的方法，假设您输入的是`raw.pdb`：

```
from Bio.PDB import PDBParser, PDBIO
parser=PDBParser()
structure = parser.get_structure('some_id', 'raw.pdb')
for r in structure.get_residues():
    r.id = (r.id[0], r.id[1] + 308, r.id[2])
io = PDBIO()
io.set_structure(structure)
io.save('shifted.pdb') 
```

* * *

我用谷歌搜索了一下，在这里找到了解决您的特定问题的快速解决方案（没有第三方依赖项）：

[http://code.google.com/p/pdb-tools/](http://code.google.com/p/pdb-tools/)

有——在**许多其他有用的 pdb-python-script-tools 中**——这个脚本[pdb_offset.py](http://code.google.com/p/pdb-tools/source/browse/trunk/pdbTools/pdb_offset.py)

它是一个独立的脚本，我只是复制了它的`pdb_offset`方法来展示它的工作原理，你的三行示例代码位于`raw.pdb`：

```
def pdbOffset(pdb_file, offset):
    """
    Adds an offset to the residue column of a pdb file without touching anything
    else.
    """

    # Read in the pdb file
    f = open(pdb_file,'r')
    pdb = f.readlines()
    f.close()

    out = []
    for line in pdb:
        # For and ATOM record, update residue number
        if line[0:6] == "ATOM  " or line[0:6] == "TER   ":
            num = offset + int(line[22:26])
            out.append("%s%4i%s" % (line[0:22],num,line[26:]))
        else:
            out.append(line) 

    return "".join(out)

print pdbOffset('raw.pdb', 308) 
```

哪个打印

```
ATOM    973  CG  ARG A 369     -21.593   8.884  69.770  1.00 25.13           C
ATOM    974  CD  ARG A 369     -21.610   7.433  69.314  1.00 23.44           C
ATOM    975  NE  ARG A 369     -21.047   7.452  67.937  1.00 12.13           N 
```

# python - 从包含的模板扩展父块，寻找解决方法

> ID：15024045
> 
> 赞同：1
> 
> 时间：2013-02-22T12:15:12.907
> 
> 标签：python, django, django-templates

我有一个带有一些 ajax 页面的网站。如果用户在浏览器中键入`/login/`，他应该得到一个完整的渲染模板，从基本模板扩展而来。但是如果用户点击一个登录按钮，`$('#content').ajax('/login/');`调用，所以我不需要渲染一个完整的模板。

即我有这个（`login_ajax.html`）：

```
{% load i18n %}

{% block title %}
    {% trans "Login" %}
{% endblock %}

{% block content %}
    {% include "social.html" %}
{% endblock %} 
```

在`login.html`：

```
{% extends "base.html" %}

{% block ajax_content %}
{% include "login_ajax.html" %}
{% endblock %} 
```

简单的登录视图：

```
def login(request):
    c = Context({'user': request.user})

    if request.is_ajax():
        return render_to_response('login_ajax.html', c, context_instance=RequestContext(request))

    return render_to_response('login.html', c, context_instance=RequestContext(request)) 
```

这个问题是指包含标签的文档：

> include 标签应该被认为是“渲染这个子模板并包含 HTML”的实现，而不是“解析这个子模板并包含它的内容，就好像它是父模板的一部分一样”。这意味着包含的模板之间没有共享状态——每个包含都是一个完全独立的渲染过程。

但我不想将名称放在视图中，`title`或者将其放置两次。`login.html``login_ajax.html`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:30:39.540

我认为你需要`{% block title %}`搬回`login.html`然后进行两次ajax调用。一个要覆盖`{% block ajax_content %}`，一个要覆盖`{% block title %}`。您可以使用与用于覆盖相同的模式进行`{% block title %}`覆盖`{% block ajax_content %}`，但您可能无需实际创建新`title.html`模板即可进行管理。

我看不出有任何其他方法可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T11:27:29.767

好的，我找到了一个简单的解决方案。实际上，问题在于：“从基础延伸，还是不延伸”。

事实上，我不在乎`login.html`应该扩展的模板。因此，对于 ajax 请求，父模板将是`empty.html`，而对于默认请求，它将是`base.html`. 所以，我将在视图中指向一个父模板：

```
def login(request):
    c = Context({'user': request.user, 'extends': 'empty.html'})

    if request.is_ajax():
        return render_to_response('login.html', c, context_instance=RequestContext(request))

    c['extends'] = 'base.html'
    return render_to_response('login.html', c, context_instance=RequestContext(request)) 
```

`empty.html`只包含一个块的占位符：

```
{% block content %}{% endblock %} 
```

这是`login.html`：

```
{% extends extends %}
{% load i18n %}

{% if extends != 'empty.html' %}
    {% block title %}{% trans "Login" %}{% endblock %}
{% else %}
    <div style="display: none;" class="ajax-title">{% trans "Login" %}</div>
{% endif %}

{% block content %}
    {% include "social.html" %}
{% endblock %} 
```

另外，我想，有一种方法可以`login.html`变成一个片段，可以使用 with。IE`{% include 'snippet.html' with extends='base.html' %}`

# java - 我可以直接从文件夹创建一个 byte[] 吗？

> ID：15024050
> 
> 赞同：0
> 
> 时间：2013-02-22T12:15:26.850
> 
> 标签：java, zip, bytearray, directory

Web 服务期望`byte[]`来自 zip 文件。

我在一个文件夹中有一些文件，我用 Java 压缩，然后我`byte[]`从这个 zip 文件中获取。

这是必要的还是我可以`byte[]`直接从文件夹中创建？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:24:14.120

**文件夹**是文件的集合。它**是一个容器**。它首先没有**字节**流。

另一方面，**ZIP**（或任何存档）**是一个文件**。**有关**不同文件的信息**存储在 ZIP 文件**本身中

但是，您可以遍历文件夹内容，创建一个字节数组，然后使用它（无论如何，您在创建 ZIP 时都会这样做）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T12:49:49.287

我认为这样的事情可以让你在不写的情况下做你想做的事，只要文件不会很大。

```
String[] sourceFiles = { "C:/file1", "C:/file2" };

ByteArrayOutputStream baos = new ByteArrayOutputStream();
ZipOutputStream zout = new ZipOutputStream(baos);

byte[] buffer = new byte[4096];

for (int i = 0; i < sourceFiles.length; i++)
{
    FileInputStream fin = new FileInputStream(sourceFiles[i]);
    zout.putNextEntry(new ZipEntry(sourceFiles[i]));

    int length;
    while ((length = fin.read(buffer)) > 0)
    {
        zout.write(buffer, 0, length);
    }

    zout.closeEntry();
    fin.close();
}

zout.close();

byte[] bytes = baos.toByteArray(); 
```

# android - 从服务访问android位置？

> ID：15024051
> 
> 赞同：1
> 
> 时间：2013-02-22T12:15:28.013
> 
> 标签：android, android-service, android-location

我从服务启动的线程请求位置更新时遇到问题。

我的应用程序需要从后台服务获取位置更新（没有任何 UI 线程）。我将解释我的应用程序的结构。

1.  它有一个由 Boot Receiver 启动的服务。
2.  在`onStartCommand()`服务中，它启动一个调度线程。
3.  调度程序线程请求位置更新。

问题是当调度程序调用`locationMgr.requestLocationUpdates()` 它说`Can't create handler inside thread that has not called Looper.prepare()` 我已经看到其他人的类似问题但找不到任何解决方案。我听说我们可以直接从服务调用以获取位置更新而没有任何问题，但由于我找不到让服务休眠的方法（如调度程序线程），我想我需要一个单独的线程。

请解释为什么会这样？android 是否需要 UI 线程来请求位置？通过更改我的应用程序结构有什么解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:25:19.250

`Looper` is what keeps polling a thread queue for `Message`'s/`Runnable`s (those posted via a `Handler` on that thread). UI thread has one by default. For custom threads, you need to set it up before you start the thread.

[As mentioned in the example:](http://developer.android.com/reference/android/os/Looper.html)

> Class used to run a message loop for a thread. Threads by default do not have a message loop associated with them; to create one, call prepare() in the thread that is to run the loop, and then loop() to have it process messages until the loop is stopped.

Now, `RequestLocationUpdates()` needs a mechanism to deliver updates to your thread, but your thread doesn't have a `Looper` polling.

Consider Moving `RequestLocationUpdates()` and its corresponding `removeUpdates()` to Service thread. Most likely where service starts and stops.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T12:46:34.650

我已经使用了它并且工作正常：获取服务位置

这里的服务等级：

```
public class MyService extends Service {

    @Override
    public IBinder onBind(Intent arg0) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public void onCreate() {
        // TODO Auto-generated method stub
        super.onCreate();

    }

    @Override
    public void onDestroy() {
        // TODO Auto-generated method stub
        super.onDestroy();
    }

    @Override
    public void onStart(Intent intent, int startId) {
        // TODO Auto-generated method stub
        super.onStart(intent, startId);

        // start location manager
        LocationDetermined objLocationDetemined = new LocationDetermined(this);
        objLocationDetemined.getlocation(this);
        objLocationDetemined.getRecentKnownLocation(this);

    } 
```

位置类在这里：

```
public class LocationDetermined implements OnInitListener {

    String TAG = "LocationDeterminedClass";
private static LocationManager locationManager;
double Lat = 0.0;
double Long = 0.0;
GeoPoint geoPoint;
private Toast mToast;
Context appContext;
static MyLocationListener locationListener;

    public LocationDetermined(Context context) {
        this.appContext = context;

    }

    public MyLocationListener getlocation(Context appContext) {

        locationManager = (LocationManager) appContext
                .getSystemService(Context.LOCATION_SERVICE);
        locationListener = new MyLocationListener();
        Criteria criteria = new Criteria();
        criteria.setAccuracy(Criteria.ACCURACY_COARSE);
        String provider = locationManager.getBestProvider(criteria, true);

        Log.d(TAG, "------provider------" + provider);

        if (provider != null && locationManager.isProviderEnabled(provider)) {
            locationManager.requestLocationUpdates(provider, 0, 0,
                    locationListener);
        } else {
            Toast.makeText(appContext, "No provider available to get loctaion",
                    2000).show();
        }
        return locationListener;
    }

    private class MyLocationListener implements LocationListener {

        public void onProviderDisabled(String provider) {
            // TODO Auto-generated method stub

        }

        public void onProviderEnabled(String provider) {
            // TODO Auto-generated method stub

        }

        public void onStatusChanged(String provider, int status, Bundle extras) {
            // TODO Auto-generated method stub

        }

        public void onLocationChanged(final Location argLocation) {
            // TODO Auto-generated method stub
            if (argLocation != null) {
                Lat = argLocation.getLatitude();
                Long = argLocation.getLongitude();

                Log.e("OnLocationChanged:", "lat:" + Lat + "  long:" + Long);

                Log.d("service gps", "lat" + argLocation.getLatitude() + "-"
                        + argLocation.getLongitude());

                Constant.mLatitude = argLocation.getLatitude();
                Constant.mLongitude = argLocation.getLongitude();               
            }
        }
    }

    public GeoPoint getRecentKnownLocation(Context appContext) {
        Location locGps = locationManager
                .getLastKnownLocation(LocationManager.GPS_PROVIDER);
        Location locNet = locationManager
                .getLastKnownLocation(LocationManager.NETWORK_PROVIDER);

        Location locPassive = locationManager
                .getLastKnownLocation(LocationManager.PASSIVE_PROVIDER);
        if (locGps != null) {
            Lat = locGps.getLatitude();
            Long = locGps.getLongitude();

            Constant.mLatitude = locGps.getLatitude();
            Constant.mLongitude = locGps.getLongitude();

            geoPoint = new GeoPoint((int) (Lat * 1000000),
                    (int) (Long * 1000000));
            return geoPoint;

        } else if (locNet != null) {
            Lat = locNet.getLatitude();
            Long = locNet.getLongitude();

            Constant.mLatitude = locNet.getLatitude();
            Constant.mLongitude = locNet.getLongitude();

            geoPoint = new GeoPoint((int) (Lat * 1000000),
                    (int) (Long * 1000000));
            return geoPoint;

        }
        return geoPoint;
    }

    private void fetchedSavedLocationDetail(Context mContext) {

    }

    @Override
    public void onInit(int status) {
        // TODO Auto-generated method stub

    }

    public static void removeLocationListener() {

        locationManager.removeUpdates(locationListener);
    }

} 
```

我在常量类中使用这些变量来存储位置 public static double mLatitude = 0.0, mLongitude = 0.0;

启动服务 startService(new Intent(this, MyService.class));

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T12:19:31.677

发生的原因是：getLooper 连接到 context 的 UI，但是 service 是 ackground 进程没有直接连接到 UI。所以你得到错误。

您的问题的解决方案：

1）将位置类放在其他包中。2）导入该包名称。3) 在你的包中使用一个回调接口。4）在你的服务组件中使用接口实例。5）它会工作！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T13:48:33.970

我已经通过使用处理程序修复了它。

1.  我创建了一个处理程序。
2.  我把服务代码放在它的`handleMessage()`
3.  创建一个线程，以所需的时间间隔（while 循环）向处理程序发送空消息。
4.  因此，当处理程序接收到空消息时，它会运行`handleMessage()`包含实际调度程序循环的

# string - 连接字符串错误

> ID：15024052
> 
> 赞同：0
> 
> 时间：2013-02-22T12:15:33.157
> 
> 标签：string, connection

我的连接字符串是：

我网站中的连接字符串错误

我的数据库在 app_data

```
 <connectionStrings>
    <add name="t1" connectionString="Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|/t1.mdf;Integrated Security=True;User Instance=True;User ID=UserName;Password=Password" providerName="System.Data.SqlClient" />
  </connectionStrings>
        <system.web>
    <customErrors mode="Off"/>    
  </system.web> 
```

请帮忙 。我的网站是：seifoury.com

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:17:44.003

尝试查看[http://www.connectionstrings.com/](http://www.connectionstrings.com/)以了解每种可能的排列方式。我的猜测是该部分 `|DataDirectory|/t1.mdf`应该是`|DataDirectory|t1.mdf`.

也可能是您在用户名上规定了一个没有域的受信任连接。 `Data Source=myServerAddress;...User ID=myDomain\myUsername;Password=myPassword;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T09:21:24.070

我的连接是：

```
<connectionStrings>
    <add name="t1" connectionString="Data Source=localhost\SQLEXPRESS;AttachDbFilename=|DataDirectory|\t1.mdf;Integrated Security=True;User Instance=True"  providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

错误是：

```
Invalid value for key 'attachdbfilename'. 
```

# iphone - 应用程序在后台出现 EXC_BAD_ACCESS 崩溃

> ID：15024055
> 
> 赞同：0
> 
> 时间：2013-02-22T12:15:37.123
> 
> 标签：iphone, objective-c, xcode, exc-bad-access

我`NSString *oldChat`在头文件中设置如下：

```
@interface CTFChatViewController : UIViewController {
    NSString *oldChat;
}
- (void)updateChat;
@property (nonatomic, retain) NSString *oldChat;

@end 
```

然后我用它：

```
- (void)updateChat
{
    NSString *chat = [NSString stringWithContentsOfURL:[NSURL URLWithString:@"http://theshay.byethost7.com/chat.php"] encoding:NSUTF8StringEncoding error:nil];
    if (![chat isEqual:oldChat]) 
    {
        [webView loadHTMLString:chat baseURL:nil];
        oldChat = chat;
    }

    [self performSelectorInBackground:@selector(updateChat) withObject:nil];
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.

    NSString *chat = [NSString stringWithContentsOfURL:[NSURL URLWithString:@"http://theshay.byethost7.com/chat.php"] encoding:NSUTF8StringEncoding error:nil];
    oldChat = chat;
    [webView loadHTMLString:chat baseURL:nil];

    [self performSelectorInBackground:@selector(updateChat) withObject:nil];
} 
```

`if (![chat isEqual:oldChat])`应用程序因`EXC_BAD_ACCESS`错误而崩溃。为什么它崩溃了？

（XCode 4.5.2、iPhone 模拟器 6.0、基础 SDK 6.0）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:23:27.303

oldChat 是`autorelease`对象。保留它并使用 isEqualToString 进行字符串比较。

```
 NSString *chat = [NSString stringWithContentsOfURL:[NSURL URLWithString:@"http://theshay.byethost7.com/chat.php"] encoding:NSUTF8StringEncoding error:nil];
 oldChat = chat;
[oldChat retain]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:22:20.200

您必须使用 isEqualToString: 方法检查您的 NSString 是否相等。你的代码应该是这样的

```
if (![chat isEqualToString:oldChat]){
    //Do something
} 
```

# ios - 使用听写 - iOS 6 - DidStart？

> ID：15024056
> 
> 赞同：6
> 
> 时间：2013-02-22T12:15:41.263
> 
> 标签：ios, ios6, uitextinput, dictation

# 如何回应*开始*听写？

* * *

**响应听写的已知方法：**

*   dictationRecordingDidEnd - 响应口述短语的识别*完成*。

*   dictationRecognitionFailed - 响应*失败*的听写识别。

* * *

**参考：** UITextInput 协议参考

从 iOS 5.1 开始，当用户在支持的设备上选择听写输入时，系统会自动将识别的短语插入到当前文本视图中。UITextInput 协议中的方法允许您的应用响应听写的完成，如“使用听写”中所述。您可以使用 UIDictationPhrase 类的对象来获取表示用户口述短语的字符串。在听写结果不明确的情况下，听写短语对象提供包含替代字符串的数组。

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextInput_Protocol/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextInput_Protocol/Reference/Reference.html)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-26T04:30:31.387

据我所知，没有用于检测听写何时开始的公共 API。

如果你**真的**想做，而且你想进入 App Store，你可能可以通过以下方法侥幸成功，但**它完全不受支持**，**无论如何它可能会被你拒绝**，并且**将来可能会中断iOS 版本**。

在更改为听写“键盘”或从听写“键盘”更改*后*，文本系统会发布一些未记录的通知。其中两个发布在对它的更改和对它*的*更改上，名称如下：

*   `UIKeyboardCandidateCorrectionDidChangeNotification`
*   `UIKeyboardLayoutDidChangedNotification`

请注意，第二个有一个奇怪的动词变位。那不是错字。（好吧，这不是*我*的错字。）

这些通知也会在其他时间发布，因此您不能只是观察它们并假设听写状态已更改。当您收到通知时，您需要进行更多检查。因此，将自己添加为其中一个通知的观察者。第一个似乎不太可能在未来消失或重新命名。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    [[NSNotificationCenter defaultCenter] addObserver:self
        selector:@selector(checkForDictationKeyboard:)
        name:@"UIKeyboardCandidateCorrectionDidChangeNotification"
        object:nil];
    ... 
```

当您收到通知时，您会想查看听写视图是否正在显示：

```
- (void)checkForDictationKeyboard:(NSNotification *)note {
    if ([self isShowingDictationView]) {
        NSLog(@"showing dictation view");
    } else {
        NSLog(@"not showing dictation view");
    }
} 
```

要查看它是否显示，请检查除您自己的应用程序窗口之外的每个窗口。通常，唯一的另一个窗口是文本系统的窗口。

```
- (BOOL)isShowingDictationView {
    for (UIWindow *window in [UIApplication sharedApplication].windows) {
        if (window == self.window)
            continue;
        if (containsDictationView(window))
            return YES;
    }
    return NO;
} 
```

递归遍历视图层次结构，检查其类名包含字符串“DictationView”的视图。实际的类名是`UIDictationView`但不使用全名，您不太可能被 App Store 拒绝。

```
static BOOL containsDictationView(UIView *view) {
    if (strstr(class_getName(view.class), "DictationView") != NULL)
        return YES;
    for (UIView *subview in view.subviews) {
        if (containsDictationView(subview))
            return YES;
    }
    return NO;
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-17T01:30:05.973

虽然这个问题得到了回答，但我仍然想添加我的解决方案并希望对其他人有所帮助。

当您点击键盘上的 MIC 按钮时，`primaryLanguage`将变为`dictation`。你可以这样检测：

```
[[NSNotificationCenter defaultCenter] 
         addObserver:self 
            selector:@selector(handleCurrentInputModeDidChange:)
                name:UITextInputCurrentInputModeDidChangeNotification 
              object:nil];

- (void) handleCurrentInputModeDidChange:(NSNotification *)notification
{
    NSString *primaryLanguage = [UITextInputMode currentInputMode].primaryLanguage;

    NSLog(@"current primaryLanguage is: %@", primaryLanguage);
} 
```

**更新：** 正如@user1686700 所说，`currentInputMode`已被弃用。这不再是解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-18T20:34:58.367

请注意 - UITextInputMode 的**currentInputMode**自 iOS7 起已弃用。我们可能只需要等到 Apple 决定发布听写 API，以便我们可以根据我们的意图进行有意义的调用。

# c - 新的matlab版本/架构上的mex代码崩溃

> ID：15024059
> 
> 赞同：3
> 
> 时间：2013-02-22T12:15:45.320
> 
> 标签：c, matlab, 32bit-64bit, mex

我有一个例程计算频域中的 Rice Wavelet Toolbox 中指定的移位不变离散小波变换。该代码采用 MEX（c 语法）并使用一些额外的例程来执行虚多项式*等*。在一个单独的文件中。

源文件 fsidwt.c、fisidwt.c 和辅助例程 polyphase.[chm] 一起压缩在一个文件中：http: [//ubuntuone.com/6zXIIuA3J4OTTlSquycMlz](http://ubuntuone.com/6zXIIuA3J4OTTlSquycMlz)

此代码在较旧的 matlab 版本中没有问题，其他 matlab 函数依赖于它。

但是，现在，当我现在编译它时，首先会出现一条警告消息

```
>> mex fisidwt.c polyphase.c % message about different gcc version
>> mex fsidwt.c polyphase.c % message about different gcc version
    fsidwt.c: In function ‘multiMRFWD1D’:
    fsidwt.c:187: warning: cast to pointer from integer of different size
    fsidwt.c:188: warning: cast to pointer from integer of different size
    fsidwt.c:189: warning: cast to pointer from integer of different size
    fsidwt.c:190: warning: cast to pointer from integer of different size 
```

这很奇怪，因为没有整数被转换为指针。但这只是一个警告，所以让我们继续。

现在，mex 文件 fsidwt 和 fisidwt 计算正向和反向频域移变小波变换。

我的测试程序很简单：

```
>> clear all; len_sig=256; wlevels=3; numsig=1; numtest=1; 
    % 256 points, 3 wavelet decomposition levels
>> st=4; ts=(1:(len_sig/st))'*(1:st); ts=ts(:); ts=ts*ones(1,numsig); Ts=fft(ts); 
    % sawtooth with 4 'teeth' of increasing height and its FFT
>> h=[1;1]/sqrt(2); g=qmf(h); h=[h(:) g(:)]; H=fft(h,len_sig); 
    % Haar wavelet filters and 256-point FFTs
>> [ffs ffd] = fsidwt(Ts, H, wlevels); 
    % forward wavelet transform
>> ffr=fisidwt(ffs,ffd,cH,levels); 
    % recontruction 
```

不幸的是，它以分段违规退出，其原因我无法从核心转储输出中追踪...

代码中的行 [在 http://ubuntuone.com/6zXIIuA3J4OTTlSquycMlz 的 zip 文件中]，fsidwt.c 的第 187-190 行，阅读：

```
Hfilter2d = (dComplexMat) dComplexMake2D ( hcomp[0],  NQ, Q);
Gfilter2d = (dComplexMat) dComplexMake2D ( hcomp[1],  NQ, Q);
Detail2d  = (dComplexMat) dComplexMake2D ( workspaced, Q, NQ);
Approx2d  = (dComplexMat) dComplexMake2D ( workspacec, Q, NQ); 
```

所有的 LHS 都是类型

```
dComplexMat 
```

这是

```
typedef struct {double r,i;} dComplex;
typedef dComplex *dComplexVec;
typedef dComplexVec *dComplexMat; 
```

所有的 RHS 都是类型

```
(dComplexVec, long, long) 
```

dComplexMake2D() 的代码是：

```
dComplexMat dComplexMake2D(
            dComplexVec array1D,
            int width, int height) {
    register int i;
    dComplexMat theMatrix = (dComplexMat) mxCalloc ( width, sizeof(dComplexVec) );
    theMatrix[0]=(dComplexVec)array1D;
    for(i=1;i<width;i++)
        theMatrix[i] = theMatrix[i-1] + height;
    return theMatrix;
} 
```

我将如何开始查找此分段违规的原因？跟警告有关系吗？是新的Matlab版本吗？还是 64 位架构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T20:14:45.333

哦亲爱的。MathWorks 帮助台在调查这个问题时发现，函数头`dComplexMake2D`有一个额外的东西`d`，我必须至少忽略了 42 次。

好尴尬。但无论如何，代码就像一个梦（很快就会上线）和一个教训：

MEX 就返回类型发出警告，`dComplexMake2D`因为它找不到匹配的标头，继续执行（看起来确实如此）但假定返回类型`int`，链接到`dComplexMake2D`返回指针（`long int`大小类型）的编译文件，这就是出错的地方...

感谢 MathWorks 的技术支持。他们确实指出调试 MEX 文件与他们无关。

# php - 如何使用 PHP 完全检测代理

> ID：15024060
> 
> 赞同：3
> 
> 时间：2013-02-22T12:15:49.583
> 
> 标签：php, proxy, fraud-prevention

我想在有人进入我的网站之前全面检测代理，以防止欺诈行为。

PHP 中是否有任何脚本可以实际检测所有代理，例如透明、匿名、高匿名、Socks、Tor 等？

我有一个代码，但我不确定它是否过滤了所有代理：

```
$proxy_headers = array(
        'HTTP_VIA',
        'HTTP_X_FORWARDED_FOR',
        'HTTP_FORWARDED_FOR',
        'HTTP_X_FORWARDED',
        'HTTP_FORWARDED',
        'HTTP_CLIENT_IP',
        'HTTP_FORWARDED_FOR_IP',
        'VIA',
        'X_FORWARDED_FOR',
        'FORWARDED_FOR',
        'X_FORWARDED',
        'FORWARDED',
        'CLIENT_IP',
        'FORWARDED_FOR_IP',
        'HTTP_PROXY_CONNECTION'
    );
    foreach($proxy_headers as $x){
        if (isset($_SERVER[$x])) die("You are using a proxy!");
    } 
```

有人可以帮助我创建一个可以阻止任何代理流量进入我的网站的完整解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T12:22:32.143

> 我想在有人进入我的网站之前全面检测代理，以防止欺诈行为。

这根本没有意义。代理有很多完全合法的用例。此外，*恶意*代理用户可以删除这些标头，以及他们可能正在使用代理的任何其他指示。

检测代理用户的唯一真正安全的方法是列出所有存在的代理 IP。

我会取消它，并花时间建立更有用的安全措施。随着时间的推移，可能会变得有用的一种方法是能够轻松阻止某些 IP 甚至是麻烦制造者使用的 IP 范围。

# ruby - 在 Ruby 中，有没有办法在任意对象上执行块，所以我们可以有作用域变量？

> ID：15024065
> 
> 赞同：1
> 
> 时间：2013-02-22T12:16:01.040
> 
> 标签：ruby, scope

举个例子：

```
greeting = "world hello".split.reverse.join(" ")
greeting << ", here me shouting!!"
greeting.upcase!

p greeting # "HALLO WORLD, HERE ME SHOUTING!!" 
```

这使用局部变量`greeting`来存储字符串。现在，如果我们之前在代码中已经使用过这个变量，那么它的原始值就会丢失。

```
greeting = "Hi World."

...

greeting = "world hello".split.reverse.join(" ")
greeting << ", here me shouting!!"
greeting.upcase!

p greeting # "HALLO WORLD, HERE ME SHOUTING!!" ... original "Hi World." is gone. 
```

所以我在想是否有一种方法可以通过使用块来为这样的小片段创建范围。该变量`greeting`将进入块中并且只会隐藏外部变量，而不是覆盖它：

```
greeting = "Hi World."

"world hello".scope do |greeting|
  greeting.split.reverse.join(" ")
  greeting << ", here me shouting!!"
  greeting.upcase!
  p greeting # "HALLO WORLD, HERE ME SHOUTING!!"
end

p greeting # "Hi World." 
```

注意`scope`我在这里使用的方法。我将此方法猴子修补到`Object`. `scope`获取块并使用局部变量产生它`self`：

```
class Object
  def scope
    yield self
  end
end 
```

依靠猴子修补`Object`类，特别是使用名为 的方法，我感觉不太舒服`scope`，这似乎很可能被其他类覆盖，其实例不能再像这样限定范围。

**那么，Ruby 中有没有内置的方法可以做到这一点？**

另外 - 如果我必须继续使用猴子补丁 - 我认为这`self`可能是一个比`scope`. 即使也是关键字，也可以定义为方法名；它有效，我测试了它。`self`似乎不太可能被其他类覆盖。它也很适合其他最常用的“块方法”的风格`each`：

### `collection.each do`

> *“在每个*元素上执行以下块。”

### `object.self do`

> *“对（你）自己*执行以下块”。

**`self`用作方法名称有什么缺点吗？（其他命名建议表示赞赏）。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:24:37.453

这个问题被反复问过。一种方法是：

```
"world hello".instance_eval do
  ...
end 
```

但这很重，不是首选。建议的更好方法是：

```
"world hello".tap do |s|
  ...
  break s
end 
```

但在您的特定情况下，方法链是最简单的：

```
"world hello"
.split
.reverse
.join(" ")
.concat(", here me shouting!!")
.upcase
.tap{|s| p s} 
```

# performance - 列表、数组和可变数组之间的埃拉托色尼筛法的理想实现是什么？

> ID：15024067
> 
> 赞同：6
> 
> 时间：2013-02-22T12:16:02.610
> 
> 标签：performance, haskell, primes, sieve-of-eratosthenes

在 Haskell 中，我在[Rosetta Code 页面](http://rosettacode.org/wiki/Sieve_of_Eratosthenes#Haskell)上找到了三个简单的 Eratosthenes 筛子实现。

**现在我的问题是，在什么情况下应该使用哪一个？**

**纠正我最初的推理也会有帮助：**

我假设 List one 对于 Haskeller 来说是最惯用和最容易阅读的。但是，它正确吗？我想知道它是否遇到与我后来学到的另一个基于列表的筛子相同的问题，但实际上并没有实现算法：（
*编辑：这里显示的是我知道有问题的基于列表的筛子，而不是来自 RosettaCode 的那个，我粘贴在底部）*

```
primes = sieve [2..] where
         sieve (p:x) = p : sieve [ n | n <- x, n `mod` p > 0 ] 
```

在性能方面，不可变数组似乎是赢家。上限`m`为 时`2000000`，时间约为：

*   列表 1.3s
*   阵列 0.6s
*   可变数组 1.8s

所以我会选择 Array 来提高性能。

当然，可变数组也很容易推理，因为我有更命令式的语言背景。不过，如果我在 Haskell 中编码，我不确定为什么我会选择这个，因为它比其他的慢而且不习惯。

此处复制代码以供参考：

**列表：**

```
primesTo m = 2 : eratos [3,5..m] where
eratos (p : xs) | p*p>m = p : xs
                | True  = p : eratos (xs `minus` [p*p, p*p+2*p..])

minus a@(x:xs) b@(y:ys) = case compare x y of
     LT -> x : minus  xs b
     EQ ->     minus  xs ys
     GT ->     minus  a  ys
minus a        b        = a 
```

**不可变数组：**

```
import Data.Array.Unboxed

primesToA m = sieve 3 (array (3,m) [(i,odd i) | i<-[3..m]] :: UArray Int Bool)
  where
    sieve p a 
      | p*p > m   = 2 : [i | (i,True) <- assocs a]
      | a!p       = sieve (p+2) $ a//[(i,False) | i <- [p*p, p*p+2*p..m]]
      | otherwise = sieve (p+2) a 
```

**可变数组：**

```
import Control.Monad (forM_, when)
import Control.Monad.ST
import Data.Array.ST
import Data.Array.Unboxed

primeSieve :: Integer -> UArray Integer Bool
primeSieve top = runSTUArray $ do
    a <- newArray (2,top) True           -- :: ST s (STUArray s Integer Bool)
    let r = ceiling . sqrt $ fromInteger top
    forM_ [2..r] $ \i -> do
      ai <- readArray a i
      when ai $ do
        forM_ [i*i,i*i+i..top] $ \j -> do
          writeArray a j False
    return a

-- Return primes from sieve as list:  
primesTo :: Integer -> [Integer]
primesTo top = [p | (p,True) <- assocs $ primeSieve top] 
```

**编辑**

*   我在顶部展示了特纳的筛子，但这不是我要与其他两个比较的基于列表的示例。我只是想知道基于列表的示例是否存在与特纳相同的“不是正确的埃拉托色尼筛法”问题。
*   看来性能比较是不公平的，因为可变数组示例也经历了偶数并使用`Integer`而不是`Int`......

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-22T14:19:41.720

这

```
primes = sieve [2..] where
         sieve (p:x) = p : sieve [ n | n <- x, n `mod` p > 0 ] 
```

不是筛子。这是**非常**低效的审判部门。**不要用那个！**

我很好奇你是怎么得到你的时间的，特纳“筛子”不可能在几秒钟内产生不超过 2,000,000 个的素数。让它找到 200,000 的素数

```
MUT     time    6.38s  (  6.39s elapsed)
GC      time    9.19s  (  9.20s elapsed)
EXIT    time    0.00s  (  0.00s elapsed)
Total   time   15.57s  ( 15.59s elapsed) 
```

在我的机器上（64 位 Linux，ghc-7.6.1，使用 -O2 编译）。该算法的复杂度`O(N² / log² N)`几乎是二次的。让它前进到 2,000,000 大约需要 20 分钟。

您对阵列版本的时间也很可疑，尽管方向相反。你测量解释代码了吗？

筛选到 2,000,000，经过优化编译，可变数组代码的运行时间为 0.35 秒，不可变数组代码的运行时间为 0.12 秒。

现在，可变数组仍然比不可变数组慢三倍。

但是，这是一个不公平的比较。对于不可变数组，您使用`Int`了 s，而对于可变数组`Integer`s。将可变数组代码更改为使用`Int`s - 因为它应该，因为在引擎盖下，数组是`Int`-indexed，所以 using`Integer`是不必要的性能牺牲，什么都买不到 - 使可变数组代码在 0.15 秒内运行。接近可变数组代码，但不完全在那里。但是，您让可变数组做更多的工作，因为在不可变数组代码中您只消除奇素数的奇数倍数，但在可变数组代码中，您标记所有素数的所有倍数。更改可变数组代码以特别处理 2，并且仅消除奇数的奇数倍数也将其降低到 0.12 秒。

但是，您正在使用经过范围检查的数组索引，这很慢，而且由于在代码本身中检查了索引的有效性，因此没有必要。将其更改为 using`unsafeRead`并将`unsafeWrite`不可变数组的时间缩短到 0.09 秒。

然后你有使用的问题

```
forM_ [x, y .. z] 
```

使用 boxed `Int`s（幸运的是，GHC 消除了该列表）。自己写一个循环，这样就只`Int#`用了 unboxed s，时间降到 0.02 秒。

```
{-# LANGUAGE MonoLocalBinds #-}
import Control.Monad (forM_, when)
import Control.Monad.ST
import Data.Array.ST
import Data.Array.Unboxed
import Data.Array.Base

primeSieve :: Int -> UArray Int Bool
primeSieve top = runSTUArray $ do
    a <- newArray (0,top) True
    unsafeWrite a 0 False
    unsafeWrite a 1 False
    let r = ceiling . sqrt $ fromIntegral top
        mark step idx
            | top < idx = return ()
            | otherwise = do
                unsafeWrite a idx False
                mark step (idx+step)
        sift p
            | r < p     = return a
            | otherwise = do
                prim <- unsafeRead a p
                when prim $ mark (2*p) (p*p)
                sift (p+2)
    mark 2 4
    sift 3

-- Return primes from sieve as list:
primesTo :: Int -> [Int]
primesTo top = [p | (p,True) <- assocs $ primeSieve top]

main :: IO ()
main = print .last $ primesTo 2000000 
```

所以，总结一下，对于埃拉托色尼筛，你应该使用一个数组——这并不奇怪，它的效率取决于能够在很短的恒定时间内从一个倍数步进到下一个倍数。

你会得到非常简单直接的不可变数组代码，并且该代码在不太高的限制下表现得很好（对于更高的限制它会变得相对更糟，因为数组仍然被复制和垃圾收集，但这还不错）。

当您需要更好的性能时，您需要可变数组。编写高效的可变数组代码并非易事，必须知道编译器如何翻译各种结构以选择正确的结构，有些人会认为这样的代码是单一的。但是您也可以使用提供相当有效实现[的库](http://hackage.haskell.org/package/arithmoi)（免责声明：我编写的），而不是自己编写。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T14:17:38.677

可变数组在性能方面永远是赢家（你真的应该复制[只在赔率上工作的版本](http://rosettacode.org/wiki/Sieve_of_Eratosthenes#Unboxed_arrays.2C_on_odds_only)作为最低限度；它应该是三个中最快的 - 也是因为它使用`Int`而不是`Integer`）。

对于*列表*，[树形合并增量筛](http://rosettacode.org/wiki/Sieve_of_Eratosthenes#List-based_tree-merging_incremental_sieve)的性能应该比你展示的要好。`takeWhile (< limit)`如果需要，您可以随时使用它。我认为它最清楚地传达了筛子的真实性质：

```
import Data.List (unfoldr)

primes :: [Int]         
primes = 2 : _Y ((3 :) . gaps 5 . _U . map (\p -> [p*p, p*p+2*p..]))

_Y g = g (_Y g)                                -- recursion 
_U ((x:xs):t) = (x :) . union xs . _U          -- ~= nub . sort . concat
                      . unfoldr (\(a:b:c) -> Just (union a b, c)) $ t

gaps k s@(x:xs) | k < x     = k : gaps (k+2) s   -- ~= [k,k+2..]\\s, when 
                | otherwise =     gaps (k+2) xs  --  k<=x && null(s\\[k,k+2..])

union a@(x:xs) b@(y:ys) = case compare x y of  -- ~= nub . sort .: (++)
         LT -> x : union  xs  b
         EQ -> x : union  xs ys
         GT -> y : union  a  ys 
```

`_U`重新实现[`Data.List.Ordered.unionAll`](http://hackage.haskell.org/package/data-ordlist-0.4.7.0/docs/Data-List-Ordered.html#v:unionAll)，并且为了`gaps 5`效率`(minus [5,7..])`而融合，使用`minus`和`union`来自同一个[包](http://hackage.haskell.org/package/data-ordlist-0.4.7.0)。

当然，没有什么能比得上简洁**`Data.List.nubBy (((>1).).gcd) [2..]`**（但它很慢）。

对于您的第一个新问题：不是。它确实通过计数来找到倍数，就像任何真正的筛子一样[（尽管列表上的“减号”当然性能不佳；上面通过将线性减法链重新排列为树折叠加法的减法来改进了`((((xs-a)-b)-c)- ... )`这[一点](https://stackoverflow.com/a/12563800/849891)，`xs-(a+((b+c)+...))`）。]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-02T13:48:06.070

如前所述，使用可变数组具有最佳性能。以下代码源自此[“TemplateHaskell”版本，该版本](http://www.haskell.org/haskellwiki/Prime_numbers#Bitwise_prime_sieve_with_Template_Haskell)转换回更符合直接可变数组解决方案的内容，因为“TemplateHaskell”似乎没有任何区别，并进行了一些进一步的优化。我相信它比通常的可变未装箱数组版本更快，因为进一步优化，特别是由于使用了“unsafeRead”和“unsafeWrite”函数，避免了数组的范围检查，可能也在内部使用指针进行数组访问：

```
{-# OPTIONS -O2 -optc-O3 #-}
import Control.Monad
import Control.Monad.ST
import Data.Array.ST
import Data.Array.Unboxed
import Data.Array.Base

primesToUA :: Word32-> [Word32]
primesToUA top = do
    let sieveUA top = runSTUArray $ do    
        let m = ((fromIntegral top) - 3) `div` 2 :: Int
        buf <- newArray (0,m) True -- :: ST s (STUArray s Int Bool)
        let cullUA i = do
            let p = i + i + 3
                strt = p * (i + 1) + i
            let cull j = do
                if j > m then cullUA (i + 1)
                else do
                    unsafeWrite buf j False
                    cull (j + p)
            if strt > m then return ()
            else do
                e <- unsafeRead buf i
                if e then cull strt else cullUA (i + 1)
        cullUA 0; return buf
    if top > 1 then 2 : [2 * (fromIntegral i) + 3 | (i,True) <- assocs $ sieveUA top]
    else []

main = do 
    x <- read `fmap` getLine      --   1mln    2mln    10mln   100mln
    print (last (primesToUA x))   --   0.01    0.02     0.09     1.26  seconds 
```

**编辑：上面的代码已被更正，下面的时间被编辑以反映更正，以及将分页与非分页版本进行比较的评论已被编辑。**

将其运行到指示的最高范围的时间如上述源代码底部的评论表所示，由[ideone.com](http://ideone.com/dihVcJ)测量，并且比@WillNess 发布的答案快大约五倍，也是在[ideone测量的.com](http://ideone.com/6Qdzl3). 这段代码将素数剔除到 200 万只需要很短的时间，而将素数剔除到一亿只需要 1.26 秒。在我的 i7 (3.5 GHz) 上以 0.44 秒运行到一亿时，这些时间快了大约 2.86 倍，运行到十亿需要 6.81 秒。前者的内存使用量刚刚超过 6 兆字节，后者的内存使用量为 60 兆字节，这是巨大（位压缩）数组使用的内存。该数组还解释了非线性性能，因为当数组大小超过 CPU 缓存大小时，每个复合数表示剔除的平均内存访问时间会变差。

**编辑_添加：** 页面分段筛更有效，因为当缓冲区大小保持小于 L1 或 L2 CPU 缓存时，它具有更好的内存访问效率，并且具有无界的优点，因此上限不必是预先指定的内存占用量要小得多，即基素数小于所用范围的平方根加上页面缓冲内存。以下代码已编写为分页实现，比非分页版本要快一些；它还提供了一个优点，即可以将代码顶部的输出范围规范从“Word32”更改为“Word64”，因此它不限于 32 位数字范围，只需要花费一点处理时间（对于 32 位编译代码）适用于任何通用范围。代码如下：

```
-- from http://www.haskell.org/haskellwiki/Prime_numbers#Using_ST_Array

{-# OPTIONS -O2 -optc-O3 #-}
import Data.Word
import Control.Monad
import Control.Monad.ST
import Data.Array.ST
import Data.Array.Unboxed
import Data.Array.Base

primesUA :: () -> [Word32]
primesUA () = do
    let pgSZBTS = 262144 * 8
    let sieveUA low bps = runSTUArray $ do
        let nxt = (fromIntegral low) + (fromIntegral pgSZBTS)
        buf <- newArray (0,pgSZBTS - 1) True -- :: ST s (STUArray s Int Bool)
        let cullUAbase i = do
            let p = i + i + 3
                strt = p * (i + 1) + i
            when (strt < pgSZBTS) $ do
                e <- unsafeRead buf i
                if e then do
                    let loop j = do
                        if j < pgSZBTS then do
                            unsafeWrite buf j False
                            loop (j + p)
                        else cullUAbase (i + 1)
                    loop strt
                else cullUAbase (i + 1)
        let cullUA ~(p:t) = do
            let bp = (fromIntegral p)
                i = (bp - 3) `div` 2
                s = bp * (i + 1) + i
            when (s < nxt) $ do
                let strt = do
                    if s >= low then fromIntegral (s - low)
                    else  do
                        let b = (low - s) `rem` bp
                        if b == 0 then 0 else fromIntegral (bp - b)
                let loop j = do
                    if j < pgSZBTS then do
                        unsafeWrite buf j False
                        loop (j + (fromIntegral p))
                    else cullUA t
                loop strt
        if low <= 0 then cullUAbase 0 else cullUA bps
        return buf
    let sieveList low bps = do
        [2 * ((fromIntegral i) + low) + 3 | (i,True) <- assocs $ sieveUA low bps]
    let sieve low bps = do
        (sieveList low bps) ++ sieve (low + (fromIntegral pgSZBTS)) bps
    let primes' = ((sieveList 0 []) ++ sieve (fromIntegral pgSZBTS) primes') :: [Word32]
    2 : sieve 0 primes'

main = do 
   x <- read `fmap` getLine      --   1mln    2mln    10mln   100mln
                                 --   0.02    0.03     0.13     1.13  seconds
   print (length (takeWhile ((>=) (fromIntegral x)) (primesUA ()))) 
```

由于需要以不同于后续页面的方式从第一页数组中剔除复合数表示，因此上面的代码比非分页的情况多出几行代码。该代码还具有修复程序，因此不会由于基本素数列表和输出列表现在不是同一个列表而导致内存泄漏（从而避免将整个列表保留在内存中）。

请注意，由于剔除缓冲区的大小恒定小于 L2 CPU 缓存，此代码需要接近线性时间（在筛选范围内），因为范围变得更大。内存使用量是非分页版本使用量的一小部分，1 亿只使用不到 600 KB，10 亿只使用超过 600 KB，略有增加只是基素数所需的额外空间小于平方根的范围列表。

在[ideone.com 上，](http://ideone.com/0Xm93J)此代码在大约 1.13 秒内生成一亿个素数，大约 12 秒到十亿个（32 位设置）。可能车轮分解和肯定的多核处理会使它在多核 CPU 上更快。在我的 i7 (3.5 GHz) 上，筛分到一亿只需要 0.44 秒，筛到十亿只需要 4.7 秒，随着范围的增加，性能大致呈线性。似乎在 ideone.com 上运行的 GHC 版本中存在某种非线性开销，对于 i7 不存在的较大范围有一些性能损失，这可能与不同的垃圾收集有关，如页面正在为每个新页面创建新的缓冲区。 **END_EDIT_ADD**

**EDIT_ADD2：**似乎上述页面分段代码的大部分处理时间都用于（惰性）列表处理，因此相应地重新编写了代码，并进行了如下几个改进：

1.  实现了一个不使用列表处理并使用“popCount”表查找来一次计算 32 位字中“一个”位的数量的素数计数功能。这样，与实际筛分时间相比，找到结果的时间是微不足道的。

2.  将基本素数存储为位打包页面段列表，这比存储素数列表更节省空间，并且根据需要将页面段转换为素数的时间并不是很大的计算开销。

3.  调整素数段生成函数，使得对于初始零页段，它使用自己的位模式作为源页，从而使复合数剔除代码更短更简单。

然后代码变成如下：

```
{-# OPTIONS -O3 -rtsopts #-} -- -fllvm ide.com doesn't support LLVM

import Data.Word
import Data.Bits
import Control.Monad
import Control.Monad.ST
import Data.Array.ST (runSTUArray)
import Data.Array.Unboxed
import Data.Array.Base

pgSZBTS = (2^18) * 8 :: Int -- size of L2 data cache

type PrimeType = Word32
type Chunk = UArray PrimeType Bool

-- makes a new page chunk and culls it
--   if the base primes list provided is empty then
--   it uses the current array as source (for zero page base primes)
mkChnk :: Word32 -> [Chunk] -> Chunk
mkChnk low bschnks = runSTUArray $ do
  let nxt = (fromIntegral low) + (fromIntegral pgSZBTS)
  buf <- nxt `seq` newArray (fromIntegral low, fromIntegral nxt - 1) True
  let cull ~(p:ps) =
        let bp = (fromIntegral p)
            i = (bp - 3) `shiftR` 1
            s = bp * (i + 1) + i in
        let cullp j = do
              if j >= pgSZBTS then cull ps
              else do
                unsafeWrite buf j False
                cullp (j + (fromIntegral p)) in
        when (s < nxt) $ do
          let strt = do
                if s >= low then fromIntegral (s - low)
                else  do
                  let b = (low - s) `rem` bp
                  if b == 0 then 0 else fromIntegral (bp - b)
          cullp strt
  case bschnks of
    [] -> do bsbf <- unsafeFreezeSTUArray buf
             cull (listChnkPrms [bsbf])
    _ -> cull $ listChnkPrms bschnks
  return buf

-- creates a page chunk list starting at the lw value
chnksList :: Word32 -> [Chunk]
chnksList lw =
  mkChnk lw basePrmChnks : chnksList (lw + fromIntegral pgSZBTS)

-- converts a page chunk list to a list of primes
listChnkPrms :: [Chunk] -> [PrimeType]
listChnkPrms [] = []
listChnkPrms ~(hdchnk@(UArray lw _ rng _):tlchnks) =
  let nxtp i =
        if i >= rng then [] else
          if unsafeAt hdchnk i then
            (case ((lw + fromIntegral i) `shiftL` 1) + 3 of
              np -> np) : nxtp (i + 1)
          else nxtp (i + 1) in
  (hdchnk `seq` lw `seq` nxtp 0) ++ listChnkPrms tlchnks

-- the base page chunk list used to cull the higher order pages,
--   note that it has special treatment for the zero page.
--   It is more space efficient to store this as chunks rather than
--   as a list of primes or even a list of deltas (gaps), with the
--   extra processing to convert as needed not too much.
basePrmChnks :: [Chunk]
basePrmChnks = mkChnk 0 [] : chnksList (fromIntegral pgSZBTS)

-- the full list of primes could be accessed with the following function.
primes :: () -> [PrimeType]
primes () = 2 : (listChnkPrms $ chnksList 0)

-- a quite fast prime counting up to the given limit using
--   chunk processing to avoid innermost list processing loops.
countPrimesTo :: PrimeType -> Int
countPrimesTo limit =
  let lmtb = (limit - 3) `div` 2 in
  let sumChnks acc chnks@(chnk@(UArray lo hi rng _):chnks') =
        let cnt :: UArray PrimeType Word32 -> Int
            cnt bfw =
              case if lmtb < hi then fromIntegral (lmtb - lo) else rng of
                crng -> case crng `shiftR` 5 of
                  rngw -> 
                    let cnt' i ac =
                          ac `seq` if i >= rngw then
                            if (i `shiftL` 5) >= rng then ac else
                              case (-2) `shiftL` fromIntegral (lmtb .&. 31) of
                                msk -> msk `seq`
                                  case (unsafeAt bfw rngw) .&.
                                       (complement msk) of
                                    bts -> bts `seq` case popCount bts of
                                      c -> c `seq` case ac + c of nac -> nac
                          else case ac + (popCount $ unsafeAt bfw i) of
                                 nacc -> nacc `seq` cnt' (i + 1) (nacc)
                    in cnt' 0 0 in
        acc `seq` case runST $ do -- make UArray _ Bool into a UArray _ Word32
          stbuf <- unsafeThawSTUArray chnk
          stbufw <- castSTUArray stbuf
          bufw <- unsafeFreezeSTUArray stbufw
          return $ cnt bufw of
            c -> c `seq` case acc + c of
              nacc -> nacc `seq` if hi >= lmtb then nacc
                      else sumChnks nacc chnks' in
  if limit < 2 then 0 else if limit < 3 then 1 else
    lmtb `seq` sumChnks 1 (chnksList 0)

main = do 
  x <- read `fmap` getLine  --  1mln   2mln  10mln  100mln 1000mln
                            --  0.02   0.03   0.06    0.45    4.60   seconds
                            --  7328   7328   8352    8352    9424  Kilobytes
  -- this takes 14.34 seconds and 9424 Kilobytes to 3 billion on ideone.com,
  -- and 9.12 seconds for 3 billion on an i7-2700K (3.5 GHz).
  -- The above ratio of about 1.6 is much better than usual due to
  -- the extremely low memory use of the page segmented algorithm.
  -- It seems thaat the Windows Native Code Generator (NCG) from GHC
  --   is particularly poor, as the Linux 32-bit version takes
  --   less than two thirds of the time for exactly the same program...
  print $ countPrimesTo x
--  print $ length $ takeWhile ((>=) x) $ primes () -- the slow way to do this 
```

代码中给出的时间和内存要求与[在 ideone.com 上运行时观察到的一样](http://ideone.com/hmkb1Z)，在我的 i7-2700K (3.5 GHz) 上运行一、二、十、一百、一千（十亿）和三千（三十亿）需要 0.02、0.03、0.05、0.30、3.0 和 9.1 秒) 百万范围，具有几乎恒定的内存占用量，随着基本素数的数量小于所需范围的平方根而缓慢增加。当使用 LLVM 编译器后端编译时，这些时间分别变为 0.01、0.02、0.02、0.12、1.35 和 4.15 秒，因为它更有效地使用了寄存器和机器指令；最后一个非常接近与使用 64 位编译器而不是使用 32 位编译器编译时相同的速度，因为寄存器的有效使用意味着额外寄存器的可用性没有太大区别。

正如代码中所评论的那样，由于没有受到内存访问瓶颈的限制，我的真实机器和 ideone.com 服务器上的性能之间的比率变得比内存浪费更多的算法要小得多，因此速度限制主要是比率CPU 时钟速度以及每个时钟周期的 CPU 处理效率。然而，正如那里所评论的那样，当在 Windows（32 位编译器）下运行时，GHC 本地代码生成器（NCG）存在一些奇怪的低效率，因为运行时间比在 Linux 下运行（作为 ideone. com 服务器使用）。AFAIK 他们都有相同的 Haskell GHC 版本的通用代码库，唯一的分歧在于使用的链接器（它也与 LLVM 后端一起使用，不受影响），因为 GHC NCG 不使用 GCC，而只使用 mingw32 汇编器,

请注意，当使用 LLVM 编译器后端编译此代码时，其速度与为高度优化的“C/C++”实现编写的相同算法的速度大致相同，这表明 Haskell 确实有能力开发非常紧密的循环编码。可以说，一旦习惯了单子和非严格代码的 Haskell 范例，Haskell 代码比等效的“C/C++”代码更具可读性和安全性。埃拉托色尼筛子执行速度的进一步改进纯粹是对所用实现的调整，而不是在 Haskell 和“C/C++”之间选择语言。

**总结：** 当然，这还不是 Haskell 版本的埃拉托色尼筛法的终极速度，因为我们还没有调整内存访问以更有效地使用快速 CPU L1 缓存，也没有显着降低除了消除赔率处理之外，使用极端车轮分解所需的复合剔除操作的总数。然而，这足以回答这个问题，即可变数组是解决此类紧密循环类型问题的最有效方法，与使用列表或不可变数组相比，潜在的速度增益约为 100 倍。 **END_EDIT_ADD2**

# controls - python (ipython) 中控制工程的非线性框图

> ID：15024068
> 
> 赞同：0
> 
> 时间：2013-02-22T12:16:04.727
> 
> 标签：controls, delay, ipython, simulink, feedback

我会找到传递函数包含指数因子的系统的脉冲响应、阶跃响应或波特图，例如 G=e^(-s)/(s+1)。我已经使用了 ipython、matplotlib、scipy、sympy 和[python 控制库](http://www.cds.caltech.edu/~murray/wiki/index.php/Python-control)。

在 python 中是否已经存在任何方式来创建对前一个 G 的负反馈，而不必考虑敏感函数？

# ios - XCode：重新加载 UITableViewCell

> ID：15024069
> 
> 赞同：0
> 
> 时间：2013-02-22T12:16:05.663
> 
> 标签：ios, objective-c, uitableview

我有一个带有标签、指示器视图等的 UITableViewCell 子类。我需要在从网络上检索数据时更新它（特别是我有一个结果数标签）。

我用它来尝试重新加载单元格，但它不起作用。我知道正在调用 cellForRowAtIndexPath，并且数据源本身的值已更新。

```
[self.myFriendsTbl beginUpdates];
[self.myFriendsTbl reloadRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationNone];
[self.myFriendsTbl] endUpdates]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:27:17.210

```
[self.myFriendsTbl reloadData]; 
```

This will force each visible `UITableViewCell` to be reloaded. `cellForRowAtIndexPath` will be called for each of them.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T12:28:52.370

```
[self.myFriendsTbl reloadData]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T12:46:39.977

您不需要调用 beginUpdates 或 endUpdates，因为您没有删除或插入单元格。

只需更改 DataSource 中特定行的数据并调用

```
[self.tableView reloadRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationLeft]; 
```

正如你所做的那样。

如果它不起作用，则可能您没有更改正确的行，或者您的 indexPath 不是正确的。显示更多代码来检查。例如，使用“UITableViewRowAnimationLeft”之类的某种动画将帮助您查看正在更改的单元格。

# regex - 如何使用正则表达式模式做到这一点？

> ID：15024074
> 
> 赞同：0
> 
> 时间：2013-02-22T12:16:11.540
> 
> 标签：regex, sublimetext2, textmate

我正在`TextMate / Sublime Text 2`为 6502 汇编语言编写一个自定义包。

无论如何，我希望能够识别常量、变量等。

我有这个`HEX`数字：

```
<dict>
    <key>match</key>
    <string>#?\#[0-9a-fA-F]+</string>
    <key>name</key>
    <string>constant.numeric.decimal</string>
</dict> 
```

但它实际上不适用于以下情况：

```
#14              // works
#$2F             // works
#coolVariable    // doesn't work.  The "#c" is caught and colored but the rest is not.
                 //                In this case, I DON'T want any of it to be colored. 
```

就像代码说的那样，它不应该给它着色，`#coolVariable`但它会抓住`#c`它的一部分。

我想单独为这样的变量着色。区分这两种模式的正则表达式是什么？

以便：

```
#c0      //  Caught by one pattern  (values in decimal or hexadecimal or binary)
#%10101  //  Caught by one pattern  (values in decimal or hexadecimal or binary)
#c0BLAH  // Caught by another pattern 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:23:14.050

使用 \b 作为单词边界

所以说`\b#?\#[0-9a-fA-F]+\b`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T13:15:20.013

```
\#[0-9a-fA-F]+\b 
```

标记单词必须在使用任何其他字符之前结束。

# c++ - Visual Studio：全局命名空间优先于本地

> ID：15024079
> 
> 赞同：3
> 
> 时间：2013-02-22T12:16:24.943
> 
> 标签：c++, visual-studio-2010, gcc, namespaces, std

我今天收到了一些代码，它使用 std::string 上的 std::transform 使其全部小写。发件人在 Visual Studio 2010 中编写并编译了代码：

```
using namespace std;
string test = "TEST";
transform(test.begin(), test.end(), test.begin(), tolower); 
```

当我使用 GCC 和/或 Clang 在 OSx 上编译它时，得到了编译错误，因为它涉及命名空间的冲突。

确实有很多已回答的问题涉及全局命名空间与本地（::tolower 与 std::tolower），但这是关于这段代码实际上适用于 VS 的事实。

**我想回答的问题：**

1.  为什么 Visual Studio 编译这个？
2.  当 std:: 应该优先时，它怎么会默认（？）到全局命名空间 :: ？

> *   这是一个 ideone 片段（有错误）：http: [//ideone.com/qvUAMw](http://ideone.com/qvUAMw)
> *   这是一个ideone片段（有效）：http: [//ideone.com/lk0H5d](http://ideone.com/lk0H5d)

*注意：我在 OSx Mountain Lion 上使用 GCC 4.2 和 Clang (425.0.24 LLVM 3.2svn)*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:42:53.737

这里的问题是双重的。首先，如果您没有特别说明`#include <cctype>`，您可能会得到`tolower`一个宏，而不是函数（尽管我不知道这几天这是否真的是一个问题，以及这是否会破坏标准合规性。）

其次，在 C++`tolower`中是重载的。您需要选择要使用的特定重载：

```
transform(test2.begin(), test2.end(), test2.begin(),
          static_cast<int(*)(int)>(tolower)); 
```

但我不知道为什么`std::`会得到一个重载版本而`::`没有。无论如何，我建议您远离那些 C 函数，而是`std::ctype`从头文件中使用`<locale>`，它提供了更好的`tolower`：

[http://www.cplusplus.com/reference/locale/ctype](http://www.cplusplus.com/reference/locale/ctype)

# jasper-reports - 如何在碧玉报告的条形图中旋转条形上方的 itemLabels？

> ID：15024082
> 
> 赞同：3
> 
> 时间：2013-02-22T12:16:37.020
> 
> 标签：jasper-reports, label, bar-chart

我需要将条形图的 itemLabels 旋转大约 90°，以便它们具有垂直方向。itemLabels 不是轴上的那些，而是条形上方的那些。我必须这样做，否则 itemLabels 会重叠。我知道有一些方法可以防止标签重叠，但我有一个特定的要求，让它们垂直定向。如果有办法请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T12:21:16.400

我想出了如何解决这个问题。您必须在 ChartCustomizer 的自定义函数中设置 BasePositiveItemLabelPosition，该函数本身扩展了 JRAbstractChartCustomizer。被覆盖的 costomize 方法有两个参数。在这种情况下，“图表”是第一个 JFreeChart。您必须从图表中获取正确的渲染器，在本例中是 CategoryPlotRenderer。渲染器具有设置 BasePositiveItemLabelPosition 的功能，您可以使用它来定义 ItemLabels 的位置以及它们将如何旋转（-Math.PI / 2 -> 逆时针 90°）。

```
CategoryItemRenderer renderer = chart.getCategoryPlot().getRenderer();
    ItemLabelPosition itemLabelPosition = new ItemLabelPosition(ItemLabelAnchor.OUTSIDE12, TextAnchor.CENTER_LEFT,
            TextAnchor.CENTER_LEFT, -Math.PI / 2);
    renderer.setBasePositiveItemLabelPosition(itemLabelPosition); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T17:12:30.243

我假设您使用的是 JFree Chart 库。如果是这种情况，可以选择添加图表定制器类，让您更好地控制图表选项。

[查看这篇关于Jasper 中的图表定制](http://mdahlman.wordpress.com/2010/08/18/chart-customizers-1/)器的博客文章我认为这正是您正在寻找的内容，还有[第二篇文章](http://mdahlman.wordpress.com/2011/04/17/chart-customizers-2/)显示了一些额外的功能。

# java - NetBeans 模板脚本

> ID：15024083
> 
> 赞同：1
> 
> 时间：2013-02-22T12:16:41.477
> 
> 标签：java, netbeans

在 NetBeans 中，您可以创建类模板。以下模板是我迄今为止创建的。我想做一个小的改进，但我不知道这是否可能。

```
<#if package?? && package != "">
package ${package};

</#if>
import org.owasp.esapi.ESAPI;
import org.owasp.esapi.Logger;

/**
 *
 * <#if package?? && package != "">${package}.${name}</#if>
 * @author ${user}
 * @createdDate ${date}
 */

public class ${name} {

    private static final Logger LOG = ESAPI.getLogger(${name}.class);
} 
```

如您所见，它只是一个包含 ESAPI 记录器的简单模板，现在我要做的是检查 ESAPI.class 是否存在，然后只应该创建记录器，否则应该创建不同的记录器，比如说 Log4J。

我想这样做的原因是我正在处理许多项目，我不想为每个项目创建一个类模板，如果归根结底我会的，但我想你们中的一个人可能知道这是否可能.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T05:54:01.507

感谢 Joop Eggen 的评论，我将使用变量 Route：

> 您可以设置变量（例如为 ${user} 选择另一个值）。并使用 <#if>。在 NB 中更改用户的 Internet 搜索将指向该方向。

# ruby-on-rails - Rails：从视图中排序数组的麻烦

> ID：15024086
> 
> 赞同：0
> 
> 时间：2013-02-22T12:16:48.870
> 
> 标签：ruby-on-rails, arrays, sorting, view

所以我试图让用户从我认为的链接中对一组食谱进行排序：

```
<%= link_to "Score", recipes_sort_path, :order => 'score' %> 
```

我将参数“score”发送到我的控制器方法“sort”，如下所示：

```
 def sort
    if (params[:order] == 'score')
      @recipes.sort_by(&:score)
    end

    respond_to do |format|
      format.html { redirect_to recipes_path }
      format.json { render json: @recipe }
    end
  end 
```

它重定向到以下索引方法：

```
 def index
    # If recipes already present, skip following
    if (!@recipes)
      if (params[:search] || params[:tag])
        @recipes = Recipe.search(params[:search], params[:tag])
      else
        @recipes = Recipe.all
      end
    end

    respond_to do |format|
      format.html 
      format.json { render json: @recipe }
    end
  end 
```

这个想法是用排序列表重定向到索引视图并只渲染视图。我没有收到任何错误，但是当我单击链接时，页面重新加载但没有任何反应。

食谱类如下所示：

```
class Recipe < ActiveRecord::Base
  attr_accessible :instructions, :name, :slug, :score, :upvotes, :downvotes, :comments, :image

  has_and_belongs_to_many :ingredients
  has_and_belongs_to_many :tags
  has_many :comments  
  belongs_to :user
  delegate :name, :to => :user, :prefix => :user, :allow_nil => true
  mount_uploader :image, ImageUploader

  validates :name, :presence => true

  def score
    score = (self.upvotes - self.downvotes)
  end
end 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:49:46.857

还有第三个选项（前两个来自 ckruse 的回答）。您可以从排序操作呈现索引模板

```
def sort
  if (params[:order] == 'score')
    @recipes.sort_by!(&:score)
  end

  respond_to do |format|
    format.html { render :index }
    format.json { render json: @recipe }
  end
end 
```

这将在排序操作中使用@recipes 时使用索引模板。您还保存了一个请求，因为您没有重定向。

我想评论的另一件事是链接。它应该是

```
<%= link_to "Score", recipes_sort_path(:order => 'score') %> 
```

更新：获取@recipes。尽可能地，我希望 sql 进行排序，这就是我要在这里做的事情。

```
def sort
  @recipes = Recipe

  if params[:order] == 'score'
    @recipes = @recipes.order('upvotes - downvotes')
  end

  respond_to do |format|
    format.html { render :index }
    format.json { render json: @recipe }
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:23:53.170

首先：`sort_by`不是“破坏性的”，它返回一个新数组。您可能想要使用或保存into`sort_by!`的返回值。`sort_by``@recipes`

第二：你根本不会在你的`sort`动作中渲染任何东西。如果您发布了所有代码，即使`@recipes`是空的。你可以做两件事：

*   `sort`像在方法中一样检索方法中的数据`index`，然后调用`render :index`
*   对你的方法进行排序，`index`根本不要使用任何`sort`方法。您可以将多个 URI 路由到同一个操作。

# sql - 将当前记录与上一个和下一个匹配

> ID：15024091
> 
> 赞同：0
> 
> 时间：2013-02-22T12:17:20.607
> 
> 标签：sql, sql-server, match, recordset

我在 sqlserver 中有一个数据库，它的数据如下所示

```
Employecode  Jobcode  startTime EndTime
1001         01       10:30     15:00
1001         02       15:30     18:00
1002         01       09:00     13:00 
```

它没有自动增量 ID

我想将当前记录与上一个和下一个记录`employecode`匹配，无论它与上一个或下一个匹配还是不匹配。

我想在 php 中执行此操作。

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:04:01.937

如果您可以使用函数 LAG() 和 LEAD()，请检查您的 SQL SERVER 文档版本。您可以使用 LAG() 从 prev 中获取价值。行和下一行的 LEAD()。然后将其与当前行进行比较。在提交问题时创建表格和数据总是一个好主意。您可以使用 SQL Fiddle：[http ://sqlfiddle.com/](http://sqlfiddle.com/)

# list - 比较 f# 中两个单独列表中的项目

> ID：15024092
> 
> 赞同：0
> 
> 时间：2013-02-22T12:17:23.853
> 
> 标签：list, f#, compare

这是我正在处理的示例：

```
 let test =
  [("Andy", ["d"; "a"; "d"; "c"; "b"; "d"; "c"; "a"; "a"; "c"; "a"; "d"; "a"; "a"; "d"; "e"]);
   ("Harry", ["b"; "d"; "c"; "b"; "c"; "b"; "a"; "a"; "d"; "b"; "d"; "d"; "a"; "c"; "b"; "e"]);

let answers = ["b"; "a"; "a"; "c"; "d"; "d"; "c"; "a"; "a"; "d"; "a"; "d"; "a"; "a"; "d"; "e"]); 
```

我正在尝试使用 list.map 来比较每个人的测试并确定他们有多少答案是正确的。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T12:31:44.517

我将创建一个函数来计算给定答案列表和正确答案的分数，然后将其应用于列表中的每个元组：

```
let getScore ans correct = List.map2 (=) ans correct |> List.filter id |> List.length
let getCorrect l = l |> List.map (fun (name, ans) -> (name, getScore ans answers)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T13:50:49.580

这应该可以解决问题：

```
let test =
  [("Andy", ["d"; "a"; "d"; "c"; "b"; "d"; "c"; "a"; "a"; "c"; "a"; "d"; "a"; "a"; "d"; "e"]);
   ("Harry", ["b"; "d"; "c"; "b"; "c"; "b"; "a"; "a"; "d"; "b"; "d"; "d"; "a"; "c"; "b"; "e"]); ]

let answerKey = ["b"; "a"; "a"; "c"; "d"; "d"; "c"; "a"; "a"; "d"; "a"; "d"; "a"; "a"; "d"; "e"];

let score answerKey answers =
    List.zip answerKey answers
    |> List.sumBy (fun (key, answer) ->
        if key = answer then 1 else 0)

let results =
    test
    |> List.map (fun (name, answers) ->
        name, score answerKey answers) 
```

如果将其放入 F# Interactive，结果将是：

```
val results : (string * int) list = [("Andy", 12); ("Harry", 5)] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T15:27:30.017

通过获得正确和错误的答案计数来扩展一点，这将起作用......

首先[映射](http://msdn.microsoft.com/en-us/library/ee370378.aspx)结果以处理每个单独的记分表。然后使用正确的[awnserlist](http://msdn.microsoft.com/en-us/library/ee340290.aspx) fold2 来查找[匹配](http://msdn.microsoft.com/en-us/library/dd233248.aspx)项（您可以在此处使用简单的 if then ）。我计算一个[元组](http://msdn.microsoft.com/en-us/library/dd233200.aspx)中正确和错误答案的数量。show 函数执行一个简单的[迭代](http://msdn.microsoft.com/en-us/library/ee340469.aspx)以从元组中获取第一个和第二个项目，然后[printf](http://msdn.microsoft.com/en-us/library/ee370560.aspx)值。

```
 let scores results corr = 
    results
    |> List.map ( 
        fun (name, score) -> 
            (name, List.fold2 (
                fun s rhs lhs ->  
                    match s with
                    | (good, wrong) when rhs=lhs -> ( good + 1 , wrong) 
                    | (good, wrong) -> ( good, wrong + 1)
                                ) (0, 0) score corr
            ) 
        )

let show scorelist = 
scorelist
|> List.iter 
    ( fun i -> 
         match i with
         | (name, score) -> 
            match score with
            | (good, wrong) ->
                    printf "%s correct: %d wrong: %d \r\n" 
                     name
                     good 
                     wrong
     ) 
```

从 F# 交互式运行：

```
show (scores test answers);;
Andy correct: 12 wrong: 4 
Harry correct: 5 wrong: 11 
```

# javascript - 从 asp.net 将变量传递给 javascript 块

> ID：15024098
> 
> 赞同：1
> 
> 时间：2013-02-22T12:18:08.003
> 
> 标签：javascript, asp.net, c#-4.0, literals

我有一个网格视图，其中有一个标题模板“全选”，选中后将选中网格视图行中的所有复选框。

我有一个页面大小下拉列表，选择时将打开该数量的 gridview 行。最初它设置为 10。

最初当 gridview 被加载并且当我选择全部时它选择了 10 个复选框，后来当我将页面大小更改为 50 并选择全部时，它仍然只选择 10 条记录。但是，它应该选择所有 50 条记录，而这并没有发生。

我在单击选择所有复选框时将数组变量传递给文字控件，该复选框将行数作为网格视图中的数字，但 JavaScript 中的函数仍保留 10 行的相同旧值，因此它选择 10 条记录。

我的代码：

```
protected void gvDeviceList_DataBound(object sender, EventArgs e){
    try {
        //repopulate the already ticked checkboxes
        RePopulateCheckboxes(gvDeviceList);

        if (gvDeviceList.Rows.Count > 0) {
            CheckBox cbHeader = (CheckBox)(gvDeviceList.HeaderRow.FindControl("chbOptions"));
            cbHeader.Attributes["onclick"] = "ChangeAllCheckBoxStates(this.checked);";

            //ClientScript.RegisterArrayDeclaration("CheckBoxIDs", String.Concat("'", cbHeader.ClientID, "'"));
            //Add the CheckBox's ID to the client-side CheckBoxIDs array
            List<String> ArrayValues = new List<String>();
            ArrayValues.Add(String.Concat("'", cbHeader.ClientID, "'"));

            foreach (GridViewRow gvr in gvDeviceList.Rows) {
                //Get a programmatic reference to the CheckBox control
                CheckBox cb = (CheckBox)(gvr.FindControl("chbAction"));

                //Add the CheckBox's ID to the client-side CheckBoxIDs array
                //ClientScript.RegisterArrayDeclaration("CheckBoxIDs", String.Concat("'", cb.ClientID, "'"));
                ArrayValues.Add(String.Concat("'", cb.ClientID, "'"));
            }

            //Output the array to the Literal control (CheckBoxIDsArray)
            CheckBoxIDsArray.Text = "<script type='text/javascript'>" + "\r\n" +
                                    "" + "\r\n" +
                                    String.Concat("var CheckBoxIDs = new Array(", String.Join(",", ArrayValues.ToArray()), ");") + "\r\n" +
                                    "" + "\r\n" +
                                    "</script>";
        } 
```

文字控制是：

```
<asp:Literal ID="CheckBoxIDsArray" runat="server" Visible="True"></asp:Literal> 
```

我的 JavaScript 代码是：

```
function ChangeAllCheckBoxStates(checkState) {
    // Toggles through all of the checkboxes defined in the CheckBoxIDs array
    // and updates their value to the checkState input parameter
    if (CheckBoxIDs != null) {
    for (var i = 0; i < CheckBoxIDs.length; i++)
        ChangeCheckBoxState(CheckBoxIDs[i], checkState);
    }
} 
```

任何帮助将不胜感激。

# scheme - 分区帮助方案

> ID：15024099
> 
> 赞同：1
> 
> 时间：2013-02-22T12:18:16.333
> 
> 标签：scheme

我有以下代码，但是当我运行此示例时：

```
(partition 12 '(4 9 18 6 19 10 18 11 5 5 7 2 4 19 1 9 10 18 12)) 
```

我明白了

```
((4 9 6 10 11 5 5 7 2 4 1 9 10 12) (18 19 18 19 18)) 
```

作为回报。

我想要它如下

```
((4 9 6 10 11 5 5 7 2 4 1 9 10 12) 18 19 18 19 18) 
```

我应该怎么做才能改变这种情况？感谢支持

```
 (require (lib "trace.ss"))
        (define (partition pivot lon)
          (if (null? lon)
              '(()())
              (let ((split-of-rest (partition pivot (cdr lon))))
                (if (<= (car lon) pivot)
                    (list (cons (car lon) (car split-of-rest))
                          (cadr split-of-rest))
                    (list (car split-of-rest) (cons (car lon)
                                                    (car (cdr split-of-rest)))))))) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:56:05.380

这就是我解决它的方法：

```
(define (partition pivot lon)
  (define (partition pivot lon less more)
    (if (null? lon)
      (cons less more)
      (if (<= (car lon) pivot)
        (partition pivot (cdr lon) (append less (list (car lon))) more)
        (partition pivot (cdr lon) less (append more (list (car lon)))))))
  (partition pivot lon '() '())) 
```

不知道这是否是您正在寻找的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:39:50.897

在一些 Scheme 解释器（例如 Racket）中有一个内置的[`partition`](http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket/list..rkt%29._partition%29%29)过程。或者，它也包含在[SRFI 1](http://srfi.schemers.org/srfi-1/srfi-1.html#FilteringPartitioning)中。如果可以使用它，它将简化您的代码：

```
(define (my-partition val lst)
  (let-values (((low high) (partition (lambda (x) (<= x val)) lst)))
    (cons low high))) 
```

`partition`返回两个值，第一个是满足谓词的元素的列表，第二个是不满足谓词的元素的列表。使用 a 将它们组合起来很容易，`cons`以获得所需格式的结果。

或者，我们可以使用[`call-with-values`](http://docs.racket-lang.org/reference/values.html#%28def._%28%28quote._~23~25kernel%29._call-with-values%29%29)@leppie 建议的：

```
(define (my-partition val lst)
  (call-with-values
   (thunk (partition (lambda (x) (<= x val)) lst))
   cons)) 
```

无论哪种方式，结果都符合预期：

```
(my-partition 12 '(4 9 18 6 19 10 18 11 5 5 7 2 4 19 1 9 10 18 12))
=> '((4 9 6 10 11 5 5 7 2 4 1 9 10 12) 18 19 18 19 18) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-22T14:10:29.957

我发现递归方法很困难，这是一种更简单的迭代方法：

```
(define (partition pivot lst)
  (let loop ((a '()) (b '()) (lst lst))
    (cond
      ((null? lst)          (cons (reverse a) (reverse b)))
      ((<= (car lst) pivot) (loop (cons (car lst) a) b (cdr lst)))
      (else                 (loop a (cons (car lst) b) (cdr lst))))))

(partition 12 '(4 9 18 6 19 10 18 11 5 5 7 2 4 19 1 9 10 18 12))
=> '((4 9 6 10 11 5 5 7 2 4 1 9 10 12) 18 19 18 19 18) 
```

# excel - LINEST 提供#VALUE！一些数据的错误

> ID：15024100
> 
> 赞同：1
> 
> 时间：2013-02-22T12:18:23.353
> 
> 标签：excel, excel-formula

我想知道是否有人对在 Excel (2010) 中使用 LINEST 有任何提示。查找指南很容易，但很难获得故障排除帮助。这可能不是完全正确的论坛，但这里的每个人都很有帮助，我忍不住要问。

我正在尝试使用 Excel LINEST 函数将三阶多项式拟合到一组数据。

`X_List: 44.00 45.50 46.30 46.80 47.50 47.90 48.60 49.90 51.20 51.80 52.30 53.00 53.40 54.30 55.70`

`Y_List: 0.10 1.00 3.00 5.00 10.00 15.00 25.00 50.00 75.00 85.00 90.00 95.00 97.00 99.00 99.90`

我使用的 LINEST 方程是：`=LINEST(Y_LIST, X_LIST^{1,2,3})`

这总是给我一个#VALUE！`^{1,2,3}`使用or`^{1,2}`但不使用时出错`^{1}`。这个相同的公式适用于另一个数据集，所以我知道这不是错字问题，当我制作数据图表并应用趋势线时，它给了我一个公式，所以它应该能够计算出*一些东西*。无论我是否使用“数组”输入方法，即带有选定范围的 ctrl-shift-enter，它都会执行此操作。

我认为我的数字存在一些我不理解的问题，或者可能是 Excel 2007 的语法已更改，因此该`^{1,2,3}`位不再按我预期的方式工作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T12:54:23.660

`Y_LIST`如果并且`X_LIST`是等长的数据**列**，您的公式应该有效- 如果它们是数据**行**，请尝试将 {1,2,3} 更改为 {1;2;3}，即

`=LINEST(Y_LIST, X_LIST^{1;2;3})`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-29T22:58:47.973

当其中一行为空白时，我有这个。空白行适用于趋势线（它会忽略它们），但`LINEST`只会显示`#VALUE!`，直到我删除所有空白。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-02T22:28:58.933

我最近遇到了同样的问题，linest`#VALUE`为某些数据集返回错误。在我的例子中，我正在使用数据拟合二次多项式`=LINEST(B2:B12,A2:A12^{0,1,2})`。但是，偷偷摸摸地，我在 A 列中的一个值是 0，所以 Excel 尝试做`0^0`，它给出了一个`#NUM`，这导致了`#VALUE`for `LINEST`。

我可以通过在工作表中实际计算`x^2`值并填写 1 值来解决这个问题，以配合我在 A 列中的 x。相反，我使用了一个`IFERROR`函数来捕获`#NUM`并返回 1, `=LINEST(B2:B12,IFERROR(A2:A12^{0,1,2,3,4,5,6},1))`。

与 OP 的问题不严格相关，但如果您正在寻找最简单的提示......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T13:00:59.493

啊。事实证明，这是 Excel 在如何对我背后的数据进行分类时遇到的一些问题。我从一个制表符分隔的文本文件中加载了这些数字，尽管我专门将单元格的格式更改为“数字”，但它似乎仍然将它们视为奇怪的东西。我在工作表的其他地方手动重新输入了相同的数字，效果很好。

在这种时候抱怨 Excel 很诱人，但它绝对胜过方格纸、铅笔和计算器。大多数时候。

感谢大家的帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-11-01T07:06:25.883

如果有人在 mac 中遇到 linest 问题，请尝试

```
1)  =(linest(select y, select x, true/false, true)

2) enter 

3 click on the value appeared press ctrl U

4) select your cells 

5) press ctrl shift return in mac keyboard 
```

你应该能够得到你的答案

干杯

# c++ - 调用第三方可执行文件时调试分段错误

> ID：15024102
> 
> 赞同：0
> 
> 时间：2013-02-22T12:18:27.153
> 
> 标签：c++, gdb, segmentation-fault

在 Rhel5 上，我在调用第三方 C++ 可执行文件时遇到分段错误。

不幸的是，我无法在启用了调试标志的情况下重新编译这个第三方可执行文件。因此，出于这个原因，不幸的是，来自分段错误的核心转储并没有为我们提供太多信息，gdb 和 valgrind 都没有。

例如，这里是 valgrind：

```
==4074== Process terminating with default action of signal 11 (SIGSEGV)                                                                                                              
==4074==  Access not within mapped region at address 0x7158E7F7                                                                                                                      
==4074==    at 0x7158E7F7: ???                                                                                                    
==4074==    by 0x6322203A22656D6E: ???                                                                                                                                               
==4074==    by 0x306C675F6E557267: ???                                                                                                                                               
==4074==    by 0x202C22373232302F: ???                                                                                                                                               
==4074==    by 0x6D616E656C696621: ???                                                                                                                                               
==4074==    by 0x72686322203A2264: ???                                                                                                                                               
==4074==    by 0x3030306C675F6E54: ???                                                                                                                                               
==4074==    by 0x346469702E373231: ???                                                                                                                                               
==4074==    by 0x646469662E34372F: ???                                                                                                                                               
==4074==    by 0x722E64616568656B: ???                                                                                                                                               
==4074==    by 0x63656D6F6C756764: ??? 
```

是否有任何方法（可能通过 lsof 或其他方式）向第三方供应商获取有关导致问题的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:14:02.153

我们使用 strace 找到了答案

尤其

```
strace -f -o strace.txt $myPath/bin/XMLForm $* ${MISSING_LOCALE} ORBtraceLevel 40 -ORBtraceThreadId 1 
```

这会生成一个包含所有低级 C-API 调用的 strace.txt 文件。

你不知道吗，就在分段错误之前……程序正在寻找一个不存在的日志文件。我们添加了那个日志，bam 没有更多的段错误。

# xslt - 如何同时移动 xml 元素和更改属性值？

> ID：15024104
> 
> 赞同：1
> 
> 时间：2013-02-22T12:18:34.477
> 
> 标签：xslt

我在根元素中有一系列后置元素，例如

```
<gliederung>
    <posten id=".." order="1">
        <posten id=".." order"1">
            <posten id=".." order"1">
                 ...
            </posten>
            <posten id="AB" order"2">
                 ...
            </posten>
             ...
        </posten>
        <posten id=".." order"2">
             ...
        </posten>
        <posten id="XY" order"3">
             ...
        </posten>
     ....   
</gliederung> 
```

每个 posten 都有一个唯一的 id 和一个 order 属性。现在我需要将 id 为“XY”的元素移动到 id 为“AB”的元素之前，并将移动的元素“XY”的 order 属性更改为“1.5”。

我设法使用以下脚本移动了元素：

```
 <xsl:template match="node()|@*" name="identity">
     <xsl:copy>
        <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
 </xsl:template>

<xsl:template match="posten[@id='AB']">
     <xsl:copy-of select="../posten[@id='XY']"/>
     <xsl:call-template name="identity"/>
 </xsl:template>

<xsl:template match="posten[@id='XY']"/> 
```

但是如何将移动与将订单属性值更改为“1.5”相结合？

我想我错过了一些明显的东西......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:30:40.397

而不是`copy-of`，使用模板

```
 <!-- almost-identity template, that does not apply templates to the
      posten[@id='XY'] -->
 <xsl:template match="node()|@*" name="identity">
     <xsl:copy>
        <xsl:apply-templates select="node()[not(self::posten[@id='XY'])]|@*"/>
    </xsl:copy>
 </xsl:template>

<xsl:template match="posten[@id='AB']">
     <!-- apply templates to the XY posten - this will copy it using the
          "identity" template above but will allow the specific template
          for its order attr to fire -->
     <xsl:apply-templates select="../posten[@id='XY']"/>
     <xsl:call-template name="identity"/>
 </xsl:template>

<!-- fix up the order value for XY -->
<xsl:template match="posten[@id='XY']/@order">
  <xsl:attribute name="order">1.5</xsl:attribute>
</xsl:template> 
```

如果您不确定 XY posten 相对于 AB 的确切位置（即它总是`../posten[@id='XY']`或有时可能是`../../`），那么您可以定义一个

```
<xsl:key name="postenById" match="posten" use="@id" /> 
```

然后`<xsl:apply-templates select="../posten[@id='XY']"/>`用

```
<xsl:apply-templates select="key('postenById', 'XY')"/> 
```

# ios - 从 URL 返回之前创建的 NSBundle 文件路径

> ID：15024106
> 
> 赞同：0
> 
> 时间：2013-02-22T12:18:42.013
> 
> 标签：ios

所以我得到了一个函数：

```
 + (NSString *)dataFilePath:(BOOL)forSave {
NSURL *url = [NSURL URLWithString:@"https://dl.dropbox.com/u/35612216/sample.xml"];
NSData *data = [NSData dataWithContentsOfURL:url];  // Load XML data from web

// construct path within our documents directory
NSString *applicationDocumentsDir = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject];
NSString *storePath = [applicationDocumentsDir stringByAppendingPathComponent:@"sample.xml"];

// write to file atomically (using temp file)
[data writeToFile:storePath atomically:TRUE];

return [[NSBundle mainBundle] pathForResource:storePath ofType:@"xml"];
//return [[NSBundle mainBundle] pathForResource:@"sample" ofType:@"xml"];

} 
```

这似乎不起作用，但是当我在我的项目（sample.xml）中添加一个支持文件并使用这一行时：

```
return [[NSBundle mainBundle] pathForResource:@"sample" ofType:@"xml"]; 
```

它会起作用的。但我需要从 url 而不是支持文件（资源文件）中获取我的 XML 数据

有人知道我该如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:33:08.583

该`NSBundle`方法从应用程序的包中加载文件，同时您已将文件保存到应用程序的 Documents 目录（它们是不同的位置）。

您需要做的就是`return storePath;`这将为您提供`NSString`文件所在位置的表示。

# python - 如何确保某个值会更频繁地出现在列表中

> ID：15024107
> 
> 赞同：-1
> 
> 时间：2013-02-22T12:18:42.527
> 
> 标签：python, list, loops

```
box_content=[[[1,2,4],[4,5,1]],[[2,3,1],[2,3,1]]]

def pop_a_message(box_content):
    send_message_index = random.randrange(len(box_content))
    receive_message_index = random.randrange(len(box_content) - 1) 
    if send_message_index >= receive_message_index: receive letter += 1    
    friend_message= random.randrange(len(send_message[0])) 
```

我可以更改此功能，以便从`send_message`将要选择的功能中，特定的`friend_message`（例如索引 [0] 中的朋友消息）会比其他功能更频繁地出现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:23:10.990

我认为您的问题可能类似于[Generate random numbers with a given (numerical) distribution](https://stackoverflow.com/questions/4265988/generate-random-numbers-with-a-given-numerical-distribution/)

正如 Sven Marnach 所建议的那样：

> [scipy.stats.rv_discrete](http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.rv_discrete.html)可能是你想要的。您可以通过 values 参数提供您的概率。然后，您可以使用分布对象的 rvs() 方法生成随机数。

如果您将此应用于您的列表`l`（假设您希望获得 56 50% 的时间）：

```
from scipy.stats import rv_discrete
l=[2,4,56,9]
vals = [l, (0.1, 0.2, 0.5, 0.2)]
custm = rv_discrete(name='custm', values=vals)
for i in l:
    yield generic.rvs(custm) 
```

不确定最后一行，但是如果您阅读文档，您会找到正确的方法。

# vb.net - Visual Studio 谷歌搜索和链接点击

> ID：15024118
> 
> 赞同：-4
> 
> 时间：2013-02-22T12:19:34.847
> 
> 标签：vb.net, visual-studio-2010, visual-studio

我可以做谷歌的搜索。但是，要增加我的站点，直到找到你的页面你已经找到了我的站点，然后我要点击我的站点。

```
Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
    Dim txtsearch As String
    txtsearch = kelime.Text
    txtsearch = "https://www.google.com.tr/search?q=" & txtsearch
    browser.Focus()
    ' From here I can not.

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:15:40.777

听起来您正在尝试编写一个程序来人为地提高您的 PageRank。我会为你节省一些时间——这行不通。有一些程序似乎确实能够提高 PageRank，但这是他们的开发人员和谷歌之间的猫捉老鼠游戏，以填补漏洞并确保程序不起作用。

如果我错了，并且您出于正当理由尝试执行上述操作，那么我建议您在结果页面加载后从浏览器源中获取您的 URL 的 URL（您需要处理加载的事件），如果它被发现模拟鼠标点击它。否则，请继续增加搜索 URL 中的页面属性。

# python - GAE Python LXML - 超过软私有内存限制

> ID：15024119
> 
> 赞同：0
> 
> 时间：2013-02-22T12:19:38.377
> 
> 标签：python, google-app-engine, memory, lxml

我正在获取 GZipped LXML 文件并尝试将产品条目写入数据库模型。以前我遇到了本地内存问题，通过 SO（[问题](https://stackoverflow.com/questions/14549565/gae-python-parsing-compressed-xml-exceeds-memory/14549999#comment20465149_14549999)）的帮助解决了这些问题。现在我让一切正常并部署了它，但是在服务器上我收到以下错误：

```
Exceeded soft private memory limit with 158.164 MB after servicing 0 requests total 
```

现在我尽我所能减少内存使用，目前正在使用下面的代码。GZipped 文件约为 7 MB，而解压缩后为 80 MB。在本地，代码运行良好。我尝试将它作为 HTTP 请求以及 Cron Job 运行，但没有任何区别。现在我想知道是否有任何方法可以提高效率。

SO上的一些类似问题参考了我不熟悉的前端和后端规范。我正在运行 GAE 的免费版本，这个任务必须每周运行一次。任何关于前进的最佳方式的建议将不胜感激。

```
from google.appengine.api.urlfetch import fetch
import gzip, base64, StringIO, datetime, webapp2
from lxml import etree
from google.appengine.ext import db

class GetProductCatalog(webapp2.RequestHandler):
  def get(self):
    user = XXX
    password = YYY
    url = 'URL'

    # fetch gziped file
    catalogResponse = fetch(url, headers={
        "Authorization": "Basic %s" % base64.b64encode(user + ':' + password)
    }, deadline=10000000)

    # the response content is in catalogResponse.content
    # un gzip the file
    f = StringIO.StringIO(catalogResponse.content)
    c = gzip.GzipFile(fileobj=f)
    content = c.read()

    # create something readable by lxml
    xml = StringIO.StringIO(content)

    # delete unnecesary variables
    del f
    del c
    del content

    # parse the file
    tree = etree.iterparse(xml, tag='product')

    for event, element in tree:
        if element.findtext('manufacturer') == 'New York':
            if Product.get_by_key_name(element.findtext('sku')):
                    coupon = Product.get_by_key_name(element.findtext('sku'))
                    if coupon.last_update_prov != datetime.datetime.strptime(element.findtext('lastupdated'), "%d/%m/%Y"):
                        coupon.restaurant_name = element.findtext('name')
                        coupon.restaurant_id = ''
                        coupon.address_street = element.findtext('keywords').split(',')[0]
                        coupon.address_city = element.findtext('manufacturer')
                        coupon.address_state = element.findtext('publisher')
                        coupon.address_zip = element.findtext('manufacturerid')
                        coupon.value = '$' + element.findtext('price') + ' for $' + element.findtext('retailprice')
                        coupon.restrictions = element.findtext('warranty')
                        coupon.url = element.findtext('buyurl')
                        if element.findtext('instock') == 'YES':
                            coupon.active = True
                        else:
                            coupon.active = False
                        coupon.last_update_prov = datetime.datetime.strptime(element.findtext('lastupdated'), "%d/%m/%Y")
                        coupon.put()
                    else:
                        pass
            else:
                    coupon = Product(key_name = element.findtext('sku'))
                    coupon.restaurant_name = element.findtext('name')
                    coupon.restaurant_id = ''
                    coupon.address_street = element.findtext('keywords').split(',')[0]
                    coupon.address_city = element.findtext('manufacturer')
                    coupon.address_state = element.findtext('publisher')
                    coupon.address_zip = element.findtext('manufacturerid')
                    coupon.value = '$' + element.findtext('price') + ' for $' + element.findtext('retailprice')
                    coupon.restrictions = element.findtext('warranty')
                    coupon.url = element.findtext('buyurl')
                    if element.findtext('instock') == 'YES':
                        coupon.active = True
                    else:
                        coupon.active = False

                    coupon.last_update_prov = datetime.datetime.strptime(element.findtext('lastupdated'), "%d/%m/%Y")
                    coupon.put()
        else:
            pass

        element.clear() 
```

**UDPATE**

根据保罗的建议，我实施了后端。经过一些麻烦后，它就像一个魅力 - 找到我在下面使用的代码。

我的 backends.yaml 如下所示：

```
backends:
- name: mybackend
  instances: 10
  start: mybackend.app
  options: dynamic 
```

而我的 app.yaml 如下：

```
handlers:
- url: /update/mybackend
  script: mybackend.app
  login: admin 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:24:58.490

后端就像前端实例，但它们不能扩展，您必须根据需要停止和启动它们（或将它们设置为动态，这可能是您最好的选择）。

您可以在后端拥有多达 1024MB 的内存，因此它可能适合您的任务。

[https://developers.google.com/appengine/docs/python/backends/overview](https://developers.google.com/appengine/docs/python/backends/overview)

> App Engine 后端是您的应用程序实例，它们不受请求期限的限制，并且可以访问比普通实例更多的内存（最高 1GB）和 CPU（最高 4.8GHz）。它们专为需要更快性能、大量可寻址内存以及连续或长时间运行的后台进程的应用程序而设计。后端有多种尺寸和配置，并按正常运行时间而不是 CPU 使用率计费。
> 
> 后端可以配置为驻留或动态。常驻后端持续运行，允许您依赖其内存状态随时间推移执行复杂的初始化。动态后端在收到请求时出现，在空闲时关闭；它们非常适合间歇性工作或由用户活动驱动的工作。有关常驻后端和动态后端之间差异的更多信息，请参阅后端类型以及启动和关闭的讨论。

这听起来正是您所需要的。免费使用级别也适合您的任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T13:33:17.733

关于后端：查看您提供的示例 - 似乎您的请求只是由前端实例处理。

要使其由后端处理，请尝试调用以下任务： http: [//mybackend.my_app_app_id.appspot.com/update/mybackend](http://mybackend.my_app_app_id.appspot.com/update/mybackend)

另外，我认为您可以删除：`start: mybackend.app`从您的`backends.yaml`

# asp.net - 当我单击其中一个按钮时，如何防止所有更新面板重新加载？

> ID：15024123
> 
> 赞同：3
> 
> 时间：2013-02-22T12:19:50.560
> 
> 标签：asp.net, vb.net, postback, updatepanel

我有一个带有两个更新面板的网络表单：

```
<asp:ScriptManager ID="ScriptManager1" runat="server" ScriptMode="Release">
    </asp:ScriptManager>

<p>
    <asp:UpdatePanel ID="upl1" runat="server">
        <ContentTemplate>
            <asp:Button runat="server" ID="btn1" Text="Button1" />
        </ContentTemplate>
    </asp:UpdatePanel>

    <asp:UpdatePanel ID="upl2" runat="server">
        <ContentTemplate>
            <asp:Button runat="server" id="btn2" Text="Button2" />
        </ContentTemplate>
    </asp:UpdatePanel>
</p> 
```

如果单击`btn1`，则`upl2`触发 的加载事件，以及`upl1`。

我希望只`upl1`加载，因为这是包含按钮的更新面板。

为什么没有发生这种情况，我怎样才能让它发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:04:21.903

我在使用更新面板时经常使用的一种做法是设置属性：

```
ChildrenAsTriggers="假" UpdateMode="条件"
```

并仅在需要时刷新更新面板：

```
protected void btn1_Click(object sender, EventArgs e)
{
    // some logic
    // ....
    upl1.Update();
} 
```

尝试应用这些属性，看看它是否能解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-19T06:41:12.190

我在按钮触发时遇到了类似的问题`UpdatePanel`，并且使用`ChildrenAsTriggers="false" UpdateMode="Conditional"`没有帮助。

我最终使用以下命令强制按钮执行常规回发：

```
 ScriptManager1.RegisterPostBackControl(btn1); 
```

# silverlight - Int64 类型的 DependencyProperty，在 XAML 中设置

> ID：15024127
> 
> 赞同：1
> 
> 时间：2013-02-22T12:19:55.347
> 
> 标签：silverlight, xaml, silverlight-4.0

我有 long 类型的 DependencyProperty ShowDelayProperty。在 XAML 中，我试图将这个属性设置为

```
<TextBox ... tooltip:ToolTipService.ShowDelay = "0" ... /> 
```

并得到例外：

> 无法从文本“0”创建“System.Int64”。[行：630 位置：172]

我也尝试使用 0L 有同样的例外。如何设置此属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:49:15.267

~~你有两个选择：~~

1.  为要在 XAML 中设置的类型实现[TypeConverter](http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverter%28v=vs.95%29.aspx)

~~2.使用长手二传手~~

 ~~```
 xmlns:system="clr-namespace:System;assembly=mscorlib"

     <TextBox>
         <tooltip:ToolTipService.ShowDelay>
             <system:Int64>0</system:Int64>
         </tooltip:ToolTipService.ShowDelay>
     </TextBox> 
```~~  ~~**编辑：**所以长手二传手不起作用。事实上，事实证明它们不适用于许多原始类型。[更多阅读](http://geekswithblogs.net/codingbloke/archive/2010/05/14/silverlight-iconvertible-typeconverter.aspx)

`Option 1 is still viable.`

除了长手二传手之外，还有另外两个选择：

1.  从后面的代码中添加资源并设置

    `tooltip:ToolTipService.ShowDelay = "{StaticResource MyResource}"`

2.  从代码中设置~~

# c# - 使用 Ninject 和 Ninject.Extensions.Nlog2 的空引用异常

> ID：15024130
> 
> 赞同：3
> 
> 时间：2013-02-22T12:19:59.243
> 
> 标签：c#, ninject, ninject-extensions

我有一个使用 Ninject、Ninject.Logging 和 Ninject.Extensions.NLog2 的简单控制台应用程序，它们都使用最新的 nuget 包构建。

我的应用程序执行以下操作

```
 _kernel = new StandardKernel();
 ILogger logger = _kernel.Get<ILogger>(); 
```

我`StandardKernel`在调用时从内部得到一个空引用异常`Get<ILogger>()`

```
System.NullReferenceException was unhandled by user code
  HResult=-2147467261
  Message=Object reference not set to an instance of an object.    
  Source=Ninject.Extensions.Logging
  StackTrace:
       at Ninject.Extensions.Logging.LoggerFactoryBase.GetLogger(IContext context) in     c:\Projects\Ninject\ninject.extensions.logging\src\Ninject.Extensions.Logging\LoggerFactoryBase.cs:line 61
   at Ninject.Extensions.Logging.LoggerModuleBase.<Load>b__0(IContext context) in c:\Projects\Ninject\ninject.extensions.logging\src\Ninject.Extensions.Logging\LoggerModuleBase.cs:line 26
   at Ninject.Activation.Providers.CallbackProvider`1.CreateInstance(IContext context) in c:\Projects\Ninject\ninject\src\Ninject\Activation\Providers\CallbackProvider.cs:line 45
   at Ninject.Activation.Provider`1.Create(IContext context) in c:\Projects\Ninject\ninject\src\Ninject\Activation\Provider.cs:line 38
   at Ninject.Activation.Context.Resolve() in c:\Projects\Ninject\ninject\src\Ninject\Activation\Context.cs:line 157
   at Ninject.KernelBase.<>c__DisplayClass10.<Resolve>b__c(IBinding binding) in c:\Projects\Ninject\ninject\src\Ninject\KernelBase.cs:line 386
   at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()
   at System.Linq.Enumerable.<CastIterator>d__b1`1.MoveNext()
   at System.Linq.Enumerable.Single[TSource](IEnumerable`1 source)
   at Ninject.ResolutionExtensions.Get[T](IResolutionRoot root, IParameter[] parameters) in c:\Projects\Ninject\ninject\src\Ninject\Syntax\ResolutionExtensions.cs:line 37 
```

我还需要进行更多配置才能使日志记录正常工作吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T12:43:38.883

你不应该直接要求一个`ILogger`（虽然错误信息可能会更好一点），但你应该解决一个`ILoggerFactory`并且你可以从那里要求一个`ILogger`

```
_kernel = new StandardKernel();
ILoggerFactory loggerFactory = _kernel.Get<ILoggerFactory>();
ILogger logger = loggerFactory.GetCurrentClassLogger(); 
```

另请参阅文档[自己请求记录器](https://github.com/ninject/ninject.extensions.logging/wiki/Using)部分。

# wpf - 如何在父尺寸动画期间停止子控件布局更新

> ID：15024133
> 
> 赞同：2
> 
> 时间：2013-02-22T12:20:24.423
> 
> 标签：wpf

我通过`Border`在窗口一侧创建一个窄控件来创建“弹出”效果。当鼠标移到控件上时，我触发了一个故事板，它增加了它的宽度以完全显示它。

问题是，随着边框尺寸的增加，您会看到子控件的布局不断更新。在动画完成之前有什么方法可以防止这种情况发生吗？

# node.js - 如何根据MongoDB中的对象属性删除数组中的对象？

> ID：15024135
> 
> 赞同：0
> 
> 时间：2013-02-22T12:20:30.423
> 
> 标签：node.js, mongodb

这是我的 mongodb 文档。

```
"_id" : ObjectId("5123731f2763c9682a000001"),
"created_on" : ISODate("2013-02-19T12:42:07.835Z"),
"currentLogin" : ISODate("2013-02-22T06:03:25.603Z"),
"email" : "xxx@test.com",
"extraPhotos" : 0,
"reqmail" : [ ],
"isActivated" : true,
"lastLogin" : ISODate("2013-02-20T05:42:15.359Z"),
"linkedAccounts" : [
    {
        "birthday" : "11/01/1984",
        "email" : "testingxxx234@gmail.com",
        "expiresIn" : "5184000",
        "expiryMailNotifFlag" : -1,
        "extraPhotos" : 0,
        "fetchFromDate" : null,
        "fetchOrder" : "oldest",
        "fetchUntilDate" : "04/11/2014",
        "locale" : "en_US",
        "optIn" : true,
        "timezone" : "5.5",
        "userID" : "100000207309657"
    }
],
"maxLinkedAccounts" : 4,
"name" : "venu wale",
"notifications" : [
    {
        "_id" : ObjectId("51275fb7389b85f222000001"),
        "type" : "limitUsed",
        "message" : "Account limit is used",
        "accID" : "100000207309657",
        "date" : ISODate("2013-02-22T12:08:23.419Z")
    },
    {
        "_id" : ObjectId("51275fe8389b85f222000002"),
        "type" : "limitUsed",
        "message" : "Account limit is used",
        "accID" : "100000207309657",
        "date" : ISODate("2013-02-22T12:09:12.385Z")
    },
    {
        "_id" : ObjectId("51276020389b85f222000003"),
        "type" : "limitUsed",
        "message" : "Account limit is used",
        "accID" : "100000207309657",
        "date" : ISODate("2013-02-22T12:10:08.275Z")
    },
    {
        "_id" : ObjectId("5127605d389b85f222000004"),
        "type" : "limitUsed",
        "message" : "Account limit is used",
        "accID" : "100000207309657",
        "date" : ISODate("2013-02-22T12:11:09.946Z")
    },
    {
        "_id" : ObjectId("51276097389b85f222000005"),
        "type" : "limitUsed",
        "message" : "Account limit is used",
        "accID" : "100000207309657",
        "date" : ISODate("2013-02-22T12:12:07.384Z")
    },
    {
        "_id" : ObjectId("512760d2389b85f222000006"),
        "type" : "limitUsed",
        "message" : "Account limit is used",
        "accID" : "100000207309657",
        "date" : ISODate("2013-02-22T12:13:06.933Z")
    }
],
"password" : "638cfc167e8431c01227e4f113ec9427821b12493ed6fd3",
"phone" : "5555555555",
"photo_updated_time" : 1361341819,
"photosProcessed" : 15,
"photosToProcess" : 400,
"plan" : {
    "type" : "photoOnly"
},
"salt" : "af8ab2f5866642f03d31aa3f4a24e25e287bedc7",
"updated_on" : ISODate("2013-02-19T12:42:07.835Z") 
```

我想从通知数组中删除任何一个对象。我正在使用这个查询。

db.users.update({phone:'5555555555'},{$unset:{notifications:{$elemMatch:{_id:ObjectId('51276020389b85f222000003')}}}})

但它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T12:39:58.367

您只需要从数组中[提取](http://docs.mongodb.org/manual/reference/operator/pull/#_S_pull)此元素：`notifications`

```
db.collection.update({phone:"5555555555"},{$pull:{notifications: {_id:ObjectId("51276020389b85f222000003")}}}) 
```

使用 pull，您可以删除与您的内部查询匹配的所有元素。下一个 $pull

```
{$pull:{ notifications: {type: "limitUsed"}}} 
```

将删除所有类型为“limitUsed”的通知。

# c# - 组合框 OwnerDrawFixed - 滚动非常快

> ID：15024136
> 
> 赞同：0
> 
> 时间：2013-02-22T12:20:40.180
> 
> 标签：c#, winforms

我编写了以下代码来增加项目的高度。完成此操作后，在滚动组合时，与普通组合框相比，它以非常高的速度移动。我该如何解决这个问题？

我已将绘图模式设置为 DrawMode.OwnerDrawFixed；

```
 private void comboBox1_DrawItem(object sender, DrawItemEventArgs e)
    {           
        e.DrawBackground();
        System.Diagnostics.Debug.WriteLine(e.State);
        if (e.Index < 0)
        {
            return;
        }       
        SizeF stringMeasure = e.Graphics.MeasureString(this.Items[e.Index].ToString(), e.Font);
        Rectangle rec = new Rectangle(e.Bounds.Left, e.Bounds.Top + ((e.Bounds.Height - ItemHeight)/2 ), e.Bounds.Width, ItemHeight);
        e.Graphics.DrawString(this.Items[e.Index].ToString(), e.Font, new SolidBrush(this.ForeColor), rec);
        e.DrawFocusRectangle();
    }

    private void comboBox1_MeasureItem(object sender, MeasureItemEventArgs e)
    {
        e.ItemHeight = this.ItemHeight * 2; ;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:06:52.960

仅当为 OwnerDrawVariable 设置 DrawMode 时才会调用 MeasureItem 事件。

因此，您需要将 DrawMode 更改为 OwnerDrawVariable，或者将 ComboBox 的 ItemHeight 属性设置为`this.ItemHeight * 2`

不确定滚动速度，这可能只是您的操作系统。我没有注意到太大的区别——你没有使用你的`stringMeasure`变量，所以你可以把它注释掉。

# c# - 白色 UI 自动化 C# 加载 White.Core 程序集失败

> ID：15024140
> 
> 赞同：0
> 
> 时间：2013-02-22T12:21:05.177
> 
> 标签：c#, ui-automation, white-framework

我试图运行一个简单的示例来启动 Windows 计算器并做一些事情：

[White：Windows 应用程序的 UI 自动化工具](http://www.codeproject.com/Articles/289028/White-An-UI-Automation-tool-for-windows-applicatio)

上面链接的 Saldy 很旧，所以我从另一个示例中改编了代码：

[面向测试人员的 White Windows UI 自动化入门教程](http://www.tellingmachine.com/post/The-White-Windows-UI-automation-getting-started-tutorial-for-testers.aspx)

我的简单代码现在看起来像：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Web;
using White.Core;
using White.Core.UIItems;
using White.Core.UIItems.WindowItems;
using White.Core.UIItems.WindowStripControls;
using White.Core.UIItems.MenuItems;
using White.Core.UIItems.TreeItems;
using White.Core.UIItems.Finders;

namespace TestWhiteCalculator
{
    class Program
    {
        static void Main(string[] args)
        {
            Application manager = Application.Launch(@"C:\Windows\system32\calc.exe");

            Window mainWindow = manager.GetWindow("Rechner");
        }
    }
} 
```

我还添加了`WhiteCore.dll`参考。

我仍然收到一个错误：

> 警告：无法解析引用的程序集“White.Core”，因为它依赖于“System.Web，Version=4.0.0.0，Culture=neutral，PublicKeyToken=b03f5f7f11d50a3a”，它不在当前目标框架“.NETFramework”中,版本=v4.0,配置文件=客户端”。请删除对不在目标框架中的程序集的引用，或考虑重新定位您的项目。

`White.Core`因此，由于缺少`System.Web`参考，加载存在问题。

有任何想法吗？这是我的 .NET 安装的问题吗？

* * *

找到了解决方案：

[在 .net 4.0 版本上找不到 System.Web 程序集](https://stackoverflow.com/q/7694380/146622)

您必须将 .NET 框架配置文件从 .NET 4.0 客户端更改为 .Net 4.0（完整）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:25:45.157

我认为您需要添加对`System.Web.dll`项目引用的引用。如果找不到，则可能必须[选择不同的框架配置文件](https://stackoverflow.com/questions/4981204/net-framework-4-client-profile-system-web-dll)。

# sql-server - 视觉工作室 - 没有足够的存储空间来完成

> ID：15024143
> 
> 赞同：0
> 
> 时间：2013-02-22T12:21:19.343
> 
> 标签：sql-server, wpf, visual-studio-2010

我正在开发一个 wpf 应用程序，我从 sql 服务器加载我的图像路径，而不是将所有图像保存在解决方案下的文件夹中。构建后我的图像大约有 200MB，我的视觉工作室开始给我一个错误，“没有足够的存储空间来完成这个过程”。

顺便说一句，从数据库显示图像的最佳方式是什么，我应该在解决方案下复制它还是有任何其他方式可以链接图像。

任何帮助表示赞赏

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:11:25.807

It's possible that you setup publishing or making deployment package or something of that kind and VS tries to copy all your media files to another location without enough free space.

You can look at [FILESTREAM](http://msdn.microsoft.com/en-us/library/bb933993%28v=sql.105%29.aspx) - also check this and other articles for recomendations on particular case.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-06T06:41:49.593

请在开始此操作之前关闭 Visual Studio

1.  以管理员身份启动 Visual Studio 命令提示符。
2.  键入“BCDEDIT /Set increaseUserVa 3072” - 它将更改引导配置，以便用户模式内存向前发展为 3GB。
3.  将目录更改为 devenv.exe 所在的位置：C:\Program Files\Microsoft Visual Studio 9\Common7\IDE\
4.  键入 editbin /LARGEADDRESSAWARE devenv.exe
5.  重启你的电脑。

像这样的命令行：

> BCDEDIT /Set increaseUserVa 3072（按回车键）
> editbin /LARGEADDRESSAWARE devenv.exe（按回车键）

现在重新启动您的机器。

# java - Apache POI 空白值

> ID：15024147
> 
> 赞同：2
> 
> 时间：2013-02-22T12:21:38.303
> 
> 标签：java, apache-poi

我正在使用`Apache POI`将数据导入`excel file`到`database`.(新手到 APACHE POI)

在其中我允许用户从 excel 表中选择列并将这些列映射到数据库列。映射列后，当我尝试从那时插入记录`Excel`时`Database`：

*   如果其中包含`NO blank`值的列被映射，则将适当的数据插入数据库
*   如果列映射了其中的`BLANK`值，则如果 a`Excel Cell`具有空白值，`column`则分配该值的前一个值。

**源代码：**

```
FileInputStream file = new FileInputStream(new File("C:/Temp.xls"));
HSSFWorkbook workbook = new HSSFWorkbook(file); //Get the workbook instance for XLS file
HSSFSheet sheet = workbook.getSheetAt(0);   //Get first sheet from the workbook
Iterator<Row> rowIterator = sheet.iterator(); //Iterate through each rows from first sheet
while (rowIterator.hasNext())
{
  HSSFRow hssfRow = (HSSFRow) rowIterator.next();
  Iterator<Cell> iterator = hssfRow.cellIterator();
  int current = 0, next = 1;
  while (iterator.hasNext())
  {
    HSSFCell hssfCell = (HSSFCell) iterator.next();
    current = hssfCell.getColumnIndex();
    for(int i=0;i<arrIndex.length;i++)    //arrayIndex is array of Excel cell Indexes selected by the user
    {
      if(arrIndex[i] == hssfCell.getColumnIndex())
      {
        if(current<next) 
        {
                    //System.out.println("Condition Satisfied");     
        }
        else 
        {
          System.out.println( "pstmt.setString("+next+",null);");
          pstmt.setString(next,null);
          next = next + 1;
        }
        System.out.println( "pstmt.setString("+next+","+((Object)hssfCell).toString()+");");
        pstmt.setString(next,((Object)hssfCell).toString());
        next = next + 1;
      }
    }
  }
  pstmt.addBatch();
  } 
```

我已经在 SO 上寻找类似的问题，但仍然无法解决问题。所以任何帮助将不胜感激。

提前致谢..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T14:19:00.300

你犯了一个非常常见的错误，在过去的很多 StackOverflow 问题中都涉及到了这个错误

正如[关于单元迭代的 Apache POI 文档所说](http://poi.apache.org/spreadsheet/quick-guide.html#Iterator)

> 在某些情况下，在迭代时，您需要完全控制缺失或空白单元格的处理方式，并且您需要确保访问每个单元格，而不仅仅是文件中定义的单元格。（CellIterator 将只返回文件中定义的单元格，主要是那些具有值或样式的单元格，但这取决于 Excel）。

听起来您处于那种情况，您需要关心击中每一行/单元格，而不仅仅是抓住所有可用的单元格而不担心间隙

您需要更改您的代码，使其看起来[有点像 POI 文档中的示例](http://poi.apache.org/spreadsheet/quick-guide.html#Iterator)：

```
// Decide which rows to process
int rowStart = Math.min(15, sheet.getFirstRowNum());
int rowEnd = Math.max(1400, sheet.getLastRowNum());

for (int rowNum = rowStart; rowNum < rowEnd; rowNum++) {
   Row r = sheet.getRow(rowNum);

   int lastColumn = Math.max(r.getLastCellNum(), MY_MINIMUM_COLUMN_COUNT);

   for (int cn = 0; cn < lastColumn; cn++) {
      Cell c = r.getCell(cn, Row.RETURN_BLANK_AS_NULL);
      if (c == null) {
         // The spreadsheet is empty in this cell
         // Mark it as blank in the database if needed
      } else {
         // Do something useful with the cell's contents
      }
   }
} 
```

# visual-studio-2008 - 在 Windows Mobile 设备上使用 Mono.Cecil 和 .NET CompactFramework

> ID：15024160
> 
> 赞同：3
> 
> 时间：2013-02-22T12:22:24.193
> 
> 标签：visual-studio-2008, windows-mobile, compact-framework, mono.cecil

我正在尝试移植 Mono.Cecil 以在[Windows Mobile 6](https://en.wikipedia.org/wiki/Windows_Mobile_6.0)设备上使用 .NET CompactFramework 3.5。首先，我必须对 Mono.Cecil 的源代码进行一些奇怪的调整（来自[其 GitHub](https://github.com/jbevain/cecil)页面，提交：ec2a54fb00）。试图理解为什么需要这些调整让我有点惊讶。

**第一个变化：** Mono.Cecil 的源代码有表达式，对 System.Array 类型的对象调用“IsNullOrEmpty()”方法。但是，这种方法在微软实现的.NET框架中根本不存在。因此，代码无法编译。因此，我向 System.Array 类添加了一个扩展方法：

```
static class ArrayExtensions
{
    public static bool IsNullOrEmpty(this System.Array a)
    {
        return a.Length == 0;
    }
} 
```

**第二个变化：** Mono.Cecil 的源代码尝试在 System.String 类型的对象上调用“ToLowerInvariant()”方法。但是，CompactFramework 中不存在这样的方法。所以这是第二个调整：

```
static class StringExtensions
{
#if PocketPC
    public static string ToLowerInvariant(this String a)
    {
        return a.ToLower();
    }
#endif
} 
```

在这里，我只是将对“ToLowerInvariant”方法的调用转发给 String 类的“ToLower”方法。

我在 Visual Studio 2008 中使用上述更改构建了 Mono.Cecil 的源代码，并定义了以下编译符号：

```
PocketPC
CF 
```

接下来，我需要测试使用上述步骤构建的 Mono.Cecil DLL 文件。我的方法是读取一个程序集并用不同的名称重新创建它。为此，我创建了一个可以在 Windows Mobile 设备上运行的简单应用程序，并将其命名为**SmartDeviceProject1.exe**。我阅读了与此应用程序对应的程序集，并用不同的名称将其写了出来：

```
using System;
using System.Linq;
using System.Collections.Generic;
using System.Windows.Forms;
using Mono.Cecil;

namespace SmartDeviceProject3
{
    static class Program
    {
        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [MTAThread]
        static void Main()
        {
            var assemblyDef = AssemblyDefinition.ReadAssembly(@"\Program Files\SmartDeviceProject1\SmartDeviceProject1.exe");
            assemblyDef.Write(@"\Program Files\SmartDeviceProject1\SmartDeviceProject1New.exe");
        }
    }
} 
```

新程序集称为***SmartDeviceProject1New.exe***。当我尝试在 Windows Mobile 设备上运行新应用程序*SmartDeviceProject1New.exe*时，它​​无法运行。错误消息报告该文件不是有效的 PocketPC 应用程序。

我是不是哪里出错了？

PS：但是，使用我在上面构建的 Mono.Cecil DLL 文件，我能够浏览[CIL](http://en.wikipedia.org/wiki/Common_Intermediate_Language)代码并检查它的不同方面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T06:15:11.100

我假设您构建的 Mono Cecil 仍在引用完整的框架系统程序集，因此不会加载到 Compact Framework 程序集中。

当我将 iTextSharp 移植到紧凑框架时，我在一个 Visual Studio 会话中打开了 iTextSharp 源代码，并在另一个新的紧凑框架 (C# SmartDevice) 项目会话中启动了一个新的 iTextSharpCF。

然后，我在新的 Compact Framework 项目中添加了所有代码文件和子目录，因为它们已加载到原始完整框架项目中。

复制完所有文件后，我必须添加在 Compact Framework 项目中使用的相应 Compact Framework 程序集。

然后尝试编译 Compact Framework 版本并重写或添加代码以使 Compact Framework 项目构建成功。最后，您将获得一个仅引用 Compact Framework 程序集并将在智能设备上运行的 Compact Framework 程序集。

MS 构建系统不是那么灵活，您可以将完整的框架项目切换到 Compact Framework 项目，只需设置编译器指令即可。

# sql - SQL where 子句使用 MAX Effective Date 和 NULL 值

> ID：15024163
> 
> 赞同：1
> 
> 时间：2013-02-22T12:22:26.837
> 
> 标签：sql, oracle, null

我正在使用后端软件在 Oracle 上运行 SQL。我需要根据生效日期获取最新行。

这是一个示例表

```
Table "ACCOUNTS"
Application | Sub_category | Account_Reference | Effective_date
BC_ONLINE   | F            | ABC1234           | 01-JAN-13
BC_ONLINE   | B            | ABC2345           | 01-JAN-13
TE_Notice   | (NULL)       | 1234ABC           | 01-JAN-13
TE_Notice   | (NULL)       | 9876DEF           | 01-APR-13 
```

软件会传入两个参数：Application和Sub_category，如果我使用下面的SQL，在下面的Application：**BC_ONLINE**和Sub_category：**F**

```
select a.Account_Reference
from   ACCOUNTS a
where  a.Application = 'BC_ONLINE'
and    a.Sub_category = 'F'
and    a.Effective_date = (select max(b.Effective_date)
                           from   ACCOUNTS b
                           where  b.Effective_date <= sysdate
                           and    b.Application = a.Application
                           and    b.Sub_category = a.Sub_category) 
```

但是我应该使用以下应用程序：**TE_Notice**和 Sub_category: **NULL** 并且你不能拥有这个

```
and    a.Sub_category = null 
```

因为它必须是

```
and    a.Sub_category is null 
```

问题是软件是固定的，那么在使用 max(effective_date) 的 where 子句中同时使用 value 和 null 的最佳方法是什么？

我试过这个方法，但它不起作用

```
select a.Account_Reference
from   ACCOUNTS a
where  a.Application = 'TE_Notice'
and    (a.Sub_category = '' or a.Sub_category is null)
and    a.Effective_date = (select max(b.Effective_date)
                           from   ACCOUNTS b
                           where  b.Effective_date <= sysdate
                           and    b.Application = a.Application
                           and    NVL(b.Sub_category,-1) = NVL(a.Sub_category,-1)) 
```

它只是返回了**01-APR-13**的行，但我应该在**01-JAN-13**上得到 Effective_date 的行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:42:31.657

怎么样：

```
 select account_reference
 from   (
        select   a.Account_Reference
        from     ACCOUNTS a
        where    a.Application = 'BC_ONLINE'
        and      a.Sub_category = 'F'
        and      a.effective_date <= sysdate
        order by a.Effective_date desc)
 where  rownum = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:35:02.807

感谢@AlexPoole，我提出的问题实际上是正确的，但需要完善。

如果我采用以下内容：

```
and (a.Sub_category = '' or a.Sub_category is null) 
```

选择会获取空行以及非空值，因此需要改进；

```
and (a.Sub_category = '' or ('' is null and a.Sub_category is null)) 
```

整体SQL应该是

```
select a.Account_Reference
from   ACCOUNTS a
where  a.Application = @Application
and    (a.Sub_category = @Sub_category or (@Sub_category is null and a.Sub_category is null))
and    a.Effective_date = (select max(b.Effective_date)
                           from   ACCOUNTS b
                           where  b.Effective_date <= sysdate
                           and    b.Application = a.Application
                           and    NVL(b.Sub_category,-1) = NVL(a.Sub_category,-1)) 
```

# vb.net - 在VB.net中获取DateTimePicker的月份点击

> ID：15024164
> 
> 赞同：4
> 
> 时间：2013-02-22T12:22:27.467
> 
> 标签：vb.net, datetimepicker

如何检查 DateTimePicker 的月份箭头单击事件。当我试图更改 datetimepicker 的月份时，它会给出下个月的第一个日期，所以我必须阻止那个月的点击。

请看图片：

![在此处输入图像描述](../Images/f41826dcbc170cb2bbfaf2ed6ca44cbb.png)

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T18:34:11.230

混合使用 CloseUp 和 DropDown 事件和绑定数据可能是解决方案

```
Imports System.Windows.Forms

Namespace WindowsFormsApplication1
    Public Partial Class Form1
        Inherits Form
        Private isDropedDown As Boolean
        Private m_dataSale As DateTime = DateTime.Now
        Public Property DataSale() As DateTime
            Get
                Return m_dataSale
            End Get
            Set
                If isDropedDown Then
                    If m_dataSale.[Date].AddMonths(1).[Date] = value.[Date] OrElse m_dataSale.[Date].AddMonths(-1).[Date] = value.[Date] OrElse New DateTime(m_dataSale.Year, m_dataSale.Month, 1).AddMonths(1).[Date] = value.[Date] OrElse New DateTime(m_dataSale.Year, m_dataSale.Month, 1).AddMonths(-1).[Date] = value.[Date] Then
                        MessageBox.Show("Month is changing")
                    End If
                End If

                m_dataSale = value
            End Set
        End Property

        Public Sub New()
            InitializeComponent()
            Dim binding = dateTimePicker1.DataBindings.Add("Value", Me, "DataSale")
            binding.DataSourceUpdateMode = DataSourceUpdateMode.OnPropertyChanged
        End Sub
        Private Sub dateTimePicker1_CloseUp(sender As Object, e As EventArgs)
            isDropedDown = False
        End Sub

        Private Sub dateTimePicker1_DropDown(sender As Object, e As EventArgs)
            isDropedDown = True
        End Sub
    End Class
End Namespace 
```

# ios - 故事板中 UINavigationController 的弹出框大小

> ID：15024170
> 
> 赞同：5
> 
> 时间：2013-02-22T12:23:02.303
> 
> 标签：ios, xcode, uinavigationcontroller, storyboard, uipopovercontroller

我创建了一个 iPad 应用程序，其中包含嵌入在导航控制器中的弹出视图。我喜欢尽可能多地使用 Storyboard，并`"Use Explicit Size"`在 Xcode 中设置让我在 iPad 上弹出窗口的正确大小。但是在 Xcode 中查看情节提要时，它不会调整`UINavigationController`视图及其嵌入的大小。`UIViewControllers`

这很烦人，因为我在 Xcode 中的视图大小与弹出框的实际大小不对应。

所以，我的问题是没有设置正确的弹出框大小（我也知道我可以用代码做到这一点），但我希望情节提要中的视图显示我的视图的实际大小。

使用情节提要创建嵌入在导航控制器中的视图控制器的正确方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-24T21:38:42.473

对于嵌入在导航控制器中的视图，您可以通过执行以下操作更改它们在情节提要中的大小：

1.  选择视图控制器。
2.  转到 Simulated Metrics 下的 Attributes Inspector 并选择 Size: Freeform。
3.  选择视图控制器的视图。
4.  转到尺寸检查器并更改宽度和高度。

之后，应该在情节提要中正确调整视图的大小。

不幸的是，我不知道如何更改导航控制器的大小。

# c# - 在 MapReduce 中使用 Windows Azure 存储执行 Reduce 函数后无法看到最终结果

> ID：15024173
> 
> 赞同：1
> 
> 时间：2013-02-22T12:23:25.540
> 
> 标签：c#, hadoop, azure-storage, hadoop-streaming

我`c#.net`用于编写 map 和 reduce 函数。我基本上遵循了[这里给出的示例](https://www.hadooponazure.com/Account/SampleDetail/84)

*最终命令*

**Hadoop jar hadoop-streaming.jar -files "hdfs:///example/apps/map.exe,hdfs:///example/apps/reduce.exe" -input "/example/apps/data.csv" -output “/example/apps/output.txt” -mapper “map.exe” -reducer “reduce.exe”**

作业成功运行![在此处输入图像描述](../Images/e3e4aa389610c0e208c0737def0d3fb5.png)

现在从交互式 JS 模式，如果我写

```
js> #cat /example/apps/output.txt 
```

**cat：文件不存在：/example/apps/output.txt**

然而 ：

```
js> #ls /example/apps/output.txt 
```

找到 3 件商品

```
-rw-r--r-- 3 xxxx supergroup 0 2013-02-22 10:23 /example/apps/output.txt/_SUCCESS

drwxr-xr-x - xxxx supergroup 0 2013-02-22 10:22 /example/apps/output.txt/_logs

-rw-r--r-- 3 xxxx supergroup 0 2013-02-22 10:23 /example/apps/output.txt/part-00000 
```

我犯了什么错误，如何查看输出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T05:26:55.330

该`-output`标志指定输出文件夹，而不是文件。由于可以有多个reducer，每个reducer都会在这个文件夹中生成一个文件。

在这种情况下，您有一个 reducer，它生成了一个文件：`part-00000`. 如果有更多的 reducer，它们将被命名为`part-00001`,`part-00002`等。

该命令`cat /example/apps/output.txt/part-00000`将显示您的输出。将来，不要命名您的输出文件夹`something.txt`，因为这只会让您和其他人感到困惑:)

# python - 是否有一种编程方式来查找系列的开始和结束？

> ID：15024175
> 
> 赞同：-1
> 
> 时间：2013-02-22T12:23:27.953
> 
> 标签：python, math, linear-algebra

我有一个等距的数字，如下所示：

```
x 1 2 3 4 y 
```

我不知道开始和结束值`x`和`y`. `x`可以大于`y`或反之亦然。我只知道中间值的值及其在列表中的顺序，即`1`索引为`1`(`x`的索引为`0`)，`2`索引为`2`，依此类推。

我也知道中间有多少个数字，在这种情况下是 4 个。

有没有办法制定这个，所以我可以找到`x`并`y`使用这些信息？

编辑：更多信息：

```
x != y 
```

`x > y`或者`y > x`

该程序使用`x`并`y`给定请求的项目数量生成中间的数字。所以从 x 到 y 的线性插值，对每个值使用相同的增量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:16:53.457

如果我理解正确，您需要线性外推之类的东西。尝试这个：

```
def get_xy(values):
    assert(len(values) >= 2)
    #(v1) use the first gain
    m = values[1] - values[0]
    #(v2) calculate the mean-gain
    #     (avg of v[i+1]-v[i])
    m = sum(float(x-y) for x,y in zip(values[1:], values[:-2])) / (len(values) - 1)
    return (values[0] - 1*m, values[-1] + 1*m)

print get_xy([ 1, 2, 3, 4])
print get_xy([-1,-2,-3,-4])
x,y = get_xy([ 1, 2, 3, 4])
print x,y # if you are unfamilar with tuples 
```

`v(1)`更胖，但只有在每个元素都增加/减少相同的值时才会起作用（`a(n+1) - a(n) == a(n+2) - a(n+1)`对于所有`n`如果`a`是你的序列）。`v(2)`将计算所有元素的平均增益。请注意，这些值被转换为浮点数。

# iphone - 检测CALayer上的点击触摸

> ID：15024177
> 
> 赞同：0
> 
> 时间：2013-02-22T12:23:38.790
> 
> 标签：iphone, ios, objective-c, calayer, quartz-core

我的设置如下

```
- UIView
    - CALayer (container)
        -CAShapeLayer
        -CAShapeLayer
        -.. 
```

我想检测每个shapelayer上的点击触摸来改变它的颜色

`UITapGestureRecognizer`我已经放了一个`UIView`并有以下代码

```
CGPoint point = [self tapWithPoint:[recognizer locationInView:pieView]];

PieSliceLayer* layerThatWasTapped = (PieSliceLayer *)[_containerLayer hitTest:point];
[(PieSliceLayer *)[layerThatWasTapped modelLayer] setFillColor:UIColor.redColor]; 
```

但它似乎只改变 1 CAShapeLayer 总是第一个添加的。

# java - 更改 Accordion 图标和位置 JavaFX

> ID：15024178
> 
> 赞同：0
> 
> 时间：2013-02-22T12:23:38.723
> 
> 标签：java, css, javafx

我用`JavaFx`with `Scene Builder`，我是新手，我想改变图标`accordion`及其位置，就像那个图像；我找到了这个**`CSS`**，但我做不到；

```
.titled-pane .title{
-fx-background-radius: 30;
-fx-background-image:url('ac.jpg');
} 
```

![在此处输入图像描述](../Images/48dbd5f717216b8afcd95c2322448df7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-10T16:22:49.480

这很容易，只需将 Hbox 添加到标题并在添加您想要的内容之后立即设置对齐（按钮，ImageView）

```
 <TitledPane animated="false" collapsible="false" contentDisplay="RIGHT" layoutX="900.0" layoutY="500.0" prefHeight="206.0" prefWidth="431.0" stylesheets="@menu.css" text="Message" textFill="WHITE">
    <content>
      <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0" />
    </content>
     <font>
        <Font name="Arial Bold" size="12.0" />
     </font>
     <graphic>
        <HBox alignment="TOP_RIGHT" prefHeight="24.0" prefWidth="352.0">
           <children>
              <ImageView fitHeight="21.0" fitWidth="18.0" pickOnBounds="true" preserveRatio="true" />
           </children>
        </HBox>
     </graphic>
  </TitledPane> 
```

# jquery - 在 ASP.NET MVC 4 中使用自定义 jquery 验证插件

> ID：15024180
> 
> 赞同：-1
> 
> 时间：2013-02-22T12:23:40.790
> 
> 标签：jquery, asp.net, asp.net-mvc, jquery-validate, unobtrusive-validation

我一直想知道我们如何在`ASP.NET` `MVC 4`. 我在网上搜索过，但我只找到了如何创建新的验证规则来创建新的属性。这里的问题是另一个：那里有很多验证插件，但是如何使用它们`ASP.NET MVC 4`呢？默认情况下，框架使用简单的验证来获取消息并将其显示在字段的一侧，但是如何使用其他插件？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:45:10.343

您可能想看看这个[http://thewayofcode.wordpress.com/2012/01/18/custom-unobtrusive-jquery-validation-with-data-annotations-in-mvc-3/](http://thewayofcode.wordpress.com/2012/01/18/custom-unobtrusive-jquery-validation-with-data-annotations-in-mvc-3/)和这个[http： //fluentvalidation.codeplex.com/wikipage?title=Custom&referringTitle=Documentation&ANCHOR#CustomValidator](http://fluentvalidation.codeplex.com/wikipage?title=Custom&referringTitle=Documentation&ANCHOR#CustomValidator)然后尝试做出自己的适应。

# email - 如何使用 w3m 在 RMAIL 消息中呈现 HTML 内容？

> ID：15024182
> 
> 赞同：4
> 
> 时间：2013-02-22T12:23:45.183
> 
> 标签：email, emacs

我如何使用 w3m 或其他方法在 RMAIL 消息中显示 HTML 内容，或者至少在外部 Web 浏览器中打开其 MIME 部分？

我找到的唯一解决方案是在 EmacsWiki 中，但它是 1996 年的代码，对我不起作用。至少在 Emacs 24 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T16:54:14.937

好的。这个怎么样？

```

(defun buffer-html-to-w3m ()
  "使用 W3M 查看当前 rmail 中的 HTML。

您必须安装 W3M 才能正常工作。”
  （交互的）
  （让（（主题（邮件获取字段“主题”）））
    （什么时候
        （字符串匹配-p
         “文本/html。*”
         （邮件获取字段“内容类型”））
      （保存游览
        (goto-char (point-min))
        (let ((pt (re-search-forward "\n<html>" nil t))))
          （转到字符 pt）
          (let ((buf (get-buffer-create (concat "*rmail-" subject "*"))))
            （shell命令对区域
             pt（或
                 (re-search-forward "</html>" nil t)
                 （点最大））
             "w3m -T 文本/html" buf)
            （切换到缓冲区的其他窗口缓冲区）
            （查看模式）））））））

```

我不确定这个名字，我只试过你的一封电子邮件，但对我来说，这行得通。

我把你的消息放进去`rmail-mode`，然后写了这个函数，它找到了 html 并通过 W3M 管道它。

您已切换到生成的缓冲区，我们将其放入，`view-mode`因此您只需“q”即可停止查看它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:35:55.547

我将使用 w3m-emacs 对此进行尝试。

# jsf - JSF 在 selectOneMenu 选择后更新 inputText

> ID：15024183
> 
> 赞同：3
> 
> 时间：2013-02-22T12:23:51.930
> 
> 标签：jsf, selectonemenu

当我从我的 selectOneMenu 中选择另一个皮肤时，我想更改 inputTexts 的值。一切都很好，我的转换器从菜单中返回了正确的对象，但是 inputTexts 没有更新。

```
<h:form>
    <h:selectOneMenu id="dropdownSkin"
        value="#{helloBean.currentSkin}" defaultLabel="Select a skin.."
        valueChangeListener="#{helloBean.skinValueChanged}" immediate="true"
        onchange="this.form.submit()" converter="SkinConverter" >
        <f:selectItems value="#{helloBean.mySkinsSI}" var="c"
            itemValue="#{c.value}" />
    </h:selectOneMenu>

    <br />
    <h:inputText id="name" value="#{helloBean.currentSkin.title}"></h:inputText>
    <br />
    <h:inputText id="tcolor" value="#{helloBean.currentSkin.titleBar.textColor}"></h:inputText>
    <br />
    <h:inputText id="bcolor" value="#{helloBean.currentSkin.titleBar.backgroundColorStart}"></h:inputText>
</h:form> 
```

这是我的 Bean 的样子。我对其进行了调试，并且正确设置了 Object currentSkin。现在我需要知道如何更新文本字段内容。

```
@ManagedBean
@SessionScoped
public class HelloBean implements Serializable {

private static final long serialVersionUID = 1L;

private List<ExtendedSkin> mySkins;
private List<SelectItem> mySkinsSI;
private ExtendedSkin currentSkin;

public void skinValueChanged(ValueChangeEvent e) {
    currentSkin = (ExtendedSkin) e.getNewValue();
    FacesContext.getCurrentInstance().renderResponse();
}

public List<ExtendedSkin> getMySkins() {
    mySkins = XMLParser.readExtendedSkins();
    return mySkins;
}

public List<SelectItem> getMySkinsSI() {
    mySkinsSI = new LinkedList<SelectItem>();
    for (ExtendedSkin s : getMySkins()) {
        mySkinsSI.add(new SelectItem(s, s.getTitle()));
    }
    return mySkinsSI;
}

public void setMySkinsSI(List<SelectItem> myItems) {
    this.mySkinsSI = myItems;
}

public ExtendedSkin getCurrentSkin() {
    if (currentSkin == null) {
        currentSkin = getMySkins().get(0);
    }
    return currentSkin;
}

public void setCurrentSkin(ExtendedSkin currentSkin) {
    this.currentSkin = currentSkin;
}
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T17:02:57.040

这里的问题是转换器正在完成填充`helloBean.currentSkin`对象的工作，但是 中的值`<h:inputText>`绑定到 this `helloBean.currentSkin`: `title`，`textColor`并将`backgroundColorStart`被发送到服务器并替换由 加载的实际值`converter`。换句话说：

*   转换器被执行并`helloBean.currentSkin`基于所选值构建。
*   空`<h:inputText id="name">`值被发送到服务器并将被注入`helloBean.currentSkin.title`. 其他 2`<h:inputText>`秒的行为相同。
*   视图将使用 selected 加载`helloBean.currentSkin`，并将加载`helloBean.currentSkin.title`空值。其他 2`<h:inputText>`秒的行为相同。

这个问题有两种可能的解决方案：

1.  将`<h:inputText>`s 移到表单之外，因此不会将空值发送到服务器。加载视图时，它将保持转换器中加载的值。

    ```
    <h:form>
        <h:selectOneMenu id="dropdownSkin"
            value="#{helloBean.currentSkin}" defaultLabel="Select a skin.."
            valueChangeListener="#{helloBean.skinValueChanged}" immediate="true"
            onchange="this.form.submit()" converter="SkinConverter" >
            <f:selectItems value="#{helloBean.mySkinsSI}" var="c"
                itemValue="#{c.value}" />
        </h:selectOneMenu>
    </h:form>
    <br />
    <h:inputText id="name" value="#{helloBean.currentSkin.title}"></h:inputText>
    <!-- rest of Facelets code... --> 
    ```

2.  由于您正在加载`helloBean.currentSkin`同时更改下拉列表中的选定值，因此您可以使用[`<f:ajax>`](http://www.jsftoolbox.com/documentation/help/12-TagReference/core/f_ajax.html)标签组件添加 ajax 行为，`<h:selectOneMenu>`并以更简洁的方式更新字段。我会选择这个解决方案。

    ```
    <h:form>
        <!-- Note that there's no need of the onchange JavaScript function -->
        <h:selectOneMenu id="dropdownSkin"
            value="#{helloBean.currentSkin}" defaultLabel="Select a skin.."
            valueChangeListener="#{helloBean.skinValueChanged}" immediate="true"
            converter="SkinConverter" >
            <f:selectItems value="#{helloBean.mySkinsSI}" var="c"
                itemValue="#{c.value}" />
            <f:ajax process="@this" render="name tcolor bcolor" />
        </h:selectOneMenu>
        <br />
        <h:inputText id="name" value="#{helloBean.currentSkin.title}" />
        <h:inputText id="tcolor" value="#{helloBean.currentSkin.titleBar.textColor}" />
        <br />
        <h:inputText id="bcolor"
            value="#{helloBean.currentSkin.titleBar.backgroundColorStart}" />
    </h:form> 
    ```

[您可以在这样](http://mkblog.exadel.com/2010/04/learning-jsf-2-ajax-in-jsf-using-fajax-tag/)`<f:ajax>`的在线教程中了解更多信息。

由于您将在页面中使用 ajax 调用，因此您应该将托管 bean 范围从 更改`@SessionScoped`为`@ViewScoped`。有关此的更多信息：[JSF 2 中的通信](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html)

# junit - JUnit源码中Procectable接口是什么意思？

> ID：15024193
> 
> 赞同：1
> 
> 时间：2013-02-22T12:24:23.257
> 
> 标签：junit, junit4

我最近在研究 的源代码`JUnit-4.11`，让我感到困惑的是看似多余的`Protectable`接口。声明如下：

```
public interface Protectable {
    public abstract void protect() throws Throwable;
} 
```

类中`TestResult`有一个`void run(final TestCase test)`方法，其中匿名`Protectable`实例实现如下：

```
protected void run(final TestCase test) {
    startTest(test);
    Protectable p = new Protectable() {
        public void protect() throws Throwable {
           test.runBare();
        }
    };
    runProtected(test, p);

    endTest(test);
} 
```

`runProtected`方法如下：

```
public void runProtected(final Test test, Protectable p) {
    try {
        p.protect();
    } catch (AssertionFailedError e) {
       addFailure(test, e);
    } catch (ThreadDeath e) { // don't catch ThreadDeath by accident
        throw e;
    } catch (Throwable e) {
        addError(test, e);
    }
} 
```

可以看到，什么`runProtected`只是正在执行`test.runBare();`，那么 Protectable 接口的存在有什么意义吗？为什么我们不能像下面这样编写代码。

```
protected void run(final TestCase test) {
    startTest(test);
    test.runBare();
    endTest(test);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:27:14.773

要首先回答您的最后一个问题，您不能使用

```
protected void run(final TestCase test) {
    startTest(test);
    test.runBare();
    endTest(test);
} 
```

因为它不会做你想做的事。JUnit 使用异常来管理断言，特别是`AssertionFailedError`. 因此，当两个值不相等时`Assert.assertEquals()`抛出一个。`AssertionFailedError`因此，在上述方法中，`endTest(test)`如果断言失败，则不会调用 ，这意味着正确的事件（测试的失败/错误）不会被触发，`tearDown()`也不会被执行。

该`Protectable`接口的存在是为了给 runner 提供一个更通用的接口，这样您就不必将 a`TestCase`交给方法，以允许不同的操作。

顺便说一句，这是 package 的一部分`junit.framework.*`，它是 JUnit 3。JUnit 4 就是它所在的地方，如果你想学习，请在`org.junit.*`包中查看更多内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:10:00.003

它似乎以特定方式处理抛出的异常：调用`addFailure`断言异常（您的测试失败），`addError`其他异常（您的测试编码不好）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-05T02:32:35.277

该接口是通过添加 Throwable 来保护 TestCase。所以junit可以安全地运行任何测试用例。

```
The Throwable class is the superclass of all errors and exceptions in the Java language. 
```

# javascript - 单击时如何移动画布图形？

> ID：15024199
> 
> 赞同：0
> 
> 时间：2013-02-22T12:24:41.713
> 
> 标签：javascript, canvas

我在画布上有一个五边形图形，我想将其移动到鼠标所在的位置。

代码

```
<canvas id="fld" width="1000px" height="800"></canvas>
    <script type="text/javascript"><!--
    onload = function() { draw(); };
    function draw() {
      var canvas = document.getElementById('fld');
      if ( ! canvas || ! canvas.getContext ) {return false;}
      var ctx = canvas.getContext('2d');
      //Pentagon
      ctx.beginPath();
      ctx.strokeStyle = 'rgb(255, 0, 0)';
      ctx.moveTo(100,10);
      for (var i=1;i<=5; ++i) {
        th=i * 2 * Math.PI/5;
        x=100+90*Math.sin(th);
        y=100-90*Math.cos(th);
        ctx.lineTo(x,y);
      }
      ctx.stroke();
      ctx.beginPath();
      ctx.arc(900, 60, 40, 0, 2 * Math.PI, false);
      ctx.fillStyle = "rgb(255, 0, 0)";
      ctx.fill();
      ctx.strokeStyle = "black";
      ctx.stroke();
     }
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:39:24.233

您只需要进行一些更改，这将起作用。

首先，您应该更改您的 draw() 函数，使其接受 2 个参数，即图形将要绘制的 X 和 Y 位置。接下来，您需要更改您使用的硬编码值，以便它们基于传递的 X 和 Y 值。

其次，您应该向画布添加一个 onclick 处理程序。当您收到点击事件时，您可以获得鼠标被点击的画布的 X 和 Y 坐标。

然后，您可以清除画布并通过鼠标单击 X 和 Y 调用更新的绘图函数。

Look-up onclick handlers for the way to get the position of the mouse when the button is pressed. You'll have to use addEventListener to attach the click handler, so that your function gets the event that triggered it passed to it. You can then extract the co-ords of the click from the event object.

# coffeescript - 咖啡脚本中的 if/else 简写？

> ID：15024202
> 
> 赞同：1
> 
> 时间：2013-02-22T12:24:44.987
> 
> 标签：coffeescript

```
if myString then myString else "" 
```

...感觉有点冗长。

我可以使用更短的替代方案吗？

`myString`可以是未定义的或字符串。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T20:27:12.150

这是一种方法：

```
myString ? '' 
```

这就是您*真正*想要的，因为它编译为：

```
(typeof myString !== "undefined" && myString !== null ? myString : '') 
```

请注意，您可以将此存在运算符用于任何值，例如

```
myFloat ? 90.8 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-22T12:34:19.920

这个怎么样：

```
myString or "" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-22T14:56:56.473

使用存在运算符：

```
myString ?= "" 
```

# c# - 如何一次执行一个方法

> ID：15024203
> 
> 赞同：0
> 
> 时间：2013-02-22T12:24:48.630
> 
> 标签：c#, c#-4.0

我有一个我正在调用的电子邮件方法`OnPageLoad`。`C# 4.0`当页面加载时，它会将电子邮件发送给用户。问题是当用户刷新页面时，每次它都会向用户生成电子邮件，这是不可接受的。有没有什么方法可以让我的方法只在页面打开时第一次执行。我正在调用这样的方法

```
if (!IsPostBack)
{
  Sendemail(emailid, "ibrahim.cheema@shakarganj.com.pk", "SML Dashboards Access", "<b><font color=red>Dashboard Access Alert!</font></b> <br></br>Note: If the access is by yourself, then please ignore this email.<br><br>SML Dashboards accessed using your credentials<br><b>" + emailid + "<br><b>Location / IP Address :</b>" + GetUserIP());
} 
```

这样，用户在刷新页面时总是会收到电子邮件。我怎样才能避免它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:30:28.993

您可以选择存储 cookie 并在发送电子邮件之前检查 cookie 是否存在。这是最简单的方法，最好的方法是将变量保存在数据库的用户配置文件表中（如果有的话）。这是最安全的方式，因为 cookie 和会话不是无限的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:27:18.163

```
if(Session[emailid]==null)
{
  // SEND

  Session[emailid]==true;
} 
```

请记住，会话可能会在超时或 IIS 重新启动等不同情况下重置，并且电子邮件将在下次会话启动时再次发送。如果您希望这封电子邮件一生只发送一次 - 您必须将已发送标志保留在数据库中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T23:58:12.983

正如stack-starTrekkers所提到的，方法是

在客户端系统上存储信息——明显的危险:(

维护会话变量——重置事件会妨碍它的可用性——这种情况可以通过持久化到本地磁盘来处理，或者由于服务可以由多台服务器机器处理，到全局可见的（对于服务服务器）持久层，可以是一个流, db, 在云中的位置。

其他解决方案可能是将这个逻辑从页面移动到邮件服务 - 这是更多的工作，但更清洁的方法。

# javascript - 如何将此 css 转换为 javascript

> ID：15024204
> 
> 赞同：0
> 
> 时间：2013-02-22T12:24:54.593
> 
> 标签：javascript, css, google-chrome, cursor

我想隐藏基于浏览器的游戏的光标。在比赛开始之前我不想这样做。

我在 CSS 中有这个：`* { cursor: none }`. 我将如何在 JavaScript 中执行此操作？我的目标浏览器是 Chrome，只有 Chrome。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:25:51.510

You can do

```
document.body.style.cursor='none'; 
```

A note about your CSS : it's better to avoid as much as possible the `*` selector, especially when you can just set a style to the body.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T12:28:00.910

```
<div id="nocursor"></div>

<script type="text/javascript">
    document.getElementById('nocursor').style.cursor = 'none';
</script> 
```

It still uses css, but I assume that this is what you were looking for.

# php - mt_rand() in php doesn't generate new number on every refresh but in every 5

> ID：15024209
> 
> 赞同：0
> 
> 时间：2013-02-22T12:25:17.090
> 
> 标签：php

Is there some kind of caching issue?

I've sql statement which updates column in mysql.

```
$mysqli->query("UPDATE users SET user_sessions = user_sessions +1, user_password_token = ". mt_rand(1000000000,9999999999) ." WHERE user_name = '". $mysqli->real_escape_string($user_name) ."' AND user_password = '". $mysqli->real_escape_string($user_password) ."'"); 
```

In db I see token gets update only few times in every 5 refresh. And mostly it gets same values! Bits the idea of random doesn't it?

Number that gets repeated is mystic: 4294967295.

So is php caching this function?

I also noticed if I output mt_rand with echo this problem disappears.

:S

p.s. wait, is my browser not refreshing page? But this would not explain repeated number anyways.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:37:43.177

我不太确定这一点，但也许你可以为每个调用添加一个随机/日期哈希。正如我在[萤火虫中读到的](http://tech.fireflake.com/2009/06/16/how-to-avoid-a-page-being-cached/)

> 对缓存控制的当前状态（不是标题，主题）感到失望，我最终做了可能大多数人都在做的事情。将一个随机的 10 个字符串附加到我所做的每个调用中，有效地欺骗了浏览器，这些信息可能很重要，并使其正确更新页面。只需将其附加到每个 GET 的后面，并在每个 POST 中包含一个随机字段。

试试看是不是缓存问题！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:37:45.967

我`mt_rand(1000000000,9999999999)`单独运行片段并没有得到相同的值。要了解它是关于 MySQL 缓存还是 PHP 缓存，请在查询函数之外运行您的函数并分配一个变量。然后将变量放入查询函数中。如果结果相同，可能是关于 MySQL 的。

否则，尝试一个函数：

```
 function nonce($size=32){//256 bit == 32byte. 
    $ret="";
    for($x=0;$x<$size;$x++){
        $ret.=chr(mt_rand(0,255));
    }
    return base64_encode($ret);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T12:52:20.000

好吧，我想我明白了……神奇的数字 4294967295 与问题有关。

只需生成 < 10 位数字即可。马克贝克是完全正确的。

# c# - 可以记录unc连接吗？

> ID：15024211
> 
> 赞同：0
> 
> 时间：2013-02-22T12:25:32.093
> 
> 标签：c#, unc, auditing

我使用的电脑有一个 UNC 文件。我和其他人在一个网络中。其他人都可以通过在地址行 \\file 中打赏来打开文件。

知道我想在 Vs2010 中编写 ac# programm 来监视我使用 Win7 32bit 的文件。如果任何人打开该文件，程序将写入一个有人打开我的文件的日志文件。

我尝试使用 FileSystemWatcher 但这仅查找更改/保存/创建而不是打开。

我读了一些关于“审计”的东西，我可以用这个（审计）来做到这一点（监视我的 unc 文件）。但我试图找出如何在 c# 中使用审计，但我发现不多。

.

所以我的问题：

是否可以用“审计”做我想做的事？

是否有人曾在 c# 中进行过审计，或者有任何人提供链接或 somtihng 来向我展示它在 c# 中的工作原理吗？

制造山姆

抱歉英语不好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:53:50.910

您可能想要使用[Audit Object Access](http://technet.microsoft.com/en-us/library/cc776774%28v=ws.10%29.aspx)。

您必须遵循的步骤：

1.  在***本地计算机策略***中启用***审核对象访问***。
**   为您要关注的对象启用审核。*   在您的应用程序中，使用[EventLog.EntryWritten 事件](http://msdn.microsoft.com/en-us/library/system.diagnostics.eventlog.entrywritten.aspx)来检测文件打开事件*

 *这是一个简单的示例用法，但是您必须深入研究文档才能根据需要进行捕获和记录：

```
class Program
{
    public static void Main()
    {

        EventLog myNewLog = new EventLog("Security", ".", "Microsoft Windows security");

        myNewLog.EntryWritten += new EntryWrittenEventHandler(MyOnEntryWritten);
        myNewLog.EnableRaisingEvents = true;

        Console.ReadLine();
    }

    public static async void MyOnEntryWritten(object source, EntryWrittenEventArgs e)
    {
        await Task.Factory.StartNew(() =>
        {
            if (e.Entry.InstanceId == 4656 || e.Entry.InstanceId == 4663)
            {
                Console.WriteLine(e.Entry.Message);
            }
        });
    }
} 
```*

# python - PyQt4 应用程序按钮不起作用

> ID：15024213
> 
> 赞同：1
> 
> 时间：2013-02-22T12:25:37.590
> 
> 标签：python, qt, user-interface, pyqt, pyqt4

我正在尝试使用设计器在 Linux 中设置一个应用程序，`PyQt4`并且我正在努力将信号和插槽连接到它。现在我想做的就是将一个按钮`clicked`信号连接到一个自定义插槽，`saveEnergyScheme`它只是将“能量列表”打印到终端。

我已经将我的应用程序的 .ui 代码翻译成带有 .ui 的 python 类`pyuic4 -w sumcorr.ui > sumcorr_ui.py`。这在`sumcorr_ui.py`模块中创建了一个名为`SumCorr_ui`：

```
class SumCorr_ui(QtGui.QMainWindow, Ui_SumCorr_ui):
    def __init__(self, parent=None, f=QtCore.Qt.WindowFlags()):
        QtGui.QMainWindow.__init__(self, parent, f)

        self.setupUi(self) 
```

然后，我将我的应用程序制作为自定义小部件，并尝试向按钮添加一个简单的信号槽连接以显示它的工作原理：

```
from PyQt4 import QtGui, QtCore
from sumcorr_ui import SumCorr_ui

class SumCorr(SumCorr_ui):

    def __init__(self):
        SumCorr_ui.__init__(self)
        self.save_energies_button.clicked.connect(self.saveEnergyScheme)

    def saveEnergyScheme(self):
        print 'energyList'

if __name__ == '__main__':

    import sys
    app = QtGui.QApplication(sys.argv)
    mySumCorr = QtGui.QMainWindow()
    ui = SumCorr()
    ui.setupUi(mySumCorr)
    mySumCorr.show()
    sys.exit(app.exec_()) 
```

当我单击名为 的按钮时，我希望得到“能量列表”行`save_energies_button`，但没有任何反应。这可能是因为我没有将 UI 构建为小部件，而是作为主窗口吗？为什么打印不出来？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:44:35.577

尝试添加`ui.show()`，您会看到您的代码正在创建两个不同的窗口，一个应该连接信号，一个没有。那是因为您只显示`mySumCorr`窗口，但您只调用`setupUi`它，它不连接信号。

当您创建`SumCorr`实例时，您正在创建一个窗口并设置它，然后，毫无理由地，您这样做了，它在*不*`ui.setupUi(mySumCorr)`连接信号的情况下设置了`mySumCorr`实例，并显示了最后一个窗口。

 *我相信你的代码应该是这样的：

```
class SumCorr(QtGui.QMainWindow, Ui_SumCorr_ui):

    def __init__(self):
        SumCorr_ui.__init__(self)
        self.setupUi(self)

        self.save_energies_button.clicked.connect(self.saveEnergyScheme)

    def saveEnergyScheme(self):
        print 'energyList'

if __name__ == '__main__':
    import sys
    app = QtGui.QApplication(sys.argv)
    mySumCorr = SumCorr()
    mySumCorr.show()
    sys.exit(app.exec_()) 
```

请注意，拥有一个类没有任何意义`SumCorr_ui`，因为`Qt` *它是*一个 UI 库，所以您只是引入了一个毫无价值的抽象级别。设计器文件已经为您提供了对 ui 布局的抽象。*

# javascript - 同时出现多个 JavaScript 超时

> ID：15024214
> 
> 赞同：0
> 
> 时间：2013-02-22T12:25:42.593
> 
> 标签：javascript, settimeout, setinterval

我正在开发一个 HTML5 应用程序，我正在画布上以一定的速度和每个动画之间的特定超时绘制一系列图像。

能够多次使用它，我为它做了一个功能。

```
var imgNumber = 0;
var lastImgNumber = 0;
var animationDone = true;

function startUpAnimation(context, imageArray, x, y, timeOut, refreshFreq) {
    if (lastImgNumber == 0) lastImgNumber = imageArray.length-1;

    if (animationDone) {
        animationDone = false;
        setTimeout(playAnimationSequence, timeOut, refreshFreq);
    }
    context.drawImage(imageArray[imgNumber], x, y);
}

function playAnimationSequence(interval) {
    var timer = setInterval(function () {
        if (imgNumber >= lastImgNumber) {
            imgNumber = 0;
            clearInterval(timer);
            animationDone = true;
        } else imgNumber++;
    }, interval);
} 
```

现在在我的主代码中，每次 startUpAnimation 使用正确的参数它都可以正常工作。**但是当我想在屏幕上同时绘制多个动画时，每个动画都以不同的间隔和速度绘制它不起作用！**

```
startUpAnimation(context, world.mushrooms, canvas.width / 3, canvas.height - (canvas.height / 5.3), 5000, 300);
startUpAnimation(context, world.clouds, 100, 200, 3000, 100); 
```

它现在在正确的位置显示两个动画，但它们在第一个调用的间隔和超时时都进行动画处理，所以在我的例子中是 5000 超时和 300 间隔。

我该如何解决这个问题，以便他们都独立玩？我想我需要把它变成一个类或其他东西，但我不知道如何解决这个问题。在某些情况下，我什至需要使用此功能同时显示 5 个动画。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:36:33.127

尝试这样的事情

```
 var Class = function () {
            this.imgNumber = 0;
            this.lastImgNumber = 0;
            this.animationDone = true;

        }
        Class.prototype.startUpAnimation = function(context, imageArray, x, y, timeOut, refreshFreq) {
            //     if (lastImgNumber == 0) lastImgNumber = imageArray.length-1;

            if (this.animationDone) {
                this.animationDone = false;
                setTimeout(this.playAnimationSequence, timeOut, refreshFreq, this);
            }
            //     context.drawImage(imageArray[imgNumber], x, y);
        };

        Class.prototype.playAnimationSequence = function (interval, object) {
            var that = object; // to avoid flobal this in below function
            var timer = setInterval(function () {
                if (that.imgNumber >= that.lastImgNumber) {
                    that.imgNumber = 0;
                    clearInterval(timer);
                    that.animationDone = true;
                    console.log("xxx"+interval);
                } else that.imgNumber++;
            }, interval);
        };

        var d = new Class();
        var d1 = new Class();
        d.startUpAnimation(null, [], 300, 300, 5000, 50);

        d1.startUpAnimation(null,[], 100, 200, 3000, 60); 
```

它应该工作，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:49:00.400

据我所知，每次调用 startUpAnimation 都会立即绘制到画布上，因为此执行（您的 drawImage(..) 调用）尚未包含在 setTimeout 或 setInterval 的回调中。

# r - R: alternatives to all.equal?

> ID：15024217
> 
> 赞同：3
> 
> 时间：2013-02-22T12:25:56.873
> 
> 标签：r, floating-accuracy

While `all.equal` is a very powerful tool, with a cornucopia of informative response strings, I wanted an equivalent function which simply returned TRUE/FALSE for near-equality. (I'm aware of the standard tricks like `identical(all.equal(foo,bar), TRUE)` ). I wrote the following code snippet, but was wondering if I'd overlooked a similar function in one of the R packages.

```
approxeq <- function(x,y,tolerance = .Machine$double.eps ^ 0.5,...) {
   #Note: better input validation should be written
   if (length(x) != length(y)) stop('lengths must be equal')
   checkit <- abs(x-y) < tolerance
    return(invisible(checkit))
} 
```

The main difference between `approxeq` and `all.equal` is that the former gives me element-by-element equality test results. I'm not saying this is better, just different. So, does anyone know if there is a similar (and presumably more robust) function in a released package?

# sql-server - 存储过程中的游标转换失败

> ID：15024219
> 
> 赞同：2
> 
> 时间：2013-02-22T12:26:09.790
> 
> 标签：sql-server, types, cursor

输入喜欢`111111`和`101,102,103,104`

我想检查用户是否有权访问此请求...

我尝试了如图所示的光标，但出现此错误：

> *将 varchar 值“101,102,103,104”转换为数据类型 int 时转换失败。*

代码：

```
ALTER PROCEDURE [dbo].[ValidateRqstId]
    @UserID VARCHAR(50),
    @RsqtIDs VARCHAR(300)
AS
BEGIN
   Declare @RqstId int
   Declare @Result int
   Declare @UserIDToCheck VARCHAR(50)
   Declare @RqstUserVal cursor for  
               Select RequestId 
               from REQUEST_LIST  
               where RequestId in (@RsqtIDs)

   BEGIN

      OPEN RqstUserVal
      FETCH NEXT from RqstUserVal into @RqstId

      WHILE(@@fetch_status <> -1)
      BEGIN
        SET @UserIDToCheck = (
               select UserId from dbo.REQUEST_LIST where RequestId =  @RqstId)

        Print(@UserIDToCheck)

        If(@UserIDToCheck != @UserID)
            SET @Result = 99 ;

        --Fetch the next row from the cursor
        FETCH RqstUserVal into @RqstId
      END
   END

   CLOSE RqstUserVal
   Deallocate RqstUserVal

   RETURN @Result 
END 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T07:05:55.333

根据您的 SQL-Server 版本，您可以使用像这个简短示例中的表值函数

```
Select * from dbo.test1
Where ID in(
Select * from dbo.F_SplitAsIntTable('1,123,234,456')) 
```

函数定义为

```
CREATE FUNCTION F_SplitAsIntTable 
(
@txt varchar(max)
)
RETURNS 
@tab TABLE 
(
 ID int
)
AS
BEGIN
    declare @i int
    declare @s varchar(20)
    Set @i = CHARINDEX(',',@txt)
    While @i>1
        begin
          set @s = LEFT(@txt,@i-1)
          insert into @tab (id) values (@s)
          Set @txt=RIGHT(@txt,Len(@txt)-@i)
          Set @i = CHARINDEX(',',@txt)
        end
    insert into @tab (id) values (@txt) 
    RETURN 
END
GO 
```

# php - PHP : How to Prevent Sql Injection For this Code

> ID：15024222
> 
> 赞同：-2
> 
> 时间：2013-02-22T12:26:17.600
> 
> 标签：php, mysql

I am New to development.I have created an simple html 5 game for facebook .I use post Request to `update.php` to store score in database.

Below is my code

```
<? 
include 'config.php';
mysql_connect(localhost,$user,$password);
$id = mysql_real_escape_string($_POST['id']);
$score = mysql_real_escape_string($_POST['score']);
@mysql_select_db($database) or die( "Unable to select database");
$query = "UPDATE heli SET score = '$score' WHERE app = '$id'";
echo $query;
$result=mysql_query($query);
mysql_close();
?> 
```

Many Complain that my code is vulnerable to Sql injection.Any one Suggest good code that is Secure.Thanks..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T12:27:16.240

use `PDO` or `MySQLi` Extension on `PHP`. Please read the article below,

*   [How to *prevent SQL injection* in PHP?](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)

*   [SQL injection that gets around **mysql_real_escape_string()**](https://stackoverflow.com/questions/5741187/sql-injection-that-gets-around-mysql-real-escape-string)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T12:31:32.957

不，您当前的代码不容易受到攻击。但是，您的其他代码可以。
只要你把它`mysql_real_escape_string()`当作一种“万能注射预防剂”，你就有危险。

[这是](https://stackoverflow.com/a/8061617/285587)我对类似问题的*解释的答案*

# c++ - How to implement an easy_bind() that automagically inserts implied placeholders?

> ID：15024223
> 
> 赞同：7
> 
> 时间：2013-02-22T12:26:19.203
> 
> 标签：c++, templates, c++11, variadic-templates

I recently found this nifty snippet on the web - it allows you to bind without having to pass in explicit placeholders:

```
template <typename ReturnType, typename... Args>
std::function<ReturnType(Args...)> 
easy_bind(ReturnType(*MemPtr)(Args...))
{
  return [=]( Args... args ) -> ReturnType { return (*MemPtr)( args... ); };
} 
```

This version works great with no args:

```
auto f1 = easy_bind( (std::string(*)(A&,A&))&Worker::MyFn ); 
```

later invoked with:

```
std::string s = f1( *p_a1, *p_a2 ); 
```

**Question**

Is it possible to modify the code to work with anything up to n args, filling 2-n (in this case) with placeholders? For example, this one should have one placeholder:

```
auto f2 = easy_bind( (std::string(*)(A&,A&))&Worker::MyFn, *p_a1 ); 
```

later invoked with:

```
std::string s = f2( *p_a2 ); 
```

**Bonus**

Ultimately, it would nice to have something like this (which inserts no placeholders since it will use up the last one), but I don't think it's workable with this implementation (can't pattern-match the signature, I think):

```
auto f3 = easy_bind( f2, *p_a2 ); 
```

later invoked with:

```
std::string s = f3(); 
```

The bottom line is, it would be nice to have a version of bind where I don't need to put in placeholders - it would be quite useful in generic TMP code.

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-22T13:17:51.063

有了[索引技巧](http://loungecpp.wikidot.com/tips-and-tricks:indices)和[告诉`std::bind`你自己的占位符类型](http://en.cppreference.com/w/cpp/utility/functional/is_placeholder)的能力，这就是我想出的：

```
#include <functional>
#include <type_traits>
#include <utility>

template<int I> struct placeholder{};

namespace std{
template<int I>
struct is_placeholder< ::placeholder<I>> : std::integral_constant<int, I>{};
} // std::

namespace detail{
template<std::size_t... Is, class F, class... Args>
auto easy_bind(indices<Is...>, F const& f, Args&&... args)
  -> decltype(std::bind(f, std::forward<Args>(args)..., placeholder<Is + 1>{}...))
{
    return std::bind(f, std::forward<Args>(args)..., placeholder<Is + 1>{}...);
}
} // detail::

template<class R, class... FArgs, class... Args>
auto easy_bind(std::function<R(FArgs...)> const& f, Args&&... args)
    -> decltype(detail::easy_bind(build_indices<sizeof...(FArgs) - sizeof...(Args)>{}, f, std::forward<Args>(args)...))
{
    return detail::easy_bind(build_indices<sizeof...(FArgs) - sizeof...(Args)>{}, f, std::forward<Args>(args)...);
} 
```

[活生生的例子。](http://liveworkspace.org/code/3CIkx)

请注意，我要求函数参数为type 或可转换为`easy_bind`type `std::function`，以便我有明确的可用签名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-01T09:15:05.457

这让我很困扰，因为我不得不在当时不知道参数的情况下绑定一个函数。（此处显示的工厂[如何在 C++ 中实现序列化](https://stackoverflow.com/questions/1809670/how-to-implement-serialization-in-c/1809715#1809715)）

例如（假设 TSubClass::create 是静态的）

```
template<typename TFactoryClass, typename TArgs...>
class Factory
{
public:
    template<typename TSubClass>
    void register(int id)
    {
         _map.insert(std::make_pair(id, std::bind(&TClass::create, /*how to give TArgs as placeholders??*/)));
    }
} 
```

相反，我能够用 lambda 表达式替换 std::bind ，而无需使用所有这些辅助类！

```
template<typename TFactoryClass, typename TArgs...>
class Factory
{
public:
    template<typename TSubClass>
    void register(int id)
    {
         _map.insert(std::make_pair(id, [](TArgs... args) { TSubClass::create(args...); }));
    }
} 
```

作为奖励，您还可以使用此机制“绑定”到构造函数

# red5 - red5 server installer

> ID：15024225
> 
> 赞同：1
> 
> 时间：2013-02-22T12:26:26.857
> 
> 标签：red5

I installed Red5 Server and when I run **`http://localhost:5080`** it shows that red5 is installed successfully. But when I try to run installer folder, it gives error as follow:

```
Host: localhost >Trying to connect
Net status: NetConnection.Connect.Rejected
Net status: NetConnection.Connect.Closed
Trying to connect to war location 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-10T13:14:26.510

我已经将它安装在 Linux 机器上，并且在使用 IP 从远程机器浏览器访问 URL 时遇到了同样的问题。问题出在我的防火墙设置中，它基本上需要两个端口，端口 - 5080 在 http 和端口 - 1935 上打开。我打开了端口 5080 但 1935。打开后我能够访问它。

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T14:39:00.717

`http://your_ip:_port`在浏览器中输入
**ip:**安装 red5 时指定的端口号
**:**安装时指定的端口号
你会看到**安装程序**链接，点击，然后选择每个 Demo 并在两个安装进度后单击**Install**
，检查你的 red5 安装目录是否有安装的 demo。您还可以在`http://your_ip:port/demos/`页面中启动演示。
**注意：**我假设你在 pc 上启动了 red5 服务，否则去 services.msc 并在这些之前启动 red5 服务

# .net - 从 vb.net 中的文件中提取值

> ID：15024233
> 
> 赞同：3
> 
> 时间：2013-02-22T12:27:00.483
> 
> 标签：.net, vb.net, csv

以下是我在项目中使用的一段代码：

```
Using Reader As New Microsoft.VisualBasic.FileIO.TextFieldParser(OpenFileDialog1.FileName.ToString())
    Reader.TextFieldType = FileIO.FieldType.Delimited
    Reader.SetDelimiters("\t")
    Dim currentRow As String()
    Dim valueArray() As Double = {0, 0, 0, 0}
    Dim power3, power2, power1, constVar As Double
    power3 = 0.0
    power2 = 0.0
    power1 = 0.0
    constVar = 0.0
    While Not Reader.EndOfData
        Try
            currentRow = Reader.ReadFields()
            Dim currentString As String
            Dim i As Integer = 0
            Dim j As Integer = 0
            For Each currentField As String In currentRow
                currentString = currentField(0)
                MsgBox(currentField)
                MsgBox(currentString)
            Next
        Catch ex As Microsoft.VisualBasic.FileIO.MalformedLineException
            MsgBox("Line " & ex.Message & "is not valid and will be skipped.")
        End Try
    End While
End Using 
```

我正在读取的文本文件包含用制表符分隔的浮点值，如下所示：

> 0.5 0.6 0.7 0.8

但是，现在，当我运行代码时，我将完整的行作为字符串`"0.5 0.6 0.7 0.8"`

我无法提取每个浮点值。请提出一些提取每个值的方法，以便我可以单独存储它们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T13:36:52.397

该`TextFieldParser`课程应该为您拆分每行上的所有字段。如果它不这样做，那是因为你没有正确设置它。在这种情况下，您的问题似乎是以下行：

```
Reader.SetDelimiters("\t") 
```

虽然这种字符串文字语法适用于 C# 和其他类似语言，但不适用于 VB.NET。反斜杠字符不是 VB.NET 中的转义字符，因此字符串与您键入的内容完全相同。因此，`TextFieldParser`正在寻找由反斜杠后跟字母 t 而不是单个制表符组成的两个字符的字符串。如果你想使用制表符作为分隔符，我强烈怀疑这是你想要的，那么，在 VB.NET 中，你需要这样做：

```
Reader.SetDelimiters(ControlChars.Tab) 
```

# .net - UI Testing and automation on Windows Phone 8

> ID：15024234
> 
> 赞同：4
> 
> 时间：2013-02-22T12:27:13.480
> 
> 标签：.net, testing, windows-phone-8, ui-automation

Can I run UI automated testing on a Windows Phone 8 emulator? So far all the answers and articles I could find refer to Windows Phone 7 platform.

Are there any Microsoft tools or perhaps some third party libraries that address this issue? Can I do this on the emulator without an actual device?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-19T06:10:28.900

Coded UI 现在支持 Windows phone 8 的 UI 自动化测试。它可以在模拟器中运行，因此您不需要实际的设备。

要开始在您的解决方案中为 WP 进行编码 UI 测试，请选择`File->Add->New project...` 在`Add New Project`对话框中选择`Coded UI Test Project (Windows Phone)`- `Visual C#`>`Windows phone Apps`节点

这是Prachi Bora [http://channel9.msdn.com/Events/Build/2014/3-593](http://channel9.msdn.com/Events/Build/2014/3-593)*为 Windows 和 Windows Phone 会话自动测试基于 XAML 的应用程序的链接*

会议总结：

> 您想为您的应用程序创建自动化测试吗？借助 Visual Studio 2013 Update 2，您现在可以为基于 XAML 的 Windows 和 Windows Phone 应用程序创建自动化测试。从单元测试到使用编码 UI 测试的功能性端到端场景测试，您现在可以从 Visual Studio 中的集成测试资源管理器执行所有测试。测试框架是可扩展的，开发人员可以对其进行自定义以满足其应用程序的特殊需求。在本次会议中，我们将向您展示如何利用这些 Visual Studio 功能为您的应用程序构建全面的测试套件，这些功能将帮助您发布高质量的应用程序。

# java - 如何从授权中排除一个 url

> ID：15024235
> 
> 赞同：59
> 
> 时间：2013-02-22T12:27:15.633
> 
> 标签：java, jakarta-ee, authentication, web.xml

我的 web.xml 看起来像：

```
<security-constraint>
    <web-resource-collection>
        <web-resource-name>app</web-resource-name>
        <url-pattern>/*</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <role-name>Role</role-name>
    </auth-constraint>
</security-constraint> 
```

这可以保护每一方免受授权，但我想排除 /info。这可能吗 ？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2013-02-25T07:32:13.770

省略不需要身份验证的资源中的`<auth-constraint>`元素，例如：`<security-constraint>`

```
<security-constraint>
    <web-resource-collection>
        <web-resource-name>app</web-resource-name>
        <url-pattern>/info</url-pattern>
    </web-resource-collection>
    <!-- OMIT auth-constraint -->
</security-constraint>

<security-constraint>
    <web-resource-collection>
        <web-resource-name>app</web-resource-name>
        <url-pattern>/*</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <role-name>Role</role-name>
    </auth-constraint>
</security-constraint> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-05-21T13:31:26.353

如果您正在寻找带有**Spring 引导解决方案的****keycloak**，请在您的应用程序属性文件中尝试这样的操作：

 **```
keycloak.security-constraints[0].authRoles[0]=users
keycloak.security-constraints[0].security-collections[0].patterns[0]=/*
keycloak.security-constraints[1].security-collections[0].patterns[0]=/info 
```

**这将对除/info**之外的所有 URL 应用安全性

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T09:34:48.703

不知道我说的对不对！以我有限的知识，我认为为了实现安全性，要使用一个或多个 web-resource-collection 元素声明要保护的内容。每个 web-resource-collection 元素都包含一系列可选的 url-pattern 元素，后跟一系列可选的 http-method 元素。url-pattern 元素值指定 URL 模式，请求 URL 必须与该 URL 模式匹配，以使请求对应于访问受保护内容的尝试。http-method 元素值指定允许的 HTTP 请求类型。

```
<security-constraint>
    <web-resource-collection>
        <web-resource-name>Secure Content</web-resource-name>
        <url-pattern>/restricted/*</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <role-name>AuthorizedUser</role-name>
    </auth-constraint>
    <user-data-constraint>
        <transport-guarantee>NONE</transport-guarantee>
    </user-data-constraint>
</security-constraint>
<!-- ... -->
<login-config>
    <auth-method>BASIC</auth-method>
    <realm-name>The Restricted Zone</realm-name>
</login-config>
<!-- ... -->
<security-role>
    <description>The role required to access restricted content </description>
    <role-name>AuthorizedUser</role-name>
</security-role> 
```

位于 Web 应用程序的 /restricted 路径下的 URL 需要 AuthorizedUser 角色。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-02-25T16:48:14.580

一种解决方案是使用[Apache Shiro](http://shiro.apache.org)等替代安全框架，而不是基于容器的安全性。然后很容易从受保护的内容中排除资源。使用 Shiro 你会输入`WEB-INF/shiro.ini`：

```
[urls]
/info = anon
/**   = authc 
```****

# php - 将 SQL 变量从 INNER JOIN SQL 查询传递到 PHP 脚本

> ID：15024249
> 
> 赞同：3
> 
> 时间：2013-02-22T12:27:48.933
> 
> 标签：php, sql, inner-join

我有以下 INNER JOIN 查询：

```
SELECT  b.*, c.date2
FROM    (
            SELECT a.work, a.amount, 
                   COUNT(*) totalCount, 
                   SUM(Amount) totalAmount
            FROM work_times a WHERE Organisation=?
            GROUP BY a.work, a.amount
        ) b
        INNER JOIN
        (
            SELECT a.work, a.amount, DATE_FORMAT(Date,'%D %M %Y') date2,
                    date
            FROM work_times a
        ) c ON b.work = c.work and b.amount=c.amount
ORDER BY b.work, b.totalCount, c.date 
```

[您可以在此处](http://sqlfiddle.com/#!2/e0ec1/24)的 SQL fiddle 上的示例表上看到它的运行情况。

我的目标是返回以下内容：

```
5 consultancy sessions @ £50 each: £250

1st February 2013
8th February 2013
15th February 2013
22nd February 2013
1st March 2013

3 therapy sessions @ £40 each: £120

2nd February 2013
9th February 2013
16th February 2013

2 therapy sessions @ £20 each: £40

3rd February 2013
10th February 2013 
```

但使用以下 PHP：

```
$stmt->bind_param("s", $name1);
$stmt->execute();
$stmt->store_result();  
$stmt->bind_result($work,$amount,$count,$total_group,$date);

while ($stmt->fetch()) {

        if ($count>1) {
           echo $count." ".$work."s @ &pound;".$amount." each<br><br>";
           echo date("jS F Y",strtotime($date))."<br><br>";
           $total_work=$total_work+$total_group;
        }
        else {
           echo $count." ".$work." @ &pound;".$amount."<br><br>";
           echo date("jS F Y",strtotime($date))."<br><br>";
           $total_work=$total_work+$total_group;
        }

        } 
```

我为每一行得到一行，而不是分组，即：

```
5 Consultancy Sessions @ £50.00

1st February 2013

5 Consultancy Sessions @ £50.00

8th February 2013

5 Consultancy Sessions @ £50.00

15th February 2013

...etc 
```

而且我不确定如何修改我的 PHP 以获得所需的输出。

**电流输出**

```
5 Consultancy Sessions @ £50.00

1st February 2013

8th February 2013

15th February 2013

22nd February 2013

1st March 2013

2nd February 2013

9th February 2013

16th February 2013

3rd February 2013

10th February 2013 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:01:23.717

问题似乎在于您正在为每一行调用“头部”。因此，您应该首先检查它是否已被调用。我希望以下内容可以帮助您：

```
$stmt->bind_param("s", $name1);
$stmt->execute();
$stmt->store_result();  
$stmt->bind_result($work,$amount,$count,$total_group,$date);

$last_work = "";
while ($stmt->fetch()) {
    if($work != $last_work || $amount != $last_amount){
        if ($count>1) {
           echo "<br>".$count." ".$work."s @ &pound;".$amount." each<br><br>";

        }
        else {
           echo "<br>".$count." ".$work." @ &pound;".$amount."<br><br>";
        }
        $last_work = $work;
        $last_amount = $amount;
    }
    echo date("jS F Y",strtotime($date))."<br>";
    $total_work=$total_work+$total_group;
} 
```

我将 the`echo date`和移到了`$total_work`外面，因为它们在两种情况下都被平等地调用了 (`$count >1`和`else`)

# php - Magento SSL Checkout - 未找到

> ID：15024250
> 
> 赞同：0
> 
> 时间：2013-02-22T12:27:58.067
> 
> 标签：php, magento, ssl

我在托管服务器上安装了有效的 SSL 证书。我通过系统->配置->网络并设置“安全”->基本网址：[https](https://www.mydomain.com) ://www.mydomain.com并更改“在前端使用安全网址”来启用ssl：是的。

当我尝试结帐时，它会重定向到[https://www.mydomain.com/checkout/onepage/](https://www.mydomain.com/checkout/onepage/)。找不到此页面...

问题是服务器上有一个安全目录（public_ssl）和非安全目录（public html），public_ssl 目录应该为空吗？magento 假设如何访问不存在的文件？

我尝试将 index.php、.htaccess、skin、js 和媒体文件夹/文件复制到 public_ssl，它可以工作，但是当我上传产品图片等时媒体没有更新......

（我编辑了 index.php "MAGENTO_ROOT" 全局以找到合适的文件......）

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:07:49.770

最好的解决方案是联系您的托管服务提供商。他们可能能够修改其 ssl 的配置方式（[https://serverfault.com/questions/429634/restrict-apache-to-only-allow-access-using-ssl-for-some-directories](https://serverfault.com/questions/429634/restrict-apache-to-only-allow-access-using-ssl-for-some-directories)）或使用符号链接，以便内容将在 public_ssl 和您的公共 html 文件夹之间共享。

此外，为了获得更好的网站性能，最好将您的 magento 网站托管在专门从事 magento 托管的服务提供商上。

# angularjs - AngularJS: How to hide the template content until user is authenticated?

> ID：15024253
> 
> 赞同：2
> 
> 时间：2013-02-22T12:28:03.270
> 
> 标签：angularjs, firebase, firebase-security, angularjs-routing, angularjs-authentication

My app has 2 pages: `main.html` and `login.html`. When not authenticated users go to `/main` they should be redirected to `/login`.

The problem is that `main.html` is rendered first, and after a second or so, when user authentication fails, `login.html` is rendered.

How could I prevent from `main.html` to be rendered until authentication succeeds?

Here is the relevant code (CoffeeScript):

```
angular.module('myApp', [...])
.config(['$routeProvider', ($routeProvider) ->
  $routeProvider.when '/login',
    templateUrl: 'html/login.html'
    controller: LoginController

  $routeProvider.otherwise
    templateUrl: 'html/main.html'
    controller: MainController
])
.run(['$rootScope', '$location', 'appService', ($rootScope, $location, app) ->
  $rootScope.$on '$locationChangeStart', (event, newValue, oldValue) ->
    return if newValue == '/login'

    $.when(app.authenticate()).fail ->
      $location.path '/login'
      $rootScope.$apply()
]) 
```

* * *

```
angular.module('myApp.services').factory 'appService' , () ->
  rootRef = new Firebase('https://myapp.firebaseio.com')

  user: null
  authenticate: ->
    deferred = $.Deferred()

    authClient = new FirebaseAuthClient rootRef, (error, user) =>
      if error
        # An error occurred while attempting login
        @user = null
        deferred.reject()
      else if user
        # User authenticated with Firebase
        @user = user
        deferred.resolve()
      else
        # User is logged out
        @user = null
        deferred.reject()

    deferred.promise() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:56:34.003

`main.html`好吧，在用户通过身份验证之前，我不会提供模板（在您的情况下）。我在服务器上有一个用于提供模板的自定义功能，它检查用户是否经过身份验证。如果在函数中我发现用户没有登录，它会返回带有 401 状态码的响应。然后在角度代码中，我将请求保留到身份验证，然后再次请求模板。

这篇文章启发了我这样做：http: [//www.espeo.pl/2012/02/26/authentication-in-angularjs-application](http://www.espeo.pl/2012/02/26/authentication-in-angularjs-application)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T20:48:23.250

一种选择是隐藏普通 DOM 并显示“Authenticating...”消息，可能带有微调器，让用户了解他/她为什么坐在那里等待某事发生。在 main.html 中，包括以下内容：

```
<spinner ng-hide="appService.wrapper.user"></spinner>
<!-- everything else ng-show="appService.wrapper.user" --> 
```

where`<spinner></spinner>`是一个 Angular[指令](http://docs.angularjs.org/guide/directive)，它被您的自定义“Authenticating...”消息替换，并且`user`是您的 appService 可用于的变量`MainController`。请注意，您可能需要`user`在 appService 中包装一个对象，如下所示：

```
.service('appService', function() {

  var wrapper = {
    user: null
  };

  function authenticate() {
    // start the authentication and return the promise,
    // but modify wrapper.user instead of user
  }

  return wrapper;

}); 
```

您还需要将其中一个`appService`或存储`appService.wrapper`在`$scope`您的`MainController`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T16:59:59.847

我对相同要求的解决方案是定义以下手表：

```
$rootScope.$watch(
    function() {
        return $location.path();
    },
    function(newValue, oldValue) {  
        if (newValue != '/login' && user is not logged in) {
            $location.path('/login');  
        }
    },
    true); 
```

`ng-view`在与索引页面（即包含指令的页面）的主体元素关联的控制器中。

# php - How to sort content from a mysql table in different ways without having multiple pages?

> ID：15024254
> 
> 赞同：1
> 
> 时间：2013-02-22T12:28:07.287
> 
> 标签：php, mysql

I have a section on my website where users can post comments. Just above these comments I have 4 links - Oldest, Newest, Top Rated and Worst Rated. Currently I have 4 different pages for each of these links.

> oldest.php - sorts the comments by date and time ascending
> 
> newest.php - sorts the comments by date and time descending
> 
> top.php - sorts the comments depending on how many likes they have
> 
> worst.php - sorts the comments depending on how many dislikes they have

They are all being sorted with a mySQL statement such as

```
$sql = "SELECT * FROM comments ORDER BY date DESC, time DESC LIMIT $offset, $rowsperpage"; 
```

I'm just wondering is there any way to order these comments by using just one page instead of having 4 different pages?

Any help would be greatly appreciated.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:32:26.643

是的，您在 URL 中传递了排序列和方向。

```
$type = 'new'; // default order
$cols = array('old', 'new', 'worst'); // array with possible options columns, to prevent SQL injection
if (in_array($_GET['type'], $cols) {
    $type = $_GET['type'];
}
$order = (strtolower($_GET['order']) == 'asc')?'ASC':'DESC'; // again - to prevent bad data
$sql = "SELECT * FROM comments ORDER BY {$type} {$order}, time DESC LIMIT $offset, $rowsperpage"; 
```

如果您有不同的查询，只需使用一个`switch()`语句，并为每种类型的订单相应地更改查询。

```
// use the same order as before
switch ($_GET['type']):
case 'old':
     $sql = " ... ";
break;

// more options
default:
    // default can be used for the most common option, for example when you first enter the page with no type argument in the URL
break; 
```

还有一件事 - 要生成 URL，您可以使用它：

```
$cols = array('old', 'new', 'worst'); // you can make this array a config variable
$order = array('asc', 'desc');
foreach ($cols as $col) {
    foreach ($order as $ord) {
        echo "<a href='index.php?type={$col}&order={$ord}'>".ucwords($col). ' ' . ucwords($ord)"</a>";
    }
} 
```

这将打印具有所有可能订单的所有类型。你应该玩这个，你可以做一些整洁、动态的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T12:34:56.317

当然，您可以使用单个页面来管理它。

您可以拥有单页而不是 4 页

评论.php

然后你可以像下面这样为 4 个链接传递 GET 参数

`comments.php?type=oldest
comments.php?type=newest
comments.php?type=top
comments.php?type=worst`

然后`comments.php`你可以像下面这样放置条件语句：

```
$order_by = "ORDER BY date DESC, time DESC"; // Default order
if(isset($_GET["type"]) && $_GET["type"] == "newest")
    $order_by = "ORDER BY date DESC, time DESC";
elseif(isset($_GET["type"]) && $_GET["type"] == "oldest")
    $order_by = "ORDER BY date, time";
elseif(isset($_GET["type"]) && $_GET["type"] == "top")
    ... put your order by here ...
elseif(isset($_GET["type"]) && $_GET["type"] == "worst")
    ... put your order by here ... 
```

然后在 $sql 下面使用

$sql = "SELECT * FROM comments ".$order_by." LIMIT $offset, $rowsperpage";

# android - android：请求时成为位图一部分的路径

> ID：15024258
> 
> 赞同：0
> 
> 时间：2013-02-22T12:28:15.713
> 
> 标签：android, canvas, bitmap, ondraw

我正在使用路径学习画布和位图，目前正在开发一个绘图应用程序，用户可以在扩展视图上自由绘制路径。该应用程序还允许用户将位图作为背景导入并在其上绘图。

**扩展名为 DoodleView 的视图：**

```
 public DoodleView(Context context, AttributeSet attrs) 
   {
       super(context, attrs); // pass context to View's constructor
       this.context_new=context;
       setFocusable(true);
       setFocusableInTouchMode(true);
   } // end DoodleView constructor 
```

**绘制：**

```
 @Override
   protected void onDraw(Canvas canvas) 
   {
       canvas.drawBitmap(bitmap, 0, 0, null); 
       for (Path p : paths)
       {
           paintLine.setColor(colorsMap.get(p));
           canvas.drawPath(p, paintLine);          
       }       
       paintLine.setColor(selectedColor);
       canvas.drawPath(mPath, paintLine);   

       if (ConvertCanvasToBitmap == true) 
       {
           canvas.drawBitmap(bitmap, 0, 0, paintLine);
           ConvertCanvasToBitmap = false;
       }           
   } 
```

**水平翻转：**

```
public void flipImageHorizontally()  
{       
    ConvertCanvasToBitmap = true;
    invalidate();           
    Matrix flipHorizontalMatrix = new Matrix();
    flipHorizontalMatrix.setScale(-1,1);
    flipHorizontalMatrix.postTranslate(bitmap.getWidth(),0);

    Bitmap HorizontalFlipped = Bitmap.createBitmap
            (bitmap, 0, 0, bitmap.getWidth(), bitmap.getHeight(), flipHorizontalMatrix, true);
    bitmap = HorizontalFlipped;
    invalidate();       
} 
```

## 问题：

我的目标是对于已经绘制的路径，当用户尝试翻转图像时，绘制的路径也会被翻转。（即路径已经成为图像的一部分，并且用户不再允许撤消路径）。

但是，我用上面的代码测试过，当按下翻转按钮时，位图背景可以翻转，但绘制的会消失。然后当进一步绘制它时，路径将再次出现，但保持不变。

简而言之，当按下翻转按钮时，如何使路径成为位图的一部分？

谢谢！

## 编辑：

基于[Android 2.1 View 的 getDrawingCache() 方法总是返回 null](https://stackoverflow.com/questions/2817166/android-2-1-views-getdrawingcache-method-always-returns-null)，我`onDraw`用下面的代码修改了，但是得到了

```
02-22 21:38:34.685: E/AndroidRuntime(18617): java.lang.NullPointerException
02-22 21:38:34.685: E/AndroidRuntime(18617):    at android.graphics.Bitmap.createBitmap(Bitmap.java:455)
02-22 21:38:34.685: E/AndroidRuntime(18617):    at com.pearmak.drawing.DoodleView.onDraw(DoodleView.java:148) 
```

**修改后的代码：**

```
 @Override
   protected void onDraw(Canvas canvas) 
   {
       canvas.drawBitmap(bitmap, 0, 0, null); // draw the background screen

       for (Path p : paths)
       {
           paintLine.setColor(colorsMap.get(p));
           paintLine.setStrokeWidth(widthMap.get(p));
           canvas.drawPath(p, paintLine);          
       }       
       paintLine.setColor(selectedColor);
       paintLine.setStrokeWidth(selectedWidth);
       canvas.drawPath(mPath, paintLine);   

       if (ConvertCanvasToBitmap == true) 
       {
           //Method 1
//         RelativeLayout page = (RelativeLayout) findViewById(R.id.doodleView);
//         Bitmap screenshot = Bitmap.createBitmap(page.getWidth(), page.getHeight(), Config.ARGB_8888);
//         bitmap = screenshot;
//         ConvertCanvasToBitmap = false;

           //Method 2
           Bitmap screenshot2;
               layout(0, 0, DoodlzViewWidth, DoodlzViewHeight);
           setDrawingCacheEnabled(true);
           screenshot2 = Bitmap.createBitmap(getDrawingCache()); // LINE 148
           setDrawingCacheEnabled(false);
           bitmap = screenshot2;
       }           
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:36:26.643

您需要从该视图创建位图，请参考绘图缓存，如这里

[Android 2.1 View 的 getDrawingCache() 方法总是返回 null](https://stackoverflow.com/questions/2817166/android-2-1-views-getdrawingcache-method-always-returns-null)

现在尝试翻转这个位图

# opencv - 嘈杂的 kinect 颜色 (rgb) 图像

> ID：15024259
> 
> 赞同：0
> 
> 时间：2013-02-22T12:28:15.583
> 
> 标签：opencv, kinect, openni

我正在使用 opencv 界面（[http://docs.opencv.org/doc/user_guide/ug_highgui.html?highlight=kinect](http://docs.opencv.org/doc/user_guide/ug_highgui.html?highlight=kinect)）从 kinect 相机获取颜色（rgb）和深度帧。对于标准的 VGA 640x480 分辨率和类似的代码

```
capture.retrieve( bgrImage, OPENNI_BGR_IMAGE ); 
```

我明白了：

[![](../Images/08b1bdaeec8abc0631ca584185ba5296.png)](https://i.stack.imgur.com/xeRgE.png)

我觉得这真的很吵。这是 kinect RGB 相机的正常质量吗？我尝试了各种过滤（模糊、锐化、打开..）程序，但我得到了一些小的改进。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T17:45:25.333

我不知道拍摄这张照片的条件，我无法证明使用 Kinect 拍摄的图像的质量，所以我忽略了这部分问题。

要提高图像质量，您可以做的一件非常简单的事情是对可能获得的几帧进行平均。这就对了。

另一个选项包括，例如，可以很好地处理这种噪声的双边滤波或均值偏移滤波（我不确定你将如何纯粹使用现成的 OpenCV 函数来做后面的事情）。例如，这里有三行图像。在第二列中，您可以看到 Canny 为第一列中的图像找到的边缘。第一行按原样显示输入图像，第二行是特定 Mean Shift 的结果，最后一行用于双边滤波。

![在此处输入图像描述](../Images/185e65276dae39794569d191dda7d48e.png) ![在此处输入图像描述](../Images/89e41c61f08ead3106adad057ddf9370.png)

![在此处输入图像描述](../Images/a3bfefaad852cc9209fa1f3cba2bbe8e.png) ![在此处输入图像描述](../Images/e70c0437c89833115ed63f7298c6f2c3.png)

![在此处输入图像描述](../Images/fcb0a914f2631b95d0f9405ed4a360fa.png) ![在此处输入图像描述](../Images/828f326f565508b92d9ea2c8f9c484cf.png)

虽然结果特别好，但问题是这些过滤技术对于当今使用的典型计算机来说速度很慢。

# ios - 在 iOS App 中下载多张图片

> ID：15024261
> 
> 赞同：1
> 
> 时间：2013-02-22T12:28:34.737
> 
> 标签：ios, objective-c, nsurlconnection, nsurlrequest

我想在 iOS 应用程序中从 URL 下载多个图像到我的设备。

```
//
//  ImageDownload.m
//

#import "ImageDownload.h"

@implementation ImageDownload {
    int *position;
    NSArray *downloableImages;
}

- (void)start:(NSArray *)images delegate:(id)delegate
{
    position = 0;
    downloableImages = images;

    NSUInteger *count = ((NSUInteger *)[downloableImages count]);
    NSLog(@"%d", count);

    [self startDownload];
}

- (void)startDownload
{
    NSUInteger *imageDataCount;

    NSArray *image;
    NSString *filename;
    NSString *fileurl;

    NSURLRequest *imageUrlRequest;

    image = [downloableImages objectAtIndex:position];

    NSLog(@"%d", position);

    NSArray *imageData = [image valueForKey:@"image"];
    imageDataCount = ((NSUInteger *)[imageData count]);

    if (imageDataCount > 0) {
        filename = [imageData objectAtIndex:0];
        fileurl = [imageData objectAtIndex:1];

        NSLog(@"%@", fileurl);

        imageUrlRequest = [NSURLRequest requestWithURL:[NSURL URLWithString:fileurl]];
        NSURLConnection *imageUrlConnection = [[NSURLConnection alloc] initWithRequest:imageUrlRequest delegate:self startImmediately:TRUE];
    } else {
        NSUInteger *count = ((NSUInteger *)[downloableImages count]);

        if (((NSUInteger *)position) < ((NSUInteger *)count - 1)) {
            position = position + 1;

            [self startDownload];
        }
    }
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    NSLog(@"finish image...");
    NSUInteger *count = ((NSUInteger *)[downloableImages count]);

    if (((NSUInteger *)position) < ((NSUInteger *)count - 1)) {
        position = position + 1;

        [self startDownload];
    }
}

@end 
```

现在......我只检查下载的位置和当前 URL，存在 27 个要下载的文件......但下载不是一个一个的......检查这个输出：

> 位置：0
> http.....fichero00.jpg
> 完成下载
> 
> 位置：4
> http.....fichero04.jpg
> 完成下载
> 
> 位置：8
> http.....fichero08.jpg
> 完成下载

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:51:20.687

在你的 .h 文件中创建一个 ivar`NSOperationQueue *operationQueue;`并在你的 .m 文件中初始化它：

```
operationQueue = [[NSOperationQueue alloc] init];
operationQueue.maxConcurrentOperationCount = 1; 
```

要下载图像，请创建一个获取图像 URL 并为每个图像调用它的方法：

```
-(void)downloadImageAtURL:(NSURL *)imageURL {

    [NSURLConnection sendAsynchronousRequest:[NSURLRequest requestWithURL:imageURL] queue:operationQueue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
        // Do something with your images here...
    };
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T12:48:08.903

你可以试试这个代码。它 100% 为我工作

[您可以在此处获得更多参考](http://iosdeveloperfamily.webs.com/apps/blog/show/prev?from_id=19572385)

```
-(IBAction)startdownload
{
for (int i=0; i<[downloadarray count]; i++)   //download array have url links
{ 
NSURL *URL = [NSURL URLWithString:[downloadarray objectAtIndex:i]];
NSMutableURLRequest *urlRequest = [[NSMutableURLRequest alloc]initWithURL:URL];
NSOperationQueue *queue = [[NSOperationQueue alloc]init];
[NSURLConnection sendAsynchronousRequest:urlRequest queue:queue  completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)
 {
  if([data length] > 0 && [[NSString stringWithFormat:@"%@",error] isEqualToString:@"(null)"])
{
 //make your image here from data.
 UIImage *imag = [[UIImage alloc] initWithData:[NSData dataWithData:data]];
 NSArray *array = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,    NSUserDomainMask, YES);
 NSString *docDir = [array objectAtIndex:0];
 NSString *imgstr=[NSString stringWithFormat:@"%d",i];
 NSString *pngfilepath = [NSString stringWithFormat:@"%@sample%@.png",docDir,imgstr];
NSData *data1 = [NSData dataWithData:UIImagePNGRepresentation(imag)];
 [data1 writeToFile:pngfilepath atomically:YES];
  }
 else if ([data length] == 0 && [[NSString stringWithFormat:@"%@",error] isEqualToString:@"(null)"])
{
  NSLog(@"No Data!");
}
  else if (![[NSString stringWithFormat:@"%@",error] isEqualToString:@"(null)"]){
 NSLog(@"Error = %@", error);
 }
}];

 }

 -(IBAction)viewfile
 {
 NSMutableArray *arr=[[NSMutableArray alloc]init];

  NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,   NSUserDomainMask, YES);
 NSString *documentsDirectory = [paths objectAtIndex:0];
 NSString *pngfilepath = [NSString stringWithFormat:@"%@",documentsDirectory];
 NSArray *filePathsArray = [[NSFileManager defaultManager] subpathsOfDirectoryAtPath:pngfilepath error:&error];
 for (int i=0; i<[filePathsArray count]; i++){
 NSString *pngfilepath = [NSString stringWithFormat:@"%@%@",documentsDirectory,  [filePathsArray objectAtIndex:i]];
 [arr addObject:[UIImage imageWithContentsOfFile:pngfilepath]];
 }
myimageview = [[UIImageView alloc] initWithImage:[arr objectAtIndex:0]]; //Here myimageview is UIImageView

 } 
```

希望这可以帮助！！！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T12:42:56.337

解决 NSOperationQueue 它允许您控制同时运行多少操作。

创造：

```
NSOperationQueue *queue = [NSOperationQueue new];
queue.maxConcurrentOperationCount = 1; 
```

然后添加操作：

```
NSBlockOperation *operation = [NSBlockOperation blockOperationWithBlock:^{
    ... here is you code with converting image to data and addition it to NSURLConnection
}];
[operation setCompletionBlock:^{
    ....something that you want to do, after operation completes
}];
[queue addOperation:operation]; 
```

有关 NSOperation 的更多信息： [https ://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSOperation_class/Reference/Reference.html#//apple_ref/occ/cl/NSOperation](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSOperation_class/Reference/Reference.html#//apple_ref/occ/cl/NSOperation)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T17:35:00.807

这是我的新代码...尝试更新 UIProgressView 时出现延迟

```
//
//  ImageDownload.m
//

#import "ImageDownload.h"

@implementation ImageDownload {
    NSMutableArray *downloableImages;
    int position;

    Sync *mySync;
}

- (void)start:(NSArray *)images sync:(Sync *)sync
{
    NSArray *imageData;
    int imageDataCount;

    mySync = sync;
    downloableImages = [[NSMutableArray alloc] init];

    for (NSArray *image in images) {
        imageData = [image valueForKey:@"image"];
        imageDataCount = [imageData count];

        if (imageDataCount > 0) {
            [downloableImages addObject:imageData];
        }
    }

    [self downloadAllFiles];
}

- (void)downloadAllFiles
{
    NSString *filename;
    NSString *fileUrl;

    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES);
    NSString *cacheDirectory = [paths objectAtIndex:0];

    position = 0;
    int count = [downloableImages count];

    NSLog(@"%@", downloableImages);
    NSLog(@"total files %d", count);

    for (NSArray *image in downloableImages) {
        filename = [image objectAtIndex:0];
        fileUrl = [image objectAtIndex:1];

        NSURL *url = [NSURL URLWithString:fileUrl];
        NSMutableURLRequest *urlRequest = [[NSMutableURLRequest alloc] initWithURL:url];

        NSOperationQueue *queue = [[NSOperationQueue alloc] init];
        [NSURLConnection sendAsynchronousRequest:urlRequest queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
            position++;

            float progress = (float)position / (float)count;
            //update UIProgressView
            [mySync setProgressImageDownload:progress];

            if ([data length] > 0 && [[NSString stringWithFormat:@"%@", error] isEqualToString:@"(null)"]) {
                UIImage *downloadedImage = [[UIImage alloc] initWithData:[NSData dataWithData:data]];
                NSString *imageDestinationPath = [NSString stringWithFormat:@"%@%@", cacheDirectory, filename];

                NSData *imageData = [NSData dataWithData:UIImageJPEGRepresentation(downloadedImage, 100.0)];
                [imageData writeToFile:imageDestinationPath atomically:YES];
            }

            if (position == count) {
                NSLog(@"all complete...");

                [mySync downloadImagesComplete];
            }
        }];
    }
}

@end 
```

# c++ - 如何创建一个html树？

> ID：15024267
> 
> 赞同：1
> 
> 时间：2013-02-22T12:29:19.850
> 
> 标签：c++, html, c, parsing

我需要挖掘一些 html 文件，我想首先将它们转换为树的可读形式，一行中的一个标签。不过我没有html经验。有人可以更正我的代码并指出我忘记的规则吗？

我的代码不适用于现实生活中的页面。在程序执行结束时，嵌套计数器应设置为 0，因为程序应保留它遇到的所有嵌套标记。它不是。对于一个 facebook 页面，还有 2000 多个标签保持打开状态。

在有人建议我使用图书馆之前，我还没有看到任何好的图书馆。对于我的页面转换为 xml 以某种方式失败并且 htmlcxx 库没有适当的文档。

```
#include <cstdio>

char get_char( FILE *stream ) {
    char c;
    do
        c = getc(stream);
    while ( c == ' ' || c == '\n' || c == '\t' || c == '\r' );
    return c;
}

void fun( FILE *stream, FILE *out ) {   
    int counter = -1;
    char c;

    do {
        c = get_char(stream);
        if ( c == EOF )
            break;

        if ( c != '<' ) { // print text
            for ( int i = counter + 1; i; --i )
                putc( ' ', out );
            fprintf( out, "TEXT: " );
            do {
                if ( c == '\n' )
                    fprintf( out, "<BR>" ); // random separator
                else
                    putc( c, out );
                c = getc( stream );
            } while ( c != '<' );
            putc( '\n', out );
        }

        c = getc( stream );
        if ( c != '/' ) { // nest deeper
            ++counter;
            for ( int i = counter; i; --i )
                putc( ' ', out );
        } else { // go back in nesting
            --counter;
            // maybe here should be some exception handling
            do // assuming there's no strings in quotation marks here
                c = getc( stream );
            while ( c != '>' );
            continue;
        }

        ungetc( c, stream );
        do { // reading tag
            c = getc(stream);
            if( c == '/' ) { // checking if it's not a <blahblah/>
                c = getc(stream);
                if ( c == '>' ) {
                    --counter;
                    break;
                }
                putc( '/', out );
                putc( c, out );
            } else if ( c == '"' ) { // not parsing strings put in quotation marks
                do {
                    putc( c, out ); c = getc( stream );
                    if ( c == '\\' ) {
                        putc( c, out ); c = getc( stream );
                        if ( c == '"' ) {
                            putc( c, out ); c = getc( stream );
                        }
                    }
                } while ( c != '"' );
                putc( c, out );
            } else if ( c == '>' ) { // end of tag
                break;
            } else // standard procedure
                putc( c, out );
        } while ( true );
        putc( '\n', out );
    } while (true);
    fprintf( out, "Counter: %d", counter );
}

int main() {
    const char *name = "rfb.html";
    const char *oname = "out.txt";
    FILE *file = fopen(name, "r");
    FILE *out = fopen(oname, "w");
    fun( file, out );
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:44:57.503

HTML != XML 标签可以是非封闭的，例如`<img ...>`被认为等于`<img ... />`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T12:56:53.557

如此有趣和有用的话题，几乎没有答案。真的很奇怪……

很难找到好的 C++ HTML 解析器！我试图引导正确的方向......它可能会帮助你继续前进......

Lib curl 页面有一些源代码可以帮助您进行操作。遍历 dom 树的文档。您不需要 xml 解析器。在格式错误的 html 上不会失败。

[http://curl.haxx.se/libcurl/c/htmltidy.html](http://curl.haxx.se/libcurl/c/htmltidy.html)

另一种选择是 htmlcxx。从网站描述：

htmlcxx 是一个用于 C++ 的简单的非验证 css1 和 html 解析器。

可以尝试像 tidyHTML 这样的库 - [http://tidy.sourceforge.net](http://tidy.sourceforge.net)（免费）

如果您使用的是 Qt 4.6，则可以使用 QWebElement。一个简单的例子：

框架->setHtml(HTML); QWebElement document = frame->documentElement(); QList imgs = document.findAll("img"); 这是另一个例子。[http://doc.qt.digia.com/4.6/webkit-simpleselector.html](http://doc.qt.digia.com/4.6/webkit-simpleselector.html)

# opengl - 无符号整数纹理的片段着色器

> ID：15024271
> 
> 赞同：2
> 
> 时间：2013-02-22T12:29:45.723
> 
> 标签：opengl, glsl, opengl-3, fragment-shader

我正在为无符号整数纹理使用以下着色器来读取数据：片段着色器：

代码 ：

```
#version 150
out uvec4 fragColor;
uniform uint factor;
void main()
{
uint temp=factor;
temp=temp/2;
fragColor = uvec4(temp,temp,temp,temp);
} 
```

但我在驱动程序 A 上遇到错误：

“编译失败。错误：0:7：'/'：错误的操作数类型。不存在接受'uint'类型的左操作数和'const int'类型的右操作数的操作'/'（并且有没有可接受的转换）错误：1 个编译错误。没有生成代码。”

在驱动程序 B 上，它运行良好。驱动程序 A 有问题还是我的着色器有误？如果错了，我怎样才能达到同样的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T16:09:39.497

试试这个：

```
temp = temp / uint(2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T19:19:50.240

GLSL 不允许有符号整数和无符号整数之间的隐式转换，因此二进制操作数的两个操作数必须相同。采用：

```
temp = temp / 2u; 
```

使用无符号整数常量。

# python - 为什么 Python 变量每次被修改时都需要一个新的地址（id）？

> ID：15024275
> 
> 赞同：0
> 
> 时间：2013-02-22T12:30:17.540
> 
> 标签：python

只是想知道这背后的逻辑是什么？从表面上看，这似乎有点低效，每次你做一些简单的事情，比如“x=x+1”，它都必须采用一个新地址并丢弃旧地址。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T12:32:25.073

Python 变量（在 Python 中称为标识符或名称）是对值的引用。该`id()`函数说明了该值，而不是名称。

许多值是不可变的；整数、字符串、浮点数都*不会*原地改变。当您添加`1`到另一个整数时，您返回一个*新*整数，然后替换对旧值的引用。

您可以将 Python 名称视为与值相关联的标签。如果您将值想象为气球，则每次分配给该名称时，您都在为标签重新分配一个新气球*。*如果气球上没有其他标签，它就会随风飘走，再也见不到了。该`id()`函数为您提供该气球的唯一编号。

请参阅我[以前的答案，](https://stackoverflow.com/questions/12080552/python-list-doesnt-reflect-variable-change-new-to-python/12080644#12080644)其中我更多地讨论了值作为气球的想法。

这可能看起来效率低下。对于许多*经常使用*的*小*值，Python 实际上使用了一个称为 interning 的过程，它会缓存这些值的存储以供重复使用。`None`是这样一个值，小整数和空元组 ( `()`) 也是如此。您可以使用该[`intern()`](http://docs.python.org/2/library/functions.html#intern)函数对您希望经常使用的字符串执行相同的操作。

但请注意，只有当它们的引用计数（“标签”的数量）降至 0 时，才会清理值。大量的值一直在各处重复使用，尤其是那些内部整数和单例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T12:32:17.507

因为基本类型是不可变的，所以每次修改都需要再次实例化

...这非常好，尤其是对于[线程安全](http://en.wikipedia.org/wiki/Thread-safe)函数

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-22T12:32:30.977

`=`操作员不会修改对象，它会将名称分配给完全不同的对象，该对象可能已经或可能没有 id 。

对于您的示例，整数是不可变的；没有办法在其中添加一些东西并保持相同的 id。

而且，事实上，小整数至少在 cPython 中是被实习的，所以如果你这样做：

```
x = 1
y = 2
x = x + 1 
```

然后`x`和`y`可能有相同的id。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-22T12:32:55.673

在 python 中，像整数和字符串这样的“原始”类型是不可变的，这意味着它们不能被修改。

Python 实际上非常高效，因为正如**@Wooble**评论的那样，«*非常短的字符串和小整数被保留。*»：如果两个变量引用相同的（*小*）不可变值，则它们的 id 相同（减少重复的不可变值）。

```
>>> a = 42
>>> b = 5
>>> id(a) == id(b)
False
>>> b += 37
>>> id(a) == id(b)
True 
```

使用不可变类型背后的原因是对这些值的并发访问的安全方法。

归根结底，这取决于设计选择。

根据您的需要，您可以更多地利用一个实现而不是另一个。
例如，在一种有点相似的语言 Ruby 中可以找到不同的哲学，其中那些在 Python 中是不可变的类型不是。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-22T12:40:42.190

准确地说，赋值`x=x+1`不会修改`x`引用的对象，它只是让 x 指向另一个值为 的对象`x+1`。

要理解背后的逻辑，需要了解[值语义](http://en.wikipedia.org/wiki/Value_semantics)和引用语义之间的区别。

具有值语义的对象只意味着它的值很重要，而不是它的身份。而具有引用语义的对象专注于其身份（在 Python 中，身份可以从 中返回`id(obj)`）。

通常，值语义意味着对象的不变性。或者相反，如果一个对象是可变的（即就地更改），这意味着它具有引用语义。

让我们简要解释一下这种不变性背后的基本原理。

具有引用语义的对象可以**就地**更改而不会丢失其原始地址/身份。这是有道理的，因为具有引用语义的对象的身份使自己与其他对象区分开来。

相反，具有价值语义的对象永远不应该改变自己。

首先，这在理论上是可能的，也是合理的。由于只有值（而不是其身份）是重要的，因此当需要更改时，将其交换为具有不同值的另一个身份是安全的。这称为[参照透明性](http://en.wikipedia.org/wiki/Referential_transparency_%28computer_science%29)。请注意，这对于具有引用语义的对象是不可能的。

其次，这在实践中是有益的。正如 OP 所认为的，每次更改旧对象时丢弃旧对象似乎效率低下，但大多数时候它比不更有效。一方面，Python（或任何其他语言）具有实习生/缓存方案来减少要创建的对象。更重要的是，如果价值语义的对象被设计为可变的，那么在大多数情况下它会占用更多的空间。

例如，Date 具有值语义。如果它被设计为可变的，任何从内部字段返回日期的方法都会将句柄暴露给外界，这是有风险的（例如，外部可以直接修改这个内部字段而无需求助于公共接口）。类似地，如果通过引用某个函数/方法来传递任何日期对象，则可以在该函数/方法中修改该对象，这可能与预期不同。为了避免这些副作用，必须进行[防御性编程](http://en.wikipedia.org/wiki/Defensive_programming): 他不是直接返回内部日期字段，而是返回它的一个克隆；他不是通过引用传递，而是通过值传递，这意味着制作了额外的副本。正如人们可以想象的那样，有更多的机会创建比必要的更多的对象。更糟糕的是，这些额外的克隆使代码变得更加复杂。

总之，不变性强化了价值语义，它通常涉及更少的对象创建，更少的副作用和更少的麻烦，并且更易于测试。此外，不可变对象本质上是线程安全的，这意味着在多线程环境中锁更少，效率更高。

这就是为什么像数字、字符串、日期、时间这样的值语义的基本数据类型都是不可变的（嗯，C++ 中的字符串是一个例外，这就是为什么有这么多`const string&`东西可以避免字符串被意外修改）。`Date`作为一个教训，Java 在将值语义类, `Point`, `Rectangle`,设计`Dimension`为可变时犯了错误。

众所周知，OOP 中的对象具有三个特征：状态、行为和身份。具有值语义的对象不是典型的*对象*，因为它们的身份根本不重要。通常它们是*被动*的，主要用于描述其他*真实的*、*主动*的对象（即具有引用语义的对象）。这是区分值语义和引用语义的一个很好的提示。

# iphone - 获取 NSManagedObjectContext 的所有子上下文

> ID：15024289
> 
> 赞同：0
> 
> 时间：2013-02-22T12:30:42.717
> 
> 标签：iphone, core-data, magicalrecord

在核心数据模型中，有三个 Entity `A`，`B`并且`C`where可以与和/或`A`有关系。`B``C`

由于某些原因`B`，并且`C`是在 s 上下文的子上下文中创建的（它们都共享*相同*的子上下文）`A`。因此，有*一个*父上下文（由 使用`A`）具有*一个*子上下文（由`B`and使用`C`）。

现在我需要

1.  获取所有`A`s 和
2.  获取所有`B`s（或`C`s）。

我正在使用[MagicalRecord](https://github.com/magicalpanda/MagicalRecord)与 CoreData进行交互，因此（1）很容易实现：

```
NSArray *all_As = [A findAll]; 
```

为了实现 (2)，我现在可以使用 that I know`A`的上下文：

```
NSManagedObjectContext *contextOfA = a.managedObjectContext 
```

`a`的实例在哪里`A`。请注意，由于我的应用程序的设计方式，总有一个which`a`可用于获取所有实例（换句话说：我不需要访问和没有）。如上所述，和（和）之间不一定存在关系。最后，甚至不必存在（并且可以没有）。`B``C``B``C``A``A``B``C``a``b``c``a`

但我确实知道，`B`并且`C`生活在`A`'s child context 中。

所以基本上我只需要获取`a.managedObjectContext`的子上下文并对该子上下文执行获取请求：

```
NSArrray *all_Bs = [B findAllInContext: a.managedObjectContext.childContext] 
```

但是**我怎样才能访问`a.managedObjectContext.childContext`？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:07:19.307

你不能简单地称呼它吗？

```
NSArray *all_Bs = [B findAll]; 
```

如果没有提及，MR 应该能够自己处理上下文。

如果这不起作用-您无法预测它是否会使用第三方框架-您为什么不简单地保留对子上下文的引用并在获取时使用它`B`？

*（为什么你会使用像 MR 这样的东西我无法理解。一旦你真正使用了 Core Data 的高级功能，它确实会让事情变得更加复杂。）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T11:29:22.450

我找到了解决问题的方法：

在我的`AppDelegate`，我放了一个变量`NSManagedObjectContext *tempObjectContext;`。当我现在添加一个`A`对象时，我将它添加到 this`tempObjectContext`中。

正如我在原始帖子中所述，添加新对象或对象`a`时，这将永久存在。但是，不必与 . 因此，我也将这些和对象添加到其中。`B``C``B``C``a``B``C``tempObjectContext`

现在，当我想保存一个`B`或`C`对象时，我将它们保存到`[NSManagedObjectContext defaultContext]`并从中删除它们`tempObjectContext`：

```
B *finalObject = [B createInContext:[NSManagedObjectContext defaultContext]];
NSDictionary *attributes = [[B entityDescription] attributesByName];
[finalObject setValuesForKeysWithDictionary:[self.temp dictionaryWithValuesForKeys:[attributes allKeys]]];

[[NSManagedObjectContext defaultContext] insertObject:finalObject];

[self.mainDelegate.tempObjectContext deleteObject:self.temp]; 
```

那么，我为什么要这么做？简单：当我将所有`A`,`B`和`C`放入同一个对象中，然后创建一个`a`and 之后`b`，如果不保存就无法保存`b`（`a`因为它们都在同一上下文中抵抗）。使用单独的上下文可以解决这个问题。

# php - 如何在 PHP 中使用 imap 从电子邮件中提取内联图像（不是附件）

> ID：15024290
> 
> 赞同：2
> 
> 时间：2013-02-22T12:30:45.690
> 
> 标签：php, imap

当我在 php 中使用 imap 获取电子邮件时，我得到了电子邮件正文内容，但我无法提取粘贴且未附加在电子邮件正文中的内联图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:40:29.647

在电子邮件内容的正文中搜索图像。

假设您的电子邮件正文是，`$body`那么您可以使用 preg_match 获取图像 url。使用此 preg_match 表达式来获取图像源。

```
preg_match('/< *img[^>]*src *= *["\']?([^"\']*)/i', $body, $matches); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T08:53:50.657

> 嘿，我想我有一个解决方案

```
<?php
   $hostname = '{myserver/pop3/novalidate-cert}INBOX';
   $username = 'username';
   $password = 'password';

   /* try to connect */
   $inbox = imap_open($hostname,$username,$password) or die('Cannot connect to Tiriyo: ' . imap_last_error());
   $msgno = 0; //message id
   $no_of_occurences = 0;
   $intStatic = 2;//to initialize the mail body section

   $decode = imap_fetchbody($mbox, $msgno , "");    
   $no_of_occurences = substr_count($decode,"Content-Transfer-Encoding: base64");//to get the no of images
   if($no_of_occurences > 0){
        for($i = 0; $i < $no_of_occurences; $i++){  
             $strChange =   strval($intStatic+$i);
             $decode = imap_fetchbody($mbox, $msgno , $strChange);//to get the base64 encoded string for the image
             $data = base64_decode($decode);
             $fName = time()."_".$strChange . '.gif';
             $file = $fName;
             $success = file_put_contents($file, $data);        //creates the physical image    
        }           
    }
    imap_close($inbox);
 ?> 
```

# ruby-on-rails - Neo4j 与 Ruby On Rails

> ID：15024293
> 
> 赞同：1
> 
> 时间：2013-02-22T12:31:04.973
> 
> 标签：ruby-on-rails, ruby, neo4j

我按照本指南创建了一个部署在 heroku 上的 ruby​​ on rails Web 应用程序

[http://ruby.railstutorial.org/ruby-on-rails-tutorial-book](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)

该应用程序与本教程非常相似，用户可以创建一个帐户、登录、创建一个包含属于该用户的一些信息的对象。我创建的这些对象旨在表示我希望能够在它们之间创建关系的节点。

我一直在阅读 Neo4j，它似乎最适合 ruby​​，但后来我读到它只适用于 JRuby。谁能告诉我它是否适用于我的实现，如果可以，如何？或者如果它dosent，我应该用什么代替？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T13:45:16.390

JRuby 允许 Ruby 通过 Java API 直接访问 Neo4j。这是最快的实现。然而，Neo4j 还提供了一个 REST API，允许任何语言通过 HTTP 访问它。

我似乎您的答案可能在这里：[哪个 Ruby REST API client for neo4j？](https://stackoverflow.com/questions/8335136/which-ruby-rest-api-client-for-neo4j)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-27T15:42:50.527

这再次使用了 Neography gem，但是这个博客 maxdemarzi 有一些关于将 ruby​​ 与 neo4j 集成的非常好的帖子。

这是一个链接： http: [//maxdemarzi.com/2012/01/04/getting-started-with-ruby-and-neo4j/](http://maxdemarzi.com/2012/01/04/getting-started-with-ruby-and-neo4j/)

但是正如其他人所提到的，我认为除了 JRuby 之外，您不会得到任何可以直接与 Java API 对话的东西。

# java - 保存在类数据共享存档 (classes.jsa) 中的 Java 代码是本地编译的还是字节码？

> ID：15024297
> 
> 赞同：7
> 
> 时间：2013-02-22T12:31:17.220
> 
> 标签：java, performance, jvm, jit, jsa

我想知道创建[类数据共享](http://docs.oracle.com/javase/1.5.0/docs/guide/vm/class-data-sharing.html)存档（通过运行`java -Xshare:dump`）是否将字节码编译为本机代码。

没有很多关于类数据共享内部的文档。我链接的页面说`java -Xshare:dump`

> 将系统 jar 文件中的一组类加载到私有内部表示中，并将该表示转储到文件中。

但是没有说明这段代码是否被编译。

*（可能相关：[通过将自己的应用程序类添加到 classes.jsa 来加速应用程序启动](https://stackoverflow.com/questions/4692076/speed-up-application-start-by-adding-own-application-classes-to-classes-jsa)）*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T13:33:16.190

在这两种情况下，它都是缓存中的本机代码（请参阅您提供的链接中关于在不同架构的机器上重新生成缓存的讨论）。IBM JVM 进一步提供了更多选项和更好的集群布局，但 Oracle 也可以。

# java - 如何通过布尔值调用名称

> ID：15024299
> 
> 赞同：-3
> 
> 时间：2013-02-22T12:31:21.117
> 
> 标签：java, boolean

我想叫有CEO = true的人的名字；在这种情况下是 Tristen。我该怎么办？我已经将公共字符串名称和公共布尔 CEO 转换为静态。

我想要达到的是它看起来像这样

system.out.printIn("你的 CEO 是 Tristen");

```
public class business {

public static String name;
public String lastname;
public String email;
public String department;
public static boolean CEO;
public boolean employee;
public boolean assistant;
public boolean head;
public boolean manager;

public static void main(String[]args){

    business tristen;
    business jan;
    business robert;
    business kevin;
    business ben;

    tristen = new business();
    tristen.name = "Tristen";
    tristen.lastname = "Korsuize";
    tristen.email = " ";
    tristen.department = "Magic";
    tristen.CEO = true;
    tristen.employee = false;
    tristen.assistant = false;
    tristen.head = false;
    tristen.manager = false;

    jan = new business();
    jan.name = "Jan";
    jan.lastname = "Lindenberg";
    jan.email = "Jan002_003@hotmail.com";
    jan.department = "Magic";
    jan.CEO = false;
    jan.employee = false;
    jan.assistant = false;
    jan.head = false;
    jan.manager = true;

    robert = new business();
    robert.name = "Robert";
    robert.lastname = "Irving";
    robert.email = " ";
    robert.department = "Magic";
    robert.CEO = false;
    robert.employee = false;
    robert.assistant = true;
    robert.head = false;
    robert.manager = false;

    if(business.CEO = true){
        System.out.println("Your CEO is"+ " "+ business.name);
    }

    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:34:16.897

我会将人们放在一个集合中并对其进行迭代，例如

```
List<business> businesses = new ArrayList<business>();
// add people here...

foreach (business b : businesses) {
   if (b.isCEO()) {
     System.out.println(b);
   }
} 
```

一些额外的评论：

1.  Java 命名约定建议您应该大写您的类名，例如`Business`
2.  你的成员是公开的。我会将它们设为私有并通过构造函数进行实例化。这促进了封装——OO 编程的一个关键特性。通过方法公开它们（隐藏实现）
3.  询问对象是否是 CEO - 不要将领域拉出来自己决定。见上面的例子
4.  我会尽量不使用`static`. 您拥有的所有信息都绑定在您的对象中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T12:39:58.043

和字段不应该是静态的`CEO`。`name`静态字段意味着该值被赋予`business`类的所有实例，而不仅仅是单个实例。例如;

```
tristen = new business();
tristen.CEO = true;

jan = new business();
jan.CEO = false;  //CEO is now false for all instances of business (tristen and jan) 
```

您可能希望在创建它们时将所有实例存储在某种形式中[`Collection`](http://docs.oracle.com/javase/6/docs/api/java/util/Collection.html)，然后您可以遍历集合并检查哪个是 CEO。

# c# - 使用垫片：并非所有代码路径都返回值

> ID：15024301
> 
> 赞同：0
> 
> 时间：2013-02-22T12:31:27.507
> 
> 标签：c#, twilio, shim

我使用垫片如下：

```
ShimTwilioRestClient.AllInstances.SendSmsMessageStringStringString =
(@this, num, to, msg) =>
{
    Assert.IsNotNull(msg);
}; 
```

但是第一行给了我这个错误：

> 并非所有代码路径都返回类型为 lambda 表达式的值 `Fakes.FakesDelegates.Func<TwilioReselientClient, String, String, String, SMSMessage>`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:35:29.047

大概该`SendSmsMessageStringStringString`属性是一个代表，它返回一个`SmsMessage`... 但你没有返回任何东西。

你*也许*可以逃脱：

```
ShimTwilioRestClient.AllInstances.SendSmsMessageStringStringString =
(@this, num, to, msg) =>
{
    Assert.IsNotNull(msg);
    return null;
}; 
```

...这取决于返回值会发生什么。

# jquery - 使用 JQuery 查找每个的最后一个

> ID：15024302
> 
> 赞同：15
> 
> 时间：2013-02-22T12:31:29.537
> 
> 标签：jquery

我有两个具有相同类名“Test”的表，我需要使用 JQuery 找出每个表的最后一个

请帮帮我。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-22T12:40:32.050

jQuery 1.1.4 引入了[last-child 选择器](http://api.jquery.com/last-child-selector/)：

> 描述：选择作为其父级的最后一个子级的所有元素。
> 
> 虽然 :last 只匹配一个元素，但 :last-child 可以匹配多个元素：每个父元素一个。

```
$("table:first tr td:last-child"); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-22T12:41:01.803

```
$('table:first tr').each(function() {
  var lasttd=  $(this).find(':last-child')
  //your code
}); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-02-22T12:42:49.247

循环遍历每个 tr 并获取最后一个 td`:last`

```
$('table:first tr').each(function(){
$(this).find('td:last').addClass('LastTD');
}); 
```

# iphone - 如何通过动画隐藏内容

> ID：15024324
> 
> 赞同：0
> 
> 时间：2013-02-22T12:32:28.803
> 
> 标签：iphone

我正在显示一个视图，其中有一个按钮。单击此按钮时，我将通过 Objective C 中定义的动画方法显示 PopUp 视图，并在 Popup 视图上添加图像。然后在视图上的任何点击此弹出视图通过将其宽度和高度设置为零来隐藏，但它上面的图像没有隐藏。我该如何隐藏它..？这些是我正在使用的方法..

单击按钮后调用此方法..

```
-(void)btnImageClkForPopUp:(id)sender
{  
[UIView beginAnimations:nil context:nil];
[UIView setAnimationDuration:2.5];
popup_viewforimage.frame=CGRectMake(8, 30, 300, 250);
popup_viewforimage.backgroundColor=[UIColor whiteColor];

UIImageView *imgview=[[UIImageView alloc]initWithFrame:CGRectMake(0, 0, 300, 250)];
imgview.image=[UIImage imageNamed:@"apple.jpeg"];
[popup_viewforimage addSubview:imgview];

[self.view addSubview:popup_viewforimage];   
[UIView commitAnimations];
} 
```

在点击视图后调用这两种方法来隐藏它

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch
{
if ([touch.view isKindOfClass:[UIButton class]])
{ 
 return NO;
}
return YES;   
}

-(void)hidekeyboard
{
 [UIView beginAnimations:nil context:nil];
 [UIView setAnimationDuration:2.5];
 popup_viewforimage.frame=  CGRectMake(15, 65, 0, 0);
 popup_viewforimage.backgroundColor=[UIColor grayColor];
 [self.view addSubview:popup_viewforimage];
  [UIView commitAnimations]; 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:41:18.793

```
for (UIView *vw in popup_viewforimage.subviews) {
    if ([vw isKindOfClass:[UIImageView class]]) {
        vw.hidden=YES;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:36:55.630

利用

```
[popup_viewforimage removeFromSuperView]; 
```

或者

将它的 alpha 设置为 0

```
popup_viewforimage.alpha=0.0; 
```

# html - 元素不是 Safari Windows 中的顶层

> ID：15024327
> 
> 赞同：6
> 
> 时间：2013-02-22T12:32:35.233
> 
> 标签：html, safari, z-index, always-on-top, html-object

我有`<div>`元素显示弹出消息。我已经设置`z-index:1000`并添加`<iframe>`了，但 div 元素仍然没有显示在 Safari 浏览器中的实时流视频（嵌入插件）上方。我使用了 Chrome 和 Firefox，两者都可以，但在 Safari Windows 中不起作用。

[这](http://jsfiddle.net/8C2py/5/)是我在小提琴中的代码。

```
<BODY style="background:transparent">
<div style="position:relative; z-index:0;">
    <object classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" codebase="http://www.apple.com/qtactivex/qtplugin.cab" width="240" height="180">
        <param name="wmode" value="transparent"></param>
        <embed height="180" width="240" align="left" src="xxxx.avi" autoplay="false" controller="true" wmode="transparent"></embed> 
    </object>

    <object>
        <param name="wmode" value="transparent"></param>
        <param name="movie" value="http://www.youtube.com/v/Q5im0Ssyyus?fs=1&amp;hl=en_US"></param>
        <param name="allowFullScreen" value="true"></param>
        <param name="allowscriptaccess" value="always"></param>
        <embed src="http://www.youtube.com/v/Q5im0Ssyyus?fs=1&amp;hl=en_US" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="240" height="180"></embed>
    </object>
</div>  

<div id="draggable">
    <div class="drag">
        <p>Drag me around!! Drag me around!!</p>
        <p>Drag me around!! Drag me around!!</p>
        <p>Drag me around!! Drag me around!!</p>
    </div>
    <iframe class="frame"></iframe>
</div> 
```

任何人都可以找到此代码的任何问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-25T06:41:21.087

您需要将 wmode 更改/设置为不透明。

```
<embed src="..." wmode="opaque"></embed> 
```

并尝试为第一个对象设置适当的类型。

```
<embed src="xxxx.avi" ...wmode="opaque" type="application/x-shockwave-flash"></embed> 
```

[http://jsfiddle.net/8C2py/7](http://jsfiddle.net/8C2py/7)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T20:10:54.763

据我所知，flash 位于所有 HTML 元素之上。

当弹出窗口存在时，您可以尝试隐藏它。不幸的是，我还没有看到解决方法。

一种好方法是使用与视频大小相同的占位符图像并切换它们

```
<div class="video">
    <!-- video here -->
</div>
<div class="placeholder" style="display:none;">
    <img src="path/to/placeholder.jpg"
</div> 
```

当您打开弹出窗口时

```
$(".video").css('display','none');
$(".placeholder").css('display','block'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T08:11:15.533

以下是该`z-index`物业的规格（来源：[w3.org](http://www.w3.org/TR/CSS2/visuren.html#propdef-z-index)）：

> 每个盒子属于一个堆叠上下文。给定堆叠上下文中的每个定位框都有一个整数堆叠级别，这是它在 z 轴上相对于同一堆叠上下文中其他堆叠级别的位置。

我认为这`<div class="drag">`与您的 flash 对象不在同一个堆叠上下文中。要确保堆叠上下文正确，请使其`<div id="draggable">`也是相对的，并为其提供比`<div>`包含 flash 对象的 z-index 更高的 z-index。

**注意：**我目前无法测试 Safari，所以请告诉我它是否有效：

```
<div style="position:relative; z-index:1;">
    ... your flash objects...
</div>  

<div id="draggable" style="position: relative; z-index: 2;">
    <div class="drag">
        <p>Drag me around!! Drag me around!!</p>
        <p>Drag me around!! Drag me around!!</p>
        <p>Drag me around!! Drag me around!!</p>
    </div>
    <iframe class="frame"></iframe>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T18:08:06.303

作品 IE FF Chr & Saf

在 iframe/视频上放置一个 div...

将 div 放置在图像上只需用您的图像替换 iframe ....

技巧部分是针对视频的...您必须在 src url 的末尾添加 ... ?wmode=transparent ... ...

```
<!DOCTYPE HTML > 
<style type="text/css"> 
.Container {position:relative;  float:left;  border: 1px solid #0f0; }
.Vid {position:absolute; top:7px; left:7px; width:90%; height:90%;  }
.Lyr { float:left; width:90%; height:90%; background-color: #a3a3e6;  opacity:0.5; border: 1px solid #f00; }
</style>

<div id="Cntr0" class="Container" style="width:220px; height:140px;">
    <iframe id="frm0" class="Vid" src='http://www.youtube.com/embed/y1VVXrUdO2s?wmode=transparent' frameborder='0'></iframe>
    <div id="div0" draggable="true" class="Lyr" ></div>
</div> 
```

或者如果你想使用你的目标代码......

```
<!DOCTYPE HTML > 
<style type="text/css"> 
.Container {position:relative;  float:left;  border: 1px solid #0f0; }
.Vid {position:absolute; top:7px; left:7px; width:90%; height:90%;  }
.Lyr { float:left; width:90%; height:90%; background-color: #a3a3e6;  opacity:0.5; border: 1px solid #f00; }
</style>

<div id="Cntr0" class="Container" style="width:260px; height:190px;">
     <object class="Vid" >
        <param name="wmode" value="transparent"></param>
        <param name="movie" value="http://www.youtube.com/v/Q5im0Ssyyus?fs=1&amp;hl=en_US"></param>
        <param name="allowFullScreen" value="true"></param>
        <param name="allowscriptaccess" value="always"></param>
        <embed src="http://www.youtube.com/v/Q5im0Ssyyus?fs=1&amp;hl=en_US" type="application/x-shockwave-flash" 
        allowscriptaccess="always" allowfullscreen="true" wmode="transparent" width="240" height="180"></embed>
    </object>
     <div id="div0" draggable="true" class="Lyr" ></div>
</div> 
```

和 avi 代码....

```
<!DOCTYPE HTML > 
<style type="text/css"> 
.Container {position:relative;  float:left;  border: 1px solid #0f0; }
.Vid {position:absolute; top:7px; left:7px; width:90%; height:90%;  }
.Lyr { float:left; width:90%; height:90%; background-color: #a3a3e6;  opacity:0.5; border: 1px solid #f00; }
</style>

<div id="Cntr0" class="Container" style="width:260px; height:190px;">
     <object class="Vid" classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" codebase="http://www.apple.com/qtactivex/qtplugin.cab" width="240" height="180" >
        <param name="wmode" value="transparent"></param>
        <embed height="180" width="240" align="left" src="xxxx.avi" allowscriptaccess="always" autoplay="false" controller="true" wmode="transparent"></embed> 
    </object>
     <div id="div0" draggable="true" class="Lyr" ></div>
</div> 
```

# php - 如何加密密码并在函数中使用它？

> ID：15024329
> 
> 赞同：0
> 
> 时间：2013-02-22T12:32:40.730
> 
> 标签：php, mysql, function, md5, crypt

您好，我在使用 crypt 功能时遇到问题。我想检查数据库中的密码和输入的密码。

我遇到的问题是，当我输入密码时，即使密码完全不同，它甚至会重定向？这对我来说很奇怪。

所以我使用这个功能：

```
function salt_crypt($login_password, $rounds = 7) { 
    $salt = ""; 
    $salt_chars = array_merge(range('A','Z'), range('a','z'), range(0,9)); for($i=0; $i < 22; $i++) { 
    $salt .= $salt_chars[array_rand($salt_chars)]; 
    } 
    return crypt($login_password, sprintf('$2a$%02d$', $rounds) . $salt); 
```

我将从返回数组的函数中获取存储的密码：

```
function ab($a){
    global $db;
    $query = $db->query("SELECT col_a, col_b FROM table WHERE Field= '$a' ");
    $check = $query->fetch_assoc();
    return ($check);
} 
```

这将用于此功能：

```
function login($a, $login_password){
    $user_data = user_data($a);
    global $db;
    $uname = sanitize($uname);
    $crypted_password = salt_crypt($login_password);

    if(crypt($user_data['col_b'], $crypted_password) == $crypted_password) { 

        $query = $db->query("SELECT col_a FROM table WHERE Field_a= '$a' AND Field_b = '$crypted_password' ");
        $check = $query->num_rows;
        return ($check == 1) ? true : false;
    }
} 
```

将调用此函数，并且在返回结果标头的情况下：

```
$login = login($a, $login_password);
        if ($login === false){
            $errors[] = "text";
        } else {
            header('Location: page.php');
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:38:27.680

并非所有代码路径都返回一个值 -> 即使 if 语句为 false，您的函数也会返回 true。试试这样的东西：

```
function login($a, $login_password){
//All your stuff

     if(crypt($user_data['col_b'], $crypted_password) == $crypted_password) { 
         //Your stuff
     }

    return false
} 
```

# javascript - HTML/ Javascript：从选定字段重定向 URL

> ID：15024331
> 
> 赞同：0
> 
> 时间：2013-02-22T12:32:45.917
> 
> 标签：javascript, html

下面的选择框工作得很好。它根据所选选项重定向。

```
<select name="redirect" onChange="window.document.location.href=this.options[this.selectedIndex].value;" value="GO">
   <option selected="selected">Select One</option>
   <option value="http://www.google.com">Google</option>
   <option value="http://www.gmail.com">Gmail</option>
 </select> 
```

但我有一个像这样的复杂下拉框：

```
<select name="menu" onChange="window.document.location.href=this.options[this.selectedIndex].value;" value="GO">
    <option value="">Select Project</option>
    <option value="http://www.google.com">Type 1</option>
    <option value="Type 2">Type 2</option>
    <option value="Type 3">Type 3</option>
</select> 
```

我知道上面的选择框没有意义，因为我使用 onChange 重定向并使用类型 2 和类型 3 作为选项。

**问题：**当我选择类型 1 时，它应该重定向到谷歌，否则如果选择类型 2 或类型 3，它的值应该提交到我的表单。

我们怎样才能做到这一点。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:49:11.387

你应该尝试这样的事情：

```
<select name="menu" onChange="javascript: if (this.value == 'http://www.google.com'){window.document.location.href=this.options[this.selectedIndex].value;}else{document.forms['myform'].submit();} " value="GO">
<option value="">Select Project</option>
<option value="http://www.google.com">Type 1</option>
<option value="Type 2">Type 2</option>
<option value="Type 3">Type 3</option>
</select> 
```

PS：这里： document.forms['myform'].submit();....你用你的表单名称-id 更改 myForm ;)

萨卢多斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T13:27:21.497

html 就像你想要的那样：

```
<form name="fm_memu">
    <input type="text" name="ipt_menu" value=""/>
</form>
<select name="menu" onChange="if(this.selectedIndex){if(this.selectedIndex < 2){window.document.location.href=this.value;}else{window.document.forms['fm_memu']['ipt_menu'].value=this.value;}}" value="GO">
    <option value="">Select Project</option>
    <option value="http://www.google.com">Type 1</option>
    <option value="Type 2">Type 2</option>
    <option value="Type 3">Type 3</option>
</select> 
```

# css - Firefox 上的可下载字体：URI 错误或不允许跨站点访问

> ID：15024333
> 
> 赞同：38
> 
> 时间：2013-02-22T12:32:48.810
> 
> 标签：css, amazon-s3, cross-domain, font-face, gecko

我是[http://www.beperk.com](http://www.beperk.com)的网站管理员（我给你 URL，这样你就可以检查问题），我在 CSS 中使用 @font-face 时遇到了很多问题。

我想使用来自 zurb dot com 的 foundicon，所以我将它们托管在 Amazon S3 上。

我将存储桶设置为允许跨域访问，如下所示：http: [//docs.aws.amazon.com/AmazonS3/latest/dev/cors.html#how-do-i-enable-cors](http://docs.aws.amazon.com/AmazonS3/latest/dev/cors.html#how-do-i-enable-cors)

一切都开始在 webkit、trident 和 gecko 上无缝运行......主要是：当使用 firefox（版本 17、18 和 19 测试）浏览网页时，所有图标都会随机失败，并出现以下错误：

```
Timestamp: 22/02/13 13:18:01
Error: downloadable font: download failed (font-family: "GeneralFoundicons" style:normal weight:normal stretch:normal src index:1): bad URI or cross-site access not allowed 
```

我随机说，因为在完全重新加载页面（使用 control/command + R）之后，每个图标在一些访问后通常会再次失败。

任何人都可以找到问题吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-02-22T13:47:31.960

在您的服务器上，您需要添加：

```
Access-Control-Allow-Origin 
```

对于字体文件的标题，例如，如果您使用的是 Apache，您可以将其添加到 .htaccess 中：

```
<FilesMatch "\.(ttf|otf|eot|woff|woff2)$">
  <IfModule mod_headers.c>
    Header set Access-Control-Allow-Origin "*"
  </IfModule>
</FilesMatch> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-11-14T09:48:19.443

如果有人使用本地资源并在 Firefox 中遇到此问题。您可以转到`about:config`并将`security.fileuri.strict_origin_policy`首选项更改为`false`。

请参阅：[https ://developer.mozilla.org/en-US/docs/Same-origin_policy_for_file:_URIs](https://developer.mozilla.org/en-US/docs/Same-origin_policy_for_file:_URIs)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-06-10T09:25:21.173

尝试使用已实现的 base64 编码字体，例如：

```
@font-face {
 font-family:"font-name";
 src:url(data:font/opentype;base64,[paste-64-code-here]);
 font-style:normal;
 font-weight:400;
} 
```

见：[http ://sosweetcreative.com/2613/font-face-and-base64-data-uri](http://sosweetcreative.com/2613/font-face-and-base64-data-uri)

它工作得很好。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2017-03-19T22:01:19.473

我使用 url:`src: url("../fuentes/EurostileLTStd.otf");`而不是`src: uri("../fuentes/EurostileLTStd.otf");`.

# c++ - pthread_cond_wait 奇怪的行为

> ID：15024339
> 
> 赞同：0
> 
> 时间：2013-02-22T12:32:58.927
> 
> 标签：c++, pthreads, dining-philosopher

我正在尝试使用 C++解决[餐饮哲学家的问题。](http://en.wikipedia.org/wiki/Dining_philosophers_problem)

代码用`g++ -lpthread`.

整个解决方案在[哲学家 github 上](https://github.com/akegalj/cplusplus/tree/master/rltest/dining_philosophers)。Repository 包含两个 cpp 文件：main.cpp 和philosopher.cpp。“Main.cpp”创建互斥变量、信号量、5 个条件变量、5 个分叉，并启动哲学家。信号量仅用于同步哲学家的启动。其他参数被传递给哲学家来解决问题。“Philosopher.cpp”包含给定问题的解决方案，但经过几步就会发生死锁。

当哲学家 0 正在吃饭，而哲学家 1（在他旁边）想拿叉子时，就会发生死锁。然后，哲学家 1 拿走了互斥锁，直到哲学家 0 放下他的叉子才把它还给它。由于采取了互斥锁，哲学家 0 不能放下他的叉子，所以我们陷入了僵局。问题出在**Philosopher::take_fork 方法中，调用 pthread_cond_wait(a,b) 没有释放 mutex b**。想不通为什么？

```
// Taking fork. If eather lef or right fork is taken, wait.
void Philosopher::take_fork(){
  pthread_mutex_lock(&mon);
  std::cout << "Philosopher " << id << " is waiting on forks" << std::endl;
  while(!fork[id] || !fork[(id + 1)%N])
    pthread_cond_wait(cond + id, &mon);
  fork[id] = fork[(id + 1)%N] = false;
  std::cout << "Philosopher " << id << " is eating" << std::endl;
  pthread_mutex_unlock(&mon);
} 
```

其余的请参考[此代码](https://github.com/akegalj/cplusplus/tree/master/rltest/dining_philosophers)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T05:45:01.907

你的电话`pthread_cond_wait()`很好，所以问题一定出在其他地方。你有三个我可以看到的错误：

首先，`main()`您只是在初始化数组中的*第一个*条件变量。您需要初始化所有`N`条件变量：

```
for(int i = 0; i < N; i++) {
    fork[i] = true;
    pthread_cond_init(&cond[i], NULL);
}

pthread_mutex_init(&mon, NULL); 
```

其次，`put_fork()`您对要发出信号的条件变量之一的计算不正确：

```
pthread_cond_signal(cond + (id-1)%N);    /* incorrect */ 
```

当`id`等于零时，`(id - 1) % N`等于-1，所以这将尝试发出信号`cond - 1`，它不指向条件变量（这个指针可能实际上破坏了你的互斥锁，因为它很可能直接`cond`放在堆栈上） . 你真正想要的计算是：

```
pthread_cond_signal(cond + (id + N - 1) % N); 
```

第三个错误不是死锁的原因，但你不应该`srand(time(NULL))`每次调用时都调用`rand()`- 只需调用一次，在`main()`.

# sitecore - Sitecore 项目从 6.5 版转换到 6.6 版

> ID：15024340
> 
> 赞同：0
> 
> 时间：2013-02-22T12:33:01.027
> 
> 标签：sitecore

我正在使用 Sitecore 6.5 开发一个网站，当我的公司知道 Sitecore 发布了 6.6 版时，他们希望将新版本用于该项目，有没有办法转换我使用 Sitecore 6.5 创建的项目（网络表单）到 sitecore 6.6(mvc) 所以我不会重做我的工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T15:20:52.360

切换到 MVC 不会影响常规内容项。如果您确实迁移到 MVC，它将是您需要更新的任何演示项目。正如@JayS 所说，MVC 不是强制性的，您实际上可以在解决方案中混合 MVC 和 Webforms 布局，因此如果您想随着时间的推移慢慢转换为 MVC，这是可能的。

只是想指出，不再有“推荐版本”之类的东西（参见：[http](http://sdn.sitecore.net/support/versioning%20policy.aspx) ://sdn.sitecore.net/support/versioning%20policy.aspx ）。许多客户已经在生产中使用 6.6。从 6.5 -> 6.6 升级应该很简单（但这显然取决于您的解决方案的复杂性）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T12:53:21.937

据我了解，如果您不想，则不需要在 6.6 中使用 MVC。John West 有[一篇关于安装程序](http://www.sitecore.net/Community/Technical-Blogs/John-West-Sitecore-Blog/Posts/2012/11/Sitecore-ASPNET-CMS-6-6-Installer-Enables-MVC-by-Default.aspx)及其如何启用 MVC 的博客。您应该能够相对轻松地将现有解决方案移植到 6.6，但如果您希望利用 MVC，则需要更改您的解决方案。

请注意，我相信 Sitecore 并未将 6.6 标记为推荐版本，因此您不妨将这一点通知您的公司。

**更新：**感谢 Stephen 指出 Sitecore 已停止使用推荐的发布标记。他们的一些在线文档仍然需要对此进行更新:)

# php - PHP create xml Extra content at the end of the document error

> ID：15024343
> 
> 赞同：0
> 
> 时间：2013-02-22T12:33:09.153
> 
> 标签：php, xml

```
<?php 
// Display the error message according to each data code.
$xml = '<?xml version="1.0" encoding="utf-8"?><results>'; 
if($_GET['code'] == "500"){
    $xml .= '<error id="500" message="Error 500"></error>';     
}else if($_GET['code'] == "501"){
    $xml .= '<error id="501" message="Error 501"></error>'; 
}
$xml .= '</results>';
header ("Content-Type:text/xml"); 
echo ($xml);  
?> 
```

我收到了这个错误

```
This page contains the following errors:

error on line 3 at column 1: Extra content at the end of the document
Below is a rendering of the page up to the first error. 
```

明文形式

```
<?xml version="1.0" encoding="UTF-8"?><results><error id="501" message="Invalid Course Code"></error>   </results>  
   <!-- Hosting24 Analytics Code -->
   <script type="text/javascript" src="http://stats.hosting24.com/count.php"></script>
   <!-- End Of Analytics Code --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:53:50.730

它适用于您的 WAMPP 服务器，因为它不输出您的主机似乎添加的分析代码：

```
 <!-- Hosting24 Analytics Code -->
   <script type="text/javascript" src="http://stats.hosting24.com/count.php"></script>
   <!-- End Of Analytics Code --> 
```

请联系您的主机商，了解如何从您的输出中删除它（或者更好的是，切换主机，因为这有点离谱）。

# javascript - 我可以创建一个在“已满”时停止接受字符的 HTML 输入字段吗？

> ID：15024345
> 
> 赞同：3
> 
> 时间：2013-02-22T12:33:12.920
> 
> 标签：javascript, html

我想创建 HTML 输入字段（单行或文本区域），当它们“已满”时停止接受新文本 - 即当小部件中没有更多空间可以显示新字符时。

这与对字符数设置最大长度限制不同，因为（例如）65 个小写字母“i”占用的空间比 65 个大写“W”在比例字体中占用的空间少得多。

有没有办法做到这一点？（如果有，理想情况下，该解决方案还可以涵盖粘贴文本的时间，并截断超出限制的所有文本）。

编辑：解决方案必须使用比例字体 - maxlength 在这里没有帮助，我们对停在字符长度不感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:06:00.290

以下使用来自[https://stackoverflow.com/a/5047712/212869](https://stackoverflow.com/a/5047712/212869)的答案来计算文本的宽度，并将其链接到文本框。它的代码非常粗糙：D，但它确实很好地限制了文本框。相同的原则可以用于文本区域，但您也必须对高度和宽度都这样做。

[http://jsfiddle.net/LMKtd/1/](http://jsfiddle.net/LMKtd/1/) - 它输出东西到控制台，所以如果你看一下最好打开它。

```
String.prototype.width = function(font) {
  var f = font || '12px arial',
      o = $('<div>' + this + '</div>')
            .css({'position': 'absolute', 'float': 'left', 'white-space': 'nowrap', 'visibility': 'hidden', 'font': f})
            .appendTo($('body')),
      w = o.width();

  o.remove();

  return w;
}

$('#textinput').on('keyup', validatetext);

function validatetext(e) {
    var w = parseInt(e.target.value.width());
    if (w > 100) {
        console.log("Width Gt 100px ["+w+"px] Char Count ["+e.target.value.length+"]");
        do {
            e.target.value = e.target.value.slice(0,-1);
        } while (parseInt(e.target.value.width()) > 100)
    } else {
        console.log("Keep going! ["+w+"px] Char Count ["+e.target.value.length+"]");
    }
} 
```

**更新**

[http://jsfiddle.net/LMKtd/8/](http://jsfiddle.net/LMKtd/8/)

我也为文本区域设置了一个。它不会阻止您超越限制，但它会告诉您何时它太宽或太高。这不是很漂亮：D

```
String.prototype.width = function(font) {
  var f = font || '12px arial',
      o = $('<div>' + this + '</div>')
            .css({'position': 'absolute', 'float': 'left', 'white-space': 'nowrap', 'visibility': 'visible', 'font': f})
            .appendTo($('body')),
      w = o.width();
  o.remove();

  return w;
}

String.prototype.height = function(font) {
  var f = font || '12px arial',
      o = $('<div>' + this.replace(/[\r\n]/g,'<br />') + '</div>')
            .css({'position': 'absolute', 'float': 'left', 'white-space': 'nowrap', 'visibility': 'hidden', 'font': f})
            .appendTo($('body')),
      w = o.height();
  o.remove();

  return w;
}

$('#textinput').on('keyup', validatetext);
$('#areainput').keyup(validatearea);

function validatearea(e) {
    var w = parseInt($(this).val().width());
    var h = parseInt($(this).val().height());
    var errw = false;
    var errh = false;
    if (h>100) {
        errh = true
    }
    var lines = $(this).val().split(/[\r\n]/);
    var errw = false;
    for (var i = 0; i<lines.length; i++) {
        if (parseInt(lines[i].width()) > 100) {
            errw = true;
        }
    }
    if ((errh == true) || (errw == true)) {
        if ((errh == true) && (errw == false)) {
            $('#areaerror').html("Too Tall, Width OK");        
        }
        if ((errh == false) && (errw == true)) {
            $('#areaerror').html("Height OK, Too Wide");        
        }
        if ((errh == true) && (errw == true)) {
            $('#areaerror').html("Too Tall, Too Wide");        
        }
    } else {
        $('#areaerror').html("Were Good");    
    }
}

function validatetext(e) {
    var w = parseInt(e.target.value.width());
    if (w > 100) {
        console.log("Width Gt 100px ["+w+"px] Char Count ["+e.target.value.length+"]");
        do {
            e.target.value = e.target.value.slice(0,-1);
        } while (parseInt(e.target.value.width()) > 100)
    } else {
        console.log("Keep going! ["+w+"px] Char Count ["+e.target.value.length+"]");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:35:13.953

您可以使用 maxlength 属性

```
<input type="text" id="Textbox" name="Textbox" maxlength="10" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T12:51:24.513

jquery inputfit插件怎么样？检查[演示](http://vadim.sikora.name/jquery.inputfit.js/) 和[源代码](https://github.com/vxsx/jquery.inputfit.js)

您可以更改源以适应您的要求。显然，如果您正在寻找纯 JavaScript 的解决方案，您必须使用 jquery 库，这可能不适合。

检查它们似乎适合您的要求的选项（最小尺寸，最大尺寸）

# clojure - Clojure - 对象的默认协议实现失败？

> ID：15024348
> 
> 赞同：3
> 
> 时间：2013-02-22T12:33:35.923
> 
> 标签：clojure, protocols

我在 Clojure 中创建了一个简单的协议和一个类型：

```
(defprotocol Saving
  (save [this] "saves to mongodb"))

;default implementation
(extend-type Object
  Saving
  (save [this] (encode this)))

(deftype NewsItem
  [text date]
  Saving) 
```

但是，当我尝试：

```
=> (def news-item (->NewsItem "Super News!!!" "today")) 
```

进而：

```
=> (save news-item) 
```

我得到：

```
AbstractMethodError luminous_test.models.model.NewsItem.save()Ljava/lang/Object;  luminous-test.models.model/eval2450 (NO_SOURCE_FILE:1) 
```

我究竟做错了什么？我想遵循创建默认协议实现的路线，但这就是我得到的......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T13:45:10.773

代替

```
(deftype NewsItem
  [text date]
  Saving) 
```

只需使用：

```
(deftype NewsItem
  [text date]) 
```

# scala - Mockito 在 ScalaTest 中的回答

> ID：15024352
> 
> 赞同：8
> 
> 时间：2013-02-22T12:33:54.993
> 
> 标签：scala, mockito, scalatest

[ScalaTest 中的 Mockito答案](http://docs.mockito.googlecode.com/hg/latest/org/mockito/stubbing/Answer.html)是否有替代方案？我正在浏览它的[文档](http://www.scalatest.org/user_guide/testing_with_mock_objects)，但没有找到任何东西。

例如，我想对存根方法的参数执行一些逻辑。在 Mockito 中，我会做这样的事情：

```
when(mock.create(any(A.class))).thenAnswer(new Answer() {
    Object answer(InvocationOnMock invocation) {
        A firstArg = (A) invocation.getArguments()[0];
        firstArg.callMethod();
        return null;
    }
}); 
```

在 ScalaTest 中，我也可以使用 Mockito。但是，如果有一些对 Scala 更友好的语法来定义这样的`Answer`.

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-10-14T13:26:03.110

我刚找到[这篇博文](http://henningpetersen.com/post/10/using-mockito-answers-with-scala-2-9)。它描述了如何使用隐式转换来实现你想要的。如果您定义这样的隐式转换

```
implicit def toAnswerWithArgs[T](f: InvocationOnMock => T) = new Answer[T] {
    override def answer(i: InvocationOnMock): T = f(i)
} 
```

你可以`thenAnswer`用一个简单的函数作为参数调用：

```
when(mock.someMethodCall()).thenAnswer((i) => calculateReturnValue()) 
```

当您的模拟方法没有参数时，还有一个稍短的替代版本。点击链接了解详情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-09-29T21:39:25.823

定义这个辅助函数：

```
def answer[T](f: InvocationOnMock => T): Answer[T] = {
  new Answer[T] {
    override def answer(invocation: InvocationOnMock): T = f(invocation)
  }
} 
```

并像这样使用它，例如返回`Future[MyClass]`包含传递给方法的任何参数的 a：

```
when(myRepository.create(any[MyClass]())).thenAnswer(answer({ invocation =>
  Future.successful(invocation.getArguments.head.asInstanceOf[MyClass])
})) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-22T23:02:29.070

如果你混入 trait [MockitoSugar](http://doc.scalatest.org/1.9.1/#org.scalatest.mock.MockitoSugar)，你可以创建一个 mock 并使用以下语法传递一个答案：

```
mock[Collaborator](new Answer(){ ... }) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-22T14:39:39.657

你试过[ScalaMock](http://scalamock.org/2.x/index.html)吗？它还[与 ScalaTest 集成，](http://www.scalatest.org/user_guide/testing_with_mock_objects#scalamock)并提供对 Scala 更友好的 API。

# javascript - 如何在 Ember.js 中创建多选列表

> ID：15024355
> 
> 赞同：4
> 
> 时间：2013-02-22T12:34:08.413
> 
> 标签：javascript, ember.js

我试图弄清楚如何构建一个由列表组成的小型应用程序，您可以在其中选择多个项目并切换以选择全部/无并查看当前选定的行数。

我相信“选定”状态不应该是模型对象的一部分，但我真的不知道该怎么做。

这是我当前的设置（显然还不能正常工作）

可运行代码[http://jsfiddle.net/jacobk/rU35G/1/](http://jsfiddle.net/jacobk/rU35G/1/)

```
var App = Ember.Application.create();

App.ApplicationRoute = Ember.Route.extend({
    model: function() { return Ember.A(["Foo", "Bar", "Baz"]); }
});

App.ApplicationController = Ember.ArrayController.extend({
    allSelected: false,

    selectedCount: function() {
        return 0;
    }.property()
});

App.RowController = Ember.ObjectController.extend({
    isSelected: false
}); 
```

```
<script type="text/x-handlebars" data-template-name="application">
    <h3>{{ selectedCount }} rows selected.</h3>
    <label>
    {{view Ember.Checkbox checkedBinding="allSelected"}}
        Toggle select all
    </label>
    <hr/>
    <ul>
    {{#each controller itemController="row"}}
        <li {{bindAttr class="isSelected"}}>
            {{view Ember.Checkbox checkedBinding="isSelected"}} {{this.content}}
        </li>
    {{/each}}
    </ul>
</script> 
```

*   是否应该使用每行的自定义视图或上面小提琴中的自定义控制器来控制单个“行项”
*   如何将 ArrayController 中的“全选”传播到所有单独的控制器（或视图，如果更合适的话）

我试图了解何时使用绑定、观察者、属性、“需求”等，以及何时适合使用控制器与视图等。我还没有了解 ember 应用程序中的一般信息/数据流。

例如，我上面示例中的 ArrayController 是否应该遍历“包含”视图/控制器并在切换“全选”复选框时更改“选定”状态，**或者**所有“子控制器”是否应该观察/“绑定到” ArrayController 并在它改变时改变自己，如果是这样，我应该如何将数据传播到相反的方向。ArrayController 如何获得“所有当前选定的”行？

我很想看到这个的“规范解决方案”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:53:29.990

不需要行控制器。@each，计算属性和检查绑定可以用来解决这个问题，如下所示。isSelected 必须在数组控制器的内容中定义：

```
 App.ApplicationController = Ember.ArrayController.extend({

        allSelected: function(key, value) {
    if ( value !== undefined ) {
     // when check box is ticked, this gets executed
      this.setEach( 'isSelected', value );
      return value;
    } else {
        //as a computed property
      return !!this.get( 'length' ) &&
        this.everyProperty( 'isSelected', true );
    }
  }.property('@each.isSelected')

        selectedCount: function() {
            return 0;
        }.property()
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-06T00:16:00.957

我同意将所选状态保留在模型之外。您需要`itemController`在 Ember.ArrayController 中定义。

这是一个工作示例。[http://jsbin.com/sunat/3/edit](http://jsbin.com/sunat/3/edit)

```
App.RowController = Ember.ObjectController.extend({
  isSelected: false
});

App.IndexController = Ember.ArrayController.extend({
  itemController: 'row',

  selectAll: function(key, value) {

    if (arguments.length == 2) {
      this.setEach('isSelected', value);

      return value;
    } else {

      return this.isEvery('isSelected', true);
    }
  }.property('@each.isSelected')
});

#template
<script type="text/x-handlebars" id="index" >
  <label>
    {{input type="checkbox" checked=selectAll}}
    Toggle select all
  </label>
  <hr/>
  <ul>
  {{#each}}
    <li>
      {{input type="checkbox" checked=isSelected}} {{name}}
    </li>
  {{/each}}
  </ul>
</script> 
```

# python - 将最大值写入字典而不覆盖

> ID：15024356
> 
> 赞同：0
> 
> 时间：2013-02-22T12:34:16.083
> 
> 标签：python, dictionary, for-loop

我有一本包含翻译概率 P(c|e) 的双语词典（“概率”）。这是给定一个特定的英文单词 e，翻译将是一个特定的中文单词 c 的概率。字典键如下所示：`probabilities[chinese_word + " | " + english_word]`

我还有一个中文句子的语料库（“bitext”）与其英文翻译对齐。现在，对于每对句子，对于每个中文单词 i，我想遍历所有英文单词 j 并选择 P(c_i | e_j) 最高的单词。为此，我将变量 argmax 定义为 0，并在概率相同或更高时更新此变量。

这就是问题所在：一些 c|e 组合具有完全相同的翻译概率。但是，由于字典键必须是唯一的，我的代码只存储它看到的最后一个 c|e 组合。如果它们共享最高的翻译概率，我希望它能够存储多个 c|e 组合。我该怎么做呢？

```
alignments = {}    

for k in range(1, number_of_sent+1):

    sentences = bitext[k-1]
    chinese_sent = sentences[0]
    english_sent = sentences[1]

    for i in range(len(chinese_sent)):
        argmax = 0
        for j in range(len(english_sent)):
            if probabilities[chinese_sent[i] + " | " + english_sent[j]] >= argmax:
                argmax = probabilities[chinese_sent[i] + " | " + english_sent[j]]
                alignments[k, chinese_sent[i]] = english_sent[j] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:42:23.497

如果您需要为每个键存储多个值，则“对齐”字典必须存储某种集合，例如列表。例如：

```
from collections import defaultdict

alignments = defauldict(list)

...
[the remainder of your code]
... 

alignments[k, chinese_sent[i]].append(english_sent[j]) 
```

* * *

顺便说一句，两项更改将使您的代码更清晰：

1.  chinese_sent 和 english sent 是可迭代的，您不需要索引，因此您不需要在循环中使用 range。

2.  您可以使用元组而不是字符串作为概率字典键。

您的代码将变为：

```
from collections import defaultdict

alignments = defauldict(list)

for k in range(1, number_of_sent+1):

    sentences = bitext[k-1]
    chinese_sent = sentences[0]
    english_sent = sentences[1]

    for cs in chinese_sent:
        argmax = 0
        for es in english_sent:
            if probabilities[cs,es] >= argmax:
                argmax = probabilities[cs,es]
                alignments[k, cs].append(es) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T12:42:43.857

尝试将键关联到列表，而不是存储单个值：

```
alignments[k, chinese_sent[i]].append(english_sent[j]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T12:42:05.230

您可以将字典的值转换为列表而不是单个值，即拥有一个列表字典。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T12:43:35.297

alignments[k, chinese_sent[i]] 应该是一个列表或数组，如果您看到当前值更高，则将其设置为新列表或数组并存储概率并更新 argmax 。如果它相同，那么您向该列表添加一个新值。

# iphone - 当应用程序在后台运行时，在 iOS 应用程序的锁定屏幕上添加图像

> ID：15024361
> 
> 赞同：3
> 
> 时间：2013-02-22T12:34:23.387
> 
> 标签：iphone, ios, xcode, ipad, lockscreen

网站上有很多问题，例如

[以编程方式更改 iOS 锁屏](https://stackoverflow.com/questions/6243591/programatically-changing-the-ios-lock-screen)，

[如何在 iPhone 中以编程方式设置锁屏、壁纸和铃声？](https://stackoverflow.com/questions/4476777/how-to-set-lock-screen-wallpaper-and-ringtone-programmatically-in-iphone) 都说如果我们修改锁屏图像，苹果会拒绝。

但我在许多应用程序中都看到了它。示例[Saavn](https://itunes.apple.com/us/app/saavn-music/id441813332)在 AppStore 中。

在这种情况下，如果正在播放歌曲并且设备被锁定，它会在锁定屏幕上显示当前专辑的图像。

如果有人知道如何完成，请分享。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:38:04.070

音乐应用程序可以更改锁屏壁纸，因为 iOS 会自动显示正在播放的歌曲/播客/等的专辑插图（请参阅`MPMusicPlayerController` [文档](https://developer.apple.com/library/ios/documentation/MediaPlayer/Reference/MPMusicPlayerController_ClassReference/Chapters/Reference.html)）。据我所知，它不是对开发人员公开可用的 API。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T12:58:04.497

“播客”应用程序（第三方不是苹果）显示当前正在播放的播客的图像。播客图像存储在 RSS 提要中，而不是每个 mp3 中，因此应用程序动态地告诉操作系统哪个图像与 mp3 一起使用。当然，您可以从扬声器中播放“静音”，但我认为这不是一个干净的解决方案

# ruby-on-rails - 我应该将哪个代码放入rails中的一部分

> ID：15024363
> 
> 赞同：0
> 
> 时间：2013-02-22T12:34:36.637
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2, haml, partial-views

理想情况下，可重用的代码，我们可以放入一个单独的部分，并可以从不同的操作中调用它。

现在，如果我的 parial`_list.html.haml`文件有代码

```
 #betting_list
   %table.table
    %tr  
    %th{:align => "left"}="Start time"
    %th{:align => "left"}="Fixture"
    %th{:align => "left"}="Won"
    %th{:align => "left"}="Draw"
    %th{:align => "left"}="Lost"
    %th{:align => "left"}="Amount"
  - @upcoming_event.each do |event|
    %tr{:class => cycle('even', 'odd')}
      %td=event.start_at.strftime("%b %d %H:%M")
      %td=link_to event.name, event
      - event.outcomes.each do |outcome|
        - if outcome.label =="Won"
          %td=outcome.odds 
        - if outcome.label =="Draw"
          %td=outcome.odds 
        - if outcome.label =="Lost"
          %td=outcome.odds 
      %td=event.bets.count
= paginate(@upcoming_event) 
```

**我们是否应该始终在不同的部分或中保留数据行或循环？**. 我处于困境中。我不需要重新使用该循环部分来重用。

是否可以重构这样的代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:41:07.890

您可以在新的部分中更好地保​​持循环。

我还看到了多个 IF，有点令人困惑。

你可以这样做

```
- if (["Won","Lost","Draw"].include? outcome.label)
    %td=outcome.odds 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:27:34.863

至于不同的部分，这一切都取决于重用或可读性。正确命名的部分还可以帮助解释出于维护原因而发生的事情，尤其是在没有评论的情况下。

案例声明使它更具可读性。但这只是一种意见。

```
case outcome.label
when "Won", "Lost", "Draw"
  %td=outcome.odds
end 
```

# c# - 将联系人导出为 csv 文件会自动将手机号码格式化为科学格式

> ID：15024367
> 
> 赞同：1
> 
> 时间：2013-02-22T12:34:54.973
> 
> 标签：c#, excel, ms-office

当我将联系人导出到 csv 文件时，进入我的项目会自动将手机号码格式以 91 开头转换为科学格式。

例如移动没有到导出数据

919433454320

科学格式时手机不转成csv文件

9.194E+11

将单元格格式化为小数点后 0 位的数字

919430000000

使用 Microsoft.Office.Interop.Excel.Application 将联系人导出到我的项目中

这里的工作簿是我的代码

```
 Microsoft.Office.Interop.Excel.Application app = new Microsoft.Office.Interop.Excel.Application();
            app.Visible = false;
            Workbook wb = app.Workbooks.Add();
            Worksheet ws = (Worksheet)wb.Worksheets.get_Item(1);
            object[,] rawData = new object[DataTable.Rows.Count + 1, DataTable.Columns.Count];

            for (int col = 0; col < DataTable.Columns.Count; col++)
            {
                rawData[0, col] = DataTable.Columns[col].ColumnName;
            }

            for (int col = 0; col < DataTable.Columns.Count; col++)
            {
                for (int row = 0; row < DataTable.Rows.Count; row++)
                {
                    rawData[row + 1, col] = DataTable.Rows[row].ItemArray[col];
                }
            }
            string[] callchar = new string[]  {"range of my excel sheet (e.g from a to Bz"};
            string excelRange = callchar[0] + "1:" + callchar[DataTable.Columns.Count - 1] + (DataTable.Rows.Count + 1).ToString();
            Range r = ws.Cells.EntireColumn.NumberFormat;
            ws.get_Range(excelRange, Type.Missing).Value2 = rawData;
            wb.SaveAs(Filename: FilePath, FileFormat: XlFileFormat.xlCSVWindows, ReadOnlyRecommended: false);
            wb.Close();
            app.Quit(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:35:07.507

您可以使用后期绑定来导出数据：

```
 // try to open excel
            Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");
            Type typeExcelApplication = Type.GetTypeFromProgID("Excel.Application");
            if (typeExcelApplication == null)
                throw new Exception("Excel is not installed (Excel.Application is not found)");
            object objExcelApplication = Activator.CreateInstance(typeExcelApplication);
            object objWorkBooks = objExcelApplication.GetType().InvokeMember("Workbooks", BindingFlags.GetProperty, null, objExcelApplication, null);
            object objWorkBook = objWorkBooks.GetType().InvokeMember("Add", BindingFlags.InvokeMethod, null, objWorkBooks, null);
            object objWorkSheet = objWorkBook.GetType().InvokeMember("ActiveSheet", BindingFlags.GetProperty, null, objWorkBook, null);

            // fill data (put object obj into cell [1,1])
            objWorkSheet.GetType().InvokeMember("Cells", BindingFlags.SetProperty, null, objWorkSheet, new object[] { 1, 1, obj});

            // display excel
            typeExcelApplication.InvokeMember("Visible", BindingFlags.SetProperty, null, objExcelApplication, new object[] { true });
            Marshal.ReleaseComObject(objExcelApplication); 
```

Excel 应该正确处理类型，因此如果您提供`obj`-**`string`**它不会尝试从中生成数字（科学？）。

# android - 无法设置 cookie android.webkit.CookieManager

> ID：15024371
> 
> 赞同：0
> 
> 时间：2013-02-22T12:35:05.180
> 
> 标签：android, cookiemanager

我已经通过 WebView 登录到一个站点。然后我得到了由 webview 在登录时设置的 cookie。然后我试图稍后设置cookie。请看我的代码：

```
CookieSyncManager.createInstance(context);
CookieManager cookieManager = CookieManager.getInstance();

Log.e("checkPost 1", cookie);
cookieManager.setCookie("https://************", cookie);

Log.e("checkPost 2", cookieManager.getCookie("https://*************"));
CookieSyncManager.getInstance().sync();
Log.e("checkPost 3", cookieManager.getCookie("https://*************")); 
```

在`checkPost 1`打印的 cookie 中显示它很好。但是在它的声明中`checkPost 2`和之后，表明大部分cookie都消失了。问题是什么 ？我需要设置 cookie。但我找不到花费大约 2 天的方法。`sync()``CookieSyncManager.getInstance().sync();``checkPost 3`

**编辑：**

在android文档中它说：

> public void setCookie（字符串 url，字符串值）
> 
> 为给定的 URL 设置一个 cookie。任何具有相同主机、路径和名称的现有 cookie 都将被新 cookie 替换。设置的 cookie 必须没有过期，也不能是会话 cookie，否则将被忽略。

有没有办法通过强制`CookieManager`设置会话cookie `setCookie()`？我认为问题是，可能是我试图设置`session cookie`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T21:55:53.610

我不知道我的问题有没有答案。但出于我的目的，我使用了另一种方法来解决我的问题。这是一个漫长的过程，但它确实有效。我已经放弃了保存的想法`session cookie`（`CookieManager`Android 开发者网站的文档无法做到这一点）。所以，我所做的是：我已将会话 cookie 转换为字符串并将它们保存在内存中。供以后使用，我只是从内存中获取字符串并将其转换回会话 cookie。

**编辑：**

（对于反对者）我在回答中已经说过这个过程太长了，比如4-5节课。这个项目是我在android中的第一个项目，所以代码太乱了。所有的类都充满了太多的代码。所以不可能在这里发布。我已经告诉了我使用的过程。那么为什么要投反对票呢？

我已经以自己的方式转换了会话，并以相反的方式将字符串构建为会话。

如果有什么办法我会发布答案。构建类和算法大约需要 15~20 天。所以你为什么不做一些谷歌并找到更好的方法，或者只是像我一样构建你自己的算法和过程。我已经告诉了这里的关键部分，你只需要找到一种方法将它实现到代码中。谢谢

# winapi - 对话常量 DS_RECURSE 的值是多少？

> ID：15024372
> 
> 赞同：4
> 
> 时间：2013-02-22T12:35:07.817
> 
> 标签：winapi

对话常量 DS_RECURSE 的值是多少（需要链接到官方 MS 文档，欢迎提供历史信息）？感谢关注。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T16:09:06.850

`DS_RECURSE`不存在。它是在 RTM 之前被删除的 Windows 95 预发布版本中的一个标志。所有引用它的文档都在谈论“不要使用它”，这现在很容易做到，因为你不能使用不存在的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T12:52:15.910

[http://msdn.microsoft.com/en-us/library/aa925154.aspx](http://msdn.microsoft.com/en-us/library/aa925154.aspx)

```
The following styles are not supported for the **style** member of the DLGTEMPLATE structure: 

...
DS_RECURSE
    Not required. Any child dialog box is automatically considered to be a recursive dialog box. 
```

这是结构：

```
typedef struct {
  DWORD style; 
  DWORD dwExtendedStyle; 
  WORD cdit; 
  short x; 
  short y; 
  short cx; 
  short cy; 
} DLGTEMPLATE; 
```

如您所见，样式是 DWORD，因此 DS_RECURSE 的值也是 DWORD。让它为 0，因为不需要。

BTW：你为什么需要它？

# ruby-on-rails - 将 rails 项目从 3.2.1 降级到 2.3.3

> ID：15024373
> 
> 赞同：2
> 
> 时间：2013-02-22T12:35:10.787
> 
> 标签：ruby-on-rails, gemfile

我的第一个 Rails 项目部署，我遇到了一个问题。该项目是Rails 3.2.1，Ruby 1.9.3 昨天，我获得了托管访问权限，他们拥有Rails 2.3.3，Ruby 1.8.7

如果我决定仍然在那里部署应用程序，我需要对其进行哪些更改？

具体来说，我对 Gemfile 的更改感兴趣。这是我当前的gemfile：

```
source 'https://rubygems.org'

gem 'rails', '2.3.3'#'3.2.1'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'sqlite3'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer'

  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

gem 'haml-rails'
gem 'haml'

gem 'omniauth-twitter' 
```

我需要改变什么？如何查找旧 Rails 版本所需的所有依赖项和 gems 版本？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T12:43:57.927

从 3.x 降级到 2.3 是您可以做的最愚蠢的事情。在本地安装 gems，或询问您的托管公司支持部门——他们必须提供帮助。

如果不能，请节省您的时间——使用 Heroku、OpenShift 或任何其他托管公司。

# jquery - 页面滚动到顶部，然后使用 jquerymobile 导航到另一个页面

> ID：15024376
> 
> 赞同：1
> 
> 时间：2013-02-22T12:35:21.233
> 
> 标签：jquery, cordova, jquery-mobile

我的应用有 2 个视图，列表和详细信息。该列表有大约 30 项。我滚动到底部并单击了一个项目。然后导航到详细视图。

现在的问题是 - 列表视图首先自动滚动到列表视图的顶部（快速），然后导航到详细视图。这是不希望的。我不想看到自动滚动的东西。

我正在使用 jQuery 和 jQuerymobile。我正在使用 jQueryMobile 的 changePage() 函数导航到另一个屏幕。

我试着四处挖掘，但徒劳无功。

任何想法都会非常有帮助

# jquery - 将“动画”添加到 jquery 下拉菜单

> ID：15024380
> 
> 赞同：0
> 
> 时间：2013-02-22T12:35:33.440
> 
> 标签：jquery, html, animation, menu

我很想得到一些帮助。我正在构建一个响应式下拉菜单，根据浏览器窗口大小在隐藏/可见状态之间切换。它基于我在网上找到的 jQuery 解决方案。

最小（移动）版本。当点击事件被触发时，菜单会立即下降，但我真的想添加一个“动画”功能，以便它逐渐打开。

对 jQuery 没有太多经验，我希望有人可以建议我可以在我的代码中添加“动画”命令的位置。

感谢期待。

========= 这是Javascript：

```
var ww = document.body.clientWidth;

$(document).ready(function() {
    $(".nav li a").each(function() {
        if ($(this).next().length > 0) {
            $(this).addClass("parent");
        };
    })

    $(".toggleMenu").click(function(e) {
        e.preventDefault();
        $(this).toggleClass("active");
        $(".nav").toggle();
    });
    adjustMenu();
})

$(window).bind('resize orientationchange', function() {
    ww = document.body.clientWidth;
    adjustMenu();
});

var adjustMenu = function() {
    if (ww < 600) {
        $(".toggleMenu").css("display", "inline-block");
        if (!$(".toggleMenu").hasClass("active")) {
            $(".nav").hide();
        } else {
            $(".nav").show();
        }
        $(".nav li").unbind('mouseenter mouseleave');
        $(".nav li a.parent").unbind('click').bind('click', function(e) {
            // must be attached to anchor element to prevent bubbling
            e.preventDefault();
            $(this).parent("li").toggleClass("hover");
        });
    }
    else if (ww >= 600) {
        $(".toggleMenu").css("display", "none");
        $(".nav").show();
        $(".nav li").removeClass("hover");
        $(".nav li a").unbind('click');
        $(".nav li").unbind('mouseenter mouseleave').bind('mouseenter mouseleave', function() {
            // must be attached to li so that mouseleave is not triggered when hover over submenu
            $(this).toggleClass('hover');
        });
    }
} 
```

=================这里是html：

```
<nav class="main_navigation"> 

        <ul class="nav">
            <li><a href="item1.php"><span>Item1</span></a></li>
            <li><a href="item2.php"><span>Item2</span></a></li>
            <li><a href="item3.php"><span>Item3</span></a></li>
            <li><a href="item4.php"><span>Item4</span></a></li>
            <li><a href="item5.php"><span>Item5</span></a></li>
        </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:34:48.043

而不是使用 jquery 来创建响应式设计，您是否考虑过使用诸如骨架之类的 CSS 基础？

[http://www.getskeleton.com/](http://www.getskeleton.com/)

如果失败，我建议使用媒体查询根据页面大小修改导航的 css。就 jquery 而言，您可以使用 slideToggle

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:38:02.787

抱歉，我在手机上回答了这个问题，所以没有太多空间可以输入，这是我最近用来做类似事情的代码：

```
<div id="mobile_menu">
<p id="mobile_menu_btn">Menu</p>
<ul id="mobile_menu_ul">
<li><a href="exhibitions.html">Exhibitions</a></li>
<li><a href="artists.html">Artists</a></li>
<li><a href="news.html">News</a></li>
<li><a href="services.html">Services</a></li>
<li><a href="social.html">Social</a></li>
<li><a href="contact.html">Contact</a></li>
</ul>
</div><!-- mobile_menu -->

$("#mobile_menu_btn").click(function () {
        $("#mobile_menu_ul").slideToggle('slow', function() {
  menuDown = true});

}); 
```

就将其放入您的代码而言，您可以尝试编辑您的代码，使其看起来像这样：

```
if (!$(".toggleMenu").hasClass("active")) {
            $(".nav").slideUp('slow');
        } else {
            $(".nav").slideDown('slow');
        } 
```

# java - #ifdef 之类的东西让我不要将所有库添加到我的项目中

> ID：15024382
> 
> 赞同：0
> 
> 时间：2013-02-22T12:35:53.710
> 
> 标签：java

我有一组通过 jar 文件提供的服务（它们是广告网络）。我只想为每个项目添加我需要的网络，但将所有处理网络的代码放在一个类中（它称为 AdNetworkManager）。例如，使用 c# 很容易将一些符号定义为 true 或 false，然后用 #ifdef / #endif 语句包装每个广告网络代码。这可以用java吗？

我已经阅读过有关拥有一些静态最终常量的信息，但这并不符合我的需要。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:45:30.843

为什么不使用属性文件？[你可以在这里](http://www.mkyong.com/java/java-properties-file-examples/)找到简单的例子等

# mongodb - Mongo：匹配聚合查询中的日期似乎被忽略了

> ID：15024383
> 
> 赞同：21
> 
> 时间：2013-02-22T12:35:54.440
> 
> 标签：mongodb, aggregation-framework

我正在尝试在我的 mongo db 中运行聚合语句。我有一个文件，其结构（至少）如下：

```
{
   "_id": ObjectId,
   "date": ISODate,
   "keywordGroupId": NumberLong,
   "ranking": NumberLong,
} 
```

我想运行一个聚合语句，聚合给定“keywordGroupId”和给定“日期”间隔的“排名”字段。

我一直在尝试使用以下聚合命令：

```
{ 
    aggregate : "KeywordHistory", 
    pipeline : [
        { $match: { keywordGroupId: 75 , "$date": {$gte: ISODate("2013-01-01T00:00:00.0Z"), $lt: ISODate("2013-02-01T00:00:00.0Z")}} },
        { $group: { _id: { null }, count: { $sum: "$ranking" } } }
    ]
} 
```

该命令执行没有错误并返回结果。如果我尝试更改“keywordGroupId”字段的值，该命令将返回不同的值，因此我假设 $match 语句适用于该字段 (NumberLong)。但是，如果我更改“日期”范围并指定数据库中没有任何数据的时间间隔，它仍然会返回结果（我实际上希望得到一个空的结果集）。所以我必须假设 $match 语句忽略了指定的日期间隔。

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-02-22T13:56:30.767

删除您的字段`$`上的前缀：`$date``$match`

```
{ $match: { 
    keywordGroupId: 75, 
    date: {$gte: ISODate("2013-01-01T00:00:00.0Z"), $lt: ISODate("2013-02-01T00:00:00.0Z")}
}}, 
```

仅当字段名称在值中使用时才使用`$`前缀，而不是作为键。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-12-25T21:43:06.117

有时 ISOdate 不起作用。因此，如果您只想使用“一个”日期匹配日期，最好的方法是：---

例如：-- 让模式为：--

```
 var storeOrder = new Schema({
    store_name:{type:String, required:true},
    date :{type:Date ,default:moment(new Date()).format('YYYY-MM-DD')},
    orders : [{
    vegetable : String,
    quantity : Number,
    price:Number
     }]
}); 
```

```
mongoose.model('storeorder',storeOrder); 
```

现在按匹配日期聚合：--

```
storeOrder.aggregate([$match:{date :new Date("2016-12-26T00:00:00.000Z")} ]) 
```

**必须使用`new Date("2016-12-26T00:00:00.000z")`，而不是`Date("2016-12-26T00:00:00.000z") because Date(your_date) !== new Date(your_date)`。

谢谢你

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-03-09T03:52:35.343

聚合需要一个 Javascript 日期对象，否则不起作用。

> ```
> new Date();
> new Date(year, month, day); 
> ```

请注意月份以 0 而不是 1 开头（您的 1 月为 0 和 12 月 11 日）

# javascript - Jquery maskedinput插件删除'oOlL'字符

> ID：15024385
> 
> 赞同：0
> 
> 时间：2013-02-22T12:35:56.993
> 
> 标签：javascript, jquery

我正在使用 Jquery maskedinput 插件，我想删除 'o' 、 'O' 、 'l' 、 'L' 字符。我已经搜索了很多，但可以找到任何合适的方法来做到这一点。我尝试使用**[如何从电话字段中删除任何字符](https://stackoverflow.com/questions/5227174/how-do-i-strip-any-characters-out-of-the-telephone-field)** 但没有运气。

我也尝试了这个，但仍然无法正常工作。 [jQuery(函数($){ $.mask.definitions['h']="[lLoO]"; });](https://stackoverflow.com/questions/5227174/how-do-i-strip-any-characters-out-of-the-telephone-field)

任何人都可以在这里帮助我。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:43:08.790

使用此正则表达式定义您的占位符。

```
$.mask.definitions['a'] = "[A-HJ-NQ-Za-np-z0-9]"
$("#input").mask("aaaaaa"); 
```

# .net - 无论如何自定义.NET如何处理浮点异常？

> ID：15024386
> 
> 赞同：1
> 
> 时间：2013-02-22T12:35:57.323
> 
> 标签：.net, delphi, exception, floating-point, clr

显然，CLR 通过忽略异常并返回默认值来处理浮点异常。例如，在浮点溢出的情况下，CLR 返回 +Infinity，但不会引发异常。另一方面，Delphi 默认情况下会在溢出的情况下引发异常。这由 FPU 异常标志控制，您可以通过相应地设置异常标志使 Delphi 与 CLR 执行相同的操作。一切都很好。

我有一个用 Delphi 编写的数值库，它期望溢出作为异常引发。然后它相应地处理这些边缘情况。如果没有引发异常，它不知道该怎么做。现在，如果我在 COM dll 中使用该库并从托管代码中调用该 COM DLL，则不会将溢出作为异常引发，并且该库会返回不正确的结果。我已经通过将所有对库的调用包装在以下代码中来克服这个问题：

```
var
  Mask : TFPUExceptionMask;
begin
  Mask := Math.SetExceptionMask([exDenormalized, exUnderflow, exPrecision]);
  try
    //do my calls to the library
  finally
    Math.SetException(Mask);
  end; 
```

这似乎有效，但我现在遇到了一个溢出的情况，CLR 似乎接管了控制权，而 Delphi 从来没有得到 EOverflow 异常。它只是没有那么远。它进入溢出异常循环（浮点溢出而不是 Delphi 生成的 EOverflow）并使应用程序崩溃。

解决这个问题的唯一方法是不使用上面的掩码，找出可能溢出的地方，并在这段代码中添加一些错误处理代码。这是一个例子：

```
f1 := Power(X, Y);
if f1 = Infinity then
  raise EOverflow.Create('Overflow'); 
```

这并不理想，因为我不太了解图书馆，无法猜测我可能会溢出的所有可能区域。但上述工作正常。

有人有这方面的经验吗？是否可以告诉 CLR 退出 FPU 异常并让 Delphi 处理它们？顺便说一句，如果我从 Excel VBA 调用相同的 COM DLL，则会出现相同的掩码问题，但使用上面的第一个修复，即强制调用掩码，工作正常。只是托管代码有问题。

所以这里有一个例子：

我创建了一个带有单个 COM 对象的 Delphi Active X 库 (DLL)。该对象有一个名为 TestOverflow 的方法，如下所示：

```
function TTestExceptions.TestOverflow : Double;
var
  Mask : TArithmeticExceptionMask;
begin
  Mask := GetExceptionMask;
  try
    Result := Power(600, 30000);
  except
    On EOverflow do
      Result := -1;
  end;
end; 
```

然后我创建了三个客户端。一份用 Delphi 编写，一份用 EXCEL VBA 编写，一份用 C# 编写。每个客户都做同样的事情。创建 COM 对象的实例，并调用 TestOverflow。

**a) 德尔福客户端**

掩码为 [exDenormalized, exUnderflow, exPrecision]

抛出带有消息“浮点溢出”的异常 $C0000091，并将其作为 EOverflow 异常捕获，函数返回 -1。

**b) Excel 客户端**

掩码为 [exInvalidOp, exZeroDivide, exOverflow, exUnderflow, exPrecision]

不抛出异常，函数返回 +INF 作为结果。

**c) C# 客户端**

掩码为 [exInvalidOp, exZeroDivide, exOverflow, exUnderflow, exPrecision]

不抛出异常，函数返回 +INF 作为结果。

然后我更改函数以操作异常掩码：

```
function TTestExceptions.TestOverflow : Double;
var
  Mask : TArithmeticExceptionMask;
begin
  Mask := Math.SetExceptionMask([exDenormalized, exUnderflow, exPrecision]);
  try
    try
      Result := Power(600, 30000);
    except
      On EOverflow do
        Result := -1;
    end;
  finally
    Math.SetExceptionMask(Mask);
  end;
end; 
```

这次我得到：

**a) 德尔福客户端**

抛出带有消息“浮点溢出”的异常 $C0000091，并将其作为 EOverflow 异常捕获，函数返回 -1。

**b) Excel 客户端**

抛出带有消息“浮点溢出”的异常 $C0000091，并将其作为 EOverflow 异常捕获，函数返回 -1。

**c) C# 客户端**

抛出带有消息“浮点溢出”的异常 $C0000091，但执行不会继续，而是在该行停止，并且似乎卡在该行并继续抛出相同的异常，直到它崩溃。

# javascript - 在新标签中打开链接

> ID：15024390
> 
> 赞同：0
> 
> 时间：2013-02-22T12:36:12.420
> 
> 标签：javascript, asp.net, window.open

我正在使用图像按钮将项目的 ID 作为命令参数发送。在一个窗口中，我只显示一张图片，那就是图像按钮。单击该图像时，我想在新选项卡中打开相关项目的所有图片。

有了这个代码后面的代码，

```
int ID = Convert.ToInt32(e.CommandArgument);
ScriptManager.RegisterClientScriptBlock(this, this.GetType(), "", string.Format("yenipencere = window.open('Projeresim.aspx?ProjeID={0}','_blank')", ID), true); 
```

我可以在 Firefox 和 Internet Explorer 中很好地管理它，但 Chrome 坚持将其作为弹出窗口打开。有什么方法可以在 Chrome 中实现这一点，还是默认的 Chrome 设置？

我知道我可以使用其他链接方法，但我需要发送一个 ID 作为参数。

# java - JasperReports xlsx 导出错误 - 内容不可读 - 为什么？

> ID：15024396
> 
> 赞同：2
> 
> 时间：2013-02-22T12:36:35.340
> 
> 标签：java, jasper-reports, xls, xlsx

每当我的交叉表报告的结果大于 702 列（ZZ 列）时，就会从 Excel 收到“不可读的内容”错误。当少于此列数时 - 没有错误。有限制吗？XLSX 应处理 16,000 多列。

我们正在使用 JasperReports v4.0.1 和 POI 3.6。我已经尝试并使用 JasperReports v4.7 和 POI 3.7 重新创建了同样的问题。

任何帮助或见解表示赞赏。

出口代码：

```
JRXlsxExporter xlsExporter = new JRXlsxExporter();

File fileP = new File(_workdir + report_name + ".jrprint");
JasperPrint jasperPrint = (JasperPrint)
JRLoader.loadObject(fileP);

xlsExporter.setParameter(JRXlsExporterParameter.IS_ONE_PAGE_PER_SHEET, Boolean.TRUE);
xlsExporter.setParameter(JRXlsExporterParameter.IS_REMOVE_EMPTY_SPACE_BETWEEN_ROWS, Boolean.TRUE);
xlsExporter.setParameter(JRXlsExporterParameter.IS_DETECT_CELL_TYPE, Boolean.TRUE);
xlsExporter.setParameter(JRXlsExporterParameter.IS_WHITE_PAGE_BACKGROUND, Boolean.FALSE);
xlsExporter.setParameter(JRXlsExporterParameter.IS_REMOVE_EMPTY_SPACE_BETWEEN_COLUMNS, Boolean.TRUE);
xlsExporter.setParameter(JRXlsExporterParameter.IS_COLLAPSE_ROW_SPAN, Boolean.TRUE);

xlsExporter.setParameter(JRExporterParameter.JASPER_PRINT, jasperPrint);
xlsExporter.setParameter(JRExporterParameter.OUTPUT_FILE_NAME, _outputName);
System.out.println("Exporting Excel Report to " + _outputName);
xlsExporter.exportReport();
System.out.println("Export Complete."); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-03T17:11:17.740

试试用这个，

```
JRXlsxExporter jrXlsxExporter=new JRXlsxExporter();
jrXlsxExporter.setParameter(JRExporterParameter.JASPER_PRINT, jasperPrint);
jrXlsxExporter.setParameter(JRExporterParameter.OUTPUT_FILE_NAME, "export.xlsx");
jrXlsxExporter.exportReport(); 
```

# android - 在原生 Android 应用程序中使用 WebView 整个布局是否有用？

> ID：15024400
> 
> 赞同：20
> 
> 时间：2013-02-22T12:36:41.783
> 
> 标签：android, html, android-layout, android-webview

我目前正在开发一个原生的 android 应用程序。我的应用程序有很多活动。我想开发`native`安卓应用。但在某些情况下，我想使用`webview`整个布局只是一个 webview 的地方。不是线性或相对或其他布局，只是一个 web 视图。所有以 HTML 格式运行的图像和其他内容。`All of screen will run in HTML5.`

因此，我可以将我的应用程序部分转移到 iphone 应用程序或其他平台上。这就是这种方式对我的好处。

但我不知道。这种方式更好吗？会有怎样的表现？转换为 HTML5 应用程序的缺点是什么？

你可以解释吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-22T12:58:17.157

关于这个主题有一个[很好的介绍。](http://martinfowler.com/articles/multiMobile/)

1.  性能：您在两者之间添加了一个额外的层，Webkit 引擎不能总是匹配本机（有时是硬件加速）渲染性能。

2.  缺点：一是API使用有限，可以将页面的JavaScript绑定到Native代码，但不是所有功能都可用。虽然你可能想看看[Cordova](http://cordova.apache.org/)项目的功能。另一个是通过 JavaScript 模拟复杂的小部件会减慢页面速度。

3.  便携性：Indeed 是一个很大的优势，这就是[PhoneGap](http://phonegap.com/)和[Cordova](http://cordova.apache.org/)受欢迎的原因。尽管许多像 Facebook 应用程序等已经[切换到原生](http://www.theregister.co.uk/2012/12/13/facebook_native_app_for_android/)应用程序以获得更好的性能。

您需要的方法实际上取决于您的要求。这可能是我个人的咆哮，但恕我直言：到目前为止，标记只能被扭曲，它还不能胜过工业级 GUI 编程设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-05-09T09:48:36.923

**缺点 WebView**

*   无法使用设备的全部性能，因为 web 视图形成了一个额外的层。
*   Web 视图无法监听所有用户事件。
*   您无法将 Web 视图中的数据完全共享或保存到应用程序。
*   花更多的时间来加载。其他我们在一个简单的 API 中得到所有东西并且可以被渲染。
*   更改页面中的简单字段需要再次加载整页。
*   需要在线，无法扩展离线功能。
*   方向变化和全屏制造困难。

**使用 Web 视图的优点**

*   安卓和IOS都一页。
*   我认为主要优点是无需每个用户在其设备上更新应用程序即可进行更改，因为所有页面都在您的服务器上。
*   无需等待应用商店批准更新。

**一些技巧**

*   原生元素与 WebView 一起使用。我觉得会好很多，因为有很多功能不能只用WebView来完成。更推荐两者结合。
*   从本地渲染，为 HTML 文件创建一个 assets 目录 - Android 在内部将其映射到 file:///android_asset/ （注意单数资产）。因此，即使您处于离线状态，您也可以在本地提供您的 Web 视图表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T13:01:24.327

我认为 - 通过使用这种方式 - 你的应用程序质量会很弱并且应用程序将难以使用，因为 webview 对象没有很多工具可以使其与 android 兼容。例如，您不能将数据从 web 视图共享或保存到应用程序。无论您的应用程序上的参考是什么，需要什么和不需要什么，顺便说一下，我尝试使用 html 开发应用程序，但这很糟糕。

# python - 一个易于理解的 Web2Py 培训指南

> ID：15024402
> 
> 赞同：-1
> 
> 时间：2013-02-22T12:36:48.647
> 
> 标签：python, web2py

我正在寻找一个易于理解、免费、用户友好的 web2py 培训资源，它需要时间来介绍每个概念以及如何使用尽可能多的英语（以及尽可能少的技术术语）来使用每个新对象。

我想要一种资源，它能让我对使用 web2py 进行创新感到舒适和自信，而不是让我复制和粘贴代码而无需解释的资源。我特别关注 MVC 编码方面，因为我已经弄清楚了如何将网站部署到 PythonAnywhere（以及所有基本的东西，如下载、安装、创建项目、管理面板的基础知识）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:06:50.447

我假设您已经看过[文档和资源](http://www.web2py.com/examples/default/documentation)页面，其中包含指向[在线图书](http://web2py.com/book)的链接？那里有大量的信息和示例，我相信它们可以帮助您入门并作为很好的参考指南。

# java - 创建具有循环依赖关系的实体映射器

> ID：15024403
> 
> 赞同：0
> 
> 时间：2013-02-22T12:36:52.703
> 
> 标签：java, dependencies, cycle

我正在处理的项目有问题。我需要创建一个映射器，将实体对象转换为它的 VO（值对象）形式，我需要这样做来限制我的持久层和我的业务层之间的依赖关系，但是我有一些我无法解决的循环依赖关系，看看这个例子：

我想在我的业务层中使用 Competence 对象，所以我使用映射器将实体转换为我的层可用的 VO。

```
class Competence {
    private Domain dom;
}

class Domain {
    private List<Competence> lComp;
} 
```

但是当我转换一个能力对象时，我也需要转换一个域，当我转换一个域时，我需要转换能力列表等......而且我真的不想转换我的数据库的一半：/

我正在考虑转换一半的对象或避免某些对象来停止循环，但这很危险，这并不是我的问题的真正解决方案：/

你有解决这个问题的方法吗？

提前致谢 ！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:45:24.853

处理此类问题的一种标准机制是重新编码为：

```
class Competence {
}

class Domain {
}

class CompetenceDomain {
  Competence competence;
  Domain domain;
}

Map<Domain,List<Competence>> domainsWithCompetence = ...;
Map<Competence,Domain> competencesInDomain = ...; 
```

这将对象的**关系**从对象本身分解为一个单独的机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:44:29.333

有几种方法可以解决这个问题。首先，您必须决定要转换哪一方。假设您要转换`Competence`s 而不是转换`Domain`s。

1.  使用 ID 来`Domain`引用`Competence`.
2.  使用仅包含您需要的 ID 和一组最小字段（不包括 s）的存根`Domain`对象。`Competence`

希望我已经正确理解了您的问题。

# php - PDO 驱动程序异常 symfony2

> ID：15024404
> 
> 赞同：1
> 
> 时间：2013-02-22T12:36:54.663
> 
> 标签：php, symfony, pdo

我在 ubuntu12.10 上使用 xampp 1.8.1

我在 Windows 机器上做一个 symfony2 项目，我目前在 ubuntu 机器上做同一个项目。

问题是当我运行类似的命令时

```
php app/console doctrine:schema:update 
```

它给出了错误

> PDO 异常：找不到驱动程序

而我检查了我的 phpinfo 并且 pdo_mysql 已启用。我的项目中还有许多选择和插入查询，它们工作正常。

当我运行 `php -m`它时也只显示 PDO 而不是 pdo_mysql

环境变量或类似的东西有问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T13:59:46.470

`pdo_mysql`您的 php CLI ini 文件中可能未启用该扩展。

检查您的ini文件的`pdo_mysql`扩展名，您可以从.ini文件中获取您的ini文件位置`php --ini`。在 ubuntu 上它应该输出所有加载的 ini 文件的列表，寻找

`/etc/php5/cli/conf.d/pdo_mysql.ini`

和

`/etc/php5/cli/conf.d/pdo.ini`

如果没有列出这两个 ini 文件中的任何一个，则说明您尚未安装该扩展程序。如果它们存在，请确保在这些 ini 文件中启用了它们的扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-18T14:10:34.950

确保在 symfony 项目正在使用的**php.ini**文件上启用扩展*php_pdo_mysql*和*php_pdo ，在**localhost/path_to_your_project/web/config.php上检查*

 ***提示：查看您的**Apache 错误日志**，您的扩展加载可能有问题。该文件根据您的服务器配置定位。***

# java - JAX-RS 异常：用资源的 GET 注释，类不被识别为有效的资源方法

> ID：15024408
> 
> 赞同：3
> 
> 时间：2013-02-22T12:37:22.533
> 
> 标签：java, web-services, rest, service, jax-rs

我正在为 Web 服务使用 JAX-RS 的球衣实现。我对这个 JAX-RS 很陌生。

我正在尝试在服务中添加一个方法，该方法接受一个 Employee 对象并根据 Employee 对象值返回员工 ID（为此有一个数据库命中）。

遵循Restful原则，我将方法设为@GET，并提供如下所示的url路径：

```
@Path("/EmployeeDetails")
public class EmployeeService {
@GET
@Path("/emp/{param}")
public Response getEmpDetails(@PathParam("param") Employee empDetails) {

    //Get the employee details, get the db values and return the Employee Id. 

    return Response.status(200).entity("returnEmployeeId").build();

}
} 
```

出于测试目的，我写了这个客户端：

```
public class ServiceClient {

public static void main(String[] args) {

    ClientConfig config = new DefaultClientConfig();
    Client client = Client.create(config);
    WebResource service = client.resource(getBaseURI());

    Employee emp = new Employee();
    emp.name = "Junk Name";
    emp.age = "20";
    System.out.println(service.path("rest").path("emp/" + emp).accept(MediaType.TEXT_PLAIN).get(String.class));

}

private static URI getBaseURI() {
    return UriBuilder.fromUri("http://localhost:8045/AppName").build();
} 
```

}

当我运行它时，我收到错误：`Method, public javax.ws.rs.core.Response com.rest.EmployeeService.getEmpDetails(com.model.Employee), annotated with GET of resource, class com.rest.EmployeeService, is not recognized as valid resource method.`

**编辑：**

模型：

```
package com.model;

public class Employee {

public String name;
public String age;

} 
```

请让我知道问题出在哪里，我是这方面的初学者，正在努力理解这些概念:(

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T13:28:35.880

JAX-RS 不能自动将 @PathParam（它是一个字符串值）转换为一个`Employee`对象。可以从 @PathParam 自动创建的对象的要求是：

1.  字符串（事实上，因为数据已经是字符串）
2.  具有接受（单个）字符串作为参数的构造函数的对象
3.  具有静态`valueOf(String)`方法的对象

对于情况 2 和 3，对象需要解析字符串数据并填充其内部状态。通常不会这样做（因为它会迫使您对数据的内容类型做出假设）。对于您的情况（刚开始学习 JAX-RS），最好只接受传入的 @PathParam 数据作为字符串（或整数，或长整数）。

```
@GET
@Path("/emp/{id}")
public Response getEmpDetails(@PathParam("id") String empId) {
    return Response.status(200).entity(empId).build();
} 
```

* * *

在 GET 方法中将复杂的对象表示传递给 REST 服务没有多大意义，除非它被用作搜索过滤器。根据您的反馈，这就是您正在尝试做的事情。实际上，我之前在一个项目上做过这个（搜索过滤器的通用实现），需要注意的是您需要严格定义搜索数据的格式。因此，让我们将 JSON 定义为可接受的格式（您可以根据需要将该示例调整为其他格式）。“搜索对象”将作为名为 的查询参数传递给服务`filter`。

```
@GET
@Path("/emp")
public Response getEmployees(@QueryParam("filter") String filter) {
    // The filter needs to be converted to an Employee object. Use your
    // favorite JSON library to convert. I will illustrate the conversion
    // with Jackson, since it ships with Jersey
    final Employee empTemplate = new ObjectMapper().readValue(filter, Employee.class);

    // Do your database search, etc, etc
    final String id = getMatchingId(empTemplate);

    // return an appropriate response
    return Response.status(200).entity(id).build();
} 
```

在您的客户类中：

```
final String json = new ObjectMapper().writeValueAsString(emp);
service
    .path("rest")
    .path("emp")
    .queryParam("filter", json)
    .accept(emp, MediaType.TEXT_PLAIN)
    .get(String.class) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-15T11:15:04.537

我遇到了同样的问题，但我只是修复了它在您的应用程序中使用的球衣罐应该具有相同的版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T13:29:41.223

您想将实体（Employee）序列化为url路径段，这很奇怪。我不是说不可能，而是说很奇怪，然后你必须确保`Employee`该类满足以下条件（来自[javadoc 的](http://jsr311.java.net/nonav/javadoc/javax/ws/rs/PathParam.html) `@PathParam`）

> 带注释的参数、字段或属性的类型必须：
> ...（无关部分）
> 具有接受单个字符串参数的构造函数。
> 有一个名为 valueOf 或 fromString 的静态方法，它接受单个 String 参数（例如，参见 Integer.valueOf(String)）。

您可能希望`Employee`在请求正文中而不是在路径参数中传递对象。为此，请使用 注释`Employee`类，从方法的参数`@XmlRootElement`中删除注释，并将@GET 更改为@POST。`@PathParam``empDetails`

# android - ListView 强制应用关闭

> ID：15024412
> 
> 赞同：0
> 
> 时间：2013-02-22T12:37:33.343
> 
> 标签：android

我正在尝试让 ListView 工作，但我在屏幕上收到一条消息，需要关闭应用程序！我正在寻找错误，但我找不到任何错误！也许它在布局内部？我不确定我是否应该在里面有一个 ListView 或者这是创建 cdynamic 的？我究竟做错了什么？我也将使用 onClick 方法，但我想在这种情况下这是一个矿工问题！？一些帮助！谢谢！

```
public class Activity_3 extends ListActivity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    String[] projection = {ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME, ContactsContract.CommonDataKinds.Phone.NUMBER, ContactsContract.CommonDataKinds.Phone._ID};

    // Get a cursor with all people
    Cursor cursor = managedQuery(ContactsContract.Contacts.CONTENT_URI,
            projection, null, null, null);

    startManagingCursor(cursor);

    ListAdapter adapter = new SimpleCursorAdapter(this, R.layout.activity_3, cursor, new String[] {ContactsContract.Contacts.DISPLAY_NAME}, new int[] {R.id.contactItem });

    setListAdapter(adapter);
}
} 
```

布局

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<ListView
    android:id="@+id/contactList"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >
</ListView>

<TextView android:id="@+id/contactItem" >
</TextView>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:53:17.803

您是否已添加此权限

```
 <uses-permission android:name="android.permission.READ_CONTACTS"></uses-permission> 
```

在 manifest.xml

好的，现在这应该是您的活动

```
public class mainact extends Activity {

    ListView l;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        super.onCreate(savedInstanceState);
        setContentView(R.layout.abc);
        l=(ListView)findViewById(R.id.contactList);

        String[] projection = {ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME, ContactsContract.CommonDataKinds.Phone.NUMBER, ContactsContract.CommonDataKinds.Phone._ID};

        // Get a cursor with all people

        Cursor phones = getContentResolver().query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI, projection,null,null, null);

        while (phones.moveToNext())
        {
             String Name=phones.getString(phones.getColumnIndex(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME));
             String Number=phones.getString(phones.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER));

        }
        startManagingCursor(phones);

        ListAdapter adapter = new SimpleCursorAdapter(this, R.layout.abc, phones, new String[] {ContactsContract.Contacts.DISPLAY_NAME}, new int[] {R.id.contactItem });

        l.setAdapter(adapter);
    }
    } 
```

和 xml 应该像

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<ListView
    android:id="@+id/contactList"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >
</ListView>

<TextView
android:layout_width="wrap_content"
android:layout_height="wrap_content"
 android:id="@+id/contactItem" >
</TextView>

</LinearLayout> 
```

或者只是适合您的需要，但这是工作代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:51:37.923

据我了解，您正在尝试使用适配器来创建每个视图包含另一个 ListView 的视图？

删除

```
<ListView
    android:id="@+id/contactList"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >
</ListView> 
```

通常你不能将 ListView 放在另一个 ListView 中。

# asp.net - 在 asp.net 中使用 @font-face css

> ID：15024413
> 
> 赞同：1
> 
> 时间：2013-02-22T12:37:38.010
> 
> 标签：asp.net, html, css

我在我的css中使用@font-face。我的是一个 ASP.NET 网络应用程序，用于页面的文档类型是

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

CSS如下

```
 @font-face                         { font-family: 'ML-TTLeela';
                                 src: url('../Styles/Font/mlll0ntt.eot') ;/* IE9 Compat Modes */
                                 src: url('../Styles/Font/mlll0ntt.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
                                 url('../Styles/Font/mlll0ntt.woff') format('woff'), /* Modern Browsers */
                                 url('../Styles/Font/mlll0ntt.ttf')  format('truetype'), /* Safari, Android, iOS */
                                 url('../Styles/Font/mlll0ntt.svg#svgFontName') format('svg'); /* Legacy iOS */ } 
```

我正在使用 VS 2010，并且 CSS 已针对 CSS 2.1 进行了验证。如何将其更改为 CSS 3？@font-face 似乎也不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:39:56.247

来自的回答：[是否可以在 VS2010 中更改 CSS 验证方案](https://stackoverflow.com/questions/3931801/is-it-possible-to-change-css-validation-scheme-in-vs2010)

如果要在 Visual Studio 2010 中验证 CSS 3.0，则需要[安装](http://visualstudiogallery.msdn.microsoft.com/7211bcac-091b-4a32-be2d-e797be0db210/view/Discussions)Visual Studio 2010 Service Pack 1，然后安装“CSS 3 Intellisense Schema”

然后您将在 easwee 提到的下拉菜单中看到“CSS 3.0”。

# php - PHP中的网格输出？

> ID：15024417
> 
> 赞同：-2
> 
> 时间：2013-02-22T12:37:54.280
> 
> 标签：php, mysql, css, html

我试图以网格类型的方式在 PHP 中显示 mysql 的输出！

我正在使用这段代码：

```
<?php 
// Run a select query to get my letest 6 items
// Connect to the MySQL database  
include "config/connect_to_mysql.php"; 
$dynamicList = "";
$sql = mysql_query("SELECT * FROM products ORDER BY date_added DESC LIMIT 6");
$productCount = mysql_num_rows($sql); // count the output amount
if ($productCount > 0) {
    while($row = mysql_fetch_array($sql)){ 
             $id = $row["id"];
             $product_name = $row["product_name"];
             $price = $row["price"];
             $date_added = strftime("%b %d, %Y", strtotime($row["date_added"]));
             $dynamicList .= '<div class="shadow" id="products_holder"><a href="product.php?id=' . $id . '"><img src="inventory_images/' . $id . '.jpg" width="160" height="150" border="0" /></a>£' . $price . '<br></br>' . $product_name . '</div>';
    }
} else {
    $dynamicList = "We have no products listed in our store yet";
}
mysql_close();
?> 
```

它工作得很好，但它不会以网格方式输出数据！

一切都在彼此之下，而不是像行一样在顶部说 5 和在底部说 5！

互联网上有一些关于网格输出的教程，但它使用表格，我使用的是 Div。所以这就是我感到困惑和卡住的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:43:05.110

如果你想使用 div 而不是表格：

*   不要对所有项目使用相同的 id，您稍后会遇到问题。相反，使用多个类。
*   添加一些 CSS 使每个盒子都成为`div`一个有限大小的盒子，例如

    .shadow { 宽度：20%; 向左飘浮; 填充：10px；}

    达到网格效果。如果项目的高度不同，您可能会遇到问题，因此您必须确保它（相同大小的图像等）或使用一些 javascript 使它们具有相同的高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:53:05.923

尝试这样的事情并根据您的需要进行修改：

```
$dynamicList .= '<div class="shadow tr" id="products_holder"><div class="td"><a href="product.php?id=' . $id . '"><img src="inventory_images/' . $id . '.jpg" width="160" height="150" border="0" /></a></div><div class="td" >£' . $price . '<br></br>' . $product_name . '</div></div>'; 
```

并使用一些CSS作为：

```
<style type="text/css">
 .tr{float:left;width:200px;}
 .td{float:left;width:160px;height:150px;border:1px solid black;}
</style> 
```

最后但并非最不重要的一点是，从您的代码中删除 id="products_holder" 因为它会生成多个具有相同 id 的 div，这是一种不好的坏习惯。

**更新：** 对于您的新问题，即您想单独放置 5 行，这样的东西应该可以工作：

```
 if($i==0 || $i % 5 == 0){ 
 $dynamicList .= '<div class="table">';
  } 
$dynamicList .= '<div class="shadow tr" id="products_holder"><div class="td"><a href="product.php?id=' . $id . '"><img src="inventory_images/' . $id . '.jpg" width="160" height="150" border="0" /></a></div><div class="td" >£' . $price . '<br></br>' . $product_name . '</div></div>';
 if($i==0 || $i % 5 == 0){ 
  $dynamicList .= '</div><div style="clear:both"></div>';// div-table ends here
 } 
```

修改你的css并添加一个类：

```
<style>
.table{float:left;width:160px;}
</style> 
```

# windows - windows下CodeBlocks的CMake

> ID：15024419
> 
> 赞同：0
> 
> 时间：2013-02-22T12:37:55.940
> 
> 标签：windows, cmake, codeblocks

我正在尝试使用 CMake 在 Windows 下使用 CodeBlocks 进行编码。

在 Cygwin 控制台中，我这样做：

```
cmake .. -G"CodeBlocks - Unix Makefiles" 
```

输出是：

```
CMake Error: CMake was unable to find a build program corresponding to "Unix Makefiles".  CMAKE_MAKE_PROGRAM is not set.  You probably need to select a different build tool.
CMake Error: Error required internal CMake variable not set, cmake may be not be built correctly.
Missing variable is:
CMAKE_C_COMPILER_ENV_VAR
CMake Error: Error required internal CMake variable not set, cmake may be not be built correctly.
Missing variable is:
CMAKE_C_COMPILER
CMake Error: Could not find cmake module file:D:/sources/tests/testOSG/build_CodeBlocks/CMakeFiles/CMakeCCompiler.cmake
CMake Error: Error required internal CMake variable not set, cmake may be not be built correctly.
Missing variable is:
CMAKE_CXX_COMPILER_ENV_VAR
CMake Error: Error required internal CMake variable not set, cmake may be not be built correctly.
Missing variable is:
CMAKE_CXX_COMPILER
CMake Error: Could not find cmake module file:D:/sources/tests/testOSG/build_CodeBlocks/CMakeFiles/CMakeCXXCompiler.cmake
CMake Error: CMAKE_C_COMPILER not set, after EnableLanguage
CMake Error: CMAKE_CXX_COMPILER not set, after EnableLanguage
-- Configuring incomplete, errors occurred! 
```

我试图设置那些有问题的变量，但结果是一样的：

```
set CMAKE_MAKE_PROGRAM=C:/Progra~2/CodeBlocks/MinGW/bin/mingw32-make.exe
set CMAKE_C_COMPILER=C:/Progra~2/Microsoft Visual Studio 10.0/VC/bin/cl.exe
set CMAKE_CXX_COMPILER=C:/Progra~2/Microsoft Visual Studio 10.0/VC/bin/cl.exe 
```

任何想法如何使它工作？

编辑：将路径添加到编译器会有所帮助，但仍然存在错误：

```
-- The C compiler identification is unknown
-- The CXX compiler identification is unknown
-- Defining WIN32 under Cygwin due to CMAKE_LEGACY_CYGWIN_WIN32
-- Check for working C compiler: C:/Program Files (x86)/Microsoft Visual Studio 10.0/VC/bin/cl.exe
-- Check for working C compiler: C:/Program Files (x86)/Microsoft Visual Studio 10.0/VC/bin/cl.exe -- broken
CMake Error at /usr/share/cmake-2.8.9/Modules/CMakeTestCCompiler.cmake:52 (MESSAGE):
  The C compiler "C:/Program Files (x86)/Microsoft Visual Studio
  10.0/VC/bin/cl.exe" is not able to compile a simple test program.

  It fails with the following output:

   Change Dir: /cygdrive/d/sources/tests/testOSG/build_CodeBlocks/CMakeFiles/CMakeTmp

  Run Build Command:C:/Program\ Files\
  (x86)/CodeBlocks/MinGW/bin/mingw32-make.exe
  "cmTryCompileExec437970983/fast"

  C:/Program Files (x86)/CodeBlocks/MinGW/bin/mingw32-make -f
  CMakeFiles/cmTryCompileExec437970983.dir/build.make
  CMakeFiles/cmTryCompileExec437970983.dir/build

  /usr/bin/sh: -c: line 0: Erreur de syntaxe près du symbole inattendu « (
  »

  /usr/bin/sh: -c: line 0: `C:/Program Files
  (x86)/CodeBlocks/MinGW/bin/mingw32-make -f
  CMakeFiles/cmTryCompileExec437970983.dir/build.make
  CMakeFiles/cmTryCompileExec437970983.dir/build'

  mingw32-make: *** [cmTryCompileExec437970983/fast] Error 1

  CMake will not be able to correctly generate this project.
Call Stack (most recent call first):

-- Configuring incomplete, errors occurred! 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-10T09:49:51.040

也许您从“MinGW 安装管理器”安装了“基本设置”。由于它没有安装包名称为“mingw-gcc-g++”的 GNU C++ 编译器，因此您应该选择它的“bin”和“dev”并手动安装。这对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-06-09T22:46:50.957

对我来说，以下工作：

下载了 codeblocks-17.12mingw-setup。

添加到 /MinGW/bin 的路径

提示：不要安装到有空格的路径

在我的情况下 C:\Program Files (x86)\CodeBlocks\MinGW\bin 不适用于某些项目。

当使用 c:\codeblocks... 他们工作

在 cmake 中使用“CodeBlocks - MinGW Makefiles”

然后打开 project.cbp

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T14:36:00.597

确保带有编译器的目录（MinGw-gcc.exe 或类似的东西）在 PATH 中，然后再次启动控制台并尝试再次运行 cmake。

# node.js - Node.JS + CentOS + node-waf

> ID：15024421
> 
> 赞同：4
> 
> 时间：2013-02-22T12:38:05.190
> 
> 标签：node.js, centos, npm

**我已经从源代码**在 CentOS 上安装了 Node.JS，如下所示：

```
yum install gcc-c++ make git
cd /usr/local/src/
git clone git://github.com/joyent/node.git
cd node
./configure
make
make install 
```

但是在通过**npm**安装模块时出现错误：

```
sh: node-waf: command not found
npm ERR! threads_a_gogo@0.1.5 install: `node-waf configure install`
npm ERR! `sh "-c" "node-waf configure install"` failed with 127
npm ERR! 
npm ERR! Failed at the threads_a_gogo@0.1.5 install script.
npm ERR! This is most likely a problem with the threads_a_gogo package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node-waf configure install
npm ERR! You can get their info via:
npm ERR!     npm owner ls threads_a_gogo
npm ERR! There is likely additional logging output above. 
```

这个问题与 CentOS 相关，还是可能出了什么问题？[此](http://apphacker.wordpress.com/2011/09/12/node-waf-command-not-found/)链接表明，仅当未从源安装 Node 时才会发生此错误....在这种情况下*是*.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T19:20:58.613

node-waf 已弃用，并已从节点 0.10 中删除：[https](https://github.com/joyent/node/issues/3475) ://github.com/joyent/node/issues/3475 。您应该打开您尝试使用的软件包的问题，​​以将其更新为 node-gyp。

# android - xml 中的 Android 谷歌地图片段。我得到“意外的命名空间前缀”

> ID：15024430
> 
> 赞同：35
> 
> 时间：2013-02-22T12:38:49.480
> 
> 标签：android, xml, android-layout, xml-parsing, google-maps-android-api-2

我正在尝试学习 android，并按照有关如何使用 Google Maps API V.2 的说明进行操作，现在我可以使用它了。[但是，在developers.google.com](https://developers.google.com/maps/documentation/android/map#using_xml_attributes)上找到的关于如何配置地图初始状态的说明建议在xml 文件中定义一个命名空间，在本例中为“map”。

下面的 xml 代码给出了错误**“意外的命名空间前缀“映射”** ”。尝试在片段标记内定义**xmlns:map**会产生相同的错误，但使用“xmlns”。

我显然在这里缺少一些基本的 xml 知识，有人可以帮助我吗？

```
<RelativeLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"        
    xmlns:tools="http://schemas.android.com/tools"
    xmlns:map="http://schemas.android.com/apk/res-auto"      <!-- Definition -->
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <fragment 
        android:id="@+id/map"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.google.android.gms.maps.SupportMapFragment"
        map:cameraBearing="112.5"/>                            <!-- PROBLEM -->

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-20T02:00:33.363

我也有这个问题。我做了项目/清理，错误消失了，现在工作正常。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-04-10T10:54:58.787

你必须做两件事：

首先： [https ://docs.google.com/document/pub?id=19nQzvKP-CVLd7_VrpwnHfl-AE9fjbJySowONZZtNHzw](https://docs.google.com/document/pub?id=19nQzvKP-CVLd7_VrpwnHfl-AE9fjbJySowONZZtNHzw)

将对 Google Play 服务的依赖项添加到您的项目中

```
Project -> Properties -> Android -> Library, Add -> google-play-services_lib 
```

第二： [https ://developers.google.com/maps/documentation/android/intro](https://developers.google.com/maps/documentation/android/intro)

选择`Project > Properties`，选择`Java Build Path`，然后导航到`Libraries`。选择`Add External Jars`，包含以下 jar 文件，然后单击确定：

```
<android-sdk-folder>/extras/android/compatibility/v4/android-support-v4.jar 
```

现在我的项目不再显示错误:)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2013-03-07T19:16:15.413

我今天也有同样的问题。我昨晚升级了SDK，之前没有看到这个问题。我也加载了 Android Map V2 示例演示项目，今天“multimap_demo.xml”文件显示“为标签片段找到意外的命名空间前缀“map””错误。我应用了建议的 xml 包含，它又可以工作了。会给它+1，但没有信誉。

更新：我忘记了这个问题，今天重新编写了我的代码并删除了包含。当然错误又回来了。我找到了这个并将其添加到片段节的布局中：

```
tools:ignore="MissingPrefix" 
```

它似乎至少掩盖了这个问题。

更新：这个错误显然是由于 Android Lint Tool 中的错误而发生的。参考问题[https://code.google.com/p/gmaps-api-issues/issues/detail?id=5002](https://code.google.com/p/gmaps-api-issues/issues/detail?id=5002)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2013-03-07T14:49:27.387

还有另一种解决方法，可让您继续在布局文件中而不是在 Java 代码中设置所有内容。由于错误似乎只发生在布局文件`SupportMapFragment`中 a 的子元素`ViewGroup`时，因此可以将元素提取`<fragment>`到其自己的布局文件中，然后将其包含在所需的更大布局中。

例如，假设您正在尝试这样做：

**my_awesome_layout.xml**

```
...
<RelativeLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"        
    xmlns:map="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <fragment 
        android:id="@+id/map"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.google.android.gms.maps.SupportMapFragment"
        map:cameraBearing="112.5"/>

</RelativeLayout> 
```

你可以像这样分解它：

**include_map_fragment.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<fragment xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:map="http://scheams.android.com/apk/res-auto"
    android:id="@+id/map"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    class="com.google.android.gms.maps.SupportMapFragment"
    map:cameraBearing="112.5"/> 
```

**my_awesome_layout.xml**

```
...
<RelativeLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"        
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <include 
        android:id="@+id/map"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        layout="@layout/include_map_fragment" />

</RelativeLayout> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-02-27T15:46:47.413

好吧，我知道，这并不是名称空间问题的真正解决方案，也许这可能会有所帮助。

因为我不知道任何 XML 解决方案，所以我以编程方式完成了它：

```
mMap = ((SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map)).getMap();
mMap.setTrafficEnabled(true);
setupMapView();

private void setupMapView(){
 UiSettings settings = mMap.getUiSettings();        
 mMap.animateCamera(CameraUpdateFactory.newCameraPosition(
  new CameraPosition(new LatLng(50.0, 10.5), 
  13.5f, 30f, 112.5f))); // zoom, tilt, bearing
 mMap.setTrafficEnabled(true);
 settings.setAllGesturesEnabled(true);
 settings.setCompassEnabled(true);
 settings.setMyLocationButtonEnabled(true);
 settings.setRotateGesturesEnabled(true);
 settings.setScrollGesturesEnabled(true);
 settings.setTiltGesturesEnabled(true);
 settings.setZoomControlsEnabled(true);
 settings.setZoomGesturesEnabled(true);
} 
```

所以谷歌地图是默认初始化的，但之后直接从代码中获取参数。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-02-23T10:59:52.363

我有完全相同的问题。提供的示例

```
<fragment xmlns:android="http://schemas.android.com/apk/res/android"
  xmlns:map="http://schemas.android.com/apk/res-auto"
  android:id="@+id/map"
  android:layout_width="match_parent"
  android:layout_height="match_parent"
  class="com.google.android.gms.maps.SupportMapFragment"
  map:cameraBearing="112.5"
  map:cameraTargetLat="-33.796923"
  map:cameraTargetLng="150.922433"
  map:cameraTilt="30"
  map:cameraZoom="13"
  map:mapType="normal"
  map:uiCompass="false"
  map:uiRotateGestures="true"
  map:uiScrollGestures="false"
  map:uiTiltGestures="true"
  map:uiZoomControls="false"
  map:uiZoomGestures="true"/> 
```

工作正常，但是如果您尝试将其添加到父元素中，它会拒绝接受 xmlns。如果将 xmlns 声明移动到顶部元素，它仍然拒绝接受片段中的映射前缀：

```
Unexpected namespace prefix "map" found for tag fragment 
```

现在，如果您扩展 SupportMapFragment 并使用如下自定义视图：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:map="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:padding="5dp">

    <com.google.android.gms.maps.MapView
        android:id="@+id/map_view"
        android:layout_width="match_parent"
        android:layout_height="match_parent" 
        map:cameraBearing="0" 
        map:cameraTargetLat="54.25"
        map:cameraTargetLng="-4.56"
        map:cameraTilt="30"
        map:cameraZoom="5.6"
        map:mapType="normal"
        map:uiCompass="true"
        map:uiRotateGestures="true"
        map:uiScrollGestures="true"
        map:uiTiltGestures="true"
        map:uiZoomControls="false"
        map:uiZoomGestures="true">

    </com.google.android.gms.maps.MapView>

</LinearLayout> 
```

...然后它不会抱怨，并且生成的地图是正确的。对我来说，这引发了进一步的问题，但是由于没有像样的示例说明如何进行此子类化，您必须做的不仅仅是覆盖**onCreateView**，当我随后尝试对地图执行任何操作时，我得到以下信息：

```
java.lang.IllegalStateException: Map size should not be 0\. Most likely, layout has not yet occured for the map view. 
```

...即使我在地图出现后等待 30 秒。（仅第一次加载）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-22T22:42:19.690

我认为您不能*像*使用`<!-- Definition -->`. 如果您删除它，问题仍然存在吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-03T18:00:16.170

显然这只是一个误导性的 Lint 检查错误。*当您在 Eclipse 的问题视图*中右键单击有错误的行，选择*快速修复*选项并选择例如*Ignore Check for project*时，您可以将其删除。

错误消失，项目构建并且应用程序运行良好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-09-29T17:44:04.400

就我而言，这是一个很大的失误，我忘记在 gradle 文件中添加我的谷歌地图依赖项：

```
compile 'com.google.android.gms:play-services-maps:11.2.0' 
```

# wpf - 仅带箭头/符号的组合框

> ID：15024433
> 
> 赞同：1
> 
> 时间：2013-02-22T12:39:13.613
> 
> 标签：wpf, combobox, styles

我想要一个宽度非常小的组合框，并且只显示箭头。背景是为了节省布局中其他按钮旁边的空间，而不是可视化所选项目。但下拉列表的宽度不应受到限制。我没有找到任何隐藏内部文本框的属性。是否可以 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T13:06:29.160

在您的中`ContentPresenter`，您可以设置`Visibility`取决于：`ActualWidth``ComboBox`

```
<ContentPresenter Visibility={Binding RelativeSource={RelativeSource TemplatedParent}, Path=ActualWidth, Converter={StaticResource ResourceKey=WidthToVisibility}} 
```

在您的`Converter`中，您检查值是否为 8 或更小，然后返回`Visibility.Collapsed`，否则返回`Visibility.Visible`。

# facebook - 共享视频时未呈现打开的图形标签

> ID：15024434
> 
> 赞同：2
> 
> 时间：2013-02-22T12:39:16.377
> 
> 标签：facebook, facebook-opengraph, meta-tags, posting

我们正在使用 koala gem 在 Ruby on Rails 的粉丝页面上分享帖子。我们正在运行一个视频网站，我们在粉丝页面墙上使用 Open graph 标签共享视频页面。有时会呈现所有元标记，有时只会出现共享链接。我们还检查了此处的页面输出[https://developers.facebook.com/tools/debug/og/object](https://developers.facebook.com/tools/debug/og/object)并且标签正确出现。

我们的 Open graph 元标记详细信息如下

```
Meta Tag:   <meta property="fb:app_id" content="434628296582427" />
Meta Tag:   <meta property="og:title" content="&quot;Troy&quot; now playing at theater action1-movies" />
Meta Tag:   <meta property="og:description" content="Junaid Confiz is selling tickets for this video via video. The ticket is $10.99 and runtime is 00:00:05" />
Meta Tag:   <meta property="og:type" content="video.other" />
Meta Tag:   <meta property="og:video:duration" content="0:0:5/" />
Meta Tag:   <meta property="og:video:height" content="360" />
Meta Tag:   <meta property="og:video:width" content="452" />
Meta Tag:   <meta property="og:url" content="http://videos.herokuapp.com/videos/121/public_facing" />
Meta Tag:   <meta property="og:video" content="http://videos.herokuapp.com/swf_player/player_dev.swf?watch=121" />
Meta Tag:   <meta property="og:video:secure_url" content="videos.herokuapp.com/swf_player/player_dev.swf?watch=121" />
Meta Tag:   <meta property="og:image" content="https://videos.s3.amazonaws.com:443/processed_videos/89164f30-5f13-0130-2b8c-22000a960075/VPLAYER_640x480_0000.jpg?Signature=xZGqiGmILoAeixL9s7k4M73o8u4%3D&amp;Expires=1361621718&amp;AWSAccessKeyId=AKIAIUV57OFPRFFEJSTQ" />
Meta Tag:   <meta property="og:video:type" content="application/x-shockwave-flash" /> 
```

页面渲染没有问题，因为我们也检查过。有没有人观察到这种随机行为。如果您在两个粉丝页面上共享相同的视频页面 url，那么它不会在第 1 页上正确呈现并在其他页面上正确呈现，而 facebook 只向我们发送一个请求。

# excel - 如何创建具有不同格式的单元格

> ID：15024435
> 
> 赞同：0
> 
> 时间：2013-02-22T12:39:17.633
> 
> 标签：excel, excel-formula, vba

我必须创建一个类似的单元格，并且我正在寻找一种使用 excel 公式或 VBA 代码来完成它的方法。

![在此处输入图像描述](../Images/b7288e08ce4bd11183dffb934bc791ed.png)

有两种不同的形式**red**到**green**或只是**black**，但并非在所有情况下都取决于 If。

例如：

**情况 1**：如果单元格 F1 和 G1 具有值，则格式为红色到绿色

**情况 2**：如果单元格 F1 有值但 G 为空，则图像 1 中的最终格式必须为黑色

![在此处输入图像描述](../Images/887993269d8eb2d2861c26aaaad42061.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:32:48.637

这个 VBA 代码应该可以工作。它进入`worksheet_change`您的工作表事件。

我只是将它设置为 I 列以更改颜色，但如果需要，您可以扩展到 J 和 K。

```
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)

With Application
    .EnableEvents = False
    .ScreenUpdating = False
End With

If Target.Column = 6 Or Target.Column = 7 Then

    Select Case Target.Column

        Case Is = 6

            If Target <> vbNullString And Target.Offset(, 1) <> vbNullString Then

                With Target.Offset(, 2)
                    .Characters(Start:=1, Length:=5).Font.ColorIndex = 3
                    .Characters(Start:=6, Length:=3).Font.ColorIndex = 4
                End With

            Else: Target.Offset(, 2).Font.ColorIndex = 0

            End If

        Case Is = 7

            If Target <> vbNullString And Target.Offset(, -1) <> vbNullString Then

                With Target.Offset(, 1)
                    .Characters(Start:=1, Length:=5).Font.ColorIndex = 3
                    .Characters(Start:=6, Length:=3).Font.ColorIndex = 4
                End With

            Else: Target.Offset(, 1).Font.ColorIndex = 0

            End If

    End Select

End If

With Application
    .EnableEvents = True
    .ScreenUpdating = True
End With

End Sub 
```

# sql-server - 将 SQL Server 2000 数据迁移到 SQL Server 2008

> ID：15024442
> 
> 赞同：0
> 
> 时间：2013-02-22T12:39:40.787
> 
> 标签：sql-server, sql-server-2008, sql-server-2000, ssms

我想将 2 个数据库从我的旧 SQL Server 2000 迁移到我的 2008 版本的新服务器。

我使用带有导出数据任务的 Management Studio 2008 来执行此操作。它工作正常并且没有发生错误，但是在我的新服务器上的数据库中，所有主键都丢失了。

有谁知道为什么或有另一个想法如何解决我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:24:10.380

当您到达导出向导的**Select Source Tables and Views**步骤时，您需要为每个选择执行**Edit Mapping**，然后选择**Enable Identity Insert**。如果您不选中此选项，则不会导出主键值。

# php - 允许的内存大小已用尽

> ID：15024443
> 
> 赞同：3
> 
> 时间：2013-02-22T12:39:44.783
> 
> 标签：php, mysql, phpmyadmin, wamp

在 phpmyadmin 中将 zip sql 文件导入数据库时​​，我在 php.ini 中有 wamp 和更改配置仍然显示以下错误

```
Allowed memory size of 67108864 bytes exhausted (tried to allocate 69931615 bytes) in C:\wamp\apps\phpmyadmin3.5.1\libraries\zip_extension.lib.php 
```

我已将以下内容更改为 php.ini：

```
upload_max_filesize = 32M

memory_limit = 64M

post_max_size = 120M 
```

我有 imort 的 zip 文件大小为 16.1 MB

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T12:43:31.780

嗯，再改一次。
一个 16.1 MB 的 zip 可能包含一个 120MB 的 SQL 文件。PHPmyAdmin 可能需要一些自己的东西。

只需将 memory_limit 设置为 512M 或尝试导入较小大小的文件。

另一个机会是手动解压缩文件，然后将其提供给 mysql 控制台应用程序或[Sypex Dumper](http://sypex.net/en/)

# heroku - 如何在 heroku 上制作任何 DIRECTORY WRITABLE ？

> ID：15024444
> 
> 赞同：2
> 
> 时间：2013-02-22T12:39:49.840
> 
> 标签：heroku, directory, writable

如何在 heroku 上制作任何 DIRECTORY WRITABLE ？

因为我在 facebook 上制作了一个应用程序，使用 heroku 托管，但是应该有一些 DIRECTORY 应该是可写的来运行我的应用程序。

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:42:13.410

Heroku 不允许您直接写入文件系统。这是因为他们将每个应用程序部署为独立的“slug”的方式。如果你想写文件，你需要使用亚马逊的 S3 之类的东西，或者序列化数据并将其保存到数据库中。

# c++ - 使用 pthread 执行成员函数的 C++

> ID：15024450
> 
> 赞同：0
> 
> 时间：2013-02-22T12:40:00.987
> 
> 标签：c++, pthreads

我想用 c++ 中的 pthreads 编写一个小测试程序，我没有 pthreads 的经验，但到目前为止我读到的是存在问题，因为 pthreads 是 C 构造。

我的代码如下：

```
class A{
       public:
            int main();
            void* do_work();
            static void* helper_do_work(void*);
};

void * IMagFieldSvc::do_work(){
}

void* IMagFieldSvc::helper_do_work(void* context)
{
          return ((IMagFieldSvc*)context)->do_work();
}
int A::main(){
…
          pthread_create(&thread, &attr, &helper_do_work, &svc);
          pthread_join(thread, NULL);
} 
```

但编译它：

g++ -pthread test.cxx

返回

/usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../lib64/crt1.o：在函数`_start': (.text+0x20): undefined reference to`main'collect2：ld返回1退出状态

我尝试添加

```
extern "C" void* helper_do_work(void*); 
```

不管这做什么，但错误是一样的

打呼噜？

不知道我是否应该为此打开一个单独的问题：另外，在 do_work 中我想访问和更改成员变量，练习的全部目的是找出我如何访问和更改成员变量，使它们使用 __thread 成为线程局部变量。这些成员变量是具有自己的构造函数和析构函数的自定义类型，我不知道为什么会有所不同，但显然它确实......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:50:11.343

`main`不能是成员函数，它必须在全局命名空间中定义。

像这样定义它：

```
int main()
{
// ...
} 
```

# command - MCollective：在调用 puppet 时发送参数

> ID：15024452
> 
> 赞同：0
> 
> 时间：2013-02-22T12:40:02.967
> 
> 标签：command, puppet

是否可以从以下命令向 puppet 发送参数

```
mco puppetd runonce 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T06:58:48.847

您应该键入以下命令“mco rpc puppetd ​​runonce”。不建议将 mcollective-plugins 用于 puppet 3.x，因为正在开发[mcollective-puppet-agent](https://github.com/puppetlabs/mcollective-puppet-agent)新的 puppet 代理插件，您可以使用以下命令：“mco rpc puppet runonce”或“mco puppet runonce”

# c++ - C++ 中的协方差和隐藏

> ID：15024454
> 
> 赞同：-4
> 
> 时间：2013-02-22T12:40:07.887
> 
> 标签：c++, covariance

有人可以解释每行输入背后的原因吗？

```
Class A {
bool f(A* a) { return true; }
}
class B : public A {
bool f(B* b) { return false; }
}
void f() {
A* a = new A();
A* ab = new B();
B* b = new B();
a->f(a); a->f(ab); a->f(b); // true, true, true
ab->f(a); ab->f(ab); ab->f(b); // true, true, true
b->f(a); b->f(ab); b->f(b); // error, error, false
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:57:31.557

`B`有两个同名的非虚方法：`bool f(A*)`和`bool f(B*)`.

通常，这些将是重载；但由于一个是从基类继承的，所以它被后者隐藏了。它仍然可以访问，它只需要一些特殊的语法来调用它，例如：

```
B b;
B* param;
b.f(param);    // calls B::f(B*)
b.B::f(param); // same
b.A::f(param); // calls the hidden A::f(A*) 
```

* * *

所以：

> ```
> a->f(a); a->f(ab); a->f(b); 
> ```

这个很简单：`a`是 type `A*`，所以`A::f(A*)`会被调用并且 type 的参数`B*`会被转换为`A*`。

> ```
> ab->f(a); ab->f(ab); ab->f(b); 
> ```

同样的事情发生，因为`ab`也是 type `A*`。

> ```
> b->f(a); b->f(ab); 
> ```

这些不能工作，因为`b`is 类型`B*`并且`b->f`只能引用`B::f(B*)`( `A::f`is hidden)。您不能隐式转换 from`A*`到`B*`.

不过，您可以明确提及 hidden 方法：

> b->A::f(a); b->A::f(ab);

最后一个作品，只需调用`B::f(B*)`：

> ```
> b->f(b); 
> ```

[ideone 样品](http://ideone.com/mLZKzM)

* * *

评论：

在这里，函数是否是虚拟的并不重要。它们有不同的参数类型，所以不能覆盖另一个。一个只能隐藏另一个。

C++ 允许*协变*返回类型（如果 args 匹配，您可能希望有`virtual A* foo()`in`A`和`virtual B* foo()`in ）。`B`但是， C++ 不允许协变或逆变*参数*类型。

# delphi - Delphi ActiveX 控件向导

> ID：15024458
> 
> 赞同：2
> 
> 时间：2013-02-22T12:40:11.847
> 
> 标签：delphi, activex, wizard

德尔福 XE2

我第一次尝试创建 ActiveX 控件。步骤如下

1) 创建 ActiveX 库 2) 创建 ActiveX 控件向导字段组件名称不显示我的 VCL 组件。该组件在已安装的包下可见，该 .bpl 中的其他组件在“组件名称”下拉列表中可见。

为什么有些组件可见而有些不可见

TIA

以法莲

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T13:42:14.223

可以包装在 ActiveX 中的 VCL 控件必须是`TWinControl`未被标记为不兼容的后代，并且它们要么安装在 IDE 中，要么已将其单元添加到您的项目中。来自[Delphi docwiki](http://docwiki.embarcadero.com/RADStudio/XE3/en/Generating_an_ActiveX_Control_from_a_VCL_Control)（**强调我**的）：

> 在 ActiveX 控件向导中，选择将由新 ActiveX 控件包装的 VCL 控件的名称。**该对话框列出了所有可用控件，这些控件是未使用该过程****注册为与 ActiveX 不兼容的控件****的后代。`TWinControl``RegisterNonActiveX`**
> 
> **提示：**如果您在下拉列表中没有看到您想要的控件，请检查您是否已将其安装在 IDE 中或将其单元添加到您的项目中。

所以你要做的第一件事是确保你的组件来自`TWinControl`，而不仅仅是`TComponent`.

# php - 如何在 Ajax 加载的内容上使用 jQuery 效果？

> ID：15024460
> 
> 赞同：0
> 
> 时间：2013-02-22T12:40:12.630
> 
> 标签：php, jquery

您好，感谢您花一些时间来查看我的问题。我有一部分页面的内容是从另一个文件动态加载的。原因是它需要实时更新。现在我希望能够应用通常用于显示/隐藏内容（幻灯片、淡入淡出等）的 jquery 效果来动画当前数据和新数据之间的差异。这是用于获取内容并将其加载到 div 中的代码：

```
 function k() {
        $.post("../includes/ajaxAgenda.php", {
            limit : value
        }, function(data) {
            $('#tab-agenda').html(data);
        });
    };
        $(document).ready(function() {
        k();
        $('#tab-agenda').scroll(function() {
            loadMore();
        });
    });
    var refreshId = setInterval(function() {
        k();
    }, 1000); 
```

所以我想我的问题是我如何为加载的内容设置动画，使其不仅仅是从一个内容“弹出”到另一个内容？

编辑：我尝试使用 .live 而不是 .scroll 但它似乎不起作用：

```
$(document).ready(function() {
$('#tab-agenda').live("scroll",function() {
        alert("hi"); 
        loadMore();
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:41:16.853

您需要使用`live`jquery 的功能来绑定动态添加的元素。

参考：[http ://api.jquery.com/live/](http://api.jquery.com/live/)

尝试这个 ：

```
$('#tab-agenda').live("scroll",function() {
            loadMore();
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T13:41:39.940

我建议您在 content/div 上添加带有适当 css 的 ajax 加载器图像，如下所示。

```
 function loadmore(){
          $("#loader").css('display','block');
           //your   
           //code 
           //here
           $("#loader").css('display','none');  
          }

         html 
         <img id="loader" src="ajax-loader.gif" style="display:none" />
         <div id="content">
               your cont to display
          </div> 
```

# python - 使用 matplotlib / pyplot / numpy / python 绘制 Mandelbrot

> ID：15024461
> 
> 赞同：9
> 
> 时间：2013-02-22T12:40:14.373
> 
> 标签：python, numpy, matplotlib, scientific-computing

我是 python 新手，并通过遵循 Python“科学讲义 2013.1 版”教程进行学习。请帮我解决下面屏幕截图中的这个 Mandelbrot 问题（第 71 页）。如果可能，请提供带有解释的逐步命令，因为编程概念对我来说是新的。

[http://dl.dropbox.com/u/50511173/mandelbrot.png](http://dl.dropbox.com/u/50511173/mandelbrot.png)

我试图解决这个问题如下：

```
import numpy as np
import matplotlib.pyplot as plt

x,y=np.ogrid[-2:1:10j,-1.5:1.5:10j]
c=x + 1j*y
z=0
for g in range(50):
  z=z**2 + c

plt.imshow(z.T, extent=[-2,1,-1.5,1.5]) 
```

我遇到了以下错误“TypeError：图像数据无法转换为浮点数”

这个错误究竟是什么意思以及如何纠正它？我发现很难理解 imshow() 函数。imshow() 中的各个术语是什么意思？

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T13:32:04.227

Mandelbrot 集不是`z`您要绘制的值，因为它们是复数，所以会给您带来问题。Mandelbrot 集由`p`复平面的点组成，其递推关系`z_n = z_n-1**2 + p`保持有界。通过将几次迭代后的结果与某个阈值进行比较，以一种实用的方式检查这一点。在您的情况下，如果您在`for`循环后添加以下行：

```
threshold = 2
mask = np.abs(z) < threshold 
```

然后绘图`mask`，您应该在屏幕上看到设置的绘图。

要了解`imshow`'s 论点的一般工作原理，您最好阅读[文档](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow)而不是在这里询问。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-23T07:08:51.367

感谢@Jan 和@Jaime。我得到它的工作如下，虽然需要太多时间来计算：

```
import numpy as np
import scipy as sp
import matplotlib.pyplot as plt

x,y=np.ogrid[-2:1:5000j,-1.5:1.5:5000j]

print('')
print('Grid set')
print('')

c=x + 1j*y
z=0

for g in range(500):
        print('Iteration number: ',g)
        z=z**2 + c

threshold = 2
mask=np.abs(z) < threshold

print('')
print('Plotting using imshow()')
plt.imshow(mask.T,extent=[-2,1,-1.5,1.5])

print('')
print('plotting done')
print('')

plt.gray()

print('')
print('Preparing to render')
print('')

plt.show() 
```

![图像结果](../Images/77fe39661c0d1a1a48dac7b35400bde7.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-22T13:09:31.313

您收到此错误是因为`plt.imshow`不接受复数数组。您可以将数组的实部或虚部寻址`Z`为`Z.real`或`Z.imag`。因此，如果你想绘制实部

```
plt.imshow(z.real.T, extent=[-2,1,-1.5,1.5]) 
```

会做的工作。

'imshow' 中的参数定义了以下内容。

如果`z`是 N×M 矩阵，则将其解释为规则网格上的点值。通过`extent`您指定此网格在空间中的扩展方式...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-18T04:13:33.700

您正在尝试使用 imshow 绘制一个复杂的值，这就是您收到该错误的原因，可以使用其他人建议的阈值，但您可能也想考虑使用`np.angle`or `np.abs`。您还可以使用 Python 的内置`reduce`方法简化 z 的计算。

对此有一些乐趣，但这表明了总体思路：

```
import numpy as np
import matplotlib.pyplot as plt

%matplotlib inline

x, y = np.ogrid[-2:1:500j, -1.5:1.5:500j]

# Increase this to improve the shape of the fractal
iterations = 9

c = x + 1j*y

z = reduce(lambda x, y: x**2 + c, [1] * iterations, c)

plt.figure(figsize=(10, 10))
plt.imshow(np.angle(z));

plt.figure(figsize=(10, 10))
plt.imshow(np.log(np.abs(z))); 
```

# php - 记录时间和结果

> ID：15024472
> 
> 赞同：1
> 
> 时间：2013-02-22T12:40:46.013
> 
> 标签：php, post, curl

我正在使用 cURL 发布并接收回复。无论如何，我可以记录它发送到我收到响应的时间吗？这就是我的帖子和响应代码的样子。

```
$ch = curl_init($Url);
curl_setopt($ch, CURLOPT_POST,1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $dataBeingPassed);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);
$result = curl_exec($ch); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:43:32.613

```
curl_getinfo ( resource $ch [, int $opt = 0 ] ) 
```

[http://php.net/manual/en/function.curl-getinfo.php](http://php.net/manual/en/function.curl-getinfo.php)请检查一下

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:43:59.510

您可以只保存请求之前的时间并将其与请求之后的时间进行比较 -

```
$start_ts = time();

// code that takes some time goes here

echo "This code took" . (time() - $start_ts) .' seconds to execute"; 
```

使用这种方法，您只能以秒为单位测量持续时间。该`time()`函数返回一个[纪元时间戳](http://en.wikipedia.org/wiki/Epoch)（自 1970 年 1 月 1 日以来的秒数）。

对于一些更准确的测量，您可能需要查看 PHP 的[`microtime()`函数](http://php.net/manual/en/function.microtime.php)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T12:44:21.123

您可能想尝试一下[curl_getinfo](http://www.php.net/manual/ro/function.curl-getinfo.php)。

```
CURLINFO_TOTAL_TIME - Total transaction time in seconds for last transfer
CURLINFO_NAMELOOKUP_TIME - Time in seconds until name resolving was complete
CURLINFO_CONNECT_TIME - Time in seconds it took to establish the connection
CURLINFO_PRETRANSFER_TIME - Time in seconds from start until just before file transfer begins
CURLINFO_STARTTRANSFER_TIME - Time in seconds until the first byte is about to be transferred 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T12:53:17.040

您可以为此使用 curl_getinfo()。参考这个

[http://www.php.net/manual/en/function.curl-getinfo.php](http://www.php.net/manual/en/function.curl-getinfo.php)

# mysql - 避免相关子查询的麻烦

> ID：15024473
> 
> 赞同：1
> 
> 时间：2013-02-22T12:40:49.223
> 
> 标签：mysql, sql, postgresql, correlated-subquery

我试图在我的 SQL 中避免相关子查询，但我似乎无法弄清楚如何做到这一点。这是我当前的 PostgreSQL 语句：

```
INSERT INTO book_collection (publisher, p_key, collection_name, page_number) 
(SELECT publisher,
        p_key, 
        source, 
        pages 
 FROM db_publication_new AS d 
 WHERE d.type =
'book_collection' 
 AND (SELECT type 
      FROM db_publication_new 
      WHERE dblp_key = d.crossref) 
  = 'book'); 
```

所以基本上我有一个名为 的表`db_publication_new`，它包含各种类型的出版物，其中两个称为`book_collection`和`book`。每一个`publication`，无论类型如何，都有一个名为的列`crossref`，其中包含一个`p_key`. 这`p_key`本身是指`publication`同一数据库中的另一个。

我想获取`book_collection`该表中所有`crossref`类型为 的出版物`book`。我如何有效地做到这一点？

我只能写上面效率低下的语句，并且由于我表中的记录数量太长，它需要很长时间才能完成。如何使语句不包含相关子查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:47:10.317

试试这个

```
INSERT INTO book_collection (publisher, p_key, collection_name, page_number) 
VALUES
(SELECT d1.publisher,
    d1.p_key, 
    d1.source, 
    d1.pages 
FROM db_publication_new AS d1, db_publication_new AS d2 
WHERE d1.type = 'book_collection' 
AND d2.dblp_key = d1.crossref 
AND d2.type = 'book'); 
```

# jquery - 提交表单后ajaxForm更改值

> ID：15024474
> 
> 赞同：0
> 
> 时间：2013-02-22T12:40:50.790
> 
> 标签：jquery, ajaxform

我在 jquery 中有以下代码，它应该在提交表单时更新隐藏字段，并使用新值处理表单。

```
$("#" + id).ajaxForm({
    beforeSubmit: function() {
        $("#" + id + " input[type=submit]").attr('disabled', true);
        $("#" + id + " img.loader").show();

        $.get('/getProd.php?refNumber='+$("#" + id + " input[name='refNumber']").val(), function (data) {
            $("#" + id + " input[name='productID']").val(data);
        });
        alert("done pre");
    },  
    success: function(resp) {
        $("#" + id + " input[type=submit]").attr('disabled', false);
        $("#" + id + " img.loader").hide();
        resp = eval('(' + resp + ')');
        ccm_parseJSON(resp, function() {
            alert('done');
        });
    }
}); 
```

我的问题是正在使用的提交值是旧值。如何使成功使用我在行中插入的新值

```
$("#" + id + " input[name='productID']").val(data); 
```

?

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:09:24.127

我发现问题在于 ajax 正在使用异步（应该如此）。

它基本上是在功能完成后完成对服务器的查询。

所以，我在我的ajax调用之前设置

```
$.ajaxSetup({
        async: false
    }); 
```

在我的ajax调用之后

```
$.ajaxSetup({
        async: true
    }); 
```

它工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T13:09:49.743

（以下评论）

这就是我的意思：你为什么不

1.  将您的表单内容发送到服务器，并带有正确的`refNumber`,
2.  在服务器端，调用`getProd.php`（或其中编码的任何函数）以获取正确的`productID`,
3.  继续正确`productID`？

它将从客户那里节省一个额外的来回。

# java - 网络服务网址

> ID：15024475
> 
> 赞同：2
> 
> 时间：2013-02-22T12:40:55.377
> 
> 标签：java, jboss

我有一个 EAR 项目，它的名称中包含我的应用程序的版本号。在其中，我有一个用于会话 bean 的 JAR（JAR 的名称中也有一个版本号）。在那个 jar 里面，我有一个 Web 服务实现。

到现在为止还挺好。问题是 WSDL 的路径类似于：host:port/application_name_and_version-jar_name_and_version/WS_name?WSDL。这意味着每次出现新版本时，都必须调整 WS 客户端。

整个事情都部署在 JBoss 中。

问题是，如何更改 URL，使其不包含版本号？我认为它与部署描述符有关，但到目前为止我无法找到任何有用的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:55:54.593

我会制作一个仅包含 Web 服务实现的 .war 文件，然后在 .ear 文件的 .ear 文件中为 war 提供自己的上下文根`application.xml`。例如：

```
<application xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="5" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/application_5.xsd">

  <module> 
```

  <java>shared-code.jar</java>

```
 <module>
    <ejb>my-ejbs.jar</ejb>
  </module>

  <module> 
```

  <web> <web-uri>my-web-service.war</web-uri> <context-root>webserviceroot</context-root> </web> </module>  
<library-directory>lib</library -目录> </应用程序>

对格式感到抱歉，在弄乱了一点之后，我无法让 StackOverflow 从上面创建一个连续的代码块。

无论如何，如果您部署这样的 .ear 文件，那么您应该可以访问`http://host:port/webserviceroot/...`。

# javascript - 在错误的时间在类名中加载屏幕插件

> ID：15024479
> 
> 赞同：0
> 
> 时间：2013-02-22T12:41:08.100
> 
> 标签：javascript, jquery, css, addclass

这个[屏幕](http://benpickles.github.com/onScreen/)插件旨在仅在元素位于视口内时将类名添加到元素，但是它似乎在页面加载后立即添加类名，这不是要发生的事情。

```
$(function() {
  setInterval(function() {
  $("#star").filter(":onScreen").addClass('animated bounceInRight');
  }, 0)                             
}) 
```

我在这个插件中使用它，它是一个书籍效果插件，我认为它在某种程度上与屏幕冲突：http: [//pastebin.com/UmyJ6zBW](http://pastebin.com/UmyJ6zBW)这个插件需要一个页面上的不同部分才能工作。在第一部分中使用时屏幕上有效，但在实际不在视图中的其他部分中会中断。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T19:50:04.340

你可以做三件事之一。

1.  不要打扰。一般来说，您不必担心不在视图中的元素的样式。
2.  使用`setInterval()`但将间隔减小到最小可接受值但不小于约 20 毫秒。
3.  [首选] 建立一个事件处理程序，以响应任何导致您的`#star`元素在屏幕上/离开屏幕的原因而触发。

对于第三种方法：

*   jQuery 动画提供了一个`step`回调，该回调在每个动画步骤执行时触发。
*   由于滚动文档也会导致元素进出视图，因此您可能还需要一个`scroll`处理程序。

小心，您应该能够编写一个函数并将其用于两个目的。

# crystal-reports - Crystal 报告复杂的摘要

> ID：15024481
> 
> 赞同：1
> 
> 时间：2013-02-22T12:41:11.673
> 
> 标签：crystal-reports, grouping, conditional-statements, summary

我们有一个复杂的报告，其中包括不同级别的多个计算。

我想要做的是创建一个公式，上面写着“如果此级别的任何记录满足此条件，则将上一级的标题涂成红色。”

通常我会通过创建一个公式（我们称之为 ConditionFulfilled）来执行此操作，该公式表示“如果条件满足，则打印 1，否则为 0”，然后在更高的组中，“如果 {@ConditionFulfilled} >=1 然后 crred”。

但是，我无法总结 Condition 字段，因为它基于已经是摘要的内容。

如果我只使用一个公式来说明条件是否满足，然后在标题级别使用 crred，它不会将任何标题着色为红色（因为在所有情况下都没有满足条件），而 >= 语句将所有内容着色为红色（即使条件不满足。）

以前有没有人遇到过这个摘要问题？您能否建议一种解决方法，使我无需总结摘要即可达到相同的效果？

谢谢你。

# ios - 将应用程序内购买项目从一个应用程序移动到另一个应用程序？

> ID：15024482
> 
> 赞同：1
> 
> 时间：2013-02-22T12:41:13.530
> 
> 标签：ios, in-app-purchase, app-store-connect

我有一个带有应用内购买项目的旧应用。我们正在转向一个全新的应用程序，它将销售相同的物品，而旧的将不会被使用。我们可以将项目移动到 iTunes 连接中的新应用程序吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:27:04.720

你不能。IAP 流程完全由 Apple 管理。您可能可以为旧应用程序的用户设置一个生成促销代码的服务器。并使用促销代码解锁新应用程序中的功能？

或者某些可以通过电子邮件发送的文档类型，当您的应用程序打开它时，会解锁内容。

您将需要一些机制来确保这些（促销代码或文件）仅使用一次。

# sql - 我如何知道数据库触发器是 DROP_TABLE 还是 ALTER_TABLE？

> ID：15024486
> 
> 赞同：3
> 
> 时间：2013-02-22T12:41:32.610
> 
> 标签：sql, sql-server, triggers

如果我在 SQL Server 2008 中创建一个同时触发 DROP_TABLE 和 ALTER_TABLE 的数据库触发器，我如何确定这是 DROP 还是 ALTER？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T12:51:02.500

在触发器内部，您可以测试

```
SELECT EVENTDATA().value('(/EVENT_INSTANCE/EventType)[1]','sysname') 
```

这将是`DROP_TABLE`或`ALTER_TABLE`

文档[`EVENTDATA`](http://msdn.microsoft.com/en-us/library/ms173781%28v=sql.100%29.aspx)

# c# - cvCreateTrackbar 在 emguCV 中可用吗？

> ID：15024488
> 
> 赞同：1
> 
> 时间：2013-02-22T12:41:41.240
> 
> 标签：c#, opencv, wrapper, emgucv, trackbar

我正在将使用旧 OpenCV 包装器的应用程序转换为 EmguCV（更新且非常好的包装器）。

到目前为止一切顺利，除了在我的一堂课中，我使用 3 个轨迹栏来调整某些过滤器中的阈值。轨迹栏是在旧包装器中使用此代码创建的，这正是它在 openCV C++ 中创建的方式

```
cvlib.cvCreateTrackbar("minH", "Couleur", ref dValueMin, 256, new cvlib.CvTrackbarDelegate(onTrackbarSlide)); 
```

跟踪栏是使用 OpenCV 的 HighGui 创建的，并且跟踪栏在我很确定 Emgu 团队从包装器中删除它并用更好的东西替换它，但我在文档中找不到任何相关信息。有人可以建议我如何实现这一目标吗？

谢谢！

PS：我已经用谷歌搜索了这个，所有问题都没有得到解答......我希望在 Stack Overflow 上能有更多的运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-12T18:05:50.637

如果仍然相关

```
public delegate void CallbackDelegate(int pos);
[DllImport("opencv_highgui249", CallingConvention = CallingConvention.Cdecl, EntryPoint = "cvCreateTrackbar")]
public static extern int CvCreateTrackbar([MarshalAs(UnmanagedType.LPStr)] String trackbar_name, [MarshalAs(UnmanagedType.LPStr)] String window_name,
       [In,Out] ref int value, int count, [MarshalAs(UnmanagedType.FunctionPtr)] CallbackDelegate callbackPtr);

public static IntPtr capture = IntPtr.Zero;

public static void myTrackbarCallback(int pos)
    {
        CvInvoke.cvSetCaptureProperty(capture, Emgu.CV.CvEnum.CAP_PROP.CV_CAP_PROP_POS_FRAMES, pos);
    }

...
CallbackDelegate cbd = new CallbackDelegate(myTrackbarCallback);
...
CvCreateTrackbar("Position", "original", ref currentPosition, frames, cbd); 
```

# mysql - 如何使用 trid 表中的数据从一个表中选择一些行，在另一个表中选择一些行？

> ID：15024494
> 
> 赞同：0
> 
> 时间：2013-02-22T12:42:06.997
> 
> 标签：mysql, sql

我有四张桌子。

第一个和第二个有一些标准内容，而第三个和第四个表格有这样的内容

第一的

```
id
name 
```

第二

```
id
count 
```

第三

```
id
color 
```

第四

```
id
id_third
id_first 
```

我从第二个、第三个和第四个表中选择所有数据。

```
SELECT id,
       name, 
       ifnull((select count from second s where s.id  = f.id),0) as page,
FROM first f 
```

但是我如何从 color 的第三个表中选择 ALL ROWS 。Fourth.id_first={来自第一个 tbl 的一些 id}？？？

编辑。

但我想从某个表中选择而不是一个值！！！

例如，这段代码做我想做的事，但我有错误，因为我不能在一个 tbl 中选择多于一行 ..（见第二行）

```
 select SQL_CALC_FOUND_ROWS s.url,
        ifnull((select * from labels_data ld, labels l where ld.id=l.site_id and l.site_id=s.id),0) as labels,
        ifnull((select count from counter_li cl where cl.site_id = s.id order by date desc limit 1),0) as counter_li,
        ifnull((select count from counter_li cl where cl.site_id = s.id order by date desc limit 1 offset 1),0) as counter_li_before,
        last_check
    from sdata s 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:54:54.403

请参阅下面的 SQL：

```
SELECT f.id,f.name,s.count, t.id, t.color, fo.id
FROM first f, second s, third t, fourth fo
WHERE f.id = s.id
AND fo.id_third = t.id
AND fo.id_first = fo.id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:42:10.440

```
SELECT id,
name, 
ifnull((select count from second s where s.id = f.id),0) as page, fourth.id_first
FROM first LEFT JOIN fourth ON first.id = fourth.id
Where fourth.id_first IN (Select id_first form fourth) 
```

# php - 如何将 Zend_XmlRpc 模块集成到 Symfony2.1 应用程序中？

> ID：15024495
> 
> 赞同：0
> 
> 时间：2013-02-22T12:42:08.880
> 
> 标签：php, symfony, dependencies, zend-framework2, xml-rpc

我需要将`Zend_XmlRpc`模块安装到我的 Symfony 2.1 应用程序中。

我尝试了使用`composer.json`依赖项的明显方法：

```
"require": {
    ...
    "zendframework/zend-xmlrpc": "dev-master"
}, 
```

我遇到了以下问题：

```
- Installation request for zendframework/zend-xmlrpc dev-master -> satisfiable by zendframework/zend-xmlrpc dev-master.
- zendframework/zend-xmlrpc dev-master requires zendframework/zend-http dev-master -> no matching package found. 
```

[我已经从https://packagist.org/packages/zendframework/zend-xmlrpc](https://packagist.org/packages/zendframework/zend-xmlrpc)添加了包要求

```
 "zendframework/zend-http": "dev-master",
    "zendframework/zend-math": "dev-master",
    "zendframework/zend-server": "dev-master",
    "zendframework/zend-stdlib": "dev-master",
    "zendframework/zend-xmlrpc": "dev-master" 
```

但是现在我遇到了更多问题，因为每个包都有自己的要求。

我的问题是我已经浏览了所有这些要求，最后我以安装“整体”框架结束。

我得到了这个`http`包，那个`loader`包， `event manager`我很确定 symfony 已经得到了它们。

难道没有办法只集成 XMLRPC 包，并可能将功能与 Symfony 组件中已经存在的功能联系起来吗？

如果没有任何解决方案，我如何强制作曲家递归地自动安装所有必需的依赖项，因为它们中有很多，手动添加它们是奇怪的工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:50:55.653

我看不出有任何理由使用该软件包的不稳定版本。

而是添加

```
"require": {
    ...
    "zendframework/zend-xmlrpc": "2.1.*"
}, 
```

# jquery - href="#anchor" 链接不适用于外部可点击的 jQuery div

> ID：15024497
> 
> 赞同：0
> 
> 时间：2013-02-22T12:42:13.783
> 
> 标签：jquery, events, html, hyperlink, click

我确实有大麻烦。我无法得到。我有

```
<div id="clickable">
  <a href="http://domain.de/link.html">link1</a>
  <a href="http://domain.de/link2.html">link2</a>
  <a href="http://domain.de/me.html#options">anchor link</a>
</div>

jQuery('#clickable').click(function () {
  window.location.href='http://domain.de/link.html';
}); 
```

link1 和 link2 工作正常，但锚链接调用 div 点击事件

我已经尝试了所有关于在stackoverflow上冒泡DOM的答案都没有`event.stopPropagation(); return false;` `event.preventDefault();`工作

only with `event.stopPropagation();`i 确实与没有任何东西具有相同的效果，如上所示

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:49:04.203

您需要防止点击事件冒泡到您的`<a>`项目的父母。例如：

```
<div id="clickable">
  <a href="http://domain.de/link.html">link1</a>
  <a href="http://domain.de/link2.html">link2</a>
  <a href="http://domain.de/me.html#options">anchor link</a>
</div>

jQuery('#clickable a').click(function(event){
    event.stopPropagation();
});

jQuery('#clickable').click(function () {
  window.location.href='http://domain.de/link.html';
}); 
```

# sql - 将表结果合并到列中

> ID：15024498
> 
> 赞同：1
> 
> 时间：2013-02-22T12:42:15.837
> 
> 标签：sql, tsql, pivot

我正在尝试将来自不同（或与此示例相同）表的结果组合到单独的列中（作为例如 cat(egory) 的函数）。如以下示例所示。

给定以下（T-）SQL

```
create table tab(id int, val float, cat varchar(1))
insert into tab(id, val, cat)
    select 1, 2.1, 'A' union all 
    select 2, 4.3, 'A' union all 
    select 3, 2.1, 'A' union all 
    select 2, 8.9, 'B' union all 
    select 3, 1.4, 'B' union all 
    select 4, 3.3, 'B'

select id
    , (select val from tab tab_a where cat = 'A' AND tab_a.id = tab.id)
    , (select val from tab tab_b where cat = 'B' AND tab_b.id = tab.id)
from tab
group by id
order by id

id  val(A)   val(B) 
1   2.1      null
2   4.3      8.9
3   2.1      1.4
4   null     3.3 
```

这正是我想要的，但是如果 cat 是可变的（比如说基于用户输入），那么这条路线就会失败。那么我可以/必须（？）切换到动态 SQL。这就是我试图避免的。有什么建议可以在没有动态 SQL 的情况下解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:57:19.600

AFAIK，不，你不能没有动态 SQL。[**`PIVOT`**](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)但是，如果您使用table 运算符，它会更简单，如下所示：

```
SELECT *
FROM tab t
PIVOT
(
  MAX(val)
  FOR cat IN(A, B)
) AS p 
```

## [SQL 小提琴演示](http://sqlfiddle.com/#!3/77502/1)

要动态地做到这一点，它将是这样的：

```
DECLARE @cols AS NVARCHAR(MAX);
DECLARE @query AS NVARCHAR(MAX);

select @cols = STUFF((SELECT distinct ',' +
                        QUOTENAME(cat)
                      FROM tab                      
                      FOR XML PATH(''), TYPE
                     ).value('.', 'NVARCHAR(MAX)') 
                        , 1, 1, '');

SELECT @query = 
  'SELECT *
   FROM tab AS t
   PIVOT
   (
      MAX(val)
      FOR cat IN ( ' + @cols + ' )
    ) AS p;';

EXECUTE( @query); 
```

这会给你：

```
| ID |      A |      B |
------------------------
|  1 |    2.1 | (null) |
|  2 |    4.3 |    8.9 |
|  3 |    2.1 |    1.4 |
|  4 | (null) |    3.3 | 
```

## [更新的 SQL Fiddle 演示](http://sqlfiddle.com/#!3/77502/3)

# c# - DataGridComboBoxColumn 没有显示任何内容

> ID：15024499
> 
> 赞同：0
> 
> 时间：2013-02-22T12:42:16.010
> 
> 标签：c#, wpf, mvvm, datagridview, wpfdatagrid

我的应用程序中有一个 DataGrid，它包含两列。一个是名称，另一个是 ComboBox。现在我面临的问题是在 DataGrid 中只显示名称但 ComboBox 没有出现。

这是我的看法。

```
<DataGrid ItemsSource="{Binding MyItems}" SelectedItem="{Binding SelectedItem}">
    <DataGrid.Columns>
        <DataGridTextColumn Binding="{Binding Name}" Header="Name"/>
        <DataGridComboBoxColumn ItemsSource="{Binding Actions}" SelectedItemBinding="{Binding SelectedAction}" Header="Actions" />
    </DataGrid.Columns>
</DataGrid> 
```

在我的视图模型中。

```
public string Name
{
    get { return _name; }
}

public IEnumerable<string> Actions
{
    get
    {
        var list = new List<string>();
        list.Add("Action 1");
        list.Add("Action 2");
        return list;
    }
} 
```

现在，当我在 GridView 中添加任何条目时，我可以看到名称，但 ComboxBox 列显示为文本块。没有下拉菜单。问题是什么。

# gwt - 如何在 gwt 客户端准备空值 xml 标记

> ID：15024500
> 
> 赞同：0
> 
> 时间：2013-02-22T12:42:22.747
> 
> 标签：gwt

在 GWT 客户端，当我读取空标签时，它会抛出空指针异常。如果我在该特定解析标记上使用`if`条件，它也会导致空指针异常。所以请给我解决方案。

我的编码是：

```
if (list.getElementsByTagName("insertId").item(0).getFirstChild().getNodeValue() != null &&
    !list.getElementsByTagName("insertId").item(0).getFirstChild().getNodeValue().equalsIgnoreCase(""))
{
    shipDetails.nmFormNo.setValue(Double.valueOf(
        list.getElementsByTagName("insertId").item(0).getFirstChild().getNodeValue()));
} 
```

我的特殊标签是：

```
 <insertId></insertId> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:58:05.797

所以它甚至在检查你的之前就抛出空指针 `null condition`

可能性是

```
1)list.getElementsByTagName("insertId").item(0) throwing null
2)list.getElementsByTagName("insertId").item(0).getFirstChild () throwing null 
```

# c++ - C ++公共非虚拟基类方法无法从子类访问

> ID：15024504
> 
> 赞同：2
> 
> 时间：2013-02-22T12:42:36.947
> 
> 标签：c++, inheritance

鉴于下面片段 1 和 2 中的两个类定义，您能否告诉我为什么会出现第三个片段中显示的编译错误以及如何修复它们？看起来子类无法访问基类中的非虚拟公共方法（请参阅第二个代码片段中标记为第 197 行的子类中的 getVipAddress 方法）。我是 C++ 领域的新手，所以如果您碰巧看到代码块中需要任何其他改进，我将不胜感激。

**SNIPPET 1（基类和子类）**

**//基类**

```
class BaseEntity
{
 public:
BaseEntity(): mUUID(""), mName("") {}
BaseEntity(std::string &uuid, std::string &name): mUUID(uuid), mName(name) { }

BaseEntity (const BaseEntity &copyin)
{
    this->mUUID = copyin.mUUID.c_str();
    this->mName = copyin.mName.c_str();
}

BaseEntity operator = (const BaseEntity &rhs)
{
    this->mUUID = rhs.mUUID.c_str();
    this->mName = rhs.mName.c_str();

    return *this;
}

~BaseEntity() { };

void setUUID(std::string uuid) { mUUID = uuid; }
void setName(std::string name) { mName = name; }

              /*LINE 89 is the following*/
const std::string &getUUID() const { return mUUID; }
const std::string &getName() const { return mName; }

  private:
std::string mUUID;
std::string mName;

}; 
```

**//子类**

```
class VipAddressSet : BaseEntity
{
  public:
    VipAddressSet() : BaseEntity() { }
    VipAddressSet(std::string &uuid, std::string &name) : BaseEntity(uuid, name) { }

    VipAddressSet(const VipAddressSet &copyin)
    {
            setUUID(copyin.getUUID());
            setName(copyin.getName());

                std::vector<VipAddressEntity>::const_iterator iter;
            for( iter = copyin.mVipAddressList.begin(); iter !=  copyin.mVipAddressList.end(); iter++ )
            {

                addVipAddress(*iter);
            }
     }

     VipAddressSet operator = (const VipAddressSet &rhs)
     {
          setUUID(rhs.getUUID());
          setName(rhs.getName());

              std::vector<VipAddressEntity>::const_iterator iter;
          for( iter = rhs.mVipAddressList.begin(); iter != rhs.mVipAddressList.end(); iter++ )
              {
            addVipAddress(*iter);
          }

          return *this;
         }

     int getVipAddress(std::string &uuid, VipAddressEntity **ptr )
     {
        std::vector<VipAddressEntity>::const_iterator iter;
        for( iter = mVipAddressList.begin(); iter != mVipAddressList.end();  iter++ )
        {
   **/*~~~~ LINE 197 is the following ~~~~*/**
            if(iter->getUUID() == uuid)
            {
                **ptr = *iter;
                return 1;
            }
        }

        return 0;
     }

     const std::vector<VipAddressEntity>& getVipAddressList() const { return mVipAddressList; }

    private:
      std::vector<VipAddressEntity> mVipAddressList;

      void addVipAddress(const VipAddressEntity &entity)
      {
       mVipAddressList.push_back(entity);
      }

     }; 
```

**编译输出**

```
 $ g++ -g -c -std=c++11 -Wall Entity.hpp
  Entity.hpp: In member function ‘int  ECLBCP::VipAddressSet::getVipAddress(std::string&, ECLBCP::VipAddressEntity**)’:
  Entity.hpp:89:21: error: ‘const string& ECLBCP::BaseEntity::getUUID() const’ is inaccessible
  Entity.hpp:197:24: error: within this context
  Entity.hpp:197:24: error: ‘ECLBCP::BaseEntity’ is not an accessible base of ‘const   ECLBCP::VipAddressEntity’ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T12:45:00.593

类的默认继承是私有的。将您的声明更改为

```
class VipAddressSet : public BaseEntity 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T12:45:36.633

那是因为你必须用 public 修饰符继承它

```
class VipAddressSet : public BaseEntity 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T12:45:53.137

我猜你正在继承`private`. 尝试

```
 class VipAddressSet : public BaseEntity 
```

否则该方法将不可见。

# android - OSM 地图视图中不显示开放街道地图

> ID：15024505
> 
> 赞同：2
> 
> 时间：2013-02-22T12:42:37.607
> 
> 标签：android

我尝试创建开放街道地图的应用程序。但地图不显示，只有网格显示。我在我的应用程序中使用了这些代码。

公共类 MainActivity 扩展 Activity{

```
private MapView mapView;
private MapController mapController;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    mapView = (MapView) this.findViewById(R.id.mapview);
    mapView.setTileSource(TileSourceFactory.MAPNIK);
    mapView.setBuiltInZoomControls(true);
    mapView.setMultiTouchControls(true);
    mapController = this.mapView.getController();
    mapController.setZoom(2);

    GeoPoint gPt = new GeoPoint(51500000, -150000);
    //Centre map near to Hyde Park Corner, London
    mapController.setCenter(gPt);
} 
```

}

提前谢谢。请..任何人告诉我我的代码有什么问题..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:27:22.273

你有你的 osmdroid 库到“libs”文件夹吗？我的是 osmdroid-android-3.0.8.jar

我认为仅显示地图没有任何问题...：S

# ruby - 是否可以在 proc 中看到 ruby 代码？

> ID：15024513
> 
> 赞同：14
> 
> 时间：2013-02-22T12:42:58.863
> 
> 标签：ruby, block, proc

```
p = Proc.new{ puts 'ok' } 
```

是否可以在 proc 中看到 ruby​​ 代码？

`inspect`返回内存位置：

```
puts p.inspect
#<Proc:0x007f9e42980b88@(irb):2> 
```

红宝石 1.9.3

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T12:53:47.647

看一下[sourcify](https://github.com/ngty/sourcify) gem：

```
proc { x + y }.to_source
# >> "proc { (x + y) }" 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-22T13:07:00.517

你的意思是原始源代码还是它的字节码表示？

对于前者，您可以使用标准 Proc 方法`source_location`

```
p.source_location
=> ["test.rb", 21] 
```

并阅读相应的代码行。

对于后者，RubyVM::InstructionSequence 及其类方法反汇编可能会派上用场：

```
irb> RubyVM::InstructionSequence.disasm p
=> "== disasm: <RubyVM::InstructionSequence:block in irb_binding@(irb)>
=====\n== catch table\n| catch type: redo   st: 0000 ed: 0011 sp: 0000
cont: 0000\n| catch type: next   st: 0000 ed: 0011 sp: 0000 cont:
0011\n|------------------------------------------------------------------------\n
0000 trace            1                                               
(   1)\n0002 putself          \n0003 putstring        \"ok\"\n0005 
send             :puts, 1, nil, 8, <ic:0>\n0011 leave            \n" 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-22T13:29:48.873

不，在 Ruby 中没有办法做到这一点。

一些 Ruby 实现可能有也可能没有特定于实现的方法来获取源代码。

您也可以尝试使用`Proc#source_location`查找`Proc`定义 的文件，然后解析该文件以查找源代码。但是，如果`Proc`没有在文件中定义（例如，如果它是用 动态定义的`eval`）或者源文件不再存在，例如因为您正在运行程序的 AOT 编译版本，这将不起作用。

所以，简短的回答是：不，没有办法。长答案是：有些方法有时可能会或可能不会起作用，这取决于太多的因素，甚至无法开始使这项工作可靠。

这甚至没有考虑`Proc`s 甚至*没有*Ruby 源代码，因为它们是在本机代码中定义的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-04-11T17:29:46.773

如果proc被定义到一个文件中，U可以获取proc的文件位置然后序列化它，然后在反序列化后使用该位置再次回到proc

> proc_location_array = proc.source_location

反序列化后：

> 文件名 = proc_location_array[0]
> 
> line_number = proc_location_array[1]
> 
> proc_line_code = IO.readlines(file_name)[line_number - 1]
> 
> proc_hash_string = proc_line_code[proc_line_code.index("{")..proc_line_code.length]
> 
> proc = eval("lambda #{proc_hash_string}")

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-10-26T22:55:58.557

虽然是一个老问题，但我还是想分享我的想法。

您可以使用 Pry gem 并最终得到如下结果：

```
[11] pry> p = Proc.new{ puts 'ok' }
=> #<Proc:0x007febe00e6360@(pry):23>

[12] pry> show-source p

From: (pry)
Number of lines: 1

p = Proc.new{ puts 'ok' } 
```

此外，如果您要在 Rails 上下文中使用它，您可以输入：

```
::Kernel.binding.pry 
```

在您的控制器或模型中，以及

```
- require 'pry'; binding.pry 
```

在您的视图中，您要开始调试。

在测试中，我使用组合，首先`require 'pry'`在顶部，然后`::Kernel.binding.pry`在需要的地方。

参考：

*   [http://pryrepl.org](http://pryrepl.org)
*   [https://github.com/pry/pry](https://github.com/pry/pry)
*   [https://github.com/pry/pry/wiki/Source-browsing](https://github.com/pry/pry/wiki/Source-browsing)

# sql-server - 在 SQL Server 中复制数据的存储过程

> ID：15024517
> 
> 赞同：0
> 
> 时间：2013-02-22T12:43:14.177
> 
> 标签：sql-server, stored-procedures, wm-copydata

我想使用存储过程将数据从一个表移动到另一个具有相同数据库的表。

每次执行存储过程时，只会将更新的列从一个表复制到 SQL Server 中的另一个表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-10-30T18:47:43.477

您可以使用审计列来实现这一点。

在源表上，您需要添加 ModifiedOn 日期时间列。每当更新源表上的列时，您还需要将 ModifiedOn 列更新为 getdate() 以指定该行已被修改并且列值已被更新。

当您将数据从源表复制到目标表时，如果您跟踪加载到目标表的最后一个 ModifiedOn 值，则可以使用该值在源表上查找具有较大 ModifiedOn 值的行，然后仅加载已更改的行。

# javascript - jQuery mobile：弹出和 vclick 事件

> ID：15024519
> 
> 赞同：1
> 
> 时间：2013-02-22T12:43:22.327
> 
> 标签：javascript, jquery, jquery-mobile

我正在为一个项目使用 jQuery mobile，并且需要在打开弹出窗口时对 vclick 事件做出反应。我的问题是 vclick 事件只是在弹出窗口内触发，而不是在整个页面上触发。你可以在这里找到一个最小的例子。在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:49:05.203

您的代码工作正常，我不知道这是否是您的意图，但您正在使用[弹出覆盖面板](http://jquerymobile.com/demos/1.2.0/docs/pages/popup/popup-panels.html)。与 jQuery Mobile 1.3 版本中的普通面板不同，弹出式覆盖面板有一个隐藏的 div 女巫，可以拉伸屏幕的全宽和全高。

看起来像点击邮件页面只是点击隐藏的覆盖 div。

您甚至可以对此进行测试，使用 Firefox 或 Chrome 并查看弹出的 HTML，您会发现该 DIV。

在您的情况下，此 DIv 是一个问题：

```
<div id="panelPopup-screen" class="ui-popup-screen in" style="height: 611px;"></div> 
```

你可以随时切换到 jQuery Mobile 1.3 RC1，使用它的面板，只是让它半透明。

**编辑 ：**

为您找到了解决方案，这是一个实时工作的 jsFiddle 示例：http: [//jsfiddle.net/SC8hH/](http://jsfiddle.net/SC8hH/)

这将解决您的问题：

```
#panelPopup-screen {
    display: none;
} 
```

# wordpress - Wordpress add_action 调用函数超过 1 次

> ID：15024526
> 
> 赞同：0
> 
> 时间：2013-02-22T12:43:34.883
> 
> 标签：wordpress

我有计算 Wordrpess 页面浏览量的功能，但是当我重新加载页面`add_action()`调用功能 5 次时，我不知道为什么。

```
<?php
add_action('wp', 'wp125_adview');
function wp125_adview(){
    global $wpdb;

    $adtable_name = $wpdb->prefix . "wp125_ads";
    $url = $_SERVER['REQUEST_URI'];

    if(isset($_POST['unique_hidden_field'])) {
        $update = "UPDATE ". $adtable_name ." SET views = views+1 WHERE status!=0";
        $results = $wpdb->query( $update );
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:08:39.587

您已将函数调用挂接到“wp”操作挂钩中。
最好使用每页只运行一次的东西，例如

```
add_action('wp_footer', 'wp125_adview'); 
```

# api - 设置笔记本电脑电池最大充电量

> ID：15024529
> 
> 赞同：3
> 
> 时间：2013-02-22T12:43:39.977
> 
> 标签：api, wmi, battery

我喜欢制作一个用于笔记本电脑的程序，以保持电池的最大充电阈值。众所周知，防止笔记本电脑电池达到最高或最低水平会增加电池的使用寿命。是否有一些 API 可以协作并首先获取电池百分比级别，然后如果此级别 >= 从设定的级别关闭与电池的连接并仅使用交流电？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-12T13:18:18.723

据我所知，没有一个 API 可以用于所有笔记本电脑。例如，联想 ThinkPad 笔记本电脑就有这样的实用程序/未记录的 API。

您需要做的是从多个供应商那里收集足够多的那些未记录/不受支持的 API，并将它们打包到您的应用程序中。

这是 ThinkPad 特定的一个[TP_SMAPI](http://www.thinkwiki.org/wiki/Tp_smapi)。它也是开源的：[github.com/evgeni/tp_smapi](https://github.com/evgeni/tp_smapi)，因此如果您查看源代码，您可以了解如何与电池上的固件进行通信。这是安装时如何从终端使用它的示例：

```
$ echo 40 | sudo tee /sys/devices/platform/smapi/BAT0/start_charge_thresh
$ echo 80 | sudo tee /sys/devices/platform/smapi/BAT0/stop_charge_thresh 
```

对于 Windows，已经有专门的应用程序，通常由您的笔记本电脑供应商提供。

# php - 字段中的子查询以及 CakePHP 2.3 中的位置

> ID：15024531
> 
> 赞同：0
> 
> 时间：2013-02-22T12:43:42.367
> 
> 标签：php, cakephp

我怎样才能在 CakePHP 中添加它？我尝试了我所知道的一切，但不起作用：

```
 select
            card_type
            ,sum (case when used = 'Y' then (select amount from auth a1 where a1.origid = a.pnref and trxtype = 'D') else amount end) as total
        from    auth a
        where
            add_date between '$this->date1' and '$this->date2'
            and     (trxtype = 'S' or trxtype = 'F')
            and     user_num = $this->user_num
            and     pnref not in (select    origid
                                    from        auth a
                                    where       add_date between '$this->date1' and '$this->date2'
                                    and trxtype = 'V')
        group by card_type
        order by 1 
```

*   字段中的子查询
*   子查询在哪里

* * *

**[我试试这个]**：

```
 $conditionsSubQuery['"Auth2"."add_date BETWEEN ? AND ?"'] = array($inicial_date, $final_date);
    $conditionsSubQuery['"Auth2"."trxtype"'] = 'V';

    $db = $this->User->getDataSource();
    $subQuery = $db->buildStatement(
        array(
            'fields'     => array('"Auth2"."origid"'),
            'table'      => 'auth',
            'alias'      => 'Auth2',
            'limit'      => null,
            'offset'     => null,
            'joins'      => array(),
            'conditions' => $conditionsSubQuery,
            'order'      => null,
            'group'      => null
            ),
        $this->Auth
    );

    $subQuery = ' "Auth"."pnref" NOT IN (' . $subQuery . ') ';
    $subQueryExpression = $db->expression($subQuery);

    $conditions[] = $subQueryExpression;
    $conditions[] = array(
        'Auth.date BETWEEN ? and ?' => array($inicial_date, $final_date),
        'OR' => array(
            'Auth.trxtype' => 'S',
            'Auth.trxtype' => 'F'
        ),
        'Auth.user_num' => $user_num
    );

    $fields = array(
        'Auth.card_type',
        "sum (case when Auth.used = 'Y' then (select Auth2.amount from auth Auth2 where Auth2.origid = Auth.pnref and Auth.trxtype = 'D') else Auth.amount end) as Auth.total"
    );

    $group = array('Auth.card_type');
    $order = array(1);

    return $this->Auth->find('all', compact('fields', 'conditions', 'group', 'order')); 
```

* * *

**[错误]**

```
Database Error
Error: SQLSTATE[42601]: Syntax error: 7 ERRO: erro de sintaxe em ou próximo a "." LINE 1: ... Auth.trxtype = 'D') else Auth.amount end) as Auth.total, "U... ^

SQL Query: SELECT "Auth"."card_type" AS "Auth__card_type", sum (case when Auth.used = 'Y' then (select Auth2.amount from auth Auth2 where Auth2.origid = Auth.pnref and Auth.trxtype = 'D') else Auth.amount end) as Auth.total, "User"."user_num" AS "User__user_num" FROM "public"."system_users" AS "User" WHERE "Auth"."pnref" NOT IN (SELECT "Auth2"."origid" FROM auth AS "Auth2" WHERE "Auth2"."add_date BETWEEN '2013/02/19 06:00:00' AND '2013/02/22 10:34:17'" AND "Auth2"."trxtype" = 'V' ) AND (("Auth"."date" BETWEEN '2013/02/19 06:00:00' and '2013/02/22 10:34:17') AND ("Auth"."trxtype" = 'F') AND ("Auth"."user_num" = 68)) GROUP BY "Auth"."card_type" ORDER BY "1" ASC

Notice: If you want to customize this error message, create app\View\Errors\pdo_error.ctp 
```

* * *

总之感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T17:50:16.093

就像**@Chris Traveres**评论一样，只是一个语法错误。

> 查询中的问题很明显，标识符关联不正确。错误消息查询的相关子句是“Auth2”。“add_date BETWEEN '2013/02/19 06:00:00' AND '2013/02/22 10:34:17'”我怀疑你有一个布尔列命名为“add_date BETWEEN '2013/02/19 06:00:00' AND '2013/02/22 10:34:17'”所以问题应该仅限于 CakePHP 语法

问题解决了！多谢你们。

# python - 如何仅获取模板中的第一个对象？

> ID：15024538
> 
> 赞同：0
> 
> 时间：2013-02-22T12:44:01.763
> 
> 标签：python, django

意见：

```
....
d = Data.objects.filter(is_accepted=True)
.... 
```

模板：

```
{% for item in d %}
    {% for picture in item.photo_set.all %}
        <img class="image" src="{{ picture.photo.url}}">
    {% endfor %}
{% endfor %} 
```

如何只获得**第一**张照片？( `{{ picture.photo.url}}`)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:47:44.893

您可以使用点符号进行索引：

```
{{ item.photo_set.all.0.photo.url }} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T12:47:53.033

首先，一把锋利的刀。

二、[一片](https://docs.djangoproject.com/en/1.0/ref/templates/builtins/#slice)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T12:46:41.370

你需要使用`forloop.first`. 看看[文档](https://docs.djangoproject.com/en/1.4/ref/templates/builtins/#for)。

```
{% for item in d %}
    {% for picture in item.photo_set.all %}
        {% if forloop.first %}
            <img class="image" src="{{ picture.photo.url}}">
        {% endif %}
    {% endfor %}
{% endfor %} 
```

# azure - azure servicebus如何做增量生产部署

> ID：15024541
> 
> 赞同：0
> 
> 时间：2013-02-22T12:44:03.200
> 
> 标签：azure, servicebus

我想知道在 Azure 中使用 servicebus 进行增量生产部署的最佳实践是什么，

*   部署新版本时如何确保消息不被删除
*   是否有备份机制来保存消息并在部署完成后将其加载回来？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:18:06.230

Windows Azure 服务总线是在您的部署之外运行的服务，类似于 Windows Azure SQL 数据库或 Windows Azure 存储。这意味着它不依赖于您的部署：您可以部署、删除、重新部署您的应用程序，而不会影响服务总线中存在的消息。

当您部署新版本的应用程序时，您唯一需要注意的是服务总线队列/订阅中可用的消息可能已由旧版本的应用程序发送。因此请考虑到您的应用程序的新版本需要与这些“旧”消息格式兼容。

# javascript - 如果存在 NoScript，如何检查 NoScript（浏览器插件）并在屏幕顶 部包含栏？

> ID：15024542
> 
> 赞同：1
> 
> 时间：2013-02-22T12:44:03.603
> 
> 标签：javascript, browser, noscript

[NoScript](http://noscript.net)浏览器插件越来越受欢迎。对于我们这些运行严重依赖 javascript 的网页的人，我们如何检查此插件的存在并在屏幕顶​​部通过某种“始终存在”下拉栏提醒用户？

实际上，我只是尝试在 StackOverflow.com 上使用[NoScript](http://noscript.net)，发现它们完全符合我的想法！这只是对 javascript 的简单浏览器检查吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:47:50.863

打开 Stack Overflow 页面的源代码并环顾四周。

`<noscript>`当没有可用的 JavaScript 时，您会看到他们正在使用-tags 添加其他内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T12:51:26.467

一个简单的手动实现是这样的：

HTML：

```
<div id="requireJS">This site requires JS!</div> 
```

脚本：

```
var warning = document.getElementById('requireJS');
warning.parentNode.removeChild(warning); 
```

这将在禁用 JS 时显示警告，并在启用 JS 时将其删除。

注意：我并不是说它比 更好`<noscript>`，只是它*也*可以这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T13:10:47.943

如果有人像我一样再次搜索 NoScript 插件，请使用来自 agam360 的 Answer。

[如何检测 JavaScript 是否被禁用？](https://stackoverflow.com/questions/121203/how-to-detect-if-javascript-is-disabled)

最具体地说，Hairbo 的答案似乎是最好的解决方案，因为我认为它适用于没有优雅降级的已开发网站：[https ://stackoverflow.com/a/3926750/646456](https://stackoverflow.com/a/3926750/646456)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-28T05:09:59.833

实际上，我喜欢这种风格方法，因此您可以轻松隐藏/取消隐藏任何内容。

**在默认样式表上：**

```
.nojs { display:none;} 
```

* * *

**在布局 html 上：**

```
<noscript>
    <style> 
        .nojs { display:block }
        .container {display:none}
    </style>
</noscript>

<div class="container">
    this will show with js
</div>
<div class="nojs">
    this will show without js
</div> 
```

# android - 结合 Google 的 Drive API 和 Spreadsheets API 会导致“无法执行 dex：多个 dex 文件定义...”错误

> ID：15024550
> 
> 赞同：1
> 
> 时间：2013-02-22T12:44:29.237
> 
> 标签：android

为了将我的应用程序与 GDrive 集成，我遵循了[https://developers.google.com/drive/quickstart-android上的教程](https://developers.google.com/drive/quickstart-android)

在本教程的第 3 步中，本教程建议安装[Google Eclipse 插件](https://developers.google.com/eclipse/)来处理库设置（此插件让您选择要使用的 Google API 并为您创建包含 jar 的 /libs 文件夹）。本教程展示了如何拍照并将其上传到 Google Drive。

完成本教程后，我决定扩展示例：由于我的应用程序使用 Google 电子表格，我将电子表格 API（使用 Google Eclipse 插件）添加到示例中。

应用程序编译但在运行时我确实收到以下错误：

```
Conversion to Dalvik format failed: Unable to execute dex: Multiple dex files define Ljavax/annotation/CheckForNull; 
```

我的感觉是有些库是冲突的，但是这些库都是用谷歌Eclipse插件计算出来的？这怎么可能，我应该如何解决这个问题？

我的（生成的）libs 文件夹如下所示（包含 Google Drive API v2 和电子表格 API）：

```
gdata-client-1.0.jar
gdata-spreadsheet-3.0.jar
gdata-spreadsheet-meta-3.0.jar
google-api-client-1.12.0-beta.jar
google-api-client-android-1.12.0-beta.jar
google-api-services-drive-v2-rev55-1.12.0-beta.jar
google-collect-1.0-rc1.jar
google-http-client-1.12.0-beta.jar
google-http-client-android-1.12.0-beta.jar
google-http-client-gson-1.12.0-beta.jar
google-http-client-jackson-1.12.0-beta.jar
google-http-client-jackson2-1.12.0-beta.jar
google-oauth-client-1.12.0-beta.jar
gson-2.1.jar
guava-jdk5-13.0.jar
jackson-core-2.0.5.jar
jackson-core-asl-1.9.9.jar
jsr305-1.3.9.jar
jsr305.jar 
```

感谢您的帮助，彼得

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-11T13:44:09.683

我有同样的问题。从 libs 文件夹中删除 jsr305.jar 为我解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-15T10:07:42.263

删除 bin 和 gen 文件夹并构建项目

或者

检查添加到项目中的多个私有库

或者

检查是否将多个播放服务添加到您的项目中

# ios - 适用于 iOS 6 的 Facebook SDK 3.2：无法登录 -> 未调用 openURL/AppId 和 URL 正确

> ID：15024551
> 
> 赞同：0
> 
> 时间：2013-02-22T12:44:31.390
> 
> 标签：ios, login, sdk, facebook-ios-sdk, openurl

嗨

我对适用于 iOS 6 的新 Facebook SDK 3.2 有一个大问题（我使用 iPhone 模拟器进行测试）。我已经完全按照操作指南中的描述实现了 Facebook 登录。唯一的区别是我没有在应用程序委托中实现它。我在一个单独的 mm 文件中实现了 Facebook-Stuff（但我也测试了应用程序委托中的代码 -> 同样的问题！）。

这就是发生的情况：如果我尝试登录，屏幕中间会弹出一个 UIView（可能是 UIWebView），我可以输入我的 Account-Credentials。接下来是权限确认屏幕。我单击确定按钮，然后出现错误：“操作无法完成。（com.facebook.sdk 错误 2。）”UserInfo=0x14bbd590 {com.facebook.sdk:ErrorLoginFailedReason=com.facebook.sdk:错误登录未取消}

我已经体验过旧的 facebook-sdk v2。那里没有问题可以整合！但是对于新的和 iOS 6，我无法让它运行:-(

我认为一个基本问题可能是 UIApplicationDelegate 的 openURL 方法没有被调用！我已将 AppID 插入 info.plist 并添加了 URL 类型。它看起来像这个片段：

```
<key>CFBundleURLTypes</key>
<array>
<dict>
  <key>CFBundleURLSchemes</key>
    <array>
      <string>fb111111111111111</string>
    </array>
</dict>
</array>
<key>FacebookAppID</key>
<string>111111111111111</string> 
```

我还用wireshark分析了url：

[https://www.facebook.com/login.php?app_id=111111111111111&sdk=ios&skip_api_login=1&cancel=fb111111111111111%3A%2F%2Fauthorize%2F%3Ferror_reason%3Duser_denied%26error%3Daccess_denied%26error_description%3DThe%2Buser%2Bdenied%2你的% 2brequest。 3Dios%26display%3Dtouch%26type%3Duser_agent%26fbconnect%3D1%26sso%3Diphone-safari%26from_login%3D1&rcount=1&_rdr](https://www.facebook.com/login.php?app_id=111111111111111&sdk=ios&skip_api_login=1&cancel=fb111111111111111%3A%2F%2Fauthorize%2F%3Ferror_reason%3Duser_denied%26error%3Daccess_denied%26error_description%3DThe%2Buser%2Bdenied%2Byour%2Brequest.&fbconnect=1&next=https%3A%2F%2Fm.facebook.com%2Fdialog%2Fpermissions.request%3F_path%3Dpermissions.request%26app_id%3D111111111111111%26client_id%3D111111111111111%26redirect_uri%3Dfb111111111111111%253A%252F%252Fauthorize%26sdk%3Dios%26display%3Dtouch%26type%3Duser_agent%26fbconnect%3D1%26sso%3Diphone-safari%26from_login%3D1&rcount=1&_rdr)

如果解码相同的 url： [https://www.facebook.com/login.php?app_id=111111111111111&sdk=ios&skip_api_login=1&cancel=fb111111111111111://authorize/?error_reason=user_denied&error=access_denied&error_description=The+user+denied+your+request。 &fbconnect=1&next=https://m.facebook.com/dialog/permissions.request?_path=permissions.request&app_id=111111111111111&client_id=111111111111111&redirect_uri=fb111111111111111%3A%2F%2Fauthorize&sdk=ios&display_1&insotype=iphone-agentfarib&display_1&insotype=user-afarib 1&rcount=1&_rdr](https://www.facebook.com/login.php?app_id=111111111111111&sdk=ios&skip_api_login=1&cancel=fb111111111111111://authorize/?error_reason=user_denied&error=access_denied&error_description=The+user+denied+your+request.&fbconnect=1&next=https://m.facebook.com/dialog/permissions.request?_path=permissions.request&app_id=111111111111111&client_id=111111111111111&redirect_uri=fb111111111111111%3A%2F%2Fauthorize&sdk=ios&display=touch&type=user_agent&fbconnect=1&sso=iphone-safari&from_login=1&rcount=1&_rdr)

我还仔细检查了所有相关位置的 app-id 是否相等（info.plist/url/dev-site: Bundle ID）！

不知道它是否是重要信息，但我们在我们的应用程序中不使用任何 xib 文件，因为它是使用我们自己的 3d 引擎的 3D 游戏。并且提供的屏幕方向仅为横向。我使用 Xcode 版本 4.5.2 (4G2008a)。

有任何想法吗？

3个附加问题（也许它可以帮助我获得更多信息）：

1.  我怎样才能获得更多关于出了什么问题的信息？“com.facebook.sdk error 2”不是很有帮助：-/

2.  有没有一种简单的方法来测试来自 UIApplicationDelegate 的 openURL 方法的自动重定向调用？

3.  有没有办法强制 sdk 使用 safari-browser 而不是视图登录？

提前谢谢

马丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T13:31:38.133

我找到了一个解决方案：您必须在方法“应用程序：didFinishLaunchingWithOptions”中调用方法“canOpenURL”，如下所示：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
  ...
  [[UIApplication sharedApplication] canOpenURL: [NSURL URLWithString:@"fb111111111111111"]];
  ...
  return YES; //or NO;  doesn't matter
} 
```

现在的效果是 sdk 尝试使用 safari 浏览器而不是愚蠢的 WebView 登录 :-)

_

暗示：

您可以直接从 info.plist 文件中读取 URL Scheme：

```
NSString urlScheme = [[[[NSBundle mainBundle] objectForInfoDictionaryKey:@"CFBundleURLTypes"] objectAtIndex:0] objectForKey:@"CFBundleURLSchemes" objectAtIndex:0]; 
```

# javascript - 在发布时从 jQuery 数据表中检索所有单元格数据

> ID：15024555
> 
> 赞同：0
> 
> 时间：2013-02-22T12:44:38.610
> 
> 标签：javascript, jquery, asp.net, asp.net-mvc, asp.net-mvc-3

这个问题与我发布的一个没有得到回答的问题有关：[How to do batch row updates using jQuery Datatables and ASP MVC](https://stackoverflow.com/questions/15019172/how-to-do-batch-row-updating-using-jquery-datatables-and-asp-mvc)

我正在使用`jQuery datatables`and `ASP.NET MVC 4`。我想要实现的是，当我单击提交按钮时，我需要将所有数据表的数据回发到控制器的操作方法中。我将编辑我的表格数据，然后我需要将此编辑后的表格数据发回我的控制器，然后我想一次处理它。我不想即时更新行或单元格。

我不知道该怎么做。我什至尝试过这样的事情，但这也不起作用：

这就是我填充数据表的方式：

```
$('#com-plus-components-datatable').dataTable({
     "aoColumns": [
          { "mDataProp": [0], "sWidth": "35%" },
          { "mDataProp": [1], "sWidth": "65%" }
     ],
     "bAutoWidth": false,
     "bFilter": false,
     "bLengthChange": false,
     "bPaginate": false,
     "bProcessing": true,
     "bServerSide": true,
     "bSort": false,
     "iDisplayLength": 50,
     "sAjaxSource": '@Url.Action("GetWindowsServices")'
}); 
```

这是我尝试获取数据表数据：

```
$('form').submit(function () {
     $.post("@Url.Content("~/Server/Test")",
     $('form').serialize(),
     function (data) {
          alert('success');
     }, 'json');
}); 
```

我获取数据并进行所有处理的操作方法（下面的部分代码）：

```
[HttpPost]
public ActionResult Test(string[] data)
{
     return View();
} 
```

`string[] data`在帖子中始终为空。

单击提交按钮后，如何将所有数据表的数据放入我的操作方法中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:49:05.687

您忘记通过从 .submit 处理程序返回 false 来取消表单提交的默认操作：

```
$('form').submit(function () {
     $.post('@Url.Action("Test", "Server")', $('form').serialize(), function (data) {
         alert('success');
     });
     return false; // <!-- You need this
}); 
```

或者你也可以这样做：

```
$('form').submit(function (evt) {
     evt.preventDefault(); // <!-- You need this
     $.post('@Url.Action("Test", "Server")', $('form').serialize(), function (data) {
         alert('success');
     });
}); 
```

还要注意我是如何使用 Url.Action 助手而不是 Url.Content 来生成控制器操作的 url。这将考虑您的路线定义。硬编码你的网址总是不好的。

此外，为了使其正常工作，请确保您尊重[`standard naming conventions`](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)输入字段的 ，以便默认模型绑定器能够将请求反序列化为字符串数组。

# c# - 如何通过 lambda 表达式“将任意数量的参数传递给方法”？

> ID：15024558
> 
> 赞同：1
> 
> 时间：2013-02-22T12:44:44.617
> 
> 标签：c#, multithreading, delegates, lambda, closures

我遵循[将数据传递给](http://www.albahari.com/threading/#_Passing_Data_to_a_Thread)Joseph Albahari 的“C# 中的线程”的“第 1 部分：入门”的线程。

即段落：

====== 报价开始

"*使用这种方法，您可以**将任意数量的参数传入（到哪里？）方法**。您甚至可以将整个实现包装在一个多语句 lambda 中：*

```
new Thread (() =>  
{  
  Console.WriteLine ("I'm running on another thread!");  
  Console.WriteLine ("This is so easy!");  
}).Start();* 
```

*在 C# 2.0 中，您可以使用匿名方法几乎同样轻松地做同样的事情：*

```
 new Thread (delegate()  
  {  
  ...
  }).Start(); 
```

============ 引用结束

~~也就是说，我已经尝试过“轻松”为：~~

 ~~```
new Thread
(delegate
  {
    Console.WriteLine("I'm running on another thread!");
    Console.WriteLine("This is so easy!");
   }
).Start(); 
```~~ 

但它会产生错误：

> ~~*以下方法或属性之间的调用不明确：“System.Threading.Thread.Thread(System.Threading.ThreadStart)”和“System.Threading.Thread.Thread(System.Threading.ParameterizedThreadStart)”*~~

1.  ~~您如何消除代码的歧义以便运行它？~~ **已回答（遗漏了括号。无论如何，这不是最初的主要问题）**
2.  另外，我不太了解空列表 `() =>`指向/应用到哪里？
3.  那么，“您可以将任意数量的参数传递给该方法”的方法是什么？
4.  如何理解通过空列表传递（任意数量）参数？

**更新**（针对 Jon Skeet 的评论）：
不，我没有坚持使用 C# 2。

[与上一段](http://www.albahari.com/threading/#_Passing_Data_to_a_Thread)相同的问题：

========== 引用开头：
"***将参数传递给线程的目标方法****的最简单方法是执行一个 lambda 表达式，该表达式使用所需的参数调用该方法：*

 **```
static void Main()
{
  Thread t = new Thread ( () => Print ("Hello from t!") );
  t.Start();
}

static void Print (string message) 
{
  Console.WriteLine (message);
} 
```

*使用这种方法，您可以将任意数量的参数传递给该方法。”*

=============== 引用结束

**更新2 ：**
最[完整的答案是@Lee的IMO，](https://stackoverflow.com/a/15024614/2031316)尽管我将另一个答案标记为正确的答案是为了立即回答我什至最初没有问过的问题-如何将某些内容放在空括号中（我已经害怕通过列表来称呼它或通过参数）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:47:33.697

您需要明确参数列表：

```
new Thread
(delegate()
  {
    Console.WriteLine("I'm running on another thread!");
    Console.WriteLine("This is so easy!");
   }
).Start(); 
```

该`delegate`关键字允许您定义一个[匿名方法](http://msdn.microsoft.com/en-gb/library/0yw3tz5k.aspx)。Lambda 表达式（即使用`() => { ... }`语法）类似，但是使用`delegate`允许您省略参数列表。在这种情况下这是不明确的，因为有两个构造函数`Thread`采用不同的委托类型。一个取一个`ThreadStart`定义为

```
delegate void ThreadStart(); 
```

另一个采用 a`ParameterizedThreadStart`定义为：

```
delegate void ParameterizedThreadStart(object state); 
```

由于您省略了参数列表，编译器不知道您使用的是哪种委托类型。

我假设“任意数量的参数”是由您的代表封闭的变量。例如，您可以：

```
string message = "This is so easy!";
var thread = new Thread(delegate() {
    Console.WriteLine(message);
});
thread.Start(); 
```

您可以使用 a`ParameterizedThreadStart`将任意对象传递给您的线程委托，例如

```
public class ThreadData {
   //properties to pass to thread
}

ThreadData data = new ThreadData { ... }
Thread thread = new Thread((object state) => {
    ThreadData data = (ThreadData)state;
});

thread.Start(data); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T12:56:00.603

您需要后面的括号`delegate`来指定参数，在这种情况下没有参数：

```
new Thread(
  delegate() {
    Console.WriteLine("I'm running on another thread!");
    Console.WriteLine("This is so easy!");
  }
).Start(); 
```

作者所说的“任意数量的参数”是您可以使用在单独线程中运行的代码内部创建委托的范围内的数据，而无需将数据传递给`Start`方法：

```
string msg1 = "I'm running on another thread!";
string msg2 = "This is so easy!";
new Thread(
  delegate() {
    Console.WriteLine(msg1);
    Console.WriteLine(msg2);
  }
).Start(); 
```

实际发生的是，变量不再是方法中的局部变量，而是自动存储在闭包中，委托与定义它的方法共享该闭包。

只要您只想启动一个线程，这就会很好地工作。如果要启动使用不同数据的多个线程，您可以将数据传递到`Start`方法中，或者创建一个可以保存数据的类，将线程代码放在类中，并为每个线程创建一个实例开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T12:46:45.747

为了解决模棱两可的调用，您可以添加空括号（委托将被视为 ThreadStart 委托）：

```
new Thread(delegate() {
    Console.WriteLine("I'm running on another thread!");
    Console.WriteLine("This is so easy!");
}).Start(); 
```

或者添加 state 参数（delegate 将被视为 ParametrizedThreadStart）它可以工作，但很奇怪，因为你不需要那个参数。

```
new Thread(delegate(object state) {
    Console.WriteLine("I'm running on another thread!");
    Console.WriteLine("This is so easy!");
}).Start(); 
```

或将委托投给`ThreadStart`

```
new Thread((ThreadStart)delegate {
    Console.WriteLine("I'm running on another thread!");
    Console.WriteLine("This is so easy!");
}).Start(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-22T12:50:51.557

`() =>`不是 C# 中的空列表。在本书中使用的上下文中，它是 lambda 表达式的开始。这`()`意味着这个表达式不带参数。**

# ios - 推送到 UIStoryboard 中的根视图控制器

> ID：15024559
> 
> 赞同：0
> 
> 时间：2013-02-22T12:44:45.397
> 
> 标签：ios, objective-c, ios6, uistoryboardsegue

我的故事板结构中有层次`ViewControllers`结构。它是**ABCD**。**A**被嵌入`NavigationController`并且流程一直持续到**D** `viewController`。通过 segues 附加的四肢视图。现在我在**D上，我为** **D**`viewController`的按钮定义了一些动作，它应该将我直接带到**A**或**B**。那我怎么能做到这一点。我尝试了一切，但没有成功。 ****`viewController``rootViewController` **`viewController`******

 ******我想要这样的东西不应该干扰**ABCD**流，它应该带我从**D到****A** 。`viewController`

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:55:31.293

右键单击您的 D 视图控制器并将 i 拖动到您的 A 视图控制器。

然后单击出现在您刚刚创建的行上的对象。

在属性检查器的故事板 segue 标识符中编写类似 DtoA 的内容。

现在在 D 视图控制器中，只需执行以下操作：

```
[self performSegueWithIdentifier:@"DtoA" sender:self]; 
```

如果您希望以老式方式弹出到以前的视图控制器，例如从 D 到 B：

```
UINavigationController* navController = self.navigationController;
UIViewController* Bviewcontroller = [navController.viewControllers objectAtIndex:1];
[navController popToViewController:controller animated:YES]; 
```

我希望这有帮助！********

# unix - 仅打印字符串中的第一个字段

> ID：15024561
> 
> 赞同：40
> 
> 时间：2013-02-22T12:44:48.660
> 
> 标签：unix, sed, awk, field, cut

我有一个日期，因为`12/12/2013 14:32`我想将其转换为 only `12/12/2013`. 字符串可以是`1/1/2013 12:32`或者`1/10/2013 23:41`我只需要日期部分。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2013-02-22T12:48:08.673

您可以使用各种 Unix 工具轻松做到这一点：

```
$ cut -d' ' -f1  <<< "12/12/2013 14:32"
12/12/2013

$ awk '{print $1}' <<< "12/12/2013 14:32"
12/12/2013

$ sed 's/ .*//' <<< "12/12/2013 14:32"
12/12/2013

$ grep -o "^\S\+"  <<< "12/12/2013 14:32"
12/12/2013

$ perl -lane 'print $F[0]' <<< "12/12/2013 14:32"
12/12/2013 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-02-22T15:26:18.613

```
$ echo "12/12/2013 14:32" | awk '{print $1}'
12/12/2013 
```

`print $1`--> 打印提供的字符串的第一列。 `12/12/2013`

`print $2`--> 打印提供的字符串的第二列。 `14:32`

默认情况下，awk 将空格字符视为分隔符。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-22T13:28:29.947

如果您的日期字符串存储在变量中，那么您不需要运行外部程序，如`cut`, `awk`or `sed`，因为现代 shell`bash`可以直接执行[字符串操作](http://tldp.org/LDP/abs/html/string-manipulation.html)，效率更高。

例如，在 bash 中：

```
$ s="1/10/2013 23:41"
$ echo "${s% *}"
1/10/2013 
```

# asp.net - 使用 json 检索推特

> ID：15024564
> 
> 赞同：0
> 
> 时间：2013-02-22T12:44:56.717
> 
> 标签：asp.net, json, twitter, javascriptserializer

我在解析 twitter 流时遇到问题，此代码返回此错误消息：

> 没有为“System.Collections.Generic.IEnumerable`1[[Xxxx.Website.Templates.WidgetViews.Tweet, Dolphin, Version=1.0.4801.24288, Culture=neutral, PublicKeyToken=null]]”类型定义无参数构造函数。

非常感谢您的帮助！

```
public partial class TwitterWidgetView
{
  protected override void OnLoad(System.EventArgs e)
  {
    string listName = "sas";
    string twitterListPath = "https://search.twitter.com/search.json?q=" + listName;
    WebClient wc = new WebClient();
    var json = wc.DownloadString(twitterListPath);
    JavaScriptSerializer ser = new JavaScriptSerializer();
    var tweetList = ser.Deserialize<IEnumerable<Tweet>>(json);
  }
}

public class Metadata
    {
        public string result_type { get; set; }
    }

    public class Tweet 
    {
        public Tweet()
        {}

        public string created_at { get; set; }

        public string from_user { get; set; }

        public int from_user_id { get; set; }

        public string from_user_id_str { get; set; }

        public string from_user_name { get; set; }

        public object geo { get; set; }

        public object id { get; set; }

        public string id_str { get; set; }

        public string iso_language_code { get; set; }

        public Metadata metadata { get; set; }

        public string profile_image_url { get; set; }

        public string profile_image_url_https { get; set; }

        public string source { get; set; }

        public string text { get; set; }

        public string to_user { get; set; }

        public int to_user_id { get; set; }

        public string to_user_id_str { get; set; }

        public string to_user_name { get; set; }

        public long? in_reply_to_status_id { get; set; }

        public string in_reply_to_status_id_str { get; set; }

    }

    public class RootObject
    {
        public RootObject()
        {}

        public double completed_in { get; set; }

        public long max_id { get; set; }

        public string max_id_str { get; set; }

        public string next_page { get; set; }

        public int page { get; set; }

        public string query { get; set; }

        public string refresh_url { get; set; }

        public List<Tweet> results { get; set; }

        public int results_per_page { get; set; }

        public int since_id { get; set; }

        public string since_id_str { get; set; }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T13:13:12.503

尝试改用列表

```
var tweetList = ser.Deserialize<List<Tweet>>(json); 
```

# xcode - 在 Xcode 中调试时，我如何知道加载了哪些 dylib？

> ID：15024566
> 
> 赞同：5
> 
> 时间：2013-02-22T12:44:58.667
> 
> 标签：xcode, dynamic-linking, dylib

我在使用特定库时遇到了一些问题，我正在尝试测试旧版本是否可以解决我的问题。该库使用存储在 .app 文件附近的 dylib 文件动态链接。这些 dylib 文件到处都是，我不完全确定我的应用程序实际上正在使用我试图让它使用的那些。

在 Visual Studio 上，您可以在调试应用程序时轻松查看加载的 dll 文件列表。Xcode 中是否有类似的功能？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-22T12:48:35.063

在调试器控制台中，当应用程序暂停时，您可以使用：

```
image list 
```

从命令行，您可以使用：

```
$ otool -L /path/to/executable 
```

# stan - 抽样误差 - Stan 中的基本回归模型

> ID：15024573
> 
> 赞同：0
> 
> 时间：2013-02-22T12:45:27.543
> 
> 标签：stan

我正在尝试如何学习 Stan，并故意做一些简单的问题来让自己跟上进度。在尝试运行简单的二元回归时，我非常卡在第 1 级。

我有以下格式的数据

```
stan_data <- list("y"=y, 
                  "year"=year,
                  "N_obs" = N_obs) 
```

完整的数据粘贴在这篇文章的底部，不碍事。

无论如何，我用于二元回归的 stan 代码如下所示。

```
lm <- "data {
            int<lower=1> N_obs;      
            real year[N_obs];
            real y[N_obs];
            }
        parameters {
            real alpha;
            real beta;
            real<lower=0> sigma;
         } 

         transformed parameters{ 
         }

         model {
             vector[N_obs] mu_hat;

             alpha ~ normal(0, 100);
             beta ~ normal(0, 100);
             sigma ~ uniform(0, 100);

             for(i in 1:N_obs){
                 mu_hat[i] <- alpha + beta * year[i];
                 y[i] ~ normal(mu_hat[i], sigma);
             }
        }"

write(lm, file="lm.stan")

lm.fit0 <- stan(file="lm.stan",
            data=stan_data, 
            chains=1, 
            iter=5000) 
```

首先，我有一个疑问。为什么我们在模型块中有语句`vector[N_obs] mu_hat;`（而不是`real mu_hat[N_obs];`在转换后的参数块中）？从一点谷歌搜索来看，这似乎是你需要做的。

其次（更严重的是），当我尝试运行代码时，出现以下错误：

```
TRANSLATING MODEL 'lm' FROM Stan CODE TO C++ CODE NOW.
COMPILING THE C++ CODE FOR MODEL 'lm' NOW.
SAMPLING FOR MODEL 'lm' NOW (CHAIN 1).
Error : Error in function stan::prob::normal_log(d): Random variable is nan, but must not be nan!
In addition: Warning message:
In storage.mode(x) <- "integer" : NAs introduced by coercion
error occurred during calling the sampler; sampling not done 
```

像往常一样，非常感谢任何帮助。

数据实际上是这样的：

> stan_data $y 42089728 9339536 9781184 138361088 30910448 30411792 629997056 21062368 1167006 7631744 6925444 5893008 35743680 -55904 116299776 966712 178152 19397504 101188992 1536242176 44078264 1243806 105937664 43202352 -4213172 40201728 84412544 16671128 0 19432968 44403296 89021120 33442736 5850532 68061664 0 86286272 636771072 65779408 6416524 25559184 0 0 11437649 128506560 26867136 1646992 -16684608 43974528 6812660 0 0 -906249 17730360 6571846 -14056304 -2317026 2972​​2656 43035904 70388248 -202987 24308224 0 19598944 25241600 31093140 172198080 68365824 -15307088 345229424 0 919122886387084 6936104 362958976 10828080 34233728 465616896 185831488 4554222 14789792 19448168 27692960 88308096 75171552 -246307584 11228152 8361832 2265296 172424512 1182046720 22629408 1165429 348064512 77001792 11092408 84706848 -19970752 -2386432 66124424 19266104 72069984 14311872 -1680048 509040 188740112 318636288 170175680 -244937216 16264160 6017916 327072 159117760 0 8156479 320665728 36684736 17502416 29556064 47395008 12937934 168051632 0 892982 10329560 1355983 -4529648 -43117 -10704432 226641152 23704368 -3433973 -73329408 0 3594688 51327088 59915116 293390016 382384192 -12102624 -336263424 0 -24685504 -899952 10155976 218019584 4874811230058752 1842414592 44083792 5092000 24174848 10985128 33436544 159885024 36513376 140204416 12631560 8951732 25929808 353803264 3143784448 60253136 702773 506841344 38420128 11721112 92972608 60845840 30016168 37990192 -6470864 78287520 21554528 29755168 3766984 35639136 26794784 583849280 267967488 37916960 11501600 22704880 133042624 513627 3389580 289430272 21665616 85471472 39646656 116267616 -13407846 15678080 27691000 682450 9635360 580544 16791136 793524 38486832 -79701376 -63242544 2160139 202091584 300 60001872 120758144 50716744 13548672 623414144 21202400 0 0 17696512 -5566584 -3197064 201575680 34187360 50923296 1267788800 28845072 102140620589376 5255816 19726800 43046336 84012320 93750016 1549232 4102708 20721248 36500736 5098330112 -20425392 781041 247644672 28292416 21682296 52508672 38884352 57993648 953560 1437008 81498304 86611584 23846608 5454052 37785760 99136512 58742016 1308937472 37354624 14447532 19370288 81054432 108383989 5834392 196654592 -37886048 199787840 -38083360 -19815904 1496112 7065456 30429000 -190947 3102040 5150997 6569152 711859 42429536 148236256 70894720 -888473 62231296 15503290 -17289808 106739712 -46661248 -185851136 602047616 60204790051247644672 28292416 21682296 52508672 38884352 57993648 953560 1437008 81498304 86611584 23846608 5454052 37785760 99136512 58742016 1308937472 37354624 14447532 19370288 81054432 108383989 5834392 196654592 -37886048 199787840 -38083360 -19815904 1496112 7065456 30429000 -190947 3102040 5150997 6569152 711859 42429536 148236256 70894720 -888473 62231296 15503290 -17289808 106739712 - 46661248 -185851136 602047616 15609200 940000 0247644672 28292416 21682296 52508672 38884352 57993648 953560 1437008 81498304 86611584 23846608 5454052 37785760 99136512 58742016 1308937472 37354624 14447532 19370288 81054432 108383989 5834392 196654592 -37886048 199787840 -38083360 -19815904 1496112 7065456 30429000 -190947 3102040 5150997 6569152 711859 42429536 148236256 70894720 -888473 62231296 15503290 -17289808 106739712 - 46661248 -185851136 602047616 15609200 940000 0-19815904 1496112 7065456 30429000 -190947 3102040 5150997 6569152 711859 42429536 148236256 70894720 -888473 62231296 15503290 -17289808 106739712 -46661248 -185851136 602047616 15609200 940000 0-19815904 1496112 7065456 30429000 -190947 3102040 5150997 6569152 711859 42429536 148236256 70894720 -888473 62231296 15503290 -17289808 106739712 -46661248 -185851136 602047616 15609200 940000 0

```
$year
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
3 3 3 3 3 3 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4 4 4

$N_obs
284 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T18:42:37.587

请参阅[https://groups.google.com/d/msg/stan-users/fsM8GPG4cpM/YVedcWYcmW8J](https://groups.google.com/d/msg/stan-users/fsM8GPG4cpM/YVedcWYcmW8J)

简而言之，这是 RStan 中的一个 bug，它试图将整数数据的存储模型转换为整数。但是这里的整数太大了，所以创建了一些 NA。将在下一个版本中修复。

# silverlight - Silverlight 应用程序 - 这是服务，它在站点关闭时运行吗？

> ID：15024577
> 
> 赞同：0
> 
> 时间：2013-02-22T12:45:34.150
> 
> 标签：silverlight, mvvm

我制作了一个 silverlight 应用程序，其中有 2 个项目，一个 projectname，然后是一个 projectname.web，但是当没有人访问该站点时，哪个将在 IIS 上运行？还是他们都会？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:57:28.897

您的 projectname.xap 文件将从 Web 服务器的 ClientBin 目录下载到访问者的 Web 浏览器，并将在他的计算机上运行。如果您的 silverlight 应用程序对 projectname.web Web 应用程序进行任何 Web 服务（WCF 等）调用，那么在这些调用的生命周期内 projectname.web 将运行，但否则将处于空闲状态——除非您有一些代码无论是否发出请求，您的 projectname.web 都会在后台运行。

# ruby-on-rails - heroku 上的通配符域

> ID：15024578
> 
> 赞同：1
> 
> 时间：2013-02-22T12:45:35.557
> 
> 标签：ruby-on-rails, heroku

如何在 Heroku 上使用通配符域？我的应用程序正在使用子域。

我遵循 Heroku 自定义域文章并将我的映射`*.mydomain.com`到`myapp.herokuapp.com`. 当我访问`dev.mydomain.com`它时，它指向 heroku 应用程序，但在 Heroku 应用程序上我找不到子域。

简而言之，我想在 heroku 上使用子域，比如`dev.myapp.herokuapp.com`. 有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:03:19.173

Heroku 上的通配符设置指示 Heroku 将对给定域的子域的任何请求指向您的应用程序。

但是这里停止了 Heroku 的责任。那么您的应用程序必须能够在应用程序级别处理此类请求。

`request`在 Rails 中，您可以使用控制器中的对象检查请求详细信息。您可以使用`request.subdomain`.

因此，例如，如果您添加`*.example.com`并且有人访问`foo.example.com`，请求对象将使用以下值进行响应：

```
request.host
# => foo.example.com
request.subdomain
# => foo 
```

现在你有责任根据你想要达到的目标在你的应用中使用这些信息。

# c++ - 如何检索文件数字签名信息？

> ID：15024583
> 
> 赞同：2
> 
> 时间：2013-02-22T12:45:47.777
> 
> 标签：c++, c, windows

我已经搜索了一种从数字签名的 PE 文件中检索信息的方法。我需要发布者、发布者链接、发行者名称和主题名称。我需要 winapi / c / c++ 代码（函数），我需要一个快速的方法，我不需要检查签名是否有效。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T17:50:39.667

这是我为我的一个项目编写的代码。它以 type 的结构返回详细信息`NSIGINFO`。随意使用它 - 无需署名，但如果您能保持版权完整，我将不胜感激。

如果缺少任何功能（我必须从几个不同的地方整合一些东西，所以我可能遗漏了一些东西）请告诉我，我会做出必要的调整。

让我知道这对你有用。祝你好运。

头文件，`NAuthenticode.h`：

```
// NAuthenticode.h: Functions for checking signatures in files
//
// Copyright (c) 2008-2012, Nikolaos D. Bougalis <nikb@bougalis.net>

#ifndef B82FBB5B_C0F8_43A5_9A31_619BB690706C
#define B82FBB5B_C0F8_43A5_9A31_619BB690706C

#include <wintrust.h>
#include <softpub.h>
#include <imagehlp.h>

struct NSIGINFO
{
    LONG lValidationResult;

    LPTSTR lpszPublisher;
    LPTSTR lpszPublisherEmail;
    LPTSTR lpszPublisherUrl;
    LPTSTR lpszAuthority;
    LPTSTR lpszFriendlyName;
    LPTSTR lpszProgramName;
    LPTSTR lpszPublisherLink;
    LPTSTR lpszMoreInfoLink;
    LPTSTR lpszSignature;
    LPTSTR lpszSerial;
    BOOL bHasSigTime;
    SYSTEMTIME stSigTime;
};

VOID NCertFreeSigInfo(NSIGINFO *pSigInfo);

BOOL NVerifyFileSignature(LPCTSTR lpszFileName, NSIGINFO *pSigInfo, HANDLE hHandle = INVALID_HANDLE_VALUE);

BOOL NCertGetNameString(PCCERT_CONTEXT pCertContext, DWORD dwType,
    DWORD dwFlags, LPTSTR *lpszNameString);

BOOL NCheckFileCertificates(HANDLE hFile, 
    VOID (*pCallback)(PCCERT_CONTEXT, LPVOID), PVOID pParam);

#endif 
```

实施，`NAuthenticode.cpp`：

```
// NAuthenticode.cpp: Various routines related to validating file signatures
//
// Copyright (c) 2008-2012, Nikolaos D. Bougalis <nikb@bougalis.net>

#include "stdafx.h"
#include "NAuthenticode.h"

//////////////////////////////////////////////////////////////////////////
#pragma comment(lib, "crypt32")
#pragma comment(lib, "imagehlp")
#pragma comment(lib, "wintrust")

//////////////////////////////////////////////////////////////////////////
#define SIG_ENCODING (X509_ASN_ENCODING | PKCS_7_ASN_ENCODING)

//////////////////////////////////////////////////////////////////////////
// Some utility functions
LPVOID NHeapAlloc(SIZE_T dwBytes)
{
    if(dwBytes == 0)
        return NULL;

    return HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, dwBytes);
}

//////////////////////////////////////////////////////////////////////////
LPVOID NHeapFree(LPVOID lpMem)
{
    if(lpMem != NULL)
        HeapFree(GetProcessHeap(), 0, lpMem);

    return NULL;
}

//////////////////////////////////////////////////////////////////////////
LPSTR NConvertW2A(LPCWSTR lpszString, int nLen, UINT nCodePage)
{
    ASSERT(lpszString != NULL);

    int ret = WideCharToMultiByte(nCodePage, 0, lpszString, nLen, NULL, 0, NULL, NULL);

    if(ret <= 0)
        return NULL;

    LPSTR lpszOutString = (LPSTR)NHeapAlloc((ret + 1) * sizeof(CHAR));

    if(lpszOutString == NULL)
        return NULL;

    ret = WideCharToMultiByte(nCodePage, 0, lpszString, nLen, lpszOutString, ret, NULL, NULL);

    if(ret <= 0)
        lpszOutString = (LPSTR)NHeapFree(lpszOutString);

    return lpszOutString;
}

//////////////////////////////////////////////////////////////////////////
LPWSTR NDupString(LPCWSTR lpszString, int nLen)
{
    if(nLen == -1)
        nLen = (int)wcslen(lpszString);

    LPWSTR lpszOutString = (LPWSTR)NHeapAlloc((2 + nLen) * sizeof(WCHAR));

    if((lpszOutString != NULL) && (nLen != 0))
        wcsncpy(lpszOutString, lpszString, nLen + 1);

    return lpszOutString;
}

//////////////////////////////////////////////////////////////////////////
LPTSTR NConvertW2T(LPCWSTR lpszString, int nLen, UINT nCodePage)
{
    ASSERT(lpszString != NULL);

#ifndef UNICODE
    return (LPTSTR)NConvertW2A(lpszString, nLen, nCodePage);
#else
    return (LPTSTR)NDupString(lpszString, nLen);
#endif
}

//////////////////////////////////////////////////////////////////////////
LPWSTR NConvertA2W(LPCSTR lpszString, int nLen, UINT nCodePage)
{
    ASSERT(lpszString != NULL);

    int ret = MultiByteToWideChar(nCodePage, 0, lpszString, nLen, NULL, 0);

    if(ret <= 0)  
        return NULL;

    LPWSTR lpszOutString = (LPWSTR)NHeapAlloc((ret + 1) * sizeof(WCHAR));

    if(lpszOutString == NULL)
        return NULL;

    ret = MultiByteToWideChar(nCodePage, 0, lpszString, nLen, lpszOutString, ret);

    if(ret <= 0)
        lpszOutString = (LPWSTR)NHeapFree(lpszOutString);

    return lpszOutString;
}

//////////////////////////////////////////////////////////////////////////
LPWSTR NConvertT2W(LPCTSTR lpszString, int nLen, UINT nCodePage)
{
    ASSERT(lpszString != NULL);

#ifndef UNICODE
    return NConvertA2W((LPCSTR)lpszString, nLen, nCodePage);
#else
    return NDupString((LPWSTR)lpszString, nLen);
#endif
}

//////////////////////////////////////////////////////////////////////////
VOID NCertFreeSigInfo(NSIGINFO *pSigInfo)
{
    if(pSigInfo == NULL)
        return;

    __try
    { // Be extra careful
        if(pSigInfo->lpszPublisher)
            pSigInfo->lpszPublisher = (LPTSTR)NHeapFree(pSigInfo->lpszPublisher);

        if(pSigInfo->lpszPublisherEmail)
            pSigInfo->lpszPublisherEmail = (LPTSTR)NHeapFree(pSigInfo->lpszPublisherEmail);

        if(pSigInfo->lpszPublisherUrl)
            pSigInfo->lpszPublisherUrl = (LPTSTR)NHeapFree(pSigInfo->lpszPublisherUrl);

        if(pSigInfo->lpszAuthority)
            pSigInfo->lpszAuthority = (LPTSTR)NHeapFree(pSigInfo->lpszAuthority);

        if(pSigInfo->lpszProgramName)
            pSigInfo->lpszProgramName = (LPTSTR)NHeapFree(pSigInfo->lpszPublisher);

        if(pSigInfo->lpszPublisherLink)
            pSigInfo->lpszPublisherLink = (LPTSTR)NHeapFree(pSigInfo->lpszPublisher);

        if(pSigInfo->lpszMoreInfoLink)
            pSigInfo->lpszMoreInfoLink = (LPTSTR)NHeapFree(pSigInfo->lpszMoreInfoLink);

        if(pSigInfo->lpszSignature)
            pSigInfo->lpszSignature = (LPTSTR)NHeapFree(pSigInfo->lpszSignature);

        if(pSigInfo->lpszSerial)
            pSigInfo->lpszSerial = (LPTSTR)NHeapFree(pSigInfo->lpszSerial);
    }
    __except(EXCEPTION_EXECUTE_HANDLER)
    {
    }
}

//////////////////////////////////////////////////////////////////////////
static BOOL NCertGetNameString(PCCERT_CONTEXT pCertContext, DWORD dwType, DWORD dwFlags, LPTSTR *lpszNameString)
{
    if(pCertContext == NULL)
        return FALSE;

    DWORD dwData = CertGetNameString(pCertContext, dwType, 0, NULL, NULL, 0);

    if(dwData == 0)
        return FALSE;

    *lpszNameString = (LPTSTR)NHeapAlloc((dwData + 1) * sizeof(TCHAR));

    if(*lpszNameString == NULL)
        return FALSE;

    dwData = CertGetNameString(pCertContext, dwType, dwFlags, NULL, *lpszNameString, dwData);

    if(dwData == 0)
    {
        NHeapFree(*lpszNameString);
        return FALSE;
    }

    return TRUE;
}

//////////////////////////////////////////////////////////////////////////
static BOOL NCryptDecodeObject(__in LPCSTR lpszObjectId, __in_bcount(cbEncoded) const BYTE *pbEncoded, __in DWORD cbEncoded,
    __inout DWORD &dwBuffer, __out void *pBuffer = NULL, __in DWORD dwFlags = 0)
{   
    if(((pBuffer == NULL) && (dwBuffer != 0)) || ((dwBuffer == 0) && (pBuffer != NULL)))
    { // What? You're passing a NULL pointer an a non-zero size? You so crazy!!!!
        ASSERT(FALSE);
        SetLastError(ERROR_INVALID_PARAMETER);
        return FALSE;
    }

    return CryptDecodeObject(SIG_ENCODING, lpszObjectId, pbEncoded, cbEncoded, dwFlags, pBuffer, &dwBuffer);
}   

//////////////////////////////////////////////////////////////////////////
static BOOL NCryptDecodeObject(__in LPCSTR lpszObjectId, __in PCRYPT_ATTR_BLOB pObject,
    __inout DWORD &dwBuffer, __out void *pBuffer = NULL, __in DWORD dwFlags = 0)
{   
    if((pObject == NULL) || ((dwBuffer == 0) && (pBuffer != NULL)) || ((dwBuffer != 0) && (pBuffer == NULL)))
    {
        SetLastError(ERROR_INVALID_PARAMETER);
        return FALSE;
    }   

    return CryptDecodeObject(SIG_ENCODING, lpszObjectId, pObject->pbData, pObject->cbData, dwFlags, pBuffer, &dwBuffer);
}   

//////////////////////////////////////////////////////////////////////////
static BOOL WGetSignTimestamp(PCRYPT_ATTRIBUTES pAttributes, SYSTEMTIME &stTime, LPCSTR lpszObjId)
{
    if((pAttributes == NULL) || (pAttributes->cAttr == 0) || (lpszObjId == NULL) || (*lpszObjId == 0))
        return FALSE;

    for(DWORD dwAttr = 0; dwAttr < pAttributes->cAttr; dwAttr++)
    {           
        if(strcmp(lpszObjId, pAttributes->rgAttr[dwAttr].pszObjId) == 0)
        {               
            DWORD dwSize = sizeof(FILETIME);
            FILETIME ftCert;

            if(NCryptDecodeObject(lpszObjId, &pAttributes->rgAttr[dwAttr].rgValue[0], dwSize, (PVOID)&ftCert))
            {
                FILETIME ftLocal;

                if(FileTimeToLocalFileTime(&ftCert, &ftLocal) && FileTimeToSystemTime(&ftLocal, &stTime))
                    return TRUE;
            }
        }
    }

    return FALSE;
}

//////////////////////////////////////////////////////////////////////////
static BOOL NVerifyFileSignatureWorker(LPWSTR lpszFileName, WINTRUST_DATA &wtData, NSIGINFO *pSigInfo)
{
    if(pSigInfo != NULL)
        memset(pSigInfo, 0, sizeof(NSIGINFO));

    GUID guidAction = WINTRUST_ACTION_GENERIC_VERIFY_V2;    
    BOOL bVerified = FALSE;

    LONG lRet = WinVerifyTrust((HWND)INVALID_HANDLE_VALUE, &guidAction, &wtData);

    if(lRet != 0)
    {
        if(pSigInfo != NULL)
            pSigInfo->lValidationResult = lRet;

        return FALSE;
    }

    if(pSigInfo == NULL)
        return TRUE;

    HCERTSTORE hStore = NULL;
    HCRYPTMSG hMsg = NULL;

    if(!CryptQueryObject(CERT_QUERY_OBJECT_FILE, lpszFileName, CERT_QUERY_CONTENT_FLAG_PKCS7_SIGNED_EMBED, CERT_QUERY_FORMAT_FLAG_BINARY, 0, NULL, NULL, NULL, &hStore, &hMsg, NULL))
        return FALSE;

    PCMSG_SIGNER_INFO pSignerInfo = NULL, pCounterSignerInfo = NULL;
    DWORD dwSignerInfo = 0, dwCounterSignerInfo = 0;

    if(CryptMsgGetParam(hMsg, CMSG_SIGNER_INFO_PARAM, 0, NULL, &dwSignerInfo) && (dwSignerInfo != 0))
        pSignerInfo = (PCMSG_SIGNER_INFO)NHeapAlloc(dwSignerInfo);

    if((pSignerInfo != NULL) && CryptMsgGetParam(hMsg, CMSG_SIGNER_INFO_PARAM, 0, (PVOID)pSignerInfo, &dwSignerInfo))
    {   
        for(DWORD dwAttr = 0; dwAttr < pSignerInfo->AuthAttrs.cAttr; dwAttr++)
        {   
            if((strcmp(SPC_SP_OPUS_INFO_OBJID, pSignerInfo->AuthAttrs.rgAttr[dwAttr].pszObjId) != 0))
                continue;

            PSPC_SP_OPUS_INFO pOpus = NULL;
            DWORD dwData = 0;

            if(NCryptDecodeObject(SPC_SP_OPUS_INFO_OBJID, &pSignerInfo->AuthAttrs.rgAttr[dwAttr].rgValue[0], dwData) && (dwData != 0))
                pOpus = (PSPC_SP_OPUS_INFO)NHeapAlloc(dwData);

            if((pOpus != NULL) && NCryptDecodeObject(SPC_SP_OPUS_INFO_OBJID, &pSignerInfo->AuthAttrs.rgAttr[dwAttr].rgValue[0], dwData, (PVOID)pOpus))
            {     
                pSigInfo->lpszProgramName = NConvertW2T(pOpus->pwszProgramName);

                if(pOpus->pPublisherInfo != NULL)
                {
                    switch(pOpus->pPublisherInfo->dwLinkChoice)
                    {
                    case SPC_URL_LINK_CHOICE:
                        pSigInfo->lpszPublisherLink = NConvertW2T(pOpus->pPublisherInfo->pwszUrl);
                        break;

                    case SPC_FILE_LINK_CHOICE:
                        pSigInfo->lpszPublisherLink = NConvertW2T(pOpus->pPublisherInfo->pwszFile);
                        break;
                    }
                }

                if(pOpus->pMoreInfo != NULL)
                {
                    switch (pOpus->pMoreInfo->dwLinkChoice)
                    {
                    case SPC_URL_LINK_CHOICE:
                        pSigInfo->lpszMoreInfoLink = NConvertW2T(pOpus->pMoreInfo->pwszUrl);
                        break;

                    case SPC_FILE_LINK_CHOICE:
                        pSigInfo->lpszMoreInfoLink = NConvertW2T(pOpus->pMoreInfo->pwszFile);
                        break;
                    }
                }                                       
            }    

            if(pOpus != NULL)
                NHeapFree(pOpus);

            break;
        }

        CERT_INFO ci; 

        ci.Issuer = pSignerInfo->Issuer;
        ci.SerialNumber = pSignerInfo->SerialNumber;

        PCCERT_CONTEXT pCertContext = CertFindCertificateInStore(hStore, SIG_ENCODING, 0, CERT_FIND_SUBJECT_CERT, (PVOID)&ci, NULL);

        if(pCertContext != NULL)
        {      
            if(pCertContext->pCertInfo->SerialNumber.cbData != 0)
            {
                pSigInfo->lpszSerial = (LPTSTR)NHeapAlloc(((pCertContext->pCertInfo->SerialNumber.cbData * 2) + 1) * sizeof(TCHAR));

                if(pSigInfo->lpszSerial != NULL)
                {
                    LPTSTR lpszPointer = pSigInfo->lpszSerial;

                    for(DWORD dwCount = pCertContext->pCertInfo->SerialNumber.cbData; dwCount != 0; dwCount--)
                        lpszPointer += _stprintf(lpszPointer, _T("%02X"), pCertContext->pCertInfo->SerialNumber.pbData[dwCount - 1]);
                }
            }

            if(!NCertGetNameString(pCertContext, CERT_NAME_FRIENDLY_DISPLAY_TYPE, CERT_NAME_ISSUER_FLAG, &pSigInfo->lpszFriendlyName))
                pSigInfo->lpszFriendlyName = NULL;

            if(!NCertGetNameString(pCertContext, CERT_NAME_SIMPLE_DISPLAY_TYPE, CERT_NAME_ISSUER_FLAG, &pSigInfo->lpszAuthority))
                pSigInfo->lpszAuthority = NULL;

            if(!NCertGetNameString(pCertContext, CERT_NAME_SIMPLE_DISPLAY_TYPE, 0, &pSigInfo->lpszPublisher))
                pSigInfo->lpszPublisher = NULL;

            if(!NCertGetNameString(pCertContext, CERT_NAME_URL_TYPE, 0, &pSigInfo->lpszPublisherUrl))
                pSigInfo->lpszPublisherUrl = NULL;

            if(!NCertGetNameString(pCertContext, CERT_NAME_EMAIL_TYPE, 0, &pSigInfo->lpszPublisherEmail))
                pSigInfo->lpszPublisherEmail = NULL;

            CertFreeCertificateContext(pCertContext);
        }

        for(DWORD dwAttr = 0, dwData; dwAttr < pSignerInfo->AuthAttrs.cAttr; dwAttr++)
        {           
            if((strcmp(szOID_RSA_signingTime, pSignerInfo->AuthAttrs.rgAttr[dwAttr].pszObjId) == 0) && (pSignerInfo->AuthAttrs.rgAttr[dwAttr].cValue != 0))
            {   
                FILETIME ftCert;

                dwData = sizeof(FILETIME);

                if(NCryptDecodeObject(szOID_RSA_signingTime, &pSignerInfo->AuthAttrs.rgAttr[dwAttr].rgValue[0], dwData, (PVOID)&ftCert))
                {
                    FILETIME ftLocal;

                    if(!FileTimeToLocalFileTime(&ftCert, &ftLocal))
                    {
                        if(!FileTimeToSystemTime(&ftLocal, &pSigInfo->stSigTime))
                            memset(&pSigInfo->stSigTime, 0, sizeof(SYSTEMTIME));
                    }                   
                }
            }           
        } 

        for(DWORD dwAttr = 0; dwAttr < pSignerInfo->UnauthAttrs.cAttr; dwAttr++)
        {
            if(strcmp(pSignerInfo->UnauthAttrs.rgAttr[dwAttr].pszObjId, szOID_RSA_counterSign) == 0)
            {
                if(NCryptDecodeObject(PKCS7_SIGNER_INFO, &pSignerInfo->UnauthAttrs.rgAttr[dwAttr].rgValue[0], dwCounterSignerInfo) && (dwCounterSignerInfo != 0))
                    pCounterSignerInfo = (PCMSG_SIGNER_INFO)NHeapAlloc(dwCounterSignerInfo);

                if((pCounterSignerInfo != NULL) && !NCryptDecodeObject(PKCS7_SIGNER_INFO, &pSignerInfo->UnauthAttrs.rgAttr[dwAttr].rgValue[0], dwCounterSignerInfo, pCounterSignerInfo))
                    pCounterSignerInfo = (PCMSG_SIGNER_INFO)NHeapFree(pCounterSignerInfo);

                break;
            }
        }

        if(pCounterSignerInfo != NULL)
        {
            pSigInfo->bHasSigTime = WGetSignTimestamp(&pCounterSignerInfo->AuthAttrs, pSigInfo->stSigTime, szOID_RSA_signingTime);

            if(!pSigInfo->bHasSigTime)
                memset(&pSigInfo->stSigTime, 0, sizeof(SYSTEMTIME));
        }   
    }   

    if(pSignerInfo != NULL)
        NHeapFree(pSignerInfo);

    if(pCounterSignerInfo != NULL)
        NHeapFree(pCounterSignerInfo);

    if(hStore != NULL)
        CertCloseStore(hStore, 0);

    if(hMsg != NULL)
        CryptMsgClose(hMsg);

    return TRUE;
}

//////////////////////////////////////////////////////////////////////////
BOOL NVerifyFileSignature(LPCTSTR lpszFileName, NSIGINFO *pSigInfo, HANDLE hHandle)
{
    if(pSigInfo != NULL)    
        memset(pSigInfo, 0, sizeof(NSIGINFO));

    if(lpszFileName == NULL)
        return FALSE;

    if((lpszFileName[0] != 0) && (_tcsnicmp(lpszFileName, _T("\\??\\"), 4) == 0))
        lpszFileName += 4;

    if(lpszFileName[0] == 0)
        return FALSE;

    LPWSTR lpwszFileName = NConvertT2W(lpszFileName);

    if(lpwszFileName == NULL)
        return FALSE;

    BOOL bOK = FALSE;

    __try
    { // be very careful... 
        WINTRUST_FILE_INFO wtFileInfo;
        memset(&wtFileInfo, 0, sizeof(WINTRUST_FILE_INFO));

        wtFileInfo.cbStruct = sizeof(WINTRUST_FILE_INFO);
        wtFileInfo.pcwszFilePath = lpwszFileName;

        if(hHandle != INVALID_HANDLE_VALUE)
            wtFileInfo.hFile = hHandle;

        WINTRUST_DATA wtData;
        memset(&wtData, 0, sizeof(WINTRUST_DATA));
        wtData.cbStruct = sizeof(WINTRUST_DATA);
        wtData.dwUIChoice = WTD_UI_NONE;
        wtData.fdwRevocationChecks = WTD_REVOKE_WHOLECHAIN;
        wtData.dwUnionChoice = WTD_CHOICE_FILE;
        wtData.pFile = &wtFileInfo;

        if(NVerifyFileSignatureWorker(lpwszFileName, wtData, pSigInfo))
            bOK = TRUE;
    }
    __except(EXCEPTION_EXECUTE_HANDLER)
    {
        if(pSigInfo != NULL)
        {
            if(pSigInfo->lpszPublisher)
                pSigInfo->lpszPublisher = (LPTSTR)NHeapFree(pSigInfo->lpszPublisher);

            if(pSigInfo->lpszAuthority)
                pSigInfo->lpszAuthority = (LPTSTR)NHeapFree(pSigInfo->lpszAuthority);

            if(pSigInfo->lpszProgramName)
                pSigInfo->lpszProgramName = (LPTSTR)NHeapFree(pSigInfo->lpszPublisher);

            if(pSigInfo->lpszPublisherLink)
                pSigInfo->lpszPublisherLink = (LPTSTR)NHeapFree(pSigInfo->lpszPublisher);

            if(pSigInfo->lpszMoreInfoLink)
                pSigInfo->lpszMoreInfoLink = (LPTSTR)NHeapFree(pSigInfo->lpszMoreInfoLink);

            if(pSigInfo->lpszSignature)
                pSigInfo->lpszSignature = (LPTSTR)NHeapFree(pSigInfo->lpszSignature);

            if(pSigInfo->lpszSerial)
                pSigInfo->lpszSerial = (LPTSTR)NHeapFree(pSigInfo->lpszSerial);
        }

        bOK = FALSE;
    }

    NHeapFree(lpwszFileName);

    return bOK;
}

//////////////////////////////////////////////////////////////////////////
BOOL NCheckFileCertificates(HANDLE hFile, VOID (*pCallback)(PCCERT_CONTEXT, LPVOID), PVOID pParam)
{
    DWORD dwCerts = 0;

    if(!ImageEnumerateCertificates(hFile, CERT_SECTION_TYPE_ANY, &dwCerts, NULL, 0))
        return FALSE;

    for(DWORD dwCount = 0; dwCount < dwCerts; dwCount++)
    {
        WIN_CERTIFICATE wcHdr;
        memset(&wcHdr, 0, sizeof(WIN_CERTIFICATE));
        wcHdr.dwLength = 0;
        wcHdr.wRevision = WIN_CERT_REVISION_1_0;

        if(!ImageGetCertificateHeader(hFile, dwCount, &wcHdr))
            return FALSE;

        DWORD dwLen = sizeof(WIN_CERTIFICATE) + wcHdr.dwLength;

        WIN_CERTIFICATE *pWinCert = (WIN_CERTIFICATE *)NHeapAlloc(dwLen);

        if(pWinCert == NULL)
            return FALSE;

        if(!ImageGetCertificateData(hFile, dwCount, pWinCert, &dwLen))
        { // problem getting certificate, return failure
            NHeapFree(pWinCert);
            return FALSE;
        }

        // extract the PKCS7 signed data     
        CRYPT_VERIFY_MESSAGE_PARA cvmp;
        memset(&cvmp, 0, sizeof(CRYPT_VERIFY_MESSAGE_PARA));
        cvmp.cbSize = sizeof(CRYPT_VERIFY_MESSAGE_PARA);
        cvmp.dwMsgAndCertEncodingType = SIG_ENCODING;

        PCCERT_CONTEXT pCertContext = NULL;

        if(!CryptVerifyMessageSignature(&cvmp, dwCount, pWinCert->bCertificate, pWinCert->dwLength, NULL, NULL, &pCertContext))
        {
            NHeapFree(pWinCert);
            return FALSE;
        }

        // Now, pass this context on to our callback function (if any)
        if(pCallback != NULL)
            pCallback(pCertContext, pParam);

        if(!CertFreeCertificateContext(pCertContext))
        {
            NHeapFree(pWinCert);
            return FALSE;
        }

        NHeapFree(pWinCert);
    }

    return TRUE;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T12:41:29.110

Microsoft 在此支持链接中提供了一种方法：[How To Get Information from Authenticode Signed Executables](http://support.microsoft.com/kb/323809)

> 您可以使用 WinVerifyTrust() API 来验证 Authenticode 签名的可执行文件。
> 
> 尽管验证了签名，但程序可能还必须执行以下操作：
> 
> *   确定签署可执行文件的证书的详细信息。
> *   确定文件加盖时间戳的日期和时间。
> *   检索与文件关联的 URL 链接。
> *   检索时间戳证书。
> 
> 本文演示如何使用 CryptQueryObject() API 从 Authenticode 签名的可执行文件中检索详细信息。

# python - 如何让 PyC harm 识别静态文件？

> ID：15024584
> 
> 赞同：8
> 
> 时间：2013-02-22T12:45:52.597
> 
> 标签：python, pycharm

我有一个 Django 项目，看起来像：

```
/.idea
/clients
     /app
         /static
             coin.png
         /templates
             index.html
         __init__.py
         urls.py
     /clients
         settings.py
     manage.py 
```

在 index.html 我有（我可以在渲染上看到图像）：

```
{% load staticfiles %}

<img src="{% static 'coin.png' %}"> 
```

settings.py 的相关部分：

```
STATIC_ROOT = os.path.join(os.path.dirname(__file__), 'static/')
STATIC_URL = '/static/'

STATICFILES_DIRS = (
    os.path.join(os.path.dirname(__file__), '../static/'),
)

INSTALLED_APPS = (
    'django.contrib.staticfiles',
)

TEMPLATE_CONTEXT_PROCESSORS = (
    'django.core.context_processors.static',
) 
```

在我添加的项目结构`/clients`中，因为 Django 项目的根是 repo 根的上一级。然而`{% static %}`，尽管 Django 可以找到它们，但我在这个项目中的所有用途都不断得到亮点，因为它们不存在。关于如何解决这个问题的想法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-09-27T18:56:34.953

```
STATICFILES_DIRS = (
    'static',
) 
```

以上假设您的静态目录`static`在您的根目录下被调用。现在需要做`os.path.join`。我已经尝试并测试了这一点。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-01-17T21:09:41.607

您需要设置以下设置，以告诉 PyCharm 在哪里可以找到项目根目录：

[![在此处输入图像描述](../Images/4f822cdc2a03f758a40d68300f0635c9.png)](https://i.stack.imgur.com/byRX8.png)

[要设置的 Django 设置（图片）](https://i.stack.imgur.com/byRX8.png)

你也可以使用 {{STATIC_URL}}/path/to/files，它的工作方式与 pycharm 不同

这创造了奇迹。pycharm 虽然有点奇怪。

# .net - 使相同的应用程序兼容 Net3.5 和 4.0

> ID：15024586
> 
> 赞同：0
> 
> 时间：2013-02-22T12:46:12.197
> 
> 标签：.net, .net-4.0, properties, settings

我有一组应用程序作为使用 .NET3.5 用 C# 开发的单个项目。该应用程序不适用于带有 NET4 的 PC，我添加并测试以查看所有功能是否在 NET4 中运行。将 Net 框架更改为 4.0 而不是 3.5。

相同的应用程序在 NET4 中编译和构建时没有出现任何错误。该应用程序在 Properties.Settings 中包含 UserSettings。我将版本从 2.0.0 更改为 4.0.0，现在应用程序开始执行。

我的问题：该代码与 NET3.5 和 4.0 兼容。但目前唯一的问题是 appConfig 中的 Version 值对于 .NET3.5 和 .NET4.0 的版本会有所不同。无论如何，除了处理上述情况（即版本标签的值）之外，我还可以对 NET3.5 和 4 使用相同的代码吗？我也可以添加

```
 <startup>
<!-- FOR .NET 3.0 & 3.5, 3.0.50727 CLR is only used -->

<supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
<supportedRuntime version="v2.0" />  <!-- For Net 2.0, 3.0, 3.5 --> 
```

使应用程序在 NET 4.0 或 3.5 的 PC 上运行？

任何帮助，指导表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:47:59.213

您应该针对 v3.5 而不是 v4 构建。然后我*希望*你能够在只有 4.0 或只有 3.5 的机器上运行它，而根本没有*任何* `app.config`文件 - 或者没有提到支持的运行时。预计大多数在 3.5 上运行的代码应该能够在 4.0 上运行而无需更改。

（一个变化是围绕混合模式程序集中的本机代码，IIRC - 但除非您知道您包含本机代码，否则我怀疑您会被它咬住。）

# ios - iOS MDM 配置文件签名，使用哪个证书？

> ID：15024587
> 
> 赞同：4
> 
> 时间：2013-02-22T12:46:12.567
> 
> 标签：ios, certificate, x509, mdm

好的，请看[这张图](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/iPhoneOTAConfiguration/OTASecurity/OTASecurity.html)。

有两个小框，表示应该如何签署给定的配置文件。

在第 2 阶段的第 1 步中，它显示“Apple 颁发的证书”，但没有说明*是哪个*Apple 颁发的证书（他们颁发的证书不止一个）。我已经尝试过我的开发者证书和 MDM (APNS) 证书。它不是其中之一。我是否需要第三张魔法证书（以及如何获得它）？

在第 3 阶段，第 2 步中，它显示“身份证书”，但在细节上还是有点粗略。我知道的唯一身份证书安装在设备上，使用设备的私钥，服务器应该如何使用它来签署配置文件？

我让它工作的唯一方法是创建我自己的自签名证书，并将其预安装在设备上。显然，这不是一种优雅或特别安全的做事方式。

**跟进问题**

我的服务器证书由“DigiCert High Assurance EV Root CA”颁发并在列表中：http: [//support.apple.com/kb/ht5012](http://support.apple.com/kb/ht5012)，但 iOS 6 设备在签署配置文件时认为它“不受信任”，但很好对于奇怪的 SSL。iOS 5 设备虽然很好。知道为什么吗？

我也不太了解加密位。从 MDM 文档中：“每个设备都必须有一个唯一的客户端身份证书。您可以将这些证书作为 PKCS#12 容器或通过 SCEP 交付。建议使用 SCEP，因为该协议确保身份的私钥仅存在于设备。”

虽然我同意只有设备本身知道它的私钥最终会更安全，但这有点问题，因为 2048 位公钥只能用于加密大约 100 字节的数据，这对于最小的数据也是不够的有效载荷。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T15:33:24.287

**让我先回顾第二阶段和第三阶段**

在第 2 阶段，第 1 步中，iOS 设备将向服务器发送由设备证书/密钥签名的响应（每个设备都带有预安装的证书/密钥，每个设备都不同）。这些设备证书/密钥由 Apple 颁发。

在服务器端，您应该使用 Apple Root Cetificate 对其进行验证。

在第 2 阶段的第 1-3 步中，您的配置文件服务将发送 SCEP 请求。此 SCEP 请求包含让设备知道它应该与哪个 SCEP 服务器通信的信息。此 SCEP 服务器是您的服务器。因此，设备将与此 SCEP 服务器对话，并向其请求新的身份证书。

在第 3 阶段，第 2 步设备响应将使用此身份证书的证书/密钥进行签名。现在您应该使用您的证书颁发机构根证书对其进行验证。（另一个注意阶段 2 中的 SCEP 服务器是您的证书颁发机构的一种代理）

**现在回答您的问题“MDM 配置文件签名，使用哪个证书？”**

MDM 配置文件可以加密和/或签名。

如果要对其进行加密，请使用与此设备关联的身份证书对其进行加密。因此，具有此身份的密钥的设备可以对其进行解密。

如果要签名，请使用服务器密钥进行签名。设备应安装服务器证书，以便验证签名。

顺便提一句。关于这个话题。此图中未显示但通常需要的一件事 - 第一步（在整个注册之前）通常是安装服务器证书（用于将来的配置文件签名验证）。如果您的服务器证书是由知名 CA 颁发的（例如 Verisign 或类似的东西），您可能可以跳过此步骤。

如果您有任何后续问题，请告诉我。我花了一段时间才了解整个 OTA/MDM 注册。

**更新 1**

我不知道为什么 iOS 6 将您的证书视为不受信任的签名。我没有使用由知名 CA 签名的证书。

我只有一个猜测。可能是在 iOS 5 和 iOS 6 之间，他们改变了一些关于钥匙链的东西。一般来说，每个应用程序都有自己的钥匙链。我相信所有众所周知的证书都应该存储在 Mobile Safari 钥匙串中。可能是 MDM/Preferences 在 iOS 6 中与 MobileSafari 共享了这个钥匙串，现在他们不共享它了。在这种情况下，您必须通过配置文件安装此“DigiCert High Assurance EV Root CA”（将其放入正确的钥匙串中）。然而，这是疯狂的猜测。

关于加密。首先，你是对的，如果每个设备都有自己的私钥，那就更安全了。在这种情况下，如果有人窃取配置文件，他们将无法解密（因为只有设备有私钥才能解密）。如果您要发送敏感的配置文件（例如，同时包含用户名和密码的电子邮件帐户），这一点尤其重要。

非常高级的密码学介绍：

任何密钥（任何长度）都可以加密任何长度的数据。所有加密算法的设计方式都是您可以使用相同的密钥来加密任何数量的数据。

非对称算法（如 RSA）很少用于直接加密数据。在大多数情况下，此算法用于加密对称算法的密钥（例如 AES），并且所有后续加密/解密都使用 AES 完成。这有两个原因：性能（AES 比 RSA 快）和资源（AES 比 RSA 的资源消耗少）。

因此，如果您需要加密配置文件，您可以使用[PKCS7](http://en.wikipedia.org/wiki/Cryptographic_Message_Syntax)，它在内部使用 RSA、AES（或其他算法）。通常，您有一个库来执行此操作（OpenSSL 或 BouncyCastle）。因此，您不必弄清楚所有这些复杂性。

顺便提一句。如果您有不适合 SO 的问题，欢迎您直接与我联系（我的联系信息在我的个人资料中）。

# .net - 根据不同的屏幕分辨率调整或更改 WPF 控件的布局

> ID：15024588
> 
> 赞同：1
> 
> 时间：2013-02-22T12:46:13.510
> 
> 标签：.net, wpf, layout, screen-resolution

WPF 中是否有一个控件可以让我根据窗口的大小为用户控件定义 1 个或多个布局。

假设分辨率为 1280 x 800，我将有一个 4 列的 Grid 控件来显示我的数据，但如果分辨率为 800 x 600，我将只有一个 2 列的 Grid 控件，所以它看起来确实很糟糕。

例如

```
<Layouts>
 <Layout x:key="1280x800">
  <Grid/> with 4 columns
 </Layout>
 <Layout x:key="800x600">
  <Grid /> with 2 columns
 </Layout>
</Layouts> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T12:50:20.813

您可以使用通过绑定到窗口的[SystemParameters](http://msdn.microsoft.com/en-us/library/system.windows.systemparameters.aspx)或窗口的/来设置`ContentControl`其`Content`或`ContentTemplate`属性的 a 。`DataTrigger``ActualHeight``ActualWidth`

您可能还需要一个[IValueConverter](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx)，因为触发器仅测试值是否等于某个值，并且您可能需要测试屏幕高度/宽度是否大于或小于特定值。

此外，WPF 实际上并不根据屏幕分辨率进行缩放。引用[这个 SO 答案](https://stackoverflow.com/a/2236911/302677)

> 请记住，所有 WPF 位置和大小都是浮点数，单位为 1/96 英寸。不是像素。**这使您的窗口设计分辨率独立。**算一下：高度 = 960 / 96 = 10 英寸。将视频适配器设置为 120 DPI (120/96 = 125%)：10 * 120 = 1200 像素。宽度相同：1536 / 96 * 120 = 1920 像素。

# bazaar - 如何在不使用“bzr”命令行界面的情况下下载具有修订历史的集市存储库？

> ID：15024597
> 
> 赞同：1
> 
> 时间：2013-02-22T12:46:47.940
> 
> 标签：bazaar, launchpad

我尝试使用以下方法从带有修订历史的启动板下载 bazar 存储库：

```
bzr branch lp:<repo-name> 
```

此存储库包含**.bzr**目录，其中包含修订历史记录。但是， **launchpad.net**还显示了为某些存储库下载 zip 文件的选项。zip 文件不包含**.bzr**目录。它只包含最新版本的源快照。

在 github 中，可以下载具有完整 git 修订历史的 zip 文件（即存在**.git**目录）

我想知道这在 Launchpad 中是否可行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:21:10.667

不，我不认为 Launchpad 有这样的功能。您看到的 zip 文件是由项目所有者打包的，而不是生成的或自动的。他们可以打包包含完整历史记录的 zip 文件，但目的通常相反：项目的发布版本没有历史记录，只有文件。

如果您想要完整历史记录的压缩版本，则必须分两步完成：分支然后压缩。

该`--no-tree`标志可能对您有用。`branch`在命令中使用该标志将只创建`.bzr`没有工作树的目录（项目文件）。

# android - Phonegap 文件上传到 asmx Web 服务

> ID：15024599
> 
> 赞同：0
> 
> 时间：2013-02-22T12:46:57.230
> 
> 标签：android, ios, cordova, file-upload, asmx

我正在尝试从 Android 和 ios 设备将图像文件上传到 asmx Web 服务，但出现以下错误：

对于 Android：服务器上的 FileNotFoundException FileTransfer.upload 上的错误 FileTransfer.execute 上的错误 IOException：收到来自服务器的错误。“http_status”：500，“代码”：1

对于 iOS：服务器上的 FileNotFoundException FileTransfer.upload 上的错误 FileTransfer.execute 上的错误 IOException：收到来自服务器的错误。“http_status”：500，“代码”：3

我正在使用 Icenium 进行开发，并且 ft.upload() 方法的 service_url 参数正在工作，我可以在浏览器上调用 Web 服务，但是当我尝试在我的项目中使用时，我遇到了同样的错误。

IIS 日志如下：

软件：Microsoft Internet Information Services 7.5

版本：1.0

日期：2013-02-22 11:00:07

字段：日期时间 s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) sc-status sc-substatus sc-win32-status time-taken

```
2013-02-22 11:00:07 192.168.1.103 POST /ExpenseService.asmx/UploadFile - 40201 - 78.189.173.183 Camera%20Sample%20Official/1.0+CFNetwork/609+Darwin/13.0.0 500 0 0 287 2013-02-22 11:01:28 192.168.1.103 POST /ExpenseService.asmx/UploadFile - 40201 - 78.189.173.183 Camera%20Sample%20Official/1.0+CFNetwork/609+Darwin/13.0.0 500 0 0 144 
```

我的科尔多瓦 2.2.0 版。任何想法我做错了什么？

ASMX 服务：

```
#region FileUpload
    [WebMethod]
    //[ScriptMethod(UseHttpGet = true, ResponseFormat = ResponseFormat.Json)]
    public string UploadFile()
    {
        try
        {
            File.WriteAllText(@"d:\test.txt", "hede");
            HttpPostedFile file = HttpContext.Current.Request.Files[0];
            if (file == null)
                return null;
            string targetFilePath = @"d:\" + file.FileName;
            file.SaveAs(targetFilePath);
            return file.FileName.ToString();
        }
        catch (Exception ex)
        {
            File.WriteAllText(@"d:\uploader.txt", ex.Message.ToString());
            return null;
        }

    }
    #endregion 
```

客户端：

```
var options = new FileUploadOptions(); 
options.chunkedMode  = false;
options.fileKey = "ficheFile";
console.log('imageFileName: ' + imageFileName);    
options.fileName = imageFileName; 
options.mimeType="image/jpeg";
console.log('imageSrc: ' + imageSrc);

var ft = new FileTransfer(); 
ft.upload(imageSrc, encodeURI("http://mydomain:40201/ExpenseService.asmx/UploadFile"), win, fail, options); 
```

这是我的 adb logcat：

```
E/FileTransfer(11472): {"target":"http:\/\/mydomain:40201\/ExpenseService.asmx\/SaveFile","source":"file:\/\/\/mnt
\/sdcard\/Android\/data\/com.telerik.Camera_Sample_Official\/cache\/1361950930301.jpg","http_status":500,"code":1}
E/FileTransfer(11472): java.io.FileNotFoundException: http://78.189.173.183:40201/ExpenseService.asmx/SaveFile
E/FileTransfer(11472):  at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getInputStream(H
ttpURLConnectionImpl.java:521)
E/FileTransfer(11472):  at org.apache.cordova.FileTransfer.getInputStream(FileTransfer.java:480)
E/FileTransfer(11472):  at org.apache.cordova.FileTransfer.access$400(FileTransfer.java:62)
E/FileTransfer(11472):  at org.apache.cordova.FileTransfer$1.run(FileTransfer.java:402)
E/FileTransfer(11472):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
E/FileTransfer(11472):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
E/FileTransfer(11472):  at java.lang.Thread.run(Thread.java:1019)
D/CordovaLog(11472): Error Code: 1
D/CordovaLog(11472): : Line 1153648589 : Error Code: 1
I/Web Console(11472): Error Code: 1 at :1153648589 
```

亲切的问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:35:50.903

httpstaus 500 是服务器错误。您的 UploadFile 函数中似乎存在错误。

您可以将 w3wp.exe 附加到进程以测试您的服务

# linux - /proc/pid/sched 中的时钟增量是什么？

> ID：15024601
> 
> 赞同：4
> 
> 时间：2013-02-22T12:47:07.020
> 
> 标签：linux, linux-kernel, procfs

```
main (xxxxx, #threads: xxxxx)
---------------------------------------------------------
se.exec_start                      :                 xxxx
se.vruntime                        :                 xxxx
se.sum_exec_runtime                :                 xxxx
se.wait_start                      :                 xxxx
...
policy                             :                 xxxx
prio                               :                 xxxx
clock-delta                        :                   58 <== this one 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T14:40:28.593

我潜伏在内核源代码中以找出`clock-delta`代表什么。

`/proc/pid/sched`我找到了在读取时将其打印出来的功能。

它是`proc_sched_show_task`并且它已被`kernel/sched/debug.c`归档。

深入研究，我发现了打印输出的代码部分`clock-delta`......这里是：

```
unsigned int this_cpu = raw_smp_processor_id();
u64 t0, t1;

t0 = cpu_clock(this_cpu);
t1 = cpu_clock(this_cpu);
SEQ_printf(m, "%-35s:%21Ld\n",
           "clock-delta", (long long)(t1-t0)); 
```

`raw_smp_processor_id`返回运行当前线程的 CPU 的 id。

所以...是两次调用`clock-delta`返回的两个值之间的差异。`cpu_clock()`

我`kernel/sched/clock.c`找到了这个函数的描述：

> cpu_clock(i) 提供了一个快速（执行时间）高分辨率
> 时钟，在 CPU 之间具有有限的漂移。cpu_clock(i) 的值对于常数 i 是单调的。返回的时间戳以纳秒为单位。

# c++ - 将 std::shared_ptr 设置为指向参考

> ID：15024602
> 
> 赞同：1
> 
> 时间：2013-02-22T12:47:07.870
> 
> 标签：c++, pointers, c++11, reference, shared-ptr

```
class a
{
private:
  std::shared_ptr <std::string> sptr;
public:
  void set(std::string & ref)
  {
   sptr = &ref; //error
  }
}; 
```

解决方案是什么？我需要将引用保留为参数，并且我需要将私有指针设为 shared_ptr。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T12:52:24.370

要将新的原始指针分配给共享指针并使共享指针取得所有权，请使用成员函数`reset`：

```
std::shared_ptr<Foo> p;

p.reset(new Foo); 
```

共享指针*共享对象的所有权*，因此几乎不可能`sptr`在任意引用上合理地拥有您的共享所有权。（例如`sptr.reset(&ref)`，几乎可以肯定是完全错误的。）适当的做法是制作字符串的新副本，即要么`sptr.reset(new std::string(ref))`，要么更好：

```
sptr = std::make_shared<std::string>(ref); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T12:49:41.513

如果要存储参考地址，则可以使用

```
sptr = std::shared_ptr<std::string>(&ref, [](const std::string*){}); 
```

否则，如果您想存储新对象 - 使用 Kerrek SB 变体。

# android - 适用于 Android 的图标集，具有 iPhone 外观

> ID：15024606
> 
> 赞同：0
> 
> 时间：2013-02-22T12:47:11.193
> 
> 标签：android, image

我被要求为两个系统（Android 和 iPhone）开发一个应用程序，并且两者必须看起来相同。所以，我想要一组看起来像 iPhone 按钮的图标。

任何人都知道我可以下载/购买一组 .png 以使 Android 应用程序看起来像 iPhone 的链接吗？（在 iPhone 中，我将使用默认按钮）

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:05:46.197

在提供一些链接让您开始之前，让我还包括一个来自 Android 设计指南的链接，然后是来自同一链接的引用：

[纯安卓](http://developer.android.com/design/patterns/pure-android.html)

> **不要模仿其他平台的 UI 元素**
> 
> 平台通常会提供一组精心设计的 UI 元素，这些元素以非常独特的方式进行主题化。例如，一些平台提倡在按钮上使用圆角，而另一些则在标题栏中使用渐变。在某些情况下，元素可能具有相同的目的，但设计的工作方式略有不同。

我不确定模仿/模仿 iPhone 是否是进入多平台开发的意图或正确方式（尽管根据主题标题，我倾向于认为您打算只保留*跨*平台的通用图标库） . 但是没有进入那个辩论和众所周知的蠕虫罐头。无论如何，这里有一些顶部提到的链接：

**注意：我不是为 iOS 平台开发的，也不完全了解默认图标是什么。如果发布的链接无用，请提醒我。;-)**

1.  [http://www.glyphish.com/](http://www.glyphish.com/)
2.  [http://www.designshock.com/free-iphone-icons/](http://www.designshock.com/free-iphone-icons/)
3.  [http://www.iconshock.com/iphone-icons/](http://www.iconshock.com/iphone-icons/)
4.  [http://speckyboy.com/2008/07/18/35-free-icon-sets-for-your-iphone-pimp-it-up/](http://speckyboy.com/2008/07/18/35-free-icon-sets-for-your-iphone-pimp-it-up/)
5.  [http://visionwidget.com/free-iphone-themes-icons-sets.html](http://visionwidget.com/free-iphone-themes-icons-sets.html)
6.  [http://ntt.cc/2010/05/10/50-free-hand-picked-iphone-icon-sets.html](http://ntt.cc/2010/05/10/50-free-hand-picked-iphone-icon-sets.html)
7.  [http://www.tutorialchip.com/freebies/25-impressive-fantastic-icon-sets-for-your-iphone/](http://www.tutorialchip.com/freebies/25-impressive-fantastic-icon-sets-for-your-iphone/)
8.  [http://skyje.com/iphone-themes-and-icon-sets/](http://skyje.com/iphone-themes-and-icon-sets/)
9.  [http://inspiredm.com/5-essential-icon-sets-for-iphone-applications/](http://inspiredm.com/5-essential-icon-sets-for-iphone-applications/)

搜索移动图标时，第一个链接 ( *glyphish* ) 通常会在整个 Google 中弹出。哦。他们还支持视网膜显示屏。:-)

# java - 基于 Android 的编程...循环

> ID：15024607
> 
> 赞同：-3
> 
> 时间：2013-02-22T12:47:12.630
> 
> 标签：java, loops, for-loop

这可能是一个非常简单的问题。我正在完成一个教程，我没有为页面添加书签，所以我无法返回。

无论如何，我对 Java 语言的一小部分感到困惑，这可能非常简单，但我是新手。以下是什么意思，是否可以修改为更高？

`for(int i=c.getCount()-1; i>=0; i--)`

我相信它是一个整数计数器，它将 c.getCount 的值分配给 i，然后减一，使 i 不等于任何内容，然后再次将 1 加到 i……这是对的吗？我需要将其增加到一个以上，这是可能的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:50:05.493

这是一个递减的for循环！

这里 i 的值将被初始化为`c.getCount()-1`

然后它检查它是否大于或等于零并进入循环。

执行完循环内容后，i count 减为 1。`i--`

然后再次检查条件并运行循环。循环运行直到 i 值小于 0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-27T09:34:40.527

```
for(int i=c.getCount()-1; i>=0; i--) 
```

这是一个 for 循环，它遵循以下步骤顺序：

1.  语句 i=c.getCount()-1 为 i 赋值。
2.  然后它将检查条件 i 是否大于或等于 0。
3.  如果条件为真，则执行 for 循环中的代码块。
4.  然后 i 值将减 1。
5.  再次检查条件并重复此过程，即循环迭代直到条件为假。
6.  一旦条件失败，循环将被终止。

# windows - Windows 2Gb 内存限制

> ID：15024610
> 
> 赞同：2
> 
> 时间：2013-02-22T12:47:30.820
> 
> 标签：windows, memory-management, heap-memory

我使用第三方测试应用程序。我给应用程序测试输入并得到结果。如果我向应用程序提供大量数据，它会给出“内存分配错误”当我从任务管理器观察使用的内存时，我发现当私有字节达到 ~2Gb 时它会给出错误。

我尝试了 32Bit Windows XP 和 64Bit Windows 7。结果是一样的。

我应该怎么做才能从我的第三方应用程序中增加保留的堆内存？我希望它使用超过 2Gb 的内存。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T12:49:54.227

第三方应用程序很可能是为 32 位构建的。因此，您仅限于 2Gb 内存使用量。

你可以试试看是否有64位的安装包。

# c - 如何避免双重释放或损坏 (!prev)

> ID：15024612
> 
> 赞同：-1
> 
> 时间：2013-02-22T12:47:31.950
> 
> 标签：c

如何避免双重释放或腐败（`!prev`）

我有这些结构：

始终有效的空设备

```
static struct mixer null_mixer = {
    .set_device = null_set_device,
    .close_device = null_close_device,
}; 
```

所有可用访问方法的列表。使用弱符号：NULL 未链接。

```
static struct mixer *mixers[] = {
    &alsa_mixer,
    &oss_mixer,
    &null_mixer
}; 
```

实际访问方法。

```
struct mixer *mixer = &null_mixer; 
```

设置混音器设备和通道。尝试每种访问方法，直到成功。

```
void mixer_set_device( const char *devname )
{
    int i;
    mixer->close_device();
    for (i = 0; i < sizeof(mixers)/sizeof(mixers[0]); i++) {
        mixer = mixers[i];
        if (!mixer)
            continue;
        if (mixer->set_device(devname) == 0)
            break;
    }
} 
```

当用户尝试在 gtk 条目中为混音器插入错误值时，我收到以下错误：

```
double free or corruption (!prev): 0x0000000002518c00 *** 
```

我认为这是问题：

```
static void alsa_open_mixer( void )
{
    int err;
    static snd_mixer_selem_id_t *sid = NULL;
    if ((err = snd_mixer_open (&handle, 0)) < 0) {
            return;
    }
    if ((err = snd_mixer_attach (handle, card)) < 0) { # memory leak
            goto error;
    }
    if ((err = snd_mixer_selem_register (handle, NULL, NULL)) < 0) {
            goto error;
    }
    if ((err = snd_mixer_load (handle)) < 0) {
            goto error;
    }
    snd_mixer_selem_id_malloc(&sid);
    if (sid == NULL)
            goto error;
    snd_mixer_selem_id_set_name(sid, channel);
    if (!(elem = snd_mixer_find_selem(handle, sid))) {
            goto error;
    }
    if (!snd_mixer_selem_has_playback_volume(elem)) {
            goto error;
    }
    snd_mixer_selem_get_playback_volume_range(elem, &alsa_min, &alsa_max);
    if ((alsa_max - alsa_min) <= 0) {
            goto error;
    }
    snd_mixer_selem_id_free(sid);
    return;

error:
    if (sid)
            snd_mixer_selem_id_free(sid); /* THIS LINE */
    if (handle) {
            snd_mixer_close(handle);
            handle = NULL;
    }
    return;
}

static int alsa_set_device( const char *devname )
{
    int i;

    if (card) free(card);
    card = strdup( devname );
    if( !card ) return -1;

    i = strcspn( card, "/" );
    if( i == strlen( card ) ) {
        channel = "Line";
    } else {
        card[i] = 0;
        channel = card + i + 1;
    }
    alsa_open_mixer();
    if (!handle) {
        return -1;
    }
    return 0;
}

struct mixer alsa_mixer = {
    .set_device = alsa_set_device,
    .close_device = alsa_close_device,
}; 
```

双重免费或损坏（`!prev`）：0x0000000002518c00 ***

更新：

指出有问题的行

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-09-14T18:50:10.923

正如我所看到的，您在 linux 下工作。然后您可以使用 valgrind 来查找任何内存问题。

# java - 是否允许在 Spring Services 中有实例变量？

> ID：15024613
> 
> 赞同：4
> 
> 时间：2013-02-22T12:47:32.600
> 
> 标签：java, spring, service

我有一个提供配置数据的弹簧服务。当 GUI 调用该服务时，它会从数据库中加载配置数据。事实证明，这种情况在单个请求的呈现过程中经常发生。我想通过缓存配置数据来优化它。但是，我不确定这是否是一种好的编程风格，或者是否“允许”在服务中拥有实例变量。

这是我正在考虑做的一些示例代码：

```
@Serivce("MyConfigService")
public class MyConfigServiceImpl implements MyConfigService {

    private Config cachedConfig;

    @Override
    public Config loadConfig() {
        if (cachedConfig != null) {
            // load config
            cachedConfig = loadedConfig;
        }
        return cachedConfig;
    }

    @Override
    public saveConfig(Config config) {
        cachedConfig = null;
        // save the configuration
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T13:21:36.940

拥有一个实例变量（不是由 spring 管理的）引入了服务变得线程不安全的可能性。所以我尽量避免它们，或者确保它们是线程安全的。

您可能希望查看`@configurable`和`@postconstuct`注释以实现您的目标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T13:15:49.263

Spring服务层类中是否允许实例变量？当然。

在这里使用一个来保存对`Config`对象的引用是个好主意吗？

也许，也许不是。

您没有显示`Config`正常加载的方式...是否将同一`Config`实例返回给所有用户？即 - 当用户 1 调用`saveConfig`然后用户 2 调用`loadConfig`用户 2 获取`Config`对象用户 1 保存。

如果是这样，您应该能够毫无问题地缓存该值。

此外，您可以使用 Spring 的[基于注释的缓存](http://static.springsource.org/spring/docs/3.1.0.M1/spring-framework-reference/html/cache.html)，而不是自己实现它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T13:00:40.583

实例变量是 Spring IoC 容器的全部内容；您的设计中值得怀疑的是您有自己的延迟加载逻辑`loadConfig`- 这是您必须留给 Spring 的关注点`lazy-init=true`（或类似的，我不记得确切）。该设计还可能涉及查找方法和可能的请求范围 bean。

# php - PHP foreach 更改原始数组值

> ID：15024616
> 
> 赞同：171
> 
> 时间：2013-02-22T12:47:39.420
> 
> 标签：php, arrays, foreach

我对多维数组很陌生，这让我很困扰。

我的数组如下：

```
$fields = array(
    "names" => array(
         "type"         => "text",
         "class"        => "name",
         "name"         => "name",
         "text_before"  => "name",
         "value"        => "",
         "required"     => true,
    )
) 
```

然后我有一个函数检查这些输入是否被填写，如果需要的话。

```
function checkForm($fields){
    foreach($fields as $field){
        if($field['required'] && strlen($_POST[$field['name']]) <= 0){
            $fields[$field]['value'] = "Some error";
        }
    }
    return $fields;
} 
```

现在我的问题是这条线

```
$fields[$field]['value'] = "Some error"; 
```

我想更改原始数组的内容，因为我要返回它，但是如何在我的 foreach 循环中获取当前数组的名称（本示例中的名称）？

* * *

## 回答 #1

> 赞同：309
> 
> 时间：2013-02-22T12:51:30.760

[在 PHP 中，通过引用传递 ( `&`) 是……有争议的。我建议不要使用它，除非您知道为什么需要它并测试结果。](https://stackoverflow.com/questions/178328/in-php-5-0-is-passing-by-reference-faster)

我建议执行以下操作：

```
foreach ($fields as $key => $field) {
    if ($field['required'] && strlen($_POST[$field['name']]) <= 0) {
        $fields[$key]['value'] = "Some error";
    }
} 
```

因此，基本上`$field`在您需要值以及`$fields[$key]`需要更改数据时使用。

* * *

## 回答 #2

> 赞同：206
> 
> 时间：2013-02-22T12:49:00.867

使用`&`：

```
foreach($arr as &$value) {
    $value = $newVal;
}
unset($value); 
```

`&`将数组的值作为引用传递，并且不创建变量的新实例。因此，如果您更改参考，原始值将会改变。

[通过引用传递的 PHP 文档](https://www.php.net/manual/en/language.references.pass.php)

**编辑 2018**

这个答案似乎受到互联网上很多人的青睐，这就是为什么我决定添加更多信息和警告的原因。
虽然在（或函数）中传递引用`foreach`是一种简洁而简短的解决方案，但对于许多初学者来说，这可能是一个危险的陷阱。

1.  > PHP 中的循环没有自己的作用域。- @马克阿梅里

    当变量在同一范围内重用时，这可能是一个严重的问题。[另一个 SO 问题很好地说明了为什么这可能是一个问题](https://stackoverflow.com/questions/3307409/php-pass-by-reference-in-foreach)。

2.  > 由于 foreach 依赖于 PHP 5 中的内部数组指针，因此在循环内更改它可能会导致意外行为。- foreach 的 PHP 文档。

    在同一循环的迭代期间取消设置记录或更改哈希值（键）可能会导致 PHP < 7 中出现潜在的意外行为。当数组本身是引用时，问题会变得更加复杂。

3.  Foreach 表演。
    通常，由于写时复制功能，PHP 更喜欢按值传递。这意味着 PHP 在内部不会创建重复数据，除非它的副本需要更改。传递引用是否`foreach`会提供任何性能改进是有争议的。与往常一样，您需要测试您的特定场景并确定哪个选项使用更少的内存和 CPU 时间。有关更多信息，请参阅 NikiC 下面链接的 SO 帖子。

4.  代码可读性。
    在 PHP 中创建引用很快就会失控。如果您是新手并且无法完全控制自己在做什么，最好远离参考。有关`&`运算符的更多信息，请查看本指南：[参考 — 这个符号在 PHP 中的含义是什么？](https://stackoverflow.com/questions/3737139/reference-what-does-this-symbol-mean-in-php)
    对于那些想要了解更多关于这部分 PHP 语言的人：[PHP 参考说明](https://www.php.net/manual/en/language.references.php)

**@NikiC 对 PHP`foreach`循环的内部逻辑的一个非常好的技术解释：**
[PHP 'foreach' 是如何工作的？](https://stackoverflow.com/questions/10057671/how-does-php-foreach-actually-work/14854568#14854568)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-02-22T12:48:35.203

使用`foreach($fields as &$field){`- 这样您将使用原始数组。

[这里](http://www.stoimen.com/blog/2011/10/27/object-cloning-and-passing-by-reference-in-php/)有更多关于通过引用传递的信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-22T12:56:25.100

```
function checkForm(& $fields){
    foreach($fields as $field){
        if($field['required'] && strlen($_POST[$field['name']]) <= 0){
            $fields[$field]['value'] = "Some error";
        }
    }
    return $fields;
} 
```

这就是我建议通过引用传递的内容

* * *

## 回答 #5

> 赞同：-7
> 
> 时间：2013-02-22T12:51:14.020

试试这个

```
function checkForm($fields){
        foreach($fields as $field){
            if($field['required'] && strlen($_POST[$field['name']]) <= 0){
                $field['value'] = "Some error";
            }
        }
        return $field;
    } 
```

# document - 如何在 Doxygen 中评论 ucf 文件

> ID：15024618
> 
> 赞同：2
> 
> 时间：2013-02-22T12:47:47.640
> 
> 标签：document, doxygen, vhdl

我想使用 Doxygen 来记录一个 VHDL 项目。这对 VHDL 源文件按预期工作。但是，我也想添加 ucf（用户约束文件；Xilinx）。VHDL 注释指示符“--！” 显然行不通。UCF 文件可以使用哪些注释指示器？

```
# file constr.ucf
# brief my pinout...
net "sig1"  LOC = "P1"; # my signal 1
net "sig2"  LOC = "P2"; # my signal 2 
net "sig3"  LOC = "P3";  # my signal 3 
```

我在 doxygen 日志中看到，该文件一直在“读取”和“解析”。当我尝试在 HTML 输出中打开“约束”时，它会报告“找不到文件”。当我使用 EXTRACT_ALL 函数时，会生成文件。但是，评论不被认可！

这是我使用的配置文件：

```
#---------------------------------------------------------------------------
# Project related configuration options
#---------------------------------------------------------------------------
DOXYFILE_ENCODING      = UTF-8
PROJECT_NAME           = "My Project"
PROJECT_NUMBER         = 
PROJECT_BRIEF          = 
PROJECT_LOGO           = 
OUTPUT_DIRECTORY       = D:/projekte/doxyTest
CREATE_SUBDIRS         = NO
OUTPUT_LANGUAGE        = English
BRIEF_MEMBER_DESC      = YES
REPEAT_BRIEF           = YES
ABBREVIATE_BRIEF       = "The $name class" \
                         "The $name widget" \
                         "The $name file" \
                         is \
                         provides \
                         specifies \
                         contains \
                         represents \
                         a \
                         an \
                         the
ALWAYS_DETAILED_SEC    = NO
INLINE_INHERITED_MEMB  = NO
FULL_PATH_NAMES        = YES
STRIP_FROM_PATH        = 
STRIP_FROM_INC_PATH    = 
SHORT_NAMES            = NO
JAVADOC_AUTOBRIEF      = NO
QT_AUTOBRIEF           = NO
MULTILINE_CPP_IS_BRIEF = NO
INHERIT_DOCS           = YES
SEPARATE_MEMBER_PAGES  = NO
TAB_SIZE               = 4
ALIASES                = 
TCL_SUBST              = 
OPTIMIZE_OUTPUT_FOR_C  = NO
OPTIMIZE_OUTPUT_JAVA   = NO
OPTIMIZE_FOR_FORTRAN   = NO
OPTIMIZE_OUTPUT_VHDL   = YES
EXTENSION_MAPPING      = ucf=vhdl
MARKDOWN_SUPPORT       = YES
AUTOLINK_SUPPORT       = YES
BUILTIN_STL_SUPPORT    = NO
CPP_CLI_SUPPORT        = NO
SIP_SUPPORT            = NO
IDL_PROPERTY_SUPPORT   = YES
DISTRIBUTE_GROUP_DOC   = NO
SUBGROUPING            = YES
INLINE_GROUPED_CLASSES = NO
INLINE_SIMPLE_STRUCTS  = NO
TYPEDEF_HIDES_STRUCT   = NO
SYMBOL_CACHE_SIZE      = 0
LOOKUP_CACHE_SIZE      = 0

#---------------------------------------------------------------------------
# Build related configuration options
#---------------------------------------------------------------------------
EXTRACT_ALL            = NO
EXTRACT_PRIVATE        = NO
EXTRACT_PACKAGE        = NO
EXTRACT_STATIC         = NO
EXTRACT_LOCAL_CLASSES  = YES
EXTRACT_LOCAL_METHODS  = NO
EXTRACT_ANON_NSPACES   = NO
HIDE_UNDOC_MEMBERS     = NO
HIDE_UNDOC_CLASSES     = NO
HIDE_FRIEND_COMPOUNDS  = NO
HIDE_IN_BODY_DOCS      = NO
INTERNAL_DOCS          = NO
CASE_SENSE_NAMES       = NO
HIDE_SCOPE_NAMES       = NO
SHOW_INCLUDE_FILES     = YES
FORCE_LOCAL_INCLUDES   = NO
INLINE_INFO            = YES
SORT_MEMBER_DOCS       = YES
SORT_BRIEF_DOCS        = NO
SORT_MEMBERS_CTORS_1ST = NO
SORT_GROUP_NAMES       = NO
SORT_BY_SCOPE_NAME     = NO
STRICT_PROTO_MATCHING  = NO
GENERATE_TODOLIST      = YES
GENERATE_TESTLIST      = YES
GENERATE_BUGLIST       = YES
GENERATE_DEPRECATEDLIST= YES
ENABLED_SECTIONS       = 
MAX_INITIALIZER_LINES  = 30
SHOW_USED_FILES        = YES
SHOW_FILES             = YES
SHOW_NAMESPACES        = YES
FILE_VERSION_FILTER    = 
LAYOUT_FILE            = 
CITE_BIB_FILES         = 

#---------------------------------------------------------------------------
# configuration options related to warning and progress messages
#---------------------------------------------------------------------------
QUIET                  = NO
WARNINGS               = YES
WARN_IF_UNDOCUMENTED   = YES
WARN_IF_DOC_ERROR      = YES
WARN_NO_PARAMDOC       = NO
WARN_FORMAT            = "$file:$line: $text"
WARN_LOGFILE           = 

#---------------------------------------------------------------------------
# configuration options related to the input files
#---------------------------------------------------------------------------
INPUT                  = D:/projekte/doxyTest
INPUT_ENCODING         = UTF-8
FILE_PATTERNS          = *.c \
                         *.cc \
                         *.cxx \
                         *.cpp \
                         *.c++ \
                         *.d \
                         *.java \
                         *.ii \
                         *.ixx \
                         *.ipp \
                         *.i++ \
                         *.inl \
                         *.h \
                         *.hh \
                         *.hxx \
                         *.hpp \
                         *.h++ \
                         *.idl \
                         *.odl \
                         *.cs \
                         *.php \
                         *.php3 \
                         *.inc \
                         *.m \
                         *.markdown \
                         *.md \
                         *.mm \
                         *.dox \
                         *.py \
                         *.f90 \
                         *.f \
                         *.for \
                         *.vhd \
                         *.vhdl \
                         *.ucf \
                         *.v
RECURSIVE              = NO
EXCLUDE                = 
EXCLUDE_SYMLINKS       = NO
EXCLUDE_PATTERNS       = 
EXCLUDE_SYMBOLS        = 
EXAMPLE_PATH           = 
EXAMPLE_PATTERNS       = *
EXAMPLE_RECURSIVE      = NO
IMAGE_PATH             = 
INPUT_FILTER           = 
FILTER_PATTERNS        = 
FILTER_SOURCE_FILES    = NO
FILTER_SOURCE_PATTERNS = 
USE_MDFILE_AS_MAINPAGE = 

#---------------------------------------------------------------------------
# configuration options related to source browsing
#---------------------------------------------------------------------------
SOURCE_BROWSER         = NO
INLINE_SOURCES         = NO
STRIP_CODE_COMMENTS    = YES
REFERENCED_BY_RELATION = NO
REFERENCES_RELATION    = NO
REFERENCES_LINK_SOURCE = YES
USE_HTAGS              = NO
VERBATIM_HEADERS       = YES

#---------------------------------------------------------------------------
# configuration options related to the alphabetical class index
#---------------------------------------------------------------------------
ALPHABETICAL_INDEX     = YES
COLS_IN_ALPHA_INDEX    = 5
IGNORE_PREFIX          = 

#---------------------------------------------------------------------------
# configuration options related to the HTML output
#---------------------------------------------------------------------------
GENERATE_HTML          = YES
HTML_OUTPUT            = html
HTML_FILE_EXTENSION    = .html
HTML_HEADER            = 
HTML_FOOTER            = 
HTML_STYLESHEET        = 
HTML_EXTRA_STYLESHEET  = 
HTML_EXTRA_FILES       = 
HTML_COLORSTYLE_HUE    = 220
HTML_COLORSTYLE_SAT    = 100
HTML_COLORSTYLE_GAMMA  = 80
HTML_TIMESTAMP         = YES
HTML_DYNAMIC_SECTIONS  = NO
HTML_INDEX_NUM_ENTRIES = 100
GENERATE_DOCSET        = NO
DOCSET_FEEDNAME        = "Doxygen generated docs"
DOCSET_BUNDLE_ID       = org.doxygen.Project
DOCSET_PUBLISHER_ID    = org.doxygen.Publisher
DOCSET_PUBLISHER_NAME  = Publisher
GENERATE_HTMLHELP      = NO
CHM_FILE               = 
HHC_LOCATION           = 
GENERATE_CHI           = NO
CHM_INDEX_ENCODING     = 
BINARY_TOC             = NO
TOC_EXPAND             = NO
GENERATE_QHP           = NO
QCH_FILE               = 
QHP_NAMESPACE          = org.doxygen.Project
QHP_VIRTUAL_FOLDER     = doc
QHP_CUST_FILTER_NAME   = 
QHP_CUST_FILTER_ATTRS  = 
QHP_SECT_FILTER_ATTRS  = 
QHG_LOCATION           = 
GENERATE_ECLIPSEHELP   = NO
ECLIPSE_DOC_ID         = org.doxygen.Project
DISABLE_INDEX          = NO
GENERATE_TREEVIEW      = NO
ENUM_VALUES_PER_LINE   = 4
TREEVIEW_WIDTH         = 250
EXT_LINKS_IN_WINDOW    = NO
FORMULA_FONTSIZE       = 10
FORMULA_TRANSPARENT    = YES
USE_MATHJAX            = NO
MATHJAX_FORMAT         = HTML-CSS
MATHJAX_RELPATH        = http://cdn.mathjax.org/mathjax/latest
MATHJAX_EXTENSIONS     = 
SEARCHENGINE           = YES
SERVER_BASED_SEARCH    = NO
EXTERNAL_SEARCH        = NO
SEARCHENGINE_URL       = 
SEARCHDATA_FILE        = searchdata.xml
EXTERNAL_SEARCH_ID     = 
EXTRA_SEARCH_MAPPINGS  = 

#---------------------------------------------------------------------------
# configuration options related to the LaTeX output
#---------------------------------------------------------------------------
GENERATE_LATEX         = YES
LATEX_OUTPUT           = latex
LATEX_CMD_NAME         = latex
MAKEINDEX_CMD_NAME     = makeindex
COMPACT_LATEX          = NO
PAPER_TYPE             = a4
EXTRA_PACKAGES         = 
LATEX_HEADER           = 
LATEX_FOOTER           = 
PDF_HYPERLINKS         = YES
USE_PDFLATEX           = YES
LATEX_BATCHMODE        = NO
LATEX_HIDE_INDICES     = NO
LATEX_SOURCE_CODE      = NO
LATEX_BIB_STYLE        = plain

#---------------------------------------------------------------------------
# configuration options related to the RTF output
#---------------------------------------------------------------------------
GENERATE_RTF           = NO
RTF_OUTPUT             = rtf
COMPACT_RTF            = NO
RTF_HYPERLINKS         = NO
RTF_STYLESHEET_FILE    = 
RTF_EXTENSIONS_FILE    = 

#---------------------------------------------------------------------------
# configuration options related to the man page output
#---------------------------------------------------------------------------
GENERATE_MAN           = NO
MAN_OUTPUT             = man
MAN_EXTENSION          = .3
MAN_LINKS              = NO

#---------------------------------------------------------------------------
# configuration options related to the XML output
#---------------------------------------------------------------------------
GENERATE_XML           = NO
XML_OUTPUT             = xml
XML_SCHEMA             = 
XML_DTD                = 
XML_PROGRAMLISTING     = YES

#---------------------------------------------------------------------------
# configuration options for the AutoGen Definitions output
#---------------------------------------------------------------------------
GENERATE_AUTOGEN_DEF   = NO

#---------------------------------------------------------------------------
# configuration options related to the Perl module output
#---------------------------------------------------------------------------
GENERATE_PERLMOD       = NO
PERLMOD_LATEX          = NO
PERLMOD_PRETTY         = YES
PERLMOD_MAKEVAR_PREFIX = 

#---------------------------------------------------------------------------
# Configuration options related to the preprocessor
#---------------------------------------------------------------------------
ENABLE_PREPROCESSING   = YES
MACRO_EXPANSION        = NO
EXPAND_ONLY_PREDEF     = NO
SEARCH_INCLUDES        = YES
INCLUDE_PATH           = 
INCLUDE_FILE_PATTERNS  = 
PREDEFINED             = 
EXPAND_AS_DEFINED      = 
SKIP_FUNCTION_MACROS   = YES

#---------------------------------------------------------------------------
# Configuration::additions related to external references
#---------------------------------------------------------------------------
TAGFILES               = 
GENERATE_TAGFILE       = 
ALLEXTERNALS           = NO
EXTERNAL_GROUPS        = YES
PERL_PATH              = /usr/bin/perl

#---------------------------------------------------------------------------
# Configuration options related to the dot tool
#---------------------------------------------------------------------------
CLASS_DIAGRAMS         = YES
MSCGEN_PATH            = 
HIDE_UNDOC_RELATIONS   = YES
HAVE_DOT               = NO
DOT_NUM_THREADS        = 0
DOT_FONTNAME           = Helvetica
DOT_FONTSIZE           = 10
DOT_FONTPATH           = 
CLASS_GRAPH            = YES
COLLABORATION_GRAPH    = YES
GROUP_GRAPHS           = YES
UML_LOOK               = NO
UML_LIMIT_NUM_FIELDS   = 10
TEMPLATE_RELATIONS     = NO
INCLUDE_GRAPH          = YES
INCLUDED_BY_GRAPH      = YES
CALL_GRAPH             = NO
CALLER_GRAPH           = NO
GRAPHICAL_HIERARCHY    = YES
DIRECTORY_GRAPH        = YES
DOT_IMAGE_FORMAT       = png
INTERACTIVE_SVG        = NO
DOT_PATH               = 
DOTFILE_DIRS           = 
MSCFILE_DIRS           = 
DOT_GRAPH_MAX_NODES    = 50
MAX_DOT_GRAPH_DEPTH    = 0
DOT_TRANSPARENT        = NO
DOT_MULTI_TARGETS      = NO
GENERATE_LEGEND        = YES
DOT_CLEANUP            = YES 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:56:11.783

`#`是 UCF 文件中的注释指示符。

来自[Xilinx 约束指南](http://www.xilinx.com/support/documentation/sw_manuals/xilinx13_1/cgd.pdf)（第 32 页）：

> 要向 UCF 和 NCF 文件添加注释，请以井号 (#) 开始每个注释行，如下例所示。

```
# file TEST.UCF
# net constraints for TEST design
NET "$SIG_0 MAXDELAY" = 10;
NET "$SIG_1 MAXDELAY" = 12 ns; 
```

在您的 Doxygen 配置文件中，确保您设置了以下选项：

```
OPTIMIZE_OUTPUT_VHDL   = YES
EXTENSION_MAPPING      = ucf=vhdl 
```

并添加`*.ucf`到`FILE_PATTERNS`.

在您的 HTML 中，您现在应该在 Design Unit List 下有一个名为 Constraints 的选项卡，它显示了您的 UCF 的文档。

![在此处输入图像描述](../Images/3f72f8a3985f343f85ee5f1c555d633a.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T14:21:52.637

试试这个例子

```
#! file TEST.UCF
#! net constraints for TEST design
NET "$SIG_0 MAXDELAY" = 10;
NET "$SIG_1 MAXDELAY" = 12 ns; 
```

# c - 将毫秒转换为 GNU 端口的时间规范

> ID：15024623
> 
> 赞同：8
> 
> 时间：2013-02-22T12:48:08.470
> 
> 标签：c, linux, datetime, gnu, timespec

我想将毫秒转换为 GNU Linux 使用的 timespec 结构。我已经尝试过以下代码。

```
 timespec GetTimeSpecValue(unsigned long milisec)
  {
    struct timespec req;
    //long sec = (milisecondtime /1000);
    time_t sec = (time_t)(milisec/1000);
    req->tv_sec = sec;
    req->tv_nsec = 0;
    return req;
  } 
```

运行此代码会给我以下错误。

> 'GetTimeSpecValue' 之前应为 '='、','、';'、'asm' 或 '__attribute__'</p>

我还在代码中包含**time.h**文件。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-22T14:27:06.883

该`timespec`结构用两部分表示时间——秒和纳秒。因此，从毫秒转换的算法非常简单。一秒有千毫秒，一毫秒有千微秒，一微秒有千纳秒，感谢[SI](http://en.wikipedia.org/wiki/SI)。因此，我们首先需要将毫秒除以一千得到秒数。例如，1500 毫秒 / 1000 = 1.5 秒。给定整数算术（不是浮点数），余数被丢弃（即 1500 / 1000 仅等于 1，而不是 1.5）。然后我们需要取一个表示肯定小于一秒的毫秒数的余数，并将其乘以一百万以将其转换为纳秒。为了得到除以 1000 的余数，我们使用[模块运算符 ( `%`)](http://en.wikipedia.org/wiki/Modulo_operation) (即`1500 % 1000 is equal to 500`)。例如，让我们将 4321 毫秒转换为秒和纳秒：

1.  4321（毫秒）/1000 = 4（秒）
2.  4321（毫秒）% 1000 = 321（毫秒）
3.  321（毫秒）* 1000000 = 321000000（纳秒）

知道了以上，剩下的就是写一点C代码了。有几件事你没有做对：

1.  在 C 中，您必须在结构数据类型前面加上`struct`. 例如，不要说`timespec`你说`struct timespec`. 但是，在 C++ 中，您不必这样做（不幸的是，在我看来）。
2.  您不能从 C 中的函数返回结构。因此，您需要通过指针将结构传递给对该结构执行某些操作的函数。

编辑：这与（[从 C 中的函数返回一个“结构”](https://stackoverflow.com/questions/9653072/return-a-struct-from-a-function-in-c)）相矛盾。

好了，说够了。下面是一个简单的 C 代码示例：

```
#include <time.h>
#include <stdlib.h>
#include <stdio.h>

static void ms2ts(struct timespec *ts, unsigned long ms)
{
    ts->tv_sec = ms / 1000;
    ts->tv_nsec = (ms % 1000) * 1000000;
}

static void print_ts(unsigned long ms)
{
    struct timespec ts;
    ms2ts(&ts, ms);
    printf("%lu milliseconds is %ld seconds and %ld nanoseconds.\n",
           ms, ts.tv_sec, ts.tv_nsec);
}

int main()
{
    print_ts(1000);
    print_ts(2500);
    print_ts(4321);
    return EXIT_SUCCESS;
} 
```

希望能帮助到你。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T13:17:45.210

试试这个：

```
struct timespec GetTimeSpecValue(unsigned long millisec) {
    struct timespec req;
    req.tv_sec=  (time_t)(millisec/1000);
    req.tv_nsec = (millisec % 1000) * 1000000;
    return req;
} 
```

我不认为 struct timespec 是 typedef 的，因此您需要在 timespec 前面加上 struct。如果你想精确的话，计算出纳秒部分。请注意， req 不是指针。因此不能使用'->'访问成员

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-17T13:01:04.710

对答案进行了一些调整，包括 Geoffrey 的评论，下面的代码避免了小延迟的除法和长延迟的模数：

```
void msec_to_timespec(unsigned long msec, struct timespec *ts)
{
    if (msec < 1000){
        ts->tv_sec = 0;
        ts->tv_nsec = msec * 1000000;
    }
    else {
        ts->tv_sec = msec / 1000;
        ts->tv_nsec = (msec - ts->tv_sec * 1000) * 1000000;
    }
} 
```

# spring - 在不同数据库上使用 Spring jdbctemplate 进行 2 阶段提交

> ID：15024628
> 
> 赞同：1
> 
> 时间：2013-02-22T12:48:12.807
> 
> 标签：spring, jdbctemplate, 2phase-commit

我有以下要求，需要知道如何使用 Spring JDBCtemplate 实现 2 阶段提交。

1.  应用程序 (JAR) 将作为计划 JOB 独立运行。（无 Web 容器）
2.  我需要连接2个数据库。（数据库 1 和数据库 2）
3.  连接数据库 1 (Oracle)（选择 DATA）并存储在变量中。
4.  连接数据库 2 (postgresql)（更新/插入从数据库 1 收集的数据到数据库 2）。
5.  如果数据库 2 的事务成功，则
6.  连接数据库一并更新特定表中的标志。

请向我推荐示例工作代码或建议替代的快速方法。

问候，米希尔舒克拉。

# python - 友好的数字功能以某种方式中断

> ID：15024629
> 
> 赞同：-1
> 
> 时间：2013-02-22T12:48:16.813
> 
> 标签：python

[此功能是我解决 Project Euler Problem 21](https://projecteuler.net/problem=21)的开发尝试。 *评估 10000 以下的所有友好数字的总和。* 我正在使用一个模块 list_divisors()，它位于另一个文件中，应该可以正常工作。它应该对出现的问题没有影响。

```
def ami():
    storedSums = [0, 0]
    amiables = [0, 0]
    for i in range(2, 10000):
        som = sum(k for k in list_divisors(i))
        storedSums.append(som) if som < 10000 else 0
        for j in range(2, i - 1):

            #this if statement is the test.  It does not do anything except print what is happening.
            if (i > 5037 and j % 1000 == 0) or i < 10 or (i > 5038 and j > 5020):
                print("i = {}, j = {}, storedSums[i] = {}, storedSums[j] = {}, \
                len(storedSum) = {}".format(i, j, storedSums[i], storedSums[j], len(storedSums)))

            #The code freezes here at 5040
            if storedSums[i] == j and storedSums[j] == i:
                amiables.extend((i, j))
    return sum(i for i in amiables)

print(ami()) 
```

我的测试输出：

```
i = 4, j = 2, storedSums[i] = 3, storedSums[j] = 3, len(storedSum) = 5
i = 5, j = 2, storedSums[i] = 6, storedSums[j] = 3, len(storedSum) = 6
i = 5, j = 3, storedSums[i] = 6, storedSums[j] = 4, len(storedSum) = 6
i = 6, j = 2, storedSums[i] = 6, storedSums[j] = 3, len(storedSum) = 7
i = 6, j = 3, storedSums[i] = 6, storedSums[j] = 4, len(storedSum) = 7
i = 6, j = 4, storedSums[i] = 6, storedSums[j] = 3, len(storedSum) = 7
i = 7, j = 2, storedSums[i] = 8, storedSums[j] = 3, len(storedSum) = 8
i = 7, j = 3, storedSums[i] = 8, storedSums[j] = 4, len(storedSum) = 8
i = 7, j = 4, storedSums[i] = 8, storedSums[j] = 3, len(storedSum) = 8
i = 7, j = 5, storedSums[i] = 8, storedSums[j] = 6, len(storedSum) = 8
i = 8, j = 2, storedSums[i] = 11, storedSums[j] = 3, len(storedSum) = 9
i = 8, j = 3, storedSums[i] = 11, storedSums[j] = 4, len(storedSum) = 9
i = 8, j = 4, storedSums[i] = 11, storedSums[j] = 3, len(storedSum) = 9
i = 8, j = 5, storedSums[i] = 11, storedSums[j] = 6, len(storedSum) = 9
i = 8, j = 6, storedSums[i] = 11, storedSums[j] = 6, len(storedSum) = 9
i = 9, j = 2, storedSums[i] = 4, storedSums[j] = 3, len(storedSum) = 10
i = 9, j = 3, storedSums[i] = 4, storedSums[j] = 4, len(storedSum) = 10
i = 9, j = 4, storedSums[i] = 4, storedSums[j] = 3, len(storedSum) = 10
i = 9, j = 5, storedSums[i] = 4, storedSums[j] = 6, len(storedSum) = 10
i = 9, j = 6, storedSums[i] = 4, storedSums[j] = 6, len(storedSum) = 10
i = 9, j = 7, storedSums[i] = 4, storedSums[j] = 8, len(storedSum) = 10
i = 5038, j = 1000, storedSums[i] = 5052, storedSums[j] = 1140, len(storedSum) = 5039
i = 5038, j = 2000, storedSums[i] = 5052, storedSums[j] = 2236, len(storedSum) = 5039
i = 5038, j = 3000, storedSums[i] = 5052, storedSums[j] = 3860, len(storedSum) = 5039
i = 5038, j = 4000, storedSums[i] = 5052, storedSums[j] = 4268, len(storedSum) = 5039
i = 5038, j = 5000, storedSums[i] = 5052, storedSums[j] = 5140, len(storedSum) = 5039
i = 5039, j = 1000, storedSums[i] = 5040, storedSums[j] = 1140, len(storedSum) = 5040
i = 5039, j = 2000, storedSums[i] = 5040, storedSums[j] = 2236, len(storedSum) = 5040
i = 5039, j = 3000, storedSums[i] = 5040, storedSums[j] = 3860, len(storedSum) = 5040
i = 5039, j = 4000, storedSums[i] = 5040, storedSums[j] = 4268, len(storedSum) = 5040
i = 5039, j = 5000, storedSums[i] = 5040, storedSums[j] = 5140, len(storedSum) = 5040
i = 5039, j = 5021, storedSums[i] = 5040, storedSums[j] = 5022, len(storedSum) = 5040
i = 5039, j = 5022, storedSums[i] = 5040, storedSums[j] = 5110, len(storedSum) = 5040
i = 5039, j = 5023, storedSums[i] = 5040, storedSums[j] = 5024, len(storedSum) = 5040
i = 5039, j = 5024, storedSums[i] = 5040, storedSums[j] = 5071, len(storedSum) = 5040
i = 5039, j = 5025, storedSums[i] = 5040, storedSums[j] = 166, len(storedSum) = 5040
i = 5039, j = 5026, storedSums[i] = 5040, storedSums[j] = 5036, len(storedSum) = 5040
i = 5039, j = 5027, storedSums[i] = 5040, storedSums[j] = 5039, len(storedSum) = 5040
i = 5039, j = 5028, storedSums[i] = 5040, storedSums[j] = 5040, len(storedSum) = 5040
i = 5039, j = 5029, storedSums[i] = 5040, storedSums[j] = 5077, len(storedSum) = 5040
i = 5039, j = 5030, storedSums[i] = 5040, storedSums[j] = 5038, len(storedSum) = 5040
i = 5039, j = 5031, storedSums[i] = 5040, storedSums[j] = 5091, len(storedSum) = 5040
i = 5039, j = 5032, storedSums[i] = 5040, storedSums[j] = 5101, len(storedSum) = 5040
i = 5039, j = 5033, storedSums[i] = 5040, storedSums[j] = 5041, len(storedSum) = 5040
i = 5039, j = 5034, storedSums[i] = 5040, storedSums[j] = 5040, len(storedSum) = 5040
i = 5039, j = 5035, storedSums[i] = 5040, storedSums[j] = 5113, len(storedSum) = 5040
i = 5039, j = 5036, storedSums[i] = 5040, storedSums[j] = 5039, len(storedSum) = 5040
i = 5039, j = 5037, storedSums[i] = 5040, storedSums[j] = 5064, len(storedSum) = 5040
Traceback (most recent call last):
  File "<string>", line 420, in run_nodebug
  File "F:\Programming\python\project euler\Amicable numbers.py", line 18, in <module>
    print(ami())
  File "F:\Programming\python\project euler\Amicable numbers.py", line 14, in ami
    if storedSums[i] == j and storedSums[j] == i:
IndexError: list index out of range 
```

当 i 变为 5040 时，任何尝试访问 storedSums[i] 都会导致索引超出范围错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T13:04:59.867

我认为问题出在这里：

```
storedSums.append(som) if som < 10000 else 0 
```

如果 som < 10000，这只会在列表中附加一些东西，否则它实际上什么都不做，所以你对索引长度的假设是错误的。

请参阅此测试程序：

```
test_list = []
for i in range(10):
    test_list.append(i) if i < 5 else 0
print test_list 
```

输出：

```
[0, 1, 2, 3, 4] 
```

我想你想要这个：

```
 if som < 10000:
        storedSums.append(som)
    else:
        storedSums.append(0) 
```

# windows-phone-7 - 如何从 DDNS 主机名获取实际 IPAddr

> ID：15024630
> 
> 赞同：0
> 
> 时间：2013-02-22T12:32:36.427
> 
> 标签：windows-phone-7, windows-phone-8

我正在为我的 PC 使用 Dyndns 服务。这使我可以从我的 ISP 获取我的 PC 当前的 Wan IPAddr。

假设我可以使用下面的 WinForm 应用程序代码通过传入这个主机名示例来获取 IPAddr：Marina.dyndns.biz

```
公共静态无效DoGetHostEntry（字符串主机名）
{
    IPHostEntry 主机；

    主机 = Dns.GetHostEntry(主机名);

    Console.WriteLine("GetHostEntry({0}) 返回：", 主机名);

    foreach (IPAddress ip in host.AddressList)
    {
        Console.WriteLine("{0}", ip);
    }
}

```

我的 PC 链接到使用本地 ISP 服务的路由器。

Q1。这返回的 Wan IPaddr 是指我路由器的 External IPAddr 吗？

Q2。如果我为 PC 修复了一个 IPAddr，比如 192.168.1.90，该怎么办？那么返回的 IPAddr 指的是什么？

Q3。如何在 Windows Phone 7.1 Mango 版本中使用上述代码获取我的 PC 的 IPAddr？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:38:15.233

不久前，我使用了一个类似的服务，但是它将自己安装为服务并用于监控网络的变化。它应该工作的方式是调用其服务器并检查 ip 请求来自。

路由器本身具有广域网，并在内部使用局域网 IP 进行 NAT，以便通过广域网进行通信。

WAP IP 是 ISP 提供的外部路由器 IP

当您执行 Dns.GetHostEntry(hostname) 时，您将获得 192.168.1.90，这是您 PC 的 LAN IP..不是 WAN IP.. Dyndns 可以访问 WAN ip，但我们的代码/操作系统本身不能直接访问。

您无法从#WP& 访问/扫描其他设备的 IP 地址

# c++ - 重置/删除用 NR2 定义的向量或矩阵

> ID：15024634
> 
> 赞同：1
> 
> 时间：2013-02-22T12:48:36.427
> 
> 标签：c++, visual-c++, free

我在 Visual C++ 2008 的 MFC 应用程序项目中使用向量和矩阵（Vec_DP 和 Mat_DP，来自版本 2）的数值配方定义。我正在玩弄这些定义以了解它们是如何工作的，我想我明白了大多数情况下，但在我的程序中，我需要一个重置功能来“清除”所使用的向量和矩阵的内容。

我已经尝试过 delete(mat)、delete[] (mat)、free(mat)、mat.~NRMat()，但之前的工作都没有。我最初的解决方案是创建一个循环并将所有元素都归零，但它应该是一个更优雅的解决方案，有什么想法吗？

我的代码示例：

```
#include "stdafx.h"
#include <math.h>
#include <cmath>
#include <stdio.h>
#include "nrtypes.h"
#include "nrutil.h"

void TestFunc(Vec_I_DP &data);
void printVecDP(Vec_I_DP & v);
void printMatDP (Mat_I_DP & m);

Mat_DP mat(5,6);
Mat_DP mat2;
Mat_DP (*kktest);  

int main()
{
    DP v[] = {3.2, 8.2, 5.5, 2.1, 3.0};
    Vec_DP vdp(v, 5);
    Vec_DP vdp2; 

    vdp2 = vdp;
    cout << " Here's vdp: " << endl;
    printVecDP(vdp);
    cout << " Here's vdp2:" << endl;
    printVecDP(vdp2);

    TestFunc(vdp2);
    cout << " matrix:" << endl;
    printMatDP(mat);
    printMatDP(mat2);
    cout << " matrix2:" << endl;
    printMatDP(*kktest);

    /* none of this is working */
    //mat.~NRMat();  
    //~NRMat(mat);
    //delete[](mat);
    //free(mat);

    for (int i=0; i<mat.nrows(); i++){
        for (int j=0; j<mat.ncols(); j++){
            mat[i][j] = 0;
        }
    }

    cout << " matrix:" << endl;
    printMatDP(mat);
    printMatDP(mat2);
    cout << " matrix2:" << endl;
    printMatDP(*kktest);

    return 0;
}

void TestFunc(Vec_I_DP &data)
{
    int n, m, t=data.size();
    Vec_DP rsp = data;  
    for (n=0; n<t; n++)
        rsp[n] = data[n]*10.0;

    for (n=0; n<t; n++){
        for (m=0; m<6; m++){
            mat[n][m] = rsp[n];
        }
    }
    mat2=mat;
    kktest = &mat;
}

void printVecDP (Vec_I_DP & v)
{
    if (v.size() == 0) {
        cout << " In printVecDP: The vector is empty." << endl;
    }
    else {
        for (int i = 0; i < v.size(); i++) {
            cout << " v[" << i << "] = " << v[i] << endl;
        }
    }
    cout << endl;
}

void printMatDP (Mat_I_DP & m)
{
    if ((m.nrows() == 0) | (m.ncols() ==0)) {
        cout << " In printMatDP: The matrix is empty." << endl;
    }
    else {
        for (int i = 0; i < m.nrows(); i++) {
            for (int j = 0; j < m.ncols(); j++) {
                cout << " m["<<i<<"]"<<"["<<j<<"] = " << m[i][j];
            }
            cout << endl;
        }
    }
    cout << endl;
} 
```

PS：我会在 NR 论坛上提问，但我无法发布任何新帖子，要么是因为特权，要么是因为论坛已关闭新帖子。

# cakephp - cakephp缺少控制器错误

> ID：15024635
> 
> 赞同：0
> 
> 时间：2013-02-22T12:48:38.293
> 
> 标签：cakephp

我对 cakephp 很陌生。

我在工作区中有我的项目注册。我创建了一个`IndexController`，其中包含方法`index()`。

当我使用 workspace/registration/ 运行我的项目时，它显示以下错误：

> 错误：找不到 WorkspaceController。在以下文件中创建类 WorkspaceController：app/Controller/WorkspaceController.php。

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:49:43.940

我认为错误消息说明了一切；

在文件中创建以下类 WorkspaceController：

```
app/Controller/WorkspaceController.php 
```

基本上，使用默认路由，url 使用这个模式：

```
http://mysite.com/mycontroller/myaction/param1/param2/param... 
```

将被路由到：

```
MycontrollerController::myaction($param1, $param2); 
```

因此，使用您的 url，CakePHP 正在尝试执行：

```
WorkspaceController::registration() 
```

显然不存在

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-17T13:14:42.257

我收到了同样的信息。问题是代码没有被包裹在里面`<?php ... ?>`。所以基本上代码应该是这样的：

```
<?php
class PostsController extends AppController {
    public $helpers = array('Html', 'Form');

    public function index() {
        $this->set('posts', $this->Post->find('all'));
    }
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-30T18:26:18.893

您必须使用文件名`IndexController.php`代替`index_controller.php`或其他任何东西。我只是不知道为什么，但在我的情况下它工作正常，你的班级名称也应该是`IndexController`

# python - 如何创建内存中的图像

> ID：15024636
> 
> 赞同：1
> 
> 时间：2013-02-22T12:48:43.410
> 
> 标签：python, cairo

我想优化我的 cairo 绘图。我有一个不变的背景，在其上绘制了开罗图形。类的每个实例的背景可能不同，因此它不能是静态文件。要绘制背景，我想做这样的事情：

```
 if self.pixbuf is None:
        self.pixbuf = self.draw_background(cr, width, height)
        #self.pixbuf = gtk.gdk.pixbuf_new_from_file("/path/to/file.png")

    cr.set_source_pixbuf(self.pixbuf, 0, 0)
    cr.paint() 
```

这样我只创建一次背景，然后将其显示为图像并在其上绘制东西。这是为了节省时间，而不是在每次其他人更改时重新绘制整个不变的背景。注释掉的代码行工作正常，但我真的不想创建一个 png，将其保存到一个临时文件，然后加载该文件。这似乎是在浪费 IO。

我试过这个：

```
self draw_background (self, cr, width, height)
    pixbuf = gtk.gdk.Pixbuf(gtk.gdk.COLORSPACE_RGB, True, 8, int(width), int(height))

    cr.set_source_color(gtk.gdk.color_parse('black'))
    cr.set_line_width(2)
    cr.rectangle(0, 0, width, height)
    cr.stroke()

    cr.paint()
    return pixbuf 
```

但不显示背景。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T11:02:05.123

正如 Uli 指出的那样，您正在使用指向您的小部件的上下文作为目标进行绘制，而不是您的 pixbuf。要为 pixbuf 创建新的 cairo 上下文，请使用[cairo_create](http://developer.gnome.org/pygtk/stable/class-gdkdrawable.html#method-gdkdrawable--cairo-create)。画完后别忘了销毁它。

# jquery - JQuery 在 Firefox 中不起作用

> ID：15024644
> 
> 赞同：0
> 
> 时间：2013-02-22T12:49:07.293
> 
> 标签：jquery

我有一个 Jquery 函数，它在 Chrome 中有效，但在 Firefox 中无效，有谁知道，出了什么问题？

此函数用于使用默认值填充文本框。代码逻辑是正确的，因为它在 chrome 中可以正常工作。

```
$('#filler').change(function(){
//Logic here    
var Row = document.getElementById("node-0");
var Cells = Row.getElementsByTagName("td");
var size=(Cells[2].innerText);
var chr=document.getElementById("filler").value;    
var fillertxt="";
for (var i=0;i<size;i++)
{
  fillertxt+=chr+chr+" ";
}       
if(!/[0123456789abcdef]/ig.test(chr))
    {
         alert("Do use Hexadecimal characters!");   
    }
    else
    {
        $('#input').val(fillertxt);
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:58:33.833

Firefox 使用 W3C 兼容的`textContent`属性，而不是`innerText`Firefox 不支持的属性。

```
$('#filler').change(function(){
    //Logic here
    var Row   = $("#node-0"),
        Cells = Row.find("td"),
        size  = parseInt(Cells.eq(2).text(), 10),
        chr= $("#filler").val(),
        fillertxt="";

    for (var i=0; i < size ; i++) {
      fillertxt+=chr+chr+" ";
    }

    if(!/[0123456789abcdef]/ig.test(chr)) {
         alert("Do use Hexadecimal characters!");   
    }else{
         $('#input').val(fillertxt);
    }
}); 
```

此外，您似乎正在尝试在`for`循环中使用字符串作为迭代次数。您需要将其解析为数字，或者如果它是字符串长度，请使用`length`?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:55:42.247

由于您已经在使用 jQuery，您不妨一直使用它来确保跨浏览器兼容性。还要确保调用`.change`内部文档准备功能（这`$(function(){...})` 将确保）

```
$(function(){
    $('#filler').change(function(){
      var size = parseInt($("#node-0 td:nth-child(3)").text(),10),
          chr = $(this).val(),
          fillertxt="";

      for (var i=0;i<size;i += 1) {
        fillertxt+=chr+chr+" ";
      }

      if(!/[0123456789abcdef]/ig.test(chr)) {
        alert("Do use Hexadecimal characters!");   
      } else {
        $('#input').val(fillertxt);
      }
    });
}); 
```

# ruby-on-rails - Rails + Ember.js + 设计自由记者应用程序 - 数据范围

> ID：15024649
> 
> 赞同：2
> 
> 时间：2013-02-22T12:49:29.447
> 
> 标签：ruby-on-rails, devise, ember.js, ember-data, active-model-serializers

抱歉，我在 ember.js-land 待了这么久，我在摸索 Rails + active_model_serializers JSON api 基础知识。

因此，假设我是一名自由记者，正在构建一个应用程序，作者可以通过单个用户帐户将文章发布到不同的公司特定网站。

```
Rails Relationships

User has_many :company_memberships
User has_many :companies, :through => :company_memberships

Company has_many :company_memberships

Company_membership belongs_to :user
Company_membership belongs_to :company

Article belongs_to :company_membership
Article has_many :comments

Comment belongs_to :article 
```

我正在使用 Rails 3+、Devise、Active_Model_Serializers、Ember-Data 和 Ember.js。

我想设置一个流程，用户访问该站点，登录（非常容易使用设计）并被重定向到一个 Rails 页面，他可以在其中选择他想去的公司的仪表板（只需单击一个链接） .

现在是棘手的部分。当他单击特定公司的链接时，他应该被引导到一个 Rails 视图，该视图包含一个 ember 应用程序，其序列化范围设置为 current_company_membership 或 current_company 而不仅仅是 current_user。

如何创建一个 rails 或 active_model_serializers 方法，将数据范围仅限于 current_company_membership 指定的 current_company，然后将此数据传递给 ember 应用程序？

* * *

另外，作为奖励，我需要 current_user 的姓名和电子邮件地址 - 我如何将这些信息也传递给 ember 应用程序？我看过[这个花花公子的](http://say26.com/using-rails-devise-with-ember-js)文章，但是在尝试仅通过 company_membership 而不是 current_user 来确定数据范围时，无法使其正常工作。

任何帮助都是极好的！如果需要，我会添加更多细节和代码，但我觉得我在这里忘记了一些非常简单的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T11:22:31.643

**更新：**在答案底部描述的 ember 应用程序中访问 c​​urrent_user 和 current_company rails 方法的方法和[github 演示应用程序](https://github.com/blangslet/ember.js-rails-devise-demo)也已更新。

* * *

如果我正确理解您要执行的操作，以下是快速完成工作的一种方法。如果有人有更好的答案，请编辑我的问题。我在[github 上放了一个 ember + rails + devise 演示应用程序](https://github.com/blangslet/ember.js-rails-devise-demo)，它结合了这个问题的答案和[我最后一个 ember.js stackoverflow 问题](https://stackoverflow.com/questions/14601092/ember-js-sorting-and-filtering-children-of-a-hasmany-relationship-in-parent-rout)，以表明一切正常。下面我使用模型 Post 而不是 Article，但它的概念基本相同。

1) 在 Rails Companies 视图中，在特定公司 link_to click 上，您应该将 company 变量传递给 rails 控制器操作，该操作将继续传递给应用程序帮助器方法以设置 current_company 的设计会话变量。

```
<% @companies.each do |company| %>
    <%= link_to 'Company Dashboard', set_current_company_company_path(:id => company) %>
<% end %>

class CompaniesController < ApplicationController

  def set_current_company
    session[:company_id] = params[:id]
    redirect_to assets_path 
  end
  ...
end

class ApplicationController < ActionController::Base
...
  helper_method :current_company

  def current_company
      @current_company ||= Company.find_by_id!(session[:company_id])
  end
...
end

App::Application.routes.draw do

resources :companies do
    member do
      get :set_current_company
    end
  end
... 
```

set_current_company 方法将设置 current_company 变量会话范围并将用户重定向到包含您的 ember 应用程序的 assets/index.html.erb rails 视图。

2) 您现在需要为要在 json api/ember 模型中使用的 current_company 的 Posts（和 Comments、Company_Memberships）限定 Rails api 数据，如下所示：

```
class PostsController < ApplicationController

 def index 
    @posts = Post.where(company_id: current_company.id)
    render json: @posts 
  end

def create
    @post = Post.new(params[:post].merge :company_id => current_company.id)

    respond_to do |format|
      if @post.save
         render json: @post, status: :created, location: @post
      else
    render json: @post.errors, status: :unprocessable_entity 
      end
    end
  end 
```

3）然后您应该以正常方式通过AMS将数据序列化到ember应用程序：

```
class PostSerializer < ActiveModel::Serializer
  attributes :id, :title, :body, :company_id, :user_id
  has_many :comments
end 
```

4) 然后到 ember 模型。

```
App.Post = DS.Model.extend({
  title: DS.attr('string'),
  body: DS.attr('string'),
  comments: DS.hasMany('App.Comment')
}); 
```

5) Ember 控制器、视图和模板应按预期运行。查看[演示应用程序](https://github.com/blangslet/ember.js-rails-devise-demo)以查看超级基本实现。

* * *

为了获得对 current_user 和 current_company 的访问权限，请使用[active_model_serializers 元数据序列化](https://github.com/rails-api/active_model_serializers#attributes)，然后使用[这个人的临时解决方案](https://stackoverflow.com/questions/14322945/accessing-meta-information-passed-in-a-json-server-response/14357404#14357404)来映射您的序列化程序，以便它获取元数据并将其设置为您的 ember 应用程序中的全局变量。这可能不是最佳实践，但就目前而言，它可以完成工作。

1）首先，设置你的 store.js 从你的 json 中获取元数据并将其设置为序列化程序中的全局变量：

```
App.CustomRESTSerializer = DS.RESTSerializer.extend({
  extractMeta: function(loader, type, json) {
    var meta;
    meta = json[this.configOption(type, 'meta')];
    if (!meta) { return; }
    Ember.set('App.metaData', meta);
    this._super(loader, type, json);
  }
});

App.Store = DS.Store.extend({
  revision: 11,
  adapter:  DS.RESTAdapter.create({
    bulkCommit: false,
    serializer: App.CustomRESTSerializer
    }),
});

App.ready = function() {
  App.CompanyMembership.find();
} 
```

2）其次，在您的 rails company_memberships_controller.rb 呈现元数据：

```
render json: @company_memberships, :meta => {:current_user => current_user, :current_company => current_company} 
```

3) 最后，直接从您的模板中调用任何 current_user 或 current_company 属性：

```
Logged in with: {{App.metaData.current_user.email}}
<br>
Current Company: {{App.metaData.current_company.name}} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T08:15:17.123

只需覆盖序列化程序中的方法。

```
def custom_association
  # scope is the current user
  CustomObjects.ownedBy(scope)
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T14:53:33.277

我不确定我是否完全理解您的问题，但是：

您可以在控制器类定义（或 ApplicationController 基类）中设置序列化范围：

```
serialization_scope :current_company 
```

您还可以在实例化时将范围传递给序列化程序。因此，要返回 JSON `record`，您可以在控制器方法中执行此操作：

```
record.active_model_serializer.new(record, scope: current_company).as_json 
```

# c# - 如何在c#中从sql返回输出参数

> ID：15024654
> 
> 赞同：0
> 
> 时间：2013-02-22T12:49:44.147
> 
> 标签：c#, asp.net

大家好我在我的存储过程中定义了一个输出参数，我的sp如下

```
createproc [dbo].[convertempID](@empid int,@totcnt varchar(4) output)
as
begin
    select @totcnt = right('00000'+convert(varchar(6), empID), 4)
        from tblEmployee
        where empID = @empid;
end 
```

当我执行这个时，我得到了结果`0015`，`@totcnt`但是当我在我的 c# 代码中调用它时，我得到了`15`而不是`0015`有人能告诉我哪里出错了

```
cmd.CommandText = "convertempID";
cmd.CommandType = CommandType.StoredProcedure;
cmd.Parameters.AddWithValue("@empid", 15);
cmd.Parameters.Add(new SqlParameter("@totcnt", SqlDbType.Int));
cmd.Parameters["@totcnt"].Direction = ParameterDirection.Output;
cmd.ExecuteNonQuery();
sring ans = cmd.Parameters["@totcnt"].Value.ToString(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T12:51:20.270

这就是问题：

```
cmd.Parameters.Add(new SqlParameter("@totcnt", SqlDbType.Int)); 
```

将其与存储过程中的声明进行比较：

```
@totcnt varchar(4) output 
```

将参数类型更改为`SqlDbType.VarChar`，它应该可以工作。目前该值实际上是*整数*15 而不是字符串“0015”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T12:51:44.150

您已指定参数类型 as和for`Int`之间没有区别。将参数行更改为：`0015``15``Int`

```
cmd.Parameters.Add(new SqlParameter("@totcnt", SqlDbType.VarChar)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T12:53:06.680

返回值类型必须与类型匹配：

尝试更换

```
 cmd.Parameters.Add(new SqlParameter("@totcnt", SqlDbType.Int)); 
```

和

```
 cmd.Parameters.Add(new SqlParameter("@totcnt", SqlDbType.VarChar)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T12:56:45.170

将 totcnt 类型从 int 更改为 varchar

# sqlite - sqlite3 数据库是否独立于平台？

> ID：15024658
> 
> 赞同：1
> 
> 时间：2013-02-22T12:49:53.027
> 
> 标签：sqlite

我有在 Windows 中创建 sqlite3 数据库的情况，我希望他们在 Ubuntu 机器上处理它。当我尝试在 Ubuntu 中打开它们时：

```
sqlite3 dbname 
```

在控制台内，对于所有评论，我收到的错误消息为：

```
Error: malformed database schema (updateTimeStampActions) - no such table: main.actions 
```

如何在 Ubuntu 中处理数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T12:57:10.753

根据 Sqlite 网站，db 文件是平台无关的：

" SQLite 中的数据库是单个磁盘文件。此外，文件格式是跨平台的。在一台机器上创建的数据库可以复制并在具有不同架构的不同机器上使用。SQLite 数据库可跨 32- bit 和 64 位机器以及 big-endian 和 little-endian 架构之间的关系"

请点击链接：[http ://www.sqlite.org/onefile.html](http://www.sqlite.org/onefile.html)

你可以参考这个线程进行进一步的解释：[Sqlite data file on Linux and OS X incompatible?](https://stackoverflow.com/questions/5084037/sqlite-data-file-on-linux-and-os-x-incompatible)

# google-chrome - Firefox 无法更改 iframe。类似于沙盒

> ID：15024666
> 
> 赞同：0
> 
> 时间：2013-02-22T12:50:02.197
> 
> 标签：google-chrome, firefox, iframe, cross-domain, sandbox

我的页面上有 iframe。iframe 的 src 是来自另一个域的页面（我与他们进行了跨域通信）。当我打开 iframe 时，我需要用另一个页面更改它。对于 Chrome，我是这样做的：

```
 frames['iframe_id'].location.href=URL;
iframe.sandbox = 'allow-forms allow-scripts allow-same-origin'; 
```

我怎样才能在 Firefox 中做类似的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T10:10:31.427

解决了，简单的方法： var iframe = document.getElementsByName("id");
document.getElementById('id').src = URL;

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T09:10:57.840

解决了。Firefox 不需要沙盒之类的东西。

# python - 以字典格式显示文本文件数据

> ID：15024674
> 
> 赞同：3
> 
> 时间：2013-02-22T12:50:41.457
> 
> 标签：python, dictionary

我有一个文本文件（new.txt），其中包含如下数据：

```
{
    "String1": {
        "Value1": {"One":"a","Two":"b","Three":"c"},
        "Value2": {"One":"aa","Two":"bb","Three":"cc"},
         }

     "String2": {
         "Value1": {"One":"a1","Two":"b1","Three":"c1"},
         "Value2": {"One":"aa1","Two":"bb1","Three":"cc1"},
         }
} 
```

我想显示的值： String1,value1 是 {"One":"a","Two":"b","Three":"c"} String2,value2 和 One 是 "aa1"

怎么显示啊。。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:52:40.610

```
import ast
with open('new.txt') as f:
    d = ast.literal_eval(f.read())
print d['String2']['Value2']['One'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T12:59:55.317

它看起来像 json，但缺少一些重要部分。与下面相比，缺少一些“，”。是 new.txt 的复制粘贴还是一些手动格式错误？

```
{
    "String2": {
        "Value2": {
            "Three": "cc1", 
            "Two": "bb1", 
            "One": "aa1"
        }, 
        "Value1": {
            "Three": "c1", 
            "Two": "b1", 
            "One": "a1"
        }
    }, 
    "String1": {
        "Value2": {
            "Three": "cc", 
            "Two": "bb", 
            "One": "aa"
        }, 
        "Value1": {
            "Three": "c", 
            "Two": "b", 
            "One": "a"
        }
    }
} 
```

如果它应该是 json，用 python 处理很容易：

```
import json
with open('new.txt') as f:
    myjson = json.loads(f.read())
print myjson['String2']['Value2']['One'] 
```

不过，eumiro 答案中的 ast import 看起来很漂亮。

# selenium - 如果 Selenium-Test (Build-Task) 失败，则取消 Jenkins Post-Build-Task

> ID：15024681
> 
> 赞同：1
> 
> 时间：2013-02-22T12:50:58.707
> 
> 标签：selenium, jenkins, controls

在使用 ant 的 Build-Task 之后，我正在使用 SeleniumHQ-Plugin for Jenkins 运行一些 Selenium-Tests。在 Selenium-Tests 之后，Jenkins 正在运行一个 Post-Build-Task，它将测试的 Build 部署到服务器上。

现在，我想控制这个过程：

如果 Selenium-Tests 失败，Jenkins 不能执行 Post-Build-Task，否则 Jenkins 必须运行 Post-Build-Task。

Jenkins是否有一个选项或插件或其他东西，它提供了在构建任务失败时监听构建任务并控制构建后任务的功能？

最好的问候托马斯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:09:19.610

一种方法是创建单独的作业并将它们链接起来，在这种情况下，您可以根据当前作业的成功/失败来决定是否运行第二个作业。从逻辑上讲，测试和部署的运行是两个不同的工作，不是吗？您可以使用构建其他项目选项或使用[https://wiki.jenkins-ci.org/display/JENKINS/Parameterized+Trigger+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Parameterized+Trigger+Plugin)

# excel - 将日期导入excel，转换失败。语言/区域设置可能是原因

> ID：15024684
> 
> 赞同：1
> 
> 时间：2013-02-22T12:51:09.790
> 
> 标签：excel, date-formatting, regional-settings, csv-import

所以我在 Excel 中使用从文本函数获取外部数据。

我要导入的文件就是[这个](http://epguides.com/common/exportToCSV.asp?rage=3918)。

我只是将 url 粘贴到打开文件对话框中，就可以了。然后我通过导入向导，一切正常。我按下完成，excel 导入数据。

问题在于日期列：

```
.....,   26/Sep/05,  ...

.....,   03/Oct/05,  .... 
```

我在我的 excel 文件中得到的结果是：

`26.09.2005` => 正确转换为挪威格式

`03/Oct/05` => 完全没有转换

他们不会在我的 excel 文件中转换为正确的日期。我`DMY`在导入向导中选择了。但似乎我的计算机将区域设置设置为挪威语，无法将“Oct”识别为 10 月或第 10 个月的缩写。

在挪威语中，十月是“oktober”，缩写为“okt”而不是“oct”。对于具有与挪威语相同的短格式月份的日期，导入工作正常。那是一月，二月，三月，四月，六月，七月，八月，九月和十一月。

几个月十月十二月，我可能有这个问题。从英语到挪威语的缩写版本是 may=>mai、oct=>okt 和 dec=>des

有没有办法告诉excel“当你看到'Oct'时，只需将其视为'Okt'并做你的事情”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:57:12.927

[您可以使用Microsoft Office 中](http://office.microsoft.com/en-us/excel-help/change-the-default-language-setting-HP003088462.aspx)的语言工具更改办公应用程序的语言

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:59:46.887

我不认为您可以在导入期间设置任何内容，但是`find and replace`一旦导入数据，就没有什么可以阻止您执行的操作。

查找`/Oct/`并替换为`/Okt/`。您应该会发现 Excel 会立即识别出更新的单元格现在是日期格式。做一个宏来让每个月的查找和替换成为一项快速的工作并不难。

当然，如果您愿意，您可以暂时更改您的区域设置。

# c# - 如何在与金钱有关的情况下四舍五入

> ID：15024691
> 
> 赞同：0
> 
> 时间：2013-02-22T12:51:31.573
> 
> 标签：c#, rounding

我正在研究金钱，但我不知道该怎么做。那么，我该如何完善这些示例 - **22.32**到**20.00**或**156.32**到**150.00**或**23556.00**到**23550.00**

我正在实现此代码...

```
 class Program
    {
        static void Main(string[] args)
        {
            double a = 22.58;
            //double b = Math.Round(a, 0, MidpointRounding.AwayFromZero);//?
            //double b = Math.Floor(a + .5);//?
            Console.WriteLine(b.ToString());

            Console.ReadLine();
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:07:38.023

尝试：

```
class Program
{
    static void Main(string[] args)
    {
        decimal a = 22.58m;

        decimal rounded = Math.Floor(a / 10m) * 10m;

        Console.WriteLine("{0:0.00}", rounded);

        Console.ReadLine();
    }
} 
```

# android - EditTextPreference 的 Android 验证例程

> ID：15024692
> 
> 赞同：1
> 
> 时间：2013-02-22T12:51:36.220
> 
> 标签：android, button, dialog, listener

我是完成数字偏好验证例程的一小步。
如果条目不是数字，我替换了 ClickListener 上的 EditTextPrefernce OK 按钮以防止离开对话框。
我使用 TextWatcher.afterTextChanged 检查条目是否为数字，并将有效的评估放在 EditText 标记上。
一切正常，输入无效时按 OK 不会离开对话框，输入有效时按 OK...这里**我需要调用原始的 OK 按钮 onClick**，**但我没有找到如何操作**。 *有 View 函数 callOnClick() 和 performOnClick()，但我查看了它们的代码，它们旨在调用已安装的侦听器，而不是原始侦听器。*

```
@Override
public void onCreate(Bundle savedInstanceState) {
    Log.d(TAG, "+ onCreate(savedInstanceState:" + savedInstanceState + ")");
    super.onCreate(savedInstanceState);

    ...

    prefMaxLogs = (EditTextPreference) findPreference(getText(R.string.pref_maxLogs_key));
    prefMaxLogsEt = prefMaxLogs.getEditText();
    prefMaxLogsEt.setSingleLine();
    prefMaxLogsEt.setOnFocusChangeListener(ofcl);
    prefMaxLogsEt.addTextChangedListener(tw);

    ...

    Log.d(TAG, "- onCreate()");
}

private OnFocusChangeListener ofcl = new OnFocusChangeListener() {
    @Override
    public void onFocusChange(View v, boolean hasFocus) {
        Log.d(TAG, "+ onFocusChange(v:" + v + ", hasFocus:" + hasFocus + ")");
        if( hasFocus ) {
            prefMaxLogsEt.selectAll();
            Dialog dialog = prefMaxLogs.getDialog();
            if( dialog != null ) {
                dialog.findViewById(android.R.id.button1).setOnClickListener(ocl);
            }
        }
        Log.d(TAG, "- onFocusChange()");
    }
};

private OnClickListener ocl = new OnClickListener() {
    @Override
    public void onClick(View v) {
        Log.d(TAG, "+ onClick(v:" + v + ")");
        Boolean valid = !(Boolean) prefMaxLogsEt.getTag(R.string.invalidEntry);
        if( valid ) {
            Log.d(TAG, "Valid et");
        } 
        Log.d(TAG, "- onClick()");
    }
};

private TextWatcher tw = new TextWatcher() {
    @Override
    public void beforeTextChanged(CharSequence s, int start, int count, int after) {}
    @Override
    public void onTextChanged(CharSequence s, int start, int before, int count) {}
    @Override
    public void afterTextChanged(Editable s) {
        Log.d(TAG, "+ afterTextChanged(s:" + s + ")");
        String source = s.toString();
        //prefMaxLogsEt.removeTextChangedListener(this);
        if( !source.matches("^[0-9]+$") ) {
            prefMaxLogsEt.getBackground().setColorFilter(getResources().getColor(R.color.invalid), Mode.SRC_IN);
            prefMaxLogsEt.invalidate();
            prefMaxLogsEt.setError(getText(R.string.invalidEntry));
            prefMaxLogsEt.selectAll();
            prefMaxLogsEt.setTag(R.string.invalidEntry, true);
        } else {
            prefMaxLogsEt.setError(null);
            prefMaxLogsEt.getBackground().clearColorFilter();
            prefMaxLogsEt.invalidate();
            prefMaxLogsEt.setTag(R.string.invalidEntry, false);
        }
        //prefMaxLogsEt.addTextChangedListener(this);
        Log.d(TAG, "- afterTextChanged()");
    }
}; 
```

当 EditText 获得焦点时设置 onClickListener，因为我知道对话框已经显示。
onClickListener 防止对话框因无效条目而关闭

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:41:20.853

我找到了另一种验证 EditTextPreference 的方法。设置 OnPreferenceChangeListener 并实现 onPreferenceChange。

```
@Override
public boolean onPreferenceChange(Preference preference, Object newValue) {
    Log.d(TAG, "+ onPreferenceChange(preference:" + preference + ", newValue:" + newValue + ")");
    Boolean rv = true;
    if( preference.equals(prefMaxLogs) ) {
        String source = newValue.toString();
        if( !source.matches("^[0-9]+$") ) {
            rv = false;
        }
    }
    Log.d(TAG, "- onPreferenceChange()");
    return rv;
} 
```

此函数的优点是它返回一个布尔值，如果您接受更改，则返回 true，如果您拒绝更改，则返回 false。
我为 OK 按钮删除了 onFocusListener 和 onClickListener，这种方式更简单。
我仍然使用 setColorFilter 和 afterTextChanged 来警告用户输入无效。如果用户按 OK，对话框将关闭，但只接受有效值。

这个监听器是为每个首选项单独设置的，所以这是我在 onCreate() 中的初始化

```
 prefMaxLogs = (EditTextPreference) findPreference(getText(R.string.pref_maxLogs_key));
    prefMaxLogsEt = prefMaxLogs.getEditText();
    prefMaxLogsEt.setSingleLine();
    prefMaxLogsEt.addTextChangedListener(tcl);
    prefMaxLogs.setOnPreferenceClickListener(this); 
```

# git - TFS 客户端，GIT 后端？

> ID：15024695
> 
> 赞同：1
> 
> 时间：2013-02-22T12:51:40.470
> 
> 标签：git, tfs, visual-studio-2012

我们一直在使用 Subversion 来永远维护我们的 .Net 应用程序。管理层已决定将 TFS 强加给我们。但是，使用 GIT 作为我们的后端存储库可能还有一些回旋余地。随着即将到来的 VS2012 SP2，这似乎是一个选择。

我的问题是（我似乎无法从文档中收集到这一点）如果您使用 GIT 作为后端，使用 TFS 是否需要安装 TFS 服务器？如果答案是否定的，那么（从 VS 客户端的角度来看）交互是否与您拥有 TFS 后端大致相同？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T16:29:01.143

我真的不明白你在问什么......你不能使用没有 TFS 服务器的 TFS 客户端进行通信。

**VisualStudio**可以与任何 git 存储库通信。它不需要托管在 TFS 中，甚至不需要托管，它可以只是您机器上的本地存储库。但是，如果该 git 存储库不是由 TFS 托管，那么您将无法使用其他 TFS 功能，例如工作项跟踪。

**然而， Team Foundation Server**不仅仅是版本控制。如果您想利用 TFS 功能进行敏捷项目管理和工作项跟踪等工作，那么您将需要一个 TFS 客户端。如果要将 git 提交链接到工作项，则需要将该 git 提交保存在 TFS 的 git 存储库中。

听起来您在问是否可以使用 TFS，但不能使用 TFS 内置的版本控制。从技术上讲，答案是肯定的，但显然您将失去 TFS 中依赖于版本控制的任何功能。您将失去将工作项链接到 git 提交的能力（因此，失去快速识别修复错误的代码行的能力。）您将失去执行持续集成构建的能力（因此，您将失去能够识别哪个版本包含新功能或错误修复。）

如果这就是你要问的，那么这对我们来说可能不是技术问题，而是你的管理层的政策问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T13:14:43.257

安装了 Git vsix/toolkit 的 VS2012 将允许您使用任何 Git 服务器，包括托管的 TFS 服务，该服务现在支持 Git 存储库。Git 支持也将成为下一个主要本地 TFS 版本的一部分。

因此，如果您现在想通过带有 TFS 的 VS 客户端将 Git 用作您的存储库，那么唯一的选择是托管 TFS 服务或托管您自己的本地 Git 存储库。

更多链接

1.  [http://blogs.msdn.com/b/bharry/archive/2013/01/30/git-init-vs.aspx](http://blogs.msdn.com/b/bharry/archive/2013/01/30/git-init-vs.aspx)
2.  [http://visualstudiogallery.msdn.microsoft.com/abafc7d6-dcaa-40f4-8a5e-d6724bdb980c](http://visualstudiogallery.msdn.microsoft.com/abafc7d6-dcaa-40f4-8a5e-d6724bdb980c)
3.  [将 Git 与 Visual Studio 一起使用](https://stackoverflow.com/questions/507343/using-git-with-visual-studio)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:54:04.223

答案是肯定的，您需要安装 TFS 服务器才能使用 TFS 2012 SP2 中的新 Git 功能。

TFS 不仅仅是版本控制，它还是一个“应用程序生命周期管理”平台。这意味着您可以将它用于项目管理（瀑布和敏捷）、测试自动化、缺陷跟踪等等。传统的 TFS 版本控制是一个非常类似于 SVN 的中心化系统。所以本质上 TFS 是服务器，客户端只是调用构成 TFS 的各种 Web 服务的一种方式。

在 TFS 2012 SP2 中，MS 改进了与 Git 的集成，实际上您可以在 TFS 服务器“内部”托管一个 Git 存储库。在这种情况下，您仍然需要 TFS 服务器，但您的“主”Git 托管在 TFS 内。此功能已在“云”Team Foundation *Service*上可用。[此博客](http://blogs.msdn.com/b/visualstudioalm/archive/2013/01/30/getting-started-with-git-in-visual-studio-and-team-foundation-service.aspx)向您展示如何使用 Git 设置服务。它是免费的，因此您可以创建一个存储库并试一试，看看它是否满足您的需求。一旦 TF*Server* 2012 SP2 可用，我想它将以与当前 TF*Service* 相同的方式工作

# sbt - 用于测试的 Sbt 配置也不适用于仅测试

> ID：15024699
> 
> 赞同：1
> 
> 时间：2013-02-22T12:51:48.077
> 
> 标签：sbt

我在 Build.scala 文件中添加了一个用于运行测试的 java 选项：

```
javaOptions in Test += "-Dmy.config=something",
fork in test := true, 
```

这在我`sbt test`在我的项目中运行时应用。但是，如果我使用此 java 选项设置运行单个测试文件，`sbt test-only *Reports*`则不再考虑。

有人有线索吗？

# php - codeiginiter 设置会话错误

> ID：15024700
> 
> 赞同：0
> 
> 时间：2013-02-22T12:51:59.587
> 
> 标签：php, mysql, codeigniter, session

当验证用户的所有凭据时，我试图在控制器的 codeigniter 中设置一个会话。我的登录控制器方法中有此代码。方法 ' `login_check`' 由 form_validation 的 set rules 方法作为回调函数调用。我尝试了所有可能的方法，但由于某种原因，我无法设置会话，根据 CI 的手册，这应该是一项直接的任务

**注意：会话在 autoload.php 中自动加载**

```
 $this->form_validation->set_rules('password', 'password', 'trim|required|callback_login_check');

public function login_check($password) {
    $this->load->library('session');
    //Field validation succeeded.&nbsp; Validate against database
    $username = $this->input->post('username');
    $this->load->model('industry_person');

    //query the database
    $query = $this->industry_person->check_login($username, $password);

    if (!$query) {
        $this->form_validation->set_message('login_check', 'Invalid username or password');
        return false;
        $this->index();
    } else {
        $data = array(
            'username' => $username,
            'is_logged_in' => true
        );
        if (!$this->session->set_userdata('logged_in', $data))
            echo "error setting session";

    }
} 
```

当我输入正确的凭据并且它们在数据库中匹配时，我会收到输出为“**错误设置会话”。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:54:18.707

从 . 中删除单引号`$data`。它是一个数组变量。尝试这个，

```
if (!$this->session->set_userdata('logged_in', $data))
            echo "error setting session"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T12:56:57.717

因为`$data`是数组..试一试

```
if (!$this->session->set_userdata('logged_in', $data))
            echo "error setting session"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-17T08:24:41.457

在 codeigniter 中使用 session 是基于数组的，要在控制器构造函数中手动初始化 Session 类，请使用 $this->load->library 函数：

```
$this->load->library('session'); 
```

会话数组的一个有用方面是您可以将自己的数据添加到其中，并将其存储在用户的 cookie 中。你为什么想做这个？这是一个例子：

假设某个特定用户登录到您的网站。一旦通过身份验证，您可以将他们的用户名和电子邮件地址添加到会话 cookie 中，从而使您可以在全球范围内使用该数据，而无需在需要时运行数据库查询。

要将数据添加到会话数组中，需要将包含新数据的数组传递给此函数

```
$this->session->set_userdata($array); 
```

其中 $array 是一个包含新数据的关联数组。这是一个例子：

```
$newdata = array(
                   'username'  => 'johndoe',
                   'email'     => 'johndoe@some-site.com',
                   'logged_in' => TRUE
               );

$this->session->set_userdata($newdata); 
```

会话数组中的任何信息都可以使用以下函数获得：

```
$this->session->userdata('item'); 
```

例如：

```
if(!$this->session->userdata('logged_in')) {
    //do what you wanna do
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T13:08:01.557

当我更改 config.php 文件中的加密密钥时，我设法使它工作。之前涉及的加密密钥'_'和新的只有字母字符。

# mysql - 如何通过 mysqldump 命令进行 mysql 备份并影响生产服务器？

> ID：15024706
> 
> 赞同：0
> 
> 时间：2013-02-22T12:52:29.263
> 
> 标签：mysql, database

我已经编写了一个 shell 脚本，每天进行备份，但是每当它启动 mysql 时，它就会锁定数据库并且站点出现故障。

我不想影响实时服务器，因为站点可以访问不同的时区，所以不能在晚上进行备份

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:01:35.403

避免此问题的一种方法是设置[MySQL 复制](http://dev.mysql.com/doc/refman/5.0/en/replication.html)并使用从数据库进行备份。

优点是您可以获得数据库的完整复制，并且可以有效地进行热备份，无论数据库类型如何。但是，您确实需要另一个数据库服务器，并且有效地将存储容量翻倍（因为您正在维护数据库的另一个副本）

不是每个人的一杯茶，但仍然是一种选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:22:06.953

解决问题

mysqldump -u[user] -p[password] dbname --skip-lock-tables | gzip > soohoo_backup.sql.gz

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T12:58:24.987

如果您使用的是 MyISAM，您可以通知 MySQL 您不想使用`--lock-tables=false`. 如果您使用的是 InnoDB，您可以使用它`--single-transaction`来避免锁定。

[http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-11T09:04:03.730

您可以使用 ：

```
mysqldump -u [user] -p[password] [dbname] > dumpfile.sql 
```

# asp.net - 如何关闭活动的 SQL Server 连接？

> ID：15024712
> 
> 赞同：0
> 
> 时间：2013-02-22T12:52:52.557
> 
> 标签：asp.net, sql-server-2008

我在 dispose() 方法中使用以下代码

```
 Public Sub Dispose() Implements System.IDisposable.Dispose
            If Not IsDBNull(Command) And Not Command Is Nothing Then
                Dim tmpsqlcon As SqlConnection
                tmpsqlcon = Command.Connection
                Debug.Assert(Not IsDBNull(tmpsqlcon))
                SqlConnection.ClearPool(tmpsqlcon)
                tmpsqlcon.Close()
                Command.Dispose()
                tmpsqlcon.Dispose()
            End If
        End Sub 
```

并且每次在数据库操作中调用这个方法。但它仍然向我展示了太多的活动连接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:11:06.633

如果使用 using 语句连接到数据库，则不需要使用 dispose：

**例子：**

```
Dim queryString As String = _
    "SELECT OrderID, CustomerID FROM dbo.Orders;" 

Using connection As New SqlConnection(connectionString)
    Dim command As New SqlCommand(queryString, connection)
    connection.Open()

    Dim reader As SqlDataReader = command.ExecuteReader()

    ' Call Read before accessing data. 
    While reader.Read()
        Console.WriteLine(String.Format("{0}, {1}", _
            reader(0), reader(1)))
    End While 

    ' Call Close when done reading.
    reader.Close()
End Using 
```

这是您应该连接到数据库的方式。

更多信息：

[如何关闭asp.net中的sqlconnection](https://stackoverflow.com/questions/2850382/how-to-close-a-sqlconnection-in-asp-net)

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.close.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-2](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.close.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-2)

# json - Jersey 2.0-m2 中的 JSON 支持

> ID：15024718
> 
> 赞同：3
> 
> 时间：2013-02-22T12:53:07.003
> 
> 标签：json, maven, jersey, jackson, grizzly

（我在 Stackoverflow 上的第一篇文章，是 Maven 和 Jersey 的新手 ;-)

尝试开发一个独立的 jersey-JSON-application，我从最新的 mvn 原型开始

```
 mvn archetype:generate org.glassfish.jersey.archetypes:jersey-quickstart-grizzly2 
```

默认情况下，没有 JSON 支持。我设法在 Eclipse 中导入并运行它，然后看到“知道了！” 我的浏览器中的页面。JSON 支持可以（？）通过在 pom.xml 和 Main.java 中取消注释行来激活。因此，在使用 maven 生成的新项目中，我在 pom.xml 中激活了以下依赖项：

```
 <dependency>
        <groupId>org.glassfish.jersey.media</groupId>
        <artifactId>jersey-media-moxy</artifactId>
        <version>${jersey-version}</version>
    </dependency> 
```

...然后使用 mvn eclipse:eclipse 导入 Eclipse。然后在 Eclipse 中，编辑 Main.java 并取消注释以下行：

```
 rc.addBinder(org.glassfish.jersey.media.json.JsonJaxbBinder); 
```

这会导致以下编译错误：“org.glassfish.jersey.media 无法解析为变量”。

然后我被卡住了。我哪里做错了 ？

另外我想了解“JSON支持”是什么意思？在我基于 jersey-1.17 的程序的早期版本中，我设法在我的 Rest-resource 上使用 @Produces({ MediaType.APPLICATION_JSON}) 注释。在“引用库”中，我看到了四个杰克逊库。在新项目中，我没有看到任何杰克逊库。那是因为没有正确解决依赖关系吗？还是 jersey-2.0 不再使用 Jackson ？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T12:49:27.077

Main 类中的评论似乎完全具有误导性，因为：

*   jersey-media-moxy 不包括 org.glassfish.jersey.media.json.JsonJaxbBinder 类
*   ResourceConfig 没有 addBinder 方法（至少在当前 2.0-rc1 版本中）

无论如何，您仍然可以将 Jackson 与 Jersey 2.0 一起使用。只需包含对 jackson-jaxrs-json-provider 的依赖项：

```
<dependency>
    <groupId>com.fasterxml.jackson.jaxrs</groupId>
    <artifactId>jackson-jaxrs-json-provider</artifactId>
    <version>2.2.0</version>
</dependency> 
```

并注册 JacksonJaxbJsonProvider：

```
rc.register(JacksonJaxbJsonProvider.class); 
```

# node.js - Derby.js TypeError：对象函数（文件）

> ID：15024720
> 
> 赞同：0
> 
> 时间：2013-02-22T12:53:17.170
> 
> 标签：node.js, derbyjs

每次我尝试运行新项目附带的基本 server.js 时，都会出现以下错误：

```
node server.js

Master pid 5078
   info  - socket.io started
5079 listening. Go to: http://localhost:3000/

../node_modules/derby/node_modules/racer/lib/racer.server.js:115
  callback(err, value + ';' + browserify.bundle(options));
                                         ^
TypeError: Object function (files) {
    return new Browserify(files);
} has no method 'bundle'
    at racer.js (../node_modules/derby/node_modules/racer/lib/racer.server.js:115:46)
    at module.exports (../node_modules/derby/node_modules/racer/node_modules/socket.io-client/bin/builder.js:244:7)
    at fs.readFile (fs.js:176:14)
    at Object.oncomplete (fs.js:297:15) 
```

我尝试使用和不使用 -g 选项重新安装 node.js 和 derby，但总是遇到同样的问题。难道我做错了什么？

编辑：在 OSX 10.8.2 上使用 node.js 0.8.20 和 derby.js 0.3.14

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T18:40:10.457

我今天遇到了同样的问题。我不认为你做错了什么。[browserify](https://github.com/substack/node-browserify)的维护者发布了一个新版本，我认为它改变了它的 API。

我也是 derby 的新手，对 Javascript 也不是很精通。我确实设法解决了这个问题，至少现在通过侵入 {project_home}/node_modules/derby/node_modules/racer/package.json 并将 browserify 的版本更改回我曾经工作过的东西。

```
"browserify": "1.17.2", 
```

虽然不是一个长期的解决方案。

# delphi - cxgrid 禁止更改列的带

> ID：15024722
> 
> 赞同：0
> 
> 时间：2013-02-22T12:53:19.860
> 
> 标签：delphi, devexpress, tcxgrid

如何禁止更改列的波段？

我需要移动分组功能，但我不需要更改列的波段。所以我不能改变列选项中的移动属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:27:00.230

您是否尝试影响您乐队的 Options/HoldOwnsColumsOnly ？

它适用于你的情况。

# ssl-certificate - 证书到期日期检查

> ID：15024727
> 
> 赞同：0
> 
> 时间：2013-02-22T12:53:32.417
> 
> 标签：ssl-certificate

当我们与服务器建立 HTTPS 连接时，如何检查连接内证书的到期日期：didReceiveAuthenticationChallenge 委托方法？

问候， 钱德里卡

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:58:15.840

Bhat - 它不是您问题的完整答案： [验证来自 https url 的证书信息](https://stackoverflow.com/a/6496278/502950)

它尚未被接受，但我认为这是您想要的。您可以使用它作为起点。

# c# - 为什么 IsClientScriptBlockRegistered 在调试模式下总是返回 false？

> ID：15024733
> 
> 赞同：1
> 
> 时间：2013-02-22T12:53:47.323
> 
> 标签：c#, asp.net

在后面的代码中，我有以下代码：

```
if (!Page.ClientScript.IsClientScriptBlockRegistered("Script1"))
   Page.RegisterClientScriptBlock("Script1", "<script type=\"text/javascript\">alert('test');</script>"); 
```

这段代码似乎工作正常，但是当我尝试调试时它`Page.ClientScript.IsClientScriptBlockRegistered("Script1")`总是返回`false`. 我什至打开了快速查看窗口，并能够在`_clientScriptBlock`.

知道这是为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-30T17:19:59.890

使用`GetType()`method 参数确保您隔离了正确的脚本块，如下所示：

```
if (!Page.ClientScript.IsClientScriptBlockRegistered(GetType(), "Script1"))
{
    Page.RegisterClientScriptBlock(GetType(), "Script1", 
        "<script type=\"text/javascript\">alert('test');</script>");
} 
```

# java - Java Android 错误“RSA 块的数据过多”

> ID：15024738
> 
> 赞同：1
> 
> 时间：2013-02-22T12:54:03.427
> 
> 标签：java, android, encryption, rsa

A 在我的 Android 项目中出现错误（RSA 加密/解密）。加密通过 OK，但是当我尝试解密加密文本时，出现错误：**"too much data for RSA block"**。

如何解决这个问题呢？

代码：

```
public String Decrypt(String text) throws Exception
{
    try{
        Log.i("Crypto.java:Decrypt", text);
        RSAPrivateKey privateKey = (RSAPrivateKey)kp.getPrivate();
        Cipher cipher = Cipher.getInstance("RSA/ECB/NoPadding");
            cipher.init(Cipher.DECRYPT_MODE, privateKey);
            byte[] cipherData = cipher.doFinal(text.getBytes());// <----ERROR: too much data for RSA block
            byte[] decryptedBytes = cipher.doFinal(cipherData);
            String decrypted = new String(decryptedBytes);

            Log.i("Decrypted", decrypted);

        return decrypted;
    }catch(Exception e){
        System.out.println(e.getMessage());
    }
    return null;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T13:14:12.030

您的问题是，`text`如果您想使用文本表示（`String`在您的情况下）传输密文（仅在您的代码中），则需要对密文进行编码/解码。

尝试在此站点上查找 base 64 编码，应该有很多关于它的信息。加密后编码，解密前解码。您还应该为纯文本指定特定的字符编码。

最后，您可能应该使用对称密码进行加密，并使用 RSA 加密对称密钥。否则，您可能会用完 RSA 计算中的空间，因为公钥无法加密大于其模数（密钥大小）的数据。

# prettyfaces - 使用路径参数 与漂亮面孔

> ID：15024740
> 
> 赞同：2
> 
> 时间：2013-02-22T12:54:05.037
> 
> 标签：prettyfaces, pretty-urls

典型 JSF 应用程序中的许多页面都是*动态*的，这意味着有一个*模板*视图可用于呈现给定类型的每个对象。对于这些页面，PrettyFaces 重写解决方案非常有效且轻松。一个示例是基于其 id 或其他唯一字段显示产品的 Web 应用程序。通常有一个与这样的显示相关的视图，比如`product.xhtml`，和一个视图参数，保存产品的唯一字段，比如`name`。

通过一个简单的设置，我们得到所有请求`/product.xhtml?name=exact-product-name`，例如重写为`/products/exact-product-name`：

网址映射：

```
<url-mapping id="viewProduct">
    <pattern value="/products/#{ name : productBean.name }" />
    <view-id value="/store/product.xhtml" />
    <action> #{ productBean.loadData } </action>
</url-mapping> 
```

风景：

```
<f:metadata>
    <f:viewParam id="name" name="name" required="true" />
</f:metadata> 
```

该模型：

```
public class ProductBean implements Serializable {

    private ProductService productService;

    private String name;

    private Product product;

    public String loadData() {
        if(!((name == null) || (name.equals(""))) {
            Product product = productService.findByName(name);
            this.product = product;
            return null;
        }
        return "error";
    }

} 
```

但是，也有许多具有*静态*数据的页面，它们没有以上述方式使用视图参数进行*模板化。*这些页面仅显示放入其中的内容。例如，可能有许多文章被创建为单独的视图（如`/pages/articles/article1.xhtml`等）。使用 PrettyFaces，我们需要创建与此类页面数量一样多的 URL 映射。但是，*实际上*这种行为也可以在一个 URL 映射中进行*模板化。*不幸的是，当前 PrettyFaces 版本不支持此功能。

PrettyFaces 框架的建议增强功能如下：

```
<url-mapping id="viewArticle">
    <pattern value="/articles/#{ articleName }" />
    <view-id value="/store/#{ articleName }.xhtml" />
</url-mapping> 
```

或者，使用`ArticleBean`（例如，包含两个字段：`articleName`和`articleId`，其中 name 在 id 字段的设置器中定义为唯一值）：

```
<url-mapping id="viewArticle">
    <pattern value="/articles/#{ articleId : articleBean.articleId }" />
    <view-id value="/store/#{ articleBean.articleName }.xhtml" />
</url-mapping> 
```

或者使用基于 EL 表达式的其他预定义依赖关系，该 EL 表达式又基于唯一对应关系。

我想强调这不会是 a因为 view-id 中没有不确定性： a和 a`DynaView`之间存在一对一的对应关系。`<pattern>``<view-id>`

您如何看待在 PrettyFaces 中实现此功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:34:06.007

我认为 Stackoverflow 不是讨论 PrettyFaces 提案的合适场所。你应该看看[PrettyFaces 支持论坛](http://ocpsoft.org/support/)。

您可以选择一些选项来实现这样的事情。恕我直言，您可以尝试执行此视图 DynaView。即使像您所写的那样，模式和视图 ID 之间存在一对一的关系。然而 dynaview 有一些问题，特别是在出站重写方面。

但是你应该看看[Rewrite](http://ocpsoft.org/rewrite/)，它是 PrettyFaces 的继承者。使用 Rewrite 实现这样的要求非常简单：

```
.addRule(Join.path("/articles/{articleName}").to("/store/{articleName}.xhtml")) 
```

看看 Rewrite 的[配置示例](http://ocpsoft.org/rewrite/examples/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T12:55:38.793

至于`pretty-config.xml`当前不支持此功能的设置，有一些解决方法可以实现此功能。我将在下面描述它们。

## 一个虚拟视图，`<f:event>`它根据虚拟 bean 中的视图参数处理到最终页面的导航。

网址映射：

```
<url-mapping id="viewArticle">
    <pattern value="/articles/#{ articleName : articleBean.articleName }" />
    <view-id value="/handle-article-redirection.xhtml" />
</url-mapping> 
```

查看`handle-article-redirection.xhtml`：

```
<f:metadata>
    <f:viewParam id="articleName" name="articleName" required="true" />
    <f:event type="preRenderView" listener="#{articleBean.handleRedirect}" />
</f:metadata> 
```

模型：

```
public class ArticleBean {

    private ArticleService articleService;

    private String articleName;

    private String articleUrl;

    public void handleRedirect() {
        if(!((articleName == null) || (articleName.equals(""))) {
            String url = articleName;
            //String url = articleService.getUrlForArticleName(articleName);
            //articleUrl = url;
            FacesContext.getCurrentInstance().getExternalContext().redirect("/" + url + ".xhtml");
            return null;
        }
        FacesContext.getCurrentInstance().getExternalContext().redirect("/home.xhtml");
    }

} 
```

## 一个有意义的动态视图，`<ui:include>`它基于 bean 值/视图参数将必要的页面内容作为片段导入。

网址映射：

```
<url-mapping id="viewArticle">
    <pattern value="/articles/#{ articleName : articleBean.articleName }" />
    <view-id value="/article.xhtml" />
</url-mapping> 
```

查看`article.xhtml`：

```
<f:metadata>
    <f:viewParam id="articleName" name="articleName" required="true" />
</f:metadata>
<h:head></h:head>
<h:body>
    <ui:include src="/#{articleBean.articleUrl}.xhtml" />
</h:body> 
```

模型：

```
public class ArticleBean {

    private ArticleService articleService;

    private String articleName;

    private String articleUrl;

    public void setArticleName(String articleName) {
        this.articleName = articleName;
        if((!(articleName == null)) || (articleName.equals("")) {
            articleUrl = articleName;
            //articleUrl = articleService.getUrlForArticleName(articleName);
        } else {
             articleUrl = null;
        }
    }

} 
```

## `DynaView`带有返回正确结果的方法的URL 映射。

网址映射：

```
<url-mapping id="viewArticle">
    <pattern value="/articles/#{ articleName : articleBean.articleName }" />
    <view-id value="#{articleBean.getViewPath}" />
</url-mapping> 
```

不需要额外的视图。

模型：

```
public class ArticleBean {

    private ArticleService articleService;

    private String articleName;

    private String articleUrl;

    public String getViewPath() {
        this.articleName = articleName;
        if(!((articleName == null) || (articleName.equals(""))) {
            articleUrl = articleName;
            //articleUrl = articleService.getUrlForArticleName(articleName);
            return articleUrl;
        }
        return "error";
    }

} 
```

## 从数据库加载页面数据的*模板*视图，因此这些页面不会有单独的视图。

网址映射：

```
<url-mapping id="viewArticle">
    <pattern value="/articles/#{ articleName : articleBean.articleName }" />
    <view-id value="/article.xhtml" />
    <action> #{ articleBean.loadData } </action>
</url-mapping> 
```

查看`article.xhtml`：

```
<f:metadata>
    <f:viewParam id="articleName" name="articleName" required="true" />
</f:metadata>
<h:head></h:head>
<h:body>
    <h:panelGroup>
        #{articleBean.content}
    <h:panelGroup>
</h:body> 
```

模型：

```
public class ArticleBean {

    private ArticleService articleService;

    private String articleName;

    private String articleUrl;

    private String content;

    public void loadData() {
        if(!((articleName == null) || (articleName.equals(""))) {
            articleUrl = articleName;
            //articleUrl = articleService.getUrlForArticleName(articleName);
            content = articleService.getContentForArticleName(articleName);
        } else {
             articleUrl = null;
             content = null;
        }
    }

} 
```

## 编写自定义`WebFilter`或`NavigationHandler`.

什么是最好的选择，好吧，这取决于。他们都有自己的优点和缺点。

# c# - 什么时候说发生了方法组转换是有效的？

> ID：15024743
> 
> 赞同：3
> 
> 时间：2013-02-22T12:54:20.547
> 
> 标签：c#, .net, delegates, method-group

因此，当可以安全地说发生方法组转换时，我并不真正相信。我们从上一篇文章中得到了这个多播委托：

```
public partial class MainPage : PhoneApplicationPage
{
public delegate void MyDelegate(int a, int b);
// Constructor
public MainPage()
{
    InitializeComponent();

    MyDelegate myDel = new MyDelegate(AddNumbers);
    myDel += new MyDelegate(MultiplyNumbers);
    myDel(10, 20);
}

public void AddNumbers(int x, int y)
{
    int sum = x + y;
    MessageBox.Show(sum.ToString());
}

public void MultiplyNumbers(int x, int y)
{
    int mul = x * y;
    MessageBox.Show(mul.ToString());
}
} 
```

我说只有当我们分配了一个重载的方法并且至少一个重载与委托匹配时，才会发生方法组转换。在这种情况下，没有方法组转换。

一位程序员同行说，如果你不认为 MyDelegate myDel = AddNumbers; （名称指问题）是方法组转换，那会是什么呢？

C# 语言规范：存在从方法组（第 7.1 节）到兼容委托类型的隐式转换（第 6.1 节）。给定一个委托类型 D 和一个被归类为方法组的表达式 E，如果 [...]

那么哪种观点是正确的呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T12:56:58.623

> 我说只有当我们分配了一个重载的方法时才会发生方法组转换

不，方法组转换不需要重载（通过多种方法）。

任何时候只要你有一个方法名，或者一个用目标限定的方法名（例如`MultiplyNumbers`or `foo.MultiplyNumbers`），那就是一个方法组。如果您要将其转换为委托实例，那就是方法组转换。

编辑：导致问题的规范部分在 7.1 中是这样的：

> 方法组，它是由成员查找 (7.4) 产生的一组重载方法。

该“重载方法集”可以是一组大小为 1 - 它仍然是一个方法组。

这得到了 7.6.5.1（方法调用）的支持——强调我的：

> 对于方法调用，调用表达式的主*表达式**必须*是方法组。方法组标识要调用的**一个方法**或一组重载方法，从中选择要调用的特定方法。

这清楚地表明，具有一个元素的方法组是一个有意义的概念。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T12:56:52.613

方法组转换与重载无关。不要被“方法*组*”所迷惑。这并不意味着它必须不止一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T12:58:12.743

您*已经*分配了一个方法，其中至少有一个重载与委托匹配 - 碰巧只有一个重载。“转换”的重点只是编译器可以推断出该`new MyDelegate`位，而不是您需要显式构造它。

# python - psycopg2 安装两个版本的python

> ID：15024748
> 
> 赞同：0
> 
> 时间：2013-02-22T12:54:43.390
> 
> 标签：python, psycopg2

我有一个全新的 debian 安装：
+ 安装了默认 2.6.6 python
+ 还安装了 python3 `/opt/python3/`
+ 安装了 psycopg2

问题：
`>>> import psycopg2`
适用于标准`python`
但不适用于备用 python `/opt/python3/bin/python3`。
我认为这是一个导入路径问题，但我不知道如何解决它作为 python 的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:15:39.423

您需要`psycopg2`单独安装 Python 3 安装。

您需要按照[安装说明从源代码安装](http://pythonhosted.org/psycopg2/install.html#install-from-source)，使用`pip`或`easy_install`将是最简单的（前提是您安装了`libpq-dev`debian 软件包）。

你*不能*重用系统安装的`psycopg2`，因为它只适用于 Python 2。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-16T20:12:43.073

我有同样的问题，安装 python3 包含文件对问题进行了排序（在活动的 virtualenv 中）

`sudo apt-get install python3-dev`根据这篇文章中提供的解决方案

[Psycopg2 无法在 python 3 上安装，pip 发出致命错误](https://stackoverflow.com/questions/21650567/psycopg2-fails-to-install-on-python-3-with-pip-issuing-a-fatal-error)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T16:38:37.660

因此，我回顾一下记录和任何遇到此问题的人
1\. 安装 virtualenv。[此处的说明](http://www.virtualenv.org/)
2\. 为您的版本安装 pip，在我的情况下，这里是 pip-3.3 [说明](https://stackoverflow.com/questions/10763440/how-to-install-python3-version-of-package-via-pip)，以便获取`distribute_setup.py`和`get-pip.py`
3\. 享受 `> pip-3.3 install psycopg2`

# ruby-on-rails - Rails 3“测试真相”单元测试在迁移混乱后失败

> ID：15024754
> 
> 赞同：0
> 
> 时间：2013-02-22T12:54:56.650
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, unit-testing, rails-activerecord

在 0.074964 秒、13.3398 次测试/秒、0.0000 次断言/秒内完成测试。

```
 1) Error:
test_the_truth(UserTest):
ActiveRecord::StatementInvalid: Mysql2::Error: Unknown column 'user_id' in 'field list': INSERT INTO `tickets` (`status`, `assignee`, `created_at`, `updated_at`, `id`, `project_id`, `user_id`) VALUES ('MyString', 1, '2013-02-22 12:40:19', '2013-02-22 12:40:19', 980190962, 64810937, 64810937)
    /usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:245:in `query'
    /usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:245:in `block in execute' 
```

我生成/搭建模型和一切。特殊的部分是我不记得表中有一个 user_id 列。此外，schema.db 和所有迁移也没有这样的东西。我的**工作区**中没有这样的字符串（user_id） rails 我的列应该如何命名？

显然，数据库中有一个列这样的东西，但它以某种奇怪的混乱方式得到了修复。

PS 如果我禁用与此表相关的固定装置，一切都很好。

发生了什么事，rails 从哪里读取这个列名，因为它显然不是来自我的工作区，也不是来自我的数据库或测试数据库。所以它可能将它存储在某个地方？有没有办法解决这个烂摊子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:17:03.597

一分钟后，我在 SO 中提问，我自己找到了答案，几个小时前一无所获。这总是发生在我身上。

答案正是 Rubyman 所评论的——应该修改固定装置以删除任何遗留信息！但它有点微妙 - 我的灯具中确实没有'user_id'列/字符串，因为我的工作区中没有它。但是，当我使用“belongs_to”和“has_many”时，它不会在模型和任何地方命名为“user_id”，它只会被命名为“user”。因此，我在夹具中搜索并找到了一个“用户”字段，必须将其删除以修复 SQL 中生成的错误“用户 ID”列名。

希望这可以帮助某人。

# selenium - Selenium WebDriver 放大/缩小页面内容

> ID：15024756
> 
> 赞同：27
> 
> 时间：2013-02-22T12:54:59.160
> 
> 标签：selenium, selenium-webdriver, zooming

如何在 Selenium WebDriver 中更改页面缩放级别？我试过：

```
driver.Keyboard().pressKey(Keys.Control);
driver.Keyboard().pressKey(Keys.Add); 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-02-22T13:25:41.777

请注意，Selenium 假定缩放级别为 100%！例如，当缩放级别不同时，IE 将拒绝启动（抛出异常），因为定位的元素取决于此，如果您更改缩放级别，它将在错误的位置单击错误的元素。

* * *

## 爪哇

您可以使用以下[`Keys.chord()`](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/Keys.html#chord%28java.lang.CharSequence...%29)方法：

```
WebElement html = driver.findElement(By.tagName("html"));
html.sendKeys(Keys.chord(Keys.CONTROL, Keys.ADD)); 
```

谨慎使用，完成后将缩放重置为 100%：

```
html.sendKeys(Keys.chord(Keys.CONTROL, "0")); 
```

* * *

## C＃

*（因为我意识到 C# 绑定没有该`Keys.chord()`方法）*

或者，您可以像这样使用[Advanced User Interactions API](http://docs.seleniumhq.org/docs/04_webdriver_advanced.jsp#advanceduserinteractions)（同样是 Java 代码，但它在 C# 中的工作方式应该相同）：

```
WebElement html = driver.findElement(By.tagName("html"));

new Actions(driver)
    .sendKeys(html, Keys.CONTROL, Keys.ADD, Keys.NULL)
    .perform(); 
```

同样，不要忘记之后重置缩放：

```
new Actions(driver)
    .sendKeys(html, Keys.CONTROL, "0", Keys.NULL)
    .perform(); 
```

* * *

请注意，天真的方法

```
html.sendKeys(Keys.CONTROL, Keys.ADD); 
```

**不起作用**，因为在此方法`Ctrl`中释放了密钥。`sendKeys()`的[`WebElement`与中`sendKeys()`](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebElement.html#sendKeys%28java.lang.CharSequence...%29)[的`Actions`](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/interactions/Actions.html#sendKeys%28java.lang.CharSequence...%29)不同。因此，`Keys.NULL`我的解决方案中使用的 是*必需*的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-04-15T00:49:37.893

**以下是使用Java**更改缩放级别的两种方法（一种用于 Chrome，另一种用于 Firefox）：

* * *

## 铬合金

当使用Selenium Java 客户端驱动程序的[v̲e̲r̲s̲i̲o̲n̲ ̲3̲.̲3̲.̲1](http://selenium-release.storage.googleapis.com/3.3/selenium-java-3.3.1.zip)和[C̲h̲r̲o̲m̲e̲D̲r̲i̲v̲e̲r̲ ̲2̲.̲2̲8](https://chromedriver.storage.googleapis.com/index.html?path=2.28/)时，以下工作（其中单引号中的数字表示要使用的缩放级别；1 = 10.%0%，等等。11） ：

```
JavascriptExecutor executor = (JavascriptExecutor)driver;
executor.executeScript("document.body.style.zoom = '1.5'"); 
```

* * *

## 火狐

缩放级别可以通过以下方式修改：
1\. 上述 Java 客户端驱动程序
2\. [G̲e̲c̲k̲o̲D̲r̲i̲v̲e̲r̲ ̲v̲0̲.̲1̲5̲.̲0](https://github.com/mozilla/geckodriver/releases/tag/v0.15.0)
3\. 这些类：
**java.awt.Robot**
**java.awt.event.KeyEvent**

首先，实例化 Robot 类：

```
Robot robot = new Robot(); 
```

此代码导致缩放级别*降低*：

```
robot.keyPress(KeyEvent.VK_CONTROL);
robot.keyPress(KeyEvent.VK_MINUS);
robot.keyRelease(KeyEvent.VK_CONTROL);
robot.keyRelease(KeyEvent.VK_MINUS); 
```

此代码导致缩放级别*增加*：

```
robot.keyPress(KeyEvent.VK_CONTROL);
robot.keyPress(KeyEvent.VK_EQUALS);
robot.keyRelease(KeyEvent.VK_CONTROL);
robot.keyRelease(KeyEvent.VK_EQUALS); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-07-17T18:57:11.957

Python 方法对我有用，但您必须指定缩放级别：

```
driver.execute_script("document.body.style.zoom='zoom %'") 
```

有 'zoom%' = 你想要的任何缩放级别。（例如“67%”）。这适用于 Chromedriver，它似乎不接受 send_keys 命令。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-09-05T11:29:08.363

**放大**| **缩小**功能开启`Windows`

放大

```
WebElement html = driver.findElement(By.tagName("html"));
html.sendKeys(Keys.chord(Keys.CONTROL, Keys.ADD)); 
```

缩小

```
html.sendKeys(Keys.chord(Keys.CONTROL, Keys.SUBTRACT)); 
```

* * *

**放大**| **缩小**功能开启`MAC`

放大

```
WebElement html = driver.findElement(By.tagName("html"));
html.sendKeys(Keys.chord(Keys.COMMAND, Keys.ADD)); 
```

缩小

```
html.sendKeys(Keys.chord(Keys.COMMAND, Keys.SUBTRACT)); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-11-25T09:45:58.080

## 最稳健的方法

*在开始使用 Internet Explorer 和 Selenium Webdriver 之前请考虑这两个重要规则。*

1.  缩放级别：应设置为默认（100%）和
2.  安全区域设置：对所有人都应该相同。应根据您的组织权限设置安全设置。

**这个怎么设置？**

只需转到 Internet Explorer，手动完成这两项工作。就是这样。没有秘密。

**通过您的代码执行此操作。**

**方法一：**

```
//Move the following line into code format
DesiredCapabilities capabilities = DesiredCapabilities.internetExplorer();

capabilities.setCapability(InternetExplorerDriver.IGNORE_ZOOM_SETTING, true);

System.setProperty("webdriver.ie.driver","D:\\IEDriverServer_Win32_2.33.0\\IEDriverServer.exe");

WebDriver driver= new InternetExplorerDriver(capabilities);

driver.get(baseURl);

//Identify your elements and go ahead testing... 
```

这绝对不会显示任何错误，并且浏览器将打开并导航到 URL。

但是这不会识别任何元素，因此您无法继续。

为什么？因为我们只是简单地抑制了错误并要求 IE 打开并获取该 URL。然而，只有当浏览器缩放为 100% 时，Selenium 才会识别元素。默认。所以最终的代码是

**方法2 稳健且全面的证明方式：**

```
DesiredCapabilities capabilities = DesiredCapabilities.internetExplorer();

capabilities.setCapability(InternetExplorerDriver.IGNORE_ZOOM_SETTING, true);

System.setProperty("webdriver.ie.driver","D:\\IEDriverServer_Win32_2.33.0\\IEDriverServer.exe");

WebDriver driver= new InternetExplorerDriver(capabilities);

driver.get(baseURl);

driver.findElement(By.tagName("html")).sendKeys(Keys.chord(Keys.CONTROL,"0"));
//This is to set the zoom to default value
//Identify your elements and go ahead testing... 
```

希望这可以帮助。如果需要更多信息，请告诉我。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-03-21T09:17:05.470

对于放大到 30%（或您希望的任何其他值，但在我的情况下为 30%），请使用

```
JavascriptExecutor jse = (JavascriptExecutor)driver;
jse.executeScript("document.body.style.zoom = '30%';"); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-06-02T07:46:33.090

我正在使用 Python 3.5。我遇到了和你一样的问题。我认为您必须使用 Chrome 作为浏览器。

我使用 PhantomJs 最终解决了这个问题：

```
from selenium.webdriver.common.keys import Keys
from selenium import webdriver
browser = webdriver.PhantomJS()
browser.get('http://www.*.com')
print(browser.title)
c=browser.find_element_by_tag_name("body")
c.send_keys(Keys.LEFT_CONTROL+Keys.Add)` 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-02-08T10:33:11.147

您可以使用“Keys.chord”方法进行缩小和放大

缩小

```
 WebElement zoomPage = driver.findElement(By.tagName("html"));
       zoomPage.sendKeys(Keys.chord(Keys.CONTROL, Keys.ADD)) 
```

当您完成工作并想将浏览器重置为 100% 时，请使用以下代码如果您想单击任何元素，因此在单击事件之前，您可以在单击后将浏览器窗口重置为 100%。

```
 zoomPage.sendKeys(Keys.chord(Keys.CONTROL, "0")); 
```

您也可以使用 Java 脚本代码进行 Zoom OUT

```
 JavascriptExecutor executor = (JavascriptExecutor)driver;
 executor.executeScript("document.body.style.zoom = '110%'"); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-02-18T11:49:41.993

似乎为 C# 提出的方法不再适用。

**在 WebDriver 2.5 版中适用于我的 C# 方法是：**

```
 public void ZoomIn()
        {
             new Actions(Driver)
                .SendKeys(Keys.Control).SendKeys(Keys.Add)
                .Perform();
        }

        public void ZoomOut()
        {
            new Actions(Driver)
               .SendKeys(Keys.Control).SendKeys(Keys.Subtract)
               .Perform();
        } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-15T02:43:39.793

我知道这已经很晚了，但是如果您不想使用操作类（或像我一样遇到任何错误），您可以使用纯 JavaScript 来执行此操作。

这是代码

```
((IJavaScriptExecutor) Browser.Driver).ExecuteScript("document.body.style.zoom = '70%';");
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-04-12T04:47:26.597

使用机器人类对我有用：

```
for(int i=0; i<3; i++){
        Robot robot = new Robot();
        robot.keyPress(KeyEvent.VK_CONTROL);
        robot.keyPress(KeyEvent.VK_MINUS);
        robot.keyRelease(KeyEvent.VK_CONTROL);
        robot.keyRelease(KeyEvent.VK_MINUS);
        } 
```

这将缩小 3 倍。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-11-17T15:43:21.280

2017 年 11 月 17 日更新

```
var html = page.FindElement(By.XPath("/html"));
html.SendKeys(Keys.Control + "0" + Keys.Control); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-11-17T01:49:03.443

你可以在[这里](https://www.edureka.co/community/52797/perform-zoom-zoom-out-actions-webpage-using-python-selenium)找到Selenium with Firefox 的解决方案。工作 100%。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-03-22T23:14:45.163

您可以使用 Selenium 的驱动程序来执行将为您放大或缩小的脚本。

**火狐**

```
await driver.executeScript('document.body.style.MozTransform = "scale(3)"');
await driver.executeScript(
  'document.body.style.MozTransformOrigin = "top"'
); 
```

这将导致放大 300% 并滚动到顶部。

**铬合金**

```
await driver.executeScript('document.body.style.zoom = "300%"'); 
```

# php - php - 在列中查找总数

> ID：15024759
> 
> 赞同：0
> 
> 时间：2013-02-22T12:55:08.593
> 
> 标签：php

我有一个日志`保存员工的日志记录（赚取的金额等），还有一个代码将数据分成按每个员工 ID 分组的表：

```
Empid: 0001
---------------------------
| Logid   | Hours   | Pay |
---------------------------
|  1001   | 10      | 50  |
---------------------------
|  1002   | 2       | 10  |
---------------------------

Empid: 0003
---------------------------
| Logid   | Hours   | Pay |
---------------------------
|  1003   | 3       | 9   |
---------------------------
|  1004   | 6       | 18  |
--------------------------- 
```

我用以下半伪代码管理这个：

```
$query = mysql_query("SELECT * FROM `log` ORDER BY empid");
$id = 0;

while ($list = mysql_fetch_assoc($query)) {
    if ($id != $list['logid']) {
          create header (Logid, Hours, Pay)
          $id = $list['logid'];
          }
    add each data row for the empid
} 
```

但是现在我想添加 Pay 列的总数，并将其放在每个 empid 的每个表的底部。

通过将代码 $total_pay = $total_pay + $list['pay'] 放在 while 循环中，我可以获得总工资，但我不知道如何在底部显示总工资。

非常感谢您对此提出任何建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T13:20:52.560

这应该这样做。你基本上总结，直到 id 发生变化。

```
$sum = 0;
while ($list = mysql_fetch_assoc($query)) {    
    if ($id != $list['logid']) {
          //create the totals using $sum !!!
          // after that re-set sum to 0
          $sum = 0;
          //create header (Logid, Hours, Pay)
          $id = $list['logid'];
    }
    $sum += $list['Pay'];
    //add each data row for the empid
} 
```

还...

[**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T13:37:00.207

有两种方法可以做到这一点。

## PHP

保持所有“支付”值的总和，并将其添加到底部的表格中。例如：

```
$i=0;
while ($list = mysql_fetch_assoc($query)) {   // for each row in your results
    if ($id != $list['EmployeeId']) {  // We only enter this loop if the EmployeeId doesn't equal $id. This can happen because either $id doesn't exist yet, or it doesn't match the previous EmployeeId
          $i++;  // increase $i by 1
          if($i>1) {  // Enter this loop only if $i is greater than or equal to 2 (if it is less than two, then this is our first time running this script, and adding a footer row wouldn't make any sense).
              create footer (EmployeeId, Hours, Pay);  // Log Id is irrelevant here
          }
          //  reset your variables here
          $id = $list['EmployeeId'];  // set $id = the first or the new Employee ID
          $total_pay = $list['pay'];  // This is our first time for this Employee, so don't just add it to the running total
          create header (EmployeeId, Hours, Pay) // Create the top half of your table
    } else {  // The EmployeeId has been established: we only need to change the running total
          $total_pay = $total_pay + $list['pay'];
    }
    //  add a data row for each LogId. This executes every time we go through the loop
    create_normal_row(LogId, EmployeeId, Hours, Pay)
}

// At this point, both Employees have a header, and all data rows. However, we left the loop before we could add the last Employee's footer row
// Let's add one more footer row for the last user
create_footer (Logid, Hours, Pay); 
```

## SQL

MySQL 有一个功能与您正在尝试做的事情非常相似，称为`ROLLUP`. 你可以在这里读更多关于它的内容：

[http://dev.mysql.com/doc/refman/5.0/en/group-by-modifiers.html](http://dev.mysql.com/doc/refman/5.0/en/group-by-modifiers.html)

基本上，您可以将查询更改为这样工作：

```
SELECT LogId, EmployeeId, SUM(Hours), SUM(Pay) FROM `log` 
GROUP BY empid, logid WITH ROLLUP 
```

此查询将返回如下所示的数据集：

```
---------------------------------------
| Logid   | EmployeeId| Hours   | Pay |
---------------------------------------
|  1001   | 1         | 10      | 50  |
---------------------------------------
|  1002   | 1         | 2       | 10  |
---------------------------------------
|  NULL   | 1         | 12      | 60  |
---------------------------------------
|  1003   | 2         | 3       | 9   |
---------------------------------------
|  1004   | 2         | 6       | 18  |
---------------------------------------
|  NULL   | 2         | 9       | 27  |
---------------------------------------
|  NULL   | NULL      | 21      | 87  |
--------------------------------------- 
```

无论何时`$list['Logid']`为空，您都知道您有一个“总计”行。不过要小心，这将在数据集的底部添加“所有员工的总和”行。如果`$list['EmployeeId']`为空，那么您知道您在此“总计”行中。

* * *

在相关说明中（我不确定这是否是您所要求的），您可以使用 HTML`<table>`元素在表格中显示这些内容。

每行看起来像这样：

```
<table> <!-- shown at the beginning of each table -->
<tr> <!-- shown at the beginning of each row -->
<td> <!-- shown at the beginning of each table cell -->
Your text goes here
</td> <!-- shown at the end of each table cell -->
<td>
More text can go here
</td>
</tr> <!-- shown at the end  of each row -->
</table> <!-- shown at the end of each table --> 
```

`<tr>`s 可以在每个`<table>`中无限重复，`<td>`s 可以在`<tr>`s 中重复。

# android-layout - 再添加一行

> ID：15024761
> 
> 赞同：0
> 
> 时间：2013-02-22T12:55:11.430
> 
> 标签：android-layout

我是 Android 开发人员。点击加号按钮时，我需要多一行。

对于 Ex（编辑联系人我们单击加号表示再添加一行，减号表示删除该行。只需给我 xml 布局和示例编码。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:11:44.820

为按钮创建一个 onClickListener()。然后通过引用您的 tableLayout

```
tblLayout = (TableLayout)findViewById(R.id.tableLayout); 
```

然后使用

```
TableRow = new TableRow(this);    
//Do something with this row
row.setText("...");

//add the row to the tblLayout
tblLayout.addView(row); 
```

# jquery - 插件加载不出来

> ID：15024764
> 
> 赞同：4
> 
> 时间：2013-02-22T12:55:15.153
> 
> 标签：jquery, .net, jquery-plugins, javascript

为什么我的插件加载不出来？引用了 jquery 和插件链接。该插件被称为.. .. 请帮助我找到我在代码中缺少的内容。

```
 <script src="~/Scripts/jquery-1.7.1.js"></script>
  <script src="~/Scripts/chosen.jquery.js"></script>

  <select class="chzn-select" tabindex="1" style="width:350px;" data- 
    placeholder="Choose a Country">
      <option value=""></option> 
      <option value="United States">United States</option> 
      <option value="United Kingdom">United Kingdom</option> 
      <option value="Afghanistan">Afghanistan</option> 
      <option value="Albania">Albania</option>                
   </select>

   <script>

   $(document).ready(function(){
       $(".chzn-select").chosen();
   });

   </script> 
```

我收到萤火虫错误：

> TypeError: $(...).chosen 不是函数

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T14:05:43.767

阅读评论并搜索相关问题，我发现原因是因为 jQuery 被包含两次。看看[这个](https://github.com/harvesthq/chosen/issues/200)。

我创建了这个[小提琴](http://jsfiddle.net/QAGMH/2/)，我从中选择了这个[cdn 服务](http://cdnjs.com/)。

如果 jquery 只包含一次

```
$(".chzn-select").chosen(); 
```

应该可以正常工作。

**编辑：**

而不是使用

```
$(document).ready(function(){
    $(".chzn-select").chosen();
}); 
```

尝试

```
$(document).bind("pageinit", function() {
    $(".chzn-select").chosen();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T13:07:10.363

您的 jquery 和/或选择的插件似乎没有加载。

尝试将它们替换为：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
<script src="/scripts/chosen.jquery.js" type="text/javascript"></script> 
```

通过从您的来源打开网址，还可以确保`chosen.jquery.js`确实包含在内。或者在 firebug 或任何其他开发人员控制台中检查您的网络选项卡。如果它显示 404，则您的脚本不在正确的位置。

还要确保您的页面布局是这样的

```
<html>
    <head>
        <!-- your css files -->
        <link/>
    </head>
<body>
    <!-- Your html above javascript includes-->
    <select>
    ....
    </select>
    <!-- Inlcude your js files at the bottom -->
    <script src="bla.js" />
    <script>
        //your inline javascript goes below includes

    </script>
</body> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T12:57:53.770

不要`~`在您的 html (aspx) 中使用。您只能在代码隐藏中使用它。改用就好`/scripts`了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-22T13:09:01.193

我认为 Archer 指出了正确的问题，但我对解决方案有另一个建议：使用[RegisterClientScriptInclude](http://msdn.microsoft.com/en-us/library/kx145dw2.aspx) ( [example](http://msdn.microsoft.com/en-us/library/kx145dw2.aspx#exampleToggle) )

```
public void Page_Load()
{
    var pageType = this.GetType();
    ClientScriptManager cs = Page.ClientScript;

    if (!cs.IsClientScriptIncludeRegistered(pageType, "jQuery"))
        cs.RegisterClientScriptInclude(pageType, "jQuery", ResolveClientUrl("~/Scripts/jquery-1.7.1.js"));
    if (!cs.IsClientScriptIncludeRegistered(pageType, "jQuery.chosen"))
        cs.RegisterClientScriptInclude(pageType, "jQuery.chosen", ResolveClientUrl("~/Scripts/chosen.jquery.js"));
} 
```

这会将脚本标签放置在您的页面标题元素中，这意味着您可以删除页面本身的引用。它主要用于避免在未知虚拟目录位置（在开发环境中通常是开发 Web 服务器下的目录）下托管时出现问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-22T13:09:43.353

这是因为您`chosen.jquery.js`在 JQuery 尝试检查您的路径之前正在加载，如果您使用简单的将 Js 文件从您的文件夹拖放到您的页面，那么您不必担心 `~`

# c# - 将值设置为隐藏输入

> ID：15024766
> 
> 赞同：2
> 
> 时间：2013-02-22T12:55:16.620
> 
> 标签：c#, javascript, asp.net

谁能告诉我我做错了什么。hiddenvalue 一直保持为空，没有为其分配任何值。

以下是代码；

**Java脚本**

这旨在发生在地图上的点击事件上

```
var str = "ryan";
document.getElementById("hiddenvalue").value = str; 
```

这是来自 asp.net

```
<div>
    <input id="hiddenvalue" type="hidden" value="" runat="server"/>
    <asp:Button ID="Button1" runat="server" Text="Button" onclick="Button1_Click" />
</div> 
```

这就是我从代码隐藏中引用它的方式：

```
using (NpgsqlCommand cmd = new NpgsqlCommand("insert into altitude select nextval('altitude_id_seq'), :value", conn)) {
    cmd.Parameters.Add(new NpgsqlParameter("value", NpgsqlDbType.Varchar));
    cmd.Parameters[0].Value = hiddenvalue.Value; 
    cmd.ExecuteNonQuery();
} 
```

由于某种原因，没有设置任何值。任何人都可以指导，因为我已经花了几个小时试图调试这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T12:56:23.367

如果您可以访问`hiddenvalue`后面的 on 代码，那么它是一个服务器端控件，您需要使用`ClientID`Javascript访问它

```
document.getElementById("<%= hiddenvalue.ClientID %>").value = str; 
```

或者你可以使用sepcify *（静态）*[`ClientIDMode Enumeration`](http://msdn.microsoft.com/en-us/library/system.web.ui.clientidmode.aspx) *`hiddenvalue`*

# javascript - 如何检查域

> ID：15024769
> 
> 赞同：0
> 
> 时间：2013-02-22T12:55:25.933
> 
> 标签：javascript

我使用 JavaScript 将特定内容插入页面。问题是必须为特定域加载此 iframe。我的意思是，就像在 GoogleMaps 中一样，您必须在其中插入特殊键才能为您的域加载地图。

简而言之，我想检查我的脚本是从哪里链接的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T12:59:19.900

如果您的页面不在同一个域上，则无法获取父属性，唯一的解决方案是检查文档引用者

```
var ref = document.referrer;
alert(ref); 
```

# php - 我的正则表达式不起作用

> ID：15024771
> 
> 赞同：0
> 
> 时间：2013-02-22T12:55:27.703
> 
> 标签：php, regex

我只是不明白，似乎正则表达式讨厌我。

我需要从 HTML 代码中获得一个简单的模式

我需要标签之间的单词。

出于某种原因，在 javascript 在线正则表达式工具中，它可以工作：

```
$pattern = '/<image>(.*?)<\/image>/'; 
```

我正在搜索的一个例子是这里：

```
<p>Die exakten Maße für die Gruppenmontage mit Bobilink sehen sie hier:</p>\r\n</td>\r\n<td>\r\n<p><image>classic_b montage link.jpg</image></p> 
```

但我只得到 Array() 的输出 我完整的 php 代码：

```
$zeilen = file('j25.sql'); 
$pattern = '/<image>(.*?)<\/image>/';
foreach ($zeilen as $zeile) {
    preg_match($pattern, $zeile, $matches);
}
echo '<h1>Matches</h1>';
print_r($matches); 
```

如果我没有准备好，请帮助我，这将毁掉整个周末。错误在哪里？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:14:21.930

如果您只想要标签之间的内容，则将其存储在 $matches[1] 中。在您的代码中，您分析的每一行都会删除 $matches。要获取结果数组，您应该使用其他变量：

```
$results = array();
foreach ($zeilen as $zeile) {
    if (preg_match($pattern, $zeile, $matches)) {
        $results[] = $matches[1];
    }
}
print_r($results); 
```

在你的表达中，你可以替换“*？” 通过“+”（表示一个或多个）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T13:01:49.470

问题不在于正则表达式......这有效：

```
<?php 
$zeile = "<p>Die exakten Maße für die Gruppenmontage mit Bobilink sehen sie hier:</p>\r\n</td>\r\n<td>\r\n<p><image>classic_b montage link.jpg</image></p>";

// $zeilen = file('j25.sql'); 
$pattern = '/<image>(.*?)<\/image>/';
// foreach ($zeilen as $zeile) {
    preg_match($pattern, $zeile, $matches);
// }
echo '<h1>Matches</h1>';
print_r($matches); 

 ?> 
```

要产生这个输出......

```
<h1>Matches</h1>Array
(
    [0] => <image>classic_b montage link.jpg</image>
    [1] => classic_b montage link.jpg
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T13:02:16.157

您在测试 php 文件中测试代码对我有用...

```
$testStr = '<p>Die exakten Maße für die Gruppenmontage mit Bobilink sehen sie hier:</p>\r\n</td>\r\n<td>\r\n<p><image>classic_b montage link.jpg</image></p>';
$pattern = '/<image>(.*?)<\/image>/';
preg_match($pattern, $testStr, $matches);
print_r($matches); 

//outputs:   Array ( [0] => classic_b montage link.jpg [1] => classic_b montage link.jpg ) 
```

您可以发布数据文件的内容吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T13:21:22.387

您的错误是`$matches`仅在文件的最后一行包含匹​​配项，因为它的值在循环的每次迭代中都会重新定义。您可以将`matches[1]`每行中的捕获组匹配添加到另一个数组中，如 Romains 回答中一样，或者使用以下命令：

```
$zeilen = file_get_contents('j25.sql'); 
$pattern = '/<image>(.*?)<\/image>/';
preg_match_all($pattern, $zeilen, $matches);

echo '<h1>Matches</h1>';
print_r($matches[1]); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-22T13:15:27.387

确保文件具有正确的服务器权限，以便 PHP 可以读取内容。

# php - 针对字符串匹配优化的数据库/数据源？

> ID：15024773
> 
> 赞同：6
> 
> 时间：2013-02-22T12:55:34.553
> 
> 标签：php, database, datasource, string-matching, database-performance

我想存储大量（约数千个）字符串并能够使用通配符执行匹配。

例如，这是一个示例内容：

*   `Folder1`
*   `Folder1/Folder2`
*   `Folder1/*`
*   `Folder1/Folder2/Folder3`
*   `Folder2/Folder*`
*   `*/Folder4`
*   `*/Fo*4`

（每一行也有额外的数据，比如标签，但匹配只针对那个键）

这是我想与数据匹配的示例：

*   `Folder1`
*   `Folder1/Folder2/Folder3`
*   `Folder3`

（`*`这里是通配符，可以是不同的字符）

我天真地考虑将它存储在 MySQL 表中并`%`在运算符中使用通配符`LIKE`，但 MySQL 索引仅适用于通配符左侧的字符，在我的情况下它可以在任何地方（即`%/Folder3`）。

所以我正在寻找一个可以从**PHP**使用的快速解决方案。我是开放的：它可以是一个单独的服务器，一个使用正则表达式文件的 PHP 库，......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T04:49:17.170

您是否考虑过使用 MySQL 的正则表达式引擎？尝试这样的事情：

`SELECT * FROM your_table WHERE your_query_string REGEXP pattern_column`

这将返回带有您的查询字符串匹配的正则表达式键的行。我希望它比运行查询以提取所有数据并在 PHP 中进行匹配的性能更好。

更多信息在这里：[http ://dev.mysql.com/doc/refman/5.1/en/regexp.html](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:38:30.977

如果您的字符串代表某种层次结构（就像在您的示例内容中一样），实际上不是“真实”文件，但您说您对替代解决方案持开放态度 - 为什么不考虑像基于文件的索引之类的东西？

*   选择一个新目录，例如`myindex`
*   使用字符串键作为位置和文件名为每个条目创建一个空文件`myindex`

现在您可以使用`glob`- 由于分层文件结构，glob 搜索应该比搜索所有数据库条目快得多。如果需要，您可以将结果与您的 MySQL 数据相匹配 - 由于您的 MySQL 索引在键上，此操作将非常快。

但是不要忘记更新MySQL 数据库中的结构`myindex`。`INSERT``UPDATE``DELETE`

这个解决方案只会在一个庞大的数据集（但不像@Kyle 提到的那样庞大）上竞争，它的层次结构相当深而不是宽。

**编辑** 对不起，只有当通配符在您的搜索词中而不是在存储的字符串本身中时，这才有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T20:07:57.627

我建议将密钥及其相关的有效负载读入按字母数字顺序排列的二叉树表示。如果您的密钥不是非常“聚集”，那么您可以避免（稍微额外的）开销构建平衡树。您还可以避免任何树维护代码，因为如果我正确理解您的问题，数据将经常更改，重建树而不是添加/删除/更新节点是最简单的。读入树的开销类似于执行初始排序，并且遍历树以搜索您的值是直接的，并且比仅针对一堆字符串运行正则表达式更有效。您甚至可能会在处理它时发现，您在树中的通配符会导致一些快捷方式来修剪搜索空间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T17:13:58.813

数据库不是进行此类搜索的正确工具。您仍然可以使用数据库（任何数据库和任何结构）来存储字符串，但是您必须编写代码才能在内存中进行所有搜索。从数据库中加载所有字符串（几千个字符串真的没什么大不了的），缓存它们并在它们上运行你的搜索\匹配算法。

您可能必须自己编写算法代码，因为标准工具对于您想要实现的目标来说太过分了，并且无法保证它们能够准确地实现您所需要的。

我将构建基于通配符的字符串的正则表达式表示，并在您的输入上运行这些正则表达式。在正确使用正则表达式之前，您可能需要做一些工作，但这将是最快的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-26T01:20:03.903

您可能想在很短的时间内使用多核方法来解决该搜索，我建议使用 FPGA 进行搜索和匹配，但这可能是最难的方法，考虑使用 CUDA 的[这篇文章](http://www.academia.edu/1350635/String_Matching_on_a_multicore_GPU_using_CUDA)，您可以进行搜索在 16 倍平时，在多核 CPU 系统中，您可以使用 posix 或计算机集群来完成这项工作（例如 MPI），您可以调用[Gearman](http://php.net/manual/en/book.gearman.php)服务以使用高级算法运行搜索。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-26T01:26:59.727

如果是我，我会两次存储关键字段......一次向前和一次反转（参见mysql的反向功能）。然后，您可以使用 left(main_field) 和 left(reversed_field) 搜索索引。如果字符串中间和开头有通配符（例如“*Folder1*Folder2”），它对您没有帮助，但是当您在开头或结尾有通配符时，它会帮助您。

例如，如果你想搜索 */Folder1 然后搜索 where left(reverse_field, 8) = '1redloF/'; 对于 Folder1/*/FolderX 搜索其中 left(reverse_field, 8) = 'XredloF/' 和 left(main_field, 8) = 'Folder1/'

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-28T10:40:27.477

由于通配符 (*) 在您的数据中而不是在您的查询中，我认为您应该从将数据分解为多个部分开始。您应该创建一个具有以下列的索引表：

```
dataGroup INT(11),
exactString varchar(100),
wildcardEnd varchar(100),
wildcardStart varchar(100), 
```

如果你有像“Folder1/Folder2”这样的值，将其存储在“exactString”中，并将主数据表中的值的ID分配给上述索引表中的“dataGroup”。

如果您有像“Folder1/*”这样的值，请将“Folder1/”的值存储到“wildcardEnd”，然后再次将主表中值的 id 分配给上表中的“dataGroup”字段。

然后，您可以使用以下方法在查询中进行匹配：

```
indexTable.wildcardEnd = LEFT('Folder1/WhatAmILookingFor/Data', LENGTH(indexTable.wildcardEnd)) 
```

这会将搜索字符串 ('Folder1/WhatAmILookingFor/Data') 截断为“Folder1/”，然后将其与 wildcardEnd 字段匹配。我认为 mysql 足够聪明，不会对每一行进行截断，而是从第一个字符开始并将其与每一行匹配（使用 B-Tree 索引）。

像“*/Folder4”这样的值将进入“wildcardStart”字段但相反。引用 Missy Elliot 的话：“值得吗，让我来做吧，我放下我的东西，翻转它，然后翻转它”（[http://www.youtube.com/watch?v=Ke1MoSkanS4](http://www.youtube.com/watch?v=Ke1MoSkanS4)）。所以在“wildcardStart”中存储一个“4redloF/”的值。然后像下面这样的 WHERE 将匹配行：

```
indexTable.wildcardStart = LEFT(REVERSE('Folder1/WhatAmILookingFor/Folder4'), LENGTH(indexTable.wildcardStart)) 
```

当然，您可以在应用程序逻辑中执行“REVERSE”。

现在关于棘手的部分。像“*/Fo*4”这样的东西应该分成两条记录：

```
# Record 1
dataGroup ==> id of "*/Fo*4" in data table
wildcardStart ==> oF/
wildcardEnd ==> /Fo

# Record 2
dataGroup ==> id of "*/Fo*4" in data table
wildcardStart ==> 4 
```

现在，如果您匹配某些内容，则必须注意数据组的每个索引记录都会返回完整匹配，并且不会发生重叠。这也可以在 SQL 中解决，但超出了这个问题。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-02-27T18:03:23.187

我不建议对 MySQL 中的大量数据进行文本搜索。您需要一个数据库来存储数据，但就是这样。对于搜索，请使用以下搜索引擎：

*   Solr ( [http://lucene.apache.org/solr/](http://lucene.apache.org/solr/) )
*   弹性搜索 ( [http://www.elasticsearch.org/](http://www.elasticsearch.org/) )
*   狮身人面像 ( [http://sphinxsearch.com/](http://sphinxsearch.com/) )

这些服务将允许您在眨眼之间进行各种时髦的文本搜索（包括通配符）；-)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-02-22T15:03:45.680

如果你运行`SELECT folder_col, count(*) FROM your_sample_table group by folder_col`，你会得到重复的 folder_col 值（即 count(*) 大于 1）吗？

如果没有，这意味着您可以生成一个可以生成有效 sphinx 索引的 SQL（请参阅[http://sphinxsearch.com/](http://sphinxsearch.com/)）。

# android - 将进度条附加到 android 活动

> ID：15024777
> 
> 赞同：1
> 
> 时间：2013-02-22T12:55:54.100
> 
> 标签：android, progress-bar

嗨，我有以下代码用于从 Andorid 手机读取联系人并将它们写入文件 - 我试图显示以下过程的进度是用于读取和写入联系人的代码

```
package com.lightcone.readcontacts;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.PrintWriter;

import android.app.Activity;
import android.content.ContentResolver;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.os.Environment;
import android.provider.ContactsContract;
import android.util.Log;
import android.widget.TextView;
import android.widget.Toast;

public class ReadContacts extends Activity {

    // To suppress notational clutter and make structure clearer, define some shorthand constants.

    private static final Uri URI = ContactsContract.Contacts.CONTENT_URI;
    private static final Uri PURI = ContactsContract.CommonDataKinds.Phone.CONTENT_URI;
    private static final String ID = ContactsContract.Contacts._ID;
    private static final String DNAME = ContactsContract.Contacts.DISPLAY_NAME;
    private static final String HPN = ContactsContract.Contacts.HAS_PHONE_NUMBER;
    private static final String CID = ContactsContract.CommonDataKinds.Phone.CONTACT_ID;
    private static final String PNUM = ContactsContract.CommonDataKinds.Phone.NUMBER;
    private static final String PHONETYPE = ContactsContract.CommonDataKinds.Phone.TYPE;
    private String id;
    private String name;
    private String ph[];
    private String phType[];
    private File root;
    private int phcounter;
    private TextView tv;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        tv = (TextView) findViewById(R.id.TextView01);

        // Allow for up to 9 email and phone entries for a contact
        ph = new String[9];
        phType = new String[9];

        // Check that external media available and writable
        checkExternalMedia();

        ContentResolver ctr = getContentResolver();
        Cursor cur = ctr.query(ContactsContract.Contacts.CONTENT_URI, null, null, null, null);
        int numberOfContacts = cur.getCount();
        Toast.makeText(this, "Reading" +String.valueOf(numberOfContacts)+ "Contacts", Toast.LENGTH_LONG).show();

        File dir = new File (root.getAbsolutePath() + "/download");
        dir.mkdirs();
        File file = new File(dir, "phoneData.txt");
        tv.append("Wrote " +numberOfContacts+" to "+file+"\nfor following contacts:\n");

        try{
            FileOutputStream f = new FileOutputStream(file);
            PrintWriter pw = new PrintWriter(f);

            ContentResolver cr = getContentResolver();
            Cursor cu = cr.query(URI, null, null, null, null);
            if (cu.getCount() > 0) {    

                // Loop over all contacts
                while (cu.moveToNext()) {   

                    id = cu.getString(cu.getColumnIndex(ID));
                    name = cu.getString(cu.getColumnIndex(DNAME));
                    tv.append("\n"+id+" "+name); 

                    phcounter = 0;
                    if (Integer.parseInt(cu.getString(cu.getColumnIndex(HPN))) > 0) {               
                        Cursor pCur = cr.query(PURI,  null, CID + " = ?",  new String[]{id}, null);
                        while (pCur.moveToNext()) {
                            ph[phcounter] = pCur.getString(pCur.getColumnIndex(PNUM));
                            phType[phcounter]  = pCur.getString(pCur.getColumnIndex(PHONETYPE)); 
                            phcounter ++;
                        } 
                        pCur.close();
                    }

                    // Write identifiers for this contact to the SD card file
                    pw.println("<nc>"+name);
                    for(int i=0; i<phcounter; i++){
                        pw.println("\tphone="+ ph[i]);
                    }
                }
            }       
            // Flush the PrintWriter to ensure everything pending is output before closing
            pw.flush();
            pw.close();
            f.close();       
        } catch (FileNotFoundException e) {
            e.printStackTrace();
            Log.i("MEDIA", "*************** File not found. Did you" +
                    " add a WRITE_EXTERNAL_STORAGE permission to the manifest file? ");
        } catch (IOException e) {
            e.printStackTrace();
        }   
    }   

    private void checkExternalMedia () {
        boolean mExternalStorageAvailable = false;
        boolean mExternalStorageWriteable = false;
        String state = Environment.getExternalStorageState();

        if (Environment.MEDIA_MOUNTED.equals(state)) {
            // We can read and write the media
            mExternalStorageAvailable = mExternalStorageWriteable = true;
        } else if (Environment.MEDIA_MOUNTED_READ_ONLY.equals(state)) {
            // We can only read the media
            mExternalStorageAvailable = true;
            mExternalStorageWriteable = false;
        } else {
            // Can't read or write
            mExternalStorageAvailable = mExternalStorageWriteable = false;
        }

        root = android.os.Environment.getExternalStorageDirectory(); 
        tv.append( "External storage: Exists="+mExternalStorageAvailable+", Writable="
            +mExternalStorageWriteable+" Root="+root+"\n");
    }

    private String getPhoneType(String index){
         if(index.trim().equals( "1")){
             return "home";
         } else if (index.trim().equals("2")){
             return "mobile";
         } else if (index.trim().equals("3")){
             return "work";
         } else if (index.trim().equals("7")){
             return "other";
         } else {
             return "?";
         }
    }  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:01:44.543

使用**AsyncTask**将联系人写入文件并在 AsyncTask 的 onPreExecute() 方法中显示进度条，并在**AsyncTask****的****onPostExecute** **()**方法中关闭进度。

# actionscript-3 - flash as3 以固定宽度绘制字符串

> ID：15024783
> 
> 赞同：0
> 
> 时间：2013-02-22T12:56:16.720
> 
> 标签：actionscript-3, flash

我想用固定的方式为精灵画一根绳子，并能够确定绳子占用的高度。为了让您更深入地了解，我将创建一个简单的气泡消息界面。所以我只想知道如何将字符串绘制到精灵（或任何您认为更合适的对象），能够控制宽度并获得最终高度。谢谢

更新：事实上，我不一定需要绘制字符串。我只需要创建那个界面。

更新 2：我尝试动态创建一个文本字段，但问题是我不知道如何确定它的高度！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:41:21.660

考虑这个样本：

```
var sp:Sprite = new Sprite();
var tf:TextField= new TextField();

sp.addChild(tf);

tf.multiline = true;
tf.text = "line 1 \n line 2 \n line 3";

trace(tf.textWidth); 
trace(tf.textHeight); 
```

您应该能够使用文本框的高度和宽度来调整外部精灵的大小。

# c# - 自定义复杂类型的 AutoMapper

> ID：15024784
> 
> 赞同：1
> 
> 时间：2013-02-22T12:56:18.167
> 
> 标签：c#, automapper, automapper-2

我有两种复杂类型：一种是作为 ViewModel 的服务层，另一种是在存储库层。它们的定义如下：

```
 //The Repository Layer 
public class ProductDetailsEntity
        {
            public Int64 StockNumber { get; set; }

            public String StockName { get; set; }

            public String Image { get; set; }

            public Decimal Price { get; set; }

            public String JewelleryName { get; set; }

            public String ShortDescription { get; set; }

            public Int64 ShippingDays { get; set; }

            public String DesignCode { get; set; }

            public List<SettingDetails> SettingsDetails { get; set; }

            public List<SideStoneDetails> SideStoneDetails { get; set; }
        }

 // The Service Layer 
public class ProductDetailsModel
    {
        public Int64 StockNumber { get; set; }

        public String StockName { get; set; }

        public String Image { get; set; }

        public Decimal Price { get; set; }

        public String JewelleryName { get; set; }

        public String ShortDescription { get; set; }

        public Int64 ShippingDays { get; set; }

        public String DesignCode { get; set; }

        public List<SettingDetailsModel> SettingsDetails { get; set; }

        public List<SideStoneDetailsModel> SideStoneDetails { get; set; }
    } 
```

具有 SettingsDetailsModel 以及 SettingDetails 为：

```
public class SettingDetails // same Structure with different Names
    {
        public Int64 AttributeId { get; set; }

        public String AttributeName { get; set; }

        public String AttributeValue { get; set; }

    } 
```

和 SideStoneDetailsModel 和 SideStoneDetails 为：

```
public class SideStoneDetailsModel
    {
        public Int64 SideStoneSettingId { get; set; }

        public String SideStoneSettingName { get; set; }

        public String SideStoneSettingValue { get; set; }
    } 
```

现在，在从实体映射到模型时，它抛出了一个 AutoMapper 异常，说明：

```
The following property on Repository.Entities.SettingDetails cannot be mapped: 
SettingsDetails
Add a custom mapping expression, ignore, add a custom resolver, or modify the destination type Service.Models.SettingDetailsModel.
Context:
Mapping to property SettingsDetails of type Repository.Entities.SettingDetails from source type Service.Models.SettingDetailsModel
Mapping to property SettingsDetails of type System.Collections.Generic.List`1[[Repository.Entities.SettingDetails, Repository, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] from source type System.Collections.Generic.List`1[[Service.Models.SettingDetailsModel, Service, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]
Mapping to type Repository.Entities.ProductDetailsEntity from source type Service.Models.ProductDetailsModel
Exception of type 'AutoMapper.AutoMapperConfigurationException' was thrown. 
```

现在，映射器实现包含

```
Mapper.CreateMap<SettingDetails, SettingDetailsModel>();
Mapper.CreateMap<SideStoneDetails, SideStoneDetailsModel>();
Mapper.CreateMap<ProductDetailsModel, ProductDetailsEntity>();
Mapper.AssertConfigurationIsValid(); 
```

基本上它的自定义类型列表失败了。我不明白哪里出了问题：到目前为止我发现的是：

*   为不同的类型添加单独的映射。查看 ！
*   自定义映射器函数 - 但为什么呢？在这种情况下，我不知道为什么要这样做？

我该如何解决？我想从 REPOSITORY Entity 映射到我的 VIEWMODEL

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:03:25.297

你真的是说这一行吗：

```
Mapper.CreateMap<ProductDetailsModel, ProductDetailsEntity>(); 
```

还是您想反过来创建地图？

```
Mapper.CreateMap<ProductDetailsEntity, ProductDetailsModel>(); 
```

我不确定您要映射哪个方向，但如果您*确实*想要前者，您将不得不定义一个从`SettingDetailsModel`back 到的地图`SettingDetails`，即：

```
Mapper.CreateMap<SettingDetails, SettingDetailsModel>(); 
```

# c++ - 如果的感觉 - 怎么可能有效

> ID：15024791
> 
> 赞同：0
> 
> 时间：2013-02-22T12:56:34.640
> 
> 标签：c++, if-statement, boolean, boolean-logic, boolean-operations

我正在看 Mojam（现场游戏编程，在[HumbleBundle](http://www.humblebundle.com/)上），我在那里看到了这段代码（[这里](http://puu.sh/26ySI)是代码的屏幕截图）我想知道最后一个 if 语句（即`!wasmoving && ismoving`）中的条件表达式如何计算为真（确实如此，程序员编译了它并且动画正在运行）。我已经在我的编译器中尝试过这个

```
#include <iostream>
#include <cstdlib>
using namespace std;
int main(){
    bool ismoving=5>0;
    bool wasmoving=ismoving;
    cout << "ismoving"<< ismoving << " oraz wasmoving " << wasmoving << endl;
    if (!wasmoving && ismoving) cout << "1st = true 2nd = true" << endl;
    system("PAUSE");
    return 0;
} 
```

当然，如果最后一个 if 采用错误的路径，则什么也不会发生。谁能解释屏幕截图中的代码是如何工作的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T13:00:14.370

请注意，在屏幕截图中，`ismoving`变量在复制到*后*`wasmoving`会更新，因此在评估条件时 的值很可能与 的值`ismoving`不同`wasmoving`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T13:03:13.953

您从屏幕截图中转换的代码不准确。您已更改操作的顺序。

与大多数主流编程语言一样，C++ 和 Java 是“命令式”语言。这意味着程序由一个接一个地执行的指令序列组成。当该代码执行时：

```
boolean wasJumping = isJumping;
isJumping = ...someCalculation...; 
```

这*首先*将 wasJumping 的值设置为 isJumping 的当前值，然后将 isJumping 的值*更改*为其他值。wasJumping 没有改变 - 它仍然具有从 isJumping 获取的旧值。

如果您来自数学背景，这可能会令人困惑。我发现将“wasJumping = isJumping”解读为“wasJumping*等于*isJumping”而不是“wasJumping 等于 isJumping”会有所帮助。前者强调它描述的是变量的*变化*，而不是描述两个值之间的永久关系。

# c++ - C++ 级联类型转换

> ID：15024796
> 
> 赞同：1
> 
> 时间：2013-02-22T12:56:50.760
> 
> 标签：c++, type-conversion, cascading

级联类型转换时如何使类型转换工作？

下面的代码应该很简单，但是从 TypeB 到 int 的转换需要编译器自动推导出两次类型转换。但事实并非如此。

我不能简单地实现 operator int() const { return val; 在 TypeB 类上，因为这应该是一个模板类而且我不知道要转换为哪种类型。

```
class TypeA {
public:
   TypeA( int a ) : val( a ) {}
   operator int () const { return val; }
private:
   int val;
};

class TypeB {
public:
   TypeB( TypeA a ) : val( a ) {}
   operator TypeA () const { return val; }
   // operator int() const { return val; }  // Explicit conversion to int which I can not know.
private:
   TypeA val;
};

void main() {
   TypeA a = 9;
   TypeB b = a;
   int int_a = a;
   TypeA a2 = b;
   int int_b = b;    // Compilation error: 
                     // No suitable conversion function from 'TypeB' to 'int' exists
} 
```

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:58:27.840

在任何隐式转换序列中*，最多允许一次*隐式用户定义转换。

不过，您可以说`int int_b = static_cast<TypeA>(b);`将 UDC 的数量减少到一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T13:07:04.273

所以你想`TypeB<T>`使用用户定义的转换`T`？

创建一个模板，该模板`operator U`使用 SFINAE 检查转换运算符`T`并接受何时`U`是一个类型`T`具有一个`operator U`for。

一个不充分但简单的方法是`std::is_convertible`--address of`T::operator U`可能更好。

这将需要 C++11 功能合理地执行，因为您将希望`enable_if`在默认模板参数中使用。

这是一个粗略的实现：我没有涵盖具有采用源类型的构造函数的目标类型。

```
#include <utility>
#include <type_traits>
#include <iostream>

struct A {
  operator int() { return 7; }
};

template<typename T>
struct unevaluated: std::true_type {};

template<typename T, typename U, typename=void>
struct has_user_defined_conversion:std::false_type {};

template<typename T, typename U>
struct has_user_defined_conversion<T, U,
  typename std::enable_if< unevaluated<
    decltype(
      &T::operator U
    )
  >::value >::type
>: std::true_type {};

template<typename T>
struct fake {
  T t;
  template<typename U,
    typename=typename std::enable_if<has_user_defined_conversion<T,U>::value>::type
  >
  operator U() { return t; }
};

int main() {
  int x = fake<A>();
  std::cout << x << "\n";
} 
```

# http - Apache2 安装 Ubuntu

> ID：15024798
> 
> 赞同：-1
> 
> 时间：2013-02-22T12:56:56.790
> 
> 标签：http, ubuntu, apache2

我在 Ubuntu 中设置我的 apache2 服务器时遇到问题。

我做了一个 sudo apt-get install 并且它安装正常。访问本地主机时，我能够看到该站点正在运行。

然后我不确定发生了什么，但我不再能够看到“它有效！” 网站。当我尝试重新启动 apache2 时，它返回：

```
Syntax error on line 17 of /etc/apache2/sites-enabled/000-default:
AddHandler requires at least two arguments, a handler name followed by one or more file extensions
Action 'configtest' failed. 
The Apache error log may have more information.
...fail! 
```

有任何想法吗？

这是我的 /etc/apache2/sites-enabled/000-default：

ServerAdmin webmaster@localhost

```
DocumentRoot /var/www
<Directory />
    Options FollowSymLinks
    AllowOverride None
</Directory>
<Directory /var/www/>
    Options Indexes FollowSymLinks MultiViews
    AllowOverride None
    Order allow,deny
    allow from all

    DirectoryIndex index.html index.py

    AddHandler mod_python.py
    PythonHandler mod_python.publisher
    PythonDebug On
</Directory>

ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
<Directory "/usr/lib/cgi-bin">
    AllowOverride None
    Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
    Order allow,deny
    Allow from all
</Directory>

ErrorLog ${APACHE_LOG_DIR}/error.log

# Possible values include: debug, info, notice, warn, error, crit,
# alert, emerg.
LogLevel warn

CustomLog ${APACHE_LOG_DIR}/access.log combined 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:04:12.370

你的配置文件有问题。尝试通过以下方式更改第 14 行：

```
AddHandler mod_python .py 
```

# java - 如何让 Play 中的资产控制器检测新图像？

> ID：15024801
> 
> 赞同：3
> 
> 时间：2013-02-22T12:57:02.220
> 
> 标签：java, playframework, playframework-2.0

似乎如果您在生产模式下运行 play，并且将任何新图像添加到 `public/images`目录中，则该`Assets.at()`方法不会检测到这些新图像，直到 Play 已停止并从控制台重新启动。

有没有办法强制资产控制器在生产模式下刷新/重新编译资产列表？还是我必须编写自己的控制器来提供图像？（如果是这样，是否已经编写了一个可以重复使用的代码？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T18:10:19.173

您必须为上传的图片编写自己的操作。

`Assets`控制器是一个提供**静态**资源的控制器，这些资源捆绑在您的应用程序中。

[您可以在此处](https://github.com/Ekito/mapMyCost-server/blob/master/app/controllers/Application.java#L164)找到一个非常简单（且技术含量较低）的用于检索图片的操作示例（我想您会明白的）。

# c# - MVC C# 希望我的查询能够返回空元素

> ID：15024802
> 
> 赞同：0
> 
> 时间：2013-02-22T12:57:07.323
> 
> 标签：c#, asp.net-mvc, entity-framework, entity, code-first

所以我有一个简单的代码行，我用它来检查数据库是否已经有数据，但是当它没有时，它会返回一个错误（说明在数据库中找不到任何东西）。

基本上我正在尝试获取它以便查询也可以返回null？这是我正在使用的代码：

```
 var ac = db.Houses.Single(d => d.address1 == reviewmodelview.Address1); 
```

所以你可以看到它非常简单，我将使用 ac 变量来运行一个 if 语句来查看它是否为 null 或有一个值。但是当它为空时，它会引发异常。我缺少一段代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T12:59:28.163

而不是`Single()`使用`FirstOrDefault()`应该做你想做的事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T13:02:46.607

*Try* `SingleOrDefault` - **如果结果集返回 0** **，它将返回*类型的默认值。***

```
 var ac = db.Houses.SingleOrDefault(d => d.address1 == reviewmodelview.Address1);

    if(ac == null)
    {
      // null check 
    } 
```

# android - 使 SQLDatabase 受限

> ID：15024804
> 
> 赞同：0
> 
> 时间：2013-02-22T12:57:12.007
> 
> 标签：android, database, sqlite

我正在制作一个可以记住用户单词的字典，但我想将单词列表限制在 100 个单词左右。我怎样才能限制这个单词列表？我试图找到一些信息来做到这一点，但似乎很难。请帮我！这是我的创建数据库方法：

```
 public class DataProvider extends SQLiteOpenHelper {

// Database Version
private static final int DATABASE_VERSION = 1;

// Database Name
private static final String DATABASE_NAME = "contactsManager";

// Contacts table name
private static final String TABLE = "contacts";

public DataProvider(Context context) {
    super(context, DATABASE_NAME, null, DATABASE_VERSION);
}

// Contacts Table Columns names
private static final String KEY_NAME = "name";
private static final String KEY_DECRIBED = "described";

@Override
public void onCreate(SQLiteDatabase db) {
    // TODO Auto-generated method stub
   String CREATE_CONTACTS_TABLE = "CREATE TABLE " + TABLE + "("
         +KEY_NAME + " TEXT,"
        + KEY_DECRIBED + " TEXT" + ")";
    db.execSQL(CREATE_CONTACTS_TABLE);
}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // TODO Auto-generated method stub
    db.execSQL("DROP TABLE IF EXISTS " + TABLE);

    // Create tables again
    onCreate(db);
}

public void addContact(Name contact) {
    SQLiteDatabase db = this.getWritableDatabase();

    ContentValues values = new ContentValues();
    values.put(KEY_NAME, contact.getName()); // Contact Name
    values.put(KEY_DECRIBED, contact.getDescribed()); // Contact Described

    // Inserting Row
    db.insert(TABLE, null, values);
    db.close(); // Closing database connection
}

 // Getting single contact
public Name getContact(int id) {
    SQLiteDatabase db = this.getReadableDatabase();

    Cursor cursor = db.query(TABLE, new String[] {
            KEY_NAME, KEY_DECRIBED },
            null, new String[] { String.valueOf(id) }, null, null, null, null);
    if (cursor != null)
        cursor.moveToFirst();

    Name contact = new Name(cursor.getString(0),
            cursor.getString(1));
    // return contact
    return contact;
}

public List<Name> getAllContacts() {
    List<Name> contactList = new ArrayList<Name>();
    // Select All Query
    String selectQuery = "SELECT  * FROM " + TABLE;

   SQLiteDatabase db = this.getWritableDatabase();
    Cursor cursor = db.rawQuery(selectQuery, null);

    // looping through all rows and adding to list
    if (cursor.moveToFirst()) {
         do {
            Name contact = new Name();

            contact.SetName(cursor.getString(0));
            contact.SetDescribed(cursor.getString(1));
            // Adding contact to list
            contactList.add(contact);
        } while (cursor.moveToNext());
    }

    // return contact list
    return contactList;
}

// Getting contacts Count
public int getContactsCount() {
    String countQuery = "SELECT  * FROM " + TABLE;
    SQLiteDatabase db = this.getReadableDatabase();
    Cursor cursor = db.rawQuery(countQuery, null);
    cursor.close();

    // return count
    return cursor.getCount();
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:12:17.277

您可以使用 a 找到最小 rowid

从联系人中选择最小值（ROWID）

表并取消它。然后你可以添加你的新词。或者如果你很懒，只需在 SQL 中使用“LIMIT 100”子句

# maven - Maven 没有将覆盖的属性传递给 ant

> ID：15024812
> 
> 赞同：1
> 
> 时间：2013-02-22T12:57:36.793
> 
> 标签：maven, ant, build, system-properties

目前在调用 ant 的 Maven 构建中遇到了一个奇怪的问题，在父 pom 中定义了以下属性：-

```
<jboss.home>${env.JBOSS_HOME}</jboss.home> 
```

我试图通过在运行 Maven 时传入 -Djboss.home 来覆盖它。

此构建包含一个配置文件，当激活调用 Ant 构建时：-

```
<ant antfile="build.xml" inheritRefs="true">
    <target name="all"/>
</ant> 
```

Ant 脚本使用以下属性：-

```
<property name="jboss.dir" value="${jboss.home}"/> 
```

随后输出它： -

```
<echo message="jboss dir is: ${jboss.dir}"/> 
```

问题是它输出的值是 ${env.JBOSS_HOME}

我可以从命令行覆盖父 pom 中的其他属性。

如果在 Maven 构建中的其他地方使用，即使 jboss.home 属性似乎也会被覆盖。

在尝试了各种命令组合之后，似乎传递给 Ant 的属性集是从 poms 解析的，然后是命令行的任何覆盖。如果我设置了 JBOSS_HOME 环境变量，那么使用这个变量的所有地方都有正确的值。

我是否缺少能够在命令行上覆盖此变量并在 Ant 脚本中使用覆盖值的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-08-23T17:53:26.787

今天偶然发现这个问题，并确实找到了答案。这个链接提供了一些背景： [http ://technotes.khitrenovich.com/properties-resolution-maven-implications-antrun-plugin/](http://technotes.khitrenovich.com/properties-resolution-maven-implications-antrun-plugin/)

如果属性在 <target> 内内联引用，Maven 属性将正常工作。例如：

```
 <execution>
      ..
      <configuration>
        <target>
          <echo message="Command-line override of external.property will work OK like this: ${external.property}"/>
        </target>
      </configuration>
    </execution>

```

但是，如果您使用这样编写的外部 ant 文件，许多/大多数属性将起作用，*但是*命令行覆盖不会传递到 ant 文件中。您将获得未覆盖的值。

```
 <execution>
      ..
      <configuration>
        <target>
          <property name="external.property" value="${external.property}" />
          <ant antfile="build.xml" target="all" />
        </target>
      </configuration>
    </execution>

```

相反，对于外部 ant 文件，请使用此语法。命令行值将正确传递到外部 antfile：

```
 <execution>
      ..
      <configuration>
        <target>
          <ant antfile="build.xml" target="all" >
            <property name="external.property" value="${external.property}" />
          <ant/>
        </target>
      </configuration>
    </execution>

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T14:47:56.837

问题是这`${env.JBOSS_HOME}`是一个系统环境变量，而您正在将系统属性传递给 JVM `-Djboss.home=...`。这是两个不同的东西。除此之外，Java 世界中的任何变量、参数等都是区分大小写的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T16:10:41.567

You seem do be doing all the right things, it works for me, I have made a working example with 2 pom.xml files. The parent pom looks like this:

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.stackoverflow.test</groupId>
        <artifactId>test</artifactId>
        <version>1.0</version>
    <name>Test</name>
    <packaging>pom</packaging>
    <modules>
        <module>test-ant-properties</module>
    </modules>
    <properties>
        <jboss.home>${env.JBOSS_HOME}</jboss.home>
    </properties>
</project> 
```

Then I created a module pom.xml in the sub-folder **test-ant-properties** that looks like this:

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <groupId>com.stackoverflow.test</groupId>
        <artifactId>test</artifactId>
        <version>1.0</version>
    </parent>
    <artifactId>test-ant-properties</artifactId>
    <name>Test maven ant properties</name>
    <profiles>
        <profile>
            <id>jboss</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-antrun-plugin</artifactId>
                        <version>1.6</version>
                        <executions>
                            <execution>
                                <id>jboss-ant</id>
                                <phase>install</phase>
                                <configuration>
                                    <target>
                                        <property name="jboss.dir" value="${jboss.home}"/>
                                        <echo message="jboss dir is: ${jboss.dir}"/>                                
                                    </target>
                                </configuration>
                                <goals>
                                    <goal>run</goal>
                                </goals>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
    </profiles>
</project> 
```

I don't have JBOSS installed so for testing purpose I set the environement variable to test1234 like this: `set JBOSS_HOME=test1234`

When I execute the parent pom with the jboss profile

```
mvn install -Pjboss 
```

I get the following result: **[echo] jboss dir is: test1234**

When I execute the same command with the **jboss.home** setting

```
mvn install -Pjboss -Djboss.home=my_custom_variable 
```

I get the following result: **[echo] jboss dir is: my_custom_variable**

# asp.net-mvc - 如何为两个相关实体创建视图和视图模型

> ID：15024818
> 
> 赞同：0
> 
> 时间：2013-02-22T12:57:54.217
> 
> 标签：asp.net-mvc, razor

我有两个实体：1）学生和 2）地址。

```
public class Student 
{
    Public Int StudentId { get; set; }
    Public String FullName { get; set; }

    Public virtual IList<Address> Addresses { get; set; }
}

public class Address
{
    Public Int AddressId { get; set; }
    Public Int StudentId { get; set; }
    Public String FullAddress { get; set; }

    Public virtual Student Student { get; set; }
} 
```

每个学生可能有零个或多个地址。

我想为这两个实体创建单个视图。我知道必须创建一个视图模型。这是视图模型。

```
public class StudentViewModel
{
    Public Int StudentId { get; set; }
    Public String FullName { get; set; }
    public Address AddAddressModel { get; set; }

    Public virtual IList<Address> Addresses { get; set; }
} 
```

我为 StudentViewModel 创建了一个视图。这是学生视图模型：

```
@model MyProject.Models.StudentViewModel

@{
    ViewBag.Title = "Create";
 }

 @using (Html.BeginForm ())
 {
     @Html.ValidationSummary(true)

    <fieldset>

        <div class="editor-label">
            @Html.LabelFor(model => model.FullName)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.FullName)
            @Html.ValidationMessageFor(model => model.FullName)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.AddAddressModel.FullAddress)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.AddAddressModel.FullAddres)
            @Html.ValidationMessageFor(model => model.AddAddressModel.FullAddres)
        </div>

        <button id="add">add address to list</button>

        <input type="submit" value="save in database" />        
</fieldset> 
```

请告诉我如何在 StudentViewModel 的 Addresses 属性中逐个添加一个或多个地址，并在此操作后向用户显示。最后，当我点击“保存在数据库中”按钮时，学生的地址必须插入数据库中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:06:04.943

我过去曾提交过嵌套的子实体，但这始终是通过 API 调用完成的，并且表单在提交之前被序列化为 JSON 对象。

因为您只需要多个`FullAddress`值，您可以相应地更改模型和视图（未测试）：

**模型：**

```
public class StudentViewModel
{
    public int StudentId { get; set; }
    public string FullName { get; set; }
    public string[] Addresses { get; set; }
} 
```

**看法：**

在您看来，当您单击“添加”按钮时，请确保（通过 JavaScript）您最终得到如下内容：

```
<textarea name="Addresses[]">Some Address 1</textarea>
<textarea name="Addresses[]">Some Address 2</textarea>
etc... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T13:07:48.770

您可以尝试使用：

```
@EditorFor(m => model.Addresses) 
```

这将为您的地址模型创建模板

# ant - 如何使用 Ant 编译显示所有已使用许可证的报告？

> ID：15024819
> 
> 赞同：5
> 
> 时间：2013-02-22T12:58:01.637
> 
> 标签：ant, licensing

我目前在不同的项目中使用 Ant 和 Maven。为了遵守某些规定，我负责列出每个项目中使用的所有许可证。

使用 Maven，这很容易，因为[Maven 项目信息报告插件](http://maven.apache.org/plugins/maven-project-info-reports-plugin/dependencies-mojo.html)会自动生成这样的报告。

由于我不喜欢为我在项目中使用的所有 JAR 搜索许可证，我想知道是否有 Ant 插件来执行此任务。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:05:41.553

由于这个问题没有任何提示、指针甚至答案，我自己破解了一个解决方案：[github 上的 license-report](https://github.com/guerda/license-report)

这`license-report`是一个 Ant 任务，它确定大多数 jar 文件的许可证。目前，它在以下文件中搜索信息：

*   `META-INF/MANIFEST.MF`
*   `META-INF/LICENSE`
*   `LICENSE.txt`
*   `LICENSE`
*   `license/LICENSE.txt`
*   `license/LICENSE`

这些文件可以在几个常见的开源/自由软件库中找到。一些库不提供有关其许可证的任何信息（例如 Spring 框架）。
对于这些库，任务没有找到任何信息。

我会尽快更新该项目，它会打印出一份关于找到的许可证的漂亮的 xml 和 html 报告。文档和操作方法也将随之而来。

我目前正在使用此 Ant 任务进行[演示项目。](http://github.com/guerda/license-report-demo)

演示项目现在创建一个包含所有库信息的 XML 文件。只需`ant build.xml`通过`license-report-demo`. 它打印出生成的 XML 文件的位置。我还将包含一个 XSLT 来将 XML 转换为一个漂亮的 HTML 报告。我想这会在几天后出现。

我为进一步处理创建了一个 XML 文件（例如，像 Hudson/Jenkins 这样的 CI 系统）。这将有助于在中央系统中生成跨项目的所有许可证列表。

# c# - 会话长度会在通话开始时延长，还是在通话结束时延长？

> ID：15024820
> 
> 赞同：1
> 
> 时间：2013-02-22T12:58:02.670
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

只是为了好奇，如果我有 20 分钟的会话超时并且会发生以下情况：

1.  用户访问网站。初始会话超时开始。
2.  一分钟后在同一页面`$.post("/api/longrunningfuction", function() { alert("success"); })`上调用。
3.  邮政电话需要十分钟才能返回（希望不现实，只是为了帮助解决我的问题）。

现在剩下的时间是：

1.  20 分钟由于回电和延长会议时间？
2.  10 分钟（呼叫帖子延长了会话，但帖子返回已 10 分钟）。
3.  其他？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:03:35.870

会话扩展通过将表单身份验证 cookie 重写为响应来工作。更具体地说，如果您为表单身份验证启用了滑动到期（出于安全原因通常不推荐），当向服务器发送请求时，表单身份验证模块会在请求**开始**时拦截此请求，它会解密表单身份验证 cookie为了提取表单身份验证票并修改此票的到期日期并将新 cookie 添加到响应中。所有这些都发生在请求的开头。这意味着会话将从那一刻起额外延长 20 分钟（或任何您定义的超时时间）。

然后让我们假设整个请求需要 10 分钟才能完成，然后才将响应返回给客户端（以及分别刷新的表单身份验证 cookie）。当客户端收到这个 cookie 时，还有 10 分钟的时间让它生效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T13:04:08.137

会话结束事件的[文档](http://msdn.microsoft.com/en-us/library/ms178583.aspx)说（强调我的）

> 当该`Timeout` 属性指定的分钟数过去而没有为会话发出请求**时**，会话将过期。

因此，应该还有 10 分钟的剩余时间。

我还没有看到框架代码，但是会话持续时间是通过在响应中设置身份验证 cookie 持续时间来控制的。因此，即使在您的服务器端代码*完成*时发送了新的 cookie ，新的过期时间也是在*收到*请求时计算的，这似乎是合乎逻辑的。如果从计算到期时间到将其传回给客户端的时间之间经过了 10 分钟，那么这就是 10 分钟的会话丢失时间。

# r - R将几个列表元素分配给同一个对象

> ID：15024821
> 
> 赞同：5
> 
> 时间：2013-02-22T12:58:04.503
> 
> 标签：r, list, for-loop, matrix, vectorization

我目前有一个循环——实际上是一个循环中的循环，在一个模拟模型中，随着人数的增加，它会变慢。我已经对大部分内容进行了矢量化处理，并且速度快了很多。但是有一部分我将列表的多个元素分配为同一件事，将一个大循环简化为我想要实现的任务：

```
new.matrices[[length(new.matrices)+1]]<-old.matrix 
```

循环的每次迭代都会调用上面的行，并将相同的矩阵对象分配给列表的下一个新元素。

我正在尝试对此进行矢量化 - 如果可能的话，或者使其比循环或应用语句更快。

到目前为止，我已经尝试过以下内容：

```
indices <- seq(from = length(new.matrices) + 1, to = length(new.matrices) + reps)
new.matrices[indices] <- old.matrix 
```

但是，这会导致以下消息：

```
Warning message:
In new.effectors[effectorlength] <- matrix :
  number of items to replace is not a multiple of replacement length 
```

它还尝试将 的一个值分配`old.matrix`给一个元素，`new.matrices`如下所示：

```
[[1]]
[1] 8687

[[2]]
[1] 1

[[3]]
[1] 5486

[[4]]
[1] 0 
```

当期望的结果是一个列表元素 = 一个完整的矩阵时，`old.matrix`

有没有一种方法可以矢量化在列表元素中粘贴矩阵而不循环？使用循环当前的实现方式，我们正在谈论数千次重复，这大大减慢了速度，因此我希望尽可能将其矢量化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T13:22:06.073

可能你已经解决了你的问题，无论如何，你的代码中的问题

```
new.matrices[indices] <- old.matrix 
```

是由于试图用不同的东西替换一些对象（列表`NULL`中的元素`new.matrices`）引起的，a `matrix`. 所以`R`强制`old.matrix`转换成一个向量并尝试将每个单个值粘贴到不同的列表元素，（这就是你得到这个结果的原因，当，比如说，`reps`是 4 或 8 并且`old.matrix`不是 2 x 2 矩阵时，你也会得到`warning`）。正在做

```
new.matrices[indices] <- list(old.matrix) 
```

将起作用，并将`R`自动复制单个元素列表`list(old.matrix)`“ `reps`”次。

# javascript - 将 3D 矩阵转换为可读格式

> ID：15024828
> 
> 赞同：4
> 
> 时间：2013-02-22T12:58:16.627
> 
> 标签：javascript, css, matrix

由于我对矩阵的了解几乎为零，因此我一直在寻找一种辅助方法，可以将矩阵数组转换为可读格式。

我的意思是可读格式：

```
{
    translate : 
    {
        x : 0,
        y : 0,
        z : 0
    },

    rotation :
    {
        x : 0,
        y : 90,
        z : 0
    },

    skew :
    {
        x : 0,
        y : 0
    },

    scale :
    {
        x : 0,
        y : 0,
        z : 0
    }
} 
```

使用矩阵格式，我的意思是：`matrix3d(0.00000000000000006123233995736766, 0, -1, 0, 0, 1, 0, 0, 1, 0, 0.00000000000000006123233995736766, 0, 0, 0, 0, 1)`.

我一直在通过谷歌寻找这种方法，但似乎找不到。

有没有这样的方法，或者我如何解密/计算每个可用轴上的每种转换类型？

**更新：**我的一个朋友偶然发现了[http://web.iitd.ac.in/~hegde/cad/lecture/L6_3dtrans.pdf](http://web.iitd.ac.in/~hegde/cad/lecture/L6_3dtrans.pdf)，将对此进行调查以尝试至少检索一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T12:42:49.433

将矩阵分解回原始转换并不容易。我已经设法分解`scale*rotate*translate`矩阵。

```
function extract(m) { // supports only scale*rotate*translate matrix
    var radians = Math.PI / 180

    var sX = Math.sqrt(m[0]*m[0] + m[1]*m[1] + m[2]*m[2]),
        sY = Math.sqrt(m[4]*m[4] + m[5]*m[5] + m[6]*m[6]),
        sZ = Math.sqrt(m[8]*m[8] + m[9]*m[9] + m[10]*m[10])

    var rX = Math.atan2(-m[9]/sZ, m[10]/sZ) / radians,
        rY = Math.asin(m[8]/sZ) / radians,
        rZ = Math.atan2(-m[4]/sY, m[0]/sX) / radians

    if (m[4] === 1 || m[4] === -1) {
      rX = 0
      rY = m[4] * -Math.PI/2
      rZ = m[4] * Math.atan2(m[6]/sY, m[5]/sY) / radians
    }

    var tX = m[12]/sX,
        tY = m[13]/sX,
        tZ = m[14]/sX

    return {
      translate: [tX, tY, tZ],
      rotate: [rX, rY, rZ],
      scale: [sX, sY, sZ]
    }
} 
```

但对于任何其他转换顺序，它将失败。

# google-play - 从其他位置关联商家帐户

> ID：15024832
> 
> 赞同：2
> 
> 时间：2013-02-22T12:58:22.297
> 
> 标签：google-play, merchant-account

我们是两个开发者。我来自菲律宾，另一位开发者来自英国伦敦。我们完成了游戏并开始添加应用内购买。我刚刚得知我无法开设商家帐户，因为不包括菲律宾。但是我的队友可以，因为他在英国。如果他从英国开设商家帐户并链接到我的开发者帐户，是否合法？我们可以合法地实施应用内购买吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-02T09:27:10.673

您必须通过居住在英国的法定代表人在英国开设银行账户。

注册过程非常彻底地要求您输入银行信息详细信息，因此 Google 将拒绝不在[此列表](https://support.google.com/googleplay/android-developer/answer/150324?hl=en)中的国家/地区。可悲，但这是事实，部分原因是由于全球法律限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-22T16:21:31.733

您的队友应该开设自己的开发者帐户并使用它来开设商家帐户。

# python - 在另一个处理程序中调用 Tornado 处理程序

> ID：15024836
> 
> 赞同：1
> 
> 时间：2013-02-22T12:58:33.787
> 
> 标签：python, call, handler, tornado

我想将 Tornado 处理程序拆分为两个处理程序。在第一个处理程序中，我想向传感器发送命令。在第二个处理程序中，我想等待传感器的响应。

这可能吗？或者我不能调用另一个处理程序？如果可能，我如何调用第二个处理程序？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2021-12-12T19:21:50.863

我知道原始帖子是几年前提出的，但由于接受的答案并不能解决所提出的问题，我相信我有正确的解决方案，因为我需要它。此外，如果一些可怜的灵魂正在谷歌搜索同样的问题，希望他们能找到这个。

```
class OneHandler(RequestHandler):
    def get(self, id):
        AnotherHandler(self.application, self.request).get(id) 
```

在这里，您可以从“OneHandler”中调用“AnotherHandler”

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-22T14:17:10.730

听起来你有一个“聊天”应用程序的变体。最好的办法是查看[基本的聊天演示应用程序](https://github.com/facebook/tornado/blob/master/demos/chat/chatdemo.py)。

基本操作思想是有一个混合（或全局变量，如果你愿意），它有一个等待响应的连接列表，当设置响应时，它会触发原始处理程序的回调。

# iphone - 使用自定义样式绘制矢量路径

> ID：15024840
> 
> 赞同：0
> 
> 时间：2013-02-22T12:58:36.650
> 
> 标签：iphone, objective-c, macos, cocoa

我很惊讶在 Stackoverflow 上找不到这个问题的答案。

我有一个 pdf 格式的矢量路径，例如 Safari 或 Mac App Store 应用程序通常用作图像图标。

现在，我想在代码中指定填充颜色和自定义阴影，而不是制作图像并导出它们。我不知道该怎么做。

阴影有效，但填充颜色无效。
谁能告诉我该怎么做？

* * *

## 当前代码

```
[NSGraphicsContext saveGraphicsState];
{
    // Has no effect
    [[NSColor colorWithCalibratedRed:0.92f green:0.97f blue:0.98f alpha:1.00f] setFill];
    // Neither has this
    [[NSColor colorWithCalibratedRed:0.92f green:0.97f blue:0.98f alpha:1.00f] set];

    NSShadow *shadow = [NSShadow new];
    [shadow setShadowOffset:NSMakeSize(0, -1)];
    [shadow setShadowColor:[NSColor blackColor]];
    [shadow setShadowBlurRadius:3.0];
    [shadow set];

    [image drawInRect:imgRect 
             fromRect:NSZeroRect 
            operation:NSCompositeXOR 
             fraction:1.0 
       respectFlipped:YES 
                hints:nil];
}
[NSGraphicsContext restoreGraphicsState]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:09:01.193

在调用`drawInRect:...`图像“就是它是什么”方面。设置填充和描边只会影响原始操作。考虑这一点的一个好方法是意识到所有图像，矢量或光栅，都必须以相同的方式表现；在上下文中设置的当前填充颜色会影响基于光栅的图像的绘制，这会很奇怪，对吧？同样的想法——图像就是图像。矢量图像中也可能有多个路径，每个路径都有不同的填充。那些被在上下文中设置的填充颜色覆盖也没有意义。

阴影无论如何都有效，因为它实际上是一种合成操作；绘制具有给定阴影设置的给定图像会产生相同的阴影，无论该图像是基于光栅的还是其矢量等效的。

简而言之，如果你想改变图像的内容，你将不得不编写代码来从图像中提取向量，然后将它们绘制为图元。

或者，如果您只想用颜色填充任何填充区域，您可以使用矢量图像在上下文中创建蒙版，然后您可以在上下文中设置颜色并填充。这*可能会*产生预期的效果。

# android - 在运行时在 Imageview 顶部添加按钮

> ID：15024841
> 
> 赞同：1
> 
> 时间：2013-02-22T12:58:40.160
> 
> 标签：android

我在运行时创建了一个 imageview，现在想要在运行时动态地在 Imageview 顶部添加一个按钮，如果我在 imageview 中平移图像，则其中的按钮也应该相应地平移。问题是 Imageview 不允许在其中添加子视图。

我可以在 imageview 顶部添加按钮，但是当我平移 imageview 时，按钮在屏幕中保持不变。关于如何做到这一点的任何想法？这是我所做的：

```
 panImageView = new PanView(this); //Custom Imageview class to handle panning
        panImageView.setScaleType(ImageView.ScaleType.CENTER);
        //panimg.setAdjustViewBounds(true);

        FrameLayout mainRL = (FrameLayout) findViewById(R.id.mainRelativeLayout);
        mainRL.addView(panImageView);

        ImageWorker imgTask = new ImageWorker(panImageView, is);
        imgTask.execute(2000, 2000);

        //Start button
        Button startButton = new Button(this);

        int iRndBtn = R.drawable.round_button;
        startButton.setBackgroundResource(iRndBtn);

        startButton.getBackground().setColorFilter(Color.GREEN,PorterDuff.Mode.MULTIPLY);

        FrameLayout.LayoutParams layoutParams = new FrameLayout.LayoutParams(50, 50);
        //layoutParams.setMargins(intialPage.mapStartX, intialPage.mapStartY, 0, 0);
        layoutParams.setMargins(200, 200, 0, 0);
        startButton.setLayoutParams(layoutParams);
        //startButton.
        mainRL.addView(startButton,layoutParams); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:29:54.327

使用带有 ImageView & 按钮的 RelativeLayout。将按钮可见性设置为在开始时消失。当您需要更改可见性时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T13:07:14.957

首先在任何布局中添加图像视图，然后在该布局中添加按钮。

# ruby-on-rails - Ruby on Rails：创建一个结合了其他三个关系的关系

> ID：15024842
> 
> 赞同：0
> 
> 时间：2013-02-22T12:58:42.717
> 
> 标签：ruby-on-rails, relational-database, rails-activerecord

我正在尝试创建一种结合了其他三种关系的关系。前三个都是同一类，我想要一个企业集团，但是我找不到一个很好的“arel”方式。

这是我正在尝试做的一个例子。

有效的 SQL 查询是

```
SELECT `records`.* FROM `records` INNER JOIN `memberships` ON `records`.`subject_membership_id` = `memberships`.`id` OR `records`.`recorder_membership_id` = `memberships`.`id` OR `records`.`subject_membership_id` = `memberships`.`id` WHERE `memberships`.`group_id` = 4 
```

当然，我想以铁路的方式做到这一点。这是我到目前为止所拥有的。它应该是不言自明的，所以我不会浪费你的时间进一步解释它。

```
class Group < ActiveRecord::Base
  has_many :recorded_records, :through => :memberships, :source => :recorded_records, :class_name => "Record"
  has_many :reported_records, :through => :memberships, :source => :reported_records, :class_name => "Record"
  has_many :reviewed_records, :through => :memberships, :source => :reviewed_records, :class_name => "Record"

  #has_many :records through recorded_records, reported_records, reviewed_records??
  # Psuedo code above... Wondering how best to do this. I've tried...
  def records
    recorded_records | reported_records | reviewed_records
  end

  # But that makes three seperate database queries when what I really want is...
  # SELECT `records`.* FROM `records` INNER JOIN `memberships` ON `records`.`subject_membership_id` = `memberships`.`id` OR `records`.`recorder_membership_id` = `memberships`.`id` OR `records`.`subject_membership_id` = `memberships`.`id` WHERE `memberships`.`group_id` = 4

end 
```

你们真棒！谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T13:08:02.620

您可以使用自定义连接来做到这一点。使用上面的 SQL：

```
Record.joins('INNER JOIN `memberships` ON `records`.`subject_membership_id` = `memberships`.`id` OR `records`.`recorder_membership_id` = `memberships`.`id` OR `records`.`subject_membership_id` = `memberships`.`id` WHERE `memberships`.`group_id` = 4') 
```

通过一些工作，您可以将其添加为模型中的方法，使其接受参数等。

[这里](http://guides.rubyonrails.org/active_record_querying.html)的 Railsguide给出了一些使用示例`.join`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:49:25.013

好的！嘿，非常感谢您的帮助，@RiPuk。你激发了我的一些想法。我所做的是从 select 语句中创建一个视图：

```
AS SELECT
  `records`.`id` AS `record_id`,
  `memberships`.`group_id` AS `group_id`
FROM (`records` join `memberships`) where ((`records`.`subject_membership_id` = `memberships`.`id`) or (`records`.`recorder_membership_id` = `memberships`.`id`) or (`records`.`subject_membership_id` = `memberships`.`id`)); 
```

我将此视图命名为`view_group_records`，然后创建了一个名为 GroupRecord 的 ActiveRecord 模型（具有适当的关系），现在在我的 Group 模型中，我建立了`has_many`与 GroupRecord 的关系，然后`has_many :records, :through => :group_records`.

这似乎效果很好！

但是您的解决方案绝对有效。

# json - Jackson 对象映射器和 JSON

> ID：15024844
> 
> 赞同：1
> 
> 时间：2013-02-22T12:58:58.573
> 
> 标签：json, jackson

将 JSON 数据映射到 POJO 类时出现问题。客户类有 2 个字段“customerId，isTrue）。我为每个字段使用 JacksonMixInAnnotations。

如果没有 JSON 的第一部分 ({ \"customer\":")，JUnit 测试是可以的。如果包含它会失败，（对于 customer.getCustomerId() 为 null）。

谢谢

```
@Test
public void test() {
    mockServer.expect(requestTo("..."))
        .andExpect(method(GET))
        .andRespond(withSuccess(str, MediaType.APPLICATION_JSON));
    Customer customer = api.operations().getCustomer();
    assertEquals("foo", customer.getCustomerId());
    assertEquals("TRUE"),customer.isTrue());
}

String str = "{ \"customer\": { \"customer-id\": \"foo\",\"is-true\": \"TRUE\" }}";

@Override
protected MappingJacksonHttpMessageConverter getJsonMessageConverter() {
    MappingJacksonHttpMessageConverter converter = super.getJsonMessageConverter();
    objectMapper = new ObjectMapper();
    objectMapper.registerModule(new TestModule());
    converter.setObjectMapper(objectMapper);
    return converter;
} 
```

如果我向 POJO 添加“客户”字段，则会收到以下错误：

```
org.springframework.http.converter.HttpMessageNotReadableException: Could not read JSON: Can not deserialize instance of java.lang.String out of START_OBJECT token
 at [Source: java.io.ByteArrayInputStream@1d8835d; line: 1, column: 3]; nested exception is org.codehaus.jackson.map.JsonMappingException: Can not deserialize instance of java.lang.String out of START_OBJECT token
 at [Source: java.io.ByteArrayInputStream@1d8835d; line: 1, column: 3]
    at org.springframework.http.converter.json.MappingJacksonHttpMessageConverter.readJavaType(MappingJacksonHttpMessageConverter.java:169)
    at org.springframework.http.converter.json.MappingJacksonHttpMessageConverter.read(MappingJacksonHttpMessageConverter.java:161)
    at org.springframework.web.client.HttpMessageConverterExtractor.extractData(HttpMessageConverterExtractor.java:94)
    at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:491)
    at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:460)
    at org.springframework.web.client.RestTemplate.getForObject(RestTemplate.java:228)
    at org.springframework.social.test.api.impl.CustomerTemplate.getCustomer(CustomerTemplate.java:24)
    at org.springframework.social.test.api.impl.CustomerTemplateTest.getCustomer_current_user(CustomerTemplateTest.java:20)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: org.codehaus.jackson.map.JsonMappingException: Can not deserialize instance of java.lang.String out of START_OBJECT token
 at [Source: java.io.ByteArrayInputStream@1d8835d; line: 1, column: 3]
    at org.codehaus.jackson.map.JsonMappingException.from(JsonMappingException.java:163)
    at org.codehaus.jackson.map.deser.StdDeserializationContext.mappingException(StdDeserializationContext.java:219)
    at org.codehaus.jackson.map.deser.std.StringDeserializer.deserialize(StringDeserializer.java:44)
    at org.codehaus.jackson.map.deser.std.StringDeserializer.deserialize(StringDeserializer.java:13)
    at org.codehaus.jackson.map.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:299)
    at org.codehaus.jackson.map.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:905)
    at org.codehaus.jackson.map.deser.BeanDeserializer.deserializeFromObjectUsingNonDefault(BeanDeserializer.java:739)
    at org.codehaus.jackson.map.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:683)
    at org.codehaus.jackson.map.deser.BeanDeserializer.deserialize(BeanDeserializer.java:580)
    at org.codehaus.jackson.map.ObjectMapper._readMapAndClose(ObjectMapper.java:2732)
    at org.codehaus.jackson.map.ObjectMapper.readValue(ObjectMapper.java:1923)
    at org.springframework.http.converter.json.MappingJacksonHttpMessageConverter.readJavaType(MappingJacksonHttpMessageConverter.java:166)
    ... 31 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T13:38:05.803

查看[@JsonRootName 注释](http://fasterxml.github.com/jackson-annotations/javadoc/2.1.0/com/fasterxml/jackson/annotation/JsonRootName.html)（将其添加到您的 Customer.class）并使用方法[*enable(DeserializationFeature feature)*](http://fasterxml.github.com/jackson-databind/javadoc/2.1.0/com/fasterxml/jackson/databind/ObjectMapper.html#enable%28com.fasterxml.jackson.databind.DeserializationFeature%29)在[ObjectMapper上启用](http://fasterxml.github.com/jackson-databind/javadoc/2.1.0/com/fasterxml/jackson/databind/ObjectMapper.html)[DeserializationFeature](http://fasterxml.github.com/jackson-databind/javadoc/2.1.0/com/fasterxml/jackson/databind/DeserializationFeature.html) [UNWRAP_ROOT_VALUE](http://fasterxml.github.com/jackson-databind/javadoc/2.1.0/com/fasterxml/jackson/databind/DeserializationFeature.html#UNWRAP_ROOT_VALUE)。[](http://fasterxml.github.com/jackson-databind/javadoc/2.1.0/com/fasterxml/jackson/databind/ObjectMapper.html#enable%28com.fasterxml.jackson.databind.DeserializationFeature%29)

# ms-project-server-2010 - Project Server 2010 事件处理程序

> ID：15024845
> 
> 赞同：0
> 
> 时间：2013-02-22T12:59:00.150
> 
> 标签：ms-project-server-2010, psi

我正在开发 OnPublished 事件处理程序，它将根据另一个字段的更改更新项目的一个自定义字段。

我收到一个错误

```
Event Handler for event \ProjectPublished\ of type \PS.UpdateProjectStatusChangeDate.EventHandlerUpdateField\ threw an exception: ProjectServerError(s) LastError=CICOCheckedOutToOtherUser Instructions: Pass this into PSClientError constructor to access all error information 
```

这是代码

```
 //loading project data from server
        //Every change on this dataset will be updated on the server!
        ProjectDataSet projectDs = projectClient.ReadProject(projectId, projectSvc.DataStoreEnum.WorkingStore);

        foreach (projectSvc.ProjectDataSet.ProjectRow row in projectDs.Project)
        {
            if (row.PROJ_SESSION_UID != null)
            {
                sessionId = row.PROJ_SESSION_UID;
                break;
            }
        }
       //send the dataset to the server to update the database
       bool validateOnly = false;
       Guid jobId = Guid.NewGuid();
       projectClient.QueueUpdateProject(jobId, sessionId, projectDs, validateOnly); 
```

与我们在项目处于签入状态时运行代码的其他答案不同，我们正在签出并分配新的 SessionID。但是当事件处理程序触发时，项目已经被签出。那么如何获取 SessionID。我认为这就是代码被破坏的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T01:15:37.697

从逻辑上讲，这是有道理的。签出项目时，这意味着有人可以随时以任何方式更改它。

因此，即使您的想法有效，您的更新也可能被 Project Pro 的下一次保存覆盖。因为 Project Pro 对您的操作一无所知。

我对您的系统一无所知，所以让我猜测您的用户主要使用 Project Pro。在这种情况下，您可以将事件处理程序添加到`Application.ProjectBeforePublish` [msdn 链接](http://msdn.microsoft.com/en-us/library/office/office.vbapj.chm131154.aspx)事件并从 Project Pro 更新字段。但请记住，您的用户将被要求在发布之前保存项目。

如果 Project Pro 的解决方案不适合您 - 您可以在项目签入后以某种方式标记已发布的项目 - 请务必签出、更新字段、保存并再次发布项目。

# java - Java 无法访问的代码错误

> ID：15024846
> 
> 赞同：3
> 
> 时间：2013-02-22T12:59:04.283
> 
> 标签：java, exception, smartfoxserver

我正在为 SmartFox 服务器扩展创建一个 Java 类。它正在尝试访问 MySQL 数据库。

我收到一个`Unreachable Code`在线调用的错误`session.setProperty("DatabaseID", dbId);`

```
package sfs2x.extension.test.dblogin;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.smartfoxserver.bitswarm.sessions.ISession;
import com.smartfoxserver.v2.core.ISFSEvent;
import com.smartfoxserver.v2.core.SFSEventParam;
import com.smartfoxserver.v2.db.IDBManager;
import com.smartfoxserver.v2.exceptions.SFSErrorCode;
import com.smartfoxserver.v2.exceptions.SFSErrorData;
import com.smartfoxserver.v2.exceptions.SFSException;
import com.smartfoxserver.v2.exceptions.SFSLoginException;
import com.smartfoxserver.v2.extensions.BaseServerEventHandler;

public class LoginEventHandler extends BaseServerEventHandler 
{
    @Override
    public void handleServerEvent(ISFSEvent e) throws SFSException 
    {
        String email = (String)e.getParameter(SFSEventParam.LOGIN_NAME);
        String pass = (String)e.getParameter(SFSEventParam.LOGIN_PASSWORD);
        ISession session = (ISession)e.getParameter(SFSEventParam.SESSION);

        IDBManager dbManager = getParentExtension().getParentZone().getDBManager();
        Connection connection = null;

        try
        {
            connection = dbManager.getConnection();

            PreparedStatement stmt = connection.prepareStatement("SELECT * FROM users WHERE email=?");
            stmt.setString(1, email);

            ResultSet res = stmt.executeQuery();

            if(!res.first())
            {
                SFSErrorData errData = new SFSErrorData(SFSErrorCode.LOGIN_BAD_USERNAME);
                errData.addParameter(email);

                throw new SFSLoginException("Bad user name: "+ email, errData);
            }

            String dbPword = res.getString("password");
            int dbId = res.getInt("id");

            if(!getApi().checkSecurePassword(session, dbPword, pass));
            {
                SFSErrorData errorData = new SFSErrorData(SFSErrorCode.LOGIN_BAD_PASSWORD);
                errorData.addParameter(email);

                throw new SFSLoginException("Bad password for user: "+ email, errorData);
            }

            session.setProperty("DatabaseID", dbId);
           //UNREACHABLE CODE
           //IF I COMMENT THIS OUT, THERE IS NO UNREACHABLE CODE ERROR

        }

        catch(SQLException eve)
        {
            SFSErrorData erroData = new SFSErrorData(SFSErrorCode.GENERIC_ERROR);
            erroData.addParameter("SQL Error: " + eve.getMessage());

            throw new SFSLoginException("A SQL Error occurred: " + eve.getMessage(), erroData);
        }

        finally
        {
            try 
            {
                connection.close();
            }
            catch (SQLException e1) 
            {

            }
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T13:00:17.530

您的第二个 if 语句以 that 终止`;`是一个有效的语句。并且您在下一个块中抛出异常，这就是错误的原因。

```
if(!getApi().checkSecurePassword(session, dbPword, pass)); 
```

上面的 if 语句以分号终止，这是一个有效的语句，并且 if 语句将对其进行操作，您的代码的另一部分正在执行，而与 if 语句无关，并且在最后抛出异常。

```
{
    SFSErrorData errorData = new SFSErrorData(SFSErrorCode.LOGIN_BAD_PASSWORD);
    errorData.addParameter(email);

    throw new SFSLoginException("Bad password for user: "+ email, errorData);
} 
```

这就是您收到错误的原因，因为您的线路`session.setProperty("DatabaseID", dbId);`永远无法到达。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T13:00:23.530

`;`在上一个代码块之前有一个伪造的：

```
if(!getApi().checkSecurePassword(session, dbPword, pass));
                                                      // ^
                                                      // |
                                                      // +---- remove this ';'
{
   ...
   throw new SFSLoginException("Bad password for user: "+ email, errorData);
}

session.setProperty("DatabaseID", dbId); 
```

因此`throw`总是执行，因此代码永远不会到达`session.setProperty()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T13:04:35.950

因为`;`在 second 之后有一个不想要的`if`，所以下面的`{}`块**总是**会被执行。这意味着`SFSLoginException`将**始终**抛出 a 并且执行将跳转到`catch`.

这将导致该`setProperty`方法永远不会被调用。

您需要从代码中的以下语句中删除分号：

`if(!getApi().checkSecurePassword(session, dbPword, pass));`

# c# - 检查数组列表是否具有相同的值

> ID：15024847
> 
> 赞同：2
> 
> 时间：2013-02-22T12:59:08.623
> 
> 标签：c#

我有一个所有整数数组的列表，我想在其中检查列表是否具有相同的值，即-1。

例如。

```
int[] intk= {-1,-1,-1,-1,-1,-1};
int[] intl = { -1, -1, -1, -1, -1, -1 };
List<int[]> lst = new List<int[]>();
lst.Add(intk);
lst.Add(intl); 
```

如何找到 lst 只有-1。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T13:01:29.697

用扁平化你的列表，`SelectMany`然后检查是否都相同：

```
int value = -1;
bool allSame = lst.SelectMany(a => a).All(i => i == value); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T13:06:16.693

您可以使用`.All(...)`与 LINQ 捆绑的扩展方法进行检查。

为了创建一个包含两个数组项的列表，您应该使用`.AddRange(...)`and 的`T`参数`List<T>`来`int`代替`int[]`：

```
int[] intk= {-1,-1,-1,-1,-1,-1};
int[] intl = { -1, -1, -1, -1, -1, -1 };
List<int> lst = new List<int>();
lst.AddRange(intk);
lst.AddRange(intl); 
```

现在您可以使用`.All(...)`：

```
bool result = lst.All(item => item == 1); 
```

...或者：

```
bool result = lst.All(item => item == -1); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T13:08:21.507

如果您想检查任何相同的值而不仅仅是-1，这将起作用。

```
var l = lst.SelectMany(_ => _);
bool areSame = l.All(_ => l.FirstOrDefault() == _); 
```

# batch-file - 将“DOS”命令的输出与某物进行比较

> ID：15024848
> 
> 赞同：0
> 
> 时间：2013-02-22T12:59:09.870
> 
> 标签：batch-file, dos, windows-shell

（通过 DOS，我的意思是 windows cmd.exe - 我不想对最终用户强制执行 powershell 或类似命令）

我想运行一个命令行文件，将输出打印到 CON / 屏幕。

我想捕获该输出并将其与预期输出进行比较。

...在 .bat / .cmd 文件中？

* * *

具体来说，[`identify`ImageMagick 的命令](http://www.imagemagick.org/script/identify.php)，我想在 +- 300 个文件上运行它，并将实际大小与预期大小进行比较。

示例输出：

> $识别玫瑰.jpg
> 
> 玫瑰.jpg JPEG 640x480 sRGB 87kb 0.050u 0:01

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T18:09:03.687

如果我正确理解了这个问题，您想对目录中的所有 jpg 文件运行 identify 命令，并将该命令的输出捕获到文本文件中以供以后比较。然而，比较不是规范的一部分？

像下面的行应该可以完成这项工作。只需从 jpg 文件所在的文件夹中运行它：

for /R %%X in (*.jpg) do identify %%X >> PicInfo.txt 这将捕获目录中每个 .jpg 文件的 rose.jpg JPEG ... 行（以及子目录，感谢 ' /R')，您可以在其中运行命令并将其附加到文件 PicInfo.txt 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T13:34:10.627

您可以`identify`使用将控制台输出重定向到文件的符号（即`>`字符）调用程序。就像是：

```
identify rose.jpg > myoutput.txt 
```

此外，`>>`会将输出附加到文件中已有的内容。所以使用

```
identify rose.jpg >> myoutput.txt 
```

...应该创建一个包含所有输出的文件。

然后您可以使用 DOS COMP 命令比较两个文件的内容。语法是：

```
COMP [data1] [data2] [/D] [/A] [/L] [/N=number] [/C] [/OFF[LINE]] 
```

`>`您也可以使用该符号将其重定向到输出文件。

# sql-server - 从表 SQL Server 中删除几个条目

> ID：15024856
> 
> 赞同：0
> 
> 时间：2013-02-22T12:59:33.560
> 
> 标签：sql-server, sql-server-2012

我的一张表中有 42,715,078 个条目，我想删除 TOP 42,715,000 行（我只想保留 78 个条目）。

有谁知道我可以这样做吗？

PS：我不想删除表，只想删除表的条目。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T13:14:28.167

最好的选择可能是选择要保留到临时表中的 78 行，然后截断该表并将它们重新插入。

```
SELECT * INTO #temp FROM TableName WHERE <Condition that gets you the 78 rows you want> 
```

或者如果您没有特定的 78 行

```
SELECT TOP 78 * INTO #temp FROM TableName 
```

然后

```
TRUNCATE TABLE TableName 
```

最后但并非最不重要

```
INSERT INTO TableName
    SELECT * FROM #temp 
```

这样做应该会快得多，具体取决于您使用什么条件来获取 78 行，并且您可以避免膨胀日志，因为 TRUNCATE 只记录了最少的日志。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T13:21:59.203

我们有一个活动日志，我们每月截断一次。（我们保留每月备份，因此如果需要，我们可以恢复任何旧数据。）如果您的表每个月都在增长，并且您希望像我们对我们的表一样保持较小，您可以设置 SQL 代理作业每个月运行。

我们一次只删除 5000 行以保持数据库的负载，因此该作业每两分钟运行一个小时。这给了它足够的时间来删除所有最旧的行而不锁定数据库。

```
DECLARE @LastDate DateTime  -- We remove the oldest rows by month
DECLARE @NumberOfRows INT   -- Number of rows to keep

-- Set the Date to the current date minus 3 months.
SET @LastDate = DATEADD(MM, -3, GETDATE())

-- Since it runs on the first Saturday of each month, this code gets it
   back to the first of the monh.
SET @LastDate = CAST(CAST(DATEPART(YYYY, @LastDate) AS varchar) + '-' + CAST(DATEPART(MM, @LastDate) AS varchar) + '-01' AS DATETIME)

-- We use 5000.
SET @NumberOfRows = 5000 

DELETE TOP (@NumberOfRows) FROM MyTable WHERE Created < @LastDate 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T13:06:18.250

我得到了它。

```
DELETE TOP (42715000) 
FROM <tablename>
WHERE <condition> 
```

效果很好！

# c++ - 易于使用的PNG库？

> ID：15024857
> 
> 赞同：4
> 
> 时间：2013-02-22T12:59:36.243
> 
> 标签：c++, .net, png

有人可以向我推荐一个**简单、易于使用**的用于 c++ 或 .NET 的 PNG 库吗？它需要做的就是：加载大 PNG 图像（比如 20000x20000），然后告诉我每个像素的颜色。

.NET 中的位图类无法加载大图像，引发 OutOfMemory 异常。

我花了合理的时间在谷歌上浏览 c++ 库，但它们都比我需要的要多得多，而且它们的使用对我来说太复杂了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T13:06:21.840

PNG 文件的事实上的标准库是[LibPNG](http://www.libpng.org/pub/png/libpng.html)。它不是世界上设计最好的 API，但如果你只是按照他们的教程中的步骤进行操作，就很难搞砸了。

您可能会发现将他们的 API 包装在您自己的几个简单函数（或类）中是最容易的。一旦你完成了，你应该很高兴。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-22T13:08:12.723

尝试这个：

[http://nothings.org/stb_image.c](http://nothings.org/stb_image.c)

您也可以使用它来代替 zlib。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-22T14:14:32.110

如果 C# 是一个选项，请尝试[PNGCS](https://code.google.com/p/pngcs/)。它是由我自己完成的，最初是在 Java 中完成的，它允许您逐行读取和写入，无需将所有数据都保存在内存中。

我已经测试过它可以读写大文件（30000 x 30000 像素，磁盘超过 2GB），[至少在 Java 中](http://code.google.com/p/pngj/source/browse/pnjg/src/ar/com/hjg/pngj/test/CreateVeryHuge.java)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-22T13:05:53.527

对于 C++：

根据您可以使用的许可证，您可以查看：

DeVIL：[http](http://openil.sourceforge.net/(a) ://openil.sourceforge.net/（有点过时但仍然是不错的选择）（Linux，Win）

ImageMagick：[http](http://www.imagemagick.org/script/index.php) ://www.imagemagick.org/script/index.php （维护良好，所有平台）

两者都支持多种输入和输出格式。

编辑：现在也在 Github 上：[https ://github.com/DentonW/DevIL](https://github.com/DentonW/DevIL)

# mysql - 为什么 MYSQL Desc 命令显示 char 而不是 nchar？

> ID：15024863
> 
> 赞同：1
> 
> 时间：2013-02-22T12:59:54.190
> 
> 标签：mysql, nvarchar

我在具有 NATIONAL VARCHAR 数据类型的表中创建了两列？但是，当我运行命令时， desc 结果显示数据类型为 varchar，而不是 nvarchar。为什么会这样？难道我做错了什么？

```
PENAME NATIONAL VARCHAR(255),
PNAME NATIONAL VARCHAR(255) NOT NULL, 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T13:20:47.877

MySQL 没有分离 nvarchar 和 varchar（如 SQL Server）。

相反，您定义[CHARACTER SET（又名 CHARSET）](http://dev.mysql.com/doc/refman/5.5/en/charset-syntax.html)来描述其中的数据（ansi、utf8 等）。这与 MySQL 中的排序规则是正交的（[排序规则定义了数据的排序和比较方式](https://dba.stackexchange.com/a/4272/630)）

`NATIONAL VARCHAR (n)`只是一个同义词`VARCHAR (n) CHARACTER SET utf8`

# c# - 类库项目中的 C# 自定义 TypeConverter

> ID：15024864
> 
> 赞同：0
> 
> 时间：2013-02-22T12:59:54.223
> 
> 标签：c#, class-library, typeconverter

我已经创建了我`TypeConverter`的枚举本地化，将其注册为`MyEnum`使用类型，`[TypeConverter(typeof(MyEnum))]`并且它在我的 Windows 窗体应用程序项目中运行良好。

但是现在我需要在类库项目中使用相同的转换器，突然我的`TypeConverter`类根本没有被实例化。我是否缺少任何步骤或设置来使`[TypeConverter]`属性在 Class Libary 项目中工作？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-08T20:51:46.003

这可能与在组件中找不到转换器有关？

[为什么这个 TypeConverter 不起作用？](https://stackoverflow.com/questions/3612909/why-is-this-typeconverter-not-working?rq=1)

# silverlight - 使用多个资源字典

> ID：15024868
> 
> 赞同：0
> 
> 时间：2013-02-22T13:00:11.110
> 
> 标签：silverlight

我已经为从我的用户控件中的 TextBox 继承的控件定义了两个资源字典，如下所示：

```
<UserControl.Resources>
    <ResourceDictionary Source="KeyBox.xaml" x:Key="KeyBox" ></ResourceDictionary>
    <ResourceDictionary Source="kTextBox.xaml" x:Key="kTextBox" ></ResourceDictionary>
</UserControl.Resources> 
```

我在具有不同目标类型的单独文件中创建了样式：

```
<Style TargetType="b:kTextBox" > 
```

现在，当我使用这些资源创建控件时，只有最后应用的样式才会真正应用，所以如果我删除第二个，第一个就可以了。我在这里缺少一些东西来利用同一个用户控件中的两个资源，我不知道它是什么。任何想法都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:55:37.277

尝试像这样添加您的资源字典：

```
 <UserControl.Resources>
     <ResourceDictionary>
         <ResourceDictionary.MergedDictionaries>
             <ResourceDictionary Source="KeyBox.xaml" x:Key="KeyBox" ></ResourceDictionary>
             <ResourceDictionary Source="kTextBox.xaml" x:Key="kTextBox" ></ResourceDictionary>
          </ResourceDictionary.MergedDictionaries>
     </ResourceDictionary>
 </UserControl.Resources> 
```

请注意，除非您有一个名为 kTextBox 的类，否则您的 Style 将不起作用。

还值得一提的是，您的控件一次只会应用一种样式，并且将应用最后添加到字典中的资源。因此，如果您在两个字典中都定义了具有相同键的样式，则将应用来自 kTextBox.xaml 的样式。

# llvm - 无法使用 Emscripten 编译 GMP 库

> ID：15024882
> 
> 赞同：4
> 
> 时间：2013-02-22T13:01:13.833
> 
> 标签：llvm, gmp, emscripten

我已经用最新版本的 Emscripten 尝试了这里的说明：[https ://github.com/kripken/gmp.js/blob/master/README.markdown](https://github.com/kripken/gmp.js/blob/master/README.markdown)

.a 文件似乎已正确创建。然后我尝试针对该库进行编译（在调试模式下），这*似乎*有效：

```
emcc invocation:  /home/marcosscriven/sources/emscripten/emcc -O0 --closure 0 test.c .libs/libgmp.a -o complete.js 
(Emscripten: Running sanity checks)
emcc: compiling to bitcode
emcc: compiling source file:  test.c
emcc running: /usr/local/bin/clang -m32 -U__i386__ -U__x86_64__ -U__i386 -U__x86_64 -Ui386 -Ux86_64 -U__SSE__ -U__SSE2__ -U__MMX__ -UX87_DOUBLE_ROUNDING -UHAVE_GCC_ASM_FOR_X87 -DEMSCRIPTEN -U__STRICT_ANSI__ -U__CYGWIN__ -D__STDC__ -Xclang -triple=i386-pc-linux-gnu -D__IEEE_LITTLE_ENDIAN -fno-math-errno -fno-ms-compatibility -nostdinc -Xclang -nobuiltininc -Xclang -nostdsysteminc -Xclang -isystem/home/marcosscriven/sources/emscripten/system/local/include -Xclang -isystem/home/marcosscriven/sources/emscripten/system/include -Xclang -isystem/home/marcosscriven/sources/emscripten/system/include/emscripten -Xclang -isystem/home/marcosscriven/sources/emscripten/system/include/bsd -Xclang -isystem/home/marcosscriven/sources/emscripten/system/include/libc -Xclang -isystem/home/marcosscriven/sources/emscripten/system/include/libcxx -Xclang -isystem/home/marcosscriven/sources/emscripten/system/lib/libcxxabi/include -Xclang -isystem/home/marcosscriven/sources/emscripten/system/include/gfx -Xclang -isystem/home/marcosscriven/sources/emscripten/system/include/net -Xclang -isystem/home/marcosscriven/sources/emscripten/system/include/SDL -U__APPLE__ -U__linux__ -D_LIBCPP_HAS_NO_DELETED_FUNCTIONS -emit-llvm -c test.c -o /tmp/tmp_pOV54/test_0.o
emcc: copying library file:  .libs/libgmp.a
emcc: will generate JavaScript
emcc: considering including libcxx: we need set([]) and have set([])
emcc: considering including libcxxabi: we need set([]) and have set([])
emcc: considering including libc: we need set(['realloc', 'malloc', 'memcpy', 'free']) and have set([])
emcc: including libc
emcc: linking:  ['/tmp/tmp_pOV54/test_0.o', '/tmp/tmp_pOV54/libgmp_1.a', '/home/marcosscriven/.emscripten_cache/libc.bc']
emcc: llvm-linking: ['/tmp/tmp_pOV54/test_0.o', '/home/marcosscriven/.emscripten_cache/libc.bc']
emcc: saving intermediate processing steps to /tmp/emscripten_temp
emcc: LLVM opts: ['-internalize', '-internalize-public-api-list=main', '-globaldce']
emcc:    step took 0.01 seconds
emcc:    step took 0.00 seconds
emcc: LLVM => JS
emscript: ll=>js
  emscript: scan took 0.000277042388916 seconds
  emscript: split took 0.000169038772583 seconds
  emscript: phase 1 took 0.173984050751 seconds
  emscript: phase 2 working on 1 chunks  (intended chunk size: 1.00 MB, meta: 0.00 MB, forwarded: 0.01 MB, total: 0.01 MB)
  emscript: phase 2 took 0.206316947937 seconds
  emscript: phase 2b took 0.000115871429443 seconds
  emscript: phase 2c took 0.00135588645935 seconds
  emscript: phase 3 took 0.170216083527 seconds
emcc:    step took 0.60 seconds
emcc: total time: 1.62 seconds 
```

但是，当我尝试运行生成的 Javascript 时，出现此错误：

```
marcosscriven@ubuntu-laptop:~/sources/gmp-5.0.2$ node complete.js 

/home/marcosscriven/sources/gmp-5.0.2/complete.js:2452
      ___gmpz_init(((5242892)|0));
      ^
TypeError: undefined is not a function
    at _pidigits (/home/marcosscriven/sources/gmp-5.0.2/complete.js:2452:7)
    at Object._main (/home/marcosscriven/sources/gmp-5.0.2/complete.js:2429:7)
    at Object.callMain (/home/marcosscriven/sources/gmp-5.0.2/complete.js:2644:24)
    at doRun (/home/marcosscriven/sources/gmp-5.0.2/complete.js:2679:20)
    at run (/home/marcosscriven/sources/gmp-5.0.2/complete.js:2703:12)
    at Object.<anonymous> (/home/marcosscriven/sources/gmp-5.0.2/complete.js:2725:13)
    at Module._compile (module.js:449:26)
    at Object.Module._extensions..js (module.js:467:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12) 
```

Alon（Emscripten 的创建者）在 Emscripten Google Group 上表示，这意味着该功能不存在，并检查 llvm-vm，它似乎是：

```
marcosscriven@ubuntu-laptop:~/sources/gmp-5.0.2$ !llvm-nm
llvm-nm .libs/libgmp.a | grep gmpz_init
00000000 T __gmpz_init
00000000 T __gmpz_init2
         U __gmpz_init
00000000 T __gmpz_inits
00000000 T __gmpz_init_set
00000000 T __gmpz_init_set_d
00000000 T __gmpz_init_set_si
00000000 T __gmpz_init_set_str
00000000 T __gmpz_init_set_ui
         U __gmpz_init
         U __gmpz_init_set_ui
         U __gmpz_init2
         U __gmpz_init_set_ui
         U __gmpz_init
         U __gmpz_init_set_str
         U __gmpz_init
         U __gmpz_init2
         U __gmpz_init_set
         U __gmpz_init
         U __gmpz_init_set 
```

所以我完全不知所措！

可能值得注意的是，在使用常规编译器构建时针对库编译测试可以正常工作。

编辑：进一步了解这一点。在这个库的 5.1.1 版本中，他们引入了一个新的配置选项“--dissable-assembly”，它执行通用 C 编译。

现在的问题是，当测试运行时，它永远不会停止。

建议我在 gmp.h 中“禁用”LIKELY 和 UNLIKELY 选项：

[https://github.com/kripken/gmp.js/blob/master/gmp-h.in](https://github.com/kripken/gmp.js/blob/master/gmp-h.in)

但我不知道如何“禁用”它们。通常有 0 或 1 选项，但我在这里看不到。我什至不明白这个特定选项的作用。

谢谢

马科斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T17:56:00.903

我最终得到了这个工作。（实际上对于 MPFR 也是如此）。

最大的问题是确保使用 32 位选项和标头。

# java - Two SearchViews in one Activity and screen rotation

> ID：15024892
> 
> 赞同：7
> 
> 时间：2013-02-22T13:01:35.640
> 
> 标签：java, android

I have two SearchViews in one xml layout:

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent">

    <SearchView
        android:id="@+id/my_first_custom_view"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >
    </SearchView>

   <SearchView
        android:id="@+id/my_second_custom_view"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/my_first_custom_view" >
   </SearchView>

</RelativeLayout> 
```

And I inflate this layout to my MainActivity by setContentView(). Then I call methods setQuery() for each other.

Everything is ok until a screen rotation. **When I rotate the screen every searchView has text "World" instead "Hello" and "World".**

```
 public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        SearchView firstSearchView = (SearchView)     findViewById(R.id.my_first_custom_view);
        SearchView secondSearchView = (SearchView) findViewById(R.id.my_second_custom_view);

        firstSearchView.setQuery("Hello!", false);
        secondSearchView.setQuery("World", false);
    }
} 
```

Someone can explain what's going wrong ?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-28T12:48:38.580

The `SearchView` uses as its content the view resulted from inflating a layout file. As a result, all the `SearchViews` used in the layout of an activity(like your case) will have as content, views with the same ids. When Android will try to save the state to handle the configuration change it will see that the `EditTexts` from the `SearchViews` have the same id and it will restore the same state for all of them.

The simplest way to handle this issue is to use the `Activity`'s `onSaveInstanceState` and `onRestoreInstanceState` like this:

```
@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    // state for the first SearchView
    outState.putString("sv1", firstSearchView.getQuery().toString());
    // state for the second SearchView
    outState.putString("sv2", secondSearchView.getQuery().toString());
}

@Override
protected void onRestoreInstanceState(Bundle savedInstanceState) {
    super.onRestoreInstanceState(savedInstanceState);
    // properly set the state to balance Android's own restore mechanism
    firstSearchView.setQuery(savedInstanceState.getString("sv1"), false);
    secondSearchView.setQuery(savedInstanceState.getString("sv2"), false);
} 
```

Also have a look at this [related question](https://stackoverflow.com/questions/3542333/how-to-prevent-custom-views-from-losing-state-across-screen-orientation-changes).

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-22T13:11:45.527

One way to alleviate this problem is to capture the orientation event change with your activity and then set the query again on your two search views.

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-02-28T12:40:09.930

Add this to manifest in activity in which you are having two `SearchView`

```
 android:configChanges="keyboardHidden|orientation|screenSize" 
```

# django - 如何使用python代码获取登录客户端的Windows用户名和域？

> ID：15024894
> 
> 赞同：3
> 
> 时间：2013-02-22T13:01:40.437
> 
> 标签：django, python-2.7

当用户登录到他的桌面时，Windows 操作系统会针对 Active Directory Server 对他进行身份验证。所以每当他访问一个网页时，他不应该被抛出一个登录页面来输入他的用户名或密码。相反，他的用户名和域需要从他的桌面捕获并传递给网络服务器。（让他输入密码之后）

这是否可以在 python 中获取客户端的用户名和域？win32api.GetUserName() 给出服务器端的用户名。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:37:22.170

嗯...您可能想要做的是使用 Django 的 RemoteUserMiddleware 并将用户身份验证留给 Web 服务器，然后可以将其配置为处理它。来自[Django 中的 Ntlm/Kerberos 身份验证](https://stackoverflow.com/questions/3401512/ntlm-kerberos-authentication-in-django)的解决方案应该可以工作，但如前所述，它有点古怪 - 并非所有浏览器都正确支持它，您必须修改浏览器设置才能使其正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-25T15:10:37.693

您想要做的称为单点登录 (SSO)，它在实际 Web 服务器上实现比在 Django 上容易得多。

因此，您应该检查如何在 Apache/Nginx/whateverYouAreUsing 上进行 SSO，然后 Web 服务器会将经过身份验证的用户名转发到您的 django 应用程序。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-22T13:12:07.333

这对我来说听起来像是一个javascript问题。我认为您必须将 javascript 添加到您的登录页面，以尝试访问详细信息并将其返回到服务器。

我原以为会有安全措施来防止这种情况发生，但是这个[问题](https://stackoverflow.com/questions/2968690/get-windows-username-with-javascript)表明其他人也做了类似的事情。

更新

看起来[django 文档中可能有一些有用的信息](https://docs.djangoproject.com/en/1.4/howto/auth-remote-user/)

# r - 重命名文件夹中的文件

> ID：15024898
> 
> 赞同：-2
> 
> 时间：2013-02-22T13:02:02.273
> 
> 标签：r

我必须重命名文件夹中的文件列表，以便：

从名为：

```
> myfile_000.txt
> myfile_001.txt
>  ...... 
```

到文件名为：

```
> myfile_1.txt
> myfile_2.txt
> ....... 
```

文件总数 = 156

我使用了以下脚本：

```
> file.rename(list.files(pattern="myfile_*.txt", paste0("myfile_", 1:156))) 
```

但没有成功。

错误：

> file.rename(list.files(pattern = "myfile_*.txt", paste0("myfile_", : 参数 "to" 丢失，没有默认值

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T13:28:25.433

错误消息告诉您，您没有指定新名称。如果您更改 one 的位置，它应该可以工作`)`：

```
file.rename(list.files(pattern="myfile_*.txt"), paste0("myfile_", 1:156)) 
```

# ruby - 提取未通过验证的对象并在通知中显示它们

> ID：15024901
> 
> 赞同：0
> 
> 时间：2013-02-22T13:02:12.520
> 
> 标签：ruby, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

**简介：**简而言之，此操作让您可以通过邮件邀请更多用户，您可以在一个字段中放置您的电子邮件，并且在提交时他们都会收到带有邮件邀请的电子邮件。

模型中有一个方法可以验证 project_invitation create 上的电子邮件，因此插入无效的电子邮件类型*（如：eee@em、fff.com、bbb@.com）*，将不会保存 pinv 并且会引发 logger.error ..

**问题：**如何提取所有未通过验证的电子邮件并将其显示在通知中，例如“ *Invtations sent, except eee@em, fff.com, bbb@.com, emails not valid”*。

谢谢，如果需要任何其他信息，请告诉我。

```
 def invite_users
    emails = params[:project_invitation][:emails]
    role = current_user.has_role?(:admin, @project) ? :admin : :default

    emails.to_s.split(',').each do |email|
      pinv = ProjectInvitation.new(params[:project_invitation], as: role)
      pinv.sender = current_user
      pinv.recipient_email = email
      pinv.recipient = nil
      pinv.project = @project

      if pinv.save
        ProjectMailer.delay.invitation(pinv)
      else
        logger.error("Failed to save project inv: #{pinv.errors.full_messages.join("\n")}")
      end
    end
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:26:58.280

在您的块内捕获电子邮件，在您的上方`logger.error`：

```
 invalid_emails = []

  if pinv.save
    ProjectMailer.delay.invitation(pinv)
  else
    invalid_emails << email
    logger.error("Failed to save project inv: #{pinv.errors.full_messages.join("\n")}")
  end

  if invalid_emails.any?
    flash[:notice] = "Invalid emails: #{invalid_emails.join(', ')}"
  end 
```

整个代码：

```
 def invite_users
    emails = params[:project_invitation][:emails]
    role = current_user.has_role?(:admin, @project) ? :admin : :default

    invalid_emails = []

    emails.to_s.split(',').each do |email|
      pinv = ProjectInvitation.new(params[:project_invitation], as: role)
      pinv.sender = current_user
      pinv.recipient_email = email
      pinv.recipient = nil
      pinv.project = @project

      if pinv.save
        ProjectMailer.delay.invitation(pinv)
      else
        invalid_emails << email
        logger.error("Failed to save project inv: #{pinv.errors.full_messages.join("\n")}")
      end
    end

    if invalid_emails.any?
      flash[:notice] = "Invalid emails: #{invalid_emails.join(', ')}"
    end
  end 
```

# ruby-on-rails - 延迟作业如何在 Ruby on Rails 中工作？

> ID：15024903
> 
> 赞同：9
> 
> 时间：2013-02-22T13:02:38.647
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我是新手，对延迟作业的工作原理有点困惑？

我知道它会创建一个表并将作业放入表中，然后我需要运行

```
rake jobs:work 
```

启动后台进程。现在我的问题是

1.  DJ 脚本是否每分钟检查一次表格，并且当时间与 job_at 时间匹配时，它会运行该作业？

2.  如果脚本只是每分钟检查一次表，它与 cron （无论何时 gem）有什么不同？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-22T13:09:42.183

> 1.  DJ 脚本是否每分钟检查一次表格，并且当时间与 job_at 时间匹配时，它会运行该作业？

当您运行`rake jobs:work`DelayedJob 时，将轮询`delayed_jobs`表，执行与`job_at`列值匹配的作业（如果已设置）。这部分你是正确的。

> 2.  如果脚本只是每分钟检查一次表，它与 cron （无论何时 gem）有什么不同？

`whenever`是一个可以帮助您配置 crontab 的 gem。它与定期在服务器上执行任务没有**直接关系。**

您*可以*设置一个 cron 来每分钟运行队列中存在的任何任务，但是让`delayed_job`守护程序运行有很多好处。

*   即使 cron 每分钟运行一次，`delayed_job`的守护进程也会看到并执行在 cron 运行之间的 1 分钟窗口内排队的任何作业
*   每次 cron 运行时，它都会重建一个新的 Rails 环境来执行这些作业。当守护程序可以坐在那里立即准备执行新排队的作业时，这是浪费时间和资源。

如果您想`delayed_job`每分钟通过一个 cron 进行配置，您可以将类似的内容添加到您的 crontab

```
* * * * * RAILS_ENV=production script/delayed_job start --exit-on-complete 
```

每分钟，delayed_job 都会启动，执行任何为它准备好的作业，或者它必须从先前失败的运行中重试，然后退出。**不过我不推荐这个。将delayed_job 设置为守护进程是正确的方法。**

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-22T13:22:34.493

> DJ 脚本是否每分钟检查一次表格，并且当时间与 job_at 时间匹配时，它会运行该作业？

是的。它每 5 秒检查一次数据库。

> 如果脚本只是每分钟检查一次表，它与 cron （无论何时 gem）有什么不同？

在后台作业的上下文中，它们并没有那么不同。他们的主要区别在于他们通常如何运行工作。

```
 DJ                  |            Crontab
 uses additional database     | you should either set up a rake task
 table but that's it. easier  | or a runner which can be called on the
 to code compared to crontab  | crontab
------------------------------|------------------------------------------
 requires you to run a worker | requires you to setup your cron which
 that will poll the database  | you can easily do using the whenever gem
------------------------------|------------------------------------------
 since this uses a table, it  | you have to setup some sort of logging so
 is easier to debug errors    | that you have an idea what caused the error
 when they happen             |
------------------------------|------------------------------------------
 the worker should always be  | as long as your crontab is set up properly,
 running to perform the job   | you should have no issues
------------------------------|------------------------------------------
 harder to setup recurring    | easy to setup recurring tasks
 tasks                        |
------------------------------|------------------------------------------ 
```

# jquery - JQuery 日期选择器动态 altField

> ID：15024904
> 
> 赞同：2
> 
> 时间：2013-02-22T13:02:40.217
> 
> 标签：jquery, uidatepicker

我有一组动态页面，上面有 jQuery datepicker 字段。

我希望将漂亮的装饰日期写回给用户，但是用于提交数据的输入字段是隐藏的。

我看到[This other post](https://stackoverflow.com/questions/3811883/jquery-datepicker-altfield-issue/15024631#15024631)一切都很好，直到我尝试实现 buttonImage 方法，以便可以隐藏我的字段。

[jsfiddle 演示在这里](http://jsfiddle.net/wcndave/jYk6j/)

```
 Date: <input type="text" class="datepicker">&nbsp;
<input type="text" class="datepickeralt" size="30"/>

    $(function () {
        $(".datepicker").datepicker({
            showOn: "button",
            buttonImage: "http://jqueryui.com/resources/demos/datepicker/images/calendar.gif",
            buttonImageOnly: true,
        });
    });

    $('.datepicker').each(function() {
        console.log(this);
      $(this).datepicker({
        altField: $(this).closest('div').find('.datepickeralt')
      });
    }); 
```

起初我认为“this”附加到图像而不是字段，但是如果你取出第一个函数，控制台日志记录是完全相同的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T13:11:09.020

尝试使用这个：

```
$(function () {
$(".datepicker_sep, .datepicker").each(function(){
$(this).datepicker({
    showOn: "button",
    buttonImage: "http://jqueryui.com/resources/demos/datepicker/images/calendar.gif",
    buttonImageOnly: true,
    altField: $(this).parent().find('.datepickeralt')
});
})
}); 
```

[http://jsfiddle.net/jYk6j/3/](http://jsfiddle.net/jYk6j/3/)

# c++ - 将库添加到 C/c++ eclipse indigo 项目

> ID：15024905
> 
> 赞同：3
> 
> 时间：2013-02-22T13:02:45.387
> 
> 标签：c++, c, eclipse

我正在尝试`Eclipse`通过以下过程将库添加到 C/C++ 项目中：

1.  Properties->C/C++General->includes（包括指定保存库的文件夹）。
2.  Properties->C/C++General->Library Paths（指定.so和.a文件的库路径）
3.  Properties->C/C++General->Libraries (指定添加.so和.a文件的路径)

但是当我构建项目时，它无法找到我在项目中包含的头文件的路径。

有人可以告诉我错误在哪里吗？

![在此处输入图像描述](../Images/6174b9f7c095fc01f0602f83f8ae6fef.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:00:28.533

[此处](https://stackoverflow.com/questions/1351712/how-to-add-a-library-to-an-eclipse-project)发布了一个类似的问题。您需要在 Properties -> C/C++ -> Build 区域中添加库，而不是 General 区域。

希望这可以帮助。

# php - 如何根据属性值对xml进行排序

> ID：15024911
> 
> 赞同：-2
> 
> 时间：2013-02-22T13:03:04.433
> 
> 标签：php, xml

```
$books = new DOMDocument();
$books->load( 'books.xml' );
$id = $_GET['id'];  
$xml = '<?xml version="1.0" encoding="UTF-8"?>'; 
$xml .= '<results><course>'.$id.'</course>'; 
$xml .= '<books>';
$items = $books->getElementsByTagName("item");
foreach( $items as $item )
{ 
    $item_id = $item->getAttribute("id");
    if($id == $item_id){
      ....
    }
}
$xml .= '</books></results>'; 
header ("Content-Type:text/xml");
echo ($xml); 
```

我上面的代码将返回我：

```
<results>
   <course>1111</course>
   <books>
      <isbn id="0134582667" common="10" before="4" same="1" after="5" total="248"/>
      ..... 
   </books>
</results> 
```

此页面包含以下错误：

> 第 12 列第 772 行的错误：仅在文档开头允许 XML 声明 以下是第一个错误之前的页面呈现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:28:22.270

你可以把你的项目放入一个数组中，然后对数组进行排序，就像这样......

书籍.xml

```
<?xml version="1.0"?>
<results>
   <course>1111</course>
   <books>
      <isbn id="0134582667" common="10" before="4" same="1" after="5" total="248">248</isbn>
      <isbn id="0134582667" common="10" before="4" same="1" after="5" total="3">3</isbn>
      <isbn id="0134582667" common="10" before="4" same="1" after="5" total="224">224</isbn>
      <isbn id="0134582667" common="10" before="4" same="1" after="5" total="25">25</isbn>
   </books>
</results> 
```

测试.php

```
$books = new DOMDocument();
$books->load( 'books.xml' );
$items = $books->getElementsByTagName("isbn");

$nodeArray = array();
foreach ($items as $item) {
    $nodeArray[$item->getAttribute('total')] = $item;
}
ksort($nodeArray);

echo "<pre>". print_r($nodeArray, true) ."</pre>"; 
```

# c# - 使用 Blob 在 SQLite 中存储字节数组

> ID：15024913
> 
> 赞同：4
> 
> 时间：2013-02-22T13:03:12.877
> 
> 标签：c#, sql, sqlite, bytearray

对于我的应用程序，我试图在我的 SQLite 应用程序中存储一个字节数组，我正在以这种方式填充我的 SQLite 数据库：

```
public bool InsertMessage()
    {
        //create string SQl and fill it with the SQLite query for inserting a message.
        string SQL = "Insert into ClockMessages(InsertDateTime, SendDateTime, Data) Values('"+ insertdatetime + "', null, '" + data + "');";
        List<SQLiteParameter> pars = new List<SQLiteParameter>();
        pars.Add(new SQLiteParameter("InsertDateTime", insertdatetime));
        pars.Add(new SQLiteParameter("Data", data));
        //send the SQl query and it's parameters to the SQLiteDatabase class
        return SQLiteDatabase.ExecuteNonQuery(SQL, pars);
    } 
```

其中 InsertDateTime 是 DateTime.UtcNow 而 Data 是一个字节数组。此结果的输出导致字段数据包含： System.Byte []，我不能只在该字段中显示真正的字节数组，而不显示字符串吗？我在任何地方都使用 Byte[] 类型来填充数据库，所以我不会将其转换为字符串。我想在Data字段中看到这样的东西：01、54、32、23、11、02、53。数据库中Data字段的DataType是：BLOB。

谁能帮我实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-25T12:17:47.907

您应该在语句中使用参数：

```
string SQL = "INSERT INTO ClockMessages (InsertDateTime, SendDateTime, Data) VALUES (@InsertDateTime, NULL, @Data)"; 
```

其他一切似乎都是正确的。

你现在所拥有的，调用`ToString()`方法`insertdatetime`并将`data`结果连接到 sql 语句。实际上，您没有在语句中使用任何参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T13:47:08.043

使用带`DBType`参数的 SQLiteParameter 重载：

```
var dataParameter = new SQLiteParameter("Data", DbType.Binary) { Value = data };
pars.Add(dataParameter); 
```

# c# - C# WPF 中的奇怪错误

> ID：15024915
> 
> 赞同：-3
> 
> 时间：2013-02-22T13:03:14.617
> 
> 标签：c#, wpf, exception

我正在开发一个 WPF 应用程序。在这个应用程序中，我使用 Taks(thread) 从多个 txt 文件中读取并显示它们。

**有时**我会遇到异常

> 目标数组的长度不足以复制集合中的所有项目。检查数组索引和长度。

我可以详细阅读：

> C:\Windows\mscorlib.pdb：找不到或打开 PDB 文件。

和：

> mscorlib.dll 中出现了“System.ArgumentException”类型的第一次机会异常

我不知道要开始调试，并且这个奇怪的异常没有模式。

更新：读取txt文件的代码：

```
 public void LoadCompassLogFile(String fileName) {
        //Thread.CurrentThread.Priority = ThreadPriority.Highest;
        if (!fileName.Contains("Compass")) {
            throw new FileLoadException("Wrong File");
        }

        CompassLogLoadCompleted = false;
        CompassLogLoadPercent = 0;
        _compassLogCollection.Clear();

        int numberOfSingleLineLog = 0;
        String[] lines = new string[] {};

        String temp = "";
        DateTime dateTime = new DateTime();
        LoggingLvl loggingLvl = new LoggingLvl();
        LoggingLvl.ELoggingLvl eLoggingLvl = new LoggingLvl.ELoggingLvl();
        char[] delimiters = new[] {' '};
        string threadId = "";
        string loggingMessage = "";
        int ff = 0;

        // Read the File and add it to lines string
        try {
            lines = File.ReadAllLines(fileName);
        } catch (Exception e) {
            CompassLogLoadCompleted = true;
            CoreServiceLogLoadCompleted = true;
            Console.WriteLine("The file could not be read:");
            Console.WriteLine(e.Message);
        }

        string[] parts;

        for (int j = 0; j < lines.Count(); j++) {
            string dateAndTimestamp = "";
            if (!CompassLogLoadCompleted) {
                try {
                    lock (_myLock) {
                        parts = lines[j].Split(delimiters,
                                               StringSplitOptions.
                                                   RemoveEmptyEntries);
                    }

                    numberOfSingleLineLog++;
                    foreach (string t in parts) {
                        switch (ff) {
                            case 0:
                                dateAndTimestamp = t;
                                break;
                            case 1:
                                dateAndTimestamp += " " + t.Replace(",", ".");
                                dateTime = DateTime.Parse(dateAndTimestamp);
                                dateAndTimestamp = "";
                                break;
                            case 2:
                                eLoggingLvl = loggingLvl.ParseLoggingLvl(t);
                                break;
                            case 3:
                                threadId = t;
                                break;

                            default:
                                temp += t;
                                break;
                        }

                        ff++;
                    }

                    loggingMessage = temp;

                    temp = "";

                    ff = 0;

                    loggingLvl = new LoggingLvl(eLoggingLvl);

                    CompassLogData cLD = new CompassLogData(
                        numberOfSingleLineLog,
                        dateTime,
                        loggingLvl, threadId,
                        loggingMessage);

                    _compassLogCollection.Add(cLD);

                    //loggingMessage = "";
                } catch (Exception ex) {
                    Console.Out.WriteLine("Shit Happens");
                    Console.Out.WriteLine(ex.StackTrace);
                }
                CompassLogLoadPercent = ((double) j
                                         /lines.Count())*100;
            }
        }

        CompassLogLoadCompleted = true;
        Console.Out.WriteLine("Compass LOADING DONE");

        Console.Out.WriteLine("numberOfSingleLineLog: " +
                              numberOfSingleLineLog);
        Console.Out.WriteLine("");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:15:43.827

我认为 .net 中数组的长度最大为 2GB，因此根据您放入的类型，您需要将 (2^31)/8 划分为 long[] 和一个字节，我认为它是 (2^31 )/4 大约 500 MB。你的文件比那个大吗？

对于第二个找不到 PDB 的问题，请转到工具 --> 选项 --> 调试 --> 符号并选择 Microsoft 符号服务器，这可以解决问题。

如果您有足够的信息，这也可以解决您的最后一个问题......

# c# - 具有多次读取的快速多线程列表

> ID：15024916
> 
> 赞同：0
> 
> 时间：2013-02-22T13:03:17.900
> 
> 标签：c#, .net

我想保留所有具有唯一 guid 的线程列表。如果字典中存在guid，我必须检查很多次，如果不创建线程。线程本身将检查它是否必须销毁自己并从列表中删除 guid。

但是启动和停止线程非常罕见：10.000.000 次读取中的 1 次，所以我需要一个并发列表，如果 Guid 在那里，可以快速查看。

我可以使用，`ConcurrentBag`但它不适合只是偷看。我可以使用，`ConcurrentDictionary`但它是一个字典，我不需要存储值。

我最好的选择是`ReaderWriterLock`在 a 上使用 a`HashSet`吗？

# android - 如何在Android中获得宽阔道路的正确坐标

> ID：15024919
> 
> 赞同：0
> 
> 时间：2013-02-22T13:03:21.090
> 
> 标签：android

我希望开发一个基于位置的 android 应用程序来获取当前位置坐标并显示该位置附近的地标、您正在行驶的道路等。我的问题是，如果有人在一条宽阔的道路上行驶 - 的左、右和中间坐标道路可能会有所不同。因此，它可能会给出不正确的道路名称。因此，我怎样才能获得该特定道路的正确坐标。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:08:58.603

一种选择：图像识别。根据图像确定道路的实际宽度并相应地更新您的地标位置。

另外的选择。我假设您有地标的 gps 坐标，为什么不只在实际 gps 坐标处显示地标。如果坐标在“屏幕外”，则有一个气泡或框或箭头指向屏幕外的地标，直到它“在屏幕上”

# c++ - 在主机上创建的对象上调用内核中的虚拟方法的 CUDA

> ID：15024920
> 
> 赞同：0
> 
> 时间：2013-02-22T13:03:24.437
> 
> 标签：c++, class, cuda, virtual

我的问题的描述在下面的代码中。

```
class A
{
public :
        __device__ __host__ virtual void foo() = 0;
        __device__ __host__ void foo2()
        {
                //something to do...
        }
};

class B : public A
{
public :
        __device__ __host__ B()
        { }
        //implementing virtual method foo from A
        void foo()
        {
                //something to do...
        }
};

__global__ void Test(A* ptr_device)
{
        ptr_device->foo2(); //it's okey
        ptr_device->foo(); //ERROR !!!
}

void main()
{
        B* b_host = new B();

        A* a_host = (A*)malloc(sizeof(A));
        memcpy(a_host, b_host, sizeof(A));

        a_host->foo();
        a_host->foo2();
        //it's okey

        A* a_device;
        cudaMalloc((void**)&a_device, sizeof(A));
        cudaMemcpy(a_device, a_host, sizeof(A), cudaMemcpyHostToDevice);
        Test<<<1, 1>>>(a_device);
} 
```

问题是当我想在内核上调用 A 类的虚拟方法时。首先，我创建一个对象 B，然后为 A 对象分配空间并将 B 复制到 A。在主机代码上它工作正常，但在设备代码中它在调用 foo 方法时出错

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:18:59.813

您不能只是`memcpy`周围的非 POD 对象并期望它们工作，您在这里调用了相当多的 UB。

在您的情况下发生的情况很可能是该对象有一些被复制的虚拟表指针，但在其他执行环境中没有任何意义，因为它几乎肯定不会指向那里存在的虚拟表（假设它甚至有一个）。

# cocos2d-android - cocos2d android中的图像处理？

> ID：15024927
> 
> 赞同：1
> 
> 时间：2013-02-22T13:03:58.837
> 
> 标签：cocos2d-android

根据不同的 2 屏幕分辨率，不能为每个设备使用单个图像。

那么，如何在 Cocos2d-android 中管理这个东西呢？

或者

使用 setScale() 就可以了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T09:45:46.460

您必须创建一种可以根据屏幕尺寸获取适当图像的方法。

以下步骤将帮助您获取图像

1）获取屏幕尺寸并将其存储在变量中

我用过

```
WindowManager wm = (WindowManager) this.getSystemService(Context.WINDOW_SERVICE);
display = wm.getDefaultDisplay();
if(display.getWidth()<=320)
{
    GameCons.setSCreenSize(1);
}else if(display.getWidth()<=480)
{
    GameCons.setSCreenSize(2);
}else if(display.getWidth()<=860)
{
    GameCons.setSCreenSize(3);
}else
{
    GameCons.setSCreenSize(4);
} 
```

现在我们将屏幕尺寸（1,2,3,4）存储在变量 screenSize 中

2）现在将名称分配给您正在使用的图像

假设如果我们有四个分辨率的 player.png 图像，那么将名称指定为 player_1.png player_2.png player_3.png player_4.png

这些是不同分辨率的相同图像

3）现在创建将返回图像名称的方法

```
public static String getImageURI(String name) {
        if (screenSize== 1) {
            return name + "_1.png";
        } else if (screenSize== 2) {
            return name + "_2.png";
        } else if (screenSize== 3) {
            return name + "_3.png";
        } else {
            return name + "_4.png";
        }
    } 
```

4）现在你必须在你的图层中使用这个方法，同时将名称传递给精灵或其他一些例如：

```
target = CCSprite.sprite(getImageURI("player")); 
```

您只需要在上面的方法中传递下划线之前的名称，真实姓名就像 player_1.png 但我们只传递 player

getImageURI 将根据屏幕尺寸返回一个适当的名称，假设如果我们的屏幕尺寸为 2，那么 getImageURI 将返回

player_2.png

所以代码会变成 target = CCSprite.sprite("player_2.png");//getImageURI 会返回 player_2.png

# nuget - 为整个解决方案创建 NuGet 包

> ID：15024928
> 
> 赞同：1
> 
> 时间：2013-02-22T13:04:04.713
> 
> 标签：nuget, nuget-package

我正在尝试创建一个包含我的“入门项目”的 nuget 包。这是我用来启动每个 Umbraco 项目的项目。

该启动项目具有以下结构：

```
Solution:
    Umbraco project
    CustomControls project 
```

简而言之，我希望 Nuget 能够：

```
1) download a specific version of Umbraco, and put it in the Umbraco project folder
2) Add the CustomControls project 
```

我可以将 CustomControls 项目放在“内容”文件夹中，但我无法在顶层的解决方案中获取 Umbraco 项目。现在，NuGet 似乎创造了这个：

```
Solution:
  Umbraco project => CustomControls project 
```

因此，CustomControls 项目位于 Umbraco 项目中，这不符合我的目的，因为它必须保持独立。

因此，一个解决方案中有两个单独的项目。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T06:15:40.713

Install.ps1 中的参数之一称为 $project，它是对已安装包的项目的 EnvDTE 项目对象的引用。您应该能够调用 DTE.Solution.AddFromFile() 将另一个项目添加到解决方案中。

# java - 为什么相等运算符适用于整数值直到 128 数字？

> ID：15024933
> 
> 赞同：27
> 
> 时间：2013-02-22T13:04:16.253
> 
> 标签：java, integer, equals-operator

为什么整数`==`运算符不适用于 128 和整数值之后？有人可以解释这种情况吗？

这是我的 Java 环境：

```
java version "1.6.0_37"
Java(TM) SE Runtime Environment (build 1.6.0_37-b06)
Java HotSpot(TM) 64-Bit Server VM (build 20.12-b01, mixed mode) 
```

示例代码：

```
Integer a;
Integer b;
a = 129;
b = 129;

for (int i = 0; i < 200; i++) {
    a = i;
    b = i;

    if (a != b) {
        System.out.println("Value:" + i + " - Different values");
    } else {
        System.out.println("Value:" + i + " - Same values");
    }
} 
```

控制台输出的一部分：

```
Value:124 - Same values
Value:125 - Same values
Value:126 - Same values
Value:127 - Same values
Value:128 - Different values
Value:129 - Different values
Value:130 - Different values
Value:131 - Different values
Value:132 - Different values 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-22T13:07:11.823

查看[Integer 的源代码](https://hg.openjdk.java.net/jdk6/jdk6/jdk/file/8deef18bb749/src/share/classes/java/lang/Integer.java#l596 "公共静态整数值（int i）{...}")。您可以在那里看到值的缓存。

缓存仅在您使用时发生`Integer.valueOf(int)`，而不是在您使用时发生`new Integer(int)`。您使用的自动装箱使用`Integer.valueOf`.

根据[JLS](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.1.7)，您始终可以依靠这样一个事实，即对于 -128 和 127 之间的值，在自动装箱后您会获得相同的 Integer 对象，并且在某些实现中，即使对于更高的值，您也可能会获得相同的对象。

实际上在 Java 7 中（我认为在 Java 6 的较新版本中），IntegerCache 类的[实现](http://www.docjar.com/html/api/java/lang/Integer.java.html)发生了变化，上限不再是硬编码的，但它可以通过属性“java.lang.Integer.IntegerCache.高”，因此如果您使用 VM 参数运行程序`-Djava.lang.Integer.IntegerCache.high=1000`，您将获得所有值的“相同值”。

但是 JLS 仍然保证它只到 127：

> 理想情况下，对给定的原始值 p 进行装箱将始终产生相同的参考。在实践中，使用现有的实现技术这可能是不可行的。上述规则是一种务实的妥协。上面的最后一个条款要求某些常见的值总是被装箱到无法区分的对象中。实现可能会懒惰地或急切地缓存这些。
> 
> 对于其他值，此公式不允许程序员对装箱值的身份进行任何假设。这将允许（但不要求）共享部分或全部这些引用。
> 
> 这确保了在最常见的情况下，行为将是期望的行为，而不会造成过度的性能损失，尤其是在小型设备上。例如，内存限制较少的实现可能会缓存所有字符和短整数，以及 -32K - +32K 范围内的整数和长整数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-22T13:05:53.643

根据 Java 语言规范：

> 如果被装箱的值 p 是真、假、一个字节、一个 \u0000 到 \u007f 范围内的字符，或者一个介于 -128 和 127 之间的 int 或短数字，则令 r1 和 r2 为任意两次装箱转换的结果p。r1 == r2 总是如此。

[JLS 拳击转换](http://docs.oracle.com/javase/specs/jls/se5.0/html/conversions.html#5.1.7)

[有关 int 缓存的更多信息，请参阅本文](https://blogs.oracle.com/darcy/entry/boxing_and_caches_integer_valueof)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-22T13:08:14.427

`Integer`是一个包装类`int`。

`Integer != Integer`比较实际的对象引用，其中`int != int`将比较值。

如前所述，值 -128 到 127 被缓存，因此为这些值返回相同的对象。

如果超出该范围，将创建单独的对象，因此引用将不同。

要解决这个问题：

*   制作类型`int`或
*   将类型转换为`int`或
*   采用`.equals()`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-22T13:11:57.523

Integer 对象有一个内部缓存机制：

```
private static class IntegerCache {
    static final int high;
    static final Integer cache[];

    static {
        final int low = -128;

        // high value may be configured by property
        int h = 127;
        if (integerCacheHighPropValue != null) {
            // Use Long.decode here to avoid invoking methods that
            // require Integer's autoboxing cache to be initialized
            int i = Long.decode(integerCacheHighPropValue).intValue();
            i = Math.max(i, 127);
            // Maximum array size is Integer.MAX_VALUE
            h = Math.min(i, Integer.MAX_VALUE - -low);
        }
        high = h;

        cache = new Integer[(high - low) + 1];
        int j = low;
        for(int k = 0; k < cache.length; k++)
            cache[k] = new Integer(j++);
    }

    private IntegerCache() {}
} 
```

另见 valueOf 方法：

```
public static Integer valueOf(int i) {
    if(i >= -128 && i <= IntegerCache.high)
        return IntegerCache.cache[i + 128];
    else
        return new Integer(i);
} 
```

这就是为什么你应该使用`valueOf`而不是`new Integer`. 自动装箱使用此缓存。

另见这篇文章：[https ://effective-java.com/2010/01/java-performance-tuning-with-maximizing-integer-valueofint/](https://effective-java.com/2010/01/java-performance-tuning-with-maximizing-integer-valueofint/)

使用`==`不是一个好主意，使用等于来比较值。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-22T13:06:42.927

使用`.equals()`而不是`==`.

整数值仅缓存 -127 到 128 之间的数字，因为它们最常使用。

```
if (a.equals(b)) { ... } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-22T13:15:48.480

根据您获取`Integer`实例的方式，它可能不适用于任何价值：

```
System.out.println(new Integer(1) == new Integer(1)); 
```

印刷

```
false 
```

这是因为`==`应用于引用类型操作数的运算符与这些操作数表示的值无关。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-22T13:12:27.943

这是因为`Integer`类实现逻辑。它已经为数字准备了对象，直到 128。您可以[查看 http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/lang/Integer.java](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/lang/Integer.java)源代码-jdk 例如（搜索缓存[]）。
基本上不应该使用对象来比较对象`==`，除了枚举之外的一个例外。

# php - 在 PHP 中查询 Clarizen 项目/任务

> ID：15024934
> 
> 赞同：1
> 
> 时间：2013-02-22T13:04:19.833
> 
> 标签：php, project, task

我目前正在尝试获取所有 Clarizen 活动项目的列表，以便我可以修改其任务的一些属性。我已经阅读了 Clarizen API，但它没有太多关于 PHP 查询的信息。到目前为止，我设法做的是查询所有项目，然后一一测试它们的状态。实际上，这不是一个好方法，因为我有数千个项目，并不是所有项目都一次列出。这是代码：

```
//LOGIN PROCCESS
$soapUrl = 'https://api.clarizen.com/v1.0/Clarizen.svc?WSDL';
$soapApiUrl = 'http://clarizen.com/api';

$soapConfig = array('exceptions' => 1);
$request = array();
$params = array(
    'userName' => $username,
    'password' => $password
);

$client = new SoapClient($soapUrl, $soapConfig);
$response = $client->Login($params);
$sessionId = $response->LoginResult->SessionId;
$userId = $response->LoginResult->UserId;

//Create a SOAP header containing the session ID for future requests    
$header = new SoapHeader($soapApiUrl, 'Session', array("ID"=>$sessionId));
$client->__setSoapHeaders($header);

//Create a Query object
$userQuery = new stdClass();
//Set the name of the entity type you are querying
$userQuery->TypeName = 'Project';
//Select the fields you want retrieved from that entity
$userQuery->Fields = array('Name', 'State');

/* Doesnt work...*/
/*
$userQuery->Where = new stdClass();
$userQuery->Where->LeftExpression = new stdClass();
$userQuery->Where->LeftExpression->FieldName = 'State';
$userQuery->Where->Operator = 'Equal';
$userQuery->Where->RightExpression = new stdClass();
$userQuery->Where->RightExpression->Value = new stdClass();
$userQuery->Where->RightExpression->Value->TypeName = 'State';
$userQuery->Where->RightExpression->Value->Value = 'Active';
*/
$request[] = new SoapVar($userQuery, SOAP_ENC_OBJECT, 'EntityQuery', 'http://clarizen.com/api/queries');

//Execute the request
$result = $client->Execute(array("request"=>$request)); 
```

3个问题如下：

*   使用“WHERE”子句在 PHP 中查询的正确方法是什么
*   如何获取该项目的任务，然后为它创建一个秒表。
*   如何继续查询直到 hasMore 标志为 0，或者有没有办法一次获取整个东西？

提前致谢。

# jsf-2 - JSF 2.x 服务器端文件选择对话框

> ID：15024936
> 
> 赞同：0
> 
> 时间：2013-02-22T13:04:27.167
> 
> 标签：jsf-2

使用 JSF 应用程序，是否可以向用户显示文件选择对话框以从服务器上的特定文件夹中选择配置文件？

正在考虑的情况是应用程序需要允许用户选择文件以用于工作流或其他过程。

我看过客户端文件选择器的示例，但在选择服务器上的文件时没有遇到任何问题。是否出于安全考虑而受到限制？有没有办法做到这一点？

JSF 2.x

目前我的重点是ICEFaces，但很想知道这是否适用于任何JSF框架。

# c# - 第二次在ideablade中动态设置服务器地址？

> ID：15024939
> 
> 赞同：2
> 
> 时间：2013-02-22T13:04:39.587
> 
> 标签：c#, wpf, database-connection, devforce

我有这个问题，在我的程序中我动态设置服务器地址并尝试连接到我的数据库，如果我提供的地址正确，它可以正常工作，如果不正确，则无法连接，这是正常的。之后我想更改此地址，但即使我在代码中更改它并尝试再次连接我的数据库，它仍然会记住旧配置并且仍然无法连接。我应该怎么做才能改变它？

我这样设置我的配置：

```
XmlDocument xmlDoc = new XmlDocument();
        xmlDoc.Load(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile);
        foreach (XmlElement element in xmlDoc.DocumentElement)
        {
            if (element.Name.Equals("ideablade.configuration"))
            {
                foreach (XmlNode ele in element.ChildNodes)
                {
                    if (ele.Name == "objectServer")
                    {
                        var node = ele;
                        node.Attributes["remoteBaseURL"].Value = remoteBaseURL;
                        node.Attributes["serverPort"].Value = serverPort;
                        node.Attributes["serviceName"].Value = serviceName;
                    }
                }
            }
        }
        xmlDoc.Save(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile);
        ConfigurationManager.RefreshSection("ideablade.configuration"); 
```

我尝试像这样连接到我的数据库

```
if (BeczkaModel!= null)
        {
            BeczkaModel.Disconnect();
            BeczkaModel= null;
        }

IdeaBladeConfig.Instance.ObjectServer.RemoteBaseUrl = remoteBaseURL;
IdeaBladeConfig.Instance.ObjectServer.ServerPort = (int)double.Parse(serverPort);
IdeaBladeConfig.Instance.ObjectServer.ServiceName = serviceName;
IdeaBladeConfig.Instance.ObjectServer.ClientSettings.IsDistributed=true;

BeczkaModel= new BeczkaContainer();
BeczkaModel.AuthorizedThreadId = null;  
BeczkaModel.Connect(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T03:09:25.277

数据源密钥扩展和/或自定义 IDataSourceKeyResolver 是处理不同数据库连接的方法。重要的是要意识到 EntityManager.Connect 调用没有连接到特定的数据源。它实际上是连接到一个特定的 EntityService。连接到不同 EntityService URL 的方法是使用 ServiceKey。更多信息在这里： [http](http://drc.ideablade.com/devforce-2012/bin/view/Documentation/connect-to-multiple-entityservers) ://drc.ideablade.com/devforce-2012/bin/view/Documentation/connect-to-multiple-entityservers 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T00:54:14.883

为了澄清sbellini的帖子，有两种方法可以动态确定数据库连接。第一种也是更简单的方法是使用数据源扩展。如果您有一个静态的数据库连接列表并希望在运行时在列表中进行选择，这将非常有用。第二种方法是实现 IDataSourceKeyResolver。这允许您在运行时完全确定连接字符串。

[http://drc.ideablade.com/devforce-2012/bin/view/Documentation/data-sources](http://drc.ideablade.com/devforce-2012/bin/view/Documentation/data-sources)

[http://drc.ideablade.com/devforce-2012/bin/view/Documentation/code-sample-data-source-extensions](http://drc.ideablade.com/devforce-2012/bin/view/Documentation/code-sample-data-source-extensions)

[http://drc.ideablade.com/devforce-2012/bin/view/Documentation/code-sample-custom-datasourcekeyresolver](http://drc.ideablade.com/devforce-2012/bin/view/Documentation/code-sample-custom-datasourcekeyresolver)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-25T21:30:20.790

您将能够通过实现自定义 DataSourceKeyResolver 来确定要连接到哪个数据库。

您将在 http://drc.ideablade.com/devforce-2012/bin/view/Documentation/data-sources 找到更多信息，在[http://drc.ideablade.com/devforce-2012/bin/view](http://drc.ideablade.com/devforce-2012/bin/view/Documentation/code-sample-custom-datasourcekeyresolver)[找到](http://drc.ideablade.com/devforce-2012/bin/view/Documentation/data-sources)示例[/Documentation/code-sample-custom-datasourcekeyresolver](http://drc.ideablade.com/devforce-2012/bin/view/Documentation/code-sample-custom-datasourcekeyresolver)。

# c# - What does .Net do when you declare an object without an instance?

> ID：15024940
> 
> 赞同：2
> 
> 时间：2013-02-22T13:04:47.010
> 
> 标签：c#, .net, object, memory-management

I wonder to know how the **.Net Framework** handles the *declared but not instantiated object* situation.

For example i declare an object like

```
DropDownList ddl; 
```

and do nothing about it. I know that i should do something with this variable and get a warning about it, but what i don't know is the where it will be stored.

Is there a lookup table that stores the data of all declared variables? Or is there a virtual reference for every declaration?

Edit : I just wanted to know how the memory allocated for this object declaration.

Edit2 : Whether it's a local variable or not, i'm just talking about the memory allocation structure. I wonder to know where this references stored.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T13:10:56.167

If `ddl` is a field, then the value of `ddl` will be `null`, as it is a reference type.

Any attempt to call a member on it will result in a [`NullReferenceException`](http://msdn.microsoft.com/en-gb/library/system.nullreferenceexception.aspx).

If it is a local variable it will simply be unassigned.

Value types will get the `default(T)` of their type.

The compiler itself may remove the call completely, depending on where it was declared, but this is an implementation detail.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T13:11:17.447

If you are talking about a local variable then the compiler can simply optimize it out of existence since noone can be using it (if you attempted to use it without initializing the compiler would have protested with an error). In fact the .NET 4 compiler did this for me when I tested just moments ago.

If you are talking about a field in a class then it is initialized with the [default value for its type](http://msdn.microsoft.com/en-us/library/vstudio/83fhsxwc.aspx) as part of the object construction.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T13:12:52.293

From your description, it sounds like you're talking about a local variable. When you declare a local variable *in usual implementations and without any optimizations*, then space is reserved for it on the stack (most probably), with a `null` reference as its value.

You could look into the `StackFrame` class if you want to inspect further (I've never used it).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-22T13:16:14.403

The variable is stored in your assembly. It will always have it's default value null.

In release mode (compiler is set to optimize) it's optimized and it is not stored anywhere.

If you want to know more about IL and how the compiler works, [wikipedia](http://en.wikipedia.org/wiki/Common_Intermediate_Language) has a good article to start.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-22T13:16:41.557

All variables are stored into a class or method. Variables declared into a class can be listed using **.NET Reflection** :

```
class Class1 { private int i; public string s; }
typeof(Class1).GetFields(BindingFlags.Instance); // returns all instance fields
typeof(Class1).GetFields(); // returns all instance public fields
typeof(Class1).GetProperties(); // returns all instance public properties 
```

**Variables declared into a method cannot be inspected with .NET Reflection mechanisms.**

# java - 使用 SAX 解析器解析可能重复的嵌套 XML 标记。爪哇

> ID：15024942
> 
> 赞同：1
> 
> 时间：2013-02-22T13:05:15.763
> 
> 标签：java, xml-parsing, nested, duplicates, saxparser

我的程序的概念是解析一个 XML 文件，该文件可以描述 XML 流中的一组类。每个类显然可以有几个方法和几个属性。反过来，这些方法也可以有几个参数。

以下是 XML 文件的示例：

```
<stream>
<class package="Mainpack" name="Person" visibility="public" alias="Aaron" type="class" spot="C">
    <property name="id" type="String" visibility="public"></property>
    <property name="name" type="String" visibility="public"></property>
    <method name="setID" return="void" visibility="public">
    <parameter name="name" type="string"> </parameter>
    </method>
    <method name="getID" return="String" visibility="public"></method>
</class>
</stream> 
```

每个元素（流、类等）都有一个用 getter、setter 和空构造函数描述它的类。该流包含一个类列表。类包含名称、包等的属性...以及方法和参数的列表（它们本身是单独的类）。我不会包括这些，因为我认为它们很简单。

这是我编写的 XMLHandler 类：

```
public class XMLHandler extends DefaultHandler {

Boolean currentElement = false;
String currentValue = null;

public static XMLStream xmlStream;

    public XMLClass xmlClass = null;
    public XMLMethod xmlMethod = null;
    public XMLProperty xmlProperty = null;
    public XMLParameter xmlParameter = null;

@Override
public void startElement(String uri, String localName, String qName,
        Attributes attributes) throws SAXException {
    currentElement = true;

    switch (localName) {
        case "stream":
            {
                xmlStream =  new XMLStream();
            }
        case "class":
            {
                /** Start and get attribute values */
                xmlClass = new XMLClass();
                String attr = attributes.getValue("package");
                xmlClass.setPackageName(attr);
                attr = attributes.getValue("name");
                xmlClass.setClassName(attr);
                attr = attributes.getValue("visibility");
                xmlClass.setVisibility(attr);
                attr = attributes.getValue("alias");
                xmlClass.setAlias(attr);
                attr = attributes.getValue("type");
                xmlClass.setType(attr);
                attr = attributes.getValue("spot");
                xmlClass.setSpot(attr.charAt(0));
                break;
            }
        case "method":
            {
                xmlMethod = new XMLMethod();
                String attr = attributes.getValue("name");
                xmlMethod.setName(attr);
                attr = attributes.getValue("return");
                xmlMethod.setReturnType(attr);
                attr = attributes.getValue("visibility");
                xmlMethod.setVisibility(attr);
                xmlClass.addMethod(xmlMethod);
                break;
            }
        case "property":
            {
                xmlProperty = new XMLProperty();
                String attr = attributes.getValue("name");
                xmlProperty.setName(attr);
                attr = attributes.getValue("type");
                xmlProperty.setType(attr);
                attr = attributes.getValue("visibility");
                xmlProperty.setVisibility(attr);
                xmlClass.addProperty(xmlProperty);
                break;
            }
        case "parameter":
            {
                xmlParameter = new XMLParameter();
                String attr = attributes.getValue("name");
                xmlParameter.setName(attr);
                attr = attributes.getValue("type");
                xmlParameter.setType(attr);
                xmlMethod.addParameter(xmlParameter);
                break;
            }
        }
}

/** Called when tag closing ( ex:- <name>AndroidPeople</name> 
 * -- </name> )*/
@Override
public void endElement(String uri, String localName, String qName)
        throws SAXException {

    currentElement = false;

            if (localName.equalsIgnoreCase("class"))
                xmlStream.addClass(xmlClass);
            else if (localName.equalsIgnoreCase("method"))
                xmlClass.addMethod(xmlMethod);
            else if (localName.equalsIgnoreCase("property"))
                xmlClass.addProperty(xmlProperty);
            else if (localName.equalsIgnoreCase("parameter"))
                xmlMethod.addParameter(xmlParameter);
}

@Override
public void characters(char[] ch, int start, int length)
        throws SAXException {

    if (currentElement) {
        currentValue = new String(ch, start, length);
        currentElement = false;
    }

}

} 
```

我希望逻辑是正确的。当解析器遇到流标签并设置属性时，它会创建一个 Stream 实例。当遇到一个类标签时，它也会这样做。在类的结束标记上，类实例被添加到流的类列表中。对于与类相关的方法和属性以及与方法相关的参数，此行为会重复。

我正在 Windows 应用程序中测试解析器，但您可以使用此方法：

```
public static void main(String[]args)
{
    try {

        String xmlst = "<stream>\n<class package=\"Mainpack\" name=\"Person\" "
                + "visibility=\"public\" alias=\"Aaron\" type=\"class\" spot=\"C\">\n   "
                + " <property name=\"id\" type=\"String\" visibility=\"public\"></property>\n  "
                + "  <method name=\"getID\" return=\"void\" visibility=\"public\">\n\t<parameter name=\"name\" type=\"string\">"
                + " </parameter>\n    </method>\n</class>\n</stream>";

        SAXParserFactory spf = SAXParserFactory.newInstance();
        SAXParser sp = spf.newSAXParser();
        XMLReader xr = sp.getXMLReader();
        XMLHandler xh = new XMLHandler();

        InputSource is = new InputSource();
        is.setCharacterStream(new StringReader(xmlst));
        xr.setContentHandler(xh);
        xr.parse(new InputSource(is.getByteStream()));

        XMLStream xmlStream = XMLHandler.xmlStream;

        for (int i=0; i<xmlStream.getClasses().size(); i++)
        {
            System.out.println("*** CLASS ***");
            System.out.println(xmlStream.getClasses().get(i).getClassName());
            System.out.println(xmlStream.getClasses().get(i).getType());
            for (int j=0; j<xmlStream.getClasses().get(i).getProperties().size(); j++)
            {
                System.out.println("*** PROP ***");
                System.out.println(xmlStream.getClasses().get(i).getProperties().get(j).getName());
                System.out.println(xmlStream.getClasses().get(i).getProperties().get(j).getType());
            }
            for (int j=0; j<xmlStream.getClasses().get(i).getMethods().size(); j++)
            {
                System.out.println("*** METH ***");
                System.out.println(xmlStream.getClasses().get(i).getMethods().get(j).getName());
                System.out.println(xmlStream.getClasses().get(i).getMethods().get(j).getReturnType());
                for (int k=0; k<xmlStream.getClasses().get(i).getMethods().get(j).getParameters().size(); k++)
                {
                    System.out.println("*** PARAMS ***");
                    System.out.println(xmlStream.getClasses().get(i).getMethods().get(j).getParameters().get(k).getName());
                    System.out.println(xmlStream.getClasses().get(i).getMethods().get(j).getParameters().get(k).getType());
                }
            }

        }

    } catch (IOException ex) {
        Logger.getLogger(MainFrame.class.getName()).log(Level.SEVERE, null, ex);
    } catch (ParserConfigurationException ex) {
        Logger.getLogger(MainFrame.class.getName()).log(Level.SEVERE, null, ex);
    } catch (SAXException ex) {
        Logger.getLogger(MainFrame.class.getName()).log(Level.SEVERE, null, ex);
    }
} 
```

程序在运行以下行时遇到 MalformedURLException：“xr.parse(new inputSource(is.getByteStream()));”

有人对出了什么问题有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T13:25:55.417

将您的 xml 文档另存为`.xml`文档（nuff 说）并尝试这种方法来运行您的解析器：

```
XMLReader reader = XMLReaderFactory.createXMLReader();
XMLHandler xh = new XMLHandler();
reader.setContentHandler(xh);
reader.parse(PATH_TO_FILE); 
```

而不是你的代码：

```
SAXParserFactory spf = SAXParserFactory.newInstance();
SAXParser sp = spf.newSAXParser();
XMLReader xr = sp.getXMLReader();
XMLHandler xh = new XMLHandler();

InputSource is = new InputSource();
is.setCharacterStream(new StringReader(xmlst));
xr.setContentHandler(xh);
xr.parse(new InputSource(is.getByteStream())); 
```

希望能帮助到你。

# sql - SQL：选择给定用户以前看不见的记录

> ID：15024944
> 
> 赞同：0
> 
> 时间：2013-02-22T13:05:19.297
> 
> 标签：sql, postgresql, activerecord

我有一个带有类似模式的 postgres 数据库

```
CREATE TABLE authors (
    id integer NOT NULL
);

CREATE TABLE posts (
    id integer NOT NULL,
    author_id integer,
    text text
);

CREATE TABLE comments (
    id integer NOT NULL,
    post_id integer,
    ordinal integer DEFAULT 0,
    author_id integer
); 
```

给定一个特定的`author_id`，我希望能够选择一批 20 个帖子：

1.  不包括有该作者评论的帖子。
2.  不是那个作者的帖子。
3.  是否包括该帖子的 10 条最新评论。

我认为第 1 点正在扼杀我的查询时间。到目前为止，我一直在使用内部查询来解决这一点，比如

```
SELECT * from posts
WHERE posts.id NOT IN (
   SELECT posts.id FROM posts JOIN comments ON posts.id = comments.post_id) 
```

随着我的数据库的增长，这个查询变得更糟了。我不擅长 SQL；有一个更好的方法吗？我正在使用 ActiveRecord，如果这有帮助/伤害的话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:09:32.293

用这个替换你的查询

```
SELECT * from posts p, comments c
WHERE posts.id <> c.posts.id; 
```

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T13:11:28.663

我的经验是，“不在”比什么都更能杀死查询时间。替代方案是“不存在”，或者，如果 postgresql 支持这种语法。

```
where somefield in 
(select somefield
 from etc
 except
 select somefield
 from etc) 
```

有时会使用减号来代替除外。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T14:34:48.320

### 调试呈现的查询

您提出的查询不必要地低效。首先，您可以通过在子查询中去掉多余的 JOIN 来简化：

```
SELECT *
FROM   posts
WHERE  posts.id NOT IN (SELECT post_id FROM comments) 
```

这可以重写为`LEFT JOIN / IS NULL`或使用[`NOT EXISTS`](http://www.postgresql.org/docs/current/interactive/functions-subquery.html#FUNCTIONS-SUBQUERY-EXISTS)半反连接，我希望它表现最好：

```
SELECT *
FROM   posts p
WHERE  NOT EXISTS (SELECT 1 FROM comments c WHERE c.post_id = p.id) 
```

### 完整查询

您的第 3 点不清楚：

> 是否包括该帖子的 10 条最新评论。

忽略那个，查询可能是：

```
SELECT *
FROM   posts p
WHERE  p.author_id <> $author_id -- "not a post by that author"
AND    NOT EXISTS (
   SELECT 1
   FROM   comments c
   WHERE  c.author_id = $author_id
   AND    c.post_id = p.id) -- exclude "post that has a comment by that author"
--  ORDER  BY ??undefined??, maybe id DESC
LIMIT  20 
```

`posts.author_id`应该定义`NOT NULL`或者你必须使用：

```
p.author_id IS DISTINCT FROM $author_id 
```

有很多行，**索引**是性能的关键。我希望`posts.id`成为主键，因此它会自动编制索引。如果您还没有，请添加此多列索引：

```
CREATE INDEX comments_pa_idx ON comments (post_id, author_id); 
```

# wordpress - 如何使现有的 WordPress 主题具有响应性？

> ID：15024946
> 
> 赞同：-1
> 
> 时间：2013-02-22T13:05:33.460
> 
> 标签：wordpress, wordpress-theming

我有一个网站，我已经应用了 WordPress 主题。但它没有响应，并且在移动设备和其他手持设备上无法正常查看。那么有没有办法让现有的应用主题响应？提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-10T23:12:23.443

当然你可以让它响应。

但是，这可能需要一点工作。您正在改造现有建筑物。

以下是我正在做的一些事情：

**设置 CSS 断点**

在此处查看更多信息：http: [//css-tricks.com/snippets/css/media-queries-for-standard-devices/](http://css-tricks.com/snippets/css/media-queries-for-standard-devices/) >这基本上设置了在对应于不同设备屏幕宽度的不同屏幕宽度处更改 CSS 的能力.

基本上，您可以对网站的现有布局/外观做很多魔术，只需修改 CSS。

除了修改布局外，您还可以从基本样式表中提取花哨的 CSS3 内容（装饰），仅以较大的尺寸显示。

关于这一点可以说的还有很多。CSS 是一门艺术。

您可以使用响应式页面测试器插件——这真的很酷：[http ://wordpress.org/plugins/responsive-page-tester/](http://wordpress.org/plugins/responsive-page-tester/)

**使图像响应**

好吧，在过去的几年里有很多关于这个的讨论——但这似乎对我有用。使用[http://responsiveimg.com/](http://responsiveimg.com/)（是否有使用此功能的 WP 插件？不确定。）您可以查看[http://wordpress.org/plugins/simple-responsive-images/](http://wordpress.org/plugins/simple-responsive-images/)。我喜欢[http://responsiveimg.com/](http://responsiveimg.com/)因为我可以*看到*它确实用适当的大小替换了血腥的图像。

您不仅需要关注*外观*，还需要关注页面重量。

如果您需要*更改*图像大小以匹配所需的断点，则需要重建图像。这个插件非常适合重建图像和设置大小：[http ://wordpress.org/plugins/simple-image-sizes/](http://wordpress.org/plugins/simple-image-sizes/)

**选择性地隐藏或显示东西**

你可以使用这个插件，它可以让你使用简码来隐藏或显示移动/桌面的东西：[http](http://wordpress.org/plugins/wp-mobile-detect/) ://wordpress.org/plugins/wp-mobile-detect/ 。如果你更懂技术，加载这个插件可以让你使用[https://code.google.com/p/php-mobile-detect/](https://code.google.com/p/php-mobile-detect/)，你可以访问那里的所有功能。（参见[http://www.lukew.com/ff/entry.asp?1392](http://www.lukew.com/ff/entry.asp?1392)）。无论如何，如果您使用这些功能，您可以在模板级别隐藏/显示，而不仅仅是编辑窗口级别。

**将菜单转换为移动设备尺寸的适合移动设备的菜单**

在某个中断点，您需要折叠菜单。这个付费的可能对你有用：http: [//labs.sevenspark.com/UberMenu](http://labs.sevenspark.com/UberMenu)。你也可以试试这个：[http](http://wordpress.org/plugins/responsive-select-menu/) ://wordpress.org/plugins/responsive-select-menu/ 。这真是太棒了。

**调整视频大小**

这里：[http ://wordpress.org/plugins/fitvids-for-wordpress/](http://wordpress.org/plugins/fitvids-for-wordpress/)

**或者，完全服务于不同的主题**

WP Touch Pro 很棒 — [http://www.bravenewcode.com/wptouch/](http://www.bravenewcode.com/wptouch/)。它具有很大的默认基调。

优点：

*   从移动“从头开始”开始，而不是尝试将可能很重的桌面网站改造成您的移动设备
*   适合您需要的更改
*   利用为您完成的大量移动代码和设计

缺点：

*   它的“外观”可能与您当前的网站完全不同
*   自定义功能（例如自定义帖子类型或特殊主题代码）将不存在，并且必须重新创建或省略

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T13:17:22.510

如果主题不是“响应式”，则没有切换使其响应式。

要使主题“响应式”，需要了解使主题响应式的一般知识。

一般来说，如果页面的格式可以根据给定的查看窗口进行调整，则将主题归类为**响应式。**这要么是通过用户调整浏览器的大小，要么是通过用户在不同尺寸的设备（如手机）上查看页面。

要了解如何在一般意义上实现这一点，特别是对于 WordPress，需要一个更具体的问题。

要对 WordPress 主题进行任何更改，首先您必须了解 WordPress 主题结构和**WordPress 模板层次结构**。

希望这有助于为您指明正确的方向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-07T06:22:31.483

使 WordPress 主题响应的一个简单建议：

首先，您可能会发现一些与您现有主题相匹配的响应式 WordPress 主题，然后您可能会改进一些因应用新主题而影响您的外观的更改。

这是您可以尝试的第一个解决方案，因为它比第二个简单。如果它不适合您，那么您可以继续更改 CSS 以便通过创建子主题使其响应。

# c - 创建线程循环

> ID：15024948
> 
> 赞同：0
> 
> 时间：2013-02-22T13:05:40.950
> 
> 标签：c, multithreading, sockets, winapi, loops

我正在尝试使用 C++ 制作异步服务器侦听器。我可以编写没有异步的简单侦听器，但现在我遇到了问题`CreateThread`。

例如，如果客户端已连接，控制台给了我关于此的结果 + 嗅探器可以修复它，10 秒后客户端必须再次向我发送具有不同数据的相同数据包。我的控制台没有给我关于那个数据包的结果，但是嗅探器可以看到那个数据包......如果有人能看到我的问题，请解释一下。

```
#include <winsock2.h>
#include <windows.h>
#include <fcntl.h>
#include <string.h>
#include <stdlib.h>
#include <errno.h>
#include <stdio.h>

DWORD WINAPI SocketHandler(void*);

int main(int argv, char** argc){

    //The port you want the server to listen on
    int host_port = 7878;

    //Initialize socket support WINDOWS ONLY!
    unsigned short wVersionRequested;
    WSADATA wsaData;
    int err;
    wVersionRequested = MAKEWORD( 2, 2 );
     err = WSAStartup( wVersionRequested, &wsaData );
    if ( err != 0 || ( LOBYTE( wsaData.wVersion ) != 2 ||
            HIBYTE( wsaData.wVersion ) != 2 )) {
        fprintf(stderr, "Could not find useable sock dll %d\n",WSAGetLastError());

    }

    //Initialize sockets and set any options
    int hsock;
    int * p_int ;
    hsock = socket(AF_INET, SOCK_STREAM, 0);
    if(hsock == -1){
        printf("Error initializing socket %d\n",WSAGetLastError());

    }

    p_int = (int*)malloc(sizeof(int));
    *p_int = 1;
    if( (setsockopt(hsock, SOL_SOCKET, SO_REUSEADDR, (char*)p_int, sizeof(int)) == -1 )||
        (setsockopt(hsock, SOL_SOCKET, SO_KEEPALIVE, (char*)p_int, sizeof(int)) == -1 ) ){
        printf("Error setting options %d\n", WSAGetLastError());
        free(p_int);

    }

    free(p_int);

    //Bind and listen
    struct sockaddr_in my_addr;

    my_addr.sin_family = AF_INET ;
    my_addr.sin_port = htons(host_port);

    memset(&(my_addr.sin_zero), 0, 8);
    my_addr.sin_addr.s_addr = INADDR_ANY ;

    if( bind( hsock, (struct sockaddr*)&my_addr, sizeof(my_addr)) == -1 ){
        fprintf(stderr,"Error binding to socket, make sure nothing else is listening on this port %d\n",WSAGetLastError());

    }
    if(listen( hsock, 10) == -1 ){
        fprintf(stderr, "Error listening %d\n",WSAGetLastError());

    }

    //Now lets to the server stuff

    int* csock;
    sockaddr_in sadr;
    int    addr_size = sizeof(SOCKADDR);

    while(true){
        printf("waiting for a connection\n");
        csock = (int*)malloc(sizeof(int));

        if((*csock = accept( hsock, (SOCKADDR*)&sadr, &addr_size))!= INVALID_SOCKET ){
            printf("Received connection from %s",inet_ntoa(sadr.sin_addr));
            CreateThread(0,0,&SocketHandler, (void*)csock , 0,0);
        }
        else{
            fprintf(stderr, "Error accepting %d\n",WSAGetLastError());
        }
    }

}

DWORD WINAPI SocketHandler(void* lp){

    int *csock = (int*)lp;
    char buffer[1024];  
    int buffer_len = 1024;
    int bytecount;
    memset(buffer, 0, buffer_len);
    if((bytecount = recv(*csock, buffer, buffer_len, 0))==SOCKET_ERROR){
        fprintf(stderr, "Error receiving data %d\n", WSAGetLastError());   
    }
    printf("Received bytes %d\n Received string \"%s\"\n", bytecount, buffer);

    char buff[1] = {0x11};        
    if((bytecount = send(*csock, buff, 1, 0))==SOCKET_ERROR){
        fprintf(stderr, "Error sending data %d\n", WSAGetLastError());    
    }

    printf("Sent bytes: %d. Send Message: %s\n ", bytecount,buff);

    free(csock);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:15:14.050

竞争条件很可能是您的问题的原因。您在堆栈上声明 csock，然后将其传递给 SocketHandler。问题是，由于 csock = accept() 处于循环中，因此 csock 的值很可能在 SocketHandler 获取并复制之前发生更改。解决方案是使用 malloc 动态分配 csock，然后让 SocketHandler 释放它。

即使这不是您的特定问题的原因，在您修复它之前，此代码也永远不会可靠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-07T17:30:16.303

CreateThread 不会循环或任何东西。您需要将代码放入循环中。像这样的东西：

```
DWORD WINAPI SocketHandler(void* lp) {
  for(;;) {
    /* Code here */
  }
  return EXIT_SUCCESS;
} 
```

# c# - 在运行时 C# 期间使用 Microsoft 应用程序日志块处理后备案例

> ID：15024957
> 
> 赞同：1
> 
> 时间：2013-02-22T13:06:12.357
> 
> 标签：c#, logging, enterprise-library, enterprise-library-5

请让我知道您对以下查询的想法，

在运行时，如果我必须将写入日志的路径更改为默认路径，如何使用 Microsoft Logging Application Block 实现相同的操作？

假设，我正在将日志写入共享驱动器。网络丢失。从那时起，我必须将日志写入过程重定向到我的本地路径。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T08:04:32.693

您可以使用特殊来源`Logging Errors & Warnings`作为后备配置。

您的配置通常会记录到共享文件跟踪侦听器。此外，当您配置`specialSource`for`Logging Errors & Warnings`时，它将首先尝试登录到您的共享文件跟踪侦听器，如果失败，它将回退到您在`Logging Errors & Warnings`部分中配置的此平面文件跟踪侦听器。

例如：

```
<specialSources>
    <!-- other configurations related with unprocessed categories or all events can be placed here -->
    ....
    <!-- this will be in action when an error occurs during logging -->
    <errors switchValue="All" name="Logging Errors & Warnings">
     <listeners>
      <add name="Local File Trace Listener" />
     </listeners>
    </errors> 
```

您可以[在此处](http://msdn.microsoft.com/en-us/library/dd203279.aspx#config_specialtraces)和[此处](http://www.education.vic.gov.au/devreskit/appdev/application%20blocks/logging/logging-standards-details.htm)查看更多信息。

# php - 如何删除它后面的所有数字并只保留最后一个

> ID：15024958
> 
> 赞同：0
> 
> 时间：2013-02-22T13:06:15.123
> 
> 标签：php, regex

我想删除除最后一个以外的所有数字。

例子：

```
test test 1 1 1 255 255 test 7.log 
```

我想通过以下方式进行转换：

```
test test test 255 7.log 
```

我尝试了很多组合，但我发现这个结果最好的是错误的：

```
test test 55 test 7.log 
```

我感谢大家的宝贵帮助，这个网站很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:40:51.147

如果您需要删除除最后一个之外的所有数字：

```
$file = "test test 1 1 1 255 255 test 7.log";
list($name, $ext) = explode('.', $file);
// split the file into chunks
$chunks = explode(' ', $name);
$new_chunks = array();
// find all numeric positions
foreach($chunks as $k => $v) {
    if(is_numeric($v)) 
        $new_chunks[] = $k;
}
// remove the last position
array_pop($new_chunks);
// for any numeric position delete if from our list
foreach($new_chunks as $k => $v) {
        unset($chunks[$v]);
}
// merge the chunks again.
$file = implode(' ', $chunks) . '.' .$ext;
var_dump($file); 
```

输出：

```
string(20) "test test test 7.log" 
```

* * *

如果要删除所有重复的数字，则：

```
$file = "test test 1 1 1 255 255 test 7.log";
list($name, $ext) = explode('.', $file);
$chunks = explode(' ', $name);
$new_chunks = array();
$output = array();
foreach($chunks as $k => $v) {
    if(is_numeric($v)){
        if(!in_array($v, $new_chunks)) {
        $output[] = $v;
        $new_chunks[] = $v;
    }} else 
        $output[] = $v;
}
var_dump(implode(' ', $output). '.' .$ext); 
```

输出：

```
string(26) "test test 1 255 test 7.log" 
```

# bash - 如何 ls -*.apk？

> ID：15024963
> 
> 赞同：0
> 
> 时间：2013-02-22T13:06:24.313
> 
> 标签：bash, shell, adb

我正在编写一个 java 程序来运行一个 sh 脚本。同时在许多设备中安装许多 apk。但我的脚本有问题，我不知道为什么。脚本的代码是

```
#!/bin/bash

checkParameter() {

        echo "$1"
        if [ -d $1 ]; then
            echo "$1 est bien un repertoire"
        else 
            echo "Vérifier si vous avez bien séléctionné un reperoire"
        fi

    }
    # pour chercher les devices connectés
 devices(){
 adb devices > devices.txt
    }

 install(){
    echo "Debut de l'installation"

         a=`ls $1 *.apk | wc -l`

    for SERIAL in $(adb devices | tail -n +2 | cut -sf 1);
    do  

        echo "le nombre des Applications à installer $a"

        for APKLIST in $(ls $1 *.apk);
        do
            if [ $a -eq 0 ] 
            then
                break;
            fi

            echo "Installatroning $APKLIST on $SERIAL"
            #adb -s $SERIAL install  $1/$APKLIST &
        #adb bugreport > bug.txt
        done
        $a = `expr $a - 1`
    done
 echo "La fin de l'Installation "
 }

    checkParameter
    devices
    install

echo 'exit normally'

exit 0 
```

我有一个问题，一些指令未知并且脚本永远不会完成。它一直在运行，直到我按下一个键

```
 a=`ls $1 *.apk | wc -l` unkown 
```

输出：

```
est bien un repertoire
Debut de l'installation
./codes/adb.sh: ligne 24: =3 : commande introuvable
le nombre des Applications à installer 
ls: impossible d'accéder à *.apk: Aucun fichier ou dossier de ce type
expr: erreur de syntaxe
./codes/adb.sh: ligne 41: = : commande introuvable
La fin de l'Installation 
exit normally 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T13:45:23.083

以下陈述不正确：

```
$a = `expr $a - 1` 
```

周围不应有空格`=`。将其更改为：

```
a=`expr $a - 1` 
```

或者，您也可以将其写为：

```
((a--)) 
```

# maven - 配置Sonar和maven分析多语言项目

> ID：15024971
> 
> 赞同：1
> 
> 时间：2013-02-22T13:07:02.150
> 
> 标签：maven, sonarqube

我想知道是否可以在 sonar-project.properties 文件中指定不同的语言来分析，例如，java script 和 xml，它们都在同一个文件夹中？

谢谢你的帮助！

* * *

## 添加

例如，我有以下项目结构：

客户端
pom.xml
|
|-----用户界面
|-----pom.xml
|
|-----核心
|-----pom.xml

在 UI 文件夹中，我在核心文件夹中有不同类型的文件（js、html、xml）和 maven java 项目。我可以将声纳瞄准 UI 文件夹，以便它递归检查此文件夹和子文件夹中的 .js、.html 和 .xml 文件吗？我试图为一个模块指定几种语言（用逗号分隔），但这没有效果。谢谢！

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:47:28.667

是的，这是可能的。您可以查看以下“web+Javascrip”示例项目：[https ://github.com/SonarSource/sonar-examples/tree/master/projects/languages/multi-language/multi-language-source-files-in-同目录](https://github.com/SonarSource/sonar-examples/tree/master/projects/languages/multi-language/multi-language-source-files-in-same-directory)

请注意，Sonar 和 Sonar Runner 版本有一些要求（在[README 文件](https://github.com/SonarSource/sonar-examples/blob/master/projects/languages/multi-language/multi-language-source-files-in-same-directory/README.md)中描述）。

# jquery - JQuery Ajaxfrom 和 submitHandler 它们是如何协同工作的？

> ID：15024974
> 
> 赞同：1
> 
> 时间：2013-02-22T13:07:08.313
> 
> 标签：jquery, jquery-validate, ajaxform

我试图将 Jquery Validate 与 submitHandler 和 Jquery 插件 AjaxForm 放在一起。下面的代码没有给出任何错误，但它没有调用 php 文件，或者它似乎在某个地方死了。不幸的是，萤火虫我没有错误。不使用 submitHandler 它可以正常工作。所有必要的文件都已加载。

```
$('#form-ev').validate({    
  rules: {
    .....
  }, //end rules
  messages: {
    ......
  },
  submitHandler: function(form) {
    $('.loading').fadeIn('slow');
    var insertOptions = { 
      url:       '/js/ajax/add.php',
      type:      'post',
      dataType:  'json', 
      clearForm: true,
      success: function(html) {
        if (html==1) {
          $('.loading').fadeOut();
          $('.success').delay(1500).fadeIn('slow').delay(2000).fadeOut('slow');
        } else {
          $('.error').show('slow').delay(2000).hide('slow');
        }
      }
    };

    $('#form-ev').ajaxForm(insertOptions);  
  }
}); 
```

有人可以帮我理解我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T13:39:21.163

您是否尝试过替换此行：

```
$('#form-ev').ajaxForm(insertOptions); 
```

和 ：

```
$('#form-ev').ajaxSubmit(insertOptions); 
```

# concurrency - Torquebox 中用于并发处理的 JMS 消息传递的替代方案

> ID：15024980
> 
> 赞同：0
> 
> 时间：2013-02-22T13:07:22.880
> 
> 标签：concurrency, jms, jruby, message-queue, torquebox

我有一个应用程序定期调用一些数据服务（使用扭矩箱调度程序），当数据集可用时，它应该分别处理每个“数据记录”。

我想同时处理这些记录以获得更好的性能，我的第一个想法是设置 jms 队列（在盒子的扭矩箱中可用），以便计划的作业将所有接收到的数据放入队列中，并且每条记录都会被挑选up（对于连接的多个接收器之一）进行处理。

但是，在同一个应用程序的元素之间放置 JMS 队列不是过度工程吗？您可以在这里建议任何其他方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T20:27:34.773

JMS 队列可能根本不是一个糟糕的解决方案，请尝试一下，看看它是如何为您工作的。当它们像在 Torquebox 中一样易于使用时，就不需要过度设计了。

如果您想要较少涉及的内容，我建议使用 Java 自己的[BlockingQueue](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html) s，[LinkedBlockingQueue](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/LinkedBlockingQueue.html)或[ArrayBlockingQueue](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ArrayBlockingQueue.html)取决于具体的用例。

这些只是像数组或散列这样的常规集合，因此您需要在某处创建它们并将它们传递到您希望能够从中发布和使用的组件中。它们也没有像 JMS 队列那样的任何确认概念。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T16:44:58.510

由于 HornetQ 是 JBoss/Torquebox 的一部分，然后使用消息处理器来处理消息，如何使用 Java 消息队列（如您所提到的）。您还可以在torquebox.rb（或.yml）中指定并发级别。

Your_Scheduled_Job -> /queues/my_queue -> [TorqueBox::Messaging::MessageProcessor](http://goo.gl/eOtQx)

在您的 config/torquebox.rb 文件中，您可以指定并发和名称消息处理器：

```
queue '/queues/my_queue' do
  processor MyMessageProcessor do
    concurrency 5
  end
end 
```

消息处理器将同时处理队列中的消息，而不需要任何其他步骤。

我还在尝试使用 Torquebox 和 Ruby 并发，而这些天我正在尝试实现这一点......

# opengl - OpenGL 纹理映射 glActivetexture 与 glEnable

> ID：15024985
> 
> 赞同：0
> 
> 时间：2013-02-22T13:07:45.613
> 
> 标签：opengl, texture-mapping

我正在查看 OpenGL 示例，在创建对象之前，这两个示例遵循不同的方式。这两个例子有什么区别？

1)

```
glActiveTexture(GL_TEXTURE0);
glBindTexture(GL_TEXTURE_2D,myImg);

glActiveTexture(GL_TEXTURE1);
glBindTexture(GL_TEXTURE_2D,myImg2); 
```

2)

```
glEnable(GL_TEXTURE_2D);
glBindTexture(GL_TEXTURE_2D, _textureId[0]);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T13:29:55.517

在第一个示例中，我们激活两个单元并为每个单元分配一个纹理。但是示例 2 不同。它在当前活动层上启用 2D 纹理映射并设置过滤参数。关键概念是 OpenGL 中的纹理单元。