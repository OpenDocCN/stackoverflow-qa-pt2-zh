# StackOverflow 问答 15935000-15935999

# c# - Azure 表存储，table.Execute 返回无效实体

> ID：15935001
> 
> 赞同：1
> 
> 时间：2013-04-10T19:44:26.017
> 
> 标签：c#, .net, azure, azure-table-storage

我是天蓝色表的新手，我只想创建表，插入项目并将其取回。

我有实体类：

```
public class UserEntity : TableEntity
{
    public string ID { get; set; }

    public string Name { get; set; }

    public string Surname { get; set; }

    public string Email { get; set; }

    public DateTime RegistrationTime { get; set; }

    public string Password { get; set; }

    public int Country { get; set; }

    public UserEntity() { }

    public UserEntity(MyUser user)
    {
        this.ID = user.ID.ToString();
        this.Name = user.Name;
        this.Surname = user.Surname;
        this.Email = user.Email;
        this.RegistrationTime = user.RegistrationTime;
        this.Password = user.Password.ToString();
        this.Country = user.Country;

        this.PartitionKey = this.Country.ToString();
        this.RowKey = this.Email;
    }
} 
```

创建表我使用函数：

```
public static void CreateTable()
    {
        CloudStorageAccount storageAccount = CloudStorageAccount.Parse(Settings.Azure_Storage_ConnectionString);
        CloudTableClient tableClient = storageAccount.CreateCloudTableClient();
        CloudTable table = tableClient.GetTableReference("TBUsers");
        table.CreateIfNotExists();
    } 
```

插入新实体：

```
public void SaveAsNew()
    {
        UserEntity user = new UserEntity(this);

        CloudStorageAccount storageAccount = CloudStorageAccount.Parse(Settings.Azure_Storage_ConnectionString);
        CloudTableClient tableClient = storageAccount.CreateCloudTableClient();
        CloudTable table = tableClient.GetTableReference("TBUsers");

        TableOperation insertOperation = TableOperation.Insert(user);
        var res = table.Execute(insertOperation);
    } 
```

创建和插入都可以正常工作（至少不要抛出异常并且 table.Execute 返回正确的实体）

但我有问题，我想拿到我的物品。代码看起来像这样

```
CloudStorageAccount storageAccount = CloudStorageAccount.Parse(Settings.Azure_Storage_ConnectionString);
        CloudTableClient tableClient = storageAccount.CreateCloudTableClient();
        CloudTable table = tableClient.GetTableReference("TBUsers");
         TableOperation retrieveOperation = TableOperation.Retrieve<UserEntity>(pkey, rkey);
        TableResult retrievedResult = table.Execute(retrieveOperation); 
```

retrievedResult.Result - 是一个奇怪的 UserEntity 对象。它的 PartitionKey 和 RowKey 很好，但其他属性为 null 或 0（默认值）。

难道我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-05T15:47:52.067

您可能需要一个默认构造函数来创建 UserEntity 实例。添加默认构造函数并重试

# java - ${getText(fieldName)} 在客户端验证中不显示任何内容

> ID：15935002
> 
> 赞同：2
> 
> 时间：2013-04-10T19:44:35.913
> 
> 标签：java, validation, struts2, resourcebundle, ognl

我已经使用 Struts2 框架实现了客户端验证机制，但是当发生错误时 `${getText(fieldName)}`，属性文件中存在的变量显示为空，例如，它显示`"The field is required"`为`"The field username is required"`

我在属性文件中有这个：

```
errors.required=Field ${getText(fieldName)} is required. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:13:53.667

只需在属性文件中定义键值对

```
username=username 
```

假设这`username`是`fieldName`一个`-validation.xml`

# events - 如何使用 Joomla 插件的菜单点击事件？

> ID：15935008
> 
> 赞同：0
> 
> 时间：2013-04-10T19:44:50.567
> 
> 标签：events, plugins, joomla, menu, triggers

我想仅在某些菜单或类别上的菜单选择上使用 Joomla 插件的事件。这是怎么做的？是否有当前的插件可以做到这一点，以便我可以查看代码？

瑞克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T23:35:25.077

我在[https://github.com/betweenbrain/hideitems/blob/master/hideitems.php有类似的东西](https://github.com/betweenbrain/hideitems/blob/master/hideitems.php)

基本思想是做类似的事情：

```
function onAfterRender() {

    // The curent item ID
    $itemId      = JRequest::getInt('Itemid', 0);    
    // Parameter with item ids to run they are the item ID 
    $targetIds   = $this->params->get('targetIds');

    // Check if we are viewing a target ID
    if (strpos($targetIds, $itemId)){

        // do something awesome
        return TRUE;
    }

    return FALSE:

} 
```

# .net - 设置控件内容比将类绑定到 WPF 中的选择器控件更好的方法？

> ID：15935011
> 
> 赞同：3
> 
> 时间：2013-04-10T19:44:59.567
> 
> 标签：.net, wpf

我有一个分为 4 个面板的应用程序。如下图所示，有一个主绘图区、一个顶部面板、一个左侧菜单面板和一个右侧子菜单面板。子菜单的内容由选择哪个顶部菜单按钮决定，子菜单的内容由选择哪个右菜单决定。

例如，这是单击网络设计和测试（扩展器上的第一个按钮）时显示的内容。单击 test2（扩展器上的第二个按钮）时，右侧面板中应该有一组不同的按钮。

由于地图的性能问题，我没有使用选项卡控件，已经有 10,000 多个潜在图形对象，我不想将该数字乘以 8。

我目前正在按照这篇文章中的说明进行操作：

[在 WPF 中更新具有不同内容的列表框按钮单击](https://stackoverflow.com/questions/15908243/updating-a-listbox-with-different-content-on-button-clicks-in-wpf/15910760?noredirect=1#comment22698161_15910760)

到目前为止效果很好……但每个下拉菜单可能有多达 8 个选项，并且一些顶部选项卡有多达 8 个扩展器！使用上面的代码需要做很多工作......希望有一种更“简洁”的方式来处理它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:05:00.020

为视图创建一个专用的 ViewModel 对象。ViewModel 应该充当不同 UI 状态的状态机。它应该接受 Commands 和 PropertyChanges，因此它将计算并更改 WPF 控件绑定到的结果属性。

它通常被称为 MVVM 模式，在 WPF 中被广泛使用。Model 是您的原始数据，View 是您的 Control，而 ViewModel 是连接两者的状态机。例如查看[这篇文章](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx "MSDN 杂志 - WPF 和 MVVM")。

# jquery - jQuery 自动锚点导航 - 添加像素偏移

> ID：15935023
> 
> 赞同：1
> 
> 时间：2013-04-10T19:45:49.150
> 
> 标签：jquery, css, automation, anchor

直播页面：[http ://wlvrtn.com/sites/nms/page.php](http://wlvrtn.com/sites/nms/page.php)

我添加了一些 jQuery（感谢 StackOverflow 的帮助）来自动化章节链接的目标，这样第三章链接将指向页面上的第三章（文章）。

正如您从实时页面中看到的那样，我的粘性导航栏妨碍了每一章的开头。**我想将每个 jquery 锚点垂直偏移 200px，以便正确显示每章的开头。**

HTML - 章节导航：

```
<nav id="chapters">
    <ul>
        <li><a href="#">Chapter One</a></li>
        <li><a href="#">Chapter Two</a></li>
        <li><a href="#">Chapter Three</a></li>
    </ul>
</nav> 
```

HTML - 文章：

```
<article class="clearfix">  
    <h1>Chapter One</h1>
    ...
</article> 
```

jQuery：

```
// Chapters - find the nav & headers
var nav = $('#chapters li a'),
    articles = $('#main article > h1');

// Chapters - now assign an id/href to each
nav.each(function (i) {
    nav.eq(i).attr('href', '#article-' + i);
    articles[i].id = 'article-' + i;
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T19:55:07.523

您可以通过重新排列元素来做到这一点：

```
<h1>Chapter One<a id="article-0" style="position: relative; top: -200px;">&nbsp;</a></h1> 
```

在这里，您要链接的锚点不是`h1`内部的“存根”元素，而是`h1`偏移了几个像素。

显然 CSS 类会好一些：

```
.v-offset { 
    position: relative;
    top: -200px;
}

...

<h1>Chapter One<a id="article-0" class="v-offset">&nbsp;</a></h1> 
```

您可以使用jQuery的[`append()`](http://api.jquery.com/append/)方法来动态写入锚点

```
nav.each(function (i, ele) {
    $(ele).attr('href', '#article-' + i); // $(ele) == $nav.eq(i)
    $(articles[i]).append('<a id="article-' + i + '" class="v-offset">&nbsp;</a>');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T19:48:10.267

将**margin-left:200px**或**padding-left:200px** 添加到要缩进的项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T19:50:48.557

如果您想简单地移动列出的文本，您也可以执行以下操作：

HTML

```
<ul>
    <li>test</li>
    <li>test2</li>
    <li>test3</li>
</ul> 
```

CSS

```
 ul{
        margin-left:200px;
    } 
```

*或者*

HTML

```
<ul>
    <li>test</li>
    <li>test2</li>
    <li>test3</li>
</ul> 
```

CSS

```
li{
    text-indent:200px;
    list-style-type: none;
} 
```

# jquery - 每个人有 60% 的几率死去，还有 40% 的几率活着

> ID：15935030
> 
> 赞同：-9
> 
> 时间：2013-04-10T19:46:04.680
> 
> 标签：jquery

在 jQuery 中需要帮助来创建方程以随机顺序获得结果。

假设我们有 10 个人。

每个人有 60% 的机会死去，还有 40% 的机会活着。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:00:25.543

给你：http: [//jsfiddle.net/g2JMK/2/](http://jsfiddle.net/g2JMK/2/)

```
function Person(isDead) {
    this.dead = isDead;
}

$(function(){
    var people = new Array();
    initPeople(people);
    $.each(people, function(){
        $('#foo').append('<p>' + this.dead + '</p>');
    });
});

function initPeople(people) {
    for(var i = 0; i < 10; i++){
        people.push(new Person(Math.ceil(Math.random()*10) < 7));
    }
} 
```

这一行：

```
Math.ceil(Math.random()*10) < 7 
```

获取一个范围为 10 的随机数并检查它是否小于 7。因此，10 分之 6 = 60% 的机会为真。

# python - NOAA 如何将 City,St 转换为 lat long？

> ID：15935034
> 
> 赞同：1
> 
> 时间：2013-04-10T19:46:13.450
> 
> 标签：python, noaa

NOAA REST 服务提供了一种获取天气信息的方法。我注意到 NOAA 网站上有一个文本框，我可以输入 City,St 以获取该位置的天气信息。

使用 REST 服务，它仅列出有限的 City,St 及其对应的 Lat,Lng：

`http://graphical.weather.gov/xml/sample_products/browser_interface/ndfdXMLclient.php?listCitiesLevel=1234`

但是，如果我想查看 的 Lat,Lng `MCRAE, GA`，它不会在 REST 服务中列为 City,St。

我的目标是使用任何 City,St 作为 python 程序的输入，该程序将检索该位置的天气数据。这最终涉及找出 City,St 坐标，然后使用坐标构建 url。我希望 REST 服务能给我坐标，但似乎不可能。

我的问题是 NOAA 如何确定用于任何给定 City,St 的正确坐标？如果可能的话，是否有任何 REST 服务可以轻松返回该数据？我宁愿不必模拟用户输入然后屏幕抓取坐标。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:29:31.720

使用[openstreetmap.org](http://wiki.openstreetmap.org/wiki/Main_Page)：

```
import urllib2
import urllib
import json

url = 'http://nominatim.openstreetmap.org/search?'
place = 'MCRAE, GA'
params = urllib.urlencode(dict(q=place, format='json'))
# print(url+params)
response = urllib.urlopen(url+params)
data = json.loads(response.read())[0]
print(data['lon'], data['lat']) 
```

产量

```
(u'-82.9006993', u'32.0679541') 
```

# c++ - 系统托盘中的菜单没有每个 QActions

> ID：15935044
> 
> 赞同：0
> 
> 时间：2013-04-10T19:46:43.580
> 
> 标签：c++, qt, qmenu

我正在运行 osx mountain lion（10.8.3），当我运行下面链接中的代码时，我有一个只有一个操作的菜单......

[https://gist.github.com/Supm4n/8c705154b8586618f4cc](https://gist.github.com/Supm4n/8c705154b8586618f4cc)

另一个奇怪的事情是，当我只使用 goOnline 以外的一个操作进行编译时，当我单击系统托盘图标时，我看不到任何菜单。

我的 Qt 版本是 5.0.1

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T14:08:34.080

在 MacOS 上，Qt 以特殊方式处理一些“标准”MacOS 菜单项。您正在使用“退出”和“关于”，它们由 Qt 确定为 MacOS 的“标准”。

详细的描述和定制细节在 QMenuBar 的官方 Qt 文档[http://qt-project.org/doc/qt-4.8/qmenubar.html](http://qt-project.org/doc/qt-4.8/qmenubar.html)

在上面的链接下查看“Mac OS X 上的 QMenuBar”部分。

# javascript - JS 函数总是返回 False

> ID：15935047
> 
> 赞同：0
> 
> 时间：2013-04-10T19:46:50.410
> 
> 标签：javascript

下面的函数总是返回 false，我想我知道为什么，但不知道如何解决它。它验证的单选表单是使用循环生成的，我将每个单选字段的 ID 设置为“myfilling”，我认为这就是我出错的地方。

功能是：

```
if(!document.getElementById('myfilling').checked) {
    var resultloc=document.getElementById("fillingerror");
    resultloc.innerHTML =  "<span style='color:red;'>Please select a filling!<span>";
    return false;
} else {
    var resultloc=document.getElementById("fillingerror");
    resultloc.innerHTML =  "";
    return true;
} 
```

如果我选择该字段中的第一个单选按钮，则没有错误。但是，如果我选择任何其他按钮，则会出现错误。我该如何解决？

无线电场由以下内容生成：

```
 function make_filling_radio($filling)
{
    $filling = array("Carne de Casa (shredded beef)", "Carnitas (shredded pork)", "Pulled BBQ Chicken", "Roasted Chili Lime Chicken", "Roasted Veggies");

    foreach ($filling as $value){
        if (!empty($filling) and (FALSE !== array_search($value, $filling)))
            echo "<input type=\"radio\" name=\"filling\" value=\"$value\" id='myfilling'> $value<br>\n";
        else
            echo "<input type=\"radio\" name=\"filling\" value=\"$value\" id='myfilling'> $value<br>\n";
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:11:48.427

要使用纯 js 解决此问题，您可以使用（而不是使用，因为您的 id 不是唯一的）遍历所有`input`标签：`getElementsByName``getElementById`

```
var input_elements = document.getElementsByName("filling");

for (var i=0; i < input_elements.length; i++) {
  if (elements[i].checked) {
     //checked radio found
     return true;
  }
}

//...
return false; 
```

# z3 - 如何打印 Z3 Set 对象？

> ID：15935051
> 
> 赞同：1
> 
> 时间：2013-04-10T19:46:58.810
> 
> 标签：z3

我无法打印/显示作为 Z3 模型的一部分返回的集合对象。考虑以下示例（在 F# 中）：

```
let ctx:Context = new Context()
let ASort = ctx.MkEnumSort("S",[| "A"; "B"; "C"|])
let ASetSort = ctx.MkSetSort(ASort)
let xs = ctx.MkConst("xs",ASetSort)
let p = mkPredDecl ctx ("p",[|ASetSort|])
let px = ctx.MkApp(p,xs) :?> BoolExpr
let s = ctx.MkSolver()
s.Assert (ctx.MkAnd(px, ctx.MkNot(ctx.MkEq(xs,ctx.MkEmptySet(ASort)))))
assert (s.Check() = Status.SATISFIABLE)
let xs_interp = s.Model.Eval(xs)
xs_interp 
```

求解器返回一个集合（在本例中为单例集合 {A} 但没关系）。我看不到任何实际打印出来的方法。标准`ToString()`方法简单地说它是一个数组，显示模型表明该集合是使用查询函数在内部表示的。我尝试了以下

```
let foo xs x =
  let mem= ctx.MkSetMembership(x,xs_interp) :?> BoolExpr
  s.Assert mem
  s.Check()= Status.SATISFIABLE
Array.filter (foo xs) ASort.Consts 
```

它不仅笨重而且不起作用！我想我可以遍历集合的查询函数表示，但如果 Z3 中集合的表示发生变化，这对我来说似乎不太好，它会破坏我的代码。API中是否有我遗漏的东西？是否可以修改 ToString() 方法以实际打印设置的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T01:50:23.573

Z3 允许您根据数组的理论定义一些集合操作，例如隶属度测试、并集、交集和空集。集合排序只是布尔数组。集合操作被编译到数组理论中，使得空集对应于一个布尔数组，该数组在域中的所有值上都为假。成员资格测试只是数组选择。因此，您从 Z3 获得的模型将以数组的形式表示所有内容。

数组模型使用辅助函数是正确的。这使得遍历有点困难。原则上，您可以对模型返回的术语进行模式匹配（它应该将数组值表示为“（as-array k！32）”术语），然后您可以遍历模型以查找 k！32（或者它发生了什么被调用），也就是所谓的函数解释。抱歉，这不是获取有限数组模型的最直接方法，但表示允许 Z3 作为函数在数组之间来回切换。

论文：[http](http://academic.research.microsoft.com/Paper/6558823) ://academic.research.microsoft.com/Paper/6558823展示了如何将一些集合操作表示为数组。

# php - 在某些页面上显示自定义 TinyMCE

> ID：15935052
> 
> 赞同：0
> 
> 时间：2013-04-10T19:47:03.160
> 
> 标签：php, wordpress, tinymce

嘿，所以我在 wordpress 中的 tinymce 编辑器上创建了一个自定义工具栏行。但我只希望它显示在某些页面上。我想我只需要将我的代码放入条件标记中。然而它似乎对我不起作用。

```
if(is_page_template('single-work.php') && is_admin()) {
        //my code
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:43:53.810

`is_page_template`仅在前端有效。对于后端，请使用`global $pagenow`. 您也可以尝试使用[get_current_screen](http://codex.wordpress.org/Function_Reference/get_current_screen)。

# prolog - 在序言中的真实答案后不停止

> ID：15935053
> 
> 赞同：3
> 
> 时间：2013-04-10T19:47:06.550
> 
> 标签：prolog, transitive-closure

我写这个程序给我这个结果：“X=john”“Y=jane”

```
likes(john,mary).
likes(mary,jane).
likes(l,k).

likes(X,Y) :- likes(X,Z), likes(Z,Y). 
```

但是如果运行这个程序这样结果：我认为程序进入循环！我想在真实答案后停下来！

```
1 ?- likes(X,Y).
X = john,
Y = mary ;
X = mary,
Y = jane ;
X = l,
Y = k ;
X = john,
Y = jane ;
ERROR: Out of local stack 
```

我有错误！如何解决这个问题？

通过调试：

```
[debug] 3 ?- likes(john,Y).
 T Call: (6) likes(john, _G2162)
 T Exit: (6) likes(john, mary)
Y = mary ;
 T Redo: (6) likes(john, _G2162)
 T Call: (7) likes(john, _G2267)
 T Exit: (7) likes(john, mary)
 T Call: (7) likes(mary, _G2162)
 T Exit: (7) likes(mary, jane)
 T Exit: (6) likes(john, jane)
Y = jane ;
 T Redo: (7) likes(mary, _G2162)
 T Call: (8) likes(mary, _G2267)
 T Exit: (8) likes(mary, jane)
 T Call: (8) likes(jane, _G2162)
 T Call: (9) likes(jane, _G2267)
 T Call: (10) likes(jane, _G2267)
 T Call: (11) likes(jane, _G2267)
 T Call: (12) likes(jane, _G2267)
 T Call: (13) likes(jane, _G2267)
 T Call: (14) likes(jane, _G2267)
 T Call: (15) likes(jane, _G2267) 
```

等等..为什么喜欢（简，_G2267）？？？？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:35:55.287

`X`您的查询（`Y`都是变量）对于您定义的方式来说太“广泛”了`likes/2`

尝试

```
?- likes(john, Y). 
```

Prolog 引擎是做什么的？好吧，它在其事实数据库中进行搜索。

* * *

首先它发现*（第一条规则）*

```
likes(john, mary). 
```

所以**约翰喜欢玛丽**。

* * *

然后它发现

```
likes(john,Y) :-
    likes(john,Z),
    likes(Z,Y). 
```

所以它问自己：Z 是真的`likes(john,Z)`吗？好吧，数据库这么说`likes(john, mary)`，所以`Z = mary`。让我们把它放在规则中：

```
likes(john,Y) :-
    likes(john,mary),
    likes(mary,Y). 
```

所以它问自己：Y 是真的`likes(mary,Y)`吗？好吧，数据库这么说`likes(mary, jane)`，所以`Y = jane`。让我们把它放在规则中：

```
likes(john,jane) :-
    likes(john,mary),
    likes(mary,jane). 
```

所以**约翰喜欢简**。

* * *

现在我们有一个问题。仔细查看第二个查询：

```
likes(john,Y) :-
    likes(john,Z),
    ..... 
```

哦哦。

**如果约翰喜欢某人，约翰就喜欢某人*（并且，.....）***

好吧，在第一次尝试时我们很幸运：Prolog 引擎找到了`Y = jane, Z = mary`，因为我们有以下规则

```
likes(john,mary).
likes(mary,jane). 
```

它停止了。但随后它又问自己：

```
likes(john,Y) ? 
```

我们已经使用了前两个规则，所以让我们尝试第三个：

```
likes(X,Y) :-
    likes(X,Z),
    likes(Z,Y). 
```

麻烦！

```
likes(john,Someone) :-
    likes(john,Someone2), ..... 

likes(john,Someone2) :-
    likes(john,Someone3), .....

likes(john,Someone3) :-
    likes(john,Someone4), ..... 
```

等等..

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-10T20:43:31.703

如果你需要 "X=john" "Y=jane" 那么你必须重命名：

```
likes(X,Y) :- likes(X,Z), likes(Z,Y). 
```

对于其他名称，例如：

```
likestransitive(X,Y) :- likes(X,Z), likes(Z,Y). 
```

因此，您可以获得所需的解决方案：

```
1 ?- transitivelikes(X,Y).    
X = john,    
Y = jane;    
false. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-11T09:58:47.267

你的代码：

```
likes(john,mary).          % {1}
likes(mary,jane).          % {2}
likes(l,k).                % {3}

likes(X,Y) :-              % {4}
    likes(X,Z),            % {5} 
    likes(Z,Y).            % {6} 
```

查询`likes(john,Y)`进行如下：

```
likes(john,Y)? 
%% {1}  Y = mary.        ; redo
%% {4}  likes(john,Y) :-
   %% {5}  likes(john,Z)?
      %% {1}  Z=mary.
   %% {6}  likes(mary,Y)?
      %% {2}  Y=jane.        ; redo
      %% {4}  likes(mary,Y) :-
         %% {5}  likes(mary,Z2)?
            %% {2}  Z2=jane,
         %% {6}  likes(jane,Y)?
            %% {4}  likes(jane,Y):-
               %% {5}  likes(jane,Z3)?
                  %% {4}  likes(jane,Z3):-
                     %% {5}  likes(jane,Z4)?
                     ............ 
```

这就是你在调试器中看到的。

为了防止这种行为，重命名[传递闭包](http://en.wikipedia.org/wiki/Transitive_closure)谓词，如下所示：

```
likes(john,mary).          % {1b}
likes(mary,jane).          % {2b}
likes(l,k).                % {3b}

pals(X,Y) :-               % {4b}
    likes(X,Z),            % {5b} 
    pals(Z,Y).             % {6b} 
```

# sql - 能够对两个 VarChar 参数进行 LIKE

> ID：15935060
> 
> 赞同：4
> 
> 时间：2013-04-10T19:47:25.703
> 
> 标签：sql, sql-server, sql-server-2008, tsql, stored-procedures

我有一个看起来像的表：

```
orderID  Code  SubCode 
```

基于代码和子代码，我需要能够提取所有 orderID。

`Codes`并且`SubCodes`是 varchar 值，我需要能够对其进行“喜欢”，因为例如，对于上述示例，用户可以访问 3% for`Code`和 45% for `SubCode` for，我将获得所有订单以`Code`3`SubCode`开头，以 45 开头。

我已经让它`Code`像这样工作了：

```
ALTER PROCEDURE [sp_GetOrders]
    -- Add the parameters for the stored procedure here
@codeList varchar(max), 
@subCodeList varchar(max)
AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

declare @tempTable Table
(
SearchCode varchar(max)
)
insert  into @tempTable
select  * from dbo.udf_split(@codeList ) as split --this splits comma delimited list 'm passing in 

    -- Insert statements for procedure here
SELECT  orderID  from ordert t1
where
exists(
select 1 from @tempTable tt
where t1.userCode  like tt.SearchOrg
)
END 
```

上面的方法有效，如果我为 codeList 传递 300%，它会正确返回所有具有以 300 开头的代码的订单 id，但是我现在如何在组合中包含 SubCode？

我想如果我能够将代码和子组织作为 1 个参数传递会更好，以免失去彼此之间的关系，可能会有像 '5%-6%' 这样的破折号，其中 5% 是代码，而 6 % suborg .. 但我什至不知道从哪里开始。

从后端，传递参数的格式无关紧要，我只需要弄清楚如何让 SP 工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:32:43.260

您可以考虑将输入参数类型更改为`XML`

XML 格式

```
DECLARE @inputXML AS XML = 
 '<ParameterList>
    <Parameter>
        <Code>300%</Code>
        <SubCode>5%</SubCode>
    </Parameter>
    <Parameter>
        <Code>10%</Code>
        <SubCode>6%</SubCode>
    </Parameter>
</ParameterList>' 
```

您的存储过程将类似于

```
ALTER PROCEDURE [sp_GetOrders]
    @inputXML XML 
AS
BEGIN

SET NOCOUNT ON;

DECLARE @tempTable TABLE
(
SearchCode VARCHAR(100),
SearchSubCode VARCHAR(100)
)

INSERT  INTO @tempTable
SELECT
   Pars.value('(Code)[1]', 'Varchar(100)') AS Code,
   Pars.value('(SubCode)[1]', 'Varchar(100)') AS SubCode
FROM
   @inputXML.nodes('/ParameterList/Parameter') AS List(Pars)

SELECT  orderID  
FROM ordert t1
WHERE
EXISTS(
    SELECT 1 FROM @tempTable tt
    WHERE t1.userCode  LIKE tt.SearchCode
    AND t1.userSubCode LIKE tt.SearchSubCode
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:26:51.550

在 SQLServer2008+ 中，您可以将表值参数传递给 SP 和 UDF。表值参数允许您以表格格式将数据行传递给您的 SP 和 UDF。要创建表值参数，您必须首先创建定义表结构的*表类型。*

```
CREATE TYPE dbo.CodeSubCodeValueType
AS TABLE (Code nvarchar(100) NOT NULL, SubCode nvarchar(100) NOT NULL)
GO

ALTER PROCEDURE [sp_GetOrders]
 (@CodeSubCodeValueType dbo.CodeSubCodeValueType READONLY)
AS
BEGIN    
  SET NOCOUNT ON;

  SELECT orderID
  FROM ordert t1
  WHERE EXISTS(
               SELECT 1 
               FROM @CodeSubCodeValueType tt               
               WHERE t1.userCode LIKE tt.Code
                 AND t1.userSubCode LIKE tt.SubCode
               )
END
GO 
```

使用表值参数调用过程

```
DECLARE @CodeSubCodeValueType dbo.CodeSubCodeValueType

INSERT @CodeSubCodeValueType
VALUES('5%', '6%'), 
      ('7%', '8%')

EXEC [sp_GetOrders] @CodeSubCodeValueType 
```

如果参数对的值之一为空，则在表类型中使用 NULL 值是必要的：

```
CREATE TYPE dbo.CodeSubCodeValueType
AS TABLE (Code nvarchar(100), SubCode nvarchar(100))
GO

ALTER PROCEDURE [sp_GetOrders]
 (@CodeSubCodeValueType dbo.CodeSubCodeValueType READONLY)
AS
BEGIN    
  SET NOCOUNT ON;

  SELECT orderID
  FROM ordert t1
  WHERE EXISTS(
               SELECT 1 
               FROM @CodeSubCodeValueType tt               
               WHERE t1.Code LIKE ISNULL(tt.Code, t1.Code)
                 AND t1.SubCode LIKE ISNULL(tt.SubCode, t1.SubCode)
               )
END
GO 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/2a1d2/1)上的简单演示[](http://sqlfiddle.com/#!3/2a1d2/1)

# redirect - MVC 控制器。使用区域执行

> ID：15935069
> 
> 赞同：5
> 
> 时间：2013-04-10T19:48:06.080
> 
> 标签：redirect, asp.net-mvc-4, asp.net-mvc-areas

我在 MVC4 中有一个使用区域的站点。在某些区域（我们称之为区域），我有一个具有以下操作的控制器（控制器）：

```
public ActionResult Index()
{
    return View();
}

public ActionResult OtherAction()
{
    return View("Index");
} 
```

如果我像这样简单地重定向到 Area/Controller/OtherAction，这将非常有用：

```
return RedirectToAction("OtherAction", "Controller", new { area = "Area" }); 
```

但我需要（[在这里查看原因](https://stackoverflow.com/a/620559/310276)）进行这样的重定向：

```
RouteData routeData = new RouteData();
routeData.Values.Add("area", "Area");
routeData.Values.Add("controller", "Controller");
routeData.Values.Add("action", "OtherAction");
ControllerController controller = new ControllerController();
controller.Execute(new RequestContext(new HttpContextWrapper(HttpContext.ApplicationInstance.Context), routeData)); 
```

在这种情况下，它不起作用。在最后一行之后，OtherAction 方法被执行，然后在这段代码的最后一行，它抛出了这个异常：

> 未找到视图“索引”或其主视图，或者没有视图引擎支持搜索的位置。搜索了以下位置：
> 
> ~/Views/Controller/Index.aspx
> 
> ~/Views/Controller/Index.ascx
> 
> ~/Views/Shared/Index.aspx
> 
> ~/Views/Shared/Index.ascx
> 
> ~/Views/Controller/Index.cshtml
> 
> ~/Views/Controller/Index.vbhtml
> 
> ~/Views/Shared/Index.cshtml
> 
> ~/Views/Shared/Index.vbhtml

为什么会发生这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-10T20:06:27.190

You get the exception because ASP.NET MVC tries to look up your view in the "root" context and not inside the area view directory because you are not setting up the area correctly in the `routeData`.

The `area` key needs to be set in the `DataTokens` collections and not in the `Values`

```
RouteData routeData = new RouteData();
routeData.DataTokens.Add("area", "Area");
routeData.Values.Add("controller", "Controller");
routeData.Values.Add("action", "OtherAction");
//... 
```

# excel - 如何在条件是列中的一组数字的情况下进行 SUMIFS？

> ID：15935070
> 
> 赞同：0
> 
> 时间：2013-04-10T19:48:07.343
> 
> 标签：excel, excel-formula, criteria, sumifs

我有一个看起来像这样的 Excel 文件：

```
ZONES             Count                          Area 1 = (SUM OF ZONE COUNT)
------------------------------------------------------------------------------
1                 100                            1
2                 50                             2
3                 110                            5
4                 90                             7
5                 40                             
6                 10                             
7                 0                              
8                 80 
```

我需要做的是让 (SUM OF ZONE COUNT)`190`从 100+40+50+0 = 190 开始说。我试过了：

```
=SUMIFS(B3:B10, A3:A10, C3) 
```

它会回来`100`的。当我尝试：

```
=SUMIFS(B3:B10, A3:A10, "="&C3:C6) 
```

它返回`0`。

我需要将条件设置为范围而不是单个单元格。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T19:59:03.043

试试这个版本

`=SUMPRODUCT(SUMIFS(B3:B10,A3:A10,C3:C6))`

因为标准范围是四个单元格，所以 SUMIFS 函数将返回一个包含四个值的“数组” - SUMPRODUCT 用于对这四个值求和

您也可以使用 SUM 但公式需要“输入数组”，即

`=SUM(SUMIFS(B3:B10,A3:A10,C3:C6))`

用`CTRL`+ `SHIFT`+确认`ENTER`

# generator - Yeoman 1.0 not webapp generator not found？

> ID：15935071
> 
> 赞同：2
> 
> 时间：2013-04-10T19:48:04.837
> 
> 标签：generator, yeoman

我是 yeoman、grunt 等世界的新手。我玩过 Yeoman pre 1.0 并且效果很好。我升级到 1.0，我在最基本的层面上遇到了麻烦。尝试运行“yo webapp”并得到“您似乎没有安装名称为 webapp 的生成器。” 我究竟做错了什么？感谢您的帮助...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-10T19:56:17.623

好的，显然我几天前下载的包中有一个错误......正在运行

```
npm install --force -g generator-webapp 
```

解决它。（[在github上查看解决方案](https://github.com/yeoman/yeoman/issues/1008)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-03T13:59:18.840

`npm install --force -g generator-webapp`

我不知道为什么当我执行这个时，它仍然对我不起作用。

但是当我执行这个时：

`npm install -g generator-webapp`

然后我修好了。

事实上，当你使用 yeoman 时，你应该先安装一些生成器。

如果涉及到这个：

> 错误网页应用
> 
> 您似乎没有安装名为 mocha:app 的生成器。您可以使用 npm search yeoman-generator 查看可用的生成器，然后使用 npm install [name] 安装它们。`--help`要查看 18 个已注册的生成器，请使用该选项运行 yo 。

你仍然可以执行：

`npm install -g generator-[name]`

希望这对你有用。

# ruby-on-rails - 如何为表单确认页面定义自定义 URL？

> ID：15935072
> 
> 赞同：0
> 
> 时间：2013-04-10T19:48:01.910
> 
> 标签：ruby-on-rails, confirmation, custom-url

我正在使用 Rails 创建一个基本的产品登录页面，用户可以在其中输入他们的电子邮件地址，以便在产品启动时收到通知。（是的，有服务/宝石等可以为我做这件事，但我是编程新手，想自己构建它来学习 Rails。）

成功提交表单后，我想重定向到自定义“/感谢”页面，在该页面中感谢用户对产品的兴趣（并鼓励他们完成一个简短的调查。）

目前，成功的提交显示在“/invites/:id/”，例如“invites/3”，这是我不想要的，因为它公开了已提交的邀请数量。我想将所有成功的提交重定向到“/thanks”页面。

我试图研究“rails custom URLs”，但找不到任何有效的方法。我能找到的最接近的是这篇[关于如何使用自定义路由重定向](https://stackoverflow.com/questions/7728304/rails-3-1-how-to-redirect-properly-with-custom-routes)但没有完全理解推荐的解决方案的 Stackoverflow 帖子。我也尝试过阅读[Rails Guide on Routes](http://guides.rubyonrails.org/routing.html)，但对此并不陌生，没有看到任何我理解的允许创建自定义 URL 的内容。

我已将我希望在“views/invites/show.html.haml”中成功提交的表单中显示的感谢信息

**我的路线文件**

```
resources :invites
root :to => 'invites#new' 
```

我尝试在 routes.rb 中插入：

```
post "/:thanks" => "invites#show", :as => :thanks 
```

但我不知道这是否可行，或者我如何告诉控制器重定向到：谢谢

**我的控制器**（基本上是香草导轨，此处仅包含相关操作）：

```
def show
    @invite = Invite.find(params[:id])
    show_path = "/thanks"

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @invite }
    end
  end

# GET /invites/new
# GET /invites/new.json
def new
  @invite = Invite.new

  respond_to do |format|
    format.html # new.html.erb
    format.json { render json: @invite }
  end
 end

 # POST /invites
 # POST /invites.json
 def create
   @invite = Invite.new(params[:invite])

   respond_to do |format|
     if @invite.save
       format.html { redirect_to @invite }
       #format.js { render :action => 'create_success' }
       format.json { render json: @invite, status: :created, location: @invite }
     else
       format.html { render action: "new" }
       #format.js { render :action => 'create_fail' }
       format.json { render json: @invite.errors, status: :unprocessable_entity }
     end
   end
 end 
```

似乎创建一个用于显示确认的标准 URL 相对简单。任何有关如何实现这一目标的建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:09:51.557

我猜您想在提交表单时执行创建操作后重定向。

只需按以下方式添加redirect_to：

```
def create
  @invite = Invite.new(params[:invite])

  if @invite.save
    ...
    redirect_to '/thanks'
  else
    ...
    redirect_to new_invite_path # if you want to return to the form submission page on error
  end
end 
```

为简洁起见，我省略了一些代码。

在您的路线中添加：

```
get '/thanks', to: "invites#thanks" 
```

将感谢操作添加到您的邀请控制器：

```
def thanks
  # something here if needed
end 
```

并在 app/views/invites 中创建一个 Thanks.html.erb 页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T19:53:58.090

您可以创建这样的路线：

```
resources :invites do
  collection do
    get 'thanks'
  end
end 
```

这还将创建一个名为`thanks_invites_path`.

它将在`invites/thanks`路径上，但如果你希望它在`/thanks`，你可以按照 Jason 提到的那样做：

`get "/thanks" => "invites#thanks", :as => :thanks`

该`as`部分将生成一个帮助器来访问该页面：`thanks_path`.

您需要在控制器中`thanks`添加一个名为`thanks.html.erb`

由于您希望每个人在成功提交后都转到该页面，因此在您的创建操作中您将拥有：

`format.html { redirect_to thanks_invites_path}`（或`thanks_path`），无论您选择什么，当您命名路线时，您可以检查它`rake routes`是否可以，无论`rake routes`说什么，只需`_path`在最后添加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T19:54:53.993

我会这样做`get "/thanks" => "invites#thanks"`，`routes.rb`然后将其添加到您的控制器中：

```
def thanks
end 
```

然后添加一个`app/views/invites/thanks.html.erb`包含感谢内容的文件。

# c++ - #ifdef 指令末尾的额外标记

> ID：15935073
> 
> 赞同：6
> 
> 时间：2013-04-10T19:48:05.410
> 
> 标签：c++, c

为什么下面的代码会编译？

```
#ifdef C++11
// ...
#endif

int main() {} 
```

gcc 4.8.0 给了我以下警告：

> #ifdef 指令末尾的额外标记

根据标准，宏名称只能包含字母、数字和下划线字符。

也许是因为这个？

**ISO/IEC 14882:2011**

> 16.1 条件包含 [cpp.cond]
> 
> 6 按顺序检查每个指令的条件。如果它的计算结果为假（零），则跳过它控制的组：指令仅通过确定指令的名称进行处理，以跟踪嵌套条件的级别；其余指令的预处理标记被忽略，组中的其他预处理标记也是如此。仅处理其控制条件评估为真（非零）的第一组。如果没有一个条件为真，并且有 #else 指令，则处理由 #else 控制的组；如果缺少 #else 指令，则跳过 #endif 之前的所有组。151

我无法正确理解这句话。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:24:19.907

就 C++ 一致而言，`#ifdef C++11`是一个语法错误。没有规则说编译器必须拒绝出现语法错误的程序。

> 1.4 实施合规性 [intro.compliance]
> 
> 可诊断规则集由本国际标准中的所有句法和语义规则组成，但那些包含“不需要诊断”的明确表示法或被描述为导致“未定义行为”的规则除外。
> 
> [...]
> 
> 如果程序包含违反任何可诊断规则或出现在本标准中描述为“有条件支持”的构造，而实现不支持该构造，则符合要求的实现应发出至少一个诊断消息。

警告是诊断消息。编译器完全有权继续成功编译程序，只要他们确保向您显示一条诊断消息。由于编译器历来接受此类指令，并且接受此类指令与标准的要求不冲突，因此他们继续这样做。

至少就 GCC 而言，您可以要求使用该`-pedantic-errors`选项使所有标准要求的诊断成为硬错误。

```
$ printf "#ifdef C++11\n#endif\n" | gcc -std=c++11 -pedantic-errors -E -x c++ -
# 1 "<stdin>"
# 1 "<command-line>"
# 1 "<stdin>"
<stdin>:1:9: error: extra tokens at end of #ifdef directive 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:46:50.467

A`#ifdef`定义如下（取自§16.1）

> `# ifdef`      *标识符换行*

使用类似正则表达式的表示法，标识符是：`[a-zA-Z_][a-zA-Z_0-9]*`(*)

关键是：**您声明的宏不是`C++11`**。事实上`C`（见[这个活生生的例子](http://liveworkspace.org/code/460h5Z%240)）。该`++11`部分被预处理器忽略。标识符（即`C`）之后唯一允许的字符是换行符，但正如 hvd 的回答中所说，从 §1.4 开始，语法错误只会强制发出诊断消息，这里是警告；我看到这个而不是错误的唯一原因是与旧代码兼容，其中已经使用了这些名称。

另外：报价解释了如何`#ifdef / #elif / #else / #endif`协同工作，而不是指定条件的方式。

*我没有标准的副本。我使用草稿[n3485](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3485.pdf)来回答这个问题。*

(*)*标识符中可能包含实现定义的字符，但这不会影响您的问题。请注意，变量、类名、宏……都遵循相同的标识符规则。*

# ios - 为什么我的图像的每行字节数大于其每像素字节数乘以其宽度？

> ID：15935074
> 
> 赞同：13
> 
> 时间：2013-04-10T19:48:02.587
> 
> 标签：ios, video, uiimage, cgimage

我正在将图像转换为 MOV 文件，并且发生了一件有趣的事情。我记录了每个颜色分量的位数、每个像素的位数和每行的字节数。这是我的代码：

```
NSLog(@"Image width: %d, Height: %d", CGImageGetWidth(image), CGImageGetHeight(image));
NSLog(@"BPC: %d \ BPP: %d \ ByPR: %d", CGImageGetBitsPerComponent(image), CGImageGetBitsPerPixel(image), CGImageGetBytesPerRow(image)); 
```

这是我的输出：

图像宽度：300，高度：300（一切都符合预期） BPC：8（每种颜色 8 位......到目前为止一切都很好） BPP：32（32 = 4 个分量 ARGB * 每种颜色 8 位......知道了）ByPR :1216（每行 300 像素 * 每像素 4 字节 = 每行 1200 字节）

为什么我每行记录 1216 个字节，而不是 1200 个？顺便说一句，这不仅仅是侥幸。当我根据缓冲区大小的这些数字创建视频时，它可以工作。当我以每行 1200 字节创建它时，我得到了一些混乱的混叠效果。

想法？！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-10T19:59:55.913

该系统喜欢图像是每行 64 字节的倍数，这可能是由于缓存行对齐而获得更好的性能。1200 不是 64 的倍数，但 1216 是。

# c# - 来自数据库的 C# 动态单选按钮组

> ID：15935075
> 
> 赞同：2
> 
> 时间：2013-04-10T19:47:57.817
> 
> 标签：c#, radio-button

我有一个程序可以在会员资格即将到期时列出数据库中的会员。我想知道的是是否可以为每个成员生成和分组三个单选按钮，如下例所示：

`Member 1 o Renew o Finished o Carry Over`

`Member 2 o Renew o Finished o Carry Over`

`Member 3 o Renew o Finished o Carry Over`

`Member 4 o Renew o Finished o Carry Over`

然后，我将有一个提交按钮，该按钮将更新每个成员的数据，以了解为他们选择了哪个单选按钮。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:11:41.763

## ASP.NET

如果您使用的是 ASP.NET 应用程序，那么您只需要`GroupName`适当地设置。请注意[MSDN 文档中的](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.radiobutton.aspx)此声明：

> 如果按钮都共享相同的 GroupName 属性，则这些按钮将按逻辑分组。

## Windows 窗体

如果您使用的是 Windows 窗体应用程序，那么只需将每个控件分组`RadioButton`放在自己的控件中，`GroupBox`否则`Panel`它们将被视为单独的分组。请注意[MSDN 文档中的](http://msdn.microsoft.com/en-us/library/system.windows.forms.radiobutton.aspx)此声明：

> 给定容器（如 Form）中的所有 RadioButton 控件构成一个组。要在一个窗体上创建多个组，请将每个组放在其自己的容器中，例如 GroupBox 或 Panel 控件。

# jquery - JQuery悬停img交换，鼠标移出

> ID：15935077
> 
> 赞同：0
> 
> 时间：2013-04-10T19:48:24.187
> 
> 标签：jquery, html

我需要有关我的 jQuery 脚本的帮助，`img`鼠标悬停和`.conceptcontent`显示类时的更改，鼠标离开时的`img`更改，但我可以隐藏`.conceptcontent`类吗？

```
(function ($) {
    $(".img-swap").hover(

        function () {
            this.src = this.src.replace("_off", "_on");
            $(".conceptcontent").show("slow");
        },

        function () {
            this.src = this.src.replace("_on", "_off");

        });

    var imgSwap = []; $(".img-swap").each(function () {
        imgUrl = this.src.replace("_off", "_on");
        imgSwap.push(imgUrl);
    });

    $(imgSwap).preload();
})(jQuery); 
```

html

```
 <title>Untitled Document</title>

 </head>
 <body>
<!--background-->
<div id="intro">
<h1 id="rubrik">Josef Carlsson</h1>
</div>

<div class="meny">
<div id="home"><img src="iconer/home_off.svg" class="img-swap"></div> 
<div id="about"><img src="iconer/ommig_off.svg" class="img-swap"></div> 
<div id="design"><img src="iconer/design_off.svg" class="img-swap"></div> 
<div id="internet"><img src="iconer/internet_off.svg" class="img-swap"></div>
<div id="camera"><img src="iconer/kamera_off.svg" class="img-swap"></div>
<div id="concept"><img src="iconer/koncept_off.svg" class="img-swap"></div> 
 </div>

 <div class="menytext">
<div id="hometext">Start</div>
<div id="abouttext">About me</div>
<div id="designtext">Design</div>
<div id="internettext">Webb</div>
<div id="cameratext">Pictures</div>
<div id="concepttext">Concepts</div> 
 </div>

 <ul class="conceptcontent">
<li>emotion</li>
<li>[in]sight</li>
<li>will i make it</li>
<li>trace</li>
    <li>datemate</li>
    <li>pacman</li>
</ul> 
```

这是使用的 html

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T19:51:23.920

你不只需要像你有show（）一样的隐藏吗？

编辑：我开始猜测动画正在排队。我尝试复制试试这个：

```
(function($){
$(".img-swap").hover(
function(){this.src = this.src.replace("_off","_on");
        $(".conceptcontent").stop(true.true).show("slow");},

function(){this.src = this.src.replace("_on","_off");
           $(".conceptcontent").stop(true,true).hide("slow");

 }); 
```

jQuery stop() 停止当前动画。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T19:51:37.433

你可以用它来隐藏它

```
 $(".conceptcontent").hide('slow'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T19:54:08.980

与您为鼠标悬停所做的相反的是：

```
...
$(".img-swap").hover(
  function(){
    this.src = this.src.replace("_off","_on");
    $(".conceptcontent").show("slow");
  },
  function(){
    this.src = this.src.replace("_on","_off");
    $(".conceptcontent").hide("slow");
  }
);
... 
```

**编辑：** 我的打字速度比其他人慢......我想修复你的格式需要一两分钟；）

# c++ - `new auto` 有什么作用？

> ID：15935080
> 
> 赞同：23
> 
> 时间：2013-04-10T19:48:42.337
> 
> 标签：c++, c++11, dynamic-allocation, type-deduction

当我使用它是什么意思`new auto`？考虑表达式：

```
new auto(5) 
```

动态分配对象的类型是什么？它返回的指针的类型是什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-04-10T19:53:16.970

在这种情况下，`auto(5)`解析为`int(5)`。

您正在`int`从堆中分配一个新的，初始化为`5`.

*（所以，它返回一个`int *`）*

经许可引用 Andy Prowl 的足智多谋的回答：

根据 C++11 标准的第 5.3.4/2 段：

> 如果`auto`type-specifier 出现在*new-type-id*的*type-specifier-seq*或*new-expression的**type-id*中，则 *new-expression*应包含以下形式的*new-initializer*
> 
>  ***```
> ( assignment-expression ) 
> ```
> 
> 分配的类型由 new-initializer 推导如下： 设 为 new-initializer*中*`e`的*assignment-expression*，T 为 new-expression 的*new* *-type-id*或*type-id*，则分配的类型为该类型为发明声明（7.1.6.4）中的变量推导出：****`x`****
> 
>  ***```
> T x(e); 
> ```
> 
> [*示例*：
> 
> ```
> new auto(1); // allocated type is int
> auto x = new auto(’a’); // allocated type is char, x is of type char* 
> ```
> 
> —<em>结束示例]******

 *** * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-10T19:56:19.303

根据 C++11 标准的第 5.3.4/2 段：

> 如果`auto`type-specifier 出现在*new-type-id*的*type-specifier-seq*或*new-expression的**type-id*中，则 *new-expression*应包含以下形式的*new-initializer*
> 
>  ***```
> ( assignment-expression ) 
> ```
> 
> 分配的类型由 new-initializer 推导如下： 设 为 new-initializer*中*`e`的*assignment-expression*，T 为 new-expression 的*new* *-type-id*或*type-id*，则分配的类型为为发明声明（7.1.6.4）中的变量推导出：****`x`****
> 
>  ***```
> T x(e); 
> ```
> 
> [*示例*：
> 
> ```
> new auto(1); // allocated type is int
> auto x = new auto(’a’); // allocated type is char, x is of type char* 
> ```
> 
> —<em>结束示例]******

 **因此，分配对象的类型与发明声明的推断类型相同：

```
auto x(5) 
```

这是`int`。****

# c++ - 从 VB 将指针传递给 DLL 中的外部 C 函数

> ID：15935084
> 
> 赞同：5
> 
> 时间：2013-04-10T19:48:50.403
> 
> 标签：c++, vb.net, dll

我是一名 C++ (MSVC) 作家，VB 新手，试图帮助一位以前没有做过这项任务的专家 VB.net 作家。

我们希望开发 C/C++ 和 VB 应用程序以使用用 C++ 编写的 DLL 和 C extern-ed API 函数。C++ 程序运行良好。这是我们遇到困难的VB。

DLL 提供了一个`extern C`函数：

```
RegisterCallback( void* cbFuncPtr, void* dataPtr ); 
```

**注意 1：请参阅下面的说明，了解设计更改以及我们做出此更改的原因。**

**注 2：附加更新添加为下面的答案。**

其中回调函数有这个 C typedef：

```
typedef   (void)(* CALL_NACK)(void*); 
```

预计将`cbFuncPtr`是一个函数指针，指向一些将被称为 CALL_BACK 的 VB 函数。`dataPtr`是指向具有此 C 定义的数据结构的指针：

```
typedef struct 
{
   int      retCode;
   void*    a_C_ptr;
   char     message[500];
}  cbResponse_t; 
```

哪里`a_C_ptr is an internal pointer in the DLL that the VB can cast to`长`。它唯一地标识在 DLL 中进行回调的位置，并允许 VB 函数识别来自相同/不同位置的调用。

我们可以`RegisterCallback()`很好地从 VB 访问和运行该函数。日志显示我们到达那里并且数据被传入。实际数据似乎是问题所在。

在阅读大约一百万个论坛条目时，我们了解到 VB 不知道指针是什么，并且 VB 结构不仅仅是有组织的内存。我们很确定 VB 结构的“地址”不是 C 认为的地址。我们已经看到反复提到“编组”和“托管数据”，但缺乏足够的理解来了解这告诉我们什么。

我们应该如何编写 VB 代码来为 DLL 提供其回调函数的执行地址，以及我们如何编写一个 VB 结构，让 DLL 可以像 C++ 那样填写？

我们是否需要一个 DLL 函数，调用应用程序可以说“C”或“VB”，并让 DLL 以不同的方式处理结构指针？如果是这样，如何编写 C 代码来填充 VB 结构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T11:41:17.053

这有点太大太深了，不能只是对原始帖子的编辑......

从@DaveNewman 发布的[链接中，我提取了这个宝石：](http://social.msdn.microsoft.com/forums/en-US/Vsexpressvb/thread/4c486d10-fe8b-49da-a5f1-8054b82251ff/)

* * *

> 这里有一点关于紧凑框架的内容，但在成人框架中也是如此：
> 
> .NET Compact Framework 支持自动封送包含简单类型的结构和类。所有字段在内存中的排列顺序与它们在结构或类定义中出现的顺序相同。类和结构都在本机代码中作为指向 C/C++ 结构的指针出现。
> 
> 托管堆中的对象可以随时由垃圾收集器在内存中移动，因此它们的物理地址可能会更改，恕不另行通知。P/Invoke 在每个方法调用期间自动锁定通过引用传递的托管对象。这意味着传递给非托管代码的指针将对该调用有效。请记住，不能保证对象不会在后续调用中移动到不同的内存地址。
> 
> [http://msdn.microsoft.com/en-us/library/aa446538.aspx#netcfmarshallingtypes_topic6](http://msdn.microsoft.com/en-us/library/aa446538.aspx#netcfmarshallingtypes_topic6)

* * *

这是`RegisterCallback( fcnPtr, dataPtr)`功能的主要障碍。注册时传入的指针可能随时更改，`RegisterCallback()`不是当前语句。发帖作者是这样总结的

> 您无需执行任何操作，因为结构会在通话期间自动固定。

当然，这意味着没有被固定在通话之外。

出于这个原因，我们决定对设计进行更改，以在 DLL 的 C/C++ 世界中内置响应结构，而不是在 VB 的空间中。这样它就会原地不动。实际回调函数的签名将保持不变，因此 VB 程序可以知道 DLL 将响应放在哪里。这也允许 DLL 中的响应者为不同的需求分配不同的响应结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:17:38.737

再一次，我的更新太大了，无法发表评论！

**2013 年 4 月 18 日更新：**

好吧，使用上面引用的[从非托管代码调用托管代码](http://www.codeproject.com/Articles/9903/Calling-Managed-Code-from-Unmanaged-Code-and-vice#xx3493475xx)中的代码的尝试失败了。我们最终不得不将 /clr 添加到 DLL 中，从而将 DLL 转换为托管代码，这使得它无法从 C 应用程序中使用。

我们现在正在[Callback Sample](http://msdn.microsoft.com/en-us/library/5zwkzwf4%28v=vs.90%29.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-3)中测试示例，我能够展示它制作了一个可与 VB 和 C++ 一起使用的 DLL。您需要拥有[PinvokeLib.dll 源](http://msdn.microsoft.com/en-us/library/as6wyhwt%28v=VS.90%29.aspx)才能完成这项工作。

这是 C++（真正的 C）测试器的代码。编译为 MSVC 项目。

* * *

注意：注意这一行中的 __cdecl：

```
typedef bool (__cdecl *FPtr)(BOOL_FP_INT fp, int i ); 
```

这是我必须找到的秘密。DLL 和此应用程序是使用 __cdecl 链接而不是 __stdcall 编译的。它们是 VC++ 中的默认值，我只是使用了默认值。我尝试将所有内容都更改为 __stdcall ，但这没有用。必须是 __cdecl。

* * *

```
// PinvokeTester.cpp : Defines the entry point for the console application.
//

#include <stdio.h>
#include <cstdio>
#include <stdlib.h>
#include <cstdlib>
#include <string.h>
#include <cstring>
#include <sstream>
#include <iostream>
#include <algorithm>
#include <Windows.h>

#define PINVOKELIB_API __declspec(dllimport)

HINSTANCE      hLib;                            // Windows DLL handle

bool     CALLBACK VBCallBack( int value );
bool     AttachLibrary( void );
void *   GetFuncAddress( HINSTANCE hLib, const char* procname );

int main(int argc, char* argv[])
{
   if ( !AttachLibrary() )
   {
      printf( "Lib did not attach.\n" );
      exit(1);
   }

   typedef bool (CALLBACK *BOOL_FP_INT)(int i );

   typedef bool (__cdecl *FPtr)(BOOL_FP_INT fp, int i );

   FPtr TestCallBack = (FPtr)GetFuncAddress( hLib, "TestCallBack" );

   TestCallBack( (BOOL_FP_INT)VBCallBack, 255 );

    return 0;
}

bool CALLBACK VBCallBack( int value )
{
    printf( "\nCallback called with param: %d", value);
    return true;
}

bool     AttachLibrary( void )
{
   // Get a var for the IPC-dll library.
   std::string    dllName;

   /*--- First, link to the IPC-dll library or report failure to do so. ---*/
   dllName = ".\\PinvokeLib";
   if ( NULL == (hLib = LoadLibraryA( dllName.c_str() )) )
   {
      printf( "\nERROR: Library \"%s\" Not Found or Failed to Load. \n\n", dllName.c_str() );
      printf( "\"%s\"\n", GetLastError() );
      return false;
   }

   return true;
}

//=====================================================================
void *  GetFuncAddress( HINSTANCE hLib, const char* procname )
{
   void *   procAddr = NULL;

   procAddr = (void *)GetProcAddress( hLib, procname );

   // If the symbol wasn't found, handle error ---------------------
   if ( NULL == procAddr )
   {
      std::cout << "ERROR: Could not get an address for the \""
                << procname  << "\" function. : "
                << GetLastError()  << std::endl;
      exit( 7 );
      procAddr = (void*)NULL;
   }

   return procAddr;
} 
```

# php - 如何在包含的文件中写入 php 文件？

> ID：15935088
> 
> 赞同：-1
> 
> 时间：2013-04-10T19:49:01.567
> 
> 标签：php

如果包含/需要一个 php 文件，其中包含/需要一个`fwrite`函数，则不会写入任何文件！

写入的唯一方法是直接访问包含/必需的文件，以便`log.txt`可以开始写入活动。

有没有办法解决？

**主文件**

```
require("inside.php") 
```

**里面.php**

```
//debug mode
$myFile = "test.txt"; $fh = fopen($myFile, 'w') or die("can't open file");
fwrite($fh, "testing shiz"."\n"); fwrite($fh, "============="."\n");
fclose($fh); 
```

运行 main.php 时，文件不会写入。只有当 inside.php 运行时，它才会写入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:11:13.653

我猜包含/必需的文件与调用它的文件不在同一目录中？这意味着它不会以您认为的方式结束。

例如：

*www.domain.com/file.php*具有以下内容：

```
include('directory/write_file.php'); 
```

如果 *write_file.php* 中有一个`fwrite`-statement ，比如说`'log.txt'`，该文件将被放置在您的根文件夹中：*www.domain.com/log.txt*，因为*file.php*在您的根文件夹中，这是您当前的工作目录（如果需要，用于[`getcwd()`](http://php.net/manual/en/function.getcwd.php)获取当前工作目录）。

为确保文件放置在正确的位置，请使用绝对路径，例如：

```
/var/www/httpdocs/logs/log.txt 
```

同样，您可以使用`getcwd()`-function 找出它必须是什么目录。

# python - 使用 argparse 创建相互包含的位置参数

> ID：15935092
> 
> 赞同：7
> 
> 时间：2013-04-10T19:49:19.817
> 
> 标签：python, argparse

我正在尝试使用 Python 的 argparse 模块构建命令行界面。我想要两个位置参数，其中一个依赖于另一个（相互包含）。这是我想要的：

```
prog [arg1 [arg2]] 
```

这是我到目前为止所拥有的：

```
prog [arg1] [arg2] 
```

由以下公司生产：

```
parser = argparse.ArgumentParser()
parser.add_argument('arg1', nargs='?')
parser.add_argument('arg2', nargs='?') 
```

我如何从那里获得一个相互包容的 arg2？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-06-26T20:37:32.047

模块`argparse`没有用于创建相互包含的参数的选项。不过自己写很简单。
首先将两个参数添加为可选：

```
parser.add_argument('arg1', nargs='?')
parser.add_argument('arg2', nargs='?') 
```

解析参数后检查是否`arg1`已设置和`arg2`未设置：

```
args = parser.parse_args()
if args.arg1 and not args.arg2: 
```

`None`（如果您将默认值从for not used arguments 更改为不同的值，这可能会更加棘手）

然后使用`parser.error()`函数显示正常的`argparse`错误信息：

```
parser.error('the following arguments are required: arg2') 
```

最后更改*用法：*消息以显示`arg2`取决于`arg1`：

```
parser = argparse.ArgumentParser(usage='%(prog)s [arg1 [arg2]]') 
```

一个完整的脚本：

```
import argparse

parser = argparse.ArgumentParser(usage='%(prog)s [arg1 [arg2]]')
parser.add_argument('arg1', nargs='?')
parser.add_argument('arg2', nargs='?')

args = parser.parse_args()

if args.arg1 and not args.arg2:
    parser.error('the following arguments are required: arg2') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T19:52:03.567

您可以使用`sub_parsers`.

以下是文档和示例：

[http://docs.python.org/2/library/argparse.html#sub-commands](http://docs.python.org/2/library/argparse.html#sub-commands)

# php - 仅 PHP 关联数组键

> ID：15935095
> 
> 赞同：3
> 
> 时间：2013-04-10T19:49:23.220
> 
> 标签：php, arrays

是否可以声明数组元素键而不将其定义为值（如非数组变量）？这样，如果您有一个关联的布尔值数组，您只需要检查键是否存在而不是分配一个布尔值。但是您仍然具有在检查键是否存在时不必遍历数组的优势。

这将是一种节省空间的措施。似乎“空”获得了分配空间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T19:55:49.207

如果您不想在 accoc 数组中使用字典结构，那么您只需要一组值，如下所示：

```
$array = ('red', 'green', 'blue'); 
```

要检查一个键（项目）是否存在，只需使用`in_array()`：

```
if(in_array('red', $array)) {
   // -> found
} 
```

但是，您应该注意，在这种情况下，php 将在内部创建数字索引。

* * *

另一种方法是将 TRUE 分配给所有值。这至少会占用更少的内存。像这样

```
$array (
    'red' => TRUE,
    'green' => TRUE,
    'blue' => TRUE
); 
```

`isset()`并使用Like检查存在：

```
if(isset($array['red'])) {
    // -> found
} 
```

**注意**：我不建议您使用`NULL`该值。这是因为您不能`isset()`在这种情况下使用，因为如果键的值为 NULL，则 isset 将返回 false。在这种情况下，您必须使用`array_key_exists()`比`isset()`.

* * *

结论：在处理器和内存消耗方面，我建议 PHP 中的第二个建议。内存消耗应与数值数组相同，但搜索操作已优化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T19:56:09.267

不。数组元素总是有键和值，但是如果你不关心，你可以把任何东西作为你的值（即空字符串）。在您的情况下，您应该只将这些键添加到您的数组中，它们是有价值的，即`true`. 然后，当您正在寻找它并且找不到它时，您可以**假设**它是错误的。但总的来说，你做错了事。您并没有真正保存在这里，而是使您的代码不干净并且难以阅读和维护。不要这样做

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T20:31:04.337

如果我理解正确。您计划使用这样的关联数组：

```
key      value
"bool1"  ""
"bool2"  ""
"bool3"  "" 
```

如果存在密钥，则布尔值为“真”。

为什么不只使用这样的普通数组？：

```
key   value
1     "bool1"
2     "bool2"
3     "bool3" 
```

如果该值存在，则布尔值为“真”。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-10T19:56:31.173

是的，这是可能的。您还可以使用 array_key_exists 来检查这些值。PHP 将变量名的哈希映射与实际的数据存储区分开来（如果您有兴趣，请在 zval 上搜索）。话虽如此，数组还需要为每个元素具有关联的“桶”结构，这取决于您的操作系统和编译选项，可能高达 96 字节/每个。顺便说一句，Zval 每个也多达 48 个字节。

但是，我认为您不会从该方案中获得太多价值，但纯粹从假设的角度来看，您可以存储空值。

```
<?php

$foo = array('a' => null, 'b' => null);

if (array_key_exists('a', $foo))
    echo 'a'; 
```

但是，与初始化为布尔值相比，这不会为您节省任何内存。然后，您可以执行一个比对 array_key_exists 进行函数调用更快的 isset。

```
<?php
$foo = array('a' => true, 'b' => true);

if (isset($foo['a']))
   echo 'a'; 
```

# mysql - 查询结果不准确

> ID：15935096
> 
> 赞同：0
> 
> 时间：2013-04-10T19:49:24.957
> 
> 标签：mysql, sql

我有以下查询，它为我提供了准确的结果：

```
SELECT t.id
    FROM titles t
ORDER BY t.id 
```

我的结果是：

```
1
2
3
4
5
6
7
8
9
10
11
12
13
14 
```

我的第二个查询也为我提供了准确的结果：

```
SELECT t.id
FROM titles t 
    JOIN subscriptions s
        ON t.id = s.title
WHERE s.user=2 
```

结果：

```
10
11
14 
```

所以我想做的是接收第一个查询中没有出现在第二个查询中的所有结果，所以我运行这个：

```
SELECT t.id
    FROM titles t
ORDER BY t.id NOT IN 
(
SELECT t.id
FROM titles t 
    JOIN subscriptions s
        ON t.id = s.title
WHERE s.user=2 
); 
```

但我的结果最终是这样的：

```
14
11
10
13
12
9
8
7
6
5
4
3
2
1 
```

我在这里做错了什么？为什么我的第二个查询中的顺序颠倒了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-10T19:50:57.620

`NOT IN`应该是`WHERE`条件的一部分，而不是`ORDER BY`陈述：

```
SELECT
    t.id
FROM
    titles t
WHERE
    t.id NOT IN 
    (
        SELECT t.id
        FROM titles t 
            JOIN subscriptions s
               ON t.id = s.title
        WHERE s.user=2 
    )
ORDER BY
    t.id 
```

# android - 我应该期望 worklight 在 Android 项目中创建 armeabi-v7a 目录吗？

> ID：15935097
> 
> 赞同：0
> 
> 时间：2013-04-10T19:49:26.973
> 
> 标签：android, ibm-mobilefirst

对于我正在进行的项目，我们需要将 .so 文件提交到 apps/[app]/android/native/libs/armeabi-v7a 目录。但是，当我这样做时，我得到了 class not found 错误...意识到我需要 armeabi-v7a 中的其他库，类似于 Worklight 放在 armeabi 目录中的库（例如 libopenssl_fips）。

我应该“简单地”将那些自己从apps/[app]/android/native/libs/armeabi复制到apps/[app]/android/native/libs/armeabi-v7a吗？或者我应该做些什么不同的事情，以便 WL 构建应用程序/[app]/android/native/libs/armeabi-v7a 目录，其中包含这些库（例如 libopenssl_fips）？

谢谢，

埃里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T04:28:16.370

您应该将这些文件放在您自己指定的位置。Worklight 不会这样做。

# javascript - 使用 javascript(ecmascript) 获取列表的用户/组权限

> ID：15935101
> 
> 赞同：1
> 
> 时间：2013-04-10T19:49:43.397
> 
> 标签：javascript, sharepoint, sharepoint-2010, csom

我正在尝试使用 javascript 对象模型来检索列表的用户/组列表及其在列表级别的权限。到目前为止，我有这个返回一个成员对象，但我无法获得有关该成员的任何信息。当我尝试使用 rAssignment.get_member().get_id() 或 rAssignment.get_member().get_title() 时出现错误。

```
 //Get List Permissions
        function getListPerms() {
            var clientContext = new SP.ClientContext();
            var siteColl = clientContext.get_site();
            var site = clientContext.get_web();
            listSecurableObject = site.get_lists().getByTitle($("[name='ListSlct']").val());
            listRoleAssignments = listSecurableObject.get_roleAssignments();
            clientContext.load(listRoleAssignments);
            clientContext.executeQueryAsync(Function.createDelegate(this, this.getListPerms_onQuerySucceeded),Function.createDelegate(this, this.getListPerms_onQueryFailed));
       }
       function getListPerms_onQuerySucceeded() {
            var listPerms="";
            listPerms += '<table border="1">';
            listPerms += '<tr>';
            listPerms += '<td align="center">ID</td>';
            listPerms += '</tr>';
            var listPermsEnumerator =  this.listRoleAssignments.getEnumerator();
            while (listPermsEnumerator.moveNext()) {
                var rAssignment = listPermsEnumerator.get_current();
                listPerms += '<tr>';
                listPerms += '<td align="center">' + rAssignment.get_member() +  '</td>';
                listPerms += '</tr>';
            }
            listPerms += '</table>';
            document.getElementById('listPermsTable').innerHTML = listPerms;
       }
       function getListPerms_onQueryFailed(sender, args) {
           alert('Request failed. ' + args.get_message() + '\n' + args.get_stackTrace());
       } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-20T23:03:32.333

尝试更改您的 clientContext.load() 函数调用，如下所示：

```
clientContext.load(listSecurableObject, 'Include(RoleAssignments, RoleAssignments.Include(Member))'); 
```

现在在 getListPerms_onSucceeded() 方法中，您应该能够通过 listSecurableObject.get_roleAssignments() 进行枚举并获得类似于您已经在做的方式的成员（尽管您可能想要使用 rAssignment.get_member().get_loginName( ））。

# node.js - 在本地安装 express 和 stylus

> ID：15935102
> 
> 赞同：0
> 
> 时间：2013-04-10T19:49:57.617
> 
> 标签：node.js

我对节点 js 真的很陌生。我想知道是否有人能告诉我如何在我想要的目录中安装 express 框架和手写笔。我已经在全球范围内安装了它们，但找不到在本地安装它的方法。一个简单的建议就足够了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T19:54:20.200

```
> cd myFolder 
```

创建一个 README.md

```
> npm init 
```

填写详细信息

```
> npm install express stylus --save 
```

然后，您将在本地安装 express 和 stylus 并包含在您的 package.json 中

# c++ - 如何从外部“C”函数访问类变量？

> ID：15935106
> 
> 赞同：1
> 
> 时间：2013-04-10T19:50:08.883
> 
> 标签：c++, class, variables, extern

这是我的基本代码：

这是头文件：

```
/** Include the necessary things **/

Class MyClass{
    private:
        std::string mystring;
    /**
     * Declare constructor, methods, yada yada yada
     **/
}; 
```

这是源文件：

```
MyClass::MyClass(){
    mystring[0] = 0;
}

extern "C" MyClass::function(/* variables */){
    cerr << mystring << endl;
} 
```

看来，问题在于我在**cerr << mystring << endl;上遇到了分段错误。**线。**function()**需要是一个外部“C”函数，因为它作为参数传递给本地 C 函数。

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T19:53:50.247

创建一个类成员`extern "C"`的用处有限，我建议避免这种将 C++ 方法暴露给 C 代码的方法。

您应该做的是创建一个包装函数，该函数将指向实例的指针`MyClass`作为附加参数，并执行所需的调用：

```
extern "C" void MyClass_function(MyClass *obj, /* variables */) {
    obj->function(/* variables */);
} 
```

# java - HashMap 桶是什么类型

> ID：15935110
> 
> 赞同：0
> 
> 时间：2013-04-10T19:50:43.153
> 
> 标签：java, hashmap

我一直`HashMap`在研究 Java 中的实现。所有值都存储在作为`Entry`对象的“桶”中。我期待它是一个收藏品，还是我在这里遗漏了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-10T19:54:19.027

没有。由于它不必让用户通过 API 访问存储桶，因此`HashMap`只需在内部滚动其自己的非常小的链表实现即可减少内存使用并简化实现。它*可以*使用`LinkedList`，但它不需要双向链表，将链接、键、值、键的哈希码等打包到一个对象中会更有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T19:55:29.683

Entry 是一个集合（一个轻量级的排序链表。`Collection`严格来说不是java）。条目可以相互链接。

```
 static class Entry<K,V> implements Map.Entry<K,V> {
    final K key;
    V value;
    Entry<K,V> next;
    final int hash;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T19:54:56.607

我不知道你在看谁的实现，但是在[OpenJDK 6 版本](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/HashMap.java#HashMap.Entry)中，很明显 an`Entry`存储一个值，并且每个值`Entry`在链表中形成一个节点。

# javascript - JavaScript (Jquery) 小数点删除

> ID：15935116
> 
> 赞同：1
> 
> 时间：2013-04-10T19:50:57.480
> 
> 标签：javascript, jquery, counter

目前我正在研究 JavaScript、jQuery、HTML5 来提高自己。我有一个开源编码的时钟，我已将其转换为计数器（反向计数器）。

我遇到的问题是，`setInterval(){...}`我有四个变量-> 秒、分钟、小时和天。问题是，当我得到秒数时，我得到的结果是 1.155、2.312、3.412（秒）。

我的 setInterval 函数如下

```
setInterval(function(){
//var duration = parseInt(Date.now() /1000 ) - 1365470000;

var futureTime = Date.parse('April 10, 2013 22:00:00');

var duration = (( parseInt(Date.now() - futureTime ) / 1000));

var seconds = duration % 60;
duration = parseInt(duration / 60);
var minutes = duration % 60;
duration = parseInt(duration / 60);
var hours = (duration)%24;
duration = parseInt(duration / 24);
var days = duration % 365;  

        animation(gVars.green, seconds, 60);
        animation(gVars.blue, minutes, 60);
        animation(gVars.orange, hours, 24);
        animation(gVars.red, days, 365);

    },1000);

} 
```

自从我使用`parseInt(Date.now())`.

> 我必须提供链接，因为我没有足够的代表。

[http://i.stack.imgur.com/0Zkbi.png](http://i.stack.imgur.com/0Zkbi.png)

如何摆脱`setInterval(){}`函数中的小数点？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T19:53:16.243

```
var seconds = 1234.13;
var seconds = seconds + '';

seconds = seconds.split('.')[0];

console.log(seconds); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:07:56.583

JavaScript 提供了更方便的 API 来处理日期和时间，以获取秒、分钟、小时和天。试试这个代码：

```
var duration,
    seconds,
    minutes,
    hours;

duration = new Date((new Date('April 11, 2013 23:00:00')) - (new Date()));
seconds = duration.getSeconds();
minutes = duration.getMinutes();
hours = duration.getHours(); 
```

现在您将在上面的所有 4 个变量中都有整数值，没有任何小数点。

# opengl-es - 如何创建多个停止渐变片段着色器？

> ID：15935117
> 
> 赞同：11
> 
> 时间：2013-04-10T19:51:01.393
> 
> 标签：opengl-es, opengl-es-2.0, glsl, gradient, interpolation

我正在尝试创建一个 OpenGL ES 2.0 片段着色器，它沿一个轴输出多个停止渐变。它应该在以百分比定义的点处插入多种颜色。

我通过使用`if`片段着色器实现了这一点，如下所示：

```
float y = gl_FragCoord.y;
float step1 = resolution.y * 0.20;
float step2 = resolution.y * 0.50;

if (y < step1) {
    color = white;
} else if (y < step2) {
    float x = smoothstep(step1, step2, y);
    color = mix(white, red, x);
} else {
    float x = smoothstep(step2, resolution.y, y);
    color = mix(red, green, x);
} 
```

他们说片段着色器中的分支会降低性能。是否有一些巧妙的技巧可用于在不使用`if`s 的情况下在许多值之间进行插值？它真的值得吗（这是非常主观的，我知道，但作为经验法则）？

为了说明我的问题，此 GLSL 沙盒链接中的完整源代码（尽管仍然很短）：http: [//glsl.heroku.com/e#8035.0](http://glsl.heroku.com/e#8035.0)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-10T20:49:57.420

如果要消除分支，可以执行以下操作（取自 Heroku）；

```
color = mix(white, red, smoothstep(step1, step2, y));
color = mix(color, blue, smoothstep(step2, step3, y));
color = mix(color, green, smoothstep(step3, resolution.y, y)); 
```

但我完全不确定这是否比 if/else 快。

# c++ - 虚拟构造函数以及在其中调用虚拟函数会发生什么

> ID：15935121
> 
> 赞同：4
> 
> 时间：2013-04-10T19:51:19.300
> 
> 标签：c++, oop, object

我有两个问题，我在这里找到的答案并不完全让我满意：

*   为什么将构造函数声明为虚拟是没有意义的？
*   当我从构造函数调用虚函数时会发生什么？虚拟表也用了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T19:57:29.833

> 为什么将构造函数声明为虚拟是没有意义的？

在构造函数执行之前，对象是不存在的，所以不存在*override*之类的东西。

> 当我从构造函数调用虚函数时会发生什么？虚拟表也用了吗？

它可以。在大多数情况下，如果直接从构造函数执行调用，编译器可以跳过动态调度，因为此时它知道最终的覆盖器是什么。但它不需要执行该优化，即使它可以直接在构造函数中执行此操作，但如果您调用一个非虚拟函数又调用该虚拟函数，它也无法执行此操作。因为可能会为派生类型的对象调用非虚拟函数，所以它必须使用虚拟调度机制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T19:54:11.693

调用构造函数时，（尚不存在的）对象的实际类型是非常确定的。所以调用构造函数永远不会是间接的。（通过指针/引用调用时，仅间接调用虚函数。）

```
BaseClass *x = new SubClass(); 
```

在构造函数中调用虚函数并不符合您的预期。由于子类还没有被初始化，最终类上的虚函数不能被调用（v-table当前指向当前正在执行的构造函数的类）。

```
class BaseClass {
    BaseClass() {
        call();
    }
    virtual void call() {
        std::cout << "BaseClass!";
    }
};

class SubClass : public BaseClass {
    SubClass() : BaseClass()
    {
    }

    void call() {
        std::cout << "SubClass!";
    }
}; 
```

[http://ideone.com/9aQVIc](http://ideone.com/9aQVIc)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T19:58:32.410

`Why declaring a constructor as virtual is meaningless`.

当调用构造函数时，虚拟表在内存中将不可用。在 C++ 中声明一些虚拟的东西意味着它可以被当前类的子类覆盖，但是在创建对象时调用构造函数，那时你不能创建你必须的类的子类创建类，因此永远不需要声明一个虚拟构造函数。`virtual constructor`因此，在 C++中没有这样的东西。

`What happens when I call a virtual function from a constructor? Is the virtual table used too`

有关此问题的详细说明，请参阅[C++ FAQ链接。](http://www.parashift.com/c++-faq-lite/calling-virtuals-from-ctors.html)

# angularjs - 指令动态添加的输入预输入

> ID：15935122
> 
> 赞同：2
> 
> 时间：2013-04-10T19:51:19.733
> 
> 标签：angularjs, angular-ui, angular-ui-bootstrap

我有一个指令可以动态添加输入以响应对容器的点击。我希望能够在应用于动态输入的指令元素上预先输入。我已经设置了这个 plunk 来演示。

[http://plnkr.co/edit/199KeGRAd32ZeOIjTKe6?p=preview](http://plnkr.co/edit/199KeGRAd32ZeOIjTKe6?p=preview)

在我的应用程序中，预输入源是一个 http 调用。我在进行 http 调用的函数中放置了一些控制台日志，并且确实看到了返回的结果，所以我知道 typeahead 正在触发，但是正如您在 plunk 中看到的那样，typeahead 下拉菜单永远不会出现。我究竟做错了什么？

**注意** 交叉[张贴](https://groups.google.com/forum/?fromgroups=#!category-topic/angular-ui/bootstrap/tSzt5W3A5tM)在angularui的谷歌组

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T02:49:33.460

我看了你的代码，但我无法让它工作。相反，也许您可​​以使用 AngularUI 的类似功能。他们有基于 Select2 jQuery 插件的指令。

看看：[http ://angular-ui.github.io/#/directives-select2](http://angular-ui.github.io/#/directives-select2)

并阅读 Select2 文档以使用多值（有一个很好的演示）：http: [//ivaynberg.github.io/select2/#multi](http://ivaynberg.github.io/select2/#multi)

我希望它可以帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T04:11:08.753

是否有某些原因需要复杂性`$compile`？typeahead 指令似乎不能让你很容易地通过它，但如果你提供使用更通用的数据源，你可以这样做：

[http://plnkr.co/edit/SFhS7kbmI1c6pEyRS18v?p=preview](http://plnkr.co/edit/SFhS7kbmI1c6pEyRS18v?p=preview)

HTML：

```
<test test-model="test" test-typeahead-data-source="getData()"></test> 
```

JavaScript：

```
app.directive("test", function($rootScope, $compile) {
  return {
    restrict: 'E',
    scope: {
      testModel: '=',
      testTypeaheadDataSource: '='
    },
    template: '<input type="text" ng-model="testModel" typeahead="test as test.name for test in testTypeaheadDataSource" />'
  }
}); 
```

# javascript - MooTools 拖动/滑块无法正常运行

> ID：15935125
> 
> 赞同：0
> 
> 时间：2013-04-10T19:51:33.930
> 
> 标签：javascript, jquery, slider, mootools

我创建了这个 JSbin，因为我需要这个漂亮的滑块来做我正在创建的东西。该垃圾箱可以在这里找到[http://jsbin.com/ipoloy/3/edit](http://jsbin.com/ipoloy/3/edit)

由于这是我第一次使用 MooTools，我不太确定如何编写它，所以我复制了文档中所说的内容，只是为了先看看它是如何工作的。好吧，它没有，所以我把它包裹在一个`$(function() { });`仍然没有的东西中。我需要添加 jQuery 1.9 和 MooTools 1.4.5 吗？

任何有好的信息的人，请让我知道，这样我就可以解决这个问题并继续使用这个滑块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:17:23.833

将 mootools 与 mootools 一起添加，它会起作用。

[http://jsbin.com/egicem/1/edit](http://jsbin.com/egicem/1/edit)

在 mootools 库下面添加：

```
<script src="http://cdnjs.cloudflare.com/ajax/libs/mootools-more/1.4.0.1/mootools-more-yui-compressed.js"></script> 
```

它托管在[http://cdnjs.com/](http://cdnjs.com/)网站上

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:12:21.263

您只需要添加 mootools 更多（滑块在 mootools 中更多）：

但我不认为“更多”在 google apis 中，所以你需要在 mootools 站点中构建它：http: [//mootools.net/more/](http://mootools.net/more/)

[http://jsfiddle.net/rjAN3/](http://jsfiddle.net/rjAN3/)

```
var slider = $('slider');

  new Slider(slider, slider.getElement('.knob'), {
    range: [9, 35],
    initialStep: 14,
    onChange: function(value){
      if (value) $('fontSize').setStyle('font-size', value);

         }
  }); 
```

# java - 将 Activity.onCreate 中的参数传递给其他方法

> ID：15935137
> 
> 赞同：2
> 
> 时间：2013-04-10T19:52:07.357
> 
> 标签：java, android

我目前正在学习 Java，并且是 Android 的新手。下面是我的 onCreate 方法，最后我有两个`EditText`字段，`passT`（纯文本）和`keyT`（加密密钥）。我想将这两个作为参数传递给我的加密方法（也在下面）并检索结果并在 cipher 中设置值`EditText`。

我想将值设置为用户将输入的电子邮件地址（`emailT`目前没有`EditText`为它设置字段）。

```
public class ScreenNext extends Activity {

    int key = 0;
    static char ch;

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_screen_next)

        EditText emailT;//Import  EditTexts (Key and Email)  
        Button send = (Button) findViewById(R.id.bSend);//Import button1 (Send)
        final EditText passT = (EditText) findViewById(R.id.etTogg);//passT variable for Password Text for EditText field
        final EditText keyT = (EditText) findViewById(R.id.etKey);
        final EditText passT = (EditText) findViewById(R.id.etTogg);//passT variable for Password Text for EditText field

        send.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                String keyText = keyT.getText().toString();
                String passText = passT.getText().toString();
            }

        });

    }//End onCreate
    ...
} 
```

我的加密方法（包括其他方法，以防我的解决方案需要观察它们）：

```
public static String message(String choice, String subKey, String message) {
    int Option = Integer.parseInt(choice);//Must pareseInt
    int key = Integer.parseInt(subKey);
    message = message.toLowerCase();

    //If the key is 26, prompt the user to change the key

    if (key % 26 == 0) {

        //Toast.makeText(getApplicationContext(), "You can't use a modulus of 26 as a key", Toast.LENGTH_LONG).show();

    }

    ScreenNext subcipher_1 = null;
    String CipherTxt = subcipher_1.encrypt(message, key);
    return CipherTxt;
}

// Message prompt method finished, now we create the method that has the
// encrypting algorithms

public static String encrypt(String Txt, int key) {

    //local var cipherText of type string is init empty
    String CipherTxt = "";//May be able to remove this'un 
    String cText="";
    //enhanced for loop 
    // start at 0, go until "as long as input text" 
    for (int i = 0; i < Txt.length(); i++) {
        //get a char from the string at index i (start at 0 work through to end of string)
        // and store in local var extractedChar for type char
        char extractedChar = Txt.charAt(i);
        /* enhanced for loop 
         * start at 0, go until end of user entered cipherKeyValue
         * either set to lowercase a or add one to the char
         * uses the checkifz method
         */
        for (int j = 0; j < key; j++) {
            ScreenNext subcipher_1 = null;
            if (subcipher_1.checkIfZ(extractedChar) == true) {
                extractedChar = 'a';
            } else {
                extractedChar++;
            }
            CipherTxt= new StringBuilder().append(extractedChar).toString();
        }
        //add extracted char to builder object
        //change object builder to string and assing to cipherText of type String
        //create new object builder from StringBuilder class
        cText = cText.concat(CipherTxt);
    }
    //Pass the cipherText value out of the method to whom ever called it

    return cText;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-10T19:58:03.143

在类级别声明变量

```
public class ScreenNext extends Activity {

    int key = 0;
    static char ch;
    String keyText = null;
    String passText = null;

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        // ....
        send.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                keyText = keyT.getText().toString();
                passText = passT.getText().toString();
            }
        });
        // ...
    }
    // ...
} 
```

# database - 在同一数据库的不同模式中使用相同的 DBLink 名称 - 使 Procs 无效

> ID：15935138
> 
> 赞同：0
> 
> 时间：2013-04-10T19:52:07.810
> 
> 标签：database, oracle, procedure, dblink

我有“PROD-1”数据库，其中包含 2 个模式“Schema-1”，“Schema-2”我在两个模式中创建了私有 dblink“DBLINK-1”，它们指向不同的目标。这是我的配置

数据库名称 -> 源架构 -> 目标数据库 -> 目标架构 -> Dblink 名称

PROD-1 -> Schema-1 -> TPRD-1 -> TSchema-1 -> DBLINK-1

PROD-1 -> Schema-2 -> TPRD-2 -> TSchema-2 -> DBLINK-1

当我在 Schema-1 中编译 proc 时，我在过程中使用这个 dblink 并部署在 Schema-1 和 Schema-2 中，它使 Schema-2 proc 无效，反之亦然。这是示例过程

```
CREATE OR REPLACE procedure test_dblink 
```

`is` `v_cnt number;`

```
begin
   select count(*) into v_cnt from DUAL@DBLINK-1; 
```

`end;`

据我了解，DBLINK-1 是 Schema-1 和 Schema-2 的私有 dblink；因此它不应该相互冲突。但是，当我在两种模式中同时执行这些程序时，一个程序成功执行，另一个正在等待第一个程序完成然后完成。

这就是可能发生的事情

1.  Schema-1 proc 首先启动，Proc 状态为 Valid。Schema-2 proc 正在等待
2.  Schema-1 proc 现已完成。Schema-2 proc 退出等待模式并使 Schema-1 中的 DBLink-1 无效。因此 Schema-1 proc 现在处于无效状态
3.  Schema-2 proc 运行并完成。Schema-2 proc 现在有效

我的问题是，如何在没有这种冲突的情况下在同一个数据库的两个不同模式中管理同一个 DBLink？

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-09T08:48:52.357

我们使用同义词解决了这个问题。为您的数据库链接使用唯一名称。然后在每个模式中为您使用的每个远程对象创建同义词。这样，您仍然可以在两种模式中使用相同的 PL/SQL 代码。

# performance - msbuild 中多个通配符掩码搜索的性能有效解决方案？

> ID：15935141
> 
> 赞同：1
> 
> 时间：2013-04-10T19:52:16.347
> 
> 标签：performance, msbuild, wildcard, file-search

我正在创建 msbuild 项目，其中一项任务是在满足提供的任何文件掩码的目录中查找所有文件。

我意识到，即使我在/属性中只创建了`Item`带有多个通配符的一行，msbuild 也会为**每个**通配符完全重新扫描整个目录层次结构。`Include``Exclude`

 **因此，如果完整目录扫描`($Path)\**`需要 6 秒，那么仅使用 10 个通配符将使其长达一分钟——这对于我的目的来说相当慢。

我认为扫描文件的操作确实很**慢**，而掩码比较（每个文件名一个或十个或数千个）应该快更多倍**-**所以我寻找的是有效扫描目录层次结构以查找多个文件掩码的解决方案。

这是示例 msbuild 项目，它显示了我的意思：

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" DefaultTargets="Build">
  <PropertyGroup>
    <MyPath>C:\Windows</MyPath>
  </PropertyGroup>

  <Target Name="Build" DependsOnTargets="Warmup;CheckOne;CheckTwo;CheckFive">
  </Target>

  <Target Name="Warmup">
    <ItemGroup>
      <Item1 Include="$(MyPath)\**" />
    </ItemGroup>
  </Target>

  <Target Name="CheckOne">
    <ItemGroup>
      <Item2 Include="$(MyPath)\**\*.exe" />
    </ItemGroup>
  </Target>

  <Target Name="CheckTwo">
    <ItemGroup>
      <Item2 Include="$(MyPath)\**\*.dll" Exclude="$(MyPath)\**\System32\**" />
    </ItemGroup>
  </Target>

  <Target Name="CheckFive">
    <ItemGroup>
      <Item3 Include="$(MyPath)\**\*.exe;$(MyPath)\**\*.dll" Exclude="$(MyPath)\**\System32\**;$(MyPath)\**\SysWOW64\**;$(MyPath)\**\winsxs\**" />
    </ItemGroup>
  </Target>
</Project> 
```

首先，它扫描整个 Windows 目录以“预热”FS 并将它可以缓存的任何内容，然后它查找单个掩码，然后查找两个掩码（一个包含和一个排除），然后查找五个掩码（两个包含和 3 个排除） .

当我使用`/v:diag`switch 运行它时，我收到以下时间：

```
Target Performance Summary:
        0 ms  Build                                      1 calls
     6196 ms  CheckOne                                   1 calls
     7942 ms  Warmup                                     1 calls
    15030 ms  CheckTwo                                   1 calls
    39249 ms  CheckFive                                  1 calls 
```

所以我看到的是，平均每个面具会增加 6-8 秒的结果。

可以看到类似的结果，例如使用`procmon`which 表明 msbuild 确实在同一文件层次结构上一一搜索所有掩码。

一般来说，我正在寻找什么 - 如何使`CheckFive`目标与任务或多或少地花费相同的时间`CheckOne`。

为了证明自己枚举文件很慢，我创建了自定义任务，它仅枚举目录层次结构，并对每个文件应用多个掩码 - 是的，任何合理数量的掩码都需要或多或少相同的时间。

但我仍然认为我做错了什么——我可以用纯 msbuild 达到同样的效率吗？**

# magento - Magento 工具栏不呈现寻呼机

> ID：15935144
> 
> 赞同：2
> 
> 时间：2013-04-10T19:52:25.160
> 
> 标签：magento, toolbar, pager, php

我是 Magento 的新手，当从 catalog/category/view.phtml 文件调用它时，我很难弄清楚如何在工具栏中显示寻呼机。这是我正在使用的代码：

```
$layout = Mage::getSingleton('core/layout');
$toolbar = $layout->createBlock('catalog/product_list_toolbar');
$pager = $layout->createBlock('catalog/html_pager');
$block = $layout->createBlock('catalog/product_list');
$block->setCategoryId($_category->getId());
$block->setChild('toolbar', $toolbar);  
$collection = $block->getLoadedProductCollection();
$toolbar->setCollection($collection);
echo $toolbar->renderView(); 
```

排序方式，每页显示项目和项目总数显示适当，但寻呼机只是没有呈现..有人知道我做错了什么吗？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:42:23.147

你有两个问题我可以立即发现

1.  没有这样的块类型`catalog/html_pager`（你的意思是`page/html_pager`）

2.  工具栏块的`getPagerHtml`方法查找名为 的子块`product_list_toolbar_pager`。您尚未插入、附加或设置此子项。

用这样的东西实例化寻呼机块

```
$pager = $layout->createBlock('page/html_pager'); 
```

并将其插入工具栏中

```
$toolbar->setChild('product_list_toolbar_pager', $pager); 
```

你可能会有更好的结果。

此外，寻呼机模板本身 ( `frontend/base/default/template/page/html/pager.phtml`) 包含的代码会在只有一页结果时隐藏页面。围绕这个 if 子句进行一些调试。

```
<!-- File: app/design/frontend/base/default/template/page/html/pager.phtml -->
<?php if($this->getLastPageNum()>1): ?> 
```

以确保您不会与小类别列表发生冲突。

# php - CPHPAuthmanger 有什么问题？

> ID：15935148
> 
> 赞同：0
> 
> 时间：2013-04-10T19:52:35.970
> 
> 标签：php, yii

我正在为 RBAC 使用 CPHPAuthmanager。我不知道我的代码有什么问题？为什么每当有人登录时它不分配角色，除了正常？

//protected/config/app.php

```
<?php
  return array(
'userTypes' => array(
    'normal' => 0,
    'admin' => 1,
    'student' => 2,
    'teacher' => 3

),
'userTypesArray' => array(
    0 => 'normal',
    1 => 'admin',
    2 => 'student',
    3 => 'teacher'
),
    );
?> 
```

//受保护的/数据/auth.php

```
<?php
  return array(
'admin' => array(
        'type' => 2,
        'description' => '',
        'bizRule' => NULL,
        'data' => NULL
    ),

'student' => array(
        'type' => 2,
        'description' => '',
        'bizRule' => NULL,
        'data' => NULL
    ),

'teacher' => array(
        'type' => 2,
        'description' => '',
        'bizRule' => NULL,
        'data' => NULL
    ),

'normal' => array(
        'type' => 2,
        'description' => '',
        'bizRule' => NULL,
        'data' => NULL
    )
 );

?> 
```

//protected/components/UserIdentity.php

```
if(count($users) == 0)
        $this->errorCode=self::ERROR_USERNAME_INVALID;
    elseif ($users[0]->password!==$this->password)
        $this->errorCode=self::ERROR_PASSWORD_INVALID;
    else
    {
        Yii::app()->authManager->clearAuthAssignments();
        $this->errorCode=self::ERROR_NONE;
        $this->setState('rol', $users[0]->type);
        if($users[0]->type == Yii::app()->params['app']['userTypes']['admin'])
            Yii::app()->authManager->assign('admin', $users[0]->UId);
        elseif($users[0]->type == Yii::app()->params['app']['userTypes']['student'])
            Yii::app()->authManager->assign('student', $users[0]->UId);
        elseif($users[0]->type == Yii::app()->params['app']['userTypes']['teacher'])
            Yii::app()->authManager->assign('teacher', $users[0]->UId);
        else
        {
            Yii::app()->authManager->assign('normal', $users[0]->UId);
        }
        Yii::app()->authManager->save();
    }
    return !$this->errorCode; 
```

//配置/主

```
$auth=Yii::app()->authManager;

$bizRule='return !Yii::app()->user->isGuest;';

$auth->createRole('normal', 'Normal User', $bizRule);

$bizRule='return (isset(Yii::app()->user->rol))? (Yii::app()->user->rol === "admin") : false;';
$auth->createRole('admin', 'System Admin', $bizRule);

$bizRule='return (isset(Yii::app()->user->rol))? (Yii::app()->user->rol === "student") : false;';
$auth->createRole('student', 'Student', $bizRule);

$bizRule='return (isset(Yii::app()->user->rol))? (Yii::app()->user->rol === "teacher") : false;';
$auth->createRole('teacher', 'Teacher', $bizRule); 
```

//控制器/一些控制器

```
public function accessRules()
{
return array(
            array('allow', 
            'actions'=>array('index', 'view', 'create', 'update', 'admin','delete'),
            'roles'=>array('admin'),
        ),
        array('deny',  // deny all users
            'users'=>array('*'),
        ),
    );
} 
```

请帮助我，在此先感谢。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T23:18:56.833

在 config/main components 部分定义如下。

```
'authManager' =>array(
   ...
   'defaultRoles' => array('normal', 'admin', 'student', 'teacher'),
), 
```

然后用 bizrules 创建这样的角色

```
$auth=Yii::app()->authManager;

$bizRule='return !Yii::app()->user->isGuest;';
$auth->createRole('normal', 'Normal User', $bizRule);

$bizRule='return (isset(Yii::app()->user->rol))? (Yii::app()->user->rol === "admin") : false;';
$auth->createRole('admin', 'System Admin', $bizRule);

$bizRule='return (isset(Yii::app()->user->rol))? (Yii::app()->user->rol === "student") : false;';
$auth->createRole('student', 'Student', $bizRule);

$bizRule='return (isset(Yii::app()->user->rol))? (Yii::app()->user->rol === "teacher") : false;';
$auth->createRole('teacher', 'Teacher', $bizRule);

$auth->save(); 
```

注意我没有使用'role' 我使用'rol' 而是我们现在将在UserIdentity 中定义。在 UserIdentity 中获取记录的用户数据后，只需使用以下代码将 rol 状态设置为用户对象：

```
$this->setState('rol', $user->type); //can be 'normal', 'admin', 'student', 'teacher' 
```

# multithreading - 如何在 MonoDroid 中使用线程，使其与 MonoTocuh 跨平台兼容

> ID：15935151
> 
> 赞同：0
> 
> 时间：2013-04-10T19:52:53.033
> 
> 标签：multithreading, mono, xamarin.ios, xamarin.android

特别是在 MonoDroid 使用线程时，我能找到的所有文档都建议调用 RunOnUiThread() 来调用回调。有一个类似的功能可以在 MonoTouch 上使用，但是它们都需要一个 GUI（Activity 或其对应部分在 IOS 上）。我想要的是能够启动一个线程，传入一个回调并在启动线程的线程上调用该回调。例如

```
ThreadPool.QueueUserWorkItem(state =>
{
    //Do Stuff

    execute_callback_magically_on_main_thread(() => callback(response));
}); 
```

有任何想法吗？需要明确的是，我希望这不需要 Activity 等的句柄。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:29:22.007

如果你做这样的事情怎么办？（假设他们有相同的签名）我没有搞砸`RunOnUiThread`，所以我不知道它的签名。

```
 public delegate void InvokeOnUIMethod(Action action);

    public void CallingMethod()
    {
        //iOS
        MyMethod(InvokeOnMainThread, () => { /* Your callback functionality  */ });

        //Android
        MyMethod(RunOnUiThread, () => { /* Your callback functionality  */ });
    }

    public void MyMethod(InvokeOnUIMethod execute_callback_magically_on_main_thread, Action callback)
    {
        System.Threading.ThreadPool.QueueUserWorkItem(state =>
        {
            //Do Stuff

            execute_callback_magically_on_main_thread(() => callback(response));
        });
    } 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T09:04:28.767

使用 Alpha 版本（希望很快可以稳定使用），您可以使用新的 Async await 习惯用法。

这是 MSDN 上的概述：

[http://msdn.microsoft.com/en-gb/library/vstudio/hh191443.aspx](http://msdn.microsoft.com/en-gb/library/vstudio/hh191443.aspx)

这是 Channel9 上的精彩视频系列：

[http://channel9.msdn.com/Series/Three-Essential-Tips-for-Async/Tip-1-Async-void-is-for-top-level-event-handlers-only](http://channel9.msdn.com/Series/Three-Essential-Tips-for-Async/Tip-1-Async-void-is-for-top-level-event-handlers-only)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T01:02:58.187

我找到了一个可行的解决方案，并且似乎不依赖于任何一个平台。

```
Task<string> t = new Task<string>(() =>
{
    //Do Stuff
    return "my results";
});
t.ContinueWith(task =>{
    if(callback != null)
         callback(task.Result);
    }, TaskScheduler.FromCurrentSynchronizationContext());
t.Start(); 
```

重要的部分是 TaskScheduler.FromCurrentSynchronizationContext()，它告诉“ContinueWith”在原始线程上执行。

# java - 将字符串转换为操作的库

> ID：15935153
> 
> 赞同：-1
> 
> 时间：2013-04-10T19:53:01.350
> 
> 标签：java

是否有一个 Java 库可以用来将条件转换为实际代码，而不是为所有组合使用大量的 case 语句？

例如：“GT value1 LT value2”，它应该根据我给出的输入值返回真/假。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T19:56:58.433

我想你需要看看 ANTLR 框架。

[ANTLR 网站](http://www.antlr.org/)

仅供参考：

[ANTLR：有一个简单的例子吗？](https://stackoverflow.com/questions/1931307/antlr-is-there-a-simple-example)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:12:35.850

这不是一项简单的任务，您需要的是 Java 的脚本语言解释器。

您可以查看[OGNL](http://commons.apache.org/proper/commons-ognl/)或[JSR](http://en.wikipedia.org/wiki/JSR_94) api。这些都需要相当广泛的语法知识。因此，取决于您想要做什么，可能无法填写简介。

然而，如果没有一些结构化的语法，你就完全依赖于英语语言的结构——你正在进入[NLP](http://en.wikipedia.org/wiki/Outline_of_natural_language_processing)的领域。

如果您正在寻找的只是一种在运行时改变行为的方法，您可以只使用像[Groovy这样的脚本语言。](http://groovy.codehaus.org/)

# sql-server - 序列号，在 SQL Server 中创建和修改

> ID：15935157
> 
> 赞同：5
> 
> 时间：2013-04-10T19:53:07.643
> 
> 标签：sql-server, tsql, triggers, named-pipes

我需要为我的应用程序中的大多数实体添加序列号，因为我将并行运行 Lucene 搜索索引。

而不是必须运行正在进行的轮询过程，或者通过我的应用程序手动运行我的索引器，我正在考虑以下内容：

*   添加`Created`默认值为 的列`GETUTCDATE()`。
*   添加`Modified`默认值为 的列`GETUTCDATE()`。
*   向更新到`ON UPDATE`的表添加触发器（这会*在*执行 UPDATE 时发生吗？即它添加到 SQL 查询而不是之后单独更新它？）`Modified``GETUTCDATE()`*`SET [Modified] = GETUTCDATE()`*
**   触发器将`ON UPDATE`调用我的 Lucene 索引器来更新它的索引（这可能是一个`xp_cmdshell`调用，但是有没有办法向进程发送消息而不是开始一个新的？我听说我可以使用命名管道，但是如何您是否使用 Sproc 或触发器中的命名管道？（当然，搜索“SQL Server 命名管道”会给我不相关的结果）。*

 *这听起来不错，我该如何解决小问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-11T19:43:12.050

据我了解，您必须在现有表中引入两列，并让它们在“运行时”中处理（在其中一个东部）并由外部组件使用。

你的前三点并不稀奇。SQL Server 中的触发器根据触发器被处理的时间有两种类型：INSTEAD OF 触发器（实际上是在插入发生之前处理）和 AFTER 触发器。但是，在 INSTEAD OF 触发器中，您必须提供将数据*真正*插入表中的逻辑，以及您需要的其他自定义处理。如果不是真的必要，我通常会避免这种情况。

现在关于你的第四点 - 这很棘手，在 SQL Server 中有几种方法可以解决这个问题，但它们都至少有点难看。基本上，您必须执行外部进程或向其发送消息。我真的对 Lucene 索引器没有任何经验，但我想其中一种方法（执行或发送消息）会适用。

因此，您可以执行以下操作之一来直接或间接访问外部组件，即直接或通过某些代理模块访问 Lucene 索引器：

1.  **实现不安全的 CLR 触发器**；基本上，您在触发器内执行 .NET 代码，从而可以访问整个（小心 - 不完全正确）.NET 框架
2.  **执行不安全的 CLR 程序**；与 CLR 触发器的唯一区别是您不会在 INSERT 之后立即调用它，但是您可以处理一些定期运行的数据库作业
3.  **使用 xp_cmdshell**；您已经知道这一点，但您可以在最后一点将这种方法与工作包装技术结合起来
4.  **调用网络服务**；这种技术通常被标记为实验性的，你必须自己实现服务（如果 Lucene 索引器没有自己安装一些 Web 服务）
5.  肯定还有其他我现在想不到的方法...

由于简单，我个人会选择第三点（job+xp_cmdshell），但这只是因为我对 Lucene 索引器的工作原理缺乏任何了解。

**编辑（另一种选择）：**

**使用查询通知**；SQL Server Service Broker 允许外部应用程序连接和监视有趣的更改。您甚至有多种选择如何做到这一点（基本上是同步的或异步的），唯一的前提是您的 Service Borker 已启动、运行并可供您的应用程序使用。这是一种更复杂的方法来通知外部组件发生了一些变化。*

# java - “非法开始表达”菜鸟失误？

> ID：15935159
> 
> 赞同：-1
> 
> 时间：2013-04-10T19:53:15.063
> 
> 标签：java, compiler-errors

我需要知道为什么我在第 18-21 行收到此错误。我觉得它可能是与支架相关的问题，但我无法弄清楚。

```
import java.util.Scanner;

public class Proj4_1 {

public static void main(String [] args) {
    Scanner reader = new Scanner(System.in);

    int numb1 =;
    int numb2 =; 
    int div =;
    int remainder =;

    System.out.println("Enter a number: ");
    numb1 = reader.nextint();

    System.out.print(numb1);

    System.out.println("Enter another number: ");
    numb2 = reader.nextint();

    System.out.print(numb2);

    if (numb1>numb2){
        div = numb1 / numb2;
        remainder = numb1 % numb2;
    }else{
    if (numb2>numb1) 
        div = numb2 / numb1;
        remainder = numb2 % numb2;  
    }

    System.out.println("The answer quotient is " +div+ "with a remainder of" +remainder); 
```

任何帮助或建议将不胜感激，在此先感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-10T19:53:45.317

好吧，看看这个：

```
int numb1 =; 
```

您期望初始值是多少？

你可以声明一个变量而不给它赋值，像这样：

```
int numb1; 
```

...但你不能离开`=`那里而不给出价值。

但是，我个人会*等待*声明变量，直到您准备好为其赋值：

```
public static void main(String [] args) {
    Scanner reader = new Scanner(System.in);

    System.out.println("Enter a number: ");
    // Fixed case of nextInt as well...
    int numb1 = reader.nextInt();

    System.out.print(numb1);

    System.out.println("Enter another number: ");
    int numb2 = reader.nextInt();

    System.out.print(numb2);

    // etc
} 
```

您不必在方法的顶部声明所有变量，如果您只在第一次需要它们的地方声明它们，您的代码通常会更干净。

编辑：还有这个`if`不正确的块：

```
if (numb2>numb1)
    div = numb2 / numb1;
    remainder = numb2 % numb2;  
} 
```

您错过了开口大括号，这意味着您*实际上*已经得到了这个：

```
if (numb2>numb1) {
    div = numb2 / numb1;
}
remainder = numb2 % numb2;  
// This closing brace is now dangling!
} 
```

你真的是这个意思：

```
if (numb2 > numb1) {
    div = numb2 / numb1;
    remainder = numb2 % numb2;  
} 
```

请注意，如果您定期编译代码，您将不会遇到这么多*不同的*错误。一旦你得到一个编译时错误，你应该停下来，确保你理解它，然后修复它。这样一来，您将永远不会面临要立即尝试理解的大量问题。此外，您无需担心多个错误会相互影响，这会使生活变得更加困难。

# gmail - 深入了解 Gmail Meter 的本质

> ID：15935165
> 
> 赞同：0
> 
> 时间：2013-04-10T19:53:25.637
> 
> 标签：gmail

背景故事：我在一个使用 Gmail 作为企业电子邮件系统的地方工作。我们在线销售商品，提供电话号码、聊天和电子邮件以供客户服务。我们可以从电话和聊天记录中提取统计数据，但不能从电子邮件中提取。这就是 Gmail Meter 发挥作用的地方。我们安装它是为了更深入地了解我们的电子邮件统计信息。我们做到了，但有些数字似乎不对。谁能稍微解释一下 GMeter 的后端工作原理，希望能解释为什么我们的数字出现了？

此外，我查看了 gmail 管理面板，“报告”选项卡似乎只提供了所有帐户的高级概述，而不是特定帐户，例如邮件使用总量、用户活动、电子邮件帐户总数和使用情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T14:02:08.380

我是 Gmail Meter 团队的 Ryan。我们知道现在存在一些错误，因此并不是每个人的数据都得到了正确的分析。似乎有些参数是为几天而不是几周的计数而设置的。

随时给我发一封电子邮件，当我们修复它时，我会向您发送更新。

感谢您提请注意！

ryan@shuttlecloud.com

# javascript - Backbone Jquery show() 在第二次加载时没有动画

> ID：15935167
> 
> 赞同：1
> 
> 时间：2013-04-10T19:53:29.430
> 
> 标签：javascript, jquery, backbone.js

我的问题是我第一次加载页面并且视图正确显示。show 函数执行动画，但是当我导航到不同的视图并返回时，它没有动画但仍然显示。在路由器中，我为导航到的每个页面创建一个新视图。

我将集合保存到一个名为的全局应用程序以限制加载。当我每次重新创建集合时，显示动画都会起作用，这让我认为它在渲染方法中有所体现。我认为这可能与 jquery 缓存了旧元素这一事实有关，当我再次将模板添加到页面时，选择器正在寻找旧元素而不是新元素。

我的页面视图代码如下。就像我说它第一次正常工作，但第二次动画没有发生。

```
 initialize: function() {
    if(!app.collections.boardsList)
        app.collections.boardsList = new app.BoardsListCollection();

    this.listenTo(app.collections.boardsList, "add", this.renderOne);
    this.listenTo(app.collections.boardsList, "reset", this.render);
    this.listenTo(app.collections.boardsList, "change", this.render);

    this.render();

    app.collections.boardsList.fetch();
    this.interval = setInterval(function(){
        app.collections.boardsList.fetch();
        console.log("Fetching");
    }, 10000);

},

render : function(){
    this.$el.html(this.template());
    this.renderAll();
    return this;
},

renderAll : function(){
    app.collections.boardsList.each(this.renderOne, this);
},

renderOne : function(item){
    var container = !this.state ? "#left-list" : "#right-list";
    var boardView = new app.BoardsItemView({
        model : item
    });
    boardView.$el.hide();
    boardView.render();
    this.$el.find(container).append(boardView.$el);
    boardView.$el.show("fast");
    this.state = this.state ? 0 : 1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-27T03:57:44.720

我也有同样的问题。当主干试图捕获 jquery 对象时存在不兼容性。我直接使用select的jquery解决了它

# sas - 修改 SAS 数据集中的单个观察值

> ID：15935170
> 
> 赞同：3
> 
> 时间：2013-04-10T19:53:42.323
> 
> 标签：sas, datastep

假设我有以下数据集：

```
data people;
    input name $ age;
    datalines;
Timothy 25
Mark 30
Matt 29
;
run; 
```

如何更改特定人的年龄？基本上，我想知道如何指定 a`name`并告诉 SAS 更改那个人的（观察值）`age`值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-10T20:03:26.493

简单案例：

```
data want;
set people;
if name='Mark' then age=31;
run; 
```

您可以通过多种方式在同一数据集中更改它：

```
proc sql;
  update want 
    set age=31 
    where name='Mark';
quit;

data people;
set people;
if name='Mark' then age=31;
run;

data people;
modify people;
if name='Mark' then age=31;
run; 
```

等等

# android - 能够在 Eclipse 中运行，但在移动设备上强制关闭

> ID：15935172
> 
> 赞同：0
> 
> 时间：2013-04-10T19:53:48.097
> 
> 标签：android, forceclose

登录页面后我的订购应用程序将转到 Scanner、List 和 Order。在我点击订单后进入目录，它可以在 eclipse 虚拟设备上运行，但不能在移动设备上运行。其他页面没问题

这是 CatalogActivity.java

```
package com.example.barcode;

import java.util.List;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.Button;
import android.widget.ListView;

public class CatalogActivity extends Activity {

 private List<Product> mProductList;
 Button button;

 @Override
 public void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.catalog);

  // Obtain a reference to the product catalog
  mProductList = ShoppingCartHelper.getCatalog(getResources());

  // Create the list
  ListView listViewCatalog = (ListView) findViewById(R.id.ListViewCatalog);
  listViewCatalog.setAdapter(new ProductAdapter(mProductList, getLayoutInflater(), false));

 listViewCatalog.setOnItemClickListener(new OnItemClickListener() {

  @Override
  public void onItemClick(AdapterView<?> parent, View view, int position,
    long id) {
   Intent productDetailsIntent = new         Intent(getBaseContext(),ProductDetailsActivity.class);
   productDetailsIntent.putExtra(ShoppingCartHelper.PRODUCT_INDEX, position);
  startActivity(productDetailsIntent);
}
});

Button viewShoppingCart = (Button) findViewById(R.id.ButtonViewCart);
viewShoppingCart.setOnClickListener(new OnClickListener() {

 @Override
 public void onClick(View v) {
  Intent viewShoppingCartIntent = new Intent(getBaseContext(), ShoppingCartActivity.class);
  startActivity(viewShoppingCartIntent);
 }
});

} 
```

}

这是电话的目录

04-09 01:45:45.174 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE 跨度不能有零长度

```
04-09 01:45:45.174 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:45:48.484 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:45:48.484 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:45:56.939 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:45:56.939 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:45:57.424 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:45:57.424 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:45:57.429 E/System  (30213): Uncaught exception thrown by finalizer

04-09 01:45:57.429 E/System  (30213): java.io.IOException: close failed: EIO (I/O error)

04-09 01:45:57.429 E/System  (30213):   at libcore.io.IoUtils.close(IoUtils.java:41)

04-09 01:45:57.429 E/System  (30213):   at java.io.FileOutputStream.close(FileOutputStream.java:139)

04-09 01:45:57.429 E/System  (30213):   at java.io.FileOutputStream.finalize(FileOutputStream.java:153)

04-09 01:45:57.429 E/System  (30213):   at java.lang.Daemons$FinalizerDaemon.doFinalize(Daemons.java:186)

04-09 01:45:57.429 E/System  (30213):   at java.lang.Daemons$FinalizerDaemon.run(Daemons.java:169)

04-09 01:45:57.429 E/System  (30213):   at java.lang.Thread.run(Thread.java:856)

04-09 01:45:57.429 E/System  (30213): Caused by: libcore.io.ErrnoException: close failed: EIO (I/O error)

04-09 01:45:57.429 E/System  (30213):   at libcore.io.Posix.close(Native Method)

04-09 01:45:57.429 E/System  (30213):   at libcore.io.BlockGuardOs.close(BlockGuardOs.java:75)

04-09 01:45:57.429 E/System  (30213):   at libcore.io.IoUtils.close(IoUtils.java:38)

04-09 01:45:57.429 E/System  (30213):   ... 5 more

04-09 01:45:57.434 E/System  (30213): Uncaught exception thrown by finalizer

04-09 01:45:57.434 E/System  (30213): java.io.IOException: close failed: EIO (I/O error)

04-09 01:45:57.434 E/System  (30213):   at libcore.io.IoUtils.close(IoUtils.java:41)

04-09 01:45:57.434 E/System  (30213):   at java.io.FileInputStream.close(FileInputStream.java:121)
04-09 01:45:57.434 E/System  (30213):   at java.io.FileInputStream.finalize(FileInputStream.java:142)

04-09 01:45:57.434 E/System  (30213):   at java.lang.Daemons$FinalizerDaemon.doFinalize(Daemons.java:186)

04-09 01:45:57.434 E/System  (30213):   at java.lang.Daemons$FinalizerDaemon.run(Daemons.java:169)

04-09 01:45:57.434 E/System  (30213):   at java.lang.Thread.run(Thread.java:856)

04-09 01:45:57.434 E/System  (30213): Caused by: libcore.io.ErrnoException: close failed: EIO (I/O error)

04-09 01:45:57.434 E/System  (30213):   at libcore.io.Posix.close(Native Method)

04-09 01:45:57.434 E/System  (30213):   at libcore.io.BlockGuardOs.close(BlockGuardOs.java:75)

04-09 01:45:57.434 E/System  (30213):   at libcore.io.IoUtils.close(IoUtils.java:38)

04-09 01:45:57.434 E/System  (30213):   ... 5 more

04-09 01:45:58.214 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:45:58.214 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:46:00.394 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:46:00.394 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:46:30.454 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:46:30.454 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:46:30.879 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:46:30.879 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:47:01.334 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:47:01.334 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:47:02.439 E/Dynamiclayout(30213): java.lang.IndexOutOfBoundsException: charAt: 0 >= length 0

04-09 01:47:02.664 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:47:02.664 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:47:22.089 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:47:22.089 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:47:23.169 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length

04-09 01:47:23.169 E/SpannableStringBuilder(30213): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:30:40.240

您必须找到长度为零的字符串。那是发生错误时生成的完整日志吗？读取文件时会发生 IO 异常，但是在发布的代码中没有文件操作。您的这部分代码似乎也没有错误。

# javascript - 在Javascript中将对象传递给回调

> ID：15935178
> 
> 赞同：0
> 
> 时间：2013-04-10T19:54:01.207
> 
> 标签：javascript, jquery, asynchronous, callback, jquery-callback

我正在尝试编写一个带有回调的函数——我想创建一个对象，然后在回调中访问该数据。

到目前为止，这是我的功能：

```
var getModelInfo = function(model, callback) {
      alert('called!')

      //This logs the correct model
      console.log(model);

      //The object I want to return
      return {
        "field1" : model.get("1"),
        "field2" : model.get("2"),
        "field3" : model.get("3"),
        "field4" : model.get("4")

      };

    }

    //Declared outside because I want to avoid 'this' issues
    var model_send = this.model;

    $(function() {
      alert('callback to be called')
      getModelInfo(model_send, function(data) {
        alert('call back called');

        // I want this to be the returned object
        console.log(data)

      });

    }); 
```

截至目前，“callback to be called”在“callback”之前发出警报，但“callback call”从不发出警报。如何在回调中访问返回的数据？

如果我做错了什么，请随时告诉我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T19:56:03.823

您可以`callback`使用新数据调用而不是返回它：

```
var getModelInfo = function(model, callback) {
  alert('called!')

  //This logs the correct model
  console.log(model);
  callback({
    "field1" : model.get("1"),
    "field2" : model.get("2"),
    "field3" : model.get("3"),
    "field4" : model.get("4")
  });
} 
```

# apex-code - 如何使用 java 配置 Apex 数据库

> ID：15935181
> 
> 赞同：1
> 
> 时间：2013-04-10T19:54:12.577
> 
> 标签：apex-code

我想通过 JDBC 将值插入 APEX 数据库。请您帮帮我。

# java - 当您不知道它们被称为什么时，在 Struts Action 中获取请求参数

> ID：15935182
> 
> 赞同：1
> 
> 时间：2013-04-10T19:54:16.870
> 
> 标签：java, servlets, struts2

我有一个 struts`ActionSupport`类，它使用 a`Map<String, String>`创建`<input>`元素，`jsp`其中输入的名称是地图的键。该地图包含我正在操作的域对象的参数（不是字段）。我知道，如果您有一个名为的请求参数，例如。`username`，你可以在类中有一个字段

```
private String username; 
```

使用 getter 和 setter，它将为您填充。但是，我不知道请求参数的名称。有没有办法将所有剩余的（未映射到字段的）请求参数作为映射（或其他结构）注入？

我能想到的另一个解决方案是使用

```
ServletActionContext.getRequest(); 
```

获取请求参数，自己比较。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T19:55:54.273

您可以实现[`ParameterAware`](http://struts.apache.org/release/2.3.x/struts2-core/apidocs/org/apache/struts2/interceptor/ParameterAware.html)接口并将参数作为`Map<String, String[]>`. 但是，它将为您提供所有请求参数，而不仅仅是那些可以直接在操作中填充的参数。

# javascript - 如何使用 Jquery 在 HTML 表格的单击表格行中选择一个元素？

> ID：15935190
> 
> 赞同：0
> 
> 时间：2013-04-10T19:54:31.617
> 
> 标签：javascript, jquery, html, input, html-table

我有一个有 2 列的表，我正在使用 PHP 为表动态生成行。每个表格行都有以下字段：

*   输入类型="复选框"
*   div 内的两个输入 type="text"

我喜欢做的是在选中复选框时隐藏包含两个输入类型文本的 div，我尝试使用 Jquery 获取单击复选框的父级，然后将相应的 div 隐藏在当前`<tr>`但它不起作用。

这是查看我的表格是如何生成的 HTML 代码：

```
<table>

<tr>
    <th>Hide?</th>
    <th>Inputs</th>
</tr>

<tr>
    <td>
        <input type="checkbox" name="checkBoxes[]">
    </td>
    <td>
        <div class="two-inputs">
            <input type="text" name="inputs[]">
            <input type="text" name="inputs[]">
        </div>
    </td>

</tr>

<tr>
    <td>
        <input type="checkbox" name="checkBoxes[]">
    </td>
    <td>
        <div class="two-inputs">
            <input type="text" name="inputs[]">
            <input type="text" name="inputs[]">
        </div>
    </td>

</tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:00:22.387

试试这个。[jsfiddle](http://jsfiddle.net/M72Uw/)

```
$("input:checkbox").click(function(){
   if(this.checked){
      $(this).parent().next().find("div").hide();
   }  
    else{
             $(this).parent().next().find("div").show();
    }

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:01:28.263

```
$('input:checkbox').click(function() {
    if (!$(this).is(':checked')) {
        $(this).parent().next('.two-inputs').hide();
    }
}); 
```

# c# - C# - 击败键盘记录器的透明窗口

> ID：15935195
> 
> 赞同：6
> 
> 时间：2013-04-10T19:54:41.140
> 
> 标签：c#, window, transparent, keylogger

如何创建一个对用户来说完全可见但在屏幕截图中不可见的窗口。我知道这是可能的，因为我安装的键盘记录软件截取的屏幕截图中没有出现 Neo SafeKeys（用于击败键盘记录程序的屏幕键盘）。

为了让您了解，该窗口对用户是完全可见的，但是当截取屏幕截图时，Neo SafeKeys 窗口根本不会出现（就好像它甚至不存在一样）。

Neo SafeKeys 表示它在窗口上方使用了一个不可见的保护层来防止屏幕截图。我已经在整个互联网上搜索，看看我怎样才能重现这个，但无济于事。有谁知道如何执行此操作（用户可见但在屏幕截图中不可见的窗口）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T20:00:02.760

您可以做的是阻止 PrtScn 键在按下时执行任何操作。看看[这篇文章](http://blog.rossbrigoli.com/2009/01/how-to-disable-printscreen-on-c.html)，同时向您展示如何做到这一点。

本文所做的是清除剪贴板。您可以做的是捕获屏幕图像并以数字方式删除您的应用程序，然后将修改后的图像放在剪贴板上，从而产生使窗口透明的“效果”。

此外，您可能想查看[这个 SO question](https://stackoverflow.com/questions/448106/how-do-i-prevent-print-screen)，它提供了一种使您的窗口仅显示为“蓝色”的替代方法，尽管它不容易做到。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-10T20:23:15.870

> 有谁知道如何执行此操作（用户可见但在屏幕截图中不可见的窗口）？

使用 DirectX 直接渲染到设备。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T20:21:35.817

在您的 C# 应用程序中，您可以设置一个全局挂钩来监视键盘事件。然后您的应用程序将成为打印屏幕的全局处理程序。现在，如果另一个应用程序管理的屏幕在本机打印，则无法阻止，但任何通过 Windows 运行的东西，您都可以处理。

WM_KEYBOARD_LL 挂钩是可用于托管代码的少数全局挂钩之一，因为它不需要将 DLL 注入每个目标。

对于一些代码，您可以访问这里：

[亚当的博客](http://www.seesharpdot.net/?p=96)

请记住，这些是全局挂钩，因此您要确保没有其他（其他应用程序）受到影响。我过去曾使用过这些，因为我们在我们处理的应用程序中托管显示一个电源点。基本上，我们不希望用户调用任何 powerpoint 菜单或键盘快捷键，因此我们使用了全局挂钩。我们总是检查用户是否在某个区域（屏幕）和我们的应用程序中，否则我们会影响其他应用程序的功能（包括我们自己的！）

微软信息：

[钩子概述](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644959%28v=vs.85%29.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-10T20:29:47.870

有这个..... [视觉密码学](http://delphitools.info/2012/08/01/defeat-print-screen-with-visual-cryptography/)

活的例子[在这里](http://delphitools.info/OP4JS/VisualCryptography/index.html)

但这可以通过拍摄多个屏幕截图并将它们放在彼此之上等等来轻松编码......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-25T04:37:48.820

如果您使用的是 Windows，并且可以避免发生屏幕记录，您可以实施一个不错的解决方案，例如虚拟桌面，将您的进程嵌入其中。当进程在虚拟桌面中运行时，可以绕过运行在 win32 Api 上的屏幕记录工具。

看看这篇文章，你可以偷偷看看如何实现一个很好的解决方案来逃避屏幕和键盘监控。

[http://www.codeproject.com/Articles/7392/Lock-Windows-Desktop?fid=62485&select=3139662&fr=101#xx0xx](http://www.codeproject.com/Articles/7392/Lock-Windows-Desktop?fid=62485&select=3139662&fr=101#xx0xx)

# html - 空白页中间的图像

> ID：15935196
> 
> 赞同：1
> 
> 时间：2013-04-10T19:54:42.070
> 
> 标签：html

我正在创建一个空白页面，页面中间有一个图像。我在 html 中对齐图像，但它不起作用。我只能左右对齐，如果我设置 aling="middle" 它不会做任何事情......

所以……我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T19:58:09.093

来自：[http ://css-tricks.com/snippets/css/absolute-center-vertical-horizo​​ntal-an-image/](http://css-tricks.com/snippets/css/absolute-center-vertical-horizontal-an-image/)

```
<head>
    <style>
       img {
           position: absolute;
           top: 50%;
           left: 50%;
           width: 500px;
           height: 500px;
           margin-top: -250px; /* Half the height */
           margin-left: -250px; /* Half the width */
       }
    </style>
</head> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:22:26.857

我也会推荐 Whistletoe 建议的方法

[http://css-tricks.com/snippets/css/absolute-center-vertical-horizo​​ntal-an-image/](http://css-tricks.com/snippets/css/absolute-center-vertical-horizontal-an-image/)

**HTML**

```
<html>
    <body>
        <img src="http://fc03.deviantart.net/fs70/f/2012/149/2/9/fluffy_confused_kitten_gif_3_by_wonderfuday-d51jxyi.gif" alt="" />
    </body>
</html> 
```

**CSS**

```
img {
   position: absolute;
   top: 50%;
   left: 50%;
   width: 400px;
   height: 300px;
   margin-top: -150px;
   margin-left: -200px;
} 
```

[http://jsfiddle.net/NgpTw/](http://jsfiddle.net/NgpTw/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:07:52.740

[http://www.w3schools.com/tags/att_img_align.asp](http://www.w3schools.com/tags/att_img_align.asp)

> align 属性指定图像根据周围元素的对齐方式。
> 
> 该元素是一个内联元素（它不会在页面上插入新行），这意味着文本和其他元素可以环绕它。因此，根据周围元素指定图像的对齐方式可能很有用。

所以所有的工作都应该工作。如果要将图像放置在页面中心，则必须将“img”标签与任何文本标签（如“p”或“div”）包裹起来，并将“align”属性设置为该标签，而不是“img”标签。

# django - Django用户注册验证不起作用

> ID：15935203
> 
> 赞同：2
> 
> 时间：2013-04-10T19:55:01.173
> 
> 标签：django, django-models, django-views, django-users

您好，如果用户存在并且密码与密码确认字段匹配，我想对用户注册进行验证。不幸的是，验证不起作用。例如，如果 2 个密码不匹配，则无论如何都会使用第一个密码完成注册。如果出现问题，我想重新加载突出显示问题的注册表单。

表格：

```
class RegistrationForm(forms.Form):
    username = forms.CharField(label=u'Username', max_length=30)
    first_name = forms.CharField(label=u'First Name', max_length=30)
    last_name = forms.CharField(label=u'Last Name', max_length=30)
    email = forms.EmailField(label=u'Email')
    password1 = forms.CharField(
                                label=u'Password',
                                widget=forms.PasswordInput()
                                )
    password2 = forms.CharField(
                                label=u'Password (Again)',
                                widget=forms.PasswordInput()
                                )

def clean_password2(self):
    if 'password1' in self.cleaned_data:
        password1 = self.cleaned_data['password1']
        password2 = self.cleaned_data['password2']
        if password1 == password2:
            return password2

    raise forms.ValidationError('Passwords do not match.')
def clean_username(self):
    username = self.cleaned_data['username']
    if not re.search(r'^\w+$', username):
        raise forms.ValidationError('Username can only contain '
                                    'alphanumeric characters and the underscore.')
    try:
           User.objects.get(username=username)
    except User.DoesNotExist:
            return username
    raise forms.ValidationError('Username is already taken.') 
```

风景：

```
def register_page(request):
    if request.method == 'POST':
        form = RegistrationForm(request.POST)
        if form.is_valid():
            user = User.objects.create_user(
                                            username=form.cleaned_data['username'],
                                            password=form.cleaned_data['password1'],
                                            email=form.cleaned_data['email']
                                            )
            UserProfile.first_name=form.cleaned_data['first_name']
            created = UserProfile.objects.get_or_create(
                                                        user_id=user.id, first_name=form.cleaned_data['first_name'], last_name=form.cleaned_data['last_name']    )
            return HttpResponseRedirect('/register/success/')
    else:
        form = RegistrationForm()
    variables = RequestContext(request, {
                               'form': form
                               })
    return render_to_response(
                              'registration/register.html', variables) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T03:39:14.337

```
class RegistrationForm(forms.Form):
    //fields

def clean(self):
    cleaned_data = super(RegistrationForm, self).clean()
    username = cleaned_data.get("username")
    password1 = cleaned_data.get("password1")
    password1 = cleaned_data.get("password1")

    #validate username 
    user = User.objects.filter(username=username)
    if user:
        raise forms.ValidationError(
            "That user is already taken , please select another ")
    elif not re.search(r'^\w+$', username):
        raise forms.ValidationError(
            "Username can only contain"
            "alphanumeric characters and the underscore.")

    #validate password
    if password1 != password1:
        raise forms.ValidationError(
            "Your current and confirm password do not match.")

    return cleaned_data 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-08T05:39:17.390

我使用这个有效的简单验证。

```
def validate(self, value):
    data = self.get_initial()
    username = data.get("username")
    email = data.get("email")
    password = data.get("password")
    confirm_password = data.get("confirm_password")
    max_similarity = 0.7
    user_qs = User.objects.filter(email=username)
    if user_qs.exists():
        raise ValidationError("Username already exist")
        if(password != confirm_password):
            raise ValidationError("Password and Confirm password does not match")
    if SequenceMatcher(a=password.lower(), b=username.lower()).quick_ratio() > max_similarity:
        raise serializers.ValidationError("The password is too similar to the username.")
    if SequenceMatcher(a=password.lower(), b=email.lower()).quick_ratio() > max_similarity:
        raise serializers.ValidationError("The password is too similar to the email.")
    return data 
```

附加验证：您也可以通过添加这个来添加 django 的一些默认验证。这将检查密码的最小长度和最大字符串和最大整数。

```
def validate_password(self, value):
    try:
        validate_password(value)
    except ValidationError as exc:
        raise serializers.ValidationError(str(exc))
    return value 
```

# php - 访问类方法而不将类调用到变量php中

> ID：15935206
> 
> 赞同：0
> 
> 时间：2013-04-10T19:55:04.807
> 
> 标签：php, namespaces

是否可以使用类方法而不实际将类调用到变量中。我确定我在某个地方看到过这个，但我不确定我是否在做梦。

举个例子：

```
<?php
namespace proj;
class beer{
  public function whichIsBest(){
     return 'Not cheap stuff';
  }
} 
```

包含文件启动类，但是我如何才能在不首先将类调用到变量中的情况下使用 whishIsBest 方法。

```
<?php
include 'beerClass.php';
new \proj\beer();
echo \proj\beer()->whichIsBest 
```

或者这是不可能的，我实际上是在做梦？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T19:57:39.920

[http://www.php.net/manual/en/language.oop5.static.php](http://www.php.net/manual/en/language.oop5.static.php)

```
class beer {
public static function whichIsBest() {
 do //
}
}
..

echo beer::whichIsBest(); 
```

# c++ - 将头文件添加到 C++ 的 Eclipse 构建路径

> ID：15935207
> 
> 赞同：9
> 
> 时间：2013-04-10T19:55:06.403
> 
> 标签：c++, eclipse, include, eclipse-cdt

我正在尝试使用这个： http: [//www.minixml.org/index.php](http://www.minixml.org/index.php)

我想让这些包含在 Eclipse for Windows 上工作。

有谁能够帮我？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-10T22:06:47.637

左键单击您的项目并选择`Properties`，然后转到以下部分：`C/C++ General`，然后`Paths and Symbols`，然后选择`Includes`选项卡，在`Languages`列表中选择`GNU C++`（或您当前的工具链）。现在您可以看到`Add...`最右边的按钮，单击它并提供包含包含的目录的路径，例如：`D:\Libraries\MiniXML\include`. 不要忘记选中`Add to all configurations`复选框。就是这样，我们完成了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-17T10:09:32.820

正如@Alexander-Shukaev[指出的那样](https://stackoverflow.com/a/15937340/1820106)，添加包含**路径**（-I）是使用`Properties`→ `C/C++ General`→ `Paths and Symbols`→完成的`Includes`。

OTH，添加包含**文件**（-include，AKA'强制包含'）是使用`Properties`→ `C/C++ General`→ `Paths and Symbols`→完成的`Includes Files`。

注意 #1：从 Eclipse Oxygen 开始，还有另一种方法可以做到这一点 - `Properties`→ `C/C++ General`→ `Preprocessor Include Paths, Macros etc.`→ `CDT User Settings Entries`→ `Add`→ `Include File`（使用下拉框）。也不清楚人们想要的方式。

注意#2：变量的使用有助于设置配置特定的设置。例如 -`${ProjDirPath}/${ConfigName}/config.h`

# bash - bash脚本将文件复制到多个指定目录

> ID：15935211
> 
> 赞同：0
> 
> 时间：2013-04-10T19:55:19.453
> 
> 标签：bash, shell, scripting

我正在寻找创建一个脚本，该脚本需要一个文件并将文件复制到多个目录

例如`cp2dir filename dir1/ dir2/ dir3/`

我已经四处挖掘，看起来我的路线是要使用的`cat <inputfile> | tee <outputfile> <outputfile> <outputfile>`，但是，我发现以前的脚本似乎正在使用静态文件/目录。

如何使用用户输入来执行此操作？

我在想：

```
for i in $dir; do
    cat $file | tee $i 
```

其中 $dir 和 $file 是用户输入。我需要`cut -d\`$dir吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T19:58:11.287

```
cp2dir() {
    local file="$1"
    shift
    local -a dirs=( "$@" )

    for dir in "${dirs[@]}"; do
        cp "$file" "$dir"
    done
} 
```

当然，这不会进行任何安全检查，例如确保目标实际上是目录。我把它留给你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-10T19:58:22.603

```
cp2dir() {
    local file="$1" dir
    shift

    for dir in "$@"; do
        cp "$file" "$dir"
    done
} 
```

# jquery - X-editable with Bootstrap：提交的新值保存到 mysql 数据库，但出现错误

> ID：15935217
> 
> 赞同：0
> 
> 时间：2013-04-10T19:55:30.833
> 
> 标签：jquery, json, http-headers

尽管提交的值很好地保存在数据库中，但可编辑表单保持打开状态，其边框变为红色（因为出现问题）并且在下方我看到“OK”消息。

这是处理我的专栏之一的脚本代码部分：

```
 j('.status').editable({
    url: '/process',
    title: 'Promijeni status',
    ajaxOptions: {
        dataType: 'json'
    }
}); 
```

我在 Codeigniter 中编码，所以控制器调用模型。在我的模型中，只有一个简单的更新语句，没有“返回”。此外，在控制器中没有任何东西专门设置响应状态代码。但我怀疑“OK”来自状态码“200 OK”。

如果是这样，为什么一切都表现得像发生了错误？需要关闭表单并加载新值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:27:34.780

感谢这个问题：[当http状态码为“200 OK”时，为什么$.ajax调用json数据会触发错误回调？](https://stackoverflow.com/questions/1846086/why-does-ajax-call-for-json-data-trigger-the-error-callback-when-http-status-c?rq=1)我了解到我的问题的可能原因是从控制器返回的 JSON 数据格式错误（或类似），因此尽管响应状态代码为“200 OK”，但仍触发了错误。

所以在我的控制器中，我设置了一个虚拟数组： echo json.encode($myArr) 现在表单在提交时隐藏并且正在加载新值。

# java - 将 OutputStream 写入文件的代码

> ID：15935219
> 
> 赞同：-2
> 
> 时间：2013-04-10T19:55:36.083
> 
> 标签：java, file-io, io

我需要使用 Java 将一些输出写入文件。目前我的代码正在系统控制台上编写 OutputStream。我担心的是我必须编写`process.getOutputStream()`返回一个 OutputStream 实例的输出。

```
final PrintWriter writer = new PrintWriter(process.getOutputStream());
writer.println(200);
writer.close(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-10T19:57:38.287

尝试这个：

```
PrintWriter writer = new PrintWriter(new File("path/to/output-file.txt")); 
```

只需将输出切换`PrintWriter`到您希望使用的目标，在这种情况下是一个文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T23:36:29.367

你的问题没有意义。A`ProcessOutputStream`不是文件。它是由进程读取的流。该流程对您发送的数据的处理是它的业务，而不是您的业务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T20:02:42.170

```
 BufferedWriter write = new BufferedWriter( new FileWriter( "output.txt"));
   write.write("your data"); 
```

# angularjs - AngularJS: Access formController of a form placed inside transcluded directive from parent controller

> ID：15935224
> 
> 赞同：20
> 
> 时间：2013-04-10T19:55:53.920
> 
> 标签：angularjs, angularjs-directive, angularjs-scope

I've created a simple "modal dialog" directive, which uses transclude. I would like to place a form () inside the "modal dialog" directive. I would expect that formController of a form placed inside the directive, is going to be accessible in parent controller's scope, however it isn't. Take a look at the following fiddle, please: [http://jsfiddle.net/milmly/f2WMT/1/](http://jsfiddle.net/milmly/f2WMT/1/)

Complete code:

```
<!DOCTYPE html>
<html>
    <head>
        <title>AngJS test</title>
        <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/foundation/4.0.9/css/foundation.min.css">
        <style>
            .reveal-modal {
                display: block;
                visibility: visible;
            }
        </style>
        <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.1.4/angular.min.js"></script>
        <script type="text/javascript">
            var app = angular.module('app', []);
            app.controller('appCtrl', function ($scope) {
                $scope.model = {
                    id: 1, name: 'John'
                };
                $scope.modal = {
                    show: false
                };
           });
           app.directive('modal', function () {
               return {
                   scope: {
                       show: '='
                   },
                   transclude: true,
                   replace: true,
                   template: '<div class="reveal-modal small" ng-show="show"><div class="panel" ng-transclude></div></div>'
               }
           });
       </script>
    </head>
    <body ng-app="app">
        <div ng-controller="appCtrl">
            <div class="panel">
                Id: {{ model.id }}<br>
                Name: {{ model.name }}<br>
                Controller formController: {{ form }}<br>
                Directive formController: {{ myForm }}<br>
            </div>

            <form name="form" class="panel">
                <input type="text" ng-model="model.name">
            </form>

            <a ng-click="modal.show=!modal.show">toggle dialog</a>

            <div modal show="modal.show">
                <form name="myForm">
                    <input type="text" ng-model="model.name">
                </form>
            </div>

        </div>
    </body>
</html> 
```

So my question is how to access or is it possible to access directive's formController from parent controller?

Thank you for answers.

-Milan

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-11T01:20:18.727

Because you are using transclude, the directive will create a child transcluded scope. There is no easy path from the controller scope (003) to the directive's transcluded scope (005):

![enter image description here](https://i.stack.imgur.com/1rtdB.png)

(The hard/not recommended path is to go via private property `$$childHead` on the controller scope, find the isolate scope, then use `$$nextSibling` to get to the transcluded scope.)

* * *

**Update:** From insights from [this answer](https://stackoverflow.com/a/15302354/215945), I think we can get the formController inside the directive, then use `=` to get it to the parent.

```
scope: { show: '=', formCtrl: '=' },
...
link: function(scope, element) {
   var input1 = element.find('input').eq(0);
   scope.formCtrl = input1.controller('form');
} 
```

HTML:

```
<div modal show="modal.show" form-ctrl="formCtrl"> 
```

[Fiddle](http://jsfiddle.net/mrajcok/AbmEy/)

![enter image description here](https://i.stack.imgur.com/mWey0.png)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-09-01T15:05:59.913

Here is my solution: I create such method in parent controller :

```
$scope.saveForm = function(form) {
  $scope.myForm = form;
}; 
```

Then I call it in transcluded content:

```
<my-directive>
  <form name="myForm">
     <div ng-init="saveForm(myForm)"></div>
  </form>
</my-directive> 
```

After creating directive instance i have form controller instance in parent scope.

# .net - 如果一个exe是指一个dll，那么如何添加dll？应该注册还是应该添加到 bin 文件夹中？

> ID：15935226
> 
> 赞同：0
> 
> 时间：2013-04-10T19:55:58.643
> 
> 标签：.net, exe, registration

我有一个 .net exe，它指的是另一个 .net 程序集。我的问题是在部署期间，我们应该使用 REGASM 注册程序集，还是应该将 dll 复制到 exe 代码的 Bin 文件夹中？我是这方面的初学者，所以如果我混淆了术语，请原谅。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:00:28.003

你不会使用 REGASM。那是为了注册 COM DLL。

包含引用的最简单方法是将其包含在文件夹中。

如果您要在多个项目之间共享该引用的 DLL，您拥有的另一个选择是在全局程序集缓存 (GAC) 中注册它。

# linux - 创建具有重叠直方图的图形并将其保存到单个文件中

> ID：15935236
> 
> 赞同：1
> 
> 时间：2013-04-10T19:56:19.460
> 
> 标签：linux, matlab, histogram, saving-data

我正在尝试编写一个 Matlab 脚本来分析两组特定的数据，为它们创建直方图，并将它们写入一个文件，您可以在其中看到两个直方图在一个图上重叠。

我创建了一个功能脚本，它为一组数据创建了直方图，基本上是这样的：

```
h1=figure;
hist(data,nbins:;

print(h1,'-dpng','hist.png) 
```

然后我尝试简单地添加第二行：

```
h2=figure; 
```

并将打印功能更改为包含 h2。那显然行不通。我发现我不能同时拥有带有打印功能的 h1 和 h2。

在搜索互联网并寻找解决此问题的方法后，我决定尝试使用 saveas。我得到以下内容：

```
h=findobj(gca,'Type','patch');
hist(data1,nbins);
hold on;
hist(data2,nbins);

set(h(1),'FaceColor','r','EdgeColor','k');
set(h(2),'FaceColor','b','EdgeColor','k');

saveas(h,'-dpng','hist.png') 
```

但这也行不通。我在 Mathworks 网站上没有找到任何可以帮助我解决这个问题的东西，我也没有在任何其他网站上找到任何东西。我正在使用通过 SSH 连接到不同服务器的 Linux 计算机，所以我可以查看我制作的绘图的唯一方法是将它们保存到一个文件然后打开它们。如果您对完成我在第一段中概述的任务有任何建议，请告诉我。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:06:04.480

一种方法是对不同的直方图使用不同的轴。您可以为此使用 SUBPLOT：

```
subplot(2,1,1)
hist(data1,nbins);
subplot(2,1,2)
hist(data2,nbins); 
```

另一种方法是找到一个公共 bin ( `x`) 并将`hist`输出返回到向量。然后使用 BAR 函数进行绘图。

```
nbins = 20;
x = linspace(min([data1(:);data2(:)]),max([data1(:);data2(:)]),nbins);
h1 = hist(data1, x);
h2 = hist(data2, x);
hb = bar(x,[h1(:),h2(:)],'hist');

% change colors and set x limits
set(hb(1),'FaceColor','r','EdgeColor','k');
set(hb(2),'FaceColor','b','EdgeColor','k');
gap = x(2)-x(1);
xlim([x(1)-gap x(end)+gap]) 
```

# sql - Oracle SQL 查询多个表的平均值

> ID：15935239
> 
> 赞同：-1
> 
> 时间：2013-04-10T19:56:31.733
> 
> 标签：sql, oracle, average

以下是关系：

```
CREATE TABLE employee (
  name    varchar2(15) not null, 
  ssn      char(9),
  sex      char,
  salary   number(10,2),
  dno      number(4),
  primary key (ssn),
  foreign key (dno) references department(dnumber)
);

CREATE TABLE department (
  dname        varchar2(15) not null,
  dnumber      number(4),
  primary key (dnumber),
  unique (dname),
); 
```

Q1：对于每个员工平均工资超过 30,000 美元的部门，检索部门名称和为该部门工作的员工人数。

Q2：假设我们想要每个部门的男性员工数量而不是所有员工（如 Q1）来计算部门平均值和员工数量。我们可以在 SQL 中指定这个查询吗？为什么或者为什么不。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:31:38.453

您的第一个查询可能看起来像

```
SELECT d.dname,
       COUNT(*) total_employees
  FROM department d LEFT JOIN
       employee e ON d.dnumber = e.dno
 GROUP BY d.dname
HAVING AVG(e.salary) > 30000; 
```

而第二个

```
SELECT d.dname,
       COUNT(*) male_employees
  FROM department d LEFT JOIN
       employee e ON d.dnumber = e.dno
 WHERE e.sex = 'M'
 GROUP BY d.dname
HAVING AVG(e.salary) > 30000; 
```

**[SQLFiddle](http://sqlfiddle.com/#!4/cda74/6)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T01:37:54.377

如果你想在一个 SQL 中获取所有员工的数量和男性员工的数量，你可以试试这个。

```
SELECT B.DNAME,
COUNT(*) AS TOTAL_EMPLOYEES,
COUNT(CASE WHEN A.SEX='M' THEN A.SEX END) AS MALE_EMPLOYEES,
AVG(A.SAL) AS ALL_AVG,
AVG(CASE WHEN A.SEX='M' THEN A.SAL END) AS MALE_AVG
FROM EMPLOYEE A JOIN DEPARTMENT B
ON A.DNO=B.DNUMBER
GROUP BY B.DNAME 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-09T21:06:32.707

```
SELECT dname, COUNT(*) AS Num_of_Employees    
FROM   employee, department    
WHERE  dno = dnumber AND EXISTS (
       SELECT AVG(Salary)    
       FROM   employee    
       GROUP BY dno    
       HAVING AVG(Salary)>30000)    
GROUP BY dname; 
```

# css - 字体显示不均匀

> ID：15935254
> 
> 赞同：2
> 
> 时间：2013-04-10T19:57:45.473
> 
> 标签：css, fonts, styles, typeface

我网站上的一些元素显示完美，而相同字体的其他元素看起来颗粒状和波涛汹涌。我不知道为什么，因为我以相同的方式指定样式。

这是我的网站：

[http://violetoeuvre.com/](http://violetoeuvre.com/)

侧边栏导航（我、关于、写联系人）完全没问题，而段落、h2 和页脚样式是颗粒状的，看起来像同类型脸的粗略版本。

CSS：

```
 /* Fonts */
    @import url(http://fonts.googleapis.com/css?family=Playfair+Display:400,700,900,400italic,700italic,900italic); 
```

时髦的款式：

```
h2 {
        font-family: 'Playfair Display', sans-serif, 20px;
        font-weight: 100;
        line-height: 2em;
        color: #000000;
        letter-spacing: -1px;
        margin: 0; 
}

h3 {
        font-family: 'Playfair Display', sans-serif, 12px;
        font-weight: 100;
        line-height: 2em;
        color: #000000;
        letter-spacing: -1px;
        margin: 0; 

}

#foot a:link {
        font-family: 'Playfair Display', sans-serif;
        font-size: 15px;
        font-weight: 100;
        color:#000; 
        text-decoration: none; 
        letter-spacing:0.2em;
} 
```

这些功能正常：

```
#emma_home a:link{
        font-family: 'Playfair Display', serif;
        font-size: 75px;
        font-weight: 200; 
        color:rgba(255,255,255,1);
        text-decoration: none;
        letter-spacing:-4px;
    }
#nav_menu a:link{
        font-family: 'Playfair Display', serif;
        font-size: 30px;
        font-weight: 100; 
        color:rgba (255,255,255,1);
        text-decoration: none; 
        text-align: center;
        letter-spacing:0.2em;
}

#side_wrapper_text a:link{
        font-family: 'Playfair Display', sans-serif;
        font-size: 32px;
        font-style: italic;
        font-weight: 100; 
        color:#000000;;
        text-decoration: none; 
        text-align: right;
        letter-spacing:0.2em;

} 
```

此外，在 PC 上，顶部的 Emma 和导航（写作、博客、联系人）在黑线上方约 20 像素处，但在我的 Mac 上，字母像我想要的那样接触白色。

是什么导致了这些差异？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:10:37.417

我认为您应该从 font-family 标记中移动 font-size 属性并添加它

```
font-family: sans-serif;
font-size : 12px; 
```

检查这个[W3 学校](http://www.w3schools.com/cssref/pr_font_font-family.asp)，他们定义了 2 个属性

浏览器对 css 的行为有所不同，有些会适应错误，有些则不会

**编辑** 您可以通过放置大部分具有相同样式的选择器来避免重复代码，然后您可以覆盖该样式。例如

```
h2,h3 {
    font-family: 'Playfair Display', sans-serif;
    font-size : 20px;
    font-weight: 100;
    line-height: 2em;
    color: #000000;
    letter-spacing: -1px;
    margin: 0; 
}
h3 {
    font-size: 12px;
} 
```

我看到您的`a`链接的字体粗细属性是您为其他链接定义的两倍，因此标签可能就是这种情况，但我没有看到任何其他显着差异

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T16:14:35.110

我很困惑为什么 Playfair Display 在我的标题和段落中出现颗粒状，但在我的侧边栏导航中却没有。

经过一番挫折，我意识到字体在某种（小）字体上看起来很糟糕。

搜索 Playfair：

[http://www.google.com/fonts/](http://www.google.com/fonts/)

如您所见，Normal 400 看起来很奇怪，但在更大、粗体或斜体样式中，它看起来还不错。唯一要做的就是为较小的样式选择类似的字体，所以我使用的是 Jacques Francois。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-13T21:38:32.460

我是一名设计师，主要在网络上工作，但偶尔也会打印。我认为您的问题实际上可能与 Playfair 字体本身有关，我刚刚发现它在 PC 上显示时缺少某些字体样式（Mac 看起来不错）。在浪费更多时间之前，我会使用另一种字体进行测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-13T03:31:36.600

据我所见，IE 比 woff 更喜欢 ttf 格式，并且特定的导出是错误的。我只是用字体松鼠下载了谷歌字体 mercurial repo 任何转换后的原始（otf）文件，现在它可以工作了。

# c# - 如何将 CommandText 设置为我的搜索按钮？

> ID：15935255
> 
> 赞同：1
> 
> 时间：2013-04-10T19:57:47.340
> 
> 标签：c#, sql

我正在尝试创建一个搜索按钮，当我在文本框中输入 ID 并按下它时，它会转到我的私有 SQL 服务器数据库并获取引用该 ID 的数据行，但是由于我的异常处理程序给我带来了错误错误的 CommandText .. 这是我的代码

```
private void SearchBtn_Click(object sender, EventArgs e)
{
   cn.ConnectionString = Properties.Settings.Default.ConStr;
   if (ID.Text == "")
   {
      MessageBox.Show("Please Enter The ID you would like to search");
   }
   else
   {
      SqlCommand com = new SqlCommand();
      cn.Open();
      SqlParameter user = new SqlParameter("@ID", SqlDbType.Int);
      SqlParameter FN = new SqlParameter("@First_Name",SqlDbType.NChar);
      SqlParameter LN = new SqlParameter("@Last_Name", SqlDbType.VarChar);
      SqlParameter Jb = new SqlParameter("@Job", SqlDbType.VarChar);
      SqlParameter Ag = new SqlParameter("@Age", SqlDbType.VarChar);
      SqlParameter ph = new SqlParameter("@Phone", SqlDbType.VarChar);
      com.Parameters.Add(user);
      com.Parameters.Add(FN);
      com.Parameters.Add(LN);
      com.Parameters.Add(Jb);
      com.Parameters.Add(Ag);
      com.Parameters.Add(ph);

      com.Connection = cn; 
```

这是我的错误： ***com.CommandText =“搜索（名字，姓氏，工作，年龄，电话）值（'”+ FN +“'，'”+ LN +“'，'”+ Jb +“'，'” + Ag + "','" + ph + "' 来自 MyList) ";***

```
 user.Direction = ParameterDirection.Input;
      FN.Direction = ParameterDirection.Output;
      LN.Direction = ParameterDirection.Output;
      Jb.Direction = ParameterDirection.Output;
      Ag.Direction = ParameterDirection.Output;
      ph.Direction = ParameterDirection.Output;

      FN.Size = 10;
      LN.Size = 10;
      Jb.Size = 10;
      Ag.Size = 10;
      ph.Size = 10;

      user.Value = Convert.ToInt32(ID.Text);

      try
      {
         com.ExecuteNonQuery();

         FirstName.Text = FN.Value.ToString();
         LastName.Text = LN.Value.ToString();
         Job.Text = Jb.Value.ToString();
         Age.Text = Ag.Value.ToString();
         Phone.Text = ph.Value.ToString();
      }
      catch (Exception ex)
      {
         MessageBox.Show(ex.Message);
      }
      finally
      {
         cn.Close();
      } 
```

我正在使用 Visual Studio 2012 。提前致谢 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:00:44.597

```
"Search (First_Name,Last_Name,Job,Age,Phone) values('" + FN + "','" + LN + "','" + Jb+ "','" + Ag + "','" + ph + "' from MyList)" 
```

看起来并不像 SQL。另外，我不太确定您为什么要设置大量未使用的参数。

也许你的意思是

```
com.CommandText = "SELECT First_Name, Last_Name, Job, Age, Phone FROM MyList WHERE ID=@Id";
com.Parameters.AddWithValue("@Id", ID.Text); 
```

此外，如果这是您的意图，那`ExecuteNonQuery`是错误的，因为那是 for `INSERT`，`UPDATE`以及其他不返回结果的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:05:09.617

命令文本应该像

```
com.CommandText = "SELECT First_Name, Last_Name, Job, Age, Phone FROM MyList WHERE ...."; 
```

删除大部分参数，只留下输入参数。

而不是`com.ExecuteNonQuery()`使用：`SqlDataReader reader = command.ExecuteReader();`并使用它读取您的数据。示例文章在[这里](http://www.agilechai.com/content/archive/2007/06/09/how-to-use-sqldatareader-plus-source-code.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:05:27.780

首先：

```
"Search (First_Name,Last_Name,Job,Age,Phone) values('" + FN + "','" + LN + "','" + Jb+ "','" + Ag + "','" + ph + "' from MyList)" 
```

对我来说，这看起来不像是有效的 SQL。

我认为你正在寻找做这样的事情：

```
 using (SqlConnection myConnection = new SqlConnection(connString))
 {
    string oString = " SELECT  * from MyList WHERE (id = @id)";
    SqlCommand oCmd = new SqlCommand(oString, myConnection);
    oCmd.Parameters.Add(new SqlParameter("@id", ID.Text));

    myConnection.Open();
    string name="";
    string lastname ="";
    using (SqlDataReader oReader = oCmd.ExecuteReader())
    {
       while (oReader.Read())
       {
          name  = oReader["name"].ToString(); // replace "name" with the name of the column you want
          lastname = oReader["lastname"].ToString();
       }
    }
    myConnection.Close();
    return name + lastname; 
```

您可以使用这些值来设置表单文本框中的文本：

```
YourNameTextbox.Text = name; 
```

.. ETC

# python - Bash / Django ：在一个 shell 中运行多个监视命令，每个命令都有单独的环境变量

> ID：15935259
> 
> 赞同：-1
> 
> 时间：2013-04-10T19:57:58.073
> 
> 标签：python, django, bash, terminal

我有一个 Django 设置，我需要每两秒运行一个命令。该命令如下所示：

```
watch SITE=<site_name> ./manage.py collectstatic --noinput 
```

我将 设置`SITE`为 VM 环境变量，然后 Django 系统使用它来了解它需要针对哪个站点运行该命令以及其他内容。所有“站点”都从同一个代码库运行，并且在虚拟环境中运行。

问题是现在有 7 个“站点”，我需要每两秒运行一次这个命令，而且还有更多在管道中。这意味着我打开了七个终端选项卡，每个选项卡分别运行相同的 VM，并且每两秒运行一次该命令！

有没有一种方法可以让我拥有某种脚本，以便以相同的方式为每个站点运行这些命令，但在一个终端选项卡中？或者更好，只是在后台运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T09:08:44.360

不确定你想要什么。这是一个通用的 bash 脚本，每 2 秒在后台运行一些命令：

```
#!/bin/bash

command1 &
command2 &
command3 &

#wait
# decomment the line above if you want to wait until
# all the spawned process ends before going further

sleep 2
exec $0 
```

脚本本身可以在后台运行，方法是使用挂起的 & 号调用它：

```
./script.sh & 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T19:36:36.197

因为 watch 不能在后台运行，一个简单的脚本就可以完成你正在寻找的东西。使用 for 循环应该可以轻松增加站点的数量。如果您在脚本上运行 watch 那么您可以继续重复执行。

如果您可以将要求放宽到每分钟一次，那么其他要查看的内容将是[cron 。](https://stackoverflow.com/tags/cron/info)

```
#!/bin/bash
for SITE_NAME in <site1> <site2> <site3>
do
    SITE=$SITE_NAME ./manage.py collectstatic --noinput
done 
```

# javascript - 添加类以显示活动幻灯片

> ID：15935261
> 
> 赞同：0
> 
> 时间：2013-04-10T19:57:59.803
> 
> 标签：javascript, jquery

我正在尝试显示幻灯片的活动幻灯片。我已经对 div 进行了硬编码，因为我知道会有多少张幻灯片，所以看起来像这样

```
var activeSlide = $('<div class="slidePosHolder"><div class="slidePos"></div><div class="slidePos"></div><div class="slidePos"></div></div>'); 
```

现在我正在添加一个活动类，我试图将它索引到这个`.views-field-field-slide-description`..概念是当类发生变化时，它会在当前幻灯片上显示活动状态。我的 JQuery 的其余部分看起来像这样

```
$('.slidePos').removeClass('active');
        $('.slidePos').eq($(this).index('.views-field-field-slide-description')).addClass('active'); 
```

它将类添加到起始幻灯片中，但不会随着幻灯片的进行而将其删除。我假设我的索引错误。有任何想法吗？我正在使用 jquery 1.4.4

# ios - Phonegap 2.6 与 KeyboardShrinksView 和 HideKeyboardFormAccessoryBar

> ID：15935262
> 
> 赞同：3
> 
> 时间：2013-04-10T19:58:01.273
> 
> 标签：ios, cordova

我对 2.6 (ios) 中的一个新的 phonegap 功能有疑问，最后它们包括了一个缩小 web 视图以处理固定元素的选项。不幸的是，与设置为 true 的选项结合使用时`HideKeyboardFormAccessoryBar`，会出现一个奇怪的白条，而不是 AccessoryView（看一下[截图](http://i.stack.imgur.com/3fgV8.png)）。`KeyboardShrinksView`当我设置为 false时，这不会发生

有人在新版本中遇到过类似的问题吗？这是错误还是功能？;)

欢呼霍斯特。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-03T10:18:21.763

这是一个错误。这是由于在显示键盘后 WebView 没有正确调整大小造成的。默认情况下，PhoneGap 通过键盘高度减去视图框架来调整 WebView 的高度。但是，它没有考虑到表单附件栏隐藏在该计算中的事实。

这是PhoneGap修复此错误时的临时解决方案：

在 CDVViewController.m（在 Classes/Cleaver 下）中，转到第 140 行。它应该在（void）keyboardWilLShowOrHide 函数内。在 showEvent if 语句中，它根据键盘的高度计算 WebView 的新尺寸。

将 if 语句的内容更改为：

```
if (showEvent) {
    newFrame.size.height -= keyboardFrame.size.height;
    if ([@"true" isEqualToString: self.settings[@"HideKeyboardFormAccessoryBar"]]) {
        newFrame.size.height += 45;
    }
} 
```

我添加了一个额外的 if 语句，它还检查 HideKeyboardFormAccessoryBar 配置。如果设置了，它会将 WebView 的大小再增加 45 个像素（表单附件栏的高度）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-18T21:09:15.400

当键盘向上过渡时，似乎 webview 已经调整大小并且背景是白色的，从而导致显示白色背景。我的 HTML 正文背景是黑色的，所以当白色背景闪烁时它看起来很奇怪。有谁知道如何更新 UIView 的背景？

视频以慢动作再现问题。 [http://www.youtube.com/watch?v=iOjdxJuYp8c](http://www.youtube.com/watch?v=iOjdxJuYp8c)

谢谢！

汤姆

编辑：我可以通过将此代码添加到 MainViewConetroller.m 来更改背景颜色

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
    self.view.backgroundColor = [UIColor colorWithRed:51/255.0 green:51/255.0 blue:51/255.0 alpha:1];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T06:53:00.500

这绝对是一个错误。phonegap 开发团队将在几周后在 2.7 版本中修复此问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-30T14:31:53.467

我刚刚检查了我的代码，我有 2.6，这个修复已经存在。但它不起作用，我仍然看到具有相同条件的灰色条。那怎么可能？

编辑：看起来我的一个队友做了这个修复并解决了这个问题。问题是您仍然可以看到灰色空间，并且它很快就被删除了。

# algorithm - 计算出租车运动

> ID：15935269
> 
> 赞同：9
> 
> 时间：2013-04-10T19:58:24.093
> 
> 标签：algorithm, combinatorics

假设我有 N 辆出租车，有 N 个顾客在等出租车接。客户和出租车的初始位置是随机/任意的。

现在我想将每辆出租车分配给一位顾客。

顾客都静止不动，出租车都以相同的速度行驶。为简单起见，我们假设没有障碍物，出租车可以直线移动到指定的客户。

我现在想尽量减少直到最后一位顾客进入他/她的出租车的时间。

有没有解决这个问题的标准算法？我有成千上万的出租车/客户。解决方案不必是最佳的，只要“好”即可。

该问题几乎可以建模为标准的“分配问题”，可以使用[匈牙利算法](http://en.wikipedia.org/wiki/Hungarian_algorithm)（Kuhn-Munkres 算法或 Munkres 分配算法）解决。但是，我想最小化最昂贵任务的成本，而不是最小化任务的成本总和。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:37:54.037

既然您提到了匈牙利算法，我想您可以做的一件事是使用一些不同的距离度量而不是欧几里德距离，然后在其上运行匈牙利算法。例如，而不是使用

d = sqrt((x0 - x1) ^ 2 + (y1 - y0) ^ 2)

采用

d = ((x0 - x1) ^ 2 + (y1 - y0) ^ 2) ^ 10

这可能会导致算法严重惩罚大数字，这可能会限制最大距离的长度。

编辑：本文“几何有助于瓶颈匹配和相关问题”可能包含更好的算法。但是，我仍在阅读它的过程中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T03:46:03.370

我不确定匈牙利算法是否可以解决您的问题。根据链接，它运行 n ^ 3 次。将 25,000 代入 n 将产生 25,000 ^ 3 = 15,625,000,000,000。这可能需要相当长的时间才能运行。

由于解决方案不需要是最优的，您可以考虑使用[模拟退火](http://en.wikipedia.org/wiki/Simulated_annealing)或可能的[遗传算法](http://en.wikipedia.org/wiki/Genetic_algorithms)。这些中的任何一个都应该更快，并且仍然会产生接近最佳解决方案。

如果使用遗传算法，可以设计适应度函数以最小化个人需要等待的最长时间。但是，您必须小心，因为如果这是唯一的标准，那么当只有一辆出租车最靠近最远的乘客时，该解决方案将无法很好地工作。因此，适应度函数还需要考虑其他等待时间。解决这个问题的一个想法是迭代地运行模型，并在每次迭代后删除最长的出租车行程（包括出租车和人）。但是，为所有 10,000 多辆出租车/人这样做可能会耗费大量时间。

我认为任何出租车车主或经理都不会考虑将最后一位进入出租车的顾客的等待时间最小化，而不是尽量减少所有出租车的等待时间总和——仅仅是因为他们在最大限度地减少等待总和时总体上赚了更多的钱次。至少路易·德帕尔玛（Louie DePalma）永远不会那样做...所以，我怀疑您遇到的真正问题与出租车几乎没有关系...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:09:02.137

可以解决您的问题的“好”算法是[贪心算法](http://en.wikipedia.org/wiki/Greedy_algorithm)。由于出租车和人有一个位置，这些位置可以与一个“中心”点相关联。按顺序（相对于“中心”）对需要上车的出租车和人员进行分类。然后开始按顺序分配出租车，按顺序接人。这个贪心规则将确保离中心最近的出租车接载离中心最近的人，而最远的出租车接载最远的人。

更好的方法可能是使用[动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)，但是我不确定也没有时间投资。一个很好的动态编程教程可以在[这里找到](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=dynProg)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T22:55:44.313

为了获得最佳解决方案：构建一个加权二分图，其中每个出租车和客户都有一个顶点，每个出租车到每个客户的边都有一条边，其权重是行程时间。以非递减权重的顺序扫描边缘，保持包含到目前为止扫描的边缘的子图的*最大匹配。*当匹配完美时停止。

# android - AsyncTask 加载我所有的片段，除了两个 - 我得到蓝屏，为什么？

> ID：15935272
> 
> 赞同：0
> 
> 时间：2013-04-10T19:58:31.573
> 
> 标签：android, android-asynctask, android-viewpager, fragment

我完全不知道为什么我的应用程序会发生接下来的事情：我有一个带有大约 20 个片段的 viewpager，2..20 个片段从 http 连接获取数据，我想将其与 AsyncTask 一起使用。进度条出现，http 连接建立，这些片段很好。但是，我必须对其他带有一些静态数据的片段，它们不需要连接，但是我在 FragmentActivity 中建立了连接，所以它也不应该对它们产生不同的影响。但不知何故，我得到了这两个片段，我得到了两个蓝页，因为整个片段由一个蓝色背景的布局组成。

AsynTask 部分：

```
public class BackgroundAsyncTask extends
    AsyncTask<Void, Integer, Void> {

        int myProgress;

        @Override
        protected void onPostExecute(Void result) {
            // TODO Auto-generated method stub

            pb.setVisibility(View.GONE);

                    pager.setAdapter( adapter );
        indicator.setViewPager( pager );

            pager.setAdapter(mPagerAdapter);
            pager.setCurrentItem(INITIAL_PAGE);
            pager.setOffscreenPageLimit(3);

        }

        @Override
        protected void onPreExecute() {
            // TODO Auto-generated method stub
            pb.setVisibility(View.VISIBLE);
        }

        @Override
        protected Void doInBackground(Void... params) {
        // TODO Auto-generated method stub
        //http post MYQUERY1 - this works like charm
        getData();
            return null;

}

 } 
```

onCreate() 部分：

```
setContentView( R.layout.main );
context=this;
//bblablabla
pb = (ProgressBar)findViewById(R.id.progressbar);

//for viewpager
pager = (ViewPager)findViewById( R.id.viewpager );
adapter = new GoogleMusicAdapter(getSupportFragmentManager());
indicator = (TabPageIndicator)findViewById( R.id.indicator );

fragments.clear();
fragments.add( TabMyList1.class.getName());
fragments.add( TabMyList2.class.getName());   //these 2 are blue

fragments.add(TabListFromNet1.class.getName());
//.... these work
fragments.add(TabListFromNet18.class.getName());

mPagerAdapter = new PagerAdapter1(super.getSupportFragmentManager(), fragments);

new BackgroundAsyncTask().execute(); 
```

那么这怎么可能呢？我的片段不需要更多的工作，尤其是 2 个静态片段，为什么是蓝色的？非常感谢您，我现在正在努力解决这个问题。

# php - 使用 BASH 存储和循环 MySQL 获取的结果？

> ID：15935279
> 
> 赞同：0
> 
> 时间：2013-04-10T19:59:00.850
> 
> 标签：php, mysql, sql, bash, shell

我对 Bash 和 Shell 脚本不是很熟悉，但我的长期目标是编写一个 bash 脚本，该脚本将从 MySQL 表中获取数据。对于找到的每个结果，我都想执行一个扩展名为“?result=bashvariable”的 PHP 文件。

我将如何在 bash 中获取 SQL 数据并将其存储在变量中？

在 PHP 中，我会简单地获取结果并运行一个 while 循环，我只是想知道这是否可以使用 bash？

如果这是某种重复，我深表歉意，但我还没有找到我正在寻找的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:01:13.820

```
mysql -e 'yourquery' database | while read bashvariable
do
  php file.php "$bashvariable"
done 
```

PHP 脚本可以将 bash 变量作为`$argv[1]`.

# android - 带有 Android 目标的 Haxe NME 项目无法部署：Activity 类不存在

> ID：15935283
> 
> 赞同：0
> 
> 时间：2013-04-10T19:59:06.320
> 
> 标签：android, android-manifest, flashdevelop, haxe, nme

我在 FlashDevelop 中创建了一个 NME 项目，在 Main.hx 中我加载了一个位图，然后单击以 android 为目标的构建按钮。构建成功完成，但随后出现以下错误：

```
Running process: C:\Motion-Twin\haxe\haxelib.exe run nme run "C:\Users\...\...\flash-develop\haxe-nme-playground\NMEAndroidTest\application.nmml" android adb server is out of date.  killing...
* daemon started successfully *     pkg: /data/local/tmp/NMEAndroidTest-debug.apk

Failure [INSTALL_FAILED_CONTAINER_ERROR]

518 KB/s (1838507 bytes in 3.460s) Starting: Intent { act=android.intent.action.MAIN cmp=com.test.nme.android.NMEAndroidTest/.MainActivity }

Error type 3

Error: Activity class {com.test.nme.android.NMEAndroidTest/com.test.nme.android.NMEAndroidTest.MainActivity} does not exist. 
```

但是 Activity 确实存在： ![MainActivity 存在](https://i.stack.imgur.com/LGFC9.jpg)

AndroidManifest.xml 的内容：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android" android:installLocation="preferExternal" android:versionCode="2" android:versionName="1.0.0" package="com.test.nme.android.NMEAndroidTest">

    <application android:label="NMEAndroidTest" android:debuggable="true" android:icon="@drawable/icon">

        <activity android:name="MainActivity" android:label="NMEAndroidTest" android:configChanges="keyboard|keyboardHidden|orientation">

            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
                <category android:name="ouya.intent.category.GAME"/>
            </intent-filter>

        </activity>

    </application>

    <uses-sdk android:minSdkVersion="8"/>

    <uses-permission android:name="android.permission.WAKE_LOCK" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.VIBRATE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

</manifest> 
```

NME 应该开箱即用地在 Android 上运行，我没有做任何可能破坏它的关键操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:41:25.623

在您的日志中注意此消息：`Failure [INSTALL_FAILED_CONTAINER_ERROR]`

这意味着由 Android SDK 构建的 APK 文件包含错误并在您的设备/模拟器上被丢弃（未安装），因此该活动不存在。

查看您的 android SDK 的工作方式。这行：`android adb server is out of date. killing...`也是可疑的。如果我在你的鞋子里，我会尝试的第一件事是更新（如果没有帮助，可能会重新安装）Android SDK。

# ajax - 如何将我的backbone.js 应用程序与服务器上的更改同步？

> ID：15935285
> 
> 赞同：0
> 
> 时间：2013-04-10T19:59:17.623
> 
> 标签：ajax, backbone.js, sync

我在backbone.js 中有一个应用程序。用户可以将项目添加到后端服务器上添加的应用程序，并且刷新集合并且用户可以看到添加的数据。如何将应用程序与后端的任何更改同步。假设如果多个用户同时添加数据，每个用户都应该看到更改。

有像 ajax polling 这样的选项，我可以在一段时间后刷新模型，但我讨厌使用它。

您能否建议任何事件驱动的方法，其中后端的任何更改都会立即反映在我的应用程序的前端。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:39:26.657

您可以在您的应用程序上添加一种刷新事件，该事件将每隔几分钟刷新一次。像印象笔记桌面应用程序一样。在那种情况下，您将添加集合同步事件。

你也可以使用类似的东西

```
collection.sync(method, collection, [options]) 
```

[http://backbonejs.org/#Sync](http://backbonejs.org/#Sync)

不过，这并不能回答您的问题，而且我不确定您将如何将更改从服务器推送到客户端。

# r - 对最接近整个样本中位数的组的子集观察

> ID：15935289
> 
> 赞同：0
> 
> 时间：2013-04-10T19:59:38.563
> 
> 标签：r, subset

我有多个站点 - 每个站点都访问过多次。我想对数据进行子集化以仅包含来自每个站点的一次访问（但来自该访问的所有观察结果），并且我希望该访问最接近（及时）对所有站点的所有访问的中位日期。

样本数据：

```
d = data.table(site = c('a', 'a','a','a','b', 'b','b', 'b', 'c', 'c', 'c', 'c'), 
       sex = c('m','f','m','f','m','f','m','f','m','f','m','f'), 
       date = c(127,127, 185, 185, 132,132, 189,189, 119,119, 178, 178), 
       count = c(12, 15, 10, 9, 18, 22,12, 15, 10, 9, 18, 22)) 
```

我想得到什么：

```
d = data.table(site = c('a', 'a','b', 'b', 'c', 'c'), 
     sex = c('m','f','m','f','m','f'),
     date = c(127,127, 132,132, 178, 178), 
     count = c(12, 15,18, 22, 18, 22)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:09:24.793

```
library(data.table)

d = data.table(site = c('a', 'a', 'b', 'b', 'c', 'c'),
               date = c(127, 185, 132, 189, 119, 178),
               count = c(12, 15, 10, 9, 18, 22))

d.median = d[, median(date)]
d[, {i = which.min(abs(date - d.median));
     list(date = date[i], count = count[i])},
  by = list(sex, site)] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:16:35.603

这是使用`ave`和`rank`来自基础 R的一种方法

```
myRanks <- with(mydf, ave(date, site, FUN = function(x) 
  rank(abs(x - median(date)), ties.method = "first")))
mydf[myRanks == 1, ]
#   site date count
# 1    a  127    12
# 3    b  132    10
# 6    c  178    22 
```

`rank`用于帮助处理您可能有多个“最接近”中位数的值的情况。

# jquery - jquery.when done 不起作用：它立即执行

> ID：15935305
> 
> 赞同：2
> 
> 时间：2013-04-10T20:00:46.847
> 
> 标签：jquery, .when

我在 jQuery 1.7 中对此进行了编码：

```
$.when($.ajax({
    type: "GET",
    url: internalOrderServiceURL,
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: $.proxy(this.retrieveInternalOrderSuccess, this),
    error: $.proxy(this.retrieveInternalOrderError, this)
}), $.ajax({
    type: "GET",
    url: rejectionReasonServiceURL,
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: $.proxy(this.retrieveRejectionReasonSuccess, this),
    error: $.proxy(this.retrieveRejectionReasonError, this)
})

).done(

$.ajax({
    type: "GET",
    url: salesOrderInfoServiceURL,
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: $.proxy(this.retrieveServiceItemSuccess, this),
    error: $.proxy(this.retrieveServiceItemError, this)
})

); 
```

然而回调retrieveServiceItemSuccess 在retrieveInternalOrderSuccess 和retrieveRejectionReasonSuccess 之前执行。谁能告诉我这有什么问题？

我已将代码更改为：

```
$.when($.ajax({
                            type : "GET",
                            url : internalOrderServiceURL,
                            contentType : "application/json; charset=utf-8",
                            dataType : "json",
                            success : $.proxy(this.retrieveInternalOrderSuccess, this),
                            error : $.proxy(this.retrieveInternalOrderError, this)
                        }), $.ajax({
                            type : "GET",
                            url : rejectionReasonServiceURL,
                            contentType : "application/json; charset=utf-8",
                            dataType : "json",
                            success : $.proxy(this.retrieveRejectionReasonSuccess, this),
                            error : $.proxy(this.retrieveRejectionReasonError, this)
                        })).done(function() {
                            $.ajax({
                                type : "GET",
                                url : salesOrderInfoServiceURL,
                                contentType : "application/json; charset=utf-8",
                                dataType : "json",
                                success : $.proxy(this.retrieveServiceItemSuccess, this),
                                error : $.proxy(this.retrieveServiceItemError, this)
                            })
                        }); 
```

但是这一次，第一个回调 retrieveInternalOrderSuccess 执行然后第二个回调执行 (retrieveRejectionReasonSuccess) - 这两个回调的执行顺序是随机的。但是，第三个回调不执行。有人可以建议有什么问题吗？

我试图添加这个：

```
var self = this;
                        $.when($.ajax({
                            type : "GET",
                            url : internalOrderServiceURL,
                            contentType : "application/json; charset=utf-8",
                            dataType : "json",
                            success : $.proxy(this.retrieveInternalOrderSuccess, this),
                            error : $.proxy(this.retrieveInternalOrderError, this)
                        }), $.ajax({
                            type : "GET",
                            url : rejectionReasonServiceURL,
                            contentType : "application/json; charset=utf-8",
                            dataType : "json",
                            success : $.proxy(this.retrieveRejectionReasonSuccess, this),
                            error : $.proxy(this.retrieveRejectionReasonError, this)
                        })).done(function() {
                            $.ajax({
                                type : "GET",
                                url : salesOrderInfoServiceURL,
                                contentType : "application/json; charset=utf-8",
                                dataType : "json",
                                success : function(oResult) {
                                    self.retrieveServiceItemSuccess(oResult);
                                },
                                error : function(oResult) {
                                    self.retrieveServiceItemError(oResult);
                                },
                            })
                        }); 
```

这次回调以正确的顺序调用。任何人都可以澄清这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:02:43.973

函数参数总是在传递之前进行评估。您需要传递一个进行第二次 ajax 调用的*函数。*

```
$.when($.ajax({
    type: "GET",
    url: internalOrderServiceURL,
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: $.proxy(this.retrieveInternalOrderSuccess, this),
    error: $.proxy(this.retrieveInternalOrderError, this)
}), $.ajax({
    type: "GET",
    url: rejectionReasonServiceURL,
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: $.proxy(this.retrieveRejectionReasonSuccess, this),
    error: $.proxy(this.retrieveRejectionReasonError, this)
})

).done(function () {

    $.ajax({
        type: "GET",
        url: salesOrderInfoServiceURL,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: $.proxy(this.retrieveServiceItemSuccess, this),
        error: $.proxy(this.retrieveServiceItemError, this)
    })
}
); 
```

为了使这更易读和明显，请考虑将每个`.ajax()`调用分解为自己的函数：

```
function firstAjax() { /* ... */}
function secondAjax() { /* ... */}
function thirdAjax() { /* ... */}

$.when(firstAjax, secondAjax).done(thirdAjax); 
```

只需确保各个函数返回`$.ajax()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T20:03:19.297

`.done`需要一个函数来执行，而不是一个 Promise 对象。

```
.done(function(){

    $.ajax({
        type: "GET",
        url: salesOrderInfoServiceURL,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: $.proxy(this.retrieveServiceItemSuccess, this),
        error: $.proxy(this.retrieveServiceItemError, this)
    })

}); 
```

**`this`虽然仍然断章取义。**

# c# - BCP 通过 C Sharp

> ID：15935306
> 
> 赞同：0
> 
> 时间：2013-04-10T20:00:47.997
> 
> 标签：c#, sql-server-2008-r2

我正在开发使用 csharp 和 bcp 实用程序将数据从文本文件插入表的工具。

我使用了以下代码，但它不起作用。表格或文本文件没有问题。

```
 private void button1_Click(object sender, EventArgs e)
    {
        SqlConnection con = new SqlConnection(@"Data Source=ABPROCKET\MSSQL2008R2;Initial Catalog=Northwind;Integrated Security=True");
        string sCommandText;
        sCommandText = "exec xp_cmdShell 'bcp.exe' " + "PUBS.DBO.T1" + " IN " +@"D:\Text.Txt" + "-T" +" -c";

        con.Open();
        SqlCommand cmd = new SqlCommand();
        cmd.Connection = con;
        cmd.CommandType = CommandType.Text;
        cmd.CommandText = sCommandText;
        cmd.ExecuteNonQuery();
        MessageBox.Show("inserted");

    } 
```

我认为问题出在 bcp 命令及其参数上。请有人帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:13:24.670

尝试将单引号`bcp.exe`移到语句的末尾：

```
sCommandText = "exec xp_cmdShell 'bcp.exe " + "PUBS.DBO.T1" + " IN " +@"D:\Text.Txt" + "-T" +" -c'"; 
```

# css - 强制动态 div 在同一行

> ID：15935309
> 
> 赞同：2
> 
> 时间：2013-04-10T20:00:52.717
> 
> 标签：css, html

嘿伙计们，我真的需要一些帮助:)

我的问题是我在一个 div 中有 2 个动态宽度 div，它们从 460 到 640 像素（只是一个例子），我的网站从 960 像素跨越到 1300 像素，所以当我的网站是 1300 像素宽时，我希望两个 div 都在同一个宽度为 640 像素的行，当网站为 960 像素时，我希望 div 位于宽度为 460 像素的同一行上。

我的问题是，当网站变小（拖拽浏览器的宽度）时，它们会彼此下降。

这是一些代码：http: [//jsfiddle.net/EKYLe/2/](http://jsfiddle.net/EKYLe/2/)

这是html：

```
<div class="Content">
<div class="box-container">
    <div class="box">
        <h2>Nyheder</h2>

    <p>Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet.</p>

    <ul>
        <li>Lorem ipsum dolor sit amet.</li>
        <li>Lorem ipsum dolor sit amet.</li>
        <li>Lorem ipsum dolor sit amet.</li>
    </ul>
    </div>
    <div class="box">
        <h2>Nyheder</h2>

    <p>Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet.</p>

    <ul>
        <li>Lorem ipsum dolor sit amet.</li>
        <li>Lorem ipsum dolor sit amet.</li>
        <li>Lorem ipsum dolor sit amet.</li>
    </ul>
    </div>
</div> 
```

正如您所看到的，当您移动它们掉落的窗户的大小时，它们会互相打击。

关于尼克拉斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:56:05.327

如果你想控制它们的位置，你应该把它们放在一张桌子里。这样，它们将始终保留在 tablerow 的第 1 列和第 2 列中。您可以在页面内对齐它们而不会遇到太多麻烦。

# iphone - 如何在 iOS 上正确使用 Container View Controller

> ID：15935312
> 
> 赞同：0
> 
> 时间：2013-04-10T20:01:03.327
> 
> 标签：iphone, view, ios6, containers

我的应用程序有一个父视图控制器（MainViewController.h/m - UIViewController，没有 NIB 文件）用于所有其他 UIViewController，它同时是 RootViewController。

我的应用程序应该支持 iOS 5，所以 AutoLayout 是关闭的..

继承一些代码：

在 AppDelegate.m

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    self.mainViewController = [[MainViewController alloc] init];
    [self.window setRootViewController:self.mainViewController];
    [self.window makeKeyAndVisible];
    return YES;
} 
```

在 MainViewController.m

```
- (void)viewDidLoad {
    [super viewDidLoad];
// Do any additional setup after loading the view.

    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {

        if ([[UIScreen mainScreen] bounds].size.height == 568) {
            _homeViewController = [[HomeViewController alloc] initWithNibName:@"HomeViewController~iPhone5" bundle:nil];
        } else {
            _homeViewController = [[HomeViewController alloc] initWithNibName:@"HomeViewController~iPhone" bundle:nil];
        }
    } else {
        _homeViewController = [[HomeViewController alloc] initWithNibName:@"HomeViewController" bundle:nil];
    }

    [self addChildViewController:_homeViewController];
    [self.view addSubview:_homeViewController.view];
    [_homeViewController didMoveToParentViewController:self];
}

- (void)changeFromViewController:(UIViewController*)fromViewController toViewController:(UIViewController*)toViewController withDuration:(NSNumber*)duration {

    toViewController.view.frame = self.view.bounds;
    [toViewController.view layoutIfNeeded];

    [self addChildViewController:toViewController];
    [self transitionFromViewController:fromViewController
                      toViewController:toViewController
                              duration:[duration floatValue]
                               options:UIViewAnimationOptionTransitionCrossDissolve
                            animations:nil
                            completion:^(BOOL finished) {

                                [toViewController didMoveToParentViewController:self];

                                [fromViewController willMoveToParentViewController:nil];
                                [fromViewController removeFromParentViewController];
                            }];
} 
```

HomeViewController*.xib 包含 7 个 UIButton。如果其中一个触及 MainViewController 类被调用以从一个 ChildViewController(HomeViewController, etc..) 更改为另一个。

主视图控制器.m

```
- (IBAction)firstButton_click:(id)sender {

    [(MainViewController *)self.parentViewController setAnimationForChangeFrom:self toStartTestSettingsViewControllerWithDuration:[NSNumber numberWithDouble:0.4] andWithDelay:[NSNumber numberWithDouble:0.1]];
} 
```

现在关于问题。

在 iOS 6 及更高版本的 iPhone（设备或模拟器）上，UIButtons 仅在几次触摸后才会响应。放置在视图底部的按钮要工作，必须触摸更多次，然后放置在顶部的按钮。几次触摸后，当事件触发并更改视图时，当我回到此视图时，一切正常。我只有 iPhone iOS 6.x 才有这个问题。它可以在 iPhone iOS 5.x 和 iPad 5.x-6.x 上正常运行。

如果我将 HomeViewController 设为 RootViewController，按钮当然会响应事件。但是我无法使用 UIViewAnimationOptionTransitionCrossDissolve Animation[[UIViewController transitionFromViewController:toViewController:duration:options:animations:completion:] 进行转换，因为视图必须具有相同的父视图控制器。我做错了什么？是虫子吗？有什么解决办法吗？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T09:38:12.717

将其写入 .pch 文件

```
#define IS_IPHONE_5 ( fabs( ( double )[ [ UIScreen mainScreen ] bounds ].size.height - ( double )568 ) < DBL_EPSILON )

- (void)viewDidLoad {
[super viewDidLoad];
// Do any additional setup after loading the view.

if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {

    if (IS_IPHONE_5) {
        _homeViewController = [[HomeViewController alloc] initWithNibName:@"HomeViewController~iPhone5" bundle:nil];
    } else {
        _homeViewController = [[HomeViewController alloc] initWithNibName:@"HomeViewController~iPhone" bundle:nil];
    }
} else {
    _homeViewController = [[HomeViewController alloc] initWithNibName:@"HomeViewController" bundle:nil];
}

[self addChildViewController:_homeViewController];
[self.view addSubview:_homeViewController.view];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T08:42:19.547

问题是因为 [_homeViewController didMoveToParentViewController:self];。这是多余的。

MainViewController 中的 ViewDidLoad 应该是：

```
- (void)viewDidLoad {
    [super viewDidLoad];
// Do any additional setup after loading the view.

    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {

        if ([[UIScreen mainScreen] bounds].size.height == 568) {
            _homeViewController = [[HomeViewController alloc] initWithNibName:@"HomeViewController~iPhone5" bundle:nil];
        } else {
            _homeViewController = [[HomeViewController alloc] initWithNibName:@"HomeViewController~iPhone" bundle:nil];
        }
    } else {
        _homeViewController = [[HomeViewController alloc] initWithNibName:@"HomeViewController" bundle:nil];
    }

    [self addChildViewController:_homeViewController];
    [self.view addSubview:_homeViewController.view];
} 
```

现在一切正常..

# c++ - 可以删除抽象类而不是子类吗？

> ID：15935316
> 
> 赞同：1
> 
> 时间：2013-04-10T20:01:15.507
> 
> 标签：c++, inheritance, abstract-class

可以删除抽象类而不是子类吗？所有的分配都会因此被释放吗？

以以下情况为例，但请不要将您的答案仅限于该情况：

```
struct A {
    virtual void fun() = 0;
};
struct B : public A {
    void fun() { /* actually doing something here. */ }
};
struct C {
    A *a;
    void OneTask() {
        // (...)
        a = new B();
    }
    void AnotherTask() { /* using fun() in some way. */ }
    ~C() { delete a; }
}; 
```

这个想法是让 OneTask() 有多种可能的结果，这导致分配一个指向从 A 继承的不同类的指针，B 只是一个例子；然后在 AnotherTask() 和 C 类的其他方法中合理使用这样的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:02:50.303

您必须在基类中有虚拟析构函数，否则不会发生派生类的完全破坏。

```
struct A {
    virtual void fun() = 0;
virtual ~A()
   {
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:05:19.097

是的，`delete a`不知道实际派生类型`a`指向什么是完全可以的。

正如 shivakumar 指出的那样，如果您不将基类的析构函数设为虚拟，那么删除派生类最终不会调用基类的析构函数。在您的简单示例中，这不是问题，但在现实生活中，您应该始终将析构函数设为虚拟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:06:51.073

If A has a virtual destructor then both destructors of A and B are succesfully called (first B then A) ,

If you do not declare the constructor of A as virtual, then only the destructor of A is called during deletion and extended data of B may leak.

```
struct A {
   virtual void fun() = 0;
   virtual ~A();
};
struct B : public A {
   void fun() { /* actually doing something here. */ }
   ~B();
}; 
```

# javascript - 平滑滚动到顶部

> ID：15935318
> 
> 赞同：73
> 
> 时间：2013-04-10T20:01:22.737
> 
> 标签：javascript

我已经搜索了几个小时，但我没有解决方案。我想要平滑滚动到页面顶部。我已经可以平滑滚动以将页面中的锚点与`.js`附加到我的站点的文件分开，但我不能在顶部使用锚点，因为我使用的是来自免费托管站点的模板，该模板带有不允许的内置页面构建工具我在身体区域上方进行编辑。

[这](http://www.dwuser.com/education/content/quick-guide-adding-smooth-scrolling-to-your-webpages/)是我平滑滚动的地方。我一直在尝试设置“没有 jquery 插件的平滑滚动到元素”，但经过无数次尝试，我不知道如何安排它。我也用过`window.scrollTo(0, 0);`，但它会立即滚动。谢谢！

另外： http: [//jsfiddle.net/WFd3V/](http://jsfiddle.net/WFd3V/) - 代码可能是标签`class="smoothScroll"`，因为我的其他元素使用它，但我不知道如何将它与`href="javascript:window.scrollTo(0,0);"`, 或任何其他将页面带到没有锚的顶部。

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2019-04-30T17:32:52.143

我认为最简单的解决方案是：

```
window.scrollTo({top: 0, behavior: 'smooth'}); 
```

如果您想要即时滚动，那么只需使用：

```
window.scrollTo({top: 0}); 
```

可以用作函数：

```
// Scroll To Top

function scrollToTop() {

window.scrollTo({top: 0, behavior: 'smooth'});

} 
```

或作为 onclick 处理程序：

```
<button onclick='window.scrollTo({top: 0, behavior: "smooth"});'>Scroll to Top</button> 
```

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2018-02-23T07:14:04.020

这是我用 ES6 实现的建议

```
const scrollToTop = () => {
  const c = document.documentElement.scrollTop || document.body.scrollTop;
  if (c > 0) {
    window.requestAnimationFrame(scrollToTop);
    window.scrollTo(0, c - c / 8);
  }
};
scrollToTop(); 
```

**提示：**对于较慢的滚动动作，增加硬编码数字`8`。数字越大 - 滚动越平滑/越慢。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2020-11-04T19:18:17.397

```
window.scroll({top: 0, behavior: "smooth"}) 
```

只需使用这段代码，它就会完美运行，您可以将其包装到方法或事件中。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-07-06T12:27:00.647

仅纯 Javascript

```
var t1 = 0;
window.onscroll = scroll1;

function scroll1() {
  var toTop = document.getElementById('toTop');
  window.scrollY > 0 ? toTop.style.display = 'Block' : toTop.style.display = 'none';
}

function abcd() {
  var y1 = window.scrollY;
  y1 = y1 - 1000;
  window.scrollTo(0, y1);
  if (y1 > 0) {
    t1 = setTimeout("abcd()", 100);
  } else {
    clearTimeout(t1);
  }
}
```

```
#toTop {
  display: block;
  position: fixed;
  bottom: 20px;
  right: 20px;
  font-size: 48px;
}

#toTop {
  transition: all 0.5s ease 0s;
  -moz-transition: all 0.5s ease 0s;
  -webkit-transition: all 0.5s ease 0s;
  -o-transition: all 0.5s ease 0s;
  opacity: 0.5;
  display: none;
  cursor: pointer;
}

#toTop:hover {
  opacity: 1;
}
```

```
<p>your text here</p>
<img id="toTop" src="http://via.placeholder.com/50x50" onclick="abcd()" title="Go To Top">
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-04-10T20:04:44.737

您应该开始使用 jQuery 或其他一些 js 库。它比 js 简单得多，您可以将其用作大多数 js 的简写，而不是实际上冗长的、抽出的 js。

简单地说`<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>`（或任何最新的谷歌 CDN 是[https://developers.google.com/speed/libraries/devguide#jquery](https://developers.google.com/speed/libraries/devguide#jquery)）在你的`<head>`.

然后，在您的`event`代码中（如果您使用 jQuery 会更容易：`$.click()`对于按钮、`$.change()`复选框、选择、单选...），将第二个链接中的代码看起来更像

```
$('#theIDofTheButtonThatTriggersThisAnimation').click(function(){
    $('#theIDofTheElementYouWantToSmoothlyScroll').animate({
        scrollTop: 0
    }, 2000);
}); 
```

但是，如果您正在尝试制作动画，我建议您查看一些基本的 css 属性，例如`position:absolute`并`position:relative`避免发疯。

* * *

我仍然不太确定您的代码中发生了什么，因为相对于现在使用 css 和 jQuery 完成的事情，它是非常不标准的。我会把它分解成一些简单的东西来学习一般概念。

对于您的示例，您应该以我的动画示例为基础，我是如何学习的：[https ://stackoverflow.com/a/12906254/1382306](https://stackoverflow.com/a/12906254/1382306)

我认为您正在尝试根据`$.click()`. 在我的回答中，它左右滑动。您可以使用 css`top`属性而不是`left`.

一旦弄清楚如何上下移动整个内容`div`，您就可以制作一个`relative`容器来保存所有内容，并通过设置它们的 s 来循环`absolute` `div`操作所有内容。这是一个快速入门：[http ://css-tricks.com/absolute-positioning-inside-relative-positioning/](http://css-tricks.com/absolute-positioning-inside-relative-positioning/)`div``top``absolute``relative`

我所有的动画都有`relative`容器和`absolute`内容。我就是这样制作了一个自定义的 gridview 插件，它可以立即压缩整个数据库。

`div`此外，在动画方面确实没有过度使用s。试图让 1`div`做所有事情是一场噩梦。

试试看你能不能把我的小提琴重新格式化成垂直滑出。完成后，`absolute`稍作`relative`研究。如果您还有其他问题，请再问一个问题。

将您的想法转变为这些理念，您将开始熟悉这种类型的编码。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-12-14T08:49:40.207

嗯评论功能对我关闭，

尝试这个

```
$(document).ready(function(){
    $("#top").hide();
    $(function toTop() {
        $(window).scroll(function () {
            if ($(this).scrollTop() > 100) {
                $('#top').fadeIn();
            } else {
                $('#top').fadeOut();
            }
        });

        $('#top').click(function () {
            $('body,html').animate({
                scrollTop: 0
            }, 800);
            return false;
        });
    });         

    });
```

```
#top {
  float:right;
  width:39px;
  margin-top:-35px; 
}
#top {
    transition: all 0.5s ease 0s;
    -moz-transition: all 0.5s ease 0s;
    -webkit-transition: all 0.5s ease 0s;
    -o-transition: all 0.5s ease 0s;
    opacity: 0.5;
    display:none;
    cursor: pointer;
}
#top:hover {
    opacity: 1;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
<div id="top" onclick="toTop()"><img src="to_top.png" alt="no pic "/> klick to top</div>
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-10-02T15:48:16.830

自从被问到这个问题已经过去了一段时间。

现在不仅可以为 window.scroll 函数指定数字，还可以传递一个具有三个属性的对象：top、left 和 behavior。因此，如果我们想使用原生 JavaScript 平滑向上滚动，我们现在可以执行以下操作：

```
let button = document.querySelector('button-id');
let options = {top: 0, left: 0, behavior: 'smooth'}; // left and top are coordinates
button.addEventListener('click', () => { window.scroll(options) }); 
```

[https://developer.mozilla.org/en-US/docs/Web/API/Window/scroll](https://developer.mozilla.org/en-US/docs/Web/API/Window/scroll)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2018-02-17T02:53:41.823

**你可以简单地使用**

```
// When the user scrolls down 20px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};

function scrollFunction() {
    if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
        document.getElementById("gotoTop").style.display = "block";
    } else {
        document.getElementById("gotoTop").style.display = "none";
    }

}

// When the user clicks on the button, scroll to the top of the document
function topFunction() {

     $('html, body').animate({scrollTop:0}, 'slow');
}
```

```
body {
  font-family: Arial, Helvetica, sans-serif;
  font-size: 20px;
}

#gotoTop {
  display: none;
  position: fixed;
  bottom: 20px;
  right: 30px;
  z-index: 99;
  font-size: 18px;
  border: none;
  outline: none;
  background-color: red;
  color: white;
  cursor: pointer;
  padding: 15px;
  border-radius: 4px;
}

#gotoTop:hover {
  background-color: #555;
}
```

```
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>

<button onclick="topFunction()" id="gotoTop" title="Go to top">Top</button>

<div style="background-color:black;color:white;padding:30px">Scroll Down</div>
<div style="background-color:lightgrey;padding:30px 30px 2500px">This example demonstrates how to create a "scroll to top" button that becomes visible when the user starts to scroll the page.</div>
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-10-02T11:13:21.483

使用 jQuery 的优雅简单的解决方案。

```
<script>
    function call() {
        var body = $("html, body");
        body.stop().animate({scrollTop:0}, 500, 'swing', function() {
        });
    }
</script> 
```

并在您的 html 中： `<div onclick="call()"><img src="../img/arrow-up@2x.png"></div>`

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-07-02T04:00:27.790

我刚刚定制了 BootPc Deutschland 的答案

你可以简单地使用

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
    $(document).ready(function(){
        $('body,html').animate({
            scrollTop: 0
        }, 800);
    $('#btn-go-to-top').click(function () {
        $('body,html').animate({
            scrollTop: 0
        }, 800);
        return false;
    });
}); 
</script> 
```

这将帮助您顺利滚动到页面顶部。

和造型

```
#btn-go-to-top {
opacity: .5;
width:4%;
height:8%;
display: none;
position: fixed;
bottom: 5%;
right: 3%;
z-index: 99;
border: none;
outline: none;
background-color: red;
color: white;
cursor: pointer;
padding: 10px;
 border-radius: 50%;
}

#btn-go-to-top:hover {
opacity: 1;
}
.top {
transition: all 0.5s ease 0s;
-moz-transition: all 0.5s ease 0s;
-webkit-transition: all 0.5s ease 0s;
-o-transition: all 0.5s ease 0s;
} 
```

这种样式使按钮到达页面的右下角。

在您的页面中，您可以像这样添加按钮以转到顶部

```
<div id="btn-go-to-top" class="text-center top">
<img src="uploads/Arrow.png" style="margin: 7px;" width="50%" height="50%">
</div> 
```

希望这对你有帮助。如果你有任何疑问，你可以随时问我

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-08-03T15:59:33.677

有关平滑滚动的更全面的方法列表，请参阅我的答案[here](https://stackoverflow.com/a/51689657/9513184)。

* * *

要在准确的时间内滚动到某个位置，[`window.requestAnimationFrame`](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame)可以使用，每次计算出合适的当前位置。不支持[`setTimeout`](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout)时可以使用类似的效果。`requestAnimationFrame`要滚动到页面顶部，可以使用 position as 调用以下函数`0`。

```
/*
   @param pos: the y-position to scroll to (in pixels)
   @param time: the exact amount of time the scrolling will take (in milliseconds)
*/
function scrollToSmoothly(pos, time) {
    var currentPos = window.pageYOffset;
    var start = null;
    if(time == null) time = 500;
    pos = +pos, time = +time;
    window.requestAnimationFrame(function step(currentTime) {
        start = !start ? currentTime : start;
        var progress = currentTime - start;
        if (currentPos < pos) {
            window.scrollTo(0, ((pos - currentPos) * progress / time) + currentPos);
        } else {
            window.scrollTo(0, currentPos - ((currentPos - pos) * progress / time));
        }
        if (progress < time) {
            window.requestAnimationFrame(step);
        } else {
            window.scrollTo(0, pos);
        }
    });
} 
```

```
function scrollToSmoothly(pos, time) {
    var currentPos = window.pageYOffset;
    var start = null;
    if(time == null) time = 500;
    pos = +pos, time = +time;
    window.requestAnimationFrame(function step(currentTime) {
        start = !start ? currentTime : start;
        var progress = currentTime - start;
        if (currentPos < pos) {
            window.scrollTo(0, ((pos - currentPos) * progress / time) + currentPos);
        } else {
            window.scrollTo(0, currentPos - ((currentPos - pos) * progress / time));
        }
        if (progress < time) {
            window.requestAnimationFrame(step);
        } else {
            window.scrollTo(0, pos);
        }
    });
}

window.scrollTo(0, 2000);
document.querySelector('button').addEventListener('click', function(e){
  scrollToSmoothly(0, 700);
});
```

```
<button style="margin: 2000px 0;">Smooth scroll to top</button>
```

也可以使用[SmoothScroll.js 库](https://github.com/LieutenantPeacock/SmoothScroll)，它处理更复杂的情况，例如垂直和水平平滑滚动、在其他容器元素内滚动、不同的缓动行为、从当前位置相对滚动等等。

```
smoothScroll({yPos: 'start', duration: 700});
// or
smoothScroll({yPos: 0, duration: 700}); 
```

```
window.scrollTo(0, 2000);
document.querySelector('button').addEventListener('click', function(e){
  smoothScroll({yPos: 'start', duration: 700});
});
```

```
<script src="https://cdn.jsdelivr.net/gh/LieutenantPeacock/SmoothScroll@1.2.0/src/smoothscroll.min.js" integrity="sha384-UdJHYJK9eDBy7vML0TvJGlCpvrJhCuOPGTc7tHbA+jHEgCgjWpPbmMvmd/2bzdXU" crossorigin="anonymous"></script>
<button style="margin: 2000px 0;">Smooth scroll to top</button>
```

或者，您可以将选项对象传递给[`window.scroll`](https://developer.mozilla.org/en-US/docs/Web/API/window/scroll)其行为设置为平滑，滚动到特定的 x 和 y 位置，或者[`window.scrollBy`](https://developer.mozilla.org/en-US/docs/Web/API/window/scrollBy)从当前位置滚动一定量：

```
// Scroll to specific values
// scrollTo is the same
window.scroll({
  top: 2500, 
  left: 0, 
  behavior: 'smooth' 
});

// Scroll certain amounts from current position 
window.scrollBy({ 
  top: 100, // could be negative value
  left: 0, 
  behavior: 'smooth' 
}); 
```

```
window.scrollTo(0, 2000);
document.querySelector('button').addEventListener('click', function(e){
  window.scroll({top: 0, left: 0, behavior: 'smooth'});
});
```

```
<button style="margin: 2000px 0;">Smooth scroll to top</button>
```

现代浏览器支持[`scroll-behavior`CSS 属性](https://developer.mozilla.org/en-US/docs/Web/CSS/scroll-behavior)，该属性可用于使文档中的滚动平滑（无需 JavaScript）。

```
window.scrollTo(0, 2000);
document.querySelector('button').addEventListener('click', function(e){
  window.scrollTo(0, 0);
});
```

```
html, body {
  scroll-behavior: smooth;
}
```

```
<button style="margin: 2000px 0;">Scroll to top (JavaScript)</button> 
<a href="#">Link to smoothly scroll to top of page (no JavaScript)</a>
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-07-26T05:57:25.473

也用于以下：

```
 document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-07-21T18:13:09.203

想出了这个解决方案：

```
function scrollToTop() {
let currentOffset = window.pageYOffset;
const arr = [];

for (let i = 100; i >= 0; i--) {
    arr.push(new Promise(res => {
            setTimeout(() => {
                    res(currentOffset * (i / 100));
                },
                2 * (100 - i))
        })
    );
}

arr.reduce((acc, curr, index, arr) => {
    return acc.then((res) => {
        if (typeof res === 'number')
            window.scrollTo(0, res)
        return curr
    })
}, Promise.resolve(currentOffset)).then(() => {
    window.scrollTo(0, 0)
})} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-12-24T01:33:47.140

theMaxx 答案在 nuxt/vue 中有效，平滑滚动是默认行为

> <button @click=scrollToTop()>跳转到页面顶部

```
 methods: {
    scrollToTop() {
      window.scrollTo({ top: 0 });
    }
  } 
```

# ruby-on-rails - heroku db:pull 连接数据库失败 NoMethodError

> ID：15935319
> 
> 赞同：0
> 
> 时间：2013-04-10T20:01:23.607
> 
> 标签：ruby-on-rails, postgresql, heroku

当我跑步时，`heroku db:pull`我得到一个`NoMethodError`. 狂热的谷歌搜索未能提供解决方案。

```
rails_app[master*]/
↪ heroku db:pull --remote [app] --confirm [app]
Loaded Taps v0.3.24
Auto-detected local database: postgres://127.0.0.1/[db name]?encoding=utf8
Warning: Data in the database 'postgres://127.0.0.1/[db name]?encoding=utf8' will be overwritten and will not be recoverable.
Failed to connect to database:
  NoMethodError -> undefined method `close' for nil:NilClass 
```

当我提供数据库名称时，结果是一样的`postgres://localhost/app_development`

我安装了水龙头，pg，续集：

```
rails_app[master*]/
↪ gem list --local | grep -E taps\|pg\|sequel
pg (0.15.1, 0.15.0, 0.14.1)
sequel (3.46.0, 3.20.0)
taps (0.3.24) 
```

以防万一，我的 rails config/database.yml

```
development: &default
  adapter: postgresql
  database: app_development
  encoding: utf8
  min_messages: warning
  pool: 5
  timeout: 5000

test:
  <<: *default
  database: app_test 
```

我在 Rails 3.2.13 上。

有没有人遇到这个并提出解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:15:16.107

`db:push`目前`db:pull`已弃用；请使用 pgbackups 导入和导出数据

*   [Heroku DevCenter：使用 PG 备份导入和导出 Heroku Postgres 数据库](https://devcenter.heroku.com/articles/heroku-postgres-import-export)

# android - FragmentActivity onSaveInstanceState 没有被调用

> ID：15935322
> 
> 赞同：21
> 
> 时间：2013-04-10T20:01:30.970
> 
> 标签：android, android-fragmentactivity

我已经看到了一些类似的问题，关于`onSaveInstanceState`不被要求`Fragment`s，但在我的情况下`Fragment`，s 工作正常，这是遇到问题的主要`FragmentActivity`问题。

相关代码看起来相当简单：

```
public class MyFActivity extends FragmentActivity implements ActionBar.TabListener { 
    String[] allValues; // data to save

    @Override
    protected void onSaveInstanceState (Bundle outState) {
        Log.d("putting it!", allValues.toString());
        outState.putStringArray("allValues", allValues);
        super.onSaveInstanceState(outState);
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if (savedInstanceState != null) {
            allValues = savedInstanceState.getStringArray("allValues");
            Log.d("getting it!", allValues.toString());
        }
    }
} 
```

暂停活动时（使用后退按钮），`onSaveInstanceState`永远不会调用 ，因此，在恢复应用程序时`savedInstanceState`始终`null`位于方法内。`onCreate`我尝试添加这样的块：

```
@Override
public void onPause() {
    super.onPause();
    onSaveInstanceState(new Bundle());      
} 
```

这是在[https://stackoverflow.com/a/14195202/362657](https://stackoverflow.com/a/14195202/362657)中提出的，但在`onSaveInstanceState`随后被调用时，`savedInstanceState`仍保留`null`在`onCreate`方法中。我错过了什么？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2013-04-10T20:31:39.770

这里的问题是你误解了它是如何`onSaveInstanceState`工作的。它旨在保存`Activity`/的状态，`Fragment`以防操作系统因内存原因或配置更改而需要销毁它。`onCreate`然后，当`Activity`/`Fragment`返回 / 重新启动时，此状态会被传回。

在 a`Fragment`中，它们的所有生命周期回调都直接绑定到它们的父级`Activity`。所以`onSaveInstanceState`在`Fragment`它的父级调用时`Activity`被`onSaveInstanceState`调用。

> 暂停活动时（使用后退按钮），永远不会调用 onSaveInstanceState，因此，在恢复应用程序时，onCreate 方法中的 savedInstanceState 始终为 null。

当按下返回时，用户正在销毁`Activity`，因此它的孩子`Fragment`s，因此没有理由调用`onSaveInstanceState`，因为实例正在被销毁。当你重新打开 时`Activity`，它是一个全新的实例，没有保存状态，所以`Bundle`传入的`onCreate`是`null`. 这完全符合设计。但是，尝试旋转设备或点击主页按钮，然后您会看到`Activity`和它的孩子`Fragment`已经`onSaveInstanceState`调用，并在`onCreate`返回时传回。

您添加的直接在 内部调用的**hack**是一种非常糟糕的做法，因为您**永远不**应该直接调用生命周期回调。这样做会使您的应用程序进入非法状态。`onSaveInstanceState(new Bundle());``onPause`

 **如果您真正想要的是让您的数据在您的应用程序实例之外持续存在，我建议您考虑使用[`SharedPreferences`](http://developer.android.com/reference/android/content/SharedPreferences.html)数据库[来](http://developer.android.com/training/basics/data-storage/databases.html)获取更高级的数据。然后，您可以将持久数据保存在`onPause()`其中或在其更改时保存。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-01-29T18:31:00.487

在对已接受答案的更新中：

`onSaveInstanceState`如果您使用`ViewPager`带有`FragmentStatePagerAdapter`（而不是`FragmentPagerAdapter`）的片段，则可能会调用片段

**FragmentStatePagerAdapter**

> 当有大量页面时，此版本的寻呼机更有用，更像列表视图。当页面对用户不可见时，它们的整个片段可能会被销毁，只保留该片段的已保存状态。与 FragmentPagerAdapter 相比，这允许分页器保留与每个访问的页面相关联的内存少得多，但代价是在页面之间切换时可能会产生更多开销。

不要忘记：

> 使用 FragmentPagerAdapter 时，主机 ViewPager 必须设置有效的 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-30T14:38:18.413

不是对这个问题的准确答案，但可能会对某人的一天有所帮助。就我而言，我打电话给

```
@Override
public void onSaveInstanceState(Bundle outState, PersistableBundle outPersistentState) {
  super.onSaveInstanceState(outState, outPersistentState);
} 
```

我将上面的代码替换如下，一切正常

```
@Override
protected void onSaveInstanceState(@NonNull Bundle outState) {
    super.onSaveInstanceState(outState);
} 
```**

# opencv - 使用opencv获取（内边缘）轮廓像素

> ID：15935326
> 
> 赞同：0
> 
> 时间：2013-04-10T20:01:50.970
> 
> 标签：opencv, image-processing, contour, edge-detection

我正在寻找一种方法来使用 opencv 提取二进制图像的“内部”轮廓。我知道`findContours`提取轮廓，但我需要属于我的二进制图像中阈值对象的轮廓像素，而不是外部轮廓。

这是一个虚构的图像，它更好地描述了我正在寻找的东西。我正在寻找一种提取红色轮廓的方法。

![查找轮廓](https://i.stack.imgur.com/Aqyvr.png)

我已经尝试过一种简单的方法来复制原始二进制图像并将副本每边缩小 2 个像素并用黑色像素填充边缘并使用`findContours`，但结果并不令人满意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:19:30.657

小更新：

我用opencv腐蚀和膨胀解决了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-16T22:41:19.653

您可以只`findContours()`在负面图像上运行。

# django - django 内联表单验证

> ID：15935328
> 
> 赞同：0
> 
> 时间：2013-04-10T20:01:54.057
> 
> 标签：django, validation

对于 Django Admin 站点，我为一个特定的表编写了一个自定义表单，比如它名为 book。

我还编写了书籍表单的验证方法，它工作得很好。然后我为作者创建书籍的内联表单。

现在我对 Book 表单的验证不会被调用内联表单验证。我必须在内联表单集清理函数中再次编写它们。我知道这是可以接受的，但我不想重复。

那么有什么方法可以将我的表单验证应用于内联表单集？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:07:03.480

Use mixin if you don't want to repeat

# arrays - 试图理解 Perl 中数组/列表中的上下文

> ID：15935333
> 
> 赞同：1
> 
> 时间：2013-04-10T20:02:11.013
> 
> 标签：arrays, perl, list

我试图理解`Perl`.
我尝试了以下方法：

```
@array = qw (john bill george);  
print @array;  
print "\n";  
@sorted = sort (array);  
print @sorted; 
```

1.  为什么`print @array`concats 引用的单词？我需要`print "@array";` 打印列表吗？我的意思是`@`表示一个数组对吗？那么为什么打印需要引用呢？
2.  为什么会有`print @sorted;`指纹`array`？如果它被视为标量，它不应该打印`3`数组的大小吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T20:07:16.473

`print @sorted` prints "array" because you forgot the `@` in the previous line :P Change `sort(array)` to `sort(@array)` and it will print "billgeorgejohn".

As for why does `print @array` concatenate the quoted words, first let's make sure we're on the same page regarding `qw`:

```
@array = qw(john bill george); 
```

is equivalent to

```
@array = ("john", "bill", "george"); 
```

so you're getting an array of three elements. Next, see [the documentation for `print`](http://perldoc.perl.org/functions/print.html). Passing a list of stuff to `print` will print them all, in order, separated by whatever value `$,` (the output field separator) has at the time. The default is empty string.

So you could do:

```
$, = " ";
print @array; 
```

to get "john bill george".

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T08:47:52.030

该函数`print`接受参数列表并打印这些参数。

如果你明确地将一个列表传递给`print`then 我希望当它打印出该列表的元素而它们之间没有空格时你不会感到惊讶。

```
print 'one', 'two', 'three'; # prints "onetwothree 
```

将数组传递给`print`完全相同。数组的内容被转换为列表，然后传递给`print`;

```
my @array = qw(one two three);
print @array; # prints "onetwothree" 
```

在这两种情况下，`print`接收三个参数并打印这些参数，没有任何东西将它们分开。

实际上，Perl 使用特殊变量`$,`来控制`print`其参数之间的输出。默认情况下这是一个空字符串，但您可以更改它。

现在让我们考虑你的另一种情况。

```
my @array = qw(one two three);
print "@array"; # prints "one two three" 
```

`print`这个例子中有多少个参数？好吧，这只是一个，不是吗？它是一个单双引号字符串。当 Perl 看到一个双引号字符串时，它会扩展字符串中的所有变量。然后将该扩展的结果传递给`print`然后打印它。所以我们需要了解 Perl 如何扩展双引号中的数组。这是在[perldata](http://perldoc.perl.org/perldata.html)手册页中定义的。

> **数组插值**
> 
> 通过将元素与 $" 变量中指定的分隔符连接起来，数组和切片被插入双引号字符串（如果指定了“use English;”，则为 $LIST_SEPARATOR），默认为空格。

因此，默认情况下，Perl 通过在元素之间插入空格来将数组插入双引号字符串。您可以通过更改`$"`.

这两个示例可能看起来相同，但实际上它们非常不同。

# sql - 设置变量时的 SQL 案例

> ID：15935334
> 
> 赞同：1
> 
> 时间：2013-04-10T20:02:14.567
> 
> 标签：sql, sql-server-2008-r2, case-when

我正在尝试设置 2 个声明的变量与块时的情况

这是我的代码：

```
DECLARE @like bit,@dislike bit
if exists
( select * 
    ,@like = (CASE WHEN likeordislike = 1 THEN 'true' ELSE 'false' END)
    ,@dislike=(CASE WHEN likeordislike = 0 THEN 'true' ELSE 'false' END)
  from likeordislike
) 
```

但是当我执行查询时会抛出错误：

> 消息 102，级别 15，状态 1，第 4 行
> '=' 附近的语法不正确。

一切都好？无法理解

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:23:48.783

```
if (select count(*) from likeordislike where user = @user and comment_id = @comment_id) = 0
begin
  insert into likeordislike etc
end 
else
  update likeordislike etc
end 
```

# ruby-on-rails - 如何解析 Wufoo 表单 webhook 哈希以获取表单标签和值？

> ID：15935341
> 
> 赞同：2
> 
> 时间：2013-04-10T20:02:35.230
> 
> 标签：ruby-on-rails, ruby, json, parsing, wufoo

我想解析从 Wufoo Webhook API 收到的哈希。我正在为多种表单执行此操作，因此我无法对值进行硬编码，例如：`params['Field5']`因为我不知道我有多少字段。

```
 >> params.class
  => Hash
  >> params
  => {"FieldStructure"=>
       "{\"Fields\":[
         {\"Title\":\"Company Name\",\"Type\":\"text\",\"ID\":\"Field6\"},
         {\"Title\":\"Email\",\"Type\":\"email\",\"ID\":\"Field5\"}
        ]}",
 "Field6"=>"testse",
 "Field5"=>"gdsgfdgdf@fd.pl",
 "CreatedBy"=>"public",
 "DateCreated"=>"2013-04-10 07:38:09",
 "EntryId"=>"21"} 
```

基本上，我想从上面的哈希创建一个带有属性的对象：

```
company_name: "testse", email: "gdsgfdgdf@fd.pl" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:28:18.847

你可以：

1.  扫描 FieldStructure 字符串以确定所需字段的 ID。
2.  然后使用 id 在 params 哈希中找到所需的值

例子：

```
params  =  {"FieldStructure"=>
  "{\"Fields\":[{\"Title\":\"Company Name\",\"Instructions\":\"\",\"IsRequired\":\"0\",\"ClassNames\":\"\",\"DefaultVal\":\"\",\"Page\":\"1\",\"Type\":\"text\",\"ID\":\"Field6\"},
  {\"Title\":\"Email\",\"Instructions\":\"\",\"IsRequired\":\"0\",\"ClassNames\":\"\",\"DefaultVal\":\"\",\"Page\":\"1\",\"Type\":\"email\",\"ID\":\"Field5\"}]}",
 "FormStructure"=>
  "{\"Name\":\"TestForm\",\"Description\":\"This is my form. Please fill it out. It's awesome!\",\"RedirectMessage\":\"Great! Thanks for filling out my form!\",\"Url\":\"testform\",\"Email\":null,\"IsPublic\":\"1\",\"Language\":\"english\",\"StartDate\":\"2000-01-01 12:00:00\",\"EndDate\":\"2030-01-01 12:00:00\",\"EntryLimit\":\"0\",\"DateCreated\":\"2013-04-09 06:44:12\",\"DateUpdated\":\"2013-04-10 05:25:55\",\"Hash\":\"z7x3p3\"}",
 "Field6"=>"testse",
 "Field5"=>"gdsgfdgdf@fd.pl",
 "CreatedBy"=>"public",
 "DateCreated"=>"2013-04-10 07:38:09",
 "EntryId"=>"21",
 "IP"=>"46.205.117.55",
 "HandshakeKey"=>""}

 fields = params['FieldStructure'].scan(/Title\":\"(.+?)\".+?ID\":\"(.+?)\"/)
 #=> [["Company Name", "Field6"], ["Email", "Field5"]]

 Hash[fields.collect{ |field| 
   [
     field[0].gsub(/\s+/, "_").downcase.to_sym, 
     params[field[1]]
   ]
 }]
 #=> {:company_name=>"testse", :email=>"gdsgfdgdf@fd.pl"} 
```

# javascript - Ajax 包含脚本阻止页面加载

> ID：15935349
> 
> 赞同：0
> 
> 时间：2013-04-10T20:02:55.480
> 
> 标签：javascript, ajax

我正在使用 Ajax 包含脚本（动态驱动器）来嵌入内容跨域（CORS）。

**问题：**

单击包含脚本的页面时，大约有 2 秒的空白屏幕。浏览器仅在渲染整个页面时才显示内容，包括跨域内容，这需要一些时间。

页面加载后是否可以运行该脚本？我没有两个服务器权限，因此不能将 onLoad 添加到 body 标记。我尝试了很多脚本，没有一个成功。每个人都在放弃：ajaxinclude 没有定义。

目前我正在使用：

```
<script type="text/javascript">ajaxinclude("http://domain")</script> 
```

这没有什么区别：

```
<script type="text/javascript">
  function load(){
    ajaxinclude("http://domain");
  } window.onload = load();</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:07:55.927

您正在立即调用负载。. 将负载的引用分配给 window.onload 而不是其返回值。

```
<script type="text/javascript">
  function load(){
    ajaxinclude("http://domain");
  } window.onload = load; // give function reference to onload

</script> 
```

# apache - Apache 默认主机

> ID：15935350
> 
> 赞同：1
> 
> 时间：2013-04-10T20:02:58.000
> 
> 标签：apache, web

我有 Apache2，它的文档根结构是：

```
/var/www/html
---index.html
---example.com
------/index.html 
```

我希望对 my-site.com 的所有请求都指向`example.com/index.html`并提供所有其他请求`from /var/www/html`。

这是我的配置：

```
<VirtualHost _default_:80>
    DocumentRoot /var/www/html
</VirtualHost>

<VirtualHost *:80>
    ServerName my-site.com
    DocumentRoot /var/www/html/example.com
</VirtualHost> 
```

但是所有请求都来自 Apache 文档根目录。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:52:41.263

在第二个虚拟主机之前，您需要在配置中的某处有一个 NameVirtualHost 指令。

```
<VirtualHost _default_:80>
    DocumentRoot /var/www/html
</VirtualHost>

NameVirtualHost *:80

<VirtualHost *:80>
    ServerName my-site.com
    DocumentRoot /var/www/html/example.com
</VirtualHost> 
```

# c - Inserting a string into a Binary Search Tree C

> ID：15935352
> 
> 赞同：1
> 
> 时间：2013-04-10T20:02:58.863
> 
> 标签：c, string, search, binary-tree, binary-search-tree

I need to insert strings into a binary search tree but each run through my insert function updates all the nodes and not just the appropriate one. Its required that each word placed in the binary search tree has the exact amount of memory allocated for it (+1 for the NULL pointer).

Here's the struct being used:

```
typedef struct node_t{
   char *word;
   struct node_t *left, *right;
} node_t; 
```

Here's how I am passing in the word:

```
for(i=0; i< original_words -1; i++)
{
    fscanf(ifp, "%s", y);
    head = insert(head, y);
} 
```

And here's my insert function:

```
node_t *insert(struct node_t *head, char *word)
{

if(strcmp(head->word, word) > 0)
{

    if(head->left == NULL)
    {
        head->left = create_node(word);
    }
    else
    {
        head->left = insert(head->left, word);
    }
}

else
{
    if(head->right == NULL)
    {
        head->right = create_node(word);
    }
    else
    {
        head->right = insert(head->right, word);
    }
}

return head;

} 
```

EDIT: Heres an example of the input file.

```
4
-------
bravo
-------
alpha
-------
gamma
-------
delta 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:18:00.503

Your answer (the `insert` function) assumes that `head` has already been defined on first call, it should start with the line:

```
if (head == null) return create_node(word); 
```

This will also save you from the need for the null lines in the code. I'm not sure that this is *the* issue, but it is one.

Perhaps more important: how does `create_node` set up `word`? If it's something like:

```
 new_node->word = word 
```

Then all you are doing is creating a collection of pointers to the word pulled out of the file. It is quite possible that each reading of a word from the file reads the word into the same piece of memory, so all you are doing is collecting a tree of pointers to the same place in memory. It should be something like:

```
 new_node->word = malloc(strlen(word)+1);
 if (new_note->word == null) {FAIL MEMORY LOSS}
 strcpy(new_node->word, word); 
```

# c# - Web 应用程序在托管后不起作用

> ID：15935354
> 
> 赞同：2
> 
> 时间：2013-04-10T20:03:03.157
> 
> 标签：c#, asp.net-mvc-4, hosting

我使用 C# 和 ASP.NET MVC 4（移动模板应用程序）在 Visual Studio 2010 中制作了一个 Web 应用程序。现在，当我通过 Visual Studio 运行它时，它运行良好。但现在我将它托管在我的网站上，我不断收到此错误：

“/test”应用程序中的服务器错误。

无法加载一种或多种请求的类型。检索 LoaderExceptions 属性以获取更多信息。

说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.Reflection.ReflectionTypeLoadException：无法加载一种或多种请求的类型。检索 LoaderExceptions 属性以获取更多信息。

源错误：

在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。

```
[ReflectionTypeLoadException: Unable to load one or more of the requested types.      Retrieve the LoaderExceptions property for more information.]
System.Reflection.RuntimeModule.GetTypes(RuntimeModule module) +0
System.Reflection.RuntimeModule.GetTypes() +4
System.Reflection.Assembly.GetTypes() +78
System.Data.Entity.ModelConfiguration.Mappers.TypeMapper.<.ctor>b__1(Assembly a) +11
System.Linq.<SelectManyIterator>d__14`2.MoveNext() +238
System.Collections.Generic.List`1.InsertRange(Int32 index, IEnumerable`1 collection) +395
System.Data.Entity.ModelConfiguration.Mappers.TypeMapper..ctor(MappingContext mappingContext) +253
System.Data.Entity.DbModelBuilder.MapTypes(EdmModel model) +114
System.Data.Entity.DbModelBuilder.Build(DbProviderManifest providerManifest, DbProviderInfo providerInfo) +112
System.Data.Entity.DbModelBuilder.Build(DbConnection providerConnection) +59
System.Data.Entity.Internal.LazyInternalContext.CreateModel(LazyInternalContext internalContext) +62
System.Data.Entity.Internal.RetryLazy`2.GetValue(TInput input) +117
System.Data.Entity.Internal.LazyInternalContext.InitializeContext() +453
System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType) +18
System.Data.Entity.Internal.Linq.InternalSet`1.Initialize() +56
System.Data.Entity.Internal.Linq.InternalSet`1.get_InternalContext() +15
System.Data.Entity.Internal.Linq.InternalSet`1.ActOnSet(Action action, EntityState newState, Object entity, String methodName) +67
System.Data.Entity.Internal.Linq.InternalSet`1.Add(Object entity) +150
System.Data.Entity.DbSet`1.Add(TEntity entity) +42
PrayerTimes.Models.MosqueRepository.AddError(String error) in MosqueRepository.cs:74
PrayerTimes.Controllers.MosqueController.Index() in MosqueController.cs:57
lambda_method(Closure , ControllerBase , Object[] ) +40
System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) +17
System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) +188
System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +27
System.Web.Mvc.Async.<>c__DisplayClass42.<BeginInvokeSynchronousActionMethod>b__41()+28
System.Web.Mvc.Async.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _) +12
System.Web.Mvc.Async.WrappedAsyncResult`1.End() +50
System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethod(IAsyncResult syncResult) +29
System.Web.Mvc.Async.<>c__DisplayClass39.<BeginInvokeActionMethodWithFilters>b__33() +59
System.Web.Mvc.Async.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49() +240
System.Web.Mvc.Async.<>c__DisplayClass37.<BeginInvokeActionMethodWithFilters>b__36(IAsyncResult asyncResult) +12
System.Web.Mvc.Async.WrappedAsyncResult`1.End() +50
   System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethodWithFilters(IAsyncResult asyncResult) +31
System.Web.Mvc.Async.<>c__DisplayClass2a.<BeginInvokeAction>b__20() +23
System.Web.Mvc.Async.<>c__DisplayClass25.<BeginInvokeAction>b__22(IAsyncResult asyncResult) +128
System.Web.Mvc.Async.WrappedAsyncResult`1.End() +50 
```

System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeAction(IAsyncResult asyncResult) +26 System.Web.Mvc.<>c_ *DisplayClass1d.b* _18(IAsyncResult asyncResult) +14 System.Web.Mvc.Async.<>c_ *DisplayClass4.b* _3(IAsyncResult ar) +25 System.Web.Mvc.Async.WrappedAsyncResult `1.End() +55 System.Web.Mvc.Controller.EndExecuteCore(IAsyncResult asyncResult) +41 System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +25 System.Web.Mvc.Async.WrappedAsyncResult`1.End() +55 System.Web.Mvc.Controller.EndExecute(IAsyncResult asyncResult) +28 System.Web.Mvc.Controller.System.Web。 Mvc.Async.IAsyncController.EndExecute(IAsyncResult asyncResult) +10 System.Web.Mvc.<>c_ *DisplayClass8.b* _3(IAsyncResult asyncResult) +28 System.Web.Mvc.Async.<>c_ *DisplayClass4.b*_3(IAsyncResult ar) +25 System.Web.Mvc.Async.WrappedAsyncResult`1.End() +55 System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +30 System.Web.Mvc.MvcHandler.System.Web .IHttpAsyncHandler.EndProcessRequest(IAsyncResult 结果) +9 System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8970141 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +184

我曾尝试在线搜索解决方案，并且遇到了很多，我尝试过但似乎没有任何效果。解决方案之一是使用它：

```
try
{
 //The code that causes the error goes here.
}
catch (ReflectionTypeLoadException ex)
{
StringBuilder sb = new StringBuilder();
foreach (Exception exSub in ex.LoaderExceptions)
{
    sb.AppendLine(exSub.Message);
    if (exSub is FileNotFoundException)
    {
        FileNotFoundException exFileNotFound = exSub as FileNotFoundException;
        if(!string.IsNullOrEmpty(exFileNotFound.FusionLog))
        {
            sb.AppendLine("Fusion Log:");
            sb.AppendLine(exFileNotFound.FusionLog);
        }
    }
    sb.AppendLine();
 }
 string errorMessage = sb.ToString();
 //Display or log the error based on your application.
 } 
```

我在我的数据库中创建了一个错误表，并尝试将上述代码中的错误添加到表中，但这也不起作用。任何人都可以帮忙吗？非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-10T20:08:45.803

托管时的 MVC 错误通常意味着 MVC 未安装在服务器上，因此无法加载所需的 DLL 之一。

您可以通过将所有 DLL 复制到应用程序的 bin 目录来解决此问题。

如果您在项目中的 MVC 内容（System.Web.Mvc、System.Web.Routing 等）的引用上将“复制本地”标志设置为 true，它会将它们复制到 bin 目录以供您发布. 有一个更简单的方法，但我忘记了捷径。

**编辑**

[这是](https://stackoverflow.com/a/10441585/111266)- 可部署的依赖项。但如果评论是准确的，这个功能是在 VS2010 中，但在 VS2012 中被删除，所以你仍然需要做“复制本地”的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:48:09.070

当您有一个网站项目并且您的计算机上一切正常并且托管网站上有些事情不正确时，因此我建议您执行以下工作：

> *   **检查**项目的 .net 框架版本与主机上 Web 服务器的 .net 框架版本。他们必须是平等的。
>     
>     
> *   **将项目中所有引用的文件复制**到托管网站（本地 bin ---to---> 托管 bin）
>     
>     
>     *   对于这项工作，您可以将项目中每个引用的“**复制到本地**”属性设置为“真”。例如，对于 MVC 项目，您可以遵循此指南页面：[“部署 ASP.NET MVC 应用程序”](http://msdn.microsoft.com/en-us/library/dd410407%28v=vs.90%29.aspx)
>         
>         
>     *   找到引用文件的所有**依赖**，复制到宿主机的bin文件夹中（可以使用VS的**Add Deployable Dependencies特性）**
>         
>         
> *   检查主机上文件和文件夹的**读写权限**（临时文件夹、日志文件夹、上传文件夹和...）
>     
>     
> *   再次检查项目以**更改本地地址并将其转换为相对地址**（e:\a\b\website\images\1.jpg... =to=> images\1.jpg 或 http://localhost/images/ 1.jpg =to=> 图像/1.jpg)
>     
>     
> *   **当您更改某些基本设置（例如 .net 版本）时，重新启动主机上的某些服务**（例如 Web 服务器或...）。
>     
>     
> *   如果您使用一些**COM 引用**，请检查它们是否安装在具有相同版本的目标计算机上
>     
>     
> 
> **编辑：**
> 
> *   检查**“ [ASP.NET 应用程序的信任级别](http://msdn.microsoft.com/en-us/library/wyts434y.aspx)”**：

```
 <system.web>
        <securityPolicy>
              <trustLevel name="Full" policyFile="internal"/>
        </securityPolicy>
    </system.web> 
```

**编辑：** 在这个问题中，您可以使用以下方法（@BenGripka）测试您的代码：

这个错误没有真正的灵丹妙药答案。关键是要有所有的信息来理解问题。动态加载的程序集很可能缺少引用的程序集。该程序集需要位于应用程序的 bin 目录中。

使用此代码来确定缺少什么。

```
using System.IO;
using System.Reflection;

try
{
    //The code that causes the error goes here.
}
catch (ReflectionTypeLoadException ex)
{
    StringBuilder sb = new StringBuilder();
    foreach (Exception exSub in ex.LoaderExceptions)
    {
        sb.AppendLine(exSub.Message);
        if (exSub is FileNotFoundException)
        {
            FileNotFoundException exFileNotFound = exSub as FileNotFoundException;
            if(!string.IsNullOrEmpty(exFileNotFound.FusionLog))
            {
                sb.AppendLine("Fusion Log:");
                sb.AppendLine(exFileNotFound.FusionLog);
            }
        }
        sb.AppendLine();
    }
    string errorMessage = sb.ToString();
    //Display or log the error based on your application.
} 
```

# php - 混合 PHP Echo 和 Javascript

> ID：15935357
> 
> 赞同：0
> 
> 时间：2013-04-10T20:03:15.113
> 
> 标签：php, javascript, string, echo, quotes

我有一个奇怪的问题

```
echo "<tr><td onmouseover="xmlhttpPost('obrada.php', 'prva', 'osx-modal-data'); return false;">
<a href='#' class='osx'>".$row->COUNTRY."</a></td>"; 
```

问题出在'在函数Javascript中我必须拥有'和“当我写这种只是在普通HTML中的退出时一切都很好，但是当我在PHP中使用它退出时出现错误？问题是当我改变

`"xmlhttpPost('obrada.php', 'prva', 'osx-modal-data'); return false;"`

至

`'xmlhttpPost('obrada.php', 'prva', 'osx-modal-data'); return false;'`

功能不工作？？我不知道为什么？

提前回复

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:05:41.167

```
 echo "<tr><td onmouseover=\"xmlhttpPost('obrada.php', 'prva', 'osx-modal-data'); return false;\"><a href='#' class='osx'>".$row->COUNTRY."</a></td>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:05:41.583

在你的 js 中添加斜杠： 'xmlhttpPost(\'obrada.php\', \'prva\', \'osx-modal-data\'); 返回错误；'

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:10:56.933

You need to escape your quotes. Escaping tells PHP to not consider those quotes as part of the processed code. It still process normally for Javascript though.

```
 echo "<tr><td onmouseover=\"xmlhttpPost('obrada.php', 'prva', 'osx-modal-data'); return false;\"><a href='#' class='osx'>\".$row->COUNTRY.\"</a></td>"; 
```

Escaping allows you to use whichever quotes you prefer/need.

# ms-access - 访问报告显示 # 而不是日期

> ID：15935359
> 
> 赞同：1
> 
> 时间：2013-04-10T20:03:18.947
> 
> 标签：ms-access

我的访问报告显示**#####**而不是在行中显示**日期**时间值。当我点击它时，##### 会变成实际日期，就好像它隐藏在它后面一样。我已经尝试将日期格式更改为相关表以及报告的格式属性中`Long Date` `Medium Date`的**日期**格式，但它根本不起作用。为什么会这样？`Short Date`

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T07:06:49.853

您遇到的问题可能是因为文本框（或其他控件）中没有足够的空间来显示您需要的值。

您可以通过增加控件的大小或减小您正在使用的字体的大小来解决此问题。

另一种方法是将要显示的值转换为字符串。由于您正在处理日期，我建议您使用该`format$()`功能。例如：

```
=format$([yourDateField],'yyyy-mm-dd') 
```

将以年-月-日格式返回日期。查看在线帮助以了解有关此功能的更多信息。

希望这可以帮助你**

# jquery - 如何使用 jQuery 分配内部文本？

> ID：15935360
> 
> 赞同：0
> 
> 时间：2013-04-10T20:03:22.157
> 
> 标签：jquery, css

以下 jsfiddle 使用此示例：

```
<span id="test1">some text</span>
<span id="test2">some text</span> 
```

负载

```
alert($('test1').text();
$('test2').text('different text'); 
```

但是，当警报出现时，它会说：

```
"http://fiddle.jshell.net" 
```

并且 text2 未分配。有人知道我在做什么错吗？

[http://jsfiddle.net/EuwMQ/1/](http://jsfiddle.net/EuwMQ/1/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-10T20:04:56.263

有2个问题：

*   缺少括号
*   缺少的 # 按 id 查找元素

尝试这个 ：

```
alert($('#test1').text());
$('#test2').text('different text'); 
```

在调试 JavaScript 时，最好使用`console.log`而不是`alert`: ，这样更方便。[打开控制台](https://developers.google.com/chrome-developer-tools/docs/console)也会显示第一个语法错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T20:04:36.773

您缺少哈希标签。

应该：

```
$('#test2').text('different text'); 
```

# c++ - #define 指令内存存储

> ID：15935361
> 
> 赞同：1
> 
> 时间：2013-04-10T20:03:23.330
> 
> 标签：c++, c

当我声明类似

```
#define VAR 1 
```

1 值将存储在哪里？我不认为在堆中，也不在堆栈中..它可以在 .bss 部分吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-10T20:05:58.730

它没有存储在任何地方。它仅在编译的预处理阶段使用。您可以将其视为在整个代码中替换为`VAR`with的文本。`1`完成此操作后，宏本身不再存在于您的程序中。

考虑以下示例：

```
#define VAR 1
int x = VAR; 
```

这被简单地预处理为：

```
int x = 1; 
```

然后将*这段*代码编译为 C++。所以宏`VAR`根本不占用任何空间。但是，由 定义的对象`x`可能很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-10T20:06:04.300

这`#define`纯粹是一个预处理人工制品。如果不使用宏，它的值甚至不会到达编译器。如果使用它*，*那么您问题的答案将取决于*它*的使用方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-10T20:05:56.607

它存储*在您实际使用的任何地方`VAR`*，因为您在这里定义的只是预处理器的文本替换规则。

```
#define VAR 1
int x = VAR; 
```

在编译源代码之前，预处理器会将其减少为：

```
int x = 1; 
```

在这种情况下，该`1`值存储在`x`. 该`VAR`符号在编译之前被有效擦除。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-10T20:34:28.910

如果您使用的是 gcc，则可以将其与选项 -E 一起使用。使用此选项，您可以看到源代码的输出，其中执行了 #defines 替换（还有 #includes 等）

```
gcc -E whatever_file.c 
```

在调试复杂的宏时非常有用

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-10T20:08:30.270

编译器将在生成目标代码时将程序中使用的所有#define 变量替换为值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-10T20:07:29.780

It is only `#define VAR 1`. so only... defines. It will not cause any memory allocation, it is used only by a **preprocessor** to sabstitute all ocurrences of `VAR` with defined value 1\. Just a textual concept.

# javascript - 在没有 Float32Array 的 Javascript 中将“float”转换为字节

> ID：15935365
> 
> 赞同：8
> 
> 时间：2013-04-10T20:03:44.013
> 
> 标签：javascript, floating-point, type-conversion

好的，所以我是一个相当烦人的情况，我无法访问诸如 Float32Array 之类的类型化数组，但仍然需要能够将 Javascript 数字转换为字节。现在，我可以处理一个整数，但我不知道如何处理浮点值。

我已经解决了以另一种方式（字节转换为浮点）的问题，但是关于从浮点转换为字节的文档非常稀缺，因为大多数语言只是让您读取指针或具有处理它的通用类。

理想情况下，我希望能够将浮点数转换为 4 字节和 8 字节表示，并选择使用哪一个。但是，可以简单地获取一个数字并将其输出为 8 字节的代码仍然很棒，因为我自己可能会从那里想出 32 位版本。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T17:23:34.387

好的，所以我实际上想通了，所以我将分享我的单精度和双精度解决方案。现在我不能保证它们 100% 符合标准，但它们不需要循环并且似乎工作得很好：

单精度（给定一个十进制值输出一个具有二进制表示的单个 32 位大端整数）：

```
function toFloat32(value) {
    var bytes = 0;
    switch (value) {
        case Number.POSITIVE_INFINITY: bytes = 0x7F800000; break;
        case Number.NEGATIVE_INFINITY: bytes = 0xFF800000; break;
        case +0.0: bytes = 0x40000000; break;
        case -0.0: bytes = 0xC0000000; break;
        default:
            if (Number.isNaN(value)) { bytes = 0x7FC00000; break; }

            if (value <= -0.0) {
                bytes = 0x80000000;
                value = -value;
            }

            var exponent = Math.floor(Math.log(value) / Math.log(2));
            var significand = ((value / Math.pow(2, exponent)) * 0x00800000) | 0;

            exponent += 127;
            if (exponent >= 0xFF) {
                exponent = 0xFF;
                significand = 0;
            } else if (exponent < 0) exponent = 0;

            bytes = bytes | (exponent << 23);
            bytes = bytes | (significand & ~(-1 << 23));
        break;
    }
    return bytes;
}; 
```

双精度（给定一个十进制值输出两个 32 位整数，二进制表示为大端序）：

```
function toFloat64(value) {
    if ((byteOffset + 8) > this.byteLength) 
        throw "Invalid byteOffset: Cannot write beyond view boundaries.";

    var hiWord = 0, loWord = 0;
    switch (value) {
        case Number.POSITIVE_INFINITY: hiWord = 0x7FF00000; break;
        case Number.NEGATIVE_INFINITY: hiWord = 0xFFF00000; break;
        case +0.0: hiWord = 0x40000000; break;
        case -0.0: hiWord = 0xC0000000; break;
        default:
            if (Number.isNaN(value)) { hiWord = 0x7FF80000; break; }

            if (value <= -0.0) {
                hiWord = 0x80000000;
                value = -value;
            }

            var exponent = Math.floor(Math.log(value) / Math.log(2));
            var significand = Math.floor((value / Math.pow(2, exponent)) * Math.pow(2, 52));

            loWord = significand & 0xFFFFFFFF;
            significand /= Math.pow(2, 32);

            exponent += 1023;
            if (exponent >= 0x7FF) {
                exponent = 0x7FF;
                significand = 0;
            } else if (exponent < 0) exponent = 0;

            hiWord = hiWord | (exponent << 20);
            hiWord = hiWord | (significand & ~(-1 << 20));
        break;
    }

    return [hiWord, loWord];
}; 
```

对复制/粘贴中的任何错误表示歉意，代码也省略了对字节顺序的任何处理，尽管添加起来相当容易。

感谢大家提出建议，但我最终还是靠自己解决了问题，因为我想尽可能避免循环以提高速度；它仍然不是非常快，但它会做=）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:37:49.510

请参阅 BinaryParser.encodeFloat[此处](http://jsfromhell.com/classes/binary-parser)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-16T17:04:18.683

您可以使用 IEEE 754 的 JavaScript 实现，如[http://ysangkok.github.io/IEEE-754/index.xhtml](http://ysangkok.github.io/IEEE-754/index.xhtml)中的实现。它使用 Emscripten 和 gmp.js。

# ruby - 如何使 Dir[] 和 Dir.foreach 以确定的顺序返回结果？

> ID：15935370
> 
> 赞同：1
> 
> 时间：2013-04-10T20:04:23.977
> 
> 标签：ruby, testing, filesystems

我正在尝试使用`Dir[]`和/或使用以下内容来全局目录`Dir.foreach`：

```
files = Dir["#{options[:dir]}/**/*"].reject { |file| File.directory?(file) }
puts files.map{|filename| filename.join("\n") 
```

和：

```
def print_tree(dir = ".", nesting = 0)
  Dir.foreach(dir) do |entry|
    next if entry =~ /^\.{1,2}/ # Ignore ".", "..", or hidden files
    puts "| " * nesting + "|-- #{entry}"
    if File.stat(d = "#{dir}#{File::SEPARATOR}#{entry}").directory?
      print_tree(d, nesting + 1)
    end
  end
end 
```

我正在尝试用[Cucumber 和 Aruba](https://github.com/cucumber/aruba)对此进行测试。这是我的内容`listing_files.feature`：

```
When I run `poet ls`
Then the output should contain exactly:
"""
foo/bar/conf1
foo/conf2.disabled

""" 
```

和：

```
Then the output should contain exactly:
"""
|-- foo
| |-- bar
| | |-- conf1
| |-- conf2.disabled

""" 
```

在我的本地机器上进行测试（OSX）很好，但我在 Travis 上遇到了这个失败：

```
expected: "foo/bar/conf1\nfoo/conf2.disabled\n"
got: "foo/conf2.disabled\nfoo/bar/conf1\n" (using ==) 
```

显然，返回结果的顺序在所有系统上都不相同。这是1.9.3 和 2.0的[记录行为：](http://ruby-doc.org/core-2.0/Dir.html#method-c-glob)

> 请注意，区分大小写取决于您的系统（因此忽略 File::FNM_CASEFOLD），返回结果的顺序也是如此。

这使得测试目录列表成为一场噩梦。我可以以某种方式强制命令吗？或者如果没有，是否有最佳实践来综合测试这样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:11:01.737

`Dir[]`您总是可以在返回之前对调用结果进行排序：

```
def print_tree(dir = ".", nesting = 0)
  Dir.entries(dir).sort.each do |entry|
    # the rest is the same...
  end
end 
```

或者，如果您有两个目录列表数组，请先在测试中对它们进行排序，然后再进行比较。

此外，如果您使用的是 RSpec，您可以通过使用`=~`运算符获得数组内容而不是 order/contents：

```
arr1 = Dir['*.whatever']
arr2 = some_method_that_gets_the_dir_listing()
arr2.should =~ arr1 
```

在 Test::Unit 中，同样可以使用`assert_same_elements`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:18:51.390

如果您不关心顺序，您可以随时使用`include`带有 splat 的匹配器来解压您的数组

```
[1,2,3,4,5].should include(*[5,2,4,1,3]) 
```

# servlets - Jetty 中每个应用程序 WAR 一个 JVM？

> ID：15935375
> 
> 赞同：1
> 
> 时间：2013-04-10T20:04:43.447
> 
> 标签：servlets, jetty, war

我正在使用 Jetty 8 来运行一些 servlet。我有两个（或更多）应用程序共享源代码，我想在同一个端口（即 8080）上运行它们。我已将两个不同的 WAR 文件放入 Jetty 中，`one.war`并且`two.war`，以便我访问它们，例如，

*   `http://localhost:8080/one`
*   `http://localhost:8080/two`

两个 WARS 都包含一个相同的公共 JAR 文件（common utils）。每个 WAR 应用程序是否都有自己的 JVM？真的，我只是想确保公共 JAR 类是完全独立的，因为有些类是静态的，我需要两个应用程序显然不能共享对同一个静态类的访问。

这似乎很明显，我似乎证实了这种情况是，公共类是为每个 WAR 单独加载的，具有一个简单的测试场景（两个相同的 WAR 托管在同一个 Jetty 实例中，但路径不同......见上文） . 但我缺乏书面文件或确认是这种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:10:58.830

Each WAR file will have its own class loader see [http://docs.codehaus.org/display/JETTY/Classloading](http://docs.codehaus.org/display/JETTY/Classloading). So you can safely use static classes.

# python - Django 1.5 中的转储数据/加载数据

> ID：15935377
> 
> 赞同：1
> 
> 时间：2013-04-10T20:04:44.867
> 
> 标签：python, django, loaddata, dumpdata

我正在寻求帮助，使用 Django1.5/Python2.7.3。

我有两个应用程序 A 和 B。A 等于 B，唯一的区别是 ID，但标题和 slug 是相等的。

我想知道是否可以用“loaddata”导入A> B和B> A，

```
Example:
python manage.py dumpdata myapp.A > a.json

Here loadata myapp.B
python manage.py loaddata a.json 
```

这个想法是插入没有“B”的内容，但如果它包含“A”，我的问题就是 pk。

有什么建议么。

*****更新*******

 **最后通过使用自然键序列化键（pk）来修复它。 [Django 序列化器自然键](https://docs.djangoproject.com/en/dev/ref/django-admin/#django-admin-option---natural)

谢谢。**

# php - 如何 $_GET 多个复选框值？

> ID：15935381
> 
> 赞同：3
> 
> 时间：2013-04-10T20:05:01.800
> 
> 标签：php, html, checkbox, get

```
<input type="checkbox" name="currency" value="usd"/>
<input type="checkbox" name="currency" value="euro"/>
<input type="checkbox" name="currency" value="cad"/> 
```

我试图通过 $_GET 请求获取货币值，类似于`/?currency=usd,cad`但我得到`/?currency=usd&currency=cad` 然后`$_GET['currency']`只返回一个值。

添加`name=currency[]`只是得到`/?currency[]=usd&currency[]=cad`

在某种数组中获取这些复选框值的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T20:07:45.710

HTML：

```
<input type="checkbox" name="currency[]" value="usd"/>
<input type="checkbox" name="currency[]" value="euro"/>
<input type="checkbox" name="currency[]" value="cad"/> 
```

PHP：

```
<?php
foreach($_GET['currency'] as $currency){
  echo $currency."<br/>";
  //or what ever
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:07:22.493

试试这个方法：name="currency[]"

我们必须告诉服务器端这是一个具有多个值的名称。

$_GET['currency'] 必须是这样的数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:09:54.520

在您的 html 中，使复选框名称：

```
<input type="checkbox" name="currency[]" value="usd"/> 
```

这会将检查值添加到数组中。您的方法，每张支票都会覆盖您的最后一张支票`$_GET`

# printf - Notepad++ 特殊字符串字符高亮

> ID：15935387
> 
> 赞同：4
> 
> 时间：2013-04-10T20:05:26.990
> 
> 标签：printf, notepad++, highlighting

如果我有代码，在记事本++中

```
 printf("Hello, World\n"); 
```

整个字符串 '"Hello, World\n"' 是一种颜色，但在 vim 等编辑器中 '\n' 是不同的颜色，表示它是一个特殊字符。在记事本++中有这种行为吗？vim 的一个特别好的功能是突出显示一些陌生的 printf 语法，例如 '% 5.3s' 或 '%%'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:24:55.530

如果您不介意编辑一些 xml，我相信您可以在`stylers.xml`其中保存 Notepad++ 的所有语法突出显示设置的位置进行适当的设置。它通常位于`%APPDATA%\Notepad++\`

这是维基：

[http://sourceforge.net/apps/mediawiki/notepad-plus/index.php?title=Editing_Configuration_Files](http://sourceforge.net/apps/mediawiki/notepad-plus/index.php?title=Editing_Configuration_Files)

否则，您可以尝试在线查找主题并将其导入`settings->import->import theme`

# twitter-bootstrap - 可以一次在轮播中显示两张幻灯片吗？

> ID：15935389
> 
> 赞同：2
> 
> 时间：2013-04-10T20:05:29.047
> 
> 标签：twitter-bootstrap, angularjs, carousel, angular-ui, angular-ui-bootstrap

我刚开始学习 Angular.js，我在 Angular-ui 中使用 Carousel 控件。是否可以同时显示两张幻灯片而不是一张？

我想显示这样的图像 -

```
< image 1 image 2 >
then
< image 3 image 4 >
then
< image 5 image 6 > 
```

这是一个样本 -

[http://plnkr.co/edit/BnErmMDl8nPvXPrw3ULu?p=preview](http://plnkr.co/edit/BnErmMDl8nPvXPrw3ULu?p=preview)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-10T20:44:11.240

您可以将图像组合在一起，也可以将这些图像组合在一起`ng-repeat`。除了一些需要的样式修复之外，方法如下：

[http://plnkr.co/edit/5JFeZgTup7abIsjxOeqi?p=preview](http://plnkr.co/edit/5JFeZgTup7abIsjxOeqi?p=preview)

HTML：

```
<carousel interval="myInterval">
  <slide ng-repeat="slideCollection in groupedSlides" active="slide.active">
    <div>
      <img ng-src="{{slideCollection.image1.image}}" style="margin:auto;">      
      <img ng-src="{{slideCollection.image2.image}}" style="margin:auto;">      
    </div>
  </slide>
</carousel> 
```

JavaScript：

```
$scope.$watch('slides', function(values) {
  var i, a = [], b;

  for (i = 0; i < $scope.slides.length; i += 2) {
    b = { image1: $scope.slides[i] };

    if ($scope.slides[i + 1]) {
      b.image2 = $scope.slides[i + 1];
    }

    a.push(b);
  }

  $scope.groupedSlides = a;
}, true); 
```

# php - LDAP 过滤器中的否定表达式在 PHP 中返回错误过滤器

> ID：15935401
> 
> 赞同：2
> 
> 时间：2013-04-10T20:06:28.983
> 
> 标签：php, filter, ldap

事情很简单：

> $results = ldap_search( $ldapconn, 'DC=testdomain,DC=com', '(&(objectClass=user)(objectClass=computer))' );

这有效，得到 3 个结果。

但是，否定许多手册和教程中定义的第二个表达式，会在错误搜索过滤器中返回：

> $results = ldap_search( $ldapconn, 'DC=testdomain,DC=com', '(&(objectClass=user)(!objectClass=computer))' );

有什么帮助吗？

> [2013 年 4 月 10 日星期三 16:59:05] [错误] [客户端 127.0.0.1] PHP 警告：ldap_search()：搜索：第 29 行 /var/www/test2.php 中的搜索过滤器错误

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:31:16.917

我认为这是因为我信任 Microsoft Active Directory 的 LDAP 文档：

[http://technet.microsoft.com/en-us/library/aa996205%28v=exchg.65%29.aspx](http://technet.microsoft.com/en-us/library/aa996205%28v=exchg.65%29.aspx)

其他网站提到（！（表达式）），如[http://www.google.com/support/enterprise/static/postini/docs/admin/en/dss_admin/prep_ldap.html](http://www.google.com/support/enterprise/static/postini/docs/admin/en/dss_admin/prep_ldap.html)

# sql - 多个表的 SQL Server 外键

> ID：15935402
> 
> 赞同：6
> 
> 时间：2013-04-10T20:06:31.190
> 
> 标签：sql, sql-server, tsql, foreign-keys, referential-integrity

我有以下数据库架构：

```
members_company1(id, name, ...);
members_company2(id, name, ...);
profiles(memberid, membertypeid, ...);
membertypes(id, name, ...)
[ 
       { id : 1, name : 'company1', ... }, 
       { id : 2, name : 'company2', ... }
]; 
```

因此，每个配置文件都属于来自 company1 或 company2 的某个成员，具体取决于`membertypeid`值

```
members_company1     —————————      members_company2     
————————————————                    ————————————————
id      ——————————&gt; memberid <———————————         id
name               membertypeid                 name
                       /|\
                        |  
                        |  
      profiles          |  
      ——————————        |  
      memberid  ————————+  
      membertypeid 
```

我想知道是否可以在`profiles`表中创建一个外键以实现参照完整性，`memberid`并`membertypeid`配对以引用 members_company1 或 members_company2 表记录？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T14:33:18.220

[如文档](http://msdn.microsoft.com/en-us/library/ms175464%28v=sql.105%29.aspx)中所述（强调我的），外键只能引用一个表：

> 外键 (FK) 是用于在*两个*表中的数据之间建立和强制链接的列或列组合。

但是，如果您想开始清理工作，您可以`members`按照@KevinCrowell 的建议创建一个表，从两个`members_company`表中填充它并用视图替换它们。您可以使用`INSTEAD OF`视图上的触发器将更新“重定向”到新表。这仍然是一些工作，但这将是在不破坏现有应用程序的情况下修复数据模型的一种方法（当然，如果在您的情况下可行）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T21:06:35.110

在不能改变表结构的情况下操作：

**选项1**

引用完整性对您来说有多重要？您是否只在这些表之间进行内部连接？如果您不必为此担心太多，那就不要担心。

**选项 2**

好的，您可能必须对此*做点什么*。也许您确实只有内部联接，但您必须处理与成员表中的任何内容无关的配置文件中的数据。你能创建一个每天或每周运行一次的作业来清理它吗？

**选项 3**

是的，那个也可能行不通。您可以在配置文件表上创建一个触发器来检查对成员表的引用。这远非理想，但它确实保证了即时检查。

**我的意见**

我会选择选项 2。您显然正在处理一个不太理想的模式。为什么要让事情变得更糟。让不良数据搁置一周；每个周末打扫桌子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T21:48:48.637

来吧，你可以创建一个表，但你不能修改 members_company1 或 members_company2？

当新记录插入 members_company 表时，您创建成员表的想法将需要更多操作。
因此，您可以在 members_company1 和 members_company2 上创建触发器 - 这不是修改？

你能做什么的限制是什么？

如果您只需要对 members_company1 和 members_company2 的选择具有兼容性，则创建一个真实的成员表并为 members_company1 和 members_company2 创建视图。
基本选择不知道另一端是视图还是表。

```
CREATE VIEW dbo.members_company1
AS
SELECT id, name 
FROM members
where companyID = 1 
```

您甚至可以使用而不是处理插入、更新和删除

[INSTEAD OF INSERT 触发器](http://msdn.microsoft.com/en-us/library/ms175089%28v=SQL.105%29.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T21:22:02.933

不可以。外键只能引用一个主键，并且无法跨表传播主键。您希望实现的逻辑将需要使用触发器或重组您的数据库，以便所有成员都基于单个表中的核心记录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-10T21:15:40.627

外键不能引用两个表。假设您不想通过合并`members_company1`和`members_company2`表格来更正您的设计，最好的方法是：

将名为`member_company1_id`and的两列添加`member_company2_id`到您的`profiles`表中，并为这两个表创建两个外键并允许`nulls`。然后，您可以添加一个约束以确保其中一列始终存在`null`，而另一列始终不存在。

# javascript - NodeJS 使用 node-static 和 restify 一起

> ID：15935406
> 
> 赞同：1
> 
> 时间：2013-04-10T20:06:51.227
> 
> 标签：javascript, node.js, restify, node-static

我正在为应用程序创建一个简单的测试平台，并将以下代码设置作为我`server.js`的应用程序根目录中的文件：

```
var restify = require('restify'),
    nstatic = require('node-static'),
    fs = require('fs'),
    data = __dirname + '/data.json',
    server = restify.createServer();

// Serve static files
var file = new nstatic.Server('');
server.get(/^\/.*/, function(req, res, next) {
    file.serve(req, res, next);
});

// Process GET
server.get('/api/:id', function(req, res) {
    // NEVER FIRES
}); 
```

它完美地提供静态文件，但是，当我尝试调用它时，`/api`它只是挂起并超时。想象一下，我在这里遗漏了一些愚蠢的东西，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:19:22.487

node-static 调用 next 时出现错误，这意味着它永远不会屈服于其他处理程序。

您可以将其他处理程序移动到 node-static 之上，或者通过拦截它的回调来忽略它的错误。

我在这里制作了一个工作版本：[http ://runnable.com/UWXHRONG7r1zAADe](http://runnable.com/UWXHRONG7r1zAADe)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T20:14:30.233

您可以通过在`get`第一个之前移动第二个来确保捕获 api get 调用。原因是您的 api 调用路由已经与第一个模式匹配。

# qt - 如何从按钮运行线程？

> ID：15935409
> 
> 赞同：0
> 
> 时间：2013-04-10T20:07:00.290
> 
> 标签：qt

主.cpp：

```
#include "mainwindow.h"
#include "myobject.h"
#include <QApplication>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    MainWindow w;
    w.show();

    QThread cThread;
    MyObject cObject;
    cObject.doSetup(cThread);
    cObject.moveToThread(&cThread);
    // cThread.start();

    return a.exec();
} 
```

主窗口.cpp：

```
#include "mainwindow.h"
#include "ui_mainwindow.h"

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);
}

MainWindow::~MainWindow()
{
    delete ui;
}

void MainWindow::on_pushButton_clicked()
{
    // cThread.start();
} 
```

我正在尝试在 on_pushButton_clicked() 上启动线程。为了做到这一点，我必须通过一个参数将 cThread 传递给 mainwindow，对吧？我只是希望有人确认以确保我做对了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:10:06.543

这似乎是一种方法。另一种是将`clicked()`按钮的信号连接到应用程序中的线程插槽`start(Priority)`，这将更好更短。

# php - 将导航栏插入 wordpress

> ID：15935419
> 
> 赞同：0
> 
> 时间：2013-04-10T20:07:35.010
> 
> 标签：php, wordpress, twitter-bootstrap

直截了当：我从 WordPress 安装了**212**主题并更改了它的背景 + 删除了默认导航栏。（注释掉）现在我如何实现浮动在屏幕顶部的引导导航栏。这是导航栏代码：

```
<?php
if(!isset($nosession))
session_start();
}

/*if(isset($_COOKIE['username']))
{
  $_SESSION['username'] = $_COOKIE['username'];
  $_SESSION['loggedin'] = "true";
}*/

?>
<div class="navbar navbar-inverse navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="brand" href="#">IHES</a>
      <div class="nav-collapse collapse">
        <ul class="nav">
          <li><a href="index.php">Home</a></li>
          <li><a href="adopteren.php">Adopteren</a></li>
          <li><a href="webshop.php">WebWinkel</a></li>
          <li><a href="wallofsteen.php">Wall of Steen</a></li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-film" style="margin-top:-1px"></i> Videos <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="nieuws.php"><i class="icon-film"></i>Nieuws</a></li>
              <li><a href="interviews.php"><i class="icon-film"></i>Interviews</a></li>
              <li><a href="overig.php"><i class="icon-film"></i>Overig</a></li>
            </ul>
          </li>
          <li><a href="#contact">Steenoloog Blog</a></li>
        </ul>
        <ul class="nav pull-right">
        <?php
        if(isset($_SESSION['loggedin'])){

          if(isset($_COOKIE['cart']))
          {
            echo '
              <li class="pull-right"><a href="shoppingcart.php"><i class="icon-shopping-cart icon-white"></i></a></li>
            ';
          }
          echo '<li class="navbar-form pull-right">
                  <a href="#">'.$_SESSION['username'].'</a>
                </li>';

          echo '<li class="navbar-form pull-right">
                  <a href="scripts/dologout.php" style="color: #FFF3F3;">Loguit</a>
                </li>';
        }else{
            echo '<div class="navbar-form pull-right">
                  <a href="login.php"><button type="submit" class="btn">Login Pagina</button></a>
                </div>';
        }
        ?>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </div>
</div> 
```

那是我包含在每个 .php 页面顶部的导航栏代码。

```
require "navbar.php"; 
```

但是如何在 wordpress 的 2012 主题中使用它呢？我试图只使用 require 并从引导程序链接到 .css 文件。但这只会给我导航栏的内容。它缺少导航栏本身。（顺便说一句：我将代码粘贴在主题的**header.php**文件中）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:17:24.370

你可以包括CSS吗？也尝试包含而不是要求

# java - 传递给 Mapper 函数（setup、map、run、cleanup）的上下文是否总是相同的？

> ID：15935426
> 
> 赞同：0
> 
> 时间：2013-04-10T20:07:46.583
> 
> 标签：java, hadoop

1.  是否将相同的上下文传递给 Mapper 中的设置、映射、运行、清理？
2.  会有不一样的情况吗？
3.  您可以将上下文作为设置中的成员字段吗？

[映射器](http://grepcode.com/file/repository.cloudera.com/content/repositories/releases/com.cloudera.hadoop/hadoop-core/0.20.2-737/org/apache/hadoop/mapreduce/Mapper.java)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T08:37:18.817

是的，在*同一个*映射器中，它是 , 和 中的同一个*上下文*对象。`setup()``map()``cleanup()`

如您所见，这些方法是从 调用的`run()`，该方法如下所示：

```
public void run(Context context) throws IOException, InterruptedException {
    setup(context);
    while (context.nextKeyValue()) {
      map(context.getCurrentKey(), context.getCurrentValue(), context);
    }
    cleanup(context);
  } 
```

这应该回答您的第 1 点和第 2 点，对于第 3 点，您可以重写 run 方法以获得更多控制权，因为它是 Javadoc 建议的：

> 专家用户可以覆盖此方法，以更完整地控制 Mapper 的执行。

也许您不需要为上下文保留成员字段，但可以肯定。

此外，虽然对象相同，但它的属性值可以在任何方法中设置或取消设置，使其处于与传递给另一个方法（设置、映射或清理）时不同的状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T03:14:18.073

这是[Mapper.Context](http://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/Mapper.Context.html)的文档。给定一个特定的工作，一些属性 like`getJobID()`保持不变，而一些属性 like`getInputSplit()`可能在同一个工作的不同地图中不同。

# vba - VB - 下标超出范围，错误 9

> ID：15935430
> 
> 赞同：0
> 
> 时间：2013-04-10T20:08:00.690
> 
> 标签：vba, compiler-errors, subscript

**我是 VB 新手，收到错误 9，下标超出范围。错误表明它在以下过程中。请让我知道可能是什么问题。感谢您的帮助

```
Private Sub RebuildGrid()
    Const c_strProcedureName As String = "RebuildGrid"
    Dim intIndex As Integer

    On Error GoTo Error_Handler

    For intIndex = 0 To g_intNumNucDataFields - 1
        grdNuclides.Columns(intIndex).DataField = ga_strNucFieldName(intIndex)
        grdNuclides.Columns(intIndex).Visible = False

        If StrComp(ga_strNucFieldFormat(intIndex), "None", vbTextCompare) <> 0 Then
            grdNuclides.Columns(intIndex).NumberFormat = ga_strNucFieldFormat(intIndex)
        End If

        grdNuclides.Columns(intIndex).Width = 1400

        If StrComp(LCase$(ga_strNucFieldUnits(intIndex)), "none", vbTextCompare) = 0 Then
            grdNuclides.Columns(intIndex).Caption = ga_strNucFieldTitle(intIndex)
        Else
            grdNuclides.Columns(intIndex).Caption = ga_strNucFieldTitle(intIndex) & _
            " " & vbCr & "(" & ga_strNucFieldUnits(intIndex) & ") "
        End If
        grdNuclides.Columns(intIndex).FooterText = "Reference"
    Next intIndex

    Exit Sub
Error_Handler:

    gud_PrgErr.Number = Err.Number
    gud_PrgErr.Severity = 5
    gud_PrgErr.Description = Err.Description
    gud_PrgErr.Module = c_strModuleName
    gud_PrgErr.Procedure = c_strProcedureName
    Call Display_UI_Error

End Sub

Private Sub mnuFileExit_Click()
    Unload Me
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:15:23.837

确保`g_intNumNucDataFields`不高于列数（例如`grdNuclides.Columns.Count`）。

您还可以尝试注释掉错误处理，然后运行它以查看是否获得错误的行号。

# android - 如何从返回堆栈中删除所有先前的片段，使当前片段可见

> ID：15935438
> 
> 赞同：0
> 
> 时间：2013-04-10T20:08:58.220
> 
> 标签：android, android-fragments

有什么办法可以删除后面堆栈中的所有先前片段，只留下堆栈中可见的片段？

# associative-array - 从关联数组中删除任何元素

> ID：15935447
> 
> 赞同：4
> 
> 时间：2013-04-10T20:09:15.783
> 
> 标签：associative-array, d

我想从关联数组中删除一个（y）元素并对其进行处理。目前我正在使用 a`RedBlackTree`和`.removeAny()`，但我不需要数据按任何顺序排列。我*可以*在 AA 上使用`.byKey()`，但这总是会产生一个包含所有键的数组。我一次只需要一个，并且可能会在处理所有其他元素时更改 AA。有没有其他聪明的方法可以在不（内部）遍历整个数据结构的情况下获得一个密钥？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:38:04.893

有一种解决方法，它与使用一样有效`.byKeys()`：

```
auto anyKey(K, V)(inout ref V[K] aa)
{
    foreach (K k, ref inout(V) v; aa)
        return k;
    assert(0, "Associative array hasn't any keys.");
} 
```

对于我的需要，`.byKeys().front`似乎已经足够快了。不确定解决方法是否实际上更快。

# javascript - 从jQuery中的标签名称中获取第一个元素

> ID：15935452
> 
> 赞同：0
> 
> 时间：2013-04-10T20:09:26.323
> 
> 标签：javascript, jquery, dom

我正在将标准 JavaScript 转换为 jQuery 以实现跨浏览器兼容性。我只想知道这将如何用 jQuery 编写？换句话说，我如何找到第一个元素？

```
var x = content.getElementsByTagName("title")[0].firstChild.data; 
```

我尝试了以下方法：

```
var content = $.parseXML(zipEntry1.data);
content = $(content);
var x = content.find("title").first().val(); 
```

和

```
var content = $.parseXML(zipEntry1.data);
content = $(content);
var x = content.find("title")[0].val(); 
```

但这些都不起作用。正确的方法是什么？

**编辑：**

这是一些附加信息。我正在写一个 Epub 阅读器。我正在解析的文件是 Epub 规范中的 content.opf。这是一个摘录：

```
<metadata>
<dc:rights>Public domain in the USA.</dc:rights>
<dc:identifier id="id" opf:scheme="URI">http://www.gutenberg.org/ebooks/6130</dc:identifier>
<dc:contributor opf:file-as="Buckley, Theodore Alois" opf:role="ann">Theodore Alois Buckley</dc:contributor>
<dc:creator opf:file-as="Homer">Homer</dc:creator>
<dc:contributor opf:file-as="Pope, Alexander" opf:role="trl">Alexander Pope</dc:contributor>
<dc:title>The Iliad</dc:title>
<dc:language xsi:type="dcterms:RFC4646">en</dc:language>
<dc:subject>Classical literature</dc:subject>
<dc:subject>Epic poetry, Greek -- Translations into English</dc:subject>
<dc:subject>Achilles (Greek mythology) -- Poetry</dc:subject>
<dc:subject>Trojan War -- Poetry</dc:subject>
<dc:date opf:event="publication">2004-07-01</dc:date>
<dc:date opf:event="conversion">2012-10-31T19:41:56.338029+00:00</dc:date>
<dc:source>http://www.gutenberg.org/files/6130/6130-h/6130-h.html</dc:source> 
```

我可以用这个获得作者和标题，但它只适用于 Chrome：

```
content.find('creator:first').text();
content.find('title:first').text(); 
```

版本适用于 Firefox 和 Chrome：

```
content.find("package").attr("version"); 
```

而且我还没有得到出版日期。这是我尝试过的：

```
 content.find('[event="publication"]').val(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:17:13.563

如果您需要获取第一个标题的文本内容，请使用：

```
$('title:first', content).text(); 
```

但是 Firefox 中的 jQuery 也需要指定命名空间：

```
var ff = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;
$((ff ? 'dc\\:' : '') + 'title:first', content).text(); 
```

工作示例：http: [//jsbin.com/enayex/5/edit](http://jsbin.com/enayex/5/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:17:28.783

如果您知道元素类型，那么这很容易。让我们假设我们正在处理 div，然后这样做：

```
$('div').first().html("<p>I found you</p>"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:12:11.520

像这样的东西？

```
var x = content.find('title:first').html() 
```

或者

```
var x = content.find('title:first').text(); 
```

# qt - 在其他平台上测试WinXP看看？

> ID：15935453
> 
> 赞同：0
> 
> 时间：2013-04-10T20:09:47.543
> 
> 标签：qt

有没有办法在我的 Linux 机器上测试我的 UI 在 Windows 或其他平台上的外观？我想知道它的外观，而不必在 Windows 机器上重建项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:24:16.787

在程序的命令行中，您可以指定样式：

[http://qt-project.org/doc/qt-5.0/qtwidgets/qapplication.html#QApplication](http://qt-project.org/doc/qt-5.0/qtwidgets/qapplication.html#QApplication)

> -style= style，设置应用程序 GUI 样式。可能的值取决于您的系统配置。如果您使用附加样式编译 Qt 或有附加样式作为插件，这些将可用于 -style 命令行选项。您还可以通过设置 QT_STYLE_OVERRIDE 环境变量来设置所有 Qt 应用程序的样式。

在一些[较旧的文档](http://doc.qt.digia.com/4.7/qapplication.html#QApplication)中提到：

> 可能的值是主题、窗口和铂金。

我刚刚在带有 Qt 4.8.4 的 Windows 8 上尝试了这个，我没有改变添加“style=platinum”或其他任何内容，显然我得到的 Qt 版本没有附带额外的样式插件。因此，使用其他样式构建 Qt，然后您可以预览其他操作系统的外观。

希望有帮助。

# drupal-7 - 内容类型的drupal 7元标记

> ID：15935458
> 
> 赞同：3
> 
> 时间：2013-04-10T20:09:40.410
> 
> 标签：drupal-7, meta-tags, page-title

我有不同的自定义内容类型，需要为它们量身定制完全不同的元描述标签。我已经安装了 metatags 模块，但是，它提供了在站点范围内而不是按内容类型添加描述元标记的可能性。页面标题也是如此（不过，这仍然可以通过页面标题模块解决）。所以我想问是否有人可能知道一个好的解决方案？

我也在考虑是否有一种方法可以将条件运算符用于标记，例如，查看是否为特定节点设置了字段，然后将该字段的内容添加到元描述/关键字中。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-11T01:12:27.560

您可以在 /admin/config/search/metatags/config/add 中添加内容类型特定的元标记。有一个下拉列表可让您通过许多实体属性（包括内容类型）创建默认元标记。

我从未将令牌与元标记集成，但它似乎得到了充分的支持。

# javascript - X 轴上的 Google 图表值未正确显示

> ID：15935459
> 
> 赞同：2
> 
> 时间：2013-04-10T20:09:27.637
> 
> 标签：javascript, google-visualization

我有两个图表，它们是由 javascript 以完全相同的方式创建的，其中一个正确显示 x 轴上的值，另一个则没有。

这是交通图 ![在此处输入图像描述](https://i.stack.imgur.com/ZtsRT.png)

如您所见，日期在 x 轴下正确显示，这是生成此图表的代码

```
function drawTrafficChart(processedData, humanReadableName, params) {
    dataArray = [];
    dataArrayRow = ['Date', 'Impressions', 'Detail Page Views'];
    dataArray.push(dataArrayRow);
    for (i in processedData) {
        dateString = processedData[i].date;
        dateString = formatDateStringAccordingToAggregationType(dateString, params);
        dataArrayRow = [dateString, processedData[i].event1, processedData[i].event2];
        dataArray.push(dataArrayRow);
    }

    var dataTable = google.visualization.arrayToDataTable(dataArray);
    var chartOptions = {
        title: 'Traffic Chart',
        hAxis: {title: humanReadableName},
        vAxis: {minValuex: 0},
        pointSize: 5,
        width: 670,
        height: 300
    };
    var chart = new google.visualization.LineChart(document.getElementById('traffic_chart'));
    chart.draw(dataTable, chartOptions);
} 
```

这是点击图表 ![在此处输入图像描述](https://i.stack.imgur.com/4xVmI.png)

这是生成点击图表的代码

```
function drawClickChart(processedData, humanReadableName, params) {
    dataArray = [];
    dataArrayRow = ['Date', 'Website Clicks', 'Image Clicks', 'Video Clicks'];
    dataArray.push(dataArrayRow);
    for (i in processedData) {
        dateString = processedData[i].date;
        dateString = formatDateStringAccordingToAggregationType(dateString, params);
        dataArrayRow = [dateString, processedData[i].event3, processedData[i].event4, processedData[i].event5];
        dataArray.push(dataArrayRow);
    }

    var dataTable = google.visualization.arrayToDataTable(dataArray);
    var chartOptions = {
        title: 'Click Chart',
        hAxis: {title: humanReadableName},
        vAxis: {minValuex: 0},
        pointSize: 5,
        width: 670,
        height: 300
    };
    var chart = new google.visualization.LineChart(document.getElementById('click_chart'));
    chart.draw(dataTable, chartOptions);
} 
```

如您所见，x 轴上的日期搞砸了，我能做些什么来解决这个问题吗？

# android - SQLite 和存储图像

> ID：15935460
> 
> 赞同：13
> 
> 时间：2013-04-10T20:10:02.857
> 
> 标签：android, sqlite

我想知道哪种方式更好地将图像存储在内存中：

*   **将图像**存储在`BLOB`数据库中

或者

*   将图像保存到文件并仅将其**路径**存储在数据库中

什么方法更有效率？我想存储文件的路径需要更多的操作，因为我们需要先引用 DB，然后再引用文件，但我不确定这是否比将整个图像保存在 DB 中效率低。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-10T20:42:33.560

简而言之：

*   如果你的图片比较小，图片数量也比较少，可以直接存入数据库，管理起来更简单。
*   但是，如果您的图像尺寸很大并且图像数量很高，请保存在文件系统中。通常，对于普通移动设备，数据库在 10MB 之前不会显示任何性能问题。

如果您发现任何其他判断标准，请告诉我。

# c++ - 为什么这个模板代码会编译？

> ID：15935461
> 
> 赞同：8
> 
> 时间：2013-04-10T20:10:09.537
> 
> 标签：c++, templates

我正在开发一个大型项目，其中包含一段可编译的代码 - 但我不明白如何。我把它提炼成这个简单的例子：

```
template <typename T>
struct First {
    typedef int type;           // (A)
    typename T::Three order;    // (B)
};

template <typename T> struct Second {
    typedef typename T::type type;
};

template <typename T> struct Third {
    int val;
    T two;
};

struct Traits {
    typedef First<Traits> One;
    typedef Second<One> Two;
    typedef Third<Two> Three;
};

int main(int argc, char** argv) {
    Traits::One x;
}; 
```

该类`First`是模板化的`Traits`和引用`Traits::Three`，它本身是一个`typedef`基于`Two`，它是一个`typedef`基于`First<Traits>`......因此它是循环的。但是这段代码在 gcc4.6 和 VC10 上都可以正常编译。`(A)`但是，如果我翻转标记和的两行的顺序，则代码无法编译，`(B)`抱怨`typedef`.`Second`

为什么这段代码会编译，为什么`typedef`和成员变量的顺序很重要？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:55:48.803

有几件事值得一说。

*   `Second`如果修改为包含，代码将中断

    ```
    T badObject; 
    ```

    由于您期望的循环性，具有较长的“从...实例化”链并以“不完整类型”错误结束，但如果您改为添加

    ```
    typename T::type object; 
    ```

    这告诉你编译器很聪明地观察它**不需要完全封装`T`**，只知道是什么`T::type`。为了说明这一点，请注意您可以合法拥有

    ```
    First { ... typedef T type; ... }
    Second { typename T::type object; } 
    ```

    因为 T 不包含当前定义的*对象*，或者

    ```
    First { ... typedef typename T::One type; ... }
    Second { typedef typename T::type object; } 
    ```

    因为`typedef`in`Second`也不需要任何对象的实例 - 但**不是**，比如说，

    ```
    First { ... typedef typename T::One type; ... }
    Second { typename T::type object; } 
    ```

    因为只有这样，编译器才真正需要将`First<Traits>`对象嵌套在`First<Traits>`对象中。

*   交换 (A) 和 (B) 的问题在于，编译器在上面提取的巧妙技巧是通过引入每个专用模板定义的新副本，一次解析**一行来工作**。如果它没有达到`First`需要知道它的类型定义时，就会发生错误`Second`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:16:23.347

您不需要完整的 a 类型`typedef`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T20:22:46.897

您接受的答案比我提供的要好得多 - 所以我要删除我的答案。但是，我认为您可能对进一步简化您的示例感兴趣。我已将两行标记为 A 和 B，以与您的原始代码相关联。如果您翻转它们，那么就像在您的示例中一样，编译将失败。

```
 template<typename T>
 struct First
 {
      typedef typename T::type type;
 };

 struct Second
 {
      typedef int type;    // (A)
      First<Second> order; // (B)
 };

 int main(int argc, char** argv)
 {
      Second x;
 }; 
```

# tcp - Which header fields characterize a packet as unique?

> ID：15935462
> 
> 赞同：1
> 
> 时间：2013-04-10T20:09:51.730
> 
> 标签：tcp, header, udp, ip, packets

I'm dealing with **IP** packets which might contain **UDP** or **TCP** payloads.

If we only consider IP-level and transport-level **headers**, what could be a **set of representative fields** for one packet? That is, which header fields, considered as a whole, would make that packet unique? (in absence of duplicates, of course)

If we didn't consider the IP and TCP or UDP `chksum` fields, would a subset of the other fields be enough?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:20:31.063

IP 和 UDP 没有“唯一性”的概念。TCP 确实如此，由序列号字段暗示。当数据包在传输过程中被复制或丢弃时，没有足够的字段来明确说明。

**根据评论更新：**

如果您同时编写发送和接收代码，则可以包含一个唯一标识数据包的 IP 选项。我建议使用 SATNET StreamId 选项（#​​8，参见[RFC 791](http://www.ietf.org/rfc/rfc791.txt)，第 3.1 节）——它为您提供了 16 位可供使用，并且已经存在了 30 多年。

如果您不编写发送代码，我认为您不能这样做 - 只是没有任何字段可以在 IP、ICMP 或 UDP 中进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-09T17:43:07.767

您可以使用 IP Header 的可选字段来附加数据以实现唯一性（如果您正在发送），但您需要将 IHL 修改为大于 5。

# jquery - Calling setTimeout jquery function multiple times

> ID：15935464
> 
> 赞同：0
> 
> 时间：2013-04-10T20:10:01.453
> 
> 标签：jquery, settimeout, fadeout

I have this function:

```
<script>
var loop_handle;
var xSeconds = 10000; // 1 second

loop_handle = setInterval(function() {
$('#overlay').fadeOut('fast');
$('#box').hide();
}, xSeconds);
</script> 
```

I wanted to display and fadeout an array of:

```
<div id="overlay">text</div> 
```

But it seems it only works once. How can I make it work for all the arrays or call it multiple times?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:11:56.523

```
var xSeconds = 10000; // 1 second 
```

应该：

```
var xSeconds = 1000; // 1 second 
```

# mysql - 如何在mysql中创建唯一序列

> ID：15935467
> 
> 赞同：1
> 
> 时间：2013-04-10T20:10:30.517
> 
> 标签：mysql, stored-procedures, insert, sequence

如何在 MySQL 中创建唯一的序列号？

情况是这样的，在 row1 中`table1`的数据`"A"`中可以出现不止一次。

因此，当它第一次出现时，将为其分配一个序列号，并且每次再次出现时都会为其分配相同的序列号。

但是数据`"B"`（比如输入的下一个数据）将具有下一个序列号。

所以我不能在这种情况下使用 auto_increment。说，我必须检查这个唯一序列号的条件 c1 和 c2。

寻找一个存储过程来实现这一点。希望我清楚我的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T00:00:31.500

```
CREATE TABLE `seq` (
    `n` BIGINT NOT NULL AUTO_INCREMENT,
    PRIMARY KEY (`n`)
);

DELIMITER $$

DROP PROCEDURE IF EXISTS getseq$$

CREATE FUNCTION getseq() RETURN BIGINT
BEGIN
DECLARE r BIGINT;
    INSERT INTO `seq` (`n`) VALUES (NULL);
    SELECT MAX(`n`) INTO r FROM `seq`;
    COMMIT;
    RETURN r;
END$$

DELIMITER ; 
```

并发事务应该被修改，但我认为它会起作用，因为确实自动增量的标记是跨事务共享的，但不是你在表中插入所产生的 id。

# sql-server - How do I trace database writes in SQL Server?

> ID：15935470
> 
> 赞同：5
> 
> 时间：2013-04-10T20:10:41.563
> 
> 标签：sql-server, profiler

I'm using SQL Server 2008 R2, trying to reverse-engineer an opaque application and duplicate some of its operations, so that I can automate some massive data loads.

I figured it should be easy to do -- just go into SQL Server Profiler, start a trace, do the GUI operation, and look at the results of the trace. My problem is that the filters aren't working as I'd expect. In particular, the "Writes" column often shows "0", even on statements that are clearly making changes to the database, such as `INSERT` queries. This makes it impossible to set a `Writes >= 1` filter, as I'd like to do.

I have verified that this is exactly what's happening by setting up an all-inclusive trace, and running the app. I have checked the table beforehand, run the operation, and checked the table afterward, and it's definitely making a change to the table. I've looked through the trace, and there's not a single line that shows any non-zero number in the "Writes" column, including the line showing the `INSERT` query. The query is nothing special... Just something like

```
exec sp_executesql 
    N'INSERT INTO my_table([a], [b], [c]) 
      values(@newA, @newB, @newC)',
    N'@newA int,@newB int,@newC int', @newA=1, @newB=2, @newC=3 
```

(if there's an error in the above, it's my typo here -- the statement is definitely inserting a record in the table)

I'm sure the key to this behavior is in the description of the "Writes" column: "Number of **physical disk writes** performed by the server on behalf of the event." Perhaps the server is caching the write, and it happens outside of the Profiler's purvue. I don't know, and perhaps it's not important.

Is there a way to reliably find and log all statements that change the database?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:02:53.337

您是否尝试过[服务器端跟踪](http://www.mssqltips.com/sqlservertip/1035/sql-server-performance-statistics-using-a-server-side-trace/)？它还可以记录读取和写入，如果我没看错的话-您想要记录写入。

# c++ - __glibcxx_function_requires 和 __glibcxx_requires_valid_range 宏是如何工作的？

> ID：15935471
> 
> 赞同：10
> 
> 时间：2013-04-10T20:10:49.877
> 
> 标签：c++, stl, macros, accumulate

```
template<typename _InputIterator, typename _Tp, typename _BinaryOperation>
inline _Tp
accumulate(_InputIterator __first, _InputIterator __last, _Tp __init, _BinaryOperation __binary_op)
{
    // concept requirements
    __glibcxx_function_requires(_InputIteratorConcept<_InputIterator>)
    __glibcxx_requires_valid_range(__first, __last);

    for (; __first != __last; ++__first)
        __init = __binary_op(__init, *__first);
    return __init;
} 
```

我查看了 stl 库中累积函数的定义。这里我找到了两个宏__glibcxx_function_requires和__glibcxx_requires_valid_range，它们的定义是这样的：

```
#define __glibcxx_function_requires(...)
# define __glibcxx_requires_valid_range(_First,_Last) 
```

请您向我解释一下，它们是如何工作的以及它们在做什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-10T21:00:05.013

什么时候`_GLIBCXX_CONCEPT_CHECKS`定义，这个也是。

```
#define __glibcxx_function_requires(...)                                 \
         __gnu_cxx::__function_requires< __gnu_cxx::__VA_ARGS__ >(); 
```

所以你发布的代码：

```
__glibcxx_function_requires(_InputIteratorConcept<_InputIterator>) 
```

解决这个问题：

```
__gnu_cxx::__function_requires< _InputIteratorConcept<_InputIterator> >(); 
```

其中内联到：

```
void (_InputIteratorConcept<_InputIterator>::*__x)() _IsUnused = &_InputIteratorConcept<_InputIterator>::__constraints; 
```

这会强制 的实例化，它在不类似于迭代器时`_InputIteratorConcept<_InputIterator>::__constraints`使用`typedef`s 来中断编译。`_InputIterator`

`__glibcxx_requires_valid_range`根据迭代器类型，使用类似的技术来调用[多个函数之一。](http://gcc.gnu.org/onlinedocs/gcc-4.6.0/libstdc++/api/a00890_source.html#l00140)在适当的时候（并且足够快），它会断言`__last`紧随其后`__first`

# javascript - 如果没有调用任何函数，javascript 会执行吗？

> ID：15935473
> 
> 赞同：0
> 
> 时间：2013-04-10T20:10:56.877
> 
> 标签：javascript, performance, wordpress

我有一些带有需要 javascript 文件引用的 javascript 代码的 wordpress 页面。对于不调用这些 js 文件引用中的函数的页面，包含这些文件（文件调用除外）应该不会影响性能，对吧？

-- 编辑回应@cdhowie --

如果只有某些页面需要这些 javascript 文件，是否可以将它们移出 head 部分并进入页面？我读过这是不好的做法。

但从理论上讲，这可以防止整个站点因未使用的文件而受到性能影响？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:12:05.740

引用的 JavaScript 文件将被下载（或从缓存中获取），然后在这两种情况下由浏览器的 JavaScript 解释器执行。需要执行“JavaScript 文件引用”以创建您可能使用的变量和函数，并且浏览器无法提前知道您是否会使用它们。此外，包含的文件实际上可能会操纵文档，而浏览器在执行它们之前也不知道这一点。

所以是的，无论您是否调用这些函数，都会对性能产生影响。它是否足以让您担心是您必须确定的事情。（在做出这样的决定之前，请始终分析您页面的加载时间！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:13:59.127

这将执行，但占用很少的 cpu 时间

```
<script type="text/javascript">
   // just a comment
</script> 
```

没有功能，只是一个注释......但它仍然是“代码”，仍然需要解析，仍然需要检查语法错误等......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T20:20:02.920

Javascript 函数仅在您显式调用它们（或在回调等中隐式调用）时才会执行。然而，无论是否调用函数，该代码仍将由每个页面上的浏览器解释。

编辑：我说性能影响无关紧要是错误的。这实际上完全取决于您的确切情况（代码来自哪里，代码量等）以及您对毫秒性能的关心程度。

一个可能的“性能”问题是那些额外的 .js 文件是否在您的服务器上。如果是这样，并且您在不需要时加载它们，那么您将导致服务器不需要的流量和带宽。

# java - 从 jboss 5 迁移到 7

> ID：15935478
> 
> 赞同：0
> 
> 时间：2013-04-10T20:11:06.557
> 
> 标签：java, jboss, ejb, jboss7.x, ejb-3.1

我的任务是尝试将一些现有的应用程序从 jboss5 迁移到 jboss7。

我对 EJB 或 Hibernate 了解不多，所以这对我来说是一个有趣的挑战。

目前这是我坚持的地方：

```
...
14:42:12,727 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-4) MSC000001: Failed to start service jboss.deployment.subunit."Authorization.ear"."AuthorizationClient-7.0-SNAPSHOT.jar".INSTALL: org.jboss.msc.service.StartException in service jboss.deployment.subunit."Authorization.ear"."AuthorizationClient-7.0-SNAPSHOT.jar".INSTALL: JBAS018733: Failed to process phase INSTALL of subdeployment "AuthorizationClient-7.0-SNAPSHOT.jar" of deployment "Authorization.ear"
    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:123) [jboss-as-server-7.1.3.Final-redhat-4.jar:7.1.3.Final-redhat-4]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA-redhat-2.jar:1.0.2.GA-redhat-2]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA-redhat-2.jar:1.0.2.GA-redhat-2]
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_35]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_35]
    at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_35]
Caused by: org.jboss.as.server.deployment.DeploymentUnitProcessingException: JBAS011058: Failed to install component PermissionManager
    at org.jboss.as.ee.component.deployers.ComponentInstallProcessor.deploy(ComponentInstallProcessor.java:102)
    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:116) [jboss-as-server-7.1.3.Final-redhat-4.jar:7.1.3.Final-redhat-4]
    ... 5 more
Caused by: org.jboss.as.server.deployment.DeploymentUnitProcessingException: JBAS014544: No EJB found with interface of type 'org.calgb.authorization.client.permission.IPermissionCache' for binding org.calgb.authorization.client.permission.PermissionManager/permissionCache
    at org.jboss.as.ejb3.deployment.processors.EjbInjectionSource.getResourceValue(EjbInjectionSource.java:88)
    at org.jboss.as.ee.component.deployers.ComponentInstallProcessor.processBindings(ComponentInstallProcessor.java:252)
    at org.jboss.as.ee.component.deployers.ComponentInstallProcessor.access$000(ComponentInstallProcessor.java:76)
    at org.jboss.as.ee.component.deployers.ComponentInstallProcessor$1.handle(ComponentInstallProcessor.java:206)
    at org.jboss.as.ee.component.ClassDescriptionTraversal.run(ClassDescriptionTraversal.java:54)
    at org.jboss.as.ee.component.deployers.ComponentInstallProcessor.deployComponent(ComponentInstallProcessor.java:202)
    at org.jboss.as.ee.component.deployers.ComponentInstallProcessor.deploy(ComponentInstallProcessor.java:95)
    ... 6 more 
```

任何帮助表示赞赏。让我知道您还希望我发布什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T11:40:13.957

检查您的 application.xml + jboss-deployment-structure.xml 是否指向所需的 war/jar 文件

# c# - 如何编写一些排除链接表中相关记录的 LINQ？

> ID：15935483
> 
> 赞同：0
> 
> 时间：2013-04-10T20:11:28.627
> 
> 标签：c#, linq, entity-framework, linq-to-entities

我有 2 张桌子

```
Client
ClientReport 
```

我需要编写一些 LINQ 来列出所有不在 ClientReport 表中的客户端，即我需要列出所有与特定报告无关的客户端。

这是我的出发点：

```
 var ClientList = db.StdClient.ToList(); 
```

非常感谢。

编辑：

抱歉忘记了一个重要要求，那就是过滤器需要特定于报告。ReportId 作为参数输入到 Action

编辑2：

```
var ClientList = db.StdClient
                     .Where(c => !db.StdClientReport
                                     .Any(cr=>(
                                        (cr.StdClientId == c.Id) 
                                         && (cr.ReportId==ReportId)
                                               )
                                          )
                            ).ToList(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:24:13.013

这是假设通过导航属性 on`Client`和/或属性 on之间存在一对多关系。`ClientReport``Client``ClientId``ClientReport`

如果有从`Client`to的导航属性`ClientReport`：

```
var clientList = db.Client.Where(c => !c.ClientReports.Any()); 
```

或者

```
int id = 7;  // report ID we're looking for
var clientList = db.Client.Where(c => !c.ClientReports
                                        .Any(cr => cr.ReportId == id)
                                ); 
```

如果它特定于一个报告 ID。

否则

```
var clientList = db.Client.Where(c => !db.StdClientReport
                                         .Any(cr=>cr.ClientId == c.Id)
                                ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T15:05:24.417

你也可以使用`.Except`，但我没有测试过

就像是

`var noReport = ClientList.Except(ClientReportList);`

# html - 如何选择表中的所有第一个 td

> ID：15935484
> 
> 赞同：0
> 
> 时间：2013-04-10T20:11:33.263
> 
> 标签：html, css, css-selectors

您好我想只选择表中每一行的第一个`<td>`（`td`带有文本*“标签” ），如果您有一个简单的 html，例如：*

```
<table>
  <tr><td>label</td> <td>value</td></tr>
  <tr><td>label</td> <td>value</td></tr>
  <tr><td>label</td> <td>value</td></tr>
</table> 
```

例如，我想将 10% 的宽度分配给`<td></td>`带有选择器的第一组，我不想使用一个类。

我尝试了以下选择器：

```
table.widget tr:first-child td{
    width:10%;
    border:0;   
} 
```

但是那个选择器只会选择第一个`td`而`tr`不是所有的，`TD's`所以我尝试了

```
table.widget tr td:first-child{
    max-width:10%;
} 
```

当然我得到的是第一个孩子的选择`TD`。不是它`td`本身

有可能做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:15:23.447

单程：

```
table tr td:first-of-type {
background: lemonchiffon;
} 
```

[http://jsfiddle.net/PRrq5/2/](http://jsfiddle.net/PRrq5/2/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-10T20:18:02.167

您的第二个选择器实际上是正确的：

[http://tinker.io/40f64](http://tinker.io/40f64)

```
table.widget tr td:first-child {
    background: orange;
} 
```

要选择每个 td 的第一个孩子，选择器应该是这样的：

```
table.widget tr td :first-child { /* note the space after the td */
    // styles
} 
```

但是，应该注意的是，OP 的示例表没有`widget`应用类。

如果您的表表示键/值对的集合，则将*标签*文本放在 a 中`th`可能更合适：

[http://tinker.io/40f64/1](http://tinker.io/40f64/1)

```
table.widget th {
    background: orange;
}

<table class="widget">
  <tr><th>label</th> <td>value</td></tr>
  <tr><th>label</th> <td>value</td></tr>
  <tr><th>label</th> <td>value</td></tr>
</table> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:15:34.133

尝试这个：

```
table tr td:first-child { color: red; } 
```

小提琴：http: [//jsfiddle.net/74MFH/1/](http://jsfiddle.net/74MFH/1/)

# c# - 过滤掉列表

> ID：15935486
> 
> 赞同：-3
> 
> 时间：2013-04-10T20:11:38.770
> 
> 标签：c#, asp.net

我有一个对象列表，我想根据某些条件进行过滤。所以我有

```
List<person> plist= Person.getPersonList(); 
```

`List<person>` 有大约 400 条记录，每条记录都有名字、姓氏、家庭地址、电话号码、身份证。用户可以在搜索框中输入任何搜索条件，我想过滤 pList 并显示与搜索条件匹配的结果，例如，如果用户输入 FisrtName "te

然后我想过滤掉显示所有以te开头的名称的pList。

任何帮助将不胜感激。

谢谢。

-anjali

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:13:40.823

```
List plist= Person.getPersonList();
var filtered = plist.Where(x => x.FirstName.StartsWith("te").ToList(); 
```

一次搜索超过 1 个值：

```
List plist= Person.getPersonList();
var filtered = plist.Where(x => x.FirstName.StartsWith("te") || x.OtherProperty.StartsWith("some other value")).ToList(); 
```

这很容易让你自己搞砸，所以我认为你在这里有你需要的基本操作。

# internationalization - 如何在不滥用模板系统的情况下实现多种语言？

> ID：15935489
> 
> 赞同：2
> 
> 时间：2013-04-10T20:11:47.020
> 
> 标签：internationalization, meteor

我将[我们的 Meteor 网站](http://q42.com)转换为支持两种语言，荷兰语和英语。为此，我为我们的模板（en 和 nl）创建了两个文件夹，并将所有内容连接到我们的模板系统，以便路由器根据您所在的站点正确地提供服务。[主体模板](https://github.com/Q42/q42.nl/blob/master/client/main.js)是动态的：

```
Template.body.content = function() {
  var lang = Session.get("lang") == "en" ? "en_" : "";
  var page = Session.get("page") || "home";

  // if the template for the current language doesn't exist,
  // fall back to Dutch version or show a 404
  var template = Template[lang + page] || Template[page] || Template[lang + "error404"];

  return template();
} 
```

一切都很好，除了我必须编写以下内容以向两种语言公开模板值：

```
Template.en_foo.bar = Template.foo.bar = function() {} 
```

有关生产中使用的此代码的示例，请参阅[我们的客户端博客代码](https://github.com/Q42/q42.nl/blob/master/client/blog.js)。

在实现多语言网站目标的同时，避免这种方法的优雅方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T01:44:25.157

那这个呢：

*   进行自定义订阅并将语言参数传递给自定义发布
*   自定义发布功能仅返回选定的语言（如果内容不可用，您可以选择提供后备）
*   仅对所有语言使用一个模板，其中填充了订阅中的正确语言
*   对 UI 字符串使用 i18n 包

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:17:13.567

多语言应用程序已在[Meteor 路线图](https://trello.com/card/i18n/508721606e02bb9d570016ae/38)上，但计划已久……

同时你可以使用这个[大气的包](https://atmosphere.meteor.com/package/simple-i18n)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-26T11:02:34.700

我强烈建议不要保留模板的翻译版本。除非您的网站*很小*。一开始可能看起来还不错，因为您只是复制它们并翻译内容。但是从那时起，您必须在任何更改时维护这两个版本，同时测试两个版本。然后有人会建议添加第三种语言和繁荣，对你的大脑造成三倍伤害。

我们使用[meteor-messageformat](http://messageformat.meteor.com/)进行翻译。它带有一个界面，无需查看模板代码即可创建翻译。任何人都可以翻译。

# c# - 更新 LostFocus 上的 TextBox 文本格式 - WinRT

> ID：15935500
> 
> 赞同：0
> 
> 时间：2013-04-10T20:12:16.087
> 
> 标签：c#, winrt-xaml

我正在使用 C# 和 XAML 开发 Windows Store 应用程序，并且正在处理用户输入页面。我使用一个`IValueConverter`将我的绑定数据转换为格式化的货币`string`，而不是仅仅显示一个小数。

当用户导航到页面时，转换器工作正常，`TextBox`文本以货币格式显示。但是，当用户更改`TextBox.Text`值然后`TextBox`失去焦点时，转换器不会再次将其更改为良好的货币格式，它只是保持用户输入的格式。

据我所知，没有`StringFormat`使用 like in `WPF`，那么如何`TextBox`在用户编辑值后再次显示货币格式？

我的转换器：

```
public object Convert(object value, Type targetType, object parameter, string language)
    {
        if (parameter == null)
            return ((decimal)value).ToString();
        return String.Format((string)parameter, (decimal)value);
    }

public object ConvertBack(object value, Type targetType, object parameter, string language)
    {
        decimal decVal = 0M;
        decimal.TryParse((string)value, out decVal);
        return decVal;
    } 
```

我的 XAML：

```
<Grid x:Name="InputGrid">
    ...
    <Border>
        <TextBox Text="{Binding MyValue, ConverterParameter='{}{0:c}', Converter={StaticResource DecimalValueConverter}, Mode=TwoWay}"
    </Border>
    ....
</Grid> 
```

`InputGrid.DataContext = MyValueClassInstance`在代码隐藏中设置

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:15:37.053

如果你这样做怎么办：

 **```
<TextBox Text="{Binding MyValue, UpdateSourceTrigger=PropertyChanged, ConverterParameter='{}{0:c}', Converter={StaticResource DecimalValueConverter}, Mode=TwoWay}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:21:40.107

你的转换器可以双向工作吗？我怀疑如果没有 - TwoWay 绑定会被破坏。**

# ruby-on-rails - Rails rest put HTTP/1.0 501 未实现

> ID：15935501
> 
> 赞同：0
> 
> 时间：2013-04-10T20:12:10.503
> 
> 标签：ruby-on-rails, rest

我需要对我的 Rails 应用程序使用 RESTful 输入。首先，我试图了解 REST，并在我的 MAC 上使用 WizTools RestClient 进行测试。

我有一个名为priorities 的表，我正在尝试更新一个名为prioritydesc 的字段。

这是我正在使用的信息

```
METHOD = PUT
URL = http://mywebsite/priorities/4
HEADER = prioritydesc
VALUE = "TEST" 
```

我得到的结果是：

```
HTTP/1.0 501 Not Implemented 
```

如果我使用 resttesttest.com 网站，我会得到：

Access-Control-Allow-Origin 不允许来源[http://resttesttest.com 。](http://resttesttest.com)

谢谢您的帮助！

更新1：

我需要宝石“oauth-plugin”吗？

UDPATE2：

这是我的priorities_controller PUT：

```
 # PUT /priorities/1
 # PUT /priorities/1.json
def update
 @priority = Priority.find(params[:id])

 respond_to do |format|
   if @priority.update_attributes(params[:priority])
     format.html { redirect_to @priority, notice: 'Priority was successfully updated.' }
     format.json { head :ok }
   else
     format.html { render action: "edit" }
     format.json { render json: @priority.errors, status: :unprocessable_entity }
   end
 end
end 
```

更新3

我在本地主机上尝试使用：

```
METHOD = PUT
URL = http://localhost/priorities/1
HEADER = prioritynum
VALUE = 5 
```

并得到

```
"<html><body>You are being <a href="http://localhost:5000/priorities/4">redirected</a>.</body></html>" 
```

这对我来说似乎没问题。

但是，价值没有更新。

更新4

我用这个：

```
METHOD = POST
URL = http://localhost/priorities
HEADER = prioritynum
VALUE = 5 
```

并且创造了新纪录！但是，prioritynum 是空白的

我也尝试过使用

```
http://localhost:5000/priorities?prioritynum=5 
```

像 (prioritynum=5) 这样的数据字段应该在标题还是正文中？我把它放在身体里，它没有用：

```
typecode="test" 
```

更新5

好的，这有效！

```
 METHOD = PUT
 URL = http://mywebsite/priorities?priority[prioritynum]=5 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:01:17.403

我让它适用于类型控制器 - 我使用了这个：

```
Method = POST
URL =  http://mywesite/types?type[typecode]=test&type[typedesc]=test%20description 
```

# css - 使用 transform:rotate 的 Htmlservice 不通过 caja？

> ID：15935505
> 
> 赞同：0
> 
> 时间：2013-04-10T20:12:19.927
> 
> 标签：css, google-apps-script, google-caja

我有一个脚本*doGet*，我使用该`HtmlService.createTemplateFromFile`服务来呈现一个 html 文件。

在 html 中，我使用如下样式表

```
 .title {
  height:100px;
  width:200px;
  border-radius:10px;
  border: 20px solid #404BBD ;
  font-size:90px;
  transform: rotate(30deg);
  -ms-transform: rotate(30deg);
  -webkit-transform: rotate(30deg)
  } 
```

我将其应用于 html 正文中的 div 标签。尽管 DIV 的旋转似乎没有发生，但大部分 Css 都已应用。 `<div class="title">Hello</div>`

我做错了什么还是[Google Caja](http://caja.appspot.com/)不接受真正的轮换？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T16:12:40.893

Caja 没有将该`transform`物业列入白名单。请随时[请求添加它](https://code.google.com/p/google-caja/issues/entry)。

# c++ - OpenGL GL_POLYGON 无法正确打印

> ID：15935507
> 
> 赞同：2
> 
> 时间：2013-04-10T20:12:29.260
> 
> 标签：c++, visual-c++, opengl

我正在绘制一个基本的多边形，它有 5 个边，看起来几乎像 C 形。

```
(50,60) _____(70,60)
       |    /
       |   /
       |  /(60,40)
       |  \
       |   \
(50,20)|____\(70,20) 
```

很简单。

当我使用

```
wcPt2D verts[5] = {{50,20}, {70,20}, {**60**,40}, {70,60}, {50,60}}; 
```

![在此处输入图像描述](https://i.stack.imgur.com/rklrt.png)

我明白了。预期的。但是当我把那个中心部分改成

```
wcPt2D verts[5] = {{50,20}, {70,20}, {**51**,40}, {70,60}, {50,60}}; 
```

我明白了

![在此处输入图像描述](https://i.stack.imgur.com/aEwa6.png)

这显然不是左墙 1 个单位/图像 1 左侧的 9 个单位，并且它显然将 y 值降低了大约 10 个单位。为什么是这样？

```
void polygon (wcPt2D *verts)
{
GLint k;

glBegin(GL_POLYGON);
    for (k = 0; k < 5; k++)
    {
        glVertex2f(verts [k].x,verts [k].y);
    }
glEnd();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-10T20:19:17.867

的行为`GL_POLYGON`仅针对凸多边形定义。你的多边形是凹的，所以这个函数的行为是不确定的（而且，正如你所观察到的，它并不总是有效的）。

您需要将多边形分解为一个或多个凸多边形才能正常工作。在您的情况下，一种简单的方法是在多边形上水平“切割”：

```
(50,60) _____(70,60)
       | /
       | /
(50,40)|__/(60,40)
       | \
       | \
(50,20)|____\(70,20)

```

# .net - Clickonce 应用程序第一次运行但第二次抛出异常

> ID：15935513
> 
> 赞同：0
> 
> 时间：2013-04-10T20:12:43.050
> 
> 标签：.net, visual-studio-2010, .net-4.0, clickonce

我有一个 .NET 4.0 应用程序。第一次运行时，安装程​​序运行，应用程序正常打开。如果你在它已经安装的时候运行它，它会抛出这个异常：

```
System.BadImageFormatException was unhandled
Message: Could not load file or assembly '[my assembly]' or one of its dependencies. 
This assembly is built by a runtime newer than the currently loaded runtime and cannot be loaded. 
```

该应用程序以前是 .NET 3.5，我将主项目和两个依赖项更改为 .NET 4。还有其他使用 .NET 2 和 .NET 3.5 的参考，但没有一个高于 4。知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T02:28:16.470

不确定它第一次是如何工作的，但根据错误消息，看起来您的客户端计算机确实没有安装 .NET 4 框架（不确定您是否只需要 .NET 4 的客户端版本或完整版本）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T15:35:15.473

问题是我将项目更改为在 .NET 4（已安装）上构建，但我的程序在第一次启动后从另一个位置加载不同的 App.config 以进行更新。该配置文件包含

```
<startup>
  <supportedRuntime version="v2.0.50727"/>
</startup> 
```

代替

```
<startup>
  <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
</startup> 
```

这导致我的应用程序在启动时加载 3.5 运行时而不是使用 .NET 4。

# cuda - CUDA 中的同步

> ID：15935515
> 
> 赞同：5
> 
> 时间：2013-04-10T20:12:52.207
> 
> 标签：cuda

我阅读了有关 cuda 同步的 cuda 参考手册，但我不清楚。例如为什么我们使用`cudaDeviceSynchronize()`or `__syncthreads()`？如果不使用它们会发生什么，程序无法正常工作？`cudaMemcpy`和`cudaMemcpyAsync`在行动有什么区别？
你能举一个例子来说明这种差异吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-10T20:41:53.610

`cudaDeviceSynchronize()`当希望 CPU 活动等待任何挂起的 GPU 活动完成时，在主机代码（即在 CPU 上运行）中使用。在许多情况下，没有必要显式地执行此操作，因为发布到单个流的 GPU 操作会自动序列化，并且某些其他操作（例如`cudaMemcpy()`，它们内置了固有的阻塞设备同步）。但是对于其他一些目的，例如调试代码，强制设备完成任何未完成的活动可能很方便。

`__syncthreads()`在设备代码中使用（即在 GPU 上运行），在具有独立并行操作的代码中可能根本不需要（例如将两个向量逐个元素相加）。然而，一个常用的例子是在共享内存之外运行的算法。在这些情况下，经常需要将全局内存中的值加载到共享内存中，并且我们希望线程块中的每个线程都有机会在任何实际处理发生之前加载其适当的共享内存位置。在这种情况下，我们要`__syncthreads()`在处理发生之前使用，以确保完全填充共享内存。这只是一个例子。 `__syncthreads()`可以在需要在线程块内进行同步的任何时候使用。它不允许块之间的同步。

`cudaMemcpy`和的区别在于`cudaMemcpyAsync`，非异步版本的调用只能发布到流 0，并且会阻塞调用 CPU 线程，直到复制完成。异步版本可以选择采用流参数，并在复制完成之前立即将控制权返回给调用线程。异步版本通常在我们想要[异步并发执行](http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#asynchronous-concurrent-execution)的情况下使用。

如果您有关于 CUDA 编程的基本问题，建议您参加一些[可用的网络研讨会](https://developer.nvidia.com/gpu-computing-webinars)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T03:24:15.267

此外，`__syncthreads()`当您的代码中有一些条件路径，然后您想要运行依赖于多个数组元素的操作时，它变得非常必要。考虑以下示例：

```
int n = threadIdx.x;

if( myarray[n] > 0 )
{
     myarray[n] = - myarray[n];
}
double y = myarray[n] + myarray[n+1]; // Not all threads reaches here at the same time 
```

在上面的示例中，并非所有线程都有相同的执行顺序。根据`if`条件，某些线程将花费更长的时间。在考虑示例的最后一行时，您需要确保所有线程都完全完成了 if 条件并`myarray`正确更新。如果不是这种情况，`y`可以使用一些更新和未更新的值。在这种情况下，必须`__syncthreads()`在评估之前添加`y`以克服此问题：

```
if( myarray[n] > 0 )
{
     myarray[n] = - myarray[n];
}
__syncthreads(); // All threads will wait till they come to this point
// We are now quite confident that all array values are updated.
double y = myarray[n] + myarray[n+1]; 
```

# url - 翻译 .htaccess 中的 URL

> ID：15935521
> 
> 赞同：1
> 
> 时间：2013-04-10T20:13:15.493
> 
> 标签：url, coldfusion, rewrite

这就是我想做的假设我有一个域 www.mydomain.com 我在 www.mydomain.com/myapp 中有我的 Coldfusion 应用程序 myapp 下有一个名为 x 的文件夹，x 下是 y 就像这样 wwwroot - myapp - x - y - index.cfm

所以 y 的 URL 将是 www.mydomain.com/myapp/x/y

我希望用户输入 [http://www.mydomain.com/y](http://www.mydomain.com/y) 然后我想将该 URL 转换为 [http://www.mydomain.com/myapp/?virtualFolder=y](http://www.mydomain.com/myapp/?virtualFolder=y)

但在整个会话中，我希望用户只看到原始 URL

你能告诉我我怎么能做到这一点，可能在.htaccess中？[IIS 网络服务器、Coldfusion 10、共享主机]

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-29T09:38:26.953

你不能在 iis 中使用 .htaccess，它只在它的 Apache 中使用，iis（取决于版本）有一个 isapi 插件可以帮助你，但如果你在共享主机上，你可能无法访问它。您也不能使用 Application.cfc OnMissingTemplate 方法，因为通常只有对 .cfm[l] 或 .cfc 页面的直接请求会发送到 ColdFusion 进行处理。

我看到您能够完成您想要的唯一方法是使用 index.cfm 进行自己的重定向。

所以而不是

```
http://www.mydomain.com/y 
```

你将不得不做

```
http://www.mydomain.com/index.cfm/y 
```

在您的 index.cfm 文件中，您将解析 url 参数并使用状态代码为 301 的 cflocation 重定向到实际页面。

# facebook-graph-api - 目标实体错误

> ID：15935522
> 
> 赞同：1
> 
> 时间：2013-04-10T20:13:20.650
> 
> 标签：facebook-graph-api

我需要为类型为 31 的广告素材设置targeted_entities 参数

```
targeted_entities = [100003297600281, 100000529832243] 
```

根据我的要求，我收到了来自 Graph 的错误消息

```
(#100) Invalid Targeted Entity IDs -- The targeted entity ids are invalid
Why user ID 100003297600281 is invalid? If i send 100000529832243 - all OK 
```

# image - 如何在 excel 表中显示来自 url 的图像（2003）

> ID：15935523
> 
> 赞同：0
> 
> 时间：2013-04-10T20:13:20.787
> 
> 标签：image, excel, excel-2003, imageurl, vba

如何编写一个宏来显示来自 url 的图像，我在 excel 2003 的一个单元格中。

任何人都可以帮忙。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:59:39.583

最近有一个关于此的问题，它还询问了重新调整大小以适应单元格的问题。

[https://stackoverflow.com/a/15589423/1467082](https://stackoverflow.com/a/15589423/1467082)

以下是您需要开始的 4 行代码：

```
Sub InsertPicFromURL()

Dim pic As String 'file path of pic
Dim myPicture As Picture 'embedded pic

pic = "http://www.gravatar.com/avatar/4d3ac4ebeddcf958a7b8d3e73c2c6805?s=128&d=identicon&r=PG"
Set myPicture = ActiveSheet.Pictures.Insert(pic)

End Sub 
```

# ssis - 如何让SSIS根据参数选择数据源？

> ID：15935524
> 
> 赞同：0
> 
> 时间：2013-04-10T20:13:21.150
> 
> 标签：ssis

我有一个 SSIS 数据流任务，它读取包含某些字段的 CSV 文件，稍微调整一下并将结果插入表中。源文件名是一个包参数。那里一切都很好。

现在，我需要处理带有额外字段的稍微不同类型的 CSV 文件。这个额外的字段可以安全地忽略，所以处理本质上是一样的。唯一的区别在于数据源的列映射。

当然，我可以创建整个包的副本并调整数据源以匹配第二种文件格式。然而，这个“解决方案”似乎是可怕的重复：如果处理过程中有任何变化，我将不得不做两次。我宁愿将另一个参数传递给包，它会告诉它要处理哪种文件。

问题是，我不知道如何根据参数从一个数据源或另一个数据源读取 SSIS，因此是这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:31:47.310

我将复制 SSIS 包中的连接管理器（CSV 定义）和数据流，并调整它们以适应新的文件格式。然后我将使用您描述的参数来启用/禁用任一数据流。

从本质上讲，SSIS 不适用于可变元数据。如果这将是一个反复出现的模式，我会在 SSIS 上游处理它，构建一个 VB/C# 命令行应用程序将文件切碎成 SQL 表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-22T19:37:16.957

您可以让连接管理器将所有数据推送到 1 列中。然后使用脚本转换组件将数据解析到输出，具体取决于行中的字段数。

您可以根据分隔符将数据拆分为一个字符串数组（当我需要这样做时，我搜索了帮助）。使用数组，您可以知道它的大小，从而知道它连接到的文件类型。

然后，您到目的地的映射可以保持不变。也不需要复制任何组件。

我必须自己做一次类似的事情，因为虽然我使用的文件总是相同的格式——取决于发送文件的系统版本，它可能会改变——因此通过以这种方式在脚本转换中处理它我能够处理文件格式的微小变化。如果文件 99% 始终相同，那没关系。如果它们完全不同，您最好使用单独的文件连接管理器。

# c++ - 带有 Javascript 桥的 Ember.js QT

> ID：15935526
> 
> 赞同：1
> 
> 时间：2013-04-10T20:13:24.990
> 
> 标签：c++, node.js, qt, ember.js, ember-data

我们有一个基于 QT C++（mac 和 windows）的完整桌面应用程序。我们利用 webkit 来提供基于 HTML 和 Javascript 的 UI。我们还通过 javascript 桥与 C++ 交互。我正在做大量的工作，并将 Ember.js 作为 MVC 合并为一个更加模块化的 UI。

我的问题与持久性的最佳方法有关。我应该坚持使用我们目前使用的 Javascript 对象，还是过渡到 Ember Data 进行持久化，并通过 Ember Data（翻译层）中的函数进行读/写？

我们也使用 webkit，但我应该看看使用 Node.js 而不是 strait html/js 吗？

我不想做剧烈的改变，但我想把这件事做对。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T12:49:41.020

在 Ember 方面，没有理由使用 Ember Data，因为没有它，Ember 也能正常工作。[`Ember.Observable`](http://emberjs.com/api/classes/Ember.Observable.html)但是 Ember的基础架构严重依赖于[`Ember.Object`](http://emberjs.com/api/classes/Ember.Object.html). [`Ember.Array`](http://emberjs.com/api/classes/Ember.Array.html)同样，如果您使用和，JavaScript 数组将支持更多 Ember 功能[`Ember.MutableArray`](http://emberjs.com/api/classes/Ember.MutableArray.html)，但除非您[禁用`Ember.EXTEND_PROTOTYPES`](http://emberjs.com/guides/configuring-ember/disabling-prototype-extensions/)，否则这将自动发生。

因此，一种非常合理的方法是将现有模型类移植到`Ember.Object`. 除其他外，这将需要使用`get`和`set`访问属性。如果您这样做，那么您的对象将成为 Ember 的一等公民，并且您将可以访问 Ember 的所有简洁功能，包括自动视图更新和数据绑定。

下面是它的`Ember.Object`外观，以及它如何与 Ember 的其余部分集成：

```
MyApp.Person = Ember.Object.extend({
  firstName: null,
  lastName: null,

  init: function () {
    // You can put more initialization code here.
  },

  // Compute fullName based on firstName and lastName.
  // This will automatically propagate updates when
  // firstName or lastName changes.
  fullName: function () {
    return this.get("firstName") + " " + this.get("lastName");
  }.property("firstName", "lastName")
});

var person = MyApp.Person.create({ firstName: "Jane", lastName: "Doe" }) 
```

然后，在 Ember 视图中，您可以编写如下内容：

```
<p>{{person.fullName}}</p> 
```

…并且视图会在任何时候自动更新`firstName`或`lastName`更改。同样，您可以`firstName`使用以下代码进行编辑：

```
{{view Ember.TextField valueBinding="person.firstName"}} 
```

在此示例中，对文本字段的更改将自动传播回基础对象。（尽管您可以变得聪明并构建一个仅在用户完成编辑时才传播更改的文本字段。）

如果您需要将属性更新从 Ember 传递到 QT，请参阅[使用计算属性构建 getter 和 setter 的指南](http://emberjs.com/guides/object-model/computed-properties/)或使用[观察者](http://emberjs.com/guides/object-model/observers/)。很大程度上取决于您通过 JavaScript 桥接器公开 C++ API 的方式。但只要你能`Ember.Observable`以某种方式参与其中，你就可以完全访问 Ember 的所有功能。

# c# - VisualStateManager.GoToState() 忽略 useTransitions

> ID：15935527
> 
> 赞同：2
> 
> 时间：2013-04-10T20:13:27.943
> 
> 标签：c#, windows-runtime, windows-store-apps, winrt-xaml

我有一个包含视觉状态的 UserControl。当控件构造时，我想移动到“初始”状态之一（不是默认 - 有修改）。

```
public MyUserControl()
{
    this.InitializeComponent();
    Loaded += MyUserControl_Loaded;
    VisualStateManager.GoToState(this, "HideImageState", false);
} 
```

但是，当控件加载时，会发生明显的转换（HideImageState 表示的转换）。

如果我传入 useTransitions，为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T18:13:36.733

由于您没有提供更多信息，因此“一般”可能会有所帮助的事情很少。再次，我从臀部拍摄常见问题......

首先是您的故事板不准确。如果您在 Blend 中创建了转场，那么这不太可能。但是，如果您手动编写它们，那么目标可能不是您所期望的。

动画也可能正在发生，但被 UI 中的其他元素遮挡。当您在无法拉伸的容器内调整对象的大小时，有时会发生这种情况。

最后，也是最重要的一点，如果您的视觉状态转换位于包装在 a 中的用户控件中，`Viewbox`那么您的视图状态会由于某种原因而被忽略。

您还有其他可能的原因来获得您所看到的结果。但是，由于提供的信息如此之少，我无法继续猜测。我会假设以上三个原因之一。

祝你好运！

# linq - IEnumerable 查询与 GroupBy 与 Min 和 Projection

> ID：15935528
> 
> 赞同：3
> 
> 时间：2013-04-10T20:13:28.337
> 
> 标签：linq, data-structures, linq-to-objects

我将这些数组按索引关联。所以对每个索引（ObjId, ObjState）形成一对。

```
 string[] ObjIds = { "Obj1", "Obj1", "Obj2", "Obj2", "Obj1", "Obj3", "Obj2", "Obj2" };
 string[] ObjStates = { "OS11", "OS12", "OS21", "OS22", "OS13", "OS31", "OS22", "OS23" }; 
```

但是，我只想要每个 ObjId 的最新对（最接近索引 0）。

对于上述输入，输出将是

```
{  Obj1, OS11 }, {Obj2, OS21}, {Obj3, OS31} 
```

如何使用 IEnumerable 查询执行此操作？我无法弄清楚如何跟踪索引。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:16:49.927

你应该能够做到：

```
var items = ObjIds.Zip(ObjStates, (id, st) => new {Id = id, State = st})
                  .GroupBy(i => i.Id)
                  .Select(g => g.First()); 
```

`Enumerable.Zip`此处使用为您将项目“配对”成一个新的匿名类型，然后将项目分组，并从每个组中选择第一个项目。

# string - 无法将参数值从字符串转换为 Int32 c#

> ID：15935529
> 
> 赞同：0
> 
> 时间：2013-04-10T20:13:35.740
> 
> 标签：string, stored-procedures, parameters, sqldataadapter, int32

我有两个下拉列表：一个用于省，一个用于连接到数据库的城市。我希望能够从第一个下拉列表中选择一个省，并能够在第二个下拉列表中看到该特殊省份的城市。但我收到错误“无法将参数值从字符串转换为 Int32”。在“DataSet ds1 = new DataSet();”行上。

![在此处输入图像描述](https://i.stack.imgur.com/0JgKd.png)

```
我的数据库：
--------
_省
Prv_Id --- int (P.key)
Prv_Name --- nvarchar
--------------
_城市
Cty_Id --- int (P.key)
Cty_Name --- nvarchar
Cty_Prv_Id --- int (F.key)
----------------------------
----------------------------

我的 ST. 程序：
----------------------
更改程序 [dbo].[_City_selectItems] (@vari int)

作为
开始
SELECT * FROM _City WHERE (Cty_Prv_Id=@vari)
结尾

--------------------------------------------------
更改程序 [dbo].[_Province_selectAll]

作为
开始
选择 * FROM _Province
结尾
--------------------------------------------------

```

我的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Data;
using System.Data.SqlClient;

namespace WebApplication3_DrpDwnListAndSQL
{
    public partial class WebForm2 : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                func1();
                func2();
                //func3();
            }
        }

        protected void DrpDwnProvince_SelectedIndexChanged(object sender, EventArgs e)
        {
            Label1.Text =DrpDwnProvince.SelectedValue;
            //string a = DrpDwnProvince.SelectedValue;
        }

        //First function for Province DrpDwnList 
        private void func1()
        {
            SqlConnection con = new SqlConnection("Integrated Security=SSPI;Persist Security Info=False;Initial Catalog=DrpBoxDB;Data Source=ARASH-PC");
            SqlDataAdapter com = new SqlDataAdapter("_Province_selectAll", con);
            com.SelectCommand.CommandType = CommandType.StoredProcedure;
            DataSet ds = new DataSet();
            if (com != null)
            { com.Fill(ds); }

            DrpDwnProvince.DataSource = ds;
            DrpDwnProvince.DataTextField = "Prv_Name";
            DrpDwnProvince.DataValueField = "Prv_Id";
            DrpDwnProvince.DataBind();
        }

        //Second function for City DrpDwnList
        private void func2()
        {
            SqlConnection con = new SqlConnection("Integrated Security=SSPI;Persist Security Info=False;Initial Catalog=DrpBoxDB;Data Source=ARASH-PC");
            SqlDataAdapter com1 = new SqlDataAdapter("_City_selectItems", con);
            com1.SelectCommand.Parameters.Add("@vari",SqlDbType.Int).Value=Label1.Text;

            com1.SelectCommand.CommandType = CommandType.StoredProcedure;

            DataSet ds1 = new DataSet();
            if (com1 != null)
            { com1.Fill(ds1); }

            DrpDwnCity.DataSource = ds1;
            DrpDwnCity.DataTextField = "Cty_Name";
            DrpDwnCity.DataValueField = "Cty_Id";
            DrpDwnCity.DataBind();
        }

        //Third function for District DrpDwnList
       // private void func3()
       // {

      //  }

    }
} 
```

# vim - 未为 .haml 和 .less 文件生成 Ctag

> ID：15935532
> 
> 赞同：1
> 
> 时间：2013-04-10T20:13:43.360
> 
> 标签：vim, haml, less, ctags

我正在使用 ctags -R * 生成标签。但它不会为 .haml 和 .less 文件生成标签。是否有单独的选项为这些文件生成标签？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:59:24.000

我认为 ctags 默认不支持 haml。以下是支持的语言：[http](http://ctags.sourceforge.net/languages.html) ://ctags.sourceforge.net/languages.html 。您可以通过一些谷歌搜索来添加对它的支持。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-03T02:35:29.617

要添加对 less 的支持，请将其粘贴到您的 ctags 文件中：

```
--langdef=less
--langmap=less:.less
--regex-less=/^[ \t]*\.([A-Za-z0-9_-]+)/\1/c,class,classes/
--regex-less=/^[ \t]*#([A-Za-z0-9_-]+)/\1/i,id,ids/
--regex-less=/^[ \t]*(([A-Za-z0-9_-]+[ \t\n,]+)+)\{/\1/t,tag,tags/
--regex-less=/^[ \t]*@media\s+([A-Za-z0-9_-]+)/\1/m,media,medias/ 
```

上面的表达很`ctrl-]`友好。如果您使用的是 kien/ctrlp.vim 之类的脚本，请使用

```
--langdef=less
--langmap=less:.less
--regex-less=/^[ \t]*\.([A-Za-z0-9_-]+)/.\1/c,class,classes/
--regex-less=/^[ \t]*#([A-Za-z0-9_-]+)/#\1/i,id,ids/
--regex-less=/^[ \t]*(([A-Za-z0-9_-]+[ \t\n,]+)+)\{/\1/t,tag,tags/
--regex-less=/^[ \t]*@media\s+([A-Za-z0-9_-]+)/\1/m,media,medias/ 
```

它将`.`在课程`#`之前和 ID 之前添加。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-11T06:16:10.327

您可以查询支持的语言列表

```
$ ctags --list-languages 
```

*Exuberant Ctags*有一些补丁添加了对更多语言的本机支持，但我还没有看到*haml*或*更少*的任何东西。但是，您可以通过`~/.ctags`;中的正则表达式定义添加支持。请参阅[ctags 帮助](http://ctags.sourceforge.net/EXTENDING.html)。

# php - PHP返回数组中的oci查询不起作用

> ID：15935533
> 
> 赞同：0
> 
> 时间：2013-04-10T20:13:48.407
> 
> 标签：php, sql, oracle

使用`print_r`波纹管简单地打印`Array ()`.

为什么这不起作用？

```
$conn = oci_connect("wwbms_admin", "wwbms_admin", "PDBQA");

$sql = "SELECT COUNTRY_ID, DESCRIPTION FROM COUNTRY";
$query_country = oci_parse($conn, $sql);

$list = array();

$result = oci_execute($query_country, OCI_DEFAULT);

while(($row = oci_fetch_assoc($query_country))) {
$items[$row['DESCRIPTION']] = $row['DESCRIPTION'];
}

print_r($list);

oci_close($conn); 
```

任何帮助都会很棒，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:16:25.207

您将 $list 设置为一个空数组（），然后在其上运行 print_r。你再也不会设置它了。你得到了可预测的结果。

也许你是故意的`print_r($items);`？

# python - 如何在 Enthought Canopy Editor 中为脚本提供命令行参数？

> ID：15935535
> 
> 赞同：1
> 
> 时间：2013-04-10T20:13:57.090
> 
> 标签：python, enthought

我在 OSX（64 位）上使用新的 Enthought Canopy 代码编辑器。要测试脚本，我需要提供一个命令行参数，例如：

```
import sys
config_file = sys.argv[1] 
```

但是，我似乎找不到向脚本提供命令行参数的方法。我尝试使用宏作为：

```
def run():
    code_task = get_active_task()
    code_task.run_current_file('config_filename') 
```

...但我得到一个`run_current_file`只需要一个参数的错误（大概是`self`）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:34:06.167

目前不支持传递命令行参数，但我们计划添加。

作为一种解决方法，您可以正常运行脚本，首先，当它失败时，然后从 IPython 历史记录中获取上一个命令，并手动添加所需的参数。

或者，您可以`sys.argv`在运行脚本之前设置要传递给脚本的参数。这对我来说似乎有点骇人听闻。

# performance - 分析分布式系统

> ID：15935545
> 
> 赞同：5
> 
> 时间：2013-04-10T20:14:31.470
> 
> 标签：performance, profiling, distributed, distributed-computing, hpc

我想知道在分布式系统中追踪性能瓶颈的可能方法。我知道[X-Trace](http://static.usenix.org/events/nsdi07/tech/fonseca.html)及其后代（例如[Dapper](http://static.googleusercontent.com/external_content/untrusted_dlcp/research.google.com/en/us/pubs/archive/36356.pdf)）之类的工具，但我对方法而不是特定工具更感兴趣。

换句话说，给定一个没有明显瓶颈的分布式系统，你如何研究和提高它的性能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T00:47:53.170

我使用了一种既有优点又有缺点的方法。优点是它可以工作 - 它发现问题，当它们被修复时，会产生很好的性能。缺点是这是大量的手工工作。

我什至写了一本书，并附上了这个方法。工作是收集带有时间戳的事件日志并将它们合并到一个公共时间线中。然后仔细检查它，通过异步代理网络跟踪相关消息的流动。您正在寻找的是不必要的消息周期，或不一定发生的延迟。例如，在查看这张图片时，由于任务“将状态发布到 DB”，消息的接收被延迟。理解这一点后，实际上可以在单独的线程上进行发布。

![在此处输入图像描述](https://i.stack.imgur.com/ToRIm.jpg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-02T00:26:34.827

老实说，这是一个很好的问题，对于什么是最好的方法没有达成共识。最基本的方法之一是日志记录，您基本上只是将一堆系统事件转储到一个文件中，您可以解析这些日志以找到事件之间的时间，以确定它们需要多长时间。另一种方法是跟踪（由 Xtrace 使用）。在跟踪中，您跟踪请求的生命周期。例如，如果您向使用微服务架构的服务发送请求，您将跟踪请求通过系统微服务时的线程、进程 ID 和延迟。

棘手的部分是弄清楚你想在请求的跟踪中跟踪什么，这将取决于你的分布式系统试图完成什么。例如，对性能感兴趣的一个明显指标是延迟，因此您将衡量请求在每个服务上花费的时间。另一个有趣的指标是争用，因此您可以在请求通过系统时测量 CPU 中的争用。许多这些分析工具的问题之一是它们为您提供系统或请求的总体指标，但是当您想要找到性能问题时，您想要确定请求是否是异常值。因此，必须将请求的延迟、争用和内存消耗与系统中的其他类似请求进行比较，以确定它是否异常。

# jquery - 使用 jQuery 计算等于 0 的表单值

> ID：15935548
> 
> 赞同：0
> 
> 时间：2013-04-10T20:14:48.170
> 
> 标签：jquery, html

```
$("#scorecard").change(function() {
    var total = 0;
    $("#scorecard :checked").each(

    function() {
        total += parseInt($(this).val())
    });
    $("#score").val(total);
}).change(); 
```

此函数以 html 形式实时汇总无线电检查的值。 [http://jsfiddle.net/hireconor/DDfbf/](http://jsfiddle.net/hireconor/DDfbf/)

我该如何修改它，所以它会**计算**等于 0 的已检查单选值？因此，如果选中的值为 0，则等于 1，其他任何值 = 0，然后将其减去 18，将其显示在 id="score" 的文本框中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:16:55.670

这是一种不太明显的方法：

```
var total = $('#scorecard :checked').filter(function() {
    return $(this).val() === '0';
}).length; 
```

这是一个更新的[jsfiddle](http://jsfiddle.net/DDfbf/2/)。

* * *

编辑：我不确定如何解释`minus it by 18`......是那个`18 - total`还是`total - 18`？无论如何，这是一个显示前者的更新[小提琴。](http://jsfiddle.net/DDfbf/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:17:30.470

演示：http: [//jsfiddle.net/DDfbf/3/](http://jsfiddle.net/DDfbf/3/)

```
$("#scorecard").change(function() {
    var total = 0;
    var checkedTotal = 0;

    $("#scorecard :checked").each(

    function() {
        total += parseInt($(this).val())
        if (this.value == 0) {
            checkedTotal++;
        }
    });
    $("#score").val(total);
    console.log(checkedTotal);
}).change(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:18:40.140

[**小提琴**](http://jsfiddle.net/mohammadAdil/kVe8a/)

```
 $("#scorecard").change(function() {
    var total = 0;
    $("#scorecard :checked").each(

    function() {
        var valu = parseInt($(this).val());
        if(valu === 0){
          total += 1;
        }
        else{
        total += valu;
        }
    });
    $("#score").val(18-total);
}).change(); 
```

# java - 如何按降序将术语复制到列表中？

> ID：15935549
> 
> 赞同：0
> 
> 时间：2013-04-10T20:14:51.443
> 
> 标签：java

我正在尝试将变量传递`coeff`给`expo`一个名为`poly`. 为空时`poly`，存储两个变量。我的问题是 when `poly`is not empty 在这种情况下是 else 语句，编译器冻结并抛出以下错误：

```
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space 
```

我不知道的 else 语句是否有问题。

```
public void insert(int coeff, int expo) {

    Term a = new Term(coeff, expo);// Creates a new Term object with passed #'s

    if (poly.isEmpty()) {
        poly.add(a);

    } else {
        for (int i = 0; i < poly.size(); i++) {
            Term one = poly.get(i);

            if (one.getExp() < a.getExp()) {
                poly.add(i, a);
            }
        }
        poly.add(a);
    }
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:17:27.243

如果不看更多代码就很难确定，但是`poly`在迭代它时添加新元素看起来很可疑。如果你不小心，你很容易陷入无限循环。

如果在-th 索引处`add(i, a)`添加，则可以保证无限循环，因为您将一遍又一遍地检查相同的元素，因为当您一直在其前面插入时，它会一直向右移动。`a``i``a`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T20:18:21.093

这是因为，每次添加新元素时，`ArrayList` `poly`其大小`ArrayList`都会增加，这会导致无限循环。你应该尝试这样的事情：

```
else {
  int size = poly.size();//store the size of ArrayList poly in a variable so that the for loop is definite.
  for (int i = 0; i < size; i++) {
    Term one = poly.get(i);
    if (one.getExp() < a.getExp()) {//check this condition..I guess it is always true for each iteration.
      poly.add(i, a);
      i++;//after adding an element at index i increment it by 1
      size = size + 1;
     }
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T20:18:55.740

你的问题是

```
if (one.getExp() < a.getExp()) 
```

总是评估为真......导致无限循环，因为你永远不会达到 poly.size 每次都向 poly 添加一个。

# java - ANR 在由谷歌地图引起的 onCreate 中执行 setContentView？

> ID：15935551
> 
> 赞同：0
> 
> 时间：2013-04-10T20:15:04.847
> 
> 标签：java, android, performance

这一行代码：

```
setContentView(R.layout.main); 
```

完成执行需要 2 到 7-8 秒，因为我在布局中添加了 Google Maps v2 片段，今天我在开发者控制台中收到了此 ANR：

```
DALVIK THREADS:
(mutexes: tll=0 tsl=0 tscl=0 ghl=0 hwl=0 hwll=0)
"main" prio=5 tid=1 SUSPENDED
| group="main" sCount=1 dsCount=0 obj=0x40022190 self=0xcec8
| sysTid=16482 nice=0 sched=0/0 cgrp=[fopen-error:2] handle=-1345006400
| schedstat=( 602203379 1347412095 699 )
at java.lang.reflect.AccessibleObject.<init>(AccessibleObject.java:~132)
at java.lang.reflect.Method.<init>(Method.java:122)
at java.lang.Class.getDeclaredMethods(Native Method)
at java.lang.ClassCache.getDeclaredPublicMethods(ClassCache.java:153)
at java.lang.ClassCache.getMethodsRecursive(ClassCache.java:216)
at java.lang.ClassCache.findMethods(ClassCache.java:175)
at java.lang.ClassCache.getMethods(ClassCache.java:167)
at java.lang.Class.getMethod(Class.java:961)
at com.google.googlenav.capabilities.a.b((null):-1)
at maps.af.w.a((null):-1)
at maps.z.ab.a((null):-1)
at maps.z.ab.a((null):-1)
at maps.z.ag.a((null):-1)
at maps.z.ag.a((null):-1)
at maps.z.bw.a((null):-1)
at maps.z.r.onCreateView((null):-1)
at com.google.android.gms.maps.internal.IMapFragmentDelegate$Stub.onTransact(IMapFragmentDelegate.java:107)
at android.os.Binder.transact(Binder.java:279)
at com.google.android.gms.maps.internal.IMapFragmentDelegate$a$a.onCreateView((null):-1)
at com.google.android.gms.maps.SupportMapFragment$a.onCreateView((null):-1)
at com.google.android.gms.internal.e$4.a((null):-1)
at com.google.android.gms.internal.e.a((null):-1)
at com.google.android.gms.internal.e.onCreateView((null):-1)
at com.google.android.gms.maps.SupportMapFragment.onCreateView((null):-1)
at android.support.v4.app.Fragment.performCreateView(Fragment.java:1460)
at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:884)
at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1066)
at android.support.v4.app.FragmentManagerImpl.addFragment(FragmentManager.java:1168)
at android.support.v4.app.FragmentActivity.onCreateView(FragmentActivity.java:280)
at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:563)
at android.view.LayoutInflater.rInflate(LayoutInflater.java:623)
at android.view.LayoutInflater.rInflate(LayoutInflater.java:626)
at android.view.LayoutInflater.inflate(LayoutInflater.java:408)
at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:209)
at android.app.Activity.setContentView(Activity.java:1657)
at com.frakman.mapbook.MainActivity.onCreate(MainActivity.java:285)
at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
at android.app.ActivityThread.access$1500(ActivityThread.java:117)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:130)
at android.app.ActivityThread.main(ActivityThread.java:3687)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
at dalvik.system.NativeStart.main(Native Method)

"Thread-13" prio=5 tid=10 TIMED_WAIT
| group="main" sCount=1 dsCount=0 obj=0x40557ef8 self=0x2249c8
| sysTid=16524 nice=0 sched=0/0 cgrp=[fopen-error:2] handle=2247424
| schedstat=( 39337155 97991945 106 )
at java.lang.Object.wait(Native Method)
- waiting on <0x4055e098> (a com.google.ads.internal.c)
at java.lang.Object.wait(Object.java:395)
at com.google.ads.internal.c.run(SourceFile:758)
at java.lang.Thread.run(Thread.java:1019)

"Thread-12" prio=5 tid=11 NATIVE
| group="main" sCount=1 dsCount=0 obj=0x40517058 self=0x21d3c0
| sysTid=16515 nice=0 sched=0/0 cgrp=[fopen-error:2] handle=2217208
| schedstat=( 1129151 16143798 6 )
at android.os.BinderProxy.transact(Native Method)
at android.app.ActivityManagerProxy.getContentProvider(ActivityManagerNative.java:1881)
at android.app.ActivityThread.getProvider(ActivityThread.java:3351)
at android.app.ActivityThread.acquireProvider(ActivityThread.java:3376)
at android.app.ContextImpl$ApplicationContentResolver.acquireProvider(ContextImpl.java:1689)
at android.content.ContentResolver.acquireProvider(ContentResolver.java:748)
at android.content.ContentResolver.query(ContentResolver.java:256)
at com.google.ads.as$a.run(SourceFile:75)
at java.lang.Thread.run(Thread.java:1019)

"CookieSyncManager" prio=5 tid=9 NATIVE
| group="main" sCount=1 dsCount=0 obj=0x4056b3e8 self=0x1e7ef0
| sysTid=16512 nice=10 sched=0/0 cgrp=[fopen-error:2] handle=1990240
| schedstat=( 1007081 42510985 9 )
at android.os.MessageQueue.nativePollOnce(Native Method)
at android.os.MessageQueue.next(MessageQueue.java:119)
at android.os.Looper.loop(Looper.java:117)
at android.webkit.WebSyncManager.run(WebSyncManager.java:90)
at android.webkit.CookieSyncManager.run(CookieSyncManager.java:61)
at java.lang.Thread.run(Thread.java:1019)

"WebViewCoreThread" prio=5 tid=8 NATIVE
| group="main" sCount=1 dsCount=0 obj=0x40562ec8 self=0x1bc140
| sysTid=16510 nice=0 sched=0/0 cgrp=[fopen-error:2] handle=1819256
| schedstat=( 56762704 347106931 100 )
at android.os.MessageQueue.nativePollOnce(Native Method)
at android.os.MessageQueue.next(MessageQueue.java:119)
at android.os.Looper.loop(Looper.java:117)
at android.webkit.WebViewCore$WebCoreThread.run(WebViewCore.java:685)
at java.lang.Thread.run(Thread.java:1019)

"Binder Thread #2" prio=5 tid=7 NATIVE
| group="main" sCount=1 dsCount=0 obj=0x40513fa0 self=0x17ad48
| sysTid=16489 nice=0 sched=0/0 cgrp=[fopen-error:2] handle=1499600
| schedstat=( 2532958 55328369 10 )
at dalvik.system.NativeStart.run(Native Method)

"Binder Thread #1" prio=5 tid=6 NATIVE
| group="main" sCount=1 dsCount=0 obj=0x40513260 self=0x16ebd8
| sysTid=16488 nice=0 sched=0/0 cgrp=[fopen-error:2] handle=1499536
| schedstat=( 2868652 35583496 7 )
at dalvik.system.NativeStart.run(Native Method)

"Compiler" daemon prio=5 tid=5 VMWAIT
| group="system" sCount=1 dsCount=0 obj=0x40510498 self=0x16eaa0
| sysTid=16487 nice=0 sched=0/0 cgrp=[fopen-error:2] handle=1424864
| schedstat=( 41778568 58563232 164 )
at dalvik.system.NativeStart.run(Native Method)

"Signal Catcher" daemon prio=5 tid=4 RUNNABLE
| group="system" sCount=0 dsCount=0 obj=0x405103d8 self=0x15b658
| sysTid=16485 nice=0 sched=0/0 cgrp=[fopen-error:2] handle=1428136
| schedstat=( 8483884 45806889 24 )
at dalvik.system.NativeStart.run(Native Method)

"GC" daemon prio=5 tid=3 VMWAIT
| group="system" sCount=1 dsCount=0 obj=0x40510330 self=0x16dfd0
| sysTid=16484 nice=0 sched=0/0 cgrp=[fopen-error:2] handle=1429376
| schedstat=( 99792479 377410890 75 )
at dalvik.system.NativeStart.run(Native Method)

"HeapWorker" daemon prio=5 tid=2 VMWAIT
| group="system" sCount=1 dsCount=0 obj=0x40510278 self=0x15bc20
| sysTid=16483 nice=0 sched=0/0 cgrp=[fopen-error:2] handle=1429632
| schedstat=( 4180908 8453369 17 )
at dalvik.system.NativeStart.run(Native Method) 
```

可能与 setContentView 完成所需的长时间有关吗？有谁知道如何解决这个问题？提前致谢。

更新：这是我的 main.xml 布局文件：

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              xmlns:facebook="http://schemas.android.com/apk/res-auto"
              xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
              android:orientation="vertical"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent"
              android:background="#CCCCCC"
        >

    <RelativeLayout
        android:id="@+id/main_ui_container"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:background="#4099FF"
        android:gravity="left"
        android:orientation="vertical" >

      <com.google.ads.AdView android:id="@+id/adView"
                         android:layout_alignParentBottom="true"
                         android:layout_width="fill_parent"
                         android:layout_height="wrap_content"
                         ads:adUnitId="a151544472ef24f"
                         ads:adSize="SMART_BANNER"
                         ads:loadAdOnCreate="true"/>

        <fragment 
        android:id="@+id/map"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_above="@id/adView"
        class="com.google.android.gms.maps.SupportMapFragment"/>

        <RelativeLayout
            android:id="@+id/bar"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_alignParentTop="true"
            android:layout_centerHorizontal="true"
            android:orientation="horizontal"
            android:background="#4099FF">

    <LinearLayout
        android:id="@+id/layoutButtons"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignTop="@+id/spinner1"
        android:layout_toLeftOf="@+id/authButton"
        android:layout_centerHorizontal="true"
        android:gravity="right"
        android:orientation="horizontal"

        >

        <Button
            android:id="@+id/checkin"
            style="@style/NewButton.ButtonCheckin"
            android:layout_width="50dp"
            android:layout_height="50dp"
            />

        <Button
            android:id="@+id/query"
            style="@style/NewButton.ButtonRefresh"
            android:layout_width="50dp"
            android:layout_height="50dp"

             />
    </LinearLayout>

        <com.facebook.widget.LoginButton
            android:id="@+id/authButton"
            android:layout_alignParentTop="true"
            android:layout_width="100dp"
            android:layout_height="50dp"
            android:layout_alignParentRight="true"
            android:layout_marginRight="2dp"/>

        <Spinner
            android:id="@+id/spinner1"
            android:layout_alignParentTop="true"
            android:layout_width="150dp"
            android:layout_height="50dp"
            android:layout_alignParentLeft="true"
            android:layout_toLeftOf="@+id/layoutButtons"
             />

         </RelativeLayout>

        <ProgressBar
            android:id="@+id/progressCircle"
            style="?android:attr/progressBarStyleLarge"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:visibility="gone"
            android:layout_centerVertical="true" />

        <ProgressBar
            android:id="@+id/progressBar"
            style="?android:attr/progressBarStyleHorizontal"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:visibility="gone"
            android:layout_centerVertical="true" />

        <ProgressBar
            android:id="@+id/progressCircle2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:layout_below="@id/bar"
            android:visibility="gone"
             />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_above="@id/adView"
            android:layout_centerHorizontal="true"
            android:orientation="horizontal">

            <Button
                android:id="@+id/settingsButton"
                style="@style/NewButton.ButtonSettings"
                android:layout_marginRight="5dp"
                android:layout_width="45dp"
                android:layout_height="45dp"
                 />
            <Button
                android:id="@+id/searchButton"
                style="@style/NewButton.ButtonSearch"
                android:layout_marginLeft="5dp"
                android:layout_width="45dp"
                android:layout_height="45dp"
                 />
            <Button
                android:id="@+id/infoButton"
                style="@style/NewButton.ButtonInfo"
                android:layout_marginLeft="5dp"
                android:layout_width="45dp"
                android:layout_height="45dp"
                 />
        </LinearLayout>

</RelativeLayout>

    <FrameLayout
        android:id="@+id/fragment_container"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
         >
    </FrameLayout>

</LinearLayout> 
```

真正奇怪的行为是，这种缓慢的启动仅在您第一次启动应用程序时发生，或者如果您关闭它已经有几个小时了，而如果您使用后退按钮甚至最近的应用程序关闭它，那么它会在一秒钟内启动，很快，我真的不明白为什么。PS adMob 也是应用程序的一部分。

编辑：这里是 TraceView（这里是原始[图像](http://img197.imageshack.us/img197/2491/traceview.png)）

![在此处输入图像描述](https://i.stack.imgur.com/dZ39X.png)

# amazon-ec2 - 将 RabbitMQ 从一个 EC2 实例迁移到另一个实例时丢失消息

> ID：15935558
> 
> 赞同：2
> 
> 时间：2013-04-10T20:15:36.257
> 
> 标签：amazon-ec2, rabbitmq, ec2-ami

我已经安装了 RabbitMQ，并且在 EC2 CentOS 6 实例上运行良好，具有各种队列和主题。我决定将此工作实例迁移到另一个具有相同操作系统和初始设置的新 EC2 服务器实例，只是更小一些。

我从现有安装创建了一个 AMI（Amazon 服务器映像），然后使用此 AMI 创建一个新的服务器实例。RabbitMQ 出现得很好，所有主题、用户、虚拟主机、队列等也是如此。

但是，尽管在创建服务器映像之前队列中确实存在消息，但队列都返回了 0 条消息。

问题：

1.  我在迁移过程中遗漏了什么吗？
2.  当消息在兔子队列中时，它们在哪里被明确地“存储”？

我相信这些消息是作为“持久”发送的，但不能 100% 确定这一点。我知道 RabbitMQ 实例的复制，但认为这种服务器重新创建方法会更简单/更快？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T20:05:09.367

@robthewolf 的评论需要进行更多搜索，但倾斜度略有不同（关于是否可以将队列消息显式保存在后备数据库/键值存储中）

这让我看到了这篇旧的，但似乎仍然相关的博客文章，它清楚地描述了 rabbit 当前在所有情况下的“持久性”方法（持久性发布、持久性等）

[http://www.rabbitmq.com/blog/2011/01/20/rabbitmq-backing-stores-databases-and-disks/](http://www.rabbitmq.com/blog/2011/01/20/rabbitmq-backing-stores-databases-and-disks/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-14T11:03:13.013

如果消息是持久的，您可以检查这个 SO[问题](https://stackoverflow.com/questions/3889227/rabbitmq-database-files/24979364#24979364)- RabbitMq 使用 Mnesia 存储，该存储连接到它正在运行的机器的 ip 地址，因此在[答案](https://stackoverflow.com/a/24979364/1255305)中几乎没有调整可以解决问题。

# android - Cloud Endpoints 支持超过 500 个字符的文本字段

> ID：15935561
> 
> 赞同：1
> 
> 时间：2013-04-10T20:15:43.600
> 
> 标签：android, google-app-engine, google-cloud-endpoints

我需要存储一个通常超过 500 个字符的字段。使用 String 数据类型时，App Engine 失败并建议在这种情况下使用 com.google.appengine.api.datastore.Text 数据类型。

这样做时，Android 客户端会失败并显示以下内容：

AndroidRuntime 标签：原因：java.lang.IllegalArgumentException：预期的原始类，但在 com.google.api.client.util.Data.parsePrimitiveValue(Data.java: 4 53)

超过 500 个字符的字符串值如何存储在 App Engine 中并受 Cloud Endpoint 支持？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-30T07:23:18.770

数据存储有文档限制 - 字符串为 500 个字符。您可以使用 Text （或未索引的 String，因为我相信 Text 已被弃用）绕过它。但这仅涵盖从数据存储中保存/读取数据。

端点方法单个参数有 500 个字符的未记录限制。这意味着如果您向该方法发送一些对象，在序列化后占用超过 500 个字符的空间，该方法将失败。

我确实通过使用 servlet 绕过了它。[在这里](https://stackoverflow.com/questions/23942383/the-string-property-has-a-value-that-is-too-long-it-cannot-exceed-500-character)查看我的问题

# c++ - Save Me Simple 通过注册表添加到启动

> ID：15935564
> 
> 赞同：-2
> 
> 时间：2013-04-10T20:15:51.863
> 
> 标签：c++, c, registry

好的，所以我已经尝试了 2 天了。我[用我的示例代码发布了一个问题，](https://stackoverflow.com/questions/15913202)答案只是让所有它不起作用的东西变得复杂。有人可以给我一个简单的添加注册表来启动我的程序吗？

1.  它必须自己找到.exe文件名+当前路径。

    `(TCHAR szPath[MAX_PATH];`

    `GetModuleFileName(NULL,szPath,MAX_PATH);)`

2.  它必须检查它是否已经存在，我们不必每次都添加它......

谢谢！！

它适用于开源 C 语言源。

编辑：如果可能的话，我也想将我自己的自定义参数添加到注册表中。

# c# - 如何使用 linq 语句获取正确的数据

> ID：15935567
> 
> 赞同：0
> 
> 时间：2013-04-10T20:15:59.720
> 
> 标签：c#, linq, linq-to-objects

该问题是从原始帖子演变而来的，因此为了扩大结果，我添加了一个单独的问题。

最初的任务得到了回答，但在这样做的过程中，我遇到了一个困扰我的新问题。请参阅此处的原始帖子：[LINQ 初学者，文档版本的表连接查询](https://stackoverflow.com/questions/15931830/linq-beginner-table-joining-query-for-document-version)

这是一个文档修订系统。我们正在使用两个表。一旦用户创建了新文档，信息就会添加到`Document`表中。此时，文档表有一个设置为 0 的修订版和一个设置为空的 dateApproved。主键是 documentID。

现在，如果用户编辑该文档，则会在新表中创建一行`Version`。

这是我拥有的 Linq，它正确地返回了所有需要批准的文档（2 个全新文档，`Documents`表中只有一行，1 个文档已经过编辑，因此它在 Documents 和 中有一行`Version`）。

```
var docs = db.IPACS_Document
               .Where(x => x.dateApproved == null 
                          || x.IPACS_Version.Any(y => y.dateApproved == null)); 
```

上面的 Linq 正确识别了所有需要批准的 3 个文档，但是对于在`Documents`表格和`Version`表格中有一行的文档。它正在返回 Document 表中的信息（实际上我需要 Version 表中已编辑项目的信息）。

有没有办法返回已编辑文档的版本表信息，它已经正确返回了全新文档的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:25:32.833

您需要`IEnumerable.Union`，但它仅适用于相同的元素类型。您有 2 种类型：`Version`和`Document`.

检查[这个](https://stackoverflow.com/a/7854366/1594178)答案如何使用它。

# javascript - 查找所有具有绝对位置的父元素

> ID：15935572
> 
> 赞同：0
> 
> 时间：2013-04-10T20:16:16.847
> 
> 标签：javascript, html, css-position

我正在编写一些 javascript 代码来将所有绝对定位的元素向下移动 60 像素（低于 60 像素高度的 div，我在代理的其他页面顶部显示）。这是我现在拥有的代码（主要是从stackoverflow上的另一个问题借来的）：

```
function getStyle(el, prop)
{
  var doc = el.ownerDocument;
  var view = doc.defaultView;
  if (view && view.getComputedStyle)
  {
    return view.getComputedStyle(el, '')[prop];
  }

  return el.currentStyle[prop];
}

function runAfterLoad()
{
  var all = document.getElementsByTagName('*');
  var i = all.length;
  while (i--)
  {
    var topOffset = parseInt(all[i].offsetTop, 10);
    if (getStyle(all[i], 'position') === 'absolute')
    {
      all[i].style.top = isNaN(topOffset) ? '60px' : (topOffset + 60) + 'px';
    }
  }
} 
```

不幸的是，这会将所有绝对定位的元素向下移动 60 像素。事实证明，我发现绝对定位实际上并不是浏览器窗口的绝对定位，而是满足某些特定规则的父级的绝对定位。这是这里另一个答案的引用：

> 这是因为“位置：绝对”的意思是“使用上、右、下、左”来定位自己相对于最近的具有“位置：绝对”或“位置：相对”的祖先。

因此，我正在寻求有关如何调整当前代码以仅查找具有绝对位置且没有父级也是绝对或相对定位的元素的帮助。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:20:04.263

另一种选择是利用这一事实对你有利。如果您要将整个页面包装在`div`绝对（或相对）定位的 中`top: 60px`，您实际上会立即将整个页面向下移动`60px`。

这也会移动非绝对元素。如果不希望这样做，那么这将不起作用。

# sql-server-2008 - 嵌套存储过程和事务范围

> ID：15935575
> 
> 赞同：0
> 
> 时间：2013-04-10T20:16:20.847
> 
> 标签：sql-server-2008, stored-procedures, scope

我有一个主要的工作程序和一个附带的记录程序。我正在寻找关于我对 sql server 2008 的假设的验证。期望的结果是 SP1 做它可以做的任何工作，并在记录进度的过程中调用 SP2。无论 SP1 是否遇到会导致其事务回滚的错误，都将提交 SP2 工作。

我所拥有的看起来安全吗？我需要在 SP2 中以不同的方式命名事务吗？

```
------------------------------------------------------- SP1 pseudocode
BEGIN TRY
    BEGIN TRANSACTION

    -- Do stuff
    -- log progress
    exec SP2( getutcdate(), 'source_is_sp1','message for progress');

    -- Do more stuff
    -- log progress
    exec SP2( getutcdate(), 'source_is_sp1','message for progress');

    -- etc

    COMMIT TRANSACTION
    RETURN 0
END TRY
BEGIN CATCH
    -- error handling not important
    ROLLBACK TRANSACTION
    return @StepNumber -- not important 
END CATCH

------------------------------------------------------- SP2

CREATE PROCEDURE [dbo].[SP2]

    @Source as nvarchar(100),
    @Timestamp as datetime,
    @Message as nvarchar(4000)

AS
BEGIN
    SET NOCOUNT ON;

    IF @Timestamp is null
    BEGIN
        set @Timestamp = GETUTCDATE();
    END

    IF @Source IS NOT NULL AND @Message IS NOT NULL
    BEGIN
        BEGIN TRANSACTION;
            INSERT INTO LOG(LOGTIMESTAMP, SOURCEVCH, MESSAGEVCH) 
                    VALUES (@Timestamp, @Source, @Message);
        COMMIT TRANSACTION;
    END
END 
```

# nservicebus - 在长时间不活动之后触发 NServiceBus Saga 处理程序

> ID：15935579
> 
> 赞同：0
> 
> 时间：2013-04-10T20:16:32.133
> 
> 标签：nservicebus, saga

我有一个长期运行的业务流程（几周，而不是几分钟）。该过程的开始由用户的动作触发。我遇到的问题是，传奇中的下一步将来自两个地方之一，或者第二次用户交互，或者如果在一段时间后说 1 周后用户没有执行操作，那么传奇中的另一个点应该被触发。

saga 是在这个业务流程中使用的正确机制吗？如果是这样，这是如何实现的？如果 saga 不适合此任务，是否有比简单地对数据库执行夜间批处理作业更好的机制？我对运行夜间批处理作业的反感只是我必须点击以查询传奇中的下一个点的数据库表的大小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T03:34:06.260

是的 - sagas 正是为这些场景而设计的。

# magento - Magento 类别布局 - 拆分目录/类别/view.pthml

> ID：15935580
> 
> 赞同：0
> 
> 时间：2013-04-10T20:16:32.770
> 
> 标签：magento, layout, categories

Magento 1.7.0.2

我有模板大师安装的简易目录图像。我想让标题、RSS 链接、描述等出现在这个模块和下面列出的产品上方。

因此，我将 view.phtml 拆分为 title.ptmhl 和 view.phtml 并且想要以下布局。

标题.phtml

简易目录图像

视图.phtml

我的 title.phtml 位于 catalog/category/title.phtml 如下：

```
<?php
$_helper    = $this->helper('catalog/output');
$_category  = $this->getCurrentCategory();
$categoryName = $this->htmlEscape($_category->getName());
$_imgHtml   = '';
if ($_imageUrl = $_category->getImageUrl()) {
    $_imgHtml = '<img src="'.$_imageUrl.'" alt="'.$this->htmlEscape($_category->getName()).'" />';
    $_imgHtml = $_helper->categoryAttribute($_category, $_imgHtml, 'image');
}?>
<?php echo $this->getMessagesBlock()->getGroupedHtml() ?>
    <div class="page-title category-title">
<?php if($this->IsRssCatalogEnable() && $this->IsTopCategory()): ?>
    <a href="<?php echo $this->getRssLink() ?>" class="link-feed right" title="<?php echo sprintf($this->__('Subscribe to the %s RSS Feed'), $categoryName) ?>" target="_blank"><?php echo sprintf($this->__('Subscribe to %s RSS Feed'), $categoryName) ?></a>
<?php endif; ?>
<h2><?php echo $_helper->categoryAttribute($_category, $this->htmlEscape($_category->getName()), 'name') ?></h2>
</div>

<?php if($_imgHtml): ?>
    <p><?php echo $_imgHtml?></p>
<?php endif; ?>
<?php if($_description=$_category->getDescription()): ?>
    <p class="category-description std"><?php echo $_helper->categoryAttribute($_category, $_description, 'description') ?></p>
<?php endif; ?>
</div> 
```

view.phtml 已被更改为排除上述“page-title category-title”类的所有实例。

我尝试在 catalog.xml 中引用 title.phtml，如下所示

```
 <reference name="content">
            <block type="catalog/category_title" name="category.title" template="catalog/category/title.phtml">
        <block type="catalog/category_view" name="category.products" template="catalog/category/view.phtml"> 
```

title.phtml 不显示。

# websocket - 使用 Torquebox 向浏览器发送消息

> ID：15935582
> 
> 赞同：2
> 
> 时间：2013-04-10T20:16:37.647
> 
> 标签：websocket, jrubyonrails, hornetq, torquebox

所以我们的团队最近在我们的 jruby on rails 应用程序中实现了扭矩箱。这样做的目的是能够从流实时数据的外部源接收队列/主题消息。

我们已经设置了我们的队列/主题，他们正在毫无问题地接收消息。我们要采取的下一步是在浏览器上获取这些消息。

所以我们开始研究利用 stomp 的力量。但是我们遇到了一些问题。从文档看来，使用 stomp + websockets 的目的是从客户端接收消息并将这些消息推送到其他客户端。但是我们想在我们的队列上接收消息，然后使用 websockets 将这些消息推送到客户端。这可能吗？或者我们是否必须实现不同的技术，例如 Pusher 或 socket.io 才能将队列/主题消息发送到浏览器？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-07T17:48:10.027

确实可以将消息直接从服务器推送到客户端。我花了很多时间才找到它，因为它没有直接列在文档中。他们的博客在他们的示例中列出了如何使用 websockets 构建聊天客户端。

[http://torquebox.org/news/2011/08/23/stomp-chat-demo-part3/](http://torquebox.org/news/2011/08/23/stomp-chat-demo-part3/)

基本上，您使用该`inject`方法选择要发布到哪个频道，然后使用`publish`返回对象上的方法实际发送消息。这篇文章中的这段代码摘录应该能让你找到正确的方向。

```
inject( '/topics/chat' ).publish( message, 
                                  :properties=>{ 
                                    :recipient=>username, 
                                    :sender=>'system' 
                                   } ) 
```

它看起来与`:properties`消息头相同。我将在接下来的几天里尝试一下，看看它在 Rails 中的效果如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T13:12:00.820

我认为 stomplets 是完成这项任务的好方法。在 Rails 应用程序中，您应该使用 ruby​​ base stomp 客户端，在浏览器中使用 javascript base stomp 客户端。在 Rails 中只是发送数据，在浏览器中只是接收。您可以在扭矩箱文档 [http://torquebox.org/documentation/2.0.0/stomp.html中找到更多详细信息](http://torquebox.org/documentation/2.0.0/stomp.html)

# android - BitmapFactory.decodeByteArray() 返回 null

> ID：15935583
> 
> 赞同：0
> 
> 时间：2013-04-10T20:16:43.927
> 
> 标签：android, rtsp, rtp, android-video-player

我必须制作一个接收 RTP 数据包、获取有效负载并在屏幕上显示图像的 android MJPEG 播放器。

这就是我获取数据包的方式：

**RTP.java**

```
socket.receive(receive_packet);
rtp_packet = new RtpPacket(receive_packet.getData(), receive_packet.getLength()); 
```

**RtpPacket.java**

```
//Load header
header = new byte[12];
for(int i = 0; i < 12; i++)
    header[i] = packet[i];

//Load payload
int payload_length = size - 12;
payload = new byte[payload_length];
for (int i = 12; i < payload_length; i ++)
    payload[i-12] = packet[i];

//This is actually handled in the activity view, but it's here for testing purposes
Bitmap bmp = BitmapFactory.decodeByteArray(payload, 0, payload_length); 
```

出于某种原因， bmp 始终为空。我检查了我的有效载荷，看起来不错；它是一个 byte[] 数组，通常在 2000-4000 之间，看起来像 [-1,-40,-32,-0,16.. etc]。我确定 RTP 数据包的标头大小应该是 12。

有人对我如何解决这个问题有见解吗？

# android - 在插入数据库之前对大量数据进行排序

> ID：15935593
> 
> 赞同：0
> 
> 时间：2013-04-10T20:17:21.963
> 
> 标签：android, json, sqlite, gson, greendao

我需要下载一个大的 json 字符串。我为此使用aQuery。然后我需要在对象列表（10k +）中解析这个字符串（我为此使用 Gson 库）并将这个列表插入数据库（使用 GreenDAO 创建）。但在插入之前，我需要按我的对象字符串字段对该列表进行排序。我正在使用 Collat​​or 类进行排序，因为该文件可能使用不同的语言。问题是：如何使用尽可能少的内存来做这样的事情？

现在我下载一个字符串（+String，我也尝试过使用 Streams）然后解析它（+List）然后对其进行排序（更多对象）。我在一个单独的线程中做它，但即使它完成了内存也没有释放。我认为如果我可以在数据已经在数据库中时对数据进行排序（而不是在选择它时，它会很慢），那么这可以解决，但我不知道如何。

这是一些代码。这是从文件加载数据。从文件加载时内存也存在同样的问题，我使用 InputStream 而不是将 JSON 字符串放入内存。

```
public static void getEnciclopediaDataFromFile() {
    mRequestStates.put("enc", true);

    try {
        EncyclopediaParser parser = new EncyclopediaParser(ResourceManager.getResourceManager().loadFile("enc_data"),
                                                           ResourceManager.getResourceManager().loadFile("enc_data"),
                                                           1361531132);
        parser.start();
    } catch (Exception e) {
        mRequestStates.put("enc", false);
        EventBus.getDefault().post(EVENT_ENCYCLOPEDIA_DOWNLOAD_COMPLETE);
    }
} 
```

这是解析器线程。有两个构造函数 - 一个用于从 Web 加载（字符串参数），另一个用于从文件加载（InputStream 参数）。

```
 private static class EncyclopediaParser extends Thread {
    // -----------------------------------------------------------------------
    //
    // Fields
    //
    // -----------------------------------------------------------------------
    private String mJsonData;
    private Reader mTitlesReader;
    private Reader mContentReader;
    private long mUpdateTime;

    // -----------------------------------------------------------------------
    //
    // Constructor
    //
    // -----------------------------------------------------------------------
    public EncyclopediaParser(String jsonData, long updateTime) {
        mJsonData = jsonData;
        mUpdateTime = updateTime;
        this.setPriority(Thread.NORM_PRIORITY - 1);
    }

    public EncyclopediaParser(Reader titlesReader, Reader contentReader, long updateTime) {
        mTitlesReader = titlesReader;
        mContentReader = contentReader;
        mUpdateTime = updateTime;
        this.setPriority(Thread.NORM_PRIORITY - 1);
    }

    // -----------------------------------------------------------------------
    //
    // Methods
    //
    // -----------------------------------------------------------------------
    @Override
    public void run() {
        Type type;

        try {
            List<ArticleContent> content = null;
            type = new TypeToken<Collection<ArticleContent>>(){}.getType();
            if(mContentReader == null)
                content = new Gson().fromJson(mJsonData, type);
            else
                content = new Gson().fromJson(mContentReader, type);

            List<ArticleTitle> titles = null;
            type = new TypeToken<Collection<ArticleTitle>>(){}.getType();
            if(mTitlesReader == null)
                titles = new Gson().fromJson(mJsonData, type);
            else
                titles = new Gson().fromJson(mTitlesReader, type);

            for(ArticleTitle title : titles)
                title.setTitle(title.getTitle().trim());

            TitlesComparator titlesComparator = new TitlesComparator();
            Collections.sort(titles, titlesComparator);
            for(int i = 0; i < titles.size(); ++i)   //sorting enc data
                titles.get(i).setOrderValue((long)i);

            //create sections data
            Collator collator = Collator.getInstance(Locale.GERMAN);
            collator.setStrength(Collator.PRIMARY);
            ArrayList<String> sectionNamesList = new ArrayList<String>();
            ArrayList<Integer> sectionIndexesList = new ArrayList<Integer>();
            String prevLetter = "";
            for (int i = 0; i < titles.size(); ++i) {
                if(titles.get(i).getTitle().length() > 0){
                    if(!Character.isLetter(titles.get(i).getTitle().charAt(0))) {
                        if( !sectionNamesList.contains("#")) {
                            sectionNamesList.add("#");
                            sectionIndexesList.add(i);
                        }
                    }
                    else if(collator.compare(titles.get(i).getTitle().substring(0, 1), prevLetter) > 0) {
                        sectionNamesList.add(titles.get(i).getTitle().substring(0, 1).toUpperCase(Locale.GERMAN));
                        sectionIndexesList.add(i);
                    }
                    prevLetter = titles.get(i).getTitle().substring(0, 1);
                }
            }
            String[] sectionNames = new String[sectionNamesList.size()]; //use lists instead
            Integer[] sectionIndexes = new Integer[sectionIndexesList.size()];
            sectionNamesList.toArray(sectionNames);
            sectionIndexesList.toArray(sectionIndexes);
            AppData.setSectionIndexes(Utils.convertIntegers(sectionIndexes));
            AppData.setSectionNames(sectionNames);

            GreenDAO.getGreenDAO().insertArticles(titles, content);
            AppData.setEncyclopediaUpdateTime(mUpdateTime);
            mRequestStates.put("enc", false);
            if(mTitlesReader != null)
                mTitlesReader.close();
            if(mContentReader != null)
                mContentReader.close();
        } catch (Exception e) {
            Log.e("Server", e.toString());
        } finally {
            EventBus.getDefault().post(EVENT_ENCYCLOPEDIA_DOWNLOAD_COMPLETE);
        }
    }
} 
```

所有 GreenDAO 对象都是静态的。解析仅在第一次启动（从文件）和通过“更新”按钮单击（从网络）时完成。我注意到，即使我在初始（从文件）解析完成后重新启动我的应用程序，它也会使用与第一次完成解析后一样多的内存。

# php - PHP - 如何获取变量的名称？

> ID：15935602
> 
> 赞同：-2
> 
> 时间：2013-04-10T20:17:44.477
> 
> 标签：php, variables, namespaces

我想为调试目的制作一个小函数，以人类可读的格式打印变量的内容。

该功能基于 CakePHP 框架中的快捷[方式](http://api.cakephp.org/2.0/source-function-pr.html#214-228)`pr()`，即：

到目前为止我有这个：

```
function pr($var,$msg){
    $pr_debug=true;
    if($pr_debug){
        echo "<pre>";
        if($msg) echo "<b>".$msg.": </b>";
        if(gettype($var)=="array" || gettype($var)=="object" ) echo "<br>";
        print_r($var);
        echo "</pre>";
    }
} 
```

它在变量内容之前打印一条可选消息 ($msg)。

但我要补充的是，如果没有发送消息，也可以打印变量的名称作为这样的消息，所以我可以得到这样的东西：

```
$myvar="hello";
pr($myvar); 
```

//应该输出：

```
myvar: hello 
```

那么在我的函数中，我怎样才能将变量的名称作为字符串来输出呢？即`pr($foo);`我需要`"foo"`， `$name="biz"; pr($$name);`我需要`"biz",` 等等......

最好我想要一些尽管 PHP 全局配置或其中任何一个都可以工作的东西（顺便说一下，我不太了解，所以对 GLOBALS 的任何帮助将不胜感激）。

谢谢！

额外：在stackoverflow，我如何格式化源代码以获得PHP格式和颜色？截至目前，我简单地使用了文本区域中的工具栏并选择了“代码示例”......

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-10T20:20:03.620

你想要的是可变变量......但事实上，你不想要它们。它们几乎和现代编程中的“goto”一样糟糕：

```
$foo = 'bar';
$baz = 'foo';
echo $$baz;   // bar
     ^^-- note the doubled $'s 
```

问题是，当您获得调试代码时，变量名称的“源”已经丢失，例如

```
function debug($out) {
   global $$out;
   echo $out, ': ', $$out;
}

$foo = 'bar';
debug($foo); 
```

这不会输出“foo”作为名称，因为名称“$foo”没有传递给函数。只有 的 VALUE`$foo`进入`bar`。

# java - 使用限制最大化总和

> ID：15935619
> 
> 赞同：0
> 
> 时间：2013-04-10T20:18:46.517
> 
> 标签：java, sum, combinations, maximize

我必须得到一些不超过限制的数字的最高总和。

例如 5、7、14 和 13 的限制，我必须选择 5 和 7。

这个例子只有 3 个数字，但我必须能够用更多的数字来做到这一点。

有没有图书馆或方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:55:45.663

我假设允许的输入是正整数。这将返回`[7, 5]`您问题中的示例。

```
public class Knapsack {
  private class State {
    State previousState = null;
    int value = 0;
  }

  public List<Integer> solve(List<Integer> list, int limit) {
    // validate input
    if (limit < 0) {
      throw new IllegalArgumentException();
    }
    if (list == null) {
      throw new IllegalArgumentException();
    }
    for (Integer i: list) {
      if (i == null || i.intValue() <= 0) {
        throw new IllegalArgumentException();
      }
    }

    // if the limit is 12, then 0 through 12 inclusive are valid amounts
    State[] states = new State[limit + 1];
    // the state at position x represents a way of achieving a sum of x
    // if a state is null it means we can't get that sum, for example in your
    // question there's no way to get a sum of 11 with any combination of inputs

    // base state -- we can always get a sum of zero if we just take nothing
    states[0] = new State();

    // build up more states
    for (Integer i: list) {
      // iterate through the states backwards
      // if we iterate forwards we'll encounter any changes we make to the list
      // during the iteration, which has the effect of taking the same number
      // multiple times
      for (int j = limit - i.intValue(); j >= 0; --j) {
        if (states[j] != null) {
          State newState = new State();
          newState.previousState = states[j];
          newState.value = i.intValue();
          states[i.intValue() + j] = newState;
        }
      } 
    }

    // find the best state
    State s = null;
    for (int i = limit; i >= 0; --i) {
      if (states[i] != null) {
        // if all you care about is the best achievable sum, you can just
        // return i here
        s = states[i];
        break;
      }
    }

    // build the list of numbers
    List<Integer> ret = new ArrayList<Integer>();
    while (s.previousState != null) {
      // this will add them backwards, change to add to the beginning of the list
      // to preserve the same order as the input
      ret.add(Integer.valueOf(s.value));
      s = s.previousState;
    }

    return ret;
  }

  public static void main(String[] arg) {
    List<Integer> list = new ArrayList<Integer>();
    for (int i: new int[] { 5, 7, 9 }) {
      list.add(Integer.valueOf(i));
    }
    int limit = 13;

    Knapsack k = new Knapsack();
    System.out.println(k.solve(list, limit));
  }
} 
```

# sql - SQL Server 根据 ID 复制内容

> ID：15935621
> 
> 赞同：0
> 
> 时间：2013-04-10T20:18:48.183
> 
> 标签：sql, sql-server

在我的数据库中，我有 3 个不同实体的 7 行，我想根据 ID 值将一个实体的内容镜像到另外两个。我不知道更新声明是否合适。

```
CoId  DocumentType  StatusId  StatusDescription  Default  Text  Progression  Environment  RequiredOnAssign  TS  DocumentFilterGroup 
```

这些是我的列标题，`CoId`可以是三个值之一，1、2 或 3。我希望根据状态 ID 将 1 的内容复制到 2 和 3 中。我无法表达比这更进一步的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T22:00:16.700

如果我理解正确，那么自我加入是您最好的朋友：

```
UPDATE t1
SET DocumentType = t1.DocumentType, StatusDescription = t1.StatusDescription, Default = t1.Default -- the same for the rest of the fields
FROM table t1 
INNER JOIN table t2 
ON t1.CoID in (2,3) and t2.CoID = 1
WHERE StatusID = ... 
```

# monkeyrunner - MonkeyRunner 中的 getProperty 和 getSystemProperty 返回无

> ID：15935622
> 
> 赞同：3
> 
> 时间：2013-04-10T20:18:55.200
> 
> 标签：monkeyrunner

我是 Android 开发和测试的新手，目前我正在训练在 Python 下制作测试脚本，然后使用 monkeyrunner 运行它们。

正如 MonkeyDevice 官方文档中所说，[getProperty()][1] 和 [getSystemProperty()][2] 应该返回一个取决于您为它们传递的属性变量名称的值。每次我只得到“无”值。有什么想法或技巧吗？！

我正在使用的简单代码：

```
from com.android.monkeyrunner import MonkeyDevice,MonkeyRunner

device = MonkeyRunner.waitForConnection()

print device.getSystemProperty('version.sdk') 
```

问候，，，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T11:09:43.913

您需要指定属性组。例如：

```
print device.getSystemProperty('build.version.sdk') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-17T08:31:13.633

无论出于何种原因，两者都`getProperty()`对`getSystemProperty()`我不起作用，但您可以运行：

`$ adb shell getprop`

它返回属性/值的完整列表

# git - 从 .git/config 删除设置时如何避免出现空白部分？

> ID：15935624
> 
> 赞同：7
> 
> 时间：2013-04-10T20:19:04.280
> 
> 标签：git, configuration-files

如果我这样做`git config foo.bar baz`，这会添加一个`foo`部分`.git/config`：

```
...
[foo]
        bar = baz
... 
```

我可以使用 再次删除设置`git config --unset foo.bar`，但该部分仍保留在文件中，其中没有任何内容：

```
...
[foo]
... 
```

如果我添加另一个`foo`设置`git config foo.bar baz`，`git-config`则不会将其添加到空白`foo`部分；它开始一个新的：

```
...
[foo]
[foo]
        bar = baz
... 
```

我的问题是：

1.  这是预期的行为吗？
2.  如果不是，那是一个错误吗？
3.  取消配置时，有没有办法避免配置文件中可能出现的空白部分？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-06-15T20:38:55.623

要回答第 3 点，您可以使用结果`git config --get-regexp`来决定何时清理：

```
git config --unset "foo.bar";
# Cleanup empty "foo" section.
# Regular expression has a trailing period to avoid testing against
# other sections that share the same prefix (e.g. "foo" vs "food").
if ! git config --get-regexp '^foo\.'; then
    git config --remove-section "foo" 2> /dev/null;
fi; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-10T20:31:21.650

这样`git config --remove-section`你就可以删除整个部分。但是，是的，对我来说，如果存在空白，它会创建一个新部分，这看起来像是一个错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-05-10T13:35:30.723

> 从 .git/config 删除设置时如何避免出现空白部分？

这应该通过 Gti 2.18（2018 年第二季度）修复：
“ `git config --unset a.b`”，当“ `a.b`”是原本为空的部分“”中的最后一个变量时`a`，留下了一个空的部分“a”，更糟糕的是，后续的“ `git config a.c value`”没有重用那个空壳，而是创建了一个新的。
这些已（部分）更正。

参见[提交C71D8BB](https://github.com/git/git/commit/c71d8bb38a73abc910a63bf7a81f3869dc9c2f34)，[提交22AEDFC](https://github.com/git/git/commit/22aedfccd0cfe7c8f09a990cf4777efc7f27bd2e)，[提交6AE996F ，](https://github.com/git/git/commit/6ae996f2acf3ad780b8d338c81e24143f0b0d304)[提交5221C31](https://github.com/git/git/commit/5221c3159f670281ff36b6adbdf568661e930b50)，[提交668B9AD](https://github.com/git/git/commit/668b9ade6bcafbed1577468902d27c05c17cf026) ，提交费用8572 ，[提交8032cc4](https://github.com/git/git/commit/fee8572c6ddf6afcfeba023067fea36b835a9df4)，[提交B73BDC3](https://github.com/git/git/commit/8032cc4462b8af268fe457c2a0431473334dfd18)，[提交B73BDC3](https://github.com/git/git/commit/b73bdc34c06358359750a896983a2ea85b694ca0)，[提交](https://github.com/git/git/commit/83b7fd87714c4b70553c56987756ff319ccc7ec6)[422E8EF](https://github.com/git/git/commit/422e8ef26d35a7e54d5b7b990669f4a525cb8828)（2018年4月9日）和[提交](https://github.com/git/git/commit/dde154b5bd84e6258b496498901eb24b4914ec6b)[DDE154B](https://github.com/git/git/commit/efbaca1b69b2d08429889259489b73c8eea16a1d)，提交[85BF5D6](https://github.com/git/git/commit/85bf5d61e717f79f7ac68d15e336e54293035405)，[commit](https://github.com/git/git/commit/46fc89ce74b46e88764c796b3ab20d5ab90a5e96) [compt](https://github.com/git/git/commit/e9313952bf85bcc8b602f582b2e71660d670f97b) [83b7fd8](https://github.com/git/git/commit/83b7fd87714c4b70553c56987756ff319ccc7ec6)（2018 年 4 月 3 日），作者[Johannes Schindelin（](https://github.com/dscho)[）](https://github.com/dscho)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 4f4d0b4](https://github.com/git/git/commit/4f4d0b42bae8091fd989aa6d7db72ecdd86aa36b))[`dscho`](https://github.com/dscho)
^([`gitster`](https://github.com/gitster), 2018 年 5 月 8 日))

> ## git config --unset：删除空白部分（在常见情况下）
> 
> 在删除最后一个条目时不删除部分标题的原始原因是这样的：用户可能已经添加了关于该部分的评论，或者关于其中的条目，如果那里有其他评论，我们不知道我们是否应该删除他们。
> 
> 特别是，提出了一个看起来像这样的编造示例（并添加到 t1300）：

```
# some generic comment on the configuration file itself
# a comment specific to this "section" section.
[section]
# some intervening lines
# that should also be dropped

key = value
# please be careful when you update the above variable 
```

> 在这种情况下，理想的`git config --unset section.key`做法是只留下第一行，因为所有其他注释现在都已过时。
> 
> 但是，这是不可行的，没有在 Git 中添加一个完整的自然语言处理模块，这看起来不仅工作量很大，而且是一个完全不合理的功能（对大多数用户来说几乎没有什么好处）。
> 
> 现在，关于这个问题的真正关键是：大多数用户根本不编辑他们的配置文件！在他们的用例中，配置看起来像这样：

```
[section]
    key = value 
```

> ...如果删除该条目会发生什么，这是完全显而易见的：整个部分应该消失。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-10T20:31:34.320

Thomas Rast[在 git developer mailing list 上](http://thread.gmane.org/gmane.comp.version-control.git/219505/focus=219513)引起了我的注意。

根据我对 Peff 的描述的理解，如果配置解析器的编程不是那么临时，那么问题将很容易解决。解析文件后，结果是一个包含配置设置的结构，但没有文件的原始结构。由于调用者无法获得有关节结构的信息，因此设置插入代码无法知道是否存在具有正确标题的空节。删除空白部分也有点棘手，因为它们可能包含重要的注释，不应*仅仅*因为该部分的最后一个功能部分被删除而自动删除。

结论是：

1.  不，这不是预期的行为；
2.  是的，这是一个错误。

这种编程很乏味但很简单，所以我会看看我是否可以制作一个补丁。

# android - android布局按钮上的箭头键效果-

> ID：15935626
> 
> 赞同：0
> 
> 时间：2013-04-10T20:19:09.840
> 
> 标签：android

我有三个基于布局的按钮。我正在为android棒开发这个项目，所以用户将使用键盘。当用户使用箭头键在按钮之间导航时，我想显示选定状态，就像我们在列表/网格视图中一样。用户使用键盘时如何添加选择的制作按钮？

```
 <LinearLayout 
    android:layout_width="fill_parent"
    android:layout_height="90dip"
    android:id="@+id/linear_top_button"
    android:orientation="horizontal" 
    android:paddingLeft="15dip"
    android:gravity="center_vertical"
    android:background="#041F34"
    android:clickable="true"
    android:focusable="true">
    <TextView
        android:id="@+id/date_text"
        android:layout_width="wrap_content"
        android:layout_height="70dip"
        android:text="06.56"
        android:textColor="#475B6D"
        android:typeface="sans" 
        android:textSize="22sp"
        android:textStyle="bold"
        android:gravity="center_vertical"/>
    <TextView
        android:id="@+id/day_text"
        android:layout_width="wrap_content"
        android:layout_height="70dip"
        android:paddingLeft="8dip"
        android:text="Day"
        android:textColor="#FFFFFF"
        android:typeface="sans" 
        android:textSize="22sp"
        android:textStyle="bold"
        android:gravity="center_vertical"/>

</LinearLayout>
 <LinearLayout 
    android:layout_width="fill_parent"
    android:layout_height="90dip"
    android:orientation="horizontal" 
    android:paddingLeft="15dip"
    android:id="@+id/linear_second_button"
    android:gravity="center_vertical"
    android:clickable="true"
    android:background="#041F34"
    android:layout_marginTop="2dip"
    android:focusable="true">
    <TextView
        android:id="@+id/date_text"
        android:layout_width="wrap_content"
        android:layout_height="70dip"
        android:text="06.56"
        android:textColor="#475B6D"
        android:typeface="sans" 
        android:textSize="22sp"
        android:textStyle="bold"
        android:gravity="center_vertical"/>
    <TextView
        android:id="@+id/day_text"
        android:layout_width="wrap_content"
        android:layout_height="70dip"
        android:paddingLeft="8dip"
        android:text="Day"
        android:textColor="#FFFFFF"
        android:typeface="sans" 
        android:textSize="22sp"
        android:textStyle="bold"
        android:gravity="center_vertical"/>

</LinearLayout>

    <LinearLayout 
    android:layout_width="fill_parent"
    android:layout_height="90dip"
    android:orientation="horizontal" 
    android:paddingLeft="15dip"
    android:layout_marginTop="2dip"
    android:id="@+id/linear_third_button"
    android:gravity="center_vertical"
    android:background="#041F34"
    android:clickable="true"
    android:focusable="true">
    <TextView
        android:id="@+id/date_text"
        android:layout_width="wrap_content"
        android:layout_height="70dip"
        android:text="06.56"
        android:textColor="#475B6D"
        android:typeface="sans" 
        android:textSize="22sp"
        android:textStyle="bold"
        android:gravity="center_vertical"/>
    <TextView
        android:id="@+id/day_text"
        android:layout_width="wrap_content"
        android:layout_height="70dip"
        android:paddingLeft="8dip"
        android:text="Day"
        android:textColor="#FFFFFF"
        android:typeface="sans" 
        android:textSize="22sp"
        android:textStyle="bold"
        android:gravity="center_vertical"/>

</LinearLayout>

_oneButton.setOnClickListener(
            new View.OnClickListener() {    
                @Override
                public void onClick(View v) {
                    _oneButton.setBackgroundColor(Color.parseColor("#163040"));//#163040//#041F34 n
                    _twoButton.setBackgroundColor(Color.parseColor("#041F34"));
                    _threeButton.setBackgroundColor(Color.parseColor("#041F34"));
                    Log.d("p","1"); //Never called!
                }
            }
      );
    _twoButton.setOnClickListener(
            new View.OnClickListener() {    
                @Override
                public void onClick(View v) {
                    _twoButton.setBackgroundColor(Color.parseColor("#163040"));//#163040//#041F34 n
                    _oneButton.setBackgroundColor(Color.parseColor("#041F34"));
                    _threeButton.setBackgroundColor(Color.parseColor("#041F34"));
                    Log.d("p","2"); //Never called!
                }
            }
      );
    _threeButton.setOnClickListener(
            new View.OnClickListener() {    
                @Override
                public void onClick(View v) {
                    _threeButton.setBackgroundColor(Color.parseColor("#163040"));//#163040//#041F34 n
                    _oneButton.setBackgroundColor(Color.parseColor("#041F34"));
                    _twoButton.setBackgroundColor(Color.parseColor("#041F34"));
                    Log.d("p","3"); //Never called!
                }
            }
      ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T22:40:56.017

通过实现 onfocus 侦听器解决了问题。

```
 _threeButton.setOnFocusChangeListener(new   View.OnFocusChangeListener() {

        @Override
        public void onFocusChange(View v, boolean hasFocus) {
            // TODO Auto-generated method stub
            _threeButton.setBackgroundColor(Color.parseColor("#163040"));//#163040//#041F34 n
            _oneButton.setBackgroundColor(Color.parseColor("#041F34"));
            _twoButton.setBackgroundColor(Color.parseColor("#041F34"));

        }
    }); 
```

# php - REST API 将一家公司链接到另一家公司 FOSRestBundle

> ID：15935627
> 
> 赞同：1
> 
> 时间：2013-04-10T20:19:09.840
> 
> 标签：php, rest, symfony, doctrine-orm, fosrestbundle

在我正在开发的 REST API 中，公司有一个父属性，该属性也属于公司类。

这样我就可以创建三个公司。一个公司有一个**母公司**（公司类），可以有**多个**子公司（集合）

```
/**
* @ORM\ManyToOne(targetEntity="Company", inversedBy="child")
* @Expose()
*/
protected $parent;

/**
* @ORM\OneToMany(targetEntity="Company", mappedBy="parent")
*/
protected $child;

public function __construct()
{
    ...
    $this->child = new \Doctrine\Common\Collections\ArrayCollection();
} 
```

我将如何着手和建立/消除这种父母和儿童公司的关系？

我已经阅读了**LINK**动词，但恐怕并非所有网络服务器都支持它。

我应该设置与 PUT 的关系吗？然后我将如何删除与父级的关系（将其设置为 NULL）。

我的 CompanyController 如下所示：

```
/**
    * Edit Action
    * 
    * @Rest\View()
    */
   public function editAction(Company $company)
   {
       return $this->processForm($company);
   }

   /**
    * Remove Action
    * 
    * @Rest\View(statusCode=204)
    */
   public function removeAction(Company $company)
   {
        $em = $this->getDoctrine()->getManager();
        $em->remove($company);
        $em->flush();
   }
   /**
    * ProcessForm Action
    */
   private function processForm(Company $company)
   {

       $statusCode = $this->getRequest()->getMethod() == 'POST' ? Codes::HTTP_CREATED : Codes::HTTP_SEE_OTHER;

       $form = $this->createForm(new CompanyType(), $company);
       $form->bind($this->getRequest());

       if($form->isValid())
       {
           $em = $this->getDoctrine()->getManager();
           $em->persist($company);
           $em->flush();

           return $this->redirectView(
            $this->generateUrl(
                'company_get',
                array('id' => $company->getId())
            ),
            $statusCode
            );

       }

       return View::create($form, 400);
   } 
```

有什么建议么？

# jsf - 如何根据迭代实体在 ui:repeat 中设置 selectiOneRadioButton-value？

> ID：15935628
> 
> 赞同：0
> 
> 时间：2013-04-10T20:19:10.423
> 
> 标签：jsf, setter, repeat, selectoneradio

在我的用例中，我有一个（Primefaces）selectOneRadio。这是在 ui:repeat 中。selectOneRadio 的值显示得很好。我希望每个 selectOneRadio 都有一个有用的默认值，具体取决于迭代实体。这也很好，选择了默认值。但是使用我的方法，我无法设置 selectOneRadio 的值，因为出现了异常：

```
javax.el.PropertyNotWritableException: [...] value="#{orderBean.getProductPriceId(product)}": Illegal Syntax for Set Operation 
```

**如何根据迭代实体在 ui:repeat 中设置 selectiOneRadioButton-value？**

订单豆：

```
public class OrderBean {
    private String productPriceId; // + getter and setter
    public String getProductPriceId(final Product product) {
        return product == null ? "" : product.getPricesAsList().get(0).getId().toString();
    }
} 
```

xhtml:

```
<ui:repeat var="product" value="...">
        <p:selectOneRadio value="#{orderBean.getProductPriceId(product)}">
            ...
        </p:selectOneRadio>
</ui:repeat> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T20:28:41.537

这确实没有意义。您需要确保模型与视图匹配，而不需要任何额外的业务逻辑。

只需使用

```
<p:selectOneRadio value="#{product.priceId}"> 
```

并给默认项目一个值`null`而不是，`""`以便它匹配。

# android - 如何将一项服务绑定到多个应用程序

> ID：15935631
> 
> 赞同：3
> 
> 时间：2013-04-10T20:19:18.373
> 
> 标签：android, service

我们对使用服务进行 Android 编程非常陌生。我们设法通过一个应用程序运行服务。现在，我们有一个所有者应用程序“AppA”启动了该服务，还有另一个应用程序“AppB”想要使用该服务。那么我们如何将这个应用程序“AppB”绑定到同一个正在运行的服务呢？是否应该创建多个服务实例（这可能吗？）还是我们可以将多个应用程序绑定到同一个服务实例？

我们创建了一个名为 initservice() 的函数，以便将活动绑定到服务。

所有者 App A 在 initService() 中的代码：

```
connection = new SampleServiceConnection();
Intent i = new Intent();
i.setClassName("com.example.basicstuff",com.example.basicstuff.SampleService.class.getName());
this.startService(i);
boolean ret = bindService(i, connection, Context.BIND_AUTO_CREATE);
Log.d(TAG, "initService() bound with " + ret); 
```

SampleServiceConnection 类是实现Andorid 的ServiceConnection 类的类。我已经实现了 onServiceConnected() 和 onServiceDisconnected() 函数。我的第一个所有者应用程序“AppA”是包 com.example.basicstuff，扩展服务类的类是 SampleService。执行 bindService() 函数后，LogCat 显示“initService() bound with true”。

我还创建了一个名为 ISampleService 的 .aidl 文件。

App B 在 initService() 中的代码

```
connection = new SampleServiceConnection();
Intent i = new Intent("com.example.GameBook_Chat.ISampleService");
System.out.println(this.startService(i));
System.out.println("service running");
boolean ret = bindService(i, connection, Context.BIND_AUTO_CREATE);
Log.d(TAG, "initService() bound with " + ret); 
```

我的第二个包名称是 com.example.GameBook_Chat，它希望与上面代码中运行的相同服务进行通信。在执行 bindService() 函数时，LogCat 服务会显示“initService() bound with false”

所以基本上我无法让第二个应用程序与服务通信。有人可以告诉我可以进行哪些更正吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:27:56.687

每次调用都会`bindService()`导致调用服务的`onBind()`方法。服务可以随意向每个客户端返回相同的`IBinder`实现对象。您可以使用诸如`checkCallingPermission()`对任何呼叫进行身份验证之类的方法，或者`getCallingUid()`如果您只想知道呼叫者是谁。

# php - smarty中的动态变量数组名

> ID：15935639
> 
> 赞同：0
> 
> 时间：2013-04-10T20:19:52.997
> 
> 标签：php, smarty

我想知道如何实现动态增量变量，这是我的 php

```
<?php 

$sections =5;

for($g=1; $g<=$sections; $g++){
$smarty->assign(array(
        'products-'.$g => $dbvariable,
        'add_display-'.$g => $othervar ));
}

$smarty->assign('number', $sections);
?> 
```

这是我的聪明模板

```
{assign var=cnt value=1}
{while $cnt <= $number}
{foreach from=$products-`.$cnt` item=prod name=mysection}
<div class="section-{$cnt}">
// my output here
 <h3>{$products-`$cnt`.name}</h3>
  <img src="{$add_display-`$cnt`.src}">
</div>
{/foreach}
{assign var=cnt value=$cnt+1}
{/while} 
```

谁能指导我如何在 smarty 上实现增量动态变量？

好像我在这里迷路了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T22:59:08.200

我不确定您开始采用的方法是否有原因，但这作为答案比评论更容易阅读。

为什么不使用数组而不是动态变量名？我认为这应该等同于您想要的：

```
<?php 

$sections =5;

$products = array();
$add_display = array();
for($g=1; $g<=$sections; $g++){
    $products[$g] = $dbvariable;
    $add_display[$g] = $othervar;
}

$smarty->assign('products', $products);
$smarty->assign('add_display', $add_display);
$smarty->assign('number', $sections); 
```

然后（这可能会进一步简化，但我已将其尽可能与您的相似，以便您可以看到我所做的更改）：

```
{assign var=cnt value=1}
{while $cnt <= $number}
    {foreach from=$products[$cnt] item=prod name=mysection}
    <div class="section-{$cnt}">
        // my output here
        <h3>{$prod.name}</h3>
        <img src="{$add_display[$cnt].src}">
    </div>
    {/foreach}
{assign var=cnt value=$cnt+1}
{/while} 
```

顺便说一句，这`<h3>`看起来不太对劲，所以我猜到了它应该是什么。

# php - 从 MySql 中的 30 个表中选择 - PHP

> ID：15935640
> 
> 赞同：0
> 
> 时间：2013-04-10T20:19:59.557
> 
> 标签：php, mysql, sql

基本上我有一个每天有一张表的数据库。我需要查询最近 30 天的数据，这意味着我需要跨 30 个表执行选择语句。

这是在 php 中，表的名称是这样的；

`table_01_03_13`
`table_02_03_13`
`table_03_03_13`
`table_04_03_13`

`etc...`

我的问题是查询这些表的最佳方法是什么，记住它们是日期，我是否会在过去 30 天循环以创建我的查询字符串？这会给我一个像这样的字符串：

```
SELECT * FROM table_01_03_13, table_02_03_13, table_03_03_13, table_04_03_13.... 
```

或者是否有一个 SQL 函数可以更快更容易地做到这一点？

每天有一张表的唯一原因是每天有 40,000 条记录添加到数据库中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-10T20:24:41.907

为什么不是这样的结构：

```
create table yourtable (
   id int,
   date_of_event timestamp
   ...
); 
```

然后你可以简单地拥有

```
SELECT * FROM yourtable
WHERE date_of_event = '2013-04-10' 
```

甚至在特定的日子里：

```
SELECT * FROM yourtable
WHERE YEAR(date_of_event) < 2013
   AND DAY(date_of_event) = 13

// fetch all the events that occured on 'day 13' or any month in the previous years. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:36:45.623

```
<?php
    $tables = '';
    $daysInMonth = 30; // untrue, just an example..
    for($i = 1; $i <= $daysInMonth; $i++)
    {
        if(strlen($i) < 2) $i = str_pad($i, 2, '0', STR_PAD_LEFT);
        if($i===$daysInMonth) $tables .= 'table_' . $i . '_03_13';
        else $tables .= 'table_' . $i . '_03_13, ';
    }
    $query = 'SELECT * FROM ' . $tables;
    echo $query;
?> 
```

输出：

```
SELECT * FROM table_01_03_13, table_02_03_13, table_03_03_13, table_04_03_13, table_05_03_13, table_06_03_13, table_07_03_13, table_08_03_13, table_09_03_13, table_10_03_13, table_11_03_13, table_12_03_13, table_13_03_13, table_14_03_13, table_15_03_13, table_16_03_13, table_17_03_13, table_18_03_13, table_19_03_13, table_20_03_13, table_21_03_13, table_22_03_13, table_23_03_13, table_24_03_13, table_25_03_13, table_26_03_13, table_27_03_13, table_28_03_13, table_29_03_13, table_30_03_13 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-10T20:22:20.630

将日期收集到像“table_d_m_y”这样的数组中，然后从“.implode($tables)”中选择*。

* * *

**由 Kolink 编辑以向此散文添加一些代码：**

这些方面的东西：

```
$tables = Array();
for( $i=0; $i<30; $i++) $tables[] = "table_".date("d_m_y",strtotime("-".$i." days"));
query("SELECT * FROM ".implode(",",$tables)); 
```

# c# - c#中的文件加密/解密

> ID：15935644
> 
> 赞同：-3
> 
> 时间：2013-04-10T20:20:16.603
> 
> 标签：c#, encryption

我需要使用 NCrypto 或 BouncyCastle 库在 c# 中加密/解密文件。我还需要使用 AES 和 RSA 算法并创建一个密钥。有没有适合初学者的好的指南或教程？我搜索了一些并没有找到任何基本指南。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:28:31.407

初学者不应该这样做。

在进入密码学之前，可能要了解它是什么，它是如何工作的，最后学习编程语言。

[http://en.wikipedia.org/wiki/Cryptography](http://en.wikipedia.org/wiki/Cryptography)

无论如何，这里是 BountyCastle 的一个例子：http: [//elian.co.uk/post/2009/07/29/Bouncy-Castle-CSharp.aspx](http://elian.co.uk/post/2009/07/29/Bouncy-Castle-CSharp.aspx)

# reporting-services - 标记过多会使图表不可读。如何减少标记的数量？

> ID：15935645
> 
> 赞同：0
> 
> 时间：2013-04-10T20:20:25.553
> 
> 标签：reporting-services

我正在绘制一个包含数百个数据点的数据集，因为我们每 15 分钟记录一次信息，我想报告一个月的数据。当绘制一天的数据时，可读性很好。但是当我绘制一个月的数据时，由于我启用了标记，它不再真正可读。我启用了标记，因为要求是在黑白打印时使其可读。

使图表可读的最佳做法是什么？每小时/每天汇总数据不是一种选择，因为这些是仪表读数，客户不希望失去读数的任何保真度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-23T11:18:17.570

我知道这是很久以前问过的，我不能 100% 确定你的时间间隔是多少。这仍然对我有用，希望它可以帮助其他人。

我需要为每个其他数据点显示标记，因此我使用此表达式作为标记类型的名称：

```
=IIF(RowNumber(Nothing) Mod 2 = 0, "Diamond", "None") 
```

这是基于交替行的常用代码，但我认为你应该能够修改这个概念以获得你需要的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:09:43.610

通常，您需要设置要查看和测试用户的最长持续时间。您可以做一些事情，但大部分都涉及“刻度线”和标签。在图表对象上，您可以单击图表的子元素并选择它。在我的示例中，您可以对标准折线图的垂直轴或水平轴执行此操作。假设您单击标签附近的垂直轴。它将显示一个虚线矩形以显示它已被选中。右键单击并选择“垂直访问属性”。

在左侧窗格中选择“主要刻度线”。

1.  您的第一个选项可能是“隐藏主要刻度线”选择它，然后除了标签什么都看不到。
2.  您的第二个可能是将“间隔”从“自动”更改为其他内容。将“间隔类型：”更改为其他内容，然后根据需要更改间隔。
3.  也许您需要动态控制，然后您可以选择“fx”表达式来选择可能发生变化的类型。EG：假设你有一个日期范围，有人选择月份，也许你想把它变成几周，有人选择你想要几个月的年份，等等......

当你给一个人很多数据时，你描述的很难，你也可以只设置开头和结尾，然后根据需要调整行。好的图表的关键是让用户看到他们需要什么，但无论如何都要让它可读。当您有广泛的选择时，我发现标签和刻度越少越好。

# python - Django 错误：[Errno 32] 管道损坏

> ID：15935649
> 
> 赞同：4
> 
> 时间：2013-04-10T20:20:35.840
> 
> 标签：python, django, broken-pipe

有时在我的网站上，当我处理本地版本时，我在控制台中收到此错误：

```
error: [Errno 32] Broken pipe 
```

有没有人知道它的来源以及如何防止这种情况，因为它大大降低了网站的速度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-22T23:51:42.990

当数据库连接在开发服务器和数据库之间挂起（使用 Amazon RDS）时，我得到了这个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-17T11:22:03.220

这可能是因为您使用两种方法将数据插入数据库，这会导致网站速度变慢。

```
def add_subscriber(request, email=None):
if request.method == 'POST':
    email = request.POST['email_field']
    e = Subscriber.objects.create(email=email).save()  <==== 
    return HttpResponseRedirect('/')
else:
    return HttpResponseRedirect('/') 
```

例如。在上面的函数错误中，箭头指向正确的实现方式是

```
def add_subscriber(request, email=None):
if request.method == 'POST':
    email = request.POST['email_field']
    e = Subscriber.objects.create(email=email)
    return HttpResponseRedirect('/')
else:
    return HttpResponseRedirect('/') 
```

# iphone - 某些帧缓冲区大小在 iOS 设备上失败 (GL_FRAMEBUFFER_UNSUPPORTED)

> ID：15935651
> 
> 赞同：4
> 
> 时间：2013-04-10T20:20:44.043
> 
> 标签：iphone, ios, opengl-es, framebuffer, render-to-texture

昨天我在尝试创建大小为 256x8 的帧缓冲区时遇到了一个问题 - 在 iOS 设备上（在 iPad 3、iPhone 4 和 iPad Mini 上测试）某些大小将失败`GL_FRAMEBUFFER_UNSUPPORTED`。这些相同的尺寸在 iOS 模拟器中工作。

该问题先前已[在此处](https://stackoverflow.com/questions/5835656/glframebuffertexture2d-fails-on-iphone-for-certain-texture-sizes)报告，但仍未得到答复。我创建了一个测试来检查哪些帧缓冲区大小不起作用。需要明确的是，这些尺寸仅在实际的 iOS 硬件上失败，尺寸在 iOS 模拟器中正常工作。

有谁知道为什么这些尺寸会失败（包括在下面）？这些尺寸应该起作用吗？或者他们失败的原因是什么？或者它只是一个错误？有趣的一点是，每个维度（宽度或高度）始终是 2 的幂。我测试过的每一个两种大小的非幂都有效。

这是测试帧缓冲区大小的代码：

```
void initGL()
{
    //  create OpenGL ES 2.0 context
    EAGLContext * context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];

    if ( !context )
        return;

    [EAGLContext setCurrentContext:context];
}

void framebufferTest( int width, int height )
{
    //  create empty texture
    GLuint  texture = 0;

    glActiveTexture( GL_TEXTURE0 );
    glGenTextures( 1, &texture );
    glBindTexture( GL_TEXTURE_2D, texture );

    GLenum  dataType = GL_UNSIGNED_BYTE;
    GLint   internalFormat = GL_RGBA;

    glTexImage2D( GL_TEXTURE_2D, 0, internalFormat, width, height, 0, internalFormat, dataType, NULL );

    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR );
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );
    // This is necessary for non-power-of-two textures
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE );
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE );

    //  create a framebuffer & attatch to texture
    GLuint  framebuffer = 0;

    glGenFramebuffers( 1, &framebuffer );
    glBindFramebuffer( GL_FRAMEBUFFER, framebuffer );

    glFramebufferTexture2D( GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, texture, 0 );
    GLenum status = glCheckFramebufferStatus(GL_FRAMEBUFFER);

    if ( status != GL_FRAMEBUFFER_COMPLETE )
        printf( "%5dx%5d\t\tFAILED! FBO status: 0x%x\n", width, height, status );

    //  cleanup
    glDeleteFramebuffers( 1, &framebuffer );
    glDeleteTextures( 1, &texture );

    glBindTexture( GL_TEXTURE_2D, 0 );
    glBindFramebuffer( GL_FRAMEBUFFER, 0 );
} 
```

无效帧缓冲区大小列表（在 iPad3 和 iPhone 4 上运行）

```
 1x    4     FAILED! FBO status: 0x8cdd
    1x    8     FAILED! FBO status: 0x8cdd
    1x   16     FAILED! FBO status: 0x8cdd
    1x   32     FAILED! FBO status: 0x8cdd
    1x   64     FAILED! FBO status: 0x8cdd
    1x  128     FAILED! FBO status: 0x8cdd
    1x  256     FAILED! FBO status: 0x8cdd
    1x  512     FAILED! FBO status: 0x8cdd
    1x 1024     FAILED! FBO status: 0x8cdd
    1x 2048     FAILED! FBO status: 0x8cdd
    2x    1     FAILED! FBO status: 0x8cdd
    2x    8     FAILED! FBO status: 0x8cdd
    2x   16     FAILED! FBO status: 0x8cdd
    2x   32     FAILED! FBO status: 0x8cdd
    2x   64     FAILED! FBO status: 0x8cdd
    2x  128     FAILED! FBO status: 0x8cdd
    2x  256     FAILED! FBO status: 0x8cdd
    2x  512     FAILED! FBO status: 0x8cdd
    2x 1024     FAILED! FBO status: 0x8cdd
    2x 2048     FAILED! FBO status: 0x8cdd
    4x    1     FAILED! FBO status: 0x8cdd
    4x    2     FAILED! FBO status: 0x8cdd
    4x   16     FAILED! FBO status: 0x8cdd
    4x   32     FAILED! FBO status: 0x8cdd
    4x   64     FAILED! FBO status: 0x8cdd
    4x  128     FAILED! FBO status: 0x8cdd
    4x  256     FAILED! FBO status: 0x8cdd
    4x  512     FAILED! FBO status: 0x8cdd
    4x 1024     FAILED! FBO status: 0x8cdd
    4x 2048     FAILED! FBO status: 0x8cdd
    8x    1     FAILED! FBO status: 0x8cdd
    8x    2     FAILED! FBO status: 0x8cdd
    8x    4     FAILED! FBO status: 0x8cdd
    8x   32     FAILED! FBO status: 0x8cdd
    8x   64     FAILED! FBO status: 0x8cdd
    8x  128     FAILED! FBO status: 0x8cdd
    8x  256     FAILED! FBO status: 0x8cdd
    8x  512     FAILED! FBO status: 0x8cdd
    8x 1024     FAILED! FBO status: 0x8cdd
    8x 2048     FAILED! FBO status: 0x8cdd
   16x    1     FAILED! FBO status: 0x8cdd
   16x    2     FAILED! FBO status: 0x8cdd
   16x    4     FAILED! FBO status: 0x8cdd
   16x    8     FAILED! FBO status: 0x8cdd
   32x    1     FAILED! FBO status: 0x8cdd
   32x    2     FAILED! FBO status: 0x8cdd
   32x    4     FAILED! FBO status: 0x8cdd
   32x    8     FAILED! FBO status: 0x8cdd
   64x    1     FAILED! FBO status: 0x8cdd
   64x    2     FAILED! FBO status: 0x8cdd
   64x    4     FAILED! FBO status: 0x8cdd
   64x    8     FAILED! FBO status: 0x8cdd
  128x    1     FAILED! FBO status: 0x8cdd
  128x    2     FAILED! FBO status: 0x8cdd
  128x    4     FAILED! FBO status: 0x8cdd
  128x    8     FAILED! FBO status: 0x8cdd
  256x    1     FAILED! FBO status: 0x8cdd
  256x    2     FAILED! FBO status: 0x8cdd
  256x    4     FAILED! FBO status: 0x8cdd
  256x    8     FAILED! FBO status: 0x8cdd
  512x    1     FAILED! FBO status: 0x8cdd
  512x    2     FAILED! FBO status: 0x8cdd
  512x    4     FAILED! FBO status: 0x8cdd
  512x    8     FAILED! FBO status: 0x8cdd
 1024x    1     FAILED! FBO status: 0x8cdd
 1024x    2     FAILED! FBO status: 0x8cdd
 1024x    4     FAILED! FBO status: 0x8cdd
 1024x    8     FAILED! FBO status: 0x8cdd
 2048x    1     FAILED! FBO status: 0x8cdd
 2048x    2     FAILED! FBO status: 0x8cdd
 2048x    4     FAILED! FBO status: 0x8cdd
 2048x    8     FAILED! FBO status: 0x8cdd 
```

# css - 隐藏溢出

> ID：15935653
> 
> 赞同：1
> 
> 时间：2013-04-10T20:20:47.330
> 
> 标签：css

我试图让我的左侧菜单的背景一直是页面的长度。这是一个朋友建议我这样做的方式，但它对我不起作用。

HTML

```
 <div class="Wrapper">
        <nav class="DynamicNav">
            <ul>
                <li><a href="AboutMeContact.html">Contact</a></li>
                <li><a href="AboutMeEducation.html">Education</a></li>
                <li><a href="AboutMeWork.html">Work</a></li>
                <li><a href="AboutMeHobbies.html">Hobbies</a></li>
            </ul>
        </nav>
    </div> 
```

CSS

```
.DynamicNav{
    background:rgb(40,40,40);
    padding-bottom: 3000px;
    margin-bottom: -2990px;
    width:200px;
    min-width: 200px;
    min-height:800px;
    margin-top:-20px;
    float:left;
}

.wrapper{
    overflow: hidden;
    clear: both;
} 
```

你可以在[jsfiddle中看到它](http://jsfiddle.net/e5Hpc/)

这仍然使背景非常长。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:25:04.770

不确定我是否理解这个问题，但试试这个：

```
.DynamicNav{
    background:rgb(40,40,40);
    float:left;
    height: 100%;
    width:200px;
    min-width: 200px;
    min-height:800px;
    margin-top:-20px;
}

.wrapper{
    overflow: hidden;
    clear: both;
} 
```

高度为 100% 时，左侧菜单总是占用 100%...

# scala - 未调用应用方法

> ID：15935656
> 
> 赞同：-1
> 
> 时间：2013-04-10T20:20:54.187
> 
> 标签：scala

我在 line 处设置了一个断点，`s = new Array(capacity)`但似乎没有调用 apply 方法。我是否正确实施了它？

```
object StacksAndQueuesTest {

    def main(args: Array[String]) {

      val f = new FixedCapacityStackOfStrings(3)
      println(f.isEmpty);

    }

}

class FixedCapacityStackOfStrings(capacity : Int) {

  var s : Array[String] = _
  var N : Int = 0

  def isEmpty : Boolean = {
    N == 0
  }

  def push(item : String) = {
    this.N = N + 1
    s(N) = item
  }

  def pop = {
    this.N = N - 1
    val item : String = s(N)

    /**
     * Setting this object to null so
     * that JVM garbage collection can clean it up
     */
    s(N) = null
    item
  }

  object FixedCapacityStackOfStrings {
  def apply(capacity : Int){
   s = new Array(capacity)
  }
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:25:21.877

在您的情况下，伴随对象可能没有太大帮助，除非避免`new`运算符

```
class FixedCapacityStackOfStrings(capacity: Int) {
  var s: Array[String] = new Array(capacity)
  var N: Int = 0

  def isEmpty: Boolean = {
    N == 0
  }

  def push(item: String) = {
    this.N = N + 1
    s(N) = item
  }

  def pop = {
    this.N = N - 1
    val item: String = s(N)

    /**
     * Setting this object to null so
     * that JVM garbage collection can clean it up
     */
    s(N) = null
    item
  }
}

object FixedCapacityStackOfStrings {
  def apply(capacity: Int) = {
    println("Invoked apply()")
    new FixedCapacityStackOfStrings(capacity)
  }

  def main(args: Array[String]){
   val f = FixedCapacityStackOfStrings(5)
   println(f)
  }
} 
```

然后你可以像这样使用它

`val f = FixedCapacityStackOfStrings(5)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T22:17:43.987

对于调用对象 'FixedCapacityStackOfStrings' 来查看我需要使用的 .isEmpty 方法：

```
 def apply(capacity: Int) : FixedCapacityStackOfStrings = {
    new FixedCapacityStackOfStrings(capacity)
  } 
```

代替

```
 def apply(capacity: Int) {
    new FixedCapacityStackOfStrings(capacity)
  } 
```

# visual-studio - 在 MSBuild 中获取本机 exe 的文件版本

> ID：15935657
> 
> 赞同：6
> 
> 时间：2013-04-10T20:20:56.830
> 
> 标签：visual-studio, wix, windows-installer, wix3.7

我在 Visual Studio 2010 解决方案中有许多 Visual C++ 项目。此解决方案中还有一个 WiX 项目，它为作为 C++ 项目之一的产品的可执行文件构建安装程序。

可执行文件在其项目中有一个资源文件，该文件将程序的版本写入可执行文件。

现在，我想使用与资源文件写入可执行文件的版本相同的编号对 WiX 构建的安装程序进行版本控制。我在 StackOverflow 上搜索了与 WiX 相关的帖子，发现了这个帖子：

[从 WiX 设置项目引用在 WiX 库项目中定义的 WixVariable](https://stackoverflow.com/questions/8400868/referencing-a-wixvariable-defined-in-a-wix-library-project-from-a-wix-setup-proj)

接受的答案似乎表明一个可能的解决方案是在 BeforeBuild 目标中使用 MSBuild 和 GetAssemblyIdentity 任务从另一个文件获取版本号（在 SO 问题的情况下是 DLL，在我的情况下是可执行文件）并在 WiX 构建安装程序之前将其公开给 WiX。

我尝试将其添加到我的 .wixproj 文件的 MSBuild 部分，但是当我尝试构建安装程序时，我收到一条错误消息：

```
error MSB3441: Cannot get assembly name for "<ExePath>". Could not load file or assembly '<ExeName>.exe' or one of its dependencies. The module was expected to contain an assembly manifest. 
```

我似乎在 MSDN 上找不到有关此错误的任何信息，因为它与 MSBuild 相关。我检查了构建的可执行文件，它上面肯定有一个版本号（以及 .rc 文件中的其余信息），WiX 项目取决于输出可执行文件的项目；所以我假设它的 BeforeBuild 任务是在它所依赖的项目完全构建之后运行的。

我是否应该使用不同的任务而不是 GetAssemblyIdentity 从 MSBuild 中的 .exe 检索版本号，在 GetAssemblyIdentity 工作之前是否需要满足其他要求，或者只是无法获取有关 .exe 文件的此类信息微软构建？

**编辑 ：**

我接受了 Rob 的回答，因为我误解了 ProductVersion 和 FileVersion 之间的区别，他建议的 WiX 技术正在按预期工作，并且是朝着我需要的解决方案迈出的一步。

FileVersion 只是可执行文件的属性。Msi 文件本质上是数据库，而 ProductVersion 是该数据库中的一个条目；他们没有要设置的 FileVersion 属性。他建议的方法在 .msi 数据库中正确设置 ProductVersion。

这个问题的标题现在与我实际遇到的问题并没有真正的关系，因为我正在寻求一个我认为我当时需要的解决方案。我现在已经解决了根本问题，它只是访问安装程序的 ProductVersion。我在这里找到了一个在线发布的 cscript 脚本：http: [//kentie.net/article/wixnameversion/index.htm](http://kentie.net/article/wixnameversion/index.htm)，它显示了如何访问 .msi 的 ProductVersion。使用它使我能够提取 ProductVersion 并在其他工具中使用它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-10T21:13:06.053

如果您不需要 MSBuild 中的版本，一个更简单的解决方案是直接在 .wxs 文件中引用文件的版本。这是一个显示要做什么的片段：

```
<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Version="!(bind.fileVersion.ExeWithVersion)" ...>

    ...

   <Component ...>
     <File Id="ExeWithVersion" Source="path\to\your\versioned\file.exe" />
   </Component> 

   ...

  </Product>
</Wix> 
```

神奇的是，它`!(bind.fileVersion.Xxx)`说要查找`File`元素`Id='Xxx'`并获取其版本。这是将文件版本放入 MSI 包的最简单方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-10T20:42:46.777

有一次我需要文件版本，最后我编写了一个自定义任务来获取 FileVersion，因为我找不到任何东西。

```
namespace GranadaCoder.Framework.CrossDomain.MSBuild.Tasks.IO//.FileVersionTask
{
    using System;
    using System.Collections.Generic;
    using System.Collections;
    using System.Linq;
    using System.Globalization;
    using System.Diagnostics;
    using System.IO;
    using System.Text;
    using System.Security;

    using Microsoft.Build.Framework;
    using Microsoft.Build.Utilities;

    public class FileVersionTask : FileBasedTaskBase
    {
        private static readonly string ROOT_DIRECTORY = "myrootdir";
        private static readonly string FULL_PATH = "myfullpath";
        private static readonly string FILE_NAME = "myfilename";
        private static readonly string DIRECTORY = "mydirectory";
        private static readonly string EXTENSION = "myextension";
        private static readonly string VERSION = "myfileversion";

        /// <summary>
        /// Gets or sets the source files.
        /// </summary>
        /// <value>The source files.</value>
        [Required]
        public string SourceFiles { get; set; }

        /// <summary>
        /// Gets the file versions as a Task Output property.
        /// </summary>
        /// <value>The file versions.</value>
        [Output]
        public ITaskItem[] FileVersions
        { get; private set; }

        /// <summary>
        /// Task Entry Point.
        /// </summary>
        /// <returns></returns>
        protected override bool AbstractExecute()
        {
            InternalExecute();
            return !Log.HasLoggedErrors;
        }

        /// <summary>
        /// Internal Execute Wrapper.
        /// </summary>
        private void InternalExecute()
        {
            IList<string> files = null;

            if (String.IsNullOrEmpty(this.SourceFiles))
            {
                Log.LogWarning("No SourceFiles specified");
                return;
            }

            if (!String.IsNullOrEmpty(this.SourceFiles))
            {
                Console.WriteLine(this.SourceFiles);
                files = base.ConvertSourceFileStringToList(this.SourceFiles);
            }

            //List<string> fileVersions = new List<string>();

            ArrayList itemsAsStringArray = new ArrayList();

            foreach (string f in files)
            {
                FileInfoWrapper fiw = null;
                fiw = this.DetermineFileVersion(f);

                IDictionary currentMetaData = new System.Collections.Hashtable();

                currentMetaData.Add(ROOT_DIRECTORY, fiw.RootDirectory);
                currentMetaData.Add(FULL_PATH, fiw.FullPath);
                currentMetaData.Add(FILE_NAME, fiw.FileName);
                currentMetaData.Add(DIRECTORY, fiw.Directory);
                currentMetaData.Add(EXTENSION, fiw.Extension);
                currentMetaData.Add(VERSION, fiw.Version);

                itemsAsStringArray.Add(new TaskItem(fiw.Version, currentMetaData));

            }
            this.FileVersions = (ITaskItem[])itemsAsStringArray.ToArray(typeof(ITaskItem));
        }

        /// <summary>
        /// Determines the file version.
        /// </summary>
        /// <param name="fileName">Name of the file.</param>
        /// <returns>File version or 0.0.0.0 if value cannot be determined</returns>
        private FileInfoWrapper DetermineFileVersion(string fileName)
        {
            FileInfoWrapper fiw = new FileInfoWrapper();
            fiw.Directory = string.Empty;
            fiw.Extension = string.Empty;
            fiw.FileName = string.Empty;
            fiw.FullPath = string.Empty;
            fiw.RootDirectory = string.Empty;
            fiw.Version = "0.0.0.0";
            try
            {
                if (System.IO.File.Exists(fileName))
                {
                    fiw.Extension = System.IO.Path.GetExtension(fileName);
                    fiw.FileName = System.IO.Path.GetFileNameWithoutExtension(fileName);
                    fiw.FullPath = fileName;// System.IO.Path.GetFileName(fileName);
                    fiw.RootDirectory = System.IO.Path.GetPathRoot(fileName);

                    //Take the full path and remove the root directory to mimic the DotNet default behavior of '%filename'
                    fiw.Directory = System.IO.Path.GetDirectoryName(fileName).Remove(0, fiw.RootDirectory.Length);

                    FileVersionInfo fvi = FileVersionInfo.GetVersionInfo(fileName);
                    if (null != fvi)
                    {
                        if (null != fvi.FileVersion)
                        {
                            fiw.Version = fvi.FileVersion;
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                if (ex is IOException
                    || ex is UnauthorizedAccessException
                    || ex is PathTooLongException
                    || ex is DirectoryNotFoundException
                    || ex is SecurityException)
                {
                    Log.LogWarning("Error trying to determine file version " + fileName + ". " + ex.Message);
                }
                else
                {
                    Log.LogErrorFromException(ex);
                    throw;
                }
            }
            return fiw;
        }

        /// <summary>
        /// Internal wrapper class to hold file properties of interest.
        /// </summary>
        internal sealed class FileInfoWrapper
        {
            public string Directory { get; set; }
            public string Extension { get; set; }
            public string FileName { get; set; }
            public string FullPath { get; set; }
            public string RootDirectory { get; set; }
            public string Version { get; set; }
        }
    }
} 
```

.msbuild 示例

```
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="AllTargetsWrapper" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <UsingTask AssemblyFile="GranadaCoder.Framework.CrossDomain.MSBuild.dll" TaskName="FileVersionTask"/>

  <Target Name="AllTargetsWrapper">
    <CallTarget Targets="FileVersionTask1" />
    <CallTarget Targets="FileVersionTask2" />
  </Target>

  <PropertyGroup>
    <WorkingCheckout>c:\Program Files\MSBuild</WorkingCheckout>
  </PropertyGroup>

  <ItemGroup>
    <MyTask1ExcludeFiles Include="$(WorkingCheckout)\**\*.rtf" />
    <MyTask1ExcludeFiles Include="$(WorkingCheckout)\**\*.doc" />
  </ItemGroup>

  <ItemGroup>
    <MyTask1IncludeFiles Include="$(WorkingCheckout)\**\*.exe" Exclude="@(MyTask1ExcludeFiles)" />
  </ItemGroup>

  <Target Name="FileVersionTask1">
    <FileVersionTask SourceFiles="@(MyTask1IncludeFiles)" >

      <Output TaskParameter="FileVersions"  ItemName="MyFileVersionItemNames"/>

    </FileVersionTask>

    <Message Text=" MyFileVersionItemNames MetaData  "/>
    <Message Text="  ------------------------------- "/>
    <Message Text="   "/>

    <Message Text="directory: "/>
    <Message Text="@(MyFileVersionItemNames->'%(mydirectory)')"/>
    <Message Text="   "/>
    <Message Text="   "/>
    <Message Text="extension: "/>
    <Message Text="@(MyFileVersionItemNames->'%(myextension)')"/>
    <Message Text="   "/>
    <Message Text="   "/>
    <Message Text="filename: "/>
    <Message Text="@(MyFileVersionItemNames->'%(myfilename)')"/>
    <Message Text="   "/>
    <Message Text="   "/>
    <Message Text="fullpath: "/>
    <Message Text="@(MyFileVersionItemNames->'%(myfullpath)')"/>
    <Message Text="   "/>
    <Message Text="   "/>
    <Message Text="rootdir: "/>
    <Message Text="@(MyFileVersionItemNames->'%(myrootdir)')"/>
    <Message Text="   "/>
    <Message Text="   "/>

    <Message Text="fileversion: "/>
    <Message Text="@(MyFileVersionItemNames->'%(myfileversion)')"/>
    <Message Text="   "/>
    <Message Text="   "/>

    <Message Text="   "/>
    <Message Text="   "/>
    <Message Text="rootdir + directory + filename + extension: "/>
    <Message Text="@(MyFileVersionItemNames->'%(myrootdir)%(mydirectory)%(myfilename)%(myextension)')"/>
    <Message Text="   "/>
    <Message Text="   "/>

    <Message Text="List of files using special characters (carriage return)"/>
    <Message Text="@(MyFileVersionItemNames->'&quot;%(myfullpath)&quot;' , '%0D%0A')"/>
    <Message Text="   "/>
    <Message Text="   "/>

  </Target>

  <ItemGroup>
    <MyTask2IncludeFiles Include="c:\windows\notepad.exe"  />
  </ItemGroup>

  <Target Name="FileVersionTask2">
    <FileVersionTask SourceFiles="@(MyTask2IncludeFiles)" >
      <Output TaskParameter="FileVersions" PropertyName="SingleFileFileVersion"/>
    </FileVersionTask>

    <Message Text="SingleFileFileVersion = $(SingleFileFileVersion)   "/>

  </Target>

</Project> 
```

# windows - 重复使用 QTimer::singleShot 时鼠标锁定

> ID：15935658
> 
> 赞同：0
> 
> 时间：2013-04-10T20:21:02.300
> 
> 标签：windows, qt, timer

我正在开发一个针对 Windows 7 的 Qt 4.8.4 GUI 应用程序。我正在尝试实现[“逐步解决问题”](http://doc.qt.digia.com/qq/qq27-responsive-guis.html#solvingaproblemstepbystep)方法，以在长时间运行的计算期间保持 GUI 响应，这可以很好地分为许多小脚步。

这是该技术的一个最小工作示例：

**计算.h**

```
#pragma once

#include "QtCore/QCoreApplication"
#include "QtCore/QDebug"
#include "QtCore/QObject"
#include "QtCore/QTimer"

class Computation : public QObject {
  Q_OBJECT
 public:
  Computation() : amount_(0) {}

 public Q_SLOTS:
  void start() {
    amount_ = 100000;
    QTimer::singleShot(0, this, SLOT(calculate()));
  }

 private Q_SLOTS:
  void calculate() {
    if (--amount_ > 0) {
      qDebug() << "Calculating..." << amount_;
      //QCoreApplication::processEvents();
      QTimer::singleShot(0, this, SLOT(calculate()));
    } else {
      qDebug() << "Finished";
    }
  }

 private:
  int amount_;
}; 
```

**主文件**

```
#include "Computation.h"

#include "QtCore/QDebug"
#include "QtGui/QApplication"
#include "QtGui/QMainWindow"
#include "QtGui/QPushButton"

int main(int argc, char* argv[]) {
  QApplication app(argc, argv);

  Computation computation;

  QMainWindow window;
  QPushButton button(&window);
  button.setText("Test");
  QObject::connect(&button, SIGNAL(clicked()), &computation, SLOT(start()));

  window.show();
  return app.exec();
} 
```

此示例还有一个[CMakeLists.txt](http://pastie.org/7437938)，以防有人想尝试。

现在，回到实际问题：当计算运行时，某些 GUI 交互会导致鼠标锁定。光标仍然可以移动，但在此状态下单击桌面的任何部分都没有任何效果。计算仍在继续。摆脱这种锁定的唯一方法是使用键盘切换到另一个应用程序（例如 Alt+Tab、按 Windows 键或 Ctrl+Alt+Del）或等到计算完成。

导致此状态的 GUI 操作包括尝试移动应用程序的主窗口或调整其大小。上面解释的鼠标锁定发生了，而不是改变窗口的几何形状。但是，一旦计算完成，窗口就会立即跳转到应该移动到的位置（并且您没有切换到中间的另一个窗口）。

打开系统菜单（通过单击标题栏中的应用程序符号）也会导致类似的行为，但这次只有应用程序（包括系统菜单）对鼠标单击无动于衷。

[`QCoreApplication::processEvents()`](http://qt-project.org/doc/qt-4.8/qcoreapplication.html#processEvents)我试图通过发出我的方法来解决这个问题`calculate()`（上例中的注释行）。*这只是一点点帮助：不是每次*尝试移动或调整窗口大小时都锁定鼠标，您现在必须执行大约 3-5 次才能触发该行为。[`QCoreApplication::sendPostedEvents()`](http://qt-project.org/doc/qt-4.8/qcoreapplication.html#sendPostedEvents)和的不同组合[`QCoreApplication::flush()`](http://qt-project.org/doc/qt-4.8/qcoreapplication.html#flush)也无济于事。

我怎么解决这个问题？这是一个已知的 Qt 错误和/或有解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:41:45.743

如果您需要使应用程序多线程，您可以使用 Qt 的插槽和信号架构。当事情发生变化时，只需从你的线程发出一个信号。然后在您的 UI 线程中，将一个插槽连接到来自您的线程的信号： [Qt: Background thread refresh UI thread](https://stackoverflow.com/questions/2376835/qt-background-thread-refreshing-ui-thread)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:10:03.273

使用 QThread 绝对是一种比分块计算并尝试在一个线程中完成所有事情更好的策略。

然后在计算线程中，每 1/15 秒（例如）使用一个计时器来调用一个已连接到主线程中插槽的信号，该信号通知 UI 更新您希望从计算中看到的任何数据。

# c# - 为什么下载文件不能在平板电脑上运行，但可以在台式机上运行？

> ID：15935659
> 
> 赞同：0
> 
> 时间：2013-04-10T20:21:13.340
> 
> 标签：c#, asp.net-mvc, mobile

我有一个 Web 应用程序，当用户按下导出按钮时，他会看到一个使用以下代码导出的文件：

```
 MemoryStream memoryStream = new PdfConvertorUtil().ConvertEmailsToPdfUsingExpertPdf(emailsToBeConverted);

        Response.ContentType = "application/pdf";
        Response.AddHeader("content-disposition", "attachment;filename=" + MySession.Current.userEmail + "_emailexport_" + MySession.Current.Folder.ToString() + ".pdf");
        Response.Buffer = true;
        Response.Clear();
        Response.OutputStream.Write(memoryStream.GetBuffer(), 0, memoryStream.GetBuffer().Length);
        Response.OutputStream.Flush();
        Response.End();

        memoryStream.Close();

        Elmah.ErrorSignal.FromCurrentContext().Raise(new Exception(String.Format("Successfully exported {0} emails to PDF", emailsToBeConverted.Count)));

        //save statistics in db
        SaveStats(emailsToBeConverted.Count());

        return new FileStreamResult(Response.OutputStream, "application/pdf"); 
```

这在台式机上完美运行，但在移动设备上却不行（在移动设备上，由于某种未知原因，文件无法导出）。我的代码有什么问题吗？

我的应用程序是使用 ASP.NET MVC 3 构建的。

**更新**：关于错误：它只说无法下载文件。（它看到文件的名称和类型）。

# android - 如何在地图上创建类似弹出控件的 Nexus 4 相机

> ID：15935661
> 
> 赞同：1
> 
> 时间：2013-04-10T20:21:16.490
> 
> 标签：android, android-layout, android-widget

大家好，我正在尝试创建一个自定义弹出控件，该控件将在用户长按 Google 地图后显示。我希望控件看起来像 nexus 的 4 相机应用程序中的样子：[请参见此处。](http://www.google.com/imgres?hl=en&biw=1366&bih=643&tbm=isch&tbnid=XvuZclOsXKvJjM%3a&imgrefurl=http://www.lowyat.net/2013/03/01/5603/review-lg-nexus-4-by-google/&docid=9CjMvur2frWt1M&imgurl=http://cdn.lowyat.net/wp-content/uploads/2013/03/nexus-4-camera-2.jpg&w=602&h=361&ei=qrllUeO2BcrYswa6sID4CA&zoom=1&ved=1t:3588,r:28,s:0,i:175&iact=rc&dur=591&page=2&tbnh=174&tbnw=290&start=17&ndsp=22&tx=136&ty=89)

谁能建议如何开始？

我也在[此处](https://github.com/android/platform_packages_apps_camera/tree/master/src/com/android/camera "这里")找到的本机相机应用程序代码中进行了搜索，但我完全迷失在所有这些代码中。有人遇到过如何建立这种控制的教程吗？我真的用谷歌搜索了很多，但找不到任何解决方案。

# asp.net - 使用 MasterPage 属性作为属性扩展 ASP.NET 页面

> ID：15935663
> 
> 赞同：2
> 
> 时间：2013-04-10T20:21:20.313
> 
> 标签：asp.net, master-pages

我有一个基于身份验证角色的系统：不同的角色被重定向到不同的文件夹，并且在每个文件夹中都有一个 web.config，它只允许访问特定的用户名。

很少有角色具有与 gridview 相同的默认页面，它们根据角色以不同的方式做出反应（显示不同的列，事件触发不同的方法等）。

所以我的问题是，每次我需要对页面进行细微更改时，我都需要将相同的更改复制/粘贴到其他文件夹中的所有其他默认页面。

就代码而言，我通过创建一个扩展 System.Web.UI.Page 的 DefaultFather 类来解决，并且所有其他 Default 类都继承自 DefaultFather。这样，如果我不声明Page-life-method，就会触发DefaultFather方法。

但是图形部分（html、javascript、asp 组件等）呢？

我仅为默认页面创建了一个 NestedMasterPage，但每次我需要更改控件的外观/行为（gridview、按钮、链接按钮）时，我都必须使用 FindControl() 方法。

真的没有另一种方法来解决这个问题吗？我正在考虑使用 Page_Load() 方法通过 FindControl() 搜索每个控件并将它们保存到属性中以供以后使用，但它看起来并不是一个好的解决方案。如果我可以将母版页组件用作属性会很好，但我认为为此我应该创建公共属性，但我不知道它是否会导致某种安全问题。

有什么建议吗？

顺便说一句，如果母版页是解决方案，我应该删除 DefaultFather 类并将代码直接放入母版页吗？还是只为代码设置另一个类是个好主意？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:32:46.090

我会说为您的页面同时拥有母版页和基类没有任何问题。它们服务于不同的目的。母版页通常都是关于布局的，而基类是关于页面功能的。

如果您想操作母版页上的标记，而不是直接访问字段，我会说创建一个逻辑函数来完成您需要它做的事情，然后让母版页来做。

```
// Site.Master.cs
public void HideSubmitButton()
{
    btnSubmit.Visible = false;
}

// Default.aspx.cs
protected void Page_Load(object sender, EventArgs e)
{
    ((SiteMaster)Master).HideSubmitButton();
} 
```

我可能会包装该演员表，以便您可以更轻松地使用它 - 这是属于您的基类的东西：

```
// DefaultFather.cs
protected new SiteMaster Master { get { return (SiteMaster)base.Master; } }

// Default.aspx.cs
Master.HideSubmitButton(); 
```

**编辑**

根据您关于附加事件处理程序的评论 - 如果您需要将事件附加到存在于主机上的对象（这可能不是一个好主意 - 理想情况下，生活在主机上的事件处理程序存在于主机上 - 但如果你真的需要它）您也可以公开执行此操作的方法，例如：

```
// Site.Master.cs
public void AttachEventHandlerToGoButton(EventHandler eventHandler)
{
    btnGo.Click += eventHandler;
}

// Default.aspx.cs
Master.AttachEventHandlerToGoButton(DoMyThing);

private void DoMyThing(object sender, EventArgs e) { } 
```

或者如果你想变得花哨，写一个包装事件：

```
// Site.Master
<asp:Button ID="btnGo" runat="server" OnClick="btnGo_Click" />

// Site.Master.cs
public event EventHandler GoButtonClick;

protected void btnGo_Click(object sender, EventArgs e) {
    if (GoButtonClick != null) {
        GoButtonClick(sender, e);
    }
}

// Default.aspx.cs
Master.GoButtonClick += DoMyThing;

private void DoMyThing(object sender, EventArgs e) { } 
```

另请参阅我对 Master 包装器的编辑 - 您需要在`base.`那里避免堆栈溢出。

# java - 在 PreferenceActivity 创建的布局中获取对 Button 的引用

> ID：15935665
> 
> 赞同：0
> 
> 时间：2013-04-10T20:21:34.470
> 
> 标签：java, android

我在试图获取参考的 SharedPreferences 布局文件中有一个 ImageView，因此我可以在我的 PrefsActivity 类中创建一个侦听器。到目前为止，我没有任何运气使用 findViewById 获得参考，一切都返回为空。

设置如下所示：

**PrefsActivity.class**

```
public class PrefsActivity extends UnifiedSherlockPreferenceActivity {

    @Override 
    public void onCreate(Bundle savedInstanceState) {
        // Set header resource MUST BE CALLED BEFORE super.onCreate 
        setHeaderRes(R.xml.pref_headers);
        // Set desired preference file and mode (optional)
        setSharedPreferencesName("my_prefs");
        setSharedPreferencesMode(Context.MODE_PRIVATE);

        super.onCreate(savedInstanceState);
        ACRA.init(getApplication());

        getSupportActionBar().setDisplayShowCustomEnabled(true);
        getSupportActionBar().setIcon(R.drawable.new);
        getSupportActionBar().setDisplayShowTitleEnabled(false);
        getSupportActionBar().setDisplayHomeAsUpEnabled(true); 
```

**pref_headers.xml**

```
<preference-headers xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:unified="http://schemas.android.com/apk/res-auto" >

<header
    unified:fragment="com.my.app.PrefsActivity$GeneralPreferenceFragment"
    unified:title="@string/pref_header_general"
    unified:preferenceRes="@xml/pref_general" /> 
```

**pref_general.xml**

```
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >

<PreferenceCategory
android:title="Category Title"
android:layout="@layout/settings_message"

<EditTextPreference
    android:capitalize="words"
    android:defaultValue=""
    android:inputType="textCapWords"
    android:key="first_name"
    android:maxLines="1"
    android:selectAllOnFocus="true"
    android:singleLine="true"
    android:title="@string/first_name" /> 
```

**settings_message.xml**

这包含我试图获得参考的按钮 btnTutorial

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<TextView
    android:id="@+id/tvSettingsMessage"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_margin="20px"
    android:text="@string/settings_text" />

<Button
    android:id="@+id/btnTutorial"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_margin="20px"
    android:text="@string/settings_button_text" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:40:27.723

您在`onCreate()`...中缺少以下方法

```
setContentView(R.layout.yourlayout); 
```

...所以返回空值。尝试实施这些更改，然后让我们知道它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-30T19:09:55.907

利用：

```
Preference myPreference = findPreference(key); 
```

其中 key 是您的 XML 中的键，例如“first_name”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T17:48:53.640

也许您可以通过“onPreferenceTreeClick”方法访问您的 imageView，例如：

```
@Override
public boolean onPreferenceTreeClick(PreferenceScreen preferenceScreen,
        Preference preference) {
    super.onPreferenceTreeClick(preferenceScreen, preference);
    if (preference != null && preference.getKey().equals("imageViewKey")) {
        // do something here
    }
    return false;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-07T18:25:11.103

这是解决方案：

在您的 settings_message.xml 中为按钮设置属性

android:onClick="onLogoutClick"

在活动 PrefsActivity 中定义方法 public void onLogoutClick(View v) { }

你准备好了！:)

# java - Java Swing - java.lang.NullPointerException

> ID：15935669
> 
> 赞同：-2
> 
> 时间：2013-04-10T20:21:55.893
> 
> 标签：java, swing, nullpointerexception, imagecreatefrompng

当我覆盖我的 GamePanel 类的 paint 方法时，当我尝试打开 MazeGUI 设计选项卡时，我收到此错误：

```
Internal Error
WindowBuilder encountered unexpected internal error. 

This could be caused by a WindowBuilder bug or by a misconfiguration issue, conflict,  partial update, etc.

Stack trace:
java.lang.NullPointerException
at maze.gui.GamePanel.paint(GamePanel.java:25)  
at javax.swing.JComponent.print(Unknown Source)  
at javax.swing.JComponent.paintChildren(Unknown Source)  
at javax.swing.JComponent.printChildren(Unknown Source)  
at javax.swing.JComponent.paint(Unknown Source)  
at javax.swing.JComponent.print(Unknown Source)  
at javax.swing.JComponent.paintChildren(Unknown Source)  
at javax.swing.JComponent.printChildren(Unknown Source)  
at javax.swing.JComponent.paint(Unknown Source) 
```

如果我在绘画覆盖函数中删除 GamePanel.java 中的这一行

```
g.drawImage(maze.wall, 400, 400, null); 
```

MazeGUI 的设计选项卡已经可以使用。很奇怪...

无论如何，如果我运行 java 应用程序，它会显示图像而没有任何错误。

在这里，我留下两个类 java 文件：GamePanel.java：

```
package maze.gui;

import java.awt.Graphics;
import java.awt.Graphics2D;
import javax.swing.JPanel;

@SuppressWarnings("serial")
public class GamePanel extends JPanel {
    private int comprimento_sprites;
    private MazeGUI maze;

/**
 * Create the panel.
 */
public GamePanel(MazeGUI m) {
    comprimento_sprites = 40;
    maze = m;
    setFocusable(true);
}

@Override
public void paint(Graphics g) {
    super.paint(g);

g.drawImage(maze.wall, 400, 400, null);
} 
```

}

迷宫GUI.java：

```
package maze.gui;

import java.awt.EventQueue;
import java.awt.Image;
import javax.imageio.ImageIO;
import javax.swing.JFrame;
import maze.logic.Jogo;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;

public class MazeGUI {

private JFrame frmMazeGame;
//IMAGES
    public BufferedImage wall;

/**
 * Launch the application.
 */
public static void main(String[] args) {
    EventQueue.invokeLater(new Runnable() {
        public void run() {
            try {
                MazeGUI window = new MazeGUI();
                window.frmMazeGame.setVisible(true);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    });
}

/**
 * Create the application.
 */
public MazeGUI() {
    initialize();
}

/**
 * Initialize the contents of the frame.
 */
private void initialize() {

    //faz load das imagens do jogo
    loadImages();

    frmMazeGame = new JFrame();
    frmMazeGame.setTitle("Maze Game");
    frmMazeGame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    GamePanel tabuleiro = new GamePanel(this);
    frmMazeGame.getContentPane().add(tabuleiro);
}

private void loadImages(){

    try {
        wall = ImageIO.read(new File("images/bloco.png"));
    } catch (IOException e) {
        e.printStackTrace();
    }

} 
```

}

啊，让我补充一下： - 我认为所有这些问题都与 MazeGUI 的 loadImages 功能有关，但我认为我做得很好。已经失去了很多小时试图解决这个问题。
- 请记住：运行应用程序时没有错误（它甚至在应用程序中显示图像）但是当我尝试打开“设计”选项卡时出现上述错误：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T22:25:07.003

由于此行，您在加载设计选项卡时收到错误：

```
g.drawImage(maze.wall, 400, 400, null); 
```

`MazeGUI`我对 WindowBuilder 没有太多经验，所以我不能告诉你它是如何工作的，但看起来你的对象好像`GamePanel`是`null`在设计模式下。这不是您的图像加载的问题，这仅仅是因为 WindowBuilder 的工作原理。

要加载设计选项卡，您只需`null`在其中进行检查：

```
if (maze != null && maze.wall != null) {
    g.drawImage(maze.wall, 400, 400, null);
} 
```

至于让图像实际显示在“设计”选项卡中，恐怕我帮不了你。

# javascript - 替换关联数组变量

> ID：15935675
> 
> 赞同：-1
> 
> 时间：2013-04-10T20:22:13.003
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3, associative-array

这是以下问题。

我的 javascript 文件包含以下代码...

```
$(function() {
  var names;
  var names_hash = { };
  // When an user types in a letter in the student name input field
  $(".container").on("keyup", "#term", function(){
    // Here we are submitting the form via AJAX. The form contains necessary
    // Rails code to initiate the AJAX        
    $(this).parents(".student-search-form").submit();
  });

  $(".container").on("click", ".add_nested_fields", function() {
    var term = $("#term").val();

    console.log(names_hash);
  });
}); 
```

现在，当我在输入字段中输入带有 id`term`的字符时，会调用 Rails 控制器操作并使用以下 javascript 进行响应。

仅供参考，`@group_users_hash`只是一个 Ruby 哈希，我必须调用`html_safe`它才能正确转换为 Javascript 关联数组（是的，我知道它实际上只是一个对象）。

```
names_hash = <%= @group_users_hash.html_safe %>;

console.log(names_hash); 
```

所以当 AJAX 完成时，我看到它`console.log(names_hash);`在我的控制台上产生了

```
Object {1: "Jason"} 
```

但是当我点击`.add_nested_fields`调用`on`事件时，我的控制台日志显示

```
Object {} 
```

不知道为什么`assoc_array`不更新。我的代码有什么问题，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:48:35.613

看起来您的`names_hash`（无论如何您在返回中重新定义`var names_hash`它，然后隐藏任何更高范围的变量）与您在单击时将其打印的范围不在同一范围内。感谢您的包装器功能。您将需要某种方式（通过事件或回调等）来访问该范围内的变量并将其设置为您希望使用的值。

**编辑**

进一步解释的非理想但示例解决方案将是：

```
var names_hash = {};
$(function() {
  $(".container").on("click", ".add_nested_fields", function() {
    console.log(names_hash);
  });
}); 
```

然后当你的回应出现在你面前时：

```
names_hash = <%= @group_users_hash.html_safe %>; 
```

然后你应该是金色的。这不是一个理想的原因是因为您的 names_hash 在全局范围内浮动。最好是“命名空间”，例如：

```
(function() {
  // prevent redefining it if it's already defined via another file
  var MyNamespace = window.MyNamespace || {};

  MyNamespace.names_hash = {};

  window.MyNamespace = MyNamespace;
})();

$(function() {
  $(".container").on("click", ".add_nested_fields", function() {
    console.log(MyNamespace.names_hash);
  });
}); 
```

从那里你修改你的回应：

```
MyNamespace.names_hash = <%= @group_users_hash.html_safe %>; 
```

还有中提琴。您已经保护了全局范围，并且还公开了要在包装函数之外访问的函数。

# linux - 将下拉菜单添加到图形对话框/YAD bash 脚本

> ID：15935677
> 
> 赞同：0
> 
> 时间：2013-04-10T20:22:14.353
> 
> 标签：linux, bash, pyhoca-cli

有人对 yad 有好处吗？

所以基本上这个 BASH 脚本工作正常，Debian 启动到一个最小的 Matchbox WM 环境，这个脚本是自动运行的，它显示一个很好的图形提示，允许输入 AD 用户名并通过，然后将变量传递给 pyhoca-cli，它将计算机登录到远程 x2go-server linux 终端服务器.. 它可以正常工作。

但是我想要做的是向 YAD 图形提示添加一个额外的下拉选择（在前两个字段之后），用户可以在其中选择会话（例如 kde、xfce4、lxde 和通量盒），然后传递该选择到 pyhoca-cli 命令将 startkde 替换为 start$frmdata 之类的东西（来自下拉选择）...

不知道到底该怎么做...以下是现有代码：

```
#!/bin/bash

while true; do
    frmdata=$(yad --center --undecorated --image=/usr/share/wallpaper/header-mod.jpg --image-    on-top --button="gtk-ok:0" --title "Login to Linux Terminal Server" --form --field="AD username" --field="Password:H")
    frmusername=$(echo $frmdata | awk 'BEGIN {FS="|" } { print $1 }')
    frmpassword=$(echo $frmdata | awk 'BEGIN {FS="|" } { print $2 }')

    pyhoca-cli --server some.private.ip.addr -u $frmusername --password $frmpassword -c startkde --sound none --kbd-layout us --kbd-type pc105/us -g fullscreen --add-to-known-hosts
done 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-28T00:02:54.677

你可以试试这个...

```
frmdata=$(yad --center --undecorated --image=/usr/share/wallpaper/header-mod.jpg --image-    on-top --button="gtk-ok:0" --title "Login to Linux Terminal Server" --form --field="AD username" "" --field="Password:H" "" --field="Session:CB" "Session1!Session2!Session3")
frmsession=$(echo $frmdata | awk 'BEGIN {FS="|" } { print $3 }') 
```

# ruby-on-rails - AuthenticationsController 中的 ArgumentError - 参数数量错误（3 比 1）

> ID：15935679
> 
> 赞同：1
> 
> 时间：2013-04-10T20:22:21.480
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, omniauth

我正在尝试让用户使用提供程序成功登录，但出现此错误。用户已**成功创建**，但此错误消息阻止用户访问登录页面

```
wrong number of arguments (3 for 1)
    app/helpers/sessions_helper.rb:4:in `sign_in'
    app/controllers/authentications_controller.rb:12:in `create' 
```

这是 session_helper 的相关部分

```
 module SessionsHelper

  def sign_in(user)
    cookies.permanent[:remember_token] = user.remember_token
    current_user = user
  end

  def sign_in_and_redirect(user)
    redirect_to root_path
  end

  def signed_in?
    !current_user.nil?
  end

  def current_user=(user)
    @current_user = user
  end

  def current_user
    @current_user ||= User.find_by_remember_token(cookies[:remember_token])
  end

  def current_user?(user)
    user == current_user
  end

  def sign_out
    current_user = nil
    cookies.delete(:remember_token)
  end

  def store_location
    session[:return_to] = request.fullpath
  end

  def redirect_back_or(default)
    redirect_to(session[:return_to] || default)
    session.delete(:return_to)
  end

  def signed_in_user
    unless signed_in?
      store_location
      redirect_to signin_path, notice: "Please sign in." 
    end
  end
end 
```

这是身份验证控制器

```
 class AuthenticationsController < InheritedResources::Base

def index
    @authentications = current_user.authentications if current_user
end

    def create
  omniauth = request.env['omniauth.auth']
  authentication = Authentication.find_by_provider_and_uid(omniauth['provider'], omniauth['uid'])
  if authentication
     flash[:notice] = "Signed in successfully"
     sign_in_and_redirect(:user, authentication.user)
  elsif current_user
   token = omniauth['credentials'].token
   secret = omniauth['credentials'].token
   current_user.authentications.create!(:provider => omniauth['provider'], :uid => omniauth['uid'], :token => token, :secret => token_secret)
   flash[:notice] = "Authentication successful"
   redirect_to authentications_url
   else
    user = User.new
    user.apply_omniauth(omniauth)
    if user.save!
    flash[:notice] = "Signed in successfully"
     sign_in(:user, authentication.user)
   else
    session[:omniauth] = omniauth.except('extra')
    redirect_to '/signup'
   end
end
end

def destroy
    @authentication = current_user.authentications.find(params[:id])
    @authentication.destroy
    flash[:notice] = "Successfully destroyed authentication"
    redirect_to authentications_url

end
end 
```

最后是用户模型

```
class User < ActiveRecord::Base
  attr_accessible :name, :email, :password, :password_confirmation
  has_secure_password
  has_many :authentications
 before_validation :no_password_omniauth
 validates :password, length: { minimum: 6 }
 validates :password_confirmation, presence: true
 @called_omniauth = false

 def apply_omniauth(omniauth)
 authentications.build(:provider => omniauth['provider'],
 :uid => omniauth['uid'],
 :token => omniauth['credentials'].token,
 :secret => omniauth['credentials'].secret)
 @called_omniauth = true
 self.email = "test@example.com"
 self.name = omniauth['info']['name']
 self.password = self.password_confirmation = "password"
 end

     def password_required
    return false if @called_omniauth == true
    (authentications.empty? || !password.blank?)
end

  def twitter
  unless @twitter_user
  provider = self.authentications.find_by_provider('twitter')
  @twitter_user = Twitter::Client.new(:oauth_token => provider.token, :oauth_token_secret => provider.secret) rescue nil
  end
  @twitter_user
  end

    private

       def apply_twitter(omniauth)
       if (extra = omniauth['extra']['user_hash'] rescue false)
       end
    end

       def no_password_omniauth
       self.password_digest = SecureRandom.urlsafe_base64 unless password_required
       end
    end 
```

完整跟踪

```
app/helpers/sessions_helper.rb:9:in `sign_in_and_redirect'
app/controllers/authentications_controller.rb:12:in `create'
actionpack (3.2.3) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.3) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.3) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.3) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.2.3) lib/active_support/callbacks.rb:425:in `_run__489817761__process_action__312945192__callbacks'
activesupport (3.2.3) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.3) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.3) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.3) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.3) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.3) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.3) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.3) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.3) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.3) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.3) lib/action_controller/metal/params_wrapper.rb:205:in `process_action'
activerecord (3.2.3) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.3) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.3) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.3) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.3) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.3) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.3) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.3) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.3) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.3) lib/action_dispatch/routing/route_set.rb:600:in `call'
omniauth (1.1.4) lib/omniauth/strategy.rb:401:in `call_app!'
omniauth (1.1.4) lib/omniauth/strategy.rb:363:in `callback_phase'
omniauth-oauth (1.0.1) lib/omniauth/strategies/oauth.rb:58:in `callback_phase'
omniauth (1.1.4) lib/omniauth/strategy.rb:226:in `callback_call'
omniauth (1.1.4) lib/omniauth/strategy.rb:182:in `call!'
omniauth (1.1.4) lib/omniauth/strategy.rb:164:in `call'
omniauth (1.1.4) lib/omniauth/builder.rb:49:in `call'
warden (1.2.1) lib/warden/manager.rb:35:in `block in call'
warden (1.2.1) lib/warden/manager.rb:34:in `catch'
warden (1.2.1) lib/warden/manager.rb:34:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.5) lib/rack/etag.rb:23:in `call'
rack (1.4.5) lib/rack/conditionalget.rb:25:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.5) lib/rack/session/abstract/id.rb:210:in `context'
rack (1.4.5) lib/rack/session/abstract/id.rb:205:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/cookies.rb:338:in `call'
activerecord (3.2.3) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:467:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.3) lib/active_support/callbacks.rb:405:in `_run__1022619158__call__651148843__callbacks'
activesupport (3.2.3) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.3) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.3) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.3) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.3) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.3) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.5) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.5) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.3) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.5) lib/rack/lock.rb:15:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.3) lib/rails/engine.rb:479:in `call'
railties (3.2.3) lib/rails/application.rb:220:in `call'
rack (1.4.5) lib/rack/content_length.rb:14:in `call'
railties (3.2.3) lib/rails/rack/log_tailer.rb:14:in `call'
rack (1.4.5) lib/rack/handler/webrick.rb:59:in `service'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

如何解决此错误？提前致谢

会话控制器

```
 def create
    user = User.find_by_email(params[:session][:email])
    if user && user.authenticate(params[:session][:password])
      sign_in user
      redirect_to root_url
    else
      flash.now[:error] = "Invalid email/password combination"
      render 'new'
    end
  end 
```

和用户控制器

```
 def create
    @user = User.new(params[:user])
    if @user.save
      sign_in @user
      flash[:success] = "Welcome"
      redirect_to root_url
    else
      render 'new'
    end
  end

  def edit
  end

  def update
    if @user.update_attributes(params[:user])
      sign_in @user
      flash[:success] = "Profile updated"
      redirect_to @user
    else
      render 'edit'
    end
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-24T18:54:21.723

我在做教程时遇到了类似的问题。您是否尝试过 sign_in_and_redirect(user: authentication.user)？

# windows-8 - 在输入上显示刻度线[type=range]

> ID：15935681
> 
> 赞同：0
> 
> 时间：2013-04-10T20:22:28.833
> 
> 标签：windows-8, winjs

我正在创建一个 Windows 8 应用程序，需要创建一个垂直滑块，该滑块也显示刻度线。我可以通过应用 windows 特定类来让范围滑块垂直显示：win-vertical。

input[type=range]::-ms-ticks-after 和 input[type=range]::-ms-ticks-before 也有伪选择器，但我找不到任何关于如何正确使用它们的文档以及任何我添加到它们的规则似乎没有做任何事情。任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T22:18:46.033

你试过`-ms-track`选择器吗？详细在这里：http: [//msdn.microsoft.com/en-us/library/windows/apps/hh465813.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh465813.aspx)

我在 IE10（应该相当于 Windows 8）中对此进行了测试，我可以使用以下 CSS 将刻度线设置为红色。

```
input[type=range]::-ms-track { color: red; } 
```

# string - 如何将字符串列表拆分为R中的奇数和偶数元素

> ID：15935684
> 
> 赞同：1
> 
> 时间：2013-04-10T20:22:45.063
> 
> 标签：string, r, list, vector, initialization

对不起，我什至在这项任务的最基本部分都失败了。我有一个 50 长的字符串列表，并且我初始化了一个 25 长的空向量，但即使手动将一个的第一个元素分配给另一个的第一个元素也失败了：

```
> p$key
 [1] CA TX NY FL IL PA OH MI GA NC NJ VA MA WA IN AZ TN MO MD WI MN CO AL SC LA KY OR
[28] OK CT IA MS AR KS UT NV NM WV NE ID ME NH HI RI MT DE SD AK ND VT WY
50 Levels: AK AL AR AZ CA CO CT DE FL GA HI IA ID IL IN KS KY LA MA MD ME MI ... WY
> st <- character(25)
> st[1] <- p$key[1]
> st[1]
[1] "5"
> p$key[1]
[1] CA
50 Levels: AK AL AR AZ CA CO CT DE FL GA HI IA ID IL IN KS KY LA MA MD ME MI ... WY
> 
```

对不起，我太密集了，你能指出我在这里不知道的地方吗？谢谢 - 教育局

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-10T20:27:34.533

你`p$key`是 a `factor`，所以`st[1] = as.character(p$key[1])`改为这样做。

假设您想要字符列表，这将为您提供拆分：

```
odds = as.character(p$key[seq(1,50,2)])
evens = as.character(p$key[seq(2,50,2)]) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-10T20:31:51.393

尝试这个：

```
> key <- factor(state.abb)
> key
 [1] AL AK AZ AR CA CO CT DE FL GA HI ID IL IN IA KS KY LA ME MD MA MI MN MS MO MT
[27] NE NV NH NJ NM NY NC ND OH OK OR PA RI SC SD TN TX UT VT VA WA WV WI WY
50 Levels: AK AL AR AZ CA CO CT DE FL GA HI IA ID IL IN KS KY LA MA MD ME ... WY 
```

如果您想要每个替代值并希望保留所有因子水平，请使用：

```
> split(key, 1:length(key) %% 2 == 0)
$`FALSE`
 [1] AL AZ CA CT FL HI IL IA KY ME MA MN MO NE NH NM NC OH OR RI SD TX VT WA WI
50 Levels: AK AL AR AZ CA CO CT DE FL GA HI IA ID IL IN KS KY LA MA MD ME ... WY

$`TRUE`
 [1] AK AR CO DE GA ID IN KS LA MD MI MS MT NV NJ NY ND OK PA SC TN UT VA WV WY
50 Levels: AK AL AR AZ CA CO CT DE FL GA HI IA ID IL IN KS KY LA MA MD ME ... WY 
```

如果您更喜欢将输出作为字符值，请使用：

```
> split(as.character(key), 1:length(key) %% 2 == 0)
$`FALSE`
 [1] "AL" "AZ" "CA" "CT" "FL" "HI" "IL" "IA" "KY" "ME" "MA" "MN" "MO" "NE" "NH"
[16] "NM" "NC" "OH" "OR" "RI" "SD" "TX" "VT" "WA" "WI"

$`TRUE`
 [1] "AK" "AR" "CO" "DE" "GA" "ID" "IN" "KS" "LA" "MD" "MI" "MS" "MT" "NV" "NJ"
[16] "NY" "ND" "OK" "PA" "SC" "TN" "UT" "VA" "WV" "WY" 
```

* * *

### 更新

如果您更喜欢单独的向量而不是列表，请尝试：

```
stOdds <- key[1:length(key) %% 2 == 1]
stEvens <- key[1:length(key) %% 2 == 0] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-10T23:07:12.387

这将返回所有其他元素。第一个返回从第一个开始的所有其他元素，第二个返回一个从第二个开始的向量。

```
>  key <- factor(state.abb)
> key[c(TRUE, FALSE)]
 [1] AL AZ CA CT FL HI IL IA KY ME MA MN MO NE NH NM NC OH OR RI SD TX VT WA WI
50 Levels: AK AL AR AZ CA CO CT DE FL GA HI IA ID IL IN KS KY LA MA MD ME MI MN MO MS MT NC ND NE NH NJ NM NV ... WY
> key[c(FALSE,TRUE)]
 [1] AK AR CO DE GA ID IN KS LA MD MI MS MT NV NJ NY ND OK PA SC TN UT VA WV WY
50 Levels: AK AL AR AZ CA CO CT DE FL GA HI IA ID IL IN KS KY LA MA MD ME MI MN MO MS MT NC ND NE NH NJ NM NV ... WY 
```

正如其他人已经指出的那样，使用 as.character() 将转换为没有所有那些令人分心的级别的非因素对象。

# singularitygs - 为什么 Singularity GS 不能正确显示以下标记？

> ID：15935685
> 
> 赞同：0
> 
> 时间：2013-04-10T20:22:50.450
> 
> 标签：singularitygs

```
<div class="grid">
  <header>header</header>
  <div>main</div>
  <footer>footer</footer>
</div> 
```

我为三种屏幕尺寸定义了三个网格。标记包含三个元素，它们显示在每个屏幕尺寸的不同列中。

**移动布局**，主 div 保留在第一列，页眉和页脚显示在第二列

**平板电脑布局**，所有三个元素都在第二列重叠（因为margin-right：-100％;），似乎是一个错误。

**桌面布局**，唯一有效的布局，页眉/页脚/主显示在第五列

网格定义：

```
// grid columns
$grids      : 2;
$grids      : add-grid(6 at 40em);
$grids      : add-grid(12 at 50em);

// grid gutters
$gutters    : .2; 
```

款式：

```
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
}

.grid {
  @include background-grid;
  margin: 0 auto;
  max-width: 1080px;
  min-height: 100%;
}

.layout {
  // mobile layout
  @include grid-span(1,2);
  // tablet layout
  @include breakpoint(40em){
    @include grid-span(4,2);
  }
  // desktop layout
  @include breakpoint(50em){
    @include grid-span(8,5);
  }
}

header, 
.grid div,
footer { 
  @extend .layout;
} 
```

有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T23:25:18.377

奇点需要知道每一列的位置。第二个值`grid-span`是您设置的位置`2`并`5`强制列从这些位置开始。`1`如果您希望将内容放在第一列中，则可以将该值更改为。

听起来您也习惯于在页面上浮动列，因此之前的列会影响以下列的放置位置。默认情况下，Singularity 使用一种称为[隔离](http://www.palantir.net/blog/responsive-design-s-dirty-little-secret)的技术。您可以通过编写来切换到更传统的 float 方法`$output: float`。这些输出样式的文档可以在这里找到：[https ://github.com/Team-Sass/Singularity/wiki/Output-Styles#float](https://github.com/Team-Sass/Singularity/wiki/Output-Styles#float)

# php - 如何使用 php 读取对象值和属性？

> ID：15935686
> 
> 赞同：0
> 
> 时间：2013-04-10T20:22:59.777
> 
> 标签：php, object, symfony1

我一直在处理一些代码，我正在接收一个 var（我没有处理整个代码，所以，我不知道它是如何制作的），我的问题是我得到了这样的东西

```
AdminUserRoleDecorator Object (
    [user:AdminUserRoleDecorator:private] => EssUserRoleDecorator Object (
        [user:EssUserRoleDecorator:private] => User Object (
            [topMenuItemsArray:User:private] => Array ( )
            [employeeList:User:private] => Array ( )
            [activeProjectList:User:private] => Array ( )
            [empNumber:User:private] => [allowedActions:User:private] => Array ( )
            [nextState:User:private] => [userId:User:private] => 1
            [userTimeZoneOffset:User:private] => -6 
```

老实说，这听起来像是一个非常愚蠢的问题，我不知道如何阅读，通常我以 $myobject->atribute 的方式获取属性，现在我真的不知道，我可以通过任何方式访问这个？例如，我想获取 userId，我在那里看到它，带有 :user:private （我也不知道它们是做什么用的）。

如果我尝试

```
$myobject->User; 
```

例如，我什么也得不到。

谢谢。

编辑：

我试过 $myobject->user

我得到了这个

```
Fatal error: Cannot access private property AdminUserRoleDecorator 
```

顺便说一句，我正在使用 symfony。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:29:36.650

[从我在这里给出的答案中](https://stackoverflow.com/questions/7067007/get-complete-playlist-listing-for-a-youtube-user-via-api/15102754#15102754)，您可以通过`get_class_methods()`( [php 参考](http://us3.php.net/manual/en/function.get-class-methods.php)) 和`get_class_vars()`. 在那篇文章中，我编写了一个函数来帮助我了解有关可用类方法的更多信息：

```
show_methods($playlistListFeed);

function show_methods( $_a ) {
    echo "<h3>Methods for ".get_class($_a)."</h3>";
    $_a= get_class_methods($_a);
    $_a=array_unique($_a);
    array_multisort(&$_a);
    $i=0;
    foreach( $_a as $method ) {
        $i++;
        printf("%-30.30s",$method);
        if($i%5==0)
            echo "\n";
    }
} 
```

# php - 在PHP中插入sql

> ID：15935690
> 
> 赞同：0
> 
> 时间：2013-04-10T20:23:13.653
> 
> 标签：php, comments

假设我有一个名为`comments.php`. 在其中我有这样的一行：

```
$post_id = $_GET['id']; 
$result = mysqli_query($con,"SELECT * FROM comments WHERE post_id = $post_id"); 
```

`$post_id`是实际条目的 id。

如果我回`$post_id`显它会显示条目的编号，那没有问题。

还有一个文件叫`comment_send.php`.

我想在其中发送评论以及实际条目的 id，以便评论知道它们属于哪里。

```
$post_id = $_GET['id'];
$result = mysqli_query($con,"SELECT * FROM comments WHERE post_id = $post_id"); 
$sql="INSERT INTO comments (comment, post_id) VALUES ('$_GET[comment]','$post_id')"; 
```

但是，当我点击提交按钮时，我得到了这个：`Notice: Undefined index: id`

我不明白这个问题，因为`comments.php`一切正常，但如果我将相同的部分移动到另一个文件中，它会失败。有谁知道我的问题可能是什么？

是的，评论到达数据库，编号为 0，而不是条目编号。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:27:51.970

您使用表单将数据从客户端提交到服务器，对吗？检查您在表单上的操作。它是 POST（如果您正在更新数据库，它应该是）？如果是，请更改`$post_id = $_GET['id'];`为`$post_id = $_POST['id'];`

作为故障排除工具，我通常会`echo('<pre>'.print_r($_REQUEST,1).'</pre>');`在页面顶部添加类似的内容。然后，您可以找出要发送到服务器的数据类型。然后，当您执行 SQL 语句时，请务必回显查询以查看它是什么。

此外，当您对 SQL 注入开放时，请清理您的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:28:21.997

您似乎没有将“id”传递给您的comment_send.php 页面。将它与您的评论一起传递，或者将其保存为上一页上的 $_SESSION 变量。

# json.net - JObject.ToBsonDocument 删除值

> ID：15935696
> 
> 赞同：14
> 
> 时间：2013-04-10T20:23:48.373
> 
> 标签：json.net, mlab

我将原始 JSON 插入到集合中，发现数据库中存储的内容缺少值。例如，我的集合是一个集合`BsonDocuments`：

```
_products = database.GetCollection<BsonDocument>("products"); 
```

将 JSON 插入集合的代码：

```
public int AddProductDetails(JObject json)
{
    var doc = json.ToBsonDocument(DictionarySerializationOptions.Document);
    _products.Insert(doc);
} 
```

传入的 JSON 如下所示：

```
{
  "Id": 1,
  "Tags": [
    "book",
    "database"
  ],
  "Name": "Book Name",
  "Price": 12.12
} 
```

但是，集合中保留的只是没有值的属性。

```
{
  "_id": {
    "$oid": "5165c7e10fdb8c09f446d720"
  },
  "Id": [],
  "Tags": [
    [],
    []
  ],
  "Name": [],
  "Price": []
} 
```

为什么值被丢弃？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-10T22:29:32.083

这符合我的预期。

```
 public int AddProductDetails(JObject json)
    {
        BsonDocument doc = BsonDocument.Parse(json.ToString());
        _products.Insert(doc);
    } 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-04-30T13:58:33.720

当我有一个具有 type 属性的 C# 类时，我遇到了这个问题`JObject`。

我的解决方案是`JObjectSerializer`为 MondoDB 创建并将属性添加到属性中，以便 Mongo 序列化程序使用它。我假设如果我足够努力，我也可以在 Mongo 中将以下序列化程序注册为这种类型的全局序列化程序。

注册序列化器进行属性处理：

```
[BsonSerializer(typeof(JObjectSerializer))]
public JObject AdditionalData { get; set; } 
```

序列化程序本身：

```
public class JObjectSerializer : SerializerBase<JObject> // IBsonSerializer<JObject>
{
    public override JObject Deserialize(BsonDeserializationContext context, BsonDeserializationArgs args)
    {
        var myBSONDoc = BsonDocumentSerializer.Instance.Deserialize(context);
        return JObject.Parse(myBSONDoc.ToString());
    }

    public override void Serialize(BsonSerializationContext context, BsonSerializationArgs args, JObject value)
    {
        var myBSONDoc = MongoDB.Bson.BsonDocument.Parse(value.ToString());
        BsonDocumentSerializer.Instance.Serialize(context, myBSONDoc);
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-09-21T17:47:31.723

使用`JObject.ToString`,`BsonDocument.Parse`等时的问题是性能不是很好，因为您多次执行相同的操作，您执行字符串分配、解析等。

因此，我编写了一个将 a 转换`JObject`为 an `IEnumerable<KeyValuePair<string, object>>`（仅使用枚举）的函数，它是一种可由`BsonDocument`构造函数之一使用的类型。这是代码：

```
public static BsonDocument ToBsonDocument(this JObject jo)
{
    if (jo == null)
        return null;

    return new BsonDocument(ToEnumerableWithObjects(jo));
}

public static IEnumerable<KeyValuePair<string, object>> ToEnumerableWithObjects(this JObject jo)
{
    if (jo == null)
        return Enumerable.Empty<KeyValuePair<string, object>>();

    return new JObjectWrapper(jo);
}

private class JObjectWrapper : IEnumerable<KeyValuePair<string, object>>
{
    private JObject _jo;

    public JObjectWrapper(JObject jo)
    {
        _jo = jo;
    }

    public IEnumerator<KeyValuePair<string, object>> GetEnumerator() => new JObjectWrapperEnumerator(_jo);
    IEnumerator IEnumerable.GetEnumerator() => GetEnumerator();

    public static object ToValue(JToken token)
    {
        object value;
        switch (token.Type)
        {
            case JTokenType.Object:
                value = new JObjectWrapper((JObject)token);
                break;

            case JTokenType.Array:
                value = new JArrayWrapper((JArray)token);
                break;

            default:
                if (token is JValue jv)
                {
                    value = ((JValue)token).Value;
                }
                else
                {
                    value = token.ToString();
                }
                break;
        }
        return value;
    }
}

private class JArrayWrapper : IEnumerable
{
    private JArray _ja;

    public JArrayWrapper(JArray ja)
    {
        _ja = ja;
    }

    public IEnumerator GetEnumerator() => new JArrayWrapperEnumerator(_ja);
}

private class JArrayWrapperEnumerator : IEnumerator
{
    private IEnumerator<JToken> _enum;

    public JArrayWrapperEnumerator(JArray ja)
    {
        _enum = ja.GetEnumerator();
    }

    public object Current => JObjectWrapper.ToValue(_enum.Current);
    public bool MoveNext() => _enum.MoveNext();
    public void Reset() => _enum.Reset();
}

private class JObjectWrapperEnumerator : IEnumerator<KeyValuePair<string, object>>
{
    private IEnumerator<KeyValuePair<string, JToken>> _enum;

    public JObjectWrapperEnumerator(JObject jo)
    {
        _enum = jo.GetEnumerator();
    }

    public KeyValuePair<string, object> Current => new KeyValuePair<string, object>(_enum.Current.Key, JObjectWrapper.ToValue(_enum.Current.Value));
    public bool MoveNext() => _enum.MoveNext();
    public void Dispose() => _enum.Dispose();
    public void Reset() => _enum.Reset();
    object IEnumerator.Current => Current;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-10T20:57:15.380

您是否尝试过使用 BsonSerializer？

```
using MongoDB.Bson.Serialization;
[...]
var document = BsonSerializer.Deserialize<BsonDocument>(json); 
```

BsonSerializer 适用于字符串，因此如果 JSON 参数是 JObject（或 JArray、JRaw 等），则必须使用 JsonConvert.SerializeObject() 对其进行序列化

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-01T13:50:34.280

这是 Andrew DeVries[答案](https://stackoverflow.com/a/43707229/3746036)的更新版本，其中包括处理序列化/反序列化空值。

```
public class JObjectSerializer : SerializerBase<JObject>
{
    public override JObject Deserialize(BsonDeserializationContext context, BsonDeserializationArgs args)
    {
        if (context.Reader.CurrentBsonType != BsonType.Null)
        {
            var myBSONDoc = BsonDocumentSerializer.Instance.Deserialize(context);
            return JObject.Parse(myBSONDoc.ToStrictJson());
        }
        else
        {
            context.Reader.ReadNull();
            return null;
        }
    }

    public override void Serialize(BsonSerializationContext context, BsonSerializationArgs args, JObject value)
    {
        if (value != null)
        {
            var myBSONDoc = BsonDocument.Parse(value.ToString());
            BsonDocumentSerializer.Instance.Serialize(context, myBSONDoc);
        }
        else
        {
            context.Writer.WriteNull();
        }
    }
} 
```

该`ToStrictJson()`调用是一种扩展方法，它将对内置 BSON`ToJson()`方法的调用包装起来，包括将输出模式设置为严格。如果不这样做，解析将失败，因为 BSON 类型构造函数将保留在 JSON 输出中（`ObjectId()`例如 ）。

这里也是实现`ToStrictJson()`：

```
public static class MongoExtensionMethods
{
    /// <summary>
    /// Create a JsonWriterSettings object to use when serializing BSON docs to JSON.
    /// This will force the serializer to create valid ("strict") JSON.
    /// Without this, Object IDs and Dates are ouput as {"_id": ObjectId(ds8f7s9d87f89sd9f8d9f7sd9f9s8d)}
    ///  and {"date": ISODate("2020-04-14 14:30:00:000")} respectively, which is not valid JSON
    /// </summary>
    private static JsonWriterSettings jsonWriterSettings = new JsonWriterSettings()
    {
        OutputMode = JsonOutputMode.Strict
    };

    /// <summary>
    /// Custom extension method to convert MongoDB objects to JSON using the OutputMode = Strict setting.
    /// This ensure that the resulting string is valid JSON.
    /// </summary>
    /// <typeparam name="TNominalType">The type of object to convert to JSON</typeparam>
    /// <param name="obj">The object to conver to JSON</param>
    /// <returns>A strict JSON string representation of obj.</returns>
    public static string ToStrictJson<TNominalType>(this TNominalType obj)
    {
        return BsonExtensionMethods.ToJson<TNominalType>(obj, jsonWriterSettings);
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-17T08:52:56.980

我使用以下。它基于[西蒙的回答](https://stackoverflow.com/a/52448766/7818969)，感谢您的想法，并以相同的方式工作，避免不必要的序列化/反序列化为字符串。

由于 Linq 和 C# 10，它变得更加紧凑：

```
public static BsonDocument ToBsonDocument(this JObject o) =>
    new(o.Properties().Select(p => new BsonElement(p.Name, p.Value.ToBsonValue())));

public static BsonValue ToBsonValue(this JToken t) =>
    t switch
    {
        JObject o => o.ToBsonDocument(),
        JArray a => new BsonArray(a.Select(ToBsonValue)),
        JValue v => BsonValue.Create(v.Value),
        _ => throw new NotSupportedException($"ToBsonValue: {t}")
    }; 
```

# linux - linux将第一行包含基因组的文件复制到其他目录

> ID：15935698
> 
> 赞同：0
> 
> 时间：2013-04-10T20:23:52.110
> 
> 标签：linux, bash, copy

我的目录下有很多文件。我想将那些第一行包含“基因组”字的那些复制到一个新文件夹中。我该怎么做。我可以匹配这些行，但我不知道如何再次操作该文件。我建立了一个 bash 结构，例如

```
for i in *
do
  if [ sed -ne 'genome' $i ]
  then cp $i OTHERDIR
  fi
done 
```

但是似乎 if 语句可以做的事情非常有限，并且不像其他编程语言那样不能在其中包含 sed。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:31:21.087

尝试这个：

```
for i in *
do
    head -1 $i| grep "genome" && cp $i OTHERDIR
done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:38:01.190

您可以使用 head -1 查看第一行：

```
for i in *
do
  fline=`head -1 $i`
  if [ "$fline" = genome ]
    then cp $i OTHERDIR
  fi
done 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T21:07:11.117

首先，您似乎没有尝试只检查第一行。`head`正如其他海报所提到的，你的表达应该用来隔离第一行。

无论如何，您可以在 if 语句中使用 sed 或 grep 完成此任务。管道需要使用输出捕获 $()

使用 sed：您不需要`-e`，它是默认设置。

```
$(head -1 $i | sed -n '/genome/=') 
```

使用 grep：可能是更简单的解决方案。sed 胜任这项工作。

```
$(head -1 $i | grep genome) 
```

[http://www.unix.com/unix-dummies-questions-answers/65705-how-grep-only-1st-line.html](http://www.unix.com/unix-dummies-questions-answers/65705-how-grep-only-1st-line.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T19:00:22.943

令人惊讶的是，我自己尝试了以下脚本并且它有效。尚未检查发布的答案。

```
for i in *
do
    grep -l "genome" $i | xargs -I one cp one DESTDIR
done 
```

# java - 弱类型，自动装箱，扩大转换之间有什么区别？

> ID：15935699
> 
> 赞同：0
> 
> 时间：2013-04-10T20:23:52.480
> 
> 标签：java, php, javascript, python, weak-typing

似乎弱类型的定义（不要与动态类型混淆）是当两个值都是不同类型时，二元运算符可以工作。

Python 程序员认为 Python 是强类型的，因为它`1+"hello"`会失败而不是默默地做其他事情。相反，通常被认为是弱类型的其他语言（例如 PHP、JavaScript、Perl）会静默地转换一个或两个操作数。例如，在 JavaScript 中是`1+"hello"`-> `"1hello"`，而在 Perl 中是`1+"hello"`-> `1`，但是`1+"5"`-> `6`。

现在，我的印象是 Java 被认为是一种强类型语言，但自动（取消）装箱和扩大转换似乎与此相矛盾。例如，`1+new Integer(1)`-> `2`、`hello+"1"`-> `"hello1"`、`'A'+1`->`66`和 long 可以自动转换为 float，即使它通常会被截断。Java是弱类型的吗？弱类型、自动装箱和扩大转换之间有什么区别？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T20:50:38.733

弱类型是当编译器/解释器觉得需要时隐式执行某些转换和临时多态性。

自动装箱是在需要时将文字和非对象类型自动转换为各自的对象类型。（例如，Java 将允许您在字符串文字上调用方法，就好像它是字符串对象一样。）这与打字系统无关。避免显式创建对象实际上只是语法糖。

扩大转换是弱类型的一种形式。在非常严格的强类型语言中，这是不允许的。但是在像 Java 这样的语言中，它是允许的，因为它没有负面影响。如此微小的东西不足以不再将 Java 视为一种强类型语言。

Java 还为字符串连接重载了 + 运算符。这绝对是弱类型语言中的一个特性，但同样，这还不足以称 Java 为弱类型。（尽管我认为这是一个非常愚蠢的想法。）

# php - 从 PHP 数组中删除随机项

> ID：15935701
> 
> 赞同：2
> 
> 时间：2013-04-10T20:23:58.013
> 
> 标签：php, arrays

我需要将此数组的大小减小到 X，所以我想删除 X 个随机项。这是我的 PHP 数组：

```
Array
(
    [helping] => 3
    [me] => 2
    [stay] => 1
    [organized!] => 1
    [votre] => 4
    [passion,] => 1
    [action,] => 1
    [et] => 2
    [impact!] => 1
    [being] => 4

) 
```

我试过 array_rand() 但它没有保留键/值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:31:36.540

[array_rand()](http://php.net/array_rand)返回给定数组的随机键（或更多），使用它取消设置：

```
$randomKey = array_rand($array, 1);
unset($array[$randomKey]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T20:33:55.547

`array_rand()`返回一个包含原始数组中键的数组。

您需要使用`foreach`-loop 从原始数组中删除键。

像这样：

```
// Suppose you need to delete 4 items.
$keys = array_rand($array, 4);

// Loop through the generated keys
foreach ($keys as $key) {
    unset($array[$key]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:53:00.933

```
$foo = Array(
    "helping" => 3,
    "me" => 2,
    "stay" => 1,
    "organized!" => 1,
    "votre" => 4,
    "passion," => 1,
    "action," => 1,
    "et" => 2,
    "impact!" => 1,
    "being" => 4
);

$max = 5; //number of elements you wish to remain

for($i=0;$i<$max;$i++){ //looping through $max iterations, removing an element at random
     $rKey = array_rand($foo, 1);
     unset($foo[$rKey]);
}

die(print_r($foo)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T20:56:02.320

用这个，

```
$array = array(); // Your array

$max = 3;
$keys = array_rand($array, count($array) - $max);

// Loop through the generated keys
foreach ($keys as $key) {
    unset($array[$key]);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-11T15:34:36.507

如果您需要删除未知的项目编号，您可以执行以下操作：

```
$myArr = [
    'helping' => 3,
    'me' => 2,
    'stay' => 1,
    'organized!' => 1,
    'votre' => 4,
    'passion,' => 1,
    'action,' => 1,
    'et' => 2,
    'impact!' => 1,
    'being' => 4,
];
$countToRemove = random_int(1, 2); // can return 1 or 2
$keysToRemove = array_rand($myArr, $countToRemove); // returns an int or array
// create the array to loop
foreach (\is_array($keysToRemove) ? $keysToRemove : [$keysToRemove] as $key) { 
    unset($myArr[$key]);
}
var_dump($myArr); die(); 
```

在这种情况下，它将从数组中随机删除 1 或 2 个项目。

# jquery - JQuery 验证插件问题

> ID：15935704
> 
> 赞同：0
> 
> 时间：2013-04-10T20:24:14.110
> 
> 标签：jquery, jquery-validate

我正在使用 jquery 验证插件。这是我网站上的一个简单表单，它位于 MVC 4 中

```
<form name="profileForm" id="profileForm" action="@Url.Content("~/myprofile")" method="post" enctype="multipart/form-data">
                <input type="text" class="name input" placeholder="First name" name="FirstName" id="FirstName" value="@Request["FirstName"]"/>
                <input type="text" class="company input" placeholder="Last Name" name="LastName" id="LastName" value="@Request["LastName"]"/>
                <textarea class="tarea input" placeholder="About" name="AboutUser">@Request["AboutUser"]</textarea> 
```

并使用一些客户端脚本

```
 </body>
</html>        

    <script src="/Scripts/jquery-1.8.2.js"></script>

         <script src="/Scripts/jquery.unobtrusive-ajax.js"></script>
    <script src="/Scripts/jquery.validate.js"></script>
    <script src="/Scripts/jquery.validate.unobtrusive.js"></script>
    <script src="/Scripts/additional-methods.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {

        $('#profileForm').validate({
            rules: {
                FirstName: {
                    required: true,
                    number: true
                },
            }
        });

   });

    </script> 
```

当我将“必需”类添加到“名字”字段并且验证插件可以正确验证它时，一切正常。但是，当我不这样做时（正如我在上面给出的代码中所做的那样），验证插件根本不起作用。是否有我遗漏的东西或验证插件中有一些限制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T00:27:29.390

添加一个`</form>`标签，您的代码运行良好。也许您*呈现的*HTML 看起来与您预期的不同。

```
Browser -> View Source 
```

...并确保`name`每个字段的属性与`name`您`.validate()`在`rules`.

**演示：http: [//jsfiddle.net/skt3b/](http://jsfiddle.net/skt3b/)**

**jQuery** :

```
$(document).ready(function () {

    $('#profileForm').validate({
        rules: {
            FirstName: {
                required: true,
                number: true
            }
        }
    });

}); 
```

**HTML**：

```
<form id="profileForm" name="profileForm" action="" method="post" enctype="multipart/form-data">
    <input type="text" name="FirstName" id="FirstName" class="name input" placeholder="First name"  value=""/>
    <input type="text" name="LastName" id="LastName" class="company input" placeholder="Last Name"  value=""/>
    <textarea name="AboutUser" class="tarea input" placeholder="About"></textarea>
    <input type="submit" />
</form> 
```

# eclipse - 如何让我的自定义工具栏通过 IElementUpdater 更新其项目

> ID：15935708
> 
> 赞同：3
> 
> 时间：2013-04-10T20:24:19.203
> 
> 标签：eclipse, eclipse-rcp, eclipse-plugin

我在我的 RCP 应用程序中实现了一个自定义工具栏。我还使用`org.eclipse.ui.menus`扩展为自定义工具栏提供命令。

```
<extension
     point="org.eclipse.ui.menus">
  <menuContribution            
       locationURI="toolbar:com.my.custom.toolbar.identifier.toolbar">
     <command
           commandId="com.my.command.id"
           icon="icons/my_icon.png"
           style="toggle"
           tooltip="My Toggle Tooltip">
      </command>
   </menuContribution>
 </extension> 
```

我已经编写了找到这些 IConfigurationElements 并将它们转换为 CommandContributionItems 的代码，我用它来将它们添加到我的自定义工具栏。

我有一些切换类型的工具栏项，我需要这些项来使用`IElementUpdater`命令处理程序实现的接口更新它们的 UI。

我还将这个命令贡献给一个标准的 Eclipse 菜单......比如“toolbar:org.eclipse.ui.main.toolbar”，它的切换状态在适当的时候通过 IElementUpdater 更新。

我的自定义工具栏中可能缺少将其连接到 IElementUpdater 的某些内容，但我不知道从哪里开始寻找使这项工作有效的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T11:32:49.510

我使用了 IElementUpdater，但不适用于更新切换状态的情况，因为这应该通过与相应命令的连接来完成。但是，Eclipse 4 中存在一些问题，我已经在一篇[博客文章](http://www.descher.at/descher-vu/2013/02/synchronising-stateful-items-part1/)中指出了这些问题。

您使用的是什么 Eclipse 变体？3.x 还是 4.x？4.x 中存在一个关于贡献及其命令状态同步的[错误。](https://bugs.eclipse.org/bugs/show_bug.cgi?id=398647)

# php - 如何知道 preg_replace_callback 中的匹配计数 - PHP

> ID：15935709
> 
> 赞同：1
> 
> 时间：2013-04-10T20:24:21.167
> 
> 标签：php, preg-replace-callback

我在 php 中有这段代码-：

```
function pregRepler($matches)
{
    * do something
}

$str = preg_replace_callback($reg_exp,'pregRepler',$str); 
```

在功能中`pregRepler`，我想知道当前`match number`是第一个匹配还是第二个匹配或其他什么...

我该怎么做。？？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-10T20:27:23.157

尝试这样的事情：

```
function pregRepler($matches) {
    static $matchcount = 0;
    // do stuff
    $matchcount++;
} 
```

正如我在对[您的另一个问题](https://stackoverflow.com/questions/15934249/use-a-local-variable-in-preg-replace-callback-php)[的回答](https://stackoverflow.com/a/15934350/507674)中提到的那样，这对于匿名函数效果更好，因为如果您多次调用.`preg_replace_callback`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T21:08:40.683

您需要`$count`在两个变量范围之间共享一个变量，例如使用变量别名：

```
$callback = function($matches) use (&$count) {
    $count++;
    return sprintf("<%d:%s>", $count, $matches[0]);
};

echo preg_replace_callback($pattern, $callback , $subject, $limit = -1, $count); 
```

在调用之前，`$count`等于 0。在调用之后`$count`设置为完成的替换次数。在这两者之间，您可以在回调中计数。您也可以在下次调用时再次设置为零。

[看到它在行动](http://eval.in/15896)

见[http://php.net/preg_replace_callback](http://php.net/preg_replace_callback)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:27:35.903

```
$repled     = 0;
function pregRepler($matches)
{
    * do something
    global $repled;
    $repled++;
}

$str = preg_replace_callback($reg_exp,'pregRepler',$str); 
```

只需从全局变量中计数。

# ruby-on-rails - 无法生成模型：“您已经激活了 multi_json 1.7.2，但您的 Gemfile 需要 multi_json 1.4.0”

> ID：15935712
> 
> 赞同：0
> 
> 时间：2013-04-10T20:24:43.297
> 
> 标签：ruby-on-rails, gemfile

这是我输入的内容：

$ rails 生成脚手架 Foobar 内容：字符串

这是我得到的：

```
/Users/nsbarr/.rvm/gems/ruby-1.9.3-p286@rails3tutorial2ndEd/gems/bundler-1.2.1/lib/bundler/runtime.rb:31:in `block in setup': You have already activated multi_json 1.7.2, but your Gemfile requires multi_json 1.4.0\. Using bundle exec may solve this. (Gem::LoadError)
from /Users/nsbarr/.rvm/gems/ruby-1.9.3-p286@rails3tutorial2ndEd/gems/bundler-1.2.1/lib/bundler/runtime.rb:17:in `setup'
from /Users/nsbarr/.rvm/gems/ruby-1.9.3-p286@rails3tutorial2ndEd/gems/bundler-1.2.1/lib/bundler.rb:116:in `setup'
from /Users/nsbarr/.rvm/gems/ruby-1.9.3-p286@rails3tutorial2ndEd/gems/bundler-1.2.1/lib/bundler/setup.rb:7:in `<top (required)>'
from /Users/nsbarr/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `require'
from /Users/nsbarr/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'
from /Users/nsbarr/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'
from /Users/nsbarr/rails_projects/poems_io/config/boot.rb:7:in `<top (required)>'
from /Users/nsbarr/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
from /Users/nsbarr/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
from script/rails:5:in `<main>' 
```

我正在使用 Michael Hartl 的 Rails 教程。这是我的 Gemfile：来源' [https://rubygems.org](https://rubygems.org) '

```
gem 'rails', '3.2.8'

gem 'twilio-ruby'

group :development do
  gem 'sqlite3', '1.3.5'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'coffee-rails', '3.2.2'
  gem 'uglifier', '1.2.3'
end

gem "twitter-bootstrap-rails"
gem 'less-rails-bootstrap', '2.0.6'
gem 'jquery-rails', '2.0.2'
gem "therubyracer"

group :development, :test do
  gem 'sqlite3', '1.3.5'
  gem 'rspec-rails', '2.11.0'
end

gem 'annotate', '2.5.0', group: :development

group :production do
end

group :production do
  gem 'pg'
end 
```

我以前能够在这个应用程序上生成模型，所以我不确定在此期间发生了什么。通过搜索错误消息无法找到任何内容。感谢您的任何指导！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:26:53.687

运行以下命令，一切都应该没问题：

```
bundle exec rails generate scaffold Foobar content:string 
```

# javascript - 如何实现和使用 eyecon 的 bootstrap-datepicker？

> ID：15935718
> 
> 赞同：14
> 
> 时间：2013-04-10T20:25:05.063
> 
> 标签：javascript, jquery, html, twitter-bootstrap, bootstrap-datepicker

我访问了[Eyecon](http://www.eyecon.ro/bootstrap-datepicker/)并下载了 datepicker。我有三个文件夹。“css”、“js”和“less”。我已经包含了 bootstrap-datepicker.js 和最新的 jquery.js 并在头部链接了 .css：

```
<!DOCTYPE>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Test</title>
        <link rel="stylesheet" type="text/css" href="../css/datepicker.css">
        <link rel="stylesheet" type="text/css" href="../css/bootstrap.css">
        <link rel="stylesheet" type="text/css" href="../css/bootstrap-responsive.css">

    </head>

    <body>
        <div class="well">
            <!--What should I enter here and where/how do I call the function?-->
        </div>

        <script type="text/javascript" src="../js/jquery.js"></script>
        <script type="text/javascript" src="../js/bootstrap-datepicker.js"></script>
        <script type="text/javascript" src="../js/bootstrap.js"></script>
    </body>
</html> 
```

正如人们所看到的，我已经在使用引导库，因此也包含了它。

我现在的问题是：如何实现和调用日期选择器功能？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-10T20:27:03.527

`$('element').datepicker();``element`一些类，id等在哪里？

[http://jsfiddle.net/6kk3k/1/](http://jsfiddle.net/6kk3k/1/)

**HTML**

```
<input type="text" class="datepicker"> 
```

**jQuery**

```
$('.datepicker').datepicker(); 
```

# html - 引导中心内容很好

> ID：15935719
> 
> 赞同：2
> 
> 时间：2013-04-10T20:25:07.067
> 
> 标签：html, css, twitter-bootstrap, center

我正在尝试使用 Twitter Bootstrap 将一些内容集中在 Well 类中。

我尝试过使用 row 和其他各种 CSS 技巧。

这是我的 HTML：

```
<div class="container well well-main">
   <div id="marketing-mobile" class="title-marketing"><h3 class="text-center">Mobile</h3></div>
    <div class="widget-marketing span5">
        <div class="media">
          <a class="pull-left" href="#">
            <img class="media-object media-icons" img src="img/book.png">
          </a>
          <div class="media-body">
            <h3 class="media-heading">Lorem Ipsum</h3>
            <p>Donec id elit non mi porta gravida at eget metus. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
          </div>
        </div>
    </div> 
```

我已经截取了问题的屏幕截图：![在此处输入图像描述](https://i.stack.imgur.com/alm6m.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-28T14:23:57.713

这已经解决了，但是如果有人有兴趣查看示例，`offset3`在这种情况下可以将`span5`

```
<div class="container well well-main">
   <div id="marketing-mobile" class="title-marketing"><h3 class="text-center">Mobile</h3></div>
    <div class="widget-marketing span5 offset3">
        <div class="media">
          <a class="pull-left" href="#">
            <img class="media-object media-icons" src="//placehold.it/75x75">
          </a>
          <div class="media-body">
            <h3 class="media-heading">Lorem Ipsum</h3>
            <p>Donec id elit non mi porta gravida at eget metus. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
          </div>
        </div>
</div></div> 
```

[http://bootply.com/65949](http://bootply.com/65949)

# c# - 无法正确显示欠税结果

> ID：15935723
> 
> 赞同：1
> 
> 时间：2013-04-10T20:25:23.910
> 
> 标签：c#, methods, sorting, compareto

一切似乎都运行良好，除了显示的欠税始终为 0。我无法弄清楚如何正确获取默认值或用户条目的计算。这是我有任何帮助的代码，将不胜感激。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace TestApp
{
class Rates
{
    public readonly int incomeLimit;
    public readonly double lowTax;
    public readonly double highTax;

    public Rates()
    {
        incomeLimit = 30000;
        lowTax = .15;
        highTax = .28;
    }
    public Rates(int limit, double lowRate, double highRate)
    {
        limit = incomeLimit;
        lowRate = lowTax;
        highRate = highTax;
    }
    public double CalcTax(double income)
    {            
        double tax; 
        if (income < incomeLimit)
        tax = income * lowTax;
        else
            tax = income * highTax;

        return tax;
    }
}
class Taxpayer : IComparable <Taxpayer>
{
    public string social;
    public double grossincome;
    public double taxowed;

    public string SSN 
    { 
        get
    {
        return social;
    }
        set
    {
        social = value;
    }
    }
    public double grossIncome 
    { 
        get
        {
            return grossincome;
        }
        set
        {
            grossincome = value;
        }
    }
    public double taxOwed
    {
        get
        {
            return taxowed;
        }
    }

    public int CompareTo(Taxpayer o)
    {           
        return this.taxOwed.CompareTo(o.taxOwed);
    }
    public static void getRates()
    {
        Rates rates = new Rates();
        Taxpayer tax = new Taxpayer();

        int limit = 0;
        double lowRate = 0;
        double highRate = 0;
        char input;
        Console
          .Write("Do you want default values (enter D) or enter your own (enter O)? ");
        input = Char.ToUpper(Convert.ToChar(Console.ReadLine()));

        switch (input)
        {
            case 'D':
                Rates def = new Rates();
                limit = def.incomeLimit;
                lowRate = def.lowTax;
                highRate = def.highTax;
                tax.taxowed = def.CalcTax(tax.grossIncome);
                break;
            case 'O':
                Rates own = new Rates(limit, lowRate, highRate);
                Console.Write("Enter the dollar limit ");
                limit = Convert.ToInt32(Console.ReadLine());
                Console.Write("Enter the low rate ");
                lowRate = Convert.ToDouble(Console.ReadLine());
                Console.Write("Enter the high rate ");
                highRate = Convert.ToDouble(Console.ReadLine());
                tax.taxowed = own.CalcTax(tax.grossIncome);
                break;
        }

    }
}

class Program
{
    static void Main(string[] args)
    {
        Taxpayer[] taxarray = new Taxpayer[5];

        for (int x = 0; x < taxarray.Length; ++x)
        {
            taxarray[x] = new Taxpayer();
            Console.Write("Enter Social Security Number for taxpayer {0}: ", x+1);
            taxarray[x].SSN = Console.ReadLine().Replace("-", "");

            Console.Write("Enter gross income for taxpayer {0}: ", x+1);
            taxarray[x].grossIncome = Convert.ToDouble(Console.ReadLine());
            //Taxpayer.getRates();
            Taxpayer.getRates();
        }

        Console.WriteLine();
        for (int i = 0; i < taxarray.Length; i++)
        {               
            Console.WriteLine("Taxpayer # {0} SSN: {1} income {2:c} Tax is {3:c}", 
              i+1,taxarray[i].SSN, taxarray[i].grossIncome, taxarray[i].taxOwed);
        }

        Console.WriteLine("-------------------------------------------------------");
        Array.Sort(taxarray);
        for (int i = 0; i < taxarray.Length; i++)
        {
            Console.WriteLine("Taxpayer # {0} SSN: {1} income {2:c} Tax is {3:c}", 
              i+1,taxarray[i].SSN, taxarray[i].grossIncome, taxarray[i].taxOwed);
        }            
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:55:02.060

主要问题似乎是您正在调用静态方法 ( `getRates`)。您输入的值将存储在该`TaxPayer`方法中新创建的实例中，但它们永远不会复制到您在数组中创建的实例中。

我想你想让它成为一个实例方法，并在你的输入循环中这样调用它：

```
taxarray[x].getRates(); 
```

这将需要对您的方法进行一些更改`getRates`，特别是让它使用`this`引用而不是创建新`TaxPayer`实例。

# page-object-gem - 过时元素引用错误

> ID：15935726
> 
> 赞同：4
> 
> 时间：2013-04-10T20:25:29.053
> 
> 标签：page-object-gem

使用 page-object gem 和 Watir webdriver，我们偶尔会在页面上遇到 Selenium::WebDriver::Error::StaleElementReferenceError，它会加载一些基本内容、发出 ajax 请求并重新填充更多信息（对于速度的错觉在页面上）。

发生这种情况是因为那里会有一个 HTML 元素，它会很快消失并在用户真正意识到之前再次出现。

我们使用页面对象的“.when_present”方法等到对象第一次出现在页面上之后再访问它。然而，即使在代码找到了元素之后，它通常也会收到过时元素错误，因为原来的 HTML 元素已经消失，而另一个元素在它尝试访问它时又重新出现了。

我们找到了一种仅使用直接 Watir（不是页面对象）的方法。我们基本上在 Watir::Wait.until 块中捕获了 StaleElementReferenceError。如果遇到异常，则块返回 false，Wait.until 再次尝试，直到它变为 true 或最终超时。我们发现，这通常第一次获取 Stale Element（在下面的第 3 行），从救援返回 false，Wait.until 再次执行该块，第二次为 true，测试继续并通过.

```
1  Watir::Wait.until {
2    begin
3      tds = page.my_element.when_present.element.tds
4      table_data_classes = tds.map{|cell| cell.attribute_value("class") }
5
6      # Should have at least one with a class of "xyz"
7      xyz = table_data_classes.select{|data| data.include?("xyz")}
8      xyz.size > 0 
9    rescue Selenium::WebDriver::Error::StaleElementReferenceError
10     false
11   end
12 } 
```

我真的只是想知道这种事情是否有任何类型的页面对象包装器。我什么也找不到。如果没有，那没关系，因为上述方法有效。只是好奇。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T14:37:32.717

盖尔，好问题。如果 StaleElementReferenceError 发生在页面对象 gem 中，此时没有特定的重试处理。我从另一个人那里听说他们会定期收到此错误，这是我可以调查的。您使用的是什么版本的 watir-webdriver？

有一种方法可以使用 page-object 复制上面的代码。我不确定您提供的上述代码是在您的页面内还是在其他地方（如步骤定义或其他地方）。这是我使用页面对象 gem 会做的事情：

在您的 PageObject 类内部

```
def has_element_with_class(clz)
  wait_until
    begin
      cells = my_element.when_present.cell_elements
      cells.any? { |cell| cell.attribute('class').include? clz }
    rescue Selenium::WebDriver::Error::StaleElementReferenceError
      false
  end
end 
```

我只是将所有嵌套在`my_element`数组中的单元格（tds）。我正在调用该`any?`数组上的方法，如果任何块返回 true，则返回 true，否则返回 false。这与您上面的所有代码具有相同的效果。如果发生错误，那么您将继续下一次。

# apache - 如何使用 htaccess 将用户重定向到他们自己的 IP 地址

> ID：15935728
> 
> 赞同：-3
> 
> 时间：2013-04-10T20:25:34.520
> 
> 标签：apache, .htaccess, mod-rewrite

如何使用 htaccess 和 RewriteRule 将用户重定向到他们自己的 IP 地址？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:36:33.640

```
RewriteEngine On
RewriteRule ^(.*)$ http://%{REMOTE_ADDR}/ 
```

# servlets - 同一上下文中的 Servlet 和 JSF 页面显示不同的会话

> ID：15935733
> 
> 赞同：1
> 
> 时间：2013-04-10T20:26:04.970
> 
> 标签：servlets, jsf-2

我们需要从发出 post 请求的外部应用程序调用 servlet。

servlet 查看请求，执行一些处理并在请求或会话上设置属性并重定向到 JSF 页面，该页面需要检索在请求或会话上设置的属性并执行其他操作。

对于这两种情况，我都无法从托管 bean 检索会话或请求上设置的属性/参数，并且在进一步调试后，它显示 servlet 和托管 bean 中的会话 ID 不同。

由于这是来自外部应用程序的请求，因此 servlet 中没有会话，因此 request.getSession(true); 这是在 servlet 中创建一个新会话。

我的理解是，由于它们是同一应用程序的一部分，并且使用相同的上下文，因此它们将具有相同的会话。我的理解不正确吗？这个问题有更好的解决方案吗？（我确实考虑过创建一个过滤器，但认为会话可能有同样的问题）

任何有助于更好地理解或解决此问题的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:48:03.803

至于会话是如何工作的，请仔细阅读：[servlet 是如何工作的？实例化、会话、共享变量和多线程](https://stackoverflow.com/questions/3106452/how-do-servlets-work-instantiation-session-variables-and-multithreading/3106909#3106909)。

事实上，外部应用程序应该发送与 JSF 应用程序使用的完全相同的会话 cookie。另一种方法是提供一个包含`jsessionid`路径片段的回调 URL，其组成如下：

```
String url = "http://example.com/context/servlet;jsessionid=" + session.getId(); 
```

另一种选择是生成一个唯一 ID（带有`java.util.UUID`）引用应用程序范围甚至数据库中的条目，并将其设置为回调 URL 中的请求参数。您应该只在会话被销毁时手动清理它。您可以为此使用 HTTP 会话侦听器。

# jquery - IE10 不透明度与旧版本的 jquery 无关

> ID：15935734
> 
> 赞同：0
> 
> 时间：2013-04-10T20:26:06.267
> 
> 标签：jquery, internet-explorer-10

不久前我写了一个小灯箱视频播放器脚本，我们在我们的 3 个网站上使用它。我们的其中一个网站由注入旧版本 (1.4.3) 的 jquery 的第三方托管，我们无法控制。直到 IE10，灯箱/视频播放器脚本在所有浏览器中都运行良好，但在使用旧版本的 jquery 时，它在 IE10 中不起作用。IE10 中更高版本的 jquery 工作正常。我认为它遇到的问题与下面的行有关。有谁知道 IE10 处理不透明度的方式是否发生了变化，以及如何更新下面的脚本以支持 IE10？

```
props.overlay.css({ top: 0, left: 0, width: "100%", height: methods.getMaxHeight() + "px", opacity: .25 });
props.dv.css({ opacity: 1 }); 
```

编辑：我正在阅读您可以命名 jquery 以加载它的另一个版本。我尝试按照 jquery 网站上的示例执行此操作，但无法使其正常工作。在我的页面中，我有以下...

```
<script type="text/javascript" src="jquery.1.8.3.js"></script>
<script type="text/javascript">
  var jq183 = jQuery.noConflict(true);
  jq183(document).ready(function(){
    jq183(".videoplayer").VideoPlayer();
});
</script> 
```

我收到的错误是“Uncaught TypeError: Object [object Object] has no method 'VideoPlayer'” 我猜我需要更改我的 videoplayer.js 文件，但我不确定需要更改什么。有没有人这样做过并有任何指示？

# c# - 防止和重新启用 Windows 空闲状态

> ID：15935736
> 
> 赞同：1
> 
> 时间：2013-04-10T20:26:11.940
> 
> 标签：c#

下面的代码允许我防止 Windows 进入空闲状态和我的机器锁定自己：

```
[DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
public static extern EXECUTION_STATE SetThreadExecutionState(EXECUTION_STATE esFlags);

public static void PreventSleep()
{
    if (SleepUtil.SetThreadExecutionState(EXECUTION_STATE.ES_CONTINUOUS
            | EXECUTION_STATE.ES_DISPLAY_REQUIRED
            | EXECUTION_STATE.ES_SYSTEM_REQUIRED
            | EXECUTION_STATE.ES_AWAYMODE_REQUIRED) == 0) 
            SleepUtil.SetThreadExecutionState(EXECUTION_STATE.ES_CONTINUOUS
                | EXECUTION_STATE.ES_DISPLAY_REQUIRED
                | EXECUTION_STATE.ES_SYSTEM_REQUIRED); 
    } 
```

这很好用，但是我需要做什么才能重新启用空闲？我一直在搞砸一些事情，但每次尝试时，我都必须让笔记本电脑离开 10 分钟，看看它是否空闲（我的电源选项被组策略锁定）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:49:18.647

如何将调用的返回值保存到`SetThreadExecutionState`？[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/aa373208%28v=vs.85%29.aspx)说：

> 如果函数成功，则返回值为之前的线程执行状态。

所以你可以这样写似乎是合理的：

```
private EXECUTION_STATE SavedState;

SavedState = SleepUtil.SetThreadExecutionState(...); 
```

`SavedState`包含先前的值。所以看起来你可以通过写来把事情放回去：

```
SleepUtil.SetThreadExecutionState(SavedState); 
```

您甚至可以检查返回值 ( `SavedState`) 以确定默认值是什么，并使用它...

至少，这是我首先要尝试的。

# html - html的不可点击的href

> ID：15935737
> 
> 赞同：1
> 
> 时间：2013-04-10T20:26:12.163
> 
> 标签：html, css

为什么当我将鼠标指针悬停在链接上时手不会出现

`<a href=""></a>`当您将鼠标悬停在列表上时，手是单击链接的那只手，但我的手不会。

列表的第一行显示了整个区域，但另一行仅显示了该区域的一半。

这是我的小提琴：http: [//jsfiddle.net/TBEnf/5/](http://jsfiddle.net/TBEnf/5/)

![在此处输入图像描述](https://i.stack.imgur.com/L2C3G.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:28:51.517

**工作小提琴：http:** [//jsfiddle.net/TBEnf/7/](http://jsfiddle.net/TBEnf/7/)

`.UploadPicture ul li a`应该有`display:block;`

# jquery - jQueryUI传输效果：多个同时传输

> ID：15935738
> 
> 赞同：0
> 
> 时间：2013-04-10T20:26:20.147
> 
> 标签：jquery, jquery-ui, animation, transfer

考虑一下这个[小提琴](http://jsfiddle.net/NbWJn/)。

```
function transfer() {
    source.effect('transfer', { to: target }, 2000);
}
setInterval(transfer, 500); 
```

如您所见，转移是连续运行的。
你如何让它们同时运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:33:18.437

默认情况下 jQuery 动画队列。如果您查看 的[文档`.animate()`](http://api.jquery.com/animate/#animate-properties-options)，您会看到有一个`queue`选项可以禁用此行为。您也可以将其与 jQuery UI 的`.effect()`方法一起使用。以[这个小提琴](http://jsfiddle.net/NbWJn/2/)为例。

我已经[提交了一个问题](https://github.com/jquery/api.jqueryui.com/issues/118)以在文档中记录这[`.effect()`一点](http://api.jqueryui.com/effect/)。

# c# - 如何将 C dll 加载到 C# 代码中？

> ID：15935741
> 
> 赞同：0
> 
> 时间：2013-04-10T20:26:30.663
> 
> 标签：c#, c

我需要在 C 语言程序中使用一些函数。为了测试我定义了以下内容：

这是我的 .h 文件：

```
namespace amt
{
    class AMT_EXPORT FaceRecognition
    {   
        public:
            std::string amt_test_string(std::string in);
    };  
}; 
```

这是我的 .cpp 文件：

```
#include <memory.h>
#include <string>
#include <iostream>
#include <fstream>
#include "api_shared.h"
#include <sys/stat.h>

using namespace std;

std::string amt::FaceRecognition::amt_test_string (std::string in)
{
    std::string s="in: "+in;
    std::cout<<s<<std::endl;

    return s;
} 
```

我正在尝试调用这样的方法：

```
 const string str = "C:\\minimal.dll";
[DllImport(str)]
public static extern string amt_test_string(string input);
static void Main(string[] args)
{
    string myinput = "12";
    string myoutput = "";
    myoutput = amt_test_string(myinput);
    Console.WriteLine(myoutput);
    Console.Read();

} 
```

但是我收到一条错误消息，说它找不到名为 amt_test_string 的入口点。为什么会这样？我是 C 的新手

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:36:50.097

那不是 C DLL，那是 C++ DLL。C 和 C++*不是*同一种语言。特别是，C++ 具有名称修饰功能，因此导出到 DLL 的函数名称是*修饰*的。

出于这个原因，我强烈建议您避免在 DLL 中使用 C++ 导出。如果您只使用 C 导出，符号名称将是可预测的（即不取决于您的 C++ 编译器如何装饰名称的具体细节），并且您不必担心运行时差异，例如您的 C++ 标准库如何实现`std::string`.

我建议您的 DLL 导出如下所示：

```
extern "C"  // This says that any functions within the block have C linkage
{

// Input is 'in', output gets stored in the 'out' buffer, which must be 'outSize'
// bytes long
void DLLEXPORT amt_FaceRecogniztion_amt_test_string(const char *in, char *out, size_t outSize)
{
    ...
}

} 
```

该接口不依赖于任何特定库的`std::string`实现，并且 C# 知道如何将`char*`参数作为 C 字符串。但是，内存管理更复杂，因为您需要确定输出大小的上限并传入适当大小的缓冲区。

# python - 从范围的字典中检索结果

> ID：15935743
> 
> 赞同：-4
> 
> 时间：2013-04-10T20:26:37.960
> 
> 标签：python, list, dictionary, python-2.7

我有一个 ENTIREMAP，其中包含所有名称和玩具价格的映射。我想要尝试做的是创建一个函数 getResults ，如下所示：

```
#################
def getResults(name, price):
# where name could be 'Laura' and price is 0.02
# then from the ENTIREMAP find the key 'Laura' and if 0.02 is in the range
# of the prices in the map i.e since 0.02 is between (0.0,0.05) then return
# ('PEN', 'BLUE')

   prices =  [d[name] for d in ENTIRELIST if name in d]
   if prices:
       print prices[0]

###################

GIRLTOYPRICES = {(0.0,0.05):('PEN', 'BLUE'), 
             (0.05,0.08):('GLASSES', 'DESIGNER'), 
             (0.08,0.12):('TOP', 'STRIPY'), 
            }

BOYTOYPRICES = {(0.0,0.10):('BOOK', 'HARRY POTTER'), 
             (0.10,0.15):('BLANKET', 'SOFT'), 
             (0.15,0.40):('GBA', 'GAMES'), 
            }

GIRLS = ['Laura', 'Samantha']
BOYS = ['Mike','Fred']

GIRLLIST = [{girl: GIRLTOYPRICES} for girl in GIRLS]
BOYLIST = [{boy: BOYTOYPRICES} for boy in BOYS]

ENTIRELIST = GIRLMAP + BOYMAP 

print ENTIRELIST

[{'Laura': {(0.0, 0.05): ('PEN', 'BLUE'), (0.08, 0.12): ('TOP', 'STRIPY'), (0.05, 0.08): ('GLASSES', 'DESIGNER')}}, {'Samantha': {(0.0, 0.05): ('PEN', 'BLUE'), (0.08, 0.12): ('TOP', 'STRIPY'), (0.05, 0.08): ('GLASSES', 'DESIGNER')}}, {'Mike': {(0.0, 0.1): ('BOOK', 'HARRY POTTER'), (0.15, 0.4): ('GBA', 'GAMES'), (0.1, 0.15): ('BLANKET', 'SOFT')}}, {'Fred': {(0.0, 0.1): ('BOOK', 'HARRY POTTER'), (0.15, 0.4): ('GBA', 'GAMES'), (0.1, 0.15): ('BLANKET', 'SOFT')}}] 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:51:03.373

一种奇怪的数据结构，但是：

```
for person in ENTIRELIST:
    person_name, toys = person.items()[0]
    if person_name != name:                # inverted to reduce nesting
        continue

    for (price_min, price_max), toy in toys.items():
        if price_min <= price < price_max:
            return toy 
```

这更简单（也更有效）：

```
GIRLMAP = {girl: GIRLTOYPRICES for girl in GIRLS}
BOYMAP = {boy: BOYTOYPRICES for boy in BOYS}

ENTIREMAP = dict(GIRLMAP, **BOYMAP)

for (price_min, price_max), toy in ENTIREMAP[name].items():
    if price_min <= price < price_max:
        return toy 
```

# java - 更改 JButton 的背景

> ID：15935744
> 
> 赞同：3
> 
> 时间：2013-04-10T20:26:40.897
> 
> 标签：java, swing, jbutton

我有一个 Swing JButton，并且我还在为我的项目使用以下代码：

```
UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName()); 
```

现在，当尝试使用它更改一个按钮的背景时，`btnNewButton.setBackground(Color.RED);`它不会变成红色，只有边框变成红色。

如何在仍`UIManager.getSystemLookAndFeelClassName()`用于其余组件/项目的同时将此背景变为红色？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-10T20:50:33.260

查看错误[4880747：XP L&F: REGRESSION: setBackground on JButton 在 Windows XP 中设置边框颜色](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4880747)。评估部分指出：

> 更改按钮的外观总是会与当前的 L&F 实现发生冲突。Swing 的 Windows L&F 尝试尽可能接近原生显示。在 XP 上，我们为按钮使用内置的位图资源。这些不能被着色，就像在原生 API 中一样。
> 
> 您应该在按钮上调用 setContentAreaFilled(false) 以避免 L&F 绘制其装饰。这样做的副作用是按钮的 opaque 属性设置为 false，因此您需要在该调用之后调用 setOpaque(true)。
> 
> 这不是错误，将被关闭。

如前所述，`setContentAreaFilled(false)`并且`setOpaque(true)`可以解决问题，但是按钮看起来会有所不同。

如果它值得你创建你自己的麻烦`ButtonUI`。这是@mKorbel 提供的一个很好的[示例，您可能会发现它很有用。](https://stackoverflow.com/a/5755124/1048330)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:52:25.980

这取决于您想要达到的目标。

您可以使用`JButton#setContentAreaFilled`将其传递为假，但您可能还需要调用`JButton#setBorderPainted`传递它跌倒

您还可以更改`UIManager`按钮背景的默认值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:39:11.657

你应该使`JButton`不透明：

```
btnNewButton.setOpaque(true); 
```

[`JComponent#setBackground`](http://docs.oracle.com/javase/6/docs/api/javax/swing/JComponent.html#setBackground%28java.awt.Color%29)如oracle 文档中指定的方法：

> 设置此组件的背景颜色。仅当组件不透明时才使用背景颜色，并且仅由 JComponent 或 ComponentUI 实现的子类使用。JComponent 的直接子类必须覆盖paintComponent 以遵守此属性。
> 
> **尊重此属性取决于外观和感觉，有些人可能会选择忽略它。**

我认为当前的外观不支持这个属性。这就是为什么在这种情况下背景颜色被忽略的原因。

# php - PHP Pear Mail SSL 连接问题

> ID：15935745
> 
> 赞同：1
> 
> 时间：2013-04-10T20:26:42.493
> 
> 标签：php, email, ssl, openssl, pear

我正在接收

```
Failed to connect to ssl://smtp.gmail.com:587 [SMTP: Failed to connect socket: (code: -1, response: )] 
```

当我尝试发送 SMTP 电子邮件时。我已经尝试了 ssl:// 和 tls:// 都没有成功。

我已经验证我的计算机可以通过使用配置了 SMTP 帐户的 Outlook 建立这样的传出连接，并且它能够使用 TLS 成功发送。

我还使用 phpinfo() 验证了 Web 服务器上启用了 OpenSSL。它显示 PHP 5.3.15，并且有一个显示 OpenSSL 支持的 openssl 部分：已启用

相关代码：

```
if($isSSL)
    $host="tls://$host";

$headers = array ('From' => $from,
    'To' => $to,
    'Subject' => $subject);
$opts=array ('host' => $host,
            'debug'=>true,
           'auth' => true,
           'port'=>$port,
           'username' => $username,
           'password' => $password);
$smtp = Mail::factory('smtp',$opts);

$mail = $smtp->send($to, $headers, $body);

if (PEAR::isError($mail)) {
    echo("<p>" . $mail->getMessage() . "</p>");
} 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T13:00:30.347

`ssl://`应该管用。也请尝试端口 465。

用于`$mail->getUserInfo()`获取更详细的错误消息。

另一个问题来源可能是您的防火墙不允许到该端口的传出连接。

# c# - .net StackFrame.GetFileColumnNumber() 或 GetFileLineNumber() 不返回准确信息

> ID：15935749
> 
> 赞同：0
> 
> 时间：2013-04-10T20:26:53.750
> 
> 标签：c#, reflection

似乎 GetFileColumnNumber() 和 GetFileLineNumber() 作为 StackFrame 的成员实际上并没有给你函数调用的行/列，而是前一个冒号之后的行的第一个字符。例如，如果您的代码看起来像

```
class A {
    A foo() {
        StackTrace stackTrace = new StackTrace(true);
        StackFrame[] stackFrames = stackTrace.GetFrames();

        Console.WriteLine( stackFrames[1].GetFileLineNumber()+":"+
                           stackFrames[1].GetFileColumnNumber());
        return this;
    }
}

A a = new a();
a.foo().  // assume this is line 10, column 4
  foo().
  foo(); 
```

我希望输出是这样的，这是`f`每次`foo`调用的位置

```
10:6
11:6
12:6 
```

但结果却是

```
10:4
10:4
10:4 
```

这是第一个的位置`a`。这与断点的位置是一致的——如果你试图在第二个或第三个 foo 上放置一个断点，它就会出现在第一个 foo 上。

关于如何获得准确的行/列信息的任何想法？我写了一些自我修改的代码，我需要找到正确的文件位置。我一直忽略列号（这是错误的），但要依靠行号才能准确。如果您使用分号，它会起作用，例如，

```
a.foo();
b.foo();
c.foo(); 
```

每次调用 foo 时，ILoffset 都会发生变化......我想知道是否有另一种方法可以将 IL 偏移量映射到源代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:03:40.147

我相信该职位记录在声明级别。

在你的第一个例子中，

```
a.foo().foo().foo(); 
```

是语句，而在第二个示例中，您有三个单独的语句。

# java - 什么时候静态变量可以方便地在 servlet 中进行会话管理？

> ID：15935751
> 
> 赞同：0
> 
> 时间：2013-04-10T20:27:14.593
> 
> 标签：java, variables, static

什么时候`static`变量对会话管理很方便`servlet`？

我一直在寻找这个答案，但我发现的大多数答案主要描述了何时以及为什么不使用`static`变量

所以我想知道在什么情况下使用`static`变量更可取或不是一个坏主意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:30:40.383

通常，除非您使用单例模式，否则您永远不应该将静态变量用于会话管理，因为您拥有希望基于会话而不是在会话内部访问的对象。例如，在进行会话复制时可能会出现这种情况。然而，这些都是极端情况，除非你有充分的理由，否则你应该远离它们。

# git - 我的服务器启动时如何自动执行“git pull”

> ID：15935752
> 
> 赞同：6
> 
> 时间：2013-04-10T20:27:17.047
> 
> 标签：git, ubuntu, amazon-ec2

我正在使用 ec2 实例 @ ubuntu 。从我的 AMI 启动一个新实例后，我试图自动执行“git pull”。repo 目录已经在我的 AMI 中，我只需要更新 repo。

我现在正在做的是将“git pull origin master”放在 rc.local 中......但它不起作用......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:22:31.233

我让它工作..

sudo -u ubuntu -i git --git-dir=/home/ubuntu/blastoff/.git --work-tree=/home/ubuntu/blastoff/ 获取来源 sudo -u ubuntu -i git --git-dir= /home/ubuntu/blastoff/.git --work-tree=/home/ubuntu/blastoff/merge origin/master

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-10T20:56:04.617

`git --git-dir=some/dir/.git pull origin master`应该管用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-16T17:50:11.877

如果您想`git pull`在创建实例（首次启动）时执行此操作，则可以使用[cloud-init](https://cloud-init.io/)。

检查 AWS 文档[将 shell 脚本传递给包含用户数据的实例](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html)

这可以通过使用 ansible / saltstack 等实现自动化，[但](http://docs.ansible.com/)为了[进行](https://docs.saltstack.com)测试，您可以手动上传脚本。在“高级详细信息”的第 3 步“配置实例”中，选择选项作为文件并将脚本放在下面。

[![在此处输入图像描述](https://i.stack.imgur.com/sV0ca.png)](https://i.stack.imgur.com/sV0ca.png)

您可以在那里上传您的自定义脚本：

```
#!/bin/sh

echo "git pull or any other custom commands here" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-16T00:14:13.140

放置代码的正确位置不是`/etc/rc.local/`but `~/.profile`。然后，您可以以登录用户身份运行命令，而无需`sudo`或`su`更改运行命令的用户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-16T17:18:34.830

从[https://stackoverflow.com/a/8880633/659188](https://stackoverflow.com/a/8880633/659188)和您上面的工作答案中记笔记，您可以通过在文件中执行类似的操作将其应用于潜在的多个文件夹`rc.local`（也只拉当前分支而不是始终是主） ：

```
#!/bin/bash -e
# /etc/rc.local

# Ensure folders in array have a trailing slash!

declare -a folders=("/var/www/html/project1/" "/var/www/html/project2/" "/some/other/location/")

# Update to latest in all above folders

for i in "${folders[@]}"
do
        sudo -u ubuntu -i git --git-dir=$i/.git --work-tree=$i fetch origin
        sudo -u ubuntu -i git --git-dir=$i/.git --work-tree=$i pull
done

exit 0 
```

# xml - vmtools jdom 依赖

> ID：15935755
> 
> 赞同：0
> 
> 时间：2013-04-10T20:27:30.173
> 
> 标签：xml, build

我正在尝试在我的机器上运行 vmtools-0.5 [vmtools](http://www.vmsystems.net/vmtools/)。我无法弄清楚 vmtools 需要什么 jdom 版本。

我已经尝试过 jdom 2、jdom 1.1.3 和 jdom 1.1.2。他们都有编译问题。我得到的最接近的是 jdom 1.1.2。

但是，当我尝试使用 jdom 1.1.2 运行 vmtools 时，我看到了这些编译错误

```
C:\apps\dumps\vmtools-0.5\examples>javac -cp C:\apps\dumps\vmtools-0.5\vmtools-0.5.jar;C:\Users\ayusman\Desktop\jdom-1.1.2\build\jdom-1.1.2.jar XmlDiff.java
XmlDiff.java:107: cannot access org.jdom.input.DefaultJDOMFactory
class file for org.jdom.input.DefaultJDOMFactory not found
                        sb.setFactory(new DomFactory());
                                      ^
XmlDiff.java:123: cannot find symbol
symbol  : constructor XMLOutputter(java.lang.String,boolean)
location: class org.jdom.output.XMLOutputter
                        XMLOutputter xmlo = new XMLOutputter("  ", true);
                                            ^
XmlDiff.java:124: cannot find symbol
symbol  : method setTextNormalize(boolean)
location: class org.jdom.output.XMLOutputter
                        xmlo.setTextNormalize(true);
                            ^
3 errors

C:\apps\dumps\vmtools-0.5\examples> 
```

有没有人尝试过运行 vmtools；如果是这样，他们使用的确切 jdom 版本是什么？

解决方案 [[为后代添加：]] 我尝试使用[jdom-b8](http://www.jdom.org/dist/binary/archive/jdom-b8.zip)版本，它编译得很好。如果有人正在寻找解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T20:12:29.960

根据文档，VMTools 是针对 JDom beta 7 构建的。beta 7 和 1.x 版本之间可能存在 API 更改，而 JDom 2 则明显不同。

# android - 一个片段中的两个布局

> ID：15935756
> 
> 赞同：0
> 
> 时间：2013-04-10T20:27:30.377
> 
> 标签：android, android-layout, android-fragments

我在一个中使用两种不同的布局（两个`.xml`文件）时遇到问题`Fragment`。例如，我有`layout1.xml`和`layout2.xml`。`layout1.xml`有“下`Button`一个”，如果用户点击它`Button`，应该消失并出现。我怎样才能做到这一点？`layout1``layout1``layout2`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T20:37:37.837

这是错误的做法。将这两种布局合二为一并使用 ie`ViewFlipoer`或将它们叠加`RelativeLayout`或`FrameLayout`显示/隐藏您需要的布局。或者将您的逻辑分成两个片段

# objective-c - 使用 Firebase 进行 iOS 远程接口镜像的设置或示例

> ID：15935757
> 
> 赞同：1
> 
> 时间：2013-04-10T20:27:30.820
> 
> 标签：objective-c, firebase

好的。我肯定错过了什么。

我试图让两台 iPad 镜像他们的界面，这样当一个用户执行 UISwipeGesture 来推送另一个视图时，它也会被复制到另一台设备上。我实际上希望实时推送视图并在应用程序的两个实例中显示。我一直在审查并使用 Firebase 进行测试项目，但不知道如何解决这个问题。但是，我已经看到使用 Firebase 执行此操作的原生 iOS 应用程序（更不用说 javascript 绘图示例）。

有没有人有任何好的代码示例或者可以指出我正确的方向？

谢谢，道格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T23:54:27.410

Firebase 没有用于执行特定于应用程序的同步（例如接口镜像）的任何特定原语。您要做的是将接口的当前状态作为 JSON 建模到 Firebase 中。因此，随着 UI 的一部分发生变化，您可以将它们保存到 Firebase。然后，您还需要设置补充：当由于 Firebase 的更改而触发事件时，更新 UI。手势和动作之类的东西需要相同类型的建模——将这些项目保存在 Firebase 中（或者，如果这在语义上不容易翻译，则保留动作的副作用；例如，如果滑动导致按钮移动位置，将按钮的位置保存在 Firebase 中。）

具体来说，这是一个保持两个选项卡同步的示例。这是基于默认的 Xcode 项目模板“Tabbled 应用程序”。在其中我们做了几件事：

1.  为选项卡项更改时添加 KVO 观察器
2.  设置镜像以响应来自 Firebase 的更改
3.  实际上将 UI 的新状态保存到 Firebase

```
 #import <Firebase/Firebase.h>

#define kFirebase @"https://mirror.firebaseio-demo.com"

@implementation FAppDelegate

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    UIViewController *viewController1 = [[FFirstViewController alloc] initWithNibName:@"FFirstViewController" bundle:nil];
    UIViewController *viewController2 = [[FSecondViewController alloc] initWithNibName:@"FSecondViewController" bundle:nil];
    self.tabBarController = [[UITabBarController alloc] init];

    // Add KVO observer for when the UI changes so we can eventually synchronize this data to Firebase
    [self.tabBarController.tabBar addObserver:self forKeyPath:@"selectedItem" options:NSKeyValueObservingOptionNew context:nil];
    self.tabBarController.viewControllers = @[viewController1, viewController2];

    // Setup the mirroring of the UI state; when Firebase lets us know the value has been updated, reflect that in the UI
    Firebase* f = [[[Firebase alloc] initWithUrl:kFirebase] childByAppendingPath:@"selectedIndex"];
    [f observeEventType:FEventTypeValue withBlock:^(FDataSnapshot *snapshot) {
      self.tabBarController.selectedIndex = [snapshot.value intValue];
    }];

    self.window.rootViewController = self.tabBarController;
    [self.window makeKeyAndVisible];
    return YES;
}

- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context {
    NSUInteger newIndex = [((UITabBar *)object).items indexOfObject:change[NSKeyValueChangeNewKey]];

    // We've been notified via KVO that the UI has changed, so save the new state to Firebase
    [[[[Firebase alloc] initWithUrl:kFirebase] childByAppendingPath:@"selectedIndex"] setValue:[NSNumber numberWithInt:newIndex]];
}

@end 
```

处理界面镜像时要记住的一些事情：假设一个设备上的用户进行了方向切换 - 您可以轻松地将其保存到 Firebase 但必须在镜像端进行应用程序特定的转换（如果另一个设备选择不旋转他们的设备？）。

# c# - WCF 服务。无法在 IIS7 中托管

> ID：15935760
> 
> 赞同：1
> 
> 时间：2013-04-10T20:27:40.877
> 
> 标签：c#, wcf, iis, iis-7

我有一个非常简单的 WCF 服务，我正在尝试将它托管在我的本地 IIS 中。我一直收到这个错误：

```
HTTP Error 404.0 - Not Found
The resource you are looking for has been removed, had its name changed, or is temporarily unavailable. 
```

我尝试将应用程序池更改为经典，但仍然无法正常工作。我尝试了一堆其他网站，但没有成功。

任何人都可以帮忙吗？

**更新 1：**

我在 bin 文件夹中有我的 dll 和 pdb 文件，并且我有这样的 web.config：

```
<configuration>
    <system.web>
      <compilation debug="false" targetFramework="4.5" />
      <httpRuntime targetFramework="4.5" />
    </system.web>
  <system.serviceModel>
    <serviceHostingEnvironment>
      <serviceActivations>
        <add factory="System.ServiceModel.Activation.ServiceHostFactory" relativeAddress="./HelloWorldService.svc" service="MyWCFServices.HelloWorldService" />
      </serviceActivations>
    </serviceHostingEnvironment>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <serviceMetadata httpGetEnabled="true" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>
</configuration> 
```

然后在 IIS 中添加一个新项目，显示包含 dll 的文件夹的路径。转到此链接时出现错误：`http://mycomputername/HelloWorldService/HelloWorldService.svc.`

**更新 2：**

在我的计算机中，.NET 3.5.1 功能已关闭。我把它打开了。然后我得到了这个错误： ![在此处输入图像描述](https://i.stack.imgur.com/NdgRQ.png) 然后我将应用程序池中的 .net 版本更改为 4.0.30319。这些更改后仍然相同的错误：

```
HTTP Error 404.0 - Not Found
The resource you are looking for has been removed, had its name changed, or is temporarily unavailable. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:26:17.373

根据评论链：

在服务器级别的 IIS、ISAPI 和 CGI​​ 限制中，您需要启用 v4。

如果 v4 不存在，您需要使用 IIS 安装/注册 ASP.NET v4：

```
c:\windows\microsoft.net\framework\v4.0.30319\aspnet_regiis.exe -i 
```

# iphone - 将 uint8_t 密文保存到 DataModel

> ID：15935762
> 
> 赞同：0
> 
> 时间：2013-04-10T20:27:45.610
> 
> 标签：iphone, rsa, public-key-encryption, xcdatamodel

我正在构建一个简单的 iphone (SDK6.1) 应用程序，它加密一些用户的笔记，将其存储到数据库中，当用户输入密码（不需要加密）时，它将解密他的笔记并将它们显示给他。

对于我使用[核心数据](http://developer.apple.com/library/mac/#documentation/cocoa/conceptual/coredata/Articles/cdBasics.html#//apple_ref/doc/uid/TP40001650-TP1)（.xcdatamodel）的数据库。此时的加密文本在数据模型和 Notes.h 文件中被声明为 String，e 它被声明为 NSString。

对于加密，我使用的是来自 CryptoExercise 的苹果示例代码，它运行良好。

问题是，当我尝试将加密文本保存在数据库中然后解密时，我没有得到想要的结果..基本上我得到了一个空字符串。

显然，我正在使用以下代码从 uint8_t 转换为 NSString，因此我可以将其存储到数据模型中，我知道这是我的主要问题。

```
uint8_t *cipherBuffer = NULL;
SecKey *encrypt = [[SecKey alloc]init];
NSString *et = [[NSString alloc]init];

[encrypt generateKeyPairRSA];

// Encrypt the plain text
cipherBuffer = [encrypt Encryption:plainTextField.text];

// Convert uint8_t to NSString
NSMutableData *data = [[NSMutableData alloc]init];
[data appendBytes:cipherBuffer length:strlen((char*)cipherBuffer)+1];
NSString *string = [[NSString alloc]initWithData:data encoding: NSASCIIStringEncoding];

// Save to Data Model
[self.currentNote setEncryptedText:string];
[self.delegate addNewNoteViewControllerDidSave];
// Retrieve encrypted text from database
et = [self.currentNote encryptedText];

// Convert back to uint_8
NSData *someData = [et dataUsingEncoding:NSUTF8StringEncoding];
const void *bytes = [someData bytes];
uint8_t *crypto_data = (uint8_t*)bytes;

// Decrypt Data
[encrypt Decryption:crypto_data]; 
```

正如我之前所说，我知道转换 uint8_t 是这里的主要问题，我想知道哪种方法是正确的？

完全可以使用数据模型，还是我应该去 SQLite？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:56:18.450

您不能`NSString`像这样将任意字节序列转换回来。例如，如果`data`包含单个字节`128`（十六进制`0x80`），则

```
NSString *string = [[NSString alloc] initWithData:data encoding:NSASCIIStringEncoding]; 
```

创建一个带有一个 Unicode 字符 U+0080 的字符串。当您将其转换回`NSData`with

```
NSData *d1 = [string dataUsingEncoding:NSUTF8StringEncoding]; 
```

然后`d1`将包含字节`0xC2 0x80`（这是 U+0080 的 UTF-8）。但

```
NSData *d2 = [string dataUsingEncoding:NSASCIIStringEncoding]; 
```

也不起作用 ( `d2 = nil`)，因为字符串无法转换为 7 位 ASCII。

所以你应该要么

*   将加密数据作为“二进制数据”存储在 Core Data 中，或者
*   将加密数据存储为字符串，但选择不同的转换策略，例如 Base64。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T10:49:19.147

所以只是为了回答这个问题，所以我可以使用代码和一切..

我将数据模型中的 EncryptedText 更改为二进制数据，然后代码如下所示：

```
uint8_t *cipherBuffer = NULL;
SecKey *encrypt = [[SecKey alloc]init];

[encrypt generateKeyPairRSA];

cipherBuffer = [encrypt Encryption:plainTextField.text];

NSMutableData *data = [[NSMutableData alloc]init];
[data appendBytes:cipherBuffer length:strlen((char*)cipherBuffer)+1];

// Save cipher into the Data Model
[self.currentNote setEncryptedText:data];
[self.delegate addNewNoteViewControllerDidSave];

// Retrieve cipher back from Data Model
NSData *etData = [[NSData alloc]init];
etData = [self.currentNote encryptedText];

// Convert back to uint8_t
const void *bytes = [etData bytes];
uint8_t *crypto_data = (uint8_t*)bytes;

// De cypher
[encrypt Decryption:crypto_data]; 
```

# google-maps - Google Maps v3 + Backbone + Marionette：地图第二次渲染失败

> ID：15935764
> 
> 赞同：4
> 
> 时间：2013-04-10T20:27:51.557
> 
> 标签：google-maps, backbone.js, google-maps-api-3, marionette, jsfiddle

我试图通过创建一个视图并将其插入 DOM 来显示地图，它第一次工作正常，但在视图的后续调用中失败，显示一个灰色的空白区域。

**这是问题的JSFiddle：http: [//jsfiddle.net/dyuvH/14/](http://jsfiddle.net/dyuvH/14/)**

当您单击“单击以加载地图”链接时，一切正常，但如果您再次执行此操作，则会失败。

我正在使用以下内容将地图加载到视图中：

```
onRender: function() {
    var mapOptions = {
        center: new google.maps.LatLng(-34.397, 150.644),
        zoom: 8,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    var mapView = new App.MapView();
    var map = new google.maps.Map(mapView.el, mapOptions);
    mapView.render();
    this.ui.mapContainer.html(mapView.el);
} 
```

同样，第一次一切正常，第二次失败。我认为视图会保留地图的某些方面，反之亦然。在这两种情况下，我都使用“新”键盘创建了地图和视图的新实例，所以我不确定出了什么问题。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T03:15:03.887

对 mapView.render() 的调用不是必需的，可以删除或注释掉。这至少会让地图在后续点击时呈现。

您还需要补偿GMaps API v3 中的[问题 1448](https://code.google.com/p/gmaps-api-issues/issues/detail?id=1448)。此代码中的某些内容应该可以解决后续渲染中的偏离中心的地图：

```
 google.maps.event.addListener(map, "idle", function(){
        map.setCenter(mapOptions.center);
        google.maps.event.trigger(map, 'resize');
    }); 
```

作为参考，[更新的 jsFiddle](http://jsfiddle.net/rubyjedi/WTkc9/1)带有上述建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-09T09:43:45.787

我遇到了同样的问题，在阅读[了 Issue1448 的 #19](https://code.google.com/p/gmaps-api-issues/issues/detail?id=1448#c19)之后，我决定使用`onShow`而不是，`onRender`然后它就像一个魅力。这样我就不需要触发任何地图调整大小事件或尝试计算地图的中心。

# android - Android DB 上的多个表 - 没有这样的表

> ID：15935765
> 
> 赞同：1
> 
> 时间：2013-04-10T20:27:53.480
> 
> 标签：android, sqlite, multiple-tables

有一个奇怪的问题，这似乎很常见，但我无法找到合适的解决方案。也许你们可以帮我弄清楚我哪里出错了。

**这是我的通用数据库适配器类**

```
package com.example.mobilebillforecaster;

import android.content.Context;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

public class CommonDBclass {

public static final String DATABASE_NAME = "mbfDB";

public static final int DATABASE_VERSION = 1;

public static final String CREATE_ETI_TABLE =

"CREATE TABLE etisalatdb (_id INTEGER PRIMARY KEY AUTOINCREMENT, "
        + EtiTariffDB.KEY_ROWID + " INTEGER PRIMARY KEY AUTOINCREMENT, "
        + EtiTariffDB.KEY_PACKNAME + " TEXT, " + EtiTariffDB.KEY_PACKRENT
        + " INTEGER, " + EtiTariffDB.KEY_SIMRATE + " INTEGER, "
        + EtiTariffDB.KEY_NATMINSBUN + " INTEGER, "
        + EtiTariffDB.KEY_NATMINSRATE + " INTEGER, "
        + EtiTariffDB.KEY_INTMINSBUN + " INTEGER, "
        + EtiTariffDB.KEY_INTMINSRATE + " INTEGER, "
        + EtiTariffDB.KEY_NATSMSBUN + " INTEGER, "
        + EtiTariffDB.KEY_NATSMSRATE + " INTEGER, "
        + EtiTariffDB.KEY_INTSMSBUN + " INTEGER, "
        + EtiTariffDB.KEY_INTSMSRATE + " INTEGER, "
        + EtiTariffDB.KEY_MMSBUN + " INTEGER, " + EtiTariffDB.KEY_MMSRATE
        + " INTEGER, " + EtiTariffDB.KEY_DATALBUN + " INTEGER, "
        + EtiTariffDB.KEY_DATALRATE + " INTEGER" + ");";

public static final String CREATE_DU_TABLE =

"CREATE TABLE dudatabase(_id INTEGER PRIMARY KEY AUTOINCREMENT, "
        + DuTariffDB.KEY_PACKNAME + " TEXT, " + DuTariffDB.KEY_PACKRENT
        + " INTEGER, " + DuTariffDB.KEY_NATMINSRATE + " INTEGER, "
        + DuTariffDB.KEY_NATMOBRATE + " INTEGER, "
        + DuTariffDB.KEY_INTMINSRATE + " INTEGER, "
        + DuTariffDB.KEY_NATSMSRATE + " INTEGER, "
        + DuTariffDB.KEY_INTSMSRATE + " INTEGER, "
        + DuTariffDB.KEY_DATALBUN + " INTEGER, " + DuTariffDB.KEY_DATALRATE
        + " INTEGER" + ");";

private final Context context;
private DatabaseHelper DBHelper;
private SQLiteDatabase db;

public CommonDBclass(Context ctx) {
    this.context = ctx;
    this.DBHelper = new DatabaseHelper(this.context);
}

private static class DatabaseHelper extends SQLiteOpenHelper {
    DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(CREATE_ETI_TABLE);
        db.execSQL(CREATE_DU_TABLE);

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

    }
}

public CommonDBclass open() throws SQLException {
    this.db = this.DBHelper.getWritableDatabase();

    return this;
}

public void close() {
    this.DBHelper.close();
}

} 
```

**这是我的适配器之一**

```
package com.example.mobilebillforecaster;

import java.util.ArrayList;
import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

public class EtiTariffDB {

public static final String KEY_ROWID = "_id";
public static final String KEY_PACKNAME = "pack_name";
public static final String KEY_PACKRENT = "pack_rent";
public static final String KEY_SIMRATE = "sim_rate";
public static final String KEY_NATMINSBUN = "natmins_bun";
public static final String KEY_NATMINSRATE = "natmins_rate";
public static final String KEY_INTMINSBUN = "intmins_bun";
public static final String KEY_INTMINSRATE = "intmins_rate";
public static final String KEY_NATSMSBUN = "natsms_bun";
public static final String KEY_NATSMSRATE = "natsms_rate";
public static final String KEY_INTSMSBUN = "intsms_bun";
public static final String KEY_INTSMSRATE = "intsms_rate";
public static final String KEY_MMSBUN = "mms_bun";
public static final String KEY_MMSRATE = "mms_rate";
public static final String KEY_DATALBUN = "datal_bun";
public static final String KEY_DATALRATE = "datal_rate";

private static final String DATABASE_TABLE = "etitarifftable";

private DbHelper ourHelper;
private final Context cctext;

private SQLiteDatabase ourDatabase;

private static class DbHelper extends SQLiteOpenHelper {

    DbHelper(Context ourContext) {
        super(ourContext, CommonDBclass.DATABASE_NAME, null,
                CommonDBclass.DATABASE_VERSION);

    }

    @Override
    public void onCreate(SQLiteDatabase db) {

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // TODO Auto-generated method stub

    }

}

public EtiTariffDB(Context ctx) {
    this.cctext = ctx;

}

public EtiTariffDB open() {
    this.ourHelper = new DbHelper(this.cctext);
    this.ourDatabase = this.ourHelper.getWritableDatabase();
    return this;
}

public void close() {
    this.ourHelper.close();
}

public long createEtiTariff(String packname, String packrent,
        String simrent, String natbun, String natrate, String intbundle,
        String intrate, String natsmsbun, String natsmsrate,
        String intsmsbun, String intsmsrate, String mmsbun, String mmsrate,
        String datalbun, String datalrate) {
    ContentValues cv = new ContentValues();
    cv.put(KEY_PACKNAME, packname);
    cv.put(KEY_PACKRENT, packrent);
    cv.put(KEY_SIMRATE, simrent);
    cv.put(KEY_NATMINSBUN, natbun);
    cv.put(KEY_NATMINSRATE, natrate);
    cv.put(KEY_INTMINSBUN, intbundle);
    cv.put(KEY_INTMINSRATE, intrate);
    cv.put(KEY_NATSMSBUN, natsmsbun);
    cv.put(KEY_NATSMSRATE, natsmsrate);
    cv.put(KEY_INTSMSBUN, intsmsbun);
    cv.put(KEY_INTSMSRATE, intsmsrate);
    cv.put(KEY_MMSBUN, mmsbun);
    cv.put(KEY_MMSRATE, mmsrate);
    cv.put(KEY_DATALBUN, datalbun);
    cv.put(KEY_DATALRATE, datalrate);

    return this.ourDatabase.insert(DATABASE_TABLE, null, cv);

} 
```

这是我调用数据库的 java 文件的一部分

```
 EtiTariffDB etisalatDB = new EtiTariffDB(this);

    etisalatDB.open();

    etisalatDB.createEtiTariff(etipackname, etipackrent, etisimrent,
            etinatbun, etinatrate, etiintbundle, etiintrate,
            etinatsmsbundle, etinatsmsrate, etiintsmsbundle,
                            etiintsmsrate,etimmsbundle, etimmsrate, 
                            etidatalocalbundle, etidatalocalrate);

    etisalatDB.close(); 
```

我得到的错误是：

```
04-10 20:17:47.958: E/SQLiteLog(30526): (1) no such table: etitarifftable
04-10 20:17:48.078: E/SQLiteDatabase(30526): Error inserting natmins_rate=0.30 pack_name=Corporate package natsms_bun=200 mms_rate=0.45 mms_bun=- intsms_rate=0.60 natsms_rate=0.18 intsms_bun=- sim_rate=29 intmins_bun=100 datal_rate=0.1 datal_bun=2000 intmins_rate=1.10 natmins_bun=100 pack_rent=249
04-10 20:17:48.078: E/SQLiteDatabase(30526): android.database.sqlite.SQLiteException: no such table: etitarifftable (code 1): , while compiling: INSERT INTO etitarifftable(natmins_rate,pack_name,natsms_bun,mms_rate,mms_bun,intsms_rate,natsms_rate,intsms_bun,sim_rate,intmins_bun,datal_rate,datal_bun,intmins_rate,natmins_bun,pack_rent) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?) 
```

我读过很多帖子，也浏览过很多论坛。我用来创建这个的例子可以在这里找到：

[Android中的多个表SQLite DB适配器？](https://stackoverflow.com/questions/4063510/multiple-table-sqlite-db-adapters-in-android)

我已经检查并重新检查了我的编码。我怀疑我没有在 create 方法上调用 commonDBclass，但我不知道如何。请帮忙。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:52:44.430

你有几个问题我马上就注意到了：

1.  您根本没有字符串来创建名为`etitarifftable`.
2.  你没有执行你的`CREATE TABLE`字符串。
3.  您正在更改 Java 代码，但没有告诉 SQLiteOpenHelper 更新 SQL 模式。
4.  表只能有一个主键

简单的解决方案：

1.  在查询中创建`etitarifftable`或使用适当的表名。
2.  将适当的`execSQL()`语句添加到`DbHelper#onCreate()`.

    ```
    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(CREATE_ETI_TABLE);
        db.execSQL(CREATE_DU_TABLE);
    } 
    ```

3.  `DATABASE_VERSION`将调用的增量`onUpgrade()`。最基本的形式`onUpgrade()`应该是这样的：

    ```
    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        db.execSQL("DROP TABLE IF EXISTS etisalatdb");
        db.execSQL("DROP TABLE IF EXISTS dudatabase");
        onCreate(db);
    } 
    ```

4.  从两个表中删除您的主键声明之一：

    ```
    "CREATE TABLE etisalatdb (EtiTariffDB.KEY_ROWID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + ... 
    ```

最后，我感觉还有更多错误，但您的 LogCat 会引导您找到它们。（另外我不确定为什么你有两个不同的适配器......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:40:54.627

您需要在插入记录之前创建表，您可以通过以下方式执行此操作：

```
class DbHelper  extends SQLiteOpenHelper {
    ...

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL("CREATE TABLE " + DATABASE_TABLE + " {definition} ");
    }

    ...
} 
```

看起来根本不像你的来电`CommonDBclass`。我认为你需要重新思考和重组你做这件事的方式。`EtiTariffDB`不应该是一个“数据库”它是一个表，你应该把它当作一个表。使用 CommonDBclass 获取 EtiTariff 表对象，而不是相反。然后您可以执行以下操作：

```
DatabaseHelper db = new DatabaseHelper();
EtiTariffTable etiTariff = db.getEtiTariffTable(); 
```

# api - 如何让用户退出我的应用程序？

> ID：15935770
> 
> 赞同：1
> 
> 时间：2013-04-10T20:28:01.957
> 
> 标签：api, google-plus

我在我的应用程序的根页面中实现了 Google+ 登录 API。如果用户登录谷歌，它会自动登录用户，然后 API 会自动将他登录到我的应用程序。问题是当用户退出我的应用程序时，他会被重定向到让他重新登录的根页面，因为他仍然登录到谷歌。

你可以在这里看到整个代码：[https ://developers.google.com/+/web/signin/](https://developers.google.com/+/web/signin/)

奇怪的是，他们有“另请参阅，[让用户退出您的应用程序](https://developers.google.com/+/web/signin/#signing_out_the_user)。” 链接，但它坏了:(

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:52:25.103

这类似于这个问题： [使用 Google+ 登录时防止自动登录](https://stackoverflow.com/questions/15484533/preventing-automatic-sign-in-when-using-google-sign-in/15503280#15503280)

您可以使用在用户*登录*您的网站时设置的 cookie。如果用户已登录（由 cookie 的存在表示），则允许用户自动重定向到您的站点。如果用户未登录，请在隐藏按钮并将其重定向到登录体验之前要求用户单击登录按钮。要注销用户，请删除 cookie。

# c# - 从实体框架动态查询实体以关联到主实体

> ID：15935771
> 
> 赞同：1
> 
> 时间：2013-04-10T20:28:11.567
> 
> 标签：c#, entity-framework, reflection, expression-trees, dynamic-queries

我知道标题不是最好的，但这是我真正想要完成的。

我有一个代表 Entity1 及其关联的详细信息视图。我正在捕获键/值对中的属性名称和值。我目前正在使用反射将实体属性设置为非关联的相应值。我怀疑这是最有效的方法，但我一直无法找到使用表达式树的更好方法。所以现在我需要根据那些实体关联的主键来设置Entity1与其对应实体的关联，称它们为Entity2-4。

在迭代Entity1的Properties时，不知道如何构造一个对Entity2-4的动态查询，并将Entity1.association设置为对应的实体。这是我到目前为止的代码：

```
foreach (string k in e.Values.Keys)
{
    if (e.Values[k] != null && !String.IsNullOrEmpty(e.Values[k].ToString()))
    {
        System.Type objectType = Entity1.GetType();
        PropertyInfo[] p = objectType.GetProperties();

        foreach (PropertyInfo pi in p)
        {
            // set Entity1.Property for non associations (works just fine)
            if (pi.Name == k)
            {
                System.Type t = pi.PropertyType;
                pi.SetProperty(e.Values[k].ToString(), Entity1);
                break;
            }
            // when i see pi.Name contain Reference, I know I'm working on an association
            else if (pi.Name.Contains("Reference"))
            {
                // k is in the form of Entity.Property
                var name = pi.Name.Left("Reference");
                var keys = k.Split('.');
                var ent = keys[0];
                var prop = keys[1];
                if (name == ent)
                {
                    // here I need to obtain an instance from the db
                    // ie generate my dynamic query to the Entity with the name
                    // contained within the var "ent"

                    // I tried using reflection and could instantiate the entity 
                    // but it did me no good as I needed the entity from the db

                    var entityInstance = some dynamic query;

                    // here I need to set the association of Entity1 to entityInstance from above
                    // normally I would use reflection, but I'm not sure that would work
                    // since EntityReference is the actual property returned by reflection
                    Entity1.SetAssocation(prop, Entity2);
                    break;
                }
            }
        }
    }
} 
```

**编辑**

我基本上需要构造实体及其关联实体，以便我可以将它们提交到数据上下文。实体 2 到 4 存在于数据库中，我需要查询数据库以获取实例，我可以将它们关联到我正在创建并要提交的新实体 1。

我的基本模型：

**实体1**

```
Entity1.ID
Entity1.Prop1
Entity1.Prop2
Entity1.Prop3
Entity1.Entity2
Entity1.Entity3
Entity1.Entity4 
```

**实体2**

```
Entity2.ID
Entity2.Name 
```

**实体3**

```
Entity3.ID
Entity3.Name 
```

**实体4**

```
Entity4.ID
Entity4.Name 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:56:40.353

我们就如何`metadata`摆脱`DbContext`. 这里有一些链接可以帮助您入门。我将添加一些具体的评论。

[如何以编程方式读取 EF DbContext 元数据？](https://stackoverflow.com/questions/15718301/how-i-can-read-ef-dbcontext-metadata-programmatically/15720297#15720297)

一个简短的摘要（但您应该在那里查看更多信息）：

```
using (var db = new MyDbContext())
{
    var objectContext = ((IObjectContextAdapter)db).ObjectContext;
    var container = objectContext.MetadataWorkspace.GetEntityContainer(objectContext.DefaultContainerName, DataSpace.CSpace);

    var dependents = ((EntitySet)(set)).ForeignKeyDependents;
    var principals = ((EntitySet)(set)).ForeignKeyPrincipals;
    var navigationProperties = ((EntityType)(set.ElementType)).NavigationProperties;

    // and e.g. for many-to-many (there is more for other types)
    ManyToManyReferences = navigationProperties.Where(np =>
        np.FromEndMember.RelationshipMultiplicity == RelationshipMultiplicity.Many &&
        np.ToEndMember.RelationshipMultiplicity == RelationshipMultiplicity.Many)
        .Select(np => Extensions.CreateLambdaExpression<TEntity>(np.Name))
        .ToList();
} 
```

@Goran Obradovic 很好地将我开始的内容总结为一组可重用的查询（我应归功于他：）。

我已经计算出了那里的所有其他类型的信息。这仅适用于`DataSpace.CSpace`（这对您最有用），但也有`DataSpace.SSpace`等 - 更多用于创建 SQL 查询等。我将把大多数链接放在底部。

* * *

**细节：**
在你的情况下，以下可能会有所帮助：（
注意：我不完全确定你在追求什么，但我想在`guess`这里你前进的方向是什么）

```
db.Set<Worker>().Find(1); 
```

`DbSet`是用于访问特定实体 的通用方法。

`Type`如果你需要它是完全动态的，你也可以从 a 构造它，例如......
（我一直想这样做:)

```
MethodInfo setMethod = typeof(DbContext).GetMethod("Set", new Type[]{});
MethodInfo genericSetMethod = setMethod.MakeGenericMethod(new Type[] { typeof(YourEntity) });
var set = genericSetMethod.Invoke(db, new object[] {}); 
```

把你的实体 - 或你的`Type`而不是`typeof(YourEntity)`.

然后，您可以继续并查询例如`Find(id)`- 对于该实体 - 以获取具体值等。

这是动态的——我不确定这是否是你想要的——但我只是把东西扔在这里以备不时之需。

至少我希望这应该让你开始。

* * *

**链接：（**
都是我的帖子 - 有些可能或多或少相关但可能会有所帮助）
[我如何以编程方式读取 EF DbContext 元数据？](https://stackoverflow.com/questions/15718301/how-i-can-read-ef-dbcontext-metadata-programmatically/15720297#15720297)
[如何通过单元测试检查属性标记为在 ORM 模型中计算？](https://stackoverflow.com/questions/15866272/how-check-by-unit-test-that-properties-mark-as-computed-in-orm-model/15867365#15867365)
[获取模型架构以使用不支持](https://stackoverflow.com/questions/15891112/get-model-schema-to-programmatically-create-database-using-a-provider-that-doesn/15891802#15891802)
[EF5 Code First 迁移中的 CreateDatabase 编程数据转换的提供程序以编程方式创建数据库](https://stackoverflow.com/questions/15865767/programmatic-data-transformation-in-ef5-code-first-migration/15869721#15869721)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:16:00.900

因此，我无法动态执行此操作。但这是我的工作解决方案。谁能建议如何动态执行此操作？

```
foreach (string k in e.Values.Keys)
{
    if (e.Values[k] != null && !String.IsNullOrEmpty(e.Values[k].ToString()))
    {
        System.Type objectType = roster.GetType();
        PropertyInfo[] p = objectType.GetProperties();

        foreach (PropertyInfo pi in p)
        {
            if (pi.Name == k)
            {
                System.Type t = pi.PropertyType;
                pi.SetProperty(e.Values[k].ToString(), roster);
                break;
            }
            else if (pi.Name.Contains("Reference"))
            {
                var name = pi.Name.Left("Reference");
                var keys = k.Split('.');
                var entityName = keys[0];
                var prop = keys[1];
                if (name == entityName )
                {
                    var val = e.Values[k].ToString();
                    switch (pi.Name)
                    {
                        case "Entity2Reference":
                            Entity1.Entity2Reference.EntityKey = new EntityKey("MyEntities." + entityName + "s", prop, val);
                            break;

                        case "Entity3Reference":
                            Entity1.Entity3Reference.EntityKey = new EntityKey("MyEntities." + entityName + "s", prop, val);
                            break;

                        case "Entity4Reference":
                            Entity1.Entity4Reference.EntityKey = new EntityKey("MyEntities." + entityName + "s", prop, Int64.Parse(val));
                            break;
                    }
                }
            }
        }
    }
} 
```

# javascript - jQuery函数不适用于文档加载

> ID：15935775
> 
> 赞同：1
> 
> 时间：2013-04-10T20:28:19.723
> 
> 标签：javascript, jquery, document-ready

我有一个 jQuery 函数，通常可以在 Volusion 页面上运行，但由于某种原因现在它不起作用。location.pathname.indexOf 以具有该 URL 的所有页面为目标（站点使用 GET 变量在 SearchResults.asp 页面上进行搜索）。我已经将引用从单打改为双打，我似乎想不出其他任何东西来测试它。有人在这段代码中看到任何语法错误吗？不应该有任何冲突，因为它只运行 jQuery（没有其他类似 MooTools 的东西）。我还尝试在 document.ready 之后发出“测试”警报，但屏幕上没有任何反应。谢谢！

```
<script>
$(document).ready(function() {  
    if (location.pathname.indexOf('/SearchResults.asp') != -1 ) {
        $('div#content_area').css({'display','none !important'});         
    }
});
</script> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-10T20:30:30.293

您有语法错误。

这个：

```
$('div#content_area').css({'display', 'none !important'}); 
```

应该是这样的：

```
$('div#content_area').css({'display': 'none !important'});
//                                  ^
//                                  |
//                                  | look here 
```

* * *

使用[**.css()**](http://api.jquery.com/css/)时，您可以使用 2 种变体。

您可以使用它来更新单个属性，该属性使用`,`分隔 CSS 属性的名称和值，类似于：

```
$('div#content_area').css('display', 'none !important'); 
```

或者您可以使用 jQuery 1.9 中添加的新变体，它允许您一次指定多个样式，从而允许您指定属性值对，类似于：

```
$('div#content_area').css({
    'display': 'none !important',
    'border' : 'solid 1px red'
}); 
```

* * *

**css() 和 !important**

* * *

`.css()`尝试使用and应用样式时似乎存在问题`!important`。有一个很久以前提出的错误：[**Ticket #2066**](http://bugs.jquery.com/ticket/2066)已关闭，并在勾选中显示了替代方案。

它提到，作为替代方案，您可以`cssText`在使用多样式变体时设置与此类似的内容：

```
$('div#content_area').css({
    'cssText': 'display: none !important'
}); 
```

或者在使用单一样式变体时：

```
$('div#content_area').css('cssText', 'display: none !important'); 
```

不过，正如勾选的提到的那样，请注意：

> 您必须小心设置`cssText`，因为它会设置/清除该元素的 css 中的所有内容。

考虑到 的副作用，另一种选择很可能是最安全的`cssText`，它是创建一个单独的 CSS 类并应用它，类似于：

```
.alwaysHide{
    display: none !important;
} 
```

```
$('div#content_area').addClass('alwaysHide'); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-10T20:35:48.000

您正在尝试使用 2 种语法样式。

要么，您需要这样做：

```
<script>
    $(document).ready(function() {  
        if (location.pathname.indexOf('/SearchResults.asp') != -1 ) {
            $('div#content_area').css('display','none !important');         
        }
    });
    </script> 
```

或者你需要使用这个：

```
<script>
    $(document).ready(function() {  
        if (location.pathname.indexOf('/SearchResults.asp') != -1 ) {
            $('div#content_area').css({'display' : 'none !important'});         
        }
    });
    </script> 
```

# php - 从 PHP 流式传输时，html5 / mp4 视频不会在移动浏览器中播放

> ID：15935777
> 
> 赞同：1
> 
> 时间：2013-04-10T20:28:28.427
> 
> 标签：php, mobile, streaming, mp4

我正在尝试在带有 PHP 的移动浏览器上使用 html5 流式传输 mp4 视频。

我正在使用以下课程：

[http://labs.divx.com/node/17030](http://labs.divx.com/node/17030)

该脚本工作正常，除了对 mime_types 数组的引用，我必须删除 $ 才能使其工作。

无论如何，我的问题是这个。当我使用 file.mp4 运行此脚本时，它在我的手机上运行良好。

但是一旦我输入代码以验证是否允许播放文件等（如果客户购买了视频，他们是否超过了允许的观看次数等）

该文件根本不会加载。

不过，它确实会在桌面浏览器中加载。它仅在移动浏览器中不加载。

这是我用来播放文件的代码：

当我这样运行它时，它适用于桌面浏览器，但不适用于移动设备：

```
<?php
apc_clear_cache();
session_start();
require(dirname(__FILE__) . "/../_includes/config.php");
require(dirname(__FILE__) . "/../_includes/validate_session.php");

$id = (int)$_GET['id'];

if (!$result = $mysqli->query('SELECT
orders_item_product_downloadable_videos.id,
orders_item_product_downloadable_videos.current_no_downloads,
DATE_ADD(IF(orders.id IS NOT NULL,orders.date_order,o.date_order),INTERVAL orders_item_product_downloadable_videos.no_days_expire DAY) AS date_expire,
product_downloadable_videos.embed_code,
orders_item_product_downloadable_videos.no_days_expire,
orders_item_product_downloadable_videos.no_downloads,
product_downloadable_videos.filename,
product_downloadable_videos.stream,
product_downloadable_videos.source

FROM 
orders_item_product_downloadable_videos 
LEFT JOIN
(orders_item_product CROSS JOIN orders_item CROSS JOIN orders)
ON
(orders_item_product_downloadable_videos.id_orders_item_product = orders_item_product.id AND orders_item_product.id_orders_item = orders_item.id AND orders_item.id_orders = orders.id)

LEFT JOIN
(orders_item_product AS oip CROSS JOIN orders_item_product AS oip_parent CROSS JOIN orders_item AS oi CROSS JOIN orders AS o)
ON
(orders_item_product_downloadable_videos.id_orders_item_product = oip.id AND oip.id_orders_item_product = oip_parent.id AND oip_parent.id_orders_item = oi.id AND oi.id_orders = o.id)

INNER JOIN 
product_downloadable_videos
ON
(orders_item_product_downloadable_videos.id_product_downloadable_videos = product_downloadable_videos.id)
WHERE
orders_item_product_downloadable_videos.id = "'.$id.'"
AND
(
(orders.id IS NOT NULL AND orders.status IN (1,7) AND orders.id_customer = "'.(int)$_SESSION['customer']['id'].'")
OR
(o.id IS NOT NULL AND o.status IN (1,7) AND o.id_customer = "'.(int)$_SESSION['customer']['id'].'")
)       
LIMIT 1')) throw new Exception('An error occured while trying to get video info.'."\r\n\r\n".$mysqli->mysqli->error);

if (!$result->num_rows) {
//throw new Exception(language('account/order', 'ERROR_DOWNLOAD_EXPIRED'));
exit;   
}       

$row = $result->fetch_assoc();  
$result->free();

if ($row['no_downloads'] > 0 && $row['current_no_downloads'] >= $row['no_downloads']) {
//throw new Exception(language('account/order', 'ERROR_NO_DOWNLOADS_REACHED'));
exit;   
}       

if ($row['no_days_expire'] > 0 && strtotime($row['date_expire']) <= time()) {
//throw new Exception(language('account/order', 'ERROR_DOWNLOAD_EXPIRED'));
exit;               
}

$file = dirname(__FILE__).'/../admin/protected/streaming_videos/'.$row['source'];

require(dirname(__FILE__).'/../_includes/classes/stream.php');

$st = new VSTREAM();
$st->stream(dirname(__FILE__).'/../397d729225599bcda978ac4fd4aaeba2.mp4'); 
```

当我像这样评论和运行它时，它可以在移动浏览器中运行，但为什么呢？

```
<?php
apc_clear_cache();
session_start();
require(dirname(__FILE__) . "/../_includes/config.php");

require(dirname(__FILE__).'/../_includes/classes/stream.php');

$st = new VSTREAM();
$st->stream(dirname(__FILE__).'/../397d729225599bcda978ac4fd4aaeba2.mp4'); 
```

如果我添加validation_session.php 代码，它就不起作用。

```
<?php
apc_clear_cache();
session_start();
require(dirname(__FILE__) . "/../_includes/config.php");
require(dirname(__FILE__) . "/../_includes/validate_session.php");

require(dirname(__FILE__).'/../_includes/classes/stream.php');

$st = new VSTREAM();
$st->stream(dirname(__FILE__).'/../397d729225599bcda978ac4fd4aaeba2.mp4'); 
```

validation_session.php 代码里面只有这个：

```
<?php
if(!$_SESSION['customer']['id']){
    header("Location: /account/login");
    exit;
}
?> 
```

我什至通过使用非工作短代码在屏幕上输出会话来测试会话，我可以看到 $_SESSION['customer']['id'] 确实存在。

所以我不知道我在这里缺少什么。

如果有人知道为什么这不起作用，我将非常感谢您对此的意见！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:15:06.717

除非会话的 UID 在 URL 中传播，否则它会存储在 cookie 中。如果页面在桌面上正常工作并且仅在您不验证会话时在移动设备上工作，则该问题必须与某处的 cookie 相关联。很可能，您的移动浏览器没有保存 cookie，因此在尝试确认会话时会将您踢出。

或者，您可以在 URL 中传递会话 ID：http: [//php.net/manual/en/session.idpassing.php](http://php.net/manual/en/session.idpassing.php)

如果您可以让它与查询字符串中的会话 ID 一起工作，那么您就知道这是一个 cookie 问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T17:14:57.273

好的，结束这个问题，移动播放的主要原因是每台设备的最大分辨率。

而对于windows phone 8设备的问题，我还是一无所知。这似乎是断断续续的，我可以在另一台服务器上播放它，然后通过更改一些代码并稍后将其删除，但现在它似乎可以工作，我不知道为什么，所以我没有触摸它。

# javascript - Javascript 通过 ID 和他的内部值获取元素

> ID：15935779
> 
> 赞同：-1
> 
> 时间：2013-04-10T20:28:38.560
> 
> 标签：javascript, string, getelementbyid

这就是我在 javascript 中所拥有的

```
function xmlhttpPost(strURL,formname,responsediv,responsemsg) {

    var xmlHttpReq = false;

    var self = this;

    // Xhr per Mozilla/Safari/Ie7

    if (window.XMLHttpRequest) {

        self.xmlHttpReq = new XMLHttpRequest();

    }

    // per tutte le altre versioni di IE

    else if (window.ActiveXObject) {

        self.xmlHttpReq = new ActiveXObject("Microsoft.XMLHTTP");

    }

    self.xmlHttpReq.open('POST', strURL, true);

    self.xmlHttpReq.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');

    self.xmlHttpReq.onreadystatechange = function() {

        if (self.xmlHttpReq.readyState == 4) {

            // Quando pronta, visualizzo la risposta del form

            updatepage(self.xmlHttpReq.responseText,responsediv);

        }

        else{

            // In attesa della risposta del form visualizzo il msg di attesa

            updatepage(responsemsg,responsediv);

        }

    }

    self.xmlHttpReq.send(getquerystring(formname));

}

function getquerystring(formname) {

    var qstr = document.getElementById[formname];

    return qstr;

}

function updatepage(str,responsediv){

    document.getElementById(responsediv).innerHTML = str;

} 
```

首先它是为 FORM 值而开发的，很容易我可以在另一个 PHP 文件中传输 POST VALUES 并进行查询，现在我想修改它只是简单地在新文件中传输一个元素的一些值，这将被加载 ajax在另一个元素中进行查询，我在哪里出错以及如何在另一个文件中回显此类的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:30:27.357

您应该使用`()`而不是`[]`进行实际的函数调用（在这种情况下`getElementById`）。此外，如果您想要元素的内容，请使用[`textContent`](https://developer.mozilla.org/en/docs/DOM/Node.textContent)or[`innerHTML`](https://developer.mozilla.org/en-US/docs/DOM/element.innerHTML)属性：

```
function getquerystring(what) {

    var qstr = document.getElementById(what);

    return qstr.innerHTML;

} 
```

是对象或数组中的`[]`属性访问器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:32:25.823

要获取 div 的内容，请返回 innerHTML 属性并更改`[]`为`()`.

```
function getquerystring(what) {
    var qstr = document.getElementById(what).innerHTML;
    return qstr;
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/T8eTZ/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:32:28.910

您需要为函数调用使用括号“()”。此外，您需要`innerText`元素，而不是整个元素。

```
function getquerystring(what) {
    var qstr = document.getElementById(what);
    return qstr.innerText;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T20:32:56.643

如果你想在 div 中获取文本，试试这个：

```
<div id="test">
  Some <span class="foo">sample</span> text.
</div>

function getquerystring(what) {
var node = document.getElementById(what),

var htmlContent = node.innerHTML; // htmlContent would give "Some <span class='foo'>sample</span> text."
var textContent = node.textContent; // textContent would give "Some sample text."
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-10T20:34:03.070

您可以使用以下代码获取 div 之间的文本，供参考[innerHTML](https://developer.mozilla.org/En/DOM%3aelement.innerHTML)，[**DEMO**](http://jsfiddle.net/P2bGc/)

```
function getquerystring(what) {

    var qstr = document.getElementById(what).innerHTML;

    return qstr;

} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-04-10T20:32:26.883

这应该工作

```
function getquerystring(what) {

    var qstr = document.getElementById[what].innerHTML;

    return qstr;

} 
```

# django - Kohana 的类似 syncdb 的工具

> ID：15935780
> 
> 赞同：0
> 
> 时间：2013-04-10T20:28:39.343
> 
> 标签：django, kohana

我以前使用过 Django(python)，现在我正在学习 Kohana (PHP)。看起来不错，但我想知道 Kohana 中是否有类似“django-admin.py syncdb”之类的东西，或者至少是一个可以完成相同工作的工具。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T19:08:17.160

在开始使用数据库之前，Django 模型知道有关其领域的所有信息。相比之下，Kohana 模型只知道表名，并且首先使用 ORM 自动调用 ORM::list_columns() 来执行 sql 查询

```
SHOW FULL COLUMNS FROM `tablename` 
```

并为此模型填充受保护的 $_table_columns 变量

# java - Eclipse - 创建 Dist 目录

> ID：15935785
> 
> 赞同：-1
> 
> 时间：2013-04-10T20:28:46.880
> 
> 标签：java, eclipse, ant

最近由于 TFS 插件，我被迫使用 Eclipse：

我有一些项目要从 Netbeans 转换为 Eclipse 项目。其中一些项目相互引用。在开始转换这些项目后，我很快发现 Eclipse 不想在构建后对项目进行 jar 处理。所以我用了一个`build.xml`并为每个项目创建了一个新的“构建器”（不允许我在多个项目中重用构建器是哪个好主意？）。在我完成所有工作后，我正在坐下来思考如何为部署进行构建，我突然想到 eclipse 不包括构建输出目录中的任何引用程序集。这很糟糕，因为手动创建 lib 文件夹并复制所有需要的 jar 文件将容易出错且耗时。所以这就是问题所在。是否有任何合理的方法可以在 Eclipse 项目上设置构建器或属性，这样当我构建它时，它将创建一个“dist”目录，其中包含 jar 项目类和一个包含所有项目的 lib 文件夹附加到项目的引用的jar？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:58:02.103

> 是否有任何合理的方法可以在 Eclipse 项目上设置构建器或属性，这样当我构建它时，它将创建一个“dist”目录，其中包含 jar 项目类和一个包含所有项目的 lib 文件夹附加到项目的引用的jar？

是的，右键单击项目并选择导出。在搜索框中输入“jar”并选择 Runnable JAR 文件。在导出对话框中，选择“复制所需库...”选项。那里还应该有一个选项可以将此导出保存为 Ant 脚本。

> 我不知道如何使用 ANT 解决依赖项列表

接下来，您应该考虑使用[Ivy](http://ant.apache.org/ivy/)。这将为您的构建脚本添加依赖项管理。这里可能有一些学习曲线，但[这些教程](http://ant.apache.org/ivy/history/2.2.0/tutorial.html)应该会有所帮助。

# deployment - 使用 MODX 时的最佳部署实践是什么？

> ID：15935786
> 
> 赞同：7
> 
> 时间：2013-04-10T20:28:50.957
> 
> 标签：deployment, workflow, modx

当您在本地机器上有开发版本的应用程序时很方便，您可以将其部署在 STAGE 服务器上进行测试（它是可选的），然后将其部署到 PRODUCTION 服务器上。当项目中的代码和数据有很好的自由裁量权时（例如，如果我们将所有代码和设置存储在项目文件中，并将数据存储在数据库中），您可以相对轻松地执行此操作。

MODX 将模板、片段等存储在数据库中。是的，我们可以将此代码移动到静态文件中，然后我们可以使用版本控制系统来跟踪这些项目的更改。但是这些在数据库中也有表示行。这意味着如果我们添加或删除一些项目，我们必须像以前一样更新数据库。

如果我们只是复制扩展的文件而不是通过包管理器进行安装，看起来我们也会遇到一些麻烦（因为扩展通常在 DB 中有自己的表）。

另一个问题是 DEV 和 PROD 上的应用程序在文件（配置）和数据库（例如用户帐户）中存储了不同的设置。

我仍然看不到组织迭代 DEV-STAGE-PROD 开发周期的明确方法。所以，我的问题是：

*   部署时应该（或必须）复制哪些文件和数据库表？
*   我应该用什么模式（替换，忽略）？
*   最简单和最快的方法是什么？

我最关心的是必须处理数据库。

PS如果重要的话，我说的是MODX的“革命”版本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:48:39.350

数据库根本不应该存储任何路径信息，以前的版本在 modx_workspaces 表中做了，但后来消失了[我相信从 2.2.4 开始]。

如果您担心 url 更改 [dev.mysite.com / stage.mysite.com / production...]，请不要担心 - 这一切都在 .htaccess 文件中 [曾经有一个 site_url 系统设置，但是它似乎也消失了。]

您需要担心的唯一文件是 core/config/config.inc.php ~ 创建 3 个具有不同路径的不同文件，或者在迁移时替换它们。

我移动/更新/迁移 modx 站点的过程是：

清除缓存！！tar cvfz httpdocs.tar.gz httpdocs/ mysqldump -u -p the_database > export.sql

移动文件，tar xvfz 并导入数据库。检查 modx_workspaves 表是个好主意，如果您使用过旧版本的图库，请检查一下，但大多数插件和开发人员似乎习惯于不在代码和数据库表中存储路径信息。

当然，如果您已经加强了安装，还有一些步骤，但没什么大不了的。[参见 rtfm.modx.com 上的“强化 Modx 文章]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-20T19:32:47.050

我认为您正在寻找的是这个插件（取决于您的 modx 版本）：

[https://github.com/digitalbutter/MODX-Mirror](https://github.com/digitalbutter/MODX-Mirror)

[https://github.com/digitalbutter/FEM](https://github.com/digitalbutter/FEM)

所有块、片段等都位于磁盘上。对文件所做的任何更改都将触发相应的数据库更改，而无需执行完整的 SQL 导入/重新导入。这将允许任何版本控制系统/分布式开发环境/自动部署。

# optimization - Bamboo 在不同的机器上执行任务

> ID：15935788
> 
> 赞同：0
> 
> 时间：2013-04-10T20:29:02.733
> 
> 标签：optimization, continuous-integration, bamboo

我有几个数据库来测试产品。每个数据库都有两组必须并行运行的任务。对于每个数据库，我运行以下两组任务：

`Install -> Startup -> Test1`

`Install -> Startup -> Test2`

所以我目前有两个安装在一个阶段，两个启动都在一个阶段，两个测试都在一个阶段。这看起来像：

`Install1 and Install2`-> `Startup1 and Startup2`->`Test1 and Test2`

我想在每次测试之后添加另一个任务，即电子邮件。电子邮件只是检查一个共享点站点，以查看我们的所有 Test1 测试是否已完成或 Test2 测试。只有当其中一个或另一个完成时它才会发送电子邮件。电子邮件必须在不同机器上的自己的代理上运行，以免两封相同的电子邮件同时发出。

此外，Test1 需要 1 小时才能完成，Test2 需要约 6 小时才能完成。我想在不等待 test2 的情况下发送 test1 的电子邮件。然后稍后发送 test2 的电子邮件。

我看到以下可能性：

1.  Test1 等待 Test2 完成，然后两封电子邮件都从电子邮件发送机发出。
2.  Test1 拥有自己的 Stage，尝试从电子邮件机器发送电子邮件。然后 Test2 运行并尝试从电子邮件机器发送电子邮件。（注意Test1和Test2顺序执行）
3.  Test1 和 Test2 有自己的阶段，阶段并行执行，Test1 和 Test2 并行执行，但只要测试完成，我就可以从电子邮件机器发送电子邮件

我很想拥有#3，但我认为同时执行阶段是不可能的。其他人能否想出一种方法，让电子邮件在测试完成后立即从另一台机器发出，同时最大限度地缩短时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-14T09:05:55.073

阶段不会并行运行，但 Bamboo 作业可以（有关详细信息，请参阅[Bamboo 工作流是如何组织的？](https://confluence.atlassian.com/display/BAMBOO/Understanding+the+Bamboo+CI+Server#UnderstandingtheBambooCIServer-HowisaBambooworkfloworganised?)）。那么为什么不将这些程序设置为工作呢？此外，在作业要求选项卡中，您可以设置代理运行作业的要求，有效地告诉 Bamboo 在单独/选择的机器上运行任务（有关详细信息，请参阅[配置作业的要求](https://confluence.atlassian.com/display/BAMBOO/Configuring+a+job%27s+requirements)）。

# xml - 解析 epub v3 TOC.xhtml

> ID：15935795
> 
> 赞同：0
> 
> 时间：2013-04-10T20:29:39.333
> 
> 标签：xml, xslt, tableofcontents, epub3

我想用 xslt 解析 epub v3 文件的 TOC.xhtml。到目前为止，在我的 xsl 文件中，我有以下内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:epub="http://www.idpf.org/2007/ops">
    <xsl:template match="/">
        <div id="tocItems">      
            <xsl:apply-templates select="/epub:html/epub:body/epub:nav/epub:ol/epub:li" />
        </div> 
    </xsl:template>

    <xsl:template match="epub:li">
        <br />
        hello
        <button class="option" onclick="parent.loadHREF(this)">                     
            <xsl:attribute name="id">
                <xsl:value-of select="epub:a/@href" />
            </xsl:attribute>
            <xsl:attribute name="name">
                <xsl:value-of select='position()' />
            </xsl:attribute>
            <xsl:value-of select="epub:a" />
        </button>
    </xsl:template>

</xsl:stylesheet> 
```

不幸的是，这没有给出任何输出。这是一个典型的 TOC.xhtml 文件，希望有人能提供帮助。

```
 <?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="tableofcontentsV3.xsl"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta http-equiv="default-style" content="text/html; charset=utf-8"/>
    <title>Contents</title>
    <link rel="stylesheet" href="css/famouspaintings.css" type="text/css"/>
  </head>
  <body>

<nav epub:type="toc"><h2>Contents</h2>
  <ol epub:type="list"><li><a href="s001-Cover-01.xhtml">Cover</a></li>
<li><a href="s002-BookTitlePage-01.xhtml">Famous Paintings</a></li>
<li><a href="s003-Copyright-01.xhtml">Copyright</a></li>
<li><a href="s004-Section-001.xhtml">Explore</a></li>
<li><a href="s005-Section-002.xhtml">Famous Paintings</a></li>
<li><a href="s018-Section-009.xhtml">Colophon</a></li>
</ol></nav></body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:25:47.080

您尝试匹配的元素不在 epub 命名空间中；它们在 xhtml 命名空间中。尝试在 xhtml 命名空间中添加前缀`xsl:stylesheet`并更改路径中的前缀：

```
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xhtml="http://www.w3.org/1999/xhtml"
    xmlns:epub="http://www.idpf.org/2007/ops">
    <xsl:template match="/">
        <div id="tocItems">      
            <xsl:apply-templates select="/xhtml:html/xhtml:body/xhtml:nav/xhtml:ol/xhtml:li" />
        </div> 
    </xsl:template>

    <xsl:template match="xhtml:li">
        <br />
        hello
        <button class="option" onclick="parent.loadHREF(this)">                     
            <xsl:attribute name="id">
                <xsl:value-of select="xhtml:a/@href" />
            </xsl:attribute>
            <xsl:attribute name="name">
                <xsl:value-of select='position()' />
            </xsl:attribute>
            <xsl:value-of select="xhtml:a" />
        </button>
    </xsl:template>

</xsl:stylesheet> 
```

# html - HTML p 换行符（转帖的转帖）

> ID：15935798
> 
> 赞同：0
> 
> 时间：2013-04-10T20:29:52.183
> 
> 标签：html, css, layout

我知道这个问题以前被问过很多次，但从来没有一个答案可以帮助我解决我的情况。

我在它下面有`<p>`一个`<ul>`。段落和列表之间有空格。我不想要这个，但无法摆脱它。

我已经应用了最直接的解决方案，但它在我的页面中不起作用。

这应该是：[http](http://codepen.io/anon/pen/EsFqd) ://codepen.io/anon/pen/EsFqd 这就是我使用与codepen中所示相同的css得到的： ![在此处输入图像描述](https://i.stack.imgur.com/3y5No.png)

谁能帮帮我？

根据要求，HTML：

```
<article id="overzicht"
         style="<% if (browser.contains("Chrome") || browser.contains("MSIE")) {%>margin-right: 45px;<%}%>">
    <header>
        <h2>Overzicht</h2>
    </header>
    <div id="lijsten" data-collapse="persist">
        <p class="open">Groepen</p>
        <ul>
            <% try {
                while (bands.next()) { %>
            <li><%= bands.getString("band_naam") %></li>
            <li><%= bands.getString("pod_omschr") %></li>
            <%  }
               } catch (Exception e) { %>
            <li>Nog geen groepen</li>
            <% }%>
        </ul>
        <p>Campings</p>
        <ul>
            <% try {
                while (campings.next()) { %>
            <li><%= campings.getString("camp_adres") %></li>
            <li><%= campings.getString("camp_cap") %></li>
            <%  }
               } catch (Exception e) { %>
            <li>Nog geen campings</li>
            <% }%>
        </ul>
        <p>Tickets</p>
        <ul>
            <% try {
                while (tickets.next()) { %>
            <li><%= tickets.getString("typ_omschr") %></li>
            <li><%= tickets.getString("typ_prijs") %></li>
            <%  }
               } catch (Exception e) { %>
            <li>Nog geen tickets</li>
            <% }%>
        </ul>
    </div>
</article> 
```

和完整的CSS：

```
article[id="details"] {
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  -webkit-flex: 1;
  -ms-flex: 1;
  text-align: center;
  margin-left: 10px;
  margin-right: 10px;
  padding: 10px;
}
p {
    font-size: 1.2em;
    text-align: center;
    border: 1px solid #cbcbcb;
    border-bottom: none;
    padding: 0;
    margin: 0;
    color: white;
    background-color: green;
}

ul {
    background-color: rgba(255, 255, 200, 0.2);
    height: 150px;
    margin: 0;
    padding: 0;
    overflow-y: scroll;
    list-style: none;
    text-align: left;
    border: 1px solid #cbcbcb;
    border-top: none;
}
li {
    margin-bottom: 5px;
    padding-left: -30px;
    margin-left: -30px;
}
li:nth-child(even) {
    text-align: right;
    padding-right: 5px;
    margin-left: -40px;
    padding-left: -40px;
    border-bottom: 1px solid white;
}
li:last-child {
    border-bottom: none;
}
li:first-child {
    padding-top: 3px;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:37:20.793

如果您实际站点上的 CSS 与 CodePen 中的相同，则听起来您需要重置，或者有冲突的 CSS。

也许尝试添加`margin: 0 !important;`以查看是否可以为您解决问题。如果是这样，可能会应用一些其他样式，这些样式比您的`ul`选择器更具体。

就像其他人所说的那样，查看您的实际 CSS 将使故障排除变得更加容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:41:38.260

您很可能需要使用 CSS 重置。这会将所有默认浏览器（用户代理）html 样式重置为一致的基线。Codepen 最有可能使用这种重置，因此您的代码与他们的不同。

在 CSS 顶部添加 Eric Meyers 重置样式表的 CSS。你可以在这里找到它[http://www.cssreset.com/](http://www.cssreset.com/)。重新加载您的页面，看看它是否删除了间距。

编辑：避免使用 !important 因为它可能会覆盖您应用程序中的其他边距样式。从长远来看，这可能会导致很多头痛。进行 css 重置或找出应用边距的原因，并以不太强大的 css 特异性覆盖该样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:50:56.390

我知道`!important`似乎解决了你的问题。但现在删除它并尝试添加：

```
body, * {
  margin: 0;
  padding: 0;
} 
```

到您的 CSS 文件的顶部，看看是否可以修复它。如果没有，也许可以尝试@mikecan 的答案中提到的 CSS 重置。

# ruby - RubyMine 5.4 中的 JDBC 错误

> ID：15935802
> 
> 赞同：3
> 
> 时间：2013-04-10T20:30:12.357
> 
> 标签：ruby, ruby-on-rails-3, jdbc, odbc, rubymine

我的 ruby​​ mine 5.4 与我的 sqlite3 或 mysql 数据库的连接有问题。

总是出现相同的错误消息：

```
Connection to Rails rails3-bootstrap-devise-cancan-master: development failed: Exception in thread "main" java.lang.ClassNotFoundException: org.sqlite.JDBC
at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Class.java:171)
at com.intellij.persistence.database.console.RemoteJdbcServer.main(RemoteJdbcServer.java:15) 
```

有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-24T14:42:34.430

您需要按照本页中的步骤安装驱动程序

**[https://www.jetbrains.com/help/ruby/8.0/configuring-a-db-data-source.html](https://www.jetbrains.com/help/ruby/8.0/configuring-a-db-data-source.html)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-21T12:16:55.067

我必须使用 IntelliJ“数据源和驱动程序”对话框下载驱动程序。在下面的屏幕截图中，您可以看到蓝色的“显示许可证”，之前是“下载”。单击“下载”后，它可以工作了。

[![数据源和驱动程序 > Sqlite (Xerial)](https://i.stack.imgur.com/Ybzxb.png)](https://i.stack.imgur.com/Ybzxb.png)

我通过单击“数据库”窗格中的“数据源属性”图标（扳手后面的数据库盘）进入“数据源和驱动程序”对话框。

[![数据库窗格中的数据源属性按钮](https://i.stack.imgur.com/8ilzn.png)](https://i.stack.imgur.com/8ilzn.png)

# python - AttributeError：“芹菜”对象没有属性“_config_source”

> ID：15935804
> 
> 赞同：0
> 
> 时间：2013-04-10T20:30:23.897
> 
> 标签：python, python-3.x, celery

我正在使用 linux (fedora) 机器，我想在 python3.3 中使用 celery。当我执行这些命令时：

```
celery -A tasks worker --loglevel=info
celery worker --help 
```

我收到以下错误：

```
 [root@localhost gert]# celery -A tasks worker --loglevel=info
Traceback (most recent call last):
  File "/usr/lib/python3.3/site-packages/celery-3.1.0rc1-py3.3.egg/celery/bin/base.py", line 399, in find_app
    sym = self.symbol_by_name(app)
  File "/usr/lib/python3.3/site-packages/celery-3.1.0rc1-py3.3.egg/celery/bin/base.py", line 418, in symbol_by_name
    return symbol_by_name(name, imp=import_from_cwd)
  File "/usr/lib/python3.3/site-packages/kombu-2.5.9-py3.3.egg/kombu/utils/__init__.py", line 80, in symbol_by_name
    module = imp(module_name, package=package, **kwargs)
  File "/usr/lib/python3.3/site-packages/celery-3.1.0rc1-py3.3.egg/celery/utils/imports.py", line 87, in import_from_cwd
    return imp(module, package=package)
  File "/usr/lib64/python3.3/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1577, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1558, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1525, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 586, in _check_name_wrapper
  File "<frozen importlib._bootstrap>", line 1023, in load_module
  File "<frozen importlib._bootstrap>", line 1004, in load_module
  File "<frozen importlib._bootstrap>", line 562, in module_for_loader_wrapper
  File "<frozen importlib._bootstrap>", line 869, in _load_module
  File "<frozen importlib._bootstrap>", line 313, in _call_with_frames_removed
  File "/home/gert/tasks.py", line 3, in <module>
    celery = Celery('tasks', broker='amqp://guest@localhost//')
  File "/usr/lib/python3.3/site-packages/celery-3.1.0rc1-py3.3.egg/celery/app/base.py", line 131, in __init__
    if self._config_source:
AttributeError: 'Celery' object has no attribute '_config_source'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/bin/celery", line 9, in <module>
    load_entry_point('celery==3.1.0rc1', 'console_scripts', 'celery')()
  File "/usr/lib/python3.3/site-packages/celery-3.1.0rc1-py3.3.egg/celery/__main__.py", line 30, in main
    main()
  File "/usr/lib/python3.3/site-packages/celery-3.1.0rc1-py3.3.egg/celery/bin/celery.py", line 77, in main
    cmd.execute_from_commandline(argv)
  File "/usr/lib/python3.3/site-packages/celery-3.1.0rc1-py3.3.egg/celery/bin/celery.py", line 709, in execute_from_commandline
    super(CeleryCommand, self).execute_from_commandline(argv)))
  File "/usr/lib/python3.3/site-packages/celery-3.1.0rc1-py3.3.egg/celery/bin/base.py", line 260, in execute_from_commandline
    argv = self.setup_app_from_commandline(argv)
  File "/usr/lib/python3.3/site-packages/celery-3.1.0rc1-py3.3.egg/celery/bin/base.py", line 388, in setup_app_from_commandline
    self.app = self.find_app(app)
  File "/usr/lib/python3.3/site-packages/celery-3.1.0rc1-py3.3.egg/celery/bin/base.py", line 402, in find_app
    sym = import_from_cwd(app)
  File "/usr/lib/python3.3/site-packages/celery-3.1.0rc1-py3.3.egg/celery/utils/imports.py", line 87, in import_from_cwd
    return imp(module, package=package)
  File "/usr/lib64/python3.3/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1577, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1558, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1525, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 586, in _check_name_wrapper
  File "<frozen importlib._bootstrap>", line 1023, in load_module
  File "<frozen importlib._bootstrap>", line 1004, in load_module
  File "<frozen importlib._bootstrap>", line 562, in module_for_loader_wrapper
  File "<frozen importlib._bootstrap>", line 869, in _load_module
  File "<frozen importlib._bootstrap>", line 313, in _call_with_frames_removed
  File "/home/gert/tasks.py", line 3, in <module>
    celery = Celery('tasks', broker='amqp://guest@localhost//')
  File "/usr/lib/python3.3/site-packages/celery-3.1.0rc1-py3.3.egg/celery/app/base.py", line 131, in __init__
    if self._config_source:
AttributeError: 'Celery' object has no attribute '_config_source' 
```

我已经安装了所需的包，所以我在 python3.3 中的站点包映射如下所示：

*   celery-3.1.0rc1-py3.3.egg
*   amqp-1.2.0-py3.3
*   anyjson-0.3.3-py3.3.egg
*   台球-3.3.0.0rc1-py3.3.egg
*   分发-0.6.28-py3.3.egg-info
*   易安装.py
*   kombu-2.5.9-py3.3.egg
*   pip-1.2.1-py3.3.egg-info
*   pkg_resources.py
*   pycache（带下划线）
*   python_dateutil-2.0-py3.3.egg
*   pytz-2013b-py3.3.egg
*   安装工具
*   setuptools-0.6c11-py3.3.egg-info
*   网站.py
*   6-1.3.0-py3.3.egg

有谁知道我错过了什么，或者我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T17:29:34.663

正如martijn所说，答案很简单。有人在 github 上对 celery 项目进行了提交，我提取了我以前的版本，现在它可以工作了。当他们修复它时，这个错误应该不是什么大问题。

# bash - bash：如果文件存在？

> ID：15935806
> 
> 赞同：4
> 
> 时间：2013-04-10T20:30:27.240
> 
> 标签：bash, file, loops, wildcard

所以，

```
for f in *.c; do echo "That $f is the best C code I have ever seen"; done 
```

如果没有 c 文件，将很高兴打印

```
That *.c is the best C code I have ever seen 
```

这是不可取的。如果没有 c 文件，是否有一种优雅的方式来修复/表达我想完全跳过循环的事实？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-10T20:33:56.320

设置[`nullglob`](http://www.gnu.org/software/bash/manual/bash.html#index-pathname-expansion)选项。如果没有匹配，则扩展将为空。

```
shopt -s nullglob
for f in *.c; do … 
```

请注意，这是一个特定于 bash 的构造，它不能在 plain 下工作`sh`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:33:46.553

```
n=`ls -1 *.c 2> /dev/null | wc -l`
if [ $n != 0 ]
then
    for f in *.c; do echo "That $f is the best C code I have ever seen"; done
fi 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:40:47.423

在 Bash 中，`shopt -s nullglob`将导致不匹配任何文件的 glob 返回一个空扩展，而不是标识。

对于 POSIX，可能类似于

```
case *.c in '*.c' ) echo no match ;; esac 
```

有一个明显的病态异常，您可能需要单独检查是否有一个匹配的文件，其名称是字面意思`*.c`.

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-04-10T20:32:55.220

尝试：

```
for f in `ls -1 *.c`; do
 echo That $f is the best C code I have ever seen
done 
```

# cashapelayer - 用物理属性扩展 CAShapeLayer（或者有更好的解决方案）？

> ID：15935808
> 
> 赞同：1
> 
> 时间：2013-04-10T20:30:38.117
> 
> 标签：cashapelayer

首先声明，我在 iOS 编程方面完全是 n00b，但有超过 15 年的其他 OOP 经验。到目前为止，我已经对我想要完成的工作进行了广泛的搜索，但还没有给出明确的答案。我正在尝试创建绘制直线的效果（类似于水果忍者切割动作），无论角度如何，它都会在点 a（beginTouch）和 b（endTouch）之间画一条线。通过使用 CAShapeLayer，我可以很容易地实现它。它也非常有用，因为它支持一些我希望能够应用于最终结果行的动画选项。但我还需要一种能够模拟物理行为并产生线条形状的能力，例如弹跳，可能使线条变形以模拟拉伸，并应用某种破坏动画（褪色/破碎装置）。我不确定 CAShapeLayer 是否是实现这种效果的最佳选择，如果它是我下一步扩展它或将它与其他东西结合起来的地方。我知道这不是一个特定的代码示例类型的问题，但专家意见表示赞赏。

干杯

亚历克斯

# matlab - 在 MATLAB 中实现 big int

> ID：15935810
> 
> 赞同：-3
> 
> 时间：2013-04-10T20:30:42.883
> 
> 标签：matlab, int

如果可能，如何在 matlab 中实现 big int？

```
base = 115740200527109164239523414760926155534485715860090261532154107313946218459149402375178179458041461723723231563839316251515439564315555249353831328479173170684416728715378198172203100328308536292821245983596065287318698169565702979765910089654821728828592422299160041156491980943427556153020487552135890973413

exp = 16205962307261760189575459786273943315321167650525279039226402620183364231925409315656258599329538647429058153827986967502066336581939528313657921572960065150727259976179025776971363924442875150959953467637629858540057691397256164559842414074042495886675668598268975047781126857869572720344318367729860654075

mod = 124325339146889384540494091085456630009856882741872806181731279018491820800119460022367403769795008250021191767583423221479185609066059226301250167164084041279837566626881119772675984258163062926954046545485368458404445166682380071370274810671501916789361956272226105723317679562001235501455748016154805420913 
```

这是我需要计算的`modexp(base,exp,mod)`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-10T21:06:17.797

它已经实现，因为您可以使用[vpi](http://www.mathworks.com/matlabcentral/fileexchange/22725-variable-precision-integer-arithmetic)，如在文件交换中找到的那样。

```
base = vpi('115740200527109164239523414760926155534485715860090261532154107313946218459149402375178179458041461723723231563839316251515439564315555249353831328479173170684416728715378198172203100328308536292821245983596065287318698169565702979765910089654821728828592422299160041156491980943427556153020487552135890973413');

expon = vpi('16205962307261760189575459786273943315321167650525279039226402620183364231925409315656258599329538647429058153827986967502066336581939528313657921572960065150727259976179025776971363924442875150959953467637629858540057691397256164559842414074042495886675668598268975047781126857869572720344318367729860654075');

modulus = vpi('124325339146889384540494091085456630009856882741872806181731279018491820800119460022367403769795008250021191767583423221479185609066059226301250167164084041279837566626881119772675984258163062926954046545485368458404445166682380071370274810671501916789361956272226105723317679562001235501455748016154805420913');

powermod(base,expon,modulus)
ans =
96688554274778609934477562662404606264395384510288145077254270650448790387722984014247388006652841434990300433933136603474993407330696644666217689882824803664362981750613122185159564556754728021340332299439811221240883496369370843657919287413245488923703097829207075814277190552896301852217610348268590146354 
```

或者，您可以自己编写。没那么难，就是比较费时间。

顺便说一句，使用像 exp 和 mod 这样的变量名是一个可怕的想法。学习不要在 MATLAB 中使用同名变量重载有价值的函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-10T21:25:39.693

额外功能的首选位置通常是[Java API](http://docs.oracle.com/javase/6/docs/api/)。

例如，您可以在 Matlab 中使用 BigInteger java 类，如下所示：

```
baseValue = java.math.BigInteger('115740200527109164239523414760926155534485715860090261532154107313946218459149402375178179458041461723723231563839316251515439564315555249353831328479173170684416728715378198172203100328308536292821245983596065287318698169565702979765910089654821728828592422299160041156491980943427556153020487552135890973413')
expValue  = java.math.BigInteger('16205962307261760189575459786273943315321167650525279039226402620183364231925409315656258599329538647429058153827986967502066336581939528313657921572960065150727259976179025776971363924442875150959953467637629858540057691397256164559842414074042495886675668598268975047781126857869572720344318367729860654075')
modValue  = java.math.BigInteger('124325339146889384540494091085456630009856882741872806181731279018491820800119460022367403769795008250021191767583423221479185609066059226301250167164084041279837566626881119772675984258163062926954046545485368458404445166682380071370274810671501916789361956272226105723317679562001235501455748016154805420913')

result    = baseValue.modPow(expValue, modValue) 
```

回报：

```
result =
96688554274778609934477562662404606264395384510288145077254270650448790387722984014247388006652841434990300433933136603474993407330696644666217689882824803664362981750613122185159564556754728021340332299439811221240883496369370843657919287413245488923703097829207075814277190552896301852217610348268590146354 
```

# delphi - 为什么 Indy Project HttpClient Get() 在某些在 Web 浏览器中运行良好的 URL 上给出代码 500？

> ID：15935811
> 
> 赞同：6
> 
> 时间：2013-04-10T20:30:45.670
> 
> 标签：delphi, indy

我有几个在所有浏览器中都可以正常工作的 URL，但是如果我尝试使用 Indy Http 客户端的 Get() 获取页面内容，它会返回错误代码 500，内部服务器错误。这是最新的 Indy SVN 版本 (4981)。

这是我的示例代码。为此需要的只是带有 Indy 组件的 Delphi 以及带有按钮和备忘录的表单。

```
procedure TForm1.Button1Click(Sender: TObject);
var HTTPCLIENT1: TIdHTTP;
begin
  try
   try
     HTTPCLIENT1 := TIdHTTP.Create(nil);
     Memo1.Clear;
     with HTTPCLIENT1 do
     begin
          HandleRedirects := True;
          Request.UserAgent := 'Mozilla/5.0 (X11; U; Linux i586; en-US; rv:1.7.3) Gecko/20040924 Epiphany/1.4.4 (Ubuntu)';
          Memo1.Text := Get('http://www.laredoute.fr/vente-machine-a-coudre-bernette-20-kit-couture--garantie-2-ans.aspx?productid=401225048&documentid=999999&categoryid=22918417&customertarget=0&offertype=0&prodcolor=1#pos=33_n_n_n_n_n_n&numberpage=2');
          Caption := ResponseText;
     end;
   except
     On e: Exception do
     begin
          Memo1.Lines.Add('Exception: '+e.Message);
     end;
   end;
  finally
     HTTPCLIENT1.Free;
  end;
end; 
```

这不是我这边的连接问题，因为 99% 的 URL 返回 200 或 404，只有少数返回 500，但每个浏览器都会在一秒钟内打开它们。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-10T20:55:16.340

这种失败通常表明`GET`请求以某种方式格式错误，导致服务器代码最终失败。但是，如果没有看到 Webbrowser 请求与 TIdHTTP 的请求相比实际上是什么样子，就无法确定服务器不喜欢什么。

**更新**：我看到发生的事情是，当网络浏览器请求 URL 时，服务器立即发回 200 响应，但是当 TIdHTTP 请求 URL 时，服务器发送 301 重定向到新 URL，然后发送 302 重定向到TIdHTTP 请求该 URL 时的错误页面，然后当 TIdHTTP 请求该 URL 时发送 500 响应。

webbrowser 请求和会影响 webserver 的初始 TIdHTTP 请求之间的两个区别是：

1.  您使用 TIdHTTP 请求的 URL 在末尾包含一个锚标记（`#`字符 -之后的所有内容`#pos=33_n_n_n_n_n_n&numberpage=2`），网络浏览器通常会删除该标记。锚点实际上不是 URL 的一部分。它们旨在供网络浏览器在从 URL 检索的数据中定位点时使用。

2.  用户代理。一些 web 服务器对不同的用户代理很敏感，并且可以向不同类型的用户代理发送不同的响应。

当我从 URL 中删除锚点时， TIdHTTP.Get() 不再崩溃：

```
Memo1.Text := Get('http://www.laredoute.fr/vente-machine-a-coudre-bernette-20-kit-couture--garantie-2-ans.aspx?productid=401225048&documentid=999999&categoryid=22918417&customertarget=0&offertype=0&prodcolor=1'); 
```

# ruby-on-rails - 从 Rails 的 JSON 响应中寻找用于 Angular 中通用错误处理的范例

> ID：15935814
> 
> 赞同：13
> 
> 时间：2013-04-10T20:31:06.940
> 
> 标签：ruby-on-rails, json, api, error-handling, angularjs

我正在构建一个应用程序，它被构建为 Rails 服务器应用程序，为客户端提供 RESTful api。Rails 服务器使用 RABL。客户端是执行标准 $http 调用（gets、puts 等）的 Angular JS 客户端。

有时，我的 Rails 服务器会产生错误（假设附加到对象的验证错误）甚至没有错误，在这种情况下我想向用户显示一些东西 - 要么是错误，例如，“记录没有保存，因为...... " 或 "记录已成功更新"。

我试图在 Rails 端和 Angular/客户端都绘制出一个模式来处理这个问题。

至于导轨：

*   我当然可以在每个 RABL 文件中传回一个节点以包含错误数组
*   我还可以通过在返回前签入控制器来返回不同的 RABL
*   [大多数人建议按照此处](https://stackoverflow.com/questions/942951/rest-api-error-return-good-practices)使用http代码（这是有道理的） （尽管对于验证错误之类的代码似乎没有一致的用法）。

至于角：

*   我想我可以编写一个[响应拦截器](http://docs.angularjs.org/api/ng.$http)，但不确定如何完全清除它。

我想我希望我不必在这里重新发明轮子，有人可以指出我当前使用和建议（和本地化）的模式。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-11T21:20:45.960

我继续执行我认为需要做的事情。感谢[digger69 对此](https://stackoverflow.com/users/600299/digger69)的帮助。

在 Rails 方面，我使用了 http 状态码。根据[这里，](https://stackoverflow.com/questions/3290182/rest-http-status-codes)我同意使用 400 http 状态代码进行错误验证。

在我的控制器中，我现在有以下内容：

```
def create
  my_obj = MyObj.build_with_params(params)
  if my_obj.save
    respond_with(my_obj) # regular RABL response
  else
    respond_with_errors(my_obj.errors)
  end
end 
```

在我的 application_controller.rb 我定义了一个通用方法 respond_with_errors

```
# respond back to the client an http 400 status plus the errors array
def respond_with_errors(errors)
  render :json => {:errors => errors}, :status => :bad_request
end 
```

[请注意，已根据此处](http://www.codyfauser.com/2008/7/4/rails-http-status-code-to-symbol-mapping)为 Rails 定义了 :bad_request 符号

在客户端，我需要拦截 http 调用（不仅用于验证，还用于身份验证失败（可能更多）。这是我在 Angular 中的代码示例（感谢[这篇文章](https://stackoverflow.com/questions/11971213/error-401-handling-with-angularjs)的帮助）：

```
var interceptor = ['$rootScope', '$q', function (scope, $q) {
  function success(response) {
    return response;
  }
  function error(response) {
    var status = response.status;

    if (status == 401) { // unauthorized - redirect to login again
      window.location = "/";
    } else if (status == 400) { // validation error display errors
      alert(JSON.stringify(response.data.errors)); // here really we need to format this but just showing as alert.
    } else {
      // otherwise reject other status codes
      return $q.reject(response);
    }
  }
  return function (promise) {
    return promise.then(success, error);
  }
}];
$httpProvider.responseInterceptors.push(interceptor); 
```

我现在可以与我的 rails 代码保持一致，并处理客户端上 http 调用的成功返回。我确定我还有更多工作要做，但我认为这提供了一个本地化的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T21:00:25.793

使用 HTTP 响应拦截器。我目前在应用程序中成功使用它。

[http://docs.angularjs.org/api/ng.$http](http://docs.angularjs.org/api/ng.%24http)

从文档中：

```
$provide.factory('myHttpInterceptor', function($q, dependency1, dependency2) {
  return function(promise) {
    return promise.then(function(response) {
      // do something on success
    }, function(response) {
      // do something on error
      if (canRecover(response)) {
        return responseOrNewPromise
      }
      return $q.reject(response);
    });
  }
});

$httpProvider.responseInterceptors.push('myHttpInterceptor'); 
```

在我的例子中，我创建了一个反馈服务，它在全局范围内显示成功或错误消息。另一种选择是在 rootscope 上广播响应。

# ruby - 了解 Rails 3 中的 Ajax

> ID：15935815
> 
> 赞同：1
> 
> 时间：2013-04-10T20:31:11.313
> 
> 标签：ruby, ajax, ruby-on-rails-3, jquery

我以为我在一定程度上理解了 Rails 3 中的 Ajax，但我认为我在某个地方混淆了自己或误解了某些东西。我的理解是，如果我想在同一页面上调用不同的内容，那么我会为该特定操作创建一个 js.erb 文件。例如，如果我有一个 tynewyddnews 的操作，我将有一个 tynewyddnews 视图和一个 tynewyddnews.js.erb 文件。

然后，我创建一个要在该页面上呈现的部分，并在我的 .js.erb 文件中调用该部分。

例子

看法

```
<% @tynewyddpost.each do |t| %>
  <li>
    <% single = t.photos.first %>
    <a class="photo" href="#"><%= image_tag(single.avatar.url(:thumbnail_news_images)) %></a>
    <p><%= link_to t.title, tynewyddnews_path(:type => 'tynewyddnews'), :post_id => t.id, :remote => true %></p>
    <p class="date"><%= date_output(t.published_on) %></p>
  </li> 
 <% end %>

    <div class="post-item">
  <h2><%= @tynewyddpostlatest.title %></h2>
   <div id="work-samples"> 
    <% for photo in @tynewyddpostlatest.photos %>
     <%= image_tag(photo.avatar.url(:news_images), :class => 'work-sample') %>
   <% end %>
   </div>  
    <p class="post-description"><%= @tynewyddpostlatest.comments.html_safe %></p><a class="post-more" href="#">Continue Reading&nbsp;&raquo;</a>
    <div class="post-item-panel">
     <ul>
      <li class="date">
       <p><%= date_output(@tynewyddpostlatest.published_on) %></p>
     </li>
    </ul>
   </div>
  </div> 
```

所以历史帖子在左侧，最新帖子在中间

.js.erb

```
<% if params[:type] == 'tynewyddnews' %>
   jQuery('.post-item').html('<%= escape_javascript(render partial: 'tynewyddnewspost') %>');
<% end %> 
```

部分的

```
<div class="post-item">
 <h2><%= @tynewyddpost.title %></h2>
  <div id="work-samples"> 
   <% for photo in @tynewyddpost.photos %>
    <%= image_tag(photo.avatar.url(:news_images), :class => 'work-sample') %>
   <% end %>
  </div>  
  <p class="post-description"><%= @tynewyddpost.comments.html_safe %></p>
   <div class="post-item-panel">
      <ul>
       <li class="date">
        <p><%= date_output(@tynewyddpost.published_on) %></p>
       </li>
      </ul>
  </div>
</div> 
```

控制器

```
def tynewyddnews
tynewyddpost = Post.tynewydd_posts.find(params[:post_id])
tynewyddpost.shift
@tynewyddpost = tynewyddpost
@tynewyddpostlatest = Post.tynewydd_posts.first
end 
```

tynewydd_posts 是一个范围

```
scope :tynewydd_posts, :include => :department, :conditions => {"departments.name" => "Ty Newydd"}, :order => "posts.published_on DESC" 
```

所以我目前的问题是当我尝试渲染页面时出现错误

```
Couldn't find Post without an ID 
```

为长篇道歉，但如果有人能指出我正确的方向，那就太好了

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:46:24.053

在我看来你做错了，对不起。它不需要那么复杂。我会用一个更简单的例子从头开始，然后从那里开始构建。

我会在浏览器控制台中执行类似的`rails g scaffold post title:string`操作，然后执行此操作：

```
$.ajax({
  url: "/posts/index"
}).done(function() {
  console.log("done");
}); 
```

您应该能够看到通过浏览器控制台返回的数据。在 Rails 方面，这些数据来自这里：

```
class PostsController < ApplicationController
  def index
    @posts = Post.all
    # there might be more stuff here
  end
end 
```

希望你明白我在说什么。如果你不这样做，我建议在尝试将两者结合起来之前，*分别*学习更多关于 Rails 和 jQuery/ajax 的知识。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T08:54:24.320

好的，所以看来我的问题是我调用帖子 id 的方式，并且我还将我的 ajax 调用移动到一个单独的操作中，设置所有复杂的都是正确的。

我改变了什么

```
<%= link_to t.title, tynewyddnews_path(:type => 'tynewyddnews'), :post_id => t.id, :remote => true %> 
```

改为

```
<%= link_to t.title, my_path_path(:type => 'tynewyddnews', :id => t.id), :remote => true %> 
```

控制器

我添加了一个新操作来处理 ajax 调用，通过 id 查找帖子

```
def my_path
  @tynewyddpost = Post.find(params[:id])
end 
```

然后在我的部分中，我可以使用 @tynewyddpost 实例变量

希望这对其他人有帮助

# javascript - 文本框的气球工具提示

> ID：15935821
> 
> 赞同：0
> 
> 时间：2013-04-10T20:31:30.567
> 
> 标签：javascript

我正在寻找一种方法来添加气球提示以在每次单击文本框时弹出并在几秒钟后消失。我在网上搜索过，但没有找到任何文本框。我的文本框代码如下：请帮助

```
<td><form:input type='text' id='recipient'
 path="receiverLastName" onkeyup="valid(this)" onblur="valid(this)"/></td> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:36:03.807

试试 jQuery UI - 工具提示：http: [//jqueryui.com/tooltip](http://jqueryui.com/tooltip)

你会将你的 html 更改为

```
<td><form:input type='text' id='recipient' title='tool tip to show'
 path="receiverLastName" onkeyup="valid(this)" onblur="valid(this)"/></td> 
```

并将其放入您的 javascript 中（在包含 jquery UI 文件之后）

```
$(function() {
    $("#recipient").tooltip();
}); 
```

# html - 如何垂直显示范围输入滑块

> ID：15935837
> 
> 赞同：102
> 
> 时间：2013-04-10T20:32:22.640
> 
> 标签：html, css

我想`<input type="range" />`垂直显示一个滑块控件。我只关心支持范围滑块控件的浏览器。

我发现一些评论和参考似乎表明将高度设置为大于宽度会导致浏览器自动更改方向，但在我的测试中，这仅~~适用于曾经在 Opera~~中工作的 Opera，但现在不再适用。如何垂直定位 HTML5 范围滑块？

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2013-04-10T20:32:22.640

首先，设置高度大于宽度。从理论上讲，这就是您所需要的。[HTML5 规范提出了同样的](http://www.w3.org/TR/html5/forms.html#range-state-(type=range))建议：

> ... UA 根据样式表指定的高度和宽度属性的比率确定控件的方向。

Opera 以这种方式实现了它，但 Opera 现在使用~~WebKit~~ [Blink](http://en.wikipedia.org/wiki/Blink_(layout_engine))。截至今天，没有浏览器实现仅基于高度大于宽度的垂直滑块。现在[WHATWG 正在审查该建议](https://github.com/whatwg/html/issues/4177)。

无论如何，需要设置高度大于宽度才能在浏览器之间获得正确的布局。应用左右填充也有助于布局和定位。

对于 Chrome，请使用`-webkit-appearance: slider-vertical`.

对于 IE，使用`writing-mode: bt-lr`.

对于 Firefox，`orient="vertical"`向 html 添加一个属性。可惜他们这样做了。视觉样式应该通过 CSS 而不是 HTML 来控制。

```
input[type=range][orient=vertical]
{
    writing-mode: bt-lr; /* IE */
    -webkit-appearance: slider-vertical; /* Chromium */
    width: 8px;
    height: 175px;
    padding: 0 5px;
}
```

```
<input type="range" orient="vertical" />
```

* * *

## 免责声明：

此解决方案基于尚未定义或未最终确定的 CSS 属性的当前浏览器 *实现*。如果您打算在您的代码中使用它，请**准备好**随着更新的浏览器版本的发布和 WHATWG 建议的完成而进行代码调整。订阅[此 github 问题](https://github.com/whatwg/html/issues/4177)以在他们最终决定使用 CSS 属性来正式控制幻灯片方向时获取更新。

[MDN 包含](https://developer.mozilla.org/en-US/docs/CSS/-moz-appearance?redirectlocale=en-US&redirectslug=CSS%2F-webkit-appearance)有关在网络上使用的警告`-webkit-appearance`：

> **注意：**如果你想在网站上使用这个属性，你应该非常仔细地测试它。尽管大多数现代浏览器都支持它，但它的实现各不相同。在较旧的浏览器中，即使是关键字`none`对不同浏览器的所有表单元素都没有相同的效果，有些根本不支持。最新浏览器中的差异较小。

尽管有这些警告，但这个答案现在已经有将近 9 年的历史了，而且建议基本上保持不变。

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2014-11-24T15:49:54.360

您可以使用 css 转换来做到这一点，但要小心容器的高度/宽度。此外，您可能需要将其放置在较低的位置：

```
input[type="range"] {
   position: absolute;
   top: 40%;
   transform: rotate(270deg);
}
```

```
<input type="range"/>
```

* * *

或等效的 3d 变换：

```
input[type="range"] {
   transform: rotateZ(270deg);
} 
```

您还可以使用它来切换幻灯片的方向，分别将其设置为水平或垂直的 180 度或 90 度。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2015-04-27T06:33:01.553

在不将位置更改为绝对位置的情况下，请参见下文。这也支持所有最近的浏览器。

```
.vranger {
  margin-top: 50px;
   transform: rotate(270deg);
  -moz-transform: rotate(270deg); /*do same for other browsers if required*/
}
```

```
<input type="range" class="vranger"/>
```

对于非常旧的浏览器，您可以使用`-sand-transform: rotate(10deg);`CSS[砂纸](http://www.useragentman.com/blog/csssandpaper-a-css3-javascript-library/)

或使用

前缀选择器，例如`-ms-transform: rotate(270deg);`IE9

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-10-11T17:48:20.817

```
.container {
    border: 3px solid #eee;
    margin: 10px;
    padding: 10px;
    float: left;
    text-align: center;
    max-width: 20%
}

input[type=range].range {
    cursor: pointer;
    width: 100px !important;
    -webkit-appearance: none;
    z-index: 200;
    width: 50px;
    border: 1px solid #e6e6e6;
    background-color: #e6e6e6;
    background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#e6e6e6), to(#d2d2d2));
    background-image: -webkit-linear-gradient(right, #e6e6e6, #d2d2d2);
    background-image: -moz-linear-gradient(right, #e6e6e6, #d2d2d2);
    background-image: -ms-linear-gradient(right, #e6e6e6, #d2d2d2);
    background-image: -o-linear-gradient(right, #e6e6e6, #d2d2d2)
}

input[type=range].range:focus {
    border: 0 !important;
    outline: 0 !important
}

input[type=range].range::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 10px;
    height: 10px;
    background-color: #555;
    background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#4ddbff), to(#0cf));
    background-image: -webkit-linear-gradient(right, #4ddbff, #0cf);
    background-image: -moz-linear-gradient(right, #4ddbff, #0cf);
    background-image: -ms-linear-gradient(right, #4ddbff, #0cf);
    background-image: -o-linear-gradient(right, #4ddbff, #0cf)
}

input[type=range].round {
    -webkit-border-radius: 20px;
    -moz-border-radius: 20px;
    border-radius: 20px
}

input[type=range].round::-webkit-slider-thumb {
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    -o-border-radius: 5px
}

.vertical-lowest-first {
    -webkit-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
    transform: rotate(90deg)
}

.vertical-heighest-first {
    -webkit-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
    transform: rotate(270deg)
}
```

```
<div class="container" style="margin-left: 0px">
    <br><br>
    <input class="range vertical-lowest-first" type="range" min="0" max="1" step="0.1" value="1">
    <br><br><br>
</div>

<div class="container">
    <br><br>
    <input class="range vertical-heighest-first" type="range" min="0" max="1" step="0.1" value="1">
    <br><br><br>
</div>

<div class="container">
    <br><br>
    <input class="range vertical-lowest-first round" type="range" min="0" max="1" step="0.1" value="1">
    <br><br><br>
</div>

<div class="container" style="margin-right: 0px">
    <br><br>
    <input class="range vertical-heighest-first round" type="range" min="0" max="1" step="0.1" value="1">
    <br><br><br>
</div>
```

来源：[http ://twiggle-web-design.com/tutorials/Custom-Vertical-Input-Range-CSS3.html](http://twiggle-web-design.com/tutorials/Custom-Vertical-Input-Range-CSS3.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-06-29T05:49:50.777

它非常简单。我已经使用 实现了`-webkit-appearance: slider-vertical`，它在 chrome、Firefox、Edge 中工作

```
<input type="range"> 
```

```
input[type=range]{
    writing-mode: bt-lr; /* IE */
    -webkit-appearance: slider-vertical; /* WebKit */
    width: 50px;
    height: 200px;
    padding: 0 24px;
    outline: none;
    background:transparent;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-02-12T06:03:51.440

```
window.onload = function(){
var slider = document.getElementById("sss");
 var  result = document.getElementById("final");
slider.oninput = function(){
    result.innerHTML = slider.value ;
}
}
```

```
.slider{
    width: 100vw;
    height: 100vh;

    display: flex;
    justify-content: center;
    align-items: center;
}

.slider .container-slider{
    width: 600px;
    display: flex;
    justify-content: center;
    align-items: center;
    transform: rotate(90deg)
}

.slider .container-slider input[type="range"]{
    width: 60%;
    -webkit-appearance: none;
    background-color: blue;
    height: 7px;
    border-radius: 5px;;
    outline: none;
    margin: 0 20px

}

.slider .container-slider input[type="range"]::-webkit-slider-thumb{
    -webkit-appearance: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: red;
}

.slider .container-slider input[type="range"]::-webkit-slider-thumb:hover{

box-shadow: 0px 0px 10px rgba(255,255,255,.3),
            0px 0px 15px rgba(255,255,255,.4),
            0px 0px 20px rgba(255,255,255,.5),
            0px 0px 25px rgba(255,255,255,.6),
            0px 0px 30px rgba(255,255,255,.7)

}

.slider .container-slider .val {
    width: 60px;
    height: 40px;
    background-color: #ACB6E5;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: consolas;
    font-weight: 700;
    font-size: 20px;
    letter-spacing: 1.3px;
    transform: rotate(-90deg)
}

.slider .container-slider .val::before{
    content: "";
    position: absolute;
    width: 0;
    height: 0;
    display: block;
    border: 20px solid transparent;
    border-bottom-color: #ACB6E5;
    top: -30px;
}
```

```
<div class="slider">
  <div class="container-slider">
    <input type="range" min="0" max="100" step="1" value="" id="sss">
    <div class="val" id="final">0</div>
  </div>
</div>
```

# string - bash替换多个不同的字符串字符

> ID：15935842
> 
> 赞同：2
> 
> 时间：2013-04-10T20:32:30.593
> 
> 标签：string, bash, character

无论如何，将这两个简化为一个：

```
temp=${i//[/\\[}
temp=${temp//]/\\]} 
```

输入：

```
i[1]
i[2] 
```

输出：

```
i\[1\]
i\[2\] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T23:58:06.407

```
sed 's/[][]/\\&/g' foo.txt 
```

*   在每一行中寻找`[`或`]`
*   放在`\`每次出现之前

# cocoa - NSView 中的自动布局 NSImageView - 缩放大小。以编程方式设置 NSLayoutConstraint

> ID：15935851
> 
> 赞同：4
> 
> 时间：2013-04-10T20:33:20.277
> 
> 标签：cocoa, autolayout, nslayoutconstraint

我在 IB 中设置的 NSView 中有一个 NSImageView。NSImageView 的大小与 NSView 完全相同。

一切正常，调整窗口大小时 NSImageView 的大小与 NSView 相同。

但是，现在我已经向 NSImageView 添加了一个动画（从 A 移动到 B），这会弄乱在 IB 中设置的约束。所以我必须以编程方式执行此操作。

如何以编程方式设置 NSLayoutConstraint 以使我的 NSImageView 具有与我的 NSImageView （超级视图）相同的大小？

更新：

只是为了给你们一些更多的信息。我的应用程序使用拆分视图（三个视图），而不是在 IB 中添加 NSImageView，我现在以编程方式添加它。我将我的新视图（应可扩展到它的父视图）添加到拆分视图中的第三个视图。

您认为拆分视图会导致这些问题吗？

**更新 2：**

好的，我更接近解决这个问题。我从视图中删除了 NSImageView，并添加了一个 NSView。NSView 缩放得很好，但是一旦我添加了 NSImageView 它就停止工作，因为调整窗口大小后 NSImageView 不会缩放。

**换句话说，问题出在 NSImageView 本身。调整窗口大小后它不会缩放...**

**解决了**

我通过使用 PDF 视图而不是图像视图解决了这个问题（这是我想展示的 PDF）。我在 PDF 视图上将 autoScales 属性设置为 YES。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:18:20.290

我假设您已经参考了以下示例中的视图：

```
NSView * parentView;
NSImageView * imageView;
[imageView setTranslatesAutoresizingMaskIntoConstraints:NO]; //Required to opt-in to autolayout
[parentView addSubview:imageView]; //Subview must exist before adding constraint. 

NSDictionary * views = NSDictionaryOfVariableBindings(imageView);
[parentView addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"H:|[imageView]|"
                                                                   options:0
                                                                   metrics:nil
                                                                     views:views]];
[parentView addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"V:|[imageView]|"
                                                                   options:0
                                                                   metrics:nil
                                                                     views:views]]; 
```

# c# - 提交 AJAX 请求时的控制器方法

> ID：15935852
> 
> 赞同：2
> 
> 时间：2013-04-10T20:33:22.950
> 
> 标签：c#, ajax, asp.net-mvc

我有一个 MVC 项目，其中有一个页面，上面有几个表单。页面上的大部分内容都是根据用户提交的初始表单呈现的。当用户更新该页面上的信息时，我不希望整个页面刷新，我只需要它来提交表单并留在页面上。我尝试设置表单以使用 AJAX 提交，但我不知道如何使控制器方法返回来完成此操作。

形式：

```
<div id="HeatNameDiv" title="Change Heat Name">
@using (Ajax.BeginForm("ChangeHeatName", "Home", new AjaxOptions(){UpdateTargetId = "HeatNameDiv"}))
{
    <section>
        Heat Name:<input type="text" name="heatName" value="@Html.ValueFor(x => x.heatname)" style ="width:100px"/>
        Change to:<input type="text" name="updatedHeat" value="" style="width: 100px" />
        <input type="submit" name="ChangeHeatName" value="Change" />
    </section>
} 
```

电流控制器：

```
 public ActionResult ChangeHeatName(string heatName, string updatedHeat)
    {
        string user = User.Identity.Name;
        HomeModel H = new HomeModel();
        H.ChangeHeatName(heatName, updatedHeat, user);
        return Content("Index");
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:41:33.357

这取决于你想要刷新什么。Ajax.BeginForm 需要一个 HTML 片段。因此，您需要一个表示要在提交后替换的 heatNameDiv 的部分：

```
public ActionResult ChangeHeatName(string heatName, string updatedHeat)
    {
        string user = User.Identity.Name;
        HomeModel H = new HomeModel();
        H.ChangeHeatName(heatName, updatedHeat, user);
        return PartialView("NameOfPartialView", H);
    } 
```

我同意 Jeremy 的观点，因为 Ajax.BeginForm 不太灵活。过去我也尝试过使用它，但是它替换了目标元素，而不是目标的innerHtml，这使得它在许多场景中都变得困难。

`$.ajax`你可以在`url: '@(Url.Action("MyActionReturningAPartialView"))'`.success 回调中设置和`function(response) { $('#heatNameDiv').innerHtml(response); }`

您调用的操作仍会返回 PartialView。

# php - 如何创建一个php二维数组？

> ID：15935853
> 
> 赞同：-1
> 
> 时间：2013-04-10T20:33:27.227
> 
> 标签：php, arrays

大家好，我是 php 新手，我必须完成我正在做的 php 课程的作业，但我在理解它时遇到了一些麻烦。

基本上我必须使用循环和字符串创建一个具有以下输出的程序：

```
a 00000000
b 00000000
c 00000X00
d 00000000
e 00000000
f 000X0000
g 00000000
h 00000X00
  12345678 
```

“用户在开头输入二维字符串的位置。基于此字符串（坐标）在桌子上绘制“x”。”

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:56:02.680

我完全同意@Marc B 你需要自己做功课的观点。您可以在 php.net 网站上了解 PHP 数组以及如何使用它们：http: [//us3.php.net/manual/en/book.array.php](http://us3.php.net/manual/en/book.array.php)和这里：[http ://www.w3schools.com /php/php_arrays.asp](http://www.w3schools.com/php/php_arrays.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:56:52.513

有使用循环（While、For、Foreach）生成多数组的自动方法，但您可以弄清楚这些。这是一种手动方式：

```
 $array = array('a'=>array(1 => 0,2 => 0,3 => 0,),'b'=>array(1 => 0,2 => 0,3 => 0,)); 
```

然后您需要构建一个 html 输入并使用 $_GET 或 $_POST 接收输入

使用该输入来决定在哪里执行 Marc B 所说的操作：

```
 $array[$y][$x] = 'X'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T23:40:57.017

我想你会想要这样的[东西](http://danielabbey.co.uk/so/15935853/)。

源代码：

```
 <?php
            $Y = range('a', 'h');
            $X = range(1, 8);
        ?>
        <form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="GET">
            <div id="in">Coord X: <input type="number" min="1" max="8" name="x" value="<?php echo $X[array_rand($X)]; ?>"></div>
            <div id="in">Coord Y: <input type="text" name="y" value="<?php echo $Y[array_rand($Y)]; ?>"></div>
            <br /><input id="subm" type="submit" value="DRAW!">
            <input name="reset" id="reset" type="submit" value="reset">
        </form>
        <table>
            <tfoot>
                <tr>
                    <td></td><?php foreach($X as $x) echo "<td><strong>$x</strong></td>"; ?>
                </tr>
            </tfoot>
            <tr>
                <?php
                    if(isset($_GET['reset']))
                    {
                        session_destroy();
                        header('Location: thisPage.php');
                    }
                    $coords = !empty($_GET) ? $_GET['x'].$_GET['y'] : NULL;
                    $_SESSION['coords'][] = $coords;
                    for($i = 0; $i < count($Y); $i++)
                    {
                        echo "<tr><td><strong>$Y[$i]</strong></td>";
                        for($j = 0; $j < count($Y); $j++)
                        {
                            if(isset($_GET) && in_array($X[$j].$Y[$i], $_SESSION['coords']))
                            {
                                echo '<td id="ex"><strong>X</strong></td>';
                            }
                            else
                            {
                                echo '<td>0</td>';
                            }
                        }
                    }
                    echo "</tr>";
                ?>
            </tr>
        </table> 
```

# c++ - pthread_cond_wait 没有达到我的预期

> ID：15935855
> 
> 赞同：0
> 
> 时间：2013-04-10T20:33:31.230
> 
> 标签：c++, pthreads, posix

我正在尝试以我认为应该使用的方式使用 pthread_cond_wait。我在一个方法中使用它，即等待某些事情发生变化，当它发生变化时，它将调用另一个方法来获取数据。如下所示：

```
void waitForSomething(const std::string& _str) {

    //lock my mutex here

     while (!ifStringInSomeCollection(_str)) {
             std::cout << "waiting.." << std::endl;
             pthread_cond_wait(&_condMutex, &_myMutex);
     }
     //unlock my mutex here

     //this method also acquires my mutex lock
     std::cout << getData(_str) << std::endl;
} 
```

现在，在我的另一种打破条件并广播/发出等待条件的信号的方法中，我首先在广播/发出信号之前解锁互斥锁 - 所以这不应该成为问题。

但即使没有，当前发生的情况是，它会不断检查 while 循环中的条件而不是 pthread_cond_wait - 实际上是等待。我已经坚持了一段时间，任何想法都将不胜感激。谢谢！

===================

经过讨论，我编写了以下内容进行测试，以获得在测试情况下等待的条件。我仍然收到重复的“锁定”消息。我一定做错了什么？[http://ideone.com/eVuKEC](http://ideone.com/eVuKEC)

```
#include<pthread.h>
#include <iostream>

pthread_mutex_t mutex;
pthread_cond_t cond;
bool something;

void test() {
   pthread_mutex_lock(&mutex);
   while(!something) {
      std::cout <<"locked" << std::endl;
      pthread_cond_wait(&cond,&mutex);
   }
   pthread_mutex_unlock(&mutex);
}

int main(){
   pthread_mutex_init(&mutex, NULL);
   pthread_cond_init(&cond, NULL);  
   something=false;  
   test();
   return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T22:34:42.173

使用 -pthread 选项编译到 g++

# php - PHP在文件夹中获取图像返回相同的图像

> ID：15935856
> 
> 赞同：0
> 
> 时间：2013-04-10T20:33:42.723
> 
> 标签：php, arrays, joomla

我正在创建一个 joomla 模块，该模块会提取一篇文章，然后从文件夹中为其分配一个图像（无特定顺序）。

但它一直返回相同的图像：/... 其他一切都很好，我只需要它从每篇文章的文件夹中抓取不同的图像。

这是 mod_slider.php（仅包括必需品）：

```
$a = explode(",", $params->get('id'));

foreach ($a as $k => $val) {
    $args = $val;
    $item[] = ModArticleSlider::getArticles($args,$params);
} 
```

和 helper.php（包括整个类）：

```
class ModArticleSlider {
    public static function getArticles($args,$params){
        $db = JFactory::getDBO();
        $id = $args;
        if($id > 0){

            $query  = "select * ";
            $query .= "FROM #__content  WHERE id =".$id." AND state=1 " ;

            //echo $query;
            $db->setQuery($query);
            $item = $db->loadObject();
        }

        $folder = $params->get('folder');

        if(JString::strpos($folder, JURI::base()) === 0)
        {
            $folder = str_replace(JURI::base(), '', $folder);
        }

        if(JString::strpos($folder, JPATH_SITE) === 0)
        {
            $folder = str_replace(JPATH_BASE, '', $folder);
        }

        $folder = str_replace('\\', '/', $folder);

        $dir = JPATH_BASE.'/'.$folder;
        $files = array();

        if(is_dir($dir))
        {
            if($handle = opendir($dir))
            {
                while(($file = readdir($handle)) !== false)
                {
                    if($file != '.' AND $file != '..' AND $file != 'index.html')
                    {
                        $files[] = $file;
                    }
                }
            }

            closedir($handle);

            $types = array_map('trim', explode(',', $params->get('type')));
            $images = array();

            foreach($files as $img){

                if(!is_dir($dir.'/'.$img))
                {
                    foreach($types as $type)
                    {
                        $muster = '@'.$type.'$@i';

                        if(preg_match($muster, $img))
                        {
                            $item->name = $img;
                            $item->folder = str_replace('\\', '/', $folder);
                        }
                    }
                }
            }
        }
        return $item;
    }

} 
```

然后是 index.php（仅包括必需品）：

```
<?php foreach ($item as $items):?>
<img src="<?php echo $items->folder.'/'.$items->name ?>" />
<?php endforeach; ?> 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T21:01:21.297

看起来您实际上并没有选择随机图像。我正在查看的代码是本节：

```
 $types = array_map('trim', explode(',', $params->get('type')));
        $images = array();

        foreach($files as $img){

            if(!is_dir($dir.'/'.$img))
            {
                foreach($types as $type)
                {
                    $muster = '@'.$type.'$@i';

                    if(preg_match($muster, $img))
                    {
                        $item->name = $img;
                        $item->folder = str_replace('\\', '/', $folder);
                    }
                }
            }
        } 
```

您遍历所有文件，但如果匹配，您只是将它们相互分配。`$item->name`并且`$item->folder`每次都被覆盖。我也看不到您实际上在哪里随机化文件列表，因此您不能真正期望随机图像。（我假设您可能会使用`$images`某些东西来进行随机化或获取所有匹配项，因此您可能可以将其删除。）我会`shuffle`在 $files 上添加一个随机文件列表，然后在之后中断循环你得到你的第一个匹配，以避免不必要地处理整个列表：

```
 $types = array_map('trim', explode(',', $params->get('type')));
        shuffle($files);

        foreach($files as $img){

            if(!is_dir($dir.'/'.$img))
            {
                foreach($types as $type)
                {
                    $muster = '@'.$type.'$@i';

                    if(preg_match($muster, $img))
                    {
                        $item->name = $img;
                        $item->folder = str_replace('\\', '/', $folder);
                        break 2;
                    }
                }
            }
        } 
```

# javascript - 在平铺中重复图像，并使其旋转

> ID：15935864
> 
> 赞同：1
> 
> 时间：2013-04-10T20:34:17.313
> 
> 标签：javascript, html, css, image, rotation

如何使用平铺中的重复图像填充网站，就像`background-repeat: repeat;`使用 CSS 或 Javascript 使其旋转一样？

要旋转单个图像，我可以使用 CSS：

```
@-webkit-keyframes spin {
    from { -webkit-transform: rotate(0deg); }
    to { -webkit-transform: rotate(360deg); }
}

@-moz-keyframes spin {
    from { -moz-transform: rotate(0deg); }
    to { -moz-transform: rotate(360deg); }
}

@-ms-keyframes spin {
    from { -ms-transform: rotate(0deg); }
    to { -ms-transform: rotate(360deg); }
}                                               

img#id {                                            
    -webkit-animation-name:             spin;  
    -webkit-animation-duration:         5s;    
    -webkit-animation-iteration-count:  infinite;
    -webkit-animation-timing-function:  linear;  
    -moz-animation-name:                spin;  
    -moz-animation-duration:            5s;    
    -moz-animation-iteration-count:     infinite;
    -moz-animation-timing-function:     linear; 
    -ms-animation-name:                 spin;  
    -ms-animation-duration:             5s;    
    -ms-animation-iteration-count:      infinite;
    -ms-animation-timing-function:      linear; 
} 
```

但是我不知道如何对重复的图像执行此操作，即访问背景图像作为元素或重复 a`<img>`并用给定的图像填充整个页面，例如`background-repeat`.

[这](http://jsfiddle.net/C9bup/4/)是旋转单个图像的示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T23:14:43.157

根据您的要求，我做了这样的事情，虽然我认为这是一个糟糕的选择，而且它可以做得更好......

-------**更新**了 ------- 好吧，我让代码更干净......

[jsFiddle Demo 更新](http://jsfiddle.net/GKDev/Ac5RR/13/)

```
(function () {
    var left = 0,
        top = 0,
        background = document.getElementById("background"),
        getWidth = document.width,
        getHeight = document.height,
        imageSize = 240,
        width = 960,
        height = 960,
        countPerLine = 4,
        countOfImages = 16,
        difference = 0;

    function setParameters() {
        if (getWidth > width) {
            width = getWidth;
            countPerLine = Math.floor(getWidth / imageSize);
            difference = getWidth % imageSize;
            imageSize += Math.round(difference / countPerLine);
        }
        if (getHeight > height) {
            countOfImages = Math.floor(getHeight / imageSize);
            countOfImages *= countPerLine;
        }
    }

    function setBackground() {
        for (var i = 0; i < countOfImages; i++) {
            var div = document.createElement("div");

            div.classList.add("bgr");
            div.style.width = imageSize + "px";
            div.style.height = imageSize + "px";
            div.style.backgroundSize = "100% 100%";
            background.appendChild(div);

            if (i === 0) {
                div.style.left = "0px";
                div.style.top = "0px";
            } else {
                left += imageSize;
                if (left >= width) {
                    left = 0;
                    top += imageSize;
                }
                div.style.left = left + "px";
                div.style.top = top + "px";
            }
        }
    }

    setParameters();
    setBackground();
}()); 
```

# c++ - 将英特尔的 MKL（BLAS 和 LAPACK）链接到 GCC

> ID：15935866
> 
> 赞同：3
> 
> 时间：2013-04-10T20:34:48.053
> 
> 标签：c++, linker, lapack, blas, intel-mkl

我正在尝试编译一个巨大的软件包，这是我似乎无法弄清楚的最后一个障碍。

我收到如下错误：

```
RNDiracDeterminantBase.cpp:(.text+0x22bf): undefined reference to `dgetrf_'
RNDiracDeterminantBase.cpp:(.text+0x2524): undefined reference to `dgetri_'
RNDiracDeterminantBase.cpp:(.text+0x3005): undefined reference to `dgetri_'
../../lib/libqmcwfs.a(RNDiracDeterminantBase.cpp.o): In function `qmcplusplus::RNDiracDeterminantBase::ratio(qmcplusplus::ParticleSet&, int, qmcplusplus::ParticleAttrib<qmcplusplus::TinyVector<double, 3u> >&, qmcplusplus::ParticleAttrib<double>&)':
RNDiracDeterminantBase.cpp:(.text+0x4156): undefined reference to `dgemv_'
RNDiracDeterminantBase.cpp:(.text+0x420f): undefined reference to `dger_' 
```

谷歌透露这些参考资料是英特尔的 MKL 库。但是，我不知道我需要链接什么文件。我试过 libmkl_core.a、libmkl_gnu_thread.a、libmkl_blacs_intelmpi_lp64.a 等。有很多文件：

/mkl/lib/intel64/

如果需要，可以发布更多信息。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-11T03:17:40.723

> 我不知道我需要链接什么文件。我试过 libmkl_core.a、libmkl_gnu_thread.a、libmkl_blacs_intelmpi_lp64.a 等。有很多文件：`/mkl/lib/intel64/`

有大量文件的事实并不意味着您必须依次尝试每个库。

要找出哪个库定义了您想要的符号，请运行以下命令：

```
cd /mkl/lib/intel64
nm -A *.a | egrep '[TWBD] (dger_|dgemv_|dgetrf_|dgetri_)$' 
```

还要确保将库放在链接行的*末尾*，因为命令行上存档库的顺序[很重要](http://webpages.charter.net/ppluzhnikov/linker.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-13T05:13:01.770

根据您提供的不完整信息，您可能需要 libmkl_intel_lp64.a、libmkl_gnu_thread.a 和 libmkl_core.a。

英特尔 MKL 有一个内置工具可帮助您找出链接：/mkl/tools/mkl_link_tool。该工具也可从以下网站获得：http: [//software.intel.com/en-us/articles/intel-mkl-link-line-advisor](http://software.intel.com/en-us/articles/intel-mkl-link-line-advisor)。使用此工具获取适合您情况的确切链接线。

您应该在 MKL 官方论坛 ( [http://software.intel.com/en-us/forums/intel-math-kernel-library](http://software.intel.com/en-us/forums/intel-math-kernel-library) ) 上提出您的问题。您将在数小时而不是数天之内获得此类问题的答案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-12-07T16:55:53.397

在 Windows 上设置 mingw 时我遇到了类似的问题。

以下库链接顺序适用于 gcc：

1.  mkl_intel_thread
2.  mkl_rt
3.  mkl_core
4.  mkl_intel_lp64

希望这可以帮助任何遇到此问题的人。

# c# - 无法将匿名方法转换为类型“System.Delegate”，因为它不是委托类型

> ID：15935867
> 
> 赞同：13
> 
> 时间：2013-04-10T20:34:58.717
> 
> 标签：c#, wpf

我想在 WPF 应用程序的主线程上执行此代码并收到错误我无法弄清楚出了什么问题：

```
private void AddLog(string logItem)
        {

            this.Dispatcher.BeginInvoke(
                delegate()
                    {
                        this.Log.Add(new KeyValuePair<string, string>(DateTime.Now.ToLongTimeString(), logItem));

                    });
        } 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-10T20:39:15.507

匿名函数（lambda 表达式和匿名方法）必须转换为*特定*的委托类型，而`Dispatcher.BeginInvoke`只需`Delegate`. 有两种选择...

1.  仍然使用现有的`BeginInvoke`调用，但指定委托类型。这里有各种方法，但我一般将匿名函数提取到前面的语句中：

    ```
    Action action = delegate() { 
         this.Log.Add(...);
    };
    Dispatcher.BeginInvoke(action); 
    ```

2.  编写一个扩展方法，`Dispatcher`而`Action`不是`Delegate`：

    ```
    public static void BeginInvokeAction(this Dispatcher dispatcher,
                                         Action action) 
    {
        Dispatcher.BeginInvoke(action);
    } 
    ```

    然后您可以使用隐式转换调用扩展方法

    ```
    this.Dispatcher.BeginInvokeAction(
            delegate()
            {
                this.Log.Add(...);
            }); 
    ```

我也鼓励你使用 lambda 表达式而不是匿名方法，一般来说：

```
Dispatcher.BeginInvokeAction(() => this.Log.Add(...)); 
```

编辑：如评论中所述，`Dispatcher.BeginInvoke`在 .NET 4.5 中获得了`Action`直接采用 a 的重载，因此在这种情况下您不需要扩展方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-09-09T15:03:40.270

您也可以为此使用[MethodInvoker ：](https://msdn.microsoft.com/en-us/library/system.windows.forms.methodinvoker.aspx)

```
private void AddLog(string logItem)
        {
            this.Dispatcher.BeginInvoke((MethodInvoker) delegate
            {
                this.Log.Add(new KeyValuePair<string, string>(DateTime.Now.ToLongTimeString(), logItem));
            });
        } 
```

# github - 为 git hub mac 设置 ssh 密钥

> ID：15935868
> 
> 赞同：1
> 
> 时间：2013-04-10T20:34:59.077
> 
> 标签：github, push

我正在按照[这篇](https://help.github.com/articles/generating-ssh-keys)文章从我的 macbook 终端设置 SSH 密钥。但是，在第 3 步中，它要求我将密钥从 id_rsa.pub 复制到剪贴板。当我 cd ~/.ssh 时，我找不到该文件。相反，我有

github_rsa.pub

github_rsa

它们都具有加密值。我不确定在哪里可以找到该 id_rsa.pub 文件，或者我是否必须使用上面提到的文件之一将密钥复制到我的剪贴板中。

我这样做是为了解决正在发生的 Permission denied (public token) 问题，该问题避免我将代码推送到我的存储库中。

谢谢

# c++ - 为什么 boost::signals2::signal ::connect 需要复制构造函数吗？

> ID：15935869
> 
> 赞同：1
> 
> 时间：2013-04-10T20:35:07.310
> 
> 标签：c++, boost, c++11, frp, boost-signals2

我正在研究一个表示正常数据值的对象，该对象利用函数式反应式编程，当依赖值发生变化时会改变它们的值。我的意思是，假设你有一个 var3 = var1 + var2; 然后当您更改 var1 的值时，var3 的值会自动更新。在 C++ 中，这很困难，但是在某个地方的另一个工作线程中调用了更新函数，你可以让它看起来是功能反应的。

所以这是我这样做的方法。我创建了一个名为 Reactive 的模板对象，其中可以包含任何类型，然后重载它的运算符，这样当这些反应中的两个被加在一起时，不仅结果值等于它们的总和，而且 lambda 是made 将操作存储在 std::function 中，以后可以在任何时候调用它的更新函数时再次调用它来更新结果的值。

出现了几个问题。如果依赖值之一被破坏怎么办。即使生成的 Reactive 仍然具有它认为有效的 lambda，但 lambda 使用的参数不再存在。为了解决这个问题，我求助于 boost::signals2 来建立一个信号和槽系统，以通知结果者他们的任何一个依赖者被破坏。当结果接收到信号时，它的影响函数被清空并且不会在更新时被调用。

为了让 Reactives 能够执行 + 操作，必须创建一个临时的响应式，它具有自己的信号，然后 = 运算符必须重载以将临时中的数据移动到生成的响应式。然而，信号不能被复制。我通过在 std::unique_ptr 中包含 destruct 信号来避开这个问题，当 operator = 收到 Reactive && 时使用 std::move。危机化解了。

现在这是我卡住的地方。后来我意识到，尽管移动构造很好，但仍然无法复制我的 Reactives 之一，因为可以说 var3 = var1 + var2; 然后你这样做： var4 = var3; 然后不知何故 var1 和 var2 中的破坏信号需要一种方法来通知 var4 它们已被破坏。我最终想出的是设置它，以便我有一个名为 Proxy 的子对象，它是一个函子，包含一个 boost::signals2::signal，然后每个对象都会有一个包含在 std::shared_ptr . 如果 Reactive 有对该代理的引用，那么它将它的通知销毁方法连接到该代理。然后依赖者将信号附加到该代理。当代理被调用时，它也会调用它的所有连接。

问题是，将代理连接到依赖信号需要代理具有复制构造函数，或者至少，这是 msvc 给我的错误。显然 boost::signals2::signal::connect 使用它的复制构造函数，它不能因为代理本身包含一个信号。我给你所有这些信息，因为我仍然不确定这是否是最好的解决方案。我选择信号和插槽是因为我对它们最熟悉，但是如果您有更好的解决方案，请指出。否则，请帮助我避免此错误。

顺便说一句，Slot 只是使 Unreact() 函数成为仿函数的一种方式，每个 Reactive 都是唯一的。

这是对象：

```
template<class T>
class Reactive
{ 
    template<class H>
    friend class Reactive;

    class Slot : public boost::signals2::trackable
    {
    public:
        Slot(std::function<void()> & func) :
            m_Func(func)
            {}

        void operator()()
            {m_Func();}

    private:
        std::function<void()> m_Func;
    };

    class Proxy : public boost::signals2::trackable
    {
        Proxy(const Proxy & s);
        Proxy & operator=(const Proxy & s);
    public:
        Proxy(){}

        void operator()() 
            {m_Informer();}

        void attach(Slot & m_Unreacter) 
            {m_Informer.connect(m_Unreacter);}

    private:
        boost::signals2::signal<void()> m_Informer;
    };

public:
    ~Reactive()
    {
        (*m_SendDestruct)();
    }

    Reactive() :
        m_SendDestruct(new boost::signals2::signal<void()>),
        m_Proxy(new Proxy),
        m_ReceiveDestruct(std::function<void()>(std::bind(&Reactive::Unreact, this))),
        m_Affecter(nullptr)
    {
        m_Proxy->attach(m_ReceiveDestruct);
    }

    template<class H>
    Reactive(const H & data) :
        m_SendDestruct(new boost::signals2::signal<void()>),
        m_Proxy(new Proxy),
        m_ReceiveDestruct(std::function<void()>(std::bind(&Reactive::Unreact, this))),
        m_Affecter(nullptr),
        m_Data(data)    
    {
        m_Proxy->attach(m_ReceiveDestruct);
    }

    Reactive(const Reactive & reac) :
        m_SendDestruct(new boost::signals2::signal<void()>),
        m_Proxy(reac.m_Proxy),
        m_ReceiveDestruct(std::function<void()>(std::bind(&Reactive::Unreact, this))),
        m_Affecter(reac.m_Affecter),
        m_Data(reac.m_Data)
    {
        m_Proxy->attach(m_ReceiveDestruct);
    }

    Reactive(Reactive && reac) :
        m_SendDestruct(std::move(reac.m_SendDestruct)),
        m_Proxy(reac.m_Proxy),
        m_ReceiveDestruct(std::function<void()>(std::bind(&Reactive::Unreact, this))),
        m_Affecter(reac.m_Affecter),
        m_Data(reac.m_Data)
    {
        m_Proxy->attach(m_ReceiveDestruct);
    }

    Reactive & operator=(const T & data)
    {
        m_Data = data;

        return *this;
    }

    Reactive & operator=(const Reactive & reac)
    {
        m_Proxy = reac.m_Proxy;
        m_Proxy.attach(m_ReceiveDestruct);
        m_Affecter = reac.m_Affecter;
        m_Data = reac.m_Data;
    }

    Reactive & operator=(Reactive && reac)
    {
        m_SendDestruct = std::move(reac.m_SendDestruct);
        m_Proxy = reac.m_Proxy;
        m_Affecter(reac.m_Affecter);
        m_Data(reac.m_Data);
    }

    template<class H>
    Reactive & operator+(const H & rhs)
    {
        m_Data += rhs;

        return *this;
    }

    template<class H>
    auto operator+(Reactive<H> & rhs) -> Reactive<decltype(m_Data + rhs.m_Data)> &&
    {
        Reactive<decltype(m_Data + rhs.m_Data)> m_temp;
        std::function<decltype(m_Data + rhs.m_Data)()> func;

        if (!rhs.m_Affecter)
            func = [&](){ return m_Data + rhs.m_Data;};
        else
            func = [&](){return m_Data + rhs.m_Affecter();};

        m_SendDestruct->connect((*m_temp.m_Proxy));
        rhs.m_SendDestruct->connect((*m_temp.m_Proxy));

        return std::forward<Reactive<decltype(m_Data+rhs.m_Data)> &&>(m_temp);
    }

    template<class H>
    Reactive && operator+(Reactive<H> && rhs)
    {
        Reactive && m_Temp
    }

    T & Get()
    {
        return m_Data;
    }

    void Update()
    {
        if(m_Affecter)
            m_Data = m_Affecter();
    }

    void Unreact()
    {
        m_Affecter = nullptr;
        (*m_SendDestruct)();
    }

private:
    std::unique_ptr<boost::signals2::signal<void()> > m_SendDestruct;
    std::shared_ptr<Proxy> m_Proxy;
    Slot m_ReceiveDestruct;
    std::function<T()> m_Affecter;
    T m_Data;
}; 
```

和简单的测试

```
int main()
{
    Reactive<int> vel(10);
    Reactive<int> acc(5);
    Reactive<int> time(5);

    Reactive<int> result = vel + acc + time;

    system("PAUSE");
    return 0;
} 
```

以下是警告/错误：

```
1>main.cpp(86): warning C4355: 'this' : used in base member initializer list
1>          main.cpp(83) : while compiling class template member function 'Reactive<T>::Reactive(Reactive<T> &&)'
1>          with
1>          [
1>              T=int
1>          ]
1>          main.cpp(174) : see reference to class template instantiation 'Reactive<T>' being compiled
1>          with
1>          [
1>              T=int
1>          ]
1>main.cpp(66): warning C4355: 'this' : used in base member initializer list
1>          main.cpp(174) : see reference to function template instantiation 'Reactive<T>::Reactive<int>(const H &)' being compiled
1>          with
1>          [
1>              T=int,
1>              H=int
1>          ]
1>main.cpp(56): warning C4355: 'this' : used in base member initializer list
1>          main.cpp(53) : while compiling class template member function 'Reactive<T>::Reactive(void)'
1>          with
1>          [
1>              T=int
1>          ]
1>c:\program files (x86)\boost\boost_1_53_0\boost\signals2\detail\slot_template.hpp(156): error C2248: 'Reactive<T>::Proxy::Proxy' : cannot access private member declared in class 'Reactive<T>::Proxy'
1>          with
1>          [
1>              T=int
1>          ]
1>          main.cpp(32) : see declaration of 'Reactive<T>::Proxy::Proxy'
1>          with
1>          [
1>              T=int
1>          ]
1>          main.cpp(30) : see declaration of 'Reactive<T>::Proxy'
1>          with
1>          [
1>              T=int
1>          ]
1>          c:\program files (x86)\boost\boost_1_53_0\boost\signals2\detail\slot_template.hpp(81) : see reference to function template instantiation 'void boost::signals2::slot0<R,SlotFunction>::init_slot_function<F>(const F &)' being compiled
1>          with
1>          [
1>              R=void,
1>              SlotFunction=boost::function<void (void)>,
1>              F=Reactive<int>::Proxy
1>          ]
1>          main.cpp(135) : see reference to function template instantiation 'boost::signals2::slot0<R,SlotFunction>::slot0<Reactive<T>::Proxy>(const F &)' being compiled
1>          with
1>          [
1>              R=void,
1>              SlotFunction=boost::function<void (void)>,
1>              T=int,
1>              F=Reactive<int>::Proxy
1>          ]
1>          main.cpp(178) : see reference to function template instantiation 'Reactive<T> &&Reactive<T>::operator +<int>(Reactive<T> &)' being compiled
1>          with
1>          [
1>              T=int
1>          ]
1>
1>Build FAILED.
1>
1>Time Elapsed 00:00:04.20
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T19:48:04.267

我认为你有一个设计问题。

反应变量的逻辑生命周期不应与命名它的 C++ 变量的生命周期相关联。

使用该`pImpl`模式使每个反应变量的生命周期只要有一个 C++ 变量来命名它，或者只要存在另一个引用它的反应变量。（`std::shared_ptr`，可能有一些东西可以检测循环引用，无论如何这在反应图中都是不好的魔力）。

当你移动时，你移动的是内部的状态`pImpl`，而不是它`pImpl`本身——它`pImpl`有自己的指向反应状态的指针（a `ppImpl`），这对于临时反应（例如`A+B`）非常有用。

当你依赖时`A`，你实际上是依赖于`A->pImpl`，并且你增加了它的引用计数。

如果你设置`A = B`，这意味着`A->pImpl`取决于`B->pImpl`, not`A->pImpl`的反应状态是 的反应状态的副本`B->pImpl`。这是一个微妙的区别。

这仍然需要一些努力才能使更改向前传播。我会对`weak_ptr`那些依赖你的人进行反向引用，并且`SetIsDirty`通过树向后传播。任何脏的东西在读取时都会重新计算，否则使用缓存的值。

如果您希望`A = B`导致的效果`A->pImpl`是 的副本`B->pImpl`，请使用不同的语法（例如`A = *B`，窃取 C++ 主义）。这是唯一需要复制`pImpl`状态的情况！

请注意，这`A = std::move(B)`需要移动`pImpl`状态，因此使用`ppImpl`来存储状态以进行优化。

您应该发现实际上不需要额外的线程或插槽/套接字。除非你实现 unary `operator*`，否则不需要复制给定的状态`pImpl`。

请注意，我关于循环依赖的临时评论很重要。具有循环依赖的反应图在上述设计下会泄漏，更重要的是在逻辑上不可能计算任何值。

# perl - 如何在 Perl 中进行整数除法或如何使我的二进制搜索工作？

> ID：15935870
> 
> 赞同：1
> 
> 时间：2013-04-10T20:35:07.497
> 
> 标签：perl, int, binary-search

我正在尝试实现二进制搜索。这是我的代码：

```
#!/usr/bin/perl
#use strict;
use warnings;

@array = (1..100);
$number = <STDIN>;
$low = 0;
$high = $#array;

while($low < $high){
    print "Searcing $low ---- $high \n";
    $mid = $low + ($high - $low)/2;
    if($array[$mid] == $number){
        print "Found in index:" . $mid;
        last;
    }
    elsif($array[$mid] < $number){
        $low = $mid + 1;
    }
    else{
        $high = $mid - 1;
    }   
} 
```

但它不起作用，尽管它是一个直接的实现（至少它会在 Java 中）。
似乎我在划分时得到浮点值并且无法搜索。如果我提供作为输入`5`，我会得到垃圾：

```
5  
Searcing 0 ---- 99  
Searcing 0 ---- 48.5  
Searcing 0 ---- 23.25  
Searcing 0 ---- 10.625  
Searcing 0 ---- 4.3125  
Searcing 3.15625 ---- 4.3125 
```

我怎样才能使它使用整数，以便我可以索引数组？
此外，如果我取消注释`use strict`，我会收到以下错误。他们的意思是什么？

```
Global symbol "@array" requires explicit package name at D:\Development\Perl\chapter3\binarySearch.pl line 6\.  
Global symbol "$number" requires explicit package name at D:\Development\Perl\chapter3\binarySearch.pl line 9\.  
Global symbol "$low" requires explicit package name at 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-10T20:38:43.687

```
my $int = int 5 / 2;
print $int; 
```

打印 2。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-11T04:55:42.163

两个深奥的解决方案。除非您真的很无聊或其他什么，否则不要实际使用这些。

1.  `use integer`-- 强制 Perl 将所有数值视为整数的编译指示。它可以在本地范围内，因此不会破坏程序中的所有数据

    ```
    while($low < $high){
        print "Searcing $low ---- $high \n";
        {
            use integer;
            $mid = $low + ($high - $low)/2;
        }
        if($array[$mid] == $number){
            print "Found in index:" . $mid;
            last;
        }
        elsif($array[$mid] < $number){
            $low = $mid + 1;
        }
        else{
            $high = $mid - 1;
        }   
    } 
    ```

2.  Perl 有一些特殊的变量[`$=`](http://search.cpan.org/perldoc?perlvar#FORMAT_LINES_PER_PAGE), [`$-`](http://search.cpan.org/perldoc?perlvar#FORMAT_LINES_LEFT), 并且[`$%`](http://search.cpan.org/perldoc?perlvar#FORMAT_PAGE_NUMBER)只保存整数值，不管你给它们赋值什么。直接使用它们

    ```
    $- = $low + ($high - $low) / 2;
    if ($array[$-] == $number) { ... 
    ```

    或作为中间体

    ```
    my $mid = $- = $low + ($high - $low) / 2;
    if ($array[$mid] == $number) { ... 
    ```

    [使用像这样的魔法变量对于打代码](https://stackoverflow.com/a/1977483/168657)和激怒你的同事来说很方便，但除此之外就没什么了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-11T19:17:35.970

你的代码有很多问题。

*   你禁用[了 strict](http://perldoc.perl.org/strict.html "perldoc 严格")。

    大概是因为下一个问题。

*   您没有声明任何变量，使用[`my`](http://perldoc.perl.org/functions/my.html "perldoc -f 我的")or[`our`](http://perldoc.perl.org/functions/our.html "perldoc -f 我们的")甚至[`use vars`](http://perldoc.perl.org/vars.html "perldoc 变量").

    ```
    our @array = 1..100;
    use vars qw'$mid $low $high';
    my $number = <STDIN> 
    ```

*   你太担心溢出了。这不是C。

    如果你的数字会溢出一个整数，它就会变成一个浮点数。

    ```
    my $mid = $low + ($high - $low)/2; 
    ```

    应该只是：

    ```
    my $mid = ($high + $low)/2; 
    ```

*   您期望除法中的整数。

    ```
    my $mid = ($high + $low)/2; 
    ```

    如果你真的想要一个整数，只需使用[`int`](http://perldoc.perl.org/functions/int.html "perldoc -f int").

    ```
    my $mid = int( ($high + $low)/2 ); 
    ```

*   您没有从末尾删除换行符`$number`

    ```
    chomp($number); 
    ```

*   你有一个错误。

    ```
    while($low < $high){ 
    ```

    真的应该

    ```
    while($low <= $high){ 
    ```

    这确实是您的主要问题。

```
#! /usr/bin/env perl
use strict;
use warnings;

my @array = 1..100;
my $number = <STDIN>;
chomp $number;
my $low = 0;
my $high = $#array;

while($low <= $high){
    my $mid = int( ($high + $low)/2 );
    printf "Searching %2d .. (%2d) .. %2d\n", $low, $mid, $high;
    if($array[$mid] == $number){
        print "Found $number at index mid $mid\n";
        last;
    }elsif($array[$mid] < $number){
        $low = $mid + 1;
    }else{
        $high = $mid - 1;
    }
} 
```

不过，这并不是真正的 Perlish。

```
#!/usr/bin/perl
use strict;
use warnings;
use List::MoreUtils qw'first_index';

my @array = 1..100;
my $number = <STDIN>;
chomp $number;

my $index = first_index { $_ == $number } @array;
print "Found $number at index ", $index if $index != -1; 
```

或者更奇怪的是

```
#! /usr/bin/env perl
use strict;
use warnings;

my @array = 1..100;
my $number = <STDIN>;
chomp $number;

my $char = join '', map chr, @array;

my $index = index $char, chr $number;
print "Found $number at index $index\n" if $index != -1; 
```

`UV`这适用于最大或较小的数字`(2 ** 72) - 1`。
在 64 位版本上为 18,446,744,073,709,551,615，在 32 位版本上为 4,294,967,295。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-10T23:44:06.540

使用好旧的`>> 1`而不是`/2`.

例子：

```
perl -e 'BEGIN { print 5/2, " : ", 5>>1}' 
```

输出：

```
2.5 : 2 
```

并使用（备用减法）：

```
my $mid = ($low + $high) >> 1; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-10T20:43:29.050

您应该使用函数[int](http://perldoc.perl.org/functions/int.html)。

除此之外，您需要`use strict;`并使用`my`来确定变量的范围。这将捕获您可能错过的错误。只需像这样声明它们：

```
my @array = (1..100);
chomp(my $number = <STDIN>);
my $low = 0;
my $high = $#array;

my $mid = int ($low + ($high - $low)/2); 
```

您也可以考虑使用[chomp](http://perldoc.perl.org/functions/chomp.html)从输入中删除换行符。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-10T23:44:06.523

首先，

```
my $mid = $low + ($high - $low)/2 
```

可以简化为

```
my $mid = ($high + $low)/2; 
```

您可以使用[`int`](http://perldoc.perl.org/functions/int.html)

```
my $mid = int( ($high + $low)/2 ); 
```

或者您可以利用位移是整数除以 2 的事实。

```
my $mid = ($high + $low) >> 1; 
```

另请参阅：[灵活的二进制搜索功能](http://www.perlmonks.org/?node_id=383504#binsearch)

# android - 在 Geocoder 中获取最近的结果并显示它们以及有关 Geocoder 的一些其他问题

> ID：15935871
> 
> 赞同：1
> 
> 时间：2013-04-10T20:35:18.237
> 
> 标签：android, google-geocoder

我正在开发一个应用程序，该应用程序将具有 textview/sea​​rchview 或更优选的方式来获取字符串，搜索该字符串并显示一些结果。并且每当用户单击其中一个结果时，它都会将用户带到另一个 Intent，该 Intent 具有指向单击结果的地图。

我搜索了好几天，我在这里阅读了很多文章，或者在谷歌开发者页面，我知道我需要使用地理编码器，为此我认为最适合我的应用程序的是这个谷歌 API

```
http://maps.googleapis.com/maps/api/geocode/json?address="+geocodingSearch+"&components=country:TR&sensor=false"; 
```

geocodingSearch 将是用户写入的字符串。

*我的第一个问题是`sensor=true`有很大的不同吗？你更喜欢使用它吗？或者你更喜欢别的东西？

*在 Google 的示例中，它`region=es`在其中一个和`components=country:ES`另一个中使用。它们之间有什么区别？它也可以完美运行，还是使用边框更好？

*我解析JSON答案没有任何问题，但我不确定如何显示结果。我希望它被视为搜索结果在底部的方式。它不需要在用户键入时进行搜索，但结果部分会更好这样。我需要使用 a`SearchView`或其他东西吗？

*最后一个问题写在标题中。是否有可能在 Google API 部分的顶部获得最近的结果（我能够获得位置），我不想限制边界，但获得最近的结果会更好。如果这是不可能的，我将尝试通过使用 LatLong 值进行计算来对它们进行排序。

在此先感谢您，我将非常感谢您的帮助。

![在此处输入图像描述](https://i.stack.imgur.com/B3ina.png)

# c++ - 在抽象类之间传递数据

> ID：15935878
> 
> 赞同：0
> 
> 时间：2013-04-10T20:35:54.043
> 
> 标签：c++, object-oriented-analysis

我正在寻找关于完成我将要描述的最佳 OO 方式的意见。我正在编写将成为游戏等事件系统的东西，我希望它尽可能地可扩展，因为有很多抽象类。其中两个是监视器，它们被分配用于监视一个事件，以及回调，它们包装了事件发生时要调用的函数指针。当我想发送回调需要的数据时，就会出现问题。将发送的数据将是子类特定的（取决于函数签名）并存储在子类监视器中。我希望能够在调用执行之前将此数据传递给回调，但由于从监视器的角度来看一切都是抽象的，这很困难。我' 我正在寻找有关如何以可能的最佳 OO 方式执行此操作的建议，到目前为止，我还没有想出任何我太喜欢的东西。由于回调被发送到另一个类以实际被分派，因此数据需要在某个时候最终到达它们内部。

供参考，监视器抽象类

```
#pragma once

#include "DIVE_GUI_Types.h"
#include "DIVE_GUI_Callback.h"
#include "DIVE_GUI_Event_Dispatcher.h"
#include <map>
#include <string>

/*
Class to monitor events to be handled by the event system.
*/

class DIVE_GUI_Event_Monitor
{
private:
    friend class                                        DIVE_GUI_Kernel;
    DIVE_GUI_Event_Dispatcher*                          m_Dispatcher;
    static DIVE_HANDLE                                  m_Active_GUI;

protected:
    const std::string                                   m_Event_ID;
    std::map<DIVE_HANDLE, DIVE_GUI_Callback*>           m_GUI_Map;
    virtual bool Dispatch() = 0;

public:
    void Update();
    std::string Get_Event_ID() const { return m_Event_ID; }
    DIVE_GUI_Event_Monitor(const std::string& id) : m_Event_ID(id) { }
    void Add_Callback(DIVE_HANDLE, DIVE_GUI_Callback* function);
}; 
```

以及回调抽象类

```
#pragma once

/*
Abstract class representing a wrapper for a callback function as per the Command design     pattern.
*/

class DIVE_GUI_Callback
{
public:
    virtual void Excecute_Callback() const = 0;
}; 
```

任何和所有意见/建议表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:55:07.620

如果我正确理解了您，则应将此数据提供给回调构造函数。假设您拥有`Callback1`并`Callback2`派生自`DIVE_GUI_Callback`. 所以代码可能如下所示：

```
DIVE_GUI_Event_Monitor* monitor; 
monitor->Add_Callback(Callback1(specific_data_1));
monitor->Add_Callback(Callback2(specific_data_2)); 
```

然后，此特定数据将用于`Excecute_Callback()`.

# mysql - 在不使用 group_concat 的情况下在 mysql 中进行分组和连接

> ID：15935881
> 
> 赞同：0
> 
> 时间：2013-04-10T20:35:57.720
> 
> 标签：mysql

我需要输出按产品 ID 分组的每个产品的所有评论。

```
select product_id, GROUP_CONCAT(distinct text separator '<hr>') as 'Review' from reviews WHERE status = 'A' group by product_id 
```

我正在使用 group_concat mysql 函数，该函数将多行组合并串在一起为 1。

运行后 group_concat 输出的最大字符数为 1024。这还不够，因为许多产品评论组合后超过 1024 - 导致数据不完整。我试图将 group_concat_max_len mysql 变量更改为更高的数字，但没有超级权限。

有没有我可以使用的替代方法来代替 group_concat？

# ios - 用性能画多条线

> ID：15935884
> 
> 赞同：1
> 
> 时间：2013-04-10T20:36:04.363
> 
> 标签：ios, drawing

嘿，我在构建应用程序方面需要帮助。我构建了一个艺术应用程序，这个应用程序正在处理干扰。这就是我需要在这个应用程序中画很多线的原因。更多的行对干扰更好。我认为问题是iPad不能处理太多的线，因为速度或性能太慢。我不知道如何加快我的代码在 iPad 上的性能。我应该使用 Open GL 还是其他什么...

我能做些什么？

这是Draw.m

```
#import "Draw.h"

@implementation Draw

- (IBAction) sliderValueChanged:(UISlider *)sender {
    label.text = [NSString stringWithFormat:@"%f", slider.value];
    //NSLog(@"slider value = %f", sender.value);
    [self setNeedsDisplay];
}

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {

    }
    return self;
}

- (void)drawRect:(CGRect)rect
{

    CGContextRef ctx = UIGraphicsGetCurrentContext();
    //NSLog(@"slider value = %f", self.bounds.size.width);

    CGMutablePathRef cgpath = CGPathCreateMutable();
    CGPathMoveToPoint(cgpath, NULL, 0, 500);

    CGMutablePathRef cgpath2 = CGPathCreateMutable();
    CGPathMoveToPoint(cgpath2, NULL, 0, 500);

    UIBezierPath *uipath = [[UIBezierPath alloc] init];
    [uipath moveToPoint:CGPointMake(0, 0)];

    int step = 5;
    int iterations = self.bounds.size.width/step;

    for (int i = 0; i < iterations+1; i++){
    //CGPathAddCurveToPoint(cgpath, NULL, 1+i, 0, 1+i, 0, 1+i ,0);

        CGPathAddLineToPoint ( cgpath,  NULL, 0, 0 );
        CGPathAddLineToPoint ( cgpath,  NULL, 0, 768 );
        CGPathAddLineToPoint ( cgpath,  NULL, step*i-slider.value*2, 768 );
        CGPathAddLineToPoint ( cgpath,  NULL, step*i, 0 );
        CGPathAddLineToPoint ( cgpath,  NULL, (step*i)+step, 0 );

    [[UIColor blackColor] setStroke];
    CGContextAddPath(ctx, cgpath);

    [self strokeUIBezierPath:uipath];

    CGPathRelease(cgpath);
}

- (void)strokeContext:(CGContextRef)context
{
    CGContextStrokePath(context);
}

- (void)strokeUIBezierPath:(UIBezierPath*)path
{
    [path stroke];
}

@end 
```

[图片 http://img17.imageshack.us/img17/375/53178410200339197475308.jpg](http://img17.imageshack.us/img17/375/53178410200339197475308.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:27:58.357

贝塞尔路径的问题在于，它们可能非常“计算量大”。

您可以使用直线 ( `CGContextAddLineToPoint(context, point.x, point.y);`)

或者你使用图形加速。您可以直接进入 OpenGL 或使用游戏引擎来帮助您编写一些代码。

cocos2d 是最受欢迎的一种（而且我认为很容易使用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T06:54:48.647

您应该使用填充屏幕的模式获得更好的性能。[Quartz Programming Guide](https://developer.apple.com/library/mac/documentation/graphicsimaging/conceptual/drawingwithquartz2d/dq_patterns/dq_patterns.html)中有一个完整的部分包含示例代码。

在您的情况下，您可以创建一个非常小的图案单元（高度 = 1），最左边只有一个黑色像素，然后是与下一行的距离相同数量的白色像素。

# c++ - 避免在 C++ 中重新定义

> ID：15935885
> 
> 赞同：0
> 
> 时间：2013-04-10T20:36:10.303
> 
> 标签：c++, arduino, c-preprocessor

我想避免从两个不同的包含文件重新定义如下：

### 文件*ABC.h*

```
extern int v=1; 
```

### 文件*foo.h*

```
#include "ABC.h"
class Foo
#ifdef BLA
: public ABC
#endif

{
    ...
}; 
```

### 文件*bar.h*

```
extern int v=3; 
```

### 主要的：

```
#define BLA
#include <foo.h>
#include <bar.h> 
```

基本上`foo`是我自己写的一个类，`bar`是一个第三方库。但这似乎不起作用。我应该如何解决问题？

抱歉，这有点难以描述，这个例子有点糟糕，因为冲突的部分实际上不是变量，而是类似`#define`并包裹在大块代码中的东西（错误消息是：“__vector_17'的多重定义”）。有没有办法在**不使用命名空间**的情况下解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:42:27.117

使用命名空间可以解决这个问题：

```
namespace foo
{
    int val =1;
}

namespace bar
{
    int val =3;
}

using namespace foo;

int x = val; //Now x will be assigned with 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:46:41.277

命名空间是您所需要的：

```
namespace foo
{
    int v =100;
}

namespace bar
{
    int v =500;
} 
```

# python - 如何使用python将utf-8字符串写入utf-8机器上的utf-8文件

> ID：15935886
> 
> 赞同：0
> 
> 时间：2013-04-10T20:36:09.067
> 
> 标签：python, file, encoding, utf-8, codec

不是第一次，这让我感到困惑：

使用以下命令打开文件`codecs.open`：

```
cfh = codecs.open('/tmp/ddfh', 'wb', 'utf-8') 
```

尝试编写字符串 sa：

```
In [109]: sa
Out[109]: '\xe6\x96\xb0 \xe9\x97\xbb\xe3\x80\x80\xe7\xbd\x91 \xe9\xa1\xb5\xe3\x80\x80\xe8\xb4\xb4 \xe5\x90\xa7\xe3\x80\x80\xe7\x9f\xa5 \xe9\x81\x93\xe3\x80\x80\xe9\x9f\xb3 \xe4\xb9\x90\xe3\x80\x80\xe5\x9b\xbe \xe7\x89\x87\xe3\x80\x80\xe8\xa7\x86 \xe9\xa2\x91\xe3\x80\x80\xe5\x9c\xb0 \xe5\x9b\xbe'

In [110]: print sa
新 闻　网 页　贴 吧　知 道　音 乐　图 片　视 频　地 图

In [111]: sa.encode()
---------------------------------------------------------------------------
UnicodeDecodeError                        Traceback (most recent call last)
/home/za/tmp/<ipython-input-111-dea686030e89> in <module>()
----> 1 sa.encode()

UnicodeDecodeError: 'ascii' codec can't decode byte 0xe6 in position 0: ordinal not in range(128)

In [112]: sa.decode()
---------------------------------------------------------------------------
UnicodeDecodeError                        Traceback (most recent call last)
/home/za/tmp/<ipython-input-112-a79b22010b0e> in <module>()
----> 1 sa.decode()

UnicodeDecodeError: 'ascii' codec can't decode byte 0xe6 in position 0: ordinal not in range(128)

In [113]: sa.encode('utf-8')
---------------------------------------------------------------------------
UnicodeDecodeError                        Traceback (most recent call last)
/home/za/tmp/<ipython-input-113-ed97f8f61eb5> in <module>()
----> 1 sa.encode('utf-8')

UnicodeDecodeError: 'ascii' codec can't decode byte 0xe6 in position 0: ordinal not in range(128)

In [114]: sa.decode('utf-8')
Out[114]: u'\u65b0 \u95fb\u3000\u7f51 \u9875\u3000\u8d34 \u5427\u3000\u77e5 \u9053\u3000\u97f3 \u4e50\u3000\u56fe \u7247\u3000\u89c6 \u9891\u3000\u5730 \u56fe'

In [115]: cfh.write(sa.decode('utf-8')) 
```

它在上面工作，但在另一台机器、相同的 Ubuntu 机器、相同的 $LANG 环境中**失败。**我一直在点击“'ascii'编解码器不能......”

**谁能指点我一个好的文档？**关于模块的官方文档`codecs`对我不利。

===

问题来自代码：

```
# encoding=utf-8
# ......

def write_video_info_file(folder, filename, infos):
    # infos : a list of list, lines of text grouped by topic, results of language translations.

    absfn = os.path.join(folder, filename)
    with codecs.open(absfn, mode='wb', encoding='utf-8') as fh:
        for vinfo in infos:
            for v in vinfo:
                fh.write(v)
            fh.write("\n\n" + vi_delimit + "\n\n") 
```

这在我的本地机器上测试OK，并部署到远程机器上，然后它得到了很多： `UnicodeDecodeError: 'ascii' codec can't`.

在它之后，几乎所有`mode=`的，没有尝试过编解码器就打开了。

```
$ echo $LANG  #  en_US.UTF-8 
```

Python 2.7.3

Ubuntu 12.04

LANG=en_US.UTF-8

语言=

LC_ALL=

===

我得到了解决方案，使用它来确保所有字符串都是 utf-8：

```
if isinstance(mystring, str):
    mystring = mystring.decode('utf-8') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:39:05.283

您的数据*已*编码为 UTF-8。只需打开文件*而不* `codecs.open()`直接写入数据：

```
with open('/tmp/ddfh', 'wb') as output:
    output.write(sa) 
```

Unicode 编码/解码错误通常是因为您混合了字节字符串和 Unicode 字符串；连接、比较、`str.join()`在需要时使用`unicode.join()`等。

你可能想阅读 Python 和 Unicode：

*   [每个软件开发人员绝对、绝对必须了解 Unicode 和字符集（没有任何借口！）](http://joelonsoftware.com/articles/Unicode.html)作者：Joel Spolsky

*   Python [Unicode HOWTO](http://docs.python.org/2/howto/unicode.html)

*   Ned Batchelder 的[实用 Unicode](http://nedbatchelder.com/text/unipain.html)

# css - HTML 5 验证 CSS Pseudoclass 无效使用所需属性

> ID：15935889
> 
> 赞同：0
> 
> 时间：2013-04-10T20:36:30.653
> 
> 标签：css, html

当我运行 html 时，我的测试输入字段会自动标记为无效，因为它是必填字段，因此应用了 css。有没有办法让这个特定的 css 只在表单提交后才应用？

**html**

```
<form name="test" action="index.html" method="get">
<label>test: <input name="test1" id="test" placeholder="enter text here" autofocus required></label>
<p><input type="submit"></p>
</form> 
```

**CSS**

```
#test:invalid {
background-color:red;
} 
```

# sql-server - 如何在 sql server 中模拟不可重复读取

> ID：15935891
> 
> 赞同：1
> 
> 时间：2013-04-10T20:36:36.453
> 
> 标签：sql-server, transactions, deadlock

我在 msdn 上阅读了以下代码行，但对此我不清楚并想进行模拟。

> 当第二个事务多次访问同一行并且每次读取不同的数据时，就会发生不可重复读取。这涉及对同一行的多次读取。每次，信息都会被另一笔交易更改。

如果行被第一个事务锁定在读取提交的隔离级别下，我不明白第二个事务如何访问数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:53:07.760

你可以用这种方式模拟它。打开 Microsoft SQL 管理工作室。打开 2 个选项卡并在两个选项卡中开始交易。

在第一个窗口中选择数据并在第二个窗口中对其进行修改并提交更改。

然后，重新运行之前的选择。数据已更改。**这是不可重复的读取现象**。 

![在此处输入图像描述](https://i.stack.imgur.com/rfigN.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:51:57.877

> 当第二个事务多次访问同一行并且每次读取不同的数据时，就会发生不可重复读取。这涉及对同一行的多次读取。每次，信息都会被另一笔交易更改。

这里的重点是：

*   事务 A 使用读取数据`SELECT .....`并在它读取的那些行上获取共享（读取）锁 - 但就在它读取它们时（并在第一次读取它们后*立即释放锁*

*   事务 B 现在可以修改其中一些行

*   当事务 A 返回并再次读取这些行时，使用`SELECT ...`- 这次可能会得到不同的结果。

这是您在使用默认设置时遇到的问题- 读取操作**仅在读取**`READ COMMITTED`时获取共享锁，并在读取数据后立即释放它。之后，其他事务*可以*（并且将会！）修改数据，因此再次读取相同的行可能会产生不同的结果。

 ***使用`REPEATABLE READ`，读取事务在它读取的那些行上**保持共享（读取）锁，****直到事务结束**- 从而防止其他事务在结束之前修改数据。

真的 - 任何使用默认`READ COMMITTED`隔离级别的读取操作都是*不可重复*读取。无需模拟 - 这些都是真实的东西！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:52:26.363

在 SSMS 中打开 2 个查询窗口

第一个查询：

```
set transaction isolation level read committed
begin transaction
select * from _tmp 
```

第二

```
update _tmp set id = 2 
```

创建和填充表

```
create table _tmp ( id int)
insert _tmp (id )values(1) 
```

运行第一个查询，然后运行第二个，然后`select`从第一个查询运行语句

你会看到`1`第一次和`2`第二次

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T20:55:59.327

> 如果行被第一个事务锁定，第二个事务如何访问数据

您假设第一个事务将锁定该行是错误的。它只会锁定它很短的时间，刚好够读它，然后释放锁。随后的读取将*再次*锁定它，因此在此期间该行可能发生任何事情。

考虑这个时间序列，看看事务 T1 在读提交隔离下如何看到同一个 SELECT 的不同结果：

```
T1: begin transaction
T1: select * from table <-- returns row 1 and row 2
T2: begin; insert into table row 3; commit;
T1: select * from table <-- returns row 1, row 2 and row 3
T3: begin; delete row 2 from table ; commit;
T1: select * from table <-- returns row and row3 
```***

# python - Python：QSqlDatabase：未加载 QMYSQL 驱动程序

> ID：15935892
> 
> 赞同：0
> 
> 时间：2013-04-10T20:36:36.737
> 
> 标签：python, mysql, pyqt, pyside

我正在从[http://www.python.org/getit/运行 python 2.7.3 (python-2.7.3.amd64.msi)](http://www.python.org/getit/)

我正在使用这些安装程序：[http ://www.lfd.uci.edu/~gohlke/pythonlibs/](http://www.lfd.uci.edu/~gohlke/pythonlibs/)

*   PyQt-Py2.7-x64-gpl-4.9.6-1.exe
*   PySide-1.1.2.win-amd64-py2.7.exe
*   MySQL-python-1.2.4.win-amd64-py2.7.exe

我还尝试了来自以下位置的 pyqt 和 pyside 二进制文件：

*   [http://www.riverbankcomputing.com/software/pyqt/download](http://www.riverbankcomputing.com/software/pyqt/download)
*   [http://qt-project.org/wiki/PySide_Binaries_Windows](http://qt-project.org/wiki/PySide_Binaries_Windows)

我在以下 python 代码中收到错误“QSqlDatabase：未加载 QMYSQL 驱动程序”。我最好的猜测是上面的 pyside 和 pyqt 二进制安装程序没有构建 qt 以包含 QMYSQL？任何人都可以确认并且更重要的是，将我引导到构建了 QMYSQL 驱动程序的安装程序？我不准备尝试自己编译 qt 库。任何帮助表示赞赏。

```
import sys

from showrec import *    # import qtdesigner ui (converted using pyside-uic)

from PySide import QtGui, QtSql

#===================================================================
# 
#===================================================================

def createConnection():

    db = QtSql.QSqlDatabase.addDatabase('QMYSQL')

    db.setHostName('localhost')
    db.setDatabaseName('mydatabase')
    db.setUserName('userid')
    db.setPassword('password')
    db.open()
    print (db.lastError().text())
    return True

#===================================================================
#
#===================================================================

class MyForm(QtGui.QDialog):

    def __init__(self, parent=None):

        #super(MyForm, self).__init__(parent)   # I suspect this is needed?

        QtGui.QWidget.__init__(self,parent)
        self.ui = Ui_Dialog()
        self.ui.setupUi(self)

        self.model = QtSql.QSqlDatabase(self)
        self.model.setTable("products")
        self.model.setEditStrategy(QtSql.QSqlTableModel.OnManualSubmit)
        self.model.select()
        self.ui.tableView.setModel(self.model)

#===================================================================
# main
#===================================================================

if __name__ == "__main__":

    app = QtGui.QApplication(sys.argv)

    if not createConnection():
        sys.exit(1)

    myapp = MyForm()
    myapp.show()

    sys.exit(app.exec_()) 
```

这是gui代码：

```
from PySide import QtCore, QtGui

class Ui_Dialog(object):
    def setupUi(self, Dialog):
        Dialog.setObjectName("Dialog")
        Dialog.resize(400, 300)
        self.tableView = QtGui.QTableView(Dialog)
        self.tableView.setGeometry(QtCore.QRect(20, 20, 256, 192))
        self.tableView.setObjectName("tableView")

        self.retranslateUi(Dialog)
        QtCore.QMetaObject.connectSlotsByName(Dialog)

    def retranslateUi(self, Dialog):
        Dialog.setWindowTitle(QtGui.QApplication.translate("Dialog", "Dialog", None, QtGui.QApplication.UnicodeUTF8)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T08:52:18.923

关于 PySide，官方的 64 位 windows 安装程序（从 PySide 主页下载）确实只支持 QSQLITE 驱动程序。32 位安装程序支持 QSQLITE QODBC3 QODBC QPSQL7 QPSQL 驱动程序。R。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-03T15:11:54.257

我决定使用 pyqt4 而不是 pyside，因为安装程序包含 QMYSQL 驱动程序。

# regex - 正则表达式 a 或 b

> ID：15935893
> 
> 赞同：5
> 
> 时间：2013-04-10T20:36:37.910
> 
> 标签：regex

如何制作仅匹配 r.js 或 build.js 但不匹配 router.js 的正则表达式（例如）？
我做了这个：`/^r.js$|^build.js$/`但我觉得有一种方法可以删除 ^ 和 $。如果我删除它们，router.js 就会匹配。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-10T20:39:50.413

尝试：

```
/^(r|build)\.js$/ 
```

'。' 应该逃脱。如果 ^ 被删除，它将匹配 router.js，如果 $ 被删除，它将匹配 r.jsx。所以他们是需要的。

# javascript - 每 24 小时进行一次不同的 Google 地球之旅（无人驾驶）

> ID：15935896
> 
> 赞同：1
> 
> 时间：2013-04-10T20:36:44.373
> 
> 标签：javascript, google-chrome, google-earth-plugin, page-refresh, browser-refresh

我有一些代码每 24 小时生成一个新的 KMZ 文件（每次游览都有很多点，大约需要 18 小时才能完成）。我有一个带有 Google 地球插件的网页，它会自动加载并运行游览（称为 ​​latest.kmz）。

现在我正在尝试在大厅中设置一台无人计算机，浏览器（Chrome）指向我的网站。每天早上，例如早上 8 点，我希望网页刷新并开始新的游览。

不幸的是，即使我在夜间覆盖了 latest.kmz，当页面刷新时（使用 http://...etc...">）它仍然继续使用 latest.kmz 的缓存版本。

如何强制它从磁盘重新加载最新版本的 kmz？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:44:03.227

如果您还没有这样做，请使用内容标头强制缓存不验证。这可以通过使用以下标头触发您的 KMZ 文件来实现：

```
Cache-Control: max-age=0, must-revalidate 
```

这将强制用户代理立即考虑文件陈旧，这意味着在下一次请求时，它不会使用其缓存。检查您当前的标题以防万一，因为您可能已经在该标题中有一些东西 - 并相应地进行调整。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T23:28:14.123

有两种方法，您可以简单地将时间戳或随机查询字符串附加到 KMZ 请求 url。这实质上使每个对数据的请求都是唯一的，从而避免了任何缓存问题。

例如，您可以创建 KMZ 的 url 并像这样附加一个 UNIX 时间戳。

```
var kmz = "http://localhost/your.kmz?x=" + (new Date()).getTime(); 
```

像这样产生独特的结果。

```
http://localhost/your.kmz?x=1365635454757
http://localhost/your.kmz?x=1365635478881 
```

另一种方法是使用网络链接（如果您还没有这样做）加载您的 KMZ 文件，这样您就可以准确控制何时再次检查新数据，从而避免缓存问题。这样，页面根本不需要刷新 - kml 文件中指向您的数据的简单网络链接可以通过将[刷新间隔](https://developers.google.com/kml/documentation/kmlreference#refreshinterval)设置为重新加载文件之前的秒数来工作。

就像是。

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
    <NetworkLink>
    <name>your file</name>
    <flyToView>1</flyToView>
    <Link>
      <href>http://localhost/your.kmz</href>
      <refreshMode>onInterval</refreshMode>
      <refreshInterval>86400</refreshInterval><!-- 24 hours -->
    </Link>
  </NetworkLink>
</kml> 
```

# javascript - 通过域名输入时如何只显示一次页面预加载器？

> ID：15935900
> 
> 赞同：6
> 
> 时间：2013-04-10T20:36:52.817
> 
> 标签：javascript, jquery, ajax, preloader

所以，我在主页上有 jQuery 页面预加载器，如下所示：

```
<script type="text/javascript">
    $(window).load(function() {
        $("#preloader").delay(700).fadeOut("slow");
    }) 
```

```
<div id="preloader" class="preloader"></div> 
```

这显示了 4 次：

1.  当我通过域名进入网站时；
2.  当我按 F5 刷新主页时；
3.  当我单击徽标时（单击该徽标时我必须转到主页）；
4.  当我单击“主页”菜单项时。但我只想在前两次展示它。因此，我想到的第一个想法是删除`div`类，以便在我单击 JS 的徽标或菜单项时不在整个页面上显示预加载器图像。并使用了这个：

> document.getElementById("preloader").className = 'test';

但是后来...我意识到通过单击菜单项再次加载主页，我创建了文档的新副本，因此我的预加载器再次拥有他的课程并出现了。所以，我决定使用 AJAX 并且不通过单击菜单项或徽标来重新加载整个页面。现在我用这个：

```
 <script type="text/javascript">
        $(document).ready(function(){
             $("#blog, #logo").click(function(){
                 $("#container").load("/blog");
                 document.getElementById("preloader").className = 'test';
             });
        });
    </script> 
```

因此，当我单击徽标或菜单项时，我会在容器中加载名为“博客”的类别。我的侧边栏看起来像这样：

```
...        
<a href="javascript:;" id="logo"><i class="logo"></i></a>
...
<li class="m_blog"><a id="blog" href="javascript:;"><i class="icon"></i>Blog</a></li>
... 
```

所以，它有效！预加载器仅在您通过域名打开站点时出现。但是出现了1个问题。当我打开类别«视频»我有这样的地址：mysite.com/video/

当我通过徽标或菜单回到主页时，我有相同的地址！因为没有重新加载整个页面和地址的内容加载不会改变。我该如何解决？请帮帮我！我只想显示我的预加载器一次：当我通过域名或按 F5 刷新主页时。我已经头晕了，因为我只知道 HTML 和 CSS，但是今天开始学习 AJAX 和 jQuery。在这件事上帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T19:27:04.403

所以，我自己解决了问题。但是，无论如何，感谢@prabeen-giri 帮助我以正确的方式思考。首先，我需要解释预加载器机制。看看CSS：

```
position: fixed;
display: block;
top: 0;    /* making preloader cover all screen */
right: 0;
left: 0;
bottom: 0;
background-repeat: no-repeat;
background-position:center; center;
background-size: auto auto;
background-image: url(../images/preload.png); /* your picture should be here */
background-color:#000; 
z-index:99; /* must be the highest number of all others to cover them all */ 
```

因此，您的预加载器只是一张图片或其他覆盖所有窗口并在加载整个内容时平滑消失（通过 jQuery）的东西。

```
<div id="preloader" class="preloader"></div> 
```

这是脚本：

```
<script type="text/javascript">  
     $(window).load(function() {
          $("#preloader").delay(700).fadeOut("slow");}); 
</script> 
```

为了解决我的问题并在通过域名进入站点时只显示一次预加载器，我们需要使用 cookie。有 2 个 cookie 辅助函数（来自[Quirksmode](http://www.quirksmode.org/js/cookies.html)）：

```
function createCookie(name,value,days) {
if (days) {
    var date = new Date();
    date.setTime(date.getTime()+(days*24*60*60*1000));
    var expires = "; expires="+date.toGMTString();
}
else var expires = "";
document.cookie = name+"="+value+expires+"; path=/";
}

function readCookie(name) {
var nameEQ = name + "=";
var ca = document.cookie.split(';');
for(var i=0;i < ca.length;i++) {
    var c = ca[i];
    while (c.charAt(0)==' ') c = c.substring(1,c.length);
    if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
}
return null;
} 
```

所以，我们需要输入自己的cookie来为脚本的运行创造条件。最初我们创建的 cookie 等于**null**，这个相等将是运行脚本的条件。之后我们设置 cookie 一些值以不再启动 jQuery。这是代码：

```
<script type="text/javascript">  
    $(window).load(function() {
        if (readCookie('referer') == null){
            $("#preloader").delay(700).fadeOut("slow");}
        createCookie('referer',1,0);
     }); 
</script> 
```

但是刷新页面后如何去掉我们的preloader图片和背景呢？因为我们只是根据我们的条件禁用 jQuery fadeOut 进程。图片和黑色背景一直覆盖着我们的窗户，不会消失......

让我们创建新的条件并将其放入

```
<script>
    if (readCookie('referer') == null) {
        document.write("<style>.preloader {background-image: url(../images/preload.png); background-color:#000; z-index:99;}</style>");
    }
</script> 
```

通过这种方式，我们将图像、z-index 和背景设置为预加载器类。只有当用户通过域名进入网站**或**清除了他的 cookie 并刷新页面（这似乎不太可能）时，我们的 cookie 才等于**null 。**如果 cookie 等于**1**，正如我们上面设置的，我们的预加载器将显示但没有图片和背景，我们的 jQuery fadeOut 也不会运行！所以，我的问题如我所愿地解决了，预加载器只会出现一次。再次感谢@prabeen-giri！

 ***** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:04:11.477

**编辑：*对不起，我不得不编辑整个事情***

事情是这样的，您在每种情况下都向服务器发送 http 请求，这实质上意味着您在初始状态下重新加载 DOM，然后您使用 Javascript 在该状态下工作。

使用 GET 方法会容易得多，但正如你所说，你只是在学习。您可以改用 cookie，

这是cookie助手功能

```
function setCookie(c_name,value,exdays)
{
var exdate=new Date();
exdate.setDate(exdate.getDate() + exdays);
var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
document.cookie=c_name + "=" + c_value;
} 

function getCookie(c_name)
{
var i,x,y,ARRcookies=document.cookie.split(";");
for (i=0;i<ARRcookies.length;i++)
{
  x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));
  y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);
  x=x.replace(/^\s+|\s+$/g,"");
  if (x==c_name)
    {
    return unescape(y);
    }
  }
} 
```

每当您单击主页/徽标调用时

```
setCookie('referer','home',7), setCookie('referer','logo',7); 
```

现在，

```
 $(window).load(function() {
    if (getCookie('referer') != 'home' || getCookie('referer') != 'logo'){ 
     $("#preloader").delay(700).fadeOut("slow");
    } 

    setCookie('referer',null,7); 
 }); 
```

我认为应该工作。****

# asp.net-mvc-3 - Membership.GetAllUsers() System.Data.SqlClient.SqlException：用户无权执行此操作

> ID：15935902
> 
> 赞同：1
> 
> 时间：2013-04-10T20:37:00.180
> 
> 标签：asp.net-mvc-3, asp.net-membership, connection-string, visual-web-developer-2010

我使用 Visual Web Developer 2010 Express 创建了一个小型 Web 应用程序。在我部署我的网站并转到第一页后，即为应用程序提供用户列表的登录页面后，我收到此错误：

异常详细信息：System.Data.SqlClient.SqlException：用户无权执行此操作。

源错误：

```
Line 22:         public ActionResult LogOn()
Line 23:         {
Line 24:             var users = Membership.GetAllUsers().Cast<MembershipUser>().ToList();
Line 25:             SelectList usernames = new SelectList(users);
Line 26:             ViewBag.UserNames = usernames; 
```

这是我的 connectionStrings 设置：

```
<connectionStrings>
   <add name="ApplicationServices"
     connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true"
     providerName="System.Data.SqlClient" />
</connectionStrings> 
```

为什么会出现这个错误？任何帮助深表感谢。我目前正在 Windows 2008 Server 上开发它并在同一台机器上测试它的部署。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:50:49.890

我发现我的连接字符串有问题。它是为用户实例化而设置的，根据这篇 Microsoft[文章](http://support.microsoft.com/kb/2002980)：

> 在 IIS 7.5 上运行且依赖于 SQL Server Express 用户实例化的 Web 应用程序将无法在 Windows 7 客户端和 Windows Server 2008 R2 上使用默认的 IIS 7.5 安全配置运行

本文还建议避免在生产中使用用户实例。我发现这篇[文章](https://serverfault.com/questions/319912/i-am-very-confused-with-sql-server-express-instances-what-am-i-actually-connec)帮助我将数据库托管在一个普通的 .\SQLExpress 实例中。我将连接字符串更改为：

```
<connectionStrings>
    <add name="ApplicationServices"
     connectionString="Database="app_users";Data Source=.\SQLEXPRESS;Initial Catalog=app_users;Integrated Security=SSPI;"
     providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

在更改上述连接字符串之前，我将 SQL Server Express 中的 aspnetdb.mdf 文件附加到我创建的名为“app_users”的新数据库中。

我不再收到权限错误。

# ios - 在后台停止音频

> ID：15935905
> 
> 赞同：3
> 
> 时间：2013-04-10T20:37:16.507
> 
> 标签：ios, audio, background-process, uilocalnotification

有一个名为 IHeartRadio 的应用程序可让您设置睡眠计时器，该计时器将在指定时间间隔后关闭音频。

您首先选择要收听的电台，然后选择广播电台停止播放的睡眠时间。该应用程序不需要在前台发生这种情况。

应用程序如何在后台停止音频？

一种理论是设置带有静音音频的 UILocalNotification。然后 UILocalNotification 将接管设备的音频，实际上使正在播放的任何音频静音。那没有用。

计时器不在后台工作，这在后台基于时间的行为方面并没有留下太多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:37:39.270

`When the UIBackgroundModes key contains the audio value, the system’s media frameworks automatically prevent the corresponding app from being suspended when it moves to the background. As long as it is playing audio or video content, the app continues to run in the background. However, if the app stops playing the audio or video, the system suspends it.`

来自[iOS 应用程序编程指南](http://developer.apple.com/library/ios/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW24)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T21:05:15.023

您可以`applicationDidEnterBackground`在您的事件中使用事件`AppDelegate`来处理应用程序进入后台并在此方法中停止音频。

```
- (void)applicationDidEnterBackground:(UIApplication *)application
{
    // Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later. 
    // If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.

    // add your audio stopping code ..
} 
```

# javascript - Javascript问题重新形成重置

> ID：15935907
> 
> 赞同：0
> 
> 时间：2013-04-10T20:37:31.477
> 
> 标签：javascript, forms, reset

我遇到了一个完美提交的小型 javascript 表单的问题，它会显示成功消息但无法重置表单。数据保持可见，直到您手动刷新页面。

代码是：

```
jQuery(document).ready(function(){

    $('#contactform').submit(function(){

        var action = $(this).attr('action');

        $("#message").slideUp(750,function() {
        $('#message').hide();

        $('#submit')
            .after('<img src="images/ajax-loader.gif" class="loader" />')
            .attr('disabled','disabled');

        $.post(action, {
            name: $('#name').val(),
            email: $('#email').val(),
            phone: $('#phone').val(),
            subject: $('#subject').val(),
            comments: $('#comments').val(),
            verify: $('#verify').val()
        },
            function(data){
                document.getElementById('message').innerHTML = data;
                $('#message').slideDown('slow');
                $('#contactform img.loader').fadeOut('slow',function(){$(this).remove()});
                $('#submit').removeAttr('disabled');
                if(data.match('success') != null);

            }
        );

        });

        return false;

    });

}); 
```

我想知道是否可以添加重置命令，但由于我的 java 有限，我不确定在哪里？将不胜感激任何指针或建议。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:46:09.410

您可以将其添加到 中`if (data.match...)`，如下所示：

```
if (data.match("success") != null){
   $('#contactform')[0].reset();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:47:07.527

您需要手动清除/重置表单。当您使用 JQuery 发送请求时，它不像更改浏览器位置的表单操作。

成功发送数据后，只需调用 RESET 即可。

有关更多信息，请参阅：[http ://www.w3schools.com/jsref/met_form_reset.asp](http://www.w3schools.com/jsref/met_form_reset.asp)

另一方面，如果您想将表单值重置为您指定的默认值，您可以创建一个函数，例如：

```
function resetFormValues() 
{ 
$('#name').val('name'); 
$('#email').val('email'); 
etc..
} 
```

并调用 resetFormValues(); 从您的代码中，例如：

```
if (data.match("success") != null){
   resetFormValues();
} 
```

# pyramid - 金字塔：在没有请求对象的情况下构造 route_url

> ID：15935908
> 
> 赞同：5
> 
> 时间：2013-04-10T20:37:36.703
> 
> 标签：pyramid, web-frameworks, parser-generator

我使用 yapps 为金字塔内的 LaTex-ish 语言生成解析器（例如，将内容翻译`\begin{itemize}`为相应的`<ul>`-Tags）。一个命令 (ie `\ref{SOMEID}`) 应该通过调用`route_url`(or `route_path`) 来构造一条路由并将 id 传递给它。由于此调用发生在 yapps 生成的代码和我定义的语法的深处，因此我看不到将请求对象传递给它的任何可能性。

是否有某种全局请求对象？或者，既然我预见到我不应该使用它，是否有可能在没有请求对象的情况下构造一条路由（取决于参数）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-10T22:35:28.743

`route_url`需要请求和注册表 ( `request.registry`)。它生成与请求相关的 url，并从注册表访问所有路由和其他设置的列表。因此，您*必须*使用您关心的参数生成一个虚拟请求。例如：

```
from pyramid.request import Request

request = Request.blank('/', base_url='https://example.com/prefix')
request.registry = config.registry 
```

现在您可以将此请求存储在任何地方，最好代表您网站的所有内容：主机名/端口 ( `example.com:443`)、您的应用程序安装在 ( `/prefix`) 的前缀、uri 方案 ( `https`)。

如果您需要将其深入到您的代码中，您可能必须将其设为全局或将其附加到您可用的某个上下文/注册表中，但我所展示的是如何发出您需要的请求。

# javascript - 固定导航上所有div上方的Jquery滑块

> ID：15935910
> 
> 赞同：0
> 
> 时间：2013-04-10T20:37:40.997
> 
> 标签：javascript, jquery, html, slider, absolute

我正在编写一个页面，上面有一个 jquery 滑块，称为 all in one 滑块。我选择在顶部放置一个固定导航，在滚动过程中始终可见。问题是当我滚动经过滑块时，滑块位于导航上方。

我尝试过定位等，但它不起作用并且 z-index:1000;

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:39:55.043

尝试将滑块的 z-index 设置为负数：

```
#slider {
z-index:-99;
} 
```

将 z-index 设置为 nav 正数。确保它们也在同一个div中，否则它将不起作用

# .net - 用于移动数据的基于 FTP 的方法

> ID：15935916
> 
> 赞同：0
> 
> 时间：2013-04-10T20:37:58.790
> 
> 标签：.net, architecture, ftp

所以，我们有应用程序在某个时间点运行它自己的进程并产生信息，现在这些信息基本上被其他几个应用程序消耗。当前解决方案的方法是让这个源应用程序创建一个文件并通过 FTP 将其发送给每个消费者。发送过来的数据将是大约 2-3 百万条记录。我认为 FTP 是一种用于此目的的旧技术，并且有更好的方法来解决这个问题。有什么想法吗？

问候，内鲁兹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:25:58.010

套接字文件传输？设置一个计时器来检查数据的版本号或校验和，以查看它是否已更新，然后如果数据比当前设置的数据更新，则启动传输。

如果您没有静态 IP，您可以使用动态 DNS 服务（免费/非常便宜）。

[http://msdn.microsoft.com/en-us/library/1ew28f56.aspx](http://msdn.microsoft.com/en-us/library/1ew28f56.aspx)

# c - 多次分叉

> ID：15935921
> 
> 赞同：1
> 
> 时间：2013-04-10T20:38:10.867
> 
> 标签：c

所以这是我的代码片段：

```
pid_t children[MAX_PIPES];
for (i = 0; i < numPipes; i++)
{
    pid_t child_pid = fork();
    children[i] = child_pid;

    switch(child_pid)
    {
        case 0:
            // Some code thats executed in the child that executes execv()
            break;
        case -1: // Unable to create child
            perror("fork");
            break;
    }
}
// Wait for children 
for (j = 0; j < numPipes && children[j] != 0; j++)
{
    if (background)
        waitpid(children[j], &status, WNOHANG);
    else
        waitpid(children[j], &status, 0);
} 
```

目前，当我只调用一次 execv() 时它工作正常，但我试图在已经分叉的子进程中一个接一个地使用 execv() 执行多个命令。

我该如何添加该功能？我试图在孩子内部的循环中添加另一个 fork() 但它没有成功。

任何想法将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:55:50.053

`execv`与其他`exec()`命令一样，除非失败，否则不会返回。新程序的上下文被加载以代替当前程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:52:08.423

您的问题是`execv`用被调用的命令替换整个子进程，因此您不能将多个 execv 命令放入子进程中。

如果你想有多个命令，你必须`fork()`，`execv()`每一个。您可以使用`system()`，但它不会以与`execv()`（它启动 shell）相同的方式处理参数。

如果你想运行多个命令，那么你应该做第二个`fork()`......`execv()`使用类似于：

```
int
subv(char *path, char * const argv[])
{
  int ret;
  pid_t a_pid = fork();
  if (a_pid == -1) return -1;
  if (a_pid != 0) { wait(&ret); return ret; }
  return execv(path, argv);
} 
```

您将所有 execv 调用替换为 subv() 并适当地处理返回码。

# c++ - MFC CFileDialog 只打开选择文件

> ID：15935924
> 
> 赞同：0
> 
> 时间：2013-04-10T20:38:19.517
> 
> 标签：c++, visual-c++, mfc

使用 CFileDialog 作为文件打开，我需要允许用户只选择显示在对话框列表区域中的文件，例如通过单击它。我们不希望用户能够在 File Name 控件中键入名称。OPENFILENAME (OFN) 结构有几个不同的标志（[http://msdn.microsoft.com/en-US/library/ms646839%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-US/library/ms646839%28v=vs.80%29.aspx)），但我没有看到一个可以阻止用户输入文件名。

我看到的最接近的是OFN_FILEMUSTEXIST，但它只指定文件存在；它仍然允许用户输入名称。

有没有办法在不继承新类的情况下做到这一点？

**更多信息**

我们需要防止他们输入文件名，因为他们可能会打开不合适的文件名。使用该`lpszFilter`参数，我们过滤文件名，因此它只显示文件名中带有*ABC*的文件（而不是扩展名）。因此，如果他们输入文件名，他们可以输入类似`myCoolFileDEF.ext`. 如果文件存在，它将继续并让他们打开它（对话框将关闭而没有错误消息），即使他们只应该打开文件名中带有*ABC*的文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T22:28:07.907

由于您使用的是 MFC，因此只需[继承一个 CFileDialog 并禁用文件名编辑控件和组合框](http://msdn.microsoft.com/en-us/library/5kbfsahf%28v=vs.110%29.aspx)。我看不出使用 CFileDialog 和编写另一个 OFNHookProc 回调的意义，但如果你愿意，你可以从[GetOpenFileName开始。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646927%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T06:51:55.880

作为先前的答案，您可以在对话框中查找文件名控件并将其禁用。不过，这并非没有惩罚 - 如果您打开 CFileDialog 挂钩回调逻辑，您会在 Vista 及更高版本上获得“旧样式”文件对话框，而不是“新样式”对话框。“新样式”文件对话框在可以自定义的内容方面受到更多限制，并且据我所知，它不提供获取文件名控件的受支持方式。

阅读你的问题，我的第一直觉是你过度设计了你的解决方案：如果你提供一个过滤器，那么用户必须很麻烦才能选择错误的文件类型，而大多数用户不会这样做那。如果他们这样做，则用户可能比您的程序更了解。如果是我，我只会使用过滤器，然后在文件对话框关闭后，检查返回的文件名 - 如果它与所需的模式不匹配，我会发出一个消息对话框询问用户是否他们'真的确定，如果他们坚持要打开文件，无论如何都要打开文件。

# c# - 如何使用 DataContracts 正确序列化从集合派生的类

> ID：15935927
> 
> 赞同：1
> 
> 时间：2013-04-10T20:38:32.513
> 
> 标签：c#, .net, serialization, datacontractserializer, xmlserializer

在 C# 和 .NET 4.5 中，我正在通过 DataContract 序列化实现 XML 生成/解析，这看起来非常有效。但是，我在几种情况下遇到了一些问题，希望有人可以帮助我。

相关的类有以下 5 个（加上一些嵌入对象）：

```
[DataContract]
public abstract class ItemList<T> : List<T>, IList
  {
  .....
  }

[DataContract]
public class CashFlowList : ItemList<CashFlow>
  {
  .....
  }

[DataContract]
public class CashFlow : ItemList<CashFlowPayment>  
  {
  .....
  }

[DataContract]
public class CashFlowPayment : ListItem, IDataImportExport
  {
  .....
  }

[DataContract]
public abstract class ListItem : System.IComparable, IList
  {
  .....
  } 
```

使用 DataContractSerializer（在 CashFlowList 类型上）时，生成的 XML 如下所示：

```
<CashFlowList xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.datacontract.org/2004/07/FinancialData">
  <_items>
    <CashFlow>
      <_items>
        <CashFlowPayment>
          <ID>-1</ID>
          <ProbDist xmlns:d6p1="http://schemas.datacontract.org/2004/07/ProbabilityDistributions" i:nil="true" />
          <UseProbabilityDistribution>true</UseProbabilityDistribution>
          <ValidFrom>0001-01-01T00:00:00</ValidFrom>
          <ValidThrough>9999-12-31T23:59:59.9999999</ValidThrough>
          <Amount>4500</Amount>
          <Ccy i:nil="true" />
          <Date>2012-02-03T00:00:00</Date>
          <DaysFromStartDate>-1</DaysFromStartDate>
        </CashFlowPayment>
        <CashFlowPayment>
          <ID>-1</ID>
          <ProbDist xmlns:d6p1="http://schemas.datacontract.org/2004/07/ProbabilityDistributions" i:nil="true" />
          <UseProbabilityDistribution>true</UseProbabilityDistribution>
          <ValidFrom>0001-01-01T00:00:00</ValidFrom>
          <ValidThrough>9999-12-31T23:59:59.9999999</ValidThrough>
          <Amount>-30000</Amount>
          <Ccy i:nil="true" />
          <Date>2013-04-10T00:00:00+02:00</Date>
          <DaysFromStartDate>465</DaysFromStartDate>
          <DaysUntilEndDate>-1</DaysUntilEndDate>
          <IsPerpetual>false</IsPerpetual>
          <PaymentType>Unknown</PaymentType>
          <Schedule xmlns:d6p1="http://schemas.datacontract.org/2004/07/Schedules" i:nil="true" />
        </CashFlowPayment>
        <CashFlowPayment i:nil="true" />
        <CashFlowPayment i:nil="true" />
      </_items>
      <_size>2</_size>
      <_version>3</_version>
      <ID>-1</ID>
      <Name></Name>
      <ProbDist xmlns:d4p1="http://schemas.datacontract.org/2004/07/ProbabilityDistributions" i:nil="true" />
      <UseProbability>false</UseProbability>
      <ValidFrom>0001-01-01T00:00:00</ValidFrom>
      <ValidThrough>9999-12-31T23:59:59.9999999</ValidThrough>
      <BaseCCY></BaseCCY>

 ..............................

       <StartDate>2012-05-09T00:00:00</StartDate>
      <SumOfNegativePayments>-30000</SumOfNegativePayments>
      <SumOfPositivePayments>4500</SumOfPositivePayments>
      <ValueDate>0001-01-01T00:00:00</ValueDate>
      <XMLCashFlowElementName i:nil="true" />
      <XMLPaymentElementName i:nil="true" />
      <XMLPaymentsElementName i:nil="true" />
    </CashFlow>
    <CashFlow i:nil="true" />
    <CashFlow i:nil="true" />
    <CashFlow i:nil="true" />
  </_items>
  <_size>1</_size>
  <_version>1</_version>
  <ID>-1</ID>
  <Name></Name>
  <ProbDist xmlns:d2p1="http://schemas.datacontract.org/2004/07/ProbabilityDistributions" i:nil="true" />
  <UseProbability>false</UseProbability>
  <ValidFrom>0001-01-01T00:00:00</ValidFrom>
  <ValidThrough>9999-12-31T23:59:59.9999999</ValidThrough>
</CashFlowList> 
```

生成的 XML 是正确的 - 但有一些怪癖：首先是 <_items> 元素，我猜这些元素是序列化程序管理输出所必需的。其次，您会注意到每个集合 - 在 <_items> 元素中始终至少有 4 个子元素 - 例如，将另一个 CashFlow 添加到外部将导致只有 2 个元素 - 为什么，有没有办法绕过那 ？

用 [CollectionDataContract] 替换一个或多个 [DataContract] 属性 - 无论属性中设置了哪些属性 - 将按预期生成语法正确的 XML 输出，但现在 - 对于每个具有 [CollectionDataContract] 属性的类 - 只有集合*项*是输出 - 而不是类中的常规属性。即一个例子是：

```
<CashFlowList xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.datacontract.org/2004/07/FinancialData">
  <CashFlow>
    <CashFlowPayment>
    ....
    </CashFlowPayment>      
  </CashFlow>    
</CashFlowList> 
```

在上面的示例中，以下元素（在外部 CashFlowList 对象中）已被忽略：

```
 <ID>-1</ID>
  <Name></Name>
  <ProbDist xmlns:d2p1="http://schemas.datacontract.org/2004/07/ProbabilityDistributions" i:nil="true" />
  <UseProbability>false</UseProbability>
  <ValidFrom>0001-01-01T00:00:00</ValidFrom>
  <ValidThrough>9999-12-31T23:59:59.9999999</ValidThrough> 
```

所以我的问题是，这是否是设计使然，并且是不可避免的 - 即当使用 [CollectionDataContract] 属性时，您能否输出从集合派生的类并在输出中包含其他属性？

有趣的是，如果使用 [CollectionDataContract] 属性，您可以毫无问题地使用 XsdDataContractExporter 类生成/检索相应的 XSD（除了由于缺少属性而导致 XML 不完整）。但是，当使用 [DataContract] 属性时，无法生成 XSD（CanExport 方法失败），但 XML 正确且完整，但不是特别清晰。

因此，我非常感谢对此的任何见解和/或想法。

最好的问候和感谢，

迈克尔

# visual-studio - Visual Studio 和 Windows 8 上的 Windows Phone

> ID：15935928
> 
> 赞同：1
> 
> 时间：2013-04-10T20:38:32.467
> 
> 标签：visual-studio, windows-8, windows-phone

目前我在一台新的 Windows 8 机器上使用 Visual Studio 2010，我是一名 Windows Phone 开发人员。Windows Phone SDK 只能在 Windows 8 上的 VS1012 中正常工作。如果是 Windows Phone，在 Visual Studio 2012 Ultimate 上使用 Visual Studio Express 或加载项有什么区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T23:40:33.973

Visual Studio Ultimate 是一个强大的专业和商业工具。它为您提供安装扩展、测试功能和各种您可能需要或可能不需要甚至不知道它们存在的很酷的东西。要详细比较版本，请[转到此处](http://www.microsoft.com/visualstudio/eng/products/compare)。

如果您只是想为 Windows Phone 8 开发应用程序，那么适用于 Windows Phone 的 Visual Studio 2012 Express 就可以了——您可以使用完整的 SDK，从这个意义上说，它应该没有什么不同。您将获得模拟器、Blend 等。但是，如果您也想[为其他平台开发，](http://www.microsoft.com/visualstudio/eng#products/visual-studio-express-products)则必须切换到其他 Express 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:59:53.093

从 SDK 功能的角度来看，没有区别。如果您已经拥有 VS2012 Ultimate，那么您应该将它与加载项一起使用，因为 VS2012 Ultimate 具有超过 VS2012 Express 的所有额外功能。但是，如果您还没有 Ultimate，值得注意的是 VS2012 Express 是免费的，而 Ultimate 相当昂贵 - 所以如果您只想开发 WP 应用程序/游戏，Express 可能足以满足您的需求。

# r - 检测 r 内 Windows 中正在运行的 r 实例的数量

> ID：15935931
> 
> 赞同：3
> 
> 时间：2013-04-10T20:38:45.667
> 
> 标签：r

我有一个我正在创建的 r 代码，我想检测 Windows 中运行的 R 实例的数量，以便脚本可以选择是否运行一组特定的脚本（即，如果已经有 >2 个 R 实例运行做 X，否则 Y）。

有没有办法在 R 中做到这一点？

编辑：这里有一些关于目的的信息：我有一套很长的脚本，用于使用 catnet 库应用贝叶斯网络模型，用于数千个案例。此代码处理每个案例的结果并将结果输出为一个 csv 文件。我尝试过的大多数并行计算替代方案并不理想，因为它们抑制了许多内置的进度通知，因此我一直在 R 的不同实例上运行案例的子集。我知道这有点过时了，但它对我有用，所以我想要一种方法让代码子集根据运行的实例数自动计算案例数。我现在通过在 CMD 中打开多个 Rscript 实例来手动执行此操作，打开配置略有不同的 r 文件以获得如下内容： ![在此处输入图像描述](https://i.stack.imgur.com/MPF2m.png)

```
cd "Y:\code\BN_code"
START "" "C:\Program Files\R\R-3.0.0\bin\x64\Rscript.exe" "process spp data3.r" /b
START "" "C:\Program Files\R\R-3.0.0\bin\x64\Rscript.exe" "process spp data3_T1.r" /b
START "" "C:\Program Files\R\R-3.0.0\bin\x64\Rscript.exe" "process spp data3_T2.r" /b
START "" "C:\Program Files\R\R-3.0.0\bin\x64\Rscript.exe" "process spp data3_T3.r" /b 
```

编辑2：

感谢下面的答案，这是我在 R 中所谓的“穷人并行计算”的实现：因此，如果您有任何长脚本必须应用于一长串案例，请使用下面的代码将长列表分解为要馈送到 rscript 的每个实例的子列表的数量：

```
#the cases that I need to apply my code to:
splist=c("sp01", "sp02", "sp03", "sp04", "sp05", "sp06", "sp07", "sp08", "sp09", "sp010", "sp11", "sp12", 
         "sp013", "sp014", "sp015", "sp16", "sp17", "sp018", "sp19", "sp20", "sp21", "sp22", "sp23", "sp24")
###automatic subsetting of cases based on number of running instances of r script:
cpucores=as.integer(Sys.getenv('NUMBER_OF_PROCESSORS'))
n_instances=length(system('tasklist /FI "IMAGENAME eq Rscript.exe" ', intern = TRUE))-3
jnk=length(system('tasklist /FI "IMAGENAME eq rstudio.exe" ', intern = TRUE))-3
if (jnk>0)rstudiorun=TRUE else rstudiorun=FALSE 

if (!rstudiorun & n_instances>0 & cpucores>1){ #if code is being run from rscript and 
#not from rstudio and there is more than one core available
  jnkn=length(splist)
  jnk=seq(1,jnkn,round(jnkn/cpucores,0))
  jnk=c(jnk,jnkn)
  splist=splist[jnk[n_instances]:jnk[n_instances+1]]
}
###end automatic subsetting of cases

#perform your script on subset of list of cases:
for(sp in splist){
  ptm0 <- proc.time()
  Sys.sleep(6)  
  ptm1=proc.time() - ptm0
  jnk=as.numeric(ptm1[3])
  cat('\n','It took ', jnk, "seconds to do species", sp)
} 
```

要使此代码在 Windows 中自动在多个 r 实例上运行，只需创建一个 .bat 文件：

```
cd "C:\Users\lfortini\code\misc code\misc r code"
START "" "C:\Program Files\R\R-3.0.0\bin\x64\Rscript.exe" "rscript_multiple_instances.r" /b
timeout 10
START "" "C:\Program Files\R\R-3.0.0\bin\x64\Rscript.exe" "rscript_multiple_instances.r" /b
timeout 10
START "" "C:\Program Files\R\R-3.0.0\bin\x64\Rscript.exe" "rscript_multiple_instances.r" /b
timeout 10
START "" "C:\Program Files\R\R-3.0.0\bin\x64\Rscript.exe" "rscript_multiple_instances.r" /b
exit 
```

超时是为了给 r 足够的时间来检测它自己的实例数量。单击此 .bat 文件将自动打开许多 r 脚本实例，每个实例都处理您要分析的案例的特定子集，同时仍会在每个窗口中提供脚本运行的所有进度，例如上图。这种方法很酷的一点是，您几乎只需在代码中使用的任何迭代机制（循环、应用 fx 等）之前添加自动列表子集代码。然后只需使用 .bat 或手动使用 rcript 触发代码，您就可以设置了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-10T23:14:45.190

实际上，这比预期的要容易，因为 Windows 带有在[这里](https://stackoverflow.com/q/6550200/289572)`tasklist`找到的不错的功能。

有了它，您可以获取所有正在运行的进程，您只需计算`Rscript.exe`实例的数量（我`stringr`在这里用于字符串操作）。

```
require(stringr)
progs <- system("tasklist", intern = TRUE)
progs <- vapply(str_split(progs, "[[:space:]]"), "[[", "", i = 1)
sum(progs == "Rscript.exe") 
```

这应该够了吧。（我只尝试过计数实例，`Rgui.exe`但效果很好。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-11T02:34:14.650

你可以做的更短如下

`length(grep("rstudio\\.exe", system("tasklist", intern = TRUE)))`

替换`rstudio`为任何其他`Rscript`或任何其他进程名称

甚至更短

`length(system('tasklist /FI "IMAGENAME eq Rscript.exe" ', intern = TRUE))-3`

# mysql - 使用 Perl 转义 sql 查询错误消息

> ID：15935932
> 
> 赞同：0
> 
> 时间：2013-04-10T20:38:51.630
> 
> 标签：mysql, perl, csv

J 将我的库存数据保存在 csv 文件中。我收到一条错误消息，因为我的插入值上有一个特殊字符，我不想处理这些值，因为它们被标记为特殊字符 $" 不再使用它们进行插入。我使用下面的代码：

```
#!/usr/bin/perl

# PERL MODULES WE WILL BE USING
use DBI;
use DBD::mysql;

# HTTP HEADER
print "Content-type: text/html \n\n";

# CONFIG VARIABLES
$platform = "mysql";
$database = "store";
$host = "localhost";
$port = "3306";
$tablename = "inventory";
$user = "username";
$pw = "password";

# DATA SOURCE NAME
$dsn = "dbi:$platform:$database:$host:$port";

# PERL DBI CONNECT
$connect = DBI->connect($dsn, $user, $pw);

# PREPARE THE QUERY
$query = "INSERT INTO inventory (id, product, quantity) VALUES (DEFAULT, 'tomatoes$"', '4')";
$query_handle = $connect->prepare($query);

# EXECUTE THE QUERY
$query_handle->execute(); 
```

如何跳过错误消息并移至下一个插入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:43:16.077

您必须在查询中转义 $，因为现在它是 perl 语法错误：

```
$sql = "INSERT .... 'tomatoes$"', '4')";
                              ^---- 
```

那个引号终止了 sql 字符串，因为它不是一个有效的变量。尝试

```
$sql = "INSERT .... 'tomatoes\$"', '4')";
                             ^-- 
```

反而。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:46:21.290

处理您的插入语句，避免 sql 注入：

```
my $query = qq!INSERT INTO inventory (id, product, quantity) VALUES (?,?,?)!;
my $query_handle = $connect->prepare($query);

$query_handle->execute('DEFAULT', 'tomatoes$', '4'); 
```

# sql-server - pyODBC 和 SQL Server 2008 和 Python 3

> ID：15935933
> 
> 赞同：3
> 
> 时间：2013-04-10T20:39:01.393
> 
> 标签：sql-server, python-3.x, odbc, pyodbc

我为 Python 3.2 安装了 pyODBC，我正在尝试更新我作为测试创建的 SQL Server 2008 R2 数据库。

我检索数据没有问题，而且一直有效。

但是，当程序执行 cursor.execute("sql") 来插入或删除一行时，它就不起作用 - 没有错误，什么都没有。响应就好像我成功更新了数据库但没有反映任何更改。

下面的代码本质上是创建一个字典（我稍后有这个计划）并且只是快速构建一个 sql insert 语句（它在我测试我写入日志的条目时起作用）

我的表中有 11 行 Killer，即使在提交之后也完全没有受到影响。

我知道这很愚蠢，但我看不到。

这是代码：

```
cnxn = pyodbc.connect('DRIVER={SQL Server Native Client 10.0};SERVER=PHX-500222;DATABASE=RoughRide;UID=sa;PWD=slayer')
cursor = cnxn.cursor()

# loop through dictionary and create insert entries
logging.debug("using test data to build sql")
for row in data_dictionary:
    entry = data_dictionary[row]
    inf = entry['Information']
    dt = entry['TheDateTime']
    stat = entry['TheStatus']
    flg = entry['Flagg']
    # create sql and set right back into row
    data_dictionary[row] = "INSERT INTO Killer(Information, TheDateTime, TheStatus, Flagg) VALUES ('%s', '%s', '%s', %d)"  % (inf, dt, stat, flg)

# insert some rows
logging.debug("inserting test data")
for row in data_dictionary.values():
    cursor.execute(row)

# delete a row
rowsdeleted = cursor.execute("DELETE FROM Killer WHERE Id > 1").rowcount
logging.debug("deleted: " + str(rowsdeleted))

cnxn.commit 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-10T21:03:56.337

假设这不是帖子中的错字，看起来您只是缺少该[`Connection.commit()`](https://code.google.com/p/pyodbc/wiki/Objects#commit)方法的括号：

```
...
# delete a row
rowsdeleted = cursor.execute("DELETE FROM Killer WHERE Id > 1").rowcount
logging.debug("deleted: " + str(rowsdeleted))

cnxn.commit() 
```

# c# - 第二个文本框显示与第一个相同的文本选择

> ID：15935936
> 
> 赞同：2
> 
> 时间：2013-04-10T20:39:08.660
> 
> 标签：c#, xaml, textbox, windows-runtime, selection

长时间的听众，第一次来电。我在 WinRT C#/XAML 中的 TextBox 遇到了一个奇怪的问题，希望有人可以帮助我。

基本上，我正在创建一个自定义控件，它基本上需要**第二个 TextBox 作为第一个的副本，包括显示相同的 Text 和显示相同的 Selected Text**。显然，对于 Text 要求，我只需响应第一个 TextBox 上的 TextChanged 事件并将第二个 TextBox 的 Text 设置为第一个 TextBox 的 Text，效果很好。

对于 Selected Text 要求，我从类似的解决方案开始，我的代码如下：

```
 void TextBox1_SelectionChanged(object sender, RoutedEventArgs e)
    {
        this.TextBox2.Select(this.TextBox1.SelectionStart, this.TextBox1.SelectionLength);
    } 
```

最初与鼠标一起使用时，这似乎工作得很好：

![使用鼠标的屏幕帽](https://i.stack.imgur.com/3juO5.jpg)

但是我在使用**Touch**选择文本时遇到了问题。我在 TextBox 中双击以创建第一个“锚点”，就像在 Touch 中一样，然后拖动以开始选择；但**在选择停止之前，我通常只能选择一个字符。**TextBox 并没有完全失去焦点，但行为与此类似；选择锚点消失，除非我重新双击以开始新的选择，否则我无法继续选择任何内容。如果我删除了在 TextBox2 中选择文本的代码，那么 Touch 选择在 TextBox1 中的表现完美。

我一直在尝试解决此问题，但无法解决，我不确定是否可以使用 WinRT TextBoxes 获得所需的行为。有没有人有任何想法？或者也许是另一种方法来实现具有这种行为的两个文本框的解决方案？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T14:10:31.190

我的也只是部分解决方案。

我做了一些调试并注意到该`SelectionChanged`事件在整个文本选择过程中被触发。换句话说，单指“滑动”会产生多个`SelectionChanged`事件。

正如您所发现的，`TextBox.Select`在文本选择手势期间调用会影响手势本身。Windows 似乎在程序化文本选择后停止了手势。

我的解决方法是尽可能延迟调用该`TextBox.Select`方法。这确实很好用，除了一个边缘情况。此方法失败的地方是以下场景：

用户开始选择手势，例如选择 x 个字符。用户无需将手指从屏幕上移开，就会暂停一两秒。然后用户尝试选择更多字符。

我的解决方案没有处理上一段中的最后一点。暂停后的触摸选择实际上并没有选择任何东西，因为我的代码将调用该`TextBox.Select`方法。

这是实际的代码。正如我上面提到的，在单个选择手势期间会触发多个选择更改事件。我的代码使用计时器和计数器仅在不再有任何挂起的触摸生成的选择更改事件时才进行编程选择。

```
int _selectCounter = 0;
const int SELECT_TIMER_LENGTH = 500;
async private void TextBox1_SelectionChanged(object sender, RoutedEventArgs e)
{
    // _selectCounter is the number of selection changed events that have fired.
    // If you are really paranoid, you will want to make sure that if
    // _selectCounter reaches MAX_INT, that you reset it to zero.
    int mySelectCount = ++_selectCounter;

    // start the timer and wait for it to finish
    await Task.Delay(SELECT_TIMER_LENGTH);

    // If equal (mySelectCount == _selectCounter),
    // this means that NO select change events have fired
    // during the delay call above. We only do the
    // programmatic selection when this is the case.
    // Feel free to adjust SELECT_TIMER_LENGTH to suit your needs.
    if (mySelectCount == _selectCounter)
    {
        this.TextBox2.Select(this.TextBox1.SelectionStart, this.TextBox1.SelectionLength);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T06:49:01.723

因此，这远不是一个答案，而是发现了一些可能会帮助您或其他人提出潜在解决方法的事情。如果这些是您已经看到和注意到的事情，我们深表歉意。

首先，问题本身不是对 TextBox2.Select() 的调用。例如，这对我来说很好

```
 private void txt1_SelectionChanged(object sender, RoutedEventArgs e)
    {
        var start =  TextBox1.SelectionStart;
        var length = TextBox1.SelectionLength;
        TextBox2.Select(3, 5);
    } 
```

不幸的是，使用`start`and`length`与硬编码的 3 和 5 相比，即以下内容不起作用：

```
 private void txt1_SelectionChanged(object sender, RoutedEventArgs e)
    {
        var start =  TextBox1.SelectionStart;
        var length = TextBox1.SelectionLength;
        TextBox2.Select(start, length);
    } 
```

我还发现，如果我从头开始，我可以选择两个字符，但从头开始只能选择一个。这让我开始考虑调度调用来设置第二个选择：

```
 private void txt1_SelectionChanged(object sender, RoutedEventArgs e)
    {
        var start =  TextBox1.SelectionStart;
        var length = TextBox1.SelectionLength;
        Dispatcher.RunAsync(Windows.UI.Core.CoreDispatcherPriority.Low, 
            () => TextBox2.Select(start, length));
    } 
```

现在我可以从前面选择 2，从后面选择 3，有时从后面选择 4。更进一步，可以通过非常快速的滑动选择多达六个或七个。

```
 private void txt1_SelectionChanged(object sender, RoutedEventArgs e)
    {
        var start =  TextBox1.SelectionStart;
        var length = TextBox1.SelectionLength;
        Dispatcher.RunIdleAsync((v) => Highlight());
    }

    public void Highlight()
    {
        TextBox2.Select(TextBox1.SelectionStart, TextBox1.SelectionLength);
    } 
```

似乎解决此问题的技巧是在 TextBox1 SelectionChanged 事件的任何痕迹完成之前不设置 TextBox2 。

这可能值得在[Connect](http://connect.microsoft.com/intro/)上注册。

# uiviewcontroller - 如何使 UIViewController 工具栏出现？

> ID：15935939
> 
> 赞同：3
> 
> 时间：2013-04-10T20:39:19.583
> 
> 标签：uiviewcontroller, interface-builder, uitoolbar

在情节提要上放置 UIViewController 时，它有一个“内置”工具栏，我可以在设计期间向其中添加按钮。我的问题是它不会在运行时出现。有该属性`toolbarHidden`，但这无法控制工具栏的可见性。如何将其设置为可见？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-10T20:51:27.150

“内置”工具栏位于 Attributes Inspector 的“Simulated Metrics”部分。

这些实体仅可用于**设计目的**，它们*模拟*由于外部条件而可能强加在 viewController 上的小部件的效果。

在模拟工具栏指标的情况下，这向您展示了如果 viewController 嵌入到`UINavigationController`who 的`toolbarHidden`属性设置为“false”时的外观

UIViewController 没有`toolbar`属性，这就是为什么在头文件中找不到对它的引用的原因。

# django - 为什么 get_queryset() 没有返回正确的结果？

> ID：15935941
> 
> 赞同：0
> 
> 时间：2013-04-10T20:39:31.900
> 
> 标签：django, django-views

我有两个模型，`Recieved_order`并且`order`，

```
class Order(SmartModel):

    restaurant = models.ForeignKey(Restaurant,null=True,blank=True,default = None,help_text="The restaurant the customer order from")
    #contact info
    email = models.EmailField(max_length=50,help_text="Needed as alternative")
    mobile = PhoneNumberField(max_length=20,default='+25078######')

class Recieved_Order(SmartModel):
    item = models.ForeignKey(Item)
    date_added = models.DateTimeField(auto_now=True,auto_now_add=True)
    quantity = models.IntegerField(default=0)
    price = models.DecimalField(max_digits=9,decimal_places=2)
    order = models.ForeignKey(Order) 
```

我想要一个餐厅经理（用户），能够`Recieved_order`在登录时接收到他的特定餐厅的订单（），为了实现这一点，我在views.py中有以下内容

```
class Recieved_OrderCRUDL(SmartCRUDL):
    model = Recieved_Order
    actions = ('create','read','update','delete','list')
    permissions = True

    class List(SmartListView):
        fields = ('order_email','order_mobile','order_billing_city','item.name','item.price','quantity','order_id','order_restaurant')
        search_fields = ('date_added',)

        def get_queryset(self,*args,**kwargs):
            queryset = super(Recieved_OrderCRUDL.List, self).get_queryset(*args,**kwargs)
            if self.request.user.is_superuser:
                return queryset
            return queryset.filter(order=self.request.user) 
```

有了以上内容，我正在两个不同的餐厅进行测试，这家餐厅和它没有按应有的方式工作。它返回给定餐厅的错误订单。

我做错了什么`get_queryset()`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T21:46:52.207

这里发生了一些令人困惑的事情：

```
return queryset.filter(order=self.request.user) 
```

您要告诉它构建一个查询，`Order`根据对象过滤`User`对象。

您的示例代码中是否缺少将订单与用户联系起来以便可以构建正确连接的内容？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T22:32:02.057

如果你想让一个用户（你称之为经理）只能查看他们自己的订单，你需要改变一些事情......`Restaurant`需要有一个指向 a 的字段`User`（让我们称之为`user`并假设它是`ForeignKey`) 然后你可以做类似的事情

```
if self.request.user.is_superuser:
    return queryset
return queryset.filter(order__restaurant__user=self.request.user) 
```

正如@Joe Holloway 指出的那样，您不应该尝试`order`使用对象过滤字段`user`......

我想指出的另一件奇怪的事情是

```
fields = ('order_email','order_mobile','order_billing_city','item.name','item.price','quantity','order_id','order_restaurant') 
```

您似乎正在使用多种方式来尝试访问事物......您应该使用`__`（即 2 个下划线）来访问关系，而不是`_`或`.`

# mysql - 比较组的第一行和第二行之间的变化

> ID：15935943
> 
> 赞同：0
> 
> 时间：2013-04-10T20:39:38.803
> 
> 标签：mysql, sql

我有一个“Empresas”表

```
dbo.empresas

    id | name | delegacion_id
    -------------------------
    1  |  A   |     3
    2  |  B   |     3
    3  |  C   |     3
    4  |  D   |     4 
```

一个“pagos”表

```
dbo.pagos

    id | id_empresa | monto  | periodo   
    ----------------------------------
    1  |   1        |  120   | 2012-11-01
    2  |   1        |  125   | 2012-12-01
    3  |   2        |  150   | 2012-11-01
    4  |   1        |  200   | 2013-01-01
    5  |   2        |  151   | 2012-12-01 
```

我有一个值 X，它是一个百分比。

我需要向“empresas”展示，比较他们最后两个“pagos”（按 periodo 排序）的“montos”，从特定的 id_delegacion 至少改变了 +X% 或 -X%

例如，如果我们使用这些示例值运行此查询，考虑到

X = 10 id_delegacion = 3

预期的输出将是：

```
name | periodo    | monto
---------------------------
A    | 2012-12-01 | 125 
A    | 2013-01-01 | 200 
```

empresa A 来自 delegacion_id = 3，最后两个 pagos 之间的比较，按 periodo desc (200 => 125) 排序大于 10%。

B 未显示，因为比较小于 10%。

C 未显示，因为“pagos”表中没有行

D 来自另一个代表团。

我怎样才能得到这个想要的输出？作为记录，使用 MySQL 5.5.8。

**我做了什么**

我懂了

```
select P.id_empresa, max(periodo) as periodo from 
        pagos P
        where id_empresa in(
                                select e.id
                                from empresa E 
                                where E.id_delegacion = 3
                            ) 
        group by p.id_empresa, p.periodo
        having count(*) > 1 
```

有了这些，我得到了具有多个“pago”行的“empresas”，并且得到了 id_delegation = 3。还获得了第一个时期（最大值），但我不知道如何为每个 empresa 获得第二个时期，并且比较它们。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:04:56.860

这是我的查询：

```
SELECT
  empresas.name,
  pagos.periodo,
  pagos.monto
FROM
  pagos INNER JOIN (
    SELECT
      lst.id id1,
      prc.id id2
    FROM (
      SELECT
        p1.id_empresa,
        MAX(p1.periodo) last_p,
        MAX(p2.periodo) prec_p
      FROM
        pagos p1 INNER JOIN pagos p2
        ON p1.id_empresa = p2.id_empresa
           AND p2.periodo < p1.periodo
      GROUP BY
        id_empresa) latest
      INNER JOIN
      pagos lst ON lst.id_empresa = latest.id_empresa AND lst.periodo=latest.last_p
      INNER JOIN
      pagos prc ON prc.id_empresa = latest.id_empresa AND prc.periodo=latest.prec_p
    WHERE
      lst.monto > prc.monto * 1.1) ids
  ON pagos.id IN (ids.id1, ids.id2)
  INNER JOIN
  empresas
  ON pagos.id_empresa = empresas.id
WHERE
  delegacion_id=3 
```

如果你想在同一行有值，我认为它可以被简化，例如

```
name | ultimo_periodo    | ultimo_monto | anterior_periodo | anterior_monto 
```

请[在此处](http://sqlfiddle.com/#!2/baaef/1)查看小提琴。

我仍然想知道它是否可以简化一点，但我不确定是否可以。这是另一个解决方案：

```
SELECT
  empresas.name,
  pagos.periodo,
  pagos.monto
FROM
  pagos INNER JOIN empresas
  ON pagos.id_empresa = empresas.id
  INNER JOIN (
SELECT
  id_empresa,
  MAX(CASE WHEN row=1 THEN monto END) lst_monto,
  MAX(CASE WHEN row=2 THEN monto END) prc_monto,
  MAX(id) id1, MIN(id) id2
FROM (

  SELECT
    p1.*, COUNT(*) row
  FROM
    pagos p1 INNER JOIN pagos p2
    ON p1.id_empresa = p2.id_empresa
       AND p1.periodo <= p2.periodo
    INNER JOIN empresas
    ON p1.id_empresa = empresas.id
  WHERE
    empresas.delegacion_id = 3
  GROUP BY
    p1.id, p1.id_empresa, p1.monto, p1.periodo
  HAVING
    COUNT(*)<=2
  ORDER BY
    p1.id_empresa, p1.periodo desc
  ) s
GROUP BY
  id_empresa
HAVING
  lst_monto>prc_monto*1.1
) l ON pagos.id IN (l.id1, l.id2) 
```

请[在此处](http://sqlfiddle.com/#!2/baaef/21)查看小提琴。

# java - 将 Guice 与自定义类一起使用？

> ID：15935945
> 
> 赞同：2
> 
> 时间：2013-04-10T20:39:47.150
> 
> 标签：java, guice

我正在使用启用 Guice 的框架。

当使用由框架创建的类（或覆盖现有绑定的子类）时，我可以很容易地实例化框架提供的变量。无论我需要什么，这只是一个问题

```
@Inject
FrameworkProvidedType variable; 
```

但是，在我自定义创建的类中，这不起作用。所有注入的变量都是空的。

我的*理解*是，为了使用注入，我的类必须有一个绑定。

如果我对现有框架类进行子类化，我可以覆盖我的模块类中的绑定。这很简单。

但是我有一个新类，我不知道如何将它绑定到底层框架。

```
public Class myCustomClass {

   private String iNeedthis;
   private Context thisToo;

   @Inject
   FrameWorkThing magic;

   public myCustomClass(String iNeedThis, Context thisToo){
         this.iNeedThis = iNeedThis;
         this.thisToo = thisToo;
   }

   public void DoMagic(){
        //null pointer error because magic was not injected
        magic.doMagic(this.iNeedthis);
   }
} 
```

我如何 Guice 启用这个新类？

我在我的运行时模块中试过这个

```
public Class<myCustomClass> bindMyCustomClass(){
    return MyCustomClass.class;
} 
```

并惨遭失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:23:52.583

不感谢@bmorris591，他驳回了这个问题，并在门外否决了这个问题，我找到了答案。

@Inject-ing 一个字段到一个类中意味着该类实例需要由 Guice 创建。

第 1 步是为该类创建一个工厂。这可能没有必要，但它对我有用。

```
public interface MyCustomClassFactory {
    public MyCustomClass create(String iNeedThis, Context thisToo);
} 
```

第 2 步是将工厂安装到 Guice

```
@Override
public void configure(Binder binder) {

    super.configure(binder);

    binder.install(new FactoryModuleBuilder().build(MyCustomClass.class));
} 
```

在我的特殊情况下 - 我正在使用的框架提供了一个 Module 类，它是 com.google.inject.Module 的实现。

该类中有一个在启动时调用的“配置（Binder binder）”函数。

第 3 步实际上是对构造函数进行注解

```
@Inject
public myCustomClass(String iNeedThis, Context thisToo){
     this.iNeedThis = iNeedThis;
     this.thisToo = thisToo;
} 
```

使我走上正轨的有用且相关的网页：

[http://beust.com/weblog/2012/08/21/advanced-dependency-injection-with-guice/](http://beust.com/weblog/2012/08/21/advanced-dependency-injection-with-guice/)

这谈到了辅助注射，但它提供了足够的信息和一个简单易懂的例子，说明下一步非常容易。

# leaflet - 传单：图层在某些缩放级别上消失

> ID：15935947
> 
> 赞同：0
> 
> 时间：2013-04-10T20:40:02.140
> 
> 标签：leaflet

在这个 Leaflet 应用程序中，我显示了丹麦所有可用的巴士站。

[http://drivetime.mapicture.dk/stops](http://drivetime.mapicture.dk/stops)

奇怪的是，如果您缩小到最后 4 个缩放级别之一，带有这些巴士站的图层就会消失。当您再次缩小时，它们会重新出现。

公交车站是通过向我们的地理服务器发出的 WMS 请求检索到的单层。整个 javascript 代码实际上非常简单，所以我很难找出导致这种行为的原因。

```
function CurrentStopsMap(mapNode, zoomSettings) {
  var self = this;

  self.mapNode = mapNode;
  self.zoomSettings = zoomSettings;

  self.mapquest = new L.TileLayer('http://otile{s}.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png', {
    maxZoom: 18,
    attribution: "©<a href='http://openstreetmap.org/' target='_blank'>OpenStreetMap</a> contributors, Tiles Courtesy of <a href='http://open.mapquest.com' target='_blank'>MapQuest</a>",
    subdomains: ['1', '2', '3', '4']
  });

  self.regions = new L.TileLayer.WMS("http://backend.mapicture.dk:8080/geoserver/mapicture/wms", {
    layers: 'mapicture:region',
    format: 'image/png',
    styles: 'regions',
    transparent: false
  });

  self.stops = new L.TileLayer.WMS("http://backend.mapicture.dk:8080/geoserver/mapicture/wms", {
    layers: 'mapicture:stops',
    format: 'image/png',
    transparent: true
  });

  self.map = new L.Map(mapNode, {
    center: new L.LatLng(zoomSettings.lat, zoomSettings.lon),
    zoom: zoomSettings.level,
    layers: [self.mapquest, self.stops],
    zoomControl: true
  });

  L.control.layers({
    "Kort": self.mapquest,
    "Områder": self.regions
  }, {
    "Stoppesteder": self.stops
  }).addTo(self.map);
}

var zoom = {
  lat: 56.24,
  lon: 10.68,
  level: 7
};
var map = new CurrentStopsMap('map', zoom) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-04-30T17:44:10.740

这实际上是 Geoserver 守护程序的问题。

# xml - 如何实现我的电子商务主机的 API？

> ID：15935958
> 
> 赞同：0
> 
> 时间：2013-04-10T20:40:45.920
> 
> 标签：xml, api, e-commerce, implementation

我正在尝试使用我的商店 API 生成产品页面，但不知道如何开始。

这是现在的产品页面[http://www.imagedepotinc.com/Image_Depot_Store/Products](http://www.imagedepotinc.com/Image_Depot_Store/Products)。如果我可以访问代码，我会对其进行调整，直到它按照我想要的方式设置。由于我没有访问权限，他们对我的唯一选择就是从头开始构建它。

我的电子商务主机是inksoft，他们不提供最有用的技术支持或任何文档。我被告知的只是“这里有 API 文件，但我们不知道它们做了什么”。

他们给我的“API”文件是一些链接的列表，如下所示：

> [http://www.imagedepotinc.com/GetProductCategoryList/2585](http://www.imagedepotinc.com/GetProductCategoryList/2585)

当您单击一个时，它会将您带到一个 XML 文件（XML 文件是 API 吗？）：

```
<ProductCategoryList>
<vw_product_categories product_category_id="45904" name="Printed Apparel" path="Printed Apparel" thumburl_front="REPLACE_DOMAIN_WITH/images/publishers/892/ProductCategories/Printed_Apparel/80.gif"/>
<vw_product_categories product_category_id="8920007" parent_id="45904" name="T-Shirts" path="Printed Apparel -> T-Shirts" thumburl_front="REPLACE_DOMAIN_WITH/images/publishers/892/ProductCategories/Printed_Apparel/T-Shirts/80.gif"/>
<vw_product_categories product_category_id="45907" name="Promotional Items" path="Promotional Items" thumburl_front="REPLACE_DOMAIN_WITH/images/publishers/892/ProductCategories/Promotional_Items/80.gif"/>
<vw_product_categories product_category_id="45906" name="Digital Printed Products" path="Digital Printed Products" thumburl_front="REPLACE_DOMAIN_WITH/images/publishers/892/ProductCategories/Digital_Printed_Products/80.gif"/>
<vw_product_categories product_category_id="45939" parent_id="45906" name="Banners" path="Digital Printed Products -> Banners" thumburl_front="REPLACE_DOMAIN_WITH/images/publishers/892/ProductCategories/Digital_Printed_Products/Banners/80.gif"/>
</ProductCategoryList> 
```

我一直在寻找有关如何实现商店 API 的信息，但找不到任何有用的信息。

在此先感谢，如果我含糊其辞，请见谅。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:49:25.917

您可以使用 zend-frameworks 或顿悟创建可靠的 API

# php - 使用 mysql 中的枚举字段选择行

> ID：15935962
> 
> 赞同：2
> 
> 时间：2013-04-10T20:40:58.770
> 
> 标签：php, mysql, select, enums

我的表（userinfo）的枚举字段（UserStatus）遇到异常问题。表结构如下：

```
Field       Type        Default
------------------------------------------
Id          int(11)       (NULL)
FirstName   varchar(50)   (NULL)
LastName    varchar(50)   (NULL)
....        ...           ...
....        ...           ...   
UserStatus  enum('0','1') (NULL) 
```

在这里，我有 UserStatus 值为 NULL、0 和 1 的行。但是当我尝试根据 UserStatus 字段选择行时，例如：

```
SELECT 
    * 
FROM 
    userinfo 
WHERE 
    UserStatus<>'1' 
```

它不起作用并导致结果集为空。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T20:54:55.370

请记住`NULL <> '1'`is 本身`NULL`，因此您的条件不会匹配`UserStatus`is 的行`NULL`。请改用此表达式：

```
UserStatus IS NULL OR UserStatus <> '1' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:55:21.513

如果您提供默认值并创建该字段，这将是一个更好的结构，`NOT NULL`但在这种情况下您可以使用

```
 SELECT * 
 FROM userinfo 
 WHERE ifnull(UserStatus, '0') <> '1' 
```

# c# - C# 内存泄漏问题中的 GDI 打印、无法解释的错误、无法线程

> ID：15935969
> 
> 赞同：2
> 
> 时间：2013-04-10T20:41:18.870
> 
> 标签：c#, multithreading, printing, memory-leaks, gdi

我们使用 Win32 调用 GDI 打印 API 来打印图形。

我注意到在某些 PCL 打印队列上，我们在打印时会泄漏 GDI 内存。据我所知，一切都被妥善处理。不是我公司的管理员，我很难判断哪些驱动程序打印队列正在使用。PCL6 驱动程序似乎是罪魁祸首。我见过的其他看似无关的问题：

> System.ComponentModel.Win32Exception：传递给系统调用的数据区域太小 System.ComponentModel.Win32Exception：操作成功完成

```
var hdc = GdiPrintWin32.CreateDC(IntPtr.Zero, printerName, IntPtr.Zero, IntPtr.Zero);
if (hdc == IntPtr.Zero)
    throw GetError("Device context failed for {0}", printerName);

try
{
    if (GdiPrintWin32.StartDoc(hdc, ref doc) <= 0)
        throw GetError("Failed to start print job"); 
```

此逻辑当前在 Windows 服务内托管的 WCF 中完成。当我将实例模式设置为单一并锤击它时，我只在前几次调用中得到它；当我将实例模式设置为每次调用时，重现起来要容易得多。

我还看到了一些错误，在大约 20 分钟内基本上没有呼叫可以通过该服务，需要重新启动才能修复。我注意到停止服务后，Windows 事件日志的效果如下：

> 2 个用户注册表句柄从 \Registry\User... 泄露：进程 3792 (\Device\HarddiskVolume1\Windows\System32\rundll32.exe) 已打开密钥 \REGISTRY\USER... 进程 3792 (\Device\HarddiskVolume1\Windows\ System32\rundll32.exe) 已打开密钥 ...\Software\Hewlett-Packard\HP SSNP

基本上，这对我们来说只不过是一场噩梦。有没有人有过这样的经历？

我们用来打印的代码的核心是：

```
var doc = new Docinfo { DocName = printJobName };

// create a device-context 
var hdc = GdiPrintWin32.CreateDC(IntPtr.Zero, printerName, IntPtr.Zero, IntPtr.Zero);
if (hdc == IntPtr.Zero)
    throw GetError("Device context failed for {0}", printerName);

try
{
    if (GdiPrintWin32.StartDoc(hdc, ref doc) <= 0)
        throw GetError("Failed to start print job");

    foreach (PrintingMetafile metafile in pages)
    {
        var bytes = metafile.GetBytes();

        // load the bytes to a memory location and get the pointer
        var inMemRef = GdiPrintWin32.SetEnhMetaFileBits((uint)bytes.Length, bytes);

        if (inMemRef == IntPtr.Zero)
            throw GetError("Failed to create EMF in memory");

        // Get the pixel coordinates of the paper
        var x = 0; // GdiPrintWin32.GetDeviceCaps(hdc, HORZSIZE);
        var y = 0; // GdiPrintWin32.GetDeviceCaps(hdc, VERTSIZE);
        var hres = GdiPrintWin32.GetDeviceCaps(hdc, HORZRES);
        var vres = GdiPrintWin32.GetDeviceCaps(hdc, VERTRES);

        var rect = new Rect { Left = x, Top = y, Right = hres, Bottom = vres };

        if (GdiPrintWin32.StartPage(hdc) <= 0)
            throw GetError("StartPage failed");

        if (GdiPrintWin32.PlayEnhMetaFile(hdc, inMemRef, ref rect) == 0)
            throw GetError("PlayEnhMetaFile failed");

        if (GdiPrintWin32.EndPage(hdc) <= 0)
            throw GetError("EndPage failed");

        if (inMemRef != IntPtr.Zero)
        {
            GdiPrintWin32.DeleteEnhMetaFile(inMemRef);
        }
    }

    if (GdiPrintWin32.EndDoc(hdc) <= 0)
        throw GetError("Failed to finish print job");
}
finally
{
    GdiPrintWin32.DeleteDC(hdc);
} 
```

# html - 为什么“没有在我的网页上显示为引用？

> ID：15935978
> 
> 赞同：0
> 
> 时间：2013-04-10T20:41:49.123
> 
> 标签：html, wordpress, ascii, blogengine.net

其他 ASCII 码也在做同样的事情。

只是为了给您一些背景知识，这些代码是我从 WordPress 博客文章中阅读的 HTML 的一部分。我正在使用我编写的一个小 C# WinForm 应用程序将它们移植到 BlogEngine.NET。当我将它们移植到 BlogEngine.NET（作为 XML 文件）时，是否需要进行某种转换？

如果它们在我没有任何干预的情况下正确显示，那肯定会很好。

这是来自 WordPress 源页面之一的代码片段：

```
<link rel="alternate" type="application/rss+xml" title="INRIX® Traffic &raquo; Taking the &#8220;E&#8221; out of your &#8220;ETA&#8221; Comments Feed" href="http://www.inrixtraffic.com/blog/2012/taking-the-e-out-of-your-eta/feed/" /> 
```

这是我在转换过程中输出的 XML 文件中对应的 XML 块：

```
<title>Taking the &amp;#8220;E&amp;#8221; out of your &amp;#8220;ETA&amp;#8221;</title> 
```

**更新。**

试过这个，但仍然没有骰子。

```
writer.WriteElementString("title", string.Format("<![CDATA[{0}]]>", post.Title)); 
```

...输出：

```
<title>&lt;![CDATA[Taking the &amp;#8220;E&amp;#8221; out of your &amp;#8220;ETA&amp;#8221;]]&gt;</title> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T18:13:33.320

由于您从 Wordpress 获得的数据已经编码，您可以将其解码为常规字符串，然后让 XMLWriter 为 XML 正确编码。

```
string input = "Taking the &#8220;E&#8221; out of your &#8220;ETA&#8221;";
string decoded = System.Net.WebUtility.HtmlDecode(input);
//decoded = Taking the "E" out of your "ETA" 
```

这可能不是很有效，但由于这听起来像是一次性转换，我认为这将是一个问题。

这里问了一个类似的问题：[如何在 C# 中解码 HTML 字符？](https://stackoverflow.com/questions/122641/how-can-i-decode-html-characters-in-c)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T20:54:01.107

正如我在上面的评论中指出的那样：您的问题是您`&#220;`被编码为`&amp;8220;`. 当您在浏览器中输出它时，它显示为`&#220;`

我不知道您的移植是如何工作的，但要解决此问题，您需要确保`&`ASCII 代码中的`&amp;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T20:59:35.963

CDATA标签有没有可能解决这个问题？只需确保源 XML 文件中的文本正确无误。如果您使用 CDATA 标签，则不需要＆符号魔法（在源代码中）。

```
<some_tag><![CDATA[Taking the “ out of your ...]]></some_tag> 
```

# delphi - 差异设计和运行时间

> ID：15935983
> 
> 赞同：0
> 
> 时间：2013-04-10T20:42:16.600
> 
> 标签：delphi, vcl

THidepanel 的开发仍然给我提出了很多问题。我按照此处给出的说明进行操作[其他帮助和问题](https://stackoverflow.com/questions/15924468/how-do-i-restrict-my-custom-controls-children-to-a-certain-area)

我现在将内面板设计为红色，并且比外面板小一些。如果我在测试应用程序中运行该组件，则仅绘制外部面板，并且放置在内部工作面板上并且在设计时可见的所有组件不再可见。

我假设错误如下：outedr 面板是作为最后一个动作绘制的，因此在运行时我看不到红色的内面板和放置在这里的组件？这是真的吗，我的假设在哪里错了，我应该怎么做才能解决这个问题

我的组件的最新创建功能在这里：

```
constructor THidePanel.create(aOwner: TComponent);
begin
  inherited;

  padding.Left:= BorderSize;
  padding.top:= BorderSize;
  padding.right:= BorderSize;
  padding.Bottom:= BorderSize;

  //  the inner panel
  WorkingPanel := TPanel.create(self);
  WorkingPanel.Caption := ' ';
  WorkingPanel.BevelOuter := bvNone;

  // WorkingPanel.BringToFront;

  WorkingPanel.Color :=220;
  WorkingPanel.ParentColor := false;
  WorkingPanel.Parent := self;
  WorkingPanel.Align := alClient;

  //  the button to mimimize / maximize
  FActivateButton := TButton.create(self);
  FActivateButton.Parent := self;
  FActivateButton.Caption := '<';
  FActivateButton.OnClick := H_ActivateButtonClick;
  FActivateButton.Width := BorderSize;

  FActivateButton.Height := BorderSize;

  ///   the restore values , correct setting
  FLargeWidth := self.Width;
  FLargeHeight := self.Height;
  FHasCustomSize := false;

  // here I draw the activate button on the outer panel
  SetButtonPosition(topright);

  //  drop components only on the inner panel
  ControlStyle := ControlStyle - [csAcceptsControls]

end; 
```

![设计和运行时问题](https://i.stack.imgur.com/11MMI.jpg)

![在运行时不可用的组件](https://i.stack.imgur.com/mqWyc.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:42:29.213

尝试设置`WorkingPanel.Visible`为`True`.

# php - 有什么方法可以用 Laravel 检测数据库表是否存在

> ID：15935990
> 
> 赞同：105
> 
> 时间：2013-04-10T20:42:49.610
> 
> 标签：php, laravel

我希望能够使用创建表

```
Schema::create('mytable',function($table)
{
    $table->increments('id');
    $table->string('title');
}); 
```

但在此之前我想检查表是否已经存在，也许像

```
Schema::exists('mytable'); 
```

但是，上述功能不存在。我还能用什么？

* * *

## 回答 #1

> 赞同：265
> 
> 时间：2013-04-10T23:12:16.513

如果您使用的是 Laravel 4 或 5，那么有该`hasTable()`方法，您可以[在 L4 源代码](https://github.com/laravel/framework/blob/master/src/Illuminate/Database/Schema/Builder.php#L41)或[L5 文档](http://laravel.com/docs/5.0/schema#checking-existence)中找到它：

```
Schema::hasTable('mytable'); 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2017-05-03T05:38:33.277

要创建一个新表，Laravel Schema 函数只有一次检查`hasTable`。

```
if (!Schema::hasTable('table_name')) {
    // Code to create table
} 
```

但是如果你想在检查它是否存在之前删除任何表，那么 Schema 有一个名为`dropIfExists`.

```
Schema::dropIfExists('table_name'); 
```

如果表存在，它将删除表。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-11-26T19:32:30.273

**如果您使用不同的连接，那么您必须接受我的回答。**

```
Schema::connection("bio_db")->hasTable('deviceLogs_11_2019') 
```

在`hasTable()`功能上，您可以传递超过 1 个表名。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-07-27T11:30:51.723

正如 Phill Sparks 回答的那样，您可以使用以下方法检查表是否存在：

```
Schema::hasTable('mytable') 
```

请注意，您的应用有时会使用不同的连接。在这种情况下，您应该使用：

```
Schema::connection('myConnection')->hasTable('mytable') 
```

（不要忘记`use Schema;`在代码的开头使用）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-04-10T22:39:29.070

L3 中没有内置函数。您可以进行原始查询：

```
$table = "foo";
$check = DB::only('SELECT COUNT(*) as `exists`
    FROM information_schema.tables
    WHERE table_name IN (?)
    AND table_schema = database()',$table);
if(!$check) // No table found, safe to create it.
{
    // Schema::create …
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-23T07:46:17.143

相反，依赖于信息模式查询，而不是使用`COUNT()`.

```
SELECT table_schema 
FROM information_schema.tables
WHERE table_schema = DATABASE()
      AND table_name = 'table_name'; 
```

改变你的`'table_name'`价值。

如果您得到一行输出，则表示该表存在。

# macos - 文本文件编码

> ID：15935991
> 
> 赞同：0
> 
> 时间：2013-04-10T20:42:49.997
> 
> 标签：macos, csv, encoding, utf-8

我在尝试在 Windows 中读取 MAC 中生成的 CSV 文件时遇到问题。

我的问题是如何将编码转换为 UTF-8 甚至 ISO-8859-1。

我已经尝试过 iconv 没有成功。

在“vim”中，我可以理解，在这个文件中，换行符用 ^M 标记，重音 ã 用 <8b> 标记，Ç = <82> 等等。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:06:27.427

要从编码 a 转换为编码 b，您需要知道编码 a 是什么。

鉴于

> ã 标有 <8b>，Ç = <82>

编码 a 很可能是[Mac OS Roman](http://en.wikipedia.org/wiki/Mac_OS_Roman)。

`macintosh`因此，使用* 作为`from`参数和`utf-8`作为参数调用 iconv `to`。

*try`macroman`等`x-mac-roman`如果`macintosh`没有找到

# windows - MSB3481 证书错误

> ID：15935999
> 
> 赞同：2
> 
> 时间：2013-04-10T20:43:41.973
> 
> 标签：windows, msbuild, certificate

我在window 2008 R2 上有一个构建服务器。我正在使用 msbuil 3.5 运行 CruiseControl.net。我知道证书已安装并且指纹正确。我确实查看了返回 MSB3481 的这个 SO 问题[MSBuild SignFile 任务：无法找到签名证书](https://stackoverflow.com/questions/14409465/msbuild-signfile-task-returning-msb3481-the-signing-certificate-could-not-be-lo)并尝试了该解决方案，但没有奏效。在 msbuild 脚本中，错误会在下面的代码行中引发。我不确定是否有特定于 windows 2008 R2 的任何内容。

```
<SignFile CertificateThumbprint="$(CertThumbprint)"
 SigningTarget="@(%(ManifestItems.DeployManifestOutput))"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T21:28:59.593

在 windows 2008 R2 上安装原始 pfx 证书文件的过程中发现，其中一个值默认提示输入密码。在我的场景中，原始 pfx 证书文件没有密码，但 Windows 仍然提示输入密码。在构建服务器上执行 MSBuild 期间，密码提示会导致它挂起，因为没有对提示做出响应。

解决此问题的几种方法是通过 MSBuild 脚本中的程序集清单或在 pfx 证书安装期间提供空密码以选择退出以提示输入密码。